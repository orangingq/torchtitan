
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 11. 07. (ê¸ˆ) 03:44:50 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 0,1,2,3
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/1107_1F1B_timelyapf.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
âœ”ï¸Running with timelyapf x 1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=timelyapf --freezing.threshold=0.05 --freezing.percentile=80
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank2]:2025-11-07 03:44:56,567 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
[rank2]:for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~"
[rank0]:2025-11-07 03:44:56,644 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
[rank0]:for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~"
[rank3]:2025-11-07 03:44:56,605 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
[rank3]:for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~"
[rank1]:2025-11-07 03:44:56,785 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
[rank1]:for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~"
[rank2]:2025-11-07 03:44:56,784 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-11-07 03:44:56,786 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-11-07 03:44:56,826 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-11-07 03:44:56,829 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-07 03:44:56,944 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-11-07 03:44:56,947 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-07 03:44:56,952 - INFO - [GC] Initial GC collection 0.00 seconds
[rank1]:2025-11-07 03:44:57,006 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-11-07 03:44:57,009 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-07 03:44:57,387 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-11-07 03:44:57,782 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank1]:2025-11-07 03:45:00,671 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-11-07 03:45:00,711 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-11-07 03:45:00,740 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-11-07 03:45:00,740 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2025-11-07 03:45:00,914 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-11-07 03:45:00,914 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-11-07 03:45:00,915 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank2]:2025-11-07 03:45:01,235 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-11-07 03:45:01,273 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-11-07 03:45:01,305 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-11-07 03:45:01,305 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank2]:2025-11-07 03:45:01,490 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-11-07 03:45:01,490 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-11-07 03:45:01,490 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank0]:2025-11-07 03:45:02,229 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=512, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank0]:2025-11-07 03:45:02,380 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-11-07 03:45:02,419 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-07 03:45:02,421 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-11-07 03:45:02,447 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-11-07 03:45:02,448 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank3]:wandb: setting up run vzyp3gsv
[rank0]:2025-11-07 03:45:02,625 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-07 03:45:02,626 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-11-07 03:45:02,626 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1107_1F1B_timelyapf_dm1/20251107-0345/wandb/run-20251107_034501-vzyp3gsv
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1107_1F1B_timelyapf_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/vzyp3gsv
[rank3]:2025-11-07 03:45:03,172 - INFO - WandB logging enabled
[rank3]:2025-11-07 03:45:03,173 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-11-07 03:45:03,214 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-11-07 03:45:03,243 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-11-07 03:45:03,243 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2025-11-07 03:45:03,456 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank2]:2025-11-07 03:45:03,456 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-11-07 03:45:03,438 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-11-07 03:45:03,438 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-11-07 03:45:03,439 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2025-11-07 03:45:03,456 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-07 03:45:03,455 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1107_1F1B_timelyapf_dm1
[rank0]:2025-11-07 03:45:03,456 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-07 03:45:03,456 - INFO - Trainer is initialized with local batch size 32, global batch size 128, gradient accumulation steps 4, sequence length 512, total steps 1200 (warmup 100)
[rank0]:2025-11-07 03:45:03,456 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank0]:2025-11-07 03:45:05,567 - INFO - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-11-07 03:45:05,567 - INFO - Finished loading the checkpoint in 2.11 seconds.
[rank0]:2025-11-07 03:45:05,567 - INFO - Training starts at step 1
[rank1]:2025-11-07 03:45:08,731 - INFO -  step:  1  loss: -4.0000  grad_norm: 174.8887  memory:  6.76GiB(14.24%)  tps: 2,043  tflops: 15.56  mfu: 4.99%
[rank1]:2025-11-07 03:45:08,731 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-11-07 03:45:08,713 - INFO -  step:  1  loss: -4.0000  grad_norm: 174.8887  memory:  4.63GiB(9.75%)  tps: 2,202  tflops: 16.77  mfu: 5.38%
[rank2]:2025-11-07 03:45:08,713 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-11-07 03:45:08,723 - INFO -  step:  1  loss: 10.3018  grad_norm: 174.8887  memory: 12.97GiB(27.30%)  tps: 2,975  tflops: 22.66  mfu: 7.26%
[rank3]:2025-11-07 03:45:08,724 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-07 03:45:08,751 - INFO -  step:  1  loss: -4.0000  grad_norm: 174.8887  memory:  9.19GiB(19.34%)  tps: 2,588  tflops: 19.71  mfu: 6.32%
[rank0]:2025-11-07 03:45:08,751 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00

ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 11. 07. (ê¸ˆ) 03:49:05 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 0,1,2,3
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/1107_1F1B_timelyapf.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
âœ”ï¸Running with timelyapf x 1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=timelyapf --freezing.threshold=0.05 --freezing.percentile=80 --freezing.max_freeze_ratio=0.8
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank0]:2025-11-07 03:49:12,041 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
[rank0]:for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~"
[rank1]:2025-11-07 03:49:12,075 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
[rank1]:for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~"
[rank3]:2025-11-07 03:49:12,080 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
[rank3]:for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~"
[rank2]:2025-11-07 03:49:12,098 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
[rank2]:for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~"
[rank0]:2025-11-07 03:49:12,370 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-11-07 03:49:12,373 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-11-07 03:49:12,444 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-11-07 03:49:12,446 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-07 03:49:12,377 - INFO - [GC] Initial GC collection 0.00 seconds
[rank3]:2025-11-07 03:49:12,427 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-11-07 03:49:12,429 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-11-07 03:49:12,463 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-11-07 03:49:12,466 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-07 03:49:12,772 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-11-07 03:49:13,179 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank0]:2025-11-07 03:49:15,955 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=512, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank1]:2025-11-07 03:49:16,070 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-11-07 03:49:16,151 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-11-07 03:49:16,108 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-11-07 03:49:16,135 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-11-07 03:49:16,135 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2025-11-07 03:49:16,103 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-11-07 03:49:16,144 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-07 03:49:16,145 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-11-07 03:49:16,172 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-11-07 03:49:16,172 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank2]:2025-11-07 03:49:16,188 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-11-07 03:49:16,216 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-11-07 03:49:16,216 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2025-11-07 03:49:16,310 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-11-07 03:49:16,310 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-11-07 03:49:16,311 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank0]:2025-11-07 03:49:16,348 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-07 03:49:16,348 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-11-07 03:49:16,349 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank2]:2025-11-07 03:49:16,419 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-11-07 03:49:16,420 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-11-07 03:49:16,420 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run h2ymt248
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1107_1F1B_timelyapf_dm1/20251107-0349/wandb/run-20251107_034917-h2ymt248
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1107_1F1B_timelyapf_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/h2ymt248
[rank3]:2025-11-07 03:49:18,175 - INFO - WandB logging enabled
[rank3]:2025-11-07 03:49:18,177 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-11-07 03:49:18,216 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-11-07 03:49:18,244 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-11-07 03:49:18,245 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank2]:2025-11-07 03:49:18,448 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank1]:2025-11-07 03:49:18,447 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-07 03:49:18,447 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1107_1F1B_timelyapf_dm1
[rank0]:2025-11-07 03:49:18,448 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-07 03:49:18,448 - INFO - Trainer is initialized with local batch size 32, global batch size 128, gradient accumulation steps 4, sequence length 512, total steps 1200 (warmup 100)
[rank0]:2025-11-07 03:49:18,448 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank3]:2025-11-07 03:49:18,428 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-11-07 03:49:18,429 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-11-07 03:49:18,429 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2025-11-07 03:49:18,447 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-07 03:49:20,590 - INFO - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-11-07 03:49:20,590 - INFO - Finished loading the checkpoint in 2.14 seconds.
[rank0]:2025-11-07 03:49:20,590 - INFO - Training starts at step 1
[rank1]:2025-11-07 03:49:23,690 - INFO -  step:  1  loss: -4.0000  grad_norm: 174.8875  memory:  6.76GiB(14.24%)  tps: 2,161  tflops: 16.46  mfu: 5.28%
[rank1]:2025-11-07 03:49:23,690 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-11-07 03:49:23,688 - INFO -  step:  1  loss: -4.0000  grad_norm: 174.8875  memory:  4.63GiB(9.75%)  tps: 2,185  tflops: 16.64  mfu: 5.33%
[rank2]:2025-11-07 03:49:23,688 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-07 03:49:23,722 - INFO -  step:  1  loss: -4.0000  grad_norm: 174.8875  memory:  9.19GiB(19.34%)  tps: 2,162  tflops: 16.47  mfu: 5.28%
[rank0]:2025-11-07 03:49:23,723 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-11-07 03:49:23,697 - INFO -  step:  1  loss: 10.3018  grad_norm: 174.8875  memory: 12.97GiB(27.30%)  tps: 2,990  tflops: 22.78  mfu: 7.30%
[rank3]:2025-11-07 03:49:23,697 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-07 03:51:24,718 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-07 03:51:26,967 - INFO - Avg. fwd time: 12.8111 / Avg. bwd time: 40.8623 / Avg. batch time: 501.8686 (ms) / GPU bubble ratio: 14.44%
[rank0]:2025-11-07 03:51:27,037 - INFO - Avg. fwd time: 7.2343 / Avg. bwd time: 23.2226 / Avg. batch time: 609.0142 (ms) / GPU bubble ratio: 59.99%
[rank2]:2025-11-07 03:51:27,007 - INFO - Avg. fwd time: 7.1403 / Avg. bwd time: 18.6715 / Avg. batch time: 533.5882 (ms) / GPU bubble ratio: 61.30%
[rank1]:2025-11-07 03:51:27,041 - INFO - Avg. fwd time: 9.1517 / Avg. bwd time: 23.5047 / Avg. batch time: 572.1814 (ms) / GPU bubble ratio: 54.34%
[rank1]:2025-11-07 03:51:27,272 - INFO -  step: 50  loss: -4.0000  grad_norm: 15.4054  memory:  9.03GiB(19.01%)  tps: 6,496  tflops: 49.48  mfu: 15.86%
[rank0]:2025-11-07 03:51:27,282 - INFO -  step: 50  loss: -4.0000  grad_norm: 15.4054  memory: 12.97GiB(27.31%)  tps: 6,497  tflops: 49.49  mfu: 15.86%
[rank2]:2025-11-07 03:51:27,268 - INFO -  step: 50  loss: -4.0000  grad_norm: 15.4054  memory:  6.43GiB(13.53%)  tps: 6,496  tflops: 49.48  mfu: 15.86%
[rank3]:2025-11-07 03:51:27,280 - INFO -  step: 50  loss:  9.2117  grad_norm: 15.4054  memory: 16.39GiB(34.50%)  tps: 6,496  tflops: 49.48  mfu: 15.86%
[rank3]:2025-11-07 03:51:52,957 - INFO - [Step 60] ã€°ï¸ Monitoring Upperbound
[rank3]:2025-11-07 03:52:18,494 - INFO - [Step 70] âœ”ï¸  Setting Upperbound
[rank3]:2025-11-07 03:52:18,811 - INFO - [Step 70] ã€°ï¸ Monitoring Lowerbound
[rank1]:2025-11-07 03:52:18,874 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-07 03:52:18,906 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-07 03:52:18,862 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-07 03:52:18,887 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-07 03:52:18,911 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-07 03:52:18,878 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-07 03:52:18,906 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-07 03:52:18,932 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-07 03:52:18,862 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-07 03:52:18,883 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-07 03:52:18,901 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-07 03:52:18,923 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-07 03:52:18,947 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-07 03:52:18,934 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-07 03:52:18,999 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-07 03:52:18,952 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-07 03:52:18,976 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-07 03:52:19,021 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-07 03:52:19,001 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-07 03:52:18,968 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-07 03:52:19,005 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-07 03:52:19,042 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-07 03:52:19,073 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-07 03:52:19,087 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-07 03:52:19,110 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-07 03:52:19,061 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-07 03:52:19,092 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-07 03:52:19,047 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-07 03:52:19,048 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-07 03:52:19,048 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-07 03:52:19,049 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-07 03:52:19,050 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-07 03:52:52,985 - INFO - [Step 90] âœ”ï¸  Setting Lowerbound
[rank3]:2025-11-07 03:52:53,180 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1107_1F1B_timelyapf_dm1/pipeline_schedule/251107_0352_max_batch_time.svg
[rank3]:> Batch Time: 541.27 ms, GPU Bubble Ratio: 54.42%, 51.13%, 61.42%, 17.56%
[rank3]:2025-11-07 03:52:53,329 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1107_1F1B_timelyapf_dm1/pipeline_schedule/251107_0352_min_batch_time.svg
[rank3]:> Batch Time: 327.50 ms, GPU Bubble Ratio: 82.24%, 51.63%, 62.17%, 14.59%
[rank3]:2025-11-07 03:52:53,488 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1107_1F1B_timelyapf_dm1/pipeline_schedule/251107_0352_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 358.66 ms, GPU Bubble Ratio: 40.85%, 29.93%, 44.74%, 13.32%
[rank3]:2025-11-07 03:52:53,489 - INFO - 	> Batch Time: 358.66 ms (Average Freeze Ratio: 0.31, Time Reduction Rate: 0.34)
[rank0]:2025-11-07 03:53:11,534 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-07 03:53:13,294 - INFO - Avg. fwd time: 13.4202 / Avg. bwd time: 35.9113 / Avg. batch time: 467.0628 (ms) / GPU bubble ratio: 15.50%
[rank2]:2025-11-07 03:53:13,362 - INFO - Avg. fwd time: 7.4957 / Avg. bwd time: 16.3857 / Avg. batch time: 497.1438 (ms) / GPU bubble ratio: 61.57%
[rank0]:2025-11-07 03:53:13,394 - INFO - Avg. fwd time: 7.5753 / Avg. bwd time: 17.5081 / Avg. batch time: 563.4969 (ms) / GPU bubble ratio: 64.39%
[rank1]:2025-11-07 03:53:13,400 - INFO - Avg. fwd time: 9.5886 / Avg. bwd time: 20.5508 / Avg. batch time: 532.4669 (ms) / GPU bubble ratio: 54.72%
[rank3]:2025-11-07 03:53:13,506 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.33/1.00, [MB2] 0.33/1.00, [MB3] 0.33/1.00, [MB4] 0.13/0.40, [MB5] 0.33/1.00, [MB6] 0.33/1.00, [MB7] 0.33/1.00
[rank2]:2025-11-07 03:53:13,587 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.33/1.00
[rank2]:2025-11-07 03:53:13,588 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.6359  memory:  7.41GiB(15.59%)  tps: 7,705  tflops: 58.68  mfu: 18.81%
[rank3]:2025-11-07 03:53:13,559 - INFO -  step: 100  loss:  4.8315  grad_norm:  0.0000  memory: 19.34GiB(40.71%)  tps: 7,708  tflops: 58.71  mfu: 18.82%
[rank1]:2025-11-07 03:53:13,594 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.33/1.00
[rank1]:2025-11-07 03:53:13,595 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.6359  memory: 10.49GiB(22.09%)  tps: 7,705  tflops: 58.68  mfu: 18.81%
[rank1]:2025-11-07 03:53:13,673 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1107_1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251107_0353_stage1_step100.svg
[rank2]:2025-11-07 03:53:13,683 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1107_1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251107_0353_stage2_step100.svg
[rank0]:2025-11-07 03:53:13,617 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.16/0.47, [MB7] 0.33/1.00
[rank0]:2025-11-07 03:53:13,617 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.6359  memory: 15.28GiB(32.16%)  tps: 7,704  tflops: 58.68  mfu: 18.81%
[rank0]:2025-11-07 03:53:13,675 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1107_1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251107_0353_stage0_step100.svg
[rank3]:2025-11-07 03:53:13,753 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1107_1F1B_timelyapf_dm1/pipeline_schedule/251107_0353_real_step100_rank3.svg
[rank3]:> Batch Time: 476.17 ms, GPU Bubble Ratio: 70.58%, 52.74%, 61.08%, 34.78%
[rank3]:2025-11-07 03:53:13,794 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1107_1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251107_0353_stage3_step100.svg
[rank0]:2025-11-07 03:55:02,879 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-07 03:55:05,037 - INFO - Avg. fwd time: 9.6015 / Avg. bwd time: 20.6204 / Avg. batch time: 521.0122 (ms) / GPU bubble ratio: 53.60%
[rank2]:2025-11-07 03:55:05,010 - INFO - Avg. fwd time: 7.4727 / Avg. bwd time: 16.5793 / Avg. batch time: 485.3752 (ms) / GPU bubble ratio: 60.36%
[rank0]:2025-11-07 03:55:05,061 - INFO - Avg. fwd time: 7.6411 / Avg. bwd time: 17.7134 / Avg. batch time: 552.4163 (ms) / GPU bubble ratio: 63.28%
[rank3]:2025-11-07 03:55:04,987 - INFO - Avg. fwd time: 13.6985 / Avg. bwd time: 34.1189 / Avg. batch time: 455.5283 (ms) / GPU bubble ratio: 16.02%
[rank1]:2025-11-07 03:55:05,108 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.67/1.00
[rank1]:2025-11-07 03:55:05,108 - INFO -  step: 150  loss: -4.0000  grad_norm: 14.7208  memory: 10.49GiB(22.09%)  tps: 7,346  tflops: 55.95  mfu: 17.93%
[rank2]:2025-11-07 03:55:05,098 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.67/1.00
[rank2]:2025-11-07 03:55:05,098 - INFO -  step: 150  loss: -4.0000  grad_norm: 14.7208  memory:  7.41GiB(15.59%)  tps: 7,346  tflops: 55.95  mfu: 17.93%
[rank0]:2025-11-07 03:55:05,128 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.31/0.47, [MB7] 0.67/1.00
[rank0]:2025-11-07 03:55:05,128 - INFO -  step: 150  loss: -4.0000  grad_norm: 14.7208  memory: 17.47GiB(36.77%)  tps: 7,346  tflops: 55.95  mfu: 17.93%
[rank3]:2025-11-07 03:55:05,117 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.67/1.00, [MB2] 0.67/1.00, [MB3] 0.67/1.00, [MB4] 0.27/0.40, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank3]:2025-11-07 03:55:05,120 - INFO -  step: 150  loss:  1.8571  grad_norm: 14.7208  memory: 19.87GiB(41.82%)  tps: 7,343  tflops: 55.93  mfu: 17.93%
[rank0]:2025-11-07 03:56:45,285 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-07 03:56:47,089 - INFO - Avg. fwd time: 7.4871 / Avg. bwd time: 16.5118 / Avg. batch time: 471.3445 (ms) / GPU bubble ratio: 59.27%
[rank3]:2025-11-07 03:56:47,024 - INFO - Avg. fwd time: 13.8582 / Avg. bwd time: 32.1949 / Avg. batch time: 441.7875 (ms) / GPU bubble ratio: 16.61%
[rank1]:2025-11-07 03:56:47,128 - INFO - Avg. fwd time: 9.6592 / Avg. bwd time: 20.3220 / Avg. batch time: 506.9539 (ms) / GPU bubble ratio: 52.69%
[rank0]:2025-11-07 03:56:47,124 - INFO - Avg. fwd time: 7.7437 / Avg. bwd time: 17.0399 / Avg. batch time: 537.9402 (ms) / GPU bubble ratio: 63.14%
[rank3]:2025-11-07 03:56:47,285 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 0.40/0.40, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-11-07 03:56:47,288 - INFO -  step: 200  loss:  0.6582  grad_norm:  0.8434  memory: 19.87GiB(41.82%)  tps: 8,018  tflops: 61.07  mfu: 19.57%
[rank1]:2025-11-07 03:56:47,316 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-11-07 03:56:47,317 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.8434  memory: 10.49GiB(22.09%)  tps: 8,015  tflops: 61.04  mfu: 19.57%
[rank1]:2025-11-07 03:56:47,390 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1107_1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251107_0356_stage1_step200.svg
[rank2]:2025-11-07 03:56:47,308 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-07 03:56:47,309 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.8434  memory:  7.41GiB(15.59%)  tps: 8,015  tflops: 61.04  mfu: 19.57%
[rank2]:2025-11-07 03:56:47,390 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1107_1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251107_0356_stage2_step200.svg
[rank0]:2025-11-07 03:56:47,339 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.47/0.47, [MB7] 1.00/1.00
[rank0]:2025-11-07 03:56:47,339 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.8434  memory: 17.47GiB(36.77%)  tps: 8,015  tflops: 61.04  mfu: 19.56%
[rank0]:2025-11-07 03:56:47,388 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1107_1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251107_0356_stage0_step200.svg
[rank3]:2025-11-07 03:56:47,490 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1107_1F1B_timelyapf_dm1/pipeline_schedule/251107_0356_real_step200_rank3.svg
[rank3]:> Batch Time: 475.64 ms, GPU Bubble Ratio: 62.15%, 51.73%, 60.26%, 35.22%
[rank3]:2025-11-07 03:56:47,536 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1107_1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251107_0356_stage3_step200.svg
[rank0]:2025-11-07 03:58:24,836 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-07 03:58:26,533 - INFO - Avg. fwd time: 13.9963 / Avg. bwd time: 30.4403 / Avg. batch time: 429.0221 (ms) / GPU bubble ratio: 17.14%
[rank2]:2025-11-07 03:58:26,597 - INFO - Avg. fwd time: 7.5083 / Avg. bwd time: 16.3977 / Avg. batch time: 458.3661 (ms) / GPU bubble ratio: 58.28%
[rank0]:2025-11-07 03:58:26,628 - INFO - Avg. fwd time: 7.8061 / Avg. bwd time: 15.6522 / Avg. batch time: 524.4681 (ms) / GPU bubble ratio: 64.22%
[rank1]:2025-11-07 03:58:26,634 - INFO - Avg. fwd time: 9.7196 / Avg. bwd time: 19.9745 / Avg. batch time: 493.8865 (ms) / GPU bubble ratio: 51.90%
[rank3]:2025-11-07 03:58:26,726 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 0.40/0.40, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-11-07 03:58:26,814 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-11-07 03:58:26,814 - INFO -  step: 250  loss: -4.0000  grad_norm: 19.3808  memory: 10.49GiB(22.09%)  tps: 8,233  tflops: 62.71  mfu: 20.10%
[rank2]:2025-11-07 03:58:26,806 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-07 03:58:26,807 - INFO -  step: 250  loss: -4.0000  grad_norm: 19.3808  memory:  7.41GiB(15.59%)  tps: 8,233  tflops: 62.71  mfu: 20.10%
[rank3]:2025-11-07 03:58:26,779 - INFO -  step: 250  loss:  0.7640  grad_norm:  0.0000  memory: 19.87GiB(41.82%)  tps: 8,234  tflops: 62.71  mfu: 20.10%
[rank0]:2025-11-07 03:58:26,836 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.47/0.47, [MB7] 1.00/1.00
[rank0]:2025-11-07 03:58:26,837 - INFO -  step: 250  loss: -4.0000  grad_norm: 19.3808  memory: 17.47GiB(36.77%)  tps: 8,233  tflops: 62.71  mfu: 20.10%
[rank0]:2025-11-07 04:00:04,430 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-07 04:00:06,372 - INFO - Avg. fwd time: 7.5220 / Avg. bwd time: 16.3255 / Avg. batch time: 449.9755 (ms) / GPU bubble ratio: 57.60%
[rank3]:2025-11-07 04:00:06,350 - INFO - Avg. fwd time: 14.0908 / Avg. bwd time: 29.3081 / Avg. batch time: 420.8585 (ms) / GPU bubble ratio: 17.50%
[rank3]:2025-11-07 04:00:06,364 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 0.40/0.40, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-11-07 04:00:06,399 - INFO - Avg. fwd time: 9.7632 / Avg. bwd time: 19.7542 / Avg. batch time: 485.4462 (ms) / GPU bubble ratio: 51.36%
[rank0]:2025-11-07 04:00:06,422 - INFO - Avg. fwd time: 7.8437 / Avg. bwd time: 14.7006 / Avg. batch time: 515.7585 (ms) / GPU bubble ratio: 65.03%
[rank2]:2025-11-07 04:00:06,459 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-07 04:00:06,459 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.2136  memory:  7.41GiB(15.59%)  tps: 8,221  tflops: 62.61  mfu: 20.07%
[rank3]:2025-11-07 04:00:06,431 - INFO -  step: 300  loss:  0.6431  grad_norm:  0.0000  memory: 19.87GiB(41.82%)  tps: 8,221  tflops: 62.61  mfu: 20.07%
[rank1]:2025-11-07 04:00:06,467 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-11-07 04:00:06,467 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.2136  memory: 10.49GiB(22.09%)  tps: 8,221  tflops: 62.61  mfu: 20.07%
[rank1]:2025-11-07 04:00:06,537 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1107_1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251107_0400_stage1_step300.svg
[rank0]:2025-11-07 04:00:06,489 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.47/0.47, [MB7] 1.00/1.00
[rank0]:2025-11-07 04:00:06,489 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.2136  memory: 17.47GiB(36.77%)  tps: 8,221  tflops: 62.61  mfu: 20.07%
[rank0]:2025-11-07 04:00:06,536 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1107_1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251107_0400_stage0_step300.svg
[rank2]:2025-11-07 04:00:06,536 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1107_1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251107_0400_stage2_step300.svg
[rank3]:2025-11-07 04:00:06,628 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1107_1F1B_timelyapf_dm1/pipeline_schedule/251107_0400_real_step300_rank3.svg
[rank3]:> Batch Time: 471.16 ms, GPU Bubble Ratio: 68.12%, 51.13%, 59.82%, 35.32%
[rank3]:2025-11-07 04:00:06,670 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1107_1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251107_0400_stage3_step300.svg
[rank0]:2025-11-07 04:01:44,616 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-07 04:01:46,346 - INFO - Avg. fwd time: 14.1552 / Avg. bwd time: 28.6416 / Avg. batch time: 416.0796 (ms) / GPU bubble ratio: 17.71%
[rank2]:2025-11-07 04:01:46,414 - INFO - Avg. fwd time: 7.5310 / Avg. bwd time: 16.2841 / Avg. batch time: 445.1420 (ms) / GPU bubble ratio: 57.20%
[rank0]:2025-11-07 04:01:46,445 - INFO - Avg. fwd time: 7.8675 / Avg. bwd time: 14.1244 / Avg. batch time: 510.7314 (ms) / GPU bubble ratio: 65.55%
[rank1]:2025-11-07 04:01:46,452 - INFO - Avg. fwd time: 9.7925 / Avg. bwd time: 19.6212 / Avg. batch time: 480.5828 (ms) / GPU bubble ratio: 51.04%
[rank3]:2025-11-07 04:01:46,609 - INFO -  step: 350  loss:  0.6379  grad_norm:  0.0000  memory: 19.87GiB(41.82%)  tps: 8,178  tflops: 62.28  mfu: 19.96%
[rank1]:2025-11-07 04:01:46,645 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.3132  memory: 10.49GiB(22.09%)  tps: 8,177  tflops: 62.28  mfu: 19.96%
[rank2]:2025-11-07 04:01:46,637 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.3132  memory:  7.41GiB(15.59%)  tps: 8,177  tflops: 62.28  mfu: 19.96%
[rank0]:2025-11-07 04:01:46,668 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.3132  memory: 17.47GiB(36.77%)  tps: 8,177  tflops: 62.28  mfu: 19.96%
[rank0]:2025-11-07 04:03:23,954 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-07 04:03:25,685 - INFO - Avg. fwd time: 14.2101 / Avg. bwd time: 28.0149 / Avg. batch time: 411.5590 (ms) / GPU bubble ratio: 17.92%
[rank2]:2025-11-07 04:03:25,752 - INFO - Avg. fwd time: 7.5391 / Avg. bwd time: 16.2459 / Avg. batch time: 440.4816 (ms) / GPU bubble ratio: 56.80%
[rank0]:2025-11-07 04:03:25,785 - INFO - Avg. fwd time: 7.8880 / Avg. bwd time: 13.6033 / Avg. batch time: 505.9103 (ms) / GPU bubble ratio: 66.02%
[rank1]:2025-11-07 04:03:25,792 - INFO - Avg. fwd time: 9.8177 / Avg. bwd time: 19.5062 / Avg. batch time: 475.9033 (ms) / GPU bubble ratio: 50.71%
[rank3]:2025-11-07 04:03:25,939 - INFO -  step: 400  loss:  0.6466  grad_norm:  0.0000  memory: 19.87GiB(41.82%)  tps: 8,247  tflops: 62.81  mfu: 20.13%
[rank0]:2025-11-07 04:03:25,997 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.4363  memory: 17.47GiB(36.77%)  tps: 8,247  tflops: 62.81  mfu: 20.13%
[rank1]:2025-11-07 04:03:25,975 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.4363  memory: 10.49GiB(22.09%)  tps: 8,247  tflops: 62.81  mfu: 20.13%
[rank2]:2025-11-07 04:03:25,967 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.4363  memory:  7.41GiB(15.59%)  tps: 8,247  tflops: 62.81  mfu: 20.13%
[rank2]:2025-11-07 04:03:26,054 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1107_1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251107_0403_stage2_step400.svg
[rank0]:2025-11-07 04:03:26,049 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1107_1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251107_0403_stage0_step400.svg
[rank1]:2025-11-07 04:03:26,049 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1107_1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251107_0403_stage1_step400.svg
[rank3]:2025-11-07 04:03:26,135 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1107_1F1B_timelyapf_dm1/pipeline_schedule/251107_0403_real_step400_rank3.svg
[rank3]:> Batch Time: 471.70 ms, GPU Bubble Ratio: 68.93%, 51.11%, 59.81%, 35.50%
[rank3]:2025-11-07 04:03:26,181 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1107_1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251107_0403_stage3_step400.svg
[rank3]:2025-11-07 04:03:36,331 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-11-07 04:03:36,533 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-11-07 04:03:36,575 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-11-07 04:03:36,556 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-11-07 04:05:03,615 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-07 04:05:05,535 - INFO - Avg. fwd time: 14.2486 / Avg. bwd time: 27.5409 / Avg. batch time: 408.1246 (ms) / GPU bubble ratio: 18.08%
[rank2]:2025-11-07 04:05:05,558 - INFO - Avg. fwd time: 7.5447 / Avg. bwd time: 16.2175 / Avg. batch time: 437.0010 (ms) / GPU bubble ratio: 56.50%
[rank0]:2025-11-07 04:05:05,609 - INFO - Avg. fwd time: 7.9029 / Avg. bwd time: 13.2138 / Avg. batch time: 502.3005 (ms) / GPU bubble ratio: 66.37%
[rank1]:2025-11-07 04:05:05,585 - INFO - Avg. fwd time: 9.8354 / Avg. bwd time: 19.4157 / Avg. batch time: 472.4003 (ms) / GPU bubble ratio: 50.46%
[rank1]:2025-11-07 04:05:05,654 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.1757  memory: 10.49GiB(22.09%)  tps: 8,218  tflops: 62.59  mfu: 20.06%
[rank3]:2025-11-07 04:05:05,619 - INFO -  step: 450  loss:  0.6362  grad_norm:  0.0000  memory: 19.87GiB(41.82%)  tps: 8,218  tflops: 62.59  mfu: 20.06%
[rank2]:2025-11-07 04:05:05,647 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.1757  memory:  7.41GiB(15.59%)  tps: 8,218  tflops: 62.59  mfu: 20.06%
[rank0]:2025-11-07 04:05:05,677 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.1757  memory: 17.47GiB(36.77%)  tps: 8,218  tflops: 62.59  mfu: 20.06%
[rank0]:2025-11-07 04:06:43,420 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-07 04:06:45,157 - INFO - Avg. fwd time: 14.2736 / Avg. bwd time: 27.2369 / Avg. batch time: 405.9038 (ms) / GPU bubble ratio: 18.19%
[rank2]:2025-11-07 04:06:45,226 - INFO - Avg. fwd time: 7.5482 / Avg. bwd time: 16.1964 / Avg. batch time: 434.7074 (ms) / GPU bubble ratio: 56.30%
[rank0]:2025-11-07 04:06:45,257 - INFO - Avg. fwd time: 7.9132 / Avg. bwd time: 12.9668 / Avg. batch time: 499.9023 (ms) / GPU bubble ratio: 66.59%
[rank1]:2025-11-07 04:06:45,265 - INFO - Avg. fwd time: 9.8471 / Avg. bwd time: 19.3504 / Avg. batch time: 470.0782 (ms) / GPU bubble ratio: 50.31%
[rank3]:2025-11-07 04:06:45,412 - INFO -  step: 500  loss:  0.6567  grad_norm:  0.0000  memory: 19.87GiB(41.82%)  tps: 8,209  tflops: 62.52  mfu: 20.04%
[rank0]:2025-11-07 04:06:45,470 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.1242  memory: 17.47GiB(36.77%)  tps: 8,209  tflops: 62.52  mfu: 20.04%
[rank1]:2025-11-07 04:06:45,450 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.1242  memory: 10.49GiB(22.09%)  tps: 8,209  tflops: 62.52  mfu: 20.04%
[rank2]:2025-11-07 04:06:45,440 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.1242  memory:  7.41GiB(15.59%)  tps: 8,209  tflops: 62.52  mfu: 20.04%
[rank2]:2025-11-07 04:06:45,518 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1107_1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251107_0406_stage2_step500.svg
[rank0]:2025-11-07 04:06:45,518 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1107_1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251107_0406_stage0_step500.svg
[rank1]:2025-11-07 04:06:45,522 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1107_1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251107_0406_stage1_step500.svg
[rank3]:2025-11-07 04:06:45,617 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1107_1F1B_timelyapf_dm1/pipeline_schedule/251107_0406_real_step500_rank3.svg
[rank3]:> Batch Time: 474.70 ms, GPU Bubble Ratio: 68.39%, 51.61%, 60.18%, 34.47%
[rank3]:2025-11-07 04:06:45,660 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1107_1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251107_0406_stage3_step500.svg
[rank0]:2025-11-07 04:08:23,949 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-07 04:08:25,687 - INFO - Avg. fwd time: 14.3040 / Avg. bwd time: 26.9526 / Avg. batch time: 403.9410 (ms) / GPU bubble ratio: 18.29%
[rank2]:2025-11-07 04:08:25,754 - INFO - Avg. fwd time: 7.5515 / Avg. bwd time: 16.1760 / Avg. batch time: 432.7243 (ms) / GPU bubble ratio: 56.13%
[rank0]:2025-11-07 04:08:25,786 - INFO - Avg. fwd time: 7.9231 / Avg. bwd time: 12.7128 / Avg. batch time: 497.8189 (ms) / GPU bubble ratio: 66.84%
[rank1]:2025-11-07 04:08:25,794 - INFO - Avg. fwd time: 9.8597 / Avg. bwd time: 19.2870 / Avg. batch time: 468.0698 (ms) / GPU bubble ratio: 50.18%
[rank3]:2025-11-07 04:08:25,946 - INFO -  step: 550  loss:  0.6852  grad_norm:  0.0000  memory: 19.87GiB(41.82%)  tps: 8,149  tflops: 62.06  mfu: 19.89%
[rank0]:2025-11-07 04:08:26,004 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.1952  memory: 17.47GiB(36.77%)  tps: 8,149  tflops: 62.06  mfu: 19.89%
[rank1]:2025-11-07 04:08:25,982 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.1952  memory: 10.49GiB(22.09%)  tps: 8,149  tflops: 62.06  mfu: 19.89%
[rank2]:2025-11-07 04:08:25,974 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.1952  memory:  7.41GiB(15.59%)  tps: 8,149  tflops: 62.06  mfu: 19.89%
[rank0]:2025-11-07 04:10:02,978 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-07 04:10:04,959 - INFO - Avg. fwd time: 9.8721 / Avg. bwd time: 19.2421 / Avg. batch time: 465.8909 (ms) / GPU bubble ratio: 50.01%
[rank2]:2025-11-07 04:10:04,930 - INFO - Avg. fwd time: 7.5553 / Avg. bwd time: 16.1616 / Avg. batch time: 430.5450 (ms) / GPU bubble ratio: 55.93%
[rank3]:2025-11-07 04:10:04,906 - INFO - Avg. fwd time: 14.3237 / Avg. bwd time: 26.6642 / Avg. batch time: 401.8278 (ms) / GPU bubble ratio: 18.40%
[rank3]:2025-11-07 04:10:04,993 - INFO -  step: 600  loss:  0.6263  grad_norm:  0.0000  memory: 19.87GiB(41.82%)  tps: 8,271  tflops: 62.99  mfu: 20.19%
[rank0]:2025-11-07 04:10:04,983 - INFO - Avg. fwd time: 7.9321 / Avg. bwd time: 12.4982 / Avg. batch time: 495.5857 (ms) / GPU bubble ratio: 67.02%
[rank0]:2025-11-07 04:10:05,051 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.1267  memory: 17.47GiB(36.77%)  tps: 8,271  tflops: 62.99  mfu: 20.19%
[rank1]:2025-11-07 04:10:05,028 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.1267  memory: 10.49GiB(22.09%)  tps: 8,271  tflops: 62.99  mfu: 20.19%
[rank2]:2025-11-07 04:10:05,021 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.1267  memory:  7.41GiB(15.59%)  tps: 8,271  tflops: 62.99  mfu: 20.19%
[rank0]:2025-11-07 04:10:05,099 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1107_1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251107_0410_stage0_step600.svg
[rank1]:2025-11-07 04:10:05,100 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1107_1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251107_0410_stage1_step600.svg
[rank2]:2025-11-07 04:10:05,099 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1107_1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251107_0410_stage2_step600.svg
[rank3]:2025-11-07 04:10:05,190 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1107_1F1B_timelyapf_dm1/pipeline_schedule/251107_0410_real_step600_rank3.svg
[rank3]:> Batch Time: 470.97 ms, GPU Bubble Ratio: 68.14%, 51.06%, 59.76%, 35.27%
[rank3]:2025-11-07 04:10:05,233 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1107_1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251107_0410_stage3_step600.svg
[rank0]:2025-11-07 04:11:43,170 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-07 04:11:44,903 - INFO - Avg. fwd time: 14.3423 / Avg. bwd time: 26.4898 / Avg. batch time: 400.5907 (ms) / GPU bubble ratio: 18.46%
[rank1]:2025-11-07 04:11:45,009 - INFO - Avg. fwd time: 9.8804 / Avg. bwd time: 19.2068 / Avg. batch time: 464.6361 (ms) / GPU bubble ratio: 49.92%
[rank2]:2025-11-07 04:11:44,972 - INFO - Avg. fwd time: 7.5579 / Avg. bwd time: 16.1512 / Avg. batch time: 429.3051 (ms) / GPU bubble ratio: 55.82%
[rank0]:2025-11-07 04:11:45,001 - INFO - Avg. fwd time: 7.9384 / Avg. bwd time: 12.3281 / Avg. batch time: 494.2887 (ms) / GPU bubble ratio: 67.20%
[rank1]:2025-11-07 04:11:45,198 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.2021  memory: 10.49GiB(22.09%)  tps: 8,178  tflops: 62.29  mfu: 19.96%
[rank2]:2025-11-07 04:11:45,191 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.2021  memory:  7.41GiB(15.59%)  tps: 8,178  tflops: 62.29  mfu: 19.96%
[rank3]:2025-11-07 04:11:45,163 - INFO -  step: 650  loss:  0.6336  grad_norm:  0.0000  memory: 19.87GiB(41.82%)  tps: 8,178  tflops: 62.29  mfu: 19.96%
[rank0]:2025-11-07 04:11:45,221 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.2021  memory: 17.47GiB(36.77%)  tps: 8,178  tflops: 62.29  mfu: 19.96%
[rank0]:2025-11-07 04:13:23,196 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-07 04:13:24,938 - INFO - Avg. fwd time: 14.3612 / Avg. bwd time: 26.3225 / Avg. batch time: 399.4160 (ms) / GPU bubble ratio: 18.51%
[rank1]:2025-11-07 04:13:25,044 - INFO - Avg. fwd time: 9.8885 / Avg. bwd time: 19.1703 / Avg. batch time: 463.3961 (ms) / GPU bubble ratio: 49.83%
[rank2]:2025-11-07 04:13:25,005 - INFO - Avg. fwd time: 7.5605 / Avg. bwd time: 16.1406 / Avg. batch time: 428.0854 (ms) / GPU bubble ratio: 55.71%
[rank0]:2025-11-07 04:13:25,035 - INFO - Avg. fwd time: 7.9450 / Avg. bwd time: 12.1690 / Avg. batch time: 493.0066 (ms) / GPU bubble ratio: 67.36%
[rank1]:2025-11-07 04:13:25,226 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.1021  memory: 10.49GiB(22.09%)  tps: 8,190  tflops: 62.37  mfu: 19.99%
[rank2]:2025-11-07 04:13:25,218 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.1021  memory:  7.41GiB(15.59%)  tps: 8,190  tflops: 62.38  mfu: 19.99%
[rank3]:2025-11-07 04:13:25,190 - INFO -  step: 700  loss:  0.6105  grad_norm:  0.0000  memory: 19.87GiB(41.82%)  tps: 8,190  tflops: 62.38  mfu: 19.99%
[rank0]:2025-11-07 04:13:25,248 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.1021  memory: 17.47GiB(36.77%)  tps: 8,190  tflops: 62.37  mfu: 19.99%
[rank0]:2025-11-07 04:13:25,299 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1107_1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251107_0413_stage0_step700.svg
[rank1]:2025-11-07 04:13:25,299 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1107_1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251107_0413_stage1_step700.svg
[rank2]:2025-11-07 04:13:25,299 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1107_1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251107_0413_stage2_step700.svg
[rank3]:2025-11-07 04:13:25,386 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1107_1F1B_timelyapf_dm1/pipeline_schedule/251107_0413_real_step700_rank3.svg
[rank3]:> Batch Time: 474.91 ms, GPU Bubble Ratio: 68.43%, 51.54%, 60.09%, 35.69%
[rank3]:2025-11-07 04:13:25,431 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1107_1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251107_0413_stage3_step700.svg
[rank0]:2025-11-07 04:15:03,383 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-07 04:15:05,309 - INFO - Avg. fwd time: 14.3760 / Avg. bwd time: 26.1760 / Avg. batch time: 398.3633 (ms) / GPU bubble ratio: 18.56%
[rank1]:2025-11-07 04:15:05,363 - INFO - Avg. fwd time: 9.8949 / Avg. bwd time: 19.1392 / Avg. batch time: 462.3257 (ms) / GPU bubble ratio: 49.76%
[rank2]:2025-11-07 04:15:05,335 - INFO - Avg. fwd time: 7.5628 / Avg. bwd time: 16.1322 / Avg. batch time: 427.0290 (ms) / GPU bubble ratio: 55.61%
[rank3]:2025-11-07 04:15:05,398 - INFO -  step: 750  loss:  0.6602  grad_norm:  0.0000  memory: 19.87GiB(41.82%)  tps: 8,175  tflops: 62.26  mfu: 19.96%
[rank0]:2025-11-07 04:15:05,389 - INFO - Avg. fwd time: 7.9509 / Avg. bwd time: 12.0285 / Avg. batch time: 491.9007 (ms) / GPU bubble ratio: 67.51%
[rank0]:2025-11-07 04:15:05,457 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1824  memory: 17.47GiB(36.77%)  tps: 8,175  tflops: 62.26  mfu: 19.96%
[rank1]:2025-11-07 04:15:05,434 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1824  memory: 10.49GiB(22.09%)  tps: 8,175  tflops: 62.26  mfu: 19.96%
[rank2]:2025-11-07 04:15:05,426 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1824  memory:  7.41GiB(15.59%)  tps: 8,175  tflops: 62.26  mfu: 19.96%
[rank0]:2025-11-07 04:16:43,892 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-07 04:16:45,655 - INFO - Avg. fwd time: 14.3853 / Avg. bwd time: 26.0850 / Avg. batch time: 397.7182 (ms) / GPU bubble ratio: 18.60%
[rank2]:2025-11-07 04:16:45,722 - INFO - Avg. fwd time: 7.5641 / Avg. bwd time: 16.1252 / Avg. batch time: 426.3544 (ms) / GPU bubble ratio: 55.55%
[rank0]:2025-11-07 04:16:45,751 - INFO - Avg. fwd time: 7.9553 / Avg. bwd time: 11.9364 / Avg. batch time: 491.1787 (ms) / GPU bubble ratio: 67.60%
[rank1]:2025-11-07 04:16:45,760 - INFO - Avg. fwd time: 9.8988 / Avg. bwd time: 19.1128 / Avg. batch time: 461.6294 (ms) / GPU bubble ratio: 49.72%
[rank3]:2025-11-07 04:16:45,913 - INFO -  step: 800  loss:  0.6196  grad_norm:  0.0000  memory: 19.87GiB(41.82%)  tps: 8,150  tflops: 62.07  mfu: 19.90%
[rank0]:2025-11-07 04:16:45,971 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1379  memory: 17.47GiB(36.77%)  tps: 8,150  tflops: 62.07  mfu: 19.90%
[rank1]:2025-11-07 04:16:45,948 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1379  memory: 10.49GiB(22.09%)  tps: 8,150  tflops: 62.07  mfu: 19.90%
[rank1]:2025-11-07 04:16:46,023 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1107_1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251107_0416_stage1_step800.svg
[rank2]:2025-11-07 04:16:45,941 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1379  memory:  7.41GiB(15.59%)  tps: 8,150  tflops: 62.07  mfu: 19.90%
[rank2]:2025-11-07 04:16:46,023 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1107_1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251107_0416_stage2_step800.svg
[rank0]:2025-11-07 04:16:46,023 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1107_1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251107_0416_stage0_step800.svg
[rank3]:2025-11-07 04:16:46,110 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1107_1F1B_timelyapf_dm1/pipeline_schedule/251107_0416_real_step800_rank3.svg
[rank3]:> Batch Time: 478.95 ms, GPU Bubble Ratio: 68.73%, 52.08%, 60.49%, 34.97%
[rank3]:2025-11-07 04:16:46,156 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1107_1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251107_0416_stage3_step800.svg
[rank3]:2025-11-07 04:17:07,031 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-11-07 04:17:07,233 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-11-07 04:17:07,255 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-11-07 04:17:07,274 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-11-07 04:18:23,428 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-07 04:18:25,139 - INFO - Avg. fwd time: 14.3906 / Avg. bwd time: 25.9551 / Avg. batch time: 396.7468 (ms) / GPU bubble ratio: 18.65%
[rank2]:2025-11-07 04:18:25,206 - INFO - Avg. fwd time: 7.5652 / Avg. bwd time: 16.1171 / Avg. batch time: 425.3746 (ms) / GPU bubble ratio: 55.46%
[rank1]:2025-11-07 04:18:25,246 - INFO - Avg. fwd time: 9.9027 / Avg. bwd time: 19.0864 / Avg. batch time: 460.6360 (ms) / GPU bubble ratio: 49.65%
[rank0]:2025-11-07 04:18:25,237 - INFO - Avg. fwd time: 7.9588 / Avg. bwd time: 11.8186 / Avg. batch time: 490.1543 (ms) / GPU bubble ratio: 67.72%
[rank3]:2025-11-07 04:18:25,388 - INFO -  step: 850  loss:  0.6229  grad_norm:  0.0000  memory: 19.87GiB(41.82%)  tps: 8,235  tflops: 62.72  mfu: 20.10%
[rank2]:2025-11-07 04:18:25,416 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.2311  memory:  7.41GiB(15.59%)  tps: 8,235  tflops: 62.72  mfu: 20.10%
[rank1]:2025-11-07 04:18:25,424 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.2311  memory: 10.49GiB(22.09%)  tps: 8,235  tflops: 62.72  mfu: 20.10%
[rank0]:2025-11-07 04:18:25,448 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.2311  memory: 17.47GiB(36.77%)  tps: 8,235  tflops: 62.72  mfu: 20.10%
[rank0]:2025-11-07 04:20:03,092 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-07 04:20:05,082 - INFO - Avg. fwd time: 7.5665 / Avg. bwd time: 16.1106 / Avg. batch time: 424.5419 (ms) / GPU bubble ratio: 55.38%
[rank1]:2025-11-07 04:20:05,111 - INFO - Avg. fwd time: 9.9062 / Avg. bwd time: 19.0646 / Avg. batch time: 459.7896 (ms) / GPU bubble ratio: 49.59%
[rank3]:2025-11-07 04:20:05,056 - INFO - Avg. fwd time: 14.3994 / Avg. bwd time: 25.8445 / Avg. batch time: 395.9446 (ms) / GPU bubble ratio: 18.69%
[rank0]:2025-11-07 04:20:05,137 - INFO - Avg. fwd time: 7.9624 / Avg. bwd time: 11.7254 / Avg. batch time: 489.2868 (ms) / GPU bubble ratio: 67.81%
[rank2]:2025-11-07 04:20:05,175 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.1113  memory:  7.41GiB(15.59%)  tps: 8,212  tflops: 62.54  mfu: 20.05%
[rank1]:2025-11-07 04:20:05,182 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.1113  memory: 10.49GiB(22.09%)  tps: 8,212  tflops: 62.54  mfu: 20.05%
[rank3]:2025-11-07 04:20:05,147 - INFO -  step: 900  loss:  0.6086  grad_norm:  0.0000  memory: 19.87GiB(41.82%)  tps: 8,212  tflops: 62.54  mfu: 20.05%
[rank0]:2025-11-07 04:20:05,205 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.1113  memory: 17.47GiB(36.77%)  tps: 8,212  tflops: 62.54  mfu: 20.05%
[rank0]:2025-11-07 04:20:05,251 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1107_1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251107_0420_stage0_step900.svg
[rank2]:2025-11-07 04:20:05,251 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1107_1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251107_0420_stage2_step900.svg
[rank1]:2025-11-07 04:20:05,252 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1107_1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251107_0420_stage1_step900.svg
[rank3]:2025-11-07 04:20:05,345 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1107_1F1B_timelyapf_dm1/pipeline_schedule/251107_0420_real_step900_rank3.svg
[rank3]:> Batch Time: 480.47 ms, GPU Bubble Ratio: 69.64%, 52.13%, 60.59%, 34.71%
[rank3]:2025-11-07 04:20:05,385 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1107_1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251107_0420_stage3_step900.svg
[rank0]:2025-11-07 04:21:43,616 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-07 04:21:45,323 - INFO - Avg. fwd time: 14.4084 / Avg. bwd time: 25.7794 / Avg. batch time: 395.5026 (ms) / GPU bubble ratio: 18.71%
[rank2]:2025-11-07 04:21:45,393 - INFO - Avg. fwd time: 7.5675 / Avg. bwd time: 16.1053 / Avg. batch time: 424.1070 (ms) / GPU bubble ratio: 55.35%
[rank1]:2025-11-07 04:21:45,431 - INFO - Avg. fwd time: 9.9093 / Avg. bwd time: 19.0473 / Avg. batch time: 459.3409 (ms) / GPU bubble ratio: 49.57%
[rank0]:2025-11-07 04:21:45,421 - INFO - Avg. fwd time: 7.9655 / Avg. bwd time: 11.6573 / Avg. batch time: 488.8221 (ms) / GPU bubble ratio: 67.89%
[rank3]:2025-11-07 04:21:45,571 - INFO -  step: 950  loss:  0.6382  grad_norm:  0.0000  memory: 19.87GiB(41.82%)  tps: 8,158  tflops: 62.13  mfu: 19.91%
[rank2]:2025-11-07 04:21:45,599 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.2920  memory:  7.41GiB(15.59%)  tps: 8,157  tflops: 62.13  mfu: 19.91%
[rank1]:2025-11-07 04:21:45,608 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.2920  memory: 10.49GiB(22.09%)  tps: 8,157  tflops: 62.13  mfu: 19.91%
[rank0]:2025-11-07 04:21:45,629 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.2920  memory: 17.47GiB(36.77%)  tps: 8,157  tflops: 62.13  mfu: 19.91%
[rank0]:2025-11-07 04:23:23,912 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-07 04:23:25,679 - INFO - Avg. fwd time: 14.4170 / Avg. bwd time: 25.7009 / Avg. batch time: 394.9593 (ms) / GPU bubble ratio: 18.74%
[rank2]:2025-11-07 04:23:25,748 - INFO - Avg. fwd time: 7.5686 / Avg. bwd time: 16.1005 / Avg. batch time: 423.5398 (ms) / GPU bubble ratio: 55.29%
[rank1]:2025-11-07 04:23:25,785 - INFO - Avg. fwd time: 9.9117 / Avg. bwd time: 19.0293 / Avg. batch time: 458.7636 (ms) / GPU bubble ratio: 49.53%
[rank0]:2025-11-07 04:23:25,775 - INFO - Avg. fwd time: 7.9693 / Avg. bwd time: 11.5875 / Avg. batch time: 488.2291 (ms) / GPU bubble ratio: 67.95%
[rank2]:2025-11-07 04:23:25,964 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.1142  memory:  7.41GiB(15.59%)  tps: 8,162  tflops: 62.17  mfu: 19.92%
[rank1]:2025-11-07 04:23:25,973 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.1142  memory: 10.49GiB(22.09%)  tps: 8,162  tflops: 62.17  mfu: 19.92%
[rank3]:2025-11-07 04:23:25,937 - INFO -  step: 1000  loss:  0.6210  grad_norm:  0.0000  memory: 19.87GiB(41.82%)  tps: 8,162  tflops: 62.17  mfu: 19.93%
[rank0]:2025-11-07 04:23:25,995 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.1142  memory: 17.47GiB(36.77%)  tps: 8,162  tflops: 62.16  mfu: 19.92%
[rank0]:2025-11-07 04:23:26,043 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1107_1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251107_0423_stage0_step1000.svg
[rank2]:2025-11-07 04:23:26,043 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1107_1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251107_0423_stage2_step1000.svg
[rank1]:2025-11-07 04:23:26,045 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1107_1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251107_0423_stage1_step1000.svg
[rank3]:2025-11-07 04:23:26,139 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1107_1F1B_timelyapf_dm1/pipeline_schedule/251107_0423_real_step1000_rank3.svg
[rank3]:> Batch Time: 478.02 ms, GPU Bubble Ratio: 68.52%, 51.94%, 60.39%, 34.89%
[rank3]:2025-11-07 04:23:26,181 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1107_1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251107_0423_stage3_step1000.svg
[rank0]:2025-11-07 04:25:03,481 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-07 04:25:05,425 - INFO - Avg. fwd time: 14.4220 / Avg. bwd time: 25.6096 / Avg. batch time: 394.2860 (ms) / GPU bubble ratio: 18.78%
[rank2]:2025-11-07 04:25:05,452 - INFO - Avg. fwd time: 7.5700 / Avg. bwd time: 16.0972 / Avg. batch time: 422.8686 (ms) / GPU bubble ratio: 55.23%
[rank1]:2025-11-07 04:25:05,483 - INFO - Avg. fwd time: 9.9141 / Avg. bwd time: 19.0156 / Avg. batch time: 458.0949 (ms) / GPU bubble ratio: 49.48%
[rank3]:2025-11-07 04:25:05,520 - INFO -  step: 1050  loss:  0.6573  grad_norm:  0.0000  memory: 19.87GiB(41.82%)  tps: 8,227  tflops: 62.65  mfu: 20.08%
[rank0]:2025-11-07 04:25:05,510 - INFO - Avg. fwd time: 7.9726 / Avg. bwd time: 11.5359 / Avg. batch time: 487.5449 (ms) / GPU bubble ratio: 67.99%
[rank0]:2025-11-07 04:25:05,577 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.1407  memory: 17.47GiB(36.77%)  tps: 8,226  tflops: 62.65  mfu: 20.08%
[rank2]:2025-11-07 04:25:05,547 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.1407  memory:  7.41GiB(15.59%)  tps: 8,226  tflops: 62.65  mfu: 20.08%
[rank1]:2025-11-07 04:25:05,555 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.1407  memory: 10.49GiB(22.09%)  tps: 8,226  tflops: 62.65  mfu: 20.08%
[rank0]:2025-11-07 04:26:43,822 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-07 04:26:45,554 - INFO - Avg. fwd time: 14.4283 / Avg. bwd time: 25.5638 / Avg. batch time: 393.9746 (ms) / GPU bubble ratio: 18.79%
[rank2]:2025-11-07 04:26:45,624 - INFO - Avg. fwd time: 7.5708 / Avg. bwd time: 16.0938 / Avg. batch time: 422.5408 (ms) / GPU bubble ratio: 55.20%
[rank0]:2025-11-07 04:26:45,652 - INFO - Avg. fwd time: 7.9754 / Avg. bwd time: 11.4840 / Avg. batch time: 487.2026 (ms) / GPU bubble ratio: 68.05%
[rank1]:2025-11-07 04:26:45,662 - INFO - Avg. fwd time: 9.9159 / Avg. bwd time: 19.0039 / Avg. batch time: 457.7637 (ms) / GPU bubble ratio: 49.46%
[rank2]:2025-11-07 04:26:45,830 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.1584  memory:  7.41GiB(15.59%)  tps: 8,169  tflops: 62.22  mfu: 19.94%
[rank1]:2025-11-07 04:26:45,838 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.1584  memory: 10.49GiB(22.09%)  tps: 8,169  tflops: 62.22  mfu: 19.94%
[rank3]:2025-11-07 04:26:45,802 - INFO -  step: 1100  loss:  0.6325  grad_norm:  0.0000  memory: 19.87GiB(41.82%)  tps: 8,169  tflops: 62.22  mfu: 19.94%
[rank0]:2025-11-07 04:26:45,860 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.1584  memory: 17.47GiB(36.77%)  tps: 8,169  tflops: 62.22  mfu: 19.94%
[rank0]:2025-11-07 04:26:45,907 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1107_1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251107_0426_stage0_step1100.svg
[rank2]:2025-11-07 04:26:45,908 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1107_1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251107_0426_stage2_step1100.svg
[rank1]:2025-11-07 04:26:45,908 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1107_1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251107_0426_stage1_step1100.svg
[rank3]:2025-11-07 04:26:46,000 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1107_1F1B_timelyapf_dm1/pipeline_schedule/251107_0426_real_step1100_rank3.svg
[rank3]:> Batch Time: 475.75 ms, GPU Bubble Ratio: 68.41%, 51.68%, 60.17%, 34.89%
[rank3]:2025-11-07 04:26:46,044 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1107_1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251107_0426_stage3_step1100.svg
[rank0]:2025-11-07 04:28:24,382 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-07 04:28:26,122 - INFO - Avg. fwd time: 14.4345 / Avg. bwd time: 25.5073 / Avg. batch time: 393.5741 (ms) / GPU bubble ratio: 18.81%
[rank2]:2025-11-07 04:28:26,188 - INFO - Avg. fwd time: 7.5719 / Avg. bwd time: 16.0910 / Avg. batch time: 422.1468 (ms) / GPU bubble ratio: 55.16%
[rank0]:2025-11-07 04:28:26,216 - INFO - Avg. fwd time: 7.9788 / Avg. bwd time: 11.4289 / Avg. batch time: 486.7980 (ms) / GPU bubble ratio: 68.11%
[rank1]:2025-11-07 04:28:26,227 - INFO - Avg. fwd time: 9.9173 / Avg. bwd time: 18.9915 / Avg. batch time: 457.3690 (ms) / GPU bubble ratio: 49.43%
[rank3]:2025-11-07 04:28:26,373 - INFO -  step: 1150  loss:  0.6363  grad_norm:  0.0000  memory: 19.87GiB(41.82%)  tps: 8,146  tflops: 62.04  mfu: 19.88%
[rank2]:2025-11-07 04:28:26,401 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.1420  memory:  7.41GiB(15.59%)  tps: 8,145  tflops: 62.04  mfu: 19.88%
[rank0]:2025-11-07 04:28:26,431 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.1420  memory: 17.47GiB(36.77%)  tps: 8,145  tflops: 62.04  mfu: 19.88%
[rank1]:2025-11-07 04:28:26,409 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.1420  memory: 10.49GiB(22.09%)  tps: 8,146  tflops: 62.04  mfu: 19.88%
[rank0]:2025-11-07 04:30:05,002 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-07 04:30:06,973 - INFO - Avg. fwd time: 14.4409 / Avg. bwd time: 25.4671 / Avg. batch time: 393.3102 (ms) / GPU bubble ratio: 18.83%
[rank2]:2025-11-07 04:30:07,001 - INFO - Avg. fwd time: 7.5727 / Avg. bwd time: 16.0877 / Avg. batch time: 421.8692 (ms) / GPU bubble ratio: 55.13%
[rank0]:2025-11-07 04:30:07,061 - INFO - Avg. fwd time: 7.9814 / Avg. bwd time: 11.3855 / Avg. batch time: 486.5093 (ms) / GPU bubble ratio: 68.15%
[rank1]:2025-11-07 04:30:07,033 - INFO - Avg. fwd time: 9.9186 / Avg. bwd time: 18.9794 / Avg. batch time: 457.0901 (ms) / GPU bubble ratio: 49.42%
[rank1]:2025-11-07 04:30:07,106 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.1701  memory: 10.49GiB(22.09%)  tps: 8,135  tflops: 61.96  mfu: 19.86%
[rank1]:2025-11-07 04:30:07,106 - INFO -  final step: 1200  loss: -4.0000  grad_norm:  0.1701  tps: 8,356  tflops: 63.64  mfu: 19.10%
[rank1]:2025-11-07 04:30:07,106 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-11-07 04:30:07,107 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1200.
[rank3]:2025-11-07 04:30:07,071 - INFO -  step: 1200  loss:  0.6288  grad_norm:  0.0000  memory: 19.87GiB(41.82%)  tps: 8,135  tflops: 61.96  mfu: 19.86%
[rank3]:2025-11-07 04:30:07,071 - INFO -  final step: 1200  loss:  0.6288  grad_norm:  0.0000  tps: 8,363  tflops: 63.70  mfu: 19.18%
[rank3]:2025-11-07 04:30:07,071 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-11-07 04:30:07,072 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1200.
[rank2]:2025-11-07 04:30:07,098 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.1701  memory:  7.41GiB(15.59%)  tps: 8,135  tflops: 61.96  mfu: 19.86%
[rank2]:2025-11-07 04:30:07,098 - INFO -  final step: 1200  loss: -4.0000  grad_norm:  0.1701  tps: 8,356  tflops: 63.64  mfu: 19.10%
[rank2]:2025-11-07 04:30:07,098 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-07 04:30:07,099 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1200.
[rank0]:2025-11-07 04:30:07,128 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.1701  memory: 17.47GiB(36.77%)  tps: 8,135  tflops: 61.96  mfu: 19.86%
[rank0]:2025-11-07 04:30:07,128 - INFO -  final step: 1200  loss: -4.0000  grad_norm:  0.1701  tps: 8,356  tflops: 63.64  mfu: 19.10%
[rank0]:2025-11-07 04:30:07,128 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-07 04:30:07,129 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1200.
[rank0]:2025-11-07 04:30:09,040 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank1]:2025-11-07 04:30:09,108 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1107_1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251107_0430_stage1_final1200.svg
[rank2]:2025-11-07 04:30:09,109 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1107_1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251107_0430_stage2_final1200.svg
[rank0]:2025-11-07 04:30:09,109 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1107_1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251107_0430_stage0_final1200.svg
[rank3]:2025-11-07 04:30:09,196 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1107_1F1B_timelyapf_dm1/pipeline_schedule/251107_0430_real_final1200_rank3.svg
[rank3]:> Batch Time: 477.72 ms, GPU Bubble Ratio: 69.22%, 51.92%, 60.39%, 34.88%
[rank2]:2025-11-07 04:30:09,267 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1107_1F1B_timelyapf_dm1/frozen_params_histogram/251107_0430_rank2_stage2.svg
[rank2]:	> Counts Sum: 1124160, Total Sum: 1301760 (86.36%), Ratio(%) per element: [86.61, 86.06, 86.28, 86.06, 86.17, 86.06, 86.06, 86.83, 86.61, 86.28, 86.17, 86.06, 86.39, 86.5, 86.39, 86.39, 87.05, 86.83, 86.06, 86.39, 86.17, 86.28, 86.17, 86.39, 86.17, 86.83, 86.61, 86.17, 86.28, 86.39, 86.28, 86.06, 85.95, 86.06, 86.94, 86.72]
[rank2]:2025-11-07 04:30:09,268 - INFO - Destroying the purge thread.
[rank0]:2025-11-07 04:30:09,269 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1107_1F1B_timelyapf_dm1/frozen_params_histogram/251107_0430_rank0_stage0.svg
[rank0]:	> Counts Sum: 1082280, Total Sum: 1337920 (80.89%), Ratio(%) per element: [79.53, 79.53, 78.65, 78.65, 80.42, 79.31, 79.97, 79.64, 86.83, 85.06, 79.64, 80.3, 79.09, 80.42, 79.2, 78.09, 79.64, 86.94, 86.72, 79.2, 79.42, 79.09, 78.65, 78.53, 79.75, 80.53, 86.5, 84.95, 79.75, 79.53, 79.97, 79.75, 78.2, 79.31, 80.53, 86.83, 84.73]
[rank0]:2025-11-07 04:30:09,269 - INFO - Sleeping 2 seconds for other ranks to complete
[rank1]:2025-11-07 04:30:09,261 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1107_1F1B_timelyapf_dm1/frozen_params_histogram/251107_0430_rank1_stage1.svg
[rank1]:	> Counts Sum: 1405200, Total Sum: 1627200 (86.36%), Ratio(%) per element: [86.17, 86.17, 86.17, 86.28, 86.06, 86.39, 86.17, 86.72, 86.72, 86.17, 86.17, 86.28, 86.17, 86.17, 86.17, 86.5, 86.94, 86.5, 86.17, 86.17, 86.17, 86.28, 86.06, 86.28, 86.17, 86.94, 86.5, 86.39, 86.06, 86.28, 86.39, 86.06, 86.39, 86.28, 86.94, 86.72, 86.17, 86.28, 86.28, 86.39, 86.39, 86.39, 86.28, 87.05, 86.5]
[rank1]:2025-11-07 04:30:09,262 - INFO - Destroying the purge thread.
[rank3]:2025-11-07 04:30:09,339 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1107_1F1B_timelyapf_dm1/pipeline_schedule/251107_0430_thry_final1200_rank3.svg
[rank3]:> Batch Time: 329.36 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank1]:2025-11-07 04:30:09,411 - INFO - Process group destroyed
[rank3]:2025-11-07 04:30:09,385 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1107_1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251107_0430_stage3_final1200.svg
[rank2]:2025-11-07 04:30:09,412 - INFO - Process group destroyed
[rank3]:2025-11-07 04:30:09,527 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1107_1F1B_timelyapf_dm1/frozen_params_histogram/251107_0430_rank3_stage3.svg
[rank3]:	> Counts Sum: 232400, Total Sum: 1048640 (22.16%), Ratio(%) per element: [21.57, 20.68, 22.23, 21.23, 22.34, 20.9, 21.9, 26.32, 25.66, 21.01, 20.57, 21.79, 20.24, 21.34, 21.46, 21.34, 25.99, 25.11, 21.23, 21.12, 20.24, 21.79, 22.23, 21.9, 20.68, 21.57, 23.0, 25.88, 21.23]
[rank3]:2025-11-07 04:30:09,528 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading history steps 23-24, summary, console lines 284-296
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–‡â–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–‡â–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 1.95905
[rank3]:wandb:               final/avg_loss 0.62883
[rank3]:wandb:             final/avg_mfu(%) 19.17926
[rank3]:wandb:             final/avg_tflops 63.69634
[rank3]:wandb:    final/avg_throughput(tps) 8363.25616
[rank3]:wandb:              final/grad_norm 0
[rank3]:wandb:               final/max_loss 0.62883
[rank3]:wandb:                    grad_norm 0
[rank3]:wandb: loss_metrics/global_avg_loss 0.62883
[rank3]:wandb: loss_metrics/global_max_loss 0.62883
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1107_1F1B_timelyapf_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/h2ymt248
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1107_1F1B_timelyapf_dm1/20251107-0349/wandb/run-20251107_034917-h2ymt248/logs
[rank3]:2025-11-07 04:30:10,921 - INFO - Process group destroyed
[rank0]:2025-11-07 04:30:11,269 - INFO - Training completed
[rank0]:2025-11-07 04:30:11,270 - INFO - Destroying the purge thread.
[rank0]:2025-11-07 04:30:11,405 - INFO - Process group destroyed
[rank0]:Stage 0: Modules to keep: {'layers.3', 'tok_embeddings', 'layers.0', 'layers.1', 'layers.2'}
[rank1]:Stage 1: Modules to keep: {'layers.4', 'layers.8', 'layers.5', 'layers.7', 'layers.6'}
[rank2]:Stage 2: Modules to keep: {'layers.10', 'layers.12', 'layers.9', 'layers.11'}
[rank3]:Stage 3: Modules to keep: {'layers.14', 'norm', 'layers.13', 'output', 'layers.15'}
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
[rank3]:for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1107_1F1B_timelyapf_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1107_1F1B_timelyapf_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1107_1F1B_timelyapf_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1107_1F1B_timelyapf_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1107_1F1B_timelyapf_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1107_1F1B_timelyapf_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 1e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: alpaca
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 512
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 1200
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: 1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 4
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1107_1F1B_timelyapf_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1107_1F1B_timelyapf_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: timelyapf
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.05
[rank3]:		- percentile: 80
[rank3]:
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
