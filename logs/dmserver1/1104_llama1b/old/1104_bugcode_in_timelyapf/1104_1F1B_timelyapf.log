
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 11. 05. (ìˆ˜) 08:32:05 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 0,1,2,3
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/1104_1F1B_timelyapf.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
âœ”ï¸Running with timelyapf x 1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=timelyapf
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank3]:2025-11-05 08:32:11,601 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank2]:2025-11-05 08:32:11,604 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank2]:2025-11-05 08:32:11,769 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-11-05 08:32:11,771 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-11-05 08:32:11,823 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-11-05 08:32:11,825 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-05 08:32:11,809 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank1]:2025-11-05 08:32:11,865 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank0]:2025-11-05 08:32:12,007 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-11-05 08:32:12,009 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-05 08:32:12,014 - INFO - [GC] Initial GC collection 0.00 seconds
[rank1]:2025-11-05 08:32:12,066 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-11-05 08:32:12,068 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-05 08:32:12,500 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-11-05 08:32:12,943 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank2]:2025-11-05 08:32:15,794 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-11-05 08:32:15,820 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-11-05 08:32:15,843 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-11-05 08:32:15,844 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2025-11-05 08:32:15,888 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-11-05 08:32:15,911 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=512, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank1]:2025-11-05 08:32:15,928 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-11-05 08:32:15,954 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-11-05 08:32:15,954 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank2]:2025-11-05 08:32:16,017 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-11-05 08:32:16,017 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-11-05 08:32:16,017 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank0]:2025-11-05 08:32:16,057 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-11-05 08:32:16,094 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-05 08:32:16,095 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-11-05 08:32:16,122 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank1]:2025-11-05 08:32:16,124 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-11-05 08:32:16,124 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-11-05 08:32:16,122 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2025-11-05 08:32:16,124 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank0]:2025-11-05 08:32:16,304 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-05 08:32:16,304 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-11-05 08:32:16,305 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run mgxiniyt
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1104_1F1B_timelyapf_dm1/20251105-0832/wandb/run-20251105_083217-mgxiniyt
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1104_1F1B_timelyapf_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/mgxiniyt
[rank3]:2025-11-05 08:32:18,519 - INFO - WandB logging enabled
[rank3]:2025-11-05 08:32:18,520 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-11-05 08:32:18,560 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-11-05 08:32:18,590 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-11-05 08:32:18,590 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank2]:2025-11-05 08:32:18,821 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank1]:2025-11-05 08:32:18,822 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-11-05 08:32:18,804 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-11-05 08:32:18,804 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-11-05 08:32:18,805 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2025-11-05 08:32:18,821 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-05 08:32:18,821 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1104_1F1B_timelyapf_dm1
[rank0]:2025-11-05 08:32:18,822 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-05 08:32:18,822 - INFO - Trainer is initialized with local batch size 32, global batch size 128, gradient accumulation steps 4, sequence length 512, total steps 1200 (warmup 100)
[rank0]:2025-11-05 08:32:18,822 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank0]:2025-11-05 08:32:21,073 - INFO - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-11-05 08:32:21,074 - INFO - Finished loading the checkpoint in 2.25 seconds.
[rank0]:2025-11-05 08:32:21,074 - INFO - Training starts at step 1
[rank2]:2025-11-05 08:32:24,190 - INFO -  step:  1  loss: -4.0000  grad_norm: 174.8879  memory:  4.63GiB(9.75%)  tps: 1,958  tflops: 14.91  mfu: 4.78%
[rank3]:2025-11-05 08:32:24,199 - INFO -  step:  1  loss: 10.3018  grad_norm: 174.8879  memory: 12.97GiB(27.30%)  tps: 2,907  tflops: 22.14  mfu: 7.10%
[rank3]:2025-11-05 08:32:24,200 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-11-05 08:32:24,190 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-11-05 08:32:24,192 - INFO -  step:  1  loss: -4.0000  grad_norm: 174.8879  memory:  6.76GiB(14.24%)  tps: 1,983  tflops: 15.10  mfu: 4.84%
[rank1]:2025-11-05 08:32:24,193 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-05 08:32:24,230 - INFO -  step:  1  loss: -4.0000  grad_norm: 174.8879  memory:  9.19GiB(19.34%)  tps: 2,014  tflops: 15.34  mfu: 4.92%
[rank0]:2025-11-05 08:32:24,230 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-05 08:34:26,705 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-05 08:34:28,958 - INFO - Avg. fwd time: 13.2691 / Avg. bwd time: 41.4863 / Avg. batch time: 510.3542 (ms) / GPU bubble ratio: 14.17%
[rank1]:2025-11-05 08:34:29,031 - INFO - Avg. fwd time: 9.1711 / Avg. bwd time: 23.5909 / Avg. batch time: 580.8329 (ms) / GPU bubble ratio: 54.88%
[rank0]:2025-11-05 08:34:29,027 - INFO - Avg. fwd time: 7.2263 / Avg. bwd time: 23.2402 / Avg. batch time: 617.5759 (ms) / GPU bubble ratio: 60.53%
[rank2]:2025-11-05 08:34:28,997 - INFO - Avg. fwd time: 7.1515 / Avg. bwd time: 18.7136 / Avg. batch time: 542.1638 (ms) / GPU bubble ratio: 61.83%
[rank0]:2025-11-05 08:34:29,274 - INFO -  step: 50  loss: -4.0000  grad_norm: 16.4072  memory: 12.97GiB(27.31%)  tps: 6,420  tflops: 48.90  mfu: 15.67%
[rank2]:2025-11-05 08:34:29,259 - INFO -  step: 50  loss: -4.0000  grad_norm: 16.4072  memory:  6.43GiB(13.53%)  tps: 6,419  tflops: 48.89  mfu: 15.67%
[rank3]:2025-11-05 08:34:29,271 - INFO -  step: 50  loss:  9.2099  grad_norm: 16.4072  memory: 16.39GiB(34.50%)  tps: 6,419  tflops: 48.89  mfu: 15.67%
[rank1]:2025-11-05 08:34:29,262 - INFO -  step: 50  loss: -4.0000  grad_norm: 16.4072  memory:  9.03GiB(19.01%)  tps: 6,419  tflops: 48.89  mfu: 15.67%
[rank3]:2025-11-05 08:34:54,963 - INFO - [Step 60] ã€°ï¸ Monitoring Upperbound
[rank3]:2025-11-05 08:35:21,695 - INFO - [Step 70] âœ”ï¸  Setting Upperbound
[rank3]:2025-11-05 08:35:22,010 - INFO - [Step 70] ã€°ï¸ Monitoring Lowerbound
[rank2]:2025-11-05 08:35:24,390 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-05 08:35:24,417 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-05 08:35:24,447 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-05 08:35:24,878 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-05 08:35:24,913 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-05 08:35:26,165 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-05 08:35:26,189 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-05 08:35:26,207 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-05 08:35:26,231 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-05 08:35:27,011 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-05 08:35:26,988 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-05 08:35:27,015 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-05 08:35:27,041 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-05 08:35:27,062 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-05 08:35:27,046 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-05 08:35:27,064 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-05 08:35:27,111 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-05 08:35:27,113 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-05 08:35:27,157 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-05 08:35:27,158 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-05 08:35:27,158 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-05 08:35:27,159 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-05 08:35:27,085 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-05 08:35:27,129 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-05 08:35:27,114 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-05 08:35:27,161 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-05 08:35:27,151 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-05 08:35:27,184 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-05 08:35:27,198 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-05 08:35:27,217 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-05 08:35:27,171 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-05 08:35:27,200 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-05 08:36:00,994 - INFO - [Step 90] âœ”ï¸  Setting Lowerbound
[rank3]:2025-11-05 08:36:01,194 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_dm1/pipeline_schedule/251105_0836_max_batch_time.svg
[rank3]:> Batch Time: 540.99 ms, GPU Bubble Ratio: 54.47%, 51.18%, 61.46%, 17.55%
[rank3]:2025-11-05 08:36:01,336 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_dm1/pipeline_schedule/251105_0836_min_batch_time.svg
[rank3]:> Batch Time: 327.59 ms, GPU Bubble Ratio: 82.29%, 51.75%, 62.19%, 14.54%
[rank3]:2025-11-05 08:36:01,500 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_dm1/pipeline_schedule/251105_0836_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 374.32 ms, GPU Bubble Ratio: 43.64%, 32.97%, 47.13%, 12.73%
[rank3]:2025-11-05 08:36:01,500 - INFO - 	> Batch Time: 374.32 ms (Average Freeze Ratio: 0.28, Time Reduction Rate: 0.31)
[rank0]:2025-11-05 08:36:19,900 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-05 08:36:21,689 - INFO - Avg. fwd time: 13.6132 / Avg. bwd time: 36.3035 / Avg. batch time: 471.6621 (ms) / GPU bubble ratio: 15.33%
[rank1]:2025-11-05 08:36:21,793 - INFO - Avg. fwd time: 9.5932 / Avg. bwd time: 20.5925 / Avg. batch time: 537.4779 (ms) / GPU bubble ratio: 55.07%
[rank0]:2025-11-05 08:36:21,749 - INFO - Avg. fwd time: 7.5515 / Avg. bwd time: 17.5402 / Avg. batch time: 568.3668 (ms) / GPU bubble ratio: 64.68%
[rank2]:2025-11-05 08:36:21,756 - INFO - Avg. fwd time: 7.4989 / Avg. bwd time: 16.4047 / Avg. batch time: 502.1354 (ms) / GPU bubble ratio: 61.92%
[rank2]:2025-11-05 08:36:24,240 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.33/1.00
[rank2]:2025-11-05 08:36:24,241 - INFO -  step: 100  loss: -4.0000  grad_norm:  2.8034  memory:  6.51GiB(13.70%)  tps: 7,125  tflops: 54.26  mfu: 17.39%
[rank1]:2025-11-05 08:36:24,912 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.33/1.00
[rank1]:2025-11-05 08:36:24,912 - INFO -  step: 100  loss: -4.0000  grad_norm:  2.8034  memory:  9.36GiB(19.71%)  tps: 7,083  tflops: 53.95  mfu: 17.29%
[rank3]:2025-11-05 08:36:26,050 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.33/1.00, [MB3] 0.33/1.00, [MB4] 0.33/1.00, [MB5] 0.20/0.60, [MB6] 0.33/1.00, [MB7] 0.33/1.00
[rank3]:2025-11-05 08:36:26,054 - INFO -  step: 100  loss:  4.2545  grad_norm:  2.8034  memory: 17.37GiB(36.55%)  tps: 7,015  tflops: 53.43  mfu: 17.12%
[rank0]:2025-11-05 08:36:26,888 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.17/0.51, [MB7] 0.33/1.00
[rank0]:2025-11-05 08:36:26,889 - INFO -  step: 100  loss: -4.0000  grad_norm:  2.8034  memory: 12.97GiB(27.31%)  tps: 6,965  tflops: 53.05  mfu: 17.00%
[rank1]:2025-11-05 08:36:26,959 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251105_0836_stage1_step100.svg
[rank0]:2025-11-05 08:36:26,957 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251105_0836_stage0_step100.svg
[rank2]:2025-11-05 08:36:26,963 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251105_0836_stage2_step100.svg
[rank3]:2025-11-05 08:36:27,027 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_dm1/pipeline_schedule/251105_0836_real_step100_rank3.svg
[rank3]:> Batch Time: 482.86 ms, GPU Bubble Ratio: 70.41%, 53.45%, 61.60%, 34.81%
[rank3]:2025-11-05 08:36:27,069 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251105_0836_stage3_step100.svg
[rank0]:2025-11-05 08:38:35,266 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-05 08:38:37,379 - INFO - Avg. fwd time: 7.4601 / Avg. bwd time: 16.6488 / Avg. batch time: 488.6231 (ms) / GPU bubble ratio: 60.53%
[rank3]:2025-11-05 08:38:37,356 - INFO - Avg. fwd time: 13.7216 / Avg. bwd time: 34.4254 / Avg. batch time: 458.4542 (ms) / GPU bubble ratio: 15.98%
[rank1]:2025-11-05 08:38:37,406 - INFO - Avg. fwd time: 9.5731 / Avg. bwd time: 20.7490 / Avg. batch time: 524.3087 (ms) / GPU bubble ratio: 53.73%
[rank0]:2025-11-05 08:38:37,433 - INFO - Avg. fwd time: 7.6155 / Avg. bwd time: 18.1013 / Avg. batch time: 556.0952 (ms) / GPU bubble ratio: 63.00%
[rank2]:2025-11-05 08:38:39,596 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.67/1.00
[rank2]:2025-11-05 08:38:39,596 - INFO -  step: 150  loss: -4.0000  grad_norm:  3.7190  memory:  6.51GiB(13.70%)  tps: 6,052  tflops: 46.10  mfu: 14.77%
[rank1]:2025-11-05 08:38:40,161 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.67/1.00
[rank1]:2025-11-05 08:38:40,161 - INFO -  step: 150  loss: -4.0000  grad_norm:  3.7190  memory:  9.36GiB(19.71%)  tps: 6,057  tflops: 46.13  mfu: 14.79%
[rank3]:2025-11-05 08:38:41,582 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.67/1.00, [MB3] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.40/0.60, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank3]:2025-11-05 08:38:41,585 - INFO -  step: 150  loss:  1.2384  grad_norm:  3.7190  memory: 17.37GiB(36.55%)  tps: 6,044  tflops: 46.04  mfu: 14.76%
[rank0]:2025-11-05 08:38:42,174 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.34/0.51, [MB7] 0.67/1.00
[rank0]:2025-11-05 08:38:42,174 - INFO -  step: 150  loss: -4.0000  grad_norm:  3.7190  memory: 13.37GiB(28.13%)  tps: 6,055  tflops: 46.12  mfu: 14.78%
[rank0]:2025-11-05 08:40:41,644 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-05 08:40:43,446 - INFO - Avg. fwd time: 13.8144 / Avg. bwd time: 32.5809 / Avg. batch time: 444.5655 (ms) / GPU bubble ratio: 16.51%
[rank2]:2025-11-05 08:40:43,513 - INFO - Avg. fwd time: 7.4792 / Avg. bwd time: 16.5233 / Avg. batch time: 474.2744 (ms) / GPU bubble ratio: 59.51%
[rank0]:2025-11-05 08:40:43,547 - INFO - Avg. fwd time: 7.7151 / Avg. bwd time: 17.3697 / Avg. batch time: 541.1137 (ms) / GPU bubble ratio: 62.91%
[rank1]:2025-11-05 08:40:43,551 - INFO - Avg. fwd time: 9.6248 / Avg. bwd time: 20.3857 / Avg. batch time: 509.8494 (ms) / GPU bubble ratio: 52.91%
[rank2]:2025-11-05 08:40:45,753 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-05 08:40:45,754 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.7756  memory:  6.53GiB(13.74%)  tps: 6,493  tflops: 49.46  mfu: 15.85%
[rank1]:2025-11-05 08:40:46,429 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-11-05 08:40:46,430 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.7756  memory:  9.38GiB(19.75%)  tps: 6,488  tflops: 49.41  mfu: 15.84%
[rank3]:2025-11-05 08:40:47,671 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 0.60/0.60, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-11-05 08:40:47,674 - INFO -  step: 200  loss:  0.2858  grad_norm:  0.7756  memory: 17.37GiB(36.55%)  tps: 6,497  tflops: 49.48  mfu: 15.86%
[rank0]:2025-11-05 08:40:48,362 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.51/0.51, [MB7] 1.00/1.00
[rank0]:2025-11-05 08:40:48,363 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.7756  memory: 13.40GiB(28.22%)  tps: 6,492  tflops: 49.44  mfu: 15.85%
[rank2]:2025-11-05 08:40:48,413 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251105_0840_stage2_step200.svg
[rank1]:2025-11-05 08:40:48,412 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251105_0840_stage1_step200.svg
[rank0]:2025-11-05 08:40:48,411 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251105_0840_stage0_step200.svg
[rank3]:2025-11-05 08:40:48,516 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_dm1/pipeline_schedule/251105_0840_real_step200_rank3.svg
[rank3]:> Batch Time: 486.61 ms, GPU Bubble Ratio: 63.43%, 53.08%, 61.23%, 34.10%
[rank3]:2025-11-05 08:40:48,563 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251105_0840_stage3_step200.svg
[rank0]:2025-11-05 08:42:46,945 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-05 08:42:48,709 - INFO - Avg. fwd time: 13.8994 / Avg. bwd time: 31.1892 / Avg. batch time: 434.0430 (ms) / GPU bubble ratio: 16.90%
[rank2]:2025-11-05 08:42:48,775 - INFO - Avg. fwd time: 7.4986 / Avg. bwd time: 16.3936 / Avg. batch time: 463.5169 (ms) / GPU bubble ratio: 58.76%
[rank0]:2025-11-05 08:42:48,768 - INFO - Avg. fwd time: 7.7782 / Avg. bwd time: 15.9190 / Avg. batch time: 529.6984 (ms) / GPU bubble ratio: 64.21%
[rank1]:2025-11-05 08:42:48,812 - INFO - Avg. fwd time: 9.6782 / Avg. bwd time: 20.0033 / Avg. batch time: 498.9353 (ms) / GPU bubble ratio: 52.41%
[rank2]:2025-11-05 08:42:51,091 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-05 08:42:51,092 - INFO -  step: 250  loss: -4.0000  grad_norm: 309.4973  memory:  6.53GiB(13.74%)  tps: 6,536  tflops: 49.78  mfu: 15.95%
[rank1]:2025-11-05 08:42:51,748 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-11-05 08:42:51,749 - INFO -  step: 250  loss: -4.0000  grad_norm: 309.4973  memory:  9.38GiB(19.75%)  tps: 6,537  tflops: 49.79  mfu: 15.96%
[rank3]:2025-11-05 08:42:52,961 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 0.60/0.60, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-11-05 08:42:52,966 - INFO -  step: 250  loss:  0.6786  grad_norm: 309.4973  memory: 17.37GiB(36.55%)  tps: 6,538  tflops: 49.80  mfu: 15.96%
[rank0]:2025-11-05 08:42:53,745 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.51/0.51, [MB7] 1.00/1.00
[rank0]:2025-11-05 08:42:53,746 - INFO -  step: 250  loss: -4.0000  grad_norm: 309.4973  memory: 13.40GiB(28.22%)  tps: 6,534  tflops: 49.76  mfu: 15.95%
[rank0]:2025-11-05 08:44:51,828 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-05 08:44:53,814 - INFO - Avg. fwd time: 13.9493 / Avg. bwd time: 30.2345 / Avg. batch time: 426.7577 (ms) / GPU bubble ratio: 17.17%
[rank2]:2025-11-05 08:44:53,836 - INFO - Avg. fwd time: 7.5107 / Avg. bwd time: 16.3075 / Avg. batch time: 455.9719 (ms) / GPU bubble ratio: 58.21%
[rank1]:2025-11-05 08:44:53,863 - INFO - Avg. fwd time: 9.7134 / Avg. bwd time: 19.7569 / Avg. batch time: 491.3020 (ms) / GPU bubble ratio: 52.01%
[rank0]:2025-11-05 08:44:53,886 - INFO - Avg. fwd time: 7.8157 / Avg. bwd time: 14.9197 / Avg. batch time: 521.7346 (ms) / GPU bubble ratio: 65.14%
[rank2]:2025-11-05 08:44:56,042 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-05 08:44:56,043 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.1525  memory:  6.53GiB(13.74%)  tps: 6,556  tflops: 49.93  mfu: 16.00%
[rank1]:2025-11-05 08:44:56,708 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-11-05 08:44:56,709 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.1525  memory:  9.38GiB(19.75%)  tps: 6,556  tflops: 49.93  mfu: 16.00%
[rank3]:2025-11-05 08:44:57,959 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 0.60/0.60, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-11-05 08:44:57,963 - INFO -  step: 300  loss:  0.2427  grad_norm:  0.1525  memory: 17.37GiB(36.55%)  tps: 6,554  tflops: 49.92  mfu: 16.00%
[rank0]:2025-11-05 08:44:58,533 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.51/0.51, [MB7] 1.00/1.00
[rank0]:2025-11-05 08:44:58,533 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.1525  memory: 13.40GiB(28.22%)  tps: 6,565  tflops: 50.00  mfu: 16.03%
[rank0]:2025-11-05 08:44:58,580 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251105_0844_stage0_step300.svg
[rank2]:2025-11-05 08:44:58,581 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251105_0844_stage2_step300.svg
[rank1]:2025-11-05 08:44:58,581 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251105_0844_stage1_step300.svg
[rank3]:2025-11-05 08:44:58,675 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_dm1/pipeline_schedule/251105_0844_real_step300_rank3.svg
[rank3]:> Batch Time: 487.31 ms, GPU Bubble Ratio: 69.32%, 53.19%, 61.34%, 33.49%
[rank3]:2025-11-05 08:44:58,716 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251105_0844_stage3_step300.svg
[rank0]:2025-11-05 08:46:56,859 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-05 08:46:58,694 - INFO - Avg. fwd time: 7.8391 / Avg. bwd time: 14.2996 / Avg. batch time: 516.9041 (ms) / GPU bubble ratio: 65.74%
[rank2]:2025-11-05 08:46:58,701 - INFO - Avg. fwd time: 7.5192 / Avg. bwd time: 16.2549 / Avg. batch time: 451.3994 (ms) / GPU bubble ratio: 57.87%
[rank3]:2025-11-05 08:46:58,635 - INFO - Avg. fwd time: 13.9762 / Avg. bwd time: 29.6496 / Avg. batch time: 422.2656 (ms) / GPU bubble ratio: 17.35%
[rank1]:2025-11-05 08:46:58,738 - INFO - Avg. fwd time: 9.7366 / Avg. bwd time: 19.6049 / Avg. batch time: 486.6745 (ms) / GPU bubble ratio: 51.77%
[rank2]:2025-11-05 08:47:00,920 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.1162  memory:  6.53GiB(13.74%)  tps: 6,560  tflops: 49.96  mfu: 16.01%
[rank1]:2025-11-05 08:47:01,683 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.1162  memory:  9.38GiB(19.75%)  tps: 6,555  tflops: 49.92  mfu: 16.00%
[rank3]:2025-11-05 08:47:03,001 - INFO -  step: 350  loss:  0.2464  grad_norm:  0.1162  memory: 17.37GiB(36.55%)  tps: 6,552  tflops: 49.90  mfu: 15.99%
[rank0]:2025-11-05 08:47:03,440 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.1162  memory: 13.40GiB(28.22%)  tps: 6,558  tflops: 49.95  mfu: 16.01%
[rank0]:2025-11-05 08:49:00,961 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-05 08:49:02,737 - INFO - Avg. fwd time: 14.0088 / Avg. bwd time: 29.1114 / Avg. batch time: 418.1800 (ms) / GPU bubble ratio: 17.51%
[rank2]:2025-11-05 08:49:02,803 - INFO - Avg. fwd time: 7.5266 / Avg. bwd time: 16.2079 / Avg. batch time: 447.1535 (ms) / GPU bubble ratio: 57.54%
[rank0]:2025-11-05 08:49:02,795 - INFO - Avg. fwd time: 7.8596 / Avg. bwd time: 13.7860 / Avg. batch time: 512.4207 (ms) / GPU bubble ratio: 66.21%
[rank1]:2025-11-05 08:49:02,840 - INFO - Avg. fwd time: 9.7552 / Avg. bwd time: 19.4704 / Avg. batch time: 482.3735 (ms) / GPU bubble ratio: 51.53%
[rank2]:2025-11-05 08:49:05,072 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.2465  memory:  6.53GiB(13.74%)  tps: 6,598  tflops: 50.25  mfu: 16.11%
[rank1]:2025-11-05 08:49:05,714 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.2465  memory:  9.38GiB(19.75%)  tps: 6,605  tflops: 50.30  mfu: 16.12%
[rank3]:2025-11-05 08:49:07,006 - INFO -  step: 400  loss:  0.2478  grad_norm:  0.2465  memory: 17.37GiB(36.55%)  tps: 6,606  tflops: 50.31  mfu: 16.13%
[rank2]:2025-11-05 08:49:07,833 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251105_0849_stage2_step400.svg
[rank0]:2025-11-05 08:49:07,782 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.2465  memory: 13.40GiB(28.22%)  tps: 6,588  tflops: 50.18  mfu: 16.08%
[rank0]:2025-11-05 08:49:07,860 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251105_0849_stage0_step400.svg
[rank1]:2025-11-05 08:49:07,861 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251105_0849_stage1_step400.svg
[rank3]:2025-11-05 08:49:07,922 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_dm1/pipeline_schedule/251105_0849_real_step400_rank3.svg
[rank3]:> Batch Time: 483.28 ms, GPU Bubble Ratio: 69.06%, 52.78%, 61.02%, 33.82%
[rank3]:2025-11-05 08:49:07,968 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251105_0849_stage3_step400.svg
[rank3]:2025-11-05 08:49:18,293 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-11-05 08:49:18,508 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-11-05 08:49:18,485 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-11-05 08:49:18,526 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-11-05 08:51:05,310 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-05 08:51:07,232 - INFO - Avg. fwd time: 14.0248 / Avg. bwd time: 28.6840 / Avg. batch time: 414.8482 (ms) / GPU bubble ratio: 17.64%
[rank1]:2025-11-05 08:51:07,283 - INFO - Avg. fwd time: 9.7694 / Avg. bwd time: 19.3647 / Avg. batch time: 478.9099 (ms) / GPU bubble ratio: 51.33%
[rank2]:2025-11-05 08:51:07,256 - INFO - Avg. fwd time: 7.5313 / Avg. bwd time: 16.1698 / Avg. batch time: 443.7337 (ms) / GPU bubble ratio: 57.27%
[rank0]:2025-11-05 08:51:07,307 - INFO - Avg. fwd time: 7.8738 / Avg. bwd time: 13.3544 / Avg. batch time: 508.8171 (ms) / GPU bubble ratio: 66.62%
[rank2]:2025-11-05 08:51:09,467 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.1953  memory:  6.53GiB(13.74%)  tps: 6,586  tflops: 50.16  mfu: 16.08%
[rank1]:2025-11-05 08:51:09,957 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.1953  memory:  9.38GiB(19.75%)  tps: 6,594  tflops: 50.22  mfu: 16.10%
[rank3]:2025-11-05 08:51:11,370 - INFO -  step: 450  loss:  0.2470  grad_norm:  0.1953  memory: 17.37GiB(36.55%)  tps: 6,587  tflops: 50.17  mfu: 16.08%
[rank0]:2025-11-05 08:51:12,048 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.1953  memory: 13.40GiB(28.22%)  tps: 6,592  tflops: 50.21  mfu: 16.09%
[rank0]:2025-11-05 08:53:09,858 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-05 08:53:11,645 - INFO - Avg. fwd time: 14.0354 / Avg. bwd time: 28.4050 / Avg. batch time: 412.6804 (ms) / GPU bubble ratio: 17.73%
[rank0]:2025-11-05 08:53:11,704 - INFO - Avg. fwd time: 7.8836 / Avg. bwd time: 13.0570 / Avg. batch time: 506.4294 (ms) / GPU bubble ratio: 66.92%
[rank2]:2025-11-05 08:53:11,711 - INFO - Avg. fwd time: 7.5348 / Avg. bwd time: 16.1433 / Avg. batch time: 441.4814 (ms) / GPU bubble ratio: 57.09%
[rank1]:2025-11-05 08:53:11,748 - INFO - Avg. fwd time: 9.7788 / Avg. bwd time: 19.2898 / Avg. batch time: 476.6202 (ms) / GPU bubble ratio: 51.21%
[rank2]:2025-11-05 08:53:13,944 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.1294  memory:  6.53GiB(13.74%)  tps: 6,581  tflops: 50.12  mfu: 16.07%
[rank1]:2025-11-05 08:53:14,599 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.1294  memory:  9.38GiB(19.75%)  tps: 6,572  tflops: 50.06  mfu: 16.04%
[rank3]:2025-11-05 08:53:16,011 - INFO -  step: 500  loss:  0.2680  grad_norm:  0.1294  memory: 17.37GiB(36.55%)  tps: 6,573  tflops: 50.06  mfu: 16.04%
[rank0]:2025-11-05 08:53:16,556 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.1294  memory: 13.40GiB(28.22%)  tps: 6,580  tflops: 50.11  mfu: 16.06%
[rank2]:2025-11-05 08:53:16,612 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251105_0853_stage2_step500.svg
[rank1]:2025-11-05 08:53:16,611 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251105_0853_stage1_step500.svg
[rank0]:2025-11-05 08:53:16,613 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251105_0853_stage0_step500.svg
[rank3]:2025-11-05 08:53:16,712 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_dm1/pipeline_schedule/251105_0853_real_step500_rank3.svg
[rank3]:> Batch Time: 481.55 ms, GPU Bubble Ratio: 69.11%, 52.69%, 60.93%, 34.07%
[rank3]:2025-11-05 08:53:16,753 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251105_0853_stage3_step500.svg
[rank0]:2025-11-05 08:55:15,218 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-05 08:55:17,010 - INFO - Avg. fwd time: 14.0447 / Avg. bwd time: 28.1667 / Avg. batch time: 410.8397 (ms) / GPU bubble ratio: 17.80%
[rank0]:2025-11-05 08:55:17,069 - INFO - Avg. fwd time: 7.8936 / Avg. bwd time: 12.7810 / Avg. batch time: 504.4457 (ms) / GPU bubble ratio: 67.21%
[rank2]:2025-11-05 08:55:17,077 - INFO - Avg. fwd time: 7.5385 / Avg. bwd time: 16.1182 / Avg. batch time: 439.6216 (ms) / GPU bubble ratio: 56.95%
[rank1]:2025-11-05 08:55:17,115 - INFO - Avg. fwd time: 9.7895 / Avg. bwd time: 19.2185 / Avg. batch time: 474.7264 (ms) / GPU bubble ratio: 51.12%
[rank2]:2025-11-05 08:55:19,419 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.1513  memory:  6.53GiB(13.74%)  tps: 6,529  tflops: 49.72  mfu: 15.94%
[rank1]:2025-11-05 08:55:20,011 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.1513  memory:  9.38GiB(19.75%)  tps: 6,532  tflops: 49.75  mfu: 15.95%
[rank3]:2025-11-05 08:55:21,328 - INFO -  step: 550  loss:  0.3078  grad_norm:  0.1513  memory: 17.37GiB(36.55%)  tps: 6,537  tflops: 49.79  mfu: 15.96%
[rank0]:2025-11-05 08:55:22,163 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.1513  memory: 13.40GiB(28.22%)  tps: 6,522  tflops: 49.68  mfu: 15.92%
[rank0]:2025-11-05 08:57:20,279 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-05 08:57:22,267 - INFO - Avg. fwd time: 7.5417 / Avg. bwd time: 16.0982 / Avg. batch time: 438.0131 (ms) / GPU bubble ratio: 56.82%
[rank3]:2025-11-05 08:57:22,243 - INFO - Avg. fwd time: 14.0520 / Avg. bwd time: 27.9676 / Avg. batch time: 409.2948 (ms) / GPU bubble ratio: 17.87%
[rank1]:2025-11-05 08:57:22,295 - INFO - Avg. fwd time: 9.7999 / Avg. bwd time: 19.1605 / Avg. batch time: 473.0930 (ms) / GPU bubble ratio: 51.03%
[rank0]:2025-11-05 08:57:22,320 - INFO - Avg. fwd time: 7.9024 / Avg. bwd time: 12.5613 / Avg. batch time: 502.7435 (ms) / GPU bubble ratio: 67.44%
[rank2]:2025-11-05 08:57:24,556 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.1322  memory:  6.53GiB(13.74%)  tps: 6,546  tflops: 49.86  mfu: 15.98%
[rank1]:2025-11-05 08:57:25,064 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.1322  memory:  9.38GiB(19.75%)  tps: 6,551  tflops: 49.89  mfu: 15.99%
[rank3]:2025-11-05 08:57:26,290 - INFO -  step: 600  loss:  0.2285  grad_norm:  0.1322  memory: 17.37GiB(36.55%)  tps: 6,556  tflops: 49.93  mfu: 16.00%
[rank0]:2025-11-05 08:57:27,012 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.1322  memory: 13.40GiB(28.22%)  tps: 6,562  tflops: 49.97  mfu: 16.02%
[rank2]:2025-11-05 08:57:27,060 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251105_0857_stage2_step600.svg
[rank1]:2025-11-05 08:57:27,061 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251105_0857_stage1_step600.svg
[rank0]:2025-11-05 08:57:27,060 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251105_0857_stage0_step600.svg
[rank3]:2025-11-05 08:57:27,151 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_dm1/pipeline_schedule/251105_0857_real_step600_rank3.svg
[rank3]:> Batch Time: 481.34 ms, GPU Bubble Ratio: 68.90%, 52.46%, 60.87%, 34.03%
[rank3]:2025-11-05 08:57:27,196 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251105_0857_stage3_step600.svg
[rank0]:2025-11-05 08:59:25,215 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-05 08:59:26,973 - INFO - Avg. fwd time: 14.0588 / Avg. bwd time: 27.8155 / Avg. batch time: 408.1251 (ms) / GPU bubble ratio: 17.92%
[rank2]:2025-11-05 08:59:27,036 - INFO - Avg. fwd time: 7.5437 / Avg. bwd time: 16.0836 / Avg. batch time: 436.8398 (ms) / GPU bubble ratio: 56.73%
[rank1]:2025-11-05 08:59:27,074 - INFO - Avg. fwd time: 9.8070 / Avg. bwd time: 19.1195 / Avg. batch time: 471.9024 (ms) / GPU bubble ratio: 50.96%
[rank0]:2025-11-05 08:59:27,027 - INFO - Avg. fwd time: 7.9084 / Avg. bwd time: 12.3903 / Avg. batch time: 501.4988 (ms) / GPU bubble ratio: 67.62%
[rank2]:2025-11-05 08:59:29,442 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.1945  memory:  6.53GiB(13.74%)  tps: 6,560  tflops: 49.96  mfu: 16.01%
[rank1]:2025-11-05 08:59:29,881 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.1945  memory:  9.38GiB(19.75%)  tps: 6,563  tflops: 49.99  mfu: 16.02%
[rank3]:2025-11-05 08:59:31,210 - INFO -  step: 650  loss:  0.2413  grad_norm:  0.1945  memory: 17.37GiB(36.55%)  tps: 6,558  tflops: 49.95  mfu: 16.01%
[rank0]:2025-11-05 08:59:31,942 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.1945  memory: 13.40GiB(28.22%)  tps: 6,557  tflops: 49.94  mfu: 16.01%
[rank0]:2025-11-05 09:01:29,892 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-05 09:01:31,670 - INFO - Avg. fwd time: 14.0638 / Avg. bwd time: 27.6461 / Avg. batch time: 406.7933 (ms) / GPU bubble ratio: 17.97%
[rank0]:2025-11-05 09:01:31,729 - INFO - Avg. fwd time: 7.9144 / Avg. bwd time: 12.2283 / Avg. batch time: 500.0436 (ms) / GPU bubble ratio: 67.77%
[rank2]:2025-11-05 09:01:31,738 - INFO - Avg. fwd time: 7.5458 / Avg. bwd time: 16.0689 / Avg. batch time: 435.4483 (ms) / GPU bubble ratio: 56.62%
[rank1]:2025-11-05 09:01:31,775 - INFO - Avg. fwd time: 9.8138 / Avg. bwd time: 19.0792 / Avg. batch time: 470.4983 (ms) / GPU bubble ratio: 50.87%
[rank2]:2025-11-05 09:01:34,058 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.1045  memory:  6.53GiB(13.74%)  tps: 6,574  tflops: 50.07  mfu: 16.05%
[rank1]:2025-11-05 09:01:34,583 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.1045  memory:  9.38GiB(19.75%)  tps: 6,569  tflops: 50.03  mfu: 16.04%
[rank3]:2025-11-05 09:01:36,044 - INFO -  step: 700  loss:  0.2202  grad_norm:  0.1045  memory: 17.37GiB(36.55%)  tps: 6,562  tflops: 49.98  mfu: 16.02%
[rank0]:2025-11-05 09:01:36,662 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.1045  memory: 13.40GiB(28.22%)  tps: 6,568  tflops: 50.03  mfu: 16.03%
[rank0]:2025-11-05 09:01:36,714 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251105_0901_stage0_step700.svg
[rank2]:2025-11-05 09:01:36,729 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251105_0901_stage2_step700.svg
[rank1]:2025-11-05 09:01:36,713 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251105_0901_stage1_step700.svg
[rank3]:2025-11-05 09:01:36,806 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_dm1/pipeline_schedule/251105_0901_real_step700_rank3.svg
[rank3]:> Batch Time: 480.52 ms, GPU Bubble Ratio: 69.09%, 52.55%, 60.84%, 34.03%
[rank3]:2025-11-05 09:01:36,852 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251105_0901_stage3_step700.svg
[rank0]:2025-11-05 09:03:35,305 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-05 09:03:37,267 - INFO - Avg. fwd time: 14.0679 / Avg. bwd time: 27.5287 / Avg. batch time: 405.8903 (ms) / GPU bubble ratio: 18.01%
[rank2]:2025-11-05 09:03:37,293 - INFO - Avg. fwd time: 7.5477 / Avg. bwd time: 16.0558 / Avg. batch time: 434.5467 (ms) / GPU bubble ratio: 56.55%
[rank0]:2025-11-05 09:03:37,346 - INFO - Avg. fwd time: 7.9193 / Avg. bwd time: 12.0719 / Avg. batch time: 499.0788 (ms) / GPU bubble ratio: 67.96%
[rank1]:2025-11-05 09:03:37,321 - INFO - Avg. fwd time: 9.8193 / Avg. bwd time: 19.0426 / Avg. batch time: 469.5800 (ms) / GPU bubble ratio: 50.83%
[rank2]:2025-11-05 09:03:39,464 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1336  memory:  6.53GiB(13.74%)  tps: 6,532  tflops: 49.75  mfu: 15.95%
[rank1]:2025-11-05 09:03:40,042 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1336  memory:  9.38GiB(19.75%)  tps: 6,530  tflops: 49.73  mfu: 15.94%
[rank3]:2025-11-05 09:03:41,373 - INFO -  step: 750  loss:  0.2765  grad_norm:  0.1336  memory: 17.37GiB(36.55%)  tps: 6,536  tflops: 49.78  mfu: 15.96%
[rank0]:2025-11-05 09:03:42,280 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1336  memory: 13.40GiB(28.22%)  tps: 6,521  tflops: 49.67  mfu: 15.92%
[rank0]:2025-11-05 09:05:40,603 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-05 09:05:42,406 - INFO - Avg. fwd time: 14.0723 / Avg. bwd time: 27.4327 / Avg. batch time: 405.1513 (ms) / GPU bubble ratio: 18.05%
[rank0]:2025-11-05 09:05:42,462 - INFO - Avg. fwd time: 7.9231 / Avg. bwd time: 11.9632 / Avg. batch time: 498.2540 (ms) / GPU bubble ratio: 68.07%
[rank2]:2025-11-05 09:05:42,473 - INFO - Avg. fwd time: 7.5493 / Avg. bwd time: 16.0465 / Avg. batch time: 433.7684 (ms) / GPU bubble ratio: 56.48%
[rank1]:2025-11-05 09:05:42,511 - INFO - Avg. fwd time: 9.8238 / Avg. bwd time: 19.0155 / Avg. batch time: 468.7883 (ms) / GPU bubble ratio: 50.78%
[rank2]:2025-11-05 09:05:44,829 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1304  memory:  6.53GiB(13.74%)  tps: 6,535  tflops: 49.77  mfu: 15.95%
[rank1]:2025-11-05 09:05:45,471 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1304  memory:  9.38GiB(19.75%)  tps: 6,531  tflops: 49.74  mfu: 15.94%
[rank3]:2025-11-05 09:05:46,723 - INFO -  step: 800  loss:  0.2256  grad_norm:  0.1304  memory: 17.37GiB(36.55%)  tps: 6,535  tflops: 49.78  mfu: 15.95%
[rank0]:2025-11-05 09:05:47,359 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1304  memory: 13.40GiB(28.22%)  tps: 6,549  tflops: 49.88  mfu: 15.99%
[rank0]:2025-11-05 09:05:47,411 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251105_0905_stage0_step800.svg
[rank2]:2025-11-05 09:05:47,411 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251105_0905_stage2_step800.svg
[rank1]:2025-11-05 09:05:47,411 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251105_0905_stage1_step800.svg
[rank3]:2025-11-05 09:05:47,498 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_dm1/pipeline_schedule/251105_0905_real_step800_rank3.svg
[rank3]:> Batch Time: 485.83 ms, GPU Bubble Ratio: 70.01%, 53.01%, 61.22%, 34.28%
[rank3]:2025-11-05 09:05:47,545 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251105_0905_stage3_step800.svg
[rank3]:2025-11-05 09:06:13,738 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-11-05 09:06:13,970 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-11-05 09:06:13,930 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-11-05 09:06:13,951 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-11-05 09:07:45,273 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-05 09:07:47,032 - INFO - Avg. fwd time: 14.0764 / Avg. bwd time: 27.3166 / Avg. batch time: 404.2454 (ms) / GPU bubble ratio: 18.08%
[rank0]:2025-11-05 09:07:47,088 - INFO - Avg. fwd time: 7.9274 / Avg. bwd time: 11.8594 / Avg. batch time: 497.2926 (ms) / GPU bubble ratio: 68.17%
[rank2]:2025-11-05 09:07:47,100 - INFO - Avg. fwd time: 7.5509 / Avg. bwd time: 16.0370 / Avg. batch time: 432.8478 (ms) / GPU bubble ratio: 56.40%
[rank1]:2025-11-05 09:07:47,138 - INFO - Avg. fwd time: 9.8287 / Avg. bwd time: 18.9887 / Avg. batch time: 467.8591 (ms) / GPU bubble ratio: 50.72%
[rank2]:2025-11-05 09:07:49,369 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.1705  memory:  6.53GiB(13.74%)  tps: 6,578  tflops: 50.10  mfu: 16.06%
[rank1]:2025-11-05 09:07:49,818 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.1705  memory:  9.38GiB(19.75%)  tps: 6,588  tflops: 50.18  mfu: 16.08%
[rank3]:2025-11-05 09:07:51,492 - INFO -  step: 850  loss:  0.2346  grad_norm:  0.1705  memory: 17.37GiB(36.55%)  tps: 6,566  tflops: 50.01  mfu: 16.03%
[rank0]:2025-11-05 09:07:52,099 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.1705  memory: 13.40GiB(28.22%)  tps: 6,567  tflops: 50.02  mfu: 16.03%
[rank0]:2025-11-05 09:09:50,441 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-05 09:09:52,443 - INFO - Avg. fwd time: 14.0836 / Avg. bwd time: 27.2210 / Avg. batch time: 403.5318 (ms) / GPU bubble ratio: 18.11%
[rank2]:2025-11-05 09:09:52,469 - INFO - Avg. fwd time: 7.5529 / Avg. bwd time: 16.0287 / Avg. batch time: 432.0991 (ms) / GPU bubble ratio: 56.34%
[rank0]:2025-11-05 09:09:52,524 - INFO - Avg. fwd time: 7.9313 / Avg. bwd time: 11.7615 / Avg. batch time: 496.5120 (ms) / GPU bubble ratio: 68.27%
[rank1]:2025-11-05 09:09:52,498 - INFO - Avg. fwd time: 9.8329 / Avg. bwd time: 18.9646 / Avg. batch time: 467.1056 (ms) / GPU bubble ratio: 50.68%
[rank2]:2025-11-05 09:09:54,679 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.1176  memory:  6.53GiB(13.74%)  tps: 6,537  tflops: 49.79  mfu: 15.96%
[rank1]:2025-11-05 09:09:55,159 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.1176  memory:  9.38GiB(19.75%)  tps: 6,536  tflops: 49.78  mfu: 15.95%
[rank3]:2025-11-05 09:09:56,504 - INFO -  step: 900  loss:  0.2064  grad_norm:  0.1176  memory: 17.37GiB(36.55%)  tps: 6,553  tflops: 49.91  mfu: 16.00%
[rank0]:2025-11-05 09:09:57,449 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.1176  memory: 13.40GiB(28.22%)  tps: 6,535  tflops: 49.77  mfu: 15.95%
[rank1]:2025-11-05 09:09:57,496 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251105_0909_stage1_step900.svg
[rank2]:2025-11-05 09:09:57,495 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251105_0909_stage2_step900.svg
[rank0]:2025-11-05 09:09:57,495 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251105_0909_stage0_step900.svg
[rank3]:2025-11-05 09:09:57,590 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_dm1/pipeline_schedule/251105_0909_real_step900_rank3.svg
[rank3]:> Batch Time: 488.75 ms, GPU Bubble Ratio: 70.24%, 53.35%, 61.44%, 33.27%
[rank3]:2025-11-05 09:09:57,633 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251105_0909_stage3_step900.svg
[rank0]:2025-11-05 09:11:55,599 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-05 09:11:57,360 - INFO - Avg. fwd time: 14.0882 / Avg. bwd time: 27.1427 / Avg. batch time: 402.9411 (ms) / GPU bubble ratio: 18.14%
[rank0]:2025-11-05 09:11:57,419 - INFO - Avg. fwd time: 7.9348 / Avg. bwd time: 11.6918 / Avg. batch time: 495.8989 (ms) / GPU bubble ratio: 68.34%
[rank2]:2025-11-05 09:11:57,428 - INFO - Avg. fwd time: 7.5544 / Avg. bwd time: 16.0224 / Avg. batch time: 431.5039 (ms) / GPU bubble ratio: 56.29%
[rank1]:2025-11-05 09:11:57,465 - INFO - Avg. fwd time: 9.8359 / Avg. bwd time: 18.9463 / Avg. batch time: 466.5119 (ms) / GPU bubble ratio: 50.64%
[rank2]:2025-11-05 09:11:59,625 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.1278  memory:  6.53GiB(13.74%)  tps: 6,556  tflops: 49.94  mfu: 16.00%
[rank1]:2025-11-05 09:12:00,219 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.1278  memory:  9.38GiB(19.75%)  tps: 6,550  tflops: 49.89  mfu: 15.99%
[rank3]:2025-11-05 09:12:01,637 - INFO -  step: 950  loss:  0.2504  grad_norm:  0.1278  memory: 17.37GiB(36.55%)  tps: 6,547  tflops: 49.86  mfu: 15.98%
[rank0]:2025-11-05 09:12:02,341 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.1278  memory: 13.40GiB(28.22%)  tps: 6,559  tflops: 49.96  mfu: 16.01%
[rank0]:2025-11-05 09:14:00,924 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-05 09:14:02,716 - INFO - Avg. fwd time: 14.0949 / Avg. bwd time: 27.0650 / Avg. batch time: 402.3675 (ms) / GPU bubble ratio: 18.16%
[rank0]:2025-11-05 09:14:02,775 - INFO - Avg. fwd time: 7.9378 / Avg. bwd time: 11.6091 / Avg. batch time: 495.2639 (ms) / GPU bubble ratio: 68.43%
[rank1]:2025-11-05 09:14:02,821 - INFO - Avg. fwd time: 9.8388 / Avg. bwd time: 18.9268 / Avg. batch time: 465.9018 (ms) / GPU bubble ratio: 50.61%
[rank2]:2025-11-05 09:14:02,783 - INFO - Avg. fwd time: 7.5559 / Avg. bwd time: 16.0156 / Avg. batch time: 430.8969 (ms) / GPU bubble ratio: 56.24%
[rank2]:2025-11-05 09:14:05,074 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.1200  memory:  6.53GiB(13.74%)  tps: 6,530  tflops: 49.74  mfu: 15.94%
[rank1]:2025-11-05 09:14:05,638 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.1200  memory:  9.38GiB(19.75%)  tps: 6,532  tflops: 49.75  mfu: 15.94%
[rank3]:2025-11-05 09:14:07,123 - INFO -  step: 1000  loss:  0.2365  grad_norm:  0.1200  memory: 17.37GiB(36.55%)  tps: 6,528  tflops: 49.72  mfu: 15.94%
[rank0]:2025-11-05 09:14:07,689 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.1200  memory: 13.40GiB(28.22%)  tps: 6,535  tflops: 49.77  mfu: 15.95%
[rank0]:2025-11-05 09:14:07,738 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251105_0914_stage0_step1000.svg
[rank1]:2025-11-05 09:14:07,737 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251105_0914_stage1_step1000.svg
[rank2]:2025-11-05 09:14:07,737 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251105_0914_stage2_step1000.svg
[rank3]:2025-11-05 09:14:07,830 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_dm1/pipeline_schedule/251105_0914_real_step1000_rank3.svg
[rank3]:> Batch Time: 483.36 ms, GPU Bubble Ratio: 69.18%, 52.78%, 61.00%, 33.96%
[rank3]:2025-11-05 09:14:07,873 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251105_0914_stage3_step1000.svg
[rank0]:2025-11-05 09:16:06,421 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-05 09:16:08,384 - INFO - Avg. fwd time: 14.1003 / Avg. bwd time: 26.9962 / Avg. batch time: 401.8576 (ms) / GPU bubble ratio: 18.19%
[rank2]:2025-11-05 09:16:08,410 - INFO - Avg. fwd time: 7.5573 / Avg. bwd time: 16.0094 / Avg. batch time: 430.3827 (ms) / GPU bubble ratio: 56.19%
[rank0]:2025-11-05 09:16:08,467 - INFO - Avg. fwd time: 7.9407 / Avg. bwd time: 11.5351 / Avg. batch time: 494.7322 (ms) / GPU bubble ratio: 68.51%
[rank1]:2025-11-05 09:16:08,441 - INFO - Avg. fwd time: 9.8414 / Avg. bwd time: 18.9095 / Avg. batch time: 465.3898 (ms) / GPU bubble ratio: 50.58%
[rank2]:2025-11-05 09:16:10,629 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.1405  memory:  6.53GiB(13.74%)  tps: 6,525  tflops: 49.69  mfu: 15.93%
[rank1]:2025-11-05 09:16:11,146 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.1405  memory:  9.38GiB(19.75%)  tps: 6,527  tflops: 49.71  mfu: 15.93%
[rank3]:2025-11-05 09:16:12,520 - INFO -  step: 1050  loss:  0.2807  grad_norm:  0.1405  memory: 17.37GiB(36.55%)  tps: 6,533  tflops: 49.76  mfu: 15.95%
[rank0]:2025-11-05 09:16:13,197 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.1405  memory: 13.40GiB(28.22%)  tps: 6,527  tflops: 49.71  mfu: 15.93%
[rank0]:2025-11-05 09:18:11,225 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-05 09:18:13,007 - INFO - Avg. fwd time: 14.1040 / Avg. bwd time: 26.9371 / Avg. batch time: 401.4142 (ms) / GPU bubble ratio: 18.21%
[rank2]:2025-11-05 09:18:13,075 - INFO - Avg. fwd time: 7.5583 / Avg. bwd time: 16.0047 / Avg. batch time: 429.9112 (ms) / GPU bubble ratio: 56.15%
[rank0]:2025-11-05 09:18:13,068 - INFO - Avg. fwd time: 7.9431 / Avg. bwd time: 11.4834 / Avg. batch time: 494.2511 (ms) / GPU bubble ratio: 68.56%
[rank1]:2025-11-05 09:18:13,113 - INFO - Avg. fwd time: 9.8432 / Avg. bwd time: 18.8963 / Avg. batch time: 464.9233 (ms) / GPU bubble ratio: 50.55%
[rank2]:2025-11-05 09:18:15,291 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.1240  memory:  6.53GiB(13.74%)  tps: 6,571  tflops: 50.05  mfu: 16.04%
[rank1]:2025-11-05 09:18:15,892 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.1240  memory:  9.38GiB(19.75%)  tps: 6,567  tflops: 50.02  mfu: 16.03%
[rank3]:2025-11-05 09:18:17,258 - INFO -  step: 1100  loss:  0.2440  grad_norm:  0.1240  memory: 17.37GiB(36.55%)  tps: 6,567  tflops: 50.02  mfu: 16.03%
[rank2]:2025-11-05 09:18:18,180 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251105_0918_stage2_step1100.svg
[rank0]:2025-11-05 09:18:18,118 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.1240  memory: 13.40GiB(28.22%)  tps: 6,558  tflops: 49.95  mfu: 16.01%
[rank0]:2025-11-05 09:18:18,165 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251105_0918_stage0_step1100.svg
[rank1]:2025-11-05 09:18:18,179 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251105_0918_stage1_step1100.svg
[rank3]:2025-11-05 09:18:18,260 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_dm1/pipeline_schedule/251105_0918_real_step1100_rank3.svg
[rank3]:> Batch Time: 483.66 ms, GPU Bubble Ratio: 69.13%, 52.78%, 61.05%, 33.97%
[rank3]:2025-11-05 09:18:18,305 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251105_0918_stage3_step1100.svg
[rank0]:2025-11-05 09:20:16,509 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-05 09:20:18,284 - INFO - Avg. fwd time: 14.1086 / Avg. bwd time: 26.8732 / Avg. batch time: 400.9376 (ms) / GPU bubble ratio: 18.23%
[rank2]:2025-11-05 09:20:18,349 - INFO - Avg. fwd time: 7.5595 / Avg. bwd time: 15.9995 / Avg. batch time: 429.4272 (ms) / GPU bubble ratio: 56.11%
[rank0]:2025-11-05 09:20:18,343 - INFO - Avg. fwd time: 7.9457 / Avg. bwd time: 11.4260 / Avg. batch time: 493.7567 (ms) / GPU bubble ratio: 68.61%
[rank1]:2025-11-05 09:20:18,388 - INFO - Avg. fwd time: 9.8454 / Avg. bwd time: 18.8824 / Avg. batch time: 464.4450 (ms) / GPU bubble ratio: 50.52%
[rank2]:2025-11-05 09:20:20,586 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.1141  memory:  6.53GiB(13.74%)  tps: 6,538  tflops: 49.80  mfu: 15.96%
[rank1]:2025-11-05 09:20:21,226 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.1141  memory:  9.38GiB(19.75%)  tps: 6,536  tflops: 49.78  mfu: 15.96%
[rank3]:2025-11-05 09:20:22,549 - INFO -  step: 1150  loss:  0.2427  grad_norm:  0.1141  memory: 17.37GiB(36.55%)  tps: 6,539  tflops: 49.80  mfu: 15.96%
[rank0]:2025-11-05 09:20:23,265 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.1141  memory: 13.40GiB(28.22%)  tps: 6,546  tflops: 49.86  mfu: 15.98%
[rank0]:2025-11-05 09:22:21,507 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-05 09:22:23,478 - INFO - Avg. fwd time: 14.1128 / Avg. bwd time: 26.8210 / Avg. batch time: 400.5460 (ms) / GPU bubble ratio: 18.24%
[rank2]:2025-11-05 09:22:23,505 - INFO - Avg. fwd time: 7.5606 / Avg. bwd time: 15.9948 / Avg. batch time: 429.0123 (ms) / GPU bubble ratio: 56.08%
[rank1]:2025-11-05 09:22:23,536 - INFO - Avg. fwd time: 9.8472 / Avg. bwd time: 18.8698 / Avg. batch time: 464.0351 (ms) / GPU bubble ratio: 50.49%
[rank0]:2025-11-05 09:22:23,564 - INFO - Avg. fwd time: 7.9480 / Avg. bwd time: 11.3709 / Avg. batch time: 493.3314 (ms) / GPU bubble ratio: 68.67%
[rank2]:2025-11-05 09:22:25,637 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.1352  memory:  6.53GiB(13.74%)  tps: 6,551  tflops: 49.89  mfu: 15.99%
[rank2]:2025-11-05 09:22:25,637 - INFO -  final step: 1200  loss: -4.0000  grad_norm:  0.1352  tps: 6,804  tflops: 51.82  mfu: 15.54%
[rank2]:2025-11-05 09:22:25,637 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-05 09:22:25,638 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1200.
[rank1]:2025-11-05 09:22:26,246 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.1352  memory:  9.38GiB(19.75%)  tps: 6,553  tflops: 49.91  mfu: 16.00%
[rank1]:2025-11-05 09:22:26,246 - INFO -  final step: 1200  loss: -4.0000  grad_norm:  0.1352  tps: 6,803  tflops: 51.82  mfu: 15.54%
[rank1]:2025-11-05 09:22:26,246 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-11-05 09:22:26,247 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1200.
[rank3]:2025-11-05 09:22:27,668 - INFO -  step: 1200  loss:  0.2436  grad_norm:  0.1352  memory: 17.37GiB(36.55%)  tps: 6,547  tflops: 49.87  mfu: 15.98%
[rank3]:2025-11-05 09:22:27,669 - INFO -  final step: 1200  loss:  0.2436  grad_norm:  0.1352  tps: 6,806  tflops: 51.84  mfu: 15.62%
[rank3]:2025-11-05 09:22:27,669 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-11-05 09:22:27,670 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1200.
[rank0]:2025-11-05 09:22:28,286 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.1352  memory: 13.40GiB(28.22%)  tps: 6,552  tflops: 49.91  mfu: 16.00%
[rank0]:2025-11-05 09:22:28,286 - INFO -  final step: 1200  loss: -4.0000  grad_norm:  0.1352  tps: 6,799  tflops: 51.78  mfu: 15.53%
[rank0]:2025-11-05 09:22:28,286 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-05 09:22:28,287 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1200.
[rank2]:2025-11-05 09:22:30,536 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251105_0922_stage2_final1200.svg
[rank0]:2025-11-05 09:22:30,472 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-11-05 09:22:30,536 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251105_0922_stage0_final1200.svg
[rank1]:2025-11-05 09:22:30,536 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251105_0922_stage1_final1200.svg
[rank3]:2025-11-05 09:22:30,627 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_dm1/pipeline_schedule/251105_0922_real_final1200_rank3.svg
[rank3]:> Batch Time: 484.09 ms, GPU Bubble Ratio: 69.86%, 52.89%, 61.11%, 34.17%
[rank2]:2025-11-05 09:22:30,691 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_dm1/frozen_params_histogram/251105_0922_rank2_stage2.svg
[rank2]:	> Counts Sum: 1124160, Total Sum: 1301760 (86.36%), Ratio(%) per element: [86.06, 86.17, 86.28, 86.28, 86.06, 86.17, 86.06, 86.83, 86.83, 86.17, 86.28, 86.28, 86.28, 86.17, 86.28, 86.28, 86.94, 86.72, 85.95, 86.28, 86.5, 86.28, 86.28, 86.39, 86.17, 86.83, 86.72, 86.39, 86.28, 86.17, 86.28, 86.39, 86.17, 86.17, 86.61, 86.72]
[rank2]:2025-11-05 09:22:30,691 - INFO - Destroying the purge thread.
[rank0]:2025-11-05 09:22:30,695 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_dm1/frozen_params_histogram/251105_0922_rank0_stage0.svg
[rank0]:	> Counts Sum: 1073920, Total Sum: 1337920 (80.27%), Ratio(%) per element: [79.42, 78.76, 78.87, 78.53, 78.87, 79.31, 78.53, 77.54, 86.5, 85.17, 78.42, 77.32, 78.53, 78.53, 78.42, 79.53, 79.09, 86.83, 86.72, 77.98, 78.09, 79.2, 78.65, 78.87, 77.98, 78.87, 86.83, 85.17, 78.65, 78.65, 78.98, 79.09, 78.2, 78.65, 79.09, 86.28, 85.61]
[rank0]:2025-11-05 09:22:30,695 - INFO - Sleeping 2 seconds for other ranks to complete
[rank1]:2025-11-05 09:22:30,688 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_dm1/frozen_params_histogram/251105_0922_rank1_stage1.svg
[rank1]:	> Counts Sum: 1405200, Total Sum: 1627200 (86.36%), Ratio(%) per element: [86.61, 86.61, 86.17, 86.39, 86.39, 86.06, 86.17, 86.83, 86.72, 86.28, 86.39, 86.17, 86.17, 86.39, 86.06, 86.5, 86.94, 86.28, 86.06, 86.17, 86.5, 86.28, 86.39, 86.17, 86.28, 86.5, 86.5, 86.06, 85.95, 86.28, 86.17, 85.95, 86.5, 86.39, 86.94, 86.72, 86.28, 86.17, 86.17, 86.28, 86.28, 86.28, 86.39, 86.72, 86.39]
[rank1]:2025-11-05 09:22:30,688 - INFO - Destroying the purge thread.
[rank3]:2025-11-05 09:22:30,769 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_dm1/pipeline_schedule/251105_0922_thry_final1200_rank3.svg
[rank3]:> Batch Time: 326.02 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:2025-11-05 09:22:30,812 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251105_0922_stage3_final1200.svg
[rank2]:2025-11-05 09:22:30,814 - INFO - Process group destroyed
[rank1]:2025-11-05 09:22:30,816 - INFO - Process group destroyed
[rank3]:2025-11-05 09:22:30,951 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_dm1/frozen_params_histogram/251105_0922_rank3_stage3.svg
[rank3]:	> Counts Sum: 335240, Total Sum: 1048640 (31.97%), Ratio(%) per element: [30.42, 28.42, 29.64, 28.53, 29.31, 29.75, 29.42, 42.03, 41.15, 29.31, 28.87, 28.65, 28.87, 28.65, 29.64, 29.09, 41.03, 41.81, 29.09, 29.97, 29.42, 29.53, 30.42, 29.53, 29.09, 38.05, 37.61, 41.15, 28.53]
[rank3]:2025-11-05 09:22:30,951 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading history steps 23-24, summary, console lines 283-295
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–…â–â–â–â–â–ˆâ–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–‡â–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–‡â–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 2.40725
[rank3]:wandb:               final/avg_loss 0.24356
[rank3]:wandb:             final/avg_mfu(%) 15.61886
[rank3]:wandb:             final/avg_tflops 51.83683
[rank3]:wandb:    final/avg_throughput(tps) 6806.11659
[rank3]:wandb:              final/grad_norm 0.13519
[rank3]:wandb:               final/max_loss 0.24356
[rank3]:wandb:                    grad_norm 0.13519
[rank3]:wandb: loss_metrics/global_avg_loss 0.24356
[rank3]:wandb: loss_metrics/global_max_loss 0.24356
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1104_1F1B_timelyapf_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/mgxiniyt
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1104_1F1B_timelyapf_dm1/20251105-0832/wandb/run-20251105_083217-mgxiniyt/logs
[rank3]:2025-11-05 09:22:32,345 - INFO - Process group destroyed
[rank0]:2025-11-05 09:22:32,696 - INFO - Training completed
[rank0]:2025-11-05 09:22:32,696 - INFO - Destroying the purge thread.
[rank0]:2025-11-05 09:22:32,837 - INFO - Process group destroyed
[rank2]:Stage 2: Modules to keep: {'layers.9', 'layers.11', 'layers.10', 'layers.12'}
[rank1]:Stage 1: Modules to keep: {'layers.5', 'layers.6', 'layers.7', 'layers.8', 'layers.4'}
[rank0]:Stage 0: Modules to keep: {'layers.3', 'layers.0', 'layers.1', 'layers.2', 'tok_embeddings'}
[rank3]:Stage 3: Modules to keep: {'norm', 'layers.14', 'layers.15', 'layers.13', 'output'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1104_1F1B_timelyapf_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1104_1F1B_timelyapf_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1104_1F1B_timelyapf_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1104_1F1B_timelyapf_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1104_1F1B_timelyapf_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1104_1F1B_timelyapf_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 1e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: alpaca
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 512
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 1200
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: 1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 4
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1104_1F1B_timelyapf_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1104_1F1B_timelyapf_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: timelyapf
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.7
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.05
[rank3]:		- percentile: 70
[rank3]:
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
