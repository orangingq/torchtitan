
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 11. 05. (ìˆ˜) 13:09:00 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 0,1,2,3
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/1104_Interleaved1F1B_timelyapf.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
âœ”ï¸Running with timelyapf x Interleaved1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=timelyapf
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank1]:2025-11-05 13:09:07,224 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank0]:2025-11-05 13:09:07,241 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank2]:2025-11-05 13:09:07,240 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank3]:2025-11-05 13:09:07,252 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank0]:2025-11-05 13:09:07,579 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-11-05 13:09:07,581 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-05 13:09:07,584 - INFO - [GC] Initial GC collection 0.00 seconds
[rank2]:2025-11-05 13:09:07,566 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-11-05 13:09:07,568 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-11-05 13:09:07,608 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-11-05 13:09:07,611 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-11-05 13:09:07,596 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-11-05 13:09:07,599 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-05 13:09:07,985 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-11-05 13:09:08,378 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank0]:2025-11-05 13:09:11,151 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=512, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank2]:2025-11-05 13:09:11,193 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-11-05 13:09:11,238 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-11-05 13:09:11,266 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.5', 'layers.6']
[rank2]:2025-11-05 13:09:11,279 - INFO - PP rank 2 is building stage_idx 6 with modules ['layers.13', 'layers.14']
[rank2]:2025-11-05 13:09:11,280 - INFO - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank1]:2025-11-05 13:09:11,300 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-11-05 13:09:11,349 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-11-05 13:09:11,378 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.2', 'layers.3', 'layers.4']
[rank1]:2025-11-05 13:09:11,391 - INFO - PP rank 1 is building stage_idx 5 with modules ['layers.11', 'layers.12']
[rank1]:2025-11-05 13:09:11,392 - INFO - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank0]:2025-11-05 13:09:11,304 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-11-05 13:09:11,350 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-05 13:09:11,351 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-11-05 13:09:11,378 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1']
[rank0]:2025-11-05 13:09:11,391 - INFO - PP rank 0 is building stage_idx 4 with modules ['layers.9', 'layers.10']
[rank0]:2025-11-05 13:09:11,392 - INFO - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank2]:2025-11-05 13:09:11,449 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-11-05 13:09:11,449 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-11-05 13:09:11,450 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank1]:2025-11-05 13:09:11,576 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-11-05 13:09:11,576 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-11-05 13:09:11,577 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank0]:2025-11-05 13:09:11,578 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-05 13:09:11,578 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-11-05 13:09:11,579 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run t82yaq27
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1104_Interleaved1F1B_timelyapf_dm1/20251105-1309/wandb/run-20251105_130912-t82yaq27
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1104_Interleaved1F1B_timelyapf_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/t82yaq27
[rank3]:2025-11-05 13:09:13,931 - INFO - WandB logging enabled
[rank3]:2025-11-05 13:09:13,932 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-11-05 13:09:13,973 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-11-05 13:09:14,002 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.7', 'layers.8']
[rank3]:2025-11-05 13:09:14,015 - INFO - PP rank 3 is building stage_idx 7 with modules ['layers.15', 'norm', 'output']
[rank3]:2025-11-05 13:09:14,017 - INFO - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank3]:2025-11-05 13:09:14,191 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-11-05 13:09:14,191 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-11-05 13:09:14,192 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank0]:2025-11-05 13:09:14,208 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1104_Interleaved1F1B_timelyapf_dm1
[rank0]:2025-11-05 13:09:14,208 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-05 13:09:14,209 - INFO - Trainer is initialized with local batch size 32, global batch size 128, gradient accumulation steps 4, sequence length 512, total steps 1200 (warmup 100)
[rank0]:2025-11-05 13:09:14,209 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank1]:2025-11-05 13:09:14,208 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank2]:2025-11-05 13:09:14,208 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-11-05 13:09:14,208 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-05 13:09:16,347 - INFO - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-11-05 13:09:16,347 - INFO - Finished loading the checkpoint in 2.14 seconds.
[rank0]:2025-11-05 13:09:16,347 - INFO - Training starts at step 1
[rank0]:2025-11-05 13:09:19,680 - INFO -  step:  1  loss: -4.0000  grad_norm: 174.8870  memory: 10.96GiB(23.08%)  tps: 1,967  tflops: 14.98  mfu: 4.80%
[rank0]:2025-11-05 13:09:19,680 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-11-05 13:09:19,651 - INFO -  step:  1  loss: -4.0000  grad_norm: 174.8870  memory:  9.58GiB(20.17%)  tps: 1,974  tflops: 15.03  mfu: 4.82%
[rank1]:2025-11-05 13:09:19,651 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-11-05 13:09:19,642 - INFO -  step:  1  loss: -4.0000  grad_norm: 174.8870  memory:  6.31GiB(13.29%)  tps: 1,950  tflops: 14.85  mfu: 4.76%
[rank2]:2025-11-05 13:09:19,642 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-11-05 13:09:19,652 - INFO -  step:  1  loss: 10.3018  grad_norm: 174.8870  memory: 15.04GiB(31.66%)  tps: 2,886  tflops: 21.98  mfu: 7.05%
[rank3]:2025-11-05 13:09:19,653 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-05 13:11:28,803 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-05 13:11:31,164 - INFO - Avg. fwd time: 6.7101 / Avg. bwd time: 21.8028 / Avg. batch time: 564.5433 (ms) / GPU bubble ratio: 19.19%
[rank0]:2025-11-05 13:11:31,242 - INFO - Avg. fwd time: 4.1001 / Avg. bwd time: 11.9741 / Avg. batch time: 649.3436 (ms) / GPU bubble ratio: 60.39%
[rank2]:2025-11-05 13:11:31,222 - INFO - Avg. fwd time: 3.9606 / Avg. bwd time: 10.0232 / Avg. batch time: 597.1672 (ms) / GPU bubble ratio: 62.53%
[rank1]:2025-11-05 13:11:31,321 - INFO - Avg. fwd time: 4.8643 / Avg. bwd time: 12.2129 / Avg. batch time: 626.5766 (ms) / GPU bubble ratio: 56.39%
[rank3]:2025-11-05 13:11:31,497 - INFO -  step: 50  loss:  9.2027  grad_norm: 15.4547  memory: 18.46GiB(38.86%)  tps: 6,089  tflops: 46.38  mfu: 14.86%
[rank2]:2025-11-05 13:11:31,485 - INFO -  step: 50  loss: -4.0000  grad_norm: 15.4547  memory:  8.13GiB(17.12%)  tps: 6,089  tflops: 46.38  mfu: 14.86%
[rank1]:2025-11-05 13:11:31,489 - INFO -  step: 50  loss: -4.0000  grad_norm: 15.4547  memory: 11.85GiB(24.93%)  tps: 6,089  tflops: 46.38  mfu: 14.86%
[rank0]:2025-11-05 13:11:31,500 - INFO -  step: 50  loss: -4.0000  grad_norm: 15.4547  memory: 14.71GiB(30.97%)  tps: 6,090  tflops: 46.38  mfu: 14.87%
[rank3]:2025-11-05 13:11:58,536 - INFO - [Step 60] ã€°ï¸ Monitoring Upperbound
[rank3]:2025-11-05 13:12:27,105 - INFO - [Step 70] âœ”ï¸  Setting Upperbound
[rank3]:2025-11-05 13:12:27,418 - INFO - [Step 70] ã€°ï¸ Monitoring Lowerbound
[rank2]:2025-11-05 13:12:29,695 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-05 13:12:29,711 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-05 13:12:29,728 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-05 13:12:29,749 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-05 13:12:30,389 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-05 13:12:30,407 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-05 13:12:31,944 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-05 13:12:31,954 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-05 13:12:31,962 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-05 13:12:31,971 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-05 13:12:31,982 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-05 13:12:32,003 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-05 13:12:32,453 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-05 13:12:32,468 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-05 13:12:32,482 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-05 13:12:32,462 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-05 13:12:32,459 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-05 13:12:32,433 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-05 13:12:32,488 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-05 13:12:32,502 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-05 13:12:32,522 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-05 13:12:32,542 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-05 13:12:32,518 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-05 13:12:32,514 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-05 13:12:32,572 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-05 13:12:32,517 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-05 13:12:32,589 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-05 13:12:32,612 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-05 13:12:32,603 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-05 13:12:32,609 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-05 13:12:32,653 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-05 13:12:32,667 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-05 13:12:32,676 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-05 13:12:32,682 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-05 13:12:32,588 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-05 13:12:32,620 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-05 13:12:32,653 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-05 13:12:32,661 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-05 13:12:32,667 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-05 13:12:32,680 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-05 13:12:32,596 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-05 13:12:32,628 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-05 13:12:32,659 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-05 13:12:32,667 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-05 13:12:32,679 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-05 13:12:32,685 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-05 13:12:32,660 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-05 13:12:32,678 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-05 13:12:32,683 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-05 13:12:32,691 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-05 13:12:32,698 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-05 13:12:32,704 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-05 13:12:32,689 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-05 13:12:32,698 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-05 13:12:32,710 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-05 13:12:32,723 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-05 13:12:32,687 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-05 13:12:32,693 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-05 13:12:32,696 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-05 13:12:32,704 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-05 13:12:32,715 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-05 13:12:32,718 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-05 13:12:32,732 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-05 13:12:32,744 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-05 13:13:11,987 - INFO - [Step 90] âœ”ï¸  Setting Lowerbound
[rank3]:2025-11-05 13:13:12,301 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/pipeline_schedule/251105_1313_max_batch_time.svg
[rank3]:> Batch Time: 524.03 ms, GPU Bubble Ratio: 50.54%, 47.49%, 57.02%, 12.30%
[rank3]:2025-11-05 13:13:12,538 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/pipeline_schedule/251105_1313_min_batch_time.svg
[rank3]:> Batch Time: 325.99 ms, GPU Bubble Ratio: 68.58%, 48.43%, 56.87%, 10.39%
[rank3]:2025-11-05 13:13:12,793 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/pipeline_schedule/251105_1313_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 367.04 ms, GPU Bubble Ratio: 40.22%, 35.27%, 45.14%, 8.57%
[rank3]:2025-11-05 13:13:12,794 - INFO - 	> Batch Time: 367.04 ms (Average Freeze Ratio: 0.37, Time Reduction Rate: 0.30)
[rank0]:2025-11-05 13:13:31,985 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-05 13:13:33,878 - INFO - Avg. fwd time: 4.2963 / Avg. bwd time: 9.4397 / Avg. batch time: 608.2934 (ms) / GPU bubble ratio: 63.87%
[rank3]:2025-11-05 13:13:33,903 - INFO - Avg. fwd time: 7.0662 / Avg. bwd time: 19.1481 / Avg. batch time: 531.5903 (ms) / GPU bubble ratio: 21.10%
[rank2]:2025-11-05 13:13:33,933 - INFO - Avg. fwd time: 4.1686 / Avg. bwd time: 8.7195 / Avg. batch time: 563.3059 (ms) / GPU bubble ratio: 63.39%
[rank1]:2025-11-05 13:13:33,944 - INFO - Avg. fwd time: 5.1221 / Avg. bwd time: 10.4861 / Avg. batch time: 589.5657 (ms) / GPU bubble ratio: 57.64%
[rank0]:2025-11-05 13:13:35,292 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.08/0.23, [MB4] 0.04/0.13, [MB5] 0.33/1.00, [MB6] 0.19/0.56, [MB7] 0.33/1.00
[rank0]:2025-11-05 13:13:35,293 - INFO -  step: 100  loss: -4.0000  grad_norm:  2.7749  memory: 14.71GiB(30.97%)  tps: 6,617  tflops: 50.40  mfu: 16.15%
[rank2]:2025-11-05 13:13:35,346 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.33/1.00, [MB4] 0.33/1.00, [MB5] 0.29/0.88, [MB6] 0.21/0.64, [MB7] 0.33/1.00
[rank2]:2025-11-05 13:13:35,347 - INFO -  step: 100  loss: -4.0000  grad_norm:  2.7749  memory:  8.13GiB(17.12%)  tps: 6,614  tflops: 50.37  mfu: 16.15%
[rank1]:2025-11-05 13:13:35,363 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.33/1.00, [MB4] 0.33/1.00, [MB5] 0.33/1.00, [MB6] 0.33/1.00, [MB7] 0.33/1.00
[rank1]:2025-11-05 13:13:35,364 - INFO -  step: 100  loss: -4.0000  grad_norm:  2.7749  memory: 11.85GiB(24.93%)  tps: 6,613  tflops: 50.37  mfu: 16.14%
[rank0]:2025-11-05 13:13:37,866 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251105_1313_stage0_step100.svg
[rank3]:2025-11-05 13:13:37,802 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.20/0.60, [MB3] 0.33/1.00, [MB0] 0.33/1.00, [MB1] 0.32/0.97, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.33/1.00, [MB5] 0.33/1.00, [MB6] 0.33/1.00, [MB7] 0.33/1.00, [MB4] 0.33/1.00, [MB5] 0.33/1.00, [MB6] 0.33/1.00, [MB7] 0.21/0.63
[rank3]:2025-11-05 13:13:37,805 - INFO -  step: 100  loss:  4.3146  grad_norm:  2.7749  memory: 18.95GiB(39.89%)  tps: 6,486  tflops: 49.40  mfu: 15.83%
[rank2]:2025-11-05 13:13:37,866 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251105_1313_stage2_step100.svg
[rank1]:2025-11-05 13:13:37,865 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251105_1313_stage1_step100.svg
[rank0]:2025-11-05 13:13:37,906 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251105_1313_stage4_step100.svg
[rank2]:2025-11-05 13:13:37,906 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251105_1313_stage6_step100.svg
[rank1]:2025-11-05 13:13:37,904 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251105_1313_stage5_step100.svg
[rank3]:2025-11-05 13:13:38,040 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/pipeline_schedule/251105_1313_real_step100_rank3.svg
[rank3]:> Batch Time: 515.00 ms, GPU Bubble Ratio: 72.14%, 61.39%, 65.38%, 34.39%
[rank3]:2025-11-05 13:13:38,082 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251105_1313_stage3_step100.svg
[rank3]:2025-11-05 13:13:38,119 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251105_1313_stage7_step100.svg
[rank0]:2025-11-05 13:15:51,635 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-05 13:15:53,839 - INFO - Avg. fwd time: 7.1361 / Avg. bwd time: 18.3970 / Avg. batch time: 522.9815 (ms) / GPU bubble ratio: 21.88%
[rank2]:2025-11-05 13:15:53,858 - INFO - Avg. fwd time: 4.2209 / Avg. bwd time: 8.4966 / Avg. batch time: 561.0890 (ms) / GPU bubble ratio: 63.73%
[rank1]:2025-11-05 13:15:53,878 - INFO - Avg. fwd time: 5.1626 / Avg. bwd time: 10.1492 / Avg. batch time: 585.9633 (ms) / GPU bubble ratio: 58.19%
[rank0]:2025-11-05 13:15:53,893 - INFO - Avg. fwd time: 4.3200 / Avg. bwd time: 9.1728 / Avg. batch time: 604.6115 (ms) / GPU bubble ratio: 64.29%
[rank0]:2025-11-05 13:15:55,345 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.15/0.23, [MB4] 0.09/0.13, [MB5] 0.67/1.00, [MB6] 0.37/0.56, [MB7] 0.67/1.00
[rank0]:2025-11-05 13:15:55,346 - INFO -  step: 150  loss: -4.0000  grad_norm: 11.2991  memory: 15.14GiB(31.88%)  tps: 5,849  tflops: 44.55  mfu: 14.28%
[rank2]:2025-11-05 13:15:55,290 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.58/0.88, [MB6] 0.42/0.64, [MB7] 0.67/1.00
[rank2]:2025-11-05 13:15:55,290 - INFO -  step: 150  loss: -4.0000  grad_norm: 11.2991  memory:  8.52GiB(17.94%)  tps: 5,854  tflops: 44.58  mfu: 14.29%
[rank1]:2025-11-05 13:15:55,734 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank1]:2025-11-05 13:15:55,734 - INFO -  step: 150  loss: -4.0000  grad_norm: 11.2991  memory: 12.28GiB(25.84%)  tps: 5,836  tflops: 44.45  mfu: 14.25%
[rank3]:2025-11-05 13:15:57,896 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.40/0.60, [MB3] 0.67/1.00, [MB0] 0.67/1.00, [MB1] 0.65/0.97, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.42/0.63
[rank3]:2025-11-05 13:15:57,899 - INFO -  step: 150  loss:  1.1939  grad_norm: 11.2991  memory: 19.46GiB(40.96%)  tps: 5,848  tflops: 44.54  mfu: 14.27%
[rank0]:2025-11-05 13:18:03,039 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-05 13:18:05,010 - INFO - Avg. fwd time: 7.2270 / Avg. bwd time: 17.6060 / Avg. batch time: 514.3891 (ms) / GPU bubble ratio: 22.76%
[rank0]:2025-11-05 13:18:05,028 - INFO - Avg. fwd time: 4.3653 / Avg. bwd time: 8.7887 / Avg. batch time: 603.6103 (ms) / GPU bubble ratio: 65.13%
[rank2]:2025-11-05 13:18:05,036 - INFO - Avg. fwd time: 4.2855 / Avg. bwd time: 8.2017 / Avg. batch time: 561.5934 (ms) / GPU bubble ratio: 64.42%
[rank1]:2025-11-05 13:18:05,080 - INFO - Avg. fwd time: 5.2333 / Avg. bwd time: 9.5967 / Avg. batch time: 585.0286 (ms) / GPU bubble ratio: 59.44%
[rank2]:2025-11-05 13:18:06,336 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 0.88/0.88, [MB6] 0.64/0.64, [MB7] 1.00/1.00
[rank2]:2025-11-05 13:18:06,337 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.2357  memory:  8.52GiB(17.94%)  tps: 6,251  tflops: 47.61  mfu: 15.26%
[rank0]:2025-11-05 13:18:06,379 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.23/0.23, [MB4] 0.13/0.13, [MB5] 1.00/1.00, [MB6] 0.56/0.56, [MB7] 1.00/1.00
[rank0]:2025-11-05 13:18:06,379 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.2357  memory: 15.14GiB(31.88%)  tps: 6,252  tflops: 47.62  mfu: 15.26%
[rank1]:2025-11-05 13:18:06,705 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-11-05 13:18:06,706 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.2357  memory: 12.28GiB(25.84%)  tps: 6,255  tflops: 47.64  mfu: 15.27%
[rank3]:2025-11-05 13:18:08,842 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.60/0.60, [MB3] 1.00/1.00, [MB0] 1.00/1.00, [MB1] 0.97/0.97, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 0.63/0.63
[rank3]:2025-11-05 13:18:08,845 - INFO -  step: 200  loss:  0.2810  grad_norm:  0.2357  memory: 19.46GiB(40.96%)  tps: 6,256  tflops: 47.65  mfu: 15.27%
[rank0]:2025-11-05 13:18:08,897 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251105_1318_stage0_step200.svg
[rank0]:2025-11-05 13:18:08,940 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251105_1318_stage4_step200.svg
[rank2]:2025-11-05 13:18:08,900 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251105_1318_stage2_step200.svg
[rank2]:2025-11-05 13:18:08,946 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251105_1318_stage6_step200.svg
[rank1]:2025-11-05 13:18:08,897 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251105_1318_stage1_step200.svg
[rank1]:2025-11-05 13:18:08,938 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251105_1318_stage5_step200.svg
[rank3]:2025-11-05 13:18:09,085 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/pipeline_schedule/251105_1318_real_step200_rank3.svg
[rank3]:> Batch Time: 526.69 ms, GPU Bubble Ratio: 66.63%, 59.85%, 65.04%, 34.97%
[rank3]:2025-11-05 13:18:09,128 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251105_1318_stage3_step200.svg
[rank3]:2025-11-05 13:18:09,167 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251105_1318_stage7_step200.svg
[rank0]:2025-11-05 13:20:09,372 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-11-05 13:20:11,274 - INFO - Avg. fwd time: 4.4004 / Avg. bwd time: 7.9294 / Avg. batch time: 597.4807 (ms) / GPU bubble ratio: 66.98%
[rank2]:2025-11-05 13:20:11,334 - INFO - Avg. fwd time: 4.3484 / Avg. bwd time: 7.8746 / Avg. batch time: 558.7636 (ms) / GPU bubble ratio: 65.00%
[rank3]:2025-11-05 13:20:11,307 - INFO - Avg. fwd time: 7.3286 / Avg. bwd time: 16.8529 / Avg. batch time: 506.4265 (ms) / GPU bubble ratio: 23.60%
[rank1]:2025-11-05 13:20:11,344 - INFO - Avg. fwd time: 5.3100 / Avg. bwd time: 9.0410 / Avg. batch time: 580.9009 (ms) / GPU bubble ratio: 60.47%
[rank0]:2025-11-05 13:20:12,553 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.23/0.23, [MB4] 0.13/0.13, [MB5] 1.00/1.00, [MB6] 0.56/0.56, [MB7] 1.00/1.00
[rank0]:2025-11-05 13:20:12,554 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.1219  memory: 15.14GiB(31.88%)  tps: 6,493  tflops: 49.45  mfu: 15.85%
[rank1]:2025-11-05 13:20:12,602 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-11-05 13:20:12,602 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.1219  memory: 12.28GiB(25.84%)  tps: 6,507  tflops: 49.56  mfu: 15.88%
[rank2]:2025-11-05 13:20:12,691 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 0.88/0.88, [MB6] 0.64/0.64, [MB7] 1.00/1.00
[rank2]:2025-11-05 13:20:12,692 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.1219  memory:  8.52GiB(17.94%)  tps: 6,483  tflops: 49.38  mfu: 15.83%
[rank3]:2025-11-05 13:20:15,286 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.60/0.60, [MB3] 1.00/1.00, [MB0] 1.00/1.00, [MB1] 0.97/0.97, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 0.63/0.63
[rank3]:2025-11-05 13:20:15,288 - INFO -  step: 250  loss:  0.2625  grad_norm:  0.1219  memory: 19.46GiB(40.96%)  tps: 6,479  tflops: 49.34  mfu: 15.82%
[rank0]:2025-11-05 13:22:15,087 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-05 13:22:17,206 - INFO - Avg. fwd time: 7.3988 / Avg. bwd time: 16.2943 / Avg. batch time: 500.1818 (ms) / GPU bubble ratio: 24.21%
[rank2]:2025-11-05 13:22:17,226 - INFO - Avg. fwd time: 4.3900 / Avg. bwd time: 7.6609 / Avg. batch time: 558.2301 (ms) / GPU bubble ratio: 65.46%
[rank1]:2025-11-05 13:22:17,243 - INFO - Avg. fwd time: 5.3617 / Avg. bwd time: 8.6665 / Avg. batch time: 579.7332 (ms) / GPU bubble ratio: 61.28%
[rank0]:2025-11-05 13:22:17,254 - INFO - Avg. fwd time: 4.4240 / Avg. bwd time: 7.3222 / Avg. batch time: 594.9436 (ms) / GPU bubble ratio: 68.41%
[rank1]:2025-11-05 13:22:18,401 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-11-05 13:22:18,401 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.1031  memory: 12.28GiB(25.84%)  tps: 6,512  tflops: 49.60  mfu: 15.90%
[rank0]:2025-11-05 13:22:18,574 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.23/0.23, [MB4] 0.13/0.13, [MB5] 1.00/1.00, [MB6] 0.56/0.56, [MB7] 1.00/1.00
[rank0]:2025-11-05 13:22:18,574 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.1031  memory: 15.14GiB(31.88%)  tps: 6,501  tflops: 49.51  mfu: 15.87%
[rank2]:2025-11-05 13:22:18,731 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 0.88/0.88, [MB6] 0.64/0.64, [MB7] 1.00/1.00
[rank2]:2025-11-05 13:22:18,732 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.1031  memory:  8.52GiB(17.94%)  tps: 6,500  tflops: 49.50  mfu: 15.87%
[rank0]:2025-11-05 13:22:21,133 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251105_1322_stage0_step300.svg
[rank3]:2025-11-05 13:22:21,078 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.60/0.60, [MB3] 1.00/1.00, [MB0] 1.00/1.00, [MB1] 0.97/0.97, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 0.63/0.63
[rank3]:2025-11-05 13:22:21,081 - INFO -  step: 300  loss:  0.2456  grad_norm:  0.1031  memory: 19.46GiB(40.96%)  tps: 6,512  tflops: 49.60  mfu: 15.90%
[rank2]:2025-11-05 13:22:21,133 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251105_1322_stage2_step300.svg
[rank1]:2025-11-05 13:22:21,131 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251105_1322_stage1_step300.svg
[rank0]:2025-11-05 13:22:21,175 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251105_1322_stage4_step300.svg
[rank2]:2025-11-05 13:22:21,175 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251105_1322_stage6_step300.svg
[rank1]:2025-11-05 13:22:21,171 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251105_1322_stage5_step300.svg
[rank3]:2025-11-05 13:22:21,319 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/pipeline_schedule/251105_1322_real_step300_rank3.svg
[rank3]:> Batch Time: 517.50 ms, GPU Bubble Ratio: 72.22%, 61.31%, 65.19%, 33.91%
[rank3]:2025-11-05 13:22:21,361 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251105_1322_stage3_step300.svg
[rank3]:2025-11-05 13:22:21,401 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251105_1322_stage7_step300.svg
[rank0]:2025-11-05 13:24:19,427 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-11-05 13:24:21,286 - INFO - Avg. fwd time: 4.4374 / Avg. bwd time: 6.9520 / Avg. batch time: 591.9063 (ms) / GPU bubble ratio: 69.21%
[rank3]:2025-11-05 13:24:21,311 - INFO - Avg. fwd time: 7.4423 / Avg. bwd time: 15.9515 / Avg. batch time: 496.3967 (ms) / GPU bubble ratio: 24.60%
[rank2]:2025-11-05 13:24:21,341 - INFO - Avg. fwd time: 4.4152 / Avg. bwd time: 7.5285 / Avg. batch time: 556.4473 (ms) / GPU bubble ratio: 65.66%
[rank1]:2025-11-05 13:24:21,354 - INFO - Avg. fwd time: 5.3932 / Avg. bwd time: 8.4358 / Avg. batch time: 577.4334 (ms) / GPU bubble ratio: 61.68%
[rank2]:2025-11-05 13:24:22,570 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.0997  memory:  8.52GiB(17.94%)  tps: 6,615  tflops: 50.38  mfu: 16.15%
[rank0]:2025-11-05 13:24:22,644 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.0997  memory: 15.14GiB(31.88%)  tps: 6,603  tflops: 50.29  mfu: 16.12%
[rank1]:2025-11-05 13:24:22,676 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.0997  memory: 12.28GiB(25.84%)  tps: 6,592  tflops: 50.21  mfu: 16.09%
[rank3]:2025-11-05 13:24:24,849 - INFO -  step: 350  loss:  0.2502  grad_norm:  0.0997  memory: 19.46GiB(40.96%)  tps: 6,619  tflops: 50.41  mfu: 16.16%
[rank0]:2025-11-05 13:26:23,128 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-05 13:26:25,056 - INFO - Avg. fwd time: 7.4738 / Avg. bwd time: 15.6536 / Avg. batch time: 492.9857 (ms) / GPU bubble ratio: 24.94%
[rank2]:2025-11-05 13:26:25,083 - INFO - Avg. fwd time: 4.4376 / Avg. bwd time: 7.4132 / Avg. batch time: 555.2478 (ms) / GPU bubble ratio: 65.85%
[rank0]:2025-11-05 13:26:25,021 - INFO - Avg. fwd time: 4.4488 / Avg. bwd time: 6.6320 / Avg. batch time: 589.3168 (ms) / GPU bubble ratio: 69.92%
[rank1]:2025-11-05 13:26:25,092 - INFO - Avg. fwd time: 5.4214 / Avg. bwd time: 8.2305 / Avg. batch time: 575.6210 (ms) / GPU bubble ratio: 62.05%
[rank2]:2025-11-05 13:26:26,319 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.1156  memory:  8.52GiB(17.94%)  tps: 6,620  tflops: 50.42  mfu: 16.16%
[rank0]:2025-11-05 13:26:26,351 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.1156  memory: 15.14GiB(31.88%)  tps: 6,622  tflops: 50.44  mfu: 16.17%
[rank1]:2025-11-05 13:26:26,395 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.1156  memory: 12.28GiB(25.84%)  tps: 6,621  tflops: 50.43  mfu: 16.16%
[rank3]:2025-11-05 13:26:29,103 - INFO -  step: 400  loss:  0.2523  grad_norm:  0.1156  memory: 19.46GiB(40.96%)  tps: 6,593  tflops: 50.21  mfu: 16.09%
[rank2]:2025-11-05 13:26:29,159 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251105_1326_stage2_step400.svg
[rank0]:2025-11-05 13:26:29,157 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251105_1326_stage0_step400.svg
[rank0]:2025-11-05 13:26:29,202 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251105_1326_stage4_step400.svg
[rank1]:2025-11-05 13:26:29,157 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251105_1326_stage1_step400.svg
[rank1]:2025-11-05 13:26:29,202 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251105_1326_stage5_step400.svg
[rank2]:2025-11-05 13:26:29,205 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251105_1326_stage6_step400.svg
[rank3]:2025-11-05 13:26:29,338 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/pipeline_schedule/251105_1326_real_step400_rank3.svg
[rank3]:> Batch Time: 517.50 ms, GPU Bubble Ratio: 71.74%, 61.31%, 65.11%, 33.60%
[rank3]:2025-11-05 13:26:29,383 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251105_1326_stage3_step400.svg
[rank3]:2025-11-05 13:26:29,427 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251105_1326_stage7_step400.svg
[rank3]:2025-11-05 13:26:40,383 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-11-05 13:26:40,581 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-11-05 13:26:40,590 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-11-05 13:26:40,589 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-11-05 13:28:28,078 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-11-05 13:28:30,228 - INFO - Avg. fwd time: 4.4574 / Avg. bwd time: 6.3814 / Avg. batch time: 586.7615 (ms) / GPU bubble ratio: 70.44%
[rank3]:2025-11-05 13:28:30,175 - INFO - Avg. fwd time: 7.5005 / Avg. bwd time: 15.4296 / Avg. batch time: 490.4698 (ms) / GPU bubble ratio: 25.20%
[rank1]:2025-11-05 13:28:30,216 - INFO - Avg. fwd time: 5.4422 / Avg. bwd time: 8.0741 / Avg. batch time: 573.4987 (ms) / GPU bubble ratio: 62.29%
[rank2]:2025-11-05 13:28:30,197 - INFO - Avg. fwd time: 4.4541 / Avg. bwd time: 7.3245 / Avg. batch time: 553.2236 (ms) / GPU bubble ratio: 65.93%
[rank0]:2025-11-05 13:28:31,258 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.1060  memory: 15.14GiB(31.88%)  tps: 6,558  tflops: 49.95  mfu: 16.01%
[rank1]:2025-11-05 13:28:31,328 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.1060  memory: 12.28GiB(25.84%)  tps: 6,557  tflops: 49.94  mfu: 16.01%
[rank2]:2025-11-05 13:28:31,461 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.1060  memory:  8.52GiB(17.94%)  tps: 6,546  tflops: 49.86  mfu: 15.98%
[rank3]:2025-11-05 13:28:33,727 - INFO -  step: 450  loss:  0.2491  grad_norm:  0.1060  memory: 19.46GiB(40.96%)  tps: 6,573  tflops: 50.06  mfu: 16.05%
[rank0]:2025-11-05 13:30:33,558 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-05 13:30:35,461 - INFO - Avg. fwd time: 4.4629 / Avg. bwd time: 6.2144 / Avg. batch time: 587.4736 (ms) / GPU bubble ratio: 70.92%
[rank3]:2025-11-05 13:30:35,495 - INFO - Avg. fwd time: 7.5196 / Avg. bwd time: 15.2960 / Avg. batch time: 489.0769 (ms) / GPU bubble ratio: 25.36%
[rank2]:2025-11-05 13:30:35,527 - INFO - Avg. fwd time: 4.4657 / Avg. bwd time: 7.2645 / Avg. batch time: 554.4044 (ms) / GPU bubble ratio: 66.15%
[rank1]:2025-11-05 13:30:35,532 - INFO - Avg. fwd time: 5.4576 / Avg. bwd time: 7.9671 / Avg. batch time: 574.4524 (ms) / GPU bubble ratio: 62.61%
[rank1]:2025-11-05 13:30:36,813 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.1063  memory: 12.28GiB(25.84%)  tps: 6,528  tflops: 49.72  mfu: 15.94%
[rank0]:2025-11-05 13:30:36,848 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.1063  memory: 15.14GiB(31.88%)  tps: 6,523  tflops: 49.68  mfu: 15.92%
[rank2]:2025-11-05 13:30:36,849 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.1063  memory:  8.52GiB(17.94%)  tps: 6,533  tflops: 49.76  mfu: 15.95%
[rank3]:2025-11-05 13:30:39,676 - INFO -  step: 500  loss:  0.2724  grad_norm:  0.1063  memory: 19.46GiB(40.96%)  tps: 6,504  tflops: 49.54  mfu: 15.88%
[rank2]:2025-11-05 13:30:39,729 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251105_1330_stage2_step500.svg
[rank1]:2025-11-05 13:30:39,726 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251105_1330_stage1_step500.svg
[rank0]:2025-11-05 13:30:39,726 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251105_1330_stage0_step500.svg
[rank0]:2025-11-05 13:30:39,766 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251105_1330_stage4_step500.svg
[rank2]:2025-11-05 13:30:39,771 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251105_1330_stage6_step500.svg
[rank1]:2025-11-05 13:30:39,767 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251105_1330_stage5_step500.svg
[rank3]:2025-11-05 13:30:39,916 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/pipeline_schedule/251105_1330_real_step500_rank3.svg
[rank3]:> Batch Time: 526.00 ms, GPU Bubble Ratio: 71.97%, 61.88%, 65.77%, 33.00%
[rank3]:2025-11-05 13:30:39,958 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251105_1330_stage3_step500.svg
[rank3]:2025-11-05 13:30:39,998 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251105_1330_stage7_step500.svg
[rank0]:2025-11-05 13:32:39,490 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-11-05 13:32:41,407 - INFO - Avg. fwd time: 4.4709 / Avg. bwd time: 6.0434 / Avg. batch time: 585.8579 (ms) / GPU bubble ratio: 71.29%
[rank3]:2025-11-05 13:32:41,443 - INFO - Avg. fwd time: 7.5407 / Avg. bwd time: 15.1625 / Avg. batch time: 487.6996 (ms) / GPU bubble ratio: 25.52%
[rank2]:2025-11-05 13:32:41,470 - INFO - Avg. fwd time: 4.4775 / Avg. bwd time: 7.2065 / Avg. batch time: 553.4451 (ms) / GPU bubble ratio: 66.22%
[rank1]:2025-11-05 13:32:41,479 - INFO - Avg. fwd time: 5.4724 / Avg. bwd time: 7.8652 / Avg. batch time: 573.2142 (ms) / GPU bubble ratio: 62.77%
[rank0]:2025-11-05 13:32:42,707 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.1181  memory: 15.14GiB(31.88%)  tps: 6,509  tflops: 49.57  mfu: 15.89%
[rank1]:2025-11-05 13:32:42,816 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.1181  memory: 12.28GiB(25.84%)  tps: 6,501  tflops: 49.52  mfu: 15.87%
[rank2]:2025-11-05 13:32:42,871 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.1181  memory:  8.52GiB(17.94%)  tps: 6,500  tflops: 49.51  mfu: 15.87%
[rank3]:2025-11-05 13:32:45,428 - INFO -  step: 550  loss:  0.3218  grad_norm:  0.1181  memory: 19.46GiB(40.96%)  tps: 6,515  tflops: 49.62  mfu: 15.90%
[rank0]:2025-11-05 13:34:45,548 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-05 13:34:47,710 - INFO - Avg. fwd time: 7.5553 / Avg. bwd time: 15.0496 / Avg. batch time: 486.4916 (ms) / GPU bubble ratio: 25.66%
[rank0]:2025-11-05 13:34:47,766 - INFO - Avg. fwd time: 4.4751 / Avg. bwd time: 5.9125 / Avg. batch time: 585.8916 (ms) / GPU bubble ratio: 71.63%
[rank2]:2025-11-05 13:34:47,734 - INFO - Avg. fwd time: 4.4873 / Avg. bwd time: 7.1587 / Avg. batch time: 553.9001 (ms) / GPU bubble ratio: 66.36%
[rank1]:2025-11-05 13:34:47,753 - INFO - Avg. fwd time: 5.4847 / Avg. bwd time: 7.7799 / Avg. batch time: 573.4192 (ms) / GPU bubble ratio: 62.99%
[rank0]:2025-11-05 13:34:48,862 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0974  memory: 15.14GiB(31.88%)  tps: 6,494  tflops: 49.46  mfu: 15.85%
[rank2]:2025-11-05 13:34:48,965 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0974  memory:  8.52GiB(17.94%)  tps: 6,497  tflops: 49.48  mfu: 15.86%
[rank1]:2025-11-05 13:34:48,917 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0974  memory: 12.28GiB(25.84%)  tps: 6,496  tflops: 49.48  mfu: 15.86%
[rank3]:2025-11-05 13:34:51,276 - INFO -  step: 600  loss:  0.2381  grad_norm:  0.0974  memory: 19.46GiB(40.96%)  tps: 6,510  tflops: 49.58  mfu: 15.89%
[rank0]:2025-11-05 13:34:51,328 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251105_1334_stage0_step600.svg
[rank0]:2025-11-05 13:34:51,369 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251105_1334_stage4_step600.svg
[rank2]:2025-11-05 13:34:51,336 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251105_1334_stage2_step600.svg
[rank2]:2025-11-05 13:34:51,378 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251105_1334_stage6_step600.svg
[rank1]:2025-11-05 13:34:51,328 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251105_1334_stage1_step600.svg
[rank1]:2025-11-05 13:34:51,370 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251105_1334_stage5_step600.svg
[rank3]:2025-11-05 13:34:51,516 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/pipeline_schedule/251105_1334_real_step600_rank3.svg
[rank3]:> Batch Time: 526.50 ms, GPU Bubble Ratio: 71.87%, 61.94%, 65.79%, 33.32%
[rank3]:2025-11-05 13:34:51,560 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251105_1334_stage3_step600.svg
[rank3]:2025-11-05 13:34:51,601 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251105_1334_stage7_step600.svg
[rank0]:2025-11-05 13:36:51,420 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-05 13:36:53,307 - INFO - Avg. fwd time: 7.5668 / Avg. bwd time: 14.9601 / Avg. batch time: 485.5014 (ms) / GPU bubble ratio: 25.76%
[rank0]:2025-11-05 13:36:53,280 - INFO - Avg. fwd time: 4.4778 / Avg. bwd time: 5.8180 / Avg. batch time: 585.6252 (ms) / GPU bubble ratio: 71.87%
[rank2]:2025-11-05 13:36:53,336 - INFO - Avg. fwd time: 4.4940 / Avg. bwd time: 7.1236 / Avg. batch time: 554.0189 (ms) / GPU bubble ratio: 66.45%
[rank1]:2025-11-05 13:36:53,349 - INFO - Avg. fwd time: 5.4932 / Avg. bwd time: 7.7180 / Avg. batch time: 573.3551 (ms) / GPU bubble ratio: 63.13%
[rank2]:2025-11-05 13:36:54,633 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.1175  memory:  8.52GiB(17.94%)  tps: 6,519  tflops: 49.65  mfu: 15.91%
[rank1]:2025-11-05 13:36:54,620 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.1175  memory: 12.28GiB(25.84%)  tps: 6,517  tflops: 49.63  mfu: 15.91%
[rank0]:2025-11-05 13:36:54,627 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.1175  memory: 15.14GiB(31.88%)  tps: 6,514  tflops: 49.61  mfu: 15.90%
[rank3]:2025-11-05 13:36:56,993 - INFO -  step: 650  loss:  0.2513  grad_norm:  0.1175  memory: 19.46GiB(40.96%)  tps: 6,516  tflops: 49.63  mfu: 15.91%
[rank0]:2025-11-05 13:38:56,093 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-05 13:38:57,997 - INFO - Avg. fwd time: 4.4822 / Avg. bwd time: 5.7124 / Avg. batch time: 585.0902 (ms) / GPU bubble ratio: 72.12%
[rank1]:2025-11-05 13:38:58,070 - INFO - Avg. fwd time: 5.5020 / Avg. bwd time: 7.6565 / Avg. batch time: 572.8448 (ms) / GPU bubble ratio: 63.25%
[rank2]:2025-11-05 13:38:58,060 - INFO - Avg. fwd time: 4.5007 / Avg. bwd time: 7.0883 / Avg. batch time: 553.6645 (ms) / GPU bubble ratio: 66.51%
[rank3]:2025-11-05 13:38:58,033 - INFO - Avg. fwd time: 7.5804 / Avg. bwd time: 14.8666 / Avg. batch time: 484.4842 (ms) / GPU bubble ratio: 25.87%
[rank0]:2025-11-05 13:38:59,358 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.1007  memory: 15.14GiB(31.88%)  tps: 6,568  tflops: 50.02  mfu: 16.03%
[rank1]:2025-11-05 13:38:59,499 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.1007  memory: 12.28GiB(25.84%)  tps: 6,560  tflops: 49.96  mfu: 16.01%
[rank2]:2025-11-05 13:38:59,456 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.1007  memory:  8.52GiB(17.94%)  tps: 6,563  tflops: 49.98  mfu: 16.02%
[rank3]:2025-11-05 13:39:02,001 - INFO -  step: 700  loss:  0.2306  grad_norm:  0.1007  memory: 19.46GiB(40.96%)  tps: 6,553  tflops: 49.91  mfu: 16.00%
[rank1]:2025-11-05 13:39:02,056 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251105_1338_stage1_step700.svg
[rank1]:2025-11-05 13:39:02,099 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251105_1338_stage5_step700.svg
[rank2]:2025-11-05 13:39:02,054 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251105_1338_stage2_step700.svg
[rank2]:2025-11-05 13:39:02,097 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251105_1338_stage6_step700.svg
[rank0]:2025-11-05 13:39:02,054 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251105_1338_stage0_step700.svg
[rank0]:2025-11-05 13:39:02,097 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251105_1338_stage4_step700.svg
[rank3]:2025-11-05 13:39:02,233 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/pipeline_schedule/251105_1339_real_step700_rank3.svg
[rank3]:> Batch Time: 520.50 ms, GPU Bubble Ratio: 72.49%, 61.50%, 65.40%, 33.85%
[rank3]:2025-11-05 13:39:02,277 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251105_1339_stage3_step700.svg
[rank3]:2025-11-05 13:39:02,319 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251105_1339_stage7_step700.svg
[rank0]:2025-11-05 13:41:00,909 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-11-05 13:41:03,065 - INFO - Avg. fwd time: 5.5090 / Avg. bwd time: 7.6035 / Avg. batch time: 571.5229 (ms) / GPU bubble ratio: 63.29%
[rank3]:2025-11-05 13:41:03,019 - INFO - Avg. fwd time: 7.5915 / Avg. bwd time: 14.7868 / Avg. batch time: 483.5764 (ms) / GPU bubble ratio: 25.96%
[rank2]:2025-11-05 13:41:03,043 - INFO - Avg. fwd time: 4.5061 / Avg. bwd time: 7.0576 / Avg. batch time: 552.5379 (ms) / GPU bubble ratio: 66.51%
[rank0]:2025-11-05 13:41:03,082 - INFO - Avg. fwd time: 4.4852 / Avg. bwd time: 5.6285 / Avg. batch time: 583.7492 (ms) / GPU bubble ratio: 72.28%
[rank2]:2025-11-05 13:41:04,186 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1147  memory:  8.52GiB(17.94%)  tps: 6,568  tflops: 50.02  mfu: 16.03%
[rank0]:2025-11-05 13:41:04,212 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1147  memory: 15.14GiB(31.88%)  tps: 6,561  tflops: 49.97  mfu: 16.02%
[rank1]:2025-11-05 13:41:04,390 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1147  memory: 12.28GiB(25.84%)  tps: 6,559  tflops: 49.96  mfu: 16.01%
[rank3]:2025-11-05 13:41:06,595 - INFO -  step: 750  loss:  0.2906  grad_norm:  0.1147  memory: 19.46GiB(40.96%)  tps: 6,575  tflops: 50.08  mfu: 16.05%
[rank0]:2025-11-05 13:43:04,974 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-05 13:43:06,882 - INFO - Avg. fwd time: 4.4868 / Avg. bwd time: 5.5660 / Avg. batch time: 583.8339 (ms) / GPU bubble ratio: 72.45%
[rank2]:2025-11-05 13:43:06,945 - INFO - Avg. fwd time: 4.5103 / Avg. bwd time: 7.0341 / Avg. batch time: 552.7628 (ms) / GPU bubble ratio: 66.58%
[rank3]:2025-11-05 13:43:06,921 - INFO - Avg. fwd time: 7.6003 / Avg. bwd time: 14.7270 / Avg. batch time: 482.9055 (ms) / GPU bubble ratio: 26.02%
[rank1]:2025-11-05 13:43:06,956 - INFO - Avg. fwd time: 5.5142 / Avg. bwd time: 7.5636 / Avg. batch time: 571.6063 (ms) / GPU bubble ratio: 63.39%
[rank0]:2025-11-05 13:43:08,139 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1133  memory: 15.14GiB(31.88%)  tps: 6,610  tflops: 50.35  mfu: 16.14%
[rank2]:2025-11-05 13:43:08,336 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1133  memory:  8.52GiB(17.94%)  tps: 6,599  tflops: 50.26  mfu: 16.11%
[rank1]:2025-11-05 13:43:08,395 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1133  memory: 12.28GiB(25.84%)  tps: 6,606  tflops: 50.31  mfu: 16.13%
[rank3]:2025-11-05 13:43:10,647 - INFO -  step: 800  loss:  0.2380  grad_norm:  0.1133  memory: 19.46GiB(40.96%)  tps: 6,604  tflops: 50.30  mfu: 16.12%
[rank0]:2025-11-05 13:43:10,702 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251105_1343_stage0_step800.svg
[rank1]:2025-11-05 13:43:10,703 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251105_1343_stage1_step800.svg
[rank2]:2025-11-05 13:43:10,703 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251105_1343_stage2_step800.svg
[rank2]:2025-11-05 13:43:10,749 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251105_1343_stage6_step800.svg
[rank0]:2025-11-05 13:43:10,749 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251105_1343_stage4_step800.svg
[rank1]:2025-11-05 13:43:10,749 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251105_1343_stage5_step800.svg
[rank3]:2025-11-05 13:43:10,886 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/pipeline_schedule/251105_1343_real_step800_rank3.svg
[rank3]:> Batch Time: 519.50 ms, GPU Bubble Ratio: 71.94%, 61.44%, 65.37%, 33.57%
[rank3]:2025-11-05 13:43:10,933 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251105_1343_stage3_step800.svg
[rank3]:2025-11-05 13:43:10,977 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251105_1343_stage7_step800.svg
[rank3]:2025-11-05 13:43:37,711 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-11-05 13:43:37,918 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-11-05 13:43:37,918 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-11-05 13:43:37,911 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-11-05 13:45:09,354 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-11-05 13:45:11,238 - INFO - Avg. fwd time: 4.4891 / Avg. bwd time: 5.5022 / Avg. batch time: 582.7742 (ms) / GPU bubble ratio: 72.57%
[rank2]:2025-11-05 13:45:11,299 - INFO - Avg. fwd time: 4.5150 / Avg. bwd time: 7.0107 / Avg. batch time: 551.9220 (ms) / GPU bubble ratio: 66.59%
[rank1]:2025-11-05 13:45:11,308 - INFO - Avg. fwd time: 5.5201 / Avg. bwd time: 7.5227 / Avg. batch time: 570.6150 (ms) / GPU bubble ratio: 63.43%
[rank3]:2025-11-05 13:45:11,273 - INFO - Avg. fwd time: 7.6107 / Avg. bwd time: 14.6721 / Avg. batch time: 482.3665 (ms) / GPU bubble ratio: 26.09%
[rank0]:2025-11-05 13:45:12,537 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.1212  memory: 15.14GiB(31.88%)  tps: 6,585  tflops: 50.16  mfu: 16.08%
[rank2]:2025-11-05 13:45:12,610 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.1212  memory:  8.52GiB(17.94%)  tps: 6,592  tflops: 50.21  mfu: 16.09%
[rank1]:2025-11-05 13:45:12,561 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.1212  memory: 12.28GiB(25.84%)  tps: 6,598  tflops: 50.25  mfu: 16.11%
[rank3]:2025-11-05 13:45:15,197 - INFO -  step: 850  loss:  0.2464  grad_norm:  0.1212  memory: 19.46GiB(40.96%)  tps: 6,577  tflops: 50.09  mfu: 16.06%
[rank0]:2025-11-05 13:47:13,609 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-05 13:47:15,766 - INFO - Avg. fwd time: 4.5192 / Avg. bwd time: 6.9905 / Avg. batch time: 551.7449 (ms) / GPU bubble ratio: 66.62%
[rank3]:2025-11-05 13:47:15,741 - INFO - Avg. fwd time: 7.6196 / Avg. bwd time: 14.6198 / Avg. batch time: 481.8191 (ms) / GPU bubble ratio: 26.15%
[rank1]:2025-11-05 13:47:15,789 - INFO - Avg. fwd time: 5.5255 / Avg. bwd time: 7.4863 / Avg. batch time: 570.3194 (ms) / GPU bubble ratio: 63.50%
[rank0]:2025-11-05 13:47:15,805 - INFO - Avg. fwd time: 4.4920 / Avg. bwd time: 5.4392 / Avg. batch time: 582.3434 (ms) / GPU bubble ratio: 72.71%
[rank1]:2025-11-05 13:47:16,977 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0901  memory: 12.28GiB(25.84%)  tps: 6,584  tflops: 50.15  mfu: 16.07%
[rank2]:2025-11-05 13:47:16,997 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0901  memory:  8.52GiB(17.94%)  tps: 6,586  tflops: 50.16  mfu: 16.08%
[rank0]:2025-11-05 13:47:17,320 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0901  memory: 15.14GiB(31.88%)  tps: 6,565  tflops: 50.00  mfu: 16.03%
[rank3]:2025-11-05 13:47:19,392 - INFO -  step: 900  loss:  0.2162  grad_norm:  0.0901  memory: 19.46GiB(40.96%)  tps: 6,596  tflops: 50.24  mfu: 16.10%
[rank1]:2025-11-05 13:47:19,442 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251105_1347_stage1_step900.svg
[rank1]:2025-11-05 13:47:19,482 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251105_1347_stage5_step900.svg
[rank2]:2025-11-05 13:47:19,442 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251105_1347_stage2_step900.svg
[rank2]:2025-11-05 13:47:19,483 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251105_1347_stage6_step900.svg
[rank0]:2025-11-05 13:47:19,445 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251105_1347_stage0_step900.svg
[rank0]:2025-11-05 13:47:19,487 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251105_1347_stage4_step900.svg
[rank3]:2025-11-05 13:47:19,631 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/pipeline_schedule/251105_1347_real_step900_rank3.svg
[rank3]:> Batch Time: 521.00 ms, GPU Bubble Ratio: 72.80%, 61.51%, 65.36%, 33.64%
[rank3]:2025-11-05 13:47:19,672 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251105_1347_stage3_step900.svg
[rank3]:2025-11-05 13:47:19,711 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251105_1347_stage7_step900.svg
[rank0]:2025-11-05 13:49:18,172 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-11-05 13:49:20,048 - INFO - Avg. fwd time: 4.4935 / Avg. bwd time: 5.3986 / Avg. batch time: 581.6636 (ms) / GPU bubble ratio: 72.79%
[rank3]:2025-11-05 13:49:20,087 - INFO - Avg. fwd time: 7.6263 / Avg. bwd time: 14.5744 / Avg. batch time: 481.3416 (ms) / GPU bubble ratio: 26.20%
[rank2]:2025-11-05 13:49:20,114 - INFO - Avg. fwd time: 4.5228 / Avg. bwd time: 6.9742 / Avg. batch time: 551.3460 (ms) / GPU bubble ratio: 66.64%
[rank1]:2025-11-05 13:49:20,126 - INFO - Avg. fwd time: 5.5298 / Avg. bwd time: 7.4581 / Avg. batch time: 569.8150 (ms) / GPU bubble ratio: 63.53%
[rank0]:2025-11-05 13:49:21,422 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.1099  memory: 15.14GiB(31.88%)  tps: 6,601  tflops: 50.28  mfu: 16.11%
[rank2]:2025-11-05 13:49:21,445 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.1099  memory:  8.52GiB(17.94%)  tps: 6,583  tflops: 50.14  mfu: 16.07%
[rank1]:2025-11-05 13:49:21,469 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.1099  memory: 12.28GiB(25.84%)  tps: 6,580  tflops: 50.12  mfu: 16.06%
[rank3]:2025-11-05 13:49:23,942 - INFO -  step: 950  loss:  0.2676  grad_norm:  0.1099  memory: 19.46GiB(40.96%)  tps: 6,577  tflops: 50.09  mfu: 16.06%
[rank0]:2025-11-05 13:51:21,859 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-05 13:51:23,776 - INFO - Avg. fwd time: 4.4937 / Avg. bwd time: 5.3602 / Avg. batch time: 581.3177 (ms) / GPU bubble ratio: 72.88%
[rank2]:2025-11-05 13:51:23,841 - INFO - Avg. fwd time: 4.5262 / Avg. bwd time: 6.9571 / Avg. batch time: 551.0852 (ms) / GPU bubble ratio: 66.66%
[rank3]:2025-11-05 13:51:23,814 - INFO - Avg. fwd time: 7.6336 / Avg. bwd time: 14.5307 / Avg. batch time: 480.8822 (ms) / GPU bubble ratio: 26.25%
[rank1]:2025-11-05 13:51:23,850 - INFO - Avg. fwd time: 5.5341 / Avg. bwd time: 7.4286 / Avg. batch time: 569.5237 (ms) / GPU bubble ratio: 63.58%
[rank0]:2025-11-05 13:51:25,026 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.1041  memory: 15.14GiB(31.88%)  tps: 6,628  tflops: 50.48  mfu: 16.18%
[rank1]:2025-11-05 13:51:25,226 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.1041  memory: 12.28GiB(25.84%)  tps: 6,619  tflops: 50.41  mfu: 16.16%
[rank2]:2025-11-05 13:51:25,467 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.1041  memory:  8.52GiB(17.94%)  tps: 6,605  tflops: 50.31  mfu: 16.12%
[rank3]:2025-11-05 13:51:27,755 - INFO -  step: 1000  loss:  0.2552  grad_norm:  0.1041  memory: 19.46GiB(40.96%)  tps: 6,617  tflops: 50.39  mfu: 16.15%
[rank0]:2025-11-05 13:51:27,806 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251105_1351_stage0_step1000.svg
[rank2]:2025-11-05 13:51:27,806 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251105_1351_stage2_step1000.svg
[rank2]:2025-11-05 13:51:27,847 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251105_1351_stage6_step1000.svg
[rank1]:2025-11-05 13:51:27,806 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251105_1351_stage1_step1000.svg
[rank1]:2025-11-05 13:51:27,847 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251105_1351_stage5_step1000.svg
[rank0]:2025-11-05 13:51:27,848 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251105_1351_stage4_step1000.svg
[rank3]:2025-11-05 13:51:27,991 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/pipeline_schedule/251105_1351_real_step1000_rank3.svg
[rank3]:> Batch Time: 521.50 ms, GPU Bubble Ratio: 72.79%, 61.59%, 65.41%, 33.49%
[rank3]:2025-11-05 13:51:28,034 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251105_1351_stage3_step1000.svg
[rank3]:2025-11-05 13:51:28,074 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251105_1351_stage7_step1000.svg
[rank0]:2025-11-05 13:53:28,101 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-05 13:53:30,223 - INFO - Avg. fwd time: 7.6382 / Avg. bwd time: 14.5015 / Avg. batch time: 480.5926 (ms) / GPU bubble ratio: 26.29%
[rank2]:2025-11-05 13:53:30,256 - INFO - Avg. fwd time: 4.5296 / Avg. bwd time: 6.9423 / Avg. batch time: 550.6901 (ms) / GPU bubble ratio: 66.67%
[rank1]:2025-11-05 13:53:30,280 - INFO - Avg. fwd time: 5.5381 / Avg. bwd time: 7.4013 / Avg. batch time: 569.0435 (ms) / GPU bubble ratio: 63.62%
[rank0]:2025-11-05 13:53:30,298 - INFO - Avg. fwd time: 4.4960 / Avg. bwd time: 5.3136 / Avg. batch time: 580.7298 (ms) / GPU bubble ratio: 72.97%
[rank0]:2025-11-05 13:53:31,376 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.1205  memory: 15.14GiB(31.88%)  tps: 6,484  tflops: 49.38  mfu: 15.83%
[rank1]:2025-11-05 13:53:31,523 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.1205  memory: 12.28GiB(25.84%)  tps: 6,486  tflops: 49.40  mfu: 15.83%
[rank2]:2025-11-05 13:53:31,754 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.1205  memory:  8.52GiB(17.94%)  tps: 6,487  tflops: 49.41  mfu: 15.84%
[rank3]:2025-11-05 13:53:33,989 - INFO -  step: 1050  loss:  0.2987  grad_norm:  0.1205  memory: 19.46GiB(40.96%)  tps: 6,490  tflops: 49.43  mfu: 15.84%
[rank0]:2025-11-05 13:55:33,340 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-05 13:55:35,252 - INFO - Avg. fwd time: 4.4965 / Avg. bwd time: 5.2840 / Avg. batch time: 581.2167 (ms) / GPU bubble ratio: 73.08%
[rank3]:2025-11-05 13:55:35,289 - INFO - Avg. fwd time: 7.6432 / Avg. bwd time: 14.4701 / Avg. batch time: 480.2591 (ms) / GPU bubble ratio: 26.33%
[rank1]:2025-11-05 13:55:35,325 - INFO - Avg. fwd time: 5.5406 / Avg. bwd time: 7.3804 / Avg. batch time: 569.4972 (ms) / GPU bubble ratio: 63.70%
[rank2]:2025-11-05 13:55:35,323 - INFO - Avg. fwd time: 4.5315 / Avg. bwd time: 6.9301 / Avg. batch time: 551.1131 (ms) / GPU bubble ratio: 66.72%
[rank0]:2025-11-05 13:55:36,620 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.1100  memory: 15.14GiB(31.88%)  tps: 6,541  tflops: 49.82  mfu: 15.97%
[rank1]:2025-11-05 13:55:36,725 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.1100  memory: 12.28GiB(25.84%)  tps: 6,543  tflops: 49.83  mfu: 15.97%
[rank2]:2025-11-05 13:55:37,021 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.1100  memory:  8.52GiB(17.94%)  tps: 6,540  tflops: 49.81  mfu: 15.96%
[rank3]:2025-11-05 13:55:38,946 - INFO -  step: 1100  loss:  0.2594  grad_norm:  0.1100  memory: 19.46GiB(40.96%)  tps: 6,556  tflops: 49.93  mfu: 16.00%
[rank1]:2025-11-05 13:55:38,997 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251105_1355_stage1_step1100.svg
[rank1]:2025-11-05 13:55:39,037 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251105_1355_stage5_step1100.svg
[rank2]:2025-11-05 13:55:39,004 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251105_1355_stage2_step1100.svg
[rank2]:2025-11-05 13:55:39,049 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251105_1355_stage6_step1100.svg
[rank0]:2025-11-05 13:55:39,001 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251105_1355_stage0_step1100.svg
[rank0]:2025-11-05 13:55:39,043 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251105_1355_stage4_step1100.svg
[rank3]:2025-11-05 13:55:39,179 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/pipeline_schedule/251105_1355_real_step1100_rank3.svg
[rank3]:> Batch Time: 519.50 ms, GPU Bubble Ratio: 71.64%, 61.51%, 65.43%, 33.55%
[rank3]:2025-11-05 13:55:39,221 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251105_1355_stage3_step1100.svg
[rank3]:2025-11-05 13:55:39,260 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251105_1355_stage7_step1100.svg
[rank0]:2025-11-05 13:57:38,625 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-11-05 13:57:40,509 - INFO - Avg. fwd time: 4.4976 / Avg. bwd time: 5.2480 / Avg. batch time: 580.6872 (ms) / GPU bubble ratio: 73.15%
[rank2]:2025-11-05 13:57:40,570 - INFO - Avg. fwd time: 4.5335 / Avg. bwd time: 6.9175 / Avg. batch time: 550.6177 (ms) / GPU bubble ratio: 66.73%
[rank1]:2025-11-05 13:57:40,582 - INFO - Avg. fwd time: 5.5434 / Avg. bwd time: 7.3577 / Avg. batch time: 569.0717 (ms) / GPU bubble ratio: 63.73%
[rank3]:2025-11-05 13:57:40,543 - INFO - Avg. fwd time: 7.6457 / Avg. bwd time: 14.4481 / Avg. batch time: 480.0126 (ms) / GPU bubble ratio: 26.36%
[rank0]:2025-11-05 13:57:41,854 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0973  memory: 15.14GiB(31.88%)  tps: 6,541  tflops: 49.82  mfu: 15.97%
[rank1]:2025-11-05 13:57:41,876 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0973  memory: 12.28GiB(25.84%)  tps: 6,546  tflops: 49.85  mfu: 15.98%
[rank2]:2025-11-05 13:57:41,902 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0973  memory:  8.52GiB(17.94%)  tps: 6,560  tflops: 49.96  mfu: 16.01%
[rank3]:2025-11-05 13:57:44,008 - INFO -  step: 1150  loss:  0.2579  grad_norm:  0.0973  memory: 19.46GiB(40.96%)  tps: 6,550  tflops: 49.89  mfu: 15.99%
[rank0]:2025-11-05 13:59:42,980 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-05 13:59:45,160 - INFO - Avg. fwd time: 4.5357 / Avg. bwd time: 6.9061 / Avg. batch time: 550.5610 (ms) / GPU bubble ratio: 66.75%
[rank1]:2025-11-05 13:59:45,185 - INFO - Avg. fwd time: 5.5463 / Avg. bwd time: 7.3375 / Avg. batch time: 569.0482 (ms) / GPU bubble ratio: 63.77%
[rank3]:2025-11-05 13:59:45,128 - INFO - Avg. fwd time: 7.6502 / Avg. bwd time: 14.4285 / Avg. batch time: 479.8518 (ms) / GPU bubble ratio: 26.38%
[rank0]:2025-11-05 13:59:45,206 - INFO - Avg. fwd time: 4.4982 / Avg. bwd time: 5.2172 / Avg. batch time: 580.5867 (ms) / GPU bubble ratio: 73.23%
[rank0]:2025-11-05 13:59:46,252 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.1074  memory: 15.14GiB(31.88%)  tps: 6,585  tflops: 50.16  mfu: 16.08%
[rank0]:2025-11-05 13:59:46,252 - INFO -  final step: 1200  loss: -4.0000  grad_norm:  0.1074  tps: 6,748  tflops: 51.40  mfu: 15.41%
[rank0]:2025-11-05 13:59:46,252 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-05 13:59:46,253 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1200.
[rank1]:2025-11-05 13:59:46,328 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.1074  memory: 12.28GiB(25.84%)  tps: 6,583  tflops: 50.13  mfu: 16.07%
[rank1]:2025-11-05 13:59:46,328 - INFO -  final step: 1200  loss: -4.0000  grad_norm:  0.1074  tps: 6,748  tflops: 51.39  mfu: 15.41%
[rank1]:2025-11-05 13:59:46,328 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-11-05 13:59:46,329 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1200.
[rank2]:2025-11-05 13:59:46,453 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.1074  memory:  8.52GiB(17.94%)  tps: 6,577  tflops: 50.09  mfu: 16.06%
[rank2]:2025-11-05 13:59:46,453 - INFO -  final step: 1200  loss: -4.0000  grad_norm:  0.1074  tps: 6,747  tflops: 51.39  mfu: 15.41%
[rank2]:2025-11-05 13:59:46,453 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-05 13:59:46,454 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1200.
[rank3]:2025-11-05 13:59:48,772 - INFO -  step: 1200  loss:  0.2608  grad_norm:  0.1074  memory: 19.46GiB(40.96%)  tps: 6,566  tflops: 50.01  mfu: 16.03%
[rank3]:2025-11-05 13:59:48,773 - INFO -  final step: 1200  loss:  0.2608  grad_norm:  0.1074  tps: 6,748  tflops: 51.40  mfu: 15.49%
[rank3]:2025-11-05 13:59:48,773 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-11-05 13:59:48,774 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1200.
[rank0]:2025-11-05 13:59:50,932 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-11-05 13:59:51,010 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251105_1359_stage0_final1200.svg
[rank2]:2025-11-05 13:59:51,013 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251105_1359_stage2_final1200.svg
[rank1]:2025-11-05 13:59:51,012 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251105_1359_stage1_final1200.svg
[rank0]:2025-11-05 13:59:51,119 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/frozen_params_histogram/251105_1359_rank0_stage0.svg
[rank0]:	> Counts Sum: 455960, Total Sum: 687040 (66.37%), Ratio(%) per element: [66.26, 66.37, 66.15, 66.59, 66.15, 66.59, 66.15, 67.36, 65.92, 66.92, 66.59, 65.7, 65.81, 65.15, 65.48, 66.48, 66.7, 67.47, 67.03]
[rank2]:2025-11-05 13:59:51,120 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/frozen_params_histogram/251105_1359_rank2_stage2.svg
[rank2]:	> Counts Sum: 368800, Total Sum: 650880 (56.66%), Ratio(%) per element: [56.19, 57.07, 56.52, 55.08, 56.74, 55.97, 55.97, 57.41, 56.41, 55.42, 56.74, 56.96, 57.63, 55.19, 57.52, 57.41, 58.62, 56.96]
[rank2]:2025-11-05 13:59:51,163 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251105_1359_stage6_final1200.svg
[rank1]:2025-11-05 13:59:51,144 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/frozen_params_histogram/251105_1359_rank1_stage1.svg
[rank1]:	> Counts Sum: 495360, Total Sum: 976320 (50.74%), Ratio(%) per element: [50.55, 50.66, 50.0, 50.44, 50.22, 50.88, 51.21, 51.43, 50.88, 50.55, 50.44, 50.66, 50.66, 50.66, 50.66, 50.77, 50.66, 51.65, 50.66, 50.66, 50.77, 51.1, 51.1, 50.11, 50.66, 50.99, 50.77]
[rank1]:2025-11-05 13:59:51,186 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251105_1359_stage5_final1200.svg
[rank3]:2025-11-05 13:59:51,194 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/pipeline_schedule/251105_1359_real_final1200_rank3.svg
[rank3]:> Batch Time: 521.00 ms, GPU Bubble Ratio: 72.25%, 61.55%, 65.47%, 33.90%
[rank0]:2025-11-05 13:59:51,162 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251105_1359_stage4_final1200.svg
[rank2]:2025-11-05 13:59:51,264 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/frozen_params_histogram/251105_1359_rank2_stage6.svg
[rank2]:	> Counts Sum: 562080, Total Sum: 650880 (86.36%), Ratio(%) per element: [86.17, 86.28, 86.17, 86.17, 86.39, 86.17, 86.06, 87.05, 86.94, 86.5, 86.28, 86.39, 86.28, 85.95, 86.28, 86.28, 86.17, 86.83]
[rank2]:2025-11-05 13:59:51,264 - INFO - Destroying the purge thread.
[rank1]:2025-11-05 13:59:51,287 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/frozen_params_histogram/251105_1359_rank1_stage5.svg
[rank1]:	> Counts Sum: 562080, Total Sum: 650880 (86.36%), Ratio(%) per element: [86.17, 86.39, 86.28, 86.17, 86.28, 86.06, 86.5, 86.83, 86.5, 86.28, 86.06, 86.17, 86.39, 86.28, 86.61, 86.5, 86.39, 86.5]
[rank1]:2025-11-05 13:59:51,288 - INFO - Destroying the purge thread.
[rank0]:2025-11-05 13:59:51,259 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/frozen_params_histogram/251105_1359_rank0_stage4.svg
[rank0]:	> Counts Sum: 622120, Total Sum: 650880 (95.58%), Ratio(%) per element: [95.9, 94.69, 94.91, 94.13, 95.57, 94.46, 94.8, 98.23, 96.79, 95.02, 94.91, 95.02, 95.57, 95.13, 93.69, 95.24, 98.23, 98.11]
[rank0]:2025-11-05 13:59:51,260 - INFO - Sleeping 2 seconds for other ranks to complete
[rank2]:2025-11-05 13:59:51,288 - INFO - Process group destroyed
[rank3]:2025-11-05 13:59:51,436 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/pipeline_schedule/251105_1359_thry_final1200_rank3.svg
[rank3]:> Batch Time: 319.06 ms, GPU Bubble Ratio: 15.79%, 15.79%, 15.79%, 15.79%
[rank3]:2025-11-05 13:59:51,481 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251105_1359_stage3_final1200.svg
[rank3]:2025-11-05 13:59:51,589 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/frozen_params_histogram/251105_1359_rank3_stage3.svg
[rank3]:	> Counts Sum: 209800, Total Sum: 650880 (32.23%), Ratio(%) per element: [32.41, 31.63, 31.96, 31.3, 31.52, 31.19, 30.75, 36.83, 34.29, 31.85, 31.19, 31.63, 31.63, 31.52, 31.41, 31.19, 36.28, 31.52]
[rank3]:2025-11-05 13:59:51,631 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251105_1359_stage7_final1200.svg
[rank3]:2025-11-05 13:59:51,712 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1/frozen_params_histogram/251105_1359_rank3_stage7.svg
[rank3]:	> Counts Sum: 125200, Total Sum: 397760 (31.48%), Ratio(%) per element: [29.09, 27.54, 27.21, 28.53, 28.2, 28.42, 27.87, 39.71, 39.26, 42.14, 28.2]
[rank1]:2025-11-05 13:59:51,760 - INFO - Process group destroyed
[rank3]:2025-11-05 13:59:51,713 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading history steps 23-24, summary, console lines 304-319
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–‡â–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–‡â–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 2.4278
[rank3]:wandb:               final/avg_loss 0.26076
[rank3]:wandb:             final/avg_mfu(%) 15.49095
[rank3]:wandb:             final/avg_tflops 51.39788
[rank3]:wandb:    final/avg_throughput(tps) 6748.48307
[rank3]:wandb:              final/grad_norm 0.10737
[rank3]:wandb:               final/max_loss 0.26076
[rank3]:wandb:                    grad_norm 0.10737
[rank3]:wandb: loss_metrics/global_avg_loss 0.26076
[rank3]:wandb: loss_metrics/global_max_loss 0.26076
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1104_Interleaved1F1B_timelyapf_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/t82yaq27
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1104_Interleaved1F1B_timelyapf_dm1/20251105-1309/wandb/run-20251105_130912-t82yaq27/logs
[rank3]:2025-11-05 13:59:53,310 - INFO - Process group destroyed
[rank0]:2025-11-05 13:59:53,260 - INFO - Training completed
[rank0]:2025-11-05 13:59:53,260 - INFO - Destroying the purge thread.
[rank0]:2025-11-05 13:59:53,329 - INFO - Process group destroyed
[rank2]:Stage 2: Modules to keep: {'layers.6', 'layers.5'}
[rank2]:Stage 6: Modules to keep: {'layers.13', 'layers.14'}
[rank0]:Stage 0: Modules to keep: {'tok_embeddings', 'layers.0', 'layers.1'}
[rank0]:Stage 4: Modules to keep: {'layers.10', 'layers.9'}
[rank1]:Stage 1: Modules to keep: {'layers.3', 'layers.4', 'layers.2'}
[rank1]:Stage 5: Modules to keep: {'layers.11', 'layers.12'}
[rank3]:Stage 3: Modules to keep: {'layers.7', 'layers.8'}
[rank3]:Stage 7: Modules to keep: {'layers.15', 'output', 'norm'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1104_Interleaved1F1B_timelyapf_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1104_Interleaved1F1B_timelyapf_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1104_Interleaved1F1B_timelyapf_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1104_Interleaved1F1B_timelyapf_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1104_Interleaved1F1B_timelyapf_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1104_Interleaved1F1B_timelyapf_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 1e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: alpaca
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 512
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 1200
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: Interleaved1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 4
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 2
[rank3]:		- stages_list: [3, 7]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1104_Interleaved1F1B_timelyapf_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1104_Interleaved1F1B_timelyapf_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: timelyapf
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.7
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.05
[rank3]:		- percentile: 70
[rank3]:
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
