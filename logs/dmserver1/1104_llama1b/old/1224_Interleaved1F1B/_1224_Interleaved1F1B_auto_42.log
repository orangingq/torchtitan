
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 12. 24. (ìˆ˜) 21:27:38 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 2,3,4,5
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/1224_Interleaved1F1B_auto_42.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 but debugged requires_grad bug

âœ”ï¸Running with auto x Interleaved1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1224.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 but debugged requires_grad bug
" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=auto --freezing.threshold=0.01 --freezing.percentile=80 --freezing.max_freeze_ratio=0.8
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank1]:2025-12-24 21:27:44,688 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank1]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank1]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank1]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank1]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank1]:1224: everything same as 1109 but debugged requires_grad bug
[rank1]:"
[rank3]:2025-12-24 21:27:44,689 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 but debugged requires_grad bug
[rank3]:"
[rank0]:2025-12-24 21:27:44,809 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank0]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank0]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank0]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank0]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank0]:1224: everything same as 1109 but debugged requires_grad bug
[rank0]:"
[rank1]:2025-12-24 21:27:44,893 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-12-24 21:27:44,896 - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-12-24 21:27:44,901 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-12-24 21:27:44,903 - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-12-24 21:27:44,943 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank2]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank2]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank2]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank2]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank2]:1224: everything same as 1109 but debugged requires_grad bug
[rank2]:"
[rank0]:2025-12-24 21:27:44,996 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-12-24 21:27:44,999 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-24 21:27:45,003 - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-12-24 21:27:45,004 - Loading tokenizer from tokenizer.json
[rank2]:2025-12-24 21:27:45,127 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-12-24 21:27:45,130 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-24 21:27:45,403 - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank0]:2025-12-24 21:27:48,202 - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank0]:2025-12-24 21:27:48,351 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-12-24 21:27:48,391 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-24 21:27:48,393 - Model llama3 1B size: 1,498,482,688 total parameters
[rank1]:2025-12-24 21:27:48,308 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-12-24 21:27:48,350 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-24 21:27:48,378 - PP rank 1 is building stage_idx 1 with modules ['layers.2', 'layers.3', 'layers.4']
[rank1]:2025-12-24 21:27:48,390 - PP rank 1 is building stage_idx 5 with modules ['layers.11', 'layers.12']
[rank1]:2025-12-24 21:27:48,392 - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank0]:2025-12-24 21:27:48,417 - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1']
[rank0]:2025-12-24 21:27:48,429 - PP rank 0 is building stage_idx 4 with modules ['layers.9', 'layers.10']
[rank0]:2025-12-24 21:27:48,430 - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank2]:2025-12-24 21:27:48,464 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-12-24 21:27:48,504 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-24 21:27:48,534 - PP rank 2 is building stage_idx 2 with modules ['layers.5', 'layers.6']
[rank2]:2025-12-24 21:27:48,548 - PP rank 2 is building stage_idx 6 with modules ['layers.13', 'layers.14']
[rank2]:2025-12-24 21:27:48,550 - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank0]:2025-12-24 21:27:48,635 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-24 21:27:48,635 - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-12-24 21:27:48,635 - CUDA memory usage for model: 1.90GiB(3.99%)
[rank1]:2025-12-24 21:27:48,631 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-24 21:27:48,631 - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-12-24 21:27:48,632 - CUDA memory usage for model: 1.13GiB(2.39%)
[rank2]:2025-12-24 21:27:48,767 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-24 21:27:48,768 - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-12-24 21:27:48,769 - CUDA memory usage for model: 0.92GiB(1.94%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run q2b0lurf
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1224_Interleaved1F1B_auto_42_dm1/20251224-2127/wandb/run-20251224_212749-q2b0lurf
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1224_Interleaved1F1B_auto_42_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/q2b0lurf
[rank3]:2025-12-24 21:27:50,783 - WandB logging enabled
[rank3]:2025-12-24 21:27:50,783 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-12-24 21:27:50,824 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-24 21:27:50,854 - PP rank 3 is building stage_idx 3 with modules ['layers.7', 'layers.8']
[rank3]:2025-12-24 21:27:50,867 - PP rank 3 is building stage_idx 7 with modules ['layers.15', 'norm', 'output']
[rank3]:2025-12-24 21:27:50,868 - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank3]:2025-12-24 21:27:51,055 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-24 21:27:51,055 - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-12-24 21:27:51,056 - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2025-12-24 21:27:51,071 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-24 21:27:51,071 - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1224_Interleaved1F1B_auto_42_dm1
[rank0]:2025-12-24 21:27:51,072 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-24 21:27:51,072 - Trainer is initialized with local batch size 32, global batch size 128, gradient accumulation steps 4, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2025-12-24 21:27:51,072 - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank2]:2025-12-24 21:27:51,074 - Mixed precision training with TP or PP is handled by autocast
[rank1]:2025-12-24 21:27:51,073 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-24 21:27:53,596 - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-12-24 21:27:53,597 - Finished loading the checkpoint in 2.52 seconds.
[rank0]:2025-12-24 21:27:53,597 - Training starts at step 1
[rank3]:2025-12-24 21:27:59,381 -  step:  1  loss: 10.6092  grad_norm: 203.0669  memory: 25.52GiB(53.71%)  tps: 3,830  tflops: 29.94  mfu: 9.60%
[rank3]:2025-12-24 21:27:59,382 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-12-24 21:27:59,370 -  step:  1  loss: -4.0000  grad_norm: 203.0669  memory: 10.24GiB(21.56%)  tps: 3,016  tflops: 23.58  mfu: 7.56%
[rank2]:2025-12-24 21:27:59,370 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-12-24 21:27:59,373 -  step:  1  loss: -4.0000  grad_norm: 203.0669  memory: 16.23GiB(34.16%)  tps: 2,973  tflops: 23.24  mfu: 7.45%
[rank1]:2025-12-24 21:27:59,373 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-24 21:27:59,413 -  step:  1  loss: -4.0000  grad_norm: 203.0669  memory: 16.58GiB(34.89%)  tps: 2,973  tflops: 23.24  mfu: 7.45%
[rank0]:2025-12-24 21:27:59,413 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-24 21:32:05,860 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-24 21:32:10,849 - Avg. fwd time: 14.4366 / Avg. bwd time: 40.4705 / Avg. batch time: 1095.5964 (ms) / GPU bubble ratio: 19.81%
[rank2]:2025-12-24 21:32:10,900 - Avg. fwd time: 7.8526 / Avg. bwd time: 18.8340 / Avg. batch time: 1157.4813 (ms) / GPU bubble ratio: 63.11%
[rank1]:2025-12-24 21:32:10,946 - Avg. fwd time: 9.9578 / Avg. bwd time: 24.2606 / Avg. batch time: 1217.3443 (ms) / GPU bubble ratio: 55.03%
[rank0]:2025-12-24 21:32:10,978 - Avg. fwd time: 8.3286 / Avg. bwd time: 21.1192 / Avg. batch time: 1256.0952 (ms) / GPU bubble ratio: 62.49%
[rank0]:2025-12-24 21:32:11,014 -  step: 50  loss: -4.0000  grad_norm: 24.0562  memory: 20.42GiB(42.99%)  tps: 6,382  tflops: 49.89  mfu: 15.99%
[rank3]:2025-12-24 21:32:11,012 -  step: 50  loss:  9.8810  grad_norm: 24.0562  memory: 29.23GiB(61.52%)  tps: 6,381  tflops: 49.88  mfu: 15.99%
[rank2]:2025-12-24 21:32:11,000 -  step: 50  loss: -4.0000  grad_norm: 24.0562  memory: 12.06GiB(25.39%)  tps: 6,381  tflops: 49.88  mfu: 15.99%
[rank1]:2025-12-24 21:32:11,004 -  step: 50  loss: -4.0000  grad_norm: 24.0562  memory: 18.49GiB(38.93%)  tps: 6,381  tflops: 49.88  mfu: 15.99%
[rank1]:2025-12-24 21:32:57,403 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 0.0000e+00
[rank2]:2025-12-24 21:32:57,399 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 0.0000e+00
[rank0]:2025-12-24 21:32:57,415 - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 0.0000e+00
[rank3]:2025-12-24 21:32:57,410 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 0.0000e+00
[rank0]:2025-12-24 21:33:48,800 - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 5.1292e+00
[rank3]:2025-12-24 21:33:48,795 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 1.8340e+00
[rank2]:2025-12-24 21:33:48,784 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 2.0163e+00
[rank1]:2025-12-24 21:33:48,789 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 1.8372e+00
[rank3]:2025-12-24 21:34:38,670 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 3.0366e+00
[rank0]:2025-12-24 21:34:38,682 - Freezing Ratio: [Stage0] 0.47, [Stage4] 0.00, Threshold: 1.8405e+00
[rank2]:2025-12-24 21:34:38,655 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 1.2113e+00
[rank1]:2025-12-24 21:34:38,671 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 2.2500e+00
[rank0]:2025-12-24 21:35:30,003 - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 3.6826e+00
[rank2]:2025-12-24 21:35:29,991 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 8.0404e-01
[rank3]:2025-12-24 21:35:30,003 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 4.1596e+00
[rank1]:2025-12-24 21:35:29,996 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 8.5333e+00
[rank0]:2025-12-24 21:36:19,676 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-24 21:36:19,681 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 2.5782e+00
[rank0]:2025-12-24 21:36:19,708 - Freezing Ratio: [Stage0] 0.47, [Stage4] 0.00, Threshold: 3.3820e+00
[rank3]:2025-12-24 21:36:19,696 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 3.6553e+00
[rank1]:2025-12-24 21:36:19,696 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 2.5311e+00
[rank3]:2025-12-24 21:36:24,649 - Avg. fwd time: 14.5462 / Avg. bwd time: 39.3750 / Avg. batch time: 1086.7507 (ms) / GPU bubble ratio: 20.61%
[rank0]:2025-12-24 21:36:24,775 - Avg. fwd time: 8.3329 / Avg. bwd time: 20.9217 / Avg. batch time: 1249.0316 (ms) / GPU bubble ratio: 62.53%
[rank1]:2025-12-24 21:36:24,747 - Avg. fwd time: 9.9751 / Avg. bwd time: 24.4147 / Avg. batch time: 1210.7254 (ms) / GPU bubble ratio: 54.55%
[rank2]:2025-12-24 21:36:24,699 - Avg. fwd time: 7.9168 / Avg. bwd time: 17.5074 / Avg. batch time: 1148.8607 (ms) / GPU bubble ratio: 64.59%
[rank0]:2025-12-24 21:36:24,806 -  step: 100  loss: -4.0000  grad_norm: 15.8785  memory: 20.42GiB(42.99%)  tps: 6,456  tflops: 50.47  mfu: 16.18%
[rank0]:2025-12-24 21:36:24,877 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank0/251224_2136_stage0_step100.svg
[rank1]:2025-12-24 21:36:24,799 -  step: 100  loss: -4.0000  grad_norm: 15.8785  memory: 18.49GiB(38.93%)  tps: 6,456  tflops: 50.47  mfu: 16.18%
[rank1]:2025-12-24 21:36:24,878 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank1/251224_2136_stage1_step100.svg
[rank2]:2025-12-24 21:36:24,795 -  step: 100  loss: -4.0000  grad_norm: 15.8785  memory: 12.06GiB(25.39%)  tps: 6,456  tflops: 50.47  mfu: 16.18%
[rank3]:2025-12-24 21:36:24,807 -  step: 100  loss:  8.3226  grad_norm: 15.8785  memory: 29.23GiB(61.52%)  tps: 6,456  tflops: 50.47  mfu: 16.18%
[rank2]:2025-12-24 21:36:24,879 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank2/251224_2136_stage2_step100.svg
[rank0]:2025-12-24 21:36:24,913 - âœ… Frozen Ratio History of Rank 0 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank0/251224_2136_stage4_step100.svg
[rank1]:2025-12-24 21:36:24,916 - âœ… Frozen Ratio History of Rank 1 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank1/251224_2136_stage5_step100.svg
[rank2]:2025-12-24 21:36:24,918 - âœ… Frozen Ratio History of Rank 2 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank2/251224_2136_stage6_step100.svg
[rank3]:2025-12-24 21:36:25,077 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/pipeline_schedule/251224_2136_step100_rank3.svg
[rank3]:			> Batch Time: 1216.47 ms, GPU Bubble Ratio: 61.08%, 54.08%, 73.35%, 34.98%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-7-31ms      | [S4,MB0,F]  49-9-58ms      | [S4,MB1,F]  88-8-97ms      | [S4,MB2,F]  127-8-136ms    | [S4,MB3,F]  166-8-175ms    | [S0,MB4,F]  175-8-183ms    | [S0,MB5,F]  183-7-191ms    | [S0,MB6,F]  191-8-200ms    | [S4,MB0,B]  375-18-394ms   | [S0,MB7,F]  394-7-402ms    | [S4,MB1,B]  497-19-516ms   | [S4,MB4,F]  560-8-568ms    | [S4,MB2,B]  568-19-587ms   | [S4,MB5,F]  589-8-598ms    | [S4,MB3,B]  598-19-617ms   | [S4,MB6,F]  620-8-629ms    | [S0,MB0,B]  634-25-659ms   | [S4,MB7,F]  660-7-667ms    | [S0,MB1,B]  674-24-698ms   | [S0,MB2,B]  718-23-741ms   | [S0,MB3,B]  764-23-787ms   | [S4,MB4,B]  793-18-811ms   | [S4,MB5,B]  871-18-889ms   | [S4,MB6,B]  962-18-980ms   | [S4,MB7,B]  1049-18-1067ms | [S0,MB4,B]  1084-23-1107ms | [S0,MB5,B]  1118-23-1141ms | [S0,MB6,B]  1155-23-1178ms | [S0,MB7,B]  1193-23-1216ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  49-10-60ms     | [S1,MB2,F]  88-10-99ms     | [S1,MB3,F]  127-10-138ms   | [S5,MB0,F]  166-8-175ms    | [S5,MB1,F]  181-7-188ms    | [S5,MB2,F]  195-7-202ms    | [S5,MB3,F]  279-7-287ms    | [S1,MB4,F]  305-10-316ms   | [S5,MB0,B]  315-18-334ms   | [S1,MB5,F]  368-12-381ms   | [S5,MB1,B]  381-19-400ms   | [S1,MB6,F]  400-11-412ms   | [S5,MB2,B]  497-18-516ms   | [S1,MB7,F]  515-11-527ms   | [S5,MB3,B]  568-19-588ms   | [S5,MB4,F]  587-8-596ms    | [S1,MB0,B]  597-29-627ms   | [S5,MB5,F]  627-9-636ms    | [S1,MB1,B]  636-30-667ms   | [S5,MB6,F]  666-10-677ms   | [S1,MB2,B]  677-33-710ms   | [S5,MB7,F]  710-10-721ms   | [S1,MB3,B]  721-34-756ms   | [S5,MB4,B]  764-21-786ms   | [S5,MB5,B]  843-18-861ms   | [S5,MB6,B]  933-18-952ms   | [S5,MB7,B]  1024-18-1042ms | [S1,MB4,B]  1048-27-1076ms | [S1,MB5,B]  1083-28-1111ms | [S1,MB6,B]  1117-30-1147ms | [S1,MB7,B]  1154-31-1185ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-7-28ms      | [S2,MB1,F]  60-7-68ms      | [S2,MB2,F]  99-7-107ms     | [S2,MB3,F]  138-7-146ms    | [S6,MB0,F]  175-7-183ms    | [S6,MB1,F]  189-7-196ms    | [S6,MB2,F]  273-7-281ms    | [S6,MB0,B]  281-14-296ms   | [S6,MB3,F]  295-8-304ms    | [S6,MB1,B]  358-14-373ms   | [S2,MB4,F]  373-9-382ms    | [S6,MB2,B]  448-14-463ms   | [S2,MB5,F]  463-8-471ms    | [S6,MB3,B]  540-14-555ms   | [S2,MB6,F]  555-9-564ms    | [S2,MB0,B]  568-10-579ms   | [S2,MB7,F]  579-8-588ms    | [S2,MB1,B]  599-10-610ms   | [S6,MB4,F]  610-8-618ms    | [S2,MB2,B]  635-10-646ms   | [S6,MB5,F]  647-7-655ms    | [S2,MB3,B]  680-9-690ms    | [S6,MB6,F]  690-8-698ms    | [S6,MB4,B]  733-14-748ms   | [S6,MB7,F]  748-7-756ms    | [S6,MB5,B]  822-14-836ms   | [S6,MB6,B]  914-13-928ms   | [S6,MB7,B]  1004-13-1018ms | [S2,MB4,B]  1024-9-1033ms  | [S2,MB5,B]  1067-9-1076ms  | [S2,MB6,B]  1082-9-1091ms  | [S2,MB7,B]  1117-9-1126ms 
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-7-36ms      | [S3,MB1,F]  68-7-75ms      | [S3,MB2,F]  107-7-115ms    | [S3,MB3,F]  146-7-154ms    | [S7,MB0,F]  183-15-198ms   | [S7,MB0,B]  210-53-264ms   | [S7,MB1,F]  264-19-283ms   | [S7,MB1,B]  295-56-351ms   | [S7,MB2,F]  352-21-373ms   | [S7,MB2,B]  385-57-443ms   | [S7,MB3,F]  442-21-463ms   | [S7,MB3,B]  475-57-533ms   | [S3,MB4,F]  534-13-547ms   | [S3,MB0,B]  547-13-560ms   | [S3,MB5,F]  560-11-572ms   | [S3,MB1,B]  572-13-585ms   | [S3,MB6,F]  586-11-597ms   | [S3,MB2,B]  597-12-610ms   | [S3,MB7,F]  609-10-620ms   | [S3,MB3,B]  620-12-632ms   | [S7,MB4,F]  643-16-659ms   | [S7,MB4,B]  671-55-726ms   | [S7,MB5,F]  727-20-748ms   | [S7,MB5,B]  760-57-817ms   | [S7,MB6,F]  816-21-837ms   | [S7,MB6,B]  849-57-907ms   | [S7,MB7,F]  908-21-929ms   | [S7,MB7,B]  940-57-998ms   | [S3,MB4,B]  997-14-1012ms  | [S3,MB5,B]  1012-13-1026ms | [S3,MB6,B]  1025-12-1037ms | [S3,MB7,B]  1060-11-1071ms
[rank3]:2025-12-24 21:36:25,122 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank3/251224_2136_stage3_step100.svg
[rank3]:2025-12-24 21:36:25,160 - âœ… Frozen Ratio History of Rank 3 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank3/251224_2136_stage7_step100.svg
[rank0]:2025-12-24 21:37:11,229 - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 2.4660e+00
[rank1]:2025-12-24 21:37:11,222 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.00, Threshold: 2.0621e+00
[rank2]:2025-12-24 21:37:11,217 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 2.0374e+00
[rank3]:2025-12-24 21:37:11,229 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 9.9928e-01
[rank2]:2025-12-24 21:37:59,597 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 1.7437e+00
[rank1]:2025-12-24 21:37:59,601 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 1.7159e+00
[rank3]:2025-12-24 21:37:59,612 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 3.1460e+00
[rank0]:2025-12-24 21:37:59,624 - Freezing Ratio: [Stage0] 0.47, [Stage4] 0.00, Threshold: 2.3432e+00
[rank2]:2025-12-24 21:38:50,963 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 1.7238e+00
[rank1]:2025-12-24 21:38:50,969 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 1.8565e+00
[rank3]:2025-12-24 21:38:50,975 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 6.7197e+00
[rank0]:2025-12-24 21:38:50,975 - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 3.2312e+00
[rank0]:2025-12-24 21:39:38,997 - Freezing Ratio: [Stage0] 0.47, [Stage4] 0.00, Threshold: 2.3879e+00
[rank3]:2025-12-24 21:39:38,985 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 2.4181e+00
[rank2]:2025-12-24 21:39:38,970 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 3.8865e+00
[rank1]:2025-12-24 21:39:38,970 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 2.3366e+00
[rank2]:2025-12-24 21:40:30,213 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 7.5415e-01
[rank0]:2025-12-24 21:40:30,202 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-24 21:40:30,225 - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 6.8326e+00
[rank3]:2025-12-24 21:40:30,226 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 2.0645e+00
[rank1]:2025-12-24 21:40:30,219 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 6.6124e-01
[rank3]:2025-12-24 21:40:34,940 - Avg. fwd time: 14.5874 / Avg. bwd time: 38.9899 / Avg. batch time: 1082.8614 (ms) / GPU bubble ratio: 20.84%
[rank1]:2025-12-24 21:40:35,005 - Avg. fwd time: 10.0077 / Avg. bwd time: 23.1631 / Avg. batch time: 1202.3059 (ms) / GPU bubble ratio: 55.86%
[rank2]:2025-12-24 21:40:34,976 - Avg. fwd time: 7.9451 / Avg. bwd time: 17.0218 / Avg. batch time: 1143.2600 (ms) / GPU bubble ratio: 65.06%
[rank0]:2025-12-24 21:40:35,038 - Avg. fwd time: 8.3605 / Avg. bwd time: 20.6096 / Avg. batch time: 1240.8217 (ms) / GPU bubble ratio: 62.64%
[rank0]:2025-12-24 21:40:35,074 -  step: 150  loss: -4.0000  grad_norm: 21.7817  memory: 20.42GiB(42.99%)  tps: 6,547  tflops: 51.18  mfu: 16.40%
[rank3]:2025-12-24 21:40:35,065 -  step: 150  loss:  3.6798  grad_norm: 21.7817  memory: 29.23GiB(61.52%)  tps: 6,547  tflops: 51.18  mfu: 16.40%
[rank1]:2025-12-24 21:40:35,050 -  step: 150  loss: -4.0000  grad_norm: 21.7817  memory: 18.49GiB(38.93%)  tps: 6,547  tflops: 51.18  mfu: 16.40%
[rank2]:2025-12-24 21:40:35,050 -  step: 150  loss: -4.0000  grad_norm: 21.7817  memory: 12.06GiB(25.39%)  tps: 6,547  tflops: 51.18  mfu: 16.40%
[rank0]:2025-12-24 21:41:18,552 - Freezing Ratio: [Stage0] 0.47, [Stage4] 0.00, Threshold: 5.1539e+00
[rank1]:2025-12-24 21:41:18,523 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 6.0619e+00
[rank3]:2025-12-24 21:41:18,538 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 4.9665e+00
[rank2]:2025-12-24 21:41:18,523 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 3.9454e+00
[rank2]:2025-12-24 21:42:09,939 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 1.0762e+00
[rank0]:2025-12-24 21:42:09,951 - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 5.2118e+00
[rank1]:2025-12-24 21:42:09,944 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 3.9316e-01
[rank3]:2025-12-24 21:42:09,951 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 7.6414e-01
[rank2]:2025-12-24 21:42:58,098 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 4.7654e+00
[rank3]:2025-12-24 21:42:58,113 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 5.4808e+00
[rank0]:2025-12-24 21:42:58,126 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 4.7090e+00
[rank1]:2025-12-24 21:42:58,098 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 4.6973e+00
[rank2]:2025-12-24 21:43:48,977 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 9.9510e+00
[rank0]:2025-12-24 21:43:48,981 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 2.4168e+01
[rank1]:2025-12-24 21:43:48,982 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 4.5573e+00
[rank3]:2025-12-24 21:43:48,989 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 1.4745e+01
[rank1]:2025-12-24 21:44:35,992 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 2.9844e+00
[rank0]:2025-12-24 21:44:35,988 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-24 21:44:36,008 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 2.1043e+00
[rank3]:2025-12-24 21:44:36,008 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 3.8670e+00
[rank2]:2025-12-24 21:44:35,992 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 3.3597e+00
[rank3]:2025-12-24 21:44:41,031 - Avg. fwd time: 14.6460 / Avg. bwd time: 38.5819 / Avg. batch time: 1078.6042 (ms) / GPU bubble ratio: 21.04%
[rank1]:2025-12-24 21:44:41,120 - Avg. fwd time: 10.0517 / Avg. bwd time: 22.0300 / Avg. batch time: 1193.8086 (ms) / GPU bubble ratio: 57.00%
[rank2]:2025-12-24 21:44:41,078 - Avg. fwd time: 7.9780 / Avg. bwd time: 16.5144 / Avg. batch time: 1137.1454 (ms) / GPU bubble ratio: 65.54%
[rank1]:2025-12-24 21:44:41,167 -  step: 200  loss: -4.0000  grad_norm: 20.8294  memory: 18.49GiB(38.93%)  tps: 6,657  tflops: 52.04  mfu: 16.68%
[rank1]:2025-12-24 21:44:41,226 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank1/251224_2144_stage1_step200.svg
[rank0]:2025-12-24 21:44:41,144 - Avg. fwd time: 8.4163 / Avg. bwd time: 19.9596 / Avg. batch time: 1231.8684 (ms) / GPU bubble ratio: 63.14%
[rank0]:2025-12-24 21:44:41,168 -  step: 200  loss: -4.0000  grad_norm: 20.8294  memory: 20.42GiB(42.99%)  tps: 6,658  tflops: 52.05  mfu: 16.68%
[rank0]:2025-12-24 21:44:41,225 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank0/251224_2144_stage0_step200.svg
[rank3]:2025-12-24 21:44:41,175 -  step: 200  loss:  1.1443  grad_norm: 20.8294  memory: 29.23GiB(61.52%)  tps: 6,657  tflops: 52.04  mfu: 16.68%
[rank2]:2025-12-24 21:44:41,163 -  step: 200  loss: -4.0000  grad_norm: 20.8294  memory: 12.06GiB(25.39%)  tps: 6,657  tflops: 52.04  mfu: 16.68%
[rank2]:2025-12-24 21:44:41,227 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank2/251224_2144_stage2_step200.svg
[rank1]:2025-12-24 21:44:41,268 - âœ… Frozen Ratio History of Rank 1 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank1/251224_2144_stage5_step200.svg
[rank0]:2025-12-24 21:44:41,267 - âœ… Frozen Ratio History of Rank 0 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank0/251224_2144_stage4_step200.svg
[rank2]:2025-12-24 21:44:41,270 - âœ… Frozen Ratio History of Rank 2 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank2/251224_2144_stage6_step200.svg
[rank3]:2025-12-24 21:44:41,418 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/pipeline_schedule/251224_2144_step200_rank3.svg
[rank3]:			> Batch Time: 1156.45 ms, GPU Bubble Ratio: 67.72%, 65.38%, 71.68%, 30.76%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-9-17ms       | [S0,MB2,F]  17-8-26ms      | [S0,MB3,F]  26-8-34ms      | [S4,MB0,F]  49-9-59ms      | [S4,MB1,F]  90-8-99ms      | [S4,MB2,F]  130-8-139ms    | [S4,MB3,F]  171-9-180ms    | [S0,MB4,F]  180-9-189ms    | [S0,MB5,F]  189-8-198ms    | [S0,MB6,F]  198-9-207ms    | [S4,MB0,B]  379-14-394ms   | [S0,MB7,F]  394-8-402ms    | [S4,MB1,B]  502-14-517ms   | [S4,MB4,F]  565-8-573ms    | [S4,MB2,B]  574-14-588ms   | [S4,MB5,F]  594-9-603ms    | [S4,MB3,B]  603-14-618ms   | [S4,MB6,F]  624-9-633ms    | [S0,MB0,B]  633-15-648ms   | [S4,MB7,F]  652-8-660ms    | [S0,MB1,B]  660-15-676ms   | [S0,MB2,B]  680-14-695ms   | [S0,MB3,B]  749-14-763ms   | [S4,MB4,B]  777-13-791ms   | [S4,MB5,B]  875-13-889ms   | [S4,MB6,B]  967-13-980ms   | [S4,MB7,B]  1051-13-1064ms | [S0,MB4,B]  1071-14-1085ms | [S0,MB5,B]  1101-14-1115ms | [S0,MB6,B]  1122-14-1136ms | [S0,MB7,B]  1142-14-1156ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  49-12-61ms     | [S1,MB2,F]  90-12-102ms    | [S1,MB3,F]  130-12-143ms   | [S5,MB0,F]  171-8-179ms    | [S5,MB1,F]  186-7-193ms    | [S5,MB2,F]  200-7-207ms    | [S5,MB3,F]  283-7-291ms    | [S1,MB4,F]  309-12-321ms   | [S5,MB0,B]  321-14-336ms   | [S1,MB5,F]  372-14-386ms   | [S5,MB1,B]  386-14-400ms   | [S1,MB6,F]  401-12-414ms   | [S5,MB2,B]  501-14-516ms   | [S1,MB7,F]  517-12-529ms   | [S5,MB3,B]  572-15-588ms   | [S5,MB4,F]  588-8-596ms    | [S1,MB0,B]  601-15-617ms   | [S5,MB5,F]  618-8-627ms    | [S1,MB1,B]  631-15-647ms   | [S5,MB6,F]  647-9-657ms    | [S1,MB2,B]  657-15-673ms   | [S5,MB7,F]  673-9-683ms    | [S1,MB3,B]  682-15-698ms   | [S5,MB4,B]  756-13-770ms   | [S5,MB5,B]  846-13-860ms   | [S5,MB6,B]  937-13-951ms   | [S5,MB7,B]  1030-13-1044ms | [S1,MB4,B]  1050-14-1064ms | [S1,MB5,B]  1080-14-1094ms | [S1,MB6,B]  1100-14-1114ms | [S1,MB7,B]  1121-14-1135ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-7-28ms      | [S2,MB1,F]  61-7-69ms      | [S2,MB2,F]  102-7-110ms    | [S2,MB3,F]  143-7-150ms    | [S6,MB0,F]  179-7-187ms    | [S6,MB1,F]  193-7-201ms    | [S6,MB2,F]  277-7-285ms    | [S6,MB0,B]  285-14-299ms   | [S6,MB3,F]  300-8-309ms    | [S6,MB1,B]  362-15-377ms   | [S2,MB4,F]  378-9-387ms    | [S6,MB2,B]  453-14-468ms   | [S2,MB5,F]  469-8-477ms    | [S6,MB3,B]  545-14-560ms   | [S2,MB6,F]  561-9-570ms    | [S2,MB0,B]  574-10-584ms   | [S2,MB7,F]  586-8-595ms    | [S2,MB1,B]  603-10-614ms   | [S6,MB4,F]  614-8-622ms    | [S2,MB2,B]  632-10-642ms   | [S6,MB5,F]  643-8-651ms    | [S2,MB3,B]  656-10-667ms   | [S6,MB6,F]  667-8-675ms    | [S6,MB4,B]  735-15-750ms   | [S6,MB7,F]  750-8-759ms    | [S6,MB5,B]  826-14-840ms   | [S6,MB6,B]  917-13-931ms   | [S6,MB7,B]  1010-13-1024ms | [S2,MB4,B]  1030-9-1039ms  | [S2,MB5,B]  1064-9-1073ms  | [S2,MB6,B]  1080-9-1089ms  | [S2,MB7,B]  1100-9-1109ms 
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-7-36ms      | [S3,MB1,F]  69-7-77ms      | [S3,MB2,F]  110-7-118ms    | [S3,MB3,F]  151-7-158ms    | [S7,MB0,F]  187-15-203ms   | [S7,MB0,B]  215-53-269ms   | [S7,MB1,F]  268-19-287ms   | [S7,MB1,B]  299-56-356ms   | [S7,MB2,F]  355-21-377ms   | [S7,MB2,B]  389-58-447ms   | [S7,MB3,F]  446-21-468ms   | [S7,MB3,B]  480-58-538ms   | [S3,MB4,F]  538-13-551ms   | [S3,MB0,B]  551-13-565ms   | [S3,MB5,F]  566-11-578ms   | [S3,MB1,B]  578-13-591ms   | [S3,MB6,F]  593-11-605ms   | [S3,MB2,B]  605-13-618ms   | [S3,MB7,F]  618-11-629ms   | [S3,MB3,B]  629-12-642ms   | [S7,MB4,F]  642-18-660ms   | [S7,MB4,B]  672-56-728ms   | [S7,MB5,F]  728-21-750ms   | [S7,MB5,B]  762-57-819ms   | [S7,MB6,F]  820-21-841ms   | [S7,MB6,B]  853-58-911ms   | [S7,MB7,F]  911-21-932ms   | [S7,MB7,B]  944-58-1002ms  | [S3,MB4,B]  1003-14-1018ms | [S3,MB5,B]  1018-13-1031ms | [S3,MB6,B]  1031-12-1043ms | [S3,MB7,B]  1057-12-1069ms
[rank3]:2025-12-24 21:44:41,462 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank3/251224_2144_stage3_step200.svg
[rank3]:2025-12-24 21:44:41,504 - âœ… Frozen Ratio History of Rank 3 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank3/251224_2144_stage7_step200.svg
[rank1]:2025-12-24 21:45:27,158 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 2.5357e-01
[rank0]:2025-12-24 21:45:27,157 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 1.5794e+00
[rank3]:2025-12-24 21:45:27,165 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 1.0476e+00
[rank2]:2025-12-24 21:45:27,153 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 2.8703e-01
[rank0]:2025-12-24 21:46:14,042 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 1.1106e+00
[rank1]:2025-12-24 21:46:14,027 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 1.4542e+00
[rank3]:2025-12-24 21:46:14,042 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 1.1946e+00
[rank2]:2025-12-24 21:46:14,027 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 1.0435e+00
[rank2]:2025-12-24 21:47:04,723 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 9.1361e-01
[rank1]:2025-12-24 21:47:04,730 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 3.3569e-01
[rank0]:2025-12-24 21:47:04,728 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 2.1900e+00
[rank3]:2025-12-24 21:47:04,735 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 1.1480e+00
[rank1]:2025-12-24 21:47:51,574 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 4.3108e+00
[rank3]:2025-12-24 21:47:51,589 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 4.8319e+00
[rank2]:2025-12-24 21:47:51,574 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 4.4477e+00
[rank0]:2025-12-24 21:47:51,589 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 4.9585e+00
[rank0]:2025-12-24 21:48:42,342 - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-12-24 21:48:42,353 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 1.0715e+00
[rank1]:2025-12-24 21:48:42,359 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 4.2051e-01
[rank0]:2025-12-24 21:48:42,357 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 1.2389e+00
[rank3]:2025-12-24 21:48:42,365 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 1.1032e+00
[rank3]:2025-12-24 21:48:46,912 - Avg. fwd time: 14.6381 / Avg. bwd time: 38.4906 / Avg. batch time: 1076.8326 (ms) / GPU bubble ratio: 21.06%
[rank2]:2025-12-24 21:48:46,948 - Avg. fwd time: 7.9860 / Avg. bwd time: 16.4410 / Avg. batch time: 1134.7421 (ms) / GPU bubble ratio: 65.56%
[rank1]:2025-12-24 21:48:46,972 - Avg. fwd time: 10.0776 / Avg. bwd time: 21.6847 / Avg. batch time: 1190.1807 (ms) / GPU bubble ratio: 57.30%
[rank1]:2025-12-24 21:48:47,006 -  step: 250  loss: -4.0000  grad_norm:  4.6294  memory: 18.49GiB(38.93%)  tps: 6,665  tflops: 52.10  mfu: 16.70%
[rank0]:2025-12-24 21:48:46,997 - Avg. fwd time: 8.5007 / Avg. bwd time: 18.8502 / Avg. batch time: 1226.6036 (ms) / GPU bubble ratio: 64.32%
[rank0]:2025-12-24 21:48:47,020 -  step: 250  loss: -4.0000  grad_norm:  4.6294  memory: 20.42GiB(42.99%)  tps: 6,664  tflops: 52.10  mfu: 16.70%
[rank3]:2025-12-24 21:48:47,021 -  step: 250  loss:  0.3886  grad_norm:  4.6294  memory: 29.23GiB(61.52%)  tps: 6,664  tflops: 52.10  mfu: 16.70%
[rank2]:2025-12-24 21:48:47,006 -  step: 250  loss: -4.0000  grad_norm:  4.6294  memory: 12.06GiB(25.39%)  tps: 6,664  tflops: 52.10  mfu: 16.70%
[rank1]:2025-12-24 21:49:29,141 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 4.7307e+00
[rank0]:2025-12-24 21:49:29,156 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 5.1652e+00
[rank3]:2025-12-24 21:49:29,156 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 4.7248e+00
[rank2]:2025-12-24 21:49:29,140 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 4.1736e+00
[rank1]:2025-12-24 21:50:19,948 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 1.0867e+00
[rank0]:2025-12-24 21:50:19,946 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 5.9863e+00
[rank3]:2025-12-24 21:50:19,954 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 2.9705e+00
[rank2]:2025-12-24 21:50:19,943 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 1.8154e+00
[rank1]:2025-12-24 21:51:06,890 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 9.9241e-01
[rank0]:2025-12-24 21:51:06,905 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 1.3071e+00
[rank3]:2025-12-24 21:51:06,905 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 1.4747e+00
[rank2]:2025-12-24 21:51:06,889 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 1.4455e+00
[rank0]:2025-12-24 21:51:57,816 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 4.2341e+00
[rank2]:2025-12-24 21:51:57,812 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 1.9480e+00
[rank1]:2025-12-24 21:51:57,818 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 8.9128e-01
[rank3]:2025-12-24 21:51:57,824 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 2.5845e+00
[rank1]:2025-12-24 21:52:44,631 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 4.4492e-01
[rank0]:2025-12-24 21:52:44,627 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-24 21:52:44,646 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 4.9979e-01
[rank3]:2025-12-24 21:52:44,646 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 5.8666e-01
[rank2]:2025-12-24 21:52:44,631 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 3.5415e-01
[rank3]:2025-12-24 21:52:49,578 - Avg. fwd time: 14.6601 / Avg. bwd time: 38.2818 / Avg. batch time: 1074.2638 (ms) / GPU bubble ratio: 21.15%
[rank1]:2025-12-24 21:52:49,667 - Avg. fwd time: 10.1079 / Avg. bwd time: 21.1868 / Avg. batch time: 1185.2867 (ms) / GPU bubble ratio: 57.76%
[rank2]:2025-12-24 21:52:49,626 - Avg. fwd time: 8.0041 / Avg. bwd time: 16.2111 / Avg. batch time: 1131.2679 (ms) / GPU bubble ratio: 65.75%
[rank2]:2025-12-24 21:52:49,711 -  step: 300  loss: -4.0000  grad_norm:  0.6286  memory: 12.06GiB(25.39%)  tps: 6,751  tflops: 52.77  mfu: 16.91%
[rank1]:2025-12-24 21:52:49,714 -  step: 300  loss: -4.0000  grad_norm:  0.6286  memory: 18.49GiB(38.93%)  tps: 6,751  tflops: 52.77  mfu: 16.91%
[rank1]:2025-12-24 21:52:49,775 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank1/251224_2152_stage1_step300.svg
[rank0]:2025-12-24 21:52:49,692 - Avg. fwd time: 8.5560 / Avg. bwd time: 18.1130 / Avg. batch time: 1220.6101 (ms) / GPU bubble ratio: 65.04%
[rank0]:2025-12-24 21:52:49,715 -  step: 300  loss: -4.0000  grad_norm:  0.6286  memory: 20.42GiB(42.99%)  tps: 6,751  tflops: 52.78  mfu: 16.92%
[rank0]:2025-12-24 21:52:49,771 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank0/251224_2152_stage0_step300.svg
[rank3]:2025-12-24 21:52:49,723 -  step: 300  loss:  0.2785  grad_norm:  0.6286  memory: 29.23GiB(61.52%)  tps: 6,751  tflops: 52.77  mfu: 16.91%
[rank2]:2025-12-24 21:52:49,774 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank2/251224_2152_stage2_step300.svg
[rank1]:2025-12-24 21:52:49,816 - âœ… Frozen Ratio History of Rank 1 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank1/251224_2152_stage5_step300.svg
[rank0]:2025-12-24 21:52:49,812 - âœ… Frozen Ratio History of Rank 0 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank0/251224_2152_stage4_step300.svg
[rank2]:2025-12-24 21:52:49,814 - âœ… Frozen Ratio History of Rank 2 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank2/251224_2152_stage6_step300.svg
[rank3]:2025-12-24 21:52:49,989 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/pipeline_schedule/251224_2152_step300_rank3.svg
[rank3]:			> Batch Time: 1151.45 ms, GPU Bubble Ratio: 67.59%, 65.24%, 71.55%, 30.83%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-9-17ms       | [S0,MB2,F]  17-8-26ms      | [S0,MB3,F]  26-8-34ms      | [S4,MB0,F]  49-9-58ms      | [S4,MB1,F]  89-8-98ms      | [S4,MB2,F]  130-8-139ms    | [S4,MB3,F]  170-8-179ms    | [S0,MB4,F]  179-9-189ms    | [S0,MB5,F]  189-8-197ms    | [S0,MB6,F]  197-9-206ms    | [S4,MB0,B]  379-14-393ms   | [S0,MB7,F]  393-8-401ms    | [S4,MB1,B]  501-14-515ms   | [S4,MB4,F]  563-8-572ms    | [S4,MB2,B]  572-14-587ms   | [S4,MB5,F]  593-8-601ms    | [S4,MB3,B]  602-14-616ms   | [S4,MB6,F]  622-9-631ms    | [S0,MB0,B]  631-15-647ms   | [S4,MB7,F]  651-7-659ms    | [S0,MB1,B]  659-15-675ms   | [S0,MB2,B]  679-14-693ms   | [S0,MB3,B]  745-14-760ms   | [S4,MB4,B]  774-13-787ms   | [S4,MB5,B]  870-13-884ms   | [S4,MB6,B]  961-13-975ms   | [S4,MB7,B]  1046-13-1059ms | [S0,MB4,B]  1066-14-1080ms | [S0,MB5,B]  1096-14-1110ms | [S0,MB6,B]  1116-14-1130ms | [S0,MB7,B]  1137-14-1151ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  49-12-61ms     | [S1,MB2,F]  89-12-102ms    | [S1,MB3,F]  130-12-142ms   | [S5,MB0,F]  170-8-178ms    | [S5,MB1,F]  185-7-193ms    | [S5,MB2,F]  199-7-207ms    | [S5,MB3,F]  282-7-290ms    | [S1,MB4,F]  308-12-321ms   | [S5,MB0,B]  320-14-334ms   | [S1,MB5,F]  371-13-385ms   | [S5,MB1,B]  385-14-400ms   | [S1,MB6,F]  401-12-413ms   | [S5,MB2,B]  500-14-514ms   | [S1,MB7,F]  516-12-528ms   | [S5,MB3,B]  570-15-586ms   | [S5,MB4,F]  586-8-594ms    | [S1,MB0,B]  600-15-616ms   | [S5,MB5,F]  618-8-627ms    | [S1,MB1,B]  630-15-646ms   | [S5,MB6,F]  646-9-655ms    | [S1,MB2,B]  655-16-671ms   | [S5,MB7,F]  671-9-681ms    | [S1,MB3,B]  681-15-696ms   | [S5,MB4,B]  753-13-767ms   | [S5,MB5,B]  842-13-856ms   | [S5,MB6,B]  932-13-946ms   | [S5,MB7,B]  1024-13-1038ms | [S1,MB4,B]  1045-14-1059ms | [S1,MB5,B]  1075-14-1089ms | [S1,MB6,B]  1095-14-1109ms | [S1,MB7,B]  1115-14-1129ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-7-28ms      | [S2,MB1,F]  61-7-69ms      | [S2,MB2,F]  102-7-109ms    | [S2,MB3,F]  142-7-150ms    | [S6,MB0,F]  178-7-186ms    | [S6,MB1,F]  193-7-200ms    | [S6,MB2,F]  277-7-284ms    | [S6,MB0,B]  284-14-299ms   | [S6,MB3,F]  299-8-308ms    | [S6,MB1,B]  361-15-376ms   | [S2,MB4,F]  377-9-386ms    | [S6,MB2,B]  451-15-466ms   | [S2,MB5,F]  468-8-476ms    | [S6,MB3,B]  543-14-558ms   | [S2,MB6,F]  559-9-568ms    | [S2,MB0,B]  572-10-583ms   | [S2,MB7,F]  584-8-593ms    | [S2,MB1,B]  602-10-612ms   | [S6,MB4,F]  613-8-621ms    | [S2,MB2,B]  630-10-641ms   | [S6,MB5,F]  641-8-650ms    | [S2,MB3,B]  655-10-665ms   | [S6,MB6,F]  665-8-674ms    | [S6,MB4,B]  732-15-747ms   | [S6,MB7,F]  747-8-755ms    | [S6,MB5,B]  821-14-835ms   | [S6,MB6,B]  912-13-926ms   | [S6,MB7,B]  1005-13-1018ms | [S2,MB4,B]  1025-9-1034ms  | [S2,MB5,B]  1059-9-1068ms  | [S2,MB6,B]  1074-9-1083ms  | [S2,MB7,B]  1095-9-1104ms 
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-7-36ms      | [S3,MB1,F]  69-7-77ms      | [S3,MB2,F]  110-7-117ms    | [S3,MB3,F]  150-7-158ms    | [S7,MB0,F]  186-15-202ms   | [S7,MB0,B]  214-53-268ms   | [S7,MB1,F]  267-19-286ms   | [S7,MB1,B]  298-55-354ms   | [S7,MB2,F]  355-21-376ms   | [S7,MB2,B]  388-57-446ms   | [S7,MB3,F]  445-21-467ms   | [S7,MB3,B]  478-57-536ms   | [S3,MB4,F]  536-13-549ms   | [S3,MB0,B]  549-13-562ms   | [S3,MB5,F]  564-11-576ms   | [S3,MB1,B]  576-13-589ms   | [S3,MB6,F]  591-11-602ms   | [S3,MB2,B]  602-13-615ms   | [S3,MB7,F]  616-11-627ms   | [S3,MB3,B]  627-12-640ms   | [S7,MB4,F]  639-18-657ms   | [S7,MB4,B]  669-55-725ms   | [S7,MB5,F]  725-21-746ms   | [S7,MB5,B]  758-57-815ms   | [S7,MB6,F]  815-21-836ms   | [S7,MB6,B]  848-57-905ms   | [S7,MB7,F]  906-21-927ms   | [S7,MB7,B]  939-57-997ms   | [S3,MB4,B]  998-14-1013ms  | [S3,MB5,B]  1012-13-1025ms | [S3,MB6,B]  1025-12-1037ms | [S3,MB7,B]  1052-12-1064ms
[rank3]:2025-12-24 21:52:50,034 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank3/251224_2152_stage3_step300.svg
[rank3]:2025-12-24 21:52:50,077 - âœ… Frozen Ratio History of Rank 3 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank3/251224_2152_stage7_step300.svg
[rank1]:2025-12-24 21:53:35,823 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 3.9216e-01
[rank0]:2025-12-24 21:53:35,822 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 1.5454e+00
[rank3]:2025-12-24 21:53:35,829 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 5.6347e-01
[rank2]:2025-12-24 21:53:35,817 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 5.2658e-01
[rank0]:2025-12-24 21:54:22,784 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 2.1448e+00
[rank1]:2025-12-24 21:54:22,769 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 2.1177e+00
[rank3]:2025-12-24 21:54:22,784 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 1.9458e+00
[rank2]:2025-12-24 21:54:22,769 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 1.9211e+00
[rank2]:2025-12-24 21:55:13,792 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 6.7732e-01
[rank0]:2025-12-24 21:55:13,796 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 2.2819e+00
[rank1]:2025-12-24 21:55:13,798 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 4.1042e-01
[rank3]:2025-12-24 21:55:13,803 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 1.5089e+00
[rank1]:2025-12-24 21:56:00,728 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 5.0414e-01
[rank2]:2025-12-24 21:56:00,728 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 5.9290e-01
[rank0]:2025-12-24 21:56:00,743 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 8.1363e-01
[rank3]:2025-12-24 21:56:00,743 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 2.3798e-01
[rank0]:2025-12-24 21:56:51,544 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-24 21:56:51,559 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 1.6981e-01
[rank1]:2025-12-24 21:56:51,560 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 1.1272e-01
[rank3]:2025-12-24 21:56:51,568 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 2.2981e-01
[rank2]:2025-12-24 21:56:51,555 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 1.2345e-01
[rank3]:2025-12-24 21:56:56,174 - Avg. fwd time: 14.6755 / Avg. bwd time: 38.2687 / Avg. batch time: 1074.1081 (ms) / GPU bubble ratio: 21.13%
[rank2]:2025-12-24 21:56:56,210 - Avg. fwd time: 8.0077 / Avg. bwd time: 16.2028 / Avg. batch time: 1130.8933 (ms) / GPU bubble ratio: 65.75%
[rank0]:2025-12-24 21:56:56,262 - Avg. fwd time: 8.5971 / Avg. bwd time: 17.5853 / Avg. batch time: 1218.9866 (ms) / GPU bubble ratio: 65.63%
[rank0]:2025-12-24 21:56:56,285 -  step: 350  loss: -4.0000  grad_norm:  0.2139  memory: 20.42GiB(42.99%)  tps: 6,645  tflops: 51.95  mfu: 16.65%
[rank1]:2025-12-24 21:56:56,236 - Avg. fwd time: 10.1167 / Avg. bwd time: 21.0576 / Avg. batch time: 1184.4442 (ms) / GPU bubble ratio: 57.89%
[rank1]:2025-12-24 21:56:56,271 -  step: 350  loss: -4.0000  grad_norm:  0.2139  memory: 18.49GiB(38.93%)  tps: 6,645  tflops: 51.95  mfu: 16.65%
[rank3]:2025-12-24 21:56:56,287 -  step: 350  loss:  0.2305  grad_norm:  0.2139  memory: 29.23GiB(61.52%)  tps: 6,645  tflops: 51.95  mfu: 16.65%
[rank2]:2025-12-24 21:56:56,271 -  step: 350  loss: -4.0000  grad_norm:  0.2139  memory: 12.06GiB(25.39%)  tps: 6,645  tflops: 51.95  mfu: 16.65%
[rank0]:2025-12-24 21:57:38,530 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 2.0599e-01
[rank1]:2025-12-24 21:57:38,515 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 3.4741e-01
[rank3]:2025-12-24 21:57:38,530 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 5.8277e-01
[rank2]:2025-12-24 21:57:38,515 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 6.1762e-01
[rank1]:2025-12-24 21:58:29,513 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 3.9712e-01
[rank3]:2025-12-24 21:58:29,520 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 8.3256e-01
[rank2]:2025-12-24 21:58:29,508 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 6.3586e-01
[rank0]:2025-12-24 21:58:29,512 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 2.2649e+00
[rank2]:2025-12-24 21:59:16,403 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 3.2882e+00
[rank0]:2025-12-24 21:59:16,419 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 2.6321e+00
[rank1]:2025-12-24 21:59:16,403 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 2.0784e+00
[rank3]:2025-12-24 21:59:16,418 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 2.7931e+00
[rank0]:2025-12-24 22:00:07,212 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 2.1359e-01
[rank1]:2025-12-24 22:00:07,214 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 7.0425e-02
[rank3]:2025-12-24 22:00:07,220 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 5.0040e-01
[rank2]:2025-12-24 22:00:07,208 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 3.7871e-01
[rank0]:2025-12-24 22:00:54,144 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-24 22:00:54,163 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 5.1024e-01
[rank1]:2025-12-24 22:00:54,148 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 6.1638e-01
[rank2]:2025-12-24 22:00:54,147 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 6.9561e-01
[rank3]:2025-12-24 22:00:54,163 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 2.9607e-01
[rank2]:2025-12-24 22:00:59,232 - Avg. fwd time: 8.0206 / Avg. bwd time: 16.0591 / Avg. batch time: 1128.9312 (ms) / GPU bubble ratio: 65.87%
[rank3]:2025-12-24 22:00:59,183 - Avg. fwd time: 14.6929 / Avg. bwd time: 38.1449 / Avg. batch time: 1072.6934 (ms) / GPU bubble ratio: 21.19%
[rank0]:2025-12-24 22:00:59,299 - Avg. fwd time: 8.6278 / Avg. bwd time: 17.1899 / Avg. batch time: 1215.6262 (ms) / GPU bubble ratio: 66.02%
[rank1]:2025-12-24 22:00:59,273 - Avg. fwd time: 10.1365 / Avg. bwd time: 20.7618 / Avg. batch time: 1181.6663 (ms) / GPU bubble ratio: 58.16%
[rank2]:2025-12-24 22:00:59,318 -  step: 400  loss: -4.0000  grad_norm:  0.9154  memory: 12.06GiB(25.39%)  tps: 6,741  tflops: 52.70  mfu: 16.89%
[rank3]:2025-12-24 22:00:59,330 -  step: 400  loss:  0.2194  grad_norm:  0.9154  memory: 29.23GiB(61.52%)  tps: 6,741  tflops: 52.70  mfu: 16.89%
[rank0]:2025-12-24 22:00:59,323 -  step: 400  loss: -4.0000  grad_norm:  0.9154  memory: 20.42GiB(42.99%)  tps: 6,741  tflops: 52.70  mfu: 16.89%
[rank0]:2025-12-24 22:00:59,384 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank0/251224_2200_stage0_step400.svg
[rank1]:2025-12-24 22:00:59,322 -  step: 400  loss: -4.0000  grad_norm:  0.9154  memory: 18.49GiB(38.93%)  tps: 6,741  tflops: 52.70  mfu: 16.89%
[rank1]:2025-12-24 22:00:59,384 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank1/251224_2200_stage1_step400.svg
[rank2]:2025-12-24 22:00:59,385 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank2/251224_2200_stage2_step400.svg
[rank2]:2025-12-24 22:00:59,430 - âœ… Frozen Ratio History of Rank 2 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank2/251224_2200_stage6_step400.svg
[rank0]:2025-12-24 22:00:59,428 - âœ… Frozen Ratio History of Rank 0 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank0/251224_2200_stage4_step400.svg
[rank1]:2025-12-24 22:00:59,429 - âœ… Frozen Ratio History of Rank 1 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank1/251224_2200_stage5_step400.svg
[rank3]:2025-12-24 22:00:59,582 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/pipeline_schedule/251224_2200_step400_rank3.svg
[rank3]:			> Batch Time: 1154.45 ms, GPU Bubble Ratio: 67.64%, 65.28%, 71.58%, 30.79%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-9-17ms       | [S0,MB2,F]  17-8-26ms      | [S0,MB3,F]  26-8-34ms      | [S4,MB0,F]  49-9-59ms      | [S4,MB1,F]  90-8-99ms      | [S4,MB2,F]  131-8-139ms    | [S4,MB3,F]  171-9-180ms    | [S0,MB4,F]  180-9-189ms    | [S0,MB5,F]  190-8-198ms    | [S0,MB6,F]  198-9-207ms    | [S4,MB0,B]  379-14-393ms   | [S0,MB7,F]  393-8-402ms    | [S4,MB1,B]  501-14-516ms   | [S4,MB4,F]  564-8-572ms    | [S4,MB2,B]  573-14-587ms   | [S4,MB5,F]  593-9-602ms    | [S4,MB3,B]  602-14-616ms   | [S4,MB6,F]  624-9-633ms    | [S0,MB0,B]  633-15-649ms   | [S4,MB7,F]  653-8-661ms    | [S0,MB1,B]  661-15-677ms   | [S0,MB2,B]  681-14-695ms   | [S0,MB3,B]  748-14-763ms   | [S4,MB4,B]  776-13-790ms   | [S4,MB5,B]  874-13-888ms   | [S4,MB6,B]  965-13-979ms   | [S4,MB7,B]  1048-13-1061ms | [S0,MB4,B]  1069-14-1083ms | [S0,MB5,B]  1099-14-1113ms | [S0,MB6,B]  1119-14-1133ms | [S0,MB7,B]  1140-14-1154ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  49-12-61ms     | [S1,MB2,F]  90-12-102ms    | [S1,MB3,F]  131-12-143ms   | [S5,MB0,F]  171-8-179ms    | [S5,MB1,F]  186-7-193ms    | [S5,MB2,F]  200-7-207ms    | [S5,MB3,F]  283-7-291ms    | [S1,MB4,F]  309-12-321ms   | [S5,MB0,B]  321-14-335ms   | [S1,MB5,F]  371-14-386ms   | [S5,MB1,B]  385-14-400ms   | [S1,MB6,F]  400-12-413ms   | [S5,MB2,B]  500-14-515ms   | [S1,MB7,F]  516-12-528ms   | [S5,MB3,B]  571-15-587ms   | [S5,MB4,F]  587-8-595ms    | [S1,MB0,B]  601-15-616ms   | [S5,MB5,F]  619-8-628ms    | [S1,MB1,B]  632-15-648ms   | [S5,MB6,F]  648-9-657ms    | [S1,MB2,B]  657-15-673ms   | [S5,MB7,F]  673-9-683ms    | [S1,MB3,B]  683-15-699ms   | [S5,MB4,B]  755-13-769ms   | [S5,MB5,B]  846-13-860ms   | [S5,MB6,B]  936-13-950ms   | [S5,MB7,B]  1027-13-1041ms | [S1,MB4,B]  1047-14-1061ms | [S1,MB5,B]  1077-14-1091ms | [S1,MB6,B]  1098-14-1112ms | [S1,MB7,B]  1118-14-1132ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-7-28ms      | [S2,MB1,F]  61-7-69ms      | [S2,MB2,F]  102-7-110ms    | [S2,MB3,F]  143-7-151ms    | [S6,MB0,F]  179-7-187ms    | [S6,MB1,F]  194-7-201ms    | [S6,MB2,F]  277-7-285ms    | [S6,MB0,B]  285-14-299ms   | [S6,MB3,F]  299-8-308ms    | [S6,MB1,B]  361-15-376ms   | [S2,MB4,F]  377-9-386ms    | [S6,MB2,B]  452-14-467ms   | [S2,MB5,F]  468-8-476ms    | [S6,MB3,B]  544-14-559ms   | [S2,MB6,F]  559-9-569ms    | [S2,MB0,B]  573-10-583ms   | [S2,MB7,F]  586-8-595ms    | [S2,MB1,B]  604-10-614ms   | [S6,MB4,F]  615-8-623ms    | [S2,MB2,B]  633-10-644ms   | [S6,MB5,F]  644-8-652ms    | [S2,MB3,B]  657-10-668ms   | [S6,MB6,F]  668-8-676ms    | [S6,MB4,B]  734-15-749ms   | [S6,MB7,F]  749-8-758ms    | [S6,MB5,B]  826-14-840ms   | [S6,MB6,B]  916-13-930ms   | [S6,MB7,B]  1008-13-1021ms | [S2,MB4,B]  1027-9-1036ms  | [S2,MB5,B]  1062-9-1071ms  | [S2,MB6,B]  1077-9-1086ms  | [S2,MB7,B]  1098-9-1108ms 
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-7-36ms      | [S3,MB1,F]  69-7-77ms      | [S3,MB2,F]  110-7-118ms    | [S3,MB3,F]  151-7-159ms    | [S7,MB0,F]  187-15-203ms   | [S7,MB0,B]  215-53-269ms   | [S7,MB1,F]  268-19-287ms   | [S7,MB1,B]  299-56-355ms   | [S7,MB2,F]  355-21-377ms   | [S7,MB2,B]  388-57-446ms   | [S7,MB3,F]  446-21-467ms   | [S7,MB3,B]  479-57-537ms   | [S3,MB4,F]  537-13-550ms   | [S3,MB0,B]  550-13-564ms   | [S3,MB5,F]  566-11-577ms   | [S3,MB1,B]  577-13-590ms   | [S3,MB6,F]  593-11-605ms   | [S3,MB2,B]  604-13-617ms   | [S3,MB7,F]  618-11-629ms   | [S3,MB3,B]  629-12-641ms   | [S7,MB4,F]  641-18-660ms   | [S7,MB4,B]  672-55-728ms   | [S7,MB5,F]  728-21-749ms   | [S7,MB5,B]  761-57-819ms   | [S7,MB6,F]  819-21-841ms   | [S7,MB6,B]  852-57-910ms   | [S7,MB7,F]  910-21-931ms   | [S7,MB7,B]  943-57-1001ms  | [S3,MB4,B]  1001-14-1015ms | [S3,MB5,B]  1015-13-1029ms | [S3,MB6,B]  1029-12-1041ms | [S3,MB7,B]  1055-12-1068ms
[rank3]:2025-12-24 22:00:59,629 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank3/251224_2200_stage3_step400.svg
[rank3]:2025-12-24 22:00:59,672 - âœ… Frozen Ratio History of Rank 3 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank3/251224_2200_stage7_step400.svg
[rank3]:2025-12-24 22:01:28,277 - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-12-24 22:01:28,724 - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-12-24 22:01:28,772 - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-12-24 22:01:28,757 - Dataset alpaca_gpt4 is being re-looped
[rank3]:2025-12-24 22:01:45,398 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 7.8959e-01
[rank2]:2025-12-24 22:01:45,386 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 5.2762e-01
[rank0]:2025-12-24 22:01:45,390 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 1.7683e+00
[rank1]:2025-12-24 22:01:45,392 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 3.2655e-01
[rank3]:2025-12-24 22:02:32,259 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 3.8444e+00
[rank2]:2025-12-24 22:02:32,243 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 4.1356e+00
[rank1]:2025-12-24 22:02:32,243 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 4.4351e+00
[rank0]:2025-12-24 22:02:32,259 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 4.7391e+00
[rank1]:2025-12-24 22:03:23,000 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 2.2619e-01
[rank0]:2025-12-24 22:03:22,999 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 1.2892e+00
[rank3]:2025-12-24 22:03:23,006 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 6.5039e-01
[rank2]:2025-12-24 22:03:22,995 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 4.8608e-01
[rank2]:2025-12-24 22:04:09,895 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 2.1608e+00
[rank1]:2025-12-24 22:04:09,894 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 2.3109e+00
[rank0]:2025-12-24 22:04:09,910 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 2.5365e+00
[rank3]:2025-12-24 22:04:09,910 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 2.2905e+00
[rank3]:2025-12-24 22:05:00,760 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 1.6302e+00
[rank2]:2025-12-24 22:05:00,749 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 9.9187e-01
[rank0]:2025-12-24 22:05:00,738 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-24 22:05:00,753 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 2.6023e+00
[rank1]:2025-12-24 22:05:00,755 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 4.8731e-01
[rank3]:2025-12-24 22:05:05,338 - Avg. fwd time: 14.6986 / Avg. bwd time: 38.1469 / Avg. batch time: 1072.6552 (ms) / GPU bubble ratio: 21.17%
[rank0]:2025-12-24 22:05:05,429 - Avg. fwd time: 8.6510 / Avg. bwd time: 16.8807 / Avg. batch time: 1214.7531 (ms) / GPU bubble ratio: 66.37%
[rank1]:2025-12-24 22:05:05,402 - Avg. fwd time: 10.1391 / Avg. bwd time: 20.7024 / Avg. batch time: 1181.2499 (ms) / GPU bubble ratio: 58.23%
[rank1]:2025-12-24 22:05:05,438 -  step: 450  loss: -4.0000  grad_norm:  0.4428  memory: 18.49GiB(38.93%)  tps: 6,657  tflops: 52.04  mfu: 16.68%
[rank3]:2025-12-24 22:05:05,453 -  step: 450  loss:  0.2338  grad_norm:  0.4428  memory: 29.23GiB(61.52%)  tps: 6,657  tflops: 52.04  mfu: 16.68%
[rank2]:2025-12-24 22:05:05,375 - Avg. fwd time: 8.0209 / Avg. bwd time: 16.0679 / Avg. batch time: 1128.7928 (ms) / GPU bubble ratio: 65.86%
[rank2]:2025-12-24 22:05:05,438 -  step: 450  loss: -4.0000  grad_norm:  0.4428  memory: 12.06GiB(25.39%)  tps: 6,657  tflops: 52.04  mfu: 16.68%
[rank0]:2025-12-24 22:05:05,452 -  step: 450  loss: -4.0000  grad_norm:  0.4428  memory: 20.42GiB(42.99%)  tps: 6,657  tflops: 52.04  mfu: 16.68%
[rank1]:2025-12-24 22:05:47,679 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 8.1405e-01
[rank0]:2025-12-24 22:05:47,695 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 5.0778e-01
[rank3]:2025-12-24 22:05:47,694 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 1.2880e+00
[rank2]:2025-12-24 22:05:47,679 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 2.5338e+00
[rank3]:2025-12-24 22:06:38,480 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 9.4615e-01
[rank2]:2025-12-24 22:06:38,469 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 5.9886e-01
[rank1]:2025-12-24 22:06:38,474 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 9.0925e-02
[rank0]:2025-12-24 22:06:38,472 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 4.5792e-01
[rank2]:2025-12-24 22:07:25,440 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 2.8342e-01
[rank3]:2025-12-24 22:07:25,456 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 2.1115e-01
[rank1]:2025-12-24 22:07:25,440 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 5.1330e-01
[rank0]:2025-12-24 22:07:25,456 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 4.9447e-01
[rank2]:2025-12-24 22:08:16,403 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 4.3943e-01
[rank3]:2025-12-24 22:08:16,415 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 6.0692e-01
[rank0]:2025-12-24 22:08:16,407 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 9.6582e-01
[rank1]:2025-12-24 22:08:16,409 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 2.3435e-01
[rank0]:2025-12-24 22:09:03,232 - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-12-24 22:09:03,236 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 7.4732e-01
[rank2]:2025-12-24 22:09:03,236 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 6.7815e-01
[rank3]:2025-12-24 22:09:03,251 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 2.2888e-01
[rank0]:2025-12-24 22:09:03,251 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 6.9654e-01
[rank3]:2025-12-24 22:09:08,190 - Avg. fwd time: 14.7090 / Avg. bwd time: 38.0577 / Avg. batch time: 1071.6059 (ms) / GPU bubble ratio: 21.21%
[rank2]:2025-12-24 22:09:08,239 - Avg. fwd time: 8.0290 / Avg. bwd time: 15.9647 / Avg. batch time: 1127.3718 (ms) / GPU bubble ratio: 65.95%
[rank0]:2025-12-24 22:09:08,308 - Avg. fwd time: 8.6693 / Avg. bwd time: 16.6343 / Avg. batch time: 1212.4120 (ms) / GPU bubble ratio: 66.61%
[rank0]:2025-12-24 22:09:08,332 -  step: 500  loss: -4.0000  grad_norm:  0.2421  memory: 20.42GiB(42.99%)  tps: 6,746  tflops: 52.74  mfu: 16.90%
[rank1]:2025-12-24 22:09:08,281 - Avg. fwd time: 10.1511 / Avg. bwd time: 20.4980 / Avg. batch time: 1179.2721 (ms) / GPU bubble ratio: 58.42%
[rank1]:2025-12-24 22:09:08,331 -  step: 500  loss: -4.0000  grad_norm:  0.2421  memory: 18.49GiB(38.93%)  tps: 6,745  tflops: 52.73  mfu: 16.90%
[rank2]:2025-12-24 22:09:08,327 -  step: 500  loss: -4.0000  grad_norm:  0.2421  memory: 12.06GiB(25.39%)  tps: 6,745  tflops: 52.73  mfu: 16.90%
[rank3]:2025-12-24 22:09:08,339 -  step: 500  loss:  0.2272  grad_norm:  0.2421  memory: 29.23GiB(61.52%)  tps: 6,746  tflops: 52.73  mfu: 16.90%
[rank0]:2025-12-24 22:09:08,386 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank0/251224_2209_stage0_step500.svg
[rank0]:2025-12-24 22:09:08,426 - âœ… Frozen Ratio History of Rank 0 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank0/251224_2209_stage4_step500.svg
[rank1]:2025-12-24 22:09:08,388 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank1/251224_2209_stage1_step500.svg
[rank1]:2025-12-24 22:09:08,428 - âœ… Frozen Ratio History of Rank 1 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank1/251224_2209_stage5_step500.svg
[rank2]:2025-12-24 22:09:08,388 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank2/251224_2209_stage2_step500.svg
[rank2]:2025-12-24 22:09:08,429 - âœ… Frozen Ratio History of Rank 2 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank2/251224_2209_stage6_step500.svg
[rank3]:2025-12-24 22:09:08,583 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/pipeline_schedule/251224_2209_step500_rank3.svg
[rank3]:			> Batch Time: 1150.45 ms, GPU Bubble Ratio: 67.56%, 65.23%, 71.52%, 30.72%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-9-17ms       | [S0,MB2,F]  17-8-26ms      | [S0,MB3,F]  26-8-34ms      | [S4,MB0,F]  49-9-58ms      | [S4,MB1,F]  89-8-98ms      | [S4,MB2,F]  130-8-139ms    | [S4,MB3,F]  171-8-179ms    | [S0,MB4,F]  180-9-189ms    | [S0,MB5,F]  189-8-197ms    | [S0,MB6,F]  197-9-207ms    | [S4,MB0,B]  378-14-392ms   | [S0,MB7,F]  392-8-400ms    | [S4,MB1,B]  500-14-515ms   | [S4,MB4,F]  563-8-571ms    | [S4,MB2,B]  571-14-586ms   | [S4,MB5,F]  592-8-600ms    | [S4,MB3,B]  601-14-615ms   | [S4,MB6,F]  621-9-630ms    | [S0,MB0,B]  630-15-645ms   | [S4,MB7,F]  649-7-657ms    | [S0,MB1,B]  657-15-673ms   | [S0,MB2,B]  677-14-692ms   | [S0,MB3,B]  745-14-759ms   | [S4,MB4,B]  773-13-786ms   | [S4,MB5,B]  871-13-884ms   | [S4,MB6,B]  961-13-975ms   | [S4,MB7,B]  1045-13-1058ms | [S0,MB4,B]  1065-14-1079ms | [S0,MB5,B]  1095-14-1109ms | [S0,MB6,B]  1116-14-1130ms | [S0,MB7,B]  1136-14-1150ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  49-12-61ms     | [S1,MB2,F]  89-12-102ms    | [S1,MB3,F]  130-12-142ms   | [S5,MB0,F]  170-8-179ms    | [S5,MB1,F]  185-7-193ms    | [S5,MB2,F]  199-7-207ms    | [S5,MB3,F]  283-7-290ms    | [S1,MB4,F]  308-12-321ms   | [S5,MB0,B]  320-14-334ms   | [S1,MB5,F]  370-13-384ms   | [S5,MB1,B]  384-14-399ms   | [S1,MB6,F]  400-12-413ms   | [S5,MB2,B]  499-14-514ms   | [S1,MB7,F]  514-12-527ms   | [S5,MB3,B]  570-15-585ms   | [S5,MB4,F]  585-8-594ms    | [S1,MB0,B]  599-15-615ms   | [S5,MB5,F]  616-8-625ms    | [S1,MB1,B]  628-15-644ms   | [S5,MB6,F]  644-9-654ms    | [S1,MB2,B]  654-15-670ms   | [S5,MB7,F]  670-9-680ms    | [S1,MB3,B]  679-15-695ms   | [S5,MB4,B]  752-13-766ms   | [S5,MB5,B]  842-13-856ms   | [S5,MB6,B]  932-13-946ms   | [S5,MB7,B]  1024-13-1038ms | [S1,MB4,B]  1044-14-1058ms | [S1,MB5,B]  1074-14-1088ms | [S1,MB6,B]  1094-14-1108ms | [S1,MB7,B]  1115-14-1129ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-7-28ms      | [S2,MB1,F]  61-7-69ms      | [S2,MB2,F]  102-7-110ms    | [S2,MB3,F]  142-7-150ms    | [S6,MB0,F]  179-7-187ms    | [S6,MB1,F]  193-7-200ms    | [S6,MB2,F]  277-7-284ms    | [S6,MB0,B]  284-14-299ms   | [S6,MB3,F]  299-8-308ms    | [S6,MB1,B]  360-15-375ms   | [S2,MB4,F]  376-9-386ms    | [S6,MB2,B]  451-14-466ms   | [S2,MB5,F]  467-8-475ms    | [S6,MB3,B]  543-14-558ms   | [S2,MB6,F]  558-9-567ms    | [S2,MB0,B]  571-10-582ms   | [S2,MB7,F]  583-8-592ms    | [S2,MB1,B]  600-10-611ms   | [S6,MB4,F]  611-8-619ms    | [S2,MB2,B]  629-10-640ms   | [S6,MB5,F]  640-8-648ms    | [S2,MB3,B]  653-10-664ms   | [S6,MB6,F]  664-8-672ms    | [S6,MB4,B]  731-15-746ms   | [S6,MB7,F]  746-8-754ms    | [S6,MB5,B]  822-14-836ms   | [S6,MB6,B]  912-13-926ms   | [S6,MB7,B]  1004-13-1018ms | [S2,MB4,B]  1024-9-1033ms  | [S2,MB5,B]  1058-9-1067ms  | [S2,MB6,B]  1074-9-1083ms  | [S2,MB7,B]  1094-9-1103ms 
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-7-36ms      | [S3,MB1,F]  69-7-77ms      | [S3,MB2,F]  110-7-117ms    | [S3,MB3,F]  150-7-158ms    | [S7,MB0,F]  187-15-202ms   | [S7,MB0,B]  214-53-268ms   | [S7,MB1,F]  267-19-287ms   | [S7,MB1,B]  298-56-355ms   | [S7,MB2,F]  354-21-375ms   | [S7,MB2,B]  387-58-445ms   | [S7,MB3,F]  445-21-466ms   | [S7,MB3,B]  478-57-536ms   | [S3,MB4,F]  536-13-549ms   | [S3,MB0,B]  549-13-562ms   | [S3,MB5,F]  564-11-576ms   | [S3,MB1,B]  575-13-588ms   | [S3,MB6,F]  590-11-601ms   | [S3,MB2,B]  602-13-615ms   | [S3,MB7,F]  615-10-626ms   | [S3,MB3,B]  626-12-639ms   | [S7,MB4,F]  639-18-657ms   | [S7,MB4,B]  669-55-724ms   | [S7,MB5,F]  724-21-745ms   | [S7,MB5,B]  758-57-816ms   | [S7,MB6,F]  816-21-837ms   | [S7,MB6,B]  849-57-906ms   | [S7,MB7,F]  906-21-927ms   | [S7,MB7,B]  939-57-996ms   | [S3,MB4,B]  997-14-1012ms  | [S3,MB5,B]  1012-13-1025ms | [S3,MB6,B]  1025-12-1037ms | [S3,MB7,B]  1052-12-1064ms
[rank3]:2025-12-24 22:09:08,626 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank3/251224_2209_stage3_step500.svg
[rank3]:2025-12-24 22:09:08,666 - âœ… Frozen Ratio History of Rank 3 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank3/251224_2209_stage7_step500.svg
[rank1]:2025-12-24 22:09:54,417 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 1.7311e-01
[rank2]:2025-12-24 22:09:54,411 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 4.2801e-01
[rank3]:2025-12-24 22:09:54,423 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 5.3007e-01
[rank0]:2025-12-24 22:09:54,415 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 1.3904e+00
[rank2]:2025-12-24 22:10:41,394 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 1.8604e+00
[rank3]:2025-12-24 22:10:41,409 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 1.8737e+00
[rank0]:2025-12-24 22:10:41,410 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 2.2161e+00
[rank1]:2025-12-24 22:10:41,394 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 1.8910e+00
[rank0]:2025-12-24 22:11:32,383 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 8.3802e-01
[rank1]:2025-12-24 22:11:32,384 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 2.0262e-01
[rank2]:2025-12-24 22:11:32,379 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 4.0041e-01
[rank3]:2025-12-24 22:11:32,391 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 6.1726e-01
[rank0]:2025-12-24 22:12:19,172 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 7.2702e-01
[rank1]:2025-12-24 22:12:19,157 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 7.4822e-01
[rank2]:2025-12-24 22:12:19,157 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 9.3812e-01
[rank3]:2025-12-24 22:12:19,172 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 5.6206e-01
[rank0]:2025-12-24 22:13:09,819 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-24 22:13:09,834 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 7.9755e-01
[rank1]:2025-12-24 22:13:09,836 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 2.0254e-01
[rank2]:2025-12-24 22:13:09,830 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 4.8755e-01
[rank3]:2025-12-24 22:13:09,842 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 6.7017e-01
[rank3]:2025-12-24 22:13:14,460 - Avg. fwd time: 14.7072 / Avg. bwd time: 38.0695 / Avg. batch time: 1071.6251 (ms) / GPU bubble ratio: 21.20%
[rank1]:2025-12-24 22:13:14,525 - Avg. fwd time: 10.1533 / Avg. bwd time: 20.4760 / Avg. batch time: 1179.1159 (ms) / GPU bubble ratio: 58.44%
[rank1]:2025-12-24 22:13:14,562 -  step: 550  loss: -4.0000  grad_norm:  0.5342  memory: 18.49GiB(38.93%)  tps: 6,654  tflops: 52.02  mfu: 16.67%
[rank2]:2025-12-24 22:13:14,497 - Avg. fwd time: 8.0291 / Avg. bwd time: 15.9798 / Avg. batch time: 1127.3486 (ms) / GPU bubble ratio: 65.93%
[rank2]:2025-12-24 22:13:14,562 -  step: 550  loss: -4.0000  grad_norm:  0.5342  memory: 12.06GiB(25.39%)  tps: 6,654  tflops: 52.02  mfu: 16.67%
[rank3]:2025-12-24 22:13:14,577 -  step: 550  loss:  0.2329  grad_norm:  0.5342  memory: 29.23GiB(61.52%)  tps: 6,654  tflops: 52.02  mfu: 16.67%
[rank0]:2025-12-24 22:13:14,553 - Avg. fwd time: 8.6845 / Avg. bwd time: 16.4313 / Avg. batch time: 1211.9595 (ms) / GPU bubble ratio: 66.84%
[rank0]:2025-12-24 22:13:14,576 -  step: 550  loss: -4.0000  grad_norm:  0.5342  memory: 20.42GiB(42.99%)  tps: 6,654  tflops: 52.01  mfu: 16.67%
[rank0]:2025-12-24 22:13:56,780 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 1.7332e+00
[rank1]:2025-12-24 22:13:56,765 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 2.5193e+00
[rank2]:2025-12-24 22:13:56,765 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 1.7735e+00
[rank3]:2025-12-24 22:13:56,781 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 1.4334e+00
[rank0]:2025-12-24 22:14:47,530 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 1.7222e+00
[rank1]:2025-12-24 22:14:47,532 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 3.1517e-01
[rank3]:2025-12-24 22:14:47,537 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 4.2502e-01
[rank2]:2025-12-24 22:14:47,526 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 4.1363e-01
[rank2]:2025-12-24 22:15:34,271 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 1.4274e+00
[rank1]:2025-12-24 22:15:34,272 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 1.3036e+00
[rank0]:2025-12-24 22:15:34,287 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 1.2412e+00
[rank3]:2025-12-24 22:15:34,287 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 4.1363e-01
[rank2]:2025-12-24 22:16:25,028 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 6.0521e-01
[rank1]:2025-12-24 22:16:25,034 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 2.4357e-01
[rank0]:2025-12-24 22:16:25,032 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 9.1950e-01
[rank3]:2025-12-24 22:16:25,040 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 5.6248e-01
[rank1]:2025-12-24 22:17:11,834 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 2.3176e-01
[rank0]:2025-12-24 22:17:11,830 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-24 22:17:11,849 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 1.8502e-01
[rank3]:2025-12-24 22:17:11,849 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 2.9336e-01
[rank2]:2025-12-24 22:17:11,834 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 4.5600e-01
[rank3]:2025-12-24 22:17:16,885 - Avg. fwd time: 14.6999 / Avg. bwd time: 38.0016 / Avg. batch time: 1070.6239 (ms) / GPU bubble ratio: 21.24%
[rank2]:2025-12-24 22:17:16,931 - Avg. fwd time: 8.0360 / Avg. bwd time: 15.9010 / Avg. batch time: 1126.0586 (ms) / GPU bubble ratio: 65.99%
[rank1]:2025-12-24 22:17:16,980 - Avg. fwd time: 10.1632 / Avg. bwd time: 20.3273 / Avg. batch time: 1177.4437 (ms) / GPU bubble ratio: 58.57%
[rank1]:2025-12-24 22:17:17,031 -  step: 600  loss: -4.0000  grad_norm:  0.9416  memory: 18.49GiB(38.93%)  tps: 6,757  tflops: 52.82  mfu: 16.93%
[rank0]:2025-12-24 22:17:17,008 - Avg. fwd time: 8.6974 / Avg. bwd time: 16.2630 / Avg. batch time: 1210.0413 (ms) / GPU bubble ratio: 67.00%
[rank0]:2025-12-24 22:17:17,032 -  step: 600  loss: -4.0000  grad_norm:  0.9416  memory: 20.42GiB(42.99%)  tps: 6,758  tflops: 52.83  mfu: 16.93%
[rank3]:2025-12-24 22:17:17,039 -  step: 600  loss:  0.2302  grad_norm:  0.9416  memory: 29.23GiB(61.52%)  tps: 6,757  tflops: 52.83  mfu: 16.93%
[rank2]:2025-12-24 22:17:17,027 -  step: 600  loss: -4.0000  grad_norm:  0.9416  memory: 12.06GiB(25.39%)  tps: 6,757  tflops: 52.83  mfu: 16.93%
[rank2]:2025-12-24 22:17:17,091 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank2/251224_2217_stage2_step600.svg
[rank1]:2025-12-24 22:17:17,093 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank1/251224_2217_stage1_step600.svg
[rank1]:2025-12-24 22:17:17,137 - âœ… Frozen Ratio History of Rank 1 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank1/251224_2217_stage5_step600.svg
[rank0]:2025-12-24 22:17:17,090 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank0/251224_2217_stage0_step600.svg
[rank0]:2025-12-24 22:17:17,133 - âœ… Frozen Ratio History of Rank 0 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank0/251224_2217_stage4_step600.svg
[rank2]:2025-12-24 22:17:17,141 - âœ… Frozen Ratio History of Rank 2 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank2/251224_2217_stage6_step600.svg
[rank3]:2025-12-24 22:17:17,290 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/pipeline_schedule/251224_2217_step600_rank3.svg
[rank3]:			> Batch Time: 1149.45 ms, GPU Bubble Ratio: 67.53%, 65.16%, 71.47%, 30.57%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-9-17ms       | [S0,MB2,F]  17-8-26ms      | [S0,MB3,F]  26-8-34ms      | [S4,MB0,F]  49-9-59ms      | [S4,MB1,F]  90-8-99ms      | [S4,MB2,F]  130-8-139ms    | [S4,MB3,F]  171-8-180ms    | [S0,MB4,F]  180-9-189ms    | [S0,MB5,F]  189-8-198ms    | [S0,MB6,F]  198-9-207ms    | [S4,MB0,B]  379-14-394ms   | [S0,MB7,F]  394-8-402ms    | [S4,MB1,B]  499-14-513ms   | [S4,MB4,F]  562-8-570ms    | [S4,MB2,B]  571-14-585ms   | [S4,MB5,F]  591-9-600ms    | [S4,MB3,B]  600-14-615ms   | [S4,MB6,F]  621-9-630ms    | [S0,MB0,B]  631-15-646ms   | [S4,MB7,F]  650-8-658ms    | [S0,MB1,B]  658-15-673ms   | [S0,MB2,B]  678-14-692ms   | [S0,MB3,B]  743-14-758ms   | [S4,MB4,B]  772-13-785ms   | [S4,MB5,B]  869-13-883ms   | [S4,MB6,B]  960-13-973ms   | [S4,MB7,B]  1043-13-1056ms | [S0,MB4,B]  1064-14-1078ms | [S0,MB5,B]  1094-14-1108ms | [S0,MB6,B]  1114-14-1128ms | [S0,MB7,B]  1135-14-1149ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  49-12-61ms     | [S1,MB2,F]  90-12-102ms    | [S1,MB3,F]  130-12-143ms   | [S5,MB0,F]  171-8-179ms    | [S5,MB1,F]  186-7-193ms    | [S5,MB2,F]  200-7-207ms    | [S5,MB3,F]  284-7-292ms    | [S1,MB4,F]  310-12-322ms   | [S5,MB0,B]  322-14-336ms   | [S1,MB5,F]  372-14-386ms   | [S5,MB1,B]  386-14-400ms   | [S1,MB6,F]  401-12-414ms   | [S5,MB2,B]  498-14-513ms   | [S1,MB7,F]  514-12-527ms   | [S5,MB3,B]  569-15-585ms   | [S5,MB4,F]  585-8-594ms    | [S1,MB0,B]  599-15-614ms   | [S5,MB5,F]  616-8-625ms    | [S1,MB1,B]  628-15-644ms   | [S5,MB6,F]  645-9-654ms    | [S1,MB2,B]  654-15-670ms   | [S5,MB7,F]  670-9-680ms    | [S1,MB3,B]  680-15-695ms   | [S5,MB4,B]  750-13-764ms   | [S5,MB5,B]  840-13-854ms   | [S5,MB6,B]  931-13-945ms   | [S5,MB7,B]  1022-13-1036ms | [S1,MB4,B]  1042-14-1056ms | [S1,MB5,B]  1072-14-1086ms | [S1,MB6,B]  1093-14-1107ms | [S1,MB7,B]  1113-14-1127ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-7-28ms      | [S2,MB1,F]  61-7-69ms      | [S2,MB2,F]  102-7-110ms    | [S2,MB3,F]  143-7-151ms    | [S6,MB0,F]  179-7-187ms    | [S6,MB1,F]  193-7-201ms    | [S6,MB2,F]  279-7-286ms    | [S6,MB0,B]  286-14-301ms   | [S6,MB3,F]  301-8-310ms    | [S6,MB1,B]  362-15-377ms   | [S2,MB4,F]  377-9-386ms    | [S6,MB2,B]  453-14-468ms   | [S2,MB5,F]  468-8-476ms    | [S6,MB3,B]  542-14-557ms   | [S2,MB6,F]  558-9-567ms    | [S2,MB0,B]  571-10-582ms   | [S2,MB7,F]  583-8-592ms    | [S2,MB1,B]  601-10-612ms   | [S6,MB4,F]  612-8-620ms    | [S2,MB2,B]  630-10-641ms   | [S6,MB5,F]  640-8-649ms    | [S2,MB3,B]  654-10-665ms   | [S6,MB6,F]  664-8-673ms    | [S6,MB4,B]  729-15-744ms   | [S6,MB7,F]  744-8-753ms    | [S6,MB5,B]  820-14-834ms   | [S6,MB6,B]  912-13-925ms   | [S6,MB7,B]  1002-13-1016ms | [S2,MB4,B]  1022-9-1031ms  | [S2,MB5,B]  1057-9-1066ms  | [S2,MB6,B]  1072-9-1081ms  | [S2,MB7,B]  1092-9-1102ms 
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-7-36ms      | [S3,MB1,F]  69-7-77ms      | [S3,MB2,F]  110-7-118ms    | [S3,MB3,F]  151-7-158ms    | [S7,MB0,F]  187-15-203ms   | [S7,MB0,B]  215-54-269ms   | [S7,MB1,F]  269-19-288ms   | [S7,MB1,B]  300-55-355ms   | [S7,MB2,F]  356-21-377ms   | [S7,MB2,B]  389-57-447ms   | [S7,MB3,F]  446-21-467ms   | [S7,MB3,B]  477-57-535ms   | [S3,MB4,F]  536-13-549ms   | [S3,MB0,B]  548-13-561ms   | [S3,MB5,F]  563-11-575ms   | [S3,MB1,B]  574-12-587ms   | [S3,MB6,F]  589-11-600ms   | [S3,MB2,B]  600-12-613ms   | [S3,MB7,F]  613-10-624ms   | [S3,MB3,B]  624-12-637ms   | [S7,MB4,F]  637-18-656ms   | [S7,MB4,B]  668-55-723ms   | [S7,MB5,F]  723-21-744ms   | [S7,MB5,B]  756-57-814ms   | [S7,MB6,F]  814-21-835ms   | [S7,MB6,B]  847-58-905ms   | [S7,MB7,F]  905-21-927ms   | [S7,MB7,B]  938-57-996ms   | [S3,MB4,B]  996-14-1010ms  | [S3,MB5,B]  1010-13-1024ms | [S3,MB6,B]  1024-12-1036ms | [S3,MB7,B]  1050-12-1063ms
[rank3]:2025-12-24 22:17:17,334 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank3/251224_2217_stage3_step600.svg
[rank3]:2025-12-24 22:17:17,375 - âœ… Frozen Ratio History of Rank 3 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank3/251224_2217_stage7_step600.svg
[rank2]:2025-12-24 22:18:02,961 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 2.7570e-01
[rank1]:2025-12-24 22:18:02,967 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 1.2870e-01
[rank0]:2025-12-24 22:18:02,965 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 5.7106e-01
[rank3]:2025-12-24 22:18:02,973 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 4.5667e-01
[rank3]:2025-12-24 22:18:49,809 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 1.2116e+00
[rank2]:2025-12-24 22:18:49,793 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 1.1976e+00
[rank1]:2025-12-24 22:18:49,793 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 1.0664e+00
[rank0]:2025-12-24 22:18:49,809 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 1.4598e+00
[rank1]:2025-12-24 22:19:40,531 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 7.6709e-02
[rank0]:2025-12-24 22:19:40,529 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 3.3823e-01
[rank3]:2025-12-24 22:19:40,537 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 1.4433e-01
[rank2]:2025-12-24 22:19:40,526 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 8.5374e-02
[rank3]:2025-12-24 22:20:27,440 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 2.4760e-01
[rank2]:2025-12-24 22:20:27,425 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 2.7781e-01
[rank1]:2025-12-24 22:20:27,425 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 4.5187e-01
[rank0]:2025-12-24 22:20:27,441 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 4.1568e-01
[rank2]:2025-12-24 22:21:18,217 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 3.9405e-01
[rank1]:2025-12-24 22:21:18,224 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 1.7561e-01
[rank0]:2025-12-24 22:21:18,207 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-24 22:21:18,221 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 5.9848e-01
[rank3]:2025-12-24 22:21:18,229 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 4.2878e-01
[rank3]:2025-12-24 22:21:22,825 - Avg. fwd time: 14.6909 / Avg. bwd time: 38.0146 / Avg. batch time: 1070.5807 (ms) / GPU bubble ratio: 21.23%
[rank2]:2025-12-24 22:21:22,862 - Avg. fwd time: 8.0361 / Avg. bwd time: 15.9191 / Avg. batch time: 1126.0054 (ms) / GPU bubble ratio: 65.96%
[rank2]:2025-12-24 22:21:22,929 -  step: 650  loss: -4.0000  grad_norm:  0.1174  memory: 12.06GiB(25.39%)  tps: 6,663  tflops: 52.09  mfu: 16.69%
[rank1]:2025-12-24 22:21:22,890 - Avg. fwd time: 10.1648 / Avg. bwd time: 20.3220 / Avg. batch time: 1177.3172 (ms) / GPU bubble ratio: 58.57%
[rank1]:2025-12-24 22:21:22,929 -  step: 650  loss: -4.0000  grad_norm:  0.1174  memory: 18.49GiB(38.93%)  tps: 6,663  tflops: 52.09  mfu: 16.69%
[rank0]:2025-12-24 22:21:22,919 - Avg. fwd time: 8.7085 / Avg. bwd time: 16.1200 / Avg. batch time: 1209.7058 (ms) / GPU bubble ratio: 67.16%
[rank0]:2025-12-24 22:21:22,943 -  step: 650  loss: -4.0000  grad_norm:  0.1174  memory: 20.42GiB(42.99%)  tps: 6,663  tflops: 52.09  mfu: 16.69%
[rank3]:2025-12-24 22:21:22,944 -  step: 650  loss:  0.2353  grad_norm:  0.1174  memory: 29.23GiB(61.52%)  tps: 6,663  tflops: 52.09  mfu: 16.69%
[rank2]:2025-12-24 22:22:05,084 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 1.1517e+00
[rank0]:2025-12-24 22:22:05,100 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 9.3114e-01
[rank1]:2025-12-24 22:22:05,085 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 9.8849e-01
[rank3]:2025-12-24 22:22:05,100 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 1.0382e+00
[rank0]:2025-12-24 22:22:55,790 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 2.6646e-01
[rank1]:2025-12-24 22:22:55,791 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 6.5097e-02
[rank3]:2025-12-24 22:22:55,797 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 1.3257e-01
[rank2]:2025-12-24 22:22:55,786 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 1.9690e-01
[rank3]:2025-12-24 22:23:42,707 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 9.8033e-01
[rank2]:2025-12-24 22:23:42,692 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 1.0122e+00
[rank0]:2025-12-24 22:23:42,707 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 1.0123e+00
[rank1]:2025-12-24 22:23:42,692 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 1.0827e+00
[rank2]:2025-12-24 22:24:33,571 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 1.3380e-01
[rank0]:2025-12-24 22:24:33,575 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 3.5243e-01
[rank1]:2025-12-24 22:24:33,576 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 6.0194e-02
[rank3]:2025-12-24 22:24:33,582 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 2.7508e-01
[rank0]:2025-12-24 22:25:20,352 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-24 22:25:20,371 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 3.3183e+00
[rank1]:2025-12-24 22:25:20,356 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 2.9818e+00
[rank3]:2025-12-24 22:25:20,371 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 2.9303e+00
[rank2]:2025-12-24 22:25:20,356 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 2.5524e+00
[rank3]:2025-12-24 22:25:25,301 - Avg. fwd time: 14.6880 / Avg. bwd time: 37.9617 / Avg. batch time: 1069.8367 (ms) / GPU bubble ratio: 21.26%
[rank2]:2025-12-24 22:25:25,349 - Avg. fwd time: 8.0417 / Avg. bwd time: 15.8565 / Avg. batch time: 1125.0435 (ms) / GPU bubble ratio: 66.01%
[rank1]:2025-12-24 22:25:25,394 - Avg. fwd time: 10.1720 / Avg. bwd time: 20.2032 / Avg. batch time: 1176.0454 (ms) / GPU bubble ratio: 58.67%
[rank2]:2025-12-24 22:25:25,442 -  step: 700  loss: -4.0000  grad_norm:  0.2860  memory: 12.06GiB(25.39%)  tps: 6,756  tflops: 52.81  mfu: 16.93%
[rank0]:2025-12-24 22:25:25,423 - Avg. fwd time: 8.7177 / Avg. bwd time: 15.9980 / Avg. batch time: 1208.2550 (ms) / GPU bubble ratio: 67.27%
[rank0]:2025-12-24 22:25:25,447 -  step: 700  loss: -4.0000  grad_norm:  0.2860  memory: 20.42GiB(42.99%)  tps: 6,756  tflops: 52.82  mfu: 16.93%
[rank1]:2025-12-24 22:25:25,446 -  step: 700  loss: -4.0000  grad_norm:  0.2860  memory: 18.49GiB(38.93%)  tps: 6,756  tflops: 52.81  mfu: 16.93%
[rank1]:2025-12-24 22:25:25,506 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank1/251224_2225_stage1_step700.svg
[rank3]:2025-12-24 22:25:25,454 -  step: 700  loss:  0.1989  grad_norm:  0.2860  memory: 29.23GiB(61.52%)  tps: 6,756  tflops: 52.82  mfu: 16.93%
[rank2]:2025-12-24 22:25:25,507 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank2/251224_2225_stage2_step700.svg
[rank2]:2025-12-24 22:25:25,551 - âœ… Frozen Ratio History of Rank 2 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank2/251224_2225_stage6_step700.svg
[rank0]:2025-12-24 22:25:25,505 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank0/251224_2225_stage0_step700.svg
[rank0]:2025-12-24 22:25:25,549 - âœ… Frozen Ratio History of Rank 0 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank0/251224_2225_stage4_step700.svg
[rank1]:2025-12-24 22:25:25,549 - âœ… Frozen Ratio History of Rank 1 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank1/251224_2225_stage5_step700.svg
[rank3]:2025-12-24 22:25:25,696 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/pipeline_schedule/251224_2225_step700_rank3.svg
[rank3]:			> Batch Time: 1149.45 ms, GPU Bubble Ratio: 67.55%, 65.20%, 71.49%, 30.66%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-9-17ms       | [S0,MB2,F]  17-8-26ms      | [S0,MB3,F]  26-8-34ms      | [S4,MB0,F]  49-9-59ms      | [S4,MB1,F]  89-8-98ms      | [S4,MB2,F]  130-8-139ms    | [S4,MB3,F]  171-8-180ms    | [S0,MB4,F]  180-9-189ms    | [S0,MB5,F]  189-8-197ms    | [S0,MB6,F]  197-9-207ms    | [S4,MB0,B]  378-14-393ms   | [S0,MB7,F]  393-8-401ms    | [S4,MB1,B]  500-14-514ms   | [S4,MB4,F]  562-8-571ms    | [S4,MB2,B]  571-14-585ms   | [S4,MB5,F]  591-8-600ms    | [S4,MB3,B]  600-14-615ms   | [S4,MB6,F]  621-9-630ms    | [S0,MB0,B]  630-15-645ms   | [S4,MB7,F]  649-7-657ms    | [S0,MB1,B]  657-15-673ms   | [S0,MB2,B]  677-14-691ms   | [S0,MB3,B]  743-14-758ms   | [S4,MB4,B]  772-13-785ms   | [S4,MB5,B]  869-13-882ms   | [S4,MB6,B]  960-13-974ms   | [S4,MB7,B]  1044-13-1057ms | [S0,MB4,B]  1065-14-1079ms | [S0,MB5,B]  1095-14-1109ms | [S0,MB6,B]  1115-14-1129ms | [S0,MB7,B]  1135-14-1149ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  49-12-61ms     | [S1,MB2,F]  89-12-102ms    | [S1,MB3,F]  130-12-142ms   | [S5,MB0,F]  171-8-179ms    | [S5,MB1,F]  185-7-193ms    | [S5,MB2,F]  199-7-207ms    | [S5,MB3,F]  283-7-291ms    | [S1,MB4,F]  309-12-321ms   | [S5,MB0,B]  321-14-335ms   | [S1,MB5,F]  371-14-385ms   | [S5,MB1,B]  385-14-400ms   | [S1,MB6,F]  400-12-413ms   | [S5,MB2,B]  499-14-513ms   | [S1,MB7,F]  514-12-526ms   | [S5,MB3,B]  569-15-585ms   | [S5,MB4,F]  585-8-594ms    | [S1,MB0,B]  599-15-614ms   | [S5,MB5,F]  615-8-624ms    | [S1,MB1,B]  628-15-644ms   | [S5,MB6,F]  644-9-653ms    | [S1,MB2,B]  653-15-669ms   | [S5,MB7,F]  669-9-679ms    | [S1,MB3,B]  679-15-695ms   | [S5,MB4,B]  751-13-765ms   | [S5,MB5,B]  840-13-854ms   | [S5,MB6,B]  930-13-944ms   | [S5,MB7,B]  1023-13-1037ms | [S1,MB4,B]  1043-14-1057ms | [S1,MB5,B]  1073-14-1087ms | [S1,MB6,B]  1094-14-1108ms | [S1,MB7,B]  1114-14-1128ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-7-28ms      | [S2,MB1,F]  61-7-69ms      | [S2,MB2,F]  102-7-110ms    | [S2,MB3,F]  142-7-150ms    | [S6,MB0,F]  179-7-187ms    | [S6,MB1,F]  193-7-200ms    | [S6,MB2,F]  277-7-284ms    | [S6,MB0,B]  284-14-299ms   | [S6,MB3,F]  299-8-308ms    | [S6,MB1,B]  361-15-376ms   | [S2,MB4,F]  376-9-385ms    | [S6,MB2,B]  452-14-467ms   | [S2,MB5,F]  467-8-476ms    | [S6,MB3,B]  541-14-556ms   | [S2,MB6,F]  557-9-566ms    | [S2,MB0,B]  571-10-581ms   | [S2,MB7,F]  583-8-592ms    | [S2,MB1,B]  600-10-611ms   | [S6,MB4,F]  611-8-619ms    | [S2,MB2,B]  629-10-639ms   | [S6,MB5,F]  639-8-648ms    | [S2,MB3,B]  653-10-664ms   | [S6,MB6,F]  664-8-672ms    | [S6,MB4,B]  730-15-745ms   | [S6,MB7,F]  745-8-753ms    | [S6,MB5,B]  820-14-834ms   | [S6,MB6,B]  911-13-925ms   | [S6,MB7,B]  1003-13-1017ms | [S2,MB4,B]  1023-9-1032ms  | [S2,MB5,B]  1057-9-1066ms  | [S2,MB6,B]  1073-9-1082ms  | [S2,MB7,B]  1093-9-1102ms 
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-7-36ms      | [S3,MB1,F]  69-7-77ms      | [S3,MB2,F]  110-7-117ms    | [S3,MB3,F]  150-7-158ms    | [S7,MB0,F]  187-15-202ms   | [S7,MB0,B]  214-53-268ms   | [S7,MB1,F]  267-19-287ms   | [S7,MB1,B]  299-56-355ms   | [S7,MB2,F]  354-21-375ms   | [S7,MB2,B]  387-57-445ms   | [S7,MB3,F]  445-21-467ms   | [S7,MB3,B]  477-57-535ms   | [S3,MB4,F]  535-13-548ms   | [S3,MB0,B]  548-13-561ms   | [S3,MB5,F]  563-11-575ms   | [S3,MB1,B]  575-13-588ms   | [S3,MB6,F]  589-11-600ms   | [S3,MB2,B]  600-13-613ms   | [S3,MB7,F]  613-11-624ms   | [S3,MB3,B]  625-12-637ms   | [S7,MB4,F]  637-18-655ms   | [S7,MB4,B]  668-56-724ms   | [S7,MB5,F]  723-21-744ms   | [S7,MB5,B]  756-57-814ms   | [S7,MB6,F]  814-21-835ms   | [S7,MB6,B]  847-57-904ms   | [S7,MB7,F]  905-21-926ms   | [S7,MB7,B]  938-57-996ms   | [S3,MB4,B]  996-14-1011ms  | [S3,MB5,B]  1011-13-1024ms | [S3,MB6,B]  1023-12-1035ms | [S3,MB7,B]  1051-12-1063ms
[rank3]:2025-12-24 22:25:25,743 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank3/251224_2225_stage3_step700.svg
[rank3]:2025-12-24 22:25:25,785 - âœ… Frozen Ratio History of Rank 3 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank3/251224_2225_stage7_step700.svg
[rank2]:2025-12-24 22:26:11,500 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 3.8787e-01
[rank0]:2025-12-24 22:26:11,504 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 4.9593e-01
[rank1]:2025-12-24 22:26:11,505 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 9.2933e-02
[rank3]:2025-12-24 22:26:11,512 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 7.1162e-01
[rank1]:2025-12-24 22:26:58,414 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 1.0535e+00
[rank3]:2025-12-24 22:26:58,429 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 4.0476e-01
[rank2]:2025-12-24 22:26:58,414 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 5.5029e-01
[rank0]:2025-12-24 22:26:58,429 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 7.9794e-01
[rank2]:2025-12-24 22:27:49,255 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 3.3609e-01
[rank0]:2025-12-24 22:27:49,259 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 7.5852e-01
[rank1]:2025-12-24 22:27:49,261 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 1.7258e-01
[rank3]:2025-12-24 22:27:49,267 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 2.9818e-01
[rank3]:2025-12-24 22:28:36,085 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 7.0013e-01
[rank2]:2025-12-24 22:28:36,070 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 8.3806e-01
[rank1]:2025-12-24 22:28:36,070 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 7.2769e-01
[rank0]:2025-12-24 22:28:36,085 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 6.5123e-01
[rank3]:2025-12-24 22:29:26,737 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 5.9870e-01
[rank1]:2025-12-24 22:29:26,730 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 1.9463e-01
[rank2]:2025-12-24 22:29:26,725 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 4.1299e-01
[rank0]:2025-12-24 22:29:26,714 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-24 22:29:26,729 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 9.1159e-01
[rank3]:2025-12-24 22:29:31,370 - Avg. fwd time: 14.6830 / Avg. bwd time: 37.9763 / Avg. batch time: 1069.9015 (ms) / GPU bubble ratio: 21.25%
[rank1]:2025-12-24 22:29:31,435 - Avg. fwd time: 10.1730 / Avg. bwd time: 20.2080 / Avg. batch time: 1176.0776 (ms) / GPU bubble ratio: 58.67%
[rank1]:2025-12-24 22:29:31,474 -  step: 750  loss: -4.0000  grad_norm:  0.4862  memory: 18.49GiB(38.93%)  tps: 6,659  tflops: 52.06  mfu: 16.69%
[rank2]:2025-12-24 22:29:31,406 - Avg. fwd time: 8.0414 / Avg. bwd time: 15.8751 / Avg. batch time: 1125.1078 (ms) / GPU bubble ratio: 65.99%
[rank2]:2025-12-24 22:29:31,474 -  step: 750  loss: -4.0000  grad_norm:  0.4862  memory: 12.06GiB(25.39%)  tps: 6,659  tflops: 52.06  mfu: 16.69%
[rank0]:2025-12-24 22:29:31,465 - Avg. fwd time: 8.7258 / Avg. bwd time: 15.8915 / Avg. batch time: 1208.1326 (ms) / GPU bubble ratio: 67.40%
[rank0]:2025-12-24 22:29:31,488 -  step: 750  loss: -4.0000  grad_norm:  0.4862  memory: 20.42GiB(42.99%)  tps: 6,659  tflops: 52.06  mfu: 16.69%
[rank3]:2025-12-24 22:29:31,489 -  step: 750  loss:  0.2427  grad_norm:  0.4862  memory: 29.23GiB(61.52%)  tps: 6,659  tflops: 52.06  mfu: 16.69%
[rank2]:2025-12-24 22:30:13,739 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 1.4772e+00
[rank0]:2025-12-24 22:30:13,755 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 1.7117e+00
[rank3]:2025-12-24 22:30:13,755 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 1.3911e+00
[rank1]:2025-12-24 22:30:13,739 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 1.4052e+00
[rank3]:2025-12-24 22:31:04,762 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 5.8653e-01
[rank1]:2025-12-24 22:31:04,755 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 2.6526e-01
[rank2]:2025-12-24 22:31:04,750 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 5.5248e-01
[rank0]:2025-12-24 22:31:04,754 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 1.5972e+00
[rank3]:2025-12-24 22:31:51,707 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 1.6913e+00
[rank1]:2025-12-24 22:31:51,691 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 2.3207e+00
[rank2]:2025-12-24 22:31:51,691 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 2.5504e+00
[rank0]:2025-12-24 22:31:51,707 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 2.3263e+00
[rank2]:2025-12-24 22:32:42,636 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 1.9072e-01
[rank0]:2025-12-24 22:32:42,639 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 1.6806e-01
[rank3]:2025-12-24 22:32:42,647 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 2.7282e-01
[rank1]:2025-12-24 22:32:42,642 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 6.4462e-02
[rank1]:2025-12-24 22:33:29,651 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 2.3093e-01
[rank0]:2025-12-24 22:33:29,647 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-24 22:33:29,666 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 7.2498e-02
[rank2]:2025-12-24 22:33:29,650 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 6.4037e-01
[rank3]:2025-12-24 22:33:29,666 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 6.2165e-01
[rank3]:2025-12-24 22:33:34,715 - Avg. fwd time: 14.6917 / Avg. bwd time: 37.9377 / Avg. batch time: 1069.5423 (ms) / GPU bubble ratio: 21.27%
[rank2]:2025-12-24 22:33:34,760 - Avg. fwd time: 8.0462 / Avg. bwd time: 15.8225 / Avg. batch time: 1124.5747 (ms) / GPU bubble ratio: 66.04%
[rank1]:2025-12-24 22:33:34,808 - Avg. fwd time: 10.1797 / Avg. bwd time: 20.1139 / Avg. batch time: 1175.3108 (ms) / GPU bubble ratio: 58.76%
[rank1]:2025-12-24 22:33:34,861 -  step: 800  loss: -4.0000  grad_norm:  1.1172  memory: 18.49GiB(38.93%)  tps: 6,732  tflops: 52.63  mfu: 16.87%
[rank1]:2025-12-24 22:33:34,861 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  1.1172  tps: 7,058  tflops: 55.17  mfu: 16.13%
[rank1]:2025-12-24 22:33:34,861 - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-12-24 22:33:34,862 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-24 22:33:34,838 - Avg. fwd time: 8.7326 / Avg. bwd time: 15.7988 / Avg. batch time: 1207.2295 (ms) / GPU bubble ratio: 67.49%
[rank0]:2025-12-24 22:33:34,862 -  step: 800  loss: -4.0000  grad_norm:  1.1172  memory: 20.42GiB(42.99%)  tps: 6,732  tflops: 52.63  mfu: 16.87%
[rank0]:2025-12-24 22:33:34,862 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  1.1172  tps: 7,058  tflops: 55.17  mfu: 16.13%
[rank0]:2025-12-24 22:33:34,862 - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-12-24 22:33:34,863 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank2]:2025-12-24 22:33:34,857 -  step: 800  loss: -4.0000  grad_norm:  1.1172  memory: 12.06GiB(25.39%)  tps: 6,732  tflops: 52.63  mfu: 16.87%
[rank2]:2025-12-24 22:33:34,857 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  1.1172  tps: 7,058  tflops: 55.18  mfu: 16.14%
[rank2]:2025-12-24 22:33:34,858 - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-12-24 22:33:34,858 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank3]:2025-12-24 22:33:34,869 -  step: 800  loss:  0.2474  grad_norm:  1.1172  memory: 29.23GiB(61.52%)  tps: 6,732  tflops: 52.63  mfu: 16.87%
[rank3]:2025-12-24 22:33:34,870 - â„¹ï¸ final step: 800  loss:  0.2474  grad_norm:  1.1172  tps: 7,062  tflops: 55.21  mfu: 16.26%
[rank3]:2025-12-24 22:33:34,870 - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-12-24 22:33:34,871 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-24 22:33:36,836 - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-12-24 22:33:36,907 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank0/251224_2233_stage0_final800.svg
[rank2]:2025-12-24 22:33:36,908 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank2/251224_2233_stage2_final800.svg
[rank1]:2025-12-24 22:33:36,909 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank1/251224_2233_stage1_final800.svg
[rank1]:2025-12-24 22:33:36,954 - âœ… Frozen Ratio History of Rank 1 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank1/251224_2233_stage5_final800.svg
[rank0]:2025-12-24 22:33:36,952 - âœ… Frozen Ratio History of Rank 0 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank0/251224_2233_stage4_final800.svg
[rank2]:2025-12-24 22:33:36,954 - âœ… Frozen Ratio History of Rank 2 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank2/251224_2233_stage6_final800.svg
[rank1]:2025-12-24 22:33:37,058 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_params_histogram/251224_2233_rank1_stage5.svg
[rank1]:	> Counts Sum: 306, Total Sum: 1350 (22.67%), Ratio(%) per element: [45.33, 45.33, 45.33, 45.33, 45.33, 45.33, 45.33, 45.33, 45.33, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-12-24 22:33:37,058 - Destroying the purge thread.
[rank0]:2025-12-24 22:33:37,054 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_params_histogram/251224_2233_rank0_stage4.svg
[rank0]:	> Counts Sum: 567, Total Sum: 1350 (42.00%), Ratio(%) per element: [84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-12-24 22:33:37,055 - Sleeping 2 seconds for other ranks to complete
[rank2]:2025-12-24 22:33:37,056 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_params_histogram/251224_2233_rank2_stage6.svg
[rank2]:	> Counts Sum: 333, Total Sum: 1350 (24.67%), Ratio(%) per element: [49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-12-24 22:33:37,057 - Destroying the purge thread.
[rank3]:2025-12-24 22:33:37,107 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/pipeline_schedule/251224_2233_final800_rank3.svg
[rank3]:			> Batch Time: 1232.45 ms, GPU Bubble Ratio: 69.74%, 56.14%, 65.56%, 28.69%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-9-17ms       | [S0,MB2,F]  17-8-26ms      | [S0,MB3,F]  26-8-34ms      | [S4,MB0,F]  49-9-59ms      | [S4,MB1,F]  88-8-97ms      | [S4,MB2,F]  127-8-135ms    | [S4,MB3,F]  165-8-174ms    | [S0,MB4,F]  174-9-183ms    | [S0,MB5,F]  183-8-191ms    | [S0,MB6,F]  191-9-201ms    | [S4,MB0,B]  375-14-390ms   | [S0,MB7,F]  390-8-398ms    | [S4,MB1,B]  498-14-512ms   | [S4,MB4,F]  560-8-569ms    | [S4,MB2,B]  569-14-583ms   | [S4,MB5,F]  592-8-600ms    | [S4,MB3,B]  601-14-615ms   | [S4,MB6,F]  624-9-633ms    | [S0,MB0,B]  633-15-649ms   | [S4,MB7,F]  656-7-664ms    | [S0,MB1,B]  667-15-683ms   | [S0,MB2,B]  708-14-722ms   | [S0,MB3,B]  764-14-778ms   | [S4,MB4,B]  801-13-815ms   | [S4,MB5,B]  889-13-903ms   | [S4,MB6,B]  979-13-993ms   | [S4,MB7,B]  1070-13-1083ms | [S0,MB4,B]  1105-14-1119ms | [S0,MB5,B]  1145-14-1159ms | [S0,MB6,B]  1181-14-1195ms | [S0,MB7,B]  1218-14-1232ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  49-11-60ms     | [S1,MB2,F]  88-11-99ms     | [S1,MB3,F]  126-11-138ms   | [S5,MB0,F]  165-8-173ms    | [S5,MB1,F]  179-7-187ms    | [S5,MB2,F]  193-7-201ms    | [S5,MB3,F]  279-7-286ms    | [S1,MB4,F]  307-11-318ms   | [S5,MB0,B]  318-17-336ms   | [S1,MB5,F]  368-12-381ms   | [S5,MB1,B]  383-18-402ms   | [S1,MB6,F]  400-11-412ms   | [S5,MB2,B]  497-18-516ms   | [S1,MB7,F]  514-11-525ms   | [S5,MB3,B]  567-19-587ms   | [S5,MB4,F]  585-7-593ms    | [S1,MB0,B]  600-26-627ms   | [S5,MB5,F]  622-8-631ms    | [S1,MB1,B]  633-29-663ms   | [S5,MB6,F]  658-9-668ms    | [S1,MB2,B]  669-31-701ms   | [S5,MB7,F]  701-10-711ms   | [S1,MB3,B]  711-33-745ms   | [S5,MB4,B]  775-18-793ms   | [S5,MB5,B]  863-18-882ms   | [S5,MB6,B]  953-18-971ms   | [S5,MB7,B]  1045-18-1063ms | [S1,MB4,B]  1070-27-1098ms | [S1,MB5,B]  1110-27-1138ms | [S1,MB6,B]  1145-27-1173ms | [S1,MB7,B]  1180-28-1208ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-7-28ms      | [S2,MB1,F]  61-7-68ms      | [S2,MB2,F]  99-7-106ms     | [S2,MB3,F]  137-7-145ms    | [S6,MB0,F]  173-7-181ms    | [S6,MB1,F]  187-7-194ms    | [S6,MB2,F]  273-7-280ms    | [S6,MB0,B]  280-17-297ms   | [S6,MB3,F]  298-8-307ms    | [S6,MB1,B]  358-19-377ms   | [S2,MB4,F]  375-8-384ms    | [S6,MB2,B]  449-19-468ms   | [S2,MB5,F]  466-7-474ms    | [S6,MB3,B]  540-19-559ms   | [S2,MB6,F]  557-8-566ms    | [S2,MB0,B]  572-17-590ms   | [S2,MB7,F]  587-8-596ms    | [S2,MB1,B]  604-19-623ms   | [S6,MB4,F]  619-8-628ms    | [S2,MB2,B]  635-19-655ms   | [S6,MB5,F]  651-8-659ms    | [S2,MB3,B]  667-19-687ms   | [S6,MB6,F]  686-7-694ms    | [S6,MB4,B]  749-19-769ms   | [S6,MB7,F]  769-8-777ms    | [S6,MB5,B]  839-18-858ms   | [S6,MB6,B]  930-17-948ms   | [S6,MB7,B]  1022-17-1040ms | [S2,MB4,B]  1046-18-1064ms | [S2,MB5,B]  1086-18-1104ms | [S2,MB6,B]  1110-18-1128ms | [S2,MB7,B]  1145-18-1163ms
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-7-36ms      | [S3,MB1,F]  68-7-75ms      | [S3,MB2,F]  106-7-113ms    | [S3,MB3,F]  144-7-152ms    | [S7,MB0,F]  181-15-196ms   | [S7,MB0,B]  209-53-262ms   | [S7,MB1,F]  263-19-282ms   | [S7,MB1,B]  294-56-351ms   | [S7,MB2,F]  351-21-373ms   | [S7,MB2,B]  384-57-442ms   | [S7,MB3,F]  442-21-464ms   | [S7,MB3,B]  475-57-533ms   | [S3,MB4,F]  533-12-546ms   | [S3,MB0,B]  546-22-569ms   | [S3,MB5,F]  565-11-576ms   | [S3,MB1,B]  576-23-599ms   | [S3,MB6,F]  595-10-606ms   | [S3,MB2,B]  606-22-629ms   | [S3,MB7,F]  625-10-635ms   | [S3,MB3,B]  636-22-658ms   | [S7,MB4,F]  656-18-675ms   | [S7,MB4,B]  687-56-743ms   | [S7,MB5,F]  743-21-764ms   | [S7,MB5,B]  776-57-833ms   | [S7,MB6,F]  833-21-855ms   | [S7,MB6,B]  866-57-924ms   | [S7,MB7,F]  924-21-945ms   | [S7,MB7,B]  957-57-1015ms  | [S3,MB4,B]  1014-25-1040ms | [S3,MB5,B]  1038-24-1062ms | [S3,MB6,B]  1063-23-1087ms | [S3,MB7,B]  1087-23-1111ms
[rank1]:2025-12-24 22:33:37,184 - Process group destroyed
[rank2]:2025-12-24 22:33:37,124 - Process group destroyed
[rank3]:2025-12-24 22:33:37,342 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/pipeline_schedule/251224_2233_thry_final800_rank3.svg
[rank3]:			> Batch Time: 590.49 ms, GPU Bubble Ratio: 15.79%, 15.79%, 15.79%, 15.79%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-10-10ms      | [S0,MB1,F]  10-10-20ms     | [S0,MB2,F]  20-10-31ms     | [S0,MB3,F]  31-10-41ms     | [S4,MB0,F]  41-10-51ms     | [S4,MB1,F]  51-10-62ms     | [S4,MB2,F]  62-10-72ms     | [S4,MB3,F]  72-10-82ms     | [S0,MB4,F]  82-10-93ms     | [S0,MB5,F]  93-10-103ms    | [S0,MB6,F]  103-10-113ms   | [S4,MB0,B]  145-20-165ms   | [S0,MB7,F]  165-10-176ms   | [S4,MB1,B]  176-20-196ms   | [S4,MB4,F]  207-10-217ms   | [S4,MB2,B]  217-20-238ms   | [S4,MB5,F]  238-10-248ms   | [S4,MB3,B]  248-20-269ms   | [S4,MB6,F]  269-10-279ms   | [S0,MB0,B]  279-20-300ms   | [S4,MB7,F]  300-10-310ms   | [S0,MB1,B]  310-20-331ms   | [S0,MB2,B]  331-20-352ms   | [S0,MB3,B]  362-20-383ms   | [S4,MB4,B]  393-20-414ms   | [S4,MB5,B]  424-20-445ms   | [S4,MB6,B]  455-20-476ms   | [S4,MB7,B]  486-20-507ms   | [S0,MB4,B]  507-20-528ms   | [S0,MB5,B]  528-20-549ms   | [S0,MB6,B]  549-20-569ms   | [S0,MB7,B]  569-20-590ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  10-10-20ms     | [S1,MB1,F]  20-10-31ms     | [S1,MB2,F]  31-10-41ms     | [S1,MB3,F]  41-10-51ms     | [S5,MB0,F]  51-10-62ms     | [S5,MB1,F]  62-10-72ms     | [S5,MB2,F]  72-10-82ms     | [S5,MB3,F]  82-10-93ms     | [S1,MB4,F]  93-10-103ms    | [S5,MB0,B]  124-20-145ms   | [S1,MB5,F]  145-10-155ms   | [S5,MB1,B]  155-20-176ms   | [S1,MB6,F]  176-10-186ms   | [S5,MB2,B]  186-20-207ms   | [S1,MB7,F]  207-10-217ms   | [S5,MB3,B]  217-20-238ms   | [S5,MB4,F]  238-10-248ms   | [S1,MB0,B]  248-20-269ms   | [S5,MB5,F]  269-10-279ms   | [S1,MB1,B]  279-20-300ms   | [S5,MB6,F]  300-10-310ms   | [S1,MB2,B]  310-20-331ms   | [S5,MB7,F]  331-10-341ms   | [S1,MB3,B]  341-20-362ms   | [S5,MB4,B]  372-20-393ms   | [S5,MB5,B]  404-20-424ms   | [S5,MB6,B]  435-20-455ms   | [S5,MB7,B]  466-20-486ms   | [S1,MB4,B]  486-20-507ms   | [S1,MB5,B]  507-20-528ms   | [S1,MB6,B]  528-20-549ms   | [S1,MB7,B]  549-20-569ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-10-31ms     | [S2,MB1,F]  31-10-41ms     | [S2,MB2,F]  41-10-51ms     | [S2,MB3,F]  51-10-62ms     | [S6,MB0,F]  62-10-72ms     | [S6,MB1,F]  72-10-82ms     | [S6,MB2,F]  82-10-93ms     | [S6,MB0,B]  103-20-124ms   | [S6,MB3,F]  124-10-134ms   | [S6,MB1,B]  134-20-155ms   | [S2,MB4,F]  155-10-165ms   | [S6,MB2,B]  165-20-186ms   | [S2,MB5,F]  186-10-196ms   | [S6,MB3,B]  196-20-217ms   | [S2,MB6,F]  217-10-227ms   | [S2,MB0,B]  227-20-248ms   | [S2,MB7,F]  248-10-258ms   | [S2,MB1,B]  258-20-279ms   | [S6,MB4,F]  279-10-290ms   | [S2,MB2,B]  290-20-310ms   | [S6,MB5,F]  310-10-321ms   | [S2,MB3,B]  321-20-341ms   | [S6,MB6,F]  341-10-352ms   | [S6,MB4,B]  352-20-372ms   | [S6,MB7,F]  372-10-383ms   | [S6,MB5,B]  383-20-404ms   | [S6,MB6,B]  414-20-435ms   | [S6,MB7,B]  445-20-466ms   | [S2,MB4,B]  466-20-486ms   | [S2,MB5,B]  486-20-507ms   | [S2,MB6,B]  507-20-528ms   | [S2,MB7,B]  528-20-549ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  31-10-41ms     | [S3,MB1,F]  41-10-51ms     | [S3,MB2,F]  51-10-62ms     | [S3,MB3,F]  62-10-72ms     | [S7,MB0,F]  72-10-82ms     | [S7,MB0,B]  82-20-103ms    | [S7,MB1,F]  103-10-113ms   | [S7,MB1,B]  113-20-134ms   | [S7,MB2,F]  134-10-145ms   | [S7,MB2,B]  145-20-165ms   | [S7,MB3,F]  165-10-176ms   | [S7,MB3,B]  176-20-196ms   | [S3,MB4,F]  196-10-207ms   | [S3,MB0,B]  207-20-227ms   | [S3,MB5,F]  227-10-238ms   | [S3,MB1,B]  238-20-258ms   | [S3,MB6,F]  258-10-269ms   | [S3,MB2,B]  269-20-290ms   | [S3,MB7,F]  290-10-300ms   | [S3,MB3,B]  300-20-321ms   | [S7,MB4,F]  321-10-331ms   | [S7,MB4,B]  331-20-352ms   | [S7,MB5,F]  352-10-362ms   | [S7,MB5,B]  362-20-383ms   | [S7,MB6,F]  383-10-393ms   | [S7,MB6,B]  393-20-414ms   | [S7,MB7,F]  414-10-424ms   | [S7,MB7,B]  424-20-445ms   | [S3,MB4,B]  445-20-466ms   | [S3,MB5,B]  466-20-486ms   | [S3,MB6,B]  486-20-507ms   | [S3,MB7,B]  507-20-528ms  
[rank3]:2025-12-24 22:33:37,389 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank3/251224_2233_stage3_final800.svg
[rank3]:2025-12-24 22:33:37,435 - âœ… Frozen Ratio History of Rank 3 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_ratio_history/rank3/251224_2233_stage7_final800.svg
[rank3]:2025-12-24 22:33:37,518 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1/frozen_params_histogram/251224_2233_rank3_stage7.svg
[rank3]:	> Counts Sum: 0, Total Sum: 825 (0.00%), Ratio(%) per element: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-24 22:33:37,519 - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–‚â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–ˆâ–†â–ƒâ–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–ˆâ–†â–ƒâ–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 4.64002
[rank3]:wandb:               final/avg_loss 0.24743
[rank3]:wandb:             final/avg_mfu(%) 16.25649
[rank3]:wandb:             final/avg_tflops 55.2078
[rank3]:wandb:    final/avg_throughput(tps) 7062.04284
[rank3]:wandb:              final/grad_norm 1.11717
[rank3]:wandb:               final/max_loss 0.24743
[rank3]:wandb:                    grad_norm 1.11717
[rank3]:wandb: loss_metrics/global_avg_loss 0.24743
[rank3]:wandb: loss_metrics/global_max_loss 0.24743
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1224_Interleaved1F1B_auto_42_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/q2b0lurf
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1224_Interleaved1F1B_auto_42_dm1/20251224-2127/wandb/run-20251224_212749-q2b0lurf/logs
[rank3]:2025-12-24 22:33:38,635 - Process group destroyed
[rank0]:2025-12-24 22:33:39,055 - Training completed
[rank0]:2025-12-24 22:33:39,055 - Destroying the purge thread.
[rank0]:2025-12-24 22:33:39,219 - Process group destroyed
[rank1]:Stage 1: Modules to keep: {'layers.4', 'layers.3', 'layers.2'}
[rank1]:Stage 5: Modules to keep: {'layers.11', 'layers.12'}
[rank0]:Stage 0: Modules to keep: {'layers.1', 'tok_embeddings', 'layers.0'}
[rank0]:Stage 4: Modules to keep: {'layers.10', 'layers.9'}
[rank2]:Stage 2: Modules to keep: {'layers.6', 'layers.5'}
[rank2]:Stage 6: Modules to keep: {'layers.13', 'layers.14'}
[rank3]:Stage 3: Modules to keep: {'layers.7', 'layers.8'}
[rank3]:Stage 7: Modules to keep: {'layers.15', 'output', 'norm'}
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1224.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 but debugged requires_grad bug
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1224_Interleaved1F1B_auto_42_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1224_Interleaved1F1B_auto_42_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1224_Interleaved1F1B_auto_42_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1224_Interleaved1F1B_auto_42_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_auto_42_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1224_Interleaved1F1B_auto_42_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 42
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: Interleaved1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 4
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 2
[rank3]:		- stages_list: [3, 7]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1224_Interleaved1F1B_auto_42_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1224_Interleaved1F1B_auto_42_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: auto
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.01
[rank3]:		- percentile: 80
[rank3]:
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
