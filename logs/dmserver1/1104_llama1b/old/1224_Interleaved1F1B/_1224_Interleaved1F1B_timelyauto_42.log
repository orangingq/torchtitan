
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 12. 24. (ìˆ˜) 18:21:43 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 2,3,4,5
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/1224_Interleaved1F1B_timelyauto_42.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 but debugged requires_grad bug

âœ”ï¸Running with timelyauto x Interleaved1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1224.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 but debugged requires_grad bug
" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=timelyauto --freezing.threshold=0.01 --freezing.percentile=80 --freezing.max_freeze_ratio=0.8
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank2]:2025-12-24 18:21:49,827 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank2]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank2]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank2]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank2]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank2]:1224: everything same as 1109 but debugged requires_grad bug
[rank2]:"
[rank0]:2025-12-24 18:21:49,826 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank0]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank0]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank0]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank0]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank0]:1224: everything same as 1109 but debugged requires_grad bug
[rank0]:"
[rank1]:2025-12-24 18:21:49,882 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank1]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank1]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank1]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank1]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank1]:1224: everything same as 1109 but debugged requires_grad bug
[rank1]:"
[rank2]:2025-12-24 18:21:50,059 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-12-24 18:21:50,061 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-24 18:21:50,052 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-12-24 18:21:50,054 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-24 18:21:50,058 - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-12-24 18:21:50,059 - Loading tokenizer from tokenizer.json
[rank1]:2025-12-24 18:21:50,110 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-12-24 18:21:50,113 - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-12-24 18:21:50,090 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 but debugged requires_grad bug
[rank3]:"
[rank3]:2025-12-24 18:21:50,263 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-12-24 18:21:50,266 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-24 18:21:50,452 - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank2]:2025-12-24 18:21:53,341 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-12-24 18:21:53,379 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-24 18:21:53,320 - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank2]:2025-12-24 18:21:53,405 - PP rank 2 is building stage_idx 2 with modules ['layers.5', 'layers.6']
[rank2]:2025-12-24 18:21:53,418 - PP rank 2 is building stage_idx 6 with modules ['layers.13', 'layers.14']
[rank2]:2025-12-24 18:21:53,419 - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank0]:2025-12-24 18:21:53,468 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-12-24 18:21:53,491 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-12-24 18:21:53,529 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-24 18:21:53,557 - PP rank 1 is building stage_idx 1 with modules ['layers.2', 'layers.3', 'layers.4']
[rank1]:2025-12-24 18:21:53,570 - PP rank 1 is building stage_idx 5 with modules ['layers.11', 'layers.12']
[rank1]:2025-12-24 18:21:53,571 - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank0]:2025-12-24 18:21:53,508 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-24 18:21:53,509 - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-12-24 18:21:53,535 - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1']
[rank0]:2025-12-24 18:21:53,548 - PP rank 0 is building stage_idx 4 with modules ['layers.9', 'layers.10']
[rank0]:2025-12-24 18:21:53,549 - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank2]:2025-12-24 18:21:53,608 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-24 18:21:53,608 - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-12-24 18:21:53,608 - CUDA memory usage for model: 0.92GiB(1.94%)
[rank1]:2025-12-24 18:21:53,754 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-24 18:21:53,754 - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-12-24 18:21:53,755 - CUDA memory usage for model: 1.13GiB(2.39%)
[rank0]:2025-12-24 18:21:53,742 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-24 18:21:53,742 - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-12-24 18:21:53,742 - CUDA memory usage for model: 1.90GiB(3.99%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run o3o10m6u
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1224_Interleaved1F1B_timelyauto_42_dm1/20251224-1821/wandb/run-20251224_182155-o3o10m6u
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1224_Interleaved1F1B_timelyauto_42_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/o3o10m6u
[rank3]:2025-12-24 18:21:56,363 - WandB logging enabled
[rank3]:2025-12-24 18:21:56,364 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-12-24 18:21:56,404 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-24 18:21:56,432 - PP rank 3 is building stage_idx 3 with modules ['layers.7', 'layers.8']
[rank3]:2025-12-24 18:21:56,445 - PP rank 3 is building stage_idx 7 with modules ['layers.15', 'norm', 'output']
[rank3]:2025-12-24 18:21:56,447 - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank1]:2025-12-24 18:21:56,650 - Mixed precision training with TP or PP is handled by autocast
[rank2]:2025-12-24 18:21:56,650 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-24 18:21:56,650 - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1224_Interleaved1F1B_timelyauto_42_dm1
[rank0]:2025-12-24 18:21:56,652 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-24 18:21:56,653 - Trainer is initialized with local batch size 32, global batch size 128, gradient accumulation steps 4, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2025-12-24 18:21:56,653 - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank3]:2025-12-24 18:21:56,633 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-24 18:21:56,634 - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-12-24 18:21:56,634 - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2025-12-24 18:21:56,650 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-24 18:21:59,124 - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-12-24 18:21:59,124 - Finished loading the checkpoint in 2.47 seconds.
[rank0]:2025-12-24 18:21:59,124 - Training starts at step 1
[rank2]:2025-12-24 18:22:04,702 -  step:  1  loss: -4.0000  grad_norm: 203.0667  memory: 10.24GiB(21.56%)  tps: 2,894  tflops: 22.62  mfu: 7.25%
[rank2]:2025-12-24 18:22:04,702 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-24 18:22:04,741 -  step:  1  loss: -4.0000  grad_norm: 203.0667  memory: 16.58GiB(34.89%)  tps: 2,917  tflops: 22.81  mfu: 7.31%
[rank0]:2025-12-24 18:22:04,741 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-12-24 18:22:04,716 -  step:  1  loss: 10.6092  grad_norm: 203.0667  memory: 25.52GiB(53.71%)  tps: 3,944  tflops: 30.83  mfu: 9.88%
[rank3]:2025-12-24 18:22:04,716 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-12-24 18:22:04,709 -  step:  1  loss: -4.0000  grad_norm: 203.0667  memory: 16.23GiB(34.16%)  tps: 2,931  tflops: 22.91  mfu: 7.34%
[rank1]:2025-12-24 18:22:04,709 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-24 18:26:11,626 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-24 18:26:16,617 - Avg. fwd time: 14.5204 / Avg. bwd time: 40.5225 / Avg. batch time: 1097.4865 (ms) / GPU bubble ratio: 19.75%
[rank2]:2025-12-24 18:26:16,668 - Avg. fwd time: 7.8355 / Avg. bwd time: 18.8804 / Avg. batch time: 1159.3585 (ms) / GPU bubble ratio: 63.13%
[rank1]:2025-12-24 18:26:16,714 - Avg. fwd time: 9.9612 / Avg. bwd time: 24.2595 / Avg. batch time: 1218.6293 (ms) / GPU bubble ratio: 55.07%
[rank2]:2025-12-24 18:26:16,767 -  step: 50  loss: -4.0000  grad_norm: 23.9302  memory: 12.06GiB(25.39%)  tps: 6,370  tflops: 49.80  mfu: 15.96%
[rank1]:2025-12-24 18:26:16,771 -  step: 50  loss: -4.0000  grad_norm: 23.9302  memory: 18.49GiB(38.93%)  tps: 6,370  tflops: 49.80  mfu: 15.96%
[rank3]:2025-12-24 18:26:16,779 -  step: 50  loss:  9.8825  grad_norm: 23.9302  memory: 29.23GiB(61.52%)  tps: 6,370  tflops: 49.80  mfu: 15.96%
[rank0]:2025-12-24 18:26:16,746 - Avg. fwd time: 8.3119 / Avg. bwd time: 21.1424 / Avg. batch time: 1257.5163 (ms) / GPU bubble ratio: 62.52%
[rank0]:2025-12-24 18:26:16,783 -  step: 50  loss: -4.0000  grad_norm: 23.9302  memory: 20.42GiB(42.99%)  tps: 6,370  tflops: 49.80  mfu: 15.96%
[rank3]:2025-12-24 18:27:02,729 - [Step 60] ã€°ï¸ Monitoring Upperbound
[rank3]:2025-12-24 18:27:54,254 - [Step 70] â³ Monitoring Upperbound... (276/286)
[rank1]:2025-12-24 18:27:54,728 - [Step 70] â³ Monitoring Upperbound... (276/286)
[rank0]:2025-12-24 18:27:54,753 - [Step 70] â³ Monitoring Upperbound... (276/286)
[rank2]:2025-12-24 18:27:54,692 - [Step 70] â³ Monitoring Upperbound... (276/286)
[rank3]:2025-12-24 18:28:45,847 - [Step 80] âœ”ï¸  Setting Upperbound
[rank3]:2025-12-24 18:28:46,399 - [Step 80] ã€°ï¸ Monitoring Lowerbound
[rank3]:2025-12-24 18:30:01,742 - [Step 100] âœ”ï¸  Setting Lowerbound
[rank0]:2025-12-24 18:30:02,174 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-24 18:30:02,217 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.37/0.37, [MB4] 0.25/0.25, [MB5] 0.00/0.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank2]:2025-12-24 18:30:02,216 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.72/0.72, [MB4] 1.00/1.00, [MB5] 0.82/0.82, [MB6] 0.56/0.56, [MB7] 1.00/1.00
[rank1]:2025-12-24 18:30:02,216 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-12-24 18:30:02,472 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/pipeline_schedule/251224_1830_max_batch_time.svg
[rank3]:			> Batch Time: 1012.48 ms, GPU Bubble Ratio: 53.29%, 45.52%, 57.60%, 12.45%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-7-31ms      | [S4,MB0,F]  36-9-46ms      | [S4,MB1,F]  46-8-54ms      | [S4,MB2,F]  56-8-65ms      | [S4,MB3,F]  67-8-76ms      | [S0,MB4,F]  76-8-84ms      | [S0,MB5,F]  84-7-92ms      | [S0,MB6,F]  92-8-101ms     | [S4,MB0,B]  177-19-196ms   | [S0,MB7,F]  196-7-203ms    | [S4,MB1,B]  252-19-272ms   | [S4,MB4,F]  385-8-394ms    | [S4,MB2,B]  394-19-413ms   | [S4,MB5,F]  421-8-430ms    | [S4,MB3,B]  430-19-449ms   | [S4,MB6,F]  456-8-465ms    | [S0,MB0,B]  465-25-490ms   | [S4,MB7,F]  490-7-497ms    | [S0,MB1,B]  498-24-523ms   | [S0,MB2,B]  541-23-565ms   | [S0,MB3,B]  585-23-609ms   | [S4,MB4,B]  626-18-645ms   | [S4,MB5,B]  705-18-723ms   | [S4,MB6,B]  784-18-802ms   | [S4,MB7,B]  864-18-882ms   | [S0,MB4,B]  900-23-923ms   | [S0,MB5,B]  928-23-952ms   | [S0,MB6,B]  957-23-981ms   | [S0,MB7,B]  988-23-1012ms 
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  20-10-31ms     | [S1,MB2,F]  31-10-42ms     | [S1,MB3,F]  42-10-53ms     | [S5,MB0,F]  53-8-61ms      | [S5,MB1,F]  61-7-69ms      | [S5,MB2,F]  69-7-76ms      | [S5,MB3,F]  76-7-83ms      | [S1,MB4,F]  84-11-95ms     | [S5,MB0,B]  158-18-177ms   | [S1,MB5,F]  177-12-189ms   | [S5,MB1,B]  233-18-252ms   | [S1,MB6,F]  252-11-264ms   | [S5,MB2,B]  313-18-332ms   | [S1,MB7,F]  332-11-343ms   | [S5,MB3,B]  393-19-412ms   | [S5,MB4,F]  412-7-420ms    | [S1,MB0,B]  430-29-459ms   | [S5,MB5,F]  459-9-468ms    | [S1,MB1,B]  468-30-498ms   | [S5,MB6,F]  498-10-508ms   | [S1,MB2,B]  508-32-541ms   | [S5,MB7,F]  541-10-551ms   | [S1,MB3,B]  551-33-585ms   | [S5,MB4,B]  608-18-626ms   | [S5,MB5,B]  687-18-705ms   | [S5,MB6,B]  766-18-784ms   | [S5,MB7,B]  845-18-864ms   | [S1,MB4,B]  872-27-900ms   | [S1,MB5,B]  900-28-928ms   | [S1,MB6,B]  928-29-957ms   | [S1,MB7,B]  957-30-988ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  31-7-38ms      | [S2,MB2,F]  42-7-49ms      | [S2,MB3,F]  53-7-60ms      | [S6,MB0,F]  61-7-69ms      | [S6,MB1,F]  69-7-77ms      | [S6,MB2,F]  77-7-84ms      | [S6,MB0,B]  139-19-158ms   | [S6,MB3,F]  158-8-166ms    | [S6,MB1,B]  214-19-233ms   | [S2,MB4,F]  233-8-242ms    | [S6,MB2,B]  294-19-313ms   | [S2,MB5,F]  313-7-320ms    | [S6,MB3,B]  373-19-393ms   | [S2,MB6,F]  393-8-401ms    | [S2,MB0,B]  410-19-430ms   | [S2,MB7,F]  430-8-438ms    | [S2,MB1,B]  445-19-465ms   | [S6,MB4,F]  465-8-473ms    | [S2,MB2,B]  479-19-499ms   | [S6,MB5,F]  499-7-507ms    | [S2,MB3,B]  513-20-533ms   | [S6,MB6,F]  533-7-541ms    | [S6,MB4,B]  588-19-608ms   | [S6,MB7,F]  608-8-616ms    | [S6,MB5,B]  668-18-687ms   | [S6,MB6,B]  748-18-766ms   | [S6,MB7,B]  827-17-845ms   | [S2,MB4,B]  854-18-872ms   | [S2,MB5,B]  878-18-896ms   | [S2,MB6,B]  903-18-921ms   | [S2,MB7,B]  927-18-945ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-7-36ms      | [S3,MB1,F]  38-6-45ms      | [S3,MB2,F]  49-6-56ms      | [S3,MB3,F]  60-7-67ms      | [S7,MB0,F]  69-15-85ms     | [S7,MB0,B]  85-53-139ms    AFR(10):0.9091 | [S7,MB1,F]  139-19-158ms   | [S7,MB1,B]  158-56-214ms   AFR(10):0.9091 | [S7,MB2,F]  214-21-236ms   | [S7,MB2,B]  236-57-294ms   AFR(10):0.9091 | [S7,MB3,F]  294-21-315ms   | [S7,MB3,B]  315-58-373ms   AFR(10):0.9091 | [S3,MB4,F]  373-12-385ms   | [S3,MB0,B]  385-24-410ms   AFR(10):1.0000 | [S3,MB5,F]  410-11-421ms   | [S3,MB1,B]  421-24-445ms   AFR(10):1.0000 | [S3,MB6,F]  445-10-456ms   | [S3,MB2,B]  456-23-479ms   AFR(10):1.0000 | [S3,MB7,F]  479-10-490ms   | [S3,MB3,B]  490-22-513ms   AFR(10):1.0000 | [S7,MB4,F]  513-18-531ms   | [S7,MB4,B]  531-57-588ms   AFR(10):0.9091 | [S7,MB5,F]  588-21-610ms   | [S7,MB5,B]  610-58-668ms   AFR(10):0.9091 | [S7,MB6,F]  668-21-690ms   | [S7,MB6,B]  690-58-748ms   AFR(10):0.9091 | [S7,MB7,F]  748-21-769ms   | [S7,MB7,B]  769-58-827ms   AFR(10):0.9091 | [S3,MB4,B]  827-26-854ms   AFR(10):1.0000 | [S3,MB5,B]  854-24-878ms   AFR(10):1.0000 | [S3,MB6,B]  878-24-903ms   AFR(10):1.0000 | [S3,MB7,B]  903-23-927ms   AFR(10):1.0000
[rank3]:2025-12-24 18:30:02,702 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/pipeline_schedule/251224_1830_min_batch_time.svg
[rank3]:			> Batch Time: 673.69 ms, GPU Bubble Ratio: 68.81%, 47.57%, 57.81%, 10.36%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-7-31ms      | [S4,MB0,F]  36-9-46ms      | [S4,MB1,F]  46-8-54ms      | [S4,MB2,F]  56-8-65ms      | [S4,MB3,F]  67-8-76ms      | [S0,MB4,F]  76-8-84ms      | [S0,MB5,F]  84-7-92ms      | [S0,MB6,F]  92-8-101ms     | [S4,MB0,B]  138-10-148ms   | [S0,MB7,F]  148-7-155ms    | [S4,MB1,B]  190-10-201ms   | [S4,MB4,F]  295-8-303ms    | [S4,MB2,B]  303-10-313ms   | [S4,MB5,F]  318-8-327ms    | [S4,MB3,B]  327-10-337ms   | [S4,MB6,F]  342-8-351ms    | [S0,MB0,B]  351-0-351ms    | [S4,MB7,F]  365-7-373ms    | [S0,MB1,B]  373-0-373ms    | [S0,MB2,B]  384-0-384ms    | [S0,MB3,B]  409-0-409ms    | [S4,MB4,B]  449-9-458ms    | [S4,MB5,B]  505-9-514ms    | [S4,MB6,B]  559-9-569ms    | [S4,MB7,B]  615-9-624ms    | [S0,MB4,B]  631-0-631ms    | [S0,MB5,B]  645-0-645ms    | [S0,MB6,B]  659-0-659ms    | [S0,MB7,B]  673-0-673ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  20-10-31ms     | [S1,MB2,F]  31-10-42ms     | [S1,MB3,F]  42-10-53ms     | [S5,MB0,F]  53-8-61ms      | [S5,MB1,F]  61-7-69ms      | [S5,MB2,F]  69-7-76ms      | [S5,MB3,F]  76-7-83ms      | [S1,MB4,F]  84-11-95ms     | [S5,MB0,B]  128-9-138ms    | [S1,MB5,F]  138-12-150ms   | [S5,MB1,B]  181-9-190ms    | [S1,MB6,F]  190-11-202ms   | [S5,MB2,B]  236-9-246ms    | [S1,MB7,F]  246-11-257ms   | [S5,MB3,B]  293-10-303ms   | [S5,MB4,F]  303-7-311ms    | [S1,MB0,B]  318-15-333ms   | [S5,MB5,F]  333-9-342ms    | [S1,MB1,B]  342-15-358ms   | [S5,MB6,F]  358-10-368ms   | [S1,MB2,B]  368-15-384ms   | [S5,MB7,F]  384-10-394ms   | [S1,MB3,B]  394-15-409ms   | [S5,MB4,B]  440-9-449ms    | [S5,MB5,B]  496-9-505ms    | [S5,MB6,B]  550-9-559ms    | [S5,MB7,B]  605-9-615ms    | [S1,MB4,B]  617-13-631ms   | [S1,MB5,B]  631-14-645ms   | [S1,MB6,B]  645-13-659ms   | [S1,MB7,B]  659-14-673ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  31-7-38ms      | [S2,MB2,F]  42-7-49ms      | [S2,MB3,F]  53-7-60ms      | [S6,MB0,F]  61-7-69ms      | [S6,MB1,F]  69-7-77ms      | [S6,MB2,F]  77-7-84ms      | [S6,MB0,B]  118-10-128ms   | [S6,MB3,F]  128-8-137ms    | [S6,MB1,B]  170-10-181ms   | [S2,MB4,F]  181-8-189ms    | [S6,MB2,B]  226-10-236ms   | [S2,MB5,F]  236-7-244ms    | [S6,MB3,B]  282-10-293ms   | [S2,MB6,F]  293-8-301ms    | [S2,MB0,B]  307-10-318ms   | [S2,MB7,F]  318-8-326ms    | [S2,MB1,B]  331-10-342ms   | [S6,MB4,F]  342-8-351ms    | [S2,MB2,B]  355-10-365ms   | [S6,MB5,F]  365-7-373ms    | [S2,MB3,B]  377-10-387ms   | [S6,MB6,F]  387-7-395ms    | [S6,MB4,B]  429-10-440ms   | [S6,MB7,F]  440-8-448ms    | [S6,MB5,B]  486-10-496ms   | [S6,MB6,B]  541-9-550ms    | [S6,MB7,B]  596-9-605ms    | [S2,MB4,B]  608-9-617ms    | [S2,MB5,B]  620-9-630ms    | [S2,MB6,B]  632-9-641ms    | [S2,MB7,B]  644-9-654ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-7-36ms      | [S3,MB1,F]  38-6-45ms      | [S3,MB2,F]  49-6-56ms      | [S3,MB3,F]  60-7-67ms      | [S7,MB0,F]  69-15-85ms     | [S7,MB0,B]  85-32-118ms    AFR(10):0.9091 | [S7,MB1,F]  118-19-137ms   | [S7,MB1,B]  137-33-170ms   AFR(10):0.9091 | [S7,MB2,F]  170-21-192ms   | [S7,MB2,B]  192-33-226ms   AFR(10):0.9091 | [S7,MB3,F]  226-21-247ms   | [S7,MB3,B]  247-34-282ms   AFR(10):0.9091 | [S3,MB4,F]  282-12-295ms   | [S3,MB0,B]  295-12-307ms   AFR(10):1.0000 | [S3,MB5,F]  307-11-318ms   | [S3,MB1,B]  318-13-331ms   AFR(10):1.0000 | [S3,MB6,F]  331-10-342ms   | [S3,MB2,B]  342-12-355ms   AFR(10):1.0000 | [S3,MB7,F]  355-10-365ms   | [S3,MB3,B]  365-12-377ms   AFR(10):1.0000 | [S7,MB4,F]  377-18-396ms   | [S7,MB4,B]  396-33-429ms   AFR(10):0.9091 | [S7,MB5,F]  429-21-451ms   | [S7,MB5,B]  451-34-486ms   AFR(10):0.9091 | [S7,MB6,F]  486-21-507ms   | [S7,MB6,B]  507-33-541ms   AFR(10):0.9091 | [S7,MB7,F]  541-21-562ms   | [S7,MB7,B]  562-34-596ms   AFR(10):0.9091 | [S3,MB4,B]  596-11-608ms   AFR(10):1.0000 | [S3,MB5,B]  608-12-620ms   AFR(10):1.0000 | [S3,MB6,B]  620-11-632ms   AFR(10):1.0000 | [S3,MB7,B]  632-12-644ms   AFR(10):1.0000
[rank3]:2025-12-24 18:30:02,950 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/pipeline_schedule/251224_1830_frozen_pipeline_schedule.svg
[rank3]:			> Batch Time: 719.92 ms, GPU Bubble Ratio: 42.12%, 33.05%, 45.54%, 8.92%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-7-31ms      | [S4,MB0,F]  36-9-46ms      | [S4,MB1,F]  46-8-54ms      | [S4,MB2,F]  56-8-65ms      | [S4,MB3,F]  67-8-76ms      | [S0,MB4,F]  76-8-84ms      | [S0,MB5,F]  84-7-92ms      | [S0,MB6,F]  92-8-101ms     | [S4,MB0,B]  177-19-196ms   | [S0,MB7,F]  196-7-203ms    | [S4,MB1,B]  243-19-262ms   | [S4,MB4,F]  329-8-337ms    | [S4,MB2,B]  337-19-357ms   | [S4,MB5,F]  357-8-365ms    | [S4,MB3,B]  365-19-384ms   | [S4,MB6,F]  384-8-393ms    | [S0,MB0,B]  393-25-418ms   | [S4,MB7,F]  418-7-426ms    | [S0,MB1,B]  433-24-457ms   | [S0,MB2,B]  475-23-499ms   | [S0,MB3,B]  520-23-543ms   | [S4,MB4,B]  543-18-562ms   | [S4,MB5,B]  569-18-587ms   | [S4,MB6,B]  624-18-642ms   | [S4,MB7,B]  663-14-678ms   | [S0,MB4,B]  678-17-696ms   | [S0,MB5,B]  696-23-719ms   | [S0,MB6,B]  719-0-719ms    | [S0,MB7,B]  719-0-719ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  20-10-31ms     | [S1,MB2,F]  31-10-42ms     | [S1,MB3,F]  42-10-53ms     | [S5,MB0,F]  53-8-61ms      | [S5,MB1,F]  61-7-69ms      | [S5,MB2,F]  69-7-76ms      | [S5,MB3,F]  76-7-83ms      | [S1,MB4,F]  84-11-95ms     | [S5,MB0,B]  158-18-177ms   | [S1,MB5,F]  177-12-189ms   | [S5,MB1,B]  224-18-243ms   | [S1,MB6,F]  243-11-255ms   | [S5,MB2,B]  280-18-299ms   | [S1,MB7,F]  299-11-310ms   | [S5,MB3,B]  336-19-356ms   | [S5,MB4,F]  356-7-363ms    | [S1,MB0,B]  364-29-393ms   | [S5,MB5,F]  393-9-402ms    | [S1,MB1,B]  402-30-433ms   | [S5,MB6,F]  433-10-443ms   | [S1,MB2,B]  443-32-475ms   | [S5,MB7,F]  475-10-486ms   | [S1,MB3,B]  486-33-520ms   | [S5,MB4,B]  520-18-539ms   | [S5,MB5,B]  550-18-569ms   | [S5,MB6,B]  605-18-624ms   | [S5,MB7,B]  654-9-663ms    | [S1,MB4,B]  663-13-677ms   | [S1,MB5,B]  677-14-691ms   | [S1,MB6,B]  691-13-705ms   | [S1,MB7,B]  705-14-719ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  31-7-38ms      | [S2,MB2,F]  42-7-49ms      | [S2,MB3,F]  53-7-60ms      | [S6,MB0,F]  61-7-69ms      | [S6,MB1,F]  69-7-77ms      | [S6,MB2,F]  77-7-84ms      | [S6,MB0,B]  139-19-158ms   | [S6,MB3,F]  158-8-166ms    | [S6,MB1,B]  205-19-224ms   | [S2,MB4,F]  224-8-233ms    | [S6,MB2,B]  260-19-280ms   | [S2,MB5,F]  280-7-287ms    | [S6,MB3,B]  317-19-336ms   | [S2,MB6,F]  336-8-345ms    | [S2,MB0,B]  345-19-364ms   | [S2,MB7,F]  364-8-373ms    | [S2,MB1,B]  373-19-392ms   | [S6,MB4,F]  392-8-401ms    | [S2,MB2,B]  401-19-421ms   | [S6,MB5,F]  421-7-429ms    | [S2,MB3,B]  429-20-449ms   | [S6,MB6,F]  449-7-457ms    | [S6,MB4,B]  475-19-495ms   | [S6,MB7,F]  495-8-503ms    | [S6,MB5,B]  532-18-550ms   | [S6,MB6,B]  587-18-605ms   | [S6,MB7,B]  643-11-654ms   | [S2,MB4,B]  654-9-663ms    | [S2,MB5,B]  667-10-677ms   | [S2,MB6,B]  678-13-691ms   | [S2,MB7,B]  696-9-705ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-7-36ms      | [S3,MB1,F]  38-6-45ms      | [S3,MB2,F]  49-6-56ms      | [S3,MB3,F]  60-7-67ms      | [S7,MB0,F]  69-15-85ms     | [S7,MB0,B]  85-53-139ms    AFR(10):0.9091 | [S7,MB1,F]  139-19-158ms   | [S7,MB1,B]  158-46-205ms   AFR(10):0.9091 | [S7,MB2,F]  205-21-226ms   | [S7,MB2,B]  226-33-260ms   AFR(10):0.9091 | [S7,MB3,F]  260-21-282ms   | [S7,MB3,B]  282-34-317ms   AFR(10):0.9091 | [S3,MB4,F]  317-12-329ms   | [S3,MB0,B]  329-12-342ms   AFR(10):1.0000 | [S3,MB5,F]  342-11-353ms   | [S3,MB1,B]  353-14-367ms   AFR(10):1.0000 | [S3,MB6,F]  367-10-378ms   | [S3,MB2,B]  378-12-390ms   AFR(10):1.0000 | [S3,MB7,F]  390-10-401ms   | [S3,MB3,B]  401-22-424ms   AFR(10):1.0000 | [S7,MB4,F]  424-18-442ms   | [S7,MB4,B]  442-33-475ms   AFR(10):0.9091 | [S7,MB5,F]  475-21-497ms   | [S7,MB5,B]  497-34-532ms   AFR(10):0.9091 | [S7,MB6,F]  532-21-553ms   | [S7,MB6,B]  553-33-587ms   AFR(10):0.9091 | [S7,MB7,F]  587-21-609ms   | [S7,MB7,B]  609-34-643ms   AFR(10):0.9091 | [S3,MB4,B]  643-11-654ms   AFR(10):1.0000 | [S3,MB5,B]  654-12-667ms   AFR(10):1.0000 | [S3,MB6,B]  667-11-678ms   AFR(10):1.0000 | [S3,MB7,B]  678-17-696ms   AFR(10):1.0000
[rank3]:2025-12-24 18:30:02,951 - 	> Batch Time: 719.92 ms (Average Freeze Ratio: 0.38, Time Reduction Rate: 0.29)
[rank3]:2025-12-24 18:30:02,956 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.40/0.40, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB0] 1.00/1.00, [MB1] 0.89/0.89, [MB2] 1.00/1.00, [MB3] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 0.51/0.51
[rank3]:2025-12-24 18:30:06,731 - Avg. fwd time: 14.2518 / Avg. bwd time: 37.2486 / Avg. batch time: 1042.5219 (ms) / GPU bubble ratio: 20.96%
[rank1]:2025-12-24 18:30:06,794 - Avg. fwd time: 9.9104 / Avg. bwd time: 21.8375 / Avg. batch time: 1157.8657 (ms) / GPU bubble ratio: 56.13%
[rank0]:2025-12-24 18:30:06,803 - Avg. fwd time: 8.2940 / Avg. bwd time: 17.8687 / Avg. batch time: 1191.8081 (ms) / GPU bubble ratio: 64.88%
[rank2]:2025-12-24 18:30:06,765 - Avg. fwd time: 7.7939 / Avg. bwd time: 17.0950 / Avg. batch time: 1102.9282 (ms) / GPU bubble ratio: 63.89%
[rank2]:2025-12-24 18:30:06,825 -  step: 100  loss: -4.0000  grad_norm:  6.3399  memory: 12.06GiB(25.39%)  tps: 7,122  tflops: 55.67  mfu: 17.84%
[rank3]:2025-12-24 18:30:06,837 -  step: 100  loss:  8.9085  grad_norm:  6.3399  memory: 29.23GiB(61.52%)  tps: 7,122  tflops: 55.67  mfu: 17.84%
[rank1]:2025-12-24 18:30:06,829 -  step: 100  loss: -4.0000  grad_norm:  6.3399  memory: 18.49GiB(38.93%)  tps: 7,122  tflops: 55.67  mfu: 17.84%
[rank0]:2025-12-24 18:30:06,840 -  step: 100  loss: -4.0000  grad_norm:  6.3399  memory: 20.42GiB(42.99%)  tps: 7,122  tflops: 55.67  mfu: 17.84%
[rank0]:2025-12-24 18:30:06,909 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/frozen_ratio_history/rank0/251224_1830_stage0_step100.svg
[rank2]:2025-12-24 18:30:06,930 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/frozen_ratio_history/rank2/251224_1830_stage2_step100.svg
[rank1]:2025-12-24 18:30:06,901 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/frozen_ratio_history/rank1/251224_1830_stage1_step100.svg
[rank1]:2025-12-24 18:30:06,938 - âœ… Frozen Ratio History of Rank 1 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/frozen_ratio_history/rank1/251224_1830_stage5_step100.svg
[rank1]:2025-12-24 18:30:06,977 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/afr_time_plot/251224_1830_stage1.svg
[rank0]:2025-12-24 18:30:06,956 - âœ… Frozen Ratio History of Rank 0 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/frozen_ratio_history/rank0/251224_1830_stage4_step100.svg
[rank0]:2025-12-24 18:30:07,002 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/afr_time_plot/251224_1830_stage0.svg
[rank2]:2025-12-24 18:30:06,974 - âœ… Frozen Ratio History of Rank 2 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/frozen_ratio_history/rank2/251224_1830_stage6_step100.svg
[rank2]:2025-12-24 18:30:07,027 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/afr_time_plot/251224_1830_stage2.svg
[rank1]:2025-12-24 18:30:07,013 - âœ… Scatter Plot of Stage 5 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/afr_time_plot/251224_1830_stage5.svg
[rank0]:2025-12-24 18:30:07,043 - âœ… Scatter Plot of Stage 4 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/afr_time_plot/251224_1830_stage4.svg
[rank2]:2025-12-24 18:30:07,066 - âœ… Scatter Plot of Stage 6 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/afr_time_plot/251224_1830_stage6.svg
[rank3]:2025-12-24 18:30:07,074 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/pipeline_schedule/251224_1830_step100_rank3.svg
[rank3]:			> Batch Time: 954.00 ms, GPU Bubble Ratio: 78.05%, 63.37%, 70.51%, 33.80%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-7-31ms      | [S4,MB0,F]  49-9-58ms      | [S4,MB1,F]  87-8-95ms      | [S4,MB2,F]  124-8-133ms    | [S4,MB3,F]  162-8-170ms    | [S0,MB4,F]  170-8-178ms    | [S0,MB5,F]  178-7-186ms    | [S0,MB6,F]  186-8-195ms    | [S4,MB0,B]  342-10-352ms   | [S0,MB7,F]  352-7-359ms    | [S4,MB1,B]  433-10-443ms   | [S4,MB4,F]  471-8-480ms    | [S4,MB2,B]  480-10-490ms   | [S4,MB5,F]  499-8-507ms    | [S4,MB3,B]  508-10-518ms   | [S4,MB6,F]  527-8-535ms    | [S0,MB0,B]  535-0-535ms    | [S4,MB7,F]  553-7-560ms    | [S0,MB1,B]  561-0-561ms    | [S0,MB2,B]  581-0-581ms    | [S0,MB3,B]  641-0-641ms    | [S4,MB4,B]  661-9-670ms    | [S4,MB5,B]  755-9-764ms    | [S4,MB6,B]  818-9-827ms    | [S4,MB7,B]  868-9-877ms    | [S0,MB4,B]  888-0-888ms    | [S0,MB5,B]  913-0-913ms    | [S0,MB6,B]  933-0-933ms    | [S0,MB7,B]  954-0-954ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  49-10-60ms     | [S1,MB2,F]  87-10-98ms     | [S1,MB3,F]  124-10-135ms   | [S5,MB0,F]  162-8-170ms    | [S5,MB1,F]  176-7-183ms    | [S5,MB2,F]  190-7-197ms    | [S5,MB3,F]  269-7-276ms    | [S1,MB4,F]  290-10-301ms   | [S5,MB0,B]  301-9-310ms    | [S1,MB5,F]  335-12-348ms   | [S5,MB1,B]  348-9-357ms    | [S1,MB6,F]  357-11-368ms   | [S5,MB2,B]  432-9-442ms    | [S1,MB7,F]  442-11-453ms   | [S5,MB3,B]  479-10-490ms   | [S5,MB4,F]  490-7-497ms    | [S1,MB0,B]  507-15-522ms   | [S5,MB5,F]  522-8-530ms    | [S1,MB1,B]  534-15-550ms   | [S5,MB6,F]  549-9-558ms    | [S1,MB2,B]  559-15-574ms   | [S5,MB7,F]  574-9-583ms    | [S1,MB3,B]  583-15-598ms   | [S5,MB4,B]  645-9-654ms    | [S5,MB5,B]  724-9-733ms    | [S5,MB6,B]  788-9-797ms    | [S5,MB7,B]  852-9-861ms    | [S1,MB4,B]  868-13-881ms   | [S1,MB5,B]  893-13-906ms   | [S1,MB6,B]  913-13-926ms   | [S1,MB7,B]  933-13-947ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-7-28ms      | [S2,MB1,F]  60-7-67ms      | [S2,MB2,F]  98-7-105ms     | [S2,MB3,F]  135-7-142ms    | [S6,MB0,F]  170-7-178ms    | [S6,MB1,F]  184-7-191ms    | [S6,MB2,F]  263-7-270ms    | [S6,MB0,B]  270-10-280ms   | [S6,MB3,F]  280-8-289ms    | [S6,MB1,B]  324-10-335ms   | [S2,MB4,F]  335-8-343ms    | [S6,MB2,B]  388-10-398ms   | [S2,MB5,F]  398-7-406ms    | [S6,MB3,B]  452-10-463ms   | [S2,MB6,F]  463-7-470ms    | [S2,MB0,B]  479-10-490ms   | [S2,MB7,F]  490-7-497ms    | [S2,MB1,B]  507-10-517ms   | [S6,MB4,F]  517-7-525ms    | [S2,MB2,B]  534-10-544ms   | [S6,MB5,F]  545-8-553ms    | [S2,MB3,B]  557-10-567ms   | [S6,MB6,F]  567-7-575ms    | [S6,MB4,B]  628-10-638ms   | [S6,MB7,F]  638-8-647ms    | [S6,MB5,B]  708-10-718ms   | [S6,MB6,B]  773-9-782ms    | [S6,MB7,B]  837-9-846ms    | [S2,MB4,B]  852-9-861ms    | [S2,MB5,B]  878-9-887ms    | [S2,MB6,B]  893-9-902ms    | [S2,MB7,B]  913-9-922ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-7-36ms      | [S3,MB1,F]  67-6-74ms      | [S3,MB2,F]  105-6-112ms    | [S3,MB3,F]  142-6-149ms    | [S7,MB0,F]  178-15-193ms   | [S7,MB0,B]  205-48-254ms   | [S7,MB1,F]  253-18-272ms   | [S7,MB1,B]  284-33-318ms   | [S7,MB2,F]  318-16-335ms   | [S7,MB2,B]  346-34-381ms   | [S7,MB3,F]  381-17-399ms   | [S7,MB3,B]  411-34-446ms   | [S3,MB4,F]  446-9-456ms    | [S3,MB0,B]  456-12-469ms   | [S3,MB5,F]  469-10-479ms   | [S3,MB1,B]  480-13-493ms   | [S3,MB6,F]  493-10-503ms   | [S3,MB2,B]  503-12-516ms   | [S3,MB7,F]  516-9-526ms    | [S3,MB3,B]  525-12-538ms   | [S7,MB4,F]  540-18-559ms   | [S7,MB4,B]  571-49-620ms   | [S7,MB5,F]  619-19-639ms   | [S7,MB5,B]  650-50-701ms   | [S7,MB6,F]  701-20-721ms   | [S7,MB6,B]  733-33-767ms   | [S7,MB7,F]  767-17-784ms   | [S7,MB7,B]  796-33-830ms   | [S3,MB4,B]  829-11-841ms   | [S3,MB5,B]  841-12-853ms   | [S3,MB6,B]  853-11-864ms   | [S3,MB7,B]  870-12-883ms  
[rank3]:2025-12-24 18:30:07,118 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/frozen_ratio_history/rank3/251224_1830_stage3_step100.svg
[rank3]:2025-12-24 18:30:07,155 - âœ… Frozen Ratio History of Rank 3 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/frozen_ratio_history/rank3/251224_1830_stage7_step100.svg
[rank3]:2025-12-24 18:30:07,193 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/afr_time_plot/251224_1830_stage3.svg
[rank3]:2025-12-24 18:30:07,229 - âœ… Scatter Plot of Stage 7 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/afr_time_plot/251224_1830_stage7.svg
[rank1]:2025-12-24 18:33:44,151 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank0]:2025-12-24 18:33:44,137 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-24 18:33:44,162 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.25/0.37, [MB4] 0.17/0.25, [MB5] 0.00/0.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank2]:2025-12-24 18:33:44,146 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.48/0.72, [MB4] 0.67/1.00, [MB5] 0.55/0.82, [MB6] 0.37/0.56, [MB7] 0.67/1.00
[rank3]:2025-12-24 18:33:44,159 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.27/0.40, [MB2] 0.67/1.00, [MB3] 0.67/1.00, [MB0] 0.67/1.00, [MB1] 0.59/0.89, [MB2] 0.67/1.00, [MB3] 0.00/0.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.34/0.51
[rank2]:2025-12-24 18:33:48,695 - Avg. fwd time: 7.7807 / Avg. bwd time: 17.2719 / Avg. batch time: 1069.3937 (ms) / GPU bubble ratio: 62.52%
[rank3]:2025-12-24 18:33:48,658 - Avg. fwd time: 14.0907 / Avg. bwd time: 35.3786 / Avg. batch time: 1011.1778 (ms) / GPU bubble ratio: 21.72%
[rank1]:2025-12-24 18:33:48,726 - Avg. fwd time: 9.9687 / Avg. bwd time: 21.9457 / Avg. batch time: 1121.8669 (ms) / GPU bubble ratio: 54.48%
[rank1]:2025-12-24 18:33:48,778 -  step: 150  loss: -4.0000  grad_norm: 15.9099  memory: 18.49GiB(38.93%)  tps: 7,382  tflops: 57.71  mfu: 18.50%
[rank0]:2025-12-24 18:33:48,753 - Avg. fwd time: 8.2911 / Avg. bwd time: 18.5314 / Avg. batch time: 1154.8279 (ms) / GPU bubble ratio: 62.84%
[rank0]:2025-12-24 18:33:48,788 -  step: 150  loss: -4.0000  grad_norm: 15.9099  memory: 20.42GiB(42.99%)  tps: 7,382  tflops: 57.71  mfu: 18.50%
[rank2]:2025-12-24 18:33:48,774 -  step: 150  loss: -4.0000  grad_norm: 15.9099  memory: 12.06GiB(25.39%)  tps: 7,382  tflops: 57.71  mfu: 18.50%
[rank3]:2025-12-24 18:33:48,786 -  step: 150  loss:  4.2495  grad_norm: 15.9099  memory: 29.23GiB(61.52%)  tps: 7,382  tflops: 57.71  mfu: 18.50%
[rank1]:2025-12-24 18:37:16,749 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank0]:2025-12-24 18:37:16,728 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-24 18:37:16,760 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.37/0.37, [MB4] 0.25/0.25, [MB5] 0.00/0.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank2]:2025-12-24 18:37:16,744 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.72/0.72, [MB4] 1.00/1.00, [MB5] 0.82/0.82, [MB6] 0.56/0.56, [MB7] 1.00/1.00
[rank3]:2025-12-24 18:37:16,757 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.40/0.40, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB0] 1.00/1.00, [MB1] 0.89/0.89, [MB2] 1.00/1.00, [MB3] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 0.51/0.51
[rank2]:2025-12-24 18:37:20,761 - Avg. fwd time: 7.7765 / Avg. bwd time: 17.2720 / Avg. batch time: 1042.7911 (ms) / GPU bubble ratio: 61.57%
[rank3]:2025-12-24 18:37:20,728 - Avg. fwd time: 13.9515 / Avg. bwd time: 33.9038 / Avg. batch time: 986.9726 (ms) / GPU bubble ratio: 22.42%
[rank1]:2025-12-24 18:37:20,790 - Avg. fwd time: 10.0122 / Avg. bwd time: 21.8271 / Avg. batch time: 1093.2144 (ms) / GPU bubble ratio: 53.40%
[rank1]:2025-12-24 18:37:20,825 -  step: 200  loss: -4.0000  grad_norm:  5.2429  memory: 18.49GiB(38.93%)  tps: 7,727  tflops: 60.40  mfu: 19.36%
[rank0]:2025-12-24 18:37:20,800 - Avg. fwd time: 8.2956 / Avg. bwd time: 18.7291 / Avg. batch time: 1124.3022 (ms) / GPU bubble ratio: 61.54%
[rank0]:2025-12-24 18:37:20,835 -  step: 200  loss: -4.0000  grad_norm:  5.2429  memory: 20.42GiB(42.99%)  tps: 7,727  tflops: 60.40  mfu: 19.36%
[rank0]:2025-12-24 18:37:20,885 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/frozen_ratio_history/rank0/251224_1837_stage0_step200.svg
[rank2]:2025-12-24 18:37:20,821 -  step: 200  loss: -4.0000  grad_norm:  5.2429  memory: 12.06GiB(25.39%)  tps: 7,727  tflops: 60.40  mfu: 19.36%
[rank2]:2025-12-24 18:37:20,886 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/frozen_ratio_history/rank2/251224_1837_stage2_step200.svg
[rank3]:2025-12-24 18:37:20,833 -  step: 200  loss:  1.4950  grad_norm:  5.2429  memory: 29.23GiB(61.52%)  tps: 7,727  tflops: 60.40  mfu: 19.36%
[rank1]:2025-12-24 18:37:20,887 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/frozen_ratio_history/rank1/251224_1837_stage1_step200.svg
[rank1]:2025-12-24 18:37:20,930 - âœ… Frozen Ratio History of Rank 1 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/frozen_ratio_history/rank1/251224_1837_stage5_step200.svg
[rank0]:2025-12-24 18:37:20,927 - âœ… Frozen Ratio History of Rank 0 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/frozen_ratio_history/rank0/251224_1837_stage4_step200.svg
[rank2]:2025-12-24 18:37:20,929 - âœ… Frozen Ratio History of Rank 2 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/frozen_ratio_history/rank2/251224_1837_stage6_step200.svg
[rank2]:2025-12-24 18:37:21,105 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/afr_time_plot/251224_1837_stage2.svg
[rank3]:2025-12-24 18:37:21,074 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/pipeline_schedule/251224_1837_step200_rank3.svg
[rank3]:			> Batch Time: 993.64 ms, GPU Bubble Ratio: 56.41%, 49.84%, 59.84%, 35.08%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-7-31ms      | [S4,MB0,F]  49-9-59ms      | [S4,MB1,F]  87-8-95ms      | [S4,MB2,F]  125-8-133ms    | [S4,MB3,F]  162-8-171ms    | [S0,MB4,F]  171-8-179ms    | [S0,MB5,F]  179-7-187ms    | [S0,MB6,F]  187-8-196ms    | [S4,MB0,B]  369-19-388ms   | [S0,MB7,F]  388-7-395ms    | [S4,MB1,B]  466-19-485ms   | [S4,MB4,F]  503-8-512ms    | [S4,MB2,B]  512-19-531ms   | [S4,MB5,F]  533-8-542ms    | [S4,MB3,B]  542-19-562ms   | [S4,MB6,F]  563-8-572ms    | [S0,MB0,B]  578-26-604ms   | [S4,MB7,F]  604-7-612ms    | [S0,MB1,B]  620-24-645ms   | [S0,MB2,B]  665-23-688ms   | [S0,MB3,B]  710-23-733ms   | [S4,MB4,B]  739-18-757ms   | [S4,MB5,B]  772-18-790ms   | [S4,MB6,B]  832-18-850ms   | [S4,MB7,B]  885-12-897ms   | [S0,MB4,B]  906-21-927ms   | [S0,MB5,B]  937-23-961ms   | [S0,MB6,B]  964-3-967ms    | [S0,MB7,B]  985-8-993ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  49-11-60ms     | [S1,MB2,F]  87-11-98ms     | [S1,MB3,F]  125-11-136ms   | [S5,MB0,F]  162-8-170ms    | [S5,MB1,F]  176-7-184ms    | [S5,MB2,F]  191-7-198ms    | [S5,MB3,F]  275-7-283ms    | [S1,MB4,F]  305-10-316ms   | [S5,MB0,B]  316-19-335ms   | [S1,MB5,F]  362-12-375ms   | [S5,MB1,B]  378-19-397ms   | [S1,MB6,F]  397-11-409ms   | [S5,MB2,B]  465-19-484ms   | [S1,MB7,F]  484-12-496ms   | [S5,MB3,B]  511-19-531ms   | [S5,MB4,F]  531-8-540ms    | [S1,MB0,B]  541-29-571ms   | [S5,MB5,F]  571-9-581ms    | [S1,MB1,B]  580-31-612ms   | [S5,MB6,F]  613-10-624ms   | [S1,MB2,B]  623-34-658ms   | [S5,MB7,F]  658-10-669ms   | [S1,MB3,B]  668-34-703ms   | [S5,MB4,B]  709-22-732ms   | [S5,MB5,B]  744-19-764ms   | [S5,MB6,B]  806-18-825ms   | [S5,MB7,B]  868-9-878ms    | [S1,MB4,B]  884-14-899ms   | [S1,MB5,B]  915-14-930ms   | [S1,MB6,B]  936-14-951ms   | [S1,MB7,B]  963-14-978ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-7-28ms      | [S2,MB1,F]  60-7-67ms      | [S2,MB2,F]  98-7-105ms     | [S2,MB3,F]  136-7-143ms    | [S6,MB0,F]  170-7-178ms    | [S6,MB1,F]  185-7-192ms    | [S6,MB2,F]  269-7-276ms    | [S6,MB0,B]  276-19-296ms   | [S6,MB3,F]  296-8-304ms    | [S6,MB1,B]  352-19-371ms   | [S2,MB4,F]  371-8-380ms    | [S6,MB2,B]  421-19-440ms   | [S2,MB5,F]  440-7-447ms    | [S6,MB3,B]  484-19-504ms   | [S2,MB6,F]  504-8-512ms    | [S2,MB0,B]  512-20-533ms   | [S2,MB7,F]  532-8-541ms    | [S2,MB1,B]  542-20-563ms   | [S6,MB4,F]  563-8-571ms    | [S2,MB2,B]  579-21-600ms   | [S6,MB5,F]  600-7-608ms    | [S2,MB3,B]  626-19-646ms   | [S6,MB6,F]  645-7-653ms    | [S6,MB4,B]  665-19-685ms   | [S6,MB7,F]  684-7-692ms    | [S6,MB5,B]  719-19-738ms   | [S6,MB6,B]  782-18-800ms   | [S6,MB7,B]  850-12-862ms   | [S2,MB4,B]  869-9-878ms    | [S2,MB5,B]  898-11-910ms   | [S2,MB6,B]  915-13-929ms   | [S2,MB7,B]  936-10-947ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-7-36ms      | [S3,MB1,F]  67-6-74ms      | [S3,MB2,F]  105-6-112ms    | [S3,MB3,F]  143-6-150ms    | [S7,MB0,F]  178-15-194ms   | [S7,MB0,B]  206-53-260ms   | [S7,MB1,F]  260-19-279ms   | [S7,MB1,B]  291-54-345ms   | [S7,MB2,F]  345-21-367ms   | [S7,MB2,B]  379-35-414ms   | [S7,MB3,F]  414-18-432ms   | [S7,MB3,B]  444-33-477ms   | [S3,MB4,F]  477-9-487ms    | [S3,MB0,B]  487-14-501ms   | [S3,MB5,F]  502-10-512ms   | [S3,MB1,B]  512-14-527ms   | [S3,MB6,F]  527-9-537ms    | [S3,MB2,B]  538-12-550ms   | [S3,MB7,F]  550-9-560ms    | [S3,MB3,B]  560-23-583ms   | [S7,MB4,F]  586-17-603ms   | [S7,MB4,B]  616-33-649ms   | [S7,MB5,F]  649-16-666ms   | [S7,MB5,B]  677-34-712ms   | [S7,MB6,F]  712-17-730ms   | [S7,MB6,B]  742-33-776ms   | [S7,MB7,F]  776-16-793ms   | [S7,MB7,B]  805-34-840ms   | [S3,MB4,B]  843-11-855ms   | [S3,MB5,B]  855-13-868ms   | [S3,MB6,B]  868-12-880ms   | [S3,MB7,B]  891-16-908ms  
[rank3]:2025-12-24 18:37:21,117 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/frozen_ratio_history/rank3/251224_1837_stage3_step200.svg
[rank1]:2025-12-24 18:37:21,094 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/afr_time_plot/251224_1837_stage1.svg
[rank0]:2025-12-24 18:37:21,095 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/afr_time_plot/251224_1837_stage0.svg
[rank3]:2025-12-24 18:37:21,159 - âœ… Frozen Ratio History of Rank 3 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/frozen_ratio_history/rank3/251224_1837_stage7_step200.svg
[rank1]:2025-12-24 18:37:21,255 - âœ… Scatter Plot of Stage 5 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/afr_time_plot/251224_1837_stage5.svg
[rank0]:2025-12-24 18:37:21,259 - âœ… Scatter Plot of Stage 4 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/afr_time_plot/251224_1837_stage4.svg
[rank2]:2025-12-24 18:37:21,273 - âœ… Scatter Plot of Stage 6 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/afr_time_plot/251224_1837_stage6.svg
[rank3]:2025-12-24 18:37:21,322 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/afr_time_plot/251224_1837_stage3.svg
[rank3]:2025-12-24 18:37:21,483 - âœ… Scatter Plot of Stage 7 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/afr_time_plot/251224_1837_stage7.svg
[rank0]:2025-12-24 18:40:36,216 - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-12-24 18:40:36,230 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank2]:2025-12-24 18:40:36,225 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.72/0.72, [MB4] 1.00/1.00, [MB5] 0.82/0.82, [MB6] 0.56/0.56, [MB7] 1.00/1.00
[rank3]:2025-12-24 18:40:36,239 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.40/0.40, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB0] 1.00/1.00, [MB1] 0.89/0.89, [MB2] 1.00/1.00, [MB3] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 0.51/0.51
[rank0]:2025-12-24 18:40:36,240 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.37/0.37, [MB4] 0.25/0.25, [MB5] 0.00/0.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-12-24 18:40:40,153 - Avg. fwd time: 13.7678 / Avg. bwd time: 32.3616 / Avg. batch time: 962.3292 (ms) / GPU bubble ratio: 23.30%
[rank0]:2025-12-24 18:40:40,227 - Avg. fwd time: 8.2978 / Avg. bwd time: 18.5951 / Avg. batch time: 1092.9679 (ms) / GPU bubble ratio: 60.63%
[rank1]:2025-12-24 18:40:40,217 - Avg. fwd time: 10.0410 / Avg. bwd time: 21.6279 / Avg. batch time: 1065.0304 (ms) / GPU bubble ratio: 52.42%
[rank2]:2025-12-24 18:40:40,188 - Avg. fwd time: 7.7745 / Avg. bwd time: 17.2047 / Avg. batch time: 1015.8818 (ms) / GPU bubble ratio: 60.66%
[rank2]:2025-12-24 18:40:40,249 -  step: 250  loss: -4.0000  grad_norm:  2.2771  memory: 12.06GiB(25.39%)  tps: 8,216  tflops: 64.23  mfu: 20.59%
[rank3]:2025-12-24 18:40:40,261 -  step: 250  loss:  0.5357  grad_norm:  2.2771  memory: 29.23GiB(61.52%)  tps: 8,216  tflops: 64.23  mfu: 20.59%
[rank0]:2025-12-24 18:40:40,263 -  step: 250  loss: -4.0000  grad_norm:  2.2771  memory: 20.42GiB(42.99%)  tps: 8,216  tflops: 64.23  mfu: 20.59%
[rank1]:2025-12-24 18:40:40,252 -  step: 250  loss: -4.0000  grad_norm:  2.2771  memory: 18.49GiB(38.93%)  tps: 8,216  tflops: 64.23  mfu: 20.59%
[rank3]:2025-12-24 18:43:55,244 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.40/0.40, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB0] 1.00/1.00, [MB1] 0.89/0.89, [MB2] 1.00/1.00, [MB3] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 0.51/0.51
[rank0]:2025-12-24 18:43:55,215 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-24 18:43:55,247 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.37/0.37, [MB4] 0.25/0.25, [MB5] 0.00/0.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-12-24 18:43:55,236 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank2]:2025-12-24 18:43:55,232 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.72/0.72, [MB4] 1.00/1.00, [MB5] 0.82/0.82, [MB6] 0.56/0.56, [MB7] 1.00/1.00
[rank2]:2025-12-24 18:43:59,118 - Avg. fwd time: 7.7729 / Avg. bwd time: 17.1558 / Avg. batch time: 997.9386 (ms) / GPU bubble ratio: 60.03%
[rank3]:2025-12-24 18:43:59,086 - Avg. fwd time: 13.6505 / Avg. bwd time: 31.3301 / Avg. batch time: 945.8748 (ms) / GPU bubble ratio: 23.91%
[rank0]:2025-12-24 18:43:59,158 - Avg. fwd time: 8.2991 / Avg. bwd time: 18.5144 / Avg. batch time: 1072.0485 (ms) / GPU bubble ratio: 59.98%
[rank0]:2025-12-24 18:43:59,193 -  step: 300  loss: -4.0000  grad_norm:  0.4426  memory: 20.42GiB(42.99%)  tps: 8,236  tflops: 64.39  mfu: 20.64%
[rank1]:2025-12-24 18:43:59,147 - Avg. fwd time: 10.0624 / Avg. bwd time: 21.5089 / Avg. batch time: 1046.2167 (ms) / GPU bubble ratio: 51.72%
[rank1]:2025-12-24 18:43:59,183 -  step: 300  loss: -4.0000  grad_norm:  0.4426  memory: 18.49GiB(38.93%)  tps: 8,236  tflops: 64.39  mfu: 20.64%
[rank2]:2025-12-24 18:43:59,179 -  step: 300  loss: -4.0000  grad_norm:  0.4426  memory: 12.06GiB(25.39%)  tps: 8,236  tflops: 64.39  mfu: 20.64%
[rank3]:2025-12-24 18:43:59,191 -  step: 300  loss:  0.3124  grad_norm:  0.4426  memory: 29.23GiB(61.52%)  tps: 8,236  tflops: 64.39  mfu: 20.64%
[rank0]:2025-12-24 18:43:59,246 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/frozen_ratio_history/rank0/251224_1843_stage0_step300.svg
[rank0]:2025-12-24 18:43:59,286 - âœ… Frozen Ratio History of Rank 0 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/frozen_ratio_history/rank0/251224_1843_stage4_step300.svg
[rank1]:2025-12-24 18:43:59,247 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/frozen_ratio_history/rank1/251224_1843_stage1_step300.svg
[rank1]:2025-12-24 18:43:59,288 - âœ… Frozen Ratio History of Rank 1 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/frozen_ratio_history/rank1/251224_1843_stage5_step300.svg
[rank2]:2025-12-24 18:43:59,247 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/frozen_ratio_history/rank2/251224_1843_stage2_step300.svg
[rank2]:2025-12-24 18:43:59,288 - âœ… Frozen Ratio History of Rank 2 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/frozen_ratio_history/rank2/251224_1843_stage6_step300.svg
[rank3]:2025-12-24 18:43:59,444 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/pipeline_schedule/251224_1843_step300_rank3.svg
[rank3]:			> Batch Time: 955.50 ms, GPU Bubble Ratio: 55.64%, 47.82%, 58.52%, 35.79%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-7-31ms      | [S4,MB0,F]  49-9-59ms      | [S4,MB1,F]  87-8-95ms      | [S4,MB2,F]  124-8-133ms    | [S4,MB3,F]  162-8-170ms    | [S0,MB4,F]  170-8-178ms    | [S0,MB5,F]  179-7-187ms    | [S0,MB6,F]  187-8-195ms    | [S4,MB0,B]  350-19-369ms   | [S0,MB7,F]  369-7-376ms    | [S4,MB1,B]  441-19-460ms   | [S4,MB4,F]  479-8-487ms    | [S4,MB2,B]  487-19-507ms   | [S4,MB5,F]  509-8-518ms    | [S4,MB3,B]  518-20-538ms   | [S4,MB6,F]  538-8-547ms    | [S0,MB0,B]  553-26-579ms   | [S4,MB7,F]  579-7-586ms    | [S0,MB1,B]  594-24-619ms   | [S0,MB2,B]  640-23-663ms   | [S0,MB3,B]  686-23-709ms   | [S4,MB4,B]  715-18-733ms   | [S4,MB5,B]  745-18-763ms   | [S4,MB6,B]  805-18-823ms   | [S4,MB7,B]  855-15-870ms   | [S0,MB4,B]  877-20-897ms   | [S0,MB5,B]  907-23-931ms   | [S0,MB6,B]  934-0-934ms    | [S0,MB7,B]  955-0-955ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  49-10-60ms     | [S1,MB2,F]  87-10-98ms     | [S1,MB3,F]  124-10-135ms   | [S5,MB0,F]  162-8-170ms    | [S5,MB1,F]  176-7-183ms    | [S5,MB2,F]  190-7-198ms    | [S5,MB3,F]  274-7-281ms    | [S1,MB4,F]  304-10-315ms   | [S5,MB0,B]  315-19-334ms   | [S1,MB5,F]  343-12-356ms   | [S5,MB1,B]  359-19-378ms   | [S1,MB6,F]  378-11-390ms   | [S5,MB2,B]  440-19-460ms   | [S1,MB7,F]  460-12-472ms   | [S5,MB3,B]  487-19-507ms   | [S5,MB4,F]  507-8-516ms    | [S1,MB0,B]  517-29-547ms   | [S5,MB5,F]  546-9-556ms    | [S1,MB1,B]  555-31-587ms   | [S5,MB6,F]  587-10-598ms   | [S1,MB2,B]  598-34-633ms   | [S5,MB7,F]  632-10-643ms   | [S1,MB3,B]  643-34-678ms   | [S5,MB4,B]  685-22-708ms   | [S5,MB5,B]  718-20-738ms   | [S5,MB6,B]  780-18-799ms   | [S5,MB7,B]  838-9-848ms    | [S1,MB4,B]  854-14-869ms   | [S1,MB5,B]  886-14-901ms   | [S1,MB6,B]  907-14-922ms   | [S1,MB7,B]  934-14-948ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-7-28ms      | [S2,MB1,F]  60-7-67ms      | [S2,MB2,F]  98-7-105ms     | [S2,MB3,F]  135-7-142ms    | [S6,MB0,F]  170-7-178ms    | [S6,MB1,F]  184-7-191ms    | [S6,MB2,F]  268-7-275ms    | [S6,MB0,B]  275-19-295ms   | [S6,MB3,F]  295-8-303ms    | [S6,MB1,B]  333-19-352ms   | [S2,MB4,F]  353-8-361ms    | [S6,MB2,B]  397-19-417ms   | [S2,MB5,F]  417-7-424ms    | [S6,MB3,B]  459-19-479ms   | [S2,MB6,F]  479-8-488ms    | [S2,MB0,B]  488-20-508ms   | [S2,MB7,F]  507-8-516ms    | [S2,MB1,B]  518-20-538ms   | [S6,MB4,F]  538-8-546ms    | [S2,MB2,B]  554-21-575ms   | [S6,MB5,F]  575-7-583ms    | [S2,MB3,B]  600-19-620ms   | [S6,MB6,F]  620-7-628ms    | [S6,MB4,B]  640-19-660ms   | [S6,MB7,F]  660-7-667ms    | [S6,MB5,B]  692-19-711ms   | [S6,MB6,B]  755-18-774ms   | [S6,MB7,B]  820-12-832ms   | [S2,MB4,B]  839-9-848ms    | [S2,MB5,B]  871-9-880ms    | [S2,MB6,B]  887-14-902ms   | [S2,MB7,B]  908-9-917ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-7-36ms      | [S3,MB1,F]  67-6-74ms      | [S3,MB2,F]  105-6-112ms    | [S3,MB3,F]  142-6-149ms    | [S7,MB0,F]  178-15-194ms   | [S7,MB0,B]  206-53-259ms   | [S7,MB1,F]  259-19-278ms   | [S7,MB1,B]  289-36-326ms   | [S7,MB2,F]  326-17-344ms   | [S7,MB2,B]  356-33-390ms   | [S7,MB3,F]  390-16-407ms   | [S7,MB3,B]  419-33-453ms   | [S3,MB4,F]  453-9-462ms    | [S3,MB0,B]  463-12-475ms   | [S3,MB5,F]  475-10-485ms   | [S3,MB1,B]  485-14-500ms   | [S3,MB6,F]  500-9-509ms    | [S3,MB2,B]  509-12-522ms   | [S3,MB7,F]  523-10-534ms   | [S3,MB3,B]  534-22-557ms   | [S7,MB4,F]  561-17-578ms   | [S7,MB4,B]  590-33-623ms   | [S7,MB5,F]  623-16-640ms   | [S7,MB5,B]  652-33-685ms   | [S7,MB6,F]  686-17-703ms   | [S7,MB6,B]  716-33-749ms   | [S7,MB7,F]  749-17-766ms   | [S7,MB7,B]  779-33-813ms   | [S3,MB4,B]  813-11-825ms   | [S3,MB5,B]  825-12-838ms   | [S3,MB6,B]  837-11-849ms   | [S3,MB7,B]  864-16-881ms  
[rank3]:2025-12-24 18:43:59,486 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/frozen_ratio_history/rank3/251224_1843_stage3_step300.svg
[rank3]:2025-12-24 18:43:59,527 - âœ… Frozen Ratio History of Rank 3 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/frozen_ratio_history/rank3/251224_1843_stage7_step300.svg
[rank0]:2025-12-24 18:43:59,585 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/afr_time_plot/251224_1843_stage0.svg
[rank1]:2025-12-24 18:43:59,582 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/afr_time_plot/251224_1843_stage1.svg
[rank2]:2025-12-24 18:43:59,584 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/afr_time_plot/251224_1843_stage2.svg
[rank3]:2025-12-24 18:43:59,819 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/afr_time_plot/251224_1843_stage3.svg
[rank0]:2025-12-24 18:43:59,872 - âœ… Scatter Plot of Stage 4 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/afr_time_plot/251224_1843_stage4.svg
[rank1]:2025-12-24 18:43:59,869 - âœ… Scatter Plot of Stage 5 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/afr_time_plot/251224_1843_stage5.svg
[rank2]:2025-12-24 18:43:59,872 - âœ… Scatter Plot of Stage 6 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/afr_time_plot/251224_1843_stage6.svg
[rank3]:2025-12-24 18:44:00,105 - âœ… Scatter Plot of Stage 7 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/afr_time_plot/251224_1843_stage7.svg
[rank0]:2025-12-24 18:47:14,766 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-24 18:47:18,709 - Avg. fwd time: 13.5662 / Avg. bwd time: 30.5939 / Avg. batch time: 933.8066 (ms) / GPU bubble ratio: 24.34%
[rank2]:2025-12-24 18:47:18,744 - Avg. fwd time: 7.7733 / Avg. bwd time: 17.1275 / Avg. batch time: 985.0781 (ms) / GPU bubble ratio: 59.56%
[rank1]:2025-12-24 18:47:18,773 - Avg. fwd time: 10.0794 / Avg. bwd time: 21.4270 / Avg. batch time: 1032.7592 (ms) / GPU bubble ratio: 51.19%
[rank3]:2025-12-24 18:47:18,818 -  step: 350  loss:  0.2346  grad_norm:  0.1875  memory: 29.23GiB(61.52%)  tps: 8,207  tflops: 64.16  mfu: 20.56%
[rank0]:2025-12-24 18:47:18,784 - Avg. fwd time: 8.3001 / Avg. bwd time: 18.4447 / Avg. batch time: 1057.0887 (ms) / GPU bubble ratio: 59.52%
[rank0]:2025-12-24 18:47:18,820 -  step: 350  loss: -4.0000  grad_norm:  0.1875  memory: 20.42GiB(42.99%)  tps: 8,207  tflops: 64.16  mfu: 20.56%
[rank2]:2025-12-24 18:47:18,805 -  step: 350  loss: -4.0000  grad_norm:  0.1875  memory: 12.06GiB(25.39%)  tps: 8,207  tflops: 64.16  mfu: 20.56%
[rank1]:2025-12-24 18:47:18,809 -  step: 350  loss: -4.0000  grad_norm:  0.1875  memory: 18.49GiB(38.93%)  tps: 8,207  tflops: 64.16  mfu: 20.56%
[rank0]:2025-12-24 18:50:33,700 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-24 18:50:37,595 - Avg. fwd time: 13.4975 / Avg. bwd time: 30.0542 / Avg. batch time: 925.0404 (ms) / GPU bubble ratio: 24.67%
[rank0]:2025-12-24 18:50:37,669 - Avg. fwd time: 8.2999 / Avg. bwd time: 18.3770 / Avg. batch time: 1045.8257 (ms) / GPU bubble ratio: 59.19%
[rank0]:2025-12-24 18:50:37,705 -  step: 400  loss: -4.0000  grad_norm:  0.1297  memory: 20.42GiB(42.99%)  tps: 8,238  tflops: 64.40  mfu: 20.64%
[rank2]:2025-12-24 18:50:37,629 - Avg. fwd time: 7.7727 / Avg. bwd time: 17.0951 / Avg. batch time: 975.3958 (ms) / GPU bubble ratio: 59.21%
[rank2]:2025-12-24 18:50:37,691 -  step: 400  loss: -4.0000  grad_norm:  0.1297  memory: 12.06GiB(25.39%)  tps: 8,238  tflops: 64.40  mfu: 20.64%
[rank3]:2025-12-24 18:50:37,703 -  step: 400  loss:  0.2128  grad_norm:  0.1297  memory: 29.23GiB(61.52%)  tps: 8,238  tflops: 64.40  mfu: 20.64%
[rank1]:2025-12-24 18:50:37,658 - Avg. fwd time: 10.0883 / Avg. bwd time: 21.3572 / Avg. batch time: 1022.6235 (ms) / GPU bubble ratio: 50.80%
[rank1]:2025-12-24 18:50:37,695 -  step: 400  loss: -4.0000  grad_norm:  0.1297  memory: 18.49GiB(38.93%)  tps: 8,238  tflops: 64.40  mfu: 20.64%
[rank0]:2025-12-24 18:50:37,759 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/frozen_ratio_history/rank0/251224_1850_stage0_step400.svg
[rank0]:2025-12-24 18:50:37,803 - âœ… Frozen Ratio History of Rank 0 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/frozen_ratio_history/rank0/251224_1850_stage4_step400.svg
[rank2]:2025-12-24 18:50:37,759 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/frozen_ratio_history/rank2/251224_1850_stage2_step400.svg
[rank2]:2025-12-24 18:50:37,803 - âœ… Frozen Ratio History of Rank 2 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/frozen_ratio_history/rank2/251224_1850_stage6_step400.svg
[rank1]:2025-12-24 18:50:37,758 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/frozen_ratio_history/rank1/251224_1850_stage1_step400.svg
[rank1]:2025-12-24 18:50:37,803 - âœ… Frozen Ratio History of Rank 1 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/frozen_ratio_history/rank1/251224_1850_stage5_step400.svg
[rank3]:2025-12-24 18:50:37,943 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/pipeline_schedule/251224_1850_step400_rank3.svg
[rank3]:			> Batch Time: 951.00 ms, GPU Bubble Ratio: 56.05%, 47.63%, 58.52%, 35.69%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-7-31ms      | [S4,MB0,F]  49-9-59ms      | [S4,MB1,F]  87-8-95ms      | [S4,MB2,F]  124-8-133ms    | [S4,MB3,F]  162-8-171ms    | [S0,MB4,F]  171-8-179ms    | [S0,MB5,F]  179-7-187ms    | [S0,MB6,F]  187-8-195ms    | [S4,MB0,B]  351-19-370ms   | [S0,MB7,F]  370-7-377ms    | [S4,MB1,B]  443-19-462ms   | [S4,MB4,F]  481-8-489ms    | [S4,MB2,B]  489-19-508ms   | [S4,MB5,F]  511-8-520ms    | [S4,MB3,B]  520-20-540ms   | [S4,MB6,F]  540-8-548ms    | [S0,MB0,B]  555-26-581ms   | [S4,MB7,F]  581-7-589ms    | [S0,MB1,B]  597-24-621ms   | [S0,MB2,B]  641-23-665ms   | [S0,MB3,B]  686-23-710ms   | [S4,MB4,B]  716-18-734ms   | [S4,MB5,B]  746-18-764ms   | [S4,MB6,B]  806-18-824ms   | [S4,MB7,B]  852-13-866ms   | [S0,MB4,B]  873-16-889ms   | [S0,MB5,B]  903-23-927ms   | [S0,MB6,B]  930-0-930ms    | [S0,MB7,B]  951-0-951ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  49-10-60ms     | [S1,MB2,F]  87-10-98ms     | [S1,MB3,F]  125-10-136ms   | [S5,MB0,F]  162-8-170ms    | [S5,MB1,F]  176-7-184ms    | [S5,MB2,F]  191-7-198ms    | [S5,MB3,F]  275-7-282ms    | [S1,MB4,F]  305-10-316ms   | [S5,MB0,B]  316-19-335ms   | [S1,MB5,F]  344-12-357ms   | [S5,MB1,B]  360-19-379ms   | [S1,MB6,F]  379-11-391ms   | [S5,MB2,B]  443-19-462ms   | [S1,MB7,F]  462-12-474ms   | [S5,MB3,B]  489-19-509ms   | [S5,MB4,F]  509-8-517ms    | [S1,MB0,B]  519-29-548ms   | [S5,MB5,F]  548-9-558ms    | [S1,MB1,B]  558-32-590ms   | [S5,MB6,F]  590-10-600ms   | [S1,MB2,B]  600-34-634ms   | [S5,MB7,F]  634-10-645ms   | [S1,MB3,B]  645-34-679ms   | [S5,MB4,B]  686-22-708ms   | [S5,MB5,B]  719-20-739ms   | [S5,MB6,B]  781-18-799ms   | [S5,MB7,B]  836-9-845ms    | [S1,MB4,B]  852-14-866ms   | [S1,MB5,B]  883-14-897ms   | [S1,MB6,B]  903-14-917ms   | [S1,MB7,B]  930-14-944ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  60-7-67ms      | [S2,MB2,F]  98-7-105ms     | [S2,MB3,F]  135-7-142ms    | [S6,MB0,F]  170-7-178ms    | [S6,MB1,F]  184-7-191ms    | [S6,MB2,F]  269-7-276ms    | [S6,MB0,B]  276-19-295ms   | [S6,MB3,F]  295-8-304ms    | [S6,MB1,B]  334-19-353ms   | [S2,MB4,F]  353-8-362ms    | [S6,MB2,B]  398-19-418ms   | [S2,MB5,F]  418-7-425ms    | [S6,MB3,B]  462-19-481ms   | [S2,MB6,F]  481-8-490ms    | [S2,MB0,B]  490-20-510ms   | [S2,MB7,F]  510-8-519ms    | [S2,MB1,B]  519-20-540ms   | [S6,MB4,F]  540-8-548ms    | [S2,MB2,B]  556-21-577ms   | [S6,MB5,F]  577-7-585ms    | [S2,MB3,B]  602-19-622ms   | [S6,MB6,F]  622-7-630ms    | [S6,MB4,B]  641-19-661ms   | [S6,MB7,F]  661-7-668ms    | [S6,MB5,B]  693-19-712ms   | [S6,MB6,B]  756-18-774ms   | [S6,MB7,B]  819-10-830ms   | [S2,MB4,B]  836-9-846ms    | [S2,MB5,B]  867-9-877ms    | [S2,MB6,B]  883-13-896ms   | [S2,MB7,B]  903-9-912ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-7-36ms      | [S3,MB1,F]  67-6-74ms      | [S3,MB2,F]  105-6-112ms    | [S3,MB3,F]  143-6-149ms    | [S7,MB0,F]  178-15-194ms   | [S7,MB0,B]  206-53-259ms   | [S7,MB1,F]  259-19-279ms   | [S7,MB1,B]  291-36-327ms   | [S7,MB2,F]  327-18-346ms   | [S7,MB2,B]  357-33-391ms   | [S7,MB3,F]  392-16-408ms   | [S7,MB3,B]  421-33-455ms   | [S3,MB4,F]  455-9-465ms    | [S3,MB0,B]  465-12-477ms   | [S3,MB5,F]  477-10-487ms   | [S3,MB1,B]  488-13-501ms   | [S3,MB6,F]  500-9-510ms    | [S3,MB2,B]  510-12-523ms   | [S3,MB7,F]  525-10-535ms   | [S3,MB3,B]  535-22-558ms   | [S7,MB4,F]  562-16-579ms   | [S7,MB4,B]  591-33-624ms   | [S7,MB5,F]  624-16-640ms   | [S7,MB5,B]  653-33-686ms   | [S7,MB6,F]  686-17-704ms   | [S7,MB6,B]  717-33-750ms   | [S7,MB7,F]  749-16-766ms   | [S7,MB7,B]  779-34-813ms   | [S3,MB4,B]  812-11-824ms   | [S3,MB5,B]  824-12-837ms   | [S3,MB6,B]  837-11-849ms   | [S3,MB7,B]  860-16-876ms  
[rank3]:2025-12-24 18:50:37,990 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/frozen_ratio_history/rank3/251224_1850_stage3_step400.svg
[rank3]:2025-12-24 18:50:38,033 - âœ… Frozen Ratio History of Rank 3 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/frozen_ratio_history/rank3/251224_1850_stage7_step400.svg
[rank1]:2025-12-24 18:50:38,225 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/afr_time_plot/251224_1850_stage1.svg
[rank0]:2025-12-24 18:50:38,230 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/afr_time_plot/251224_1850_stage0.svg
[rank2]:2025-12-24 18:50:38,229 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/afr_time_plot/251224_1850_stage2.svg
[rank3]:2025-12-24 18:50:38,455 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/afr_time_plot/251224_1850_stage3.svg
[rank1]:2025-12-24 18:50:38,635 - âœ… Scatter Plot of Stage 5 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/afr_time_plot/251224_1850_stage5.svg
[rank0]:2025-12-24 18:50:38,645 - âœ… Scatter Plot of Stage 4 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/afr_time_plot/251224_1850_stage4.svg
[rank2]:2025-12-24 18:50:38,646 - âœ… Scatter Plot of Stage 6 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/afr_time_plot/251224_1850_stage6.svg
[rank3]:2025-12-24 18:50:38,871 - âœ… Scatter Plot of Stage 7 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/afr_time_plot/251224_1850_stage7.svg
[rank3]:2025-12-24 18:51:00,866 - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-12-24 18:51:01,293 - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-12-24 18:51:01,274 - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-12-24 18:51:01,291 - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-12-24 18:53:52,268 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-24 18:53:56,115 - Avg. fwd time: 13.4368 / Avg. bwd time: 29.5906 / Avg. batch time: 917.3975 (ms) / GPU bubble ratio: 24.96%
[rank2]:2025-12-24 18:53:56,150 - Avg. fwd time: 7.7721 / Avg. bwd time: 17.0752 / Avg. batch time: 967.2099 (ms) / GPU bubble ratio: 58.90%
[rank1]:2025-12-24 18:53:56,179 - Avg. fwd time: 10.0984 / Avg. bwd time: 21.3079 / Avg. batch time: 1014.0872 (ms) / GPU bubble ratio: 50.45%
[rank1]:2025-12-24 18:53:56,216 -  step: 450  loss: -4.0000  grad_norm:  0.1641  memory: 18.49GiB(38.93%)  tps: 8,253  tflops: 64.52  mfu: 20.68%
[rank0]:2025-12-24 18:53:56,191 - Avg. fwd time: 8.2995 / Avg. bwd time: 18.3419 / Avg. batch time: 1036.4157 (ms) / GPU bubble ratio: 58.87%
[rank0]:2025-12-24 18:53:56,227 -  step: 450  loss: -4.0000  grad_norm:  0.1641  memory: 20.42GiB(42.99%)  tps: 8,253  tflops: 64.52  mfu: 20.68%
[rank3]:2025-12-24 18:53:56,225 -  step: 450  loss:  0.2232  grad_norm:  0.1641  memory: 29.23GiB(61.52%)  tps: 8,253  tflops: 64.52  mfu: 20.68%
[rank2]:2025-12-24 18:53:56,213 -  step: 450  loss: -4.0000  grad_norm:  0.1641  memory: 12.06GiB(25.39%)  tps: 8,253  tflops: 64.52  mfu: 20.68%
[rank0]:2025-12-24 18:57:11,745 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-24 18:57:15,596 - Avg. fwd time: 13.4013 / Avg. bwd time: 29.2596 / Avg. batch time: 912.1991 (ms) / GPU bubble ratio: 25.17%
[rank2]:2025-12-24 18:57:15,630 - Avg. fwd time: 7.7711 / Avg. bwd time: 17.0610 / Avg. batch time: 961.5361 (ms) / GPU bubble ratio: 58.68%
[rank1]:2025-12-24 18:57:15,658 - Avg. fwd time: 10.1042 / Avg. bwd time: 21.2663 / Avg. batch time: 1008.1326 (ms) / GPU bubble ratio: 50.21%
[rank3]:2025-12-24 18:57:15,705 -  step: 500  loss:  0.2162  grad_norm:  0.1533  memory: 29.23GiB(61.52%)  tps: 8,213  tflops: 64.21  mfu: 20.58%
[rank0]:2025-12-24 18:57:15,671 - Avg. fwd time: 8.2994 / Avg. bwd time: 18.3111 / Avg. batch time: 1029.7623 (ms) / GPU bubble ratio: 58.65%
[rank0]:2025-12-24 18:57:15,707 -  step: 500  loss: -4.0000  grad_norm:  0.1533  memory: 20.42GiB(42.99%)  tps: 8,213  tflops: 64.21  mfu: 20.58%
[rank2]:2025-12-24 18:57:15,693 -  step: 500  loss: -4.0000  grad_norm:  0.1533  memory: 12.06GiB(25.39%)  tps: 8,213  tflops: 64.21  mfu: 20.58%
[rank2]:2025-12-24 18:57:15,757 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/frozen_ratio_history/rank2/251224_1857_stage2_step500.svg
[rank1]:2025-12-24 18:57:15,696 -  step: 500  loss: -4.0000  grad_norm:  0.1533  memory: 18.49GiB(38.93%)  tps: 8,213  tflops: 64.21  mfu: 20.58%
[rank1]:2025-12-24 18:57:15,756 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/frozen_ratio_history/rank1/251224_1857_stage1_step500.svg
[rank0]:2025-12-24 18:57:15,757 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/frozen_ratio_history/rank0/251224_1857_stage0_step500.svg
[rank0]:2025-12-24 18:57:15,798 - âœ… Frozen Ratio History of Rank 0 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/frozen_ratio_history/rank0/251224_1857_stage4_step500.svg
[rank2]:2025-12-24 18:57:15,799 - âœ… Frozen Ratio History of Rank 2 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/frozen_ratio_history/rank2/251224_1857_stage6_step500.svg
[rank1]:2025-12-24 18:57:15,795 - âœ… Frozen Ratio History of Rank 1 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/frozen_ratio_history/rank1/251224_1857_stage5_step500.svg
[rank3]:2025-12-24 18:57:15,946 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/pipeline_schedule/251224_1857_step500_rank3.svg
[rank3]:			> Batch Time: 968.00 ms, GPU Bubble Ratio: 56.93%, 48.63%, 59.20%, 34.36%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-7-31ms      | [S4,MB0,F]  49-9-59ms      | [S4,MB1,F]  87-8-95ms      | [S4,MB2,F]  124-8-133ms    | [S4,MB3,F]  162-8-171ms    | [S0,MB4,F]  171-8-179ms    | [S0,MB5,F]  179-7-187ms    | [S0,MB6,F]  187-8-195ms    | [S4,MB0,B]  367-19-386ms   | [S0,MB7,F]  386-7-393ms    | [S4,MB1,B]  460-19-479ms   | [S4,MB4,F]  498-8-506ms    | [S4,MB2,B]  506-19-526ms   | [S4,MB5,F]  527-8-536ms    | [S4,MB3,B]  536-20-556ms   | [S4,MB6,F]  556-8-565ms    | [S0,MB0,B]  572-26-598ms   | [S4,MB7,F]  598-7-606ms    | [S0,MB1,B]  614-24-638ms   | [S0,MB2,B]  659-23-683ms   | [S0,MB3,B]  704-23-728ms   | [S4,MB4,B]  733-18-751ms   | [S4,MB5,B]  764-18-782ms   | [S4,MB6,B]  824-18-842ms   | [S4,MB7,B]  869-12-882ms   | [S0,MB4,B]  890-16-906ms   | [S0,MB5,B]  920-23-944ms   | [S0,MB6,B]  947-0-947ms    | [S0,MB7,B]  968-0-968ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  49-10-60ms     | [S1,MB2,F]  87-10-98ms     | [S1,MB3,F]  124-10-135ms   | [S5,MB0,F]  162-8-170ms    | [S5,MB1,F]  176-7-183ms    | [S5,MB2,F]  190-7-197ms    | [S5,MB3,F]  274-7-281ms    | [S1,MB4,F]  304-10-315ms   | [S5,MB0,B]  315-19-334ms   | [S1,MB5,F]  360-12-372ms   | [S5,MB1,B]  376-19-395ms   | [S1,MB6,F]  395-11-406ms   | [S5,MB2,B]  460-19-479ms   | [S1,MB7,F]  479-12-491ms   | [S5,MB3,B]  505-19-525ms   | [S5,MB4,F]  525-8-534ms    | [S1,MB0,B]  535-29-565ms   | [S5,MB5,F]  565-9-575ms    | [S1,MB1,B]  574-32-607ms   | [S5,MB6,F]  606-10-617ms   | [S1,MB2,B]  617-34-652ms   | [S5,MB7,F]  652-10-663ms   | [S1,MB3,B]  663-34-697ms   | [S5,MB4,B]  704-22-726ms   | [S5,MB5,B]  736-20-757ms   | [S5,MB6,B]  798-18-817ms   | [S5,MB7,B]  853-9-862ms    | [S1,MB4,B]  868-14-883ms   | [S1,MB5,B]  899-14-914ms   | [S1,MB6,B]  920-14-934ms   | [S1,MB7,B]  946-14-961ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-7-28ms      | [S2,MB1,F]  60-7-67ms      | [S2,MB2,F]  98-7-105ms     | [S2,MB3,F]  135-7-142ms    | [S6,MB0,F]  170-7-178ms    | [S6,MB1,F]  184-7-191ms    | [S6,MB2,F]  268-7-275ms    | [S6,MB0,B]  275-19-295ms   | [S6,MB3,F]  295-8-303ms    | [S6,MB1,B]  350-19-369ms   | [S2,MB4,F]  369-8-378ms    | [S6,MB2,B]  416-19-435ms   | [S2,MB5,F]  435-7-442ms    | [S6,MB3,B]  478-19-498ms   | [S2,MB6,F]  498-8-506ms    | [S2,MB0,B]  507-20-527ms   | [S2,MB7,F]  527-8-535ms    | [S2,MB1,B]  536-20-557ms   | [S6,MB4,F]  557-8-565ms    | [S2,MB2,B]  573-21-594ms   | [S6,MB5,F]  594-7-602ms    | [S2,MB3,B]  620-19-640ms   | [S6,MB6,F]  640-7-647ms    | [S6,MB4,B]  660-19-680ms   | [S6,MB7,F]  679-7-687ms    | [S6,MB5,B]  711-19-730ms   | [S6,MB6,B]  774-18-792ms   | [S6,MB7,B]  836-10-847ms   | [S2,MB4,B]  853-9-863ms    | [S2,MB5,B]  882-10-893ms   | [S2,MB6,B]  900-13-913ms   | [S2,MB7,B]  920-9-929ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-7-36ms      | [S3,MB1,F]  67-6-74ms      | [S3,MB2,F]  105-6-112ms    | [S3,MB3,F]  142-6-149ms    | [S7,MB0,F]  178-15-194ms   | [S7,MB0,B]  205-53-259ms   | [S7,MB1,F]  259-19-278ms   | [S7,MB1,B]  290-53-343ms   | [S7,MB2,F]  343-21-365ms   | [S7,MB2,B]  375-33-409ms   | [S7,MB3,F]  409-16-426ms   | [S7,MB3,B]  438-34-473ms   | [S3,MB4,F]  471-9-481ms    | [S3,MB0,B]  481-12-494ms   | [S3,MB5,F]  494-10-505ms   | [S3,MB1,B]  505-14-519ms   | [S3,MB6,F]  519-9-529ms    | [S3,MB2,B]  529-12-542ms   | [S3,MB7,F]  543-10-553ms   | [S3,MB3,B]  553-23-576ms   | [S7,MB4,F]  579-17-596ms   | [S7,MB4,B]  609-33-642ms   | [S7,MB5,F]  643-16-659ms   | [S7,MB5,B]  671-33-704ms   | [S7,MB6,F]  705-17-722ms   | [S7,MB6,B]  733-33-767ms   | [S7,MB7,F]  768-16-785ms   | [S7,MB7,B]  796-33-830ms   | [S3,MB4,B]  829-11-841ms   | [S3,MB5,B]  841-12-853ms   | [S3,MB6,B]  855-11-866ms   | [S3,MB7,B]  876-18-894ms  
[rank3]:2025-12-24 18:57:15,990 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/frozen_ratio_history/rank3/251224_1857_stage3_step500.svg
[rank3]:2025-12-24 18:57:16,030 - âœ… Frozen Ratio History of Rank 3 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/frozen_ratio_history/rank3/251224_1857_stage7_step500.svg
[rank2]:2025-12-24 18:57:16,355 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/afr_time_plot/251224_1857_stage2.svg
[rank1]:2025-12-24 18:57:16,349 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/afr_time_plot/251224_1857_stage1.svg
[rank0]:2025-12-24 18:57:16,360 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/afr_time_plot/251224_1857_stage0.svg
[rank3]:2025-12-24 18:57:16,584 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/afr_time_plot/251224_1857_stage3.svg
[rank0]:2025-12-24 18:57:16,910 - âœ… Scatter Plot of Stage 4 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/afr_time_plot/251224_1857_stage4.svg
[rank2]:2025-12-24 18:57:16,896 - âœ… Scatter Plot of Stage 6 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/afr_time_plot/251224_1857_stage6.svg
[rank1]:2025-12-24 18:57:16,884 - âœ… Scatter Plot of Stage 5 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/afr_time_plot/251224_1857_stage5.svg
[rank3]:2025-12-24 18:57:17,116 - âœ… Scatter Plot of Stage 7 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/afr_time_plot/251224_1857_stage7.svg
[rank0]:2025-12-24 19:00:29,669 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-24 19:00:33,696 - Avg. fwd time: 8.2992 / Avg. bwd time: 18.2821 / Avg. batch time: 1023.1321 (ms) / GPU bubble ratio: 58.43%
[rank2]:2025-12-24 19:00:33,654 - Avg. fwd time: 7.7702 / Avg. bwd time: 17.0467 / Avg. batch time: 955.7105 (ms) / GPU bubble ratio: 58.45%
[rank3]:2025-12-24 19:00:33,623 - Avg. fwd time: 13.3514 / Avg. bwd time: 28.9287 / Avg. batch time: 906.7608 (ms) / GPU bubble ratio: 25.40%
[rank1]:2025-12-24 19:00:33,682 - Avg. fwd time: 10.1104 / Avg. bwd time: 21.2296 / Avg. batch time: 1002.0770 (ms) / GPU bubble ratio: 49.96%
[rank1]:2025-12-24 19:00:33,721 -  step: 550  loss: -4.0000  grad_norm:  0.1354  memory: 18.49GiB(38.93%)  tps: 8,274  tflops: 64.68  mfu: 20.73%
[rank0]:2025-12-24 19:00:33,731 -  step: 550  loss: -4.0000  grad_norm:  0.1354  memory: 20.42GiB(42.99%)  tps: 8,274  tflops: 64.68  mfu: 20.73%
[rank2]:2025-12-24 19:00:33,717 -  step: 550  loss: -4.0000  grad_norm:  0.1354  memory: 12.06GiB(25.39%)  tps: 8,274  tflops: 64.68  mfu: 20.73%
[rank3]:2025-12-24 19:00:33,729 -  step: 550  loss:  0.2211  grad_norm:  0.1354  memory: 29.23GiB(61.52%)  tps: 8,274  tflops: 64.68  mfu: 20.73%
[rank0]:2025-12-24 19:03:48,148 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-24 19:03:52,064 - Avg. fwd time: 13.3191 / Avg. bwd time: 28.6954 / Avg. batch time: 902.9542 (ms) / GPU bubble ratio: 25.55%
[rank2]:2025-12-24 19:03:52,092 - Avg. fwd time: 7.7699 / Avg. bwd time: 17.0346 / Avg. batch time: 951.4998 (ms) / GPU bubble ratio: 58.29%
[rank0]:2025-12-24 19:03:52,134 - Avg. fwd time: 8.3002 / Avg. bwd time: 18.2624 / Avg. batch time: 1018.2387 (ms) / GPU bubble ratio: 58.26%
[rank0]:2025-12-24 19:03:52,170 -  step: 600  loss: -4.0000  grad_norm:  0.1341  memory: 20.42GiB(42.99%)  tps: 8,256  tflops: 64.55  mfu: 20.69%
[rank3]:2025-12-24 19:03:52,168 -  step: 600  loss:  0.2181  grad_norm:  0.1341  memory: 29.23GiB(61.52%)  tps: 8,257  tflops: 64.55  mfu: 20.69%
[rank1]:2025-12-24 19:03:52,120 - Avg. fwd time: 10.1147 / Avg. bwd time: 21.1994 / Avg. batch time: 997.6586 (ms) / GPU bubble ratio: 49.78%
[rank1]:2025-12-24 19:03:52,159 -  step: 600  loss: -4.0000  grad_norm:  0.1341  memory: 18.49GiB(38.93%)  tps: 8,256  tflops: 64.55  mfu: 20.69%
[rank2]:2025-12-24 19:03:52,156 -  step: 600  loss: -4.0000  grad_norm:  0.1341  memory: 12.06GiB(25.39%)  tps: 8,256  tflops: 64.55  mfu: 20.69%
[rank2]:2025-12-24 19:03:52,222 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/frozen_ratio_history/rank2/251224_1903_stage2_step600.svg
[rank0]:2025-12-24 19:03:52,222 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/frozen_ratio_history/rank0/251224_1903_stage0_step600.svg
[rank0]:2025-12-24 19:03:52,265 - âœ… Frozen Ratio History of Rank 0 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/frozen_ratio_history/rank0/251224_1903_stage4_step600.svg
[rank1]:2025-12-24 19:03:52,220 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/frozen_ratio_history/rank1/251224_1903_stage1_step600.svg
[rank1]:2025-12-24 19:03:52,262 - âœ… Frozen Ratio History of Rank 1 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/frozen_ratio_history/rank1/251224_1903_stage5_step600.svg
[rank2]:2025-12-24 19:03:52,265 - âœ… Frozen Ratio History of Rank 2 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/frozen_ratio_history/rank2/251224_1903_stage6_step600.svg
[rank3]:2025-12-24 19:03:52,406 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/pipeline_schedule/251224_1903_step600_rank3.svg
[rank3]:			> Batch Time: 955.00 ms, GPU Bubble Ratio: 55.58%, 47.74%, 58.82%, 35.82%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-7-31ms      | [S4,MB0,F]  49-9-59ms      | [S4,MB1,F]  87-8-95ms      | [S4,MB2,F]  125-8-133ms    | [S4,MB3,F]  162-8-170ms    | [S0,MB4,F]  171-8-179ms    | [S0,MB5,F]  179-7-187ms    | [S0,MB6,F]  187-8-195ms    | [S4,MB0,B]  353-19-372ms   | [S0,MB7,F]  372-7-379ms    | [S4,MB1,B]  444-19-463ms   | [S4,MB4,F]  482-8-491ms    | [S4,MB2,B]  491-19-510ms   | [S4,MB5,F]  512-9-521ms    | [S4,MB3,B]  521-20-541ms   | [S4,MB6,F]  542-8-550ms    | [S0,MB0,B]  557-26-583ms   | [S4,MB7,F]  584-7-591ms    | [S0,MB1,B]  599-24-624ms   | [S0,MB2,B]  644-23-667ms   | [S0,MB3,B]  689-23-712ms   | [S4,MB4,B]  718-18-736ms   | [S4,MB5,B]  748-18-766ms   | [S4,MB6,B]  808-18-826ms   | [S4,MB7,B]  853-16-869ms   | [S0,MB4,B]  876-19-895ms   | [S0,MB5,B]  907-23-930ms   | [S0,MB6,B]  934-0-934ms    | [S0,MB7,B]  955-0-955ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  49-10-60ms     | [S1,MB2,F]  87-11-98ms     | [S1,MB3,F]  124-10-135ms   | [S5,MB0,F]  162-8-170ms    | [S5,MB1,F]  176-7-184ms    | [S5,MB2,F]  190-7-198ms    | [S5,MB3,F]  275-7-282ms    | [S1,MB4,F]  304-10-315ms   | [S5,MB0,B]  315-19-335ms   | [S1,MB5,F]  346-13-359ms   | [S5,MB1,B]  361-19-381ms   | [S1,MB6,F]  381-11-393ms   | [S5,MB2,B]  443-19-463ms   | [S1,MB7,F]  462-12-475ms   | [S5,MB3,B]  490-19-510ms   | [S5,MB4,F]  510-8-519ms    | [S1,MB0,B]  520-29-550ms   | [S5,MB5,F]  550-9-560ms    | [S1,MB1,B]  560-32-592ms   | [S5,MB6,F]  592-10-603ms   | [S1,MB2,B]  603-34-637ms   | [S5,MB7,F]  637-10-648ms   | [S1,MB3,B]  647-34-682ms   | [S5,MB4,B]  688-22-711ms   | [S5,MB5,B]  721-20-742ms   | [S5,MB6,B]  782-18-801ms   | [S5,MB7,B]  836-9-846ms    | [S1,MB4,B]  852-14-867ms   | [S1,MB5,B]  885-14-900ms   | [S1,MB6,B]  906-14-920ms   | [S1,MB7,B]  933-14-947ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-7-28ms      | [S2,MB1,F]  60-7-67ms      | [S2,MB2,F]  98-7-105ms     | [S2,MB3,F]  135-7-143ms    | [S6,MB0,F]  170-7-178ms    | [S6,MB1,F]  184-7-191ms    | [S6,MB2,F]  269-7-276ms    | [S6,MB0,B]  276-19-295ms   | [S6,MB3,F]  295-8-304ms    | [S6,MB1,B]  336-19-355ms   | [S2,MB4,F]  355-8-364ms    | [S6,MB2,B]  400-19-419ms   | [S2,MB5,F]  420-7-427ms    | [S6,MB3,B]  463-19-483ms   | [S2,MB6,F]  483-8-491ms    | [S2,MB0,B]  491-20-512ms   | [S2,MB7,F]  512-8-520ms    | [S2,MB1,B]  521-20-542ms   | [S6,MB4,F]  542-8-550ms    | [S2,MB2,B]  558-21-580ms   | [S6,MB5,F]  580-7-588ms    | [S2,MB3,B]  605-20-625ms   | [S6,MB6,F]  625-7-633ms    | [S6,MB4,B]  644-19-664ms   | [S6,MB7,F]  664-7-671ms    | [S6,MB5,B]  695-19-714ms   | [S6,MB6,B]  758-18-776ms   | [S6,MB7,B]  821-9-831ms    | [S2,MB4,B]  837-9-846ms    | [S2,MB5,B]  870-9-879ms    | [S2,MB6,B]  886-13-899ms   | [S2,MB7,B]  906-9-915ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-7-36ms      | [S3,MB1,F]  67-6-74ms      | [S3,MB2,F]  105-6-112ms    | [S3,MB3,F]  143-6-150ms    | [S7,MB0,F]  178-15-194ms   | [S7,MB0,B]  206-53-259ms   | [S7,MB1,F]  259-19-278ms   | [S7,MB1,B]  290-37-328ms   | [S7,MB2,F]  329-18-348ms   | [S7,MB2,B]  359-33-393ms   | [S7,MB3,F]  393-16-410ms   | [S7,MB3,B]  422-34-456ms   | [S3,MB4,F]  457-9-466ms    | [S3,MB0,B]  466-12-478ms   | [S3,MB5,F]  479-10-489ms   | [S3,MB1,B]  489-13-502ms   | [S3,MB6,F]  501-9-511ms    | [S3,MB2,B]  511-12-524ms   | [S3,MB7,F]  527-10-537ms   | [S3,MB3,B]  537-22-560ms   | [S7,MB4,F]  565-17-582ms   | [S7,MB4,B]  593-32-626ms   | [S7,MB5,F]  626-16-642ms   | [S7,MB5,B]  655-33-688ms   | [S7,MB6,F]  689-17-706ms   | [S7,MB6,B]  718-33-752ms   | [S7,MB7,F]  752-16-768ms   | [S7,MB7,B]  780-34-814ms   | [S3,MB4,B]  814-11-825ms   | [S3,MB5,B]  826-12-838ms   | [S3,MB6,B]  838-11-850ms   | [S3,MB7,B]  863-17-880ms  
[rank3]:2025-12-24 19:03:52,450 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/frozen_ratio_history/rank3/251224_1903_stage3_step600.svg
[rank3]:2025-12-24 19:03:52,491 - âœ… Frozen Ratio History of Rank 3 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/frozen_ratio_history/rank3/251224_1903_stage7_step600.svg
[rank0]:2025-12-24 19:03:52,960 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/afr_time_plot/251224_1903_stage0.svg
[rank1]:2025-12-24 19:03:52,944 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/afr_time_plot/251224_1903_stage1.svg
[rank2]:2025-12-24 19:03:52,946 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/afr_time_plot/251224_1903_stage2.svg
[rank3]:2025-12-24 19:03:53,166 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/afr_time_plot/251224_1903_stage3.svg
[rank2]:2025-12-24 19:03:53,611 - âœ… Scatter Plot of Stage 6 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/afr_time_plot/251224_1903_stage6.svg
[rank0]:2025-12-24 19:03:53,629 - âœ… Scatter Plot of Stage 4 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/afr_time_plot/251224_1903_stage4.svg
[rank1]:2025-12-24 19:03:53,604 - âœ… Scatter Plot of Stage 5 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/afr_time_plot/251224_1903_stage5.svg
[rank3]:2025-12-24 19:03:53,817 - âœ… Scatter Plot of Stage 7 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/afr_time_plot/251224_1903_stage7.svg
[rank0]:2025-12-24 19:07:08,947 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-24 19:07:12,886 - Avg. fwd time: 13.2993 / Avg. bwd time: 28.5064 / Avg. batch time: 899.9825 (ms) / GPU bubble ratio: 25.68%
[rank2]:2025-12-24 19:07:12,920 - Avg. fwd time: 7.7699 / Avg. bwd time: 17.0181 / Avg. batch time: 948.3045 (ms) / GPU bubble ratio: 58.18%
[rank1]:2025-12-24 19:07:12,950 - Avg. fwd time: 10.1190 / Avg. bwd time: 21.1765 / Avg. batch time: 994.3024 (ms) / GPU bubble ratio: 49.64%
[rank1]:2025-12-24 19:07:12,989 -  step: 650  loss: -4.0000  grad_norm:  0.1408  memory: 18.49GiB(38.93%)  tps: 8,158  tflops: 63.78  mfu: 20.44%
[rank3]:2025-12-24 19:07:12,998 -  step: 650  loss:  0.2262  grad_norm:  0.1408  memory: 29.23GiB(61.52%)  tps: 8,158  tflops: 63.78  mfu: 20.44%
[rank0]:2025-12-24 19:07:12,964 - Avg. fwd time: 8.3005 / Avg. bwd time: 18.2391 / Avg. batch time: 1014.4797 (ms) / GPU bubble ratio: 58.14%
[rank0]:2025-12-24 19:07:13,000 -  step: 650  loss: -4.0000  grad_norm:  0.1408  memory: 20.42GiB(42.99%)  tps: 8,158  tflops: 63.78  mfu: 20.44%
[rank2]:2025-12-24 19:07:12,986 -  step: 650  loss: -4.0000  grad_norm:  0.1408  memory: 12.06GiB(25.39%)  tps: 8,158  tflops: 63.78  mfu: 20.44%
[rank0]:2025-12-24 19:10:26,577 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-24 19:10:30,487 - Avg. fwd time: 13.2739 / Avg. bwd time: 28.3151 / Avg. batch time: 896.8944 (ms) / GPU bubble ratio: 25.81%
[rank2]:2025-12-24 19:10:30,522 - Avg. fwd time: 7.7691 / Avg. bwd time: 17.0056 / Avg. batch time: 944.9257 (ms) / GPU bubble ratio: 58.05%
[rank3]:2025-12-24 19:10:30,601 -  step: 700  loss:  0.1860  grad_norm:  0.1103  memory: 29.23GiB(61.52%)  tps: 8,291  tflops: 64.82  mfu: 20.78%
[rank1]:2025-12-24 19:10:30,552 - Avg. fwd time: 10.1224 / Avg. bwd time: 21.1535 / Avg. batch time: 990.7852 (ms) / GPU bubble ratio: 49.49%
[rank1]:2025-12-24 19:10:30,593 -  step: 700  loss: -4.0000  grad_norm:  0.1103  memory: 18.49GiB(38.93%)  tps: 8,291  tflops: 64.82  mfu: 20.78%
[rank0]:2025-12-24 19:10:30,567 - Avg. fwd time: 8.3004 / Avg. bwd time: 18.2219 / Avg. batch time: 1010.6172 (ms) / GPU bubble ratio: 58.01%
[rank0]:2025-12-24 19:10:30,603 -  step: 700  loss: -4.0000  grad_norm:  0.1103  memory: 20.42GiB(42.99%)  tps: 8,291  tflops: 64.82  mfu: 20.78%
[rank2]:2025-12-24 19:10:30,589 -  step: 700  loss: -4.0000  grad_norm:  0.1103  memory: 12.06GiB(25.39%)  tps: 8,291  tflops: 64.82  mfu: 20.78%
[rank1]:2025-12-24 19:10:30,657 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/frozen_ratio_history/rank1/251224_1910_stage1_step700.svg
[rank1]:2025-12-24 19:10:30,701 - âœ… Frozen Ratio History of Rank 1 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/frozen_ratio_history/rank1/251224_1910_stage5_step700.svg
[rank0]:2025-12-24 19:10:30,679 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/frozen_ratio_history/rank0/251224_1910_stage0_step700.svg
[rank2]:2025-12-24 19:10:30,663 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/frozen_ratio_history/rank2/251224_1910_stage2_step700.svg
[rank2]:2025-12-24 19:10:30,714 - âœ… Frozen Ratio History of Rank 2 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/frozen_ratio_history/rank2/251224_1910_stage6_step700.svg
[rank0]:2025-12-24 19:10:30,740 - âœ… Frozen Ratio History of Rank 0 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/frozen_ratio_history/rank0/251224_1910_stage4_step700.svg
[rank3]:2025-12-24 19:10:30,842 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/pipeline_schedule/251224_1910_step700_rank3.svg
[rank3]:			> Batch Time: 970.00 ms, GPU Bubble Ratio: 56.63%, 48.88%, 59.30%, 34.68%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-7-31ms      | [S4,MB0,F]  49-9-59ms      | [S4,MB1,F]  87-8-95ms      | [S4,MB2,F]  124-8-133ms    | [S4,MB3,F]  162-8-170ms    | [S0,MB4,F]  170-8-178ms    | [S0,MB5,F]  178-7-186ms    | [S0,MB6,F]  186-8-195ms    | [S4,MB0,B]  366-19-385ms   | [S0,MB7,F]  385-7-392ms    | [S4,MB1,B]  458-19-477ms   | [S4,MB4,F]  497-8-505ms    | [S4,MB2,B]  506-19-525ms   | [S4,MB5,F]  527-8-536ms    | [S4,MB3,B]  536-20-556ms   | [S4,MB6,F]  556-8-565ms    | [S0,MB0,B]  572-26-598ms   | [S4,MB7,F]  596-7-604ms    | [S0,MB1,B]  613-24-637ms   | [S0,MB2,B]  658-23-681ms   | [S0,MB3,B]  703-23-727ms   | [S4,MB4,B]  732-18-750ms   | [S4,MB5,B]  762-18-780ms   | [S4,MB6,B]  821-18-839ms   | [S4,MB7,B]  868-15-883ms   | [S0,MB4,B]  890-17-907ms   | [S0,MB5,B]  921-23-945ms   | [S0,MB6,B]  948-0-948ms    | [S0,MB7,B]  970-0-970ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  49-10-60ms     | [S1,MB2,F]  87-10-98ms     | [S1,MB3,F]  124-10-135ms   | [S5,MB0,F]  162-8-170ms    | [S5,MB1,F]  176-7-183ms    | [S5,MB2,F]  190-7-197ms    | [S5,MB3,F]  274-7-282ms    | [S1,MB4,F]  304-10-315ms   | [S5,MB0,B]  315-19-334ms   | [S1,MB5,F]  359-12-372ms   | [S5,MB1,B]  375-19-394ms   | [S1,MB6,F]  394-11-406ms   | [S5,MB2,B]  458-19-477ms   | [S1,MB7,F]  477-12-489ms   | [S5,MB3,B]  505-19-525ms   | [S5,MB4,F]  525-8-534ms    | [S1,MB0,B]  535-29-565ms   | [S5,MB5,F]  565-9-574ms    | [S1,MB1,B]  574-31-606ms   | [S5,MB6,F]  606-10-617ms   | [S1,MB2,B]  616-34-651ms   | [S5,MB7,F]  651-10-662ms   | [S1,MB3,B]  662-34-696ms   | [S5,MB4,B]  702-22-725ms   | [S5,MB5,B]  734-20-755ms   | [S5,MB6,B]  795-18-814ms   | [S5,MB7,B]  851-9-861ms    | [S1,MB4,B]  867-14-882ms   | [S1,MB5,B]  900-14-915ms   | [S1,MB6,B]  921-14-935ms   | [S1,MB7,B]  948-14-962ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-7-28ms      | [S2,MB1,F]  60-7-67ms      | [S2,MB2,F]  98-7-105ms     | [S2,MB3,F]  135-7-142ms    | [S6,MB0,F]  170-7-178ms    | [S6,MB1,F]  184-7-191ms    | [S6,MB2,F]  268-7-275ms    | [S6,MB0,B]  275-19-295ms   | [S6,MB3,F]  295-8-303ms    | [S6,MB1,B]  349-19-369ms   | [S2,MB4,F]  369-8-377ms    | [S6,MB2,B]  414-19-434ms   | [S2,MB5,F]  434-7-441ms    | [S6,MB3,B]  478-19-498ms   | [S2,MB6,F]  498-8-506ms    | [S2,MB0,B]  506-20-526ms   | [S2,MB7,F]  526-8-535ms    | [S2,MB1,B]  536-20-556ms   | [S6,MB4,F]  556-8-564ms    | [S2,MB2,B]  572-21-594ms   | [S6,MB5,F]  593-7-601ms    | [S2,MB3,B]  618-19-638ms   | [S6,MB6,F]  638-7-646ms    | [S6,MB4,B]  658-19-678ms   | [S6,MB7,F]  678-7-685ms    | [S6,MB5,B]  709-19-728ms   | [S6,MB6,B]  771-18-789ms   | [S6,MB7,B]  835-11-846ms   | [S2,MB4,B]  852-9-861ms    | [S2,MB5,B]  884-10-894ms   | [S2,MB6,B]  901-13-915ms   | [S2,MB7,B]  921-9-931ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-7-36ms      | [S3,MB1,F]  67-6-74ms      | [S3,MB2,F]  105-6-112ms    | [S3,MB3,F]  142-6-149ms    | [S7,MB0,F]  178-15-193ms   | [S7,MB0,B]  205-53-259ms   | [S7,MB1,F]  259-19-278ms   | [S7,MB1,B]  289-53-343ms   | [S7,MB2,F]  343-21-364ms   | [S7,MB2,B]  374-33-408ms   | [S7,MB3,F]  408-16-425ms   | [S7,MB3,B]  437-34-471ms   | [S3,MB4,F]  471-9-481ms    | [S3,MB0,B]  481-12-493ms   | [S3,MB5,F]  494-10-504ms   | [S3,MB1,B]  504-14-518ms   | [S3,MB6,F]  518-9-528ms    | [S3,MB2,B]  528-12-541ms   | [S3,MB7,F]  542-10-552ms   | [S3,MB3,B]  552-22-575ms   | [S7,MB4,F]  579-17-596ms   | [S7,MB4,B]  608-32-641ms   | [S7,MB5,F]  641-16-658ms   | [S7,MB5,B]  670-33-703ms   | [S7,MB6,F]  702-17-720ms   | [S7,MB6,B]  732-33-765ms   | [S7,MB7,F]  765-16-781ms   | [S7,MB7,B]  795-33-829ms   | [S3,MB4,B]  828-11-840ms   | [S3,MB5,B]  840-12-852ms   | [S3,MB6,B]  852-11-864ms   | [S3,MB7,B]  877-17-895ms  
[rank3]:2025-12-24 19:10:30,888 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/frozen_ratio_history/rank3/251224_1910_stage3_step700.svg
[rank3]:2025-12-24 19:10:30,931 - âœ… Frozen Ratio History of Rank 3 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/frozen_ratio_history/rank3/251224_1910_stage7_step700.svg
[rank1]:2025-12-24 19:10:31,511 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/afr_time_plot/251224_1910_stage1.svg
[rank0]:2025-12-24 19:10:31,563 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/afr_time_plot/251224_1910_stage0.svg
[rank2]:2025-12-24 19:10:31,562 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/afr_time_plot/251224_1910_stage2.svg
[rank3]:2025-12-24 19:10:31,737 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/afr_time_plot/251224_1910_stage3.svg
[rank1]:2025-12-24 19:10:32,304 - âœ… Scatter Plot of Stage 5 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/afr_time_plot/251224_1910_stage5.svg
[rank0]:2025-12-24 19:10:32,367 - âœ… Scatter Plot of Stage 4 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/afr_time_plot/251224_1910_stage4.svg
[rank2]:2025-12-24 19:10:32,360 - âœ… Scatter Plot of Stage 6 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/afr_time_plot/251224_1910_stage6.svg
[rank3]:2025-12-24 19:10:32,528 - âœ… Scatter Plot of Stage 7 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/afr_time_plot/251224_1910_stage7.svg
[rank0]:2025-12-24 19:13:47,704 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-24 19:13:51,574 - Avg. fwd time: 13.2558 / Avg. bwd time: 28.1828 / Avg. batch time: 894.7060 (ms) / GPU bubble ratio: 25.90%
[rank1]:2025-12-24 19:13:51,638 - Avg. fwd time: 10.1243 / Avg. bwd time: 21.1343 / Avg. batch time: 988.3115 (ms) / GPU bubble ratio: 49.39%
[rank1]:2025-12-24 19:13:51,679 -  step: 750  loss: -4.0000  grad_norm:  0.1543  memory: 18.49GiB(38.93%)  tps: 8,148  tflops: 63.70  mfu: 20.42%
[rank0]:2025-12-24 19:13:51,654 - Avg. fwd time: 8.3007 / Avg. bwd time: 18.2062 / Avg. batch time: 1007.8467 (ms) / GPU bubble ratio: 57.92%
[rank2]:2025-12-24 19:13:51,608 - Avg. fwd time: 7.7690 / Avg. bwd time: 17.0002 / Avg. batch time: 942.5748 (ms) / GPU bubble ratio: 57.95%
[rank2]:2025-12-24 19:13:51,676 -  step: 750  loss: -4.0000  grad_norm:  0.1543  memory: 12.06GiB(25.39%)  tps: 8,148  tflops: 63.70  mfu: 20.42%
[rank3]:2025-12-24 19:13:51,688 -  step: 750  loss:  0.2238  grad_norm:  0.1543  memory: 29.23GiB(61.52%)  tps: 8,148  tflops: 63.70  mfu: 20.42%
[rank0]:2025-12-24 19:13:51,690 -  step: 750  loss: -4.0000  grad_norm:  0.1543  memory: 20.42GiB(42.99%)  tps: 8,148  tflops: 63.70  mfu: 20.42%
[rank0]:2025-12-24 19:17:06,795 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-24 19:17:10,740 - Avg. fwd time: 13.2426 / Avg. bwd time: 28.0551 / Avg. batch time: 892.7276 (ms) / GPU bubble ratio: 25.98%
[rank2]:2025-12-24 19:17:10,774 - Avg. fwd time: 7.7693 / Avg. bwd time: 16.9962 / Avg. batch time: 940.4512 (ms) / GPU bubble ratio: 57.87%
[rank2]:2025-12-24 19:17:10,842 -  step: 800  loss: -4.0000  grad_norm:  0.1427  memory: 12.06GiB(25.39%)  tps: 8,226  tflops: 64.31  mfu: 20.61%
[rank2]:2025-12-24 19:17:10,842 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  0.1427  tps: 8,396  tflops: 65.63  mfu: 19.19%
[rank2]:2025-12-24 19:17:10,842 - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-12-24 19:17:10,843 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-24 19:17:10,820 - Avg. fwd time: 8.3012 / Avg. bwd time: 18.1980 / Avg. batch time: 1005.3531 (ms) / GPU bubble ratio: 57.83%
[rank1]:2025-12-24 19:17:10,804 - Avg. fwd time: 10.1271 / Avg. bwd time: 21.1181 / Avg. batch time: 986.0798 (ms) / GPU bubble ratio: 49.30%
[rank1]:2025-12-24 19:17:10,845 -  step: 800  loss: -4.0000  grad_norm:  0.1427  memory: 18.49GiB(38.93%)  tps: 8,226  tflops: 64.31  mfu: 20.61%
[rank1]:2025-12-24 19:17:10,845 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  0.1427  tps: 8,396  tflops: 65.64  mfu: 19.20%
[rank1]:2025-12-24 19:17:10,845 - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-12-24 19:17:10,846 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank3]:2025-12-24 19:17:10,854 -  step: 800  loss:  0.2294  grad_norm:  0.1427  memory: 29.23GiB(61.52%)  tps: 8,226  tflops: 64.31  mfu: 20.61%
[rank3]:2025-12-24 19:17:10,854 - â„¹ï¸ final step: 800  loss:  0.2294  grad_norm:  0.1427  tps: 8,404  tflops: 65.69  mfu: 19.35%
[rank3]:2025-12-24 19:17:10,855 - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-12-24 19:17:10,856 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-24 19:17:10,856 -  step: 800  loss: -4.0000  grad_norm:  0.1427  memory: 20.42GiB(42.99%)  tps: 8,226  tflops: 64.31  mfu: 20.61%
[rank0]:2025-12-24 19:17:10,856 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  0.1427  tps: 8,396  tflops: 65.64  mfu: 19.20%
[rank0]:2025-12-24 19:17:10,856 - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-12-24 19:17:10,857 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-24 19:17:12,840 - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank2]:2025-12-24 19:17:12,933 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/frozen_ratio_history/rank2/251224_1917_stage2_final800.svg
[rank0]:2025-12-24 19:17:12,936 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/frozen_ratio_history/rank0/251224_1917_stage0_final800.svg
[rank1]:2025-12-24 19:17:12,932 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/frozen_ratio_history/rank1/251224_1917_stage1_final800.svg
[rank2]:2025-12-24 19:17:12,979 - âœ… Frozen Ratio History of Rank 2 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/frozen_ratio_history/rank2/251224_1917_stage6_final800.svg
[rank0]:2025-12-24 19:17:12,982 - âœ… Frozen Ratio History of Rank 0 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/frozen_ratio_history/rank0/251224_1917_stage4_final800.svg
[rank1]:2025-12-24 19:17:12,977 - âœ… Frozen Ratio History of Rank 1 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/frozen_ratio_history/rank1/251224_1917_stage5_final800.svg
[rank3]:2025-12-24 19:17:13,114 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/pipeline_schedule/251224_1917_final800_rank3.svg
[rank3]:			> Batch Time: 970.50 ms, GPU Bubble Ratio: 56.38%, 48.89%, 59.23%, 34.27%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-7-31ms      | [S4,MB0,F]  49-9-59ms      | [S4,MB1,F]  87-8-95ms      | [S4,MB2,F]  124-8-133ms    | [S4,MB3,F]  162-8-171ms    | [S0,MB4,F]  171-8-179ms    | [S0,MB5,F]  179-7-187ms    | [S0,MB6,F]  187-8-195ms    | [S4,MB0,B]  365-19-384ms   | [S0,MB7,F]  383-7-391ms    | [S4,MB1,B]  459-19-478ms   | [S4,MB4,F]  497-8-506ms    | [S4,MB2,B]  506-19-525ms   | [S4,MB5,F]  527-8-536ms    | [S4,MB3,B]  536-20-556ms   | [S4,MB6,F]  557-8-565ms    | [S0,MB0,B]  571-25-597ms   | [S4,MB7,F]  596-7-604ms    | [S0,MB1,B]  613-24-637ms   | [S0,MB2,B]  658-23-681ms   | [S0,MB3,B]  703-23-726ms   | [S4,MB4,B]  732-18-750ms   | [S4,MB5,B]  763-18-781ms   | [S4,MB6,B]  822-18-840ms   | [S4,MB7,B]  870-15-885ms   | [S0,MB4,B]  891-21-912ms   | [S0,MB5,B]  923-23-946ms   | [S0,MB6,B]  949-0-949ms    | [S0,MB7,B]  970-0-970ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  49-10-60ms     | [S1,MB2,F]  87-10-98ms     | [S1,MB3,F]  124-10-135ms   | [S5,MB0,F]  162-8-170ms    | [S5,MB1,F]  176-7-184ms    | [S5,MB2,F]  191-7-198ms    | [S5,MB3,F]  275-7-282ms    | [S1,MB4,F]  304-10-315ms   | [S5,MB0,B]  315-19-334ms   | [S1,MB5,F]  358-12-371ms   | [S5,MB1,B]  374-19-393ms   | [S1,MB6,F]  393-11-404ms   | [S5,MB2,B]  459-19-478ms   | [S1,MB7,F]  478-12-490ms   | [S5,MB3,B]  505-19-525ms   | [S5,MB4,F]  525-8-534ms    | [S1,MB0,B]  535-29-565ms   | [S5,MB5,F]  565-9-574ms    | [S1,MB1,B]  574-31-606ms   | [S5,MB6,F]  606-10-617ms   | [S1,MB2,B]  617-34-651ms   | [S5,MB7,F]  651-10-662ms   | [S1,MB3,B]  662-34-696ms   | [S5,MB4,B]  703-22-725ms   | [S5,MB5,B]  736-19-755ms   | [S5,MB6,B]  797-18-815ms   | [S5,MB7,B]  854-9-863ms    | [S1,MB4,B]  869-14-883ms   | [S1,MB5,B]  902-14-916ms   | [S1,MB6,B]  922-14-936ms   | [S1,MB7,B]  949-14-963ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-7-28ms      | [S2,MB1,F]  60-7-67ms      | [S2,MB2,F]  98-7-105ms     | [S2,MB3,F]  135-7-142ms    | [S6,MB0,F]  170-7-178ms    | [S6,MB1,F]  184-7-191ms    | [S6,MB2,F]  269-7-276ms    | [S6,MB0,B]  276-19-295ms   | [S6,MB3,F]  295-8-304ms    | [S6,MB1,B]  348-19-367ms   | [S2,MB4,F]  367-8-376ms    | [S6,MB2,B]  415-19-434ms   | [S2,MB5,F]  434-7-441ms    | [S6,MB3,B]  478-19-498ms   | [S2,MB6,F]  498-8-506ms    | [S2,MB0,B]  506-20-526ms   | [S2,MB7,F]  526-8-535ms    | [S2,MB1,B]  536-20-556ms   | [S6,MB4,F]  557-8-565ms    | [S2,MB2,B]  572-21-594ms   | [S6,MB5,F]  593-7-601ms    | [S2,MB3,B]  619-19-639ms   | [S6,MB6,F]  639-7-646ms    | [S6,MB4,B]  658-19-678ms   | [S6,MB7,F]  678-7-685ms    | [S6,MB5,B]  710-19-729ms   | [S6,MB6,B]  773-18-791ms   | [S6,MB7,B]  836-11-848ms   | [S2,MB4,B]  854-9-863ms    | [S2,MB5,B]  885-10-896ms   | [S2,MB6,B]  902-13-915ms   | [S2,MB7,B]  922-9-932ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-7-36ms      | [S3,MB1,F]  67-6-74ms      | [S3,MB2,F]  105-6-112ms    | [S3,MB3,F]  142-6-149ms    | [S7,MB0,F]  178-15-194ms   | [S7,MB0,B]  206-53-259ms   | [S7,MB1,F]  259-19-278ms   | [S7,MB1,B]  290-53-343ms   | [S7,MB2,F]  341-20-362ms   | [S7,MB2,B]  374-34-408ms   | [S7,MB3,F]  408-17-425ms   | [S7,MB3,B]  438-34-472ms   | [S3,MB4,F]  472-9-481ms    | [S3,MB0,B]  481-13-494ms   | [S3,MB5,F]  494-10-505ms   | [S3,MB1,B]  504-14-519ms   | [S3,MB6,F]  518-9-528ms    | [S3,MB2,B]  528-12-541ms   | [S3,MB7,F]  542-10-552ms   | [S3,MB3,B]  552-22-575ms   | [S7,MB4,F]  579-17-596ms   | [S7,MB4,B]  608-33-642ms   | [S7,MB5,F]  641-16-658ms   | [S7,MB5,B]  669-34-703ms   | [S7,MB6,F]  703-17-721ms   | [S7,MB6,B]  732-33-766ms   | [S7,MB7,F]  766-17-783ms   | [S7,MB7,B]  795-34-829ms   | [S3,MB4,B]  829-11-841ms   | [S3,MB5,B]  841-12-854ms   | [S3,MB6,B]  853-11-865ms   | [S3,MB7,B]  878-17-895ms  
[rank0]:2025-12-24 19:17:13,083 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/frozen_params_histogram/251224_1917_rank0_stage4.svg
[rank2]:2025-12-24 19:17:13,080 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/frozen_params_histogram/251224_1917_rank2_stage6.svg
[rank0]:	> Counts Sum: 30200, Total Sum: 414720 (7.28%), Ratio(%) per element: [6.77, 7.46, 7.63, 7.98, 7.46, 7.46, 8.33, 7.29, 7.98, 7.29, 7.63, 7.11, 6.94, 6.94, 7.29, 6.25, 6.42, 6.77]
[rank2]:	> Counts Sum: 46320, Total Sum: 414720 (11.17%), Ratio(%) per element: [10.76, 10.93, 11.45, 11.28, 12.5, 11.97, 11.97, 11.63, 12.32, 10.76, 10.06, 10.59, 10.76, 10.93, 10.59, 10.76, 11.11, 10.59]
[rank1]:2025-12-24 19:17:13,076 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/frozen_params_histogram/251224_1917_rank1_stage5.svg
[rank1]:	> Counts Sum: 59760, Total Sum: 414720 (14.41%), Ratio(%) per element: [14.58, 14.23, 14.93, 14.75, 14.4, 14.4, 14.4, 14.06, 14.4, 14.23, 14.4, 14.23, 14.75, 14.4, 14.23, 14.4, 14.23, 14.23]
[rank3]:2025-12-24 19:17:13,343 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/pipeline_schedule/251224_1917_thry_final800_rank3.svg
[rank3]:			> Batch Time: 561.05 ms, GPU Bubble Ratio: 15.79%, 15.79%, 15.79%, 15.79%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-19ms       | [S0,MB2,F]  19-9-29ms      | [S0,MB3,F]  29-9-39ms      | [S4,MB0,F]  39-9-49ms      | [S4,MB1,F]  49-9-59ms      | [S4,MB2,F]  59-9-68ms      | [S4,MB3,F]  68-9-78ms      | [S0,MB4,F]  78-9-88ms      | [S0,MB5,F]  88-9-98ms      | [S0,MB6,F]  98-9-108ms     | [S4,MB0,B]  137-19-157ms   | [S0,MB7,F]  157-9-167ms    | [S4,MB1,B]  167-19-187ms   | [S4,MB4,F]  196-9-206ms    | [S4,MB2,B]  206-19-226ms   | [S4,MB5,F]  226-9-236ms    | [S4,MB3,B]  236-19-255ms   | [S4,MB6,F]  255-9-265ms    | [S0,MB0,B]  265-19-285ms   | [S4,MB7,F]  285-9-295ms    | [S0,MB1,B]  295-19-314ms   | [S0,MB2,B]  314-19-334ms   | [S0,MB3,B]  344-19-364ms   | [S4,MB4,B]  374-19-393ms   | [S4,MB5,B]  403-19-423ms   | [S4,MB6,B]  433-19-452ms   | [S4,MB7,B]  462-19-482ms   | [S0,MB4,B]  482-19-501ms   | [S0,MB5,B]  501-19-521ms   | [S0,MB6,B]  521-19-541ms   | [S0,MB7,B]  541-19-561ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-9-19ms       | [S1,MB1,F]  19-9-29ms      | [S1,MB2,F]  29-9-39ms      | [S1,MB3,F]  39-9-49ms      | [S5,MB0,F]  49-9-59ms      | [S5,MB1,F]  59-9-68ms      | [S5,MB2,F]  68-9-78ms      | [S5,MB3,F]  78-9-88ms      | [S1,MB4,F]  88-9-98ms      | [S5,MB0,B]  118-19-137ms   | [S1,MB5,F]  137-9-147ms    | [S5,MB1,B]  147-19-167ms   | [S1,MB6,F]  167-9-177ms    | [S5,MB2,B]  177-19-196ms   | [S1,MB7,F]  196-9-206ms    | [S5,MB3,B]  206-19-226ms   | [S5,MB4,F]  226-9-236ms    | [S1,MB0,B]  236-19-255ms   | [S5,MB5,F]  255-9-265ms    | [S1,MB1,B]  265-19-285ms   | [S5,MB6,F]  285-9-295ms    | [S1,MB2,B]  295-19-314ms   | [S5,MB7,F]  314-9-324ms    | [S1,MB3,B]  324-19-344ms   | [S5,MB4,B]  354-19-374ms   | [S5,MB5,B]  383-19-403ms   | [S5,MB6,B]  413-19-433ms   | [S5,MB7,B]  442-19-462ms   | [S1,MB4,B]  462-19-482ms   | [S1,MB5,B]  482-19-501ms   | [S1,MB6,B]  501-19-521ms   | [S1,MB7,B]  521-19-541ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  19-9-29ms      | [S2,MB1,F]  29-9-39ms      | [S2,MB2,F]  39-9-49ms      | [S2,MB3,F]  49-9-59ms      | [S6,MB0,F]  59-9-68ms      | [S6,MB1,F]  68-9-78ms      | [S6,MB2,F]  78-9-88ms      | [S6,MB0,B]  98-19-118ms    | [S6,MB3,F]  118-9-127ms    | [S6,MB1,B]  127-19-147ms   | [S2,MB4,F]  147-9-157ms    | [S6,MB2,B]  157-19-177ms   | [S2,MB5,F]  177-9-187ms    | [S6,MB3,B]  187-19-206ms   | [S2,MB6,F]  206-9-216ms    | [S2,MB0,B]  216-19-236ms   | [S2,MB7,F]  236-9-246ms    | [S2,MB1,B]  246-19-265ms   | [S6,MB4,F]  265-9-275ms    | [S2,MB2,B]  275-19-295ms   | [S6,MB5,F]  295-9-305ms    | [S2,MB3,B]  305-19-324ms   | [S6,MB6,F]  324-9-334ms    | [S6,MB4,B]  334-19-354ms   | [S6,MB7,F]  354-9-364ms    | [S6,MB5,B]  364-19-383ms   | [S6,MB6,B]  393-19-413ms   | [S6,MB7,B]  423-19-442ms   | [S2,MB4,B]  442-19-462ms   | [S2,MB5,B]  462-19-482ms   | [S2,MB6,B]  482-19-501ms   | [S2,MB7,B]  501-19-521ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-9-39ms      | [S3,MB1,F]  39-9-49ms      | [S3,MB2,F]  49-9-59ms      | [S3,MB3,F]  59-9-68ms      | [S7,MB0,F]  68-9-78ms      | [S7,MB0,B]  78-19-98ms     | [S7,MB1,F]  98-9-108ms     | [S7,MB1,B]  108-19-127ms   | [S7,MB2,F]  127-9-137ms    | [S7,MB2,B]  137-19-157ms   | [S7,MB3,F]  157-9-167ms    | [S7,MB3,B]  167-19-187ms   | [S3,MB4,F]  187-9-196ms    | [S3,MB0,B]  196-19-216ms   | [S3,MB5,F]  216-9-226ms    | [S3,MB1,B]  226-19-246ms   | [S3,MB6,F]  246-9-255ms    | [S3,MB2,B]  255-19-275ms   | [S3,MB7,F]  275-9-285ms    | [S3,MB3,B]  285-19-305ms   | [S7,MB4,F]  305-9-314ms    | [S7,MB4,B]  314-19-334ms   | [S7,MB5,F]  334-9-344ms    | [S7,MB5,B]  344-19-364ms   | [S7,MB6,F]  364-9-374ms    | [S7,MB6,B]  374-19-393ms   | [S7,MB7,F]  393-9-403ms    | [S7,MB7,B]  403-19-423ms   | [S3,MB4,B]  423-19-442ms   | [S3,MB5,B]  442-19-462ms   | [S3,MB6,B]  462-19-482ms   | [S3,MB7,B]  482-19-501ms  
[rank3]:2025-12-24 19:17:13,390 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/frozen_ratio_history/rank3/251224_1917_stage3_final800.svg
[rank3]:2025-12-24 19:17:13,433 - âœ… Frozen Ratio History of Rank 3 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/frozen_ratio_history/rank3/251224_1917_stage7_final800.svg
[rank3]:2025-12-24 19:17:13,513 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/frozen_params_histogram/251224_1917_rank3_stage7.svg
[rank3]:	> Counts Sum: 194120, Total Sum: 253440 (76.59%), Ratio(%) per element: [77.43, 76.21, 75.17, 77.6, 76.56, 75.52, 77.6, 76.38, 76.38, 76.9, 76.73]
[rank2]:2025-12-24 19:17:14,022 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/afr_time_plot/251224_1917_stage2.svg
[rank0]:2025-12-24 19:17:14,035 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/afr_time_plot/251224_1917_stage0.svg
[rank1]:2025-12-24 19:17:14,008 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/afr_time_plot/251224_1917_stage1.svg
[rank3]:2025-12-24 19:17:14,444 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/afr_time_plot/251224_1917_stage3.svg
[rank2]:2025-12-24 19:17:14,947 - âœ… Scatter Plot of Stage 6 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/afr_time_plot/251224_1917_stage6.svg
[rank2]:2025-12-24 19:17:14,951 - Destroying the purge thread.
[rank0]:2025-12-24 19:17:14,958 - âœ… Scatter Plot of Stage 4 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/afr_time_plot/251224_1917_stage4.svg
[rank1]:2025-12-24 19:17:14,929 - âœ… Scatter Plot of Stage 5 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/afr_time_plot/251224_1917_stage5.svg
[rank1]:2025-12-24 19:17:14,933 - Destroying the purge thread.
[rank2]:2025-12-24 19:17:15,012 - Process group destroyed
[rank0]:2025-12-24 19:17:14,961 - Sleeping 2 seconds for other ranks to complete
[rank1]:2025-12-24 19:17:15,067 - Process group destroyed
[rank3]:2025-12-24 19:17:15,360 - âœ… Scatter Plot of Stage 7 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1/afr_time_plot/251224_1917_stage7.svg
[rank3]:2025-12-24 19:17:15,365 - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading history steps 16-16, summary, console lines 321-339
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–ˆâ–‡â–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–ˆâ–‡â–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 3.89932
[rank3]:wandb:               final/avg_loss 0.22939
[rank3]:wandb:             final/avg_mfu(%) 19.34661
[rank3]:wandb:             final/avg_tflops 65.69491
[rank3]:wandb:    final/avg_throughput(tps) 8403.52708
[rank3]:wandb:              final/grad_norm 0.14266
[rank3]:wandb:               final/max_loss 0.22939
[rank3]:wandb:                    grad_norm 0.14266
[rank3]:wandb: loss_metrics/global_avg_loss 0.22939
[rank3]:wandb: loss_metrics/global_max_loss 0.22939
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1224_Interleaved1F1B_timelyauto_42_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/o3o10m6u
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1224_Interleaved1F1B_timelyauto_42_dm1/20251224-1821/wandb/run-20251224_182155-o3o10m6u/logs
[rank3]:2025-12-24 19:17:16,521 - Process group destroyed
[rank0]:2025-12-24 19:17:16,961 - Training completed
[rank0]:2025-12-24 19:17:16,962 - Destroying the purge thread.
[rank0]:2025-12-24 19:17:17,074 - Process group destroyed
[rank2]:Stage 2: Modules to keep: {'layers.5', 'layers.6'}
[rank2]:Stage 6: Modules to keep: {'layers.13', 'layers.14'}
[rank1]:Stage 1: Modules to keep: {'layers.3', 'layers.4', 'layers.2'}
[rank1]:Stage 5: Modules to keep: {'layers.12', 'layers.11'}
[rank0]:Stage 0: Modules to keep: {'layers.0', 'tok_embeddings', 'layers.1'}
[rank0]:Stage 4: Modules to keep: {'layers.9', 'layers.10'}
[rank3]:Stage 3: Modules to keep: {'layers.8', 'layers.7'}
[rank3]:Stage 7: Modules to keep: {'output', 'norm', 'layers.15'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1224.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 but debugged requires_grad bug
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1224_Interleaved1F1B_timelyauto_42_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1224_Interleaved1F1B_timelyauto_42_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1224_Interleaved1F1B_timelyauto_42_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1224_Interleaved1F1B_timelyauto_42_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyauto_42_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1224_Interleaved1F1B_timelyauto_42_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 42
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: Interleaved1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 4
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 2
[rank3]:		- stages_list: [3, 7]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1224_Interleaved1F1B_timelyauto_42_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1224_Interleaved1F1B_timelyauto_42_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: timelyauto
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.01
[rank3]:		- percentile: 80
[rank3]:
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
