
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 12. 24. (ìˆ˜) 17:25:42 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 2,3,4,5
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/1224_Interleaved1F1B_timelyapf_42.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 but debugged requires_grad bug

âœ”ï¸Running with timelyapf x Interleaved1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1224.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 but debugged requires_grad bug
" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=timelyapf --freezing.threshold=0.01 --freezing.percentile=80 --freezing.max_freeze_ratio=0.8
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank2]:2025-12-24 17:25:49,129 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank2]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank2]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank2]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank2]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank2]:1224: everything same as 1109 but debugged requires_grad bug
[rank2]:"
[rank3]:2025-12-24 17:25:49,281 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 but debugged requires_grad bug
[rank3]:"
[rank2]:2025-12-24 17:25:49,286 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-12-24 17:25:49,289 - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-12-24 17:25:49,312 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank1]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank1]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank1]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank1]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank1]:1224: everything same as 1109 but debugged requires_grad bug
[rank1]:"
[rank0]:2025-12-24 17:25:49,337 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank0]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank0]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank0]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank0]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank0]:1224: everything same as 1109 but debugged requires_grad bug
[rank0]:"
[rank3]:2025-12-24 17:25:49,462 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-12-24 17:25:49,465 - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-12-24 17:25:49,537 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-12-24 17:25:49,540 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-24 17:25:49,552 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-12-24 17:25:49,555 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-24 17:25:49,562 - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-12-24 17:25:49,565 - Loading tokenizer from tokenizer.json
[rank0]:2025-12-24 17:25:49,967 - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank0]:2025-12-24 17:25:52,750 - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank0]:2025-12-24 17:25:52,902 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-12-24 17:25:52,952 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-24 17:25:52,954 - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-12-24 17:25:52,980 - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1']
[rank0]:2025-12-24 17:25:52,992 - PP rank 0 is building stage_idx 4 with modules ['layers.9', 'layers.10']
[rank0]:2025-12-24 17:25:52,994 - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank2]:2025-12-24 17:25:53,055 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-12-24 17:25:53,100 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-24 17:25:53,177 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-12-24 17:25:53,113 - PP rank 2 is building stage_idx 2 with modules ['layers.5', 'layers.6']
[rank2]:2025-12-24 17:25:53,124 - PP rank 2 is building stage_idx 6 with modules ['layers.13', 'layers.14']
[rank2]:2025-12-24 17:25:53,125 - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank1]:2025-12-24 17:25:53,218 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-24 17:25:53,244 - PP rank 1 is building stage_idx 1 with modules ['layers.2', 'layers.3', 'layers.4']
[rank1]:2025-12-24 17:25:53,257 - PP rank 1 is building stage_idx 5 with modules ['layers.11', 'layers.12']
[rank1]:2025-12-24 17:25:53,259 - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank0]:2025-12-24 17:25:53,209 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-24 17:25:53,210 - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-12-24 17:25:53,211 - CUDA memory usage for model: 1.90GiB(3.99%)
[rank2]:2025-12-24 17:25:53,315 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-24 17:25:53,315 - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-12-24 17:25:53,315 - CUDA memory usage for model: 0.92GiB(1.94%)
[rank1]:2025-12-24 17:25:53,457 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-24 17:25:53,457 - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-12-24 17:25:53,458 - CUDA memory usage for model: 1.13GiB(2.39%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run zfyv6fp0
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1224_Interleaved1F1B_timelyapf_42_dm1/20251224-1725/wandb/run-20251224_172553-zfyv6fp0
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1224_Interleaved1F1B_timelyapf_42_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/zfyv6fp0
[rank3]:2025-12-24 17:25:55,165 - WandB logging enabled
[rank3]:2025-12-24 17:25:55,165 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-12-24 17:25:55,205 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-24 17:25:55,235 - PP rank 3 is building stage_idx 3 with modules ['layers.7', 'layers.8']
[rank3]:2025-12-24 17:25:55,248 - PP rank 3 is building stage_idx 7 with modules ['layers.15', 'norm', 'output']
[rank3]:2025-12-24 17:25:55,250 - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank1]:2025-12-24 17:25:55,461 - Mixed precision training with TP or PP is handled by autocast
[rank2]:2025-12-24 17:25:55,460 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-24 17:25:55,461 - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1224_Interleaved1F1B_timelyapf_42_dm1
[rank0]:2025-12-24 17:25:55,461 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-24 17:25:55,462 - Trainer is initialized with local batch size 32, global batch size 128, gradient accumulation steps 4, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2025-12-24 17:25:55,462 - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank3]:2025-12-24 17:25:55,444 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-24 17:25:55,444 - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-12-24 17:25:55,445 - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2025-12-24 17:25:55,460 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-24 17:25:57,969 - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-12-24 17:25:57,969 - Finished loading the checkpoint in 2.51 seconds.
[rank0]:2025-12-24 17:25:57,969 - Training starts at step 1
[rank0]:2025-12-24 17:26:03,491 -  step:  1  loss: -4.0000  grad_norm: 203.0658  memory: 16.58GiB(34.89%)  tps: 3,109  tflops: 24.31  mfu: 7.79%
[rank0]:2025-12-24 17:26:03,491 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-12-24 17:26:03,459 -  step:  1  loss: -4.0000  grad_norm: 203.0658  memory: 16.23GiB(34.16%)  tps: 3,200  tflops: 25.01  mfu: 8.02%
[rank1]:2025-12-24 17:26:03,460 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-12-24 17:26:03,463 -  step:  1  loss: 10.6092  grad_norm: 203.0658  memory: 25.52GiB(53.71%)  tps: 3,969  tflops: 31.03  mfu: 9.94%
[rank3]:2025-12-24 17:26:03,464 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-12-24 17:26:03,452 -  step:  1  loss: -4.0000  grad_norm: 203.0658  memory: 10.24GiB(21.56%)  tps: 3,165  tflops: 24.75  mfu: 7.93%
[rank2]:2025-12-24 17:26:03,452 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-24 17:30:08,571 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-24 17:30:13,553 - Avg. fwd time: 14.2042 / Avg. bwd time: 40.2464 / Avg. batch time: 1087.9049 (ms) / GPU bubble ratio: 19.92%
[rank2]:2025-12-24 17:30:13,604 - Avg. fwd time: 7.8285 / Avg. bwd time: 18.8003 / Avg. batch time: 1150.3589 (ms) / GPU bubble ratio: 62.96%
[rank2]:2025-12-24 17:30:13,701 -  step: 50  loss: -4.0000  grad_norm: 23.9432  memory: 12.06GiB(25.39%)  tps: 6,416  tflops: 50.16  mfu: 16.08%
[rank1]:2025-12-24 17:30:13,647 - Avg. fwd time: 9.9095 / Avg. bwd time: 24.1151 / Avg. batch time: 1209.2165 (ms) / GPU bubble ratio: 54.98%
[rank1]:2025-12-24 17:30:13,704 -  step: 50  loss: -4.0000  grad_norm: 23.9432  memory: 18.49GiB(38.93%)  tps: 6,416  tflops: 50.16  mfu: 16.08%
[rank0]:2025-12-24 17:30:13,679 - Avg. fwd time: 8.2893 / Avg. bwd time: 21.1046 / Avg. batch time: 1248.0356 (ms) / GPU bubble ratio: 62.32%
[rank0]:2025-12-24 17:30:13,716 -  step: 50  loss: -4.0000  grad_norm: 23.9432  memory: 20.42GiB(42.99%)  tps: 6,417  tflops: 50.16  mfu: 16.08%
[rank3]:2025-12-24 17:30:13,713 -  step: 50  loss:  9.8813  grad_norm: 23.9432  memory: 29.23GiB(61.52%)  tps: 6,416  tflops: 50.16  mfu: 16.08%
[rank3]:2025-12-24 17:30:59,570 - [Step 60] ã€°ï¸ Monitoring Upperbound
[rank3]:2025-12-24 17:31:50,861 - [Step 70] â³ Monitoring Upperbound... (276/286)
[rank2]:2025-12-24 17:31:51,300 - [Step 70] â³ Monitoring Upperbound... (276/286)
[rank0]:2025-12-24 17:31:51,361 - [Step 70] â³ Monitoring Upperbound... (276/286)
[rank1]:2025-12-24 17:31:51,335 - [Step 70] â³ Monitoring Upperbound... (276/286)
[rank3]:2025-12-24 17:32:42,345 - [Step 80] âœ”ï¸  Setting Upperbound
[rank3]:2025-12-24 17:32:42,891 - [Step 80] ã€°ï¸ Monitoring Lowerbound
[rank3]:2025-12-24 17:33:59,704 - [Step 100] âœ”ï¸  Setting Lowerbound
[rank0]:2025-12-24 17:34:00,142 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-24 17:34:00,181 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.70/0.70, [MB4] 1.00/1.00, [MB5] 0.83/0.83, [MB6] 0.60/0.60, [MB7] 1.00/1.00
[rank0]:2025-12-24 17:34:00,181 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.33/0.33, [MB4] 0.27/0.27, [MB5] 0.00/0.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-12-24 17:34:00,181 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-12-24 17:34:00,419 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/pipeline_schedule/251224_1734_max_batch_time.svg
[rank3]:			> Batch Time: 1010.09 ms, GPU Bubble Ratio: 53.11%, 45.47%, 57.56%, 12.35%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-7-31ms      | [S4,MB0,F]  36-9-46ms      | [S4,MB1,F]  46-8-54ms      | [S4,MB2,F]  56-8-65ms      | [S4,MB3,F]  67-8-76ms      | [S0,MB4,F]  76-8-84ms      | [S0,MB5,F]  84-7-92ms      | [S0,MB6,F]  92-8-101ms     | [S4,MB0,B]  177-19-196ms   | [S0,MB7,F]  196-7-204ms    | [S4,MB1,B]  253-19-273ms   | [S4,MB4,F]  385-8-393ms    | [S4,MB2,B]  393-19-412ms   | [S4,MB5,F]  420-8-429ms    | [S4,MB3,B]  429-19-448ms   | [S4,MB6,F]  455-8-463ms    | [S0,MB0,B]  463-25-489ms   | [S4,MB7,F]  489-7-496ms    | [S0,MB1,B]  497-24-522ms   | [S0,MB2,B]  540-23-564ms   | [S0,MB3,B]  585-23-608ms   | [S4,MB4,B]  625-18-643ms   | [S4,MB5,B]  703-18-721ms   | [S4,MB6,B]  782-18-800ms   | [S4,MB7,B]  862-18-880ms   | [S0,MB4,B]  898-23-922ms   | [S0,MB5,B]  926-23-950ms   | [S0,MB6,B]  955-23-979ms   | [S0,MB7,B]  986-23-1010ms 
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  20-10-31ms     | [S1,MB2,F]  31-10-42ms     | [S1,MB3,F]  42-10-53ms     | [S5,MB0,F]  53-8-61ms      | [S5,MB1,F]  61-7-69ms      | [S5,MB2,F]  69-7-76ms      | [S5,MB3,F]  76-7-83ms      | [S1,MB4,F]  84-10-95ms     | [S5,MB0,B]  158-18-177ms   | [S1,MB5,F]  177-12-190ms   | [S5,MB1,B]  234-18-253ms   | [S1,MB6,F]  253-11-265ms   | [S5,MB2,B]  313-18-332ms   | [S1,MB7,F]  332-11-343ms   | [S5,MB3,B]  392-19-411ms   | [S5,MB4,F]  411-7-419ms    | [S1,MB0,B]  429-29-458ms   | [S5,MB5,F]  458-9-467ms    | [S1,MB1,B]  467-30-497ms   | [S5,MB6,F]  497-10-507ms   | [S1,MB2,B]  507-32-540ms   | [S5,MB7,F]  540-10-551ms   | [S1,MB3,B]  551-33-585ms   | [S5,MB4,B]  606-18-625ms   | [S5,MB5,B]  685-18-703ms   | [S5,MB6,B]  764-18-782ms   | [S5,MB7,B]  844-18-862ms   | [S1,MB4,B]  870-27-898ms   | [S1,MB5,B]  898-28-926ms   | [S1,MB6,B]  926-29-955ms   | [S1,MB7,B]  955-30-986ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  31-7-38ms      | [S2,MB2,F]  42-7-49ms      | [S2,MB3,F]  53-7-60ms      | [S6,MB0,F]  61-7-69ms      | [S6,MB1,F]  69-7-77ms      | [S6,MB2,F]  77-7-84ms      | [S6,MB0,B]  139-19-158ms   | [S6,MB3,F]  158-8-167ms    | [S6,MB1,B]  215-19-234ms   | [S2,MB4,F]  234-8-243ms    | [S6,MB2,B]  293-19-313ms   | [S2,MB5,F]  313-7-320ms    | [S6,MB3,B]  373-19-392ms   | [S2,MB6,F]  392-8-400ms    | [S2,MB0,B]  409-19-429ms   | [S2,MB7,F]  429-8-437ms    | [S2,MB1,B]  444-19-464ms   | [S6,MB4,F]  464-8-472ms    | [S2,MB2,B]  478-20-498ms   | [S6,MB5,F]  498-7-506ms    | [S2,MB3,B]  511-20-531ms   | [S6,MB6,F]  531-7-539ms    | [S6,MB4,B]  587-19-606ms   | [S6,MB7,F]  606-8-614ms    | [S6,MB5,B]  666-18-685ms   | [S6,MB6,B]  746-17-764ms   | [S6,MB7,B]  826-17-844ms   | [S2,MB4,B]  852-18-870ms   | [S2,MB5,B]  877-18-895ms   | [S2,MB6,B]  902-18-920ms   | [S2,MB7,B]  926-18-944ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-7-36ms      | [S3,MB1,F]  38-6-45ms      | [S3,MB2,F]  49-7-56ms      | [S3,MB3,F]  60-7-67ms      | [S7,MB0,F]  69-15-85ms     | [S7,MB0,B]  85-53-139ms    AFR(10):0.9091 | [S7,MB1,F]  139-19-158ms   | [S7,MB1,B]  158-56-215ms   AFR(10):0.9091 | [S7,MB2,F]  215-20-236ms   | [S7,MB2,B]  236-57-293ms   AFR(10):0.9091 | [S7,MB3,F]  293-21-315ms   | [S7,MB3,B]  315-58-373ms   AFR(10):0.9091 | [S3,MB4,F]  373-11-385ms   | [S3,MB0,B]  385-24-409ms   AFR(10):1.0000 | [S3,MB5,F]  409-10-420ms   | [S3,MB1,B]  420-23-444ms   AFR(10):1.0000 | [S3,MB6,F]  444-10-455ms   | [S3,MB2,B]  455-23-478ms   AFR(10):1.0000 | [S3,MB7,F]  478-10-489ms   | [S3,MB3,B]  489-22-511ms   AFR(10):1.0000 | [S7,MB4,F]  511-18-530ms   | [S7,MB4,B]  530-56-587ms   AFR(10):0.9091 | [S7,MB5,F]  587-21-608ms   | [S7,MB5,B]  608-58-666ms   AFR(10):0.9091 | [S7,MB6,F]  666-21-688ms   | [S7,MB6,B]  688-58-746ms   AFR(10):0.9091 | [S7,MB7,F]  746-21-767ms   | [S7,MB7,B]  767-58-826ms   AFR(10):0.9091 | [S3,MB4,B]  826-26-852ms   AFR(10):1.0000 | [S3,MB5,B]  852-24-877ms   AFR(10):1.0000 | [S3,MB6,B]  877-24-902ms   AFR(10):1.0000 | [S3,MB7,B]  902-23-926ms   AFR(10):1.0000
[rank3]:2025-12-24 17:34:00,652 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/pipeline_schedule/251224_1734_min_batch_time.svg
[rank3]:			> Batch Time: 702.58 ms, GPU Bubble Ratio: 70.08%, 49.74%, 59.66%, 9.86%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-7-31ms      | [S4,MB0,F]  36-9-46ms      | [S4,MB1,F]  46-8-54ms      | [S4,MB2,F]  56-8-65ms      | [S4,MB3,F]  67-8-76ms      | [S0,MB4,F]  76-8-84ms      | [S0,MB5,F]  84-7-92ms      | [S0,MB6,F]  92-8-101ms     | [S4,MB0,B]  138-10-148ms   | [S0,MB7,F]  148-7-155ms    | [S4,MB1,B]  190-10-200ms   | [S4,MB4,F]  307-8-315ms    | [S4,MB2,B]  315-10-325ms   | [S4,MB5,F]  331-8-339ms    | [S4,MB3,B]  339-10-350ms   | [S4,MB6,F]  354-8-363ms    | [S0,MB0,B]  363-0-363ms    | [S4,MB7,F]  377-7-385ms    | [S0,MB1,B]  385-0-385ms    | [S0,MB2,B]  396-0-396ms    | [S0,MB3,B]  422-0-422ms    | [S4,MB4,B]  461-9-471ms    | [S4,MB5,B]  534-9-543ms    | [S4,MB6,B]  588-9-597ms    | [S4,MB7,B]  644-9-653ms    | [S0,MB4,B]  660-0-660ms    | [S0,MB5,B]  674-0-674ms    | [S0,MB6,B]  688-0-688ms    | [S0,MB7,B]  702-0-702ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  20-10-31ms     | [S1,MB2,F]  31-10-42ms     | [S1,MB3,F]  42-10-53ms     | [S5,MB0,F]  53-8-61ms      | [S5,MB1,F]  61-7-69ms      | [S5,MB2,F]  69-7-76ms      | [S5,MB3,F]  76-7-83ms      | [S1,MB4,F]  84-10-95ms     | [S5,MB0,B]  128-9-138ms    | [S1,MB5,F]  138-12-150ms   | [S5,MB1,B]  181-9-190ms    | [S1,MB6,F]  190-11-202ms   | [S5,MB2,B]  235-9-244ms    | [S1,MB7,F]  244-11-255ms   | [S5,MB3,B]  305-10-315ms   | [S5,MB4,F]  315-7-323ms    | [S1,MB0,B]  330-15-346ms   | [S5,MB5,F]  346-9-355ms    | [S1,MB1,B]  355-15-370ms   | [S5,MB6,F]  370-10-381ms   | [S1,MB2,B]  381-15-396ms   | [S5,MB7,F]  396-10-407ms   | [S1,MB3,B]  407-15-422ms   | [S5,MB4,B]  452-9-461ms    | [S5,MB5,B]  525-9-534ms    | [S5,MB6,B]  579-9-588ms    | [S5,MB7,B]  634-9-644ms    | [S1,MB4,B]  646-13-660ms   | [S1,MB5,B]  660-13-674ms   | [S1,MB6,B]  674-13-688ms   | [S1,MB7,B]  688-13-702ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  31-7-38ms      | [S2,MB2,F]  42-7-49ms      | [S2,MB3,F]  53-7-60ms      | [S6,MB0,F]  61-7-69ms      | [S6,MB1,F]  69-7-77ms      | [S6,MB2,F]  77-7-84ms      | [S6,MB0,B]  118-10-128ms   | [S6,MB3,F]  128-8-137ms    | [S6,MB1,B]  170-10-181ms   | [S2,MB4,F]  181-8-189ms    | [S6,MB2,B]  224-10-235ms   | [S2,MB5,F]  235-7-242ms    | [S6,MB3,B]  295-10-305ms   | [S2,MB6,F]  305-8-313ms    | [S2,MB0,B]  320-10-330ms   | [S2,MB7,F]  330-8-339ms    | [S2,MB1,B]  344-10-354ms   | [S6,MB4,F]  354-8-363ms    | [S2,MB2,B]  367-10-377ms   | [S6,MB5,F]  377-7-385ms    | [S2,MB3,B]  389-10-400ms   | [S6,MB6,F]  400-7-407ms    | [S6,MB4,B]  441-10-452ms   | [S6,MB7,F]  452-8-460ms    | [S6,MB5,B]  515-10-525ms   | [S6,MB6,B]  570-9-579ms    | [S6,MB7,B]  625-9-634ms    | [S2,MB4,B]  637-9-646ms    | [S2,MB5,B]  650-9-659ms    | [S2,MB6,B]  661-9-671ms    | [S2,MB7,B]  674-9-683ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-7-36ms      | [S3,MB1,F]  38-6-45ms      | [S3,MB2,F]  49-7-56ms      | [S3,MB3,F]  60-7-67ms      | [S7,MB0,F]  69-15-85ms     | [S7,MB0,B]  85-32-118ms    AFR(10):0.9091 | [S7,MB1,F]  118-19-137ms   | [S7,MB1,B]  137-33-170ms   AFR(10):0.9091 | [S7,MB2,F]  170-20-191ms   | [S7,MB2,B]  191-33-224ms   AFR(10):0.9091 | [S7,MB3,F]  224-21-246ms   | [S7,MB3,B]  246-49-295ms   AFR(10):0.9091 | [S3,MB4,F]  295-11-307ms   | [S3,MB0,B]  307-13-320ms   AFR(10):1.0000 | [S3,MB5,F]  320-10-331ms   | [S3,MB1,B]  331-12-344ms   AFR(10):1.0000 | [S3,MB6,F]  344-10-354ms   | [S3,MB2,B]  354-12-367ms   AFR(10):1.0000 | [S3,MB7,F]  367-10-377ms   | [S3,MB3,B]  377-12-389ms   AFR(10):1.0000 | [S7,MB4,F]  389-18-408ms   | [S7,MB4,B]  408-33-441ms   AFR(10):0.9091 | [S7,MB5,F]  441-21-463ms   | [S7,MB5,B]  463-51-515ms   AFR(10):0.9091 | [S7,MB6,F]  515-21-536ms   | [S7,MB6,B]  536-33-570ms   AFR(10):0.9091 | [S7,MB7,F]  570-21-591ms   | [S7,MB7,B]  591-34-625ms   AFR(10):0.9091 | [S3,MB4,B]  625-11-637ms   AFR(10):1.0000 | [S3,MB5,B]  637-12-650ms   AFR(10):1.0000 | [S3,MB6,B]  650-11-661ms   AFR(10):1.0000 | [S3,MB7,B]  661-12-674ms   AFR(10):1.0000
[rank3]:2025-12-24 17:34:00,901 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/pipeline_schedule/251224_1734_frozen_pipeline_schedule.svg
[rank3]:			> Batch Time: 726.91 ms, GPU Bubble Ratio: 42.60%, 33.73%, 46.18%, 8.82%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-7-31ms      | [S4,MB0,F]  36-9-46ms      | [S4,MB1,F]  46-8-54ms      | [S4,MB2,F]  56-8-65ms      | [S4,MB3,F]  67-8-76ms      | [S0,MB4,F]  76-8-84ms      | [S0,MB5,F]  84-7-92ms      | [S0,MB6,F]  92-8-101ms     | [S4,MB0,B]  156-19-175ms   | [S0,MB7,F]  175-7-183ms    | [S4,MB1,B]  209-19-228ms   | [S4,MB4,F]  312-8-320ms    | [S4,MB2,B]  320-19-340ms   | [S4,MB5,F]  340-8-348ms    | [S4,MB3,B]  348-19-368ms   | [S4,MB6,F]  368-8-376ms    | [S0,MB0,B]  376-25-402ms   | [S4,MB7,F]  402-7-409ms    | [S0,MB1,B]  416-24-441ms   | [S0,MB2,B]  459-23-482ms   | [S0,MB3,B]  503-23-527ms   | [S4,MB4,B]  527-18-545ms   | [S4,MB5,B]  576-18-594ms   | [S4,MB6,B]  630-18-649ms   | [S4,MB7,B]  671-15-686ms   | [S0,MB4,B]  686-17-703ms   | [S0,MB5,B]  703-23-726ms   | [S0,MB6,B]  726-0-726ms    | [S0,MB7,B]  726-0-726ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  20-10-31ms     | [S1,MB2,F]  31-10-42ms     | [S1,MB3,F]  42-10-53ms     | [S5,MB0,F]  53-8-61ms      | [S5,MB1,F]  61-7-69ms      | [S5,MB2,F]  69-7-76ms      | [S5,MB3,F]  76-7-83ms      | [S1,MB4,F]  84-10-95ms     | [S5,MB0,B]  137-18-156ms   | [S1,MB5,F]  156-12-168ms   | [S5,MB1,B]  190-18-209ms   | [S1,MB6,F]  209-11-220ms   | [S5,MB2,B]  244-18-263ms   | [S1,MB7,F]  263-11-274ms   | [S5,MB3,B]  319-19-339ms   | [S5,MB4,F]  339-7-346ms    | [S1,MB0,B]  347-29-376ms   | [S5,MB5,F]  376-9-386ms    | [S1,MB1,B]  386-30-416ms   | [S5,MB6,F]  416-10-426ms   | [S1,MB2,B]  426-32-459ms   | [S5,MB7,F]  459-10-469ms   | [S1,MB3,B]  469-33-503ms   | [S5,MB4,B]  503-18-522ms   | [S5,MB5,B]  557-18-576ms   | [S5,MB6,B]  612-18-630ms   | [S5,MB7,B]  661-9-671ms    | [S1,MB4,B]  671-13-685ms   | [S1,MB5,B]  685-13-699ms   | [S1,MB6,B]  699-13-712ms   | [S1,MB7,B]  712-13-726ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  31-7-38ms      | [S2,MB2,F]  42-7-49ms      | [S2,MB3,F]  53-7-60ms      | [S6,MB0,F]  61-7-69ms      | [S6,MB1,F]  69-7-77ms      | [S6,MB2,F]  77-7-84ms      | [S6,MB0,B]  118-19-137ms   | [S6,MB3,F]  137-8-146ms    | [S6,MB1,B]  170-19-190ms   | [S2,MB4,F]  190-8-198ms    | [S6,MB2,B]  224-19-244ms   | [S2,MB5,F]  244-7-251ms    | [S6,MB3,B]  300-19-319ms   | [S2,MB6,F]  319-8-328ms    | [S2,MB0,B]  328-19-347ms   | [S2,MB7,F]  347-8-356ms    | [S2,MB1,B]  356-19-376ms   | [S6,MB4,F]  376-8-384ms    | [S2,MB2,B]  384-20-404ms   | [S6,MB5,F]  404-7-412ms    | [S2,MB3,B]  412-20-432ms   | [S6,MB6,F]  432-7-440ms    | [S6,MB4,B]  459-19-479ms   | [S6,MB7,F]  479-8-487ms    | [S6,MB5,B]  539-18-557ms   | [S6,MB6,B]  594-17-612ms   | [S6,MB7,B]  650-11-661ms   | [S2,MB4,B]  661-9-671ms    | [S2,MB5,B]  674-10-685ms   | [S2,MB6,B]  686-12-699ms   | [S2,MB7,B]  703-9-712ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-7-36ms      | [S3,MB1,F]  38-6-45ms      | [S3,MB2,F]  49-7-56ms      | [S3,MB3,F]  60-7-67ms      | [S7,MB0,F]  69-15-85ms     | [S7,MB0,B]  85-32-118ms    AFR(10):0.9091 | [S7,MB1,F]  118-19-137ms   | [S7,MB1,B]  137-33-170ms   AFR(10):0.9091 | [S7,MB2,F]  170-20-191ms   | [S7,MB2,B]  191-33-224ms   AFR(10):0.9091 | [S7,MB3,F]  224-21-246ms   | [S7,MB3,B]  246-54-300ms   AFR(10):0.9091 | [S3,MB4,F]  300-11-312ms   | [S3,MB0,B]  312-13-325ms   AFR(10):1.0000 | [S3,MB5,F]  325-10-336ms   | [S3,MB1,B]  336-14-351ms   AFR(10):1.0000 | [S3,MB6,F]  351-10-361ms   | [S3,MB2,B]  361-12-374ms   AFR(10):1.0000 | [S3,MB7,F]  374-10-384ms   | [S3,MB3,B]  384-22-407ms   AFR(10):1.0000 | [S7,MB4,F]  407-18-425ms   | [S7,MB4,B]  425-33-459ms   AFR(10):0.9091 | [S7,MB5,F]  459-21-481ms   | [S7,MB5,B]  481-58-539ms   AFR(10):0.9091 | [S7,MB6,F]  539-21-560ms   | [S7,MB6,B]  560-33-594ms   AFR(10):0.9091 | [S7,MB7,F]  594-21-616ms   | [S7,MB7,B]  616-34-650ms   AFR(10):0.9091 | [S3,MB4,B]  650-11-661ms   AFR(10):1.0000 | [S3,MB5,B]  661-12-674ms   AFR(10):1.0000 | [S3,MB6,B]  674-11-686ms   AFR(10):1.0000 | [S3,MB7,B]  686-17-703ms   AFR(10):1.0000
[rank3]:2025-12-24 17:34:00,902 - 	> Batch Time: 726.91 ms (Average Freeze Ratio: 0.38, Time Reduction Rate: 0.28)
[rank3]:2025-12-24 17:34:00,921 - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 0.40/0.40, [MB0] 1.00/1.00, [MB1] 0.85/0.85, [MB2] 1.00/1.00, [MB3] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 0.00/0.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 0.55/0.55
[rank2]:2025-12-24 17:34:04,805 - Avg. fwd time: 7.7946 / Avg. bwd time: 17.0284 / Avg. batch time: 1100.9110 (ms) / GPU bubble ratio: 63.92%
[rank0]:2025-12-24 17:34:04,843 - Avg. fwd time: 8.2806 / Avg. bwd time: 17.8553 / Avg. batch time: 1189.5146 (ms) / GPU bubble ratio: 64.85%
[rank1]:2025-12-24 17:34:04,834 - Avg. fwd time: 9.8862 / Avg. bwd time: 21.7553 / Avg. batch time: 1155.5992 (ms) / GPU bubble ratio: 56.19%
[rank3]:2025-12-24 17:34:04,772 - Avg. fwd time: 14.0441 / Avg. bwd time: 37.3135 / Avg. batch time: 1040.2020 (ms) / GPU bubble ratio: 21.00%
[rank2]:2025-12-24 17:34:04,865 -  step: 100  loss: -4.0000  grad_norm:  7.1321  memory: 12.98GiB(27.32%)  tps: 7,088  tflops: 55.41  mfu: 17.76%
[rank0]:2025-12-24 17:34:04,879 -  step: 100  loss: -4.0000  grad_norm:  7.1321  memory: 22.24GiB(46.82%)  tps: 7,088  tflops: 55.41  mfu: 17.76%
[rank0]:2025-12-24 17:34:04,939 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank0/251224_1734_stage0_step100.svg
[rank1]:2025-12-24 17:34:04,868 -  step: 100  loss: -4.0000  grad_norm:  7.1321  memory: 19.63GiB(41.31%)  tps: 7,088  tflops: 55.41  mfu: 17.76%
[rank1]:2025-12-24 17:34:04,938 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank1/251224_1734_stage1_step100.svg
[rank3]:2025-12-24 17:34:04,877 -  step: 100  loss:  8.8141  grad_norm:  7.1321  memory: 31.20GiB(65.67%)  tps: 7,088  tflops: 55.41  mfu: 17.76%
[rank2]:2025-12-24 17:34:04,938 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank2/251224_1734_stage2_step100.svg
[rank2]:2025-12-24 17:34:04,977 - âœ… Frozen Ratio History of Rank 2 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank2/251224_1734_stage6_step100.svg
[rank2]:2025-12-24 17:34:05,016 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/251224_1734_stage2.svg
[rank0]:2025-12-24 17:34:04,978 - âœ… Frozen Ratio History of Rank 0 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank0/251224_1734_stage4_step100.svg
[rank0]:2025-12-24 17:34:05,018 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/251224_1734_stage0.svg
[rank1]:2025-12-24 17:34:04,976 - âœ… Frozen Ratio History of Rank 1 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank1/251224_1734_stage5_step100.svg
[rank1]:2025-12-24 17:34:05,016 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/251224_1734_stage1.svg
[rank2]:2025-12-24 17:34:05,052 - âœ… Scatter Plot of Stage 6 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/251224_1734_stage6.svg
[rank0]:2025-12-24 17:34:05,054 - âœ… Scatter Plot of Stage 4 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/251224_1734_stage4.svg
[rank1]:2025-12-24 17:34:05,052 - âœ… Scatter Plot of Stage 5 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/251224_1734_stage5.svg
[rank3]:2025-12-24 17:34:05,113 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/pipeline_schedule/251224_1734_step100_rank3.svg
[rank3]:			> Batch Time: 952.00 ms, GPU Bubble Ratio: 77.99%, 63.32%, 70.54%, 34.15%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-7-31ms      | [S4,MB0,F]  49-9-58ms      | [S4,MB1,F]  87-8-95ms      | [S4,MB2,F]  124-8-133ms    | [S4,MB3,F]  162-8-170ms    | [S0,MB4,F]  170-8-178ms    | [S0,MB5,F]  178-7-186ms    | [S0,MB6,F]  186-8-195ms    | [S4,MB0,B]  338-10-348ms   | [S0,MB7,F]  348-7-356ms    | [S4,MB1,B]  427-10-437ms   | [S4,MB4,F]  466-8-474ms    | [S4,MB2,B]  475-10-485ms   | [S4,MB5,F]  494-8-503ms    | [S4,MB3,B]  503-10-513ms   | [S4,MB6,F]  522-8-531ms    | [S0,MB0,B]  531-0-531ms    | [S4,MB7,F]  549-7-556ms    | [S0,MB1,B]  557-0-557ms    | [S0,MB2,B]  577-0-577ms    | [S0,MB3,B]  635-0-635ms    | [S4,MB4,B]  655-9-664ms    | [S4,MB5,B]  752-9-761ms    | [S4,MB6,B]  816-9-825ms    | [S4,MB7,B]  865-9-874ms    | [S0,MB4,B]  885-0-885ms    | [S0,MB5,B]  911-0-911ms    | [S0,MB6,B]  931-0-931ms    | [S0,MB7,B]  952-0-952ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  49-10-60ms     | [S1,MB2,F]  87-10-98ms     | [S1,MB3,F]  124-10-135ms   | [S5,MB0,F]  162-8-170ms    | [S5,MB1,F]  176-7-183ms    | [S5,MB2,F]  190-7-197ms    | [S5,MB3,F]  269-7-276ms    | [S1,MB4,F]  289-10-300ms   | [S5,MB0,B]  300-9-309ms    | [S1,MB5,F]  331-12-344ms   | [S5,MB1,B]  344-9-354ms    | [S1,MB6,F]  354-11-365ms   | [S5,MB2,B]  427-9-437ms    | [S1,MB7,F]  437-11-448ms   | [S5,MB3,B]  474-10-484ms   | [S5,MB4,F]  485-7-493ms    | [S1,MB0,B]  502-15-517ms   | [S5,MB5,F]  518-8-526ms    | [S1,MB1,B]  530-15-546ms   | [S5,MB6,F]  545-8-554ms    | [S1,MB2,B]  554-15-570ms   | [S5,MB7,F]  570-9-579ms    | [S1,MB3,B]  579-15-594ms   | [S5,MB4,B]  639-9-648ms    | [S5,MB5,B]  721-9-730ms    | [S5,MB6,B]  787-9-796ms    | [S5,MB7,B]  849-9-858ms    | [S1,MB4,B]  865-13-878ms   | [S1,MB5,B]  890-13-904ms   | [S1,MB6,B]  911-13-924ms   | [S1,MB7,B]  931-13-944ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-7-28ms      | [S2,MB1,F]  60-7-67ms      | [S2,MB2,F]  97-7-105ms     | [S2,MB3,F]  135-7-142ms    | [S6,MB0,F]  170-7-178ms    | [S6,MB1,F]  184-7-191ms    | [S6,MB2,F]  262-7-270ms    | [S6,MB0,B]  269-10-280ms   | [S6,MB3,F]  280-8-288ms    | [S6,MB1,B]  321-10-331ms   | [S2,MB4,F]  331-8-340ms    | [S6,MB2,B]  383-10-393ms   | [S2,MB5,F]  393-7-401ms    | [S6,MB3,B]  447-10-458ms   | [S2,MB6,F]  458-7-466ms    | [S2,MB0,B]  474-10-484ms   | [S2,MB7,F]  485-7-493ms    | [S2,MB1,B]  502-10-513ms   | [S6,MB4,F]  513-7-520ms    | [S2,MB2,B]  530-10-540ms   | [S6,MB5,F]  540-8-548ms    | [S2,MB3,B]  553-10-563ms   | [S6,MB6,F]  563-7-571ms    | [S6,MB4,B]  621-10-631ms   | [S6,MB7,F]  632-8-640ms    | [S6,MB5,B]  703-9-713ms    | [S6,MB6,B]  770-9-779ms    | [S6,MB7,B]  834-9-843ms    | [S2,MB4,B]  849-9-858ms    | [S2,MB5,B]  875-9-884ms    | [S2,MB6,B]  890-9-899ms    | [S2,MB7,B]  910-9-919ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-7-36ms      | [S3,MB1,F]  67-6-74ms      | [S3,MB2,F]  105-6-112ms    | [S3,MB3,F]  142-6-149ms    | [S7,MB0,F]  178-15-193ms   | [S7,MB0,B]  205-48-253ms   | [S7,MB1,F]  253-17-270ms   | [S7,MB1,B]  282-33-315ms   | [S7,MB2,F]  314-17-331ms   | [S7,MB2,B]  343-33-376ms   | [S7,MB3,F]  376-17-394ms   | [S7,MB3,B]  405-34-440ms   | [S3,MB4,F]  440-9-450ms    | [S3,MB0,B]  450-12-462ms   | [S3,MB5,F]  463-10-473ms   | [S3,MB1,B]  473-13-486ms   | [S3,MB6,F]  486-9-495ms    | [S3,MB2,B]  496-12-508ms   | [S3,MB7,F]  509-10-519ms   | [S3,MB3,B]  519-12-531ms   | [S7,MB4,F]  536-18-554ms   | [S7,MB4,B]  566-49-616ms   | [S7,MB5,F]  613-19-632ms   | [S7,MB5,B]  645-51-696ms   | [S7,MB6,F]  697-20-717ms   | [S7,MB6,B]  730-33-764ms   | [S7,MB7,F]  763-17-781ms   | [S7,MB7,B]  792-33-826ms   | [S3,MB4,B]  826-11-838ms   | [S3,MB5,B]  838-12-850ms   | [S3,MB6,B]  850-11-861ms   | [S3,MB7,B]  868-12-880ms  
[rank3]:2025-12-24 17:34:05,156 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank3/251224_1734_stage3_step100.svg
[rank3]:2025-12-24 17:34:05,195 - âœ… Frozen Ratio History of Rank 3 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank3/251224_1734_stage7_step100.svg
[rank3]:2025-12-24 17:34:05,234 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/251224_1734_stage3.svg
[rank3]:2025-12-24 17:34:05,271 - âœ… Scatter Plot of Stage 7 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/251224_1734_stage7.svg
[rank0]:2025-12-24 17:37:50,899 - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-12-24 17:37:50,920 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.47/0.70, [MB4] 0.67/1.00, [MB5] 0.56/0.83, [MB6] 0.40/0.60, [MB7] 0.67/1.00
[rank1]:2025-12-24 17:37:50,927 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank0]:2025-12-24 17:37:50,950 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.22/0.33, [MB4] 0.18/0.27, [MB5] 0.00/0.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank3]:2025-12-24 17:37:50,944 - Current/Expected Freeze Ratio per Block: [MB0] 0.67/1.00, [MB1] 0.67/1.00, [MB2] 0.67/1.00, [MB3] 0.27/0.40, [MB0] 0.67/1.00, [MB1] 0.56/0.85, [MB2] 0.67/1.00, [MB3] 0.00/0.00, [MB4] 0.67/1.00, [MB5] 0.00/0.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.37/0.55
[rank3]:2025-12-24 17:37:55,484 - Avg. fwd time: 14.0486 / Avg. bwd time: 36.3982 / Avg. batch time: 1026.9427 (ms) / GPU bubble ratio: 21.40%
[rank2]:2025-12-24 17:37:55,516 - Avg. fwd time: 7.7967 / Avg. bwd time: 17.0993 / Avg. batch time: 1084.1802 (ms) / GPU bubble ratio: 63.26%
[rank1]:2025-12-24 17:37:55,546 - Avg. fwd time: 9.9376 / Avg. bwd time: 21.7182 / Avg. batch time: 1136.1600 (ms) / GPU bubble ratio: 55.42%
[rank0]:2025-12-24 17:37:55,566 - Avg. fwd time: 8.2804 / Avg. bwd time: 18.4110 / Avg. batch time: 1167.9478 (ms) / GPU bubble ratio: 63.43%
[rank0]:2025-12-24 17:37:55,602 -  step: 150  loss: -4.0000  grad_norm: 20.5413  memory: 22.34GiB(47.02%)  tps: 7,101  tflops: 55.51  mfu: 17.79%
[rank3]:2025-12-24 17:37:55,600 -  step: 150  loss:  4.2197  grad_norm: 20.5413  memory: 32.12GiB(67.61%)  tps: 7,101  tflops: 55.51  mfu: 17.79%
[rank2]:2025-12-24 17:37:55,588 -  step: 150  loss: -4.0000  grad_norm: 20.5413  memory: 12.98GiB(27.32%)  tps: 7,101  tflops: 55.51  mfu: 17.79%
[rank1]:2025-12-24 17:37:55,591 -  step: 150  loss: -4.0000  grad_norm: 20.5413  memory: 19.63GiB(41.31%)  tps: 7,101  tflops: 55.51  mfu: 17.79%
[rank0]:2025-12-24 17:41:29,288 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-24 17:41:29,316 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.70/0.70, [MB4] 1.00/1.00, [MB5] 0.83/0.83, [MB6] 0.60/0.60, [MB7] 1.00/1.00
[rank1]:2025-12-24 17:41:29,324 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank0]:2025-12-24 17:41:29,346 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.33/0.33, [MB4] 0.27/0.27, [MB5] 0.00/0.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-12-24 17:41:29,340 - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 0.40/0.40, [MB0] 1.00/1.00, [MB1] 0.85/0.85, [MB2] 1.00/1.00, [MB3] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 0.00/0.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 0.55/0.55
[rank2]:2025-12-24 17:41:33,307 - Avg. fwd time: 7.7951 / Avg. bwd time: 17.0244 / Avg. batch time: 1061.0825 (ms) / GPU bubble ratio: 62.57%
[rank3]:2025-12-24 17:41:33,275 - Avg. fwd time: 13.9748 / Avg. bwd time: 35.1251 / Avg. batch time: 1007.1077 (ms) / GPU bubble ratio: 21.99%
[rank1]:2025-12-24 17:41:33,336 - Avg. fwd time: 9.9775 / Avg. bwd time: 21.4805 / Avg. batch time: 1111.1539 (ms) / GPU bubble ratio: 54.70%
[rank0]:2025-12-24 17:41:33,346 - Avg. fwd time: 8.2868 / Avg. bwd time: 18.5853 / Avg. batch time: 1141.1786 (ms) / GPU bubble ratio: 62.32%
[rank0]:2025-12-24 17:41:33,382 -  step: 200  loss: -4.0000  grad_norm:  5.2399  memory: 22.34GiB(47.02%)  tps: 7,523  tflops: 58.81  mfu: 18.85%
[rank2]:2025-12-24 17:41:33,367 -  step: 200  loss: -4.0000  grad_norm:  5.2399  memory: 12.98GiB(27.32%)  tps: 7,523  tflops: 58.81  mfu: 18.85%
[rank3]:2025-12-24 17:41:33,379 -  step: 200  loss:  1.1954  grad_norm:  5.2399  memory: 32.12GiB(67.61%)  tps: 7,523  tflops: 58.81  mfu: 18.85%
[rank1]:2025-12-24 17:41:33,371 -  step: 200  loss: -4.0000  grad_norm:  5.2399  memory: 19.65GiB(41.35%)  tps: 7,523  tflops: 58.81  mfu: 18.85%
[rank1]:2025-12-24 17:41:33,433 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank1/251224_1741_stage1_step200.svg
[rank0]:2025-12-24 17:41:33,433 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank0/251224_1741_stage0_step200.svg
[rank0]:2025-12-24 17:41:33,475 - âœ… Frozen Ratio History of Rank 0 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank0/251224_1741_stage4_step200.svg
[rank2]:2025-12-24 17:41:33,433 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank2/251224_1741_stage2_step200.svg
[rank2]:2025-12-24 17:41:33,477 - âœ… Frozen Ratio History of Rank 2 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank2/251224_1741_stage6_step200.svg
[rank1]:2025-12-24 17:41:33,475 - âœ… Frozen Ratio History of Rank 1 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank1/251224_1741_stage5_step200.svg
[rank3]:2025-12-24 17:41:33,625 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/pipeline_schedule/251224_1741_step200_rank3.svg
[rank3]:			> Batch Time: 1018.23 ms, GPU Bubble Ratio: 57.50%, 51.44%, 61.54%, 33.26%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-7-31ms      | [S4,MB0,F]  49-9-59ms      | [S4,MB1,F]  87-8-95ms      | [S4,MB2,F]  125-8-133ms    | [S4,MB3,F]  162-8-171ms    | [S0,MB4,F]  171-8-179ms    | [S0,MB5,F]  179-7-187ms    | [S0,MB6,F]  187-8-196ms    | [S4,MB0,B]  341-19-361ms   | [S0,MB7,F]  360-7-367ms    | [S4,MB1,B]  431-19-450ms   | [S4,MB4,F]  488-8-496ms    | [S4,MB2,B]  497-19-516ms   | [S4,MB5,F]  518-8-526ms    | [S4,MB3,B]  527-19-546ms   | [S4,MB6,F]  548-8-557ms    | [S0,MB0,B]  563-26-589ms   | [S4,MB7,F]  588-7-595ms    | [S0,MB1,B]  603-24-628ms   | [S0,MB2,B]  647-23-671ms   | [S0,MB3,B]  693-23-716ms   | [S4,MB4,B]  722-18-740ms   | [S4,MB5,B]  777-18-795ms   | [S4,MB6,B]  860-18-878ms   | [S4,MB7,B]  912-12-924ms   | [S0,MB4,B]  932-20-952ms   | [S0,MB5,B]  962-23-985ms   | [S0,MB6,B]  988-3-991ms    | [S0,MB7,B]  1009-9-1018ms 
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  49-11-60ms     | [S1,MB2,F]  87-11-98ms     | [S1,MB3,F]  125-11-136ms   | [S5,MB0,F]  162-8-170ms    | [S5,MB1,F]  177-7-184ms    | [S5,MB2,F]  191-7-198ms    | [S5,MB3,F]  269-7-277ms    | [S1,MB4,F]  299-10-310ms   | [S5,MB0,B]  310-19-329ms   | [S1,MB5,F]  335-13-348ms   | [S5,MB1,B]  350-19-370ms   | [S1,MB6,F]  370-11-381ms   | [S5,MB2,B]  431-19-450ms   | [S1,MB7,F]  450-11-461ms   | [S5,MB3,B]  496-19-516ms   | [S5,MB4,F]  516-8-524ms    | [S1,MB0,B]  527-29-556ms   | [S5,MB5,F]  556-9-565ms    | [S1,MB1,B]  565-31-596ms   | [S5,MB6,F]  596-10-607ms   | [S1,MB2,B]  607-34-641ms   | [S5,MB7,F]  641-10-651ms   | [S1,MB3,B]  651-34-685ms   | [S5,MB4,B]  693-22-715ms   | [S5,MB5,B]  752-18-770ms   | [S5,MB6,B]  835-18-853ms   | [S5,MB7,B]  895-9-904ms    | [S1,MB4,B]  911-14-925ms   | [S1,MB5,B]  941-14-955ms   | [S1,MB6,B]  961-14-975ms   | [S1,MB7,B]  988-14-1002ms 
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  60-7-67ms      | [S2,MB2,F]  98-7-105ms     | [S2,MB3,F]  136-7-143ms    | [S6,MB0,F]  170-7-178ms    | [S6,MB1,F]  185-7-192ms    | [S6,MB2,F]  263-7-270ms    | [S6,MB0,B]  270-19-290ms   | [S6,MB3,F]  290-8-298ms    | [S6,MB1,B]  324-19-344ms   | [S2,MB4,F]  344-8-352ms    | [S6,MB2,B]  387-19-406ms   | [S2,MB5,F]  406-7-414ms    | [S6,MB3,B]  469-19-488ms   | [S2,MB6,F]  488-8-497ms    | [S2,MB0,B]  497-20-517ms   | [S2,MB7,F]  517-8-526ms    | [S2,MB1,B]  527-20-548ms   | [S6,MB4,F]  548-8-556ms    | [S2,MB2,B]  563-20-584ms   | [S6,MB5,F]  584-7-592ms    | [S2,MB3,B]  608-19-628ms   | [S6,MB6,F]  628-7-636ms    | [S6,MB4,B]  647-19-667ms   | [S6,MB7,F]  667-7-674ms    | [S6,MB5,B]  726-18-745ms   | [S6,MB6,B]  810-18-828ms   | [S6,MB7,B]  878-10-889ms   | [S2,MB4,B]  895-9-905ms    | [S2,MB5,B]  925-9-934ms    | [S2,MB6,B]  940-13-954ms   | [S2,MB7,B]  961-9-970ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-7-36ms      | [S3,MB1,F]  67-7-74ms      | [S3,MB2,F]  105-7-112ms    | [S3,MB3,F]  143-7-150ms    | [S7,MB0,F]  178-15-194ms   | [S7,MB0,B]  206-48-255ms   | [S7,MB1,F]  254-17-272ms   | [S7,MB1,B]  284-33-317ms   | [S7,MB2,F]  318-16-335ms   | [S7,MB2,B]  346-33-380ms   | [S7,MB3,F]  380-17-397ms   | [S7,MB3,B]  409-53-463ms   | [S3,MB4,F]  463-12-475ms   | [S3,MB0,B]  474-13-488ms   | [S3,MB5,F]  488-10-499ms   | [S3,MB1,B]  498-13-512ms   | [S3,MB6,F]  512-10-522ms   | [S3,MB2,B]  522-12-534ms   | [S3,MB7,F]  535-10-545ms   | [S3,MB3,B]  545-23-568ms   | [S7,MB4,F]  570-17-588ms   | [S7,MB4,B]  599-33-633ms   | [S7,MB5,F]  633-17-650ms   | [S7,MB5,B]  662-57-719ms   | [S7,MB6,F]  720-21-741ms   | [S7,MB6,B]  752-52-804ms   | [S7,MB7,F]  804-21-825ms   | [S7,MB7,B]  836-34-870ms   | [S3,MB4,B]  871-12-884ms   | [S3,MB5,B]  885-13-898ms   | [S3,MB6,B]  898-12-910ms   | [S3,MB7,B]  918-15-934ms  
[rank1]:2025-12-24 17:41:33,640 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/251224_1741_stage1.svg
[rank0]:2025-12-24 17:41:33,643 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/251224_1741_stage0.svg
[rank2]:2025-12-24 17:41:33,656 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/251224_1741_stage2.svg
[rank3]:2025-12-24 17:41:33,670 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank3/251224_1741_stage3_step200.svg
[rank3]:2025-12-24 17:41:33,711 - âœ… Frozen Ratio History of Rank 3 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank3/251224_1741_stage7_step200.svg
[rank0]:2025-12-24 17:41:33,806 - âœ… Scatter Plot of Stage 4 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/251224_1741_stage4.svg
[rank2]:2025-12-24 17:41:33,833 - âœ… Scatter Plot of Stage 6 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/251224_1741_stage6.svg
[rank1]:2025-12-24 17:41:33,800 - âœ… Scatter Plot of Stage 5 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/251224_1741_stage5.svg
[rank3]:2025-12-24 17:41:33,879 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/251224_1741_stage3.svg
[rank3]:2025-12-24 17:41:34,044 - âœ… Scatter Plot of Stage 7 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/251224_1741_stage7.svg
[rank0]:2025-12-24 17:44:49,421 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-24 17:44:49,472 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.33/0.33, [MB4] 0.27/0.27, [MB5] 0.00/0.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-12-24 17:44:49,467 - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 0.40/0.40, [MB0] 1.00/1.00, [MB1] 0.85/0.85, [MB2] 1.00/1.00, [MB3] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 0.00/0.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 0.55/0.55
[rank2]:2025-12-24 17:44:49,443 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.70/0.70, [MB4] 1.00/1.00, [MB5] 0.83/0.83, [MB6] 0.60/0.60, [MB7] 1.00/1.00
[rank1]:2025-12-24 17:44:49,450 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-12-24 17:44:53,345 - Avg. fwd time: 13.7801 / Avg. bwd time: 33.4242 / Avg. batch time: 978.8437 (ms) / GPU bubble ratio: 22.84%
[rank2]:2025-12-24 17:44:53,379 - Avg. fwd time: 7.7903 / Avg. bwd time: 16.9253 / Avg. batch time: 1030.9765 (ms) / GPU bubble ratio: 61.64%
[rank1]:2025-12-24 17:44:53,408 - Avg. fwd time: 10.0124 / Avg. bwd time: 21.3270 / Avg. batch time: 1079.8695 (ms) / GPU bubble ratio: 53.57%
[rank0]:2025-12-24 17:44:53,419 - Avg. fwd time: 8.2901 / Avg. bwd time: 18.4522 / Avg. batch time: 1106.9572 (ms) / GPU bubble ratio: 61.35%
[rank0]:2025-12-24 17:44:53,454 -  step: 250  loss: -4.0000  grad_norm:  1.3278  memory: 22.34GiB(47.02%)  tps: 8,189  tflops: 64.02  mfu: 20.52%
[rank3]:2025-12-24 17:44:53,453 -  step: 250  loss:  0.4299  grad_norm:  1.3278  memory: 32.12GiB(67.61%)  tps: 8,189  tflops: 64.02  mfu: 20.52%
[rank2]:2025-12-24 17:44:53,440 -  step: 250  loss: -4.0000  grad_norm:  1.3278  memory: 12.98GiB(27.32%)  tps: 8,189  tflops: 64.02  mfu: 20.52%
[rank1]:2025-12-24 17:44:53,444 -  step: 250  loss: -4.0000  grad_norm:  1.3278  memory: 19.65GiB(41.35%)  tps: 8,189  tflops: 64.02  mfu: 20.52%
[rank0]:2025-12-24 17:48:09,158 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-24 17:48:09,216 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.33/0.33, [MB4] 0.27/0.27, [MB5] 0.00/0.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-12-24 17:48:09,210 - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 0.40/0.40, [MB0] 1.00/1.00, [MB1] 0.85/0.85, [MB2] 1.00/1.00, [MB3] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 0.00/0.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 0.55/0.55
[rank2]:2025-12-24 17:48:09,186 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.70/0.70, [MB4] 1.00/1.00, [MB5] 0.83/0.83, [MB6] 0.60/0.60, [MB7] 1.00/1.00
[rank1]:2025-12-24 17:48:09,194 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank0]:2025-12-24 17:48:13,145 - Avg. fwd time: 8.2920 / Avg. bwd time: 18.3792 / Avg. batch time: 1084.2249 (ms) / GPU bubble ratio: 60.64%
[rank3]:2025-12-24 17:48:13,071 - Avg. fwd time: 13.6528 / Avg. bwd time: 32.2898 / Avg. batch time: 960.0590 (ms) / GPU bubble ratio: 23.43%
[rank2]:2025-12-24 17:48:13,106 - Avg. fwd time: 7.7894 / Avg. bwd time: 16.8643 / Avg. batch time: 1010.9815 (ms) / GPU bubble ratio: 60.98%
[rank2]:2025-12-24 17:48:13,166 -  step: 300  loss: -4.0000  grad_norm:  2.2657  memory: 12.98GiB(27.32%)  tps: 8,203  tflops: 64.13  mfu: 20.55%
[rank1]:2025-12-24 17:48:13,134 - Avg. fwd time: 10.0376 / Avg. bwd time: 21.2381 / Avg. batch time: 1059.0967 (ms) / GPU bubble ratio: 52.75%
[rank1]:2025-12-24 17:48:13,170 -  step: 300  loss: -4.0000  grad_norm:  2.2657  memory: 19.65GiB(41.35%)  tps: 8,203  tflops: 64.13  mfu: 20.55%
[rank0]:2025-12-24 17:48:13,181 -  step: 300  loss: -4.0000  grad_norm:  2.2657  memory: 22.34GiB(47.02%)  tps: 8,203  tflops: 64.13  mfu: 20.55%
[rank0]:2025-12-24 17:48:13,230 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank0/251224_1748_stage0_step300.svg
[rank3]:2025-12-24 17:48:13,179 -  step: 300  loss:  0.2986  grad_norm:  2.2657  memory: 32.12GiB(67.61%)  tps: 8,203  tflops: 64.13  mfu: 20.55%
[rank2]:2025-12-24 17:48:13,231 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank2/251224_1748_stage2_step300.svg
[rank2]:2025-12-24 17:48:13,273 - âœ… Frozen Ratio History of Rank 2 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank2/251224_1748_stage6_step300.svg
[rank1]:2025-12-24 17:48:13,229 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank1/251224_1748_stage1_step300.svg
[rank1]:2025-12-24 17:48:13,269 - âœ… Frozen Ratio History of Rank 1 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank1/251224_1748_stage5_step300.svg
[rank0]:2025-12-24 17:48:13,271 - âœ… Frozen Ratio History of Rank 0 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank0/251224_1748_stage4_step300.svg
[rank3]:2025-12-24 17:48:13,420 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/pipeline_schedule/251224_1748_step300_rank3.svg
[rank3]:			> Batch Time: 969.00 ms, GPU Bubble Ratio: 56.32%, 48.87%, 59.82%, 34.29%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-7-31ms      | [S4,MB0,F]  49-9-59ms      | [S4,MB1,F]  87-8-95ms      | [S4,MB2,F]  124-8-133ms    | [S4,MB3,F]  162-8-171ms    | [S0,MB4,F]  171-8-179ms    | [S0,MB5,F]  179-7-187ms    | [S0,MB6,F]  187-8-195ms    | [S4,MB0,B]  323-19-342ms   | [S0,MB7,F]  342-7-349ms    | [S4,MB1,B]  413-19-432ms   | [S4,MB4,F]  470-8-478ms    | [S4,MB2,B]  478-19-498ms   | [S4,MB5,F]  500-8-508ms    | [S4,MB3,B]  508-20-528ms   | [S4,MB6,F]  530-8-538ms    | [S0,MB0,B]  545-26-571ms   | [S4,MB7,F]  571-7-578ms    | [S0,MB1,B]  585-24-610ms   | [S0,MB2,B]  631-23-654ms   | [S0,MB3,B]  676-23-699ms   | [S4,MB4,B]  705-18-723ms   | [S4,MB5,B]  759-18-777ms   | [S4,MB6,B]  823-18-841ms   | [S4,MB7,B]  869-15-884ms   | [S0,MB4,B]  891-20-911ms   | [S0,MB5,B]  921-23-945ms   | [S0,MB6,B]  948-0-948ms    | [S0,MB7,B]  969-0-969ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  49-10-60ms     | [S1,MB2,F]  87-10-98ms     | [S1,MB3,F]  125-10-135ms   | [S5,MB0,F]  162-8-170ms    | [S5,MB1,F]  176-7-184ms    | [S5,MB2,F]  191-7-198ms    | [S5,MB3,F]  254-7-261ms    | [S1,MB4,F]  283-10-294ms   | [S5,MB0,B]  294-19-314ms   | [S1,MB5,F]  316-12-329ms   | [S5,MB1,B]  332-19-351ms   | [S1,MB6,F]  351-11-363ms   | [S5,MB2,B]  412-19-431ms   | [S1,MB7,F]  431-11-443ms   | [S5,MB3,B]  478-19-497ms   | [S5,MB4,F]  497-8-506ms    | [S1,MB0,B]  508-29-538ms   | [S5,MB5,F]  538-9-547ms    | [S1,MB1,B]  547-31-578ms   | [S5,MB6,F]  579-10-589ms   | [S1,MB2,B]  589-34-623ms   | [S5,MB7,F]  624-10-634ms   | [S1,MB3,B]  634-34-669ms   | [S5,MB4,B]  676-22-698ms   | [S5,MB5,B]  733-18-752ms   | [S5,MB6,B]  798-18-817ms   | [S5,MB7,B]  853-9-862ms    | [S1,MB4,B]  869-14-883ms   | [S1,MB5,B]  900-14-914ms   | [S1,MB6,B]  921-14-935ms   | [S1,MB7,B]  948-14-962ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-7-28ms      | [S2,MB1,F]  60-7-67ms      | [S2,MB2,F]  98-7-105ms     | [S2,MB3,F]  135-7-142ms    | [S6,MB0,F]  170-7-178ms    | [S6,MB1,F]  184-7-191ms    | [S6,MB2,F]  248-7-255ms    | [S6,MB0,B]  255-19-274ms   | [S6,MB3,F]  274-8-282ms    | [S6,MB1,B]  305-19-325ms   | [S2,MB4,F]  325-8-334ms    | [S6,MB2,B]  368-19-387ms   | [S2,MB5,F]  387-7-395ms    | [S6,MB3,B]  451-19-470ms   | [S2,MB6,F]  470-8-479ms    | [S2,MB0,B]  479-20-499ms   | [S2,MB7,F]  499-8-508ms    | [S2,MB1,B]  509-20-529ms   | [S6,MB4,F]  529-8-537ms    | [S2,MB2,B]  545-21-566ms   | [S6,MB5,F]  566-7-574ms    | [S2,MB3,B]  591-19-611ms   | [S6,MB6,F]  611-7-618ms    | [S6,MB4,B]  631-19-651ms   | [S6,MB7,F]  650-7-658ms    | [S6,MB5,B]  708-18-727ms   | [S6,MB6,B]  774-18-792ms   | [S6,MB7,B]  837-9-847ms    | [S2,MB4,B]  853-9-862ms    | [S2,MB5,B]  885-9-894ms    | [S2,MB6,B]  900-10-911ms   | [S2,MB7,B]  921-9-930ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-7-36ms      | [S3,MB1,F]  67-6-74ms      | [S3,MB2,F]  105-6-112ms    | [S3,MB3,F]  142-6-149ms    | [S7,MB0,F]  178-15-194ms   | [S7,MB0,B]  206-32-238ms   | [S7,MB1,F]  238-15-253ms   | [S7,MB1,B]  266-33-299ms   | [S7,MB2,F]  299-17-316ms   | [S7,MB2,B]  328-33-361ms   | [S7,MB3,F]  361-17-379ms   | [S7,MB3,B]  391-54-445ms   | [S3,MB4,F]  444-11-456ms   | [S3,MB0,B]  457-13-470ms   | [S3,MB5,F]  470-10-480ms   | [S3,MB1,B]  481-13-494ms   | [S3,MB6,F]  494-10-504ms   | [S3,MB2,B]  504-12-516ms   | [S3,MB7,F]  517-10-527ms   | [S3,MB3,B]  527-23-550ms   | [S7,MB4,F]  553-17-570ms   | [S7,MB4,B]  582-33-616ms   | [S7,MB5,F]  616-16-632ms   | [S7,MB5,B]  644-57-701ms   | [S7,MB6,F]  701-21-722ms   | [S7,MB6,B]  731-34-765ms   | [S7,MB7,F]  767-17-785ms   | [S7,MB7,B]  795-34-829ms   | [S3,MB4,B]  830-12-842ms   | [S3,MB5,B]  841-13-855ms   | [S3,MB6,B]  855-12-867ms   | [S3,MB7,B]  878-16-894ms  
[rank3]:2025-12-24 17:48:13,464 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank3/251224_1748_stage3_step300.svg
[rank0]:2025-12-24 17:48:13,560 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/251224_1748_stage0.svg
[rank3]:2025-12-24 17:48:13,504 - âœ… Frozen Ratio History of Rank 3 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank3/251224_1748_stage7_step300.svg
[rank2]:2025-12-24 17:48:13,577 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/251224_1748_stage2.svg
[rank1]:2025-12-24 17:48:13,553 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/251224_1748_stage1.svg
[rank0]:2025-12-24 17:48:13,843 - âœ… Scatter Plot of Stage 4 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/251224_1748_stage4.svg
[rank3]:2025-12-24 17:48:13,799 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/251224_1748_stage3.svg
[rank2]:2025-12-24 17:48:13,875 - âœ… Scatter Plot of Stage 6 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/251224_1748_stage6.svg
[rank1]:2025-12-24 17:48:13,830 - âœ… Scatter Plot of Stage 5 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/251224_1748_stage5.svg
[rank3]:2025-12-24 17:48:14,087 - âœ… Scatter Plot of Stage 7 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/251224_1748_stage7.svg
[rank0]:2025-12-24 17:51:28,684 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-24 17:51:32,639 - Avg. fwd time: 13.5563 / Avg. bwd time: 31.4392 / Avg. batch time: 945.8308 (ms) / GPU bubble ratio: 23.88%
[rank1]:2025-12-24 17:51:32,703 - Avg. fwd time: 10.0591 / Avg. bwd time: 21.1767 / Avg. batch time: 1043.6534 (ms) / GPU bubble ratio: 52.11%
[rank2]:2025-12-24 17:51:32,674 - Avg. fwd time: 7.7884 / Avg. bwd time: 16.8277 / Avg. batch time: 996.0865 (ms) / GPU bubble ratio: 60.46%
[rank2]:2025-12-24 17:51:32,736 -  step: 350  loss: -4.0000  grad_norm:  0.2391  memory: 13.00GiB(27.36%)  tps: 8,210  tflops: 64.18  mfu: 20.57%
[rank0]:2025-12-24 17:51:32,715 - Avg. fwd time: 8.2938 / Avg. bwd time: 18.3115 / Avg. batch time: 1067.3834 (ms) / GPU bubble ratio: 60.12%
[rank0]:2025-12-24 17:51:32,751 -  step: 350  loss: -4.0000  grad_norm:  0.2391  memory: 22.34GiB(47.02%)  tps: 8,210  tflops: 64.18  mfu: 20.57%
[rank3]:2025-12-24 17:51:32,749 -  step: 350  loss:  0.2366  grad_norm:  0.2391  memory: 32.12GiB(67.61%)  tps: 8,210  tflops: 64.18  mfu: 20.57%
[rank1]:2025-12-24 17:51:32,740 -  step: 350  loss: -4.0000  grad_norm:  0.2391  memory: 19.65GiB(41.35%)  tps: 8,210  tflops: 64.18  mfu: 20.57%
[rank0]:2025-12-24 17:54:47,959 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-24 17:54:51,990 - Avg. fwd time: 7.7881 / Avg. bwd time: 16.7863 / Avg. batch time: 985.1737 (ms) / GPU bubble ratio: 60.09%
[rank3]:2025-12-24 17:54:51,956 - Avg. fwd time: 13.4882 / Avg. bwd time: 30.8310 / Avg. batch time: 935.7181 (ms) / GPU bubble ratio: 24.22%
[rank1]:2025-12-24 17:54:52,018 - Avg. fwd time: 10.0725 / Avg. bwd time: 21.1240 / Avg. batch time: 1032.3206 (ms) / GPU bubble ratio: 51.65%
[rank1]:2025-12-24 17:54:52,056 -  step: 400  loss: -4.0000  grad_norm:  0.9654  memory: 19.65GiB(41.35%)  tps: 8,220  tflops: 64.26  mfu: 20.60%
[rank0]:2025-12-24 17:54:52,031 - Avg. fwd time: 8.2956 / Avg. bwd time: 18.2524 / Avg. batch time: 1055.0046 (ms) / GPU bubble ratio: 59.74%
[rank0]:2025-12-24 17:54:52,066 -  step: 400  loss: -4.0000  grad_norm:  0.9654  memory: 22.34GiB(47.02%)  tps: 8,220  tflops: 64.26  mfu: 20.60%
[rank2]:2025-12-24 17:54:52,052 -  step: 400  loss: -4.0000  grad_norm:  0.9654  memory: 13.00GiB(27.36%)  tps: 8,220  tflops: 64.26  mfu: 20.60%
[rank3]:2025-12-24 17:54:52,065 -  step: 400  loss:  0.2210  grad_norm:  0.9654  memory: 32.12GiB(67.61%)  tps: 8,220  tflops: 64.26  mfu: 20.60%
[rank1]:2025-12-24 17:54:52,120 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank1/251224_1754_stage1_step400.svg
[rank0]:2025-12-24 17:54:52,120 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank0/251224_1754_stage0_step400.svg
[rank0]:2025-12-24 17:54:52,164 - âœ… Frozen Ratio History of Rank 0 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank0/251224_1754_stage4_step400.svg
[rank2]:2025-12-24 17:54:52,125 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank2/251224_1754_stage2_step400.svg
[rank2]:2025-12-24 17:54:52,173 - âœ… Frozen Ratio History of Rank 2 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank2/251224_1754_stage6_step400.svg
[rank1]:2025-12-24 17:54:52,164 - âœ… Frozen Ratio History of Rank 1 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank1/251224_1754_stage5_step400.svg
[rank3]:2025-12-24 17:54:52,310 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/pipeline_schedule/251224_1754_step400_rank3.svg
[rank3]:			> Batch Time: 973.00 ms, GPU Bubble Ratio: 57.13%, 49.06%, 59.84%, 34.13%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-7-31ms      | [S4,MB0,F]  49-9-59ms      | [S4,MB1,F]  87-8-96ms      | [S4,MB2,F]  125-8-133ms    | [S4,MB3,F]  163-8-171ms    | [S0,MB4,F]  171-8-179ms    | [S0,MB5,F]  179-7-187ms    | [S0,MB6,F]  187-8-196ms    | [S4,MB0,B]  324-19-344ms   | [S0,MB7,F]  343-7-350ms    | [S4,MB1,B]  414-19-433ms   | [S4,MB4,F]  472-8-480ms    | [S4,MB2,B]  480-19-500ms   | [S4,MB5,F]  501-8-510ms    | [S4,MB3,B]  510-19-530ms   | [S4,MB6,F]  531-8-540ms    | [S0,MB0,B]  545-25-571ms   | [S4,MB7,F]  571-7-578ms    | [S0,MB1,B]  586-24-610ms   | [S0,MB2,B]  631-23-655ms   | [S0,MB3,B]  676-23-700ms   | [S4,MB4,B]  705-18-723ms   | [S4,MB5,B]  760-18-778ms   | [S4,MB6,B]  827-18-845ms   | [S4,MB7,B]  874-13-888ms   | [S0,MB4,B]  895-15-910ms   | [S0,MB5,B]  925-23-949ms   | [S0,MB6,B]  952-0-952ms    | [S0,MB7,B]  973-0-973ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  49-11-60ms     | [S1,MB2,F]  87-11-98ms     | [S1,MB3,F]  125-11-136ms   | [S5,MB0,F]  162-8-171ms    | [S5,MB1,F]  177-7-184ms    | [S5,MB2,F]  191-7-198ms    | [S5,MB3,F]  255-7-262ms    | [S1,MB4,F]  284-10-295ms   | [S5,MB0,B]  295-19-315ms   | [S1,MB5,F]  318-12-330ms   | [S5,MB1,B]  333-19-352ms   | [S1,MB6,F]  352-11-364ms   | [S5,MB2,B]  413-19-432ms   | [S1,MB7,F]  432-11-444ms   | [S5,MB3,B]  479-19-499ms   | [S5,MB4,F]  499-8-507ms    | [S1,MB0,B]  509-29-539ms   | [S5,MB5,F]  538-9-548ms    | [S1,MB1,B]  548-30-578ms   | [S5,MB6,F]  579-10-589ms   | [S1,MB2,B]  590-34-624ms   | [S5,MB7,F]  624-10-635ms   | [S1,MB3,B]  635-34-669ms   | [S5,MB4,B]  676-22-699ms   | [S5,MB5,B]  735-18-754ms   | [S5,MB6,B]  802-18-821ms   | [S5,MB7,B]  858-9-867ms    | [S1,MB4,B]  874-14-888ms   | [S1,MB5,B]  904-14-918ms   | [S1,MB6,B]  925-14-939ms   | [S1,MB7,B]  952-14-966ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  60-7-67ms      | [S2,MB2,F]  98-7-105ms     | [S2,MB3,F]  136-7-143ms    | [S6,MB0,F]  171-7-179ms    | [S6,MB1,F]  185-7-192ms    | [S6,MB2,F]  249-7-256ms    | [S6,MB0,B]  256-19-275ms   | [S6,MB3,F]  275-8-283ms    | [S6,MB1,B]  306-19-326ms   | [S2,MB4,F]  326-8-334ms    | [S6,MB2,B]  369-19-388ms   | [S2,MB5,F]  388-7-396ms    | [S6,MB3,B]  452-19-472ms   | [S2,MB6,F]  472-8-480ms    | [S2,MB0,B]  480-20-501ms   | [S2,MB7,F]  500-8-509ms    | [S2,MB1,B]  510-20-530ms   | [S6,MB4,F]  530-8-538ms    | [S2,MB2,B]  546-21-567ms   | [S6,MB5,F]  567-7-575ms    | [S2,MB3,B]  591-19-611ms   | [S6,MB6,F]  611-7-619ms    | [S6,MB4,B]  631-19-651ms   | [S6,MB7,F]  651-7-659ms    | [S6,MB5,B]  710-18-729ms   | [S6,MB6,B]  777-18-796ms   | [S6,MB7,B]  842-9-852ms    | [S2,MB4,B]  858-9-868ms    | [S2,MB5,B]  888-9-898ms    | [S2,MB6,B]  904-11-916ms   | [S2,MB7,B]  924-9-934ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-7-36ms      | [S3,MB1,F]  67-6-74ms      | [S3,MB2,F]  105-6-112ms    | [S3,MB3,F]  143-7-150ms    | [S7,MB0,F]  179-15-194ms   | [S7,MB0,B]  207-32-239ms   | [S7,MB1,F]  239-15-254ms   | [S7,MB1,B]  266-32-299ms   | [S7,MB2,F]  300-17-317ms   | [S7,MB2,B]  328-33-362ms   | [S7,MB3,F]  362-17-380ms   | [S7,MB3,B]  391-54-446ms   | [S3,MB4,F]  446-11-458ms   | [S3,MB0,B]  457-13-470ms   | [S3,MB5,F]  470-10-480ms   | [S3,MB1,B]  480-13-493ms   | [S3,MB6,F]  493-10-503ms   | [S3,MB2,B]  503-12-515ms   | [S3,MB7,F]  517-10-528ms   | [S3,MB3,B]  527-23-551ms   | [S7,MB4,F]  553-17-571ms   | [S7,MB4,B]  583-33-616ms   | [S7,MB5,F]  617-16-634ms   | [S7,MB5,B]  646-57-703ms   | [S7,MB6,F]  703-21-725ms   | [S7,MB6,B]  737-34-771ms   | [S7,MB7,F]  771-17-789ms   | [S7,MB7,B]  801-34-835ms   | [S3,MB4,B]  835-12-847ms   | [S3,MB5,B]  847-12-860ms   | [S3,MB6,B]  860-11-872ms   | [S3,MB7,B]  881-17-899ms  
[rank3]:2025-12-24 17:54:52,359 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank3/251224_1754_stage3_step400.svg
[rank3]:2025-12-24 17:54:52,404 - âœ… Frozen Ratio History of Rank 3 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank3/251224_1754_stage7_step400.svg
[rank1]:2025-12-24 17:54:52,578 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/251224_1754_stage1.svg
[rank0]:2025-12-24 17:54:52,587 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/251224_1754_stage0.svg
[rank2]:2025-12-24 17:54:52,665 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/251224_1754_stage2.svg
[rank3]:2025-12-24 17:54:52,831 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/251224_1754_stage3.svg
[rank1]:2025-12-24 17:54:52,991 - âœ… Scatter Plot of Stage 5 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/251224_1754_stage5.svg
[rank0]:2025-12-24 17:54:52,995 - âœ… Scatter Plot of Stage 4 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/251224_1754_stage4.svg
[rank2]:2025-12-24 17:54:53,149 - âœ… Scatter Plot of Stage 6 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/251224_1754_stage6.svg
[rank3]:2025-12-24 17:54:53,245 - âœ… Scatter Plot of Stage 7 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/251224_1754_stage7.svg
[rank3]:2025-12-24 17:55:15,590 - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-12-24 17:55:16,021 - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-12-24 17:55:16,034 - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-12-24 17:55:16,036 - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-12-24 17:58:08,334 - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-12-24 17:58:12,313 - Avg. fwd time: 7.7868 / Avg. bwd time: 16.7617 / Avg. batch time: 976.7461 (ms) / GPU bubble ratio: 59.79%
[rank3]:2025-12-24 17:58:12,281 - Avg. fwd time: 13.4392 / Avg. bwd time: 30.3591 / Avg. batch time: 927.8174 (ms) / GPU bubble ratio: 24.47%
[rank1]:2025-12-24 17:58:12,342 - Avg. fwd time: 10.0824 / Avg. bwd time: 21.0842 / Avg. batch time: 1023.6343 (ms) / GPU bubble ratio: 51.28%
[rank1]:2025-12-24 17:58:12,380 -  step: 450  loss: -4.0000  grad_norm:  0.2255  memory: 19.65GiB(41.35%)  tps: 8,179  tflops: 63.94  mfu: 20.49%
[rank0]:2025-12-24 17:58:12,355 - Avg. fwd time: 8.2960 / Avg. bwd time: 18.2207 / Avg. batch time: 1045.5040 (ms) / GPU bubble ratio: 59.42%
[rank0]:2025-12-24 17:58:12,390 -  step: 450  loss: -4.0000  grad_norm:  0.2255  memory: 22.34GiB(47.02%)  tps: 8,179  tflops: 63.94  mfu: 20.49%
[rank2]:2025-12-24 17:58:12,376 -  step: 450  loss: -4.0000  grad_norm:  0.2255  memory: 13.00GiB(27.36%)  tps: 8,179  tflops: 63.94  mfu: 20.49%
[rank3]:2025-12-24 17:58:12,389 -  step: 450  loss:  0.2298  grad_norm:  0.2255  memory: 32.12GiB(67.61%)  tps: 8,179  tflops: 63.94  mfu: 20.49%
[rank0]:2025-12-24 18:01:27,663 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-24 18:01:31,607 - Avg. fwd time: 13.3998 / Avg. bwd time: 29.9795 / Avg. batch time: 921.5444 (ms) / GPU bubble ratio: 24.68%
[rank0]:2025-12-24 18:01:31,680 - Avg. fwd time: 8.2955 / Avg. bwd time: 18.1956 / Avg. batch time: 1037.8081 (ms) / GPU bubble ratio: 59.16%
[rank1]:2025-12-24 18:01:31,666 - Avg. fwd time: 10.0889 / Avg. bwd time: 21.0484 / Avg. batch time: 1016.5925 (ms) / GPU bubble ratio: 50.99%
[rank2]:2025-12-24 18:01:31,638 - Avg. fwd time: 7.7845 / Avg. bwd time: 16.7391 / Avg. batch time: 969.9756 (ms) / GPU bubble ratio: 59.55%
[rank2]:2025-12-24 18:01:31,702 -  step: 500  loss: -4.0000  grad_norm:  0.2039  memory: 13.00GiB(27.36%)  tps: 8,220  tflops: 64.26  mfu: 20.60%
[rank3]:2025-12-24 18:01:31,714 -  step: 500  loss:  0.2256  grad_norm:  0.2039  memory: 32.12GiB(67.61%)  tps: 8,220  tflops: 64.26  mfu: 20.60%
[rank0]:2025-12-24 18:01:31,716 -  step: 500  loss: -4.0000  grad_norm:  0.2039  memory: 22.34GiB(47.02%)  tps: 8,220  tflops: 64.26  mfu: 20.60%
[rank0]:2025-12-24 18:01:31,765 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank0/251224_1801_stage0_step500.svg
[rank1]:2025-12-24 18:01:31,705 -  step: 500  loss: -4.0000  grad_norm:  0.2039  memory: 19.65GiB(41.35%)  tps: 8,220  tflops: 64.26  mfu: 20.60%
[rank1]:2025-12-24 18:01:31,765 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank1/251224_1801_stage1_step500.svg
[rank2]:2025-12-24 18:01:31,766 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank2/251224_1801_stage2_step500.svg
[rank2]:2025-12-24 18:01:31,807 - âœ… Frozen Ratio History of Rank 2 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank2/251224_1801_stage6_step500.svg
[rank0]:2025-12-24 18:01:31,807 - âœ… Frozen Ratio History of Rank 0 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank0/251224_1801_stage4_step500.svg
[rank1]:2025-12-24 18:01:31,806 - âœ… Frozen Ratio History of Rank 1 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank1/251224_1801_stage5_step500.svg
[rank3]:2025-12-24 18:01:31,955 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/pipeline_schedule/251224_1801_step500_rank3.svg
[rank3]:			> Batch Time: 966.50 ms, GPU Bubble Ratio: 57.04%, 48.83%, 59.81%, 34.36%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-7-31ms      | [S4,MB0,F]  49-9-59ms      | [S4,MB1,F]  87-8-95ms      | [S4,MB2,F]  124-8-133ms    | [S4,MB3,F]  162-8-170ms    | [S0,MB4,F]  171-8-179ms    | [S0,MB5,F]  179-7-187ms    | [S0,MB6,F]  187-8-195ms    | [S4,MB0,B]  322-19-341ms   | [S0,MB7,F]  342-7-349ms    | [S4,MB1,B]  411-19-430ms   | [S4,MB4,F]  469-8-477ms    | [S4,MB2,B]  478-19-497ms   | [S4,MB5,F]  499-8-508ms    | [S4,MB3,B]  508-19-528ms   | [S4,MB6,F]  529-8-537ms    | [S0,MB0,B]  543-25-569ms   | [S4,MB7,F]  569-7-576ms    | [S0,MB1,B]  584-24-609ms   | [S0,MB2,B]  629-23-652ms   | [S0,MB3,B]  673-23-697ms   | [S4,MB4,B]  702-18-720ms   | [S4,MB5,B]  756-18-774ms   | [S4,MB6,B]  821-18-839ms   | [S4,MB7,B]  868-12-881ms   | [S0,MB4,B]  889-15-904ms   | [S0,MB5,B]  918-23-942ms   | [S0,MB6,B]  945-0-945ms    | [S0,MB7,B]  966-0-966ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  49-10-60ms     | [S1,MB2,F]  87-10-98ms     | [S1,MB3,F]  124-10-135ms   | [S5,MB0,F]  162-8-170ms    | [S5,MB1,F]  176-7-183ms    | [S5,MB2,F]  190-7-198ms    | [S5,MB3,F]  253-7-261ms    | [S1,MB4,F]  282-10-293ms   | [S5,MB0,B]  293-19-313ms   | [S1,MB5,F]  315-12-328ms   | [S5,MB1,B]  330-19-350ms   | [S1,MB6,F]  350-12-362ms   | [S5,MB2,B]  411-19-430ms   | [S1,MB7,F]  430-11-441ms   | [S5,MB3,B]  477-19-497ms   | [S5,MB4,F]  497-8-505ms    | [S1,MB0,B]  507-29-537ms   | [S5,MB5,F]  536-9-546ms    | [S1,MB1,B]  546-31-577ms   | [S5,MB6,F]  577-10-588ms   | [S1,MB2,B]  587-33-621ms   | [S5,MB7,F]  621-10-632ms   | [S1,MB3,B]  632-34-667ms   | [S5,MB4,B]  673-22-695ms   | [S5,MB5,B]  730-18-749ms   | [S5,MB6,B]  796-18-814ms   | [S5,MB7,B]  852-9-861ms    | [S1,MB4,B]  867-14-882ms   | [S1,MB5,B]  897-14-912ms   | [S1,MB6,B]  918-14-932ms   | [S1,MB7,B]  944-14-959ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-7-28ms      | [S2,MB1,F]  60-7-67ms      | [S2,MB2,F]  98-7-105ms     | [S2,MB3,F]  135-7-142ms    | [S6,MB0,F]  170-7-178ms    | [S6,MB1,F]  184-7-191ms    | [S6,MB2,F]  247-7-254ms    | [S6,MB0,B]  255-19-274ms   | [S6,MB3,F]  273-8-282ms    | [S6,MB1,B]  304-19-324ms   | [S2,MB4,F]  324-8-333ms    | [S6,MB2,B]  367-19-386ms   | [S2,MB5,F]  386-7-393ms    | [S6,MB3,B]  451-19-470ms   | [S2,MB6,F]  470-8-478ms    | [S2,MB0,B]  478-20-498ms   | [S2,MB7,F]  498-8-507ms    | [S2,MB1,B]  508-20-529ms   | [S6,MB4,F]  528-8-536ms    | [S2,MB2,B]  544-21-565ms   | [S6,MB5,F]  566-7-574ms    | [S2,MB3,B]  589-19-609ms   | [S6,MB6,F]  609-7-617ms    | [S6,MB4,B]  629-19-649ms   | [S6,MB7,F]  648-7-656ms    | [S6,MB5,B]  706-18-724ms   | [S6,MB6,B]  772-18-790ms   | [S6,MB7,B]  835-10-846ms   | [S2,MB4,B]  852-9-862ms    | [S2,MB5,B]  882-9-891ms    | [S2,MB6,B]  898-10-908ms   | [S2,MB7,B]  918-9-927ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-7-36ms      | [S3,MB1,F]  67-6-74ms      | [S3,MB2,F]  105-6-112ms    | [S3,MB3,F]  142-6-149ms    | [S7,MB0,F]  178-15-194ms   | [S7,MB0,B]  206-32-238ms   | [S7,MB1,F]  238-15-253ms   | [S7,MB1,B]  265-32-298ms   | [S7,MB2,F]  298-16-314ms   | [S7,MB2,B]  327-33-360ms   | [S7,MB3,F]  360-17-377ms   | [S7,MB3,B]  389-54-443ms   | [S3,MB4,F]  444-12-456ms   | [S3,MB0,B]  455-13-468ms   | [S3,MB5,F]  468-10-479ms   | [S3,MB1,B]  479-13-492ms   | [S3,MB6,F]  492-10-502ms   | [S3,MB2,B]  502-12-515ms   | [S3,MB7,F]  516-10-526ms   | [S3,MB3,B]  526-23-549ms   | [S7,MB4,F]  552-17-569ms   | [S7,MB4,B]  581-33-614ms   | [S7,MB5,F]  614-16-631ms   | [S7,MB5,B]  643-57-700ms   | [S7,MB6,F]  699-20-720ms   | [S7,MB6,B]  731-33-765ms   | [S7,MB7,F]  765-17-782ms   | [S7,MB7,B]  795-33-829ms   | [S3,MB4,B]  828-11-840ms   | [S3,MB5,B]  840-12-853ms   | [S3,MB6,B]  853-11-865ms   | [S3,MB7,B]  875-16-892ms  
[rank3]:2025-12-24 18:01:31,998 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank3/251224_1801_stage3_step500.svg
[rank3]:2025-12-24 18:01:32,039 - âœ… Frozen Ratio History of Rank 3 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank3/251224_1801_stage7_step500.svg
[rank0]:2025-12-24 18:01:32,357 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/251224_1801_stage0.svg
[rank1]:2025-12-24 18:01:32,343 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/251224_1801_stage1.svg
[rank2]:2025-12-24 18:01:32,377 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/251224_1801_stage2.svg
[rank3]:2025-12-24 18:01:32,593 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/251224_1801_stage3.svg
[rank1]:2025-12-24 18:01:32,867 - âœ… Scatter Plot of Stage 5 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/251224_1801_stage5.svg
[rank0]:2025-12-24 18:01:32,900 - âœ… Scatter Plot of Stage 4 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/251224_1801_stage4.svg
[rank2]:2025-12-24 18:01:32,936 - âœ… Scatter Plot of Stage 6 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/251224_1801_stage6.svg
[rank3]:2025-12-24 18:01:33,134 - âœ… Scatter Plot of Stage 7 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/251224_1801_stage7.svg
[rank0]:2025-12-24 18:04:48,756 - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-12-24 18:04:52,769 - Avg. fwd time: 7.7842 / Avg. bwd time: 16.7219 / Avg. batch time: 964.6932 (ms) / GPU bubble ratio: 59.36%
[rank3]:2025-12-24 18:04:52,737 - Avg. fwd time: 13.3707 / Avg. bwd time: 29.6785 / Avg. batch time: 916.5786 (ms) / GPU bubble ratio: 24.85%
[rank0]:2025-12-24 18:04:52,814 - Avg. fwd time: 8.2961 / Avg. bwd time: 18.1700 / Avg. batch time: 1031.7814 (ms) / GPU bubble ratio: 58.96%
[rank0]:2025-12-24 18:04:52,850 -  step: 550  loss: -4.0000  grad_norm:  0.2863  memory: 22.34GiB(47.02%)  tps: 8,146  tflops: 63.68  mfu: 20.41%
[rank1]:2025-12-24 18:04:52,799 - Avg. fwd time: 10.0953 / Avg. bwd time: 21.0199 / Avg. batch time: 1011.0960 (ms) / GPU bubble ratio: 50.76%
[rank1]:2025-12-24 18:04:52,839 -  step: 550  loss: -4.0000  grad_norm:  0.2863  memory: 19.65GiB(41.35%)  tps: 8,146  tflops: 63.68  mfu: 20.41%
[rank2]:2025-12-24 18:04:52,836 -  step: 550  loss: -4.0000  grad_norm:  0.2863  memory: 13.00GiB(27.36%)  tps: 8,146  tflops: 63.68  mfu: 20.41%
[rank3]:2025-12-24 18:04:52,848 -  step: 550  loss:  0.2304  grad_norm:  0.2863  memory: 32.12GiB(67.61%)  tps: 8,146  tflops: 63.68  mfu: 20.41%
[rank0]:2025-12-24 18:08:08,616 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-24 18:08:12,619 - Avg. fwd time: 13.3506 / Avg. bwd time: 29.4247 / Avg. batch time: 912.4467 (ms) / GPU bubble ratio: 24.99%
[rank0]:2025-12-24 18:08:12,696 - Avg. fwd time: 8.2971 / Avg. bwd time: 18.1577 / Avg. batch time: 1026.7255 (ms) / GPU bubble ratio: 58.77%
[rank2]:2025-12-24 18:08:12,653 - Avg. fwd time: 7.7841 / Avg. bwd time: 16.7141 / Avg. batch time: 960.2625 (ms) / GPU bubble ratio: 59.18%
[rank2]:2025-12-24 18:08:12,718 -  step: 600  loss: -4.0000  grad_norm:  1.2499  memory: 13.00GiB(27.36%)  tps: 8,197  tflops: 64.08  mfu: 20.54%
[rank1]:2025-12-24 18:08:12,682 - Avg. fwd time: 10.1033 / Avg. bwd time: 21.0004 / Avg. batch time: 1006.4821 (ms) / GPU bubble ratio: 50.55%
[rank1]:2025-12-24 18:08:12,721 -  step: 600  loss: -4.0000  grad_norm:  1.2499  memory: 19.65GiB(41.35%)  tps: 8,197  tflops: 64.08  mfu: 20.54%
[rank3]:2025-12-24 18:08:12,730 -  step: 600  loss:  0.2259  grad_norm:  1.2499  memory: 32.12GiB(67.61%)  tps: 8,197  tflops: 64.08  mfu: 20.54%
[rank0]:2025-12-24 18:08:12,732 -  step: 600  loss: -4.0000  grad_norm:  1.2499  memory: 22.34GiB(47.02%)  tps: 8,197  tflops: 64.08  mfu: 20.54%
[rank0]:2025-12-24 18:08:12,782 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank0/251224_1808_stage0_step600.svg
[rank0]:2025-12-24 18:08:12,823 - âœ… Frozen Ratio History of Rank 0 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank0/251224_1808_stage4_step600.svg
[rank2]:2025-12-24 18:08:12,785 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank2/251224_1808_stage2_step600.svg
[rank1]:2025-12-24 18:08:12,782 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank1/251224_1808_stage1_step600.svg
[rank1]:2025-12-24 18:08:12,823 - âœ… Frozen Ratio History of Rank 1 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank1/251224_1808_stage5_step600.svg
[rank2]:2025-12-24 18:08:12,829 - âœ… Frozen Ratio History of Rank 2 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank2/251224_1808_stage6_step600.svg
[rank3]:2025-12-24 18:08:12,975 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/pipeline_schedule/251224_1808_step600_rank3.svg
[rank3]:			> Batch Time: 971.50 ms, GPU Bubble Ratio: 56.52%, 48.99%, 59.90%, 34.42%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-7-31ms      | [S4,MB0,F]  49-9-59ms      | [S4,MB1,F]  87-8-95ms      | [S4,MB2,F]  125-8-133ms    | [S4,MB3,F]  162-8-171ms    | [S0,MB4,F]  171-8-179ms    | [S0,MB5,F]  179-7-187ms    | [S0,MB6,F]  187-8-196ms    | [S4,MB0,B]  324-19-343ms   | [S0,MB7,F]  342-7-349ms    | [S4,MB1,B]  413-19-432ms   | [S4,MB4,F]  470-8-478ms    | [S4,MB2,B]  479-19-498ms   | [S4,MB5,F]  500-8-508ms    | [S4,MB3,B]  509-19-528ms   | [S4,MB6,F]  530-8-538ms    | [S0,MB0,B]  544-25-570ms   | [S4,MB7,F]  570-7-578ms    | [S0,MB1,B]  586-24-610ms   | [S0,MB2,B]  631-23-654ms   | [S0,MB3,B]  676-23-699ms   | [S4,MB4,B]  704-18-722ms   | [S4,MB5,B]  758-18-776ms   | [S4,MB6,B]  824-18-842ms   | [S4,MB7,B]  871-15-886ms   | [S0,MB4,B]  893-19-912ms   | [S0,MB5,B]  923-23-947ms   | [S0,MB6,B]  950-0-950ms    | [S0,MB7,B]  971-0-971ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  49-11-60ms     | [S1,MB2,F]  87-11-98ms     | [S1,MB3,F]  125-10-136ms   | [S5,MB0,F]  162-8-171ms    | [S5,MB1,F]  177-7-184ms    | [S5,MB2,F]  191-7-198ms    | [S5,MB3,F]  254-7-261ms    | [S1,MB4,F]  283-11-294ms   | [S5,MB0,B]  294-19-314ms   | [S1,MB5,F]  317-12-330ms   | [S5,MB1,B]  332-19-351ms   | [S1,MB6,F]  352-12-364ms   | [S5,MB2,B]  413-19-432ms   | [S1,MB7,F]  432-11-443ms   | [S5,MB3,B]  478-19-498ms   | [S5,MB4,F]  498-8-506ms    | [S1,MB0,B]  509-29-538ms   | [S5,MB5,F]  538-9-547ms    | [S1,MB1,B]  547-30-578ms   | [S5,MB6,F]  579-10-590ms   | [S1,MB2,B]  590-34-624ms   | [S5,MB7,F]  624-10-634ms   | [S1,MB3,B]  634-34-668ms   | [S5,MB4,B]  675-22-698ms   | [S5,MB5,B]  732-18-751ms   | [S5,MB6,B]  799-18-818ms   | [S5,MB7,B]  855-9-864ms    | [S1,MB4,B]  871-14-885ms   | [S1,MB5,B]  902-14-916ms   | [S1,MB6,B]  923-14-937ms   | [S1,MB7,B]  950-14-964ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-7-28ms      | [S2,MB1,F]  60-7-67ms      | [S2,MB2,F]  98-7-105ms     | [S2,MB3,F]  136-7-143ms    | [S6,MB0,F]  171-7-179ms    | [S6,MB1,F]  185-7-192ms    | [S6,MB2,F]  248-7-255ms    | [S6,MB0,B]  255-19-274ms   | [S6,MB3,F]  274-8-283ms    | [S6,MB1,B]  306-19-326ms   | [S2,MB4,F]  325-8-334ms    | [S6,MB2,B]  368-19-387ms   | [S2,MB5,F]  387-7-395ms    | [S6,MB3,B]  451-19-470ms   | [S2,MB6,F]  470-8-479ms    | [S2,MB0,B]  479-20-499ms   | [S2,MB7,F]  499-8-508ms    | [S2,MB1,B]  509-20-530ms   | [S6,MB4,F]  530-8-538ms    | [S2,MB2,B]  545-21-567ms   | [S6,MB5,F]  566-7-574ms    | [S2,MB3,B]  591-20-611ms   | [S6,MB6,F]  611-7-618ms    | [S6,MB4,B]  630-19-650ms   | [S6,MB7,F]  650-7-658ms    | [S6,MB5,B]  707-18-726ms   | [S6,MB6,B]  775-18-793ms   | [S6,MB7,B]  839-9-848ms    | [S2,MB4,B]  855-9-864ms    | [S2,MB5,B]  886-9-896ms    | [S2,MB6,B]  902-10-913ms   | [S2,MB7,B]  922-9-932ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-7-36ms      | [S3,MB1,F]  67-6-74ms      | [S3,MB2,F]  105-6-112ms    | [S3,MB3,F]  143-6-150ms    | [S7,MB0,F]  179-15-194ms   | [S7,MB0,B]  206-32-238ms   | [S7,MB1,F]  238-15-254ms   | [S7,MB1,B]  266-33-299ms   | [S7,MB2,F]  299-17-316ms   | [S7,MB2,B]  328-33-362ms   | [S7,MB3,F]  361-17-379ms   | [S7,MB3,B]  391-54-445ms   | [S3,MB4,F]  444-12-457ms   | [S3,MB0,B]  456-13-470ms   | [S3,MB5,F]  470-10-480ms   | [S3,MB1,B]  480-13-494ms   | [S3,MB6,F]  493-10-504ms   | [S3,MB2,B]  503-12-516ms   | [S3,MB7,F]  516-10-526ms   | [S3,MB3,B]  526-23-550ms   | [S7,MB4,F]  552-17-570ms   | [S7,MB4,B]  582-33-615ms   | [S7,MB5,F]  615-16-632ms   | [S7,MB5,B]  643-57-701ms   | [S7,MB6,F]  701-21-722ms   | [S7,MB6,B]  734-33-768ms   | [S7,MB7,F]  768-17-785ms   | [S7,MB7,B]  798-34-832ms   | [S3,MB4,B]  832-11-844ms   | [S3,MB5,B]  844-12-857ms   | [S3,MB6,B]  856-11-868ms   | [S3,MB7,B]  880-15-895ms  
[rank3]:2025-12-24 18:08:13,021 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank3/251224_1808_stage3_step600.svg
[rank3]:2025-12-24 18:08:13,064 - âœ… Frozen Ratio History of Rank 3 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank3/251224_1808_stage7_step600.svg
[rank0]:2025-12-24 18:08:13,499 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/251224_1808_stage0.svg
[rank1]:2025-12-24 18:08:13,488 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/251224_1808_stage1.svg
[rank2]:2025-12-24 18:08:13,532 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/251224_1808_stage2.svg
[rank3]:2025-12-24 18:08:13,746 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/251224_1808_stage3.svg
[rank1]:2025-12-24 18:08:14,138 - âœ… Scatter Plot of Stage 5 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/251224_1808_stage5.svg
[rank0]:2025-12-24 18:08:14,155 - âœ… Scatter Plot of Stage 4 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/251224_1808_stage4.svg
[rank2]:2025-12-24 18:08:14,221 - âœ… Scatter Plot of Stage 6 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/251224_1808_stage6.svg
[rank3]:2025-12-24 18:08:14,416 - âœ… Scatter Plot of Stage 7 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/251224_1808_stage7.svg
[rank0]:2025-12-24 18:11:29,438 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-24 18:11:33,402 - Avg. fwd time: 13.3248 / Avg. bwd time: 29.1932 / Avg. batch time: 908.5814 (ms) / GPU bubble ratio: 25.13%
[rank2]:2025-12-24 18:11:33,437 - Avg. fwd time: 7.7835 / Avg. bwd time: 16.7008 / Avg. batch time: 956.3144 (ms) / GPU bubble ratio: 59.04%
[rank1]:2025-12-24 18:11:33,466 - Avg. fwd time: 10.1076 / Avg. bwd time: 20.9790 / Avg. batch time: 1002.3911 (ms) / GPU bubble ratio: 50.38%
[rank3]:2025-12-24 18:11:33,515 -  step: 650  loss:  0.2327  grad_norm:  0.1523  memory: 32.12GiB(67.61%)  tps: 8,160  tflops: 63.79  mfu: 20.45%
[rank0]:2025-12-24 18:11:33,481 - Avg. fwd time: 8.2971 / Avg. bwd time: 18.1386 / Avg. batch time: 1022.2580 (ms) / GPU bubble ratio: 58.62%
[rank0]:2025-12-24 18:11:33,517 -  step: 650  loss: -4.0000  grad_norm:  0.1523  memory: 22.34GiB(47.02%)  tps: 8,160  tflops: 63.79  mfu: 20.45%
[rank2]:2025-12-24 18:11:33,502 -  step: 650  loss: -4.0000  grad_norm:  0.1523  memory: 13.00GiB(27.36%)  tps: 8,160  tflops: 63.79  mfu: 20.45%
[rank1]:2025-12-24 18:11:33,506 -  step: 650  loss: -4.0000  grad_norm:  0.1523  memory: 19.65GiB(41.35%)  tps: 8,160  tflops: 63.79  mfu: 20.45%
[rank0]:2025-12-24 18:14:49,513 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-24 18:14:53,446 - Avg. fwd time: 13.3154 / Avg. bwd time: 29.0098 / Avg. batch time: 905.6513 (ms) / GPU bubble ratio: 25.22%
[rank2]:2025-12-24 18:14:53,478 - Avg. fwd time: 7.7835 / Avg. bwd time: 16.6908 / Avg. batch time: 953.1903 (ms) / GPU bubble ratio: 58.92%
[rank2]:2025-12-24 18:14:53,544 -  step: 700  loss: -4.0000  grad_norm:  0.3541  memory: 13.00GiB(27.36%)  tps: 8,190  tflops: 64.03  mfu: 20.52%
[rank1]:2025-12-24 18:14:53,507 - Avg. fwd time: 10.1111 / Avg. bwd time: 20.9619 / Avg. batch time: 999.1356 (ms) / GPU bubble ratio: 50.24%
[rank1]:2025-12-24 18:14:53,547 -  step: 700  loss: -4.0000  grad_norm:  0.3541  memory: 19.65GiB(41.35%)  tps: 8,190  tflops: 64.03  mfu: 20.52%
[rank3]:2025-12-24 18:14:53,556 -  step: 700  loss:  0.1911  grad_norm:  0.3541  memory: 32.12GiB(67.61%)  tps: 8,190  tflops: 64.03  mfu: 20.52%
[rank0]:2025-12-24 18:14:53,522 - Avg. fwd time: 8.2973 / Avg. bwd time: 18.1233 / Avg. batch time: 1018.6821 (ms) / GPU bubble ratio: 58.50%
[rank0]:2025-12-24 18:14:53,558 -  step: 700  loss: -4.0000  grad_norm:  0.3541  memory: 22.34GiB(47.02%)  tps: 8,190  tflops: 64.03  mfu: 20.52%
[rank2]:2025-12-24 18:14:53,611 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank2/251224_1814_stage2_step700.svg
[rank2]:2025-12-24 18:14:53,658 - âœ… Frozen Ratio History of Rank 2 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank2/251224_1814_stage6_step700.svg
[rank1]:2025-12-24 18:14:53,610 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank1/251224_1814_stage1_step700.svg
[rank1]:2025-12-24 18:14:53,653 - âœ… Frozen Ratio History of Rank 1 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank1/251224_1814_stage5_step700.svg
[rank0]:2025-12-24 18:14:53,610 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank0/251224_1814_stage0_step700.svg
[rank0]:2025-12-24 18:14:53,654 - âœ… Frozen Ratio History of Rank 0 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank0/251224_1814_stage4_step700.svg
[rank3]:2025-12-24 18:14:53,822 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/pipeline_schedule/251224_1814_step700_rank3.svg
[rank3]:			> Batch Time: 970.00 ms, GPU Bubble Ratio: 56.63%, 48.91%, 59.97%, 34.40%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-7-31ms      | [S4,MB0,F]  49-9-59ms      | [S4,MB1,F]  87-8-95ms      | [S4,MB2,F]  124-8-133ms    | [S4,MB3,F]  162-8-171ms    | [S0,MB4,F]  171-8-179ms    | [S0,MB5,F]  179-7-187ms    | [S0,MB6,F]  187-8-195ms    | [S4,MB0,B]  323-19-342ms   | [S0,MB7,F]  342-7-349ms    | [S4,MB1,B]  411-19-430ms   | [S4,MB4,F]  470-8-478ms    | [S4,MB2,B]  478-19-498ms   | [S4,MB5,F]  499-8-508ms    | [S4,MB3,B]  508-19-528ms   | [S4,MB6,F]  529-8-538ms    | [S0,MB0,B]  544-25-570ms   | [S4,MB7,F]  570-7-577ms    | [S0,MB1,B]  585-24-609ms   | [S0,MB2,B]  629-23-653ms   | [S0,MB3,B]  675-23-698ms   | [S4,MB4,B]  704-18-722ms   | [S4,MB5,B]  758-18-776ms   | [S4,MB6,B]  823-18-841ms   | [S4,MB7,B]  869-16-885ms   | [S0,MB4,B]  891-17-908ms   | [S0,MB5,B]  922-23-945ms   | [S0,MB6,B]  949-0-949ms    | [S0,MB7,B]  970-0-970ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  49-10-60ms     | [S1,MB2,F]  87-10-98ms     | [S1,MB3,F]  124-10-135ms   | [S5,MB0,F]  162-8-170ms    | [S5,MB1,F]  176-7-184ms    | [S5,MB2,F]  190-7-198ms    | [S5,MB3,F]  254-7-261ms    | [S1,MB4,F]  283-10-294ms   | [S5,MB0,B]  294-19-314ms   | [S1,MB5,F]  316-13-329ms   | [S5,MB1,B]  331-19-350ms   | [S1,MB6,F]  351-12-363ms   | [S5,MB2,B]  411-19-430ms   | [S1,MB7,F]  430-11-441ms   | [S5,MB3,B]  478-19-497ms   | [S5,MB4,F]  497-8-506ms    | [S1,MB0,B]  507-29-537ms   | [S5,MB5,F]  537-9-546ms    | [S1,MB1,B]  547-31-578ms   | [S5,MB6,F]  578-10-588ms   | [S1,MB2,B]  588-33-622ms   | [S5,MB7,F]  622-10-633ms   | [S1,MB3,B]  633-34-667ms   | [S5,MB4,B]  674-22-696ms   | [S5,MB5,B]  733-18-751ms   | [S5,MB6,B]  798-18-817ms   | [S5,MB7,B]  853-9-862ms    | [S1,MB4,B]  869-14-883ms   | [S1,MB5,B]  901-14-915ms   | [S1,MB6,B]  921-14-935ms   | [S1,MB7,B]  948-14-962ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-7-28ms      | [S2,MB1,F]  60-7-67ms      | [S2,MB2,F]  98-7-105ms     | [S2,MB3,F]  135-7-142ms    | [S6,MB0,F]  170-7-178ms    | [S6,MB1,F]  184-7-191ms    | [S6,MB2,F]  247-7-254ms    | [S6,MB0,B]  255-19-274ms   | [S6,MB3,F]  273-8-282ms    | [S6,MB1,B]  304-19-324ms   | [S2,MB4,F]  324-8-333ms    | [S6,MB2,B]  366-19-386ms   | [S2,MB5,F]  386-7-393ms    | [S6,MB3,B]  451-19-470ms   | [S2,MB6,F]  470-8-479ms    | [S2,MB0,B]  479-20-499ms   | [S2,MB7,F]  499-8-507ms    | [S2,MB1,B]  508-20-529ms   | [S6,MB4,F]  529-8-537ms    | [S2,MB2,B]  545-21-566ms   | [S6,MB5,F]  566-7-574ms    | [S2,MB3,B]  589-19-609ms   | [S6,MB6,F]  610-7-617ms    | [S6,MB4,B]  629-20-649ms   | [S6,MB7,F]  649-7-657ms    | [S6,MB5,B]  707-18-726ms   | [S6,MB6,B]  774-18-792ms   | [S6,MB7,B]  837-9-846ms    | [S2,MB4,B]  853-9-862ms    | [S2,MB5,B]  885-9-895ms    | [S2,MB6,B]  901-9-911ms    | [S2,MB7,B]  921-9-931ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-7-36ms      | [S3,MB1,F]  67-6-74ms      | [S3,MB2,F]  105-6-112ms    | [S3,MB3,F]  142-6-149ms    | [S7,MB0,F]  178-15-194ms   | [S7,MB0,B]  206-32-238ms   | [S7,MB1,F]  238-15-253ms   | [S7,MB1,B]  265-32-298ms   | [S7,MB2,F]  298-16-314ms   | [S7,MB2,B]  326-33-360ms   | [S7,MB3,F]  360-17-377ms   | [S7,MB3,B]  389-54-443ms   | [S3,MB4,F]  444-12-456ms   | [S3,MB0,B]  456-13-469ms   | [S3,MB5,F]  469-10-480ms   | [S3,MB1,B]  480-13-493ms   | [S3,MB6,F]  494-10-504ms   | [S3,MB2,B]  503-12-516ms   | [S3,MB7,F]  517-10-527ms   | [S3,MB3,B]  527-23-550ms   | [S7,MB4,F]  553-17-571ms   | [S7,MB4,B]  582-33-616ms   | [S7,MB5,F]  615-16-632ms   | [S7,MB5,B]  644-57-701ms   | [S7,MB6,F]  701-21-722ms   | [S7,MB6,B]  734-33-768ms   | [S7,MB7,F]  767-17-785ms   | [S7,MB7,B]  796-34-830ms   | [S3,MB4,B]  830-11-841ms   | [S3,MB5,B]  842-12-854ms   | [S3,MB6,B]  855-11-867ms   | [S3,MB7,B]  878-15-894ms  
[rank3]:2025-12-24 18:14:53,873 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank3/251224_1814_stage3_step700.svg
[rank3]:2025-12-24 18:14:53,919 - âœ… Frozen Ratio History of Rank 3 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank3/251224_1814_stage7_step700.svg
[rank1]:2025-12-24 18:14:54,465 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/251224_1814_stage1.svg
[rank0]:2025-12-24 18:14:54,477 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/251224_1814_stage0.svg
[rank2]:2025-12-24 18:14:54,519 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/251224_1814_stage2.svg
[rank3]:2025-12-24 18:14:54,915 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/251224_1814_stage3.svg
[rank1]:2025-12-24 18:14:55,239 - âœ… Scatter Plot of Stage 5 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/251224_1814_stage5.svg
[rank0]:2025-12-24 18:14:55,282 - âœ… Scatter Plot of Stage 4 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/251224_1814_stage4.svg
[rank2]:2025-12-24 18:14:55,339 - âœ… Scatter Plot of Stage 6 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/251224_1814_stage6.svg
[rank3]:2025-12-24 18:14:55,821 - âœ… Scatter Plot of Stage 7 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/251224_1814_stage7.svg
[rank0]:2025-12-24 18:18:11,120 - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-12-24 18:18:15,124 - Avg. fwd time: 7.7838 / Avg. bwd time: 16.6823 / Avg. batch time: 950.4111 (ms) / GPU bubble ratio: 58.81%
[rank3]:2025-12-24 18:18:15,091 - Avg. fwd time: 13.2999 / Avg. bwd time: 28.8432 / Avg. batch time: 902.8704 (ms) / GPU bubble ratio: 25.32%
[rank1]:2025-12-24 18:18:15,154 - Avg. fwd time: 10.1151 / Avg. bwd time: 20.9474 / Avg. batch time: 996.2518 (ms) / GPU bubble ratio: 50.11%
[rank1]:2025-12-24 18:18:15,195 -  step: 750  loss: -4.0000  grad_norm:  0.4176  memory: 19.65GiB(41.35%)  tps: 8,125  tflops: 63.52  mfu: 20.36%
[rank2]:2025-12-24 18:18:15,192 -  step: 750  loss: -4.0000  grad_norm:  0.4176  memory: 13.00GiB(27.36%)  tps: 8,125  tflops: 63.52  mfu: 20.36%
[rank0]:2025-12-24 18:18:15,170 - Avg. fwd time: 8.2978 / Avg. bwd time: 18.1125 / Avg. batch time: 1015.5205 (ms) / GPU bubble ratio: 58.39%
[rank0]:2025-12-24 18:18:15,206 -  step: 750  loss: -4.0000  grad_norm:  0.4176  memory: 22.34GiB(47.02%)  tps: 8,125  tflops: 63.52  mfu: 20.36%
[rank3]:2025-12-24 18:18:15,204 -  step: 750  loss:  0.2369  grad_norm:  0.4176  memory: 32.12GiB(67.61%)  tps: 8,125  tflops: 63.52  mfu: 20.36%
[rank0]:2025-12-24 18:21:30,766 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-24 18:21:34,790 - Avg. fwd time: 13.2903 / Avg. bwd time: 28.6960 / Avg. batch time: 900.5216 (ms) / GPU bubble ratio: 25.40%
[rank1]:2025-12-24 18:21:34,854 - Avg. fwd time: 10.1184 / Avg. bwd time: 20.9341 / Avg. batch time: 993.6403 (ms) / GPU bubble ratio: 50.00%
[rank2]:2025-12-24 18:21:34,824 - Avg. fwd time: 7.7835 / Avg. bwd time: 16.6739 / Avg. batch time: 947.9020 (ms) / GPU bubble ratio: 58.72%
[rank2]:2025-12-24 18:21:34,892 -  step: 800  loss: -4.0000  grad_norm:  1.3355  memory: 13.00GiB(27.36%)  tps: 8,204  tflops: 64.14  mfu: 20.56%
[rank2]:2025-12-24 18:21:34,892 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  1.3355  tps: 8,335  tflops: 65.16  mfu: 19.09%
[rank2]:2025-12-24 18:21:34,892 - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-12-24 18:21:34,893 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-24 18:21:34,871 - Avg. fwd time: 8.2985 / Avg. bwd time: 18.0957 / Avg. batch time: 1012.6675 (ms) / GPU bubble ratio: 58.30%
[rank0]:2025-12-24 18:21:34,906 -  step: 800  loss: -4.0000  grad_norm:  1.3355  memory: 22.34GiB(47.02%)  tps: 8,204  tflops: 64.14  mfu: 20.56%
[rank0]:2025-12-24 18:21:34,906 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  1.3355  tps: 8,334  tflops: 65.15  mfu: 19.08%
[rank0]:2025-12-24 18:21:34,907 - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-12-24 18:21:34,907 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank3]:2025-12-24 18:21:34,904 -  step: 800  loss:  0.2390  grad_norm:  1.3355  memory: 32.12GiB(67.61%)  tps: 8,204  tflops: 64.14  mfu: 20.56%
[rank3]:2025-12-24 18:21:34,905 - â„¹ï¸ final step: 800  loss:  0.2390  grad_norm:  1.3355  tps: 8,340  tflops: 65.20  mfu: 19.21%
[rank3]:2025-12-24 18:21:34,905 - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-12-24 18:21:34,906 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank1]:2025-12-24 18:21:34,896 -  step: 800  loss: -4.0000  grad_norm:  1.3355  memory: 19.65GiB(41.35%)  tps: 8,204  tflops: 64.14  mfu: 20.56%
[rank1]:2025-12-24 18:21:34,896 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  1.3355  tps: 8,335  tflops: 65.16  mfu: 19.10%
[rank1]:2025-12-24 18:21:34,896 - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-12-24 18:21:34,896 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-24 18:21:36,955 - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-12-24 18:21:37,025 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank0/251224_1821_stage0_final800.svg
[rank1]:2025-12-24 18:21:37,024 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank1/251224_1821_stage1_final800.svg
[rank1]:2025-12-24 18:21:37,068 - âœ… Frozen Ratio History of Rank 1 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank1/251224_1821_stage5_final800.svg
[rank2]:2025-12-24 18:21:37,027 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank2/251224_1821_stage2_final800.svg
[rank2]:2025-12-24 18:21:37,072 - âœ… Frozen Ratio History of Rank 2 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank2/251224_1821_stage6_final800.svg
[rank0]:2025-12-24 18:21:37,070 - âœ… Frozen Ratio History of Rank 0 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank0/251224_1821_stage4_final800.svg
[rank1]:2025-12-24 18:21:37,166 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/frozen_params_histogram/251224_1821_rank1_stage5.svg
[rank1]:	> Counts Sum: 59760, Total Sum: 414720 (14.41%), Ratio(%) per element: [14.4, 14.58, 14.75, 14.93, 14.4, 14.4, 14.75, 13.54, 13.71, 14.58, 14.75, 14.58, 14.93, 14.58, 14.58, 14.4, 13.71, 13.71]
[rank2]:2025-12-24 18:21:37,174 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/frozen_params_histogram/251224_1821_rank2_stage6.svg
[rank2]:	> Counts Sum: 46280, Total Sum: 414720 (11.16%), Ratio(%) per element: [13.54, 13.71, 13.19, 12.84, 13.88, 13.36, 13.19, 3.29, 3.12, 13.19, 13.19, 13.36, 13.88, 13.36, 13.54, 13.19, 3.29, 3.64]
[rank0]:2025-12-24 18:21:37,169 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/frozen_params_histogram/251224_1821_rank0_stage4.svg
[rank0]:	> Counts Sum: 27600, Total Sum: 414720 (6.66%), Ratio(%) per element: [6.77, 7.63, 7.98, 7.46, 7.63, 7.29, 8.15, 2.77, 2.95, 9.02, 8.68, 8.33, 7.46, 7.29, 7.81, 6.42, 2.95, 3.12]
[rank3]:2025-12-24 18:21:37,215 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/pipeline_schedule/251224_1821_final800_rank3.svg
[rank3]:			> Batch Time: 973.00 ms, GPU Bubble Ratio: 56.57%, 49.25%, 59.90%, 34.20%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-7-31ms      | [S4,MB0,F]  49-9-59ms      | [S4,MB1,F]  87-8-95ms      | [S4,MB2,F]  125-8-133ms    | [S4,MB3,F]  162-8-171ms    | [S0,MB4,F]  171-8-179ms    | [S0,MB5,F]  179-7-187ms    | [S0,MB6,F]  187-8-195ms    | [S4,MB0,B]  324-19-344ms   | [S0,MB7,F]  343-7-351ms    | [S4,MB1,B]  414-19-433ms   | [S4,MB4,F]  471-8-479ms    | [S4,MB2,B]  479-19-499ms   | [S4,MB5,F]  501-8-509ms    | [S4,MB3,B]  509-19-529ms   | [S4,MB6,F]  531-8-539ms    | [S0,MB0,B]  545-25-571ms   | [S4,MB7,F]  571-7-578ms    | [S0,MB1,B]  586-24-610ms   | [S0,MB2,B]  631-23-654ms   | [S0,MB3,B]  676-23-699ms   | [S4,MB4,B]  705-18-723ms   | [S4,MB5,B]  760-18-778ms   | [S4,MB6,B]  826-18-844ms   | [S4,MB7,B]  873-15-888ms   | [S0,MB4,B]  894-20-914ms   | [S0,MB5,B]  925-23-949ms   | [S0,MB6,B]  952-0-952ms    | [S0,MB7,B]  973-0-973ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  49-10-60ms     | [S1,MB2,F]  87-10-98ms     | [S1,MB3,F]  125-10-136ms   | [S5,MB0,F]  162-8-170ms    | [S5,MB1,F]  176-7-184ms    | [S5,MB2,F]  191-7-198ms    | [S5,MB3,F]  255-7-262ms    | [S1,MB4,F]  284-10-295ms   | [S5,MB0,B]  295-19-315ms   | [S1,MB5,F]  318-12-330ms   | [S5,MB1,B]  333-19-352ms   | [S1,MB6,F]  352-11-364ms   | [S5,MB2,B]  414-19-433ms   | [S1,MB7,F]  433-11-444ms   | [S5,MB3,B]  479-19-498ms   | [S5,MB4,F]  498-8-507ms    | [S1,MB0,B]  509-29-538ms   | [S5,MB5,F]  538-9-547ms    | [S1,MB1,B]  548-30-579ms   | [S5,MB6,F]  579-10-590ms   | [S1,MB2,B]  590-33-623ms   | [S5,MB7,F]  624-10-634ms   | [S1,MB3,B]  635-34-669ms   | [S5,MB4,B]  676-22-698ms   | [S5,MB5,B]  735-18-753ms   | [S5,MB6,B]  801-18-819ms   | [S5,MB7,B]  857-9-866ms    | [S1,MB4,B]  873-14-887ms   | [S1,MB5,B]  904-14-918ms   | [S1,MB6,B]  925-14-939ms   | [S1,MB7,B]  951-14-965ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-7-28ms      | [S2,MB1,F]  60-7-67ms      | [S2,MB2,F]  98-7-105ms     | [S2,MB3,F]  135-7-143ms    | [S6,MB0,F]  170-7-178ms    | [S6,MB1,F]  184-7-192ms    | [S6,MB2,F]  249-7-256ms    | [S6,MB0,B]  256-19-275ms   | [S6,MB3,F]  275-8-283ms    | [S6,MB1,B]  306-19-326ms   | [S2,MB4,F]  326-8-335ms    | [S6,MB2,B]  369-19-389ms   | [S2,MB5,F]  389-7-396ms    | [S6,MB3,B]  452-19-471ms   | [S2,MB6,F]  471-8-480ms    | [S2,MB0,B]  480-20-500ms   | [S2,MB7,F]  500-8-508ms    | [S2,MB1,B]  510-20-530ms   | [S6,MB4,F]  530-8-538ms    | [S2,MB2,B]  546-21-567ms   | [S6,MB5,F]  567-7-575ms    | [S2,MB3,B]  591-19-611ms   | [S6,MB6,F]  611-7-619ms    | [S6,MB4,B]  631-19-650ms   | [S6,MB7,F]  651-7-658ms    | [S6,MB5,B]  709-18-728ms   | [S6,MB6,B]  776-18-794ms   | [S6,MB7,B]  840-10-851ms   | [S2,MB4,B]  857-9-866ms    | [S2,MB5,B]  888-9-898ms    | [S2,MB6,B]  904-11-916ms   | [S2,MB7,B]  924-9-934ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-7-36ms      | [S3,MB1,F]  67-6-74ms      | [S3,MB2,F]  105-6-112ms    | [S3,MB3,F]  143-6-150ms    | [S7,MB0,F]  178-15-194ms   | [S7,MB0,B]  206-32-238ms   | [S7,MB1,F]  239-15-254ms   | [S7,MB1,B]  266-33-300ms   | [S7,MB2,F]  300-17-317ms   | [S7,MB2,B]  329-33-362ms   | [S7,MB3,F]  362-17-380ms   | [S7,MB3,B]  392-53-446ms   | [S3,MB4,F]  445-12-457ms   | [S3,MB0,B]  457-13-470ms   | [S3,MB5,F]  470-10-481ms   | [S3,MB1,B]  481-13-494ms   | [S3,MB6,F]  494-10-504ms   | [S3,MB2,B]  504-12-517ms   | [S3,MB7,F]  517-10-527ms   | [S3,MB3,B]  527-23-550ms   | [S7,MB4,F]  553-17-571ms   | [S7,MB4,B]  583-33-616ms   | [S7,MB5,F]  616-17-633ms   | [S7,MB5,B]  645-57-703ms   | [S7,MB6,F]  703-21-724ms   | [S7,MB6,B]  735-34-770ms   | [S7,MB7,F]  770-17-788ms   | [S7,MB7,B]  799-34-834ms   | [S3,MB4,B]  833-12-845ms   | [S3,MB5,B]  845-13-859ms   | [S3,MB6,B]  858-12-870ms   | [S3,MB7,B]  881-15-897ms  
[rank3]:2025-12-24 18:21:37,449 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/pipeline_schedule/251224_1821_thry_final800_rank3.svg
[rank3]:			> Batch Time: 561.81 ms, GPU Bubble Ratio: 15.79%, 15.79%, 15.79%, 15.79%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-19ms       | [S0,MB2,F]  19-9-29ms      | [S0,MB3,F]  29-9-39ms      | [S4,MB0,F]  39-9-49ms      | [S4,MB1,F]  49-9-59ms      | [S4,MB2,F]  59-9-68ms      | [S4,MB3,F]  68-9-78ms      | [S0,MB4,F]  78-9-88ms      | [S0,MB5,F]  88-9-98ms      | [S0,MB6,F]  98-9-108ms     | [S4,MB0,B]  137-19-157ms   | [S0,MB7,F]  157-9-167ms    | [S4,MB1,B]  167-19-187ms   | [S4,MB4,F]  197-9-206ms    | [S4,MB2,B]  206-19-226ms   | [S4,MB5,F]  226-9-236ms    | [S4,MB3,B]  236-19-256ms   | [S4,MB6,F]  256-9-266ms    | [S0,MB0,B]  266-19-285ms   | [S4,MB7,F]  285-9-295ms    | [S0,MB1,B]  295-19-315ms   | [S0,MB2,B]  315-19-335ms   | [S0,MB3,B]  344-19-364ms   | [S4,MB4,B]  374-19-394ms   | [S4,MB5,B]  404-19-423ms   | [S4,MB6,B]  433-19-453ms   | [S4,MB7,B]  463-19-482ms   | [S0,MB4,B]  482-19-502ms   | [S0,MB5,B]  502-19-522ms   | [S0,MB6,B]  522-19-542ms   | [S0,MB7,B]  542-19-561ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-9-19ms       | [S1,MB1,F]  19-9-29ms      | [S1,MB2,F]  29-9-39ms      | [S1,MB3,F]  39-9-49ms      | [S5,MB0,F]  49-9-59ms      | [S5,MB1,F]  59-9-68ms      | [S5,MB2,F]  68-9-78ms      | [S5,MB3,F]  78-9-88ms      | [S1,MB4,F]  88-9-98ms      | [S5,MB0,B]  118-19-137ms   | [S1,MB5,F]  137-9-147ms    | [S5,MB1,B]  147-19-167ms   | [S1,MB6,F]  167-9-177ms    | [S5,MB2,B]  177-19-197ms   | [S1,MB7,F]  197-9-206ms    | [S5,MB3,B]  206-19-226ms   | [S5,MB4,F]  226-9-236ms    | [S1,MB0,B]  236-19-256ms   | [S5,MB5,F]  256-9-266ms    | [S1,MB1,B]  266-19-285ms   | [S5,MB6,F]  285-9-295ms    | [S1,MB2,B]  295-19-315ms   | [S5,MB7,F]  315-9-325ms    | [S1,MB3,B]  325-19-344ms   | [S5,MB4,B]  354-19-374ms   | [S5,MB5,B]  384-19-404ms   | [S5,MB6,B]  413-19-433ms   | [S5,MB7,B]  443-19-463ms   | [S1,MB4,B]  463-19-482ms   | [S1,MB5,B]  482-19-502ms   | [S1,MB6,B]  502-19-522ms   | [S1,MB7,B]  522-19-542ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  19-9-29ms      | [S2,MB1,F]  29-9-39ms      | [S2,MB2,F]  39-9-49ms      | [S2,MB3,F]  49-9-59ms      | [S6,MB0,F]  59-9-68ms      | [S6,MB1,F]  68-9-78ms      | [S6,MB2,F]  78-9-88ms      | [S6,MB0,B]  98-19-118ms    | [S6,MB3,F]  118-9-128ms    | [S6,MB1,B]  128-19-147ms   | [S2,MB4,F]  147-9-157ms    | [S6,MB2,B]  157-19-177ms   | [S2,MB5,F]  177-9-187ms    | [S6,MB3,B]  187-19-206ms   | [S2,MB6,F]  206-9-216ms    | [S2,MB0,B]  216-19-236ms   | [S2,MB7,F]  236-9-246ms    | [S2,MB1,B]  246-19-266ms   | [S6,MB4,F]  266-9-275ms    | [S2,MB2,B]  275-19-295ms   | [S6,MB5,F]  295-9-305ms    | [S2,MB3,B]  305-19-325ms   | [S6,MB6,F]  325-9-335ms    | [S6,MB4,B]  335-19-354ms   | [S6,MB7,F]  354-9-364ms    | [S6,MB5,B]  364-19-384ms   | [S6,MB6,B]  394-19-413ms   | [S6,MB7,B]  423-19-443ms   | [S2,MB4,B]  443-19-463ms   | [S2,MB5,B]  463-19-482ms   | [S2,MB6,B]  482-19-502ms   | [S2,MB7,B]  502-19-522ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-9-39ms      | [S3,MB1,F]  39-9-49ms      | [S3,MB2,F]  49-9-59ms      | [S3,MB3,F]  59-9-68ms      | [S7,MB0,F]  68-9-78ms      | [S7,MB0,B]  78-19-98ms     | [S7,MB1,F]  98-9-108ms     | [S7,MB1,B]  108-19-128ms   | [S7,MB2,F]  128-9-137ms    | [S7,MB2,B]  137-19-157ms   | [S7,MB3,F]  157-9-167ms    | [S7,MB3,B]  167-19-187ms   | [S3,MB4,F]  187-9-197ms    | [S3,MB0,B]  197-19-216ms   | [S3,MB5,F]  216-9-226ms    | [S3,MB1,B]  226-19-246ms   | [S3,MB6,F]  246-9-256ms    | [S3,MB2,B]  256-19-275ms   | [S3,MB7,F]  275-9-285ms    | [S3,MB3,B]  285-19-305ms   | [S7,MB4,F]  305-9-315ms    | [S7,MB4,B]  315-19-335ms   | [S7,MB5,F]  335-9-344ms    | [S7,MB5,B]  344-19-364ms   | [S7,MB6,F]  364-9-374ms    | [S7,MB6,B]  374-19-394ms   | [S7,MB7,F]  394-9-404ms    | [S7,MB7,B]  404-19-423ms   | [S3,MB4,B]  423-19-443ms   | [S3,MB5,B]  443-19-463ms   | [S3,MB6,B]  463-19-482ms   | [S3,MB7,B]  482-19-502ms  
[rank3]:2025-12-24 18:21:37,497 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank3/251224_1821_stage3_final800.svg
[rank3]:2025-12-24 18:21:37,542 - âœ… Frozen Ratio History of Rank 3 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/frozen_ratio_history/rank3/251224_1821_stage7_final800.svg
[rank3]:2025-12-24 18:21:37,625 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/frozen_params_histogram/251224_1821_rank3_stage7.svg
[rank3]:	> Counts Sum: 194120, Total Sum: 253440 (76.59%), Ratio(%) per element: [81.25, 81.94, 79.68, 82.11, 81.07, 81.77, 81.59, 68.57, 68.4, 68.4, 67.7]
[rank1]:2025-12-24 18:21:38,074 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/251224_1821_stage1.svg
[rank0]:2025-12-24 18:21:38,114 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/251224_1821_stage0.svg
[rank2]:2025-12-24 18:21:38,148 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/251224_1821_stage2.svg
[rank3]:2025-12-24 18:21:38,560 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/251224_1821_stage3.svg
[rank1]:2025-12-24 18:21:38,966 - âœ… Scatter Plot of Stage 5 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/251224_1821_stage5.svg
[rank1]:2025-12-24 18:21:38,970 - Destroying the purge thread.
[rank0]:2025-12-24 18:21:39,029 - âœ… Scatter Plot of Stage 4 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/251224_1821_stage4.svg
[rank0]:2025-12-24 18:21:39,033 - Sleeping 2 seconds for other ranks to complete
[rank2]:2025-12-24 18:21:39,104 - âœ… Scatter Plot of Stage 6 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/251224_1821_stage6.svg
[rank2]:2025-12-24 18:21:39,108 - Destroying the purge thread.
[rank2]:2025-12-24 18:21:39,319 - Process group destroyed
[rank1]:2025-12-24 18:21:39,402 - Process group destroyed
[rank3]:2025-12-24 18:21:39,481 - âœ… Scatter Plot of Stage 7 is saved as: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1/afr_time_plot/251224_1821_stage7.svg
[rank3]:2025-12-24 18:21:39,485 - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading history steps 15-16, summary, console lines 316-339
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–ˆâ–‡â–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–ˆâ–‡â–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 3.92902
[rank3]:wandb:               final/avg_loss 0.23896
[rank3]:wandb:             final/avg_mfu(%) 19.21088
[rank3]:wandb:             final/avg_tflops 65.19823
[rank3]:wandb:    final/avg_throughput(tps) 8339.99337
[rank3]:wandb:              final/grad_norm 1.33551
[rank3]:wandb:               final/max_loss 0.23896
[rank3]:wandb:                    grad_norm 1.33551
[rank3]:wandb: loss_metrics/global_avg_loss 0.23896
[rank3]:wandb: loss_metrics/global_max_loss 0.23896
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1224_Interleaved1F1B_timelyapf_42_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/zfyv6fp0
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1224_Interleaved1F1B_timelyapf_42_dm1/20251224-1725/wandb/run-20251224_172553-zfyv6fp0/logs
[rank3]:2025-12-24 18:21:40,875 - Process group destroyed
[rank0]:2025-12-24 18:21:41,033 - Training completed
[rank0]:2025-12-24 18:21:41,033 - Destroying the purge thread.
[rank0]:2025-12-24 18:21:41,359 - Process group destroyed
[rank0]:Stage 0: Modules to keep: {'layers.1', 'tok_embeddings', 'layers.0'}
[rank0]:Stage 4: Modules to keep: {'layers.9', 'layers.10'}
[rank2]:Stage 2: Modules to keep: {'layers.6', 'layers.5'}
[rank2]:Stage 6: Modules to keep: {'layers.14', 'layers.13'}
[rank1]:Stage 1: Modules to keep: {'layers.3', 'layers.4', 'layers.2'}
[rank1]:Stage 5: Modules to keep: {'layers.11', 'layers.12'}
[rank3]:Stage 3: Modules to keep: {'layers.7', 'layers.8'}
[rank3]:Stage 7: Modules to keep: {'layers.15', 'norm', 'output'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1224.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 but debugged requires_grad bug
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1224_Interleaved1F1B_timelyapf_42_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1224_Interleaved1F1B_timelyapf_42_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1224_Interleaved1F1B_timelyapf_42_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1224_Interleaved1F1B_timelyapf_42_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1224_Interleaved1F1B_timelyapf_42_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1224_Interleaved1F1B_timelyapf_42_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 42
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: Interleaved1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 4
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 2
[rank3]:		- stages_list: [3, 7]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1224_Interleaved1F1B_timelyapf_42_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1224_Interleaved1F1B_timelyapf_42_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: timelyapf
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.01
[rank3]:		- percentile: 80
[rank3]:
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
