
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 11. 27. (ëª©) 01:26:21 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 0,1,2,3
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/1109_1F1B_fullrand7_42_forfun.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset

âœ”ï¸Running with fullrand7 x 1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1109.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=fullrand7 --freezing.threshold=0.01 --freezing.percentile=80 --freezing.max_freeze_ratio=0.8
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank0]:2025-11-27 01:26:28,146 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank0]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank0]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank0]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank0]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank0]:"
[rank1]:2025-11-27 01:26:28,175 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank1]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank1]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank1]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank1]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank1]:"
[rank3]:2025-11-27 01:26:28,145 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:"
[rank2]:2025-11-27 01:26:28,322 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank2]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank2]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank2]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank2]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank2]:"
[rank0]:2025-11-27 01:26:28,413 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-11-27 01:26:28,415 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-27 01:26:28,419 - INFO - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-11-27 01:26:28,420 - INFO - Loading tokenizer from tokenizer.json
[rank3]:2025-11-27 01:26:28,399 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-11-27 01:26:28,402 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-11-27 01:26:28,486 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-11-27 01:26:28,488 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-11-27 01:26:28,562 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-11-27 01:26:28,565 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-27 01:26:28,809 - INFO - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank2]:2025-11-27 01:26:31,915 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-11-27 01:26:31,954 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-11-27 01:26:31,983 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-11-27 01:26:31,983 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2025-11-27 01:26:32,063 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank1]:2025-11-27 01:26:32,122 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-11-27 01:26:32,214 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-11-27 01:26:32,168 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-11-27 01:26:32,197 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-11-27 01:26:32,197 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank2]:2025-11-27 01:26:32,172 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-11-27 01:26:32,172 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-11-27 01:26:32,172 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank0]:2025-11-27 01:26:32,252 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-27 01:26:32,253 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-11-27 01:26:32,278 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-11-27 01:26:32,278 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2025-11-27 01:26:32,381 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-11-27 01:26:32,381 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-11-27 01:26:32,381 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank0]:2025-11-27 01:26:32,462 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-27 01:26:32,462 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-11-27 01:26:32,462 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run hslww0r5
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1109_1F1B_fullrand7_42_forfun_dm1/20251127-0126/wandb/run-20251127_012632-hslww0r5
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1109_1F1B_fullrand7_42_forfun_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/hslww0r5
[rank3]:2025-11-27 01:26:34,108 - INFO - WandB logging enabled
[rank3]:2025-11-27 01:26:34,108 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-11-27 01:26:34,148 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-11-27 01:26:34,177 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-11-27 01:26:34,178 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank2]:2025-11-27 01:26:34,379 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank1]:2025-11-27 01:26:34,379 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-27 01:26:34,379 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1109_1F1B_fullrand7_42_forfun_dm1
[rank3]:2025-11-27 01:26:34,361 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-27 01:26:34,379 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-27 01:26:34,379 - INFO - Trainer is initialized with local batch size 32, global batch size 128, gradient accumulation steps 4, sequence length 1024, total steps 800 (warmup 100)
[rank3]:2025-11-27 01:26:34,362 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-11-27 01:26:34,363 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2025-11-27 01:26:34,379 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-27 01:26:34,379 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank0]:2025-11-27 01:26:36,817 - INFO - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-11-27 01:26:36,818 - INFO - Finished loading the checkpoint in 2.44 seconds.
[rank0]:2025-11-27 01:26:36,818 - INFO - Training starts at step 1
[rank3]:2025-11-27 01:26:42,080 - INFO -  step:  1  loss: 10.6092  grad_norm: 203.0656  memory: 21.88GiB(46.05%)  tps: 4,132  tflops: 32.30  mfu: 10.35%
[rank3]:2025-11-27 01:26:42,081 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-11-27 01:26:42,071 - INFO -  step:  1  loss: -4.0000  grad_norm: 203.0656  memory:  6.84GiB(14.41%)  tps: 3,239  tflops: 25.32  mfu: 8.12%
[rank2]:2025-11-27 01:26:42,071 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-11-27 01:26:42,075 - INFO -  step:  1  loss: -4.0000  grad_norm: 203.0656  memory: 10.58GiB(22.26%)  tps: 3,308  tflops: 25.86  mfu: 8.29%
[rank1]:2025-11-27 01:26:42,079 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-27 01:26:42,109 - INFO -  step:  1  loss: -4.0000  grad_norm: 203.0656  memory: 13.10GiB(27.57%)  tps: 3,324  tflops: 25.99  mfu: 8.33%
[rank0]:2025-11-27 01:26:42,109 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-27 01:30:38,425 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-27 01:30:42,804 - INFO - Avg. fwd time: 25.3622 / Avg. bwd time: 82.5470 / Avg. batch time: 1008.8939 (ms) / GPU bubble ratio: 14.43%
[rank0]:2025-11-27 01:30:42,945 - INFO - Avg. fwd time: 15.2324 / Avg. bwd time: 39.5796 / Avg. batch time: 1203.2214 (ms) / GPU bubble ratio: 63.56%
[rank2]:2025-11-27 01:30:42,869 - INFO - Avg. fwd time: 15.2240 / Avg. bwd time: 35.3802 / Avg. batch time: 1067.6159 (ms) / GPU bubble ratio: 62.08%
[rank1]:2025-11-27 01:30:42,984 - INFO - Avg. fwd time: 19.8162 / Avg. bwd time: 45.0453 / Avg. batch time: 1139.9130 (ms) / GPU bubble ratio: 54.48%
[rank1]:2025-11-27 01:30:43,341 - INFO -  step: 50  loss: -4.0000  grad_norm: 23.9587  memory: 12.86GiB(27.07%)  tps: 6,655  tflops: 52.03  mfu: 16.68%
[rank2]:2025-11-27 01:30:43,338 - INFO -  step: 50  loss: -4.0000  grad_norm: 23.9587  memory:  8.66GiB(18.23%)  tps: 6,655  tflops: 52.03  mfu: 16.67%
[rank3]:2025-11-27 01:30:43,350 - INFO -  step: 50  loss:  9.8851  grad_norm: 23.9587  memory: 25.79GiB(54.28%)  tps: 6,655  tflops: 52.03  mfu: 16.67%
[rank0]:2025-11-27 01:30:43,352 - INFO -  step: 50  loss: -4.0000  grad_norm: 23.9587  memory: 16.87GiB(35.50%)  tps: 6,656  tflops: 52.03  mfu: 16.68%
[rank3]:2025-11-27 01:31:32,752 - INFO - [Step 60] ã€°ï¸ Monitoring Upperbound
[rank3]:2025-11-27 01:32:22,120 - INFO - [Step 70] âœ”ï¸  Setting Upperbound
[rank3]:2025-11-27 01:32:22,678 - INFO - [Step 70] ã€°ï¸ Monitoring Lowerbound
[rank1]:2025-11-27 01:32:22,712 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-27 01:32:22,743 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-27 01:32:22,714 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-27 01:32:22,741 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-27 01:32:22,772 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-27 01:32:22,703 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-27 01:32:22,732 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-27 01:32:22,762 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-27 01:32:22,701 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-27 01:32:22,724 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-27 01:32:22,748 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-27 01:32:22,774 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-27 01:32:22,776 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-27 01:32:22,887 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-27 01:32:22,842 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-27 01:32:22,933 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-27 01:32:22,932 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-27 01:32:22,984 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-27 01:32:23,004 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-27 01:32:23,021 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-27 01:32:23,029 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-27 01:32:23,069 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-27 01:32:23,137 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-27 01:32:23,097 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-27 01:32:23,098 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-27 01:32:23,099 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-27 01:32:23,100 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-27 01:32:23,102 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-27 01:32:23,174 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-27 01:32:23,111 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-27 01:32:23,169 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-27 01:32:23,211 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-27 01:33:32,323 - INFO - [Step 90] âœ”ï¸  Setting Lowerbound
[rank3]:2025-11-27 01:33:32,542 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/pipeline_schedule/251127_0133_max_batch_time.svg
[rank3]:> Batch Time: 1056.84 ms, GPU Bubble Ratio: 58.13%, 50.30%, 61.32%, 16.40%
[rank3]:2025-11-27 01:33:32,688 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/pipeline_schedule/251127_0133_min_batch_time.svg
[rank3]:> Batch Time: 662.38 ms, GPU Bubble Ratio: 81.51%, 47.85%, 59.30%, 14.23%
[rank3]:2025-11-27 01:33:32,845 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/pipeline_schedule/251127_0133_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 720.93 ms, GPU Bubble Ratio: 45.29%, 30.20%, 45.69%, 13.07%
[rank3]:2025-11-27 01:33:32,846 - INFO - 	> Batch Time: 720.93 ms (Average Freeze Ratio: 0.30, Time Reduction Rate: 0.32)
[rank0]:2025-11-27 01:34:08,241 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-27 01:34:11,637 - INFO - Avg. fwd time: 26.4951 / Avg. bwd time: 72.6719 / Avg. batch time: 939.5311 (ms) / GPU bubble ratio: 15.56%
[rank2]:2025-11-27 01:34:11,778 - INFO - Avg. fwd time: 15.4674 / Avg. bwd time: 31.6319 / Avg. batch time: 995.3618 (ms) / GPU bubble ratio: 62.14%
[rank1]:2025-11-27 01:34:11,847 - INFO - Avg. fwd time: 20.1023 / Avg. bwd time: 40.1048 / Avg. batch time: 1062.7165 (ms) / GPU bubble ratio: 54.68%
[rank0]:2025-11-27 01:34:11,857 - INFO - Avg. fwd time: 15.4905 / Avg. bwd time: 29.9280 / Avg. batch time: 1116.9456 (ms) / GPU bubble ratio: 67.47%
[rank3]:2025-11-27 01:34:12,040 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.33/1.00, [MB2] 0.33/1.00, [MB3] 0.33/1.00, [MB4] 0.33/1.00, [MB5] 0.13/0.40, [MB6] 0.33/1.00, [MB7] 0.33/1.00
[rank2]:2025-11-27 01:34:12,058 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.33/1.00
[rank3]:2025-11-27 01:34:12,140 - INFO -  step: 100  loss:  9.1875  grad_norm:  0.0000  memory: 25.79GiB(54.28%)  tps: 7,847  tflops: 61.35  mfu: 19.66%
[rank1]:2025-11-27 01:34:12,104 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.33/1.00
[rank1]:2025-11-27 01:34:12,156 - INFO -  step: 100  loss: -4.0000  grad_norm:  1.8497  memory: 12.88GiB(27.11%)  tps: 7,846  tflops: 61.34  mfu: 19.66%
[rank0]:2025-11-27 01:34:12,138 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.07/0.21, [MB7] 0.33/1.00
[rank0]:2025-11-27 01:34:12,170 - INFO -  step: 100  loss: -4.0000  grad_norm:  1.8497  memory: 16.87GiB(35.50%)  tps: 7,846  tflops: 61.34  mfu: 19.66%
[rank0]:2025-11-27 01:34:12,226 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/freeze_ratio_history/rank0/251127_0134_stage0_step100.svg
[rank2]:2025-11-27 01:34:12,153 - INFO -  step: 100  loss: -4.0000  grad_norm:  1.8497  memory:  8.70GiB(18.31%)  tps: 7,846  tflops: 61.34  mfu: 19.66%
[rank2]:2025-11-27 01:34:12,228 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/freeze_ratio_history/rank2/251127_0134_stage2_step100.svg
[rank1]:2025-11-27 01:34:12,228 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/freeze_ratio_history/rank1/251127_0134_stage1_step100.svg
[rank3]:2025-11-27 01:34:12,309 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/pipeline_schedule/251127_0134_real_step100_rank3.svg
[rank3]:> Batch Time: 946.69 ms, GPU Bubble Ratio: 71.82%, 52.13%, 60.76%, 33.73%
[rank3]:2025-11-27 01:34:12,351 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/freeze_ratio_history/rank3/251127_0134_stage3_step100.svg
[rank0]:2025-11-27 01:37:52,004 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-27 01:37:56,232 - INFO - Avg. fwd time: 15.4684 / Avg. bwd time: 32.2850 / Avg. batch time: 982.7117 (ms) / GPU bubble ratio: 61.13%
[rank2]:2025-11-27 01:37:56,239 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.67/1.00
[rank3]:2025-11-27 01:37:56,191 - INFO - Avg. fwd time: 26.7358 / Avg. bwd time: 70.7248 / Avg. batch time: 926.4159 (ms) / GPU bubble ratio: 15.84%
[rank3]:2025-11-27 01:37:56,197 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.67/1.00, [MB2] 0.67/1.00, [MB3] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.27/0.40, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank1]:2025-11-27 01:37:56,282 - INFO - Avg. fwd time: 20.0851 / Avg. bwd time: 40.6361 / Avg. batch time: 1051.1657 (ms) / GPU bubble ratio: 53.79%
[rank1]:2025-11-27 01:37:56,291 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.67/1.00
[rank0]:2025-11-27 01:37:56,324 - INFO - Avg. fwd time: 15.4838 / Avg. bwd time: 30.6632 / Avg. batch time: 1106.6064 (ms) / GPU bubble ratio: 66.64%
[rank0]:2025-11-27 01:37:56,331 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.14/0.21, [MB7] 0.67/1.00
[rank3]:2025-11-27 01:37:56,357 - INFO -  step: 150  loss:  5.0116  grad_norm:  6.3105  memory: 25.79GiB(54.28%)  tps: 7,307  tflops: 57.12  mfu: 18.31%
[rank1]:2025-11-27 01:37:56,349 - INFO -  step: 150  loss: -4.0000  grad_norm:  6.3105  memory: 12.90GiB(27.16%)  tps: 7,308  tflops: 57.13  mfu: 18.31%
[rank0]:2025-11-27 01:37:56,362 - INFO -  step: 150  loss: -4.0000  grad_norm:  6.3105  memory: 16.95GiB(35.67%)  tps: 7,308  tflops: 57.13  mfu: 18.31%
[rank2]:2025-11-27 01:37:56,345 - INFO -  step: 150  loss: -4.0000  grad_norm:  6.3105  memory:  8.70GiB(18.31%)  tps: 7,308  tflops: 57.13  mfu: 18.31%
[rank0]:2025-11-27 01:41:18,816 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-27 01:41:22,348 - INFO - Avg. fwd time: 26.9756 / Avg. bwd time: 67.4816 / Avg. batch time: 903.3992 (ms) / GPU bubble ratio: 16.35%
[rank3]:2025-11-27 01:41:22,353 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 0.40/0.40, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank2]:2025-11-27 01:41:22,483 - INFO - Avg. fwd time: 15.4753 / Avg. bwd time: 32.2709 / Avg. batch time: 959.6014 (ms) / GPU bubble ratio: 60.19%
[rank1]:2025-11-27 01:41:22,556 - INFO - Avg. fwd time: 20.0489 / Avg. bwd time: 40.2008 / Avg. batch time: 1028.2420 (ms) / GPU bubble ratio: 53.12%
[rank0]:2025-11-27 01:41:22,564 - INFO - Avg. fwd time: 15.5163 / Avg. bwd time: 29.9947 / Avg. batch time: 1084.1562 (ms) / GPU bubble ratio: 66.42%
[rank2]:2025-11-27 01:41:22,785 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-27 01:41:22,881 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.8856  memory:  8.70GiB(18.31%)  tps: 7,933  tflops: 62.01  mfu: 19.88%
[rank1]:2025-11-27 01:41:22,832 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-11-27 01:41:22,885 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.8856  memory: 12.90GiB(27.16%)  tps: 7,933  tflops: 62.01  mfu: 19.88%
[rank0]:2025-11-27 01:41:22,867 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.21/0.21, [MB7] 1.00/1.00
[rank0]:2025-11-27 01:41:22,899 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.8856  memory: 16.95GiB(35.67%)  tps: 7,933  tflops: 62.01  mfu: 19.88%
[rank3]:2025-11-27 01:41:22,871 - INFO -  step: 200  loss:  3.1031  grad_norm:  0.8856  memory: 26.76GiB(56.33%)  tps: 7,934  tflops: 62.02  mfu: 19.88%
[rank2]:2025-11-27 01:41:22,949 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/freeze_ratio_history/rank2/251127_0141_stage2_step200.svg
[rank1]:2025-11-27 01:41:22,949 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/freeze_ratio_history/rank1/251127_0141_stage1_step200.svg
[rank0]:2025-11-27 01:41:22,948 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/freeze_ratio_history/rank0/251127_0141_stage0_step200.svg
[rank3]:2025-11-27 01:41:23,043 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/pipeline_schedule/251127_0141_real_step200_rank3.svg
[rank3]:> Batch Time: 1013.41 ms, GPU Bubble Ratio: 67.68%, 54.69%, 62.72%, 32.65%
[rank3]:2025-11-27 01:41:23,087 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/freeze_ratio_history/rank3/251127_0141_stage3_step200.svg
[rank0]:2025-11-27 01:44:36,803 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-27 01:44:40,263 - INFO - Avg. fwd time: 27.2643 / Avg. bwd time: 63.8681 / Avg. batch time: 877.5420 (ms) / GPU bubble ratio: 16.92%
[rank2]:2025-11-27 01:44:40,402 - INFO - Avg. fwd time: 15.5056 / Avg. bwd time: 32.0301 / Avg. batch time: 933.8368 (ms) / GPU bubble ratio: 59.28%
[rank1]:2025-11-27 01:44:40,474 - INFO - Avg. fwd time: 20.0477 / Avg. bwd time: 39.6350 / Avg. batch time: 1002.5516 (ms) / GPU bubble ratio: 52.38%
[rank0]:2025-11-27 01:44:40,483 - INFO - Avg. fwd time: 15.5503 / Avg. bwd time: 27.6796 / Avg. batch time: 1058.4964 (ms) / GPU bubble ratio: 67.33%
[rank3]:2025-11-27 01:44:40,678 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 0.40/0.40, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank2]:2025-11-27 01:44:40,697 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-11-27 01:44:40,743 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-11-27 01:44:40,777 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.21/0.21, [MB7] 1.00/1.00
[rank3]:2025-11-27 01:44:40,780 - INFO -  step: 250  loss:  2.9575  grad_norm:  0.0000  memory: 26.76GiB(56.33%)  tps: 8,279  tflops: 64.72  mfu: 20.74%
[rank2]:2025-11-27 01:44:40,792 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.1602  memory:  8.70GiB(18.31%)  tps: 8,278  tflops: 64.72  mfu: 20.74%
[rank1]:2025-11-27 01:44:40,795 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.1602  memory: 12.90GiB(27.16%)  tps: 8,278  tflops: 64.72  mfu: 20.74%
[rank0]:2025-11-27 01:44:40,810 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.1602  memory: 16.95GiB(35.67%)  tps: 8,279  tflops: 64.72  mfu: 20.74%
[rank0]:2025-11-27 01:47:56,879 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-27 01:48:00,746 - INFO - Avg. fwd time: 27.4847 / Avg. bwd time: 61.7313 / Avg. batch time: 862.6246 (ms) / GPU bubble ratio: 17.26%
[rank3]:2025-11-27 01:48:00,772 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 0.40/0.40, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank2]:2025-11-27 01:48:00,787 - INFO - Avg. fwd time: 15.5307 / Avg. bwd time: 31.8950 / Avg. batch time: 918.8921 (ms) / GPU bubble ratio: 58.71%
[rank2]:2025-11-27 01:48:00,795 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-11-27 01:48:00,838 - INFO - Avg. fwd time: 20.0526 / Avg. bwd time: 39.2866 / Avg. batch time: 987.6854 (ms) / GPU bubble ratio: 51.94%
[rank1]:2025-11-27 01:48:00,847 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank3]:2025-11-27 01:48:00,889 - INFO -  step: 300  loss:  2.8934  grad_norm:  0.0000  memory: 26.76GiB(56.33%)  tps: 8,188  tflops: 64.01  mfu: 20.52%
[rank2]:2025-11-27 01:48:00,901 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.1469  memory:  8.70GiB(18.31%)  tps: 8,188  tflops: 64.01  mfu: 20.51%
[rank1]:2025-11-27 01:48:00,904 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.1469  memory: 12.90GiB(27.16%)  tps: 8,188  tflops: 64.01  mfu: 20.51%
[rank0]:2025-11-27 01:48:00,879 - INFO - Avg. fwd time: 15.5693 / Avg. bwd time: 26.1069 / Avg. batch time: 1043.6478 (ms) / GPU bubble ratio: 68.05%
[rank0]:2025-11-27 01:48:00,887 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.21/0.21, [MB7] 1.00/1.00
[rank0]:2025-11-27 01:48:00,918 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.1469  memory: 16.95GiB(35.67%)  tps: 8,188  tflops: 64.01  mfu: 20.51%
[rank2]:2025-11-27 01:48:00,968 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/freeze_ratio_history/rank2/251127_0148_stage2_step300.svg
[rank1]:2025-11-27 01:48:00,969 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/freeze_ratio_history/rank1/251127_0148_stage1_step300.svg
[rank0]:2025-11-27 01:48:00,969 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/freeze_ratio_history/rank0/251127_0148_stage0_step300.svg
[rank3]:2025-11-27 01:48:01,056 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/pipeline_schedule/251127_0148_real_step300_rank3.svg
[rank3]:> Batch Time: 973.06 ms, GPU Bubble Ratio: 71.40%, 52.55%, 61.38%, 33.96%
[rank3]:2025-11-27 01:48:01,098 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/freeze_ratio_history/rank3/251127_0148_stage3_step300.svg
[rank0]:2025-11-27 01:51:16,531 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-27 01:51:19,962 - INFO - Avg. fwd time: 27.6274 / Avg. bwd time: 60.3618 / Avg. batch time: 853.1209 (ms) / GPU bubble ratio: 17.49%
[rank2]:2025-11-27 01:51:20,103 - INFO - Avg. fwd time: 15.5498 / Avg. bwd time: 31.8185 / Avg. batch time: 909.4494 (ms) / GPU bubble ratio: 58.33%
[rank0]:2025-11-27 01:51:20,182 - INFO - Avg. fwd time: 15.5872 / Avg. bwd time: 25.1725 / Avg. batch time: 1034.3035 (ms) / GPU bubble ratio: 68.47%
[rank1]:2025-11-27 01:51:20,170 - INFO - Avg. fwd time: 20.0626 / Avg. bwd time: 39.0885 / Avg. batch time: 978.3061 (ms) / GPU bubble ratio: 51.63%
[rank3]:2025-11-27 01:51:20,462 - INFO -  step: 350  loss:  2.9085  grad_norm:  0.0000  memory: 26.76GiB(56.33%)  tps: 8,210  tflops: 64.18  mfu: 20.57%
[rank0]:2025-11-27 01:51:20,492 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.1026  memory: 16.95GiB(35.67%)  tps: 8,210  tflops: 64.18  mfu: 20.57%
[rank2]:2025-11-27 01:51:20,474 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.1026  memory:  8.70GiB(18.31%)  tps: 8,210  tflops: 64.18  mfu: 20.57%
[rank1]:2025-11-27 01:51:20,478 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.1026  memory: 12.90GiB(27.16%)  tps: 8,210  tflops: 64.18  mfu: 20.57%
[rank0]:2025-11-27 01:54:35,096 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-27 01:54:38,598 - INFO - Avg. fwd time: 27.7230 / Avg. bwd time: 59.0757 / Avg. batch time: 843.8451 (ms) / GPU bubble ratio: 17.71%
[rank2]:2025-11-27 01:54:38,742 - INFO - Avg. fwd time: 15.5613 / Avg. bwd time: 31.7440 / Avg. batch time: 900.1915 (ms) / GPU bubble ratio: 57.96%
[rank0]:2025-11-27 01:54:38,819 - INFO - Avg. fwd time: 15.5955 / Avg. bwd time: 24.3291 / Avg. batch time: 1025.0763 (ms) / GPU bubble ratio: 68.84%
[rank1]:2025-11-27 01:54:38,808 - INFO - Avg. fwd time: 20.0621 / Avg. bwd time: 38.8921 / Avg. batch time: 969.0748 (ms) / GPU bubble ratio: 51.33%
[rank3]:2025-11-27 01:54:39,116 - INFO -  step: 400  loss:  2.9405  grad_norm:  0.0000  memory: 26.76GiB(56.33%)  tps: 8,248  tflops: 64.48  mfu: 20.67%
[rank0]:2025-11-27 01:54:39,145 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.1290  memory: 16.95GiB(35.67%)  tps: 8,248  tflops: 64.48  mfu: 20.67%
[rank2]:2025-11-27 01:54:39,128 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.1290  memory:  8.70GiB(18.31%)  tps: 8,248  tflops: 64.48  mfu: 20.67%
[rank1]:2025-11-27 01:54:39,132 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.1290  memory: 12.90GiB(27.16%)  tps: 8,248  tflops: 64.48  mfu: 20.67%
[rank0]:2025-11-27 01:54:39,196 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/freeze_ratio_history/rank0/251127_0154_stage0_step400.svg
[rank1]:2025-11-27 01:54:39,199 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/freeze_ratio_history/rank1/251127_0154_stage1_step400.svg
[rank2]:2025-11-27 01:54:39,198 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/freeze_ratio_history/rank2/251127_0154_stage2_step400.svg
[rank3]:2025-11-27 01:54:39,282 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/pipeline_schedule/251127_0154_real_step400_rank3.svg
[rank3]:> Batch Time: 967.97 ms, GPU Bubble Ratio: 71.68%, 52.48%, 61.30%, 33.99%
[rank3]:2025-11-27 01:54:39,328 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/freeze_ratio_history/rank3/251127_0154_stage3_step400.svg
[rank3]:2025-11-27 01:55:01,557 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-11-27 01:55:01,982 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-11-27 01:55:02,062 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-11-27 01:55:02,028 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-11-27 01:57:52,703 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-27 01:57:56,472 - INFO - Avg. fwd time: 27.7865 / Avg. bwd time: 58.0517 / Avg. batch time: 836.3545 (ms) / GPU bubble ratio: 17.89%
[rank2]:2025-11-27 01:57:56,515 - INFO - Avg. fwd time: 15.5653 / Avg. bwd time: 31.6843 / Avg. batch time: 892.7646 (ms) / GPU bubble ratio: 57.66%
[rank1]:2025-11-27 01:57:56,565 - INFO - Avg. fwd time: 20.0584 / Avg. bwd time: 38.7416 / Avg. batch time: 961.6551 (ms) / GPU bubble ratio: 51.08%
[rank0]:2025-11-27 01:57:56,607 - INFO - Avg. fwd time: 15.6021 / Avg. bwd time: 23.6804 / Avg. batch time: 1017.6622 (ms) / GPU bubble ratio: 69.12%
[rank3]:2025-11-27 01:57:56,617 - INFO -  step: 450  loss:  2.9471  grad_norm:  0.0000  memory: 26.76GiB(56.33%)  tps: 8,296  tflops: 64.85  mfu: 20.79%
[rank2]:2025-11-27 01:57:56,629 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.1203  memory:  8.70GiB(18.31%)  tps: 8,296  tflops: 64.85  mfu: 20.79%
[rank1]:2025-11-27 01:57:56,632 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.1203  memory: 12.90GiB(27.16%)  tps: 8,296  tflops: 64.85  mfu: 20.79%
[rank0]:2025-11-27 01:57:56,645 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.1203  memory: 16.95GiB(35.67%)  tps: 8,296  tflops: 64.85  mfu: 20.79%
[rank0]:2025-11-27 02:01:12,180 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-27 02:01:15,627 - INFO - Avg. fwd time: 27.8390 / Avg. bwd time: 57.4448 / Avg. batch time: 832.0203 (ms) / GPU bubble ratio: 18.00%
[rank2]:2025-11-27 02:01:15,765 - INFO - Avg. fwd time: 15.5727 / Avg. bwd time: 31.6476 / Avg. batch time: 888.4018 (ms) / GPU bubble ratio: 57.48%
[rank1]:2025-11-27 02:01:15,833 - INFO - Avg. fwd time: 20.0612 / Avg. bwd time: 38.6435 / Avg. batch time: 957.3124 (ms) / GPU bubble ratio: 50.94%
[rank0]:2025-11-27 02:01:15,844 - INFO - Avg. fwd time: 15.6084 / Avg. bwd time: 23.2296 / Avg. batch time: 1013.3284 (ms) / GPU bubble ratio: 69.34%
[rank3]:2025-11-27 02:01:16,141 - INFO -  step: 500  loss:  2.9009  grad_norm:  0.0000  memory: 26.76GiB(56.33%)  tps: 8,212  tflops: 64.19  mfu: 20.58%
[rank0]:2025-11-27 02:01:16,170 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.1374  memory: 16.95GiB(35.67%)  tps: 8,211  tflops: 64.19  mfu: 20.57%
[rank2]:2025-11-27 02:01:16,153 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.1374  memory:  8.70GiB(18.31%)  tps: 8,212  tflops: 64.19  mfu: 20.58%
[rank2]:2025-11-27 02:01:16,217 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/freeze_ratio_history/rank2/251127_0201_stage2_step500.svg
[rank1]:2025-11-27 02:01:16,156 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.1374  memory: 12.90GiB(27.16%)  tps: 8,212  tflops: 64.19  mfu: 20.58%
[rank1]:2025-11-27 02:01:16,218 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/freeze_ratio_history/rank1/251127_0201_stage1_step500.svg
[rank0]:2025-11-27 02:01:16,217 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/freeze_ratio_history/rank0/251127_0201_stage0_step500.svg
[rank3]:2025-11-27 02:01:16,310 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/pipeline_schedule/251127_0201_real_step500_rank3.svg
[rank3]:> Batch Time: 974.12 ms, GPU Bubble Ratio: 71.77%, 52.65%, 61.45%, 33.78%
[rank3]:2025-11-27 02:01:16,352 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/freeze_ratio_history/rank3/251127_0201_stage3_step500.svg
[rank0]:2025-11-27 02:04:31,321 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-27 02:04:34,799 - INFO - Avg. fwd time: 27.8842 / Avg. bwd time: 56.8555 / Avg. batch time: 827.7487 (ms) / GPU bubble ratio: 18.10%
[rank2]:2025-11-27 02:04:34,943 - INFO - Avg. fwd time: 15.5777 / Avg. bwd time: 31.6112 / Avg. batch time: 884.1359 (ms) / GPU bubble ratio: 57.30%
[rank0]:2025-11-27 02:04:35,020 - INFO - Avg. fwd time: 15.6121 / Avg. bwd time: 22.8095 / Avg. batch time: 1009.0606 (ms) / GPU bubble ratio: 69.54%
[rank1]:2025-11-27 02:04:35,010 - INFO - Avg. fwd time: 20.0605 / Avg. bwd time: 38.5417 / Avg. batch time: 953.0459 (ms) / GPU bubble ratio: 50.81%
[rank3]:2025-11-27 02:04:35,311 - INFO -  step: 550  loss:  2.8752  grad_norm:  0.0000  memory: 26.76GiB(56.33%)  tps: 8,226  tflops: 64.31  mfu: 20.61%
[rank0]:2025-11-27 02:04:35,341 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.1032  memory: 16.95GiB(35.67%)  tps: 8,226  tflops: 64.31  mfu: 20.61%
[rank2]:2025-11-27 02:04:35,323 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.1032  memory:  8.70GiB(18.31%)  tps: 8,226  tflops: 64.31  mfu: 20.61%
[rank1]:2025-11-27 02:04:35,327 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.1032  memory: 12.90GiB(27.16%)  tps: 8,226  tflops: 64.31  mfu: 20.61%
[rank0]:2025-11-27 02:07:47,927 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-27 02:07:51,771 - INFO - Avg. fwd time: 27.9235 / Avg. bwd time: 56.2099 / Avg. batch time: 823.0674 (ms) / GPU bubble ratio: 18.22%
[rank2]:2025-11-27 02:07:51,814 - INFO - Avg. fwd time: 15.5835 / Avg. bwd time: 31.5840 / Avg. batch time: 879.5111 (ms) / GPU bubble ratio: 57.10%
[rank1]:2025-11-27 02:07:51,866 - INFO - Avg. fwd time: 20.0612 / Avg. bwd time: 38.4653 / Avg. batch time: 948.4255 (ms) / GPU bubble ratio: 50.63%
[rank3]:2025-11-27 02:07:51,918 - INFO -  step: 600  loss:  2.8857  grad_norm:  0.0000  memory: 26.76GiB(56.33%)  tps: 8,333  tflops: 65.15  mfu: 20.88%
[rank0]:2025-11-27 02:07:51,908 - INFO - Avg. fwd time: 15.6161 / Avg. bwd time: 22.4618 / Avg. batch time: 1004.4452 (ms) / GPU bubble ratio: 69.67%
[rank2]:2025-11-27 02:07:51,930 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.1260  memory:  8.70GiB(18.31%)  tps: 8,333  tflops: 65.15  mfu: 20.88%
[rank1]:2025-11-27 02:07:51,933 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.1260  memory: 12.90GiB(27.16%)  tps: 8,333  tflops: 65.15  mfu: 20.88%
[rank0]:2025-11-27 02:07:51,945 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.1260  memory: 16.95GiB(35.67%)  tps: 8,334  tflops: 65.15  mfu: 20.88%
[rank0]:2025-11-27 02:07:51,993 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/freeze_ratio_history/rank0/251127_0207_stage0_step600.svg
[rank2]:2025-11-27 02:07:51,994 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/freeze_ratio_history/rank2/251127_0207_stage2_step600.svg
[rank1]:2025-11-27 02:07:51,999 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/freeze_ratio_history/rank1/251127_0207_stage1_step600.svg
[rank3]:2025-11-27 02:07:52,084 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/pipeline_schedule/251127_0207_real_step600_rank3.svg
[rank3]:> Batch Time: 958.62 ms, GPU Bubble Ratio: 71.22%, 51.81%, 60.77%, 34.70%
[rank3]:2025-11-27 02:07:52,127 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/freeze_ratio_history/rank3/251127_0207_stage3_step600.svg
[rank0]:2025-11-27 02:11:07,021 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-27 02:11:10,516 - INFO - Avg. fwd time: 27.9658 / Avg. bwd time: 55.8130 / Avg. batch time: 820.3587 (ms) / GPU bubble ratio: 18.30%
[rank2]:2025-11-27 02:11:10,655 - INFO - Avg. fwd time: 15.5888 / Avg. bwd time: 31.5679 / Avg. batch time: 876.8500 (ms) / GPU bubble ratio: 56.98%
[rank1]:2025-11-27 02:11:10,727 - INFO - Avg. fwd time: 20.0621 / Avg. bwd time: 38.4094 / Avg. batch time: 945.7664 (ms) / GPU bubble ratio: 50.54%
[rank0]:2025-11-27 02:11:10,736 - INFO - Avg. fwd time: 15.6192 / Avg. bwd time: 22.2140 / Avg. batch time: 1001.7906 (ms) / GPU bubble ratio: 69.79%
[rank1]:2025-11-27 02:11:11,039 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.1128  memory: 12.90GiB(27.16%)  tps: 8,229  tflops: 64.33  mfu: 20.62%
[rank3]:2025-11-27 02:11:11,023 - INFO -  step: 650  loss:  2.8992  grad_norm:  0.0000  memory: 26.76GiB(56.33%)  tps: 8,229  tflops: 64.33  mfu: 20.62%
[rank0]:2025-11-27 02:11:11,053 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.1128  memory: 16.95GiB(35.67%)  tps: 8,229  tflops: 64.33  mfu: 20.62%
[rank2]:2025-11-27 02:11:11,035 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.1128  memory:  8.70GiB(18.31%)  tps: 8,229  tflops: 64.33  mfu: 20.62%
[rank0]:2025-11-27 02:14:25,942 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-27 02:14:29,357 - INFO - Avg. fwd time: 28.0161 / Avg. bwd time: 55.4410 / Avg. batch time: 817.8867 (ms) / GPU bubble ratio: 18.37%
[rank2]:2025-11-27 02:14:29,500 - INFO - Avg. fwd time: 15.5959 / Avg. bwd time: 31.5533 / Avg. batch time: 874.3839 (ms) / GPU bubble ratio: 56.86%
[rank1]:2025-11-27 02:14:29,568 - INFO - Avg. fwd time: 20.0674 / Avg. bwd time: 38.3591 / Avg. batch time: 943.3116 (ms) / GPU bubble ratio: 50.45%
[rank0]:2025-11-27 02:14:29,579 - INFO - Avg. fwd time: 15.6255 / Avg. bwd time: 21.9682 / Avg. batch time: 999.3472 (ms) / GPU bubble ratio: 69.91%
[rank3]:2025-11-27 02:14:29,859 - INFO -  step: 700  loss:  2.9460  grad_norm:  0.0000  memory: 26.76GiB(56.33%)  tps: 8,240  tflops: 64.42  mfu: 20.65%
[rank2]:2025-11-27 02:14:29,871 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0913  memory:  8.70GiB(18.31%)  tps: 8,240  tflops: 64.42  mfu: 20.65%
[rank1]:2025-11-27 02:14:29,875 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0913  memory: 12.90GiB(27.16%)  tps: 8,240  tflops: 64.42  mfu: 20.65%
[rank0]:2025-11-27 02:14:29,888 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0913  memory: 16.95GiB(35.67%)  tps: 8,240  tflops: 64.42  mfu: 20.65%
[rank0]:2025-11-27 02:14:29,937 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/freeze_ratio_history/rank0/251127_0214_stage0_step700.svg
[rank2]:2025-11-27 02:14:29,938 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/freeze_ratio_history/rank2/251127_0214_stage2_step700.svg
[rank1]:2025-11-27 02:14:29,939 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/freeze_ratio_history/rank1/251127_0214_stage1_step700.svg
[rank3]:2025-11-27 02:14:30,026 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/pipeline_schedule/251127_0214_real_step700_rank3.svg
[rank3]:> Batch Time: 968.16 ms, GPU Bubble Ratio: 71.11%, 52.22%, 61.05%, 34.93%
[rank3]:2025-11-27 02:14:30,071 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/freeze_ratio_history/rank3/251127_0214_stage3_step700.svg
[rank0]:2025-11-27 02:17:45,782 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-27 02:17:49,608 - INFO - Avg. fwd time: 28.0508 / Avg. bwd time: 55.1458 / Avg. batch time: 815.8723 (ms) / GPU bubble ratio: 18.42%
[rank2]:2025-11-27 02:17:49,652 - INFO - Avg. fwd time: 15.5983 / Avg. bwd time: 31.5377 / Avg. batch time: 872.3959 (ms) / GPU bubble ratio: 56.78%
[rank1]:2025-11-27 02:17:49,705 - INFO - Avg. fwd time: 20.0665 / Avg. bwd time: 38.3027 / Avg. batch time: 941.3206 (ms) / GPU bubble ratio: 50.39%
[rank3]:2025-11-27 02:17:49,759 - INFO -  step: 750  loss:  2.8698  grad_norm:  0.0000  memory: 26.76GiB(56.33%)  tps: 8,196  tflops: 64.07  mfu: 20.54%
[rank0]:2025-11-27 02:17:49,749 - INFO - Avg. fwd time: 15.6279 / Avg. bwd time: 21.7485 / Avg. batch time: 997.3606 (ms) / GPU bubble ratio: 70.02%
[rank0]:2025-11-27 02:17:49,787 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1319  memory: 16.95GiB(35.67%)  tps: 8,196  tflops: 64.07  mfu: 20.54%
[rank1]:2025-11-27 02:17:49,774 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1319  memory: 12.90GiB(27.16%)  tps: 8,196  tflops: 64.07  mfu: 20.54%
[rank2]:2025-11-27 02:17:49,770 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1319  memory:  8.70GiB(18.31%)  tps: 8,196  tflops: 64.07  mfu: 20.54%
[rank0]:2025-11-27 02:21:04,772 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-27 02:21:08,321 - INFO - Avg. fwd time: 28.0702 / Avg. bwd time: 54.9030 / Avg. batch time: 814.1274 (ms) / GPU bubble ratio: 18.47%
[rank2]:2025-11-27 02:21:08,465 - INFO - Avg. fwd time: 15.5992 / Avg. bwd time: 31.5244 / Avg. batch time: 870.6531 (ms) / GPU bubble ratio: 56.70%
[rank0]:2025-11-27 02:21:08,547 - INFO - Avg. fwd time: 15.6292 / Avg. bwd time: 21.5863 / Avg. batch time: 995.6097 (ms) / GPU bubble ratio: 70.10%
[rank1]:2025-11-27 02:21:08,538 - INFO - Avg. fwd time: 20.0654 / Avg. bwd time: 38.2589 / Avg. batch time: 939.5700 (ms) / GPU bubble ratio: 50.34%
[rank3]:2025-11-27 02:21:08,849 - INFO -  step: 800  loss:  2.8592  grad_norm:  0.0000  memory: 26.76GiB(56.33%)  tps: 8,230  tflops: 64.34  mfu: 20.62%
[rank3]:2025-11-27 02:21:08,849 - INFO -  final step: 800  loss:  2.8592  grad_norm:  0.0000  tps: 8,506  tflops: 66.49  mfu: 19.57%
[rank3]:2025-11-27 02:21:08,850 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-11-27 02:21:08,851 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-11-27 02:21:08,878 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1254  memory: 16.95GiB(35.67%)  tps: 8,229  tflops: 64.33  mfu: 20.62%
[rank0]:2025-11-27 02:21:08,879 - INFO -  final step: 800  loss: -4.0000  grad_norm:  0.1254  tps: 8,500  tflops: 66.45  mfu: 19.45%
[rank0]:2025-11-27 02:21:08,879 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-27 02:21:08,879 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank1]:2025-11-27 02:21:08,863 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1254  memory: 12.90GiB(27.16%)  tps: 8,229  tflops: 64.33  mfu: 20.62%
[rank1]:2025-11-27 02:21:08,864 - INFO -  final step: 800  loss: -4.0000  grad_norm:  0.1254  tps: 8,500  tflops: 66.45  mfu: 19.45%
[rank1]:2025-11-27 02:21:08,864 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-11-27 02:21:08,864 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank2]:2025-11-27 02:21:08,860 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1254  memory:  8.70GiB(18.31%)  tps: 8,229  tflops: 64.33  mfu: 20.62%
[rank2]:2025-11-27 02:21:08,860 - INFO -  final step: 800  loss: -4.0000  grad_norm:  0.1254  tps: 8,500  tflops: 66.45  mfu: 19.44%
[rank2]:2025-11-27 02:21:08,860 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-27 02:21:08,861 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-11-27 02:21:10,778 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-11-27 02:21:10,854 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/freeze_ratio_history/rank0/251127_0221_stage0_final800.svg
[rank1]:2025-11-27 02:21:10,849 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/freeze_ratio_history/rank1/251127_0221_stage1_final800.svg
[rank2]:2025-11-27 02:21:10,849 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/freeze_ratio_history/rank2/251127_0221_stage2_final800.svg
[rank3]:2025-11-27 02:21:10,941 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/pipeline_schedule/251127_0221_real_final800_rank3.svg
[rank3]:> Batch Time: 970.69 ms, GPU Bubble Ratio: 71.30%, 52.64%, 61.34%, 33.96%
[rank1]:2025-11-27 02:21:11,012 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/frozen_params_histogram/251127_0221_rank1_stage1.svg
[rank1]:	> Counts Sum: 901200, Total Sum: 1051200 (85.73%), Ratio(%) per element: [85.61, 85.78, 85.78, 85.27, 86.47, 85.61, 85.44, 85.78, 85.78, 85.61, 85.78, 86.13, 85.78, 85.61, 85.61, 85.78, 85.78, 85.61, 85.61, 85.44, 85.78, 85.95, 85.95, 85.78, 85.61, 85.27, 86.13, 85.61, 85.78, 85.27, 85.61, 85.61, 85.44, 85.78, 85.61, 85.78, 85.61, 85.95, 85.61, 85.95, 86.13, 85.78, 85.78, 85.44, 86.13]
[rank1]:2025-11-27 02:21:11,013 - INFO - Destroying the purge thread.
[rank2]:2025-11-27 02:21:11,009 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/frozen_params_histogram/251127_0221_rank2_stage2.svg
[rank2]:	> Counts Sum: 720960, Total Sum: 840960 (85.73%), Ratio(%) per element: [85.78, 85.78, 85.44, 85.27, 86.13, 85.78, 85.44, 85.44, 86.13, 85.61, 85.78, 85.78, 86.13, 85.78, 85.78, 85.78, 85.78, 85.78, 85.44, 85.61, 85.1, 86.13, 85.78, 85.61, 85.95, 85.44, 85.95, 85.78, 85.78, 85.44, 85.78, 85.78, 85.95, 85.78, 85.61, 85.78]
[rank2]:2025-11-27 02:21:11,010 - INFO - Destroying the purge thread.
[rank3]:2025-11-27 02:21:11,079 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/pipeline_schedule/251127_0221_thry_final800_rank3.svg
[rank3]:> Batch Time: 656.14 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank0]:2025-11-27 02:21:11,017 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/frozen_params_histogram/251127_0221_rank0_stage0.svg
[rank0]:	> Counts Sum: 719440, Total Sum: 864320 (83.24%), Ratio(%) per element: [81.33, 80.3, 80.47, 81.84, 82.02, 81.5, 80.99, 82.36, 82.53, 81.5, 81.84, 81.84, 83.04, 82.53, 82.19, 82.7, 83.56, 82.36, 82.53, 83.21, 83.56, 84.41, 83.56, 83.39, 84.24, 83.9, 84.24, 84.41, 85.27, 84.58, 85.61, 84.93, 85.1, 85.44, 85.1, 85.27, 85.95]
[rank0]:2025-11-27 02:21:11,017 - INFO - Sleeping 2 seconds for other ranks to complete
[rank3]:2025-11-27 02:21:11,130 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/freeze_ratio_history/rank3/251127_0221_stage3_final800.svg
[rank1]:2025-11-27 02:21:11,196 - INFO - Process group destroyed
[rank2]:2025-11-27 02:21:11,190 - INFO - Process group destroyed
[rank3]:2025-11-27 02:21:11,271 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/frozen_params_histogram/251127_0221_rank3_stage3.svg
[rank3]:	> Counts Sum: 158800, Total Sum: 677440 (23.44%), Ratio(%) per element: [24.14, 23.28, 25.0, 23.45, 22.94, 22.6, 24.65, 24.14, 23.45, 23.97, 21.91, 23.97, 22.08, 24.82, 24.65, 23.97, 21.4, 23.11, 23.63, 23.63, 22.43, 22.94, 23.8, 21.91, 22.77, 23.63, 23.63, 25.17, 22.6]
[rank3]:2025-11-27 02:21:11,272 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading history steps 15-16, summary, console lines 259-271
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–‡â–‡â–ƒâ–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–‡â–‡â–ƒâ–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 3.85255
[rank3]:wandb:               final/avg_loss 2.8592
[rank3]:wandb:             final/avg_mfu(%) 19.56745
[rank3]:wandb:             final/avg_tflops 66.49236
[rank3]:wandb:    final/avg_throughput(tps) 8505.536
[rank3]:wandb:              final/grad_norm 0
[rank3]:wandb:               final/max_loss 2.8592
[rank3]:wandb:                    grad_norm 0
[rank3]:wandb: loss_metrics/global_avg_loss 2.8592
[rank3]:wandb: loss_metrics/global_max_loss 2.8592
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1109_1F1B_fullrand7_42_forfun_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/hslww0r5
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1109_1F1B_fullrand7_42_forfun_dm1/20251127-0126/wandb/run-20251127_012632-hslww0r5/logs
[rank3]:2025-11-27 02:21:12,714 - INFO - Process group destroyed
[rank0]:2025-11-27 02:21:13,017 - INFO - Training completed
[rank0]:2025-11-27 02:21:13,018 - INFO - Destroying the purge thread.
[rank0]:2025-11-27 02:21:13,207 - INFO - Process group destroyed
[rank2]:Stage 2: Modules to keep: {'layers.10', 'layers.12', 'layers.9', 'layers.11'}
[rank1]:Stage 1: Modules to keep: {'layers.7', 'layers.5', 'layers.4', 'layers.8', 'layers.6'}
[rank0]:Stage 0: Modules to keep: {'layers.2', 'layers.0', 'layers.1', 'tok_embeddings', 'layers.3'}
[rank3]:Stage 3: Modules to keep: {'output', 'layers.13', 'norm', 'layers.14', 'layers.15'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1109.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1109_1F1B_fullrand7_42_forfun_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1109_1F1B_fullrand7_42_forfun_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1109_1F1B_fullrand7_42_forfun_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1109_1F1B_fullrand7_42_forfun_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1109_1F1B_fullrand7_42_forfun_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 42
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: 1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 4
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1109_1F1B_fullrand7_42_forfun_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1109_1F1B_fullrand7_42_forfun_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: fullrand7
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.01
[rank3]:		- percentile: 80
[rank3]:
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
