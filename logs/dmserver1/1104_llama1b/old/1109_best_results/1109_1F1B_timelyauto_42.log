
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 11. 10. (ì›”) 21:32:32 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 2,3,4,5
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/1109_1F1B_timelyauto_42.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset

âœ”ï¸Running with timelyauto x 1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1109.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=timelyauto --freezing.threshold=0.05 --freezing.percentile=80 --freezing.max_freeze_ratio=0.8
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank2]:2025-11-10 21:32:40,143 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank2]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank2]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank2]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank2]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank2]:"
[rank0]:2025-11-10 21:32:40,139 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank0]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank0]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank0]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank0]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank0]:"
[rank1]:2025-11-10 21:32:40,138 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank1]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank1]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank1]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank1]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank1]:"
[rank3]:2025-11-10 21:32:40,144 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:"
[rank2]:2025-11-10 21:32:40,472 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-11-10 21:32:40,474 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-11-10 21:32:40,482 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-11-10 21:32:40,486 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-11-10 21:32:40,467 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-11-10 21:32:40,470 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-10 21:32:40,494 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-11-10 21:32:40,498 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-10 21:32:40,502 - INFO - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-11-10 21:32:40,504 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-11-10 21:32:40,893 - INFO - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank0]:2025-11-10 21:32:43,961 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank2]:2025-11-10 21:32:44,119 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-11-10 21:32:44,164 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-10 21:32:44,124 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-11-10 21:32:44,170 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-10 21:32:44,172 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank1]:2025-11-10 21:32:44,140 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-11-10 21:32:44,184 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-11-10 21:32:44,193 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-11-10 21:32:44,194 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2025-11-10 21:32:44,197 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-11-10 21:32:44,197 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2025-11-10 21:32:44,210 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-11-10 21:32:44,211 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank2]:2025-11-10 21:32:44,448 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-11-10 21:32:44,449 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-11-10 21:32:44,449 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank0]:2025-11-10 21:32:44,447 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-10 21:32:44,448 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-11-10 21:32:44,448 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank1]:2025-11-10 21:32:44,448 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-11-10 21:32:44,448 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-11-10 21:32:44,449 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run 7dgemuh6
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1109_1F1B_timelyauto_42_dm1/20251110-2132/wandb/run-20251110_213245-7dgemuh6
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1109_1F1B_timelyauto_42_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/7dgemuh6
[rank3]:2025-11-10 21:32:46,875 - INFO - WandB logging enabled
[rank3]:2025-11-10 21:32:46,876 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-11-10 21:32:46,914 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-11-10 21:32:46,943 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-11-10 21:32:46,944 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank2]:2025-11-10 21:32:47,146 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-11-10 21:32:47,130 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-11-10 21:32:47,131 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-11-10 21:32:47,131 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2025-11-10 21:32:47,146 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-10 21:32:47,147 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1109_1F1B_timelyauto_42_dm1
[rank0]:2025-11-10 21:32:47,147 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-10 21:32:47,148 - INFO - Trainer is initialized with local batch size 32, global batch size 128, gradient accumulation steps 4, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2025-11-10 21:32:47,148 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank1]:2025-11-10 21:32:47,147 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-10 21:32:49,762 - INFO - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-11-10 21:32:49,762 - INFO - Finished loading the checkpoint in 2.61 seconds.
[rank0]:2025-11-10 21:32:49,762 - INFO - Training starts at step 1
[rank0]:2025-11-10 21:32:54,940 - INFO -  step:  1  loss: -4.0000  grad_norm: 203.0670  memory: 13.10GiB(27.57%)  tps: 3,043  tflops: 23.79  mfu: 7.62%
[rank0]:2025-11-10 21:32:54,941 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-11-10 21:32:54,909 - INFO -  step:  1  loss: -4.0000  grad_norm: 203.0670  memory:  6.84GiB(14.41%)  tps: 3,050  tflops: 23.84  mfu: 7.64%
[rank2]:2025-11-10 21:32:54,909 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-11-10 21:32:54,911 - INFO -  step:  1  loss: -4.0000  grad_norm: 203.0670  memory: 10.58GiB(22.26%)  tps: 3,055  tflops: 23.88  mfu: 7.65%
[rank1]:2025-11-10 21:32:54,912 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-11-10 21:32:54,919 - INFO -  step:  1  loss: 10.6092  grad_norm: 203.0670  memory: 21.88GiB(46.05%)  tps: 4,095  tflops: 32.01  mfu: 10.26%
[rank3]:2025-11-10 21:32:54,919 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-10 21:36:45,217 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-10 21:36:49,502 - INFO - Avg. fwd time: 24.2691 / Avg. bwd time: 79.6785 / Avg. batch time: 976.6886 (ms) / GPU bubble ratio: 14.86%
[rank2]:2025-11-10 21:36:49,563 - INFO - Avg. fwd time: 15.3442 / Avg. bwd time: 35.0471 / Avg. batch time: 1034.9297 (ms) / GPU bubble ratio: 61.05%
[rank1]:2025-11-10 21:36:49,684 - INFO - Avg. fwd time: 19.5635 / Avg. bwd time: 45.0833 / Avg. batch time: 1107.2456 (ms) / GPU bubble ratio: 53.29%
[rank0]:2025-11-10 21:36:49,642 - INFO - Avg. fwd time: 15.7260 / Avg. bwd time: 40.5443 / Avg. batch time: 1171.7519 (ms) / GPU bubble ratio: 61.58%
[rank1]:2025-11-10 21:36:50,032 - INFO -  step: 50  loss: -4.0000  grad_norm: 23.9060  memory: 12.86GiB(27.07%)  tps: 6,829  tflops: 53.39  mfu: 17.11%
[rank3]:2025-11-10 21:36:50,041 - INFO -  step: 50  loss:  9.8837  grad_norm: 23.9060  memory: 25.79GiB(54.28%)  tps: 6,829  tflops: 53.39  mfu: 17.11%
[rank2]:2025-11-10 21:36:50,029 - INFO -  step: 50  loss: -4.0000  grad_norm: 23.9060  memory:  8.66GiB(18.23%)  tps: 6,829  tflops: 53.39  mfu: 17.11%
[rank0]:2025-11-10 21:36:50,047 - INFO -  step: 50  loss: -4.0000  grad_norm: 23.9060  memory: 16.87GiB(35.50%)  tps: 6,829  tflops: 53.39  mfu: 17.11%
[rank3]:2025-11-10 21:37:38,370 - INFO - [Step 60] ã€°ï¸ Monitoring Upperbound
[rank3]:2025-11-10 21:38:26,519 - INFO - [Step 70] âœ”ï¸  Setting Upperbound
[rank1]:2025-11-10 21:38:27,130 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-10 21:38:27,087 - INFO - [Step 70] ã€°ï¸ Monitoring Lowerbound
[rank3]:2025-11-10 21:38:27,115 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-10 21:38:27,136 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-10 21:38:27,120 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-10 21:38:27,134 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-10 21:38:27,131 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-10 21:38:27,168 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-10 21:38:27,207 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-10 21:38:27,155 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-10 21:38:27,173 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-10 21:38:27,155 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-10 21:38:27,159 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-10 21:38:27,191 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-10 21:38:27,259 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-10 21:38:27,302 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-10 21:38:27,392 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-10 21:38:27,343 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-10 21:38:27,438 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-10 21:38:27,345 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-10 21:38:27,429 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-10 21:38:27,412 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-10 21:38:27,477 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-10 21:38:27,517 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-10 21:38:27,509 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-10 21:38:27,505 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-10 21:38:27,506 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-10 21:38:27,507 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-10 21:38:27,508 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-10 21:38:27,545 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-10 21:38:27,576 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-10 21:38:27,614 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-10 21:38:27,577 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-10 21:39:35,543 - INFO - [Step 90] âœ”ï¸  Setting Lowerbound
[rank3]:2025-11-10 21:39:35,790 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_1F1B_timelyauto_42_dm1/pipeline_schedule/251110_2139_max_batch_time.svg
[rank3]:> Batch Time: 1026.41 ms, GPU Bubble Ratio: 55.55%, 48.98%, 60.31%, 17.02%
[rank3]:2025-11-10 21:39:35,941 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_1F1B_timelyauto_42_dm1/pipeline_schedule/251110_2139_min_batch_time.svg
[rank3]:> Batch Time: 648.91 ms, GPU Bubble Ratio: 80.24%, 46.89%, 58.52%, 14.58%
[rank3]:2025-11-10 21:39:36,106 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_1F1B_timelyauto_42_dm1/pipeline_schedule/251110_2139_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 701.50 ms, GPU Bubble Ratio: 42.42%, 28.50%, 44.37%, 13.48%
[rank3]:2025-11-10 21:39:36,107 - INFO - 	> Batch Time: 701.50 ms (Average Freeze Ratio: 0.30, Time Reduction Rate: 0.32)
[rank0]:2025-11-10 21:40:11,023 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-10 21:40:14,372 - INFO - Avg. fwd time: 25.3335 / Avg. bwd time: 70.7236 / Avg. batch time: 913.4779 (ms) / GPU bubble ratio: 15.88%
[rank2]:2025-11-10 21:40:14,497 - INFO - Avg. fwd time: 15.5518 / Avg. bwd time: 31.3524 / Avg. batch time: 968.8218 (ms) / GPU bubble ratio: 61.27%
[rank1]:2025-11-10 21:40:14,563 - INFO - Avg. fwd time: 19.9201 / Avg. bwd time: 40.1365 / Avg. batch time: 1036.1643 (ms) / GPU bubble ratio: 53.63%
[rank0]:2025-11-10 21:40:14,574 - INFO - Avg. fwd time: 15.9799 / Avg. bwd time: 30.7015 / Avg. batch time: 1091.4634 (ms) / GPU bubble ratio: 65.78%
[rank3]:2025-11-10 21:40:14,776 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.13/0.40, [MB1] 0.33/1.00, [MB2] 0.33/1.00, [MB3] 0.33/1.00, [MB4] 0.00/0.00, [MB5] 0.33/1.00, [MB6] 0.33/1.00, [MB7] 0.33/1.00
[rank3]:2025-11-10 21:40:14,877 - INFO -  step: 100  loss:  9.1859  grad_norm:  0.0000  memory: 25.79GiB(54.28%)  tps: 7,999  tflops: 62.53  mfu: 20.04%
[rank2]:2025-11-10 21:40:14,892 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.33/1.00
[rank2]:2025-11-10 21:40:14,893 - INFO -  step: 100  loss: -4.0000  grad_norm:  2.7232  memory:  8.70GiB(18.31%)  tps: 7,998  tflops: 62.52  mfu: 20.04%
[rank1]:2025-11-10 21:40:14,897 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.33/1.00
[rank1]:2025-11-10 21:40:14,897 - INFO -  step: 100  loss: -4.0000  grad_norm:  2.7232  memory: 12.88GiB(27.11%)  tps: 7,997  tflops: 62.52  mfu: 20.04%
[rank0]:2025-11-10 21:40:14,912 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.09/0.28, [MB7] 0.33/1.00
[rank0]:2025-11-10 21:40:14,912 - INFO -  step: 100  loss: -4.0000  grad_norm:  2.7232  memory: 16.87GiB(35.50%)  tps: 7,997  tflops: 62.52  mfu: 20.04%
[rank2]:2025-11-10 21:40:14,985 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_timelyauto_42_dm1/freeze_ratio_history/rank2/251110_2140_stage2_step100.svg
[rank1]:2025-11-10 21:40:14,995 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_timelyauto_42_dm1/freeze_ratio_history/rank1/251110_2140_stage1_step100.svg
[rank3]:2025-11-10 21:40:15,069 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_1F1B_timelyauto_42_dm1/pipeline_schedule/251110_2140_real_step100_rank3.svg
[rank3]:> Batch Time: 936.53 ms, GPU Bubble Ratio: 70.36%, 51.52%, 60.48%, 33.85%
[rank0]:2025-11-10 21:40:14,996 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_timelyauto_42_dm1/freeze_ratio_history/rank0/251110_2140_stage0_step100.svg
[rank3]:2025-11-10 21:40:15,112 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_timelyauto_42_dm1/freeze_ratio_history/rank3/251110_2140_stage3_step100.svg
[rank0]:2025-11-10 21:43:55,832 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-10 21:44:00,161 - INFO - Avg. fwd time: 25.5713 / Avg. bwd time: 70.0638 / Avg. batch time: 910.0838 (ms) / GPU bubble ratio: 15.93%
[rank2]:2025-11-10 21:44:00,203 - INFO - Avg. fwd time: 15.4952 / Avg. bwd time: 31.9536 / Avg. batch time: 965.8480 (ms) / GPU bubble ratio: 60.70%
[rank1]:2025-11-10 21:44:00,254 - INFO - Avg. fwd time: 19.9106 / Avg. bwd time: 40.5371 / Avg. batch time: 1034.3239 (ms) / GPU bubble ratio: 53.25%
[rank3]:2025-11-10 21:44:00,326 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.27/0.40, [MB1] 0.67/1.00, [MB2] 0.67/1.00, [MB3] 0.67/1.00, [MB4] 0.00/0.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank3]:2025-11-10 21:44:00,329 - INFO -  step: 150  loss:  5.0281  grad_norm: 16.4163  memory: 26.76GiB(56.33%)  tps: 7,267  tflops: 56.81  mfu: 18.21%
[rank0]:2025-11-10 21:44:00,296 - INFO - Avg. fwd time: 15.9669 / Avg. bwd time: 31.8930 / Avg. batch time: 1091.7119 (ms) / GPU bubble ratio: 64.93%
[rank0]:2025-11-10 21:44:00,339 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.19/0.28, [MB7] 0.67/1.00
[rank0]:2025-11-10 21:44:00,339 - INFO -  step: 150  loss: -4.0000  grad_norm: 16.4163  memory: 16.91GiB(35.59%)  tps: 7,268  tflops: 56.82  mfu: 18.21%
[rank2]:2025-11-10 21:44:00,321 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.67/1.00
[rank2]:2025-11-10 21:44:00,322 - INFO -  step: 150  loss: -4.0000  grad_norm: 16.4163  memory:  8.70GiB(18.31%)  tps: 7,268  tflops: 56.82  mfu: 18.21%
[rank1]:2025-11-10 21:44:00,325 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.67/1.00
[rank1]:2025-11-10 21:44:00,326 - INFO -  step: 150  loss: -4.0000  grad_norm: 16.4163  memory: 12.92GiB(27.20%)  tps: 7,268  tflops: 56.82  mfu: 18.21%
[rank0]:2025-11-10 21:47:23,449 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-10 21:47:26,873 - INFO - Avg. fwd time: 25.8346 / Avg. bwd time: 67.5011 / Avg. batch time: 891.6833 (ms) / GPU bubble ratio: 16.26%
[rank2]:2025-11-10 21:47:27,002 - INFO - Avg. fwd time: 15.4930 / Avg. bwd time: 31.9522 / Avg. batch time: 947.3856 (ms) / GPU bubble ratio: 59.94%
[rank0]:2025-11-10 21:47:27,082 - INFO - Avg. fwd time: 16.0066 / Avg. bwd time: 31.1366 / Avg. batch time: 1074.0156 (ms) / GPU bubble ratio: 64.88%
[rank1]:2025-11-10 21:47:27,073 - INFO - Avg. fwd time: 19.9346 / Avg. bwd time: 40.1939 / Avg. batch time: 1016.1018 (ms) / GPU bubble ratio: 52.66%
[rank2]:2025-11-10 21:47:27,401 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-10 21:47:27,402 - INFO -  step: 200  loss: -4.0000  grad_norm:  1.5008  memory:  8.70GiB(18.31%)  tps: 7,912  tflops: 61.85  mfu: 19.82%
[rank0]:2025-11-10 21:47:27,422 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.28/0.28, [MB7] 1.00/1.00
[rank0]:2025-11-10 21:47:27,423 - INFO -  step: 200  loss: -4.0000  grad_norm:  1.5008  memory: 16.91GiB(35.59%)  tps: 7,912  tflops: 61.85  mfu: 19.82%
[rank3]:2025-11-10 21:47:27,389 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.40/0.40, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 0.00/0.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-11-10 21:47:27,392 - INFO -  step: 200  loss:  2.3113  grad_norm:  1.5008  memory: 26.76GiB(56.33%)  tps: 7,913  tflops: 61.86  mfu: 19.83%
[rank1]:2025-11-10 21:47:27,405 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-11-10 21:47:27,406 - INFO -  step: 200  loss: -4.0000  grad_norm:  1.5008  memory: 12.92GiB(27.20%)  tps: 7,912  tflops: 61.85  mfu: 19.82%
[rank2]:2025-11-10 21:47:27,472 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_timelyauto_42_dm1/freeze_ratio_history/rank2/251110_2147_stage2_step200.svg
[rank0]:2025-11-10 21:47:27,492 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_timelyauto_42_dm1/freeze_ratio_history/rank0/251110_2147_stage0_step200.svg
[rank1]:2025-11-10 21:47:27,492 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_timelyauto_42_dm1/freeze_ratio_history/rank1/251110_2147_stage1_step200.svg
[rank3]:2025-11-10 21:47:27,586 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_1F1B_timelyauto_42_dm1/pipeline_schedule/251110_2147_real_step200_rank3.svg
[rank3]:> Batch Time: 985.41 ms, GPU Bubble Ratio: 67.68%, 52.40%, 61.70%, 32.84%
[rank3]:2025-11-10 21:47:27,632 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_timelyauto_42_dm1/freeze_ratio_history/rank3/251110_2147_stage3_step200.svg
[rank0]:2025-11-10 21:50:36,959 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-10 21:50:40,320 - INFO - Avg. fwd time: 26.1615 / Avg. bwd time: 63.6352 / Avg. batch time: 863.3757 (ms) / GPU bubble ratio: 16.79%
[rank2]:2025-11-10 21:50:40,448 - INFO - Avg. fwd time: 15.5248 / Avg. bwd time: 31.7621 / Avg. batch time: 919.0253 (ms) / GPU bubble ratio: 58.84%
[rank0]:2025-11-10 21:50:40,529 - INFO - Avg. fwd time: 16.0424 / Avg. bwd time: 28.6745 / Avg. batch time: 1045.6311 (ms) / GPU bubble ratio: 65.79%
[rank1]:2025-11-10 21:50:40,519 - INFO - Avg. fwd time: 19.9715 / Avg. bwd time: 39.5933 / Avg. batch time: 987.8328 (ms) / GPU bubble ratio: 51.76%
[rank3]:2025-11-10 21:50:40,731 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.40/0.40, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 0.00/0.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank2]:2025-11-10 21:50:40,848 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-10 21:50:40,849 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.3033  memory:  8.70GiB(18.31%)  tps: 8,470  tflops: 66.21  mfu: 21.22%
[rank3]:2025-11-10 21:50:40,833 - INFO -  step: 250  loss:  2.1162  grad_norm:  0.0000  memory: 26.76GiB(56.33%)  tps: 8,470  tflops: 66.21  mfu: 21.22%
[rank0]:2025-11-10 21:50:40,868 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.28/0.28, [MB7] 1.00/1.00
[rank0]:2025-11-10 21:50:40,869 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.3033  memory: 16.91GiB(35.59%)  tps: 8,470  tflops: 66.21  mfu: 21.22%
[rank1]:2025-11-10 21:50:40,852 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-11-10 21:50:40,853 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.3033  memory: 12.92GiB(27.20%)  tps: 8,470  tflops: 66.21  mfu: 21.22%
[rank0]:2025-11-10 21:53:50,808 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-10 21:53:54,625 - INFO - Avg. fwd time: 15.5480 / Avg. bwd time: 31.6523 / Avg. batch time: 900.9656 (ms) / GPU bubble ratio: 58.09%
[rank3]:2025-11-10 21:53:54,584 - INFO - Avg. fwd time: 26.3933 / Avg. bwd time: 61.1573 / Avg. batch time: 845.4130 (ms) / GPU bubble ratio: 17.15%
[rank3]:2025-11-10 21:53:54,612 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.40/0.40, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 0.00/0.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-11-10 21:53:54,676 - INFO - Avg. fwd time: 20.0001 / Avg. bwd time: 39.2067 / Avg. batch time: 969.8353 (ms) / GPU bubble ratio: 51.16%
[rank0]:2025-11-10 21:53:54,718 - INFO - Avg. fwd time: 16.0634 / Avg. bwd time: 27.0392 / Avg. batch time: 1027.5589 (ms) / GPU bubble ratio: 66.44%
[rank3]:2025-11-10 21:53:54,728 - INFO -  step: 300  loss:  2.0615  grad_norm:  0.0000  memory: 26.76GiB(56.33%)  tps: 8,450  tflops: 66.06  mfu: 21.17%
[rank1]:2025-11-10 21:53:54,746 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-11-10 21:53:54,747 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.2111  memory: 12.92GiB(27.20%)  tps: 8,450  tflops: 66.06  mfu: 21.17%
[rank2]:2025-11-10 21:53:54,743 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-10 21:53:54,743 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.2111  memory:  8.70GiB(18.31%)  tps: 8,450  tflops: 66.06  mfu: 21.17%
[rank2]:2025-11-10 21:53:54,812 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_timelyauto_42_dm1/freeze_ratio_history/rank2/251110_2153_stage2_step300.svg
[rank0]:2025-11-10 21:53:54,761 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.28/0.28, [MB7] 1.00/1.00
[rank0]:2025-11-10 21:53:54,761 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.2111  memory: 16.91GiB(35.59%)  tps: 8,450  tflops: 66.06  mfu: 21.17%
[rank0]:2025-11-10 21:53:54,808 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_timelyauto_42_dm1/freeze_ratio_history/rank0/251110_2153_stage0_step300.svg
[rank1]:2025-11-10 21:53:54,808 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_timelyauto_42_dm1/freeze_ratio_history/rank1/251110_2153_stage1_step300.svg
[rank3]:2025-11-10 21:53:54,920 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_1F1B_timelyauto_42_dm1/pipeline_schedule/251110_2153_real_step300_rank3.svg
[rank3]:> Batch Time: 948.91 ms, GPU Bubble Ratio: 69.86%, 51.48%, 60.43%, 34.16%
[rank3]:2025-11-10 21:53:54,964 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_timelyauto_42_dm1/freeze_ratio_history/rank3/251110_2153_stage3_step300.svg
[rank0]:2025-11-10 21:57:05,230 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-10 21:57:08,624 - INFO - Avg. fwd time: 26.5405 / Avg. bwd time: 59.6588 / Avg. batch time: 834.6024 (ms) / GPU bubble ratio: 17.37%
[rank2]:2025-11-10 21:57:08,752 - INFO - Avg. fwd time: 15.5647 / Avg. bwd time: 31.5906 / Avg. batch time: 890.1724 (ms) / GPU bubble ratio: 57.62%
[rank1]:2025-11-10 21:57:08,824 - INFO - Avg. fwd time: 20.0197 / Avg. bwd time: 38.9754 / Avg. batch time: 959.0798 (ms) / GPU bubble ratio: 50.79%
[rank0]:2025-11-10 21:57:08,833 - INFO - Avg. fwd time: 16.0793 / Avg. bwd time: 26.0364 / Avg. batch time: 1016.7628 (ms) / GPU bubble ratio: 66.86%
[rank1]:2025-11-10 21:57:09,142 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.1352  memory: 12.92GiB(27.20%)  tps: 8,428  tflops: 65.89  mfu: 21.12%
[rank2]:2025-11-10 21:57:09,138 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.1352  memory:  8.70GiB(18.31%)  tps: 8,428  tflops: 65.89  mfu: 21.12%
[rank3]:2025-11-10 21:57:09,122 - INFO -  step: 350  loss:  2.0464  grad_norm:  0.0000  memory: 26.76GiB(56.33%)  tps: 8,428  tflops: 65.89  mfu: 21.12%
[rank0]:2025-11-10 21:57:09,159 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.1352  memory: 16.91GiB(35.59%)  tps: 8,428  tflops: 65.89  mfu: 21.12%
[rank0]:2025-11-10 22:00:18,119 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-10 22:00:21,522 - INFO - Avg. fwd time: 26.6504 / Avg. bwd time: 58.2327 / Avg. batch time: 824.0781 (ms) / GPU bubble ratio: 17.60%
[rank2]:2025-11-10 22:00:21,651 - INFO - Avg. fwd time: 15.5728 / Avg. bwd time: 31.5320 / Avg. batch time: 879.5875 (ms) / GPU bubble ratio: 57.16%
[rank0]:2025-11-10 22:00:21,731 - INFO - Avg. fwd time: 16.0882 / Avg. bwd time: 25.1631 / Avg. batch time: 1006.1641 (ms) / GPU bubble ratio: 67.20%
[rank1]:2025-11-10 22:00:21,721 - INFO - Avg. fwd time: 20.0308 / Avg. bwd time: 38.7638 / Avg. batch time: 948.5197 (ms) / GPU bubble ratio: 50.41%
[rank3]:2025-11-10 22:00:22,035 - INFO -  step: 400  loss:  2.0629  grad_norm:  0.0000  memory: 26.76GiB(56.33%)  tps: 8,493  tflops: 66.39  mfu: 21.28%
[rank1]:2025-11-10 22:00:22,054 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.1493  memory: 12.92GiB(27.20%)  tps: 8,493  tflops: 66.39  mfu: 21.28%
[rank2]:2025-11-10 22:00:22,050 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.1493  memory:  8.70GiB(18.31%)  tps: 8,493  tflops: 66.39  mfu: 21.28%
[rank2]:2025-11-10 22:00:22,123 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_timelyauto_42_dm1/freeze_ratio_history/rank2/251110_2200_stage2_step400.svg
[rank0]:2025-11-10 22:00:22,070 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.1493  memory: 16.91GiB(35.59%)  tps: 8,493  tflops: 66.39  mfu: 21.28%
[rank0]:2025-11-10 22:00:22,121 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_timelyauto_42_dm1/freeze_ratio_history/rank0/251110_2200_stage0_step400.svg
[rank1]:2025-11-10 22:00:22,121 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_timelyauto_42_dm1/freeze_ratio_history/rank1/251110_2200_stage1_step400.svg
[rank3]:2025-11-10 22:00:22,229 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_1F1B_timelyauto_42_dm1/pipeline_schedule/251110_2200_real_step400_rank3.svg
[rank3]:> Batch Time: 937.91 ms, GPU Bubble Ratio: 69.57%, 51.02%, 60.11%, 34.33%
[rank3]:2025-11-10 22:00:22,278 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_timelyauto_42_dm1/freeze_ratio_history/rank3/251110_2200_stage3_step400.svg
[rank3]:2025-11-10 22:00:43,611 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-11-10 22:00:44,023 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-11-10 22:00:44,069 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-11-10 22:00:44,104 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-11-10 22:03:31,611 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-10 22:03:35,340 - INFO - Avg. fwd time: 26.7377 / Avg. bwd time: 57.1904 / Avg. batch time: 816.4364 (ms) / GPU bubble ratio: 17.76%
[rank2]:2025-11-10 22:03:35,382 - INFO - Avg. fwd time: 15.5783 / Avg. bwd time: 31.4881 / Avg. batch time: 871.9507 (ms) / GPU bubble ratio: 56.82%
[rank1]:2025-11-10 22:03:35,433 - INFO - Avg. fwd time: 20.0370 / Avg. bwd time: 38.5994 / Avg. batch time: 940.9057 (ms) / GPU bubble ratio: 50.14%
[rank0]:2025-11-10 22:03:35,476 - INFO - Avg. fwd time: 16.0948 / Avg. bwd time: 24.4810 / Avg. batch time: 998.5159 (ms) / GPU bubble ratio: 67.49%
[rank1]:2025-11-10 22:03:35,505 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.1505  memory: 12.92GiB(27.20%)  tps: 8,469  tflops: 66.21  mfu: 21.22%
[rank0]:2025-11-10 22:03:35,519 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.1505  memory: 16.91GiB(35.59%)  tps: 8,469  tflops: 66.21  mfu: 21.22%
[rank3]:2025-11-10 22:03:35,485 - INFO -  step: 450  loss:  2.0557  grad_norm:  0.0000  memory: 26.76GiB(56.33%)  tps: 8,469  tflops: 66.21  mfu: 21.22%
[rank2]:2025-11-10 22:03:35,501 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.1505  memory:  8.70GiB(18.31%)  tps: 8,469  tflops: 66.21  mfu: 21.22%
[rank0]:2025-11-10 22:06:45,403 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-10 22:06:48,761 - INFO - Avg. fwd time: 26.8053 / Avg. bwd time: 56.4725 / Avg. batch time: 811.2368 (ms) / GPU bubble ratio: 17.88%
[rank2]:2025-11-10 22:06:48,889 - INFO - Avg. fwd time: 15.5836 / Avg. bwd time: 31.4615 / Avg. batch time: 866.7143 (ms) / GPU bubble ratio: 56.58%
[rank1]:2025-11-10 22:06:48,956 - INFO - Avg. fwd time: 20.0439 / Avg. bwd time: 38.4920 / Avg. batch time: 935.6874 (ms) / GPU bubble ratio: 49.95%
[rank0]:2025-11-10 22:06:48,966 - INFO - Avg. fwd time: 16.0994 / Avg. bwd time: 24.0122 / Avg. batch time: 993.2723 (ms) / GPU bubble ratio: 67.69%
[rank1]:2025-11-10 22:06:49,287 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.1380  memory: 12.92GiB(27.20%)  tps: 8,455  tflops: 66.10  mfu: 21.18%
[rank0]:2025-11-10 22:06:49,303 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.1380  memory: 16.91GiB(35.59%)  tps: 8,455  tflops: 66.10  mfu: 21.18%
[rank2]:2025-11-10 22:06:49,283 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.1380  memory:  8.70GiB(18.31%)  tps: 8,455  tflops: 66.10  mfu: 21.18%
[rank3]:2025-11-10 22:06:49,267 - INFO -  step: 500  loss:  2.0143  grad_norm:  0.0000  memory: 26.76GiB(56.33%)  tps: 8,455  tflops: 66.10  mfu: 21.18%
[rank1]:2025-11-10 22:06:49,350 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_timelyauto_42_dm1/freeze_ratio_history/rank1/251110_2206_stage1_step500.svg
[rank0]:2025-11-10 22:06:49,350 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_timelyauto_42_dm1/freeze_ratio_history/rank0/251110_2206_stage0_step500.svg
[rank2]:2025-11-10 22:06:49,352 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_timelyauto_42_dm1/freeze_ratio_history/rank2/251110_2206_stage2_step500.svg
[rank3]:2025-11-10 22:06:49,460 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_1F1B_timelyauto_42_dm1/pipeline_schedule/251110_2206_real_step500_rank3.svg
[rank3]:> Batch Time: 945.88 ms, GPU Bubble Ratio: 69.74%, 51.30%, 60.28%, 34.07%
[rank3]:2025-11-10 22:06:49,502 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_timelyauto_42_dm1/freeze_ratio_history/rank3/251110_2206_stage3_step500.svg
[rank0]:2025-11-10 22:09:58,707 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-10 22:10:02,105 - INFO - Avg. fwd time: 26.8727 / Avg. bwd time: 55.7572 / Avg. batch time: 806.0574 (ms) / GPU bubble ratio: 17.99%
[rank2]:2025-11-10 22:10:02,234 - INFO - Avg. fwd time: 15.5928 / Avg. bwd time: 31.4406 / Avg. batch time: 861.5474 (ms) / GPU bubble ratio: 56.33%
[rank1]:2025-11-10 22:10:02,301 - INFO - Avg. fwd time: 20.0533 / Avg. bwd time: 38.3925 / Avg. batch time: 930.5367 (ms) / GPU bubble ratio: 49.75%
[rank0]:2025-11-10 22:10:02,312 - INFO - Avg. fwd time: 16.1054 / Avg. bwd time: 23.5641 / Avg. batch time: 988.1039 (ms) / GPU bubble ratio: 67.88%
[rank1]:2025-11-10 22:10:02,627 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.1107  memory: 12.92GiB(27.20%)  tps: 8,474  tflops: 66.25  mfu: 21.23%
[rank0]:2025-11-10 22:10:02,644 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.1107  memory: 16.91GiB(35.59%)  tps: 8,474  tflops: 66.25  mfu: 21.23%
[rank3]:2025-11-10 22:10:02,610 - INFO -  step: 550  loss:  2.0242  grad_norm:  0.0000  memory: 26.76GiB(56.33%)  tps: 8,474  tflops: 66.25  mfu: 21.23%
[rank2]:2025-11-10 22:10:02,623 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.1107  memory:  8.70GiB(18.31%)  tps: 8,474  tflops: 66.25  mfu: 21.23%
[rank0]:2025-11-10 22:13:11,772 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-10 22:13:15,518 - INFO - Avg. fwd time: 26.9175 / Avg. bwd time: 55.1666 / Avg. batch time: 801.6916 (ms) / GPU bubble ratio: 18.09%
[rank2]:2025-11-10 22:13:15,561 - INFO - Avg. fwd time: 15.5981 / Avg. bwd time: 31.4222 / Avg. batch time: 857.1539 (ms) / GPU bubble ratio: 56.11%
[rank1]:2025-11-10 22:13:15,612 - INFO - Avg. fwd time: 20.0600 / Avg. bwd time: 38.3077 / Avg. batch time: 926.1562 (ms) / GPU bubble ratio: 49.58%
[rank1]:2025-11-10 22:13:15,686 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.1331  memory: 12.92GiB(27.20%)  tps: 8,487  tflops: 66.34  mfu: 21.26%
[rank0]:2025-11-10 22:13:15,656 - INFO - Avg. fwd time: 16.1085 / Avg. bwd time: 23.1940 / Avg. batch time: 983.7067 (ms) / GPU bubble ratio: 68.04%
[rank0]:2025-11-10 22:13:15,700 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.1331  memory: 16.91GiB(35.59%)  tps: 8,487  tflops: 66.34  mfu: 21.26%
[rank2]:2025-11-10 22:13:15,682 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.1331  memory:  8.70GiB(18.31%)  tps: 8,487  tflops: 66.34  mfu: 21.26%
[rank3]:2025-11-10 22:13:15,666 - INFO -  step: 600  loss:  2.0266  grad_norm:  0.0000  memory: 26.76GiB(56.33%)  tps: 8,487  tflops: 66.35  mfu: 21.26%
[rank1]:2025-11-10 22:13:15,749 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_timelyauto_42_dm1/freeze_ratio_history/rank1/251110_2213_stage1_step600.svg
[rank0]:2025-11-10 22:13:15,748 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_timelyauto_42_dm1/freeze_ratio_history/rank0/251110_2213_stage0_step600.svg
[rank2]:2025-11-10 22:13:15,750 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_timelyauto_42_dm1/freeze_ratio_history/rank2/251110_2213_stage2_step600.svg
[rank3]:2025-11-10 22:13:15,863 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_1F1B_timelyauto_42_dm1/pipeline_schedule/251110_2213_real_step600_rank3.svg
[rank3]:> Batch Time: 928.88 ms, GPU Bubble Ratio: 69.23%, 50.42%, 59.52%, 34.81%
[rank3]:2025-11-10 22:13:15,909 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_timelyauto_42_dm1/freeze_ratio_history/rank3/251110_2213_stage3_step600.svg
[rank0]:2025-11-10 22:16:25,416 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-10 22:16:28,726 - INFO - Avg. fwd time: 26.9462 / Avg. bwd time: 54.7554 / Avg. batch time: 798.6338 (ms) / GPU bubble ratio: 18.16%
[rank2]:2025-11-10 22:16:28,853 - INFO - Avg. fwd time: 15.6017 / Avg. bwd time: 31.4095 / Avg. batch time: 854.1139 (ms) / GPU bubble ratio: 55.97%
[rank1]:2025-11-10 22:16:28,921 - INFO - Avg. fwd time: 20.0622 / Avg. bwd time: 38.2497 / Avg. batch time: 923.1311 (ms) / GPU bubble ratio: 49.47%
[rank0]:2025-11-10 22:16:28,931 - INFO - Avg. fwd time: 16.1093 / Avg. bwd time: 22.9205 / Avg. batch time: 980.6648 (ms) / GPU bubble ratio: 68.16%
[rank2]:2025-11-10 22:16:29,245 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.1146  memory:  8.70GiB(18.31%)  tps: 8,464  tflops: 66.17  mfu: 21.21%
[rank3]:2025-11-10 22:16:29,230 - INFO -  step: 650  loss:  2.0271  grad_norm:  0.0000  memory: 26.76GiB(56.33%)  tps: 8,464  tflops: 66.17  mfu: 21.21%
[rank0]:2025-11-10 22:16:29,266 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.1146  memory: 16.91GiB(35.59%)  tps: 8,464  tflops: 66.17  mfu: 21.21%
[rank1]:2025-11-10 22:16:29,249 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.1146  memory: 12.92GiB(27.20%)  tps: 8,464  tflops: 66.17  mfu: 21.21%
[rank0]:2025-11-10 22:19:38,114 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-10 22:19:41,465 - INFO - Avg. fwd time: 26.9906 / Avg. bwd time: 54.2902 / Avg. batch time: 795.2684 (ms) / GPU bubble ratio: 18.24%
[rank2]:2025-11-10 22:19:41,590 - INFO - Avg. fwd time: 15.6104 / Avg. bwd time: 31.3996 / Avg. batch time: 850.7288 (ms) / GPU bubble ratio: 55.79%
[rank1]:2025-11-10 22:19:41,661 - INFO - Avg. fwd time: 20.0731 / Avg. bwd time: 38.1957 / Avg. batch time: 919.7689 (ms) / GPU bubble ratio: 49.32%
[rank0]:2025-11-10 22:19:41,673 - INFO - Avg. fwd time: 16.1140 / Avg. bwd time: 22.6574 / Avg. batch time: 977.2955 (ms) / GPU bubble ratio: 68.26%
[rank1]:2025-11-10 22:19:41,991 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0937  memory: 12.92GiB(27.20%)  tps: 8,501  tflops: 66.45  mfu: 21.30%
[rank3]:2025-11-10 22:19:41,971 - INFO -  step: 700  loss:  2.0495  grad_norm:  0.0000  memory: 26.76GiB(56.33%)  tps: 8,501  tflops: 66.45  mfu: 21.30%
[rank2]:2025-11-10 22:19:41,987 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0937  memory:  8.70GiB(18.31%)  tps: 8,501  tflops: 66.45  mfu: 21.30%
[rank0]:2025-11-10 22:19:42,007 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0937  memory: 16.91GiB(35.59%)  tps: 8,501  tflops: 66.45  mfu: 21.30%
[rank1]:2025-11-10 22:19:42,059 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_timelyauto_42_dm1/freeze_ratio_history/rank1/251110_2219_stage1_step700.svg
[rank2]:2025-11-10 22:19:42,062 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_timelyauto_42_dm1/freeze_ratio_history/rank2/251110_2219_stage2_step700.svg
[rank0]:2025-11-10 22:19:42,059 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_timelyauto_42_dm1/freeze_ratio_history/rank0/251110_2219_stage0_step700.svg
[rank3]:2025-11-10 22:19:42,188 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_1F1B_timelyauto_42_dm1/pipeline_schedule/251110_2219_real_step700_rank3.svg
[rank3]:> Batch Time: 944.53 ms, GPU Bubble Ratio: 69.56%, 51.02%, 60.05%, 34.26%
[rank3]:2025-11-10 22:19:42,237 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_timelyauto_42_dm1/freeze_ratio_history/rank3/251110_2219_stage3_step700.svg
[rank0]:2025-11-10 22:22:52,798 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-10 22:22:56,597 - INFO - Avg. fwd time: 27.0219 / Avg. bwd time: 53.9752 / Avg. batch time: 792.9981 (ms) / GPU bubble ratio: 18.29%
[rank2]:2025-11-10 22:22:56,641 - INFO - Avg. fwd time: 15.6134 / Avg. bwd time: 31.3897 / Avg. batch time: 848.4813 (ms) / GPU bubble ratio: 55.68%
[rank1]:2025-11-10 22:22:56,694 - INFO - Avg. fwd time: 20.0785 / Avg. bwd time: 38.1474 / Avg. batch time: 917.5293 (ms) / GPU bubble ratio: 49.23%
[rank3]:2025-11-10 22:22:56,749 - INFO -  step: 750  loss:  2.0076  grad_norm:  0.0000  memory: 26.76GiB(56.33%)  tps: 8,412  tflops: 65.76  mfu: 21.08%
[rank2]:2025-11-10 22:22:56,764 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1318  memory:  8.70GiB(18.31%)  tps: 8,412  tflops: 65.76  mfu: 21.08%
[rank0]:2025-11-10 22:22:56,739 - INFO - Avg. fwd time: 16.1168 / Avg. bwd time: 22.4283 / Avg. batch time: 975.0523 (ms) / GPU bubble ratio: 68.37%
[rank0]:2025-11-10 22:22:56,782 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1318  memory: 16.91GiB(35.59%)  tps: 8,412  tflops: 65.76  mfu: 21.08%
[rank1]:2025-11-10 22:22:56,768 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1318  memory: 12.92GiB(27.20%)  tps: 8,412  tflops: 65.76  mfu: 21.08%
[rank0]:2025-11-10 22:26:06,398 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-10 22:26:09,837 - INFO - Avg. fwd time: 27.0395 / Avg. bwd time: 53.7072 / Avg. batch time: 790.9958 (ms) / GPU bubble ratio: 18.33%
[rank2]:2025-11-10 22:26:09,969 - INFO - Avg. fwd time: 15.6144 / Avg. bwd time: 31.3802 / Avg. batch time: 846.4577 (ms) / GPU bubble ratio: 55.58%
[rank0]:2025-11-10 22:26:10,048 - INFO - Avg. fwd time: 16.1177 / Avg. bwd time: 22.2541 / Avg. batch time: 973.0242 (ms) / GPU bubble ratio: 68.45%
[rank1]:2025-11-10 22:26:10,037 - INFO - Avg. fwd time: 20.0807 / Avg. bwd time: 38.1077 / Avg. batch time: 915.5087 (ms) / GPU bubble ratio: 49.15%
[rank1]:2025-11-10 22:26:10,367 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1308  memory: 12.92GiB(27.20%)  tps: 8,463  tflops: 66.16  mfu: 21.20%
[rank1]:2025-11-10 22:26:10,367 - INFO -  final step: 800  loss: -4.0000  grad_norm:  0.1308  tps: 8,687  tflops: 67.91  mfu: 19.84%
[rank1]:2025-11-10 22:26:10,367 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-11-10 22:26:10,368 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank3]:2025-11-10 22:26:10,347 - INFO -  step: 800  loss:  2.0084  grad_norm:  0.0000  memory: 26.76GiB(56.33%)  tps: 8,463  tflops: 66.16  mfu: 21.21%
[rank3]:2025-11-10 22:26:10,348 - INFO -  final step: 800  loss:  2.0084  grad_norm:  0.0000  tps: 8,695  tflops: 67.97  mfu: 20.00%
[rank3]:2025-11-10 22:26:10,348 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-11-10 22:26:10,349 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank2]:2025-11-10 22:26:10,363 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1308  memory:  8.70GiB(18.31%)  tps: 8,463  tflops: 66.16  mfu: 21.20%
[rank2]:2025-11-10 22:26:10,363 - INFO -  final step: 800  loss: -4.0000  grad_norm:  0.1308  tps: 8,687  tflops: 67.91  mfu: 19.84%
[rank2]:2025-11-10 22:26:10,363 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-10 22:26:10,363 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-11-10 22:26:10,383 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1308  memory: 16.91GiB(35.59%)  tps: 8,463  tflops: 66.16  mfu: 21.20%
[rank0]:2025-11-10 22:26:10,383 - INFO -  final step: 800  loss: -4.0000  grad_norm:  0.1308  tps: 8,687  tflops: 67.91  mfu: 19.84%
[rank0]:2025-11-10 22:26:10,383 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-10 22:26:10,383 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-11-10 22:26:12,349 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank2]:2025-11-10 22:26:12,411 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_timelyauto_42_dm1/freeze_ratio_history/rank2/251110_2226_stage2_final800.svg
[rank0]:2025-11-10 22:26:12,413 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_timelyauto_42_dm1/freeze_ratio_history/rank0/251110_2226_stage0_final800.svg
[rank1]:2025-11-10 22:26:12,409 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_timelyauto_42_dm1/freeze_ratio_history/rank1/251110_2226_stage1_final800.svg
[rank1]:2025-11-10 22:26:12,560 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1109_1F1B_timelyauto_42_dm1/frozen_params_histogram/251110_2226_rank1_stage1.svg
[rank1]:	> Counts Sum: 901200, Total Sum: 1051200 (85.73%), Ratio(%) per element: [85.78, 85.44, 85.61, 85.44, 85.44, 85.1, 85.44, 85.44, 85.44, 85.78, 86.13, 85.78, 85.95, 85.61, 85.44, 85.78, 85.78, 85.44, 85.27, 85.61, 85.78, 85.44, 85.61, 85.78, 85.44, 85.95, 85.78, 85.61, 85.61, 85.27, 85.44, 86.13, 85.61, 85.78, 85.61, 85.61, 85.95, 86.3, 85.95, 85.78, 86.13, 86.3, 86.64, 86.3, 86.13]
[rank1]:2025-11-10 22:26:12,560 - INFO - Destroying the purge thread.
[rank3]:2025-11-10 22:26:12,528 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_1F1B_timelyauto_42_dm1/pipeline_schedule/251110_2226_real_final800_rank3.svg
[rank3]:> Batch Time: 942.94 ms, GPU Bubble Ratio: 69.69%, 51.24%, 60.21%, 34.21%
[rank2]:2025-11-10 22:26:12,575 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1109_1F1B_timelyauto_42_dm1/frozen_params_histogram/251110_2226_rank2_stage2.svg
[rank2]:	> Counts Sum: 720960, Total Sum: 840960 (85.73%), Ratio(%) per element: [85.27, 85.78, 85.95, 85.78, 85.61, 85.44, 85.27, 85.27, 85.44, 85.95, 85.27, 85.78, 85.27, 85.44, 85.44, 85.44, 85.61, 85.27, 85.78, 85.78, 86.13, 85.78, 85.95, 85.95, 85.78, 85.61, 85.95, 85.95, 85.95, 85.78, 85.95, 86.13, 85.95, 86.3, 85.95, 86.13]
[rank2]:2025-11-10 22:26:12,576 - INFO - Destroying the purge thread.
[rank0]:2025-11-10 22:26:12,574 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1109_1F1B_timelyauto_42_dm1/frozen_params_histogram/251110_2226_rank0_stage0.svg
[rank0]:	> Counts Sum: 713920, Total Sum: 864320 (82.60%), Ratio(%) per element: [83.9, 80.99, 80.3, 79.62, 80.13, 80.65, 80.3, 80.3, 80.47, 80.13, 82.19, 82.19, 81.67, 82.36, 82.02, 82.19, 82.36, 81.67, 81.84, 83.39, 82.7, 83.04, 83.56, 85.1, 84.07, 83.56, 83.56, 83.56, 84.41, 83.21, 84.58, 84.24, 84.07, 83.73, 84.41, 84.41, 85.1]
[rank0]:2025-11-10 22:26:12,574 - INFO - Sleeping 2 seconds for other ranks to complete
[rank3]:2025-11-10 22:26:12,677 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_1F1B_timelyauto_42_dm1/pipeline_schedule/251110_2226_thry_final800_rank3.svg
[rank3]:> Batch Time: 653.51 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:2025-11-10 22:26:12,724 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_timelyauto_42_dm1/freeze_ratio_history/rank3/251110_2226_stage3_final800.svg
[rank2]:2025-11-10 22:26:12,796 - INFO - Process group destroyed
[rank3]:2025-11-10 22:26:12,866 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1109_1F1B_timelyauto_42_dm1/frozen_params_histogram/251110_2226_rank3_stage3.svg
[rank3]:	> Counts Sum: 158800, Total Sum: 677440 (23.44%), Ratio(%) per element: [21.23, 21.74, 22.08, 22.08, 21.4, 22.77, 21.91, 22.26, 21.74, 20.37, 21.91, 21.74, 21.23, 23.45, 22.26, 21.57, 22.94, 21.74, 26.71, 26.19, 25.17, 26.19, 25.17, 26.54, 26.02, 25.51, 26.36, 25.51, 25.85]
[rank3]:2025-11-10 22:26:12,867 - INFO - Destroying the purge thread.
[rank1]:2025-11-10 22:26:12,985 - INFO - Process group destroyed
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading history steps 15-16, summary, console lines 259-271
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–‡â–‡â–ƒâ–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–‡â–‡â–ƒâ–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 3.7687
[rank3]:wandb:               final/avg_loss 2.00839
[rank3]:wandb:             final/avg_mfu(%) 19.99616
[rank3]:wandb:             final/avg_tflops 67.97175
[rank3]:wandb:    final/avg_throughput(tps) 8694.77517
[rank3]:wandb:              final/grad_norm 0
[rank3]:wandb:               final/max_loss 2.00839
[rank3]:wandb:                    grad_norm 0
[rank3]:wandb: loss_metrics/global_avg_loss 2.00839
[rank3]:wandb: loss_metrics/global_max_loss 2.00839
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1109_1F1B_timelyauto_42_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/7dgemuh6
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1109_1F1B_timelyauto_42_dm1/20251110-2132/wandb/run-20251110_213245-7dgemuh6/logs
[rank3]:2025-11-10 22:26:14,397 - INFO - Process group destroyed
[rank0]:2025-11-10 22:26:14,574 - INFO - Training completed
[rank0]:2025-11-10 22:26:14,574 - INFO - Destroying the purge thread.
[rank0]:2025-11-10 22:26:14,997 - INFO - Process group destroyed
[rank0]:Stage 0: Modules to keep: {'layers.0', 'layers.2', 'layers.3', 'tok_embeddings', 'layers.1'}
[rank2]:Stage 2: Modules to keep: {'layers.12', 'layers.11', 'layers.10', 'layers.9'}
[rank1]:Stage 1: Modules to keep: {'layers.8', 'layers.5', 'layers.6', 'layers.7', 'layers.4'}
[rank3]:Stage 3: Modules to keep: {'layers.14', 'output', 'layers.15', 'norm', 'layers.13'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1109.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1109_1F1B_timelyauto_42_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1109_1F1B_timelyauto_42_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1109_1F1B_timelyauto_42_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1109_1F1B_timelyauto_42_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1109_1F1B_timelyauto_42_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1109_1F1B_timelyauto_42_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 42
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: 1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 4
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1109_1F1B_timelyauto_42_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1109_1F1B_timelyauto_42_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: timelyauto
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.05
[rank3]:		- percentile: 80
[rank3]:
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
