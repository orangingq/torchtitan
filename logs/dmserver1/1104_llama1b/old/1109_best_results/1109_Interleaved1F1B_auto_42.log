
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 11. 11. (í™”) 03:29:41 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 2,3,4,5
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/1109_Interleaved1F1B_auto_42.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset

âœ”ï¸Running with auto x Interleaved1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1109.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=auto --freezing.threshold=0.05 --freezing.percentile=80 --freezing.max_freeze_ratio=0.8
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank0]:2025-11-11 03:29:47,231 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank0]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank0]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank0]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank1]:2025-11-11 03:29:47,231 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank0]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank0]:"
[rank1]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank1]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank1]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank1]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank1]:"
[rank2]:2025-11-11 03:29:47,271 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank2]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank2]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank2]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank2]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank2]:"
[rank3]:2025-11-11 03:29:47,356 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:"
[rank0]:2025-11-11 03:29:47,441 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-11-11 03:29:47,443 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-11 03:29:47,445 - INFO - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-11-11 03:29:47,446 - INFO - Loading tokenizer from tokenizer.json
[rank1]:2025-11-11 03:29:47,437 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-11-11 03:29:47,439 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-11-11 03:29:47,596 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-11-11 03:29:47,599 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-11-11 03:29:47,528 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-11-11 03:29:47,531 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-11 03:29:47,848 - INFO - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank1]:2025-11-11 03:29:50,768 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-11-11 03:29:50,767 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-11-11 03:29:50,807 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-11-11 03:29:50,810 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-11-11 03:29:50,838 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.2', 'layers.3', 'layers.4']
[rank1]:2025-11-11 03:29:50,851 - INFO - PP rank 1 is building stage_idx 5 with modules ['layers.11', 'layers.12']
[rank1]:2025-11-11 03:29:50,853 - INFO - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank0]:2025-11-11 03:29:50,849 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank2]:2025-11-11 03:29:50,832 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.5', 'layers.6']
[rank2]:2025-11-11 03:29:50,845 - INFO - PP rank 2 is building stage_idx 6 with modules ['layers.13', 'layers.14']
[rank2]:2025-11-11 03:29:50,846 - INFO - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank0]:2025-11-11 03:29:51,001 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-11-11 03:29:51,039 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-11-11 03:29:51,039 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-11-11 03:29:51,039 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank2]:2025-11-11 03:29:51,030 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-11-11 03:29:51,030 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-11-11 03:29:51,031 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank0]:2025-11-11 03:29:51,045 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-11 03:29:51,046 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-11-11 03:29:51,072 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1']
[rank0]:2025-11-11 03:29:51,085 - INFO - PP rank 0 is building stage_idx 4 with modules ['layers.9', 'layers.10']
[rank0]:2025-11-11 03:29:51,086 - INFO - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank0]:2025-11-11 03:29:51,275 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-11 03:29:51,275 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-11-11 03:29:51,276 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run xl9t7yza
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1109_Interleaved1F1B_auto_42_dm1/20251111-0329/wandb/run-20251111_032952-xl9t7yza
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1109_Interleaved1F1B_auto_42_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/xl9t7yza
[rank3]:2025-11-11 03:29:53,167 - INFO - WandB logging enabled
[rank3]:2025-11-11 03:29:53,167 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-11-11 03:29:53,205 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-11-11 03:29:53,234 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.7', 'layers.8']
[rank3]:2025-11-11 03:29:53,247 - INFO - PP rank 3 is building stage_idx 7 with modules ['layers.15', 'norm', 'output']
[rank3]:2025-11-11 03:29:53,249 - INFO - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank2]:2025-11-11 03:29:53,471 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-11-11 03:29:53,454 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-11-11 03:29:53,454 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-11-11 03:29:53,455 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2025-11-11 03:29:53,471 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank1]:2025-11-11 03:29:53,471 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-11 03:29:53,473 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1109_Interleaved1F1B_auto_42_dm1
[rank0]:2025-11-11 03:29:53,473 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-11 03:29:53,474 - INFO - Trainer is initialized with local batch size 32, global batch size 128, gradient accumulation steps 4, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2025-11-11 03:29:53,474 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank0]:2025-11-11 03:29:56,454 - INFO - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-11-11 03:29:56,454 - INFO - Finished loading the checkpoint in 2.98 seconds.
[rank0]:2025-11-11 03:29:56,454 - INFO - Training starts at step 1
[rank1]:2025-11-11 03:30:02,146 - INFO -  step:  1  loss: -4.0000  grad_norm: 203.0654  memory: 16.17GiB(34.04%)  tps: 2,891  tflops: 22.60  mfu: 7.24%
[rank1]:2025-11-11 03:30:02,146 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-11-11 03:30:02,129 - INFO -  step:  1  loss: -4.0000  grad_norm: 203.0654  memory: 10.24GiB(21.56%)  tps: 2,894  tflops: 22.63  mfu: 7.25%
[rank2]:2025-11-11 03:30:02,130 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-11-11 03:30:02,140 - INFO -  step:  1  loss: 10.6092  grad_norm: 203.0654  memory: 25.52GiB(53.71%)  tps: 3,669  tflops: 28.68  mfu: 9.19%
[rank3]:2025-11-11 03:30:02,140 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-11 03:30:02,170 - INFO -  step:  1  loss: -4.0000  grad_norm: 203.0654  memory: 16.58GiB(34.89%)  tps: 2,946  tflops: 23.03  mfu: 7.38%
[rank0]:2025-11-11 03:30:02,170 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-11 03:34:07,000 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-11 03:34:11,451 - INFO - Avg. fwd time: 14.2237 / Avg. bwd time: 40.0983 / Avg. batch time: 1086.1672 (ms) / GPU bubble ratio: 19.98%
[rank2]:2025-11-11 03:34:11,558 - INFO - Avg. fwd time: 7.7676 / Avg. bwd time: 18.4215 / Avg. batch time: 1147.6434 (ms) / GPU bubble ratio: 63.49%
[rank0]:2025-11-11 03:34:11,683 - INFO - Avg. fwd time: 8.2384 / Avg. bwd time: 20.6916 / Avg. batch time: 1244.6065 (ms) / GPU bubble ratio: 62.81%
[rank1]:2025-11-11 03:34:11,750 - INFO - Avg. fwd time: 9.8946 / Avg. bwd time: 23.8322 / Avg. batch time: 1206.1499 (ms) / GPU bubble ratio: 55.26%
[rank1]:2025-11-11 03:34:12,036 - INFO -  step: 50  loss: -4.0000  grad_norm: 24.1140  memory: 18.44GiB(38.81%)  tps: 6,425  tflops: 50.23  mfu: 16.10%
[rank3]:2025-11-11 03:34:12,044 - INFO -  step: 50  loss:  9.8864  grad_norm: 24.1140  memory: 29.23GiB(61.52%)  tps: 6,425  tflops: 50.23  mfu: 16.10%
[rank0]:2025-11-11 03:34:12,047 - INFO -  step: 50  loss: -4.0000  grad_norm: 24.1140  memory: 20.42GiB(42.99%)  tps: 6,426  tflops: 50.23  mfu: 16.10%
[rank2]:2025-11-11 03:34:12,032 - INFO -  step: 50  loss: -4.0000  grad_norm: 24.1140  memory: 12.06GiB(25.39%)  tps: 6,425  tflops: 50.23  mfu: 16.10%
[rank1]:2025-11-11 03:35:03,163 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 0.0000e+00
[rank3]:2025-11-11 03:35:03,174 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 0.0000e+00
[rank2]:2025-11-11 03:35:03,159 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 0.0000e+00
[rank0]:2025-11-11 03:35:03,175 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 0.0000e+00
[rank1]:2025-11-11 03:35:54,429 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 3.7841e+00
[rank3]:2025-11-11 03:35:54,436 - INFO - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 3.4389e+00
[rank2]:2025-11-11 03:35:54,424 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 3.2651e+00
[rank0]:2025-11-11 03:35:54,441 - INFO - Freezing Ratio: [Stage0] 0.47, [Stage4] 0.00, Threshold: 3.4439e+00
[rank1]:2025-11-11 03:36:44,210 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 4.5794e+00
[rank0]:2025-11-11 03:36:44,216 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 3.4464e+00
[rank3]:2025-11-11 03:36:44,208 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 6.4497e+00
[rank2]:2025-11-11 03:36:44,204 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 5.1560e+00
[rank1]:2025-11-11 03:37:35,147 - INFO - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.00, Threshold: 2.2875e+00
[rank2]:2025-11-11 03:37:35,135 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 3.1448e+00
[rank3]:2025-11-11 03:37:35,155 - INFO - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 4.6871e+00
[rank0]:2025-11-11 03:37:35,160 - INFO - Freezing Ratio: [Stage0] 0.47, [Stage4] 0.00, Threshold: 6.1616e+00
[rank0]:2025-11-11 03:38:18,339 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-11 03:38:22,531 - INFO - Avg. fwd time: 14.2838 / Avg. bwd time: 39.2775 / Avg. batch time: 1080.8680 (ms) / GPU bubble ratio: 20.71%
[rank0]:2025-11-11 03:38:22,704 - INFO - Avg. fwd time: 8.2848 / Avg. bwd time: 20.3773 / Avg. batch time: 1238.7022 (ms) / GPU bubble ratio: 62.98%
[rank2]:2025-11-11 03:38:22,665 - INFO - Avg. fwd time: 7.8262 / Avg. bwd time: 18.0749 / Avg. batch time: 1143.1358 (ms) / GPU bubble ratio: 63.75%
[rank1]:2025-11-11 03:38:22,675 - INFO - Avg. fwd time: 9.9610 / Avg. bwd time: 23.4317 / Avg. batch time: 1200.9409 (ms) / GPU bubble ratio: 55.51%
[rank2]:2025-11-11 03:38:23,107 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 5.4655e+00
[rank2]:2025-11-11 03:38:23,107 - INFO -  step: 100  loss: -4.0000  grad_norm: 16.0465  memory: 12.06GiB(25.39%)  tps: 6,526  tflops: 51.01  mfu: 16.35%
[rank3]:2025-11-11 03:38:23,111 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 3.5439e+00
[rank1]:2025-11-11 03:38:23,099 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 6.7214e+00
[rank1]:2025-11-11 03:38:23,100 - INFO -  step: 100  loss: -4.0000  grad_norm: 16.0465  memory: 18.44GiB(38.81%)  tps: 6,526  tflops: 51.02  mfu: 16.35%
[rank3]:2025-11-11 03:38:23,113 - INFO -  step: 100  loss:  8.3392  grad_norm: 16.0465  memory: 29.23GiB(61.52%)  tps: 6,526  tflops: 51.02  mfu: 16.35%
[rank0]:2025-11-11 03:38:23,119 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 6.0613e+00
[rank0]:2025-11-11 03:38:23,119 - INFO -  step: 100  loss: -4.0000  grad_norm: 16.0465  memory: 20.42GiB(42.99%)  tps: 6,526  tflops: 51.01  mfu: 16.35%
[rank0]:2025-11-11 03:38:23,204 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_auto_42_dm1/freeze_ratio_history/rank0/251111_0338_stage0_step100.svg
[rank2]:2025-11-11 03:38:23,192 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_auto_42_dm1/freeze_ratio_history/rank2/251111_0338_stage2_step100.svg
[rank1]:2025-11-11 03:38:23,193 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_auto_42_dm1/freeze_ratio_history/rank1/251111_0338_stage1_step100.svg
[rank0]:2025-11-11 03:38:23,244 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_auto_42_dm1/freeze_ratio_history/rank0/251111_0338_stage4_step100.svg
[rank2]:2025-11-11 03:38:23,258 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_auto_42_dm1/freeze_ratio_history/rank2/251111_0338_stage6_step100.svg
[rank1]:2025-11-11 03:38:23,259 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_auto_42_dm1/freeze_ratio_history/rank1/251111_0338_stage5_step100.svg
[rank3]:2025-11-11 03:38:23,412 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_auto_42_dm1/pipeline_schedule/251111_0338_real_step100_rank3.svg
[rank3]:> Batch Time: 1188.83 ms, GPU Bubble Ratio: 63.14%, 63.72%, 64.18%, 33.06%
[rank3]:2025-11-11 03:38:23,458 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_auto_42_dm1/freeze_ratio_history/rank3/251111_0338_stage3_step100.svg
[rank3]:2025-11-11 03:38:23,499 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_auto_42_dm1/freeze_ratio_history/rank3/251111_0338_stage7_step100.svg
[rank2]:2025-11-11 03:39:14,473 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 2.0540e+00
[rank0]:2025-11-11 03:39:14,497 - INFO - Freezing Ratio: [Stage0] 0.47, [Stage4] 0.00, Threshold: 2.0850e+00
[rank1]:2025-11-11 03:39:14,486 - INFO - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.00, Threshold: 1.8056e+00
[rank3]:2025-11-11 03:39:14,493 - INFO - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 1.1298e+00
[rank2]:2025-11-11 03:40:02,659 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 4.1951e+00
[rank0]:2025-11-11 03:40:02,671 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 5.0668e+00
[rank1]:2025-11-11 03:40:02,652 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 3.8301e+00
[rank3]:2025-11-11 03:40:02,663 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 5.1392e+00
[rank1]:2025-11-11 03:40:53,391 - INFO - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 1.1670e+01
[rank2]:2025-11-11 03:40:53,376 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 3.7013e+01
[rank0]:2025-11-11 03:40:53,403 - INFO - Freezing Ratio: [Stage0] 0.47, [Stage4] 0.00, Threshold: 2.7902e+01
[rank3]:2025-11-11 03:40:53,399 - INFO - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 2.2481e+01
[rank1]:2025-11-11 03:41:40,657 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 3.3069e+00
[rank2]:2025-11-11 03:41:40,657 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 3.8998e+00
[rank3]:2025-11-11 03:41:40,672 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 1.8842e+00
[rank0]:2025-11-11 03:41:40,680 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 2.4980e+00
[rank0]:2025-11-11 03:42:26,430 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-11 03:42:31,399 - INFO - Avg. fwd time: 14.3577 / Avg. bwd time: 38.7928 / Avg. batch time: 1076.8107 (ms) / GPU bubble ratio: 21.03%
[rank1]:2025-11-11 03:42:31,478 - INFO - Avg. fwd time: 10.0056 / Avg. bwd time: 22.3742 / Avg. batch time: 1191.7321 (ms) / GPU bubble ratio: 56.53%
[rank2]:2025-11-11 03:42:31,426 - INFO - Avg. fwd time: 7.9286 / Avg. bwd time: 16.6410 / Avg. batch time: 1135.1111 (ms) / GPU bubble ratio: 65.37%
[rank3]:2025-11-11 03:42:31,549 - INFO - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 2.2314e+00
[rank1]:2025-11-11 03:42:31,541 - INFO - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 2.6026e-01
[rank3]:2025-11-11 03:42:31,551 - INFO -  step: 150  loss:  3.6120  grad_norm: 21.9279  memory: 29.23GiB(61.52%)  tps: 6,595  tflops: 51.56  mfu: 16.52%
[rank1]:2025-11-11 03:42:31,542 - INFO -  step: 150  loss: -4.0000  grad_norm: 21.9279  memory: 18.44GiB(38.81%)  tps: 6,595  tflops: 51.55  mfu: 16.52%
[rank0]:2025-11-11 03:42:31,513 - INFO - Avg. fwd time: 8.2998 / Avg. bwd time: 20.2124 / Avg. batch time: 1229.2617 (ms) / GPU bubble ratio: 62.89%
[rank0]:2025-11-11 03:42:31,553 - INFO - Freezing Ratio: [Stage0] 0.47, [Stage4] 0.00, Threshold: 2.3645e+00
[rank0]:2025-11-11 03:42:31,553 - INFO -  step: 150  loss: -4.0000  grad_norm: 21.9279  memory: 20.42GiB(42.99%)  tps: 6,595  tflops: 51.56  mfu: 16.52%
[rank2]:2025-11-11 03:42:31,526 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 1.9245e+00
[rank2]:2025-11-11 03:42:31,526 - INFO -  step: 150  loss: -4.0000  grad_norm: 21.9279  memory: 12.06GiB(25.39%)  tps: 6,595  tflops: 51.56  mfu: 16.53%
[rank0]:2025-11-11 03:43:19,023 - INFO - Freezing Ratio: [Stage0] 0.47, [Stage4] 0.00, Threshold: 1.9288e+01
[rank1]:2025-11-11 03:43:18,999 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 6.5747e+00
[rank3]:2025-11-11 03:43:19,015 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 4.5160e+00
[rank2]:2025-11-11 03:43:18,999 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 4.6755e+00
[rank1]:2025-11-11 03:44:09,674 - INFO - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 6.0562e+00
[rank3]:2025-11-11 03:44:09,680 - INFO - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 1.6926e+01
[rank0]:2025-11-11 03:44:09,680 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 1.8092e+01
[rank2]:2025-11-11 03:44:09,657 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 4.3982e+01
[rank1]:2025-11-11 03:44:56,589 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 5.6007e+00
[rank3]:2025-11-11 03:44:56,605 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 3.7446e+00
[rank2]:2025-11-11 03:44:56,589 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 5.3852e+00
[rank0]:2025-11-11 03:44:56,605 - INFO - Freezing Ratio: [Stage0] 0.47, [Stage4] 0.00, Threshold: 5.1238e+00
[rank3]:2025-11-11 03:45:47,309 - INFO - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 2.4959e+00
[rank1]:2025-11-11 03:45:47,302 - INFO - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 6.7198e-01
[rank2]:2025-11-11 03:45:47,285 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 3.7365e+00
[rank0]:2025-11-11 03:45:47,309 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 1.4447e+00
[rank0]:2025-11-11 03:46:29,386 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-11 03:46:33,562 - INFO - Avg. fwd time: 14.3809 / Avg. bwd time: 38.4786 / Avg. batch time: 1073.2627 (ms) / GPU bubble ratio: 21.20%
[rank2]:2025-11-11 03:46:33,590 - INFO - Avg. fwd time: 7.9938 / Avg. bwd time: 15.5730 / Avg. batch time: 1128.5307 (ms) / GPU bubble ratio: 66.59%
[rank1]:2025-11-11 03:46:33,629 - INFO - Avg. fwd time: 10.0611 / Avg. bwd time: 21.5428 / Avg. batch time: 1184.0732 (ms) / GPU bubble ratio: 57.29%
[rank0]:2025-11-11 03:46:33,688 - INFO - Avg. fwd time: 8.3632 / Avg. bwd time: 19.5291 / Avg. batch time: 1220.6147 (ms) / GPU bubble ratio: 63.44%
[rank3]:2025-11-11 03:46:34,121 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 1.1812e+00
[rank3]:2025-11-11 03:46:34,124 - INFO -  step: 200  loss:  1.1787  grad_norm: 18.8275  memory: 29.23GiB(61.52%)  tps: 6,754  tflops: 52.80  mfu: 16.92%
[rank1]:2025-11-11 03:46:34,106 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 1.1363e+00
[rank1]:2025-11-11 03:46:34,106 - INFO -  step: 200  loss: -4.0000  grad_norm: 18.8275  memory: 18.44GiB(38.81%)  tps: 6,755  tflops: 52.80  mfu: 16.92%
[rank1]:2025-11-11 03:46:34,178 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_auto_42_dm1/freeze_ratio_history/rank1/251111_0346_stage1_step200.svg
[rank2]:2025-11-11 03:46:34,105 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 9.3353e-01
[rank2]:2025-11-11 03:46:34,106 - INFO -  step: 200  loss: -4.0000  grad_norm: 18.8275  memory: 12.06GiB(25.39%)  tps: 6,754  tflops: 52.80  mfu: 16.92%
[rank2]:2025-11-11 03:46:34,178 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_auto_42_dm1/freeze_ratio_history/rank2/251111_0346_stage2_step200.svg
[rank0]:2025-11-11 03:46:34,121 - INFO - Freezing Ratio: [Stage0] 0.47, [Stage4] 0.00, Threshold: 8.4345e-01
[rank0]:2025-11-11 03:46:34,122 - INFO -  step: 200  loss: -4.0000  grad_norm: 18.8275  memory: 20.42GiB(42.99%)  tps: 6,754  tflops: 52.80  mfu: 16.92%
[rank0]:2025-11-11 03:46:34,179 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_auto_42_dm1/freeze_ratio_history/rank0/251111_0346_stage0_step200.svg
[rank1]:2025-11-11 03:46:34,223 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_auto_42_dm1/freeze_ratio_history/rank1/251111_0346_stage5_step200.svg
[rank2]:2025-11-11 03:46:34,224 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_auto_42_dm1/freeze_ratio_history/rank2/251111_0346_stage6_step200.svg
[rank0]:2025-11-11 03:46:34,225 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_auto_42_dm1/freeze_ratio_history/rank0/251111_0346_stage4_step200.svg
[rank3]:2025-11-11 03:46:34,391 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_auto_42_dm1/pipeline_schedule/251111_0346_real_step200_rank3.svg
[rank3]:> Batch Time: 1230.72 ms, GPU Bubble Ratio: 65.09%, 56.17%, 73.70%, 28.76%
[rank3]:2025-11-11 03:46:34,439 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_auto_42_dm1/freeze_ratio_history/rank3/251111_0346_stage3_step200.svg
[rank3]:2025-11-11 03:46:34,484 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_auto_42_dm1/freeze_ratio_history/rank3/251111_0346_stage7_step200.svg
[rank3]:2025-11-11 03:47:25,098 - INFO - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 1.9115e+00
[rank2]:2025-11-11 03:47:25,075 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 3.3849e+00
[rank1]:2025-11-11 03:47:25,091 - INFO - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 7.6059e-01
[rank0]:2025-11-11 03:47:25,098 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 2.8263e+00
[rank2]:2025-11-11 03:48:11,706 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 5.2093e+00
[rank3]:2025-11-11 03:48:11,721 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 4.6853e+00
[rank1]:2025-11-11 03:48:11,706 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 5.1407e+00
[rank0]:2025-11-11 03:48:11,722 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 9.0107e+00
[rank3]:2025-11-11 03:49:01,848 - INFO - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 1.0543e+00
[rank2]:2025-11-11 03:49:01,825 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 1.7415e+00
[rank1]:2025-11-11 03:49:01,843 - INFO - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 2.8103e-01
[rank0]:2025-11-11 03:49:01,841 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 2.1393e+00
[rank1]:2025-11-11 03:49:48,660 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 4.4343e+00
[rank3]:2025-11-11 03:49:48,675 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 3.9182e+00
[rank2]:2025-11-11 03:49:48,659 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 3.9531e+00
[rank0]:2025-11-11 03:49:48,675 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 6.7185e+00
[rank0]:2025-11-11 03:50:33,916 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-11-11 03:50:38,339 - INFO - Avg. fwd time: 8.0373 / Avg. bwd time: 14.8271 / Avg. batch time: 1124.0087 (ms) / GPU bubble ratio: 67.45%
[rank3]:2025-11-11 03:50:38,357 - INFO - Avg. fwd time: 14.3788 / Avg. bwd time: 38.3108 / Avg. batch time: 1070.8708 (ms) / GPU bubble ratio: 21.28%
[rank0]:2025-11-11 03:50:38,453 - INFO - Avg. fwd time: 8.4380 / Avg. bwd time: 18.6011 / Avg. batch time: 1214.5953 (ms) / GPU bubble ratio: 64.38%
[rank1]:2025-11-11 03:50:38,656 - INFO - Avg. fwd time: 10.0931 / Avg. bwd time: 21.1316 / Avg. batch time: 1179.2676 (ms) / GPU bubble ratio: 57.64%
[rank2]:2025-11-11 03:50:38,913 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 3.8594e+00
[rank2]:2025-11-11 03:50:38,914 - INFO -  step: 250  loss: -4.0000  grad_norm:  3.8322  memory: 12.06GiB(25.39%)  tps: 6,693  tflops: 52.32  mfu: 16.77%
[rank3]:2025-11-11 03:50:38,936 - INFO - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 2.2640e+00
[rank3]:2025-11-11 03:50:38,939 - INFO -  step: 250  loss:  0.3811  grad_norm:  3.8322  memory: 29.23GiB(61.52%)  tps: 6,692  tflops: 52.32  mfu: 16.77%
[rank1]:2025-11-11 03:50:38,930 - INFO - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 7.4213e-01
[rank1]:2025-11-11 03:50:38,930 - INFO -  step: 250  loss: -4.0000  grad_norm:  3.8322  memory: 18.44GiB(38.81%)  tps: 6,692  tflops: 52.32  mfu: 16.77%
[rank0]:2025-11-11 03:50:38,929 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 2.6804e+00
[rank0]:2025-11-11 03:50:38,929 - INFO -  step: 250  loss: -4.0000  grad_norm:  3.8322  memory: 20.42GiB(42.99%)  tps: 6,693  tflops: 52.32  mfu: 16.77%
[rank2]:2025-11-11 03:51:25,546 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 5.2989e+00
[rank1]:2025-11-11 03:51:25,546 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 5.7576e+00
[rank3]:2025-11-11 03:51:25,561 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 5.4862e+00
[rank0]:2025-11-11 03:51:25,561 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 7.1923e+00
[rank2]:2025-11-11 03:52:15,640 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 3.3811e+00
[rank3]:2025-11-11 03:52:15,663 - INFO - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 2.0881e+00
[rank1]:2025-11-11 03:52:15,657 - INFO - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 7.1506e-01
[rank0]:2025-11-11 03:52:15,656 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 3.0475e+00
[rank3]:2025-11-11 03:53:02,334 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 1.2345e+00
[rank2]:2025-11-11 03:53:02,318 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 8.3587e-01
[rank1]:2025-11-11 03:53:02,318 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 6.3164e-01
[rank0]:2025-11-11 03:53:02,334 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 7.2553e-01
[rank1]:2025-11-11 03:53:52,554 - INFO - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 1.8811e+00
[rank3]:2025-11-11 03:53:52,560 - INFO - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 6.1304e+00
[rank2]:2025-11-11 03:53:52,537 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 9.8289e+00
[rank0]:2025-11-11 03:53:52,553 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 7.3998e+00
[rank0]:2025-11-11 03:54:34,472 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-11 03:54:39,024 - INFO - Avg. fwd time: 14.3846 / Avg. bwd time: 38.0907 / Avg. batch time: 1067.9896 (ms) / GPU bubble ratio: 21.38%
[rank3]:2025-11-11 03:54:39,143 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 6.5746e-01
[rank3]:2025-11-11 03:54:39,145 - INFO -  step: 300  loss:  0.2825  grad_norm:  0.7341  memory: 29.23GiB(61.52%)  tps: 6,821  tflops: 53.32  mfu: 17.09%
[rank1]:2025-11-11 03:54:39,090 - INFO - Avg. fwd time: 10.1175 / Avg. bwd time: 20.6931 / Avg. batch time: 1174.0688 (ms) / GPU bubble ratio: 58.01%
[rank1]:2025-11-11 03:54:39,128 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 7.4801e-01
[rank1]:2025-11-11 03:54:39,128 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.7341  memory: 18.44GiB(38.81%)  tps: 6,821  tflops: 53.32  mfu: 17.09%
[rank2]:2025-11-11 03:54:39,062 - INFO - Avg. fwd time: 8.0651 / Avg. bwd time: 14.3415 / Avg. batch time: 1119.5751 (ms) / GPU bubble ratio: 67.98%
[rank2]:2025-11-11 03:54:39,127 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 9.9157e-01
[rank2]:2025-11-11 03:54:39,128 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.7341  memory: 12.06GiB(25.39%)  tps: 6,821  tflops: 53.32  mfu: 17.09%
[rank0]:2025-11-11 03:54:39,117 - INFO - Avg. fwd time: 8.4949 / Avg. bwd time: 17.8520 / Avg. batch time: 1208.4625 (ms) / GPU bubble ratio: 65.12%
[rank0]:2025-11-11 03:54:39,143 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 3.7045e-01
[rank0]:2025-11-11 03:54:39,143 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.7341  memory: 20.42GiB(42.99%)  tps: 6,821  tflops: 53.32  mfu: 17.09%
[rank1]:2025-11-11 03:54:39,197 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_auto_42_dm1/freeze_ratio_history/rank1/251111_0354_stage1_step300.svg
[rank1]:2025-11-11 03:54:39,240 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_auto_42_dm1/freeze_ratio_history/rank1/251111_0354_stage5_step300.svg
[rank2]:2025-11-11 03:54:39,197 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_auto_42_dm1/freeze_ratio_history/rank2/251111_0354_stage2_step300.svg
[rank2]:2025-11-11 03:54:39,239 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_auto_42_dm1/freeze_ratio_history/rank2/251111_0354_stage6_step300.svg
[rank0]:2025-11-11 03:54:39,196 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_auto_42_dm1/freeze_ratio_history/rank0/251111_0354_stage0_step300.svg
[rank0]:2025-11-11 03:54:39,240 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_auto_42_dm1/freeze_ratio_history/rank0/251111_0354_stage4_step300.svg
[rank3]:2025-11-11 03:54:39,412 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_auto_42_dm1/pipeline_schedule/251111_0354_real_step300_rank3.svg
[rank3]:> Batch Time: 1144.45 ms, GPU Bubble Ratio: 67.65%, 65.18%, 71.68%, 30.95%
[rank3]:2025-11-11 03:54:39,458 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_auto_42_dm1/freeze_ratio_history/rank3/251111_0354_stage3_step300.svg
[rank3]:2025-11-11 03:54:39,501 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_auto_42_dm1/freeze_ratio_history/rank3/251111_0354_stage7_step300.svg
[rank2]:2025-11-11 03:55:29,530 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 5.3491e-01
[rank3]:2025-11-11 03:55:29,553 - INFO - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 2.0681e-01
[rank1]:2025-11-11 03:55:29,547 - INFO - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 1.0755e-01
[rank0]:2025-11-11 03:55:29,545 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 2.5929e-01
[rank0]:2025-11-11 03:56:16,393 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 3.3105e+00
[rank2]:2025-11-11 03:56:16,377 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 3.7711e+00
[rank3]:2025-11-11 03:56:16,392 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 3.6517e+00
[rank1]:2025-11-11 03:56:16,377 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 3.7009e+00
[rank1]:2025-11-11 03:57:06,708 - INFO - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 1.4200e+00
[rank2]:2025-11-11 03:57:06,692 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 8.0520e+00
[rank3]:2025-11-11 03:57:06,715 - INFO - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 4.7197e+00
[rank0]:2025-11-11 03:57:06,708 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 5.8859e+00
[rank2]:2025-11-11 03:57:53,422 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 1.6815e+00
[rank3]:2025-11-11 03:57:53,437 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 1.6998e+00
[rank1]:2025-11-11 03:57:53,422 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 1.7695e+00
[rank0]:2025-11-11 03:57:53,438 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 1.7396e+00
[rank0]:2025-11-11 03:58:38,694 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-11 03:58:43,184 - INFO - Avg. fwd time: 14.3834 / Avg. bwd time: 38.0673 / Avg. batch time: 1067.6335 (ms) / GPU bubble ratio: 21.40%
[rank2]:2025-11-11 03:58:43,170 - INFO - Avg. fwd time: 8.0837 / Avg. bwd time: 14.0434 / Avg. batch time: 1118.3001 (ms) / GPU bubble ratio: 68.34%
[rank0]:2025-11-11 03:58:43,281 - INFO - Avg. fwd time: 8.5315 / Avg. bwd time: 17.3916 / Avg. batch time: 1206.6859 (ms) / GPU bubble ratio: 65.63%
[rank1]:2025-11-11 03:58:43,486 - INFO - Avg. fwd time: 10.1283 / Avg. bwd time: 20.5910 / Avg. batch time: 1172.8669 (ms) / GPU bubble ratio: 58.09%
[rank0]:2025-11-11 03:58:43,760 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 2.4299e-01
[rank0]:2025-11-11 03:58:43,761 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.2334  memory: 20.42GiB(42.99%)  tps: 6,698  tflops: 52.36  mfu: 16.78%
[rank1]:2025-11-11 03:58:43,762 - INFO - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 6.7357e-02
[rank1]:2025-11-11 03:58:43,762 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.2334  memory: 18.44GiB(38.81%)  tps: 6,697  tflops: 52.36  mfu: 16.78%
[rank3]:2025-11-11 03:58:43,768 - INFO - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 3.5180e-01
[rank3]:2025-11-11 03:58:43,771 - INFO -  step: 350  loss:  0.2338  grad_norm:  0.2334  memory: 29.23GiB(61.52%)  tps: 6,698  tflops: 52.36  mfu: 16.78%
[rank2]:2025-11-11 03:58:43,745 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 3.8130e-01
[rank2]:2025-11-11 03:58:43,745 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.2334  memory: 12.06GiB(25.39%)  tps: 6,698  tflops: 52.36  mfu: 16.78%
[rank3]:2025-11-11 03:59:30,628 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 2.2453e+00
[rank1]:2025-11-11 03:59:30,612 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 2.5349e+00
[rank2]:2025-11-11 03:59:30,612 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 2.4250e+00
[rank0]:2025-11-11 03:59:30,628 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 1.9357e+00
[rank1]:2025-11-11 04:00:20,837 - INFO - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 1.1511e+00
[rank2]:2025-11-11 04:00:20,820 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 5.9075e+00
[rank3]:2025-11-11 04:00:20,843 - INFO - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 3.9601e+00
[rank0]:2025-11-11 04:00:20,836 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 4.2982e+00
[rank1]:2025-11-11 04:01:07,470 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 9.6399e-01
[rank2]:2025-11-11 04:01:07,470 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 6.3996e-01
[rank3]:2025-11-11 04:01:07,486 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 3.5816e-01
[rank0]:2025-11-11 04:01:07,486 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 8.4487e-01
[rank0]:2025-11-11 04:01:57,585 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 1.0753e+00
[rank3]:2025-11-11 04:01:57,592 - INFO - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 6.2849e-01
[rank2]:2025-11-11 04:01:57,569 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 1.1773e+00
[rank1]:2025-11-11 04:01:57,585 - INFO - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 2.4802e-01
[rank0]:2025-11-11 04:02:39,634 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-11 04:02:43,852 - INFO - Avg. fwd time: 8.0999 / Avg. bwd time: 13.7812 / Avg. batch time: 1116.2006 (ms) / GPU bubble ratio: 68.63%
[rank1]:2025-11-11 04:02:43,891 - INFO - Avg. fwd time: 10.1436 / Avg. bwd time: 20.4032 / Avg. batch time: 1170.5489 (ms) / GPU bubble ratio: 58.25%
[rank3]:2025-11-11 04:02:43,823 - INFO - Avg. fwd time: 14.3784 / Avg. bwd time: 37.9806 / Avg. batch time: 1066.3970 (ms) / GPU bubble ratio: 21.44%
[rank0]:2025-11-11 04:02:43,948 - INFO - Avg. fwd time: 8.5644 / Avg. bwd time: 16.9883 / Avg. batch time: 1203.8612 (ms) / GPU bubble ratio: 66.04%
[rank2]:2025-11-11 04:02:44,355 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 6.1473e-01
[rank2]:2025-11-11 04:02:44,356 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.8958  memory: 12.06GiB(25.39%)  tps: 6,809  tflops: 53.23  mfu: 17.06%
[rank1]:2025-11-11 04:02:44,355 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 7.8364e-01
[rank1]:2025-11-11 04:02:44,356 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.8958  memory: 18.44GiB(38.81%)  tps: 6,810  tflops: 53.24  mfu: 17.06%
[rank3]:2025-11-11 04:02:44,371 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 4.9060e-01
[rank3]:2025-11-11 04:02:44,373 - INFO -  step: 400  loss:  0.2220  grad_norm:  0.8958  memory: 29.23GiB(61.52%)  tps: 6,810  tflops: 53.23  mfu: 17.06%
[rank0]:2025-11-11 04:02:44,371 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 6.7573e-01
[rank0]:2025-11-11 04:02:44,371 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.8958  memory: 20.42GiB(42.99%)  tps: 6,809  tflops: 53.23  mfu: 17.06%
[rank0]:2025-11-11 04:02:44,429 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_auto_42_dm1/freeze_ratio_history/rank0/251111_0402_stage0_step400.svg
[rank2]:2025-11-11 04:02:44,428 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_auto_42_dm1/freeze_ratio_history/rank2/251111_0402_stage2_step400.svg
[rank2]:2025-11-11 04:02:44,476 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_auto_42_dm1/freeze_ratio_history/rank2/251111_0402_stage6_step400.svg
[rank1]:2025-11-11 04:02:44,429 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_auto_42_dm1/freeze_ratio_history/rank1/251111_0402_stage1_step400.svg
[rank1]:2025-11-11 04:02:44,477 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_auto_42_dm1/freeze_ratio_history/rank1/251111_0402_stage5_step400.svg
[rank0]:2025-11-11 04:02:44,478 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_auto_42_dm1/freeze_ratio_history/rank0/251111_0402_stage4_step400.svg
[rank3]:2025-11-11 04:02:44,637 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_auto_42_dm1/pipeline_schedule/251111_0402_real_step400_rank3.svg
[rank3]:> Batch Time: 1153.46 ms, GPU Bubble Ratio: 67.87%, 65.33%, 71.90%, 31.46%
[rank3]:2025-11-11 04:02:44,687 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_auto_42_dm1/freeze_ratio_history/rank3/251111_0402_stage3_step400.svg
[rank3]:2025-11-11 04:02:44,734 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_auto_42_dm1/freeze_ratio_history/rank3/251111_0402_stage7_step400.svg
[rank3]:2025-11-11 04:03:12,892 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-11-11 04:03:13,321 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-11-11 04:03:13,372 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-11-11 04:03:13,357 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-11-11 04:03:34,691 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 5.7595e-01
[rank3]:2025-11-11 04:03:34,698 - INFO - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 4.3526e-01
[rank2]:2025-11-11 04:03:34,675 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 6.2443e-01
[rank1]:2025-11-11 04:03:34,692 - INFO - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 1.4790e-01
[rank0]:2025-11-11 04:04:21,261 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 1.5939e+00
[rank3]:2025-11-11 04:04:21,261 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 1.3269e+00
[rank1]:2025-11-11 04:04:21,246 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 1.7480e+00
[rank2]:2025-11-11 04:04:21,245 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 1.8361e+00
[rank1]:2025-11-11 04:05:11,382 - INFO - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 7.0998e-02
[rank2]:2025-11-11 04:05:11,365 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 4.4784e-01
[rank0]:2025-11-11 04:05:11,380 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 3.7514e-01
[rank3]:2025-11-11 04:05:11,388 - INFO - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 2.0729e-01
[rank0]:2025-11-11 04:05:58,106 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 2.2787e+00
[rank1]:2025-11-11 04:05:58,091 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 2.5960e+00
[rank3]:2025-11-11 04:05:58,106 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 2.6724e+00
[rank2]:2025-11-11 04:05:58,090 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 2.5427e+00
[rank0]:2025-11-11 04:06:43,199 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-11 04:06:48,084 - INFO - Avg. fwd time: 14.3720 / Avg. bwd time: 37.9609 / Avg. batch time: 1065.9691 (ms) / GPU bubble ratio: 21.45%
[rank1]:2025-11-11 04:06:48,163 - INFO - Avg. fwd time: 10.1482 / Avg. bwd time: 20.3630 / Avg. batch time: 1169.6584 (ms) / GPU bubble ratio: 58.26%
[rank2]:2025-11-11 04:06:48,110 - INFO - Avg. fwd time: 8.1113 / Avg. bwd time: 13.5771 / Avg. batch time: 1115.1562 (ms) / GPU bubble ratio: 68.88%
[rank0]:2025-11-11 04:06:48,192 - INFO - Avg. fwd time: 8.5894 / Avg. bwd time: 16.6764 / Avg. batch time: 1202.5888 (ms) / GPU bubble ratio: 66.38%
[rank0]:2025-11-11 04:06:48,218 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 2.9370e+00
[rank0]:2025-11-11 04:06:48,218 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.2951  memory: 20.42GiB(42.99%)  tps: 6,719  tflops: 52.53  mfu: 16.84%
[rank3]:2025-11-11 04:06:48,226 - INFO - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 2.5677e+00
[rank3]:2025-11-11 04:06:48,228 - INFO -  step: 450  loss:  0.2342  grad_norm:  0.2951  memory: 29.23GiB(61.52%)  tps: 6,719  tflops: 52.52  mfu: 16.83%
[rank1]:2025-11-11 04:06:48,218 - INFO - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 7.3688e-01
[rank1]:2025-11-11 04:06:48,219 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.2951  memory: 18.44GiB(38.81%)  tps: 6,719  tflops: 52.52  mfu: 16.83%
[rank2]:2025-11-11 04:06:48,202 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 3.8918e+00
[rank2]:2025-11-11 04:06:48,203 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.2951  memory: 12.06GiB(25.39%)  tps: 6,719  tflops: 52.53  mfu: 16.84%
[rank0]:2025-11-11 04:07:34,870 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 9.0382e-01
[rank3]:2025-11-11 04:07:34,870 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 4.3889e-01
[rank2]:2025-11-11 04:07:34,854 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 7.4620e-01
[rank1]:2025-11-11 04:07:34,854 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 7.0276e-01
[rank0]:2025-11-11 04:08:25,139 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 6.2391e-01
[rank3]:2025-11-11 04:08:25,147 - INFO - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 2.1898e-01
[rank2]:2025-11-11 04:08:25,124 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 7.9688e-01
[rank1]:2025-11-11 04:08:25,141 - INFO - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 2.1563e-01
[rank0]:2025-11-11 04:09:11,986 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 2.0331e+00
[rank3]:2025-11-11 04:09:11,985 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 2.0550e+00
[rank2]:2025-11-11 04:09:11,970 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 2.3273e+00
[rank1]:2025-11-11 04:09:11,970 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 2.3580e+00
[rank0]:2025-11-11 04:10:02,314 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 9.5754e-01
[rank2]:2025-11-11 04:10:02,298 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 8.8234e-01
[rank1]:2025-11-11 04:10:02,315 - INFO - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 1.0929e-01
[rank3]:2025-11-11 04:10:02,321 - INFO - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 5.4572e-01
[rank0]:2025-11-11 04:10:44,494 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-11 04:10:48,611 - INFO - Avg. fwd time: 14.3810 / Avg. bwd time: 37.9015 / Avg. batch time: 1065.3440 (ms) / GPU bubble ratio: 21.48%
[rank2]:2025-11-11 04:10:48,650 - INFO - Avg. fwd time: 8.1198 / Avg. bwd time: 13.4377 / Avg. batch time: 1114.0649 (ms) / GPU bubble ratio: 69.04%
[rank0]:2025-11-11 04:10:48,737 - INFO - Avg. fwd time: 8.6056 / Avg. bwd time: 16.4614 / Avg. batch time: 1200.9663 (ms) / GPU bubble ratio: 66.60%
[rank1]:2025-11-11 04:10:48,689 - INFO - Avg. fwd time: 10.1581 / Avg. bwd time: 20.2224 / Avg. batch time: 1168.3057 (ms) / GPU bubble ratio: 58.39%
[rank0]:2025-11-11 04:10:49,156 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 3.5172e+00
[rank0]:2025-11-11 04:10:49,157 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.2651  memory: 20.42GiB(42.99%)  tps: 6,800  tflops: 53.16  mfu: 17.04%
[rank3]:2025-11-11 04:10:49,156 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 1.5800e+00
[rank3]:2025-11-11 04:10:49,158 - INFO -  step: 500  loss:  0.2302  grad_norm:  0.2651  memory: 29.23GiB(61.52%)  tps: 6,800  tflops: 53.16  mfu: 17.04%
[rank2]:2025-11-11 04:10:49,141 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 2.0690e+00
[rank2]:2025-11-11 04:10:49,141 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.2651  memory: 12.06GiB(25.39%)  tps: 6,800  tflops: 53.16  mfu: 17.04%
[rank1]:2025-11-11 04:10:49,141 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 3.1607e+00
[rank1]:2025-11-11 04:10:49,141 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.2651  memory: 18.44GiB(38.81%)  tps: 6,801  tflops: 53.16  mfu: 17.04%
[rank0]:2025-11-11 04:10:49,209 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_auto_42_dm1/freeze_ratio_history/rank0/251111_0410_stage0_step500.svg
[rank0]:2025-11-11 04:10:49,253 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_auto_42_dm1/freeze_ratio_history/rank0/251111_0410_stage4_step500.svg
[rank2]:2025-11-11 04:10:49,209 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_auto_42_dm1/freeze_ratio_history/rank2/251111_0410_stage2_step500.svg
[rank2]:2025-11-11 04:10:49,251 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_auto_42_dm1/freeze_ratio_history/rank2/251111_0410_stage6_step500.svg
[rank1]:2025-11-11 04:10:49,209 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_auto_42_dm1/freeze_ratio_history/rank1/251111_0410_stage1_step500.svg
[rank1]:2025-11-11 04:10:49,252 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_auto_42_dm1/freeze_ratio_history/rank1/251111_0410_stage5_step500.svg
[rank3]:2025-11-11 04:10:49,425 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_auto_42_dm1/pipeline_schedule/251111_0410_real_step500_rank3.svg
[rank3]:> Batch Time: 1222.45 ms, GPU Bubble Ratio: 69.75%, 55.83%, 73.51%, 28.42%
[rank3]:2025-11-11 04:10:49,471 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_auto_42_dm1/freeze_ratio_history/rank3/251111_0410_stage3_step500.svg
[rank3]:2025-11-11 04:10:49,514 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_auto_42_dm1/freeze_ratio_history/rank3/251111_0410_stage7_step500.svg
[rank0]:2025-11-11 04:11:39,822 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 7.5648e-01
[rank2]:2025-11-11 04:11:39,807 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 7.6981e-01
[rank3]:2025-11-11 04:11:39,830 - INFO - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 6.2022e-01
[rank1]:2025-11-11 04:11:39,823 - INFO - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 9.7685e-02
[rank0]:2025-11-11 04:12:26,689 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 2.4097e+00
[rank3]:2025-11-11 04:12:26,689 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 2.2325e+00
[rank2]:2025-11-11 04:12:26,674 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 2.1650e+00
[rank1]:2025-11-11 04:12:26,674 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 2.3756e+00
[rank2]:2025-11-11 04:13:16,938 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 1.3690e+00
[rank0]:2025-11-11 04:13:16,954 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 9.7816e-01
[rank1]:2025-11-11 04:13:16,955 - INFO - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 2.6798e-01
[rank3]:2025-11-11 04:13:16,962 - INFO - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 9.5686e-01
[rank3]:2025-11-11 04:14:03,669 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 9.3379e-01
[rank2]:2025-11-11 04:14:03,653 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 8.0492e-01
[rank0]:2025-11-11 04:14:03,668 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 3.3223e-01
[rank1]:2025-11-11 04:14:03,653 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 3.3522e-01
[rank0]:2025-11-11 04:14:48,873 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-11-11 04:14:53,347 - INFO - Avg. fwd time: 8.1278 / Avg. bwd time: 13.3035 / Avg. batch time: 1113.5289 (ms) / GPU bubble ratio: 69.21%
[rank3]:2025-11-11 04:14:53,364 - INFO - Avg. fwd time: 14.3853 / Avg. bwd time: 37.8873 / Avg. batch time: 1065.2031 (ms) / GPU bubble ratio: 21.48%
[rank0]:2025-11-11 04:14:53,459 - INFO - Avg. fwd time: 8.6219 / Avg. bwd time: 16.2557 / Avg. batch time: 1200.2001 (ms) / GPU bubble ratio: 66.84%
[rank1]:2025-11-11 04:14:53,666 - INFO - Avg. fwd time: 10.1634 / Avg. bwd time: 20.1639 / Avg. batch time: 1167.7958 (ms) / GPU bubble ratio: 58.45%
[rank3]:2025-11-11 04:14:53,941 - INFO - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 2.7428e-01
[rank3]:2025-11-11 04:14:53,943 - INFO -  step: 550  loss:  0.2360  grad_norm:  0.1660  memory: 29.23GiB(61.52%)  tps: 6,693  tflops: 52.32  mfu: 16.77%
[rank1]:2025-11-11 04:14:53,936 - INFO - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 1.4102e-01
[rank1]:2025-11-11 04:14:53,936 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.1660  memory: 18.44GiB(38.81%)  tps: 6,693  tflops: 52.32  mfu: 16.77%
[rank2]:2025-11-11 04:14:53,917 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 5.9419e-01
[rank2]:2025-11-11 04:14:53,918 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.1660  memory: 12.06GiB(25.39%)  tps: 6,693  tflops: 52.33  mfu: 16.77%
[rank0]:2025-11-11 04:14:53,933 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 5.5621e-01
[rank0]:2025-11-11 04:14:53,933 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.1660  memory: 20.42GiB(42.99%)  tps: 6,693  tflops: 52.33  mfu: 16.77%
[rank2]:2025-11-11 04:15:40,843 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 5.5988e-01
[rank3]:2025-11-11 04:15:40,858 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 4.5220e-01
[rank1]:2025-11-11 04:15:40,843 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 3.5682e-01
[rank0]:2025-11-11 04:15:40,858 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 7.2488e-01
[rank3]:2025-11-11 04:16:31,127 - INFO - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 3.3256e-01
[rank1]:2025-11-11 04:16:31,120 - INFO - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 2.3034e-01
[rank2]:2025-11-11 04:16:31,104 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 1.0387e+00
[rank0]:2025-11-11 04:16:31,120 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 1.1737e+00
[rank3]:2025-11-11 04:17:17,989 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 3.7106e-01
[rank1]:2025-11-11 04:17:17,973 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 6.1567e-01
[rank2]:2025-11-11 04:17:17,973 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 5.0196e-01
[rank0]:2025-11-11 04:17:17,989 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 4.9182e-01
[rank2]:2025-11-11 04:18:08,374 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 8.8373e-01
[rank0]:2025-11-11 04:18:08,390 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 9.1391e-01
[rank1]:2025-11-11 04:18:08,397 - INFO - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 2.3057e-01
[rank3]:2025-11-11 04:18:08,398 - INFO - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 7.0890e-01
[rank0]:2025-11-11 04:18:50,672 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-11 04:18:55,404 - INFO - Avg. fwd time: 8.1357 / Avg. bwd time: 13.1937 / Avg. batch time: 1112.7522 (ms) / GPU bubble ratio: 69.33%
[rank1]:2025-11-11 04:18:55,435 - INFO - Avg. fwd time: 10.1742 / Avg. bwd time: 20.0340 / Avg. batch time: 1166.7466 (ms) / GPU bubble ratio: 58.57%
[rank3]:2025-11-11 04:18:55,370 - INFO - Avg. fwd time: 14.3976 / Avg. bwd time: 37.8376 / Avg. batch time: 1064.7700 (ms) / GPU bubble ratio: 21.51%
[rank2]:2025-11-11 04:18:55,475 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 2.0586e+00
[rank2]:2025-11-11 04:18:55,476 - INFO -  step: 600  loss: -4.0000  grad_norm:  1.0007  memory: 12.06GiB(25.39%)  tps: 6,783  tflops: 53.02  mfu: 16.99%
[rank1]:2025-11-11 04:18:55,475 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 1.9917e+00
[rank1]:2025-11-11 04:18:55,476 - INFO -  step: 600  loss: -4.0000  grad_norm:  1.0007  memory: 18.44GiB(38.81%)  tps: 6,783  tflops: 53.03  mfu: 17.00%
[rank3]:2025-11-11 04:18:55,490 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 2.2424e+00
[rank3]:2025-11-11 04:18:55,493 - INFO -  step: 600  loss:  0.2336  grad_norm:  1.0007  memory: 29.23GiB(61.52%)  tps: 6,783  tflops: 53.03  mfu: 17.00%
[rank0]:2025-11-11 04:18:55,465 - INFO - Avg. fwd time: 8.6360 / Avg. bwd time: 16.0869 / Avg. batch time: 1198.9459 (ms) / GPU bubble ratio: 67.01%
[rank0]:2025-11-11 04:18:55,491 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 2.2470e+00
[rank0]:2025-11-11 04:18:55,491 - INFO -  step: 600  loss: -4.0000  grad_norm:  1.0007  memory: 20.42GiB(42.99%)  tps: 6,783  tflops: 53.02  mfu: 16.99%
[rank0]:2025-11-11 04:18:55,544 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_auto_42_dm1/freeze_ratio_history/rank0/251111_0418_stage0_step600.svg
[rank2]:2025-11-11 04:18:55,549 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_auto_42_dm1/freeze_ratio_history/rank2/251111_0418_stage2_step600.svg
[rank2]:2025-11-11 04:18:55,595 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_auto_42_dm1/freeze_ratio_history/rank2/251111_0418_stage6_step600.svg
[rank1]:2025-11-11 04:18:55,547 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_auto_42_dm1/freeze_ratio_history/rank1/251111_0418_stage1_step600.svg
[rank1]:2025-11-11 04:18:55,594 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_auto_42_dm1/freeze_ratio_history/rank1/251111_0418_stage5_step600.svg
[rank0]:2025-11-11 04:18:55,589 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_auto_42_dm1/freeze_ratio_history/rank0/251111_0418_stage4_step600.svg
[rank3]:2025-11-11 04:18:55,753 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_auto_42_dm1/pipeline_schedule/251111_0418_real_step600_rank3.svg
[rank3]:> Batch Time: 1158.47 ms, GPU Bubble Ratio: 67.96%, 65.43%, 71.95%, 30.90%
[rank3]:2025-11-11 04:18:55,798 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_auto_42_dm1/freeze_ratio_history/rank3/251111_0418_stage3_step600.svg
[rank3]:2025-11-11 04:18:55,841 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_auto_42_dm1/freeze_ratio_history/rank3/251111_0418_stage7_step600.svg
[rank3]:2025-11-11 04:19:46,182 - INFO - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 5.1254e-01
[rank2]:2025-11-11 04:19:46,159 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 1.0734e+00
[rank1]:2025-11-11 04:19:46,176 - INFO - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 1.6635e-01
[rank0]:2025-11-11 04:19:46,174 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 9.6857e-01
[rank1]:2025-11-11 04:20:33,001 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 1.6027e+00
[rank3]:2025-11-11 04:20:33,017 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 2.0393e+00
[rank2]:2025-11-11 04:20:33,001 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 1.7898e+00
[rank0]:2025-11-11 04:20:33,016 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 1.5778e+00
[rank1]:2025-11-11 04:21:23,456 - INFO - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 2.3568e-01
[rank2]:2025-11-11 04:21:23,440 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 1.0204e+00
[rank3]:2025-11-11 04:21:23,463 - INFO - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 2.0244e-01
[rank0]:2025-11-11 04:21:23,456 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 9.6376e-01
[rank1]:2025-11-11 04:22:10,418 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 1.5502e+00
[rank2]:2025-11-11 04:22:10,418 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 2.0974e+00
[rank3]:2025-11-11 04:22:10,433 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 2.1995e+00
[rank0]:2025-11-11 04:22:10,433 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 2.2207e+00
[rank0]:2025-11-11 04:22:55,719 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-11-11 04:23:00,144 - INFO - Avg. fwd time: 8.1402 / Avg. bwd time: 13.1136 / Avg. batch time: 1112.6762 (ms) / GPU bubble ratio: 69.44%
[rank3]:2025-11-11 04:23:00,162 - INFO - Avg. fwd time: 14.4014 / Avg. bwd time: 37.8466 / Avg. batch time: 1064.9379 (ms) / GPU bubble ratio: 21.50%
[rank0]:2025-11-11 04:23:00,254 - INFO - Avg. fwd time: 8.6455 / Avg. bwd time: 15.9631 / Avg. batch time: 1198.8017 (ms) / GPU bubble ratio: 67.16%
[rank1]:2025-11-11 04:23:00,453 - INFO - Avg. fwd time: 10.1758 / Avg. bwd time: 20.0250 / Avg. batch time: 1166.7557 (ms) / GPU bubble ratio: 58.58%
[rank2]:2025-11-11 04:23:00,699 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 1.3217e+00
[rank2]:2025-11-11 04:23:00,700 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.2114  memory: 12.06GiB(25.39%)  tps: 6,681  tflops: 52.23  mfu: 16.74%
[rank1]:2025-11-11 04:23:00,716 - INFO - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 3.6066e-01
[rank1]:2025-11-11 04:23:00,717 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.2114  memory: 18.44GiB(38.81%)  tps: 6,681  tflops: 52.23  mfu: 16.74%
[rank3]:2025-11-11 04:23:00,723 - INFO - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 7.3544e-01
[rank0]:2025-11-11 04:23:00,715 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 2.2411e+00
[rank0]:2025-11-11 04:23:00,715 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.2114  memory: 20.42GiB(42.99%)  tps: 6,681  tflops: 52.23  mfu: 16.74%
[rank3]:2025-11-11 04:23:00,726 - INFO -  step: 650  loss:  0.2370  grad_norm:  0.2114  memory: 29.23GiB(61.52%)  tps: 6,681  tflops: 52.23  mfu: 16.74%
[rank0]:2025-11-11 04:23:47,395 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 5.6603e-01
[rank1]:2025-11-11 04:23:47,380 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 5.1079e-01
[rank2]:2025-11-11 04:23:47,379 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 6.8594e-01
[rank3]:2025-11-11 04:23:47,395 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 8.3134e-01
[rank1]:2025-11-11 04:24:37,628 - INFO - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 1.7261e-01
[rank2]:2025-11-11 04:24:37,610 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 8.8485e-01
[rank3]:2025-11-11 04:24:37,634 - INFO - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 5.0586e-01
[rank0]:2025-11-11 04:24:37,626 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 9.9581e-01
[rank3]:2025-11-11 04:25:24,486 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 1.0646e+00
[rank1]:2025-11-11 04:25:24,471 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 1.3168e+00
[rank2]:2025-11-11 04:25:24,470 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 1.2344e+00
[rank0]:2025-11-11 04:25:24,486 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 9.5475e-01
[rank0]:2025-11-11 04:26:14,672 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 8.4417e-01
[rank3]:2025-11-11 04:26:14,679 - INFO - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 2.9763e-01
[rank1]:2025-11-11 04:26:14,672 - INFO - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 1.3704e-01
[rank2]:2025-11-11 04:26:14,656 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 6.5729e-01
[rank0]:2025-11-11 04:26:56,635 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-11 04:27:00,734 - INFO - Avg. fwd time: 14.4031 / Avg. bwd time: 37.8172 / Avg. batch time: 1064.5700 (ms) / GPU bubble ratio: 21.52%
[rank2]:2025-11-11 04:27:00,759 - INFO - Avg. fwd time: 8.1450 / Avg. bwd time: 13.0320 / Avg. batch time: 1112.0072 (ms) / GPU bubble ratio: 69.53%
[rank1]:2025-11-11 04:27:00,804 - INFO - Avg. fwd time: 10.1806 / Avg. bwd time: 19.9543 / Avg. batch time: 1165.9779 (ms) / GPU bubble ratio: 58.65%
[rank0]:2025-11-11 04:27:00,855 - INFO - Avg. fwd time: 8.6546 / Avg. bwd time: 15.8378 / Avg. batch time: 1197.8688 (ms) / GPU bubble ratio: 67.29%
[rank3]:2025-11-11 04:27:01,269 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 2.5941e-01
[rank3]:2025-11-11 04:27:01,271 - INFO -  step: 700  loss:  0.2015  grad_norm:  0.4567  memory: 29.23GiB(61.52%)  tps: 6,811  tflops: 53.25  mfu: 17.07%
[rank2]:2025-11-11 04:27:01,254 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 4.6497e-01
[rank2]:2025-11-11 04:27:01,254 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.4567  memory: 12.06GiB(25.39%)  tps: 6,811  tflops: 53.24  mfu: 17.07%
[rank1]:2025-11-11 04:27:01,254 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 6.0381e-01
[rank1]:2025-11-11 04:27:01,254 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.4567  memory: 18.44GiB(38.81%)  tps: 6,811  tflops: 53.25  mfu: 17.07%
[rank0]:2025-11-11 04:27:01,269 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 8.3792e-01
[rank0]:2025-11-11 04:27:01,270 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.4567  memory: 20.42GiB(42.99%)  tps: 6,811  tflops: 53.24  mfu: 17.07%
[rank0]:2025-11-11 04:27:01,326 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_auto_42_dm1/freeze_ratio_history/rank0/251111_0427_stage0_step700.svg
[rank2]:2025-11-11 04:27:01,328 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_auto_42_dm1/freeze_ratio_history/rank2/251111_0427_stage2_step700.svg
[rank2]:2025-11-11 04:27:01,377 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_auto_42_dm1/freeze_ratio_history/rank2/251111_0427_stage6_step700.svg
[rank1]:2025-11-11 04:27:01,326 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_auto_42_dm1/freeze_ratio_history/rank1/251111_0427_stage1_step700.svg
[rank1]:2025-11-11 04:27:01,371 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_auto_42_dm1/freeze_ratio_history/rank1/251111_0427_stage5_step700.svg
[rank0]:2025-11-11 04:27:01,372 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_auto_42_dm1/freeze_ratio_history/rank0/251111_0427_stage4_step700.svg
[rank3]:2025-11-11 04:27:01,539 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_auto_42_dm1/pipeline_schedule/251111_0427_real_step700_rank3.svg
[rank3]:> Batch Time: 1152.44 ms, GPU Bubble Ratio: 67.87%, 65.36%, 71.88%, 31.05%
[rank3]:2025-11-11 04:27:01,589 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_auto_42_dm1/freeze_ratio_history/rank3/251111_0427_stage3_step700.svg
[rank3]:2025-11-11 04:27:01,635 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_auto_42_dm1/freeze_ratio_history/rank3/251111_0427_stage7_step700.svg
[rank1]:2025-11-11 04:27:51,821 - INFO - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 7.3622e-01
[rank2]:2025-11-11 04:27:51,804 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 3.8146e+00
[rank3]:2025-11-11 04:27:51,827 - INFO - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 2.4265e+00
[rank0]:2025-11-11 04:27:51,820 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 3.7361e+00
[rank2]:2025-11-11 04:28:38,715 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 2.3642e+00
[rank1]:2025-11-11 04:28:38,715 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 2.4974e+00
[rank0]:2025-11-11 04:28:38,730 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 2.2347e+00
[rank3]:2025-11-11 04:28:38,730 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 2.4143e+00
[rank2]:2025-11-11 04:29:28,977 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 5.9730e-01
[rank0]:2025-11-11 04:29:28,993 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 8.9141e-01
[rank3]:2025-11-11 04:29:29,001 - INFO - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 2.7901e-01
[rank1]:2025-11-11 04:29:28,994 - INFO - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 1.3116e-01
[rank2]:2025-11-11 04:30:15,721 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 2.1957e+00
[rank1]:2025-11-11 04:30:15,722 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 2.0279e+00
[rank0]:2025-11-11 04:30:15,737 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 3.2251e+00
[rank3]:2025-11-11 04:30:15,737 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 2.0821e+00
[rank0]:2025-11-11 04:31:01,107 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-11 04:31:06,055 - INFO - Avg. fwd time: 14.4006 / Avg. bwd time: 37.8356 / Avg. batch time: 1064.7517 (ms) / GPU bubble ratio: 21.50%
[rank2]:2025-11-11 04:31:06,082 - INFO - Avg. fwd time: 8.1489 / Avg. bwd time: 12.9631 / Avg. batch time: 1111.9511 (ms) / GPU bubble ratio: 69.62%
[rank1]:2025-11-11 04:31:06,134 - INFO - Avg. fwd time: 10.1815 / Avg. bwd time: 19.9628 / Avg. batch time: 1166.0448 (ms) / GPU bubble ratio: 58.64%
[rank1]:2025-11-11 04:31:06,191 - INFO - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 1.0394e-01
[rank1]:2025-11-11 04:31:06,192 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1740  memory: 18.44GiB(38.81%)  tps: 6,689  tflops: 52.29  mfu: 16.76%
[rank2]:2025-11-11 04:31:06,176 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 5.0261e-01
[rank2]:2025-11-11 04:31:06,177 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1740  memory: 12.06GiB(25.39%)  tps: 6,689  tflops: 52.30  mfu: 16.76%
[rank0]:2025-11-11 04:31:06,165 - INFO - Avg. fwd time: 8.6629 / Avg. bwd time: 15.7313 / Avg. batch time: 1197.8034 (ms) / GPU bubble ratio: 67.41%
[rank0]:2025-11-11 04:31:06,191 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 6.4078e-01
[rank0]:2025-11-11 04:31:06,192 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1740  memory: 20.42GiB(42.99%)  tps: 6,689  tflops: 52.30  mfu: 16.76%
[rank3]:2025-11-11 04:31:06,199 - INFO - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 2.6594e-01
[rank3]:2025-11-11 04:31:06,201 - INFO -  step: 750  loss:  0.2471  grad_norm:  0.1740  memory: 29.23GiB(61.52%)  tps: 6,689  tflops: 52.29  mfu: 16.76%
[rank0]:2025-11-11 04:31:53,172 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 1.7087e+00
[rank2]:2025-11-11 04:31:53,156 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 1.4683e+00
[rank1]:2025-11-11 04:31:53,156 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 1.4394e+00
[rank3]:2025-11-11 04:31:53,172 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 1.5975e+00
[rank3]:2025-11-11 04:32:43,396 - INFO - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 5.7587e-01
[rank1]:2025-11-11 04:32:43,390 - INFO - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 1.2559e-01
[rank2]:2025-11-11 04:32:43,373 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 8.5440e-01
[rank0]:2025-11-11 04:32:43,388 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 5.0290e-01
[rank0]:2025-11-11 04:33:30,193 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 3.6181e-01
[rank2]:2025-11-11 04:33:30,178 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 6.8318e-01
[rank3]:2025-11-11 04:33:30,193 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 7.4839e-01
[rank1]:2025-11-11 04:33:30,178 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 4.7100e-01
[rank2]:2025-11-11 04:34:20,402 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 4.3544e-01
[rank0]:2025-11-11 04:34:20,418 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 2.9350e-01
[rank1]:2025-11-11 04:34:20,419 - INFO - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 9.2835e-02
[rank3]:2025-11-11 04:34:20,425 - INFO - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 1.8048e-01
[rank0]:2025-11-11 04:35:02,534 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-11 04:35:06,764 - INFO - Avg. fwd time: 14.4012 / Avg. bwd time: 37.8076 / Avg. batch time: 1064.4008 (ms) / GPU bubble ratio: 21.52%
[rank2]:2025-11-11 04:35:06,796 - INFO - Avg. fwd time: 8.1528 / Avg. bwd time: 12.9113 / Avg. batch time: 1111.4302 (ms) / GPU bubble ratio: 69.68%
[rank1]:2025-11-11 04:35:06,834 - INFO - Avg. fwd time: 10.1868 / Avg. bwd time: 19.8987 / Avg. batch time: 1165.4041 (ms) / GPU bubble ratio: 58.70%
[rank0]:2025-11-11 04:35:06,887 - INFO - Avg. fwd time: 8.6695 / Avg. bwd time: 15.6516 / Avg. batch time: 1197.0631 (ms) / GPU bubble ratio: 67.49%
[rank0]:2025-11-11 04:35:07,309 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 1.3648e+00
[rank0]:2025-11-11 04:35:07,309 - INFO -  step: 800  loss: -4.0000  grad_norm:  1.1062  memory: 20.42GiB(42.99%)  tps: 6,795  tflops: 53.12  mfu: 17.03%
[rank0]:2025-11-11 04:35:07,309 - INFO -  final step: 800  loss: -4.0000  grad_norm:  1.1062  tps: 7,112  tflops: 55.60  mfu: 16.25%
[rank0]:2025-11-11 04:35:07,310 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-11 04:35:07,310 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank3]:2025-11-11 04:35:07,309 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 5.8336e-01
[rank3]:2025-11-11 04:35:07,311 - INFO -  step: 800  loss:  0.2507  grad_norm:  1.1062  memory: 29.23GiB(61.52%)  tps: 6,795  tflops: 53.12  mfu: 17.03%
[rank3]:2025-11-11 04:35:07,312 - INFO -  final step: 800  loss:  0.2507  grad_norm:  1.1062  tps: 7,116  tflops: 55.63  mfu: 16.35%
[rank3]:2025-11-11 04:35:07,312 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-11-11 04:35:07,313 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank2]:2025-11-11 04:35:07,293 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 6.7558e-01
[rank2]:2025-11-11 04:35:07,294 - INFO -  step: 800  loss: -4.0000  grad_norm:  1.1062  memory: 12.06GiB(25.39%)  tps: 6,795  tflops: 53.12  mfu: 17.03%
[rank2]:2025-11-11 04:35:07,294 - INFO -  final step: 800  loss: -4.0000  grad_norm:  1.1062  tps: 7,112  tflops: 55.60  mfu: 16.24%
[rank2]:2025-11-11 04:35:07,294 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-11 04:35:07,294 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank1]:2025-11-11 04:35:07,293 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 4.0504e-01
[rank1]:2025-11-11 04:35:07,294 - INFO -  step: 800  loss: -4.0000  grad_norm:  1.1062  memory: 18.44GiB(38.81%)  tps: 6,795  tflops: 53.12  mfu: 17.03%
[rank1]:2025-11-11 04:35:07,294 - INFO -  final step: 800  loss: -4.0000  grad_norm:  1.1062  tps: 7,112  tflops: 55.60  mfu: 16.24%
[rank1]:2025-11-11 04:35:07,294 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-11-11 04:35:07,295 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-11-11 04:35:09,330 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-11-11 04:35:09,404 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_auto_42_dm1/freeze_ratio_history/rank0/251111_0435_stage0_final800.svg
[rank2]:2025-11-11 04:35:09,405 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_auto_42_dm1/freeze_ratio_history/rank2/251111_0435_stage2_final800.svg
[rank1]:2025-11-11 04:35:09,405 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_auto_42_dm1/freeze_ratio_history/rank1/251111_0435_stage1_final800.svg
[rank0]:2025-11-11 04:35:09,530 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_auto_42_dm1/frozen_params_histogram/251111_0435_rank0_stage0.svg
[rank0]:	> Counts Sum: 1188, Total Sum: 1425 (83.37%), Ratio(%) per element: [0.0, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 82.66, 82.66, 82.66, 82.66, 82.66, 82.66, 82.66, 82.66, 82.66]
[rank2]:2025-11-11 04:35:09,522 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_auto_42_dm1/frozen_params_histogram/251111_0435_rank2_stage2.svg
[rank2]:	> Counts Sum: 1278, Total Sum: 1350 (94.67%), Ratio(%) per element: [94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66]
[rank1]:2025-11-11 04:35:09,551 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_auto_42_dm1/frozen_params_histogram/251111_0435_rank1_stage1.svg
[rank1]:	> Counts Sum: 972, Total Sum: 2025 (48.00%), Ratio(%) per element: [48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0]
[rank0]:2025-11-11 04:35:09,580 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_auto_42_dm1/freeze_ratio_history/rank0/251111_0435_stage4_final800.svg
[rank3]:2025-11-11 04:35:09,618 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_auto_42_dm1/pipeline_schedule/251111_0435_real_final800_rank3.svg
[rank3]:> Batch Time: 1216.47 ms, GPU Bubble Ratio: 69.55%, 55.85%, 73.37%, 28.32%
[rank2]:2025-11-11 04:35:09,571 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_auto_42_dm1/freeze_ratio_history/rank2/251111_0435_stage6_final800.svg
[rank1]:2025-11-11 04:35:09,600 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_auto_42_dm1/freeze_ratio_history/rank1/251111_0435_stage5_final800.svg
[rank0]:2025-11-11 04:35:09,690 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_auto_42_dm1/frozen_params_histogram/251111_0435_rank0_stage4.svg
[rank0]:	> Counts Sum: 558, Total Sum: 1350 (41.33%), Ratio(%) per element: [82.66, 82.66, 82.66, 82.66, 82.66, 82.66, 82.66, 82.66, 82.66, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-11-11 04:35:09,690 - INFO - Sleeping 2 seconds for other ranks to complete
[rank2]:2025-11-11 04:35:09,676 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_auto_42_dm1/frozen_params_histogram/251111_0435_rank2_stage6.svg
[rank2]:	> Counts Sum: 621, Total Sum: 1350 (46.00%), Ratio(%) per element: [92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-11-11 04:35:09,677 - INFO - Destroying the purge thread.
[rank1]:2025-11-11 04:35:09,705 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_auto_42_dm1/frozen_params_histogram/251111_0435_rank1_stage5.svg
[rank1]:	> Counts Sum: 306, Total Sum: 1350 (22.67%), Ratio(%) per element: [45.33, 45.33, 45.33, 45.33, 45.33, 45.33, 45.33, 45.33, 45.33, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-11-11 04:35:09,706 - INFO - Destroying the purge thread.
[rank3]:2025-11-11 04:35:09,876 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_auto_42_dm1/pipeline_schedule/251111_0435_thry_final800_rank3.svg
[rank3]:> Batch Time: 590.73 ms, GPU Bubble Ratio: 15.79%, 15.79%, 15.79%, 15.79%
[rank3]:2025-11-11 04:35:09,925 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_auto_42_dm1/freeze_ratio_history/rank3/251111_0435_stage3_final800.svg
[rank3]:2025-11-11 04:35:10,037 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_auto_42_dm1/frozen_params_histogram/251111_0435_rank3_stage3.svg
[rank3]:	> Counts Sum: 666, Total Sum: 1350 (49.33%), Ratio(%) per element: [49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33]
[rank3]:2025-11-11 04:35:10,085 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_auto_42_dm1/freeze_ratio_history/rank3/251111_0435_stage7_final800.svg
[rank3]:2025-11-11 04:35:10,169 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_auto_42_dm1/frozen_params_histogram/251111_0435_rank3_stage7.svg
[rank3]:	> Counts Sum: 0, Total Sum: 825 (0.00%), Ratio(%) per element: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-11-11 04:35:10,170 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank2]:2025-11-11 04:35:10,564 - INFO - Process group destroyed
[rank1]:2025-11-11 04:35:10,561 - INFO - Process group destroyed
[rank3]:wandb: uploading history steps 16-16, summary, console lines 324-334
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–‚â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–ˆâ–†â–ƒâ–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–ˆâ–†â–ƒâ–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 4.6048
[rank3]:wandb:               final/avg_loss 0.25068
[rank3]:wandb:             final/avg_mfu(%) 16.35452
[rank3]:wandb:             final/avg_tflops 55.63003
[rank3]:wandb:    final/avg_throughput(tps) 7116.05409
[rank3]:wandb:              final/grad_norm 1.10615
[rank3]:wandb:               final/max_loss 0.25068
[rank3]:wandb:                    grad_norm 1.10615
[rank3]:wandb: loss_metrics/global_avg_loss 0.25068
[rank3]:wandb: loss_metrics/global_max_loss 0.25068
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1109_Interleaved1F1B_auto_42_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/xl9t7yza
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1109_Interleaved1F1B_auto_42_dm1/20251111-0329/wandb/run-20251111_032952-xl9t7yza/logs
[rank0]:2025-11-11 04:35:11,690 - INFO - Training completed
[rank0]:2025-11-11 04:35:11,691 - INFO - Destroying the purge thread.
[rank3]:2025-11-11 04:35:11,701 - INFO - Process group destroyed
[rank0]:2025-11-11 04:35:12,065 - INFO - Process group destroyed
[rank2]:Stage 2: Modules to keep: {'layers.6', 'layers.5'}
[rank2]:Stage 6: Modules to keep: {'layers.13', 'layers.14'}
[rank1]:Stage 1: Modules to keep: {'layers.2', 'layers.3', 'layers.4'}
[rank1]:Stage 5: Modules to keep: {'layers.11', 'layers.12'}
[rank0]:Stage 0: Modules to keep: {'tok_embeddings', 'layers.0', 'layers.1'}
[rank0]:Stage 4: Modules to keep: {'layers.9', 'layers.10'}
[rank3]:Stage 3: Modules to keep: {'layers.7', 'layers.8'}
[rank3]:Stage 7: Modules to keep: {'layers.15', 'output', 'norm'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1109.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1109_Interleaved1F1B_auto_42_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1109_Interleaved1F1B_auto_42_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1109_Interleaved1F1B_auto_42_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1109_Interleaved1F1B_auto_42_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1109_Interleaved1F1B_auto_42_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1109_Interleaved1F1B_auto_42_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 42
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: Interleaved1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 4
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 2
[rank3]:		- stages_list: [3, 7]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1109_Interleaved1F1B_auto_42_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1109_Interleaved1F1B_auto_42_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: auto
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.05
[rank3]:		- percentile: 80
[rank3]:
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
