
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 11. 27. (ëª©) 03:01:57 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 0,1,2,3
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/1109_1F1B_fullrand7_42_forfun.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset

âœ”ï¸Running with fullrand7 x 1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1109.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=fullrand7 --freezing.threshold=0.01 --freezing.percentile=80 --freezing.max_freeze_ratio=0.8
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank2]:2025-11-27 03:02:03,579 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank2]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank2]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank2]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank2]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank2]:"
[rank3]:2025-11-27 03:02:03,582 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:"
[rank2]:2025-11-27 03:02:03,785 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-11-27 03:02:03,788 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-27 03:02:03,846 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank0]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank0]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank0]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank0]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank0]:"
[rank1]:2025-11-27 03:02:03,846 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank1]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank1]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank1]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank1]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank1]:"
[rank3]:2025-11-27 03:02:03,796 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-11-27 03:02:03,798 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-27 03:02:04,080 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-11-27 03:02:04,082 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-27 03:02:04,087 - INFO - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-11-27 03:02:04,088 - INFO - Loading tokenizer from tokenizer.json
[rank1]:2025-11-27 03:02:04,069 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-11-27 03:02:04,072 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-27 03:02:04,516 - INFO - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank0]:2025-11-27 03:02:07,141 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank2]:2025-11-27 03:02:07,150 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-11-27 03:02:07,189 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-11-27 03:02:07,213 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-11-27 03:02:07,213 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2025-11-27 03:02:07,285 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-11-27 03:02:07,327 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-11-27 03:02:07,366 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-27 03:02:07,367 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-11-27 03:02:07,392 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-11-27 03:02:07,392 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2025-11-27 03:02:07,323 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-11-27 03:02:07,359 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-11-27 03:02:07,360 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank2]:2025-11-27 03:02:07,420 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-11-27 03:02:07,420 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-11-27 03:02:07,421 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank1]:2025-11-27 03:02:07,555 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-11-27 03:02:07,556 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-11-27 03:02:07,557 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank0]:2025-11-27 03:02:07,598 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-27 03:02:07,599 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-11-27 03:02:07,600 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run 6ah0jhpn
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1109_1F1B_fullrand7_42_forfun_dm1/20251127-0302/wandb/run-20251127_030209-6ah0jhpn
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1109_1F1B_fullrand7_42_forfun_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/6ah0jhpn
[rank3]:2025-11-27 03:02:10,361 - INFO - WandB logging enabled
[rank3]:2025-11-27 03:02:10,362 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-11-27 03:02:10,400 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-11-27 03:02:10,429 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-11-27 03:02:10,430 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2025-11-27 03:02:10,633 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1109_1F1B_fullrand7_42_forfun_dm1
[rank0]:2025-11-27 03:02:10,633 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-27 03:02:10,634 - INFO - Trainer is initialized with local batch size 32, global batch size 128, gradient accumulation steps 4, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2025-11-27 03:02:10,634 - WARNING - checkpoint.initial_load_path is provided but the checkpoint.folder exists. Checkpointer will use the checkpoints from the checkpoint.folder /data2/shcho/torchtitan/checkpoint/1109_1F1B_fullrand7_42_forfun_dm1.
[rank0]:2025-11-27 03:02:10,635 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/checkpoint/1109_1F1B_fullrand7_42_forfun_dm1/step-800.
[rank2]:2025-11-27 03:02:10,632 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank2]:2025-11-27 03:02:10,633 - WARNING - checkpoint.initial_load_path is provided but the checkpoint.folder exists. Checkpointer will use the checkpoints from the checkpoint.folder /data2/shcho/torchtitan/checkpoint/1109_1F1B_fullrand7_42_forfun_dm1.
[rank1]:2025-11-27 03:02:10,633 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank1]:2025-11-27 03:02:10,634 - WARNING - checkpoint.initial_load_path is provided but the checkpoint.folder exists. Checkpointer will use the checkpoints from the checkpoint.folder /data2/shcho/torchtitan/checkpoint/1109_1F1B_fullrand7_42_forfun_dm1.
[rank3]:2025-11-27 03:02:10,616 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-11-27 03:02:10,616 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-11-27 03:02:10,617 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2025-11-27 03:02:10,632 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-11-27 03:02:10,633 - WARNING - checkpoint.initial_load_path is provided but the checkpoint.folder exists. Checkpointer will use the checkpoints from the checkpoint.folder /data2/shcho/torchtitan/checkpoint/1109_1F1B_fullrand7_42_forfun_dm1.
[rank0]:2025-11-27 03:02:13,097 - INFO - [GC] GC collection for checkpoint loading. 0.01 seconds
[rank0]:2025-11-27 03:02:13,097 - INFO - Finished loading the checkpoint in 2.46 seconds.
[rank0]:2025-11-27 03:02:13,098 - INFO - Training starts at step 1
[rank2]:2025-11-27 03:02:18,293 - INFO -  step:  1  loss: -4.0000  grad_norm: 26.4880  memory:  6.84GiB(14.41%)  tps: 2,951  tflops: 23.07  mfu: 7.39%
[rank2]:2025-11-27 03:02:18,293 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-11-27 03:02:18,303 - INFO -  step:  1  loss:  2.9590  grad_norm: 26.4880  memory: 21.88GiB(46.05%)  tps: 4,148  tflops: 32.42  mfu: 10.39%
[rank3]:2025-11-27 03:02:18,303 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-11-27 03:02:18,296 - INFO -  step:  1  loss: -4.0000  grad_norm: 26.4880  memory: 10.58GiB(22.26%)  tps: 2,986  tflops: 23.35  mfu: 7.48%
[rank1]:2025-11-27 03:02:18,296 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-27 03:02:18,331 - INFO -  step:  1  loss: -4.0000  grad_norm: 26.4880  memory: 13.10GiB(27.57%)  tps: 2,988  tflops: 23.36  mfu: 7.49%
[rank0]:2025-11-27 03:02:18,331 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-27 03:06:14,303 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-27 03:06:18,686 - INFO - Avg. fwd time: 25.2147 / Avg. bwd time: 82.3892 / Avg. batch time: 1006.4750 (ms) / GPU bubble ratio: 14.47%
[rank2]:2025-11-27 03:06:18,750 - INFO - Avg. fwd time: 15.2274 / Avg. bwd time: 35.6350 / Avg. batch time: 1065.2627 (ms) / GPU bubble ratio: 61.80%
[rank0]:2025-11-27 03:06:18,829 - INFO - Avg. fwd time: 15.2143 / Avg. bwd time: 39.7259 / Avg. batch time: 1201.0750 (ms) / GPU bubble ratio: 63.41%
[rank1]:2025-11-27 03:06:18,876 - INFO - Avg. fwd time: 19.5810 / Avg. bwd time: 45.2429 / Avg. batch time: 1137.6209 (ms) / GPU bubble ratio: 54.41%
[rank2]:2025-11-27 03:06:19,232 - INFO -  step: 50  loss: -4.0000  grad_norm: 24.5601  memory:  8.66GiB(18.23%)  tps: 6,664  tflops: 52.10  mfu: 16.70%
[rank1]:2025-11-27 03:06:19,236 - INFO -  step: 50  loss: -4.0000  grad_norm: 24.5601  memory: 12.86GiB(27.07%)  tps: 6,664  tflops: 52.10  mfu: 16.70%
[rank0]:2025-11-27 03:06:19,249 - INFO -  step: 50  loss: -4.0000  grad_norm: 24.5601  memory: 16.87GiB(35.50%)  tps: 6,665  tflops: 52.10  mfu: 16.70%
[rank3]:2025-11-27 03:06:19,244 - INFO -  step: 50  loss:  2.4783  grad_norm: 24.5601  memory: 25.79GiB(54.28%)  tps: 6,664  tflops: 52.10  mfu: 16.70%
[rank3]:2025-11-27 03:07:08,614 - INFO - [Step 60] ã€°ï¸ Monitoring Upperbound
[rank3]:2025-11-27 03:07:57,940 - INFO - [Step 70] âœ”ï¸  Setting Upperbound
[rank3]:2025-11-27 03:07:58,498 - INFO - [Step 70] ã€°ï¸ Monitoring Lowerbound
[rank3]:2025-11-27 03:07:58,519 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-27 03:07:58,543 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-27 03:07:58,524 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-27 03:07:58,555 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-27 03:07:58,533 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-27 03:07:58,564 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-27 03:07:58,534 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-27 03:07:58,561 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-27 03:07:58,594 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-27 03:07:58,568 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-27 03:07:58,591 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-27 03:07:58,585 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-27 03:07:58,596 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-27 03:07:58,663 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-27 03:07:58,753 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-27 03:07:58,708 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-27 03:07:58,753 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-27 03:07:58,822 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-27 03:07:58,849 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-27 03:07:58,841 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-27 03:07:58,803 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-27 03:07:58,922 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-27 03:07:58,923 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-27 03:07:58,931 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-27 03:07:58,928 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-27 03:07:58,895 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-27 03:07:58,964 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-27 03:07:58,924 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-27 03:07:58,925 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-27 03:07:58,993 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-27 03:07:58,996 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-27 03:07:59,032 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-27 03:09:08,044 - INFO - [Step 90] âœ”ï¸  Setting Lowerbound
[rank3]:2025-11-27 03:09:08,256 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/pipeline_schedule/251127_0309_max_batch_time.svg
[rank3]:			> Batch Time: 1056.41 ms, GPU Bubble Ratio: 58.04%, 50.22%, 61.15%, 16.44%
[rank3]:	[Rank 0]	[S0,MB0,FORWARD] 0-16-16  | [S0,MB1,FORWARD] 16-15-31  | [S0,MB2,FORWARD] 31-15-47  | [S0,MB3,FORWARD] 47-15-62  | [S0,MB0,FULL_BACKWARD] 239-40-280  | [S0,MB4,FORWARD] 280-14-294  | [S0,MB1,FULL_BACKWARD] 348-40-388  | [S0,MB5,FORWARD] 388-14-403  | [S0,MB2,FULL_BACKWARD] 459-40-499  | [S0,MB6,FORWARD] 499-14-514  | [S0,MB3,FULL_BACKWARD] 571-40-611  | [S0,MB7,FORWARD] 611-15-626  | [S0,MB4,FULL_BACKWARD] 682-40-722  | [S0,MB5,FULL_BACKWARD] 794-39-834  | [S0,MB6,FULL_BACKWARD] 905-40-945  | [S0,MB7,FULL_BACKWARD] 1016-39-1056  | 
[rank3]:	[Rank 1]	[S1,MB0,FORWARD] 16-20-36  | [S1,MB1,FORWARD] 36-18-54  | [S1,MB2,FORWARD] 54-18-73  | [S1,MB0,FULL_BACKWARD] 192-46-239  | [S1,MB3,FORWARD] 239-19-258  | [S1,MB1,FULL_BACKWARD] 302-45-348  | [S1,MB4,FORWARD] 348-20-369  | [S1,MB2,FULL_BACKWARD] 413-46-459  | [S1,MB5,FORWARD] 459-20-480  | [S1,MB3,FULL_BACKWARD] 525-45-571  | [S1,MB6,FORWARD] 571-20-591  | [S1,MB4,FULL_BACKWARD] 636-45-682  | [S1,MB7,FORWARD] 682-20-702  | [S1,MB5,FULL_BACKWARD] 748-45-794  | [S1,MB6,FULL_BACKWARD] 859-45-905  | [S1,MB7,FULL_BACKWARD] 971-45-1016  | 
[rank3]:	[Rank 2]	[S2,MB0,FORWARD] 36-16-52  | [S2,MB1,FORWARD] 54-14-69  | [S2,MB0,FULL_BACKWARD] 156-36-192  | [S2,MB2,FORWARD] 192-15-207  | [S2,MB1,FULL_BACKWARD] 266-35-302  | [S2,MB3,FORWARD] 302-15-317  | [S2,MB2,FULL_BACKWARD] 377-35-413  | [S2,MB4,FORWARD] 413-15-428  | [S2,MB3,FULL_BACKWARD] 489-35-525  | [S2,MB5,FORWARD] 525-15-540  | [S2,MB4,FULL_BACKWARD] 600-35-636  | [S2,MB6,FORWARD] 636-15-651  | [S2,MB5,FULL_BACKWARD] 712-35-748  | [S2,MB7,FORWARD] 748-15-763  | [S2,MB6,FULL_BACKWARD] 824-35-859  | [S2,MB7,FULL_BACKWARD] 935-35-971  | 
[rank3]:	[Rank 3]	[S3,MB0,FORWARD] 52-24-76  | [S3,MB0,FULL_BACKWARD] 76-79-156 AFR(10):0.9655 | [S3,MB1,FORWARD] 156-25-181  | [S3,MB1,FULL_BACKWARD] 181-85-266 AFR(10):0.9655 | [S3,MB2,FORWARD] 266-26-293  | [S3,MB2,FULL_BACKWARD] 293-84-377 AFR(10):0.9655 | [S3,MB3,FORWARD] 377-26-404  | [S3,MB3,FULL_BACKWARD] 404-85-489 AFR(10):0.9655 | [S3,MB4,FORWARD] 489-25-515  | [S3,MB4,FULL_BACKWARD] 515-85-600 AFR(10):0.9655 | [S3,MB5,FORWARD] 600-26-627  | [S3,MB5,FULL_BACKWARD] 627-85-712 AFR(10):0.9655 | [S3,MB6,FORWARD] 712-26-738  | [S3,MB6,FULL_BACKWARD] 738-85-824 AFR(10):0.9655 | [S3,MB7,FORWARD] 824-25-850  | [S3,MB7,FULL_BACKWARD] 850-85-935 AFR(10):0.9655 | 
[rank3]:2025-11-27 03:09:08,399 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/pipeline_schedule/251127_0309_min_batch_time.svg
[rank3]:			> Batch Time: 661.61 ms, GPU Bubble Ratio: 81.51%, 47.65%, 59.06%, 14.24%
[rank3]:	[Rank 0]	[S0,MB0,FORWARD] 0-16-16  | [S0,MB1,FORWARD] 16-15-31  | [S0,MB2,FORWARD] 31-15-47  | [S0,MB3,FORWARD] 47-15-62  | [S0,MB0,FULL_BACKWARD] 162-0-162  | [S0,MB4,FORWARD] 162-14-176  | [S0,MB1,FULL_BACKWARD] 232-0-232  | [S0,MB5,FORWARD] 232-14-247  | [S0,MB2,FULL_BACKWARD] 303-0-303  | [S0,MB6,FORWARD] 303-14-318  | [S0,MB3,FULL_BACKWARD] 375-0-375  | [S0,MB7,FORWARD] 375-15-390  | [S0,MB4,FULL_BACKWARD] 446-0-446  | [S0,MB5,FULL_BACKWARD] 519-0-519  | [S0,MB6,FULL_BACKWARD] 590-0-590  | [S0,MB7,FULL_BACKWARD] 661-0-661  | 
[rank3]:	[Rank 1]	[S1,MB0,FORWARD] 16-20-36  | [S1,MB1,FORWARD] 36-18-54  | [S1,MB2,FORWARD] 54-18-73  | [S1,MB0,FULL_BACKWARD] 138-23-162  | [S1,MB3,FORWARD] 162-19-181  | [S1,MB1,FULL_BACKWARD] 208-23-232  | [S1,MB4,FORWARD] 232-20-252  | [S1,MB2,FULL_BACKWARD] 280-23-303  | [S1,MB5,FORWARD] 303-20-324  | [S1,MB3,FULL_BACKWARD] 352-23-375  | [S1,MB6,FORWARD] 375-20-396  | [S1,MB4,FULL_BACKWARD] 423-23-446  | [S1,MB7,FORWARD] 446-20-467  | [S1,MB5,FULL_BACKWARD] 496-23-519  | [S1,MB6,FULL_BACKWARD] 567-23-590  | [S1,MB7,FULL_BACKWARD] 638-23-661  | 
[rank3]:	[Rank 2]	[S2,MB0,FORWARD] 36-16-52  | [S2,MB1,FORWARD] 54-14-69  | [S2,MB0,FULL_BACKWARD] 120-18-138  | [S2,MB2,FORWARD] 138-15-153  | [S2,MB1,FULL_BACKWARD] 190-18-208  | [S2,MB3,FORWARD] 208-15-224  | [S2,MB2,FULL_BACKWARD] 261-18-280  | [S2,MB4,FORWARD] 280-15-295  | [S2,MB3,FULL_BACKWARD] 333-18-352  | [S2,MB5,FORWARD] 352-15-367  | [S2,MB4,FULL_BACKWARD] 404-18-423  | [S2,MB6,FORWARD] 423-15-438  | [S2,MB5,FULL_BACKWARD] 477-18-496  | [S2,MB7,FORWARD] 496-15-511  | [S2,MB6,FULL_BACKWARD] 549-18-567  | [S2,MB7,FULL_BACKWARD] 619-18-638  | 
[rank3]:	[Rank 3]	[S3,MB0,FORWARD] 52-24-76  | [S3,MB0,FULL_BACKWARD] 76-43-120 AFR(10):0.9655 | [S3,MB1,FORWARD] 120-25-145  | [S3,MB1,FULL_BACKWARD] 145-44-190 AFR(10):0.9655 | [S3,MB2,FORWARD] 190-26-216  | [S3,MB2,FULL_BACKWARD] 216-45-261 AFR(10):0.9655 | [S3,MB3,FORWARD] 261-26-288  | [S3,MB3,FULL_BACKWARD] 288-45-333 AFR(10):0.9655 | [S3,MB4,FORWARD] 333-25-359  | [S3,MB4,FULL_BACKWARD] 359-45-404 AFR(10):0.9655 | [S3,MB5,FORWARD] 404-26-431  | [S3,MB5,FULL_BACKWARD] 431-46-477 AFR(10):0.9655 | [S3,MB6,FORWARD] 477-26-503  | [S3,MB6,FULL_BACKWARD] 503-45-549 AFR(10):0.9655 | [S3,MB7,FORWARD] 549-25-574  | [S3,MB7,FULL_BACKWARD] 574-44-619 AFR(10):0.9655 | 
[rank3]:2025-11-27 03:09:08,553 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/pipeline_schedule/251127_0309_frozen_pipeline_schedule.svg
[rank3]:			> Batch Time: 721.07 ms, GPU Bubble Ratio: 45.26%, 30.15%, 45.47%, 13.06%
[rank3]:	[Rank 0]	[S0,MB0,FORWARD] 0-16-16  | [S0,MB1,FORWARD] 16-15-31  | [S0,MB2,FORWARD] 31-15-47  | [S0,MB3,FORWARD] 47-15-62  | [S0,MB0,FULL_BACKWARD] 239-40-280  | [S0,MB4,FORWARD] 280-14-294  | [S0,MB1,FULL_BACKWARD] 307-40-347  | [S0,MB5,FORWARD] 347-14-362  | [S0,MB2,FULL_BACKWARD] 379-40-419  | [S0,MB6,FORWARD] 419-14-434  | [S0,MB3,FULL_BACKWARD] 451-40-491  | [S0,MB7,FORWARD] 491-15-506  | [S0,MB4,FULL_BACKWARD] 522-40-562  | [S0,MB5,FULL_BACKWARD] 618-39-658  | [S0,MB6,FULL_BACKWARD] 689-31-721  | [S0,MB7,FULL_BACKWARD] 721-0-721  | 
[rank3]:	[Rank 1]	[S1,MB0,FORWARD] 16-20-36  | [S1,MB1,FORWARD] 36-18-54  | [S1,MB2,FORWARD] 54-18-73  | [S1,MB0,FULL_BACKWARD] 192-46-239  | [S1,MB3,FORWARD] 239-19-258  | [S1,MB1,FULL_BACKWARD] 261-45-307  | [S1,MB4,FORWARD] 307-20-328  | [S1,MB2,FULL_BACKWARD] 333-46-379  | [S1,MB5,FORWARD] 379-20-400  | [S1,MB3,FULL_BACKWARD] 405-45-451  | [S1,MB6,FORWARD] 451-20-471  | [S1,MB4,FULL_BACKWARD] 476-45-522  | [S1,MB7,FORWARD] 522-20-542  | [S1,MB5,FULL_BACKWARD] 572-45-618  | [S1,MB6,FULL_BACKWARD] 644-45-689  | [S1,MB7,FULL_BACKWARD] 697-23-721  | 
[rank3]:	[Rank 2]	[S2,MB0,FORWARD] 36-16-52  | [S2,MB1,FORWARD] 54-14-69  | [S2,MB0,FULL_BACKWARD] 156-36-192  | [S2,MB2,FORWARD] 192-15-207  | [S2,MB1,FULL_BACKWARD] 226-35-261  | [S2,MB3,FORWARD] 261-15-277  | [S2,MB2,FULL_BACKWARD] 297-35-333  | [S2,MB4,FORWARD] 333-15-348  | [S2,MB3,FULL_BACKWARD] 369-35-405  | [S2,MB5,FORWARD] 405-15-421  | [S2,MB4,FULL_BACKWARD] 440-35-476  | [S2,MB6,FORWARD] 476-15-492  | [S2,MB5,FULL_BACKWARD] 537-35-572  | [S2,MB7,FORWARD] 572-15-588  | [S2,MB6,FULL_BACKWARD] 608-35-644  | [S2,MB7,FULL_BACKWARD] 679-18-697  | 
[rank3]:	[Rank 3]	[S3,MB0,FORWARD] 52-24-76  | [S3,MB0,FULL_BACKWARD] 76-79-156 AFR(10):0.9655 | [S3,MB1,FORWARD] 156-25-181  | [S3,MB1,FULL_BACKWARD] 181-44-226 AFR(10):0.9655 | [S3,MB2,FORWARD] 226-26-252  | [S3,MB2,FULL_BACKWARD] 252-45-297 AFR(10):0.9655 | [S3,MB3,FORWARD] 297-26-324  | [S3,MB3,FULL_BACKWARD] 324-45-369 AFR(10):0.9655 | [S3,MB4,FORWARD] 369-25-395  | [S3,MB4,FULL_BACKWARD] 395-45-440 AFR(10):0.9655 | [S3,MB5,FORWARD] 440-26-467  | [S3,MB5,FULL_BACKWARD] 467-69-537 AFR(10):0.9655 | [S3,MB6,FORWARD] 537-26-563  | [S3,MB6,FULL_BACKWARD] 563-45-608 AFR(10):0.9655 | [S3,MB7,FORWARD] 608-25-634  | [S3,MB7,FULL_BACKWARD] 634-44-679 AFR(10):0.9655 | 
[rank3]:2025-11-27 03:09:08,554 - INFO - 	> Batch Time: 721.07 ms (Average Freeze Ratio: 0.30, Time Reduction Rate: 0.32)
[rank0]:2025-11-27 03:09:43,864 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-27 03:09:47,268 - INFO - Avg. fwd time: 26.4049 / Avg. bwd time: 72.5272 / Avg. batch time: 937.6365 (ms) / GPU bubble ratio: 15.59%
[rank2]:2025-11-27 03:09:47,406 - INFO - Avg. fwd time: 15.4491 / Avg. bwd time: 31.8553 / Avg. batch time: 993.5230 (ms) / GPU bubble ratio: 61.91%
[rank1]:2025-11-27 03:09:47,474 - INFO - Avg. fwd time: 19.9359 / Avg. bwd time: 40.2995 / Avg. batch time: 1060.9297 (ms) / GPU bubble ratio: 54.58%
[rank0]:2025-11-27 03:09:47,485 - INFO - Avg. fwd time: 15.4507 / Avg. bwd time: 30.0306 / Avg. batch time: 1115.2514 (ms) / GPU bubble ratio: 67.38%
[rank2]:2025-11-27 03:09:47,686 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00([0.0, 0.0, 0.0]), [MB1] 0.00/0.00([0.0, 0.0, 0.0]), [MB2] 0.00/0.00([0.0, 0.0, 0.0]), [MB3] 0.00/0.00([0.0, 0.0, 0.0]), [MB4] 0.00/0.00([0.0, 0.0, 0.0]), [MB5] 0.00/0.00([0.0, 0.0, 0.0]), [MB6] 0.00/0.00([0.0, 0.0, 0.0]), [MB7] 0.33/1.00([1.0, 1.0, 1.0])
[rank3]:2025-11-27 03:09:47,668 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00([0.0, 0.0, 0.0]), [MB1] 0.33/1.00([1.0, 1.0, 1.0]), [MB2] 0.33/1.00([1.0, 1.0, 1.0]), [MB3] 0.33/1.00([1.0, 1.0, 1.0]), [MB4] 0.33/1.00([1.0, 1.0, 1.0]), [MB5] 0.13/0.40([0.41379310344827586, 0.41379310344827586, 0.41379310344827586]), [MB6] 0.33/1.00([1.0, 1.0, 1.0]), [MB7] 0.33/1.00([1.0, 1.0, 1.0])
[rank0]:2025-11-27 03:09:47,767 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00([0.0, 0.0, 0.0]), [MB1] 0.00/0.00([0.0, 0.0, 0.0]), [MB2] 0.00/0.00([0.0, 0.0, 0.0]), [MB3] 0.00/0.00([0.0, 0.0, 0.0]), [MB4] 0.00/0.00([0.0, 0.0, 0.0]), [MB5] 0.00/0.00([0.0, 0.0, 0.0]), [MB6] 0.07/0.22([0.21621621621621623, 0.21621621621621623, 0.21621621621621623]), [MB7] 0.33/1.00([1.0, 1.0, 1.0])
[rank2]:2025-11-27 03:09:47,781 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.1317  memory:  8.70GiB(18.31%)  tps: 7,856  tflops: 61.42  mfu: 19.68%
[rank3]:2025-11-27 03:09:47,769 - INFO -  step: 100  loss:  2.0128  grad_norm:  0.0000  memory: 25.79GiB(54.28%)  tps: 7,857  tflops: 61.42  mfu: 19.69%
[rank1]:2025-11-27 03:09:47,733 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00([0.0, 0.0, 0.0]), [MB1] 0.00/0.00([0.0, 0.0, 0.0]), [MB2] 0.00/0.00([0.0, 0.0, 0.0]), [MB3] 0.00/0.00([0.0, 0.0, 0.0]), [MB4] 0.00/0.00([0.0, 0.0, 0.0]), [MB5] 0.00/0.00([0.0, 0.0, 0.0]), [MB6] 0.00/0.00([0.0, 0.0, 0.0]), [MB7] 0.33/1.00([1.0, 1.0, 1.0])
[rank1]:2025-11-27 03:09:47,785 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.1317  memory: 12.88GiB(27.11%)  tps: 7,856  tflops: 61.42  mfu: 19.68%
[rank0]:2025-11-27 03:09:47,798 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.1317  memory: 16.87GiB(35.50%)  tps: 7,856  tflops: 61.42  mfu: 19.68%
[rank0]:2025-11-27 03:09:47,857 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/freeze_ratio_history/rank0/251127_0309_stage0_step100.svg
[rank2]:2025-11-27 03:09:47,856 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/freeze_ratio_history/rank2/251127_0309_stage2_step100.svg
[rank1]:2025-11-27 03:09:47,858 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/freeze_ratio_history/rank1/251127_0309_stage1_step100.svg
[rank3]:2025-11-27 03:09:47,940 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/pipeline_schedule/251127_0309_real_step100_rank3.svg
[rank3]:			> Batch Time: 948.91 ms, GPU Bubble Ratio: 71.86%, 52.02%, 60.71%, 33.99%
[rank3]:	[Rank 0]	[S0,MB0,FORWARD] 0-15-15  | [S0,MB1,FORWARD] 15-17-33  | [S0,MB2,FORWARD] 33-17-50  | [S0,MB3,FORWARD] 50-17-67  | [S0,MB0,FULL_BACKWARD] 204-0-204  | [S0,MB4,FORWARD] 204-15-219  | [S0,MB1,FULL_BACKWARD] 326-0-326  | [S0,MB5,FORWARD] 326-13-340  | [S0,MB2,FULL_BACKWARD] 438-0-438  | [S0,MB6,FORWARD] 438-14-452  | [S0,MB3,FULL_BACKWARD] 557-0-557  | [S0,MB7,FORWARD] 557-14-571  | [S0,MB4,FULL_BACKWARD] 652-34-686  | [S0,MB5,FULL_BACKWARD] 745-39-784  | [S0,MB6,FULL_BACKWARD] 837-35-872  | [S0,MB7,FULL_BACKWARD] 916-32-948  | 
[rank3]:	[Rank 1]	[S1,MB0,FORWARD] 15-20-36  | [S1,MB1,FORWARD] 42-20-63  | [S1,MB2,FORWARD] 69-20-90  | [S1,MB0,FULL_BACKWARD] 170-23-193  | [S1,MB3,FORWARD] 200-20-221  | [S1,MB1,FULL_BACKWARD] 292-23-316  | [S1,MB4,FORWARD] 323-19-342  | [S1,MB2,FULL_BACKWARD] 404-23-427  | [S1,MB5,FORWARD] 434-19-454  | [S1,MB3,FULL_BACKWARD] 497-43-540  | [S1,MB6,FORWARD] 553-20-574  | [S1,MB4,FULL_BACKWARD] 592-46-639  | [S1,MB7,FORWARD] 648-20-669  | [S1,MB5,FULL_BACKWARD] 687-46-733  | [S1,MB6,FULL_BACKWARD] 782-45-828  | [S1,MB7,FULL_BACKWARD] 867-41-908  | 
[rank3]:	[Rank 2]	[S2,MB0,FORWARD] 36-16-52  | [S2,MB1,FORWARD] 63-15-79  | [S2,MB0,FULL_BACKWARD] 141-18-160  | [S2,MB2,FORWARD] 167-16-183  | [S2,MB1,FULL_BACKWARD] 264-18-282  | [S2,MB3,FORWARD] 289-14-304  | [S2,MB2,FULL_BACKWARD] 357-33-391  | [S2,MB4,FORWARD] 401-15-416  | [S2,MB3,FULL_BACKWARD] 451-35-487  | [S2,MB5,FORWARD] 494-16-510  | [S2,MB4,FULL_BACKWARD] 546-35-581  | [S2,MB6,FORWARD] 589-16-605  | [S2,MB5,FULL_BACKWARD] 641-35-676  | [S2,MB7,FORWARD] 684-15-700  | [S2,MB6,FULL_BACKWARD] 740-35-776  | [S2,MB7,FULL_BACKWARD] 828-32-860  | 
[rank3]:	[Rank 3]	[S3,MB0,FORWARD] 52-24-76  | [S3,MB0,FULL_BACKWARD] 88-42-131  | [S3,MB1,FORWARD] 138-28-166  | [S3,MB1,FULL_BACKWARD] 178-77-256  | [S3,MB2,FORWARD] 261-30-291  | [S3,MB2,FULL_BACKWARD] 303-45-348  | [S3,MB3,FORWARD] 354-30-384  | [S3,MB3,FULL_BACKWARD] 397-45-442  | [S3,MB4,FORWARD] 448-29-478  | [S3,MB4,FULL_BACKWARD] 489-44-534  | [S3,MB5,FORWARD] 543-29-572  | [S3,MB5,FULL_BACKWARD] 584-44-629  | [S3,MB6,FORWARD] 637-29-666  | [S3,MB6,FULL_BACKWARD] 677-49-726  | [S3,MB7,FORWARD] 737-29-766  | [S3,MB7,FULL_BACKWARD] 777-45-822  | 
[rank3]:2025-11-27 03:09:47,983 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/freeze_ratio_history/rank3/251127_0309_stage3_step100.svg
[rank0]:2025-11-27 03:13:28,257 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-27 03:13:32,490 - INFO - Avg. fwd time: 26.7467 / Avg. bwd time: 70.6636 / Avg. batch time: 925.9137 (ms) / GPU bubble ratio: 15.84%
[rank3]:2025-11-27 03:13:32,496 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00([0.0, 0.0, 0.0]), [MB1] 0.67/1.00([0.5862068965517241, 0.5862068965517241, 0.5862068965517241]), [MB2] 0.67/1.00([0.5862068965517241, 0.5862068965517241, 0.5862068965517241]), [MB3] 0.67/1.00([0.5862068965517241, 0.5862068965517241, 0.5862068965517241]), [MB4] 0.67/1.00([0.5862068965517241, 0.5862068965517241, 0.5862068965517241]), [MB5] 0.27/0.40([0.2413793103448276, 0.2413793103448276, 0.2413793103448276]), [MB6] 0.67/1.00([0.5862068965517241, 0.5862068965517241, 0.5862068965517241]), [MB7] 0.67/1.00([0.5862068965517241, 0.5862068965517241, 0.5862068965517241])
[rank2]:2025-11-27 03:13:32,532 - INFO - Avg. fwd time: 15.4696 / Avg. bwd time: 32.5164 / Avg. batch time: 982.3451 (ms) / GPU bubble ratio: 60.92%
[rank2]:2025-11-27 03:13:32,539 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00([0.0, 0.0, 0.0]), [MB1] 0.00/0.00([0.0, 0.0, 0.0]), [MB2] 0.00/0.00([0.0, 0.0, 0.0]), [MB3] 0.00/0.00([0.0, 0.0, 0.0]), [MB4] 0.00/0.00([0.0, 0.0, 0.0]), [MB5] 0.00/0.00([0.0, 0.0, 0.0]), [MB6] 0.00/0.00([0.0, 0.0, 0.0]), [MB7] 0.67/1.00([0.6111111111111112, 0.6111111111111112, 0.6111111111111112])
[rank1]:2025-11-27 03:13:32,583 - INFO - Avg. fwd time: 19.9764 / Avg. bwd time: 40.8447 / Avg. batch time: 1050.9493 (ms) / GPU bubble ratio: 53.70%
[rank1]:2025-11-27 03:13:32,591 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00([0.0, 0.0, 0.0]), [MB1] 0.00/0.00([0.0, 0.0, 0.0]), [MB2] 0.00/0.00([0.0, 0.0, 0.0]), [MB3] 0.00/0.00([0.0, 0.0, 0.0]), [MB4] 0.00/0.00([0.0, 0.0, 0.0]), [MB5] 0.00/0.00([0.0, 0.0, 0.0]), [MB6] 0.00/0.00([0.0, 0.0, 0.0]), [MB7] 0.67/1.00([0.6, 0.6, 0.6])
[rank0]:2025-11-27 03:13:32,625 - INFO - Avg. fwd time: 15.4617 / Avg. bwd time: 30.7759 / Avg. batch time: 1106.5154 (ms) / GPU bubble ratio: 66.57%
[rank0]:2025-11-27 03:13:32,632 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00([0.0, 0.0, 0.0]), [MB1] 0.00/0.00([0.0, 0.0, 0.0]), [MB2] 0.00/0.00([0.0, 0.0, 0.0]), [MB3] 0.00/0.00([0.0, 0.0, 0.0]), [MB4] 0.00/0.00([0.0, 0.0, 0.0]), [MB5] 0.00/0.00([0.0, 0.0, 0.0]), [MB6] 0.15/0.22([0.13513513513513514, 0.13513513513513514, 0.13513513513513514]), [MB7] 0.67/1.00([0.5945945945945946, 0.5945945945945946, 0.5945945945945946])
[rank2]:2025-11-27 03:13:32,646 - INFO -  step: 150  loss: -4.0000  grad_norm:  3.1466  memory:  8.70GiB(18.31%)  tps: 7,286  tflops: 56.96  mfu: 18.26%
[rank3]:2025-11-27 03:13:32,658 - INFO -  step: 150  loss:  0.7112  grad_norm:  3.1466  memory: 25.79GiB(54.28%)  tps: 7,285  tflops: 56.95  mfu: 18.25%
[rank1]:2025-11-27 03:13:32,650 - INFO -  step: 150  loss: -4.0000  grad_norm:  3.1466  memory: 12.90GiB(27.16%)  tps: 7,286  tflops: 56.96  mfu: 18.26%
[rank0]:2025-11-27 03:13:32,662 - INFO -  step: 150  loss: -4.0000  grad_norm:  3.1466  memory: 16.95GiB(35.67%)  tps: 7,286  tflops: 56.96  mfu: 18.26%
[rank0]:2025-11-27 03:16:56,279 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-27 03:16:59,806 - INFO - Avg. fwd time: 27.0543 / Avg. bwd time: 67.5062 / Avg. batch time: 904.1387 (ms) / GPU bubble ratio: 16.33%
[rank3]:2025-11-27 03:16:59,811 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00([0.0, 0.0, 0.0]), [MB1] 1.00/1.00([0.9310344827586207, 0.9310344827586207, 0.9310344827586207]), [MB2] 1.00/1.00([0.9310344827586207, 0.9310344827586207, 0.9310344827586207]), [MB3] 1.00/1.00([0.9310344827586207, 0.9310344827586207, 0.9310344827586207]), [MB4] 1.00/1.00([0.9310344827586207, 0.9310344827586207, 0.9310344827586207]), [MB5] 0.40/0.40([0.3793103448275862, 0.3793103448275862, 0.3793103448275862]), [MB6] 1.00/1.00([0.9310344827586207, 0.9310344827586207, 0.9310344827586207]), [MB7] 1.00/1.00([0.9310344827586207, 0.9310344827586207, 0.9310344827586207])
[rank2]:2025-11-27 03:16:59,948 - INFO - Avg. fwd time: 15.4809 / Avg. bwd time: 32.5164 / Avg. batch time: 960.5047 (ms) / GPU bubble ratio: 60.02%
[rank1]:2025-11-27 03:17:00,018 - INFO - Avg. fwd time: 19.9724 / Avg. bwd time: 40.4253 / Avg. batch time: 1029.3067 (ms) / GPU bubble ratio: 53.06%
[rank0]:2025-11-27 03:17:00,028 - INFO - Avg. fwd time: 15.4940 / Avg. bwd time: 30.1069 / Avg. batch time: 1085.3583 (ms) / GPU bubble ratio: 66.39%
[rank2]:2025-11-27 03:17:00,253 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00([0.0, 0.0, 0.0]), [MB1] 0.00/0.00([0.0, 0.0, 0.0]), [MB2] 0.00/0.00([0.0, 0.0, 0.0]), [MB3] 0.00/0.00([0.0, 0.0, 0.0]), [MB4] 0.00/0.00([0.0, 0.0, 0.0]), [MB5] 0.00/0.00([0.0, 0.0, 0.0]), [MB6] 0.00/0.00([0.0, 0.0, 0.0]), [MB7] 1.00/1.00([0.9444444444444444, 0.9444444444444444, 0.9444444444444444])
[rank1]:2025-11-27 03:17:00,299 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00([0.0, 0.0, 0.0]), [MB1] 0.00/0.00([0.0, 0.0, 0.0]), [MB2] 0.00/0.00([0.0, 0.0, 0.0]), [MB3] 0.00/0.00([0.0, 0.0, 0.0]), [MB4] 0.00/0.00([0.0, 0.0, 0.0]), [MB5] 0.00/0.00([0.0, 0.0, 0.0]), [MB6] 0.00/0.00([0.0, 0.0, 0.0]), [MB7] 1.00/1.00([0.9333333333333333, 0.9333333333333333, 0.9333333333333333])
[rank0]:2025-11-27 03:17:00,334 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00([0.0, 0.0, 0.0]), [MB1] 0.00/0.00([0.0, 0.0, 0.0]), [MB2] 0.00/0.00([0.0, 0.0, 0.0]), [MB3] 0.00/0.00([0.0, 0.0, 0.0]), [MB4] 0.00/0.00([0.0, 0.0, 0.0]), [MB5] 0.00/0.00([0.0, 0.0, 0.0]), [MB6] 0.22/0.22([0.21621621621621623, 0.21621621621621623, 0.21621621621621623]), [MB7] 1.00/1.00([0.9459459459459459, 0.9459459459459459, 0.9459459459459459])
[rank2]:2025-11-27 03:17:00,348 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.1038  memory:  8.70GiB(18.31%)  tps: 7,888  tflops: 61.67  mfu: 19.76%
[rank3]:2025-11-27 03:17:00,339 - INFO -  step: 200  loss:  0.5323  grad_norm:  0.1038  memory: 26.76GiB(56.33%)  tps: 7,889  tflops: 61.67  mfu: 19.77%
[rank1]:2025-11-27 03:17:00,352 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.1038  memory: 12.90GiB(27.16%)  tps: 7,888  tflops: 61.67  mfu: 19.76%
[rank1]:2025-11-27 03:17:00,417 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/freeze_ratio_history/rank1/251127_0317_stage1_step200.svg
[rank0]:2025-11-27 03:17:00,366 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.1038  memory: 16.95GiB(35.67%)  tps: 7,888  tflops: 61.67  mfu: 19.76%
[rank0]:2025-11-27 03:17:00,415 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/freeze_ratio_history/rank0/251127_0317_stage0_step200.svg
[rank2]:2025-11-27 03:17:00,417 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/freeze_ratio_history/rank2/251127_0317_stage2_step200.svg
[rank3]:2025-11-27 03:17:00,518 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/pipeline_schedule/251127_0317_real_step200_rank3.svg
[rank3]:			> Batch Time: 1016.00 ms, GPU Bubble Ratio: 67.68%, 54.57%, 62.63%, 32.25%
[rank3]:	[Rank 0]	[S0,MB0,FORWARD] 0-16-16  | [S0,MB1,FORWARD] 16-16-33  | [S0,MB2,FORWARD] 33-17-50  | [S0,MB3,FORWARD] 50-17-67  | [S0,MB0,FULL_BACKWARD] 209-12-221  | [S0,MB4,FORWARD] 221-15-236  | [S0,MB1,FULL_BACKWARD] 334-12-347  | [S0,MB5,FORWARD] 345-13-358  | [S0,MB2,FULL_BACKWARD] 446-12-458  | [S0,MB6,FORWARD] 456-13-470  | [S0,MB3,FULL_BACKWARD] 567-12-580  | [S0,MB7,FORWARD] 578-14-592  | [S0,MB4,FULL_BACKWARD] 666-40-707  | [S0,MB5,FULL_BACKWARD] 768-40-808  | [S0,MB6,FULL_BACKWARD] 884-39-923  | [S0,MB7,FULL_BACKWARD] 982-33-1016  | 
[rank3]:	[Rank 1]	[S1,MB0,FORWARD] 16-20-36  | [S1,MB1,FORWARD] 42-20-63  | [S1,MB2,FORWARD] 69-20-90  | [S1,MB0,FULL_BACKWARD] 173-24-198  | [S1,MB3,FORWARD] 205-20-226  | [S1,MB1,FULL_BACKWARD] 299-24-324  | [S1,MB4,FORWARD] 331-18-349  | [S1,MB2,FULL_BACKWARD] 410-24-435  | [S1,MB5,FORWARD] 443-18-461  | [S1,MB3,FULL_BACKWARD] 507-46-553  | [S1,MB6,FORWARD] 564-19-583  | [S1,MB4,FULL_BACKWARD] 608-46-655  | [S1,MB7,FORWARD] 663-20-684  | [S1,MB5,FULL_BACKWARD] 714-46-761  | [S1,MB6,FULL_BACKWARD] 832-45-877  | [S1,MB7,FULL_BACKWARD] 933-41-975  | 
[rank3]:	[Rank 2]	[S2,MB0,FORWARD] 36-15-52  | [S2,MB1,FORWARD] 63-15-79  | [S2,MB0,FULL_BACKWARD] 143-20-163  | [S2,MB2,FORWARD] 170-16-186  | [S2,MB1,FULL_BACKWARD] 269-21-290  | [S2,MB3,FORWARD] 296-14-310  | [S2,MB2,FULL_BACKWARD] 364-36-401  | [S2,MB4,FORWARD] 407-15-422  | [S2,MB3,FULL_BACKWARD] 461-35-496  | [S2,MB5,FORWARD] 504-15-519  | [S2,MB4,FULL_BACKWARD] 561-35-597  | [S2,MB6,FORWARD] 604-15-620  | [S2,MB5,FULL_BACKWARD] 668-35-704  | [S2,MB7,FORWARD] 711-15-727  | [S2,MB6,FULL_BACKWARD] 789-35-825  | [S2,MB7,FULL_BACKWARD] 894-33-928  | 
[rank3]:	[Rank 3]	[S3,MB0,FORWARD] 52-24-76  | [S3,MB0,FULL_BACKWARD] 88-44-132  | [S3,MB1,FORWARD] 140-27-167  | [S3,MB1,FULL_BACKWARD] 179-78-258  | [S3,MB2,FORWARD] 266-30-296  | [S3,MB2,FULL_BACKWARD] 308-46-354  | [S3,MB3,FORWARD] 361-29-391  | [S3,MB3,FULL_BACKWARD] 403-48-451  | [S3,MB4,FORWARD] 458-29-487  | [S3,MB4,FULL_BACKWARD] 499-48-548  | [S3,MB5,FORWARD] 558-27-585  | [S3,MB5,FULL_BACKWARD] 597-62-660  | [S3,MB6,FORWARD] 665-27-692  | [S3,MB6,FULL_BACKWARD] 703-73-776  | [S3,MB7,FORWARD] 786-28-815  | [S3,MB7,FULL_BACKWARD] 826-61-887  | 
[rank3]:2025-11-27 03:17:00,562 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/freeze_ratio_history/rank3/251127_0317_stage3_step200.svg
[rank0]:2025-11-27 03:20:15,215 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-27 03:20:18,686 - INFO - Avg. fwd time: 27.3702 / Avg. bwd time: 63.9432 / Avg. batch time: 878.9502 (ms) / GPU bubble ratio: 16.89%
[rank0]:2025-11-27 03:20:18,906 - INFO - Avg. fwd time: 15.5338 / Avg. bwd time: 27.7769 / Avg. batch time: 1060.3990 (ms) / GPU bubble ratio: 67.32%
[rank2]:2025-11-27 03:20:18,827 - INFO - Avg. fwd time: 15.5202 / Avg. bwd time: 32.2635 / Avg. batch time: 935.4381 (ms) / GPU bubble ratio: 59.13%
[rank1]:2025-11-27 03:20:18,895 - INFO - Avg. fwd time: 20.0041 / Avg. bwd time: 39.8475 / Avg. batch time: 1004.3176 (ms) / GPU bubble ratio: 52.32%
[rank3]:2025-11-27 03:20:19,104 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00([0.0, 0.0, 0.0]), [MB1] 1.00/1.00([1.0, 1.0, 1.0]), [MB2] 1.00/1.00([1.0, 1.0, 1.0]), [MB3] 1.00/1.00([1.0, 1.0, 1.0]), [MB4] 1.00/1.00([1.0, 1.0, 1.0]), [MB5] 0.40/0.40([0.41379310344827586, 0.41379310344827586, 0.41379310344827586]), [MB6] 1.00/1.00([1.0, 1.0, 1.0]), [MB7] 1.00/1.00([1.0, 1.0, 1.0])
[rank1]:2025-11-27 03:20:19,168 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00([0.0, 0.0, 0.0]), [MB1] 0.00/0.00([0.0, 0.0, 0.0]), [MB2] 0.00/0.00([0.0, 0.0, 0.0]), [MB3] 0.00/0.00([0.0, 0.0, 0.0]), [MB4] 0.00/0.00([0.0, 0.0, 0.0]), [MB5] 0.00/0.00([0.0, 0.0, 0.0]), [MB6] 0.00/0.00([0.0, 0.0, 0.0]), [MB7] 1.00/1.00([1.0, 1.0, 1.0])
[rank0]:2025-11-27 03:20:19,203 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00([0.0, 0.0, 0.0]), [MB1] 0.00/0.00([0.0, 0.0, 0.0]), [MB2] 0.00/0.00([0.0, 0.0, 0.0]), [MB3] 0.00/0.00([0.0, 0.0, 0.0]), [MB4] 0.00/0.00([0.0, 0.0, 0.0]), [MB5] 0.00/0.00([0.0, 0.0, 0.0]), [MB6] 0.22/0.22([0.21621621621621623, 0.21621621621621623, 0.21621621621621623]), [MB7] 1.00/1.00([1.0, 1.0, 1.0])
[rank2]:2025-11-27 03:20:19,121 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00([0.0, 0.0, 0.0]), [MB1] 0.00/0.00([0.0, 0.0, 0.0]), [MB2] 0.00/0.00([0.0, 0.0, 0.0]), [MB3] 0.00/0.00([0.0, 0.0, 0.0]), [MB4] 0.00/0.00([0.0, 0.0, 0.0]), [MB5] 0.00/0.00([0.0, 0.0, 0.0]), [MB6] 0.00/0.00([0.0, 0.0, 0.0]), [MB7] 1.00/1.00([1.0, 1.0, 1.0])
[rank3]:2025-11-27 03:20:19,205 - INFO -  step: 250  loss:  0.5484  grad_norm:  0.0000  memory: 26.76GiB(56.33%)  tps: 8,239  tflops: 64.41  mfu: 20.64%
[rank1]:2025-11-27 03:20:19,221 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.1264  memory: 12.90GiB(27.16%)  tps: 8,239  tflops: 64.41  mfu: 20.64%
[rank0]:2025-11-27 03:20:19,236 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.1264  memory: 16.95GiB(35.67%)  tps: 8,239  tflops: 64.41  mfu: 20.64%
[rank2]:2025-11-27 03:20:19,217 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.1264  memory:  8.70GiB(18.31%)  tps: 8,239  tflops: 64.41  mfu: 20.64%
[rank0]:2025-11-27 03:23:35,039 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-27 03:23:38,889 - INFO - Avg. fwd time: 27.5548 / Avg. bwd time: 61.7732 / Avg. batch time: 863.5252 (ms) / GPU bubble ratio: 17.24%
[rank3]:2025-11-27 03:23:38,915 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00([0.0, 0.0, 0.0]), [MB1] 1.00/1.00([1.0, 1.0, 1.0]), [MB2] 1.00/1.00([1.0, 1.0, 1.0]), [MB3] 1.00/1.00([1.0, 1.0, 1.0]), [MB4] 1.00/1.00([1.0, 1.0, 1.0]), [MB5] 0.40/0.40([0.41379310344827586, 0.41379310344827586, 0.41379310344827586]), [MB6] 1.00/1.00([1.0, 1.0, 1.0]), [MB7] 1.00/1.00([1.0, 1.0, 1.0])
[rank2]:2025-11-27 03:23:38,931 - INFO - Avg. fwd time: 15.5356 / Avg. bwd time: 32.0909 / Avg. batch time: 919.9783 (ms) / GPU bubble ratio: 58.58%
[rank2]:2025-11-27 03:23:38,938 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00([0.0, 0.0, 0.0]), [MB1] 0.00/0.00([0.0, 0.0, 0.0]), [MB2] 0.00/0.00([0.0, 0.0, 0.0]), [MB3] 0.00/0.00([0.0, 0.0, 0.0]), [MB4] 0.00/0.00([0.0, 0.0, 0.0]), [MB5] 0.00/0.00([0.0, 0.0, 0.0]), [MB6] 0.00/0.00([0.0, 0.0, 0.0]), [MB7] 1.00/1.00([1.0, 1.0, 1.0])
[rank2]:2025-11-27 03:23:39,047 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.1190  memory:  8.70GiB(18.31%)  tps: 8,199  tflops: 64.10  mfu: 20.54%
[rank1]:2025-11-27 03:23:38,984 - INFO - Avg. fwd time: 20.0143 / Avg. bwd time: 39.4381 / Avg. batch time: 988.8705 (ms) / GPU bubble ratio: 51.90%
[rank1]:2025-11-27 03:23:38,993 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00([0.0, 0.0, 0.0]), [MB1] 0.00/0.00([0.0, 0.0, 0.0]), [MB2] 0.00/0.00([0.0, 0.0, 0.0]), [MB3] 0.00/0.00([0.0, 0.0, 0.0]), [MB4] 0.00/0.00([0.0, 0.0, 0.0]), [MB5] 0.00/0.00([0.0, 0.0, 0.0]), [MB6] 0.00/0.00([0.0, 0.0, 0.0]), [MB7] 1.00/1.00([1.0, 1.0, 1.0])
[rank1]:2025-11-27 03:23:39,050 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.1190  memory: 12.90GiB(27.16%)  tps: 8,199  tflops: 64.10  mfu: 20.54%
[rank0]:2025-11-27 03:23:39,025 - INFO - Avg. fwd time: 15.5572 / Avg. bwd time: 26.1885 / Avg. batch time: 1044.9601 (ms) / GPU bubble ratio: 68.04%
[rank0]:2025-11-27 03:23:39,033 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00([0.0, 0.0, 0.0]), [MB1] 0.00/0.00([0.0, 0.0, 0.0]), [MB2] 0.00/0.00([0.0, 0.0, 0.0]), [MB3] 0.00/0.00([0.0, 0.0, 0.0]), [MB4] 0.00/0.00([0.0, 0.0, 0.0]), [MB5] 0.00/0.00([0.0, 0.0, 0.0]), [MB6] 0.22/0.22([0.21621621621621623, 0.21621621621621623, 0.21621621621621623]), [MB7] 1.00/1.00([1.0, 1.0, 1.0])
[rank0]:2025-11-27 03:23:39,063 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.1190  memory: 16.95GiB(35.67%)  tps: 8,199  tflops: 64.10  mfu: 20.54%
[rank3]:2025-11-27 03:23:39,035 - INFO -  step: 300  loss:  0.5492  grad_norm:  0.0000  memory: 26.76GiB(56.33%)  tps: 8,199  tflops: 64.10  mfu: 20.54%
[rank2]:2025-11-27 03:23:39,111 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/freeze_ratio_history/rank2/251127_0323_stage2_step300.svg
[rank1]:2025-11-27 03:23:39,111 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/freeze_ratio_history/rank1/251127_0323_stage1_step300.svg
[rank0]:2025-11-27 03:23:39,110 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/freeze_ratio_history/rank0/251127_0323_stage0_step300.svg
[rank3]:2025-11-27 03:23:39,207 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/pipeline_schedule/251127_0323_real_step300_rank3.svg
[rank3]:			> Batch Time: 969.62 ms, GPU Bubble Ratio: 71.24%, 52.62%, 61.30%, 34.13%
[rank3]:	[Rank 0]	[S0,MB0,FORWARD] 0-16-16  | [S0,MB1,FORWARD] 16-17-33  | [S0,MB2,FORWARD] 33-17-50  | [S0,MB3,FORWARD] 50-17-68  | [S0,MB0,FULL_BACKWARD] 204-0-204  | [S0,MB4,FORWARD] 204-15-220  | [S0,MB1,FULL_BACKWARD] 328-0-328  | [S0,MB5,FORWARD] 328-13-342  | [S0,MB2,FULL_BACKWARD] 440-0-440  | [S0,MB6,FORWARD] 440-13-453  | [S0,MB3,FULL_BACKWARD] 559-0-559  | [S0,MB7,FORWARD] 559-13-573  | [S0,MB4,FULL_BACKWARD] 655-41-696  | [S0,MB5,FULL_BACKWARD] 744-40-784  | [S0,MB6,FULL_BACKWARD] 851-39-890  | [S0,MB7,FULL_BACKWARD] 936-33-969  | 
[rank3]:	[Rank 1]	[S1,MB0,FORWARD] 16-20-36  | [S1,MB1,FORWARD] 42-20-63  | [S1,MB2,FORWARD] 69-20-90  | [S1,MB0,FULL_BACKWARD] 170-23-193  | [S1,MB3,FORWARD] 201-20-221  | [S1,MB1,FULL_BACKWARD] 294-23-318  | [S1,MB4,FORWARD] 325-18-344  | [S1,MB2,FULL_BACKWARD] 406-23-429  | [S1,MB5,FORWARD] 436-18-455  | [S1,MB3,FULL_BACKWARD] 499-46-546  | [S1,MB6,FORWARD] 556-19-576  | [S1,MB4,FULL_BACKWARD] 596-46-643  | [S1,MB7,FORWARD] 651-21-672  | [S1,MB5,FULL_BACKWARD] 687-47-735  | [S1,MB6,FULL_BACKWARD] 797-45-843  | [S1,MB7,FULL_BACKWARD] 886-42-928  | 
[rank3]:	[Rank 2]	[S2,MB0,FORWARD] 36-16-52  | [S2,MB1,FORWARD] 63-15-79  | [S2,MB0,FULL_BACKWARD] 141-18-160  | [S2,MB2,FORWARD] 167-16-183  | [S2,MB1,FULL_BACKWARD] 266-18-284  | [S2,MB3,FORWARD] 292-14-306  | [S2,MB2,FULL_BACKWARD] 359-36-396  | [S2,MB4,FORWARD] 403-14-418  | [S2,MB3,FULL_BACKWARD] 453-36-489  | [S2,MB5,FORWARD] 496-15-512  | [S2,MB4,FULL_BACKWARD] 549-36-585  | [S2,MB6,FORWARD] 593-15-608  | [S2,MB5,FULL_BACKWARD] 641-36-677  | [S2,MB7,FORWARD] 684-15-700  | [S2,MB6,FULL_BACKWARD] 755-35-791  | [S2,MB7,FULL_BACKWARD] 846-32-879  | 
[rank3]:	[Rank 3]	[S3,MB0,FORWARD] 52-24-76  | [S3,MB0,FULL_BACKWARD] 88-43-131  | [S3,MB1,FORWARD] 138-28-166  | [S3,MB1,FULL_BACKWARD] 178-77-256  | [S3,MB2,FORWARD] 263-30-293  | [S3,MB2,FULL_BACKWARD] 304-44-349  | [S3,MB3,FORWARD] 356-29-386  | [S3,MB3,FULL_BACKWARD] 398-44-443  | [S3,MB4,FORWARD] 450-29-479  | [S3,MB4,FULL_BACKWARD] 491-44-536  | [S3,MB5,FORWARD] 546-28-575  | [S3,MB5,FULL_BACKWARD] 586-44-631  | [S3,MB6,FORWARD] 638-26-665  | [S3,MB6,FULL_BACKWARD] 677-68-746  | [S3,MB7,FORWARD] 752-30-782  | [S3,MB7,FULL_BACKWARD] 794-44-839  | 
[rank3]:2025-11-27 03:23:39,252 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/freeze_ratio_history/rank3/251127_0323_stage3_step300.svg
[rank0]:2025-11-27 03:26:54,522 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-27 03:26:57,990 - INFO - Avg. fwd time: 27.6894 / Avg. bwd time: 60.3894 / Avg. batch time: 853.8173 (ms) / GPU bubble ratio: 17.47%
[rank2]:2025-11-27 03:26:58,131 - INFO - Avg. fwd time: 15.5497 / Avg. bwd time: 31.9920 / Avg. batch time: 910.3086 (ms) / GPU bubble ratio: 58.22%
[rank1]:2025-11-27 03:26:58,202 - INFO - Avg. fwd time: 20.0273 / Avg. bwd time: 39.2045 / Avg. batch time: 979.2231 (ms) / GPU bubble ratio: 51.61%
[rank0]:2025-11-27 03:26:58,211 - INFO - Avg. fwd time: 15.5743 / Avg. bwd time: 25.2434 / Avg. batch time: 1035.3192 (ms) / GPU bubble ratio: 68.46%
[rank3]:2025-11-27 03:26:58,495 - INFO -  step: 350  loss:  0.5350  grad_norm:  0.0000  memory: 26.76GiB(56.33%)  tps: 8,214  tflops: 64.22  mfu: 20.58%
[rank1]:2025-11-27 03:26:58,510 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.0939  memory: 12.90GiB(27.16%)  tps: 8,214  tflops: 64.21  mfu: 20.58%
[rank0]:2025-11-27 03:26:58,525 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.0939  memory: 16.95GiB(35.67%)  tps: 8,214  tflops: 64.21  mfu: 20.58%
[rank2]:2025-11-27 03:26:58,506 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.0939  memory:  8.70GiB(18.31%)  tps: 8,214  tflops: 64.21  mfu: 20.58%
[rank0]:2025-11-27 03:30:14,170 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-27 03:30:17,688 - INFO - Avg. fwd time: 27.8117 / Avg. bwd time: 59.1459 / Avg. batch time: 845.0731 (ms) / GPU bubble ratio: 17.68%
[rank2]:2025-11-27 03:30:17,835 - INFO - Avg. fwd time: 15.5657 / Avg. bwd time: 31.9068 / Avg. batch time: 901.5666 (ms) / GPU bubble ratio: 57.88%
[rank0]:2025-11-27 03:30:17,916 - INFO - Avg. fwd time: 15.5866 / Avg. bwd time: 24.3958 / Avg. batch time: 1026.6306 (ms) / GPU bubble ratio: 68.84%
[rank1]:2025-11-27 03:30:17,906 - INFO - Avg. fwd time: 20.0413 / Avg. bwd time: 39.0177 / Avg. batch time: 970.5228 (ms) / GPU bubble ratio: 51.32%
[rank3]:2025-11-27 03:30:18,217 - INFO -  step: 400  loss:  0.5370  grad_norm:  0.0000  memory: 26.76GiB(56.33%)  tps: 8,203  tflops: 64.13  mfu: 20.55%
[rank0]:2025-11-27 03:30:18,248 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.1074  memory: 16.95GiB(35.67%)  tps: 8,203  tflops: 64.13  mfu: 20.55%
[rank2]:2025-11-27 03:30:18,229 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.1074  memory:  8.70GiB(18.31%)  tps: 8,203  tflops: 64.13  mfu: 20.55%
[rank1]:2025-11-27 03:30:18,233 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.1074  memory: 12.90GiB(27.16%)  tps: 8,203  tflops: 64.13  mfu: 20.55%
[rank0]:2025-11-27 03:30:18,299 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/freeze_ratio_history/rank0/251127_0330_stage0_step400.svg
[rank2]:2025-11-27 03:30:18,301 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/freeze_ratio_history/rank2/251127_0330_stage2_step400.svg
[rank1]:2025-11-27 03:30:18,301 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/freeze_ratio_history/rank1/251127_0330_stage1_step400.svg
[rank3]:2025-11-27 03:30:18,391 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/pipeline_schedule/251127_0330_real_step400_rank3.svg
[rank3]:			> Batch Time: 975.66 ms, GPU Bubble Ratio: 71.82%, 52.65%, 61.43%, 33.85%
[rank3]:	[Rank 0]	[S0,MB0,FORWARD] 0-16-16  | [S0,MB1,FORWARD] 16-17-33  | [S0,MB2,FORWARD] 33-17-50  | [S0,MB3,FORWARD] 50-16-67  | [S0,MB0,FULL_BACKWARD] 204-0-204  | [S0,MB4,FORWARD] 204-15-220  | [S0,MB1,FULL_BACKWARD] 330-0-330  | [S0,MB5,FORWARD] 330-13-344  | [S0,MB2,FULL_BACKWARD] 442-0-442  | [S0,MB6,FORWARD] 442-13-456  | [S0,MB3,FULL_BACKWARD] 562-0-562  | [S0,MB7,FORWARD] 562-13-576  | [S0,MB4,FULL_BACKWARD] 659-41-700  | [S0,MB5,FULL_BACKWARD] 748-40-788  | [S0,MB6,FULL_BACKWARD] 857-35-893  | [S0,MB7,FULL_BACKWARD] 942-33-975  | 
[rank3]:	[Rank 1]	[S1,MB0,FORWARD] 16-20-36  | [S1,MB1,FORWARD] 42-20-63  | [S1,MB2,FORWARD] 69-20-90  | [S1,MB0,FULL_BACKWARD] 170-23-194  | [S1,MB3,FORWARD] 201-20-222  | [S1,MB1,FULL_BACKWARD] 296-23-319  | [S1,MB4,FORWARD] 327-18-345  | [S1,MB2,FULL_BACKWARD] 408-23-431  | [S1,MB5,FORWARD] 438-18-457  | [S1,MB3,FULL_BACKWARD] 502-47-549  | [S1,MB6,FORWARD] 559-19-578  | [S1,MB4,FULL_BACKWARD] 599-47-646  | [S1,MB7,FORWARD] 655-21-676  | [S1,MB5,FULL_BACKWARD] 691-48-740  | [S1,MB6,FULL_BACKWARD] 804-46-850  | [S1,MB7,FULL_BACKWARD] 893-42-935  | 
[rank3]:	[Rank 2]	[S2,MB0,FORWARD] 36-16-52  | [S2,MB1,FORWARD] 63-16-79  | [S2,MB0,FULL_BACKWARD] 141-18-160  | [S2,MB2,FORWARD] 167-16-183  | [S2,MB1,FULL_BACKWARD] 267-18-286  | [S2,MB3,FORWARD] 293-14-307  | [S2,MB2,FULL_BACKWARD] 361-36-398  | [S2,MB4,FORWARD] 405-15-420  | [S2,MB3,FULL_BACKWARD] 455-36-491  | [S2,MB5,FORWARD] 499-15-514  | [S2,MB4,FULL_BACKWARD] 552-36-588  | [S2,MB6,FORWARD] 596-15-612  | [S2,MB5,FULL_BACKWARD] 645-36-681  | [S2,MB7,FORWARD] 688-15-704  | [S2,MB6,FULL_BACKWARD] 761-36-797  | [S2,MB7,FULL_BACKWARD] 853-32-886  | 
[rank3]:	[Rank 3]	[S3,MB0,FORWARD] 52-24-76  | [S3,MB0,FULL_BACKWARD] 88-43-131  | [S3,MB1,FORWARD] 138-28-167  | [S3,MB1,FULL_BACKWARD] 178-78-257  | [S3,MB2,FORWARD] 264-30-294  | [S3,MB2,FULL_BACKWARD] 306-44-351  | [S3,MB3,FORWARD] 358-30-388  | [S3,MB3,FULL_BACKWARD] 400-44-445  | [S3,MB4,FORWARD] 452-29-482  | [S3,MB4,FULL_BACKWARD] 494-44-538  | [S3,MB5,FORWARD] 549-28-578  | [S3,MB5,FULL_BACKWARD] 589-44-634  | [S3,MB6,FORWARD] 641-26-668  | [S3,MB6,FULL_BACKWARD] 681-70-751  | [S3,MB7,FORWARD] 758-30-789  | [S3,MB7,FULL_BACKWARD] 801-45-846  | 
[rank3]:2025-11-27 03:30:18,439 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/freeze_ratio_history/rank3/251127_0330_stage3_step400.svg
[rank3]:2025-11-27 03:30:40,848 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-11-27 03:30:41,321 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-11-27 03:30:41,274 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-11-27 03:30:41,357 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-11-27 03:33:33,389 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-27 03:33:37,170 - INFO - Avg. fwd time: 27.9100 / Avg. bwd time: 58.1651 / Avg. batch time: 838.2536 (ms) / GPU bubble ratio: 17.85%
[rank2]:2025-11-27 03:33:37,212 - INFO - Avg. fwd time: 15.5785 / Avg. bwd time: 31.8424 / Avg. batch time: 894.8078 (ms) / GPU bubble ratio: 57.60%
[rank1]:2025-11-27 03:33:37,263 - INFO - Avg. fwd time: 20.0520 / Avg. bwd time: 38.8799 / Avg. batch time: 963.7994 (ms) / GPU bubble ratio: 51.08%
[rank0]:2025-11-27 03:33:37,305 - INFO - Avg. fwd time: 15.5981 / Avg. bwd time: 23.7449 / Avg. batch time: 1019.9199 (ms) / GPU bubble ratio: 69.14%
[rank2]:2025-11-27 03:33:37,327 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.1085  memory:  8.70GiB(18.31%)  tps: 8,229  tflops: 64.33  mfu: 20.62%
[rank1]:2025-11-27 03:33:37,331 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.1085  memory: 12.90GiB(27.16%)  tps: 8,229  tflops: 64.33  mfu: 20.62%
[rank3]:2025-11-27 03:33:37,315 - INFO -  step: 450  loss:  0.5410  grad_norm:  0.0000  memory: 26.76GiB(56.33%)  tps: 8,229  tflops: 64.33  mfu: 20.62%
[rank0]:2025-11-27 03:33:37,343 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.1085  memory: 16.95GiB(35.67%)  tps: 8,229  tflops: 64.33  mfu: 20.62%
[rank0]:2025-11-27 03:36:54,121 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-27 03:36:57,602 - INFO - Avg. fwd time: 27.9807 / Avg. bwd time: 57.5893 / Avg. batch time: 834.3471 (ms) / GPU bubble ratio: 17.95%
[rank2]:2025-11-27 03:36:57,742 - INFO - Avg. fwd time: 15.5889 / Avg. bwd time: 31.7986 / Avg. batch time: 890.8724 (ms) / GPU bubble ratio: 57.45%
[rank1]:2025-11-27 03:36:57,814 - INFO - Avg. fwd time: 20.0610 / Avg. bwd time: 38.7840 / Avg. batch time: 959.8870 (ms) / GPU bubble ratio: 50.96%
[rank0]:2025-11-27 03:36:57,823 - INFO - Avg. fwd time: 15.6046 / Avg. bwd time: 23.2909 / Avg. batch time: 1016.0130 (ms) / GPU bubble ratio: 69.37%
[rank3]:2025-11-27 03:36:58,120 - INFO -  step: 500  loss:  0.5282  grad_norm:  0.0000  memory: 26.76GiB(56.33%)  tps: 8,159  tflops: 63.79  mfu: 20.44%
[rank0]:2025-11-27 03:36:58,149 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.1179  memory: 16.95GiB(35.67%)  tps: 8,159  tflops: 63.78  mfu: 20.44%
[rank0]:2025-11-27 03:36:58,197 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/freeze_ratio_history/rank0/251127_0336_stage0_step500.svg
[rank2]:2025-11-27 03:36:58,132 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.1179  memory:  8.70GiB(18.31%)  tps: 8,159  tflops: 63.78  mfu: 20.44%
[rank2]:2025-11-27 03:36:58,199 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/freeze_ratio_history/rank2/251127_0336_stage2_step500.svg
[rank1]:2025-11-27 03:36:58,136 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.1179  memory: 12.90GiB(27.16%)  tps: 8,159  tflops: 63.78  mfu: 20.44%
[rank1]:2025-11-27 03:36:58,198 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/freeze_ratio_history/rank1/251127_0336_stage1_step500.svg
[rank3]:2025-11-27 03:36:58,297 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/pipeline_schedule/251127_0336_real_step500_rank3.svg
[rank3]:			> Batch Time: 980.62 ms, GPU Bubble Ratio: 71.95%, 52.72%, 61.61%, 33.79%
[rank3]:	[Rank 0]	[S0,MB0,FORWARD] 0-16-16  | [S0,MB1,FORWARD] 16-17-33  | [S0,MB2,FORWARD] 33-17-50  | [S0,MB3,FORWARD] 50-17-67  | [S0,MB0,FULL_BACKWARD] 205-0-205  | [S0,MB4,FORWARD] 205-15-220  | [S0,MB1,FULL_BACKWARD] 331-0-331  | [S0,MB5,FORWARD] 331-13-344  | [S0,MB2,FULL_BACKWARD] 442-0-442  | [S0,MB6,FORWARD] 442-13-456  | [S0,MB3,FULL_BACKWARD] 563-0-563  | [S0,MB7,FORWARD] 563-13-576  | [S0,MB4,FULL_BACKWARD] 659-41-700  | [S0,MB5,FULL_BACKWARD] 750-40-790  | [S0,MB6,FULL_BACKWARD] 863-35-898  | [S0,MB7,FULL_BACKWARD] 947-33-980  | 
[rank3]:	[Rank 1]	[S1,MB0,FORWARD] 16-20-36  | [S1,MB1,FORWARD] 42-20-63  | [S1,MB2,FORWARD] 69-20-90  | [S1,MB0,FULL_BACKWARD] 170-23-194  | [S1,MB3,FORWARD] 201-20-222  | [S1,MB1,FULL_BACKWARD] 296-23-319  | [S1,MB4,FORWARD] 327-18-346  | [S1,MB2,FULL_BACKWARD] 408-23-432  | [S1,MB5,FORWARD] 439-18-457  | [S1,MB3,FULL_BACKWARD] 502-47-549  | [S1,MB6,FORWARD] 559-19-579  | [S1,MB4,FULL_BACKWARD] 600-47-647  | [S1,MB7,FORWARD] 656-21-677  | [S1,MB5,FULL_BACKWARD] 693-49-743  | [S1,MB6,FULL_BACKWARD] 809-45-855  | [S1,MB7,FULL_BACKWARD] 897-42-940  | 
[rank3]:	[Rank 2]	[S2,MB0,FORWARD] 36-16-52  | [S2,MB1,FORWARD] 63-15-79  | [S2,MB0,FULL_BACKWARD] 141-18-160  | [S2,MB2,FORWARD] 167-16-183  | [S2,MB1,FULL_BACKWARD] 267-18-286  | [S2,MB3,FORWARD] 293-14-307  | [S2,MB2,FULL_BACKWARD] 362-36-398  | [S2,MB4,FORWARD] 405-15-420  | [S2,MB3,FULL_BACKWARD] 456-36-492  | [S2,MB5,FORWARD] 499-15-515  | [S2,MB4,FULL_BACKWARD] 553-36-589  | [S2,MB6,FORWARD] 596-15-612  | [S2,MB5,FULL_BACKWARD] 646-36-682  | [S2,MB7,FORWARD] 690-15-706  | [S2,MB6,FULL_BACKWARD] 767-36-803  | [S2,MB7,FULL_BACKWARD] 858-32-891  | 
[rank3]:	[Rank 3]	[S3,MB0,FORWARD] 52-24-76  | [S3,MB0,FULL_BACKWARD] 88-42-131  | [S3,MB1,FORWARD] 138-28-166  | [S3,MB1,FULL_BACKWARD] 178-78-257  | [S3,MB2,FORWARD] 264-30-294  | [S3,MB2,FULL_BACKWARD] 306-45-351  | [S3,MB3,FORWARD] 358-29-388  | [S3,MB3,FULL_BACKWARD] 400-44-445  | [S3,MB4,FORWARD] 453-30-483  | [S3,MB4,FULL_BACKWARD] 495-44-540  | [S3,MB5,FORWARD] 550-28-579  | [S3,MB5,FULL_BACKWARD] 591-44-635  | [S3,MB6,FORWARD] 643-26-670  | [S3,MB6,FULL_BACKWARD] 682-74-756  | [S3,MB7,FORWARD] 763-31-794  | [S3,MB7,FULL_BACKWARD] 806-44-851  | 
[rank3]:2025-11-27 03:36:58,342 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/freeze_ratio_history/rank3/251127_0336_stage3_step500.svg
[rank0]:2025-11-27 03:40:14,529 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-27 03:40:18,028 - INFO - Avg. fwd time: 28.0369 / Avg. bwd time: 57.0217 / Avg. batch time: 830.3593 (ms) / GPU bubble ratio: 18.05%
[rank2]:2025-11-27 03:40:18,168 - INFO - Avg. fwd time: 15.5966 / Avg. bwd time: 31.7535 / Avg. batch time: 886.8918 (ms) / GPU bubble ratio: 57.29%
[rank0]:2025-11-27 03:40:18,247 - INFO - Avg. fwd time: 15.6106 / Avg. bwd time: 22.8681 / Avg. batch time: 1012.0430 (ms) / GPU bubble ratio: 69.58%
[rank1]:2025-11-27 03:40:18,236 - INFO - Avg. fwd time: 20.0651 / Avg. bwd time: 38.6865 / Avg. batch time: 955.9160 (ms) / GPU bubble ratio: 50.83%
[rank0]:2025-11-27 03:40:18,574 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.1068  memory: 16.95GiB(35.67%)  tps: 8,175  tflops: 63.91  mfu: 20.48%
[rank1]:2025-11-27 03:40:18,559 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.1068  memory: 12.90GiB(27.16%)  tps: 8,175  tflops: 63.91  mfu: 20.48%
[rank2]:2025-11-27 03:40:18,556 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.1068  memory:  8.70GiB(18.31%)  tps: 8,175  tflops: 63.91  mfu: 20.48%
[rank3]:2025-11-27 03:40:18,544 - INFO -  step: 550  loss:  0.5307  grad_norm:  0.0000  memory: 26.76GiB(56.33%)  tps: 8,175  tflops: 63.91  mfu: 20.48%
