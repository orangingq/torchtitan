
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 12. 25. (ëª©) 08:50:29 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 1,2,3,4
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/1224_ZBVZeroBubble_timelyapf_42.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug

âœ”ï¸Running with timelyapf x ZBVZeroBubble ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1224.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=timelyapf --freezing.threshold=0.01 --freezing.percentile=80 --freezing.max_freeze_ratio=0.8
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank2]:2025-12-25 08:50:36,373 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank2]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank2]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank2]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank2]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank2]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank2]:"
[rank3]:2025-12-25 08:50:36,492 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:"
[rank0]:2025-12-25 08:50:36,483 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank0]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank0]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank0]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank0]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank0]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank0]:"
[rank1]:2025-12-25 08:50:36,620 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank1]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank1]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank1]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank1]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank1]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank1]:"
[rank2]:2025-12-25 08:50:36,578 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-12-25 08:50:36,580 - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-12-25 08:50:36,823 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-12-25 08:50:36,825 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-25 08:50:36,810 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-12-25 08:50:36,813 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-25 08:50:36,822 - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-12-25 08:50:36,824 - Loading tokenizer from tokenizer.json
[rank1]:2025-12-25 08:50:36,938 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-12-25 08:50:36,941 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-25 08:50:37,218 - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank3]:2025-12-25 08:50:40,248 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-12-25 08:50:40,256 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-12-25 08:50:40,288 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-25 08:50:40,314 - PP rank 3 is building stage_idx 3 with modules ['layers.7', 'layers.8']
[rank3]:2025-12-25 08:50:40,326 - PP rank 3 is building stage_idx 4 with modules ['layers.9', 'layers.10']
[rank3]:2025-12-25 08:50:40,328 - Using pipeline schedule ZBVZeroBubble with 8 microbatches and 8 stages.
[rank2]:2025-12-25 08:50:40,329 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-12-25 08:50:40,368 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-25 08:50:40,281 - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank1]:2025-12-25 08:50:40,295 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-25 08:50:40,323 - PP rank 1 is building stage_idx 1 with modules ['layers.2', 'layers.3', 'layers.4']
[rank1]:2025-12-25 08:50:40,336 - PP rank 1 is building stage_idx 6 with modules ['layers.13', 'layers.14']
[rank1]:2025-12-25 08:50:40,338 - Using pipeline schedule ZBVZeroBubble with 8 microbatches and 8 stages.
[rank2]:2025-12-25 08:50:40,396 - PP rank 2 is building stage_idx 2 with modules ['layers.5', 'layers.6']
[rank2]:2025-12-25 08:50:40,409 - PP rank 2 is building stage_idx 5 with modules ['layers.11', 'layers.12']
[rank2]:2025-12-25 08:50:40,411 - Using pipeline schedule ZBVZeroBubble with 8 microbatches and 8 stages.
[rank3]:2025-12-25 08:50:40,512 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-25 08:50:40,512 - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-12-25 08:50:40,513 - CUDA memory usage for model: 0.92GiB(1.94%)
[rank1]:2025-12-25 08:50:40,549 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-25 08:50:40,549 - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-12-25 08:50:40,550 - CUDA memory usage for model: 1.13GiB(2.39%)
[rank2]:2025-12-25 08:50:40,600 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-25 08:50:40,600 - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-12-25 08:50:40,601 - CUDA memory usage for model: 0.92GiB(1.94%)
[rank0]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank0]:wandb: setting up run anw579tm
[rank0]:wandb: Tracking run with wandb version 0.22.2
[rank0]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1224_ZBVZeroBubble_timelyapf_42_dm1/20251225-0850/wandb/run-20251225_085041-anw579tm
[rank0]:wandb: Run `wandb offline` to turn off syncing.
[rank0]:wandb: Syncing run 1224_ZBVZeroBubble_timelyapf_42_dm1
[rank0]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank0]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/anw579tm
[rank0]:2025-12-25 08:50:42,589 - WandB logging enabled
[rank0]:2025-12-25 08:50:42,590 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-12-25 08:50:42,627 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-25 08:50:42,629 - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-12-25 08:50:42,656 - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1']
[rank0]:2025-12-25 08:50:42,670 - PP rank 0 is building stage_idx 7 with modules ['layers.15', 'norm', 'output']
[rank0]:2025-12-25 08:50:42,672 - Using pipeline schedule ZBVZeroBubble with 8 microbatches and 8 stages.
[rank3]:2025-12-25 08:50:42,938 - Mixed precision training with TP or PP is handled by autocast
[rank2]:2025-12-25 08:50:42,939 - Mixed precision training with TP or PP is handled by autocast
[rank1]:2025-12-25 08:50:42,939 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-25 08:50:42,921 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-25 08:50:42,921 - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-12-25 08:50:42,922 - CUDA memory usage for model: 2.64GiB(5.55%)
[rank0]:2025-12-25 08:50:42,938 - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1224_ZBVZeroBubble_timelyapf_42_dm1
[rank0]:2025-12-25 08:50:42,938 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-25 08:50:42,939 - Trainer is initialized with local batch size 32, global batch size 128, gradient accumulation steps 4, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2025-12-25 08:50:42,939 - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank0]:2025-12-25 08:50:46,294 - [GC] GC collection for checkpoint loading. 0.03 seconds
[rank0]:2025-12-25 08:50:46,294 - Finished loading the checkpoint in 3.35 seconds.
[rank0]:2025-12-25 08:50:46,295 - Training starts at step 1
[rank1]:2025-12-25 08:50:51,382 -  step:  1  loss: -4.0000  grad_norm: 203.0664  memory: 15.54GiB(32.72%)  tps: 2,956  tflops: 23.11  mfu: 7.41%
[rank1]:2025-12-25 08:50:51,382 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-12-25 08:50:51,376 -  step:  1  loss: -4.0000  grad_norm: 203.0664  memory: 11.98GiB(25.23%)  tps: 2,977  tflops: 23.27  mfu: 7.46%
[rank2]:2025-12-25 08:50:51,376 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-12-25 08:50:51,373 -  step:  1  loss: -4.0000  grad_norm: 203.0664  memory: 13.43GiB(28.27%)  tps: 2,956  tflops: 23.11  mfu: 7.41%
[rank3]:2025-12-25 08:50:51,373 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-25 08:50:51,424 -  step:  1  loss: 10.6092  grad_norm: 203.0664  memory: 30.01GiB(63.17%)  tps: 3,726  tflops: 29.13  mfu: 9.34%
[rank0]:2025-12-25 08:50:51,424 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-25 08:54:32,781 - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-12-25 08:54:37,565 - Avg. fwd time: 8.1618 / Avg. bwd-weight time: 10.0166 / Avg. bwd-input time: 10.0174 / Avg. batch time: 1054.7651 (ms) / GPU bubble ratio: 57.23%
[rank1]:2025-12-25 08:54:37,583 - Avg. fwd time: 9.8424 / Avg. bwd-weight time: 12.9110 / Avg. bwd-input time: 12.1699 / Avg. batch time: 1090.0890 (ms) / GPU bubble ratio: 48.74%
[rank3]:2025-12-25 08:54:37,572 - Avg. fwd time: 7.7949 / Avg. bwd-weight time: 9.8461 / Avg. bwd-input time: 9.6307 / Avg. batch time: 1051.5950 (ms) / GPU bubble ratio: 58.51%
[rank0]:2025-12-25 08:54:37,591 - Avg. fwd time: 13.6223 / Avg. full-bwd time: 28.9514 (Avg. bwd-weight time: 29.9995 / Avg. bwd-input time: 34.4539) / Avg. batch time: 1112.4700 (ms) / GPU bubble ratio: 13.24%
[rank0]:2025-12-25 08:54:37,663 -  step: 50  loss:  9.8808  grad_norm: 24.2147  memory: 35.32GiB(74.36%)  tps: 7,097  tflops: 55.48  mfu: 17.78%
[rank2]:2025-12-25 08:54:37,636 -  step: 50  loss: -4.0000  grad_norm: 24.2147  memory: 13.80GiB(29.05%)  tps: 7,096  tflops: 55.48  mfu: 17.78%
[rank1]:2025-12-25 08:54:37,640 -  step: 50  loss: -4.0000  grad_norm: 24.2147  memory: 17.83GiB(37.53%)  tps: 7,096  tflops: 55.48  mfu: 17.78%
[rank3]:2025-12-25 08:54:37,636 -  step: 50  loss: -4.0000  grad_norm: 24.2147  memory: 15.27GiB(32.13%)  tps: 7,096  tflops: 55.48  mfu: 17.78%
[rank3]:2025-12-25 08:55:19,419 - [Step 60] ã€°ï¸ Monitoring Upperbound
[rank0]:2025-12-25 08:56:05,633 - [Step 70] â³ Monitoring Upperbound... (276/286)
[rank2]:2025-12-25 08:56:05,825 - [Step 70] â³ Monitoring Upperbound... (276/286)
[rank1]:2025-12-25 08:56:05,846 - [Step 70] â³ Monitoring Upperbound... (276/286)
[rank3]:2025-12-25 08:56:05,834 - [Step 70] â³ Monitoring Upperbound... (276/286)
[rank3]:2025-12-25 08:56:52,443 - [Step 80] âœ”ï¸  Setting Upperbound
[rank3]:2025-12-25 08:56:52,558 - [Step 80] ã€°ï¸ Monitoring Lowerbound
[rank3]:2025-12-25 08:57:56,215 - [Step 100] âœ”ï¸  Setting Lowerbound
[rank0]:2025-12-25 08:57:56,272 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-25 08:57:56,309 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB0] 1.00/1.00, [MB4] 1.00/1.00, [MB1] 1.00/1.00, [MB5] 1.00/1.00, [MB2] 1.00/1.00, [MB6] 1.00/1.00, [MB3] 1.00/1.00, [MB7] 0.40/0.40, [MB4] 0.75/0.75, [MB5] 0.32/0.32, [MB6] 0.39/0.39, [MB7] 0.93/0.93
[rank1]:2025-12-25 08:57:56,308 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB0] 1.00/1.00, [MB3] 0.00/0.00, [MB1] 0.51/0.51, [MB4] 0.00/0.00, [MB2] 0.17/0.17, [MB5] 0.00/0.00, [MB3] 0.20/0.20, [MB6] 0.00/0.00, [MB4] 0.66/0.66, [MB5] 0.87/0.87, [MB6] 1.00/1.00, [MB7] 0.82/0.82, [MB7] 1.00/1.00
[rank2]:2025-12-25 08:57:56,320 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB0] 0.00/0.00, [MB2] 0.00/0.00, [MB1] 0.00/0.00, [MB3] 0.00/0.00, [MB2] 0.00/0.00, [MB4] 0.00/0.00, [MB3] 0.00/0.00, [MB5] 0.00/0.00, [MB4] 0.34/0.34, [MB5] 1.00/1.00, [MB6] 0.00/0.00, [MB7] 0.25/0.25, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-12-25 08:57:56,631 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/pipeline_schedule/251225_0857_max_batch_time.svg
[rank3]:			> Batch Time: 990.45 ms, GPU Bubble Ratio: 1.35%, 43.29%, 54.21%, 55.71%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-9-34ms      | [S0,MB4,F]  34-8-42ms      | [S0,MB5,F]  42-9-52ms      | [S0,MB6,F]  52-9-61ms      | [S7,MB0,F]  75-17-92ms     | [S7,MB0,BI] 92-32-125ms    | [S7,MB0,BW] 125-25-151ms   | [S7,MB1,F]  151-16-168ms   | [S7,MB1,BI] 168-34-203ms   | [S7,MB1,BW] 203-30-234ms   | [S7,MB2,F]  234-19-253ms   | [S7,MB2,BI] 253-35-288ms   | [S7,MB2,BW] 288-31-319ms   | [S7,MB3,F]  319-19-339ms   | [S7,MB3,BI] 339-35-374ms   | [S7,MB3,BW] 374-31-406ms   | [S0,MB7,F]  406-10-416ms   | [S0,MB0,B]  416-30-446ms   | [S7,MB4,F]  446-18-465ms   | [S7,MB4,BI] 465-34-500ms   | [S7,MB4,BW] 500-31-532ms   | [S0,MB1,B]  532-30-562ms   | [S7,MB5,F]  562-18-581ms   | [S7,MB5,BI] 581-34-616ms   | [S7,MB5,BW] 616-31-647ms   | [S0,MB2,B]  647-30-677ms   | [S7,MB6,F]  677-18-696ms   | [S7,MB6,BI] 696-34-730ms   | [S7,MB6,BW] 730-31-761ms   | [S0,MB3,B]  761-29-791ms   | [S7,MB7,F]  791-18-810ms   | [S7,MB7,BI] 810-34-845ms   | [S7,MB7,BW] 845-30-875ms   | [S0,MB4,B]  875-29-905ms   | [S0,MB5,B]  905-29-934ms   | [S0,MB6,B]  934-28-962ms   | [S0,MB7,B]  962-28-990ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-21ms      | [S1,MB1,F]  21-10-32ms     | [S1,MB2,F]  32-10-43ms     | [S1,MB3,F]  43-10-53ms     | [S1,MB4,F]  53-10-64ms     | [S6,MB0,F]  64-10-75ms     | [S1,MB5,F]  75-13-88ms     | [S6,MB1,F]  88-8-97ms      | [S6,MB0,BI] 125-9-134ms    | [S6,MB0,BW] 134-10-144ms   | [S6,MB2,F]  144-7-152ms    | [S6,MB1,BI] 203-9-212ms    | [S6,MB1,BW] 212-10-222ms   | [S6,MB3,F]  222-7-230ms    | [S6,MB2,BI] 288-9-297ms    | [S6,MB2,BW] 297-10-308ms   | [S1,MB6,F]  308-10-319ms   | [S1,MB0,BI] 319-15-335ms   | [S1,MB0,BW] 335-15-350ms   | [S6,MB4,F]  350-7-358ms    | [S6,MB3,BI] 374-10-384ms   | [S6,MB3,BW] 384-9-394ms    | [S1,MB7,F]  416-13-430ms   | [S1,MB1,BI] 430-15-445ms   | [S1,MB1,BW] 445-14-460ms   | [S6,MB5,F]  460-7-468ms    | [S6,MB4,BI] 500-10-511ms   | [S6,MB4,BW] 511-9-520ms    | [S1,MB2,BI] 520-14-534ms   | [S1,MB2,BW] 534-14-549ms   | [S6,MB6,F]  549-7-556ms    | [S6,MB5,BI] 616-9-625ms    | [S6,MB5,BW] 625-10-636ms   | [S1,MB3,BI] 636-14-650ms   | [S1,MB3,BW] 650-14-665ms   | [S6,MB7,F]  665-7-672ms    | [S6,MB6,BI] 730-9-740ms    | [S6,MB6,BW] 740-11-751ms   | [S1,MB4,BI] 751-14-765ms   | [S6,MB7,BI] 845-10-855ms   | [S1,MB5,BI] 855-15-870ms   | [S1,MB4,BW] 870-16-886ms   | [S1,MB6,BI] 886-14-901ms   | [S1,MB5,BW] 901-15-916ms   | [S1,MB7,BI] 916-14-931ms   | [S1,MB6,BW] 931-16-948ms   | [S6,MB7,BW] 948-11-959ms   | [S1,MB7,BW] 959-16-976ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-8-29ms      | [S2,MB1,F]  32-7-39ms      | [S2,MB2,F]  43-7-50ms      | [S5,MB0,F]  50-9-59ms      | [S2,MB3,F]  59-9-69ms      | [S5,MB1,F]  69-7-76ms      | [S2,MB4,F]  76-10-86ms     | [S5,MB2,F]  86-8-95ms      | [S5,MB0,BI] 134-9-143ms    | [S5,MB0,BW] 143-10-154ms   | [S5,MB3,F]  154-7-161ms    | [S5,MB1,BI] 212-9-221ms    | [S5,MB1,BW] 221-10-232ms   | [S2,MB5,F]  232-7-239ms    | [S2,MB0,BI] 239-10-250ms   | [S2,MB0,BW] 250-9-260ms    | [S5,MB4,F]  260-7-268ms    | [S5,MB2,BI] 297-10-307ms   | [S5,MB2,BW] 307-9-317ms    | [S2,MB6,F]  319-9-329ms    | [S2,MB1,BI] 329-10-339ms   | [S2,MB1,BW] 339-9-349ms    | [S5,MB5,F]  349-7-357ms    | [S5,MB3,BI] 384-11-395ms   | [S5,MB3,BW] 395-11-407ms   | [S2,MB7,F]  430-7-437ms    | [S2,MB2,BI] 437-10-448ms   | [S2,MB2,BW] 448-9-457ms    | [S5,MB6,F]  457-7-465ms    | [S5,MB4,BI] 511-10-521ms   | [S5,MB4,BW] 521-9-531ms    | [S2,MB3,BI] 531-9-541ms    | [S2,MB3,BW] 541-10-551ms   | [S5,MB7,F]  551-7-558ms    | [S5,MB5,BI] 625-9-635ms    | [S5,MB5,BW] 635-9-644ms    | [S2,MB4,BI] 644-9-654ms    | [S5,MB6,BI] 740-10-750ms   | [S2,MB5,BI] 750-10-761ms   | [S5,MB7,BI] 855-9-864ms    | [S2,MB6,BI] 864-11-876ms   | [S2,MB4,BW] 876-10-886ms   | [S2,MB7,BI] 886-9-896ms    | [S2,MB5,BW] 896-10-906ms   | [S5,MB6,BW] 906-9-915ms    | [S5,MB7,BW] 915-9-925ms    | [S2,MB6,BW] 925-9-935ms    | [S2,MB7,BW] 935-10-945ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-8-37ms      | [S4,MB0,F]  37-8-45ms      | [S3,MB1,F]  45-8-54ms      | [S4,MB1,F]  54-7-61ms      | [S3,MB2,F]  61-7-68ms      | [S4,MB2,F]  68-7-76ms      | [S3,MB3,F]  76-7-84ms      | [S4,MB3,F]  84-8-92ms      | [S4,MB0,BI] 143-9-152ms    | [S4,MB0,BW] 152-9-162ms    AFR(10):1.0000 | [S3,MB4,F]  162-7-169ms    | [S3,MB0,BI] 169-9-178ms    | [S3,MB0,BW] 178-9-188ms    AFR(10):0.9444 | [S4,MB4,F]  188-7-196ms    | [S4,MB1,BI] 221-10-232ms   | [S4,MB1,BW] 232-10-242ms   AFR(10):1.0000 | [S3,MB5,F]  242-8-250ms    | [S3,MB1,BI] 250-9-259ms    | [S3,MB1,BW] 259-9-269ms    AFR(10):0.9444 | [S4,MB5,F]  269-7-277ms    | [S4,MB2,BI] 307-11-318ms   | [S4,MB2,BW] 318-9-328ms    AFR(10):1.0000 | [S3,MB6,F]  329-7-336ms    | [S3,MB2,BI] 336-9-345ms    | [S3,MB2,BW] 345-9-355ms    AFR(10):0.9444 | [S4,MB6,F]  355-7-363ms    | [S4,MB3,BI] 395-10-405ms   | [S4,MB3,BW] 405-10-416ms   AFR(10):1.0000 | [S3,MB7,F]  437-7-444ms    | [S3,MB3,BI] 444-9-454ms    | [S3,MB3,BW] 454-9-464ms    AFR(10):0.9444 | [S4,MB7,F]  464-7-471ms    | [S4,MB4,BI] 521-10-532ms   | [S4,MB4,BW] 532-9-541ms    AFR(10):1.0000 | [S3,MB4,BI] 541-10-552ms   | [S4,MB5,BI] 635-10-645ms   | [S3,MB5,BI] 645-9-654ms    | [S4,MB6,BI] 750-9-759ms    | [S3,MB6,BI] 759-9-769ms    | [S4,MB7,BI] 864-9-873ms    | [S3,MB7,BI] 873-9-883ms    | [S3,MB4,BW] 883-10-893ms   AFR(10):0.9444 | [S4,MB5,BW] 893-9-902ms    AFR(10):1.0000 | [S4,MB6,BW] 902-9-912ms    AFR(10):1.0000 | [S4,MB7,BW] 912-9-922ms    AFR(10):1.0000 | [S3,MB5,BW] 922-10-932ms   AFR(10):0.9444 | [S3,MB6,BW] 932-10-943ms   AFR(10):0.9444 | [S3,MB7,BW] 943-10-953ms   AFR(10):0.9444
[rank3]:2025-12-25 08:57:56,905 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/pipeline_schedule/251225_0857_min_batch_time.svg
[rank3]:			> Batch Time: 573.06 ms, GPU Bubble Ratio: 13.20%, 38.38%, 49.10%, 51.07%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-9-34ms      | [S0,MB4,F]  34-8-42ms      | [S0,MB5,F]  42-9-52ms      | [S0,MB6,F]  52-9-61ms      | [S7,MB0,F]  75-17-92ms     | [S7,MB0,BI] 92-32-125ms    | [S7,MB0,BW] 125-0-125ms    | [S7,MB1,F]  125-16-142ms   | [S7,MB1,BI] 142-34-177ms   | [S7,MB1,BW] 177-0-177ms    | [S7,MB2,F]  177-19-196ms   | [S7,MB2,BI] 196-35-231ms   | [S7,MB2,BW] 231-0-231ms    | [S7,MB3,F]  231-19-251ms   | [S7,MB3,BI] 251-35-286ms   | [S7,MB3,BW] 286-0-286ms    | [S0,MB7,F]  286-10-296ms   | [S0,MB0,B]  296-0-296ms    | [S7,MB4,F]  296-18-315ms   | [S7,MB4,BI] 315-34-350ms   | [S7,MB4,BW] 350-0-350ms    | [S0,MB1,B]  350-0-350ms    | [S7,MB5,F]  350-18-369ms   | [S7,MB5,BI] 369-34-403ms   | [S7,MB5,BW] 403-0-403ms    | [S0,MB2,B]  403-0-403ms    | [S7,MB6,F]  403-18-422ms   | [S7,MB6,BI] 422-34-457ms   | [S7,MB6,BW] 457-0-457ms    | [S0,MB3,B]  457-0-457ms    | [S7,MB7,F]  457-18-476ms   | [S7,MB7,BI] 476-34-510ms   | [S7,MB7,BW] 510-0-510ms    | [S0,MB4,B]  510-0-510ms    | [S0,MB5,B]  536-0-536ms    | [S0,MB6,B]  556-0-556ms    | [S0,MB7,B]  573-0-573ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-21ms      | [S1,MB1,F]  21-10-32ms     | [S1,MB2,F]  32-10-43ms     | [S1,MB3,F]  43-10-53ms     | [S1,MB4,F]  53-10-64ms     | [S6,MB0,F]  64-10-75ms     | [S1,MB5,F]  75-13-88ms     | [S6,MB1,F]  88-8-97ms      | [S6,MB0,BI] 125-9-134ms    | [S6,MB0,BW] 134-0-134ms    | [S6,MB2,F]  134-7-141ms    | [S6,MB1,BI] 177-9-186ms    | [S6,MB1,BW] 186-0-186ms    | [S6,MB3,F]  186-7-193ms    | [S6,MB2,BI] 231-9-240ms    | [S6,MB2,BW] 240-0-240ms    | [S1,MB6,F]  240-10-251ms   | [S1,MB0,BI] 251-15-267ms   | [S1,MB0,BW] 267-0-267ms    | [S6,MB4,F]  267-7-275ms    | [S6,MB3,BI] 286-10-296ms   | [S6,MB3,BW] 296-0-296ms    | [S1,MB7,F]  296-13-310ms   | [S1,MB1,BI] 310-15-325ms   | [S1,MB1,BW] 325-0-325ms    | [S6,MB5,F]  325-7-333ms    | [S6,MB4,BI] 350-10-360ms   | [S6,MB4,BW] 360-0-360ms    | [S1,MB2,BI] 360-14-374ms   | [S1,MB2,BW] 374-0-374ms    | [S6,MB6,F]  374-7-381ms    | [S6,MB5,BI] 403-9-413ms    | [S6,MB5,BW] 413-0-413ms    | [S1,MB3,BI] 413-14-427ms   | [S1,MB3,BW] 427-0-427ms    | [S6,MB7,F]  427-7-434ms    | [S6,MB6,BI] 457-9-466ms    | [S6,MB6,BW] 466-0-466ms    | [S1,MB4,BI] 466-14-481ms   | [S6,MB7,BI] 510-10-521ms   | [S1,MB5,BI] 521-15-536ms   | [S1,MB4,BW] 536-0-536ms    | [S1,MB6,BI] 541-14-556ms   | [S1,MB5,BW] 556-0-556ms    | [S1,MB7,BI] 558-14-573ms   | [S1,MB6,BW] 573-0-573ms    | [S6,MB7,BW] 573-0-573ms    | [S1,MB7,BW] 573-0-573ms   
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-8-29ms      | [S2,MB1,F]  32-7-39ms      | [S2,MB2,F]  43-7-50ms      | [S5,MB0,F]  50-9-59ms      | [S2,MB3,F]  59-9-69ms      | [S5,MB1,F]  69-7-76ms      | [S2,MB4,F]  76-10-86ms     | [S5,MB2,F]  86-8-95ms      | [S5,MB0,BI] 134-9-143ms    | [S5,MB0,BW] 143-0-143ms    | [S5,MB3,F]  143-7-151ms    | [S5,MB1,BI] 186-9-195ms    | [S5,MB1,BW] 195-0-195ms    | [S2,MB5,F]  195-7-203ms    | [S2,MB0,BI] 203-10-213ms   | [S2,MB0,BW] 213-0-213ms    | [S5,MB4,F]  213-7-221ms    | [S5,MB2,BI] 240-10-251ms   | [S5,MB2,BW] 251-0-251ms    | [S2,MB6,F]  251-9-261ms    | [S2,MB1,BI] 261-10-272ms   | [S2,MB1,BW] 272-0-272ms    | [S5,MB5,F]  272-7-279ms    | [S5,MB3,BI] 296-11-307ms   | [S5,MB3,BW] 307-0-307ms    | [S2,MB7,F]  310-7-317ms    | [S2,MB2,BI] 317-10-328ms   | [S2,MB2,BW] 328-0-328ms    | [S5,MB6,F]  328-7-335ms    | [S5,MB4,BI] 360-10-371ms   | [S5,MB4,BW] 371-0-371ms    | [S2,MB3,BI] 371-9-380ms    | [S2,MB3,BW] 380-0-380ms    | [S5,MB7,F]  380-7-388ms    | [S5,MB5,BI] 413-9-422ms    | [S5,MB5,BW] 422-0-422ms    | [S2,MB4,BI] 422-9-432ms    | [S5,MB6,BI] 466-10-477ms   | [S2,MB5,BI] 477-10-487ms   | [S5,MB7,BI] 521-9-530ms    | [S2,MB6,BI] 530-11-541ms   | [S2,MB4,BW] 541-0-541ms    | [S2,MB7,BI] 548-9-558ms    | [S2,MB5,BW] 558-0-558ms    | [S5,MB6,BW] 558-0-558ms    | [S5,MB7,BW] 558-0-558ms    | [S2,MB6,BW] 558-0-558ms    | [S2,MB7,BW] 558-0-558ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-8-37ms      | [S4,MB0,F]  37-8-45ms      | [S3,MB1,F]  45-8-54ms      | [S4,MB1,F]  54-7-61ms      | [S3,MB2,F]  61-7-68ms      | [S4,MB2,F]  68-7-76ms      | [S3,MB3,F]  76-7-84ms      | [S4,MB3,F]  84-8-92ms      | [S4,MB0,BI] 143-9-152ms    | [S4,MB0,BW] 152-0-152ms    AFR(10):1.0000 | [S3,MB4,F]  152-7-160ms    | [S3,MB0,BI] 160-9-169ms    | [S3,MB0,BW] 169-0-169ms    AFR(10):0.9444 | [S4,MB4,F]  169-7-177ms    | [S4,MB1,BI] 195-10-206ms   | [S4,MB1,BW] 206-0-206ms    AFR(10):1.0000 | [S3,MB5,F]  206-8-214ms    | [S3,MB1,BI] 214-9-223ms    | [S3,MB1,BW] 223-0-223ms    AFR(10):0.9444 | [S4,MB5,F]  223-7-231ms    | [S4,MB2,BI] 251-11-262ms   | [S4,MB2,BW] 262-0-262ms    AFR(10):1.0000 | [S3,MB6,F]  262-7-269ms    | [S3,MB2,BI] 269-9-278ms    | [S3,MB2,BW] 278-0-278ms    AFR(10):0.9444 | [S4,MB6,F]  278-7-286ms    | [S4,MB3,BI] 307-10-317ms   | [S4,MB3,BW] 317-0-317ms    AFR(10):1.0000 | [S3,MB7,F]  317-7-325ms    | [S3,MB3,BI] 325-9-334ms    | [S3,MB3,BW] 334-0-334ms    AFR(10):0.9444 | [S4,MB7,F]  334-7-342ms    | [S4,MB4,BI] 371-10-381ms   | [S4,MB4,BW] 381-0-381ms    AFR(10):1.0000 | [S3,MB4,BI] 381-10-391ms   | [S4,MB5,BI] 422-10-432ms   | [S3,MB5,BI] 432-9-441ms    | [S4,MB6,BI] 477-9-486ms    | [S3,MB6,BI] 486-9-495ms    | [S4,MB7,BI] 530-9-539ms    | [S3,MB7,BI] 539-9-548ms    | [S3,MB4,BW] 548-0-548ms    AFR(10):0.9444 | [S4,MB5,BW] 548-0-548ms    AFR(10):1.0000 | [S4,MB6,BW] 548-0-548ms    AFR(10):1.0000 | [S4,MB7,BW] 548-0-548ms    AFR(10):1.0000 | [S3,MB5,BW] 548-0-549ms    AFR(10):0.9444 | [S3,MB6,BW] 549-0-549ms    AFR(10):0.9444 | [S3,MB7,BW] 549-0-549ms    AFR(10):0.9444
[rank3]:2025-12-25 08:57:57,280 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/pipeline_schedule/251225_0857_frozen_pipeline_schedule.svg
[rank3]:			> Batch Time: 600.98 ms, GPU Bubble Ratio: 2.22%, 22.33%, 30.59%, 34.42%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-9-34ms      | [S0,MB4,F]  34-8-42ms      | [S0,MB5,F]  42-9-52ms      | [S0,MB6,F]  52-9-61ms      | [S7,MB0,F]  75-17-92ms     | [S7,MB0,BI] 92-32-125ms    | [S7,MB0,BW] 125-25-151ms   | [S7,MB1,F]  151-16-168ms   | [S7,MB1,BI] 168-34-203ms   | [S7,MB1,BW] 203-0-203ms    | [S7,MB2,F]  203-19-222ms   | [S7,MB2,BI] 222-35-257ms   | [S7,MB2,BW] 257-0-257ms    | [S7,MB3,F]  257-19-277ms   | [S7,MB3,BI] 277-35-312ms   | [S7,MB3,BW] 312-0-312ms    | [S0,MB7,F]  312-10-322ms   | [S0,MB0,B]  322-0-322ms    | [S7,MB4,F]  322-18-341ms   | [S7,MB4,BI] 341-34-376ms   | [S7,MB4,BW] 376-0-376ms    | [S0,MB1,B]  376-0-376ms    | [S7,MB5,F]  376-18-395ms   | [S7,MB5,BI] 395-34-429ms   | [S7,MB5,BW] 429-0-429ms    | [S0,MB2,B]  429-0-429ms    | [S7,MB6,F]  429-18-448ms   | [S7,MB6,BI] 448-34-483ms   | [S7,MB6,BW] 483-0-483ms    | [S0,MB3,B]  483-0-483ms    | [S7,MB7,F]  483-18-502ms   | [S7,MB7,BI] 502-34-536ms   | [S7,MB7,BW] 536-18-554ms   | [S0,MB4,B]  554-7-562ms    | [S0,MB5,B]  562-19-581ms   | [S0,MB6,B]  581-17-599ms   | [S0,MB7,B]  599-1-600ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-21ms      | [S1,MB1,F]  21-10-32ms     | [S1,MB2,F]  32-10-43ms     | [S1,MB3,F]  43-10-53ms     | [S1,MB4,F]  53-10-64ms     | [S6,MB0,F]  64-10-75ms     | [S1,MB5,F]  75-13-88ms     | [S6,MB1,F]  88-8-97ms      | [S6,MB0,BI] 125-9-134ms    | [S6,MB0,BW] 134-10-144ms   | [S6,MB2,F]  144-7-152ms    | [S6,MB1,BI] 203-9-212ms    | [S6,MB1,BW] 212-10-222ms   | [S6,MB3,F]  222-7-230ms    | [S6,MB2,BI] 257-9-266ms    | [S6,MB2,BW] 266-10-277ms   | [S1,MB6,F]  277-10-288ms   | [S1,MB0,BI] 288-15-304ms   | [S1,MB0,BW] 304-0-304ms    | [S6,MB4,F]  304-7-312ms    | [S6,MB3,BI] 312-10-322ms   | [S6,MB3,BW] 322-9-332ms    | [S1,MB7,F]  332-13-346ms   | [S1,MB1,BI] 346-15-361ms   | [S1,MB1,BW] 361-7-368ms    | [S6,MB5,F]  368-7-376ms    | [S6,MB4,BI] 376-10-386ms   | [S6,MB4,BW] 386-9-396ms    | [S1,MB2,BI] 396-14-410ms   | [S1,MB2,BW] 410-12-422ms   | [S6,MB6,F]  422-7-429ms    | [S6,MB5,BI] 429-9-439ms    | [S6,MB5,BW] 439-10-450ms   | [S1,MB3,BI] 450-14-464ms   | [S1,MB3,BW] 464-11-476ms   | [S6,MB7,F]  476-7-483ms    | [S6,MB6,BI] 483-9-492ms    | [S6,MB6,BW] 492-11-503ms   | [S1,MB4,BI] 503-14-518ms   | [S6,MB7,BI] 536-10-547ms   | [S1,MB5,BI] 547-15-562ms   | [S1,MB4,BW] 562-5-567ms    | [S1,MB6,BI] 567-14-581ms   | [S1,MB5,BW] 581-2-584ms    | [S1,MB7,BI] 584-14-599ms   | [S1,MB6,BW] 599-0-599ms    | [S6,MB7,BW] 599-1-600ms    | [S1,MB7,BW] 600-0-600ms   
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-8-29ms      | [S2,MB1,F]  32-7-39ms      | [S2,MB2,F]  43-7-50ms      | [S5,MB0,F]  50-9-59ms      | [S2,MB3,F]  59-9-69ms      | [S5,MB1,F]  69-7-76ms      | [S2,MB4,F]  76-10-86ms     | [S5,MB2,F]  86-8-95ms      | [S5,MB0,BI] 134-9-143ms    | [S5,MB0,BW] 143-10-154ms   | [S5,MB3,F]  154-7-161ms    | [S5,MB1,BI] 212-9-221ms    | [S5,MB1,BW] 221-10-232ms   | [S2,MB5,F]  232-7-239ms    | [S2,MB0,BI] 239-10-250ms   | [S2,MB0,BW] 250-9-260ms    | [S5,MB4,F]  260-7-268ms    | [S5,MB2,BI] 268-10-278ms   | [S5,MB2,BW] 278-9-288ms    | [S2,MB6,F]  288-9-298ms    | [S2,MB1,BI] 298-10-309ms   | [S2,MB1,BW] 309-9-318ms    | [S5,MB5,F]  318-7-326ms    | [S5,MB3,BI] 326-11-337ms   | [S5,MB3,BW] 337-11-348ms   | [S2,MB7,F]  348-7-356ms    | [S2,MB2,BI] 356-10-366ms   | [S2,MB2,BW] 366-9-376ms    | [S5,MB6,F]  376-7-384ms    | [S5,MB4,BI] 386-10-397ms   | [S5,MB4,BW] 397-9-407ms    | [S2,MB3,BI] 407-9-416ms    | [S2,MB3,BW] 416-10-426ms   | [S5,MB7,F]  426-7-433ms    | [S5,MB5,BI] 439-9-448ms    | [S5,MB5,BW] 448-9-458ms    | [S2,MB4,BI] 458-9-467ms    | [S5,MB6,BI] 492-10-503ms   | [S2,MB5,BI] 503-10-513ms   | [S5,MB7,BI] 547-9-556ms    | [S2,MB6,BI] 556-11-567ms   | [S2,MB4,BW] 567-6-574ms    | [S2,MB7,BI] 574-9-584ms    | [S2,MB5,BW] 584-0-584ms    | [S5,MB6,BW] 584-9-593ms    | [S5,MB7,BW] 593-7-600ms    | [S2,MB6,BW] 600-0-600ms    | [S2,MB7,BW] 600-0-600ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-8-37ms      | [S4,MB0,F]  37-8-45ms      | [S3,MB1,F]  45-8-54ms      | [S4,MB1,F]  54-7-61ms      | [S3,MB2,F]  61-7-68ms      | [S4,MB2,F]  68-7-76ms      | [S3,MB3,F]  76-7-84ms      | [S4,MB3,F]  84-8-92ms      | [S4,MB0,BI] 143-9-152ms    | [S4,MB0,BW] 152-9-162ms    AFR(10):1.0000 | [S3,MB4,F]  162-7-169ms    | [S3,MB0,BI] 169-9-178ms    | [S3,MB0,BW] 178-9-188ms    AFR(10):0.9444 | [S4,MB4,F]  188-7-196ms    | [S4,MB1,BI] 221-10-232ms   | [S4,MB1,BW] 232-10-242ms   AFR(10):1.0000 | [S3,MB5,F]  242-8-250ms    | [S3,MB1,BI] 250-9-259ms    | [S3,MB1,BW] 259-9-269ms    AFR(10):0.9444 | [S4,MB5,F]  269-7-277ms    | [S4,MB2,BI] 278-11-289ms   | [S4,MB2,BW] 289-9-299ms    AFR(10):1.0000 | [S3,MB6,F]  299-7-306ms    | [S3,MB2,BI] 306-9-316ms    | [S3,MB2,BW] 316-9-325ms    AFR(10):0.9444 | [S4,MB6,F]  325-7-333ms    | [S4,MB3,BI] 337-10-347ms   | [S4,MB3,BW] 347-10-358ms   AFR(10):1.0000 | [S3,MB7,F]  358-7-365ms    | [S3,MB3,BI] 365-9-375ms    | [S3,MB3,BW] 375-9-384ms    AFR(10):0.9444 | [S4,MB7,F]  384-7-392ms    | [S4,MB4,BI] 397-10-407ms   | [S4,MB4,BW] 407-9-417ms    AFR(10):1.0000 | [S3,MB4,BI] 417-10-427ms   | [S4,MB5,BI] 448-10-458ms   | [S3,MB5,BI] 458-9-467ms    | [S4,MB6,BI] 503-9-512ms    | [S3,MB6,BI] 512-9-521ms    | [S4,MB7,BI] 556-9-565ms    | [S3,MB7,BI] 565-9-574ms    | [S3,MB4,BW] 574-0-574ms    AFR(10):0.9444 | [S4,MB5,BW] 574-9-584ms    AFR(10):1.0000 | [S4,MB6,BW] 584-9-593ms    AFR(10):1.0000 | [S4,MB7,BW] 593-6-600ms    AFR(10):1.0000 | [S3,MB5,BW] 600-0-600ms    AFR(10):0.9444 | [S3,MB6,BW] 600-0-600ms    AFR(10):0.9444 | [S3,MB7,BW] 600-0-600ms    AFR(10):0.9444
[rank3]:2025-12-25 08:57:57,281 - 	> Batch Time: 600.98 ms (Average Freeze Ratio: 0.42, Time Reduction Rate: 0.39)
[rank3]:2025-12-25 08:57:57,283 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.35/0.35, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-12-25 08:58:00,547 - Avg. fwd time: 9.8833 / Avg. bwd-weight time: 10.2998 / Avg. bwd-input time: 12.2229 / Avg. batch time: 1024.4632 (ms) / GPU bubble ratio: 49.39%
[rank2]:2025-12-25 08:58:00,543 - Avg. fwd time: 8.2127 / Avg. bwd-weight time: 8.0112 / Avg. bwd-input time: 10.0387 / Avg. batch time: 989.7861 (ms) / GPU bubble ratio: 57.55%
[rank3]:2025-12-25 08:58:00,542 - Avg. fwd time: 7.7739 / Avg. bwd-weight time: 7.8904 / Avg. bwd-input time: 9.6510 / Avg. batch time: 980.3469 (ms) / GPU bubble ratio: 58.68%
[rank0]:2025-12-25 08:58:00,554 - Avg. fwd time: 13.5042 / Avg. full-bwd time: 23.0551 (Avg. bwd-weight time: 23.9050 / Avg. bwd-input time: 34.3781) / Avg. batch time: 1045.6519 (ms) / GPU bubble ratio: 17.11%
[rank0]:2025-12-25 08:58:00,627 -  step: 100  loss:  9.0651  grad_norm:  3.8550  memory: 40.23GiB(84.68%)  tps: 8,072  tflops: 63.11  mfu: 20.23%
[rank1]:2025-12-25 08:58:00,603 -  step: 100  loss: -4.0000  grad_norm:  3.8550  memory: 18.98GiB(39.95%)  tps: 8,072  tflops: 63.11  mfu: 20.23%
[rank2]:2025-12-25 08:58:00,600 -  step: 100  loss: -4.0000  grad_norm:  3.8550  memory: 14.70GiB(30.94%)  tps: 8,072  tflops: 63.11  mfu: 20.23%
[rank3]:2025-12-25 08:58:00,600 -  step: 100  loss: -4.0000  grad_norm:  3.8550  memory: 16.16GiB(34.02%)  tps: 8,072  tflops: 63.11  mfu: 20.23%
[rank0]:2025-12-25 08:58:00,693 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank0/251225_0858_stage0_step100.svg
[rank0]:2025-12-25 08:58:00,734 - âœ… Frozen Ratio History of Rank 0 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank0/251225_0858_stage7_step100.svg
[rank1]:2025-12-25 08:58:00,688 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank1/251225_0858_stage1_step100.svg
[rank1]:2025-12-25 08:58:00,726 - âœ… Frozen Ratio History of Rank 1 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank1/251225_0858_stage6_step100.svg
[rank2]:2025-12-25 08:58:00,688 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank2/251225_0858_stage2_step100.svg
[rank2]:2025-12-25 08:58:00,726 - âœ… Frozen Ratio History of Rank 2 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank2/251225_0858_stage5_step100.svg
[rank2]:2025-12-25 08:58:00,765 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251225_0858_stage2.svg
[rank0]:2025-12-25 08:58:00,778 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251225_0858_stage0.svg
[rank0]:2025-12-25 08:58:00,817 - âœ… Scatter Plot of Stage 7 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251225_0858_stage7.svg
[rank1]:2025-12-25 08:58:00,765 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251225_0858_stage1.svg
[rank1]:2025-12-25 08:58:00,801 - âœ… Scatter Plot of Stage 6 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251225_0858_stage6.svg
[rank2]:2025-12-25 08:58:00,801 - âœ… Scatter Plot of Stage 5 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251225_0858_stage5.svg
[rank3]:2025-12-25 08:58:00,924 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/pipeline_schedule/251225_0858_step100_rank3.svg
[rank3]:			> Batch Time: 765.00 ms, GPU Bubble Ratio: 38.04%, 53.21%, 61.36%, 63.48%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-8-33ms      | [S0,MB4,F]  33-7-41ms      | [S0,MB5,F]  41-9-50ms      | [S0,MB6,F]  50-8-58ms      | [S7,MB0,F]  112-16-129ms   | [S7,MB0,BI] 141-32-174ms   | [S7,MB0,BW] 174-0-174ms    | [S7,MB1,F]  174-16-191ms   | [S7,MB1,BI] 203-33-237ms   | [S7,MB1,BW] 237-0-237ms    | [S7,MB2,F]  237-18-255ms   | [S7,MB2,BI] 267-35-302ms   | [S7,MB2,BW] 302-0-302ms    | [S7,MB3,F]  302-18-321ms   | [S7,MB3,BI] 332-35-368ms   | [S7,MB3,BW] 367-0-367ms    | [S0,MB7,F]  367-10-377ms   | [S0,MB0,B]  378-0-378ms    | [S7,MB4,F]  385-18-404ms   | [S7,MB4,BI] 416-33-449ms   | [S7,MB4,BW] 450-0-450ms    | [S0,MB1,B]  457-0-457ms    | [S7,MB5,F]  461-17-478ms   | [S7,MB5,BI] 491-33-524ms   | [S7,MB5,BW] 524-0-524ms    | [S0,MB2,B]  530-0-530ms    | [S7,MB6,F]  544-14-559ms   | [S7,MB6,BI] 570-32-603ms   | [S7,MB6,BW] 603-0-603ms    | [S0,MB3,B]  610-0-610ms    | [S7,MB7,F]  623-14-638ms   | [S7,MB7,BI] 650-32-682ms   | [S7,MB7,BW] 683-0-683ms    | [S0,MB4,B]  689-0-689ms    | [S0,MB5,B]  716-0-716ms    | [S0,MB6,B]  741-0-741ms    | [S0,MB7,B]  765-0-765ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  27-10-38ms     | [S1,MB2,F]  44-10-55ms     | [S1,MB3,F]  61-10-72ms     | [S1,MB4,F]  84-10-95ms     | [S6,MB0,F]  95-10-105ms    | [S1,MB5,F]  105-13-119ms   | [S6,MB1,F]  119-8-127ms    | [S6,MB0,BI] 174-9-183ms    | [S6,MB0,BW] 183-0-183ms    | [S6,MB2,F]  183-8-192ms    | [S6,MB1,BI] 237-9-246ms    | [S6,MB1,BW] 246-0-246ms    | [S6,MB3,F]  246-8-254ms    | [S6,MB2,BI] 302-9-311ms    | [S6,MB2,BW] 311-0-311ms    | [S1,MB6,F]  311-12-324ms   | [S1,MB0,BI] 324-15-339ms   | [S1,MB0,BW] 340-0-340ms    | [S6,MB4,F]  340-7-347ms    | [S6,MB3,BI] 367-11-378ms   | [S6,MB3,BW] 378-0-378ms    | [S1,MB7,F]  379-13-392ms   | [S1,MB1,BI] 393-15-408ms   | [S1,MB1,BW] 408-0-408ms    | [S6,MB5,F]  408-7-416ms    | [S6,MB4,BI] 449-11-461ms   | [S6,MB4,BW] 461-0-461ms    | [S1,MB2,BI] 468-13-482ms   | [S1,MB2,BW] 482-0-482ms    | [S6,MB6,F]  530-7-537ms    | [S6,MB5,BI] 537-10-547ms   | [S6,MB5,BW] 547-0-547ms    | [S1,MB3,BI] 553-14-567ms   | [S1,MB3,BW] 567-0-567ms    | [S6,MB7,F]  609-7-616ms    | [S6,MB6,BI] 616-10-626ms   | [S6,MB6,BW] 626-0-626ms    | [S1,MB4,BI] 633-14-648ms   | [S6,MB7,BI] 682-10-693ms   | [S1,MB5,BI] 693-14-708ms   | [S1,MB4,BW] 708-0-708ms    | [S1,MB6,BI] 720-14-734ms   | [S1,MB5,BW] 734-0-734ms    | [S1,MB7,BI] 744-13-758ms   | [S1,MB6,BW] 758-0-758ms    | [S6,MB7,BW] 758-0-758ms    | [S1,MB7,BW] 758-0-758ms   
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  38-7-45ms      | [S2,MB2,F]  55-7-62ms      | [S5,MB0,F]  62-9-72ms      | [S2,MB3,F]  73-9-82ms      | [S5,MB1,F]  82-7-90ms      | [S2,MB4,F]  95-10-106ms    | [S5,MB2,F]  114-8-123ms    | [S5,MB0,BI] 183-9-192ms    | [S5,MB0,BW] 192-0-192ms    | [S5,MB3,F]  192-8-201ms    | [S5,MB1,BI] 246-9-255ms    | [S5,MB1,BW] 255-0-255ms    | [S2,MB5,F]  255-8-264ms    | [S2,MB0,BI] 264-11-275ms   | [S2,MB0,BW] 275-0-275ms    | [S5,MB4,F]  275-7-283ms    | [S5,MB2,BI] 311-10-322ms   | [S5,MB2,BW] 322-0-322ms    | [S2,MB6,F]  324-9-334ms    | [S2,MB1,BI] 336-10-346ms   | [S2,MB1,BW] 346-0-346ms    | [S5,MB5,F]  346-7-353ms    | [S5,MB3,BI] 382-10-393ms   | [S5,MB3,BW] 393-0-393ms    | [S2,MB7,F]  393-9-403ms    | [S2,MB2,BI] 404-10-415ms   | [S2,MB2,BW] 415-0-415ms    | [S5,MB6,F]  415-7-423ms    | [S5,MB4,BI] 461-10-472ms   | [S5,MB4,BW] 471-0-471ms    | [S2,MB3,BI] 532-9-542ms    | [S2,MB3,BW] 542-0-542ms    | [S5,MB7,F]  553-7-560ms    | [S5,MB5,BI] 560-9-570ms    | [S5,MB5,BW] 570-0-570ms    | [S2,MB4,BI] 612-9-622ms    | [S5,MB6,BI] 626-10-637ms   | [S2,MB5,BI] 637-10-647ms   | [S5,MB7,BI] 693-9-703ms    | [S2,MB6,BI] 702-11-713ms   | [S2,MB4,BW] 713-0-713ms    | [S2,MB7,BI] 728-9-738ms    | [S2,MB5,BW] 738-0-738ms    | [S5,MB6,BW] 738-0-738ms    | [S5,MB7,BW] 738-0-738ms    | [S2,MB6,BW] 738-0-738ms    | [S2,MB7,BW] 738-0-738ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-7-36ms      | [S4,MB0,F]  36-8-45ms      | [S3,MB1,F]  46-8-54ms      | [S4,MB1,F]  54-7-61ms      | [S3,MB2,F]  63-7-70ms      | [S4,MB2,F]  70-7-78ms      | [S3,MB3,F]  97-7-105ms     | [S4,MB3,F]  105-8-113ms    | [S4,MB0,BI] 192-9-201ms    | [S4,MB0,BW] 201-0-201ms    | [S3,MB4,F]  202-7-209ms    | [S3,MB0,BI] 209-9-218ms    | [S3,MB0,BW] 218-0-218ms    | [S4,MB4,F]  218-7-225ms    | [S4,MB1,BI] 256-10-266ms   | [S4,MB1,BW] 267-0-267ms    | [S3,MB5,F]  267-8-275ms    | [S3,MB1,BI] 275-9-284ms    | [S3,MB1,BW] 284-0-284ms    | [S4,MB5,F]  284-7-291ms    | [S4,MB2,BI] 329-11-340ms   | [S4,MB2,BW] 340-0-340ms    | [S3,MB6,F]  341-7-348ms    | [S3,MB2,BI] 348-9-357ms    | [S3,MB2,BW] 357-0-357ms    | [S4,MB6,F]  358-7-365ms    | [S4,MB3,BI] 398-11-409ms   | [S4,MB3,BW] 409-0-409ms    | [S3,MB7,F]  409-7-417ms    | [S3,MB3,BI] 417-9-426ms    | [S3,MB3,BW] 426-0-426ms    | [S4,MB7,F]  426-7-434ms    | [S4,MB4,BI] 526-10-537ms   | [S4,MB4,BW] 537-0-537ms    | [S3,MB4,BI] 537-9-546ms    | [S4,MB5,BI] 606-10-616ms   | [S3,MB5,BI] 616-9-625ms    | [S4,MB6,BI] 638-9-647ms    | [S3,MB6,BI] 647-9-656ms    | [S4,MB7,BI] 704-9-713ms    | [S3,MB7,BI] 713-9-722ms    | [S3,MB4,BW] 722-0-722ms    | [S4,MB5,BW] 722-0-722ms    | [S4,MB6,BW] 722-0-722ms    | [S4,MB7,BW] 722-0-722ms    | [S3,MB5,BW] 723-0-723ms    | [S3,MB6,BW] 723-0-723ms    | [S3,MB7,BW] 723-0-723ms   
[rank3]:2025-12-25 08:58:00,964 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank3/251225_0858_stage3_step100.svg
[rank3]:2025-12-25 08:58:01,002 - âœ… Frozen Ratio History of Rank 3 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank3/251225_0858_stage4_step100.svg
[rank3]:2025-12-25 08:58:01,041 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251225_0858_stage3.svg
[rank3]:2025-12-25 08:58:01,076 - âœ… Scatter Plot of Stage 4 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251225_0858_stage4.svg
[rank0]:2025-12-25 09:01:20,583 - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-12-25 09:01:20,927 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB0] 0.67/1.00, [MB3] 0.00/0.00, [MB1] 0.34/0.51, [MB4] 0.00/0.00, [MB2] 0.11/0.17, [MB5] 0.00/0.00, [MB3] 0.14/0.20, [MB6] 0.00/0.00, [MB4] 0.44/0.66, [MB5] 0.58/0.87, [MB6] 0.67/1.00, [MB7] 0.55/0.82, [MB7] 0.67/1.00
[rank3]:2025-12-25 09:01:20,920 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB4] 0.67/1.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.23/0.35, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank2]:2025-12-25 09:01:20,920 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB0] 0.00/0.00, [MB2] 0.00/0.00, [MB1] 0.00/0.00, [MB3] 0.00/0.00, [MB2] 0.00/0.00, [MB4] 0.00/0.00, [MB3] 0.00/0.00, [MB5] 0.00/0.00, [MB4] 0.23/0.34, [MB5] 0.67/1.00, [MB6] 0.00/0.00, [MB7] 0.17/0.25, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank0]:2025-12-25 09:01:20,977 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.67/1.00, [MB2] 0.67/1.00, [MB3] 0.67/1.00, [MB0] 0.67/1.00, [MB4] 0.67/1.00, [MB1] 0.67/1.00, [MB5] 0.67/1.00, [MB2] 0.67/1.00, [MB6] 0.67/1.00, [MB3] 0.67/1.00, [MB7] 0.27/0.40, [MB4] 0.50/0.75, [MB5] 0.22/0.32, [MB6] 0.26/0.39, [MB7] 0.62/0.93
[rank0]:2025-12-25 09:01:24,988 - Avg. fwd time: 13.5607 / Avg. full-bwd time: 21.4937 (Avg. bwd-weight time: 23.2647 / Avg. bwd-input time: 34.4731) / Avg. batch time: 1023.5232 (ms) / GPU bubble ratio: 16.87%
[rank1]:2025-12-25 09:01:24,975 - Avg. fwd time: 9.8546 / Avg. bwd-weight time: 9.8689 / Avg. bwd-input time: 12.2307 / Avg. batch time: 999.3122 (ms) / GPU bubble ratio: 48.84%
[rank3]:2025-12-25 09:01:24,967 - Avg. fwd time: 7.7859 / Avg. bwd-weight time: 7.9319 / Avg. bwd-input time: 9.6769 / Avg. batch time: 959.2334 (ms) / GPU bubble ratio: 57.64%
[rank3]:2025-12-25 09:01:25,033 -  step: 150  loss: -4.0000  grad_norm: 19.5734  memory: 16.18GiB(34.07%)  tps: 8,014  tflops: 62.65  mfu: 20.08%
[rank2]:2025-12-25 09:01:24,972 - Avg. fwd time: 8.2081 / Avg. bwd-weight time: 8.1910 / Avg. bwd-input time: 10.0663 / Avg. batch time: 969.2790 (ms) / GPU bubble ratio: 56.31%
[rank2]:2025-12-25 09:01:25,033 -  step: 150  loss: -4.0000  grad_norm: 19.5734  memory: 14.72GiB(30.98%)  tps: 8,014  tflops: 62.65  mfu: 20.08%
[rank0]:2025-12-25 09:01:25,061 -  step: 150  loss:  4.5554  grad_norm: 19.5734  memory: 40.54GiB(85.33%)  tps: 8,014  tflops: 62.65  mfu: 20.08%
[rank1]:2025-12-25 09:01:25,037 -  step: 150  loss: -4.0000  grad_norm: 19.5734  memory: 18.98GiB(39.95%)  tps: 8,014  tflops: 62.65  mfu: 20.08%
[rank0]:2025-12-25 09:04:32,859 - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-12-25 09:04:33,182 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB0] 1.00/1.00, [MB3] 0.00/0.00, [MB1] 0.51/0.51, [MB4] 0.00/0.00, [MB2] 0.17/0.17, [MB5] 0.00/0.00, [MB3] 0.20/0.20, [MB6] 0.00/0.00, [MB4] 0.66/0.66, [MB5] 0.87/0.87, [MB6] 1.00/1.00, [MB7] 0.82/0.82, [MB7] 1.00/1.00
[rank3]:2025-12-25 09:04:33,175 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.35/0.35, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank2]:2025-12-25 09:04:33,175 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB0] 0.00/0.00, [MB2] 0.00/0.00, [MB1] 0.00/0.00, [MB3] 0.00/0.00, [MB2] 0.00/0.00, [MB4] 0.00/0.00, [MB3] 0.00/0.00, [MB5] 0.00/0.00, [MB4] 0.34/0.34, [MB5] 1.00/1.00, [MB6] 0.00/0.00, [MB7] 0.25/0.25, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank0]:2025-12-25 09:04:33,231 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB0] 1.00/1.00, [MB4] 1.00/1.00, [MB1] 1.00/1.00, [MB5] 1.00/1.00, [MB2] 1.00/1.00, [MB6] 1.00/1.00, [MB3] 1.00/1.00, [MB7] 0.40/0.40, [MB4] 0.75/0.75, [MB5] 0.32/0.32, [MB6] 0.39/0.39, [MB7] 0.93/0.93
[rank1]:2025-12-25 09:04:36,636 - Avg. fwd time: 9.8309 / Avg. bwd-weight time: 9.3051 / Avg. bwd-input time: 12.2621 / Avg. batch time: 971.1448 (ms) / GPU bubble ratio: 48.27%
[rank0]:2025-12-25 09:04:36,652 - Avg. fwd time: 13.6056 / Avg. full-bwd time: 20.1784 (Avg. bwd-weight time: 21.3539 / Avg. bwd-input time: 34.5698) / Avg. batch time: 996.7515 (ms) / GPU bubble ratio: 17.08%
[rank3]:2025-12-25 09:04:36,631 - Avg. fwd time: 7.7945 / Avg. bwd-weight time: 7.7713 / Avg. bwd-input time: 9.7112 / Avg. batch time: 932.8134 (ms) / GPU bubble ratio: 56.64%
[rank3]:2025-12-25 09:04:36,698 -  step: 200  loss: -4.0000  grad_norm:  4.7533  memory: 16.18GiB(34.07%)  tps: 8,548  tflops: 66.83  mfu: 21.42%
[rank2]:2025-12-25 09:04:36,635 - Avg. fwd time: 8.2195 / Avg. bwd-weight time: 8.1679 / Avg. bwd-input time: 10.0869 / Avg. batch time: 944.2310 (ms) / GPU bubble ratio: 55.14%
[rank2]:2025-12-25 09:04:36,698 -  step: 200  loss: -4.0000  grad_norm:  4.7533  memory: 14.74GiB(31.02%)  tps: 8,548  tflops: 66.83  mfu: 21.42%
[rank1]:2025-12-25 09:04:36,701 -  step: 200  loss: -4.0000  grad_norm:  4.7533  memory: 18.98GiB(39.95%)  tps: 8,548  tflops: 66.83  mfu: 21.42%
[rank1]:2025-12-25 09:04:36,776 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank1/251225_0904_stage1_step200.svg
[rank0]:2025-12-25 09:04:36,723 -  step: 200  loss:  1.4962  grad_norm:  4.7533  memory: 40.54GiB(85.33%)  tps: 8,548  tflops: 66.83  mfu: 21.42%
[rank0]:2025-12-25 09:04:36,775 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank0/251225_0904_stage0_step200.svg
[rank2]:2025-12-25 09:04:36,776 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank2/251225_0904_stage2_step200.svg
[rank1]:2025-12-25 09:04:36,818 - âœ… Frozen Ratio History of Rank 1 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank1/251225_0904_stage6_step200.svg
[rank0]:2025-12-25 09:04:36,821 - âœ… Frozen Ratio History of Rank 0 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank0/251225_0904_stage7_step200.svg
[rank2]:2025-12-25 09:04:36,819 - âœ… Frozen Ratio History of Rank 2 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank2/251225_0904_stage5_step200.svg
[rank1]:2025-12-25 09:04:36,984 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251225_0904_stage1.svg
[rank0]:2025-12-25 09:04:36,989 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251225_0904_stage0.svg
[rank2]:2025-12-25 09:04:36,984 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251225_0904_stage2.svg
[rank3]:2025-12-25 09:04:37,052 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/pipeline_schedule/251225_0904_step200_rank3.svg
[rank3]:			> Batch Time: 871.02 ms, GPU Bubble Ratio: 20.52%, 45.77%, 51.53%, 54.30%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-8-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-9-34ms      | [S0,MB4,F]  34-8-42ms      | [S0,MB5,F]  43-10-53ms     | [S0,MB6,F]  53-9-62ms      | [S7,MB0,F]  113-17-130ms   | [S7,MB0,BI] 142-32-175ms   | [S7,MB0,BW] 175-26-201ms   | [S7,MB1,F]  202-17-219ms   | [S7,MB1,BI] 230-34-265ms   | [S7,MB1,BW] 265-0-265ms    | [S7,MB2,F]  265-18-284ms   | [S7,MB2,BI] 296-35-331ms   | [S7,MB2,BW] 331-0-331ms    | [S7,MB3,F]  332-19-351ms   | [S7,MB3,BI] 364-35-399ms   | [S7,MB3,BW] 399-24-424ms   | [S0,MB7,F]  423-10-433ms   | [S0,MB0,B]  433-11-444ms   | [S7,MB4,F]  444-19-464ms   | [S7,MB4,BI] 475-35-510ms   | [S7,MB4,BW] 510-0-510ms    | [S0,MB1,B]  518-10-529ms   | [S7,MB5,F]  529-18-547ms   | [S7,MB5,BI] 558-34-593ms   | [S7,MB5,BW] 593-0-593ms    | [S0,MB2,B]  600-11-611ms   | [S7,MB6,F]  614-16-630ms   | [S7,MB6,BI] 642-33-676ms   | [S7,MB6,BW] 676-0-676ms    | [S0,MB3,B]  686-11-697ms   | [S7,MB7,F]  700-16-716ms   | [S7,MB7,BI] 729-34-763ms   | [S7,MB7,BW] 763-25-788ms   | [S0,MB4,B]  790-18-808ms   | [S0,MB5,B]  809-23-832ms   | [S0,MB6,B]  834-25-859ms   | [S0,MB7,B]  860-11-871ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-12-21ms      | [S1,MB1,F]  27-10-38ms     | [S1,MB2,F]  44-10-55ms     | [S1,MB3,F]  62-10-73ms     | [S1,MB4,F]  85-10-96ms     | [S6,MB0,F]  96-10-106ms    | [S1,MB5,F]  106-13-119ms   | [S6,MB1,F]  119-8-128ms    | [S6,MB0,BI] 175-9-184ms    | [S6,MB0,BW] 184-10-194ms   | [S6,MB2,F]  194-7-201ms    | [S6,MB1,BI] 265-9-274ms    | [S6,MB1,BW] 274-10-285ms   | [S6,MB3,F]  285-7-292ms    | [S6,MB2,BI] 332-9-341ms    | [S6,MB2,BW] 341-10-352ms   | [S1,MB6,F]  352-10-363ms   | [S1,MB0,BI] 363-15-379ms   | [S1,MB0,BW] 379-0-379ms    | [S6,MB4,F]  379-7-387ms    | [S6,MB3,BI] 401-10-411ms   | [S6,MB3,BW] 412-10-422ms   | [S1,MB7,F]  433-13-447ms   | [S1,MB1,BI] 447-15-463ms   | [S1,MB1,BW] 463-9-472ms    | [S6,MB5,F]  473-7-480ms    | [S6,MB4,BI] 510-11-522ms   | [S6,MB4,BW] 522-10-533ms   | [S1,MB2,BI] 533-14-547ms   | [S1,MB2,BW] 547-11-559ms   | [S6,MB6,F]  600-7-607ms    | [S6,MB5,BI] 607-10-617ms   | [S6,MB5,BW] 617-10-628ms   | [S1,MB3,BI] 628-14-642ms   | [S1,MB3,BW] 642-12-654ms   | [S6,MB7,F]  686-7-693ms    | [S6,MB6,BI] 693-10-703ms   | [S6,MB6,BW] 703-10-714ms   | [S1,MB4,BI] 714-14-729ms   | [S6,MB7,BI] 765-10-775ms   | [S1,MB5,BI] 780-15-795ms   | [S1,MB4,BW] 795-5-800ms    | [S1,MB6,BI] 808-14-822ms   | [S1,MB5,BW] 822-0-823ms    | [S1,MB7,BI] 833-14-847ms   | [S1,MB6,BW] 847-0-847ms    | [S6,MB7,BW] 847-0-848ms    | [S1,MB7,BW] 848-0-848ms   
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-8-29ms      | [S2,MB1,F]  38-7-45ms      | [S2,MB2,F]  55-7-63ms      | [S5,MB0,F]  63-9-72ms      | [S2,MB3,F]  73-9-83ms      | [S5,MB1,F]  83-7-90ms      | [S2,MB4,F]  96-10-106ms    | [S5,MB2,F]  115-8-124ms    | [S5,MB0,BI] 184-9-193ms    | [S5,MB0,BW] 193-10-204ms   | [S5,MB3,F]  204-7-211ms    | [S5,MB1,BI] 275-9-284ms    | [S5,MB1,BW] 284-11-295ms   | [S2,MB5,F]  295-7-302ms    | [S2,MB0,BI] 302-10-313ms   | [S2,MB0,BW] 313-9-323ms    | [S5,MB4,F]  323-7-331ms    | [S5,MB2,BI] 341-10-352ms   | [S5,MB2,BW] 352-10-362ms   | [S2,MB6,F]  364-10-374ms   | [S2,MB1,BI] 375-11-386ms   | [S2,MB1,BW] 386-10-396ms   | [S5,MB5,F]  396-7-404ms    | [S5,MB3,BI] 438-11-449ms   | [S5,MB3,BW] 448-11-460ms   | [S2,MB7,F]  460-7-468ms    | [S2,MB2,BI] 468-10-479ms   | [S2,MB2,BW] 478-9-488ms    | [S5,MB6,F]  488-7-496ms    | [S5,MB4,BI] 522-10-532ms   | [S5,MB4,BW] 532-9-542ms    | [S2,MB3,BI] 603-9-612ms    | [S2,MB3,BW] 612-10-623ms   | [S5,MB7,F]  627-7-634ms    | [S5,MB5,BI] 634-9-644ms    | [S5,MB5,BW] 644-9-653ms    | [S2,MB4,BI] 688-9-698ms    | [S5,MB6,BI] 703-10-714ms   | [S2,MB5,BI] 714-10-724ms   | [S5,MB7,BI] 780-9-789ms    | [S2,MB6,BI] 790-11-801ms   | [S2,MB4,BW] 801-6-807ms    | [S2,MB7,BI] 816-9-825ms    | [S2,MB5,BW] 825-0-825ms    | [S5,MB6,BW] 826-10-836ms   | [S5,MB7,BW] 836-6-843ms    | [S2,MB6,BW] 843-0-843ms    | [S2,MB7,BW] 843-0-843ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-8-37ms      | [S4,MB0,F]  37-8-45ms      | [S3,MB1,F]  46-8-55ms      | [S4,MB1,F]  54-7-62ms      | [S3,MB2,F]  63-7-71ms      | [S4,MB2,F]  71-7-79ms      | [S3,MB3,F]  98-7-106ms     | [S4,MB3,F]  105-8-114ms    | [S4,MB0,BI] 193-9-203ms    | [S4,MB0,BW] 203-9-212ms    | [S3,MB4,F]  212-7-219ms    | [S3,MB0,BI] 219-9-229ms    | [S3,MB0,BW] 229-9-238ms    | [S4,MB4,F]  238-7-246ms    | [S4,MB1,BI] 284-10-294ms   | [S4,MB1,BW] 294-10-305ms   | [S3,MB5,F]  305-8-313ms    | [S3,MB1,BI] 313-9-322ms    | [S3,MB1,BW] 322-9-332ms    | [S4,MB5,F]  332-7-340ms    | [S4,MB2,BI] 368-11-380ms   | [S4,MB2,BW] 380-9-390ms    | [S3,MB6,F]  390-7-397ms    | [S3,MB2,BI] 397-9-407ms    | [S3,MB2,BW] 407-10-417ms   | [S4,MB6,F]  417-7-425ms    | [S4,MB3,BI] 453-10-464ms   | [S4,MB3,BW] 464-10-474ms   | [S3,MB7,F]  474-7-481ms    | [S3,MB3,BI] 482-9-491ms    | [S3,MB3,BW] 491-9-501ms    | [S4,MB7,F]  501-8-510ms    | [S4,MB4,BI] 596-10-607ms   | [S4,MB4,BW] 606-9-616ms    | [S3,MB4,BI] 616-10-627ms   | [S4,MB5,BI] 682-10-692ms   | [S3,MB5,BI] 692-9-701ms    | [S4,MB6,BI] 714-9-724ms    | [S3,MB6,BI] 723-9-733ms    | [S4,MB7,BI] 791-9-800ms    | [S3,MB7,BI] 800-9-810ms    | [S3,MB4,BW] 809-0-810ms    | [S4,MB5,BW] 809-10-820ms   | [S4,MB6,BW] 820-9-829ms    | [S4,MB7,BW] 829-6-836ms    | [S3,MB5,BW] 836-0-836ms    | [S3,MB6,BW] 836-0-836ms    | [S3,MB7,BW] 836-0-836ms   
[rank3]:2025-12-25 09:04:37,094 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank3/251225_0904_stage3_step200.svg
[rank1]:2025-12-25 09:04:37,144 - âœ… Scatter Plot of Stage 6 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251225_0904_stage6.svg
[rank0]:2025-12-25 09:04:37,159 - âœ… Scatter Plot of Stage 7 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251225_0904_stage7.svg
[rank3]:2025-12-25 09:04:37,138 - âœ… Frozen Ratio History of Rank 3 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank3/251225_0904_stage4_step200.svg
[rank2]:2025-12-25 09:04:37,142 - âœ… Scatter Plot of Stage 5 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251225_0904_stage5.svg
[rank3]:2025-12-25 09:04:37,316 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251225_0904_stage3.svg
[rank3]:2025-12-25 09:04:37,476 - âœ… Scatter Plot of Stage 4 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251225_0904_stage4.svg
[rank0]:2025-12-25 09:07:24,668 - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-12-25 09:07:25,151 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB0] 1.00/1.00, [MB3] 0.00/0.00, [MB1] 0.51/0.51, [MB4] 0.00/0.00, [MB2] 0.17/0.17, [MB5] 0.00/0.00, [MB3] 0.20/0.20, [MB6] 0.00/0.00, [MB4] 0.66/0.66, [MB5] 0.87/0.87, [MB6] 1.00/1.00, [MB7] 0.82/0.82, [MB7] 1.00/1.00
[rank2]:2025-12-25 09:07:25,144 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB0] 0.00/0.00, [MB2] 0.00/0.00, [MB1] 0.00/0.00, [MB3] 0.00/0.00, [MB2] 0.00/0.00, [MB4] 0.00/0.00, [MB3] 0.00/0.00, [MB5] 0.00/0.00, [MB4] 0.34/0.34, [MB5] 1.00/1.00, [MB6] 0.00/0.00, [MB7] 0.25/0.25, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank0]:2025-12-25 09:07:25,194 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB0] 1.00/1.00, [MB4] 1.00/1.00, [MB1] 1.00/1.00, [MB5] 1.00/1.00, [MB2] 1.00/1.00, [MB6] 1.00/1.00, [MB3] 1.00/1.00, [MB7] 0.40/0.40, [MB4] 0.75/0.75, [MB5] 0.32/0.32, [MB6] 0.39/0.39, [MB7] 0.93/0.93
[rank3]:2025-12-25 09:07:25,144 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.35/0.35, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-12-25 09:07:28,521 - Avg. fwd time: 9.8146 / Avg. bwd-weight time: 8.8374 / Avg. bwd-input time: 12.3443 / Avg. batch time: 935.2944 (ms) / GPU bubble ratio: 46.97%
[rank2]:2025-12-25 09:07:28,520 - Avg. fwd time: 8.2508 / Avg. bwd-weight time: 8.1190 / Avg. bwd-input time: 10.1367 / Avg. batch time: 910.3918 (ms) / GPU bubble ratio: 53.42%
[rank0]:2025-12-25 09:07:28,528 - Avg. fwd time: 13.5070 / Avg. full-bwd time: 17.6961 (Avg. bwd-weight time: 18.3849 / Avg. bwd-input time: 34.4537) / Avg. batch time: 960.6187 (ms) / GPU bubble ratio: 18.76%
[rank3]:2025-12-25 09:07:28,516 - Avg. fwd time: 7.8111 / Avg. bwd-weight time: 7.6468 / Avg. bwd-input time: 9.7695 / Avg. batch time: 898.0111 (ms) / GPU bubble ratio: 55.05%
[rank1]:2025-12-25 09:07:28,577 -  step: 250  loss: -4.0000  grad_norm:  1.7696  memory: 18.98GiB(39.95%)  tps: 9,532  tflops: 74.52  mfu: 23.88%
[rank2]:2025-12-25 09:07:28,574 -  step: 250  loss: -4.0000  grad_norm:  1.7696  memory: 14.74GiB(31.02%)  tps: 9,532  tflops: 74.52  mfu: 23.88%
[rank0]:2025-12-25 09:07:28,600 -  step: 250  loss:  0.4858  grad_norm:  1.7696  memory: 40.54GiB(85.33%)  tps: 9,532  tflops: 74.52  mfu: 23.88%
[rank3]:2025-12-25 09:07:28,574 -  step: 250  loss: -4.0000  grad_norm:  1.7696  memory: 16.18GiB(34.07%)  tps: 9,532  tflops: 74.52  mfu: 23.88%
[rank0]:2025-12-25 09:10:15,497 - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-12-25 09:10:16,007 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB0] 1.00/1.00, [MB3] 0.00/0.00, [MB1] 0.51/0.51, [MB4] 0.00/0.00, [MB2] 0.17/0.17, [MB5] 0.00/0.00, [MB3] 0.20/0.20, [MB6] 0.00/0.00, [MB4] 0.66/0.66, [MB5] 0.87/0.87, [MB6] 1.00/1.00, [MB7] 0.82/0.82, [MB7] 1.00/1.00
[rank2]:2025-12-25 09:10:16,001 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB0] 0.00/0.00, [MB2] 0.00/0.00, [MB1] 0.00/0.00, [MB3] 0.00/0.00, [MB2] 0.00/0.00, [MB4] 0.00/0.00, [MB3] 0.00/0.00, [MB5] 0.00/0.00, [MB4] 0.34/0.34, [MB5] 1.00/1.00, [MB6] 0.00/0.00, [MB7] 0.25/0.25, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank0]:2025-12-25 09:10:16,019 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB0] 1.00/1.00, [MB4] 1.00/1.00, [MB1] 1.00/1.00, [MB5] 1.00/1.00, [MB2] 1.00/1.00, [MB6] 1.00/1.00, [MB3] 1.00/1.00, [MB7] 0.40/0.40, [MB4] 0.75/0.75, [MB5] 0.32/0.32, [MB6] 0.39/0.39, [MB7] 0.93/0.93
[rank3]:2025-12-25 09:10:16,001 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.35/0.35, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-12-25 09:10:19,352 - Avg. fwd time: 9.8061 / Avg. bwd-weight time: 8.5156 / Avg. bwd-input time: 12.4031 / Avg. batch time: 911.1266 (ms) / GPU bubble ratio: 46.05%
[rank0]:2025-12-25 09:10:19,365 - Avg. fwd time: 13.4315 / Avg. full-bwd time: 16.0176 (Avg. bwd-weight time: 16.4184 / Avg. bwd-input time: 34.3756) / Avg. batch time: 936.2561 (ms) / GPU bubble ratio: 19.96%
[rank2]:2025-12-25 09:10:19,351 - Avg. fwd time: 8.2713 / Avg. bwd-weight time: 8.0767 / Avg. bwd-input time: 10.1727 / Avg. batch time: 887.5721 (ms) / GPU bubble ratio: 52.19%
[rank3]:2025-12-25 09:10:19,345 - Avg. fwd time: 7.8217 / Avg. bwd-weight time: 7.5644 / Avg. bwd-input time: 9.8107 / Avg. batch time: 874.7956 (ms) / GPU bubble ratio: 53.91%
[rank1]:2025-12-25 09:10:19,414 -  step: 300  loss: -4.0000  grad_norm:  0.3917  memory: 18.98GiB(39.95%)  tps: 9,590  tflops: 74.97  mfu: 24.03%
[rank0]:2025-12-25 09:10:19,437 -  step: 300  loss:  0.3018  grad_norm:  0.3917  memory: 40.54GiB(85.33%)  tps: 9,591  tflops: 74.97  mfu: 24.03%
[rank2]:2025-12-25 09:10:19,411 -  step: 300  loss: -4.0000  grad_norm:  0.3917  memory: 14.74GiB(31.02%)  tps: 9,590  tflops: 74.97  mfu: 24.03%
[rank3]:2025-12-25 09:10:19,411 -  step: 300  loss: -4.0000  grad_norm:  0.3917  memory: 16.18GiB(34.07%)  tps: 9,590  tflops: 74.97  mfu: 24.03%
[rank1]:2025-12-25 09:10:19,488 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank1/251225_0910_stage1_step300.svg
[rank1]:2025-12-25 09:10:19,528 - âœ… Frozen Ratio History of Rank 1 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank1/251225_0910_stage6_step300.svg
[rank0]:2025-12-25 09:10:19,487 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank0/251225_0910_stage0_step300.svg
[rank0]:2025-12-25 09:10:19,528 - âœ… Frozen Ratio History of Rank 0 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank0/251225_0910_stage7_step300.svg
[rank2]:2025-12-25 09:10:19,488 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank2/251225_0910_stage2_step300.svg
[rank2]:2025-12-25 09:10:19,528 - âœ… Frozen Ratio History of Rank 2 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank2/251225_0910_stage5_step300.svg
[rank3]:2025-12-25 09:10:19,753 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/pipeline_schedule/251225_0910_step300_rank3.svg
[rank3]:			> Batch Time: 811.48 ms, GPU Bubble Ratio: 27.52%, 42.13%, 47.25%, 50.75%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-8-34ms      | [S0,MB4,F]  34-7-41ms      | [S0,MB5,F]  41-9-51ms      | [S0,MB6,F]  51-8-60ms      | [S7,MB0,F]  112-17-129ms   | [S7,MB0,BI] 141-32-174ms   | [S7,MB0,BW] 174-27-202ms   | [S7,MB1,F]  201-16-218ms   | [S7,MB1,BI] 230-34-264ms   | [S7,MB1,BW] 264-0-264ms    | [S7,MB2,F]  264-17-281ms   | [S7,MB2,BI] 294-35-330ms   | [S7,MB2,BW] 330-0-330ms    | [S7,MB3,F]  330-18-348ms   | [S7,MB3,BI] 361-35-396ms   | [S7,MB3,BW] 396-0-396ms    | [S0,MB7,F]  396-10-407ms   | [S0,MB0,B]  407-0-407ms    | [S7,MB4,F]  415-18-433ms   | [S7,MB4,BI] 444-33-478ms   | [S7,MB4,BW] 478-0-478ms    | [S0,MB1,B]  485-0-485ms    | [S7,MB5,F]  489-17-507ms   | [S7,MB5,BI] 519-33-552ms   | [S7,MB5,BW] 552-0-552ms    | [S0,MB2,B]  559-0-559ms    | [S7,MB6,F]  573-15-588ms   | [S7,MB6,BI] 600-33-633ms   | [S7,MB6,BW] 634-0-634ms    | [S0,MB3,B]  640-0-640ms    | [S7,MB7,F]  654-15-669ms   | [S7,MB7,BI] 681-33-714ms   | [S7,MB7,BW] 715-26-741ms   | [S0,MB4,B]  740-12-753ms   | [S0,MB5,B]  755-16-771ms   | [S0,MB6,B]  778-16-794ms   | [S0,MB7,B]  802-8-811ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  27-10-38ms     | [S1,MB2,F]  44-10-55ms     | [S1,MB3,F]  61-10-72ms     | [S1,MB4,F]  84-10-95ms     | [S6,MB0,F]  95-10-106ms    | [S1,MB5,F]  106-13-119ms   | [S6,MB1,F]  119-8-128ms    | [S6,MB0,BI] 174-9-183ms    | [S6,MB0,BW] 183-10-194ms   | [S6,MB2,F]  194-7-201ms    | [S6,MB1,BI] 264-9-273ms    | [S6,MB1,BW] 273-10-283ms   | [S6,MB3,F]  283-7-291ms    | [S6,MB2,BI] 330-9-339ms    | [S6,MB2,BW] 339-10-350ms   | [S1,MB6,F]  350-10-361ms   | [S1,MB0,BI] 361-15-377ms   | [S1,MB0,BW] 377-0-377ms    | [S6,MB4,F]  377-8-385ms    | [S6,MB3,BI] 396-11-408ms   | [S6,MB3,BW] 408-11-420ms   | [S1,MB7,F]  420-11-431ms   | [S1,MB1,BI] 431-16-447ms   | [S1,MB1,BW] 447-5-453ms    | [S6,MB5,F]  452-8-460ms    | [S6,MB4,BI] 478-12-490ms   | [S6,MB4,BW] 491-10-502ms   | [S1,MB2,BI] 502-14-516ms   | [S1,MB2,BW] 516-13-529ms   | [S6,MB6,F]  558-7-566ms    | [S6,MB5,BI] 565-10-576ms   | [S6,MB5,BW] 576-10-586ms   | [S1,MB3,BI] 586-14-601ms   | [S1,MB3,BW] 601-10-611ms   | [S6,MB7,F]  640-7-647ms    | [S6,MB6,BI] 647-10-657ms   | [S6,MB6,BW] 657-10-668ms   | [S1,MB4,BI] 668-14-683ms   | [S6,MB7,BI] 716-10-727ms   | [S1,MB5,BI] 728-15-743ms   | [S1,MB4,BW] 743-4-748ms    | [S1,MB6,BI] 756-14-771ms   | [S1,MB5,BW] 771-0-772ms    | [S1,MB7,BI] 781-14-795ms   | [S1,MB6,BW] 795-0-795ms    | [S6,MB7,BW] 795-0-796ms    | [S1,MB7,BW] 796-0-796ms   
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  38-7-45ms      | [S2,MB2,F]  55-7-62ms      | [S5,MB0,F]  62-9-72ms      | [S2,MB3,F]  73-9-82ms      | [S5,MB1,F]  82-7-90ms      | [S2,MB4,F]  96-10-106ms    | [S5,MB2,F]  114-8-123ms    | [S5,MB0,BI] 184-9-193ms    | [S5,MB0,BW] 193-10-204ms   | [S5,MB3,F]  203-7-211ms    | [S5,MB1,BI] 273-9-283ms    | [S5,MB1,BW] 282-11-294ms   | [S2,MB5,F]  294-7-301ms    | [S2,MB0,BI] 301-10-312ms   | [S2,MB0,BW] 312-9-322ms    | [S5,MB4,F]  321-7-329ms    | [S5,MB2,BI] 339-10-350ms   | [S5,MB2,BW] 350-10-360ms   | [S2,MB6,F]  362-10-372ms   | [S2,MB1,BI] 373-11-385ms   | [S2,MB1,BW] 385-10-395ms   | [S5,MB5,F]  395-7-403ms    | [S5,MB3,BI] 412-11-423ms   | [S5,MB3,BW] 423-11-434ms   | [S2,MB7,F]  434-9-444ms    | [S2,MB2,BI] 444-11-456ms   | [S2,MB2,BW] 456-10-466ms   | [S5,MB6,F]  466-8-474ms    | [S5,MB4,BI] 491-10-502ms   | [S5,MB4,BW] 502-9-512ms    | [S2,MB3,BI] 561-9-571ms    | [S2,MB3,BW] 571-10-582ms   | [S5,MB7,F]  585-7-593ms    | [S5,MB5,BI] 593-9-603ms    | [S5,MB5,BW] 602-9-612ms    | [S2,MB4,BI] 643-9-653ms    | [S5,MB6,BI] 657-10-668ms   | [S2,MB5,BI] 668-10-678ms   | [S5,MB7,BI] 729-9-738ms    | [S2,MB6,BI] 738-11-750ms   | [S2,MB4,BW] 749-6-756ms    | [S2,MB7,BI] 764-9-774ms    | [S2,MB5,BW] 774-0-774ms    | [S5,MB6,BW] 774-10-784ms   | [S5,MB7,BW] 784-8-793ms    | [S2,MB6,BW] 793-0-793ms    | [S2,MB7,BW] 793-0-793ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-7-37ms      | [S4,MB0,F]  37-8-45ms      | [S3,MB1,F]  46-8-54ms      | [S4,MB1,F]  54-7-62ms      | [S3,MB2,F]  63-7-71ms      | [S4,MB2,F]  71-7-78ms      | [S3,MB3,F]  98-7-105ms     | [S4,MB3,F]  105-8-113ms    | [S4,MB0,BI] 193-9-202ms    | [S4,MB0,BW] 202-9-212ms    | [S3,MB4,F]  212-7-219ms    | [S3,MB0,BI] 219-9-228ms    | [S3,MB0,BW] 228-9-238ms    | [S4,MB4,F]  238-8-246ms    | [S4,MB1,BI] 283-10-293ms   | [S4,MB1,BW] 293-10-303ms   | [S3,MB5,F]  303-8-311ms    | [S3,MB1,BI] 311-9-321ms    | [S3,MB1,BW] 321-9-331ms    | [S4,MB5,F]  331-7-338ms    | [S4,MB2,BI] 366-11-378ms   | [S4,MB2,BW] 378-9-388ms    | [S3,MB6,F]  388-7-395ms    | [S3,MB2,BI] 395-9-405ms    | [S3,MB2,BW] 405-10-415ms   | [S4,MB6,F]  415-7-423ms    | [S4,MB3,BI] 438-12-450ms   | [S4,MB3,BW] 450-9-460ms    | [S3,MB7,F]  460-7-467ms    | [S3,MB3,BI] 467-9-477ms    | [S3,MB3,BW] 477-10-487ms   | [S4,MB7,F]  487-8-496ms    | [S4,MB4,BI] 555-10-565ms   | [S4,MB4,BW] 565-9-575ms    | [S3,MB4,BI] 575-10-586ms   | [S4,MB5,BI] 637-10-647ms   | [S3,MB5,BI] 647-9-656ms    | [S4,MB6,BI] 669-9-678ms    | [S3,MB6,BI] 678-9-688ms    | [S4,MB7,BI] 740-9-749ms    | [S3,MB7,BI] 749-9-758ms    | [S3,MB4,BW] 759-0-759ms    | [S4,MB5,BW] 759-10-769ms   | [S4,MB6,BW] 769-9-778ms    | [S4,MB7,BW] 779-4-784ms    | [S3,MB5,BW] 784-0-784ms    | [S3,MB6,BW] 784-0-784ms    | [S3,MB7,BW] 784-0-784ms   
[rank1]:2025-12-25 09:10:19,824 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251225_0910_stage1.svg
[rank0]:2025-12-25 09:10:19,824 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251225_0910_stage0.svg
[rank2]:2025-12-25 09:10:19,824 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251225_0910_stage2.svg
[rank3]:2025-12-25 09:10:19,793 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank3/251225_0910_stage3_step300.svg
[rank3]:2025-12-25 09:10:19,834 - âœ… Frozen Ratio History of Rank 3 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank3/251225_0910_stage4_step300.svg
[rank1]:2025-12-25 09:10:20,108 - âœ… Scatter Plot of Stage 6 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251225_0910_stage6.svg
[rank0]:2025-12-25 09:10:20,120 - âœ… Scatter Plot of Stage 7 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251225_0910_stage7.svg
[rank2]:2025-12-25 09:10:20,102 - âœ… Scatter Plot of Stage 5 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251225_0910_stage5.svg
[rank3]:2025-12-25 09:10:20,136 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251225_0910_stage3.svg
[rank3]:2025-12-25 09:10:20,424 - âœ… Scatter Plot of Stage 4 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251225_0910_stage4.svg
[rank0]:2025-12-25 09:13:07,944 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-25 09:13:11,817 - Avg. fwd time: 7.8300 / Avg. bwd-weight time: 7.5021 / Avg. bwd-input time: 9.8404 / Avg. batch time: 858.6356 (ms) / GPU bubble ratio: 53.09%
[rank3]:2025-12-25 09:13:11,876 -  step: 350  loss: -4.0000  grad_norm:  0.3605  memory: 16.18GiB(34.07%)  tps: 9,500  tflops: 74.27  mfu: 23.80%
[rank1]:2025-12-25 09:13:11,823 - Avg. fwd time: 9.8003 / Avg. bwd-weight time: 8.3014 / Avg. bwd-input time: 12.4415 / Avg. batch time: 894.5346 (ms) / GPU bubble ratio: 45.37%
[rank1]:2025-12-25 09:13:11,879 -  step: 350  loss: -4.0000  grad_norm:  0.3605  memory: 18.98GiB(39.95%)  tps: 9,500  tflops: 74.27  mfu: 23.80%
[rank0]:2025-12-25 09:13:11,830 - Avg. fwd time: 13.3733 / Avg. full-bwd time: 14.8264 (Avg. bwd-weight time: 14.9233 / Avg. bwd-input time: 34.3190) / Avg. batch time: 919.5492 (ms) / GPU bubble ratio: 20.99%
[rank0]:2025-12-25 09:13:11,902 -  step: 350  loss:  0.2399  grad_norm:  0.3605  memory: 40.54GiB(85.33%)  tps: 9,500  tflops: 74.27  mfu: 23.80%
[rank2]:2025-12-25 09:13:11,824 - Avg. fwd time: 8.2858 / Avg. bwd-weight time: 8.0441 / Avg. bwd-input time: 10.1993 / Avg. batch time: 871.9695 (ms) / GPU bubble ratio: 51.32%
[rank2]:2025-12-25 09:13:11,876 -  step: 350  loss: -4.0000  grad_norm:  0.3605  memory: 14.74GiB(31.02%)  tps: 9,500  tflops: 74.27  mfu: 23.80%
[rank0]:2025-12-25 09:15:59,030 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-25 09:16:02,905 - Avg. fwd time: 7.8355 / Avg. bwd-weight time: 7.4539 / Avg. bwd-input time: 9.8612 / Avg. batch time: 846.4057 (ms) / GPU bubble ratio: 52.46%
[rank0]:2025-12-25 09:16:02,920 - Avg. fwd time: 13.3293 / Avg. full-bwd time: 13.8915 (Avg. bwd-weight time: 13.8055 / Avg. bwd-input time: 34.2723) / Avg. batch time: 906.4098 (ms) / GPU bubble ratio: 21.78%
[rank1]:2025-12-25 09:16:02,909 - Avg. fwd time: 9.7967 / Avg. bwd-weight time: 8.1260 / Avg. bwd-input time: 12.4689 / Avg. batch time: 881.8307 (ms) / GPU bubble ratio: 44.86%
[rank2]:2025-12-25 09:16:02,908 - Avg. fwd time: 8.2964 / Avg. bwd-weight time: 8.0242 / Avg. bwd-input time: 10.2176 / Avg. batch time: 859.9687 (ms) / GPU bubble ratio: 50.62%
[rank3]:2025-12-25 09:16:02,961 -  step: 400  loss: -4.0000  grad_norm:  0.4072  memory: 16.18GiB(34.07%)  tps: 9,577  tflops: 74.86  mfu: 24.00%
[rank0]:2025-12-25 09:16:02,973 -  step: 400  loss:  0.2225  grad_norm:  0.4072  memory: 40.54GiB(85.33%)  tps: 9,577  tflops: 74.87  mfu: 24.00%
[rank0]:2025-12-25 09:16:03,029 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank0/251225_0916_stage0_step400.svg
[rank1]:2025-12-25 09:16:02,965 -  step: 400  loss: -4.0000  grad_norm:  0.4072  memory: 18.98GiB(39.95%)  tps: 9,577  tflops: 74.86  mfu: 24.00%
[rank1]:2025-12-25 09:16:03,028 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank1/251225_0916_stage1_step400.svg
[rank2]:2025-12-25 09:16:02,961 -  step: 400  loss: -4.0000  grad_norm:  0.4072  memory: 14.74GiB(31.02%)  tps: 9,577  tflops: 74.86  mfu: 24.00%
[rank2]:2025-12-25 09:16:03,028 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank2/251225_0916_stage2_step400.svg
[rank0]:2025-12-25 09:16:03,075 - âœ… Frozen Ratio History of Rank 0 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank0/251225_0916_stage7_step400.svg
[rank1]:2025-12-25 09:16:03,073 - âœ… Frozen Ratio History of Rank 1 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank1/251225_0916_stage6_step400.svg
[rank2]:2025-12-25 09:16:03,074 - âœ… Frozen Ratio History of Rank 2 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank2/251225_0916_stage5_step400.svg
[rank3]:2025-12-25 09:16:03,299 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/pipeline_schedule/251225_0916_step400_rank3.svg
[rank3]:			> Batch Time: 810.70 ms, GPU Bubble Ratio: 29.65%, 41.89%, 47.29%, 50.66%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-8-33ms      | [S0,MB4,F]  33-7-41ms      | [S0,MB5,F]  41-9-51ms      | [S0,MB6,F]  51-8-59ms      | [S7,MB0,F]  113-17-130ms   | [S7,MB0,BI] 142-32-174ms   | [S7,MB0,BW] 175-27-202ms   | [S7,MB1,F]  201-17-218ms   | [S7,MB1,BI] 231-34-265ms   | [S7,MB1,BW] 264-0-264ms    | [S7,MB2,F]  264-17-282ms   | [S7,MB2,BI] 295-35-330ms   | [S7,MB2,BW] 330-0-330ms    | [S7,MB3,F]  330-19-350ms   | [S7,MB3,BI] 361-35-396ms   | [S7,MB3,BW] 396-0-396ms    | [S0,MB7,F]  396-10-407ms   | [S0,MB0,B]  407-0-407ms    | [S7,MB4,F]  415-18-434ms   | [S7,MB4,BI] 445-33-479ms   | [S7,MB4,BW] 480-0-480ms    | [S0,MB1,B]  487-0-487ms    | [S7,MB5,F]  491-17-508ms   | [S7,MB5,BI] 520-33-554ms   | [S7,MB5,BW] 554-0-554ms    | [S0,MB2,B]  561-0-561ms    | [S7,MB6,F]  575-15-590ms   | [S7,MB6,BI] 603-33-636ms   | [S7,MB6,BW] 636-0-636ms    | [S0,MB3,B]  643-0-643ms    | [S7,MB7,F]  657-15-672ms   | [S7,MB7,BI] 684-33-717ms   | [S7,MB7,BW] 717-4-721ms    | [S0,MB4,B]  725-12-738ms   | [S0,MB5,B]  752-16-768ms   | [S0,MB6,B]  778-20-799ms   | [S0,MB7,B]  802-8-810ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  27-10-38ms     | [S1,MB2,F]  44-10-55ms     | [S1,MB3,F]  61-10-72ms     | [S1,MB4,F]  85-10-96ms     | [S6,MB0,F]  96-10-106ms    | [S1,MB5,F]  106-13-119ms   | [S6,MB1,F]  119-8-128ms    | [S6,MB0,BI] 175-9-184ms    | [S6,MB0,BW] 184-10-194ms   | [S6,MB2,F]  194-7-201ms    | [S6,MB1,BI] 264-9-274ms    | [S6,MB1,BW] 274-10-284ms   | [S6,MB3,F]  284-7-291ms    | [S6,MB2,BI] 330-9-339ms    | [S6,MB2,BW] 339-10-350ms   | [S1,MB6,F]  350-11-361ms   | [S1,MB0,BI] 361-15-377ms   | [S1,MB0,BW] 377-0-377ms    | [S6,MB4,F]  377-8-385ms    | [S6,MB3,BI] 396-11-408ms   | [S6,MB3,BW] 408-11-420ms   | [S1,MB7,F]  420-11-432ms   | [S1,MB1,BI] 432-16-448ms   | [S1,MB1,BW] 448-6-455ms    | [S6,MB5,F]  454-8-463ms    | [S6,MB4,BI] 480-12-492ms   | [S6,MB4,BW] 492-10-503ms   | [S1,MB2,BI] 503-14-518ms   | [S1,MB2,BW] 518-12-530ms   | [S6,MB6,F]  560-7-568ms    | [S6,MB5,BI] 568-10-578ms   | [S6,MB5,BW] 578-10-589ms   | [S1,MB3,BI] 589-14-603ms   | [S1,MB3,BW] 603-10-614ms   | [S6,MB7,F]  642-7-650ms    | [S6,MB6,BI] 650-10-660ms   | [S6,MB6,BW] 660-10-671ms   | [S1,MB4,BI] 671-14-685ms   | [S6,MB7,BI] 717-10-728ms   | [S1,MB5,BI] 729-14-744ms   | [S1,MB4,BW] 743-3-747ms    | [S1,MB6,BI] 757-14-771ms   | [S1,MB5,BW] 771-0-772ms    | [S1,MB7,BI] 781-14-795ms   | [S1,MB6,BW] 795-0-795ms    | [S6,MB7,BW] 795-0-796ms    | [S1,MB7,BW] 796-0-796ms   
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  38-7-45ms      | [S2,MB2,F]  55-7-63ms      | [S5,MB0,F]  63-9-72ms      | [S2,MB3,F]  73-9-82ms      | [S5,MB1,F]  82-7-90ms      | [S2,MB4,F]  96-10-106ms    | [S5,MB2,F]  115-8-124ms    | [S5,MB0,BI] 184-9-194ms    | [S5,MB0,BW] 194-10-204ms   | [S5,MB3,F]  204-7-211ms    | [S5,MB1,BI] 274-9-283ms    | [S5,MB1,BW] 283-11-294ms   | [S2,MB5,F]  294-7-302ms    | [S2,MB0,BI] 302-10-312ms   | [S2,MB0,BW] 312-9-322ms    | [S5,MB4,F]  322-7-330ms    | [S5,MB2,BI] 340-10-351ms   | [S5,MB2,BW] 350-10-361ms   | [S2,MB6,F]  362-10-372ms   | [S2,MB1,BI] 374-11-385ms   | [S2,MB1,BW] 385-10-395ms   | [S5,MB5,F]  395-7-403ms    | [S5,MB3,BI] 412-11-424ms   | [S5,MB3,BW] 424-10-435ms   | [S2,MB7,F]  435-9-445ms    | [S2,MB2,BI] 445-11-456ms   | [S2,MB2,BW] 456-10-467ms   | [S5,MB6,F]  466-8-475ms    | [S5,MB4,BI] 492-10-503ms   | [S5,MB4,BW] 503-9-513ms    | [S2,MB3,BI] 563-9-573ms    | [S2,MB3,BW] 573-10-584ms   | [S5,MB7,F]  587-7-595ms    | [S5,MB5,BI] 595-9-605ms    | [S5,MB5,BW] 605-9-615ms    | [S2,MB4,BI] 645-9-655ms    | [S5,MB6,BI] 660-10-671ms   | [S2,MB5,BI] 670-10-681ms   | [S5,MB7,BI] 729-9-738ms    | [S2,MB6,BI] 738-11-750ms   | [S2,MB4,BW] 749-9-759ms    | [S2,MB7,BI] 765-9-774ms    | [S2,MB5,BW] 774-0-774ms    | [S5,MB6,BW] 774-10-785ms   | [S5,MB7,BW] 784-5-790ms    | [S2,MB6,BW] 790-0-790ms    | [S2,MB7,BW] 790-0-790ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-8-37ms      | [S4,MB0,F]  37-8-45ms      | [S3,MB1,F]  46-8-54ms      | [S4,MB1,F]  54-7-62ms      | [S3,MB2,F]  63-7-71ms      | [S4,MB2,F]  71-7-79ms      | [S3,MB3,F]  98-7-105ms     | [S4,MB3,F]  106-8-114ms    | [S4,MB0,BI] 194-9-203ms    | [S4,MB0,BW] 203-9-212ms    | [S3,MB4,F]  212-7-219ms    | [S3,MB0,BI] 219-9-229ms    | [S3,MB0,BW] 229-9-239ms    | [S4,MB4,F]  238-7-246ms    | [S4,MB1,BI] 283-10-294ms   | [S4,MB1,BW] 294-10-304ms   | [S3,MB5,F]  304-8-312ms    | [S3,MB1,BI] 312-9-322ms    | [S3,MB1,BW] 322-9-331ms    | [S4,MB5,F]  331-7-339ms    | [S4,MB2,BI] 367-11-379ms   | [S4,MB2,BW] 378-9-388ms    | [S3,MB6,F]  388-7-396ms    | [S3,MB2,BI] 396-9-405ms    | [S3,MB2,BW] 405-10-415ms   | [S4,MB6,F]  415-7-423ms    | [S4,MB3,BI] 438-12-451ms   | [S4,MB3,BW] 451-9-461ms    | [S3,MB7,F]  460-7-468ms    | [S3,MB3,BI] 468-9-478ms    | [S3,MB3,BW] 478-10-488ms   | [S4,MB7,F]  488-8-497ms    | [S4,MB4,BI] 557-10-567ms   | [S4,MB4,BW] 567-9-577ms    | [S3,MB4,BI] 577-10-588ms   | [S4,MB5,BI] 639-10-649ms   | [S3,MB5,BI] 649-9-658ms    | [S4,MB6,BI] 671-9-681ms    | [S3,MB6,BI] 681-9-690ms    | [S4,MB7,BI] 740-9-749ms    | [S3,MB7,BI] 749-9-758ms    | [S3,MB4,BW] 759-0-759ms    | [S4,MB5,BW] 759-10-769ms   | [S4,MB6,BW] 769-9-778ms    | [S4,MB7,BW] 779-5-784ms    | [S3,MB5,BW] 784-0-784ms    | [S3,MB6,BW] 784-0-784ms    | [S3,MB7,BW] 784-0-784ms   
[rank3]:2025-12-25 09:16:03,342 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank3/251225_0916_stage3_step400.svg
[rank3]:2025-12-25 09:16:03,387 - âœ… Frozen Ratio History of Rank 3 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank3/251225_0916_stage4_step400.svg
[rank0]:2025-12-25 09:16:03,506 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251225_0916_stage0.svg
[rank1]:2025-12-25 09:16:03,503 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251225_0916_stage1.svg
[rank2]:2025-12-25 09:16:03,495 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251225_0916_stage2.svg
[rank3]:2025-12-25 09:16:03,821 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251225_0916_stage3.svg
[rank1]:2025-12-25 09:16:03,917 - âœ… Scatter Plot of Stage 6 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251225_0916_stage6.svg
[rank2]:2025-12-25 09:16:03,903 - âœ… Scatter Plot of Stage 5 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251225_0916_stage5.svg
[rank0]:2025-12-25 09:16:03,936 - âœ… Scatter Plot of Stage 7 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251225_0916_stage7.svg
[rank3]:2025-12-25 09:16:04,253 - âœ… Scatter Plot of Stage 4 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251225_0916_stage4.svg
[rank0]:2025-12-25 09:16:23,073 - Dataset alpaca_gpt4 is being re-looped
[rank3]:2025-12-25 09:16:23,541 - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-12-25 09:16:23,548 - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-12-25 09:16:23,543 - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-12-25 09:18:50,501 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-25 09:18:54,349 - Avg. fwd time: 7.8397 / Avg. bwd-weight time: 7.4212 / Avg. bwd-input time: 9.8771 / Avg. batch time: 836.7415 (ms) / GPU bubble ratio: 51.93%
[rank1]:2025-12-25 09:18:54,356 - Avg. fwd time: 9.7928 / Avg. bwd-weight time: 7.9882 / Avg. bwd-input time: 12.4883 / Avg. batch time: 871.8805 (ms) / GPU bubble ratio: 44.45%
[rank0]:2025-12-25 09:18:54,368 - Avg. fwd time: 13.2965 / Avg. full-bwd time: 13.1500 (Avg. bwd-weight time: 13.0025 / Avg. bwd-input time: 34.2349) / Avg. batch time: 896.1425 (ms) / GPU bubble ratio: 22.35%
[rank2]:2025-12-25 09:18:54,355 - Avg. fwd time: 8.3035 / Avg. bwd-weight time: 8.0031 / Avg. bwd-input time: 10.2302 / Avg. batch time: 850.5629 (ms) / GPU bubble ratio: 50.08%
[rank3]:2025-12-25 09:18:54,414 -  step: 450  loss: -4.0000  grad_norm:  6.9765  memory: 16.18GiB(34.07%)  tps: 9,556  tflops: 74.70  mfu: 23.94%
[rank1]:2025-12-25 09:18:54,417 -  step: 450  loss: -4.0000  grad_norm:  6.9765  memory: 18.98GiB(39.95%)  tps: 9,556  tflops: 74.70  mfu: 23.94%
[rank0]:2025-12-25 09:18:54,440 -  step: 450  loss:  0.2387  grad_norm:  6.9765  memory: 40.54GiB(85.33%)  tps: 9,555  tflops: 74.70  mfu: 23.94%
[rank2]:2025-12-25 09:18:54,414 -  step: 450  loss: -4.0000  grad_norm:  6.9765  memory: 14.74GiB(31.02%)  tps: 9,556  tflops: 74.70  mfu: 23.94%
[rank0]:2025-12-25 09:21:41,696 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-25 09:21:45,538 - Avg. fwd time: 7.8430 / Avg. bwd-weight time: 7.3937 / Avg. bwd-input time: 9.8890 / Avg. batch time: 829.0702 (ms) / GPU bubble ratio: 51.51%
[rank1]:2025-12-25 09:21:45,545 - Avg. fwd time: 9.7906 / Avg. bwd-weight time: 7.8885 / Avg. bwd-input time: 12.5049 / Avg. batch time: 863.8645 (ms) / GPU bubble ratio: 44.09%
[rank0]:2025-12-25 09:21:45,557 - Avg. fwd time: 13.2668 / Avg. full-bwd time: 12.6100 (Avg. bwd-weight time: 12.3517 / Avg. bwd-input time: 34.2026) / Avg. batch time: 888.0365 (ms) / GPU bubble ratio: 22.80%
[rank2]:2025-12-25 09:21:45,545 - Avg. fwd time: 8.3084 / Avg. bwd-weight time: 7.9936 / Avg. bwd-input time: 10.2395 / Avg. batch time: 842.9939 (ms) / GPU bubble ratio: 49.62%
[rank2]:2025-12-25 09:21:45,603 -  step: 500  loss: -4.0000  grad_norm:  0.3112  memory: 14.74GiB(31.02%)  tps: 9,571  tflops: 74.82  mfu: 23.98%
[rank3]:2025-12-25 09:21:45,603 -  step: 500  loss: -4.0000  grad_norm:  0.3112  memory: 16.18GiB(34.07%)  tps: 9,571  tflops: 74.82  mfu: 23.98%
[rank1]:2025-12-25 09:21:45,605 -  step: 500  loss: -4.0000  grad_norm:  0.3112  memory: 18.98GiB(39.95%)  tps: 9,571  tflops: 74.82  mfu: 23.98%
[rank1]:2025-12-25 09:21:45,679 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank1/251225_0921_stage1_step500.svg
[rank0]:2025-12-25 09:21:45,628 -  step: 500  loss:  0.2277  grad_norm:  0.3112  memory: 40.54GiB(85.33%)  tps: 9,571  tflops: 74.82  mfu: 23.98%
[rank0]:2025-12-25 09:21:45,681 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank0/251225_0921_stage0_step500.svg
[rank2]:2025-12-25 09:21:45,680 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank2/251225_0921_stage2_step500.svg
[rank2]:2025-12-25 09:21:45,720 - âœ… Frozen Ratio History of Rank 2 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank2/251225_0921_stage5_step500.svg
[rank1]:2025-12-25 09:21:45,719 - âœ… Frozen Ratio History of Rank 1 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank1/251225_0921_stage6_step500.svg
[rank0]:2025-12-25 09:21:45,724 - âœ… Frozen Ratio History of Rank 0 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank0/251225_0921_stage7_step500.svg
[rank3]:2025-12-25 09:21:45,958 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/pipeline_schedule/251225_0921_step500_rank3.svg
[rank3]:			> Batch Time: 810.03 ms, GPU Bubble Ratio: 26.96%, 41.60%, 47.75%, 50.79%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-8-33ms      | [S0,MB4,F]  33-8-41ms      | [S0,MB5,F]  41-9-51ms      | [S0,MB6,F]  51-8-60ms      | [S7,MB0,F]  112-17-129ms   | [S7,MB0,BI] 141-32-174ms   | [S7,MB0,BW] 174-25-200ms   | [S7,MB1,F]  200-16-217ms   | [S7,MB1,BI] 229-34-263ms   | [S7,MB1,BW] 263-0-263ms    | [S7,MB2,F]  263-18-281ms   | [S7,MB2,BI] 293-35-328ms   | [S7,MB2,BW] 328-0-328ms    | [S7,MB3,F]  328-18-347ms   | [S7,MB3,BI] 359-35-394ms   | [S7,MB3,BW] 395-0-395ms    | [S0,MB7,F]  395-10-405ms   | [S0,MB0,B]  404-0-404ms    | [S7,MB4,F]  412-18-431ms   | [S7,MB4,BI] 442-34-476ms   | [S7,MB4,BW] 476-0-476ms    | [S0,MB1,B]  483-0-483ms    | [S7,MB5,F]  487-17-505ms   | [S7,MB5,BI] 517-33-550ms   | [S7,MB5,BW] 551-0-551ms    | [S0,MB2,B]  558-0-558ms    | [S7,MB6,F]  572-15-587ms   | [S7,MB6,BI] 599-33-632ms   | [S7,MB6,BW] 632-0-632ms    | [S0,MB3,B]  639-0-639ms    | [S7,MB7,F]  653-14-667ms   | [S7,MB7,BI] 680-32-712ms   | [S7,MB7,BW] 712-25-738ms   | [S0,MB4,B]  738-13-751ms   | [S0,MB5,B]  755-23-779ms   | [S0,MB6,B]  781-20-801ms   | [S0,MB7,B]  806-3-810ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  27-10-38ms     | [S1,MB2,F]  44-10-55ms     | [S1,MB3,F]  61-10-72ms     | [S1,MB4,F]  84-10-95ms     | [S6,MB0,F]  95-10-106ms    | [S1,MB5,F]  106-13-119ms   | [S6,MB1,F]  119-8-127ms    | [S6,MB0,BI] 174-9-183ms    | [S6,MB0,BW] 183-10-194ms   | [S6,MB2,F]  193-7-201ms    | [S6,MB1,BI] 263-9-272ms    | [S6,MB1,BW] 272-10-282ms   | [S6,MB3,F]  282-7-290ms    | [S6,MB2,BI] 328-9-338ms    | [S6,MB2,BW] 338-10-348ms   | [S1,MB6,F]  348-10-359ms   | [S1,MB0,BI] 359-15-375ms   | [S1,MB0,BW] 375-0-375ms    | [S6,MB4,F]  375-7-383ms    | [S6,MB3,BI] 395-11-407ms   | [S6,MB3,BW] 407-11-418ms   | [S1,MB7,F]  419-11-430ms   | [S1,MB1,BI] 430-16-446ms   | [S1,MB1,BW] 446-8-455ms    | [S6,MB5,F]  454-8-462ms    | [S6,MB4,BI] 476-12-489ms   | [S6,MB4,BW] 489-10-500ms   | [S1,MB2,BI] 500-14-514ms   | [S1,MB2,BW] 514-12-526ms   | [S6,MB6,F]  557-7-565ms    | [S6,MB5,BI] 565-10-575ms   | [S6,MB5,BW] 575-10-586ms   | [S1,MB3,BI] 586-14-600ms   | [S1,MB3,BW] 600-11-612ms   | [S6,MB7,F]  638-7-645ms    | [S6,MB6,BI] 645-10-656ms   | [S6,MB6,BW] 656-10-667ms   | [S1,MB4,BI] 667-14-681ms   | [S6,MB7,BI] 713-10-724ms   | [S1,MB5,BI] 729-15-744ms   | [S1,MB4,BW] 745-5-750ms    | [S1,MB6,BI] 760-14-774ms   | [S1,MB5,BW] 774-0-775ms    | [S1,MB7,BI] 784-14-798ms   | [S1,MB6,BW] 798-0-798ms    | [S6,MB7,BW] 798-0-799ms    | [S1,MB7,BW] 799-0-799ms   
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  38-7-45ms      | [S2,MB2,F]  55-7-62ms      | [S5,MB0,F]  62-9-72ms      | [S2,MB3,F]  73-9-82ms      | [S5,MB1,F]  82-7-90ms      | [S2,MB4,F]  96-10-106ms    | [S5,MB2,F]  114-8-123ms    | [S5,MB0,BI] 183-9-193ms    | [S5,MB0,BW] 193-10-203ms   | [S5,MB3,F]  203-7-210ms    | [S5,MB1,BI] 272-9-282ms    | [S5,MB1,BW] 282-11-293ms   | [S2,MB5,F]  293-7-300ms    | [S2,MB0,BI] 300-10-311ms   | [S2,MB0,BW] 311-9-321ms    | [S5,MB4,F]  321-7-328ms    | [S5,MB2,BI] 338-10-349ms   | [S5,MB2,BW] 349-10-359ms   | [S2,MB6,F]  360-9-370ms    | [S2,MB1,BI] 372-11-383ms   | [S2,MB1,BW] 383-10-393ms   | [S5,MB5,F]  393-7-401ms    | [S5,MB3,BI] 409-10-420ms   | [S5,MB3,BW] 420-10-431ms   | [S2,MB7,F]  431-9-441ms    | [S2,MB2,BI] 443-11-454ms   | [S2,MB2,BW] 454-10-465ms   | [S5,MB6,F]  465-7-473ms    | [S5,MB4,BI] 489-11-500ms   | [S5,MB4,BW] 500-9-510ms    | [S2,MB3,BI] 560-9-570ms    | [S2,MB3,BW] 570-10-581ms   | [S5,MB7,F]  585-7-592ms    | [S5,MB5,BI] 592-9-602ms    | [S5,MB5,BW] 602-9-612ms    | [S2,MB4,BI] 641-9-651ms    | [S5,MB6,BI] 656-10-666ms   | [S2,MB5,BI] 666-10-677ms   | [S5,MB7,BI] 732-9-741ms    | [S2,MB6,BI] 741-11-753ms   | [S2,MB4,BW] 753-6-759ms    | [S2,MB7,BI] 768-9-777ms    | [S2,MB5,BW] 778-0-778ms    | [S5,MB6,BW] 778-10-788ms   | [S5,MB7,BW] 788-5-794ms    | [S2,MB6,BW] 794-0-794ms    | [S2,MB7,BW] 794-0-794ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-7-37ms      | [S4,MB0,F]  37-8-45ms      | [S3,MB1,F]  46-8-54ms      | [S4,MB1,F]  54-7-62ms      | [S3,MB2,F]  63-7-71ms      | [S4,MB2,F]  70-7-78ms      | [S3,MB3,F]  97-7-105ms     | [S4,MB3,F]  105-8-113ms    | [S4,MB0,BI] 193-9-202ms    | [S4,MB0,BW] 202-9-212ms    | [S3,MB4,F]  211-7-219ms    | [S3,MB0,BI] 218-9-228ms    | [S3,MB0,BW] 228-9-238ms    | [S4,MB4,F]  238-7-246ms    | [S4,MB1,BI] 282-10-292ms   | [S4,MB1,BW] 292-10-302ms   | [S3,MB5,F]  302-8-311ms    | [S3,MB1,BI] 311-9-320ms    | [S3,MB1,BW] 320-9-330ms    | [S4,MB5,F]  330-7-338ms    | [S4,MB2,BI] 365-11-376ms   | [S4,MB2,BW] 377-9-386ms    | [S3,MB6,F]  386-7-394ms    | [S3,MB2,BI] 394-9-403ms    | [S3,MB2,BW] 403-10-413ms   | [S4,MB6,F]  413-8-421ms    | [S4,MB3,BI] 436-12-449ms   | [S4,MB3,BW] 449-9-459ms    | [S3,MB7,F]  459-7-466ms    | [S3,MB3,BI] 466-9-476ms    | [S3,MB3,BW] 476-10-486ms   | [S4,MB7,F]  486-8-495ms    | [S4,MB4,BI] 554-10-564ms   | [S4,MB4,BW] 565-9-574ms    | [S3,MB4,BI] 574-10-585ms   | [S4,MB5,BI] 635-10-645ms   | [S3,MB5,BI] 645-9-654ms    | [S4,MB6,BI] 667-9-677ms    | [S3,MB6,BI] 676-9-686ms    | [S4,MB7,BI] 744-9-753ms    | [S3,MB7,BI] 753-9-762ms    | [S3,MB4,BW] 762-0-762ms    | [S4,MB5,BW] 762-10-772ms   | [S4,MB6,BW] 772-9-782ms    | [S4,MB7,BW] 782-3-786ms    | [S3,MB5,BW] 786-0-786ms    | [S3,MB6,BW] 786-0-786ms    | [S3,MB7,BW] 786-0-786ms   
[rank3]:2025-12-25 09:21:45,998 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank3/251225_0921_stage3_step500.svg
[rank3]:2025-12-25 09:21:46,039 - âœ… Frozen Ratio History of Rank 3 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank3/251225_0921_stage4_step500.svg
[rank1]:2025-12-25 09:21:46,277 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251225_0921_stage1.svg
[rank0]:2025-12-25 09:21:46,286 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251225_0921_stage0.svg
[rank2]:2025-12-25 09:21:46,271 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251225_0921_stage2.svg
[rank3]:2025-12-25 09:21:46,606 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251225_0921_stage3.svg
[rank2]:2025-12-25 09:21:46,807 - âœ… Scatter Plot of Stage 5 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251225_0921_stage5.svg
[rank1]:2025-12-25 09:21:46,825 - âœ… Scatter Plot of Stage 6 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251225_0921_stage6.svg
[rank0]:2025-12-25 09:21:46,866 - âœ… Scatter Plot of Stage 7 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251225_0921_stage7.svg
[rank3]:2025-12-25 09:21:47,169 - âœ… Scatter Plot of Stage 4 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251225_0921_stage4.svg
[rank0]:2025-12-25 09:24:34,916 - [GC] Peforming periodical GC collection 0.02 seconds
[rank3]:2025-12-25 09:24:38,787 - Avg. fwd time: 7.8456 / Avg. bwd-weight time: 7.3694 / Avg. bwd-input time: 9.8981 / Avg. batch time: 822.8687 (ms) / GPU bubble ratio: 51.17%
[rank1]:2025-12-25 09:24:38,794 - Avg. fwd time: 9.7894 / Avg. bwd-weight time: 7.8020 / Avg. bwd-input time: 12.5158 / Avg. batch time: 857.5308 (ms) / GPU bubble ratio: 43.83%
[rank2]:2025-12-25 09:24:38,791 - Avg. fwd time: 8.3124 / Avg. bwd-weight time: 7.9831 / Avg. bwd-input time: 10.2450 / Avg. batch time: 837.0298 (ms) / GPU bubble ratio: 49.27%
[rank2]:2025-12-25 09:24:38,847 -  step: 550  loss: -4.0000  grad_norm:  0.1718  memory: 14.74GiB(31.02%)  tps: 9,457  tflops: 73.93  mfu: 23.70%
[rank0]:2025-12-25 09:24:38,801 - Avg. fwd time: 13.2427 / Avg. full-bwd time: 12.1834 (Avg. bwd-weight time: 11.8207 / Avg. bwd-input time: 34.1777) / Avg. batch time: 881.7724 (ms) / GPU bubble ratio: 23.18%
[rank3]:2025-12-25 09:24:38,847 -  step: 550  loss: -4.0000  grad_norm:  0.1718  memory: 16.18GiB(34.07%)  tps: 9,457  tflops: 73.93  mfu: 23.70%
[rank1]:2025-12-25 09:24:38,851 -  step: 550  loss: -4.0000  grad_norm:  0.1718  memory: 18.98GiB(39.95%)  tps: 9,457  tflops: 73.93  mfu: 23.70%
[rank0]:2025-12-25 09:24:38,874 -  step: 550  loss:  0.2303  grad_norm:  0.1718  memory: 40.54GiB(85.33%)  tps: 9,457  tflops: 73.93  mfu: 23.70%
[rank0]:2025-12-25 09:27:25,464 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-25 09:27:29,431 - Avg. fwd time: 7.8480 / Avg. bwd-weight time: 7.3502 / Avg. bwd-input time: 9.9051 / Avg. batch time: 817.2308 (ms) / GPU bubble ratio: 50.85%
[rank2]:2025-12-25 09:27:29,434 - Avg. fwd time: 8.3158 / Avg. bwd-weight time: 7.9703 / Avg. bwd-input time: 10.2491 / Avg. batch time: 831.4503 (ms) / GPU bubble ratio: 48.94%
[rank1]:2025-12-25 09:27:29,437 - Avg. fwd time: 9.7885 / Avg. bwd-weight time: 7.7367 / Avg. bwd-input time: 12.5282 / Avg. batch time: 851.6608 (ms) / GPU bubble ratio: 43.54%
[rank0]:2025-12-25 09:27:29,446 - Avg. fwd time: 13.2324 / Avg. full-bwd time: 11.8602 (Avg. bwd-weight time: 11.3802 / Avg. bwd-input time: 34.1605) / Avg. batch time: 876.0376 (ms) / GPU bubble ratio: 23.41%
[rank3]:2025-12-25 09:27:29,492 -  step: 600  loss: -4.0000  grad_norm:  0.4633  memory: 16.18GiB(34.07%)  tps: 9,601  tflops: 75.06  mfu: 24.06%
[rank2]:2025-12-25 09:27:29,492 -  step: 600  loss: -4.0000  grad_norm:  0.4633  memory: 14.74GiB(31.02%)  tps: 9,601  tflops: 75.06  mfu: 24.06%
[rank1]:2025-12-25 09:27:29,495 -  step: 600  loss: -4.0000  grad_norm:  0.4633  memory: 18.98GiB(39.95%)  tps: 9,601  tflops: 75.06  mfu: 24.06%
[rank1]:2025-12-25 09:27:29,569 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank1/251225_0927_stage1_step600.svg
[rank0]:2025-12-25 09:27:29,516 -  step: 600  loss:  0.2245  grad_norm:  0.4633  memory: 40.54GiB(85.33%)  tps: 9,601  tflops: 75.06  mfu: 24.06%
[rank0]:2025-12-25 09:27:29,570 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank0/251225_0927_stage0_step600.svg
[rank2]:2025-12-25 09:27:29,569 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank2/251225_0927_stage2_step600.svg
[rank2]:2025-12-25 09:27:29,612 - âœ… Frozen Ratio History of Rank 2 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank2/251225_0927_stage5_step600.svg
[rank1]:2025-12-25 09:27:29,612 - âœ… Frozen Ratio History of Rank 1 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank1/251225_0927_stage6_step600.svg
[rank0]:2025-12-25 09:27:29,613 - âœ… Frozen Ratio History of Rank 0 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank0/251225_0927_stage7_step600.svg
[rank3]:2025-12-25 09:27:29,850 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/pipeline_schedule/251225_0927_step600_rank3.svg
[rank3]:			> Batch Time: 812.01 ms, GPU Bubble Ratio: 25.30%, 42.43%, 47.77%, 50.50%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-8-18ms       | [S0,MB2,F]  18-7-25ms      | [S0,MB3,F]  25-8-34ms      | [S0,MB4,F]  34-8-43ms      | [S0,MB5,F]  43-10-53ms     | [S0,MB6,F]  53-9-63ms      | [S7,MB0,F]  113-17-130ms   | [S7,MB0,BI] 142-32-175ms   | [S7,MB0,BW] 175-25-201ms   | [S7,MB1,F]  201-16-217ms   | [S7,MB1,BI] 229-34-264ms   | [S7,MB1,BW] 264-0-264ms    | [S7,MB2,F]  264-17-282ms   | [S7,MB2,BI] 294-35-329ms   | [S7,MB2,BW] 329-0-329ms    | [S7,MB3,F]  329-20-349ms   | [S7,MB3,BI] 361-35-396ms   | [S7,MB3,BW] 397-0-397ms    | [S0,MB7,F]  397-10-408ms   | [S0,MB0,B]  408-0-408ms    | [S7,MB4,F]  415-18-434ms   | [S7,MB4,BI] 446-33-479ms   | [S7,MB4,BW] 479-0-479ms    | [S0,MB1,B]  486-0-486ms    | [S7,MB5,F]  490-17-507ms   | [S7,MB5,BI] 518-33-551ms   | [S7,MB5,BW] 551-0-551ms    | [S0,MB2,B]  558-0-558ms    | [S7,MB6,F]  572-15-588ms   | [S7,MB6,BI] 599-33-632ms   | [S7,MB6,BW] 632-0-632ms    | [S0,MB3,B]  639-0-639ms    | [S7,MB7,F]  653-14-668ms   | [S7,MB7,BI] 680-32-713ms   | [S7,MB7,BW] 713-28-741ms   | [S0,MB4,B]  741-13-755ms   | [S0,MB5,B]  755-25-781ms   | [S0,MB6,B]  782-19-801ms   | [S0,MB7,B]  802-9-812ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-12-21ms      | [S1,MB1,F]  27-10-38ms     | [S1,MB2,F]  45-10-56ms     | [S1,MB3,F]  62-10-73ms     | [S1,MB4,F]  85-10-96ms     | [S6,MB0,F]  96-10-106ms    | [S1,MB5,F]  106-13-120ms   | [S6,MB1,F]  120-8-128ms    | [S6,MB0,BI] 175-9-184ms    | [S6,MB0,BW] 184-10-195ms   | [S6,MB2,F]  194-7-201ms    | [S6,MB1,BI] 264-9-273ms    | [S6,MB1,BW] 273-10-283ms   | [S6,MB3,F]  283-7-291ms    | [S6,MB2,BI] 329-9-338ms    | [S6,MB2,BW] 338-10-349ms   | [S1,MB6,F]  349-11-360ms   | [S1,MB0,BI] 360-15-376ms   | [S1,MB0,BW] 376-0-376ms    | [S6,MB4,F]  376-8-384ms    | [S6,MB3,BI] 396-11-408ms   | [S6,MB3,BW] 408-12-420ms   | [S1,MB7,F]  420-11-432ms   | [S1,MB1,BI] 432-16-448ms   | [S1,MB1,BW] 447-5-453ms    | [S6,MB5,F]  454-8-462ms    | [S6,MB4,BI] 479-12-491ms   | [S6,MB4,BW] 491-10-502ms   | [S1,MB2,BI] 502-14-517ms   | [S1,MB2,BW] 517-9-527ms    | [S6,MB6,F]  558-7-565ms    | [S6,MB5,BI] 565-10-575ms   | [S6,MB5,BW] 575-10-586ms   | [S1,MB3,BI] 586-14-600ms   | [S1,MB3,BW] 601-10-611ms   | [S6,MB7,F]  639-7-646ms    | [S6,MB6,BI] 646-10-657ms   | [S6,MB6,BW] 656-10-667ms   | [S1,MB4,BI] 667-14-682ms   | [S6,MB7,BI] 714-10-724ms   | [S1,MB5,BI] 725-15-740ms   | [S1,MB4,BW] 740-4-745ms    | [S1,MB6,BI] 755-14-769ms   | [S1,MB5,BW] 769-0-770ms    | [S1,MB7,BI] 780-14-794ms   | [S1,MB6,BW] 794-0-794ms    | [S6,MB7,BW] 794-0-795ms    | [S1,MB7,BW] 795-0-795ms   
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-8-29ms      | [S2,MB1,F]  38-7-45ms      | [S2,MB2,F]  56-7-63ms      | [S5,MB0,F]  63-9-72ms      | [S2,MB3,F]  74-9-83ms      | [S5,MB1,F]  83-7-90ms      | [S2,MB4,F]  96-10-107ms    | [S5,MB2,F]  115-8-124ms    | [S5,MB0,BI] 184-9-194ms    | [S5,MB0,BW] 194-10-204ms   | [S5,MB3,F]  204-7-211ms    | [S5,MB1,BI] 273-9-283ms    | [S5,MB1,BW] 283-11-294ms   | [S2,MB5,F]  294-7-301ms    | [S2,MB0,BI] 301-10-312ms   | [S2,MB0,BW] 312-9-322ms    | [S5,MB4,F]  322-7-329ms    | [S5,MB2,BI] 339-10-349ms   | [S5,MB2,BW] 349-10-359ms   | [S2,MB6,F]  361-10-371ms   | [S2,MB1,BI] 373-11-384ms   | [S2,MB1,BW] 384-10-394ms   | [S5,MB5,F]  394-7-402ms    | [S5,MB3,BI] 412-10-423ms   | [S5,MB3,BW] 424-10-434ms   | [S2,MB7,F]  434-9-444ms    | [S2,MB2,BI] 445-11-456ms   | [S2,MB2,BW] 456-10-466ms   | [S5,MB6,F]  467-7-474ms    | [S5,MB4,BI] 491-10-502ms   | [S5,MB4,BW] 502-9-512ms    | [S2,MB3,BI] 560-9-570ms    | [S2,MB3,BW] 570-10-581ms   | [S5,MB7,F]  585-7-592ms    | [S5,MB5,BI] 592-9-602ms    | [S5,MB5,BW] 602-9-612ms    | [S2,MB4,BI] 641-9-651ms    | [S5,MB6,BI] 656-10-667ms   | [S2,MB5,BI] 667-10-677ms   | [S5,MB7,BI] 727-9-736ms    | [S2,MB6,BI] 736-11-748ms   | [S2,MB4,BW] 748-5-753ms    | [S2,MB7,BI] 764-9-773ms    | [S2,MB5,BW] 773-0-773ms    | [S5,MB6,BW] 773-10-784ms   | [S5,MB7,BW] 784-7-791ms    | [S2,MB6,BW] 791-0-791ms    | [S2,MB7,BW] 791-0-791ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-8-37ms      | [S4,MB0,F]  37-8-45ms      | [S3,MB1,F]  46-8-55ms      | [S4,MB1,F]  55-7-62ms      | [S3,MB2,F]  64-7-71ms      | [S4,MB2,F]  71-7-79ms      | [S3,MB3,F]  98-7-106ms     | [S4,MB3,F]  106-8-114ms    | [S4,MB0,BI] 194-9-203ms    | [S4,MB0,BW] 203-9-212ms    | [S3,MB4,F]  212-7-219ms    | [S3,MB0,BI] 219-9-229ms    | [S3,MB0,BW] 229-9-239ms    | [S4,MB4,F]  239-8-247ms    | [S4,MB1,BI] 283-10-293ms   | [S4,MB1,BW] 293-10-303ms   | [S3,MB5,F]  304-8-312ms    | [S3,MB1,BI] 312-9-321ms    | [S3,MB1,BW] 321-9-331ms    | [S4,MB5,F]  331-7-339ms    | [S4,MB2,BI] 366-11-377ms   | [S4,MB2,BW] 377-9-387ms    | [S3,MB6,F]  387-7-394ms    | [S3,MB2,BI] 395-9-404ms    | [S3,MB2,BW] 404-10-414ms   | [S4,MB6,F]  414-8-422ms    | [S4,MB3,BI] 438-12-451ms   | [S4,MB3,BW] 450-9-460ms    | [S3,MB7,F]  460-7-468ms    | [S3,MB3,BI] 468-9-477ms    | [S3,MB3,BW] 477-10-488ms   | [S4,MB7,F]  488-8-497ms    | [S4,MB4,BI] 554-10-565ms   | [S4,MB4,BW] 565-9-574ms    | [S3,MB4,BI] 574-10-584ms   | [S4,MB5,BI] 635-10-645ms   | [S3,MB5,BI] 646-9-655ms    | [S4,MB6,BI] 668-9-677ms    | [S3,MB6,BI] 677-9-686ms    | [S4,MB7,BI] 739-9-748ms    | [S3,MB7,BI] 748-9-757ms    | [S3,MB4,BW] 758-0-758ms    | [S4,MB5,BW] 758-10-768ms   | [S4,MB6,BW] 768-9-777ms    | [S4,MB7,BW] 778-7-785ms    | [S3,MB5,BW] 785-0-785ms    | [S3,MB6,BW] 785-0-785ms    | [S3,MB7,BW] 785-0-785ms   
[rank3]:2025-12-25 09:27:29,892 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank3/251225_0927_stage3_step600.svg
[rank3]:2025-12-25 09:27:29,933 - âœ… Frozen Ratio History of Rank 3 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank3/251225_0927_stage4_step600.svg
[rank2]:2025-12-25 09:27:30,286 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251225_0927_stage2.svg
[rank1]:2025-12-25 09:27:30,300 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251225_0927_stage1.svg
[rank0]:2025-12-25 09:27:30,304 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251225_0927_stage0.svg
[rank3]:2025-12-25 09:27:30,634 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251225_0927_stage3.svg
[rank2]:2025-12-25 09:27:30,941 - âœ… Scatter Plot of Stage 5 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251225_0927_stage5.svg
[rank1]:2025-12-25 09:27:30,964 - âœ… Scatter Plot of Stage 6 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251225_0927_stage6.svg
[rank0]:2025-12-25 09:27:30,997 - âœ… Scatter Plot of Stage 7 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251225_0927_stage7.svg
[rank3]:2025-12-25 09:27:31,309 - âœ… Scatter Plot of Stage 4 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251225_0927_stage4.svg
[rank0]:2025-12-25 09:30:18,550 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-25 09:30:22,392 - Avg. fwd time: 7.8502 / Avg. bwd-weight time: 7.3331 / Avg. bwd-input time: 9.9117 / Avg. batch time: 812.9922 (ms) / GPU bubble ratio: 50.61%
[rank1]:2025-12-25 09:30:22,396 - Avg. fwd time: 9.7869 / Avg. bwd-weight time: 7.6763 / Avg. bwd-input time: 12.5351 / Avg. batch time: 847.3485 (ms) / GPU bubble ratio: 43.36%
[rank0]:2025-12-25 09:30:22,403 - Avg. fwd time: 13.2136 / Avg. full-bwd time: 11.5175 (Avg. bwd-weight time: 11.0038 / Avg. bwd-input time: 34.1402) / Avg. batch time: 871.5594 (ms) / GPU bubble ratio: 23.73%
[rank2]:2025-12-25 09:30:22,393 - Avg. fwd time: 8.3190 / Avg. bwd-weight time: 7.9584 / Avg. bwd-input time: 10.2536 / Avg. batch time: 827.4051 (ms) / GPU bubble ratio: 48.70%
[rank2]:2025-12-25 09:30:22,449 -  step: 650  loss: -4.0000  grad_norm:  0.1262  memory: 14.74GiB(31.02%)  tps: 9,473  tflops: 74.05  mfu: 23.74%
[rank3]:2025-12-25 09:30:22,449 -  step: 650  loss: -4.0000  grad_norm:  0.1262  memory: 16.18GiB(34.07%)  tps: 9,473  tflops: 74.05  mfu: 23.74%
[rank1]:2025-12-25 09:30:22,452 -  step: 650  loss: -4.0000  grad_norm:  0.1262  memory: 18.98GiB(39.95%)  tps: 9,473  tflops: 74.05  mfu: 23.74%
[rank0]:2025-12-25 09:30:22,473 -  step: 650  loss:  0.2324  grad_norm:  0.1262  memory: 40.54GiB(85.33%)  tps: 9,473  tflops: 74.06  mfu: 23.74%
[rank0]:2025-12-25 09:33:09,565 - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-12-25 09:33:13,474 - Avg. fwd time: 8.3216 / Avg. bwd-weight time: 7.9511 / Avg. bwd-input time: 10.2574 / Avg. batch time: 823.5866 (ms) / GPU bubble ratio: 48.46%
[rank3]:2025-12-25 09:33:13,469 - Avg. fwd time: 7.8514 / Avg. bwd-weight time: 7.3192 / Avg. bwd-input time: 9.9167 / Avg. batch time: 809.1146 (ms) / GPU bubble ratio: 50.39%
[rank3]:2025-12-25 09:33:13,529 -  step: 700  loss: -4.0000  grad_norm:  0.1257  memory: 16.18GiB(34.07%)  tps: 9,577  tflops: 74.87  mfu: 24.00%
[rank1]:2025-12-25 09:33:13,474 - Avg. fwd time: 9.7859 / Avg. bwd-weight time: 7.6251 / Avg. bwd-input time: 12.5433 / Avg. batch time: 843.2946 (ms) / GPU bubble ratio: 43.17%
[rank1]:2025-12-25 09:33:13,532 -  step: 700  loss: -4.0000  grad_norm:  0.1257  memory: 18.98GiB(39.95%)  tps: 9,577  tflops: 74.87  mfu: 24.00%
[rank0]:2025-12-25 09:33:13,483 - Avg. fwd time: 13.2015 / Avg. full-bwd time: 11.2762 (Avg. bwd-weight time: 10.6883 / Avg. bwd-input time: 34.1255) / Avg. batch time: 867.4622 (ms) / GPU bubble ratio: 23.92%
[rank0]:2025-12-25 09:33:13,552 -  step: 700  loss:  0.1929  grad_norm:  0.1257  memory: 40.54GiB(85.33%)  tps: 9,577  tflops: 74.87  mfu: 24.00%
[rank2]:2025-12-25 09:33:13,528 -  step: 700  loss: -4.0000  grad_norm:  0.1257  memory: 14.74GiB(31.02%)  tps: 9,577  tflops: 74.87  mfu: 24.00%
[rank2]:2025-12-25 09:33:13,606 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank2/251225_0933_stage2_step700.svg
[rank1]:2025-12-25 09:33:13,605 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank1/251225_0933_stage1_step700.svg
[rank1]:2025-12-25 09:33:13,647 - âœ… Frozen Ratio History of Rank 1 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank1/251225_0933_stage6_step700.svg
[rank0]:2025-12-25 09:33:13,606 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank0/251225_0933_stage0_step700.svg
[rank0]:2025-12-25 09:33:13,650 - âœ… Frozen Ratio History of Rank 0 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank0/251225_0933_stage7_step700.svg
[rank2]:2025-12-25 09:33:13,648 - âœ… Frozen Ratio History of Rank 2 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank2/251225_0933_stage5_step700.svg
[rank3]:2025-12-25 09:33:13,869 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/pipeline_schedule/251225_0933_step700_rank3.svg
[rank3]:			> Batch Time: 809.71 ms, GPU Bubble Ratio: 26.09%, 41.57%, 47.54%, 50.55%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-8-34ms      | [S0,MB4,F]  34-7-42ms      | [S0,MB5,F]  42-9-52ms      | [S0,MB6,F]  52-8-61ms      | [S7,MB0,F]  112-16-129ms   | [S7,MB0,BI] 141-32-174ms   | [S7,MB0,BW] 174-27-202ms   | [S7,MB1,F]  202-16-219ms   | [S7,MB1,BI] 231-34-265ms   | [S7,MB1,BW] 265-0-265ms    | [S7,MB2,F]  265-17-283ms   | [S7,MB2,BI] 294-35-330ms   | [S7,MB2,BW] 330-0-330ms    | [S7,MB3,F]  330-19-349ms   | [S7,MB3,BI] 361-35-396ms   | [S7,MB3,BW] 396-0-396ms    | [S0,MB7,F]  396-10-407ms   | [S0,MB0,B]  407-0-407ms    | [S7,MB4,F]  415-18-433ms   | [S7,MB4,BI] 444-33-478ms   | [S7,MB4,BW] 478-0-478ms    | [S0,MB1,B]  485-0-485ms    | [S7,MB5,F]  489-17-506ms   | [S7,MB5,BI] 519-33-552ms   | [S7,MB5,BW] 552-0-552ms    | [S0,MB2,B]  558-0-558ms    | [S7,MB6,F]  573-15-588ms   | [S7,MB6,BI] 600-33-633ms   | [S7,MB6,BW] 633-0-633ms    | [S0,MB3,B]  640-0-640ms    | [S7,MB7,F]  654-15-669ms   | [S7,MB7,BI] 681-33-714ms   | [S7,MB7,BW] 715-27-742ms   | [S0,MB4,B]  742-12-754ms   | [S0,MB5,B]  755-24-779ms   | [S0,MB6,B]  781-22-804ms   | [S0,MB7,B]  806-3-809ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-21ms      | [S1,MB1,F]  27-10-38ms     | [S1,MB2,F]  44-10-55ms     | [S1,MB3,F]  62-10-73ms     | [S1,MB4,F]  85-10-96ms     | [S6,MB0,F]  95-10-106ms    | [S1,MB5,F]  106-13-119ms   | [S6,MB1,F]  119-8-127ms    | [S6,MB0,BI] 174-9-184ms    | [S6,MB0,BW] 184-10-194ms   | [S6,MB2,F]  194-7-201ms    | [S6,MB1,BI] 265-9-274ms    | [S6,MB1,BW] 274-10-285ms   | [S6,MB3,F]  285-7-292ms    | [S6,MB2,BI] 330-9-339ms    | [S6,MB2,BW] 339-10-350ms   | [S1,MB6,F]  350-10-361ms   | [S1,MB0,BI] 361-15-377ms   | [S1,MB0,BW] 377-0-377ms    | [S6,MB4,F]  377-8-385ms    | [S6,MB3,BI] 396-11-408ms   | [S6,MB3,BW] 408-11-420ms   | [S1,MB7,F]  420-11-431ms   | [S1,MB1,BI] 431-16-448ms   | [S1,MB1,BW] 448-5-453ms    | [S6,MB5,F]  453-8-462ms    | [S6,MB4,BI] 478-12-490ms   | [S6,MB4,BW] 490-10-501ms   | [S1,MB2,BI] 501-14-516ms   | [S1,MB2,BW] 516-12-529ms   | [S6,MB6,F]  558-7-565ms    | [S6,MB5,BI] 565-10-575ms   | [S6,MB5,BW] 575-10-586ms   | [S1,MB3,BI] 586-14-601ms   | [S1,MB3,BW] 601-12-614ms   | [S6,MB7,F]  639-7-646ms    | [S6,MB6,BI] 646-10-657ms   | [S6,MB6,BW] 657-10-668ms   | [S1,MB4,BI] 668-14-683ms   | [S6,MB7,BI] 714-10-725ms   | [S1,MB5,BI] 727-15-743ms   | [S1,MB4,BW] 742-5-748ms    | [S1,MB6,BI] 758-14-772ms   | [S1,MB5,BW] 772-0-773ms    | [S1,MB7,BI] 783-14-797ms   | [S1,MB6,BW] 797-0-797ms    | [S6,MB7,BW] 797-0-798ms    | [S1,MB7,BW] 798-0-798ms   
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-8-29ms      | [S2,MB1,F]  38-7-45ms      | [S2,MB2,F]  55-7-63ms      | [S5,MB0,F]  63-9-72ms      | [S2,MB3,F]  73-9-82ms      | [S5,MB1,F]  82-7-90ms      | [S2,MB4,F]  96-10-106ms    | [S5,MB2,F]  114-8-123ms    | [S5,MB0,BI] 184-9-193ms    | [S5,MB0,BW] 193-10-204ms   | [S5,MB3,F]  203-7-211ms    | [S5,MB1,BI] 275-9-284ms    | [S5,MB1,BW] 284-11-295ms   | [S2,MB5,F]  295-7-302ms    | [S2,MB0,BI] 302-10-313ms   | [S2,MB0,BW] 313-9-323ms    | [S5,MB4,F]  323-7-331ms    | [S5,MB2,BI] 339-10-350ms   | [S5,MB2,BW] 351-10-361ms   | [S2,MB6,F]  362-9-372ms    | [S2,MB1,BI] 374-11-385ms   | [S2,MB1,BW] 385-10-395ms   | [S5,MB5,F]  395-7-403ms    | [S5,MB3,BI] 412-10-423ms   | [S5,MB3,BW] 423-10-434ms   | [S2,MB7,F]  433-10-443ms   | [S2,MB2,BI] 445-11-456ms   | [S2,MB2,BW] 456-10-466ms   | [S5,MB6,F]  466-7-474ms    | [S5,MB4,BI] 490-10-501ms   | [S5,MB4,BW] 501-9-511ms    | [S2,MB3,BI] 561-9-570ms    | [S2,MB3,BW] 571-10-581ms   | [S5,MB7,F]  586-7-593ms    | [S5,MB5,BI] 593-9-602ms    | [S5,MB5,BW] 602-9-612ms    | [S2,MB4,BI] 642-9-652ms    | [S5,MB6,BI] 657-10-668ms   | [S2,MB5,BI] 668-10-678ms   | [S5,MB7,BI] 730-9-739ms    | [S2,MB6,BI] 739-11-751ms   | [S2,MB4,BW] 751-6-757ms    | [S2,MB7,BI] 767-9-776ms    | [S2,MB5,BW] 776-0-776ms    | [S5,MB6,BW] 776-10-787ms   | [S5,MB7,BW] 787-6-793ms    | [S2,MB6,BW] 794-0-794ms    | [S2,MB7,BW] 794-0-794ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-7-37ms      | [S4,MB0,F]  37-8-45ms      | [S3,MB1,F]  46-8-54ms      | [S4,MB1,F]  54-7-62ms      | [S3,MB2,F]  63-7-71ms      | [S4,MB2,F]  71-7-79ms      | [S3,MB3,F]  98-7-105ms     | [S4,MB3,F]  105-8-113ms    | [S4,MB0,BI] 193-9-202ms    | [S4,MB0,BW] 202-9-212ms    | [S3,MB4,F]  212-7-219ms    | [S3,MB0,BI] 219-9-228ms    | [S3,MB0,BW] 228-9-238ms    | [S4,MB4,F]  238-7-246ms    | [S4,MB1,BI] 284-10-294ms   | [S4,MB1,BW] 294-10-304ms   | [S3,MB5,F]  304-8-313ms    | [S3,MB1,BI] 313-9-322ms    | [S3,MB1,BW] 322-9-332ms    | [S4,MB5,F]  332-7-340ms    | [S4,MB2,BI] 367-11-378ms   | [S4,MB2,BW] 378-9-388ms    | [S3,MB6,F]  388-7-396ms    | [S3,MB2,BI] 396-9-405ms    | [S3,MB2,BW] 405-10-415ms   | [S4,MB6,F]  415-8-424ms    | [S4,MB3,BI] 438-12-450ms   | [S4,MB3,BW] 450-9-460ms    | [S3,MB7,F]  460-7-468ms    | [S3,MB3,BI] 467-9-477ms    | [S3,MB3,BW] 477-10-488ms   | [S4,MB7,F]  488-8-497ms    | [S4,MB4,BI] 554-10-565ms   | [S4,MB4,BW] 565-9-574ms    | [S3,MB4,BI] 575-10-585ms   | [S4,MB5,BI] 636-10-646ms   | [S3,MB5,BI] 646-9-655ms    | [S4,MB6,BI] 668-9-678ms    | [S3,MB6,BI] 678-9-687ms    | [S4,MB7,BI] 742-9-751ms    | [S3,MB7,BI] 751-9-760ms    | [S3,MB4,BW] 760-0-760ms    | [S4,MB5,BW] 760-10-771ms   | [S4,MB6,BW] 770-9-780ms    | [S4,MB7,BW] 780-6-787ms    | [S3,MB5,BW] 787-0-787ms    | [S3,MB6,BW] 787-0-787ms    | [S3,MB7,BW] 787-0-787ms   
[rank3]:2025-12-25 09:33:13,911 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank3/251225_0933_stage3_step700.svg
[rank3]:2025-12-25 09:33:13,955 - âœ… Frozen Ratio History of Rank 3 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank3/251225_0933_stage4_step700.svg
[rank0]:2025-12-25 09:33:14,470 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251225_0933_stage0.svg
[rank2]:2025-12-25 09:33:14,444 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251225_0933_stage2.svg
[rank1]:2025-12-25 09:33:14,456 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251225_0933_stage1.svg
[rank3]:2025-12-25 09:33:14,818 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251225_0933_stage3.svg
[rank1]:2025-12-25 09:33:15,248 - âœ… Scatter Plot of Stage 6 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251225_0933_stage6.svg
[rank2]:2025-12-25 09:33:15,221 - âœ… Scatter Plot of Stage 5 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251225_0933_stage5.svg
[rank0]:2025-12-25 09:33:15,301 - âœ… Scatter Plot of Stage 7 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251225_0933_stage7.svg
[rank3]:2025-12-25 09:33:15,620 - âœ… Scatter Plot of Stage 4 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/afr_time_plot/251225_0933_stage4.svg
[rank0]:2025-12-25 09:36:02,537 - [GC] Peforming periodical GC collection 0.02 seconds
[rank2]:2025-12-25 09:36:06,427 - Avg. fwd time: 8.3244 / Avg. bwd-weight time: 7.9486 / Avg. bwd-input time: 10.2607 / Avg. batch time: 820.3575 (ms) / GPU bubble ratio: 48.25%
[rank3]:2025-12-25 09:36:06,423 - Avg. fwd time: 7.8533 / Avg. bwd-weight time: 7.3132 / Avg. bwd-input time: 9.9215 / Avg. batch time: 805.8032 (ms) / GPU bubble ratio: 50.19%
[rank1]:2025-12-25 09:36:06,429 - Avg. fwd time: 9.7846 / Avg. bwd-weight time: 7.5742 / Avg. bwd-input time: 12.5495 / Avg. batch time: 839.8366 (ms) / GPU bubble ratio: 43.02%
[rank0]:2025-12-25 09:36:06,443 - Avg. fwd time: 13.1903 / Avg. full-bwd time: 11.0450 (Avg. bwd-weight time: 10.4085 / Avg. bwd-input time: 34.1115) / Avg. batch time: 863.9670 (ms) / GPU bubble ratio: 24.12%
[rank0]:2025-12-25 09:36:06,515 -  step: 750  loss:  0.2346  grad_norm:  0.1634  memory: 40.54GiB(85.33%)  tps: 9,473  tflops: 74.05  mfu: 23.73%
[rank2]:2025-12-25 09:36:06,489 -  step: 750  loss: -4.0000  grad_norm:  0.1634  memory: 14.74GiB(31.02%)  tps: 9,473  tflops: 74.05  mfu: 23.74%
[rank3]:2025-12-25 09:36:06,489 -  step: 750  loss: -4.0000  grad_norm:  0.1634  memory: 16.18GiB(34.07%)  tps: 9,473  tflops: 74.05  mfu: 23.74%
[rank1]:2025-12-25 09:36:06,491 -  step: 750  loss: -4.0000  grad_norm:  0.1634  memory: 18.98GiB(39.95%)  tps: 9,473  tflops: 74.05  mfu: 23.74%
[rank0]:2025-12-25 09:38:52,937 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-25 09:38:56,930 - Avg. fwd time: 13.1846 / Avg. full-bwd time: 10.8232 (Avg. bwd-weight time: 10.1651 / Avg. bwd-input time: 34.1026) / Avg. batch time: 860.9218 (ms) / GPU bubble ratio: 24.30%
[rank3]:2025-12-25 09:38:56,910 - Avg. fwd time: 7.8550 / Avg. bwd-weight time: 7.3026 / Avg. bwd-input time: 9.9258 / Avg. batch time: 802.9279 (ms) / GPU bubble ratio: 50.02%
[rank2]:2025-12-25 09:38:56,917 - Avg. fwd time: 8.3268 / Avg. bwd-weight time: 7.9408 / Avg. bwd-input time: 10.2632 / Avg. batch time: 817.5095 (ms) / GPU bubble ratio: 48.08%
[rank2]:2025-12-25 09:38:56,975 -  step: 800  loss: -4.0000  grad_norm:  0.4202  memory: 14.74GiB(31.02%)  tps: 9,610  tflops: 75.13  mfu: 24.08%
[rank2]:2025-12-25 09:38:56,975 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  0.4202  tps: 9,616  tflops: 75.17  mfu: 21.99%
[rank2]:2025-12-25 09:38:56,975 - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-12-25 09:38:56,976 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank1]:2025-12-25 09:38:56,919 - Avg. fwd time: 9.7838 / Avg. bwd-weight time: 7.5281 / Avg. bwd-input time: 12.5543 / Avg. batch time: 836.8274 (ms) / GPU bubble ratio: 42.90%
[rank1]:2025-12-25 09:38:56,979 -  step: 800  loss: -4.0000  grad_norm:  0.4202  memory: 19.00GiB(39.99%)  tps: 9,610  tflops: 75.13  mfu: 24.08%
[rank1]:2025-12-25 09:38:56,979 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  0.4202  tps: 9,615  tflops: 75.17  mfu: 21.99%
[rank1]:2025-12-25 09:38:56,979 - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-12-25 09:38:56,979 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-25 09:38:57,000 -  step: 800  loss:  0.2393  grad_norm:  0.4202  memory: 40.54GiB(85.33%)  tps: 9,610  tflops: 75.13  mfu: 24.08%
[rank0]:2025-12-25 09:38:57,001 - â„¹ï¸ final step: 800  loss:  0.2393  grad_norm:  0.4202  tps: 9,623  tflops: 75.23  mfu: 22.10%
[rank0]:2025-12-25 09:38:57,001 - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-12-25 09:38:57,002 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank3]:2025-12-25 09:38:56,975 -  step: 800  loss: -4.0000  grad_norm:  0.4202  memory: 16.18GiB(34.07%)  tps: 9,610  tflops: 75.13  mfu: 24.08%
[rank3]:2025-12-25 09:38:56,975 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  0.4202  tps: 9,615  tflops: 75.17  mfu: 21.99%
[rank3]:2025-12-25 09:38:56,975 - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-12-25 09:38:56,976 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-25 09:38:59,400 - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank2]:2025-12-25 09:38:59,476 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank2/251225_0938_stage2_final800.svg
[rank1]:2025-12-25 09:38:59,476 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank1/251225_0938_stage1_final800.svg
[rank0]:2025-12-25 09:38:59,476 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank0/251225_0938_stage0_final800.svg
[rank0]:2025-12-25 09:38:59,521 - âœ… Frozen Ratio History of Rank 0 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank0/251225_0938_stage7_final800.svg
[rank2]:2025-12-25 09:38:59,520 - âœ… Frozen Ratio History of Rank 2 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank2/251225_0938_stage5_final800.svg
[rank1]:2025-12-25 09:38:59,520 - âœ… Frozen Ratio History of Rank 1 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_ratio_history/rank1/251225_0938_stage6_final800.svg
[rank0]:2025-12-25 09:38:59,629 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_params_histogram/251225_0938_rank0_stage0.svg
[rank0]:	> Counts Sum: 336440, Total Sum: 437760 (76.85%), Ratio(%) per element: [81.59, 83.15, 82.81, 84.02, 82.11, 82.63, 83.85, 83.85, 53.99, 54.16, 81.42, 82.98, 84.02, 83.15, 80.55, 83.5, 82.46, 55.72, 54.16]
[rank0]:2025-12-25 09:38:59,640 - Destroying the purge thread.
[rank2]:2025-12-25 09:38:59,620 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_params_histogram/251225_0938_rank2_stage2.svg
[rank2]:	> Counts Sum: 172320, Total Sum: 414720 (41.55%), Ratio(%) per element: [42.7, 43.4, 43.57, 42.88, 43.75, 42.01, 43.05, 35.24, 35.06, 42.53, 43.4, 44.09, 43.57, 43.57, 43.4, 44.61, 35.06, 35.93]
[rank2]:2025-12-25 09:38:59,630 - Destroying the purge thread.
[rank2]:[rank2]: Traceback (most recent call last):
[rank2]:[rank2]:   File "<frozen runpy>", line 198, in _run_module_as_main
[rank2]:[rank2]:   File "<frozen runpy>", line 88, in _run_code
[rank2]:[rank2]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 789, in <module>
[rank2]:[rank2]:     trainer.train()
[rank2]:[rank2]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
[rank2]:[rank2]:     return f(*args, **kwargs)
[rank2]:[rank2]:            ^^^^^^^^^^^^^^^^^^
[rank2]:[rank2]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 621, in train
[rank2]:[rank2]:     draw_charts(self.freezer, self.step, job_config)
[rank2]:[rank2]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 712, in draw_charts
[rank2]:[rank2]:     draw_elementwise_histogram(data=list(freezer.paramwise_frozen_count[s].values()), stage=s,
[rank2]:[rank2]:   File "/home/shcho/torchtitan/timelyfreeze/core/util.py", line 335, in draw_elementwise_histogram
[rank2]:[rank2]:     ax1.text(max(min(80, past_ratio - 5), 5), 0, total_count_text, ha="center", va="center", fontsize=fontsize, color="black")
[rank2]:[rank2]:                      ^^
[rank2]:[rank2]: UnboundLocalError: cannot access local variable 'past_ratio' where it is not associated with a value
[rank1]:2025-12-25 09:38:59,646 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/frozen_params_histogram/251225_0938_rank1_stage1.svg
[rank1]:	> Counts Sum: 408520, Total Sum: 622080 (65.67%), Ratio(%) per element: [71.0, 71.7, 74.3, 75.17, 74.65, 72.22, 72.39, 38.36, 39.58, 72.39, 74.3, 73.26, 72.04, 73.09, 70.83, 72.04, 39.93, 47.04, 74.3, 73.26, 71.87, 72.91, 71.0, 73.61, 72.91, 39.75, 39.06]
[rank1]:2025-12-25 09:38:59,657 - Destroying the purge thread.
[rank1]:[rank1]: Traceback (most recent call last):
[rank1]:[rank1]:   File "<frozen runpy>", line 198, in _run_module_as_main
[rank1]:[rank1]:   File "<frozen runpy>", line 88, in _run_code
[rank1]:[rank1]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 789, in <module>
[rank1]:[rank1]:     trainer.train()
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
[rank1]:[rank1]:     return f(*args, **kwargs)
[rank1]:[rank1]:            ^^^^^^^^^^^^^^^^^^
[rank1]:[rank1]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 621, in train
[rank1]:[rank1]:     draw_charts(self.freezer, self.step, job_config)
[rank1]:[rank1]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 712, in draw_charts
[rank1]:[rank1]:     draw_elementwise_histogram(data=list(freezer.paramwise_frozen_count[s].values()), stage=s,
[rank1]:[rank1]:   File "/home/shcho/torchtitan/timelyfreeze/core/util.py", line 335, in draw_elementwise_histogram
[rank1]:[rank1]:     ax1.text(max(min(80, past_ratio - 5), 5), 0, total_count_text, ha="center", va="center", fontsize=fontsize, color="black")
[rank1]:[rank1]:                      ^^
[rank1]:[rank1]: UnboundLocalError: cannot access local variable 'past_ratio' where it is not associated with a value
[rank0]:wandb: updating run metadata
[rank3]:2025-12-25 09:38:59,743 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1/pipeline_schedule/251225_0938_final800_rank3.svg
[rank3]:			> Batch Time: 818.54 ms, GPU Bubble Ratio: 26.57%, 42.55%, 48.16%, 51.14%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-8-34ms      | [S0,MB4,F]  34-8-42ms      | [S0,MB5,F]  42-9-52ms      | [S0,MB6,F]  52-8-61ms      | [S7,MB0,F]  113-17-130ms   | [S7,MB0,BI] 142-32-174ms   | [S7,MB0,BW] 174-26-200ms   | [S7,MB1,F]  201-16-218ms   | [S7,MB1,BI] 229-34-264ms   | [S7,MB1,BW] 264-0-264ms    | [S7,MB2,F]  265-18-283ms   | [S7,MB2,BI] 295-35-330ms   | [S7,MB2,BW] 330-0-330ms    | [S7,MB3,F]  331-19-350ms   | [S7,MB3,BI] 362-35-397ms   | [S7,MB3,BW] 397-0-397ms    | [S0,MB7,F]  397-10-408ms   | [S0,MB0,B]  408-0-408ms    | [S7,MB4,F]  416-18-435ms   | [S7,MB4,BI] 446-34-480ms   | [S7,MB4,BW] 480-0-480ms    | [S0,MB1,B]  487-0-487ms    | [S7,MB5,F]  491-17-509ms   | [S7,MB5,BI] 520-33-554ms   | [S7,MB5,BW] 554-0-554ms    | [S0,MB2,B]  560-0-560ms    | [S7,MB6,F]  575-15-590ms   | [S7,MB6,BI] 602-33-635ms   | [S7,MB6,BW] 635-0-635ms    | [S0,MB3,B]  642-0-642ms    | [S7,MB7,F]  656-15-671ms   | [S7,MB7,BI] 684-33-717ms   | [S7,MB7,BW] 717-26-743ms   | [S0,MB4,B]  743-13-756ms   | [S0,MB5,B]  759-22-781ms   | [S0,MB6,B]  785-20-805ms   | [S0,MB7,B]  809-9-818ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-21ms      | [S1,MB1,F]  27-10-38ms     | [S1,MB2,F]  44-10-55ms     | [S1,MB3,F]  62-10-73ms     | [S1,MB4,F]  85-10-96ms     | [S6,MB0,F]  96-10-106ms    | [S1,MB5,F]  106-13-119ms   | [S6,MB1,F]  119-8-128ms    | [S6,MB0,BI] 174-9-184ms    | [S6,MB0,BW] 184-10-194ms   | [S6,MB2,F]  194-7-201ms    | [S6,MB1,BI] 264-9-273ms    | [S6,MB1,BW] 273-10-284ms   | [S6,MB3,F]  283-7-291ms    | [S6,MB2,BI] 330-9-340ms    | [S6,MB2,BW] 340-10-351ms   | [S1,MB6,F]  351-10-362ms   | [S1,MB0,BI] 362-15-378ms   | [S1,MB0,BW] 377-0-377ms    | [S6,MB4,F]  378-7-386ms    | [S6,MB3,BI] 397-11-409ms   | [S6,MB3,BW] 409-11-421ms   | [S1,MB7,F]  421-11-432ms   | [S1,MB1,BI] 432-16-448ms   | [S1,MB1,BW] 448-6-454ms    | [S6,MB5,F]  454-8-463ms    | [S6,MB4,BI] 480-12-492ms   | [S6,MB4,BW] 492-10-503ms   | [S1,MB2,BI] 503-14-518ms   | [S1,MB2,BW] 518-12-530ms   | [S6,MB6,F]  560-7-567ms    | [S6,MB5,BI] 567-10-578ms   | [S6,MB5,BW] 577-10-588ms   | [S1,MB3,BI] 588-14-603ms   | [S1,MB3,BW] 603-11-614ms   | [S6,MB7,F]  642-7-649ms    | [S6,MB6,BI] 649-10-659ms   | [S6,MB6,BW] 659-10-670ms   | [S1,MB4,BI] 670-14-685ms   | [S6,MB7,BI] 717-10-728ms   | [S1,MB5,BI] 732-15-747ms   | [S1,MB4,BW] 747-5-753ms    | [S1,MB6,BI] 762-14-776ms   | [S1,MB5,BW] 776-0-777ms    | [S1,MB7,BI] 787-14-801ms   | [S1,MB6,BW] 801-0-801ms    | [S6,MB7,BW] 801-0-802ms    | [S1,MB7,BW] 801-0-801ms   
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-8-29ms      | [S2,MB1,F]  38-7-45ms      | [S2,MB2,F]  55-7-63ms      | [S5,MB0,F]  63-9-72ms      | [S2,MB3,F]  73-9-82ms      | [S5,MB1,F]  82-7-90ms      | [S2,MB4,F]  96-10-106ms    | [S5,MB2,F]  115-8-124ms    | [S5,MB0,BI] 184-9-193ms    | [S5,MB0,BW] 193-10-204ms   | [S5,MB3,F]  203-7-211ms    | [S5,MB1,BI] 273-9-283ms    | [S5,MB1,BW] 283-11-294ms   | [S2,MB5,F]  294-7-301ms    | [S2,MB0,BI] 301-10-312ms   | [S2,MB0,BW] 312-9-322ms    | [S5,MB4,F]  322-7-329ms    | [S5,MB2,BI] 340-10-351ms   | [S5,MB2,BW] 351-10-361ms   | [S2,MB6,F]  363-9-373ms    | [S2,MB1,BI] 374-11-385ms   | [S2,MB1,BW] 385-10-395ms   | [S5,MB5,F]  395-7-403ms    | [S5,MB3,BI] 413-10-424ms   | [S5,MB3,BW] 424-10-435ms   | [S2,MB7,F]  435-9-445ms    | [S2,MB2,BI] 446-11-457ms   | [S2,MB2,BW] 457-10-467ms   | [S5,MB6,F]  467-7-475ms    | [S5,MB4,BI] 493-10-504ms   | [S5,MB4,BW] 504-9-514ms    | [S2,MB3,BI] 563-9-573ms    | [S2,MB3,BW] 573-10-583ms   | [S5,MB7,F]  588-7-595ms    | [S5,MB5,BI] 595-9-604ms    | [S5,MB5,BW] 605-9-614ms    | [S2,MB4,BI] 645-9-654ms    | [S5,MB6,BI] 660-10-670ms   | [S2,MB5,BI] 671-10-681ms   | [S5,MB7,BI] 734-9-743ms    | [S2,MB6,BI] 744-11-755ms   | [S2,MB4,BW] 755-6-762ms    | [S2,MB7,BI] 771-9-780ms    | [S2,MB5,BW] 780-0-780ms    | [S5,MB6,BW] 780-10-791ms   | [S5,MB7,BW] 791-6-797ms    | [S2,MB6,BW] 797-0-797ms    | [S2,MB7,BW] 797-0-797ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-8-37ms      | [S4,MB0,F]  37-8-45ms      | [S3,MB1,F]  46-8-54ms      | [S4,MB1,F]  54-7-62ms      | [S3,MB2,F]  63-7-71ms      | [S4,MB2,F]  71-7-79ms      | [S3,MB3,F]  98-7-105ms     | [S4,MB3,F]  105-8-113ms    | [S4,MB0,BI] 193-9-203ms    | [S4,MB0,BW] 203-9-212ms    | [S3,MB4,F]  212-7-219ms    | [S3,MB0,BI] 219-9-228ms    | [S3,MB0,BW] 228-9-238ms    | [S4,MB4,F]  238-7-246ms    | [S4,MB1,BI] 283-10-293ms   | [S4,MB1,BW] 293-10-303ms   | [S3,MB5,F]  304-8-312ms    | [S3,MB1,BI] 312-9-321ms    | [S3,MB1,BW] 321-9-331ms    | [S4,MB5,F]  331-7-339ms    | [S4,MB2,BI] 367-11-379ms   | [S4,MB2,BW] 379-9-388ms    | [S3,MB6,F]  389-7-396ms    | [S3,MB2,BI] 396-9-406ms    | [S3,MB2,BW] 406-10-416ms   | [S4,MB6,F]  416-8-424ms    | [S4,MB3,BI] 439-12-451ms   | [S4,MB3,BW] 451-9-461ms    | [S3,MB7,F]  461-7-468ms    | [S3,MB3,BI] 469-9-478ms    | [S3,MB3,BW] 479-10-489ms   | [S4,MB7,F]  489-8-497ms    | [S4,MB4,BI] 556-10-567ms   | [S4,MB4,BW] 567-9-576ms    | [S3,MB4,BI] 577-10-587ms   | [S4,MB5,BI] 638-10-648ms   | [S3,MB5,BI] 648-9-657ms    | [S4,MB6,BI] 671-9-680ms    | [S3,MB6,BI] 680-9-690ms    | [S4,MB7,BI] 746-9-755ms    | [S3,MB7,BI] 755-9-764ms    | [S3,MB4,BW] 764-0-764ms    | [S4,MB5,BW] 764-10-775ms   | [S4,MB6,BW] 775-9-784ms    | [S4,MB7,BW] 784-6-791ms    | [S3,MB5,BW] 790-0-790ms    | [S3,MB6,BW] 790-0-790ms    | [S3,MB7,BW] 790-0-790ms   
[rank3]:2025-12-25 09:38:59,745 - Destroying the purge thread.
[rank3]:[rank3]: Traceback (most recent call last):
[rank3]:[rank3]:   File "<frozen runpy>", line 198, in _run_module_as_main
[rank3]:[rank3]:   File "<frozen runpy>", line 88, in _run_code
[rank3]:[rank3]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 789, in <module>
[rank3]:[rank3]:     trainer.train()
[rank3]:[rank3]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
[rank3]:[rank3]:     return f(*args, **kwargs)
[rank3]:[rank3]:            ^^^^^^^^^^^^^^^^^^
[rank3]:[rank3]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 621, in train
[rank3]:[rank3]:     draw_charts(self.freezer, self.step, job_config)
[rank3]:[rank3]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 688, in draw_charts
[rank3]:[rank3]:     pipeline_schedule = schedule_pipeline(pipeline_schedule, 
[rank3]:[rank3]:                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:[rank3]:   File "/home/shcho/torchtitan/timelyfreeze/core/schedule.py", line 414, in schedule_pipeline
[rank3]:[rank3]:     assert fwd_time is None or len(fwd_time) == num_stages, f"fwd_time should have the same length as num_stages. fwd_time: {len(fwd_time)}, num_stages: {num_stages}"
[rank3]:[rank3]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:[rank3]: AssertionError: fwd_time should have the same length as num_stages. fwd_time: 4, num_stages: 8
[rank0]:wandb: uploading history steps 16-16, summary, console lines 107-112
[rank0]:wandb: 
[rank0]:wandb: Run history:
[rank0]:wandb:      final/avg_end_to_end(s) â–
[rank0]:wandb:               final/avg_loss â–
[rank0]:wandb:             final/avg_mfu(%) â–
[rank0]:wandb:             final/avg_tflops â–
[rank0]:wandb:    final/avg_throughput(tps) â–
[rank0]:wandb:              final/grad_norm â–
[rank0]:wandb:               final/max_loss â–
[rank0]:wandb:                    grad_norm â–ˆâ–‚â–â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank0]:wandb: loss_metrics/global_avg_loss â–ˆâ–ˆâ–‡â–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank0]:wandb: loss_metrics/global_max_loss â–ˆâ–ˆâ–‡â–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank0]:wandb:                          +14 ...
[rank0]:wandb: 
[rank0]:wandb: Run summary:
[rank0]:wandb:      final/avg_end_to_end(s) 3.40512
[rank0]:wandb:               final/avg_loss 0.23927
[rank0]:wandb:             final/avg_mfu(%) 22.10489
[rank0]:wandb:             final/avg_tflops 75.22948
[rank0]:wandb:    final/avg_throughput(tps) 9623.16545
[rank0]:wandb:              final/grad_norm 0.42022
[rank0]:wandb:               final/max_loss 0.23927
[rank0]:wandb:                    grad_norm 0.42022
[rank0]:wandb: loss_metrics/global_avg_loss 0.23927
[rank0]:wandb: loss_metrics/global_max_loss 0.23927
[rank0]:wandb:                          +14 ...
[rank0]:wandb: 
[rank0]:wandb: ðŸš€ View run 1224_ZBVZeroBubble_timelyapf_42_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/anw579tm
[rank0]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank0]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank0]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1224_ZBVZeroBubble_timelyapf_42_dm1/20251225-0850/wandb/run-20251225_085041-anw579tm/logs
[rank0]:Traceback (most recent call last):
[rank0]:  File "<frozen runpy>", line 198, in _run_module_as_main
[rank0]:  File "<frozen runpy>", line 88, in _run_code
[rank0]:  File "/home/shcho/torchtitan/timelyfreeze/train.py", line 789, in <module>
[rank0]:    trainer.train()
[rank0]:  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
[rank0]:    return f(*args, **kwargs)
[rank0]:           ^^^^^^^^^^^^^^^^^^
[rank0]:  File "/home/shcho/torchtitan/timelyfreeze/train.py", line 621, in train
[rank0]:    draw_charts(self.freezer, self.step, job_config)
[rank0]:  File "/home/shcho/torchtitan/timelyfreeze/train.py", line 712, in draw_charts
[rank0]:    draw_elementwise_histogram(data=list(freezer.paramwise_frozen_count[s].values()), stage=s,
[rank0]:  File "/home/shcho/torchtitan/timelyfreeze/core/util.py", line 335, in draw_elementwise_histogram
[rank0]:    ax1.text(max(min(80, past_ratio - 5), 5), 0, total_count_text, ha="center", va="center", fontsize=fontsize, color="black")
[rank0]:                     ^^
[rank0]:UnboundLocalError: cannot access local variable 'past_ratio' where it is not associated with a value
[rank0]:[rank0]: Traceback (most recent call last):
[rank0]:[rank0]:   File "<frozen runpy>", line 198, in _run_module_as_main
[rank0]:[rank0]:   File "<frozen runpy>", line 88, in _run_code
[rank0]:[rank0]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 789, in <module>
[rank0]:[rank0]:     trainer.train()
[rank0]:[rank0]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
[rank0]:[rank0]:     return f(*args, **kwargs)
[rank0]:[rank0]:            ^^^^^^^^^^^^^^^^^^
[rank0]:[rank0]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 621, in train
[rank0]:[rank0]:     draw_charts(self.freezer, self.step, job_config)
[rank0]:[rank0]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 712, in draw_charts
[rank0]:[rank0]:     draw_elementwise_histogram(data=list(freezer.paramwise_frozen_count[s].values()), stage=s,
[rank0]:[rank0]:   File "/home/shcho/torchtitan/timelyfreeze/core/util.py", line 335, in draw_elementwise_histogram
[rank0]:[rank0]:     ax1.text(max(min(80, past_ratio - 5), 5), 0, total_count_text, ha="center", va="center", fontsize=fontsize, color="black")
[rank0]:[rank0]:                      ^^
[rank0]:[rank0]: UnboundLocalError: cannot access local variable 'past_ratio' where it is not associated with a value
[rank0]:[rank0]:[W1225 09:39:01.009136936 ProcessGroupNCCL.cpp:1552] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
W1225 09:39:01.692000 882555 site-packages/torch/distributed/elastic/multiprocessing/api.py:940] Sending process 882574 closing signal SIGTERM
W1225 09:39:01.695000 882555 site-packages/torch/distributed/elastic/multiprocessing/api.py:940] Sending process 882575 closing signal SIGTERM
W1225 09:39:01.696000 882555 site-packages/torch/distributed/elastic/multiprocessing/api.py:940] Sending process 882577 closing signal SIGTERM
E1225 09:39:02.513000 882555 site-packages/torch/distributed/elastic/multiprocessing/api.py:914] failed (exitcode: 1) local_rank: 2 (pid: 882576) of binary: /data2/shcho/miniforge3/envs/llm_eval/bin/python3.11
E1225 09:39:02.536000 882555 site-packages/torch/distributed/elastic/multiprocessing/errors/error_handler.py:141] no error file defined for parent, to copy child error file (/tmp/torchelastic_d6f0mwcy/ad659989-e1dc-4978-aaba-81b500c67144_fmejtvkw/attempt_0/2/error.json)
[rank1]:Stage 1: Modules to keep: {'layers.4', 'layers.3', 'layers.2'}
[rank1]:Stage 6: Modules to keep: {'layers.13', 'layers.14'}
[rank3]:Stage 3: Modules to keep: {'layers.8', 'layers.7'}
[rank3]:Stage 4: Modules to keep: {'layers.10', 'layers.9'}
[rank2]:Stage 2: Modules to keep: {'layers.6', 'layers.5'}
[rank2]:Stage 5: Modules to keep: {'layers.12', 'layers.11'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1224.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1224_ZBVZeroBubble_timelyapf_42_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1224_ZBVZeroBubble_timelyapf_42_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1224_ZBVZeroBubble_timelyapf_42_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1224_ZBVZeroBubble_timelyapf_42_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyapf_42_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1224_ZBVZeroBubble_timelyapf_42_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 42
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: ZBVZeroBubble
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 4
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 2
[rank3]:		- stages_list: [3, 4]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1224_ZBVZeroBubble_timelyapf_42_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1224_ZBVZeroBubble_timelyapf_42_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: timelyapf
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.01
[rank3]:		- percentile: 80
[rank3]:
[rank0]:Stage 0: Modules to keep: {'tok_embeddings', 'layers.0', 'layers.1'}
[rank0]:Stage 7: Modules to keep: {'output', 'layers.15', 'norm'}
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
Traceback (most recent call last):
  File "/data2/shcho/miniforge3/envs/llm_eval/bin/torchrun", line 7, in <module>
    sys.exit(main())
             ^^^^^^
  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/run.py", line 946, in main
    run(args)
  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/run.py", line 937, in run
    elastic_launch(
  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 159, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 300, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
timelyfreeze.train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2025-12-25_09:38:59
  host      : elga.kaist.ac.kr
  rank      : 0 (local_rank: 0)
  exitcode  : -15 (pid: 882574)
  error_file: /tmp/torchelastic_d6f0mwcy/ad659989-e1dc-4978-aaba-81b500c67144_fmejtvkw/attempt_0/0/error.json
  traceback : Traceback (most recent call last):
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
      return f(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^
    File "/home/shcho/torchtitan/timelyfreeze/train.py", line 621, in train
      draw_charts(self.freezer, self.step, job_config)
    File "/home/shcho/torchtitan/timelyfreeze/train.py", line 712, in draw_charts
      draw_elementwise_histogram(data=list(freezer.paramwise_frozen_count[s].values()), stage=s,
    File "/home/shcho/torchtitan/timelyfreeze/core/util.py", line 335, in draw_elementwise_histogram
      ax1.text(max(min(80, past_ratio - 5), 5), 0, total_count_text, ha="center", va="center", fontsize=fontsize, color="black")
                       ^^
  UnboundLocalError: cannot access local variable 'past_ratio' where it is not associated with a value
  
[2]:
  time      : 2025-12-25_09:38:59
  host      : elga.kaist.ac.kr
  rank      : 1 (local_rank: 1)
  exitcode  : 1 (pid: 882575)
  error_file: /tmp/torchelastic_d6f0mwcy/ad659989-e1dc-4978-aaba-81b500c67144_fmejtvkw/attempt_0/1/error.json
  traceback : Traceback (most recent call last):
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
      return f(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^
    File "/home/shcho/torchtitan/timelyfreeze/train.py", line 621, in train
      draw_charts(self.freezer, self.step, job_config)
    File "/home/shcho/torchtitan/timelyfreeze/train.py", line 712, in draw_charts
      draw_elementwise_histogram(data=list(freezer.paramwise_frozen_count[s].values()), stage=s,
    File "/home/shcho/torchtitan/timelyfreeze/core/util.py", line 335, in draw_elementwise_histogram
      ax1.text(max(min(80, past_ratio - 5), 5), 0, total_count_text, ha="center", va="center", fontsize=fontsize, color="black")
                       ^^
  UnboundLocalError: cannot access local variable 'past_ratio' where it is not associated with a value
  
[3]:
  time      : 2025-12-25_09:38:59
  host      : elga.kaist.ac.kr
  rank      : 3 (local_rank: 3)
  exitcode  : 1 (pid: 882577)
  error_file: /tmp/torchelastic_d6f0mwcy/ad659989-e1dc-4978-aaba-81b500c67144_fmejtvkw/attempt_0/3/error.json
  traceback : Traceback (most recent call last):
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
      return f(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^
    File "/home/shcho/torchtitan/timelyfreeze/train.py", line 621, in train
      draw_charts(self.freezer, self.step, job_config)
    File "/home/shcho/torchtitan/timelyfreeze/train.py", line 688, in draw_charts
      pipeline_schedule = schedule_pipeline(pipeline_schedule,
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    File "/home/shcho/torchtitan/timelyfreeze/core/schedule.py", line 414, in schedule_pipeline
      assert fwd_time is None or len(fwd_time) == num_stages, f"fwd_time should have the same length as num_stages. fwd_time: {len(fwd_time)}, num_stages: {num_stages}"
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  AssertionError: fwd_time should have the same length as num_stages. fwd_time: 4, num_stages: 8
  
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2025-12-25_09:38:59
  host      : elga.kaist.ac.kr
  rank      : 2 (local_rank: 2)
  exitcode  : 1 (pid: 882576)
  error_file: /tmp/torchelastic_d6f0mwcy/ad659989-e1dc-4978-aaba-81b500c67144_fmejtvkw/attempt_0/2/error.json
  traceback : Traceback (most recent call last):
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
      return f(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^
    File "/home/shcho/torchtitan/timelyfreeze/train.py", line 621, in train
      draw_charts(self.freezer, self.step, job_config)
    File "/home/shcho/torchtitan/timelyfreeze/train.py", line 712, in draw_charts
      draw_elementwise_histogram(data=list(freezer.paramwise_frozen_count[s].values()), stage=s,
    File "/home/shcho/torchtitan/timelyfreeze/core/util.py", line 335, in draw_elementwise_histogram
      ax1.text(max(min(80, past_ratio - 5), 5), 0, total_count_text, ha="center", va="center", fontsize=fontsize, color="black")
                       ^^
  UnboundLocalError: cannot access local variable 'past_ratio' where it is not associated with a value
  
============================================================
