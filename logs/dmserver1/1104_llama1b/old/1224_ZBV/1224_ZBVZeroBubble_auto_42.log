
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 12. 25. (ëª©) 12:17:53 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 1,2,3,4
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/1224_ZBVZeroBubble_auto_42.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug

âœ”ï¸Running with auto x ZBVZeroBubble ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1224.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=auto --freezing.threshold=0.01 --freezing.percentile=80 --freezing.max_freeze_ratio=0.8
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank1]:2025-12-25 12:17:59,607 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank1]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank1]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank1]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank1]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank1]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank1]:"
[rank3]:2025-12-25 12:17:59,616 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:"
[rank2]:2025-12-25 12:17:59,710 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank2]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank2]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank2]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank2]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank2]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank2]:"
[rank1]:2025-12-25 12:17:59,824 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-12-25 12:17:59,826 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-25 12:17:59,803 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank0]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank0]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank0]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank0]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank0]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank0]:"
[rank3]:2025-12-25 12:17:59,867 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-12-25 12:17:59,869 - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-12-25 12:17:59,945 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-12-25 12:17:59,947 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-25 12:18:00,010 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-12-25 12:18:00,013 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-25 12:18:00,016 - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-12-25 12:18:00,018 - Loading tokenizer from tokenizer.json
[rank0]:2025-12-25 12:18:00,406 - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank3]:2025-12-25 12:18:03,276 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-12-25 12:18:03,308 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-12-25 12:18:03,348 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-25 12:18:03,377 - PP rank 2 is building stage_idx 2 with modules ['layers.5', 'layers.6']
[rank2]:2025-12-25 12:18:03,389 - PP rank 2 is building stage_idx 5 with modules ['layers.11', 'layers.12']
[rank2]:2025-12-25 12:18:03,391 - Using pipeline schedule ZBVZeroBubble with 8 microbatches and 8 stages.
[rank3]:2025-12-25 12:18:03,316 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-25 12:18:03,344 - PP rank 3 is building stage_idx 3 with modules ['layers.7', 'layers.8']
[rank3]:2025-12-25 12:18:03,357 - PP rank 3 is building stage_idx 4 with modules ['layers.9', 'layers.10']
[rank3]:2025-12-25 12:18:03,359 - Using pipeline schedule ZBVZeroBubble with 8 microbatches and 8 stages.
[rank2]:2025-12-25 12:18:03,584 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-25 12:18:03,584 - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-12-25 12:18:03,584 - CUDA memory usage for model: 0.92GiB(1.94%)
[rank3]:2025-12-25 12:18:03,557 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-25 12:18:03,557 - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-12-25 12:18:03,557 - CUDA memory usage for model: 0.92GiB(1.94%)
[rank1]:2025-12-25 12:18:03,623 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-12-25 12:18:03,661 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-25 12:18:03,687 - PP rank 1 is building stage_idx 1 with modules ['layers.2', 'layers.3', 'layers.4']
[rank1]:2025-12-25 12:18:03,700 - PP rank 1 is building stage_idx 6 with modules ['layers.13', 'layers.14']
[rank1]:2025-12-25 12:18:03,701 - Using pipeline schedule ZBVZeroBubble with 8 microbatches and 8 stages.
[rank0]:2025-12-25 12:18:03,734 - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank1]:2025-12-25 12:18:03,913 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-25 12:18:03,913 - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-12-25 12:18:03,914 - CUDA memory usage for model: 1.13GiB(2.39%)
[rank0]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank0]:wandb: Tracking run with wandb version 0.22.2
[rank0]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1224_ZBVZeroBubble_auto_42_dm1/20251225-1218/wandb/run-20251225_121804-novfbfhg
[rank0]:wandb: Run `wandb offline` to turn off syncing.
[rank0]:wandb: Syncing run 1224_ZBVZeroBubble_auto_42_dm1
[rank0]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank0]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/novfbfhg
[rank0]:2025-12-25 12:18:05,977 - WandB logging enabled
[rank0]:2025-12-25 12:18:05,978 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-12-25 12:18:06,016 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-25 12:18:06,017 - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-12-25 12:18:06,045 - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1']
[rank0]:2025-12-25 12:18:06,058 - PP rank 0 is building stage_idx 7 with modules ['layers.15', 'norm', 'output']
[rank0]:2025-12-25 12:18:06,060 - Using pipeline schedule ZBVZeroBubble with 8 microbatches and 8 stages.
[rank1]:2025-12-25 12:18:06,347 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-25 12:18:06,328 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-25 12:18:06,329 - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-12-25 12:18:06,329 - CUDA memory usage for model: 2.64GiB(5.55%)
[rank0]:2025-12-25 12:18:06,346 - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1224_ZBVZeroBubble_auto_42_dm1
[rank0]:2025-12-25 12:18:06,346 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-25 12:18:06,347 - Trainer is initialized with local batch size 32, global batch size 128, gradient accumulation steps 4, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2025-12-25 12:18:06,347 - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank2]:2025-12-25 12:18:06,347 - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-12-25 12:18:06,349 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-25 12:18:09,739 - [GC] GC collection for checkpoint loading. 0.03 seconds
[rank0]:2025-12-25 12:18:09,740 - Finished loading the checkpoint in 3.39 seconds.
[rank0]:2025-12-25 12:18:09,740 - Training starts at step 1
[rank2]:2025-12-25 12:18:14,868 -  step:  1  loss: -4.0000  grad_norm: 203.0652  memory: 11.98GiB(25.23%)  tps: 2,845  tflops: 22.24  mfu: 7.13%
[rank2]:2025-12-25 12:18:14,868 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-12-25 12:18:14,879 -  step:  1  loss: -4.0000  grad_norm: 203.0652  memory: 15.58GiB(32.80%)  tps: 2,921  tflops: 22.84  mfu: 7.32%
[rank1]:2025-12-25 12:18:14,879 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-12-25 12:18:14,869 -  step:  1  loss: -4.0000  grad_norm: 203.0652  memory: 13.45GiB(28.31%)  tps: 2,837  tflops: 22.17  mfu: 7.11%
[rank3]:2025-12-25 12:18:14,869 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-25 12:18:14,919 -  step:  1  loss: 10.6092  grad_norm: 203.0652  memory: 30.01GiB(63.17%)  tps: 3,682  tflops: 28.78  mfu: 9.23%
[rank0]:2025-12-25 12:18:14,919 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-25 12:21:56,226 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-25 12:22:01,011 - Avg. fwd time: 7.7887 / Avg. bwd-weight time: 9.8112 / Avg. bwd-input time: 9.6182 / Avg. batch time: 1051.3362 (ms) / GPU bubble ratio: 58.58%
[rank0]:2025-12-25 12:22:01,034 - Avg. fwd time: 13.6289 / Avg. full-bwd time: 28.9531 (Avg. bwd-weight time: 29.9744 / Avg. bwd-input time: 34.4834) / Avg. batch time: 1112.4366 (ms) / GPU bubble ratio: 13.22%
[rank2]:2025-12-25 12:22:01,004 - Avg. fwd time: 8.1537 / Avg. bwd-weight time: 10.0068 / Avg. bwd-input time: 10.0238 / Avg. batch time: 1055.0220 (ms) / GPU bubble ratio: 57.26%
[rank2]:2025-12-25 12:22:01,080 -  step: 50  loss: -4.0000  grad_norm: 24.5764  memory: 13.80GiB(29.05%)  tps: 7,098  tflops: 55.49  mfu: 17.78%
[rank1]:2025-12-25 12:22:01,023 - Avg. fwd time: 9.8418 / Avg. bwd-weight time: 12.9047 / Avg. bwd-input time: 12.1661 / Avg. batch time: 1090.0770 (ms) / GPU bubble ratio: 48.76%
[rank1]:2025-12-25 12:22:01,083 -  step: 50  loss: -4.0000  grad_norm: 24.5764  memory: 17.83GiB(37.53%)  tps: 7,098  tflops: 55.49  mfu: 17.79%
[rank3]:2025-12-25 12:22:01,080 -  step: 50  loss: -4.0000  grad_norm: 24.5764  memory: 15.27GiB(32.13%)  tps: 7,098  tflops: 55.49  mfu: 17.78%
[rank0]:2025-12-25 12:22:01,106 -  step: 50  loss:  9.8978  grad_norm: 24.5764  memory: 35.32GiB(74.36%)  tps: 7,099  tflops: 55.49  mfu: 17.79%
[rank1]:2025-12-25 12:22:42,936 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 0.0000e+00
[rank2]:2025-12-25 12:22:42,932 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 0.0000e+00
[rank3]:2025-12-25 12:22:42,932 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 0.0000e+00
[rank0]:2025-12-25 12:22:42,962 - Freezing Ratio: [Stage0] 0.00, [Stage7] 0.00, Threshold: 0.0000e+00
[rank0]:2025-12-25 12:23:29,382 - Freezing Ratio: [Stage0] 0.00, [Stage7] 0.00, Threshold: 5.4599e+00
[rank2]:2025-12-25 12:23:29,353 - Freezing Ratio: [Stage2] 1.00, [Stage5] 0.50, Threshold: 1.5991e+00
[rank1]:2025-12-25 12:23:29,357 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 2.6326e+00
[rank3]:2025-12-25 12:23:29,353 - Freezing Ratio: [Stage3] 1.00, [Stage4] 0.50, Threshold: 9.1940e-01
[rank2]:2025-12-25 12:24:15,873 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 9.0000e+00
[rank3]:2025-12-25 12:24:15,856 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 9.0000e+00
[rank0]:2025-12-25 12:24:16,026 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 3.3214e+00
[rank1]:2025-12-25 12:24:16,001 - Freezing Ratio: [Stage1] 0.67, [Stage6] 0.00, Threshold: 2.8538e+00
[rank0]:2025-12-25 12:24:58,989 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 9.7461e+00
[rank2]:2025-12-25 12:24:58,969 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 0.0000e+00
[rank1]:2025-12-25 12:24:58,960 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 7.8615e+00
[rank3]:2025-12-25 12:24:58,972 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 0.0000e+00
[rank0]:2025-12-25 12:25:41,803 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-25 12:25:42,149 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 1.8496e+00
[rank2]:2025-12-25 12:25:42,131 - Freezing Ratio: [Stage2] 1.00, [Stage5] 0.50, Threshold: 1.2052e+00
[rank1]:2025-12-25 12:25:42,141 - Freezing Ratio: [Stage1] 1.00, [Stage6] 0.50, Threshold: 1.3549e+00
[rank3]:2025-12-25 12:25:42,133 - Freezing Ratio: [Stage3] 1.00, [Stage4] 0.50, Threshold: 9.0456e-01
[rank2]:2025-12-25 12:25:46,272 - Avg. fwd time: 8.2379 / Avg. bwd-weight time: 8.9421 / Avg. bwd-input time: 10.0246 / Avg. batch time: 1043.5503 (ms) / GPU bubble ratio: 58.29%
[rank1]:2025-12-25 12:25:46,289 - Avg. fwd time: 9.8867 / Avg. bwd-weight time: 12.0448 / Avg. bwd-input time: 12.1795 / Avg. batch time: 1079.5189 (ms) / GPU bubble ratio: 49.44%
[rank3]:2025-12-25 12:25:46,260 - Avg. fwd time: 7.8318 / Avg. bwd-weight time: 8.7560 / Avg. bwd-input time: 9.6276 / Avg. batch time: 1037.5619 (ms) / GPU bubble ratio: 59.57%
[rank0]:2025-12-25 12:25:46,309 - Avg. fwd time: 13.7466 / Avg. full-bwd time: 26.6520 (Avg. bwd-weight time: 30.2018 / Avg. bwd-input time: 34.5585) / Avg. batch time: 1099.7639 (ms) / GPU bubble ratio: 13.50%
[rank0]:2025-12-25 12:25:46,373 -  step: 100  loss:  8.5091  grad_norm: 14.5034  memory: 35.32GiB(74.36%)  tps: 7,273  tflops: 56.86  mfu: 18.22%
[rank2]:2025-12-25 12:25:46,340 -  step: 100  loss: -4.0000  grad_norm:  0.0000  memory: 13.80GiB(29.05%)  tps: 7,273  tflops: 56.86  mfu: 18.22%
[rank1]:2025-12-25 12:25:46,340 -  step: 100  loss: -4.0000  grad_norm:  0.0000  memory: 17.83GiB(37.53%)  tps: 7,273  tflops: 56.86  mfu: 18.22%
[rank3]:2025-12-25 12:25:46,340 -  step: 100  loss: -4.0000  grad_norm:  0.0000  memory: 15.27GiB(32.13%)  tps: 7,273  tflops: 56.86  mfu: 18.22%
[rank0]:2025-12-25 12:25:46,442 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank0/251225_1225_stage0_step100.svg
[rank0]:2025-12-25 12:25:46,479 - âœ… Frozen Ratio History of Rank 0 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank0/251225_1225_stage7_step100.svg
[rank2]:2025-12-25 12:25:46,444 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank2/251225_1225_stage2_step100.svg
[rank2]:2025-12-25 12:25:46,482 - âœ… Frozen Ratio History of Rank 2 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank2/251225_1225_stage5_step100.svg
[rank1]:2025-12-25 12:25:46,443 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank1/251225_1225_stage1_step100.svg
[rank1]:2025-12-25 12:25:46,481 - âœ… Frozen Ratio History of Rank 1 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank1/251225_1225_stage6_step100.svg
[rank3]:2025-12-25 12:25:46,729 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/pipeline_schedule/251225_1225_step100_rank3.svg
[rank3]:			> Batch Time: 1041.55 ms, GPU Bubble Ratio: 15.40%, 46.16%, 56.55%, 58.13%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-9-26ms      | [S0,MB3,F]  26-8-35ms      | [S0,MB4,F]  35-10-45ms     | [S0,MB5,F]  45-9-55ms      | [S0,MB6,F]  54-10-65ms     | [S7,MB0,F]  121-16-138ms   | [S7,MB0,BI] 150-32-182ms   | [S7,MB0,BW] 182-25-208ms   | [S7,MB1,F]  210-16-226ms   | [S7,MB1,BI] 237-34-272ms   | [S7,MB1,BW] 272-29-301ms   | [S7,MB2,F]  301-19-320ms   | [S7,MB2,BI] 332-35-367ms   | [S7,MB2,BW] 367-31-399ms   | [S7,MB3,F]  397-19-417ms   | [S7,MB3,BI] 429-35-464ms   | [S7,MB3,BW] 464-32-496ms   | [S0,MB7,F]  496-11-507ms   | [S0,MB0,B]  507-18-526ms   | [S7,MB4,F]  525-18-543ms   | [S7,MB4,BI] 556-34-590ms   | [S7,MB4,BW] 590-30-620ms   | [S0,MB1,B]  620-17-637ms   | [S7,MB5,F]  638-18-656ms   | [S7,MB5,BI] 668-34-703ms   | [S7,MB5,BW] 702-31-734ms   | [S0,MB2,B]  734-17-751ms   | [S7,MB6,F]  751-18-770ms   | [S7,MB6,BI] 781-34-816ms   | [S7,MB6,BW] 816-29-846ms   | [S0,MB3,B]  846-17-864ms   | [S7,MB7,F]  864-18-882ms   | [S7,MB7,BI] 894-34-928ms   | [S7,MB7,BW] 928-31-959ms   | [S0,MB4,B]  959-17-977ms   | [S0,MB5,B]  977-17-995ms   | [S0,MB6,B]  995-17-1012ms  | [S0,MB7,B]  1021-16-1037ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-21ms      | [S1,MB1,F]  27-11-38ms     | [S1,MB2,F]  45-11-56ms     | [S1,MB3,F]  63-11-74ms     | [S1,MB4,F]  86-10-97ms     | [S6,MB0,F]  97-10-107ms    | [S1,MB5,F]  107-13-120ms   | [S6,MB1,F]  120-8-129ms    | [S6,MB0,BI] 175-9-184ms    | [S6,MB0,BW] 184-10-195ms   | [S6,MB2,F]  194-7-201ms    | [S6,MB1,BI] 264-9-274ms    | [S6,MB1,BW] 273-10-284ms   | [S6,MB3,F]  283-7-291ms    | [S6,MB2,BI] 360-9-369ms    | [S6,MB2,BW] 369-10-380ms   | [S1,MB6,F]  379-10-390ms   | [S1,MB0,BI] 390-15-406ms   | [S1,MB0,BW] 406-14-421ms   | [S6,MB4,F]  419-7-427ms    | [S6,MB3,BI] 457-10-467ms   | [S6,MB3,BW] 467-9-477ms    | [S1,MB7,F]  500-13-514ms   | [S1,MB1,BI] 514-15-530ms   | [S1,MB1,BW] 530-14-544ms   | [S6,MB5,F]  543-7-551ms    | [S6,MB4,BI] 582-10-592ms   | [S6,MB4,BW] 593-9-602ms    | [S1,MB2,BI] 620-14-634ms   | [S1,MB2,BW] 634-14-649ms   | [S6,MB6,F]  704-7-711ms    | [S6,MB5,BI] 711-9-721ms    | [S6,MB5,BW] 721-11-732ms   | [S1,MB3,BI] 735-14-749ms   | [S1,MB3,BW] 749-14-764ms   | [S6,MB7,F]  819-7-826ms    | [S6,MB6,BI] 826-9-836ms    | [S6,MB6,BW] 835-11-846ms   | [S1,MB4,BI] 848-14-862ms   | [S6,MB7,BI] 921-10-931ms   | [S1,MB5,BI] 932-14-947ms   | [S1,MB4,BW] 947-16-963ms   | [S1,MB6,BI] 963-14-977ms   | [S1,MB5,BW] 977-15-993ms   | [S1,MB7,BI] 992-14-1006ms  | [S1,MB6,BW] 1006-16-1023ms | [S6,MB7,BW] 1022-10-1033ms | [S1,MB7,BW] 1033-16-1050ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-8-29ms      | [S2,MB1,F]  38-7-45ms      | [S2,MB2,F]  56-7-63ms      | [S5,MB0,F]  63-9-72ms      | [S2,MB3,F]  74-9-83ms      | [S5,MB1,F]  83-7-91ms      | [S2,MB4,F]  96-10-107ms    | [S5,MB2,F]  115-8-124ms    | [S5,MB0,BI] 185-9-194ms    | [S5,MB0,BW] 194-10-204ms   | [S5,MB3,F]  203-7-211ms    | [S5,MB1,BI] 274-9-283ms    | [S5,MB1,BW] 283-10-294ms   | [S2,MB5,F]  293-7-300ms    | [S2,MB0,BI] 300-10-311ms   | [S2,MB0,BW] 311-9-321ms    | [S5,MB4,F]  320-7-328ms    | [S5,MB2,BI] 369-10-379ms   | [S5,MB2,BW] 379-9-389ms    | [S2,MB6,F]  391-9-401ms    | [S2,MB1,BI] 403-10-413ms   | [S2,MB1,BW] 413-9-423ms    | [S5,MB5,F]  423-7-430ms    | [S5,MB3,BI] 505-10-515ms   | [S5,MB3,BW] 515-11-527ms   | [S2,MB7,F]  527-7-535ms    | [S2,MB2,BI] 535-10-545ms   | [S2,MB2,BW] 545-9-555ms    | [S5,MB6,F]  555-7-562ms    | [S5,MB4,BI] 613-10-624ms   | [S5,MB4,BW] 624-9-633ms    | [S2,MB3,BI] 707-9-717ms    | [S2,MB3,BW] 717-10-727ms   | [S5,MB7,F]  734-7-742ms    | [S5,MB5,BI] 741-9-751ms    | [S5,MB5,BW] 751-9-760ms    | [S2,MB4,BI] 822-9-831ms    | [S5,MB6,BI] 840-10-851ms   | [S2,MB5,BI] 851-10-861ms   | [S5,MB7,BI] 935-9-944ms    | [S2,MB6,BI] 944-10-955ms   | [S2,MB4,BW] 955-10-966ms   | [S2,MB7,BI] 971-9-980ms    | [S2,MB5,BW] 980-10-990ms   | [S5,MB6,BW] 990-9-1000ms   | [S5,MB7,BW] 1000-9-1009ms  | [S2,MB6,BW] 1010-9-1019ms  | [S2,MB7,BW] 1020-10-1030ms
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-7-37ms      | [S4,MB0,F]  37-8-45ms      | [S3,MB1,F]  46-8-55ms      | [S4,MB1,F]  55-7-62ms      | [S3,MB2,F]  64-7-71ms      | [S4,MB2,F]  71-7-79ms      | [S3,MB3,F]  99-7-106ms     | [S4,MB3,F]  106-8-114ms    | [S4,MB0,BI] 194-9-203ms    | [S4,MB0,BW] 203-9-212ms    | [S3,MB4,F]  212-7-219ms    | [S3,MB0,BI] 219-9-228ms    | [S3,MB0,BW] 228-9-238ms    | [S4,MB4,F]  238-7-245ms    | [S4,MB1,BI] 283-10-293ms   | [S4,MB1,BW] 294-10-304ms   | [S3,MB5,F]  303-8-311ms    | [S3,MB1,BI] 311-9-321ms    | [S3,MB1,BW] 321-9-330ms    | [S4,MB5,F]  330-7-338ms    | [S4,MB2,BI] 396-11-407ms   | [S4,MB2,BW] 407-9-417ms    | [S3,MB6,F]  417-7-424ms    | [S3,MB2,BI] 424-9-433ms    | [S3,MB2,BW] 433-9-443ms    | [S4,MB6,F]  443-7-450ms    | [S4,MB3,BI] 520-10-530ms   | [S4,MB3,BW] 530-10-540ms   | [S3,MB7,F]  540-7-548ms    | [S3,MB3,BI] 547-9-557ms    | [S3,MB3,BW] 557-9-566ms    | [S4,MB7,F]  566-7-574ms    | [S4,MB4,BI] 701-10-711ms   | [S4,MB4,BW] 711-9-720ms    | [S3,MB4,BI] 721-10-731ms   | [S4,MB5,BI] 815-10-825ms   | [S3,MB5,BI] 825-9-834ms    | [S4,MB6,BI] 851-9-860ms    | [S3,MB6,BI] 860-9-869ms    | [S4,MB7,BI] 946-9-955ms    | [S3,MB7,BI] 955-9-964ms    | [S3,MB4,BW] 964-10-975ms   | [S4,MB5,BW] 975-9-984ms    | [S4,MB6,BW] 984-9-994ms    | [S4,MB7,BW] 994-9-1003ms   | [S3,MB5,BW] 1003-10-1013ms | [S3,MB6,BW] 1013-10-1023ms | [S3,MB7,BW] 1024-10-1034ms
[rank3]:2025-12-25 12:25:46,770 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank3/251225_1225_stage3_step100.svg
[rank3]:2025-12-25 12:25:46,815 - âœ… Frozen Ratio History of Rank 3 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank3/251225_1225_stage4_step100.svg
[rank2]:2025-12-25 12:26:25,228 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 9.0000e+00
[rank3]:2025-12-25 12:26:25,216 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 9.0000e+00
[rank1]:2025-12-25 12:26:25,247 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 9.0000e+00
[rank0]:2025-12-25 12:26:25,329 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 2.0957e+00
[rank0]:2025-12-25 12:27:08,644 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 2.1739e+00
[rank3]:2025-12-25 12:27:08,627 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 0.0000e+00
[rank2]:2025-12-25 12:27:08,626 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 0.0000e+00
[rank1]:2025-12-25 12:27:08,636 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 0.0000e+00
[rank3]:2025-12-25 12:27:51,945 - Freezing Ratio: [Stage3] 0.50, [Stage4] 0.00, Threshold: 2.5036e+00
[rank2]:2025-12-25 12:27:51,943 - Freezing Ratio: [Stage2] 1.00, [Stage5] 0.50, Threshold: 7.5997e+00
[rank1]:2025-12-25 12:27:51,953 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 6.3105e+00
[rank0]:2025-12-25 12:27:51,962 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 5.5040e+00
[rank3]:2025-12-25 12:28:35,116 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 6.0132e+00
[rank2]:2025-12-25 12:28:35,041 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 9.0000e+00
[rank0]:2025-12-25 12:28:35,144 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 2.5758e+00
[rank1]:2025-12-25 12:28:35,134 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 2.3322e+00
[rank0]:2025-12-25 12:29:17,985 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-25 12:29:18,335 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 1.4880e+00
[rank3]:2025-12-25 12:29:18,318 - Freezing Ratio: [Stage3] 1.00, [Stage4] 0.50, Threshold: 2.4281e+00
[rank2]:2025-12-25 12:29:18,316 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 0.0000e+00
[rank1]:2025-12-25 12:29:18,326 - Freezing Ratio: [Stage1] 1.00, [Stage6] 0.50, Threshold: 2.7007e+00
[rank3]:2025-12-25 12:29:22,539 - Avg. fwd time: 7.8435 / Avg. bwd-weight time: 8.1379 / Avg. bwd-input time: 9.6302 / Avg. batch time: 1021.1916 (ms) / GPU bubble ratio: 59.87%
[rank1]:2025-12-25 12:29:22,568 - Avg. fwd time: 9.9508 / Avg. bwd-weight time: 11.4987 / Avg. bwd-input time: 12.1792 / Avg. batch time: 1066.6962 (ms) / GPU bubble ratio: 49.56%
[rank0]:2025-12-25 12:29:22,587 - Avg. fwd time: 13.8087 / Avg. full-bwd time: 23.5846 (Avg. bwd-weight time: 30.2810 / Avg. bwd-input time: 34.5506) / Avg. batch time: 1080.9780 (ms) / GPU bubble ratio: 14.13%
[rank0]:2025-12-25 12:29:22,651 -  step: 150  loss:  4.8581  grad_norm: 18.8223  memory: 35.32GiB(74.36%)  tps: 7,575  tflops: 59.22  mfu: 18.98%
[rank3]:2025-12-25 12:29:22,618 -  step: 150  loss: -4.0000  grad_norm:  0.0000  memory: 15.27GiB(32.13%)  tps: 7,575  tflops: 59.22  mfu: 18.98%
[rank2]:2025-12-25 12:29:22,601 - Avg. fwd time: 8.3091 / Avg. bwd-weight time: 8.0518 / Avg. bwd-input time: 10.0192 / Avg. batch time: 1028.0108 (ms) / GPU bubble ratio: 58.94%
[rank2]:2025-12-25 12:29:22,632 -  step: 150  loss: -4.0000  grad_norm: 18.8223  memory: 13.80GiB(29.05%)  tps: 7,575  tflops: 59.22  mfu: 18.98%
[rank1]:2025-12-25 12:29:22,618 -  step: 150  loss: -4.0000  grad_norm:  0.0000  memory: 17.83GiB(37.53%)  tps: 7,575  tflops: 59.22  mfu: 18.98%
[rank3]:2025-12-25 12:30:01,050 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 9.0000e+00
[rank1]:2025-12-25 12:30:01,083 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 9.0000e+00
[rank0]:2025-12-25 12:30:01,165 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 3.9142e+00
[rank2]:2025-12-25 12:30:01,147 - Freezing Ratio: [Stage2] 1.00, [Stage5] 0.50, Threshold: 4.2517e+00
[rank2]:2025-12-25 12:30:44,340 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 9.0000e+00
[rank0]:2025-12-25 12:30:44,442 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 9.1348e+00
[rank1]:2025-12-25 12:30:44,433 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 0.0000e+00
[rank3]:2025-12-25 12:30:44,424 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 0.0000e+00
[rank0]:2025-12-25 12:31:27,590 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 7.8695e+00
[rank1]:2025-12-25 12:31:27,580 - Freezing Ratio: [Stage1] 1.00, [Stage6] 0.00, Threshold: 7.5617e+00
[rank3]:2025-12-25 12:31:27,572 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 4.5303e+00
[rank2]:2025-12-25 12:31:27,570 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 0.0000e+00
[rank0]:2025-12-25 12:32:10,277 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 1.6282e+00
[rank2]:2025-12-25 12:32:10,257 - Freezing Ratio: [Stage2] 1.00, [Stage5] 0.50, Threshold: 2.7396e+00
[rank3]:2025-12-25 12:32:10,260 - Freezing Ratio: [Stage3] 1.00, [Stage4] 0.50, Threshold: 2.7661e+00
[rank1]:2025-12-25 12:32:10,248 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 4.3453e+00
[rank0]:2025-12-25 12:32:53,129 - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-12-25 12:32:53,384 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 9.0000e+00
[rank3]:2025-12-25 12:32:53,369 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 9.0000e+00
[rank0]:2025-12-25 12:32:53,488 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 5.3757e+00
[rank1]:2025-12-25 12:32:53,478 - Freezing Ratio: [Stage1] 1.00, [Stage6] 0.50, Threshold: 3.2893e+00
[rank0]:2025-12-25 12:32:57,789 - Avg. fwd time: 13.8380 / Avg. full-bwd time: 22.0480 (Avg. bwd-weight time: 30.2780 / Avg. bwd-input time: 34.5496) / Avg. batch time: 1070.3653 (ms) / GPU bubble ratio: 14.38%
[rank2]:2025-12-25 12:32:57,801 - Avg. fwd time: 8.3428 / Avg. bwd-weight time: 7.5619 / Avg. bwd-input time: 10.0204 / Avg. batch time: 1019.4274 (ms) / GPU bubble ratio: 59.31%
[rank2]:2025-12-25 12:32:57,834 -  step: 200  loss: -4.0000  grad_norm: 14.0556  memory: 13.80GiB(29.05%)  tps: 7,613  tflops: 59.52  mfu: 19.08%
[rank1]:2025-12-25 12:32:57,768 - Avg. fwd time: 10.0067 / Avg. bwd-weight time: 10.8374 / Avg. bwd-input time: 12.1786 / Avg. batch time: 1057.6066 (ms) / GPU bubble ratio: 50.04%
[rank1]:2025-12-25 12:32:57,820 -  step: 200  loss: -4.0000  grad_norm:  0.0000  memory: 17.83GiB(37.53%)  tps: 7,613  tflops: 59.52  mfu: 19.08%
[rank3]:2025-12-25 12:32:57,808 - Avg. fwd time: 7.8701 / Avg. bwd-weight time: 7.6342 / Avg. bwd-input time: 9.6326 / Avg. batch time: 1011.7179 (ms) / GPU bubble ratio: 60.25%
[rank3]:2025-12-25 12:32:57,835 -  step: 200  loss: -4.0000  grad_norm: 14.0556  memory: 15.27GiB(32.13%)  tps: 7,613  tflops: 59.51  mfu: 19.07%
[rank0]:2025-12-25 12:32:57,853 -  step: 200  loss:  1.2219  grad_norm: 14.0556  memory: 35.32GiB(74.36%)  tps: 7,613  tflops: 59.52  mfu: 19.08%
[rank0]:2025-12-25 12:32:57,904 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank0/251225_1232_stage0_step200.svg
[rank2]:2025-12-25 12:32:57,906 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank2/251225_1232_stage2_step200.svg
[rank2]:2025-12-25 12:32:57,948 - âœ… Frozen Ratio History of Rank 2 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank2/251225_1232_stage5_step200.svg
[rank1]:2025-12-25 12:32:57,906 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank1/251225_1232_stage1_step200.svg
[rank1]:2025-12-25 12:32:57,949 - âœ… Frozen Ratio History of Rank 1 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank1/251225_1232_stage6_step200.svg
[rank0]:2025-12-25 12:32:57,946 - âœ… Frozen Ratio History of Rank 0 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank0/251225_1232_stage7_step200.svg
[rank3]:2025-12-25 12:32:58,176 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/pipeline_schedule/251225_1232_step200_rank3.svg
[rank3]:			> Batch Time: 1044.50 ms, GPU Bubble Ratio: 15.35%, 46.15%, 70.91%, 72.57%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-9-17ms       | [S0,MB2,F]  17-9-27ms      | [S0,MB3,F]  26-8-35ms      | [S0,MB4,F]  35-9-45ms      | [S0,MB5,F]  45-9-55ms      | [S0,MB6,F]  55-10-65ms     | [S7,MB0,F]  122-17-139ms   | [S7,MB0,BI] 151-32-184ms   | [S7,MB0,BW] 183-27-211ms   | [S7,MB1,F]  210-16-227ms   | [S7,MB1,BI] 238-34-273ms   | [S7,MB1,BW] 273-29-303ms   | [S7,MB2,F]  302-19-322ms   | [S7,MB2,BI] 333-35-369ms   | [S7,MB2,BW] 369-30-400ms   | [S7,MB3,F]  399-19-418ms   | [S7,MB3,BI] 430-34-465ms   | [S7,MB3,BW] 465-31-496ms   | [S0,MB7,F]  496-11-507ms   | [S0,MB0,B]  508-18-526ms   | [S7,MB4,F]  527-18-545ms   | [S7,MB4,BI] 556-34-591ms   | [S7,MB4,BW] 591-30-621ms   | [S0,MB1,B]  621-17-638ms   | [S7,MB5,F]  638-18-656ms   | [S7,MB5,BI] 669-34-703ms   | [S7,MB5,BW] 703-31-734ms   | [S0,MB2,B]  733-17-751ms   | [S7,MB6,F]  751-18-770ms   | [S7,MB6,BI] 782-34-816ms   | [S7,MB6,BW] 816-30-846ms   | [S0,MB3,B]  847-17-865ms   | [S7,MB7,F]  865-18-884ms   | [S7,MB7,BI] 896-34-930ms   | [S7,MB7,BW] 931-30-961ms   | [S0,MB4,B]  961-17-978ms   | [S0,MB5,B]  979-17-996ms   | [S0,MB6,B]  997-17-1014ms  | [S0,MB7,B]  1023-16-1039ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-21ms      | [S1,MB1,F]  27-11-38ms     | [S1,MB2,F]  45-11-56ms     | [S1,MB3,F]  63-11-74ms     | [S1,MB4,F]  86-11-97ms     | [S6,MB0,F]  97-10-108ms    | [S1,MB5,F]  108-13-121ms   | [S6,MB1,F]  121-8-130ms    | [S6,MB0,BI] 176-9-185ms    | [S6,MB0,BW] 186-10-196ms   | [S6,MB2,F]  195-7-203ms    | [S6,MB1,BI] 266-9-275ms    | [S6,MB1,BW] 276-10-286ms   | [S6,MB3,F]  285-7-292ms    | [S6,MB2,BI] 362-9-371ms    | [S6,MB2,BW] 371-10-382ms   | [S1,MB6,F]  381-11-392ms   | [S1,MB0,BI] 393-15-408ms   | [S1,MB0,BW] 408-15-423ms   | [S6,MB4,F]  421-8-429ms    | [S6,MB3,BI] 459-10-469ms   | [S6,MB3,BW] 469-9-478ms    | [S1,MB7,F]  501-13-515ms   | [S1,MB1,BI] 516-15-531ms   | [S1,MB1,BW] 531-14-546ms   | [S6,MB5,F]  543-7-550ms    | [S6,MB4,BI] 583-10-594ms   | [S6,MB4,BW] 594-9-603ms    | [S1,MB2,BI] 622-14-636ms   | [S1,MB2,BW] 636-14-651ms   | [S6,MB6,F]  706-7-713ms    | [S6,MB5,BI] 713-9-723ms    | [S6,MB5,BW] 723-11-734ms   | [S1,MB3,BI] 737-14-751ms   | [S1,MB3,BW] 751-14-766ms   | [S6,MB7,F]  821-7-828ms    | [S6,MB6,BI] 828-9-838ms    | [S6,MB6,BW] 838-11-849ms   | [S1,MB4,BI] 851-14-865ms   | [S6,MB7,BI] 926-10-937ms   | [S1,MB5,BI] 937-15-952ms   | [S1,MB4,BW] 952-16-968ms   | [S1,MB6,BI] 968-14-982ms   | [S1,MB5,BW] 982-15-998ms   | [S1,MB7,BI] 997-14-1012ms  | [S1,MB6,BW] 1011-16-1028ms | [S6,MB7,BW] 1027-10-1038ms | [S1,MB7,BW] 1036-16-1053ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-8-29ms      | [S2,MB1,F]  38-8-47ms      | [S2,MB2,F]  56-8-65ms      | [S5,MB0,F]  65-9-74ms      | [S2,MB3,F]  75-10-85ms     | [S5,MB1,F]  85-7-93ms      | [S2,MB4,F]  97-11-108ms    | [S5,MB2,F]  116-9-125ms    | [S5,MB0,BI] 186-9-195ms    | [S5,MB0,BW] 195-0-195ms    | [S5,MB3,F]  195-8-204ms    | [S5,MB1,BI] 276-9-285ms    | [S5,MB1,BW] 285-0-285ms    | [S2,MB5,F]  287-9-297ms    | [S2,MB0,BI] 297-10-307ms   | [S2,MB0,BW] 307-0-307ms    | [S5,MB4,F]  307-7-315ms    | [S5,MB2,BI] 371-10-381ms   | [S5,MB2,BW] 382-0-382ms    | [S2,MB6,F]  394-10-404ms   | [S2,MB1,BI] 405-10-416ms   | [S2,MB1,BW] 416-0-416ms    | [S5,MB5,F]  417-7-425ms    | [S5,MB3,BI] 506-10-517ms   | [S5,MB3,BW] 517-0-517ms    | [S2,MB7,F]  519-10-529ms   | [S2,MB2,BI] 530-10-540ms   | [S2,MB2,BW] 540-0-540ms    | [S5,MB6,F]  541-7-549ms    | [S5,MB4,BI] 615-10-626ms   | [S5,MB4,BW] 626-0-626ms    | [S2,MB3,BI] 709-9-718ms    | [S2,MB3,BW] 718-0-718ms    | [S5,MB7,F]  736-7-744ms    | [S5,MB5,BI] 744-9-753ms    | [S5,MB5,BW] 753-0-753ms    | [S2,MB4,BI] 824-9-834ms    | [S5,MB6,BI] 844-10-854ms   | [S2,MB5,BI] 854-10-865ms   | [S5,MB7,BI] 939-9-949ms    | [S2,MB6,BI] 949-10-960ms   | [S2,MB4,BW] 960-0-960ms    | [S2,MB7,BI] 975-9-984ms    | [S2,MB5,BW] 984-0-984ms    | [S5,MB6,BW] 985-0-985ms    | [S5,MB7,BW] 988-0-988ms    | [S2,MB6,BW] 988-0-988ms    | [S2,MB7,BW] 988-0-988ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-7-37ms      | [S4,MB0,F]  37-8-45ms      | [S3,MB1,F]  47-9-56ms      | [S4,MB1,F]  56-7-64ms      | [S3,MB2,F]  65-8-74ms      | [S4,MB2,F]  74-8-82ms      | [S3,MB3,F]  99-8-108ms     | [S4,MB3,F]  108-8-116ms    | [S4,MB0,BI] 195-9-204ms    | [S4,MB0,BW] 204-0-204ms    | [S3,MB4,F]  204-7-212ms    | [S3,MB0,BI] 212-9-221ms    | [S3,MB0,BW] 221-0-221ms    | [S4,MB4,F]  221-7-229ms    | [S4,MB1,BI] 285-10-296ms   | [S4,MB1,BW] 296-0-296ms    | [S3,MB5,F]  298-9-307ms    | [S3,MB1,BI] 307-9-316ms    | [S3,MB1,BW] 316-0-316ms    | [S4,MB5,F]  316-7-324ms    | [S4,MB2,BI] 398-11-409ms   | [S4,MB2,BW] 409-0-409ms    | [S3,MB6,F]  411-8-419ms    | [S3,MB2,BI] 419-9-428ms    | [S3,MB2,BW] 428-0-428ms    | [S4,MB6,F]  428-7-436ms    | [S4,MB3,BI] 521-11-533ms   | [S4,MB3,BW] 532-0-532ms    | [S3,MB7,F]  534-8-543ms    | [S3,MB3,BI] 543-9-552ms    | [S3,MB3,BW] 552-0-552ms    | [S4,MB7,F]  552-7-560ms    | [S4,MB4,BI] 702-10-713ms   | [S4,MB4,BW] 713-0-713ms    | [S3,MB4,BI] 714-9-724ms    | [S4,MB5,BI] 817-10-827ms   | [S3,MB5,BI] 828-9-837ms    | [S4,MB6,BI] 854-9-864ms    | [S3,MB6,BI] 863-9-873ms    | [S4,MB7,BI] 950-9-960ms    | [S3,MB7,BI] 959-9-969ms    | [S3,MB4,BW] 968-0-968ms    | [S4,MB5,BW] 969-0-969ms    | [S4,MB6,BW] 972-0-972ms    | [S4,MB7,BW] 972-0-972ms    | [S3,MB5,BW] 972-0-972ms    | [S3,MB6,BW] 972-0-972ms    | [S3,MB7,BW] 972-0-972ms   
[rank3]:2025-12-25 12:32:58,219 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank3/251225_1232_stage3_step200.svg
[rank3]:2025-12-25 12:32:58,260 - âœ… Frozen Ratio History of Rank 3 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank3/251225_1232_stage4_step200.svg
[rank1]:2025-12-25 12:33:36,750 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 9.0000e+00
[rank3]:2025-12-25 12:33:36,814 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 0.0000e+00
[rank0]:2025-12-25 12:33:36,831 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 4.0690e+00
[rank2]:2025-12-25 12:33:36,811 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 0.0000e+00
[rank3]:2025-12-25 12:34:20,070 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 9.4603e+00
[rank0]:2025-12-25 12:34:20,086 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 1.0284e+01
[rank1]:2025-12-25 12:34:20,077 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 0.0000e+00
[rank2]:2025-12-25 12:34:20,068 - Freezing Ratio: [Stage2] 1.00, [Stage5] 0.50, Threshold: 1.3075e+01
[rank2]:2025-12-25 12:35:03,266 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 9.0000e+00
[rank0]:2025-12-25 12:35:03,370 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 2.8803e+00
[rank1]:2025-12-25 12:35:03,361 - Freezing Ratio: [Stage1] 1.00, [Stage6] 0.00, Threshold: 4.1810e+00
[rank3]:2025-12-25 12:35:03,353 - Freezing Ratio: [Stage3] 1.00, [Stage4] 0.50, Threshold: 3.2543e+00
[rank3]:2025-12-25 12:35:46,099 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 9.0000e+00
[rank0]:2025-12-25 12:35:46,215 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 4.9441e+00
[rank2]:2025-12-25 12:35:46,195 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 0.0000e+00
[rank1]:2025-12-25 12:35:46,186 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 4.7917e+00
[rank0]:2025-12-25 12:36:29,207 - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-12-25 12:36:29,536 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 3.8149e+00
[rank3]:2025-12-25 12:36:29,539 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 0.0000e+00
[rank1]:2025-12-25 12:36:29,547 - Freezing Ratio: [Stage1] 1.00, [Stage6] 0.00, Threshold: 2.2551e+00
[rank0]:2025-12-25 12:36:29,556 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 3.5690e+00
[rank1]:2025-12-25 12:36:33,749 - Avg. fwd time: 10.0372 / Avg. bwd-weight time: 10.4600 / Avg. bwd-input time: 12.1771 / Avg. batch time: 1052.8491 (ms) / GPU bubble ratio: 50.35%
[rank1]:2025-12-25 12:36:33,794 -  step: 250  loss: -4.0000  grad_norm: 14.7228  memory: 17.83GiB(37.53%)  tps: 7,586  tflops: 59.30  mfu: 19.01%
[rank0]:2025-12-25 12:36:33,756 - Avg. fwd time: 13.8655 / Avg. full-bwd time: 21.1330 (Avg. bwd-weight time: 30.2958 / Avg. bwd-input time: 34.5609) / Avg. batch time: 1064.6793 (ms) / GPU bubble ratio: 14.55%
[rank0]:2025-12-25 12:36:33,821 -  step: 250  loss:  1.2871  grad_norm: 14.7228  memory: 35.32GiB(74.36%)  tps: 7,586  tflops: 59.31  mfu: 19.01%
[rank2]:2025-12-25 12:36:33,771 - Avg. fwd time: 8.3286 / Avg. bwd-weight time: 7.6698 / Avg. bwd-input time: 10.0215 / Avg. batch time: 1016.9262 (ms) / GPU bubble ratio: 59.06%
[rank2]:2025-12-25 12:36:33,802 -  step: 250  loss: -4.0000  grad_norm: 14.7228  memory: 13.80GiB(29.05%)  tps: 7,586  tflops: 59.31  mfu: 19.01%
[rank3]:2025-12-25 12:36:33,779 - Avg. fwd time: 7.8659 / Avg. bwd-weight time: 7.6867 / Avg. bwd-input time: 9.6341 / Avg. batch time: 1008.9343 (ms) / GPU bubble ratio: 60.06%
[rank3]:2025-12-25 12:36:33,803 -  step: 250  loss: -4.0000  grad_norm: 14.7228  memory: 15.27GiB(32.13%)  tps: 7,586  tflops: 59.31  mfu: 19.01%
[rank2]:2025-12-25 12:37:12,307 - Freezing Ratio: [Stage2] 1.00, [Stage5] 0.50, Threshold: 2.5846e+00
[rank1]:2025-12-25 12:37:12,298 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 2.2611e+00
[rank0]:2025-12-25 12:37:12,327 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 2.5070e+00
[rank3]:2025-12-25 12:37:12,309 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 2.7663e+00
[rank2]:2025-12-25 12:37:55,492 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 9.0000e+00
[rank1]:2025-12-25 12:37:55,586 - Freezing Ratio: [Stage1] 1.00, [Stage6] 0.50, Threshold: 3.1577e+00
[rank0]:2025-12-25 12:37:55,596 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 2.4877e+00
[rank3]:2025-12-25 12:37:55,579 - Freezing Ratio: [Stage3] 1.00, [Stage4] 0.00, Threshold: 6.1508e+00
[rank1]:2025-12-25 12:38:38,377 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 9.0000e+00
[rank0]:2025-12-25 12:38:38,458 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 3.8915e+00
[rank2]:2025-12-25 12:38:38,438 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 0.0000e+00
[rank3]:2025-12-25 12:38:38,430 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 7.8039e+00
[rank1]:2025-12-25 12:39:21,840 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 0.0000e+00
[rank0]:2025-12-25 12:39:21,850 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 2.0486e+00
[rank2]:2025-12-25 12:39:21,830 - Freezing Ratio: [Stage2] 1.00, [Stage5] 0.50, Threshold: 1.1835e+00
[rank3]:2025-12-25 12:39:21,833 - Freezing Ratio: [Stage3] 1.00, [Stage4] 0.00, Threshold: 7.5681e-01
[rank0]:2025-12-25 12:40:04,656 - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-12-25 12:40:04,904 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 9.0000e+00
[rank1]:2025-12-25 12:40:04,996 - Freezing Ratio: [Stage1] 1.00, [Stage6] 0.50, Threshold: 2.5221e+00
[rank0]:2025-12-25 12:40:05,005 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 1.4862e+00
[rank3]:2025-12-25 12:40:04,978 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 1.5773e+00
[rank1]:2025-12-25 12:40:09,190 - Avg. fwd time: 10.0593 / Avg. bwd-weight time: 10.1740 / Avg. bwd-input time: 12.1760 / Avg. batch time: 1049.2454 (ms) / GPU bubble ratio: 50.58%
[rank0]:2025-12-25 12:40:09,208 - Avg. fwd time: 13.8804 / Avg. full-bwd time: 20.5227 (Avg. bwd-weight time: 30.2986 / Avg. bwd-input time: 34.5621) / Avg. batch time: 1060.5294 (ms) / GPU bubble ratio: 14.65%
[rank3]:2025-12-25 12:40:09,231 - Avg. fwd time: 7.8627 / Avg. bwd-weight time: 7.7186 / Avg. bwd-input time: 9.6418 / Avg. batch time: 1006.5666 (ms) / GPU bubble ratio: 59.91%
[rank2]:2025-12-25 12:40:09,222 - Avg. fwd time: 8.3459 / Avg. bwd-weight time: 7.4053 / Avg. bwd-input time: 10.0210 / Avg. batch time: 1013.2286 (ms) / GPU bubble ratio: 59.30%
[rank1]:2025-12-25 12:40:09,239 -  step: 300  loss: -4.0000  grad_norm:  0.0000  memory: 17.83GiB(37.53%)  tps: 7,605  tflops: 59.45  mfu: 19.05%
[rank0]:2025-12-25 12:40:09,272 -  step: 300  loss:  0.3639  grad_norm:  2.6648  memory: 35.32GiB(74.36%)  tps: 7,605  tflops: 59.45  mfu: 19.05%
[rank0]:2025-12-25 12:40:09,321 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank0/251225_1240_stage0_step300.svg
[rank3]:2025-12-25 12:40:09,254 -  step: 300  loss: -4.0000  grad_norm:  2.6648  memory: 15.27GiB(32.13%)  tps: 7,605  tflops: 59.45  mfu: 19.05%
[rank2]:2025-12-25 12:40:09,252 -  step: 300  loss: -4.0000  grad_norm:  2.6648  memory: 13.80GiB(29.05%)  tps: 7,605  tflops: 59.45  mfu: 19.05%
[rank2]:2025-12-25 12:40:09,323 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank2/251225_1240_stage2_step300.svg
[rank1]:2025-12-25 12:40:09,325 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank1/251225_1240_stage1_step300.svg
[rank1]:2025-12-25 12:40:09,369 - âœ… Frozen Ratio History of Rank 1 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank1/251225_1240_stage6_step300.svg
[rank0]:2025-12-25 12:40:09,361 - âœ… Frozen Ratio History of Rank 0 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank0/251225_1240_stage7_step300.svg
[rank2]:2025-12-25 12:40:09,363 - âœ… Frozen Ratio History of Rank 2 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank2/251225_1240_stage5_step300.svg
[rank3]:2025-12-25 12:40:09,606 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/pipeline_schedule/251225_1240_step300_rank3.svg
[rank3]:			> Batch Time: 1044.56 ms, GPU Bubble Ratio: 15.61%, 46.16%, 70.98%, 65.38%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-9-26ms      | [S0,MB3,F]  26-8-35ms      | [S0,MB4,F]  35-10-45ms     | [S0,MB5,F]  45-9-54ms      | [S0,MB6,F]  54-10-64ms     | [S7,MB0,F]  123-17-140ms   | [S7,MB0,BI] 152-32-185ms   | [S7,MB0,BW] 185-26-211ms   | [S7,MB1,F]  212-16-228ms   | [S7,MB1,BI] 239-34-274ms   | [S7,MB1,BW] 274-29-304ms   | [S7,MB2,F]  303-19-322ms   | [S7,MB2,BI] 333-34-368ms   | [S7,MB2,BW] 368-31-399ms   | [S7,MB3,F]  399-19-418ms   | [S7,MB3,BI] 430-34-465ms   | [S7,MB3,BW] 465-31-497ms   | [S0,MB7,F]  497-11-508ms   | [S0,MB0,B]  508-18-526ms   | [S7,MB4,F]  526-18-544ms   | [S7,MB4,BI] 556-34-591ms   | [S7,MB4,BW] 591-30-621ms   | [S0,MB1,B]  621-17-638ms   | [S7,MB5,F]  638-18-656ms   | [S7,MB5,BI] 668-34-702ms   | [S7,MB5,BW] 702-31-734ms   | [S0,MB2,B]  734-17-751ms   | [S7,MB6,F]  752-18-770ms   | [S7,MB6,BI] 782-34-817ms   | [S7,MB6,BW] 817-30-847ms   | [S0,MB3,B]  846-17-863ms   | [S7,MB7,F]  863-18-882ms   | [S7,MB7,BI] 894-34-928ms   | [S7,MB7,BW] 928-31-959ms   | [S0,MB4,B]  959-17-977ms   | [S0,MB5,B]  977-17-994ms   | [S0,MB6,B]  996-17-1013ms  | [S0,MB7,B]  1023-16-1039ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-21ms      | [S1,MB1,F]  27-11-39ms     | [S1,MB2,F]  45-11-56ms     | [S1,MB3,F]  63-11-74ms     | [S1,MB4,F]  86-11-97ms     | [S6,MB0,F]  97-10-107ms    | [S1,MB5,F]  107-13-121ms   | [S6,MB1,F]  120-8-129ms    | [S6,MB0,BI] 176-9-185ms    | [S6,MB0,BW] 185-10-195ms   | [S6,MB2,F]  195-7-202ms    | [S6,MB1,BI] 265-9-275ms    | [S6,MB1,BW] 275-10-285ms   | [S6,MB3,F]  284-7-292ms    | [S6,MB2,BI] 362-9-371ms    | [S6,MB2,BW] 371-10-382ms   | [S1,MB6,F]  381-10-392ms   | [S1,MB0,BI] 392-15-408ms   | [S1,MB0,BW] 408-15-423ms   | [S6,MB4,F]  422-8-430ms    | [S6,MB3,BI] 458-10-468ms   | [S6,MB3,BW] 468-9-478ms    | [S1,MB7,F]  501-13-515ms   | [S1,MB1,BI] 515-15-530ms   | [S1,MB1,BW] 530-14-545ms   | [S6,MB5,F]  544-7-551ms    | [S6,MB4,BI] 583-10-593ms   | [S6,MB4,BW] 593-9-602ms    | [S1,MB2,BI] 620-14-634ms   | [S1,MB2,BW] 634-14-648ms   | [S6,MB6,F]  704-7-711ms    | [S6,MB5,BI] 712-9-721ms    | [S6,MB5,BW] 721-11-732ms   | [S1,MB3,BI] 734-14-749ms   | [S1,MB3,BW] 749-14-763ms   | [S6,MB7,F]  819-7-826ms    | [S6,MB6,BI] 826-9-835ms    | [S6,MB6,BW] 835-11-846ms   | [S1,MB4,BI] 848-14-862ms   | [S6,MB7,BI] 922-10-933ms   | [S1,MB5,BI] 933-15-948ms   | [S1,MB4,BW] 948-16-964ms   | [S1,MB6,BI] 965-14-979ms   | [S1,MB5,BW] 979-15-995ms   | [S1,MB7,BI] 994-14-1009ms  | [S1,MB6,BW] 1009-16-1026ms | [S6,MB7,BW] 1026-11-1037ms | [S1,MB7,BW] 1036-16-1053ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-8-29ms      | [S2,MB1,F]  39-8-47ms      | [S2,MB2,F]  56-8-65ms      | [S5,MB0,F]  65-9-74ms      | [S2,MB3,F]  75-10-85ms     | [S5,MB1,F]  85-7-93ms      | [S2,MB4,F]  97-11-108ms    | [S5,MB2,F]  116-9-125ms    | [S5,MB0,BI] 185-9-195ms    | [S5,MB0,BW] 195-0-195ms    | [S5,MB3,F]  195-8-204ms    | [S5,MB1,BI] 275-9-285ms    | [S5,MB1,BW] 284-0-284ms    | [S2,MB5,F]  285-9-295ms    | [S2,MB0,BI] 294-10-305ms   | [S2,MB0,BW] 305-0-305ms    | [S5,MB4,F]  305-7-313ms    | [S5,MB2,BI] 372-10-382ms   | [S5,MB2,BW] 382-0-382ms    | [S2,MB6,F]  394-10-404ms   | [S2,MB1,BI] 405-10-415ms   | [S2,MB1,BW] 415-0-415ms    | [S5,MB5,F]  417-7-424ms    | [S5,MB3,BI] 505-10-516ms   | [S5,MB3,BW] 516-0-516ms    | [S2,MB7,F]  517-10-528ms   | [S2,MB2,BI] 528-10-539ms   | [S2,MB2,BW] 539-0-539ms    | [S5,MB6,F]  539-7-547ms    | [S5,MB4,BI] 613-10-623ms   | [S5,MB4,BW] 623-0-623ms    | [S2,MB3,BI] 707-9-717ms    | [S2,MB3,BW] 717-0-717ms    | [S5,MB7,F]  734-7-742ms    | [S5,MB5,BI] 742-9-751ms    | [S5,MB5,BW] 751-0-751ms    | [S2,MB4,BI] 821-9-831ms    | [S5,MB6,BI] 840-10-851ms   | [S2,MB5,BI] 851-10-861ms   | [S5,MB7,BI] 936-9-946ms    | [S2,MB6,BI] 945-10-956ms   | [S2,MB4,BW] 957-0-957ms    | [S2,MB7,BI] 972-9-982ms    | [S2,MB5,BW] 982-0-982ms    | [S5,MB6,BW] 983-0-983ms    | [S5,MB7,BW] 984-0-984ms    | [S2,MB6,BW] 984-0-984ms    | [S2,MB7,BW] 984-0-984ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-7-37ms      | [S4,MB0,F]  37-8-45ms      | [S3,MB1,F]  47-9-56ms      | [S4,MB1,F]  56-7-64ms      | [S3,MB2,F]  65-8-73ms      | [S4,MB2,F]  73-7-81ms      | [S3,MB3,F]  99-8-108ms     | [S4,MB3,F]  108-8-116ms    | [S4,MB0,BI] 195-9-204ms    | [S4,MB0,BW] 204-9-213ms    | [S3,MB4,F]  213-7-221ms    | [S3,MB0,BI] 221-9-230ms    | [S3,MB0,BW] 230-0-230ms    | [S4,MB4,F]  230-7-238ms    | [S4,MB1,BI] 285-10-296ms   | [S4,MB1,BW] 296-10-306ms   | [S3,MB5,F]  306-8-314ms    | [S3,MB1,BI] 314-9-323ms    | [S3,MB1,BW] 323-0-323ms    | [S4,MB5,F]  324-7-331ms    | [S4,MB2,BI] 398-11-409ms   | [S4,MB2,BW] 409-9-419ms    | [S3,MB6,F]  419-7-427ms    | [S3,MB2,BI] 427-9-436ms    | [S3,MB2,BW] 436-0-436ms    | [S4,MB6,F]  438-7-445ms    | [S4,MB3,BI] 521-11-532ms   | [S4,MB3,BW] 532-9-542ms    | [S3,MB7,F]  542-7-550ms    | [S3,MB3,BI] 550-9-559ms    | [S3,MB3,BW] 559-0-559ms    | [S4,MB7,F]  560-7-567ms    | [S4,MB4,BI] 701-10-711ms   | [S4,MB4,BW] 712-9-721ms    | [S3,MB4,BI] 721-10-731ms   | [S4,MB5,BI] 816-10-826ms   | [S3,MB5,BI] 826-9-835ms    | [S4,MB6,BI] 852-9-861ms    | [S3,MB6,BI] 861-9-870ms    | [S4,MB7,BI] 948-9-957ms    | [S3,MB7,BI] 957-9-966ms    | [S3,MB4,BW] 966-0-966ms    | [S4,MB5,BW] 967-10-977ms   | [S4,MB6,BW] 977-9-987ms    | [S4,MB7,BW] 987-9-996ms    | [S3,MB5,BW] 996-0-996ms    | [S3,MB6,BW] 998-0-998ms    | [S3,MB7,BW] 998-0-998ms   
[rank3]:2025-12-25 12:40:09,647 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank3/251225_1240_stage3_step300.svg
[rank3]:2025-12-25 12:40:09,691 - âœ… Frozen Ratio History of Rank 3 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank3/251225_1240_stage4_step300.svg
[rank1]:2025-12-25 12:40:48,073 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 9.0000e+00
[rank0]:2025-12-25 12:40:48,154 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 8.1932e+00
[rank3]:2025-12-25 12:40:48,137 - Freezing Ratio: [Stage3] 1.00, [Stage4] 0.00, Threshold: 1.2633e+01
[rank2]:2025-12-25 12:40:48,134 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 0.0000e+00
[rank1]:2025-12-25 12:41:31,404 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 0.0000e+00
[rank0]:2025-12-25 12:41:31,412 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 1.3421e+00
[rank3]:2025-12-25 12:41:31,385 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 1.4941e+00
[rank2]:2025-12-25 12:41:31,393 - Freezing Ratio: [Stage2] 1.00, [Stage5] 0.00, Threshold: 1.5681e+00
[rank2]:2025-12-25 12:42:14,712 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 4.9853e+00
[rank1]:2025-12-25 12:42:14,732 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 5.8482e+00
[rank0]:2025-12-25 12:42:14,740 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 5.3458e+00
[rank3]:2025-12-25 12:42:14,723 - Freezing Ratio: [Stage3] 1.00, [Stage4] 0.50, Threshold: 3.4034e+00
[rank3]:2025-12-25 12:42:57,798 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 9.0000e+00
[rank1]:2025-12-25 12:42:57,908 - Freezing Ratio: [Stage1] 0.33, [Stage6] 0.00, Threshold: 2.2435e+00
[rank0]:2025-12-25 12:42:57,917 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 5.0077e-01
[rank2]:2025-12-25 12:42:57,897 - Freezing Ratio: [Stage2] 1.00, [Stage5] 0.50, Threshold: 9.9505e-01
[rank0]:2025-12-25 12:43:40,255 - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-12-25 12:43:40,507 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 9.0000e+00
[rank1]:2025-12-25 12:43:40,577 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 4.5945e+00
[rank3]:2025-12-25 12:43:40,584 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 0.0000e+00
[rank0]:2025-12-25 12:43:40,601 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 1.0815e+00
[rank3]:2025-12-25 12:43:44,922 - Avg. fwd time: 7.8707 / Avg. bwd-weight time: 7.6009 / Avg. bwd-input time: 9.6462 / Avg. batch time: 1003.8520 (ms) / GPU bubble ratio: 59.97%
[rank0]:2025-12-25 12:43:44,904 - Avg. fwd time: 13.8921 / Avg. full-bwd time: 20.0866 (Avg. bwd-weight time: 30.2903 / Avg. bwd-input time: 34.5610) / Avg. batch time: 1057.6849 (ms) / GPU bubble ratio: 14.74%
[rank2]:2025-12-25 12:43:44,913 - Avg. fwd time: 8.3465 / Avg. bwd-weight time: 7.3614 / Avg. bwd-input time: 10.0261 / Avg. batch time: 1011.1811 (ms) / GPU bubble ratio: 59.28%
[rank1]:2025-12-25 12:43:44,933 - Avg. fwd time: 10.0635 / Avg. bwd-weight time: 10.0960 / Avg. bwd-input time: 12.1820 / Avg. batch time: 1047.2133 (ms) / GPU bubble ratio: 50.59%
[rank1]:2025-12-25 12:43:44,957 -  step: 350  loss: -4.0000  grad_norm:  0.3362  memory: 17.83GiB(37.53%)  tps: 7,595  tflops: 59.38  mfu: 19.03%
[rank3]:2025-12-25 12:43:44,953 -  step: 350  loss: -4.0000  grad_norm:  0.3362  memory: 15.27GiB(32.13%)  tps: 7,596  tflops: 59.38  mfu: 19.03%
[rank0]:2025-12-25 12:43:44,971 -  step: 350  loss:  0.2385  grad_norm:  0.3362  memory: 35.32GiB(74.36%)  tps: 7,596  tflops: 59.38  mfu: 19.03%
[rank2]:2025-12-25 12:43:44,952 -  step: 350  loss: -4.0000  grad_norm:  0.3362  memory: 13.80GiB(29.05%)  tps: 7,596  tflops: 59.38  mfu: 19.03%
[rank3]:2025-12-25 12:44:23,866 - Freezing Ratio: [Stage3] 1.00, [Stage4] 0.50, Threshold: 4.0905e-01
[rank2]:2025-12-25 12:44:23,864 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 0.0000e+00
[rank1]:2025-12-25 12:44:23,875 - Freezing Ratio: [Stage1] 1.00, [Stage6] 0.00, Threshold: 5.4822e-01
[rank0]:2025-12-25 12:44:23,883 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 9.0101e-01
[rank3]:2025-12-25 12:45:06,687 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 9.0000e+00
[rank1]:2025-12-25 12:45:06,774 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 9.9690e-01
[rank0]:2025-12-25 12:45:06,803 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 1.1687e+00
[rank2]:2025-12-25 12:45:06,783 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 1.9521e+00
[rank1]:2025-12-25 12:45:50,031 - Freezing Ratio: [Stage1] 1.00, [Stage6] 0.50, Threshold: 1.1714e+00
[rank0]:2025-12-25 12:45:50,040 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 1.7758e+00
[rank3]:2025-12-25 12:45:50,022 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 0.0000e+00
[rank2]:2025-12-25 12:45:50,021 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 2.8533e+00
[rank1]:2025-12-25 12:46:32,705 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 9.0000e+00
[rank2]:2025-12-25 12:46:32,767 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 3.5917e-01
[rank0]:2025-12-25 12:46:32,786 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 4.3142e-01
[rank3]:2025-12-25 12:46:32,769 - Freezing Ratio: [Stage3] 1.00, [Stage4] 0.50, Threshold: 3.2147e-01
[rank0]:2025-12-25 12:47:15,648 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-25 12:47:15,885 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 9.0000e+00
[rank2]:2025-12-25 12:47:15,985 - Freezing Ratio: [Stage2] 1.00, [Stage5] 0.50, Threshold: 5.2654e-01
[rank1]:2025-12-25 12:47:15,996 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 0.0000e+00
[rank0]:2025-12-25 12:47:16,004 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 5.6914e-01
[rank2]:2025-12-25 12:47:20,302 - Avg. fwd time: 8.3186 / Avg. bwd-weight time: 7.6797 / Avg. bwd-input time: 10.0318 / Avg. batch time: 1011.4213 (ms) / GPU bubble ratio: 58.82%
[rank1]:2025-12-25 12:47:20,373 - Avg. fwd time: 10.0779 / Avg. bwd-weight time: 9.9404 / Avg. bwd-input time: 12.1851 / Avg. batch time: 1045.2256 (ms) / GPU bubble ratio: 50.70%
[rank0]:2025-12-25 12:47:20,347 - Avg. fwd time: 13.9016 / Avg. full-bwd time: 19.7589 (Avg. bwd-weight time: 30.2867 / Avg. bwd-input time: 34.5593) / Avg. batch time: 1055.4302 (ms) / GPU bubble ratio: 14.80%
[rank3]:2025-12-25 12:47:20,358 - Avg. fwd time: 7.8831 / Avg. bwd-weight time: 7.3917 / Avg. bwd-input time: 9.6457 / Avg. batch time: 1001.1820 (ms) / GPU bubble ratio: 60.17%
[rank3]:2025-12-25 12:47:20,392 -  step: 400  loss: -4.0000  grad_norm:  0.1444  memory: 15.27GiB(32.13%)  tps: 7,605  tflops: 59.45  mfu: 19.06%
[rank2]:2025-12-25 12:47:20,379 -  step: 400  loss: -4.0000  grad_norm:  0.0000  memory: 13.80GiB(29.05%)  tps: 7,605  tflops: 59.46  mfu: 19.06%
[rank1]:2025-12-25 12:47:20,399 -  step: 400  loss: -4.0000  grad_norm:  0.1444  memory: 17.83GiB(37.53%)  tps: 7,605  tflops: 59.45  mfu: 19.05%
[rank1]:2025-12-25 12:47:20,465 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank1/251225_1247_stage1_step400.svg
[rank0]:2025-12-25 12:47:20,411 -  step: 400  loss:  0.2149  grad_norm:  0.1444  memory: 35.32GiB(74.36%)  tps: 7,605  tflops: 59.45  mfu: 19.06%
[rank0]:2025-12-25 12:47:20,465 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank0/251225_1247_stage0_step400.svg
[rank2]:2025-12-25 12:47:20,466 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank2/251225_1247_stage2_step400.svg
[rank2]:2025-12-25 12:47:20,511 - âœ… Frozen Ratio History of Rank 2 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank2/251225_1247_stage5_step400.svg
[rank1]:2025-12-25 12:47:20,510 - âœ… Frozen Ratio History of Rank 1 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank1/251225_1247_stage6_step400.svg
[rank0]:2025-12-25 12:47:20,508 - âœ… Frozen Ratio History of Rank 0 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank0/251225_1247_stage7_step400.svg
[rank3]:2025-12-25 12:47:20,746 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/pipeline_schedule/251225_1247_step400_rank3.svg
[rank3]:			> Batch Time: 1047.61 ms, GPU Bubble Ratio: 15.70%, 46.27%, 56.66%, 72.72%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-9-26ms      | [S0,MB3,F]  26-8-35ms      | [S0,MB4,F]  35-9-45ms      | [S0,MB5,F]  45-9-54ms      | [S0,MB6,F]  55-10-65ms     | [S7,MB0,F]  123-17-140ms   | [S7,MB0,BI] 152-32-185ms   | [S7,MB0,BW] 185-25-211ms   | [S7,MB1,F]  211-16-228ms   | [S7,MB1,BI] 239-34-274ms   | [S7,MB1,BW] 274-29-304ms   | [S7,MB2,F]  304-19-323ms   | [S7,MB2,BI] 335-35-370ms   | [S7,MB2,BW] 370-30-400ms   | [S7,MB3,F]  400-19-419ms   | [S7,MB3,BI] 430-34-465ms   | [S7,MB3,BW] 465-31-496ms   | [S0,MB7,F]  497-11-508ms   | [S0,MB0,B]  507-18-526ms   | [S7,MB4,F]  526-18-544ms   | [S7,MB4,BI] 556-34-591ms   | [S7,MB4,BW] 590-30-620ms   | [S0,MB1,B]  620-17-637ms   | [S7,MB5,F]  637-18-655ms   | [S7,MB5,BI] 667-34-702ms   | [S7,MB5,BW] 702-31-733ms   | [S0,MB2,B]  734-17-751ms   | [S7,MB6,F]  751-18-770ms   | [S7,MB6,BI] 782-34-817ms   | [S7,MB6,BW] 817-30-847ms   | [S0,MB3,B]  848-17-866ms   | [S7,MB7,F]  866-18-885ms   | [S7,MB7,BI] 897-34-931ms   | [S7,MB7,BW] 932-31-963ms   | [S0,MB4,B]  962-17-979ms   | [S0,MB5,B]  980-17-997ms   | [S0,MB6,B]  999-17-1016ms  | [S0,MB7,B]  1027-16-1043ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-21ms      | [S1,MB1,F]  27-11-38ms     | [S1,MB2,F]  45-11-56ms     | [S1,MB3,F]  62-11-74ms     | [S1,MB4,F]  86-11-97ms     | [S6,MB0,F]  97-10-107ms    | [S1,MB5,F]  107-13-120ms   | [S6,MB1,F]  120-8-129ms    | [S6,MB0,BI] 176-9-185ms    | [S6,MB0,BW] 185-10-195ms   | [S6,MB2,F]  195-7-202ms    | [S6,MB1,BI] 265-9-275ms    | [S6,MB1,BW] 274-10-285ms   | [S6,MB3,F]  283-7-290ms    | [S6,MB2,BI] 361-9-370ms    | [S6,MB2,BW] 370-10-381ms   | [S1,MB6,F]  380-10-391ms   | [S1,MB0,BI] 391-15-407ms   | [S1,MB0,BW] 407-15-422ms   | [S6,MB4,F]  422-8-430ms    | [S6,MB3,BI] 458-10-469ms   | [S6,MB3,BW] 469-9-478ms    | [S1,MB7,F]  501-13-515ms   | [S1,MB1,BI] 515-15-530ms   | [S1,MB1,BW] 530-14-545ms   | [S6,MB5,F]  545-7-552ms    | [S6,MB4,BI] 584-10-594ms   | [S6,MB4,BW] 594-9-603ms    | [S1,MB2,BI] 622-14-636ms   | [S1,MB2,BW] 636-14-650ms   | [S6,MB6,F]  707-7-714ms    | [S6,MB5,BI] 714-9-724ms    | [S6,MB5,BW] 724-11-735ms   | [S1,MB3,BI] 737-14-752ms   | [S1,MB3,BW] 752-14-766ms   | [S6,MB7,F]  821-7-828ms    | [S6,MB6,BI] 829-9-838ms    | [S6,MB6,BW] 838-11-849ms   | [S1,MB4,BI] 852-14-866ms   | [S6,MB7,BI] 925-10-936ms   | [S1,MB5,BI] 936-15-951ms   | [S1,MB4,BW] 951-16-967ms   | [S1,MB6,BI] 967-14-981ms   | [S1,MB5,BW] 981-15-997ms   | [S1,MB7,BI] 997-14-1012ms  | [S1,MB6,BW] 1012-16-1028ms | [S6,MB7,BW] 1028-11-1039ms | [S1,MB7,BW] 1039-16-1056ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-8-29ms      | [S2,MB1,F]  38-7-46ms      | [S2,MB2,F]  56-7-63ms      | [S5,MB0,F]  63-9-73ms      | [S2,MB3,F]  74-9-83ms      | [S5,MB1,F]  83-7-91ms      | [S2,MB4,F]  97-10-107ms    | [S5,MB2,F]  116-8-125ms    | [S5,MB0,BI] 185-9-194ms    | [S5,MB0,BW] 194-10-205ms   | [S5,MB3,F]  204-7-212ms    | [S5,MB1,BI] 275-9-284ms    | [S5,MB1,BW] 284-10-295ms   | [S2,MB5,F]  294-7-301ms    | [S2,MB0,BI] 301-10-312ms   | [S2,MB0,BW] 312-9-322ms    | [S5,MB4,F]  322-7-329ms    | [S5,MB2,BI] 371-10-381ms   | [S5,MB2,BW] 381-9-391ms    | [S2,MB6,F]  393-9-403ms    | [S2,MB1,BI] 404-10-414ms   | [S2,MB1,BW] 414-9-424ms    | [S5,MB5,F]  424-7-431ms    | [S5,MB3,BI] 506-10-516ms   | [S5,MB3,BW] 516-11-528ms   | [S2,MB7,F]  527-7-535ms    | [S2,MB2,BI] 535-10-546ms   | [S2,MB2,BW] 546-9-556ms    | [S5,MB6,F]  555-7-563ms    | [S5,MB4,BI] 615-10-626ms   | [S5,MB4,BW] 626-9-636ms    | [S2,MB3,BI] 710-9-719ms    | [S2,MB3,BW] 719-10-729ms   | [S5,MB7,F]  737-7-744ms    | [S5,MB5,BI] 744-9-754ms    | [S5,MB5,BW] 754-9-764ms    | [S2,MB4,BI] 824-9-834ms    | [S5,MB6,BI] 844-10-855ms   | [S2,MB5,BI] 855-10-865ms   | [S5,MB7,BI] 939-9-949ms    | [S2,MB6,BI] 949-10-960ms   | [S2,MB4,BW] 959-10-970ms   | [S2,MB7,BI] 975-9-984ms    | [S2,MB5,BW] 984-10-995ms   | [S5,MB6,BW] 995-9-1004ms   | [S5,MB7,BW] 1003-9-1013ms  | [S2,MB6,BW] 1013-9-1023ms  | [S2,MB7,BW] 1023-9-1033ms 
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-7-37ms      | [S4,MB0,F]  37-8-45ms      | [S3,MB1,F]  46-9-56ms      | [S4,MB1,F]  56-7-64ms      | [S3,MB2,F]  64-8-72ms      | [S4,MB2,F]  72-8-81ms      | [S3,MB3,F]  99-8-107ms     | [S4,MB3,F]  107-8-116ms    | [S4,MB0,BI] 194-9-204ms    | [S4,MB0,BW] 204-0-204ms    | [S3,MB4,F]  204-7-212ms    | [S3,MB0,BI] 212-9-221ms    | [S3,MB0,BW] 221-0-221ms    | [S4,MB4,F]  221-7-229ms    | [S4,MB1,BI] 284-10-294ms   | [S4,MB1,BW] 294-0-294ms    | [S3,MB5,F]  303-8-312ms    | [S3,MB1,BI] 312-9-321ms    | [S3,MB1,BW] 321-0-321ms    | [S4,MB5,F]  322-7-329ms    | [S4,MB2,BI] 397-11-408ms   | [S4,MB2,BW] 408-0-408ms    | [S3,MB6,F]  409-8-418ms    | [S3,MB2,BI] 417-9-427ms    | [S3,MB2,BW] 427-0-427ms    | [S4,MB6,F]  427-7-435ms    | [S4,MB3,BI] 521-10-531ms   | [S4,MB3,BW] 531-0-531ms    | [S3,MB7,F]  536-8-545ms    | [S3,MB3,BI] 545-9-554ms    | [S3,MB3,BW] 554-0-554ms    | [S4,MB7,F]  554-7-562ms    | [S4,MB4,BI] 703-10-713ms   | [S4,MB4,BW] 713-0-713ms    | [S3,MB4,BI] 715-9-724ms    | [S4,MB5,BI] 818-10-828ms   | [S3,MB5,BI] 828-9-837ms    | [S4,MB6,BI] 855-9-864ms    | [S3,MB6,BI] 864-9-873ms    | [S4,MB7,BI] 950-9-959ms    | [S3,MB7,BI] 959-9-968ms    | [S3,MB4,BW] 968-0-968ms    | [S4,MB5,BW] 970-0-970ms    | [S4,MB6,BW] 970-0-970ms    | [S4,MB7,BW] 970-0-970ms    | [S3,MB5,BW] 970-0-970ms    | [S3,MB6,BW] 970-0-970ms    | [S3,MB7,BW] 970-0-970ms   
[rank3]:2025-12-25 12:47:20,790 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank3/251225_1247_stage3_step400.svg
[rank3]:2025-12-25 12:47:20,835 - âœ… Frozen Ratio History of Rank 3 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank3/251225_1247_stage4_step400.svg
[rank0]:2025-12-25 12:47:45,147 - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-12-25 12:47:45,434 - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-12-25 12:47:45,502 - Dataset alpaca_gpt4 is being re-looped
[rank3]:2025-12-25 12:47:45,491 - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-12-25 12:47:59,554 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 9.0000e+00
[rank3]:2025-12-25 12:47:59,640 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 0.0000e+00
[rank1]:2025-12-25 12:47:59,649 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 2.1338e+00
[rank0]:2025-12-25 12:47:59,657 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 1.1520e+00
[rank2]:2025-12-25 12:48:42,805 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 0.0000e+00
[rank1]:2025-12-25 12:48:42,815 - Freezing Ratio: [Stage1] 0.67, [Stage6] 0.00, Threshold: 4.9637e+00
[rank0]:2025-12-25 12:48:42,823 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 5.2374e+00
[rank3]:2025-12-25 12:48:42,806 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 6.6365e+00
[rank1]:2025-12-25 12:49:25,442 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 6.0366e+00
[rank3]:2025-12-25 12:49:25,454 - Freezing Ratio: [Stage3] 1.00, [Stage4] 0.50, Threshold: 1.4565e+00
[rank2]:2025-12-25 12:49:25,452 - Freezing Ratio: [Stage2] 1.00, [Stage5] 0.50, Threshold: 1.4634e+00
[rank0]:2025-12-25 12:49:25,471 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 1.6827e+00
[rank3]:2025-12-25 12:50:08,586 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 9.0000e+00
[rank2]:2025-12-25 12:50:08,601 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 9.0000e+00
[rank1]:2025-12-25 12:50:08,696 - Freezing Ratio: [Stage1] 1.00, [Stage6] 0.00, Threshold: 2.4585e+00
[rank0]:2025-12-25 12:50:08,705 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 2.4412e+00
[rank0]:2025-12-25 12:50:51,214 - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-12-25 12:50:51,529 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 3.5488e+00
[rank3]:2025-12-25 12:50:51,543 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 0.0000e+00
[rank0]:2025-12-25 12:50:51,558 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 3.0782e+00
[rank2]:2025-12-25 12:50:51,540 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 0.0000e+00
[rank2]:2025-12-25 12:50:55,799 - Avg. fwd time: 8.3318 / Avg. bwd-weight time: 7.5207 / Avg. bwd-input time: 10.0324 / Avg. batch time: 1009.6268 (ms) / GPU bubble ratio: 58.98%
[rank1]:2025-12-25 12:50:55,819 - Avg. fwd time: 10.0744 / Avg. bwd-weight time: 9.9359 / Avg. bwd-input time: 12.1886 / Avg. batch time: 1043.9176 (ms) / GPU bubble ratio: 50.65%
[rank1]:2025-12-25 12:50:55,842 -  step: 450  loss: -4.0000  grad_norm:  0.1908  memory: 17.83GiB(37.53%)  tps: 7,605  tflops: 59.45  mfu: 19.05%
[rank3]:2025-12-25 12:50:55,807 - Avg. fwd time: 7.8785 / Avg. bwd-weight time: 7.4464 / Avg. bwd-input time: 9.6515 / Avg. batch time: 1000.5137 (ms) / GPU bubble ratio: 60.06%
[rank3]:2025-12-25 12:50:55,838 -  step: 450  loss: -4.0000  grad_norm:  0.1908  memory: 15.27GiB(32.13%)  tps: 7,605  tflops: 59.45  mfu: 19.05%
[rank0]:2025-12-25 12:50:55,790 - Avg. fwd time: 13.9062 / Avg. full-bwd time: 19.5000 (Avg. bwd-weight time: 30.2753 / Avg. bwd-input time: 34.5529) / Avg. batch time: 1053.6357 (ms) / GPU bubble ratio: 14.85%
[rank0]:2025-12-25 12:50:55,857 -  step: 450  loss:  0.2347  grad_norm:  0.1908  memory: 35.32GiB(74.36%)  tps: 7,605  tflops: 59.45  mfu: 19.05%
[rank2]:2025-12-25 12:50:55,837 -  step: 450  loss: -4.0000  grad_norm:  0.1908  memory: 13.80GiB(29.05%)  tps: 7,604  tflops: 59.45  mfu: 19.05%
[rank3]:2025-12-25 12:51:34,732 - Freezing Ratio: [Stage3] 1.00, [Stage4] 0.00, Threshold: 4.7050e-01
[rank2]:2025-12-25 12:51:34,731 - Freezing Ratio: [Stage2] 1.00, [Stage5] 0.50, Threshold: 7.1446e-01
[rank1]:2025-12-25 12:51:34,741 - Freezing Ratio: [Stage1] 1.00, [Stage6] 0.50, Threshold: 5.7040e-01
[rank0]:2025-12-25 12:51:34,750 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 3.9402e-01
[rank2]:2025-12-25 12:52:17,395 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 9.0000e+00
[rank1]:2025-12-25 12:52:17,412 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 9.0000e+00
[rank3]:2025-12-25 12:52:17,465 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 1.0149e+00
[rank0]:2025-12-25 12:52:17,493 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 1.1890e+00
[rank2]:2025-12-25 12:53:00,654 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 0.0000e+00
[rank1]:2025-12-25 12:53:00,665 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 0.0000e+00
[rank3]:2025-12-25 12:53:00,657 - Freezing Ratio: [Stage3] 1.00, [Stage4] 0.00, Threshold: 3.0719e-01
[rank0]:2025-12-25 12:53:00,674 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 4.2270e-01
[rank1]:2025-12-25 12:53:43,955 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 2.7309e+00
[rank3]:2025-12-25 12:53:43,936 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 1.2023e+00
[rank0]:2025-12-25 12:53:43,964 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 1.5583e+00
[rank2]:2025-12-25 12:53:43,945 - Freezing Ratio: [Stage2] 1.00, [Stage5] 0.00, Threshold: 2.1312e+00
[rank0]:2025-12-25 12:54:26,784 - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-12-25 12:54:27,126 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 2.0022e+00
[rank3]:2025-12-25 12:54:27,118 - Freezing Ratio: [Stage3] 1.00, [Stage4] 0.50, Threshold: 5.2572e-01
[rank0]:2025-12-25 12:54:27,134 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 5.2500e-01
[rank2]:2025-12-25 12:54:27,107 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 7.8761e-01
[rank3]:2025-12-25 12:54:31,325 - Avg. fwd time: 7.8777 / Avg. bwd-weight time: 7.4681 / Avg. bwd-input time: 9.6560 / Avg. batch time: 999.5494 (ms) / GPU bubble ratio: 59.98%
[rank1]:2025-12-25 12:54:31,416 - Avg. fwd time: 10.0743 / Avg. bwd-weight time: 9.9839 / Avg. bwd-input time: 12.1917 / Avg. batch time: 1043.3081 (ms) / GPU bubble ratio: 50.54%
[rank1]:2025-12-25 12:54:31,439 -  step: 500  loss: -4.0000  grad_norm:  0.1499  memory: 17.83GiB(37.53%)  tps: 7,599  tflops: 59.41  mfu: 19.04%
[rank3]:2025-12-25 12:54:31,423 -  step: 500  loss: -4.0000  grad_norm:  0.0000  memory: 15.27GiB(32.13%)  tps: 7,600  tflops: 59.41  mfu: 19.04%
[rank0]:2025-12-25 12:54:31,379 - Avg. fwd time: 13.9080 / Avg. full-bwd time: 19.2926 (Avg. bwd-weight time: 30.2675 / Avg. bwd-input time: 34.5477) / Avg. batch time: 1052.3141 (ms) / GPU bubble ratio: 14.91%
[rank0]:2025-12-25 12:54:31,455 -  step: 500  loss:  0.2288  grad_norm:  0.1499  memory: 35.32GiB(74.36%)  tps: 7,599  tflops: 59.41  mfu: 19.04%
[rank2]:2025-12-25 12:54:31,388 - Avg. fwd time: 8.3351 / Avg. bwd-weight time: 7.4755 / Avg. bwd-input time: 10.0340 / Avg. batch time: 1008.2781 (ms) / GPU bubble ratio: 58.99%
[rank2]:2025-12-25 12:54:31,436 -  step: 500  loss: -4.0000  grad_norm:  0.1499  memory: 13.80GiB(29.05%)  tps: 7,599  tflops: 59.41  mfu: 19.04%
[rank1]:2025-12-25 12:54:31,511 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank1/251225_1254_stage1_step500.svg
[rank0]:2025-12-25 12:54:31,509 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank0/251225_1254_stage0_step500.svg
[rank0]:2025-12-25 12:54:31,550 - âœ… Frozen Ratio History of Rank 0 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank0/251225_1254_stage7_step500.svg
[rank2]:2025-12-25 12:54:31,522 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank2/251225_1254_stage2_step500.svg
[rank2]:2025-12-25 12:54:31,570 - âœ… Frozen Ratio History of Rank 2 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank2/251225_1254_stage5_step500.svg
[rank1]:2025-12-25 12:54:31,554 - âœ… Frozen Ratio History of Rank 1 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank1/251225_1254_stage6_step500.svg
[rank3]:2025-12-25 12:54:31,800 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/pipeline_schedule/251225_1254_step500_rank3.svg
[rank3]:			> Batch Time: 1045.66 ms, GPU Bubble Ratio: 15.83%, 46.14%, 63.79%, 58.27%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-9-26ms      | [S0,MB3,F]  26-8-35ms      | [S0,MB4,F]  35-10-45ms     | [S0,MB5,F]  45-9-54ms      | [S0,MB6,F]  54-10-65ms     | [S7,MB0,F]  124-17-141ms   | [S7,MB0,BI] 153-32-185ms   | [S7,MB0,BW] 185-25-211ms   | [S7,MB1,F]  212-16-228ms   | [S7,MB1,BI] 240-34-274ms   | [S7,MB1,BW] 275-29-304ms   | [S7,MB2,F]  303-19-322ms   | [S7,MB2,BI] 334-34-368ms   | [S7,MB2,BW] 369-31-400ms   | [S7,MB3,F]  399-19-419ms   | [S7,MB3,BI] 431-34-465ms   | [S7,MB3,BW] 465-31-497ms   | [S0,MB7,F]  497-11-508ms   | [S0,MB0,B]  508-18-526ms   | [S7,MB4,F]  526-18-544ms   | [S7,MB4,BI] 556-34-590ms   | [S7,MB4,BW] 590-30-621ms   | [S0,MB1,B]  621-17-638ms   | [S7,MB5,F]  638-18-656ms   | [S7,MB5,BI] 668-34-703ms   | [S7,MB5,BW] 703-31-734ms   | [S0,MB2,B]  734-17-751ms   | [S7,MB6,F]  752-18-770ms   | [S7,MB6,BI] 782-34-817ms   | [S7,MB6,BW] 817-30-847ms   | [S0,MB3,B]  847-17-865ms   | [S7,MB7,F]  865-18-884ms   | [S7,MB7,BI] 896-34-930ms   | [S7,MB7,BW] 930-31-961ms   | [S0,MB4,B]  960-17-977ms   | [S0,MB5,B]  977-17-995ms   | [S0,MB6,B]  997-17-1014ms  | [S0,MB7,B]  1025-16-1041ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-21ms      | [S1,MB1,F]  27-10-38ms     | [S1,MB2,F]  45-11-56ms     | [S1,MB3,F]  63-10-73ms     | [S1,MB4,F]  86-10-97ms     | [S6,MB0,F]  97-10-107ms    | [S1,MB5,F]  107-13-120ms   | [S6,MB1,F]  120-8-129ms    | [S6,MB0,BI] 175-9-185ms    | [S6,MB0,BW] 185-10-195ms   | [S6,MB2,F]  195-7-202ms    | [S6,MB1,BI] 265-9-274ms    | [S6,MB1,BW] 274-10-285ms   | [S6,MB3,F]  284-7-292ms    | [S6,MB2,BI] 359-9-369ms    | [S6,MB2,BW] 369-10-380ms   | [S1,MB6,F]  379-10-390ms   | [S1,MB0,BI] 390-15-406ms   | [S1,MB0,BW] 406-15-421ms   | [S6,MB4,F]  421-7-429ms    | [S6,MB3,BI] 456-10-466ms   | [S6,MB3,BW] 466-9-476ms    | [S1,MB7,F]  499-13-513ms   | [S1,MB1,BI] 513-15-528ms   | [S1,MB1,BW] 528-14-543ms   | [S6,MB5,F]  543-7-551ms    | [S6,MB4,BI] 581-10-591ms   | [S6,MB4,BW] 592-9-601ms    | [S1,MB2,BI] 620-14-634ms   | [S1,MB2,BW] 634-14-648ms   | [S6,MB6,F]  704-7-711ms    | [S6,MB5,BI] 711-9-720ms    | [S6,MB5,BW] 720-11-731ms   | [S1,MB3,BI] 734-14-748ms   | [S1,MB3,BW] 749-14-763ms   | [S6,MB7,F]  820-7-827ms    | [S6,MB6,BI] 827-9-836ms    | [S6,MB6,BW] 836-11-848ms   | [S1,MB4,BI] 849-14-864ms   | [S6,MB7,BI] 922-10-933ms   | [S1,MB5,BI] 933-15-948ms   | [S1,MB4,BW] 948-16-964ms   | [S1,MB6,BI] 964-14-979ms   | [S1,MB5,BW] 979-15-995ms   | [S1,MB7,BI] 994-15-1009ms  | [S1,MB6,BW] 1009-16-1026ms | [S6,MB7,BW] 1026-11-1037ms | [S1,MB7,BW] 1037-16-1054ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-8-29ms      | [S2,MB1,F]  38-8-46ms      | [S2,MB2,F]  56-8-64ms      | [S5,MB0,F]  64-9-74ms      | [S2,MB3,F]  74-10-85ms     | [S5,MB1,F]  85-7-92ms      | [S2,MB4,F]  97-11-108ms    | [S5,MB2,F]  116-8-125ms    | [S5,MB0,BI] 185-9-194ms    | [S5,MB0,BW] 194-10-204ms   | [S5,MB3,F]  204-7-211ms    | [S5,MB1,BI] 274-9-284ms    | [S5,MB1,BW] 284-10-294ms   | [S2,MB5,F]  295-8-303ms    | [S2,MB0,BI] 302-10-313ms   | [S2,MB0,BW] 313-0-313ms    | [S5,MB4,F]  314-7-321ms    | [S5,MB2,BI] 369-10-379ms   | [S5,MB2,BW] 379-9-389ms    | [S2,MB6,F]  391-10-402ms   | [S2,MB1,BI] 402-10-413ms   | [S2,MB1,BW] 413-0-413ms    | [S5,MB5,F]  415-7-422ms    | [S5,MB3,BI] 504-10-515ms   | [S5,MB3,BW] 515-11-527ms   | [S2,MB7,F]  527-8-535ms    | [S2,MB2,BI] 535-10-545ms   | [S2,MB2,BW] 545-0-545ms    | [S5,MB6,F]  547-7-555ms    | [S5,MB4,BI] 613-10-623ms   | [S5,MB4,BW] 624-9-634ms    | [S2,MB3,BI] 707-9-716ms    | [S2,MB3,BW] 716-0-716ms    | [S5,MB7,F]  734-7-741ms    | [S5,MB5,BI] 741-9-751ms    | [S5,MB5,BW] 751-9-761ms    | [S2,MB4,BI] 823-9-832ms    | [S5,MB6,BI] 842-10-852ms   | [S2,MB5,BI] 852-10-863ms   | [S5,MB7,BI] 936-9-946ms    | [S2,MB6,BI] 945-10-956ms   | [S2,MB4,BW] 957-0-957ms    | [S2,MB7,BI] 972-9-981ms    | [S2,MB5,BW] 981-0-981ms    | [S5,MB6,BW] 983-10-994ms   | [S5,MB7,BW] 993-9-1003ms   | [S2,MB6,BW] 1003-0-1003ms  | [S2,MB7,BW] 1005-0-1005ms 
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-7-37ms      | [S4,MB0,F]  37-8-45ms      | [S3,MB1,F]  47-8-55ms      | [S4,MB1,F]  55-7-63ms      | [S3,MB2,F]  65-7-72ms      | [S4,MB2,F]  72-7-80ms      | [S3,MB3,F]  99-7-106ms     | [S4,MB3,F]  107-8-115ms    | [S4,MB0,BI] 194-9-203ms    | [S4,MB0,BW] 203-9-213ms    | [S3,MB4,F]  212-7-220ms    | [S3,MB0,BI] 219-9-229ms    | [S3,MB0,BW] 229-9-239ms    | [S4,MB4,F]  238-7-246ms    | [S4,MB1,BI] 284-10-294ms   | [S4,MB1,BW] 294-9-304ms    | [S3,MB5,F]  304-8-312ms    | [S3,MB1,BI] 312-9-322ms    | [S3,MB1,BW] 322-9-331ms    | [S4,MB5,F]  329-7-337ms    | [S4,MB2,BI] 395-11-406ms   | [S4,MB2,BW] 406-9-416ms    | [S3,MB6,F]  416-7-423ms    | [S3,MB2,BI] 423-9-433ms    | [S3,MB2,BW] 433-9-442ms    | [S4,MB6,F]  442-7-450ms    | [S4,MB3,BI] 519-10-529ms   | [S4,MB3,BW] 529-10-540ms   | [S3,MB7,F]  540-7-547ms    | [S3,MB3,BI] 547-9-557ms    | [S3,MB3,BW] 557-9-567ms    | [S4,MB7,F]  564-7-572ms    | [S4,MB4,BI] 700-10-711ms   | [S4,MB4,BW] 711-9-721ms    | [S3,MB4,BI] 720-10-731ms   | [S4,MB5,BI] 816-10-826ms   | [S3,MB5,BI] 826-9-836ms    | [S4,MB6,BI] 853-9-862ms    | [S3,MB6,BI] 862-9-872ms    | [S4,MB7,BI] 947-9-957ms    | [S3,MB7,BI] 956-9-966ms    | [S3,MB4,BW] 965-10-976ms   | [S4,MB5,BW] 974-9-984ms    | [S4,MB6,BW] 984-9-994ms    | [S4,MB7,BW] 993-9-1003ms   | [S3,MB5,BW] 1003-9-1013ms  | [S3,MB6,BW] 1011-10-1022ms | [S3,MB7,BW] 1021-10-1032ms
[rank3]:2025-12-25 12:54:31,843 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank3/251225_1254_stage3_step500.svg
[rank3]:2025-12-25 12:54:31,882 - âœ… Frozen Ratio History of Rank 3 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank3/251225_1254_stage4_step500.svg
[rank3]:2025-12-25 12:55:10,529 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 9.0000e+00
[rank2]:2025-12-25 12:55:10,628 - Freezing Ratio: [Stage2] 1.00, [Stage5] 0.50, Threshold: 1.2726e+00
[rank1]:2025-12-25 12:55:10,638 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 1.4050e+00
[rank0]:2025-12-25 12:55:10,647 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 7.2133e-01
[rank2]:2025-12-25 12:55:53,794 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 9.0000e+00
[rank1]:2025-12-25 12:55:53,891 - Freezing Ratio: [Stage1] 0.67, [Stage6] 0.00, Threshold: 2.1562e+00
[rank3]:2025-12-25 12:55:53,883 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 0.0000e+00
[rank0]:2025-12-25 12:55:53,900 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 1.9793e+00
[rank1]:2025-12-25 12:56:36,685 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 6.5798e+00
[rank0]:2025-12-25 12:56:36,713 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 1.4437e+00
[rank3]:2025-12-25 12:56:36,697 - Freezing Ratio: [Stage3] 1.00, [Stage4] 0.50, Threshold: 1.5893e+00
[rank2]:2025-12-25 12:56:36,695 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 0.0000e+00
[rank3]:2025-12-25 12:57:19,737 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 9.0000e+00
[rank1]:2025-12-25 12:57:19,848 - Freezing Ratio: [Stage1] 1.00, [Stage6] 0.00, Threshold: 5.0347e-01
[rank0]:2025-12-25 12:57:19,857 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 5.4187e-01
[rank2]:2025-12-25 12:57:19,838 - Freezing Ratio: [Stage2] 1.00, [Stage5] 0.00, Threshold: 8.1900e-01
[rank0]:2025-12-25 12:58:02,283 - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-12-25 12:58:02,599 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 1.1307e+00
[rank3]:2025-12-25 12:58:02,612 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 0.0000e+00
[rank2]:2025-12-25 12:58:02,599 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 1.2052e+00
[rank0]:2025-12-25 12:58:02,628 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 1.0451e+00
[rank2]:2025-12-25 12:58:06,944 - Avg. fwd time: 8.3376 / Avg. bwd-weight time: 7.4390 / Avg. bwd-input time: 10.0359 / Avg. batch time: 1007.3817 (ms) / GPU bubble ratio: 59.00%
[rank0]:2025-12-25 12:58:06,934 - Avg. fwd time: 13.9123 / Avg. full-bwd time: 19.1241 (Avg. bwd-weight time: 30.2608 / Avg. bwd-input time: 34.5439) / Avg. batch time: 1051.1732 (ms) / GPU bubble ratio: 14.95%
[rank0]:2025-12-25 12:58:07,001 -  step: 550  loss:  0.2337  grad_norm:  0.1631  memory: 35.32GiB(74.36%)  tps: 7,601  tflops: 59.42  mfu: 19.05%
[rank1]:2025-12-25 12:58:06,963 - Avg. fwd time: 10.0716 / Avg. bwd-weight time: 9.9760 / Avg. bwd-input time: 12.1938 / Avg. batch time: 1042.4191 (ms) / GPU bubble ratio: 50.51%
[rank1]:2025-12-25 12:58:06,987 -  step: 550  loss: -4.0000  grad_norm:  0.1631  memory: 17.83GiB(37.53%)  tps: 7,601  tflops: 59.42  mfu: 19.05%
[rank3]:2025-12-25 12:58:06,953 - Avg. fwd time: 7.8831 / Avg. bwd-weight time: 7.3439 / Avg. bwd-input time: 9.6564 / Avg. batch time: 998.0180 (ms) / GPU bubble ratio: 60.11%
[rank3]:2025-12-25 12:58:06,982 -  step: 550  loss: -4.0000  grad_norm:  0.1631  memory: 15.27GiB(32.13%)  tps: 7,601  tflops: 59.42  mfu: 19.04%
[rank2]:2025-12-25 12:58:06,981 -  step: 550  loss: -4.0000  grad_norm:  0.1631  memory: 13.80GiB(29.05%)  tps: 7,601  tflops: 59.42  mfu: 19.05%
[rank1]:2025-12-25 12:58:45,942 - Freezing Ratio: [Stage1] 1.00, [Stage6] 0.00, Threshold: 1.9650e+00
[rank0]:2025-12-25 12:58:45,951 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 1.7083e+00
[rank3]:2025-12-25 12:58:45,934 - Freezing Ratio: [Stage3] 0.50, [Stage4] 0.00, Threshold: 2.0776e+00
[rank2]:2025-12-25 12:58:45,932 - Freezing Ratio: [Stage2] 1.00, [Stage5] 0.50, Threshold: 1.8921e+00
[rank2]:2025-12-25 12:59:28,741 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 9.0000e+00
[rank1]:2025-12-25 12:59:28,811 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 1.0136e+00
[rank0]:2025-12-25 12:59:28,840 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 9.4588e-01
[rank3]:2025-12-25 12:59:28,811 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 6.1564e+00
[rank2]:2025-12-25 13:00:12,003 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 0.0000e+00
[rank1]:2025-12-25 13:00:12,013 - Freezing Ratio: [Stage1] 1.00, [Stage6] 0.50, Threshold: 3.0127e-01
[rank0]:2025-12-25 13:00:12,023 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 4.0024e-01
[rank3]:2025-12-25 13:00:12,007 - Freezing Ratio: [Stage3] 1.00, [Stage4] 0.00, Threshold: 5.2906e-01
[rank3]:2025-12-25 13:00:54,728 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 4.1367e-01
[rank1]:2025-12-25 13:00:54,675 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 9.0000e+00
[rank0]:2025-12-25 13:00:54,757 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 3.9558e-01
[rank2]:2025-12-25 13:00:54,738 - Freezing Ratio: [Stage2] 1.00, [Stage5] 0.50, Threshold: 7.7745e-01
[rank0]:2025-12-25 13:01:37,695 - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-12-25 13:01:37,947 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 9.0000e+00
[rank3]:2025-12-25 13:01:38,036 - Freezing Ratio: [Stage3] 1.00, [Stage4] 0.00, Threshold: 4.7392e-01
[rank1]:2025-12-25 13:01:38,044 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 0.0000e+00
[rank0]:2025-12-25 13:01:38,053 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 4.3046e-01
[rank3]:2025-12-25 13:01:42,371 - Avg. fwd time: 7.8772 / Avg. bwd-weight time: 7.3797 / Avg. bwd-input time: 9.6610 / Avg. batch time: 997.6551 (ms) / GPU bubble ratio: 60.04%
[rank0]:2025-12-25 13:01:42,397 - Avg. fwd time: 13.9168 / Avg. full-bwd time: 18.9862 (Avg. bwd-weight time: 30.2648 / Avg. bwd-input time: 34.5425) / Avg. batch time: 1050.2211 (ms) / GPU bubble ratio: 14.97%
[rank2]:2025-12-25 13:01:42,402 - Avg. fwd time: 8.3465 / Avg. bwd-weight time: 7.3249 / Avg. bwd-input time: 10.0363 / Avg. batch time: 1006.2895 (ms) / GPU bubble ratio: 59.12%
[rank2]:2025-12-25 13:01:42,443 -  step: 600  loss: -4.0000  grad_norm:  0.1594  memory: 13.80GiB(29.05%)  tps: 7,604  tflops: 59.45  mfu: 19.05%
[rank3]:2025-12-25 13:01:42,437 -  step: 600  loss: -4.0000  grad_norm:  0.1594  memory: 15.27GiB(32.13%)  tps: 7,604  tflops: 59.45  mfu: 19.05%
[rank1]:2025-12-25 13:01:42,424 - Avg. fwd time: 10.0795 / Avg. bwd-weight time: 9.8821 / Avg. bwd-input time: 12.1942 / Avg. batch time: 1041.4935 (ms) / GPU bubble ratio: 50.60%
[rank1]:2025-12-25 13:01:42,449 -  step: 600  loss: -4.0000  grad_norm:  0.1594  memory: 17.83GiB(37.53%)  tps: 7,604  tflops: 59.45  mfu: 19.05%
[rank1]:2025-12-25 13:01:42,515 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank1/251225_1301_stage1_step600.svg
[rank0]:2025-12-25 13:01:42,463 -  step: 600  loss:  0.2249  grad_norm:  0.1594  memory: 35.32GiB(74.36%)  tps: 7,604  tflops: 59.45  mfu: 19.05%
[rank0]:2025-12-25 13:01:42,513 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank0/251225_1301_stage0_step600.svg
[rank2]:2025-12-25 13:01:42,514 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank2/251225_1301_stage2_step600.svg
[rank2]:2025-12-25 13:01:42,556 - âœ… Frozen Ratio History of Rank 2 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank2/251225_1301_stage5_step600.svg
[rank1]:2025-12-25 13:01:42,557 - âœ… Frozen Ratio History of Rank 1 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank1/251225_1301_stage6_step600.svg
[rank0]:2025-12-25 13:01:42,554 - âœ… Frozen Ratio History of Rank 0 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank0/251225_1301_stage7_step600.svg
[rank3]:2025-12-25 13:01:42,812 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/pipeline_schedule/251225_1301_step600_rank3.svg
[rank3]:			> Batch Time: 1050.62 ms, GPU Bubble Ratio: 15.75%, 46.47%, 71.05%, 58.41%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-9-26ms      | [S0,MB3,F]  26-9-35ms      | [S0,MB4,F]  35-9-45ms      | [S0,MB5,F]  45-9-54ms      | [S0,MB6,F]  55-10-65ms     | [S7,MB0,F]  123-17-140ms   | [S7,MB0,BI] 152-32-185ms   | [S7,MB0,BW] 185-25-211ms   | [S7,MB1,F]  211-16-228ms   | [S7,MB1,BI] 239-34-274ms   | [S7,MB1,BW] 274-30-304ms   | [S7,MB2,F]  304-19-323ms   | [S7,MB2,BI] 335-34-369ms   | [S7,MB2,BW] 370-31-401ms   | [S7,MB3,F]  400-19-419ms   | [S7,MB3,BI] 431-34-465ms   | [S7,MB3,BW] 465-32-497ms   | [S0,MB7,F]  497-11-508ms   | [S0,MB0,B]  507-18-526ms   | [S7,MB4,F]  525-18-544ms   | [S7,MB4,BI] 555-34-589ms   | [S7,MB4,BW] 590-30-620ms   | [S0,MB1,B]  620-17-638ms   | [S7,MB5,F]  638-18-656ms   | [S7,MB5,BI] 668-34-703ms   | [S7,MB5,BW] 703-31-735ms   | [S0,MB2,B]  735-17-752ms   | [S7,MB6,F]  752-18-771ms   | [S7,MB6,BI] 783-34-818ms   | [S7,MB6,BW] 818-30-848ms   | [S0,MB3,B]  848-17-866ms   | [S7,MB7,F]  866-18-885ms   | [S7,MB7,BI] 898-34-932ms   | [S7,MB7,BW] 933-31-964ms   | [S0,MB4,B]  962-17-980ms   | [S0,MB5,B]  980-17-998ms   | [S0,MB6,B]  1000-17-1017ms | [S0,MB7,B]  1028-16-1044ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-21ms      | [S1,MB1,F]  27-11-38ms     | [S1,MB2,F]  45-11-56ms     | [S1,MB3,F]  63-11-74ms     | [S1,MB4,F]  86-11-97ms     | [S6,MB0,F]  97-10-107ms    | [S1,MB5,F]  107-13-121ms   | [S6,MB1,F]  121-8-129ms    | [S6,MB0,BI] 176-9-185ms    | [S6,MB0,BW] 185-10-196ms   | [S6,MB2,F]  195-7-202ms    | [S6,MB1,BI] 266-9-275ms    | [S6,MB1,BW] 275-10-285ms   | [S6,MB3,F]  284-7-292ms    | [S6,MB2,BI] 363-9-372ms    | [S6,MB2,BW] 372-10-383ms   | [S1,MB6,F]  382-10-393ms   | [S1,MB0,BI] 393-15-409ms   | [S1,MB0,BW] 408-15-424ms   | [S6,MB4,F]  423-8-431ms    | [S6,MB3,BI] 460-10-471ms   | [S6,MB3,BW] 470-9-480ms    | [S1,MB7,F]  503-13-517ms   | [S1,MB1,BI] 517-15-533ms   | [S1,MB1,BW] 533-14-548ms   | [S6,MB5,F]  546-7-553ms    | [S6,MB4,BI] 586-10-596ms   | [S6,MB4,BW] 596-9-606ms    | [S1,MB2,BI] 625-14-639ms   | [S1,MB2,BW] 639-14-653ms   | [S6,MB6,F]  709-7-716ms    | [S6,MB5,BI] 717-9-726ms    | [S6,MB5,BW] 726-11-737ms   | [S1,MB3,BI] 739-14-753ms   | [S1,MB3,BW] 753-14-767ms   | [S6,MB7,F]  824-7-831ms    | [S6,MB6,BI] 831-9-840ms    | [S6,MB6,BW] 840-11-851ms   | [S1,MB4,BI] 853-14-867ms   | [S6,MB7,BI] 927-10-938ms   | [S1,MB5,BI] 938-15-953ms   | [S1,MB4,BW] 953-16-969ms   | [S1,MB6,BI] 970-14-984ms   | [S1,MB5,BW] 984-15-1000ms  | [S1,MB7,BI] 1000-14-1015ms | [S1,MB6,BW] 1015-16-1031ms | [S6,MB7,BW] 1031-11-1042ms | [S1,MB7,BW] 1042-16-1059ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-8-29ms      | [S2,MB1,F]  38-8-46ms      | [S2,MB2,F]  56-8-64ms      | [S5,MB0,F]  64-9-74ms      | [S2,MB3,F]  75-10-85ms     | [S5,MB1,F]  85-7-93ms      | [S2,MB4,F]  97-11-108ms    | [S5,MB2,F]  116-9-125ms    | [S5,MB0,BI] 185-9-195ms    | [S5,MB0,BW] 195-0-195ms    | [S5,MB3,F]  195-8-204ms    | [S5,MB1,BI] 275-9-284ms    | [S5,MB1,BW] 284-0-284ms    | [S2,MB5,F]  285-9-294ms    | [S2,MB0,BI] 294-10-305ms   | [S2,MB0,BW] 305-0-305ms    | [S5,MB4,F]  305-7-313ms    | [S5,MB2,BI] 372-10-382ms   | [S5,MB2,BW] 382-0-382ms    | [S2,MB6,F]  394-10-405ms   | [S2,MB1,BI] 405-10-415ms   | [S2,MB1,BW] 415-0-415ms    | [S5,MB5,F]  417-7-425ms    | [S5,MB3,BI] 507-10-518ms   | [S5,MB3,BW] 518-0-518ms    | [S2,MB7,F]  520-10-531ms   | [S2,MB2,BI] 531-10-542ms   | [S2,MB2,BW] 542-0-542ms    | [S5,MB6,F]  542-7-550ms    | [S5,MB4,BI] 618-10-628ms   | [S5,MB4,BW] 628-0-628ms    | [S2,MB3,BI] 712-9-722ms    | [S2,MB3,BW] 722-0-722ms    | [S5,MB7,F]  739-7-746ms    | [S5,MB5,BI] 746-9-756ms    | [S5,MB5,BW] 756-0-756ms    | [S2,MB4,BI] 827-9-836ms    | [S5,MB6,BI] 846-10-856ms   | [S2,MB5,BI] 856-10-866ms   | [S5,MB7,BI] 941-9-951ms    | [S2,MB6,BI] 950-11-961ms   | [S2,MB4,BW] 961-0-961ms    | [S2,MB7,BI] 977-9-986ms    | [S2,MB5,BW] 986-0-986ms    | [S5,MB6,BW] 990-0-990ms    | [S5,MB7,BW] 990-0-990ms    | [S2,MB6,BW] 990-0-990ms    | [S2,MB7,BW] 990-0-990ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-8-37ms      | [S4,MB0,F]  37-8-45ms      | [S3,MB1,F]  47-8-55ms      | [S4,MB1,F]  55-7-63ms      | [S3,MB2,F]  65-7-72ms      | [S4,MB2,F]  72-7-80ms      | [S3,MB3,F]  99-7-107ms     | [S4,MB3,F]  107-8-115ms    | [S4,MB0,BI] 195-9-204ms    | [S4,MB0,BW] 204-9-213ms    | [S3,MB4,F]  213-7-220ms    | [S3,MB0,BI] 220-9-230ms    | [S3,MB0,BW] 230-9-239ms    | [S4,MB4,F]  238-7-246ms    | [S4,MB1,BI] 284-10-295ms   | [S4,MB1,BW] 295-10-305ms   | [S3,MB5,F]  305-7-313ms    | [S3,MB1,BI] 313-9-322ms    | [S3,MB1,BW] 322-9-332ms    | [S4,MB5,F]  330-7-338ms    | [S4,MB2,BI] 398-11-409ms   | [S4,MB2,BW] 409-9-419ms    | [S3,MB6,F]  419-7-426ms    | [S3,MB2,BI] 426-9-436ms    | [S3,MB2,BW] 435-9-445ms    | [S4,MB6,F]  444-7-452ms    | [S4,MB3,BI] 523-11-534ms   | [S4,MB3,BW] 533-9-543ms    | [S3,MB7,F]  543-7-551ms    | [S3,MB3,BI] 551-9-561ms    | [S3,MB3,BW] 560-9-570ms    | [S4,MB7,F]  567-7-575ms    | [S4,MB4,BI] 706-10-716ms   | [S4,MB4,BW] 716-9-726ms    | [S3,MB4,BI] 726-10-736ms   | [S4,MB5,BI] 820-10-830ms   | [S3,MB5,BI] 831-9-840ms    | [S4,MB6,BI] 856-9-866ms    | [S3,MB6,BI] 866-9-875ms    | [S4,MB7,BI] 952-9-961ms    | [S3,MB7,BI] 961-9-970ms    | [S3,MB4,BW] 970-10-981ms   | [S4,MB5,BW] 979-9-988ms    | [S4,MB6,BW] 989-9-998ms    | [S4,MB7,BW] 998-9-1008ms   | [S3,MB5,BW] 1008-9-1018ms  | [S3,MB6,BW] 1015-10-1026ms | [S3,MB7,BW] 1024-10-1035ms
[rank3]:2025-12-25 13:01:42,858 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank3/251225_1301_stage3_step600.svg
[rank3]:2025-12-25 13:01:42,900 - âœ… Frozen Ratio History of Rank 3 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank3/251225_1301_stage4_step600.svg
[rank1]:2025-12-25 13:02:21,830 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 2.3589e+00
[rank3]:2025-12-25 13:02:21,812 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 9.5211e-01
[rank0]:2025-12-25 13:02:21,839 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 1.1696e+00
[rank2]:2025-12-25 13:02:21,820 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 0.0000e+00
[rank2]:2025-12-25 13:03:04,966 - Freezing Ratio: [Stage2] 0.50, [Stage5] 0.00, Threshold: 8.9801e-01
[rank1]:2025-12-25 13:03:04,977 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 1.0797e+00
[rank3]:2025-12-25 13:03:04,969 - Freezing Ratio: [Stage3] 1.00, [Stage4] 0.00, Threshold: 8.4673e-01
[rank0]:2025-12-25 13:03:04,986 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 9.8483e-01
[rank3]:2025-12-25 13:03:48,182 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 8.1405e-01
[rank2]:2025-12-25 13:03:48,182 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 5.6206e+00
[rank1]:2025-12-25 13:03:48,200 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 8.3178e-01
[rank0]:2025-12-25 13:03:48,210 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 3.3004e-01
[rank2]:2025-12-25 13:04:31,547 - Freezing Ratio: [Stage2] 1.00, [Stage5] 0.50, Threshold: 5.9924e-01
[rank1]:2025-12-25 13:04:31,557 - Freezing Ratio: [Stage1] 0.33, [Stage6] 0.00, Threshold: 7.9677e-01
[rank3]:2025-12-25 13:04:31,549 - Freezing Ratio: [Stage3] 1.00, [Stage4] 0.00, Threshold: 7.7404e-01
[rank0]:2025-12-25 13:04:31,566 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 3.8357e-01
[rank0]:2025-12-25 13:05:14,058 - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-12-25 13:05:14,304 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 9.0000e+00
[rank3]:2025-12-25 13:05:14,372 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 7.7251e-01
[rank1]:2025-12-25 13:05:14,376 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 4.7017e+00
[rank0]:2025-12-25 13:05:14,400 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 8.7510e-01
[rank3]:2025-12-25 13:05:18,676 - Avg. fwd time: 7.8800 / Avg. bwd-weight time: 7.3490 / Avg. bwd-input time: 9.6635 / Avg. batch time: 996.7519 (ms) / GPU bubble ratio: 60.04%
[rank1]:2025-12-25 13:05:18,687 - Avg. fwd time: 10.0677 / Avg. bwd-weight time: 10.0431 / Avg. bwd-input time: 12.1977 / Avg. batch time: 1041.7223 (ms) / GPU bubble ratio: 50.38%
[rank0]:2025-12-25 13:05:18,661 - Avg. fwd time: 13.9200 / Avg. full-bwd time: 18.8695 (Avg. bwd-weight time: 30.2639 / Avg. bwd-input time: 34.5441) / Avg. batch time: 1049.6921 (ms) / GPU bubble ratio: 15.01%
[rank2]:2025-12-25 13:05:18,668 - Avg. fwd time: 8.3459 / Avg. bwd-weight time: 7.3051 / Avg. bwd-input time: 10.0369 / Avg. batch time: 1005.6946 (ms) / GPU bubble ratio: 59.13%
[rank2]:2025-12-25 13:05:18,706 -  step: 650  loss: -4.0000  grad_norm:  0.1554  memory: 13.80GiB(29.05%)  tps: 7,576  tflops: 59.23  mfu: 18.98%
[rank3]:2025-12-25 13:05:18,706 -  step: 650  loss: -4.0000  grad_norm:  0.1554  memory: 15.27GiB(32.13%)  tps: 7,576  tflops: 59.22  mfu: 18.98%
[rank1]:2025-12-25 13:05:18,712 -  step: 650  loss: -4.0000  grad_norm:  0.1554  memory: 17.83GiB(37.53%)  tps: 7,576  tflops: 59.23  mfu: 18.98%
[rank0]:2025-12-25 13:05:18,726 -  step: 650  loss:  0.2368  grad_norm:  0.1554  memory: 35.32GiB(74.36%)  tps: 7,576  tflops: 59.23  mfu: 18.98%
[rank2]:2025-12-25 13:05:57,652 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 0.0000e+00
[rank3]:2025-12-25 13:05:57,655 - Freezing Ratio: [Stage3] 1.00, [Stage4] 0.50, Threshold: 1.1592e+00
[rank1]:2025-12-25 13:05:57,663 - Freezing Ratio: [Stage1] 1.00, [Stage6] 0.00, Threshold: 1.8052e+00
[rank0]:2025-12-25 13:05:57,672 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 1.8163e+00
[rank3]:2025-12-25 13:06:40,310 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 9.0000e+00
[rank1]:2025-12-25 13:06:40,393 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 5.5149e-01
[rank2]:2025-12-25 13:06:40,404 - Freezing Ratio: [Stage2] 1.00, [Stage5] 0.50, Threshold: 3.6904e-01
[rank0]:2025-12-25 13:06:40,421 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 3.9365e-01
[rank2]:2025-12-25 13:07:23,654 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 9.0000e+00
[rank3]:2025-12-25 13:07:23,740 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 0.0000e+00
[rank0]:2025-12-25 13:07:23,758 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 1.1171e+00
[rank1]:2025-12-25 13:07:23,749 - Freezing Ratio: [Stage1] 1.00, [Stage6] 0.00, Threshold: 1.2006e+00
[rank1]:2025-12-25 13:08:06,706 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 6.5985e-01
[rank2]:2025-12-25 13:08:06,717 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 0.0000e+00
[rank3]:2025-12-25 13:08:06,719 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 7.6900e-01
[rank0]:2025-12-25 13:08:06,734 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 4.7864e-01
[rank0]:2025-12-25 13:08:49,529 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-25 13:08:49,881 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 3.3549e+00
[rank1]:2025-12-25 13:08:49,872 - Freezing Ratio: [Stage1] 1.00, [Stage6] 0.00, Threshold: 3.2165e+00
[rank2]:2025-12-25 13:08:49,861 - Freezing Ratio: [Stage2] 0.50, [Stage5] 0.00, Threshold: 4.1115e+00
[rank3]:2025-12-25 13:08:49,864 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 4.6159e+00
[rank0]:2025-12-25 13:08:54,078 - Avg. fwd time: 13.9238 / Avg. full-bwd time: 18.7680 (Avg. bwd-weight time: 30.2641 / Avg. bwd-input time: 34.5438) / Avg. batch time: 1048.9647 (ms) / GPU bubble ratio: 15.02%
[rank1]:2025-12-25 13:08:54,069 - Avg. fwd time: 10.0694 / Avg. bwd-weight time: 10.0217 / Avg. bwd-input time: 12.1986 / Avg. batch time: 1041.0902 (ms) / GPU bubble ratio: 50.38%
[rank2]:2025-12-25 13:08:54,061 - Avg. fwd time: 8.3420 / Avg. bwd-weight time: 7.3524 / Avg. bwd-input time: 10.0375 / Avg. batch time: 1005.5683 (ms) / GPU bubble ratio: 59.06%
[rank2]:2025-12-25 13:08:54,116 -  step: 700  loss: -4.0000  grad_norm:  0.1234  memory: 13.80GiB(29.05%)  tps: 7,606  tflops: 59.46  mfu: 19.06%
[rank3]:2025-12-25 13:08:54,099 - Avg. fwd time: 7.8771 / Avg. bwd-weight time: 7.3883 / Avg. bwd-input time: 9.6648 / Avg. batch time: 996.7808 (ms) / GPU bubble ratio: 59.98%
[rank3]:2025-12-25 13:08:54,124 -  step: 700  loss: -4.0000  grad_norm:  0.1234  memory: 15.27GiB(32.13%)  tps: 7,606  tflops: 59.46  mfu: 19.06%
[rank0]:2025-12-25 13:08:54,142 -  step: 700  loss:  0.1989  grad_norm:  0.1234  memory: 35.32GiB(74.36%)  tps: 7,606  tflops: 59.46  mfu: 19.06%
[rank1]:2025-12-25 13:08:54,116 -  step: 700  loss: -4.0000  grad_norm:  0.1234  memory: 17.83GiB(37.53%)  tps: 7,606  tflops: 59.46  mfu: 19.06%
[rank2]:2025-12-25 13:08:54,196 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank2/251225_1308_stage2_step700.svg
[rank2]:2025-12-25 13:08:54,240 - âœ… Frozen Ratio History of Rank 2 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank2/251225_1308_stage5_step700.svg
[rank0]:2025-12-25 13:08:54,195 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank0/251225_1308_stage0_step700.svg
[rank0]:2025-12-25 13:08:54,238 - âœ… Frozen Ratio History of Rank 0 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank0/251225_1308_stage7_step700.svg
[rank1]:2025-12-25 13:08:54,197 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank1/251225_1308_stage1_step700.svg
[rank1]:2025-12-25 13:08:54,241 - âœ… Frozen Ratio History of Rank 1 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank1/251225_1308_stage6_step700.svg
[rank3]:2025-12-25 13:08:54,486 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/pipeline_schedule/251225_1308_step700_rank3.svg
[rank3]:			> Batch Time: 1042.58 ms, GPU Bubble Ratio: 15.44%, 46.12%, 56.60%, 58.07%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-9-26ms      | [S0,MB3,F]  26-8-35ms      | [S0,MB4,F]  35-9-45ms      | [S0,MB5,F]  45-9-55ms      | [S0,MB6,F]  54-10-65ms     | [S7,MB0,F]  121-17-138ms   | [S7,MB0,BI] 150-32-183ms   | [S7,MB0,BW] 183-25-208ms   | [S7,MB1,F]  209-16-225ms   | [S7,MB1,BI] 237-34-272ms   | [S7,MB1,BW] 271-29-301ms   | [S7,MB2,F]  303-19-322ms   | [S7,MB2,BI] 333-35-368ms   | [S7,MB2,BW] 368-31-399ms   | [S7,MB3,F]  399-19-418ms   | [S7,MB3,BI] 431-35-466ms   | [S7,MB3,BW] 466-31-498ms   | [S0,MB7,F]  497-11-508ms   | [S0,MB0,B]  508-18-527ms   | [S7,MB4,F]  526-18-545ms   | [S7,MB4,BI] 557-34-591ms   | [S7,MB4,BW] 592-31-623ms   | [S0,MB1,B]  621-17-639ms   | [S7,MB5,F]  638-18-657ms   | [S7,MB5,BI] 669-34-703ms   | [S7,MB5,BW] 703-31-735ms   | [S0,MB2,B]  735-17-752ms   | [S7,MB6,F]  752-18-770ms   | [S7,MB6,BI] 782-34-817ms   | [S7,MB6,BW] 817-30-847ms   | [S0,MB3,B]  847-17-865ms   | [S7,MB7,F]  865-18-884ms   | [S7,MB7,BI] 896-34-930ms   | [S7,MB7,BW] 930-31-961ms   | [S0,MB4,B]  960-17-978ms   | [S0,MB5,B]  978-17-995ms   | [S0,MB6,B]  997-17-1014ms  | [S0,MB7,B]  1024-16-1040ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-21ms      | [S1,MB1,F]  27-11-38ms     | [S1,MB2,F]  45-11-56ms     | [S1,MB3,F]  62-11-73ms     | [S1,MB4,F]  86-11-97ms     | [S6,MB0,F]  97-10-107ms    | [S1,MB5,F]  107-13-120ms   | [S6,MB1,F]  120-8-129ms    | [S6,MB0,BI] 176-9-185ms    | [S6,MB0,BW] 185-10-195ms   | [S6,MB2,F]  195-7-202ms    | [S6,MB1,BI] 264-9-273ms    | [S6,MB1,BW] 273-10-284ms   | [S6,MB3,F]  284-7-291ms    | [S6,MB2,BI] 360-9-369ms    | [S6,MB2,BW] 369-10-380ms   | [S1,MB6,F]  380-10-391ms   | [S1,MB0,BI] 391-15-407ms   | [S1,MB0,BW] 407-15-422ms   | [S6,MB4,F]  420-7-428ms    | [S6,MB3,BI] 458-10-468ms   | [S6,MB3,BW] 468-9-478ms    | [S1,MB7,F]  499-13-513ms   | [S1,MB1,BI] 513-15-529ms   | [S1,MB1,BW] 529-14-543ms   | [S6,MB5,F]  542-7-550ms    | [S6,MB4,BI] 582-10-592ms   | [S6,MB4,BW] 592-9-602ms    | [S1,MB2,BI] 621-14-635ms   | [S1,MB2,BW] 635-14-649ms   | [S6,MB6,F]  705-7-712ms    | [S6,MB5,BI] 713-9-722ms    | [S6,MB5,BW] 722-11-733ms   | [S1,MB3,BI] 735-14-749ms   | [S1,MB3,BW] 750-14-764ms   | [S6,MB7,F]  818-7-825ms    | [S6,MB6,BI] 825-9-835ms    | [S6,MB6,BW] 835-11-846ms   | [S1,MB4,BI] 848-14-862ms   | [S6,MB7,BI] 922-10-933ms   | [S1,MB5,BI] 933-15-948ms   | [S1,MB4,BW] 948-16-964ms   | [S1,MB6,BI] 964-14-979ms   | [S1,MB5,BW] 978-15-994ms   | [S1,MB7,BI] 994-15-1009ms  | [S1,MB6,BW] 1008-16-1025ms | [S6,MB7,BW] 1024-11-1035ms | [S1,MB7,BW] 1034-16-1051ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-8-29ms      | [S2,MB1,F]  38-7-46ms      | [S2,MB2,F]  56-7-63ms      | [S5,MB0,F]  63-9-72ms      | [S2,MB3,F]  74-9-83ms      | [S5,MB1,F]  83-7-91ms      | [S2,MB4,F]  97-10-107ms    | [S5,MB2,F]  116-8-124ms    | [S5,MB0,BI] 185-9-194ms    | [S5,MB0,BW] 194-10-204ms   | [S5,MB3,F]  204-7-211ms    | [S5,MB1,BI] 274-9-283ms    | [S5,MB1,BW] 283-10-294ms   | [S2,MB5,F]  294-7-301ms    | [S2,MB0,BI] 301-10-312ms   | [S2,MB0,BW] 312-9-322ms    | [S5,MB4,F]  321-7-329ms    | [S5,MB2,BI] 369-10-380ms   | [S5,MB2,BW] 380-9-390ms    | [S2,MB6,F]  392-9-402ms    | [S2,MB1,BI] 403-10-414ms   | [S2,MB1,BW] 414-9-424ms    | [S5,MB5,F]  423-7-431ms    | [S5,MB3,BI] 504-10-515ms   | [S5,MB3,BW] 515-11-527ms   | [S2,MB7,F]  527-7-534ms    | [S2,MB2,BI] 534-10-544ms   | [S2,MB2,BW] 544-9-554ms    | [S5,MB6,F]  554-7-561ms    | [S5,MB4,BI] 614-10-624ms   | [S5,MB4,BW] 624-9-634ms    | [S2,MB3,BI] 708-9-718ms    | [S2,MB3,BW] 718-10-728ms   | [S5,MB7,F]  735-7-742ms    | [S5,MB5,BI] 742-9-752ms    | [S5,MB5,BW] 752-9-761ms    | [S2,MB4,BI] 821-9-831ms    | [S5,MB6,BI] 840-10-851ms   | [S2,MB5,BI] 851-10-861ms   | [S5,MB7,BI] 936-9-945ms    | [S2,MB6,BI] 945-10-956ms   | [S2,MB4,BW] 956-10-966ms   | [S2,MB7,BI] 971-9-980ms    | [S2,MB5,BW] 980-10-990ms   | [S5,MB6,BW] 990-9-1000ms   | [S5,MB7,BW] 1000-9-1010ms  | [S2,MB6,BW] 1010-9-1020ms  | [S2,MB7,BW] 1020-10-1030ms
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-8-37ms      | [S4,MB0,F]  37-8-45ms      | [S3,MB1,F]  46-8-55ms      | [S4,MB1,F]  55-7-62ms      | [S3,MB2,F]  64-7-71ms      | [S4,MB2,F]  71-7-79ms      | [S3,MB3,F]  98-7-106ms     | [S4,MB3,F]  106-8-114ms    | [S4,MB0,BI] 194-9-203ms    | [S4,MB0,BW] 203-9-213ms    | [S3,MB4,F]  212-7-219ms    | [S3,MB0,BI] 219-9-229ms    | [S3,MB0,BW] 229-9-238ms    | [S4,MB4,F]  238-7-246ms    | [S4,MB1,BI] 283-10-293ms   | [S4,MB1,BW] 293-10-303ms   | [S3,MB5,F]  303-8-311ms    | [S3,MB1,BI] 311-9-321ms    | [S3,MB1,BW] 321-9-331ms    | [S4,MB5,F]  331-7-338ms    | [S4,MB2,BI] 396-11-407ms   | [S4,MB2,BW] 408-9-417ms    | [S3,MB6,F]  418-7-425ms    | [S3,MB2,BI] 425-9-434ms    | [S3,MB2,BW] 434-9-444ms    | [S4,MB6,F]  444-7-452ms    | [S4,MB3,BI] 519-10-529ms   | [S4,MB3,BW] 529-10-540ms   | [S3,MB7,F]  540-7-547ms    | [S3,MB3,BI] 547-9-557ms    | [S3,MB3,BW] 557-9-567ms    | [S4,MB7,F]  566-7-574ms    | [S4,MB4,BI] 702-10-712ms   | [S4,MB4,BW] 712-9-722ms    | [S3,MB4,BI] 722-10-732ms   | [S4,MB5,BI] 815-10-825ms   | [S3,MB5,BI] 825-9-834ms    | [S4,MB6,BI] 851-9-861ms    | [S3,MB6,BI] 860-9-870ms    | [S4,MB7,BI] 946-9-955ms    | [S3,MB7,BI] 955-9-964ms    | [S3,MB4,BW] 964-10-975ms   | [S4,MB5,BW] 975-9-984ms    | [S4,MB6,BW] 984-9-994ms    | [S4,MB7,BW] 994-9-1004ms   | [S3,MB5,BW] 1004-9-1014ms  | [S3,MB6,BW] 1014-10-1024ms | [S3,MB7,BW] 1024-10-1035ms
[rank3]:2025-12-25 13:08:54,540 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank3/251225_1308_stage3_step700.svg
[rank3]:2025-12-25 13:08:54,586 - âœ… Frozen Ratio History of Rank 3 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank3/251225_1308_stage4_step700.svg
[rank1]:2025-12-25 13:09:33,017 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 9.3047e-01
[rank2]:2025-12-25 13:09:33,017 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 5.7329e+00
[rank3]:2025-12-25 13:09:33,030 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 8.6422e-01
[rank0]:2025-12-25 13:09:33,045 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 1.1334e+00
[rank2]:2025-12-25 13:10:16,394 - Freezing Ratio: [Stage2] 1.00, [Stage5] 0.50, Threshold: 9.9676e-01
[rank3]:2025-12-25 13:10:16,397 - Freezing Ratio: [Stage3] 0.50, [Stage4] 0.00, Threshold: 9.7173e-01
[rank1]:2025-12-25 13:10:16,404 - Freezing Ratio: [Stage1] 1.00, [Stage6] 0.00, Threshold: 7.6013e-01
[rank0]:2025-12-25 13:10:16,414 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 4.1199e-01
[rank2]:2025-12-25 13:10:59,266 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 9.0000e+00
[rank1]:2025-12-25 13:10:59,338 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 1.6179e+00
[rank3]:2025-12-25 13:10:59,338 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 5.7639e+00
[rank0]:2025-12-25 13:10:59,367 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 7.0016e-01
[rank2]:2025-12-25 13:11:42,551 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 0.0000e+00
[rank3]:2025-12-25 13:11:42,553 - Freezing Ratio: [Stage3] 1.00, [Stage4] 0.50, Threshold: 6.0739e-01
[rank1]:2025-12-25 13:11:42,561 - Freezing Ratio: [Stage1] 1.00, [Stage6] 0.00, Threshold: 8.5578e-01
[rank0]:2025-12-25 13:11:42,570 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 9.0280e-01
[rank0]:2025-12-25 13:12:25,011 - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-12-25 13:12:25,339 - Freezing Ratio: [Stage2] 1.00, [Stage5] 0.50, Threshold: 8.0965e-01
[rank3]:2025-12-25 13:12:25,262 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 9.0000e+00
[rank1]:2025-12-25 13:12:25,327 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 1.0323e+00
[rank0]:2025-12-25 13:12:25,356 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 7.7146e-01
[rank2]:2025-12-25 13:12:29,633 - Avg. fwd time: 8.3414 / Avg. bwd-weight time: 7.3271 / Avg. bwd-input time: 10.0380 / Avg. batch time: 1005.2560 (ms) / GPU bubble ratio: 59.08%
[rank0]:2025-12-25 13:12:29,677 - Avg. fwd time: 13.9282 / Avg. full-bwd time: 18.6815 (Avg. bwd-weight time: 30.2679 / Avg. bwd-input time: 34.5437) / Avg. batch time: 1048.3673 (ms) / GPU bubble ratio: 15.03%
[rank2]:2025-12-25 13:12:29,711 -  step: 750  loss: -4.0000  grad_norm:  0.0000  memory: 13.80GiB(29.05%)  tps: 7,599  tflops: 59.41  mfu: 19.04%
[rank3]:2025-12-25 13:12:29,690 - Avg. fwd time: 7.8757 / Avg. bwd-weight time: 7.3559 / Avg. bwd-input time: 9.6663 / Avg. batch time: 996.3373 (ms) / GPU bubble ratio: 60.02%
[rank3]:2025-12-25 13:12:29,724 -  step: 750  loss: -4.0000  grad_norm:  0.1654  memory: 15.27GiB(32.13%)  tps: 7,599  tflops: 59.41  mfu: 19.04%
[rank1]:2025-12-25 13:12:29,705 - Avg. fwd time: 10.0756 / Avg. bwd-weight time: 9.9195 / Avg. bwd-input time: 12.1984 / Avg. batch time: 1040.2465 (ms) / GPU bubble ratio: 50.48%
[rank1]:2025-12-25 13:12:29,729 -  step: 750  loss: -4.0000  grad_norm:  0.1654  memory: 17.83GiB(37.53%)  tps: 7,599  tflops: 59.40  mfu: 19.04%
[rank0]:2025-12-25 13:12:29,743 -  step: 750  loss:  0.2404  grad_norm:  0.1654  memory: 35.32GiB(74.36%)  tps: 7,599  tflops: 59.41  mfu: 19.04%
[rank2]:2025-12-25 13:13:08,579 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 9.0000e+00
[rank3]:2025-12-25 13:13:08,666 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 0.0000e+00
[rank1]:2025-12-25 13:13:08,675 - Freezing Ratio: [Stage1] 1.00, [Stage6] 0.00, Threshold: 1.1729e+00
[rank0]:2025-12-25 13:13:08,684 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 1.0405e+00
[rank2]:2025-12-25 13:13:51,557 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 0.0000e+00
[rank3]:2025-12-25 13:13:51,558 - Freezing Ratio: [Stage3] 0.50, [Stage4] 0.00, Threshold: 9.5940e-01
[rank1]:2025-12-25 13:13:51,547 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 9.2898e-01
[rank0]:2025-12-25 13:13:51,576 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 6.2874e-01
[rank3]:2025-12-25 13:14:34,761 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 5.9820e+00
[rank2]:2025-12-25 13:14:34,768 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 1.6707e+00
[rank1]:2025-12-25 13:14:34,779 - Freezing Ratio: [Stage1] 1.00, [Stage6] 0.50, Threshold: 1.3571e+00
[rank0]:2025-12-25 13:14:34,788 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 1.0075e+00
[rank1]:2025-12-25 13:15:17,450 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 9.0000e+00
[rank3]:2025-12-25 13:15:17,515 - Freezing Ratio: [Stage3] 1.00, [Stage4] 0.00, Threshold: 4.1264e-01
[rank2]:2025-12-25 13:15:17,513 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 4.5985e-01
[rank0]:2025-12-25 13:15:17,532 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 2.8059e-01
[rank0]:2025-12-25 13:16:00,519 - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-12-25 13:16:00,868 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 0.0000e+00
[rank3]:2025-12-25 13:16:00,849 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 3.7780e-01
[rank2]:2025-12-25 13:16:00,858 - Freezing Ratio: [Stage2] 0.50, [Stage5] 0.00, Threshold: 5.2354e-01
[rank0]:2025-12-25 13:16:00,877 - Freezing Ratio: [Stage0] 0.95, [Stage7] 0.00, Threshold: 3.6064e-01
[rank2]:2025-12-25 13:16:05,209 - Avg. fwd time: 8.3367 / Avg. bwd-weight time: 7.3814 / Avg. bwd-input time: 10.0386 / Avg. batch time: 1005.2633 (ms) / GPU bubble ratio: 59.01%
[rank0]:2025-12-25 13:16:05,233 - Avg. fwd time: 13.9312 / Avg. full-bwd time: 18.6059 (Avg. bwd-weight time: 30.2709 / Avg. bwd-input time: 34.5445) / Avg. batch time: 1047.8637 (ms) / GPU bubble ratio: 15.04%
[rank1]:2025-12-25 13:16:05,261 - Avg. fwd time: 10.0812 / Avg. bwd-weight time: 9.8526 / Avg. bwd-input time: 12.1984 / Avg. batch time: 1039.7263 (ms) / GPU bubble ratio: 50.55%
[rank1]:2025-12-25 13:16:05,284 -  step: 800  loss: -4.0000  grad_norm:  0.1688  memory: 17.83GiB(37.53%)  tps: 7,601  tflops: 59.42  mfu: 19.04%
[rank1]:2025-12-25 13:16:05,285 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  0.1688  tps: 8,000  tflops: 62.54  mfu: 18.23%
[rank1]:2025-12-25 13:16:05,285 - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-12-25 13:16:05,285 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank3]:2025-12-25 13:16:05,246 - Avg. fwd time: 7.8724 / Avg. bwd-weight time: 7.3894 / Avg. bwd-input time: 9.6678 / Avg. batch time: 996.2724 (ms) / GPU bubble ratio: 59.96%
[rank3]:2025-12-25 13:16:05,279 -  step: 800  loss: -4.0000  grad_norm:  0.1688  memory: 15.27GiB(32.13%)  tps: 7,601  tflops: 59.42  mfu: 19.04%
[rank3]:2025-12-25 13:16:05,280 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  0.1688  tps: 7,999  tflops: 62.53  mfu: 18.21%
[rank3]:2025-12-25 13:16:05,280 - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-12-25 13:16:05,280 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank2]:2025-12-25 13:16:05,273 -  step: 800  loss: -4.0000  grad_norm:  0.1688  memory: 13.80GiB(29.05%)  tps: 7,601  tflops: 59.42  mfu: 19.04%
[rank2]:2025-12-25 13:16:05,273 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  0.1688  tps: 7,999  tflops: 62.53  mfu: 18.22%
[rank2]:2025-12-25 13:16:05,273 - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-12-25 13:16:05,274 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-25 13:16:05,299 -  step: 800  loss:  0.2404  grad_norm:  0.1688  memory: 35.32GiB(74.36%)  tps: 7,601  tflops: 59.42  mfu: 19.04%
[rank0]:2025-12-25 13:16:05,299 - â„¹ï¸ final step: 800  loss:  0.2404  grad_norm:  0.1688  tps: 8,005  tflops: 62.58  mfu: 18.34%
[rank0]:2025-12-25 13:16:05,300 - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-12-25 13:16:05,301 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-25 13:16:07,707 - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank1]:2025-12-25 13:16:07,787 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank1/251225_1316_stage1_final800.svg
[rank1]:2025-12-25 13:16:07,831 - âœ… Frozen Ratio History of Rank 1 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank1/251225_1316_stage6_final800.svg
[rank2]:2025-12-25 13:16:07,786 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank2/251225_1316_stage2_final800.svg
[rank2]:2025-12-25 13:16:07,831 - âœ… Frozen Ratio History of Rank 2 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank2/251225_1316_stage5_final800.svg
[rank0]:2025-12-25 13:16:07,785 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank0/251225_1316_stage0_final800.svg
[rank0]:2025-12-25 13:16:07,829 - âœ… Frozen Ratio History of Rank 0 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_ratio_history/rank0/251225_1316_stage7_final800.svg
[rank2]:2025-12-25 13:16:07,931 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_params_histogram/251225_1316_rank2_stage2.svg
[rank2]:	> Counts Sum: 423, Total Sum: 1350 (31.33%), Ratio(%) per element: [33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 29.33, 29.33, 29.33, 29.33, 29.33, 29.33, 29.33, 29.33, 29.33]
[rank0]:2025-12-25 13:16:07,933 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_params_histogram/251225_1316_rank0_stage0.svg
[rank0]:	> Counts Sum: 1314, Total Sum: 1425 (92.21%), Ratio(%) per element: [0.0, 97.33, 97.33, 97.33, 97.33, 97.33, 97.33, 97.33, 97.33, 97.33, 97.33, 97.33, 97.33, 97.33, 97.33, 97.33, 97.33, 97.33, 97.33]
[rank0]:2025-12-25 13:16:07,944 - Destroying the purge thread.
[rank1]:2025-12-25 13:16:07,955 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/frozen_params_histogram/251225_1316_rank1_stage1.svg
[rank1]:	> Counts Sum: 666, Total Sum: 2025 (32.89%), Ratio(%) per element: [36.0, 36.0, 36.0, 36.0, 36.0, 36.0, 36.0, 36.0, 36.0, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 29.33, 29.33, 29.33, 29.33, 29.33, 29.33, 29.33, 29.33, 29.33]
[rank1]:2025-12-25 13:16:07,966 - Destroying the purge thread.
[rank1]:[rank1]: Traceback (most recent call last):
[rank1]:[rank1]:   File "<frozen runpy>", line 198, in _run_module_as_main
[rank1]:[rank1]:   File "<frozen runpy>", line 88, in _run_code
[rank1]:[rank1]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 789, in <module>
[rank1]:[rank1]:     trainer.train()
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
[rank1]:[rank1]:     return f(*args, **kwargs)
[rank1]:[rank1]:            ^^^^^^^^^^^^^^^^^^
[rank1]:[rank1]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 621, in train
[rank1]:[rank1]:     draw_charts(self.freezer, self.step, job_config)
[rank1]:[rank1]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 712, in draw_charts
[rank1]:[rank1]:     draw_elementwise_histogram(data=list(freezer.paramwise_frozen_count[s].values()), stage=s,
[rank1]:[rank1]:   File "/home/shcho/torchtitan/timelyfreeze/core/util.py", line 335, in draw_elementwise_histogram
[rank1]:[rank1]:     ax1.text(max(min(80, past_ratio - 5), 5), 0, total_count_text, ha="center", va="center", fontsize=fontsize, color="black")
[rank1]:[rank1]:                      ^^
[rank1]:[rank1]: UnboundLocalError: cannot access local variable 'past_ratio' where it is not associated with a value
[rank2]:2025-12-25 13:16:07,942 - Destroying the purge thread.
[rank2]:[rank2]: Traceback (most recent call last):
[rank2]:[rank2]:   File "<frozen runpy>", line 198, in _run_module_as_main
[rank2]:[rank2]:   File "<frozen runpy>", line 88, in _run_code
[rank2]:[rank2]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 789, in <module>
[rank2]:[rank2]:     trainer.train()
[rank2]:[rank2]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
[rank2]:[rank2]:     return f(*args, **kwargs)
[rank2]:[rank2]:            ^^^^^^^^^^^^^^^^^^
[rank2]:[rank2]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 621, in train
[rank2]:[rank2]:     draw_charts(self.freezer, self.step, job_config)
[rank2]:[rank2]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 712, in draw_charts
[rank2]:[rank2]:     draw_elementwise_histogram(data=list(freezer.paramwise_frozen_count[s].values()), stage=s,
[rank2]:[rank2]:   File "/home/shcho/torchtitan/timelyfreeze/core/util.py", line 335, in draw_elementwise_histogram
[rank2]:[rank2]:     ax1.text(max(min(80, past_ratio - 5), 5), 0, total_count_text, ha="center", va="center", fontsize=fontsize, color="black")
[rank2]:[rank2]:                      ^^
[rank2]:[rank2]: UnboundLocalError: cannot access local variable 'past_ratio' where it is not associated with a value
[rank0]:wandb: updating run metadata
[rank3]:2025-12-25 13:16:08,063 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1/pipeline_schedule/251225_1316_final800_rank3.svg
[rank3]:			> Batch Time: 1042.53 ms, GPU Bubble Ratio: 15.25%, 46.24%, 56.58%, 58.20%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-9-17ms       | [S0,MB2,F]  17-8-26ms      | [S0,MB3,F]  26-9-36ms      | [S0,MB4,F]  35-9-45ms      | [S0,MB5,F]  45-10-55ms     | [S0,MB6,F]  55-10-65ms     | [S7,MB0,F]  118-17-135ms   | [S7,MB0,BI] 147-32-180ms   | [S7,MB0,BW] 180-25-206ms   | [S7,MB1,F]  207-16-224ms   | [S7,MB1,BI] 236-34-270ms   | [S7,MB1,BW] 270-30-300ms   | [S7,MB2,F]  300-19-320ms   | [S7,MB2,BI] 331-35-366ms   | [S7,MB2,BW] 366-31-397ms   | [S7,MB3,F]  397-19-417ms   | [S7,MB3,BI] 428-34-463ms   | [S7,MB3,BW] 463-31-495ms   | [S0,MB7,F]  495-11-506ms   | [S0,MB0,B]  506-18-525ms   | [S7,MB4,F]  525-18-543ms   | [S7,MB4,BI] 556-34-590ms   | [S7,MB4,BW] 590-30-620ms   | [S0,MB1,B]  620-17-638ms   | [S7,MB5,F]  638-18-657ms   | [S7,MB5,BI] 669-34-703ms   | [S7,MB5,BW] 704-31-735ms   | [S0,MB2,B]  735-17-752ms   | [S7,MB6,F]  753-18-771ms   | [S7,MB6,BI] 784-34-818ms   | [S7,MB6,BW] 818-30-849ms   | [S0,MB3,B]  849-17-867ms   | [S7,MB7,F]  867-18-886ms   | [S7,MB7,BI] 898-34-932ms   | [S7,MB7,BW] 933-31-964ms   | [S0,MB4,B]  963-17-981ms   | [S0,MB5,B]  981-17-999ms   | [S0,MB6,B]  1000-17-1017ms | [S0,MB7,B]  1025-16-1041ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-21ms      | [S1,MB1,F]  27-11-38ms     | [S1,MB2,F]  45-11-56ms     | [S1,MB3,F]  63-11-74ms     | [S1,MB4,F]  86-11-97ms     | [S6,MB0,F]  97-10-107ms    | [S1,MB5,F]  107-13-121ms   | [S6,MB1,F]  121-8-129ms    | [S6,MB0,BI] 176-9-186ms    | [S6,MB0,BW] 185-10-196ms   | [S6,MB2,F]  195-7-202ms    | [S6,MB1,BI] 266-9-275ms    | [S6,MB1,BW] 275-10-285ms   | [S6,MB3,F]  284-7-292ms    | [S6,MB2,BI] 362-9-371ms    | [S6,MB2,BW] 371-10-382ms   | [S1,MB6,F]  381-11-392ms   | [S1,MB0,BI] 392-15-408ms   | [S1,MB0,BW] 408-13-422ms   | [S6,MB4,F]  419-7-427ms    | [S6,MB3,BI] 459-10-469ms   | [S6,MB3,BW] 469-9-479ms    | [S1,MB7,F]  502-13-516ms   | [S1,MB1,BI] 516-15-531ms   | [S1,MB1,BW] 531-14-546ms   | [S6,MB5,F]  541-7-549ms    | [S6,MB4,BI] 585-10-595ms   | [S6,MB4,BW] 596-9-605ms    | [S1,MB2,BI] 624-14-638ms   | [S1,MB2,BW] 638-14-652ms   | [S6,MB6,F]  708-7-715ms    | [S6,MB5,BI] 716-9-725ms    | [S6,MB5,BW] 725-11-736ms   | [S1,MB3,BI] 739-14-753ms   | [S1,MB3,BW] 753-14-768ms   | [S6,MB7,F]  823-7-830ms    | [S6,MB6,BI] 831-9-840ms    | [S6,MB6,BW] 840-11-851ms   | [S1,MB4,BI] 853-14-868ms   | [S6,MB7,BI] 928-10-938ms   | [S1,MB5,BI] 939-15-954ms   | [S1,MB4,BW] 954-15-970ms   | [S1,MB6,BI] 969-14-983ms   | [S1,MB5,BW] 984-15-999ms   | [S1,MB7,BI] 997-14-1012ms  | [S1,MB6,BW] 1012-16-1028ms | [S6,MB7,BW] 1024-10-1035ms | [S1,MB7,BW] 1034-16-1051ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-8-29ms      | [S2,MB1,F]  38-7-46ms      | [S2,MB2,F]  56-7-63ms      | [S5,MB0,F]  64-9-73ms      | [S2,MB3,F]  74-9-84ms      | [S5,MB1,F]  84-7-92ms      | [S2,MB4,F]  97-10-107ms    | [S5,MB2,F]  116-8-125ms    | [S5,MB0,BI] 186-9-195ms    | [S5,MB0,BW] 195-10-205ms   | [S5,MB3,F]  204-7-211ms    | [S5,MB1,BI] 275-9-284ms    | [S5,MB1,BW] 284-10-295ms   | [S2,MB5,F]  293-7-301ms    | [S2,MB0,BI] 301-10-311ms   | [S2,MB0,BW] 311-9-321ms    | [S5,MB4,F]  320-7-328ms    | [S5,MB2,BI] 372-10-382ms   | [S5,MB2,BW] 382-9-392ms    | [S2,MB6,F]  394-9-403ms    | [S2,MB1,BI] 405-10-415ms   | [S2,MB1,BW] 415-9-425ms    | [S5,MB5,F]  423-7-430ms    | [S5,MB3,BI] 506-10-517ms   | [S5,MB3,BW] 517-11-529ms   | [S2,MB7,F]  526-7-534ms    | [S2,MB2,BI] 535-10-545ms   | [S2,MB2,BW] 545-9-555ms    | [S5,MB6,F]  553-7-560ms    | [S5,MB4,BI] 617-10-627ms   | [S5,MB4,BW] 627-9-637ms    | [S2,MB3,BI] 712-9-721ms    | [S2,MB3,BW] 721-10-731ms   | [S5,MB7,F]  739-7-746ms    | [S5,MB5,BI] 746-9-756ms    | [S5,MB5,BW] 756-9-765ms    | [S2,MB4,BI] 826-9-835ms    | [S5,MB6,BI] 846-10-856ms   | [S2,MB5,BI] 856-10-866ms   | [S5,MB7,BI] 942-9-951ms    | [S2,MB6,BI] 951-10-962ms   | [S2,MB4,BW] 962-10-972ms   | [S2,MB7,BI] 977-9-986ms    | [S2,MB5,BW] 986-10-996ms   | [S5,MB6,BW] 993-9-1003ms   | [S5,MB7,BW] 1002-9-1011ms  | [S2,MB6,BW] 1010-9-1020ms  | [S2,MB7,BW] 1020-9-1029ms 
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-8-37ms      | [S4,MB0,F]  37-8-45ms      | [S3,MB1,F]  46-8-55ms      | [S4,MB1,F]  55-7-63ms      | [S3,MB2,F]  64-7-72ms      | [S4,MB2,F]  72-7-80ms      | [S3,MB3,F]  99-7-107ms     | [S4,MB3,F]  107-8-115ms    | [S4,MB0,BI] 195-9-204ms    | [S4,MB0,BW] 204-9-213ms    | [S3,MB4,F]  212-7-219ms    | [S3,MB0,BI] 220-9-229ms    | [S3,MB0,BW] 229-8-238ms    | [S4,MB4,F]  237-7-245ms    | [S4,MB1,BI] 284-10-295ms   | [S4,MB1,BW] 295-10-305ms   | [S3,MB5,F]  305-8-313ms    | [S3,MB1,BI] 313-9-322ms    | [S3,MB1,BW] 322-9-332ms    | [S4,MB5,F]  329-7-337ms    | [S4,MB2,BI] 398-11-409ms   | [S4,MB2,BW] 409-9-419ms    | [S3,MB6,F]  417-7-425ms    | [S3,MB2,BI] 425-9-434ms    | [S3,MB2,BW] 434-9-444ms    | [S4,MB6,F]  442-7-449ms    | [S4,MB3,BI] 521-10-532ms   | [S4,MB3,BW] 532-10-542ms   | [S3,MB7,F]  541-7-548ms    | [S3,MB3,BI] 549-9-558ms    | [S3,MB3,BW] 558-9-567ms    | [S4,MB7,F]  565-7-572ms    | [S4,MB4,BI] 705-10-715ms   | [S4,MB4,BW] 715-9-725ms    | [S3,MB4,BI] 724-10-734ms   | [S4,MB5,BI] 820-10-830ms   | [S3,MB5,BI] 830-9-839ms    | [S4,MB6,BI] 857-9-866ms    | [S3,MB6,BI] 866-9-875ms    | [S4,MB7,BI] 952-9-961ms    | [S3,MB7,BI] 961-9-970ms    | [S3,MB4,BW] 970-10-980ms   | [S4,MB5,BW] 977-9-986ms    | [S4,MB6,BW] 986-9-995ms    | [S4,MB7,BW] 995-9-1004ms   | [S3,MB5,BW] 1004-9-1014ms  | [S3,MB6,BW] 1012-10-1022ms | [S3,MB7,BW] 1021-10-1032ms
[rank3]:2025-12-25 13:16:08,065 - Destroying the purge thread.
[rank3]:[rank3]: Traceback (most recent call last):
[rank3]:[rank3]:   File "<frozen runpy>", line 198, in _run_module_as_main
[rank3]:[rank3]:   File "<frozen runpy>", line 88, in _run_code
[rank3]:[rank3]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 789, in <module>
[rank3]:[rank3]:     trainer.train()
[rank3]:[rank3]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
[rank3]:[rank3]:     return f(*args, **kwargs)
[rank3]:[rank3]:            ^^^^^^^^^^^^^^^^^^
[rank3]:[rank3]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 621, in train
[rank3]:[rank3]:     draw_charts(self.freezer, self.step, job_config)
[rank3]:[rank3]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 688, in draw_charts
[rank3]:[rank3]:     pipeline_schedule = schedule_pipeline(pipeline_schedule, 
[rank3]:[rank3]:                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:[rank3]:   File "/home/shcho/torchtitan/timelyfreeze/core/schedule.py", line 414, in schedule_pipeline
[rank3]:[rank3]:     assert fwd_time is None or len(fwd_time) == num_stages, f"fwd_time should have the same length as num_stages. fwd_time: {len(fwd_time)}, num_stages: {num_stages}"
[rank3]:[rank3]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:[rank3]: AssertionError: fwd_time should have the same length as num_stages. fwd_time: 4, num_stages: 8
[rank0]:wandb: uploading history steps 16-16, summary, console lines 162-167
[rank0]:wandb: 
[rank0]:wandb: Run history:
[rank0]:wandb:      final/avg_end_to_end(s) â–
[rank0]:wandb:               final/avg_loss â–
[rank0]:wandb:             final/avg_mfu(%) â–
[rank0]:wandb:             final/avg_tflops â–
[rank0]:wandb:    final/avg_throughput(tps) â–
[rank0]:wandb:              final/grad_norm â–
[rank0]:wandb:               final/max_loss â–
[rank0]:wandb:                    grad_norm â–ˆâ–‚â–â–‚â–â–‚â–â–â–â–â–â–â–â–â–â–â–
[rank0]:wandb: loss_metrics/global_avg_loss â–ˆâ–ˆâ–‡â–„â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–
[rank0]:wandb: loss_metrics/global_max_loss â–ˆâ–ˆâ–‡â–„â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–
[rank0]:wandb:                          +14 ...
[rank0]:wandb: 
[rank0]:wandb: Run summary:
[rank0]:wandb:      final/avg_end_to_end(s) 4.09324
[rank0]:wandb:               final/avg_loss 0.24045
[rank0]:wandb:             final/avg_mfu(%) 18.33904
[rank0]:wandb:             final/avg_tflops 62.58241
[rank0]:wandb:    final/avg_throughput(tps) 8005.38454
[rank0]:wandb:              final/grad_norm 0.16879
[rank0]:wandb:               final/max_loss 0.24045
[rank0]:wandb:                    grad_norm 0.16879
[rank0]:wandb: loss_metrics/global_avg_loss 0.24045
[rank0]:wandb: loss_metrics/global_max_loss 0.24045
[rank0]:wandb:                          +14 ...
[rank0]:wandb: 
[rank0]:wandb: ðŸš€ View run 1224_ZBVZeroBubble_auto_42_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/novfbfhg
[rank0]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank0]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank0]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1224_ZBVZeroBubble_auto_42_dm1/20251225-1218/wandb/run-20251225_121804-novfbfhg/logs
[rank0]:Traceback (most recent call last):
[rank0]:  File "<frozen runpy>", line 198, in _run_module_as_main
[rank0]:  File "<frozen runpy>", line 88, in _run_code
[rank0]:  File "/home/shcho/torchtitan/timelyfreeze/train.py", line 789, in <module>
[rank0]:    trainer.train()
[rank0]:  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
[rank0]:    return f(*args, **kwargs)
[rank0]:           ^^^^^^^^^^^^^^^^^^
[rank0]:  File "/home/shcho/torchtitan/timelyfreeze/train.py", line 621, in train
[rank0]:    draw_charts(self.freezer, self.step, job_config)
[rank0]:  File "/home/shcho/torchtitan/timelyfreeze/train.py", line 712, in draw_charts
[rank0]:    draw_elementwise_histogram(data=list(freezer.paramwise_frozen_count[s].values()), stage=s,
[rank0]:  File "/home/shcho/torchtitan/timelyfreeze/core/util.py", line 335, in draw_elementwise_histogram
[rank0]:    ax1.text(max(min(80, past_ratio - 5), 5), 0, total_count_text, ha="center", va="center", fontsize=fontsize, color="black")
[rank0]:                     ^^
[rank0]:UnboundLocalError: cannot access local variable 'past_ratio' where it is not associated with a value
[rank0]:[rank0]: Traceback (most recent call last):
[rank0]:[rank0]:   File "<frozen runpy>", line 198, in _run_module_as_main
[rank0]:[rank0]:   File "<frozen runpy>", line 88, in _run_code
[rank0]:[rank0]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 789, in <module>
[rank0]:[rank0]:     trainer.train()
[rank0]:[rank0]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
[rank0]:[rank0]:     return f(*args, **kwargs)
[rank0]:[rank0]:            ^^^^^^^^^^^^^^^^^^
[rank0]:[rank0]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 621, in train
[rank0]:[rank0]:     draw_charts(self.freezer, self.step, job_config)
[rank0]:[rank0]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 712, in draw_charts
[rank0]:[rank0]:     draw_elementwise_histogram(data=list(freezer.paramwise_frozen_count[s].values()), stage=s,
[rank0]:[rank0]:   File "/home/shcho/torchtitan/timelyfreeze/core/util.py", line 335, in draw_elementwise_histogram
[rank0]:[rank0]:     ax1.text(max(min(80, past_ratio - 5), 5), 0, total_count_text, ha="center", va="center", fontsize=fontsize, color="black")
[rank0]:[rank0]:                      ^^
[rank0]:[rank0]: UnboundLocalError: cannot access local variable 'past_ratio' where it is not associated with a value
W1225 13:16:09.912000 1050684 site-packages/torch/distributed/elastic/multiprocessing/api.py:940] Sending process 1050707 closing signal SIGTERM
W1225 13:16:09.913000 1050684 site-packages/torch/distributed/elastic/multiprocessing/api.py:940] Sending process 1050708 closing signal SIGTERM
W1225 13:16:09.914000 1050684 site-packages/torch/distributed/elastic/multiprocessing/api.py:940] Sending process 1050710 closing signal SIGTERM
[rank0]:[rank0]:[W1225 13:16:09.372522846 ProcessGroupNCCL.cpp:1552] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
E1225 13:16:10.747000 1050684 site-packages/torch/distributed/elastic/multiprocessing/api.py:914] failed (exitcode: 1) local_rank: 2 (pid: 1050709) of binary: /data2/shcho/miniforge3/envs/llm_eval/bin/python3.11
E1225 13:16:10.768000 1050684 site-packages/torch/distributed/elastic/multiprocessing/errors/error_handler.py:141] no error file defined for parent, to copy child error file (/tmp/torchelastic_xyutcutk/704270a0-f4f0-4c02-a816-9acf10066d3a_6ujhh3xn/attempt_0/2/error.json)
[rank3]:Stage 3: Modules to keep: {'layers.7', 'layers.8'}
[rank3]:Stage 4: Modules to keep: {'layers.9', 'layers.10'}
[rank2]:Stage 2: Modules to keep: {'layers.5', 'layers.6'}
[rank2]:Stage 5: Modules to keep: {'layers.11', 'layers.12'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1224.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1224_ZBVZeroBubble_auto_42_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1224_ZBVZeroBubble_auto_42_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1224_ZBVZeroBubble_auto_42_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1224_ZBVZeroBubble_auto_42_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_auto_42_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1224_ZBVZeroBubble_auto_42_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 42
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: ZBVZeroBubble
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 4
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 2
[rank3]:		- stages_list: [3, 4]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1224_ZBVZeroBubble_auto_42_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1224_ZBVZeroBubble_auto_42_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: auto
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.01
[rank3]:		- percentile: 80
[rank3]:
[rank1]:Stage 1: Modules to keep: {'layers.3', 'layers.2', 'layers.4'}
[rank1]:Stage 6: Modules to keep: {'layers.13', 'layers.14'}
[rank0]:Stage 0: Modules to keep: {'layers.1', 'tok_embeddings', 'layers.0'}
[rank0]:Stage 7: Modules to keep: {'layers.15', 'output', 'norm'}
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
Traceback (most recent call last):
  File "/data2/shcho/miniforge3/envs/llm_eval/bin/torchrun", line 7, in <module>
    sys.exit(main())
             ^^^^^^
  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/run.py", line 946, in main
    run(args)
  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/run.py", line 937, in run
    elastic_launch(
  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 159, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 300, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
timelyfreeze.train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2025-12-25_13:16:07
  host      : elga.kaist.ac.kr
  rank      : 0 (local_rank: 0)
  exitcode  : -15 (pid: 1050707)
  error_file: /tmp/torchelastic_xyutcutk/704270a0-f4f0-4c02-a816-9acf10066d3a_6ujhh3xn/attempt_0/0/error.json
  traceback : Traceback (most recent call last):
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
      return f(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^
    File "/home/shcho/torchtitan/timelyfreeze/train.py", line 621, in train
      draw_charts(self.freezer, self.step, job_config)
    File "/home/shcho/torchtitan/timelyfreeze/train.py", line 712, in draw_charts
      draw_elementwise_histogram(data=list(freezer.paramwise_frozen_count[s].values()), stage=s,
    File "/home/shcho/torchtitan/timelyfreeze/core/util.py", line 335, in draw_elementwise_histogram
      ax1.text(max(min(80, past_ratio - 5), 5), 0, total_count_text, ha="center", va="center", fontsize=fontsize, color="black")
                       ^^
  UnboundLocalError: cannot access local variable 'past_ratio' where it is not associated with a value
  
[2]:
  time      : 2025-12-25_13:16:07
  host      : elga.kaist.ac.kr
  rank      : 1 (local_rank: 1)
  exitcode  : 1 (pid: 1050708)
  error_file: /tmp/torchelastic_xyutcutk/704270a0-f4f0-4c02-a816-9acf10066d3a_6ujhh3xn/attempt_0/1/error.json
  traceback : Traceback (most recent call last):
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
      return f(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^
    File "/home/shcho/torchtitan/timelyfreeze/train.py", line 621, in train
      draw_charts(self.freezer, self.step, job_config)
    File "/home/shcho/torchtitan/timelyfreeze/train.py", line 712, in draw_charts
      draw_elementwise_histogram(data=list(freezer.paramwise_frozen_count[s].values()), stage=s,
    File "/home/shcho/torchtitan/timelyfreeze/core/util.py", line 335, in draw_elementwise_histogram
      ax1.text(max(min(80, past_ratio - 5), 5), 0, total_count_text, ha="center", va="center", fontsize=fontsize, color="black")
                       ^^
  UnboundLocalError: cannot access local variable 'past_ratio' where it is not associated with a value
  
[3]:
  time      : 2025-12-25_13:16:08
  host      : elga.kaist.ac.kr
  rank      : 3 (local_rank: 3)
  exitcode  : 1 (pid: 1050710)
  error_file: /tmp/torchelastic_xyutcutk/704270a0-f4f0-4c02-a816-9acf10066d3a_6ujhh3xn/attempt_0/3/error.json
  traceback : Traceback (most recent call last):
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
      return f(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^
    File "/home/shcho/torchtitan/timelyfreeze/train.py", line 621, in train
      draw_charts(self.freezer, self.step, job_config)
    File "/home/shcho/torchtitan/timelyfreeze/train.py", line 688, in draw_charts
      pipeline_schedule = schedule_pipeline(pipeline_schedule,
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    File "/home/shcho/torchtitan/timelyfreeze/core/schedule.py", line 414, in schedule_pipeline
      assert fwd_time is None or len(fwd_time) == num_stages, f"fwd_time should have the same length as num_stages. fwd_time: {len(fwd_time)}, num_stages: {num_stages}"
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  AssertionError: fwd_time should have the same length as num_stages. fwd_time: 4, num_stages: 8
  
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2025-12-25_13:16:07
  host      : elga.kaist.ac.kr
  rank      : 2 (local_rank: 2)
  exitcode  : 1 (pid: 1050709)
  error_file: /tmp/torchelastic_xyutcutk/704270a0-f4f0-4c02-a816-9acf10066d3a_6ujhh3xn/attempt_0/2/error.json
  traceback : Traceback (most recent call last):
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
      return f(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^
    File "/home/shcho/torchtitan/timelyfreeze/train.py", line 621, in train
      draw_charts(self.freezer, self.step, job_config)
    File "/home/shcho/torchtitan/timelyfreeze/train.py", line 712, in draw_charts
      draw_elementwise_histogram(data=list(freezer.paramwise_frozen_count[s].values()), stage=s,
    File "/home/shcho/torchtitan/timelyfreeze/core/util.py", line 335, in draw_elementwise_histogram
      ax1.text(max(min(80, past_ratio - 5), 5), 0, total_count_text, ha="center", va="center", fontsize=fontsize, color="black")
                       ^^
  UnboundLocalError: cannot access local variable 'past_ratio' where it is not associated with a value
  
============================================================
