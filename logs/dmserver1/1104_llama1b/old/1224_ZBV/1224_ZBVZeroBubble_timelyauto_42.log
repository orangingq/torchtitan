
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 12. 25. (ëª©) 09:39:02 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 1,2,3,4
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/1224_ZBVZeroBubble_timelyauto_42.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug

âœ”ï¸Running with timelyauto x ZBVZeroBubble ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1224.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=timelyauto --freezing.threshold=0.01 --freezing.percentile=80 --freezing.max_freeze_ratio=0.8
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank0]:2025-12-25 09:39:09,330 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank0]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank0]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank0]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank0]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank1]:2025-12-25 09:39:09,331 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank1]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank0]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank0]:"
[rank1]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank1]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank1]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank1]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank1]:"
[rank2]:2025-12-25 09:39:09,453 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank2]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank2]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank2]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank2]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank2]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank2]:"
[rank3]:2025-12-25 09:39:09,503 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:"
[rank1]:2025-12-25 09:39:09,757 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-12-25 09:39:09,759 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-25 09:39:09,769 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-12-25 09:39:09,771 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-25 09:39:09,774 - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-12-25 09:39:09,775 - Loading tokenizer from tokenizer.json
[rank3]:2025-12-25 09:39:09,930 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-12-25 09:39:09,933 - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-12-25 09:39:09,915 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-12-25 09:39:09,917 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-25 09:39:10,169 - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank3]:2025-12-25 09:39:13,362 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-12-25 09:39:13,344 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-12-25 09:39:13,404 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-25 09:39:13,432 - PP rank 3 is building stage_idx 3 with modules ['layers.7', 'layers.8']
[rank3]:2025-12-25 09:39:13,445 - PP rank 3 is building stage_idx 4 with modules ['layers.9', 'layers.10']
[rank3]:2025-12-25 09:39:13,447 - Using pipeline schedule ZBVZeroBubble with 8 microbatches and 8 stages.
[rank2]:2025-12-25 09:39:13,413 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-12-25 09:39:13,453 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-25 09:39:13,384 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-25 09:39:13,411 - PP rank 1 is building stage_idx 1 with modules ['layers.2', 'layers.3', 'layers.4']
[rank1]:2025-12-25 09:39:13,423 - PP rank 1 is building stage_idx 6 with modules ['layers.13', 'layers.14']
[rank1]:2025-12-25 09:39:13,425 - Using pipeline schedule ZBVZeroBubble with 8 microbatches and 8 stages.
[rank2]:2025-12-25 09:39:13,482 - PP rank 2 is building stage_idx 2 with modules ['layers.5', 'layers.6']
[rank2]:2025-12-25 09:39:13,495 - PP rank 2 is building stage_idx 5 with modules ['layers.11', 'layers.12']
[rank2]:2025-12-25 09:39:13,497 - Using pipeline schedule ZBVZeroBubble with 8 microbatches and 8 stages.
[rank3]:2025-12-25 09:39:13,638 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-25 09:39:13,638 - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-12-25 09:39:13,639 - CUDA memory usage for model: 0.92GiB(1.94%)
[rank1]:2025-12-25 09:39:13,608 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-25 09:39:13,608 - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-12-25 09:39:13,609 - CUDA memory usage for model: 1.13GiB(2.39%)
[rank2]:2025-12-25 09:39:13,696 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-25 09:39:13,696 - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-12-25 09:39:13,697 - CUDA memory usage for model: 0.92GiB(1.94%)
[rank0]:2025-12-25 09:39:13,753 - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank0]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank0]:wandb: setting up run fvc8ead0
[rank0]:wandb: Tracking run with wandb version 0.22.2
[rank0]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1224_ZBVZeroBubble_timelyauto_42_dm1/20251225-0939/wandb/run-20251225_093914-fvc8ead0
[rank0]:wandb: Run `wandb offline` to turn off syncing.
[rank0]:wandb: Syncing run 1224_ZBVZeroBubble_timelyauto_42_dm1
[rank0]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank0]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/fvc8ead0
[rank0]:2025-12-25 09:39:16,226 - WandB logging enabled
[rank0]:2025-12-25 09:39:16,227 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-12-25 09:39:16,267 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-25 09:39:16,269 - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-12-25 09:39:16,297 - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1']
[rank0]:2025-12-25 09:39:16,311 - PP rank 0 is building stage_idx 7 with modules ['layers.15', 'norm', 'output']
[rank0]:2025-12-25 09:39:16,313 - Using pipeline schedule ZBVZeroBubble with 8 microbatches and 8 stages.
[rank2]:2025-12-25 09:39:16,530 - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-12-25 09:39:16,530 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-25 09:39:16,510 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-25 09:39:16,511 - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-12-25 09:39:16,512 - CUDA memory usage for model: 2.64GiB(5.55%)
[rank0]:2025-12-25 09:39:16,530 - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1224_ZBVZeroBubble_timelyauto_42_dm1
[rank0]:2025-12-25 09:39:16,530 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-25 09:39:16,531 - Trainer is initialized with local batch size 32, global batch size 128, gradient accumulation steps 4, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2025-12-25 09:39:16,532 - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank1]:2025-12-25 09:39:16,530 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-25 09:39:19,775 - [GC] GC collection for checkpoint loading. 0.03 seconds
[rank0]:2025-12-25 09:39:19,775 - Finished loading the checkpoint in 3.24 seconds.
[rank0]:2025-12-25 09:39:19,776 - Training starts at step 1
[rank2]:2025-12-25 09:39:24,811 -  step:  1  loss: -4.0000  grad_norm: 203.0660  memory: 11.98GiB(25.23%)  tps: 2,885  tflops: 22.56  mfu: 7.23%
[rank2]:2025-12-25 09:39:24,811 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-12-25 09:39:24,811 -  step:  1  loss: -4.0000  grad_norm: 203.0660  memory: 13.43GiB(28.27%)  tps: 2,873  tflops: 22.46  mfu: 7.20%
[rank3]:2025-12-25 09:39:24,811 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-25 09:39:24,858 -  step:  1  loss: 10.6092  grad_norm: 203.0660  memory: 30.01GiB(63.17%)  tps: 3,815  tflops: 29.82  mfu: 9.56%
[rank0]:2025-12-25 09:39:24,858 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-12-25 09:39:24,825 -  step:  1  loss: -4.0000  grad_norm: 203.0660  memory: 15.54GiB(32.72%)  tps: 2,864  tflops: 22.39  mfu: 7.18%
[rank1]:2025-12-25 09:39:24,826 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-25 09:43:05,871 - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-12-25 09:43:10,653 - Avg. fwd time: 8.1610 / Avg. bwd-weight time: 10.0249 / Avg. bwd-input time: 10.0154 / Avg. batch time: 1053.3607 (ms) / GPU bubble ratio: 57.16%
[rank3]:2025-12-25 09:43:10,660 - Avg. fwd time: 7.7944 / Avg. bwd-weight time: 9.8288 / Avg. bwd-input time: 9.6216 / Avg. batch time: 1049.7906 (ms) / GPU bubble ratio: 58.48%
[rank0]:2025-12-25 09:43:10,680 - Avg. fwd time: 13.5892 / Avg. full-bwd time: 28.9157 (Avg. bwd-weight time: 29.8845 / Avg. bwd-input time: 34.4326) / Avg. batch time: 1110.6884 (ms) / GPU bubble ratio: 13.27%
[rank1]:2025-12-25 09:43:10,672 - Avg. fwd time: 9.8482 / Avg. bwd-weight time: 12.9142 / Avg. bwd-input time: 12.2029 / Avg. batch time: 1088.6414 (ms) / GPU bubble ratio: 48.61%
[rank1]:2025-12-25 09:43:10,730 -  step: 50  loss: -4.0000  grad_norm: 23.9665  memory: 17.85GiB(37.57%)  tps: 7,108  tflops: 55.56  mfu: 17.81%
[rank2]:2025-12-25 09:43:10,726 -  step: 50  loss: -4.0000  grad_norm: 23.9665  memory: 13.80GiB(29.05%)  tps: 7,107  tflops: 55.56  mfu: 17.81%
[rank3]:2025-12-25 09:43:10,726 -  step: 50  loss: -4.0000  grad_norm: 23.9665  memory: 15.27GiB(32.13%)  tps: 7,107  tflops: 55.56  mfu: 17.81%
[rank0]:2025-12-25 09:43:10,753 -  step: 50  loss:  9.8852  grad_norm: 23.9665  memory: 35.32GiB(74.36%)  tps: 7,108  tflops: 55.57  mfu: 17.81%
[rank3]:2025-12-25 09:43:52,506 - [Step 60] ã€°ï¸ Monitoring Upperbound
[rank0]:2025-12-25 09:44:38,701 - [Step 70] â³ Monitoring Upperbound... (276/286)
[rank2]:2025-12-25 09:44:38,892 - [Step 70] â³ Monitoring Upperbound... (276/286)
[rank3]:2025-12-25 09:44:38,900 - [Step 70] â³ Monitoring Upperbound... (276/286)
[rank1]:2025-12-25 09:44:38,914 - [Step 70] â³ Monitoring Upperbound... (276/286)
[rank3]:2025-12-25 09:45:25,431 - [Step 80] âœ”ï¸  Setting Upperbound
[rank3]:2025-12-25 09:45:25,543 - [Step 80] ã€°ï¸ Monitoring Lowerbound
[rank3]:2025-12-25 09:46:29,119 - [Step 100] âœ”ï¸  Setting Lowerbound
[rank0]:2025-12-25 09:46:29,174 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-25 09:46:29,210 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB0] 1.00/1.00, [MB4] 1.00/1.00, [MB1] 1.00/1.00, [MB5] 1.00/1.00, [MB2] 1.00/1.00, [MB6] 1.00/1.00, [MB3] 1.00/1.00, [MB7] 0.40/0.40, [MB4] 0.76/0.76, [MB5] 0.34/0.34, [MB6] 0.38/0.38, [MB7] 0.92/0.92
[rank1]:2025-12-25 09:46:29,210 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB0] 1.00/1.00, [MB3] 0.00/0.00, [MB1] 0.55/0.55, [MB4] 0.00/0.00, [MB2] 0.15/0.15, [MB5] 0.00/0.00, [MB3] 0.20/0.20, [MB6] 0.00/0.00, [MB4] 0.67/0.67, [MB5] 0.85/0.85, [MB6] 1.00/1.00, [MB7] 0.80/0.80, [MB7] 1.00/1.00
[rank2]:2025-12-25 09:46:29,210 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB0] 0.00/0.00, [MB2] 0.00/0.00, [MB1] 0.00/0.00, [MB3] 0.00/0.00, [MB2] 0.00/0.00, [MB4] 0.00/0.00, [MB3] 0.00/0.00, [MB5] 0.00/0.00, [MB4] 0.32/0.32, [MB5] 1.00/1.00, [MB6] 0.00/0.00, [MB7] 0.21/0.21, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-12-25 09:46:29,525 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/pipeline_schedule/251225_0946_max_batch_time.svg
[rank3]:			> Batch Time: 991.05 ms, GPU Bubble Ratio: 1.36%, 43.26%, 54.26%, 55.83%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-8-34ms      | [S0,MB4,F]  34-8-42ms      | [S0,MB5,F]  42-9-52ms      | [S0,MB6,F]  52-9-61ms      | [S7,MB0,F]  75-17-92ms     | [S7,MB0,BI] 92-32-125ms    | [S7,MB0,BW] 125-26-151ms   | [S7,MB1,F]  151-17-168ms   | [S7,MB1,BI] 168-35-203ms   | [S7,MB1,BW] 203-30-234ms   | [S7,MB2,F]  234-19-253ms   | [S7,MB2,BI] 253-35-288ms   | [S7,MB2,BW] 288-31-320ms   | [S7,MB3,F]  320-19-339ms   | [S7,MB3,BI] 339-34-374ms   | [S7,MB3,BW] 374-32-406ms   | [S0,MB7,F]  406-10-416ms   | [S0,MB0,B]  416-30-447ms   | [S7,MB4,F]  447-19-466ms   | [S7,MB4,BI] 466-34-501ms   | [S7,MB4,BW] 501-31-533ms   | [S0,MB1,B]  533-30-563ms   | [S7,MB5,F]  563-18-582ms   | [S7,MB5,BI] 582-34-616ms   | [S7,MB5,BW] 616-30-647ms   | [S0,MB2,B]  647-29-677ms   | [S7,MB6,F]  677-18-696ms   | [S7,MB6,BI] 696-34-730ms   | [S7,MB6,BW] 730-30-761ms   | [S0,MB3,B]  761-29-791ms   | [S7,MB7,F]  791-18-810ms   | [S7,MB7,BI] 810-34-845ms   | [S7,MB7,BW] 845-30-875ms   | [S0,MB4,B]  875-29-905ms   | [S0,MB5,B]  905-29-934ms   | [S0,MB6,B]  934-28-963ms   | [S0,MB7,B]  963-28-991ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-21ms      | [S1,MB1,F]  21-10-32ms     | [S1,MB2,F]  32-10-42ms     | [S1,MB3,F]  42-10-53ms     | [S1,MB4,F]  53-10-64ms     | [S6,MB0,F]  64-10-75ms     | [S1,MB5,F]  75-13-88ms     | [S6,MB1,F]  88-8-97ms      | [S6,MB0,BI] 125-9-134ms    | [S6,MB0,BW] 134-10-144ms   | [S6,MB2,F]  144-7-152ms    | [S6,MB1,BI] 203-9-213ms    | [S6,MB1,BW] 213-10-223ms   | [S6,MB3,F]  223-7-230ms    | [S6,MB2,BI] 288-9-297ms    | [S6,MB2,BW] 297-10-308ms   | [S1,MB6,F]  308-10-319ms   | [S1,MB0,BI] 319-15-335ms   | [S1,MB0,BW] 335-15-350ms   | [S6,MB4,F]  350-8-358ms    | [S6,MB3,BI] 374-10-385ms   | [S6,MB3,BW] 385-9-394ms    | [S1,MB7,F]  416-13-430ms   | [S1,MB1,BI] 430-15-446ms   | [S1,MB1,BW] 446-14-460ms   | [S6,MB5,F]  460-7-468ms    | [S6,MB4,BI] 501-10-511ms   | [S6,MB4,BW] 511-9-521ms    | [S1,MB2,BI] 521-14-535ms   | [S1,MB2,BW] 535-14-549ms   | [S6,MB6,F]  549-7-556ms    | [S6,MB5,BI] 616-9-626ms    | [S6,MB5,BW] 626-10-637ms   | [S1,MB3,BI] 637-14-651ms   | [S1,MB3,BW] 651-14-666ms   | [S6,MB7,F]  666-7-673ms    | [S6,MB6,BI] 730-9-740ms    | [S6,MB6,BW] 740-11-751ms   | [S1,MB4,BI] 751-14-766ms   | [S6,MB7,BI] 845-10-855ms   | [S1,MB5,BI] 855-15-870ms   | [S1,MB4,BW] 870-16-886ms   | [S1,MB6,BI] 886-14-900ms   | [S1,MB5,BW] 900-15-916ms   | [S1,MB7,BI] 916-15-931ms   | [S1,MB6,BW] 931-16-948ms   | [S6,MB7,BW] 948-11-959ms   | [S1,MB7,BW] 959-16-976ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-8-29ms      | [S2,MB1,F]  32-7-39ms      | [S2,MB2,F]  42-7-50ms      | [S5,MB0,F]  50-9-59ms      | [S2,MB3,F]  59-9-69ms      | [S5,MB1,F]  69-7-76ms      | [S2,MB4,F]  76-10-86ms     | [S5,MB2,F]  86-8-95ms      | [S5,MB0,BI] 134-9-143ms    | [S5,MB0,BW] 143-10-154ms   | [S5,MB3,F]  154-7-161ms    | [S5,MB1,BI] 213-9-222ms    | [S5,MB1,BW] 222-10-233ms   | [S2,MB5,F]  233-7-240ms    | [S2,MB0,BI] 240-10-251ms   | [S2,MB0,BW] 251-9-260ms    | [S5,MB4,F]  260-7-268ms    | [S5,MB2,BI] 297-10-308ms   | [S5,MB2,BW] 308-9-318ms    | [S2,MB6,F]  319-9-329ms    | [S2,MB1,BI] 329-10-340ms   | [S2,MB1,BW] 340-9-349ms    | [S5,MB5,F]  349-7-357ms    | [S5,MB3,BI] 385-11-396ms   | [S5,MB3,BW] 396-11-407ms   | [S2,MB7,F]  430-7-437ms    | [S2,MB2,BI] 437-10-448ms   | [S2,MB2,BW] 448-9-458ms    | [S5,MB6,F]  458-7-465ms    | [S5,MB4,BI] 511-10-521ms   | [S5,MB4,BW] 521-9-531ms    | [S2,MB3,BI] 531-9-541ms    | [S2,MB3,BW] 541-10-551ms   | [S5,MB7,F]  551-7-558ms    | [S5,MB5,BI] 626-9-635ms    | [S5,MB5,BW] 635-9-645ms    | [S2,MB4,BI] 645-9-655ms    | [S5,MB6,BI] 740-10-750ms   | [S2,MB5,BI] 750-10-761ms   | [S5,MB7,BI] 855-9-864ms    | [S2,MB6,BI] 864-11-875ms   | [S2,MB4,BW] 875-10-886ms   | [S2,MB7,BI] 886-9-895ms    | [S2,MB5,BW] 895-10-906ms   | [S5,MB6,BW] 906-9-915ms    | [S5,MB7,BW] 915-9-925ms    | [S2,MB6,BW] 925-9-935ms    | [S2,MB7,BW] 935-10-945ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-8-37ms      | [S4,MB0,F]  37-8-45ms      | [S3,MB1,F]  45-8-54ms      | [S4,MB1,F]  54-7-61ms      | [S3,MB2,F]  61-7-68ms      | [S4,MB2,F]  68-7-76ms      | [S3,MB3,F]  76-7-84ms      | [S4,MB3,F]  84-8-92ms      | [S4,MB0,BI] 143-9-152ms    | [S4,MB0,BW] 152-9-162ms    AFR(10):1.0000 | [S3,MB4,F]  162-7-169ms    | [S3,MB0,BI] 169-9-178ms    | [S3,MB0,BW] 178-9-188ms    AFR(10):0.9444 | [S4,MB4,F]  188-7-196ms    | [S4,MB1,BI] 222-10-232ms   | [S4,MB1,BW] 232-10-242ms   AFR(10):1.0000 | [S3,MB5,F]  242-8-251ms    | [S3,MB1,BI] 251-9-260ms    | [S3,MB1,BW] 260-9-270ms    AFR(10):0.9444 | [S4,MB5,F]  270-7-278ms    | [S4,MB2,BI] 308-11-319ms   | [S4,MB2,BW] 319-9-329ms    AFR(10):1.0000 | [S3,MB6,F]  329-7-336ms    | [S3,MB2,BI] 336-9-346ms    | [S3,MB2,BW] 346-9-355ms    AFR(10):0.9444 | [S4,MB6,F]  355-7-363ms    | [S4,MB3,BI] 396-10-406ms   | [S4,MB3,BW] 406-10-416ms   AFR(10):1.0000 | [S3,MB7,F]  437-7-445ms    | [S3,MB3,BI] 445-9-454ms    | [S3,MB3,BW] 454-9-464ms    AFR(10):0.9444 | [S4,MB7,F]  464-7-472ms    | [S4,MB4,BI] 521-10-532ms   | [S4,MB4,BW] 532-9-542ms    AFR(10):1.0000 | [S3,MB4,BI] 542-10-552ms   | [S4,MB5,BI] 635-10-645ms   | [S3,MB5,BI] 645-9-655ms    | [S4,MB6,BI] 750-9-760ms    | [S3,MB6,BI] 760-9-769ms    | [S4,MB7,BI] 864-9-873ms    | [S3,MB7,BI] 873-9-882ms    | [S3,MB4,BW] 882-10-893ms   AFR(10):0.9444 | [S4,MB5,BW] 893-9-902ms    AFR(10):1.0000 | [S4,MB6,BW] 902-9-912ms    AFR(10):1.0000 | [S4,MB7,BW] 912-9-921ms    AFR(10):1.0000 | [S3,MB5,BW] 921-10-932ms   AFR(10):0.9444 | [S3,MB6,BW] 932-10-942ms   AFR(10):0.9444 | [S3,MB7,BW] 942-10-953ms   AFR(10):0.9444
[rank3]:2025-12-25 09:46:29,799 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/pipeline_schedule/251225_0946_min_batch_time.svg
[rank3]:			> Batch Time: 573.32 ms, GPU Bubble Ratio: 13.25%, 38.32%, 49.17%, 50.48%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-8-34ms      | [S0,MB4,F]  34-8-42ms      | [S0,MB5,F]  42-9-52ms      | [S0,MB6,F]  52-9-61ms      | [S7,MB0,F]  75-17-92ms     | [S7,MB0,BI] 92-32-125ms    | [S7,MB0,BW] 125-0-125ms    | [S7,MB1,F]  125-17-142ms   | [S7,MB1,BI] 142-35-177ms   | [S7,MB1,BW] 177-0-177ms    | [S7,MB2,F]  177-19-196ms   | [S7,MB2,BI] 196-35-231ms   | [S7,MB2,BW] 231-0-231ms    | [S7,MB3,F]  231-19-251ms   | [S7,MB3,BI] 251-34-286ms   | [S7,MB3,BW] 286-0-286ms    | [S0,MB7,F]  286-10-296ms   | [S0,MB0,B]  296-0-296ms    | [S7,MB4,F]  296-19-315ms   | [S7,MB4,BI] 315-34-350ms   | [S7,MB4,BW] 350-0-350ms    | [S0,MB1,B]  350-0-350ms    | [S7,MB5,F]  350-18-369ms   | [S7,MB5,BI] 369-34-403ms   | [S7,MB5,BW] 403-0-403ms    | [S0,MB2,B]  403-0-403ms    | [S7,MB6,F]  403-18-422ms   | [S7,MB6,BI] 422-34-457ms   | [S7,MB6,BW] 457-0-457ms    | [S0,MB3,B]  457-0-457ms    | [S7,MB7,F]  457-18-476ms   | [S7,MB7,BI] 476-34-510ms   | [S7,MB7,BW] 510-0-510ms    | [S0,MB4,B]  510-0-510ms    | [S0,MB5,B]  536-0-536ms    | [S0,MB6,B]  555-0-555ms    | [S0,MB7,B]  573-0-573ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-21ms      | [S1,MB1,F]  21-10-32ms     | [S1,MB2,F]  32-10-42ms     | [S1,MB3,F]  42-10-53ms     | [S1,MB4,F]  53-10-64ms     | [S6,MB0,F]  64-10-75ms     | [S1,MB5,F]  75-13-88ms     | [S6,MB1,F]  88-8-97ms      | [S6,MB0,BI] 125-9-134ms    | [S6,MB0,BW] 134-0-134ms    | [S6,MB2,F]  134-7-141ms    | [S6,MB1,BI] 177-9-186ms    | [S6,MB1,BW] 186-0-186ms    | [S6,MB3,F]  186-7-193ms    | [S6,MB2,BI] 231-9-240ms    | [S6,MB2,BW] 240-0-240ms    | [S1,MB6,F]  240-10-251ms   | [S1,MB0,BI] 251-15-267ms   | [S1,MB0,BW] 267-0-267ms    | [S6,MB4,F]  267-8-275ms    | [S6,MB3,BI] 286-10-296ms   | [S6,MB3,BW] 296-0-296ms    | [S1,MB7,F]  296-13-310ms   | [S1,MB1,BI] 310-15-325ms   | [S1,MB1,BW] 325-0-325ms    | [S6,MB5,F]  325-7-333ms    | [S6,MB4,BI] 350-10-360ms   | [S6,MB4,BW] 360-0-360ms    | [S1,MB2,BI] 360-14-374ms   | [S1,MB2,BW] 374-0-374ms    | [S6,MB6,F]  374-7-381ms    | [S6,MB5,BI] 403-9-413ms    | [S6,MB5,BW] 413-0-413ms    | [S1,MB3,BI] 413-14-427ms   | [S1,MB3,BW] 427-0-427ms    | [S6,MB7,F]  427-7-434ms    | [S6,MB6,BI] 457-9-466ms    | [S6,MB6,BW] 466-0-466ms    | [S1,MB4,BI] 466-14-481ms   | [S6,MB7,BI] 510-10-521ms   | [S1,MB5,BI] 521-15-536ms   | [S1,MB4,BW] 536-0-536ms    | [S1,MB6,BI] 541-14-555ms   | [S1,MB5,BW] 555-0-555ms    | [S1,MB7,BI] 558-15-573ms   | [S1,MB6,BW] 573-0-573ms    | [S6,MB7,BW] 573-0-573ms    | [S1,MB7,BW] 573-0-573ms   
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-8-29ms      | [S2,MB1,F]  32-7-39ms      | [S2,MB2,F]  42-7-50ms      | [S5,MB0,F]  50-9-59ms      | [S2,MB3,F]  59-9-69ms      | [S5,MB1,F]  69-7-76ms      | [S2,MB4,F]  76-10-86ms     | [S5,MB2,F]  86-8-95ms      | [S5,MB0,BI] 134-9-143ms    | [S5,MB0,BW] 143-0-143ms    | [S5,MB3,F]  143-7-151ms    | [S5,MB1,BI] 186-9-195ms    | [S5,MB1,BW] 195-0-195ms    | [S2,MB5,F]  195-7-203ms    | [S2,MB0,BI] 203-10-213ms   | [S2,MB0,BW] 213-0-213ms    | [S5,MB4,F]  213-7-221ms    | [S5,MB2,BI] 240-10-251ms   | [S5,MB2,BW] 251-0-251ms    | [S2,MB6,F]  251-9-261ms    | [S2,MB1,BI] 261-10-272ms   | [S2,MB1,BW] 272-0-272ms    | [S5,MB5,F]  272-7-279ms    | [S5,MB3,BI] 296-11-307ms   | [S5,MB3,BW] 307-0-307ms    | [S2,MB7,F]  310-7-317ms    | [S2,MB2,BI] 317-10-328ms   | [S2,MB2,BW] 328-0-328ms    | [S5,MB6,F]  328-7-335ms    | [S5,MB4,BI] 360-10-371ms   | [S5,MB4,BW] 371-0-371ms    | [S2,MB3,BI] 371-9-380ms    | [S2,MB3,BW] 380-0-380ms    | [S5,MB7,F]  380-7-387ms    | [S5,MB5,BI] 413-9-422ms    | [S5,MB5,BW] 422-0-422ms    | [S2,MB4,BI] 422-9-432ms    | [S5,MB6,BI] 466-10-477ms   | [S2,MB5,BI] 477-10-487ms   | [S5,MB7,BI] 521-9-530ms    | [S2,MB6,BI] 530-11-541ms   | [S2,MB4,BW] 541-0-541ms    | [S2,MB7,BI] 548-9-558ms    | [S2,MB5,BW] 558-0-558ms    | [S5,MB6,BW] 558-0-558ms    | [S5,MB7,BW] 558-0-558ms    | [S2,MB6,BW] 558-0-558ms    | [S2,MB7,BW] 558-0-558ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-8-37ms      | [S4,MB0,F]  37-8-45ms      | [S3,MB1,F]  45-8-54ms      | [S4,MB1,F]  54-7-61ms      | [S3,MB2,F]  61-7-68ms      | [S4,MB2,F]  68-7-76ms      | [S3,MB3,F]  76-7-84ms      | [S4,MB3,F]  84-8-92ms      | [S4,MB0,BI] 143-9-152ms    | [S4,MB0,BW] 152-0-152ms    AFR(10):1.0000 | [S3,MB4,F]  152-7-159ms    | [S3,MB0,BI] 159-9-169ms    | [S3,MB0,BW] 169-0-169ms    AFR(10):0.9444 | [S4,MB4,F]  169-7-177ms    | [S4,MB1,BI] 195-10-206ms   | [S4,MB1,BW] 206-0-206ms    AFR(10):1.0000 | [S3,MB5,F]  206-8-214ms    | [S3,MB1,BI] 214-9-223ms    | [S3,MB1,BW] 223-0-223ms    AFR(10):0.9444 | [S4,MB5,F]  223-7-231ms    | [S4,MB2,BI] 251-11-262ms   | [S4,MB2,BW] 262-0-262ms    AFR(10):1.0000 | [S3,MB6,F]  262-7-269ms    | [S3,MB2,BI] 269-9-278ms    | [S3,MB2,BW] 278-1-279ms    AFR(10):0.9444 | [S4,MB6,F]  279-7-287ms    | [S4,MB3,BI] 307-10-317ms   | [S4,MB3,BW] 317-0-317ms    AFR(10):1.0000 | [S3,MB7,F]  317-7-325ms    | [S3,MB3,BI] 325-9-334ms    | [S3,MB3,BW] 334-0-334ms    AFR(10):0.9444 | [S4,MB7,F]  334-7-342ms    | [S4,MB4,BI] 371-10-381ms   | [S4,MB4,BW] 381-0-381ms    AFR(10):1.0000 | [S3,MB4,BI] 381-10-391ms   | [S4,MB5,BI] 422-10-432ms   | [S3,MB5,BI] 432-9-442ms    | [S4,MB6,BI] 477-9-486ms    | [S3,MB6,BI] 486-9-495ms    | [S4,MB7,BI] 530-9-539ms    | [S3,MB7,BI] 539-9-548ms    | [S3,MB4,BW] 548-0-549ms    AFR(10):0.9444 | [S4,MB5,BW] 549-0-549ms    AFR(10):1.0000 | [S4,MB6,BW] 549-0-549ms    AFR(10):1.0000 | [S4,MB7,BW] 549-0-549ms    AFR(10):1.0000 | [S3,MB5,BW] 549-0-549ms    AFR(10):0.9444 | [S3,MB6,BW] 549-1-550ms    AFR(10):0.9444 | [S3,MB7,BW] 550-1-552ms    AFR(10):0.9444
[rank3]:2025-12-25 09:46:30,121 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/pipeline_schedule/251225_0946_frozen_pipeline_schedule.svg
[rank3]:			> Batch Time: 602.02 ms, GPU Bubble Ratio: 2.24%, 22.39%, 30.64%, 34.47%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-8-34ms      | [S0,MB4,F]  34-8-42ms      | [S0,MB5,F]  42-9-52ms      | [S0,MB6,F]  52-9-61ms      | [S7,MB0,F]  75-17-92ms     | [S7,MB0,BI] 92-32-125ms    | [S7,MB0,BW] 125-26-151ms   | [S7,MB1,F]  151-17-168ms   | [S7,MB1,BI] 168-35-203ms   | [S7,MB1,BW] 203-0-203ms    | [S7,MB2,F]  203-19-223ms   | [S7,MB2,BI] 223-35-258ms   | [S7,MB2,BW] 258-0-258ms    | [S7,MB3,F]  258-19-277ms   | [S7,MB3,BI] 277-34-312ms   | [S7,MB3,BW] 312-0-312ms    | [S0,MB7,F]  312-10-322ms   | [S0,MB0,B]  322-0-322ms    | [S7,MB4,F]  322-19-341ms   | [S7,MB4,BI] 341-34-376ms   | [S7,MB4,BW] 376-0-376ms    | [S0,MB1,B]  376-0-376ms    | [S7,MB5,F]  376-18-395ms   | [S7,MB5,BI] 395-34-430ms   | [S7,MB5,BW] 430-0-430ms    | [S0,MB2,B]  430-0-430ms    | [S7,MB6,F]  430-18-449ms   | [S7,MB6,BI] 449-34-483ms   | [S7,MB6,BW] 483-0-483ms    | [S0,MB3,B]  483-0-483ms    | [S7,MB7,F]  483-18-502ms   | [S7,MB7,BI] 502-34-537ms   | [S7,MB7,BW] 537-18-555ms   | [S0,MB4,B]  555-6-562ms    | [S0,MB5,B]  562-19-582ms   | [S0,MB6,B]  582-17-599ms   | [S0,MB7,B]  599-2-602ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-21ms      | [S1,MB1,F]  21-10-32ms     | [S1,MB2,F]  32-10-42ms     | [S1,MB3,F]  42-10-53ms     | [S1,MB4,F]  53-10-64ms     | [S6,MB0,F]  64-10-75ms     | [S1,MB5,F]  75-13-88ms     | [S6,MB1,F]  88-8-97ms      | [S6,MB0,BI] 125-9-134ms    | [S6,MB0,BW] 134-10-144ms   | [S6,MB2,F]  144-7-152ms    | [S6,MB1,BI] 203-9-213ms    | [S6,MB1,BW] 213-10-223ms   | [S6,MB3,F]  223-7-230ms    | [S6,MB2,BI] 258-9-267ms    | [S6,MB2,BW] 267-10-278ms   | [S1,MB6,F]  278-10-289ms   | [S1,MB0,BI] 289-15-305ms   | [S1,MB0,BW] 305-0-305ms    | [S6,MB4,F]  305-8-313ms    | [S6,MB3,BI] 313-10-323ms   | [S6,MB3,BW] 323-9-333ms    | [S1,MB7,F]  333-13-346ms   | [S1,MB1,BI] 346-15-362ms   | [S1,MB1,BW] 362-6-368ms    | [S6,MB5,F]  368-7-376ms    | [S6,MB4,BI] 376-10-387ms   | [S6,MB4,BW] 387-9-396ms    | [S1,MB2,BI] 396-14-410ms   | [S1,MB2,BW] 410-12-423ms   | [S6,MB6,F]  423-7-430ms    | [S6,MB5,BI] 430-9-439ms    | [S6,MB5,BW] 439-10-450ms   | [S1,MB3,BI] 450-14-465ms   | [S1,MB3,BW] 465-11-476ms   | [S6,MB7,F]  476-7-483ms    | [S6,MB6,BI] 483-9-493ms    | [S6,MB6,BW] 493-11-504ms   | [S1,MB4,BI] 504-14-519ms   | [S6,MB7,BI] 537-10-547ms   | [S1,MB5,BI] 547-15-562ms   | [S1,MB4,BW] 562-5-568ms    | [S1,MB6,BI] 568-14-582ms   | [S1,MB5,BW] 582-2-584ms    | [S1,MB7,BI] 584-15-599ms   | [S1,MB6,BW] 599-0-599ms    | [S6,MB7,BW] 599-2-602ms    | [S1,MB7,BW] 602-0-602ms   
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-8-29ms      | [S2,MB1,F]  32-7-39ms      | [S2,MB2,F]  42-7-50ms      | [S5,MB0,F]  50-9-59ms      | [S2,MB3,F]  59-9-69ms      | [S5,MB1,F]  69-7-76ms      | [S2,MB4,F]  76-10-86ms     | [S5,MB2,F]  86-8-95ms      | [S5,MB0,BI] 134-9-143ms    | [S5,MB0,BW] 143-10-154ms   | [S5,MB3,F]  154-7-161ms    | [S5,MB1,BI] 213-9-222ms    | [S5,MB1,BW] 222-10-233ms   | [S2,MB5,F]  233-7-240ms    | [S2,MB0,BI] 240-10-251ms   | [S2,MB0,BW] 251-9-260ms    | [S5,MB4,F]  260-7-268ms    | [S5,MB2,BI] 268-10-278ms   | [S5,MB2,BW] 278-9-288ms    | [S2,MB6,F]  289-9-299ms    | [S2,MB1,BI] 299-10-309ms   | [S2,MB1,BW] 309-9-319ms    | [S5,MB5,F]  319-7-327ms    | [S5,MB3,BI] 327-11-338ms   | [S5,MB3,BW] 338-11-349ms   | [S2,MB7,F]  349-7-356ms    | [S2,MB2,BI] 356-10-367ms   | [S2,MB2,BW] 367-9-377ms    | [S5,MB6,F]  377-7-384ms    | [S5,MB4,BI] 387-10-397ms   | [S5,MB4,BW] 397-9-407ms    | [S2,MB3,BI] 407-9-416ms    | [S2,MB3,BW] 416-10-427ms   | [S5,MB7,F]  427-7-434ms    | [S5,MB5,BI] 439-9-449ms    | [S5,MB5,BW] 449-9-459ms    | [S2,MB4,BI] 459-9-468ms    | [S5,MB6,BI] 493-10-504ms   | [S2,MB5,BI] 504-10-514ms   | [S5,MB7,BI] 547-9-556ms    | [S2,MB6,BI] 556-11-568ms   | [S2,MB4,BW] 568-7-575ms    | [S2,MB7,BI] 575-9-584ms    | [S2,MB5,BW] 584-0-584ms    | [S5,MB6,BW] 584-9-594ms    | [S5,MB7,BW] 594-7-602ms    | [S2,MB6,BW] 602-0-602ms    | [S2,MB7,BW] 602-0-602ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-8-37ms      | [S4,MB0,F]  37-8-45ms      | [S3,MB1,F]  45-8-54ms      | [S4,MB1,F]  54-7-61ms      | [S3,MB2,F]  61-7-68ms      | [S4,MB2,F]  68-7-76ms      | [S3,MB3,F]  76-7-84ms      | [S4,MB3,F]  84-8-92ms      | [S4,MB0,BI] 143-9-152ms    | [S4,MB0,BW] 152-9-162ms    AFR(10):1.0000 | [S3,MB4,F]  162-7-169ms    | [S3,MB0,BI] 169-9-178ms    | [S3,MB0,BW] 178-9-188ms    AFR(10):0.9444 | [S4,MB4,F]  188-7-196ms    | [S4,MB1,BI] 222-10-232ms   | [S4,MB1,BW] 232-10-242ms   AFR(10):1.0000 | [S3,MB5,F]  242-8-251ms    | [S3,MB1,BI] 251-9-260ms    | [S3,MB1,BW] 260-9-270ms    AFR(10):0.9444 | [S4,MB5,F]  270-7-278ms    | [S4,MB2,BI] 278-11-290ms   | [S4,MB2,BW] 290-9-299ms    AFR(10):1.0000 | [S3,MB6,F]  299-7-307ms    | [S3,MB2,BI] 307-9-316ms    | [S3,MB2,BW] 316-9-326ms    AFR(10):0.9444 | [S4,MB6,F]  326-7-334ms    | [S4,MB3,BI] 338-10-348ms   | [S4,MB3,BW] 348-10-358ms   AFR(10):1.0000 | [S3,MB7,F]  358-7-366ms    | [S3,MB3,BI] 366-9-375ms    | [S3,MB3,BW] 375-9-385ms    AFR(10):0.9444 | [S4,MB7,F]  385-7-392ms    | [S4,MB4,BI] 397-10-408ms   | [S4,MB4,BW] 408-9-417ms    AFR(10):1.0000 | [S3,MB4,BI] 417-10-428ms   | [S4,MB5,BI] 449-10-459ms   | [S3,MB5,BI] 459-9-468ms    | [S4,MB6,BI] 504-9-513ms    | [S3,MB6,BI] 513-9-522ms    | [S4,MB7,BI] 556-9-566ms    | [S3,MB7,BI] 566-9-575ms    | [S3,MB4,BW] 575-0-575ms    AFR(10):0.9444 | [S4,MB5,BW] 575-5-580ms    AFR(10):1.0000 | [S4,MB6,BW] 580-0-580ms    AFR(10):1.0000 | [S4,MB7,BW] 580-0-580ms    AFR(10):1.0000 | [S3,MB5,BW] 580-0-581ms    AFR(10):0.9444 | [S3,MB6,BW] 581-10-591ms   AFR(10):0.9444 | [S3,MB7,BW] 591-10-602ms   AFR(10):0.9444
[rank3]:2025-12-25 09:46:30,121 - 	> Batch Time: 602.02 ms (Average Freeze Ratio: 0.42, Time Reduction Rate: 0.39)
[rank3]:2025-12-25 09:46:30,123 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 0.46/0.46, [MB6] 1.00/1.00, [MB7] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank0]:2025-12-25 09:46:33,388 - Avg. fwd time: 13.4768 / Avg. full-bwd time: 23.0250 (Avg. bwd-weight time: 23.8376 / Avg. bwd-input time: 34.3615) / Avg. batch time: 1044.3733 (ms) / GPU bubble ratio: 17.13%
[rank3]:2025-12-25 09:46:33,379 - Avg. fwd time: 7.7716 / Avg. bwd-weight time: 7.9060 / Avg. bwd-input time: 9.6459 / Avg. batch time: 979.4049 (ms) / GPU bubble ratio: 58.63%
[rank3]:2025-12-25 09:46:33,433 -  step: 100  loss: -4.0000  grad_norm:  3.8270  memory: 15.27GiB(32.13%)  tps: 8,083  tflops: 63.19  mfu: 20.25%
[rank1]:2025-12-25 09:46:33,385 - Avg. fwd time: 9.8895 / Avg. bwd-weight time: 10.3062 / Avg. bwd-input time: 12.2476 / Avg. batch time: 1023.4189 (ms) / GPU bubble ratio: 49.28%
[rank1]:2025-12-25 09:46:33,437 -  step: 100  loss: -4.0000  grad_norm:  3.8270  memory: 17.85GiB(37.57%)  tps: 8,083  tflops: 63.19  mfu: 20.25%
[rank2]:2025-12-25 09:46:33,381 - Avg. fwd time: 8.2121 / Avg. bwd-weight time: 8.0167 / Avg. bwd-input time: 10.0410 / Avg. batch time: 988.6913 (ms) / GPU bubble ratio: 57.49%
[rank2]:2025-12-25 09:46:33,434 -  step: 100  loss: -4.0000  grad_norm:  3.8270  memory: 13.80GiB(29.05%)  tps: 8,083  tflops: 63.19  mfu: 20.25%
[rank0]:2025-12-25 09:46:33,460 -  step: 100  loss:  9.0557  grad_norm:  3.8270  memory: 36.24GiB(76.29%)  tps: 8,083  tflops: 63.19  mfu: 20.25%
[rank0]:2025-12-25 09:46:33,520 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank0/251225_0946_stage0_step100.svg
[rank1]:2025-12-25 09:46:33,520 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank1/251225_0946_stage1_step100.svg
[rank2]:2025-12-25 09:46:33,521 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank2/251225_0946_stage2_step100.svg
[rank0]:2025-12-25 09:46:33,559 - âœ… Frozen Ratio History of Rank 0 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank0/251225_0946_stage7_step100.svg
[rank0]:2025-12-25 09:46:33,598 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251225_0946_stage0.svg
[rank0]:2025-12-25 09:46:33,635 - âœ… Scatter Plot of Stage 7 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251225_0946_stage7.svg
[rank1]:2025-12-25 09:46:33,559 - âœ… Frozen Ratio History of Rank 1 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank1/251225_0946_stage6_step100.svg
[rank1]:2025-12-25 09:46:33,599 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251225_0946_stage1.svg
[rank1]:2025-12-25 09:46:33,635 - âœ… Scatter Plot of Stage 6 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251225_0946_stage6.svg
[rank2]:2025-12-25 09:46:33,558 - âœ… Frozen Ratio History of Rank 2 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank2/251225_0946_stage5_step100.svg
[rank2]:2025-12-25 09:46:33,596 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251225_0946_stage2.svg
[rank2]:2025-12-25 09:46:33,632 - âœ… Scatter Plot of Stage 5 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251225_0946_stage5.svg
[rank3]:2025-12-25 09:46:33,743 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/pipeline_schedule/251225_0946_step100_rank3.svg
[rank3]:			> Batch Time: 766.00 ms, GPU Bubble Ratio: 38.32%, 53.21%, 61.32%, 63.34%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-8-33ms      | [S0,MB4,F]  33-7-40ms      | [S0,MB5,F]  40-9-50ms      | [S0,MB6,F]  50-8-58ms      | [S7,MB0,F]  112-16-129ms   | [S7,MB0,BI] 141-32-173ms   | [S7,MB0,BW] 173-0-173ms    | [S7,MB1,F]  174-16-190ms   | [S7,MB1,BI] 203-33-236ms   | [S7,MB1,BW] 236-0-236ms    | [S7,MB2,F]  236-18-255ms   | [S7,MB2,BI] 267-34-302ms   | [S7,MB2,BW] 302-0-302ms    | [S7,MB3,F]  302-18-320ms   | [S7,MB3,BI] 332-35-368ms   | [S7,MB3,BW] 368-0-368ms    | [S0,MB7,F]  368-10-378ms   | [S0,MB0,B]  377-0-377ms    | [S7,MB4,F]  385-18-403ms   | [S7,MB4,BI] 415-33-449ms   | [S7,MB4,BW] 449-0-449ms    | [S0,MB1,B]  456-0-456ms    | [S7,MB5,F]  460-16-476ms   | [S7,MB5,BI] 490-33-523ms   | [S7,MB5,BW] 523-0-523ms    | [S0,MB2,B]  530-0-530ms    | [S7,MB6,F]  543-14-558ms   | [S7,MB6,BI] 570-32-602ms   | [S7,MB6,BW] 603-0-603ms    | [S0,MB3,B]  609-0-609ms    | [S7,MB7,F]  623-14-638ms   | [S7,MB7,BI] 650-32-682ms   | [S7,MB7,BW] 683-0-683ms    | [S0,MB4,B]  690-0-690ms    | [S0,MB5,B]  716-0-716ms    | [S0,MB6,B]  742-0-742ms    | [S0,MB7,B]  766-0-766ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  27-10-37ms     | [S1,MB2,F]  44-10-55ms     | [S1,MB3,F]  61-10-72ms     | [S1,MB4,F]  84-10-95ms     | [S6,MB0,F]  95-10-105ms    | [S1,MB5,F]  105-13-118ms   | [S6,MB1,F]  118-8-127ms    | [S6,MB0,BI] 173-9-182ms    | [S6,MB0,BW] 182-0-182ms    | [S6,MB2,F]  183-8-191ms    | [S6,MB1,BI] 236-9-245ms    | [S6,MB1,BW] 245-0-245ms    | [S6,MB3,F]  245-8-254ms    | [S6,MB2,BI] 302-9-311ms    | [S6,MB2,BW] 311-0-311ms    | [S1,MB6,F]  311-12-323ms   | [S1,MB0,BI] 323-15-339ms   | [S1,MB0,BW] 339-0-339ms    | [S6,MB4,F]  339-7-347ms    | [S6,MB3,BI] 367-11-378ms   | [S6,MB3,BW] 379-0-379ms    | [S1,MB7,F]  379-13-393ms   | [S1,MB1,BI] 392-15-408ms   | [S1,MB1,BW] 408-0-408ms    | [S6,MB5,F]  408-7-416ms    | [S6,MB4,BI] 449-11-461ms   | [S6,MB4,BW] 461-0-461ms    | [S1,MB2,BI] 468-13-482ms   | [S1,MB2,BW] 481-0-481ms    | [S6,MB6,F]  529-7-536ms    | [S6,MB5,BI] 536-10-546ms   | [S6,MB5,BW] 546-0-546ms    | [S1,MB3,BI] 553-14-567ms   | [S1,MB3,BW] 567-0-567ms    | [S6,MB7,F]  609-7-616ms    | [S6,MB6,BI] 616-10-626ms   | [S6,MB6,BW] 626-0-626ms    | [S1,MB4,BI] 633-14-647ms   | [S6,MB7,BI] 683-10-693ms   | [S1,MB5,BI] 693-14-708ms   | [S1,MB4,BW] 708-0-708ms    | [S1,MB6,BI] 721-14-735ms   | [S1,MB5,BW] 735-0-735ms    | [S1,MB7,BI] 745-13-759ms   | [S1,MB6,BW] 759-0-759ms    | [S6,MB7,BW] 759-0-759ms    | [S1,MB7,BW] 759-0-759ms   
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  37-7-45ms      | [S2,MB2,F]  55-7-62ms      | [S5,MB0,F]  62-9-71ms      | [S2,MB3,F]  73-9-82ms      | [S5,MB1,F]  82-7-89ms      | [S2,MB4,F]  95-10-105ms    | [S5,MB2,F]  114-8-123ms    | [S5,MB0,BI] 182-9-192ms    | [S5,MB0,BW] 192-0-192ms    | [S5,MB3,F]  192-8-201ms    | [S5,MB1,BI] 246-9-255ms    | [S5,MB1,BW] 255-0-255ms    | [S2,MB5,F]  255-8-264ms    | [S2,MB0,BI] 264-11-275ms   | [S2,MB0,BW] 275-0-275ms    | [S5,MB4,F]  275-7-283ms    | [S5,MB2,BI] 311-10-322ms   | [S5,MB2,BW] 322-0-322ms    | [S2,MB6,F]  324-9-333ms    | [S2,MB1,BI] 335-10-346ms   | [S2,MB1,BW] 346-0-346ms    | [S5,MB5,F]  346-7-353ms    | [S5,MB3,BI] 382-10-393ms   | [S5,MB3,BW] 393-0-393ms    | [S2,MB7,F]  393-9-403ms    | [S2,MB2,BI] 405-10-415ms   | [S2,MB2,BW] 415-0-415ms    | [S5,MB6,F]  415-7-423ms    | [S5,MB4,BI] 461-10-471ms   | [S5,MB4,BW] 471-0-471ms    | [S2,MB3,BI] 532-9-541ms    | [S2,MB3,BW] 541-0-541ms    | [S5,MB7,F]  552-7-559ms    | [S5,MB5,BI] 560-9-569ms    | [S5,MB5,BW] 569-0-569ms    | [S2,MB4,BI] 611-9-621ms    | [S5,MB6,BI] 626-10-636ms   | [S2,MB5,BI] 636-10-646ms   | [S5,MB7,BI] 694-9-703ms    | [S2,MB6,BI] 703-11-714ms   | [S2,MB4,BW] 714-0-714ms    | [S2,MB7,BI] 729-9-739ms    | [S2,MB5,BW] 739-0-739ms    | [S5,MB6,BW] 739-0-739ms    | [S5,MB7,BW] 739-0-739ms    | [S2,MB6,BW] 739-0-739ms    | [S2,MB7,BW] 739-0-739ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-7-36ms      | [S4,MB0,F]  36-8-44ms      | [S3,MB1,F]  45-8-54ms      | [S4,MB1,F]  54-7-61ms      | [S3,MB2,F]  63-7-70ms      | [S4,MB2,F]  70-7-78ms      | [S3,MB3,F]  97-7-105ms     | [S4,MB3,F]  105-8-113ms    | [S4,MB0,BI] 192-9-201ms    | [S4,MB0,BW] 201-0-201ms    | [S3,MB4,F]  201-7-208ms    | [S3,MB0,BI] 208-9-218ms    | [S3,MB0,BW] 218-0-218ms    | [S4,MB4,F]  218-7-225ms    | [S4,MB1,BI] 255-10-266ms   | [S4,MB1,BW] 266-0-266ms    | [S3,MB5,F]  266-8-274ms    | [S3,MB1,BI] 274-9-283ms    | [S3,MB1,BW] 283-0-283ms    | [S4,MB5,F]  283-7-291ms    | [S4,MB2,BI] 328-11-340ms   | [S4,MB2,BW] 340-0-340ms    | [S3,MB6,F]  340-7-347ms    | [S3,MB2,BI] 347-9-356ms    | [S3,MB2,BW] 356-0-356ms    | [S4,MB6,F]  357-7-364ms    | [S4,MB3,BI] 398-11-409ms   | [S4,MB3,BW] 409-0-409ms    | [S3,MB7,F]  409-7-417ms    | [S3,MB3,BI] 417-9-426ms    | [S3,MB3,BW] 426-0-426ms    | [S4,MB7,F]  426-7-434ms    | [S4,MB4,BI] 525-10-536ms   | [S4,MB4,BW] 536-0-536ms    | [S3,MB4,BI] 536-9-545ms    | [S4,MB5,BI] 605-10-615ms   | [S3,MB5,BI] 615-9-624ms    | [S4,MB6,BI] 636-9-646ms    | [S3,MB6,BI] 645-9-655ms    | [S4,MB7,BI] 705-9-714ms    | [S3,MB7,BI] 714-9-723ms    | [S3,MB4,BW] 723-0-723ms    | [S4,MB5,BW] 723-0-723ms    | [S4,MB6,BW] 723-0-723ms    | [S4,MB7,BW] 723-0-723ms    | [S3,MB5,BW] 723-0-724ms    | [S3,MB6,BW] 723-0-724ms    | [S3,MB7,BW] 724-1-725ms   
[rank3]:2025-12-25 09:46:33,783 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank3/251225_0946_stage3_step100.svg
[rank3]:2025-12-25 09:46:33,820 - âœ… Frozen Ratio History of Rank 3 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank3/251225_0946_stage4_step100.svg
[rank3]:2025-12-25 09:46:33,858 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251225_0946_stage3.svg
[rank3]:2025-12-25 09:46:33,893 - âœ… Scatter Plot of Stage 4 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251225_0946_stage4.svg
[rank0]:2025-12-25 09:49:47,892 - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-12-25 09:49:48,148 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB0] 0.67/1.00, [MB3] 0.00/0.00, [MB1] 0.37/0.55, [MB4] 0.00/0.00, [MB2] 0.10/0.15, [MB5] 0.00/0.00, [MB3] 0.14/0.20, [MB6] 0.00/0.00, [MB4] 0.45/0.67, [MB5] 0.57/0.85, [MB6] 0.67/1.00, [MB7] 0.54/0.80, [MB7] 0.67/1.00
[rank0]:2025-12-25 09:49:48,173 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.67/1.00, [MB2] 0.67/1.00, [MB3] 0.67/1.00, [MB0] 0.67/1.00, [MB4] 0.67/1.00, [MB1] 0.67/1.00, [MB5] 0.67/1.00, [MB2] 0.67/1.00, [MB6] 0.67/1.00, [MB3] 0.67/1.00, [MB7] 0.27/0.40, [MB4] 0.51/0.76, [MB5] 0.22/0.34, [MB6] 0.25/0.38, [MB7] 0.61/0.92
[rank2]:2025-12-25 09:49:48,144 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB0] 0.00/0.00, [MB2] 0.00/0.00, [MB1] 0.00/0.00, [MB3] 0.00/0.00, [MB2] 0.00/0.00, [MB4] 0.00/0.00, [MB3] 0.00/0.00, [MB5] 0.00/0.00, [MB4] 0.21/0.32, [MB5] 0.67/1.00, [MB6] 0.00/0.00, [MB7] 0.14/0.21, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank3]:2025-12-25 09:49:48,143 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB4] 0.67/1.00, [MB5] 0.31/0.46, [MB6] 0.67/1.00, [MB7] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank3]:2025-12-25 09:49:52,110 - Avg. fwd time: 7.7820 / Avg. bwd-weight time: 8.0132 / Avg. bwd-input time: 9.6794 / Avg. batch time: 949.0662 (ms) / GPU bubble ratio: 57.05%
[rank1]:2025-12-25 09:49:52,120 - Avg. fwd time: 9.8620 / Avg. bwd-weight time: 10.0567 / Avg. bwd-input time: 12.3060 / Avg. batch time: 989.5286 (ms) / GPU bubble ratio: 47.89%
[rank1]:2025-12-25 09:49:52,184 -  step: 150  loss: -4.0000  grad_norm: 14.0275  memory: 17.85GiB(37.57%)  tps: 8,244  tflops: 64.44  mfu: 20.66%
[rank0]:2025-12-25 09:49:52,135 - Avg. fwd time: 13.4768 / Avg. full-bwd time: 22.3599 (Avg. bwd-weight time: 21.1104 / Avg. bwd-input time: 34.4039) / Avg. batch time: 1013.6633 (ms) / GPU bubble ratio: 17.27%
[rank2]:2025-12-25 09:49:52,116 - Avg. fwd time: 8.2161 / Avg. bwd-weight time: 8.2780 / Avg. bwd-input time: 10.0565 / Avg. batch time: 959.1472 (ms) / GPU bubble ratio: 55.71%
[rank2]:2025-12-25 09:49:52,181 -  step: 150  loss: -4.0000  grad_norm: 14.0275  memory: 13.80GiB(29.05%)  tps: 8,244  tflops: 64.45  mfu: 20.66%
[rank3]:2025-12-25 09:49:52,181 -  step: 150  loss: -4.0000  grad_norm: 14.0275  memory: 15.27GiB(32.13%)  tps: 8,244  tflops: 64.44  mfu: 20.66%
[rank0]:2025-12-25 09:49:52,209 -  step: 150  loss:  4.3651  grad_norm: 14.0275  memory: 36.24GiB(76.29%)  tps: 8,244  tflops: 64.44  mfu: 20.66%
[rank0]:2025-12-25 09:52:54,668 - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-12-25 09:52:54,975 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB0] 1.00/1.00, [MB3] 0.00/0.00, [MB1] 0.55/0.55, [MB4] 0.00/0.00, [MB2] 0.15/0.15, [MB5] 0.00/0.00, [MB3] 0.20/0.20, [MB6] 0.00/0.00, [MB4] 0.67/0.67, [MB5] 0.85/0.85, [MB6] 1.00/1.00, [MB7] 0.80/0.80, [MB7] 1.00/1.00
[rank2]:2025-12-25 09:52:54,971 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB0] 0.00/0.00, [MB2] 0.00/0.00, [MB1] 0.00/0.00, [MB3] 0.00/0.00, [MB2] 0.00/0.00, [MB4] 0.00/0.00, [MB3] 0.00/0.00, [MB5] 0.00/0.00, [MB4] 0.32/0.32, [MB5] 1.00/1.00, [MB6] 0.00/0.00, [MB7] 0.21/0.21, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-12-25 09:52:54,971 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 0.46/0.46, [MB6] 1.00/1.00, [MB7] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank0]:2025-12-25 09:52:55,000 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB0] 1.00/1.00, [MB4] 1.00/1.00, [MB1] 1.00/1.00, [MB5] 1.00/1.00, [MB2] 1.00/1.00, [MB6] 1.00/1.00, [MB3] 1.00/1.00, [MB7] 0.40/0.40, [MB4] 0.76/0.76, [MB5] 0.34/0.34, [MB6] 0.38/0.38, [MB7] 0.92/0.92
[rank1]:2025-12-25 09:52:58,440 - Avg. fwd time: 9.8305 / Avg. bwd-weight time: 9.6475 / Avg. bwd-input time: 12.3480 / Avg. batch time: 957.9646 (ms) / GPU bubble ratio: 46.84%
[rank2]:2025-12-25 09:52:58,438 - Avg. fwd time: 8.2401 / Avg. bwd-weight time: 8.3049 / Avg. bwd-input time: 10.0810 / Avg. batch time: 930.4917 (ms) / GPU bubble ratio: 54.22%
[rank3]:2025-12-25 09:52:58,432 - Avg. fwd time: 7.7952 / Avg. bwd-weight time: 7.9048 / Avg. bwd-input time: 9.7275 / Avg. batch time: 919.0668 (ms) / GPU bubble ratio: 55.73%
[rank0]:2025-12-25 09:52:58,463 - Avg. fwd time: 13.4671 / Avg. full-bwd time: 21.0468 (Avg. bwd-weight time: 18.5643 / Avg. bwd-input time: 34.4455) / Avg. batch time: 983.0824 (ms) / GPU bubble ratio: 17.82%
[rank1]:2025-12-25 09:52:58,512 -  step: 200  loss: -4.0000  grad_norm:  5.0687  memory: 17.85GiB(37.57%)  tps: 8,793  tflops: 68.74  mfu: 22.03%
[rank2]:2025-12-25 09:52:58,509 -  step: 200  loss: -4.0000  grad_norm:  5.0687  memory: 13.82GiB(29.09%)  tps: 8,793  tflops: 68.74  mfu: 22.03%
[rank3]:2025-12-25 09:52:58,509 -  step: 200  loss: -4.0000  grad_norm:  5.0687  memory: 15.27GiB(32.13%)  tps: 8,793  tflops: 68.74  mfu: 22.03%
[rank0]:2025-12-25 09:52:58,535 -  step: 200  loss:  1.6656  grad_norm:  5.0687  memory: 36.24GiB(76.29%)  tps: 8,793  tflops: 68.74  mfu: 22.03%
[rank1]:2025-12-25 09:52:58,586 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank1/251225_0952_stage1_step200.svg
[rank1]:2025-12-25 09:52:58,629 - âœ… Frozen Ratio History of Rank 1 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank1/251225_0952_stage6_step200.svg
[rank2]:2025-12-25 09:52:58,588 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank2/251225_0952_stage2_step200.svg
[rank2]:2025-12-25 09:52:58,630 - âœ… Frozen Ratio History of Rank 2 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank2/251225_0952_stage5_step200.svg
[rank0]:2025-12-25 09:52:58,589 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank0/251225_0952_stage0_step200.svg
[rank0]:2025-12-25 09:52:58,635 - âœ… Frozen Ratio History of Rank 0 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank0/251225_0952_stage7_step200.svg
[rank1]:2025-12-25 09:52:58,800 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251225_0952_stage1.svg
[rank2]:2025-12-25 09:52:58,799 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251225_0952_stage2.svg
[rank0]:2025-12-25 09:52:58,823 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251225_0952_stage0.svg
[rank3]:2025-12-25 09:52:58,858 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/pipeline_schedule/251225_0952_step200_rank3.svg
[rank3]:			> Batch Time: 827.10 ms, GPU Bubble Ratio: 25.01%, 41.65%, 48.33%, 51.14%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-8-33ms      | [S0,MB4,F]  33-8-42ms      | [S0,MB5,F]  42-9-51ms      | [S0,MB6,F]  51-8-60ms      | [S7,MB0,F]  112-17-129ms   | [S7,MB0,BI] 141-32-174ms   | [S7,MB0,BW] 174-25-199ms   | [S7,MB1,F]  200-16-216ms   | [S7,MB1,BI] 228-34-263ms   | [S7,MB1,BW] 263-1-265ms    | [S7,MB2,F]  264-18-282ms   | [S7,MB2,BI] 294-35-330ms   | [S7,MB2,BW] 330-0-330ms    | [S7,MB3,F]  330-20-351ms   | [S7,MB3,BI] 363-35-399ms   | [S7,MB3,BW] 398-0-398ms    | [S0,MB7,F]  399-10-409ms   | [S0,MB0,B]  410-6-416ms    | [S7,MB4,F]  419-19-438ms   | [S7,MB4,BI] 450-34-485ms   | [S7,MB4,BW] 485-0-485ms    | [S0,MB1,B]  492-8-501ms    | [S7,MB5,F]  501-17-519ms   | [S7,MB5,BI] 530-34-564ms   | [S7,MB5,BW] 565-0-565ms    | [S0,MB2,B]  572-5-577ms    | [S7,MB6,F]  586-15-602ms   | [S7,MB6,BI] 614-33-647ms   | [S7,MB6,BW] 648-0-648ms    | [S0,MB3,B]  654-11-666ms   | [S7,MB7,F]  669-15-684ms   | [S7,MB7,BI] 697-33-730ms   | [S7,MB7,BW] 730-4-734ms    | [S0,MB4,B]  739-16-755ms   | [S0,MB5,B]  766-21-787ms   | [S0,MB6,B]  791-23-814ms   | [S0,MB7,B]  817-9-827ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  27-10-38ms     | [S1,MB2,F]  44-10-55ms     | [S1,MB3,F]  62-10-72ms     | [S1,MB4,F]  85-10-95ms     | [S6,MB0,F]  95-10-106ms    | [S1,MB5,F]  106-13-119ms   | [S6,MB1,F]  119-8-128ms    | [S6,MB0,BI] 174-9-183ms    | [S6,MB0,BW] 183-10-194ms   | [S6,MB2,F]  194-7-201ms    | [S6,MB1,BI] 263-9-272ms    | [S6,MB1,BW] 272-10-283ms   | [S6,MB3,F]  283-7-290ms    | [S6,MB2,BI] 330-9-339ms    | [S6,MB2,BW] 339-10-350ms   | [S1,MB6,F]  350-10-361ms   | [S1,MB0,BI] 361-15-377ms   | [S1,MB0,BW] 377-1-378ms    | [S6,MB4,F]  378-7-386ms    | [S6,MB3,BI] 398-11-410ms   | [S6,MB3,BW] 410-11-422ms   | [S1,MB7,F]  422-11-433ms   | [S1,MB1,BI] 433-16-449ms   | [S1,MB1,BW] 449-7-456ms    | [S6,MB5,F]  456-8-465ms    | [S6,MB4,BI] 485-12-497ms   | [S6,MB4,BW] 497-10-508ms   | [S1,MB2,BI] 508-14-522ms   | [S1,MB2,BW] 522-12-534ms   | [S6,MB6,F]  571-7-579ms    | [S6,MB5,BI] 579-10-589ms   | [S6,MB5,BW] 589-10-599ms   | [S1,MB3,BI] 599-14-614ms   | [S1,MB3,BW] 614-12-627ms   | [S6,MB7,F]  654-7-661ms    | [S6,MB6,BI] 661-10-672ms   | [S6,MB6,BW] 672-10-683ms   | [S1,MB4,BI] 683-14-697ms   | [S6,MB7,BI] 730-10-741ms   | [S1,MB5,BI] 741-14-756ms   | [S1,MB4,BW] 756-7-764ms    | [S1,MB6,BI] 769-14-783ms   | [S1,MB5,BW] 783-2-786ms    | [S1,MB7,BI] 794-14-808ms   | [S1,MB6,BW] 808-1-810ms    | [S6,MB7,BW] 810-3-813ms    | [S1,MB7,BW] 812-0-813ms   
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  38-7-45ms      | [S2,MB2,F]  55-7-63ms      | [S5,MB0,F]  63-9-72ms      | [S2,MB3,F]  73-9-83ms      | [S5,MB1,F]  83-7-90ms      | [S2,MB4,F]  96-10-106ms    | [S5,MB2,F]  114-8-123ms    | [S5,MB0,BI] 184-9-193ms    | [S5,MB0,BW] 193-10-203ms   | [S5,MB3,F]  203-7-211ms    | [S5,MB1,BI] 272-9-282ms    | [S5,MB1,BW] 282-11-293ms   | [S2,MB5,F]  293-7-300ms    | [S2,MB0,BI] 300-10-311ms   | [S2,MB0,BW] 311-9-321ms    | [S5,MB4,F]  321-7-329ms    | [S5,MB2,BI] 339-10-350ms   | [S5,MB2,BW] 350-10-361ms   | [S2,MB6,F]  362-10-372ms   | [S2,MB1,BI] 373-10-384ms   | [S2,MB1,BW] 385-9-395ms    | [S5,MB5,F]  395-7-403ms    | [S5,MB3,BI] 415-10-425ms   | [S5,MB3,BW] 426-10-436ms   | [S2,MB7,F]  436-9-446ms    | [S2,MB2,BI] 447-10-458ms   | [S2,MB2,BW] 458-10-468ms   | [S5,MB6,F]  468-7-476ms    | [S5,MB4,BI] 497-10-508ms   | [S5,MB4,BW] 508-9-518ms    | [S2,MB3,BI] 574-9-584ms    | [S2,MB3,BW] 584-10-595ms   | [S5,MB7,F]  599-7-606ms    | [S5,MB5,BI] 606-9-616ms    | [S5,MB5,BW] 615-9-625ms    | [S2,MB4,BI] 657-9-667ms    | [S5,MB6,BI] 672-10-683ms   | [S2,MB5,BI] 682-10-693ms   | [S5,MB7,BI] 742-9-751ms    | [S2,MB6,BI] 751-10-762ms   | [S2,MB4,BW] 762-7-770ms    | [S2,MB7,BI] 777-9-787ms    | [S2,MB5,BW] 787-0-787ms    | [S5,MB6,BW] 787-10-798ms   | [S5,MB7,BW] 797-8-806ms    | [S2,MB6,BW] 806-0-806ms    | [S2,MB7,BW] 806-1-807ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-8-37ms      | [S4,MB0,F]  37-8-45ms      | [S3,MB1,F]  46-8-54ms      | [S4,MB1,F]  54-7-62ms      | [S3,MB2,F]  63-7-71ms      | [S4,MB2,F]  71-7-78ms      | [S3,MB3,F]  98-7-105ms     | [S4,MB3,F]  105-8-113ms    | [S4,MB0,BI] 193-9-202ms    | [S4,MB0,BW] 202-9-212ms    | [S3,MB4,F]  212-7-219ms    | [S3,MB0,BI] 219-9-228ms    | [S3,MB0,BW] 228-9-238ms    | [S4,MB4,F]  238-7-246ms    | [S4,MB1,BI] 282-10-292ms   | [S4,MB1,BW] 292-10-303ms   | [S3,MB5,F]  303-8-311ms    | [S3,MB1,BI] 311-9-320ms    | [S3,MB1,BW] 321-9-330ms    | [S4,MB5,F]  330-7-338ms    | [S4,MB2,BI] 367-11-378ms   | [S4,MB2,BW] 378-9-388ms    | [S3,MB6,F]  388-7-395ms    | [S3,MB2,BI] 395-9-405ms    | [S3,MB2,BW] 405-10-415ms   | [S4,MB6,F]  415-8-423ms    | [S4,MB3,BI] 440-12-452ms   | [S4,MB3,BW] 453-9-462ms    | [S3,MB7,F]  462-7-470ms    | [S3,MB3,BI] 470-9-480ms    | [S3,MB3,BW] 479-10-490ms   | [S4,MB7,F]  490-8-498ms    | [S4,MB4,BI] 568-10-578ms   | [S4,MB4,BW] 578-9-588ms    | [S3,MB4,BI] 588-10-599ms   | [S4,MB5,BI] 651-10-661ms   | [S3,MB5,BI] 661-9-670ms    | [S4,MB6,BI] 683-9-692ms    | [S3,MB6,BI] 692-9-701ms    | [S4,MB7,BI] 753-9-762ms    | [S3,MB7,BI] 762-9-771ms    | [S3,MB4,BW] 771-1-773ms    | [S4,MB5,BW] 772-6-779ms    | [S4,MB6,BW] 779-1-780ms    | [S4,MB7,BW] 780-1-781ms    | [S3,MB5,BW] 781-0-781ms    | [S3,MB6,BW] 781-9-791ms    | [S3,MB7,BW] 791-9-800ms   
[rank3]:2025-12-25 09:52:58,899 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank3/251225_0952_stage3_step200.svg
[rank3]:2025-12-25 09:52:58,940 - âœ… Frozen Ratio History of Rank 3 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank3/251225_0952_stage4_step200.svg
[rank1]:2025-12-25 09:52:58,960 - âœ… Scatter Plot of Stage 6 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251225_0952_stage6.svg
[rank2]:2025-12-25 09:52:58,958 - âœ… Scatter Plot of Stage 5 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251225_0952_stage5.svg
[rank0]:2025-12-25 09:52:59,003 - âœ… Scatter Plot of Stage 7 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251225_0952_stage7.svg
[rank3]:2025-12-25 09:52:59,105 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251225_0952_stage3.svg
[rank3]:2025-12-25 09:52:59,263 - âœ… Scatter Plot of Stage 4 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251225_0952_stage4.svg
[rank0]:2025-12-25 09:55:47,441 - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-12-25 09:55:47,831 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB0] 1.00/1.00, [MB3] 0.00/0.00, [MB1] 0.55/0.55, [MB4] 0.00/0.00, [MB2] 0.15/0.15, [MB5] 0.00/0.00, [MB3] 0.20/0.20, [MB6] 0.00/0.00, [MB4] 0.67/0.67, [MB5] 0.85/0.85, [MB6] 1.00/1.00, [MB7] 0.80/0.80, [MB7] 1.00/1.00
[rank3]:2025-12-25 09:55:47,827 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 0.46/0.46, [MB6] 1.00/1.00, [MB7] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank2]:2025-12-25 09:55:47,826 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB0] 0.00/0.00, [MB2] 0.00/0.00, [MB1] 0.00/0.00, [MB3] 0.00/0.00, [MB2] 0.00/0.00, [MB4] 0.00/0.00, [MB3] 0.00/0.00, [MB5] 0.00/0.00, [MB4] 0.32/0.32, [MB5] 1.00/1.00, [MB6] 0.00/0.00, [MB7] 0.21/0.21, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank0]:2025-12-25 09:55:47,854 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB0] 1.00/1.00, [MB4] 1.00/1.00, [MB1] 1.00/1.00, [MB5] 1.00/1.00, [MB2] 1.00/1.00, [MB6] 1.00/1.00, [MB3] 1.00/1.00, [MB7] 0.40/0.40, [MB4] 0.76/0.76, [MB5] 0.34/0.34, [MB6] 0.38/0.38, [MB7] 0.92/0.92
[rank3]:2025-12-25 09:55:51,173 - Avg. fwd time: 7.8114 / Avg. bwd-weight time: 7.7517 / Avg. bwd-input time: 9.7811 / Avg. batch time: 886.5280 (ms) / GPU bubble ratio: 54.26%
[rank2]:2025-12-25 09:55:51,177 - Avg. fwd time: 8.2672 / Avg. bwd-weight time: 8.2468 / Avg. bwd-input time: 10.1260 / Avg. batch time: 899.2447 (ms) / GPU bubble ratio: 52.60%
[rank0]:2025-12-25 09:55:51,188 - Avg. fwd time: 13.3981 / Avg. full-bwd time: 18.7219 (Avg. bwd-weight time: 16.1533 / Avg. bwd-input time: 34.3593) / Avg. batch time: 950.6904 (ms) / GPU bubble ratio: 19.19%
[rank1]:2025-12-25 09:55:51,180 - Avg. fwd time: 9.8146 / Avg. bwd-weight time: 9.2107 / Avg. bwd-input time: 12.4170 / Avg. batch time: 924.6494 (ms) / GPU bubble ratio: 45.59%
[rank1]:2025-12-25 09:55:51,237 -  step: 250  loss: -4.0000  grad_norm:  1.0401  memory: 17.87GiB(37.61%)  tps: 9,486  tflops: 74.15  mfu: 23.77%
[rank3]:2025-12-25 09:55:51,234 -  step: 250  loss: -4.0000  grad_norm:  1.0401  memory: 15.27GiB(32.13%)  tps: 9,486  tflops: 74.15  mfu: 23.77%
[rank2]:2025-12-25 09:55:51,234 -  step: 250  loss: -4.0000  grad_norm:  1.0401  memory: 13.82GiB(29.09%)  tps: 9,486  tflops: 74.15  mfu: 23.77%
[rank0]:2025-12-25 09:55:51,260 -  step: 250  loss:  0.5163  grad_norm:  1.0401  memory: 36.24GiB(76.29%)  tps: 9,486  tflops: 74.15  mfu: 23.77%
[rank0]:2025-12-25 09:58:37,058 - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-12-25 09:58:37,575 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB0] 0.00/0.00, [MB2] 0.00/0.00, [MB1] 0.00/0.00, [MB3] 0.00/0.00, [MB2] 0.00/0.00, [MB4] 0.00/0.00, [MB3] 0.00/0.00, [MB5] 0.00/0.00, [MB4] 0.32/0.32, [MB5] 1.00/1.00, [MB6] 0.00/0.00, [MB7] 0.21/0.21, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-12-25 09:58:37,579 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB0] 1.00/1.00, [MB3] 0.00/0.00, [MB1] 0.55/0.55, [MB4] 0.00/0.00, [MB2] 0.15/0.15, [MB5] 0.00/0.00, [MB3] 0.20/0.20, [MB6] 0.00/0.00, [MB4] 0.67/0.67, [MB5] 0.85/0.85, [MB6] 1.00/1.00, [MB7] 0.80/0.80, [MB7] 1.00/1.00
[rank3]:2025-12-25 09:58:37,575 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 0.46/0.46, [MB6] 1.00/1.00, [MB7] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank0]:2025-12-25 09:58:37,585 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB0] 1.00/1.00, [MB4] 1.00/1.00, [MB1] 1.00/1.00, [MB5] 1.00/1.00, [MB2] 1.00/1.00, [MB6] 1.00/1.00, [MB3] 1.00/1.00, [MB7] 0.40/0.40, [MB4] 0.76/0.76, [MB5] 0.34/0.34, [MB6] 0.38/0.38, [MB7] 0.92/0.92
[rank0]:2025-12-25 09:58:40,923 - Avg. fwd time: 13.3330 / Avg. full-bwd time: 16.8989 (Avg. bwd-weight time: 14.3885 / Avg. bwd-input time: 34.2939) / Avg. batch time: 927.2177 (ms) / GPU bubble ratio: 20.41%
[rank2]:2025-12-25 09:58:40,912 - Avg. fwd time: 8.2868 / Avg. bwd-weight time: 8.1991 / Avg. bwd-input time: 10.1604 / Avg. batch time: 877.6225 (ms) / GPU bubble ratio: 51.42%
[rank2]:2025-12-25 09:58:40,968 -  step: 300  loss: -4.0000  grad_norm:  0.5119  memory: 13.82GiB(29.09%)  tps: 9,653  tflops: 75.46  mfu: 24.19%
[rank1]:2025-12-25 09:58:40,915 - Avg. fwd time: 9.8047 / Avg. bwd-weight time: 8.9304 / Avg. bwd-input time: 12.4709 / Avg. batch time: 901.7989 (ms) / GPU bubble ratio: 44.63%
[rank1]:2025-12-25 09:58:40,972 -  step: 300  loss: -4.0000  grad_norm:  0.5119  memory: 17.87GiB(37.61%)  tps: 9,653  tflops: 75.46  mfu: 24.19%
[rank3]:2025-12-25 09:58:40,905 - Avg. fwd time: 7.8233 / Avg. bwd-weight time: 7.6474 / Avg. bwd-input time: 9.8195 / Avg. batch time: 864.3169 (ms) / GPU bubble ratio: 53.18%
[rank3]:2025-12-25 09:58:40,968 -  step: 300  loss: -4.0000  grad_norm:  0.5119  memory: 15.27GiB(32.13%)  tps: 9,653  tflops: 75.46  mfu: 24.19%
[rank0]:2025-12-25 09:58:40,994 -  step: 300  loss:  0.3085  grad_norm:  0.5119  memory: 36.24GiB(76.29%)  tps: 9,653  tflops: 75.46  mfu: 24.19%
[rank0]:2025-12-25 09:58:41,044 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank0/251225_0958_stage0_step300.svg
[rank2]:2025-12-25 09:58:41,046 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank2/251225_0958_stage2_step300.svg
[rank2]:2025-12-25 09:58:41,087 - âœ… Frozen Ratio History of Rank 2 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank2/251225_0958_stage5_step300.svg
[rank1]:2025-12-25 09:58:41,044 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank1/251225_0958_stage1_step300.svg
[rank1]:2025-12-25 09:58:41,084 - âœ… Frozen Ratio History of Rank 1 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank1/251225_0958_stage6_step300.svg
[rank0]:2025-12-25 09:58:41,085 - âœ… Frozen Ratio History of Rank 0 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank0/251225_0958_stage7_step300.svg
[rank0]:2025-12-25 09:58:41,376 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251225_0958_stage0.svg
[rank2]:2025-12-25 09:58:41,389 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251225_0958_stage2.svg
[rank1]:2025-12-25 09:58:41,378 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251225_0958_stage1.svg
[rank3]:2025-12-25 09:58:41,319 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/pipeline_schedule/251225_0958_step300_rank3.svg
[rank3]:			> Batch Time: 810.75 ms, GPU Bubble Ratio: 27.36%, 40.55%, 47.05%, 50.64%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-8-34ms      | [S0,MB4,F]  34-7-42ms      | [S0,MB5,F]  42-9-51ms      | [S0,MB6,F]  51-8-60ms      | [S7,MB0,F]  113-16-129ms   | [S7,MB0,BI] 141-32-174ms   | [S7,MB0,BW] 174-27-202ms   | [S7,MB1,F]  201-17-218ms   | [S7,MB1,BI] 230-34-264ms   | [S7,MB1,BW] 264-0-264ms    | [S7,MB2,F]  264-17-281ms   | [S7,MB2,BI] 294-35-329ms   | [S7,MB2,BW] 330-0-330ms    | [S7,MB3,F]  330-19-349ms   | [S7,MB3,BI] 360-35-395ms   | [S7,MB3,BW] 396-0-396ms    | [S0,MB7,F]  396-10-406ms   | [S0,MB0,B]  406-0-406ms    | [S7,MB4,F]  414-18-432ms   | [S7,MB4,BI] 444-33-477ms   | [S7,MB4,BW] 478-0-478ms    | [S0,MB1,B]  485-0-485ms    | [S7,MB5,F]  489-17-506ms   | [S7,MB5,BI] 519-33-552ms   | [S7,MB5,BW] 552-0-552ms    | [S0,MB2,B]  558-0-558ms    | [S7,MB6,F]  573-15-588ms   | [S7,MB6,BI] 599-33-632ms   | [S7,MB6,BW] 632-0-632ms    | [S0,MB3,B]  639-0-639ms    | [S7,MB7,F]  654-15-669ms   | [S7,MB7,BI] 681-33-714ms   | [S7,MB7,BW] 715-27-742ms   | [S0,MB4,B]  743-11-754ms   | [S0,MB5,B]  753-16-770ms   | [S0,MB6,B]  777-16-793ms   | [S0,MB7,B]  802-8-810ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-21ms      | [S1,MB1,F]  27-10-38ms     | [S1,MB2,F]  44-10-55ms     | [S1,MB3,F]  62-10-72ms     | [S1,MB4,F]  85-10-95ms     | [S6,MB0,F]  95-10-106ms    | [S1,MB5,F]  106-13-119ms   | [S6,MB1,F]  119-8-128ms    | [S6,MB0,BI] 174-9-183ms    | [S6,MB0,BW] 184-10-194ms   | [S6,MB2,F]  194-7-201ms    | [S6,MB1,BI] 264-9-273ms    | [S6,MB1,BW] 273-10-283ms   | [S6,MB3,F]  283-7-291ms    | [S6,MB2,BI] 330-9-339ms    | [S6,MB2,BW] 339-10-350ms   | [S1,MB6,F]  350-10-361ms   | [S1,MB0,BI] 361-15-377ms   | [S1,MB0,BW] 376-0-376ms    | [S6,MB4,F]  376-7-384ms    | [S6,MB3,BI] 396-11-407ms   | [S6,MB3,BW] 408-11-420ms   | [S1,MB7,F]  419-11-431ms   | [S1,MB1,BI] 431-16-447ms   | [S1,MB1,BW] 447-7-455ms    | [S6,MB5,F]  454-8-463ms    | [S6,MB4,BI] 477-12-490ms   | [S6,MB4,BW] 490-11-501ms   | [S1,MB2,BI] 501-14-516ms   | [S1,MB2,BW] 516-13-529ms   | [S6,MB6,F]  558-7-565ms    | [S6,MB5,BI] 565-10-576ms   | [S6,MB5,BW] 576-10-587ms   | [S1,MB3,BI] 586-14-601ms   | [S1,MB3,BW] 601-11-613ms   | [S6,MB7,F]  639-7-646ms    | [S6,MB6,BI] 646-10-657ms   | [S6,MB6,BW] 657-10-668ms   | [S1,MB4,BI] 668-14-683ms   | [S6,MB7,BI] 715-10-725ms   | [S1,MB5,BI] 725-15-741ms   | [S1,MB4,BW] 741-6-748ms    | [S1,MB6,BI] 755-14-770ms   | [S1,MB5,BW] 770-3-773ms    | [S1,MB7,BI] 780-14-795ms   | [S1,MB6,BW] 794-0-794ms    | [S6,MB7,BW] 794-2-797ms    | [S1,MB7,BW] 797-0-797ms   
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-8-29ms      | [S2,MB1,F]  38-7-45ms      | [S2,MB2,F]  55-7-63ms      | [S5,MB0,F]  63-9-72ms      | [S2,MB3,F]  73-9-82ms      | [S5,MB1,F]  82-7-90ms      | [S2,MB4,F]  96-10-106ms    | [S5,MB2,F]  115-8-123ms    | [S5,MB0,BI] 184-9-193ms    | [S5,MB0,BW] 193-10-204ms   | [S5,MB3,F]  203-7-211ms    | [S5,MB1,BI] 273-9-283ms    | [S5,MB1,BW] 283-11-294ms   | [S2,MB5,F]  294-7-301ms    | [S2,MB0,BI] 301-10-312ms   | [S2,MB0,BW] 312-9-321ms    | [S5,MB4,F]  322-7-330ms    | [S5,MB2,BI] 339-10-350ms   | [S5,MB2,BW] 350-10-360ms   | [S2,MB6,F]  362-10-372ms   | [S2,MB1,BI] 373-11-384ms   | [S2,MB1,BW] 384-10-394ms   | [S5,MB5,F]  395-7-402ms    | [S5,MB3,BI] 411-11-422ms   | [S5,MB3,BW] 423-10-433ms   | [S2,MB7,F]  434-9-444ms    | [S2,MB2,BI] 444-11-455ms   | [S2,MB2,BW] 455-10-465ms   | [S5,MB6,F]  466-8-474ms    | [S5,MB4,BI] 491-11-502ms   | [S5,MB4,BW] 501-9-511ms    | [S2,MB3,BI] 561-9-571ms    | [S2,MB3,BW] 571-10-581ms   | [S5,MB7,F]  585-7-592ms    | [S5,MB5,BI] 593-9-602ms    | [S5,MB5,BW] 602-9-612ms    | [S2,MB4,BI] 642-9-652ms    | [S5,MB6,BI] 658-10-668ms   | [S2,MB5,BI] 668-10-678ms   | [S5,MB7,BI] 728-9-737ms    | [S2,MB6,BI] 737-11-749ms   | [S2,MB4,BW] 749-6-755ms    | [S2,MB7,BI] 764-9-774ms    | [S2,MB5,BW] 774-0-774ms    | [S5,MB6,BW] 774-10-784ms   | [S5,MB7,BW] 784-9-793ms    | [S2,MB6,BW] 793-0-793ms    | [S2,MB7,BW] 793-0-793ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-7-37ms      | [S4,MB0,F]  37-8-45ms      | [S3,MB1,F]  46-8-54ms      | [S4,MB1,F]  54-7-62ms      | [S3,MB2,F]  63-7-71ms      | [S4,MB2,F]  71-7-78ms      | [S3,MB3,F]  98-7-105ms     | [S4,MB3,F]  105-8-113ms    | [S4,MB0,BI] 193-9-202ms    | [S4,MB0,BW] 202-9-212ms    | [S3,MB4,F]  212-7-219ms    | [S3,MB0,BI] 219-9-228ms    | [S3,MB0,BW] 228-9-238ms    | [S4,MB4,F]  238-7-246ms    | [S4,MB1,BI] 283-10-293ms   | [S4,MB1,BW] 293-10-303ms   | [S3,MB5,F]  303-8-312ms    | [S3,MB1,BI] 311-9-321ms    | [S3,MB1,BW] 321-9-331ms    | [S4,MB5,F]  331-7-339ms    | [S4,MB2,BI] 366-11-378ms   | [S4,MB2,BW] 378-9-388ms    | [S3,MB6,F]  387-7-395ms    | [S3,MB2,BI] 395-9-404ms    | [S3,MB2,BW] 404-10-415ms   | [S4,MB6,F]  415-8-423ms    | [S4,MB3,BI] 437-12-450ms   | [S4,MB3,BW] 450-9-460ms    | [S3,MB7,F]  460-7-467ms    | [S3,MB3,BI] 467-9-477ms    | [S3,MB3,BW] 477-10-487ms   | [S4,MB7,F]  487-8-496ms    | [S4,MB4,BI] 555-10-565ms   | [S4,MB4,BW] 565-9-575ms    | [S3,MB4,BI] 575-10-586ms   | [S4,MB5,BI] 636-10-646ms   | [S3,MB5,BI] 646-9-655ms    | [S4,MB6,BI] 669-9-678ms    | [S3,MB6,BI] 678-9-687ms    | [S4,MB7,BI] 740-9-749ms    | [S3,MB7,BI] 749-9-758ms    | [S3,MB4,BW] 758-0-758ms    | [S4,MB5,BW] 758-5-764ms    | [S4,MB6,BW] 764-0-764ms    | [S4,MB7,BW] 764-0-764ms    | [S3,MB5,BW] 764-0-764ms    | [S3,MB6,BW] 764-9-773ms    | [S3,MB7,BW] 774-9-783ms   
[rank3]:2025-12-25 09:58:41,360 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank3/251225_0958_stage3_step300.svg
[rank3]:2025-12-25 09:58:41,401 - âœ… Frozen Ratio History of Rank 3 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank3/251225_0958_stage4_step300.svg
[rank0]:2025-12-25 09:58:41,664 - âœ… Scatter Plot of Stage 7 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251225_0958_stage7.svg
[rank2]:2025-12-25 09:58:41,677 - âœ… Scatter Plot of Stage 5 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251225_0958_stage5.svg
[rank1]:2025-12-25 09:58:41,660 - âœ… Scatter Plot of Stage 6 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251225_0958_stage6.svg
[rank3]:2025-12-25 09:58:41,697 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251225_0958_stage3.svg
[rank3]:2025-12-25 09:58:41,987 - âœ… Scatter Plot of Stage 4 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251225_0958_stage4.svg
[rank0]:2025-12-25 10:01:28,893 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-25 10:01:32,704 - Avg. fwd time: 13.2819 / Avg. full-bwd time: 15.7125 (Avg. bwd-weight time: 13.0318 / Avg. bwd-input time: 34.2508) / Avg. batch time: 911.2463 (ms) / GPU bubble ratio: 21.37%
[rank1]:2025-12-25 10:01:32,699 - Avg. fwd time: 9.7990 / Avg. bwd-weight time: 8.7337 / Avg. bwd-input time: 12.5093 / Avg. batch time: 885.9191 (ms) / GPU bubble ratio: 43.94%
[rank2]:2025-12-25 10:01:32,700 - Avg. fwd time: 8.3015 / Avg. bwd-weight time: 8.1688 / Avg. bwd-input time: 10.1864 / Avg. batch time: 862.5963 (ms) / GPU bubble ratio: 50.56%
[rank3]:2025-12-25 10:01:32,692 - Avg. fwd time: 7.8326 / Avg. bwd-weight time: 7.5698 / Avg. bwd-input time: 9.8500 / Avg. batch time: 848.6064 (ms) / GPU bubble ratio: 52.39%
[rank0]:2025-12-25 10:01:32,772 -  step: 350  loss:  0.2420  grad_norm:  0.5298  memory: 36.24GiB(76.29%)  tps: 9,538  tflops: 74.56  mfu: 23.90%
[rank1]:2025-12-25 10:01:32,752 -  step: 350  loss: -4.0000  grad_norm:  0.5298  memory: 17.87GiB(37.61%)  tps: 9,538  tflops: 74.56  mfu: 23.90%
[rank2]:2025-12-25 10:01:32,749 -  step: 350  loss: -4.0000  grad_norm:  0.5298  memory: 13.82GiB(29.09%)  tps: 9,538  tflops: 74.56  mfu: 23.90%
[rank3]:2025-12-25 10:01:32,749 -  step: 350  loss: -4.0000  grad_norm:  0.5298  memory: 15.27GiB(32.13%)  tps: 9,538  tflops: 74.56  mfu: 23.90%
[rank0]:2025-12-25 10:04:18,717 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-25 10:04:22,570 - Avg. fwd time: 13.2547 / Avg. full-bwd time: 14.7126 (Avg. bwd-weight time: 12.1631 / Avg. bwd-input time: 34.2211) / Avg. batch time: 898.5040 (ms) / GPU bubble ratio: 22.00%
[rank0]:2025-12-25 10:04:22,639 -  step: 400  loss:  0.2209  grad_norm:  0.3503  memory: 36.24GiB(76.29%)  tps: 9,645  tflops: 75.40  mfu: 24.17%
[rank2]:2025-12-25 10:04:22,563 - Avg. fwd time: 8.3122 / Avg. bwd-weight time: 8.1489 / Avg. bwd-input time: 10.2064 / Avg. batch time: 851.1310 (ms) / GPU bubble ratio: 49.87%
[rank2]:2025-12-25 10:04:22,615 -  step: 400  loss: -4.0000  grad_norm:  0.3503  memory: 13.82GiB(29.09%)  tps: 9,645  tflops: 75.40  mfu: 24.17%
[rank3]:2025-12-25 10:04:22,559 - Avg. fwd time: 7.8394 / Avg. bwd-weight time: 7.5136 / Avg. bwd-input time: 9.8706 / Avg. batch time: 836.8448 (ms) / GPU bubble ratio: 51.77%
[rank3]:2025-12-25 10:04:22,615 -  step: 400  loss: -4.0000  grad_norm:  0.3503  memory: 15.27GiB(32.13%)  tps: 9,645  tflops: 75.40  mfu: 24.17%
[rank1]:2025-12-25 10:04:22,564 - Avg. fwd time: 9.7956 / Avg. bwd-weight time: 8.5728 / Avg. bwd-input time: 12.5397 / Avg. batch time: 873.7548 (ms) / GPU bubble ratio: 43.40%
[rank1]:2025-12-25 10:04:22,619 -  step: 400  loss: -4.0000  grad_norm:  0.3503  memory: 17.87GiB(37.61%)  tps: 9,645  tflops: 75.40  mfu: 24.17%
[rank0]:2025-12-25 10:04:22,694 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank0/251225_1004_stage0_step400.svg
[rank2]:2025-12-25 10:04:22,694 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank2/251225_1004_stage2_step400.svg
[rank2]:2025-12-25 10:04:22,738 - âœ… Frozen Ratio History of Rank 2 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank2/251225_1004_stage5_step400.svg
[rank1]:2025-12-25 10:04:22,697 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank1/251225_1004_stage1_step400.svg
[rank1]:2025-12-25 10:04:22,746 - âœ… Frozen Ratio History of Rank 1 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank1/251225_1004_stage6_step400.svg
[rank0]:2025-12-25 10:04:22,741 - âœ… Frozen Ratio History of Rank 0 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank0/251225_1004_stage7_step400.svg
[rank3]:2025-12-25 10:04:22,956 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/pipeline_schedule/251225_1004_step400_rank3.svg
[rank3]:			> Batch Time: 808.11 ms, GPU Bubble Ratio: 29.82%, 40.63%, 46.93%, 50.43%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-8-33ms      | [S0,MB4,F]  33-7-41ms      | [S0,MB5,F]  41-9-51ms      | [S0,MB6,F]  51-8-60ms      | [S7,MB0,F]  113-17-130ms   | [S7,MB0,BI] 142-32-174ms   | [S7,MB0,BW] 175-27-202ms   | [S7,MB1,F]  201-17-219ms   | [S7,MB1,BI] 230-34-265ms   | [S7,MB1,BW] 265-0-265ms    | [S7,MB2,F]  265-18-283ms   | [S7,MB2,BI] 295-35-331ms   | [S7,MB2,BW] 331-0-331ms    | [S7,MB3,F]  331-18-349ms   | [S7,MB3,BI] 361-35-396ms   | [S7,MB3,BW] 396-0-396ms    | [S0,MB7,F]  396-10-407ms   | [S0,MB0,B]  407-0-407ms    | [S7,MB4,F]  415-18-433ms   | [S7,MB4,BI] 445-34-479ms   | [S7,MB4,BW] 480-0-480ms    | [S0,MB1,B]  487-0-487ms    | [S7,MB5,F]  491-18-509ms   | [S7,MB5,BI] 521-33-554ms   | [S7,MB5,BW] 554-0-554ms    | [S0,MB2,B]  561-0-561ms    | [S7,MB6,F]  575-15-591ms   | [S7,MB6,BI] 603-33-636ms   | [S7,MB6,BW] 636-0-636ms    | [S0,MB3,B]  643-0-643ms    | [S7,MB7,F]  657-15-672ms   | [S7,MB7,BI] 685-33-718ms   | [S7,MB7,BW] 718-4-722ms    | [S0,MB4,B]  728-8-736ms    | [S0,MB5,B]  752-21-773ms   | [S0,MB6,B]  779-20-799ms   | [S0,MB7,B]  804-4-808ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-21ms      | [S1,MB1,F]  27-10-38ms     | [S1,MB2,F]  44-10-55ms     | [S1,MB3,F]  62-11-73ms     | [S1,MB4,F]  85-10-96ms     | [S6,MB0,F]  96-10-106ms    | [S1,MB5,F]  106-13-119ms   | [S6,MB1,F]  119-8-128ms    | [S6,MB0,BI] 175-9-184ms    | [S6,MB0,BW] 184-10-194ms   | [S6,MB2,F]  194-7-201ms    | [S6,MB1,BI] 265-9-274ms    | [S6,MB1,BW] 274-10-284ms   | [S6,MB3,F]  284-7-292ms    | [S6,MB2,BI] 331-9-340ms    | [S6,MB2,BW] 340-10-351ms   | [S1,MB6,F]  351-11-362ms   | [S1,MB0,BI] 362-16-378ms   | [S1,MB0,BW] 378-0-378ms    | [S6,MB4,F]  378-7-386ms    | [S6,MB3,BI] 397-11-408ms   | [S6,MB3,BW] 408-11-420ms   | [S1,MB7,F]  420-11-431ms   | [S1,MB1,BI] 432-16-448ms   | [S1,MB1,BW] 448-7-455ms    | [S6,MB5,F]  455-8-464ms    | [S6,MB4,BI] 480-12-492ms   | [S6,MB4,BW] 492-11-503ms   | [S1,MB2,BI] 503-14-518ms   | [S1,MB2,BW] 518-12-530ms   | [S6,MB6,F]  561-7-568ms    | [S6,MB5,BI] 568-10-578ms   | [S6,MB5,BW] 578-10-589ms   | [S1,MB3,BI] 589-14-604ms   | [S1,MB3,BW] 604-11-616ms   | [S6,MB7,F]  642-7-650ms    | [S6,MB6,BI] 650-10-661ms   | [S6,MB6,BW] 660-10-671ms   | [S1,MB4,BI] 671-14-686ms   | [S6,MB7,BI] 718-10-729ms   | [S1,MB5,BI] 729-15-744ms   | [S1,MB4,BW] 744-5-749ms    | [S1,MB6,BI] 757-14-771ms   | [S1,MB5,BW] 771-2-774ms    | [S1,MB7,BI] 781-14-795ms   | [S1,MB6,BW] 795-0-795ms    | [S6,MB7,BW] 795-3-799ms    | [S1,MB7,BW] 799-0-799ms   
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-8-29ms      | [S2,MB1,F]  38-7-45ms      | [S2,MB2,F]  55-7-63ms      | [S5,MB0,F]  63-9-72ms      | [S2,MB3,F]  73-9-83ms      | [S5,MB1,F]  83-7-90ms      | [S2,MB4,F]  96-10-106ms    | [S5,MB2,F]  115-8-124ms    | [S5,MB0,BI] 184-9-194ms    | [S5,MB0,BW] 194-10-204ms   | [S5,MB3,F]  204-7-211ms    | [S5,MB1,BI] 274-9-283ms    | [S5,MB1,BW] 284-11-295ms   | [S2,MB5,F]  295-7-302ms    | [S2,MB0,BI] 302-10-313ms   | [S2,MB0,BW] 313-9-322ms    | [S5,MB4,F]  322-7-330ms    | [S5,MB2,BI] 340-10-351ms   | [S5,MB2,BW] 351-10-361ms   | [S2,MB6,F]  363-10-373ms   | [S2,MB1,BI] 374-11-385ms   | [S2,MB1,BW] 386-10-396ms   | [S5,MB5,F]  396-7-404ms    | [S5,MB3,BI] 412-11-423ms   | [S5,MB3,BW] 423-10-434ms   | [S2,MB7,F]  434-9-444ms    | [S2,MB2,BI] 445-11-456ms   | [S2,MB2,BW] 456-10-466ms   | [S5,MB6,F]  467-8-475ms    | [S5,MB4,BI] 493-10-504ms   | [S5,MB4,BW] 503-9-513ms    | [S2,MB3,BI] 564-9-574ms    | [S2,MB3,BW] 574-10-584ms   | [S5,MB7,F]  588-7-595ms    | [S5,MB5,BI] 596-9-605ms    | [S5,MB5,BW] 605-9-615ms    | [S2,MB4,BI] 646-9-655ms    | [S5,MB6,BI] 661-10-672ms   | [S2,MB5,BI] 672-10-682ms   | [S5,MB7,BI] 730-9-739ms    | [S2,MB6,BI] 739-11-750ms   | [S2,MB4,BW] 750-9-759ms    | [S2,MB7,BI] 765-9-775ms    | [S2,MB5,BW] 775-0-775ms    | [S5,MB6,BW] 775-10-785ms   | [S5,MB7,BW] 785-6-792ms    | [S2,MB6,BW] 792-0-792ms    | [S2,MB7,BW] 792-0-792ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-8-37ms      | [S4,MB0,F]  37-8-45ms      | [S3,MB1,F]  46-8-54ms      | [S4,MB1,F]  54-7-62ms      | [S3,MB2,F]  63-7-71ms      | [S4,MB2,F]  71-7-79ms      | [S3,MB3,F]  98-7-105ms     | [S4,MB3,F]  105-8-114ms    | [S4,MB0,BI] 194-9-203ms    | [S4,MB0,BW] 203-9-212ms    | [S3,MB4,F]  212-7-219ms    | [S3,MB0,BI] 219-9-229ms    | [S3,MB0,BW] 229-9-239ms    | [S4,MB4,F]  238-8-246ms    | [S4,MB1,BI] 284-10-294ms   | [S4,MB1,BW] 294-10-304ms   | [S3,MB5,F]  304-8-312ms    | [S3,MB1,BI] 312-9-322ms    | [S3,MB1,BW] 322-9-332ms    | [S4,MB5,F]  332-7-340ms    | [S4,MB2,BI] 367-11-379ms   | [S4,MB2,BW] 379-9-389ms    | [S3,MB6,F]  389-7-396ms    | [S3,MB2,BI] 396-9-406ms    | [S3,MB2,BW] 406-9-416ms    | [S4,MB6,F]  416-8-424ms    | [S4,MB3,BI] 438-12-451ms   | [S4,MB3,BW] 451-9-461ms    | [S3,MB7,F]  460-7-468ms    | [S3,MB3,BI] 468-9-478ms    | [S3,MB3,BW] 478-10-489ms   | [S4,MB7,F]  489-8-497ms    | [S4,MB4,BI] 557-10-568ms   | [S4,MB4,BW] 568-9-577ms    | [S3,MB4,BI] 578-10-588ms   | [S4,MB5,BI] 639-10-649ms   | [S3,MB5,BI] 649-9-658ms    | [S4,MB6,BI] 672-9-681ms    | [S3,MB6,BI] 681-9-690ms    | [S4,MB7,BI] 740-9-749ms    | [S3,MB7,BI] 749-9-758ms    | [S3,MB4,BW] 759-0-759ms    | [S4,MB5,BW] 759-5-765ms    | [S4,MB6,BW] 765-0-765ms    | [S4,MB7,BW] 765-0-765ms    | [S3,MB5,BW] 765-0-765ms    | [S3,MB6,BW] 765-9-774ms    | [S3,MB7,BW] 774-9-784ms   
[rank3]:2025-12-25 10:04:23,000 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank3/251225_1004_stage3_step400.svg
[rank3]:2025-12-25 10:04:23,044 - âœ… Frozen Ratio History of Rank 3 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank3/251225_1004_stage4_step400.svg
[rank0]:2025-12-25 10:04:23,164 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251225_1004_stage0.svg
[rank2]:2025-12-25 10:04:23,159 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251225_1004_stage2.svg
[rank1]:2025-12-25 10:04:23,225 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251225_1004_stage1.svg
[rank3]:2025-12-25 10:04:23,459 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251225_1004_stage3.svg
[rank0]:2025-12-25 10:04:23,586 - âœ… Scatter Plot of Stage 7 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251225_1004_stage7.svg
[rank2]:2025-12-25 10:04:23,565 - âœ… Scatter Plot of Stage 5 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251225_1004_stage5.svg
[rank1]:2025-12-25 10:04:23,689 - âœ… Scatter Plot of Stage 6 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251225_1004_stage6.svg
[rank3]:2025-12-25 10:04:23,881 - âœ… Scatter Plot of Stage 4 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251225_1004_stage4.svg
[rank0]:2025-12-25 10:04:42,695 - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-12-25 10:04:43,199 - Dataset alpaca_gpt4 is being re-looped
[rank3]:2025-12-25 10:04:43,195 - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-12-25 10:04:43,206 - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-12-25 10:07:10,602 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-25 10:07:14,353 - Avg. fwd time: 7.8450 / Avg. bwd-weight time: 7.4713 / Avg. bwd-input time: 9.8869 / Avg. batch time: 827.8542 (ms) / GPU bubble ratio: 51.29%
[rank2]:2025-12-25 10:07:14,359 - Avg. fwd time: 8.3196 / Avg. bwd-weight time: 8.1307 / Avg. bwd-input time: 10.2216 / Avg. batch time: 842.4868 (ms) / GPU bubble ratio: 49.35%
[rank1]:2025-12-25 10:07:14,363 - Avg. fwd time: 9.7919 / Avg. bwd-weight time: 8.4483 / Avg. bwd-input time: 12.5608 / Avg. batch time: 864.5503 (ms) / GPU bubble ratio: 43.00%
[rank0]:2025-12-25 10:07:14,371 - Avg. fwd time: 13.2267 / Avg. full-bwd time: 13.9868 (Avg. bwd-weight time: 11.5464 / Avg. bwd-input time: 34.1900) / Avg. batch time: 889.1416 (ms) / GPU bubble ratio: 22.46%
[rank0]:2025-12-25 10:07:14,444 -  step: 450  loss:  0.2320  grad_norm:  0.4277  memory: 36.24GiB(76.29%)  tps: 9,537  tflops: 74.55  mfu: 23.89%
[rank3]:2025-12-25 10:07:14,417 -  step: 450  loss: -4.0000  grad_norm:  0.4277  memory: 15.27GiB(32.13%)  tps: 9,537  tflops: 74.55  mfu: 23.90%
[rank2]:2025-12-25 10:07:14,417 -  step: 450  loss: -4.0000  grad_norm:  0.4277  memory: 13.82GiB(29.09%)  tps: 9,537  tflops: 74.55  mfu: 23.90%
[rank1]:2025-12-25 10:07:14,420 -  step: 450  loss: -4.0000  grad_norm:  0.4277  memory: 17.87GiB(37.61%)  tps: 9,537  tflops: 74.55  mfu: 23.90%
[rank0]:2025-12-25 10:10:01,703 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-25 10:10:05,491 - Avg. fwd time: 7.8500 / Avg. bwd-weight time: 7.4335 / Avg. bwd-input time: 9.8989 / Avg. batch time: 820.6572 (ms) / GPU bubble ratio: 50.90%
[rank1]:2025-12-25 10:10:05,497 - Avg. fwd time: 9.7897 / Avg. bwd-weight time: 8.3571 / Avg. bwd-input time: 12.5775 / Avg. batch time: 857.1353 (ms) / GPU bubble ratio: 42.65%
[rank2]:2025-12-25 10:10:05,496 - Avg. fwd time: 8.3250 / Avg. bwd-weight time: 8.1199 / Avg. bwd-input time: 10.2321 / Avg. batch time: 835.5052 (ms) / GPU bubble ratio: 48.91%
[rank0]:2025-12-25 10:10:05,511 - Avg. fwd time: 13.2066 / Avg. full-bwd time: 13.4486 (Avg. bwd-weight time: 10.9938 / Avg. bwd-input time: 34.1650) / Avg. batch time: 881.7840 (ms) / GPU bubble ratio: 22.86%
[rank0]:2025-12-25 10:10:05,582 -  step: 500  loss:  0.2268  grad_norm:  0.4399  memory: 36.24GiB(76.29%)  tps: 9,574  tflops: 74.84  mfu: 23.99%
[rank3]:2025-12-25 10:10:05,556 -  step: 500  loss: -4.0000  grad_norm:  0.4399  memory: 15.27GiB(32.13%)  tps: 9,574  tflops: 74.84  mfu: 23.99%
[rank1]:2025-12-25 10:10:05,560 -  step: 500  loss: -4.0000  grad_norm:  0.4399  memory: 17.87GiB(37.61%)  tps: 9,574  tflops: 74.84  mfu: 23.99%
[rank2]:2025-12-25 10:10:05,556 -  step: 500  loss: -4.0000  grad_norm:  0.4399  memory: 13.82GiB(29.09%)  tps: 9,574  tflops: 74.84  mfu: 23.99%
[rank0]:2025-12-25 10:10:05,632 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank0/251225_1010_stage0_step500.svg
[rank0]:2025-12-25 10:10:05,673 - âœ… Frozen Ratio History of Rank 0 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank0/251225_1010_stage7_step500.svg
[rank1]:2025-12-25 10:10:05,636 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank1/251225_1010_stage1_step500.svg
[rank1]:2025-12-25 10:10:05,677 - âœ… Frozen Ratio History of Rank 1 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank1/251225_1010_stage6_step500.svg
[rank2]:2025-12-25 10:10:05,632 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank2/251225_1010_stage2_step500.svg
[rank2]:2025-12-25 10:10:05,672 - âœ… Frozen Ratio History of Rank 2 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank2/251225_1010_stage5_step500.svg
[rank3]:2025-12-25 10:10:05,902 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/pipeline_schedule/251225_1010_step500_rank3.svg
[rank3]:			> Batch Time: 804.27 ms, GPU Bubble Ratio: 28.33%, 40.26%, 47.05%, 50.56%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-8-33ms      | [S0,MB4,F]  33-8-41ms      | [S0,MB5,F]  42-9-51ms      | [S0,MB6,F]  51-8-60ms      | [S7,MB0,F]  112-16-129ms   | [S7,MB0,BI] 141-32-174ms   | [S7,MB0,BW] 174-25-199ms   | [S7,MB1,F]  200-16-217ms   | [S7,MB1,BI] 228-34-263ms   | [S7,MB1,BW] 263-0-263ms    | [S7,MB2,F]  263-18-281ms   | [S7,MB2,BI] 294-35-329ms   | [S7,MB2,BW] 329-0-329ms    | [S7,MB3,F]  329-18-348ms   | [S7,MB3,BI] 360-35-395ms   | [S7,MB3,BW] 396-0-396ms    | [S0,MB7,F]  396-10-406ms   | [S0,MB0,B]  406-0-406ms    | [S7,MB4,F]  413-18-432ms   | [S7,MB4,BI] 444-34-478ms   | [S7,MB4,BW] 478-0-478ms    | [S0,MB1,B]  485-0-485ms    | [S7,MB5,F]  489-17-506ms   | [S7,MB5,BI] 519-33-552ms   | [S7,MB5,BW] 552-0-552ms    | [S0,MB2,B]  559-0-559ms    | [S7,MB6,F]  574-15-589ms   | [S7,MB6,BI] 600-33-633ms   | [S7,MB6,BW] 633-0-633ms    | [S0,MB3,B]  640-0-640ms    | [S7,MB7,F]  654-14-668ms   | [S7,MB7,BI] 681-33-714ms   | [S7,MB7,BW] 714-5-719ms    | [S0,MB4,B]  726-20-746ms   | [S0,MB5,B]  752-23-775ms   | [S0,MB6,B]  778-21-799ms   | [S0,MB7,B]  803-1-804ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  27-10-38ms     | [S1,MB2,F]  44-10-55ms     | [S1,MB3,F]  61-10-72ms     | [S1,MB4,F]  84-10-95ms     | [S6,MB0,F]  95-10-106ms    | [S1,MB5,F]  106-13-119ms   | [S6,MB1,F]  119-8-128ms    | [S6,MB0,BI] 174-9-183ms    | [S6,MB0,BW] 183-10-194ms   | [S6,MB2,F]  193-7-201ms    | [S6,MB1,BI] 263-9-272ms    | [S6,MB1,BW] 272-10-282ms   | [S6,MB3,F]  282-7-290ms    | [S6,MB2,BI] 329-9-338ms    | [S6,MB2,BW] 338-10-349ms   | [S1,MB6,F]  349-10-360ms   | [S1,MB0,BI] 360-15-376ms   | [S1,MB0,BW] 376-0-376ms    | [S6,MB4,F]  376-7-384ms    | [S6,MB3,BI] 395-11-407ms   | [S6,MB3,BW] 407-11-419ms   | [S1,MB7,F]  419-11-430ms   | [S1,MB1,BI] 430-16-446ms   | [S1,MB1,BW] 447-8-455ms    | [S6,MB5,F]  455-8-463ms    | [S6,MB4,BI] 478-12-490ms   | [S6,MB4,BW] 490-11-501ms   | [S1,MB2,BI] 501-14-516ms   | [S1,MB2,BW] 516-13-530ms   | [S6,MB6,F]  559-7-566ms    | [S6,MB5,BI] 566-10-577ms   | [S6,MB5,BW] 577-10-587ms   | [S1,MB3,BI] 587-14-602ms   | [S1,MB3,BW] 602-11-613ms   | [S6,MB7,F]  639-7-647ms    | [S6,MB6,BI] 647-10-657ms   | [S6,MB6,BW] 657-10-668ms   | [S1,MB4,BI] 668-14-683ms   | [S6,MB7,BI] 714-10-725ms   | [S1,MB5,BI] 725-15-740ms   | [S1,MB4,BW] 740-8-748ms    | [S1,MB6,BI] 753-14-768ms   | [S1,MB5,BW] 767-1-768ms    | [S1,MB7,BI] 777-14-792ms   | [S1,MB6,BW] 792-0-792ms    | [S6,MB7,BW] 792-1-793ms    | [S1,MB7,BW] 793-0-793ms   
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  38-7-45ms      | [S2,MB2,F]  55-7-62ms      | [S5,MB0,F]  62-9-72ms      | [S2,MB3,F]  73-9-82ms      | [S5,MB1,F]  82-7-90ms      | [S2,MB4,F]  96-10-106ms    | [S5,MB2,F]  115-8-123ms    | [S5,MB0,BI] 183-9-193ms    | [S5,MB0,BW] 193-10-203ms   | [S5,MB3,F]  203-7-211ms    | [S5,MB1,BI] 272-9-281ms    | [S5,MB1,BW] 281-11-293ms   | [S2,MB5,F]  292-7-300ms    | [S2,MB0,BI] 300-10-311ms   | [S2,MB0,BW] 310-9-320ms    | [S5,MB4,F]  320-7-328ms    | [S5,MB2,BI] 338-10-349ms   | [S5,MB2,BW] 349-10-360ms   | [S2,MB6,F]  361-10-371ms   | [S2,MB1,BI] 373-11-384ms   | [S2,MB1,BW] 384-10-394ms   | [S5,MB5,F]  394-7-402ms    | [S5,MB3,BI] 410-11-422ms   | [S5,MB3,BW] 421-10-432ms   | [S2,MB7,F]  432-9-442ms    | [S2,MB2,BI] 443-11-454ms   | [S2,MB2,BW] 454-10-465ms   | [S5,MB6,F]  464-8-472ms    | [S5,MB4,BI] 490-11-502ms   | [S5,MB4,BW] 502-9-512ms    | [S2,MB3,BI] 561-9-571ms    | [S2,MB3,BW] 571-10-582ms   | [S5,MB7,F]  586-7-593ms    | [S5,MB5,BI] 593-9-603ms    | [S5,MB5,BW] 603-9-613ms    | [S2,MB4,BI] 642-9-652ms    | [S5,MB6,BI] 657-10-668ms   | [S2,MB5,BI] 668-10-679ms   | [S5,MB7,BI] 725-9-735ms    | [S2,MB6,BI] 735-11-746ms   | [S2,MB4,BW] 746-6-753ms    | [S2,MB7,BI] 761-9-770ms    | [S2,MB5,BW] 771-0-771ms    | [S5,MB6,BW] 771-10-781ms   | [S5,MB7,BW] 781-6-788ms    | [S2,MB6,BW] 788-0-788ms    | [S2,MB7,BW] 788-0-788ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-7-37ms      | [S4,MB0,F]  37-8-45ms      | [S3,MB1,F]  46-8-54ms      | [S4,MB1,F]  54-7-62ms      | [S3,MB2,F]  63-7-71ms      | [S4,MB2,F]  71-7-78ms      | [S3,MB3,F]  98-7-105ms     | [S4,MB3,F]  105-8-113ms    | [S4,MB0,BI] 193-9-202ms    | [S4,MB0,BW] 202-9-212ms    | [S3,MB4,F]  211-7-219ms    | [S3,MB0,BI] 219-9-228ms    | [S3,MB0,BW] 228-9-238ms    | [S4,MB4,F]  238-8-246ms    | [S4,MB1,BI] 282-10-292ms   | [S4,MB1,BW] 292-10-302ms   | [S3,MB5,F]  302-8-310ms    | [S3,MB1,BI] 310-9-320ms    | [S3,MB1,BW] 320-9-330ms    | [S4,MB5,F]  330-7-338ms    | [S4,MB2,BI] 366-11-377ms   | [S4,MB2,BW] 377-9-387ms    | [S3,MB6,F]  387-7-395ms    | [S3,MB2,BI] 395-9-404ms    | [S3,MB2,BW] 404-10-414ms   | [S4,MB6,F]  414-8-423ms    | [S4,MB3,BI] 436-12-449ms   | [S4,MB3,BW] 449-9-458ms    | [S3,MB7,F]  458-7-466ms    | [S3,MB3,BI] 466-9-476ms    | [S3,MB3,BW] 476-10-486ms   | [S4,MB7,F]  486-8-495ms    | [S4,MB4,BI] 555-10-566ms   | [S4,MB4,BW] 566-9-575ms    | [S3,MB4,BI] 575-10-586ms   | [S4,MB5,BI] 636-10-646ms   | [S3,MB5,BI] 647-9-656ms    | [S4,MB6,BI] 669-9-678ms    | [S3,MB6,BI] 678-9-687ms    | [S4,MB7,BI] 736-9-745ms    | [S3,MB7,BI] 746-9-755ms    | [S3,MB4,BW] 755-0-755ms    | [S4,MB5,BW] 755-3-758ms    | [S4,MB6,BW] 759-0-759ms    | [S4,MB7,BW] 759-0-759ms    | [S3,MB5,BW] 759-0-759ms    | [S3,MB6,BW] 759-9-769ms    | [S3,MB7,BW] 768-9-778ms   
[rank3]:2025-12-25 10:10:05,942 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank3/251225_1010_stage3_step500.svg
[rank3]:2025-12-25 10:10:05,982 - âœ… Frozen Ratio History of Rank 3 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank3/251225_1010_stage4_step500.svg
[rank0]:2025-12-25 10:10:06,218 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251225_1010_stage0.svg
[rank1]:2025-12-25 10:10:06,228 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251225_1010_stage1.svg
[rank2]:2025-12-25 10:10:06,226 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251225_1010_stage2.svg
[rank3]:2025-12-25 10:10:06,546 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251225_1010_stage3.svg
[rank0]:2025-12-25 10:10:06,780 - âœ… Scatter Plot of Stage 7 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251225_1010_stage7.svg
[rank1]:2025-12-25 10:10:06,781 - âœ… Scatter Plot of Stage 6 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251225_1010_stage6.svg
[rank2]:2025-12-25 10:10:06,780 - âœ… Scatter Plot of Stage 5 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251225_1010_stage5.svg
[rank3]:2025-12-25 10:10:07,108 - âœ… Scatter Plot of Stage 4 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251225_1010_stage4.svg
[rank0]:2025-12-25 10:12:54,267 - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-12-25 10:12:58,051 - Avg. fwd time: 8.3292 / Avg. bwd-weight time: 8.1070 / Avg. bwd-input time: 10.2394 / Avg. batch time: 829.9628 (ms) / GPU bubble ratio: 48.57%
[rank2]:2025-12-25 10:12:58,104 -  step: 550  loss: -4.0000  grad_norm:  0.1530  memory: 13.82GiB(29.09%)  tps: 9,495  tflops: 74.23  mfu: 23.79%
[rank1]:2025-12-25 10:12:58,047 - Avg. fwd time: 9.7871 / Avg. bwd-weight time: 8.2822 / Avg. bwd-input time: 12.5876 / Avg. batch time: 851.2920 (ms) / GPU bubble ratio: 42.38%
[rank1]:2025-12-25 10:12:58,107 -  step: 550  loss: -4.0000  grad_norm:  0.1530  memory: 17.87GiB(37.61%)  tps: 9,495  tflops: 74.23  mfu: 23.79%
[rank3]:2025-12-25 10:12:58,041 - Avg. fwd time: 7.8537 / Avg. bwd-weight time: 7.4041 / Avg. bwd-input time: 9.9084 / Avg. batch time: 814.8370 (ms) / GPU bubble ratio: 50.58%
[rank3]:2025-12-25 10:12:58,104 -  step: 550  loss: -4.0000  grad_norm:  0.1530  memory: 15.27GiB(32.13%)  tps: 9,495  tflops: 74.23  mfu: 23.79%
[rank0]:2025-12-25 10:12:58,058 - Avg. fwd time: 13.1858 / Avg. full-bwd time: 13.0324 (Avg. bwd-weight time: 10.4793 / Avg. bwd-input time: 34.1438) / Avg. batch time: 875.8659 (ms) / GPU bubble ratio: 23.25%
[rank0]:2025-12-25 10:12:58,131 -  step: 550  loss:  0.2275  grad_norm:  0.1530  memory: 36.24GiB(76.29%)  tps: 9,495  tflops: 74.23  mfu: 23.79%
[rank0]:2025-12-25 10:15:45,018 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-25 10:15:48,932 - Avg. fwd time: 13.1761 / Avg. full-bwd time: 12.7200 (Avg. bwd-weight time: 10.1031 / Avg. bwd-input time: 34.1274) / Avg. batch time: 870.6955 (ms) / GPU bubble ratio: 23.46%
[rank2]:2025-12-25 10:15:48,930 - Avg. fwd time: 8.3330 / Avg. bwd-weight time: 8.0939 / Avg. bwd-input time: 10.2463 / Avg. batch time: 824.8946 (ms) / GPU bubble ratio: 48.26%
[rank3]:2025-12-25 10:15:48,926 - Avg. fwd time: 7.8563 / Avg. bwd-weight time: 7.3766 / Avg. bwd-input time: 9.9155 / Avg. batch time: 809.6250 (ms) / GPU bubble ratio: 50.30%
[rank1]:2025-12-25 10:15:48,932 - Avg. fwd time: 9.7847 / Avg. bwd-weight time: 8.2185 / Avg. bwd-input time: 12.5964 / Avg. batch time: 845.9349 (ms) / GPU bubble ratio: 42.12%
[rank0]:2025-12-25 10:15:49,003 -  step: 600  loss:  0.2242  grad_norm:  0.5478  memory: 36.24GiB(76.29%)  tps: 9,589  tflops: 74.96  mfu: 24.03%
[rank0]:2025-12-25 10:15:49,056 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank0/251225_1015_stage0_step600.svg
[rank2]:2025-12-25 10:15:48,977 -  step: 600  loss: -4.0000  grad_norm:  0.5478  memory: 13.82GiB(29.09%)  tps: 9,588  tflops: 74.96  mfu: 24.02%
[rank2]:2025-12-25 10:15:49,055 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank2/251225_1015_stage2_step600.svg
[rank3]:2025-12-25 10:15:48,977 -  step: 600  loss: -4.0000  grad_norm:  0.5478  memory: 15.27GiB(32.13%)  tps: 9,588  tflops: 74.96  mfu: 24.02%
[rank1]:2025-12-25 10:15:48,980 -  step: 600  loss: -4.0000  grad_norm:  0.5478  memory: 17.87GiB(37.61%)  tps: 9,588  tflops: 74.96  mfu: 24.02%
[rank1]:2025-12-25 10:15:49,057 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank1/251225_1015_stage1_step600.svg
[rank0]:2025-12-25 10:15:49,098 - âœ… Frozen Ratio History of Rank 0 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank0/251225_1015_stage7_step600.svg
[rank2]:2025-12-25 10:15:49,096 - âœ… Frozen Ratio History of Rank 2 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank2/251225_1015_stage5_step600.svg
[rank1]:2025-12-25 10:15:49,099 - âœ… Frozen Ratio History of Rank 1 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank1/251225_1015_stage6_step600.svg
[rank3]:2025-12-25 10:15:49,320 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/pipeline_schedule/251225_1015_step600_rank3.svg
[rank3]:			> Batch Time: 816.62 ms, GPU Bubble Ratio: 25.05%, 41.53%, 47.80%, 51.05%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-8-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-8-34ms      | [S0,MB4,F]  34-8-42ms      | [S0,MB5,F]  43-9-52ms      | [S0,MB6,F]  53-9-62ms      | [S7,MB0,F]  113-17-130ms   | [S7,MB0,BI] 142-32-174ms   | [S7,MB0,BW] 174-25-200ms   | [S7,MB1,F]  200-16-216ms   | [S7,MB1,BI] 228-34-262ms   | [S7,MB1,BW] 263-0-263ms    | [S7,MB2,F]  263-18-281ms   | [S7,MB2,BI] 294-35-329ms   | [S7,MB2,BW] 329-0-329ms    | [S7,MB3,F]  329-18-348ms   | [S7,MB3,BI] 360-35-396ms   | [S7,MB3,BW] 396-0-396ms    | [S0,MB7,F]  396-10-406ms   | [S0,MB0,B]  406-0-406ms    | [S7,MB4,F]  413-18-432ms   | [S7,MB4,BI] 444-34-478ms   | [S7,MB4,BW] 478-0-478ms    | [S0,MB1,B]  485-0-485ms    | [S7,MB5,F]  489-17-507ms   | [S7,MB5,BI] 520-33-553ms   | [S7,MB5,BW] 553-0-553ms    | [S0,MB2,B]  559-0-559ms    | [S7,MB6,F]  574-15-589ms   | [S7,MB6,BI] 600-33-633ms   | [S7,MB6,BW] 633-0-633ms    | [S0,MB3,B]  640-0-640ms    | [S7,MB7,F]  654-15-669ms   | [S7,MB7,BI] 681-33-714ms   | [S7,MB7,BW] 713-27-740ms   | [S0,MB4,B]  739-18-757ms   | [S0,MB5,B]  758-25-783ms   | [S0,MB6,B]  783-23-807ms   | [S0,MB7,B]  807-9-816ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-12-21ms      | [S1,MB1,F]  27-10-38ms     | [S1,MB2,F]  44-10-55ms     | [S1,MB3,F]  62-10-73ms     | [S1,MB4,F]  85-10-96ms     | [S6,MB0,F]  96-10-106ms    | [S1,MB5,F]  106-13-119ms   | [S6,MB1,F]  119-8-128ms    | [S6,MB0,BI] 174-9-184ms    | [S6,MB0,BW] 184-10-194ms   | [S6,MB2,F]  194-7-201ms    | [S6,MB1,BI] 263-9-272ms    | [S6,MB1,BW] 272-10-282ms   | [S6,MB3,F]  282-7-290ms    | [S6,MB2,BI] 329-9-338ms    | [S6,MB2,BW] 338-10-349ms   | [S1,MB6,F]  349-10-360ms   | [S1,MB0,BI] 360-15-376ms   | [S1,MB0,BW] 376-0-376ms    | [S6,MB4,F]  376-7-384ms    | [S6,MB3,BI] 396-11-407ms   | [S6,MB3,BW] 407-11-419ms   | [S1,MB7,F]  419-11-430ms   | [S1,MB1,BI] 430-16-446ms   | [S1,MB1,BW] 446-7-453ms    | [S6,MB5,F]  454-8-462ms    | [S6,MB4,BI] 478-12-490ms   | [S6,MB4,BW] 490-11-501ms   | [S1,MB2,BI] 501-14-515ms   | [S1,MB2,BW] 516-11-527ms   | [S6,MB6,F]  559-7-566ms    | [S6,MB5,BI] 566-10-576ms   | [S6,MB5,BW] 576-10-587ms   | [S1,MB3,BI] 587-14-601ms   | [S1,MB3,BW] 602-10-612ms   | [S6,MB7,F]  639-7-646ms    | [S6,MB6,BI] 647-10-657ms   | [S6,MB6,BW] 657-10-667ms   | [S1,MB4,BI] 668-14-682ms   | [S6,MB7,BI] 714-10-724ms   | [S1,MB5,BI] 725-15-740ms   | [S1,MB4,BW] 740-6-746ms    | [S1,MB6,BI] 755-14-769ms   | [S1,MB5,BW] 769-3-772ms    | [S1,MB7,BI] 780-14-794ms   | [S1,MB6,BW] 794-0-794ms    | [S6,MB7,BW] 794-3-797ms    | [S1,MB7,BW] 798-0-798ms   
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-8-29ms      | [S2,MB1,F]  38-7-45ms      | [S2,MB2,F]  55-7-63ms      | [S5,MB0,F]  63-9-72ms      | [S2,MB3,F]  73-9-83ms      | [S5,MB1,F]  83-7-90ms      | [S2,MB4,F]  96-10-106ms    | [S5,MB2,F]  115-8-124ms    | [S5,MB0,BI] 184-9-193ms    | [S5,MB0,BW] 193-10-204ms   | [S5,MB3,F]  203-7-211ms    | [S5,MB1,BI] 272-9-281ms    | [S5,MB1,BW] 281-11-292ms   | [S2,MB5,F]  292-7-300ms    | [S2,MB0,BI] 300-10-310ms   | [S2,MB0,BW] 311-9-321ms    | [S5,MB4,F]  320-7-328ms    | [S5,MB2,BI] 338-10-349ms   | [S5,MB2,BW] 349-10-359ms   | [S2,MB6,F]  361-10-371ms   | [S2,MB1,BI] 372-11-383ms   | [S2,MB1,BW] 383-10-394ms   | [S5,MB5,F]  394-7-402ms    | [S5,MB3,BI] 411-11-422ms   | [S5,MB3,BW] 422-10-432ms   | [S2,MB7,F]  432-10-442ms   | [S2,MB2,BI] 444-11-455ms   | [S2,MB2,BW] 455-10-465ms   | [S5,MB6,F]  465-7-473ms    | [S5,MB4,BI] 490-11-501ms   | [S5,MB4,BW] 502-9-512ms    | [S2,MB3,BI] 562-9-571ms    | [S2,MB3,BW] 572-10-582ms   | [S5,MB7,F]  586-7-594ms    | [S5,MB5,BI] 594-9-603ms    | [S5,MB5,BW] 603-9-613ms    | [S2,MB4,BI] 642-9-652ms    | [S5,MB6,BI] 657-10-668ms   | [S2,MB5,BI] 668-10-678ms   | [S5,MB7,BI] 727-9-736ms    | [S2,MB6,BI] 736-11-748ms   | [S2,MB4,BW] 748-6-754ms    | [S2,MB7,BI] 763-9-773ms    | [S2,MB5,BW] 773-0-773ms    | [S5,MB6,BW] 773-10-784ms   | [S5,MB7,BW] 784-7-792ms    | [S2,MB6,BW] 792-0-792ms    | [S2,MB7,BW] 792-0-792ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-8-37ms      | [S4,MB0,F]  37-8-45ms      | [S3,MB1,F]  46-8-54ms      | [S4,MB1,F]  54-7-62ms      | [S3,MB2,F]  63-7-71ms      | [S4,MB2,F]  71-7-79ms      | [S3,MB3,F]  98-7-106ms     | [S4,MB3,F]  106-8-114ms    | [S4,MB0,BI] 193-9-203ms    | [S4,MB0,BW] 203-9-212ms    | [S3,MB4,F]  212-7-219ms    | [S3,MB0,BI] 219-9-228ms    | [S3,MB0,BW] 229-9-238ms    | [S4,MB4,F]  238-8-246ms    | [S4,MB1,BI] 282-10-292ms   | [S4,MB1,BW] 292-10-302ms   | [S3,MB5,F]  302-8-310ms    | [S3,MB1,BI] 310-9-320ms    | [S3,MB1,BW] 320-9-330ms    | [S4,MB5,F]  330-7-338ms    | [S4,MB2,BI] 366-11-377ms   | [S4,MB2,BW] 377-9-387ms    | [S3,MB6,F]  387-7-394ms    | [S3,MB2,BI] 394-9-404ms    | [S3,MB2,BW] 404-9-414ms    | [S4,MB6,F]  414-8-422ms    | [S4,MB3,BI] 437-12-449ms   | [S4,MB3,BW] 449-9-459ms    | [S3,MB7,F]  459-7-467ms    | [S3,MB3,BI] 466-9-476ms    | [S3,MB3,BW] 476-10-487ms   | [S4,MB7,F]  487-8-495ms    | [S4,MB4,BI] 555-10-566ms   | [S4,MB4,BW] 566-9-576ms    | [S3,MB4,BI] 575-10-586ms   | [S4,MB5,BI] 635-10-646ms   | [S3,MB5,BI] 646-9-655ms    | [S4,MB6,BI] 668-9-677ms    | [S3,MB6,BI] 677-9-687ms    | [S4,MB7,BI] 739-9-748ms    | [S3,MB7,BI] 748-9-757ms    | [S3,MB4,BW] 757-0-757ms    | [S4,MB5,BW] 757-5-763ms    | [S4,MB6,BW] 763-0-763ms    | [S4,MB7,BW] 763-0-763ms    | [S3,MB5,BW] 763-0-763ms    | [S3,MB6,BW] 763-9-772ms    | [S3,MB7,BW] 773-9-783ms   
[rank3]:2025-12-25 10:15:49,361 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank3/251225_1015_stage3_step600.svg
[rank3]:2025-12-25 10:15:49,403 - âœ… Frozen Ratio History of Rank 3 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank3/251225_1015_stage4_step600.svg
[rank0]:2025-12-25 10:15:49,772 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251225_1015_stage0.svg
[rank2]:2025-12-25 10:15:49,775 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251225_1015_stage2.svg
[rank1]:2025-12-25 10:15:49,776 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251225_1015_stage1.svg
[rank3]:2025-12-25 10:15:50,106 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251225_1015_stage3.svg
[rank0]:2025-12-25 10:15:50,474 - âœ… Scatter Plot of Stage 7 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251225_1015_stage7.svg
[rank1]:2025-12-25 10:15:50,459 - âœ… Scatter Plot of Stage 6 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251225_1015_stage6.svg
[rank2]:2025-12-25 10:15:50,464 - âœ… Scatter Plot of Stage 5 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251225_1015_stage5.svg
[rank3]:2025-12-25 10:15:50,775 - âœ… Scatter Plot of Stage 4 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251225_1015_stage4.svg
[rank0]:2025-12-25 10:18:37,384 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-25 10:18:41,154 - Avg. fwd time: 7.8593 / Avg. bwd-weight time: 7.3559 / Avg. bwd-input time: 9.9223 / Avg. batch time: 805.5988 (ms) / GPU bubble ratio: 50.07%
[rank2]:2025-12-25 10:18:41,159 - Avg. fwd time: 8.3352 / Avg. bwd-weight time: 8.0831 / Avg. bwd-input time: 10.2516 / Avg. batch time: 821.0594 (ms) / GPU bubble ratio: 48.03%
[rank1]:2025-12-25 10:18:41,162 - Avg. fwd time: 9.7832 / Avg. bwd-weight time: 8.1528 / Avg. bwd-input time: 12.6011 / Avg. batch time: 841.8405 (ms) / GPU bubble ratio: 41.96%
[rank0]:2025-12-25 10:18:41,164 - Avg. fwd time: 13.1625 / Avg. full-bwd time: 12.3671 (Avg. bwd-weight time: 9.7765 / Avg. bwd-input time: 34.1119) / Avg. batch time: 866.3231 (ms) / GPU bubble ratio: 23.74%
[rank2]:2025-12-25 10:18:41,209 -  step: 650  loss: -4.0000  grad_norm:  0.1182  memory: 13.82GiB(29.09%)  tps: 9,513  tflops: 74.37  mfu: 23.84%
[rank3]:2025-12-25 10:18:41,209 -  step: 650  loss: -4.0000  grad_norm:  0.1182  memory: 15.27GiB(32.13%)  tps: 9,513  tflops: 74.37  mfu: 23.84%
[rank1]:2025-12-25 10:18:41,213 -  step: 650  loss: -4.0000  grad_norm:  0.1182  memory: 17.87GiB(37.61%)  tps: 9,513  tflops: 74.37  mfu: 23.84%
[rank0]:2025-12-25 10:18:41,232 -  step: 650  loss:  0.2320  grad_norm:  0.1182  memory: 36.24GiB(76.29%)  tps: 9,513  tflops: 74.37  mfu: 23.84%
[rank0]:2025-12-25 10:21:27,296 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-25 10:21:31,117 - Avg. fwd time: 7.8621 / Avg. bwd-weight time: 7.3376 / Avg. bwd-input time: 9.9279 / Avg. batch time: 801.9286 (ms) / GPU bubble ratio: 49.87%
[rank2]:2025-12-25 10:21:31,123 - Avg. fwd time: 8.3371 / Avg. bwd-weight time: 8.0746 / Avg. bwd-input time: 10.2555 / Avg. batch time: 817.4894 (ms) / GPU bubble ratio: 47.81%
[rank0]:2025-12-25 10:21:31,137 - Avg. fwd time: 13.1541 / Avg. full-bwd time: 12.0856 (Avg. bwd-weight time: 9.4735 / Avg. bwd-input time: 34.1000) / Avg. batch time: 862.2988 (ms) / GPU bubble ratio: 23.95%
[rank1]:2025-12-25 10:21:31,123 - Avg. fwd time: 9.7822 / Avg. bwd-weight time: 8.1046 / Avg. bwd-input time: 12.6070 / Avg. batch time: 838.0468 (ms) / GPU bubble ratio: 41.78%
[rank3]:2025-12-25 10:21:31,183 -  step: 700  loss: -4.0000  grad_norm:  0.1646  memory: 15.27GiB(32.13%)  tps: 9,639  tflops: 75.35  mfu: 24.15%
[rank2]:2025-12-25 10:21:31,183 -  step: 700  loss: -4.0000  grad_norm:  0.1646  memory: 13.82GiB(29.09%)  tps: 9,639  tflops: 75.35  mfu: 24.15%
[rank0]:2025-12-25 10:21:31,208 -  step: 700  loss:  0.1920  grad_norm:  0.1646  memory: 36.24GiB(76.29%)  tps: 9,639  tflops: 75.35  mfu: 24.15%
[rank1]:2025-12-25 10:21:31,186 -  step: 700  loss: -4.0000  grad_norm:  0.1646  memory: 17.87GiB(37.61%)  tps: 9,639  tflops: 75.35  mfu: 24.15%
[rank2]:2025-12-25 10:21:31,261 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank2/251225_1021_stage2_step700.svg
[rank2]:2025-12-25 10:21:31,304 - âœ… Frozen Ratio History of Rank 2 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank2/251225_1021_stage5_step700.svg
[rank0]:2025-12-25 10:21:31,261 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank0/251225_1021_stage0_step700.svg
[rank0]:2025-12-25 10:21:31,310 - âœ… Frozen Ratio History of Rank 0 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank0/251225_1021_stage7_step700.svg
[rank1]:2025-12-25 10:21:31,262 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank1/251225_1021_stage1_step700.svg
[rank1]:2025-12-25 10:21:31,305 - âœ… Frozen Ratio History of Rank 1 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank1/251225_1021_stage6_step700.svg
[rank3]:2025-12-25 10:21:31,529 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/pipeline_schedule/251225_1021_step700_rank3.svg
[rank3]:			> Batch Time: 804.73 ms, GPU Bubble Ratio: 28.93%, 40.49%, 47.12%, 50.16%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  24-8-33ms      | [S0,MB4,F]  33-7-41ms      | [S0,MB5,F]  41-9-51ms      | [S0,MB6,F]  51-8-60ms      | [S7,MB0,F]  112-16-129ms   | [S7,MB0,BI] 141-32-174ms   | [S7,MB0,BW] 174-26-200ms   | [S7,MB1,F]  200-16-216ms   | [S7,MB1,BI] 229-34-263ms   | [S7,MB1,BW] 263-0-263ms    | [S7,MB2,F]  263-17-281ms   | [S7,MB2,BI] 294-35-330ms   | [S7,MB2,BW] 329-0-329ms    | [S7,MB3,F]  329-19-348ms   | [S7,MB3,BI] 361-35-396ms   | [S7,MB3,BW] 396-0-396ms    | [S0,MB7,F]  396-10-406ms   | [S0,MB0,B]  406-0-406ms    | [S7,MB4,F]  413-18-432ms   | [S7,MB4,BI] 443-33-477ms   | [S7,MB4,BW] 477-0-477ms    | [S0,MB1,B]  484-0-484ms    | [S7,MB5,F]  488-17-506ms   | [S7,MB5,BI] 518-33-551ms   | [S7,MB5,BW] 552-0-552ms    | [S0,MB2,B]  559-0-559ms    | [S7,MB6,F]  573-15-588ms   | [S7,MB6,BI] 600-33-633ms   | [S7,MB6,BW] 634-0-634ms    | [S0,MB3,B]  640-0-640ms    | [S7,MB7,F]  655-15-670ms   | [S7,MB7,BI] 682-33-715ms   | [S7,MB7,BW] 715-5-720ms    | [S0,MB4,B]  723-12-735ms   | [S0,MB5,B]  749-23-772ms   | [S0,MB6,B]  776-20-797ms   | [S0,MB7,B]  801-3-804ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  27-10-38ms     | [S1,MB2,F]  44-10-55ms     | [S1,MB3,F]  61-10-72ms     | [S1,MB4,F]  84-10-95ms     | [S6,MB0,F]  95-10-106ms    | [S1,MB5,F]  106-13-119ms   | [S6,MB1,F]  119-8-127ms    | [S6,MB0,BI] 174-9-183ms    | [S6,MB0,BW] 183-10-194ms   | [S6,MB2,F]  194-7-201ms    | [S6,MB1,BI] 263-9-272ms    | [S6,MB1,BW] 272-10-283ms   | [S6,MB3,F]  283-7-290ms    | [S6,MB2,BI] 329-9-338ms    | [S6,MB2,BW] 338-10-349ms   | [S1,MB6,F]  349-10-360ms   | [S1,MB0,BI] 360-15-376ms   | [S1,MB0,BW] 376-0-376ms    | [S6,MB4,F]  376-8-384ms    | [S6,MB3,BI] 396-11-407ms   | [S6,MB3,BW] 407-11-419ms   | [S1,MB7,F]  419-11-430ms   | [S1,MB1,BI] 430-16-446ms   | [S1,MB1,BW] 447-6-453ms    | [S6,MB5,F]  453-8-462ms    | [S6,MB4,BI] 477-12-489ms   | [S6,MB4,BW] 489-10-500ms   | [S1,MB2,BI] 501-14-515ms   | [S1,MB2,BW] 515-13-528ms   | [S6,MB6,F]  558-7-566ms    | [S6,MB5,BI] 565-10-576ms   | [S6,MB5,BW] 576-10-586ms   | [S1,MB3,BI] 586-14-601ms   | [S1,MB3,BW] 601-12-614ms   | [S6,MB7,F]  640-7-647ms    | [S6,MB6,BI] 647-10-658ms   | [S6,MB6,BW] 658-10-669ms   | [S1,MB4,BI] 669-14-683ms   | [S6,MB7,BI] 715-10-725ms   | [S1,MB5,BI] 725-14-740ms   | [S1,MB4,BW] 740-6-747ms    | [S1,MB6,BI] 754-14-768ms   | [S1,MB5,BW] 768-3-771ms    | [S1,MB7,BI] 779-14-793ms   | [S1,MB6,BW] 793-0-793ms    | [S6,MB7,BW] 793-0-793ms    | [S1,MB7,BW] 794-0-794ms   
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  38-7-45ms      | [S2,MB2,F]  55-7-62ms      | [S5,MB0,F]  62-9-72ms      | [S2,MB3,F]  73-9-82ms      | [S5,MB1,F]  82-7-90ms      | [S2,MB4,F]  96-10-106ms    | [S5,MB2,F]  114-8-123ms    | [S5,MB0,BI] 184-9-193ms    | [S5,MB0,BW] 193-10-203ms   | [S5,MB3,F]  203-7-211ms    | [S5,MB1,BI] 273-9-282ms    | [S5,MB1,BW] 282-11-293ms   | [S2,MB5,F]  293-7-300ms    | [S2,MB0,BI] 300-10-311ms   | [S2,MB0,BW] 311-9-321ms    | [S5,MB4,F]  321-7-328ms    | [S5,MB2,BI] 338-10-349ms   | [S5,MB2,BW] 349-10-360ms   | [S2,MB6,F]  361-9-371ms    | [S2,MB1,BI] 372-11-383ms   | [S2,MB1,BW] 384-10-394ms   | [S5,MB5,F]  394-7-402ms    | [S5,MB3,BI] 410-10-421ms   | [S5,MB3,BW] 421-10-432ms   | [S2,MB7,F]  433-9-443ms    | [S2,MB2,BI] 443-11-454ms   | [S2,MB2,BW] 454-10-465ms   | [S5,MB6,F]  465-7-473ms    | [S5,MB4,BI] 490-10-501ms   | [S5,MB4,BW] 501-9-511ms    | [S2,MB3,BI] 561-9-571ms    | [S2,MB3,BW] 571-10-582ms   | [S5,MB7,F]  585-7-593ms    | [S5,MB5,BI] 593-9-603ms    | [S5,MB5,BW] 602-9-612ms    | [S2,MB4,BI] 643-9-653ms    | [S5,MB6,BI] 658-10-669ms   | [S2,MB5,BI] 669-10-679ms   | [S5,MB7,BI] 726-9-736ms    | [S2,MB6,BI] 736-11-747ms   | [S2,MB4,BW] 747-7-754ms    | [S2,MB7,BI] 762-9-772ms    | [S2,MB5,BW] 772-0-772ms    | [S5,MB6,BW] 772-10-782ms   | [S5,MB7,BW] 782-6-789ms    | [S2,MB6,BW] 789-0-789ms    | [S2,MB7,BW] 789-0-789ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-7-37ms      | [S4,MB0,F]  37-8-45ms      | [S3,MB1,F]  46-8-54ms      | [S4,MB1,F]  54-7-62ms      | [S3,MB2,F]  63-7-70ms      | [S4,MB2,F]  70-7-78ms      | [S3,MB3,F]  98-7-105ms     | [S4,MB3,F]  105-8-113ms    | [S4,MB0,BI] 193-9-202ms    | [S4,MB0,BW] 202-9-212ms    | [S3,MB4,F]  211-7-219ms    | [S3,MB0,BI] 219-9-228ms    | [S3,MB0,BW] 228-9-238ms    | [S4,MB4,F]  238-8-246ms    | [S4,MB1,BI] 282-10-293ms   | [S4,MB1,BW] 293-10-303ms   | [S3,MB5,F]  303-8-311ms    | [S3,MB1,BI] 311-9-321ms    | [S3,MB1,BW] 321-9-331ms    | [S4,MB5,F]  330-7-338ms    | [S4,MB2,BI] 366-11-378ms   | [S4,MB2,BW] 378-9-387ms    | [S3,MB6,F]  387-7-394ms    | [S3,MB2,BI] 394-9-404ms    | [S3,MB2,BW] 404-9-414ms    | [S4,MB6,F]  414-8-423ms    | [S4,MB3,BI] 436-12-449ms   | [S4,MB3,BW] 449-9-458ms    | [S3,MB7,F]  458-7-466ms    | [S3,MB3,BI] 466-9-475ms    | [S3,MB3,BW] 476-10-486ms   | [S4,MB7,F]  486-8-495ms    | [S4,MB4,BI] 555-10-566ms   | [S4,MB4,BW] 566-9-575ms    | [S3,MB4,BI] 575-10-586ms   | [S4,MB5,BI] 637-10-647ms   | [S3,MB5,BI] 647-9-656ms    | [S4,MB6,BI] 669-9-678ms    | [S3,MB6,BI] 679-9-688ms    | [S4,MB7,BI] 738-9-747ms    | [S3,MB7,BI] 747-9-756ms    | [S3,MB4,BW] 756-0-756ms    | [S4,MB5,BW] 756-6-763ms    | [S4,MB6,BW] 763-0-763ms    | [S4,MB7,BW] 763-0-763ms    | [S3,MB5,BW] 763-0-763ms    | [S3,MB6,BW] 763-9-773ms    | [S3,MB7,BW] 773-9-782ms   
[rank3]:2025-12-25 10:21:31,572 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank3/251225_1021_stage3_step700.svg
[rank3]:2025-12-25 10:21:31,616 - âœ… Frozen Ratio History of Rank 3 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank3/251225_1021_stage4_step700.svg
[rank2]:2025-12-25 10:21:32,120 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251225_1021_stage2.svg
[rank0]:2025-12-25 10:21:32,132 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251225_1021_stage0.svg
[rank1]:2025-12-25 10:21:32,127 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251225_1021_stage1.svg
[rank3]:2025-12-25 10:21:32,441 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251225_1021_stage3.svg
[rank2]:2025-12-25 10:21:32,931 - âœ… Scatter Plot of Stage 5 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251225_1021_stage5.svg
[rank0]:2025-12-25 10:21:32,971 - âœ… Scatter Plot of Stage 7 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251225_1021_stage7.svg
[rank1]:2025-12-25 10:21:32,945 - âœ… Scatter Plot of Stage 6 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251225_1021_stage6.svg
[rank3]:2025-12-25 10:21:33,231 - âœ… Scatter Plot of Stage 4 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/afr_time_plot/251225_1021_stage4.svg
[rank0]:2025-12-25 10:24:20,088 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-25 10:24:23,969 - Avg. fwd time: 7.8643 / Avg. bwd-weight time: 7.3243 / Avg. bwd-input time: 9.9326 / Avg. batch time: 798.7977 (ms) / GPU bubble ratio: 49.68%
[rank3]:2025-12-25 10:24:24,044 -  step: 750  loss: -4.0000  grad_norm:  0.2044  memory: 15.27GiB(32.13%)  tps: 9,478  tflops: 74.10  mfu: 23.75%
[rank2]:2025-12-25 10:24:23,975 - Avg. fwd time: 8.3384 / Avg. bwd-weight time: 8.0685 / Avg. bwd-input time: 10.2584 / Avg. batch time: 814.4880 (ms) / GPU bubble ratio: 47.62%
[rank2]:2025-12-25 10:24:24,044 -  step: 750  loss: -4.0000  grad_norm:  0.2044  memory: 13.82GiB(29.09%)  tps: 9,478  tflops: 74.10  mfu: 23.75%
[rank1]:2025-12-25 10:24:23,975 - Avg. fwd time: 9.7813 / Avg. bwd-weight time: 8.0625 / Avg. bwd-input time: 12.6116 / Avg. batch time: 834.8122 (ms) / GPU bubble ratio: 41.63%
[rank1]:2025-12-25 10:24:24,046 -  step: 750  loss: -4.0000  grad_norm:  0.2044  memory: 17.87GiB(37.61%)  tps: 9,478  tflops: 74.10  mfu: 23.75%
[rank0]:2025-12-25 10:24:23,998 - Avg. fwd time: 13.1438 / Avg. full-bwd time: 11.8614 (Avg. bwd-weight time: 9.2066 / Avg. bwd-input time: 34.0902) / Avg. batch time: 859.1602 (ms) / GPU bubble ratio: 24.16%
[rank0]:2025-12-25 10:24:24,070 -  step: 750  loss:  0.2340  grad_norm:  0.2044  memory: 36.24GiB(76.29%)  tps: 9,478  tflops: 74.10  mfu: 23.75%
[rank0]:2025-12-25 10:27:12,095 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-25 10:27:15,864 - Avg. fwd time: 7.8665 / Avg. bwd-weight time: 7.3081 / Avg. bwd-input time: 9.9363 / Avg. batch time: 796.1758 (ms) / GPU bubble ratio: 49.54%
[rank2]:2025-12-25 10:27:15,870 - Avg. fwd time: 8.3395 / Avg. bwd-weight time: 8.0634 / Avg. bwd-input time: 10.2603 / Avg. batch time: 811.9567 (ms) / GPU bubble ratio: 47.46%
[rank1]:2025-12-25 10:27:15,872 - Avg. fwd time: 9.7806 / Avg. bwd-weight time: 8.0206 / Avg. bwd-input time: 12.6139 / Avg. batch time: 832.1333 (ms) / GPU bubble ratio: 41.52%
[rank0]:2025-12-25 10:27:15,877 - Avg. fwd time: 13.1388 / Avg. full-bwd time: 11.6775 (Avg. bwd-weight time: 9.0093 / Avg. bwd-input time: 34.0836) / Avg. batch time: 856.6453 (ms) / GPU bubble ratio: 24.31%
[rank3]:2025-12-25 10:27:15,922 -  step: 800  loss: -4.0000  grad_norm:  0.4865  memory: 15.27GiB(32.13%)  tps: 9,532  tflops: 74.52  mfu: 23.88%
[rank3]:2025-12-25 10:27:15,922 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  0.4865  tps: 9,663  tflops: 75.54  mfu: 22.08%
[rank3]:2025-12-25 10:27:15,922 - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-12-25 10:27:15,923 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank2]:2025-12-25 10:27:15,922 -  step: 800  loss: -4.0000  grad_norm:  0.4865  memory: 13.82GiB(29.09%)  tps: 9,532  tflops: 74.52  mfu: 23.88%
[rank2]:2025-12-25 10:27:15,922 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  0.4865  tps: 9,663  tflops: 75.54  mfu: 22.08%
[rank2]:2025-12-25 10:27:15,922 - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-12-25 10:27:15,923 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank1]:2025-12-25 10:27:15,926 -  step: 800  loss: -4.0000  grad_norm:  0.4865  memory: 17.87GiB(37.61%)  tps: 9,532  tflops: 74.52  mfu: 23.88%
[rank1]:2025-12-25 10:27:15,926 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  0.4865  tps: 9,663  tflops: 75.54  mfu: 22.07%
[rank1]:2025-12-25 10:27:15,926 - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-12-25 10:27:15,927 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-25 10:27:15,948 -  step: 800  loss:  0.2385  grad_norm:  0.4865  memory: 36.24GiB(76.29%)  tps: 9,532  tflops: 74.52  mfu: 23.88%
[rank0]:2025-12-25 10:27:15,948 - â„¹ï¸ final step: 800  loss:  0.2385  grad_norm:  0.4865  tps: 9,672  tflops: 75.61  mfu: 22.21%
[rank0]:2025-12-25 10:27:15,948 - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-12-25 10:27:15,949 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-25 10:27:18,479 - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank2]:2025-12-25 10:27:18,556 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank2/251225_1027_stage2_final800.svg
[rank1]:2025-12-25 10:27:18,559 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank1/251225_1027_stage1_final800.svg
[rank1]:2025-12-25 10:27:18,607 - âœ… Frozen Ratio History of Rank 1 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank1/251225_1027_stage6_final800.svg
[rank0]:2025-12-25 10:27:18,557 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank0/251225_1027_stage0_final800.svg
[rank0]:2025-12-25 10:27:18,604 - âœ… Frozen Ratio History of Rank 0 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank0/251225_1027_stage7_final800.svg
[rank2]:2025-12-25 10:27:18,600 - âœ… Frozen Ratio History of Rank 2 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_ratio_history/rank2/251225_1027_stage5_final800.svg
[rank2]:2025-12-25 10:27:18,699 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_params_histogram/251225_1027_rank2_stage2.svg
[rank2]:	> Counts Sum: 172240, Total Sum: 414720 (41.53%), Ratio(%) per element: [42.36, 42.53, 42.53, 42.18, 43.05, 41.31, 42.36, 41.66, 44.44, 40.1, 40.45, 41.31, 39.75, 41.49, 40.62, 40.79, 40.79, 39.75]
[rank0]:2025-12-25 10:27:18,709 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_params_histogram/251225_1027_rank0_stage0.svg
[rank0]:	> Counts Sum: 339160, Total Sum: 437760 (77.48%), Ratio(%) per element: [63.36, 83.5, 83.85, 84.89, 84.02, 83.33, 83.5, 85.93, 84.2, 84.37, 72.22, 73.61, 73.61, 71.0, 72.04, 73.09, 70.83, 72.39, 72.22]
[rank2]:2025-12-25 10:27:18,709 - Destroying the purge thread.
[rank2]:[rank2]: Traceback (most recent call last):
[rank2]:[rank2]:   File "<frozen runpy>", line 198, in _run_module_as_main
[rank2]:[rank2]:   File "<frozen runpy>", line 88, in _run_code
[rank2]:[rank2]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 789, in <module>
[rank2]:[rank2]:     trainer.train()
[rank2]:[rank2]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
[rank2]:[rank2]:     return f(*args, **kwargs)
[rank2]:[rank2]:            ^^^^^^^^^^^^^^^^^^
[rank2]:[rank2]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 621, in train
[rank2]:[rank2]:     draw_charts(self.freezer, self.step, job_config)
[rank2]:[rank2]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 712, in draw_charts
[rank2]:[rank2]:     draw_elementwise_histogram(data=list(freezer.paramwise_frozen_count[s].values()), stage=s,
[rank2]:[rank2]:   File "/home/shcho/torchtitan/timelyfreeze/core/util.py", line 335, in draw_elementwise_histogram
[rank2]:[rank2]:     ax1.text(max(min(80, past_ratio - 5), 5), 0, total_count_text, ha="center", va="center", fontsize=fontsize, color="black")
[rank2]:[rank2]:                      ^^
[rank2]:[rank2]: UnboundLocalError: cannot access local variable 'past_ratio' where it is not associated with a value
[rank1]:2025-12-25 10:27:18,737 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/frozen_params_histogram/251225_1027_rank1_stage1.svg
[rank1]:	> Counts Sum: 411160, Total Sum: 622080 (66.09%), Ratio(%) per element: [71.35, 72.56, 75.0, 74.3, 73.61, 70.83, 71.0, 72.04, 72.39, 67.88, 68.4, 67.01, 66.14, 66.84, 67.36, 66.66, 68.75, 69.27, 59.89, 57.63, 58.33, 55.9, 58.5, 58.5, 58.85, 57.98, 57.46]
[rank1]:2025-12-25 10:27:18,748 - Destroying the purge thread.
[rank1]:[rank1]: Traceback (most recent call last):
[rank1]:[rank1]:   File "<frozen runpy>", line 198, in _run_module_as_main
[rank1]:[rank1]:   File "<frozen runpy>", line 88, in _run_code
[rank1]:[rank1]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 789, in <module>
[rank1]:[rank1]:     trainer.train()
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
[rank1]:[rank1]:     return f(*args, **kwargs)
[rank1]:[rank1]:            ^^^^^^^^^^^^^^^^^^
[rank1]:[rank1]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 621, in train
[rank1]:[rank1]:     draw_charts(self.freezer, self.step, job_config)
[rank1]:[rank1]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 712, in draw_charts
[rank1]:[rank1]:     draw_elementwise_histogram(data=list(freezer.paramwise_frozen_count[s].values()), stage=s,
[rank1]:[rank1]:   File "/home/shcho/torchtitan/timelyfreeze/core/util.py", line 335, in draw_elementwise_histogram
[rank1]:[rank1]:     ax1.text(max(min(80, past_ratio - 5), 5), 0, total_count_text, ha="center", va="center", fontsize=fontsize, color="black")
[rank1]:[rank1]:                      ^^
[rank1]:[rank1]: UnboundLocalError: cannot access local variable 'past_ratio' where it is not associated with a value
[rank0]:2025-12-25 10:27:18,720 - Destroying the purge thread.
[rank3]:2025-12-25 10:27:18,821 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1/pipeline_schedule/251225_1027_final800_rank3.svg
[rank3]:			> Batch Time: 816.70 ms, GPU Bubble Ratio: 25.64%, 41.20%, 47.77%, 51.05%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-8-34ms      | [S0,MB4,F]  34-8-42ms      | [S0,MB5,F]  42-9-51ms      | [S0,MB6,F]  51-8-60ms      | [S7,MB0,F]  113-17-130ms   | [S7,MB0,BI] 141-32-174ms   | [S7,MB0,BW] 174-25-200ms   | [S7,MB1,F]  200-16-217ms   | [S7,MB1,BI] 229-34-263ms   | [S7,MB1,BW] 264-0-264ms    | [S7,MB2,F]  264-18-282ms   | [S7,MB2,BI] 295-35-330ms   | [S7,MB2,BW] 330-0-330ms    | [S7,MB3,F]  330-19-349ms   | [S7,MB3,BI] 362-35-397ms   | [S7,MB3,BW] 397-0-397ms    | [S0,MB7,F]  397-10-407ms   | [S0,MB0,B]  408-0-408ms    | [S7,MB4,F]  415-18-434ms   | [S7,MB4,BI] 446-34-480ms   | [S7,MB4,BW] 480-0-480ms    | [S0,MB1,B]  487-0-487ms    | [S7,MB5,F]  491-17-508ms   | [S7,MB5,BI] 520-33-553ms   | [S7,MB5,BW] 553-0-553ms    | [S0,MB2,B]  560-0-560ms    | [S7,MB6,F]  574-15-590ms   | [S7,MB6,BI] 602-33-635ms   | [S7,MB6,BW] 635-0-635ms    | [S0,MB3,B]  642-0-642ms    | [S7,MB7,F]  656-15-671ms   | [S7,MB7,BI] 683-33-716ms   | [S7,MB7,BW] 716-26-742ms   | [S0,MB4,B]  741-17-758ms   | [S0,MB5,B]  758-24-782ms   | [S0,MB6,B]  783-23-806ms   | [S0,MB7,B]  808-8-816ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-21ms      | [S1,MB1,F]  27-10-38ms     | [S1,MB2,F]  44-10-55ms     | [S1,MB3,F]  62-10-73ms     | [S1,MB4,F]  85-10-96ms     | [S6,MB0,F]  96-10-106ms    | [S1,MB5,F]  106-13-119ms   | [S6,MB1,F]  119-8-128ms    | [S6,MB0,BI] 174-9-184ms    | [S6,MB0,BW] 184-10-194ms   | [S6,MB2,F]  194-7-201ms    | [S6,MB1,BI] 264-9-273ms    | [S6,MB1,BW] 273-10-283ms   | [S6,MB3,F]  283-7-290ms    | [S6,MB2,BI] 330-9-339ms    | [S6,MB2,BW] 339-10-350ms   | [S1,MB6,F]  350-10-361ms   | [S1,MB0,BI] 361-15-377ms   | [S1,MB0,BW] 377-0-377ms    | [S6,MB4,F]  377-7-385ms    | [S6,MB3,BI] 397-11-408ms   | [S6,MB3,BW] 408-11-420ms   | [S1,MB7,F]  420-11-432ms   | [S1,MB1,BI] 432-16-448ms   | [S1,MB1,BW] 448-7-455ms    | [S6,MB5,F]  455-8-463ms    | [S6,MB4,BI] 480-12-492ms   | [S6,MB4,BW] 492-10-503ms   | [S1,MB2,BI] 503-14-518ms   | [S1,MB2,BW] 518-13-531ms   | [S6,MB6,F]  559-7-567ms    | [S6,MB5,BI] 567-10-577ms   | [S6,MB5,BW] 577-10-588ms   | [S1,MB3,BI] 588-14-602ms   | [S1,MB3,BW] 602-12-614ms   | [S6,MB7,F]  641-7-649ms    | [S6,MB6,BI] 649-10-659ms   | [S6,MB6,BW] 659-10-670ms   | [S1,MB4,BI] 670-14-685ms   | [S6,MB7,BI] 716-10-727ms   | [S1,MB5,BI] 729-15-744ms   | [S1,MB4,BW] 744-6-751ms    | [S1,MB6,BI] 758-14-772ms   | [S1,MB5,BW] 772-3-775ms    | [S1,MB7,BI] 782-14-797ms   | [S1,MB6,BW] 797-0-797ms    | [S6,MB7,BW] 797-3-800ms    | [S1,MB7,BW] 799-0-799ms   
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-8-29ms      | [S2,MB1,F]  38-7-45ms      | [S2,MB2,F]  55-7-63ms      | [S5,MB0,F]  63-9-72ms      | [S2,MB3,F]  73-9-83ms      | [S5,MB1,F]  83-7-90ms      | [S2,MB4,F]  96-10-106ms    | [S5,MB2,F]  115-8-123ms    | [S5,MB0,BI] 184-9-193ms    | [S5,MB0,BW] 193-10-204ms   | [S5,MB3,F]  203-7-211ms    | [S5,MB1,BI] 273-9-282ms    | [S5,MB1,BW] 282-11-293ms   | [S2,MB5,F]  293-7-301ms    | [S2,MB0,BI] 301-10-311ms   | [S2,MB0,BW] 311-9-321ms    | [S5,MB4,F]  321-7-329ms    | [S5,MB2,BI] 340-10-350ms   | [S5,MB2,BW] 351-10-361ms   | [S2,MB6,F]  362-10-372ms   | [S2,MB1,BI] 374-11-385ms   | [S2,MB1,BW] 385-10-395ms   | [S5,MB5,F]  395-7-403ms    | [S5,MB3,BI] 413-11-424ms   | [S5,MB3,BW] 424-10-435ms   | [S2,MB7,F]  435-9-444ms    | [S2,MB2,BI] 445-11-456ms   | [S2,MB2,BW] 457-10-467ms   | [S5,MB6,F]  467-7-475ms    | [S5,MB4,BI] 493-10-503ms   | [S5,MB4,BW] 504-9-513ms    | [S2,MB3,BI] 563-9-572ms    | [S2,MB3,BW] 572-10-583ms   | [S5,MB7,F]  587-7-594ms    | [S5,MB5,BI] 594-9-604ms    | [S5,MB5,BW] 604-9-614ms    | [S2,MB4,BI] 644-9-654ms    | [S5,MB6,BI] 660-10-670ms   | [S2,MB5,BI] 670-10-680ms   | [S5,MB7,BI] 731-9-740ms    | [S2,MB6,BI] 740-11-751ms   | [S2,MB4,BW] 751-7-758ms    | [S2,MB7,BI] 766-9-776ms    | [S2,MB5,BW] 776-0-776ms    | [S5,MB6,BW] 776-10-787ms   | [S5,MB7,BW] 787-7-794ms    | [S2,MB6,BW] 794-0-794ms    | [S2,MB7,BW] 794-0-794ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-8-37ms      | [S4,MB0,F]  37-8-45ms      | [S3,MB1,F]  46-8-54ms      | [S4,MB1,F]  54-7-62ms      | [S3,MB2,F]  63-7-71ms      | [S4,MB2,F]  71-7-79ms      | [S3,MB3,F]  98-7-105ms     | [S4,MB3,F]  105-8-113ms    | [S4,MB0,BI] 193-9-203ms    | [S4,MB0,BW] 202-9-212ms    | [S3,MB4,F]  212-7-219ms    | [S3,MB0,BI] 219-9-228ms    | [S3,MB0,BW] 228-9-238ms    | [S4,MB4,F]  238-7-246ms    | [S4,MB1,BI] 282-10-293ms   | [S4,MB1,BW] 293-10-303ms   | [S3,MB5,F]  303-8-311ms    | [S3,MB1,BI] 311-9-321ms    | [S3,MB1,BW] 321-9-331ms    | [S4,MB5,F]  331-7-339ms    | [S4,MB2,BI] 367-11-378ms   | [S4,MB2,BW] 378-9-388ms    | [S3,MB6,F]  388-7-395ms    | [S3,MB2,BI] 395-9-405ms    | [S3,MB2,BW] 405-9-415ms    | [S4,MB6,F]  415-8-423ms    | [S4,MB3,BI] 438-12-451ms   | [S4,MB3,BW] 451-9-461ms    | [S3,MB7,F]  461-7-468ms    | [S3,MB3,BI] 468-9-478ms    | [S3,MB3,BW] 478-10-489ms   | [S4,MB7,F]  489-8-497ms    | [S4,MB4,BI] 556-10-567ms   | [S4,MB4,BW] 567-9-576ms    | [S3,MB4,BI] 576-10-587ms   | [S4,MB5,BI] 638-10-648ms   | [S3,MB5,BI] 648-9-657ms    | [S4,MB6,BI] 670-9-680ms    | [S3,MB6,BI] 680-9-689ms    | [S4,MB7,BI] 741-9-750ms    | [S3,MB7,BI] 751-9-760ms    | [S3,MB4,BW] 760-0-760ms    | [S4,MB5,BW] 760-6-766ms    | [S4,MB6,BW] 766-0-766ms    | [S4,MB7,BW] 766-0-766ms    | [S3,MB5,BW] 766-0-766ms    | [S3,MB6,BW] 766-9-776ms    | [S3,MB7,BW] 776-9-785ms   
[rank3]:2025-12-25 10:27:18,823 - Destroying the purge thread.
[rank3]:[rank3]: Traceback (most recent call last):
[rank3]:[rank3]:   File "<frozen runpy>", line 198, in _run_module_as_main
[rank3]:[rank3]:   File "<frozen runpy>", line 88, in _run_code
[rank3]:[rank3]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 789, in <module>
[rank3]:[rank3]:     trainer.train()
[rank3]:[rank3]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
[rank3]:[rank3]:     return f(*args, **kwargs)
[rank3]:[rank3]:            ^^^^^^^^^^^^^^^^^^
[rank3]:[rank3]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 621, in train
[rank3]:[rank3]:     draw_charts(self.freezer, self.step, job_config)
[rank3]:[rank3]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 688, in draw_charts
[rank3]:[rank3]:     pipeline_schedule = schedule_pipeline(pipeline_schedule, 
[rank3]:[rank3]:                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:[rank3]:   File "/home/shcho/torchtitan/timelyfreeze/core/schedule.py", line 414, in schedule_pipeline
[rank3]:[rank3]:     assert fwd_time is None or len(fwd_time) == num_stages, f"fwd_time should have the same length as num_stages. fwd_time: {len(fwd_time)}, num_stages: {num_stages}"
[rank3]:[rank3]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:[rank3]: AssertionError: fwd_time should have the same length as num_stages. fwd_time: 4, num_stages: 8
[rank0]:wandb: updating run metadata
[rank0]:wandb: uploading history steps 16-16, summary, console lines 107-112
[rank0]:wandb: 
[rank0]:wandb: Run history:
[rank0]:wandb:      final/avg_end_to_end(s) â–
[rank0]:wandb:               final/avg_loss â–
[rank0]:wandb:             final/avg_mfu(%) â–
[rank0]:wandb:             final/avg_tflops â–
[rank0]:wandb:    final/avg_throughput(tps) â–
[rank0]:wandb:              final/grad_norm â–
[rank0]:wandb:               final/max_loss â–
[rank0]:wandb:                    grad_norm â–ˆâ–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank0]:wandb: loss_metrics/global_avg_loss â–ˆâ–ˆâ–‡â–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank0]:wandb: loss_metrics/global_max_loss â–ˆâ–ˆâ–‡â–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank0]:wandb:                          +14 ...
[rank0]:wandb: 
[rank0]:wandb: Run summary:
[rank0]:wandb:      final/avg_end_to_end(s) 3.38783
[rank0]:wandb:               final/avg_loss 0.23851
[rank0]:wandb:             final/avg_mfu(%) 22.21469
[rank0]:wandb:             final/avg_tflops 75.61332
[rank0]:wandb:    final/avg_throughput(tps) 9672.26512
[rank0]:wandb:              final/grad_norm 0.48648
[rank0]:wandb:               final/max_loss 0.23851
[rank0]:wandb:                    grad_norm 0.48648
[rank0]:wandb: loss_metrics/global_avg_loss 0.23851
[rank0]:wandb: loss_metrics/global_max_loss 0.23851
[rank0]:wandb:                          +14 ...
[rank0]:wandb: 
[rank0]:wandb: ðŸš€ View run 1224_ZBVZeroBubble_timelyauto_42_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/fvc8ead0
[rank0]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank0]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank0]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1224_ZBVZeroBubble_timelyauto_42_dm1/20251225-0939/wandb/run-20251225_093914-fvc8ead0/logs
[rank0]:Traceback (most recent call last):
[rank0]:  File "<frozen runpy>", line 198, in _run_module_as_main
[rank0]:  File "<frozen runpy>", line 88, in _run_code
[rank0]:  File "/home/shcho/torchtitan/timelyfreeze/train.py", line 789, in <module>
[rank0]:    trainer.train()
[rank0]:  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
[rank0]:    return f(*args, **kwargs)
[rank0]:           ^^^^^^^^^^^^^^^^^^
[rank0]:  File "/home/shcho/torchtitan/timelyfreeze/train.py", line 621, in train
[rank0]:    draw_charts(self.freezer, self.step, job_config)
[rank0]:  File "/home/shcho/torchtitan/timelyfreeze/train.py", line 712, in draw_charts
[rank0]:    draw_elementwise_histogram(data=list(freezer.paramwise_frozen_count[s].values()), stage=s,
[rank0]:  File "/home/shcho/torchtitan/timelyfreeze/core/util.py", line 335, in draw_elementwise_histogram
[rank0]:    ax1.text(max(min(80, past_ratio - 5), 5), 0, total_count_text, ha="center", va="center", fontsize=fontsize, color="black")
[rank0]:                     ^^
[rank0]:UnboundLocalError: cannot access local variable 'past_ratio' where it is not associated with a value
[rank0]:[rank0]: Traceback (most recent call last):
[rank0]:[rank0]:   File "<frozen runpy>", line 198, in _run_module_as_main
[rank0]:[rank0]:   File "<frozen runpy>", line 88, in _run_code
[rank0]:[rank0]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 789, in <module>
[rank0]:[rank0]:     trainer.train()
[rank0]:[rank0]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
[rank0]:[rank0]:     return f(*args, **kwargs)
[rank0]:[rank0]:            ^^^^^^^^^^^^^^^^^^
[rank0]:[rank0]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 621, in train
[rank0]:[rank0]:     draw_charts(self.freezer, self.step, job_config)
[rank0]:[rank0]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 712, in draw_charts
[rank0]:[rank0]:     draw_elementwise_histogram(data=list(freezer.paramwise_frozen_count[s].values()), stage=s,
[rank0]:[rank0]:   File "/home/shcho/torchtitan/timelyfreeze/core/util.py", line 335, in draw_elementwise_histogram
[rank0]:[rank0]:     ax1.text(max(min(80, past_ratio - 5), 5), 0, total_count_text, ha="center", va="center", fontsize=fontsize, color="black")
[rank0]:[rank0]:                      ^^
[rank0]:[rank0]: UnboundLocalError: cannot access local variable 'past_ratio' where it is not associated with a value
[rank0]:[rank0]:[W1225 10:27:20.016422356 ProcessGroupNCCL.cpp:1552] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
W1225 10:27:20.646000 922020 site-packages/torch/distributed/elastic/multiprocessing/api.py:940] Sending process 922050 closing signal SIGTERM
W1225 10:27:20.649000 922020 site-packages/torch/distributed/elastic/multiprocessing/api.py:940] Sending process 922052 closing signal SIGTERM
W1225 10:27:20.649000 922020 site-packages/torch/distributed/elastic/multiprocessing/api.py:940] Sending process 922053 closing signal SIGTERM
E1225 10:27:21.504000 922020 site-packages/torch/distributed/elastic/multiprocessing/api.py:914] failed (exitcode: 1) local_rank: 1 (pid: 922051) of binary: /data2/shcho/miniforge3/envs/llm_eval/bin/python3.11
E1225 10:27:21.524000 922020 site-packages/torch/distributed/elastic/multiprocessing/errors/error_handler.py:141] no error file defined for parent, to copy child error file (/tmp/torchelastic_6wskwl5f/9595bcd4-cfbb-44d7-b5e6-e9eeb50c57b8_ol6wv1wq/attempt_0/1/error.json)
[rank1]:Stage 1: Modules to keep: {'layers.2', 'layers.4', 'layers.3'}
[rank1]:Stage 6: Modules to keep: {'layers.13', 'layers.14'}
[rank3]:Stage 3: Modules to keep: {'layers.7', 'layers.8'}
[rank3]:Stage 4: Modules to keep: {'layers.10', 'layers.9'}
[rank2]:Stage 2: Modules to keep: {'layers.5', 'layers.6'}
[rank2]:Stage 5: Modules to keep: {'layers.11', 'layers.12'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1224.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1224_ZBVZeroBubble_timelyauto_42_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1224_ZBVZeroBubble_timelyauto_42_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1224_ZBVZeroBubble_timelyauto_42_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1224_ZBVZeroBubble_timelyauto_42_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_timelyauto_42_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1224_ZBVZeroBubble_timelyauto_42_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 42
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: ZBVZeroBubble
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 4
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 2
[rank3]:		- stages_list: [3, 4]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1224_ZBVZeroBubble_timelyauto_42_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1224_ZBVZeroBubble_timelyauto_42_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: timelyauto
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.01
[rank3]:		- percentile: 80
[rank3]:
[rank0]:Stage 0: Modules to keep: {'tok_embeddings', 'layers.1', 'layers.0'}
[rank0]:Stage 7: Modules to keep: {'output', 'layers.15', 'norm'}
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
Traceback (most recent call last):
  File "/data2/shcho/miniforge3/envs/llm_eval/bin/torchrun", line 7, in <module>
    sys.exit(main())
             ^^^^^^
  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/run.py", line 946, in main
    run(args)
  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/run.py", line 937, in run
    elastic_launch(
  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 159, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 300, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
timelyfreeze.train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2025-12-25_10:27:18
  host      : elga.kaist.ac.kr
  rank      : 0 (local_rank: 0)
  exitcode  : -15 (pid: 922050)
  error_file: /tmp/torchelastic_6wskwl5f/9595bcd4-cfbb-44d7-b5e6-e9eeb50c57b8_ol6wv1wq/attempt_0/0/error.json
  traceback : Traceback (most recent call last):
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
      return f(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^
    File "/home/shcho/torchtitan/timelyfreeze/train.py", line 621, in train
      draw_charts(self.freezer, self.step, job_config)
    File "/home/shcho/torchtitan/timelyfreeze/train.py", line 712, in draw_charts
      draw_elementwise_histogram(data=list(freezer.paramwise_frozen_count[s].values()), stage=s,
    File "/home/shcho/torchtitan/timelyfreeze/core/util.py", line 335, in draw_elementwise_histogram
      ax1.text(max(min(80, past_ratio - 5), 5), 0, total_count_text, ha="center", va="center", fontsize=fontsize, color="black")
                       ^^
  UnboundLocalError: cannot access local variable 'past_ratio' where it is not associated with a value
  
[2]:
  time      : 2025-12-25_10:27:18
  host      : elga.kaist.ac.kr
  rank      : 2 (local_rank: 2)
  exitcode  : 1 (pid: 922052)
  error_file: /tmp/torchelastic_6wskwl5f/9595bcd4-cfbb-44d7-b5e6-e9eeb50c57b8_ol6wv1wq/attempt_0/2/error.json
  traceback : Traceback (most recent call last):
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
      return f(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^
    File "/home/shcho/torchtitan/timelyfreeze/train.py", line 621, in train
      draw_charts(self.freezer, self.step, job_config)
    File "/home/shcho/torchtitan/timelyfreeze/train.py", line 712, in draw_charts
      draw_elementwise_histogram(data=list(freezer.paramwise_frozen_count[s].values()), stage=s,
    File "/home/shcho/torchtitan/timelyfreeze/core/util.py", line 335, in draw_elementwise_histogram
      ax1.text(max(min(80, past_ratio - 5), 5), 0, total_count_text, ha="center", va="center", fontsize=fontsize, color="black")
                       ^^
  UnboundLocalError: cannot access local variable 'past_ratio' where it is not associated with a value
  
[3]:
  time      : 2025-12-25_10:27:18
  host      : elga.kaist.ac.kr
  rank      : 3 (local_rank: 3)
  exitcode  : 1 (pid: 922053)
  error_file: /tmp/torchelastic_6wskwl5f/9595bcd4-cfbb-44d7-b5e6-e9eeb50c57b8_ol6wv1wq/attempt_0/3/error.json
  traceback : Traceback (most recent call last):
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
      return f(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^
    File "/home/shcho/torchtitan/timelyfreeze/train.py", line 621, in train
      draw_charts(self.freezer, self.step, job_config)
    File "/home/shcho/torchtitan/timelyfreeze/train.py", line 688, in draw_charts
      pipeline_schedule = schedule_pipeline(pipeline_schedule,
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    File "/home/shcho/torchtitan/timelyfreeze/core/schedule.py", line 414, in schedule_pipeline
      assert fwd_time is None or len(fwd_time) == num_stages, f"fwd_time should have the same length as num_stages. fwd_time: {len(fwd_time)}, num_stages: {num_stages}"
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  AssertionError: fwd_time should have the same length as num_stages. fwd_time: 4, num_stages: 8
  
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2025-12-25_10:27:18
  host      : elga.kaist.ac.kr
  rank      : 1 (local_rank: 1)
  exitcode  : 1 (pid: 922051)
  error_file: /tmp/torchelastic_6wskwl5f/9595bcd4-cfbb-44d7-b5e6-e9eeb50c57b8_ol6wv1wq/attempt_0/1/error.json
  traceback : Traceback (most recent call last):
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
      return f(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^
    File "/home/shcho/torchtitan/timelyfreeze/train.py", line 621, in train
      draw_charts(self.freezer, self.step, job_config)
    File "/home/shcho/torchtitan/timelyfreeze/train.py", line 712, in draw_charts
      draw_elementwise_histogram(data=list(freezer.paramwise_frozen_count[s].values()), stage=s,
    File "/home/shcho/torchtitan/timelyfreeze/core/util.py", line 335, in draw_elementwise_histogram
      ax1.text(max(min(80, past_ratio - 5), 5), 0, total_count_text, ha="center", va="center", fontsize=fontsize, color="black")
                       ^^
  UnboundLocalError: cannot access local variable 'past_ratio' where it is not associated with a value
  
============================================================
