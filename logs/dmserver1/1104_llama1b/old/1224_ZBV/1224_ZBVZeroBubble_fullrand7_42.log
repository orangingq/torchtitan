
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 12. 25. (ëª©) 08:02:36 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 1,2,3,4
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/1224_ZBVZeroBubble_fullrand7_42.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug

âœ”ï¸Running with fullrand7 x ZBVZeroBubble ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1224.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=fullrand7 --freezing.threshold=0.01 --freezing.percentile=80 --freezing.max_freeze_ratio=0.8
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank0]:2025-12-25 08:02:43,237 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank0]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank0]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank0]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank0]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank0]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank0]:"
[rank1]:2025-12-25 08:02:43,317 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank1]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank1]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank1]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank1]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank1]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank1]:"
[rank2]:2025-12-25 08:02:43,237 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank2]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank2]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank2]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank2]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank2]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank2]:"
[rank3]:2025-12-25 08:02:43,266 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:"
[rank0]:2025-12-25 08:02:43,618 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-12-25 08:02:43,621 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-25 08:02:43,623 - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-12-25 08:02:43,624 - Loading tokenizer from tokenizer.json
[rank2]:2025-12-25 08:02:43,613 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-12-25 08:02:43,616 - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-12-25 08:02:43,676 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-12-25 08:02:43,679 - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-12-25 08:02:43,655 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-12-25 08:02:43,658 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-25 08:02:44,007 - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank3]:2025-12-25 08:02:47,440 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-12-25 08:02:47,478 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-25 08:02:47,506 - PP rank 3 is building stage_idx 3 with modules ['layers.7', 'layers.8']
[rank3]:2025-12-25 08:02:47,519 - PP rank 3 is building stage_idx 4 with modules ['layers.9', 'layers.10']
[rank3]:2025-12-25 08:02:47,521 - Using pipeline schedule ZBVZeroBubble with 8 microbatches and 8 stages.
[rank0]:2025-12-25 08:02:47,563 - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank1]:2025-12-25 08:02:47,600 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-12-25 08:02:47,640 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-25 08:02:47,668 - PP rank 1 is building stage_idx 1 with modules ['layers.2', 'layers.3', 'layers.4']
[rank2]:2025-12-25 08:02:47,644 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-12-25 08:02:47,680 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-25 08:02:47,681 - PP rank 1 is building stage_idx 6 with modules ['layers.13', 'layers.14']
[rank2]:2025-12-25 08:02:47,706 - PP rank 2 is building stage_idx 2 with modules ['layers.5', 'layers.6']
[rank2]:2025-12-25 08:02:47,718 - PP rank 2 is building stage_idx 5 with modules ['layers.11', 'layers.12']
[rank2]:2025-12-25 08:02:47,720 - Using pipeline schedule ZBVZeroBubble with 8 microbatches and 8 stages.
[rank1]:2025-12-25 08:02:47,683 - Using pipeline schedule ZBVZeroBubble with 8 microbatches and 8 stages.
[rank3]:2025-12-25 08:02:47,709 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-25 08:02:47,710 - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-12-25 08:02:47,710 - CUDA memory usage for model: 0.92GiB(1.94%)
[rank2]:2025-12-25 08:02:47,911 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-25 08:02:47,912 - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-12-25 08:02:47,912 - CUDA memory usage for model: 0.92GiB(1.94%)
[rank1]:2025-12-25 08:02:47,911 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-25 08:02:47,912 - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-12-25 08:02:47,912 - CUDA memory usage for model: 1.13GiB(2.39%)
[rank0]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank0]:wandb: setting up run qy3hmrnh
[rank0]:wandb: Tracking run with wandb version 0.22.2
[rank0]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1224_ZBVZeroBubble_fullrand7_42_dm1/20251225-0802/wandb/run-20251225_080248-qy3hmrnh
[rank0]:wandb: Run `wandb offline` to turn off syncing.
[rank0]:wandb: Syncing run 1224_ZBVZeroBubble_fullrand7_42_dm1
[rank0]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank0]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/qy3hmrnh
[rank0]:2025-12-25 08:02:50,036 - WandB logging enabled
[rank0]:2025-12-25 08:02:50,037 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-12-25 08:02:50,074 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-25 08:02:50,076 - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-12-25 08:02:50,104 - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1']
[rank0]:2025-12-25 08:02:50,117 - PP rank 0 is building stage_idx 7 with modules ['layers.15', 'norm', 'output']
[rank0]:2025-12-25 08:02:50,119 - Using pipeline schedule ZBVZeroBubble with 8 microbatches and 8 stages.
[rank1]:2025-12-25 08:02:50,329 - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-12-25 08:02:50,329 - Mixed precision training with TP or PP is handled by autocast
[rank2]:2025-12-25 08:02:50,329 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-25 08:02:50,312 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-25 08:02:50,312 - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-12-25 08:02:50,313 - CUDA memory usage for model: 2.64GiB(5.55%)
[rank0]:2025-12-25 08:02:50,328 - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1224_ZBVZeroBubble_fullrand7_42_dm1
[rank0]:2025-12-25 08:02:50,329 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-25 08:02:50,330 - Trainer is initialized with local batch size 32, global batch size 128, gradient accumulation steps 4, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2025-12-25 08:02:50,330 - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank0]:2025-12-25 08:02:53,787 - [GC] GC collection for checkpoint loading. 0.03 seconds
[rank0]:2025-12-25 08:02:53,788 - Finished loading the checkpoint in 3.46 seconds.
[rank0]:2025-12-25 08:02:53,796 - Training starts at step 1
[rank0]:2025-12-25 08:02:59,054 -  step:  1  loss: 10.6092  grad_norm: 203.0656  memory: 30.01GiB(63.17%)  tps: 3,650  tflops: 28.53  mfu: 9.15%
[rank0]:2025-12-25 08:02:59,055 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-12-25 08:02:59,002 -  step:  1  loss: -4.0000  grad_norm: 203.0656  memory: 11.98GiB(25.23%)  tps: 2,894  tflops: 22.63  mfu: 7.25%
[rank2]:2025-12-25 08:02:59,003 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-12-25 08:02:59,016 -  step:  1  loss: -4.0000  grad_norm: 203.0656  memory: 15.58GiB(32.80%)  tps: 2,880  tflops: 22.52  mfu: 7.22%
[rank1]:2025-12-25 08:02:59,016 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-12-25 08:02:59,010 -  step:  1  loss: -4.0000  grad_norm: 203.0656  memory: 13.43GiB(28.27%)  tps: 2,842  tflops: 22.22  mfu: 7.12%
[rank3]:2025-12-25 08:02:59,011 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-25 08:06:39,059 - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-12-25 08:06:43,843 - Avg. fwd time: 8.1570 / Avg. bwd-weight time: 10.0026 / Avg. bwd-input time: 10.0244 / Avg. batch time: 1049.3072 (ms) / GPU bubble ratio: 57.02%
[rank3]:2025-12-25 08:06:43,851 - Avg. fwd time: 7.7848 / Avg. bwd-weight time: 9.8107 / Avg. bwd-input time: 9.6041 / Avg. batch time: 1045.8675 (ms) / GPU bubble ratio: 58.39%
[rank1]:2025-12-25 08:06:43,862 - Avg. fwd time: 9.8291 / Avg. bwd-weight time: 12.8847 / Avg. bwd-input time: 12.1564 / Avg. batch time: 1084.2768 (ms) / GPU bubble ratio: 48.54%
[rank0]:2025-12-25 08:06:43,868 - Avg. fwd time: 13.5011 / Avg. full-bwd time: 28.7278 (Avg. bwd-weight time: 29.7640 / Avg. bwd-input time: 34.2875) / Avg. batch time: 1105.6473 (ms) / GPU bubble ratio: 13.33%
[rank0]:2025-12-25 08:06:43,940 -  step: 50  loss:  9.8831  grad_norm: 24.2742  memory: 35.32GiB(74.36%)  tps: 7,140  tflops: 55.82  mfu: 17.89%
[rank2]:2025-12-25 08:06:43,914 -  step: 50  loss: -4.0000  grad_norm: 24.2742  memory: 13.80GiB(29.05%)  tps: 7,139  tflops: 55.81  mfu: 17.89%
[rank3]:2025-12-25 08:06:43,914 -  step: 50  loss: -4.0000  grad_norm: 24.2742  memory: 15.27GiB(32.13%)  tps: 7,139  tflops: 55.81  mfu: 17.89%
[rank1]:2025-12-25 08:06:43,917 -  step: 50  loss: -4.0000  grad_norm: 24.2742  memory: 17.83GiB(37.53%)  tps: 7,139  tflops: 55.81  mfu: 17.89%
[rank3]:2025-12-25 08:07:25,695 - [Step 60] ã€°ï¸ Monitoring Upperbound
[rank0]:2025-12-25 08:08:11,933 - [Step 70] â³ Monitoring Upperbound... (276/286)
[rank2]:2025-12-25 08:08:12,124 - [Step 70] â³ Monitoring Upperbound... (276/286)
[rank3]:2025-12-25 08:08:12,131 - [Step 70] â³ Monitoring Upperbound... (276/286)
[rank1]:2025-12-25 08:08:12,145 - [Step 70] â³ Monitoring Upperbound... (276/286)
[rank3]:2025-12-25 08:08:58,711 - [Step 80] âœ”ï¸  Setting Upperbound
[rank3]:2025-12-25 08:08:58,820 - [Step 80] ã€°ï¸ Monitoring Lowerbound
[rank3]:2025-12-25 08:10:02,388 - [Step 100] âœ”ï¸  Setting Lowerbound
[rank0]:2025-12-25 08:10:02,445 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-25 08:10:02,489 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 1.00(0.00)/0.00, [MB1] 1.00(1.00)/1.00, [MB2] 1.00(1.00)/1.00, [MB3] 1.00(1.00)/1.00, [MB0] 1.00(1.00)/1.00, [MB4] 1.00(1.00)/1.00, [MB1] 1.00(1.00)/1.00, [MB5] 1.00(1.00)/1.00, [MB2] 1.00(1.00)/1.00, [MB6] 1.00(1.00)/1.00, [MB3] 1.00(1.00)/1.00, [MB7] 1.00(0.40)/0.40, [MB4] 1.00(0.78)/0.78, [MB5] 1.00(0.34)/0.34, [MB6] 1.00(0.38)/0.38, [MB7] 1.00(0.90)/0.90
[rank1]:2025-12-25 08:10:02,480 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 1.00(0.00)/0.00, [MB1] 1.00(0.00)/0.00, [MB2] 1.00(0.00)/0.00, [MB0] 1.00(1.00)/1.00, [MB3] 1.00(0.00)/0.00, [MB1] 1.00(0.51)/0.51, [MB4] 1.00(0.00)/0.00, [MB2] 1.00(0.15)/0.15, [MB5] 1.00(0.00)/0.00, [MB3] 1.00(0.20)/0.20, [MB6] 1.00(0.00)/0.00, [MB4] 1.00(0.69)/0.69, [MB5] 1.00(0.83)/0.83, [MB6] 1.00(1.00)/1.00, [MB7] 1.00(0.74)/0.74, [MB7] 1.00(1.00)/1.00
[rank2]:2025-12-25 08:10:02,486 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 1.00(0.00)/0.00, [MB1] 1.00(0.00)/0.00, [MB0] 1.00(0.00)/0.00, [MB2] 1.00(0.00)/0.00, [MB1] 1.00(0.00)/0.00, [MB3] 1.00(0.00)/0.00, [MB2] 1.00(0.00)/0.00, [MB4] 1.00(0.00)/0.00, [MB3] 1.00(0.00)/0.00, [MB5] 1.00(0.00)/0.00, [MB4] 1.00(0.28)/0.28, [MB5] 1.00(1.00)/1.00, [MB6] 1.00(0.00)/0.00, [MB7] 1.00(0.16)/0.16, [MB6] 1.00(1.00)/1.00, [MB7] 1.00(1.00)/1.00
[rank3]:2025-12-25 08:10:02,804 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/pipeline_schedule/251225_0810_max_batch_time.svg
[rank3]:			> Batch Time: 991.97 ms, GPU Bubble Ratio: 1.35%, 43.44%, 54.35%, 55.98%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-9-34ms      | [S0,MB4,F]  34-8-42ms      | [S0,MB5,F]  42-9-52ms      | [S0,MB6,F]  52-9-61ms      | [S7,MB0,F]  75-17-92ms     | [S7,MB0,BI] 92-32-125ms    | [S7,MB0,BW] 125-26-151ms   | [S7,MB1,F]  151-16-168ms   | [S7,MB1,BI] 168-34-203ms   | [S7,MB1,BW] 203-30-233ms   | [S7,MB2,F]  233-19-253ms   | [S7,MB2,BI] 253-35-288ms   | [S7,MB2,BW] 288-31-319ms   | [S7,MB3,F]  319-19-338ms   | [S7,MB3,BI] 338-35-374ms   | [S7,MB3,BW] 374-32-406ms   | [S0,MB7,F]  406-10-416ms   | [S0,MB0,B]  416-30-447ms   | [S7,MB4,F]  447-18-465ms   | [S7,MB4,BI] 465-34-500ms   | [S7,MB4,BW] 500-32-533ms   | [S0,MB1,B]  533-30-563ms   | [S7,MB5,F]  563-18-581ms   | [S7,MB5,BI] 581-34-616ms   | [S7,MB5,BW] 616-31-647ms   | [S0,MB2,B]  647-29-677ms   | [S7,MB6,F]  677-18-696ms   | [S7,MB6,BI] 696-34-730ms   | [S7,MB6,BW] 730-30-761ms   | [S0,MB3,B]  761-30-791ms   | [S7,MB7,F]  791-18-810ms   | [S7,MB7,BI] 810-34-845ms   | [S7,MB7,BW] 845-31-876ms   | [S0,MB4,B]  876-30-906ms   | [S0,MB5,B]  906-29-935ms   | [S0,MB6,B]  935-28-964ms   | [S0,MB7,B]  964-27-991ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-21ms      | [S1,MB1,F]  21-10-31ms     | [S1,MB2,F]  31-10-42ms     | [S1,MB3,F]  42-10-53ms     | [S1,MB4,F]  53-10-64ms     | [S6,MB0,F]  64-10-75ms     | [S1,MB5,F]  75-13-88ms     | [S6,MB1,F]  88-8-97ms      | [S6,MB0,BI] 125-9-134ms    | [S6,MB0,BW] 134-10-144ms   | [S6,MB2,F]  144-7-152ms    | [S6,MB1,BI] 203-9-212ms    | [S6,MB1,BW] 212-10-222ms   | [S6,MB3,F]  222-7-230ms    | [S6,MB2,BI] 288-9-297ms    | [S6,MB2,BW] 297-10-308ms   | [S1,MB6,F]  308-10-318ms   | [S1,MB0,BI] 318-15-334ms   | [S1,MB0,BW] 334-15-349ms   | [S6,MB4,F]  349-7-357ms    | [S6,MB3,BI] 374-10-384ms   | [S6,MB3,BW] 384-9-394ms    | [S1,MB7,F]  416-13-430ms   | [S1,MB1,BI] 430-15-445ms   | [S1,MB1,BW] 445-14-460ms   | [S6,MB5,F]  460-7-467ms    | [S6,MB4,BI] 500-10-511ms   | [S6,MB4,BW] 511-9-520ms    | [S1,MB2,BI] 520-14-534ms   | [S1,MB2,BW] 534-14-549ms   | [S6,MB6,F]  549-7-556ms    | [S6,MB5,BI] 616-9-626ms    | [S6,MB5,BW] 626-10-637ms   | [S1,MB3,BI] 637-14-651ms   | [S1,MB3,BW] 651-14-665ms   | [S6,MB7,F]  665-7-672ms    | [S6,MB6,BI] 730-9-740ms    | [S6,MB6,BW] 740-11-751ms   | [S1,MB4,BI] 751-14-765ms   | [S6,MB7,BI] 845-10-855ms   | [S1,MB5,BI] 855-15-870ms   | [S1,MB4,BW] 870-15-886ms   | [S1,MB6,BI] 886-14-900ms   | [S1,MB5,BW] 900-15-916ms   | [S1,MB7,BI] 916-15-931ms   | [S1,MB6,BW] 931-16-948ms   | [S6,MB7,BW] 948-11-959ms   | [S1,MB7,BW] 959-16-976ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-8-29ms      | [S2,MB1,F]  31-7-39ms      | [S2,MB2,F]  42-7-50ms      | [S5,MB0,F]  50-9-59ms      | [S2,MB3,F]  59-9-68ms      | [S5,MB1,F]  68-7-76ms      | [S2,MB4,F]  76-10-86ms     | [S5,MB2,F]  86-8-95ms      | [S5,MB0,BI] 134-9-143ms    | [S5,MB0,BW] 143-10-154ms   | [S5,MB3,F]  154-7-161ms    | [S5,MB1,BI] 212-9-221ms    | [S5,MB1,BW] 221-10-232ms   | [S2,MB5,F]  232-7-239ms    | [S2,MB0,BI] 239-10-250ms   | [S2,MB0,BW] 250-9-260ms    | [S5,MB4,F]  260-7-268ms    | [S5,MB2,BI] 297-10-307ms   | [S5,MB2,BW] 307-9-317ms    | [S2,MB6,F]  318-9-328ms    | [S2,MB1,BI] 328-10-339ms   | [S2,MB1,BW] 339-9-349ms    | [S5,MB5,F]  349-7-356ms    | [S5,MB3,BI] 384-11-395ms   | [S5,MB3,BW] 395-11-406ms   | [S2,MB7,F]  430-7-437ms    | [S2,MB2,BI] 437-10-447ms   | [S2,MB2,BW] 447-9-457ms    | [S5,MB6,F]  457-7-465ms    | [S5,MB4,BI] 511-10-521ms   | [S5,MB4,BW] 521-9-531ms    | [S2,MB3,BI] 531-9-540ms    | [S2,MB3,BW] 540-10-550ms   | [S5,MB7,F]  550-7-558ms    | [S5,MB5,BI] 626-9-635ms    | [S5,MB5,BW] 635-9-645ms    | [S2,MB4,BI] 645-9-654ms    | [S5,MB6,BI] 740-10-750ms   | [S2,MB5,BI] 750-10-761ms   | [S5,MB7,BI] 855-9-864ms    | [S2,MB6,BI] 864-10-875ms   | [S2,MB4,BW] 875-10-885ms   | [S2,MB7,BI] 885-9-895ms    | [S2,MB5,BW] 895-10-905ms   | [S5,MB6,BW] 905-9-915ms    | [S5,MB7,BW] 915-9-925ms    | [S2,MB6,BW] 925-9-934ms    | [S2,MB7,BW] 934-10-945ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-8-37ms      | [S4,MB0,F]  37-8-45ms      | [S3,MB1,F]  45-8-54ms      | [S4,MB1,F]  54-7-61ms      | [S3,MB2,F]  61-7-68ms      | [S4,MB2,F]  68-7-76ms      | [S3,MB3,F]  76-7-84ms      | [S4,MB3,F]  84-8-92ms      | [S4,MB0,BI] 143-9-152ms    | [S4,MB0,BW] 152-9-162ms    AFR(10):1.0000 | [S3,MB4,F]  162-7-169ms    | [S3,MB0,BI] 169-9-178ms    | [S3,MB0,BW] 178-9-188ms    AFR(10):0.9444 | [S4,MB4,F]  188-7-196ms    | [S4,MB1,BI] 221-10-231ms   | [S4,MB1,BW] 231-10-242ms   AFR(10):1.0000 | [S3,MB5,F]  242-8-250ms    | [S3,MB1,BI] 250-9-259ms    | [S3,MB1,BW] 259-9-269ms    AFR(10):0.9444 | [S4,MB5,F]  269-7-277ms    | [S4,MB2,BI] 307-11-318ms   | [S4,MB2,BW] 318-9-328ms    AFR(10):1.0000 | [S3,MB6,F]  328-7-336ms    | [S3,MB2,BI] 336-9-345ms    | [S3,MB2,BW] 345-9-355ms    AFR(10):0.9444 | [S4,MB6,F]  355-7-362ms    | [S4,MB3,BI] 395-10-405ms   | [S4,MB3,BW] 405-10-416ms   AFR(10):1.0000 | [S3,MB7,F]  437-7-445ms    | [S3,MB3,BI] 445-9-454ms    | [S3,MB3,BW] 454-9-464ms    AFR(10):0.9444 | [S4,MB7,F]  464-7-471ms    | [S4,MB4,BI] 521-10-531ms   | [S4,MB4,BW] 531-9-541ms    AFR(10):1.0000 | [S3,MB4,BI] 541-10-551ms   | [S4,MB5,BI] 635-10-645ms   | [S3,MB5,BI] 645-9-654ms    | [S4,MB6,BI] 750-9-760ms    | [S3,MB6,BI] 760-9-769ms    | [S4,MB7,BI] 864-9-873ms    | [S3,MB7,BI] 873-9-882ms    | [S3,MB4,BW] 882-10-893ms   AFR(10):0.9444 | [S4,MB5,BW] 893-9-902ms    AFR(10):1.0000 | [S4,MB6,BW] 902-9-912ms    AFR(10):1.0000 | [S4,MB7,BW] 912-9-921ms    AFR(10):1.0000 | [S3,MB5,BW] 921-10-931ms   AFR(10):0.9444 | [S3,MB6,BW] 931-10-942ms   AFR(10):0.9444 | [S3,MB7,BW] 942-10-952ms   AFR(10):0.9444
[rank3]:2025-12-25 08:10:03,080 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/pipeline_schedule/251225_0810_min_batch_time.svg
[rank3]:			> Batch Time: 572.60 ms, GPU Bubble Ratio: 13.20%, 38.41%, 49.16%, 50.90%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-9-34ms      | [S0,MB4,F]  34-8-42ms      | [S0,MB5,F]  42-9-52ms      | [S0,MB6,F]  52-9-61ms      | [S7,MB0,F]  75-17-92ms     | [S7,MB0,BI] 92-32-125ms    | [S7,MB0,BW] 125-0-125ms    | [S7,MB1,F]  125-16-142ms   | [S7,MB1,BI] 142-34-176ms   | [S7,MB1,BW] 176-0-176ms    | [S7,MB2,F]  176-19-196ms   | [S7,MB2,BI] 196-35-231ms   | [S7,MB2,BW] 231-0-231ms    | [S7,MB3,F]  231-19-250ms   | [S7,MB3,BI] 250-35-285ms   | [S7,MB3,BW] 285-0-285ms    | [S0,MB7,F]  285-10-295ms   | [S0,MB0,B]  295-0-295ms    | [S7,MB4,F]  295-18-314ms   | [S7,MB4,BI] 314-34-349ms   | [S7,MB4,BW] 349-0-349ms    | [S0,MB1,B]  349-0-349ms    | [S7,MB5,F]  349-18-368ms   | [S7,MB5,BI] 368-34-403ms   | [S7,MB5,BW] 403-0-403ms    | [S0,MB2,B]  403-0-403ms    | [S7,MB6,F]  403-18-422ms   | [S7,MB6,BI] 422-34-456ms   | [S7,MB6,BW] 456-0-456ms    | [S0,MB3,B]  456-0-456ms    | [S7,MB7,F]  456-18-475ms   | [S7,MB7,BI] 475-34-510ms   | [S7,MB7,BW] 510-0-510ms    | [S0,MB4,B]  510-0-510ms    | [S0,MB5,B]  535-0-535ms    | [S0,MB6,B]  554-0-554ms    | [S0,MB7,B]  572-0-572ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-21ms      | [S1,MB1,F]  21-10-31ms     | [S1,MB2,F]  31-10-42ms     | [S1,MB3,F]  42-10-53ms     | [S1,MB4,F]  53-10-64ms     | [S6,MB0,F]  64-10-75ms     | [S1,MB5,F]  75-13-88ms     | [S6,MB1,F]  88-8-97ms      | [S6,MB0,BI] 125-9-134ms    | [S6,MB0,BW] 134-0-134ms    | [S6,MB2,F]  134-7-141ms    | [S6,MB1,BI] 176-9-186ms    | [S6,MB1,BW] 186-0-186ms    | [S6,MB3,F]  186-7-193ms    | [S6,MB2,BI] 231-9-240ms    | [S6,MB2,BW] 240-0-240ms    | [S1,MB6,F]  240-10-251ms   | [S1,MB0,BI] 251-15-266ms   | [S1,MB0,BW] 266-0-266ms    | [S6,MB4,F]  266-7-274ms    | [S6,MB3,BI] 285-10-296ms   | [S6,MB3,BW] 296-0-296ms    | [S1,MB7,F]  296-13-309ms   | [S1,MB1,BI] 309-15-324ms   | [S1,MB1,BW] 324-0-324ms    | [S6,MB5,F]  324-7-332ms    | [S6,MB4,BI] 349-10-359ms   | [S6,MB4,BW] 359-0-359ms    | [S1,MB2,BI] 359-14-374ms   | [S1,MB2,BW] 374-0-374ms    | [S6,MB6,F]  374-7-381ms    | [S6,MB5,BI] 403-9-412ms    | [S6,MB5,BW] 412-0-412ms    | [S1,MB3,BI] 412-14-426ms   | [S1,MB3,BW] 426-0-426ms    | [S6,MB7,F]  426-7-434ms    | [S6,MB6,BI] 456-9-466ms    | [S6,MB6,BW] 466-0-466ms    | [S1,MB4,BI] 466-14-480ms   | [S6,MB7,BI] 510-10-520ms   | [S1,MB5,BI] 520-15-535ms   | [S1,MB4,BW] 535-0-535ms    | [S1,MB6,BI] 540-14-554ms   | [S1,MB5,BW] 554-0-554ms    | [S1,MB7,BI] 557-15-572ms   | [S1,MB6,BW] 572-0-572ms    | [S6,MB7,BW] 572-0-572ms    | [S1,MB7,BW] 572-0-572ms   
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-8-29ms      | [S2,MB1,F]  31-7-39ms      | [S2,MB2,F]  42-7-50ms      | [S5,MB0,F]  50-9-59ms      | [S2,MB3,F]  59-9-68ms      | [S5,MB1,F]  68-7-76ms      | [S2,MB4,F]  76-10-86ms     | [S5,MB2,F]  86-8-95ms      | [S5,MB0,BI] 134-9-143ms    | [S5,MB0,BW] 143-0-143ms    | [S5,MB3,F]  143-7-151ms    | [S5,MB1,BI] 186-9-195ms    | [S5,MB1,BW] 195-0-195ms    | [S2,MB5,F]  195-7-202ms    | [S2,MB0,BI] 202-10-213ms   | [S2,MB0,BW] 213-0-213ms    | [S5,MB4,F]  213-7-221ms    | [S5,MB2,BI] 240-10-250ms   | [S5,MB2,BW] 250-0-250ms    | [S2,MB6,F]  251-9-260ms    | [S2,MB1,BI] 260-10-271ms   | [S2,MB1,BW] 271-0-271ms    | [S5,MB5,F]  271-7-279ms    | [S5,MB3,BI] 296-11-307ms   | [S5,MB3,BW] 307-0-307ms    | [S2,MB7,F]  309-7-316ms    | [S2,MB2,BI] 316-10-327ms   | [S2,MB2,BW] 327-0-327ms    | [S5,MB6,F]  327-7-335ms    | [S5,MB4,BI] 359-10-370ms   | [S5,MB4,BW] 370-0-370ms    | [S2,MB3,BI] 370-9-379ms    | [S2,MB3,BW] 379-0-379ms    | [S5,MB7,F]  379-7-387ms    | [S5,MB5,BI] 412-9-422ms    | [S5,MB5,BW] 422-0-422ms    | [S2,MB4,BI] 422-9-431ms    | [S5,MB6,BI] 466-10-476ms   | [S2,MB5,BI] 476-10-487ms   | [S5,MB7,BI] 520-9-529ms    | [S2,MB6,BI] 529-10-540ms   | [S2,MB4,BW] 540-0-540ms    | [S2,MB7,BI] 548-9-557ms    | [S2,MB5,BW] 557-0-557ms    | [S5,MB6,BW] 557-0-557ms    | [S5,MB7,BW] 557-0-557ms    | [S2,MB6,BW] 557-0-557ms    | [S2,MB7,BW] 557-0-557ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-8-37ms      | [S4,MB0,F]  37-8-45ms      | [S3,MB1,F]  45-8-54ms      | [S4,MB1,F]  54-7-61ms      | [S3,MB2,F]  61-7-68ms      | [S4,MB2,F]  68-7-76ms      | [S3,MB3,F]  76-7-84ms      | [S4,MB3,F]  84-8-92ms      | [S4,MB0,BI] 143-9-152ms    | [S4,MB0,BW] 152-0-152ms    AFR(10):1.0000 | [S3,MB4,F]  152-7-160ms    | [S3,MB0,BI] 160-9-169ms    | [S3,MB0,BW] 169-0-169ms    AFR(10):0.9444 | [S4,MB4,F]  169-7-177ms    | [S4,MB1,BI] 195-10-205ms   | [S4,MB1,BW] 205-0-205ms    AFR(10):1.0000 | [S3,MB5,F]  205-8-213ms    | [S3,MB1,BI] 213-9-223ms    | [S3,MB1,BW] 223-0-223ms    AFR(10):0.9444 | [S4,MB5,F]  223-7-231ms    | [S4,MB2,BI] 250-11-261ms   | [S4,MB2,BW] 261-0-261ms    AFR(10):1.0000 | [S3,MB6,F]  261-7-268ms    | [S3,MB2,BI] 268-9-278ms    | [S3,MB2,BW] 278-0-278ms    AFR(10):0.9444 | [S4,MB6,F]  278-7-286ms    | [S4,MB3,BI] 307-10-317ms   | [S4,MB3,BW] 317-0-317ms    AFR(10):1.0000 | [S3,MB7,F]  317-7-324ms    | [S3,MB3,BI] 324-9-334ms    | [S3,MB3,BW] 334-0-334ms    AFR(10):0.9444 | [S4,MB7,F]  334-7-342ms    | [S4,MB4,BI] 370-10-380ms   | [S4,MB4,BW] 380-0-380ms    AFR(10):1.0000 | [S3,MB4,BI] 380-10-391ms   | [S4,MB5,BI] 422-10-432ms   | [S3,MB5,BI] 432-9-441ms    | [S4,MB6,BI] 476-9-485ms    | [S3,MB6,BI] 485-9-495ms    | [S4,MB7,BI] 529-9-538ms    | [S3,MB7,BI] 538-9-548ms    | [S3,MB4,BW] 548-0-548ms    AFR(10):0.9444 | [S4,MB5,BW] 548-0-548ms    AFR(10):1.0000 | [S4,MB6,BW] 548-0-548ms    AFR(10):1.0000 | [S4,MB7,BW] 548-0-548ms    AFR(10):1.0000 | [S3,MB5,BW] 548-0-548ms    AFR(10):0.9444 | [S3,MB6,BW] 548-0-549ms    AFR(10):0.9444 | [S3,MB7,BW] 549-1-550ms    AFR(10):0.9444
[rank3]:2025-12-25 08:10:03,402 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/pipeline_schedule/251225_0810_frozen_pipeline_schedule.svg
[rank3]:			> Batch Time: 601.77 ms, GPU Bubble Ratio: 2.22%, 22.32%, 30.54%, 34.51%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-9-34ms      | [S0,MB4,F]  34-8-42ms      | [S0,MB5,F]  42-9-52ms      | [S0,MB6,F]  52-9-61ms      | [S7,MB0,F]  75-17-92ms     | [S7,MB0,BI] 92-32-125ms    | [S7,MB0,BW] 125-26-151ms   | [S7,MB1,F]  151-16-168ms   | [S7,MB1,BI] 168-34-203ms   | [S7,MB1,BW] 203-0-203ms    | [S7,MB2,F]  203-19-222ms   | [S7,MB2,BI] 222-35-257ms   | [S7,MB2,BW] 257-0-257ms    | [S7,MB3,F]  257-19-276ms   | [S7,MB3,BI] 276-35-312ms   | [S7,MB3,BW] 312-0-312ms    | [S0,MB7,F]  312-10-322ms   | [S0,MB0,B]  322-0-322ms    | [S7,MB4,F]  322-18-341ms   | [S7,MB4,BI] 341-34-376ms   | [S7,MB4,BW] 376-0-376ms    | [S0,MB1,B]  376-0-376ms    | [S7,MB5,F]  376-18-394ms   | [S7,MB5,BI] 394-34-429ms   | [S7,MB5,BW] 429-0-429ms    | [S0,MB2,B]  429-0-429ms    | [S7,MB6,F]  429-18-448ms   | [S7,MB6,BI] 448-34-483ms   | [S7,MB6,BW] 483-0-483ms    | [S0,MB3,B]  483-0-483ms    | [S7,MB7,F]  483-18-501ms   | [S7,MB7,BI] 501-34-536ms   | [S7,MB7,BW] 536-18-555ms   | [S0,MB4,B]  555-6-562ms    | [S0,MB5,B]  562-19-581ms   | [S0,MB6,B]  581-17-598ms   | [S0,MB7,B]  598-2-601ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-21ms      | [S1,MB1,F]  21-10-31ms     | [S1,MB2,F]  31-10-42ms     | [S1,MB3,F]  42-10-53ms     | [S1,MB4,F]  53-10-64ms     | [S6,MB0,F]  64-10-75ms     | [S1,MB5,F]  75-13-88ms     | [S6,MB1,F]  88-8-97ms      | [S6,MB0,BI] 125-9-134ms    | [S6,MB0,BW] 134-10-144ms   | [S6,MB2,F]  144-7-152ms    | [S6,MB1,BI] 203-9-212ms    | [S6,MB1,BW] 212-10-222ms   | [S6,MB3,F]  222-7-230ms    | [S6,MB2,BI] 257-9-266ms    | [S6,MB2,BW] 266-10-277ms   | [S1,MB6,F]  277-10-288ms   | [S1,MB0,BI] 288-15-304ms   | [S1,MB0,BW] 304-0-304ms    | [S6,MB4,F]  304-7-312ms    | [S6,MB3,BI] 312-10-322ms   | [S6,MB3,BW] 322-9-332ms    | [S1,MB7,F]  332-13-345ms   | [S1,MB1,BI] 345-15-361ms   | [S1,MB1,BW] 361-7-368ms    | [S6,MB5,F]  368-7-376ms    | [S6,MB4,BI] 376-10-386ms   | [S6,MB4,BW] 386-9-396ms    | [S1,MB2,BI] 396-14-410ms   | [S1,MB2,BW] 410-12-422ms   | [S6,MB6,F]  422-7-429ms    | [S6,MB5,BI] 429-9-439ms    | [S6,MB5,BW] 439-10-450ms   | [S1,MB3,BI] 450-14-464ms   | [S1,MB3,BW] 464-11-475ms   | [S6,MB7,F]  475-7-483ms    | [S6,MB6,BI] 483-9-492ms    | [S6,MB6,BW] 492-11-503ms   | [S1,MB4,BI] 503-14-518ms   | [S6,MB7,BI] 536-10-546ms   | [S1,MB5,BI] 546-15-562ms   | [S1,MB4,BW] 562-4-566ms    | [S1,MB6,BI] 566-14-581ms   | [S1,MB5,BW] 581-2-583ms    | [S1,MB7,BI] 583-15-598ms   | [S1,MB6,BW] 598-0-598ms    | [S6,MB7,BW] 598-2-601ms    | [S1,MB7,BW] 601-0-601ms   
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-8-29ms      | [S2,MB1,F]  31-7-39ms      | [S2,MB2,F]  42-7-50ms      | [S5,MB0,F]  50-9-59ms      | [S2,MB3,F]  59-9-68ms      | [S5,MB1,F]  68-7-76ms      | [S2,MB4,F]  76-10-86ms     | [S5,MB2,F]  86-8-95ms      | [S5,MB0,BI] 134-9-143ms    | [S5,MB0,BW] 143-10-154ms   | [S5,MB3,F]  154-7-161ms    | [S5,MB1,BI] 212-9-221ms    | [S5,MB1,BW] 221-10-232ms   | [S2,MB5,F]  232-7-239ms    | [S2,MB0,BI] 239-10-250ms   | [S2,MB0,BW] 250-9-260ms    | [S5,MB4,F]  260-7-268ms    | [S5,MB2,BI] 268-10-278ms   | [S5,MB2,BW] 278-9-288ms    | [S2,MB6,F]  288-9-298ms    | [S2,MB1,BI] 298-10-308ms   | [S2,MB1,BW] 308-9-318ms    | [S5,MB5,F]  318-7-326ms    | [S5,MB3,BI] 326-11-337ms   | [S5,MB3,BW] 337-11-348ms   | [S2,MB7,F]  348-7-355ms    | [S2,MB2,BI] 355-10-366ms   | [S2,MB2,BW] 366-9-376ms    | [S5,MB6,F]  376-7-383ms    | [S5,MB4,BI] 386-10-396ms   | [S5,MB4,BW] 396-9-406ms    | [S2,MB3,BI] 406-9-416ms    | [S2,MB3,BW] 416-10-426ms   | [S5,MB7,F]  426-7-433ms    | [S5,MB5,BI] 439-9-448ms    | [S5,MB5,BW] 448-9-458ms    | [S2,MB4,BI] 458-9-467ms    | [S5,MB6,BI] 492-10-503ms   | [S2,MB5,BI] 503-10-513ms   | [S5,MB7,BI] 546-9-556ms    | [S2,MB6,BI] 556-10-566ms   | [S2,MB4,BW] 566-7-574ms    | [S2,MB7,BI] 574-9-583ms    | [S2,MB5,BW] 583-0-583ms    | [S5,MB6,BW] 583-9-593ms    | [S5,MB7,BW] 593-8-601ms    | [S2,MB6,BW] 601-0-601ms    | [S2,MB7,BW] 601-0-601ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-8-37ms      | [S4,MB0,F]  37-8-45ms      | [S3,MB1,F]  45-8-54ms      | [S4,MB1,F]  54-7-61ms      | [S3,MB2,F]  61-7-68ms      | [S4,MB2,F]  68-7-76ms      | [S3,MB3,F]  76-7-84ms      | [S4,MB3,F]  84-8-92ms      | [S4,MB0,BI] 143-9-152ms    | [S4,MB0,BW] 152-9-162ms    AFR(10):1.0000 | [S3,MB4,F]  162-7-169ms    | [S3,MB0,BI] 169-9-178ms    | [S3,MB0,BW] 178-9-188ms    AFR(10):0.9444 | [S4,MB4,F]  188-7-196ms    | [S4,MB1,BI] 221-10-231ms   | [S4,MB1,BW] 231-10-242ms   AFR(10):1.0000 | [S3,MB5,F]  242-8-250ms    | [S3,MB1,BI] 250-9-259ms    | [S3,MB1,BW] 259-9-269ms    AFR(10):0.9444 | [S4,MB5,F]  269-7-277ms    | [S4,MB2,BI] 278-11-289ms   | [S4,MB2,BW] 289-9-299ms    AFR(10):1.0000 | [S3,MB6,F]  299-7-306ms    | [S3,MB2,BI] 306-9-315ms    | [S3,MB2,BW] 315-9-325ms    AFR(10):0.9444 | [S4,MB6,F]  325-7-333ms    | [S4,MB3,BI] 337-10-347ms   | [S4,MB3,BW] 347-10-357ms   AFR(10):1.0000 | [S3,MB7,F]  357-7-365ms    | [S3,MB3,BI] 365-9-374ms    | [S3,MB3,BW] 374-9-384ms    AFR(10):0.9444 | [S4,MB7,F]  384-7-392ms    | [S4,MB4,BI] 396-10-407ms   | [S4,MB4,BW] 407-9-416ms    AFR(10):1.0000 | [S3,MB4,BI] 416-10-427ms   | [S4,MB5,BI] 448-10-458ms   | [S3,MB5,BI] 458-9-467ms    | [S4,MB6,BI] 503-9-512ms    | [S3,MB6,BI] 512-9-521ms    | [S4,MB7,BI] 556-9-565ms    | [S3,MB7,BI] 565-9-574ms    | [S3,MB4,BW] 574-0-574ms    AFR(10):0.9444 | [S4,MB5,BW] 574-9-584ms    AFR(10):1.0000 | [S4,MB6,BW] 584-6-590ms    AFR(10):1.0000 | [S4,MB7,BW] 590-0-590ms    AFR(10):1.0000 | [S3,MB5,BW] 590-0-590ms    AFR(10):0.9444 | [S3,MB6,BW] 590-0-591ms    AFR(10):0.9444 | [S3,MB7,BW] 591-10-601ms   AFR(10):0.9444
[rank3]:2025-12-25 08:10:03,402 - 	> Batch Time: 601.77 ms (Average Freeze Ratio: 0.42, Time Reduction Rate: 0.39)
[rank3]:2025-12-25 08:10:03,402 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 1.00(0.00)/0.00, [MB0] 0.94(0.00)/0.00, [MB1] 1.00(0.00)/0.00, [MB1] 0.94(0.00)/0.00, [MB2] 1.00(0.00)/0.00, [MB2] 0.94(0.00)/0.00, [MB3] 1.00(0.00)/0.00, [MB3] 0.94(0.00)/0.00, [MB4] 1.00(0.00)/0.00, [MB4] 0.94(1.00)/1.00, [MB5] 1.00(0.00)/0.00, [MB6] 1.00(0.35)/0.35, [MB7] 1.00(1.00)/1.00, [MB5] 0.94(1.00)/1.00, [MB6] 0.94(1.00)/1.00, [MB7] 0.94(0.00)/0.00
[rank2]:2025-12-25 08:10:06,645 - Avg. fwd time: 8.2089 / Avg. bwd-weight time: 8.0036 / Avg. bwd-input time: 10.0481 / Avg. batch time: 986.8704 (ms) / GPU bubble ratio: 57.42%
[rank0]:2025-12-25 08:10:06,652 - Avg. fwd time: 13.4515 / Avg. full-bwd time: 22.9484 (Avg. bwd-weight time: 23.7523 / Avg. bwd-input time: 34.3005) / Avg. batch time: 1042.1146 (ms) / GPU bubble ratio: 17.17%
[rank3]:2025-12-25 08:10:06,642 - Avg. fwd time: 7.7637 / Avg. bwd-weight time: 7.8854 / Avg. bwd-input time: 9.6225 / Avg. batch time: 977.4536 (ms) / GPU bubble ratio: 58.63%
[rank3]:2025-12-25 08:10:06,698 -  step: 100  loss: -4.0000  grad_norm:  3.4074  memory: 15.27GiB(32.13%)  tps: 8,080  tflops: 63.16  mfu: 20.24%
[rank1]:2025-12-25 08:10:06,649 - Avg. fwd time: 9.8736 / Avg. bwd-weight time: 10.2850 / Avg. bwd-input time: 12.2092 / Avg. batch time: 1021.3547 (ms) / GPU bubble ratio: 49.29%
[rank1]:2025-12-25 08:10:06,701 -  step: 100  loss: -4.0000  grad_norm:  3.4074  memory: 17.87GiB(37.61%)  tps: 8,080  tflops: 63.16  mfu: 20.24%
[rank2]:2025-12-25 08:10:06,697 -  step: 100  loss: -4.0000  grad_norm:  3.4074  memory: 13.80GiB(29.05%)  tps: 8,080  tflops: 63.16  mfu: 20.24%
[rank2]:2025-12-25 08:10:06,785 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/frozen_ratio_history/rank2/251225_0810_stage2_step100.svg
[rank0]:2025-12-25 08:10:06,722 -  step: 100  loss:  9.0468  grad_norm:  3.4074  memory: 35.32GiB(74.36%)  tps: 8,080  tflops: 63.16  mfu: 20.24%
[rank0]:2025-12-25 08:10:06,788 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/frozen_ratio_history/rank0/251225_0810_stage0_step100.svg
[rank1]:2025-12-25 08:10:06,783 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/frozen_ratio_history/rank1/251225_0810_stage1_step100.svg
[rank1]:2025-12-25 08:10:06,820 - âœ… Frozen Ratio History of Rank 1 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/frozen_ratio_history/rank1/251225_0810_stage6_step100.svg
[rank2]:2025-12-25 08:10:06,824 - âœ… Frozen Ratio History of Rank 2 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/frozen_ratio_history/rank2/251225_0810_stage5_step100.svg
[rank2]:2025-12-25 08:10:06,867 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/afr_time_plot/251225_0810_stage2.svg
[rank0]:2025-12-25 08:10:06,829 - âœ… Frozen Ratio History of Rank 0 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/frozen_ratio_history/rank0/251225_0810_stage7_step100.svg
[rank0]:2025-12-25 08:10:06,875 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/afr_time_plot/251225_0810_stage0.svg
[rank0]:2025-12-25 08:10:06,917 - âœ… Scatter Plot of Stage 7 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/afr_time_plot/251225_0810_stage7.svg
[rank1]:2025-12-25 08:10:06,858 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/afr_time_plot/251225_0810_stage1.svg
[rank1]:2025-12-25 08:10:06,893 - âœ… Scatter Plot of Stage 6 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/afr_time_plot/251225_0810_stage6.svg
[rank2]:2025-12-25 08:10:06,904 - âœ… Scatter Plot of Stage 5 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/afr_time_plot/251225_0810_stage5.svg
[rank3]:2025-12-25 08:10:07,007 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/pipeline_schedule/251225_0810_step100_rank3.svg
[rank3]:			> Batch Time: 767.50 ms, GPU Bubble Ratio: 38.17%, 53.38%, 61.43%, 63.23%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-8-33ms      | [S0,MB4,F]  33-7-40ms      | [S0,MB5,F]  40-9-50ms      | [S0,MB6,F]  50-8-58ms      | [S7,MB0,F]  112-16-129ms   | [S7,MB0,BI] 141-32-173ms   | [S7,MB0,BW] 173-0-173ms    | [S7,MB1,F]  174-16-190ms   | [S7,MB1,BI] 202-33-236ms   | [S7,MB1,BW] 236-0-236ms    | [S7,MB2,F]  236-18-254ms   | [S7,MB2,BI] 267-34-302ms   | [S7,MB2,BW] 302-0-302ms    | [S7,MB3,F]  302-18-320ms   | [S7,MB3,BI] 332-35-368ms   | [S7,MB3,BW] 368-0-368ms    | [S0,MB7,F]  368-10-378ms   | [S0,MB0,B]  378-0-378ms    | [S7,MB4,F]  386-18-404ms   | [S7,MB4,BI] 416-33-450ms   | [S7,MB4,BW] 450-0-450ms    | [S0,MB1,B]  457-0-457ms    | [S7,MB5,F]  461-17-478ms   | [S7,MB5,BI] 491-33-524ms   | [S7,MB5,BW] 525-0-525ms    | [S0,MB2,B]  531-0-531ms    | [S7,MB6,F]  545-15-560ms   | [S7,MB6,BI] 572-32-605ms   | [S7,MB6,BW] 605-0-605ms    | [S0,MB3,B]  612-0-612ms    | [S7,MB7,F]  626-14-640ms   | [S7,MB7,BI] 653-32-685ms   | [S7,MB7,BW] 686-0-686ms    | [S0,MB4,B]  692-0-692ms    | [S0,MB5,B]  718-0-718ms    | [S0,MB6,B]  743-0-743ms    | [S0,MB7,B]  767-0-767ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  27-10-37ms     | [S1,MB2,F]  44-10-55ms     | [S1,MB3,F]  61-10-72ms     | [S1,MB4,F]  84-10-95ms     | [S6,MB0,F]  95-10-105ms    | [S1,MB5,F]  105-13-118ms   | [S6,MB1,F]  118-8-127ms    | [S6,MB0,BI] 173-9-183ms    | [S6,MB0,BW] 182-0-182ms    | [S6,MB2,F]  183-8-191ms    | [S6,MB1,BI] 236-9-245ms    | [S6,MB1,BW] 245-0-245ms    | [S6,MB3,F]  245-8-254ms    | [S6,MB2,BI] 302-9-311ms    | [S6,MB2,BW] 311-0-311ms    | [S1,MB6,F]  311-12-324ms   | [S1,MB0,BI] 323-15-339ms   | [S1,MB0,BW] 339-0-339ms    | [S6,MB4,F]  339-7-347ms    | [S6,MB3,BI] 368-11-379ms   | [S6,MB3,BW] 379-0-379ms    | [S1,MB7,F]  379-13-393ms   | [S1,MB1,BI] 393-15-409ms   | [S1,MB1,BW] 409-0-409ms    | [S6,MB5,F]  409-7-416ms    | [S6,MB4,BI] 450-11-462ms   | [S6,MB4,BW] 462-0-462ms    | [S1,MB2,BI] 468-13-482ms   | [S1,MB2,BW] 482-0-482ms    | [S6,MB6,F]  531-7-538ms    | [S6,MB5,BI] 538-10-548ms   | [S6,MB5,BW] 548-0-548ms    | [S1,MB3,BI] 555-14-569ms   | [S1,MB3,BW] 569-0-569ms    | [S6,MB7,F]  611-7-618ms    | [S6,MB6,BI] 618-10-628ms   | [S6,MB6,BW] 628-0-628ms    | [S1,MB4,BI] 635-14-649ms   | [S6,MB7,BI] 685-10-696ms   | [S1,MB5,BI] 696-14-710ms   | [S1,MB4,BW] 710-0-710ms    | [S1,MB6,BI] 723-13-737ms   | [S1,MB5,BW] 737-0-737ms    | [S1,MB7,BI] 747-13-761ms   | [S1,MB6,BW] 761-0-761ms    | [S6,MB7,BW] 761-0-761ms    | [S1,MB7,BW] 761-0-761ms   
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  37-7-45ms      | [S2,MB2,F]  55-7-62ms      | [S5,MB0,F]  62-9-71ms      | [S2,MB3,F]  73-9-82ms      | [S5,MB1,F]  82-7-89ms      | [S2,MB4,F]  95-10-105ms    | [S5,MB2,F]  114-8-123ms    | [S5,MB0,BI] 183-9-192ms    | [S5,MB0,BW] 192-0-192ms    | [S5,MB3,F]  192-8-201ms    | [S5,MB1,BI] 245-9-255ms    | [S5,MB1,BW] 255-0-255ms    | [S2,MB5,F]  255-8-263ms    | [S2,MB0,BI] 263-11-275ms   | [S2,MB0,BW] 275-0-275ms    | [S5,MB4,F]  275-7-283ms    | [S5,MB2,BI] 311-10-322ms   | [S5,MB2,BW] 322-0-322ms    | [S2,MB6,F]  324-9-334ms    | [S2,MB1,BI] 335-10-346ms   | [S2,MB1,BW] 346-0-346ms    | [S5,MB5,F]  346-7-353ms    | [S5,MB3,BI] 383-10-393ms   | [S5,MB3,BW] 393-0-393ms    | [S2,MB7,F]  394-9-404ms    | [S2,MB2,BI] 405-10-416ms   | [S2,MB2,BW] 415-0-415ms    | [S5,MB6,F]  415-7-423ms    | [S5,MB4,BI] 461-10-472ms   | [S5,MB4,BW] 472-0-472ms    | [S2,MB3,BI] 534-9-544ms    | [S2,MB3,BW] 544-0-544ms    | [S5,MB7,F]  554-7-561ms    | [S5,MB5,BI] 561-9-571ms    | [S5,MB5,BW] 571-0-571ms    | [S2,MB4,BI] 614-9-624ms    | [S5,MB6,BI] 628-10-639ms   | [S2,MB5,BI] 639-10-649ms   | [S5,MB7,BI] 696-9-705ms    | [S2,MB6,BI] 706-11-717ms   | [S2,MB4,BW] 717-0-717ms    | [S2,MB7,BI] 731-9-740ms    | [S2,MB5,BW] 741-0-741ms    | [S5,MB6,BW] 741-0-741ms    | [S5,MB7,BW] 741-0-741ms    | [S2,MB6,BW] 741-0-741ms    | [S2,MB7,BW] 741-0-741ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-7-36ms      | [S4,MB0,F]  36-8-44ms      | [S3,MB1,F]  45-8-54ms      | [S4,MB1,F]  54-7-61ms      | [S3,MB2,F]  63-7-70ms      | [S4,MB2,F]  70-7-78ms      | [S3,MB3,F]  97-7-105ms     | [S4,MB3,F]  105-8-113ms    | [S4,MB0,BI] 192-9-201ms    | [S4,MB0,BW] 201-0-201ms    | [S3,MB4,F]  202-7-209ms    | [S3,MB0,BI] 209-9-218ms    | [S3,MB0,BW] 218-0-218ms    | [S4,MB4,F]  218-7-225ms    | [S4,MB1,BI] 255-10-266ms   | [S4,MB1,BW] 266-0-266ms    | [S3,MB5,F]  266-8-274ms    | [S3,MB1,BI] 274-9-283ms    | [S3,MB1,BW] 283-0-283ms    | [S4,MB5,F]  283-7-291ms    | [S4,MB2,BI] 329-11-340ms   | [S4,MB2,BW] 340-0-340ms    | [S3,MB6,F]  340-7-347ms    | [S3,MB2,BI] 348-9-357ms    | [S3,MB2,BW] 357-1-358ms    | [S4,MB6,F]  358-7-365ms    | [S4,MB3,BI] 398-11-410ms   | [S4,MB3,BW] 410-0-410ms    | [S3,MB7,F]  410-7-417ms    | [S3,MB3,BI] 417-9-426ms    | [S3,MB3,BW] 427-1-428ms    | [S4,MB7,F]  428-7-435ms    | [S4,MB4,BI] 528-10-538ms   | [S4,MB4,BW] 538-0-538ms    | [S3,MB4,BI] 538-9-547ms    | [S4,MB5,BI] 608-9-618ms    | [S3,MB5,BI] 618-9-627ms    | [S4,MB6,BI] 639-9-648ms    | [S3,MB6,BI] 648-9-657ms    | [S4,MB7,BI] 707-9-716ms    | [S3,MB7,BI] 716-9-725ms    | [S3,MB4,BW] 725-1-727ms    | [S4,MB5,BW] 726-0-726ms    | [S4,MB6,BW] 726-0-726ms    | [S4,MB7,BW] 726-0-726ms    | [S3,MB5,BW] 726-0-727ms    | [S3,MB6,BW] 727-0-727ms    | [S3,MB7,BW] 727-0-728ms   
[rank3]:2025-12-25 08:10:07,047 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/frozen_ratio_history/rank3/251225_0810_stage3_step100.svg
[rank3]:2025-12-25 08:10:07,084 - âœ… Frozen Ratio History of Rank 3 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/frozen_ratio_history/rank3/251225_0810_stage4_step100.svg
[rank3]:2025-12-25 08:10:07,123 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/afr_time_plot/251225_0810_stage3.svg
[rank3]:2025-12-25 08:10:07,159 - âœ… Scatter Plot of Stage 4 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/afr_time_plot/251225_0810_stage4.svg
[rank0]:2025-12-25 08:13:15,234 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-25 08:13:15,237 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.64(0.67)/1.00, [MB2] 0.64(0.67)/1.00, [MB3] 0.64(0.67)/1.00, [MB0] 0.58(0.67)/1.00, [MB4] 0.64(0.67)/1.00, [MB1] 0.58(0.67)/1.00, [MB5] 0.64(0.67)/1.00, [MB2] 0.58(0.67)/1.00, [MB6] 0.64(0.67)/1.00, [MB3] 0.58(0.67)/1.00, [MB7] 0.27(0.27)/0.40, [MB4] 0.47(0.52)/0.78, [MB5] 0.21(0.23)/0.34, [MB6] 0.21(0.25)/0.38, [MB7] 0.53(0.60)/0.90
[rank1]:2025-12-25 08:13:15,495 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB0] 0.59(0.67)/1.00, [MB3] 0.00(0.00)/0.00, [MB1] 0.30(0.34)/0.51, [MB4] 0.00(0.00)/0.00, [MB2] 0.07(0.10)/0.15, [MB5] 0.00(0.00)/0.00, [MB3] 0.11(0.13)/0.20, [MB6] 0.00(0.00)/0.00, [MB4] 0.41(0.46)/0.69, [MB5] 0.48(0.55)/0.83, [MB6] 0.59(0.67)/1.00, [MB7] 0.44(0.50)/0.74, [MB7] 0.59(0.67)/1.00
[rank2]:2025-12-25 08:13:15,490 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB0] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB4] 0.17(0.19)/0.28, [MB5] 0.61(0.67)/1.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.11(0.10)/0.16, [MB6] 0.61(0.67)/1.00, [MB7] 0.61(0.67)/1.00
[rank3]:2025-12-25 08:13:15,531 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB4] 0.61(0.67)/1.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.22(0.23)/0.35, [MB7] 0.61(0.67)/1.00, [MB5] 0.61(0.67)/1.00, [MB6] 0.61(0.67)/1.00, [MB7] 0.00(0.00)/0.00
[rank2]:2025-12-25 08:13:19,297 - Avg. fwd time: 8.2227 / Avg. bwd-weight time: 8.2854 / Avg. bwd-input time: 10.0732 / Avg. batch time: 949.9397 (ms) / GPU bubble ratio: 55.23%
[rank0]:2025-12-25 08:13:19,306 - Avg. fwd time: 13.5250 / Avg. full-bwd time: 21.4380 (Avg. bwd-weight time: 20.3436 / Avg. bwd-input time: 34.4635) / Avg. batch time: 1002.1180 (ms) / GPU bubble ratio: 17.54%
[rank0]:2025-12-25 08:13:19,379 -  step: 150  loss:  4.4573  grad_norm:  8.8506  memory: 36.24GiB(76.29%)  tps: 8,504  tflops: 66.48  mfu: 21.31%
[rank3]:2025-12-25 08:13:19,295 - Avg. fwd time: 7.7814 / Avg. bwd-weight time: 8.0021 / Avg. bwd-input time: 9.6648 / Avg. batch time: 939.6827 (ms) / GPU bubble ratio: 56.67%
[rank3]:2025-12-25 08:13:19,352 -  step: 150  loss: -4.0000  grad_norm:  8.8506  memory: 15.29GiB(32.17%)  tps: 8,504  tflops: 66.48  mfu: 21.31%
[rank1]:2025-12-25 08:13:19,309 - Avg. fwd time: 9.8487 / Avg. bwd-weight time: 10.0606 / Avg. bwd-input time: 12.2629 / Avg. batch time: 980.1112 (ms) / GPU bubble ratio: 47.48%
[rank1]:2025-12-25 08:13:19,356 -  step: 150  loss: -4.0000  grad_norm:  8.8506  memory: 17.87GiB(37.61%)  tps: 8,504  tflops: 66.48  mfu: 21.31%
[rank2]:2025-12-25 08:13:19,352 -  step: 150  loss: -4.0000  grad_norm:  8.8506  memory: 13.82GiB(29.09%)  tps: 8,504  tflops: 66.48  mfu: 21.31%
[rank0]:2025-12-25 08:16:20,266 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-25 08:16:20,267 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.91(1.00)/1.00, [MB2] 0.91(1.00)/1.00, [MB3] 0.91(1.00)/1.00, [MB0] 0.95(1.00)/1.00, [MB4] 0.91(1.00)/1.00, [MB1] 0.95(1.00)/1.00, [MB5] 0.91(1.00)/1.00, [MB2] 0.95(1.00)/1.00, [MB6] 0.91(1.00)/1.00, [MB3] 0.95(1.00)/1.00, [MB7] 0.36(0.40)/0.40, [MB4] 0.74(0.78)/0.78, [MB5] 0.32(0.34)/0.34, [MB6] 0.37(0.38)/0.38, [MB7] 0.84(0.90)/0.90
[rank1]:2025-12-25 08:16:20,644 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB0] 0.93(1.00)/1.00, [MB3] 0.00(0.00)/0.00, [MB1] 0.48(0.51)/0.51, [MB4] 0.00(0.00)/0.00, [MB2] 0.15(0.15)/0.15, [MB5] 0.00(0.00)/0.00, [MB3] 0.19(0.20)/0.20, [MB6] 0.00(0.00)/0.00, [MB4] 0.63(0.69)/0.69, [MB5] 0.78(0.83)/0.83, [MB6] 0.93(1.00)/1.00, [MB7] 0.72(0.74)/0.74, [MB7] 0.93(1.00)/1.00
[rank2]:2025-12-25 08:16:20,643 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB0] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB4] 0.28(0.28)/0.28, [MB5] 0.94(1.00)/1.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.17(0.16)/0.16, [MB6] 0.94(1.00)/1.00, [MB7] 0.94(1.00)/1.00
[rank3]:2025-12-25 08:16:20,639 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB4] 0.94(1.00)/1.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.33(0.35)/0.35, [MB7] 0.94(1.00)/1.00, [MB5] 0.94(1.00)/1.00, [MB6] 0.94(1.00)/1.00, [MB7] 0.00(0.00)/0.00
[rank2]:2025-12-25 08:16:24,097 - Avg. fwd time: 8.2374 / Avg. bwd-weight time: 8.3152 / Avg. bwd-input time: 10.0928 / Avg. batch time: 924.6205 (ms) / GPU bubble ratio: 53.89%
[rank0]:2025-12-25 08:16:24,111 - Avg. fwd time: 13.5560 / Avg. full-bwd time: 19.6219 (Avg. bwd-weight time: 18.2431 / Avg. bwd-input time: 34.5310) / Avg. batch time: 973.1834 (ms) / GPU bubble ratio: 18.20%
[rank3]:2025-12-25 08:16:24,094 - Avg. fwd time: 7.7906 / Avg. bwd-weight time: 7.9230 / Avg. bwd-input time: 9.7023 / Avg. batch time: 913.4608 (ms) / GPU bubble ratio: 55.48%
[rank1]:2025-12-25 08:16:24,100 - Avg. fwd time: 9.8270 / Avg. bwd-weight time: 9.6673 / Avg. bwd-input time: 12.3160 / Avg. batch time: 951.9822 (ms) / GPU bubble ratio: 46.54%
[rank2]:2025-12-25 08:16:24,157 -  step: 200  loss: -4.0000  grad_norm:  4.8766  memory: 13.82GiB(29.09%)  tps: 8,866  tflops: 69.31  mfu: 22.21%
[rank0]:2025-12-25 08:16:24,184 -  step: 200  loss:  1.6423  grad_norm:  4.8766  memory: 36.24GiB(76.29%)  tps: 8,866  tflops: 69.31  mfu: 22.21%
[rank3]:2025-12-25 08:16:24,157 -  step: 200  loss: -4.0000  grad_norm:  4.8766  memory: 15.29GiB(32.17%)  tps: 8,866  tflops: 69.31  mfu: 22.21%
[rank1]:2025-12-25 08:16:24,161 -  step: 200  loss: -4.0000  grad_norm:  4.8766  memory: 17.87GiB(37.61%)  tps: 8,866  tflops: 69.31  mfu: 22.21%
[rank1]:2025-12-25 08:16:24,236 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/frozen_ratio_history/rank1/251225_0816_stage1_step200.svg
[rank2]:2025-12-25 08:16:24,237 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/frozen_ratio_history/rank2/251225_0816_stage2_step200.svg
[rank2]:2025-12-25 08:16:24,280 - âœ… Frozen Ratio History of Rank 2 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/frozen_ratio_history/rank2/251225_0816_stage5_step200.svg
[rank0]:2025-12-25 08:16:24,236 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/frozen_ratio_history/rank0/251225_0816_stage0_step200.svg
[rank0]:2025-12-25 08:16:24,280 - âœ… Frozen Ratio History of Rank 0 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/frozen_ratio_history/rank0/251225_0816_stage7_step200.svg
[rank1]:2025-12-25 08:16:24,277 - âœ… Frozen Ratio History of Rank 1 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/frozen_ratio_history/rank1/251225_0816_stage6_step200.svg
[rank1]:2025-12-25 08:16:24,441 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/afr_time_plot/251225_0816_stage1.svg
[rank2]:2025-12-25 08:16:24,448 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/afr_time_plot/251225_0816_stage2.svg
[rank0]:2025-12-25 08:16:24,451 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/afr_time_plot/251225_0816_stage0.svg
[rank3]:2025-12-25 08:16:24,523 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/pipeline_schedule/251225_0816_step200_rank3.svg
[rank3]:			> Batch Time: 845.91 ms, GPU Bubble Ratio: 22.31%, 42.86%, 49.37%, 52.38%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-8-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-8-34ms      | [S0,MB4,F]  34-8-43ms      | [S0,MB5,F]  42-10-53ms     | [S0,MB6,F]  52-9-62ms      | [S7,MB0,F]  113-17-130ms   | [S7,MB0,BI] 142-32-175ms   | [S7,MB0,BW] 175-25-200ms   | [S7,MB1,F]  200-16-216ms   | [S7,MB1,BI] 228-34-263ms   | [S7,MB1,BW] 263-22-286ms   | [S7,MB2,F]  285-19-305ms   | [S7,MB2,BI] 317-35-352ms   | [S7,MB2,BW] 352-0-352ms    | [S7,MB3,F]  352-20-373ms   | [S7,MB3,BI] 385-35-421ms   | [S7,MB3,BW] 421-1-422ms    | [S0,MB7,F]  422-10-432ms   | [S0,MB0,B]  432-4-437ms    | [S7,MB4,F]  441-19-460ms   | [S7,MB4,BI] 472-34-507ms   | [S7,MB4,BW] 507-1-508ms    | [S0,MB1,B]  514-5-520ms    | [S7,MB5,F]  520-18-538ms   | [S7,MB5,BI] 551-34-585ms   | [S7,MB5,BW] 585-1-587ms    | [S0,MB2,B]  592-4-596ms    | [S7,MB6,F]  606-16-622ms   | [S7,MB6,BI] 635-33-668ms   | [S7,MB6,BW] 668-0-668ms    | [S0,MB3,B]  675-6-681ms    | [S7,MB7,F]  689-15-704ms   | [S7,MB7,BI] 716-33-749ms   | [S7,MB7,BW] 749-26-776ms   | [S0,MB4,B]  777-10-787ms   | [S0,MB5,B]  787-24-812ms   | [S0,MB6,B]  812-21-834ms   | [S0,MB7,B]  836-9-845ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-12-21ms      | [S1,MB1,F]  27-10-38ms     | [S1,MB2,F]  44-10-55ms     | [S1,MB3,F]  62-10-73ms     | [S1,MB4,F]  85-10-96ms     | [S6,MB0,F]  96-10-106ms    | [S1,MB5,F]  106-13-119ms   | [S6,MB1,F]  119-8-128ms    | [S6,MB0,BI] 175-9-184ms    | [S6,MB0,BW] 184-10-194ms   | [S6,MB2,F]  194-7-201ms    | [S6,MB1,BI] 265-9-275ms    | [S6,MB1,BW] 275-10-285ms   | [S6,MB3,F]  285-7-292ms    | [S6,MB2,BI] 352-9-361ms    | [S6,MB2,BW] 361-10-372ms   | [S1,MB6,F]  372-10-383ms   | [S1,MB0,BI] 383-15-399ms   | [S1,MB0,BW] 399-0-399ms    | [S6,MB4,F]  399-7-407ms    | [S6,MB3,BI] 421-11-432ms   | [S6,MB3,BW] 432-11-444ms   | [S1,MB7,F]  444-11-455ms   | [S1,MB1,BI] 456-16-472ms   | [S1,MB1,BW] 472-7-479ms    | [S6,MB5,F]  478-8-487ms    | [S6,MB4,BI] 507-11-519ms   | [S6,MB4,BW] 519-10-530ms   | [S1,MB2,BI] 530-14-544ms   | [S1,MB2,BW] 544-12-556ms   | [S6,MB6,F]  592-7-599ms    | [S6,MB5,BI] 599-10-609ms   | [S6,MB5,BW] 609-10-620ms   | [S1,MB3,BI] 620-14-634ms   | [S1,MB3,BW] 634-12-647ms   | [S6,MB7,F]  675-7-682ms    | [S6,MB6,BI] 682-10-692ms   | [S6,MB6,BW] 692-10-703ms   | [S1,MB4,BI] 703-14-718ms   | [S6,MB7,BI] 749-10-760ms   | [S1,MB5,BI] 760-15-775ms   | [S1,MB4,BW] 775-6-781ms    | [S1,MB6,BI] 790-14-804ms   | [S1,MB5,BW] 804-5-810ms    | [S1,MB7,BI] 815-14-829ms   | [S1,MB6,BW] 829-0-829ms    | [S6,MB7,BW] 830-3-833ms    | [S1,MB7,BW] 833-0-834ms   
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-8-29ms      | [S2,MB1,F]  38-7-45ms      | [S2,MB2,F]  55-7-63ms      | [S5,MB0,F]  63-9-72ms      | [S2,MB3,F]  73-9-83ms      | [S5,MB1,F]  83-7-90ms      | [S2,MB4,F]  96-10-106ms    | [S5,MB2,F]  115-8-124ms    | [S5,MB0,BI] 184-9-193ms    | [S5,MB0,BW] 193-10-204ms   | [S5,MB3,F]  204-7-211ms    | [S5,MB1,BI] 275-9-284ms    | [S5,MB1,BW] 284-10-295ms   | [S2,MB5,F]  295-7-303ms    | [S2,MB0,BI] 303-10-313ms   | [S2,MB0,BW] 313-9-323ms    | [S5,MB4,F]  323-7-331ms    | [S5,MB2,BI] 361-10-372ms   | [S5,MB2,BW] 372-9-382ms    | [S2,MB6,F]  384-9-394ms    | [S2,MB1,BI] 395-10-406ms   | [S2,MB1,BW] 406-9-416ms    | [S5,MB5,F]  416-7-424ms    | [S5,MB3,BI] 438-10-449ms   | [S5,MB3,BW] 448-10-459ms   | [S2,MB7,F]  459-9-469ms    | [S2,MB2,BI] 469-11-481ms   | [S2,MB2,BW] 480-10-491ms   | [S5,MB6,F]  490-7-498ms    | [S5,MB4,BI] 519-10-530ms   | [S5,MB4,BW] 530-9-540ms    | [S2,MB3,BI] 595-9-604ms    | [S2,MB3,BW] 604-10-615ms   | [S5,MB7,F]  619-7-627ms    | [S5,MB5,BI] 626-9-636ms    | [S5,MB5,BW] 636-9-646ms    | [S2,MB4,BI] 677-9-687ms    | [S5,MB6,BI] 692-10-703ms   | [S2,MB5,BI] 703-10-713ms   | [S5,MB7,BI] 762-9-771ms    | [S2,MB6,BI] 771-11-783ms   | [S2,MB4,BW] 783-6-789ms    | [S2,MB7,BI] 798-9-808ms    | [S2,MB5,BW] 808-0-808ms    | [S5,MB6,BW] 808-10-819ms   | [S5,MB7,BW] 819-9-828ms    | [S2,MB6,BW] 828-1-829ms    | [S2,MB7,BW] 829-1-831ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-8-37ms      | [S4,MB0,F]  37-8-45ms      | [S3,MB1,F]  46-8-54ms      | [S4,MB1,F]  54-7-62ms      | [S3,MB2,F]  63-7-71ms      | [S4,MB2,F]  71-7-79ms      | [S3,MB3,F]  98-7-106ms     | [S4,MB3,F]  106-8-114ms    | [S4,MB0,BI] 194-9-203ms    | [S4,MB0,BW] 203-9-212ms    | [S3,MB4,F]  212-7-219ms    | [S3,MB0,BI] 219-9-229ms    | [S3,MB0,BW] 229-9-238ms    | [S4,MB4,F]  238-7-246ms    | [S4,MB1,BI] 284-10-295ms   | [S4,MB1,BW] 295-10-305ms   | [S3,MB5,F]  305-8-313ms    | [S3,MB1,BI] 313-9-323ms    | [S3,MB1,BW] 323-9-332ms    | [S4,MB5,F]  332-7-340ms    | [S4,MB2,BI] 388-11-400ms   | [S4,MB2,BW] 399-9-409ms    | [S3,MB6,F]  409-7-417ms    | [S3,MB2,BI] 417-9-426ms    | [S3,MB2,BW] 426-9-436ms    | [S4,MB6,F]  436-7-444ms    | [S4,MB3,BI] 462-12-474ms   | [S4,MB3,BW] 474-9-484ms    | [S3,MB7,F]  484-7-491ms    | [S3,MB3,BI] 491-9-501ms    | [S3,MB3,BW] 501-10-511ms   | [S4,MB7,F]  511-8-520ms    | [S4,MB4,BI] 588-10-599ms   | [S4,MB4,BW] 598-9-608ms    | [S3,MB4,BI] 608-10-619ms   | [S4,MB5,BI] 671-10-681ms   | [S3,MB5,BI] 681-9-690ms    | [S4,MB6,BI] 703-9-713ms    | [S3,MB6,BI] 712-9-722ms    | [S4,MB7,BI] 773-9-783ms    | [S3,MB7,BI] 782-9-792ms    | [S3,MB4,BW] 792-1-793ms    | [S4,MB5,BW] 793-10-803ms   | [S4,MB6,BW] 803-7-811ms    | [S4,MB7,BW] 810-1-812ms    | [S3,MB5,BW] 812-0-812ms    | [S3,MB6,BW] 812-1-813ms    | [S3,MB7,BW] 813-9-823ms   
[rank0]:2025-12-25 08:16:24,622 - âœ… Scatter Plot of Stage 7 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/afr_time_plot/251225_0816_stage7.svg
[rank3]:2025-12-25 08:16:24,564 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/frozen_ratio_history/rank3/251225_0816_stage3_step200.svg
[rank3]:2025-12-25 08:16:24,606 - âœ… Frozen Ratio History of Rank 3 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/frozen_ratio_history/rank3/251225_0816_stage4_step200.svg
[rank1]:2025-12-25 08:16:24,599 - âœ… Scatter Plot of Stage 6 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/afr_time_plot/251225_0816_stage6.svg
[rank2]:2025-12-25 08:16:24,609 - âœ… Scatter Plot of Stage 5 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/afr_time_plot/251225_0816_stage5.svg
[rank3]:2025-12-25 08:16:24,774 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/afr_time_plot/251225_0816_stage3.svg
[rank3]:2025-12-25 08:16:24,935 - âœ… Scatter Plot of Stage 4 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/afr_time_plot/251225_0816_stage4.svg
[rank0]:2025-12-25 08:19:10,865 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-25 08:19:10,867 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 1.00(1.00)/1.00, [MB2] 1.00(1.00)/1.00, [MB3] 1.00(1.00)/1.00, [MB0] 1.00(1.00)/1.00, [MB4] 1.00(1.00)/1.00, [MB1] 1.00(1.00)/1.00, [MB5] 1.00(1.00)/1.00, [MB2] 1.00(1.00)/1.00, [MB6] 1.00(1.00)/1.00, [MB3] 1.00(1.00)/1.00, [MB7] 0.36(0.40)/0.40, [MB4] 0.79(0.78)/0.78, [MB5] 0.37(0.34)/0.34, [MB6] 0.37(0.38)/0.38, [MB7] 0.89(0.90)/0.90
[rank3]:2025-12-25 08:19:11,294 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB4] 1.00(1.00)/1.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.33(0.35)/0.35, [MB7] 1.00(1.00)/1.00, [MB5] 1.00(1.00)/1.00, [MB6] 1.00(1.00)/1.00, [MB7] 0.00(0.00)/0.00
[rank2]:2025-12-25 08:19:11,285 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB0] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB4] 0.28(0.28)/0.28, [MB5] 1.00(1.00)/1.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.17(0.16)/0.16, [MB6] 1.00(1.00)/1.00, [MB7] 1.00(1.00)/1.00
[rank1]:2025-12-25 08:19:11,289 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB0] 1.00(1.00)/1.00, [MB3] 0.00(0.00)/0.00, [MB1] 0.52(0.51)/0.51, [MB4] 0.00(0.00)/0.00, [MB2] 0.15(0.15)/0.15, [MB5] 0.00(0.00)/0.00, [MB3] 0.19(0.20)/0.20, [MB6] 0.00(0.00)/0.00, [MB4] 0.70(0.69)/0.69, [MB5] 0.81(0.83)/0.83, [MB6] 1.00(1.00)/1.00, [MB7] 0.72(0.74)/0.74, [MB7] 1.00(1.00)/1.00
[rank1]:2025-12-25 08:19:14,682 - Avg. fwd time: 9.8159 / Avg. bwd-weight time: 9.2457 / Avg. bwd-input time: 12.3955 / Avg. batch time: 920.0653 (ms) / GPU bubble ratio: 45.30%
[rank3]:2025-12-25 08:19:14,676 - Avg. fwd time: 7.8098 / Avg. bwd-weight time: 7.7756 / Avg. bwd-input time: 9.7562 / Avg. batch time: 882.2767 (ms) / GPU bubble ratio: 54.04%
[rank2]:2025-12-25 08:19:14,681 - Avg. fwd time: 8.2616 / Avg. bwd-weight time: 8.2593 / Avg. bwd-input time: 10.1378 / Avg. batch time: 894.5758 (ms) / GPU bubble ratio: 52.32%
[rank0]:2025-12-25 08:19:14,691 - Avg. fwd time: 13.4721 / Avg. full-bwd time: 17.1906 (Avg. bwd-weight time: 15.8244 / Avg. bwd-input time: 34.4333) / Avg. batch time: 940.9639 (ms) / GPU bubble ratio: 19.75%
[rank1]:2025-12-25 08:19:14,740 -  step: 250  loss: -4.0000  grad_norm:  1.9025  memory: 17.87GiB(37.61%)  tps: 9,605  tflops: 75.09  mfu: 24.07%
[rank3]:2025-12-25 08:19:14,736 -  step: 250  loss: -4.0000  grad_norm:  1.9025  memory: 15.29GiB(32.17%)  tps: 9,605  tflops: 75.09  mfu: 24.07%
[rank2]:2025-12-25 08:19:14,736 -  step: 250  loss: -4.0000  grad_norm:  1.9025  memory: 13.82GiB(29.09%)  tps: 9,605  tflops: 75.09  mfu: 24.07%
[rank0]:2025-12-25 08:19:14,762 -  step: 250  loss:  0.5152  grad_norm:  1.9025  memory: 36.24GiB(76.29%)  tps: 9,605  tflops: 75.09  mfu: 24.07%
[rank0]:2025-12-25 08:22:00,516 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-25 08:22:00,517 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 1.00(1.00)/1.00, [MB2] 1.00(1.00)/1.00, [MB3] 1.00(1.00)/1.00, [MB0] 1.00(1.00)/1.00, [MB4] 1.00(1.00)/1.00, [MB1] 1.00(1.00)/1.00, [MB5] 1.00(1.00)/1.00, [MB2] 1.00(1.00)/1.00, [MB6] 1.00(1.00)/1.00, [MB3] 1.00(1.00)/1.00, [MB7] 0.36(0.40)/0.40, [MB4] 0.79(0.78)/0.78, [MB5] 0.37(0.34)/0.34, [MB6] 0.37(0.38)/0.38, [MB7] 0.89(0.90)/0.90
[rank3]:2025-12-25 08:22:00,910 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB4] 1.00(1.00)/1.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.33(0.35)/0.35, [MB7] 1.00(1.00)/1.00, [MB5] 1.00(1.00)/1.00, [MB6] 1.00(1.00)/1.00, [MB7] 0.00(0.00)/0.00
[rank2]:2025-12-25 08:22:00,914 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB0] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB4] 0.28(0.28)/0.28, [MB5] 1.00(1.00)/1.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.17(0.16)/0.16, [MB6] 1.00(1.00)/1.00, [MB7] 1.00(1.00)/1.00
[rank1]:2025-12-25 08:22:00,922 - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB0] 1.00(1.00)/1.00, [MB3] 0.00(0.00)/0.00, [MB1] 0.52(0.51)/0.51, [MB4] 0.00(0.00)/0.00, [MB2] 0.15(0.15)/0.15, [MB5] 0.00(0.00)/0.00, [MB3] 0.19(0.20)/0.20, [MB6] 0.00(0.00)/0.00, [MB4] 0.70(0.69)/0.69, [MB5] 0.81(0.83)/0.83, [MB6] 1.00(1.00)/1.00, [MB7] 0.72(0.74)/0.74, [MB7] 1.00(1.00)/1.00
[rank1]:2025-12-25 08:22:04,310 - Avg. fwd time: 9.8100 / Avg. bwd-weight time: 8.9797 / Avg. bwd-input time: 12.4516 / Avg. batch time: 898.5399 (ms) / GPU bubble ratio: 44.37%
[rank3]:2025-12-25 08:22:04,303 - Avg. fwd time: 7.8229 / Avg. bwd-weight time: 7.6659 / Avg. bwd-input time: 9.7966 / Avg. batch time: 861.2524 (ms) / GPU bubble ratio: 53.03%
[rank2]:2025-12-25 08:22:04,307 - Avg. fwd time: 8.2771 / Avg. bwd-weight time: 8.2203 / Avg. bwd-input time: 10.1696 / Avg. batch time: 874.2401 (ms) / GPU bubble ratio: 51.19%
[rank2]:2025-12-25 08:22:04,366 -  step: 300  loss: -4.0000  grad_norm:  0.4299  memory: 13.82GiB(29.09%)  tps: 9,659  tflops: 75.51  mfu: 24.20%
[rank0]:2025-12-25 08:22:04,320 - Avg. fwd time: 13.4030 / Avg. full-bwd time: 15.4866 (Avg. bwd-weight time: 14.2033 / Avg. bwd-input time: 34.3577) / Avg. batch time: 919.2806 (ms) / GPU bubble ratio: 20.94%
[rank1]:2025-12-25 08:22:04,369 -  step: 300  loss: -4.0000  grad_norm:  0.4299  memory: 17.87GiB(37.61%)  tps: 9,659  tflops: 75.51  mfu: 24.20%
[rank3]:2025-12-25 08:22:04,366 -  step: 300  loss: -4.0000  grad_norm:  0.4299  memory: 15.29GiB(32.17%)  tps: 9,659  tflops: 75.51  mfu: 24.20%
[rank2]:2025-12-25 08:22:04,442 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/frozen_ratio_history/rank2/251225_0822_stage2_step300.svg
[rank0]:2025-12-25 08:22:04,391 -  step: 300  loss:  0.3075  grad_norm:  0.4299  memory: 36.24GiB(76.29%)  tps: 9,659  tflops: 75.51  mfu: 24.20%
[rank0]:2025-12-25 08:22:04,443 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/frozen_ratio_history/rank0/251225_0822_stage0_step300.svg
[rank1]:2025-12-25 08:22:04,442 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/frozen_ratio_history/rank1/251225_0822_stage1_step300.svg
[rank1]:2025-12-25 08:22:04,482 - âœ… Frozen Ratio History of Rank 1 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/frozen_ratio_history/rank1/251225_0822_stage6_step300.svg
[rank2]:2025-12-25 08:22:04,482 - âœ… Frozen Ratio History of Rank 2 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/frozen_ratio_history/rank2/251225_0822_stage5_step300.svg
[rank0]:2025-12-25 08:22:04,484 - âœ… Frozen Ratio History of Rank 0 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/frozen_ratio_history/rank0/251225_0822_stage7_step300.svg
[rank3]:2025-12-25 08:22:04,708 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/pipeline_schedule/251225_0822_step300_rank3.svg
[rank3]:			> Batch Time: 811.36 ms, GPU Bubble Ratio: 25.87%, 40.64%, 47.56%, 50.55%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-8-34ms      | [S0,MB4,F]  34-8-42ms      | [S0,MB5,F]  42-9-52ms      | [S0,MB6,F]  52-9-61ms      | [S7,MB0,F]  113-17-130ms   | [S7,MB0,BI] 142-32-174ms   | [S7,MB0,BW] 174-27-201ms   | [S7,MB1,F]  202-16-218ms   | [S7,MB1,BI] 230-34-265ms   | [S7,MB1,BW] 265-0-265ms    | [S7,MB2,F]  265-17-282ms   | [S7,MB2,BI] 294-35-329ms   | [S7,MB2,BW] 330-0-330ms    | [S7,MB3,F]  330-19-349ms   | [S7,MB3,BI] 361-35-396ms   | [S7,MB3,BW] 396-0-396ms    | [S0,MB7,F]  396-10-406ms   | [S0,MB0,B]  407-0-407ms    | [S7,MB4,F]  415-18-433ms   | [S7,MB4,BI] 445-33-479ms   | [S7,MB4,BW] 479-0-479ms    | [S0,MB1,B]  486-0-486ms    | [S7,MB5,F]  491-17-508ms   | [S7,MB5,BI] 518-33-551ms   | [S7,MB5,BW] 552-0-552ms    | [S0,MB2,B]  558-0-558ms    | [S7,MB6,F]  572-15-588ms   | [S7,MB6,BI] 600-33-633ms   | [S7,MB6,BW] 633-0-633ms    | [S0,MB3,B]  640-0-640ms    | [S7,MB7,F]  654-15-669ms   | [S7,MB7,BI] 681-33-714ms   | [S7,MB7,BW] 715-26-741ms   | [S0,MB4,B]  739-12-751ms   | [S0,MB5,B]  754-21-775ms   | [S0,MB6,B]  777-26-804ms   | [S0,MB7,B]  805-5-811ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-21ms      | [S1,MB1,F]  27-10-38ms     | [S1,MB2,F]  44-10-55ms     | [S1,MB3,F]  62-10-73ms     | [S1,MB4,F]  85-10-96ms     | [S6,MB0,F]  96-10-106ms    | [S1,MB5,F]  106-13-119ms   | [S6,MB1,F]  119-8-128ms    | [S6,MB0,BI] 174-9-184ms    | [S6,MB0,BW] 184-10-194ms   | [S6,MB2,F]  194-7-201ms    | [S6,MB1,BI] 265-9-274ms    | [S6,MB1,BW] 274-10-284ms   | [S6,MB3,F]  284-7-292ms    | [S6,MB2,BI] 329-9-339ms    | [S6,MB2,BW] 339-10-350ms   | [S1,MB6,F]  350-10-361ms   | [S1,MB0,BI] 361-15-377ms   | [S1,MB0,BW] 376-0-376ms    | [S6,MB4,F]  376-8-385ms    | [S6,MB3,BI] 396-11-408ms   | [S6,MB3,BW] 407-11-419ms   | [S1,MB7,F]  420-11-431ms   | [S1,MB1,BI] 431-16-447ms   | [S1,MB1,BW] 447-4-452ms    | [S6,MB5,F]  453-8-462ms    | [S6,MB4,BI] 479-12-491ms   | [S6,MB4,BW] 491-10-502ms   | [S1,MB2,BI] 502-14-517ms   | [S1,MB2,BW] 517-13-530ms   | [S6,MB6,F]  558-7-565ms    | [S6,MB5,BI] 565-10-575ms   | [S6,MB5,BW] 575-10-586ms   | [S1,MB3,BI] 586-14-601ms   | [S1,MB3,BW] 601-14-615ms   | [S6,MB7,F]  639-7-647ms    | [S6,MB6,BI] 646-10-657ms   | [S6,MB6,BW] 657-10-668ms   | [S1,MB4,BI] 668-14-683ms   | [S6,MB7,BI] 715-10-726ms   | [S1,MB5,BI] 726-15-741ms   | [S1,MB4,BW] 741-5-746ms    | [S1,MB6,BI] 755-14-769ms   | [S1,MB5,BW] 769-5-775ms    | [S1,MB7,BI] 780-14-794ms   | [S1,MB6,BW] 794-0-794ms    | [S6,MB7,BW] 794-3-797ms    | [S1,MB7,BW] 797-0-797ms   
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-8-29ms      | [S2,MB1,F]  38-7-45ms      | [S2,MB2,F]  55-7-63ms      | [S5,MB0,F]  63-9-72ms      | [S2,MB3,F]  73-9-82ms      | [S5,MB1,F]  82-7-90ms      | [S2,MB4,F]  96-10-106ms    | [S5,MB2,F]  115-8-124ms    | [S5,MB0,BI] 184-9-193ms    | [S5,MB0,BW] 193-10-204ms   | [S5,MB3,F]  204-7-211ms    | [S5,MB1,BI] 274-9-284ms    | [S5,MB1,BW] 284-11-295ms   | [S2,MB5,F]  295-7-302ms    | [S2,MB0,BI] 302-10-313ms   | [S2,MB0,BW] 313-9-322ms    | [S5,MB4,F]  323-7-330ms    | [S5,MB2,BI] 339-10-350ms   | [S5,MB2,BW] 350-10-360ms   | [S2,MB6,F]  362-9-372ms    | [S2,MB1,BI] 373-11-384ms   | [S2,MB1,BW] 384-10-395ms   | [S5,MB5,F]  394-7-402ms    | [S5,MB3,BI] 412-11-423ms   | [S5,MB3,BW] 423-10-434ms   | [S2,MB7,F]  434-9-444ms    | [S2,MB2,BI] 445-11-456ms   | [S2,MB2,BW] 456-10-466ms   | [S5,MB6,F]  466-7-474ms    | [S5,MB4,BI] 491-11-502ms   | [S5,MB4,BW] 502-9-512ms    | [S2,MB3,BI] 561-9-570ms    | [S2,MB3,BW] 571-10-581ms   | [S5,MB7,F]  585-7-592ms    | [S5,MB5,BI] 593-9-602ms    | [S5,MB5,BW] 602-9-612ms    | [S2,MB4,BI] 642-9-652ms    | [S5,MB6,BI] 658-10-668ms   | [S2,MB5,BI] 668-10-679ms   | [S5,MB7,BI] 728-9-737ms    | [S2,MB6,BI] 737-11-748ms   | [S2,MB4,BW] 748-7-756ms    | [S2,MB7,BI] 764-9-773ms    | [S2,MB5,BW] 773-0-773ms    | [S5,MB6,BW] 773-10-784ms   | [S5,MB7,BW] 784-5-790ms    | [S2,MB6,BW] 790-0-790ms    | [S2,MB7,BW] 790-0-790ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-8-37ms      | [S4,MB0,F]  37-8-45ms      | [S3,MB1,F]  46-8-54ms      | [S4,MB1,F]  54-7-62ms      | [S3,MB2,F]  63-7-71ms      | [S4,MB2,F]  71-7-78ms      | [S3,MB3,F]  98-7-105ms     | [S4,MB3,F]  105-8-113ms    | [S4,MB0,BI] 194-9-203ms    | [S4,MB0,BW] 203-9-212ms    | [S3,MB4,F]  212-7-219ms    | [S3,MB0,BI] 219-9-228ms    | [S3,MB0,BW] 229-9-238ms    | [S4,MB4,F]  238-7-246ms    | [S4,MB1,BI] 284-10-294ms   | [S4,MB1,BW] 294-10-304ms   | [S3,MB5,F]  304-8-312ms    | [S3,MB1,BI] 312-9-322ms    | [S3,MB1,BW] 322-9-332ms    | [S4,MB5,F]  332-8-340ms    | [S4,MB2,BI] 366-11-378ms   | [S4,MB2,BW] 378-9-388ms    | [S3,MB6,F]  388-7-395ms    | [S3,MB2,BI] 395-9-405ms    | [S3,MB2,BW] 405-9-415ms    | [S4,MB6,F]  415-8-423ms    | [S4,MB3,BI] 438-12-450ms   | [S4,MB3,BW] 451-9-461ms    | [S3,MB7,F]  461-7-468ms    | [S3,MB3,BI] 468-9-478ms    | [S3,MB3,BW] 478-10-489ms   | [S4,MB7,F]  489-8-497ms    | [S4,MB4,BI] 554-10-565ms   | [S4,MB4,BW] 565-9-574ms    | [S3,MB4,BI] 575-10-585ms   | [S4,MB5,BI] 636-10-646ms   | [S3,MB5,BI] 646-9-655ms    | [S4,MB6,BI] 669-9-678ms    | [S3,MB6,BI] 678-9-687ms    | [S4,MB7,BI] 739-9-748ms    | [S3,MB7,BI] 748-9-757ms    | [S3,MB4,BW] 757-0-757ms    | [S4,MB5,BW] 757-10-768ms   | [S4,MB6,BW] 767-6-774ms    | [S4,MB7,BW] 774-0-774ms    | [S3,MB5,BW] 774-0-774ms    | [S3,MB6,BW] 774-0-774ms    | [S3,MB7,BW] 774-9-783ms   
[rank1]:2025-12-25 08:22:04,774 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/afr_time_plot/251225_0822_stage1.svg
[rank3]:2025-12-25 08:22:04,749 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/frozen_ratio_history/rank3/251225_0822_stage3_step300.svg
[rank3]:2025-12-25 08:22:04,790 - âœ… Frozen Ratio History of Rank 3 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/frozen_ratio_history/rank3/251225_0822_stage4_step300.svg
[rank2]:2025-12-25 08:22:04,774 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/afr_time_plot/251225_0822_stage2.svg
[rank0]:2025-12-25 08:22:04,785 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/afr_time_plot/251225_0822_stage0.svg
[rank2]:2025-12-25 08:22:05,057 - âœ… Scatter Plot of Stage 5 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/afr_time_plot/251225_0822_stage5.svg
[rank1]:2025-12-25 08:22:05,056 - âœ… Scatter Plot of Stage 6 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/afr_time_plot/251225_0822_stage6.svg
[rank3]:2025-12-25 08:22:05,090 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/afr_time_plot/251225_0822_stage3.svg
[rank0]:2025-12-25 08:22:05,088 - âœ… Scatter Plot of Stage 7 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/afr_time_plot/251225_0822_stage7.svg
[rank3]:2025-12-25 08:22:05,381 - âœ… Scatter Plot of Stage 4 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/afr_time_plot/251225_0822_stage4.svg
[rank0]:2025-12-25 08:24:51,340 - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-12-25 08:24:55,132 - Avg. fwd time: 9.8044 / Avg. bwd-weight time: 8.7712 / Avg. bwd-input time: 12.4883 / Avg. batch time: 883.3559 (ms) / GPU bubble ratio: 43.73%
[rank3]:2025-12-25 08:24:55,125 - Avg. fwd time: 7.8326 / Avg. bwd-weight time: 7.5941 / Avg. bwd-input time: 9.8263 / Avg. batch time: 846.2252 (ms) / GPU bubble ratio: 52.25%
[rank2]:2025-12-25 08:24:55,131 - Avg. fwd time: 8.2883 / Avg. bwd-weight time: 8.1911 / Avg. bwd-input time: 10.1917 / Avg. batch time: 859.8989 (ms) / GPU bubble ratio: 50.37%
[rank2]:2025-12-25 08:24:55,182 -  step: 350  loss: -4.0000  grad_norm:  0.1375  memory: 13.82GiB(29.09%)  tps: 9,592  tflops: 74.98  mfu: 24.03%
[rank0]:2025-12-25 08:24:55,136 - Avg. fwd time: 13.3560 / Avg. full-bwd time: 14.3343 (Avg. bwd-weight time: 13.0227 / Avg. bwd-input time: 34.3088) / Avg. batch time: 903.9949 (ms) / GPU bubble ratio: 21.79%
[rank0]:2025-12-25 08:24:55,207 -  step: 350  loss:  0.2399  grad_norm:  0.1375  memory: 36.24GiB(76.29%)  tps: 9,592  tflops: 74.98  mfu: 24.03%
[rank1]:2025-12-25 08:24:55,185 -  step: 350  loss: -4.0000  grad_norm:  0.1375  memory: 17.87GiB(37.61%)  tps: 9,592  tflops: 74.98  mfu: 24.03%
[rank3]:2025-12-25 08:24:55,182 -  step: 350  loss: -4.0000  grad_norm:  0.1375  memory: 15.29GiB(32.17%)  tps: 9,592  tflops: 74.98  mfu: 24.03%
[rank0]:2025-12-25 08:27:40,316 - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-12-25 08:27:44,139 - Avg. fwd time: 8.2976 / Avg. bwd-weight time: 8.1690 / Avg. bwd-input time: 10.2069 / Avg. batch time: 848.6662 (ms) / GPU bubble ratio: 49.71%
[rank1]:2025-12-25 08:27:44,140 - Avg. fwd time: 9.8004 / Avg. bwd-weight time: 8.6281 / Avg. bwd-input time: 12.5186 / Avg. batch time: 871.5260 (ms) / GPU bubble ratio: 43.19%
[rank3]:2025-12-25 08:27:44,135 - Avg. fwd time: 7.8413 / Avg. bwd-weight time: 7.5397 / Avg. bwd-input time: 9.8476 / Avg. batch time: 834.7165 (ms) / GPU bubble ratio: 51.64%
[rank3]:2025-12-25 08:27:44,190 -  step: 400  loss: -4.0000  grad_norm:  0.1792  memory: 15.29GiB(32.17%)  tps: 9,694  tflops: 75.78  mfu: 24.29%
[rank2]:2025-12-25 08:27:44,190 -  step: 400  loss: -4.0000  grad_norm:  0.1792  memory: 13.82GiB(29.09%)  tps: 9,694  tflops: 75.78  mfu: 24.29%
[rank0]:2025-12-25 08:27:44,145 - Avg. fwd time: 13.3148 / Avg. full-bwd time: 13.3969 (Avg. bwd-weight time: 11.9515 / Avg. bwd-input time: 34.2665) / Avg. batch time: 891.8523 (ms) / GPU bubble ratio: 22.64%
[rank0]:2025-12-25 08:27:44,216 -  step: 400  loss:  0.2245  grad_norm:  0.1792  memory: 36.24GiB(76.29%)  tps: 9,694  tflops: 75.78  mfu: 24.29%
[rank1]:2025-12-25 08:27:44,193 -  step: 400  loss: -4.0000  grad_norm:  0.1792  memory: 17.87GiB(37.61%)  tps: 9,694  tflops: 75.79  mfu: 24.29%
[rank1]:2025-12-25 08:27:44,271 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/frozen_ratio_history/rank1/251225_0827_stage1_step400.svg
[rank2]:2025-12-25 08:27:44,270 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/frozen_ratio_history/rank2/251225_0827_stage2_step400.svg
[rank2]:2025-12-25 08:27:44,314 - âœ… Frozen Ratio History of Rank 2 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/frozen_ratio_history/rank2/251225_0827_stage5_step400.svg
[rank0]:2025-12-25 08:27:44,270 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/frozen_ratio_history/rank0/251225_0827_stage0_step400.svg
[rank0]:2025-12-25 08:27:44,316 - âœ… Frozen Ratio History of Rank 0 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/frozen_ratio_history/rank0/251225_0827_stage7_step400.svg
[rank1]:2025-12-25 08:27:44,316 - âœ… Frozen Ratio History of Rank 1 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/frozen_ratio_history/rank1/251225_0827_stage6_step400.svg
[rank3]:2025-12-25 08:27:44,540 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/pipeline_schedule/251225_0827_step400_rank3.svg
[rank3]:			> Batch Time: 813.76 ms, GPU Bubble Ratio: 26.81%, 39.92%, 47.46%, 50.80%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-8-34ms      | [S0,MB4,F]  34-8-42ms      | [S0,MB5,F]  42-9-52ms      | [S0,MB6,F]  52-9-61ms      | [S7,MB0,F]  113-17-130ms   | [S7,MB0,BI] 142-32-175ms   | [S7,MB0,BW] 175-28-203ms   | [S7,MB1,F]  203-16-219ms   | [S7,MB1,BI] 231-34-266ms   | [S7,MB1,BW] 266-0-266ms    | [S7,MB2,F]  266-17-283ms   | [S7,MB2,BI] 295-35-330ms   | [S7,MB2,BW] 330-0-330ms    | [S7,MB3,F]  330-19-350ms   | [S7,MB3,BI] 362-35-397ms   | [S7,MB3,BW] 397-0-397ms    | [S0,MB7,F]  397-10-408ms   | [S0,MB0,B]  408-0-408ms    | [S7,MB4,F]  416-18-434ms   | [S7,MB4,BI] 446-33-480ms   | [S7,MB4,BW] 480-0-480ms    | [S0,MB1,B]  487-0-487ms    | [S7,MB5,F]  491-16-507ms   | [S7,MB5,BI] 519-33-553ms   | [S7,MB5,BW] 553-0-553ms    | [S0,MB2,B]  560-0-560ms    | [S7,MB6,F]  574-15-589ms   | [S7,MB6,BI] 601-33-634ms   | [S7,MB6,BW] 635-0-635ms    | [S0,MB3,B]  642-0-642ms    | [S7,MB7,F]  656-15-671ms   | [S7,MB7,BI] 683-33-716ms   | [S7,MB7,BW] 716-27-743ms   | [S0,MB4,B]  742-11-754ms   | [S0,MB5,B]  755-17-772ms   | [S0,MB6,B]  778-19-797ms   | [S0,MB7,B]  803-10-813ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-21ms      | [S1,MB1,F]  27-10-38ms     | [S1,MB2,F]  44-10-55ms     | [S1,MB3,F]  62-10-73ms     | [S1,MB4,F]  85-10-96ms     | [S6,MB0,F]  96-10-106ms    | [S1,MB5,F]  106-13-119ms   | [S6,MB1,F]  119-8-128ms    | [S6,MB0,BI] 175-9-184ms    | [S6,MB0,BW] 184-10-194ms   | [S6,MB2,F]  194-7-201ms    | [S6,MB1,BI] 266-9-275ms    | [S6,MB1,BW] 275-10-285ms   | [S6,MB3,F]  285-7-292ms    | [S6,MB2,BI] 330-9-340ms    | [S6,MB2,BW] 339-10-350ms   | [S1,MB6,F]  350-11-361ms   | [S1,MB0,BI] 361-15-377ms   | [S1,MB0,BW] 377-0-377ms    | [S6,MB4,F]  377-8-385ms    | [S6,MB3,BI] 397-11-409ms   | [S6,MB3,BW] 409-11-421ms   | [S1,MB7,F]  421-11-432ms   | [S1,MB1,BI] 432-16-448ms   | [S1,MB1,BW] 448-9-458ms    | [S6,MB5,F]  457-8-466ms    | [S6,MB4,BI] 480-12-493ms   | [S6,MB4,BW] 492-11-503ms   | [S1,MB2,BI] 503-14-518ms   | [S1,MB2,BW] 518-13-532ms   | [S6,MB6,F]  559-7-567ms    | [S6,MB5,BI] 566-10-577ms   | [S6,MB5,BW] 577-10-588ms   | [S1,MB3,BI] 587-14-602ms   | [S1,MB3,BW] 602-14-617ms   | [S6,MB7,F]  641-7-648ms    | [S6,MB6,BI] 648-10-659ms   | [S6,MB6,BW] 659-10-670ms   | [S1,MB4,BI] 670-14-685ms   | [S6,MB7,BI] 715-10-726ms   | [S1,MB5,BI] 726-15-742ms   | [S1,MB4,BW] 741-6-748ms    | [S1,MB6,BI] 756-14-770ms   | [S1,MB5,BW] 770-3-774ms    | [S1,MB7,BI] 781-14-796ms   | [S1,MB6,BW] 795-0-795ms    | [S6,MB7,BW] 795-4-800ms    | [S1,MB7,BW] 800-0-800ms   
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-8-29ms      | [S2,MB1,F]  38-7-45ms      | [S2,MB2,F]  55-7-63ms      | [S5,MB0,F]  63-9-72ms      | [S2,MB3,F]  73-9-83ms      | [S5,MB1,F]  83-7-90ms      | [S2,MB4,F]  96-10-106ms    | [S5,MB2,F]  115-8-124ms    | [S5,MB0,BI] 184-9-194ms    | [S5,MB0,BW] 194-10-204ms   | [S5,MB3,F]  204-7-211ms    | [S5,MB1,BI] 275-9-284ms    | [S5,MB1,BW] 284-11-296ms   | [S2,MB5,F]  296-7-303ms    | [S2,MB0,BI] 303-10-313ms   | [S2,MB0,BW] 314-9-323ms    | [S5,MB4,F]  323-7-331ms    | [S5,MB2,BI] 340-10-351ms   | [S5,MB2,BW] 351-10-361ms   | [S2,MB6,F]  362-9-372ms    | [S2,MB1,BI] 374-11-385ms   | [S2,MB1,BW] 385-10-395ms   | [S5,MB5,F]  395-7-403ms    | [S5,MB3,BI] 413-10-424ms   | [S5,MB3,BW] 424-10-435ms   | [S2,MB7,F]  435-9-445ms    | [S2,MB2,BI] 446-11-457ms   | [S2,MB2,BW] 457-10-467ms   | [S5,MB6,F]  467-7-475ms    | [S5,MB4,BI] 493-10-504ms   | [S5,MB4,BW] 504-9-514ms    | [S2,MB3,BI] 562-9-572ms    | [S2,MB3,BW] 572-10-583ms   | [S5,MB7,F]  587-7-594ms    | [S5,MB5,BI] 594-9-604ms    | [S5,MB5,BW] 604-9-613ms    | [S2,MB4,BI] 644-9-654ms    | [S5,MB6,BI] 659-10-670ms   | [S2,MB5,BI] 670-10-681ms   | [S5,MB7,BI] 729-9-738ms    | [S2,MB6,BI] 738-11-750ms   | [S2,MB4,BW] 750-8-758ms    | [S2,MB7,BI] 765-9-775ms    | [S2,MB5,BW] 775-0-775ms    | [S5,MB6,BW] 775-10-785ms   | [S5,MB7,BW] 785-7-792ms    | [S2,MB6,BW] 792-0-792ms    | [S2,MB7,BW] 792-0-792ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-8-37ms      | [S4,MB0,F]  37-8-45ms      | [S3,MB1,F]  46-8-54ms      | [S4,MB1,F]  54-7-62ms      | [S3,MB2,F]  63-7-71ms      | [S4,MB2,F]  71-7-79ms      | [S3,MB3,F]  98-7-105ms     | [S4,MB3,F]  106-8-114ms    | [S4,MB0,BI] 194-9-203ms    | [S4,MB0,BW] 203-9-212ms    | [S3,MB4,F]  212-7-219ms    | [S3,MB0,BI] 219-9-229ms    | [S3,MB0,BW] 229-9-239ms    | [S4,MB4,F]  239-7-247ms    | [S4,MB1,BI] 285-10-295ms   | [S4,MB1,BW] 295-9-305ms    | [S3,MB5,F]  305-8-313ms    | [S3,MB1,BI] 313-9-323ms    | [S3,MB1,BW] 323-9-333ms    | [S4,MB5,F]  333-8-341ms    | [S4,MB2,BI] 367-11-379ms   | [S4,MB2,BW] 379-9-388ms    | [S3,MB6,F]  389-7-396ms    | [S3,MB2,BI] 396-9-406ms    | [S3,MB2,BW] 406-9-416ms    | [S4,MB6,F]  416-8-424ms    | [S4,MB3,BI] 439-12-452ms   | [S4,MB3,BW] 452-9-462ms    | [S3,MB7,F]  462-7-469ms    | [S3,MB3,BI] 469-9-479ms    | [S3,MB3,BW] 479-10-490ms   | [S4,MB7,F]  490-8-498ms    | [S4,MB4,BI] 556-10-566ms   | [S4,MB4,BW] 566-9-576ms    | [S3,MB4,BI] 576-10-587ms   | [S4,MB5,BI] 638-10-648ms   | [S3,MB5,BI] 648-9-657ms    | [S4,MB6,BI] 670-9-680ms    | [S3,MB6,BI] 679-9-689ms    | [S4,MB7,BI] 740-9-750ms    | [S3,MB7,BI] 749-9-759ms    | [S3,MB4,BW] 759-0-759ms    | [S4,MB5,BW] 759-10-769ms   | [S4,MB6,BW] 769-5-774ms    | [S4,MB7,BW] 774-0-774ms    | [S3,MB5,BW] 774-0-774ms    | [S3,MB6,BW] 774-0-774ms    | [S3,MB7,BW] 774-9-784ms   
[rank3]:2025-12-25 08:27:44,584 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/frozen_ratio_history/rank3/251225_0827_stage3_step400.svg
[rank3]:2025-12-25 08:27:44,628 - âœ… Frozen Ratio History of Rank 3 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/frozen_ratio_history/rank3/251225_0827_stage4_step400.svg
[rank2]:2025-12-25 08:27:44,728 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/afr_time_plot/251225_0827_stage2.svg
[rank1]:2025-12-25 08:27:44,736 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/afr_time_plot/251225_0827_stage1.svg
[rank0]:2025-12-25 08:27:44,745 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/afr_time_plot/251225_0827_stage0.svg
[rank3]:2025-12-25 08:27:45,062 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/afr_time_plot/251225_0827_stage3.svg
[rank2]:2025-12-25 08:27:45,136 - âœ… Scatter Plot of Stage 5 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/afr_time_plot/251225_0827_stage5.svg
[rank1]:2025-12-25 08:27:45,148 - âœ… Scatter Plot of Stage 6 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/afr_time_plot/251225_0827_stage6.svg
[rank0]:2025-12-25 08:27:45,178 - âœ… Scatter Plot of Stage 7 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/afr_time_plot/251225_0827_stage7.svg
[rank3]:2025-12-25 08:27:45,497 - âœ… Scatter Plot of Stage 4 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/afr_time_plot/251225_0827_stage4.svg
[rank0]:2025-12-25 08:28:04,347 - Dataset alpaca_gpt4 is being re-looped
[rank3]:2025-12-25 08:28:04,809 - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-12-25 08:28:04,816 - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-12-25 08:28:04,816 - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-12-25 08:30:31,342 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-25 08:30:35,149 - Avg. fwd time: 13.2812 / Avg. full-bwd time: 12.6837 (Avg. bwd-weight time: 11.2383 / Avg. bwd-input time: 34.2308) / Avg. batch time: 882.7889 (ms) / GPU bubble ratio: 23.23%
[rank2]:2025-12-25 08:30:35,141 - Avg. fwd time: 8.3036 / Avg. bwd-weight time: 8.1580 / Avg. bwd-input time: 10.2165 / Avg. batch time: 840.3102 (ms) / GPU bubble ratio: 49.20%
[rank3]:2025-12-25 08:30:35,137 - Avg. fwd time: 7.8468 / Avg. bwd-weight time: 7.4977 / Avg. bwd-input time: 9.8633 / Avg. batch time: 825.8651 (ms) / GPU bubble ratio: 51.16%
[rank3]:2025-12-25 08:30:35,195 -  step: 450  loss: -4.0000  grad_norm:  0.1422  memory: 15.29GiB(32.17%)  tps: 9,581  tflops: 74.90  mfu: 24.01%
[rank1]:2025-12-25 08:30:35,142 - Avg. fwd time: 9.7964 / Avg. bwd-weight time: 8.5126 / Avg. bwd-input time: 12.5399 / Avg. batch time: 862.5515 (ms) / GPU bubble ratio: 42.78%
[rank1]:2025-12-25 08:30:35,199 -  step: 450  loss: -4.0000  grad_norm:  0.1422  memory: 17.87GiB(37.61%)  tps: 9,581  tflops: 74.90  mfu: 24.01%
[rank0]:2025-12-25 08:30:35,222 -  step: 450  loss:  0.2312  grad_norm:  0.1422  memory: 36.24GiB(76.29%)  tps: 9,581  tflops: 74.90  mfu: 24.01%
[rank2]:2025-12-25 08:30:35,196 -  step: 450  loss: -4.0000  grad_norm:  0.1422  memory: 13.82GiB(29.09%)  tps: 9,581  tflops: 74.90  mfu: 24.01%
[rank0]:2025-12-25 08:33:20,436 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-25 08:33:24,245 - Avg. fwd time: 7.8521 / Avg. bwd-weight time: 7.4654 / Avg. bwd-input time: 9.8755 / Avg. batch time: 818.7531 (ms) / GPU bubble ratio: 50.77%
[rank2]:2025-12-25 08:33:24,253 - Avg. fwd time: 8.3088 / Avg. bwd-weight time: 8.1483 / Avg. bwd-input time: 10.2253 / Avg. batch time: 833.4087 (ms) / GPU bubble ratio: 48.77%
[rank2]:2025-12-25 08:33:24,304 -  step: 500  loss: -4.0000  grad_norm:  0.1648  memory: 13.82GiB(29.09%)  tps: 9,688  tflops: 75.74  mfu: 24.28%
[rank0]:2025-12-25 08:33:24,258 - Avg. fwd time: 13.2527 / Avg. full-bwd time: 12.0937 (Avg. bwd-weight time: 10.6692 / Avg. bwd-input time: 34.2003) / Avg. batch time: 875.2131 (ms) / GPU bubble ratio: 23.70%
[rank1]:2025-12-25 08:33:24,256 - Avg. fwd time: 9.7936 / Avg. bwd-weight time: 8.4206 / Avg. bwd-input time: 12.5575 / Avg. batch time: 855.2211 (ms) / GPU bubble ratio: 42.43%
[rank1]:2025-12-25 08:33:24,307 -  step: 500  loss: -4.0000  grad_norm:  0.1648  memory: 17.87GiB(37.61%)  tps: 9,688  tflops: 75.74  mfu: 24.28%
[rank3]:2025-12-25 08:33:24,304 -  step: 500  loss: -4.0000  grad_norm:  0.1648  memory: 15.29GiB(32.17%)  tps: 9,688  tflops: 75.74  mfu: 24.28%
[rank2]:2025-12-25 08:33:24,380 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/frozen_ratio_history/rank2/251225_0833_stage2_step500.svg
[rank0]:2025-12-25 08:33:24,328 -  step: 500  loss:  0.2257  grad_norm:  0.1648  memory: 36.24GiB(76.29%)  tps: 9,689  tflops: 75.74  mfu: 24.28%
[rank0]:2025-12-25 08:33:24,380 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/frozen_ratio_history/rank0/251225_0833_stage0_step500.svg
[rank1]:2025-12-25 08:33:24,379 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/frozen_ratio_history/rank1/251225_0833_stage1_step500.svg
[rank1]:2025-12-25 08:33:24,419 - âœ… Frozen Ratio History of Rank 1 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/frozen_ratio_history/rank1/251225_0833_stage6_step500.svg
[rank2]:2025-12-25 08:33:24,421 - âœ… Frozen Ratio History of Rank 2 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/frozen_ratio_history/rank2/251225_0833_stage5_step500.svg
[rank0]:2025-12-25 08:33:24,422 - âœ… Frozen Ratio History of Rank 0 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/frozen_ratio_history/rank0/251225_0833_stage7_step500.svg
[rank3]:2025-12-25 08:33:24,651 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/pipeline_schedule/251225_0833_step500_rank3.svg
[rank3]:			> Batch Time: 803.91 ms, GPU Bubble Ratio: 30.99%, 39.89%, 46.82%, 50.11%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-8-33ms      | [S0,MB4,F]  33-7-41ms      | [S0,MB5,F]  41-9-51ms      | [S0,MB6,F]  51-8-60ms      | [S7,MB0,F]  112-17-129ms   | [S7,MB0,BI] 141-32-174ms   | [S7,MB0,BW] 174-26-200ms   | [S7,MB1,F]  200-16-217ms   | [S7,MB1,BI] 228-34-262ms   | [S7,MB1,BW] 263-0-263ms    | [S7,MB2,F]  263-18-282ms   | [S7,MB2,BI] 294-35-329ms   | [S7,MB2,BW] 329-0-329ms    | [S7,MB3,F]  329-18-348ms   | [S7,MB3,BI] 359-35-394ms   | [S7,MB3,BW] 394-0-394ms    | [S0,MB7,F]  394-10-405ms   | [S0,MB0,B]  405-0-405ms    | [S7,MB4,F]  412-18-431ms   | [S7,MB4,BI] 443-34-477ms   | [S7,MB4,BW] 477-0-477ms    | [S0,MB1,B]  484-0-484ms    | [S7,MB5,F]  488-16-504ms   | [S7,MB5,BI] 517-33-550ms   | [S7,MB5,BW] 550-0-550ms    | [S0,MB2,B]  557-0-557ms    | [S7,MB6,F]  571-15-586ms   | [S7,MB6,BI] 599-33-632ms   | [S7,MB6,BW] 632-0-632ms    | [S0,MB3,B]  639-0-639ms    | [S7,MB7,F]  653-14-668ms   | [S7,MB7,BI] 680-32-713ms   | [S7,MB7,BW] 713-4-717ms    | [S0,MB4,B]  724-7-732ms    | [S0,MB5,B]  748-17-765ms   | [S0,MB6,B]  774-15-789ms   | [S0,MB7,B]  799-4-803ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  27-10-38ms     | [S1,MB2,F]  44-10-55ms     | [S1,MB3,F]  61-10-72ms     | [S1,MB4,F]  84-10-95ms     | [S6,MB0,F]  95-10-106ms    | [S1,MB5,F]  106-13-119ms   | [S6,MB1,F]  119-8-127ms    | [S6,MB0,BI] 174-9-183ms    | [S6,MB0,BW] 183-10-194ms   | [S6,MB2,F]  193-7-201ms    | [S6,MB1,BI] 263-9-272ms    | [S6,MB1,BW] 272-10-282ms   | [S6,MB3,F]  282-7-290ms    | [S6,MB2,BI] 329-9-338ms    | [S6,MB2,BW] 338-10-349ms   | [S1,MB6,F]  349-10-360ms   | [S1,MB0,BI] 360-15-375ms   | [S1,MB0,BW] 375-0-375ms    | [S6,MB4,F]  375-7-383ms    | [S6,MB3,BI] 394-11-406ms   | [S6,MB3,BW] 406-11-418ms   | [S1,MB7,F]  418-11-429ms   | [S1,MB1,BI] 429-16-445ms   | [S1,MB1,BW] 445-6-451ms    | [S6,MB5,F]  452-8-460ms    | [S6,MB4,BI] 477-12-489ms   | [S6,MB4,BW] 489-10-500ms   | [S1,MB2,BI] 500-14-515ms   | [S1,MB2,BW] 515-14-530ms   | [S6,MB6,F]  557-7-564ms    | [S6,MB5,BI] 564-10-574ms   | [S6,MB5,BW] 574-10-585ms   | [S1,MB3,BI] 585-14-600ms   | [S1,MB3,BW] 600-12-613ms   | [S6,MB7,F]  638-7-646ms    | [S6,MB6,BI] 646-10-656ms   | [S6,MB6,BW] 656-10-667ms   | [S1,MB4,BI] 667-14-682ms   | [S6,MB7,BI] 713-10-724ms   | [S1,MB5,BI] 724-14-739ms   | [S1,MB4,BW] 739-7-747ms    | [S1,MB6,BI] 752-14-767ms   | [S1,MB5,BW] 767-2-770ms    | [S1,MB7,BI] 777-14-792ms   | [S1,MB6,BW] 791-0-791ms    | [S6,MB7,BW] 791-3-795ms    | [S1,MB7,BW] 795-0-795ms   
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  38-7-45ms      | [S2,MB2,F]  55-7-62ms      | [S5,MB0,F]  62-9-72ms      | [S2,MB3,F]  73-9-82ms      | [S5,MB1,F]  82-7-90ms      | [S2,MB4,F]  96-10-106ms    | [S5,MB2,F]  114-8-123ms    | [S5,MB0,BI] 184-9-193ms    | [S5,MB0,BW] 193-10-203ms   | [S5,MB3,F]  203-7-211ms    | [S5,MB1,BI] 272-9-282ms    | [S5,MB1,BW] 282-11-293ms   | [S2,MB5,F]  293-7-300ms    | [S2,MB0,BI] 300-10-311ms   | [S2,MB0,BW] 311-9-321ms    | [S5,MB4,F]  320-7-328ms    | [S5,MB2,BI] 338-10-349ms   | [S5,MB2,BW] 349-10-359ms   | [S2,MB6,F]  361-10-371ms   | [S2,MB1,BI] 372-11-383ms   | [S2,MB1,BW] 383-10-393ms   | [S5,MB5,F]  394-7-402ms    | [S5,MB3,BI] 410-10-421ms   | [S5,MB3,BW] 421-10-432ms   | [S2,MB7,F]  432-9-442ms    | [S2,MB2,BI] 442-11-454ms   | [S2,MB2,BW] 454-10-464ms   | [S5,MB6,F]  464-7-472ms    | [S5,MB4,BI] 490-11-501ms   | [S5,MB4,BW] 501-9-511ms    | [S2,MB3,BI] 559-9-569ms    | [S2,MB3,BW] 569-10-580ms   | [S5,MB7,F]  584-7-592ms    | [S5,MB5,BI] 591-9-601ms    | [S5,MB5,BW] 601-9-611ms    | [S2,MB4,BI] 641-9-651ms    | [S5,MB6,BI] 656-10-667ms   | [S2,MB5,BI] 667-10-678ms   | [S5,MB7,BI] 725-9-734ms    | [S2,MB6,BI] 734-11-746ms   | [S2,MB4,BW] 745-7-753ms    | [S2,MB7,BI] 761-9-771ms    | [S2,MB5,BW] 770-0-770ms    | [S5,MB6,BW] 770-10-781ms   | [S5,MB7,BW] 781-8-789ms    | [S2,MB6,BW] 789-0-789ms    | [S2,MB7,BW] 789-0-789ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-7-37ms      | [S4,MB0,F]  37-8-45ms      | [S3,MB1,F]  46-8-54ms      | [S4,MB1,F]  54-7-61ms      | [S3,MB2,F]  63-7-70ms      | [S4,MB2,F]  71-7-78ms      | [S3,MB3,F]  98-7-105ms     | [S4,MB3,F]  105-8-113ms    | [S4,MB0,BI] 193-9-202ms    | [S4,MB0,BW] 202-9-212ms    | [S3,MB4,F]  211-7-219ms    | [S3,MB0,BI] 218-9-228ms    | [S3,MB0,BW] 228-9-238ms    | [S4,MB4,F]  238-8-246ms    | [S4,MB1,BI] 282-10-292ms   | [S4,MB1,BW] 292-10-302ms   | [S3,MB5,F]  303-8-311ms    | [S3,MB1,BI] 311-9-320ms    | [S3,MB1,BW] 320-9-330ms    | [S4,MB5,F]  330-7-338ms    | [S4,MB2,BI] 366-11-377ms   | [S4,MB2,BW] 377-9-387ms    | [S3,MB6,F]  387-7-394ms    | [S3,MB2,BI] 394-9-404ms    | [S3,MB2,BW] 404-10-414ms   | [S4,MB6,F]  414-8-422ms    | [S4,MB3,BI] 435-12-448ms   | [S4,MB3,BW] 448-9-458ms    | [S3,MB7,F]  458-7-465ms    | [S3,MB3,BI] 465-9-475ms    | [S3,MB3,BW] 475-10-486ms   | [S4,MB7,F]  486-8-495ms    | [S4,MB4,BI] 554-10-564ms   | [S4,MB4,BW] 564-9-573ms    | [S3,MB4,BI] 574-10-584ms   | [S4,MB5,BI] 635-10-645ms   | [S3,MB5,BI] 645-9-654ms    | [S4,MB6,BI] 668-9-677ms    | [S3,MB6,BI] 677-9-686ms    | [S4,MB7,BI] 736-9-745ms    | [S3,MB7,BI] 745-9-754ms    | [S3,MB4,BW] 755-0-755ms    | [S4,MB5,BW] 755-10-765ms   | [S4,MB6,BW] 765-6-771ms    | [S4,MB7,BW] 771-0-771ms    | [S3,MB5,BW] 771-0-771ms    | [S3,MB6,BW] 771-0-771ms    | [S3,MB7,BW] 771-9-780ms   
[rank3]:2025-12-25 08:33:24,691 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/frozen_ratio_history/rank3/251225_0833_stage3_step500.svg
[rank3]:2025-12-25 08:33:24,732 - âœ… Frozen Ratio History of Rank 3 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/frozen_ratio_history/rank3/251225_0833_stage4_step500.svg
[rank2]:2025-12-25 08:33:24,975 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/afr_time_plot/251225_0833_stage2.svg
[rank0]:2025-12-25 08:33:24,995 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/afr_time_plot/251225_0833_stage0.svg
[rank1]:2025-12-25 08:33:24,964 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/afr_time_plot/251225_0833_stage1.svg
[rank3]:2025-12-25 08:33:25,298 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/afr_time_plot/251225_0833_stage3.svg
[rank1]:2025-12-25 08:33:25,515 - âœ… Scatter Plot of Stage 6 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/afr_time_plot/251225_0833_stage6.svg
[rank2]:2025-12-25 08:33:25,515 - âœ… Scatter Plot of Stage 5 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/afr_time_plot/251225_0833_stage5.svg
[rank0]:2025-12-25 08:33:25,573 - âœ… Scatter Plot of Stage 7 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/afr_time_plot/251225_0833_stage7.svg
[rank3]:2025-12-25 08:33:25,869 - âœ… Scatter Plot of Stage 4 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/afr_time_plot/251225_0833_stage4.svg
[rank0]:2025-12-25 08:36:11,744 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-25 08:36:15,576 - Avg. fwd time: 7.8561 / Avg. bwd-weight time: 7.4343 / Avg. bwd-input time: 9.8846 / Avg. batch time: 813.2140 (ms) / GPU bubble ratio: 50.47%
[rank2]:2025-12-25 08:36:15,576 - Avg. fwd time: 8.3132 / Avg. bwd-weight time: 8.1389 / Avg. bwd-input time: 10.2328 / Avg. batch time: 828.1687 (ms) / GPU bubble ratio: 48.45%
[rank0]:2025-12-25 08:36:15,579 - Avg. fwd time: 13.2356 / Avg. full-bwd time: 11.6308 (Avg. bwd-weight time: 10.3020 / Avg. bwd-input time: 34.1770) / Avg. batch time: 869.5725 (ms) / GPU bubble ratio: 24.03%
[rank0]:2025-12-25 08:36:15,637 -  step: 550  loss:  0.2284  grad_norm:  0.1461  memory: 36.24GiB(76.29%)  tps: 9,564  tflops: 74.77  mfu: 23.96%
[rank1]:2025-12-25 08:36:15,578 - Avg. fwd time: 9.7910 / Avg. bwd-weight time: 8.3508 / Avg. bwd-input time: 12.5708 / Avg. batch time: 849.7015 (ms) / GPU bubble ratio: 42.17%
[rank1]:2025-12-25 08:36:15,629 -  step: 550  loss: -4.0000  grad_norm:  0.1461  memory: 17.87GiB(37.61%)  tps: 9,563  tflops: 74.76  mfu: 23.96%
[rank3]:2025-12-25 08:36:15,626 -  step: 550  loss: -4.0000  grad_norm:  0.1461  memory: 15.29GiB(32.17%)  tps: 9,563  tflops: 74.76  mfu: 23.96%
[rank2]:2025-12-25 08:36:15,626 -  step: 550  loss: -4.0000  grad_norm:  0.1461  memory: 13.82GiB(29.09%)  tps: 9,563  tflops: 74.76  mfu: 23.96%
[rank0]:2025-12-25 08:39:00,191 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-25 08:39:04,086 - Avg. fwd time: 7.8590 / Avg. bwd-weight time: 7.4108 / Avg. bwd-input time: 9.8920 / Avg. batch time: 808.2530 (ms) / GPU bubble ratio: 50.19%
[rank2]:2025-12-25 08:39:04,086 - Avg. fwd time: 8.3176 / Avg. bwd-weight time: 8.1326 / Avg. bwd-input time: 10.2373 / Avg. batch time: 823.3296 (ms) / GPU bubble ratio: 48.14%
[rank2]:2025-12-25 08:39:04,147 -  step: 600  loss: -4.0000  grad_norm:  0.1277  memory: 13.82GiB(29.09%)  tps: 9,722  tflops: 76.00  mfu: 24.36%
[rank0]:2025-12-25 08:39:04,101 - Avg. fwd time: 13.2182 / Avg. full-bwd time: 11.2209 (Avg. bwd-weight time: 9.8601 / Avg. bwd-input time: 34.1569) / Avg. batch time: 864.3403 (ms) / GPU bubble ratio: 24.41%
[rank1]:2025-12-25 08:39:04,092 - Avg. fwd time: 9.7893 / Avg. bwd-weight time: 8.2974 / Avg. bwd-input time: 12.5835 / Avg. batch time: 844.5975 (ms) / GPU bubble ratio: 41.90%
[rank1]:2025-12-25 08:39:04,150 -  step: 600  loss: -4.0000  grad_norm:  0.1277  memory: 17.87GiB(37.61%)  tps: 9,722  tflops: 76.00  mfu: 24.36%
[rank3]:2025-12-25 08:39:04,147 -  step: 600  loss: -4.0000  grad_norm:  0.1277  memory: 15.29GiB(32.17%)  tps: 9,722  tflops: 76.00  mfu: 24.36%
[rank2]:2025-12-25 08:39:04,224 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/frozen_ratio_history/rank2/251225_0839_stage2_step600.svg
[rank0]:2025-12-25 08:39:04,172 -  step: 600  loss:  0.2248  grad_norm:  0.1277  memory: 36.24GiB(76.29%)  tps: 9,721  tflops: 76.00  mfu: 24.36%
[rank0]:2025-12-25 08:39:04,225 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/frozen_ratio_history/rank0/251225_0839_stage0_step600.svg
[rank0]:2025-12-25 08:39:04,268 - âœ… Frozen Ratio History of Rank 0 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/frozen_ratio_history/rank0/251225_0839_stage7_step600.svg
[rank1]:2025-12-25 08:39:04,224 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/frozen_ratio_history/rank1/251225_0839_stage1_step600.svg
[rank1]:2025-12-25 08:39:04,265 - âœ… Frozen Ratio History of Rank 1 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/frozen_ratio_history/rank1/251225_0839_stage6_step600.svg
[rank2]:2025-12-25 08:39:04,266 - âœ… Frozen Ratio History of Rank 2 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/frozen_ratio_history/rank2/251225_0839_stage5_step600.svg
[rank3]:2025-12-25 08:39:04,490 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/pipeline_schedule/251225_0839_step600_rank3.svg
[rank3]:			> Batch Time: 809.83 ms, GPU Bubble Ratio: 30.11%, 40.56%, 47.14%, 50.54%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-8-33ms      | [S0,MB4,F]  33-7-41ms      | [S0,MB5,F]  41-9-51ms      | [S0,MB6,F]  51-8-60ms      | [S7,MB0,F]  112-17-130ms   | [S7,MB0,BI] 142-32-174ms   | [S7,MB0,BW] 174-27-202ms   | [S7,MB1,F]  201-16-218ms   | [S7,MB1,BI] 230-34-265ms   | [S7,MB1,BW] 265-0-265ms    | [S7,MB2,F]  265-18-283ms   | [S7,MB2,BI] 294-35-330ms   | [S7,MB2,BW] 330-0-330ms    | [S7,MB3,F]  330-18-349ms   | [S7,MB3,BI] 360-35-395ms   | [S7,MB3,BW] 395-0-395ms    | [S0,MB7,F]  395-10-406ms   | [S0,MB0,B]  406-0-406ms    | [S7,MB4,F]  414-18-432ms   | [S7,MB4,BI] 444-34-478ms   | [S7,MB4,BW] 477-0-477ms    | [S0,MB1,B]  484-0-484ms    | [S7,MB5,F]  488-18-506ms   | [S7,MB5,BI] 518-33-551ms   | [S7,MB5,BW] 552-0-552ms    | [S0,MB2,B]  558-0-558ms    | [S7,MB6,F]  573-15-588ms   | [S7,MB6,BI] 600-33-633ms   | [S7,MB6,BW] 633-0-633ms    | [S0,MB3,B]  640-0-640ms    | [S7,MB7,F]  655-15-670ms   | [S7,MB7,BI] 682-33-715ms   | [S7,MB7,BW] 715-4-719ms    | [S0,MB4,B]  726-13-739ms   | [S0,MB5,B]  749-16-765ms   | [S0,MB6,B]  775-14-790ms   | [S0,MB7,B]  800-9-809ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  27-10-38ms     | [S1,MB2,F]  44-10-55ms     | [S1,MB3,F]  61-10-72ms     | [S1,MB4,F]  84-10-95ms     | [S6,MB0,F]  95-10-106ms    | [S1,MB5,F]  106-13-119ms   | [S6,MB1,F]  119-8-128ms    | [S6,MB0,BI] 174-9-184ms    | [S6,MB0,BW] 184-10-194ms   | [S6,MB2,F]  194-7-201ms    | [S6,MB1,BI] 264-9-273ms    | [S6,MB1,BW] 273-10-284ms   | [S6,MB3,F]  284-7-291ms    | [S6,MB2,BI] 330-9-339ms    | [S6,MB2,BW] 339-10-350ms   | [S1,MB6,F]  350-10-361ms   | [S1,MB0,BI] 361-15-377ms   | [S1,MB0,BW] 377-0-377ms    | [S6,MB4,F]  377-7-385ms    | [S6,MB3,BI] 395-11-407ms   | [S6,MB3,BW] 407-11-419ms   | [S1,MB7,F]  419-11-430ms   | [S1,MB1,BI] 430-16-446ms   | [S1,MB1,BW] 446-7-454ms    | [S6,MB5,F]  455-8-464ms    | [S6,MB4,BI] 477-12-490ms   | [S6,MB4,BW] 490-10-501ms   | [S1,MB2,BI] 501-14-515ms   | [S1,MB2,BW] 515-12-527ms   | [S6,MB6,F]  558-7-565ms    | [S6,MB5,BI] 565-10-576ms   | [S6,MB5,BW] 575-10-586ms   | [S1,MB3,BI] 586-14-600ms   | [S1,MB3,BW] 601-13-614ms   | [S6,MB7,F]  640-7-647ms    | [S6,MB6,BI] 647-10-658ms   | [S6,MB6,BW] 657-10-668ms   | [S1,MB4,BI] 668-14-683ms   | [S6,MB7,BI] 715-10-726ms   | [S1,MB5,BI] 726-14-741ms   | [S1,MB4,BW] 741-7-748ms    | [S1,MB6,BI] 754-14-768ms   | [S1,MB5,BW] 768-2-771ms    | [S1,MB7,BI] 778-14-793ms   | [S1,MB6,BW] 793-0-793ms    | [S6,MB7,BW] 793-2-796ms    | [S1,MB7,BW] 796-0-796ms   
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  38-7-45ms      | [S2,MB2,F]  55-7-62ms      | [S5,MB0,F]  62-9-72ms      | [S2,MB3,F]  73-9-82ms      | [S5,MB1,F]  82-7-90ms      | [S2,MB4,F]  96-10-106ms    | [S5,MB2,F]  114-8-123ms    | [S5,MB0,BI] 184-9-193ms    | [S5,MB0,BW] 193-10-204ms   | [S5,MB3,F]  203-7-211ms    | [S5,MB1,BI] 274-9-283ms    | [S5,MB1,BW] 283-11-294ms   | [S2,MB5,F]  294-7-301ms    | [S2,MB0,BI] 301-10-312ms   | [S2,MB0,BW] 312-9-322ms    | [S5,MB4,F]  322-7-330ms    | [S5,MB2,BI] 339-10-350ms   | [S5,MB2,BW] 350-10-361ms   | [S2,MB6,F]  362-10-372ms   | [S2,MB1,BI] 373-11-384ms   | [S2,MB1,BW] 384-10-395ms   | [S5,MB5,F]  394-7-402ms    | [S5,MB3,BI] 411-10-422ms   | [S5,MB3,BW] 422-10-432ms   | [S2,MB7,F]  432-9-442ms    | [S2,MB2,BI] 443-11-455ms   | [S2,MB2,BW] 455-10-465ms   | [S5,MB6,F]  465-7-473ms    | [S5,MB4,BI] 490-11-501ms   | [S5,MB4,BW] 501-9-511ms    | [S2,MB3,BI] 561-9-571ms    | [S2,MB3,BW] 570-10-581ms   | [S5,MB7,F]  585-7-593ms    | [S5,MB5,BI] 593-9-603ms    | [S5,MB5,BW] 602-9-612ms    | [S2,MB4,BI] 643-9-653ms    | [S5,MB6,BI] 658-10-669ms   | [S2,MB5,BI] 668-10-679ms   | [S5,MB7,BI] 726-9-736ms    | [S2,MB6,BI] 736-11-747ms   | [S2,MB4,BW] 747-8-756ms    | [S2,MB7,BI] 762-9-772ms    | [S2,MB5,BW] 772-0-772ms    | [S5,MB6,BW] 772-10-782ms   | [S5,MB7,BW] 782-7-790ms    | [S2,MB6,BW] 790-0-790ms    | [S2,MB7,BW] 790-0-790ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-8-37ms      | [S4,MB0,F]  37-8-45ms      | [S3,MB1,F]  46-8-54ms      | [S4,MB1,F]  54-7-62ms      | [S3,MB2,F]  63-7-71ms      | [S4,MB2,F]  71-7-78ms      | [S3,MB3,F]  98-7-105ms     | [S4,MB3,F]  105-8-113ms    | [S4,MB0,BI] 193-9-202ms    | [S4,MB0,BW] 203-9-212ms    | [S3,MB4,F]  212-7-219ms    | [S3,MB0,BI] 219-9-228ms    | [S3,MB0,BW] 228-9-238ms    | [S4,MB4,F]  238-8-246ms    | [S4,MB1,BI] 283-10-293ms   | [S4,MB1,BW] 293-10-303ms   | [S3,MB5,F]  303-8-312ms    | [S3,MB1,BI] 312-9-321ms    | [S3,MB1,BW] 321-9-331ms    | [S4,MB5,F]  331-7-339ms    | [S4,MB2,BI] 366-11-378ms   | [S4,MB2,BW] 378-9-388ms    | [S3,MB6,F]  388-7-395ms    | [S3,MB2,BI] 395-9-405ms    | [S3,MB2,BW] 405-9-415ms    | [S4,MB6,F]  415-8-423ms    | [S4,MB3,BI] 437-12-449ms   | [S4,MB3,BW] 449-9-459ms    | [S3,MB7,F]  459-7-467ms    | [S3,MB3,BI] 467-9-476ms    | [S3,MB3,BW] 476-10-487ms   | [S4,MB7,F]  487-8-496ms    | [S4,MB4,BI] 555-10-565ms   | [S4,MB4,BW] 565-9-575ms    | [S3,MB4,BI] 575-10-585ms   | [S4,MB5,BI] 636-10-646ms   | [S3,MB5,BI] 646-9-655ms    | [S4,MB6,BI] 669-9-678ms    | [S3,MB6,BI] 678-9-687ms    | [S4,MB7,BI] 737-9-746ms    | [S3,MB7,BI] 747-9-756ms    | [S3,MB4,BW] 756-0-756ms    | [S4,MB5,BW] 756-10-766ms   | [S4,MB6,BW] 766-6-772ms    | [S4,MB7,BW] 772-0-772ms    | [S3,MB5,BW] 772-0-772ms    | [S3,MB6,BW] 772-0-772ms    | [S3,MB7,BW] 772-9-782ms   
[rank3]:2025-12-25 08:39:04,531 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/frozen_ratio_history/rank3/251225_0839_stage3_step600.svg
[rank3]:2025-12-25 08:39:04,573 - âœ… Frozen Ratio History of Rank 3 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/frozen_ratio_history/rank3/251225_0839_stage4_step600.svg
[rank2]:2025-12-25 08:39:04,941 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/afr_time_plot/251225_0839_stage2.svg
[rank0]:2025-12-25 08:39:04,963 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/afr_time_plot/251225_0839_stage0.svg
[rank1]:2025-12-25 08:39:04,935 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/afr_time_plot/251225_0839_stage1.svg
[rank3]:2025-12-25 08:39:05,279 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/afr_time_plot/251225_0839_stage3.svg
[rank2]:2025-12-25 08:39:05,615 - âœ… Scatter Plot of Stage 5 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/afr_time_plot/251225_0839_stage5.svg
[rank1]:2025-12-25 08:39:05,615 - âœ… Scatter Plot of Stage 6 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/afr_time_plot/251225_0839_stage6.svg
[rank0]:2025-12-25 08:39:05,672 - âœ… Scatter Plot of Stage 7 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/afr_time_plot/251225_0839_stage7.svg
[rank3]:2025-12-25 08:39:05,959 - âœ… Scatter Plot of Stage 4 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/afr_time_plot/251225_0839_stage4.svg
[rank0]:2025-12-25 08:41:51,173 - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-12-25 08:41:55,012 - Avg. fwd time: 9.7871 / Avg. bwd-weight time: 8.2363 / Avg. bwd-input time: 12.5934 / Avg. batch time: 840.3340 (ms) / GPU bubble ratio: 41.71%
[rank3]:2025-12-25 08:41:55,003 - Avg. fwd time: 7.8619 / Avg. bwd-weight time: 7.3934 / Avg. bwd-input time: 9.8986 / Avg. batch time: 804.1316 (ms) / GPU bubble ratio: 49.95%
[rank3]:2025-12-25 08:41:55,063 -  step: 650  loss: -4.0000  grad_norm:  0.1239  memory: 15.29GiB(32.17%)  tps: 9,586  tflops: 74.94  mfu: 24.02%
[rank0]:2025-12-25 08:41:55,018 - Avg. fwd time: 13.2032 / Avg. full-bwd time: 10.9060 (Avg. bwd-weight time: 9.6121 / Avg. bwd-input time: 34.1395) / Avg. batch time: 860.1738 (ms) / GPU bubble ratio: 24.61%
[rank0]:2025-12-25 08:41:55,089 -  step: 650  loss:  0.2321  grad_norm:  0.1239  memory: 36.24GiB(76.29%)  tps: 9,586  tflops: 74.94  mfu: 24.02%
[rank2]:2025-12-25 08:41:55,008 - Avg. fwd time: 8.3217 / Avg. bwd-weight time: 8.1249 / Avg. bwd-input time: 10.2433 / Avg. batch time: 819.3600 (ms) / GPU bubble ratio: 47.88%
[rank2]:2025-12-25 08:41:55,063 -  step: 650  loss: -4.0000  grad_norm:  0.1239  memory: 13.82GiB(29.09%)  tps: 9,586  tflops: 74.94  mfu: 24.02%
[rank1]:2025-12-25 08:41:55,067 -  step: 650  loss: -4.0000  grad_norm:  0.1239  memory: 17.87GiB(37.61%)  tps: 9,586  tflops: 74.94  mfu: 24.02%
[rank0]:2025-12-25 08:44:40,584 - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-12-25 08:44:44,422 - Avg. fwd time: 9.7850 / Avg. bwd-weight time: 8.1938 / Avg. bwd-input time: 12.6023 / Avg. batch time: 836.6805 (ms) / GPU bubble ratio: 41.52%
[rank2]:2025-12-25 08:44:44,420 - Avg. fwd time: 8.3251 / Avg. bwd-weight time: 8.1214 / Avg. bwd-input time: 10.2474 / Avg. batch time: 815.8518 (ms) / GPU bubble ratio: 47.65%
[rank0]:2025-12-25 08:44:44,426 - Avg. fwd time: 13.1896 / Avg. full-bwd time: 10.6563 (Avg. bwd-weight time: 9.3210 / Avg. bwd-input time: 34.1245) / Avg. batch time: 856.4766 (ms) / GPU bubble ratio: 24.83%
[rank3]:2025-12-25 08:44:44,414 - Avg. fwd time: 7.8642 / Avg. bwd-weight time: 7.3741 / Avg. bwd-input time: 9.9045 / Avg. batch time: 800.5024 (ms) / GPU bubble ratio: 49.75%
[rank3]:2025-12-25 08:44:44,472 -  step: 700  loss: -4.0000  grad_norm:  0.1350  memory: 15.29GiB(32.17%)  tps: 9,671  tflops: 75.61  mfu: 24.23%
[rank1]:2025-12-25 08:44:44,475 -  step: 700  loss: -4.0000  grad_norm:  0.1350  memory: 17.87GiB(37.61%)  tps: 9,671  tflops: 75.61  mfu: 24.23%
[rank2]:2025-12-25 08:44:44,472 -  step: 700  loss: -4.0000  grad_norm:  0.1350  memory: 13.82GiB(29.09%)  tps: 9,671  tflops: 75.61  mfu: 24.23%
[rank0]:2025-12-25 08:44:44,497 -  step: 700  loss:  0.1925  grad_norm:  0.1350  memory: 36.24GiB(76.29%)  tps: 9,671  tflops: 75.61  mfu: 24.23%
[rank1]:2025-12-25 08:44:44,550 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/frozen_ratio_history/rank1/251225_0844_stage1_step700.svg
[rank1]:2025-12-25 08:44:44,594 - âœ… Frozen Ratio History of Rank 1 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/frozen_ratio_history/rank1/251225_0844_stage6_step700.svg
[rank2]:2025-12-25 08:44:44,550 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/frozen_ratio_history/rank2/251225_0844_stage2_step700.svg
[rank2]:2025-12-25 08:44:44,593 - âœ… Frozen Ratio History of Rank 2 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/frozen_ratio_history/rank2/251225_0844_stage5_step700.svg
[rank0]:2025-12-25 08:44:44,551 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/frozen_ratio_history/rank0/251225_0844_stage0_step700.svg
[rank0]:2025-12-25 08:44:44,595 - âœ… Frozen Ratio History of Rank 0 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/frozen_ratio_history/rank0/251225_0844_stage7_step700.svg
[rank3]:2025-12-25 08:44:44,813 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/pipeline_schedule/251225_0844_step700_rank3.svg
[rank3]:			> Batch Time: 812.02 ms, GPU Bubble Ratio: 27.20%, 40.23%, 47.01%, 50.94%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-8-34ms      | [S0,MB4,F]  34-8-42ms      | [S0,MB5,F]  42-9-52ms      | [S0,MB6,F]  52-9-61ms      | [S7,MB0,F]  113-17-130ms   | [S7,MB0,BI] 142-32-174ms   | [S7,MB0,BW] 174-27-202ms   | [S7,MB1,F]  202-16-219ms   | [S7,MB1,BI] 230-34-265ms   | [S7,MB1,BW] 265-0-265ms    | [S7,MB2,F]  265-17-283ms   | [S7,MB2,BI] 295-35-330ms   | [S7,MB2,BW] 330-0-330ms    | [S7,MB3,F]  330-18-349ms   | [S7,MB3,BI] 361-35-396ms   | [S7,MB3,BW] 396-0-396ms    | [S0,MB7,F]  396-10-406ms   | [S0,MB0,B]  407-0-407ms    | [S7,MB4,F]  414-18-433ms   | [S7,MB4,BI] 444-33-478ms   | [S7,MB4,BW] 478-0-478ms    | [S0,MB1,B]  485-0-485ms    | [S7,MB5,F]  489-17-507ms   | [S7,MB5,BI] 518-33-551ms   | [S7,MB5,BW] 552-0-552ms    | [S0,MB2,B]  559-0-559ms    | [S7,MB6,F]  573-15-588ms   | [S7,MB6,BI] 600-33-633ms   | [S7,MB6,BW] 633-0-633ms    | [S0,MB3,B]  640-0-640ms    | [S7,MB7,F]  655-15-670ms   | [S7,MB7,BI] 682-33-715ms   | [S7,MB7,BW] 716-27-743ms   | [S0,MB4,B]  742-7-750ms    | [S0,MB5,B]  751-19-770ms   | [S0,MB6,B]  778-19-798ms   | [S0,MB7,B]  802-9-812ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-21ms      | [S1,MB1,F]  27-10-38ms     | [S1,MB2,F]  44-10-55ms     | [S1,MB3,F]  62-10-73ms     | [S1,MB4,F]  85-10-96ms     | [S6,MB0,F]  95-10-106ms    | [S1,MB5,F]  106-13-119ms   | [S6,MB1,F]  119-8-127ms    | [S6,MB0,BI] 174-9-184ms    | [S6,MB0,BW] 184-10-194ms   | [S6,MB2,F]  194-7-201ms    | [S6,MB1,BI] 265-9-274ms    | [S6,MB1,BW] 274-10-285ms   | [S6,MB3,F]  285-7-292ms    | [S6,MB2,BI] 330-9-339ms    | [S6,MB2,BW] 339-10-350ms   | [S1,MB6,F]  350-10-361ms   | [S1,MB0,BI] 361-15-377ms   | [S1,MB0,BW] 377-0-377ms    | [S6,MB4,F]  377-7-385ms    | [S6,MB3,BI] 396-11-407ms   | [S6,MB3,BW] 407-11-419ms   | [S1,MB7,F]  419-11-430ms   | [S1,MB1,BI] 430-16-447ms   | [S1,MB1,BW] 446-9-456ms    | [S6,MB5,F]  456-8-465ms    | [S6,MB4,BI] 478-12-491ms   | [S6,MB4,BW] 491-10-502ms   | [S1,MB2,BI] 501-14-516ms   | [S1,MB2,BW] 516-13-530ms   | [S6,MB6,F]  558-7-565ms    | [S6,MB5,BI] 565-10-576ms   | [S6,MB5,BW] 575-10-586ms   | [S1,MB3,BI] 586-14-601ms   | [S1,MB3,BW] 601-11-613ms   | [S6,MB7,F]  639-7-647ms    | [S6,MB6,BI] 647-10-657ms   | [S6,MB6,BW] 657-10-668ms   | [S1,MB4,BI] 668-14-683ms   | [S6,MB7,BI] 715-10-726ms   | [S1,MB5,BI] 726-15-741ms   | [S1,MB4,BW] 741-7-749ms    | [S1,MB6,BI] 755-14-770ms   | [S1,MB5,BW] 770-4-775ms    | [S1,MB7,BI] 780-14-795ms   | [S1,MB6,BW] 795-0-795ms    | [S6,MB7,BW] 795-2-798ms    | [S1,MB7,BW] 798-0-798ms   
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-8-29ms      | [S2,MB1,F]  38-7-45ms      | [S2,MB2,F]  55-7-63ms      | [S5,MB0,F]  63-9-72ms      | [S2,MB3,F]  73-9-82ms      | [S5,MB1,F]  82-7-90ms      | [S2,MB4,F]  96-10-106ms    | [S5,MB2,F]  115-8-123ms    | [S5,MB0,BI] 184-9-193ms    | [S5,MB0,BW] 193-10-204ms   | [S5,MB3,F]  203-7-211ms    | [S5,MB1,BI] 275-9-284ms    | [S5,MB1,BW] 284-11-295ms   | [S2,MB5,F]  295-7-303ms    | [S2,MB0,BI] 303-10-313ms   | [S2,MB0,BW] 313-9-323ms    | [S5,MB4,F]  323-7-330ms    | [S5,MB2,BI] 340-11-351ms   | [S5,MB2,BW] 351-10-361ms   | [S2,MB6,F]  362-10-372ms   | [S2,MB1,BI] 374-11-385ms   | [S2,MB1,BW] 385-10-395ms   | [S5,MB5,F]  395-7-403ms    | [S5,MB3,BI] 411-10-422ms   | [S5,MB3,BW] 422-10-433ms   | [S2,MB7,F]  433-10-443ms   | [S2,MB2,BI] 444-11-456ms   | [S2,MB2,BW] 456-10-466ms   | [S5,MB6,F]  466-7-474ms    | [S5,MB4,BI] 491-11-502ms   | [S5,MB4,BW] 502-9-512ms    | [S2,MB3,BI] 561-9-571ms    | [S2,MB3,BW] 571-10-581ms   | [S5,MB7,F]  585-7-592ms    | [S5,MB5,BI] 593-9-602ms    | [S5,MB5,BW] 602-9-612ms    | [S2,MB4,BI] 643-9-652ms    | [S5,MB6,BI] 658-10-668ms   | [S2,MB5,BI] 668-10-679ms   | [S5,MB7,BI] 728-9-737ms    | [S2,MB6,BI] 737-11-749ms   | [S2,MB4,BW] 749-8-757ms    | [S2,MB7,BI] 764-9-774ms    | [S2,MB5,BW] 774-0-774ms    | [S5,MB6,BW] 774-10-784ms   | [S5,MB7,BW] 785-9-794ms    | [S2,MB6,BW] 794-0-794ms    | [S2,MB7,BW] 794-0-794ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-7-37ms      | [S4,MB0,F]  37-8-45ms      | [S3,MB1,F]  46-8-54ms      | [S4,MB1,F]  54-7-62ms      | [S3,MB2,F]  63-7-71ms      | [S4,MB2,F]  71-7-79ms      | [S3,MB3,F]  98-7-105ms     | [S4,MB3,F]  105-8-113ms    | [S4,MB0,BI] 193-9-202ms    | [S4,MB0,BW] 202-9-212ms    | [S3,MB4,F]  212-7-219ms    | [S3,MB0,BI] 219-9-229ms    | [S3,MB0,BW] 229-9-238ms    | [S4,MB4,F]  238-8-246ms    | [S4,MB1,BI] 284-10-294ms   | [S4,MB1,BW] 294-10-305ms   | [S3,MB5,F]  305-8-313ms    | [S3,MB1,BI] 313-9-322ms    | [S3,MB1,BW] 322-9-332ms    | [S4,MB5,F]  332-7-340ms    | [S4,MB2,BI] 367-11-379ms   | [S4,MB2,BW] 379-9-389ms    | [S3,MB6,F]  388-7-396ms    | [S3,MB2,BI] 396-9-405ms    | [S3,MB2,BW] 405-9-415ms    | [S4,MB6,F]  415-8-424ms    | [S4,MB3,BI] 437-12-450ms   | [S4,MB3,BW] 449-9-459ms    | [S3,MB7,F]  459-7-467ms    | [S3,MB3,BI] 467-9-477ms    | [S3,MB3,BW] 476-10-487ms   | [S4,MB7,F]  488-8-497ms    | [S4,MB4,BI] 555-10-565ms   | [S4,MB4,BW] 565-9-575ms    | [S3,MB4,BI] 575-10-586ms   | [S4,MB5,BI] 636-10-646ms   | [S3,MB5,BI] 646-9-655ms    | [S4,MB6,BI] 669-9-678ms    | [S3,MB6,BI] 678-9-688ms    | [S4,MB7,BI] 739-9-748ms    | [S3,MB7,BI] 749-9-758ms    | [S3,MB4,BW] 758-0-758ms    | [S4,MB5,BW] 758-10-768ms   | [S4,MB6,BW] 768-4-773ms    | [S4,MB7,BW] 773-0-773ms    | [S3,MB5,BW] 773-0-773ms    | [S3,MB6,BW] 773-0-773ms    | [S3,MB7,BW] 773-9-783ms   
[rank3]:2025-12-25 08:44:44,856 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/frozen_ratio_history/rank3/251225_0844_stage3_step700.svg
[rank3]:2025-12-25 08:44:44,898 - âœ… Frozen Ratio History of Rank 3 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/frozen_ratio_history/rank3/251225_0844_stage4_step700.svg
[rank1]:2025-12-25 08:44:45,399 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/afr_time_plot/251225_0844_stage1.svg
[rank2]:2025-12-25 08:44:45,406 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/afr_time_plot/251225_0844_stage2.svg
[rank0]:2025-12-25 08:44:45,430 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/afr_time_plot/251225_0844_stage0.svg
[rank3]:2025-12-25 08:44:45,739 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/afr_time_plot/251225_0844_stage3.svg
[rank1]:2025-12-25 08:44:46,202 - âœ… Scatter Plot of Stage 6 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/afr_time_plot/251225_0844_stage6.svg
[rank2]:2025-12-25 08:44:46,204 - âœ… Scatter Plot of Stage 5 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/afr_time_plot/251225_0844_stage5.svg
[rank0]:2025-12-25 08:44:46,278 - âœ… Scatter Plot of Stage 7 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/afr_time_plot/251225_0844_stage7.svg
[rank3]:2025-12-25 08:44:46,540 - âœ… Scatter Plot of Stage 4 is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/afr_time_plot/251225_0844_stage4.svg
[rank0]:2025-12-25 08:47:31,163 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-25 08:47:34,990 - Avg. fwd time: 7.8655 / Avg. bwd-weight time: 7.3566 / Avg. bwd-input time: 9.9087 / Avg. batch time: 797.3656 (ms) / GPU bubble ratio: 49.57%
[rank0]:2025-12-25 08:47:35,003 - Avg. fwd time: 13.1772 / Avg. full-bwd time: 10.3615 (Avg. bwd-weight time: 9.0665 / Avg. bwd-input time: 34.1110) / Avg. batch time: 853.2673 (ms) / GPU bubble ratio: 25.09%
[rank0]:2025-12-25 08:47:35,056 -  step: 750  loss:  0.2345  grad_norm:  0.1632  memory: 36.24GiB(76.29%)  tps: 9,606  tflops: 75.10  mfu: 24.07%
[rank2]:2025-12-25 08:47:34,997 - Avg. fwd time: 8.3287 / Avg. bwd-weight time: 8.1175 / Avg. bwd-input time: 10.2517 / Avg. batch time: 812.8981 (ms) / GPU bubble ratio: 47.45%
[rank2]:2025-12-25 08:47:35,045 -  step: 750  loss: -4.0000  grad_norm:  0.1632  memory: 13.82GiB(29.09%)  tps: 9,605  tflops: 75.09  mfu: 24.07%
[rank1]:2025-12-25 08:47:34,999 - Avg. fwd time: 9.7832 / Avg. bwd-weight time: 8.1508 / Avg. bwd-input time: 12.6104 / Avg. batch time: 833.5126 (ms) / GPU bubble ratio: 41.37%
[rank1]:2025-12-25 08:47:35,048 -  step: 750  loss: -4.0000  grad_norm:  0.1632  memory: 17.87GiB(37.61%)  tps: 9,605  tflops: 75.09  mfu: 24.07%
[rank3]:2025-12-25 08:47:35,045 -  step: 750  loss: -4.0000  grad_norm:  0.1632  memory: 15.29GiB(32.17%)  tps: 9,605  tflops: 75.09  mfu: 24.07%
[rank0]:2025-12-25 08:50:20,032 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-25 08:50:23,900 - Avg. fwd time: 7.8668 / Avg. bwd-weight time: 7.3445 / Avg. bwd-input time: 9.9123 / Avg. batch time: 794.6620 (ms) / GPU bubble ratio: 49.42%
[rank3]:2025-12-25 08:50:23,950 -  step: 800  loss: -4.0000  grad_norm:  0.1356  memory: 15.29GiB(32.17%)  tps: 9,700  tflops: 75.83  mfu: 24.30%
[rank3]:2025-12-25 08:50:23,950 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  0.1356  tps: 9,751  tflops: 76.23  mfu: 22.27%
[rank3]:2025-12-25 08:50:23,950 - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-12-25 08:50:23,951 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank2]:2025-12-25 08:50:23,902 - Avg. fwd time: 8.3321 / Avg. bwd-weight time: 8.1128 / Avg. bwd-input time: 10.2549 / Avg. batch time: 810.2194 (ms) / GPU bubble ratio: 47.27%
[rank2]:2025-12-25 08:50:23,950 -  step: 800  loss: -4.0000  grad_norm:  0.1356  memory: 13.82GiB(29.09%)  tps: 9,700  tflops: 75.83  mfu: 24.30%
[rank2]:2025-12-25 08:50:23,950 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  0.1356  tps: 9,751  tflops: 76.23  mfu: 22.28%
[rank2]:2025-12-25 08:50:23,951 - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-12-25 08:50:23,951 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-25 08:50:23,909 - Avg. fwd time: 13.1675 / Avg. full-bwd time: 10.1399 (Avg. bwd-weight time: 8.8153 / Avg. bwd-input time: 34.1014) / Avg. batch time: 850.3982 (ms) / GPU bubble ratio: 25.31%
[rank0]:2025-12-25 08:50:23,961 -  step: 800  loss:  0.2390  grad_norm:  0.1356  memory: 36.24GiB(76.29%)  tps: 9,700  tflops: 75.83  mfu: 24.31%
[rank0]:2025-12-25 08:50:23,962 - â„¹ï¸ final step: 800  loss:  0.2390  grad_norm:  0.1356  tps: 9,760  tflops: 76.30  mfu: 22.39%
[rank0]:2025-12-25 08:50:23,962 - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-12-25 08:50:23,963 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank1]:2025-12-25 08:50:23,906 - Avg. fwd time: 9.7819 / Avg. bwd-weight time: 8.1172 / Avg. bwd-input time: 12.6170 / Avg. batch time: 830.6465 (ms) / GPU bubble ratio: 41.22%
[rank1]:2025-12-25 08:50:23,954 -  step: 800  loss: -4.0000  grad_norm:  0.1356  memory: 17.87GiB(37.61%)  tps: 9,700  tflops: 75.83  mfu: 24.30%
[rank1]:2025-12-25 08:50:23,954 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  0.1356  tps: 9,751  tflops: 76.23  mfu: 22.28%
[rank1]:2025-12-25 08:50:23,954 - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-12-25 08:50:23,954 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-25 08:50:26,374 - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank2]:2025-12-25 08:50:26,449 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/frozen_ratio_history/rank2/251225_0850_stage2_final800.svg
[rank0]:2025-12-25 08:50:26,449 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/frozen_ratio_history/rank0/251225_0850_stage0_final800.svg
[rank0]:2025-12-25 08:50:26,496 - âœ… Frozen Ratio History of Rank 0 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/frozen_ratio_history/rank0/251225_0850_stage7_final800.svg
[rank1]:2025-12-25 08:50:26,448 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/frozen_ratio_history/rank1/251225_0850_stage1_final800.svg
[rank1]:2025-12-25 08:50:26,493 - âœ… Frozen Ratio History of Rank 1 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/frozen_ratio_history/rank1/251225_0850_stage6_final800.svg
[rank2]:2025-12-25 08:50:26,495 - âœ… Frozen Ratio History of Rank 2 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/frozen_ratio_history/rank2/251225_0850_stage5_final800.svg
[rank2]:2025-12-25 08:50:26,598 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/frozen_params_histogram/251225_0850_rank2_stage2.svg
[rank2]:	> Counts Sum: 169640, Total Sum: 414720 (40.90%), Ratio(%) per element: [41.31, 42.53, 39.4, 40.27, 41.31, 40.62, 39.4, 40.27, 41.14, 41.49, 40.79, 42.18, 40.27, 42.18, 40.1, 41.49, 39.58, 41.84]
[rank2]:2025-12-25 08:50:26,609 - Destroying the purge thread.
[rank2]:[rank2]: Traceback (most recent call last):
[rank2]:[rank2]:   File "<frozen runpy>", line 198, in _run_module_as_main
[rank2]:[rank2]:   File "<frozen runpy>", line 88, in _run_code
[rank2]:[rank2]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 789, in <module>
[rank2]:[rank2]:     trainer.train()
[rank2]:[rank2]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
[rank2]:[rank2]:     return f(*args, **kwargs)
[rank2]:[rank2]:            ^^^^^^^^^^^^^^^^^^
[rank2]:[rank2]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 621, in train
[rank2]:[rank2]:     draw_charts(self.freezer, self.step, job_config)
[rank2]:[rank2]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 712, in draw_charts
[rank2]:[rank2]:     draw_elementwise_histogram(data=list(freezer.paramwise_frozen_count[s].values()), stage=s,
[rank2]:[rank2]:   File "/home/shcho/torchtitan/timelyfreeze/core/util.py", line 335, in draw_elementwise_histogram
[rank2]:[rank2]:     ax1.text(max(min(80, past_ratio - 5), 5), 0, total_count_text, ha="center", va="center", fontsize=fontsize, color="black")
[rank2]:[rank2]:                      ^^
[rank2]:[rank2]: UnboundLocalError: cannot access local variable 'past_ratio' where it is not associated with a value
[rank0]:2025-12-25 08:50:26,604 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/frozen_params_histogram/251225_0850_rank0_stage0.svg
[rank0]:	> Counts Sum: 339080, Total Sum: 437760 (77.46%), Ratio(%) per element: [87.84, 86.8, 86.28, 86.28, 82.11, 82.11, 81.77, 85.24, 80.55, 80.2, 78.47, 77.6, 74.65, 75.0, 69.61, 69.61, 67.7, 62.32, 57.46]
[rank0]:2025-12-25 08:50:26,616 - Destroying the purge thread.
[rank1]:2025-12-25 08:50:26,616 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/frozen_params_histogram/251225_0850_rank1_stage1.svg
[rank1]:	> Counts Sum: 405800, Total Sum: 622080 (65.23%), Ratio(%) per element: [66.31, 67.01, 66.49, 67.36, 63.88, 65.1, 65.62, 67.7, 63.88, 63.54, 65.45, 62.15, 65.1, 64.06, 63.54, 64.4, 67.01, 64.23, 67.01, 65.27, 64.58, 65.45, 66.31, 65.27, 66.31, 63.54, 64.58]
[rank1]:2025-12-25 08:50:26,627 - Destroying the purge thread.
[rank1]:[rank1]: Traceback (most recent call last):
[rank1]:[rank1]:   File "<frozen runpy>", line 198, in _run_module_as_main
[rank1]:[rank1]:   File "<frozen runpy>", line 88, in _run_code
[rank1]:[rank1]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 789, in <module>
[rank1]:[rank1]:     trainer.train()
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
[rank1]:[rank1]:     return f(*args, **kwargs)
[rank1]:[rank1]:            ^^^^^^^^^^^^^^^^^^
[rank1]:[rank1]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 621, in train
[rank1]:[rank1]:     draw_charts(self.freezer, self.step, job_config)
[rank1]:[rank1]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 712, in draw_charts
[rank1]:[rank1]:     draw_elementwise_histogram(data=list(freezer.paramwise_frozen_count[s].values()), stage=s,
[rank1]:[rank1]:   File "/home/shcho/torchtitan/timelyfreeze/core/util.py", line 335, in draw_elementwise_histogram
[rank1]:[rank1]:     ax1.text(max(min(80, past_ratio - 5), 5), 0, total_count_text, ha="center", va="center", fontsize=fontsize, color="black")
[rank1]:[rank1]:                      ^^
[rank1]:[rank1]: UnboundLocalError: cannot access local variable 'past_ratio' where it is not associated with a value
[rank3]:2025-12-25 08:50:26,712 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1/pipeline_schedule/251225_0850_final800_rank3.svg
[rank3]:			> Batch Time: 811.52 ms, GPU Bubble Ratio: 27.06%, 40.57%, 47.36%, 50.71%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-8-34ms      | [S0,MB4,F]  34-7-42ms      | [S0,MB5,F]  42-9-51ms      | [S0,MB6,F]  51-8-60ms      | [S7,MB0,F]  113-17-130ms   | [S7,MB0,BI] 142-32-174ms   | [S7,MB0,BW] 174-26-201ms   | [S7,MB1,F]  201-16-218ms   | [S7,MB1,BI] 230-34-264ms   | [S7,MB1,BW] 264-0-264ms    | [S7,MB2,F]  265-18-283ms   | [S7,MB2,BI] 295-35-331ms   | [S7,MB2,BW] 331-0-331ms    | [S7,MB3,F]  331-19-350ms   | [S7,MB3,BI] 362-35-397ms   | [S7,MB3,BW] 397-0-397ms    | [S0,MB7,F]  397-10-408ms   | [S0,MB0,B]  408-0-408ms    | [S7,MB4,F]  416-18-434ms   | [S7,MB4,BI] 446-34-480ms   | [S7,MB4,BW] 480-0-480ms    | [S0,MB1,B]  487-0-487ms    | [S7,MB5,F]  491-17-509ms   | [S7,MB5,BI] 521-33-554ms   | [S7,MB5,BW] 554-0-554ms    | [S0,MB2,B]  561-0-561ms    | [S7,MB6,F]  575-15-591ms   | [S7,MB6,BI] 603-33-636ms   | [S7,MB6,BW] 636-0-636ms    | [S0,MB3,B]  643-0-643ms    | [S7,MB7,F]  657-15-672ms   | [S7,MB7,BI] 684-33-717ms   | [S7,MB7,BW] 717-26-743ms   | [S0,MB4,B]  741-10-751ms   | [S0,MB5,B]  754-20-774ms   | [S0,MB6,B]  780-20-800ms   | [S0,MB7,B]  805-6-811ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-21ms      | [S1,MB1,F]  27-10-38ms     | [S1,MB2,F]  44-10-55ms     | [S1,MB3,F]  62-10-73ms     | [S1,MB4,F]  85-10-96ms     | [S6,MB0,F]  96-10-106ms    | [S1,MB5,F]  106-13-119ms   | [S6,MB1,F]  119-8-128ms    | [S6,MB0,BI] 174-9-184ms    | [S6,MB0,BW] 184-10-194ms   | [S6,MB2,F]  194-7-201ms    | [S6,MB1,BI] 264-9-273ms    | [S6,MB1,BW] 273-10-284ms   | [S6,MB3,F]  284-7-291ms    | [S6,MB2,BI] 331-9-340ms    | [S6,MB2,BW] 340-10-351ms   | [S1,MB6,F]  351-10-362ms   | [S1,MB0,BI] 362-15-378ms   | [S1,MB0,BW] 378-0-378ms    | [S6,MB4,F]  378-7-386ms    | [S6,MB3,BI] 397-11-409ms   | [S6,MB3,BW] 409-11-421ms   | [S1,MB7,F]  421-11-432ms   | [S1,MB1,BI] 432-16-448ms   | [S1,MB1,BW] 448-8-457ms    | [S6,MB5,F]  456-8-465ms    | [S6,MB4,BI] 480-12-492ms   | [S6,MB4,BW] 493-10-504ms   | [S1,MB2,BI] 504-14-518ms   | [S1,MB2,BW] 518-13-531ms   | [S6,MB6,F]  560-7-568ms    | [S6,MB5,BI] 568-10-578ms   | [S6,MB5,BW] 578-10-588ms   | [S1,MB3,BI] 589-14-604ms   | [S1,MB3,BW] 603-12-616ms   | [S6,MB7,F]  642-7-650ms    | [S6,MB6,BI] 650-10-660ms   | [S6,MB6,BW] 660-10-671ms   | [S1,MB4,BI] 671-14-686ms   | [S6,MB7,BI] 717-10-728ms   | [S1,MB5,BI] 728-15-743ms   | [S1,MB4,BW] 743-6-749ms    | [S1,MB6,BI] 757-14-772ms   | [S1,MB5,BW] 772-3-776ms    | [S1,MB7,BI] 782-14-797ms   | [S1,MB6,BW] 797-0-797ms    | [S6,MB7,BW] 797-3-801ms    | [S1,MB7,BW] 800-0-800ms   
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-8-29ms      | [S2,MB1,F]  38-7-45ms      | [S2,MB2,F]  55-7-63ms      | [S5,MB0,F]  63-9-72ms      | [S2,MB3,F]  73-9-82ms      | [S5,MB1,F]  82-7-90ms      | [S2,MB4,F]  96-10-106ms    | [S5,MB2,F]  115-8-123ms    | [S5,MB0,BI] 184-9-193ms    | [S5,MB0,BW] 193-10-204ms   | [S5,MB3,F]  203-7-211ms    | [S5,MB1,BI] 274-9-283ms    | [S5,MB1,BW] 283-11-294ms   | [S2,MB5,F]  294-7-301ms    | [S2,MB0,BI] 302-10-312ms   | [S2,MB0,BW] 312-9-322ms    | [S5,MB4,F]  322-7-330ms    | [S5,MB2,BI] 340-10-351ms   | [S5,MB2,BW] 351-10-361ms   | [S2,MB6,F]  363-10-373ms   | [S2,MB1,BI] 374-11-385ms   | [S2,MB1,BW] 386-10-396ms   | [S5,MB5,F]  396-7-403ms    | [S5,MB3,BI] 413-10-424ms   | [S5,MB3,BW] 424-10-435ms   | [S2,MB7,F]  435-9-445ms    | [S2,MB2,BI] 446-11-457ms   | [S2,MB2,BW] 457-10-467ms   | [S5,MB6,F]  467-7-475ms    | [S5,MB4,BI] 493-10-504ms   | [S5,MB4,BW] 504-9-514ms    | [S2,MB3,BI] 564-9-573ms    | [S2,MB3,BW] 573-10-584ms   | [S5,MB7,F]  588-7-595ms    | [S5,MB5,BI] 595-9-605ms    | [S5,MB5,BW] 605-9-614ms    | [S2,MB4,BI] 645-9-655ms    | [S5,MB6,BI] 661-10-671ms   | [S2,MB5,BI] 671-10-681ms   | [S5,MB7,BI] 730-9-739ms    | [S2,MB6,BI] 739-11-750ms   | [S2,MB4,BW] 751-8-759ms    | [S2,MB7,BI] 766-9-776ms    | [S2,MB5,BW] 776-0-776ms    | [S5,MB6,BW] 776-10-786ms   | [S5,MB7,BW] 786-8-794ms    | [S2,MB6,BW] 794-0-794ms    | [S2,MB7,BW] 794-0-794ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-8-37ms      | [S4,MB0,F]  37-8-45ms      | [S3,MB1,F]  46-8-54ms      | [S4,MB1,F]  54-7-62ms      | [S3,MB2,F]  63-7-71ms      | [S4,MB2,F]  71-7-79ms      | [S3,MB3,F]  98-7-105ms     | [S4,MB3,F]  105-8-113ms    | [S4,MB0,BI] 193-9-203ms    | [S4,MB0,BW] 203-9-212ms    | [S3,MB4,F]  212-7-219ms    | [S3,MB0,BI] 219-9-228ms    | [S3,MB0,BW] 228-9-238ms    | [S4,MB4,F]  238-8-246ms    | [S4,MB1,BI] 283-10-294ms   | [S4,MB1,BW] 293-10-304ms   | [S3,MB5,F]  304-8-312ms    | [S3,MB1,BI] 312-9-321ms    | [S3,MB1,BW] 321-9-331ms    | [S4,MB5,F]  331-7-339ms    | [S4,MB2,BI] 367-11-379ms   | [S4,MB2,BW] 379-9-389ms    | [S3,MB6,F]  389-7-396ms    | [S3,MB2,BI] 396-9-406ms    | [S3,MB2,BW] 406-9-416ms    | [S4,MB6,F]  416-8-424ms    | [S4,MB3,BI] 439-12-451ms   | [S4,MB3,BW] 451-9-461ms    | [S3,MB7,F]  461-7-469ms    | [S3,MB3,BI] 469-9-479ms    | [S3,MB3,BW] 478-10-489ms   | [S4,MB7,F]  489-8-498ms    | [S4,MB4,BI] 557-10-567ms   | [S4,MB4,BW] 567-9-577ms    | [S3,MB4,BI] 577-10-588ms   | [S4,MB5,BI] 639-10-649ms   | [S3,MB5,BI] 649-9-658ms    | [S4,MB6,BI] 671-9-681ms    | [S3,MB6,BI] 681-9-690ms    | [S4,MB7,BI] 741-9-750ms    | [S3,MB7,BI] 750-9-759ms    | [S3,MB4,BW] 760-0-760ms    | [S4,MB5,BW] 760-10-770ms   | [S4,MB6,BW] 770-6-776ms    | [S4,MB7,BW] 776-0-776ms    | [S3,MB5,BW] 776-0-776ms    | [S3,MB6,BW] 776-0-776ms    | [S3,MB7,BW] 776-9-786ms   
[rank3]:2025-12-25 08:50:26,714 - Destroying the purge thread.
[rank3]:[rank3]: Traceback (most recent call last):
[rank3]:[rank3]:   File "<frozen runpy>", line 198, in _run_module_as_main
[rank3]:[rank3]:   File "<frozen runpy>", line 88, in _run_code
[rank3]:[rank3]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 789, in <module>
[rank3]:[rank3]:     trainer.train()
[rank3]:[rank3]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
[rank3]:[rank3]:     return f(*args, **kwargs)
[rank3]:[rank3]:            ^^^^^^^^^^^^^^^^^^
[rank3]:[rank3]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 621, in train
[rank3]:[rank3]:     draw_charts(self.freezer, self.step, job_config)
[rank3]:[rank3]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 688, in draw_charts
[rank3]:[rank3]:     pipeline_schedule = schedule_pipeline(pipeline_schedule, 
[rank3]:[rank3]:                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:[rank3]:   File "/home/shcho/torchtitan/timelyfreeze/core/schedule.py", line 414, in schedule_pipeline
[rank3]:[rank3]:     assert fwd_time is None or len(fwd_time) == num_stages, f"fwd_time should have the same length as num_stages. fwd_time: {len(fwd_time)}, num_stages: {num_stages}"
[rank3]:[rank3]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:[rank3]: AssertionError: fwd_time should have the same length as num_stages. fwd_time: 4, num_stages: 8
[rank0]:wandb: updating run metadata
[rank0]:wandb: uploading history steps 15-16, summary, console lines 102-112
[rank0]:wandb: 
[rank0]:wandb: Run history:
[rank0]:wandb:      final/avg_end_to_end(s) â–
[rank0]:wandb:               final/avg_loss â–
[rank0]:wandb:             final/avg_mfu(%) â–
[rank0]:wandb:             final/avg_tflops â–
[rank0]:wandb:    final/avg_throughput(tps) â–
[rank0]:wandb:              final/grad_norm â–
[rank0]:wandb:               final/max_loss â–
[rank0]:wandb:                    grad_norm â–ˆâ–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank0]:wandb: loss_metrics/global_avg_loss â–ˆâ–ˆâ–‡â–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank0]:wandb: loss_metrics/global_max_loss â–ˆâ–ˆâ–‡â–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank0]:wandb:                          +14 ...
[rank0]:wandb: 
[rank0]:wandb: Run summary:
[rank0]:wandb:      final/avg_end_to_end(s) 3.35749
[rank0]:wandb:               final/avg_loss 0.23899
[rank0]:wandb:             final/avg_mfu(%) 22.38967
[rank0]:wandb:             final/avg_tflops 76.29673
[rank0]:wandb:    final/avg_throughput(tps) 9759.68581
[rank0]:wandb:              final/grad_norm 0.13562
[rank0]:wandb:               final/max_loss 0.23899
[rank0]:wandb:                    grad_norm 0.13562
[rank0]:wandb: loss_metrics/global_avg_loss 0.23899
[rank0]:wandb: loss_metrics/global_max_loss 0.23899
[rank0]:wandb:                          +14 ...
[rank0]:wandb: 
[rank0]:wandb: ðŸš€ View run 1224_ZBVZeroBubble_fullrand7_42_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/qy3hmrnh
[rank0]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank0]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank0]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1224_ZBVZeroBubble_fullrand7_42_dm1/20251225-0802/wandb/run-20251225_080248-qy3hmrnh/logs
[rank0]:Traceback (most recent call last):
[rank0]:  File "<frozen runpy>", line 198, in _run_module_as_main
[rank0]:  File "<frozen runpy>", line 88, in _run_code
[rank0]:  File "/home/shcho/torchtitan/timelyfreeze/train.py", line 789, in <module>
[rank0]:    trainer.train()
[rank0]:  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
[rank0]:    return f(*args, **kwargs)
[rank0]:           ^^^^^^^^^^^^^^^^^^
[rank0]:  File "/home/shcho/torchtitan/timelyfreeze/train.py", line 621, in train
[rank0]:    draw_charts(self.freezer, self.step, job_config)
[rank0]:  File "/home/shcho/torchtitan/timelyfreeze/train.py", line 712, in draw_charts
[rank0]:    draw_elementwise_histogram(data=list(freezer.paramwise_frozen_count[s].values()), stage=s,
[rank0]:  File "/home/shcho/torchtitan/timelyfreeze/core/util.py", line 335, in draw_elementwise_histogram
[rank0]:    ax1.text(max(min(80, past_ratio - 5), 5), 0, total_count_text, ha="center", va="center", fontsize=fontsize, color="black")
[rank0]:                     ^^
[rank0]:UnboundLocalError: cannot access local variable 'past_ratio' where it is not associated with a value
[rank0]:[rank0]: Traceback (most recent call last):
[rank0]:[rank0]:   File "<frozen runpy>", line 198, in _run_module_as_main
[rank0]:[rank0]:   File "<frozen runpy>", line 88, in _run_code
[rank0]:[rank0]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 789, in <module>
[rank0]:[rank0]:     trainer.train()
[rank0]:[rank0]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
[rank0]:[rank0]:     return f(*args, **kwargs)
[rank0]:[rank0]:            ^^^^^^^^^^^^^^^^^^
[rank0]:[rank0]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 621, in train
[rank0]:[rank0]:     draw_charts(self.freezer, self.step, job_config)
[rank0]:[rank0]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 712, in draw_charts
[rank0]:[rank0]:     draw_elementwise_histogram(data=list(freezer.paramwise_frozen_count[s].values()), stage=s,
[rank0]:[rank0]:   File "/home/shcho/torchtitan/timelyfreeze/core/util.py", line 335, in draw_elementwise_histogram
[rank0]:[rank0]:     ax1.text(max(min(80, past_ratio - 5), 5), 0, total_count_text, ha="center", va="center", fontsize=fontsize, color="black")
[rank0]:[rank0]:                      ^^
[rank0]:[rank0]: UnboundLocalError: cannot access local variable 'past_ratio' where it is not associated with a value
[rank0]:[rank0]:[W1225 08:50:28.946146601 ProcessGroupNCCL.cpp:1552] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
W1225 08:50:28.625000 843677 site-packages/torch/distributed/elastic/multiprocessing/api.py:940] Sending process 843698 closing signal SIGTERM
W1225 08:50:28.629000 843677 site-packages/torch/distributed/elastic/multiprocessing/api.py:940] Sending process 843699 closing signal SIGTERM
W1225 08:50:28.630000 843677 site-packages/torch/distributed/elastic/multiprocessing/api.py:940] Sending process 843701 closing signal SIGTERM
E1225 08:50:29.484000 843677 site-packages/torch/distributed/elastic/multiprocessing/api.py:914] failed (exitcode: 1) local_rank: 2 (pid: 843700) of binary: /data2/shcho/miniforge3/envs/llm_eval/bin/python3.11
E1225 08:50:29.508000 843677 site-packages/torch/distributed/elastic/multiprocessing/errors/error_handler.py:141] no error file defined for parent, to copy child error file (/tmp/torchelastic_1qq69k2a/3fc63c64-3255-4771-8a0c-b1ae461a51f1_kxnbza_6/attempt_0/2/error.json)
[rank3]:Stage 3: Modules to keep: {'layers.7', 'layers.8'}
[rank3]:Stage 4: Modules to keep: {'layers.10', 'layers.9'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1224.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1224_ZBVZeroBubble_fullrand7_42_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1224_ZBVZeroBubble_fullrand7_42_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1224_ZBVZeroBubble_fullrand7_42_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1224_ZBVZeroBubble_fullrand7_42_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_fullrand7_42_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1224_ZBVZeroBubble_fullrand7_42_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 42
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: ZBVZeroBubble
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 4
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 2
[rank3]:		- stages_list: [3, 4]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1224_ZBVZeroBubble_fullrand7_42_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1224_ZBVZeroBubble_fullrand7_42_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: fullrand7
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.01
[rank3]:		- percentile: 80
[rank3]:
[rank2]:Stage 2: Modules to keep: {'layers.6', 'layers.5'}
[rank2]:Stage 5: Modules to keep: {'layers.12', 'layers.11'}
[rank1]:Stage 1: Modules to keep: {'layers.4', 'layers.2', 'layers.3'}
[rank1]:Stage 6: Modules to keep: {'layers.13', 'layers.14'}
[rank0]:Stage 0: Modules to keep: {'layers.1', 'layers.0', 'tok_embeddings'}
[rank0]:Stage 7: Modules to keep: {'output', 'layers.15', 'norm'}
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
Traceback (most recent call last):
  File "/data2/shcho/miniforge3/envs/llm_eval/bin/torchrun", line 7, in <module>
    sys.exit(main())
             ^^^^^^
  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/run.py", line 946, in main
    run(args)
  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/run.py", line 937, in run
    elastic_launch(
  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 159, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 300, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
timelyfreeze.train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2025-12-25_08:50:26
  host      : elga.kaist.ac.kr
  rank      : 0 (local_rank: 0)
  exitcode  : -15 (pid: 843698)
  error_file: /tmp/torchelastic_1qq69k2a/3fc63c64-3255-4771-8a0c-b1ae461a51f1_kxnbza_6/attempt_0/0/error.json
  traceback : Traceback (most recent call last):
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
      return f(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^
    File "/home/shcho/torchtitan/timelyfreeze/train.py", line 621, in train
      draw_charts(self.freezer, self.step, job_config)
    File "/home/shcho/torchtitan/timelyfreeze/train.py", line 712, in draw_charts
      draw_elementwise_histogram(data=list(freezer.paramwise_frozen_count[s].values()), stage=s,
    File "/home/shcho/torchtitan/timelyfreeze/core/util.py", line 335, in draw_elementwise_histogram
      ax1.text(max(min(80, past_ratio - 5), 5), 0, total_count_text, ha="center", va="center", fontsize=fontsize, color="black")
                       ^^
  UnboundLocalError: cannot access local variable 'past_ratio' where it is not associated with a value
  
[2]:
  time      : 2025-12-25_08:50:26
  host      : elga.kaist.ac.kr
  rank      : 1 (local_rank: 1)
  exitcode  : 1 (pid: 843699)
  error_file: /tmp/torchelastic_1qq69k2a/3fc63c64-3255-4771-8a0c-b1ae461a51f1_kxnbza_6/attempt_0/1/error.json
  traceback : Traceback (most recent call last):
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
      return f(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^
    File "/home/shcho/torchtitan/timelyfreeze/train.py", line 621, in train
      draw_charts(self.freezer, self.step, job_config)
    File "/home/shcho/torchtitan/timelyfreeze/train.py", line 712, in draw_charts
      draw_elementwise_histogram(data=list(freezer.paramwise_frozen_count[s].values()), stage=s,
    File "/home/shcho/torchtitan/timelyfreeze/core/util.py", line 335, in draw_elementwise_histogram
      ax1.text(max(min(80, past_ratio - 5), 5), 0, total_count_text, ha="center", va="center", fontsize=fontsize, color="black")
                       ^^
  UnboundLocalError: cannot access local variable 'past_ratio' where it is not associated with a value
  
[3]:
  time      : 2025-12-25_08:50:26
  host      : elga.kaist.ac.kr
  rank      : 3 (local_rank: 3)
  exitcode  : 1 (pid: 843701)
  error_file: /tmp/torchelastic_1qq69k2a/3fc63c64-3255-4771-8a0c-b1ae461a51f1_kxnbza_6/attempt_0/3/error.json
  traceback : Traceback (most recent call last):
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
      return f(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^
    File "/home/shcho/torchtitan/timelyfreeze/train.py", line 621, in train
      draw_charts(self.freezer, self.step, job_config)
    File "/home/shcho/torchtitan/timelyfreeze/train.py", line 688, in draw_charts
      pipeline_schedule = schedule_pipeline(pipeline_schedule,
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    File "/home/shcho/torchtitan/timelyfreeze/core/schedule.py", line 414, in schedule_pipeline
      assert fwd_time is None or len(fwd_time) == num_stages, f"fwd_time should have the same length as num_stages. fwd_time: {len(fwd_time)}, num_stages: {num_stages}"
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  AssertionError: fwd_time should have the same length as num_stages. fwd_time: 4, num_stages: 8
  
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2025-12-25_08:50:26
  host      : elga.kaist.ac.kr
  rank      : 2 (local_rank: 2)
  exitcode  : 1 (pid: 843700)
  error_file: /tmp/torchelastic_1qq69k2a/3fc63c64-3255-4771-8a0c-b1ae461a51f1_kxnbza_6/attempt_0/2/error.json
  traceback : Traceback (most recent call last):
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
      return f(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^
    File "/home/shcho/torchtitan/timelyfreeze/train.py", line 621, in train
      draw_charts(self.freezer, self.step, job_config)
    File "/home/shcho/torchtitan/timelyfreeze/train.py", line 712, in draw_charts
      draw_elementwise_histogram(data=list(freezer.paramwise_frozen_count[s].values()), stage=s,
    File "/home/shcho/torchtitan/timelyfreeze/core/util.py", line 335, in draw_elementwise_histogram
      ax1.text(max(min(80, past_ratio - 5), 5), 0, total_count_text, ha="center", va="center", fontsize=fontsize, color="black")
                       ^^
  UnboundLocalError: cannot access local variable 'past_ratio' where it is not associated with a value
  
============================================================
