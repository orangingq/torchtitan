
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 12. 25. (ëª©) 11:29:34 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 1,2,3,4
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/1224_ZBVZeroBubble_apf_42.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug

âœ”ï¸Running with apf x ZBVZeroBubble ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1224.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=apf --freezing.threshold=0.01 --freezing.percentile=80 --freezing.max_freeze_ratio=0.8
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank2]:2025-12-25 11:29:40,552 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank2]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank2]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank2]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank2]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank2]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank2]:"
[rank3]:2025-12-25 11:29:40,552 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:"
[rank0]:2025-12-25 11:29:40,732 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank0]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank0]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank0]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank0]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank0]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank0]:"
[rank1]:2025-12-25 11:29:40,786 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank1]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank1]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank1]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank1]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank1]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank1]:"
[rank2]:2025-12-25 11:29:40,753 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-12-25 11:29:40,755 - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-12-25 11:29:40,767 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-12-25 11:29:40,769 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-25 11:29:40,943 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-12-25 11:29:40,946 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-25 11:29:40,949 - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-12-25 11:29:40,951 - Loading tokenizer from tokenizer.json
[rank1]:2025-12-25 11:29:41,005 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-12-25 11:29:41,008 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-25 11:29:41,346 - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank2]:2025-12-25 11:29:44,103 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-12-25 11:29:44,140 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-25 11:29:44,167 - PP rank 2 is building stage_idx 2 with modules ['layers.5', 'layers.6']
[rank2]:2025-12-25 11:29:44,179 - PP rank 2 is building stage_idx 5 with modules ['layers.11', 'layers.12']
[rank2]:2025-12-25 11:29:44,181 - Using pipeline schedule ZBVZeroBubble with 8 microbatches and 8 stages.
[rank0]:2025-12-25 11:29:44,211 - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank3]:2025-12-25 11:29:44,274 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-12-25 11:29:44,366 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-25 11:29:44,366 - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-12-25 11:29:44,366 - CUDA memory usage for model: 0.92GiB(1.94%)
[rank3]:2025-12-25 11:29:44,311 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-25 11:29:44,335 - PP rank 3 is building stage_idx 3 with modules ['layers.7', 'layers.8']
[rank3]:2025-12-25 11:29:44,357 - PP rank 3 is building stage_idx 4 with modules ['layers.9', 'layers.10']
[rank3]:2025-12-25 11:29:44,360 - Using pipeline schedule ZBVZeroBubble with 8 microbatches and 8 stages.
[rank1]:2025-12-25 11:29:44,405 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-12-25 11:29:44,443 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-25 11:29:44,471 - PP rank 1 is building stage_idx 1 with modules ['layers.2', 'layers.3', 'layers.4']
[rank1]:2025-12-25 11:29:44,484 - PP rank 1 is building stage_idx 6 with modules ['layers.13', 'layers.14']
[rank1]:2025-12-25 11:29:44,486 - Using pipeline schedule ZBVZeroBubble with 8 microbatches and 8 stages.
[rank3]:2025-12-25 11:29:44,562 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-25 11:29:44,563 - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-12-25 11:29:44,563 - CUDA memory usage for model: 0.92GiB(1.94%)
[rank1]:2025-12-25 11:29:44,698 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-25 11:29:44,699 - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-12-25 11:29:44,700 - CUDA memory usage for model: 1.13GiB(2.39%)
[rank0]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank0]:wandb: setting up run zymaehu9
[rank0]:wandb: Tracking run with wandb version 0.22.2
[rank0]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1224_ZBVZeroBubble_apf_42_dm1/20251225-1129/wandb/run-20251225_112945-zymaehu9
[rank0]:wandb: Run `wandb offline` to turn off syncing.
[rank0]:wandb: Syncing run 1224_ZBVZeroBubble_apf_42_dm1
[rank0]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank0]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/zymaehu9
[rank0]:2025-12-25 11:29:46,728 - WandB logging enabled
[rank0]:2025-12-25 11:29:46,729 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-12-25 11:29:46,769 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-25 11:29:46,771 - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-12-25 11:29:46,796 - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1']
[rank0]:2025-12-25 11:29:46,809 - PP rank 0 is building stage_idx 7 with modules ['layers.15', 'norm', 'output']
[rank0]:2025-12-25 11:29:46,811 - Using pipeline schedule ZBVZeroBubble with 8 microbatches and 8 stages.
[rank2]:2025-12-25 11:29:47,047 - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-12-25 11:29:47,047 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-25 11:29:47,025 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-25 11:29:47,026 - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-12-25 11:29:47,026 - CUDA memory usage for model: 2.64GiB(5.55%)
[rank0]:2025-12-25 11:29:47,046 - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1224_ZBVZeroBubble_apf_42_dm1
[rank1]:2025-12-25 11:29:47,045 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-25 11:29:47,046 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-25 11:29:47,047 - Trainer is initialized with local batch size 32, global batch size 128, gradient accumulation steps 4, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2025-12-25 11:29:47,047 - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank0]:2025-12-25 11:29:50,412 - [GC] GC collection for checkpoint loading. 0.04 seconds
[rank0]:2025-12-25 11:29:50,413 - Finished loading the checkpoint in 3.37 seconds.
[rank0]:2025-12-25 11:29:50,413 - Training starts at step 1
[rank3]:2025-12-25 11:29:55,593 -  step:  1  loss: -4.0000  grad_norm: 203.0663  memory: 13.45GiB(28.31%)  tps: 2,905  tflops: 22.71  mfu: 7.28%
[rank3]:2025-12-25 11:29:55,593 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-12-25 11:29:55,602 -  step:  1  loss: -4.0000  grad_norm: 203.0663  memory: 15.58GiB(32.80%)  tps: 2,937  tflops: 22.96  mfu: 7.36%
[rank1]:2025-12-25 11:29:55,602 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-12-25 11:29:55,592 -  step:  1  loss: -4.0000  grad_norm: 203.0663  memory: 11.98GiB(25.23%)  tps: 2,861  tflops: 22.37  mfu: 7.17%
[rank2]:2025-12-25 11:29:55,593 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-25 11:29:55,641 -  step:  1  loss: 10.6092  grad_norm: 203.0663  memory: 30.01GiB(63.17%)  tps: 3,694  tflops: 28.88  mfu: 9.26%
[rank0]:2025-12-25 11:29:55,642 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-25 11:33:37,014 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-25 11:33:41,805 - Avg. fwd time: 7.8003 / Avg. bwd-weight time: 9.8300 / Avg. bwd-input time: 9.6368 / Avg. batch time: 1052.0975 (ms) / GPU bubble ratio: 58.53%
[rank2]:2025-12-25 11:33:41,800 - Avg. fwd time: 8.1515 / Avg. bwd-weight time: 10.0008 / Avg. bwd-input time: 10.0185 / Avg. batch time: 1055.5083 (ms) / GPU bubble ratio: 57.30%
[rank1]:2025-12-25 11:33:41,816 - Avg. fwd time: 9.8588 / Avg. bwd-weight time: 12.9033 / Avg. bwd-input time: 12.1749 / Avg. batch time: 1090.6636 (ms) / GPU bubble ratio: 48.75%
[rank3]:2025-12-25 11:33:41,867 -  step: 50  loss: -4.0000  grad_norm: 24.1605  memory: 15.27GiB(32.13%)  tps: 7,096  tflops: 55.47  mfu: 17.78%
[rank0]:2025-12-25 11:33:41,822 - Avg. fwd time: 13.6480 / Avg. full-bwd time: 28.9644 (Avg. bwd-weight time: 30.0110 / Avg. bwd-input time: 34.4896) / Avg. batch time: 1113.2225 (ms) / GPU bubble ratio: 13.22%
[rank0]:2025-12-25 11:33:41,894 -  step: 50  loss:  9.8858  grad_norm: 24.1605  memory: 35.32GiB(74.36%)  tps: 7,097  tflops: 55.48  mfu: 17.78%
[rank2]:2025-12-25 11:33:41,867 -  step: 50  loss: -4.0000  grad_norm: 24.1605  memory: 13.80GiB(29.05%)  tps: 7,096  tflops: 55.47  mfu: 17.78%
[rank1]:2025-12-25 11:33:41,871 -  step: 50  loss: -4.0000  grad_norm: 24.1605  memory: 17.83GiB(37.53%)  tps: 7,096  tflops: 55.47  mfu: 17.78%
[rank0]:2025-12-25 11:34:23,454 - Freezing Ratio: [Stage0] 0.00, [Stage7] 0.00, Threshold: 1.0000e-02
[rank3]:2025-12-25 11:34:23,646 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 1.0000e-02
[rank1]:2025-12-25 11:34:23,659 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 1.0000e-02
[rank2]:2025-12-25 11:34:23,639 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 1.0000e-02
[rank3]:2025-12-25 11:35:10,105 - Freezing Ratio: [Stage3] 0.78, [Stage4] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-25 11:35:10,112 - Freezing Ratio: [Stage1] 0.81, [Stage6] 0.78, Threshold: 1.0000e-02
[rank2]:2025-12-25 11:35:10,105 - Freezing Ratio: [Stage2] 0.83, [Stage5] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-25 11:35:10,157 - Freezing Ratio: [Stage0] 0.84, [Stage7] 0.64, Threshold: 1.0000e-02
[rank3]:2025-12-25 11:35:43,561 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 1.0000e-02
[rank2]:2025-12-25 11:35:43,574 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 1.0000e-02
[rank0]:2025-12-25 11:35:43,621 - Freezing Ratio: [Stage0] 0.00, [Stage7] 0.00, Threshold: 1.0000e-02
[rank1]:2025-12-25 11:35:43,591 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 1.0000e-02
[rank2]:2025-12-25 11:36:30,037 - Freezing Ratio: [Stage2] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-25 11:36:30,038 - Freezing Ratio: [Stage3] 0.83, [Stage4] 0.83, Threshold: 1.0000e-02
[rank1]:2025-12-25 11:36:30,044 - Freezing Ratio: [Stage1] 0.81, [Stage6] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-25 11:36:30,092 - Freezing Ratio: [Stage0] 0.79, [Stage7] 0.64, Threshold: 1.0000e-02
[rank0]:2025-12-25 11:37:02,952 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-25 11:37:03,289 - Freezing Ratio: [Stage3] 0.78, [Stage4] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-25 11:37:03,318 - Freezing Ratio: [Stage1] 0.81, [Stage6] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-25 11:37:03,348 - Freezing Ratio: [Stage0] 0.79, [Stage7] 0.64, Threshold: 1.0000e-02
[rank2]:2025-12-25 11:37:03,302 - Freezing Ratio: [Stage2] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-25 11:37:06,596 - Avg. fwd time: 7.9397 / Avg. bwd-weight time: 7.7899 / Avg. bwd-input time: 9.6587 / Avg. batch time: 986.2266 (ms) / GPU bubble ratio: 58.81%
[rank1]:2025-12-25 11:37:06,625 - Avg. fwd time: 10.0974 / Avg. bwd-weight time: 10.2213 / Avg. bwd-input time: 12.2236 / Avg. batch time: 1028.5758 (ms) / GPU bubble ratio: 49.38%
[rank1]:2025-12-25 11:37:06,659 -  step: 100  loss: -4.0000  grad_norm:  0.0000  memory: 18.98GiB(39.95%)  tps: 8,000  tflops: 62.54  mfu: 20.05%
[rank0]:2025-12-25 11:37:06,637 - Avg. fwd time: 13.6612 / Avg. full-bwd time: 25.3749 (Avg. bwd-weight time: 23.8150 / Avg. bwd-input time: 34.5151) / Avg. batch time: 1051.8323 (ms) / GPU bubble ratio: 15.56%
[rank0]:2025-12-25 11:37:06,660 -  step: 100  loss:  9.0257  grad_norm:  0.1159  memory: 40.23GiB(84.68%)  tps: 8,001  tflops: 62.55  mfu: 20.05%
[rank2]:2025-12-25 11:37:06,608 - Avg. fwd time: 8.3619 / Avg. bwd-weight time: 7.9209 / Avg. bwd-input time: 10.0381 / Avg. batch time: 993.8200 (ms) / GPU bubble ratio: 57.62%
[rank2]:2025-12-25 11:37:06,659 -  step: 100  loss: -4.0000  grad_norm:  0.0000  memory: 14.70GiB(30.94%)  tps: 8,000  tflops: 62.54  mfu: 20.05%
[rank3]:2025-12-25 11:37:06,659 -  step: 100  loss: -4.0000  grad_norm:  0.0000  memory: 16.16GiB(34.02%)  tps: 8,000  tflops: 62.54  mfu: 20.05%
[rank1]:2025-12-25 11:37:06,738 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_apf_42_dm1/frozen_ratio_history/rank1/251225_1137_stage1_step100.svg
[rank1]:2025-12-25 11:37:06,781 - âœ… Frozen Ratio History of Rank 1 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_apf_42_dm1/frozen_ratio_history/rank1/251225_1137_stage6_step100.svg
[rank0]:2025-12-25 11:37:06,731 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_apf_42_dm1/frozen_ratio_history/rank0/251225_1137_stage0_step100.svg
[rank0]:2025-12-25 11:37:06,773 - âœ… Frozen Ratio History of Rank 0 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_apf_42_dm1/frozen_ratio_history/rank0/251225_1137_stage7_step100.svg
[rank2]:2025-12-25 11:37:06,730 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_apf_42_dm1/frozen_ratio_history/rank2/251225_1137_stage2_step100.svg
[rank2]:2025-12-25 11:37:06,774 - âœ… Frozen Ratio History of Rank 2 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_apf_42_dm1/frozen_ratio_history/rank2/251225_1137_stage5_step100.svg
[rank3]:2025-12-25 11:37:06,986 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_apf_42_dm1/pipeline_schedule/251225_1137_step100_rank3.svg
[rank3]:			> Batch Time: 808.06 ms, GPU Bubble Ratio: 28.25%, 53.89%, 61.98%, 64.13%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-9-18ms       | [S0,MB2,F]  18-8-26ms      | [S0,MB3,F]  26-9-35ms      | [S0,MB4,F]  35-8-44ms      | [S0,MB5,F]  44-10-54ms     | [S0,MB6,F]  54-9-63ms      | [S7,MB0,F]  117-16-134ms   | [S7,MB0,BI] 146-32-179ms   | [S7,MB0,BW] 179-0-179ms    | [S7,MB1,F]  179-16-195ms   | [S7,MB1,BI] 208-33-242ms   | [S7,MB1,BW] 242-0-242ms    | [S7,MB2,F]  242-18-260ms   | [S7,MB2,BI] 272-35-307ms   | [S7,MB2,BW] 307-0-307ms    | [S7,MB3,F]  307-18-325ms   | [S7,MB3,BI] 339-35-374ms   | [S7,MB3,BW] 374-0-374ms    | [S0,MB7,F]  374-10-385ms   | [S0,MB0,B]  385-14-399ms   | [S7,MB4,F]  399-19-418ms   | [S7,MB4,BI] 431-35-466ms   | [S7,MB4,BW] 466-0-466ms    | [S0,MB1,B]  473-12-485ms   | [S7,MB5,F]  485-17-502ms   | [S7,MB5,BI] 514-34-548ms   | [S7,MB5,BW] 549-0-549ms    | [S0,MB2,B]  555-12-567ms   | [S7,MB6,F]  570-16-586ms   | [S7,MB6,BI] 599-33-632ms   | [S7,MB6,BW] 633-0-633ms    | [S0,MB3,B]  639-11-650ms   | [S7,MB7,F]  654-15-670ms   | [S7,MB7,BI] 682-33-715ms   | [S7,MB7,BW] 715-0-715ms    | [S0,MB4,B]  722-11-733ms   | [S0,MB5,B]  748-10-758ms   | [S0,MB6,B]  774-9-783ms    | [S0,MB7,B]  798-9-808ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  27-12-39ms     | [S1,MB2,F]  45-12-58ms     | [S1,MB3,F]  64-12-76ms     | [S1,MB4,F]  88-12-100ms    | [S6,MB0,F]  100-10-110ms   | [S1,MB5,F]  110-14-125ms   | [S6,MB1,F]  125-9-134ms    | [S6,MB0,BI] 179-9-188ms    | [S6,MB0,BW] 188-0-188ms    | [S6,MB2,F]  188-9-198ms    | [S6,MB1,BI] 242-9-251ms    | [S6,MB1,BW] 251-0-251ms    | [S6,MB3,F]  251-9-260ms    | [S6,MB2,BI] 307-9-316ms    | [S6,MB2,BW] 316-0-316ms    | [S1,MB6,F]  316-13-330ms   | [S1,MB0,BI] 330-15-346ms   | [S1,MB0,BW] 345-0-345ms    | [S6,MB4,F]  345-8-354ms    | [S6,MB3,BI] 374-10-385ms   | [S6,MB3,BW] 385-0-385ms    | [S1,MB7,F]  386-15-401ms   | [S1,MB1,BI] 401-15-417ms   | [S1,MB1,BW] 417-0-417ms    | [S6,MB5,F]  417-8-425ms    | [S6,MB4,BI] 465-11-477ms   | [S6,MB4,BW] 477-0-477ms    | [S1,MB2,BI] 484-13-498ms   | [S1,MB2,BW] 498-0-498ms    | [S6,MB6,F]  555-8-563ms    | [S6,MB5,BI] 563-10-573ms   | [S6,MB5,BW] 573-0-573ms    | [S1,MB3,BI] 579-14-593ms   | [S1,MB3,BW] 593-0-593ms    | [S6,MB7,F]  638-8-646ms    | [S6,MB6,BI] 647-10-657ms   | [S6,MB6,BW] 657-0-657ms    | [S1,MB4,BI] 664-14-678ms   | [S6,MB7,BI] 715-10-725ms   | [S1,MB5,BI] 725-14-740ms   | [S1,MB4,BW] 740-0-740ms    | [S1,MB6,BI] 753-14-767ms   | [S1,MB5,BW] 767-0-767ms    | [S1,MB7,BI] 777-13-791ms   | [S1,MB6,BW] 791-0-791ms    | [S6,MB7,BW] 791-0-791ms    | [S1,MB7,BW] 791-0-791ms   
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  39-8-47ms      | [S2,MB2,F]  58-8-66ms      | [S5,MB0,F]  66-9-75ms      | [S2,MB3,F]  76-10-87ms     | [S5,MB1,F]  87-8-95ms      | [S2,MB4,F]  100-10-111ms   | [S5,MB2,F]  120-9-129ms    | [S5,MB0,BI] 188-9-197ms    | [S5,MB0,BW] 197-0-197ms    | [S5,MB3,F]  198-9-207ms    | [S5,MB1,BI] 251-9-260ms    | [S5,MB1,BW] 260-0-260ms    | [S2,MB5,F]  260-9-270ms    | [S2,MB0,BI] 270-11-281ms   | [S2,MB0,BW] 281-0-281ms    | [S5,MB4,F]  281-8-290ms    | [S5,MB2,BI] 317-10-327ms   | [S5,MB2,BW] 327-0-327ms    | [S2,MB6,F]  331-10-341ms   | [S2,MB1,BI] 342-10-353ms   | [S2,MB1,BW] 353-0-353ms    | [S5,MB5,F]  353-8-361ms    | [S5,MB3,BI] 391-10-402ms   | [S5,MB3,BW] 402-0-402ms    | [S2,MB7,F]  402-10-413ms   | [S2,MB2,BI] 413-10-424ms   | [S2,MB2,BW] 424-0-424ms    | [S5,MB6,F]  424-8-432ms    | [S5,MB4,BI] 477-10-487ms   | [S5,MB4,BW] 487-0-487ms    | [S2,MB3,BI] 557-9-567ms    | [S2,MB3,BW] 567-0-567ms    | [S5,MB7,F]  579-8-587ms    | [S5,MB5,BI] 587-9-596ms    | [S5,MB5,BW] 596-0-596ms    | [S2,MB4,BI] 641-9-651ms    | [S5,MB6,BI] 657-10-667ms   | [S2,MB5,BI] 667-10-677ms   | [S5,MB7,BI] 726-9-735ms    | [S2,MB6,BI] 735-11-746ms   | [S2,MB4,BW] 746-0-746ms    | [S2,MB7,BI] 761-9-770ms    | [S2,MB5,BW] 771-0-771ms    | [S5,MB6,BW] 771-0-771ms    | [S5,MB7,BW] 771-0-771ms    | [S2,MB6,BW] 771-0-771ms    | [S2,MB7,BW] 771-0-771ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-7-36ms      | [S4,MB0,F]  36-8-44ms      | [S3,MB1,F]  47-9-56ms      | [S4,MB1,F]  56-8-65ms      | [S3,MB2,F]  66-8-75ms      | [S4,MB2,F]  75-8-83ms      | [S3,MB3,F]  102-8-111ms    | [S4,MB3,F]  111-8-120ms    | [S4,MB0,BI] 198-9-207ms    | [S4,MB0,BW] 207-0-207ms    | [S3,MB4,F]  207-7-215ms    | [S3,MB0,BI] 215-9-224ms    | [S3,MB0,BW] 224-0-224ms    | [S4,MB4,F]  224-8-233ms    | [S4,MB1,BI] 261-10-271ms   | [S4,MB1,BW] 271-0-271ms    | [S3,MB5,F]  271-9-281ms    | [S3,MB1,BI] 281-9-290ms    | [S3,MB1,BW] 290-0-290ms    | [S4,MB5,F]  290-8-298ms    | [S4,MB2,BI] 335-11-347ms   | [S4,MB2,BW] 347-0-347ms    | [S3,MB6,F]  347-8-355ms    | [S3,MB2,BI] 355-9-364ms    | [S3,MB2,BW] 364-0-364ms    | [S4,MB6,F]  364-8-372ms    | [S4,MB3,BI] 406-11-418ms   | [S4,MB3,BW] 418-0-418ms    | [S3,MB7,F]  418-8-426ms    | [S3,MB3,BI] 426-9-436ms    | [S3,MB3,BW] 435-0-435ms    | [S4,MB7,F]  435-8-444ms    | [S4,MB4,BI] 551-10-561ms   | [S4,MB4,BW] 561-0-561ms    | [S3,MB4,BI] 561-9-571ms    | [S4,MB5,BI] 635-10-645ms   | [S3,MB5,BI] 645-9-654ms    | [S4,MB6,BI] 667-9-676ms    | [S3,MB6,BI] 677-9-686ms    | [S4,MB7,BI] 737-9-746ms    | [S3,MB7,BI] 746-9-755ms    | [S3,MB4,BW] 755-0-755ms    | [S4,MB5,BW] 755-0-755ms    | [S4,MB6,BW] 755-0-755ms    | [S4,MB7,BW] 755-0-755ms    | [S3,MB5,BW] 755-0-755ms    | [S3,MB6,BW] 755-0-755ms    | [S3,MB7,BW] 755-0-755ms   
[rank3]:2025-12-25 11:37:07,026 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_apf_42_dm1/frozen_ratio_history/rank3/251225_1137_stage3_step100.svg
[rank3]:2025-12-25 11:37:07,062 - âœ… Frozen Ratio History of Rank 3 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_apf_42_dm1/frozen_ratio_history/rank3/251225_1137_stage4_step100.svg
[rank3]:2025-12-25 11:37:36,935 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 1.0000e-02
[rank1]:2025-12-25 11:37:36,965 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 1.0000e-02
[rank0]:2025-12-25 11:37:36,996 - Freezing Ratio: [Stage0] 0.00, [Stage7] 0.00, Threshold: 1.0000e-02
[rank2]:2025-12-25 11:37:36,948 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 1.0000e-02
[rank2]:2025-12-25 11:38:23,403 - Freezing Ratio: [Stage2] 0.78, [Stage5] 0.83, Threshold: 1.0000e-02
[rank3]:2025-12-25 11:38:23,402 - Freezing Ratio: [Stage3] 0.78, [Stage4] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-25 11:38:23,409 - Freezing Ratio: [Stage1] 0.81, [Stage6] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-25 11:38:23,457 - Freezing Ratio: [Stage0] 0.79, [Stage7] 0.64, Threshold: 1.0000e-02
[rank3]:2025-12-25 11:38:56,845 - Freezing Ratio: [Stage3] 0.78, [Stage4] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-25 11:38:56,875 - Freezing Ratio: [Stage1] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-25 11:38:56,905 - Freezing Ratio: [Stage0] 0.79, [Stage7] 0.64, Threshold: 1.0000e-02
[rank2]:2025-12-25 11:38:56,858 - Freezing Ratio: [Stage2] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-25 11:39:30,128 - Freezing Ratio: [Stage3] 0.78, [Stage4] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-25 11:39:30,157 - Freezing Ratio: [Stage1] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-25 11:39:30,188 - Freezing Ratio: [Stage0] 0.79, [Stage7] 0.64, Threshold: 1.0000e-02
[rank2]:2025-12-25 11:39:30,140 - Freezing Ratio: [Stage2] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-25 11:40:03,047 - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-12-25 11:40:03,396 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 1.0000e-02
[rank3]:2025-12-25 11:40:03,392 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 1.0000e-02
[rank1]:2025-12-25 11:40:03,413 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 1.0000e-02
[rank0]:2025-12-25 11:40:03,438 - Freezing Ratio: [Stage0] 0.00, [Stage7] 0.00, Threshold: 1.0000e-02
[rank3]:2025-12-25 11:40:07,994 - Avg. fwd time: 8.0687 / Avg. bwd-weight time: 5.9202 / Avg. bwd-input time: 9.6702 / Avg. batch time: 924.6178 (ms) / GPU bubble ratio: 59.06%
[rank1]:2025-12-25 11:40:08,006 - Avg. fwd time: 10.3203 / Avg. bwd-weight time: 7.7686 / Avg. bwd-input time: 12.2498 / Avg. batch time: 970.7429 (ms) / GPU bubble ratio: 50.00%
[rank0]:2025-12-25 11:40:08,014 - Avg. fwd time: 13.6387 / Avg. full-bwd time: 22.0408 (Avg. bwd-weight time: 18.0995 / Avg. bwd-input time: 34.5000) / Avg. batch time: 994.4499 (ms) / GPU bubble ratio: 18.01%
[rank2]:2025-12-25 11:40:07,985 - Avg. fwd time: 8.5565 / Avg. bwd-weight time: 6.0206 / Avg. bwd-input time: 10.0504 / Avg. batch time: 936.5088 (ms) / GPU bubble ratio: 57.92%
[rank3]:2025-12-25 11:40:08,060 -  step: 150  loss: -4.0000  grad_norm: 20.1106  memory: 16.16GiB(34.02%)  tps: 9,032  tflops: 70.61  mfu: 22.63%
[rank1]:2025-12-25 11:40:08,064 -  step: 150  loss: -4.0000  grad_norm: 20.1106  memory: 18.98GiB(39.95%)  tps: 9,032  tflops: 70.61  mfu: 22.63%
[rank0]:2025-12-25 11:40:08,087 -  step: 150  loss:  6.6350  grad_norm: 20.1106  memory: 40.23GiB(84.68%)  tps: 9,031  tflops: 70.60  mfu: 22.63%
[rank2]:2025-12-25 11:40:08,060 -  step: 150  loss: -4.0000  grad_norm: 20.1106  memory: 14.70GiB(30.94%)  tps: 9,032  tflops: 70.61  mfu: 22.63%
[rank1]:2025-12-25 11:40:49,764 - Freezing Ratio: [Stage1] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank2]:2025-12-25 11:40:49,757 - Freezing Ratio: [Stage2] 0.78, [Stage5] 0.83, Threshold: 1.0000e-02
[rank3]:2025-12-25 11:40:49,757 - Freezing Ratio: [Stage3] 0.78, [Stage4] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-25 11:40:49,811 - Freezing Ratio: [Stage0] 0.79, [Stage7] 0.64, Threshold: 1.0000e-02
[rank2]:2025-12-25 11:41:23,153 - Freezing Ratio: [Stage2] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-25 11:41:23,141 - Freezing Ratio: [Stage3] 0.78, [Stage4] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-25 11:41:23,171 - Freezing Ratio: [Stage1] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-25 11:41:23,201 - Freezing Ratio: [Stage0] 0.79, [Stage7] 0.64, Threshold: 1.0000e-02
[rank3]:2025-12-25 11:41:56,390 - Freezing Ratio: [Stage3] 0.78, [Stage4] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-25 11:41:56,420 - Freezing Ratio: [Stage1] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-25 11:41:56,450 - Freezing Ratio: [Stage0] 0.79, [Stage7] 0.64, Threshold: 1.0000e-02
[rank2]:2025-12-25 11:41:56,402 - Freezing Ratio: [Stage2] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank2]:2025-12-25 11:42:29,626 - Freezing Ratio: [Stage2] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-25 11:42:29,614 - Freezing Ratio: [Stage3] 0.78, [Stage4] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-25 11:42:29,643 - Freezing Ratio: [Stage1] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-25 11:42:29,674 - Freezing Ratio: [Stage0] 0.79, [Stage7] 0.64, Threshold: 1.0000e-02
[rank0]:2025-12-25 11:43:02,553 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-25 11:43:02,900 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 1.0000e-02
[rank1]:2025-12-25 11:43:02,930 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 1.0000e-02
[rank0]:2025-12-25 11:43:02,959 - Freezing Ratio: [Stage0] 0.00, [Stage7] 0.00, Threshold: 1.0000e-02
[rank2]:2025-12-25 11:43:02,912 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 1.0000e-02
[rank2]:2025-12-25 11:43:07,590 - Avg. fwd time: 8.6585 / Avg. bwd-weight time: 5.0207 / Avg. bwd-input time: 10.0561 / Avg. batch time: 905.8523 (ms) / GPU bubble ratio: 58.08%
[rank3]:2025-12-25 11:43:07,598 - Avg. fwd time: 8.1367 / Avg. bwd-weight time: 4.9369 / Avg. bwd-input time: 9.6769 / Avg. batch time: 892.0261 (ms) / GPU bubble ratio: 59.19%
[rank1]:2025-12-25 11:43:07,612 - Avg. fwd time: 10.4383 / Avg. bwd-weight time: 6.4783 / Avg. bwd-input time: 12.2660 / Avg. batch time: 939.8110 (ms) / GPU bubble ratio: 50.32%
[rank0]:2025-12-25 11:43:07,622 - Avg. fwd time: 13.6205 / Avg. full-bwd time: 20.2787 (Avg. bwd-weight time: 15.0922 / Avg. bwd-input time: 34.4810) / Avg. batch time: 963.7275 (ms) / GPU bubble ratio: 19.40%
[rank2]:2025-12-25 11:43:07,668 -  step: 200  loss: -4.0000  grad_norm: 25.2218  memory: 14.70GiB(30.94%)  tps: 9,122  tflops: 71.31  mfu: 22.86%
[rank3]:2025-12-25 11:43:07,668 -  step: 200  loss: -4.0000  grad_norm: 25.2218  memory: 16.16GiB(34.02%)  tps: 9,122  tflops: 71.31  mfu: 22.86%
[rank1]:2025-12-25 11:43:07,671 -  step: 200  loss: -4.0000  grad_norm: 25.2218  memory: 18.98GiB(39.95%)  tps: 9,122  tflops: 71.31  mfu: 22.86%
[rank1]:2025-12-25 11:43:07,752 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_apf_42_dm1/frozen_ratio_history/rank1/251225_1143_stage1_step200.svg
[rank0]:2025-12-25 11:43:07,694 -  step: 200  loss:  4.3978  grad_norm: 25.2218  memory: 40.23GiB(84.68%)  tps: 9,122  tflops: 71.31  mfu: 22.86%
[rank0]:2025-12-25 11:43:07,744 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_apf_42_dm1/frozen_ratio_history/rank0/251225_1143_stage0_step200.svg
[rank0]:2025-12-25 11:43:07,788 - âœ… Frozen Ratio History of Rank 0 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_apf_42_dm1/frozen_ratio_history/rank0/251225_1143_stage7_step200.svg
[rank2]:2025-12-25 11:43:07,745 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_apf_42_dm1/frozen_ratio_history/rank2/251225_1143_stage2_step200.svg
[rank2]:2025-12-25 11:43:07,785 - âœ… Frozen Ratio History of Rank 2 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_apf_42_dm1/frozen_ratio_history/rank2/251225_1143_stage5_step200.svg
[rank1]:2025-12-25 11:43:07,799 - âœ… Frozen Ratio History of Rank 1 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_apf_42_dm1/frozen_ratio_history/rank1/251225_1143_stage6_step200.svg
[rank3]:2025-12-25 11:43:08,004 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_apf_42_dm1/pipeline_schedule/251225_1143_step200_rank3.svg
[rank3]:			> Batch Time: 810.59 ms, GPU Bubble Ratio: 28.21%, 53.90%, 62.05%, 64.11%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-9-18ms       | [S0,MB2,F]  18-8-26ms      | [S0,MB3,F]  26-9-36ms      | [S0,MB4,F]  36-8-44ms      | [S0,MB5,F]  44-10-54ms     | [S0,MB6,F]  54-9-63ms      | [S7,MB0,F]  118-17-135ms   | [S7,MB0,BI] 147-32-179ms   | [S7,MB0,BW] 179-0-179ms    | [S7,MB1,F]  180-16-196ms   | [S7,MB1,BI] 208-33-242ms   | [S7,MB1,BW] 242-0-242ms    | [S7,MB2,F]  242-18-260ms   | [S7,MB2,BI] 272-35-308ms   | [S7,MB2,BW] 308-0-308ms    | [S7,MB3,F]  308-18-326ms   | [S7,MB3,BI] 339-35-374ms   | [S7,MB3,BW] 374-0-374ms    | [S0,MB7,F]  374-11-385ms   | [S0,MB0,B]  385-14-399ms   | [S7,MB4,F]  400-19-419ms   | [S7,MB4,BI] 431-35-466ms   | [S7,MB4,BW] 467-0-467ms    | [S0,MB1,B]  474-11-485ms   | [S7,MB5,F]  486-17-503ms   | [S7,MB5,BI] 515-34-550ms   | [S7,MB5,BW] 550-0-550ms    | [S0,MB2,B]  557-11-568ms   | [S7,MB6,F]  571-16-588ms   | [S7,MB6,BI] 600-34-634ms   | [S7,MB6,BW] 634-0-634ms    | [S0,MB3,B]  640-12-653ms   | [S7,MB7,F]  655-16-672ms   | [S7,MB7,BI] 684-33-718ms   | [S7,MB7,BW] 718-0-718ms    | [S0,MB4,B]  725-11-736ms   | [S0,MB5,B]  751-10-761ms   | [S0,MB6,B]  776-9-786ms    | [S0,MB7,B]  801-9-810ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  27-12-39ms     | [S1,MB2,F]  46-12-58ms     | [S1,MB3,F]  64-12-76ms     | [S1,MB4,F]  88-12-100ms    | [S6,MB0,F]  100-10-111ms   | [S1,MB5,F]  111-14-126ms   | [S6,MB1,F]  126-9-135ms    | [S6,MB0,BI] 179-9-189ms    | [S6,MB0,BW] 189-0-189ms    | [S6,MB2,F]  189-9-198ms    | [S6,MB1,BI] 242-9-251ms    | [S6,MB1,BW] 251-0-251ms    | [S6,MB3,F]  251-9-261ms    | [S6,MB2,BI] 307-9-317ms    | [S6,MB2,BW] 316-0-316ms    | [S1,MB6,F]  316-13-330ms   | [S1,MB0,BI] 330-15-346ms   | [S1,MB0,BW] 346-0-346ms    | [S6,MB4,F]  346-8-355ms    | [S6,MB3,BI] 374-11-385ms   | [S6,MB3,BW] 384-0-384ms    | [S1,MB7,F]  385-15-401ms   | [S1,MB1,BI] 401-15-416ms   | [S1,MB1,BW] 417-0-417ms    | [S6,MB5,F]  417-8-425ms    | [S6,MB4,BI] 466-11-478ms   | [S6,MB4,BW] 478-0-478ms    | [S1,MB2,BI] 485-13-499ms   | [S1,MB2,BW] 499-0-499ms    | [S6,MB6,F]  556-8-564ms    | [S6,MB5,BI] 564-10-574ms   | [S6,MB5,BW] 574-0-574ms    | [S1,MB3,BI] 580-14-594ms   | [S1,MB3,BW] 594-0-594ms    | [S6,MB7,F]  640-8-648ms    | [S6,MB6,BI] 648-10-658ms   | [S6,MB6,BW] 658-0-658ms    | [S1,MB4,BI] 665-14-679ms   | [S6,MB7,BI] 718-10-728ms   | [S1,MB5,BI] 728-14-743ms   | [S1,MB4,BW] 743-0-743ms    | [S1,MB6,BI] 756-14-770ms   | [S1,MB5,BW] 770-0-770ms    | [S1,MB7,BI] 780-13-794ms   | [S1,MB6,BW] 794-0-794ms    | [S6,MB7,BW] 794-0-794ms    | [S1,MB7,BW] 794-0-794ms   
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  39-8-47ms      | [S2,MB2,F]  58-8-66ms      | [S5,MB0,F]  66-9-75ms      | [S2,MB3,F]  77-10-87ms     | [S5,MB1,F]  87-8-95ms      | [S2,MB4,F]  101-10-112ms   | [S5,MB2,F]  120-9-129ms    | [S5,MB0,BI] 189-9-198ms    | [S5,MB0,BW] 198-0-198ms    | [S5,MB3,F]  198-9-208ms    | [S5,MB1,BI] 252-9-261ms    | [S5,MB1,BW] 261-0-261ms    | [S2,MB5,F]  261-9-271ms    | [S2,MB0,BI] 270-11-282ms   | [S2,MB0,BW] 282-0-282ms    | [S5,MB4,F]  282-8-290ms    | [S5,MB2,BI] 317-10-327ms   | [S5,MB2,BW] 327-0-327ms    | [S2,MB6,F]  331-10-342ms   | [S2,MB1,BI] 343-10-353ms   | [S2,MB1,BW] 353-0-353ms    | [S5,MB5,F]  353-8-361ms    | [S5,MB3,BI] 390-10-401ms   | [S5,MB3,BW] 401-0-401ms    | [S2,MB7,F]  401-10-412ms   | [S2,MB2,BI] 413-10-423ms   | [S2,MB2,BW] 424-0-424ms    | [S5,MB6,F]  424-8-432ms    | [S5,MB4,BI] 478-10-488ms   | [S5,MB4,BW] 488-0-488ms    | [S2,MB3,BI] 559-9-568ms    | [S2,MB3,BW] 568-0-568ms    | [S5,MB7,F]  580-8-588ms    | [S5,MB5,BI] 588-9-598ms    | [S5,MB5,BW] 598-0-598ms    | [S2,MB4,BI] 643-9-652ms    | [S5,MB6,BI] 658-10-668ms   | [S2,MB5,BI] 669-10-679ms   | [S5,MB7,BI] 729-9-738ms    | [S2,MB6,BI] 738-11-749ms   | [S2,MB4,BW] 749-0-749ms    | [S2,MB7,BI] 764-9-773ms    | [S2,MB5,BW] 773-0-773ms    | [S5,MB6,BW] 773-0-773ms    | [S5,MB7,BW] 773-0-773ms    | [S2,MB6,BW] 773-0-773ms    | [S2,MB7,BW] 773-0-773ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-7-36ms      | [S4,MB0,F]  36-8-44ms      | [S3,MB1,F]  47-9-57ms      | [S4,MB1,F]  57-8-65ms      | [S3,MB2,F]  67-8-75ms      | [S4,MB2,F]  75-8-84ms      | [S3,MB3,F]  103-8-111ms    | [S4,MB3,F]  111-8-120ms    | [S4,MB0,BI] 198-9-207ms    | [S4,MB0,BW] 207-0-207ms    | [S3,MB4,F]  208-8-216ms    | [S3,MB0,BI] 216-9-225ms    | [S3,MB0,BW] 225-0-225ms    | [S4,MB4,F]  225-8-233ms    | [S4,MB1,BI] 261-10-272ms   | [S4,MB1,BW] 272-0-272ms    | [S3,MB5,F]  272-9-281ms    | [S3,MB1,BI] 281-9-290ms    | [S3,MB1,BW] 290-0-290ms    | [S4,MB5,F]  290-8-299ms    | [S4,MB2,BI] 336-11-347ms   | [S4,MB2,BW] 347-0-347ms    | [S3,MB6,F]  347-8-356ms    | [S3,MB2,BI] 355-9-365ms    | [S3,MB2,BW] 365-0-365ms    | [S4,MB6,F]  365-8-373ms    | [S4,MB3,BI] 406-11-417ms   | [S4,MB3,BW] 417-0-417ms    | [S3,MB7,F]  417-8-426ms    | [S3,MB3,BI] 426-9-435ms    | [S3,MB3,BW] 435-0-435ms    | [S4,MB7,F]  435-8-444ms    | [S4,MB4,BI] 552-10-563ms   | [S4,MB4,BW] 563-0-563ms    | [S3,MB4,BI] 563-9-572ms    | [S4,MB5,BI] 636-10-647ms   | [S3,MB5,BI] 646-9-656ms    | [S4,MB6,BI] 669-9-678ms    | [S3,MB6,BI] 678-9-687ms    | [S4,MB7,BI] 739-9-749ms    | [S3,MB7,BI] 748-9-758ms    | [S3,MB4,BW] 758-0-758ms    | [S4,MB5,BW] 758-0-758ms    | [S4,MB6,BW] 758-0-758ms    | [S4,MB7,BW] 758-0-758ms    | [S3,MB5,BW] 758-0-758ms    | [S3,MB6,BW] 758-0-758ms    | [S3,MB7,BW] 758-0-758ms   
[rank3]:2025-12-25 11:43:08,049 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_apf_42_dm1/frozen_ratio_history/rank3/251225_1143_stage3_step200.svg
[rank3]:2025-12-25 11:43:08,090 - âœ… Frozen Ratio History of Rank 3 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_apf_42_dm1/frozen_ratio_history/rank3/251225_1143_stage4_step200.svg
[rank2]:2025-12-25 11:43:49,848 - Freezing Ratio: [Stage2] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-25 11:43:49,848 - Freezing Ratio: [Stage3] 0.78, [Stage4] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-25 11:43:49,855 - Freezing Ratio: [Stage1] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-25 11:43:49,902 - Freezing Ratio: [Stage0] 0.79, [Stage7] 0.64, Threshold: 1.0000e-02
[rank1]:2025-12-25 11:44:23,164 - Freezing Ratio: [Stage1] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank2]:2025-12-25 11:44:23,148 - Freezing Ratio: [Stage2] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-25 11:44:23,135 - Freezing Ratio: [Stage3] 0.78, [Stage4] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-25 11:44:23,195 - Freezing Ratio: [Stage0] 0.79, [Stage7] 0.64, Threshold: 1.0000e-02
[rank1]:2025-12-25 11:44:56,404 - Freezing Ratio: [Stage1] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-25 11:44:56,435 - Freezing Ratio: [Stage0] 0.79, [Stage7] 0.64, Threshold: 1.0000e-02
[rank2]:2025-12-25 11:44:56,387 - Freezing Ratio: [Stage2] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-25 11:44:56,374 - Freezing Ratio: [Stage3] 0.78, [Stage4] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-25 11:45:29,745 - Freezing Ratio: [Stage1] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-25 11:45:29,776 - Freezing Ratio: [Stage0] 0.79, [Stage7] 0.64, Threshold: 1.0000e-02
[rank2]:2025-12-25 11:45:29,728 - Freezing Ratio: [Stage2] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-25 11:45:29,715 - Freezing Ratio: [Stage3] 0.78, [Stage4] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-25 11:46:02,694 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-25 11:46:03,042 - Freezing Ratio: [Stage3] 0.78, [Stage4] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-25 11:46:03,062 - Freezing Ratio: [Stage1] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-25 11:46:03,087 - Freezing Ratio: [Stage0] 0.79, [Stage7] 0.64, Threshold: 1.0000e-02
[rank2]:2025-12-25 11:46:03,044 - Freezing Ratio: [Stage2] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-25 11:46:06,337 - Avg. fwd time: 8.1793 / Avg. bwd-weight time: 4.3063 / Avg. bwd-input time: 9.6806 / Avg. batch time: 871.1954 (ms) / GPU bubble ratio: 59.29%
[rank1]:2025-12-25 11:46:06,366 - Avg. fwd time: 10.5104 / Avg. bwd-weight time: 5.6514 / Avg. bwd-input time: 12.2745 / Avg. batch time: 920.3026 (ms) / GPU bubble ratio: 50.56%
[rank1]:2025-12-25 11:46:06,400 -  step: 250  loss: -4.0000  grad_norm:  0.0000  memory: 18.98GiB(39.95%)  tps: 9,167  tflops: 71.66  mfu: 22.97%
[rank0]:2025-12-25 11:46:06,377 - Avg. fwd time: 13.6104 / Avg. full-bwd time: 19.1449 (Avg. bwd-weight time: 13.1681 / Avg. bwd-input time: 34.4706) / Avg. batch time: 944.3550 (ms) / GPU bubble ratio: 20.37%
[rank0]:2025-12-25 11:46:06,400 -  step: 250  loss:  7.2710  grad_norm:  0.2738  memory: 40.23GiB(84.68%)  tps: 9,168  tflops: 71.67  mfu: 22.97%
[rank2]:2025-12-25 11:46:06,349 - Avg. fwd time: 8.7230 / Avg. bwd-weight time: 4.3795 / Avg. bwd-input time: 10.0594 / Avg. batch time: 886.5329 (ms) / GPU bubble ratio: 58.20%
[rank2]:2025-12-25 11:46:06,400 -  step: 250  loss: -4.0000  grad_norm:  0.0000  memory: 14.70GiB(30.94%)  tps: 9,167  tflops: 71.66  mfu: 22.97%
[rank3]:2025-12-25 11:46:06,400 -  step: 250  loss: -4.0000  grad_norm:  0.0000  memory: 16.16GiB(34.02%)  tps: 9,167  tflops: 71.66  mfu: 22.97%
[rank2]:2025-12-25 11:46:36,245 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 1.0000e-02
[rank3]:2025-12-25 11:46:36,233 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 1.0000e-02
[rank1]:2025-12-25 11:46:36,262 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 1.0000e-02
[rank0]:2025-12-25 11:46:36,293 - Freezing Ratio: [Stage0] 0.00, [Stage7] 0.00, Threshold: 1.0000e-02
[rank3]:2025-12-25 11:47:22,542 - Freezing Ratio: [Stage3] 0.83, [Stage4] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-25 11:47:22,550 - Freezing Ratio: [Stage1] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank2]:2025-12-25 11:47:22,543 - Freezing Ratio: [Stage2] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-25 11:47:22,597 - Freezing Ratio: [Stage0] 0.79, [Stage7] 0.64, Threshold: 1.0000e-02
[rank2]:2025-12-25 11:47:55,842 - Freezing Ratio: [Stage2] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-25 11:47:55,829 - Freezing Ratio: [Stage3] 0.78, [Stage4] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-25 11:47:55,859 - Freezing Ratio: [Stage1] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-25 11:47:55,890 - Freezing Ratio: [Stage0] 0.79, [Stage7] 0.64, Threshold: 1.0000e-02
[rank2]:2025-12-25 11:48:29,197 - Freezing Ratio: [Stage2] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-25 11:48:29,185 - Freezing Ratio: [Stage3] 0.78, [Stage4] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-25 11:48:29,215 - Freezing Ratio: [Stage1] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-25 11:48:29,245 - Freezing Ratio: [Stage0] 0.79, [Stage7] 0.64, Threshold: 1.0000e-02
[rank0]:2025-12-25 11:49:02,055 - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-12-25 11:49:02,420 - Freezing Ratio: [Stage1] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-25 11:49:02,449 - Freezing Ratio: [Stage0] 0.84, [Stage7] 0.64, Threshold: 1.0000e-02
[rank2]:2025-12-25 11:49:02,402 - Freezing Ratio: [Stage2] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-25 11:49:02,390 - Freezing Ratio: [Stage3] 0.78, [Stage4] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-25 11:49:05,690 - Avg. fwd time: 8.2044 / Avg. bwd-weight time: 3.9187 / Avg. bwd-input time: 9.6846 / Avg. batch time: 858.1847 (ms) / GPU bubble ratio: 59.34%
[rank1]:2025-12-25 11:49:05,720 - Avg. fwd time: 10.5542 / Avg. bwd-weight time: 5.1427 / Avg. bwd-input time: 12.2801 / Avg. batch time: 907.8809 (ms) / GPU bubble ratio: 50.69%
[rank1]:2025-12-25 11:49:05,752 -  step: 300  loss: -4.0000  grad_norm:  0.0000  memory: 18.98GiB(39.95%)  tps: 9,135  tflops: 71.41  mfu: 22.89%
[rank0]:2025-12-25 11:49:05,730 - Avg. fwd time: 13.5971 / Avg. full-bwd time: 18.4401 (Avg. bwd-weight time: 11.9821 / Avg. bwd-input time: 34.4529) / Avg. batch time: 931.9925 (ms) / GPU bubble ratio: 20.97%
[rank0]:2025-12-25 11:49:05,753 -  step: 300  loss:  6.6318  grad_norm:  0.1540  memory: 40.23GiB(84.68%)  tps: 9,135  tflops: 71.41  mfu: 22.89%
[rank2]:2025-12-25 11:49:05,703 - Avg. fwd time: 8.7618 / Avg. bwd-weight time: 3.9854 / Avg. bwd-input time: 10.0634 / Avg. batch time: 874.2369 (ms) / GPU bubble ratio: 58.25%
[rank2]:2025-12-25 11:49:05,752 -  step: 300  loss: -4.0000  grad_norm:  0.0000  memory: 14.70GiB(30.94%)  tps: 9,135  tflops: 71.41  mfu: 22.89%
[rank3]:2025-12-25 11:49:05,752 -  step: 300  loss: -4.0000  grad_norm:  0.0000  memory: 16.16GiB(34.02%)  tps: 9,135  tflops: 71.41  mfu: 22.89%
[rank1]:2025-12-25 11:49:05,809 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_apf_42_dm1/frozen_ratio_history/rank1/251225_1149_stage1_step300.svg
[rank0]:2025-12-25 11:49:05,803 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_apf_42_dm1/frozen_ratio_history/rank0/251225_1149_stage0_step300.svg
[rank0]:2025-12-25 11:49:05,846 - âœ… Frozen Ratio History of Rank 0 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_apf_42_dm1/frozen_ratio_history/rank0/251225_1149_stage7_step300.svg
[rank2]:2025-12-25 11:49:05,802 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_apf_42_dm1/frozen_ratio_history/rank2/251225_1149_stage2_step300.svg
[rank2]:2025-12-25 11:49:05,841 - âœ… Frozen Ratio History of Rank 2 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_apf_42_dm1/frozen_ratio_history/rank2/251225_1149_stage5_step300.svg
[rank1]:2025-12-25 11:49:05,855 - âœ… Frozen Ratio History of Rank 1 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_apf_42_dm1/frozen_ratio_history/rank1/251225_1149_stage6_step300.svg
[rank3]:2025-12-25 11:49:06,053 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_apf_42_dm1/pipeline_schedule/251225_1149_step300_rank3.svg
[rank3]:			> Batch Time: 805.06 ms, GPU Bubble Ratio: 28.37%, 53.68%, 61.77%, 63.89%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-9-18ms       | [S0,MB2,F]  18-8-26ms      | [S0,MB3,F]  26-9-36ms      | [S0,MB4,F]  36-8-44ms      | [S0,MB5,F]  44-9-54ms      | [S0,MB6,F]  54-9-63ms      | [S7,MB0,F]  118-17-135ms   | [S7,MB0,BI] 147-32-179ms   | [S7,MB0,BW] 179-0-179ms    | [S7,MB1,F]  179-16-195ms   | [S7,MB1,BI] 208-33-241ms   | [S7,MB1,BW] 242-0-242ms    | [S7,MB2,F]  242-18-260ms   | [S7,MB2,BI] 272-35-307ms   | [S7,MB2,BW] 307-0-307ms    | [S7,MB3,F]  307-18-326ms   | [S7,MB3,BI] 338-35-373ms   | [S7,MB3,BW] 373-0-373ms    | [S0,MB7,F]  373-11-384ms   | [S0,MB0,B]  384-13-398ms   | [S7,MB4,F]  397-19-416ms   | [S7,MB4,BI] 428-34-463ms   | [S7,MB4,BW] 464-0-464ms    | [S0,MB1,B]  471-12-483ms   | [S7,MB5,F]  482-17-499ms   | [S7,MB5,BI] 511-34-546ms   | [S7,MB5,BW] 546-0-546ms    | [S0,MB2,B]  553-11-564ms   | [S7,MB6,F]  567-16-583ms   | [S7,MB6,BI] 596-33-629ms   | [S7,MB6,BW] 629-0-629ms    | [S0,MB3,B]  636-10-647ms   | [S7,MB7,F]  651-15-666ms   | [S7,MB7,BI] 679-33-712ms   | [S7,MB7,BW] 713-0-713ms    | [S0,MB4,B]  720-10-730ms   | [S0,MB5,B]  746-10-756ms   | [S0,MB6,B]  771-9-780ms    | [S0,MB7,B]  795-9-805ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  27-12-39ms     | [S1,MB2,F]  46-12-58ms     | [S1,MB3,F]  64-12-76ms     | [S1,MB4,F]  88-12-100ms    | [S6,MB0,F]  100-10-110ms   | [S1,MB5,F]  110-14-125ms   | [S6,MB1,F]  125-9-134ms    | [S6,MB0,BI] 179-9-188ms    | [S6,MB0,BW] 188-0-188ms    | [S6,MB2,F]  188-9-198ms    | [S6,MB1,BI] 241-9-251ms    | [S6,MB1,BW] 251-0-251ms    | [S6,MB3,F]  251-9-260ms    | [S6,MB2,BI] 307-9-316ms    | [S6,MB2,BW] 316-0-316ms    | [S1,MB6,F]  316-13-330ms   | [S1,MB0,BI] 330-15-346ms   | [S1,MB0,BW] 346-0-346ms    | [S6,MB4,F]  346-8-355ms    | [S6,MB3,BI] 372-10-383ms   | [S6,MB3,BW] 383-0-383ms    | [S1,MB7,F]  384-15-400ms   | [S1,MB1,BI] 400-15-415ms   | [S1,MB1,BW] 415-0-415ms    | [S6,MB5,F]  415-8-424ms    | [S6,MB4,BI] 463-11-475ms   | [S6,MB4,BW] 475-0-475ms    | [S1,MB2,BI] 481-13-495ms   | [S1,MB2,BW] 495-0-495ms    | [S6,MB6,F]  552-8-560ms    | [S6,MB5,BI] 560-10-570ms   | [S6,MB5,BW] 570-0-570ms    | [S1,MB3,BI] 576-14-590ms   | [S1,MB3,BW] 590-0-590ms    | [S6,MB7,F]  635-8-643ms    | [S6,MB6,BI] 643-10-653ms   | [S6,MB6,BW] 654-0-654ms    | [S1,MB4,BI] 660-14-674ms   | [S6,MB7,BI] 712-10-723ms   | [S1,MB5,BI] 723-14-737ms   | [S1,MB4,BW] 737-0-737ms    | [S1,MB6,BI] 750-13-764ms   | [S1,MB5,BW] 764-0-764ms    | [S1,MB7,BI] 774-13-788ms   | [S1,MB6,BW] 788-0-788ms    | [S6,MB7,BW] 788-0-788ms    | [S1,MB7,BW] 788-0-788ms   
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  39-8-47ms      | [S2,MB2,F]  58-8-66ms      | [S5,MB0,F]  66-9-75ms      | [S2,MB3,F]  77-10-87ms     | [S5,MB1,F]  87-8-95ms      | [S2,MB4,F]  100-11-112ms   | [S5,MB2,F]  120-9-129ms    | [S5,MB0,BI] 189-9-198ms    | [S5,MB0,BW] 198-0-198ms    | [S5,MB3,F]  198-9-207ms    | [S5,MB1,BI] 251-9-260ms    | [S5,MB1,BW] 260-0-260ms    | [S2,MB5,F]  260-9-270ms    | [S2,MB0,BI] 270-11-281ms   | [S2,MB0,BW] 281-0-281ms    | [S5,MB4,F]  281-8-290ms    | [S5,MB2,BI] 316-10-327ms   | [S5,MB2,BW] 327-0-327ms    | [S2,MB6,F]  330-10-341ms   | [S2,MB1,BI] 342-10-353ms   | [S2,MB1,BW] 353-0-353ms    | [S5,MB5,F]  353-8-361ms    | [S5,MB3,BI] 389-10-400ms   | [S5,MB3,BW] 400-0-400ms    | [S2,MB7,F]  400-10-411ms   | [S2,MB2,BI] 412-10-422ms   | [S2,MB2,BW] 422-0-422ms    | [S5,MB6,F]  422-8-431ms    | [S5,MB4,BI] 474-10-485ms   | [S5,MB4,BW] 485-0-485ms    | [S2,MB3,BI] 555-9-564ms    | [S2,MB3,BW] 564-0-564ms    | [S5,MB7,F]  576-8-584ms    | [S5,MB5,BI] 584-9-594ms    | [S5,MB5,BW] 593-0-593ms    | [S2,MB4,BI] 638-9-648ms    | [S5,MB6,BI] 654-10-664ms   | [S2,MB5,BI] 664-10-674ms   | [S5,MB7,BI] 723-9-733ms    | [S2,MB6,BI] 732-11-743ms   | [S2,MB4,BW] 743-0-743ms    | [S2,MB7,BI] 758-9-768ms    | [S2,MB5,BW] 768-0-768ms    | [S5,MB6,BW] 768-0-768ms    | [S5,MB7,BW] 768-0-768ms    | [S2,MB6,BW] 768-0-768ms    | [S2,MB7,BW] 768-0-768ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-7-36ms      | [S4,MB0,F]  36-8-44ms      | [S3,MB1,F]  47-9-57ms      | [S4,MB1,F]  57-8-65ms      | [S3,MB2,F]  66-8-75ms      | [S4,MB2,F]  75-8-84ms      | [S3,MB3,F]  102-8-111ms    | [S4,MB3,F]  111-8-120ms    | [S4,MB0,BI] 198-9-207ms    | [S4,MB0,BW] 207-0-207ms    | [S3,MB4,F]  207-7-215ms    | [S3,MB0,BI] 215-9-224ms    | [S3,MB0,BW] 224-0-224ms    | [S4,MB4,F]  224-8-233ms    | [S4,MB1,BI] 261-10-271ms   | [S4,MB1,BW] 271-0-271ms    | [S3,MB5,F]  271-9-281ms    | [S3,MB1,BI] 281-9-290ms    | [S3,MB1,BW] 290-0-290ms    | [S4,MB5,F]  290-8-298ms    | [S4,MB2,BI] 335-11-347ms   | [S4,MB2,BW] 347-0-347ms    | [S3,MB6,F]  347-8-355ms    | [S3,MB2,BI] 355-9-365ms    | [S3,MB2,BW] 365-0-365ms    | [S4,MB6,F]  365-8-373ms    | [S4,MB3,BI] 405-11-417ms   | [S4,MB3,BW] 416-0-416ms    | [S3,MB7,F]  416-8-425ms    | [S3,MB3,BI] 425-9-434ms    | [S3,MB3,BW] 434-0-434ms    | [S4,MB7,F]  434-8-443ms    | [S4,MB4,BI] 548-10-559ms   | [S4,MB4,BW] 559-0-559ms    | [S3,MB4,BI] 559-9-568ms    | [S4,MB5,BI] 632-10-642ms   | [S3,MB5,BI] 642-9-651ms    | [S4,MB6,BI] 664-9-674ms    | [S3,MB6,BI] 674-9-683ms    | [S4,MB7,BI] 734-9-743ms    | [S3,MB7,BI] 743-9-752ms    | [S3,MB4,BW] 752-0-752ms    | [S4,MB5,BW] 752-0-752ms    | [S4,MB6,BW] 752-0-752ms    | [S4,MB7,BW] 752-0-752ms    | [S3,MB5,BW] 752-0-752ms    | [S3,MB6,BW] 752-0-752ms    | [S3,MB7,BW] 752-0-752ms   
[rank3]:2025-12-25 11:49:06,095 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_apf_42_dm1/frozen_ratio_history/rank3/251225_1149_stage3_step300.svg
[rank3]:2025-12-25 11:49:06,136 - âœ… Frozen Ratio History of Rank 3 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_apf_42_dm1/frozen_ratio_history/rank3/251225_1149_stage4_step300.svg
[rank3]:2025-12-25 11:49:35,720 - Freezing Ratio: [Stage3] 0.78, [Stage4] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-25 11:49:35,749 - Freezing Ratio: [Stage1] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-25 11:49:35,778 - Freezing Ratio: [Stage0] 0.79, [Stage7] 0.64, Threshold: 1.0000e-02
[rank2]:2025-12-25 11:49:35,732 - Freezing Ratio: [Stage2] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-25 11:50:09,036 - Freezing Ratio: [Stage1] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank2]:2025-12-25 11:50:09,018 - Freezing Ratio: [Stage2] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-25 11:50:09,005 - Freezing Ratio: [Stage3] 0.78, [Stage4] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-25 11:50:09,066 - Freezing Ratio: [Stage0] 0.84, [Stage7] 0.64, Threshold: 1.0000e-02
[rank3]:2025-12-25 11:50:42,102 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 1.0000e-02
[rank1]:2025-12-25 11:50:42,132 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 1.0000e-02
[rank0]:2025-12-25 11:50:42,161 - Freezing Ratio: [Stage0] 0.05, [Stage7] 0.00, Threshold: 1.0000e-02
[rank2]:2025-12-25 11:50:42,115 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 1.0000e-02
[rank1]:2025-12-25 11:51:28,345 - Freezing Ratio: [Stage1] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank2]:2025-12-25 11:51:28,338 - Freezing Ratio: [Stage2] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-25 11:51:28,338 - Freezing Ratio: [Stage3] 0.83, [Stage4] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-25 11:51:28,392 - Freezing Ratio: [Stage0] 0.79, [Stage7] 0.64, Threshold: 1.0000e-02
[rank0]:2025-12-25 11:52:01,308 - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-12-25 11:52:01,678 - Freezing Ratio: [Stage1] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-25 11:52:01,703 - Freezing Ratio: [Stage0] 0.84, [Stage7] 0.64, Threshold: 1.0000e-02
[rank2]:2025-12-25 11:52:01,660 - Freezing Ratio: [Stage2] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-25 11:52:01,658 - Freezing Ratio: [Stage3] 0.78, [Stage4] 0.78, Threshold: 1.0000e-02
[rank2]:2025-12-25 11:52:04,989 - Avg. fwd time: 8.7902 / Avg. bwd-weight time: 3.7042 / Avg. bwd-input time: 10.0673 / Avg. batch time: 865.4399 (ms) / GPU bubble ratio: 58.29%
[rank3]:2025-12-25 11:52:04,976 - Avg. fwd time: 8.2224 / Avg. bwd-weight time: 3.6420 / Avg. bwd-input time: 9.6890 / Avg. batch time: 848.6879 (ms) / GPU bubble ratio: 59.37%
[rank1]:2025-12-25 11:52:05,006 - Avg. fwd time: 10.5862 / Avg. bwd-weight time: 4.7793 / Avg. bwd-input time: 12.2855 / Avg. batch time: 898.9946 (ms) / GPU bubble ratio: 50.79%
[rank1]:2025-12-25 11:52:05,039 -  step: 350  loss: -4.0000  grad_norm:  0.0000  memory: 18.98GiB(39.95%)  tps: 9,138  tflops: 71.44  mfu: 22.90%
[rank0]:2025-12-25 11:52:05,016 - Avg. fwd time: 13.5923 / Avg. full-bwd time: 17.8380 (Avg. bwd-weight time: 11.1308 / Avg. bwd-input time: 34.4398) / Avg. batch time: 923.0550 (ms) / GPU bubble ratio: 21.48%
[rank0]:2025-12-25 11:52:05,039 -  step: 350  loss:  4.5636  grad_norm:  0.0670  memory: 40.23GiB(84.68%)  tps: 9,139  tflops: 71.44  mfu: 22.90%
[rank2]:2025-12-25 11:52:05,039 -  step: 350  loss: -4.0000  grad_norm:  0.0000  memory: 14.70GiB(30.94%)  tps: 9,138  tflops: 71.44  mfu: 22.90%
[rank3]:2025-12-25 11:52:05,039 -  step: 350  loss: -4.0000  grad_norm:  0.0000  memory: 16.18GiB(34.07%)  tps: 9,138  tflops: 71.44  mfu: 22.90%
[rank2]:2025-12-25 11:52:34,738 - Freezing Ratio: [Stage2] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-25 11:52:34,726 - Freezing Ratio: [Stage3] 0.78, [Stage4] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-25 11:52:34,756 - Freezing Ratio: [Stage1] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-25 11:52:34,785 - Freezing Ratio: [Stage0] 0.84, [Stage7] 0.64, Threshold: 1.0000e-02
[rank3]:2025-12-25 11:53:07,811 - Freezing Ratio: [Stage3] 0.78, [Stage4] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-25 11:53:07,841 - Freezing Ratio: [Stage1] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-25 11:53:07,870 - Freezing Ratio: [Stage0] 0.84, [Stage7] 0.64, Threshold: 1.0000e-02
[rank2]:2025-12-25 11:53:07,824 - Freezing Ratio: [Stage2] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank2]:2025-12-25 11:53:40,810 - Freezing Ratio: [Stage2] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-25 11:53:40,797 - Freezing Ratio: [Stage3] 0.78, [Stage4] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-25 11:53:40,827 - Freezing Ratio: [Stage1] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-25 11:53:40,856 - Freezing Ratio: [Stage0] 0.79, [Stage7] 0.64, Threshold: 1.0000e-02
[rank1]:2025-12-25 11:54:14,037 - Freezing Ratio: [Stage1] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank2]:2025-12-25 11:54:14,020 - Freezing Ratio: [Stage2] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-25 11:54:14,068 - Freezing Ratio: [Stage0] 0.84, [Stage7] 0.64, Threshold: 1.0000e-02
[rank3]:2025-12-25 11:54:14,007 - Freezing Ratio: [Stage3] 0.78, [Stage4] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-25 11:54:46,641 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-25 11:54:47,031 - Freezing Ratio: [Stage3] 0.78, [Stage4] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-25 11:54:47,061 - Freezing Ratio: [Stage1] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank2]:2025-12-25 11:54:47,043 - Freezing Ratio: [Stage2] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-25 11:54:47,088 - Freezing Ratio: [Stage0] 0.84, [Stage7] 0.64, Threshold: 1.0000e-02
[rank2]:2025-12-25 11:54:50,406 - Avg. fwd time: 8.8370 / Avg. bwd-weight time: 3.2415 / Avg. bwd-input time: 10.0702 / Avg. batch time: 850.7761 (ms) / GPU bubble ratio: 58.35%
[rank0]:2025-12-25 11:54:50,434 - Avg. fwd time: 13.5862 / Avg. full-bwd time: 16.8487 (Avg. bwd-weight time: 9.7398 / Avg. bwd-input time: 34.4146) / Avg. batch time: 908.2054 (ms) / GPU bubble ratio: 22.33%
[rank3]:2025-12-25 11:54:50,395 - Avg. fwd time: 8.2536 / Avg. bwd-weight time: 3.1873 / Avg. bwd-input time: 9.6930 / Avg. batch time: 833.1517 (ms) / GPU bubble ratio: 59.41%
[rank1]:2025-12-25 11:54:50,424 - Avg. fwd time: 10.6392 / Avg. bwd-weight time: 4.1822 / Avg. bwd-input time: 12.2909 / Avg. batch time: 884.1977 (ms) / GPU bubble ratio: 50.94%
[rank1]:2025-12-25 11:54:50,457 -  step: 400  loss: -4.0000  grad_norm:  0.0000  memory: 18.98GiB(39.95%)  tps: 9,905  tflops: 77.43  mfu: 24.82%
[rank1]:2025-12-25 11:54:50,517 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_apf_42_dm1/frozen_ratio_history/rank1/251225_1154_stage1_step400.svg
[rank2]:2025-12-25 11:54:50,457 -  step: 400  loss: -4.0000  grad_norm:  0.0000  memory: 14.70GiB(30.94%)  tps: 9,905  tflops: 77.43  mfu: 24.82%
[rank2]:2025-12-25 11:54:50,510 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_apf_42_dm1/frozen_ratio_history/rank2/251225_1154_stage2_step400.svg
[rank0]:2025-12-25 11:54:50,457 -  step: 400  loss:  3.3049  grad_norm:  0.1107  memory: 40.23GiB(84.68%)  tps: 9,905  tflops: 77.43  mfu: 24.82%
[rank0]:2025-12-25 11:54:50,511 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_apf_42_dm1/frozen_ratio_history/rank0/251225_1154_stage0_step400.svg
[rank3]:2025-12-25 11:54:50,457 -  step: 400  loss: -4.0000  grad_norm:  0.0000  memory: 16.18GiB(34.07%)  tps: 9,905  tflops: 77.43  mfu: 24.82%
[rank1]:2025-12-25 11:54:50,568 - âœ… Frozen Ratio History of Rank 1 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_apf_42_dm1/frozen_ratio_history/rank1/251225_1154_stage6_step400.svg
[rank2]:2025-12-25 11:54:50,553 - âœ… Frozen Ratio History of Rank 2 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_apf_42_dm1/frozen_ratio_history/rank2/251225_1154_stage5_step400.svg
[rank0]:2025-12-25 11:54:50,559 - âœ… Frozen Ratio History of Rank 0 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_apf_42_dm1/frozen_ratio_history/rank0/251225_1154_stage7_step400.svg
[rank3]:2025-12-25 11:54:50,755 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_apf_42_dm1/pipeline_schedule/251225_1154_step400_rank3.svg
[rank3]:			> Batch Time: 802.55 ms, GPU Bubble Ratio: 29.67%, 53.43%, 61.58%, 63.71%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-9-18ms       | [S0,MB2,F]  18-8-26ms      | [S0,MB3,F]  26-9-36ms      | [S0,MB4,F]  36-8-44ms      | [S0,MB5,F]  44-10-54ms     | [S0,MB6,F]  54-9-63ms      | [S7,MB0,F]  118-17-135ms   | [S7,MB0,BI] 147-32-179ms   | [S7,MB0,BW] 180-0-180ms    | [S7,MB1,F]  180-16-196ms   | [S7,MB1,BI] 208-33-242ms   | [S7,MB1,BW] 242-0-242ms    | [S7,MB2,F]  242-18-260ms   | [S7,MB2,BI] 272-35-307ms   | [S7,MB2,BW] 308-0-308ms    | [S7,MB3,F]  308-18-326ms   | [S7,MB3,BI] 338-35-373ms   | [S7,MB3,BW] 373-0-373ms    | [S0,MB7,F]  373-11-384ms   | [S0,MB0,B]  384-12-396ms   | [S7,MB4,F]  397-19-416ms   | [S7,MB4,BI] 428-35-463ms   | [S7,MB4,BW] 464-0-464ms    | [S0,MB1,B]  471-10-481ms   | [S7,MB5,F]  481-17-498ms   | [S7,MB5,BI] 511-34-545ms   | [S7,MB5,BW] 545-0-545ms    | [S0,MB2,B]  552-10-562ms   | [S7,MB6,F]  567-16-583ms   | [S7,MB6,BI] 596-33-629ms   | [S7,MB6,BW] 629-0-629ms    | [S0,MB3,B]  636-9-645ms    | [S7,MB7,F]  651-15-666ms   | [S7,MB7,BI] 678-33-712ms   | [S7,MB7,BW] 711-0-711ms    | [S0,MB4,B]  718-9-727ms    | [S0,MB5,B]  745-8-753ms    | [S0,MB6,B]  770-8-778ms    | [S0,MB7,B]  794-8-802ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  27-12-39ms     | [S1,MB2,F]  46-12-58ms     | [S1,MB3,F]  64-12-76ms     | [S1,MB4,F]  88-12-100ms    | [S6,MB0,F]  100-10-111ms   | [S1,MB5,F]  111-14-126ms   | [S6,MB1,F]  126-9-135ms    | [S6,MB0,BI] 180-9-189ms    | [S6,MB0,BW] 189-0-189ms    | [S6,MB2,F]  189-9-198ms    | [S6,MB1,BI] 242-9-251ms    | [S6,MB1,BW] 251-0-251ms    | [S6,MB3,F]  251-9-260ms    | [S6,MB2,BI] 308-9-317ms    | [S6,MB2,BW] 317-0-317ms    | [S1,MB6,F]  317-13-331ms   | [S1,MB0,BI] 331-15-346ms   | [S1,MB0,BW] 346-0-346ms    | [S6,MB4,F]  346-8-355ms    | [S6,MB3,BI] 373-11-384ms   | [S6,MB3,BW] 384-0-384ms    | [S1,MB7,F]  385-15-400ms   | [S1,MB1,BI] 400-15-416ms   | [S1,MB1,BW] 416-0-416ms    | [S6,MB5,F]  416-8-424ms    | [S6,MB4,BI] 464-11-475ms   | [S6,MB4,BW] 475-0-475ms    | [S1,MB2,BI] 482-14-496ms   | [S1,MB2,BW] 496-0-496ms    | [S6,MB6,F]  552-8-560ms    | [S6,MB5,BI] 560-10-570ms   | [S6,MB5,BW] 570-0-570ms    | [S1,MB3,BI] 576-14-590ms   | [S1,MB3,BW] 590-0-590ms    | [S6,MB7,F]  635-8-643ms    | [S6,MB6,BI] 643-10-653ms   | [S6,MB6,BW] 654-0-654ms    | [S1,MB4,BI] 660-14-674ms   | [S6,MB7,BI] 711-10-722ms   | [S1,MB5,BI] 722-14-736ms   | [S1,MB4,BW] 736-0-736ms    | [S1,MB6,BI] 749-13-763ms   | [S1,MB5,BW] 763-0-763ms    | [S1,MB7,BI] 774-13-788ms   | [S1,MB6,BW] 787-0-787ms    | [S6,MB7,BW] 787-0-787ms    | [S1,MB7,BW] 787-0-787ms   
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  39-8-47ms      | [S2,MB2,F]  58-8-66ms      | [S5,MB0,F]  66-9-75ms      | [S2,MB3,F]  77-10-87ms     | [S5,MB1,F]  87-8-96ms      | [S2,MB4,F]  101-11-112ms   | [S5,MB2,F]  120-9-129ms    | [S5,MB0,BI] 189-9-198ms    | [S5,MB0,BW] 198-0-198ms    | [S5,MB3,F]  198-9-208ms    | [S5,MB1,BI] 251-9-261ms    | [S5,MB1,BW] 261-0-261ms    | [S2,MB5,F]  261-9-270ms    | [S2,MB0,BI] 270-11-281ms   | [S2,MB0,BW] 281-0-281ms    | [S5,MB4,F]  281-8-290ms    | [S5,MB2,BI] 317-10-327ms   | [S5,MB2,BW] 327-0-327ms    | [S2,MB6,F]  331-10-342ms   | [S2,MB1,BI] 343-10-354ms   | [S2,MB1,BW] 353-0-353ms    | [S5,MB5,F]  353-8-362ms    | [S5,MB3,BI] 390-10-401ms   | [S5,MB3,BW] 400-0-400ms    | [S2,MB7,F]  401-10-412ms   | [S2,MB2,BI] 412-10-423ms   | [S2,MB2,BW] 423-0-423ms    | [S5,MB6,F]  423-8-431ms    | [S5,MB4,BI] 475-10-486ms   | [S5,MB4,BW] 486-0-486ms    | [S2,MB3,BI] 554-9-564ms    | [S2,MB3,BW] 564-0-564ms    | [S5,MB7,F]  576-8-584ms    | [S5,MB5,BI] 584-9-593ms    | [S5,MB5,BW] 593-0-593ms    | [S2,MB4,BI] 638-9-648ms    | [S5,MB6,BI] 653-10-664ms   | [S2,MB5,BI] 664-10-674ms   | [S5,MB7,BI] 722-9-732ms    | [S2,MB6,BI] 731-11-742ms   | [S2,MB4,BW] 743-0-743ms    | [S2,MB7,BI] 758-9-767ms    | [S2,MB5,BW] 767-0-767ms    | [S5,MB6,BW] 767-0-767ms    | [S5,MB7,BW] 767-0-767ms    | [S2,MB6,BW] 767-0-767ms    | [S2,MB7,BW] 767-0-767ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-7-36ms      | [S4,MB0,F]  36-8-44ms      | [S3,MB1,F]  47-9-57ms      | [S4,MB1,F]  57-8-65ms      | [S3,MB2,F]  67-8-75ms      | [S4,MB2,F]  75-8-84ms      | [S3,MB3,F]  103-8-111ms    | [S4,MB3,F]  111-8-120ms    | [S4,MB0,BI] 199-9-208ms    | [S4,MB0,BW] 208-0-208ms    | [S3,MB4,F]  208-8-216ms    | [S3,MB0,BI] 216-9-225ms    | [S3,MB0,BW] 225-0-225ms    | [S4,MB4,F]  225-8-233ms    | [S4,MB1,BI] 261-10-272ms   | [S4,MB1,BW] 272-0-272ms    | [S3,MB5,F]  272-9-281ms    | [S3,MB1,BI] 281-9-290ms    | [S3,MB1,BW] 290-0-290ms    | [S4,MB5,F]  290-8-299ms    | [S4,MB2,BI] 336-11-347ms   | [S4,MB2,BW] 347-0-347ms    | [S3,MB6,F]  347-8-356ms    | [S3,MB2,BI] 356-9-365ms    | [S3,MB2,BW] 365-0-365ms    | [S4,MB6,F]  365-8-373ms    | [S4,MB3,BI] 405-11-417ms   | [S4,MB3,BW] 417-0-417ms    | [S3,MB7,F]  417-8-426ms    | [S3,MB3,BI] 426-9-435ms    | [S3,MB3,BW] 435-0-435ms    | [S4,MB7,F]  435-8-443ms    | [S4,MB4,BI] 548-10-558ms   | [S4,MB4,BW] 558-0-558ms    | [S3,MB4,BI] 558-9-568ms    | [S4,MB5,BI] 632-10-642ms   | [S3,MB5,BI] 642-9-651ms    | [S4,MB6,BI] 664-9-674ms    | [S3,MB6,BI] 673-9-683ms    | [S4,MB7,BI] 733-9-742ms    | [S3,MB7,BI] 742-9-751ms    | [S3,MB4,BW] 751-0-751ms    | [S4,MB5,BW] 751-0-751ms    | [S4,MB6,BW] 751-0-751ms    | [S4,MB7,BW] 751-0-751ms    | [S3,MB5,BW] 751-0-751ms    | [S3,MB6,BW] 751-0-751ms    | [S3,MB7,BW] 751-0-751ms   
[rank3]:2025-12-25 11:54:50,799 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_apf_42_dm1/frozen_ratio_history/rank3/251225_1154_stage3_step400.svg
[rank3]:2025-12-25 11:54:50,842 - âœ… Frozen Ratio History of Rank 3 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_apf_42_dm1/frozen_ratio_history/rank3/251225_1154_stage4_step400.svg
[rank0]:2025-12-25 11:55:09,274 - Dataset alpaca_gpt4 is being re-looped
[rank3]:2025-12-25 11:55:09,665 - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-12-25 11:55:09,694 - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-12-25 11:55:09,678 - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-12-25 11:55:20,462 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 1.0000e-02
[rank3]:2025-12-25 11:55:20,450 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 1.0000e-02
[rank1]:2025-12-25 11:55:20,479 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 1.0000e-02
[rank0]:2025-12-25 11:55:20,508 - Freezing Ratio: [Stage0] 0.05, [Stage7] 0.00, Threshold: 1.0000e-02
[rank1]:2025-12-25 11:56:06,609 - Freezing Ratio: [Stage1] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank2]:2025-12-25 11:56:06,601 - Freezing Ratio: [Stage2] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-25 11:56:06,601 - Freezing Ratio: [Stage3] 0.78, [Stage4] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-25 11:56:06,656 - Freezing Ratio: [Stage0] 0.84, [Stage7] 0.64, Threshold: 1.0000e-02
[rank2]:2025-12-25 11:56:39,559 - Freezing Ratio: [Stage2] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-25 11:56:39,546 - Freezing Ratio: [Stage3] 0.78, [Stage4] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-25 11:56:39,575 - Freezing Ratio: [Stage1] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-25 11:56:39,604 - Freezing Ratio: [Stage0] 0.79, [Stage7] 0.64, Threshold: 1.0000e-02
[rank1]:2025-12-25 11:57:12,794 - Freezing Ratio: [Stage1] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank2]:2025-12-25 11:57:12,777 - Freezing Ratio: [Stage2] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-25 11:57:12,764 - Freezing Ratio: [Stage3] 0.78, [Stage4] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-25 11:57:12,825 - Freezing Ratio: [Stage0] 0.84, [Stage7] 0.64, Threshold: 1.0000e-02
[rank0]:2025-12-25 11:57:45,447 - [GC] Peforming periodical GC collection 0.02 seconds
[rank2]:2025-12-25 11:57:45,840 - Freezing Ratio: [Stage2] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-25 11:57:45,839 - Freezing Ratio: [Stage3] 0.78, [Stage4] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-25 11:57:45,858 - Freezing Ratio: [Stage1] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-25 11:57:45,881 - Freezing Ratio: [Stage0] 0.84, [Stage7] 0.64, Threshold: 1.0000e-02
[rank2]:2025-12-25 11:57:49,142 - Avg. fwd time: 8.8498 / Avg. bwd-weight time: 3.1052 / Avg. bwd-input time: 10.0719 / Avg. batch time: 846.2843 (ms) / GPU bubble ratio: 58.36%
[rank3]:2025-12-25 11:57:49,130 - Avg. fwd time: 8.2611 / Avg. bwd-weight time: 3.0528 / Avg. bwd-input time: 9.6936 / Avg. batch time: 828.2928 (ms) / GPU bubble ratio: 59.42%
[rank1]:2025-12-25 11:57:49,159 - Avg. fwd time: 10.6520 / Avg. bwd-weight time: 4.0065 / Avg. bwd-input time: 12.2912 / Avg. batch time: 879.6600 (ms) / GPU bubble ratio: 50.98%
[rank1]:2025-12-25 11:57:49,191 -  step: 450  loss: -4.0000  grad_norm:  0.0000  memory: 18.98GiB(39.95%)  tps: 9,167  tflops: 71.66  mfu: 22.97%
[rank0]:2025-12-25 11:57:49,168 - Avg. fwd time: 13.5801 / Avg. full-bwd time: 16.5092 (Avg. bwd-weight time: 9.3241 / Avg. bwd-input time: 34.3986) / Avg. batch time: 903.5830 (ms) / GPU bubble ratio: 22.63%
[rank0]:2025-12-25 11:57:49,191 -  step: 450  loss:  4.8844  grad_norm:  1.9240  memory: 40.23GiB(84.68%)  tps: 9,167  tflops: 71.66  mfu: 22.97%
[rank2]:2025-12-25 11:57:49,191 -  step: 450  loss: -4.0000  grad_norm:  0.0000  memory: 14.70GiB(30.94%)  tps: 9,167  tflops: 71.66  mfu: 22.97%
[rank3]:2025-12-25 11:57:49,191 -  step: 450  loss: -4.0000  grad_norm:  0.0000  memory: 16.18GiB(34.07%)  tps: 9,167  tflops: 71.66  mfu: 22.97%
[rank2]:2025-12-25 11:58:18,782 - Freezing Ratio: [Stage2] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-25 11:58:18,769 - Freezing Ratio: [Stage3] 0.78, [Stage4] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-25 11:58:18,799 - Freezing Ratio: [Stage1] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-25 11:58:18,828 - Freezing Ratio: [Stage0] 0.84, [Stage7] 0.64, Threshold: 1.0000e-02
[rank1]:2025-12-25 11:58:51,691 - Freezing Ratio: [Stage1] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-25 11:58:51,720 - Freezing Ratio: [Stage0] 0.84, [Stage7] 0.64, Threshold: 1.0000e-02
[rank3]:2025-12-25 11:58:51,661 - Freezing Ratio: [Stage3] 0.78, [Stage4] 0.78, Threshold: 1.0000e-02
[rank2]:2025-12-25 11:58:51,674 - Freezing Ratio: [Stage2] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank2]:2025-12-25 11:59:24,673 - Freezing Ratio: [Stage2] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-25 11:59:24,661 - Freezing Ratio: [Stage3] 0.78, [Stage4] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-25 11:59:24,691 - Freezing Ratio: [Stage1] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-25 11:59:24,720 - Freezing Ratio: [Stage0] 0.84, [Stage7] 0.64, Threshold: 1.0000e-02
[rank3]:2025-12-25 11:59:57,701 - Freezing Ratio: [Stage3] 0.78, [Stage4] 0.78, Threshold: 1.0000e-02
[rank2]:2025-12-25 11:59:57,714 - Freezing Ratio: [Stage2] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-25 11:59:57,731 - Freezing Ratio: [Stage1] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-25 11:59:57,760 - Freezing Ratio: [Stage0] 0.79, [Stage7] 0.64, Threshold: 1.0000e-02
[rank0]:2025-12-25 12:00:30,458 - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-12-25 12:00:30,805 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 1.0000e-02
[rank3]:2025-12-25 12:00:30,792 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 1.0000e-02
[rank1]:2025-12-25 12:00:30,822 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 1.0000e-02
[rank0]:2025-12-25 12:00:30,851 - Freezing Ratio: [Stage0] 0.05, [Stage7] 0.00, Threshold: 1.0000e-02
[rank2]:2025-12-25 12:00:35,355 - Avg. fwd time: 8.8788 / Avg. bwd-weight time: 2.8151 / Avg. bwd-input time: 10.0736 / Avg. batch time: 836.8714 (ms) / GPU bubble ratio: 58.38%
[rank3]:2025-12-25 12:00:35,364 - Avg. fwd time: 8.2792 / Avg. bwd-weight time: 2.7677 / Avg. bwd-input time: 9.6951 / Avg. batch time: 818.3498 (ms) / GPU bubble ratio: 59.45%
[rank1]:2025-12-25 12:00:35,376 - Avg. fwd time: 10.6831 / Avg. bwd-weight time: 3.6321 / Avg. bwd-input time: 12.2924 / Avg. batch time: 870.1577 (ms) / GPU bubble ratio: 51.08%
[rank0]:2025-12-25 12:00:35,384 - Avg. fwd time: 13.5699 / Avg. full-bwd time: 15.8860 (Avg. bwd-weight time: 8.4513 / Avg. bwd-input time: 34.3727) / Avg. batch time: 894.0440 (ms) / GPU bubble ratio: 23.18%
[rank2]:2025-12-25 12:00:35,430 -  step: 500  loss: -4.0000  grad_norm: 53.7519  memory: 14.70GiB(30.94%)  tps: 9,856  tflops: 77.05  mfu: 24.69%
[rank3]:2025-12-25 12:00:35,430 -  step: 500  loss: -4.0000  grad_norm: 53.7519  memory: 16.18GiB(34.07%)  tps: 9,856  tflops: 77.05  mfu: 24.69%
[rank1]:2025-12-25 12:00:35,433 -  step: 500  loss: -4.0000  grad_norm: 53.7519  memory: 18.98GiB(39.95%)  tps: 9,856  tflops: 77.05  mfu: 24.69%
[rank0]:2025-12-25 12:00:35,456 -  step: 500  loss:  4.8551  grad_norm: 53.7519  memory: 40.23GiB(84.68%)  tps: 9,854  tflops: 77.04  mfu: 24.69%
[rank2]:2025-12-25 12:00:35,522 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_apf_42_dm1/frozen_ratio_history/rank2/251225_1200_stage2_step500.svg
[rank2]:2025-12-25 12:00:35,562 - âœ… Frozen Ratio History of Rank 2 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_apf_42_dm1/frozen_ratio_history/rank2/251225_1200_stage5_step500.svg
[rank1]:2025-12-25 12:00:35,526 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_apf_42_dm1/frozen_ratio_history/rank1/251225_1200_stage1_step500.svg
[rank1]:2025-12-25 12:00:35,572 - âœ… Frozen Ratio History of Rank 1 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_apf_42_dm1/frozen_ratio_history/rank1/251225_1200_stage6_step500.svg
[rank0]:2025-12-25 12:00:35,505 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_apf_42_dm1/frozen_ratio_history/rank0/251225_1200_stage0_step500.svg
[rank0]:2025-12-25 12:00:35,548 - âœ… Frozen Ratio History of Rank 0 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_apf_42_dm1/frozen_ratio_history/rank0/251225_1200_stage7_step500.svg
[rank3]:2025-12-25 12:00:35,763 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_apf_42_dm1/pipeline_schedule/251225_1200_step500_rank3.svg
[rank3]:			> Batch Time: 805.99 ms, GPU Bubble Ratio: 28.46%, 53.82%, 61.80%, 64.00%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-9-18ms       | [S0,MB2,F]  18-8-26ms      | [S0,MB3,F]  26-9-35ms      | [S0,MB4,F]  35-8-44ms      | [S0,MB5,F]  44-10-54ms     | [S0,MB6,F]  54-9-63ms      | [S7,MB0,F]  118-17-135ms   | [S7,MB0,BI] 147-32-179ms   | [S7,MB0,BW] 179-0-179ms    | [S7,MB1,F]  180-16-196ms   | [S7,MB1,BI] 208-33-242ms   | [S7,MB1,BW] 242-0-242ms    | [S7,MB2,F]  242-18-260ms   | [S7,MB2,BI] 272-34-306ms   | [S7,MB2,BW] 306-0-306ms    | [S7,MB3,F]  306-18-324ms   | [S7,MB3,BI] 337-35-372ms   | [S7,MB3,BW] 372-0-372ms    | [S0,MB7,F]  372-10-383ms   | [S0,MB0,B]  384-13-397ms   | [S7,MB4,F]  398-19-417ms   | [S7,MB4,BI] 429-34-464ms   | [S7,MB4,BW] 465-0-465ms    | [S0,MB1,B]  472-12-485ms   | [S7,MB5,F]  483-17-500ms   | [S7,MB5,BI] 512-34-547ms   | [S7,MB5,BW] 547-0-547ms    | [S0,MB2,B]  554-12-566ms   | [S7,MB6,F]  569-16-585ms   | [S7,MB6,BI] 597-33-631ms   | [S7,MB6,BW] 631-0-631ms    | [S0,MB3,B]  638-10-648ms   | [S7,MB7,F]  653-15-668ms   | [S7,MB7,BI] 680-33-713ms   | [S7,MB7,BW] 713-0-713ms    | [S0,MB4,B]  720-10-730ms   | [S0,MB5,B]  746-9-756ms    | [S0,MB6,B]  772-9-781ms    | [S0,MB7,B]  796-9-805ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  27-12-39ms     | [S1,MB2,F]  46-12-58ms     | [S1,MB3,F]  64-12-76ms     | [S1,MB4,F]  88-12-100ms    | [S6,MB0,F]  100-10-111ms   | [S1,MB5,F]  110-14-125ms   | [S6,MB1,F]  125-9-134ms    | [S6,MB0,BI] 179-9-188ms    | [S6,MB0,BW] 188-0-188ms    | [S6,MB2,F]  189-9-198ms    | [S6,MB1,BI] 242-9-251ms    | [S6,MB1,BW] 251-0-251ms    | [S6,MB3,F]  251-9-260ms    | [S6,MB2,BI] 306-9-315ms    | [S6,MB2,BW] 315-0-315ms    | [S1,MB6,F]  315-13-329ms   | [S1,MB0,BI] 329-15-344ms   | [S1,MB0,BW] 344-0-344ms    | [S6,MB4,F]  345-8-353ms    | [S6,MB3,BI] 372-10-383ms   | [S6,MB3,BW] 383-0-383ms    | [S1,MB7,F]  384-15-399ms   | [S1,MB1,BI] 399-15-415ms   | [S1,MB1,BW] 415-0-415ms    | [S6,MB5,F]  415-8-423ms    | [S6,MB4,BI] 465-11-476ms   | [S6,MB4,BW] 476-0-476ms    | [S1,MB2,BI] 483-13-497ms   | [S1,MB2,BW] 497-0-497ms    | [S6,MB6,F]  553-8-561ms    | [S6,MB5,BI] 561-10-571ms   | [S6,MB5,BW] 571-0-571ms    | [S1,MB3,BI] 578-14-592ms   | [S1,MB3,BW] 592-0-592ms    | [S6,MB7,F]  637-8-645ms    | [S6,MB6,BI] 645-10-655ms   | [S6,MB6,BW] 655-0-655ms    | [S1,MB4,BI] 662-14-676ms   | [S6,MB7,BI] 713-10-723ms   | [S1,MB5,BI] 723-14-738ms   | [S1,MB4,BW] 738-0-738ms    | [S1,MB6,BI] 751-13-765ms   | [S1,MB5,BW] 765-0-765ms    | [S1,MB7,BI] 775-13-789ms   | [S1,MB6,BW] 789-0-789ms    | [S6,MB7,BW] 789-0-789ms    | [S1,MB7,BW] 789-0-789ms   
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  39-8-47ms      | [S2,MB2,F]  58-8-66ms      | [S5,MB0,F]  66-9-75ms      | [S2,MB3,F]  77-10-87ms     | [S5,MB1,F]  87-8-95ms      | [S2,MB4,F]  101-11-112ms   | [S5,MB2,F]  120-9-129ms    | [S5,MB0,BI] 189-9-198ms    | [S5,MB0,BW] 198-0-198ms    | [S5,MB3,F]  198-9-208ms    | [S5,MB1,BI] 251-9-260ms    | [S5,MB1,BW] 260-0-260ms    | [S2,MB5,F]  260-9-270ms    | [S2,MB0,BI] 270-11-281ms   | [S2,MB0,BW] 281-0-281ms    | [S5,MB4,F]  281-8-289ms    | [S5,MB2,BI] 315-10-326ms   | [S5,MB2,BW] 326-0-326ms    | [S2,MB6,F]  329-10-340ms   | [S2,MB1,BI] 341-10-352ms   | [S2,MB1,BW] 352-0-352ms    | [S5,MB5,F]  352-8-360ms    | [S5,MB3,BI] 389-10-400ms   | [S5,MB3,BW] 400-0-400ms    | [S2,MB7,F]  400-10-411ms   | [S2,MB2,BI] 412-10-422ms   | [S2,MB2,BW] 422-0-422ms    | [S5,MB6,F]  422-8-430ms    | [S5,MB4,BI] 476-10-486ms   | [S5,MB4,BW] 486-0-486ms    | [S2,MB3,BI] 556-9-566ms    | [S2,MB3,BW] 566-0-566ms    | [S5,MB7,F]  578-8-586ms    | [S5,MB5,BI] 586-9-595ms    | [S5,MB5,BW] 595-0-595ms    | [S2,MB4,BI] 640-9-649ms    | [S5,MB6,BI] 655-10-665ms   | [S2,MB5,BI] 666-10-676ms   | [S5,MB7,BI] 724-9-733ms    | [S2,MB6,BI] 733-11-744ms   | [S2,MB4,BW] 744-0-744ms    | [S2,MB7,BI] 759-9-769ms    | [S2,MB5,BW] 769-0-769ms    | [S5,MB6,BW] 769-0-769ms    | [S5,MB7,BW] 769-0-769ms    | [S2,MB6,BW] 769-0-769ms    | [S2,MB7,BW] 769-0-769ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-7-36ms      | [S4,MB0,F]  36-8-44ms      | [S3,MB1,F]  47-9-57ms      | [S4,MB1,F]  56-8-65ms      | [S3,MB2,F]  66-8-75ms      | [S4,MB2,F]  75-8-83ms      | [S3,MB3,F]  103-8-111ms    | [S4,MB3,F]  111-8-120ms    | [S4,MB0,BI] 198-9-207ms    | [S4,MB0,BW] 207-0-207ms    | [S3,MB4,F]  208-8-216ms    | [S3,MB0,BI] 216-9-225ms    | [S3,MB0,BW] 225-0-225ms    | [S4,MB4,F]  225-8-233ms    | [S4,MB1,BI] 260-10-271ms   | [S4,MB1,BW] 271-0-271ms    | [S3,MB5,F]  271-9-281ms    | [S3,MB1,BI] 281-9-290ms    | [S3,MB1,BW] 290-0-290ms    | [S4,MB5,F]  290-8-298ms    | [S4,MB2,BI] 334-11-345ms   | [S4,MB2,BW] 346-0-346ms    | [S3,MB6,F]  346-8-354ms    | [S3,MB2,BI] 354-9-363ms    | [S3,MB2,BW] 364-0-364ms    | [S4,MB6,F]  364-8-372ms    | [S4,MB3,BI] 405-11-416ms   | [S4,MB3,BW] 416-0-416ms    | [S3,MB7,F]  416-8-424ms    | [S3,MB3,BI] 425-9-434ms    | [S3,MB3,BW] 434-0-434ms    | [S4,MB7,F]  434-8-442ms    | [S4,MB4,BI] 550-10-560ms   | [S4,MB4,BW] 560-0-560ms    | [S3,MB4,BI] 560-9-570ms    | [S4,MB5,BI] 633-10-643ms   | [S3,MB5,BI] 643-9-652ms    | [S4,MB6,BI] 666-9-675ms    | [S3,MB6,BI] 675-9-685ms    | [S4,MB7,BI] 735-9-744ms    | [S3,MB7,BI] 744-9-753ms    | [S3,MB4,BW] 753-0-753ms    | [S4,MB5,BW] 753-0-753ms    | [S4,MB6,BW] 753-0-753ms    | [S4,MB7,BW] 753-0-753ms    | [S3,MB5,BW] 753-0-753ms    | [S3,MB6,BW] 753-0-753ms    | [S3,MB7,BW] 753-0-753ms   
[rank3]:2025-12-25 12:00:35,802 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_apf_42_dm1/frozen_ratio_history/rank3/251225_1200_stage3_step500.svg
[rank3]:2025-12-25 12:00:35,840 - âœ… Frozen Ratio History of Rank 3 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_apf_42_dm1/frozen_ratio_history/rank3/251225_1200_stage4_step500.svg
[rank2]:2025-12-25 12:01:17,439 - Freezing Ratio: [Stage2] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-25 12:01:17,440 - Freezing Ratio: [Stage3] 0.78, [Stage4] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-25 12:01:17,447 - Freezing Ratio: [Stage1] 0.81, [Stage6] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-25 12:01:17,494 - Freezing Ratio: [Stage0] 0.84, [Stage7] 0.64, Threshold: 1.0000e-02
[rank3]:2025-12-25 12:01:50,547 - Freezing Ratio: [Stage3] 0.78, [Stage4] 0.78, Threshold: 1.0000e-02
[rank2]:2025-12-25 12:01:50,559 - Freezing Ratio: [Stage2] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-25 12:01:50,576 - Freezing Ratio: [Stage1] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-25 12:01:50,605 - Freezing Ratio: [Stage0] 0.84, [Stage7] 0.64, Threshold: 1.0000e-02
[rank3]:2025-12-25 12:02:23,699 - Freezing Ratio: [Stage3] 0.78, [Stage4] 0.78, Threshold: 1.0000e-02
[rank2]:2025-12-25 12:02:23,712 - Freezing Ratio: [Stage2] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-25 12:02:23,729 - Freezing Ratio: [Stage1] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-25 12:02:23,757 - Freezing Ratio: [Stage0] 0.84, [Stage7] 0.64, Threshold: 1.0000e-02
[rank3]:2025-12-25 12:02:56,680 - Freezing Ratio: [Stage3] 0.78, [Stage4] 0.78, Threshold: 1.0000e-02
[rank2]:2025-12-25 12:02:56,692 - Freezing Ratio: [Stage2] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-25 12:02:56,710 - Freezing Ratio: [Stage1] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-25 12:02:56,738 - Freezing Ratio: [Stage0] 0.84, [Stage7] 0.64, Threshold: 1.0000e-02
[rank0]:2025-12-25 12:03:29,321 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-25 12:03:29,713 - Freezing Ratio: [Stage3] 0.78, [Stage4] 0.78, Threshold: 1.0000e-02
[rank2]:2025-12-25 12:03:29,714 - Freezing Ratio: [Stage2] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-25 12:03:29,732 - Freezing Ratio: [Stage1] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-25 12:03:29,756 - Freezing Ratio: [Stage0] 0.84, [Stage7] 0.64, Threshold: 1.0000e-02
[rank3]:2025-12-25 12:03:33,016 - Avg. fwd time: 8.2847 / Avg. bwd-weight time: 2.6780 / Avg. bwd-input time: 9.6972 / Avg. batch time: 815.2230 (ms) / GPU bubble ratio: 59.45%
[rank3]:2025-12-25 12:03:33,078 -  step: 550  loss: -4.0000  grad_norm:  0.0000  memory: 16.18GiB(34.07%)  tps: 9,223  tflops: 72.10  mfu: 23.11%
[rank2]:2025-12-25 12:03:33,028 - Avg. fwd time: 8.8871 / Avg. bwd-weight time: 2.7243 / Avg. bwd-input time: 10.0758 / Avg. batch time: 834.0009 (ms) / GPU bubble ratio: 58.39%
[rank2]:2025-12-25 12:03:33,078 -  step: 550  loss: -4.0000  grad_norm:  0.0000  memory: 14.70GiB(30.94%)  tps: 9,223  tflops: 72.10  mfu: 23.11%
[rank1]:2025-12-25 12:03:33,045 - Avg. fwd time: 10.6920 / Avg. bwd-weight time: 3.5149 / Avg. bwd-input time: 12.2960 / Avg. batch time: 867.2609 (ms) / GPU bubble ratio: 51.11%
[rank1]:2025-12-25 12:03:33,077 -  step: 550  loss: -4.0000  grad_norm:  0.0000  memory: 18.98GiB(39.95%)  tps: 9,223  tflops: 72.10  mfu: 23.11%
[rank0]:2025-12-25 12:03:33,055 - Avg. fwd time: 13.5730 / Avg. full-bwd time: 15.6345 (Avg. bwd-weight time: 8.1768 / Avg. bwd-input time: 34.3664) / Avg. batch time: 891.0828 (ms) / GPU bubble ratio: 23.40%
[rank0]:2025-12-25 12:03:33,078 -  step: 550  loss:  3.5919  grad_norm:  1.6748  memory: 40.23GiB(84.68%)  tps: 9,224  tflops: 72.11  mfu: 23.11%
[rank3]:2025-12-25 12:04:02,764 - Freezing Ratio: [Stage3] 0.78, [Stage4] 0.78, Threshold: 1.0000e-02
[rank2]:2025-12-25 12:04:02,777 - Freezing Ratio: [Stage2] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-25 12:04:02,794 - Freezing Ratio: [Stage1] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-25 12:04:02,823 - Freezing Ratio: [Stage0] 0.79, [Stage7] 0.64, Threshold: 1.0000e-02
[rank3]:2025-12-25 12:04:36,022 - Freezing Ratio: [Stage3] 0.78, [Stage4] 0.78, Threshold: 1.0000e-02
[rank2]:2025-12-25 12:04:36,034 - Freezing Ratio: [Stage2] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-25 12:04:36,051 - Freezing Ratio: [Stage1] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-25 12:04:36,082 - Freezing Ratio: [Stage0] 0.84, [Stage7] 0.64, Threshold: 1.0000e-02
[rank3]:2025-12-25 12:05:09,076 - Freezing Ratio: [Stage3] 0.78, [Stage4] 0.78, Threshold: 1.0000e-02
[rank2]:2025-12-25 12:05:09,089 - Freezing Ratio: [Stage2] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-25 12:05:09,106 - Freezing Ratio: [Stage1] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-25 12:05:09,135 - Freezing Ratio: [Stage0] 0.84, [Stage7] 0.64, Threshold: 1.0000e-02
[rank3]:2025-12-25 12:05:42,136 - Freezing Ratio: [Stage3] 0.78, [Stage4] 0.78, Threshold: 1.0000e-02
[rank2]:2025-12-25 12:05:42,149 - Freezing Ratio: [Stage2] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-25 12:05:42,166 - Freezing Ratio: [Stage1] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-25 12:05:42,195 - Freezing Ratio: [Stage0] 0.84, [Stage7] 0.64, Threshold: 1.0000e-02
[rank0]:2025-12-25 12:06:14,765 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-25 12:06:15,153 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 1.0000e-02
[rank2]:2025-12-25 12:06:15,165 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 1.0000e-02
[rank1]:2025-12-25 12:06:15,182 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 1.0000e-02
[rank0]:2025-12-25 12:06:15,210 - Freezing Ratio: [Stage0] 0.05, [Stage7] 0.00, Threshold: 1.0000e-02
[rank3]:2025-12-25 12:06:19,825 - Avg. fwd time: 8.2989 / Avg. bwd-weight time: 2.4716 / Avg. bwd-input time: 9.7002 / Avg. batch time: 808.2488 (ms) / GPU bubble ratio: 59.48%
[rank2]:2025-12-25 12:06:19,818 - Avg. fwd time: 8.9086 / Avg. bwd-weight time: 2.5145 / Avg. bwd-input time: 10.0783 / Avg. batch time: 827.4060 (ms) / GPU bubble ratio: 58.42%
[rank1]:2025-12-25 12:06:19,838 - Avg. fwd time: 10.7159 / Avg. bwd-weight time: 3.2441 / Avg. bwd-input time: 12.3003 / Avg. batch time: 860.6053 (ms) / GPU bubble ratio: 51.18%
[rank0]:2025-12-25 12:06:19,846 - Avg. fwd time: 13.5714 / Avg. full-bwd time: 15.1936 (Avg. bwd-weight time: 7.5468 / Avg. bwd-input time: 34.3583) / Avg. batch time: 884.4099 (ms) / GPU bubble ratio: 23.80%
[rank3]:2025-12-25 12:06:19,892 -  step: 600  loss: -4.0000  grad_norm: 57.5390  memory: 16.18GiB(34.07%)  tps: 9,822  tflops: 76.78  mfu: 24.61%
[rank2]:2025-12-25 12:06:19,892 -  step: 600  loss: -4.0000  grad_norm: 57.5390  memory: 14.70GiB(30.94%)  tps: 9,822  tflops: 76.78  mfu: 24.61%
[rank1]:2025-12-25 12:06:19,895 -  step: 600  loss: -4.0000  grad_norm: 57.5390  memory: 18.98GiB(39.95%)  tps: 9,822  tflops: 76.78  mfu: 24.61%
[rank0]:2025-12-25 12:06:19,925 -  step: 600  loss:  3.0042  grad_norm: 57.5390  memory: 40.23GiB(84.68%)  tps: 9,820  tflops: 76.77  mfu: 24.60%
[rank2]:2025-12-25 12:06:19,977 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_apf_42_dm1/frozen_ratio_history/rank2/251225_1206_stage2_step600.svg
[rank2]:2025-12-25 12:06:20,018 - âœ… Frozen Ratio History of Rank 2 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_apf_42_dm1/frozen_ratio_history/rank2/251225_1206_stage5_step600.svg
[rank1]:2025-12-25 12:06:19,982 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_apf_42_dm1/frozen_ratio_history/rank1/251225_1206_stage1_step600.svg
[rank1]:2025-12-25 12:06:20,028 - âœ… Frozen Ratio History of Rank 1 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_apf_42_dm1/frozen_ratio_history/rank1/251225_1206_stage6_step600.svg
[rank0]:2025-12-25 12:06:19,975 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_apf_42_dm1/frozen_ratio_history/rank0/251225_1206_stage0_step600.svg
[rank0]:2025-12-25 12:06:20,019 - âœ… Frozen Ratio History of Rank 0 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_apf_42_dm1/frozen_ratio_history/rank0/251225_1206_stage7_step600.svg
[rank3]:2025-12-25 12:06:20,229 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_apf_42_dm1/pipeline_schedule/251225_1206_step600_rank3.svg
[rank3]:			> Batch Time: 800.04 ms, GPU Bubble Ratio: 29.26%, 53.35%, 61.50%, 63.64%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-9-17ms       | [S0,MB2,F]  17-8-26ms      | [S0,MB3,F]  26-9-35ms      | [S0,MB4,F]  35-8-44ms      | [S0,MB5,F]  44-10-54ms     | [S0,MB6,F]  54-9-63ms      | [S7,MB0,F]  117-17-134ms   | [S7,MB0,BI] 146-32-179ms   | [S7,MB0,BW] 179-0-179ms    | [S7,MB1,F]  179-16-196ms   | [S7,MB1,BI] 208-33-242ms   | [S7,MB1,BW] 242-0-242ms    | [S7,MB2,F]  242-19-262ms   | [S7,MB2,BI] 273-34-308ms   | [S7,MB2,BW] 308-0-308ms    | [S7,MB3,F]  308-18-327ms   | [S7,MB3,BI] 339-35-374ms   | [S7,MB3,BW] 374-0-374ms    | [S0,MB7,F]  374-10-385ms   | [S0,MB0,B]  385-11-397ms   | [S7,MB4,F]  397-19-416ms   | [S7,MB4,BI] 428-34-463ms   | [S7,MB4,BW] 463-0-463ms    | [S0,MB1,B]  470-10-481ms   | [S7,MB5,F]  481-17-498ms   | [S7,MB5,BI] 510-34-544ms   | [S7,MB5,BW] 544-0-544ms    | [S0,MB2,B]  551-10-562ms   | [S7,MB6,F]  566-16-582ms   | [S7,MB6,BI] 594-33-628ms   | [S7,MB6,BW] 628-0-628ms    | [S0,MB3,B]  634-9-643ms    | [S7,MB7,F]  649-15-664ms   | [S7,MB7,BI] 676-33-709ms   | [S7,MB7,BW] 709-0-709ms    | [S0,MB4,B]  716-9-725ms    | [S0,MB5,B]  742-8-751ms    | [S0,MB6,B]  768-8-776ms    | [S0,MB7,B]  792-8-800ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  27-12-39ms     | [S1,MB2,F]  45-12-58ms     | [S1,MB3,F]  64-12-76ms     | [S1,MB4,F]  88-12-100ms    | [S6,MB0,F]  100-10-110ms   | [S1,MB5,F]  110-14-125ms   | [S6,MB1,F]  125-9-134ms    | [S6,MB0,BI] 179-9-188ms    | [S6,MB0,BW] 188-0-188ms    | [S6,MB2,F]  189-9-198ms    | [S6,MB1,BI] 242-9-251ms    | [S6,MB1,BW] 251-0-251ms    | [S6,MB3,F]  251-9-261ms    | [S6,MB2,BI] 308-9-317ms    | [S6,MB2,BW] 317-0-317ms    | [S1,MB6,F]  317-13-331ms   | [S1,MB0,BI] 331-15-346ms   | [S1,MB0,BW] 347-0-347ms    | [S6,MB4,F]  347-8-355ms    | [S6,MB3,BI] 374-10-385ms   | [S6,MB3,BW] 385-0-385ms    | [S1,MB7,F]  386-15-401ms   | [S1,MB1,BI] 401-15-416ms   | [S1,MB1,BW] 416-0-416ms    | [S6,MB5,F]  416-8-425ms    | [S6,MB4,BI] 463-11-474ms   | [S6,MB4,BW] 474-0-474ms    | [S1,MB2,BI] 481-14-495ms   | [S1,MB2,BW] 495-0-495ms    | [S6,MB6,F]  550-8-558ms    | [S6,MB5,BI] 559-10-569ms   | [S6,MB5,BW] 569-0-569ms    | [S1,MB3,BI] 575-14-589ms   | [S1,MB3,BW] 589-0-589ms    | [S6,MB7,F]  634-8-642ms    | [S6,MB6,BI] 642-10-652ms   | [S6,MB6,BW] 652-0-652ms    | [S1,MB4,BI] 659-14-673ms   | [S6,MB7,BI] 709-10-720ms   | [S1,MB5,BI] 720-14-734ms   | [S1,MB4,BW] 734-0-734ms    | [S1,MB6,BI] 747-13-760ms   | [S1,MB5,BW] 761-0-761ms    | [S1,MB7,BI] 771-13-785ms   | [S1,MB6,BW] 785-0-785ms    | [S6,MB7,BW] 785-0-785ms    | [S1,MB7,BW] 785-0-785ms   
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  39-8-47ms      | [S2,MB2,F]  58-8-66ms      | [S5,MB0,F]  66-9-75ms      | [S2,MB3,F]  77-10-87ms     | [S5,MB1,F]  87-8-95ms      | [S2,MB4,F]  100-10-111ms   | [S5,MB2,F]  120-9-129ms    | [S5,MB0,BI] 189-9-198ms    | [S5,MB0,BW] 198-0-198ms    | [S5,MB3,F]  198-9-207ms    | [S5,MB1,BI] 252-9-261ms    | [S5,MB1,BW] 261-0-261ms    | [S2,MB5,F]  261-9-271ms    | [S2,MB0,BI] 271-11-282ms   | [S2,MB0,BW] 282-0-282ms    | [S5,MB4,F]  282-8-290ms    | [S5,MB2,BI] 318-10-328ms   | [S5,MB2,BW] 328-0-328ms    | [S2,MB6,F]  331-10-342ms   | [S2,MB1,BI] 343-10-354ms   | [S2,MB1,BW] 354-0-354ms    | [S5,MB5,F]  354-8-362ms    | [S5,MB3,BI] 391-10-402ms   | [S5,MB3,BW] 401-0-401ms    | [S2,MB7,F]  402-10-412ms   | [S2,MB2,BI] 413-10-424ms   | [S2,MB2,BW] 424-0-424ms    | [S5,MB6,F]  424-8-432ms    | [S5,MB4,BI] 474-10-485ms   | [S5,MB4,BW] 485-0-485ms    | [S2,MB3,BI] 553-9-563ms    | [S2,MB3,BW] 563-0-563ms    | [S5,MB7,F]  575-8-583ms    | [S5,MB5,BI] 583-9-592ms    | [S5,MB5,BW] 592-0-592ms    | [S2,MB4,BI] 637-9-646ms    | [S5,MB6,BI] 652-10-662ms   | [S2,MB5,BI] 662-10-672ms   | [S5,MB7,BI] 720-9-729ms    | [S2,MB6,BI] 729-11-740ms   | [S2,MB4,BW] 740-0-740ms    | [S2,MB7,BI] 755-9-764ms    | [S2,MB5,BW] 765-0-765ms    | [S5,MB6,BW] 765-0-765ms    | [S5,MB7,BW] 765-0-765ms    | [S2,MB6,BW] 765-0-765ms    | [S2,MB7,BW] 765-0-765ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-7-36ms      | [S4,MB0,F]  36-8-44ms      | [S3,MB1,F]  47-9-56ms      | [S4,MB1,F]  56-8-65ms      | [S3,MB2,F]  66-8-75ms      | [S4,MB2,F]  75-8-83ms      | [S3,MB3,F]  102-8-111ms    | [S4,MB3,F]  111-8-120ms    | [S4,MB0,BI] 198-9-207ms    | [S4,MB0,BW] 207-0-207ms    | [S3,MB4,F]  207-7-215ms    | [S3,MB0,BI] 215-9-224ms    | [S3,MB0,BW] 224-0-224ms    | [S4,MB4,F]  224-8-233ms    | [S4,MB1,BI] 261-10-272ms   | [S4,MB1,BW] 272-0-272ms    | [S3,MB5,F]  272-9-281ms    | [S3,MB1,BI] 281-9-291ms    | [S3,MB1,BW] 291-0-291ms    | [S4,MB5,F]  291-8-299ms    | [S4,MB2,BI] 336-11-348ms   | [S4,MB2,BW] 348-0-348ms    | [S3,MB6,F]  348-8-357ms    | [S3,MB2,BI] 356-9-366ms    | [S3,MB2,BW] 366-0-366ms    | [S4,MB6,F]  366-8-374ms    | [S4,MB3,BI] 406-11-418ms   | [S4,MB3,BW] 418-0-418ms    | [S3,MB7,F]  418-8-426ms    | [S3,MB3,BI] 426-9-435ms    | [S3,MB3,BW] 435-0-435ms    | [S4,MB7,F]  435-8-444ms    | [S4,MB4,BI] 547-10-557ms   | [S4,MB4,BW] 557-0-557ms    | [S3,MB4,BI] 557-9-567ms    | [S4,MB5,BI] 630-10-640ms   | [S3,MB5,BI] 640-9-649ms    | [S4,MB6,BI] 663-9-672ms    | [S3,MB6,BI] 672-9-681ms    | [S4,MB7,BI] 731-9-740ms    | [S3,MB7,BI] 740-9-749ms    | [S3,MB4,BW] 749-0-749ms    | [S4,MB5,BW] 749-0-749ms    | [S4,MB6,BW] 749-0-749ms    | [S4,MB7,BW] 749-0-749ms    | [S3,MB5,BW] 749-0-749ms    | [S3,MB6,BW] 749-0-749ms    | [S3,MB7,BW] 749-0-749ms   
[rank3]:2025-12-25 12:06:20,271 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_apf_42_dm1/frozen_ratio_history/rank3/251225_1206_stage3_step600.svg
[rank3]:2025-12-25 12:06:20,311 - âœ… Frozen Ratio History of Rank 3 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_apf_42_dm1/frozen_ratio_history/rank3/251225_1206_stage4_step600.svg
[rank3]:2025-12-25 12:07:01,995 - Freezing Ratio: [Stage3] 0.78, [Stage4] 0.78, Threshold: 1.0000e-02
[rank2]:2025-12-25 12:07:01,995 - Freezing Ratio: [Stage2] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-25 12:07:02,003 - Freezing Ratio: [Stage1] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-25 12:07:02,050 - Freezing Ratio: [Stage0] 0.84, [Stage7] 0.64, Threshold: 1.0000e-02
[rank3]:2025-12-25 12:07:34,977 - Freezing Ratio: [Stage3] 0.78, [Stage4] 0.78, Threshold: 1.0000e-02
[rank2]:2025-12-25 12:07:34,990 - Freezing Ratio: [Stage2] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-25 12:07:35,007 - Freezing Ratio: [Stage1] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-25 12:07:35,035 - Freezing Ratio: [Stage0] 0.84, [Stage7] 0.64, Threshold: 1.0000e-02
[rank3]:2025-12-25 12:08:08,014 - Freezing Ratio: [Stage3] 0.78, [Stage4] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-25 12:08:08,043 - Freezing Ratio: [Stage1] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-25 12:08:08,072 - Freezing Ratio: [Stage0] 0.84, [Stage7] 0.64, Threshold: 1.0000e-02
[rank2]:2025-12-25 12:08:08,026 - Freezing Ratio: [Stage2] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-25 12:08:41,106 - Freezing Ratio: [Stage3] 0.78, [Stage4] 0.78, Threshold: 1.0000e-02
[rank2]:2025-12-25 12:08:41,119 - Freezing Ratio: [Stage2] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-25 12:08:41,165 - Freezing Ratio: [Stage0] 0.79, [Stage7] 0.64, Threshold: 1.0000e-02
[rank1]:2025-12-25 12:08:41,136 - Freezing Ratio: [Stage1] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-25 12:09:14,138 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-25 12:09:14,537 - Freezing Ratio: [Stage0] 0.84, [Stage7] 0.64, Threshold: 1.0000e-02
[rank3]:2025-12-25 12:09:14,493 - Freezing Ratio: [Stage3] 0.78, [Stage4] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-25 12:09:14,512 - Freezing Ratio: [Stage1] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank2]:2025-12-25 12:09:14,494 - Freezing Ratio: [Stage2] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-25 12:09:17,831 - Avg. fwd time: 13.5745 / Avg. full-bwd time: 15.0636 (Avg. bwd-weight time: 7.3862 / Avg. bwd-input time: 34.3540) / Avg. batch time: 882.7565 (ms) / GPU bubble ratio: 23.92%
[rank0]:2025-12-25 12:09:17,854 -  step: 650  loss:  3.7646  grad_norm:  2.7976  memory: 40.23GiB(84.68%)  tps: 9,208  tflops: 71.99  mfu: 23.07%
[rank3]:2025-12-25 12:09:17,793 - Avg. fwd time: 8.3022 / Avg. bwd-weight time: 2.4188 / Avg. bwd-input time: 9.7036 / Avg. batch time: 806.4638 (ms) / GPU bubble ratio: 59.48%
[rank3]:2025-12-25 12:09:17,853 -  step: 650  loss: -4.0000  grad_norm:  0.0000  memory: 16.18GiB(34.07%)  tps: 9,206  tflops: 71.97  mfu: 23.07%
[rank1]:2025-12-25 12:09:17,822 - Avg. fwd time: 10.7207 / Avg. bwd-weight time: 3.1747 / Avg. bwd-input time: 12.3028 / Avg. batch time: 858.9769 (ms) / GPU bubble ratio: 51.20%
[rank1]:2025-12-25 12:09:17,853 -  step: 650  loss: -4.0000  grad_norm:  0.0000  memory: 18.98GiB(39.95%)  tps: 9,207  tflops: 71.97  mfu: 23.07%
[rank2]:2025-12-25 12:09:17,804 - Avg. fwd time: 8.9139 / Avg. bwd-weight time: 2.4607 / Avg. bwd-input time: 10.0810 / Avg. batch time: 825.7895 (ms) / GPU bubble ratio: 58.43%
[rank2]:2025-12-25 12:09:17,853 -  step: 650  loss: -4.0000  grad_norm:  0.0000  memory: 14.70GiB(30.94%)  tps: 9,206  tflops: 71.97  mfu: 23.07%
[rank3]:2025-12-25 12:09:47,513 - Freezing Ratio: [Stage3] 0.78, [Stage4] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-25 12:09:47,571 - Freezing Ratio: [Stage0] 0.84, [Stage7] 0.64, Threshold: 1.0000e-02
[rank1]:2025-12-25 12:09:47,542 - Freezing Ratio: [Stage1] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank2]:2025-12-25 12:09:47,525 - Freezing Ratio: [Stage2] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank2]:2025-12-25 12:10:20,520 - Freezing Ratio: [Stage2] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-25 12:10:20,537 - Freezing Ratio: [Stage1] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-25 12:10:20,508 - Freezing Ratio: [Stage3] 0.78, [Stage4] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-25 12:10:20,566 - Freezing Ratio: [Stage0] 0.84, [Stage7] 0.64, Threshold: 1.0000e-02
[rank2]:2025-12-25 12:10:53,591 - Freezing Ratio: [Stage2] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-25 12:10:53,579 - Freezing Ratio: [Stage3] 0.78, [Stage4] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-25 12:10:53,608 - Freezing Ratio: [Stage1] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-25 12:10:53,638 - Freezing Ratio: [Stage0] 0.84, [Stage7] 0.64, Threshold: 1.0000e-02
[rank2]:2025-12-25 12:11:26,700 - Freezing Ratio: [Stage2] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-25 12:11:26,717 - Freezing Ratio: [Stage1] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-25 12:11:26,746 - Freezing Ratio: [Stage0] 0.84, [Stage7] 0.64, Threshold: 1.0000e-02
[rank3]:2025-12-25 12:11:26,688 - Freezing Ratio: [Stage3] 0.78, [Stage4] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-25 12:11:59,316 - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-12-25 12:11:59,711 - Freezing Ratio: [Stage2] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-25 12:11:59,728 - Freezing Ratio: [Stage1] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-25 12:11:59,699 - Freezing Ratio: [Stage3] 0.78, [Stage4] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-25 12:11:59,756 - Freezing Ratio: [Stage0] 0.84, [Stage7] 0.64, Threshold: 1.0000e-02
[rank2]:2025-12-25 12:12:03,017 - Avg. fwd time: 8.9310 / Avg. bwd-weight time: 2.2852 / Avg. bwd-input time: 10.0834 / Avg. batch time: 820.1934 (ms) / GPU bubble ratio: 58.45%
[rank2]:2025-12-25 12:12:03,066 -  step: 700  loss: -4.0000  grad_norm:  0.0000  memory: 14.70GiB(30.94%)  tps: 9,917  tflops: 77.53  mfu: 24.85%
[rank1]:2025-12-25 12:12:03,035 - Avg. fwd time: 10.7397 / Avg. bwd-weight time: 2.9482 / Avg. bwd-input time: 12.3059 / Avg. batch time: 853.3298 (ms) / GPU bubble ratio: 51.26%
[rank1]:2025-12-25 12:12:03,066 -  step: 700  loss: -4.0000  grad_norm:  0.0000  memory: 18.98GiB(39.95%)  tps: 9,917  tflops: 77.53  mfu: 24.85%
[rank3]:2025-12-25 12:12:03,005 - Avg. fwd time: 8.3132 / Avg. bwd-weight time: 2.2464 / Avg. bwd-input time: 9.7071 / Avg. batch time: 800.5570 (ms) / GPU bubble ratio: 59.49%
[rank3]:2025-12-25 12:12:03,066 -  step: 700  loss: -4.0000  grad_norm:  0.0000  memory: 16.18GiB(34.07%)  tps: 9,917  tflops: 77.53  mfu: 24.85%
[rank0]:2025-12-25 12:12:03,043 - Avg. fwd time: 13.5753 / Avg. full-bwd time: 14.6727 (Avg. bwd-weight time: 6.8587 / Avg. bwd-input time: 34.3425) / Avg. batch time: 877.0721 (ms) / GPU bubble ratio: 24.27%
[rank0]:2025-12-25 12:12:03,066 -  step: 700  loss:  3.9041  grad_norm:  2.1922  memory: 40.23GiB(84.68%)  tps: 9,917  tflops: 77.53  mfu: 24.85%
[rank2]:2025-12-25 12:12:03,120 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_apf_42_dm1/frozen_ratio_history/rank2/251225_1212_stage2_step700.svg
[rank2]:2025-12-25 12:12:03,163 - âœ… Frozen Ratio History of Rank 2 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_apf_42_dm1/frozen_ratio_history/rank2/251225_1212_stage5_step700.svg
[rank1]:2025-12-25 12:12:03,133 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_apf_42_dm1/frozen_ratio_history/rank1/251225_1212_stage1_step700.svg
[rank1]:2025-12-25 12:12:03,182 - âœ… Frozen Ratio History of Rank 1 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_apf_42_dm1/frozen_ratio_history/rank1/251225_1212_stage6_step700.svg
[rank0]:2025-12-25 12:12:03,119 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_apf_42_dm1/frozen_ratio_history/rank0/251225_1212_stage0_step700.svg
[rank0]:2025-12-25 12:12:03,164 - âœ… Frozen Ratio History of Rank 0 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_apf_42_dm1/frozen_ratio_history/rank0/251225_1212_stage7_step700.svg
[rank3]:2025-12-25 12:12:03,369 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_apf_42_dm1/pipeline_schedule/251225_1212_step700_rank3.svg
[rank3]:			> Batch Time: 800.01 ms, GPU Bubble Ratio: 29.19%, 53.38%, 61.50%, 63.63%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-9-17ms       | [S0,MB2,F]  17-8-26ms      | [S0,MB3,F]  26-9-35ms      | [S0,MB4,F]  35-8-44ms      | [S0,MB5,F]  44-10-54ms     | [S0,MB6,F]  54-9-63ms      | [S7,MB0,F]  117-17-134ms   | [S7,MB0,BI] 146-32-179ms   | [S7,MB0,BW] 179-0-179ms    | [S7,MB1,F]  179-17-196ms   | [S7,MB1,BI] 208-33-242ms   | [S7,MB1,BW] 242-0-242ms    | [S7,MB2,F]  242-19-262ms   | [S7,MB2,BI] 273-35-308ms   | [S7,MB2,BW] 308-0-308ms    | [S7,MB3,F]  308-18-327ms   | [S7,MB3,BI] 339-35-374ms   | [S7,MB3,BW] 374-0-374ms    | [S0,MB7,F]  374-11-385ms   | [S0,MB0,B]  385-11-397ms   | [S7,MB4,F]  397-19-416ms   | [S7,MB4,BI] 428-35-463ms   | [S7,MB4,BW] 463-0-463ms    | [S0,MB1,B]  470-10-480ms   | [S7,MB5,F]  480-17-498ms   | [S7,MB5,BI] 509-34-544ms   | [S7,MB5,BW] 544-0-544ms    | [S0,MB2,B]  551-10-561ms   | [S7,MB6,F]  566-16-582ms   | [S7,MB6,BI] 594-33-627ms   | [S7,MB6,BW] 627-0-627ms    | [S0,MB3,B]  634-9-643ms    | [S7,MB7,F]  649-15-664ms   | [S7,MB7,BI] 676-33-709ms   | [S7,MB7,BW] 710-0-710ms    | [S0,MB4,B]  716-9-725ms    | [S0,MB5,B]  743-8-751ms    | [S0,MB6,B]  768-8-776ms    | [S0,MB7,B]  792-8-800ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  27-12-39ms     | [S1,MB2,F]  45-12-58ms     | [S1,MB3,F]  64-12-76ms     | [S1,MB4,F]  88-12-100ms    | [S6,MB0,F]  100-10-110ms   | [S1,MB5,F]  110-14-125ms   | [S6,MB1,F]  125-9-134ms    | [S6,MB0,BI] 179-9-188ms    | [S6,MB0,BW] 188-0-188ms    | [S6,MB2,F]  188-9-197ms    | [S6,MB1,BI] 242-9-251ms    | [S6,MB1,BW] 251-0-251ms    | [S6,MB3,F]  251-9-260ms    | [S6,MB2,BI] 308-9-317ms    | [S6,MB2,BW] 317-0-317ms    | [S1,MB6,F]  317-13-331ms   | [S1,MB0,BI] 331-15-347ms   | [S1,MB0,BW] 347-0-347ms    | [S6,MB4,F]  347-8-355ms    | [S6,MB3,BI] 374-10-385ms   | [S6,MB3,BW] 385-0-385ms    | [S1,MB7,F]  386-15-401ms   | [S1,MB1,BI] 401-15-416ms   | [S1,MB1,BW] 416-0-416ms    | [S6,MB5,F]  416-8-425ms    | [S6,MB4,BI] 463-11-474ms   | [S6,MB4,BW] 474-0-474ms    | [S1,MB2,BI] 481-14-495ms   | [S1,MB2,BW] 495-0-495ms    | [S6,MB6,F]  550-8-558ms    | [S6,MB5,BI] 558-10-568ms   | [S6,MB5,BW] 568-0-568ms    | [S1,MB3,BI] 575-14-589ms   | [S1,MB3,BW] 589-0-589ms    | [S6,MB7,F]  633-8-641ms    | [S6,MB6,BI] 641-10-651ms   | [S6,MB6,BW] 651-0-651ms    | [S1,MB4,BI] 658-14-672ms   | [S6,MB7,BI] 709-10-720ms   | [S1,MB5,BI] 720-14-734ms   | [S1,MB4,BW] 735-0-735ms    | [S1,MB6,BI] 747-13-761ms   | [S1,MB5,BW] 761-0-761ms    | [S1,MB7,BI] 771-13-785ms   | [S1,MB6,BW] 785-0-785ms    | [S6,MB7,BW] 785-0-785ms    | [S1,MB7,BW] 785-0-785ms   
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  39-8-47ms      | [S2,MB2,F]  57-8-66ms      | [S5,MB0,F]  66-9-75ms      | [S2,MB3,F]  76-10-87ms     | [S5,MB1,F]  87-8-95ms      | [S2,MB4,F]  100-10-111ms   | [S5,MB2,F]  120-9-129ms    | [S5,MB0,BI] 188-9-198ms    | [S5,MB0,BW] 198-0-198ms    | [S5,MB3,F]  198-9-207ms    | [S5,MB1,BI] 251-9-260ms    | [S5,MB1,BW] 260-0-260ms    | [S2,MB5,F]  260-9-270ms    | [S2,MB0,BI] 270-11-281ms   | [S2,MB0,BW] 281-0-281ms    | [S5,MB4,F]  281-8-290ms    | [S5,MB2,BI] 318-10-328ms   | [S5,MB2,BW] 328-0-328ms    | [S2,MB6,F]  332-10-342ms   | [S2,MB1,BI] 343-10-354ms   | [S2,MB1,BW] 354-0-354ms    | [S5,MB5,F]  354-8-362ms    | [S5,MB3,BI] 391-10-401ms   | [S5,MB3,BW] 401-0-401ms    | [S2,MB7,F]  402-10-412ms   | [S2,MB2,BI] 413-10-424ms   | [S2,MB2,BW] 424-0-424ms    | [S5,MB6,F]  424-8-432ms    | [S5,MB4,BI] 474-10-485ms   | [S5,MB4,BW] 485-0-485ms    | [S2,MB3,BI] 553-9-563ms    | [S2,MB3,BW] 563-0-563ms    | [S5,MB7,F]  575-8-583ms    | [S5,MB5,BI] 583-9-592ms    | [S5,MB5,BW] 592-0-592ms    | [S2,MB4,BI] 636-9-645ms    | [S5,MB6,BI] 651-10-662ms   | [S2,MB5,BI] 662-10-672ms   | [S5,MB7,BI] 720-9-729ms    | [S2,MB6,BI] 730-11-741ms   | [S2,MB4,BW] 741-0-741ms    | [S2,MB7,BI] 756-9-765ms    | [S2,MB5,BW] 765-0-765ms    | [S5,MB6,BW] 765-0-765ms    | [S5,MB7,BW] 765-0-765ms    | [S2,MB6,BW] 765-0-765ms    | [S2,MB7,BW] 765-0-765ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-7-36ms      | [S4,MB0,F]  36-8-44ms      | [S3,MB1,F]  47-9-56ms      | [S4,MB1,F]  56-8-65ms      | [S3,MB2,F]  66-8-74ms      | [S4,MB2,F]  74-8-83ms      | [S3,MB3,F]  102-8-111ms    | [S4,MB3,F]  111-8-120ms    | [S4,MB0,BI] 198-9-207ms    | [S4,MB0,BW] 207-0-207ms    | [S3,MB4,F]  207-8-215ms    | [S3,MB0,BI] 215-9-224ms    | [S3,MB0,BW] 224-0-224ms    | [S4,MB4,F]  224-8-232ms    | [S4,MB1,BI] 261-10-271ms   | [S4,MB1,BW] 271-0-271ms    | [S3,MB5,F]  272-9-281ms    | [S3,MB1,BI] 281-9-290ms    | [S3,MB1,BW] 290-0-290ms    | [S4,MB5,F]  290-8-298ms    | [S4,MB2,BI] 336-11-348ms   | [S4,MB2,BW] 348-0-348ms    | [S3,MB6,F]  348-8-356ms    | [S3,MB2,BI] 356-9-365ms    | [S3,MB2,BW] 365-0-365ms    | [S4,MB6,F]  365-8-374ms    | [S4,MB3,BI] 406-11-417ms   | [S4,MB3,BW] 417-0-417ms    | [S3,MB7,F]  417-8-426ms    | [S3,MB3,BI] 426-9-435ms    | [S3,MB3,BW] 435-0-435ms    | [S4,MB7,F]  435-8-443ms    | [S4,MB4,BI] 547-10-557ms   | [S4,MB4,BW] 557-0-557ms    | [S3,MB4,BI] 557-9-566ms    | [S4,MB5,BI] 630-10-640ms   | [S3,MB5,BI] 640-9-649ms    | [S4,MB6,BI] 662-9-671ms    | [S3,MB6,BI] 672-9-681ms    | [S4,MB7,BI] 731-9-740ms    | [S3,MB7,BI] 740-9-749ms    | [S3,MB4,BW] 749-0-749ms    | [S4,MB5,BW] 749-0-749ms    | [S4,MB6,BW] 749-0-749ms    | [S4,MB7,BW] 749-0-749ms    | [S3,MB5,BW] 749-0-749ms    | [S3,MB6,BW] 749-0-749ms    | [S3,MB7,BW] 749-0-749ms   
[rank3]:2025-12-25 12:12:03,413 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_apf_42_dm1/frozen_ratio_history/rank3/251225_1212_stage3_step700.svg
[rank3]:2025-12-25 12:12:03,455 - âœ… Frozen Ratio History of Rank 3 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_apf_42_dm1/frozen_ratio_history/rank3/251225_1212_stage4_step700.svg
[rank2]:2025-12-25 12:12:33,060 - Freezing Ratio: [Stage2] 0.00, [Stage5] 0.00, Threshold: 1.0000e-02
[rank1]:2025-12-25 12:12:33,077 - Freezing Ratio: [Stage1] 0.00, [Stage6] 0.00, Threshold: 1.0000e-02
[rank0]:2025-12-25 12:12:33,106 - Freezing Ratio: [Stage0] 0.05, [Stage7] 0.00, Threshold: 1.0000e-02
[rank3]:2025-12-25 12:12:33,048 - Freezing Ratio: [Stage3] 0.00, [Stage4] 0.00, Threshold: 1.0000e-02
[rank2]:2025-12-25 12:13:19,422 - Freezing Ratio: [Stage2] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-25 12:13:19,430 - Freezing Ratio: [Stage1] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-25 12:13:19,477 - Freezing Ratio: [Stage0] 0.84, [Stage7] 0.64, Threshold: 1.0000e-02
[rank3]:2025-12-25 12:13:19,422 - Freezing Ratio: [Stage3] 0.78, [Stage4] 0.78, Threshold: 1.0000e-02
[rank2]:2025-12-25 12:13:52,613 - Freezing Ratio: [Stage2] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-25 12:13:52,631 - Freezing Ratio: [Stage1] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-25 12:13:52,601 - Freezing Ratio: [Stage3] 0.78, [Stage4] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-25 12:13:52,660 - Freezing Ratio: [Stage0] 0.79, [Stage7] 0.64, Threshold: 1.0000e-02
[rank1]:2025-12-25 12:14:25,863 - Freezing Ratio: [Stage1] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank2]:2025-12-25 12:14:25,846 - Freezing Ratio: [Stage2] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-25 12:14:25,833 - Freezing Ratio: [Stage3] 0.78, [Stage4] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-25 12:14:25,893 - Freezing Ratio: [Stage0] 0.84, [Stage7] 0.64, Threshold: 1.0000e-02
[rank0]:2025-12-25 12:14:58,429 - [GC] Peforming periodical GC collection 0.02 seconds
[rank3]:2025-12-25 12:14:58,820 - Freezing Ratio: [Stage3] 0.78, [Stage4] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-25 12:14:58,837 - Freezing Ratio: [Stage1] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank2]:2025-12-25 12:14:58,819 - Freezing Ratio: [Stage2] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-25 12:14:58,860 - Freezing Ratio: [Stage0] 0.84, [Stage7] 0.64, Threshold: 1.0000e-02
[rank3]:2025-12-25 12:15:02,132 - Avg. fwd time: 8.3136 / Avg. bwd-weight time: 2.2285 / Avg. bwd-input time: 9.7099 / Avg. batch time: 799.9224 (ms) / GPU bubble ratio: 59.49%
[rank1]:2025-12-25 12:15:02,160 - Avg. fwd time: 10.7409 / Avg. bwd-weight time: 2.9252 / Avg. bwd-input time: 12.3079 / Avg. batch time: 852.7812 (ms) / GPU bubble ratio: 51.27%
[rank1]:2025-12-25 12:15:02,192 -  step: 750  loss: -4.0000  grad_norm:  0.0000  memory: 18.98GiB(39.95%)  tps: 9,147  tflops: 71.50  mfu: 22.92%
[rank2]:2025-12-25 12:15:02,143 - Avg. fwd time: 8.9321 / Avg. bwd-weight time: 2.2674 / Avg. bwd-input time: 10.0859 / Avg. batch time: 819.6471 (ms) / GPU bubble ratio: 58.45%
[rank2]:2025-12-25 12:15:02,192 -  step: 750  loss: -4.0000  grad_norm:  0.0000  memory: 14.70GiB(30.94%)  tps: 9,147  tflops: 71.50  mfu: 22.92%
[rank3]:2025-12-25 12:15:02,192 -  step: 750  loss: -4.0000  grad_norm:  0.0000  memory: 16.18GiB(34.07%)  tps: 9,147  tflops: 71.50  mfu: 22.92%
[rank0]:2025-12-25 12:15:02,169 - Avg. fwd time: 13.5761 / Avg. full-bwd time: 14.6199 (Avg. bwd-weight time: 6.8044 / Avg. bwd-input time: 34.3390) / Avg. batch time: 876.5049 (ms) / GPU bubble ratio: 24.32%
[rank0]:2025-12-25 12:15:02,192 -  step: 750  loss:  3.2774  grad_norm:  0.5178  memory: 40.23GiB(84.68%)  tps: 9,147  tflops: 71.50  mfu: 22.92%
[rank1]:2025-12-25 12:15:31,940 - Freezing Ratio: [Stage1] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank2]:2025-12-25 12:15:31,922 - Freezing Ratio: [Stage2] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-25 12:15:31,911 - Freezing Ratio: [Stage3] 0.78, [Stage4] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-25 12:15:31,969 - Freezing Ratio: [Stage0] 0.84, [Stage7] 0.64, Threshold: 1.0000e-02
[rank3]:2025-12-25 12:16:05,020 - Freezing Ratio: [Stage3] 0.78, [Stage4] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-25 12:16:05,049 - Freezing Ratio: [Stage1] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank2]:2025-12-25 12:16:05,032 - Freezing Ratio: [Stage2] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-25 12:16:05,078 - Freezing Ratio: [Stage0] 0.84, [Stage7] 0.64, Threshold: 1.0000e-02
[rank3]:2025-12-25 12:16:38,045 - Freezing Ratio: [Stage3] 0.78, [Stage4] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-25 12:16:38,074 - Freezing Ratio: [Stage1] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank2]:2025-12-25 12:16:38,057 - Freezing Ratio: [Stage2] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-25 12:16:38,103 - Freezing Ratio: [Stage0] 0.84, [Stage7] 0.64, Threshold: 1.0000e-02
[rank1]:2025-12-25 12:17:11,072 - Freezing Ratio: [Stage1] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank2]:2025-12-25 12:17:11,055 - Freezing Ratio: [Stage2] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-25 12:17:11,042 - Freezing Ratio: [Stage3] 0.78, [Stage4] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-25 12:17:11,101 - Freezing Ratio: [Stage0] 0.84, [Stage7] 0.64, Threshold: 1.0000e-02
[rank0]:2025-12-25 12:17:43,712 - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-12-25 12:17:44,130 - Freezing Ratio: [Stage1] 0.78, [Stage6] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-25 12:17:44,100 - Freezing Ratio: [Stage3] 0.78, [Stage4] 0.78, Threshold: 1.0000e-02
[rank2]:2025-12-25 12:17:44,113 - Freezing Ratio: [Stage2] 0.78, [Stage5] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-25 12:17:44,157 - Freezing Ratio: [Stage0] 0.84, [Stage7] 0.64, Threshold: 1.0000e-02
[rank1]:2025-12-25 12:17:47,524 - Avg. fwd time: 10.7572 / Avg. bwd-weight time: 2.7426 / Avg. bwd-input time: 12.3112 / Avg. batch time: 848.2770 (ms) / GPU bubble ratio: 51.32%
[rank3]:2025-12-25 12:17:47,494 - Avg. fwd time: 8.3228 / Avg. bwd-weight time: 2.0895 / Avg. bwd-input time: 9.7128 / Avg. batch time: 795.2084 (ms) / GPU bubble ratio: 59.51%
[rank2]:2025-12-25 12:17:47,506 - Avg. fwd time: 8.9457 / Avg. bwd-weight time: 2.1259 / Avg. bwd-input time: 10.0889 / Avg. batch time: 815.1824 (ms) / GPU bubble ratio: 58.47%
[rank0]:2025-12-25 12:17:47,533 - Avg. fwd time: 13.5779 / Avg. full-bwd time: 14.3089 (Avg. bwd-weight time: 6.3793 / Avg. bwd-input time: 34.3315) / Avg. batch time: 871.9754 (ms) / GPU bubble ratio: 24.61%
[rank0]:2025-12-25 12:17:47,556 -  step: 800  loss:  2.8495  grad_norm:  3.0423  memory: 40.23GiB(84.68%)  tps: 9,908  tflops: 77.46  mfu: 24.83%
[rank0]:2025-12-25 12:17:47,557 - â„¹ï¸ final step: 800  loss:  2.8495  grad_norm:  3.0423  tps: 9,669  tflops: 75.58  mfu: 22.19%
[rank0]:2025-12-25 12:17:47,557 - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-12-25 12:17:47,558 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank1]:2025-12-25 12:17:47,555 -  step: 800  loss: -4.0000  grad_norm:  0.0000  memory: 18.98GiB(39.95%)  tps: 9,908  tflops: 77.46  mfu: 24.83%
[rank1]:2025-12-25 12:17:47,556 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  0.0000  tps: 9,661  tflops: 75.52  mfu: 22.08%
[rank1]:2025-12-25 12:17:47,556 - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-12-25 12:17:47,556 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank3]:2025-12-25 12:17:47,555 -  step: 800  loss: -4.0000  grad_norm:  0.0000  memory: 16.18GiB(34.07%)  tps: 9,908  tflops: 77.46  mfu: 24.83%
[rank3]:2025-12-25 12:17:47,556 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  0.0000  tps: 9,660  tflops: 75.52  mfu: 22.07%
[rank3]:2025-12-25 12:17:47,556 - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-12-25 12:17:47,556 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank2]:2025-12-25 12:17:47,555 -  step: 800  loss: -4.0000  grad_norm:  0.0000  memory: 14.70GiB(30.94%)  tps: 9,908  tflops: 77.46  mfu: 24.83%
[rank2]:2025-12-25 12:17:47,556 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  0.0000  tps: 9,660  tflops: 75.51  mfu: 22.06%
[rank2]:2025-12-25 12:17:47,556 - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-12-25 12:17:47,556 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-25 12:17:49,928 - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank1]:2025-12-25 12:17:50,010 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_apf_42_dm1/frozen_ratio_history/rank1/251225_1217_stage1_final800.svg
[rank2]:2025-12-25 12:17:50,004 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_apf_42_dm1/frozen_ratio_history/rank2/251225_1217_stage2_final800.svg
[rank2]:2025-12-25 12:17:50,047 - âœ… Frozen Ratio History of Rank 2 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_apf_42_dm1/frozen_ratio_history/rank2/251225_1217_stage5_final800.svg
[rank0]:2025-12-25 12:17:50,002 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_apf_42_dm1/frozen_ratio_history/rank0/251225_1217_stage0_final800.svg
[rank0]:2025-12-25 12:17:50,050 - âœ… Frozen Ratio History of Rank 0 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_apf_42_dm1/frozen_ratio_history/rank0/251225_1217_stage7_final800.svg
[rank1]:2025-12-25 12:17:50,059 - âœ… Frozen Ratio History of Rank 1 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_apf_42_dm1/frozen_ratio_history/rank1/251225_1217_stage6_final800.svg
[rank2]:2025-12-25 12:17:50,148 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_apf_42_dm1/frozen_params_histogram/251225_1217_rank2_stage2.svg
[rank2]:	> Counts Sum: 897, Total Sum: 1350 (66.44%), Ratio(%) per element: [85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 0.0, 0.0, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 1.33, 0.0]
[rank0]:2025-12-25 12:17:50,154 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_apf_42_dm1/frozen_params_histogram/251225_1217_rank0_stage0.svg
[rank0]:	> Counts Sum: 1004, Total Sum: 1425 (70.46%), Ratio(%) per element: [85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 57.33, 0.0, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 1.33, 0.0]
[rank0]:2025-12-25 12:17:50,165 - Destroying the purge thread.
[rank1]:2025-12-25 12:17:50,188 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_apf_42_dm1/frozen_params_histogram/251225_1217_rank1_stage1.svg
[rank1]:	> Counts Sum: 1349, Total Sum: 2025 (66.62%), Ratio(%) per element: [85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 5.33, 1.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 0.0, 0.0, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 0.0, 0.0]
[rank1]:2025-12-25 12:17:50,199 - Destroying the purge thread.
[rank1]:[rank1]: Traceback (most recent call last):
[rank1]:[rank1]:   File "<frozen runpy>", line 198, in _run_module_as_main
[rank1]:[rank1]:   File "<frozen runpy>", line 88, in _run_code
[rank1]:[rank1]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 789, in <module>
[rank1]:[rank1]:     trainer.train()
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
[rank1]:[rank1]:     return f(*args, **kwargs)
[rank1]:[rank1]:            ^^^^^^^^^^^^^^^^^^
[rank1]:[rank1]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 621, in train
[rank1]:[rank1]:     draw_charts(self.freezer, self.step, job_config)
[rank1]:[rank1]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 712, in draw_charts
[rank1]:[rank1]:     draw_elementwise_histogram(data=list(freezer.paramwise_frozen_count[s].values()), stage=s,
[rank1]:[rank1]:   File "/home/shcho/torchtitan/timelyfreeze/core/util.py", line 335, in draw_elementwise_histogram
[rank1]:[rank1]:     ax1.text(max(min(80, past_ratio - 5), 5), 0, total_count_text, ha="center", va="center", fontsize=fontsize, color="black")
[rank1]:[rank1]:                      ^^
[rank1]:[rank1]: UnboundLocalError: cannot access local variable 'past_ratio' where it is not associated with a value
[rank2]:2025-12-25 12:17:50,158 - Destroying the purge thread.
[rank2]:[rank2]: Traceback (most recent call last):
[rank2]:[rank2]:   File "<frozen runpy>", line 198, in _run_module_as_main
[rank2]:[rank2]:   File "<frozen runpy>", line 88, in _run_code
[rank2]:[rank2]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 789, in <module>
[rank2]:[rank2]:     trainer.train()
[rank2]:[rank2]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
[rank2]:[rank2]:     return f(*args, **kwargs)
[rank2]:[rank2]:            ^^^^^^^^^^^^^^^^^^
[rank2]:[rank2]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 621, in train
[rank2]:[rank2]:     draw_charts(self.freezer, self.step, job_config)
[rank2]:[rank2]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 712, in draw_charts
[rank2]:[rank2]:     draw_elementwise_histogram(data=list(freezer.paramwise_frozen_count[s].values()), stage=s,
[rank2]:[rank2]:   File "/home/shcho/torchtitan/timelyfreeze/core/util.py", line 335, in draw_elementwise_histogram
[rank2]:[rank2]:     ax1.text(max(min(80, past_ratio - 5), 5), 0, total_count_text, ha="center", va="center", fontsize=fontsize, color="black")
[rank2]:[rank2]:                      ^^
[rank2]:[rank2]: UnboundLocalError: cannot access local variable 'past_ratio' where it is not associated with a value
[rank0]:wandb: updating run metadata
[rank3]:2025-12-25 12:17:50,248 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_apf_42_dm1/pipeline_schedule/251225_1217_final800_rank3.svg
[rank3]:			> Batch Time: 809.45 ms, GPU Bubble Ratio: 28.73%, 53.95%, 62.02%, 64.13%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-9-18ms       | [S0,MB2,F]  17-8-26ms      | [S0,MB3,F]  26-9-35ms      | [S0,MB4,F]  35-8-44ms      | [S0,MB5,F]  44-10-54ms     | [S0,MB6,F]  54-9-63ms      | [S7,MB0,F]  117-17-134ms   | [S7,MB0,BI] 146-32-179ms   | [S7,MB0,BW] 179-0-179ms    | [S7,MB1,F]  180-16-197ms   | [S7,MB1,BI] 209-33-243ms   | [S7,MB1,BW] 243-0-243ms    | [S7,MB2,F]  243-18-262ms   | [S7,MB2,BI] 274-35-309ms   | [S7,MB2,BW] 309-0-309ms    | [S7,MB3,F]  309-18-328ms   | [S7,MB3,BI] 340-35-376ms   | [S7,MB3,BW] 376-0-376ms    | [S0,MB7,F]  376-10-386ms   | [S0,MB0,B]  387-13-400ms   | [S7,MB4,F]  400-19-419ms   | [S7,MB4,BI] 432-34-467ms   | [S7,MB4,BW] 467-0-467ms    | [S0,MB1,B]  474-11-485ms   | [S7,MB5,F]  485-17-503ms   | [S7,MB5,BI] 515-34-549ms   | [S7,MB5,BW] 550-0-550ms    | [S0,MB2,B]  556-11-567ms   | [S7,MB6,F]  571-16-588ms   | [S7,MB6,BI] 600-33-633ms   | [S7,MB6,BW] 634-0-634ms    | [S0,MB3,B]  640-10-651ms   | [S7,MB7,F]  655-16-671ms   | [S7,MB7,BI] 683-33-717ms   | [S7,MB7,BW] 717-0-717ms    | [S0,MB4,B]  724-10-734ms   | [S0,MB5,B]  750-9-759ms    | [S0,MB6,B]  775-9-785ms    | [S0,MB7,B]  800-9-809ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  27-12-39ms     | [S1,MB2,F]  45-12-58ms     | [S1,MB3,F]  64-12-76ms     | [S1,MB4,F]  88-12-100ms    | [S6,MB0,F]  100-10-110ms   | [S1,MB5,F]  110-14-125ms   | [S6,MB1,F]  125-9-134ms    | [S6,MB0,BI] 179-9-188ms    | [S6,MB0,BW] 188-0-188ms    | [S6,MB2,F]  189-9-198ms    | [S6,MB1,BI] 243-9-252ms    | [S6,MB1,BW] 252-0-252ms    | [S6,MB3,F]  252-9-261ms    | [S6,MB2,BI] 309-9-318ms    | [S6,MB2,BW] 318-0-318ms    | [S1,MB6,F]  318-13-332ms   | [S1,MB0,BI] 332-15-348ms   | [S1,MB0,BW] 348-0-348ms    | [S6,MB4,F]  348-8-356ms    | [S6,MB3,BI] 375-10-386ms   | [S6,MB3,BW] 386-0-386ms    | [S1,MB7,F]  387-15-403ms   | [S1,MB1,BI] 403-15-418ms   | [S1,MB1,BW] 418-0-418ms    | [S6,MB5,F]  418-8-427ms    | [S6,MB4,BI] 467-11-478ms   | [S6,MB4,BW] 478-0-478ms    | [S1,MB2,BI] 485-14-499ms   | [S1,MB2,BW] 499-0-499ms    | [S6,MB6,F]  556-8-564ms    | [S6,MB5,BI] 564-10-574ms   | [S6,MB5,BW] 574-0-574ms    | [S1,MB3,BI] 580-14-594ms   | [S1,MB3,BW] 594-0-594ms    | [S6,MB7,F]  639-8-647ms    | [S6,MB6,BI] 648-10-658ms   | [S6,MB6,BW] 658-0-658ms    | [S1,MB4,BI] 665-14-679ms   | [S6,MB7,BI] 716-10-727ms   | [S1,MB5,BI] 727-14-741ms   | [S1,MB4,BW] 742-0-742ms    | [S1,MB6,BI] 754-14-768ms   | [S1,MB5,BW] 768-0-768ms    | [S1,MB7,BI] 779-13-793ms   | [S1,MB6,BW] 793-0-793ms    | [S6,MB7,BW] 793-0-793ms    | [S1,MB7,BW] 793-0-793ms   
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-28ms      | [S2,MB1,F]  39-8-47ms      | [S2,MB2,F]  58-8-66ms      | [S5,MB0,F]  66-9-75ms      | [S2,MB3,F]  77-10-87ms     | [S5,MB1,F]  87-8-95ms      | [S2,MB4,F]  100-10-111ms   | [S5,MB2,F]  120-9-129ms    | [S5,MB0,BI] 188-9-198ms    | [S5,MB0,BW] 198-0-198ms    | [S5,MB3,F]  199-9-208ms    | [S5,MB1,BI] 252-9-262ms    | [S5,MB1,BW] 261-0-261ms    | [S2,MB5,F]  261-9-271ms    | [S2,MB0,BI] 271-11-283ms   | [S2,MB0,BW] 282-0-282ms    | [S5,MB4,F]  282-8-291ms    | [S5,MB2,BI] 318-10-329ms   | [S5,MB2,BW] 329-0-329ms    | [S2,MB6,F]  332-10-343ms   | [S2,MB1,BI] 344-10-355ms   | [S2,MB1,BW] 355-0-355ms    | [S5,MB5,F]  355-8-363ms    | [S5,MB3,BI] 392-10-403ms   | [S5,MB3,BW] 403-0-403ms    | [S2,MB7,F]  403-10-414ms   | [S2,MB2,BI] 415-10-425ms   | [S2,MB2,BW] 425-0-425ms    | [S5,MB6,F]  426-8-434ms    | [S5,MB4,BI] 478-10-489ms   | [S5,MB4,BW] 489-0-489ms    | [S2,MB3,BI] 558-9-568ms    | [S2,MB3,BW] 568-0-568ms    | [S5,MB7,F]  580-8-588ms    | [S5,MB5,BI] 588-9-597ms    | [S5,MB5,BW] 597-0-597ms    | [S2,MB4,BI] 642-9-652ms    | [S5,MB6,BI] 658-10-668ms   | [S2,MB5,BI] 668-10-678ms   | [S5,MB7,BI] 727-9-737ms    | [S2,MB6,BI] 737-11-748ms   | [S2,MB4,BW] 748-0-748ms    | [S2,MB7,BI] 763-9-772ms    | [S2,MB5,BW] 772-0-772ms    | [S5,MB6,BW] 772-0-772ms    | [S5,MB7,BW] 772-0-772ms    | [S2,MB6,BW] 772-0-772ms    | [S2,MB7,BW] 772-0-772ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-7-36ms      | [S4,MB0,F]  36-8-44ms      | [S3,MB1,F]  47-9-57ms      | [S4,MB1,F]  57-8-65ms      | [S3,MB2,F]  66-8-75ms      | [S4,MB2,F]  75-8-83ms      | [S3,MB3,F]  102-8-111ms    | [S4,MB3,F]  111-8-120ms    | [S4,MB0,BI] 198-9-207ms    | [S4,MB0,BW] 207-0-207ms    | [S3,MB4,F]  208-7-216ms    | [S3,MB0,BI] 216-9-225ms    | [S3,MB0,BW] 225-0-225ms    | [S4,MB4,F]  225-8-233ms    | [S4,MB1,BI] 262-10-272ms   | [S4,MB1,BW] 273-0-273ms    | [S3,MB5,F]  273-9-282ms    | [S3,MB1,BI] 282-9-291ms    | [S3,MB1,BW] 291-0-291ms    | [S4,MB5,F]  291-8-300ms    | [S4,MB2,BI] 337-11-348ms   | [S4,MB2,BW] 349-0-349ms    | [S3,MB6,F]  349-8-357ms    | [S3,MB2,BI] 357-9-366ms    | [S3,MB2,BW] 366-0-366ms    | [S4,MB6,F]  366-8-375ms    | [S4,MB3,BI] 408-11-419ms   | [S4,MB3,BW] 419-0-419ms    | [S3,MB7,F]  420-8-428ms    | [S3,MB3,BI] 428-9-437ms    | [S3,MB3,BW] 437-0-437ms    | [S4,MB7,F]  437-8-446ms    | [S4,MB4,BI] 552-10-562ms   | [S4,MB4,BW] 562-0-562ms    | [S3,MB4,BI] 562-9-572ms    | [S4,MB5,BI] 636-10-646ms   | [S3,MB5,BI] 646-9-655ms    | [S4,MB6,BI] 668-9-678ms    | [S3,MB6,BI] 678-9-687ms    | [S4,MB7,BI] 738-9-748ms    | [S3,MB7,BI] 747-9-757ms    | [S3,MB4,BW] 756-0-756ms    | [S4,MB5,BW] 756-0-756ms    | [S4,MB6,BW] 756-0-756ms    | [S4,MB7,BW] 756-0-756ms    | [S3,MB5,BW] 756-0-756ms    | [S3,MB6,BW] 756-0-756ms    | [S3,MB7,BW] 756-0-756ms   
[rank3]:2025-12-25 12:17:50,249 - Destroying the purge thread.
[rank3]:[rank3]: Traceback (most recent call last):
[rank3]:[rank3]:   File "<frozen runpy>", line 198, in _run_module_as_main
[rank3]:[rank3]:   File "<frozen runpy>", line 88, in _run_code
[rank3]:[rank3]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 789, in <module>
[rank3]:[rank3]:     trainer.train()
[rank3]:[rank3]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
[rank3]:[rank3]:     return f(*args, **kwargs)
[rank3]:[rank3]:            ^^^^^^^^^^^^^^^^^^
[rank3]:[rank3]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 621, in train
[rank3]:[rank3]:     draw_charts(self.freezer, self.step, job_config)
[rank3]:[rank3]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 688, in draw_charts
[rank3]:[rank3]:     pipeline_schedule = schedule_pipeline(pipeline_schedule, 
[rank3]:[rank3]:                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:[rank3]:   File "/home/shcho/torchtitan/timelyfreeze/core/schedule.py", line 414, in schedule_pipeline
[rank3]:[rank3]:     assert fwd_time is None or len(fwd_time) == num_stages, f"fwd_time should have the same length as num_stages. fwd_time: {len(fwd_time)}, num_stages: {num_stages}"
[rank3]:[rank3]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:[rank3]: AssertionError: fwd_time should have the same length as num_stages. fwd_time: 4, num_stages: 8
[rank0]:wandb: uploading history steps 15-16, summary, console lines 157-167
[rank0]:wandb: 
[rank0]:wandb: Run history:
[rank0]:wandb:      final/avg_end_to_end(s) â–
[rank0]:wandb:               final/avg_loss â–
[rank0]:wandb:             final/avg_mfu(%) â–
[rank0]:wandb:             final/avg_tflops â–
[rank0]:wandb:    final/avg_throughput(tps) â–
[rank0]:wandb:              final/grad_norm â–
[rank0]:wandb:               final/max_loss â–
[rank0]:wandb:                    grad_norm â–ˆâ–‚â–â–‚â–‚â–â–â–â–â–â–ƒâ–â–ƒâ–â–â–â–
[rank0]:wandb: loss_metrics/global_avg_loss â–ˆâ–‡â–‡â–„â–‚â–…â–„â–ƒâ–â–ƒâ–ƒâ–‚â–â–‚â–‚â–â–
[rank0]:wandb: loss_metrics/global_max_loss â–ˆâ–‡â–‡â–„â–‚â–…â–„â–ƒâ–â–ƒâ–ƒâ–‚â–â–‚â–‚â–â–
[rank0]:wandb:                          +14 ...
[rank0]:wandb: 
[rank0]:wandb: Run summary:
[rank0]:wandb:      final/avg_end_to_end(s) 3.38914
[rank0]:wandb:               final/avg_loss 2.84947
[rank0]:wandb:             final/avg_mfu(%) 22.18749
[rank0]:wandb:             final/avg_tflops 75.58422
[rank0]:wandb:    final/avg_throughput(tps) 9668.54311
[rank0]:wandb:              final/grad_norm 3.04233
[rank0]:wandb:               final/max_loss 2.84947
[rank0]:wandb:                    grad_norm 3.04233
[rank0]:wandb: loss_metrics/global_avg_loss 2.84947
[rank0]:wandb: loss_metrics/global_max_loss 2.84947
[rank0]:wandb:                          +14 ...
[rank0]:wandb: 
[rank0]:wandb: ðŸš€ View run 1224_ZBVZeroBubble_apf_42_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/zymaehu9
[rank0]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank0]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank0]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1224_ZBVZeroBubble_apf_42_dm1/20251225-1129/wandb/run-20251225_112945-zymaehu9/logs
[rank0]:Traceback (most recent call last):
[rank0]:  File "<frozen runpy>", line 198, in _run_module_as_main
[rank0]:  File "<frozen runpy>", line 88, in _run_code
[rank0]:  File "/home/shcho/torchtitan/timelyfreeze/train.py", line 789, in <module>
[rank0]:    trainer.train()
[rank0]:  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
[rank0]:    return f(*args, **kwargs)
[rank0]:           ^^^^^^^^^^^^^^^^^^
[rank0]:  File "/home/shcho/torchtitan/timelyfreeze/train.py", line 621, in train
[rank0]:    draw_charts(self.freezer, self.step, job_config)
[rank0]:  File "/home/shcho/torchtitan/timelyfreeze/train.py", line 712, in draw_charts
[rank0]:    draw_elementwise_histogram(data=list(freezer.paramwise_frozen_count[s].values()), stage=s,
[rank0]:  File "/home/shcho/torchtitan/timelyfreeze/core/util.py", line 335, in draw_elementwise_histogram
[rank0]:    ax1.text(max(min(80, past_ratio - 5), 5), 0, total_count_text, ha="center", va="center", fontsize=fontsize, color="black")
[rank0]:                     ^^
[rank0]:UnboundLocalError: cannot access local variable 'past_ratio' where it is not associated with a value
[rank0]:[rank0]: Traceback (most recent call last):
[rank0]:[rank0]:   File "<frozen runpy>", line 198, in _run_module_as_main
[rank0]:[rank0]:   File "<frozen runpy>", line 88, in _run_code
[rank0]:[rank0]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 789, in <module>
[rank0]:[rank0]:     trainer.train()
[rank0]:[rank0]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
[rank0]:[rank0]:     return f(*args, **kwargs)
[rank0]:[rank0]:            ^^^^^^^^^^^^^^^^^^
[rank0]:[rank0]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 621, in train
[rank0]:[rank0]:     draw_charts(self.freezer, self.step, job_config)
[rank0]:[rank0]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 712, in draw_charts
[rank0]:[rank0]:     draw_elementwise_histogram(data=list(freezer.paramwise_frozen_count[s].values()), stage=s,
[rank0]:[rank0]:   File "/home/shcho/torchtitan/timelyfreeze/core/util.py", line 335, in draw_elementwise_histogram
[rank0]:[rank0]:     ax1.text(max(min(80, past_ratio - 5), 5), 0, total_count_text, ha="center", va="center", fontsize=fontsize, color="black")
[rank0]:[rank0]:                      ^^
[rank0]:[rank0]: UnboundLocalError: cannot access local variable 'past_ratio' where it is not associated with a value
W1225 12:17:52.126000 1011557 site-packages/torch/distributed/elastic/multiprocessing/api.py:940] Sending process 1011568 closing signal SIGTERM
W1225 12:17:52.127000 1011557 site-packages/torch/distributed/elastic/multiprocessing/api.py:940] Sending process 1011569 closing signal SIGTERM
W1225 12:17:52.127000 1011557 site-packages/torch/distributed/elastic/multiprocessing/api.py:940] Sending process 1011571 closing signal SIGTERM
[rank0]:[rank0]:[W1225 12:17:52.563625882 ProcessGroupNCCL.cpp:1552] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
E1225 12:17:52.976000 1011557 site-packages/torch/distributed/elastic/multiprocessing/api.py:914] failed (exitcode: 1) local_rank: 2 (pid: 1011570) of binary: /data2/shcho/miniforge3/envs/llm_eval/bin/python3.11
E1225 12:17:52.997000 1011557 site-packages/torch/distributed/elastic/multiprocessing/errors/error_handler.py:141] no error file defined for parent, to copy child error file (/tmp/torchelastic_xtaee8e5/7286ad8c-f01e-4c46-838e-61246bbb8204_1kzcofma/attempt_0/2/error.json)
[rank2]:Stage 2: Modules to keep: {'layers.5', 'layers.6'}
[rank2]:Stage 5: Modules to keep: {'layers.12', 'layers.11'}
[rank3]:Stage 3: Modules to keep: {'layers.7', 'layers.8'}
[rank3]:Stage 4: Modules to keep: {'layers.9', 'layers.10'}
[rank1]:Stage 1: Modules to keep: {'layers.3', 'layers.2', 'layers.4'}
[rank1]:Stage 6: Modules to keep: {'layers.13', 'layers.14'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1224.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1224_ZBVZeroBubble_apf_42_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1224_ZBVZeroBubble_apf_42_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1224_ZBVZeroBubble_apf_42_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1224_ZBVZeroBubble_apf_42_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1224_ZBVZeroBubble_apf_42_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1224_ZBVZeroBubble_apf_42_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 42
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: ZBVZeroBubble
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 4
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 2
[rank3]:		- stages_list: [3, 4]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1224_ZBVZeroBubble_apf_42_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1224_ZBVZeroBubble_apf_42_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: apf
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.01
[rank3]:		- percentile: 80
[rank3]:
[rank0]:Stage 0: Modules to keep: {'layers.1', 'tok_embeddings', 'layers.0'}
[rank0]:Stage 7: Modules to keep: {'layers.15', 'output', 'norm'}
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
Traceback (most recent call last):
  File "/data2/shcho/miniforge3/envs/llm_eval/bin/torchrun", line 7, in <module>
    sys.exit(main())
             ^^^^^^
  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/run.py", line 946, in main
    run(args)
  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/run.py", line 937, in run
    elastic_launch(
  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 159, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 300, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
timelyfreeze.train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2025-12-25_12:17:50
  host      : elga.kaist.ac.kr
  rank      : 0 (local_rank: 0)
  exitcode  : -15 (pid: 1011568)
  error_file: /tmp/torchelastic_xtaee8e5/7286ad8c-f01e-4c46-838e-61246bbb8204_1kzcofma/attempt_0/0/error.json
  traceback : Traceback (most recent call last):
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
      return f(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^
    File "/home/shcho/torchtitan/timelyfreeze/train.py", line 621, in train
      draw_charts(self.freezer, self.step, job_config)
    File "/home/shcho/torchtitan/timelyfreeze/train.py", line 712, in draw_charts
      draw_elementwise_histogram(data=list(freezer.paramwise_frozen_count[s].values()), stage=s,
    File "/home/shcho/torchtitan/timelyfreeze/core/util.py", line 335, in draw_elementwise_histogram
      ax1.text(max(min(80, past_ratio - 5), 5), 0, total_count_text, ha="center", va="center", fontsize=fontsize, color="black")
                       ^^
  UnboundLocalError: cannot access local variable 'past_ratio' where it is not associated with a value
  
[2]:
  time      : 2025-12-25_12:17:50
  host      : elga.kaist.ac.kr
  rank      : 1 (local_rank: 1)
  exitcode  : 1 (pid: 1011569)
  error_file: /tmp/torchelastic_xtaee8e5/7286ad8c-f01e-4c46-838e-61246bbb8204_1kzcofma/attempt_0/1/error.json
  traceback : Traceback (most recent call last):
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
      return f(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^
    File "/home/shcho/torchtitan/timelyfreeze/train.py", line 621, in train
      draw_charts(self.freezer, self.step, job_config)
    File "/home/shcho/torchtitan/timelyfreeze/train.py", line 712, in draw_charts
      draw_elementwise_histogram(data=list(freezer.paramwise_frozen_count[s].values()), stage=s,
    File "/home/shcho/torchtitan/timelyfreeze/core/util.py", line 335, in draw_elementwise_histogram
      ax1.text(max(min(80, past_ratio - 5), 5), 0, total_count_text, ha="center", va="center", fontsize=fontsize, color="black")
                       ^^
  UnboundLocalError: cannot access local variable 'past_ratio' where it is not associated with a value
  
[3]:
  time      : 2025-12-25_12:17:50
  host      : elga.kaist.ac.kr
  rank      : 3 (local_rank: 3)
  exitcode  : 1 (pid: 1011571)
  error_file: /tmp/torchelastic_xtaee8e5/7286ad8c-f01e-4c46-838e-61246bbb8204_1kzcofma/attempt_0/3/error.json
  traceback : Traceback (most recent call last):
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
      return f(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^
    File "/home/shcho/torchtitan/timelyfreeze/train.py", line 621, in train
      draw_charts(self.freezer, self.step, job_config)
    File "/home/shcho/torchtitan/timelyfreeze/train.py", line 688, in draw_charts
      pipeline_schedule = schedule_pipeline(pipeline_schedule,
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    File "/home/shcho/torchtitan/timelyfreeze/core/schedule.py", line 414, in schedule_pipeline
      assert fwd_time is None or len(fwd_time) == num_stages, f"fwd_time should have the same length as num_stages. fwd_time: {len(fwd_time)}, num_stages: {num_stages}"
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  AssertionError: fwd_time should have the same length as num_stages. fwd_time: 4, num_stages: 8
  
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2025-12-25_12:17:50
  host      : elga.kaist.ac.kr
  rank      : 2 (local_rank: 2)
  exitcode  : 1 (pid: 1011570)
  error_file: /tmp/torchelastic_xtaee8e5/7286ad8c-f01e-4c46-838e-61246bbb8204_1kzcofma/attempt_0/2/error.json
  traceback : Traceback (most recent call last):
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
      return f(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^
    File "/home/shcho/torchtitan/timelyfreeze/train.py", line 621, in train
      draw_charts(self.freezer, self.step, job_config)
    File "/home/shcho/torchtitan/timelyfreeze/train.py", line 712, in draw_charts
      draw_elementwise_histogram(data=list(freezer.paramwise_frozen_count[s].values()), stage=s,
    File "/home/shcho/torchtitan/timelyfreeze/core/util.py", line 335, in draw_elementwise_histogram
      ax1.text(max(min(80, past_ratio - 5), 5), 0, total_count_text, ha="center", va="center", fontsize=fontsize, color="black")
                       ^^
  UnboundLocalError: cannot access local variable 'past_ratio' where it is not associated with a value
  
============================================================
