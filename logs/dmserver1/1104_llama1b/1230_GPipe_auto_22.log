
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 12. 30. (í™”) 18:46:01 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 3,4,5,6
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/1230_GPipe_auto_22.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
1227: everything same as 1224 but seed=42->11
1230: everything same as 1224 but seed=42->22

âœ”ï¸Running with auto x GPipe ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1230.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
1227: everything same as 1224 but seed=42->11
1230: everything same as 1224 but seed=42->22
" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=auto --freezing.threshold=0.01 --freezing.percentile=80 --freezing.max_freeze_ratio=0.8
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank1]:2025-12-30 18:46:07,386 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank1]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank1]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank1]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank1]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank1]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank1]:1227: everything same as 1224 but seed=42->11
[rank1]:1230: everything same as 1224 but seed=42->22
[rank1]:"
[rank0]:2025-12-30 18:46:07,376 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank0]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank0]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank0]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank0]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank0]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank0]:1227: everything same as 1224 but seed=42->11
[rank0]:1230: everything same as 1224 but seed=42->22
[rank0]:"
[rank3]:2025-12-30 18:46:07,463 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:1227: everything same as 1224 but seed=42->11
[rank3]:1230: everything same as 1224 but seed=42->22
[rank3]:"
[rank1]:2025-12-30 18:46:07,591 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-12-30 18:46:07,593 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-30 18:46:07,610 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-12-30 18:46:07,612 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-30 18:46:07,616 - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-12-30 18:46:07,617 - Loading tokenizer from tokenizer.json
[rank2]:2025-12-30 18:46:07,675 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank2]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank2]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank2]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank2]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank2]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank2]:1227: everything same as 1224 but seed=42->11
[rank2]:1230: everything same as 1224 but seed=42->22
[rank2]:"
[rank3]:2025-12-30 18:46:07,730 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-12-30 18:46:07,732 - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-12-30 18:46:07,842 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-12-30 18:46:07,845 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-30 18:46:08,006 - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank0]:2025-12-30 18:46:11,114 - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank0]:2025-12-30 18:46:11,259 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-12-30 18:46:11,300 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-30 18:46:11,301 - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-12-30 18:46:11,328 - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-12-30 18:46:11,329 - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2025-12-30 18:46:11,413 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-12-30 18:46:11,452 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-30 18:46:11,479 - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-12-30 18:46:11,479 - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-12-30 18:46:11,514 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-30 18:46:11,514 - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-12-30 18:46:11,514 - CUDA memory usage for model: 1.90GiB(3.99%)
[rank2]:2025-12-30 18:46:11,562 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-12-30 18:46:11,665 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-30 18:46:11,665 - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-12-30 18:46:11,666 - CUDA memory usage for model: 1.13GiB(2.39%)
[rank2]:2025-12-30 18:46:11,602 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-30 18:46:11,640 - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-12-30 18:46:11,641 - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank2]:2025-12-30 18:46:11,824 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-30 18:46:11,824 - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-12-30 18:46:11,825 - CUDA memory usage for model: 0.92GiB(1.94%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run h8ylriih
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1230_GPipe_auto_22_dm1/20251230-1846/wandb/run-20251230_184612-h8ylriih
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1230_GPipe_auto_22_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/h8ylriih
[rank3]:2025-12-30 18:46:13,304 - WandB logging enabled
[rank3]:2025-12-30 18:46:13,304 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-12-30 18:46:13,345 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-30 18:46:13,375 - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-12-30 18:46:13,376 - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank3]:2025-12-30 18:46:13,563 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-30 18:46:13,564 - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-12-30 18:46:13,564 - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2025-12-30 18:46:13,580 - Mixed precision training with TP or PP is handled by autocast
[rank1]:2025-12-30 18:46:13,580 - Mixed precision training with TP or PP is handled by autocast
[rank2]:2025-12-30 18:46:13,580 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-30 18:46:13,580 - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1230_GPipe_auto_22_dm1
[rank0]:2025-12-30 18:46:13,581 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-30 18:46:13,581 - Trainer is initialized with local batch size 16, global batch size 128, gradient accumulation steps 8, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2025-12-30 18:46:13,581 - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank0]:2025-12-30 18:46:16,054 - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-12-30 18:46:16,054 - Finished loading the checkpoint in 2.47 seconds.
[rank0]:2025-12-30 18:46:16,054 - Training starts at step 1
[rank2]:2025-12-30 18:46:21,589 -  step:  1  loss: -8.0000  grad_norm: 116.5369  memory: 10.24GiB(21.56%)  tps: 3,281  tflops: 25.65  mfu: 8.22%
[rank2]:2025-12-30 18:46:21,589 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-12-30 18:46:21,591 -  step:  1  loss: -8.0000  grad_norm: 116.5369  memory: 12.75GiB(26.83%)  tps: 3,232  tflops: 25.27  mfu: 8.10%
[rank1]:2025-12-30 18:46:21,591 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-12-30 18:46:21,599 -  step:  1  loss: 10.6088  grad_norm: 116.5369  memory: 24.19GiB(50.91%)  tps: 3,972  tflops: 31.05  mfu: 9.95%
[rank3]:2025-12-30 18:46:21,599 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-30 18:46:21,627 -  step:  1  loss: -8.0000  grad_norm: 116.5369  memory: 13.25GiB(27.89%)  tps: 3,173  tflops: 24.81  mfu: 7.95%
[rank0]:2025-12-30 18:46:21,627 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-12-30 18:48:21,016 - Avg. fwd time: 10.8362 / Avg. bwd time: 43.6017 / Avg. batch time: 495.3752 (ms) / GPU bubble ratio: 12.09%
[rank2]:2025-12-30 18:48:21,041 - Avg. fwd time: 6.9940 / Avg. bwd time: 19.2988 / Avg. batch time: 527.5266 (ms) / GPU bubble ratio: 60.13%
[rank1]:2025-12-30 18:48:21,071 - Avg. fwd time: 9.0780 / Avg. bwd time: 24.9801 / Avg. batch time: 568.0336 (ms) / GPU bubble ratio: 52.03%
[rank0]:2025-12-30 18:48:21,101 - Avg. fwd time: 8.1846 / Avg. bwd time: 25.1423 / Avg. batch time: 606.8780 (ms) / GPU bubble ratio: 56.07%
[rank0]:2025-12-30 18:50:21,068 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-30 18:50:25,966 - Avg. fwd time: 10.8415 / Avg. bwd time: 43.7907 / Avg. batch time: 496.7909 (ms) / GPU bubble ratio: 12.02%
[rank2]:2025-12-30 18:50:25,991 - Avg. fwd time: 6.9932 / Avg. bwd time: 19.3399 / Avg. batch time: 528.5774 (ms) / GPU bubble ratio: 60.14%
[rank1]:2025-12-30 18:50:26,021 - Avg. fwd time: 9.0842 / Avg. bwd time: 25.0282 / Avg. batch time: 568.6822 (ms) / GPU bubble ratio: 52.01%
[rank1]:2025-12-30 18:50:26,076 -  step: 50  loss: -8.0000  grad_norm: 12.9697  memory: 15.15GiB(31.89%)  tps: 6,567  tflops: 51.34  mfu: 16.46%
[rank3]:2025-12-30 18:50:26,085 -  step: 50  loss:  9.9189  grad_norm: 12.9697  memory: 26.98GiB(56.79%)  tps: 6,567  tflops: 51.34  mfu: 16.46%
[rank0]:2025-12-30 18:50:26,051 - Avg. fwd time: 8.2028 / Avg. bwd time: 25.1870 / Avg. batch time: 607.2374 (ms) / GPU bubble ratio: 56.01%
[rank0]:2025-12-30 18:50:26,088 -  step: 50  loss: -8.0000  grad_norm: 12.9697  memory: 17.08GiB(35.95%)  tps: 6,568  tflops: 51.35  mfu: 16.46%
[rank2]:2025-12-30 18:50:26,072 -  step: 50  loss: -8.0000  grad_norm: 12.9697  memory: 12.26GiB(25.80%)  tps: 6,567  tflops: 51.34  mfu: 16.46%
[rank1]:2025-12-30 18:51:11,307 - Freezing Ratio: [Stage1] 0.00, Threshold: 0.0000e+00
[rank3]:2025-12-30 18:51:11,314 - Freezing Ratio: [Stage3] 0.00, Threshold: 0.0000e+00
[rank0]:2025-12-30 18:51:11,318 - Freezing Ratio: [Stage0] 0.00, Threshold: 0.0000e+00
[rank2]:2025-12-30 18:51:11,302 - Freezing Ratio: [Stage2] 0.00, Threshold: 0.0000e+00
[rank2]:2025-12-30 18:52:01,249 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.1520e+00
[rank1]:2025-12-30 18:52:01,254 - Freezing Ratio: [Stage1] 0.00, Threshold: 2.1376e+00
[rank3]:2025-12-30 18:52:01,261 - Freezing Ratio: [Stage3] 0.62, Threshold: 2.4470e+00
[rank0]:2025-12-30 18:52:01,265 - Freezing Ratio: [Stage0] 0.00, Threshold: 5.4788e+00
[rank3]:2025-12-30 18:52:28,618 - Avg. fwd time: 10.8971 / Avg. bwd time: 43.3730 / Avg. batch time: 493.8379 (ms) / GPU bubble ratio: 12.08%
[rank2]:2025-12-30 18:52:28,635 - Avg. fwd time: 7.0840 / Avg. bwd time: 18.7007 / Avg. batch time: 524.8370 (ms) / GPU bubble ratio: 60.70%
[rank1]:2025-12-30 18:52:28,665 - Avg. fwd time: 9.0872 / Avg. bwd time: 25.0958 / Avg. batch time: 564.8807 (ms) / GPU bubble ratio: 51.59%
[rank0]:2025-12-30 18:52:28,696 - Avg. fwd time: 8.2216 / Avg. bwd time: 25.2281 / Avg. batch time: 603.3842 (ms) / GPU bubble ratio: 55.65%
[rank2]:2025-12-30 18:52:46,987 - Freezing Ratio: [Stage2] 0.00, Threshold: 1.5348e+00
[rank1]:2025-12-30 18:52:47,003 - Freezing Ratio: [Stage1] 0.60, Threshold: 1.7134e+00
[rank3]:2025-12-30 18:52:47,003 - Freezing Ratio: [Stage3] 0.00, Threshold: 2.6865e+00
[rank0]:2025-12-30 18:52:47,014 - Freezing Ratio: [Stage0] 0.49, Threshold: 3.6646e+00
[rank1]:2025-12-30 18:53:35,593 - Freezing Ratio: [Stage1] 0.00, Threshold: 3.4340e+00
[rank3]:2025-12-30 18:53:35,613 - Freezing Ratio: [Stage3] 0.62, Threshold: 5.6173e+00
[rank0]:2025-12-30 18:53:35,609 - Freezing Ratio: [Stage0] 0.49, Threshold: 1.3887e+01
[rank2]:2025-12-30 18:53:35,601 - Freezing Ratio: [Stage2] 0.75, Threshold: 2.5418e+00
[rank0]:2025-12-30 18:54:20,411 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-30 18:54:20,432 - Freezing Ratio: [Stage0] 0.49, Threshold: 3.0940e+00
[rank2]:2025-12-30 18:54:20,413 - Freezing Ratio: [Stage2] 0.00, Threshold: 3.5776e+00
[rank1]:2025-12-30 18:54:20,430 - Freezing Ratio: [Stage1] 0.60, Threshold: 1.9743e+00
[rank3]:2025-12-30 18:54:20,431 - Freezing Ratio: [Stage3] 0.00, Threshold: 2.1138e+00
[rank1]:2025-12-30 18:54:25,182 - Avg. fwd time: 9.2131 / Avg. bwd time: 24.1717 / Avg. batch time: 556.9438 (ms) / GPU bubble ratio: 52.05%
[rank3]:2025-12-30 18:54:25,135 - Avg. fwd time: 10.9653 / Avg. bwd time: 42.5815 / Avg. batch time: 488.0117 (ms) / GPU bubble ratio: 12.22%
[rank0]:2025-12-30 18:54:25,206 - Avg. fwd time: 8.3638 / Avg. bwd time: 24.0332 / Avg. batch time: 594.1866 (ms) / GPU bubble ratio: 56.38%
[rank0]:2025-12-30 18:54:25,234 -  step: 100  loss: -8.0000  grad_norm:  7.4948  memory: 17.08GiB(35.95%)  tps: 6,851  tflops: 53.56  mfu: 17.17%
[rank2]:2025-12-30 18:54:25,160 - Avg. fwd time: 7.2183 / Avg. bwd time: 17.6986 / Avg. batch time: 517.9249 (ms) / GPU bubble ratio: 61.51%
[rank2]:2025-12-30 18:54:25,226 -  step: 100  loss: -8.0000  grad_norm:  7.4948  memory: 12.26GiB(25.80%)  tps: 6,851  tflops: 53.56  mfu: 17.17%
[rank1]:2025-12-30 18:54:25,219 -  step: 100  loss: -8.0000  grad_norm:  7.4948  memory: 15.15GiB(31.89%)  tps: 6,851  tflops: 53.56  mfu: 17.17%
[rank3]:2025-12-30 18:54:25,239 -  step: 100  loss:  8.6056  grad_norm:  7.4948  memory: 28.29GiB(59.55%)  tps: 6,851  tflops: 53.56  mfu: 17.17%
[rank0]:2025-12-30 18:54:25,306 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_auto_22_dm1/frozen_ratio_history/rank0/251230_1854_stage0_step100.svg
[rank2]:2025-12-30 18:54:25,313 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_auto_22_dm1/frozen_ratio_history/rank2/251230_1854_stage2_step100.svg
[rank1]:2025-12-30 18:54:25,311 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_auto_22_dm1/frozen_ratio_history/rank1/251230_1854_stage1_step100.svg
[rank3]:2025-12-30 18:54:25,399 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_GPipe_auto_22_dm1/pipeline_schedule/251230_1854_step100_rank3.svg
[rank3]:			> Batch Time: 548.59 ms, GPU Bubble Ratio: 58.41%, 49.91%, 72.00%, 27.85%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-8-18ms       | [S0,MB2,F]  18-8-27ms      | [S0,MB3,F]  27-8-35ms      | [S0,MB4,F]  35-9-44ms      | [S0,MB5,F]  44-8-52ms      | [S0,MB6,F]  53-9-62ms      | [S0,MB7,F]  62-8-71ms      | [S0,MB0,B]  263-19-282ms   | [S0,MB1,B]  302-19-321ms   | [S0,MB2,B]  339-19-359ms   | [S0,MB3,B]  378-19-397ms   | [S0,MB4,B]  416-19-435ms   | [S0,MB5,B]  454-19-474ms   | [S0,MB6,B]  493-19-512ms   | [S0,MB7,B]  529-19-548ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-8-32ms      | [S1,MB2,F]  35-8-44ms      | [S1,MB3,F]  56-9-65ms      | [S1,MB4,F]  75-8-84ms      | [S1,MB5,F]  93-8-102ms     | [S1,MB6,F]  112-8-121ms    | [S1,MB7,F]  131-8-140ms    | [S1,MB0,B]  236-24-261ms   | [S1,MB1,B]  273-25-298ms   | [S1,MB2,B]  310-25-336ms   | [S1,MB3,B]  348-25-373ms   | [S1,MB4,B]  386-25-411ms   | [S1,MB5,B]  425-25-450ms   | [S1,MB6,B]  464-25-489ms   | [S1,MB7,B]  499-25-524ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-8-40ms      | [S2,MB2,F]  53-8-61ms      | [S2,MB3,F]  71-8-79ms      | [S2,MB4,F]  90-8-98ms      | [S2,MB5,F]  109-8-117ms    | [S2,MB6,F]  128-8-136ms    | [S2,MB7,F]  147-8-155ms    | [S2,MB0,B]  221-11-232ms   | [S2,MB1,B]  258-11-269ms   | [S2,MB2,B]  296-11-307ms   | [S2,MB3,B]  333-11-344ms   | [S2,MB4,B]  371-11-382ms   | [S2,MB5,B]  411-11-422ms   | [S2,MB6,B]  449-11-460ms   | [S2,MB7,B]  484-11-495ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  50-11-61ms     | [S3,MB2,F]  68-11-79ms     | [S3,MB3,F]  87-11-98ms     | [S3,MB4,F]  106-11-117ms   | [S3,MB5,F]  125-11-136ms   | [S3,MB6,F]  144-11-155ms   | [S3,MB7,F]  163-11-174ms   | [S3,MB0,B]  180-34-215ms   | [S3,MB1,B]  214-35-250ms   | [S3,MB2,B]  252-37-289ms   | [S3,MB3,B]  289-38-327ms   | [S3,MB4,B]  327-39-366ms   | [S3,MB5,B]  365-39-404ms   | [S3,MB6,B]  404-39-443ms   | [S3,MB7,B]  442-39-482ms  
[rank1]:2025-12-30 18:54:25,475 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_auto_22_dm1/frozen_params_histogram/251230_1854_rank1_stage1.svg
[rank1]:	> Counts Sum: 54, Total Sum: 225 (24.00%), Ratio(%) per element: [40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-30 18:54:25,450 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_auto_22_dm1/frozen_ratio_history/rank3/251230_1854_stage3_step100.svg
[rank0]:2025-12-30 18:54:25,471 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_auto_22_dm1/frozen_params_histogram/251230_1854_rank0_stage0.svg
[rank0]:	> Counts Sum: 54, Total Sum: 185 (29.19%), Ratio(%) per element: [0.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-12-30 18:54:25,467 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_auto_22_dm1/frozen_params_histogram/251230_1854_rank2_stage2.svg
[rank2]:	> Counts Sum: 54, Total Sum: 180 (30.00%), Ratio(%) per element: [40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-30 18:54:25,586 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_auto_22_dm1/frozen_params_histogram/251230_1854_rank3_stage3.svg
[rank3]:	> Counts Sum: 36, Total Sum: 145 (24.83%), Ratio(%) per element: [40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-12-30 18:55:09,175 - Freezing Ratio: [Stage0] 0.49, Threshold: 1.2669e+00
[rank2]:2025-12-30 18:55:09,167 - Freezing Ratio: [Stage2] 0.75, Threshold: 2.2403e-01
[rank1]:2025-12-30 18:55:09,161 - Freezing Ratio: [Stage1] 0.00, Threshold: 9.2004e-01
[rank3]:2025-12-30 18:55:09,179 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.2759e+00
[rank2]:2025-12-30 18:55:54,344 - Freezing Ratio: [Stage2] 0.00, Threshold: 1.8273e+00
[rank0]:2025-12-30 18:55:54,363 - Freezing Ratio: [Stage0] 0.49, Threshold: 2.0396e+00
[rank3]:2025-12-30 18:55:54,359 - Freezing Ratio: [Stage3] 0.00, Threshold: 3.8293e+00
[rank1]:2025-12-30 18:55:54,360 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.7885e+00
[rank3]:2025-12-30 18:56:23,325 - Avg. fwd time: 10.9848 / Avg. bwd time: 42.3516 / Avg. batch time: 486.3140 (ms) / GPU bubble ratio: 12.26%
[rank2]:2025-12-30 18:56:23,351 - Avg. fwd time: 7.2607 / Avg. bwd time: 17.3650 / Avg. batch time: 515.9293 (ms) / GPU bubble ratio: 61.82%
[rank0]:2025-12-30 18:56:23,395 - Avg. fwd time: 8.4701 / Avg. bwd time: 23.1248 / Avg. batch time: 590.1887 (ms) / GPU bubble ratio: 57.17%
[rank1]:2025-12-30 18:56:23,370 - Avg. fwd time: 9.3441 / Avg. bwd time: 23.1820 / Avg. batch time: 553.9014 (ms) / GPU bubble ratio: 53.02%
[rank1]:2025-12-30 18:56:42,967 - Freezing Ratio: [Stage1] 0.00, Threshold: 2.0080e+00
[rank2]:2025-12-30 18:56:42,978 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.8982e+00
[rank0]:2025-12-30 18:56:42,986 - Freezing Ratio: [Stage0] 0.49, Threshold: 1.0518e+01
[rank3]:2025-12-30 18:56:42,990 - Freezing Ratio: [Stage3] 0.62, Threshold: 7.5289e+00
[rank2]:2025-12-30 18:57:28,162 - Freezing Ratio: [Stage2] 0.00, Threshold: 3.1824e+00
[rank0]:2025-12-30 18:57:28,181 - Freezing Ratio: [Stage0] 0.73, Threshold: 4.2413e+00
[rank1]:2025-12-30 18:57:28,178 - Freezing Ratio: [Stage1] 0.80, Threshold: 3.1271e-01
[rank3]:2025-12-30 18:57:28,177 - Freezing Ratio: [Stage3] 0.00, Threshold: 2.9574e+00
[rank2]:2025-12-30 18:58:16,385 - Freezing Ratio: [Stage2] 0.75, Threshold: 5.4998e-01
[rank1]:2025-12-30 18:58:16,372 - Freezing Ratio: [Stage1] 0.00, Threshold: 1.7874e+00
[rank0]:2025-12-30 18:58:16,379 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-30 18:58:16,388 - Freezing Ratio: [Stage0] 0.49, Threshold: 2.6560e+00
[rank3]:2025-12-30 18:58:16,397 - Freezing Ratio: [Stage3] 0.62, Threshold: 5.7748e-01
[rank2]:2025-12-30 18:58:20,862 - Avg. fwd time: 7.2975 / Avg. bwd time: 17.0883 / Avg. batch time: 514.5776 (ms) / GPU bubble ratio: 62.09%
[rank1]:2025-12-30 18:58:20,893 - Avg. fwd time: 9.4445 / Avg. bwd time: 22.4262 / Avg. batch time: 551.7409 (ms) / GPU bubble ratio: 53.79%
[rank3]:2025-12-30 18:58:20,845 - Avg. fwd time: 11.0060 / Avg. bwd time: 42.2018 / Avg. batch time: 485.2815 (ms) / GPU bubble ratio: 12.29%
[rank2]:2025-12-30 18:58:20,928 -  step: 150  loss: -8.0000  grad_norm:  9.8823  memory: 12.26GiB(25.80%)  tps: 6,951  tflops: 54.34  mfu: 17.42%
[rank1]:2025-12-30 18:58:20,941 -  step: 150  loss: -8.0000  grad_norm:  9.8823  memory: 15.15GiB(31.89%)  tps: 6,951  tflops: 54.34  mfu: 17.42%
[rank0]:2025-12-30 18:58:20,918 - Avg. fwd time: 8.5705 / Avg. bwd time: 22.3293 / Avg. batch time: 587.2030 (ms) / GPU bubble ratio: 57.90%
[rank0]:2025-12-30 18:58:20,946 -  step: 150  loss: -8.0000  grad_norm:  9.8823  memory: 17.08GiB(35.95%)  tps: 6,951  tflops: 54.34  mfu: 17.42%
[rank3]:2025-12-30 18:58:20,943 -  step: 150  loss:  4.9584  grad_norm:  9.8823  memory: 28.29GiB(59.55%)  tps: 6,951  tflops: 54.34  mfu: 17.42%
[rank2]:2025-12-30 18:59:01,516 - Freezing Ratio: [Stage2] 0.00, Threshold: 3.2275e+00
[rank1]:2025-12-30 18:59:01,532 - Freezing Ratio: [Stage1] 0.80, Threshold: 5.0247e-01
[rank0]:2025-12-30 18:59:01,536 - Freezing Ratio: [Stage0] 0.73, Threshold: 2.9212e+00
[rank3]:2025-12-30 18:59:01,532 - Freezing Ratio: [Stage3] 0.00, Threshold: 4.3954e+00
[rank1]:2025-12-30 18:59:49,445 - Freezing Ratio: [Stage1] 0.00, Threshold: 3.3285e+00
[rank2]:2025-12-30 18:59:49,456 - Freezing Ratio: [Stage2] 0.75, Threshold: 2.3842e+00
[rank0]:2025-12-30 18:59:49,460 - Freezing Ratio: [Stage0] 0.49, Threshold: 5.3883e+00
[rank3]:2025-12-30 18:59:49,468 - Freezing Ratio: [Stage3] 0.62, Threshold: 6.3147e+00
[rank2]:2025-12-30 19:00:16,230 - Avg. fwd time: 7.3501 / Avg. bwd time: 16.6998 / Avg. batch time: 511.7784 (ms) / GPU bubble ratio: 62.41%
[rank3]:2025-12-30 19:00:16,212 - Avg. fwd time: 11.0292 / Avg. bwd time: 41.8836 / Avg. batch time: 482.9047 (ms) / GPU bubble ratio: 12.34%
[rank1]:2025-12-30 19:00:16,261 - Avg. fwd time: 9.4801 / Avg. bwd time: 22.1644 / Avg. batch time: 548.6705 (ms) / GPU bubble ratio: 53.86%
[rank0]:2025-12-30 19:00:16,287 - Avg. fwd time: 8.6404 / Avg. bwd time: 21.7610 / Avg. batch time: 583.5365 (ms) / GPU bubble ratio: 58.32%
[rank2]:2025-12-30 19:00:34,276 - Freezing Ratio: [Stage2] 0.00, Threshold: 3.8292e+00
[rank3]:2025-12-30 19:00:34,292 - Freezing Ratio: [Stage3] 0.00, Threshold: 4.8125e+00
[rank0]:2025-12-30 19:00:34,295 - Freezing Ratio: [Stage0] 0.73, Threshold: 2.7131e+00
[rank1]:2025-12-30 19:00:34,292 - Freezing Ratio: [Stage1] 0.80, Threshold: 9.8371e-01
[rank1]:2025-12-30 19:01:22,234 - Freezing Ratio: [Stage1] 0.00, Threshold: 7.4620e-01
[rank2]:2025-12-30 19:01:22,246 - Freezing Ratio: [Stage2] 0.75, Threshold: 5.6961e-01
[rank3]:2025-12-30 19:01:22,258 - Freezing Ratio: [Stage3] 0.62, Threshold: 5.5100e-01
[rank0]:2025-12-30 19:01:22,250 - Freezing Ratio: [Stage0] 0.49, Threshold: 1.0860e+00
[rank2]:2025-12-30 19:02:07,385 - Freezing Ratio: [Stage2] 0.00, Threshold: 3.7646e+00
[rank3]:2025-12-30 19:02:07,401 - Freezing Ratio: [Stage3] 0.00, Threshold: 4.5046e+00
[rank0]:2025-12-30 19:02:07,384 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-30 19:02:07,404 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.9876e+00
[rank1]:2025-12-30 19:02:07,401 - Freezing Ratio: [Stage1] 0.80, Threshold: 6.3134e-01
[rank3]:2025-12-30 19:02:12,226 - Avg. fwd time: 11.0469 / Avg. bwd time: 41.6959 / Avg. batch time: 481.5409 (ms) / GPU bubble ratio: 12.38%
[rank1]:2025-12-30 19:02:12,272 - Avg. fwd time: 9.5161 / Avg. bwd time: 21.9132 / Avg. batch time: 546.7721 (ms) / GPU bubble ratio: 54.01%
[rank1]:2025-12-30 19:02:12,304 -  step: 200  loss: -8.0000  grad_norm:  7.1356  memory: 15.15GiB(31.89%)  tps: 7,082  tflops: 55.36  mfu: 17.74%
[rank2]:2025-12-30 19:02:12,252 - Avg. fwd time: 7.3839 / Avg. bwd time: 16.4538 / Avg. batch time: 510.1402 (ms) / GPU bubble ratio: 62.62%
[rank3]:2025-12-30 19:02:12,327 -  step: 200  loss:  1.3645  grad_norm:  7.1356  memory: 28.29GiB(59.55%)  tps: 7,081  tflops: 55.36  mfu: 17.74%
[rank0]:2025-12-30 19:02:12,295 - Avg. fwd time: 8.6959 / Avg. bwd time: 21.3210 / Avg. batch time: 581.1841 (ms) / GPU bubble ratio: 58.68%
[rank0]:2025-12-30 19:02:12,319 -  step: 200  loss: -8.0000  grad_norm:  7.1356  memory: 17.08GiB(35.95%)  tps: 7,081  tflops: 55.36  mfu: 17.74%
[rank1]:2025-12-30 19:02:12,382 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_auto_22_dm1/frozen_ratio_history/rank1/251230_1902_stage1_step200.svg
[rank2]:2025-12-30 19:02:12,314 -  step: 200  loss: -8.0000  grad_norm:  7.1356  memory: 12.26GiB(25.80%)  tps: 7,081  tflops: 55.35  mfu: 17.74%
[rank2]:2025-12-30 19:02:12,380 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_auto_22_dm1/frozen_ratio_history/rank2/251230_1902_stage2_step200.svg
[rank0]:2025-12-30 19:02:12,381 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_auto_22_dm1/frozen_ratio_history/rank0/251230_1902_stage0_step200.svg
[rank3]:2025-12-30 19:02:12,472 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_GPipe_auto_22_dm1/pipeline_schedule/251230_1902_step200_rank3.svg
[rank3]:			> Batch Time: 548.56 ms, GPU Bubble Ratio: 58.48%, 50.22%, 72.10%, 27.57%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-8-18ms       | [S0,MB2,F]  18-8-26ms      | [S0,MB3,F]  26-8-35ms      | [S0,MB4,F]  35-9-44ms      | [S0,MB5,F]  44-8-53ms      | [S0,MB6,F]  52-9-62ms      | [S0,MB7,F]  62-8-71ms      | [S0,MB0,B]  264-19-283ms   | [S0,MB1,B]  301-19-320ms   | [S0,MB2,B]  339-19-358ms   | [S0,MB3,B]  377-19-396ms   | [S0,MB4,B]  415-19-435ms   | [S0,MB5,B]  454-19-473ms   | [S0,MB6,B]  493-19-512ms   | [S0,MB7,B]  529-19-548ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-8-32ms      | [S1,MB2,F]  35-8-44ms      | [S1,MB3,F]  56-8-65ms      | [S1,MB4,F]  74-8-83ms      | [S1,MB5,F]  93-8-102ms     | [S1,MB6,F]  112-8-121ms    | [S1,MB7,F]  130-8-139ms    | [S1,MB0,B]  236-24-261ms   | [S1,MB1,B]  272-24-297ms   | [S1,MB2,B]  310-25-335ms   | [S1,MB3,B]  348-25-373ms   | [S1,MB4,B]  386-25-411ms   | [S1,MB5,B]  425-25-450ms   | [S1,MB6,B]  464-25-489ms   | [S1,MB7,B]  499-25-524ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-8-40ms      | [S2,MB2,F]  53-8-61ms      | [S2,MB3,F]  71-8-79ms      | [S2,MB4,F]  90-8-98ms      | [S2,MB5,F]  109-8-117ms    | [S2,MB6,F]  127-8-136ms    | [S2,MB7,F]  146-8-154ms    | [S2,MB0,B]  222-11-233ms   | [S2,MB1,B]  258-11-269ms   | [S2,MB2,B]  296-11-307ms   | [S2,MB3,B]  334-11-345ms   | [S2,MB4,B]  372-11-383ms   | [S2,MB5,B]  411-10-422ms   | [S2,MB6,B]  450-10-461ms   | [S2,MB7,B]  485-11-496ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  50-10-61ms     | [S3,MB2,F]  68-11-79ms     | [S3,MB3,F]  87-11-98ms     | [S3,MB4,F]  106-11-117ms   | [S3,MB5,F]  124-11-136ms   | [S3,MB6,F]  143-11-155ms   | [S3,MB7,F]  162-11-173ms   | [S3,MB0,B]  179-34-214ms   | [S3,MB1,B]  215-37-252ms   | [S3,MB2,B]  251-38-290ms   | [S3,MB3,B]  289-38-328ms   | [S3,MB4,B]  327-39-366ms   | [S3,MB5,B]  365-38-404ms   | [S3,MB6,B]  404-39-443ms   | [S3,MB7,B]  443-38-482ms  
[rank3]:2025-12-30 19:02:12,517 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_auto_22_dm1/frozen_ratio_history/rank3/251230_1902_stage3_step200.svg
[rank0]:2025-12-30 19:02:12,535 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_auto_22_dm1/frozen_params_histogram/251230_1902_rank0_stage0.svg
[rank0]:	> Counts Sum: 270, Total Sum: 555 (48.65%), Ratio(%) per element: [0.0, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-12-30 19:02:12,528 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_auto_22_dm1/frozen_params_histogram/251230_1902_rank1_stage1.svg
[rank1]:	> Counts Sum: 234, Total Sum: 675 (34.67%), Ratio(%) per element: [46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-12-30 19:02:12,532 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_auto_22_dm1/frozen_params_histogram/251230_1902_rank2_stage2.svg
[rank2]:	> Counts Sum: 189, Total Sum: 540 (35.00%), Ratio(%) per element: [46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-30 19:02:12,647 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_auto_22_dm1/frozen_params_histogram/251230_1902_rank3_stage3.svg
[rank3]:	> Counts Sum: 126, Total Sum: 435 (28.97%), Ratio(%) per element: [46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-12-30 19:02:56,162 - Freezing Ratio: [Stage1] 0.00, Threshold: 7.8605e+00
[rank3]:2025-12-30 19:02:56,185 - Freezing Ratio: [Stage3] 0.62, Threshold: 8.5561e+00
[rank0]:2025-12-30 19:02:56,177 - Freezing Ratio: [Stage0] 0.49, Threshold: 5.7337e+00
[rank2]:2025-12-30 19:02:56,173 - Freezing Ratio: [Stage2] 0.75, Threshold: 5.8856e+00
[rank1]:2025-12-30 19:03:41,321 - Freezing Ratio: [Stage1] 0.80, Threshold: 2.9092e-01
[rank2]:2025-12-30 19:03:41,305 - Freezing Ratio: [Stage2] 0.00, Threshold: 2.1266e+00
[rank3]:2025-12-30 19:03:41,320 - Freezing Ratio: [Stage3] 0.00, Threshold: 2.4164e+00
[rank0]:2025-12-30 19:03:41,324 - Freezing Ratio: [Stage0] 0.73, Threshold: 7.8077e-01
[rank1]:2025-12-30 19:04:10,431 - Avg. fwd time: 9.5719 / Avg. bwd time: 21.5005 / Avg. batch time: 546.4427 (ms) / GPU bubble ratio: 54.51%
[rank2]:2025-12-30 19:04:10,411 - Avg. fwd time: 7.3896 / Avg. bwd time: 16.4122 / Avg. batch time: 510.2447 (ms) / GPU bubble ratio: 62.68%
[rank3]:2025-12-30 19:04:10,384 - Avg. fwd time: 11.0543 / Avg. bwd time: 41.7032 / Avg. batch time: 481.6591 (ms) / GPU bubble ratio: 12.37%
[rank0]:2025-12-30 19:04:10,454 - Avg. fwd time: 8.7458 / Avg. bwd time: 20.9271 / Avg. batch time: 580.4486 (ms) / GPU bubble ratio: 59.10%
[rank1]:2025-12-30 19:04:29,679 - Freezing Ratio: [Stage1] 0.00, Threshold: 2.5167e+00
[rank2]:2025-12-30 19:04:29,690 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.3446e+00
[rank3]:2025-12-30 19:04:29,702 - Freezing Ratio: [Stage3] 0.62, Threshold: 2.2178e+00
[rank0]:2025-12-30 19:04:29,694 - Freezing Ratio: [Stage0] 0.49, Threshold: 2.1604e+00
[rank0]:2025-12-30 19:05:14,974 - Freezing Ratio: [Stage0] 0.73, Threshold: 7.4692e+00
[rank1]:2025-12-30 19:05:14,971 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.3641e+00
[rank2]:2025-12-30 19:05:14,955 - Freezing Ratio: [Stage2] 0.00, Threshold: 4.6278e+00
[rank3]:2025-12-30 19:05:14,970 - Freezing Ratio: [Stage3] 0.00, Threshold: 4.0647e+00
[rank3]:2025-12-30 19:06:03,033 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.6642e+00
[rank0]:2025-12-30 19:06:03,017 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-30 19:06:03,025 - Freezing Ratio: [Stage0] 0.49, Threshold: 4.8802e+00
[rank1]:2025-12-30 19:06:03,010 - Freezing Ratio: [Stage1] 0.00, Threshold: 4.5520e+00
[rank2]:2025-12-30 19:06:03,022 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.5387e+00
[rank3]:2025-12-30 19:06:07,419 - Avg. fwd time: 11.0580 / Avg. bwd time: 41.6591 / Avg. batch time: 481.3296 (ms) / GPU bubble ratio: 12.38%
[rank1]:2025-12-30 19:06:07,470 - Avg. fwd time: 9.6085 / Avg. bwd time: 21.2161 / Avg. batch time: 545.7155 (ms) / GPU bubble ratio: 54.81%
[rank2]:2025-12-30 19:06:07,438 - Avg. fwd time: 7.3978 / Avg. bwd time: 16.3414 / Avg. batch time: 509.8235 (ms) / GPU bubble ratio: 62.75%
[rank2]:2025-12-30 19:06:07,506 -  step: 250  loss: -8.0000  grad_norm:  7.7962  memory: 12.26GiB(25.80%)  tps: 6,966  tflops: 54.46  mfu: 17.45%
[rank3]:2025-12-30 19:06:07,522 -  step: 250  loss:  1.8153  grad_norm:  7.7962  memory: 28.29GiB(59.55%)  tps: 6,966  tflops: 54.46  mfu: 17.45%
[rank0]:2025-12-30 19:06:07,496 - Avg. fwd time: 8.7825 / Avg. bwd time: 20.6222 / Avg. batch time: 579.4044 (ms) / GPU bubble ratio: 59.40%
[rank0]:2025-12-30 19:06:07,524 -  step: 250  loss: -8.0000  grad_norm:  7.7962  memory: 17.08GiB(35.95%)  tps: 6,966  tflops: 54.46  mfu: 17.45%
[rank1]:2025-12-30 19:06:07,519 -  step: 250  loss: -8.0000  grad_norm:  7.7962  memory: 15.15GiB(31.89%)  tps: 6,966  tflops: 54.45  mfu: 17.45%
[rank1]:2025-12-30 19:06:47,948 - Freezing Ratio: [Stage1] 0.80, Threshold: 3.6341e-01
[rank2]:2025-12-30 19:06:47,932 - Freezing Ratio: [Stage2] 0.00, Threshold: 1.7502e+00
[rank3]:2025-12-30 19:06:47,947 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.6093e+00
[rank0]:2025-12-30 19:06:47,952 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.2853e+00
[rank1]:2025-12-30 19:07:35,922 - Freezing Ratio: [Stage1] 0.80, Threshold: 9.0610e+00
[rank2]:2025-12-30 19:07:35,934 - Freezing Ratio: [Stage2] 0.75, Threshold: 3.0634e+00
[rank3]:2025-12-30 19:07:35,949 - Freezing Ratio: [Stage3] 0.62, Threshold: 3.2086e+00
[rank0]:2025-12-30 19:07:35,938 - Freezing Ratio: [Stage0] 0.49, Threshold: 7.5586e+00
[rank1]:2025-12-30 19:08:02,333 - Avg. fwd time: 9.6484 / Avg. bwd time: 20.9012 / Avg. batch time: 544.0475 (ms) / GPU bubble ratio: 55.08%
[rank3]:2025-12-30 19:08:02,294 - Avg. fwd time: 11.0681 / Avg. bwd time: 41.5078 / Avg. batch time: 480.1906 (ms) / GPU bubble ratio: 12.41%
[rank2]:2025-12-30 19:08:02,313 - Avg. fwd time: 7.4214 / Avg. bwd time: 16.1603 / Avg. batch time: 508.4847 (ms) / GPU bubble ratio: 62.90%
[rank0]:2025-12-30 19:08:02,360 - Avg. fwd time: 8.8073 / Avg. bwd time: 20.4147 / Avg. batch time: 577.5212 (ms) / GPU bubble ratio: 59.52%
[rank2]:2025-12-30 19:08:19,890 - Freezing Ratio: [Stage2] 0.00, Threshold: 5.8915e+00
[rank0]:2025-12-30 19:08:19,909 - Freezing Ratio: [Stage0] 0.73, Threshold: 6.5474e+00
[rank1]:2025-12-30 19:08:19,890 - Freezing Ratio: [Stage1] 0.80, Threshold: 7.9953e+00
[rank3]:2025-12-30 19:08:19,906 - Freezing Ratio: [Stage3] 0.00, Threshold: 4.4966e+00
[rank0]:2025-12-30 19:09:08,175 - Freezing Ratio: [Stage0] 0.49, Threshold: 2.9355e+00
[rank1]:2025-12-30 19:09:08,160 - Freezing Ratio: [Stage1] 0.80, Threshold: 2.7124e+00
[rank3]:2025-12-30 19:09:08,187 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.9342e+00
[rank2]:2025-12-30 19:09:08,171 - Freezing Ratio: [Stage2] 0.75, Threshold: 8.1336e-01
[rank0]:2025-12-30 19:09:52,132 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-30 19:09:52,153 - Freezing Ratio: [Stage0] 0.73, Threshold: 6.9362e-01
[rank1]:2025-12-30 19:09:52,134 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.4421e+00
[rank3]:2025-12-30 19:09:52,149 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.7526e+00
[rank2]:2025-12-30 19:09:52,134 - Freezing Ratio: [Stage2] 0.00, Threshold: 1.7298e+00
[rank3]:2025-12-30 19:09:56,879 - Avg. fwd time: 11.0751 / Avg. bwd time: 41.4144 / Avg. batch time: 479.4907 (ms) / GPU bubble ratio: 12.42%
[rank2]:2025-12-30 19:09:56,907 - Avg. fwd time: 7.4374 / Avg. bwd time: 16.0396 / Avg. batch time: 507.6496 (ms) / GPU bubble ratio: 63.00%
[rank0]:2025-12-30 19:09:56,952 - Avg. fwd time: 8.8301 / Avg. bwd time: 20.2339 / Avg. batch time: 575.8517 (ms) / GPU bubble ratio: 59.62%
[rank0]:2025-12-30 19:09:56,975 -  step: 300  loss: -8.0000  grad_norm:  2.7409  memory: 17.08GiB(35.95%)  tps: 7,141  tflops: 55.82  mfu: 17.89%
[rank1]:2025-12-30 19:09:56,928 - Avg. fwd time: 9.7273 / Avg. bwd time: 20.2794 / Avg. batch time: 542.5662 (ms) / GPU bubble ratio: 55.76%
[rank1]:2025-12-30 19:09:56,961 -  step: 300  loss: -8.0000  grad_norm:  2.7409  memory: 15.15GiB(31.89%)  tps: 7,141  tflops: 55.82  mfu: 17.89%
[rank3]:2025-12-30 19:09:56,984 -  step: 300  loss:  0.5059  grad_norm:  2.7409  memory: 28.29GiB(59.55%)  tps: 7,140  tflops: 55.82  mfu: 17.89%
[rank2]:2025-12-30 19:09:56,971 -  step: 300  loss: -8.0000  grad_norm:  2.7409  memory: 12.26GiB(25.80%)  tps: 7,140  tflops: 55.82  mfu: 17.89%
[rank0]:2025-12-30 19:09:57,036 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_auto_22_dm1/frozen_ratio_history/rank0/251230_1909_stage0_step300.svg
[rank1]:2025-12-30 19:09:57,038 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_auto_22_dm1/frozen_ratio_history/rank1/251230_1909_stage1_step300.svg
[rank2]:2025-12-30 19:09:57,036 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_auto_22_dm1/frozen_ratio_history/rank2/251230_1909_stage2_step300.svg
[rank1]:2025-12-30 19:09:57,186 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_auto_22_dm1/frozen_params_histogram/251230_1909_rank1_stage1.svg
[rank1]:	> Counts Sum: 486, Total Sum: 1125 (43.20%), Ratio(%) per element: [56.0, 56.0, 56.0, 56.0, 56.0, 56.0, 56.0, 56.0, 56.0, 56.0, 56.0, 56.0, 56.0, 56.0, 56.0, 56.0, 56.0, 56.0, 56.0, 56.0, 56.0, 56.0, 56.0, 56.0, 56.0, 56.0, 56.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-30 19:09:57,134 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_GPipe_auto_22_dm1/pipeline_schedule/251230_1909_step300_rank3.svg
[rank3]:			> Batch Time: 537.64 ms, GPU Bubble Ratio: 57.42%, 64.18%, 71.39%, 25.97%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-8-18ms       | [S0,MB2,F]  18-8-27ms      | [S0,MB3,F]  27-8-35ms      | [S0,MB4,F]  35-9-44ms      | [S0,MB5,F]  44-8-53ms      | [S0,MB6,F]  53-9-62ms      | [S0,MB7,F]  62-9-71ms      | [S0,MB0,B]  253-19-272ms   | [S0,MB1,B]  290-19-309ms   | [S0,MB2,B]  327-19-347ms   | [S0,MB3,B]  366-19-386ms   | [S0,MB4,B]  404-19-423ms   | [S0,MB5,B]  443-19-462ms   | [S0,MB6,B]  482-19-501ms   | [S0,MB7,B]  518-19-537ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-10-20ms      | [S1,MB1,F]  23-10-34ms     | [S1,MB2,F]  37-10-47ms     | [S1,MB3,F]  56-10-67ms     | [S1,MB4,F]  75-10-85ms     | [S1,MB5,F]  93-10-104ms    | [S1,MB6,F]  112-10-123ms   | [S1,MB7,F]  131-10-142ms   | [S1,MB0,B]  236-13-249ms   | [S1,MB1,B]  273-13-287ms   | [S1,MB2,B]  311-13-324ms   | [S1,MB3,B]  349-13-363ms   | [S1,MB4,B]  387-13-400ms   | [S1,MB5,B]  426-13-439ms   | [S1,MB6,B]  465-13-479ms   | [S1,MB7,B]  501-13-514ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  34-8-42ms      | [S2,MB2,F]  53-8-61ms      | [S2,MB3,F]  72-8-80ms      | [S2,MB4,F]  90-8-98ms      | [S2,MB5,F]  109-8-117ms    | [S2,MB6,F]  128-8-136ms    | [S2,MB7,F]  147-8-155ms    | [S2,MB0,B]  221-11-232ms   | [S2,MB1,B]  258-11-270ms   | [S2,MB2,B]  296-11-307ms   | [S2,MB3,B]  335-11-346ms   | [S2,MB4,B]  372-11-383ms   | [S2,MB5,B]  412-11-423ms   | [S2,MB6,B]  451-11-462ms   | [S2,MB7,B]  486-11-497ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  50-11-61ms     | [S3,MB2,F]  68-11-79ms     | [S3,MB3,F]  87-11-98ms     | [S3,MB4,F]  106-11-117ms   | [S3,MB5,F]  125-11-136ms   | [S3,MB6,F]  144-11-155ms   | [S3,MB7,F]  162-11-174ms   | [S3,MB0,B]  180-34-214ms   | [S3,MB1,B]  214-36-250ms   | [S3,MB2,B]  251-38-290ms   | [S3,MB3,B]  289-39-329ms   | [S3,MB4,B]  328-38-367ms   | [S3,MB5,B]  366-39-405ms   | [S3,MB6,B]  405-39-444ms   | [S3,MB7,B]  444-39-483ms  
[rank3]:2025-12-30 19:09:57,179 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_auto_22_dm1/frozen_ratio_history/rank3/251230_1909_stage3_step300.svg
[rank2]:2025-12-30 19:09:57,189 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_auto_22_dm1/frozen_params_histogram/251230_1909_rank2_stage2.svg
[rank2]:	> Counts Sum: 324, Total Sum: 900 (36.00%), Ratio(%) per element: [48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-12-30 19:09:57,191 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_auto_22_dm1/frozen_params_histogram/251230_1909_rank0_stage0.svg
[rank0]:	> Counts Sum: 495, Total Sum: 925 (53.51%), Ratio(%) per element: [0.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 36.0, 36.0, 36.0, 36.0, 36.0, 36.0, 36.0, 36.0, 36.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-30 19:09:57,315 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_auto_22_dm1/frozen_params_histogram/251230_1909_rank3_stage3.svg
[rank3]:	> Counts Sum: 216, Total Sum: 725 (29.79%), Ratio(%) per element: [48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-12-30 19:10:40,504 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1958e+01
[rank1]:2025-12-30 19:10:40,489 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.1807e+01
[rank3]:2025-12-30 19:10:40,512 - Freezing Ratio: [Stage3] 0.62, Threshold: 4.2560e+00
[rank2]:2025-12-30 19:10:40,500 - Freezing Ratio: [Stage2] 0.75, Threshold: 4.4458e+00
[rank1]:2025-12-30 19:11:24,197 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.3936e+00
[rank3]:2025-12-30 19:11:24,213 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.5481e+00
[rank2]:2025-12-30 19:11:24,197 - Freezing Ratio: [Stage2] 0.00, Threshold: 8.6527e-01
[rank0]:2025-12-30 19:11:24,212 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.6201e+00
[rank1]:2025-12-30 19:11:53,033 - Avg. fwd time: 9.7951 / Avg. bwd time: 19.7550 / Avg. batch time: 542.0241 (ms) / GPU bubble ratio: 56.39%
[rank3]:2025-12-30 19:11:52,984 - Avg. fwd time: 11.0729 / Avg. bwd time: 41.4142 / Avg. batch time: 479.4660 (ms) / GPU bubble ratio: 12.42%
[rank2]:2025-12-30 19:11:53,012 - Avg. fwd time: 7.4368 / Avg. bwd time: 16.0435 / Avg. batch time: 507.6535 (ms) / GPU bubble ratio: 63.00%
[rank0]:2025-12-30 19:11:53,057 - Avg. fwd time: 8.8648 / Avg. bwd time: 19.9580 / Avg. batch time: 575.0224 (ms) / GPU bubble ratio: 59.90%
[rank0]:2025-12-30 19:12:12,425 - Freezing Ratio: [Stage0] 0.73, Threshold: 5.2657e+00
[rank1]:2025-12-30 19:12:12,409 - Freezing Ratio: [Stage1] 0.80, Threshold: 5.7640e+00
[rank3]:2025-12-30 19:12:12,433 - Freezing Ratio: [Stage3] 0.62, Threshold: 3.6617e+00
[rank2]:2025-12-30 19:12:12,421 - Freezing Ratio: [Stage2] 0.75, Threshold: 3.5139e+00
[rank2]:2025-12-30 19:12:56,167 - Freezing Ratio: [Stage2] 0.00, Threshold: 1.5112e+00
[rank0]:2025-12-30 19:12:56,183 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.5604e+00
[rank1]:2025-12-30 19:12:56,168 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.0884e+00
[rank3]:2025-12-30 19:12:56,183 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.6576e+00
[rank0]:2025-12-30 19:13:44,178 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-30 19:13:44,186 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.8149e+00
[rank1]:2025-12-30 19:13:44,170 - Freezing Ratio: [Stage1] 0.80, Threshold: 6.1545e-01
[rank3]:2025-12-30 19:13:44,194 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.0566e+00
[rank2]:2025-12-30 19:13:44,182 - Freezing Ratio: [Stage2] 0.75, Threshold: 7.7028e-01
[rank3]:2025-12-30 19:13:48,520 - Avg. fwd time: 11.0742 / Avg. bwd time: 41.3952 / Avg. batch time: 479.3196 (ms) / GPU bubble ratio: 12.43%
[rank2]:2025-12-30 19:13:48,540 - Avg. fwd time: 7.4402 / Avg. bwd time: 16.0236 / Avg. batch time: 507.4752 (ms) / GPU bubble ratio: 63.01%
[rank0]:2025-12-30 19:13:48,586 - Avg. fwd time: 8.8952 / Avg. bwd time: 19.7220 / Avg. batch time: 574.1346 (ms) / GPU bubble ratio: 60.12%
[rank1]:2025-12-30 19:13:48,561 - Avg. fwd time: 9.8540 / Avg. bwd time: 19.3062 / Avg. batch time: 541.3793 (ms) / GPU bubble ratio: 56.91%
[rank1]:2025-12-30 19:13:48,595 -  step: 350  loss: -8.0000  grad_norm:  0.2765  memory: 15.15GiB(31.89%)  tps: 7,073  tflops: 55.30  mfu: 17.72%
[rank3]:2025-12-30 19:13:48,611 -  step: 350  loss:  0.2574  grad_norm:  0.2765  memory: 28.29GiB(59.55%)  tps: 7,074  tflops: 55.30  mfu: 17.72%
[rank2]:2025-12-30 19:13:48,595 -  step: 350  loss: -8.0000  grad_norm:  0.2765  memory: 12.26GiB(25.80%)  tps: 7,074  tflops: 55.30  mfu: 17.72%
[rank0]:2025-12-30 19:13:48,609 -  step: 350  loss: -8.0000  grad_norm:  0.2765  memory: 17.08GiB(35.95%)  tps: 7,073  tflops: 55.30  mfu: 17.72%
[rank0]:2025-12-30 19:14:27,938 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.3863e+00
[rank1]:2025-12-30 19:14:27,923 - Freezing Ratio: [Stage1] 0.80, Threshold: 3.7386e-01
[rank3]:2025-12-30 19:14:27,939 - Freezing Ratio: [Stage3] 0.00, Threshold: 8.8257e-01
[rank2]:2025-12-30 19:14:27,923 - Freezing Ratio: [Stage2] 0.00, Threshold: 5.8348e-01
[rank0]:2025-12-30 19:15:15,912 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.5730e+00
[rank1]:2025-12-30 19:15:15,897 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.9186e+00
[rank3]:2025-12-30 19:15:15,921 - Freezing Ratio: [Stage3] 0.62, Threshold: 3.5455e-01
[rank2]:2025-12-30 19:15:15,909 - Freezing Ratio: [Stage2] 0.75, Threshold: 3.2278e-01
[rank3]:2025-12-30 19:15:41,881 - Avg. fwd time: 11.0804 / Avg. bwd time: 41.2969 / Avg. batch time: 478.5769 (ms) / GPU bubble ratio: 12.44%
[rank2]:2025-12-30 19:15:41,901 - Avg. fwd time: 7.4552 / Avg. bwd time: 15.9148 / Avg. batch time: 506.6120 (ms) / GPU bubble ratio: 63.10%
[rank0]:2025-12-30 19:15:41,948 - Avg. fwd time: 8.9204 / Avg. bwd time: 19.5169 / Avg. batch time: 572.6540 (ms) / GPU bubble ratio: 60.27%
[rank1]:2025-12-30 19:15:41,923 - Avg. fwd time: 9.9042 / Avg. bwd time: 18.9170 / Avg. batch time: 540.1111 (ms) / GPU bubble ratio: 57.31%
[rank0]:2025-12-30 19:15:59,373 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.5891e+00
[rank1]:2025-12-30 19:15:59,358 - Freezing Ratio: [Stage1] 0.80, Threshold: 2.7492e+00
[rank3]:2025-12-30 19:15:59,373 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.3947e+00
[rank2]:2025-12-30 19:15:59,358 - Freezing Ratio: [Stage2] 0.00, Threshold: 9.1686e-01
[rank2]:2025-12-30 19:16:47,186 - Freezing Ratio: [Stage2] 0.75, Threshold: 2.2729e-01
[rank0]:2025-12-30 19:16:47,190 - Freezing Ratio: [Stage0] 0.73, Threshold: 7.4936e-01
[rank1]:2025-12-30 19:16:47,175 - Freezing Ratio: [Stage1] 0.80, Threshold: 2.2989e-01
[rank3]:2025-12-30 19:16:47,199 - Freezing Ratio: [Stage3] 0.62, Threshold: 4.1660e-01
[rank2]:2025-12-30 19:17:30,849 - Freezing Ratio: [Stage2] 0.00, Threshold: 5.8656e-01
[rank0]:2025-12-30 19:17:30,847 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-30 19:17:30,864 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1100e+00
[rank1]:2025-12-30 19:17:30,849 - Freezing Ratio: [Stage1] 0.80, Threshold: 5.7433e-01
[rank3]:2025-12-30 19:17:30,865 - Freezing Ratio: [Stage3] 0.00, Threshold: 6.4893e-01
[rank3]:2025-12-30 19:17:35,626 - Avg. fwd time: 11.0844 / Avg. bwd time: 41.2258 / Avg. batch time: 478.0359 (ms) / GPU bubble ratio: 12.46%
[rank2]:2025-12-30 19:17:35,655 - Avg. fwd time: 7.4655 / Avg. bwd time: 15.8408 / Avg. batch time: 505.9871 (ms) / GPU bubble ratio: 63.15%
[rank0]:2025-12-30 19:17:35,701 - Avg. fwd time: 8.9425 / Avg. bwd time: 19.3370 / Avg. batch time: 571.4901 (ms) / GPU bubble ratio: 60.41%
[rank1]:2025-12-30 19:17:35,677 - Avg. fwd time: 9.9482 / Avg. bwd time: 18.5762 / Avg. batch time: 539.1324 (ms) / GPU bubble ratio: 57.67%
[rank1]:2025-12-30 19:17:35,710 -  step: 400  loss: -8.0000  grad_norm:  0.0931  memory: 15.15GiB(31.89%)  tps: 7,214  tflops: 56.40  mfu: 18.08%
[rank3]:2025-12-30 19:17:35,733 -  step: 400  loss:  0.2221  grad_norm:  0.0931  memory: 28.29GiB(59.55%)  tps: 7,214  tflops: 56.39  mfu: 18.08%
[rank2]:2025-12-30 19:17:35,720 -  step: 400  loss: -8.0000  grad_norm:  0.0931  memory: 12.26GiB(25.80%)  tps: 7,214  tflops: 56.39  mfu: 18.07%
[rank0]:2025-12-30 19:17:35,725 -  step: 400  loss: -8.0000  grad_norm:  0.0931  memory: 17.08GiB(35.95%)  tps: 7,214  tflops: 56.40  mfu: 18.08%
[rank0]:2025-12-30 19:17:35,787 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_auto_22_dm1/frozen_ratio_history/rank0/251230_1917_stage0_step400.svg
[rank1]:2025-12-30 19:17:35,789 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_auto_22_dm1/frozen_ratio_history/rank1/251230_1917_stage1_step400.svg
[rank2]:2025-12-30 19:17:35,787 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_auto_22_dm1/frozen_ratio_history/rank2/251230_1917_stage2_step400.svg
[rank3]:2025-12-30 19:17:35,883 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_GPipe_auto_22_dm1/pipeline_schedule/251230_1917_step400_rank3.svg
[rank3]:			> Batch Time: 529.70 ms, GPU Bubble Ratio: 60.78%, 63.66%, 71.11%, 25.82%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-36ms      | [S0,MB4,F]  36-9-46ms      | [S0,MB5,F]  46-9-55ms      | [S0,MB6,F]  55-9-64ms      | [S0,MB7,F]  64-9-74ms      | [S0,MB0,B]  251-16-268ms   | [S0,MB1,B]  288-16-304ms   | [S0,MB2,B]  325-16-341ms   | [S0,MB3,B]  362-16-379ms   | [S0,MB4,B]  401-16-418ms   | [S0,MB5,B]  440-16-456ms   | [S0,MB6,B]  477-16-494ms   | [S0,MB7,B]  513-16-529ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-10-20ms      | [S1,MB1,F]  23-10-34ms     | [S1,MB2,F]  37-10-47ms     | [S1,MB3,F]  56-10-66ms     | [S1,MB4,F]  74-10-85ms     | [S1,MB5,F]  93-10-103ms    | [S1,MB6,F]  112-10-122ms   | [S1,MB7,F]  130-10-141ms   | [S1,MB0,B]  235-13-248ms   | [S1,MB1,B]  271-13-285ms   | [S1,MB2,B]  308-13-322ms   | [S1,MB3,B]  345-13-359ms   | [S1,MB4,B]  384-13-398ms   | [S1,MB5,B]  423-13-436ms   | [S1,MB6,B]  461-13-474ms   | [S1,MB7,B]  496-13-509ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  34-8-42ms      | [S2,MB2,F]  53-8-61ms      | [S2,MB3,F]  71-8-79ms      | [S2,MB4,F]  90-8-98ms      | [S2,MB5,F]  109-8-117ms    | [S2,MB6,F]  127-8-135ms    | [S2,MB7,F]  146-8-154ms    | [S2,MB0,B]  220-11-231ms   | [S2,MB1,B]  257-11-268ms   | [S2,MB2,B]  294-11-305ms   | [S2,MB3,B]  331-11-342ms   | [S2,MB4,B]  370-11-381ms   | [S2,MB5,B]  409-10-420ms   | [S2,MB6,B]  446-10-457ms   | [S2,MB7,B]  481-11-492ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  50-10-60ms     | [S3,MB2,F]  68-11-79ms     | [S3,MB3,F]  87-11-98ms     | [S3,MB4,F]  105-11-117ms   | [S3,MB5,F]  124-11-135ms   | [S3,MB6,F]  143-11-154ms   | [S3,MB7,F]  162-11-173ms   | [S3,MB0,B]  179-34-214ms   | [S3,MB1,B]  214-35-249ms   | [S3,MB2,B]  250-37-287ms   | [S3,MB3,B]  287-38-325ms   | [S3,MB4,B]  324-38-363ms   | [S3,MB5,B]  363-39-402ms   | [S3,MB6,B]  402-39-441ms   | [S3,MB7,B]  439-39-478ms  
[rank3]:2025-12-30 19:17:35,934 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_auto_22_dm1/frozen_ratio_history/rank3/251230_1917_stage3_step400.svg
[rank2]:2025-12-30 19:17:35,940 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_auto_22_dm1/frozen_params_histogram/251230_1917_rank2_stage2.svg
[rank2]:	> Counts Sum: 459, Total Sum: 1260 (36.43%), Ratio(%) per element: [48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-12-30 19:17:35,950 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_auto_22_dm1/frozen_params_histogram/251230_1917_rank0_stage0.svg
[rank0]:	> Counts Sum: 765, Total Sum: 1295 (59.07%), Ratio(%) per element: [0.0, 94.28, 94.28, 94.28, 94.28, 94.28, 94.28, 94.28, 94.28, 94.28, 94.28, 94.28, 94.28, 94.28, 94.28, 94.28, 94.28, 94.28, 94.28, 54.28, 54.28, 54.28, 54.28, 54.28, 54.28, 54.28, 54.28, 54.28, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-12-30 19:17:35,954 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_auto_22_dm1/frozen_params_histogram/251230_1917_rank1_stage1.svg
[rank1]:	> Counts Sum: 846, Total Sum: 1575 (53.71%), Ratio(%) per element: [68.57, 68.57, 68.57, 68.57, 68.57, 68.57, 68.57, 68.57, 68.57, 68.57, 68.57, 68.57, 68.57, 68.57, 68.57, 68.57, 68.57, 68.57, 68.57, 68.57, 68.57, 68.57, 68.57, 68.57, 68.57, 68.57, 68.57, 62.85, 62.85, 62.85, 62.85, 62.85, 62.85, 62.85, 62.85, 62.85, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-30 19:17:36,066 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_auto_22_dm1/frozen_params_histogram/251230_1917_rank3_stage3.svg
[rank3]:	> Counts Sum: 306, Total Sum: 1015 (30.15%), Ratio(%) per element: [48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-30 19:18:03,249 - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-12-30 19:18:03,462 - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-12-30 19:18:03,494 - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-12-30 19:18:03,475 - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-12-30 19:18:19,146 - Freezing Ratio: [Stage0] 0.73, Threshold: 2.1091e+00
[rank1]:2025-12-30 19:18:19,131 - Freezing Ratio: [Stage1] 0.80, Threshold: 2.7791e+00
[rank3]:2025-12-30 19:18:19,155 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.1363e+00
[rank2]:2025-12-30 19:18:19,143 - Freezing Ratio: [Stage2] 0.75, Threshold: 8.1251e-01
[rank1]:2025-12-30 19:19:02,728 - Freezing Ratio: [Stage1] 0.80, Threshold: 8.9213e+00
[rank3]:2025-12-30 19:19:02,743 - Freezing Ratio: [Stage3] 0.00, Threshold: 7.4548e+00
[rank2]:2025-12-30 19:19:02,728 - Freezing Ratio: [Stage2] 0.00, Threshold: 7.9812e+00
[rank0]:2025-12-30 19:19:02,743 - Freezing Ratio: [Stage0] 0.73, Threshold: 6.5172e+00
[rank3]:2025-12-30 19:19:31,429 - Avg. fwd time: 11.0807 / Avg. bwd time: 41.2289 / Avg. batch time: 478.0265 (ms) / GPU bubble ratio: 12.46%
[rank2]:2025-12-30 19:19:31,458 - Avg. fwd time: 7.4634 / Avg. bwd time: 15.8557 / Avg. batch time: 506.0093 (ms) / GPU bubble ratio: 63.13%
[rank0]:2025-12-30 19:19:31,505 - Avg. fwd time: 8.9622 / Avg. bwd time: 19.1786 / Avg. batch time: 571.0350 (ms) / GPU bubble ratio: 60.58%
[rank1]:2025-12-30 19:19:31,480 - Avg. fwd time: 9.9872 / Avg. bwd time: 18.2757 / Avg. batch time: 538.8424 (ms) / GPU bubble ratio: 58.04%
[rank0]:2025-12-30 19:19:50,544 - Freezing Ratio: [Stage0] 0.73, Threshold: 9.7936e-01
[rank1]:2025-12-30 19:19:50,529 - Freezing Ratio: [Stage1] 0.80, Threshold: 2.2662e+00
[rank3]:2025-12-30 19:19:50,552 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.3575e+00
[rank2]:2025-12-30 19:19:50,540 - Freezing Ratio: [Stage2] 0.75, Threshold: 9.6062e-01
[rank2]:2025-12-30 19:20:34,176 - Freezing Ratio: [Stage2] 0.00, Threshold: 2.1266e+00
[rank0]:2025-12-30 19:20:34,192 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.9713e+00
[rank1]:2025-12-30 19:20:34,176 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.6956e+00
[rank3]:2025-12-30 19:20:34,192 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.7242e+00
[rank2]:2025-12-30 19:21:22,159 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.7160e+00
[rank0]:2025-12-30 19:21:22,155 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-30 19:21:22,162 - Freezing Ratio: [Stage0] 0.73, Threshold: 2.8430e+00
[rank1]:2025-12-30 19:21:22,147 - Freezing Ratio: [Stage1] 0.80, Threshold: 2.6483e+00
[rank3]:2025-12-30 19:21:22,172 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.7342e+00
[rank3]:2025-12-30 19:21:26,447 - Avg. fwd time: 11.0789 / Avg. bwd time: 41.2138 / Avg. batch time: 477.8880 (ms) / GPU bubble ratio: 12.46%
[rank2]:2025-12-30 19:21:26,467 - Avg. fwd time: 7.4640 / Avg. bwd time: 15.8497 / Avg. batch time: 505.8562 (ms) / GPU bubble ratio: 63.13%
[rank1]:2025-12-30 19:21:26,490 - Avg. fwd time: 10.0213 / Avg. bwd time: 18.0085 / Avg. batch time: 538.4107 (ms) / GPU bubble ratio: 58.35%
[rank1]:2025-12-30 19:21:26,524 -  step: 450  loss: -8.0000  grad_norm:  0.1005  memory: 15.15GiB(31.89%)  tps: 7,098  tflops: 55.49  mfu: 17.79%
[rank3]:2025-12-30 19:21:26,540 -  step: 450  loss:  0.2438  grad_norm:  0.1005  memory: 28.29GiB(59.55%)  tps: 7,099  tflops: 55.49  mfu: 17.79%
[rank2]:2025-12-30 19:21:26,524 -  step: 450  loss: -8.0000  grad_norm:  0.1005  memory: 12.26GiB(25.80%)  tps: 7,099  tflops: 55.49  mfu: 17.79%
[rank0]:2025-12-30 19:21:26,515 - Avg. fwd time: 8.9792 / Avg. bwd time: 19.0377 / Avg. batch time: 570.4583 (ms) / GPU bubble ratio: 60.71%
[rank0]:2025-12-30 19:21:26,539 -  step: 450  loss: -8.0000  grad_norm:  0.1005  memory: 17.08GiB(35.95%)  tps: 7,098  tflops: 55.49  mfu: 17.79%
[rank1]:2025-12-30 19:22:05,969 - Freezing Ratio: [Stage1] 0.80, Threshold: 2.7054e-01
[rank3]:2025-12-30 19:22:05,984 - Freezing Ratio: [Stage3] 0.00, Threshold: 3.6130e-01
[rank2]:2025-12-30 19:22:05,968 - Freezing Ratio: [Stage2] 0.00, Threshold: 8.1455e-01
[rank0]:2025-12-30 19:22:05,984 - Freezing Ratio: [Stage0] 0.73, Threshold: 8.5069e-01
[rank0]:2025-12-30 19:22:54,117 - Freezing Ratio: [Stage0] 0.73, Threshold: 3.9789e-01
[rank1]:2025-12-30 19:22:54,101 - Freezing Ratio: [Stage1] 0.80, Threshold: 5.5834e-01
[rank3]:2025-12-30 19:22:54,125 - Freezing Ratio: [Stage3] 0.62, Threshold: 5.6890e-01
[rank2]:2025-12-30 19:22:54,113 - Freezing Ratio: [Stage2] 0.75, Threshold: 2.8878e-01
[rank1]:2025-12-30 19:23:20,472 - Avg. fwd time: 10.0515 / Avg. bwd time: 17.7687 / Avg. batch time: 537.7343 (ms) / GPU bubble ratio: 58.61%
[rank3]:2025-12-30 19:23:20,428 - Avg. fwd time: 11.0852 / Avg. bwd time: 41.1650 / Avg. batch time: 477.5486 (ms) / GPU bubble ratio: 12.47%
[rank2]:2025-12-30 19:23:20,449 - Avg. fwd time: 7.4742 / Avg. bwd time: 15.7717 / Avg. batch time: 505.4302 (ms) / GPU bubble ratio: 63.21%
[rank0]:2025-12-30 19:23:20,498 - Avg. fwd time: 8.9939 / Avg. bwd time: 18.9111 / Avg. batch time: 569.6504 (ms) / GPU bubble ratio: 60.81%
[rank1]:2025-12-30 19:23:37,995 - Freezing Ratio: [Stage1] 0.80, Threshold: 5.2986e-01
[rank3]:2025-12-30 19:23:38,011 - Freezing Ratio: [Stage3] 0.00, Threshold: 3.7410e-01
[rank2]:2025-12-30 19:23:37,995 - Freezing Ratio: [Stage2] 0.00, Threshold: 3.7529e-01
[rank0]:2025-12-30 19:23:38,010 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.6225e-01
[rank0]:2025-12-30 19:24:26,350 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.2675e+00
[rank1]:2025-12-30 19:24:26,335 - Freezing Ratio: [Stage1] 0.80, Threshold: 8.0305e-01
[rank3]:2025-12-30 19:24:26,358 - Freezing Ratio: [Stage3] 0.62, Threshold: 3.5811e-01
[rank2]:2025-12-30 19:24:26,346 - Freezing Ratio: [Stage2] 0.75, Threshold: 2.4751e-01
[rank0]:2025-12-30 19:25:10,008 - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-12-30 19:25:10,009 - Freezing Ratio: [Stage1] 0.80, Threshold: 7.4344e-01
[rank3]:2025-12-30 19:25:10,025 - Freezing Ratio: [Stage3] 0.00, Threshold: 9.0959e-01
[rank2]:2025-12-30 19:25:10,009 - Freezing Ratio: [Stage2] 0.00, Threshold: 8.6345e-01
[rank0]:2025-12-30 19:25:10,025 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.4751e+00
[rank3]:2025-12-30 19:25:14,720 - Avg. fwd time: 11.0891 / Avg. bwd time: 41.1299 / Avg. batch time: 477.2979 (ms) / GPU bubble ratio: 12.48%
[rank2]:2025-12-30 19:25:14,749 - Avg. fwd time: 7.4812 / Avg. bwd time: 15.7185 / Avg. batch time: 505.1190 (ms) / GPU bubble ratio: 63.26%
[rank0]:2025-12-30 19:25:14,798 - Avg. fwd time: 9.0077 / Avg. bwd time: 18.7973 / Avg. batch time: 568.9990 (ms) / GPU bubble ratio: 60.91%
[rank0]:2025-12-30 19:25:14,822 -  step: 500  loss: -8.0000  grad_norm:  0.1047  memory: 17.08GiB(35.95%)  tps: 7,177  tflops: 56.11  mfu: 17.98%
[rank1]:2025-12-30 19:25:14,772 - Avg. fwd time: 10.0787 / Avg. bwd time: 17.5531 / Avg. batch time: 537.1994 (ms) / GPU bubble ratio: 58.85%
[rank1]:2025-12-30 19:25:14,807 -  step: 500  loss: -8.0000  grad_norm:  0.1047  memory: 15.15GiB(31.89%)  tps: 7,177  tflops: 56.11  mfu: 17.98%
[rank3]:2025-12-30 19:25:14,830 -  step: 500  loss:  0.2411  grad_norm:  0.1047  memory: 28.29GiB(59.55%)  tps: 7,177  tflops: 56.11  mfu: 17.98%
[rank2]:2025-12-30 19:25:14,817 -  step: 500  loss: -8.0000  grad_norm:  0.1047  memory: 12.26GiB(25.80%)  tps: 7,177  tflops: 56.10  mfu: 17.98%
[rank0]:2025-12-30 19:25:14,882 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_auto_22_dm1/frozen_ratio_history/rank0/251230_1925_stage0_step500.svg
[rank1]:2025-12-30 19:25:14,883 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_auto_22_dm1/frozen_ratio_history/rank1/251230_1925_stage1_step500.svg
[rank2]:2025-12-30 19:25:14,882 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_auto_22_dm1/frozen_ratio_history/rank2/251230_1925_stage2_step500.svg
[rank3]:2025-12-30 19:25:14,971 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_GPipe_auto_22_dm1/pipeline_schedule/251230_1925_step500_rank3.svg
[rank3]:			> Batch Time: 534.20 ms, GPU Bubble Ratio: 61.10%, 63.93%, 71.29%, 25.36%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-36ms      | [S0,MB4,F]  36-9-46ms      | [S0,MB5,F]  46-9-55ms      | [S0,MB6,F]  55-9-64ms      | [S0,MB7,F]  64-9-73ms      | [S0,MB0,B]  253-16-269ms   | [S0,MB1,B]  290-16-306ms   | [S0,MB2,B]  329-16-346ms   | [S0,MB3,B]  367-16-383ms   | [S0,MB4,B]  405-16-422ms   | [S0,MB5,B]  443-16-460ms   | [S0,MB6,B]  482-16-498ms   | [S0,MB7,B]  517-16-534ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-10-20ms      | [S1,MB1,F]  23-10-34ms     | [S1,MB2,F]  37-10-47ms     | [S1,MB3,F]  56-10-67ms     | [S1,MB4,F]  75-10-85ms     | [S1,MB5,F]  93-10-104ms    | [S1,MB6,F]  112-10-122ms   | [S1,MB7,F]  131-10-141ms   | [S1,MB0,B]  236-13-250ms   | [S1,MB1,B]  273-13-286ms   | [S1,MB2,B]  312-13-326ms   | [S1,MB3,B]  350-13-364ms   | [S1,MB4,B]  389-13-402ms   | [S1,MB5,B]  426-13-440ms   | [S1,MB6,B]  465-13-478ms   | [S1,MB7,B]  501-13-514ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  34-8-42ms      | [S2,MB2,F]  53-8-61ms      | [S2,MB3,F]  71-8-80ms      | [S2,MB4,F]  90-8-98ms      | [S2,MB5,F]  109-8-117ms    | [S2,MB6,F]  128-8-136ms    | [S2,MB7,F]  146-8-154ms    | [S2,MB0,B]  221-11-232ms   | [S2,MB1,B]  259-11-270ms   | [S2,MB2,B]  298-11-309ms   | [S2,MB3,B]  336-11-347ms   | [S2,MB4,B]  375-11-386ms   | [S2,MB5,B]  412-11-423ms   | [S2,MB6,B]  451-11-462ms   | [S2,MB7,B]  486-10-497ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  50-11-61ms     | [S3,MB2,F]  68-11-79ms     | [S3,MB3,F]  87-11-98ms     | [S3,MB4,F]  106-11-117ms   | [S3,MB5,F]  124-11-136ms   | [S3,MB6,F]  143-11-155ms   | [S3,MB7,F]  162-11-174ms   | [S3,MB0,B]  180-34-215ms   | [S3,MB1,B]  214-37-251ms   | [S3,MB2,B]  252-39-291ms   | [S3,MB3,B]  291-38-329ms   | [S3,MB4,B]  330-39-369ms   | [S3,MB5,B]  368-39-407ms   | [S3,MB6,B]  405-39-445ms   | [S3,MB7,B]  444-39-483ms  
[rank3]:2025-12-30 19:25:15,016 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_auto_22_dm1/frozen_ratio_history/rank3/251230_1925_stage3_step500.svg
[rank2]:2025-12-30 19:25:15,038 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_auto_22_dm1/frozen_params_histogram/251230_1925_rank2_stage2.svg
[rank2]:	> Counts Sum: 594, Total Sum: 1620 (36.67%), Ratio(%) per element: [48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-12-30 19:25:15,038 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_auto_22_dm1/frozen_params_histogram/251230_1925_rank0_stage0.svg
[rank0]:	> Counts Sum: 1035, Total Sum: 1665 (62.16%), Ratio(%) per element: [0.0, 95.55, 95.55, 95.55, 95.55, 95.55, 95.55, 95.55, 95.55, 95.55, 95.55, 95.55, 95.55, 95.55, 95.55, 95.55, 95.55, 95.55, 95.55, 64.44, 64.44, 64.44, 64.44, 64.44, 64.44, 64.44, 64.44, 64.44, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-12-30 19:25:15,037 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_auto_22_dm1/frozen_params_histogram/251230_1925_rank1_stage1.svg
[rank1]:	> Counts Sum: 1206, Total Sum: 2025 (59.56%), Ratio(%) per element: [75.55, 75.55, 75.55, 75.55, 75.55, 75.55, 75.55, 75.55, 75.55, 75.55, 75.55, 75.55, 75.55, 75.55, 75.55, 75.55, 75.55, 75.55, 75.55, 75.55, 75.55, 75.55, 75.55, 75.55, 75.55, 75.55, 75.55, 71.11, 71.11, 71.11, 71.11, 71.11, 71.11, 71.11, 71.11, 71.11, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-30 19:25:15,148 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_auto_22_dm1/frozen_params_histogram/251230_1925_rank3_stage3.svg
[rank3]:	> Counts Sum: 396, Total Sum: 1305 (30.34%), Ratio(%) per element: [48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-12-30 19:25:58,273 - Freezing Ratio: [Stage1] 0.80, Threshold: 2.0987e+00
[rank3]:2025-12-30 19:25:58,297 - Freezing Ratio: [Stage3] 0.62, Threshold: 6.4477e-01
[rank2]:2025-12-30 19:25:58,285 - Freezing Ratio: [Stage2] 0.75, Threshold: 5.4296e-01
[rank0]:2025-12-30 19:25:58,289 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.5432e+00
[rank3]:2025-12-30 19:26:41,960 - Freezing Ratio: [Stage3] 0.00, Threshold: 2.6349e+00
[rank2]:2025-12-30 19:26:41,943 - Freezing Ratio: [Stage2] 0.00, Threshold: 2.5320e+00
[rank0]:2025-12-30 19:26:41,959 - Freezing Ratio: [Stage0] 0.73, Threshold: 2.6275e+00
[rank1]:2025-12-30 19:26:41,943 - Freezing Ratio: [Stage1] 0.80, Threshold: 3.1514e+00
[rank3]:2025-12-30 19:27:10,631 - Avg. fwd time: 11.0868 / Avg. bwd time: 41.1376 / Avg. batch time: 477.3397 (ms) / GPU bubble ratio: 12.47%
[rank2]:2025-12-30 19:27:10,661 - Avg. fwd time: 7.4786 / Avg. bwd time: 15.7350 / Avg. batch time: 505.1899 (ms) / GPU bubble ratio: 63.24%
[rank0]:2025-12-30 19:27:10,713 - Avg. fwd time: 9.0206 / Avg. bwd time: 18.6947 / Avg. batch time: 568.7608 (ms) / GPU bubble ratio: 61.02%
[rank1]:2025-12-30 19:27:10,684 - Avg. fwd time: 10.1037 / Avg. bwd time: 17.3581 / Avg. batch time: 537.0676 (ms) / GPU bubble ratio: 59.09%
[rank3]:2025-12-30 19:27:30,032 - Freezing Ratio: [Stage3] 0.62, Threshold: 7.4367e-01
[rank2]:2025-12-30 19:27:30,020 - Freezing Ratio: [Stage2] 0.75, Threshold: 5.1432e-01
[rank0]:2025-12-30 19:27:30,024 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1203e+00
[rank1]:2025-12-30 19:27:30,008 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.1813e+00
[rank1]:2025-12-30 19:28:13,561 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.4717e+00
[rank3]:2025-12-30 19:28:13,576 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.1288e+00
[rank2]:2025-12-30 19:28:13,561 - Freezing Ratio: [Stage2] 0.00, Threshold: 8.7351e-01
[rank0]:2025-12-30 19:28:13,577 - Freezing Ratio: [Stage0] 0.73, Threshold: 7.9572e-01
[rank0]:2025-12-30 19:29:01,498 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-30 19:29:01,505 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.6483e+00
[rank1]:2025-12-30 19:29:01,490 - Freezing Ratio: [Stage1] 0.80, Threshold: 5.3812e-01
[rank3]:2025-12-30 19:29:01,516 - Freezing Ratio: [Stage3] 0.62, Threshold: 4.7172e-01
[rank2]:2025-12-30 19:29:01,502 - Freezing Ratio: [Stage2] 0.75, Threshold: 3.0082e-01
[rank3]:2025-12-30 19:29:05,849 - Avg. fwd time: 11.0853 / Avg. bwd time: 41.1330 / Avg. batch time: 477.2892 (ms) / GPU bubble ratio: 12.48%
[rank1]:2025-12-30 19:29:05,894 - Avg. fwd time: 10.1262 / Avg. bwd time: 17.1805 / Avg. batch time: 536.8243 (ms) / GPU bubble ratio: 59.31%
[rank1]:2025-12-30 19:29:05,930 -  step: 550  loss: -8.0000  grad_norm:  0.0752  memory: 15.15GiB(31.89%)  tps: 7,089  tflops: 55.42  mfu: 17.76%
[rank3]:2025-12-30 19:29:05,947 -  step: 550  loss:  0.2464  grad_norm:  0.0752  memory: 28.29GiB(59.55%)  tps: 7,089  tflops: 55.42  mfu: 17.76%
[rank2]:2025-12-30 19:29:05,871 - Avg. fwd time: 7.4784 / Avg. bwd time: 15.7341 / Avg. batch time: 505.1322 (ms) / GPU bubble ratio: 63.24%
[rank2]:2025-12-30 19:29:05,930 -  step: 550  loss: -8.0000  grad_norm:  0.0752  memory: 12.26GiB(25.80%)  tps: 7,089  tflops: 55.42  mfu: 17.76%
[rank0]:2025-12-30 19:29:05,921 - Avg. fwd time: 9.0321 / Avg. bwd time: 18.6011 / Avg. batch time: 568.4211 (ms) / GPU bubble ratio: 61.11%
[rank0]:2025-12-30 19:29:05,944 -  step: 550  loss: -8.0000  grad_norm:  0.0752  memory: 17.08GiB(35.95%)  tps: 7,089  tflops: 55.42  mfu: 17.76%
[rank1]:2025-12-30 19:29:45,266 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.5572e+00
[rank3]:2025-12-30 19:29:45,281 - Freezing Ratio: [Stage3] 0.00, Threshold: 7.3939e-01
[rank2]:2025-12-30 19:29:45,266 - Freezing Ratio: [Stage2] 0.00, Threshold: 1.1958e+00
[rank0]:2025-12-30 19:29:45,281 - Freezing Ratio: [Stage0] 0.73, Threshold: 6.7126e-01
[rank0]:2025-12-30 19:30:33,316 - Freezing Ratio: [Stage0] 0.73, Threshold: 8.6216e-01
[rank1]:2025-12-30 19:30:33,301 - Freezing Ratio: [Stage1] 0.80, Threshold: 2.4556e+00
[rank3]:2025-12-30 19:30:33,325 - Freezing Ratio: [Stage3] 0.62, Threshold: 7.9149e-01
[rank2]:2025-12-30 19:30:33,313 - Freezing Ratio: [Stage2] 0.75, Threshold: 4.4563e-01
[rank3]:2025-12-30 19:30:59,371 - Avg. fwd time: 11.0893 / Avg. bwd time: 41.0835 / Avg. batch time: 476.9223 (ms) / GPU bubble ratio: 12.48%
[rank2]:2025-12-30 19:30:59,393 - Avg. fwd time: 7.4865 / Avg. bwd time: 15.6750 / Avg. batch time: 504.6999 (ms) / GPU bubble ratio: 63.29%
[rank0]:2025-12-30 19:30:59,445 - Avg. fwd time: 9.0428 / Avg. bwd time: 18.5158 / Avg. batch time: 567.7339 (ms) / GPU bubble ratio: 61.17%
[rank1]:2025-12-30 19:30:59,418 - Avg. fwd time: 10.1468 / Avg. bwd time: 17.0186 / Avg. batch time: 536.2246 (ms) / GPU bubble ratio: 59.47%
[rank3]:2025-12-30 19:31:16,932 - Freezing Ratio: [Stage3] 0.00, Threshold: 9.9241e-01
[rank2]:2025-12-30 19:31:16,916 - Freezing Ratio: [Stage2] 0.00, Threshold: 1.3483e+00
[rank0]:2025-12-30 19:31:16,932 - Freezing Ratio: [Stage0] 0.73, Threshold: 2.0055e+00
[rank1]:2025-12-30 19:31:16,916 - Freezing Ratio: [Stage1] 0.80, Threshold: 6.3764e-01
[rank0]:2025-12-30 19:32:04,927 - Freezing Ratio: [Stage0] 0.73, Threshold: 5.9761e-01
[rank1]:2025-12-30 19:32:04,912 - Freezing Ratio: [Stage1] 0.80, Threshold: 5.7870e-01
[rank3]:2025-12-30 19:32:04,943 - Freezing Ratio: [Stage3] 0.62, Threshold: 4.8263e-01
[rank2]:2025-12-30 19:32:04,924 - Freezing Ratio: [Stage2] 0.75, Threshold: 3.4658e-01
[rank0]:2025-12-30 19:32:48,687 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-30 19:32:48,703 - Freezing Ratio: [Stage0] 0.73, Threshold: 8.4961e-01
[rank1]:2025-12-30 19:32:48,688 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.0971e+00
[rank3]:2025-12-30 19:32:48,705 - Freezing Ratio: [Stage3] 0.00, Threshold: 4.8402e-01
[rank2]:2025-12-30 19:32:48,688 - Freezing Ratio: [Stage2] 0.00, Threshold: 3.6466e-01
[rank3]:2025-12-30 19:32:53,498 - Avg. fwd time: 11.0928 / Avg. bwd time: 41.0521 / Avg. batch time: 476.6986 (ms) / GPU bubble ratio: 12.49%
[rank2]:2025-12-30 19:32:53,529 - Avg. fwd time: 7.4922 / Avg. bwd time: 15.6351 / Avg. batch time: 504.4308 (ms) / GPU bubble ratio: 63.32%
[rank0]:2025-12-30 19:32:53,580 - Avg. fwd time: 9.0535 / Avg. bwd time: 18.4379 / Avg. batch time: 567.2338 (ms) / GPU bubble ratio: 61.23%
[rank0]:2025-12-30 19:32:53,604 -  step: 600  loss: -8.0000  grad_norm:  0.1053  memory: 17.08GiB(35.95%)  tps: 7,197  tflops: 56.26  mfu: 18.03%
[rank1]:2025-12-30 19:32:53,553 - Avg. fwd time: 10.1662 / Avg. bwd time: 16.8706 / Avg. batch time: 535.8027 (ms) / GPU bubble ratio: 59.63%
[rank1]:2025-12-30 19:32:53,589 -  step: 600  loss: -8.0000  grad_norm:  0.1053  memory: 15.15GiB(31.89%)  tps: 7,197  tflops: 56.26  mfu: 18.03%
[rank3]:2025-12-30 19:32:53,612 -  step: 600  loss:  0.2318  grad_norm:  0.1053  memory: 28.29GiB(59.55%)  tps: 7,197  tflops: 56.26  mfu: 18.03%
[rank2]:2025-12-30 19:32:53,599 -  step: 600  loss: -8.0000  grad_norm:  0.1053  memory: 12.26GiB(25.80%)  tps: 7,196  tflops: 56.26  mfu: 18.03%
[rank2]:2025-12-30 19:32:53,665 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_auto_22_dm1/frozen_ratio_history/rank2/251230_1932_stage2_step600.svg
[rank0]:2025-12-30 19:32:53,667 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_auto_22_dm1/frozen_ratio_history/rank0/251230_1932_stage0_step600.svg
[rank1]:2025-12-30 19:32:53,666 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_auto_22_dm1/frozen_ratio_history/rank1/251230_1932_stage1_step600.svg
[rank3]:2025-12-30 19:32:53,759 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_GPipe_auto_22_dm1/pipeline_schedule/251230_1932_step600_rank3.svg
[rank3]:			> Batch Time: 530.70 ms, GPU Bubble Ratio: 60.80%, 63.72%, 71.20%, 25.64%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-18ms       | [S0,MB2,F]  18-9-28ms      | [S0,MB3,F]  28-8-36ms      | [S0,MB4,F]  36-9-46ms      | [S0,MB5,F]  46-9-55ms      | [S0,MB6,F]  55-9-65ms      | [S0,MB7,F]  65-9-74ms      | [S0,MB0,B]  252-16-268ms   | [S0,MB1,B]  289-16-305ms   | [S0,MB2,B]  327-16-343ms   | [S0,MB3,B]  366-16-382ms   | [S0,MB4,B]  403-16-420ms   | [S0,MB5,B]  441-16-457ms   | [S0,MB6,B]  478-16-495ms   | [S0,MB7,B]  514-16-530ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-10-20ms      | [S1,MB1,F]  23-10-34ms     | [S1,MB2,F]  37-10-47ms     | [S1,MB3,F]  56-10-66ms     | [S1,MB4,F]  74-10-85ms     | [S1,MB5,F]  93-10-104ms    | [S1,MB6,F]  112-10-122ms   | [S1,MB7,F]  131-10-141ms   | [S1,MB0,B]  235-13-249ms   | [S1,MB1,B]  272-13-286ms   | [S1,MB2,B]  310-13-324ms   | [S1,MB3,B]  349-13-362ms   | [S1,MB4,B]  386-13-400ms   | [S1,MB5,B]  424-13-438ms   | [S1,MB6,B]  461-13-475ms   | [S1,MB7,B]  497-13-510ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  34-8-42ms      | [S2,MB2,F]  53-8-61ms      | [S2,MB3,F]  71-8-79ms      | [S2,MB4,F]  90-8-98ms      | [S2,MB5,F]  109-8-117ms    | [S2,MB6,F]  128-8-136ms    | [S2,MB7,F]  146-8-154ms    | [S2,MB0,B]  221-10-232ms   | [S2,MB1,B]  258-11-269ms   | [S2,MB2,B]  296-11-307ms   | [S2,MB3,B]  334-11-345ms   | [S2,MB4,B]  372-11-383ms   | [S2,MB5,B]  410-10-421ms   | [S2,MB6,B]  447-10-458ms   | [S2,MB7,B]  482-10-493ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  50-10-61ms     | [S3,MB2,F]  68-10-79ms     | [S3,MB3,F]  87-11-98ms     | [S3,MB4,F]  106-11-117ms   | [S3,MB5,F]  124-11-136ms   | [S3,MB6,F]  143-11-155ms   | [S3,MB7,F]  162-11-173ms   | [S3,MB0,B]  179-34-214ms   | [S3,MB1,B]  214-37-251ms   | [S3,MB2,B]  251-38-290ms   | [S3,MB3,B]  289-38-327ms   | [S3,MB4,B]  328-38-366ms   | [S3,MB5,B]  365-38-404ms   | [S3,MB6,B]  403-38-442ms   | [S3,MB7,B]  440-39-479ms  
[rank0]:2025-12-30 19:32:53,826 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_auto_22_dm1/frozen_params_histogram/251230_1932_rank0_stage0.svg
[rank0]:	> Counts Sum: 1305, Total Sum: 2035 (64.13%), Ratio(%) per element: [0.0, 96.36, 96.36, 96.36, 96.36, 96.36, 96.36, 96.36, 96.36, 96.36, 96.36, 96.36, 96.36, 96.36, 96.36, 96.36, 96.36, 96.36, 96.36, 70.9, 70.9, 70.9, 70.9, 70.9, 70.9, 70.9, 70.9, 70.9, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-12-30 19:32:53,806 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_auto_22_dm1/frozen_params_histogram/251230_1932_rank1_stage1.svg
[rank1]:	> Counts Sum: 1566, Total Sum: 2475 (63.27%), Ratio(%) per element: [80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 76.36, 76.36, 76.36, 76.36, 76.36, 76.36, 76.36, 76.36, 76.36, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-30 19:32:53,805 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_auto_22_dm1/frozen_ratio_history/rank3/251230_1932_stage3_step600.svg
[rank2]:2025-12-30 19:32:53,814 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_auto_22_dm1/frozen_params_histogram/251230_1932_rank2_stage2.svg
[rank2]:	> Counts Sum: 729, Total Sum: 1980 (36.82%), Ratio(%) per element: [49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-30 19:32:53,937 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_auto_22_dm1/frozen_params_histogram/251230_1932_rank3_stage3.svg
[rank3]:	> Counts Sum: 486, Total Sum: 1595 (30.47%), Ratio(%) per element: [49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-12-30 19:33:37,135 - Freezing Ratio: [Stage0] 0.73, Threshold: 9.6581e-01
[rank1]:2025-12-30 19:33:37,120 - Freezing Ratio: [Stage1] 0.80, Threshold: 2.8223e-01
[rank2]:2025-12-30 19:33:37,131 - Freezing Ratio: [Stage2] 0.75, Threshold: 4.1082e-01
[rank3]:2025-12-30 19:33:37,144 - Freezing Ratio: [Stage3] 0.62, Threshold: 5.4428e-01
[rank0]:2025-12-30 19:34:20,595 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.2753e+00
[rank1]:2025-12-30 19:34:20,579 - Freezing Ratio: [Stage1] 0.80, Threshold: 4.4901e-01
[rank2]:2025-12-30 19:34:20,579 - Freezing Ratio: [Stage2] 0.00, Threshold: 7.0926e-01
[rank3]:2025-12-30 19:34:20,595 - Freezing Ratio: [Stage3] 0.00, Threshold: 5.8194e-01
[rank3]:2025-12-30 19:34:49,385 - Avg. fwd time: 11.0902 / Avg. bwd time: 41.0614 / Avg. batch time: 476.7505 (ms) / GPU bubble ratio: 12.49%
[rank0]:2025-12-30 19:34:49,469 - Avg. fwd time: 9.0623 / Avg. bwd time: 18.3659 / Avg. batch time: 567.0996 (ms) / GPU bubble ratio: 61.31%
[rank1]:2025-12-30 19:34:49,442 - Avg. fwd time: 10.1835 / Avg. bwd time: 16.7338 / Avg. batch time: 535.7422 (ms) / GPU bubble ratio: 59.81%
[rank2]:2025-12-30 19:34:49,417 - Avg. fwd time: 7.4894 / Avg. bwd time: 15.6517 / Avg. batch time: 504.5118 (ms) / GPU bubble ratio: 63.31%
[rank1]:2025-12-30 19:35:08,506 - Freezing Ratio: [Stage1] 0.80, Threshold: 2.1085e+00
[rank2]:2025-12-30 19:35:08,518 - Freezing Ratio: [Stage2] 0.75, Threshold: 6.0311e-01
[rank3]:2025-12-30 19:35:08,530 - Freezing Ratio: [Stage3] 0.62, Threshold: 6.0741e-01
[rank0]:2025-12-30 19:35:08,522 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.4426e+00
[rank0]:2025-12-30 19:35:52,220 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.8041e+00
[rank1]:2025-12-30 19:35:52,205 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.6963e+00
[rank2]:2025-12-30 19:35:52,205 - Freezing Ratio: [Stage2] 0.00, Threshold: 1.7030e+00
[rank3]:2025-12-30 19:35:52,221 - Freezing Ratio: [Stage3] 0.00, Threshold: 9.4118e-01
[rank0]:2025-12-30 19:36:40,266 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-30 19:36:40,272 - Freezing Ratio: [Stage0] 0.73, Threshold: 3.4940e+00
[rank1]:2025-12-30 19:36:40,257 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.0411e+00
[rank2]:2025-12-30 19:36:40,268 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.6838e+00
[rank3]:2025-12-30 19:36:40,281 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.6111e+00
[rank3]:2025-12-30 19:36:44,548 - Avg. fwd time: 11.0890 / Avg. bwd time: 41.0579 / Avg. batch time: 476.7115 (ms) / GPU bubble ratio: 12.49%
[rank0]:2025-12-30 19:36:44,623 - Avg. fwd time: 9.0700 / Avg. bwd time: 18.2991 / Avg. batch time: 566.8580 (ms) / GPU bubble ratio: 61.37%
[rank0]:2025-12-30 19:36:44,646 -  step: 650  loss: -8.0000  grad_norm:  0.0690  memory: 17.08GiB(35.95%)  tps: 7,091  tflops: 55.44  mfu: 17.77%
[rank1]:2025-12-30 19:36:44,595 - Avg. fwd time: 10.1993 / Avg. bwd time: 16.6075 / Avg. batch time: 535.5694 (ms) / GPU bubble ratio: 59.96%
[rank1]:2025-12-30 19:36:44,632 -  step: 650  loss: -8.0000  grad_norm:  0.0690  memory: 15.15GiB(31.89%)  tps: 7,091  tflops: 55.44  mfu: 17.77%
[rank2]:2025-12-30 19:36:44,570 - Avg. fwd time: 7.4888 / Avg. bwd time: 15.6542 / Avg. batch time: 504.4701 (ms) / GPU bubble ratio: 63.30%
[rank2]:2025-12-30 19:36:44,632 -  step: 650  loss: -8.0000  grad_norm:  0.0690  memory: 12.26GiB(25.80%)  tps: 7,092  tflops: 55.44  mfu: 17.77%
[rank3]:2025-12-30 19:36:44,648 -  step: 650  loss:  0.2469  grad_norm:  0.0690  memory: 28.29GiB(59.55%)  tps: 7,092  tflops: 55.44  mfu: 17.77%
[rank0]:2025-12-30 19:37:23,898 - Freezing Ratio: [Stage0] 0.73, Threshold: 2.7644e+00
[rank1]:2025-12-30 19:37:23,883 - Freezing Ratio: [Stage1] 0.80, Threshold: 2.2103e+00
[rank2]:2025-12-30 19:37:23,882 - Freezing Ratio: [Stage2] 0.00, Threshold: 3.6501e+00
[rank3]:2025-12-30 19:37:23,898 - Freezing Ratio: [Stage3] 0.00, Threshold: 3.1307e+00
[rank0]:2025-12-30 19:38:11,821 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.8393e+00
[rank1]:2025-12-30 19:38:11,805 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.4511e+00
[rank2]:2025-12-30 19:38:11,817 - Freezing Ratio: [Stage2] 0.75, Threshold: 7.5369e-01
[rank3]:2025-12-30 19:38:11,830 - Freezing Ratio: [Stage3] 0.62, Threshold: 9.4438e-01
[rank1]:2025-12-30 19:38:38,000 - Avg. fwd time: 10.2142 / Avg. bwd time: 16.4912 / Avg. batch time: 535.0913 (ms) / GPU bubble ratio: 60.07%
[rank2]:2025-12-30 19:38:37,975 - Avg. fwd time: 7.4953 / Avg. bwd time: 15.6067 / Avg. batch time: 504.1122 (ms) / GPU bubble ratio: 63.34%
[rank3]:2025-12-30 19:38:37,952 - Avg. fwd time: 11.0920 / Avg. bwd time: 41.0170 / Avg. batch time: 476.4057 (ms) / GPU bubble ratio: 12.50%
[rank0]:2025-12-30 19:38:38,028 - Avg. fwd time: 9.0776 / Avg. bwd time: 18.2378 / Avg. batch time: 566.3166 (ms) / GPU bubble ratio: 61.41%
[rank0]:2025-12-30 19:38:55,385 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.9916e+00
[rank1]:2025-12-30 19:38:55,369 - Freezing Ratio: [Stage1] 0.80, Threshold: 2.4777e+00
[rank2]:2025-12-30 19:38:55,369 - Freezing Ratio: [Stage2] 0.00, Threshold: 2.5940e+00
[rank3]:2025-12-30 19:38:55,385 - Freezing Ratio: [Stage3] 0.00, Threshold: 2.5018e+00
[rank1]:2025-12-30 19:39:43,399 - Freezing Ratio: [Stage1] 0.80, Threshold: 3.2964e-01
[rank0]:2025-12-30 19:39:43,414 - Freezing Ratio: [Stage0] 0.73, Threshold: 5.9890e-01
[rank2]:2025-12-30 19:39:43,410 - Freezing Ratio: [Stage2] 0.75, Threshold: 3.1478e-01
[rank3]:2025-12-30 19:39:43,426 - Freezing Ratio: [Stage3] 0.62, Threshold: 2.2145e-01
[rank0]:2025-12-30 19:40:26,971 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-30 19:40:26,988 - Freezing Ratio: [Stage0] 0.73, Threshold: 3.0007e+00
[rank1]:2025-12-30 19:40:26,973 - Freezing Ratio: [Stage1] 0.80, Threshold: 5.0370e+00
[rank2]:2025-12-30 19:40:26,972 - Freezing Ratio: [Stage2] 0.00, Threshold: 5.1904e+00
[rank3]:2025-12-30 19:40:26,988 - Freezing Ratio: [Stage3] 0.00, Threshold: 5.2836e+00
[rank3]:2025-12-30 19:40:31,666 - Avg. fwd time: 11.0936 / Avg. bwd time: 40.9858 / Avg. batch time: 476.1675 (ms) / GPU bubble ratio: 12.50%
[rank0]:2025-12-30 19:40:31,752 - Avg. fwd time: 9.0848 / Avg. bwd time: 18.1809 / Avg. batch time: 565.8726 (ms) / GPU bubble ratio: 61.45%
[rank1]:2025-12-30 19:40:31,724 - Avg. fwd time: 10.2281 / Avg. bwd time: 16.3834 / Avg. batch time: 534.7059 (ms) / GPU bubble ratio: 60.19%
[rank2]:2025-12-30 19:40:31,698 - Avg. fwd time: 7.4997 / Avg. bwd time: 15.5750 / Avg. batch time: 503.8380 (ms) / GPU bubble ratio: 63.36%
[rank0]:2025-12-30 19:40:31,775 -  step: 700  loss: -8.0000  grad_norm:  0.0934  memory: 17.08GiB(35.95%)  tps: 7,214  tflops: 56.39  mfu: 18.07%
[rank0]:2025-12-30 19:40:31,837 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_auto_22_dm1/frozen_ratio_history/rank0/251230_1940_stage0_step700.svg
[rank1]:2025-12-30 19:40:31,761 -  step: 700  loss: -8.0000  grad_norm:  0.0934  memory: 15.15GiB(31.89%)  tps: 7,214  tflops: 56.39  mfu: 18.07%
[rank1]:2025-12-30 19:40:31,839 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_auto_22_dm1/frozen_ratio_history/rank1/251230_1940_stage1_step700.svg
[rank2]:2025-12-30 19:40:31,771 -  step: 700  loss: -8.0000  grad_norm:  0.0934  memory: 12.26GiB(25.80%)  tps: 7,213  tflops: 56.39  mfu: 18.07%
[rank2]:2025-12-30 19:40:31,837 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_auto_22_dm1/frozen_ratio_history/rank2/251230_1940_stage2_step700.svg
[rank3]:2025-12-30 19:40:31,783 -  step: 700  loss:  0.2111  grad_norm:  0.0934  memory: 28.29GiB(59.55%)  tps: 7,213  tflops: 56.39  mfu: 18.07%
[rank3]:2025-12-30 19:40:31,920 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_GPipe_auto_22_dm1/pipeline_schedule/251230_1940_step700_rank3.svg
[rank3]:			> Batch Time: 532.70 ms, GPU Bubble Ratio: 60.93%, 63.80%, 71.20%, 25.70%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-36ms      | [S0,MB4,F]  36-9-46ms      | [S0,MB5,F]  46-9-55ms      | [S0,MB6,F]  55-9-65ms      | [S0,MB7,F]  65-9-74ms      | [S0,MB0,B]  252-16-269ms   | [S0,MB1,B]  290-16-306ms   | [S0,MB2,B]  328-16-344ms   | [S0,MB3,B]  367-16-383ms   | [S0,MB4,B]  405-16-421ms   | [S0,MB5,B]  442-16-458ms   | [S0,MB6,B]  481-16-497ms   | [S0,MB7,B]  516-16-532ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-10-20ms      | [S1,MB1,F]  23-10-34ms     | [S1,MB2,F]  37-10-47ms     | [S1,MB3,F]  56-10-66ms     | [S1,MB4,F]  75-10-85ms     | [S1,MB5,F]  93-10-104ms    | [S1,MB6,F]  112-10-123ms   | [S1,MB7,F]  131-10-141ms   | [S1,MB0,B]  236-13-249ms   | [S1,MB1,B]  273-13-286ms   | [S1,MB2,B]  311-13-324ms   | [S1,MB3,B]  350-13-363ms   | [S1,MB4,B]  388-13-401ms   | [S1,MB5,B]  425-13-438ms   | [S1,MB6,B]  464-13-477ms   | [S1,MB7,B]  499-13-512ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  34-8-42ms      | [S2,MB2,F]  53-8-61ms      | [S2,MB3,F]  71-8-79ms      | [S2,MB4,F]  90-8-98ms      | [S2,MB5,F]  109-8-117ms    | [S2,MB6,F]  128-8-136ms    | [S2,MB7,F]  147-8-155ms    | [S2,MB0,B]  221-11-232ms   | [S2,MB1,B]  258-11-269ms   | [S2,MB2,B]  296-11-307ms   | [S2,MB3,B]  336-11-347ms   | [S2,MB4,B]  373-11-384ms   | [S2,MB5,B]  411-11-422ms   | [S2,MB6,B]  449-11-460ms   | [S2,MB7,B]  485-11-496ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  50-11-61ms     | [S3,MB2,F]  68-11-79ms     | [S3,MB3,F]  87-11-98ms     | [S3,MB4,F]  106-11-117ms   | [S3,MB5,F]  125-11-136ms   | [S3,MB6,F]  144-11-155ms   | [S3,MB7,F]  162-11-174ms   | [S3,MB0,B]  180-34-214ms   | [S3,MB1,B]  214-36-251ms   | [S3,MB2,B]  251-38-290ms   | [S3,MB3,B]  290-38-328ms   | [S3,MB4,B]  329-38-367ms   | [S3,MB5,B]  367-38-405ms   | [S3,MB6,B]  404-39-443ms   | [S3,MB7,B]  443-39-482ms  
[rank3]:2025-12-30 19:40:31,967 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_auto_22_dm1/frozen_ratio_history/rank3/251230_1940_stage3_step700.svg
[rank0]:2025-12-30 19:40:32,000 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_auto_22_dm1/frozen_params_histogram/251230_1940_rank0_stage0.svg
[rank0]:	> Counts Sum: 1575, Total Sum: 2405 (65.49%), Ratio(%) per element: [0.0, 96.92, 96.92, 96.92, 96.92, 96.92, 96.92, 96.92, 96.92, 96.92, 96.92, 96.92, 96.92, 96.92, 96.92, 96.92, 96.92, 96.92, 96.92, 75.38, 75.38, 75.38, 75.38, 75.38, 75.38, 75.38, 75.38, 75.38, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-12-30 19:40:31,981 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_auto_22_dm1/frozen_params_histogram/251230_1940_rank1_stage1.svg
[rank1]:	> Counts Sum: 1926, Total Sum: 2925 (65.85%), Ratio(%) per element: [83.07, 83.07, 83.07, 83.07, 83.07, 83.07, 83.07, 83.07, 83.07, 83.07, 83.07, 83.07, 83.07, 83.07, 83.07, 83.07, 83.07, 83.07, 83.07, 83.07, 83.07, 83.07, 83.07, 83.07, 83.07, 83.07, 83.07, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-12-30 19:40:31,998 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_auto_22_dm1/frozen_params_histogram/251230_1940_rank2_stage2.svg
[rank2]:	> Counts Sum: 864, Total Sum: 2340 (36.92%), Ratio(%) per element: [49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-30 19:40:32,097 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_auto_22_dm1/frozen_params_histogram/251230_1940_rank3_stage3.svg
[rank3]:	> Counts Sum: 576, Total Sum: 1885 (30.56%), Ratio(%) per element: [49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-12-30 19:41:15,152 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.2776e+00
[rank1]:2025-12-30 19:41:15,137 - Freezing Ratio: [Stage1] 0.80, Threshold: 3.5479e-01
[rank2]:2025-12-30 19:41:15,148 - Freezing Ratio: [Stage2] 0.75, Threshold: 4.3392e-01
[rank3]:2025-12-30 19:41:15,160 - Freezing Ratio: [Stage3] 0.62, Threshold: 4.8687e-01
[rank1]:2025-12-30 19:41:58,759 - Freezing Ratio: [Stage1] 0.80, Threshold: 2.2727e-01
[rank2]:2025-12-30 19:41:58,759 - Freezing Ratio: [Stage2] 0.00, Threshold: 1.3972e-01
[rank3]:2025-12-30 19:41:58,774 - Freezing Ratio: [Stage3] 0.00, Threshold: 6.8905e-01
[rank0]:2025-12-30 19:41:58,774 - Freezing Ratio: [Stage0] 0.73, Threshold: 4.9998e-01
[rank2]:2025-12-30 19:42:27,416 - Avg. fwd time: 7.4970 / Avg. bwd time: 15.5914 / Avg. batch time: 503.8916 (ms) / GPU bubble ratio: 63.34%
[rank3]:2025-12-30 19:42:27,383 - Avg. fwd time: 11.0909 / Avg. bwd time: 40.9926 / Avg. batch time: 476.1988 (ms) / GPU bubble ratio: 12.50%
[rank0]:2025-12-30 19:42:27,471 - Avg. fwd time: 9.0916 / Avg. bwd time: 18.1277 / Avg. batch time: 565.7688 (ms) / GPU bubble ratio: 61.51%
[rank1]:2025-12-30 19:42:27,442 - Avg. fwd time: 10.2409 / Avg. bwd time: 16.2823 / Avg. batch time: 534.6550 (ms) / GPU bubble ratio: 60.31%
[rank0]:2025-12-30 19:42:46,785 - Freezing Ratio: [Stage0] 0.73, Threshold: 8.1712e-01
[rank1]:2025-12-30 19:42:46,770 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.3770e+00
[rank2]:2025-12-30 19:42:46,782 - Freezing Ratio: [Stage2] 0.75, Threshold: 3.5590e-01
[rank3]:2025-12-30 19:42:46,793 - Freezing Ratio: [Stage3] 0.62, Threshold: 4.8671e-01
[rank1]:2025-12-30 19:43:30,485 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.2120e+00
[rank2]:2025-12-30 19:43:30,485 - Freezing Ratio: [Stage2] 0.00, Threshold: 2.7128e+00
[rank3]:2025-12-30 19:43:30,504 - Freezing Ratio: [Stage3] 0.00, Threshold: 2.5311e+00
[rank0]:2025-12-30 19:43:30,500 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.8484e+00
[rank1]:2025-12-30 19:44:18,386 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.8428e+00
[rank0]:2025-12-30 19:44:18,394 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-30 19:44:18,401 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.9726e+00
[rank2]:2025-12-30 19:44:18,398 - Freezing Ratio: [Stage2] 0.75, Threshold: 5.0508e-01
[rank3]:2025-12-30 19:44:18,411 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.4820e+00
[rank2]:2025-12-30 19:44:22,745 - Avg. fwd time: 7.4962 / Avg. bwd time: 15.5954 / Avg. batch time: 503.9047 (ms) / GPU bubble ratio: 63.34%
[rank3]:2025-12-30 19:44:22,721 - Avg. fwd time: 11.0899 / Avg. bwd time: 40.9953 / Avg. batch time: 476.2118 (ms) / GPU bubble ratio: 12.50%
[rank1]:2025-12-30 19:44:22,770 - Avg. fwd time: 10.2529 / Avg. bwd time: 16.1881 / Avg. batch time: 534.5704 (ms) / GPU bubble ratio: 60.43%
[rank1]:2025-12-30 19:44:22,808 -  step: 750  loss: -8.0000  grad_norm:  0.0851  memory: 15.15GiB(31.89%)  tps: 7,091  tflops: 55.44  mfu: 17.77%
[rank0]:2025-12-30 19:44:22,799 - Avg. fwd time: 9.0976 / Avg. bwd time: 18.0779 / Avg. batch time: 565.6331 (ms) / GPU bubble ratio: 61.56%
[rank0]:2025-12-30 19:44:22,822 -  step: 750  loss: -8.0000  grad_norm:  0.0851  memory: 17.08GiB(35.95%)  tps: 7,091  tflops: 55.44  mfu: 17.77%
[rank2]:2025-12-30 19:44:22,808 -  step: 750  loss: -8.0000  grad_norm:  0.0851  memory: 12.26GiB(25.80%)  tps: 7,092  tflops: 55.44  mfu: 17.77%
[rank3]:2025-12-30 19:44:22,825 -  step: 750  loss:  0.2552  grad_norm:  0.0851  memory: 28.29GiB(59.55%)  tps: 7,091  tflops: 55.44  mfu: 17.77%
[rank1]:2025-12-30 19:45:02,136 - Freezing Ratio: [Stage1] 0.80, Threshold: 7.2879e-01
[rank0]:2025-12-30 19:45:02,151 - Freezing Ratio: [Stage0] 0.73, Threshold: 7.0995e-01
[rank2]:2025-12-30 19:45:02,136 - Freezing Ratio: [Stage2] 0.00, Threshold: 9.7275e-01
[rank3]:2025-12-30 19:45:02,151 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.3051e+00
[rank1]:2025-12-30 19:45:50,281 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.7146e+00
[rank2]:2025-12-30 19:45:50,292 - Freezing Ratio: [Stage2] 0.75, Threshold: 3.8535e-01
[rank3]:2025-12-30 19:45:50,305 - Freezing Ratio: [Stage3] 0.62, Threshold: 7.9345e-01
[rank0]:2025-12-30 19:45:50,296 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.3162e+00
[rank1]:2025-12-30 19:46:16,424 - Avg. fwd time: 10.2642 / Avg. bwd time: 16.1004 / Avg. batch time: 534.2175 (ms) / GPU bubble ratio: 60.52%
[rank2]:2025-12-30 19:46:16,398 - Avg. fwd time: 7.5015 / Avg. bwd time: 15.5555 / Avg. batch time: 503.6421 (ms) / GPU bubble ratio: 63.38%
[rank3]:2025-12-30 19:46:16,373 - Avg. fwd time: 11.0927 / Avg. bwd time: 40.9652 / Avg. batch time: 475.9929 (ms) / GPU bubble ratio: 12.51%
[rank0]:2025-12-30 19:46:16,453 - Avg. fwd time: 9.1035 / Avg. bwd time: 18.0314 / Avg. batch time: 565.2336 (ms) / GPU bubble ratio: 61.59%
[rank2]:2025-12-30 19:46:33,952 - Freezing Ratio: [Stage2] 0.00, Threshold: 2.2143e+00
[rank3]:2025-12-30 19:46:33,968 - Freezing Ratio: [Stage3] 0.00, Threshold: 2.6871e+00
[rank1]:2025-12-30 19:46:33,952 - Freezing Ratio: [Stage1] 0.80, Threshold: 2.9685e+00
[rank0]:2025-12-30 19:46:33,967 - Freezing Ratio: [Stage0] 0.73, Threshold: 2.5443e+00
[rank1]:2025-12-30 19:47:21,911 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.3967e+00
[rank0]:2025-12-30 19:47:21,926 - Freezing Ratio: [Stage0] 0.73, Threshold: 5.1526e-01
[rank2]:2025-12-30 19:47:21,922 - Freezing Ratio: [Stage2] 0.75, Threshold: 2.4343e-01
[rank3]:2025-12-30 19:47:21,939 - Freezing Ratio: [Stage3] 0.62, Threshold: 4.8790e-01
[rank0]:2025-12-30 19:48:05,563 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-30 19:48:05,565 - Freezing Ratio: [Stage2] 0.00, Threshold: 1.9235e+00
[rank1]:2025-12-30 19:48:05,565 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.8684e+00
[rank3]:2025-12-30 19:48:05,586 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.7152e+00
[rank0]:2025-12-30 19:48:05,580 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.0470e+00
[rank3]:2025-12-30 19:48:10,400 - Avg. fwd time: 11.0946 / Avg. bwd time: 40.9448 / Avg. batch time: 475.8423 (ms) / GPU bubble ratio: 12.51%
[rank1]:2025-12-30 19:48:10,459 - Avg. fwd time: 10.2751 / Avg. bwd time: 16.0182 / Avg. batch time: 533.9536 (ms) / GPU bubble ratio: 60.61%
[rank2]:2025-12-30 19:48:10,433 - Avg. fwd time: 7.5053 / Avg. bwd time: 15.5288 / Avg. batch time: 503.4623 (ms) / GPU bubble ratio: 63.40%
[rank0]:2025-12-30 19:48:10,489 - Avg. fwd time: 9.1091 / Avg. bwd time: 17.9880 / Avg. batch time: 564.9252 (ms) / GPU bubble ratio: 61.63%
[rank0]:2025-12-30 19:48:10,512 -  step: 800  loss: -8.0000  grad_norm:  0.0986  memory: 17.08GiB(35.95%)  tps: 7,196  tflops: 56.25  mfu: 18.03%
[rank0]:2025-12-30 19:48:10,512 - â„¹ï¸ final step: 800  loss: -8.0000  grad_norm:  0.0986  tps: 7,489  tflops: 58.54  mfu: 17.12%
[rank0]:2025-12-30 19:48:10,513 - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-12-30 19:48:10,513 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank2]:2025-12-30 19:48:10,508 -  step: 800  loss: -8.0000  grad_norm:  0.0986  memory: 12.26GiB(25.80%)  tps: 7,195  tflops: 56.25  mfu: 18.03%
[rank1]:2025-12-30 19:48:10,498 -  step: 800  loss: -8.0000  grad_norm:  0.0986  memory: 15.15GiB(31.89%)  tps: 7,196  tflops: 56.25  mfu: 18.03%
[rank2]:2025-12-30 19:48:10,508 - â„¹ï¸ final step: 800  loss: -8.0000  grad_norm:  0.0986  tps: 7,490  tflops: 58.55  mfu: 17.14%
[rank2]:2025-12-30 19:48:10,508 - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-12-30 19:48:10,498 - â„¹ï¸ final step: 800  loss: -8.0000  grad_norm:  0.0986  tps: 7,489  tflops: 58.55  mfu: 17.13%
[rank1]:2025-12-30 19:48:10,498 - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-12-30 19:48:10,499 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank2]:2025-12-30 19:48:10,509 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank3]:2025-12-30 19:48:10,521 -  step: 800  loss:  0.2515  grad_norm:  0.0986  memory: 28.29GiB(59.55%)  tps: 7,196  tflops: 56.25  mfu: 18.03%
[rank3]:2025-12-30 19:48:10,522 - â„¹ï¸ final step: 800  loss:  0.2515  grad_norm:  0.0986  tps: 7,493  tflops: 58.58  mfu: 17.24%
[rank3]:2025-12-30 19:48:10,522 - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-12-30 19:48:10,523 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-30 19:48:12,517 - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-12-30 19:48:12,589 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_auto_22_dm1/frozen_ratio_history/rank0/251230_1948_stage0_final800.svg
[rank1]:2025-12-30 19:48:12,591 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_auto_22_dm1/frozen_ratio_history/rank1/251230_1948_stage1_final800.svg
[rank2]:2025-12-30 19:48:12,589 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_auto_22_dm1/frozen_ratio_history/rank2/251230_1948_stage2_final800.svg
[rank3]:2025-12-30 19:48:12,674 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_GPipe_auto_22_dm1/pipeline_schedule/251230_1948_final800_rank3.svg
[rank3]:			> Batch Time: 576.22 ms, GPU Bubble Ratio: 63.99%, 66.61%, 63.99%, 26.72%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-36ms      | [S0,MB4,F]  36-9-45ms      | [S0,MB5,F]  45-8-54ms      | [S0,MB6,F]  54-9-64ms      | [S0,MB7,F]  64-9-73ms      | [S0,MB0,B]  259-16-276ms   | [S0,MB1,B]  301-16-317ms   | [S0,MB2,B]  343-16-359ms   | [S0,MB3,B]  386-16-402ms   | [S0,MB4,B]  429-16-446ms   | [S0,MB5,B]  473-16-490ms   | [S0,MB6,B]  518-16-534ms   | [S0,MB7,B]  559-16-576ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-10-20ms      | [S1,MB1,F]  23-10-34ms     | [S1,MB2,F]  37-10-47ms     | [S1,MB3,F]  56-10-66ms     | [S1,MB4,F]  74-10-85ms     | [S1,MB5,F]  92-10-103ms    | [S1,MB6,F]  111-10-121ms   | [S1,MB7,F]  129-10-140ms   | [S1,MB0,B]  238-13-252ms   | [S1,MB1,B]  282-13-295ms   | [S1,MB2,B]  324-13-338ms   | [S1,MB3,B]  368-13-382ms   | [S1,MB4,B]  412-13-425ms   | [S1,MB5,B]  456-13-469ms   | [S1,MB6,B]  500-13-514ms   | [S1,MB7,B]  542-13-555ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  34-6-40ms      | [S2,MB2,F]  53-7-60ms      | [S2,MB3,F]  71-6-78ms      | [S2,MB4,F]  89-6-96ms      | [S2,MB5,F]  108-6-114ms    | [S2,MB6,F]  126-6-133ms    | [S2,MB7,F]  145-6-151ms    | [S2,MB0,B]  221-16-237ms   | [S2,MB1,B]  261-19-280ms   | [S2,MB2,B]  303-19-322ms   | [S2,MB3,B]  345-19-365ms   | [S2,MB4,B]  389-19-409ms   | [S2,MB5,B]  433-19-453ms   | [S2,MB6,B]  477-19-497ms   | [S2,MB7,B]  519-19-538ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  50-10-60ms     | [S3,MB2,F]  68-10-78ms     | [S3,MB3,F]  86-10-97ms     | [S3,MB4,F]  104-10-115ms   | [S3,MB5,F]  123-10-134ms   | [S3,MB6,F]  142-10-153ms   | [S3,MB7,F]  160-11-171ms   | [S3,MB0,B]  177-35-212ms   | [S3,MB1,B]  214-40-255ms   | [S3,MB2,B]  254-41-296ms   | [S3,MB3,B]  296-42-338ms   | [S3,MB4,B]  339-43-382ms   | [S3,MB5,B]  382-43-426ms   | [S3,MB6,B]  426-43-470ms   | [S3,MB7,B]  471-43-514ms  
[rank0]:2025-12-30 19:48:12,740 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_auto_22_dm1/frozen_params_histogram/251230_1948_rank0_stage0.svg
[rank0]:	> Counts Sum: 1845, Total Sum: 2775 (66.49%), Ratio(%) per element: [0.0, 97.33, 97.33, 97.33, 97.33, 97.33, 97.33, 97.33, 97.33, 97.33, 97.33, 97.33, 97.33, 97.33, 97.33, 97.33, 97.33, 97.33, 97.33, 78.66, 78.66, 78.66, 78.66, 78.66, 78.66, 78.66, 78.66, 78.66, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-12-30 19:48:12,740 - Sleeping 2 seconds for other ranks to complete
[rank1]:2025-12-30 19:48:12,735 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_auto_22_dm1/frozen_params_histogram/251230_1948_rank1_stage1.svg
[rank1]:	> Counts Sum: 2286, Total Sum: 3375 (67.73%), Ratio(%) per element: [85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 82.66, 82.66, 82.66, 82.66, 82.66, 82.66, 82.66, 82.66, 82.66, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-12-30 19:48:12,735 - Destroying the purge thread.
[rank2]:2025-12-30 19:48:12,739 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_auto_22_dm1/frozen_params_histogram/251230_1948_rank2_stage2.svg
[rank2]:	> Counts Sum: 999, Total Sum: 2700 (37.00%), Ratio(%) per element: [49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-12-30 19:48:12,739 - Destroying the purge thread.
[rank1]:2025-12-30 19:48:12,849 - Process group destroyed
[rank2]:2025-12-30 19:48:12,886 - Process group destroyed
[rank3]:2025-12-30 19:48:12,816 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_GPipe_auto_22_dm1/pipeline_schedule/251230_1948_thry_final800_rank3.svg
[rank3]:			> Batch Time: 312.98 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-18ms       | [S0,MB2,F]  18-9-28ms      | [S0,MB3,F]  28-9-37ms      | [S0,MB4,F]  37-9-47ms      | [S0,MB5,F]  47-9-56ms      | [S0,MB6,F]  56-9-66ms      | [S0,MB7,F]  66-9-75ms      | [S0,MB0,B]  161-18-180ms   | [S0,MB1,B]  180-18-199ms   | [S0,MB2,B]  199-18-218ms   | [S0,MB3,B]  218-18-237ms   | [S0,MB4,B]  237-18-256ms   | [S0,MB5,B]  256-18-275ms   | [S0,MB6,B]  275-18-294ms   | [S0,MB7,B]  294-18-312ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-9-18ms       | [S1,MB1,F]  18-9-28ms      | [S1,MB2,F]  28-9-37ms      | [S1,MB3,F]  37-9-47ms      | [S1,MB4,F]  47-9-56ms      | [S1,MB5,F]  56-9-66ms      | [S1,MB6,F]  66-9-75ms      | [S1,MB7,F]  75-9-85ms      | [S1,MB0,B]  142-18-161ms   | [S1,MB1,B]  161-18-180ms   | [S1,MB2,B]  180-18-199ms   | [S1,MB3,B]  199-18-218ms   | [S1,MB4,B]  218-18-237ms   | [S1,MB5,B]  237-18-256ms   | [S1,MB6,B]  256-18-275ms   | [S1,MB7,B]  275-18-294ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  18-9-28ms      | [S2,MB1,F]  28-9-37ms      | [S2,MB2,F]  37-9-47ms      | [S2,MB3,F]  47-9-56ms      | [S2,MB4,F]  56-9-66ms      | [S2,MB5,F]  66-9-75ms      | [S2,MB6,F]  75-9-85ms      | [S2,MB7,F]  85-9-94ms      | [S2,MB0,B]  123-18-142ms   | [S2,MB1,B]  142-18-161ms   | [S2,MB2,B]  161-18-180ms   | [S2,MB3,B]  180-18-199ms   | [S2,MB4,B]  199-18-218ms   | [S2,MB5,B]  218-18-237ms   | [S2,MB6,B]  237-18-256ms   | [S2,MB7,B]  256-18-275ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-9-37ms      | [S3,MB1,F]  37-9-47ms      | [S3,MB2,F]  47-9-56ms      | [S3,MB3,F]  56-9-66ms      | [S3,MB4,F]  66-9-75ms      | [S3,MB5,F]  75-9-85ms      | [S3,MB6,F]  85-9-94ms      | [S3,MB7,F]  94-9-104ms     | [S3,MB0,B]  104-18-123ms   | [S3,MB1,B]  123-18-142ms   | [S3,MB2,B]  142-18-161ms   | [S3,MB3,B]  161-18-180ms   | [S3,MB4,B]  180-18-199ms   | [S3,MB5,B]  199-18-218ms   | [S3,MB6,B]  218-18-237ms   | [S3,MB7,B]  237-18-256ms  
[rank3]:2025-12-30 19:48:12,864 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_auto_22_dm1/frozen_ratio_history/rank3/251230_1948_stage3_final800.svg
[rank3]:2025-12-30 19:48:13,045 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_auto_22_dm1/frozen_params_histogram/251230_1948_rank3_stage3.svg
[rank3]:	> Counts Sum: 666, Total Sum: 2175 (30.62%), Ratio(%) per element: [49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-30 19:48:13,046 - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–ˆâ–‡â–„â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–ˆâ–‡â–„â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 4.3731
[rank3]:wandb:               final/avg_loss 0.25149
[rank3]:wandb:             final/avg_mfu(%) 17.24003
[rank3]:wandb:             final/avg_tflops 58.57747
[rank3]:wandb:    final/avg_throughput(tps) 7493.0824
[rank3]:wandb:              final/grad_norm 0.09863
[rank3]:wandb:               final/max_loss 0.25149
[rank3]:wandb:                    grad_norm 0.09863
[rank3]:wandb: loss_metrics/global_avg_loss 0.25149
[rank3]:wandb: loss_metrics/global_max_loss 0.25149
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1230_GPipe_auto_22_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/h8ylriih
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1230_GPipe_auto_22_dm1/20251230-1846/wandb/run-20251230_184612-h8ylriih/logs
[rank3]:2025-12-30 19:48:14,392 - Process group destroyed
[rank0]:2025-12-30 19:48:14,741 - Training completed
[rank0]:2025-12-30 19:48:14,741 - Destroying the purge thread.
[rank0]:2025-12-30 19:48:14,965 - Process group destroyed
[rank0]:Stage 0: Modules to keep: {'tok_embeddings', 'layers.3', 'layers.0', 'layers.2', 'layers.1'}
[rank1]:Stage 1: Modules to keep: {'layers.8', 'layers.6', 'layers.7', 'layers.4', 'layers.5'}
[rank2]:Stage 2: Modules to keep: {'layers.12', 'layers.11', 'layers.10', 'layers.9'}
[rank3]:Stage 3: Modules to keep: {'layers.15', 'layers.13', 'output', 'layers.14', 'norm'}
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1230.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:1227: everything same as 1224 but seed=42->11
[rank3]:1230: everything same as 1224 but seed=42->22
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1230_GPipe_auto_22_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1230_GPipe_auto_22_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1230_GPipe_auto_22_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1230_GPipe_auto_22_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1230_GPipe_auto_22_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1230_GPipe_auto_22_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 22
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: GPipe
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1230_GPipe_auto_22_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1230_GPipe_auto_22_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: auto
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.01
[rank3]:		- percentile: 80
[rank3]:
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
