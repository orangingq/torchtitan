
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 12. 31. (ìˆ˜) 06:20:07 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 3,4,5,6
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/1230_Interleaved1F1B_auto_22.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
1227: everything same as 1224 but seed=42->11
1230: everything same as 1224 but seed=42->22

âœ”ï¸Running with auto x Interleaved1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1230.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
1227: everything same as 1224 but seed=42->11
1230: everything same as 1224 but seed=42->22
" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=auto --freezing.threshold=0.01 --freezing.percentile=80 --freezing.max_freeze_ratio=0.8
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank2]:2025-12-31 06:20:13,408 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank2]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank2]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank2]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank2]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank2]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank2]:1227: everything same as 1224 but seed=42->11
[rank2]:1230: everything same as 1224 but seed=42->22
[rank2]:"
[rank3]:2025-12-31 06:20:13,408 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:1227: everything same as 1224 but seed=42->11
[rank3]:1230: everything same as 1224 but seed=42->22
[rank3]:"
[rank0]:2025-12-31 06:20:13,545 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank0]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank0]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank0]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank0]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank0]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank0]:1227: everything same as 1224 but seed=42->11
[rank0]:1230: everything same as 1224 but seed=42->22
[rank0]:"
[rank1]:2025-12-31 06:20:13,649 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank1]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank1]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank1]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank1]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank1]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank1]:1227: everything same as 1224 but seed=42->11
[rank1]:1230: everything same as 1224 but seed=42->22
[rank1]:"
[rank2]:2025-12-31 06:20:13,616 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-12-31 06:20:13,618 - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-12-31 06:20:13,622 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-12-31 06:20:13,624 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-31 06:20:13,730 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-12-31 06:20:13,733 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-31 06:20:13,737 - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-12-31 06:20:13,739 - Loading tokenizer from tokenizer.json
[rank1]:2025-12-31 06:20:13,833 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-12-31 06:20:13,835 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-31 06:20:14,131 - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank2]:2025-12-31 06:20:16,972 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-12-31 06:20:17,010 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-31 06:20:16,939 - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank2]:2025-12-31 06:20:17,037 - PP rank 2 is building stage_idx 2 with modules ['layers.5', 'layers.6']
[rank2]:2025-12-31 06:20:17,050 - PP rank 2 is building stage_idx 6 with modules ['layers.13', 'layers.14']
[rank2]:2025-12-31 06:20:17,051 - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank0]:2025-12-31 06:20:17,085 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-12-31 06:20:17,123 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-31 06:20:17,124 - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-12-31 06:20:17,150 - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1']
[rank0]:2025-12-31 06:20:17,162 - PP rank 0 is building stage_idx 4 with modules ['layers.9', 'layers.10']
[rank0]:2025-12-31 06:20:17,164 - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank2]:2025-12-31 06:20:17,240 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-31 06:20:17,240 - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-12-31 06:20:17,241 - CUDA memory usage for model: 0.92GiB(1.94%)
[rank0]:2025-12-31 06:20:17,352 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-31 06:20:17,353 - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-12-31 06:20:17,353 - CUDA memory usage for model: 1.90GiB(3.99%)
[rank1]:2025-12-31 06:20:17,639 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-12-31 06:20:17,678 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-31 06:20:17,705 - PP rank 1 is building stage_idx 1 with modules ['layers.2', 'layers.3', 'layers.4']
[rank1]:2025-12-31 06:20:17,718 - PP rank 1 is building stage_idx 5 with modules ['layers.11', 'layers.12']
[rank1]:2025-12-31 06:20:17,720 - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank1]:2025-12-31 06:20:17,907 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-31 06:20:17,907 - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-12-31 06:20:17,908 - CUDA memory usage for model: 1.13GiB(2.39%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run rnf7z9wr
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1230_Interleaved1F1B_auto_22_dm1/20251231-0620/wandb/run-20251231_062018-rnf7z9wr
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1230_Interleaved1F1B_auto_22_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/rnf7z9wr
[rank3]:2025-12-31 06:20:19,367 - WandB logging enabled
[rank3]:2025-12-31 06:20:19,368 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-12-31 06:20:19,405 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-31 06:20:19,432 - PP rank 3 is building stage_idx 3 with modules ['layers.7', 'layers.8']
[rank3]:2025-12-31 06:20:19,446 - PP rank 3 is building stage_idx 7 with modules ['layers.15', 'norm', 'output']
[rank3]:2025-12-31 06:20:19,447 - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank0]:2025-12-31 06:20:19,653 - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1230_Interleaved1F1B_auto_22_dm1
[rank0]:2025-12-31 06:20:19,653 - Mixed precision training with TP or PP is handled by autocast
[rank1]:2025-12-31 06:20:19,653 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-31 06:20:19,654 - Trainer is initialized with local batch size 32, global batch size 128, gradient accumulation steps 4, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2025-12-31 06:20:19,654 - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank3]:2025-12-31 06:20:19,636 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-31 06:20:19,653 - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-12-31 06:20:19,637 - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-12-31 06:20:19,638 - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2025-12-31 06:20:19,653 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-31 06:20:21,985 - [GC] GC collection for checkpoint loading. 0.01 seconds
[rank0]:2025-12-31 06:20:21,985 - Finished loading the checkpoint in 2.33 seconds.
[rank0]:2025-12-31 06:20:21,986 - Training starts at step 1
[rank0]:2025-12-31 06:20:27,582 -  step:  1  loss: -4.0000  grad_norm: 203.0661  memory: 16.58GiB(34.89%)  tps: 3,133  tflops: 24.49  mfu: 7.85%
[rank0]:2025-12-31 06:20:27,582 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-12-31 06:20:27,556 -  step:  1  loss: -4.0000  grad_norm: 203.0661  memory: 16.23GiB(34.16%)  tps: 3,317  tflops: 25.93  mfu: 8.31%
[rank1]:2025-12-31 06:20:27,556 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-12-31 06:20:27,558 -  step:  1  loss: 10.6092  grad_norm: 203.0661  memory: 25.52GiB(53.71%)  tps: 4,020  tflops: 31.43  mfu: 10.07%
[rank2]:2025-12-31 06:20:27,546 -  step:  1  loss: -4.0000  grad_norm: 203.0661  memory: 10.24GiB(21.56%)  tps: 3,110  tflops: 24.31  mfu: 7.79%
[rank2]:2025-12-31 06:20:27,546 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-12-31 06:20:27,559 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-31 06:24:32,588 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-31 06:24:37,511 - Avg. fwd time: 14.3130 / Avg. bwd time: 40.3130 / Avg. batch time: 1089.0458 (ms) / GPU bubble ratio: 19.74%
[rank2]:2025-12-31 06:24:37,560 - Avg. fwd time: 7.7333 / Avg. bwd time: 18.7249 / Avg. batch time: 1149.6938 (ms) / GPU bubble ratio: 63.18%
[rank0]:2025-12-31 06:24:37,638 - Avg. fwd time: 8.3051 / Avg. bwd time: 21.2234 / Avg. batch time: 1247.9738 (ms) / GPU bubble ratio: 62.14%
[rank2]:2025-12-31 06:24:37,659 -  step: 50  loss: -4.0000  grad_norm: 24.3418  memory: 12.06GiB(25.39%)  tps: 6,420  tflops: 50.19  mfu: 16.09%
[rank1]:2025-12-31 06:24:37,606 - Avg. fwd time: 9.8017 / Avg. bwd time: 24.0385 / Avg. batch time: 1209.1397 (ms) / GPU bubble ratio: 55.22%
[rank1]:2025-12-31 06:24:37,663 -  step: 50  loss: -4.0000  grad_norm: 24.3418  memory: 18.49GiB(38.93%)  tps: 6,420  tflops: 50.19  mfu: 16.09%
[rank3]:2025-12-31 06:24:37,671 -  step: 50  loss:  9.8911  grad_norm: 24.3418  memory: 29.23GiB(61.52%)  tps: 6,420  tflops: 50.19  mfu: 16.09%
[rank0]:2025-12-31 06:24:37,674 -  step: 50  loss: -4.0000  grad_norm: 24.3418  memory: 20.42GiB(42.99%)  tps: 6,420  tflops: 50.19  mfu: 16.09%
[rank0]:2025-12-31 06:25:23,754 - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 0.0000e+00
[rank3]:2025-12-31 06:25:23,748 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 0.0000e+00
[rank2]:2025-12-31 06:25:23,736 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 0.0000e+00
[rank1]:2025-12-31 06:25:23,741 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 0.0000e+00
[rank2]:2025-12-31 06:26:14,890 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 2.0375e+00
[rank0]:2025-12-31 06:26:14,906 - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 5.0253e+00
[rank3]:2025-12-31 06:26:14,902 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 1.8152e+00
[rank1]:2025-12-31 06:26:14,895 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 1.9855e+00
[rank0]:2025-12-31 06:27:04,503 - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 3.8315e+00
[rank2]:2025-12-31 06:27:04,474 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 1.1033e+00
[rank3]:2025-12-31 06:27:04,489 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 3.0194e+00
[rank1]:2025-12-31 06:27:04,490 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 2.2033e+00
[rank0]:2025-12-31 06:27:55,732 - Freezing Ratio: [Stage0] 0.47, [Stage4] 0.00, Threshold: 5.2248e+00
[rank2]:2025-12-31 06:27:55,716 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 8.6658e-01
[rank1]:2025-12-31 06:27:55,720 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 9.4702e+00
[rank3]:2025-12-31 06:27:55,728 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 4.8377e+00
[rank2]:2025-12-31 06:28:44,853 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 2.9696e+00
[rank0]:2025-12-31 06:28:44,849 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-31 06:28:44,869 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 2.1373e+00
[rank1]:2025-12-31 06:28:44,870 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 2.9899e+00
[rank0]:2025-12-31 06:28:44,876 - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 3.8822e+00
[rank2]:2025-12-31 06:28:49,846 - Avg. fwd time: 7.7934 / Avg. bwd time: 17.4045 / Avg. batch time: 1141.2302 (ms) / GPU bubble ratio: 64.67%
[rank3]:2025-12-31 06:28:49,797 - Avg. fwd time: 14.3862 / Avg. bwd time: 39.2253 / Avg. batch time: 1080.2890 (ms) / GPU bubble ratio: 20.60%
[rank2]:2025-12-31 06:28:49,952 -  step: 100  loss: -4.0000  grad_norm: 16.2325  memory: 12.06GiB(25.39%)  tps: 6,494  tflops: 50.77  mfu: 16.27%
[rank0]:2025-12-31 06:28:49,930 - Avg. fwd time: 8.3184 / Avg. bwd time: 21.0270 / Avg. batch time: 1241.2203 (ms) / GPU bubble ratio: 62.17%
[rank0]:2025-12-31 06:28:49,966 -  step: 100  loss: -4.0000  grad_norm: 16.2325  memory: 20.42GiB(42.99%)  tps: 6,494  tflops: 50.77  mfu: 16.27%
[rank3]:2025-12-31 06:28:49,964 -  step: 100  loss:  8.3632  grad_norm: 16.2325  memory: 29.23GiB(61.52%)  tps: 6,494  tflops: 50.77  mfu: 16.27%
[rank1]:2025-12-31 06:28:49,894 - Avg. fwd time: 9.8233 / Avg. bwd time: 24.1990 / Avg. batch time: 1202.8031 (ms) / GPU bubble ratio: 54.74%
[rank1]:2025-12-31 06:28:49,955 -  step: 100  loss: -4.0000  grad_norm: 16.2325  memory: 18.49GiB(38.93%)  tps: 6,494  tflops: 50.77  mfu: 16.27%
[rank2]:2025-12-31 06:28:50,035 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_ratio_history/rank2/251231_0628_stage2_step100.svg
[rank2]:2025-12-31 06:28:50,073 - âœ… Frozen Ratio History of Rank 2 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_ratio_history/rank2/251231_0628_stage6_step100.svg
[rank0]:2025-12-31 06:28:50,037 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_ratio_history/rank0/251231_0628_stage0_step100.svg
[rank0]:2025-12-31 06:28:50,073 - âœ… Frozen Ratio History of Rank 0 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_ratio_history/rank0/251231_0628_stage4_step100.svg
[rank1]:2025-12-31 06:28:50,036 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_ratio_history/rank1/251231_0628_stage1_step100.svg
[rank1]:2025-12-31 06:28:50,073 - âœ… Frozen Ratio History of Rank 1 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_ratio_history/rank1/251231_0628_stage5_step100.svg
[rank2]:2025-12-31 06:28:50,173 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_params_histogram/251231_0628_rank2_stage2.svg
[rank2]:	> Counts Sum: 36, Total Sum: 90 (40.00%), Ratio(%) per element: [40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0]
[rank0]:2025-12-31 06:28:50,176 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_params_histogram/251231_0628_rank0_stage0.svg
[rank0]:	> Counts Sum: 9, Total Sum: 95 (9.47%), Ratio(%) per element: [0.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-12-31 06:28:50,271 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_params_histogram/251231_0628_rank2_stage6.svg
[rank2]:	> Counts Sum: 18, Total Sum: 90 (20.00%), Ratio(%) per element: [40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-12-31 06:28:50,273 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_params_histogram/251231_0628_rank0_stage4.svg
[rank0]:	> Counts Sum: 0, Total Sum: 90 (0.00%), Ratio(%) per element: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-31 06:28:50,232 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/pipeline_schedule/251231_0628_step100_rank3.svg
[rank3]:			> Batch Time: 1206.08 ms, GPU Bubble Ratio: 63.52%, 54.26%, 73.47%, 34.74%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-7-33ms      | [S4,MB0,F]  49-9-58ms      | [S4,MB1,F]  87-8-96ms      | [S4,MB2,F]  126-8-135ms    | [S4,MB3,F]  165-8-173ms    | [S0,MB4,F]  174-8-182ms    | [S0,MB5,F]  183-7-190ms    | [S0,MB6,F]  190-8-199ms    | [S4,MB0,B]  372-19-391ms   | [S0,MB7,F]  391-7-399ms    | [S4,MB1,B]  491-19-510ms   | [S4,MB4,F]  553-8-561ms    | [S4,MB2,B]  562-19-581ms   | [S4,MB5,F]  584-8-593ms    | [S4,MB3,B]  593-19-612ms   | [S4,MB6,F]  616-8-625ms    | [S0,MB0,B]  628-20-648ms   | [S4,MB7,F]  653-7-660ms    | [S0,MB1,B]  668-19-687ms   | [S0,MB2,B]  711-19-730ms   | [S0,MB3,B]  758-19-777ms   | [S4,MB4,B]  787-18-805ms   | [S4,MB5,B]  867-18-885ms   | [S4,MB6,B]  958-18-976ms   | [S4,MB7,B]  1046-18-1064ms | [S0,MB4,B]  1080-19-1099ms | [S0,MB5,B]  1115-19-1134ms | [S0,MB6,B]  1149-19-1168ms | [S0,MB7,B]  1187-19-1206ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  49-10-59ms     | [S1,MB2,F]  87-10-98ms     | [S1,MB3,F]  126-10-137ms   | [S5,MB0,F]  165-7-173ms    | [S5,MB1,F]  179-7-186ms    | [S5,MB2,F]  193-7-200ms    | [S5,MB3,F]  278-7-285ms    | [S1,MB4,F]  303-10-314ms   | [S5,MB0,B]  314-18-333ms   | [S1,MB5,F]  365-12-378ms   | [S5,MB1,B]  378-18-397ms   | [S1,MB6,F]  397-11-409ms   | [S5,MB2,B]  491-18-509ms   | [S1,MB7,F]  510-11-521ms   | [S5,MB3,B]  561-19-581ms   | [S5,MB4,F]  581-8-590ms    | [S1,MB0,B]  593-29-622ms   | [S5,MB5,F]  621-9-630ms    | [S1,MB1,B]  631-30-661ms   | [S5,MB6,F]  661-10-671ms   | [S1,MB2,B]  671-33-704ms   | [S5,MB7,F]  704-10-715ms   | [S1,MB3,B]  715-34-749ms   | [S5,MB4,B]  758-21-780ms   | [S5,MB5,B]  839-18-857ms   | [S5,MB6,B]  928-17-946ms   | [S5,MB7,B]  1022-17-1040ms | [S1,MB4,B]  1046-27-1073ms | [S1,MB5,B]  1080-28-1108ms | [S1,MB6,B]  1114-29-1144ms | [S1,MB7,B]  1149-30-1180ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-7-28ms      | [S2,MB1,F]  59-7-67ms      | [S2,MB2,F]  98-7-106ms     | [S2,MB3,F]  137-7-145ms    | [S6,MB0,F]  173-7-181ms    | [S6,MB1,F]  187-7-195ms    | [S6,MB2,F]  272-7-279ms    | [S6,MB0,B]  279-14-293ms   | [S6,MB3,F]  293-8-302ms    | [S6,MB1,B]  353-16-369ms   | [S2,MB4,F]  370-9-379ms    | [S6,MB2,B]  444-14-458ms   | [S2,MB5,F]  458-7-466ms    | [S6,MB3,B]  534-14-549ms   | [S2,MB6,F]  549-8-557ms    | [S2,MB0,B]  564-10-575ms   | [S2,MB7,F]  575-8-584ms    | [S2,MB1,B]  595-10-606ms   | [S6,MB4,F]  606-7-614ms    | [S2,MB2,B]  632-10-642ms   | [S6,MB5,F]  643-7-650ms    | [S2,MB3,B]  673-9-683ms    | [S6,MB6,F]  685-8-693ms    | [S6,MB4,B]  729-14-744ms   | [S6,MB7,F]  744-7-751ms    | [S6,MB5,B]  818-13-832ms   | [S6,MB6,B]  909-13-922ms   | [S6,MB7,B]  1002-13-1015ms | [S2,MB4,B]  1022-8-1031ms  | [S2,MB5,B]  1065-8-1074ms  | [S2,MB6,B]  1080-8-1089ms  | [S2,MB7,B]  1114-8-1123ms 
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-7-36ms      | [S3,MB1,F]  67-7-75ms      | [S3,MB2,F]  106-7-114ms    | [S3,MB3,F]  145-7-153ms    | [S7,MB0,F]  181-15-197ms   | [S7,MB0,B]  208-53-262ms   | [S7,MB1,F]  262-18-281ms   | [S7,MB1,B]  291-55-347ms   | [S7,MB2,F]  347-21-368ms   | [S7,MB2,B]  379-57-437ms   | [S7,MB3,F]  437-20-458ms   | [S7,MB3,B]  470-57-527ms   | [S3,MB4,F]  527-12-540ms   | [S3,MB0,B]  540-13-554ms   | [S3,MB5,F]  555-12-567ms   | [S3,MB1,B]  567-12-580ms   | [S3,MB6,F]  580-11-592ms   | [S3,MB2,B]  592-12-604ms   | [S3,MB7,F]  604-10-615ms   | [S3,MB3,B]  615-12-627ms   | [S7,MB4,F]  639-16-655ms   | [S7,MB4,B]  667-55-723ms   | [S7,MB5,F]  722-20-743ms   | [S7,MB5,B]  755-56-812ms   | [S7,MB6,F]  812-21-833ms   | [S7,MB6,B]  845-57-902ms   | [S7,MB7,F]  902-21-923ms   | [S7,MB7,B]  936-57-994ms   | [S3,MB4,B]  995-14-1010ms  | [S3,MB5,B]  1009-13-1023ms | [S3,MB6,B]  1022-12-1034ms | [S3,MB7,B]  1058-11-1069ms
[rank3]:2025-12-31 06:28:50,274 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_ratio_history/rank3/251231_0628_stage3_step100.svg
[rank1]:2025-12-31 06:28:50,200 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_params_histogram/251231_0628_rank1_stage1.svg
[rank1]:	> Counts Sum: 0, Total Sum: 135 (0.00%), Ratio(%) per element: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-31 06:28:50,312 - âœ… Frozen Ratio History of Rank 3 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_ratio_history/rank3/251231_0628_stage7_step100.svg
[rank1]:2025-12-31 06:28:50,298 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_params_histogram/251231_0628_rank1_stage5.svg
[rank1]:	> Counts Sum: 0, Total Sum: 90 (0.00%), Ratio(%) per element: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-31 06:28:50,412 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_params_histogram/251231_0628_rank3_stage3.svg
[rank3]:	> Counts Sum: 36, Total Sum: 90 (40.00%), Ratio(%) per element: [40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0]
[rank3]:2025-12-31 06:28:50,491 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_params_histogram/251231_0628_rank3_stage7.svg
[rank3]:	> Counts Sum: 0, Total Sum: 55 (0.00%), Ratio(%) per element: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-12-31 06:29:36,388 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 2.3379e+00
[rank0]:2025-12-31 06:29:36,404 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 2.0288e+00
[rank3]:2025-12-31 06:29:36,400 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 2.0326e+00
[rank1]:2025-12-31 06:29:36,393 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 2.3571e+00
[rank1]:2025-12-31 06:30:23,302 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 2.8492e+00
[rank2]:2025-12-31 06:30:23,302 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 2.8567e+00
[rank0]:2025-12-31 06:30:23,321 - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 2.1304e+00
[rank3]:2025-12-31 06:30:23,317 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 4.2491e+00
[rank2]:2025-12-31 06:31:14,457 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 1.7956e+00
[rank0]:2025-12-31 06:31:14,473 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 2.8726e+00
[rank1]:2025-12-31 06:31:14,462 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 1.1481e+00
[rank3]:2025-12-31 06:31:14,469 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 4.3343e+00
[rank2]:2025-12-31 06:32:01,285 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 2.4793e+00
[rank0]:2025-12-31 06:32:01,304 - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 1.8262e+00
[rank1]:2025-12-31 06:32:01,285 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 2.1945e+00
[rank3]:2025-12-31 06:32:01,300 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 5.2030e+00
[rank2]:2025-12-31 06:32:52,246 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 8.5162e-01
[rank0]:2025-12-31 06:32:52,241 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-31 06:32:52,261 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 1.2931e+00
[rank3]:2025-12-31 06:32:52,258 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 2.1779e+00
[rank1]:2025-12-31 06:32:52,250 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 2.8640e-01
[rank3]:2025-12-31 06:32:56,873 - Avg. fwd time: 14.4042 / Avg. bwd time: 38.8291 / Avg. batch time: 1075.6676 (ms) / GPU bubble ratio: 20.82%
[rank2]:2025-12-31 06:32:56,909 - Avg. fwd time: 7.8400 / Avg. bwd time: 16.9377 / Avg. batch time: 1134.9765 (ms) / GPU bubble ratio: 65.07%
[rank2]:2025-12-31 06:32:56,965 -  step: 150  loss: -4.0000  grad_norm: 21.2154  memory: 12.06GiB(25.39%)  tps: 6,633  tflops: 51.85  mfu: 16.62%
[rank0]:2025-12-31 06:32:56,956 - Avg. fwd time: 8.3675 / Avg. bwd time: 20.4599 / Avg. batch time: 1229.9858 (ms) / GPU bubble ratio: 62.50%
[rank0]:2025-12-31 06:32:56,980 -  step: 150  loss: -4.0000  grad_norm: 21.2154  memory: 20.42GiB(42.99%)  tps: 6,633  tflops: 51.85  mfu: 16.62%
[rank3]:2025-12-31 06:32:56,981 -  step: 150  loss:  3.7527  grad_norm: 21.2154  memory: 29.23GiB(61.52%)  tps: 6,633  tflops: 51.85  mfu: 16.62%
[rank1]:2025-12-31 06:32:56,932 - Avg. fwd time: 9.8869 / Avg. bwd time: 22.7861 / Avg. batch time: 1192.6826 (ms) / GPU bubble ratio: 56.17%
[rank1]:2025-12-31 06:32:56,965 -  step: 150  loss: -4.0000  grad_norm: 21.2154  memory: 18.49GiB(38.93%)  tps: 6,633  tflops: 51.85  mfu: 16.62%
[rank2]:2025-12-31 06:33:39,011 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 4.3961e+00
[rank0]:2025-12-31 06:33:39,026 - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 2.6012e+00
[rank1]:2025-12-31 06:33:39,011 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 3.5617e+00
[rank3]:2025-12-31 06:33:39,026 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 4.2736e+00
[rank2]:2025-12-31 06:34:30,253 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 1.5723e+00
[rank0]:2025-12-31 06:34:30,269 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 8.4590e-01
[rank3]:2025-12-31 06:34:30,265 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 1.0819e+00
[rank1]:2025-12-31 06:34:30,258 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 7.6001e-01
[rank2]:2025-12-31 06:35:16,885 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 8.3546e+00
[rank1]:2025-12-31 06:35:16,885 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 6.5657e+00
[rank3]:2025-12-31 06:35:16,901 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 7.7180e+00
[rank0]:2025-12-31 06:35:16,901 - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 5.6305e+00
[rank2]:2025-12-31 06:36:07,987 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 1.7637e+00
[rank0]:2025-12-31 06:36:08,002 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 1.3329e+00
[rank1]:2025-12-31 06:36:07,992 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 7.3679e-01
[rank3]:2025-12-31 06:36:07,999 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 3.3069e+00
[rank0]:2025-12-31 06:36:54,716 - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-12-31 06:36:54,720 - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 4.1714e+00
[rank3]:2025-12-31 06:36:54,735 - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 5.9887e+00
[rank2]:2025-12-31 06:36:54,720 - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 4.3301e+00
[rank0]:2025-12-31 06:36:54,736 - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 4.2694e+00
[rank2]:2025-12-31 06:36:59,814 - Avg. fwd time: 7.8828 / Avg. bwd time: 16.4420 / Avg. batch time: 1128.6161 (ms) / GPU bubble ratio: 65.52%
[rank3]:2025-12-31 06:36:59,765 - Avg. fwd time: 14.4418 / Avg. bwd time: 38.4296 / Avg. batch time: 1070.9023 (ms) / GPU bubble ratio: 21.01%
[rank2]:2025-12-31 06:36:59,917 -  step: 200  loss: -4.0000  grad_norm: 74.3951  memory: 12.06GiB(25.39%)  tps: 6,744  tflops: 52.72  mfu: 16.90%
[rank0]:2025-12-31 06:36:59,896 - Avg. fwd time: 8.4299 / Avg. bwd time: 19.6715 / Avg. batch time: 1219.9287 (ms) / GPU bubble ratio: 63.14%
[rank1]:2025-12-31 06:36:59,862 - Avg. fwd time: 9.9421 / Avg. bwd time: 21.7031 / Avg. batch time: 1183.5747 (ms) / GPU bubble ratio: 57.22%
[rank1]:2025-12-31 06:36:59,921 -  step: 200  loss: -4.0000  grad_norm: 74.3951  memory: 18.49GiB(38.93%)  tps: 6,744  tflops: 52.72  mfu: 16.90%
[rank3]:2025-12-31 06:36:59,930 -  step: 200  loss:  1.2205  grad_norm: 74.3951  memory: 29.23GiB(61.52%)  tps: 6,744  tflops: 52.72  mfu: 16.90%
[rank2]:2025-12-31 06:36:59,984 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_ratio_history/rank2/251231_0636_stage2_step200.svg
[rank0]:2025-12-31 06:36:59,932 -  step: 200  loss: -4.0000  grad_norm: 74.3951  memory: 20.42GiB(42.99%)  tps: 6,744  tflops: 52.72  mfu: 16.90%
[rank0]:2025-12-31 06:36:59,983 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_ratio_history/rank0/251231_0636_stage0_step200.svg
[rank1]:2025-12-31 06:36:59,983 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_ratio_history/rank1/251231_0636_stage1_step200.svg
[rank1]:2025-12-31 06:37:00,026 - âœ… Frozen Ratio History of Rank 1 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_ratio_history/rank1/251231_0636_stage5_step200.svg
[rank2]:2025-12-31 06:37:00,029 - âœ… Frozen Ratio History of Rank 2 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_ratio_history/rank2/251231_0636_stage6_step200.svg
[rank0]:2025-12-31 06:37:00,031 - âœ… Frozen Ratio History of Rank 0 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_ratio_history/rank0/251231_0636_stage4_step200.svg
[rank2]:2025-12-31 06:37:00,133 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_params_histogram/251231_0636_rank2_stage2.svg
[rank2]:	> Counts Sum: 126, Total Sum: 270 (46.67%), Ratio(%) per element: [46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66]
[rank0]:2025-12-31 06:37:00,132 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_params_histogram/251231_0636_rank0_stage0.svg
[rank0]:	> Counts Sum: 99, Total Sum: 285 (34.74%), Ratio(%) per element: [0.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33]
[rank1]:2025-12-31 06:37:00,150 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_params_histogram/251231_0636_rank1_stage1.svg
[rank1]:	> Counts Sum: 135, Total Sum: 405 (33.33%), Ratio(%) per element: [33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33]
[rank3]:2025-12-31 06:37:00,187 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/pipeline_schedule/251231_0636_step200_rank3.svg
[rank3]:			> Batch Time: 1148.56 ms, GPU Bubble Ratio: 67.47%, 65.60%, 71.56%, 30.50%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-9-17ms       | [S0,MB2,F]  17-8-26ms      | [S0,MB3,F]  26-8-34ms      | [S4,MB0,F]  49-9-58ms      | [S4,MB1,F]  89-8-98ms      | [S4,MB2,F]  129-8-138ms    | [S4,MB3,F]  169-8-178ms    | [S0,MB4,F]  178-9-187ms    | [S0,MB5,F]  188-8-196ms    | [S0,MB6,F]  196-9-205ms    | [S4,MB0,B]  377-14-391ms   | [S0,MB7,F]  392-8-400ms    | [S4,MB1,B]  495-14-510ms   | [S4,MB4,F]  558-8-567ms    | [S4,MB2,B]  567-14-581ms   | [S4,MB5,F]  588-8-597ms    | [S4,MB3,B]  597-14-612ms   | [S4,MB6,F]  619-9-628ms    | [S0,MB0,B]  629-15-644ms   | [S4,MB7,F]  649-8-657ms    | [S0,MB1,B]  657-15-672ms   | [S0,MB2,B]  677-14-692ms   | [S0,MB3,B]  743-14-758ms   | [S4,MB4,B]  771-13-784ms   | [S4,MB5,B]  867-13-880ms   | [S4,MB6,B]  958-13-971ms   | [S4,MB7,B]  1042-13-1055ms | [S0,MB4,B]  1063-14-1077ms | [S0,MB5,B]  1093-14-1107ms | [S0,MB6,B]  1114-14-1128ms | [S0,MB7,B]  1134-14-1148ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  49-11-61ms     | [S1,MB2,F]  89-12-101ms    | [S1,MB3,F]  129-11-141ms   | [S5,MB0,F]  169-7-177ms    | [S5,MB1,F]  184-7-191ms    | [S5,MB2,F]  198-7-205ms    | [S5,MB3,F]  281-7-289ms    | [S1,MB4,F]  307-11-319ms   | [S5,MB0,B]  318-13-332ms   | [S1,MB5,F]  370-14-384ms   | [S5,MB1,B]  384-14-398ms   | [S1,MB6,F]  399-12-411ms   | [S5,MB2,B]  495-14-509ms   | [S1,MB7,F]  509-12-521ms   | [S5,MB3,B]  566-15-581ms   | [S5,MB4,F]  582-8-590ms    | [S1,MB0,B]  596-15-612ms   | [S5,MB5,F]  614-8-622ms    | [S1,MB1,B]  627-15-643ms   | [S5,MB6,F]  644-9-653ms    | [S1,MB2,B]  654-15-670ms   | [S5,MB7,F]  670-10-680ms   | [S1,MB3,B]  680-14-695ms   | [S5,MB4,B]  751-13-764ms   | [S5,MB5,B]  839-13-852ms   | [S5,MB6,B]  929-13-943ms   | [S5,MB7,B]  1021-13-1035ms | [S1,MB4,B]  1041-13-1055ms | [S1,MB5,B]  1073-13-1087ms | [S1,MB6,B]  1093-13-1107ms | [S1,MB7,B]  1113-13-1127ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-7-28ms      | [S2,MB1,F]  61-7-68ms      | [S2,MB2,F]  101-7-109ms    | [S2,MB3,F]  141-7-149ms    | [S6,MB0,F]  178-7-185ms    | [S6,MB1,F]  192-7-199ms    | [S6,MB2,F]  275-7-282ms    | [S6,MB0,B]  282-14-297ms   | [S6,MB3,F]  297-8-306ms    | [S6,MB1,B]  358-16-374ms   | [S2,MB4,F]  374-9-383ms    | [S6,MB2,B]  447-14-462ms   | [S2,MB5,F]  462-8-470ms    | [S6,MB3,B]  539-14-553ms   | [S2,MB6,F]  554-8-563ms    | [S2,MB0,B]  569-10-579ms   | [S2,MB7,F]  580-8-588ms    | [S2,MB1,B]  599-10-610ms   | [S6,MB4,F]  611-7-619ms    | [S2,MB2,B]  629-10-639ms   | [S6,MB5,F]  641-8-649ms    | [S2,MB3,B]  656-10-666ms   | [S6,MB6,F]  666-9-675ms    | [S6,MB4,B]  728-16-744ms   | [S6,MB7,F]  744-8-753ms    | [S6,MB5,B]  818-13-832ms   | [S6,MB6,B]  909-13-922ms   | [S6,MB7,B]  1002-13-1015ms | [S2,MB4,B]  1021-9-1030ms  | [S2,MB5,B]  1057-9-1066ms  | [S2,MB6,B]  1072-8-1081ms  | [S2,MB7,B]  1092-9-1101ms 
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-8-36ms      | [S3,MB1,F]  68-7-76ms      | [S3,MB2,F]  109-7-117ms    | [S3,MB3,F]  149-7-157ms    | [S7,MB0,F]  185-15-201ms   | [S7,MB0,B]  213-53-266ms   | [S7,MB1,F]  266-19-285ms   | [S7,MB1,B]  295-55-351ms   | [S7,MB2,F]  351-21-372ms   | [S7,MB2,B]  383-57-441ms   | [S7,MB3,F]  441-21-462ms   | [S7,MB3,B]  473-58-532ms   | [S3,MB4,F]  532-12-545ms   | [S3,MB0,B]  545-13-558ms   | [S3,MB5,F]  559-12-572ms   | [S3,MB1,B]  571-13-585ms   | [S3,MB6,F]  585-11-597ms   | [S3,MB2,B]  597-12-610ms   | [S3,MB7,F]  610-10-621ms   | [S3,MB3,B]  621-12-634ms   | [S7,MB4,F]  636-18-655ms   | [S7,MB4,B]  666-55-722ms   | [S7,MB5,F]  721-21-743ms   | [S7,MB5,B]  754-57-812ms   | [S7,MB6,F]  812-21-833ms   | [S7,MB6,B]  845-57-903ms   | [S7,MB7,F]  903-21-924ms   | [S7,MB7,B]  936-57-994ms   | [S3,MB4,B]  994-14-1009ms  | [S3,MB5,B]  1008-13-1022ms | [S3,MB6,B]  1022-12-1034ms | [S3,MB7,B]  1049-13-1062ms
[rank3]:2025-12-31 06:37:00,232 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_ratio_history/rank3/251231_0636_stage3_step200.svg
[rank2]:2025-12-31 06:37:00,235 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_params_histogram/251231_0636_rank2_stage6.svg
[rank2]:	> Counts Sum: 63, Total Sum: 270 (23.33%), Ratio(%) per element: [46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-12-31 06:37:00,230 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_params_histogram/251231_0636_rank0_stage4.svg
[rank0]:	> Counts Sum: 27, Total Sum: 270 (10.00%), Ratio(%) per element: [20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-12-31 06:37:00,248 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_params_histogram/251231_0636_rank1_stage5.svg
[rank1]:	> Counts Sum: 45, Total Sum: 270 (16.67%), Ratio(%) per element: [33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-31 06:37:00,273 - âœ… Frozen Ratio History of Rank 3 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_ratio_history/rank3/251231_0636_stage7_step200.svg
[rank3]:2025-12-31 06:37:00,372 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_params_histogram/251231_0636_rank3_stage3.svg
[rank3]:	> Counts Sum: 126, Total Sum: 270 (46.67%), Ratio(%) per element: [46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66]
[rank3]:2025-12-31 06:37:00,454 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_params_histogram/251231_0636_rank3_stage7.svg
[rank3]:	> Counts Sum: 0, Total Sum: 165 (0.00%), Ratio(%) per element: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-12-31 06:37:46,417 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 4.9063e+00
[rank0]:2025-12-31 06:37:46,432 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 3.6548e+00
[rank1]:2025-12-31 06:37:46,421 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 3.4980e+00
[rank3]:2025-12-31 06:37:46,428 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 3.2257e+00
[rank1]:2025-12-31 06:38:33,049 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 1.7443e+01
[rank3]:2025-12-31 06:38:33,064 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 2.7533e+01
[rank2]:2025-12-31 06:38:33,049 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 1.6136e+01
[rank0]:2025-12-31 06:38:33,064 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 1.8290e+01
[rank2]:2025-12-31 06:39:19,631 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 3.5580e+00
[rank0]:2025-12-31 06:39:19,647 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 4.7761e+00
[rank1]:2025-12-31 06:39:19,632 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 5.8640e+00
[rank3]:2025-12-31 06:39:19,647 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 2.3912e+00
[rank1]:2025-12-31 06:40:06,275 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 3.2186e+00
[rank3]:2025-12-31 06:40:06,291 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 2.6409e+00
[rank2]:2025-12-31 06:40:06,275 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 4.2442e+00
[rank0]:2025-12-31 06:40:06,291 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 4.9518e+00
[rank0]:2025-12-31 06:40:52,935 - [GC] Peforming periodical GC collection 0.02 seconds
[rank1]:2025-12-31 06:40:52,923 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 1.0466e+00
[rank3]:2025-12-31 06:40:52,939 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 1.3387e+00
[rank2]:2025-12-31 06:40:52,923 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 7.5016e-01
[rank0]:2025-12-31 06:40:52,939 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 8.0601e-01
[rank3]:2025-12-31 06:40:57,494 - Avg. fwd time: 14.4696 / Avg. bwd time: 37.9028 / Avg. batch time: 1064.7018 (ms) / GPU bubble ratio: 21.30%
[rank2]:2025-12-31 06:40:57,528 - Avg. fwd time: 7.9321 / Avg. bwd time: 15.8262 / Avg. batch time: 1121.0042 (ms) / GPU bubble ratio: 66.09%
[rank2]:2025-12-31 06:40:57,587 -  step: 250  loss: -4.0000  grad_norm:  5.1887  memory: 12.06GiB(25.39%)  tps: 6,894  tflops: 53.89  mfu: 17.27%
[rank0]:2025-12-31 06:40:57,577 - Avg. fwd time: 8.4914 / Avg. bwd time: 18.8688 / Avg. batch time: 1208.5468 (ms) / GPU bubble ratio: 63.78%
[rank0]:2025-12-31 06:40:57,601 -  step: 250  loss: -4.0000  grad_norm:  5.1887  memory: 20.42GiB(42.99%)  tps: 6,894  tflops: 53.89  mfu: 17.27%
[rank1]:2025-12-31 06:40:57,553 - Avg. fwd time: 10.0005 / Avg. bwd time: 20.5803 / Avg. batch time: 1173.1929 (ms) / GPU bubble ratio: 58.29%
[rank1]:2025-12-31 06:40:57,587 -  step: 250  loss: -4.0000  grad_norm:  5.1887  memory: 18.49GiB(38.93%)  tps: 6,894  tflops: 53.89  mfu: 17.27%
[rank3]:2025-12-31 06:40:57,603 -  step: 250  loss:  0.4476  grad_norm:  5.1887  memory: 29.23GiB(61.52%)  tps: 6,894  tflops: 53.89  mfu: 17.27%
[rank3]:2025-12-31 06:41:39,608 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 3.0286e+00
[rank2]:2025-12-31 06:41:39,592 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 3.1681e+00
[rank1]:2025-12-31 06:41:39,592 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 4.9466e+00
[rank0]:2025-12-31 06:41:39,608 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 5.8750e+00
[rank2]:2025-12-31 06:42:26,196 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 7.0962e+00
[rank1]:2025-12-31 06:42:26,196 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 7.3847e+00
[rank0]:2025-12-31 06:42:26,211 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 7.3213e+00
[rank3]:2025-12-31 06:42:26,212 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 5.6837e+00
[rank2]:2025-12-31 06:43:12,864 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 1.4127e+00
[rank1]:2025-12-31 06:43:12,865 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 9.7964e-01
[rank0]:2025-12-31 06:43:12,880 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 1.1900e+00
[rank3]:2025-12-31 06:43:12,880 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 1.8312e+00
[rank2]:2025-12-31 06:43:59,595 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 3.8247e+00
[rank1]:2025-12-31 06:43:59,595 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 4.1286e+00
[rank0]:2025-12-31 06:43:59,611 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 4.1544e+00
[rank3]:2025-12-31 06:43:59,611 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 4.5000e+00
[rank1]:2025-12-31 06:44:46,120 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 1.4558e+00
[rank0]:2025-12-31 06:44:46,116 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-31 06:44:46,135 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 1.2991e+00
[rank3]:2025-12-31 06:44:46,135 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 1.3354e+00
[rank2]:2025-12-31 06:44:46,120 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 1.7197e+00
[rank3]:2025-12-31 06:44:50,685 - Avg. fwd time: 14.4993 / Avg. bwd time: 37.3776 / Avg. batch time: 1058.6963 (ms) / GPU bubble ratio: 21.60%
[rank2]:2025-12-31 06:44:50,724 - Avg. fwd time: 7.9799 / Avg. bwd time: 15.2207 / Avg. batch time: 1113.5264 (ms) / GPU bubble ratio: 66.66%
[rank2]:2025-12-31 06:44:50,783 -  step: 300  loss: -4.0000  grad_norm:  0.7186  memory: 12.06GiB(25.39%)  tps: 7,026  tflops: 54.92  mfu: 17.60%
[rank1]:2025-12-31 06:44:50,748 - Avg. fwd time: 10.0549 / Avg. bwd time: 19.5435 / Avg. batch time: 1163.1982 (ms) / GPU bubble ratio: 59.29%
[rank1]:2025-12-31 06:44:50,783 -  step: 300  loss: -4.0000  grad_norm:  0.7186  memory: 18.49GiB(38.93%)  tps: 7,026  tflops: 54.92  mfu: 17.60%
[rank0]:2025-12-31 06:44:50,774 - Avg. fwd time: 8.5481 / Avg. bwd time: 18.1337 / Avg. batch time: 1197.5947 (ms) / GPU bubble ratio: 64.35%
[rank0]:2025-12-31 06:44:50,798 -  step: 300  loss: -4.0000  grad_norm:  0.7186  memory: 20.42GiB(42.99%)  tps: 7,026  tflops: 54.92  mfu: 17.60%
[rank0]:2025-12-31 06:44:50,848 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_ratio_history/rank0/251231_0644_stage0_step300.svg
[rank3]:2025-12-31 06:44:50,799 -  step: 300  loss:  0.3030  grad_norm:  0.7186  memory: 29.23GiB(61.52%)  tps: 7,026  tflops: 54.93  mfu: 17.60%
[rank2]:2025-12-31 06:44:50,848 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_ratio_history/rank2/251231_0644_stage2_step300.svg
[rank2]:2025-12-31 06:44:50,892 - âœ… Frozen Ratio History of Rank 2 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_ratio_history/rank2/251231_0644_stage6_step300.svg
[rank1]:2025-12-31 06:44:50,849 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_ratio_history/rank1/251231_0644_stage1_step300.svg
[rank1]:2025-12-31 06:44:50,893 - âœ… Frozen Ratio History of Rank 1 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_ratio_history/rank1/251231_0644_stage5_step300.svg
[rank0]:2025-12-31 06:44:50,889 - âœ… Frozen Ratio History of Rank 0 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_ratio_history/rank0/251231_0644_stage4_step300.svg
[rank2]:2025-12-31 06:44:50,992 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_params_histogram/251231_0644_rank2_stage2.svg
[rank2]:	> Counts Sum: 306, Total Sum: 450 (68.00%), Ratio(%) per element: [68.0, 68.0, 68.0, 68.0, 68.0, 68.0, 68.0, 68.0, 68.0, 68.0, 68.0, 68.0, 68.0, 68.0, 68.0, 68.0, 68.0, 68.0]
[rank1]:2025-12-31 06:44:51,017 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_params_histogram/251231_0644_rank1_stage1.svg
[rank1]:	> Counts Sum: 405, Total Sum: 675 (60.00%), Ratio(%) per element: [60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0]
[rank0]:2025-12-31 06:44:50,990 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_params_histogram/251231_0644_rank0_stage0.svg
[rank0]:	> Counts Sum: 279, Total Sum: 475 (58.74%), Ratio(%) per element: [0.0, 64.0, 64.0, 64.0, 64.0, 64.0, 64.0, 64.0, 64.0, 64.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0]
[rank3]:2025-12-31 06:44:51,043 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/pipeline_schedule/251231_0644_step300_rank3.svg
[rank3]:			> Batch Time: 1138.56 ms, GPU Bubble Ratio: 67.21%, 65.33%, 71.34%, 30.39%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-9-17ms       | [S0,MB2,F]  17-8-26ms      | [S0,MB3,F]  26-8-34ms      | [S4,MB0,F]  49-9-58ms      | [S4,MB1,F]  89-8-98ms      | [S4,MB2,F]  129-8-138ms    | [S4,MB3,F]  169-8-178ms    | [S0,MB4,F]  178-9-187ms    | [S0,MB5,F]  187-8-196ms    | [S0,MB6,F]  196-9-205ms    | [S4,MB0,B]  378-14-393ms   | [S0,MB7,F]  393-8-401ms    | [S4,MB1,B]  495-14-510ms   | [S4,MB4,F]  557-8-566ms    | [S4,MB2,B]  566-14-581ms   | [S4,MB5,F]  587-8-596ms    | [S4,MB3,B]  596-14-611ms   | [S4,MB6,F]  617-9-626ms    | [S0,MB0,B]  626-15-641ms   | [S4,MB7,F]  646-7-653ms    | [S0,MB1,B]  654-15-669ms   | [S0,MB2,B]  674-14-688ms   | [S0,MB3,B]  739-14-754ms   | [S4,MB4,B]  767-13-781ms   | [S4,MB5,B]  859-13-873ms   | [S4,MB6,B]  949-13-962ms   | [S4,MB7,B]  1031-13-1044ms | [S0,MB4,B]  1053-14-1067ms | [S0,MB5,B]  1083-14-1097ms | [S0,MB6,B]  1103-14-1117ms | [S0,MB7,B]  1124-14-1138ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  49-11-60ms     | [S1,MB2,F]  89-11-101ms    | [S1,MB3,F]  129-11-141ms   | [S5,MB0,F]  169-7-177ms    | [S5,MB1,F]  183-7-191ms    | [S5,MB2,F]  198-7-205ms    | [S5,MB3,F]  282-7-290ms    | [S1,MB4,F]  308-11-320ms   | [S5,MB0,B]  320-14-334ms   | [S1,MB5,F]  371-14-385ms   | [S5,MB1,B]  385-14-399ms   | [S1,MB6,F]  399-12-412ms   | [S5,MB2,B]  495-14-509ms   | [S1,MB7,F]  509-12-521ms   | [S5,MB3,B]  565-15-580ms   | [S5,MB4,F]  581-8-589ms    | [S1,MB0,B]  595-15-611ms   | [S5,MB5,F]  611-8-619ms    | [S1,MB1,B]  625-15-640ms   | [S5,MB6,F]  640-9-649ms    | [S1,MB2,B]  650-15-666ms   | [S5,MB7,F]  666-10-676ms   | [S1,MB3,B]  676-14-691ms   | [S5,MB4,B]  747-13-760ms   | [S5,MB5,B]  833-13-847ms   | [S5,MB6,B]  922-13-935ms   | [S5,MB7,B]  1011-13-1025ms | [S1,MB4,B]  1031-13-1044ms | [S1,MB5,B]  1063-13-1077ms | [S1,MB6,B]  1083-13-1097ms | [S1,MB7,B]  1104-13-1118ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-7-28ms      | [S2,MB1,F]  60-7-68ms      | [S2,MB2,F]  101-7-108ms    | [S2,MB3,F]  141-7-149ms    | [S6,MB0,F]  177-7-185ms    | [S6,MB1,F]  191-7-199ms    | [S6,MB2,F]  276-7-284ms    | [S6,MB0,B]  284-14-298ms   | [S6,MB3,F]  298-8-307ms    | [S6,MB1,B]  359-16-375ms   | [S2,MB4,F]  375-9-384ms    | [S6,MB2,B]  448-14-462ms   | [S2,MB5,F]  462-7-470ms    | [S6,MB3,B]  538-14-552ms   | [S2,MB6,F]  553-8-562ms    | [S2,MB0,B]  567-10-577ms   | [S2,MB7,F]  577-8-586ms    | [S2,MB1,B]  597-10-607ms   | [S6,MB4,F]  608-7-616ms    | [S2,MB2,B]  626-10-637ms   | [S6,MB5,F]  637-8-645ms    | [S2,MB3,B]  652-9-662ms    | [S6,MB6,F]  662-9-671ms    | [S6,MB4,B]  724-16-740ms   | [S6,MB7,F]  740-8-748ms    | [S6,MB5,B]  813-13-827ms   | [S6,MB6,B]  902-13-915ms   | [S6,MB7,B]  991-13-1004ms  | [S2,MB4,B]  1011-9-1020ms  | [S2,MB5,B]  1047-9-1056ms  | [S2,MB6,B]  1063-8-1072ms  | [S2,MB7,B]  1082-9-1091ms 
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-7-36ms      | [S3,MB1,F]  68-7-76ms      | [S3,MB2,F]  108-7-116ms    | [S3,MB3,F]  148-7-156ms    | [S7,MB0,F]  185-15-201ms   | [S7,MB0,B]  213-53-266ms   | [S7,MB1,F]  267-18-285ms   | [S7,MB1,B]  297-55-352ms   | [S7,MB2,F]  352-21-374ms   | [S7,MB2,B]  384-57-441ms   | [S7,MB3,F]  441-21-462ms   | [S7,MB3,B]  473-58-531ms   | [S3,MB4,F]  531-12-544ms   | [S3,MB0,B]  543-13-556ms   | [S3,MB5,F]  557-12-569ms   | [S3,MB1,B]  569-13-582ms   | [S3,MB6,F]  582-11-594ms   | [S3,MB2,B]  594-12-606ms   | [S3,MB7,F]  607-10-617ms   | [S3,MB3,B]  617-12-630ms   | [S7,MB4,F]  632-18-651ms   | [S7,MB4,B]  663-54-717ms   | [S7,MB5,F]  717-20-738ms   | [S7,MB5,B]  749-56-806ms   | [S7,MB6,F]  806-21-827ms   | [S7,MB6,B]  838-57-896ms   | [S7,MB7,F]  896-21-917ms   | [S7,MB7,B]  927-57-984ms   | [S3,MB4,B]  984-14-998ms   | [S3,MB5,B]  998-13-1012ms  | [S3,MB6,B]  1012-12-1024ms | [S3,MB7,B]  1039-13-1052ms
[rank2]:2025-12-31 06:44:51,093 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_params_histogram/251231_0644_rank2_stage6.svg
[rank2]:	> Counts Sum: 153, Total Sum: 450 (34.00%), Ratio(%) per element: [68.0, 68.0, 68.0, 68.0, 68.0, 68.0, 68.0, 68.0, 68.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-12-31 06:44:51,117 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_params_histogram/251231_0644_rank1_stage5.svg
[rank1]:	> Counts Sum: 135, Total Sum: 450 (30.00%), Ratio(%) per element: [60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-12-31 06:44:51,091 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_params_histogram/251231_0644_rank0_stage4.svg
[rank0]:	> Counts Sum: 117, Total Sum: 450 (26.00%), Ratio(%) per element: [52.0, 52.0, 52.0, 52.0, 52.0, 52.0, 52.0, 52.0, 52.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-31 06:44:51,087 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_ratio_history/rank3/251231_0644_stage3_step300.svg
[rank3]:2025-12-31 06:44:51,128 - âœ… Frozen Ratio History of Rank 3 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_ratio_history/rank3/251231_0644_stage7_step300.svg
[rank3]:2025-12-31 06:44:51,230 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_params_histogram/251231_0644_rank3_stage3.svg
[rank3]:	> Counts Sum: 306, Total Sum: 450 (68.00%), Ratio(%) per element: [68.0, 68.0, 68.0, 68.0, 68.0, 68.0, 68.0, 68.0, 68.0, 68.0, 68.0, 68.0, 68.0, 68.0, 68.0, 68.0, 68.0, 68.0]
[rank3]:2025-12-31 06:44:51,309 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_params_histogram/251231_0644_rank3_stage7.svg
[rank3]:	> Counts Sum: 0, Total Sum: 275 (0.00%), Ratio(%) per element: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-12-31 06:45:33,147 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 1.3024e+00
[rank1]:2025-12-31 06:45:33,147 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 1.4275e+00
[rank0]:2025-12-31 06:45:33,163 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 1.3366e+00
[rank3]:2025-12-31 06:45:33,163 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 1.3349e+00
[rank3]:2025-12-31 06:46:19,783 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 1.9889e+00
[rank2]:2025-12-31 06:46:19,768 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 1.6358e+00
[rank1]:2025-12-31 06:46:19,768 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 1.7984e+00
[rank0]:2025-12-31 06:46:19,783 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 1.9873e+00
[rank2]:2025-12-31 06:47:06,465 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 1.5286e+00
[rank1]:2025-12-31 06:47:06,465 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 1.6069e+00
[rank0]:2025-12-31 06:47:06,480 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 2.1471e+00
[rank3]:2025-12-31 06:47:06,480 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 2.3090e+00
[rank1]:2025-12-31 06:47:53,038 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 7.2809e-01
[rank0]:2025-12-31 06:47:53,054 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 7.3703e-01
[rank2]:2025-12-31 06:47:53,038 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 8.7857e-01
[rank3]:2025-12-31 06:47:53,054 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 5.4626e-01
[rank1]:2025-12-31 06:48:39,625 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 4.3069e-01
[rank0]:2025-12-31 06:48:39,634 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-31 06:48:39,640 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 3.2017e-01
[rank2]:2025-12-31 06:48:39,625 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 4.6592e-01
[rank3]:2025-12-31 06:48:39,640 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 6.3604e-01
[rank2]:2025-12-31 06:48:44,272 - Avg. fwd time: 8.0149 / Avg. bwd time: 14.7861 / Avg. batch time: 1108.2424 (ms) / GPU bubble ratio: 67.08%
[rank3]:2025-12-31 06:48:44,236 - Avg. fwd time: 14.5247 / Avg. bwd time: 36.9950 / Avg. batch time: 1054.3411 (ms) / GPU bubble ratio: 21.82%
[rank1]:2025-12-31 06:48:44,297 - Avg. fwd time: 10.0954 / Avg. bwd time: 18.8017 / Avg. batch time: 1156.1165 (ms) / GPU bubble ratio: 60.01%
[rank1]:2025-12-31 06:48:44,332 -  step: 350  loss: -4.0000  grad_norm:  0.2146  memory: 18.49GiB(38.93%)  tps: 7,015  tflops: 54.84  mfu: 17.58%
[rank0]:2025-12-31 06:48:44,323 - Avg. fwd time: 8.5888 / Avg. bwd time: 17.6072 / Avg. batch time: 1189.8437 (ms) / GPU bubble ratio: 64.77%
[rank0]:2025-12-31 06:48:44,346 -  step: 350  loss: -4.0000  grad_norm:  0.2146  memory: 20.42GiB(42.99%)  tps: 7,015  tflops: 54.84  mfu: 17.58%
[rank2]:2025-12-31 06:48:44,332 -  step: 350  loss: -4.0000  grad_norm:  0.2146  memory: 12.06GiB(25.39%)  tps: 7,015  tflops: 54.84  mfu: 17.58%
[rank3]:2025-12-31 06:48:44,347 -  step: 350  loss:  0.2501  grad_norm:  0.2146  memory: 29.23GiB(61.52%)  tps: 7,015  tflops: 54.84  mfu: 17.58%
[rank1]:2025-12-31 06:49:26,282 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 2.7145e-01
[rank0]:2025-12-31 06:49:26,298 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 2.9257e-01
[rank2]:2025-12-31 06:49:26,282 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 4.3412e-01
[rank3]:2025-12-31 06:49:26,298 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 4.0970e-01
[rank1]:2025-12-31 06:50:13,025 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 1.6723e+00
[rank0]:2025-12-31 06:50:13,040 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 1.8761e+00
[rank2]:2025-12-31 06:50:13,025 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 1.3088e+00
[rank3]:2025-12-31 06:50:13,040 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 1.4202e+00
[rank1]:2025-12-31 06:50:59,683 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 1.5607e+00
[rank0]:2025-12-31 06:50:59,698 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 2.0331e+00
[rank2]:2025-12-31 06:50:59,682 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 1.6633e+00
[rank3]:2025-12-31 06:50:59,698 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 1.8259e+00
[rank1]:2025-12-31 06:51:46,255 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 3.9377e-01
[rank0]:2025-12-31 06:51:46,271 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 2.2825e-01
[rank2]:2025-12-31 06:51:46,255 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 4.2029e-01
[rank3]:2025-12-31 06:51:46,271 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 3.2698e-01
[rank1]:2025-12-31 06:52:32,924 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 3.6559e-01
[rank2]:2025-12-31 06:52:32,924 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 6.9122e-01
[rank0]:2025-12-31 06:52:32,920 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-31 06:52:32,939 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 2.0425e-01
[rank3]:2025-12-31 06:52:32,940 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 4.8580e-01
[rank3]:2025-12-31 06:52:37,569 - Avg. fwd time: 14.5462 / Avg. bwd time: 36.7141 / Avg. batch time: 1051.2095 (ms) / GPU bubble ratio: 21.98%
[rank1]:2025-12-31 06:52:37,630 - Avg. fwd time: 10.1264 / Avg. bwd time: 18.2436 / Avg. batch time: 1150.8317 (ms) / GPU bubble ratio: 60.56%
[rank2]:2025-12-31 06:52:37,604 - Avg. fwd time: 8.0415 / Avg. bwd time: 14.4593 / Avg. batch time: 1104.3021 (ms) / GPU bubble ratio: 67.40%
[rank2]:2025-12-31 06:52:37,666 -  step: 400  loss: -4.0000  grad_norm:  0.2504  memory: 12.06GiB(25.39%)  tps: 7,022  tflops: 54.89  mfu: 17.59%
[rank0]:2025-12-31 06:52:37,657 - Avg. fwd time: 8.6200 / Avg. bwd time: 17.2119 / Avg. batch time: 1184.0478 (ms) / GPU bubble ratio: 65.09%
[rank0]:2025-12-31 06:52:37,680 -  step: 400  loss: -4.0000  grad_norm:  0.2504  memory: 20.42GiB(42.99%)  tps: 7,022  tflops: 54.89  mfu: 17.59%
[rank3]:2025-12-31 06:52:37,681 -  step: 400  loss:  0.2287  grad_norm:  0.2504  memory: 29.23GiB(61.52%)  tps: 7,022  tflops: 54.89  mfu: 17.59%
[rank1]:2025-12-31 06:52:37,666 -  step: 400  loss: -4.0000  grad_norm:  0.2504  memory: 18.49GiB(38.93%)  tps: 7,022  tflops: 54.89  mfu: 17.59%
[rank2]:2025-12-31 06:52:37,738 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_ratio_history/rank2/251231_0652_stage2_step400.svg
[rank0]:2025-12-31 06:52:37,734 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_ratio_history/rank0/251231_0652_stage0_step400.svg
[rank0]:2025-12-31 06:52:37,778 - âœ… Frozen Ratio History of Rank 0 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_ratio_history/rank0/251231_0652_stage4_step400.svg
[rank1]:2025-12-31 06:52:37,735 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_ratio_history/rank1/251231_0652_stage1_step400.svg
[rank1]:2025-12-31 06:52:37,779 - âœ… Frozen Ratio History of Rank 1 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_ratio_history/rank1/251231_0652_stage5_step400.svg
[rank2]:2025-12-31 06:52:37,783 - âœ… Frozen Ratio History of Rank 2 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_ratio_history/rank2/251231_0652_stage6_step400.svg
[rank0]:2025-12-31 06:52:37,879 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_params_histogram/251231_0652_rank0_stage0.svg
[rank0]:	> Counts Sum: 459, Total Sum: 665 (69.02%), Ratio(%) per element: [0.0, 74.28, 74.28, 74.28, 74.28, 74.28, 74.28, 74.28, 74.28, 74.28, 71.42, 71.42, 71.42, 71.42, 71.42, 71.42, 71.42, 71.42, 71.42]
[rank1]:2025-12-31 06:52:37,902 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_params_histogram/251231_0652_rank1_stage1.svg
[rank1]:	> Counts Sum: 675, Total Sum: 945 (71.43%), Ratio(%) per element: [71.42, 71.42, 71.42, 71.42, 71.42, 71.42, 71.42, 71.42, 71.42, 71.42, 71.42, 71.42, 71.42, 71.42, 71.42, 71.42, 71.42, 71.42, 71.42, 71.42, 71.42, 71.42, 71.42, 71.42, 71.42, 71.42, 71.42]
[rank2]:2025-12-31 06:52:37,882 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_params_histogram/251231_0652_rank2_stage2.svg
[rank2]:	> Counts Sum: 486, Total Sum: 630 (77.14%), Ratio(%) per element: [77.14, 77.14, 77.14, 77.14, 77.14, 77.14, 77.14, 77.14, 77.14, 77.14, 77.14, 77.14, 77.14, 77.14, 77.14, 77.14, 77.14, 77.14]
[rank3]:2025-12-31 06:52:37,926 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/pipeline_schedule/251231_0652_step400_rank3.svg
[rank3]:			> Batch Time: 1143.55 ms, GPU Bubble Ratio: 67.35%, 65.45%, 71.44%, 30.45%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-9-17ms       | [S0,MB2,F]  17-8-26ms      | [S0,MB3,F]  26-8-34ms      | [S4,MB0,F]  49-9-58ms      | [S4,MB1,F]  89-8-98ms      | [S4,MB2,F]  129-8-138ms    | [S4,MB3,F]  170-8-179ms    | [S0,MB4,F]  179-9-188ms    | [S0,MB5,F]  188-8-196ms    | [S0,MB6,F]  196-9-206ms    | [S4,MB0,B]  378-14-393ms   | [S0,MB7,F]  393-8-401ms    | [S4,MB1,B]  496-14-510ms   | [S4,MB4,F]  558-8-567ms    | [S4,MB2,B]  567-14-581ms   | [S4,MB5,F]  588-9-597ms    | [S4,MB3,B]  597-14-611ms   | [S4,MB6,F]  618-9-627ms    | [S0,MB0,B]  627-15-642ms   | [S4,MB7,F]  647-8-655ms    | [S0,MB1,B]  655-15-670ms   | [S0,MB2,B]  674-14-689ms   | [S0,MB3,B]  740-14-755ms   | [S4,MB4,B]  768-13-782ms   | [S4,MB5,B]  864-13-877ms   | [S4,MB6,B]  955-13-968ms   | [S4,MB7,B]  1037-13-1050ms | [S0,MB4,B]  1059-14-1073ms | [S0,MB5,B]  1089-14-1103ms | [S0,MB6,B]  1109-14-1123ms | [S0,MB7,B]  1129-14-1143ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  49-11-61ms     | [S1,MB2,F]  89-12-101ms    | [S1,MB3,F]  129-12-141ms   | [S5,MB0,F]  170-8-178ms    | [S5,MB1,F]  184-7-192ms    | [S5,MB2,F]  198-7-206ms    | [S5,MB3,F]  283-7-290ms    | [S1,MB4,F]  308-11-320ms   | [S5,MB0,B]  320-13-334ms   | [S1,MB5,F]  372-14-386ms   | [S5,MB1,B]  386-14-400ms   | [S1,MB6,F]  400-12-412ms   | [S5,MB2,B]  496-14-510ms   | [S1,MB7,F]  510-12-522ms   | [S5,MB3,B]  566-15-581ms   | [S5,MB4,F]  581-8-589ms    | [S1,MB0,B]  596-15-612ms   | [S5,MB5,F]  612-8-620ms    | [S1,MB1,B]  626-15-641ms   | [S5,MB6,F]  641-9-650ms    | [S1,MB2,B]  651-15-667ms   | [S5,MB7,F]  667-10-677ms   | [S1,MB3,B]  677-14-692ms   | [S5,MB4,B]  748-13-762ms   | [S5,MB5,B]  835-13-849ms   | [S5,MB6,B]  925-13-939ms   | [S5,MB7,B]  1017-13-1030ms | [S1,MB4,B]  1036-13-1050ms | [S1,MB5,B]  1068-13-1082ms | [S1,MB6,B]  1088-13-1102ms | [S1,MB7,B]  1108-13-1122ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-7-28ms      | [S2,MB1,F]  61-7-68ms      | [S2,MB2,F]  101-7-109ms    | [S2,MB3,F]  141-7-149ms    | [S6,MB0,F]  178-7-186ms    | [S6,MB1,F]  192-7-199ms    | [S6,MB2,F]  276-7-284ms    | [S6,MB0,B]  284-14-298ms   | [S6,MB3,F]  298-8-307ms    | [S6,MB1,B]  359-16-375ms   | [S2,MB4,F]  375-9-385ms    | [S6,MB2,B]  448-14-463ms   | [S2,MB5,F]  463-8-471ms    | [S6,MB3,B]  539-14-553ms   | [S2,MB6,F]  553-9-562ms    | [S2,MB0,B]  568-10-578ms   | [S2,MB7,F]  578-8-587ms    | [S2,MB1,B]  598-10-608ms   | [S6,MB4,F]  608-7-616ms    | [S2,MB2,B]  627-10-638ms   | [S6,MB5,F]  638-8-646ms    | [S2,MB3,B]  652-10-662ms   | [S6,MB6,F]  663-9-672ms    | [S6,MB4,B]  725-16-741ms   | [S6,MB7,F]  741-8-750ms    | [S6,MB5,B]  815-13-829ms   | [S6,MB6,B]  906-13-919ms   | [S6,MB7,B]  997-13-1010ms  | [S2,MB4,B]  1017-8-1026ms  | [S2,MB5,B]  1053-9-1062ms  | [S2,MB6,B]  1068-8-1077ms  | [S2,MB7,B]  1088-9-1097ms 
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-8-36ms      | [S3,MB1,F]  68-7-76ms      | [S3,MB2,F]  109-7-117ms    | [S3,MB3,F]  149-8-157ms    | [S7,MB0,F]  186-15-201ms   | [S7,MB0,B]  213-53-267ms   | [S7,MB1,F]  267-19-286ms   | [S7,MB1,B]  297-55-352ms   | [S7,MB2,F]  353-21-374ms   | [S7,MB2,B]  384-57-442ms   | [S7,MB3,F]  442-21-463ms   | [S7,MB3,B]  474-57-532ms   | [S3,MB4,F]  532-12-545ms   | [S3,MB0,B]  544-13-558ms   | [S3,MB5,F]  557-12-570ms   | [S3,MB1,B]  569-13-583ms   | [S3,MB6,F]  582-11-594ms   | [S3,MB2,B]  594-12-607ms   | [S3,MB7,F]  607-10-618ms   | [S3,MB3,B]  618-12-631ms   | [S7,MB4,F]  633-18-652ms   | [S7,MB4,B]  663-54-718ms   | [S7,MB5,F]  718-21-739ms   | [S7,MB5,B]  751-57-808ms   | [S7,MB6,F]  808-21-830ms   | [S7,MB6,B]  841-57-899ms   | [S7,MB7,F]  899-21-921ms   | [S7,MB7,B]  932-57-990ms   | [S3,MB4,B]  990-14-1004ms  | [S3,MB5,B]  1004-13-1017ms | [S3,MB6,B]  1017-12-1030ms | [S3,MB7,B]  1044-13-1057ms
[rank3]:2025-12-31 06:52:37,973 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_ratio_history/rank3/251231_0652_stage3_step400.svg
[rank1]:2025-12-31 06:52:38,002 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_params_histogram/251231_0652_rank1_stage5.svg
[rank1]:	> Counts Sum: 225, Total Sum: 630 (35.71%), Ratio(%) per element: [71.42, 71.42, 71.42, 71.42, 71.42, 71.42, 71.42, 71.42, 71.42, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-12-31 06:52:37,990 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_params_histogram/251231_0652_rank2_stage6.svg
[rank2]:	> Counts Sum: 243, Total Sum: 630 (38.57%), Ratio(%) per element: [77.14, 77.14, 77.14, 77.14, 77.14, 77.14, 77.14, 77.14, 77.14, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-12-31 06:52:37,990 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_params_histogram/251231_0652_rank0_stage4.svg
[rank0]:	> Counts Sum: 207, Total Sum: 630 (32.86%), Ratio(%) per element: [65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-31 06:52:38,017 - âœ… Frozen Ratio History of Rank 3 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_ratio_history/rank3/251231_0652_stage7_step400.svg
[rank3]:2025-12-31 06:52:38,116 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_params_histogram/251231_0652_rank3_stage3.svg
[rank3]:	> Counts Sum: 486, Total Sum: 630 (77.14%), Ratio(%) per element: [77.14, 77.14, 77.14, 77.14, 77.14, 77.14, 77.14, 77.14, 77.14, 77.14, 77.14, 77.14, 77.14, 77.14, 77.14, 77.14, 77.14, 77.14]
[rank3]:2025-12-31 06:52:38,194 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_params_histogram/251231_0652_rank3_stage7.svg
[rank3]:	> Counts Sum: 0, Total Sum: 385 (0.00%), Ratio(%) per element: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-31 06:53:04,363 - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-12-31 06:53:04,854 - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-12-31 06:53:04,872 - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-12-31 06:53:04,837 - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-12-31 06:53:20,077 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 2.1177e+00
[rank0]:2025-12-31 06:53:20,093 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 2.0751e+00
[rank2]:2025-12-31 06:53:20,077 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 1.6188e+00
[rank3]:2025-12-31 06:53:20,093 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 1.5942e+00
[rank1]:2025-12-31 06:54:06,625 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 5.4486e+00
[rank0]:2025-12-31 06:54:06,641 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 5.6711e+00
[rank2]:2025-12-31 06:54:06,625 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 5.2501e+00
[rank3]:2025-12-31 06:54:06,641 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 4.9690e+00
[rank2]:2025-12-31 06:54:53,147 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 1.1590e+00
[rank3]:2025-12-31 06:54:53,163 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 1.1155e+00
[rank1]:2025-12-31 06:54:53,148 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 1.1868e+00
[rank0]:2025-12-31 06:54:53,163 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 1.4252e+00
[rank2]:2025-12-31 06:55:39,807 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 2.4956e+00
[rank3]:2025-12-31 06:55:39,823 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 2.5232e+00
[rank1]:2025-12-31 06:55:39,808 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 2.5082e+00
[rank0]:2025-12-31 06:55:39,823 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 2.5171e+00
[rank0]:2025-12-31 06:56:26,552 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-31 06:56:26,558 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 2.4888e+00
[rank2]:2025-12-31 06:56:26,542 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 2.3793e+00
[rank3]:2025-12-31 06:56:26,558 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 2.4461e+00
[rank1]:2025-12-31 06:56:26,543 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 2.2760e+00
[rank3]:2025-12-31 06:56:31,104 - Avg. fwd time: 14.5611 / Avg. bwd time: 36.4956 / Avg. batch time: 1048.7424 (ms) / GPU bubble ratio: 22.11%
[rank2]:2025-12-31 06:56:31,140 - Avg. fwd time: 8.0620 / Avg. bwd time: 14.2046 / Avg. batch time: 1101.2963 (ms) / GPU bubble ratio: 67.65%
[rank1]:2025-12-31 06:56:31,167 - Avg. fwd time: 10.1492 / Avg. bwd time: 17.8087 / Avg. batch time: 1146.7736 (ms) / GPU bubble ratio: 60.99%
[rank1]:2025-12-31 06:56:31,204 -  step: 450  loss: -4.0000  grad_norm:  0.1151  memory: 18.49GiB(38.93%)  tps: 7,016  tflops: 54.84  mfu: 17.58%
[rank0]:2025-12-31 06:56:31,194 - Avg. fwd time: 8.6431 / Avg. bwd time: 16.9039 / Avg. batch time: 1179.5925 (ms) / GPU bubble ratio: 65.35%
[rank0]:2025-12-31 06:56:31,218 -  step: 450  loss: -4.0000  grad_norm:  0.1151  memory: 20.42GiB(42.99%)  tps: 7,016  tflops: 54.84  mfu: 17.58%
[rank2]:2025-12-31 06:56:31,203 -  step: 450  loss: -4.0000  grad_norm:  0.1151  memory: 12.06GiB(25.39%)  tps: 7,016  tflops: 54.84  mfu: 17.58%
[rank3]:2025-12-31 06:56:31,219 -  step: 450  loss:  0.2479  grad_norm:  0.1151  memory: 29.23GiB(61.52%)  tps: 7,016  tflops: 54.84  mfu: 17.58%
[rank1]:2025-12-31 06:57:13,168 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 6.0807e-01
[rank0]:2025-12-31 06:57:13,184 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 3.9825e-01
[rank2]:2025-12-31 06:57:13,168 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 7.8862e-01
[rank3]:2025-12-31 06:57:13,183 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 4.5354e-01
[rank1]:2025-12-31 06:57:59,835 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 7.5465e-01
[rank2]:2025-12-31 06:57:59,835 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 9.8289e-01
[rank0]:2025-12-31 06:57:59,850 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 6.6956e-01
[rank3]:2025-12-31 06:57:59,850 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 1.1996e+00
[rank0]:2025-12-31 06:58:46,659 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 2.9811e-01
[rank2]:2025-12-31 06:58:46,643 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 3.9810e-01
[rank3]:2025-12-31 06:58:46,659 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 4.8864e-01
[rank1]:2025-12-31 06:58:46,643 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 2.3757e-01
[rank1]:2025-12-31 06:59:33,352 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 1.1063e+00
[rank0]:2025-12-31 06:59:33,368 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 8.1319e-01
[rank2]:2025-12-31 06:59:33,352 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 1.2846e+00
[rank3]:2025-12-31 06:59:33,368 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 8.7495e-01
[rank1]:2025-12-31 07:00:19,940 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 1.1746e+00
[rank0]:2025-12-31 07:00:19,937 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-31 07:00:19,956 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 7.6335e-01
[rank2]:2025-12-31 07:00:19,940 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 1.3093e+00
[rank3]:2025-12-31 07:00:19,956 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 7.7583e-01
[rank2]:2025-12-31 07:00:24,569 - Avg. fwd time: 8.0782 / Avg. bwd time: 14.0003 / Avg. batch time: 1098.9103 (ms) / GPU bubble ratio: 67.85%
[rank3]:2025-12-31 07:00:24,533 - Avg. fwd time: 14.5817 / Avg. bwd time: 36.3200 / Avg. batch time: 1046.8647 (ms) / GPU bubble ratio: 22.20%
[rank1]:2025-12-31 07:00:24,596 - Avg. fwd time: 10.1670 / Avg. bwd time: 17.4602 / Avg. batch time: 1143.5470 (ms) / GPU bubble ratio: 61.35%
[rank1]:2025-12-31 07:00:24,633 -  step: 500  loss: -4.0000  grad_norm:  0.2027  memory: 18.49GiB(38.93%)  tps: 7,019  tflops: 54.87  mfu: 17.59%
[rank0]:2025-12-31 07:00:24,624 - Avg. fwd time: 8.6621 / Avg. bwd time: 16.6578 / Avg. batch time: 1176.0472 (ms) / GPU bubble ratio: 65.55%
[rank0]:2025-12-31 07:00:24,647 -  step: 500  loss: -4.0000  grad_norm:  0.2027  memory: 20.42GiB(42.99%)  tps: 7,019  tflops: 54.87  mfu: 17.59%
[rank2]:2025-12-31 07:00:24,633 -  step: 500  loss: -4.0000  grad_norm:  0.2027  memory: 12.06GiB(25.39%)  tps: 7,019  tflops: 54.87  mfu: 17.59%
[rank2]:2025-12-31 07:00:24,698 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_ratio_history/rank2/251231_0700_stage2_step500.svg
[rank3]:2025-12-31 07:00:24,648 -  step: 500  loss:  0.2480  grad_norm:  0.2027  memory: 29.23GiB(61.52%)  tps: 7,019  tflops: 54.87  mfu: 17.59%
[rank1]:2025-12-31 07:00:24,697 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_ratio_history/rank1/251231_0700_stage1_step500.svg
[rank1]:2025-12-31 07:00:24,737 - âœ… Frozen Ratio History of Rank 1 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_ratio_history/rank1/251231_0700_stage5_step500.svg
[rank0]:2025-12-31 07:00:24,696 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_ratio_history/rank0/251231_0700_stage0_step500.svg
[rank0]:2025-12-31 07:00:24,736 - âœ… Frozen Ratio History of Rank 0 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_ratio_history/rank0/251231_0700_stage4_step500.svg
[rank2]:2025-12-31 07:00:24,739 - âœ… Frozen Ratio History of Rank 2 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_ratio_history/rank2/251231_0700_stage6_step500.svg
[rank0]:2025-12-31 07:00:24,837 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_params_histogram/251231_0700_rank0_stage0.svg
[rank0]:	> Counts Sum: 639, Total Sum: 855 (74.74%), Ratio(%) per element: [0.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 77.77, 77.77, 77.77, 77.77, 77.77, 77.77, 77.77, 77.77, 77.77]
[rank2]:2025-12-31 07:00:24,839 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_params_histogram/251231_0700_rank2_stage2.svg
[rank2]:	> Counts Sum: 666, Total Sum: 810 (82.22%), Ratio(%) per element: [82.22, 82.22, 82.22, 82.22, 82.22, 82.22, 82.22, 82.22, 82.22, 82.22, 82.22, 82.22, 82.22, 82.22, 82.22, 82.22, 82.22, 82.22]
[rank3]:2025-12-31 07:00:24,894 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/pipeline_schedule/251231_0700_step500_rank3.svg
[rank3]:			> Batch Time: 1142.56 ms, GPU Bubble Ratio: 67.33%, 65.51%, 71.44%, 30.50%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-9-17ms       | [S0,MB2,F]  17-8-26ms      | [S0,MB3,F]  26-8-34ms      | [S4,MB0,F]  49-9-58ms      | [S4,MB1,F]  89-8-97ms      | [S4,MB2,F]  129-8-138ms    | [S4,MB3,F]  169-8-178ms    | [S0,MB4,F]  178-9-188ms    | [S0,MB5,F]  188-8-196ms    | [S0,MB6,F]  196-9-205ms    | [S4,MB0,B]  378-14-393ms   | [S0,MB7,F]  393-8-401ms    | [S4,MB1,B]  497-14-511ms   | [S4,MB4,F]  558-8-567ms    | [S4,MB2,B]  567-14-582ms   | [S4,MB5,F]  588-8-597ms    | [S4,MB3,B]  597-14-612ms   | [S4,MB6,F]  618-9-627ms    | [S0,MB0,B]  627-15-642ms   | [S4,MB7,F]  647-7-654ms    | [S0,MB1,B]  655-15-670ms   | [S0,MB2,B]  675-14-689ms   | [S0,MB3,B]  740-14-755ms   | [S4,MB4,B]  768-13-782ms   | [S4,MB5,B]  862-13-876ms   | [S4,MB6,B]  953-13-967ms   | [S4,MB7,B]  1036-13-1049ms | [S0,MB4,B]  1058-14-1072ms | [S0,MB5,B]  1088-14-1102ms | [S0,MB6,B]  1108-14-1122ms | [S0,MB7,B]  1128-14-1142ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-11-20ms      | [S1,MB1,F]  49-11-60ms     | [S1,MB2,F]  89-11-101ms    | [S1,MB3,F]  129-11-141ms   | [S5,MB0,F]  169-7-177ms    | [S5,MB1,F]  184-7-191ms    | [S5,MB2,F]  198-7-205ms    | [S5,MB3,F]  282-7-289ms    | [S1,MB4,F]  307-11-319ms   | [S5,MB0,B]  319-13-333ms   | [S1,MB5,F]  371-14-385ms   | [S5,MB1,B]  385-14-399ms   | [S1,MB6,F]  399-12-412ms   | [S5,MB2,B]  496-14-510ms   | [S1,MB7,F]  510-12-523ms   | [S5,MB3,B]  566-15-581ms   | [S5,MB4,F]  582-8-590ms    | [S1,MB0,B]  597-15-612ms   | [S5,MB5,F]  612-8-621ms    | [S1,MB1,B]  626-15-641ms   | [S5,MB6,F]  642-9-651ms    | [S1,MB2,B]  651-15-667ms   | [S5,MB7,F]  667-9-677ms    | [S1,MB3,B]  677-14-692ms   | [S5,MB4,B]  748-13-762ms   | [S5,MB5,B]  834-13-848ms   | [S5,MB6,B]  924-13-938ms   | [S5,MB7,B]  1015-13-1029ms | [S1,MB4,B]  1035-13-1049ms | [S1,MB5,B]  1067-13-1081ms | [S1,MB6,B]  1087-13-1101ms | [S1,MB7,B]  1107-13-1121ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-7-28ms      | [S2,MB1,F]  60-7-68ms      | [S2,MB2,F]  101-7-108ms    | [S2,MB3,F]  141-7-149ms    | [S6,MB0,F]  177-7-185ms    | [S6,MB1,F]  192-7-199ms    | [S6,MB2,F]  276-7-283ms    | [S6,MB0,B]  283-14-298ms   | [S6,MB3,F]  298-8-307ms    | [S6,MB1,B]  359-16-375ms   | [S2,MB4,F]  375-9-384ms    | [S6,MB2,B]  448-14-463ms   | [S2,MB5,F]  463-7-471ms    | [S6,MB3,B]  539-14-554ms   | [S2,MB6,F]  554-9-563ms    | [S2,MB0,B]  568-10-579ms   | [S2,MB7,F]  579-8-587ms    | [S2,MB1,B]  598-10-609ms   | [S6,MB4,F]  609-7-616ms    | [S2,MB2,B]  627-10-638ms   | [S6,MB5,F]  638-8-646ms    | [S2,MB3,B]  653-10-663ms   | [S6,MB6,F]  662-9-671ms    | [S6,MB4,B]  725-16-741ms   | [S6,MB7,F]  742-8-750ms    | [S6,MB5,B]  814-13-828ms   | [S6,MB6,B]  905-13-918ms   | [S6,MB7,B]  996-13-1009ms  | [S2,MB4,B]  1016-8-1025ms  | [S2,MB5,B]  1052-9-1061ms  | [S2,MB6,B]  1067-8-1076ms  | [S2,MB7,B]  1087-9-1096ms 
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-7-36ms      | [S3,MB1,F]  68-7-76ms      | [S3,MB2,F]  108-7-116ms    | [S3,MB3,F]  149-7-157ms    | [S7,MB0,F]  185-15-201ms   | [S7,MB0,B]  213-53-266ms   | [S7,MB1,F]  266-18-285ms   | [S7,MB1,B]  296-56-352ms   | [S7,MB2,F]  353-20-373ms   | [S7,MB2,B]  384-57-441ms   | [S7,MB3,F]  442-21-463ms   | [S7,MB3,B]  475-58-533ms   | [S3,MB4,F]  533-12-545ms   | [S3,MB0,B]  545-13-559ms   | [S3,MB5,F]  559-12-571ms   | [S3,MB1,B]  571-13-584ms   | [S3,MB6,F]  584-11-596ms   | [S3,MB2,B]  596-12-608ms   | [S3,MB7,F]  609-10-619ms   | [S3,MB3,B]  619-12-631ms   | [S7,MB4,F]  634-18-652ms   | [S7,MB4,B]  664-54-719ms   | [S7,MB5,F]  718-21-739ms   | [S7,MB5,B]  751-56-808ms   | [S7,MB6,F]  808-21-829ms   | [S7,MB6,B]  841-57-898ms   | [S7,MB7,F]  898-21-919ms   | [S7,MB7,B]  931-57-989ms   | [S3,MB4,B]  989-14-1003ms  | [S3,MB5,B]  1003-13-1016ms | [S3,MB6,B]  1016-12-1029ms | [S3,MB7,B]  1043-13-1056ms
[rank1]:2025-12-31 07:00:24,861 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_params_histogram/251231_0700_rank1_stage1.svg
[rank1]:	> Counts Sum: 945, Total Sum: 1215 (77.78%), Ratio(%) per element: [77.77, 77.77, 77.77, 77.77, 77.77, 77.77, 77.77, 77.77, 77.77, 77.77, 77.77, 77.77, 77.77, 77.77, 77.77, 77.77, 77.77, 77.77, 77.77, 77.77, 77.77, 77.77, 77.77, 77.77, 77.77, 77.77, 77.77]
[rank0]:2025-12-31 07:00:24,939 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_params_histogram/251231_0700_rank0_stage4.svg
[rank0]:	> Counts Sum: 297, Total Sum: 810 (36.67%), Ratio(%) per element: [73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-12-31 07:00:24,937 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_params_histogram/251231_0700_rank2_stage6.svg
[rank2]:	> Counts Sum: 333, Total Sum: 810 (41.11%), Ratio(%) per element: [82.22, 82.22, 82.22, 82.22, 82.22, 82.22, 82.22, 82.22, 82.22, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-31 07:00:24,937 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_ratio_history/rank3/251231_0700_stage3_step500.svg
[rank3]:2025-12-31 07:00:24,990 - âœ… Frozen Ratio History of Rank 3 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_ratio_history/rank3/251231_0700_stage7_step500.svg
[rank1]:2025-12-31 07:00:24,974 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_params_histogram/251231_0700_rank1_stage5.svg
[rank1]:	> Counts Sum: 315, Total Sum: 810 (38.89%), Ratio(%) per element: [77.77, 77.77, 77.77, 77.77, 77.77, 77.77, 77.77, 77.77, 77.77, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-31 07:00:25,090 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_params_histogram/251231_0700_rank3_stage3.svg
[rank3]:	> Counts Sum: 666, Total Sum: 810 (82.22%), Ratio(%) per element: [82.22, 82.22, 82.22, 82.22, 82.22, 82.22, 82.22, 82.22, 82.22, 82.22, 82.22, 82.22, 82.22, 82.22, 82.22, 82.22, 82.22, 82.22]
[rank3]:2025-12-31 07:00:25,169 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_params_histogram/251231_0700_rank3_stage7.svg
[rank3]:	> Counts Sum: 0, Total Sum: 495 (0.00%), Ratio(%) per element: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-12-31 07:01:07,137 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 1.6477e+00
[rank2]:2025-12-31 07:01:07,121 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 1.3006e+00
[rank3]:2025-12-31 07:01:07,137 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 9.7571e-01
[rank1]:2025-12-31 07:01:07,121 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 1.4683e+00
[rank0]:2025-12-31 07:01:53,800 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 2.2272e+00
[rank2]:2025-12-31 07:01:53,784 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 1.7827e+00
[rank3]:2025-12-31 07:01:53,800 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 1.8941e+00
[rank1]:2025-12-31 07:01:53,784 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 1.9484e+00
[rank0]:2025-12-31 07:02:40,563 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 5.1203e-01
[rank2]:2025-12-31 07:02:40,548 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 1.0573e+00
[rank3]:2025-12-31 07:02:40,563 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 5.8050e-01
[rank1]:2025-12-31 07:02:40,548 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 8.5815e-01
[rank2]:2025-12-31 07:03:27,129 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 1.0901e+00
[rank1]:2025-12-31 07:03:27,130 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 9.7114e-01
[rank0]:2025-12-31 07:03:27,145 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 6.7122e-01
[rank3]:2025-12-31 07:03:27,145 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 7.5995e-01
[rank1]:2025-12-31 07:04:13,722 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 9.2944e-01
[rank0]:2025-12-31 07:04:13,731 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-31 07:04:13,738 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 8.6888e-01
[rank3]:2025-12-31 07:04:13,738 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 1.1550e+00
[rank2]:2025-12-31 07:04:13,722 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 1.0405e+00
[rank3]:2025-12-31 07:04:18,328 - Avg. fwd time: 14.5899 / Avg. bwd time: 36.1806 / Avg. batch time: 1045.2821 (ms) / GPU bubble ratio: 22.29%
[rank2]:2025-12-31 07:04:18,364 - Avg. fwd time: 8.0919 / Avg. bwd time: 13.8335 / Avg. batch time: 1096.9893 (ms) / GPU bubble ratio: 68.02%
[rank1]:2025-12-31 07:04:18,392 - Avg. fwd time: 10.1830 / Avg. bwd time: 17.1757 / Avg. batch time: 1140.9394 (ms) / GPU bubble ratio: 61.63%
[rank1]:2025-12-31 07:04:18,429 -  step: 550  loss: -4.0000  grad_norm:  0.1614  memory: 18.49GiB(38.93%)  tps: 7,008  tflops: 54.78  mfu: 17.56%
[rank0]:2025-12-31 07:04:18,420 - Avg. fwd time: 8.6780 / Avg. bwd time: 16.4564 / Avg. batch time: 1173.1930 (ms) / GPU bubble ratio: 65.72%
[rank0]:2025-12-31 07:04:18,443 -  step: 550  loss: -4.0000  grad_norm:  0.1614  memory: 20.42GiB(42.99%)  tps: 7,008  tflops: 54.78  mfu: 17.56%
[rank3]:2025-12-31 07:04:18,444 -  step: 550  loss:  0.2522  grad_norm:  0.1614  memory: 29.23GiB(61.52%)  tps: 7,008  tflops: 54.78  mfu: 17.56%
[rank2]:2025-12-31 07:04:18,429 -  step: 550  loss: -4.0000  grad_norm:  0.1614  memory: 12.06GiB(25.39%)  tps: 7,008  tflops: 54.78  mfu: 17.56%
[rank2]:2025-12-31 07:05:00,511 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 2.2712e+00
[rank3]:2025-12-31 07:05:00,526 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 2.0230e+00
[rank0]:2025-12-31 07:05:00,526 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 2.0972e+00
[rank1]:2025-12-31 07:05:00,511 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 2.7500e+00
[rank1]:2025-12-31 07:05:47,351 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 1.9527e+00
[rank2]:2025-12-31 07:05:47,351 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 1.7318e+00
[rank3]:2025-12-31 07:05:47,367 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 1.4379e+00
[rank0]:2025-12-31 07:05:47,367 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 1.6230e+00
[rank2]:2025-12-31 07:06:34,043 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 2.5379e+00
[rank3]:2025-12-31 07:06:34,058 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 1.0643e+00
[rank0]:2025-12-31 07:06:34,059 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 1.8306e+00
[rank1]:2025-12-31 07:06:34,043 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 2.3300e+00
[rank2]:2025-12-31 07:07:20,795 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 1.7608e+00
[rank3]:2025-12-31 07:07:20,811 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 9.5145e-01
[rank0]:2025-12-31 07:07:20,811 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 1.4909e+00
[rank1]:2025-12-31 07:07:20,795 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 1.4591e+00
[rank1]:2025-12-31 07:08:07,521 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 2.0275e-01
[rank2]:2025-12-31 07:08:07,521 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 4.0619e-01
[rank3]:2025-12-31 07:08:07,536 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 2.5156e-01
[rank0]:2025-12-31 07:08:07,517 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-31 07:08:07,536 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 2.9229e-01
[rank3]:2025-12-31 07:08:12,192 - Avg. fwd time: 14.6033 / Avg. bwd time: 36.0727 / Avg. batch time: 1044.1619 (ms) / GPU bubble ratio: 22.35%
[rank1]:2025-12-31 07:08:12,259 - Avg. fwd time: 10.1966 / Avg. bwd time: 16.9382 / Avg. batch time: 1138.8885 (ms) / GPU bubble ratio: 61.88%
[rank2]:2025-12-31 07:08:12,229 - Avg. fwd time: 8.1037 / Avg. bwd time: 13.6945 / Avg. batch time: 1095.5100 (ms) / GPU bubble ratio: 68.16%
[rank2]:2025-12-31 07:08:12,297 -  step: 600  loss: -4.0000  grad_norm:  0.2863  memory: 12.06GiB(25.39%)  tps: 7,006  tflops: 54.77  mfu: 17.55%
[rank0]:2025-12-31 07:08:12,288 - Avg. fwd time: 8.6913 / Avg. bwd time: 16.2879 / Avg. batch time: 1170.9257 (ms) / GPU bubble ratio: 65.87%
[rank0]:2025-12-31 07:08:12,311 -  step: 600  loss: -4.0000  grad_norm:  0.2863  memory: 20.42GiB(42.99%)  tps: 7,006  tflops: 54.77  mfu: 17.55%
[rank1]:2025-12-31 07:08:12,297 -  step: 600  loss: -4.0000  grad_norm:  0.2863  memory: 18.49GiB(38.93%)  tps: 7,006  tflops: 54.77  mfu: 17.55%
[rank2]:2025-12-31 07:08:12,369 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_ratio_history/rank2/251231_0708_stage2_step600.svg
[rank3]:2025-12-31 07:08:12,312 -  step: 600  loss:  0.2420  grad_norm:  0.2863  memory: 29.23GiB(61.52%)  tps: 7,006  tflops: 54.77  mfu: 17.55%
[rank0]:2025-12-31 07:08:12,367 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_ratio_history/rank0/251231_0708_stage0_step600.svg
[rank0]:2025-12-31 07:08:12,409 - âœ… Frozen Ratio History of Rank 0 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_ratio_history/rank0/251231_0708_stage4_step600.svg
[rank1]:2025-12-31 07:08:12,368 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_ratio_history/rank1/251231_0708_stage1_step600.svg
[rank1]:2025-12-31 07:08:12,410 - âœ… Frozen Ratio History of Rank 1 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_ratio_history/rank1/251231_0708_stage5_step600.svg
[rank2]:2025-12-31 07:08:12,412 - âœ… Frozen Ratio History of Rank 2 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_ratio_history/rank2/251231_0708_stage6_step600.svg
[rank0]:2025-12-31 07:08:12,510 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_params_histogram/251231_0708_rank0_stage0.svg
[rank0]:	> Counts Sum: 819, Total Sum: 1045 (78.37%), Ratio(%) per element: [0.0, 83.63, 83.63, 83.63, 83.63, 83.63, 83.63, 83.63, 83.63, 83.63, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81]
[rank1]:2025-12-31 07:08:12,534 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_params_histogram/251231_0708_rank1_stage1.svg
[rank1]:	> Counts Sum: 1215, Total Sum: 1485 (81.82%), Ratio(%) per element: [81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81]
[rank2]:2025-12-31 07:08:12,511 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_params_histogram/251231_0708_rank2_stage2.svg
[rank2]:	> Counts Sum: 846, Total Sum: 990 (85.45%), Ratio(%) per element: [85.45, 85.45, 85.45, 85.45, 85.45, 85.45, 85.45, 85.45, 85.45, 85.45, 85.45, 85.45, 85.45, 85.45, 85.45, 85.45, 85.45, 85.45]
[rank3]:2025-12-31 07:08:12,575 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/pipeline_schedule/251231_0708_step600_rank3.svg
[rank3]:			> Batch Time: 1146.55 ms, GPU Bubble Ratio: 67.44%, 65.55%, 71.52%, 30.53%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-9-17ms       | [S0,MB2,F]  17-8-26ms      | [S0,MB3,F]  26-8-34ms      | [S4,MB0,F]  49-9-58ms      | [S4,MB1,F]  89-8-98ms      | [S4,MB2,F]  129-8-138ms    | [S4,MB3,F]  170-8-179ms    | [S0,MB4,F]  179-9-188ms    | [S0,MB5,F]  188-8-196ms    | [S0,MB6,F]  196-9-206ms    | [S4,MB0,B]  378-14-393ms   | [S0,MB7,F]  393-8-401ms    | [S4,MB1,B]  497-14-511ms   | [S4,MB4,F]  558-8-567ms    | [S4,MB2,B]  567-14-582ms   | [S4,MB5,F]  589-9-598ms    | [S4,MB3,B]  598-14-612ms   | [S4,MB6,F]  619-9-628ms    | [S0,MB0,B]  628-15-643ms   | [S4,MB7,F]  647-8-655ms    | [S0,MB1,B]  656-15-671ms   | [S0,MB2,B]  675-14-690ms   | [S0,MB3,B]  743-14-757ms   | [S4,MB4,B]  770-13-784ms   | [S4,MB5,B]  865-13-879ms   | [S4,MB6,B]  957-13-970ms   | [S4,MB7,B]  1039-13-1052ms | [S0,MB4,B]  1061-14-1075ms | [S0,MB5,B]  1091-14-1105ms | [S0,MB6,B]  1111-14-1125ms | [S0,MB7,B]  1132-14-1146ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  49-12-61ms     | [S1,MB2,F]  89-12-101ms    | [S1,MB3,F]  129-11-141ms   | [S5,MB0,F]  170-7-178ms    | [S5,MB1,F]  184-7-191ms    | [S5,MB2,F]  198-7-206ms    | [S5,MB3,F]  283-7-290ms    | [S1,MB4,F]  308-11-320ms   | [S5,MB0,B]  320-13-334ms   | [S1,MB5,F]  371-14-386ms   | [S5,MB1,B]  386-14-400ms   | [S1,MB6,F]  400-12-413ms   | [S5,MB2,B]  497-14-511ms   | [S1,MB7,F]  511-12-523ms   | [S5,MB3,B]  567-15-582ms   | [S5,MB4,F]  582-8-590ms    | [S1,MB0,B]  597-15-612ms   | [S5,MB5,F]  613-8-621ms    | [S1,MB1,B]  626-15-642ms   | [S5,MB6,F]  642-9-651ms    | [S1,MB2,B]  652-15-668ms   | [S5,MB7,F]  668-10-678ms   | [S1,MB3,B]  678-14-693ms   | [S5,MB4,B]  750-13-764ms   | [S5,MB5,B]  837-13-851ms   | [S5,MB6,B]  928-13-941ms   | [S5,MB7,B]  1019-13-1033ms | [S1,MB4,B]  1039-13-1053ms | [S1,MB5,B]  1071-13-1085ms | [S1,MB6,B]  1091-13-1105ms | [S1,MB7,B]  1111-13-1125ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-7-28ms      | [S2,MB1,F]  61-7-68ms      | [S2,MB2,F]  101-7-109ms    | [S2,MB3,F]  141-7-149ms    | [S6,MB0,F]  178-7-185ms    | [S6,MB1,F]  192-7-199ms    | [S6,MB2,F]  276-7-284ms    | [S6,MB0,B]  284-14-298ms   | [S6,MB3,F]  298-8-307ms    | [S6,MB1,B]  359-16-375ms   | [S2,MB4,F]  376-9-385ms    | [S6,MB2,B]  450-14-465ms   | [S2,MB5,F]  464-8-472ms    | [S6,MB3,B]  539-14-554ms   | [S2,MB6,F]  554-8-563ms    | [S2,MB0,B]  568-10-579ms   | [S2,MB7,F]  579-8-587ms    | [S2,MB1,B]  598-10-609ms   | [S6,MB4,F]  609-7-617ms    | [S2,MB2,B]  628-10-638ms   | [S6,MB5,F]  639-8-647ms    | [S2,MB3,B]  653-10-663ms   | [S6,MB6,F]  663-9-672ms    | [S6,MB4,B]  727-16-743ms   | [S6,MB7,F]  744-8-752ms    | [S6,MB5,B]  817-13-831ms   | [S6,MB6,B]  908-13-921ms   | [S6,MB7,B]  999-13-1012ms  | [S2,MB4,B]  1019-9-1028ms  | [S2,MB5,B]  1055-8-1064ms  | [S2,MB6,B]  1070-8-1079ms  | [S2,MB7,B]  1090-9-1099ms 
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-8-36ms      | [S3,MB1,F]  68-8-76ms      | [S3,MB2,F]  109-7-117ms    | [S3,MB3,F]  149-7-157ms    | [S7,MB0,F]  186-15-201ms   | [S7,MB0,B]  213-53-267ms   | [S7,MB1,F]  267-18-286ms   | [S7,MB1,B]  297-55-352ms   | [S7,MB2,F]  353-21-374ms   | [S7,MB2,B]  385-57-443ms   | [S7,MB3,F]  443-21-464ms   | [S7,MB3,B]  475-58-533ms   | [S3,MB4,F]  533-13-546ms   | [S3,MB0,B]  545-13-559ms   | [S3,MB5,F]  558-12-571ms   | [S3,MB1,B]  570-13-583ms   | [S3,MB6,F]  584-11-596ms   | [S3,MB2,B]  596-12-609ms   | [S3,MB7,F]  608-10-619ms   | [S3,MB3,B]  619-12-632ms   | [S7,MB4,F]  634-18-653ms   | [S7,MB4,B]  664-54-719ms   | [S7,MB5,F]  720-21-742ms   | [S7,MB5,B]  753-57-810ms   | [S7,MB6,F]  810-21-831ms   | [S7,MB6,B]  843-57-901ms   | [S7,MB7,F]  901-21-923ms   | [S7,MB7,B]  935-57-993ms   | [S3,MB4,B]  992-14-1006ms  | [S3,MB5,B]  1007-13-1020ms | [S3,MB6,B]  1020-12-1032ms | [S3,MB7,B]  1046-13-1060ms
[rank0]:2025-12-31 07:08:12,609 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_params_histogram/251231_0708_rank0_stage4.svg
[rank0]:	> Counts Sum: 387, Total Sum: 990 (39.09%), Ratio(%) per element: [78.18, 78.18, 78.18, 78.18, 78.18, 78.18, 78.18, 78.18, 78.18, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-12-31 07:08:12,632 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_params_histogram/251231_0708_rank1_stage5.svg
[rank1]:	> Counts Sum: 405, Total Sum: 990 (40.91%), Ratio(%) per element: [81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-12-31 07:08:12,612 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_params_histogram/251231_0708_rank2_stage6.svg
[rank2]:	> Counts Sum: 423, Total Sum: 990 (42.73%), Ratio(%) per element: [85.45, 85.45, 85.45, 85.45, 85.45, 85.45, 85.45, 85.45, 85.45, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-31 07:08:12,621 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_ratio_history/rank3/251231_0708_stage3_step600.svg
[rank3]:2025-12-31 07:08:12,663 - âœ… Frozen Ratio History of Rank 3 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_ratio_history/rank3/251231_0708_stage7_step600.svg
[rank3]:2025-12-31 07:08:12,764 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_params_histogram/251231_0708_rank3_stage3.svg
[rank3]:	> Counts Sum: 846, Total Sum: 990 (85.45%), Ratio(%) per element: [85.45, 85.45, 85.45, 85.45, 85.45, 85.45, 85.45, 85.45, 85.45, 85.45, 85.45, 85.45, 85.45, 85.45, 85.45, 85.45, 85.45, 85.45]
[rank3]:2025-12-31 07:08:12,844 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_params_histogram/251231_0708_rank3_stage7.svg
[rank3]:	> Counts Sum: 0, Total Sum: 605 (0.00%), Ratio(%) per element: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-12-31 07:08:54,897 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 4.4716e-01
[rank3]:2025-12-31 07:08:54,913 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 9.3469e-01
[rank2]:2025-12-31 07:08:54,897 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 6.1198e-01
[rank0]:2025-12-31 07:08:54,913 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 2.7785e-01
[rank1]:2025-12-31 07:09:41,549 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 1.3136e+00
[rank3]:2025-12-31 07:09:41,564 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 1.6553e+00
[rank2]:2025-12-31 07:09:41,549 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 1.4899e+00
[rank0]:2025-12-31 07:09:41,564 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 1.2232e+00
[rank2]:2025-12-31 07:10:28,255 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 4.5159e-01
[rank0]:2025-12-31 07:10:28,270 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 6.5790e-01
[rank1]:2025-12-31 07:10:28,255 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 6.4689e-01
[rank3]:2025-12-31 07:10:28,270 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 6.4857e-01
[rank1]:2025-12-31 07:11:14,985 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 7.2899e-01
[rank3]:2025-12-31 07:11:15,000 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 6.3239e-01
[rank2]:2025-12-31 07:11:14,985 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 6.1732e-01
[rank0]:2025-12-31 07:11:15,000 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 6.9868e-01
[rank1]:2025-12-31 07:12:01,619 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 9.0208e-01
[rank3]:2025-12-31 07:12:01,635 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 8.7100e-01
[rank0]:2025-12-31 07:12:01,629 - [GC] Peforming periodical GC collection 0.02 seconds
[rank0]:2025-12-31 07:12:01,635 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 4.7296e-01
[rank2]:2025-12-31 07:12:01,619 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 1.0237e+00
[rank1]:2025-12-31 07:12:06,270 - Avg. fwd time: 10.2084 / Avg. bwd time: 16.7380 / Avg. batch time: 1137.1184 (ms) / GPU bubble ratio: 62.08%
[rank3]:2025-12-31 07:12:06,205 - Avg. fwd time: 14.6101 / Avg. bwd time: 35.9787 / Avg. batch time: 1043.1061 (ms) / GPU bubble ratio: 22.40%
[rank0]:2025-12-31 07:12:06,299 - Avg. fwd time: 8.7027 / Avg. bwd time: 16.1460 / Avg. batch time: 1168.9761 (ms) / GPU bubble ratio: 65.99%
[rank2]:2025-12-31 07:12:06,241 - Avg. fwd time: 8.1132 / Avg. bwd time: 13.5765 / Avg. batch time: 1094.2221 (ms) / GPU bubble ratio: 68.28%
[rank2]:2025-12-31 07:12:06,308 -  step: 650  loss: -4.0000  grad_norm:  0.1326  memory: 12.06GiB(25.39%)  tps: 7,001  tflops: 54.73  mfu: 17.54%
[rank1]:2025-12-31 07:12:06,308 -  step: 650  loss: -4.0000  grad_norm:  0.1326  memory: 18.49GiB(38.93%)  tps: 7,001  tflops: 54.73  mfu: 17.54%
[rank3]:2025-12-31 07:12:06,323 -  step: 650  loss:  0.2524  grad_norm:  0.1326  memory: 29.23GiB(61.52%)  tps: 7,001  tflops: 54.73  mfu: 17.54%
[rank0]:2025-12-31 07:12:06,322 -  step: 650  loss: -4.0000  grad_norm:  0.1326  memory: 20.42GiB(42.99%)  tps: 7,001  tflops: 54.73  mfu: 17.54%
[rank0]:2025-12-31 07:12:48,270 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 8.8214e-01
[rank2]:2025-12-31 07:12:48,254 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 1.1840e+00
[rank1]:2025-12-31 07:12:48,254 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 9.7668e-01
[rank3]:2025-12-31 07:12:48,270 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 7.4478e-01
[rank0]:2025-12-31 07:13:34,720 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 3.6203e-01
[rank2]:2025-12-31 07:13:34,705 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 5.7476e-01
[rank1]:2025-12-31 07:13:34,705 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 2.0682e-01
[rank3]:2025-12-31 07:13:34,720 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 4.1690e-01
[rank1]:2025-12-31 07:14:21,436 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 9.2204e-01
[rank3]:2025-12-31 07:14:21,451 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 1.1856e+00
[rank0]:2025-12-31 07:14:21,451 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 1.1151e+00
[rank2]:2025-12-31 07:14:21,435 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 8.8206e-01
[rank2]:2025-12-31 07:15:08,149 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 6.5347e-01
[rank1]:2025-12-31 07:15:08,149 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 8.6993e-01
[rank3]:2025-12-31 07:15:08,164 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 7.2483e-01
[rank0]:2025-12-31 07:15:08,164 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 5.5541e-01
[rank3]:2025-12-31 07:15:54,796 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 3.4045e+00
[rank0]:2025-12-31 07:15:54,776 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-31 07:15:54,796 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 3.5758e+00
[rank2]:2025-12-31 07:15:54,780 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 3.1778e+00
[rank1]:2025-12-31 07:15:54,780 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 3.3522e+00
[rank3]:2025-12-31 07:15:59,338 - Avg. fwd time: 14.6121 / Avg. bwd time: 35.8903 / Avg. batch time: 1042.0597 (ms) / GPU bubble ratio: 22.46%
[rank2]:2025-12-31 07:15:59,375 - Avg. fwd time: 8.1207 / Avg. bwd time: 13.4746 / Avg. batch time: 1092.9104 (ms) / GPU bubble ratio: 68.38%
[rank1]:2025-12-31 07:15:59,404 - Avg. fwd time: 10.2174 / Avg. bwd time: 16.5650 / Avg. batch time: 1135.3915 (ms) / GPU bubble ratio: 62.26%
[rank1]:2025-12-31 07:15:59,443 -  step: 700  loss: -4.0000  grad_norm:  0.0990  memory: 18.49GiB(38.93%)  tps: 7,028  tflops: 54.94  mfu: 17.61%
[rank3]:2025-12-31 07:15:59,458 -  step: 700  loss:  0.2179  grad_norm:  0.0990  memory: 29.23GiB(61.52%)  tps: 7,028  tflops: 54.94  mfu: 17.61%
[rank0]:2025-12-31 07:15:59,434 - Avg. fwd time: 8.7115 / Avg. bwd time: 16.0230 / Avg. batch time: 1167.0883 (ms) / GPU bubble ratio: 66.09%
[rank0]:2025-12-31 07:15:59,457 -  step: 700  loss: -4.0000  grad_norm:  0.0990  memory: 20.42GiB(42.99%)  tps: 7,028  tflops: 54.94  mfu: 17.61%
[rank0]:2025-12-31 07:15:59,510 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_ratio_history/rank0/251231_0715_stage0_step700.svg
[rank2]:2025-12-31 07:15:59,443 -  step: 700  loss: -4.0000  grad_norm:  0.0990  memory: 12.06GiB(25.39%)  tps: 7,028  tflops: 54.94  mfu: 17.61%
[rank2]:2025-12-31 07:15:59,511 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_ratio_history/rank2/251231_0715_stage2_step700.svg
[rank1]:2025-12-31 07:15:59,511 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_ratio_history/rank1/251231_0715_stage1_step700.svg
[rank1]:2025-12-31 07:15:59,555 - âœ… Frozen Ratio History of Rank 1 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_ratio_history/rank1/251231_0715_stage5_step700.svg
[rank0]:2025-12-31 07:15:59,554 - âœ… Frozen Ratio History of Rank 0 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_ratio_history/rank0/251231_0715_stage4_step700.svg
[rank2]:2025-12-31 07:15:59,556 - âœ… Frozen Ratio History of Rank 2 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_ratio_history/rank2/251231_0715_stage6_step700.svg
[rank3]:2025-12-31 07:15:59,703 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/pipeline_schedule/251231_0715_step700_rank3.svg
[rank3]:			> Batch Time: 1141.55 ms, GPU Bubble Ratio: 67.32%, 65.45%, 71.45%, 30.44%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-9-17ms       | [S0,MB2,F]  17-8-26ms      | [S0,MB3,F]  26-8-34ms      | [S4,MB0,F]  49-9-58ms      | [S4,MB1,F]  89-8-98ms      | [S4,MB2,F]  129-8-138ms    | [S4,MB3,F]  169-8-178ms    | [S0,MB4,F]  178-9-187ms    | [S0,MB5,F]  188-8-196ms    | [S0,MB6,F]  196-9-205ms    | [S4,MB0,B]  378-14-393ms   | [S0,MB7,F]  393-8-401ms    | [S4,MB1,B]  495-14-510ms   | [S4,MB4,F]  557-8-566ms    | [S4,MB2,B]  566-14-581ms   | [S4,MB5,F]  587-8-596ms    | [S4,MB3,B]  596-14-611ms   | [S4,MB6,F]  617-9-626ms    | [S0,MB0,B]  627-15-642ms   | [S4,MB7,F]  646-8-654ms    | [S0,MB1,B]  654-15-669ms   | [S0,MB2,B]  674-14-688ms   | [S0,MB3,B]  740-14-754ms   | [S4,MB4,B]  768-13-781ms   | [S4,MB5,B]  862-13-875ms   | [S4,MB6,B]  952-13-966ms   | [S4,MB7,B]  1035-13-1048ms | [S0,MB4,B]  1057-14-1071ms | [S0,MB5,B]  1087-14-1101ms | [S0,MB6,B]  1107-14-1121ms | [S0,MB7,B]  1127-14-1141ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-11-20ms      | [S1,MB1,F]  48-11-60ms     | [S1,MB2,F]  89-11-101ms    | [S1,MB3,F]  129-11-141ms   | [S5,MB0,F]  169-7-177ms    | [S5,MB1,F]  184-7-191ms    | [S5,MB2,F]  198-7-205ms    | [S5,MB3,F]  282-7-290ms    | [S1,MB4,F]  308-11-320ms   | [S5,MB0,B]  320-13-334ms   | [S1,MB5,F]  372-14-386ms   | [S5,MB1,B]  386-14-400ms   | [S1,MB6,F]  400-12-412ms   | [S5,MB2,B]  495-14-509ms   | [S1,MB7,F]  509-12-522ms   | [S5,MB3,B]  565-15-580ms   | [S5,MB4,F]  581-8-589ms    | [S1,MB0,B]  596-15-611ms   | [S5,MB5,F]  611-8-620ms    | [S1,MB1,B]  625-15-640ms   | [S5,MB6,F]  641-9-650ms    | [S1,MB2,B]  650-15-666ms   | [S5,MB7,F]  666-10-676ms   | [S1,MB3,B]  676-14-691ms   | [S5,MB4,B]  748-13-761ms   | [S5,MB5,B]  834-13-848ms   | [S5,MB6,B]  923-13-937ms   | [S5,MB7,B]  1015-13-1028ms | [S1,MB4,B]  1034-13-1048ms | [S1,MB5,B]  1066-13-1080ms | [S1,MB6,B]  1086-13-1100ms | [S1,MB7,B]  1106-13-1120ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-7-28ms      | [S2,MB1,F]  60-7-68ms      | [S2,MB2,F]  101-7-108ms    | [S2,MB3,F]  141-7-149ms    | [S6,MB0,F]  177-7-185ms    | [S6,MB1,F]  191-7-199ms    | [S6,MB2,F]  276-7-283ms    | [S6,MB0,B]  283-14-298ms   | [S6,MB3,F]  298-8-307ms    | [S6,MB1,B]  360-16-376ms   | [S2,MB4,F]  376-9-385ms    | [S6,MB2,B]  448-14-462ms   | [S2,MB5,F]  463-7-470ms    | [S6,MB3,B]  539-14-553ms   | [S2,MB6,F]  553-9-562ms    | [S2,MB0,B]  567-10-578ms   | [S2,MB7,F]  578-8-586ms    | [S2,MB1,B]  597-10-608ms   | [S6,MB4,F]  608-7-615ms    | [S2,MB2,B]  626-10-637ms   | [S6,MB5,F]  637-8-645ms    | [S2,MB3,B]  651-9-661ms    | [S6,MB6,F]  661-9-670ms    | [S6,MB4,B]  725-16-741ms   | [S6,MB7,F]  741-8-750ms    | [S6,MB5,B]  814-13-827ms   | [S6,MB6,B]  904-13-917ms   | [S6,MB7,B]  995-13-1008ms  | [S2,MB4,B]  1015-9-1024ms  | [S2,MB5,B]  1051-8-1060ms  | [S2,MB6,B]  1066-8-1075ms  | [S2,MB7,B]  1086-9-1095ms 
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-7-36ms      | [S3,MB1,F]  68-7-76ms      | [S3,MB2,F]  108-7-116ms    | [S3,MB3,F]  149-7-157ms    | [S7,MB0,F]  185-15-200ms   | [S7,MB0,B]  213-53-266ms   | [S7,MB1,F]  266-18-285ms   | [S7,MB1,B]  297-55-353ms   | [S7,MB2,F]  353-20-374ms   | [S7,MB2,B]  385-57-442ms   | [S7,MB3,F]  442-21-463ms   | [S7,MB3,B]  474-58-532ms   | [S3,MB4,F]  532-12-545ms   | [S3,MB0,B]  544-13-557ms   | [S3,MB5,F]  557-12-569ms   | [S3,MB1,B]  569-13-582ms   | [S3,MB6,F]  582-11-594ms   | [S3,MB2,B]  594-12-606ms   | [S3,MB7,F]  607-10-617ms   | [S3,MB3,B]  617-12-630ms   | [S7,MB4,F]  632-18-651ms   | [S7,MB4,B]  663-54-717ms   | [S7,MB5,F]  718-21-739ms   | [S7,MB5,B]  751-57-808ms   | [S7,MB6,F]  807-21-828ms   | [S7,MB6,B]  839-57-897ms   | [S7,MB7,F]  897-21-918ms   | [S7,MB7,B]  930-57-988ms   | [S3,MB4,B]  988-14-1002ms  | [S3,MB5,B]  1002-13-1015ms | [S3,MB6,B]  1015-12-1027ms | [S3,MB7,B]  1042-13-1056ms
[rank0]:2025-12-31 07:15:59,655 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_params_histogram/251231_0715_rank0_stage0.svg
[rank0]:	> Counts Sum: 999, Total Sum: 1235 (80.89%), Ratio(%) per element: [0.0, 86.15, 86.15, 86.15, 86.15, 86.15, 86.15, 86.15, 86.15, 86.15, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61]
[rank2]:2025-12-31 07:15:59,656 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_params_histogram/251231_0715_rank2_stage2.svg
[rank2]:	> Counts Sum: 1026, Total Sum: 1170 (87.69%), Ratio(%) per element: [87.69, 87.69, 87.69, 87.69, 87.69, 87.69, 87.69, 87.69, 87.69, 87.69, 87.69, 87.69, 87.69, 87.69, 87.69, 87.69, 87.69, 87.69]
[rank1]:2025-12-31 07:15:59,677 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_params_histogram/251231_0715_rank1_stage1.svg
[rank1]:	> Counts Sum: 1485, Total Sum: 1755 (84.62%), Ratio(%) per element: [84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61]
[rank3]:2025-12-31 07:15:59,750 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_ratio_history/rank3/251231_0715_stage3_step700.svg
[rank3]:2025-12-31 07:15:59,793 - âœ… Frozen Ratio History of Rank 3 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_ratio_history/rank3/251231_0715_stage7_step700.svg
[rank0]:2025-12-31 07:15:59,753 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_params_histogram/251231_0715_rank0_stage4.svg
[rank0]:	> Counts Sum: 477, Total Sum: 1170 (40.77%), Ratio(%) per element: [81.53, 81.53, 81.53, 81.53, 81.53, 81.53, 81.53, 81.53, 81.53, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-12-31 07:15:59,755 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_params_histogram/251231_0715_rank2_stage6.svg
[rank2]:	> Counts Sum: 513, Total Sum: 1170 (43.85%), Ratio(%) per element: [87.69, 87.69, 87.69, 87.69, 87.69, 87.69, 87.69, 87.69, 87.69, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-12-31 07:15:59,775 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_params_histogram/251231_0715_rank1_stage5.svg
[rank1]:	> Counts Sum: 495, Total Sum: 1170 (42.31%), Ratio(%) per element: [84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-31 07:15:59,893 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_params_histogram/251231_0715_rank3_stage3.svg
[rank3]:	> Counts Sum: 1026, Total Sum: 1170 (87.69%), Ratio(%) per element: [87.69, 87.69, 87.69, 87.69, 87.69, 87.69, 87.69, 87.69, 87.69, 87.69, 87.69, 87.69, 87.69, 87.69, 87.69, 87.69, 87.69, 87.69]
[rank3]:2025-12-31 07:15:59,974 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_params_histogram/251231_0715_rank3_stage7.svg
[rank3]:	> Counts Sum: 0, Total Sum: 715 (0.00%), Ratio(%) per element: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-12-31 07:16:41,870 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 4.2150e-01
[rank2]:2025-12-31 07:16:41,854 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 4.7162e-01
[rank1]:2025-12-31 07:16:41,854 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 2.6140e-01
[rank3]:2025-12-31 07:16:41,870 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 7.1632e-01
[rank1]:2025-12-31 07:17:28,464 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 7.0358e-01
[rank3]:2025-12-31 07:17:28,479 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 4.1796e-01
[rank0]:2025-12-31 07:17:28,479 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 6.8350e-01
[rank2]:2025-12-31 07:17:28,463 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 6.2852e-01
[rank0]:2025-12-31 07:18:15,302 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 5.5429e-01
[rank2]:2025-12-31 07:18:15,286 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 1.0040e+00
[rank1]:2025-12-31 07:18:15,286 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 8.1047e-01
[rank3]:2025-12-31 07:18:15,302 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 6.1358e-01
[rank1]:2025-12-31 07:19:01,913 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 8.1165e-01
[rank3]:2025-12-31 07:19:01,929 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 5.8289e-01
[rank0]:2025-12-31 07:19:01,928 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 5.8837e-01
[rank2]:2025-12-31 07:19:01,913 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 1.0269e+00
[rank3]:2025-12-31 07:19:48,614 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 7.6979e-01
[rank0]:2025-12-31 07:19:48,609 - [GC] Peforming periodical GC collection 0.02 seconds
[rank0]:2025-12-31 07:19:48,614 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 5.2400e-01
[rank2]:2025-12-31 07:19:48,598 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 8.1495e-01
[rank1]:2025-12-31 07:19:48,599 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 6.1877e-01
[rank3]:2025-12-31 07:19:53,247 - Avg. fwd time: 14.6171 / Avg. bwd time: 35.8189 / Avg. batch time: 1041.2691 (ms) / GPU bubble ratio: 22.50%
[rank2]:2025-12-31 07:19:53,282 - Avg. fwd time: 8.1278 / Avg. bwd time: 13.3870 / Avg. batch time: 1091.9473 (ms) / GPU bubble ratio: 68.47%
[rank1]:2025-12-31 07:19:53,312 - Avg. fwd time: 10.2258 / Avg. bwd time: 16.4158 / Avg. batch time: 1134.0699 (ms) / GPU bubble ratio: 62.41%
[rank1]:2025-12-31 07:19:53,351 -  step: 750  loss: -4.0000  grad_norm:  0.1984  memory: 18.49GiB(38.93%)  tps: 7,004  tflops: 54.76  mfu: 17.55%
[rank3]:2025-12-31 07:19:53,366 -  step: 750  loss:  0.2674  grad_norm:  0.1984  memory: 29.23GiB(61.52%)  tps: 7,004  tflops: 54.76  mfu: 17.55%
[rank0]:2025-12-31 07:19:53,342 - Avg. fwd time: 8.7196 / Avg. bwd time: 15.9170 / Avg. batch time: 1165.6302 (ms) / GPU bubble ratio: 66.18%
[rank0]:2025-12-31 07:19:53,365 -  step: 750  loss: -4.0000  grad_norm:  0.1984  memory: 20.42GiB(42.99%)  tps: 7,004  tflops: 54.76  mfu: 17.55%
[rank2]:2025-12-31 07:19:53,351 -  step: 750  loss: -4.0000  grad_norm:  0.1984  memory: 12.06GiB(25.39%)  tps: 7,004  tflops: 54.76  mfu: 17.55%
[rank2]:2025-12-31 07:20:35,403 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 1.2825e+00
[rank1]:2025-12-31 07:20:35,403 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 1.2977e+00
[rank3]:2025-12-31 07:20:35,418 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 1.1260e+00
[rank0]:2025-12-31 07:20:35,418 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 1.1215e+00
[rank1]:2025-12-31 07:21:22,268 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 1.5200e+00
[rank3]:2025-12-31 07:21:22,284 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 1.1560e+00
[rank0]:2025-12-31 07:21:22,284 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 1.3143e+00
[rank2]:2025-12-31 07:21:22,268 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 1.5531e+00
[rank1]:2025-12-31 07:22:09,034 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 2.2142e+00
[rank3]:2025-12-31 07:22:09,049 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 2.1007e+00
[rank0]:2025-12-31 07:22:09,049 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 2.0426e+00
[rank2]:2025-12-31 07:22:09,034 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 2.8133e+00
[rank3]:2025-12-31 07:22:55,836 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 3.0074e-01
[rank0]:2025-12-31 07:22:55,836 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 2.3110e-01
[rank2]:2025-12-31 07:22:55,820 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 3.7462e-01
[rank1]:2025-12-31 07:22:55,820 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 2.4617e-01
[rank0]:2025-12-31 07:23:42,510 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-31 07:23:42,529 - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.50, Threshold: 3.6780e-01
[rank1]:2025-12-31 07:23:42,513 - Freezing Ratio: [Stage1] 1.00, [Stage5] 0.50, Threshold: 1.7570e-01
[rank2]:2025-12-31 07:23:42,513 - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.50, Threshold: 4.7823e-01
[rank3]:2025-12-31 07:23:42,529 - Freezing Ratio: [Stage3] 1.00, [Stage7] 0.00, Threshold: 3.4709e-01
[rank3]:2025-12-31 07:23:47,185 - Avg. fwd time: 14.6259 / Avg. bwd time: 35.7604 / Avg. batch time: 1040.6813 (ms) / GPU bubble ratio: 22.53%
[rank2]:2025-12-31 07:23:47,221 - Avg. fwd time: 8.1340 / Avg. bwd time: 13.3101 / Avg. batch time: 1091.1547 (ms) / GPU bubble ratio: 68.56%
[rank1]:2025-12-31 07:23:47,251 - Avg. fwd time: 10.2338 / Avg. bwd time: 16.2852 / Avg. batch time: 1132.9654 (ms) / GPU bubble ratio: 62.55%
[rank3]:2025-12-31 07:23:47,307 -  step: 800  loss:  0.2617  grad_norm:  0.3479  memory: 29.23GiB(61.52%)  tps: 7,004  tflops: 54.75  mfu: 17.55%
[rank3]:2025-12-31 07:23:47,308 - â„¹ï¸ final step: 800  loss:  0.2617  grad_norm:  0.3479  tps: 7,315  tflops: 57.18  mfu: 16.85%
[rank3]:2025-12-31 07:23:47,308 - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-12-31 07:23:47,309 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-31 07:23:47,282 - Avg. fwd time: 8.7271 / Avg. bwd time: 15.8246 / Avg. batch time: 1164.4076 (ms) / GPU bubble ratio: 66.26%
[rank0]:2025-12-31 07:23:47,306 -  step: 800  loss: -4.0000  grad_norm:  0.3479  memory: 20.42GiB(42.99%)  tps: 7,003  tflops: 54.75  mfu: 17.55%
[rank0]:2025-12-31 07:23:47,306 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  0.3479  tps: 7,310  tflops: 57.15  mfu: 16.72%
[rank0]:2025-12-31 07:23:47,306 - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-12-31 07:23:47,307 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank2]:2025-12-31 07:23:47,292 -  step: 800  loss: -4.0000  grad_norm:  0.3479  memory: 12.06GiB(25.39%)  tps: 7,003  tflops: 54.75  mfu: 17.55%
[rank2]:2025-12-31 07:23:47,292 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  0.3479  tps: 7,310  tflops: 57.15  mfu: 16.72%
[rank2]:2025-12-31 07:23:47,292 - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-12-31 07:23:47,292 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank1]:2025-12-31 07:23:47,292 -  step: 800  loss: -4.0000  grad_norm:  0.3479  memory: 18.49GiB(38.93%)  tps: 7,003  tflops: 54.75  mfu: 17.55%
[rank1]:2025-12-31 07:23:47,292 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  0.3479  tps: 7,311  tflops: 57.16  mfu: 16.75%
[rank1]:2025-12-31 07:23:47,292 - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-12-31 07:23:47,293 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-31 07:23:49,256 - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-12-31 07:23:49,329 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_ratio_history/rank0/251231_0723_stage0_final800.svg
[rank2]:2025-12-31 07:23:49,331 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_ratio_history/rank2/251231_0723_stage2_final800.svg
[rank1]:2025-12-31 07:23:49,330 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_ratio_history/rank1/251231_0723_stage1_final800.svg
[rank0]:2025-12-31 07:23:49,375 - âœ… Frozen Ratio History of Rank 0 (Stage 4) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_ratio_history/rank0/251231_0723_stage4_final800.svg
[rank2]:2025-12-31 07:23:49,377 - âœ… Frozen Ratio History of Rank 2 (Stage 6) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_ratio_history/rank2/251231_0723_stage6_final800.svg
[rank1]:2025-12-31 07:23:49,374 - âœ… Frozen Ratio History of Rank 1 (Stage 5) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_ratio_history/rank1/251231_0723_stage5_final800.svg
[rank0]:2025-12-31 07:23:49,476 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_params_histogram/251231_0723_rank0_stage0.svg
[rank0]:	> Counts Sum: 1179, Total Sum: 1425 (82.74%), Ratio(%) per element: [0.0, 88.0, 88.0, 88.0, 88.0, 88.0, 88.0, 88.0, 88.0, 88.0, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66]
[rank2]:2025-12-31 07:23:49,476 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_params_histogram/251231_0723_rank2_stage2.svg
[rank2]:	> Counts Sum: 1206, Total Sum: 1350 (89.33%), Ratio(%) per element: [89.33, 89.33, 89.33, 89.33, 89.33, 89.33, 89.33, 89.33, 89.33, 89.33, 89.33, 89.33, 89.33, 89.33, 89.33, 89.33, 89.33, 89.33]
[rank1]:2025-12-31 07:23:49,495 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_params_histogram/251231_0723_rank1_stage1.svg
[rank1]:	> Counts Sum: 1755, Total Sum: 2025 (86.67%), Ratio(%) per element: [86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66]
[rank3]:2025-12-31 07:23:49,523 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/pipeline_schedule/251231_0723_final800_rank3.svg
[rank3]:			> Batch Time: 1146.56 ms, GPU Bubble Ratio: 67.45%, 65.56%, 71.53%, 30.61%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-9-17ms       | [S0,MB2,F]  17-8-26ms      | [S0,MB3,F]  26-8-34ms      | [S4,MB0,F]  49-9-58ms      | [S4,MB1,F]  89-8-97ms      | [S4,MB2,F]  129-8-138ms    | [S4,MB3,F]  169-8-178ms    | [S0,MB4,F]  178-9-187ms    | [S0,MB5,F]  187-8-195ms    | [S0,MB6,F]  195-9-205ms    | [S4,MB0,B]  377-14-392ms   | [S0,MB7,F]  392-8-401ms    | [S4,MB1,B]  495-14-510ms   | [S4,MB4,F]  557-8-566ms    | [S4,MB2,B]  566-14-581ms   | [S4,MB5,F]  588-8-596ms    | [S4,MB3,B]  597-14-611ms   | [S4,MB6,F]  618-9-627ms    | [S0,MB0,B]  628-15-643ms   | [S4,MB7,F]  648-7-656ms    | [S0,MB1,B]  657-15-672ms   | [S0,MB2,B]  677-14-691ms   | [S0,MB3,B]  743-14-758ms   | [S4,MB4,B]  771-13-784ms   | [S4,MB5,B]  866-13-879ms   | [S4,MB6,B]  957-13-970ms   | [S4,MB7,B]  1040-13-1053ms | [S0,MB4,B]  1062-14-1076ms | [S0,MB5,B]  1092-14-1106ms | [S0,MB6,B]  1112-14-1126ms | [S0,MB7,B]  1132-14-1146ms
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-12-20ms      | [S1,MB1,F]  49-11-61ms     | [S1,MB2,F]  89-11-101ms    | [S1,MB3,F]  129-11-141ms   | [S5,MB0,F]  169-7-177ms    | [S5,MB1,F]  183-7-191ms    | [S5,MB2,F]  197-7-205ms    | [S5,MB3,F]  281-7-289ms    | [S1,MB4,F]  307-11-319ms   | [S5,MB0,B]  319-13-333ms   | [S1,MB5,F]  370-14-384ms   | [S5,MB1,B]  384-14-398ms   | [S1,MB6,F]  399-12-412ms   | [S5,MB2,B]  495-14-509ms   | [S1,MB7,F]  509-12-522ms   | [S5,MB3,B]  565-15-580ms   | [S5,MB4,F]  581-8-589ms    | [S1,MB0,B]  596-15-611ms   | [S5,MB5,F]  614-8-622ms    | [S1,MB1,B]  627-15-642ms   | [S5,MB6,F]  644-9-653ms    | [S1,MB2,B]  654-15-670ms   | [S5,MB7,F]  670-10-680ms   | [S1,MB3,B]  680-14-695ms   | [S5,MB4,B]  751-13-764ms   | [S5,MB5,B]  838-13-851ms   | [S5,MB6,B]  928-13-942ms   | [S5,MB7,B]  1019-13-1033ms | [S1,MB4,B]  1039-13-1053ms | [S1,MB5,B]  1071-13-1085ms | [S1,MB6,B]  1091-13-1105ms | [S1,MB7,B]  1111-13-1125ms
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-7-28ms      | [S2,MB1,F]  60-7-68ms      | [S2,MB2,F]  101-7-108ms    | [S2,MB3,F]  141-7-148ms    | [S6,MB0,F]  177-7-185ms    | [S6,MB1,F]  191-7-198ms    | [S6,MB2,F]  275-7-282ms    | [S6,MB0,B]  282-14-297ms   | [S6,MB3,F]  297-8-306ms    | [S6,MB1,B]  358-16-374ms   | [S2,MB4,F]  374-9-383ms    | [S6,MB2,B]  447-14-462ms   | [S2,MB5,F]  463-7-471ms    | [S6,MB3,B]  538-14-552ms   | [S2,MB6,F]  553-8-562ms    | [S2,MB0,B]  568-10-578ms   | [S2,MB7,F]  579-8-588ms    | [S2,MB1,B]  598-10-609ms   | [S6,MB4,F]  610-7-618ms    | [S2,MB2,B]  628-10-639ms   | [S6,MB5,F]  640-8-648ms    | [S2,MB3,B]  655-10-665ms   | [S6,MB6,F]  665-9-674ms    | [S6,MB4,B]  728-16-744ms   | [S6,MB7,F]  744-8-752ms    | [S6,MB5,B]  817-13-831ms   | [S6,MB6,B]  908-13-921ms   | [S6,MB7,B]  1000-13-1013ms | [S2,MB4,B]  1020-9-1029ms  | [S2,MB5,B]  1055-9-1064ms  | [S2,MB6,B]  1071-8-1080ms  | [S2,MB7,B]  1091-9-1100ms 
[rank3]:			  [Rank 3]	[S3,MB0,F]  28-8-36ms      | [S3,MB1,F]  68-7-76ms      | [S3,MB2,F]  108-7-116ms    | [S3,MB3,F]  149-7-156ms    | [S7,MB0,F]  185-15-201ms   | [S7,MB0,B]  212-53-266ms   | [S7,MB1,F]  266-18-284ms   | [S7,MB1,B]  295-55-351ms   | [S7,MB2,F]  351-21-372ms   | [S7,MB2,B]  383-57-441ms   | [S7,MB3,F]  441-21-462ms   | [S7,MB3,B]  473-57-531ms   | [S3,MB4,F]  531-12-544ms   | [S3,MB0,B]  544-13-557ms   | [S3,MB5,F]  558-12-570ms   | [S3,MB1,B]  570-13-583ms   | [S3,MB6,F]  584-11-596ms   | [S3,MB2,B]  596-12-609ms   | [S3,MB7,F]  609-10-620ms   | [S3,MB3,B]  620-12-633ms   | [S7,MB4,F]  636-18-654ms   | [S7,MB4,B]  666-55-721ms   | [S7,MB5,F]  721-21-742ms   | [S7,MB5,B]  753-57-811ms   | [S7,MB6,F]  811-21-832ms   | [S7,MB6,B]  844-57-902ms   | [S7,MB7,F]  902-21-923ms   | [S7,MB7,B]  935-57-993ms   | [S3,MB4,B]  993-14-1007ms  | [S3,MB5,B]  1007-13-1020ms | [S3,MB6,B]  1020-12-1033ms | [S3,MB7,B]  1047-13-1060ms
[rank0]:2025-12-31 07:23:49,574 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_params_histogram/251231_0723_rank0_stage4.svg
[rank0]:	> Counts Sum: 567, Total Sum: 1350 (42.00%), Ratio(%) per element: [84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-12-31 07:23:49,574 - Sleeping 2 seconds for other ranks to complete
[rank2]:2025-12-31 07:23:49,573 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_params_histogram/251231_0723_rank2_stage6.svg
[rank2]:	> Counts Sum: 603, Total Sum: 1350 (44.67%), Ratio(%) per element: [89.33, 89.33, 89.33, 89.33, 89.33, 89.33, 89.33, 89.33, 89.33, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-12-31 07:23:49,573 - Destroying the purge thread.
[rank1]:2025-12-31 07:23:49,591 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_params_histogram/251231_0723_rank1_stage5.svg
[rank1]:	> Counts Sum: 585, Total Sum: 1350 (43.33%), Ratio(%) per element: [86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-12-31 07:23:49,592 - Destroying the purge thread.
[rank3]:2025-12-31 07:23:49,756 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/pipeline_schedule/251231_0723_thry_final800_rank3.svg
[rank3]:			> Batch Time: 601.11 ms, GPU Bubble Ratio: 15.79%, 15.79%, 15.79%, 15.79%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-10-10ms      | [S0,MB1,F]  10-10-21ms     | [S0,MB2,F]  21-10-31ms     | [S0,MB3,F]  31-10-42ms     | [S4,MB0,F]  42-10-52ms     | [S4,MB1,F]  52-10-63ms     | [S4,MB2,F]  63-10-73ms     | [S4,MB3,F]  73-10-84ms     | [S0,MB4,F]  84-10-94ms     | [S0,MB5,F]  94-10-105ms    | [S0,MB6,F]  105-10-116ms   | [S4,MB0,B]  147-21-168ms   | [S0,MB7,F]  168-10-179ms   | [S4,MB1,B]  179-21-200ms   | [S4,MB4,F]  210-10-221ms   | [S4,MB2,B]  221-21-242ms   | [S4,MB5,F]  242-10-253ms   | [S4,MB3,B]  253-21-274ms   | [S4,MB6,F]  274-10-284ms   | [S0,MB0,B]  284-21-305ms   | [S4,MB7,F]  305-10-316ms   | [S0,MB1,B]  316-21-337ms   | [S0,MB2,B]  337-21-358ms   | [S0,MB3,B]  369-21-390ms   | [S4,MB4,B]  400-21-421ms   | [S4,MB5,B]  432-21-453ms   | [S4,MB6,B]  464-21-485ms   | [S4,MB7,B]  495-21-516ms   | [S0,MB4,B]  516-21-537ms   | [S0,MB5,B]  537-21-558ms   | [S0,MB6,B]  558-21-580ms   | [S0,MB7,B]  580-21-601ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  10-10-21ms     | [S1,MB1,F]  21-10-31ms     | [S1,MB2,F]  31-10-42ms     | [S1,MB3,F]  42-10-52ms     | [S5,MB0,F]  52-10-63ms     | [S5,MB1,F]  63-10-73ms     | [S5,MB2,F]  73-10-84ms     | [S5,MB3,F]  84-10-94ms     | [S1,MB4,F]  94-10-105ms    | [S5,MB0,B]  126-21-147ms   | [S1,MB5,F]  147-10-158ms   | [S5,MB1,B]  158-21-179ms   | [S1,MB6,F]  179-10-189ms   | [S5,MB2,B]  189-21-210ms   | [S1,MB7,F]  210-10-221ms   | [S5,MB3,B]  221-21-242ms   | [S5,MB4,F]  242-10-253ms   | [S1,MB0,B]  253-21-274ms   | [S5,MB5,F]  274-10-284ms   | [S1,MB1,B]  284-21-305ms   | [S5,MB6,F]  305-10-316ms   | [S1,MB2,B]  316-21-337ms   | [S5,MB7,F]  337-10-348ms   | [S1,MB3,B]  348-21-369ms   | [S5,MB4,B]  379-21-400ms   | [S5,MB5,B]  411-21-432ms   | [S5,MB6,B]  442-21-464ms   | [S5,MB7,B]  474-21-495ms   | [S1,MB4,B]  495-21-516ms   | [S1,MB5,B]  516-21-537ms   | [S1,MB6,B]  537-21-558ms   | [S1,MB7,B]  558-21-580ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-10-31ms     | [S2,MB1,F]  31-10-42ms     | [S2,MB2,F]  42-10-52ms     | [S2,MB3,F]  52-10-63ms     | [S6,MB0,F]  63-10-73ms     | [S6,MB1,F]  73-10-84ms     | [S6,MB2,F]  84-10-94ms     | [S6,MB0,B]  105-21-126ms   | [S6,MB3,F]  126-10-137ms   | [S6,MB1,B]  137-21-158ms   | [S2,MB4,F]  158-10-168ms   | [S6,MB2,B]  168-21-189ms   | [S2,MB5,F]  189-10-200ms   | [S6,MB3,B]  200-21-221ms   | [S2,MB6,F]  221-10-232ms   | [S2,MB0,B]  232-21-253ms   | [S2,MB7,F]  253-10-263ms   | [S2,MB1,B]  263-21-284ms   | [S6,MB4,F]  284-10-295ms   | [S2,MB2,B]  295-21-316ms   | [S6,MB5,F]  316-10-326ms   | [S2,MB3,B]  326-21-348ms   | [S6,MB6,F]  348-10-358ms   | [S6,MB4,B]  358-21-379ms   | [S6,MB7,F]  379-10-390ms   | [S6,MB5,B]  390-21-411ms   | [S6,MB6,B]  421-21-442ms   | [S6,MB7,B]  453-21-474ms   | [S2,MB4,B]  474-21-495ms   | [S2,MB5,B]  495-21-516ms   | [S2,MB6,B]  516-21-537ms   | [S2,MB7,B]  537-21-558ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  31-10-42ms     | [S3,MB1,F]  42-10-52ms     | [S3,MB2,F]  52-10-63ms     | [S3,MB3,F]  63-10-73ms     | [S7,MB0,F]  73-10-84ms     | [S7,MB0,B]  84-21-105ms    | [S7,MB1,F]  105-10-116ms   | [S7,MB1,B]  116-21-137ms   | [S7,MB2,F]  137-10-147ms   | [S7,MB2,B]  147-21-168ms   | [S7,MB3,F]  168-10-179ms   | [S7,MB3,B]  179-21-200ms   | [S3,MB4,F]  200-10-210ms   | [S3,MB0,B]  210-21-232ms   | [S3,MB5,F]  232-10-242ms   | [S3,MB1,B]  242-21-263ms   | [S3,MB6,F]  263-10-274ms   | [S3,MB2,B]  274-21-295ms   | [S3,MB7,F]  295-10-305ms   | [S3,MB3,B]  305-21-326ms   | [S7,MB4,F]  326-10-337ms   | [S7,MB4,B]  337-21-358ms   | [S7,MB5,F]  358-10-369ms   | [S7,MB5,B]  369-21-390ms   | [S7,MB6,F]  390-10-400ms   | [S7,MB6,B]  400-21-421ms   | [S7,MB7,F]  421-10-432ms   | [S7,MB7,B]  432-21-453ms   | [S3,MB4,B]  453-21-474ms   | [S3,MB5,B]  474-21-495ms   | [S3,MB6,B]  495-21-516ms   | [S3,MB7,B]  516-21-537ms  
[rank3]:2025-12-31 07:23:49,802 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_ratio_history/rank3/251231_0723_stage3_final800.svg
[rank3]:2025-12-31 07:23:49,845 - âœ… Frozen Ratio History of Rank 3 (Stage 7) is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_ratio_history/rank3/251231_0723_stage7_final800.svg
[rank3]:2025-12-31 07:23:49,944 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_params_histogram/251231_0723_rank3_stage3.svg
[rank3]:	> Counts Sum: 1206, Total Sum: 1350 (89.33%), Ratio(%) per element: [89.33, 89.33, 89.33, 89.33, 89.33, 89.33, 89.33, 89.33, 89.33, 89.33, 89.33, 89.33, 89.33, 89.33, 89.33, 89.33, 89.33, 89.33]
[rank2]:2025-12-31 07:23:50,026 - Process group destroyed
[rank1]:2025-12-31 07:23:50,019 - Process group destroyed
[rank3]:2025-12-31 07:23:50,024 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1/frozen_params_histogram/251231_0723_rank3_stage7.svg
[rank3]:	> Counts Sum: 0, Total Sum: 825 (0.00%), Ratio(%) per element: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-31 07:23:50,025 - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading history steps 16-16, summary, console lines 383-401
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–‚â–‚â–„â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–ˆâ–†â–ƒâ–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–ˆâ–†â–ƒâ–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 4.47985
[rank3]:wandb:               final/avg_loss 0.26169
[rank3]:wandb:             final/avg_mfu(%) 16.85435
[rank3]:wandb:             final/avg_tflops 57.18166
[rank3]:wandb:    final/avg_throughput(tps) 7314.53367
[rank3]:wandb:              final/grad_norm 0.34786
[rank3]:wandb:               final/max_loss 0.26169
[rank3]:wandb:                    grad_norm 0.34786
[rank3]:wandb: loss_metrics/global_avg_loss 0.26169
[rank3]:wandb: loss_metrics/global_max_loss 0.26169
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1230_Interleaved1F1B_auto_22_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/rnf7z9wr
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1230_Interleaved1F1B_auto_22_dm1/20251231-0620/wandb/run-20251231_062018-rnf7z9wr/logs
[rank3]:2025-12-31 07:23:51,519 - Process group destroyed
[rank0]:2025-12-31 07:23:51,574 - Training completed
[rank0]:2025-12-31 07:23:51,575 - Destroying the purge thread.
[rank0]:2025-12-31 07:23:51,649 - Process group destroyed
[rank2]:Stage 2: Modules to keep: {'layers.6', 'layers.5'}
[rank2]:Stage 6: Modules to keep: {'layers.14', 'layers.13'}
[rank0]:Stage 0: Modules to keep: {'tok_embeddings', 'layers.1', 'layers.0'}
[rank0]:Stage 4: Modules to keep: {'layers.10', 'layers.9'}
[rank1]:Stage 1: Modules to keep: {'layers.3', 'layers.4', 'layers.2'}
[rank1]:Stage 5: Modules to keep: {'layers.11', 'layers.12'}
[rank3]:Stage 3: Modules to keep: {'layers.8', 'layers.7'}
[rank3]:Stage 7: Modules to keep: {'layers.15', 'norm', 'output'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1230.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:1227: everything same as 1224 but seed=42->11
[rank3]:1230: everything same as 1224 but seed=42->22
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1230_Interleaved1F1B_auto_22_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1230_Interleaved1F1B_auto_22_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1230_Interleaved1F1B_auto_22_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1230_Interleaved1F1B_auto_22_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1230_Interleaved1F1B_auto_22_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1230_Interleaved1F1B_auto_22_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 22
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: Interleaved1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 4
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 2
[rank3]:		- stages_list: [3, 7]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1230_Interleaved1F1B_auto_22_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1230_Interleaved1F1B_auto_22_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: auto
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.01
[rank3]:		- percentile: 80
[rank3]:
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
