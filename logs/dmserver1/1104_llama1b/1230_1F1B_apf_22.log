
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 12. 30. (í™”) 23:25:40 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 3,4,5,6
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/1230_1F1B_apf_22.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
1227: everything same as 1224 but seed=42->11
1230: everything same as 1224 but seed=42->22

âœ”ï¸Running with apf x 1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1230.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
1227: everything same as 1224 but seed=42->11
1230: everything same as 1224 but seed=42->22
" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=apf --freezing.threshold=0.01 --freezing.percentile=80 --freezing.max_freeze_ratio=0.8
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank2]:2025-12-30 23:25:46,783 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank2]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank2]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank2]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank2]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank2]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank2]:1227: everything same as 1224 but seed=42->11
[rank2]:1230: everything same as 1224 but seed=42->22
[rank2]:"
[rank1]:2025-12-30 23:25:46,715 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank1]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank1]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank1]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank1]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank1]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank1]:1227: everything same as 1224 but seed=42->11
[rank1]:1230: everything same as 1224 but seed=42->22
[rank1]:"
[rank0]:2025-12-30 23:25:46,870 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank0]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank0]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank0]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank0]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank0]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank0]:1227: everything same as 1224 but seed=42->11
[rank0]:1230: everything same as 1224 but seed=42->22
[rank0]:"
[rank1]:2025-12-30 23:25:46,888 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-12-30 23:25:46,891 - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-12-30 23:25:46,978 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-12-30 23:25:46,981 - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-12-30 23:25:46,920 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:1227: everything same as 1224 but seed=42->11
[rank3]:1230: everything same as 1224 but seed=42->22
[rank3]:"
[rank0]:2025-12-30 23:25:47,077 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-12-30 23:25:47,079 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-30 23:25:47,083 - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-12-30 23:25:47,084 - Loading tokenizer from tokenizer.json
[rank3]:2025-12-30 23:25:47,128 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-12-30 23:25:47,131 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-30 23:25:47,495 - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank0]:2025-12-30 23:25:50,778 - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank0]:2025-12-30 23:25:50,954 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-12-30 23:25:50,995 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-30 23:25:50,996 - Model llama3 1B size: 1,498,482,688 total parameters
[rank2]:2025-12-30 23:25:51,069 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-12-30 23:25:51,023 - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-12-30 23:25:51,024 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2025-12-30 23:25:51,061 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-12-30 23:25:51,103 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-30 23:25:51,112 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-30 23:25:51,138 - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-12-30 23:25:51,138 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2025-12-30 23:25:51,129 - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-12-30 23:25:51,129 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2025-12-30 23:25:51,217 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-30 23:25:51,218 - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-12-30 23:25:51,218 - CUDA memory usage for model: 1.90GiB(3.99%)
[rank2]:2025-12-30 23:25:51,342 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-30 23:25:51,342 - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-12-30 23:25:51,343 - CUDA memory usage for model: 0.92GiB(1.94%)
[rank1]:2025-12-30 23:25:51,343 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-30 23:25:51,343 - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-12-30 23:25:51,344 - CUDA memory usage for model: 1.13GiB(2.39%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run 3ent4bsr
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1230_1F1B_apf_22_dm1/20251230-2325/wandb/run-20251230_232552-3ent4bsr
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1230_1F1B_apf_22_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/3ent4bsr
[rank3]:2025-12-30 23:25:53,327 - WandB logging enabled
[rank3]:2025-12-30 23:25:53,328 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-12-30 23:25:53,367 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-30 23:25:53,396 - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-12-30 23:25:53,397 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank2]:2025-12-30 23:25:53,601 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-30 23:25:53,600 - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1230_1F1B_apf_22_dm1
[rank0]:2025-12-30 23:25:53,600 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-30 23:25:53,601 - Trainer is initialized with local batch size 32, global batch size 128, gradient accumulation steps 4, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2025-12-30 23:25:53,601 - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank1]:2025-12-30 23:25:53,601 - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-12-30 23:25:53,583 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-30 23:25:53,584 - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-12-30 23:25:53,585 - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2025-12-30 23:25:53,600 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-30 23:25:56,028 - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-12-30 23:25:56,028 - Finished loading the checkpoint in 2.43 seconds.
[rank0]:2025-12-30 23:25:56,028 - Training starts at step 1
[rank2]:2025-12-30 23:26:01,364 -  step:  1  loss: -4.0000  grad_norm: 203.0663  memory:  6.84GiB(14.41%)  tps: 3,196  tflops: 24.99  mfu: 8.01%
[rank2]:2025-12-30 23:26:01,365 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-12-30 23:26:01,367 -  step:  1  loss: -4.0000  grad_norm: 203.0663  memory: 10.58GiB(22.26%)  tps: 3,193  tflops: 24.96  mfu: 8.00%
[rank1]:2025-12-30 23:26:01,367 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-12-30 23:26:01,382 -  step:  1  loss: 10.6092  grad_norm: 203.0663  memory: 21.88GiB(46.05%)  tps: 4,090  tflops: 31.98  mfu: 10.25%
[rank3]:2025-12-30 23:26:01,383 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-30 23:26:01,402 -  step:  1  loss: -4.0000  grad_norm: 203.0663  memory: 13.10GiB(27.57%)  tps: 3,149  tflops: 24.61  mfu: 7.89%
[rank0]:2025-12-30 23:26:01,403 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-30 23:29:53,398 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-30 23:29:58,106 - Avg. fwd time: 14.8875 / Avg. bwd time: 35.2098 / Avg. batch time: 1044.1091 (ms) / GPU bubble ratio: 61.62%
[rank3]:2025-12-30 23:29:58,064 - Avg. fwd time: 24.5784 / Avg. bwd time: 80.4767 / Avg. batch time: 985.8103 (ms) / GPU bubble ratio: 14.75%
[rank2]:2025-12-30 23:29:58,227 -  step: 50  loss: -4.0000  grad_norm: 24.1349  memory:  8.66GiB(18.23%)  tps: 6,779  tflops: 52.99  mfu: 16.98%
[rank1]:2025-12-30 23:29:58,158 - Avg. fwd time: 19.7710 / Avg. bwd time: 45.5705 / Avg. batch time: 1116.9082 (ms) / GPU bubble ratio: 53.20%
[rank1]:2025-12-30 23:29:58,231 -  step: 50  loss: -4.0000  grad_norm: 24.1349  memory: 12.86GiB(27.07%)  tps: 6,779  tflops: 52.99  mfu: 16.98%
[rank0]:2025-12-30 23:29:58,206 - Avg. fwd time: 16.0202 / Avg. bwd time: 41.8181 / Avg. batch time: 1182.7944 (ms) / GPU bubble ratio: 60.88%
[rank0]:2025-12-30 23:29:58,243 -  step: 50  loss: -4.0000  grad_norm: 24.1349  memory: 16.87GiB(35.50%)  tps: 6,779  tflops: 53.00  mfu: 16.99%
[rank3]:2025-12-30 23:29:58,240 -  step: 50  loss:  9.8817  grad_norm: 24.1349  memory: 25.79GiB(54.28%)  tps: 6,779  tflops: 52.99  mfu: 16.99%
[rank3]:2025-12-30 23:30:41,391 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.0000e-02
[rank2]:2025-12-30 23:30:41,794 - Freezing Ratio: [Stage2] 0.00, Threshold: 1.0000e-02
[rank1]:2025-12-30 23:30:41,843 - Freezing Ratio: [Stage1] 0.00, Threshold: 1.0000e-02
[rank0]:2025-12-30 23:30:41,887 - Freezing Ratio: [Stage0] 0.00, Threshold: 1.0000e-02
[rank3]:2025-12-30 23:31:30,404 - Freezing Ratio: [Stage3] 0.72, Threshold: 1.0000e-02
[rank1]:2025-12-30 23:31:30,393 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.0000e-02
[rank2]:2025-12-30 23:31:30,384 - Freezing Ratio: [Stage2] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-30 23:31:30,414 - Freezing Ratio: [Stage0] 0.81, Threshold: 1.0000e-02
[rank3]:2025-12-30 23:32:11,072 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.0000e-02
[rank1]:2025-12-30 23:32:11,042 - Freezing Ratio: [Stage1] 0.00, Threshold: 1.0000e-02
[rank0]:2025-12-30 23:32:11,043 - Freezing Ratio: [Stage0] 0.00, Threshold: 1.0000e-02
[rank2]:2025-12-30 23:32:11,042 - Freezing Ratio: [Stage2] 0.00, Threshold: 1.0000e-02
[rank3]:2025-12-30 23:32:59,833 - Freezing Ratio: [Stage3] 0.72, Threshold: 1.0000e-02
[rank1]:2025-12-30 23:32:59,816 - Freezing Ratio: [Stage1] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-30 23:32:59,841 - Freezing Ratio: [Stage0] 0.84, Threshold: 1.0000e-02
[rank2]:2025-12-30 23:32:59,808 - Freezing Ratio: [Stage2] 0.81, Threshold: 1.0000e-02
[rank3]:2025-12-30 23:33:40,215 - Freezing Ratio: [Stage3] 0.76, Threshold: 1.0000e-02
[rank1]:2025-12-30 23:33:40,183 - Freezing Ratio: [Stage1] 0.78, Threshold: 1.0000e-02
[rank2]:2025-12-30 23:33:40,183 - Freezing Ratio: [Stage2] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-30 23:33:40,183 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-30 23:33:40,185 - Freezing Ratio: [Stage0] 0.81, Threshold: 1.0000e-02
[rank3]:2025-12-30 23:33:44,102 - Avg. fwd time: 25.0221 / Avg. bwd time: 77.0540 / Avg. batch time: 961.8797 (ms) / GPU bubble ratio: 15.10%
[rank2]:2025-12-30 23:33:44,126 - Avg. fwd time: 15.0916 / Avg. bwd time: 31.6852 / Avg. batch time: 1016.1292 (ms) / GPU bubble ratio: 63.17%
[rank3]:2025-12-30 23:33:44,198 -  step: 100  loss:  8.7891  grad_norm: 14.0383  memory: 27.74GiB(58.39%)  tps: 7,251  tflops: 56.68  mfu: 18.17%
[rank1]:2025-12-30 23:33:44,156 - Avg. fwd time: 19.9098 / Avg. bwd time: 40.9590 / Avg. batch time: 1083.9658 (ms) / GPU bubble ratio: 55.08%
[rank1]:2025-12-30 23:33:44,182 -  step: 100  loss: -4.0000  grad_norm: 14.0383  memory: 14.00GiB(29.46%)  tps: 7,251  tflops: 56.69  mfu: 18.17%
[rank2]:2025-12-30 23:33:44,182 -  step: 100  loss: -4.0000  grad_norm: 14.0383  memory:  9.58GiB(20.16%)  tps: 7,251  tflops: 56.69  mfu: 18.17%
[rank0]:2025-12-30 23:33:44,181 - Avg. fwd time: 16.2570 / Avg. bwd time: 37.0432 / Avg. batch time: 1144.6600 (ms) / GPU bubble ratio: 62.75%
[rank0]:2025-12-30 23:33:44,183 -  step: 100  loss: -4.0000  grad_norm: 14.0383  memory: 18.72GiB(39.41%)  tps: 7,252  tflops: 56.69  mfu: 18.17%
[rank1]:2025-12-30 23:33:44,274 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_apf_22_dm1/frozen_ratio_history/rank1/251230_2333_stage1_step100.svg
[rank2]:2025-12-30 23:33:44,277 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_apf_22_dm1/frozen_ratio_history/rank2/251230_2333_stage2_step100.svg
[rank0]:2025-12-30 23:33:44,269 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_apf_22_dm1/frozen_ratio_history/rank0/251230_2333_stage0_step100.svg
[rank3]:2025-12-30 23:33:44,389 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_1F1B_apf_22_dm1/pipeline_schedule/251230_2333_step100_rank3.svg
[rank3]:			> Batch Time: 990.27 ms, GPU Bubble Ratio: 71.21%, 64.86%, 72.76%, 27.80%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-17-34ms     | [S0,MB2,F]  34-18-52ms     | [S0,MB3,F]  52-17-70ms     | [S0,MB0,B]  216-18-235ms   | [S0,MB4,F]  235-16-251ms   | [S0,MB1,B]  322-18-341ms   | [S0,MB5,F]  341-16-357ms   | [S0,MB2,B]  432-18-450ms   | [S0,MB6,F]  450-16-466ms   | [S0,MB3,B]  541-18-559ms   | [S0,MB7,F]  559-16-575ms   | [S0,MB4,B]  651-18-669ms   | [S0,MB5,B]  758-18-777ms   | [S0,MB6,B]  865-18-884ms   | [S0,MB7,B]  971-18-990ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-19-36ms     | [S1,MB1,F]  42-20-62ms     | [S1,MB2,F]  69-20-89ms     | [S1,MB0,B]  185-23-208ms   | [S1,MB3,F]  213-20-233ms   | [S1,MB1,B]  291-23-315ms   | [S1,MB4,F]  319-20-339ms   | [S1,MB2,B]  400-23-424ms   | [S1,MB5,F]  428-20-448ms   | [S1,MB3,B]  509-23-532ms   | [S1,MB6,F]  537-20-558ms   | [S1,MB4,B]  620-23-643ms   | [S1,MB7,F]  647-20-668ms   | [S1,MB5,B]  729-23-752ms   | [S1,MB6,B]  835-23-858ms   | [S1,MB7,B]  942-23-965ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  36-15-52ms     | [S2,MB1,F]  62-15-78ms     | [S2,MB0,B]  156-18-174ms   | [S2,MB2,F]  181-15-197ms   | [S2,MB1,B]  263-18-281ms   | [S2,MB3,F]  288-15-304ms   | [S2,MB2,B]  372-18-390ms   | [S2,MB4,F]  397-15-412ms   | [S2,MB3,B]  481-18-499ms   | [S2,MB5,F]  506-15-522ms   | [S2,MB4,B]  591-18-609ms   | [S2,MB6,F]  616-15-632ms   | [S2,MB5,B]  700-18-718ms   | [S2,MB7,F]  725-15-741ms   | [S2,MB6,B]  811-18-829ms   | [S2,MB7,B]  918-18-936ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-75ms     | [S3,MB0,B]  87-59-146ms    | [S3,MB1,F]  153-25-178ms   | [S3,MB1,B]  191-62-253ms   | [S3,MB2,F]  260-26-286ms   | [S3,MB2,B]  298-63-362ms   | [S3,MB3,F]  369-26-395ms   | [S3,MB3,B]  406-64-470ms   | [S3,MB4,F]  478-26-504ms   | [S3,MB4,B]  517-64-581ms   | [S3,MB5,F]  588-26-615ms   | [S3,MB5,B]  626-64-690ms   | [S3,MB6,F]  697-26-724ms   | [S3,MB6,B]  736-64-800ms   | [S3,MB7,F]  808-26-834ms   | [S3,MB7,B]  846-64-910ms  
[rank1]:2025-12-30 23:33:44,428 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_apf_22_dm1/frozen_params_histogram/251230_2333_rank1_stage1.svg
[rank1]:	> Counts Sum: 106, Total Sum: 225 (47.11%), Ratio(%) per element: [60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 0.0, 0.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 0.0, 0.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 20.0, 0.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 0.0, 0.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 0.0, 0.0]
[rank0]:2025-12-30 23:33:44,430 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_apf_22_dm1/frozen_params_histogram/251230_2333_rank0_stage0.svg
[rank0]:	> Counts Sum: 91, Total Sum: 185 (49.19%), Ratio(%) per element: [60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 0.0, 0.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 20.0, 0.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 0.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 0.0, 0.0]
[rank3]:2025-12-30 23:33:44,441 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_apf_22_dm1/frozen_ratio_history/rank3/251230_2333_stage3_step100.svg
[rank2]:2025-12-30 23:33:44,437 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_apf_22_dm1/frozen_params_histogram/251230_2333_rank2_stage2.svg
[rank2]:	> Counts Sum: 85, Total Sum: 180 (47.22%), Ratio(%) per element: [60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 0.0, 0.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 20.0, 0.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 0.0, 0.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 0.0, 0.0]
[rank3]:2025-12-30 23:33:44,589 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_apf_22_dm1/frozen_params_histogram/251230_2333_rank3_stage3.svg
[rank3]:	> Counts Sum: 64, Total Sum: 145 (44.14%), Ratio(%) per element: [60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 0.0, 20.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 0.0, 0.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-12-30 23:34:20,912 - Freezing Ratio: [Stage1] 0.00, Threshold: 1.0000e-02
[rank2]:2025-12-30 23:34:20,911 - Freezing Ratio: [Stage2] 0.03, Threshold: 1.0000e-02
[rank3]:2025-12-30 23:34:20,943 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.0000e-02
[rank0]:2025-12-30 23:34:20,912 - Freezing Ratio: [Stage0] 0.03, Threshold: 1.0000e-02
[rank2]:2025-12-30 23:35:09,481 - Freezing Ratio: [Stage2] 0.81, Threshold: 1.0000e-02
[rank1]:2025-12-30 23:35:09,488 - Freezing Ratio: [Stage1] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-30 23:35:09,504 - Freezing Ratio: [Stage3] 0.76, Threshold: 1.0000e-02
[rank0]:2025-12-30 23:35:09,515 - Freezing Ratio: [Stage0] 0.81, Threshold: 1.0000e-02
[rank0]:2025-12-30 23:35:49,853 - Freezing Ratio: [Stage0] 0.81, Threshold: 1.0000e-02
[rank2]:2025-12-30 23:35:49,852 - Freezing Ratio: [Stage2] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-30 23:35:49,882 - Freezing Ratio: [Stage3] 0.76, Threshold: 1.0000e-02
[rank1]:2025-12-30 23:35:49,853 - Freezing Ratio: [Stage1] 0.78, Threshold: 1.0000e-02
[rank2]:2025-12-30 23:36:30,140 - Freezing Ratio: [Stage2] 0.81, Threshold: 1.0000e-02
[rank1]:2025-12-30 23:36:30,141 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.0000e-02
[rank0]:2025-12-30 23:36:30,141 - Freezing Ratio: [Stage0] 0.81, Threshold: 1.0000e-02
[rank3]:2025-12-30 23:36:30,170 - Freezing Ratio: [Stage3] 0.72, Threshold: 1.0000e-02
[rank0]:2025-12-30 23:37:10,390 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-30 23:37:10,392 - Freezing Ratio: [Stage0] 0.00, Threshold: 1.0000e-02
[rank2]:2025-12-30 23:37:10,381 - Freezing Ratio: [Stage2] 0.06, Threshold: 1.0000e-02
[rank1]:2025-12-30 23:37:10,382 - Freezing Ratio: [Stage1] 0.00, Threshold: 1.0000e-02
[rank3]:2025-12-30 23:37:10,412 - Freezing Ratio: [Stage3] 0.03, Threshold: 1.0000e-02
[rank3]:2025-12-30 23:37:15,106 - Avg. fwd time: 25.3367 / Avg. bwd time: 73.7039 / Avg. batch time: 937.5383 (ms) / GPU bubble ratio: 15.49%
[rank2]:2025-12-30 23:37:15,148 - Avg. fwd time: 15.2569 / Avg. bwd time: 28.4088 / Avg. batch time: 988.4851 (ms) / GPU bubble ratio: 64.66%
[rank1]:2025-12-30 23:37:15,200 - Avg. fwd time: 20.0312 / Avg. bwd time: 36.6904 / Avg. batch time: 1051.9234 (ms) / GPU bubble ratio: 56.86%
[rank0]:2025-12-30 23:37:15,249 - Avg. fwd time: 16.4268 / Avg. bwd time: 32.4579 / Avg. batch time: 1107.8272 (ms) / GPU bubble ratio: 64.70%
[rank0]:2025-12-30 23:37:15,286 -  step: 150  loss: -4.0000  grad_norm: 19.0465  memory: 18.76GiB(39.49%)  tps: 7,761  tflops: 60.67  mfu: 19.45%
[rank3]:2025-12-30 23:37:15,283 -  step: 150  loss:  5.3630  grad_norm: 19.0465  memory: 27.89GiB(58.72%)  tps: 7,762  tflops: 60.68  mfu: 19.45%
[rank2]:2025-12-30 23:37:15,270 -  step: 150  loss: -4.0000  grad_norm: 19.0465  memory:  9.58GiB(20.16%)  tps: 7,762  tflops: 60.68  mfu: 19.45%
[rank1]:2025-12-30 23:37:15,274 -  step: 150  loss: -4.0000  grad_norm: 19.0465  memory: 14.00GiB(29.46%)  tps: 7,762  tflops: 60.68  mfu: 19.45%
[rank0]:2025-12-30 23:37:58,913 - Freezing Ratio: [Stage0] 0.84, Threshold: 1.0000e-02
[rank2]:2025-12-30 23:37:58,879 - Freezing Ratio: [Stage2] 0.83, Threshold: 1.0000e-02
[rank3]:2025-12-30 23:37:58,903 - Freezing Ratio: [Stage3] 0.72, Threshold: 1.0000e-02
[rank1]:2025-12-30 23:37:58,887 - Freezing Ratio: [Stage1] 0.82, Threshold: 1.0000e-02
[rank2]:2025-12-30 23:38:39,219 - Freezing Ratio: [Stage2] 0.81, Threshold: 1.0000e-02
[rank1]:2025-12-30 23:38:39,219 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.0000e-02
[rank0]:2025-12-30 23:38:39,220 - Freezing Ratio: [Stage0] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-30 23:38:39,249 - Freezing Ratio: [Stage3] 0.76, Threshold: 1.0000e-02
[rank0]:2025-12-30 23:39:19,557 - Freezing Ratio: [Stage0] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-30 23:39:19,556 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.0000e-02
[rank2]:2025-12-30 23:39:19,556 - Freezing Ratio: [Stage2] 0.86, Threshold: 1.0000e-02
[rank3]:2025-12-30 23:39:19,586 - Freezing Ratio: [Stage3] 0.72, Threshold: 1.0000e-02
[rank0]:2025-12-30 23:39:59,973 - Freezing Ratio: [Stage0] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-30 23:39:59,972 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.0000e-02
[rank2]:2025-12-30 23:39:59,971 - Freezing Ratio: [Stage2] 0.86, Threshold: 1.0000e-02
[rank3]:2025-12-30 23:40:00,002 - Freezing Ratio: [Stage3] 0.72, Threshold: 1.0000e-02
[rank0]:2025-12-30 23:40:40,571 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-30 23:40:40,573 - Freezing Ratio: [Stage0] 0.00, Threshold: 1.0000e-02
[rank1]:2025-12-30 23:40:40,571 - Freezing Ratio: [Stage1] 0.04, Threshold: 1.0000e-02
[rank2]:2025-12-30 23:40:40,570 - Freezing Ratio: [Stage2] 0.06, Threshold: 1.0000e-02
[rank3]:2025-12-30 23:40:40,601 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.0000e-02
[rank2]:2025-12-30 23:40:45,376 - Avg. fwd time: 15.3399 / Avg. bwd time: 26.6673 / Avg. batch time: 973.9739 (ms) / GPU bubble ratio: 65.50%
[rank3]:2025-12-30 23:40:45,333 - Avg. fwd time: 25.5089 / Avg. bwd time: 71.9548 / Avg. batch time: 924.8992 (ms) / GPU bubble ratio: 15.70%
[rank0]:2025-12-30 23:40:45,477 - Avg. fwd time: 16.5172 / Avg. bwd time: 30.1272 / Avg. batch time: 1088.5823 (ms) / GPU bubble ratio: 65.72%
[rank1]:2025-12-30 23:40:45,428 - Avg. fwd time: 20.0919 / Avg. bwd time: 34.4348 / Avg. batch time: 1035.0927 (ms) / GPU bubble ratio: 57.86%
[rank0]:2025-12-30 23:40:45,516 -  step: 200  loss: -4.0000  grad_norm: 15.1523  memory: 18.76GiB(39.49%)  tps: 7,793  tflops: 60.93  mfu: 19.53%
[rank0]:2025-12-30 23:40:45,565 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_apf_22_dm1/frozen_ratio_history/rank0/251230_2340_stage0_step200.svg
[rank3]:2025-12-30 23:40:45,511 -  step: 200  loss:  1.6046  grad_norm: 15.1523  memory: 27.89GiB(58.72%)  tps: 7,794  tflops: 60.93  mfu: 19.53%
[rank1]:2025-12-30 23:40:45,502 -  step: 200  loss: -4.0000  grad_norm: 15.1523  memory: 14.00GiB(29.46%)  tps: 7,793  tflops: 60.93  mfu: 19.53%
[rank2]:2025-12-30 23:40:45,499 -  step: 200  loss: -4.0000  grad_norm: 15.1523  memory:  9.58GiB(20.16%)  tps: 7,793  tflops: 60.93  mfu: 19.53%
[rank1]:2025-12-30 23:40:45,565 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_apf_22_dm1/frozen_ratio_history/rank1/251230_2340_stage1_step200.svg
[rank2]:2025-12-30 23:40:45,565 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_apf_22_dm1/frozen_ratio_history/rank2/251230_2340_stage2_step200.svg
[rank3]:2025-12-30 23:40:45,670 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_1F1B_apf_22_dm1/pipeline_schedule/251230_2340_step200_rank3.svg
[rank3]:			> Batch Time: 997.34 ms, GPU Bubble Ratio: 71.35%, 65.09%, 73.00%, 27.78%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-17-34ms     | [S0,MB2,F]  34-17-52ms     | [S0,MB3,F]  52-17-69ms     | [S0,MB0,B]  216-18-235ms   | [S0,MB4,F]  235-16-252ms   | [S0,MB1,B]  324-18-343ms   | [S0,MB5,F]  343-16-359ms   | [S0,MB2,B]  434-18-453ms   | [S0,MB6,F]  453-16-469ms   | [S0,MB3,B]  544-18-563ms   | [S0,MB7,F]  563-16-579ms   | [S0,MB4,B]  655-18-673ms   | [S0,MB5,B]  763-18-781ms   | [S0,MB6,B]  870-18-888ms   | [S0,MB7,B]  978-18-997ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-19-36ms     | [S1,MB1,F]  43-20-63ms     | [S1,MB2,F]  69-20-89ms     | [S1,MB0,B]  185-23-209ms   | [S1,MB3,F]  213-20-234ms   | [S1,MB1,B]  293-23-316ms   | [S1,MB4,F]  320-20-341ms   | [S1,MB2,B]  403-23-426ms   | [S1,MB5,F]  430-20-451ms   | [S1,MB3,B]  513-23-536ms   | [S1,MB6,F]  541-20-561ms   | [S1,MB4,B]  624-23-647ms   | [S1,MB7,F]  652-20-672ms   | [S1,MB5,B]  733-23-756ms   | [S1,MB6,B]  840-23-863ms   | [S1,MB7,B]  948-23-971ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  36-15-52ms     | [S2,MB1,F]  63-15-78ms     | [S2,MB0,B]  158-17-175ms   | [S2,MB2,F]  182-15-198ms   | [S2,MB1,B]  265-18-283ms   | [S2,MB3,F]  290-15-306ms   | [S2,MB2,B]  375-17-393ms   | [S2,MB4,F]  400-15-415ms   | [S2,MB3,B]  485-17-503ms   | [S2,MB5,F]  510-15-526ms   | [S2,MB4,B]  596-17-614ms   | [S2,MB6,F]  621-15-636ms   | [S2,MB5,B]  705-17-723ms   | [S2,MB7,F]  730-15-746ms   | [S2,MB6,B]  815-17-833ms   | [S2,MB7,B]  923-17-941ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-75ms     | [S3,MB0,B]  87-60-147ms    | [S3,MB1,F]  155-25-180ms   | [S3,MB1,B]  192-63-256ms   | [S3,MB2,F]  262-26-289ms   | [S3,MB2,B]  301-64-365ms   | [S3,MB3,F]  372-26-399ms   | [S3,MB3,B]  410-64-475ms   | [S3,MB4,F]  482-27-509ms   | [S3,MB4,B]  521-64-586ms   | [S3,MB5,F]  593-26-620ms   | [S3,MB5,B]  631-64-695ms   | [S3,MB6,F]  702-27-730ms   | [S3,MB6,B]  741-64-805ms   | [S3,MB7,F]  813-27-840ms   | [S3,MB7,B]  851-63-915ms  
[rank0]:2025-12-30 23:40:45,719 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_apf_22_dm1/frozen_params_histogram/251230_2340_rank0_stage0.svg
[rank0]:	> Counts Sum: 300, Total Sum: 555 (54.05%), Ratio(%) per element: [66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 26.66, 0.0, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 6.66, 0.0, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 26.66, 0.0, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 6.66, 0.0]
[rank3]:2025-12-30 23:40:45,719 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_apf_22_dm1/frozen_ratio_history/rank3/251230_2340_stage3_step200.svg
[rank1]:2025-12-30 23:40:45,716 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_apf_22_dm1/frozen_params_histogram/251230_2340_rank1_stage1.svg
[rank1]:	> Counts Sum: 359, Total Sum: 675 (53.19%), Ratio(%) per element: [66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 0.0, 0.0, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 6.66, 0.0, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 6.66, 0.0, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 33.33, 13.33, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 0.0, 0.0]
[rank2]:2025-12-30 23:40:45,718 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_apf_22_dm1/frozen_params_histogram/251230_2340_rank2_stage2.svg
[rank2]:	> Counts Sum: 297, Total Sum: 540 (55.00%), Ratio(%) per element: [66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 6.66, 20.0, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 60.0, 26.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 0.0, 0.0, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 0.0, 0.0]
[rank3]:2025-12-30 23:40:45,859 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_apf_22_dm1/frozen_params_histogram/251230_2340_rank3_stage3.svg
[rank3]:	> Counts Sum: 215, Total Sum: 435 (49.43%), Ratio(%) per element: [66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 0.0, 26.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 0.0, 6.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-12-30 23:41:29,630 - Freezing Ratio: [Stage0] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-30 23:41:29,604 - Freezing Ratio: [Stage1] 0.82, Threshold: 1.0000e-02
[rank3]:2025-12-30 23:41:29,620 - Freezing Ratio: [Stage3] 0.76, Threshold: 1.0000e-02
[rank2]:2025-12-30 23:41:29,596 - Freezing Ratio: [Stage2] 0.89, Threshold: 1.0000e-02
[rank0]:2025-12-30 23:42:10,061 - Freezing Ratio: [Stage0] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-30 23:42:10,060 - Freezing Ratio: [Stage1] 0.78, Threshold: 1.0000e-02
[rank2]:2025-12-30 23:42:10,059 - Freezing Ratio: [Stage2] 0.86, Threshold: 1.0000e-02
[rank3]:2025-12-30 23:42:10,090 - Freezing Ratio: [Stage3] 0.72, Threshold: 1.0000e-02
[rank0]:2025-12-30 23:42:50,612 - Freezing Ratio: [Stage0] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-30 23:42:50,611 - Freezing Ratio: [Stage1] 0.82, Threshold: 1.0000e-02
[rank2]:2025-12-30 23:42:50,610 - Freezing Ratio: [Stage2] 0.86, Threshold: 1.0000e-02
[rank3]:2025-12-30 23:42:50,641 - Freezing Ratio: [Stage3] 0.72, Threshold: 1.0000e-02
[rank0]:2025-12-30 23:43:31,221 - Freezing Ratio: [Stage0] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-30 23:43:31,220 - Freezing Ratio: [Stage1] 0.82, Threshold: 1.0000e-02
[rank2]:2025-12-30 23:43:31,220 - Freezing Ratio: [Stage2] 0.86, Threshold: 1.0000e-02
[rank3]:2025-12-30 23:43:31,253 - Freezing Ratio: [Stage3] 0.72, Threshold: 1.0000e-02
[rank0]:2025-12-30 23:44:11,747 - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-12-30 23:44:11,738 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.0000e-02
[rank2]:2025-12-30 23:44:11,737 - Freezing Ratio: [Stage2] 0.89, Threshold: 1.0000e-02
[rank3]:2025-12-30 23:44:11,773 - Freezing Ratio: [Stage3] 0.72, Threshold: 1.0000e-02
[rank0]:2025-12-30 23:44:11,749 - Freezing Ratio: [Stage0] 0.81, Threshold: 1.0000e-02
[rank1]:2025-12-30 23:44:15,752 - Avg. fwd time: 20.1303 / Avg. bwd time: 32.9833 / Avg. batch time: 1024.8579 (ms) / GPU bubble ratio: 58.54%
[rank2]:2025-12-30 23:44:15,722 - Avg. fwd time: 15.3935 / Avg. bwd time: 25.5455 / Avg. batch time: 965.2354 (ms) / GPU bubble ratio: 66.07%
[rank3]:2025-12-30 23:44:15,696 - Avg. fwd time: 25.6322 / Avg. bwd time: 70.8807 / Avg. batch time: 917.2759 (ms) / GPU bubble ratio: 15.83%
[rank0]:2025-12-30 23:44:15,777 - Avg. fwd time: 16.5745 / Avg. bwd time: 28.6981 / Avg. batch time: 1076.8736 (ms) / GPU bubble ratio: 66.37%
[rank0]:2025-12-30 23:44:15,779 -  step: 250  loss: -4.0000  grad_norm: 11.6183  memory: 18.76GiB(39.49%)  tps: 7,792  tflops: 60.92  mfu: 19.52%
[rank1]:2025-12-30 23:44:15,779 -  step: 250  loss: -4.0000  grad_norm: 11.6183  memory: 14.00GiB(29.46%)  tps: 7,792  tflops: 60.91  mfu: 19.52%
[rank2]:2025-12-30 23:44:15,779 -  step: 250  loss: -4.0000  grad_norm: 11.6183  memory:  9.58GiB(20.16%)  tps: 7,792  tflops: 60.91  mfu: 19.52%
[rank3]:2025-12-30 23:44:15,796 -  step: 250  loss:  5.0940  grad_norm: 11.6183  memory: 27.89GiB(58.72%)  tps: 7,791  tflops: 60.91  mfu: 19.52%
[rank0]:2025-12-30 23:44:52,169 - Freezing Ratio: [Stage0] 0.00, Threshold: 1.0000e-02
[rank1]:2025-12-30 23:44:52,168 - Freezing Ratio: [Stage1] 0.02, Threshold: 1.0000e-02
[rank2]:2025-12-30 23:44:52,167 - Freezing Ratio: [Stage2] 0.14, Threshold: 1.0000e-02
[rank3]:2025-12-30 23:44:52,199 - Freezing Ratio: [Stage3] 0.03, Threshold: 1.0000e-02
[rank1]:2025-12-30 23:45:40,660 - Freezing Ratio: [Stage1] 0.82, Threshold: 1.0000e-02
[rank2]:2025-12-30 23:45:40,652 - Freezing Ratio: [Stage2] 0.83, Threshold: 1.0000e-02
[rank3]:2025-12-30 23:45:40,676 - Freezing Ratio: [Stage3] 0.72, Threshold: 1.0000e-02
[rank0]:2025-12-30 23:45:40,686 - Freezing Ratio: [Stage0] 0.78, Threshold: 1.0000e-02
[rank0]:2025-12-30 23:46:21,163 - Freezing Ratio: [Stage0] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-30 23:46:21,193 - Freezing Ratio: [Stage3] 0.76, Threshold: 1.0000e-02
[rank1]:2025-12-30 23:46:21,163 - Freezing Ratio: [Stage1] 0.82, Threshold: 1.0000e-02
[rank2]:2025-12-30 23:46:21,162 - Freezing Ratio: [Stage2] 0.89, Threshold: 1.0000e-02
[rank0]:2025-12-30 23:47:01,776 - Freezing Ratio: [Stage0] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-30 23:47:01,775 - Freezing Ratio: [Stage1] 0.78, Threshold: 1.0000e-02
[rank2]:2025-12-30 23:47:01,774 - Freezing Ratio: [Stage2] 0.92, Threshold: 1.0000e-02
[rank3]:2025-12-30 23:47:01,807 - Freezing Ratio: [Stage3] 0.79, Threshold: 1.0000e-02
[rank1]:2025-12-30 23:47:42,227 - Freezing Ratio: [Stage1] 0.82, Threshold: 1.0000e-02
[rank2]:2025-12-30 23:47:42,226 - Freezing Ratio: [Stage2] 0.89, Threshold: 1.0000e-02
[rank0]:2025-12-30 23:47:42,227 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-30 23:47:42,230 - Freezing Ratio: [Stage0] 0.81, Threshold: 1.0000e-02
[rank3]:2025-12-30 23:47:42,256 - Freezing Ratio: [Stage3] 0.72, Threshold: 1.0000e-02
[rank3]:2025-12-30 23:47:46,208 - Avg. fwd time: 25.7023 / Avg. bwd time: 70.1982 / Avg. batch time: 912.3676 (ms) / GPU bubble ratio: 15.91%
[rank2]:2025-12-30 23:47:46,234 - Avg. fwd time: 15.4203 / Avg. bwd time: 24.8449 / Avg. batch time: 959.5596 (ms) / GPU bubble ratio: 66.43%
[rank0]:2025-12-30 23:47:46,290 - Avg. fwd time: 16.6057 / Avg. bwd time: 27.8170 / Avg. batch time: 1069.3514 (ms) / GPU bubble ratio: 66.77%
[rank0]:2025-12-30 23:47:46,293 -  step: 300  loss: -4.0000  grad_norm: 13.0260  memory: 18.76GiB(39.49%)  tps: 7,783  tflops: 60.84  mfu: 19.50%
[rank3]:2025-12-30 23:47:46,308 -  step: 300  loss:  3.7887  grad_norm: 13.0260  memory: 27.89GiB(58.72%)  tps: 7,783  tflops: 60.84  mfu: 19.50%
[rank1]:2025-12-30 23:47:46,265 - Avg. fwd time: 20.1472 / Avg. bwd time: 32.0926 / Avg. batch time: 1018.2574 (ms) / GPU bubble ratio: 58.96%
[rank1]:2025-12-30 23:47:46,292 -  step: 300  loss: -4.0000  grad_norm: 13.0260  memory: 14.00GiB(29.46%)  tps: 7,783  tflops: 60.84  mfu: 19.50%
[rank2]:2025-12-30 23:47:46,292 -  step: 300  loss: -4.0000  grad_norm: 13.0260  memory:  9.58GiB(20.16%)  tps: 7,783  tflops: 60.84  mfu: 19.50%
[rank2]:2025-12-30 23:47:46,355 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_apf_22_dm1/frozen_ratio_history/rank2/251230_2347_stage2_step300.svg
[rank0]:2025-12-30 23:47:46,354 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_apf_22_dm1/frozen_ratio_history/rank0/251230_2347_stage0_step300.svg
[rank1]:2025-12-30 23:47:46,355 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_apf_22_dm1/frozen_ratio_history/rank1/251230_2347_stage1_step300.svg
[rank0]:2025-12-30 23:47:46,503 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_apf_22_dm1/frozen_params_histogram/251230_2347_rank0_stage0.svg
[rank0]:	> Counts Sum: 563, Total Sum: 925 (60.86%), Ratio(%) per element: [76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 16.0, 0.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 4.0, 0.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 16.0, 8.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 4.0, 0.0]
[rank3]:2025-12-30 23:47:46,452 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_1F1B_apf_22_dm1/pipeline_schedule/251230_2347_step300_rank3.svg
[rank3]:			> Batch Time: 991.78 ms, GPU Bubble Ratio: 71.21%, 64.94%, 72.96%, 27.68%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-17-34ms     | [S0,MB2,F]  34-18-52ms     | [S0,MB3,F]  52-17-70ms     | [S0,MB0,B]  216-18-234ms   | [S0,MB4,F]  234-16-251ms   | [S0,MB1,B]  322-18-341ms   | [S0,MB5,F]  341-16-357ms   | [S0,MB2,B]  433-18-451ms   | [S0,MB6,F]  451-16-468ms   | [S0,MB3,B]  542-18-560ms   | [S0,MB7,F]  560-16-576ms   | [S0,MB4,B]  653-18-671ms   | [S0,MB5,B]  760-18-779ms   | [S0,MB6,B]  867-18-885ms   | [S0,MB7,B]  973-18-991ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-19-36ms     | [S1,MB1,F]  42-20-62ms     | [S1,MB2,F]  69-20-89ms     | [S1,MB0,B]  185-23-208ms   | [S1,MB3,F]  212-20-233ms   | [S1,MB1,B]  291-23-314ms   | [S1,MB4,F]  319-20-340ms   | [S1,MB2,B]  401-23-425ms   | [S1,MB5,F]  429-20-449ms   | [S1,MB3,B]  510-23-534ms   | [S1,MB6,F]  538-20-559ms   | [S1,MB4,B]  621-23-644ms   | [S1,MB7,F]  649-20-669ms   | [S1,MB5,B]  731-23-754ms   | [S1,MB6,B]  837-23-860ms   | [S1,MB7,B]  943-23-966ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  36-15-52ms     | [S2,MB1,F]  63-15-78ms     | [S2,MB0,B]  157-17-174ms   | [S2,MB2,F]  181-15-197ms   | [S2,MB1,B]  263-17-281ms   | [S2,MB3,F]  288-15-304ms   | [S2,MB2,B]  373-17-391ms   | [S2,MB4,F]  398-15-414ms   | [S2,MB3,B]  482-17-500ms   | [S2,MB5,F]  507-15-523ms   | [S2,MB4,B]  593-17-611ms   | [S2,MB6,F]  618-15-634ms   | [S2,MB5,B]  703-17-720ms   | [S2,MB7,F]  728-15-743ms   | [S2,MB6,B]  813-17-831ms   | [S2,MB7,B]  919-17-936ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-75ms     | [S3,MB0,B]  87-58-146ms    | [S3,MB1,F]  153-25-179ms   | [S3,MB1,B]  191-62-253ms   | [S3,MB2,F]  260-26-287ms   | [S3,MB2,B]  298-63-362ms   | [S3,MB3,F]  370-26-397ms   | [S3,MB3,B]  408-64-472ms   | [S3,MB4,F]  479-27-507ms   | [S3,MB4,B]  519-64-583ms   | [S3,MB5,F]  590-27-617ms   | [S3,MB5,B]  628-63-692ms   | [S3,MB6,F]  699-27-726ms   | [S3,MB6,B]  739-63-802ms   | [S3,MB7,F]  811-27-838ms   | [S3,MB7,B]  849-64-913ms  
[rank3]:2025-12-30 23:47:46,500 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_apf_22_dm1/frozen_ratio_history/rank3/251230_2347_stage3_step300.svg
[rank1]:2025-12-30 23:47:46,502 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_apf_22_dm1/frozen_params_histogram/251230_2347_rank1_stage1.svg
[rank1]:	> Counts Sum: 688, Total Sum: 1125 (61.16%), Ratio(%) per element: [76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 0.0, 0.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 4.0, 0.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 4.0, 0.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 48.0, 36.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 0.0, 0.0]
[rank2]:2025-12-30 23:47:46,506 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_apf_22_dm1/frozen_params_histogram/251230_2347_rank2_stage2.svg
[rank2]:	> Counts Sum: 586, Total Sum: 900 (65.11%), Ratio(%) per element: [76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 36.0, 44.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 52.0, 32.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 12.0, 4.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 12.0, 24.0]
[rank3]:2025-12-30 23:47:46,633 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_apf_22_dm1/frozen_params_histogram/251230_2347_rank3_stage3.svg
[rank3]:	> Counts Sum: 409, Total Sum: 725 (56.41%), Ratio(%) per element: [76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 16.0, 20.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 0.0, 4.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-12-30 23:48:23,093 - Freezing Ratio: [Stage1] 0.84, Threshold: 1.0000e-02
[rank2]:2025-12-30 23:48:23,092 - Freezing Ratio: [Stage2] 0.89, Threshold: 1.0000e-02
[rank0]:2025-12-30 23:48:23,094 - Freezing Ratio: [Stage0] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-30 23:48:23,127 - Freezing Ratio: [Stage3] 0.76, Threshold: 1.0000e-02
[rank1]:2025-12-30 23:49:03,623 - Freezing Ratio: [Stage1] 0.82, Threshold: 1.0000e-02
[rank2]:2025-12-30 23:49:03,623 - Freezing Ratio: [Stage2] 0.89, Threshold: 1.0000e-02
[rank0]:2025-12-30 23:49:03,624 - Freezing Ratio: [Stage0] 0.81, Threshold: 1.0000e-02
[rank3]:2025-12-30 23:49:03,654 - Freezing Ratio: [Stage3] 0.76, Threshold: 1.0000e-02
[rank2]:2025-12-30 23:49:44,186 - Freezing Ratio: [Stage2] 0.11, Threshold: 1.0000e-02
[rank0]:2025-12-30 23:49:44,187 - Freezing Ratio: [Stage0] 0.03, Threshold: 1.0000e-02
[rank3]:2025-12-30 23:49:44,217 - Freezing Ratio: [Stage3] 0.03, Threshold: 1.0000e-02
[rank1]:2025-12-30 23:49:44,187 - Freezing Ratio: [Stage1] 0.04, Threshold: 1.0000e-02
[rank2]:2025-12-30 23:50:32,759 - Freezing Ratio: [Stage2] 0.92, Threshold: 1.0000e-02
[rank1]:2025-12-30 23:50:32,766 - Freezing Ratio: [Stage1] 0.82, Threshold: 1.0000e-02
[rank3]:2025-12-30 23:50:32,782 - Freezing Ratio: [Stage3] 0.76, Threshold: 1.0000e-02
[rank0]:2025-12-30 23:50:32,791 - Freezing Ratio: [Stage0] 0.78, Threshold: 1.0000e-02
[rank1]:2025-12-30 23:51:13,102 - Freezing Ratio: [Stage1] 0.82, Threshold: 1.0000e-02
[rank2]:2025-12-30 23:51:13,101 - Freezing Ratio: [Stage2] 0.83, Threshold: 1.0000e-02
[rank0]:2025-12-30 23:51:13,111 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-30 23:51:13,114 - Freezing Ratio: [Stage0] 0.84, Threshold: 1.0000e-02
[rank3]:2025-12-30 23:51:13,132 - Freezing Ratio: [Stage3] 0.76, Threshold: 1.0000e-02
[rank3]:2025-12-30 23:51:17,068 - Avg. fwd time: 25.7568 / Avg. bwd time: 69.7221 / Avg. batch time: 908.9950 (ms) / GPU bubble ratio: 15.97%
[rank2]:2025-12-30 23:51:17,094 - Avg. fwd time: 15.4431 / Avg. bwd time: 24.3455 / Avg. batch time: 955.6866 (ms) / GPU bubble ratio: 66.69%
[rank0]:2025-12-30 23:51:17,152 - Avg. fwd time: 16.6359 / Avg. bwd time: 27.1855 / Avg. batch time: 1064.1605 (ms) / GPU bubble ratio: 67.06%
[rank0]:2025-12-30 23:51:17,154 -  step: 350  loss: -4.0000  grad_norm:  7.4067  memory: 18.76GiB(39.49%)  tps: 7,770  tflops: 60.74  mfu: 19.47%
[rank3]:2025-12-30 23:51:17,169 -  step: 350  loss:  1.3317  grad_norm:  7.4067  memory: 27.89GiB(58.72%)  tps: 7,770  tflops: 60.74  mfu: 19.47%
[rank1]:2025-12-30 23:51:17,125 - Avg. fwd time: 20.1623 / Avg. bwd time: 31.4518 / Avg. batch time: 1013.7276 (ms) / GPU bubble ratio: 59.27%
[rank1]:2025-12-30 23:51:17,153 -  step: 350  loss: -4.0000  grad_norm:  7.4067  memory: 14.00GiB(29.46%)  tps: 7,770  tflops: 60.74  mfu: 19.47%
[rank2]:2025-12-30 23:51:17,154 -  step: 350  loss: -4.0000  grad_norm:  7.4067  memory:  9.58GiB(20.16%)  tps: 7,770  tflops: 60.74  mfu: 19.47%
[rank1]:2025-12-30 23:51:53,490 - Freezing Ratio: [Stage1] 0.87, Threshold: 1.0000e-02
[rank3]:2025-12-30 23:51:53,520 - Freezing Ratio: [Stage3] 0.79, Threshold: 1.0000e-02
[rank0]:2025-12-30 23:51:53,491 - Freezing Ratio: [Stage0] 0.81, Threshold: 1.0000e-02
[rank2]:2025-12-30 23:51:53,490 - Freezing Ratio: [Stage2] 0.86, Threshold: 1.0000e-02
[rank1]:2025-12-30 23:52:33,988 - Freezing Ratio: [Stage1] 0.84, Threshold: 1.0000e-02
[rank0]:2025-12-30 23:52:33,989 - Freezing Ratio: [Stage0] 0.84, Threshold: 1.0000e-02
[rank2]:2025-12-30 23:52:33,988 - Freezing Ratio: [Stage2] 0.92, Threshold: 1.0000e-02
[rank3]:2025-12-30 23:52:34,018 - Freezing Ratio: [Stage3] 0.79, Threshold: 1.0000e-02
[rank2]:2025-12-30 23:53:14,266 - Freezing Ratio: [Stage2] 0.86, Threshold: 1.0000e-02
[rank1]:2025-12-30 23:53:14,267 - Freezing Ratio: [Stage1] 0.84, Threshold: 1.0000e-02
[rank3]:2025-12-30 23:53:14,297 - Freezing Ratio: [Stage3] 0.76, Threshold: 1.0000e-02
[rank0]:2025-12-30 23:53:14,268 - Freezing Ratio: [Stage0] 0.81, Threshold: 1.0000e-02
[rank1]:2025-12-30 23:53:54,503 - Freezing Ratio: [Stage1] 0.84, Threshold: 1.0000e-02
[rank0]:2025-12-30 23:53:54,504 - Freezing Ratio: [Stage0] 0.81, Threshold: 1.0000e-02
[rank2]:2025-12-30 23:53:54,503 - Freezing Ratio: [Stage2] 0.86, Threshold: 1.0000e-02
[rank3]:2025-12-30 23:53:54,535 - Freezing Ratio: [Stage3] 0.76, Threshold: 1.0000e-02
[rank1]:2025-12-30 23:54:34,838 - Freezing Ratio: [Stage1] 0.82, Threshold: 1.0000e-02
[rank0]:2025-12-30 23:54:34,838 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-30 23:54:34,840 - Freezing Ratio: [Stage0] 0.84, Threshold: 1.0000e-02
[rank3]:2025-12-30 23:54:34,868 - Freezing Ratio: [Stage3] 0.79, Threshold: 1.0000e-02
[rank2]:2025-12-30 23:54:34,837 - Freezing Ratio: [Stage2] 0.89, Threshold: 1.0000e-02
[rank3]:2025-12-30 23:54:38,856 - Avg. fwd time: 25.8193 / Avg. bwd time: 68.8785 / Avg. batch time: 902.7369 (ms) / GPU bubble ratio: 16.08%
[rank1]:2025-12-30 23:54:38,913 - Avg. fwd time: 20.1868 / Avg. bwd time: 30.4037 / Avg. batch time: 1005.5548 (ms) / GPU bubble ratio: 59.75%
[rank1]:2025-12-30 23:54:38,941 -  step: 400  loss: -4.0000  grad_norm:  0.7290  memory: 14.00GiB(29.46%)  tps: 8,119  tflops: 63.47  mfu: 20.34%
[rank0]:2025-12-30 23:54:38,940 - Avg. fwd time: 16.6778 / Avg. bwd time: 26.1283 / Avg. batch time: 1054.9083 (ms) / GPU bubble ratio: 67.54%
[rank0]:2025-12-30 23:54:38,942 -  step: 400  loss: -4.0000  grad_norm:  0.7290  memory: 18.76GiB(39.49%)  tps: 8,119  tflops: 63.47  mfu: 20.34%
[rank3]:2025-12-30 23:54:38,957 -  step: 400  loss:  0.3947  grad_norm:  0.7290  memory: 27.89GiB(58.72%)  tps: 8,120  tflops: 63.47  mfu: 20.34%
[rank2]:2025-12-30 23:54:38,882 - Avg. fwd time: 15.4766 / Avg. bwd time: 23.5420 / Avg. batch time: 948.5732 (ms) / GPU bubble ratio: 67.09%
[rank2]:2025-12-30 23:54:38,941 -  step: 400  loss: -4.0000  grad_norm:  0.7290  memory:  9.58GiB(20.16%)  tps: 8,119  tflops: 63.47  mfu: 20.34%
[rank1]:2025-12-30 23:54:39,009 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_apf_22_dm1/frozen_ratio_history/rank1/251230_2354_stage1_step400.svg
[rank0]:2025-12-30 23:54:39,008 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_apf_22_dm1/frozen_ratio_history/rank0/251230_2354_stage0_step400.svg
[rank2]:2025-12-30 23:54:39,008 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_apf_22_dm1/frozen_ratio_history/rank2/251230_2354_stage2_step400.svg
[rank1]:2025-12-30 23:54:39,162 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_apf_22_dm1/frozen_params_histogram/251230_2354_rank1_stage1.svg
[rank1]:	> Counts Sum: 1029, Total Sum: 1575 (65.33%), Ratio(%) per element: [80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 0.0, 0.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 11.42, 0.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 2.85, 20.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 57.14, 48.57, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 0.0, 0.0]
[rank0]:2025-12-30 23:54:39,158 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_apf_22_dm1/frozen_params_histogram/251230_2354_rank0_stage0.svg
[rank0]:	> Counts Sum: 835, Total Sum: 1295 (64.48%), Ratio(%) per element: [80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 11.42, 0.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 2.85, 0.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 11.42, 25.71, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 14.28, 0.0]
[rank3]:2025-12-30 23:54:39,106 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_1F1B_apf_22_dm1/pipeline_schedule/251230_2354_step400_rank3.svg
[rank3]:			> Batch Time: 990.27 ms, GPU Bubble Ratio: 71.16%, 64.91%, 72.81%, 27.80%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-17-34ms     | [S0,MB2,F]  34-18-52ms     | [S0,MB3,F]  52-17-70ms     | [S0,MB0,B]  216-18-234ms   | [S0,MB4,F]  234-16-251ms   | [S0,MB1,B]  322-18-341ms   | [S0,MB5,F]  341-16-357ms   | [S0,MB2,B]  431-18-449ms   | [S0,MB6,F]  449-16-466ms   | [S0,MB3,B]  539-18-558ms   | [S0,MB7,F]  558-16-574ms   | [S0,MB4,B]  649-18-668ms   | [S0,MB5,B]  757-18-776ms   | [S0,MB6,B]  865-18-883ms   | [S0,MB7,B]  971-18-990ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-19-36ms     | [S1,MB1,F]  42-20-63ms     | [S1,MB2,F]  69-20-89ms     | [S1,MB0,B]  184-23-208ms   | [S1,MB3,F]  212-20-233ms   | [S1,MB1,B]  291-23-314ms   | [S1,MB4,F]  318-20-339ms   | [S1,MB2,B]  400-23-423ms   | [S1,MB5,F]  427-20-448ms   | [S1,MB3,B]  508-23-532ms   | [S1,MB6,F]  536-20-556ms   | [S1,MB4,B]  618-23-641ms   | [S1,MB7,F]  645-20-666ms   | [S1,MB5,B]  728-23-751ms   | [S1,MB6,B]  835-23-858ms   | [S1,MB7,B]  941-23-964ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  36-15-52ms     | [S2,MB1,F]  63-15-78ms     | [S2,MB0,B]  156-17-174ms   | [S2,MB2,F]  181-15-197ms   | [S2,MB1,B]  263-17-281ms   | [S2,MB3,F]  288-15-304ms   | [S2,MB2,B]  371-17-389ms   | [S2,MB4,F]  396-15-412ms   | [S2,MB3,B]  480-17-498ms   | [S2,MB5,F]  505-15-521ms   | [S2,MB4,B]  589-17-607ms   | [S2,MB6,F]  614-15-630ms   | [S2,MB5,B]  700-17-718ms   | [S2,MB7,F]  725-15-741ms   | [S2,MB6,B]  811-17-829ms   | [S2,MB7,B]  917-17-935ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-75ms     | [S3,MB0,B]  87-58-146ms    | [S3,MB1,F]  153-25-179ms   | [S3,MB1,B]  191-61-253ms   | [S3,MB2,F]  260-25-286ms   | [S3,MB2,B]  297-63-361ms   | [S3,MB3,F]  368-26-395ms   | [S3,MB3,B]  407-63-470ms   | [S3,MB4,F]  477-27-504ms   | [S3,MB4,B]  516-64-580ms   | [S3,MB5,F]  586-26-613ms   | [S3,MB5,B]  625-64-689ms   | [S3,MB6,F]  697-27-724ms   | [S3,MB6,B]  736-64-800ms   | [S3,MB7,F]  808-26-834ms   | [S3,MB7,B]  847-64-911ms  
[rank3]:2025-12-30 23:54:39,159 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_apf_22_dm1/frozen_ratio_history/rank3/251230_2354_stage3_step400.svg
[rank2]:2025-12-30 23:54:39,155 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_apf_22_dm1/frozen_params_histogram/251230_2354_rank2_stage2.svg
[rank2]:	> Counts Sum: 875, Total Sum: 1260 (69.44%), Ratio(%) per element: [80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 48.57, 54.28, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 45.71, 22.85, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 28.57, 11.42, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 11.42, 37.14]
[rank3]:2025-12-30 23:54:39,294 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_apf_22_dm1/frozen_params_histogram/251230_2354_rank3_stage3.svg
[rank3]:	> Counts Sum: 611, Total Sum: 1015 (60.20%), Ratio(%) per element: [80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 34.28, 14.28, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 14.28, 2.85, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-30 23:55:01,932 - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-12-30 23:55:02,371 - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-12-30 23:55:02,398 - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-12-30 23:55:02,416 - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-12-30 23:55:15,601 - Freezing Ratio: [Stage1] 0.09, Threshold: 1.0000e-02
[rank0]:2025-12-30 23:55:15,601 - Freezing Ratio: [Stage0] 0.03, Threshold: 1.0000e-02
[rank2]:2025-12-30 23:55:15,600 - Freezing Ratio: [Stage2] 0.08, Threshold: 1.0000e-02
[rank3]:2025-12-30 23:55:15,631 - Freezing Ratio: [Stage3] 0.10, Threshold: 1.0000e-02
[rank1]:2025-12-30 23:56:04,031 - Freezing Ratio: [Stage1] 0.87, Threshold: 1.0000e-02
[rank0]:2025-12-30 23:56:04,058 - Freezing Ratio: [Stage0] 0.84, Threshold: 1.0000e-02
[rank3]:2025-12-30 23:56:04,046 - Freezing Ratio: [Stage3] 0.76, Threshold: 1.0000e-02
[rank2]:2025-12-30 23:56:04,024 - Freezing Ratio: [Stage2] 0.83, Threshold: 1.0000e-02
[rank1]:2025-12-30 23:56:44,357 - Freezing Ratio: [Stage1] 0.87, Threshold: 1.0000e-02
[rank0]:2025-12-30 23:56:44,357 - Freezing Ratio: [Stage0] 0.78, Threshold: 1.0000e-02
[rank2]:2025-12-30 23:56:44,356 - Freezing Ratio: [Stage2] 0.86, Threshold: 1.0000e-02
[rank3]:2025-12-30 23:56:44,390 - Freezing Ratio: [Stage3] 0.83, Threshold: 1.0000e-02
[rank0]:2025-12-30 23:57:24,723 - Freezing Ratio: [Stage0] 0.84, Threshold: 1.0000e-02
[rank1]:2025-12-30 23:57:24,722 - Freezing Ratio: [Stage1] 0.84, Threshold: 1.0000e-02
[rank2]:2025-12-30 23:57:24,721 - Freezing Ratio: [Stage2] 0.86, Threshold: 1.0000e-02
[rank3]:2025-12-30 23:57:24,754 - Freezing Ratio: [Stage3] 0.83, Threshold: 1.0000e-02
[rank1]:2025-12-30 23:58:05,133 - Freezing Ratio: [Stage1] 0.87, Threshold: 1.0000e-02
[rank2]:2025-12-30 23:58:05,132 - Freezing Ratio: [Stage2] 0.81, Threshold: 1.0000e-02
[rank0]:2025-12-30 23:58:05,143 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-30 23:58:05,145 - Freezing Ratio: [Stage0] 0.84, Threshold: 1.0000e-02
[rank3]:2025-12-30 23:58:05,163 - Freezing Ratio: [Stage3] 0.72, Threshold: 1.0000e-02
[rank1]:2025-12-30 23:58:09,127 - Avg. fwd time: 20.1897 / Avg. bwd time: 30.0917 / Avg. batch time: 1003.2334 (ms) / GPU bubble ratio: 59.90%
[rank3]:2025-12-30 23:58:09,068 - Avg. fwd time: 25.8480 / Avg. bwd time: 68.6285 / Avg. batch time: 900.9656 (ms) / GPU bubble ratio: 16.11%
[rank2]:2025-12-30 23:58:09,095 - Avg. fwd time: 15.4844 / Avg. bwd time: 23.3098 / Avg. batch time: 946.5799 (ms) / GPU bubble ratio: 67.21%
[rank2]:2025-12-30 23:58:09,154 -  step: 450  loss: -4.0000  grad_norm:  4.5943  memory:  9.58GiB(20.16%)  tps: 7,794  tflops: 60.93  mfu: 19.53%
[rank1]:2025-12-30 23:58:09,154 -  step: 450  loss: -4.0000  grad_norm:  4.5943  memory: 14.00GiB(29.46%)  tps: 7,794  tflops: 60.93  mfu: 19.53%
[rank0]:2025-12-30 23:58:09,152 - Avg. fwd time: 16.6865 / Avg. bwd time: 25.7574 / Avg. batch time: 1052.1907 (ms) / GPU bubble ratio: 67.73%
[rank0]:2025-12-30 23:58:09,154 -  step: 450  loss: -4.0000  grad_norm:  4.5943  memory: 18.76GiB(39.49%)  tps: 7,794  tflops: 60.93  mfu: 19.53%
[rank3]:2025-12-30 23:58:09,170 -  step: 450  loss:  0.5306  grad_norm:  4.5943  memory: 27.89GiB(58.72%)  tps: 7,794  tflops: 60.93  mfu: 19.53%
[rank0]:2025-12-30 23:58:45,553 - Freezing Ratio: [Stage0] 0.81, Threshold: 1.0000e-02
[rank1]:2025-12-30 23:58:45,553 - Freezing Ratio: [Stage1] 0.91, Threshold: 1.0000e-02
[rank3]:2025-12-30 23:58:45,585 - Freezing Ratio: [Stage3] 0.79, Threshold: 1.0000e-02
[rank2]:2025-12-30 23:58:45,553 - Freezing Ratio: [Stage2] 0.83, Threshold: 1.0000e-02
[rank0]:2025-12-30 23:59:25,997 - Freezing Ratio: [Stage0] 0.84, Threshold: 1.0000e-02
[rank1]:2025-12-30 23:59:25,996 - Freezing Ratio: [Stage1] 0.89, Threshold: 1.0000e-02
[rank2]:2025-12-30 23:59:25,996 - Freezing Ratio: [Stage2] 0.83, Threshold: 1.0000e-02
[rank3]:2025-12-30 23:59:26,027 - Freezing Ratio: [Stage3] 0.79, Threshold: 1.0000e-02
[rank1]:2025-12-31 00:00:06,535 - Freezing Ratio: [Stage1] 0.87, Threshold: 1.0000e-02
[rank0]:2025-12-31 00:00:06,536 - Freezing Ratio: [Stage0] 0.84, Threshold: 1.0000e-02
[rank3]:2025-12-31 00:00:06,565 - Freezing Ratio: [Stage3] 0.79, Threshold: 1.0000e-02
[rank2]:2025-12-31 00:00:06,535 - Freezing Ratio: [Stage2] 0.86, Threshold: 1.0000e-02
[rank1]:2025-12-31 00:00:47,113 - Freezing Ratio: [Stage1] 0.89, Threshold: 1.0000e-02
[rank0]:2025-12-31 00:00:47,114 - Freezing Ratio: [Stage0] 0.84, Threshold: 1.0000e-02
[rank2]:2025-12-31 00:00:47,114 - Freezing Ratio: [Stage2] 0.86, Threshold: 1.0000e-02
[rank3]:2025-12-31 00:00:47,146 - Freezing Ratio: [Stage3] 0.72, Threshold: 1.0000e-02
[rank0]:2025-12-31 00:01:27,606 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-31 00:01:27,608 - Freezing Ratio: [Stage0] 0.03, Threshold: 1.0000e-02
[rank1]:2025-12-31 00:01:27,605 - Freezing Ratio: [Stage1] 0.09, Threshold: 1.0000e-02
[rank2]:2025-12-31 00:01:27,605 - Freezing Ratio: [Stage2] 0.03, Threshold: 1.0000e-02
[rank3]:2025-12-31 00:01:27,636 - Freezing Ratio: [Stage3] 0.07, Threshold: 1.0000e-02
[rank3]:2025-12-31 00:01:32,296 - Avg. fwd time: 25.9064 / Avg. bwd time: 68.1337 / Avg. batch time: 897.4720 (ms) / GPU bubble ratio: 16.17%
[rank1]:2025-12-31 00:01:32,393 - Avg. fwd time: 20.2083 / Avg. bwd time: 29.4374 / Avg. batch time: 998.5506 (ms) / GPU bubble ratio: 60.23%
[rank2]:2025-12-31 00:01:32,340 - Avg. fwd time: 15.5055 / Avg. bwd time: 22.8239 / Avg. batch time: 942.5682 (ms) / GPU bubble ratio: 67.47%
[rank1]:2025-12-31 00:01:32,469 -  step: 500  loss: -4.0000  grad_norm: 19.9967  memory: 14.00GiB(29.46%)  tps: 8,058  tflops: 63.00  mfu: 20.19%
[rank0]:2025-12-31 00:01:32,444 - Avg. fwd time: 16.7086 / Avg. bwd time: 24.9969 / Avg. batch time: 1046.7204 (ms) / GPU bubble ratio: 68.12%
[rank0]:2025-12-31 00:01:32,481 -  step: 500  loss: -4.0000  grad_norm: 19.9967  memory: 18.76GiB(39.49%)  tps: 8,058  tflops: 62.99  mfu: 20.19%
[rank3]:2025-12-31 00:01:32,478 -  step: 500  loss:  0.4371  grad_norm: 19.9967  memory: 27.89GiB(58.72%)  tps: 8,059  tflops: 63.00  mfu: 20.19%
[rank2]:2025-12-31 00:01:32,466 -  step: 500  loss: -4.0000  grad_norm: 19.9967  memory:  9.58GiB(20.16%)  tps: 8,059  tflops: 63.00  mfu: 20.19%
[rank2]:2025-12-31 00:01:32,527 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_apf_22_dm1/frozen_ratio_history/rank2/251231_0001_stage2_step500.svg
[rank1]:2025-12-31 00:01:32,527 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_apf_22_dm1/frozen_ratio_history/rank1/251231_0001_stage1_step500.svg
[rank0]:2025-12-31 00:01:32,527 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_apf_22_dm1/frozen_ratio_history/rank0/251231_0001_stage0_step500.svg
[rank3]:2025-12-31 00:01:32,623 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_1F1B_apf_22_dm1/pipeline_schedule/251231_0001_step500_rank3.svg
[rank3]:			> Batch Time: 993.34 ms, GPU Bubble Ratio: 72.42%, 65.00%, 72.81%, 27.59%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-17-34ms     | [S0,MB2,F]  34-18-52ms     | [S0,MB3,F]  51-17-69ms     | [S0,MB0,B]  216-17-234ms   | [S0,MB4,F]  234-16-250ms   | [S0,MB1,B]  324-17-341ms   | [S0,MB5,F]  341-16-357ms   | [S0,MB2,B]  433-17-450ms   | [S0,MB6,F]  450-16-466ms   | [S0,MB3,B]  543-17-560ms   | [S0,MB7,F]  561-16-577ms   | [S0,MB4,B]  654-17-671ms   | [S0,MB5,B]  762-17-779ms   | [S0,MB6,B]  868-17-885ms   | [S0,MB7,B]  976-17-993ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-19-36ms     | [S1,MB1,F]  42-20-62ms     | [S1,MB2,F]  69-20-89ms     | [S1,MB0,B]  185-23-208ms   | [S1,MB3,F]  213-20-233ms   | [S1,MB1,B]  293-23-316ms   | [S1,MB4,F]  321-20-341ms   | [S1,MB2,B]  402-23-425ms   | [S1,MB5,F]  429-20-450ms   | [S1,MB3,B]  512-23-535ms   | [S1,MB6,F]  540-20-560ms   | [S1,MB4,B]  622-23-645ms   | [S1,MB7,F]  650-20-671ms   | [S1,MB5,B]  733-23-756ms   | [S1,MB6,B]  839-23-862ms   | [S1,MB7,B]  946-23-969ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  36-15-51ms     | [S2,MB1,F]  62-15-78ms     | [S2,MB0,B]  157-18-175ms   | [S2,MB2,F]  182-15-198ms   | [S2,MB1,B]  265-18-283ms   | [S2,MB3,F]  290-15-306ms   | [S2,MB2,B]  373-18-391ms   | [S2,MB4,F]  398-15-414ms   | [S2,MB3,B]  483-18-502ms   | [S2,MB5,F]  509-15-524ms   | [S2,MB4,B]  594-18-612ms   | [S2,MB6,F]  619-15-635ms   | [S2,MB5,B]  705-18-723ms   | [S2,MB7,F]  730-15-746ms   | [S2,MB6,B]  814-18-832ms   | [S2,MB7,B]  921-18-940ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  51-23-75ms     | [S3,MB0,B]  87-59-146ms    | [S3,MB1,F]  153-25-179ms   | [S3,MB1,B]  191-63-254ms   | [S3,MB2,F]  262-26-288ms   | [S3,MB2,B]  299-64-364ms   | [S3,MB3,F]  370-26-397ms   | [S3,MB3,B]  409-63-473ms   | [S3,MB4,F]  480-26-507ms   | [S3,MB4,B]  520-64-584ms   | [S3,MB5,F]  591-27-618ms   | [S3,MB5,B]  630-64-695ms   | [S3,MB6,F]  702-27-729ms   | [S3,MB6,B]  740-64-805ms   | [S3,MB7,F]  811-27-838ms   | [S3,MB7,B]  851-64-915ms  
[rank1]:2025-12-31 00:01:32,681 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_apf_22_dm1/frozen_params_histogram/251231_0001_rank1_stage1.svg
[rank1]:	> Counts Sum: 1352, Total Sum: 2025 (66.77%), Ratio(%) per element: [80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 0.0, 0.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 26.66, 0.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 11.11, 33.33, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 64.44, 57.77, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 11.11, 0.0]
[rank0]:2025-12-31 00:01:32,683 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_apf_22_dm1/frozen_params_histogram/251231_0001_rank0_stage0.svg
[rank0]:	> Counts Sum: 1082, Total Sum: 1665 (64.98%), Ratio(%) per element: [80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 22.22, 0.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 2.22, 0.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 8.88, 37.77, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 13.33, 0.0]
[rank3]:2025-12-31 00:01:32,665 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_apf_22_dm1/frozen_ratio_history/rank3/251231_0001_stage3_step500.svg
[rank2]:2025-12-31 00:01:32,680 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_apf_22_dm1/frozen_params_histogram/251231_0001_rank2_stage2.svg
[rank2]:	> Counts Sum: 1122, Total Sum: 1620 (69.26%), Ratio(%) per element: [80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 44.44, 44.44, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 51.11, 17.77, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 42.22, 8.88, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 15.55, 28.88]
[rank3]:2025-12-31 00:01:32,800 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_apf_22_dm1/frozen_params_histogram/251231_0001_rank3_stage3.svg
[rank3]:	> Counts Sum: 797, Total Sum: 1305 (61.07%), Ratio(%) per element: [80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 44.44, 11.11, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 17.77, 2.22, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 0.0, 15.55, 0.0, 0.0]
[rank2]:2025-12-31 00:02:16,493 - Freezing Ratio: [Stage2] 0.86, Threshold: 1.0000e-02
[rank0]:2025-12-31 00:02:16,526 - Freezing Ratio: [Stage0] 0.89, Threshold: 1.0000e-02
[rank1]:2025-12-31 00:02:16,500 - Freezing Ratio: [Stage1] 0.84, Threshold: 1.0000e-02
[rank3]:2025-12-31 00:02:16,516 - Freezing Ratio: [Stage3] 0.79, Threshold: 1.0000e-02
[rank0]:2025-12-31 00:02:56,908 - Freezing Ratio: [Stage0] 0.86, Threshold: 1.0000e-02
[rank1]:2025-12-31 00:02:56,908 - Freezing Ratio: [Stage1] 0.87, Threshold: 1.0000e-02
[rank3]:2025-12-31 00:02:56,938 - Freezing Ratio: [Stage3] 0.79, Threshold: 1.0000e-02
[rank2]:2025-12-31 00:02:56,908 - Freezing Ratio: [Stage2] 0.86, Threshold: 1.0000e-02
[rank0]:2025-12-31 00:03:37,318 - Freezing Ratio: [Stage0] 0.86, Threshold: 1.0000e-02
[rank1]:2025-12-31 00:03:37,318 - Freezing Ratio: [Stage1] 0.89, Threshold: 1.0000e-02
[rank3]:2025-12-31 00:03:37,348 - Freezing Ratio: [Stage3] 0.76, Threshold: 1.0000e-02
[rank2]:2025-12-31 00:03:37,318 - Freezing Ratio: [Stage2] 0.81, Threshold: 1.0000e-02
[rank0]:2025-12-31 00:04:17,609 - Freezing Ratio: [Stage0] 0.89, Threshold: 1.0000e-02
[rank1]:2025-12-31 00:04:17,608 - Freezing Ratio: [Stage1] 0.87, Threshold: 1.0000e-02
[rank3]:2025-12-31 00:04:17,639 - Freezing Ratio: [Stage3] 0.76, Threshold: 1.0000e-02
[rank2]:2025-12-31 00:04:17,609 - Freezing Ratio: [Stage2] 0.83, Threshold: 1.0000e-02
[rank0]:2025-12-31 00:04:57,960 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-31 00:04:57,962 - Freezing Ratio: [Stage0] 0.84, Threshold: 1.0000e-02
[rank3]:2025-12-31 00:04:57,981 - Freezing Ratio: [Stage3] 0.79, Threshold: 1.0000e-02
[rank1]:2025-12-31 00:04:57,950 - Freezing Ratio: [Stage1] 0.82, Threshold: 1.0000e-02
[rank2]:2025-12-31 00:04:57,950 - Freezing Ratio: [Stage2] 0.83, Threshold: 1.0000e-02
[rank3]:2025-12-31 00:05:01,967 - Avg. fwd time: 25.9276 / Avg. bwd time: 67.9711 / Avg. batch time: 896.3424 (ms) / GPU bubble ratio: 16.19%
[rank2]:2025-12-31 00:05:01,995 - Avg. fwd time: 15.5123 / Avg. bwd time: 22.6790 / Avg. batch time: 941.2927 (ms) / GPU bubble ratio: 67.54%
[rank0]:2025-12-31 00:05:02,054 - Avg. fwd time: 16.7129 / Avg. bwd time: 24.7053 / Avg. batch time: 1044.9179 (ms) / GPU bubble ratio: 68.29%
[rank0]:2025-12-31 00:05:02,056 -  step: 550  loss: -4.0000  grad_norm:  0.4583  memory: 18.76GiB(39.49%)  tps: 7,818  tflops: 61.12  mfu: 19.59%
[rank3]:2025-12-31 00:05:02,071 -  step: 550  loss:  0.3214  grad_norm:  0.4583  memory: 27.97GiB(58.88%)  tps: 7,817  tflops: 61.11  mfu: 19.59%
[rank1]:2025-12-31 00:05:02,027 - Avg. fwd time: 20.2134 / Avg. bwd time: 29.2352 / Avg. batch time: 997.0636 (ms) / GPU bubble ratio: 60.32%
[rank1]:2025-12-31 00:05:02,056 -  step: 550  loss: -4.0000  grad_norm:  0.4583  memory: 14.00GiB(29.46%)  tps: 7,817  tflops: 61.11  mfu: 19.59%
[rank2]:2025-12-31 00:05:02,056 -  step: 550  loss: -4.0000  grad_norm:  0.4583  memory:  9.58GiB(20.16%)  tps: 7,817  tflops: 61.11  mfu: 19.59%
[rank1]:2025-12-31 00:05:38,554 - Freezing Ratio: [Stage1] 0.87, Threshold: 1.0000e-02
[rank2]:2025-12-31 00:05:38,554 - Freezing Ratio: [Stage2] 0.83, Threshold: 1.0000e-02
[rank0]:2025-12-31 00:05:38,555 - Freezing Ratio: [Stage0] 0.86, Threshold: 1.0000e-02
[rank3]:2025-12-31 00:05:38,584 - Freezing Ratio: [Stage3] 0.76, Threshold: 1.0000e-02
[rank0]:2025-12-31 00:06:19,167 - Freezing Ratio: [Stage0] 0.86, Threshold: 1.0000e-02
[rank1]:2025-12-31 00:06:19,166 - Freezing Ratio: [Stage1] 0.82, Threshold: 1.0000e-02
[rank2]:2025-12-31 00:06:19,166 - Freezing Ratio: [Stage2] 0.83, Threshold: 1.0000e-02
[rank3]:2025-12-31 00:06:19,196 - Freezing Ratio: [Stage3] 0.79, Threshold: 1.0000e-02
[rank0]:2025-12-31 00:06:59,625 - Freezing Ratio: [Stage0] 0.89, Threshold: 1.0000e-02
[rank1]:2025-12-31 00:06:59,625 - Freezing Ratio: [Stage1] 0.84, Threshold: 1.0000e-02
[rank2]:2025-12-31 00:06:59,625 - Freezing Ratio: [Stage2] 0.83, Threshold: 1.0000e-02
[rank3]:2025-12-31 00:06:59,655 - Freezing Ratio: [Stage3] 0.79, Threshold: 1.0000e-02
[rank0]:2025-12-31 00:07:40,086 - Freezing Ratio: [Stage0] 0.86, Threshold: 1.0000e-02
[rank1]:2025-12-31 00:07:40,086 - Freezing Ratio: [Stage1] 0.84, Threshold: 1.0000e-02
[rank2]:2025-12-31 00:07:40,086 - Freezing Ratio: [Stage2] 0.81, Threshold: 1.0000e-02
[rank3]:2025-12-31 00:07:40,115 - Freezing Ratio: [Stage3] 0.79, Threshold: 1.0000e-02
[rank0]:2025-12-31 00:08:20,638 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-31 00:08:20,640 - Freezing Ratio: [Stage0] 0.08, Threshold: 1.0000e-02
[rank1]:2025-12-31 00:08:20,638 - Freezing Ratio: [Stage1] 0.07, Threshold: 1.0000e-02
[rank2]:2025-12-31 00:08:20,637 - Freezing Ratio: [Stage2] 0.06, Threshold: 1.0000e-02
[rank3]:2025-12-31 00:08:20,667 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.0000e-02
[rank3]:2025-12-31 00:08:25,434 - Avg. fwd time: 25.9773 / Avg. bwd time: 67.6149 / Avg. batch time: 893.8895 (ms) / GPU bubble ratio: 16.24%
[rank2]:2025-12-31 00:08:25,479 - Avg. fwd time: 15.5296 / Avg. bwd time: 22.3324 / Avg. batch time: 938.4686 (ms) / GPU bubble ratio: 67.72%
[rank1]:2025-12-31 00:08:25,534 - Avg. fwd time: 20.2294 / Avg. bwd time: 28.7732 / Avg. batch time: 993.7724 (ms) / GPU bubble ratio: 60.55%
[rank0]:2025-12-31 00:08:25,586 - Avg. fwd time: 16.7294 / Avg. bwd time: 24.1551 / Avg. batch time: 1041.0549 (ms) / GPU bubble ratio: 68.58%
[rank0]:2025-12-31 00:08:25,624 -  step: 600  loss: -4.0000  grad_norm:  6.8276  memory: 18.76GiB(39.49%)  tps: 8,048  tflops: 62.92  mfu: 20.17%
[rank3]:2025-12-31 00:08:25,620 -  step: 600  loss:  0.2904  grad_norm:  6.8276  memory: 27.97GiB(58.88%)  tps: 8,049  tflops: 62.93  mfu: 20.17%
[rank1]:2025-12-31 00:08:25,611 -  step: 600  loss: -4.0000  grad_norm:  6.8276  memory: 14.00GiB(29.46%)  tps: 8,049  tflops: 62.92  mfu: 20.17%
[rank1]:2025-12-31 00:08:25,681 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_apf_22_dm1/frozen_ratio_history/rank1/251231_0008_stage1_step600.svg
[rank2]:2025-12-31 00:08:25,607 -  step: 600  loss: -4.0000  grad_norm:  6.8276  memory:  9.58GiB(20.16%)  tps: 8,049  tflops: 62.92  mfu: 20.17%
[rank2]:2025-12-31 00:08:25,685 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_apf_22_dm1/frozen_ratio_history/rank2/251231_0008_stage2_step600.svg
[rank0]:2025-12-31 00:08:25,685 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_apf_22_dm1/frozen_ratio_history/rank0/251231_0008_stage0_step600.svg
[rank0]:2025-12-31 00:08:25,849 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_apf_22_dm1/frozen_params_histogram/251231_0008_rank0_stage0.svg
[rank0]:	> Counts Sum: 1375, Total Sum: 2035 (67.57%), Ratio(%) per element: [81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 34.54, 0.0, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 1.81, 0.0, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 20.0, 47.27, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 23.63, 0.0]
[rank3]:2025-12-31 00:08:25,771 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_1F1B_apf_22_dm1/pipeline_schedule/251231_0008_step600_rank3.svg
[rank3]:			> Batch Time: 993.27 ms, GPU Bubble Ratio: 72.42%, 64.93%, 72.71%, 27.50%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-17-34ms     | [S0,MB2,F]  34-17-52ms     | [S0,MB3,F]  52-17-69ms     | [S0,MB0,B]  216-17-234ms   | [S0,MB4,F]  234-16-250ms   | [S0,MB1,B]  324-17-341ms   | [S0,MB5,F]  341-16-358ms   | [S0,MB2,B]  433-17-450ms   | [S0,MB6,F]  451-16-467ms   | [S0,MB3,B]  543-17-560ms   | [S0,MB7,F]  561-16-577ms   | [S0,MB4,B]  653-17-670ms   | [S0,MB5,B]  762-17-779ms   | [S0,MB6,B]  868-17-885ms   | [S0,MB7,B]  976-17-993ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-19-36ms     | [S1,MB1,F]  42-20-62ms     | [S1,MB2,F]  69-20-89ms     | [S1,MB0,B]  185-23-208ms   | [S1,MB3,F]  213-20-233ms   | [S1,MB1,B]  293-23-316ms   | [S1,MB4,F]  321-20-341ms   | [S1,MB2,B]  402-23-426ms   | [S1,MB5,F]  430-20-451ms   | [S1,MB3,B]  512-23-535ms   | [S1,MB6,F]  540-20-561ms   | [S1,MB4,B]  622-23-645ms   | [S1,MB7,F]  650-20-670ms   | [S1,MB5,B]  732-23-755ms   | [S1,MB6,B]  838-23-861ms   | [S1,MB7,B]  946-23-969ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  36-15-52ms     | [S2,MB1,F]  62-15-78ms     | [S2,MB0,B]  157-18-175ms   | [S2,MB2,F]  182-15-198ms   | [S2,MB1,B]  264-18-283ms   | [S2,MB3,F]  290-15-306ms   | [S2,MB2,B]  374-18-392ms   | [S2,MB4,F]  399-15-415ms   | [S2,MB3,B]  484-18-502ms   | [S2,MB5,F]  509-15-525ms   | [S2,MB4,B]  593-18-611ms   | [S2,MB6,F]  619-15-634ms   | [S2,MB5,B]  704-18-722ms   | [S2,MB7,F]  729-15-745ms   | [S2,MB6,B]  814-18-832ms   | [S2,MB7,B]  921-18-939ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-75ms     | [S3,MB0,B]  87-59-147ms    | [S3,MB1,F]  154-25-179ms   | [S3,MB1,B]  191-63-255ms   | [S3,MB2,F]  261-27-288ms   | [S3,MB2,B]  299-63-363ms   | [S3,MB3,F]  371-27-398ms   | [S3,MB3,B]  410-64-475ms   | [S3,MB4,F]  481-26-508ms   | [S3,MB4,B]  520-64-584ms   | [S3,MB5,F]  591-27-618ms   | [S3,MB5,B]  630-64-694ms   | [S3,MB6,F]  701-26-728ms   | [S3,MB6,B]  740-64-805ms   | [S3,MB7,F]  811-27-838ms   | [S3,MB7,B]  850-64-915ms  
[rank3]:2025-12-31 00:08:25,814 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_apf_22_dm1/frozen_ratio_history/rank3/251231_0008_stage3_step600.svg
[rank1]:2025-12-31 00:08:25,831 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_apf_22_dm1/frozen_params_histogram/251231_0008_rank1_stage1.svg
[rank1]:	> Counts Sum: 1700, Total Sum: 2475 (68.69%), Ratio(%) per element: [81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 0.0, 0.0, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 38.18, 0.0, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 9.09, 43.63, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 56.36, 56.36, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 23.63, 0.0]
[rank2]:2025-12-31 00:08:25,847 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_apf_22_dm1/frozen_params_histogram/251231_0008_rank2_stage2.svg
[rank2]:	> Counts Sum: 1394, Total Sum: 1980 (70.40%), Ratio(%) per element: [81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 36.36, 36.36, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 47.27, 14.54, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 50.9, 7.27, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 27.27, 23.63]
[rank3]:2025-12-31 00:08:25,946 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_apf_22_dm1/frozen_params_histogram/251231_0008_rank3_stage3.svg
[rank3]:	> Counts Sum: 1001, Total Sum: 1595 (62.76%), Ratio(%) per element: [81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 38.18, 9.09, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 14.54, 1.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 10.9, 27.27, 0.0, 0.0]
[rank1]:2025-12-31 00:09:09,728 - Freezing Ratio: [Stage1] 0.84, Threshold: 1.0000e-02
[rank2]:2025-12-31 00:09:09,720 - Freezing Ratio: [Stage2] 0.81, Threshold: 1.0000e-02
[rank3]:2025-12-31 00:09:09,744 - Freezing Ratio: [Stage3] 0.79, Threshold: 1.0000e-02
[rank0]:2025-12-31 00:09:09,754 - Freezing Ratio: [Stage0] 0.84, Threshold: 1.0000e-02
[rank3]:2025-12-31 00:09:50,265 - Freezing Ratio: [Stage3] 0.79, Threshold: 1.0000e-02
[rank0]:2025-12-31 00:09:50,236 - Freezing Ratio: [Stage0] 0.86, Threshold: 1.0000e-02
[rank1]:2025-12-31 00:09:50,235 - Freezing Ratio: [Stage1] 0.82, Threshold: 1.0000e-02
[rank2]:2025-12-31 00:09:50,235 - Freezing Ratio: [Stage2] 0.83, Threshold: 1.0000e-02
[rank0]:2025-12-31 00:10:30,699 - Freezing Ratio: [Stage0] 0.86, Threshold: 1.0000e-02
[rank1]:2025-12-31 00:10:30,698 - Freezing Ratio: [Stage1] 0.82, Threshold: 1.0000e-02
[rank2]:2025-12-31 00:10:30,698 - Freezing Ratio: [Stage2] 0.83, Threshold: 1.0000e-02
[rank3]:2025-12-31 00:10:30,728 - Freezing Ratio: [Stage3] 0.79, Threshold: 1.0000e-02
[rank2]:2025-12-31 00:11:11,321 - Freezing Ratio: [Stage2] 0.83, Threshold: 1.0000e-02
[rank3]:2025-12-31 00:11:11,354 - Freezing Ratio: [Stage3] 0.79, Threshold: 1.0000e-02
[rank0]:2025-12-31 00:11:11,322 - Freezing Ratio: [Stage0] 0.81, Threshold: 1.0000e-02
[rank1]:2025-12-31 00:11:11,322 - Freezing Ratio: [Stage1] 0.84, Threshold: 1.0000e-02
[rank3]:2025-12-31 00:11:51,923 - Freezing Ratio: [Stage3] 0.76, Threshold: 1.0000e-02
[rank0]:2025-12-31 00:11:51,900 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-31 00:11:51,903 - Freezing Ratio: [Stage0] 0.86, Threshold: 1.0000e-02
[rank1]:2025-12-31 00:11:51,891 - Freezing Ratio: [Stage1] 0.82, Threshold: 1.0000e-02
[rank2]:2025-12-31 00:11:51,891 - Freezing Ratio: [Stage2] 0.81, Threshold: 1.0000e-02
[rank3]:2025-12-31 00:11:55,864 - Avg. fwd time: 26.0001 / Avg. bwd time: 67.5341 / Avg. batch time: 893.4282 (ms) / GPU bubble ratio: 16.25%
[rank0]:2025-12-31 00:11:55,951 - Avg. fwd time: 16.7362 / Avg. bwd time: 23.9956 / Avg. batch time: 1040.2223 (ms) / GPU bubble ratio: 68.67%
[rank1]:2025-12-31 00:11:55,924 - Avg. fwd time: 20.2358 / Avg. bwd time: 28.6593 / Avg. batch time: 993.1038 (ms) / GPU bubble ratio: 60.61%
[rank1]:2025-12-31 00:11:55,953 -  step: 650  loss: -4.0000  grad_norm:  1.1797  memory: 14.00GiB(29.46%)  tps: 7,789  tflops: 60.89  mfu: 19.52%
[rank2]:2025-12-31 00:11:55,892 - Avg. fwd time: 15.5352 / Avg. bwd time: 22.2493 / Avg. batch time: 937.9193 (ms) / GPU bubble ratio: 67.77%
[rank2]:2025-12-31 00:11:55,953 -  step: 650  loss: -4.0000  grad_norm:  1.1797  memory:  9.58GiB(20.16%)  tps: 7,789  tflops: 60.89  mfu: 19.52%
[rank3]:2025-12-31 00:11:55,968 -  step: 650  loss:  0.3065  grad_norm:  1.1797  memory: 27.97GiB(58.88%)  tps: 7,789  tflops: 60.89  mfu: 19.52%
[rank0]:2025-12-31 00:11:55,953 -  step: 650  loss: -4.0000  grad_norm:  1.1797  memory: 18.76GiB(39.49%)  tps: 7,790  tflops: 60.90  mfu: 19.52%
[rank0]:2025-12-31 00:12:32,282 - Freezing Ratio: [Stage0] 0.86, Threshold: 1.0000e-02
[rank1]:2025-12-31 00:12:32,282 - Freezing Ratio: [Stage1] 0.82, Threshold: 1.0000e-02
[rank2]:2025-12-31 00:12:32,282 - Freezing Ratio: [Stage2] 0.83, Threshold: 1.0000e-02
[rank3]:2025-12-31 00:12:32,314 - Freezing Ratio: [Stage3] 0.79, Threshold: 1.0000e-02
[rank0]:2025-12-31 00:13:12,615 - Freezing Ratio: [Stage0] 0.86, Threshold: 1.0000e-02
[rank1]:2025-12-31 00:13:12,615 - Freezing Ratio: [Stage1] 0.82, Threshold: 1.0000e-02
[rank2]:2025-12-31 00:13:12,615 - Freezing Ratio: [Stage2] 0.83, Threshold: 1.0000e-02
[rank3]:2025-12-31 00:13:12,645 - Freezing Ratio: [Stage3] 0.76, Threshold: 1.0000e-02
[rank1]:2025-12-31 00:13:53,005 - Freezing Ratio: [Stage1] 0.84, Threshold: 1.0000e-02
[rank2]:2025-12-31 00:13:53,005 - Freezing Ratio: [Stage2] 0.83, Threshold: 1.0000e-02
[rank3]:2025-12-31 00:13:53,035 - Freezing Ratio: [Stage3] 0.79, Threshold: 1.0000e-02
[rank0]:2025-12-31 00:13:53,006 - Freezing Ratio: [Stage0] 0.84, Threshold: 1.0000e-02
[rank0]:2025-12-31 00:14:33,559 - Freezing Ratio: [Stage0] 0.84, Threshold: 1.0000e-02
[rank1]:2025-12-31 00:14:33,558 - Freezing Ratio: [Stage1] 0.82, Threshold: 1.0000e-02
[rank2]:2025-12-31 00:14:33,558 - Freezing Ratio: [Stage2] 0.83, Threshold: 1.0000e-02
[rank3]:2025-12-31 00:14:33,588 - Freezing Ratio: [Stage3] 0.79, Threshold: 1.0000e-02
[rank0]:2025-12-31 00:15:13,902 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-31 00:15:13,904 - Freezing Ratio: [Stage0] 0.86, Threshold: 1.0000e-02
[rank1]:2025-12-31 00:15:13,901 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.0000e-02
[rank2]:2025-12-31 00:15:13,901 - Freezing Ratio: [Stage2] 0.81, Threshold: 1.0000e-02
[rank3]:2025-12-31 00:15:13,931 - Freezing Ratio: [Stage3] 0.79, Threshold: 1.0000e-02
[rank3]:2025-12-31 00:15:17,853 - Avg. fwd time: 26.0293 / Avg. bwd time: 67.2112 / Avg. batch time: 891.0768 (ms) / GPU bubble ratio: 16.29%
[rank1]:2025-12-31 00:15:17,915 - Avg. fwd time: 20.2483 / Avg. bwd time: 28.2703 / Avg. batch time: 990.0433 (ms) / GPU bubble ratio: 60.79%
[rank1]:2025-12-31 00:15:17,943 -  step: 700  loss: -4.0000  grad_norm:  0.8922  memory: 14.00GiB(29.46%)  tps: 8,111  tflops: 63.41  mfu: 20.32%
[rank2]:2025-12-31 00:15:17,882 - Avg. fwd time: 15.5479 / Avg. bwd time: 21.9535 / Avg. batch time: 935.2526 (ms) / GPU bubble ratio: 67.92%
[rank2]:2025-12-31 00:15:17,943 -  step: 700  loss: -4.0000  grad_norm:  0.8922  memory:  9.58GiB(20.16%)  tps: 8,111  tflops: 63.41  mfu: 20.32%
[rank3]:2025-12-31 00:15:17,959 -  step: 700  loss:  0.2761  grad_norm:  0.8922  memory: 27.97GiB(58.88%)  tps: 8,111  tflops: 63.41  mfu: 20.32%
[rank0]:2025-12-31 00:15:17,942 - Avg. fwd time: 16.7507 / Avg. bwd time: 23.5410 / Avg. batch time: 1036.6994 (ms) / GPU bubble ratio: 68.91%
[rank0]:2025-12-31 00:15:17,944 -  step: 700  loss: -4.0000  grad_norm:  0.8922  memory: 18.76GiB(39.49%)  tps: 8,111  tflops: 63.41  mfu: 20.32%
[rank0]:2025-12-31 00:15:18,008 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_apf_22_dm1/frozen_ratio_history/rank0/251231_0015_stage0_step700.svg
[rank1]:2025-12-31 00:15:18,010 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_apf_22_dm1/frozen_ratio_history/rank1/251231_0015_stage1_step700.svg
[rank2]:2025-12-31 00:15:18,009 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_apf_22_dm1/frozen_ratio_history/rank2/251231_0015_stage2_step700.svg
[rank3]:2025-12-31 00:15:18,108 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_1F1B_apf_22_dm1/pipeline_schedule/251231_0015_step700_rank3.svg
[rank3]:			> Batch Time: 990.36 ms, GPU Bubble Ratio: 72.36%, 64.86%, 72.72%, 27.73%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-17-34ms     | [S0,MB2,F]  34-17-52ms     | [S0,MB3,F]  52-17-69ms     | [S0,MB0,B]  216-17-233ms   | [S0,MB4,F]  233-16-249ms   | [S0,MB1,B]  323-17-340ms   | [S0,MB5,F]  341-16-357ms   | [S0,MB2,B]  432-17-450ms   | [S0,MB6,F]  450-16-466ms   | [S0,MB3,B]  542-17-559ms   | [S0,MB7,F]  560-16-576ms   | [S0,MB4,B]  652-17-669ms   | [S0,MB5,B]  759-17-776ms   | [S0,MB6,B]  866-17-883ms   | [S0,MB7,B]  973-17-990ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-19-36ms     | [S1,MB1,F]  42-20-62ms     | [S1,MB2,F]  69-20-89ms     | [S1,MB0,B]  185-23-208ms   | [S1,MB3,F]  212-20-233ms   | [S1,MB1,B]  291-23-315ms   | [S1,MB4,F]  319-20-340ms   | [S1,MB2,B]  401-23-425ms   | [S1,MB5,F]  429-20-449ms   | [S1,MB3,B]  511-23-534ms   | [S1,MB6,F]  539-20-560ms   | [S1,MB4,B]  621-23-644ms   | [S1,MB7,F]  648-20-668ms   | [S1,MB5,B]  730-23-753ms   | [S1,MB6,B]  836-23-859ms   | [S1,MB7,B]  943-23-966ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  36-15-51ms     | [S2,MB1,F]  62-15-78ms     | [S2,MB0,B]  156-18-175ms   | [S2,MB2,F]  181-15-197ms   | [S2,MB1,B]  263-18-281ms   | [S2,MB3,F]  288-15-304ms   | [S2,MB2,B]  373-18-391ms   | [S2,MB4,F]  398-15-413ms   | [S2,MB3,B]  482-18-501ms   | [S2,MB5,F]  508-15-523ms   | [S2,MB4,B]  592-18-611ms   | [S2,MB6,F]  617-15-633ms   | [S2,MB5,B]  701-18-720ms   | [S2,MB7,F]  726-15-742ms   | [S2,MB6,B]  811-18-830ms   | [S2,MB7,B]  918-18-936ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  51-23-75ms     | [S3,MB0,B]  87-59-146ms    | [S3,MB1,F]  153-25-179ms   | [S3,MB1,B]  191-62-253ms   | [S3,MB2,F]  260-26-287ms   | [S3,MB2,B]  299-63-363ms   | [S3,MB3,F]  369-26-396ms   | [S3,MB3,B]  408-63-472ms   | [S3,MB4,F]  480-27-507ms   | [S3,MB4,B]  518-64-582ms   | [S3,MB5,F]  589-27-616ms   | [S3,MB5,B]  628-63-692ms   | [S3,MB6,F]  698-27-726ms   | [S3,MB6,B]  738-64-802ms   | [S3,MB7,F]  808-27-836ms   | [S3,MB7,B]  847-63-911ms  
[rank3]:2025-12-31 00:15:18,154 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_apf_22_dm1/frozen_ratio_history/rank3/251231_0015_stage3_step700.svg
[rank0]:2025-12-31 00:15:18,159 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_apf_22_dm1/frozen_params_histogram/251231_0015_rank0_stage0.svg
[rank0]:	> Counts Sum: 1690, Total Sum: 2405 (70.27%), Ratio(%) per element: [84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 41.53, 0.0, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 1.53, 0.0, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 29.23, 52.3, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 21.53, 0.0]
[rank1]:2025-12-31 00:15:18,166 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_apf_22_dm1/frozen_params_histogram/251231_0015_rank1_stage1.svg
[rank1]:	> Counts Sum: 2072, Total Sum: 2925 (70.84%), Ratio(%) per element: [84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 0.0, 0.0, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 41.53, 0.0, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 7.69, 50.76, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 47.69, 47.69, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 30.76, 0.0]
[rank2]:2025-12-31 00:15:18,158 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_apf_22_dm1/frozen_params_histogram/251231_0015_rank2_stage2.svg
[rank2]:	> Counts Sum: 1691, Total Sum: 2340 (72.26%), Ratio(%) per element: [84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 30.76, 30.76, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 40.0, 12.3, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 55.38, 6.15, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 36.92, 20.0]
[rank3]:2025-12-31 00:15:18,289 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_apf_22_dm1/frozen_params_histogram/251231_0015_rank3_stage3.svg
[rank3]:	> Counts Sum: 1229, Total Sum: 1885 (65.20%), Ratio(%) per element: [84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 32.3, 7.69, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 12.3, 1.53, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 23.07, 36.92, 0.0, 0.0]
[rank2]:2025-12-31 00:15:54,597 - Freezing Ratio: [Stage2] 0.06, Threshold: 1.0000e-02
[rank3]:2025-12-31 00:15:54,627 - Freezing Ratio: [Stage3] 0.03, Threshold: 1.0000e-02
[rank0]:2025-12-31 00:15:54,598 - Freezing Ratio: [Stage0] 0.08, Threshold: 1.0000e-02
[rank1]:2025-12-31 00:15:54,597 - Freezing Ratio: [Stage1] 0.02, Threshold: 1.0000e-02
[rank3]:2025-12-31 00:16:43,226 - Freezing Ratio: [Stage3] 0.79, Threshold: 1.0000e-02
[rank0]:2025-12-31 00:16:43,236 - Freezing Ratio: [Stage0] 0.86, Threshold: 1.0000e-02
[rank1]:2025-12-31 00:16:43,211 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.0000e-02
[rank2]:2025-12-31 00:16:43,203 - Freezing Ratio: [Stage2] 0.81, Threshold: 1.0000e-02
[rank3]:2025-12-31 00:17:23,781 - Freezing Ratio: [Stage3] 0.79, Threshold: 1.0000e-02
[rank0]:2025-12-31 00:17:23,752 - Freezing Ratio: [Stage0] 0.86, Threshold: 1.0000e-02
[rank1]:2025-12-31 00:17:23,751 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.0000e-02
[rank2]:2025-12-31 00:17:23,751 - Freezing Ratio: [Stage2] 0.83, Threshold: 1.0000e-02
[rank0]:2025-12-31 00:18:04,137 - Freezing Ratio: [Stage0] 0.84, Threshold: 1.0000e-02
[rank1]:2025-12-31 00:18:04,137 - Freezing Ratio: [Stage1] 0.78, Threshold: 1.0000e-02
[rank2]:2025-12-31 00:18:04,136 - Freezing Ratio: [Stage2] 0.83, Threshold: 1.0000e-02
[rank3]:2025-12-31 00:18:04,166 - Freezing Ratio: [Stage3] 0.79, Threshold: 1.0000e-02
[rank0]:2025-12-31 00:18:44,560 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-31 00:18:44,562 - Freezing Ratio: [Stage0] 0.86, Threshold: 1.0000e-02
[rank3]:2025-12-31 00:18:44,581 - Freezing Ratio: [Stage3] 0.76, Threshold: 1.0000e-02
[rank1]:2025-12-31 00:18:44,550 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.0000e-02
[rank2]:2025-12-31 00:18:44,550 - Freezing Ratio: [Stage2] 0.83, Threshold: 1.0000e-02
[rank3]:2025-12-31 00:18:48,550 - Avg. fwd time: 26.0359 / Avg. bwd time: 67.1806 / Avg. batch time: 890.8843 (ms) / GPU bubble ratio: 16.29%
[rank1]:2025-12-31 00:18:48,612 - Avg. fwd time: 20.2531 / Avg. bwd time: 28.2402 / Avg. batch time: 989.7995 (ms) / GPU bubble ratio: 60.81%
[rank2]:2025-12-31 00:18:48,579 - Avg. fwd time: 15.5504 / Avg. bwd time: 21.9306 / Avg. batch time: 935.0462 (ms) / GPU bubble ratio: 67.93%
[rank0]:2025-12-31 00:18:48,639 - Avg. fwd time: 16.7540 / Avg. bwd time: 23.4568 / Avg. batch time: 1036.3659 (ms) / GPU bubble ratio: 68.96%
[rank0]:2025-12-31 00:18:48,642 -  step: 750  loss: -4.0000  grad_norm:  0.2152  memory: 18.76GiB(39.49%)  tps: 7,776  tflops: 60.79  mfu: 19.48%
[rank3]:2025-12-31 00:18:48,657 -  step: 750  loss:  0.3106  grad_norm:  0.2152  memory: 27.97GiB(58.88%)  tps: 7,776  tflops: 60.79  mfu: 19.48%
[rank1]:2025-12-31 00:18:48,641 -  step: 750  loss: -4.0000  grad_norm:  0.2152  memory: 14.00GiB(29.46%)  tps: 7,776  tflops: 60.79  mfu: 19.48%
[rank2]:2025-12-31 00:18:48,641 -  step: 750  loss: -4.0000  grad_norm:  0.2152  memory:  9.58GiB(20.16%)  tps: 7,776  tflops: 60.79  mfu: 19.48%
[rank0]:2025-12-31 00:19:25,131 - Freezing Ratio: [Stage0] 0.84, Threshold: 1.0000e-02
[rank1]:2025-12-31 00:19:25,131 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.0000e-02
[rank2]:2025-12-31 00:19:25,130 - Freezing Ratio: [Stage2] 0.83, Threshold: 1.0000e-02
[rank3]:2025-12-31 00:19:25,161 - Freezing Ratio: [Stage3] 0.79, Threshold: 1.0000e-02
[rank1]:2025-12-31 00:20:05,729 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.0000e-02
[rank2]:2025-12-31 00:20:05,729 - Freezing Ratio: [Stage2] 0.83, Threshold: 1.0000e-02
[rank3]:2025-12-31 00:20:05,759 - Freezing Ratio: [Stage3] 0.79, Threshold: 1.0000e-02
[rank0]:2025-12-31 00:20:05,730 - Freezing Ratio: [Stage0] 0.84, Threshold: 1.0000e-02
[rank1]:2025-12-31 00:20:46,259 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.0000e-02
[rank2]:2025-12-31 00:20:46,258 - Freezing Ratio: [Stage2] 0.83, Threshold: 1.0000e-02
[rank3]:2025-12-31 00:20:46,288 - Freezing Ratio: [Stage3] 0.76, Threshold: 1.0000e-02
[rank0]:2025-12-31 00:20:46,259 - Freezing Ratio: [Stage0] 0.84, Threshold: 1.0000e-02
[rank0]:2025-12-31 00:21:26,693 - Freezing Ratio: [Stage0] 0.86, Threshold: 1.0000e-02
[rank1]:2025-12-31 00:21:26,692 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.0000e-02
[rank2]:2025-12-31 00:21:26,692 - Freezing Ratio: [Stage2] 0.83, Threshold: 1.0000e-02
[rank3]:2025-12-31 00:21:26,725 - Freezing Ratio: [Stage3] 0.79, Threshold: 1.0000e-02
[rank1]:2025-12-31 00:22:07,184 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.0000e-02
[rank2]:2025-12-31 00:22:07,184 - Freezing Ratio: [Stage2] 0.78, Threshold: 1.0000e-02
[rank3]:2025-12-31 00:22:07,214 - Freezing Ratio: [Stage3] 0.79, Threshold: 1.0000e-02
[rank0]:2025-12-31 00:22:07,185 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-31 00:22:07,186 - Freezing Ratio: [Stage0] 0.86, Threshold: 1.0000e-02
[rank3]:2025-12-31 00:22:11,223 - Avg. fwd time: 26.0656 / Avg. bwd time: 66.9411 / Avg. batch time: 889.2017 (ms) / GPU bubble ratio: 16.32%
[rank1]:2025-12-31 00:22:11,286 - Avg. fwd time: 20.2662 / Avg. bwd time: 27.9312 / Avg. batch time: 987.5510 (ms) / GPU bubble ratio: 60.96%
[rank2]:2025-12-31 00:22:11,253 - Avg. fwd time: 15.5632 / Avg. bwd time: 21.6942 / Avg. batch time: 933.1124 (ms) / GPU bubble ratio: 68.06%
[rank3]:2025-12-31 00:22:11,332 -  step: 800  loss:  0.2964  grad_norm:  0.2187  memory: 27.97GiB(58.88%)  tps: 8,084  tflops: 63.20  mfu: 20.26%
[rank3]:2025-12-31 00:22:11,332 - â„¹ï¸ final step: 800  loss:  0.2964  grad_norm:  0.2187  tps: 8,246  tflops: 64.46  mfu: 18.96%
[rank3]:2025-12-31 00:22:11,333 - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-12-31 00:22:11,334 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-31 00:22:11,314 - Avg. fwd time: 16.7658 / Avg. bwd time: 23.0964 / Avg. batch time: 1033.7465 (ms) / GPU bubble ratio: 69.15%
[rank0]:2025-12-31 00:22:11,316 -  step: 800  loss: -4.0000  grad_norm:  0.2187  memory: 18.76GiB(39.49%)  tps: 8,084  tflops: 63.20  mfu: 20.26%
[rank0]:2025-12-31 00:22:11,316 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  0.2187  tps: 8,240  tflops: 64.41  mfu: 18.82%
[rank0]:2025-12-31 00:22:11,316 - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-12-31 00:22:11,317 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank1]:2025-12-31 00:22:11,316 -  step: 800  loss: -4.0000  grad_norm:  0.2187  memory: 14.00GiB(29.46%)  tps: 8,084  tflops: 63.20  mfu: 20.26%
[rank1]:2025-12-31 00:22:11,316 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  0.2187  tps: 8,240  tflops: 64.42  mfu: 18.82%
[rank1]:2025-12-31 00:22:11,316 - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-12-31 00:22:11,317 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank2]:2025-12-31 00:22:11,316 -  step: 800  loss: -4.0000  grad_norm:  0.2187  memory:  9.58GiB(20.16%)  tps: 8,084  tflops: 63.20  mfu: 20.26%
[rank2]:2025-12-31 00:22:11,316 - â„¹ï¸ final step: 800  loss: -4.0000  grad_norm:  0.2187  tps: 8,240  tflops: 64.42  mfu: 18.83%
[rank2]:2025-12-31 00:22:11,316 - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-12-31 00:22:11,316 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-31 00:22:13,943 - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank2]:2025-12-31 00:22:14,007 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_apf_22_dm1/frozen_ratio_history/rank2/251231_0022_stage2_final800.svg
[rank0]:2025-12-31 00:22:14,008 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_apf_22_dm1/frozen_ratio_history/rank0/251231_0022_stage0_final800.svg
[rank1]:2025-12-31 00:22:14,009 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_apf_22_dm1/frozen_ratio_history/rank1/251231_0022_stage1_final800.svg
[rank3]:2025-12-31 00:22:14,105 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_1F1B_apf_22_dm1/pipeline_schedule/251231_0022_final800_rank3.svg
[rank3]:			> Batch Time: 996.70 ms, GPU Bubble Ratio: 71.48%, 65.06%, 72.90%, 27.89%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-16-16ms      | [S0,MB1,F]  16-17-34ms     | [S0,MB2,F]  34-17-51ms     | [S0,MB3,F]  51-17-69ms     | [S0,MB0,B]  217-18-235ms   | [S0,MB4,F]  235-16-251ms   | [S0,MB1,B]  324-18-342ms   | [S0,MB5,F]  342-16-358ms   | [S0,MB2,B]  434-18-452ms   | [S0,MB6,F]  452-16-468ms   | [S0,MB3,B]  544-18-562ms   | [S0,MB7,F]  562-16-578ms   | [S0,MB4,B]  654-18-673ms   | [S0,MB5,B]  763-18-782ms   | [S0,MB6,B]  870-18-889ms   | [S0,MB7,B]  978-18-996ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  16-19-36ms     | [S1,MB1,F]  42-20-62ms     | [S1,MB2,F]  69-20-89ms     | [S1,MB0,B]  186-23-209ms   | [S1,MB3,F]  213-20-234ms   | [S1,MB1,B]  293-23-316ms   | [S1,MB4,F]  320-20-341ms   | [S1,MB2,B]  402-23-426ms   | [S1,MB5,F]  430-20-451ms   | [S1,MB3,B]  512-23-536ms   | [S1,MB6,F]  540-20-561ms   | [S1,MB4,B]  623-23-646ms   | [S1,MB7,F]  651-20-671ms   | [S1,MB5,B]  734-23-757ms   | [S1,MB6,B]  841-23-864ms   | [S1,MB7,B]  948-23-971ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  36-15-52ms     | [S2,MB1,F]  63-15-78ms     | [S2,MB0,B]  157-18-175ms   | [S2,MB2,F]  182-15-198ms   | [S2,MB1,B]  265-18-283ms   | [S2,MB3,F]  290-15-305ms   | [S2,MB2,B]  374-18-392ms   | [S2,MB4,F]  399-15-415ms   | [S2,MB3,B]  484-18-502ms   | [S2,MB5,F]  509-15-525ms   | [S2,MB4,B]  595-18-613ms   | [S2,MB6,F]  620-15-636ms   | [S2,MB5,B]  706-18-724ms   | [S2,MB7,F]  731-15-746ms   | [S2,MB6,B]  816-18-834ms   | [S2,MB7,B]  923-18-941ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  52-23-75ms     | [S3,MB0,B]  87-59-147ms    | [S3,MB1,F]  154-25-179ms   | [S3,MB1,B]  192-62-255ms   | [S3,MB2,F]  262-26-288ms   | [S3,MB2,B]  300-64-365ms   | [S3,MB3,F]  371-26-398ms   | [S3,MB3,B]  410-64-474ms   | [S3,MB4,F]  481-26-508ms   | [S3,MB4,B]  520-64-585ms   | [S3,MB5,F]  592-26-619ms   | [S3,MB5,B]  631-64-696ms   | [S3,MB6,F]  703-26-730ms   | [S3,MB6,B]  742-64-806ms   | [S3,MB7,F]  813-26-840ms   | [S3,MB7,B]  852-64-917ms  
[rank0]:2025-12-31 00:22:14,160 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_apf_22_dm1/frozen_params_histogram/251231_0022_rank0_stage0.svg
[rank0]:	> Counts Sum: 1977, Total Sum: 2775 (71.24%), Ratio(%) per element: [85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 48.0, 0.0, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 1.33, 0.0, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 37.33, 46.66, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 28.0, 0.0]
[rank0]:2025-12-31 00:22:14,160 - Sleeping 2 seconds for other ranks to complete
[rank1]:2025-12-31 00:22:14,161 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_apf_22_dm1/frozen_params_histogram/251231_0022_rank1_stage1.svg
[rank1]:	> Counts Sum: 2396, Total Sum: 3375 (70.99%), Ratio(%) per element: [85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 0.0, 0.0, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 36.0, 0.0, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 6.66, 56.0, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 41.33, 41.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 26.66, 0.0]
[rank1]:2025-12-31 00:22:14,161 - Destroying the purge thread.
[rank2]:2025-12-31 00:22:14,157 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_apf_22_dm1/frozen_params_histogram/251231_0022_rank2_stage2.svg
[rank2]:	> Counts Sum: 1960, Total Sum: 2700 (72.59%), Ratio(%) per element: [85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 26.66, 26.66, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 34.66, 10.66, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 60.0, 5.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 42.66, 17.33]
[rank2]:2025-12-31 00:22:14,157 - Destroying the purge thread.
[rank3]:2025-12-31 00:22:14,243 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_1F1B_apf_22_dm1/pipeline_schedule/251231_0022_thry_final800_rank3.svg
[rank3]:			> Batch Time: 650.69 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-19-19ms      | [S0,MB1,F]  19-19-39ms     | [S0,MB2,F]  39-19-59ms     | [S0,MB3,F]  59-19-78ms     | [S0,MB0,B]  197-39-236ms   | [S0,MB4,F]  236-19-256ms   | [S0,MB1,B]  256-39-295ms   | [S0,MB5,F]  295-19-315ms   | [S0,MB2,B]  315-39-354ms   | [S0,MB6,F]  354-19-374ms   | [S0,MB3,B]  374-39-414ms   | [S0,MB7,F]  414-19-433ms   | [S0,MB4,B]  433-39-473ms   | [S0,MB5,B]  492-39-532ms   | [S0,MB6,B]  552-39-591ms   | [S0,MB7,B]  611-39-650ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  19-19-39ms     | [S1,MB1,F]  39-19-59ms     | [S1,MB2,F]  59-19-78ms     | [S1,MB0,B]  157-39-197ms   | [S1,MB3,F]  197-19-216ms   | [S1,MB1,B]  216-39-256ms   | [S1,MB4,F]  256-19-276ms   | [S1,MB2,B]  276-39-315ms   | [S1,MB5,F]  315-19-335ms   | [S1,MB3,B]  335-39-374ms   | [S1,MB6,F]  374-19-394ms   | [S1,MB4,B]  394-39-433ms   | [S1,MB7,F]  433-19-453ms   | [S1,MB5,B]  453-39-492ms   | [S1,MB6,B]  512-39-552ms   | [S1,MB7,B]  571-39-611ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  39-19-59ms     | [S2,MB1,F]  59-19-78ms     | [S2,MB0,B]  118-39-157ms   | [S2,MB2,F]  157-19-177ms   | [S2,MB1,B]  177-39-216ms   | [S2,MB3,F]  216-19-236ms   | [S2,MB2,B]  236-39-276ms   | [S2,MB4,F]  276-19-295ms   | [S2,MB3,B]  295-39-335ms   | [S2,MB5,F]  335-19-354ms   | [S2,MB4,B]  354-39-394ms   | [S2,MB6,F]  394-19-414ms   | [S2,MB5,B]  414-39-453ms   | [S2,MB7,F]  453-19-473ms   | [S2,MB6,B]  473-39-512ms   | [S2,MB7,B]  532-39-571ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  59-19-78ms     | [S3,MB0,B]  78-39-118ms    | [S3,MB1,F]  118-19-138ms   | [S3,MB1,B]  138-39-177ms   | [S3,MB2,F]  177-19-197ms   | [S3,MB2,B]  197-39-236ms   | [S3,MB3,F]  236-19-256ms   | [S3,MB3,B]  256-39-295ms   | [S3,MB4,F]  295-19-315ms   | [S3,MB4,B]  315-39-354ms   | [S3,MB5,F]  354-19-374ms   | [S3,MB5,B]  374-39-414ms   | [S3,MB6,F]  414-19-433ms   | [S3,MB6,B]  433-39-473ms   | [S3,MB7,F]  473-19-492ms   | [S3,MB7,B]  492-39-532ms  
[rank3]:2025-12-31 00:22:14,288 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_1F1B_apf_22_dm1/frozen_ratio_history/rank3/251231_0022_stage3_final800.svg
[rank3]:2025-12-31 00:22:14,423 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_1F1B_apf_22_dm1/frozen_params_histogram/251231_0022_rank3_stage3.svg
[rank3]:	> Counts Sum: 1435, Total Sum: 2175 (65.98%), Ratio(%) per element: [85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 28.0, 6.66, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 10.66, 1.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 30.66, 44.0, 0.0, 0.0]
[rank3]:2025-12-31 00:22:14,424 - Destroying the purge thread.
[rank1]:2025-12-31 00:22:14,483 - Process group destroyed
[rank2]:2025-12-31 00:22:14,483 - Process group destroyed
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading history steps 15-16, summary, console lines 355-375
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–â–‚â–‚â–â–â–â–â–â–‚â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–ˆâ–‡â–„â–‚â–„â–ƒâ–‚â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–ˆâ–‡â–„â–‚â–„â–ƒâ–‚â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 3.97403
[rank3]:wandb:               final/avg_loss 0.29644
[rank3]:wandb:             final/avg_mfu(%) 18.95719
[rank3]:wandb:             final/avg_tflops 64.45982
[rank3]:wandb:    final/avg_throughput(tps) 8245.53763
[rank3]:wandb:              final/grad_norm 0.2187
[rank3]:wandb:               final/max_loss 0.29644
[rank3]:wandb:                    grad_norm 0.2187
[rank3]:wandb: loss_metrics/global_avg_loss 0.29644
[rank3]:wandb: loss_metrics/global_max_loss 0.29644
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1230_1F1B_apf_22_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/3ent4bsr
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1230_1F1B_apf_22_dm1/20251230-2325/wandb/run-20251230_232552-3ent4bsr/logs
[rank3]:2025-12-31 00:22:15,985 - Process group destroyed
[rank0]:2025-12-31 00:22:16,160 - Training completed
[rank0]:2025-12-31 00:22:16,161 - Destroying the purge thread.
[rank0]:2025-12-31 00:22:16,603 - Process group destroyed
[rank0]:Stage 0: Modules to keep: {'tok_embeddings', 'layers.1', 'layers.2', 'layers.3', 'layers.0'}
[rank2]:Stage 2: Modules to keep: {'layers.12', 'layers.10', 'layers.9', 'layers.11'}
[rank1]:Stage 1: Modules to keep: {'layers.4', 'layers.5', 'layers.8', 'layers.6', 'layers.7'}
[rank3]:Stage 3: Modules to keep: {'norm', 'layers.15', 'layers.13', 'layers.14', 'output'}
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1230.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:1227: everything same as 1224 but seed=42->11
[rank3]:1230: everything same as 1224 but seed=42->22
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1230_1F1B_apf_22_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1230_1F1B_apf_22_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1230_1F1B_apf_22_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1230_1F1B_apf_22_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1230_1F1B_apf_22_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1230_1F1B_apf_22_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 22
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: 1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 4
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1230_1F1B_apf_22_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1230_1F1B_apf_22_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: apf
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.01
[rank3]:		- percentile: 80
[rank3]:
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
