
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 12. 28. (ì¼) 17:55:34 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 3,4,5,6
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/1227_GPipe_nofreeze_11.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
1227: everything same as 1224 but seed=42->11

âœ”ï¸Running with nofreeze x GPipe ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1227.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
1227: everything same as 1224 but seed=42->11
" --parallelism.pipeline_parallel_degree=4  --freezing.no-freeze
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank2]:2025-12-28 17:55:40,796 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank2]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank2]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank2]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank2]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank2]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank2]:1227: everything same as 1224 but seed=42->11
[rank2]:"
[rank3]:2025-12-28 17:55:40,795 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:1227: everything same as 1224 but seed=42->11
[rank3]:"
[rank0]:2025-12-28 17:55:40,961 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank0]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank0]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank0]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank0]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank0]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank0]:1227: everything same as 1224 but seed=42->11
[rank0]:"
[rank2]:2025-12-28 17:55:41,010 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-12-28 17:55:41,005 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-12-28 17:55:41,012 - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-12-28 17:55:41,008 - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-12-28 17:55:41,009 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank1]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank1]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank1]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank1]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank1]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank1]:1227: everything same as 1224 but seed=42->11
[rank1]:"
[rank0]:2025-12-28 17:55:41,188 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-12-28 17:55:41,191 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-28 17:55:41,200 - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-12-28 17:55:41,201 - Loading tokenizer from tokenizer.json
[rank1]:2025-12-28 17:55:41,217 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-12-28 17:55:41,220 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-28 17:55:41,596 - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank0]:2025-12-28 17:55:44,309 - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank2]:2025-12-28 17:55:44,467 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-12-28 17:55:44,484 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-12-28 17:55:44,527 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-28 17:55:44,529 - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-12-28 17:55:44,556 - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-12-28 17:55:44,556 - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2025-12-28 17:55:44,567 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-12-28 17:55:44,510 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-28 17:55:44,538 - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-12-28 17:55:44,538 - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2025-12-28 17:55:44,608 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-28 17:55:44,635 - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-12-28 17:55:44,635 - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-12-28 17:55:44,751 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-28 17:55:44,751 - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-12-28 17:55:44,752 - CUDA memory usage for model: 1.90GiB(3.99%)
[rank2]:2025-12-28 17:55:44,722 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-28 17:55:44,722 - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-12-28 17:55:44,722 - CUDA memory usage for model: 0.92GiB(1.94%)
[rank1]:2025-12-28 17:55:44,824 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-28 17:55:44,824 - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-12-28 17:55:44,825 - CUDA memory usage for model: 1.13GiB(2.39%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run iilofkp3
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1227_GPipe_nofreeze_11_dm1/20251228-1755/wandb/run-20251228_175546-iilofkp3
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1227_GPipe_nofreeze_11_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/iilofkp3
[rank3]:2025-12-28 17:55:47,080 - WandB logging enabled
[rank3]:2025-12-28 17:55:47,081 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-12-28 17:55:47,118 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-28 17:55:47,146 - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-12-28 17:55:47,146 - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-12-28 17:55:47,345 - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1227_GPipe_nofreeze_11_dm1
[rank0]:2025-12-28 17:55:47,345 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-28 17:55:47,345 - Trainer is initialized with local batch size 16, global batch size 128, gradient accumulation steps 8, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2025-12-28 17:55:47,346 - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank1]:2025-12-28 17:55:47,344 - Mixed precision training with TP or PP is handled by autocast
[rank2]:2025-12-28 17:55:47,344 - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-12-28 17:55:47,328 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-28 17:55:47,329 - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-12-28 17:55:47,330 - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2025-12-28 17:55:47,344 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-28 17:55:49,958 - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-12-28 17:55:49,958 - Finished loading the checkpoint in 2.61 seconds.
[rank0]:2025-12-28 17:55:49,958 - Training starts at step 1
[rank1]:2025-12-28 17:55:55,488 -  step:  1  loss: -8.0000  grad_norm: 116.5366  memory: 12.75GiB(26.83%)  tps: 3,012  tflops: 23.54  mfu: 7.55%
[rank1]:2025-12-28 17:55:55,488 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-12-28 17:55:55,495 -  step:  1  loss: 10.6088  grad_norm: 116.5366  memory: 24.19GiB(50.91%)  tps: 3,913  tflops: 30.59  mfu: 9.80%
[rank3]:2025-12-28 17:55:55,496 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-12-28 17:55:55,486 -  step:  1  loss: -8.0000  grad_norm: 116.5366  memory: 10.24GiB(21.56%)  tps: 2,986  tflops: 23.34  mfu: 7.48%
[rank2]:2025-12-28 17:55:55,486 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-28 17:55:55,522 -  step:  1  loss: -8.0000  grad_norm: 116.5366  memory: 13.25GiB(27.89%)  tps: 2,981  tflops: 23.30  mfu: 7.47%
[rank0]:2025-12-28 17:55:55,522 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-12-28 17:57:54,827 - Avg. fwd time: 10.8145 / Avg. bwd time: 43.5636 / Avg. batch time: 494.8787 (ms) / GPU bubble ratio: 12.09%
[rank2]:2025-12-28 17:57:54,852 - Avg. fwd time: 6.9885 / Avg. bwd time: 19.3036 / Avg. batch time: 527.0329 (ms) / GPU bubble ratio: 60.09%
[rank1]:2025-12-28 17:57:54,882 - Avg. fwd time: 9.0776 / Avg. bwd time: 24.8997 / Avg. batch time: 567.2674 (ms) / GPU bubble ratio: 52.08%
[rank0]:2025-12-28 17:57:54,912 - Avg. fwd time: 8.2373 / Avg. bwd time: 25.1504 / Avg. batch time: 606.2064 (ms) / GPU bubble ratio: 55.94%
[rank0]:2025-12-28 17:59:54,923 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-28 17:59:59,810 - Avg. fwd time: 10.8320 / Avg. bwd time: 43.7913 / Avg. batch time: 496.7296 (ms) / GPU bubble ratio: 12.03%
[rank1]:2025-12-28 17:59:59,865 - Avg. fwd time: 9.0837 / Avg. bwd time: 24.9444 / Avg. batch time: 568.4287 (ms) / GPU bubble ratio: 52.11%
[rank2]:2025-12-28 17:59:59,835 - Avg. fwd time: 6.9878 / Avg. bwd time: 19.3433 / Avg. batch time: 528.5239 (ms) / GPU bubble ratio: 60.14%
[rank0]:2025-12-28 17:59:59,895 - Avg. fwd time: 8.2423 / Avg. bwd time: 25.1926 / Avg. batch time: 607.0328 (ms) / GPU bubble ratio: 55.94%
[rank0]:2025-12-28 17:59:59,931 -  step: 50  loss: -8.0000  grad_norm: 12.7680  memory: 17.08GiB(35.95%)  tps: 6,569  tflops: 51.36  mfu: 16.46%
[rank1]:2025-12-28 17:59:59,920 -  step: 50  loss: -8.0000  grad_norm: 12.7680  memory: 15.15GiB(31.89%)  tps: 6,569  tflops: 51.35  mfu: 16.46%
[rank2]:2025-12-28 17:59:59,917 -  step: 50  loss: -8.0000  grad_norm: 12.7680  memory: 12.26GiB(25.80%)  tps: 6,569  tflops: 51.35  mfu: 16.46%
[rank3]:2025-12-28 17:59:59,929 -  step: 50  loss:  9.9109  grad_norm: 12.7680  memory: 26.98GiB(56.79%)  tps: 6,569  tflops: 51.35  mfu: 16.46%
[rank1]:2025-12-28 18:02:05,067 - Avg. fwd time: 9.0816 / Avg. bwd time: 24.9771 / Avg. batch time: 569.0496 (ms) / GPU bubble ratio: 52.12%
[rank2]:2025-12-28 18:02:05,036 - Avg. fwd time: 6.9831 / Avg. bwd time: 19.3719 / Avg. batch time: 529.2244 (ms) / GPU bubble ratio: 60.16%
[rank3]:2025-12-28 18:02:05,010 - Avg. fwd time: 10.8381 / Avg. bwd time: 43.8900 / Avg. batch time: 497.5319 (ms) / GPU bubble ratio: 12.00%
[rank0]:2025-12-28 18:02:05,097 - Avg. fwd time: 8.2521 / Avg. bwd time: 25.2147 / Avg. batch time: 607.5607 (ms) / GPU bubble ratio: 55.93%
[rank0]:2025-12-28 18:04:05,310 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-28 18:04:10,183 - Avg. fwd time: 10.8284 / Avg. bwd time: 43.9512 / Avg. batch time: 497.9209 (ms) / GPU bubble ratio: 11.99%
[rank2]:2025-12-28 18:04:10,209 - Avg. fwd time: 6.9769 / Avg. bwd time: 19.3812 / Avg. batch time: 529.5495 (ms) / GPU bubble ratio: 60.18%
[rank0]:2025-12-28 18:04:10,270 - Avg. fwd time: 8.2528 / Avg. bwd time: 25.2230 / Avg. batch time: 607.7622 (ms) / GPU bubble ratio: 55.94%
[rank0]:2025-12-28 18:04:10,307 -  step: 100  loss: -8.0000  grad_norm:  8.0929  memory: 17.08GiB(35.95%)  tps: 6,544  tflops: 51.16  mfu: 16.40%
[rank1]:2025-12-28 18:04:10,239 - Avg. fwd time: 9.0753 / Avg. bwd time: 24.9816 / Avg. batch time: 569.3062 (ms) / GPU bubble ratio: 52.14%
[rank1]:2025-12-28 18:04:10,295 -  step: 100  loss: -8.0000  grad_norm:  8.0929  memory: 15.15GiB(31.89%)  tps: 6,544  tflops: 51.16  mfu: 16.40%
[rank3]:2025-12-28 18:04:10,304 -  step: 100  loss:  8.2733  grad_norm:  8.0929  memory: 26.98GiB(56.79%)  tps: 6,544  tflops: 51.16  mfu: 16.40%
[rank2]:2025-12-28 18:04:10,291 -  step: 100  loss: -8.0000  grad_norm:  8.0929  memory: 12.26GiB(25.80%)  tps: 6,544  tflops: 51.16  mfu: 16.40%
[rank3]:2025-12-28 18:04:10,472 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_GPipe_nofreeze_11_dm1/pipeline_schedule/251228_1804_step100_rank3.svg
[rank3]:			> Batch Time: 606.83 ms, GPU Bubble Ratio: 55.66%, 55.06%, 65.17%, 27.54%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB4,F]  32-8-41ms      | [S0,MB5,F]  41-7-48ms      | [S0,MB6,F]  48-8-57ms      | [S0,MB7,F]  57-8-66ms      | [S0,MB0,B]  271-25-297ms   | [S0,MB1,B]  314-25-339ms   | [S0,MB2,B]  359-25-384ms   | [S0,MB3,B]  404-25-429ms   | [S0,MB4,B]  449-25-474ms   | [S0,MB5,B]  493-25-518ms   | [S0,MB6,B]  538-25-563ms   | [S0,MB7,B]  581-25-606ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-10-20ms      | [S1,MB1,F]  23-8-32ms      | [S1,MB2,F]  35-8-44ms      | [S1,MB3,F]  56-8-65ms      | [S1,MB4,F]  74-8-82ms      | [S1,MB5,F]  91-8-100ms     | [S1,MB6,F]  109-8-118ms    | [S1,MB7,F]  127-8-136ms    | [S1,MB0,B]  243-24-268ms   | [S1,MB1,B]  286-24-311ms   | [S1,MB2,B]  331-25-356ms   | [S1,MB3,B]  376-25-401ms   | [S1,MB4,B]  420-25-446ms   | [S1,MB5,B]  465-25-490ms   | [S1,MB6,B]  510-24-535ms   | [S1,MB7,B]  553-25-578ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-6-39ms      | [S2,MB2,F]  53-6-60ms      | [S2,MB3,F]  71-6-77ms      | [S2,MB4,F]  88-6-95ms      | [S2,MB5,F]  106-6-113ms    | [S2,MB6,F]  125-6-131ms    | [S2,MB7,F]  142-6-149ms    | [S2,MB0,B]  221-19-240ms   | [S2,MB1,B]  264-19-283ms   | [S2,MB2,B]  308-19-327ms   | [S2,MB3,B]  353-19-372ms   | [S2,MB4,B]  398-19-417ms   | [S2,MB5,B]  442-19-462ms   | [S2,MB6,B]  487-19-507ms   | [S2,MB7,B]  529-19-549ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  50-10-60ms     | [S3,MB2,F]  67-10-78ms     | [S3,MB3,F]  85-10-96ms     | [S3,MB4,F]  103-10-114ms   | [S3,MB5,F]  121-10-132ms   | [S3,MB6,F]  140-10-150ms   | [S3,MB7,F]  158-10-169ms   | [S3,MB0,B]  174-40-215ms   | [S3,MB1,B]  214-43-257ms   | [S3,MB2,B]  257-44-301ms   | [S3,MB3,B]  301-45-346ms   | [S3,MB4,B]  346-44-391ms   | [S3,MB5,B]  391-44-435ms   | [S3,MB6,B]  435-45-480ms   | [S3,MB7,B]  480-45-526ms  
[rank3]:2025-12-28 18:06:14,895 - Avg. fwd time: 10.8139 / Avg. bwd time: 43.9230 / Avg. batch time: 497.5570 (ms) / GPU bubble ratio: 11.99%
[rank0]:2025-12-28 18:06:14,984 - Avg. fwd time: 8.2519 / Avg. bwd time: 25.2285 / Avg. batch time: 607.4182 (ms) / GPU bubble ratio: 55.90%
[rank1]:2025-12-28 18:06:14,953 - Avg. fwd time: 9.0712 / Avg. bwd time: 24.9894 / Avg. batch time: 568.9957 (ms) / GPU bubble ratio: 52.11%
[rank2]:2025-12-28 18:06:14,922 - Avg. fwd time: 6.9715 / Avg. bwd time: 19.3917 / Avg. batch time: 529.2774 (ms) / GPU bubble ratio: 60.15%
[rank0]:2025-12-28 18:08:14,698 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-28 18:08:19,599 - Avg. fwd time: 10.8064 / Avg. bwd time: 43.9135 / Avg. batch time: 497.4063 (ms) / GPU bubble ratio: 11.99%
[rank2]:2025-12-28 18:08:19,624 - Avg. fwd time: 6.9674 / Avg. bwd time: 19.4010 / Avg. batch time: 529.0876 (ms) / GPU bubble ratio: 60.13%
[rank1]:2025-12-28 18:08:19,655 - Avg. fwd time: 9.0678 / Avg. bwd time: 24.9964 / Avg. batch time: 568.7771 (ms) / GPU bubble ratio: 52.09%
[rank3]:2025-12-28 18:08:19,720 -  step: 150  loss:  4.1209  grad_norm: 23.2683  memory: 26.98GiB(56.79%)  tps: 6,569  tflops: 51.35  mfu: 16.46%
[rank2]:2025-12-28 18:08:19,708 -  step: 150  loss: -8.0000  grad_norm: 23.2683  memory: 12.26GiB(25.80%)  tps: 6,569  tflops: 51.35  mfu: 16.46%
[rank0]:2025-12-28 18:08:19,686 - Avg. fwd time: 8.2521 / Avg. bwd time: 25.2349 / Avg. batch time: 607.1835 (ms) / GPU bubble ratio: 55.88%
[rank0]:2025-12-28 18:08:19,722 -  step: 150  loss: -8.0000  grad_norm: 23.2683  memory: 17.08GiB(35.95%)  tps: 6,569  tflops: 51.35  mfu: 16.46%
[rank1]:2025-12-28 18:08:19,711 -  step: 150  loss: -8.0000  grad_norm: 23.2683  memory: 15.15GiB(31.89%)  tps: 6,569  tflops: 51.35  mfu: 16.46%
[rank3]:2025-12-28 18:10:24,512 - Avg. fwd time: 10.8035 / Avg. bwd time: 43.9152 / Avg. batch time: 497.3885 (ms) / GPU bubble ratio: 11.99%
[rank2]:2025-12-28 18:10:24,539 - Avg. fwd time: 6.9643 / Avg. bwd time: 19.4143 / Avg. batch time: 529.0490 (ms) / GPU bubble ratio: 60.11%
[rank1]:2025-12-28 18:10:24,571 - Avg. fwd time: 9.0641 / Avg. bwd time: 25.0082 / Avg. batch time: 568.7330 (ms) / GPU bubble ratio: 52.07%
[rank0]:2025-12-28 18:10:24,602 - Avg. fwd time: 8.2537 / Avg. bwd time: 25.2479 / Avg. batch time: 607.1368 (ms) / GPU bubble ratio: 55.86%
[rank0]:2025-12-28 18:12:24,485 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-28 18:12:29,443 - Avg. fwd time: 10.7974 / Avg. bwd time: 43.9195 / Avg. batch time: 497.3671 (ms) / GPU bubble ratio: 11.99%
[rank2]:2025-12-28 18:12:29,470 - Avg. fwd time: 6.9614 / Avg. bwd time: 19.4348 / Avg. batch time: 529.0212 (ms) / GPU bubble ratio: 60.08%
[rank1]:2025-12-28 18:12:29,501 - Avg. fwd time: 9.0611 / Avg. bwd time: 25.0249 / Avg. batch time: 568.7142 (ms) / GPU bubble ratio: 52.05%
[rank3]:2025-12-28 18:12:29,568 -  step: 200  loss:  1.0167  grad_norm:  7.6471  memory: 26.98GiB(56.79%)  tps: 6,558  tflops: 51.26  mfu: 16.43%
[rank2]:2025-12-28 18:12:29,555 -  step: 200  loss: -8.0000  grad_norm:  7.6471  memory: 12.26GiB(25.80%)  tps: 6,558  tflops: 51.26  mfu: 16.43%
[rank1]:2025-12-28 18:12:29,559 -  step: 200  loss: -8.0000  grad_norm:  7.6471  memory: 15.15GiB(31.89%)  tps: 6,558  tflops: 51.27  mfu: 16.43%
[rank0]:2025-12-28 18:12:29,533 - Avg. fwd time: 8.2562 / Avg. bwd time: 25.2591 / Avg. batch time: 607.1192 (ms) / GPU bubble ratio: 55.84%
[rank0]:2025-12-28 18:12:29,570 -  step: 200  loss: -8.0000  grad_norm:  7.6471  memory: 17.08GiB(35.95%)  tps: 6,558  tflops: 51.26  mfu: 16.43%
[rank3]:2025-12-28 18:12:29,712 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_GPipe_nofreeze_11_dm1/pipeline_schedule/251228_1812_step200_rank3.svg
[rank3]:			> Batch Time: 607.88 ms, GPU Bubble Ratio: 55.65%, 54.93%, 64.99%, 27.91%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB4,F]  32-8-41ms      | [S0,MB5,F]  41-7-48ms      | [S0,MB6,F]  48-8-57ms      | [S0,MB7,F]  57-8-66ms      | [S0,MB0,B]  272-25-298ms   | [S0,MB1,B]  315-25-341ms   | [S0,MB2,B]  360-25-386ms   | [S0,MB3,B]  405-25-430ms   | [S0,MB4,B]  449-25-474ms   | [S0,MB5,B]  494-25-520ms   | [S0,MB6,B]  541-25-566ms   | [S0,MB7,B]  582-25-607ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-10-20ms      | [S1,MB1,F]  23-8-32ms      | [S1,MB2,F]  35-8-44ms      | [S1,MB3,F]  56-8-65ms      | [S1,MB4,F]  74-8-83ms      | [S1,MB5,F]  92-8-100ms     | [S1,MB6,F]  109-8-118ms    | [S1,MB7,F]  128-8-136ms    | [S1,MB0,B]  244-25-269ms   | [S1,MB1,B]  287-25-312ms   | [S1,MB2,B]  332-25-357ms   | [S1,MB3,B]  376-25-402ms   | [S1,MB4,B]  420-25-446ms   | [S1,MB5,B]  466-25-491ms   | [S1,MB6,B]  512-25-537ms   | [S1,MB7,B]  553-25-579ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-6-39ms      | [S2,MB2,F]  53-6-60ms      | [S2,MB3,F]  71-6-77ms      | [S2,MB4,F]  88-6-95ms      | [S2,MB5,F]  106-6-113ms    | [S2,MB6,F]  125-6-131ms    | [S2,MB7,F]  143-6-149ms    | [S2,MB0,B]  221-19-241ms   | [S2,MB1,B]  264-19-284ms   | [S2,MB2,B]  309-19-328ms   | [S2,MB3,B]  353-19-373ms   | [S2,MB4,B]  397-19-417ms   | [S2,MB5,B]  443-19-462ms   | [S2,MB6,B]  489-19-509ms   | [S2,MB7,B]  530-19-550ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  50-10-60ms     | [S3,MB2,F]  67-10-78ms     | [S3,MB3,F]  85-10-96ms     | [S3,MB4,F]  103-10-114ms   | [S3,MB5,F]  121-10-132ms   | [S3,MB6,F]  140-10-150ms   | [S3,MB7,F]  158-10-168ms   | [S3,MB0,B]  174-40-215ms   | [S3,MB1,B]  215-42-257ms   | [S3,MB2,B]  257-44-301ms   | [S3,MB3,B]  302-44-346ms   | [S3,MB4,B]  346-44-391ms   | [S3,MB5,B]  391-44-435ms   | [S3,MB6,B]  436-45-482ms   | [S3,MB7,B]  482-45-528ms  
[rank3]:2025-12-28 18:14:34,276 - Avg. fwd time: 10.7901 / Avg. bwd time: 43.9042 / Avg. batch time: 497.1800 (ms) / GPU bubble ratio: 11.99%
[rank2]:2025-12-28 18:14:34,304 - Avg. fwd time: 6.9590 / Avg. bwd time: 19.4561 / Avg. batch time: 528.8985 (ms) / GPU bubble ratio: 60.05%
[rank1]:2025-12-28 18:14:34,336 - Avg. fwd time: 9.0582 / Avg. bwd time: 25.0408 / Avg. batch time: 568.6000 (ms) / GPU bubble ratio: 52.02%
[rank0]:2025-12-28 18:14:34,368 - Avg. fwd time: 8.2564 / Avg. bwd time: 25.2680 / Avg. batch time: 607.0079 (ms) / GPU bubble ratio: 55.82%
[rank0]:2025-12-28 18:16:33,986 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-28 18:16:38,863 - Avg. fwd time: 10.7826 / Avg. bwd time: 43.8880 / Avg. batch time: 496.9821 (ms) / GPU bubble ratio: 12.00%
[rank1]:2025-12-28 18:16:38,923 - Avg. fwd time: 9.0542 / Avg. bwd time: 25.0541 / Avg. batch time: 568.4060 (ms) / GPU bubble ratio: 51.99%
[rank2]:2025-12-28 18:16:38,891 - Avg. fwd time: 6.9565 / Avg. bwd time: 19.4722 / Avg. batch time: 528.6940 (ms) / GPU bubble ratio: 60.01%
[rank0]:2025-12-28 18:16:38,956 - Avg. fwd time: 8.2560 / Avg. bwd time: 25.2738 / Avg. batch time: 606.8132 (ms) / GPU bubble ratio: 55.80%
[rank0]:2025-12-28 18:16:38,992 -  step: 250  loss: -8.0000  grad_norm:  1.6743  memory: 17.08GiB(35.95%)  tps: 6,569  tflops: 51.35  mfu: 16.46%
[rank3]:2025-12-28 18:16:38,990 -  step: 250  loss:  0.3646  grad_norm:  1.6743  memory: 26.98GiB(56.79%)  tps: 6,569  tflops: 51.35  mfu: 16.46%
[rank1]:2025-12-28 18:16:38,981 -  step: 250  loss: -8.0000  grad_norm:  1.6743  memory: 15.15GiB(31.89%)  tps: 6,569  tflops: 51.35  mfu: 16.46%
[rank2]:2025-12-28 18:16:38,978 -  step: 250  loss: -8.0000  grad_norm:  1.6743  memory: 12.26GiB(25.80%)  tps: 6,569  tflops: 51.35  mfu: 16.46%
[rank3]:2025-12-28 18:18:43,254 - Avg. fwd time: 10.7746 / Avg. bwd time: 43.8689 / Avg. batch time: 496.7586 (ms) / GPU bubble ratio: 12.00%
[rank2]:2025-12-28 18:18:43,283 - Avg. fwd time: 6.9538 / Avg. bwd time: 19.4840 / Avg. batch time: 528.4646 (ms) / GPU bubble ratio: 59.98%
[rank0]:2025-12-28 18:18:43,348 - Avg. fwd time: 8.2531 / Avg. bwd time: 25.2779 / Avg. batch time: 606.5798 (ms) / GPU bubble ratio: 55.78%
[rank1]:2025-12-28 18:18:43,315 - Avg. fwd time: 9.0504 / Avg. bwd time: 25.0631 / Avg. batch time: 568.1770 (ms) / GPU bubble ratio: 51.97%
[rank0]:2025-12-28 18:20:42,872 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-28 18:20:47,764 - Avg. fwd time: 10.7691 / Avg. bwd time: 43.8587 / Avg. batch time: 496.6285 (ms) / GPU bubble ratio: 12.00%
[rank2]:2025-12-28 18:20:47,792 - Avg. fwd time: 6.9514 / Avg. bwd time: 19.4933 / Avg. batch time: 528.3288 (ms) / GPU bubble ratio: 59.96%
[rank1]:2025-12-28 18:20:47,825 - Avg. fwd time: 9.0471 / Avg. bwd time: 25.0705 / Avg. batch time: 568.0453 (ms) / GPU bubble ratio: 51.95%
[rank0]:2025-12-28 18:20:47,857 - Avg. fwd time: 8.2504 / Avg. bwd time: 25.2805 / Avg. batch time: 606.4425 (ms) / GPU bubble ratio: 55.77%
[rank0]:2025-12-28 18:20:47,893 -  step: 300  loss: -8.0000  grad_norm:  0.3358  memory: 17.08GiB(35.95%)  tps: 6,583  tflops: 51.46  mfu: 16.49%
[rank3]:2025-12-28 18:20:47,891 -  step: 300  loss:  0.2601  grad_norm:  0.3358  memory: 26.98GiB(56.79%)  tps: 6,583  tflops: 51.46  mfu: 16.49%
[rank2]:2025-12-28 18:20:47,879 -  step: 300  loss: -8.0000  grad_norm:  0.3358  memory: 12.26GiB(25.80%)  tps: 6,583  tflops: 51.46  mfu: 16.49%
[rank1]:2025-12-28 18:20:47,882 -  step: 300  loss: -8.0000  grad_norm:  0.3358  memory: 15.15GiB(31.89%)  tps: 6,583  tflops: 51.46  mfu: 16.49%
[rank3]:2025-12-28 18:20:48,040 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_GPipe_nofreeze_11_dm1/pipeline_schedule/251228_1820_step300_rank3.svg
[rank3]:			> Batch Time: 604.34 ms, GPU Bubble Ratio: 55.50%, 54.72%, 64.80%, 28.12%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB4,F]  32-8-40ms      | [S0,MB5,F]  40-7-48ms      | [S0,MB6,F]  48-8-57ms      | [S0,MB7,F]  57-8-65ms      | [S0,MB0,B]  271-25-297ms   | [S0,MB1,B]  314-25-339ms   | [S0,MB2,B]  358-25-384ms   | [S0,MB3,B]  402-25-428ms   | [S0,MB4,B]  447-25-472ms   | [S0,MB5,B]  491-25-516ms   | [S0,MB6,B]  536-25-561ms   | [S0,MB7,B]  579-25-604ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-10-20ms      | [S1,MB1,F]  23-8-32ms      | [S1,MB2,F]  35-8-44ms      | [S1,MB3,F]  56-8-65ms      | [S1,MB4,F]  74-8-82ms      | [S1,MB5,F]  91-8-100ms     | [S1,MB6,F]  109-8-118ms    | [S1,MB7,F]  127-8-136ms    | [S1,MB0,B]  243-25-268ms   | [S1,MB1,B]  286-25-311ms   | [S1,MB2,B]  330-25-355ms   | [S1,MB3,B]  373-25-399ms   | [S1,MB4,B]  418-25-444ms   | [S1,MB5,B]  463-25-488ms   | [S1,MB6,B]  508-25-533ms   | [S1,MB7,B]  550-25-575ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-6-39ms      | [S2,MB2,F]  53-6-60ms      | [S2,MB3,F]  70-6-77ms      | [S2,MB4,F]  88-6-95ms      | [S2,MB5,F]  106-6-113ms    | [S2,MB6,F]  124-6-131ms    | [S2,MB7,F]  142-6-149ms    | [S2,MB0,B]  220-19-240ms   | [S2,MB1,B]  263-19-282ms   | [S2,MB2,B]  307-19-327ms   | [S2,MB3,B]  351-19-370ms   | [S2,MB4,B]  395-19-415ms   | [S2,MB5,B]  440-19-459ms   | [S2,MB6,B]  485-19-505ms   | [S2,MB7,B]  527-19-546ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  50-10-60ms     | [S3,MB2,F]  67-10-77ms     | [S3,MB3,F]  85-10-95ms     | [S3,MB4,F]  103-10-113ms   | [S3,MB5,F]  121-10-131ms   | [S3,MB6,F]  139-10-149ms   | [S3,MB7,F]  157-10-167ms   | [S3,MB0,B]  173-40-214ms   | [S3,MB1,B]  213-42-255ms   | [S3,MB2,B]  256-43-300ms   | [S3,MB3,B]  300-44-344ms   | [S3,MB4,B]  344-44-388ms   | [S3,MB5,B]  388-44-433ms   | [S3,MB6,B]  433-44-478ms   | [S3,MB7,B]  478-45-523ms  
[rank3]:2025-12-28 18:22:52,411 - Avg. fwd time: 10.7646 / Avg. bwd time: 43.8510 / Avg. batch time: 496.5262 (ms) / GPU bubble ratio: 12.00%
[rank2]:2025-12-28 18:22:52,440 - Avg. fwd time: 6.9495 / Avg. bwd time: 19.5007 / Avg. batch time: 528.2633 (ms) / GPU bubble ratio: 59.94%
[rank1]:2025-12-28 18:22:52,472 - Avg. fwd time: 9.0448 / Avg. bwd time: 25.0763 / Avg. batch time: 567.9814 (ms) / GPU bubble ratio: 51.94%
[rank0]:2025-12-28 18:22:52,505 - Avg. fwd time: 8.2481 / Avg. bwd time: 25.2824 / Avg. batch time: 606.3729 (ms) / GPU bubble ratio: 55.76%
[rank0]:2025-12-28 18:24:51,904 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-28 18:24:56,806 - Avg. fwd time: 10.7607 / Avg. bwd time: 43.8362 / Avg. batch time: 496.3710 (ms) / GPU bubble ratio: 12.01%
[rank2]:2025-12-28 18:24:56,834 - Avg. fwd time: 6.9482 / Avg. bwd time: 19.5052 / Avg. batch time: 528.0992 (ms) / GPU bubble ratio: 59.93%
[rank1]:2025-12-28 18:24:56,868 - Avg. fwd time: 9.0433 / Avg. bwd time: 25.0808 / Avg. batch time: 567.8221 (ms) / GPU bubble ratio: 51.92%
[rank0]:2025-12-28 18:24:56,901 - Avg. fwd time: 8.2467 / Avg. bwd time: 25.2837 / Avg. batch time: 606.2096 (ms) / GPU bubble ratio: 55.75%
[rank0]:2025-12-28 18:24:56,937 -  step: 350  loss: -8.0000  grad_norm:  0.1447  memory: 17.08GiB(35.95%)  tps: 6,579  tflops: 51.43  mfu: 16.48%
[rank3]:2025-12-28 18:24:56,935 -  step: 350  loss:  0.2154  grad_norm:  0.1447  memory: 26.98GiB(56.79%)  tps: 6,579  tflops: 51.43  mfu: 16.48%
[rank2]:2025-12-28 18:24:56,922 -  step: 350  loss: -8.0000  grad_norm:  0.1447  memory: 12.26GiB(25.80%)  tps: 6,579  tflops: 51.43  mfu: 16.48%
[rank1]:2025-12-28 18:24:56,926 -  step: 350  loss: -8.0000  grad_norm:  0.1447  memory: 15.15GiB(31.89%)  tps: 6,579  tflops: 51.43  mfu: 16.48%
[rank3]:2025-12-28 18:27:01,290 - Avg. fwd time: 10.7564 / Avg. bwd time: 43.8291 / Avg. batch time: 496.2759 (ms) / GPU bubble ratio: 12.01%
[rank2]:2025-12-28 18:27:01,319 - Avg. fwd time: 6.9470 / Avg. bwd time: 19.5082 / Avg. batch time: 527.9963 (ms) / GPU bubble ratio: 59.92%
[rank0]:2025-12-28 18:27:01,386 - Avg. fwd time: 8.2446 / Avg. bwd time: 25.2842 / Avg. batch time: 606.1028 (ms) / GPU bubble ratio: 55.75%
[rank1]:2025-12-28 18:27:01,352 - Avg. fwd time: 9.0415 / Avg. bwd time: 25.0827 / Avg. batch time: 567.7212 (ms) / GPU bubble ratio: 51.91%
[rank0]:2025-12-28 18:29:00,470 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-28 18:29:05,403 - Avg. fwd time: 6.9460 / Avg. bwd time: 19.5112 / Avg. batch time: 527.7952 (ms) / GPU bubble ratio: 59.90%
[rank3]:2025-12-28 18:29:05,374 - Avg. fwd time: 10.7527 / Avg. bwd time: 43.8091 / Avg. batch time: 496.0813 (ms) / GPU bubble ratio: 12.01%
[rank1]:2025-12-28 18:29:05,437 - Avg. fwd time: 9.0403 / Avg. bwd time: 25.0855 / Avg. batch time: 567.5182 (ms) / GPU bubble ratio: 51.89%
[rank1]:2025-12-28 18:29:05,495 -  step: 400  loss: -8.0000  grad_norm:  0.1295  memory: 15.15GiB(31.89%)  tps: 6,591  tflops: 51.53  mfu: 16.52%
[rank2]:2025-12-28 18:29:05,492 -  step: 400  loss: -8.0000  grad_norm:  0.1295  memory: 12.26GiB(25.80%)  tps: 6,591  tflops: 51.53  mfu: 16.52%
[rank0]:2025-12-28 18:29:05,470 - Avg. fwd time: 8.2429 / Avg. bwd time: 25.2844 / Avg. batch time: 605.8966 (ms) / GPU bubble ratio: 55.73%
[rank0]:2025-12-28 18:29:05,507 -  step: 400  loss: -8.0000  grad_norm:  0.1295  memory: 17.08GiB(35.95%)  tps: 6,591  tflops: 51.53  mfu: 16.52%
[rank3]:2025-12-28 18:29:05,504 -  step: 400  loss:  0.2068  grad_norm:  0.1295  memory: 26.98GiB(56.79%)  tps: 6,591  tflops: 51.53  mfu: 16.52%
[rank3]:2025-12-28 18:29:05,648 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_GPipe_nofreeze_11_dm1/pipeline_schedule/251228_1829_step400_rank3.svg
[rank3]:			> Batch Time: 603.31 ms, GPU Bubble Ratio: 55.50%, 54.71%, 64.87%, 27.94%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB4,F]  32-8-40ms      | [S0,MB5,F]  40-7-48ms      | [S0,MB6,F]  48-8-56ms      | [S0,MB7,F]  56-8-65ms      | [S0,MB0,B]  272-25-297ms   | [S0,MB1,B]  314-25-339ms   | [S0,MB2,B]  358-25-383ms   | [S0,MB3,B]  402-25-428ms   | [S0,MB4,B]  446-25-471ms   | [S0,MB5,B]  491-25-516ms   | [S0,MB6,B]  536-25-561ms   | [S0,MB7,B]  578-25-603ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-10-20ms      | [S1,MB1,F]  23-8-32ms      | [S1,MB2,F]  35-8-44ms      | [S1,MB3,F]  56-8-65ms      | [S1,MB4,F]  74-8-82ms      | [S1,MB5,F]  91-8-100ms     | [S1,MB6,F]  109-8-118ms    | [S1,MB7,F]  127-8-136ms    | [S1,MB0,B]  243-24-268ms   | [S1,MB1,B]  286-24-311ms   | [S1,MB2,B]  329-25-355ms   | [S1,MB3,B]  374-25-399ms   | [S1,MB4,B]  418-25-443ms   | [S1,MB5,B]  462-25-487ms   | [S1,MB6,B]  507-25-532ms   | [S1,MB7,B]  549-25-574ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-6-39ms      | [S2,MB2,F]  53-6-59ms      | [S2,MB3,F]  70-6-77ms      | [S2,MB4,F]  88-6-95ms      | [S2,MB5,F]  106-6-113ms    | [S2,MB6,F]  124-6-131ms    | [S2,MB7,F]  142-6-149ms    | [S2,MB0,B]  221-19-240ms   | [S2,MB1,B]  263-19-282ms   | [S2,MB2,B]  306-19-326ms   | [S2,MB3,B]  351-19-371ms   | [S2,MB4,B]  395-19-414ms   | [S2,MB5,B]  439-19-459ms   | [S2,MB6,B]  484-19-504ms   | [S2,MB7,B]  526-19-545ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  50-10-60ms     | [S3,MB2,F]  67-10-77ms     | [S3,MB3,F]  85-10-95ms     | [S3,MB4,F]  103-10-113ms   | [S3,MB5,F]  121-10-131ms   | [S3,MB6,F]  139-10-150ms   | [S3,MB7,F]  157-10-168ms   | [S3,MB0,B]  174-40-214ms   | [S3,MB1,B]  214-42-257ms   | [S3,MB2,B]  256-43-300ms   | [S3,MB3,B]  300-44-344ms   | [S3,MB4,B]  344-44-388ms   | [S3,MB5,B]  388-44-432ms   | [S3,MB6,B]  432-44-477ms   | [S3,MB7,B]  477-45-523ms  
[rank3]:2025-12-28 18:29:33,898 - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-12-28 18:29:34,132 - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-12-28 18:29:34,105 - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-12-28 18:29:34,160 - Dataset alpaca_gpt4 is being re-looped
[rank3]:2025-12-28 18:31:09,747 - Avg. fwd time: 10.7494 / Avg. bwd time: 43.7998 / Avg. batch time: 495.9788 (ms) / GPU bubble ratio: 12.01%
[rank1]:2025-12-28 18:31:09,810 - Avg. fwd time: 9.0384 / Avg. bwd time: 25.0869 / Avg. batch time: 567.4385 (ms) / GPU bubble ratio: 51.89%
[rank2]:2025-12-28 18:31:09,776 - Avg. fwd time: 6.9449 / Avg. bwd time: 19.5127 / Avg. batch time: 527.7164 (ms) / GPU bubble ratio: 59.89%
[rank0]:2025-12-28 18:31:09,845 - Avg. fwd time: 8.2417 / Avg. bwd time: 25.2841 / Avg. batch time: 605.8126 (ms) / GPU bubble ratio: 55.73%
[rank0]:2025-12-28 18:33:09,291 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-28 18:33:14,126 - Avg. fwd time: 10.7458 / Avg. bwd time: 43.7957 / Avg. batch time: 495.9135 (ms) / GPU bubble ratio: 12.01%
[rank2]:2025-12-28 18:33:14,156 - Avg. fwd time: 6.9439 / Avg. bwd time: 19.5144 / Avg. batch time: 527.6430 (ms) / GPU bubble ratio: 59.88%
[rank1]:2025-12-28 18:33:14,190 - Avg. fwd time: 9.0365 / Avg. bwd time: 25.0878 / Avg. batch time: 567.3663 (ms) / GPU bubble ratio: 51.88%
[rank0]:2025-12-28 18:33:14,225 - Avg. fwd time: 8.2399 / Avg. bwd time: 25.2837 / Avg. batch time: 605.7360 (ms) / GPU bubble ratio: 55.73%
[rank0]:2025-12-28 18:33:14,261 -  step: 450  loss: -8.0000  grad_norm:  0.1455  memory: 17.08GiB(35.95%)  tps: 6,586  tflops: 51.49  mfu: 16.50%
[rank3]:2025-12-28 18:33:14,260 -  step: 450  loss:  0.2218  grad_norm:  0.1455  memory: 26.98GiB(56.79%)  tps: 6,586  tflops: 51.49  mfu: 16.50%
[rank2]:2025-12-28 18:33:14,246 -  step: 450  loss: -8.0000  grad_norm:  0.1455  memory: 12.26GiB(25.80%)  tps: 6,586  tflops: 51.49  mfu: 16.50%
[rank1]:2025-12-28 18:33:14,250 -  step: 450  loss: -8.0000  grad_norm:  0.1455  memory: 15.15GiB(31.89%)  tps: 6,586  tflops: 51.49  mfu: 16.50%
[rank3]:2025-12-28 18:35:18,034 - Avg. fwd time: 10.7423 / Avg. bwd time: 43.7744 / Avg. batch time: 495.7130 (ms) / GPU bubble ratio: 12.02%
[rank2]:2025-12-28 18:35:18,064 - Avg. fwd time: 6.9429 / Avg. bwd time: 19.5153 / Avg. batch time: 527.4343 (ms) / GPU bubble ratio: 59.87%
[rank1]:2025-12-28 18:35:18,099 - Avg. fwd time: 9.0348 / Avg. bwd time: 25.0889 / Avg. batch time: 567.1557 (ms) / GPU bubble ratio: 51.87%
[rank0]:2025-12-28 18:35:18,133 - Avg. fwd time: 8.2387 / Avg. bwd time: 25.2841 / Avg. batch time: 605.5236 (ms) / GPU bubble ratio: 55.71%
[rank0]:2025-12-28 18:37:17,306 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-28 18:37:22,163 - Avg. fwd time: 10.7400 / Avg. bwd time: 43.7620 / Avg. batch time: 495.5940 (ms) / GPU bubble ratio: 12.02%
[rank1]:2025-12-28 18:37:22,228 - Avg. fwd time: 9.0336 / Avg. bwd time: 25.0901 / Avg. batch time: 567.0292 (ms) / GPU bubble ratio: 51.86%
[rank2]:2025-12-28 18:37:22,193 - Avg. fwd time: 6.9420 / Avg. bwd time: 19.5154 / Avg. batch time: 527.3079 (ms) / GPU bubble ratio: 59.86%
[rank0]:2025-12-28 18:37:22,263 - Avg. fwd time: 8.2377 / Avg. bwd time: 25.2843 / Avg. batch time: 605.3949 (ms) / GPU bubble ratio: 55.70%
[rank3]:2025-12-28 18:37:22,297 -  step: 500  loss:  0.2133  grad_norm:  0.1292  memory: 26.98GiB(56.79%)  tps: 6,606  tflops: 51.64  mfu: 16.55%
[rank1]:2025-12-28 18:37:22,288 -  step: 500  loss: -8.0000  grad_norm:  0.1292  memory: 15.15GiB(31.89%)  tps: 6,605  tflops: 51.64  mfu: 16.55%
[rank2]:2025-12-28 18:37:22,285 -  step: 500  loss: -8.0000  grad_norm:  0.1292  memory: 12.26GiB(25.80%)  tps: 6,605  tflops: 51.64  mfu: 16.55%
[rank0]:2025-12-28 18:37:22,299 -  step: 500  loss: -8.0000  grad_norm:  0.1292  memory: 17.08GiB(35.95%)  tps: 6,605  tflops: 51.64  mfu: 16.55%
[rank3]:2025-12-28 18:37:22,440 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_GPipe_nofreeze_11_dm1/pipeline_schedule/251228_1837_step500_rank3.svg
[rank3]:			> Batch Time: 602.34 ms, GPU Bubble Ratio: 55.36%, 54.63%, 64.80%, 28.05%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB4,F]  32-8-40ms      | [S0,MB5,F]  40-7-48ms      | [S0,MB6,F]  48-8-57ms      | [S0,MB7,F]  57-8-65ms      | [S0,MB0,B]  272-25-297ms   | [S0,MB1,B]  314-25-339ms   | [S0,MB2,B]  357-25-382ms   | [S0,MB3,B]  401-25-426ms   | [S0,MB4,B]  446-25-471ms   | [S0,MB5,B]  491-25-516ms   | [S0,MB6,B]  536-25-561ms   | [S0,MB7,B]  577-25-602ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-10-20ms      | [S1,MB1,F]  23-8-32ms      | [S1,MB2,F]  35-8-44ms      | [S1,MB3,F]  56-8-65ms      | [S1,MB4,F]  74-8-82ms      | [S1,MB5,F]  91-8-100ms     | [S1,MB6,F]  109-8-118ms    | [S1,MB7,F]  127-8-136ms    | [S1,MB0,B]  243-24-268ms   | [S1,MB1,B]  286-24-311ms   | [S1,MB2,B]  329-25-354ms   | [S1,MB3,B]  372-25-398ms   | [S1,MB4,B]  417-25-443ms   | [S1,MB5,B]  463-25-488ms   | [S1,MB6,B]  507-25-533ms   | [S1,MB7,B]  548-25-573ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-6-39ms      | [S2,MB2,F]  53-6-59ms      | [S2,MB3,F]  70-6-77ms      | [S2,MB4,F]  88-6-95ms      | [S2,MB5,F]  106-6-113ms    | [S2,MB6,F]  124-6-131ms    | [S2,MB7,F]  142-6-149ms    | [S2,MB0,B]  220-19-240ms   | [S2,MB1,B]  263-19-283ms   | [S2,MB2,B]  306-19-326ms   | [S2,MB3,B]  349-19-369ms   | [S2,MB4,B]  394-19-414ms   | [S2,MB5,B]  440-19-459ms   | [S2,MB6,B]  485-19-504ms   | [S2,MB7,B]  525-19-545ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  50-10-60ms     | [S3,MB2,F]  67-10-77ms     | [S3,MB3,F]  85-10-95ms     | [S3,MB4,F]  103-10-113ms   | [S3,MB5,F]  121-10-131ms   | [S3,MB6,F]  139-10-150ms   | [S3,MB7,F]  157-10-168ms   | [S3,MB0,B]  174-40-214ms   | [S3,MB1,B]  214-42-256ms   | [S3,MB2,B]  257-43-300ms   | [S3,MB3,B]  300-43-343ms   | [S3,MB4,B]  343-44-387ms   | [S3,MB5,B]  387-44-432ms   | [S3,MB6,B]  433-44-477ms   | [S3,MB7,B]  478-44-522ms  
[rank3]:2025-12-28 18:39:26,414 - Avg. fwd time: 10.7375 / Avg. bwd time: 43.7505 / Avg. batch time: 495.4818 (ms) / GPU bubble ratio: 12.02%
[rank2]:2025-12-28 18:39:26,444 - Avg. fwd time: 6.9414 / Avg. bwd time: 19.5158 / Avg. batch time: 527.2153 (ms) / GPU bubble ratio: 59.85%
[rank1]:2025-12-28 18:39:26,480 - Avg. fwd time: 9.0326 / Avg. bwd time: 25.0913 / Avg. batch time: 566.9391 (ms) / GPU bubble ratio: 51.85%
[rank0]:2025-12-28 18:39:26,515 - Avg. fwd time: 8.2363 / Avg. bwd time: 25.2842 / Avg. batch time: 605.3020 (ms) / GPU bubble ratio: 55.70%
[rank0]:2025-12-28 18:41:25,713 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-28 18:41:30,599 - Avg. fwd time: 10.7356 / Avg. bwd time: 43.7414 / Avg. batch time: 495.3906 (ms) / GPU bubble ratio: 12.03%
[rank2]:2025-12-28 18:41:30,630 - Avg. fwd time: 6.9409 / Avg. bwd time: 19.5160 / Avg. batch time: 527.1169 (ms) / GPU bubble ratio: 59.85%
[rank0]:2025-12-28 18:41:30,701 - Avg. fwd time: 8.2353 / Avg. bwd time: 25.2843 / Avg. batch time: 605.2030 (ms) / GPU bubble ratio: 55.69%
[rank1]:2025-12-28 18:41:30,665 - Avg. fwd time: 9.0319 / Avg. bwd time: 25.0926 / Avg. batch time: 566.8421 (ms) / GPU bubble ratio: 51.84%
[rank3]:2025-12-28 18:41:30,735 -  step: 550  loss:  0.2221  grad_norm:  0.1218  memory: 26.98GiB(56.79%)  tps: 6,595  tflops: 51.56  mfu: 16.52%
[rank2]:2025-12-28 18:41:30,722 -  step: 550  loss: -8.0000  grad_norm:  0.1218  memory: 12.26GiB(25.80%)  tps: 6,595  tflops: 51.56  mfu: 16.52%
[rank0]:2025-12-28 18:41:30,737 -  step: 550  loss: -8.0000  grad_norm:  0.1218  memory: 17.08GiB(35.95%)  tps: 6,595  tflops: 51.56  mfu: 16.52%
[rank1]:2025-12-28 18:41:30,726 -  step: 550  loss: -8.0000  grad_norm:  0.1218  memory: 15.15GiB(31.89%)  tps: 6,595  tflops: 51.56  mfu: 16.52%
[rank3]:2025-12-28 18:43:34,751 - Avg. fwd time: 10.7338 / Avg. bwd time: 43.7317 / Avg. batch time: 495.2970 (ms) / GPU bubble ratio: 12.03%
[rank2]:2025-12-28 18:43:34,782 - Avg. fwd time: 6.9405 / Avg. bwd time: 19.5162 / Avg. batch time: 527.0167 (ms) / GPU bubble ratio: 59.84%
[rank0]:2025-12-28 18:43:34,853 - Avg. fwd time: 8.2348 / Avg. bwd time: 25.2842 / Avg. batch time: 605.1035 (ms) / GPU bubble ratio: 55.68%
[rank1]:2025-12-28 18:43:34,818 - Avg. fwd time: 9.0311 / Avg. bwd time: 25.0944 / Avg. batch time: 566.7437 (ms) / GPU bubble ratio: 51.83%
[rank0]:2025-12-28 18:45:34,140 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-28 18:45:39,099 - Avg. fwd time: 6.9403 / Avg. bwd time: 19.5164 / Avg. batch time: 526.9585 (ms) / GPU bubble ratio: 59.83%
[rank3]:2025-12-28 18:45:39,068 - Avg. fwd time: 10.7323 / Avg. bwd time: 43.7267 / Avg. batch time: 495.2442 (ms) / GPU bubble ratio: 12.03%
[rank1]:2025-12-28 18:45:39,135 - Avg. fwd time: 9.0305 / Avg. bwd time: 25.0960 / Avg. batch time: 566.6885 (ms) / GPU bubble ratio: 51.82%
[rank2]:2025-12-28 18:45:39,192 -  step: 600  loss: -8.0000  grad_norm:  0.1374  memory: 12.26GiB(25.80%)  tps: 6,594  tflops: 51.55  mfu: 16.52%
[rank0]:2025-12-28 18:45:39,171 - Avg. fwd time: 8.2340 / Avg. bwd time: 25.2837 / Avg. batch time: 605.0464 (ms) / GPU bubble ratio: 55.68%
[rank0]:2025-12-28 18:45:39,207 -  step: 600  loss: -8.0000  grad_norm:  0.1374  memory: 17.08GiB(35.95%)  tps: 6,594  tflops: 51.55  mfu: 16.52%
[rank3]:2025-12-28 18:45:39,206 -  step: 600  loss:  0.2166  grad_norm:  0.1374  memory: 26.98GiB(56.79%)  tps: 6,594  tflops: 51.55  mfu: 16.52%
[rank1]:2025-12-28 18:45:39,196 -  step: 600  loss: -8.0000  grad_norm:  0.1374  memory: 15.15GiB(31.89%)  tps: 6,594  tflops: 51.55  mfu: 16.52%
[rank3]:2025-12-28 18:45:39,351 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_GPipe_nofreeze_11_dm1/pipeline_schedule/251228_1845_step600_rank3.svg
[rank3]:			> Batch Time: 604.81 ms, GPU Bubble Ratio: 55.66%, 54.84%, 64.98%, 27.95%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB4,F]  32-8-40ms      | [S0,MB5,F]  40-7-48ms      | [S0,MB6,F]  48-8-56ms      | [S0,MB7,F]  56-8-65ms      | [S0,MB0,B]  271-25-296ms   | [S0,MB1,B]  314-25-340ms   | [S0,MB2,B]  359-25-384ms   | [S0,MB3,B]  403-25-428ms   | [S0,MB4,B]  448-25-473ms   | [S0,MB5,B]  492-25-517ms   | [S0,MB6,B]  538-25-563ms   | [S0,MB7,B]  579-25-604ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-10-20ms      | [S1,MB1,F]  23-8-32ms      | [S1,MB2,F]  35-8-44ms      | [S1,MB3,F]  56-8-65ms      | [S1,MB4,F]  73-8-82ms      | [S1,MB5,F]  91-8-100ms     | [S1,MB6,F]  109-8-118ms    | [S1,MB7,F]  127-8-136ms    | [S1,MB0,B]  243-24-268ms   | [S1,MB1,B]  286-24-311ms   | [S1,MB2,B]  330-25-355ms   | [S1,MB3,B]  375-25-400ms   | [S1,MB4,B]  419-25-444ms   | [S1,MB5,B]  464-25-489ms   | [S1,MB6,B]  509-25-534ms   | [S1,MB7,B]  551-25-576ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-6-39ms      | [S2,MB2,F]  53-6-59ms      | [S2,MB3,F]  70-6-77ms      | [S2,MB4,F]  88-6-95ms      | [S2,MB5,F]  106-6-113ms    | [S2,MB6,F]  124-6-131ms    | [S2,MB7,F]  142-6-148ms    | [S2,MB0,B]  220-19-240ms   | [S2,MB1,B]  263-19-283ms   | [S2,MB2,B]  307-19-327ms   | [S2,MB3,B]  352-19-371ms   | [S2,MB4,B]  396-19-416ms   | [S2,MB5,B]  441-19-460ms   | [S2,MB6,B]  486-19-506ms   | [S2,MB7,B]  528-19-547ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  49-10-60ms     | [S3,MB2,F]  67-10-77ms     | [S3,MB3,F]  85-10-95ms     | [S3,MB4,F]  103-10-113ms   | [S3,MB5,F]  121-10-131ms   | [S3,MB6,F]  139-10-149ms   | [S3,MB7,F]  157-10-167ms   | [S3,MB0,B]  173-40-214ms   | [S3,MB1,B]  214-42-256ms   | [S3,MB2,B]  256-43-300ms   | [S3,MB3,B]  301-45-346ms   | [S3,MB4,B]  345-44-389ms   | [S3,MB5,B]  389-43-433ms   | [S3,MB6,B]  434-44-479ms   | [S3,MB7,B]  479-45-525ms  
[rank3]:2025-12-28 18:47:43,586 - Avg. fwd time: 10.7311 / Avg. bwd time: 43.7244 / Avg. batch time: 495.2163 (ms) / GPU bubble ratio: 12.03%
[rank2]:2025-12-28 18:47:43,618 - Avg. fwd time: 6.9400 / Avg. bwd time: 19.5166 / Avg. batch time: 526.9483 (ms) / GPU bubble ratio: 59.83%
[rank1]:2025-12-28 18:47:43,654 - Avg. fwd time: 9.0301 / Avg. bwd time: 25.0979 / Avg. batch time: 566.6816 (ms) / GPU bubble ratio: 51.82%
[rank0]:2025-12-28 18:47:43,691 - Avg. fwd time: 8.2333 / Avg. bwd time: 25.2834 / Avg. batch time: 605.0377 (ms) / GPU bubble ratio: 55.68%
[rank0]:2025-12-28 18:49:43,083 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-28 18:49:47,951 - Avg. fwd time: 10.7299 / Avg. bwd time: 43.7204 / Avg. batch time: 495.1724 (ms) / GPU bubble ratio: 12.03%
[rank2]:2025-12-28 18:49:47,983 - Avg. fwd time: 6.9398 / Avg. bwd time: 19.5171 / Avg. batch time: 526.8990 (ms) / GPU bubble ratio: 59.83%
[rank1]:2025-12-28 18:49:48,019 - Avg. fwd time: 9.0295 / Avg. bwd time: 25.1000 / Avg. batch time: 566.6346 (ms) / GPU bubble ratio: 51.81%
[rank2]:2025-12-28 18:49:48,078 -  step: 650  loss: -8.0000  grad_norm:  0.1122  memory: 12.26GiB(25.80%)  tps: 6,583  tflops: 51.46  mfu: 16.49%
[rank1]:2025-12-28 18:49:48,081 -  step: 650  loss: -8.0000  grad_norm:  0.1122  memory: 15.15GiB(31.89%)  tps: 6,583  tflops: 51.46  mfu: 16.49%
[rank3]:2025-12-28 18:49:48,090 -  step: 650  loss:  0.2267  grad_norm:  0.1122  memory: 26.98GiB(56.79%)  tps: 6,583  tflops: 51.46  mfu: 16.49%
[rank0]:2025-12-28 18:49:48,056 - Avg. fwd time: 8.2326 / Avg. bwd time: 25.2830 / Avg. batch time: 604.9892 (ms) / GPU bubble ratio: 55.68%
[rank0]:2025-12-28 18:49:48,092 -  step: 650  loss: -8.0000  grad_norm:  0.1122  memory: 17.08GiB(35.95%)  tps: 6,583  tflops: 51.46  mfu: 16.49%
[rank2]:2025-12-28 18:51:52,289 - Avg. fwd time: 6.9395 / Avg. bwd time: 19.5173 / Avg. batch time: 526.8488 (ms) / GPU bubble ratio: 59.83%
[rank3]:2025-12-28 18:51:52,256 - Avg. fwd time: 10.7284 / Avg. bwd time: 43.7164 / Avg. batch time: 495.1268 (ms) / GPU bubble ratio: 12.03%
[rank1]:2025-12-28 18:51:52,325 - Avg. fwd time: 9.0290 / Avg. bwd time: 25.1022 / Avg. batch time: 566.5886 (ms) / GPU bubble ratio: 51.81%
[rank0]:2025-12-28 18:51:52,362 - Avg. fwd time: 8.2319 / Avg. bwd time: 25.2826 / Avg. batch time: 604.9414 (ms) / GPU bubble ratio: 55.68%
[rank0]:2025-12-28 18:53:51,729 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-28 18:53:56,574 - Avg. fwd time: 10.7270 / Avg. bwd time: 43.7127 / Avg. batch time: 495.0858 (ms) / GPU bubble ratio: 12.03%
[rank2]:2025-12-28 18:53:56,606 - Avg. fwd time: 6.9392 / Avg. bwd time: 19.5175 / Avg. batch time: 526.8033 (ms) / GPU bubble ratio: 59.82%
[rank1]:2025-12-28 18:53:56,643 - Avg. fwd time: 9.0283 / Avg. bwd time: 25.1041 / Avg. batch time: 566.5471 (ms) / GPU bubble ratio: 51.80%
[rank0]:2025-12-28 18:53:56,680 - Avg. fwd time: 8.2309 / Avg. bwd time: 25.2823 / Avg. batch time: 604.8988 (ms) / GPU bubble ratio: 55.68%
[rank2]:2025-12-28 18:53:56,702 -  step: 700  loss: -8.0000  grad_norm:  0.1208  memory: 12.26GiB(25.80%)  tps: 6,590  tflops: 51.52  mfu: 16.51%
[rank3]:2025-12-28 18:53:56,714 -  step: 700  loss:  0.1860  grad_norm:  0.1208  memory: 26.98GiB(56.79%)  tps: 6,590  tflops: 51.52  mfu: 16.51%
[rank1]:2025-12-28 18:53:56,705 -  step: 700  loss: -8.0000  grad_norm:  0.1208  memory: 15.15GiB(31.89%)  tps: 6,590  tflops: 51.52  mfu: 16.51%
[rank0]:2025-12-28 18:53:56,716 -  step: 700  loss: -8.0000  grad_norm:  0.1208  memory: 17.08GiB(35.95%)  tps: 6,590  tflops: 51.52  mfu: 16.51%
[rank3]:2025-12-28 18:53:56,856 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_GPipe_nofreeze_11_dm1/pipeline_schedule/251228_1853_step700_rank3.svg
[rank3]:			> Batch Time: 603.33 ms, GPU Bubble Ratio: 55.50%, 54.66%, 64.86%, 28.24%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB4,F]  32-8-40ms      | [S0,MB5,F]  40-7-48ms      | [S0,MB6,F]  48-8-56ms      | [S0,MB7,F]  56-8-65ms      | [S0,MB0,B]  271-25-296ms   | [S0,MB1,B]  314-25-340ms   | [S0,MB2,B]  358-25-383ms   | [S0,MB3,B]  402-25-428ms   | [S0,MB4,B]  447-25-472ms   | [S0,MB5,B]  491-25-516ms   | [S0,MB6,B]  536-25-561ms   | [S0,MB7,B]  578-25-603ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-10-20ms      | [S1,MB1,F]  23-8-32ms      | [S1,MB2,F]  35-8-44ms      | [S1,MB3,F]  56-8-65ms      | [S1,MB4,F]  73-8-82ms      | [S1,MB5,F]  91-8-100ms     | [S1,MB6,F]  109-8-118ms    | [S1,MB7,F]  127-8-136ms    | [S1,MB0,B]  243-24-268ms   | [S1,MB1,B]  286-25-311ms   | [S1,MB2,B]  329-25-354ms   | [S1,MB3,B]  374-25-399ms   | [S1,MB4,B]  418-25-444ms   | [S1,MB5,B]  462-25-487ms   | [S1,MB6,B]  507-25-533ms   | [S1,MB7,B]  549-25-574ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-6-39ms      | [S2,MB2,F]  53-6-59ms      | [S2,MB3,F]  70-6-77ms      | [S2,MB4,F]  88-6-95ms      | [S2,MB5,F]  106-6-113ms    | [S2,MB6,F]  124-6-131ms    | [S2,MB7,F]  142-6-149ms    | [S2,MB0,B]  220-19-240ms   | [S2,MB1,B]  263-19-282ms   | [S2,MB2,B]  306-19-326ms   | [S2,MB3,B]  351-19-371ms   | [S2,MB4,B]  396-19-415ms   | [S2,MB5,B]  439-19-459ms   | [S2,MB6,B]  484-19-504ms   | [S2,MB7,B]  526-19-546ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  50-10-60ms     | [S3,MB2,F]  67-10-77ms     | [S3,MB3,F]  85-10-95ms     | [S3,MB4,F]  103-10-113ms   | [S3,MB5,F]  121-10-131ms   | [S3,MB6,F]  139-10-149ms   | [S3,MB7,F]  157-10-167ms   | [S3,MB0,B]  173-40-214ms   | [S3,MB1,B]  214-42-256ms   | [S3,MB2,B]  256-43-299ms   | [S3,MB3,B]  300-43-343ms   | [S3,MB4,B]  344-44-388ms   | [S3,MB5,B]  388-44-432ms   | [S3,MB6,B]  432-44-476ms   | [S3,MB7,B]  477-44-522ms  
[rank2]:2025-12-28 18:56:01,021 - Avg. fwd time: 6.9389 / Avg. bwd time: 19.5177 / Avg. batch time: 526.7730 (ms) / GPU bubble ratio: 59.82%
[rank3]:2025-12-28 18:56:00,988 - Avg. fwd time: 10.7257 / Avg. bwd time: 43.7085 / Avg. batch time: 495.0409 (ms) / GPU bubble ratio: 12.03%
[rank1]:2025-12-28 18:56:01,058 - Avg. fwd time: 9.0276 / Avg. bwd time: 25.1061 / Avg. batch time: 566.5221 (ms) / GPU bubble ratio: 51.80%
[rank0]:2025-12-28 18:56:01,096 - Avg. fwd time: 8.2303 / Avg. bwd time: 25.2818 / Avg. batch time: 604.8729 (ms) / GPU bubble ratio: 55.68%
[rank0]:2025-12-28 18:58:00,532 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-28 18:58:05,442 - Avg. fwd time: 10.7247 / Avg. bwd time: 43.7069 / Avg. batch time: 495.0194 (ms) / GPU bubble ratio: 12.03%
[rank2]:2025-12-28 18:58:05,475 - Avg. fwd time: 6.9388 / Avg. bwd time: 19.5176 / Avg. batch time: 526.7460 (ms) / GPU bubble ratio: 59.82%
[rank3]:2025-12-28 18:58:05,586 -  step: 750  loss:  0.2246  grad_norm:  0.1434  memory: 26.98GiB(56.79%)  tps: 6,583  tflops: 51.47  mfu: 16.50%
[rank2]:2025-12-28 18:58:05,572 -  step: 750  loss: -8.0000  grad_norm:  0.1434  memory: 12.26GiB(25.80%)  tps: 6,583  tflops: 51.47  mfu: 16.50%
[rank1]:2025-12-28 18:58:05,513 - Avg. fwd time: 9.0271 / Avg. bwd time: 25.1072 / Avg. batch time: 566.4952 (ms) / GPU bubble ratio: 51.80%
[rank1]:2025-12-28 18:58:05,576 -  step: 750  loss: -8.0000  grad_norm:  0.1434  memory: 15.15GiB(31.89%)  tps: 6,583  tflops: 51.47  mfu: 16.50%
[rank0]:2025-12-28 18:58:05,551 - Avg. fwd time: 8.2299 / Avg. bwd time: 25.2813 / Avg. batch time: 604.8452 (ms) / GPU bubble ratio: 55.68%
[rank0]:2025-12-28 18:58:05,587 -  step: 750  loss: -8.0000  grad_norm:  0.1434  memory: 17.08GiB(35.95%)  tps: 6,583  tflops: 51.47  mfu: 16.50%
[rank2]:2025-12-28 19:00:09,939 - Avg. fwd time: 6.9387 / Avg. bwd time: 19.5175 / Avg. batch time: 526.7297 (ms) / GPU bubble ratio: 59.82%
[rank3]:2025-12-28 19:00:09,906 - Avg. fwd time: 10.7238 / Avg. bwd time: 43.7064 / Avg. batch time: 495.0071 (ms) / GPU bubble ratio: 12.03%
[rank1]:2025-12-28 19:00:09,977 - Avg. fwd time: 9.0265 / Avg. bwd time: 25.1082 / Avg. batch time: 566.4807 (ms) / GPU bubble ratio: 51.79%
[rank0]:2025-12-28 19:00:10,015 - Avg. fwd time: 8.2292 / Avg. bwd time: 25.2808 / Avg. batch time: 604.8297 (ms) / GPU bubble ratio: 55.68%
[rank0]:2025-12-28 19:02:09,442 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-28 19:02:14,404 - Avg. fwd time: 10.7232 / Avg. bwd time: 43.7059 / Avg. batch time: 494.9979 (ms) / GPU bubble ratio: 12.03%
[rank2]:2025-12-28 19:02:14,437 - Avg. fwd time: 6.9386 / Avg. bwd time: 19.5173 / Avg. batch time: 526.7168 (ms) / GPU bubble ratio: 59.82%
[rank1]:2025-12-28 19:02:14,475 - Avg. fwd time: 9.0261 / Avg. bwd time: 25.1098 / Avg. batch time: 566.4713 (ms) / GPU bubble ratio: 51.79%
[rank0]:2025-12-28 19:02:14,514 - Avg. fwd time: 8.2286 / Avg. bwd time: 25.2802 / Avg. batch time: 604.8195 (ms) / GPU bubble ratio: 55.68%
[rank2]:2025-12-28 19:02:14,535 -  step: 800  loss: -8.0000  grad_norm:  0.1319  memory: 12.26GiB(25.80%)  tps: 6,581  tflops: 51.45  mfu: 16.49%
[rank2]:2025-12-28 19:02:14,536 - â„¹ï¸ final step: 800  loss: -8.0000  grad_norm:  0.1319  tps: 6,981  tflops: 54.57  mfu: 15.96%
[rank2]:2025-12-28 19:02:14,536 - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-12-28 19:02:14,536 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank3]:2025-12-28 19:02:14,549 -  step: 800  loss:  0.2295  grad_norm:  0.1319  memory: 26.98GiB(56.79%)  tps: 6,581  tflops: 51.45  mfu: 16.49%
[rank3]:2025-12-28 19:02:14,549 - â„¹ï¸ final step: 800  loss:  0.2295  grad_norm:  0.1319  tps: 6,985  tflops: 54.61  mfu: 16.09%
[rank3]:2025-12-28 19:02:14,550 - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-12-28 19:02:14,550 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank1]:2025-12-28 19:02:14,539 -  step: 800  loss: -8.0000  grad_norm:  0.1319  memory: 15.15GiB(31.89%)  tps: 6,581  tflops: 51.45  mfu: 16.49%
[rank0]:2025-12-28 19:02:14,550 -  step: 800  loss: -8.0000  grad_norm:  0.1319  memory: 17.08GiB(35.95%)  tps: 6,581  tflops: 51.45  mfu: 16.49%
[rank1]:2025-12-28 19:02:14,539 - â„¹ï¸ final step: 800  loss: -8.0000  grad_norm:  0.1319  tps: 6,981  tflops: 54.57  mfu: 15.96%
[rank0]:2025-12-28 19:02:14,550 - â„¹ï¸ final step: 800  loss: -8.0000  grad_norm:  0.1319  tps: 6,981  tflops: 54.57  mfu: 15.96%
[rank1]:2025-12-28 19:02:14,539 - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-12-28 19:02:14,540 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-28 19:02:14,550 - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-12-28 19:02:14,551 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank1]:2025-12-28 19:02:16,523 - Destroying the purge thread.
[rank0]:2025-12-28 19:02:16,501 - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-12-28 19:02:16,523 - Sleeping 2 seconds for other ranks to complete
[rank2]:2025-12-28 19:02:16,523 - Destroying the purge thread.
[rank3]:2025-12-28 19:02:16,662 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_GPipe_nofreeze_11_dm1/pipeline_schedule/251228_1902_final800_rank3.svg
[rank3]:			> Batch Time: 604.34 ms, GPU Bubble Ratio: 55.52%, 54.78%, 64.93%, 28.01%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB4,F]  32-8-40ms      | [S0,MB5,F]  40-7-48ms      | [S0,MB6,F]  48-8-57ms      | [S0,MB7,F]  57-8-65ms      | [S0,MB0,B]  272-25-297ms   | [S0,MB1,B]  314-25-340ms   | [S0,MB2,B]  358-25-384ms   | [S0,MB3,B]  403-25-428ms   | [S0,MB4,B]  447-25-472ms   | [S0,MB5,B]  492-25-517ms   | [S0,MB6,B]  537-25-562ms   | [S0,MB7,B]  579-25-604ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-10-20ms      | [S1,MB1,F]  23-8-32ms      | [S1,MB2,F]  35-8-44ms      | [S1,MB3,F]  56-8-65ms      | [S1,MB4,F]  74-8-82ms      | [S1,MB5,F]  91-8-100ms     | [S1,MB6,F]  109-8-118ms    | [S1,MB7,F]  127-8-136ms    | [S1,MB0,B]  244-24-269ms   | [S1,MB1,B]  286-24-311ms   | [S1,MB2,B]  330-25-355ms   | [S1,MB3,B]  374-25-399ms   | [S1,MB4,B]  419-25-444ms   | [S1,MB5,B]  463-25-489ms   | [S1,MB6,B]  508-25-533ms   | [S1,MB7,B]  550-25-575ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-6-39ms      | [S2,MB2,F]  53-6-60ms      | [S2,MB3,F]  70-6-77ms      | [S2,MB4,F]  88-6-95ms      | [S2,MB5,F]  106-6-113ms    | [S2,MB6,F]  124-6-131ms    | [S2,MB7,F]  142-6-149ms    | [S2,MB0,B]  221-19-240ms   | [S2,MB1,B]  263-19-283ms   | [S2,MB2,B]  307-19-327ms   | [S2,MB3,B]  351-19-371ms   | [S2,MB4,B]  396-19-415ms   | [S2,MB5,B]  440-19-460ms   | [S2,MB6,B]  485-19-505ms   | [S2,MB7,B]  527-19-547ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  50-10-60ms     | [S3,MB2,F]  67-10-77ms     | [S3,MB3,F]  85-10-95ms     | [S3,MB4,F]  103-10-113ms   | [S3,MB5,F]  121-10-132ms   | [S3,MB6,F]  139-10-150ms   | [S3,MB7,F]  157-10-168ms   | [S3,MB0,B]  174-40-214ms   | [S3,MB1,B]  214-42-257ms   | [S3,MB2,B]  257-43-300ms   | [S3,MB3,B]  300-44-345ms   | [S3,MB4,B]  345-44-389ms   | [S3,MB5,B]  389-44-433ms   | [S3,MB6,B]  434-44-478ms   | [S3,MB7,B]  479-45-524ms  
[rank3]:2025-12-28 19:02:16,796 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1227_GPipe_nofreeze_11_dm1/pipeline_schedule/251228_1902_thry_final800_rank3.svg
[rank3]:			> Batch Time: 287.70 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-8-26ms      | [S0,MB3,F]  26-8-34ms      | [S0,MB4,F]  34-8-43ms      | [S0,MB5,F]  43-8-52ms      | [S0,MB6,F]  52-8-61ms      | [S0,MB7,F]  61-8-69ms      | [S0,MB0,B]  148-17-165ms   | [S0,MB1,B]  165-17-183ms   | [S0,MB2,B]  183-17-200ms   | [S0,MB3,B]  200-17-217ms   | [S0,MB4,B]  217-17-235ms   | [S0,MB5,B]  235-17-252ms   | [S0,MB6,B]  252-17-270ms   | [S0,MB7,B]  270-17-287ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-8-17ms       | [S1,MB1,F]  17-8-26ms      | [S1,MB2,F]  26-8-34ms      | [S1,MB3,F]  34-8-43ms      | [S1,MB4,F]  43-8-52ms      | [S1,MB5,F]  52-8-61ms      | [S1,MB6,F]  61-8-69ms      | [S1,MB7,F]  69-8-78ms      | [S1,MB0,B]  130-17-148ms   | [S1,MB1,B]  148-17-165ms   | [S1,MB2,B]  165-17-183ms   | [S1,MB3,B]  183-17-200ms   | [S1,MB4,B]  200-17-217ms   | [S1,MB5,B]  217-17-235ms   | [S1,MB6,B]  235-17-252ms   | [S1,MB7,B]  252-17-270ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  17-8-26ms      | [S2,MB1,F]  26-8-34ms      | [S2,MB2,F]  34-8-43ms      | [S2,MB3,F]  43-8-52ms      | [S2,MB4,F]  52-8-61ms      | [S2,MB5,F]  61-8-69ms      | [S2,MB6,F]  69-8-78ms      | [S2,MB7,F]  78-8-87ms      | [S2,MB0,B]  113-17-130ms   | [S2,MB1,B]  130-17-148ms   | [S2,MB2,B]  148-17-165ms   | [S2,MB3,B]  165-17-183ms   | [S2,MB4,B]  183-17-200ms   | [S2,MB5,B]  200-17-217ms   | [S2,MB6,B]  217-17-235ms   | [S2,MB7,B]  235-17-252ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  26-8-34ms      | [S3,MB1,F]  34-8-43ms      | [S3,MB2,F]  43-8-52ms      | [S3,MB3,F]  52-8-61ms      | [S3,MB4,F]  61-8-69ms      | [S3,MB5,F]  69-8-78ms      | [S3,MB6,F]  78-8-87ms      | [S3,MB7,F]  87-8-95ms      | [S3,MB0,B]  95-17-113ms    | [S3,MB1,B]  113-17-130ms   | [S3,MB2,B]  130-17-148ms   | [S3,MB3,B]  148-17-165ms   | [S3,MB4,B]  165-17-183ms   | [S3,MB5,B]  183-17-200ms   | [S3,MB6,B]  200-17-217ms   | [S3,MB7,B]  217-17-235ms  
[rank3]:2025-12-28 19:02:16,797 - Destroying the purge thread.
[rank2]:2025-12-28 19:02:16,864 - Process group destroyed
[rank3]:wandb: updating run metadata
[rank1]:2025-12-28 19:02:16,874 - Process group destroyed
[rank3]:wandb: uploading data
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–ˆâ–†â–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–ˆâ–†â–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 4.69104
[rank3]:wandb:               final/avg_loss 0.22953
[rank3]:wandb:             final/avg_mfu(%) 16.09377
[rank3]:wandb:             final/avg_tflops 54.60727
[rank3]:wandb:    final/avg_throughput(tps) 6985.22421
[rank3]:wandb:              final/grad_norm 0.13193
[rank3]:wandb:               final/max_loss 0.22953
[rank3]:wandb:                    grad_norm 0.13193
[rank3]:wandb: loss_metrics/global_avg_loss 0.22953
[rank3]:wandb: loss_metrics/global_max_loss 0.22953
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1227_GPipe_nofreeze_11_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/iilofkp3
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1227_GPipe_nofreeze_11_dm1/20251228-1755/wandb/run-20251228_175546-iilofkp3/logs
[rank3]:2025-12-28 19:02:18,410 - Process group destroyed
[rank0]:2025-12-28 19:02:18,523 - Training completed
[rank0]:2025-12-28 19:02:18,524 - Destroying the purge thread.
[rank0]:2025-12-28 19:02:18,999 - Process group destroyed
[rank2]:Stage 2: Modules to keep: {'layers.10', 'layers.11', 'layers.12', 'layers.9'}
[rank0]:Stage 0: Modules to keep: {'layers.1', 'layers.0', 'tok_embeddings', 'layers.2', 'layers.3'}
[rank1]:Stage 1: Modules to keep: {'layers.6', 'layers.7', 'layers.5', 'layers.4', 'layers.8'}
[rank3]:Stage 3: Modules to keep: {'layers.14', 'norm', 'output', 'layers.15', 'layers.13'}
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1227.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:1227: everything same as 1224 but seed=42->11
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1227_GPipe_nofreeze_11_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1227_GPipe_nofreeze_11_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1227_GPipe_nofreeze_11_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1227_GPipe_nofreeze_11_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1227_GPipe_nofreeze_11_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1227_GPipe_nofreeze_11_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 11
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: GPipe
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1227_GPipe_nofreeze_11_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1227_GPipe_nofreeze_11_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: False
[rank3]:		- metric_type: apf
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.05
[rank3]:		- percentile: 80
[rank3]:
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
