
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 11. 11. (í™”) 16:58:13 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 2,3,4,5
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/1109_GPipe_nofreeze_42.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset

âœ”ï¸Running with nofreeze x GPipe ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1109.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
" --parallelism.pipeline_parallel_degree=4  --freezing.no-freeze
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank1]:2025-11-11 16:58:19,267 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank1]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank1]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank1]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank1]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank1]:"
[rank3]:2025-11-11 16:58:19,256 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:"
[rank1]:2025-11-11 16:58:19,463 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-11-11 16:58:19,466 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-11-11 16:58:19,429 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank2]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank2]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank2]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank2]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank2]:"
[rank0]:2025-11-11 16:58:19,454 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank0]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank0]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank0]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank0]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank0]:"
[rank3]:2025-11-11 16:58:19,491 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-11-11 16:58:19,493 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-11-11 16:58:19,647 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-11-11 16:58:19,650 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-11 16:58:19,674 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-11-11 16:58:19,677 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-11 16:58:19,680 - INFO - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-11-11 16:58:19,682 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-11-11 16:58:20,071 - INFO - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank1]:2025-11-11 16:58:22,921 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-11-11 16:58:22,959 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-11-11 16:58:22,987 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-11-11 16:58:22,987 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2025-11-11 16:58:23,172 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-11-11 16:58:23,173 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-11-11 16:58:23,173 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank2]:2025-11-11 16:58:23,120 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-11-11 16:58:23,167 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-11-11 16:58:23,193 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-11-11 16:58:23,193 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank2]:2025-11-11 16:58:23,376 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-11-11 16:58:23,376 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-11-11 16:58:23,377 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank0]:2025-11-11 16:58:23,789 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank0]:2025-11-11 16:58:23,943 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-11-11 16:58:23,981 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-11 16:58:23,982 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-11-11 16:58:24,008 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-11-11 16:58:24,008 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-11-11 16:58:24,202 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-11 16:58:24,202 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-11-11 16:58:24,202 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank3]:wandb: setting up run ixg5jtdz
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1109_GPipe_nofreeze_42_dm1/20251111-1658/wandb/run-20251111_165823-ixg5jtdz
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1109_GPipe_nofreeze_42_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/ixg5jtdz
[rank3]:2025-11-11 16:58:24,915 - INFO - WandB logging enabled
[rank3]:2025-11-11 16:58:24,916 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-11-11 16:58:24,956 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-11-11 16:58:24,985 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-11-11 16:58:24,986 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2025-11-11 16:58:25,186 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank2]:2025-11-11 16:58:25,187 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-11 16:58:25,186 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1109_GPipe_nofreeze_42_dm1
[rank0]:2025-11-11 16:58:25,186 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-11 16:58:25,187 - INFO - Trainer is initialized with local batch size 16, global batch size 128, gradient accumulation steps 8, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2025-11-11 16:58:25,187 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank3]:2025-11-11 16:58:25,169 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-11-11 16:58:25,169 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-11-11 16:58:25,170 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2025-11-11 16:58:25,186 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-11 16:58:27,581 - INFO - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-11-11 16:58:27,581 - INFO - Finished loading the checkpoint in 2.39 seconds.
[rank0]:2025-11-11 16:58:27,581 - INFO - Training starts at step 1
[rank2]:2025-11-11 16:58:33,041 - INFO -  step:  1  loss: -8.0000  grad_norm: 116.5368  memory:  9.99GiB(21.03%)  tps: 3,319  tflops: 25.94  mfu: 8.32%
[rank2]:2025-11-11 16:58:33,041 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-11 16:58:33,078 - INFO -  step:  1  loss: -8.0000  grad_norm: 116.5368  memory: 12.80GiB(26.95%)  tps: 3,602  tflops: 28.16  mfu: 9.03%
[rank0]:2025-11-11 16:58:33,078 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-11-11 16:58:33,050 - INFO -  step:  1  loss: 10.6088  grad_norm: 116.5368  memory: 24.19GiB(50.91%)  tps: 4,050  tflops: 31.66  mfu: 10.15%
[rank3]:2025-11-11 16:58:33,051 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-11-11 16:58:33,049 - INFO -  step:  1  loss: -8.0000  grad_norm: 116.5368  memory: 12.38GiB(26.05%)  tps: 3,248  tflops: 25.39  mfu: 8.14%
[rank1]:2025-11-11 16:58:33,049 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-11-11 17:00:31,341 - INFO - Avg. fwd time: 10.8209 / Avg. bwd time: 43.1211 / Avg. batch time: 491.2656 (ms) / GPU bubble ratio: 12.16%
[rank2]:2025-11-11 17:00:31,415 - INFO - Avg. fwd time: 7.1687 / Avg. bwd time: 18.8699 / Avg. batch time: 523.1272 (ms) / GPU bubble ratio: 60.18%
[rank1]:2025-11-11 17:00:31,454 - INFO - Avg. fwd time: 9.2285 / Avg. bwd time: 24.3049 / Avg. batch time: 562.9366 (ms) / GPU bubble ratio: 52.35%
[rank0]:2025-11-11 17:00:31,461 - INFO - Avg. fwd time: 8.1706 / Avg. bwd time: 24.0557 / Avg. batch time: 600.8200 (ms) / GPU bubble ratio: 57.09%
[rank0]:2025-11-11 17:02:30,518 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-11 17:02:35,169 - INFO - Avg. fwd time: 10.8691 / Avg. bwd time: 43.3815 / Avg. batch time: 493.6126 (ms) / GPU bubble ratio: 12.08%
[rank1]:2025-11-11 17:02:35,278 - INFO - Avg. fwd time: 9.2558 / Avg. bwd time: 24.4032 / Avg. batch time: 564.5482 (ms) / GPU bubble ratio: 52.30%
[rank0]:2025-11-11 17:02:35,286 - INFO - Avg. fwd time: 8.1886 / Avg. bwd time: 24.1315 / Avg. batch time: 602.0523 (ms) / GPU bubble ratio: 57.05%
[rank2]:2025-11-11 17:02:35,239 - INFO - Avg. fwd time: 7.1805 / Avg. bwd time: 18.9299 / Avg. batch time: 525.0856 (ms) / GPU bubble ratio: 60.22%
[rank1]:2025-11-11 17:02:35,458 - INFO -  step: 50  loss: -8.0000  grad_norm: 12.4366  memory: 14.64GiB(30.82%)  tps: 6,624  tflops: 51.78  mfu: 16.60%
[rank0]:2025-11-11 17:02:35,470 - INFO -  step: 50  loss: -8.0000  grad_norm: 12.4366  memory: 16.57GiB(34.88%)  tps: 6,624  tflops: 51.78  mfu: 16.60%
[rank3]:2025-11-11 17:02:35,467 - INFO -  step: 50  loss:  9.9008  grad_norm: 12.4366  memory: 26.98GiB(56.79%)  tps: 6,623  tflops: 51.78  mfu: 16.60%
[rank2]:2025-11-11 17:02:35,455 - INFO -  step: 50  loss: -8.0000  grad_norm: 12.4366  memory: 11.81GiB(24.85%)  tps: 6,624  tflops: 51.78  mfu: 16.60%
[rank1]:2025-11-11 17:04:39,440 - INFO - Avg. fwd time: 9.2513 / Avg. bwd time: 24.4409 / Avg. batch time: 564.6722 (ms) / GPU bubble ratio: 52.27%
[rank3]:2025-11-11 17:04:39,384 - INFO - Avg. fwd time: 10.8583 / Avg. bwd time: 43.4367 / Avg. batch time: 493.9274 (ms) / GPU bubble ratio: 12.06%
[rank2]:2025-11-11 17:04:39,410 - INFO - Avg. fwd time: 7.1751 / Avg. bwd time: 18.9581 / Avg. batch time: 525.2957 (ms) / GPU bubble ratio: 60.20%
[rank0]:2025-11-11 17:04:39,470 - INFO - Avg. fwd time: 8.1964 / Avg. bwd time: 24.1576 / Avg. batch time: 602.1418 (ms) / GPU bubble ratio: 57.01%
[rank0]:2025-11-11 17:06:37,582 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-11 17:06:42,167 - INFO - Avg. fwd time: 10.8317 / Avg. bwd time: 43.3657 / Avg. batch time: 493.1225 (ms) / GPU bubble ratio: 12.07%
[rank2]:2025-11-11 17:06:42,240 - INFO - Avg. fwd time: 7.1697 / Avg. bwd time: 18.9642 / Avg. batch time: 524.4318 (ms) / GPU bubble ratio: 60.13%
[rank1]:2025-11-11 17:06:42,280 - INFO - Avg. fwd time: 9.2470 / Avg. bwd time: 24.4494 / Avg. batch time: 563.7676 (ms) / GPU bubble ratio: 52.18%
[rank0]:2025-11-11 17:06:42,287 - INFO - Avg. fwd time: 8.2002 / Avg. bwd time: 24.1662 / Avg. batch time: 601.2093 (ms) / GPU bubble ratio: 56.93%
[rank2]:2025-11-11 17:06:42,455 - INFO -  step: 100  loss: -8.0000  grad_norm:  8.4575  memory: 11.81GiB(24.85%)  tps: 6,633  tflops: 51.86  mfu: 16.62%
[rank1]:2025-11-11 17:06:42,459 - INFO -  step: 100  loss: -8.0000  grad_norm:  8.4575  memory: 14.64GiB(30.82%)  tps: 6,633  tflops: 51.86  mfu: 16.62%
[rank0]:2025-11-11 17:06:42,469 - INFO -  step: 100  loss: -8.0000  grad_norm:  8.4575  memory: 16.57GiB(34.88%)  tps: 6,633  tflops: 51.86  mfu: 16.62%
[rank3]:2025-11-11 17:06:42,468 - INFO -  step: 100  loss:  8.3023  grad_norm:  8.4575  memory: 26.98GiB(56.79%)  tps: 6,633  tflops: 51.86  mfu: 16.62%
[rank3]:2025-11-11 17:06:42,655 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_GPipe_nofreeze_42_dm1/pipeline_schedule/251111_1706_real_step100_rank3.svg
[rank3]:> Batch Time: 599.77 ms, GPU Bubble Ratio: 56.53%, 55.00%, 65.05%, 28.20%
[rank2]:2025-11-11 17:08:45,265 - INFO - Avg. fwd time: 7.1610 / Avg. bwd time: 18.9650 / Avg. batch time: 523.6765 (ms) / GPU bubble ratio: 60.09%
[rank3]:2025-11-11 17:08:45,191 - INFO - Avg. fwd time: 10.7988 / Avg. bwd time: 43.2906 / Avg. batch time: 492.2609 (ms) / GPU bubble ratio: 12.10%
[rank1]:2025-11-11 17:08:45,305 - INFO - Avg. fwd time: 9.2382 / Avg. bwd time: 24.4502 / Avg. batch time: 562.9706 (ms) / GPU bubble ratio: 52.13%
[rank0]:2025-11-11 17:08:45,312 - INFO - Avg. fwd time: 8.1919 / Avg. bwd time: 24.1676 / Avg. batch time: 600.3528 (ms) / GPU bubble ratio: 56.88%
[rank0]:2025-11-11 17:10:43,282 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-11 17:10:48,144 - INFO - Avg. fwd time: 10.7810 / Avg. bwd time: 43.2246 / Avg. batch time: 491.5684 (ms) / GPU bubble ratio: 12.11%
[rank2]:2025-11-11 17:10:48,171 - INFO - Avg. fwd time: 7.1551 / Avg. bwd time: 18.9691 / Avg. batch time: 522.9320 (ms) / GPU bubble ratio: 60.03%
[rank1]:2025-11-11 17:10:48,202 - INFO - Avg. fwd time: 9.2313 / Avg. bwd time: 24.4556 / Avg. batch time: 562.2032 (ms) / GPU bubble ratio: 52.06%
[rank0]:2025-11-11 17:10:48,233 - INFO - Avg. fwd time: 8.1898 / Avg. bwd time: 24.1720 / Avg. batch time: 599.5683 (ms) / GPU bubble ratio: 56.82%
[rank3]:2025-11-11 17:10:48,268 - INFO -  step: 150  loss:  3.6302  grad_norm: 13.6747  memory: 26.98GiB(56.79%)  tps: 6,666  tflops: 52.11  mfu: 16.70%
[rank2]:2025-11-11 17:10:48,255 - INFO -  step: 150  loss: -8.0000  grad_norm: 13.6747  memory: 11.81GiB(24.85%)  tps: 6,666  tflops: 52.11  mfu: 16.70%
[rank1]:2025-11-11 17:10:48,258 - INFO -  step: 150  loss: -8.0000  grad_norm: 13.6747  memory: 14.64GiB(30.82%)  tps: 6,666  tflops: 52.11  mfu: 16.70%
[rank0]:2025-11-11 17:10:48,269 - INFO -  step: 150  loss: -8.0000  grad_norm: 13.6747  memory: 16.57GiB(34.88%)  tps: 6,666  tflops: 52.11  mfu: 16.70%
[rank3]:2025-11-11 17:12:51,350 - INFO - Avg. fwd time: 10.7766 / Avg. bwd time: 43.2152 / Avg. batch time: 491.4478 (ms) / GPU bubble ratio: 12.11%
[rank0]:2025-11-11 17:12:51,468 - INFO - Avg. fwd time: 8.1903 / Avg. bwd time: 24.1844 / Avg. batch time: 599.4283 (ms) / GPU bubble ratio: 56.79%
[rank1]:2025-11-11 17:12:51,461 - INFO - Avg. fwd time: 9.2273 / Avg. bwd time: 24.4709 / Avg. batch time: 562.0559 (ms) / GPU bubble ratio: 52.04%
[rank2]:2025-11-11 17:12:51,420 - INFO - Avg. fwd time: 7.1524 / Avg. bwd time: 18.9795 / Avg. batch time: 522.7878 (ms) / GPU bubble ratio: 60.01%
[rank0]:2025-11-11 17:14:50,586 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-11 17:14:55,319 - INFO - Avg. fwd time: 10.7751 / Avg. bwd time: 43.2456 / Avg. batch time: 491.6696 (ms) / GPU bubble ratio: 12.10%
[rank2]:2025-11-11 17:14:55,394 - INFO - Avg. fwd time: 7.1511 / Avg. bwd time: 19.0056 / Avg. batch time: 523.0076 (ms) / GPU bubble ratio: 59.99%
[rank1]:2025-11-11 17:14:55,434 - INFO - Avg. fwd time: 9.2267 / Avg. bwd time: 24.4994 / Avg. batch time: 562.2800 (ms) / GPU bubble ratio: 52.02%
[rank0]:2025-11-11 17:14:55,442 - INFO - Avg. fwd time: 8.1932 / Avg. bwd time: 24.2030 / Avg. batch time: 599.6620 (ms) / GPU bubble ratio: 56.78%
[rank2]:2025-11-11 17:14:55,614 - INFO -  step: 200  loss: -8.0000  grad_norm:  7.5472  memory: 11.81GiB(24.85%)  tps: 6,624  tflops: 51.78  mfu: 16.60%
[rank1]:2025-11-11 17:14:55,618 - INFO -  step: 200  loss: -8.0000  grad_norm:  7.5472  memory: 14.64GiB(30.82%)  tps: 6,624  tflops: 51.78  mfu: 16.60%
[rank0]:2025-11-11 17:14:55,629 - INFO -  step: 200  loss: -8.0000  grad_norm:  7.5472  memory: 16.57GiB(34.88%)  tps: 6,624  tflops: 51.78  mfu: 16.60%
[rank3]:2025-11-11 17:14:55,627 - INFO -  step: 200  loss:  1.0029  grad_norm:  7.5472  memory: 26.98GiB(56.79%)  tps: 6,624  tflops: 51.78  mfu: 16.60%
[rank3]:2025-11-11 17:14:55,874 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_GPipe_nofreeze_42_dm1/pipeline_schedule/251111_1714_real_step200_rank3.svg
[rank3]:> Batch Time: 600.34 ms, GPU Bubble Ratio: 56.59%, 54.84%, 64.88%, 27.90%
[rank3]:2025-11-11 17:17:00,611 - INFO - Avg. fwd time: 10.7771 / Avg. bwd time: 43.2895 / Avg. batch time: 492.0323 (ms) / GPU bubble ratio: 12.09%
[rank1]:2025-11-11 17:17:00,677 - INFO - Avg. fwd time: 9.2280 / Avg. bwd time: 24.5251 / Avg. batch time: 562.7811 (ms) / GPU bubble ratio: 52.02%
[rank0]:2025-11-11 17:17:00,711 - INFO - Avg. fwd time: 8.2001 / Avg. bwd time: 24.2186 / Avg. batch time: 600.2123 (ms) / GPU bubble ratio: 56.79%
[rank2]:2025-11-11 17:17:00,641 - INFO - Avg. fwd time: 7.1501 / Avg. bwd time: 19.0271 / Avg. batch time: 523.4975 (ms) / GPU bubble ratio: 60.00%
[rank0]:2025-11-11 17:18:59,834 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-11 17:19:04,491 - INFO - Avg. fwd time: 10.7706 / Avg. bwd time: 43.2803 / Avg. batch time: 491.8997 (ms) / GPU bubble ratio: 12.09%
[rank1]:2025-11-11 17:19:04,600 - INFO - Avg. fwd time: 9.2266 / Avg. bwd time: 24.5396 / Avg. batch time: 562.6459 (ms) / GPU bubble ratio: 51.99%
[rank2]:2025-11-11 17:19:04,560 - INFO - Avg. fwd time: 7.1479 / Avg. bwd time: 19.0398 / Avg. batch time: 523.3560 (ms) / GPU bubble ratio: 59.97%
[rank0]:2025-11-11 17:19:04,609 - INFO - Avg. fwd time: 8.2047 / Avg. bwd time: 24.2272 / Avg. batch time: 600.1086 (ms) / GPU bubble ratio: 56.77%
[rank1]:2025-11-11 17:19:04,781 - INFO -  step: 250  loss: -8.0000  grad_norm:  1.6295  memory: 14.64GiB(30.82%)  tps: 6,576  tflops: 51.41  mfu: 16.48%
[rank2]:2025-11-11 17:19:04,778 - INFO -  step: 250  loss: -8.0000  grad_norm:  1.6295  memory: 11.81GiB(24.85%)  tps: 6,576  tflops: 51.41  mfu: 16.48%
[rank0]:2025-11-11 17:19:04,792 - INFO -  step: 250  loss: -8.0000  grad_norm:  1.6295  memory: 16.57GiB(34.88%)  tps: 6,576  tflops: 51.41  mfu: 16.48%
[rank3]:2025-11-11 17:19:04,791 - INFO -  step: 250  loss:  0.3542  grad_norm:  1.6295  memory: 26.98GiB(56.79%)  tps: 6,576  tflops: 51.41  mfu: 16.48%
[rank2]:2025-11-11 17:21:08,207 - INFO - Avg. fwd time: 7.1451 / Avg. bwd time: 19.0493 / Avg. batch time: 523.0677 (ms) / GPU bubble ratio: 59.94%
[rank3]:2025-11-11 17:21:08,137 - INFO - Avg. fwd time: 10.7613 / Avg. bwd time: 43.2561 / Avg. batch time: 491.6244 (ms) / GPU bubble ratio: 12.10%
[rank0]:2025-11-11 17:21:08,255 - INFO - Avg. fwd time: 8.2056 / Avg. bwd time: 24.2324 / Avg. batch time: 599.8532 (ms) / GPU bubble ratio: 56.74%
[rank1]:2025-11-11 17:21:08,247 - INFO - Avg. fwd time: 9.2239 / Avg. bwd time: 24.5512 / Avg. batch time: 562.3675 (ms) / GPU bubble ratio: 51.95%
[rank0]:2025-11-11 17:23:07,266 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-11 17:23:12,149 - INFO - Avg. fwd time: 10.7547 / Avg. bwd time: 43.2394 / Avg. batch time: 491.4342 (ms) / GPU bubble ratio: 12.10%
[rank2]:2025-11-11 17:23:12,180 - INFO - Avg. fwd time: 7.1423 / Avg. bwd time: 19.0568 / Avg. batch time: 522.8696 (ms) / GPU bubble ratio: 59.91%
[rank1]:2025-11-11 17:23:12,215 - INFO - Avg. fwd time: 9.2199 / Avg. bwd time: 24.5585 / Avg. batch time: 562.1667 (ms) / GPU bubble ratio: 51.93%
[rank3]:2025-11-11 17:23:12,285 - INFO -  step: 300  loss:  0.2589  grad_norm:  0.3456  memory: 26.98GiB(56.79%)  tps: 6,620  tflops: 51.75  mfu: 16.59%
[rank2]:2025-11-11 17:23:12,273 - INFO -  step: 300  loss: -8.0000  grad_norm:  0.3456  memory: 11.81GiB(24.85%)  tps: 6,620  tflops: 51.75  mfu: 16.59%
[rank1]:2025-11-11 17:23:12,276 - INFO -  step: 300  loss: -8.0000  grad_norm:  0.3456  memory: 14.64GiB(30.82%)  tps: 6,620  tflops: 51.75  mfu: 16.59%
[rank0]:2025-11-11 17:23:12,250 - INFO - Avg. fwd time: 8.2045 / Avg. bwd time: 24.2354 / Avg. batch time: 599.6705 (ms) / GPU bubble ratio: 56.72%
[rank0]:2025-11-11 17:23:12,287 - INFO -  step: 300  loss: -8.0000  grad_norm:  0.3456  memory: 16.57GiB(34.88%)  tps: 6,620  tflops: 51.75  mfu: 16.59%
[rank3]:2025-11-11 17:23:12,497 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_GPipe_nofreeze_42_dm1/pipeline_schedule/251111_1723_real_step300_rank3.svg
[rank3]:> Batch Time: 599.30 ms, GPU Bubble Ratio: 56.54%, 54.84%, 64.90%, 28.06%
[rank3]:2025-11-11 17:25:16,600 - INFO - Avg. fwd time: 10.7544 / Avg. bwd time: 43.2524 / Avg. batch time: 491.5350 (ms) / GPU bubble ratio: 12.10%
[rank1]:2025-11-11 17:25:16,711 - INFO - Avg. fwd time: 9.2186 / Avg. bwd time: 24.5655 / Avg. batch time: 562.3276 (ms) / GPU bubble ratio: 51.94%
[rank0]:2025-11-11 17:25:16,718 - INFO - Avg. fwd time: 8.2049 / Avg. bwd time: 24.2386 / Avg. batch time: 599.8438 (ms) / GPU bubble ratio: 56.73%
[rank2]:2025-11-11 17:25:16,670 - INFO - Avg. fwd time: 7.1413 / Avg. bwd time: 19.0632 / Avg. batch time: 523.0325 (ms) / GPU bubble ratio: 59.92%
[rank0]:2025-11-11 17:27:16,800 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-11 17:27:21,498 - INFO - Avg. fwd time: 10.7563 / Avg. bwd time: 43.2795 / Avg. batch time: 491.7678 (ms) / GPU bubble ratio: 12.10%
[rank1]:2025-11-11 17:27:21,610 - INFO - Avg. fwd time: 9.2183 / Avg. bwd time: 24.5745 / Avg. batch time: 562.5502 (ms) / GPU bubble ratio: 51.94%
[rank2]:2025-11-11 17:27:21,569 - INFO - Avg. fwd time: 7.1405 / Avg. bwd time: 19.0708 / Avg. batch time: 523.2558 (ms) / GPU bubble ratio: 59.93%
[rank0]:2025-11-11 17:27:21,617 - INFO - Avg. fwd time: 8.2051 / Avg. bwd time: 24.2428 / Avg. batch time: 600.0805 (ms) / GPU bubble ratio: 56.74%
[rank1]:2025-11-11 17:27:21,790 - INFO -  step: 350  loss: -8.0000  grad_norm:  0.1593  memory: 14.64GiB(30.82%)  tps: 6,566  tflops: 51.33  mfu: 16.45%
[rank2]:2025-11-11 17:27:21,786 - INFO -  step: 350  loss: -8.0000  grad_norm:  0.1593  memory: 11.81GiB(24.85%)  tps: 6,566  tflops: 51.33  mfu: 16.45%
[rank3]:2025-11-11 17:27:21,799 - INFO -  step: 350  loss:  0.2155  grad_norm:  0.1593  memory: 26.98GiB(56.79%)  tps: 6,566  tflops: 51.33  mfu: 16.45%
[rank0]:2025-11-11 17:27:21,801 - INFO -  step: 350  loss: -8.0000  grad_norm:  0.1593  memory: 16.57GiB(34.88%)  tps: 6,566  tflops: 51.33  mfu: 16.45%
[rank2]:2025-11-11 17:29:26,698 - INFO - Avg. fwd time: 7.1402 / Avg. bwd time: 19.0770 / Avg. batch time: 523.4912 (ms) / GPU bubble ratio: 59.93%
[rank3]:2025-11-11 17:29:26,665 - INFO - Avg. fwd time: 10.7584 / Avg. bwd time: 43.3078 / Avg. batch time: 492.0108 (ms) / GPU bubble ratio: 12.09%
[rank1]:2025-11-11 17:29:26,734 - INFO - Avg. fwd time: 9.2186 / Avg. bwd time: 24.5821 / Avg. batch time: 562.7868 (ms) / GPU bubble ratio: 51.95%
[rank0]:2025-11-11 17:29:26,771 - INFO - Avg. fwd time: 8.2077 / Avg. bwd time: 24.2473 / Avg. batch time: 600.3318 (ms) / GPU bubble ratio: 56.75%
[rank0]:2025-11-11 17:31:26,483 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-11 17:31:31,216 - INFO - Avg. fwd time: 10.7602 / Avg. bwd time: 43.3201 / Avg. batch time: 492.1231 (ms) / GPU bubble ratio: 12.09%
[rank2]:2025-11-11 17:31:31,291 - INFO - Avg. fwd time: 7.1403 / Avg. bwd time: 19.0827 / Avg. batch time: 523.5982 (ms) / GPU bubble ratio: 59.93%
[rank0]:2025-11-11 17:31:31,338 - INFO - Avg. fwd time: 8.2084 / Avg. bwd time: 24.2512 / Avg. batch time: 600.4514 (ms) / GPU bubble ratio: 56.75%
[rank1]:2025-11-11 17:31:31,331 - INFO - Avg. fwd time: 9.2190 / Avg. bwd time: 24.5893 / Avg. batch time: 562.8956 (ms) / GPU bubble ratio: 51.95%
[rank2]:2025-11-11 17:31:31,506 - INFO -  step: 400  loss: -8.0000  grad_norm:  0.1572  memory: 11.81GiB(24.85%)  tps: 6,561  tflops: 51.29  mfu: 16.44%
[rank0]:2025-11-11 17:31:31,521 - INFO -  step: 400  loss: -8.0000  grad_norm:  0.1572  memory: 16.57GiB(34.88%)  tps: 6,561  tflops: 51.29  mfu: 16.44%
[rank1]:2025-11-11 17:31:31,510 - INFO -  step: 400  loss: -8.0000  grad_norm:  0.1572  memory: 14.64GiB(30.82%)  tps: 6,561  tflops: 51.29  mfu: 16.44%
[rank3]:2025-11-11 17:31:31,518 - INFO -  step: 400  loss:  0.2072  grad_norm:  0.1572  memory: 26.98GiB(56.79%)  tps: 6,561  tflops: 51.29  mfu: 16.44%
[rank3]:2025-11-11 17:31:31,735 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_GPipe_nofreeze_42_dm1/pipeline_schedule/251111_1731_real_step400_rank3.svg
[rank3]:> Batch Time: 601.36 ms, GPU Bubble Ratio: 56.57%, 54.90%, 64.93%, 28.19%
[rank3]:2025-11-11 17:32:00,109 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-11-11 17:32:00,327 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-11-11 17:32:00,352 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-11-11 17:32:00,379 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-11-11 17:33:36,128 - INFO - Avg. fwd time: 7.1403 / Avg. bwd time: 19.0875 / Avg. batch time: 523.8112 (ms) / GPU bubble ratio: 59.94%
[rank3]:2025-11-11 17:33:36,055 - INFO - Avg. fwd time: 10.7604 / Avg. bwd time: 43.3410 / Avg. batch time: 492.2905 (ms) / GPU bubble ratio: 12.08%
[rank1]:2025-11-11 17:33:36,168 - INFO - Avg. fwd time: 9.2198 / Avg. bwd time: 24.5947 / Avg. batch time: 563.1079 (ms) / GPU bubble ratio: 51.96%
[rank0]:2025-11-11 17:33:36,177 - INFO - Avg. fwd time: 8.2095 / Avg. bwd time: 24.2548 / Avg. batch time: 600.6749 (ms) / GPU bubble ratio: 56.76%
[rank0]:2025-11-11 17:35:35,109 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-11 17:35:40,042 - INFO - Avg. fwd time: 9.2192 / Avg. bwd time: 24.5983 / Avg. batch time: 562.9441 (ms) / GPU bubble ratio: 51.94%
[rank3]:2025-11-11 17:35:39,974 - INFO - Avg. fwd time: 10.7564 / Avg. bwd time: 43.3260 / Avg. batch time: 492.1360 (ms) / GPU bubble ratio: 12.09%
[rank2]:2025-11-11 17:35:40,008 - INFO - Avg. fwd time: 7.1394 / Avg. bwd time: 19.0906 / Avg. batch time: 523.6469 (ms) / GPU bubble ratio: 59.93%
[rank1]:2025-11-11 17:35:40,106 - INFO -  step: 450  loss: -8.0000  grad_norm:  0.1416  memory: 14.64GiB(30.82%)  tps: 6,591  tflops: 51.52  mfu: 16.51%
[rank3]:2025-11-11 17:35:40,115 - INFO -  step: 450  loss:  0.2212  grad_norm:  0.1416  memory: 26.98GiB(56.79%)  tps: 6,591  tflops: 51.52  mfu: 16.51%
[rank2]:2025-11-11 17:35:40,102 - INFO -  step: 450  loss: -8.0000  grad_norm:  0.1416  memory: 11.81GiB(24.85%)  tps: 6,591  tflops: 51.52  mfu: 16.51%
[rank0]:2025-11-11 17:35:40,080 - INFO - Avg. fwd time: 8.2109 / Avg. bwd time: 24.2572 / Avg. batch time: 600.5224 (ms) / GPU bubble ratio: 56.75%
[rank0]:2025-11-11 17:35:40,117 - INFO -  step: 450  loss: -8.0000  grad_norm:  0.1416  memory: 16.57GiB(34.88%)  tps: 6,591  tflops: 51.52  mfu: 16.51%
[rank3]:2025-11-11 17:37:42,933 - INFO - Avg. fwd time: 10.7522 / Avg. bwd time: 43.3029 / Avg. batch time: 491.9144 (ms) / GPU bubble ratio: 12.09%
[rank2]:2025-11-11 17:37:43,001 - INFO - Avg. fwd time: 7.1386 / Avg. bwd time: 19.0915 / Avg. batch time: 523.4151 (ms) / GPU bubble ratio: 59.91%
[rank0]:2025-11-11 17:37:43,049 - INFO - Avg. fwd time: 8.2186 / Avg. bwd time: 24.2580 / Avg. batch time: 600.2938 (ms) / GPU bubble ratio: 56.72%
[rank1]:2025-11-11 17:37:43,041 - INFO - Avg. fwd time: 9.2187 / Avg. bwd time: 24.5991 / Avg. batch time: 562.7110 (ms) / GPU bubble ratio: 51.92%
[rank0]:2025-11-11 17:39:41,296 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-11 17:39:45,907 - INFO - Avg. fwd time: 10.7480 / Avg. bwd time: 43.2790 / Avg. batch time: 491.6861 (ms) / GPU bubble ratio: 12.10%
[rank1]:2025-11-11 17:39:46,016 - INFO - Avg. fwd time: 9.2174 / Avg. bwd time: 24.6003 / Avg. batch time: 562.4689 (ms) / GPU bubble ratio: 51.90%
[rank0]:2025-11-11 17:39:46,023 - INFO - Avg. fwd time: 8.2170 / Avg. bwd time: 24.2589 / Avg. batch time: 600.0440 (ms) / GPU bubble ratio: 56.70%
[rank2]:2025-11-11 17:39:45,970 - INFO - Avg. fwd time: 7.1376 / Avg. bwd time: 19.0931 / Avg. batch time: 523.1761 (ms) / GPU bubble ratio: 59.89%
[rank1]:2025-11-11 17:39:46,185 - INFO -  step: 500  loss: -8.0000  grad_norm:  0.1309  memory: 14.64GiB(30.82%)  tps: 6,658  tflops: 52.05  mfu: 16.68%
[rank0]:2025-11-11 17:39:46,196 - INFO -  step: 500  loss: -8.0000  grad_norm:  0.1309  memory: 16.57GiB(34.88%)  tps: 6,658  tflops: 52.05  mfu: 16.68%
[rank2]:2025-11-11 17:39:46,181 - INFO -  step: 500  loss: -8.0000  grad_norm:  0.1309  memory: 11.81GiB(24.85%)  tps: 6,658  tflops: 52.05  mfu: 16.68%
[rank3]:2025-11-11 17:39:46,194 - INFO -  step: 500  loss:  0.2135  grad_norm:  0.1309  memory: 26.98GiB(56.79%)  tps: 6,658  tflops: 52.05  mfu: 16.68%
[rank3]:2025-11-11 17:39:46,342 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_GPipe_nofreeze_42_dm1/pipeline_schedule/251111_1739_real_step500_rank3.svg
[rank3]:> Batch Time: 598.84 ms, GPU Bubble Ratio: 56.43%, 54.74%, 64.88%, 28.13%
[rank1]:2025-11-11 17:41:49,755 - INFO - Avg. fwd time: 9.2170 / Avg. bwd time: 24.6025 / Avg. batch time: 562.4049 (ms) / GPU bubble ratio: 51.89%
[rank2]:2025-11-11 17:41:49,720 - INFO - Avg. fwd time: 7.1372 / Avg. bwd time: 19.0951 / Avg. batch time: 523.1145 (ms) / GPU bubble ratio: 59.88%
[rank3]:2025-11-11 17:41:49,690 - INFO - Avg. fwd time: 10.7467 / Avg. bwd time: 43.2704 / Avg. batch time: 491.6051 (ms) / GPU bubble ratio: 12.10%
[rank0]:2025-11-11 17:41:49,790 - INFO - Avg. fwd time: 8.2160 / Avg. bwd time: 24.2601 / Avg. batch time: 599.9759 (ms) / GPU bubble ratio: 56.70%
[rank0]:2025-11-11 17:43:49,014 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-11 17:43:53,720 - INFO - Avg. fwd time: 10.7478 / Avg. bwd time: 43.2829 / Avg. batch time: 491.7143 (ms) / GPU bubble ratio: 12.09%
[rank2]:2025-11-11 17:43:53,790 - INFO - Avg. fwd time: 7.1372 / Avg. bwd time: 19.0966 / Avg. batch time: 523.2137 (ms) / GPU bubble ratio: 59.89%
[rank0]:2025-11-11 17:43:53,838 - INFO - Avg. fwd time: 8.2151 / Avg. bwd time: 24.2610 / Avg. batch time: 600.0634 (ms) / GPU bubble ratio: 56.70%
[rank1]:2025-11-11 17:43:53,830 - INFO - Avg. fwd time: 9.2173 / Avg. bwd time: 24.6039 / Avg. batch time: 562.4985 (ms) / GPU bubble ratio: 51.90%
[rank2]:2025-11-11 17:43:54,003 - INFO -  step: 550  loss: -8.0000  grad_norm:  0.1236  memory: 11.81GiB(24.85%)  tps: 6,611  tflops: 51.68  mfu: 16.57%
[rank0]:2025-11-11 17:43:54,017 - INFO -  step: 550  loss: -8.0000  grad_norm:  0.1236  memory: 16.57GiB(34.88%)  tps: 6,611  tflops: 51.68  mfu: 16.57%
[rank1]:2025-11-11 17:43:54,006 - INFO -  step: 550  loss: -8.0000  grad_norm:  0.1236  memory: 14.64GiB(30.82%)  tps: 6,611  tflops: 51.68  mfu: 16.57%
[rank3]:2025-11-11 17:43:54,015 - INFO -  step: 550  loss:  0.2237  grad_norm:  0.1236  memory: 26.98GiB(56.79%)  tps: 6,611  tflops: 51.68  mfu: 16.57%
[rank3]:2025-11-11 17:45:58,016 - INFO - Avg. fwd time: 10.7492 / Avg. bwd time: 43.2955 / Avg. batch time: 491.8273 (ms) / GPU bubble ratio: 12.09%
[rank0]:2025-11-11 17:45:58,140 - INFO - Avg. fwd time: 8.2130 / Avg. bwd time: 24.2625 / Avg. batch time: 600.1593 (ms) / GPU bubble ratio: 56.71%
[rank1]:2025-11-11 17:45:58,129 - INFO - Avg. fwd time: 9.2175 / Avg. bwd time: 24.6062 / Avg. batch time: 562.5999 (ms) / GPU bubble ratio: 51.90%
[rank2]:2025-11-11 17:45:58,089 - INFO - Avg. fwd time: 7.1370 / Avg. bwd time: 19.0985 / Avg. batch time: 523.3183 (ms) / GPU bubble ratio: 59.89%
[rank0]:2025-11-11 17:47:57,261 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-11 17:48:02,197 - INFO - Avg. fwd time: 7.1371 / Avg. bwd time: 19.1000 / Avg. batch time: 523.3648 (ms) / GPU bubble ratio: 59.89%
[rank3]:2025-11-11 17:48:02,161 - INFO - Avg. fwd time: 10.7501 / Avg. bwd time: 43.3012 / Avg. batch time: 491.8806 (ms) / GPU bubble ratio: 12.09%
[rank0]:2025-11-11 17:48:02,281 - INFO - Avg. fwd time: 8.2126 / Avg. bwd time: 24.2636 / Avg. batch time: 600.2018 (ms) / GPU bubble ratio: 56.71%
[rank1]:2025-11-11 17:48:02,237 - INFO - Avg. fwd time: 9.2181 / Avg. bwd time: 24.6076 / Avg. batch time: 562.6443 (ms) / GPU bubble ratio: 51.90%
[rank0]:2025-11-11 17:48:02,317 - INFO -  step: 600  loss: -8.0000  grad_norm:  0.1403  memory: 16.57GiB(34.88%)  tps: 6,598  tflops: 51.58  mfu: 16.53%
[rank1]:2025-11-11 17:48:02,307 - INFO -  step: 600  loss: -8.0000  grad_norm:  0.1403  memory: 14.64GiB(30.82%)  tps: 6,598  tflops: 51.58  mfu: 16.53%
[rank2]:2025-11-11 17:48:02,303 - INFO -  step: 600  loss: -8.0000  grad_norm:  0.1403  memory: 11.81GiB(24.85%)  tps: 6,598  tflops: 51.58  mfu: 16.53%
[rank3]:2025-11-11 17:48:02,316 - INFO -  step: 600  loss:  0.2172  grad_norm:  0.1403  memory: 26.98GiB(56.79%)  tps: 6,599  tflops: 51.58  mfu: 16.53%
[rank3]:2025-11-11 17:48:02,527 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_GPipe_nofreeze_42_dm1/pipeline_schedule/251111_1748_real_step600_rank3.svg
[rank3]:> Batch Time: 596.80 ms, GPU Bubble Ratio: 56.36%, 54.64%, 64.80%, 28.20%
[rank3]:2025-11-11 17:50:05,322 - INFO - Avg. fwd time: 10.7481 / Avg. bwd time: 43.2857 / Avg. batch time: 491.7397 (ms) / GPU bubble ratio: 12.09%
[rank1]:2025-11-11 17:50:05,435 - INFO - Avg. fwd time: 9.2173 / Avg. bwd time: 24.6086 / Avg. batch time: 562.5272 (ms) / GPU bubble ratio: 51.89%
[rank2]:2025-11-11 17:50:05,394 - INFO - Avg. fwd time: 7.1365 / Avg. bwd time: 19.1006 / Avg. batch time: 523.2507 (ms) / GPU bubble ratio: 59.89%
[rank0]:2025-11-11 17:50:05,442 - INFO - Avg. fwd time: 8.2114 / Avg. bwd time: 24.2638 / Avg. batch time: 600.0805 (ms) / GPU bubble ratio: 56.71%
[rank0]:2025-11-11 17:52:03,797 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-11 17:52:08,479 - INFO - Avg. fwd time: 10.7468 / Avg. bwd time: 43.2726 / Avg. batch time: 491.6228 (ms) / GPU bubble ratio: 12.10%
[rank2]:2025-11-11 17:52:08,549 - INFO - Avg. fwd time: 7.1364 / Avg. bwd time: 19.1007 / Avg. batch time: 523.1236 (ms) / GPU bubble ratio: 59.88%
[rank1]:2025-11-11 17:52:08,589 - INFO - Avg. fwd time: 9.2169 / Avg. bwd time: 24.6074 / Avg. batch time: 562.3940 (ms) / GPU bubble ratio: 51.89%
[rank0]:2025-11-11 17:52:08,595 - INFO - Avg. fwd time: 8.2106 / Avg. bwd time: 24.2634 / Avg. batch time: 599.9417 (ms) / GPU bubble ratio: 56.70%
[rank1]:2025-11-11 17:52:08,759 - INFO -  step: 650  loss: -8.0000  grad_norm:  0.1154  memory: 14.64GiB(30.82%)  tps: 6,648  tflops: 51.97  mfu: 16.66%
[rank0]:2025-11-11 17:52:08,771 - INFO -  step: 650  loss: -8.0000  grad_norm:  0.1154  memory: 16.57GiB(34.88%)  tps: 6,648  tflops: 51.97  mfu: 16.66%
[rank2]:2025-11-11 17:52:08,755 - INFO -  step: 650  loss: -8.0000  grad_norm:  0.1154  memory: 11.81GiB(24.85%)  tps: 6,648  tflops: 51.97  mfu: 16.66%
[rank3]:2025-11-11 17:52:08,768 - INFO -  step: 650  loss:  0.2261  grad_norm:  0.1154  memory: 26.98GiB(56.79%)  tps: 6,648  tflops: 51.97  mfu: 16.66%
[rank3]:2025-11-11 17:54:12,698 - INFO - Avg. fwd time: 10.7471 / Avg. bwd time: 43.2806 / Avg. batch time: 491.6897 (ms) / GPU bubble ratio: 12.09%
[rank2]:2025-11-11 17:54:12,729 - INFO - Avg. fwd time: 7.1361 / Avg. bwd time: 19.1015 / Avg. batch time: 523.1823 (ms) / GPU bubble ratio: 59.88%
[rank1]:2025-11-11 17:54:12,765 - INFO - Avg. fwd time: 9.2163 / Avg. bwd time: 24.6069 / Avg. batch time: 562.4478 (ms) / GPU bubble ratio: 51.89%
[rank0]:2025-11-11 17:54:12,802 - INFO - Avg. fwd time: 8.2095 / Avg. bwd time: 24.2637 / Avg. batch time: 599.9916 (ms) / GPU bubble ratio: 56.70%
[rank0]:2025-11-11 17:56:12,141 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-11 17:56:16,806 - INFO - Avg. fwd time: 10.7485 / Avg. bwd time: 43.2932 / Avg. batch time: 491.8021 (ms) / GPU bubble ratio: 12.09%
[rank0]:2025-11-11 17:56:16,927 - INFO - Avg. fwd time: 8.2092 / Avg. bwd time: 24.2641 / Avg. batch time: 600.0833 (ms) / GPU bubble ratio: 56.71%
[rank2]:2025-11-11 17:56:16,878 - INFO - Avg. fwd time: 7.1363 / Avg. bwd time: 19.1020 / Avg. batch time: 523.2862 (ms) / GPU bubble ratio: 59.89%
[rank1]:2025-11-11 17:56:16,918 - INFO - Avg. fwd time: 9.2165 / Avg. bwd time: 24.6064 / Avg. batch time: 562.5447 (ms) / GPU bubble ratio: 51.90%
[rank0]:2025-11-11 17:56:17,097 - INFO -  step: 700  loss: -8.0000  grad_norm:  0.1217  memory: 16.57GiB(34.88%)  tps: 6,598  tflops: 51.58  mfu: 16.53%
[rank2]:2025-11-11 17:56:17,081 - INFO -  step: 700  loss: -8.0000  grad_norm:  0.1217  memory: 11.81GiB(24.85%)  tps: 6,598  tflops: 51.58  mfu: 16.53%
[rank3]:2025-11-11 17:56:17,093 - INFO -  step: 700  loss:  0.1861  grad_norm:  0.1217  memory: 26.98GiB(56.79%)  tps: 6,598  tflops: 51.58  mfu: 16.53%
[rank1]:2025-11-11 17:56:17,085 - INFO -  step: 700  loss: -8.0000  grad_norm:  0.1217  memory: 14.64GiB(30.82%)  tps: 6,598  tflops: 51.58  mfu: 16.53%
[rank3]:2025-11-11 17:56:17,248 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_GPipe_nofreeze_42_dm1/pipeline_schedule/251111_1756_real_step700_rank3.svg
[rank3]:> Batch Time: 604.80 ms, GPU Bubble Ratio: 56.91%, 55.26%, 65.19%, 27.68%
[rank3]:2025-11-11 17:58:21,149 - INFO - Avg. fwd time: 10.7490 / Avg. bwd time: 43.3042 / Avg. batch time: 491.8951 (ms) / GPU bubble ratio: 12.09%
[rank0]:2025-11-11 17:58:21,267 - INFO - Avg. fwd time: 8.2081 / Avg. bwd time: 24.2650 / Avg. batch time: 600.1748 (ms) / GPU bubble ratio: 56.72%
[rank2]:2025-11-11 17:58:21,220 - INFO - Avg. fwd time: 7.1360 / Avg. bwd time: 19.1027 / Avg. batch time: 523.3897 (ms) / GPU bubble ratio: 59.89%
[rank1]:2025-11-11 17:58:21,261 - INFO - Avg. fwd time: 9.2162 / Avg. bwd time: 24.6066 / Avg. batch time: 562.6408 (ms) / GPU bubble ratio: 51.91%
[rank0]:2025-11-11 18:00:20,109 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-11 18:00:24,948 - INFO - Avg. fwd time: 10.7485 / Avg. bwd time: 43.3021 / Avg. batch time: 491.8735 (ms) / GPU bubble ratio: 12.09%
[rank2]:2025-11-11 18:00:24,980 - INFO - Avg. fwd time: 7.1359 / Avg. bwd time: 19.1028 / Avg. batch time: 523.3599 (ms) / GPU bubble ratio: 59.89%
[rank1]:2025-11-11 18:00:25,017 - INFO - Avg. fwd time: 9.2159 / Avg. bwd time: 24.6057 / Avg. batch time: 562.6053 (ms) / GPU bubble ratio: 51.91%
[rank0]:2025-11-11 18:00:25,053 - INFO - Avg. fwd time: 8.2074 / Avg. bwd time: 24.2653 / Avg. batch time: 600.1357 (ms) / GPU bubble ratio: 56.71%
[rank2]:2025-11-11 18:00:25,075 - INFO -  step: 750  loss: -8.0000  grad_norm:  0.1449  memory: 11.81GiB(24.85%)  tps: 6,607  tflops: 51.65  mfu: 16.55%
[rank1]:2025-11-11 18:00:25,079 - INFO -  step: 750  loss: -8.0000  grad_norm:  0.1449  memory: 14.64GiB(30.82%)  tps: 6,607  tflops: 51.65  mfu: 16.55%
[rank0]:2025-11-11 18:00:25,090 - INFO -  step: 750  loss: -8.0000  grad_norm:  0.1449  memory: 16.57GiB(34.88%)  tps: 6,607  tflops: 51.65  mfu: 16.55%
[rank3]:2025-11-11 18:00:25,089 - INFO -  step: 750  loss:  0.2247  grad_norm:  0.1449  memory: 26.98GiB(56.79%)  tps: 6,607  tflops: 51.65  mfu: 16.55%
[rank3]:2025-11-11 18:02:27,475 - INFO - Avg. fwd time: 10.7464 / Avg. bwd time: 43.2851 / Avg. batch time: 491.7187 (ms) / GPU bubble ratio: 12.09%
[rank0]:2025-11-11 18:02:27,591 - INFO - Avg. fwd time: 8.2065 / Avg. bwd time: 24.2649 / Avg. batch time: 599.9671 (ms) / GPU bubble ratio: 56.70%
[rank1]:2025-11-11 18:02:27,585 - INFO - Avg. fwd time: 9.2151 / Avg. bwd time: 24.6055 / Avg. batch time: 562.4398 (ms) / GPU bubble ratio: 51.89%
[rank2]:2025-11-11 18:02:27,544 - INFO - Avg. fwd time: 7.1354 / Avg. bwd time: 19.1021 / Avg. batch time: 523.1965 (ms) / GPU bubble ratio: 59.88%
[rank0]:2025-11-11 18:04:26,258 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-11 18:04:30,980 - INFO - Avg. fwd time: 10.7460 / Avg. bwd time: 43.2789 / Avg. batch time: 491.6655 (ms) / GPU bubble ratio: 12.09%
[rank1]:2025-11-11 18:04:31,096 - INFO - Avg. fwd time: 9.2148 / Avg. bwd time: 24.6050 / Avg. batch time: 562.3745 (ms) / GPU bubble ratio: 51.89%
[rank0]:2025-11-11 18:04:31,103 - INFO - Avg. fwd time: 8.2057 / Avg. bwd time: 24.2649 / Avg. batch time: 599.8985 (ms) / GPU bubble ratio: 56.70%
[rank2]:2025-11-11 18:04:31,054 - INFO - Avg. fwd time: 7.1352 / Avg. bwd time: 19.1017 / Avg. batch time: 523.1346 (ms) / GPU bubble ratio: 59.88%
[rank0]:2025-11-11 18:04:31,274 - INFO -  step: 800  loss: -8.0000  grad_norm:  0.1349  memory: 16.57GiB(34.88%)  tps: 6,655  tflops: 52.03  mfu: 16.68%
[rank0]:2025-11-11 18:04:31,274 - INFO -  final step: 800  loss: -8.0000  grad_norm:  0.1349  tps: 7,021  tflops: 54.88  mfu: 16.13%
[rank1]:2025-11-11 18:04:31,262 - INFO -  step: 800  loss: -8.0000  grad_norm:  0.1349  memory: 14.64GiB(30.82%)  tps: 6,655  tflops: 52.03  mfu: 16.68%
[rank1]:2025-11-11 18:04:31,263 - INFO -  final step: 800  loss: -8.0000  grad_norm:  0.1349  tps: 7,019  tflops: 54.87  mfu: 16.08%
[rank0]:2025-11-11 18:04:31,274 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-11-11 18:04:31,263 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-11 18:04:31,275 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank1]:2025-11-11 18:04:31,263 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank2]:2025-11-11 18:04:31,259 - INFO -  step: 800  loss: -8.0000  grad_norm:  0.1349  memory: 11.81GiB(24.85%)  tps: 6,655  tflops: 52.03  mfu: 16.68%
[rank2]:2025-11-11 18:04:31,259 - INFO -  final step: 800  loss: -8.0000  grad_norm:  0.1349  tps: 7,019  tflops: 54.87  mfu: 16.09%
[rank2]:2025-11-11 18:04:31,259 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-11 18:04:31,260 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank3]:2025-11-11 18:04:31,271 - INFO -  step: 800  loss:  0.2297  grad_norm:  0.1349  memory: 26.98GiB(56.79%)  tps: 6,655  tflops: 52.03  mfu: 16.68%
[rank3]:2025-11-11 18:04:31,272 - INFO -  final step: 800  loss:  0.2297  grad_norm:  0.1349  tps: 7,022  tflops: 54.90  mfu: 16.20%
[rank3]:2025-11-11 18:04:31,272 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-11-11 18:04:31,273 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-11-11 18:04:33,573 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-11-11 18:04:33,596 - INFO - Sleeping 2 seconds for other ranks to complete
[rank2]:2025-11-11 18:04:33,596 - INFO - Destroying the purge thread.
[rank1]:2025-11-11 18:04:33,596 - INFO - Destroying the purge thread.
[rank3]:2025-11-11 18:04:33,746 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_GPipe_nofreeze_42_dm1/pipeline_schedule/251111_1804_real_final800_rank3.svg
[rank3]:> Batch Time: 599.80 ms, GPU Bubble Ratio: 56.58%, 54.90%, 64.95%, 28.01%
[rank3]:2025-11-11 18:04:33,894 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_GPipe_nofreeze_42_dm1/pipeline_schedule/251111_1804_thry_final800_rank3.svg
[rank3]:> Batch Time: 290.97 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:2025-11-11 18:04:33,895 - INFO - Destroying the purge thread.
[rank2]:2025-11-11 18:04:34,024 - INFO - Process group destroyed
[rank3]:wandb: updating run metadata
[rank1]:2025-11-11 18:04:34,072 - INFO - Process group destroyed
[rank3]:wandb: uploading output.log; uploading wandb-summary.json; uploading config.yaml
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–ˆâ–†â–ƒâ–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–ˆâ–†â–ƒâ–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 4.6662
[rank3]:wandb:               final/avg_loss 0.22975
[rank3]:wandb:             final/avg_mfu(%) 16.19591
[rank3]:wandb:             final/avg_tflops 54.89797
[rank3]:wandb:    final/avg_throughput(tps) 7022.41022
[rank3]:wandb:              final/grad_norm 0.13494
[rank3]:wandb:               final/max_loss 0.22975
[rank3]:wandb:                    grad_norm 0.13494
[rank3]:wandb: loss_metrics/global_avg_loss 0.22975
[rank3]:wandb: loss_metrics/global_max_loss 0.22975
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1109_GPipe_nofreeze_42_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/ixg5jtdz
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1109_GPipe_nofreeze_42_dm1/20251111-1658/wandb/run-20251111_165823-ixg5jtdz/logs
[rank0]:2025-11-11 18:04:35,596 - INFO - Training completed
[rank0]:2025-11-11 18:04:35,597 - INFO - Destroying the purge thread.
[rank3]:2025-11-11 18:04:36,009 - INFO - Process group destroyed
[rank0]:2025-11-11 18:04:36,081 - INFO - Process group destroyed
[rank1]:Stage 1: Modules to keep: {'layers.8', 'layers.6', 'layers.7', 'layers.5', 'layers.4'}
[rank2]:Stage 2: Modules to keep: {'layers.9', 'layers.11', 'layers.10', 'layers.12'}
[rank0]:Stage 0: Modules to keep: {'layers.1', 'layers.3', 'layers.2', 'tok_embeddings', 'layers.0'}
[rank3]:Stage 3: Modules to keep: {'output', 'norm', 'layers.14', 'layers.13', 'layers.15'}
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1109.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1109_GPipe_nofreeze_42_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1109_GPipe_nofreeze_42_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1109_GPipe_nofreeze_42_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1109_GPipe_nofreeze_42_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1109_GPipe_nofreeze_42_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1109_GPipe_nofreeze_42_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 42
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: GPipe
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1109_GPipe_nofreeze_42_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1109_GPipe_nofreeze_42_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: False
[rank3]:		- metric_type: apf
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.05
[rank3]:		- percentile: 80
[rank3]:
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
