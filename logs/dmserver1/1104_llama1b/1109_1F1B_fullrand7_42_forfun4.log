
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 11. 27. (ëª©) 10:27:25 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 0,1,2,3
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/1109_1F1B_fullrand7_42_forfun.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset

âœ”ï¸Running with fullrand7 x 1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1109.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=fullrand7 --freezing.threshold=0.01 --freezing.percentile=80 --freezing.max_freeze_ratio=0.8
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank3]:2025-11-27 10:27:32,121 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:"
[rank2]:2025-11-27 10:27:32,120 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank2]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank2]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank2]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank2]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank2]:"
[rank0]:2025-11-27 10:27:32,307 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank0]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank0]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank0]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank0]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank0]:"
[rank3]:2025-11-27 10:27:32,337 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-11-27 10:27:32,340 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-11-27 10:27:32,330 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank1]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank1]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank1]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank1]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank1]:"
[rank2]:2025-11-27 10:27:32,326 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-11-27 10:27:32,329 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-27 10:27:32,522 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-11-27 10:27:32,525 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-27 10:27:32,529 - INFO - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-11-27 10:27:32,530 - INFO - Loading tokenizer from tokenizer.json
[rank1]:2025-11-27 10:27:32,540 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-11-27 10:27:32,542 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-27 10:27:32,906 - INFO - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank2]:2025-11-27 10:27:35,772 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-11-27 10:27:35,812 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-11-27 10:27:35,839 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-11-27 10:27:35,839 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank2]:2025-11-27 10:27:36,016 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-11-27 10:27:36,016 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-11-27 10:27:36,017 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank0]:2025-11-27 10:27:36,076 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank0]:2025-11-27 10:27:36,227 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-11-27 10:27:36,265 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-27 10:27:36,266 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-11-27 10:27:36,292 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-11-27 10:27:36,292 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2025-11-27 10:27:36,270 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-11-27 10:27:36,310 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-11-27 10:27:36,343 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-11-27 10:27:36,344 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2025-11-27 10:27:36,487 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-27 10:27:36,487 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-11-27 10:27:36,488 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank1]:2025-11-27 10:27:36,538 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-11-27 10:27:36,538 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-11-27 10:27:36,539 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run 4s2k7zn5
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1109_1F1B_fullrand7_42_forfun_dm1/20251127-1027/wandb/run-20251127_102736-4s2k7zn5
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1109_1F1B_fullrand7_42_forfun_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/4s2k7zn5
[rank3]:2025-11-27 10:27:38,196 - INFO - WandB logging enabled
[rank3]:2025-11-27 10:27:38,196 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-11-27 10:27:38,237 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-11-27 10:27:38,265 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-11-27 10:27:38,266 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2025-11-27 10:27:38,469 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1109_1F1B_fullrand7_42_forfun_dm1
[rank0]:2025-11-27 10:27:38,469 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-27 10:27:38,470 - INFO - Trainer is initialized with local batch size 32, global batch size 128, gradient accumulation steps 4, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2025-11-27 10:27:38,470 - WARNING - checkpoint.initial_load_path is provided but the checkpoint.folder exists. Checkpointer will use the checkpoints from the checkpoint.folder /data2/shcho/torchtitan/checkpoint/1109_1F1B_fullrand7_42_forfun_dm1.
[rank0]:2025-11-27 10:27:38,471 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/checkpoint/1109_1F1B_fullrand7_42_forfun_dm1/step-800.
[rank3]:2025-11-27 10:27:38,451 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-11-27 10:27:38,469 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-11-27 10:27:38,452 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-11-27 10:27:38,452 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2025-11-27 10:27:38,468 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank1]:2025-11-27 10:27:38,469 - WARNING - checkpoint.initial_load_path is provided but the checkpoint.folder exists. Checkpointer will use the checkpoints from the checkpoint.folder /data2/shcho/torchtitan/checkpoint/1109_1F1B_fullrand7_42_forfun_dm1.
[rank3]:2025-11-27 10:27:38,469 - WARNING - checkpoint.initial_load_path is provided but the checkpoint.folder exists. Checkpointer will use the checkpoints from the checkpoint.folder /data2/shcho/torchtitan/checkpoint/1109_1F1B_fullrand7_42_forfun_dm1.
[rank2]:2025-11-27 10:27:38,468 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank2]:2025-11-27 10:27:38,469 - WARNING - checkpoint.initial_load_path is provided but the checkpoint.folder exists. Checkpointer will use the checkpoints from the checkpoint.folder /data2/shcho/torchtitan/checkpoint/1109_1F1B_fullrand7_42_forfun_dm1.
[rank0]:2025-11-27 10:27:40,728 - INFO - [GC] GC collection for checkpoint loading. 0.01 seconds
[rank0]:2025-11-27 10:27:40,728 - INFO - Finished loading the checkpoint in 2.26 seconds.
[rank0]:2025-11-27 10:27:40,728 - INFO - Training starts at step 1
[rank0]:2025-11-27 10:27:45,945 - INFO -  step:  1  loss: -4.0000  grad_norm:  8.9257  memory: 13.10GiB(27.57%)  tps: 3,385  tflops: 26.46  mfu: 8.48%
[rank0]:2025-11-27 10:27:45,945 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-11-27 10:27:45,908 - INFO -  step:  1  loss: -4.0000  grad_norm:  8.9257  memory:  6.84GiB(14.41%)  tps: 3,246  tflops: 25.37  mfu: 8.13%
[rank2]:2025-11-27 10:27:45,908 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-11-27 10:27:45,912 - INFO -  step:  1  loss: -4.0000  grad_norm:  8.9257  memory: 10.58GiB(22.26%)  tps: 3,413  tflops: 26.68  mfu: 8.55%
[rank1]:2025-11-27 10:27:45,912 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-11-27 10:27:45,917 - INFO -  step:  1  loss:  0.5334  grad_norm:  8.9257  memory: 21.88GiB(46.05%)  tps: 4,268  tflops: 33.36  mfu: 10.69%
[rank3]:2025-11-27 10:27:45,918 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-27 10:31:41,520 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-27 10:31:45,979 - INFO - Avg. fwd time: 15.2219 / Avg. bwd time: 35.6273 / Avg. batch time: 1062.8449 (ms) / GPU bubble ratio: 61.73%
[rank3]:2025-11-27 10:31:45,914 - INFO - Avg. fwd time: 25.1690 / Avg. bwd time: 82.1295 / Avg. batch time: 1004.0269 (ms) / GPU bubble ratio: 14.51%
[rank0]:2025-11-27 10:31:46,056 - INFO - Avg. fwd time: 15.2244 / Avg. bwd time: 39.7542 / Avg. batch time: 1198.6809 (ms) / GPU bubble ratio: 63.31%
[rank1]:2025-11-27 10:31:46,104 - INFO - Avg. fwd time: 19.6422 / Avg. bwd time: 45.2674 / Avg. batch time: 1135.1720 (ms) / GPU bubble ratio: 54.26%
[rank1]:2025-11-27 10:31:46,464 - INFO -  step: 50  loss: -4.0000  grad_norm:  5.6316  memory: 12.86GiB(27.07%)  tps: 6,675  tflops: 52.18  mfu: 16.72%
[rank2]:2025-11-27 10:31:46,460 - INFO -  step: 50  loss: -4.0000  grad_norm:  5.6316  memory:  8.66GiB(18.23%)  tps: 6,675  tflops: 52.18  mfu: 16.72%
[rank0]:2025-11-27 10:31:46,477 - INFO -  step: 50  loss: -4.0000  grad_norm:  5.6316  memory: 16.87GiB(35.50%)  tps: 6,675  tflops: 52.18  mfu: 16.73%
[rank3]:2025-11-27 10:31:46,473 - INFO -  step: 50  loss:  0.4122  grad_norm:  5.6316  memory: 25.79GiB(54.28%)  tps: 6,675  tflops: 52.18  mfu: 16.72%
[rank3]:2025-11-27 10:32:35,913 - INFO - [Step 60] ã€°ï¸ Monitoring Upperbound
[rank3]:2025-11-27 10:33:25,287 - INFO - [Step 70] âœ”ï¸  Setting Upperbound
[rank0]:2025-11-27 10:33:25,883 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-27 10:33:25,910 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-27 10:33:25,881 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-27 10:33:25,913 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-27 10:33:25,874 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-27 10:33:25,902 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-27 10:33:25,847 - INFO - [Step 70] ã€°ï¸ Monitoring Lowerbound
[rank3]:2025-11-27 10:33:25,869 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-27 10:33:25,894 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-27 10:33:25,912 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-27 10:33:25,933 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-27 10:33:25,935 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-27 10:33:25,945 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-27 10:33:25,931 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-27 10:33:26,013 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-27 10:33:26,056 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-27 10:33:26,101 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-27 10:33:26,102 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-27 10:33:26,171 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-27 10:33:26,151 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-27 10:33:26,190 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-27 10:33:26,198 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-27 10:33:26,268 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-27 10:33:26,269 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-27 10:33:26,270 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-27 10:33:26,270 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-27 10:33:26,240 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-27 10:33:26,310 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-27 10:33:26,272 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-27 10:33:26,281 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-27 10:33:26,341 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-27 10:33:26,380 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-27 10:33:26,342 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-27 10:34:35,481 - INFO - [Step 90] âœ”ï¸  Setting Lowerbound
[rank3]:2025-11-27 10:34:35,691 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/pipeline_schedule/251127_1034_max_batch_time.svg
[rank3]:			> Batch Time: 1059.06 ms, GPU Bubble Ratio: 58.05%, 50.26%, 61.31%, 16.42%
[rank3]:	[Rank 0]	[S0,MB0,FORWARD] 0-16-16ms | [S0,MB1,FORWARD] 16-15-31ms | [S0,MB2,FORWARD] 31-16-47ms | [S0,MB3,FORWARD] 47-15-63ms | [S0,MB0,FULL_BACKWARD] 239-40-280ms | [S0,MB4,FORWARD] 280-14-295ms | [S0,MB1,FULL_BACKWARD] 347-40-387ms | [S0,MB5,FORWARD] 387-14-402ms | [S0,MB2,FULL_BACKWARD] 459-40-499ms | [S0,MB6,FORWARD] 499-15-514ms | [S0,MB3,FULL_BACKWARD] 571-40-611ms | [S0,MB7,FORWARD] 611-14-626ms | [S0,MB4,FULL_BACKWARD] 683-40-723ms | [S0,MB5,FULL_BACKWARD] 795-39-835ms | [S0,MB6,FULL_BACKWARD] 907-40-947ms | [S0,MB7,FULL_BACKWARD] 1019-39-1059ms | 
[rank3]:	[Rank 1]	[S1,MB0,FORWARD] 16-20-36ms | [S1,MB1,FORWARD] 36-18-54ms | [S1,MB2,FORWARD] 54-18-73ms | [S1,MB0,FULL_BACKWARD] 192-46-239ms | [S1,MB3,FORWARD] 239-19-259ms | [S1,MB1,FULL_BACKWARD] 301-45-347ms | [S1,MB4,FORWARD] 347-20-367ms | [S1,MB2,FULL_BACKWARD] 413-46-459ms | [S1,MB5,FORWARD] 459-20-480ms | [S1,MB3,FULL_BACKWARD] 525-45-571ms | [S1,MB6,FORWARD] 571-20-591ms | [S1,MB4,FULL_BACKWARD] 637-45-683ms | [S1,MB7,FORWARD] 683-21-704ms | [S1,MB5,FULL_BACKWARD] 749-45-795ms | [S1,MB6,FULL_BACKWARD] 861-45-907ms | [S1,MB7,FULL_BACKWARD] 973-45-1019ms | 
[rank3]:	[Rank 2]	[S2,MB0,FORWARD] 36-16-52ms | [S2,MB1,FORWARD] 54-14-69ms | [S2,MB0,FULL_BACKWARD] 156-36-192ms | [S2,MB2,FORWARD] 192-14-207ms | [S2,MB1,FULL_BACKWARD] 266-35-301ms | [S2,MB3,FORWARD] 301-15-317ms | [S2,MB2,FULL_BACKWARD] 377-35-413ms | [S2,MB4,FORWARD] 413-15-428ms | [S2,MB3,FULL_BACKWARD] 489-35-525ms | [S2,MB5,FORWARD] 525-15-540ms | [S2,MB4,FULL_BACKWARD] 602-35-637ms | [S2,MB6,FORWARD] 637-15-653ms | [S2,MB5,FULL_BACKWARD] 713-35-749ms | [S2,MB7,FORWARD] 749-15-765ms | [S2,MB6,FULL_BACKWARD] 825-35-861ms | [S2,MB7,FULL_BACKWARD] 937-35-973ms | 
[rank3]:	[Rank 3]	[S3,MB0,FORWARD] 52-24-76ms | [S3,MB0,FULL_BACKWARD] 76-79-156ms AFR(10):0.9655 | [S3,MB1,FORWARD] 156-25-181ms | [S3,MB1,FULL_BACKWARD] 181-84-266ms AFR(10):0.9655 | [S3,MB2,FORWARD] 266-26-292ms | [S3,MB2,FULL_BACKWARD] 292-85-377ms AFR(10):0.9655 | [S3,MB3,FORWARD] 377-26-403ms | [S3,MB3,FULL_BACKWARD] 403-85-489ms AFR(10):0.9655 | [S3,MB4,FORWARD] 489-26-516ms | [S3,MB4,FULL_BACKWARD] 516-85-602ms AFR(10):0.9655 | [S3,MB5,FORWARD] 602-26-628ms | [S3,MB5,FULL_BACKWARD] 628-85-713ms AFR(10):0.9655 | [S3,MB6,FORWARD] 713-26-740ms | [S3,MB6,FULL_BACKWARD] 740-85-825ms AFR(10):0.9655 | [S3,MB7,FORWARD] 825-26-852ms | [S3,MB7,FULL_BACKWARD] 852-85-937ms AFR(10):0.9655 | 
[rank3]:2025-11-27 10:34:35,832 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/pipeline_schedule/251127_1034_min_batch_time.svg
[rank3]:			> Batch Time: 662.96 ms, GPU Bubble Ratio: 81.47%, 47.55%, 59.14%, 14.25%
[rank3]:	[Rank 0]	[S0,MB0,FORWARD] 0-16-16ms | [S0,MB1,FORWARD] 16-15-31ms | [S0,MB2,FORWARD] 31-16-47ms | [S0,MB3,FORWARD] 47-15-63ms | [S0,MB0,FULL_BACKWARD] 162-0-162ms | [S0,MB4,FORWARD] 162-14-176ms | [S0,MB1,FULL_BACKWARD] 232-0-232ms | [S0,MB5,FORWARD] 232-14-247ms | [S0,MB2,FULL_BACKWARD] 304-0-304ms | [S0,MB6,FORWARD] 304-15-319ms | [S0,MB3,FULL_BACKWARD] 376-0-376ms | [S0,MB7,FORWARD] 376-14-390ms | [S0,MB4,FULL_BACKWARD] 447-0-447ms | [S0,MB5,FULL_BACKWARD] 520-0-520ms | [S0,MB6,FULL_BACKWARD] 591-0-591ms | [S0,MB7,FULL_BACKWARD] 662-0-662ms | 
[rank3]:	[Rank 1]	[S1,MB0,FORWARD] 16-20-36ms | [S1,MB1,FORWARD] 36-18-54ms | [S1,MB2,FORWARD] 54-18-73ms | [S1,MB0,FULL_BACKWARD] 139-23-162ms | [S1,MB3,FORWARD] 162-19-182ms | [S1,MB1,FULL_BACKWARD] 209-23-232ms | [S1,MB4,FORWARD] 232-20-253ms | [S1,MB2,FULL_BACKWARD] 280-23-304ms | [S1,MB5,FORWARD] 304-20-325ms | [S1,MB3,FULL_BACKWARD] 352-23-376ms | [S1,MB6,FORWARD] 376-20-396ms | [S1,MB4,FULL_BACKWARD] 424-23-447ms | [S1,MB7,FORWARD] 447-21-468ms | [S1,MB5,FULL_BACKWARD] 496-23-520ms | [S1,MB6,FULL_BACKWARD] 568-23-591ms | [S1,MB7,FULL_BACKWARD] 639-23-662ms | 
[rank3]:	[Rank 2]	[S2,MB0,FORWARD] 36-16-52ms | [S2,MB1,FORWARD] 54-14-69ms | [S2,MB0,FULL_BACKWARD] 120-18-139ms | [S2,MB2,FORWARD] 139-14-153ms | [S2,MB1,FULL_BACKWARD] 190-18-209ms | [S2,MB3,FORWARD] 209-15-224ms | [S2,MB2,FULL_BACKWARD] 261-18-280ms | [S2,MB4,FORWARD] 280-15-295ms | [S2,MB3,FULL_BACKWARD] 333-18-352ms | [S2,MB5,FORWARD] 352-15-367ms | [S2,MB4,FULL_BACKWARD] 405-18-424ms | [S2,MB6,FORWARD] 424-15-439ms | [S2,MB5,FULL_BACKWARD] 477-18-496ms | [S2,MB7,FORWARD] 496-15-512ms | [S2,MB6,FULL_BACKWARD] 549-18-568ms | [S2,MB7,FULL_BACKWARD] 621-18-639ms | 
[rank3]:	[Rank 3]	[S3,MB0,FORWARD] 52-24-76ms | [S3,MB0,FULL_BACKWARD] 76-43-120ms AFR(10):0.9655 | [S3,MB1,FORWARD] 120-25-145ms | [S3,MB1,FULL_BACKWARD] 145-44-190ms AFR(10):0.9655 | [S3,MB2,FORWARD] 190-26-216ms | [S3,MB2,FULL_BACKWARD] 216-45-261ms AFR(10):0.9655 | [S3,MB3,FORWARD] 261-26-288ms | [S3,MB3,FULL_BACKWARD] 288-45-333ms AFR(10):0.9655 | [S3,MB4,FORWARD] 333-26-360ms | [S3,MB4,FULL_BACKWARD] 360-45-405ms AFR(10):0.9655 | [S3,MB5,FORWARD] 405-26-431ms | [S3,MB5,FULL_BACKWARD] 431-46-477ms AFR(10):0.9655 | [S3,MB6,FORWARD] 477-26-504ms | [S3,MB6,FULL_BACKWARD] 504-45-549ms AFR(10):0.9655 | [S3,MB7,FORWARD] 549-26-576ms | [S3,MB7,FULL_BACKWARD] 576-44-621ms AFR(10):0.9655 | 
[rank3]:2025-11-27 10:34:48,010 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/pipeline_schedule/251127_1034_frozen_pipeline_schedule.svg
[rank3]:			> Batch Time: 722.39 ms, GPU Bubble Ratio: 58.90%, 31.36%, 45.66%, 13.08%
[rank3]:	[Rank 0]	[S0,MB0,FORWARD] 0-16-16ms | [S0,MB1,FORWARD] 16-15-31ms | [S0,MB2,FORWARD] 31-16-47ms | [S0,MB3,FORWARD] 47-15-63ms | [S0,MB0,FULL_BACKWARD] 235-24-260ms | [S0,MB4,FORWARD] 260-14-274ms | [S0,MB1,FULL_BACKWARD] 307-24-332ms | [S0,MB5,FORWARD] 332-14-347ms | [S0,MB2,FULL_BACKWARD] 377-24-402ms | [S0,MB6,FORWARD] 402-15-417ms | [S0,MB3,FULL_BACKWARD] 450-24-475ms | [S0,MB7,FORWARD] 475-14-490ms | [S0,MB4,FULL_BACKWARD] 522-24-547ms | [S0,MB5,FULL_BACKWARD] 617-25-642ms | [S0,MB6,FULL_BACKWARD] 689-24-714ms | [S0,MB7,FULL_BACKWARD] 722-0-722ms | 
[rank3]:	[Rank 1]	[S1,MB0,FORWARD] 16-20-36ms | [S1,MB1,FORWARD] 36-18-54ms | [S1,MB2,FORWARD] 54-18-73ms | [S1,MB0,FULL_BACKWARD] 192-43-235ms | [S1,MB3,FORWARD] 235-19-255ms | [S1,MB1,FULL_BACKWARD] 262-45-307ms | [S1,MB4,FORWARD] 307-20-328ms | [S1,MB2,FULL_BACKWARD] 333-44-377ms | [S1,MB5,FORWARD] 377-20-398ms | [S1,MB3,FULL_BACKWARD] 405-45-450ms | [S1,MB6,FORWARD] 450-20-471ms | [S1,MB4,FULL_BACKWARD] 477-44-522ms | [S1,MB7,FORWARD] 522-21-543ms | [S1,MB5,FULL_BACKWARD] 573-44-617ms | [S1,MB6,FULL_BACKWARD] 644-44-689ms | [S1,MB7,FULL_BACKWARD] 699-23-722ms | 
[rank3]:	[Rank 2]	[S2,MB0,FORWARD] 36-16-52ms | [S2,MB1,FORWARD] 54-14-69ms | [S2,MB0,FULL_BACKWARD] 156-36-192ms | [S2,MB2,FORWARD] 192-14-207ms | [S2,MB1,FULL_BACKWARD] 226-35-262ms | [S2,MB3,FORWARD] 262-15-277ms | [S2,MB2,FULL_BACKWARD] 297-35-333ms | [S2,MB4,FORWARD] 333-15-348ms | [S2,MB3,FULL_BACKWARD] 369-35-405ms | [S2,MB5,FORWARD] 405-15-420ms | [S2,MB4,FULL_BACKWARD] 441-35-477ms | [S2,MB6,FORWARD] 477-15-492ms | [S2,MB5,FULL_BACKWARD] 537-35-573ms | [S2,MB7,FORWARD] 573-15-588ms | [S2,MB6,FULL_BACKWARD] 608-35-644ms | [S2,MB7,FULL_BACKWARD] 680-18-699ms | 
[rank3]:	[Rank 3]	[S3,MB0,FORWARD] 52-24-76ms | [S3,MB0,FULL_BACKWARD] 76-79-156ms AFR(10):0.9655 | [S3,MB1,FORWARD] 156-25-181ms | [S3,MB1,FULL_BACKWARD] 181-44-226ms AFR(10):0.9655 | [S3,MB2,FORWARD] 226-26-252ms | [S3,MB2,FULL_BACKWARD] 252-45-297ms AFR(10):0.9655 | [S3,MB3,FORWARD] 297-26-323ms | [S3,MB3,FULL_BACKWARD] 323-45-369ms AFR(10):0.9655 | [S3,MB4,FORWARD] 369-26-396ms | [S3,MB4,FULL_BACKWARD] 396-45-441ms AFR(10):0.9655 | [S3,MB5,FORWARD] 441-26-467ms | [S3,MB5,FULL_BACKWARD] 467-69-537ms AFR(10):0.9655 | [S3,MB6,FORWARD] 537-26-563ms | [S3,MB6,FULL_BACKWARD] 563-45-608ms AFR(10):0.9655 | [S3,MB7,FORWARD] 608-26-635ms | [S3,MB7,FULL_BACKWARD] 635-44-680ms AFR(10):0.9655 | 
[rank3]:2025-11-27 10:34:48,011 - INFO - 	> Batch Time: 722.39 ms (Average Freeze Ratio: 0.39, Time Reduction Rate: 0.32)
[rank0]:2025-11-27 10:35:22,588 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-27 10:35:25,922 - INFO - Avg. fwd time: 15.4856 / Avg. bwd time: 29.6949 / Avg. batch time: 1114.6116 (ms) / GPU bubble ratio: 67.57%
[rank3]:2025-11-27 10:35:25,934 - INFO - Avg. fwd time: 26.3897 / Avg. bwd time: 72.3981 / Avg. batch time: 936.4695 (ms) / GPU bubble ratio: 15.61%
[rank2]:2025-11-27 10:35:26,069 - INFO - Avg. fwd time: 15.4358 / Avg. bwd time: 31.8599 / Avg. batch time: 991.7575 (ms) / GPU bubble ratio: 61.85%
[rank1]:2025-11-27 10:35:26,135 - INFO - Avg. fwd time: 19.9993 / Avg. bwd time: 40.2768 / Avg. batch time: 1060.6952 (ms) / GPU bubble ratio: 54.54%
[rank2]:2025-11-27 10:35:26,344 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(0.33)/1.00
[rank3]:2025-11-27 10:35:26,326 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 1.00(0.33)/1.00, [MB2] 1.00(0.33)/1.00, [MB3] 1.00(0.33)/1.00, [MB4] 1.00(0.33)/1.00, [MB5] 0.41(0.13)/0.40, [MB6] 1.00(0.33)/1.00, [MB7] 1.00(0.33)/1.00
[rank0]:2025-11-27 10:35:26,415 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.41(0.13)/0.40, [MB1] 0.38(0.13)/0.38, [MB2] 0.38(0.13)/0.38, [MB3] 0.38(0.13)/0.38, [MB4] 0.38(0.13)/0.38, [MB5] 0.38(0.12)/0.37, [MB6] 0.38(0.13)/0.38, [MB7] 1.00(0.33)/1.00
[rank0]:2025-11-27 10:35:26,427 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.0913  memory: 16.87GiB(35.50%)  tps: 7,449  tflops: 58.23  mfu: 18.66%
[rank1]:2025-11-27 10:35:26,389 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.16(0.05)/0.15, [MB1] 0.00(0.00)/0.00, [MB2] 0.07(0.03)/0.08, [MB3] 0.02(0.01)/0.03, [MB4] 0.04(0.01)/0.04, [MB5] 0.07(0.02)/0.06, [MB6] 0.02(0.01)/0.03, [MB7] 1.00(0.33)/1.00
[rank1]:2025-11-27 10:35:26,432 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.0913  memory: 12.90GiB(27.15%)  tps: 7,448  tflops: 58.23  mfu: 18.66%
[rank2]:2025-11-27 10:35:26,428 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.0913  memory:  8.70GiB(18.31%)  tps: 7,448  tflops: 58.23  mfu: 18.66%
[rank2]:2025-11-27 10:35:26,489 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/frozen_ratio_history/rank2/251127_1035_stage2_step100.svg
[rank3]:2025-11-27 10:35:26,416 - INFO -  step: 100  loss:  0.3255  grad_norm:  0.0000  memory: 25.79GiB(54.28%)  tps: 7,449  tflops: 58.23  mfu: 18.67%
[rank0]:2025-11-27 10:35:26,490 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/frozen_ratio_history/rank0/251127_1035_stage0_step100.svg
[rank1]:2025-11-27 10:35:26,489 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/frozen_ratio_history/rank1/251127_1035_stage1_step100.svg
[rank3]:2025-11-27 10:35:26,573 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/pipeline_schedule/251127_1035_real_step100_rank3.svg
[rank3]:			> Batch Time: 933.64 ms, GPU Bubble Ratio: 74.80%, 52.16%, 60.16%, 33.69%
[rank3]:	[Rank 0]	[S0,MB0,FORWARD] 0-16-16ms | [S0,MB1,FORWARD] 16-17-33ms | [S0,MB2,FORWARD] 33-17-50ms | [S0,MB3,FORWARD] 50-16-67ms | [S0,MB0,FULL_BACKWARD] 204-0-204ms | [S0,MB4,FORWARD] 204-15-219ms | [S0,MB1,FULL_BACKWARD] 324-0-324ms | [S0,MB5,FORWARD] 325-14-339ms | [S0,MB2,FULL_BACKWARD] 433-0-433ms | [S0,MB6,FORWARD] 433-14-448ms | [S0,MB3,FULL_BACKWARD] 549-0-549ms | [S0,MB7,FORWARD] 549-14-563ms | [S0,MB4,FULL_BACKWARD] 645-26-671ms | [S0,MB5,FULL_BACKWARD] 735-27-762ms | [S0,MB6,FULL_BACKWARD] 827-26-854ms | [S0,MB7,FULL_BACKWARD] 906-27-933ms | 
[rank3]:	[Rank 1]	[S1,MB0,FORWARD] 16-20-36ms | [S1,MB1,FORWARD] 42-20-63ms | [S1,MB2,FORWARD] 69-20-90ms | [S1,MB0,FULL_BACKWARD] 170-23-193ms | [S1,MB3,FORWARD] 200-20-221ms | [S1,MB1,FULL_BACKWARD] 290-23-314ms | [S1,MB4,FORWARD] 321-19-340ms | [S1,MB2,FULL_BACKWARD] 399-23-423ms | [S1,MB5,FORWARD] 430-19-449ms | [S1,MB3,FULL_BACKWARD] 492-40-532ms | [S1,MB6,FORWARD] 545-19-565ms | [S1,MB4,FULL_BACKWARD] 588-45-633ms | [S1,MB7,FORWARD] 642-20-662ms | [S1,MB5,FULL_BACKWARD] 679-44-723ms | [S1,MB6,FULL_BACKWARD] 773-45-818ms | [S1,MB7,FULL_BACKWARD] 859-40-899ms | 
[rank3]:	[Rank 2]	[S2,MB0,FORWARD] 36-16-52ms | [S2,MB1,FORWARD] 63-16-79ms | [S2,MB0,FULL_BACKWARD] 141-18-160ms | [S2,MB2,FORWARD] 167-16-183ms | [S2,MB1,FULL_BACKWARD] 261-18-280ms | [S2,MB3,FORWARD] 287-14-302ms | [S2,MB2,FULL_BACKWARD] 354-33-388ms | [S2,MB4,FORWARD] 396-15-412ms | [S2,MB3,FULL_BACKWARD] 446-35-482ms | [S2,MB5,FORWARD] 489-15-505ms | [S2,MB4,FULL_BACKWARD] 542-35-578ms | [S2,MB6,FORWARD] 585-16-601ms | [S2,MB5,FULL_BACKWARD] 633-35-668ms | [S2,MB7,FORWARD] 676-15-691ms | [S2,MB6,FULL_BACKWARD] 731-35-766ms | [S2,MB7,FULL_BACKWARD] 820-32-853ms | 
[rank3]:	[Rank 3]	[S3,MB0,FORWARD] 52-24-76ms | [S3,MB0,FULL_BACKWARD] 88-42-131ms | [S3,MB1,FORWARD] 138-28-166ms | [S3,MB1,FULL_BACKWARD] 178-75-253ms | [S3,MB2,FORWARD] 259-29-288ms | [S3,MB2,FULL_BACKWARD] 300-44-345ms | [S3,MB3,FORWARD] 351-29-381ms | [S3,MB3,FULL_BACKWARD] 392-45-437ms | [S3,MB4,FORWARD] 443-29-473ms | [S3,MB4,FULL_BACKWARD] 484-44-529ms | [S3,MB5,FORWARD] 539-28-567ms | [S3,MB5,FULL_BACKWARD] 579-44-623ms | [S3,MB6,FORWARD] 629-28-658ms | [S3,MB6,FULL_BACKWARD] 669-48-718ms | [S3,MB7,FORWARD] 728-29-757ms | [S3,MB7,FULL_BACKWARD] 767-44-812ms | 
[rank3]:2025-11-27 10:35:26,616 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/frozen_ratio_history/rank3/251127_1035_stage3_step100.svg
[rank0]:2025-11-27 10:39:05,559 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-27 10:39:09,772 - INFO - Avg. fwd time: 26.6820 / Avg. bwd time: 70.5848 / Avg. batch time: 924.6329 (ms) / GPU bubble ratio: 15.84%
[rank3]:2025-11-27 10:39:09,779 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.59(0.67)/1.00, [MB2] 0.59(0.67)/1.00, [MB3] 0.59(0.67)/1.00, [MB4] 0.59(0.67)/1.00, [MB5] 0.24(0.27)/0.40, [MB6] 0.59(0.67)/1.00, [MB7] 0.59(0.67)/1.00
[rank1]:2025-11-27 10:39:09,865 - INFO - Avg. fwd time: 20.0148 / Avg. bwd time: 40.6426 / Avg. batch time: 1050.0362 (ms) / GPU bubble ratio: 53.79%
[rank2]:2025-11-27 10:39:09,814 - INFO - Avg. fwd time: 15.4473 / Avg. bwd time: 32.4940 / Avg. batch time: 980.6359 (ms) / GPU bubble ratio: 60.89%
[rank2]:2025-11-27 10:39:09,822 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.61(0.67)/1.00
[rank0]:2025-11-27 10:39:09,903 - INFO - Avg. fwd time: 15.5409 / Avg. bwd time: 29.4066 / Avg. batch time: 1103.9702 (ms) / GPU bubble ratio: 67.43%
[rank0]:2025-11-27 10:39:09,911 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.24(0.27)/0.40, [MB1] 0.22(0.25)/0.38, [MB2] 0.22(0.25)/0.38, [MB3] 0.22(0.25)/0.38, [MB4] 0.22(0.25)/0.38, [MB5] 0.22(0.25)/0.37, [MB6] 0.22(0.25)/0.38, [MB7] 0.59(0.67)/1.00
[rank0]:2025-11-27 10:39:09,940 - INFO -  step: 150  loss: -4.0000  grad_norm:  0.1906  memory: 16.87GiB(35.50%)  tps: 7,330  tflops: 57.30  mfu: 18.37%
[rank1]:2025-11-27 10:39:09,874 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.09(0.10)/0.15, [MB1] 0.00(0.00)/0.00, [MB2] 0.04(0.05)/0.08, [MB3] 0.02(0.02)/0.03, [MB4] 0.02(0.02)/0.04, [MB5] 0.04(0.04)/0.06, [MB6] 0.02(0.02)/0.03, [MB7] 0.60(0.67)/1.00
[rank1]:2025-11-27 10:39:09,928 - INFO -  step: 150  loss: -4.0000  grad_norm:  0.1906  memory: 12.92GiB(27.20%)  tps: 7,331  tflops: 57.31  mfu: 18.37%
[rank2]:2025-11-27 10:39:09,925 - INFO -  step: 150  loss: -4.0000  grad_norm:  0.1906  memory:  8.70GiB(18.31%)  tps: 7,331  tflops: 57.31  mfu: 18.37%
[rank3]:2025-11-27 10:39:09,938 - INFO -  step: 150  loss:  0.2296  grad_norm:  0.1906  memory: 25.79GiB(54.28%)  tps: 7,330  tflops: 57.30  mfu: 18.37%
[rank0]:2025-11-27 10:42:32,505 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-27 10:42:36,010 - INFO - Avg. fwd time: 27.0354 / Avg. bwd time: 67.5216 / Avg. batch time: 903.7438 (ms) / GPU bubble ratio: 16.30%
[rank3]:2025-11-27 10:42:36,016 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.93(1.00)/1.00, [MB2] 0.93(1.00)/1.00, [MB3] 0.93(1.00)/1.00, [MB4] 0.93(1.00)/1.00, [MB5] 0.38(0.40)/0.40, [MB6] 0.93(1.00)/1.00, [MB7] 0.93(1.00)/1.00
[rank0]:2025-11-27 10:42:36,115 - INFO - Avg. fwd time: 15.6073 / Avg. bwd time: 27.8410 / Avg. batch time: 1082.7492 (ms) / GPU bubble ratio: 67.90%
[rank2]:2025-11-27 10:42:36,152 - INFO - Avg. fwd time: 15.4611 / Avg. bwd time: 32.4923 / Avg. batch time: 959.7813 (ms) / GPU bubble ratio: 60.03%
[rank1]:2025-11-27 10:42:36,219 - INFO - Avg. fwd time: 20.0320 / Avg. bwd time: 40.1772 / Avg. batch time: 1029.1564 (ms) / GPU bubble ratio: 53.20%
[rank2]:2025-11-27 10:42:36,451 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 0.94(1.00)/1.00
[rank1]:2025-11-27 10:42:36,496 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.13(0.15)/0.15, [MB1] 0.00(0.00)/0.00, [MB2] 0.07(0.08)/0.08, [MB3] 0.02(0.03)/0.03, [MB4] 0.04(0.04)/0.04, [MB5] 0.04(0.06)/0.06, [MB6] 0.02(0.03)/0.03, [MB7] 0.93(1.00)/1.00
[rank0]:2025-11-27 10:42:36,524 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.38(0.40)/0.40, [MB1] 0.35(0.38)/0.38, [MB2] 0.35(0.38)/0.38, [MB3] 0.35(0.38)/0.38, [MB4] 0.35(0.38)/0.38, [MB5] 0.35(0.37)/0.37, [MB6] 0.35(0.38)/0.38, [MB7] 0.95(1.00)/1.00
[rank0]:2025-11-27 10:42:36,538 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.0954  memory: 16.87GiB(35.50%)  tps: 7,930  tflops: 62.00  mfu: 19.87%
[rank2]:2025-11-27 10:42:36,536 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.0954  memory:  8.70GiB(18.31%)  tps: 7,930  tflops: 61.99  mfu: 19.87%
[rank3]:2025-11-27 10:42:36,526 - INFO -  step: 200  loss:  0.2036  grad_norm:  0.0954  memory: 26.76GiB(56.33%)  tps: 7,931  tflops: 62.00  mfu: 19.87%
[rank1]:2025-11-27 10:42:36,540 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.0954  memory: 12.94GiB(27.24%)  tps: 7,930  tflops: 61.99  mfu: 19.87%
[rank1]:2025-11-27 10:42:36,590 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/frozen_ratio_history/rank1/251127_1042_stage1_step200.svg
[rank0]:2025-11-27 10:42:36,591 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/frozen_ratio_history/rank0/251127_1042_stage0_step200.svg
[rank2]:2025-11-27 10:42:36,590 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/frozen_ratio_history/rank2/251127_1042_stage2_step200.svg
[rank3]:2025-11-27 10:42:36,698 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/pipeline_schedule/251127_1042_real_step200_rank3.svg
[rank3]:			> Batch Time: 1016.11 ms, GPU Bubble Ratio: 72.40%, 54.11%, 62.67%, 31.54%
[rank3]:	[Rank 0]	[S0,MB0,FORWARD] 0-16-16ms | [S0,MB1,FORWARD] 16-17-33ms | [S0,MB2,FORWARD] 33-17-50ms | [S0,MB3,FORWARD] 50-16-67ms | [S0,MB0,FULL_BACKWARD] 211-9-221ms | [S0,MB4,FORWARD] 221-15-236ms | [S0,MB1,FULL_BACKWARD] 336-9-345ms | [S0,MB5,FORWARD] 345-14-360ms | [S0,MB2,FULL_BACKWARD] 448-9-458ms | [S0,MB6,FORWARD] 456-14-471ms | [S0,MB3,FULL_BACKWARD] 564-9-573ms | [S0,MB7,FORWARD] 572-14-587ms | [S0,MB4,FULL_BACKWARD] 666-27-693ms | [S0,MB5,FULL_BACKWARD] 767-29-796ms | [S0,MB6,FULL_BACKWARD] 885-29-915ms | [S0,MB7,FULL_BACKWARD] 988-28-1016ms | 
[rank3]:	[Rank 1]	[S1,MB0,FORWARD] 16-20-36ms | [S1,MB1,FORWARD] 42-20-63ms | [S1,MB2,FORWARD] 69-20-90ms | [S1,MB0,FULL_BACKWARD] 173-27-200ms | [S1,MB3,FORWARD] 208-20-229ms | [S1,MB1,FULL_BACKWARD] 299-28-327ms | [S1,MB4,FORWARD] 333-18-352ms | [S1,MB2,FULL_BACKWARD] 411-28-439ms | [S1,MB5,FORWARD] 444-19-464ms | [S1,MB3,FULL_BACKWARD] 507-43-551ms | [S1,MB6,FORWARD] 560-19-580ms | [S1,MB4,FULL_BACKWARD] 607-46-654ms | [S1,MB7,FORWARD] 662-20-683ms | [S1,MB5,FULL_BACKWARD] 715-44-760ms | [S1,MB6,FULL_BACKWARD] 834-44-879ms | [S1,MB7,FULL_BACKWARD] 938-42-980ms | 
[rank3]:	[Rank 2]	[S2,MB0,FORWARD] 36-16-52ms | [S2,MB1,FORWARD] 63-15-79ms | [S2,MB0,FULL_BACKWARD] 142-20-163ms | [S2,MB2,FORWARD] 170-16-186ms | [S2,MB1,FULL_BACKWARD] 268-21-289ms | [S2,MB3,FORWARD] 296-14-310ms | [S2,MB2,FULL_BACKWARD] 364-36-401ms | [S2,MB4,FORWARD] 407-15-422ms | [S2,MB3,FULL_BACKWARD] 461-35-497ms | [S2,MB5,FORWARD] 504-15-520ms | [S2,MB4,FULL_BACKWARD] 561-35-597ms | [S2,MB6,FORWARD] 604-15-619ms | [S2,MB5,FULL_BACKWARD] 669-35-705ms | [S2,MB7,FORWARD] 712-15-727ms | [S2,MB6,FULL_BACKWARD] 791-36-827ms | [S2,MB7,FULL_BACKWARD] 898-33-931ms | 
[rank3]:	[Rank 3]	[S3,MB0,FORWARD] 52-24-76ms | [S3,MB0,FULL_BACKWARD] 88-44-132ms | [S3,MB1,FORWARD] 139-28-167ms | [S3,MB1,FULL_BACKWARD] 179-78-258ms | [S3,MB2,FORWARD] 265-30-295ms | [S3,MB2,FULL_BACKWARD] 307-46-354ms | [S3,MB3,FORWARD] 361-29-391ms | [S3,MB3,FULL_BACKWARD] 403-48-451ms | [S3,MB4,FORWARD] 458-29-488ms | [S3,MB4,FULL_BACKWARD] 500-49-549ms | [S3,MB5,FORWARD] 558-27-585ms | [S3,MB5,FULL_BACKWARD] 598-64-662ms | [S3,MB6,FORWARD] 666-27-693ms | [S3,MB6,FULL_BACKWARD] 705-75-781ms | [S3,MB7,FORWARD] 789-28-818ms | [S3,MB7,FULL_BACKWARD] 828-63-892ms | 
[rank3]:2025-11-27 10:42:36,745 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/frozen_ratio_history/rank3/251127_1042_stage3_step200.svg
[rank0]:2025-11-27 10:45:49,352 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-27 10:45:52,778 - INFO - Avg. fwd time: 27.3545 / Avg. bwd time: 63.9792 / Avg. batch time: 878.9311 (ms) / GPU bubble ratio: 16.87%
[rank0]:2025-11-27 10:45:52,877 - INFO - Avg. fwd time: 15.6851 / Avg. bwd time: 24.9958 / Avg. batch time: 1057.1423 (ms) / GPU bubble ratio: 69.21%
[rank2]:2025-11-27 10:45:52,921 - INFO - Avg. fwd time: 15.5056 / Avg. bwd time: 32.2368 / Avg. batch time: 935.1039 (ms) / GPU bubble ratio: 59.16%
[rank1]:2025-11-27 10:45:52,989 - INFO - Avg. fwd time: 20.0603 / Avg. bwd time: 39.4406 / Avg. batch time: 1004.2928 (ms) / GPU bubble ratio: 52.60%
[rank2]:2025-11-27 10:45:53,214 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank3]:2025-11-27 10:45:53,196 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 1.00(1.00)/1.00, [MB2] 1.00(1.00)/1.00, [MB3] 1.00(1.00)/1.00, [MB4] 1.00(1.00)/1.00, [MB5] 0.41(0.40)/0.40, [MB6] 1.00(1.00)/1.00, [MB7] 1.00(1.00)/1.00
[rank1]:2025-11-27 10:45:53,260 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.16(0.15)/0.15, [MB1] 0.00(0.00)/0.00, [MB2] 0.07(0.08)/0.08, [MB3] 0.02(0.03)/0.03, [MB4] 0.04(0.04)/0.04, [MB5] 0.07(0.06)/0.06, [MB6] 0.02(0.03)/0.03, [MB7] 1.00(1.00)/1.00
[rank2]:2025-11-27 10:45:53,299 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.1107  memory:  8.70GiB(18.31%)  tps: 8,327  tflops: 65.10  mfu: 20.86%
[rank3]:2025-11-27 10:45:53,287 - INFO -  step: 250  loss:  0.2309  grad_norm:  0.0000  memory: 26.76GiB(56.33%)  tps: 8,327  tflops: 65.10  mfu: 20.86%
[rank0]:2025-11-27 10:45:53,286 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.41(0.40)/0.40, [MB1] 0.38(0.38)/0.38, [MB2] 0.38(0.38)/0.38, [MB3] 0.38(0.38)/0.38, [MB4] 0.38(0.38)/0.38, [MB5] 0.38(0.37)/0.37, [MB6] 0.38(0.38)/0.38, [MB7] 1.00(1.00)/1.00
[rank0]:2025-11-27 10:45:53,297 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.1107  memory: 16.87GiB(35.50%)  tps: 8,327  tflops: 65.10  mfu: 20.86%
[rank1]:2025-11-27 10:45:53,303 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.1107  memory: 12.94GiB(27.24%)  tps: 8,327  tflops: 65.10  mfu: 20.86%
[rank0]:2025-11-27 10:49:07,173 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-27 10:49:10,988 - INFO - Avg. fwd time: 27.5351 / Avg. bwd time: 61.8169 / Avg. batch time: 863.7353 (ms) / GPU bubble ratio: 17.24%
[rank3]:2025-11-27 10:49:11,014 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 1.00(1.00)/1.00, [MB2] 1.00(1.00)/1.00, [MB3] 1.00(1.00)/1.00, [MB4] 1.00(1.00)/1.00, [MB5] 0.41(0.40)/0.40, [MB6] 1.00(1.00)/1.00, [MB7] 1.00(1.00)/1.00
[rank2]:2025-11-27 10:49:11,029 - INFO - Avg. fwd time: 15.5258 / Avg. bwd time: 32.0641 / Avg. batch time: 919.8757 (ms) / GPU bubble ratio: 58.61%
[rank2]:2025-11-27 10:49:11,037 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.00(0.00)/0.00, [MB1] 0.00(0.00)/0.00, [MB2] 0.00(0.00)/0.00, [MB3] 0.00(0.00)/0.00, [MB4] 0.00(0.00)/0.00, [MB5] 0.00(0.00)/0.00, [MB6] 0.00(0.00)/0.00, [MB7] 1.00(1.00)/1.00
[rank3]:2025-11-27 10:49:11,121 - INFO -  step: 300  loss:  0.2454  grad_norm:  0.0000  memory: 26.76GiB(56.33%)  tps: 8,282  tflops: 64.74  mfu: 20.75%
[rank1]:2025-11-27 10:49:11,079 - INFO - Avg. fwd time: 20.0705 / Avg. bwd time: 38.9831 / Avg. batch time: 988.8975 (ms) / GPU bubble ratio: 52.23%
[rank1]:2025-11-27 10:49:11,088 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.16(0.15)/0.15, [MB1] 0.00(0.00)/0.00, [MB2] 0.07(0.08)/0.08, [MB3] 0.02(0.03)/0.03, [MB4] 0.04(0.04)/0.04, [MB5] 0.07(0.06)/0.06, [MB6] 0.02(0.03)/0.03, [MB7] 1.00(1.00)/1.00
[rank1]:2025-11-27 10:49:11,136 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.1052  memory: 12.94GiB(27.24%)  tps: 8,282  tflops: 64.74  mfu: 20.75%
[rank0]:2025-11-27 10:49:11,116 - INFO - Avg. fwd time: 15.7288 / Avg. bwd time: 23.1120 / Avg. batch time: 1041.2189 (ms) / GPU bubble ratio: 70.16%
[rank0]:2025-11-27 10:49:11,120 - INFO - Logged(Actual)/Expected Freeze Ratio per Block: [MB0] 0.41(0.40)/0.40, [MB1] 0.38(0.38)/0.38, [MB2] 0.38(0.38)/0.38, [MB3] 0.38(0.38)/0.38, [MB4] 0.38(0.38)/0.38, [MB5] 0.38(0.37)/0.37, [MB6] 0.38(0.38)/0.38, [MB7] 1.00(1.00)/1.00
[rank0]:2025-11-27 10:49:11,129 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.1052  memory: 16.87GiB(35.50%)  tps: 8,282  tflops: 64.74  mfu: 20.75%
[rank2]:2025-11-27 10:49:11,133 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.1052  memory:  8.70GiB(18.31%)  tps: 8,282  tflops: 64.74  mfu: 20.75%
[rank2]:2025-11-27 10:49:11,185 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/frozen_ratio_history/rank2/251127_1049_stage2_step300.svg
[rank1]:2025-11-27 10:49:11,186 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/frozen_ratio_history/rank1/251127_1049_stage1_step300.svg
[rank0]:2025-11-27 10:49:11,186 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/frozen_ratio_history/rank0/251127_1049_stage0_step300.svg
[rank3]:2025-11-27 10:49:11,277 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/pipeline_schedule/251127_1049_real_step300_rank3.svg
[rank3]:			> Batch Time: 969.53 ms, GPU Bubble Ratio: 75.03%, 53.04%, 61.27%, 33.99%
[rank3]:	[Rank 0]	[S0,MB0,FORWARD] 0-16-16ms | [S0,MB1,FORWARD] 16-17-33ms | [S0,MB2,FORWARD] 33-17-50ms | [S0,MB3,FORWARD] 50-17-67ms | [S0,MB0,FULL_BACKWARD] 204-0-204ms | [S0,MB4,FORWARD] 204-15-220ms | [S0,MB1,FULL_BACKWARD] 330-0-330ms | [S0,MB5,FORWARD] 330-14-345ms | [S0,MB2,FULL_BACKWARD] 442-0-442ms | [S0,MB6,FORWARD] 442-14-456ms | [S0,MB3,FULL_BACKWARD] 560-0-560ms | [S0,MB7,FORWARD] 560-14-574ms | [S0,MB4,FULL_BACKWARD] 658-27-685ms | [S0,MB5,FULL_BACKWARD] 747-29-776ms | [S0,MB6,FULL_BACKWARD] 856-29-885ms | [S0,MB7,FULL_BACKWARD] 940-29-969ms | 
[rank3]:	[Rank 1]	[S1,MB0,FORWARD] 16-20-36ms | [S1,MB1,FORWARD] 43-20-63ms | [S1,MB2,FORWARD] 69-20-90ms | [S1,MB0,FULL_BACKWARD] 170-23-194ms | [S1,MB3,FORWARD] 201-20-222ms | [S1,MB1,FULL_BACKWARD] 296-23-320ms | [S1,MB4,FORWARD] 327-18-346ms | [S1,MB2,FULL_BACKWARD] 408-23-431ms | [S1,MB5,FORWARD] 438-18-457ms | [S1,MB3,FULL_BACKWARD] 500-43-544ms | [S1,MB6,FORWARD] 556-19-575ms | [S1,MB4,FULL_BACKWARD] 599-46-646ms | [S1,MB7,FORWARD] 655-20-676ms | [S1,MB5,FULL_BACKWARD] 691-48-740ms | [S1,MB6,FULL_BACKWARD] 803-45-848ms | [S1,MB7,FULL_BACKWARD] 892-41-933ms | 
[rank3]:	[Rank 2]	[S2,MB0,FORWARD] 36-16-52ms | [S2,MB1,FORWARD] 63-16-79ms | [S2,MB0,FULL_BACKWARD] 141-18-160ms | [S2,MB2,FORWARD] 167-16-183ms | [S2,MB1,FULL_BACKWARD] 267-18-286ms | [S2,MB3,FORWARD] 293-14-307ms | [S2,MB2,FULL_BACKWARD] 361-36-398ms | [S2,MB4,FORWARD] 404-14-419ms | [S2,MB3,FULL_BACKWARD] 454-36-490ms | [S2,MB5,FORWARD] 497-15-513ms | [S2,MB4,FULL_BACKWARD] 553-35-589ms | [S2,MB6,FORWARD] 596-15-612ms | [S2,MB5,FULL_BACKWARD] 645-36-681ms | [S2,MB7,FORWARD] 688-15-704ms | [S2,MB6,FULL_BACKWARD] 760-35-796ms | [S2,MB7,FULL_BACKWARD] 852-32-885ms | 
[rank3]:	[Rank 3]	[S3,MB0,FORWARD] 52-24-76ms | [S3,MB0,FULL_BACKWARD] 88-42-131ms | [S3,MB1,FORWARD] 138-28-166ms | [S3,MB1,FULL_BACKWARD] 178-78-257ms | [S3,MB2,FORWARD] 264-30-294ms | [S3,MB2,FULL_BACKWARD] 306-44-351ms | [S3,MB3,FORWARD] 358-29-388ms | [S3,MB3,FULL_BACKWARD] 399-44-444ms | [S3,MB4,FORWARD] 451-29-481ms | [S3,MB4,FULL_BACKWARD] 493-44-537ms | [S3,MB5,FORWARD] 550-27-578ms | [S3,MB5,FULL_BACKWARD] 590-44-634ms | [S3,MB6,FORWARD] 642-26-669ms | [S3,MB6,FULL_BACKWARD] 680-68-748ms | [S3,MB7,FORWARD] 757-30-788ms | [S3,MB7,FULL_BACKWARD] 800-44-845ms | 
[rank3]:2025-11-27 10:49:11,321 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/frozen_ratio_history/rank3/251127_1049_stage3_step300.svg
[rank0]:2025-11-27 10:52:24,169 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-27 10:52:27,572 - INFO - Avg. fwd time: 27.6670 / Avg. bwd time: 60.4405 / Avg. batch time: 854.1299 (ms) / GPU bubble ratio: 17.48%
[rank0]:2025-11-27 10:52:27,672 - INFO - Avg. fwd time: 15.7594 / Avg. bwd time: 21.9298 / Avg. batch time: 1031.1647 (ms) / GPU bubble ratio: 70.76%
[rank2]:2025-11-27 10:52:27,716 - INFO - Avg. fwd time: 15.5418 / Avg. bwd time: 31.9610 / Avg. batch time: 910.3087 (ms) / GPU bubble ratio: 58.25%
[rank1]:2025-11-27 10:52:27,785 - INFO - Avg. fwd time: 20.0855 / Avg. bwd time: 38.6627 / Avg. batch time: 979.2325 (ms) / GPU bubble ratio: 52.00%
[rank1]:2025-11-27 10:52:28,084 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.0862  memory: 12.94GiB(27.24%)  tps: 8,319  tflops: 65.03  mfu: 20.84%
[rank3]:2025-11-27 10:52:28,067 - INFO -  step: 350  loss:  0.2209  grad_norm:  0.0000  memory: 26.76GiB(56.33%)  tps: 8,319  tflops: 65.03  mfu: 20.84%
[rank0]:2025-11-27 10:52:28,077 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.0862  memory: 16.87GiB(35.50%)  tps: 8,319  tflops: 65.03  mfu: 20.84%
[rank2]:2025-11-27 10:52:28,079 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.0862  memory:  8.70GiB(18.31%)  tps: 8,319  tflops: 65.03  mfu: 20.84%
[rank0]:2025-11-27 10:55:41,251 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-27 10:55:44,741 - INFO - Avg. fwd time: 27.7674 / Avg. bwd time: 59.1700 / Avg. batch time: 845.0981 (ms) / GPU bubble ratio: 17.70%
[rank0]:2025-11-27 10:55:44,845 - INFO - Avg. fwd time: 15.7834 / Avg. bwd time: 20.9043 / Avg. batch time: 1021.7786 (ms) / GPU bubble ratio: 71.28%
[rank2]:2025-11-27 10:55:44,884 - INFO - Avg. fwd time: 15.5549 / Avg. bwd time: 31.8663 / Avg. batch time: 901.2713 (ms) / GPU bubble ratio: 57.91%
[rank1]:2025-11-27 10:55:44,953 - INFO - Avg. fwd time: 20.0940 / Avg. bwd time: 38.3689 / Avg. batch time: 970.1197 (ms) / GPU bubble ratio: 51.79%
[rank3]:2025-11-27 10:55:45,256 - INFO -  step: 400  loss:  0.2170  grad_norm:  0.0000  memory: 26.76GiB(56.33%)  tps: 8,309  tflops: 64.95  mfu: 20.82%
[rank0]:2025-11-27 10:55:45,283 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.1045  memory: 16.87GiB(35.50%)  tps: 8,308  tflops: 64.95  mfu: 20.82%
[rank2]:2025-11-27 10:55:45,268 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.1045  memory:  8.70GiB(18.31%)  tps: 8,309  tflops: 64.95  mfu: 20.82%
[rank1]:2025-11-27 10:55:45,272 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.1045  memory: 12.98GiB(27.32%)  tps: 8,309  tflops: 64.95  mfu: 20.82%
[rank1]:2025-11-27 10:55:45,335 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/frozen_ratio_history/rank1/251127_1055_stage1_step400.svg
[rank0]:2025-11-27 10:55:45,335 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/frozen_ratio_history/rank0/251127_1055_stage0_step400.svg
[rank2]:2025-11-27 10:55:45,335 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/frozen_ratio_history/rank2/251127_1055_stage2_step400.svg
[rank3]:2025-11-27 10:55:45,422 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/pipeline_schedule/251127_1055_real_step400_rank3.svg
[rank3]:			> Batch Time: 965.97 ms, GPU Bubble Ratio: 74.98%, 53.24%, 61.17%, 33.65%
[rank3]:	[Rank 0]	[S0,MB0,FORWARD] 0-16-16ms | [S0,MB1,FORWARD] 16-17-33ms | [S0,MB2,FORWARD] 33-17-50ms | [S0,MB3,FORWARD] 50-16-67ms | [S0,MB0,FULL_BACKWARD] 204-0-204ms | [S0,MB4,FORWARD] 204-15-220ms | [S0,MB1,FULL_BACKWARD] 330-0-330ms | [S0,MB5,FORWARD] 330-14-344ms | [S0,MB2,FULL_BACKWARD] 441-0-441ms | [S0,MB6,FORWARD] 441-14-455ms | [S0,MB3,FULL_BACKWARD] 557-0-557ms | [S0,MB7,FORWARD] 557-14-572ms | [S0,MB4,FULL_BACKWARD] 658-27-685ms | [S0,MB5,FULL_BACKWARD] 745-29-774ms | [S0,MB6,FULL_BACKWARD] 854-29-883ms | [S0,MB7,FULL_BACKWARD] 938-27-965ms | 
[rank3]:	[Rank 1]	[S1,MB0,FORWARD] 16-20-36ms | [S1,MB1,FORWARD] 42-20-63ms | [S1,MB2,FORWARD] 69-20-90ms | [S1,MB0,FULL_BACKWARD] 170-23-193ms | [S1,MB3,FORWARD] 200-20-221ms | [S1,MB1,FULL_BACKWARD] 295-23-319ms | [S1,MB4,FORWARD] 326-19-345ms | [S1,MB2,FULL_BACKWARD] 407-23-431ms | [S1,MB5,FORWARD] 437-18-456ms | [S1,MB3,FULL_BACKWARD] 501-41-542ms | [S1,MB6,FORWARD] 553-19-573ms | [S1,MB4,FULL_BACKWARD] 598-46-645ms | [S1,MB7,FORWARD] 654-20-675ms | [S1,MB5,FULL_BACKWARD] 691-47-739ms | [S1,MB6,FULL_BACKWARD] 803-44-847ms | [S1,MB7,FULL_BACKWARD] 890-41-931ms | 
[rank3]:	[Rank 2]	[S2,MB0,FORWARD] 36-16-52ms | [S2,MB1,FORWARD] 63-15-79ms | [S2,MB0,FULL_BACKWARD] 141-18-160ms | [S2,MB2,FORWARD] 167-16-183ms | [S2,MB1,FULL_BACKWARD] 266-18-285ms | [S2,MB3,FORWARD] 292-14-307ms | [S2,MB2,FULL_BACKWARD] 361-36-397ms | [S2,MB4,FORWARD] 404-14-419ms | [S2,MB3,FULL_BACKWARD] 455-35-491ms | [S2,MB5,FORWARD] 498-15-513ms | [S2,MB4,FULL_BACKWARD] 552-35-588ms | [S2,MB6,FORWARD] 595-15-611ms | [S2,MB5,FULL_BACKWARD] 645-36-681ms | [S2,MB7,FORWARD] 688-15-703ms | [S2,MB6,FULL_BACKWARD] 760-35-796ms | [S2,MB7,FULL_BACKWARD] 851-32-883ms | 
[rank3]:	[Rank 3]	[S3,MB0,FORWARD] 52-24-76ms | [S3,MB0,FULL_BACKWARD] 88-42-131ms | [S3,MB1,FORWARD] 138-27-166ms | [S3,MB1,FULL_BACKWARD] 178-78-256ms | [S3,MB2,FORWARD] 264-30-294ms | [S3,MB2,FULL_BACKWARD] 305-44-350ms | [S3,MB3,FORWARD] 358-29-387ms | [S3,MB3,FULL_BACKWARD] 400-44-444ms | [S3,MB4,FORWARD] 452-29-481ms | [S3,MB4,FULL_BACKWARD] 493-44-538ms | [S3,MB5,FORWARD] 549-28-577ms | [S3,MB5,FULL_BACKWARD] 589-43-633ms | [S3,MB6,FORWARD] 641-26-668ms | [S3,MB6,FULL_BACKWARD] 680-70-750ms | [S3,MB7,FORWARD] 757-30-788ms | [S3,MB7,FULL_BACKWARD] 799-44-844ms | 
[rank3]:2025-11-27 10:55:45,469 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/frozen_ratio_history/rank3/251127_1055_stage3_step400.svg
[rank3]:2025-11-27 10:56:07,605 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-11-27 10:56:08,035 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-11-27 10:56:08,079 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-11-27 10:56:08,105 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-11-27 10:58:57,672 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-27 10:59:01,466 - INFO - Avg. fwd time: 15.5644 / Avg. bwd time: 31.7956 / Avg. batch time: 894.3176 (ms) / GPU bubble ratio: 57.63%
[rank3]:2025-11-27 10:59:01,423 - INFO - Avg. fwd time: 27.8509 / Avg. bwd time: 58.1692 / Avg. batch time: 838.0772 (ms) / GPU bubble ratio: 17.89%
[rank1]:2025-11-27 10:59:01,516 - INFO - Avg. fwd time: 20.0987 / Avg. bwd time: 38.1680 / Avg. batch time: 963.0966 (ms) / GPU bubble ratio: 51.60%
[rank2]:2025-11-27 10:59:01,572 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.1002  memory:  8.70GiB(18.31%)  tps: 8,346  tflops: 65.25  mfu: 20.91%
[rank3]:2025-11-27 10:59:01,561 - INFO -  step: 450  loss:  0.2212  grad_norm:  0.0000  memory: 26.76GiB(56.33%)  tps: 8,346  tflops: 65.25  mfu: 20.91%
[rank1]:2025-11-27 10:59:01,576 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.1002  memory: 12.98GiB(27.32%)  tps: 8,346  tflops: 65.25  mfu: 20.91%
[rank0]:2025-11-27 10:59:01,551 - INFO - Avg. fwd time: 15.8027 / Avg. bwd time: 20.1232 / Avg. batch time: 1014.4997 (ms) / GPU bubble ratio: 71.67%
[rank0]:2025-11-27 10:59:01,584 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.1002  memory: 16.87GiB(35.50%)  tps: 8,346  tflops: 65.25  mfu: 20.91%
[rank0]:2025-11-27 11:02:15,140 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-27 11:02:18,569 - INFO - Avg. fwd time: 27.9034 / Avg. bwd time: 57.5695 / Avg. batch time: 833.8789 (ms) / GPU bubble ratio: 18.00%
[rank0]:2025-11-27 11:02:18,670 - INFO - Avg. fwd time: 15.8141 / Avg. bwd time: 19.5597 / Avg. batch time: 1010.0422 (ms) / GPU bubble ratio: 71.98%
[rank2]:2025-11-27 11:02:18,711 - INFO - Avg. fwd time: 15.5711 / Avg. bwd time: 31.7462 / Avg. batch time: 890.0801 (ms) / GPU bubble ratio: 57.47%
[rank1]:2025-11-27 11:02:18,780 - INFO - Avg. fwd time: 20.1039 / Avg. bwd time: 38.0262 / Avg. batch time: 958.8294 (ms) / GPU bubble ratio: 51.50%
[rank3]:2025-11-27 11:02:19,079 - INFO -  step: 500  loss:  0.2073  grad_norm:  0.0000  memory: 26.76GiB(56.33%)  tps: 8,295  tflops: 64.85  mfu: 20.78%
[rank0]:2025-11-27 11:02:19,089 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.1083  memory: 16.87GiB(35.50%)  tps: 8,295  tflops: 64.85  mfu: 20.79%
[rank2]:2025-11-27 11:02:19,090 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.1083  memory:  8.70GiB(18.31%)  tps: 8,295  tflops: 64.85  mfu: 20.78%
[rank2]:2025-11-27 11:02:19,142 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/frozen_ratio_history/rank2/251127_1102_stage2_step500.svg
[rank1]:2025-11-27 11:02:19,095 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.1083  memory: 12.98GiB(27.32%)  tps: 8,295  tflops: 64.85  mfu: 20.78%
[rank1]:2025-11-27 11:02:19,142 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/frozen_ratio_history/rank1/251127_1102_stage1_step500.svg
[rank0]:2025-11-27 11:02:19,143 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/frozen_ratio_history/rank0/251127_1102_stage0_step500.svg
[rank3]:2025-11-27 11:02:19,236 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/pipeline_schedule/251127_1102_real_step500_rank3.svg
[rank3]:			> Batch Time: 968.75 ms, GPU Bubble Ratio: 75.47%, 53.32%, 61.20%, 33.44%
[rank3]:	[Rank 0]	[S0,MB0,FORWARD] 0-16-16ms | [S0,MB1,FORWARD] 16-17-33ms | [S0,MB2,FORWARD] 33-17-50ms | [S0,MB3,FORWARD] 50-16-67ms | [S0,MB0,FULL_BACKWARD] 204-0-204ms | [S0,MB4,FORWARD] 204-15-220ms | [S0,MB1,FULL_BACKWARD] 330-0-330ms | [S0,MB5,FORWARD] 330-14-345ms | [S0,MB2,FULL_BACKWARD] 441-0-441ms | [S0,MB6,FORWARD] 441-14-456ms | [S0,MB3,FULL_BACKWARD] 560-0-560ms | [S0,MB7,FORWARD] 560-14-575ms | [S0,MB4,FULL_BACKWARD] 657-26-683ms | [S0,MB5,FULL_BACKWARD] 745-29-774ms | [S0,MB6,FULL_BACKWARD] 859-28-888ms | [S0,MB7,FULL_BACKWARD] 943-25-968ms | 
[rank3]:	[Rank 1]	[S1,MB0,FORWARD] 16-20-36ms | [S1,MB1,FORWARD] 43-20-63ms | [S1,MB2,FORWARD] 69-20-90ms | [S1,MB0,FULL_BACKWARD] 170-23-194ms | [S1,MB3,FORWARD] 201-20-222ms | [S1,MB1,FULL_BACKWARD] 296-23-319ms | [S1,MB4,FORWARD] 326-18-345ms | [S1,MB2,FULL_BACKWARD] 407-23-431ms | [S1,MB5,FORWARD] 438-19-457ms | [S1,MB3,FULL_BACKWARD] 501-42-544ms | [S1,MB6,FORWARD] 556-19-576ms | [S1,MB4,FULL_BACKWARD] 598-46-644ms | [S1,MB7,FORWARD] 654-20-675ms | [S1,MB5,FULL_BACKWARD] 691-45-737ms | [S1,MB6,FULL_BACKWARD] 806-45-851ms | [S1,MB7,FULL_BACKWARD] 894-41-936ms | 
[rank3]:	[Rank 2]	[S2,MB0,FORWARD] 36-16-52ms | [S2,MB1,FORWARD] 63-16-79ms | [S2,MB0,FULL_BACKWARD] 141-18-160ms | [S2,MB2,FORWARD] 167-16-183ms | [S2,MB1,FULL_BACKWARD] 267-18-285ms | [S2,MB3,FORWARD] 292-14-307ms | [S2,MB2,FULL_BACKWARD] 361-36-397ms | [S2,MB4,FORWARD] 404-15-419ms | [S2,MB3,FULL_BACKWARD] 455-35-491ms | [S2,MB5,FORWARD] 498-15-514ms | [S2,MB4,FULL_BACKWARD] 552-35-588ms | [S2,MB6,FORWARD] 595-15-611ms | [S2,MB5,FULL_BACKWARD] 644-36-680ms | [S2,MB7,FORWARD] 687-15-703ms | [S2,MB6,FULL_BACKWARD] 763-35-799ms | [S2,MB7,FULL_BACKWARD] 854-32-887ms | 
[rank3]:	[Rank 3]	[S3,MB0,FORWARD] 52-24-76ms | [S3,MB0,FULL_BACKWARD] 88-43-131ms | [S3,MB1,FORWARD] 138-27-166ms | [S3,MB1,FULL_BACKWARD] 178-78-257ms | [S3,MB2,FORWARD] 264-30-294ms | [S3,MB2,FULL_BACKWARD] 306-44-351ms | [S3,MB3,FORWARD] 358-29-388ms | [S3,MB3,FULL_BACKWARD] 400-44-444ms | [S3,MB4,FORWARD] 452-29-482ms | [S3,MB4,FULL_BACKWARD] 493-44-538ms | [S3,MB5,FORWARD] 549-28-577ms | [S3,MB5,FULL_BACKWARD] 589-44-633ms | [S3,MB6,FORWARD] 641-26-667ms | [S3,MB6,FULL_BACKWARD] 679-73-753ms | [S3,MB7,FORWARD] 760-30-791ms | [S3,MB7,FULL_BACKWARD] 802-44-847ms | 
[rank3]:2025-11-27 11:02:19,278 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/frozen_ratio_history/rank3/251127_1102_stage3_step500.svg
[rank0]:2025-11-27 11:05:33,201 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-27 11:05:36,651 - INFO - Avg. fwd time: 27.9621 / Avg. bwd time: 57.0008 / Avg. batch time: 829.9378 (ms) / GPU bubble ratio: 18.10%
[rank0]:2025-11-27 11:05:36,647 - INFO - Avg. fwd time: 15.8276 / Avg. bwd time: 19.0344 / Avg. batch time: 1005.9863 (ms) / GPU bubble ratio: 72.28%
[rank2]:2025-11-27 11:05:36,793 - INFO - Avg. fwd time: 15.5802 / Avg. bwd time: 31.7015 / Avg. batch time: 886.1442 (ms) / GPU bubble ratio: 57.31%
[rank1]:2025-11-27 11:05:36,861 - INFO - Avg. fwd time: 20.1120 / Avg. bwd time: 37.8658 / Avg. batch time: 954.8594 (ms) / GPU bubble ratio: 51.43%
[rank0]:2025-11-27 11:05:37,165 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.0929  memory: 16.87GiB(35.50%)  tps: 8,272  tflops: 64.66  mfu: 20.73%
[rank2]:2025-11-27 11:05:37,167 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.0929  memory:  8.70GiB(18.31%)  tps: 8,272  tflops: 64.66  mfu: 20.73%
[rank3]:2025-11-27 11:05:37,155 - INFO -  step: 550  loss:  0.2198  grad_norm:  0.0000  memory: 26.76GiB(56.33%)  tps: 8,272  tflops: 64.66  mfu: 20.73%
[rank1]:2025-11-27 11:05:37,172 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.0929  memory: 12.98GiB(27.32%)  tps: 8,272  tflops: 64.66  mfu: 20.73%
[rank0]:2025-11-27 11:08:48,144 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-27 11:08:51,987 - INFO - Avg. fwd time: 28.0080 / Avg. bwd time: 56.3580 / Avg. batch time: 825.3377 (ms) / GPU bubble ratio: 18.22%
[rank2]:2025-11-27 11:08:52,030 - INFO - Avg. fwd time: 15.5843 / Avg. bwd time: 31.6638 / Avg. batch time: 881.6032 (ms) / GPU bubble ratio: 57.13%
[rank0]:2025-11-27 11:08:52,120 - INFO - Avg. fwd time: 15.8408 / Avg. bwd time: 18.5943 / Avg. batch time: 1001.2773 (ms) / GPU bubble ratio: 72.49%
[rank1]:2025-11-27 11:08:52,083 - INFO - Avg. fwd time: 20.1140 / Avg. bwd time: 37.7446 / Avg. batch time: 950.2444 (ms) / GPU bubble ratio: 51.29%
[rank2]:2025-11-27 11:08:52,141 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.1161  memory:  8.70GiB(18.31%)  tps: 8,403  tflops: 65.69  mfu: 21.06%
[rank3]:2025-11-27 11:08:52,129 - INFO -  step: 600  loss:  0.2219  grad_norm:  0.0000  memory: 26.76GiB(56.33%)  tps: 8,403  tflops: 65.69  mfu: 21.06%
[rank0]:2025-11-27 11:08:52,153 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.1161  memory: 16.87GiB(35.50%)  tps: 8,403  tflops: 65.69  mfu: 21.05%
[rank0]:2025-11-27 11:08:52,202 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/frozen_ratio_history/rank0/251127_1108_stage0_step600.svg
[rank1]:2025-11-27 11:08:52,144 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.1161  memory: 12.98GiB(27.32%)  tps: 8,403  tflops: 65.69  mfu: 21.06%
[rank1]:2025-11-27 11:08:52,202 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/frozen_ratio_history/rank1/251127_1108_stage1_step600.svg
[rank2]:2025-11-27 11:08:52,202 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/frozen_ratio_history/rank2/251127_1108_stage2_step600.svg
[rank3]:2025-11-27 11:08:52,292 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/pipeline_schedule/251127_1108_real_step600_rank3.svg
[rank3]:			> Batch Time: 954.06 ms, GPU Bubble Ratio: 74.46%, 52.44%, 60.61%, 34.38%
[rank3]:	[Rank 0]	[S0,MB0,FORWARD] 0-16-16ms | [S0,MB1,FORWARD] 16-17-33ms | [S0,MB2,FORWARD] 33-17-50ms | [S0,MB3,FORWARD] 50-16-67ms | [S0,MB0,FULL_BACKWARD] 204-0-204ms | [S0,MB4,FORWARD] 204-15-220ms | [S0,MB1,FULL_BACKWARD] 329-0-329ms | [S0,MB5,FORWARD] 329-14-344ms | [S0,MB2,FULL_BACKWARD] 442-0-442ms | [S0,MB6,FORWARD] 442-14-456ms | [S0,MB3,FULL_BACKWARD] 559-0-559ms | [S0,MB7,FORWARD] 559-14-573ms | [S0,MB4,FULL_BACKWARD] 658-27-685ms | [S0,MB5,FULL_BACKWARD] 745-27-773ms | [S0,MB6,FULL_BACKWARD] 843-32-876ms | [S0,MB7,FULL_BACKWARD] 926-27-954ms | 
[rank3]:	[Rank 1]	[S1,MB0,FORWARD] 16-20-36ms | [S1,MB1,FORWARD] 42-20-63ms | [S1,MB2,FORWARD] 69-20-90ms | [S1,MB0,FULL_BACKWARD] 170-23-194ms | [S1,MB3,FORWARD] 201-20-221ms | [S1,MB1,FULL_BACKWARD] 295-23-319ms | [S1,MB4,FORWARD] 326-18-345ms | [S1,MB2,FULL_BACKWARD] 408-23-431ms | [S1,MB5,FORWARD] 438-18-457ms | [S1,MB3,FULL_BACKWARD] 501-42-543ms | [S1,MB6,FORWARD] 555-19-574ms | [S1,MB4,FULL_BACKWARD] 599-46-646ms | [S1,MB7,FORWARD] 654-20-675ms | [S1,MB5,FULL_BACKWARD] 692-45-738ms | [S1,MB6,FULL_BACKWARD] 789-46-835ms | [S1,MB7,FULL_BACKWARD] 878-41-919ms | 
[rank3]:	[Rank 2]	[S2,MB0,FORWARD] 36-16-52ms | [S2,MB1,FORWARD] 63-16-79ms | [S2,MB0,FULL_BACKWARD] 141-18-160ms | [S2,MB2,FORWARD] 167-16-183ms | [S2,MB1,FULL_BACKWARD] 266-18-285ms | [S2,MB3,FORWARD] 292-14-307ms | [S2,MB2,FULL_BACKWARD] 361-36-398ms | [S2,MB4,FORWARD] 404-15-419ms | [S2,MB3,FULL_BACKWARD] 455-36-491ms | [S2,MB5,FORWARD] 498-15-513ms | [S2,MB4,FULL_BACKWARD] 552-36-588ms | [S2,MB6,FORWARD] 595-15-611ms | [S2,MB5,FULL_BACKWARD] 645-36-681ms | [S2,MB7,FORWARD] 689-15-705ms | [S2,MB6,FULL_BACKWARD] 747-35-783ms | [S2,MB7,FULL_BACKWARD] 838-32-871ms | 
[rank3]:	[Rank 3]	[S3,MB0,FORWARD] 52-24-76ms | [S3,MB0,FULL_BACKWARD] 88-42-131ms | [S3,MB1,FORWARD] 138-28-166ms | [S3,MB1,FULL_BACKWARD] 178-78-256ms | [S3,MB2,FORWARD] 264-30-294ms | [S3,MB2,FULL_BACKWARD] 306-44-351ms | [S3,MB3,FORWARD] 358-29-388ms | [S3,MB3,FULL_BACKWARD] 400-44-444ms | [S3,MB4,FORWARD] 452-29-481ms | [S3,MB4,FULL_BACKWARD] 493-44-538ms | [S3,MB5,FORWARD] 549-28-578ms | [S3,MB5,FULL_BACKWARD] 589-44-634ms | [S3,MB6,FORWARD] 642-28-671ms | [S3,MB6,FULL_BACKWARD] 682-53-736ms | [S3,MB7,FORWARD] 744-29-774ms | [S3,MB7,FULL_BACKWARD] 785-44-830ms | 
[rank3]:2025-11-27 11:08:52,336 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/frozen_ratio_history/rank3/251127_1108_stage3_step600.svg
[rank0]:2025-11-27 11:12:05,084 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-27 11:12:08,540 - INFO - Avg. fwd time: 28.0458 / Avg. bwd time: 55.9529 / Avg. batch time: 822.5046 (ms) / GPU bubble ratio: 18.30%
[rank0]:2025-11-27 11:12:08,534 - INFO - Avg. fwd time: 15.8495 / Avg. bwd time: 18.2752 / Avg. batch time: 998.3609 (ms) / GPU bubble ratio: 72.66%
[rank2]:2025-11-27 11:12:08,681 - INFO - Avg. fwd time: 15.5918 / Avg. bwd time: 31.6389 / Avg. batch time: 878.8065 (ms) / GPU bubble ratio: 57.00%
[rank1]:2025-11-27 11:12:08,752 - INFO - Avg. fwd time: 20.1192 / Avg. bwd time: 37.6604 / Avg. batch time: 947.4170 (ms) / GPU bubble ratio: 51.21%
[rank3]:2025-11-27 11:12:09,044 - INFO -  step: 650  loss:  0.2344  grad_norm:  0.0000  memory: 26.76GiB(56.33%)  tps: 8,320  tflops: 65.05  mfu: 20.85%
[rank0]:2025-11-27 11:12:09,054 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0990  memory: 16.87GiB(35.50%)  tps: 8,321  tflops: 65.05  mfu: 20.85%
[rank1]:2025-11-27 11:12:09,060 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0990  memory: 12.98GiB(27.32%)  tps: 8,320  tflops: 65.04  mfu: 20.85%
[rank2]:2025-11-27 11:12:09,056 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0990  memory:  8.70GiB(18.31%)  tps: 8,320  tflops: 65.04  mfu: 20.85%
[rank0]:2025-11-27 11:15:21,552 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-27 11:15:24,918 - INFO - Avg. fwd time: 28.0802 / Avg. bwd time: 55.5625 / Avg. batch time: 819.7803 (ms) / GPU bubble ratio: 18.38%
[rank0]:2025-11-27 11:15:25,022 - INFO - Avg. fwd time: 15.8571 / Avg. bwd time: 17.9628 / Avg. batch time: 995.5437 (ms) / GPU bubble ratio: 72.82%
[rank2]:2025-11-27 11:15:25,060 - INFO - Avg. fwd time: 15.5976 / Avg. bwd time: 31.6123 / Avg. batch time: 876.0882 (ms) / GPU bubble ratio: 56.89%
[rank1]:2025-11-27 11:15:25,129 - INFO - Avg. fwd time: 20.1230 / Avg. bwd time: 37.5861 / Avg. batch time: 944.7039 (ms) / GPU bubble ratio: 51.13%
[rank3]:2025-11-27 11:15:25,403 - INFO -  step: 700  loss:  0.1971  grad_norm:  0.0000  memory: 26.76GiB(56.33%)  tps: 8,344  tflops: 65.23  mfu: 20.91%
[rank0]:2025-11-27 11:15:25,426 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0930  memory: 16.87GiB(35.50%)  tps: 8,343  tflops: 65.22  mfu: 20.91%
[rank1]:2025-11-27 11:15:25,418 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0930  memory: 12.98GiB(27.32%)  tps: 8,344  tflops: 65.23  mfu: 20.91%
[rank2]:2025-11-27 11:15:25,414 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0930  memory:  8.70GiB(18.31%)  tps: 8,344  tflops: 65.23  mfu: 20.91%
[rank2]:2025-11-27 11:15:25,477 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/frozen_ratio_history/rank2/251127_1115_stage2_step700.svg
[rank0]:2025-11-27 11:15:25,479 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/frozen_ratio_history/rank0/251127_1115_stage0_step700.svg
[rank1]:2025-11-27 11:15:25,477 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/frozen_ratio_history/rank1/251127_1115_stage1_step700.svg
[rank3]:2025-11-27 11:15:25,569 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/pipeline_schedule/251127_1115_real_step700_rank3.svg
[rank3]:			> Batch Time: 957.73 ms, GPU Bubble Ratio: 75.26%, 52.70%, 60.73%, 34.59%
[rank3]:	[Rank 0]	[S0,MB0,FORWARD] 0-16-16ms | [S0,MB1,FORWARD] 16-17-33ms | [S0,MB2,FORWARD] 33-17-50ms | [S0,MB3,FORWARD] 50-16-67ms | [S0,MB0,FULL_BACKWARD] 204-0-204ms | [S0,MB4,FORWARD] 204-15-220ms | [S0,MB1,FULL_BACKWARD] 330-0-330ms | [S0,MB5,FORWARD] 330-15-345ms | [S0,MB2,FULL_BACKWARD] 442-0-442ms | [S0,MB6,FORWARD] 442-14-457ms | [S0,MB3,FULL_BACKWARD] 559-0-559ms | [S0,MB7,FORWARD] 559-14-573ms | [S0,MB4,FULL_BACKWARD] 659-26-686ms | [S0,MB5,FULL_BACKWARD] 746-30-776ms | [S0,MB6,FULL_BACKWARD] 849-27-876ms | [S0,MB7,FULL_BACKWARD] 933-24-957ms | 
[rank3]:	[Rank 1]	[S1,MB0,FORWARD] 16-20-36ms | [S1,MB1,FORWARD] 42-20-63ms | [S1,MB2,FORWARD] 69-20-90ms | [S1,MB0,FULL_BACKWARD] 170-23-194ms | [S1,MB3,FORWARD] 201-20-222ms | [S1,MB1,FULL_BACKWARD] 296-23-320ms | [S1,MB4,FORWARD] 327-19-346ms | [S1,MB2,FULL_BACKWARD] 408-23-431ms | [S1,MB5,FORWARD] 438-18-457ms | [S1,MB3,FULL_BACKWARD] 501-41-543ms | [S1,MB6,FORWARD] 555-20-575ms | [S1,MB4,FULL_BACKWARD] 600-46-647ms | [S1,MB7,FORWARD] 656-21-677ms | [S1,MB5,FULL_BACKWARD] 694-44-739ms | [S1,MB6,FULL_BACKWARD] 795-45-841ms | [S1,MB7,FULL_BACKWARD] 884-41-925ms | 
[rank3]:	[Rank 2]	[S2,MB0,FORWARD] 36-16-52ms | [S2,MB1,FORWARD] 63-16-79ms | [S2,MB0,FULL_BACKWARD] 141-18-160ms | [S2,MB2,FORWARD] 167-16-183ms | [S2,MB1,FULL_BACKWARD] 267-18-286ms | [S2,MB3,FORWARD] 293-14-307ms | [S2,MB2,FULL_BACKWARD] 362-36-399ms | [S2,MB4,FORWARD] 405-15-420ms | [S2,MB3,FULL_BACKWARD] 455-36-491ms | [S2,MB5,FORWARD] 498-15-514ms | [S2,MB4,FULL_BACKWARD] 553-36-589ms | [S2,MB6,FORWARD] 597-15-613ms | [S2,MB5,FULL_BACKWARD] 647-36-683ms | [S2,MB7,FORWARD] 690-15-706ms | [S2,MB6,FULL_BACKWARD] 752-35-788ms | [S2,MB7,FULL_BACKWARD] 844-32-877ms | 
[rank3]:	[Rank 3]	[S3,MB0,FORWARD] 52-24-76ms | [S3,MB0,FULL_BACKWARD] 88-42-131ms | [S3,MB1,FORWARD] 138-28-166ms | [S3,MB1,FULL_BACKWARD] 178-78-257ms | [S3,MB2,FORWARD] 264-30-294ms | [S3,MB2,FULL_BACKWARD] 306-45-351ms | [S3,MB3,FORWARD] 359-29-389ms | [S3,MB3,FULL_BACKWARD] 400-45-446ms | [S3,MB4,FORWARD] 452-29-482ms | [S3,MB4,FULL_BACKWARD] 494-44-539ms | [S3,MB5,FORWARD] 550-28-579ms | [S3,MB5,FULL_BACKWARD] 591-44-636ms | [S3,MB6,FORWARD] 644-27-672ms | [S3,MB6,FULL_BACKWARD] 683-52-736ms | [S3,MB7,FORWARD] 749-30-780ms | [S3,MB7,FULL_BACKWARD] 791-44-836ms | 
[rank3]:2025-11-27 11:15:25,615 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/frozen_ratio_history/rank3/251127_1115_stage3_step700.svg
[rank0]:2025-11-27 11:18:39,180 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-27 11:18:43,025 - INFO - Avg. fwd time: 28.1100 / Avg. bwd time: 55.2523 / Avg. batch time: 817.6189 (ms) / GPU bubble ratio: 18.43%
[rank2]:2025-11-27 11:18:43,069 - INFO - Avg. fwd time: 15.6012 / Avg. bwd time: 31.5903 / Avg. batch time: 873.9382 (ms) / GPU bubble ratio: 56.80%
[rank3]:2025-11-27 11:18:43,168 - INFO -  step: 750  loss:  0.2349  grad_norm:  0.0000  memory: 26.76GiB(56.33%)  tps: 8,285  tflops: 64.77  mfu: 20.76%
[rank1]:2025-11-27 11:18:43,121 - INFO - Avg. fwd time: 20.1275 / Avg. bwd time: 37.5120 / Avg. batch time: 942.5319 (ms) / GPU bubble ratio: 51.08%
[rank1]:2025-11-27 11:18:43,183 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1332  memory: 12.98GiB(27.32%)  tps: 8,285  tflops: 64.77  mfu: 20.76%
[rank0]:2025-11-27 11:18:43,159 - INFO - Avg. fwd time: 15.8637 / Avg. bwd time: 17.7024 / Avg. batch time: 993.3221 (ms) / GPU bubble ratio: 72.97%
[rank0]:2025-11-27 11:18:43,192 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1332  memory: 16.87GiB(35.50%)  tps: 8,285  tflops: 64.76  mfu: 20.76%
[rank2]:2025-11-27 11:18:43,179 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1332  memory:  8.70GiB(18.31%)  tps: 8,285  tflops: 64.77  mfu: 20.76%
[rank0]:2025-11-27 11:21:56,300 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-27 11:21:59,820 - INFO - Avg. fwd time: 28.1303 / Avg. bwd time: 55.0087 / Avg. batch time: 815.8667 (ms) / GPU bubble ratio: 18.48%
[rank0]:2025-11-27 11:21:59,922 - INFO - Avg. fwd time: 15.8679 / Avg. bwd time: 17.4870 / Avg. batch time: 991.5196 (ms) / GPU bubble ratio: 73.09%
[rank2]:2025-11-27 11:21:59,966 - INFO - Avg. fwd time: 15.6050 / Avg. bwd time: 31.5742 / Avg. batch time: 872.1893 (ms) / GPU bubble ratio: 56.73%
[rank1]:2025-11-27 11:22:00,035 - INFO - Avg. fwd time: 20.1315 / Avg. bwd time: 37.4564 / Avg. batch time: 940.7585 (ms) / GPU bubble ratio: 51.03%
[rank3]:2025-11-27 11:22:00,342 - INFO -  step: 800  loss:  0.2419  grad_norm:  0.0000  memory: 26.76GiB(56.33%)  tps: 8,309  tflops: 64.96  mfu: 20.82%
[rank3]:2025-11-27 11:22:00,343 - INFO -  final step: 800  loss:  0.2419  grad_norm:  0.0000  tps: 8,538  tflops: 66.75  mfu: 19.67%
[rank3]:2025-11-27 11:22:00,343 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-11-27 11:22:00,344 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank1]:2025-11-27 11:22:00,358 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1335  memory: 12.98GiB(27.32%)  tps: 8,309  tflops: 64.96  mfu: 20.82%
[rank1]:2025-11-27 11:22:00,358 - INFO -  final step: 800  loss: -4.0000  grad_norm:  0.1335  tps: 8,533  tflops: 66.71  mfu: 19.54%
[rank1]:2025-11-27 11:22:00,358 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-11-27 11:22:00,359 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank1]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /data2/shcho/torchtitan/checkpoint/1109_1F1B_fullrand7_42_forfun_dm1/step-800, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank1]:  warnings.warn(
[rank2]:2025-11-27 11:22:00,354 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1335  memory:  8.70GiB(18.31%)  tps: 8,309  tflops: 64.96  mfu: 20.82%
[rank2]:2025-11-27 11:22:00,354 - INFO -  final step: 800  loss: -4.0000  grad_norm:  0.1335  tps: 8,532  tflops: 66.70  mfu: 19.52%
[rank2]:2025-11-27 11:22:00,354 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-27 11:22:00,355 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank2]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /data2/shcho/torchtitan/checkpoint/1109_1F1B_fullrand7_42_forfun_dm1/step-800, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank2]:  warnings.warn(
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /data2/shcho/torchtitan/checkpoint/1109_1F1B_fullrand7_42_forfun_dm1/step-800, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank3]:  warnings.warn(
[rank0]:2025-11-27 11:22:00,366 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1335  memory: 16.87GiB(35.50%)  tps: 8,309  tflops: 64.96  mfu: 20.82%
[rank0]:2025-11-27 11:22:00,366 - INFO -  final step: 800  loss: -4.0000  grad_norm:  0.1335  tps: 8,533  tflops: 66.71  mfu: 19.54%
[rank0]:2025-11-27 11:22:00,367 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-27 11:22:00,367 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /data2/shcho/torchtitan/checkpoint/1109_1F1B_fullrand7_42_forfun_dm1/step-800, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank0]:  warnings.warn(
[rank0]:2025-11-27 11:22:02,403 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank1]:2025-11-27 11:22:02,467 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/frozen_ratio_history/rank1/251127_1122_stage1_final800.svg
[rank2]:2025-11-27 11:22:02,466 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/frozen_ratio_history/rank2/251127_1122_stage2_final800.svg
[rank0]:2025-11-27 11:22:02,467 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/frozen_ratio_history/rank0/251127_1122_stage0_final800.svg
[rank3]:2025-11-27 11:22:02,554 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/pipeline_schedule/251127_1122_real_final800_rank3.svg
[rank3]:			> Batch Time: 964.55 ms, GPU Bubble Ratio: 75.07%, 52.99%, 61.07%, 33.35%
[rank3]:	[Rank 0]	[S0,MB0,FORWARD] 0-16-16ms | [S0,MB1,FORWARD] 16-17-33ms | [S0,MB2,FORWARD] 33-17-50ms | [S0,MB3,FORWARD] 50-16-67ms | [S0,MB0,FULL_BACKWARD] 205-0-205ms | [S0,MB4,FORWARD] 205-15-220ms | [S0,MB1,FULL_BACKWARD] 331-0-331ms | [S0,MB5,FORWARD] 331-14-346ms | [S0,MB2,FULL_BACKWARD] 443-0-443ms | [S0,MB6,FORWARD] 443-14-458ms | [S0,MB3,FULL_BACKWARD] 560-0-560ms | [S0,MB7,FORWARD] 560-14-575ms | [S0,MB4,FULL_BACKWARD] 660-28-688ms | [S0,MB5,FULL_BACKWARD] 748-29-777ms | [S0,MB6,FULL_BACKWARD] 853-28-882ms | [S0,MB7,FULL_BACKWARD] 937-27-964ms | 
[rank3]:	[Rank 1]	[S1,MB0,FORWARD] 16-20-36ms | [S1,MB1,FORWARD] 42-20-63ms | [S1,MB2,FORWARD] 69-20-90ms | [S1,MB0,FULL_BACKWARD] 171-23-194ms | [S1,MB3,FORWARD] 201-20-222ms | [S1,MB1,FULL_BACKWARD] 297-23-320ms | [S1,MB4,FORWARD] 327-19-347ms | [S1,MB2,FULL_BACKWARD] 409-23-432ms | [S1,MB5,FORWARD] 439-19-458ms | [S1,MB3,FULL_BACKWARD] 503-43-546ms | [S1,MB6,FORWARD] 556-19-576ms | [S1,MB4,FULL_BACKWARD] 601-46-647ms | [S1,MB7,FORWARD] 657-20-678ms | [S1,MB5,FULL_BACKWARD] 695-45-741ms | [S1,MB6,FULL_BACKWARD] 800-45-846ms | [S1,MB7,FULL_BACKWARD] 889-41-930ms | 
[rank3]:	[Rank 2]	[S2,MB0,FORWARD] 36-16-52ms | [S2,MB1,FORWARD] 63-15-79ms | [S2,MB0,FULL_BACKWARD] 142-18-160ms | [S2,MB2,FORWARD] 167-16-183ms | [S2,MB1,FULL_BACKWARD] 268-18-286ms | [S2,MB3,FORWARD] 294-14-308ms | [S2,MB2,FULL_BACKWARD] 362-36-399ms | [S2,MB4,FORWARD] 406-15-421ms | [S2,MB3,FULL_BACKWARD] 456-35-492ms | [S2,MB5,FORWARD] 500-15-515ms | [S2,MB4,FULL_BACKWARD] 554-35-590ms | [S2,MB6,FORWARD] 598-15-614ms | [S2,MB5,FULL_BACKWARD] 648-36-684ms | [S2,MB7,FORWARD] 691-15-707ms | [S2,MB6,FULL_BACKWARD] 758-35-794ms | [S2,MB7,FULL_BACKWARD] 849-32-882ms | 
[rank3]:	[Rank 3]	[S3,MB0,FORWARD] 52-24-76ms | [S3,MB0,FULL_BACKWARD] 88-43-131ms | [S3,MB1,FORWARD] 139-27-166ms | [S3,MB1,FULL_BACKWARD] 179-78-257ms | [S3,MB2,FORWARD] 265-30-295ms | [S3,MB2,FULL_BACKWARD] 307-45-352ms | [S3,MB3,FORWARD] 359-29-389ms | [S3,MB3,FULL_BACKWARD] 401-45-446ms | [S3,MB4,FORWARD] 453-29-483ms | [S3,MB4,FULL_BACKWARD] 495-44-540ms | [S3,MB5,FORWARD] 551-28-580ms | [S3,MB5,FULL_BACKWARD] 592-44-636ms | [S3,MB6,FORWARD] 645-27-672ms | [S3,MB6,FULL_BACKWARD] 684-69-754ms | [S3,MB7,FORWARD] 755-30-785ms | [S3,MB7,FULL_BACKWARD] 797-45-842ms | 
[rank0]:2025-11-27 11:22:02,627 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/frozen_params_histogram/251127_1122_rank0_stage0.svg
[rank0]:	> Counts Sum: 474520, Total Sum: 864320 (54.90%), Ratio(%) per element: [35.61, 36.81, 40.58, 39.89, 44.52, 41.26, 39.21, 44.69, 42.12, 39.55, 42.12, 45.89, 46.4, 45.2, 45.89, 49.31, 51.54, 50.51, 52.73, 57.19, 55.3, 57.19, 59.41, 59.41, 61.64, 61.13, 62.67, 66.95, 66.43, 66.95, 69.17, 70.89, 74.31, 76.36, 74.48, 76.88, 80.99]
[rank0]:2025-11-27 11:22:02,627 - INFO - Sleeping 2 seconds for other ranks to complete
[rank1]:2025-11-27 11:22:02,619 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/frozen_params_histogram/251127_1122_rank1_stage1.svg
[rank1]:	> Counts Sum: 855320, Total Sum: 1051200 (81.37%), Ratio(%) per element: [82.53, 80.82, 82.02, 80.47, 80.65, 80.82, 80.82, 81.5, 78.93, 81.84, 80.99, 81.16, 80.99, 81.16, 80.3, 82.19, 83.73, 81.67, 81.67, 81.33, 81.33, 79.96, 80.99, 82.36, 81.5, 82.02, 80.65, 81.84, 83.04, 80.82, 81.5, 80.65, 80.99, 81.67, 80.99, 81.33, 82.19, 80.82, 82.02, 81.84, 80.65, 80.99, 81.84, 81.67, 82.02]
[rank1]:2025-11-27 11:22:02,620 - INFO - Destroying the purge thread.
[rank2]:2025-11-27 11:22:02,626 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/frozen_params_histogram/251127_1122_rank2_stage2.svg
[rank2]:	> Counts Sum: 720960, Total Sum: 840960 (85.73%), Ratio(%) per element: [85.78, 85.78, 85.44, 85.27, 86.13, 85.78, 85.44, 85.44, 86.13, 85.61, 85.78, 85.78, 86.13, 85.78, 85.78, 85.78, 85.78, 85.78, 85.44, 85.61, 85.1, 86.13, 85.78, 85.61, 85.95, 85.44, 85.95, 85.78, 85.78, 85.44, 85.78, 85.78, 85.95, 85.78, 85.61, 85.78]
[rank2]:2025-11-27 11:22:02,626 - INFO - Destroying the purge thread.
[rank3]:2025-11-27 11:22:02,690 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/pipeline_schedule/251127_1122_thry_final800_rank3.svg
[rank3]:			> Batch Time: 659.67 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:	[Rank 0]	[S0,MB0,FORWARD] 0-19-19ms | [S0,MB1,FORWARD] 19-19-39ms | [S0,MB2,FORWARD] 39-19-59ms | [S0,MB3,FORWARD] 59-19-79ms | [S0,MB0,FULL_BACKWARD] 199-39-239ms | [S0,MB4,FORWARD] 239-19-259ms | [S0,MB1,FULL_BACKWARD] 259-39-299ms | [S0,MB5,FORWARD] 299-19-319ms | [S0,MB2,FULL_BACKWARD] 319-39-359ms | [S0,MB6,FORWARD] 359-19-379ms | [S0,MB3,FULL_BACKWARD] 379-39-419ms | [S0,MB7,FORWARD] 419-19-439ms | [S0,MB4,FULL_BACKWARD] 439-39-479ms | [S0,MB5,FULL_BACKWARD] 499-39-539ms | [S0,MB6,FULL_BACKWARD] 559-39-599ms | [S0,MB7,FULL_BACKWARD] 619-39-659ms | 
[rank3]:	[Rank 1]	[S1,MB0,FORWARD] 19-19-39ms | [S1,MB1,FORWARD] 39-19-59ms | [S1,MB2,FORWARD] 59-19-79ms | [S1,MB0,FULL_BACKWARD] 159-39-199ms | [S1,MB3,FORWARD] 199-19-219ms | [S1,MB1,FULL_BACKWARD] 219-39-259ms | [S1,MB4,FORWARD] 259-19-279ms | [S1,MB2,FULL_BACKWARD] 279-39-319ms | [S1,MB5,FORWARD] 319-19-339ms | [S1,MB3,FULL_BACKWARD] 339-39-379ms | [S1,MB6,FORWARD] 379-19-399ms | [S1,MB4,FULL_BACKWARD] 399-39-439ms | [S1,MB7,FORWARD] 439-19-459ms | [S1,MB5,FULL_BACKWARD] 459-39-499ms | [S1,MB6,FULL_BACKWARD] 519-39-559ms | [S1,MB7,FULL_BACKWARD] 579-39-619ms | 
[rank3]:	[Rank 2]	[S2,MB0,FORWARD] 39-19-59ms | [S2,MB1,FORWARD] 59-19-79ms | [S2,MB0,FULL_BACKWARD] 119-39-159ms | [S2,MB2,FORWARD] 159-19-179ms | [S2,MB1,FULL_BACKWARD] 179-39-219ms | [S2,MB3,FORWARD] 219-19-239ms | [S2,MB2,FULL_BACKWARD] 239-39-279ms | [S2,MB4,FORWARD] 279-19-299ms | [S2,MB3,FULL_BACKWARD] 299-39-339ms | [S2,MB5,FORWARD] 339-19-359ms | [S2,MB4,FULL_BACKWARD] 359-39-399ms | [S2,MB6,FORWARD] 399-19-419ms | [S2,MB5,FULL_BACKWARD] 419-39-459ms | [S2,MB7,FORWARD] 459-19-479ms | [S2,MB6,FULL_BACKWARD] 479-39-519ms | [S2,MB7,FULL_BACKWARD] 539-39-579ms | 
[rank3]:	[Rank 3]	[S3,MB0,FORWARD] 59-19-79ms | [S3,MB0,FULL_BACKWARD] 79-39-119ms | [S3,MB1,FORWARD] 119-19-139ms | [S3,MB1,FULL_BACKWARD] 139-39-179ms | [S3,MB2,FORWARD] 179-19-199ms | [S3,MB2,FULL_BACKWARD] 199-39-239ms | [S3,MB3,FORWARD] 239-19-259ms | [S3,MB3,FULL_BACKWARD] 259-39-299ms | [S3,MB4,FORWARD] 299-19-319ms | [S3,MB4,FULL_BACKWARD] 319-39-359ms | [S3,MB5,FORWARD] 359-19-379ms | [S3,MB5,FULL_BACKWARD] 379-39-419ms | [S3,MB6,FORWARD] 419-19-439ms | [S3,MB6,FULL_BACKWARD] 439-39-479ms | [S3,MB7,FORWARD] 479-19-499ms | [S3,MB7,FULL_BACKWARD] 499-39-539ms | 
[rank3]:2025-11-27 11:22:02,737 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/frozen_ratio_history/rank3/251127_1122_stage3_final800.svg
[rank1]:2025-11-27 11:22:02,767 - INFO - Process group destroyed
[rank2]:2025-11-27 11:22:02,791 - INFO - Process group destroyed
[rank3]:2025-11-27 11:22:02,875 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1/frozen_params_histogram/251127_1122_rank3_stage3.svg
[rank3]:	> Counts Sum: 158800, Total Sum: 677440 (23.44%), Ratio(%) per element: [24.14, 23.28, 25.0, 23.45, 22.94, 22.6, 24.65, 24.14, 23.45, 23.97, 21.91, 23.97, 22.08, 24.82, 24.65, 23.97, 21.4, 23.11, 23.63, 23.63, 22.43, 22.94, 23.8, 21.91, 22.77, 23.63, 23.63, 25.17, 22.6]
[rank3]:2025-11-27 11:22:02,876 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading output.log; uploading wandb-summary.json; uploading config.yaml
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–…â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–…â–„â–‚â–â–‚â–‚â–â–â–‚â–â–â–‚â–‚â–â–‚â–‚
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–…â–„â–‚â–â–‚â–‚â–â–â–‚â–â–â–‚â–‚â–â–‚â–‚
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 3.83773
[rank3]:wandb:               final/avg_loss 0.24192
[rank3]:wandb:             final/avg_mfu(%) 19.67121
[rank3]:wandb:             final/avg_tflops 66.74917
[rank3]:wandb:    final/avg_throughput(tps) 8538.38598
[rank3]:wandb:              final/grad_norm 0
[rank3]:wandb:               final/max_loss 0.24192
[rank3]:wandb:                    grad_norm 0
[rank3]:wandb: loss_metrics/global_avg_loss 0.24192
[rank3]:wandb: loss_metrics/global_max_loss 0.24192
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1109_1F1B_fullrand7_42_forfun_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/4s2k7zn5
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1109_1F1B_fullrand7_42_forfun_dm1/20251127-1027/wandb/run-20251127_102736-4s2k7zn5/logs
[rank0]:2025-11-27 11:22:04,627 - INFO - Training completed
[rank0]:2025-11-27 11:22:04,627 - INFO - Destroying the purge thread.
[rank3]:2025-11-27 11:22:04,799 - INFO - Process group destroyed
[rank0]:2025-11-27 11:22:04,800 - INFO - Process group destroyed
[rank2]:Stage 2: Modules to keep: {'layers.11', 'layers.12', 'layers.9', 'layers.10'}
[rank1]:Stage 1: Modules to keep: {'layers.7', 'layers.6', 'layers.5', 'layers.8', 'layers.4'}
[rank0]:Stage 0: Modules to keep: {'layers.2', 'tok_embeddings', 'layers.3', 'layers.0', 'layers.1'}
[rank3]:Stage 3: Modules to keep: {'norm', 'output', 'layers.15', 'layers.13', 'layers.14'}
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1109.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1109_1F1B_fullrand7_42_forfun_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1109_1F1B_fullrand7_42_forfun_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1109_1F1B_fullrand7_42_forfun_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1109_1F1B_fullrand7_42_forfun_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1109_1F1B_fullrand7_42_forfun_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1109_1F1B_fullrand7_42_forfun_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 42
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: 1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 4
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1109_1F1B_fullrand7_42_forfun_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1109_1F1B_fullrand7_42_forfun_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: fullrand7
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.01
[rank3]:		- percentile: 80
[rank3]:
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
