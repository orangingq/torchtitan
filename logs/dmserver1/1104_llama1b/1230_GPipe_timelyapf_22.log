
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 12. 30. (í™”) 14:56:38 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 3,4,5,6
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/1230_GPipe_timelyapf_22.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
1227: everything same as 1224 but seed=42->11
1230: everything same as 1224 but seed=42->22

âœ”ï¸Running with timelyapf x GPipe ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1230.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
1109: switch to alpaca_gpt4+alpaca_cleaned dataset
1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
1227: everything same as 1224 but seed=42->11
1230: everything same as 1224 but seed=42->22
" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=timelyapf --freezing.threshold=0.01 --freezing.percentile=80 --freezing.max_freeze_ratio=0.8
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank0]:2025-12-30 14:56:44,520 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank0]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank0]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank0]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank0]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank0]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank0]:1227: everything same as 1224 but seed=42->11
[rank0]:1230: everything same as 1224 but seed=42->22
[rank3]:2025-12-30 14:56:44,518 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank0]:"
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:1227: everything same as 1224 but seed=42->11
[rank3]:1230: everything same as 1224 but seed=42->22
[rank3]:"
[rank1]:2025-12-30 14:56:44,672 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank0]:2025-12-30 14:56:44,718 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-12-30 14:56:44,721 - Building 1-D device mesh with ['pp'], [4]
[rank1]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank1]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank0]:2025-12-30 14:56:44,723 - [GC] Initial GC collection 0.00 seconds
[rank3]:2025-12-30 14:56:44,714 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank0]:2025-12-30 14:56:44,724 - Loading tokenizer from tokenizer.json
[rank1]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:2025-12-30 14:56:44,717 - Building 1-D device mesh with ['pp'], [4]
[rank1]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank1]:1227: everything same as 1224 but seed=42->11
[rank1]:1230: everything same as 1224 but seed=42->22
[rank1]:"
[rank2]:2025-12-30 14:56:44,821 - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank2]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank2]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank2]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank2]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank2]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank2]:1227: everything same as 1224 but seed=42->11
[rank2]:1230: everything same as 1224 but seed=42->22
[rank2]:"
[rank1]:2025-12-30 14:56:44,844 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-12-30 14:56:44,846 - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-12-30 14:56:44,991 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-12-30 14:56:44,994 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-30 14:56:45,122 - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank0]:2025-12-30 14:56:48,293 - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank2]:2025-12-30 14:56:48,330 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-12-30 14:56:48,368 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-30 14:56:48,396 - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-12-30 14:56:48,396 - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-12-30 14:56:48,441 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-12-30 14:56:48,479 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-30 14:56:48,480 - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-12-30 14:56:48,507 - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-12-30 14:56:48,507 - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank2]:2025-12-30 14:56:48,632 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-30 14:56:48,632 - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-12-30 14:56:48,633 - CUDA memory usage for model: 0.92GiB(1.94%)
[rank0]:2025-12-30 14:56:48,701 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-30 14:56:48,701 - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-12-30 14:56:48,702 - CUDA memory usage for model: 1.90GiB(3.99%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank1]:2025-12-30 14:56:50,170 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-12-30 14:56:50,207 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-30 14:56:50,234 - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-12-30 14:56:50,234 - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2025-12-30 14:56:50,418 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-30 14:56:50,418 - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-12-30 14:56:50,419 - CUDA memory usage for model: 1.13GiB(2.39%)
[rank3]:wandb: setting up run 2jc21rrd
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1230_GPipe_timelyapf_22_dm1/20251230-1456/wandb/run-20251230_145649-2jc21rrd
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1230_GPipe_timelyapf_22_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/2jc21rrd
[rank3]:2025-12-30 14:56:50,830 - WandB logging enabled
[rank3]:2025-12-30 14:56:50,831 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-12-30 14:56:50,872 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-30 14:56:50,902 - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-12-30 14:56:50,902 - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank2]:2025-12-30 14:56:51,113 - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-12-30 14:56:51,096 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-30 14:56:51,097 - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-12-30 14:56:51,097 - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2025-12-30 14:56:51,112 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-30 14:56:51,112 - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1230_GPipe_timelyapf_22_dm1
[rank0]:2025-12-30 14:56:51,112 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-30 14:56:51,113 - Trainer is initialized with local batch size 16, global batch size 128, gradient accumulation steps 8, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2025-12-30 14:56:51,113 - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank1]:2025-12-30 14:56:51,113 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-30 14:56:53,698 - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-12-30 14:56:53,698 - Finished loading the checkpoint in 2.59 seconds.
[rank0]:2025-12-30 14:56:53,698 - Training starts at step 1
[rank0]:2025-12-30 14:56:59,307 -  step:  1  loss: -8.0000  grad_norm: 116.5372  memory: 13.25GiB(27.89%)  tps: 3,026  tflops: 23.66  mfu: 7.58%
[rank0]:2025-12-30 14:56:59,307 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-12-30 14:56:59,270 -  step:  1  loss: -8.0000  grad_norm: 116.5372  memory: 10.24GiB(21.56%)  tps: 3,006  tflops: 23.50  mfu: 7.53%
[rank2]:2025-12-30 14:56:59,271 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-12-30 14:56:59,279 -  step:  1  loss: 10.6088  grad_norm: 116.5372  memory: 24.19GiB(50.91%)  tps: 3,899  tflops: 30.48  mfu: 9.77%
[rank3]:2025-12-30 14:56:59,279 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-12-30 14:56:59,272 -  step:  1  loss: -8.0000  grad_norm: 116.5372  memory: 12.75GiB(26.83%)  tps: 3,615  tflops: 28.26  mfu: 9.06%
[rank1]:2025-12-30 14:56:59,273 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-12-30 14:58:58,080 - Avg. fwd time: 9.0808 / Avg. bwd time: 24.8903 / Avg. batch time: 564.4092 (ms) / GPU bubble ratio: 51.85%
[rank2]:2025-12-30 14:58:58,050 - Avg. fwd time: 6.9907 / Avg. bwd time: 19.3147 / Avg. batch time: 523.8063 (ms) / GPU bubble ratio: 59.82%
[rank3]:2025-12-30 14:58:58,025 - Avg. fwd time: 10.7723 / Avg. bwd time: 43.2104 / Avg. batch time: 491.6309 (ms) / GPU bubble ratio: 12.16%
[rank0]:2025-12-30 14:58:58,110 - Avg. fwd time: 8.1925 / Avg. bwd time: 25.1462 / Avg. batch time: 603.4223 (ms) / GPU bubble ratio: 55.80%
[rank0]:2025-12-30 15:00:57,575 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-30 15:01:02,449 - Avg. fwd time: 6.9916 / Avg. bwd time: 19.3570 / Avg. batch time: 525.3679 (ms) / GPU bubble ratio: 59.88%
[rank3]:2025-12-30 15:01:02,424 - Avg. fwd time: 10.7964 / Avg. bwd time: 43.4426 / Avg. batch time: 493.5816 (ms) / GPU bubble ratio: 12.09%
[rank0]:2025-12-30 15:01:02,508 - Avg. fwd time: 8.2038 / Avg. bwd time: 25.1922 / Avg. batch time: 604.0677 (ms) / GPU bubble ratio: 55.77%
[rank0]:2025-12-30 15:01:02,544 -  step: 50  loss: -8.0000  grad_norm: 12.6018  memory: 17.08GiB(35.95%)  tps: 6,601  tflops: 51.60  mfu: 16.54%
[rank1]:2025-12-30 15:01:02,478 - Avg. fwd time: 9.0864 / Avg. bwd time: 24.9438 / Avg. batch time: 565.4264 (ms) / GPU bubble ratio: 51.85%
[rank1]:2025-12-30 15:01:02,533 -  step: 50  loss: -8.0000  grad_norm: 12.6018  memory: 15.15GiB(31.89%)  tps: 6,600  tflops: 51.60  mfu: 16.54%
[rank2]:2025-12-30 15:01:02,530 -  step: 50  loss: -8.0000  grad_norm: 12.6018  memory: 12.26GiB(25.80%)  tps: 6,601  tflops: 51.60  mfu: 16.54%
[rank3]:2025-12-30 15:01:02,542 -  step: 50  loss:  9.9088  grad_norm: 12.6018  memory: 26.98GiB(56.79%)  tps: 6,600  tflops: 51.60  mfu: 16.54%
[rank3]:2025-12-30 15:01:47,129 - [Step 60] ã€°ï¸ Monitoring Upperbound
[rank3]:2025-12-30 15:02:36,926 - [Step 70] âœ”ï¸  Setting Upperbound
[rank3]:2025-12-30 15:02:37,237 - [Step 70] ã€°ï¸ Monitoring Lowerbound
[rank2]:2025-12-30 15:02:55,856 - Avg. fwd time: 6.9878 / Avg. bwd time: 18.4993 / Avg. batch time: 511.0662 (ms) / GPU bubble ratio: 60.10%
[rank0]:2025-12-30 15:02:55,876 - Avg. fwd time: 8.2009 / Avg. bwd time: 23.1982 / Avg. batch time: 586.3085 (ms) / GPU bubble ratio: 57.16%
[rank3]:2025-12-30 15:02:55,841 - Avg. fwd time: 10.8051 / Avg. bwd time: 41.7774 / Avg. batch time: 480.2849 (ms) / GPU bubble ratio: 12.41%
[rank1]:2025-12-30 15:02:55,872 - Avg. fwd time: 9.0862 / Avg. bwd time: 23.8272 / Avg. batch time: 549.8052 (ms) / GPU bubble ratio: 52.11%
[rank3]:2025-12-30 15:03:08,056 - [Step 80] âœ”ï¸  Setting Lowerbound
[rank3]:2025-12-30 15:03:08,380 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/pipeline_schedule/251230_1503_max_batch_time.svg
[rank3]:			> Batch Time: 538.32 ms, GPU Bubble Ratio: 49.95%, 49.09%, 60.56%, 18.50%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB4,F]  32-8-40ms      | [S0,MB5,F]  40-7-48ms      | [S0,MB6,F]  48-8-57ms      | [S0,MB7,F]  57-8-65ms      | [S0,MB0,B]  201-25-227ms   | [S0,MB1,B]  244-25-269ms   | [S0,MB2,B]  288-25-314ms   | [S0,MB3,B]  333-25-358ms   | [S0,MB4,B]  377-25-403ms   | [S0,MB5,B]  422-25-447ms   | [S0,MB6,B]  467-25-492ms   | [S0,MB7,B]  512-25-538ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  20-8-29ms      | [S1,MB2,F]  29-8-38ms      | [S1,MB3,F]  38-8-47ms      | [S1,MB4,F]  47-8-56ms      | [S1,MB5,F]  56-8-65ms      | [S1,MB6,F]  65-8-73ms      | [S1,MB7,F]  73-8-82ms      | [S1,MB0,B]  176-24-201ms   | [S1,MB1,B]  219-24-244ms   | [S1,MB2,B]  263-25-288ms   | [S1,MB3,B]  307-25-333ms   | [S1,MB4,B]  352-25-377ms   | [S1,MB5,B]  397-25-422ms   | [S1,MB6,B]  442-25-467ms   | [S1,MB7,B]  487-25-512ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  29-6-36ms      | [S2,MB2,F]  38-6-45ms      | [S2,MB3,F]  47-6-54ms      | [S2,MB4,F]  56-6-63ms      | [S2,MB5,F]  65-6-71ms      | [S2,MB6,F]  73-6-80ms      | [S2,MB7,F]  82-6-89ms      | [S2,MB0,B]  157-19-176ms   | [S2,MB1,B]  200-19-219ms   | [S2,MB2,B]  244-19-263ms   | [S2,MB3,B]  288-19-307ms   | [S2,MB4,B]  332-19-352ms   | [S2,MB5,B]  377-19-397ms   | [S2,MB6,B]  422-19-442ms   | [S2,MB7,B]  468-19-487ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  42-10-53ms     | [S3,MB2,F]  53-10-63ms     | [S3,MB3,F]  63-10-73ms     | [S3,MB4,F]  73-10-84ms     | [S3,MB5,F]  84-10-94ms     | [S3,MB6,F]  94-10-105ms    | [S3,MB7,F]  105-10-116ms   | [S3,MB0,B]  116-40-157ms   AFR(10):0.9655 | [S3,MB1,B]  157-43-200ms   AFR(10):0.9655 | [S3,MB2,B]  200-44-244ms   AFR(10):0.9655 | [S3,MB3,B]  244-44-288ms   AFR(10):0.9655 | [S3,MB4,B]  288-44-332ms   AFR(10):0.9655 | [S3,MB5,B]  332-44-377ms   AFR(10):0.9655 | [S3,MB6,B]  377-45-422ms   AFR(10):0.9655 | [S3,MB7,B]  422-45-468ms   AFR(10):0.9655
[rank3]:2025-12-30 15:03:08,506 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/pipeline_schedule/251230_1503_min_batch_time.svg
[rank3]:			> Batch Time: 306.81 ms, GPU Bubble Ratio: 78.50%, 48.32%, 60.08%, 15.77%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB4,F]  32-8-40ms      | [S0,MB5,F]  40-7-48ms      | [S0,MB6,F]  48-8-57ms      | [S0,MB7,F]  57-8-65ms      | [S0,MB0,B]  156-0-156ms    | [S0,MB1,B]  177-0-177ms    | [S0,MB2,B]  198-0-198ms    | [S0,MB3,B]  220-0-220ms    | [S0,MB4,B]  241-0-241ms    | [S0,MB5,B]  263-0-263ms    | [S0,MB6,B]  285-0-285ms    | [S0,MB7,B]  306-0-306ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  20-8-29ms      | [S1,MB2,F]  29-8-38ms      | [S1,MB3,F]  38-8-47ms      | [S1,MB4,F]  47-8-56ms      | [S1,MB5,F]  56-8-65ms      | [S1,MB6,F]  65-8-73ms      | [S1,MB7,F]  73-8-82ms      | [S1,MB0,B]  145-10-156ms   | [S1,MB1,B]  166-10-177ms   | [S1,MB2,B]  188-10-198ms   | [S1,MB3,B]  209-10-220ms   | [S1,MB4,B]  231-10-241ms   | [S1,MB5,B]  252-10-263ms   | [S1,MB6,B]  274-10-285ms   | [S1,MB7,B]  296-10-306ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  29-6-36ms      | [S2,MB2,F]  38-6-45ms      | [S2,MB3,F]  47-6-54ms      | [S2,MB4,F]  56-6-63ms      | [S2,MB5,F]  65-6-71ms      | [S2,MB6,F]  73-6-80ms      | [S2,MB7,F]  82-6-89ms      | [S2,MB0,B]  137-8-145ms    | [S2,MB1,B]  158-8-166ms    | [S2,MB2,B]  179-8-188ms    | [S2,MB3,B]  201-8-209ms    | [S2,MB4,B]  222-8-231ms    | [S2,MB5,B]  244-8-252ms    | [S2,MB6,B]  266-8-274ms    | [S2,MB7,B]  287-8-296ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  42-10-53ms     | [S3,MB2,F]  53-10-63ms     | [S3,MB3,F]  63-10-73ms     | [S3,MB4,F]  73-10-84ms     | [S3,MB5,F]  84-10-94ms     | [S3,MB6,F]  94-10-105ms    | [S3,MB7,F]  105-10-116ms   | [S3,MB0,B]  116-21-137ms   AFR(10):0.9655 | [S3,MB1,B]  137-21-158ms   AFR(10):0.9655 | [S3,MB2,B]  158-21-179ms   AFR(10):0.9655 | [S3,MB3,B]  179-21-201ms   AFR(10):0.9655 | [S3,MB4,B]  201-21-222ms   AFR(10):0.9655 | [S3,MB5,B]  222-21-244ms   AFR(10):0.9655 | [S3,MB6,B]  244-21-266ms   AFR(10):0.9655 | [S3,MB7,B]  266-21-287ms   AFR(10):0.9655
[rank3]:2025-12-30 15:03:08,642 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/pipeline_schedule/251230_1503_frozen_pipeline_schedule.svg
[rank3]:			> Batch Time: 339.67 ms, GPU Bubble Ratio: 41.44%, 33.22%, 40.88%, 14.24%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB4,F]  32-8-40ms      | [S0,MB5,F]  40-7-48ms      | [S0,MB6,F]  48-8-57ms      | [S0,MB7,F]  57-8-65ms      | [S0,MB0,B]  201-25-227ms   | [S0,MB1,B]  232-25-257ms   | [S0,MB2,B]  257-25-283ms   | [S0,MB3,B]  283-25-308ms   | [S0,MB4,B]  308-25-333ms   | [S0,MB5,B]  333-0-333ms    | [S0,MB6,B]  333-5-339ms    | [S0,MB7,B]  339-0-339ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  20-8-29ms      | [S1,MB2,F]  29-8-38ms      | [S1,MB3,F]  38-8-47ms      | [S1,MB4,F]  47-8-56ms      | [S1,MB5,F]  56-8-65ms      | [S1,MB6,F]  65-8-73ms      | [S1,MB7,F]  73-8-82ms      | [S1,MB0,B]  176-24-201ms   | [S1,MB1,B]  210-21-232ms   | [S1,MB2,B]  232-25-257ms   | [S1,MB3,B]  257-25-282ms   | [S1,MB4,B]  282-14-296ms   | [S1,MB5,B]  296-21-318ms   | [S1,MB6,B]  318-10-328ms   | [S1,MB7,B]  328-10-339ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  29-6-36ms      | [S2,MB2,F]  38-6-45ms      | [S2,MB3,F]  47-6-54ms      | [S2,MB4,F]  56-6-63ms      | [S2,MB5,F]  65-6-71ms      | [S2,MB6,F]  73-6-80ms      | [S2,MB7,F]  82-6-89ms      | [S2,MB0,B]  157-19-176ms   | [S2,MB1,B]  191-19-210ms   | [S2,MB2,B]  212-19-232ms   | [S2,MB3,B]  234-19-253ms   | [S2,MB4,B]  255-19-275ms   | [S2,MB5,B]  277-19-296ms   | [S2,MB6,B]  298-19-318ms   | [S2,MB7,B]  320-8-328ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  42-10-53ms     | [S3,MB2,F]  53-10-63ms     | [S3,MB3,F]  63-10-73ms     | [S3,MB4,F]  73-10-84ms     | [S3,MB5,F]  84-10-94ms     | [S3,MB6,F]  94-10-105ms    | [S3,MB7,F]  105-10-116ms   | [S3,MB0,B]  116-40-157ms   AFR(10):0.9655 | [S3,MB1,B]  157-34-191ms   AFR(10):0.9655 | [S3,MB2,B]  191-21-212ms   AFR(10):0.9655 | [S3,MB3,B]  212-21-234ms   AFR(10):0.9655 | [S3,MB4,B]  234-21-255ms   AFR(10):0.9655 | [S3,MB5,B]  255-21-277ms   AFR(10):0.9655 | [S3,MB6,B]  277-21-298ms   AFR(10):0.9655 | [S3,MB7,B]  298-21-320ms   AFR(10):0.9655
[rank3]:2025-12-30 15:03:08,642 - 	> Batch Time: 339.67 ms (Average Freeze Ratio: 0.42, Time Reduction Rate: 0.37)
[rank2]:2025-12-30 15:04:31,969 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.01/0.02, [MB7] 0.33/1.00
[rank1]:2025-12-30 15:04:31,977 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.08/0.25, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.25/0.75, [MB5] 0.09/0.26, [MB6] 0.33/1.00, [MB7] 0.33/1.00
[rank0]:2025-12-30 15:04:31,943 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-30 15:04:32,001 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.33/1.00, [MB6] 0.26/0.77, [MB7] 0.33/1.00
[rank3]:2025-12-30 15:04:31,993 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.13/0.40, [MB2] 0.33/1.00, [MB3] 0.33/1.00, [MB4] 0.33/1.00, [MB5] 0.33/1.00, [MB6] 0.33/1.00, [MB7] 0.33/1.00
[rank3]:2025-12-30 15:04:36,437 - Avg. fwd time: 10.7899 / Avg. bwd time: 39.1796 / Avg. batch time: 459.3603 (ms) / GPU bubble ratio: 12.98%
[rank2]:2025-12-30 15:04:36,457 - Avg. fwd time: 6.9834 / Avg. bwd time: 18.1198 / Avg. batch time: 491.9827 (ms) / GPU bubble ratio: 59.18%
[rank2]:2025-12-30 15:04:36,525 -  step: 100  loss: -8.0000  grad_norm:  7.8304  memory: 13.15GiB(27.69%)  tps: 7,656  tflops: 59.85  mfu: 19.18%
[rank1]:2025-12-30 15:04:36,482 - Avg. fwd time: 9.0936 / Avg. bwd time: 22.9200 / Avg. batch time: 528.9186 (ms) / GPU bubble ratio: 51.58%
[rank1]:2025-12-30 15:04:36,528 -  step: 100  loss: -8.0000  grad_norm:  7.8304  memory: 16.21GiB(34.11%)  tps: 7,656  tflops: 59.85  mfu: 19.18%
[rank0]:2025-12-30 15:04:36,503 - Avg. fwd time: 8.1819 / Avg. bwd time: 21.6196 / Avg. batch time: 561.2837 (ms) / GPU bubble ratio: 57.52%
[rank0]:2025-12-30 15:04:36,540 -  step: 100  loss: -8.0000  grad_norm:  7.8304  memory: 19.07GiB(40.15%)  tps: 7,656  tflops: 59.85  mfu: 19.18%
[rank3]:2025-12-30 15:04:36,539 -  step: 100  loss:  8.6925  grad_norm:  7.8304  memory: 29.36GiB(61.81%)  tps: 7,656  tflops: 59.85  mfu: 19.18%
[rank2]:2025-12-30 15:04:36,600 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/frozen_ratio_history/rank2/251230_1504_stage2_step100.svg
[rank1]:2025-12-30 15:04:36,600 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/frozen_ratio_history/rank1/251230_1504_stage1_step100.svg
[rank0]:2025-12-30 15:04:36,603 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/frozen_ratio_history/rank0/251230_1504_stage0_step100.svg
[rank3]:2025-12-30 15:04:36,690 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/pipeline_schedule/251230_1504_step100_rank3.svg
[rank3]:			> Batch Time: 564.95 ms, GPU Bubble Ratio: 56.33%, 53.55%, 63.23%, 27.19%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB4,F]  32-8-40ms      | [S0,MB5,F]  40-7-48ms      | [S0,MB6,F]  48-8-56ms      | [S0,MB7,F]  56-8-65ms      | [S0,MB0,B]  271-25-296ms   | [S0,MB1,B]  312-25-337ms   | [S0,MB2,B]  354-25-380ms   | [S0,MB3,B]  394-25-420ms   | [S0,MB4,B]  430-25-456ms   | [S0,MB5,B]  474-16-490ms   | [S0,MB6,B]  514-22-536ms   | [S0,MB7,B]  549-15-564ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-10-20ms      | [S1,MB1,F]  23-8-32ms      | [S1,MB2,F]  35-8-44ms      | [S1,MB3,F]  56-8-65ms      | [S1,MB4,F]  74-8-83ms      | [S1,MB5,F]  92-8-100ms     | [S1,MB6,F]  110-8-118ms    | [S1,MB7,F]  127-8-136ms    | [S1,MB0,B]  243-24-268ms   | [S1,MB1,B]  285-23-309ms   | [S1,MB2,B]  326-25-351ms   | [S1,MB3,B]  365-25-391ms   | [S1,MB4,B]  405-22-427ms   | [S1,MB5,B]  445-24-470ms   | [S1,MB6,B]  488-22-510ms   | [S1,MB7,B]  523-22-545ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-6-39ms      | [S2,MB2,F]  53-6-60ms      | [S2,MB3,F]  71-6-77ms      | [S2,MB4,F]  89-6-95ms      | [S2,MB5,F]  107-6-113ms    | [S2,MB6,F]  124-6-131ms    | [S2,MB7,F]  142-6-149ms    | [S2,MB0,B]  220-19-240ms   | [S2,MB1,B]  263-19-282ms   | [S2,MB2,B]  304-19-323ms   | [S2,MB3,B]  342-19-362ms   | [S2,MB4,B]  382-19-402ms   | [S2,MB5,B]  423-19-442ms   | [S2,MB6,B]  465-19-485ms   | [S2,MB7,B]  504-15-519ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  50-10-60ms     | [S3,MB2,F]  68-10-78ms     | [S3,MB3,F]  85-10-96ms     | [S3,MB4,F]  103-10-114ms   | [S3,MB5,F]  121-10-132ms   | [S3,MB6,F]  139-10-150ms   | [S3,MB7,F]  158-10-168ms   | [S3,MB0,B]  174-40-214ms   | [S3,MB1,B]  214-41-255ms   | [S3,MB2,B]  256-40-296ms   | [S3,MB3,B]  297-39-336ms   | [S3,MB4,B]  336-39-375ms   | [S3,MB5,B]  376-40-416ms   | [S3,MB6,B]  416-42-458ms   | [S3,MB7,B]  459-41-501ms  
[rank3]:2025-12-30 15:04:36,735 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/frozen_ratio_history/rank3/251230_1504_stage3_step100.svg
[rank2]:2025-12-30 15:04:36,755 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/frozen_params_histogram/251230_1504_rank2_stage2.svg
[rank2]:	> Counts Sum: 26800, Total Sum: 69120 (38.77%), Ratio(%) per element: [37.5, 37.5, 41.66, 37.5, 37.5, 41.66, 37.5, 37.5, 37.5, 41.66, 37.5, 37.5, 37.5, 37.5, 37.5, 41.66, 37.5, 37.5, 37.5, 37.5, 37.5, 37.5, 41.66, 41.66, 37.5, 37.5, 37.5, 37.5, 41.66, 41.66, 41.66, 41.66, 37.5, 41.66, 37.5, 37.5]
[rank1]:2025-12-30 15:04:36,752 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/frozen_params_histogram/251230_1504_rank1_stage1.svg
[rank1]:	> Counts Sum: 43680, Total Sum: 86400 (50.56%), Ratio(%) per element: [50.0, 50.0, 54.16, 58.33, 45.83, 54.16, 50.0, 45.83, 50.0, 54.16, 50.0, 54.16, 54.16, 45.83, 50.0, 50.0, 45.83, 45.83, 54.16, 58.33, 58.33, 54.16, 50.0, 45.83, 50.0, 54.16, 50.0, 45.83, 50.0, 50.0, 50.0, 45.83, 41.66, 50.0, 50.0, 45.83, 45.83, 54.16, 58.33, 45.83, 50.0, 62.5, 50.0, 50.0, 45.83]
[rank1]:2025-12-30 15:04:36,843 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/afr_time_plot/251230_1504_stage1.svg
[rank0]:2025-12-30 15:04:36,783 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/frozen_params_histogram/251230_1504_rank0_stage0.svg
[rank0]:	> Counts Sum: 34160, Total Sum: 71040 (48.09%), Ratio(%) per element: [54.16, 45.83, 54.16, 50.0, 50.0, 45.83, 45.83, 54.16, 45.83, 41.66, 45.83, 50.0, 45.83, 45.83, 45.83, 54.16, 50.0, 45.83, 45.83, 50.0, 50.0, 50.0, 50.0, 50.0, 45.83, 45.83, 45.83, 45.83, 45.83, 54.16, 45.83, 45.83, 45.83, 54.16, 45.83, 45.83, 45.83]
[rank2]:2025-12-30 15:04:36,844 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/afr_time_plot/251230_1504_stage2.svg
[rank0]:2025-12-30 15:04:36,887 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/afr_time_plot/251230_1504_stage0.svg
[rank3]:2025-12-30 15:04:36,872 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/frozen_params_histogram/251230_1504_rank3_stage3.svg
[rank3]:	> Counts Sum: 36880, Total Sum: 55680 (66.24%), Ratio(%) per element: [79.16, 62.5, 66.66, 75.0, 70.83, 66.66, 70.83, 58.33, 58.33, 79.16, 66.66, 70.83, 58.33, 70.83, 70.83, 75.0, 58.33, 50.0, 62.5, 70.83, 66.66, 66.66, 75.0, 62.5, 70.83, 54.16, 62.5, 58.33, 62.5]
[rank3]:2025-12-30 15:04:36,962 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/afr_time_plot/251230_1504_stage3.svg
[rank3]:2025-12-30 15:06:30,137 - Avg. fwd time: 10.7828 / Avg. bwd time: 39.1990 / Avg. batch time: 459.4473 (ms) / GPU bubble ratio: 12.97%
[rank1]:2025-12-30 15:06:30,181 - Avg. fwd time: 9.0933 / Avg. bwd time: 22.8070 / Avg. batch time: 527.0611 (ms) / GPU bubble ratio: 51.58%
[rank2]:2025-12-30 15:06:30,158 - Avg. fwd time: 6.9790 / Avg. bwd time: 18.2836 / Avg. batch time: 490.9595 (ms) / GPU bubble ratio: 58.84%
[rank0]:2025-12-30 15:06:30,205 - Avg. fwd time: 8.1779 / Avg. bwd time: 21.7386 / Avg. batch time: 558.7755 (ms) / GPU bubble ratio: 57.17%
[rank2]:2025-12-30 15:08:16,779 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.02/0.02, [MB7] 0.67/1.00
[rank3]:2025-12-30 15:08:16,803 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.27/0.40, [MB2] 0.67/1.00, [MB3] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank1]:2025-12-30 15:08:16,786 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.17/0.25, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.50/0.75, [MB5] 0.18/0.26, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank0]:2025-12-30 15:08:16,762 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-30 15:08:16,809 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.67/1.00, [MB6] 0.52/0.77, [MB7] 0.67/1.00
[rank2]:2025-12-30 15:08:21,023 - Avg. fwd time: 6.9762 / Avg. bwd time: 18.3484 / Avg. batch time: 488.2902 (ms) / GPU bubble ratio: 58.51%
[rank3]:2025-12-30 15:08:21,006 - Avg. fwd time: 10.7809 / Avg. bwd time: 39.0193 / Avg. batch time: 457.9895 (ms) / GPU bubble ratio: 13.01%
[rank1]:2025-12-30 15:08:21,042 - Avg. fwd time: 9.0913 / Avg. bwd time: 22.6101 / Avg. batch time: 523.5377 (ms) / GPU bubble ratio: 51.56%
[rank2]:2025-12-30 15:08:21,079 -  step: 150  loss: -8.0000  grad_norm: 11.9971  memory: 13.15GiB(27.69%)  tps: 7,296  tflops: 57.04  mfu: 18.28%
[rank3]:2025-12-30 15:08:21,093 -  step: 150  loss:  3.9615  grad_norm: 11.9971  memory: 29.36GiB(61.81%)  tps: 7,296  tflops: 57.04  mfu: 18.28%
[rank1]:2025-12-30 15:08:21,083 -  step: 150  loss: -8.0000  grad_norm: 11.9971  memory: 16.34GiB(34.40%)  tps: 7,296  tflops: 57.04  mfu: 18.28%
[rank0]:2025-12-30 15:08:21,057 - Avg. fwd time: 8.1694 / Avg. bwd time: 21.6535 / Avg. batch time: 554.8993 (ms) / GPU bubble ratio: 57.00%
[rank0]:2025-12-30 15:08:21,093 -  step: 150  loss: -8.0000  grad_norm: 11.9971  memory: 19.07GiB(40.15%)  tps: 7,296  tflops: 57.04  mfu: 18.28%
[rank0]:2025-12-30 15:10:06,258 - Avg. fwd time: 8.1673 / Avg. bwd time: 21.4176 / Avg. batch time: 548.1099 (ms) / GPU bubble ratio: 56.82%
[rank3]:2025-12-30 15:10:06,210 - Avg. fwd time: 10.7861 / Avg. bwd time: 38.6183 / Avg. batch time: 454.8258 (ms) / GPU bubble ratio: 13.10%
[rank1]:2025-12-30 15:10:06,243 - Avg. fwd time: 9.0877 / Avg. bwd time: 22.2496 / Avg. batch time: 518.0318 (ms) / GPU bubble ratio: 51.61%
[rank2]:2025-12-30 15:10:06,226 - Avg. fwd time: 6.9738 / Avg. bwd time: 18.3608 / Avg. batch time: 483.9175 (ms) / GPU bubble ratio: 58.12%
[rank0]:2025-12-30 15:11:39,533 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-30 15:11:39,591 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 1.00/1.00, [MB6] 0.77/0.77, [MB7] 1.00/1.00
[rank2]:2025-12-30 15:11:39,560 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.02/0.02, [MB7] 1.00/1.00
[rank3]:2025-12-30 15:11:39,585 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.40/0.40, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-12-30 15:11:39,570 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.25/0.25, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.75/0.75, [MB5] 0.26/0.26, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-12-30 15:11:43,286 - Avg. fwd time: 10.7844 / Avg. bwd time: 37.6818 / Avg. batch time: 447.3117 (ms) / GPU bubble ratio: 13.32%
[rank0]:2025-12-30 15:11:43,346 - Avg. fwd time: 8.1744 / Avg. bwd time: 21.1567 / Avg. batch time: 537.9748 (ms) / GPU bubble ratio: 56.38%
[rank0]:2025-12-30 15:11:43,382 -  step: 200  loss: -8.0000  grad_norm:  2.6342  memory: 19.07GiB(40.15%)  tps: 8,099  tflops: 63.32  mfu: 20.29%
[rank2]:2025-12-30 15:11:43,322 - Avg. fwd time: 6.9721 / Avg. bwd time: 18.3703 / Avg. batch time: 475.9383 (ms) / GPU bubble ratio: 57.40%
[rank2]:2025-12-30 15:11:43,368 -  step: 200  loss: -8.0000  grad_norm:  2.6342  memory: 13.15GiB(27.69%)  tps: 8,099  tflops: 63.32  mfu: 20.29%
[rank3]:2025-12-30 15:11:43,381 -  step: 200  loss:  1.4057  grad_norm:  2.6342  memory: 29.36GiB(61.81%)  tps: 8,099  tflops: 63.32  mfu: 20.29%
[rank1]:2025-12-30 15:11:43,340 - Avg. fwd time: 9.0900 / Avg. bwd time: 21.9127 / Avg. batch time: 509.1678 (ms) / GPU bubble ratio: 51.29%
[rank1]:2025-12-30 15:11:43,372 -  step: 200  loss: -8.0000  grad_norm:  2.6342  memory: 16.40GiB(34.52%)  tps: 8,099  tflops: 63.32  mfu: 20.29%
[rank0]:2025-12-30 15:11:43,431 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/frozen_ratio_history/rank0/251230_1511_stage0_step200.svg
[rank2]:2025-12-30 15:11:43,431 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/frozen_ratio_history/rank2/251230_1511_stage2_step200.svg
[rank1]:2025-12-30 15:11:43,432 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/frozen_ratio_history/rank1/251230_1511_stage1_step200.svg
[rank0]:2025-12-30 15:11:43,584 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/frozen_params_histogram/251230_1511_rank0_stage0.svg
[rank0]:	> Counts Sum: 86240, Total Sum: 307840 (28.01%), Ratio(%) per element: [35.57, 35.57, 31.73, 29.8, 27.88, 29.8, 31.73, 32.69, 11.53, 11.53, 31.73, 27.88, 28.84, 35.57, 33.65, 30.76, 34.61, 13.46, 17.3, 32.69, 32.69, 33.65, 29.8, 33.65, 31.73, 30.76, 14.42, 20.19, 28.84, 31.73, 32.69, 31.73, 26.92, 32.69, 30.76, 15.38, 14.42]
[rank2]:2025-12-30 15:11:43,580 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/frozen_params_histogram/251230_1511_rank2_stage2.svg
[rank2]:	> Counts Sum: 45440, Total Sum: 299520 (15.17%), Ratio(%) per element: [18.26, 17.3, 16.34, 16.34, 17.3, 18.26, 15.38, 9.61, 10.57, 17.3, 17.3, 15.38, 15.38, 15.38, 14.42, 17.3, 10.57, 10.57, 16.34, 18.26, 15.38, 16.34, 15.38, 17.3, 14.42, 9.61, 10.57, 17.3, 17.3, 17.3, 18.26, 16.34, 16.34, 17.3, 9.61, 9.61]
[rank3]:2025-12-30 15:11:43,519 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/pipeline_schedule/251230_1511_step200_rank3.svg
[rank3]:			> Batch Time: 459.30 ms, GPU Bubble Ratio: 51.99%, 50.47%, 55.64%, 29.48%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB4,F]  32-8-41ms      | [S0,MB5,F]  41-8-49ms      | [S0,MB6,F]  49-8-57ms      | [S0,MB7,F]  57-8-66ms      | [S0,MB0,B]  273-25-298ms   | [S0,MB1,B]  309-25-334ms   | [S0,MB2,B]  338-25-364ms   | [S0,MB3,B]  370-25-396ms   | [S0,MB4,B]  398-25-423ms   | [S0,MB5,B]  425-9-434ms    | [S0,MB6,B]  440-12-452ms   | [S0,MB7,B]  454-4-459ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  24-8-32ms      | [S1,MB2,F]  35-8-44ms      | [S1,MB3,F]  56-9-65ms      | [S1,MB4,F]  74-8-83ms      | [S1,MB5,F]  92-8-101ms     | [S1,MB6,F]  110-8-118ms    | [S1,MB7,F]  128-8-136ms    | [S1,MB0,B]  244-25-269ms   | [S1,MB1,B]  284-21-305ms   | [S1,MB2,B]  309-25-335ms   | [S1,MB3,B]  340-25-366ms   | [S1,MB4,B]  370-13-384ms   | [S1,MB5,B]  397-20-418ms   | [S1,MB6,B]  425-11-436ms   | [S1,MB7,B]  439-11-451ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-6-39ms      | [S2,MB2,F]  53-6-60ms      | [S2,MB3,F]  71-6-78ms      | [S2,MB4,F]  89-6-95ms      | [S2,MB5,F]  107-6-113ms    | [S2,MB6,F]  125-6-131ms    | [S2,MB7,F]  143-6-149ms    | [S2,MB0,B]  221-19-241ms   | [S2,MB1,B]  261-19-281ms   | [S2,MB2,B]  286-19-306ms   | [S2,MB3,B]  316-19-336ms   | [S2,MB4,B]  342-20-362ms   | [S2,MB5,B]  370-20-390ms   | [S2,MB6,B]  397-20-417ms   | [S2,MB7,B]  425-8-434ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  50-10-60ms     | [S3,MB2,F]  68-10-78ms     | [S3,MB3,F]  86-10-96ms     | [S3,MB4,F]  103-10-114ms   | [S3,MB5,F]  121-10-132ms   | [S3,MB6,F]  140-10-150ms   | [S3,MB7,F]  158-10-168ms   | [S3,MB0,B]  174-40-215ms   | [S3,MB1,B]  215-39-254ms   | [S3,MB2,B]  254-23-278ms   | [S3,MB3,B]  277-32-310ms   | [S3,MB4,B]  309-23-332ms   | [S3,MB5,B]  332-22-354ms   | [S3,MB6,B]  354-22-377ms   | [S3,MB7,B]  377-33-410ms  
[rank3]:2025-12-30 15:11:43,562 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/frozen_ratio_history/rank3/251230_1511_stage3_step200.svg
[rank1]:2025-12-30 15:11:43,576 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/frozen_params_histogram/251230_1511_rank1_stage1.svg
[rank1]:	> Counts Sum: 118080, Total Sum: 374400 (31.54%), Ratio(%) per element: [32.69, 36.53, 38.46, 38.46, 33.65, 41.34, 32.69, 12.5, 12.5, 36.53, 32.69, 35.57, 34.61, 32.69, 42.3, 33.65, 13.46, 11.53, 35.57, 33.65, 41.34, 38.46, 34.61, 33.65, 30.76, 25.96, 29.8, 34.61, 29.8, 34.61, 35.57, 35.57, 35.57, 31.73, 16.34, 13.46, 36.53, 41.34, 40.38, 35.57, 35.57, 39.42, 38.46, 17.3, 11.53]
[rank3]:2025-12-30 15:11:43,697 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/frozen_params_histogram/251230_1511_rank3_stage3.svg
[rank3]:	> Counts Sum: 130640, Total Sum: 241280 (54.14%), Ratio(%) per element: [72.11, 60.57, 66.34, 68.26, 66.34, 68.26, 68.26, 25.0, 22.11, 71.15, 66.34, 70.19, 59.61, 61.53, 65.38, 67.3, 22.11, 22.11, 61.53, 69.23, 63.46, 60.57, 68.26, 66.34, 65.38, 25.96, 21.15, 22.11, 23.07]
[rank0]:2025-12-30 15:11:43,936 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/afr_time_plot/251230_1511_stage0.svg
[rank2]:2025-12-30 15:11:43,918 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/afr_time_plot/251230_1511_stage2.svg
[rank1]:2025-12-30 15:11:43,918 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/afr_time_plot/251230_1511_stage1.svg
[rank3]:2025-12-30 15:11:44,027 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/afr_time_plot/251230_1511_stage3.svg
[rank3]:2025-12-30 15:13:17,701 - Avg. fwd time: 10.7798 / Avg. bwd time: 36.4584 / Avg. batch time: 437.4829 (ms) / GPU bubble ratio: 13.62%
[rank0]:2025-12-30 15:13:17,766 - Avg. fwd time: 8.1757 / Avg. bwd time: 20.7059 / Avg. batch time: 528.3353 (ms) / GPU bubble ratio: 56.27%
[rank2]:2025-12-30 15:13:17,741 - Avg. fwd time: 6.9709 / Avg. bwd time: 18.3839 / Avg. batch time: 468.5777 (ms) / GPU bubble ratio: 56.71%
[rank1]:2025-12-30 15:13:17,759 - Avg. fwd time: 9.0964 / Avg. bwd time: 21.6149 / Avg. batch time: 501.2895 (ms) / GPU bubble ratio: 50.99%
[rank0]:2025-12-30 15:14:47,721 - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-12-30 15:14:47,739 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.02/0.02, [MB7] 1.00/1.00
[rank1]:2025-12-30 15:14:47,749 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.25/0.25, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.75/0.75, [MB5] 0.26/0.26, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank0]:2025-12-30 15:14:47,768 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 1.00/1.00, [MB6] 0.77/0.77, [MB7] 1.00/1.00
[rank3]:2025-12-30 15:14:47,762 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.40/0.40, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-12-30 15:14:51,420 - Avg. fwd time: 10.7747 / Avg. bwd time: 35.4670 / Avg. batch time: 429.5039 (ms) / GPU bubble ratio: 13.87%
[rank2]:2025-12-30 15:14:51,462 - Avg. fwd time: 6.9700 / Avg. bwd time: 18.3976 / Avg. batch time: 462.5498 (ms) / GPU bubble ratio: 56.13%
[rank2]:2025-12-30 15:14:51,510 -  step: 250  loss: -8.0000  grad_norm:  0.6838  memory: 13.15GiB(27.69%)  tps: 8,708  tflops: 68.08  mfu: 21.82%
[rank0]:2025-12-30 15:14:51,488 - Avg. fwd time: 8.1778 / Avg. bwd time: 20.3491 / Avg. batch time: 520.5035 (ms) / GPU bubble ratio: 56.15%
[rank0]:2025-12-30 15:14:51,524 -  step: 250  loss: -8.0000  grad_norm:  0.6838  memory: 19.07GiB(40.15%)  tps: 8,708  tflops: 68.08  mfu: 21.82%
[rank1]:2025-12-30 15:14:51,481 - Avg. fwd time: 9.1012 / Avg. bwd time: 21.3842 / Avg. batch time: 494.8579 (ms) / GPU bubble ratio: 50.72%
[rank1]:2025-12-30 15:14:51,513 -  step: 250  loss: -8.0000  grad_norm:  0.6838  memory: 16.40GiB(34.52%)  tps: 8,708  tflops: 68.08  mfu: 21.82%
[rank3]:2025-12-30 15:14:51,523 -  step: 250  loss:  0.4609  grad_norm:  0.6838  memory: 29.36GiB(61.81%)  tps: 8,708  tflops: 68.08  mfu: 21.82%
[rank1]:2025-12-30 15:16:25,062 - Avg. fwd time: 9.1026 / Avg. bwd time: 21.1810 / Avg. batch time: 489.5490 (ms) / GPU bubble ratio: 50.51%
[rank2]:2025-12-30 15:16:25,043 - Avg. fwd time: 6.9687 / Avg. bwd time: 18.4153 / Avg. batch time: 457.5877 (ms) / GPU bubble ratio: 55.62%
[rank0]:2025-12-30 15:16:25,069 - Avg. fwd time: 8.1778 / Avg. bwd time: 20.0571 / Avg. batch time: 514.0413 (ms) / GPU bubble ratio: 56.06%
[rank3]:2025-12-30 15:16:25,004 - Avg. fwd time: 10.7665 / Avg. bwd time: 34.6580 / Avg. batch time: 422.9601 (ms) / GPU bubble ratio: 14.08%
[rank2]:2025-12-30 15:17:54,644 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.02/0.02, [MB7] 1.00/1.00
[rank1]:2025-12-30 15:17:54,652 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.25/0.25, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.75/0.75, [MB5] 0.26/0.26, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank0]:2025-12-30 15:17:54,617 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-30 15:17:54,673 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 1.00/1.00, [MB6] 0.77/0.77, [MB7] 1.00/1.00
[rank3]:2025-12-30 15:17:54,668 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.40/0.40, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-12-30 15:17:58,318 - Avg. fwd time: 10.7568 / Avg. bwd time: 33.9726 / Avg. batch time: 417.3940 (ms) / GPU bubble ratio: 14.27%
[rank2]:2025-12-30 15:17:58,357 - Avg. fwd time: 6.9665 / Avg. bwd time: 18.4227 / Avg. batch time: 453.3329 (ms) / GPU bubble ratio: 55.20%
[rank1]:2025-12-30 15:17:58,376 - Avg. fwd time: 9.1030 / Avg. bwd time: 21.0212 / Avg. batch time: 485.0178 (ms) / GPU bubble ratio: 50.31%
[rank0]:2025-12-30 15:17:58,383 - Avg. fwd time: 8.1776 / Avg. bwd time: 19.8114 / Avg. batch time: 508.5459 (ms) / GPU bubble ratio: 55.97%
[rank3]:2025-12-30 15:17:58,418 -  step: 300  loss:  0.3123  grad_norm:  0.3357  memory: 29.36GiB(61.81%)  tps: 8,767  tflops: 68.53  mfu: 21.97%
[rank2]:2025-12-30 15:17:58,405 -  step: 300  loss: -8.0000  grad_norm:  0.3357  memory: 13.15GiB(27.69%)  tps: 8,766  tflops: 68.53  mfu: 21.97%
[rank2]:2025-12-30 15:17:58,467 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/frozen_ratio_history/rank2/251230_1517_stage2_step300.svg
[rank1]:2025-12-30 15:17:58,409 -  step: 300  loss: -8.0000  grad_norm:  0.3357  memory: 16.40GiB(34.52%)  tps: 8,766  tflops: 68.53  mfu: 21.97%
[rank1]:2025-12-30 15:17:58,467 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/frozen_ratio_history/rank1/251230_1517_stage1_step300.svg
[rank0]:2025-12-30 15:17:58,420 -  step: 300  loss: -8.0000  grad_norm:  0.3357  memory: 19.09GiB(40.19%)  tps: 8,766  tflops: 68.53  mfu: 21.97%
[rank0]:2025-12-30 15:17:58,467 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/frozen_ratio_history/rank0/251230_1517_stage0_step300.svg
[rank3]:2025-12-30 15:17:58,555 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/pipeline_schedule/251230_1517_step300_rank3.svg
[rank3]:			> Batch Time: 448.00 ms, GPU Bubble Ratio: 54.87%, 49.45%, 54.44%, 33.64%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-7-32ms      | [S0,MB4,F]  32-8-40ms      | [S0,MB5,F]  40-7-48ms      | [S0,MB6,F]  48-8-56ms      | [S0,MB7,F]  56-8-65ms      | [S0,MB0,B]  271-25-297ms   | [S0,MB1,B]  304-25-329ms   | [S0,MB2,B]  334-25-359ms   | [S0,MB3,B]  363-25-389ms   | [S0,MB4,B]  391-25-416ms   | [S0,MB5,B]  418-0-418ms    | [S0,MB6,B]  433-9-442ms    | [S0,MB7,B]  448-0-448ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-8-32ms      | [S1,MB2,F]  35-8-44ms      | [S1,MB3,F]  56-8-65ms      | [S1,MB4,F]  74-8-83ms      | [S1,MB5,F]  91-8-100ms     | [S1,MB6,F]  109-8-118ms    | [S1,MB7,F]  127-8-136ms    | [S1,MB0,B]  243-25-268ms   | [S1,MB1,B]  280-20-300ms   | [S1,MB2,B]  306-25-331ms   | [S1,MB3,B]  334-25-360ms   | [S1,MB4,B]  363-12-376ms   | [S1,MB5,B]  390-21-412ms   | [S1,MB6,B]  418-11-429ms   | [S1,MB7,B]  432-11-444ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-6-39ms      | [S2,MB2,F]  53-6-60ms      | [S2,MB3,F]  71-6-77ms      | [S2,MB4,F]  88-6-95ms      | [S2,MB5,F]  106-6-113ms    | [S2,MB6,F]  124-6-131ms    | [S2,MB7,F]  142-6-149ms    | [S2,MB0,B]  220-19-240ms   | [S2,MB1,B]  257-19-277ms   | [S2,MB2,B]  282-20-302ms   | [S2,MB3,B]  306-20-326ms   | [S2,MB4,B]  334-20-354ms   | [S2,MB5,B]  363-20-383ms   | [S2,MB6,B]  390-19-410ms   | [S2,MB7,B]  418-8-426ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  50-10-60ms     | [S3,MB2,F]  67-10-78ms     | [S3,MB3,F]  85-10-95ms     | [S3,MB4,F]  103-10-113ms   | [S3,MB5,F]  121-10-131ms   | [S3,MB6,F]  139-10-150ms   | [S3,MB7,F]  157-10-168ms   | [S3,MB0,B]  173-40-214ms   | [S3,MB1,B]  213-36-250ms   | [S3,MB2,B]  250-23-274ms   | [S3,MB3,B]  273-21-295ms   | [S3,MB4,B]  295-22-317ms   | [S3,MB5,B]  317-22-340ms   | [S3,MB6,B]  340-22-363ms   | [S3,MB7,B]  362-22-384ms  
[rank3]:2025-12-30 15:17:58,599 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/frozen_ratio_history/rank3/251230_1517_stage3_step300.svg
[rank2]:2025-12-30 15:17:58,617 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/frozen_params_histogram/251230_1517_rank2_stage2.svg
[rank2]:	> Counts Sum: 75040, Total Sum: 529920 (14.16%), Ratio(%) per element: [16.3, 15.21, 14.67, 14.67, 15.21, 15.76, 14.67, 10.86, 11.41, 15.21, 15.21, 14.13, 14.13, 14.13, 13.58, 15.21, 11.41, 11.41, 14.67, 15.76, 14.13, 15.21, 14.13, 15.76, 13.58, 10.86, 11.41, 15.76, 15.76, 16.3, 15.76, 14.67, 15.21, 15.76, 10.86, 10.86]
[rank1]:2025-12-30 15:17:58,612 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/frozen_params_histogram/251230_1517_rank1_stage1.svg
[rank1]:	> Counts Sum: 235680, Total Sum: 662400 (35.58%), Ratio(%) per element: [36.41, 38.58, 42.39, 41.3, 39.13, 42.93, 39.67, 17.93, 18.47, 41.84, 39.13, 39.67, 37.5, 38.04, 45.1, 38.04, 19.02, 17.93, 40.76, 38.04, 41.84, 41.3, 37.5, 38.04, 36.41, 26.08, 27.71, 39.67, 36.95, 39.13, 37.5, 39.67, 41.3, 35.86, 21.19, 18.47, 41.3, 43.47, 40.76, 41.84, 40.76, 41.84, 41.84, 21.19, 17.39]
[rank0]:2025-12-30 15:17:58,622 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/frozen_params_histogram/251230_1517_rank0_stage0.svg
[rank0]:	> Counts Sum: 168640, Total Sum: 544640 (30.96%), Ratio(%) per element: [36.41, 36.41, 34.23, 33.15, 32.06, 32.6, 34.23, 34.23, 17.39, 17.93, 34.23, 32.06, 32.6, 36.41, 35.32, 33.69, 35.86, 18.47, 21.19, 34.23, 34.78, 35.32, 33.15, 35.32, 34.23, 33.15, 19.02, 22.82, 32.6, 34.23, 34.78, 34.23, 31.52, 34.23, 33.69, 20.1, 19.56]
[rank3]:2025-12-30 15:17:58,733 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/frozen_params_histogram/251230_1517_rank3_stage3.svg
[rank3]:	> Counts Sum: 279440, Total Sum: 426880 (65.46%), Ratio(%) per element: [76.08, 71.19, 74.45, 73.91, 72.82, 74.45, 73.91, 46.73, 45.1, 76.08, 71.73, 74.45, 69.56, 71.73, 73.36, 73.91, 45.1, 45.1, 69.56, 75.54, 72.82, 67.93, 75.0, 73.36, 71.19, 47.82, 44.56, 45.1, 45.65]
[rank2]:2025-12-30 15:17:59,202 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/afr_time_plot/251230_1517_stage2.svg
[rank1]:2025-12-30 15:17:59,207 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/afr_time_plot/251230_1517_stage1.svg
[rank0]:2025-12-30 15:17:59,237 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/afr_time_plot/251230_1517_stage0.svg
[rank3]:2025-12-30 15:17:59,309 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/afr_time_plot/251230_1517_stage3.svg
[rank3]:2025-12-30 15:19:32,636 - Avg. fwd time: 10.7498 / Avg. bwd time: 33.4042 / Avg. batch time: 412.7859 (ms) / GPU bubble ratio: 14.43%
[rank2]:2025-12-30 15:19:32,678 - Avg. fwd time: 6.9651 / Avg. bwd time: 18.4316 / Avg. batch time: 449.8605 (ms) / GPU bubble ratio: 54.84%
[rank1]:2025-12-30 15:19:32,697 - Avg. fwd time: 9.1029 / Avg. bwd time: 20.8812 / Avg. batch time: 481.3054 (ms) / GPU bubble ratio: 50.16%
[rank0]:2025-12-30 15:19:32,705 - Avg. fwd time: 8.1778 / Avg. bwd time: 19.6045 / Avg. batch time: 504.0169 (ms) / GPU bubble ratio: 55.90%
[rank0]:2025-12-30 15:21:02,291 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-30 15:21:06,006 - Avg. fwd time: 10.7451 / Avg. bwd time: 32.9004 / Avg. batch time: 408.7160 (ms) / GPU bubble ratio: 14.57%
[rank2]:2025-12-30 15:21:06,043 - Avg. fwd time: 6.9645 / Avg. bwd time: 18.4406 / Avg. batch time: 446.7982 (ms) / GPU bubble ratio: 54.51%
[rank2]:2025-12-30 15:21:06,094 -  step: 350  loss: -8.0000  grad_norm:  0.1274  memory: 13.15GiB(27.69%)  tps: 8,729  tflops: 68.24  mfu: 21.87%
[rank1]:2025-12-30 15:21:06,063 - Avg. fwd time: 9.1032 / Avg. bwd time: 20.7647 / Avg. batch time: 478.0328 (ms) / GPU bubble ratio: 50.02%
[rank1]:2025-12-30 15:21:06,097 -  step: 350  loss: -8.0000  grad_norm:  0.1274  memory: 16.40GiB(34.52%)  tps: 8,729  tflops: 68.24  mfu: 21.87%
[rank0]:2025-12-30 15:21:06,072 - Avg. fwd time: 8.1778 / Avg. bwd time: 19.4246 / Avg. batch time: 500.0467 (ms) / GPU bubble ratio: 55.84%
[rank0]:2025-12-30 15:21:06,108 -  step: 350  loss: -8.0000  grad_norm:  0.1274  memory: 19.09GiB(40.19%)  tps: 8,729  tflops: 68.24  mfu: 21.87%
[rank3]:2025-12-30 15:21:06,107 -  step: 350  loss:  0.2457  grad_norm:  0.1274  memory: 29.36GiB(61.81%)  tps: 8,729  tflops: 68.24  mfu: 21.87%
[rank2]:2025-12-30 15:22:39,443 - Avg. fwd time: 6.9636 / Avg. bwd time: 18.4480 / Avg. batch time: 444.1536 (ms) / GPU bubble ratio: 54.23%
[rank1]:2025-12-30 15:22:39,462 - Avg. fwd time: 9.1028 / Avg. bwd time: 20.6472 / Avg. batch time: 475.1953 (ms) / GPU bubble ratio: 49.92%
[rank0]:2025-12-30 15:22:39,470 - Avg. fwd time: 8.1778 / Avg. bwd time: 19.2661 / Avg. batch time: 496.6050 (ms) / GPU bubble ratio: 55.79%
[rank3]:2025-12-30 15:22:39,402 - Avg. fwd time: 10.7411 / Avg. bwd time: 32.4672 / Avg. batch time: 405.2155 (ms) / GPU bubble ratio: 14.70%
[rank0]:2025-12-30 15:24:09,183 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-30 15:24:12,886 - Avg. fwd time: 10.7380 / Avg. bwd time: 32.0908 / Avg. batch time: 402.1736 (ms) / GPU bubble ratio: 14.81%
[rank2]:2025-12-30 15:24:12,922 - Avg. fwd time: 6.9629 / Avg. bwd time: 18.4485 / Avg. batch time: 441.8646 (ms) / GPU bubble ratio: 53.99%
[rank2]:2025-12-30 15:24:12,972 -  step: 400  loss: -8.0000  grad_norm:  0.5647  memory: 13.15GiB(27.69%)  tps: 8,767  tflops: 68.54  mfu: 21.97%
[rank1]:2025-12-30 15:24:12,942 - Avg. fwd time: 9.1027 / Avg. bwd time: 20.5484 / Avg. batch time: 472.7358 (ms) / GPU bubble ratio: 49.82%
[rank1]:2025-12-30 15:24:12,976 -  step: 400  loss: -8.0000  grad_norm:  0.5647  memory: 16.40GiB(34.52%)  tps: 8,767  tflops: 68.54  mfu: 21.97%
[rank0]:2025-12-30 15:24:12,950 - Avg. fwd time: 8.1782 / Avg. bwd time: 19.1268 / Avg. batch time: 493.6170 (ms) / GPU bubble ratio: 55.75%
[rank0]:2025-12-30 15:24:12,986 -  step: 400  loss: -8.0000  grad_norm:  0.5647  memory: 19.09GiB(40.19%)  tps: 8,767  tflops: 68.54  mfu: 21.97%
[rank3]:2025-12-30 15:24:12,985 -  step: 400  loss:  0.2261  grad_norm:  0.5647  memory: 29.36GiB(61.81%)  tps: 8,767  tflops: 68.54  mfu: 21.97%
[rank2]:2025-12-30 15:24:13,038 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/frozen_ratio_history/rank2/251230_1524_stage2_step400.svg
[rank1]:2025-12-30 15:24:13,038 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/frozen_ratio_history/rank1/251230_1524_stage1_step400.svg
[rank0]:2025-12-30 15:24:13,038 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/frozen_ratio_history/rank0/251230_1524_stage0_step400.svg
[rank0]:2025-12-30 15:24:13,191 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/frozen_params_histogram/251230_1524_rank0_stage0.svg
[rank0]:	> Counts Sum: 251040, Total Sum: 781440 (32.13%), Ratio(%) per element: [36.74, 36.74, 35.22, 34.46, 33.71, 33.71, 35.22, 35.22, 19.69, 20.07, 35.22, 33.71, 34.09, 36.74, 35.98, 34.84, 36.36, 20.45, 22.34, 35.22, 35.22, 35.98, 34.46, 35.98, 34.84, 34.09, 20.83, 25.0, 34.09, 35.22, 35.22, 35.22, 33.33, 35.22, 34.84, 21.59, 21.59]
[rank3]:2025-12-30 15:24:13,123 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/pipeline_schedule/251230_1524_step400_rank3.svg
[rank3]:			> Batch Time: 449.50 ms, GPU Bubble Ratio: 55.03%, 49.90%, 54.82%, 33.83%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-7-32ms      | [S0,MB4,F]  32-8-40ms      | [S0,MB5,F]  40-7-48ms      | [S0,MB6,F]  48-8-56ms      | [S0,MB7,F]  56-8-65ms      | [S0,MB0,B]  272-25-297ms   | [S0,MB1,B]  306-25-331ms   | [S0,MB2,B]  336-25-361ms   | [S0,MB3,B]  365-25-391ms   | [S0,MB4,B]  392-25-418ms   | [S0,MB5,B]  420-0-420ms    | [S0,MB6,B]  435-9-444ms    | [S0,MB7,B]  449-0-449ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-8-32ms      | [S1,MB2,F]  35-8-44ms      | [S1,MB3,F]  56-8-65ms      | [S1,MB4,F]  74-8-82ms      | [S1,MB5,F]  91-8-100ms     | [S1,MB6,F]  109-8-118ms    | [S1,MB7,F]  127-8-136ms    | [S1,MB0,B]  243-24-268ms   | [S1,MB1,B]  281-21-303ms   | [S1,MB2,B]  307-25-333ms   | [S1,MB3,B]  336-25-362ms   | [S1,MB4,B]  365-12-377ms   | [S1,MB5,B]  392-19-412ms   | [S1,MB6,B]  420-11-431ms   | [S1,MB7,B]  434-11-446ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-6-39ms      | [S2,MB2,F]  53-6-60ms      | [S2,MB3,F]  71-6-77ms      | [S2,MB4,F]  88-6-95ms      | [S2,MB5,F]  106-6-113ms    | [S2,MB6,F]  124-6-131ms    | [S2,MB7,F]  142-6-149ms    | [S2,MB0,B]  220-19-240ms   | [S2,MB1,B]  258-19-278ms   | [S2,MB2,B]  284-19-304ms   | [S2,MB3,B]  308-19-328ms   | [S2,MB4,B]  335-20-356ms   | [S2,MB5,B]  366-20-386ms   | [S2,MB6,B]  392-19-411ms   | [S2,MB7,B]  419-8-428ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  50-10-60ms     | [S3,MB2,F]  67-10-78ms     | [S3,MB3,F]  85-10-95ms     | [S3,MB4,F]  103-10-113ms   | [S3,MB5,F]  121-10-132ms   | [S3,MB6,F]  139-10-150ms   | [S3,MB7,F]  157-10-168ms   | [S3,MB0,B]  174-40-214ms   | [S3,MB1,B]  214-37-251ms   | [S3,MB2,B]  252-22-274ms   | [S3,MB3,B]  275-21-296ms   | [S3,MB4,B]  297-22-319ms   | [S3,MB5,B]  319-22-341ms   | [S3,MB6,B]  342-22-364ms   | [S3,MB7,B]  364-22-386ms  
[rank3]:2025-12-30 15:24:13,169 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/frozen_ratio_history/rank3/251230_1524_stage3_step400.svg
[rank2]:2025-12-30 15:24:13,187 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/frozen_params_histogram/251230_1524_rank2_stage2.svg
[rank2]:	> Counts Sum: 104640, Total Sum: 760320 (13.76%), Ratio(%) per element: [15.53, 14.39, 14.39, 14.01, 14.39, 14.77, 14.01, 11.36, 11.74, 14.39, 15.15, 13.63, 13.63, 13.63, 13.25, 14.39, 11.74, 11.74, 15.15, 14.77, 13.63, 14.39, 13.63, 15.15, 13.25, 11.36, 11.74, 14.77, 15.15, 15.15, 14.77, 14.01, 14.39, 15.15, 11.36, 11.36]
[rank1]:2025-12-30 15:24:13,185 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/frozen_params_histogram/251230_1524_rank1_stage1.svg
[rank1]:	> Counts Sum: 353280, Total Sum: 950400 (37.17%), Ratio(%) per element: [39.39, 39.77, 43.56, 41.66, 40.15, 43.93, 41.66, 20.07, 20.45, 43.18, 39.77, 41.28, 39.77, 41.28, 45.45, 41.28, 20.83, 20.07, 42.04, 39.77, 41.66, 42.8, 39.39, 39.39, 39.01, 25.75, 27.27, 43.18, 40.9, 40.53, 39.01, 41.66, 43.18, 39.01, 22.34, 20.45, 43.18, 43.56, 41.66, 42.42, 42.42, 43.18, 42.8, 22.34, 20.07]
[rank3]:2025-12-30 15:24:13,300 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/frozen_params_histogram/251230_1524_rank3_stage3.svg
[rank3]:	> Counts Sum: 428240, Total Sum: 612480 (69.92%), Ratio(%) per element: [78.4, 75.0, 76.51, 76.89, 76.51, 75.75, 76.51, 55.3, 54.16, 78.78, 74.24, 76.13, 73.86, 75.37, 76.13, 77.65, 54.16, 54.16, 73.1, 76.51, 76.13, 71.21, 76.51, 75.75, 74.24, 56.06, 53.78, 54.16, 54.54]
[rank2]:2025-12-30 15:24:14,024 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/afr_time_plot/251230_1524_stage2.svg
[rank1]:2025-12-30 15:24:14,041 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/afr_time_plot/251230_1524_stage1.svg
[rank0]:2025-12-30 15:24:14,071 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/afr_time_plot/251230_1524_stage0.svg
[rank3]:2025-12-30 15:24:14,117 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/afr_time_plot/251230_1524_stage3.svg
[rank3]:2025-12-30 15:24:35,164 - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-12-30 15:24:35,370 - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-12-30 15:24:35,383 - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-12-30 15:24:35,385 - Dataset alpaca_gpt4 is being re-looped
[rank3]:2025-12-30 15:25:47,086 - Avg. fwd time: 10.7344 / Avg. bwd time: 31.7484 / Avg. batch time: 399.4032 (ms) / GPU bubble ratio: 14.91%
[rank1]:2025-12-30 15:25:47,150 - Avg. fwd time: 9.1023 / Avg. bwd time: 20.4622 / Avg. batch time: 470.5189 (ms) / GPU bubble ratio: 49.73%
[rank2]:2025-12-30 15:25:47,130 - Avg. fwd time: 6.9621 / Avg. bwd time: 18.4528 / Avg. batch time: 439.7922 (ms) / GPU bubble ratio: 53.77%
[rank0]:2025-12-30 15:25:47,159 - Avg. fwd time: 8.1781 / Avg. bwd time: 19.0054 / Avg. batch time: 490.9325 (ms) / GPU bubble ratio: 55.70%
[rank0]:2025-12-30 15:27:16,563 - [GC] Peforming periodical GC collection 0.02 seconds
[rank3]:2025-12-30 15:27:20,247 - Avg. fwd time: 10.7303 / Avg. bwd time: 31.4447 / Avg. batch time: 396.9390 (ms) / GPU bubble ratio: 15.00%
[rank1]:2025-12-30 15:27:20,305 - Avg. fwd time: 9.1016 / Avg. bwd time: 20.3905 / Avg. batch time: 468.5393 (ms) / GPU bubble ratio: 49.64%
[rank2]:2025-12-30 15:27:20,285 - Avg. fwd time: 6.9610 / Avg. bwd time: 18.4542 / Avg. batch time: 437.9402 (ms) / GPU bubble ratio: 53.57%
[rank0]:2025-12-30 15:27:20,314 - Avg. fwd time: 8.1772 / Avg. bwd time: 18.8972 / Avg. batch time: 488.5365 (ms) / GPU bubble ratio: 55.66%
[rank0]:2025-12-30 15:27:20,350 -  step: 450  loss: -8.0000  grad_norm:  0.2839  memory: 19.09GiB(40.19%)  tps: 8,744  tflops: 68.36  mfu: 21.91%
[rank3]:2025-12-30 15:27:20,349 -  step: 450  loss:  0.2350  grad_norm:  0.2839  memory: 29.36GiB(61.81%)  tps: 8,745  tflops: 68.36  mfu: 21.91%
[rank1]:2025-12-30 15:27:20,340 -  step: 450  loss: -8.0000  grad_norm:  0.2839  memory: 16.40GiB(34.52%)  tps: 8,744  tflops: 68.36  mfu: 21.91%
[rank2]:2025-12-30 15:27:20,336 -  step: 450  loss: -8.0000  grad_norm:  0.2839  memory: 13.15GiB(27.69%)  tps: 8,744  tflops: 68.36  mfu: 21.91%
[rank3]:2025-12-30 15:28:53,651 - Avg. fwd time: 10.7275 / Avg. bwd time: 31.1778 / Avg. batch time: 394.7799 (ms) / GPU bubble ratio: 15.08%
[rank2]:2025-12-30 15:28:53,699 - Avg. fwd time: 6.9602 / Avg. bwd time: 18.4575 / Avg. batch time: 436.3267 (ms) / GPU bubble ratio: 53.40%
[rank1]:2025-12-30 15:28:53,720 - Avg. fwd time: 9.1014 / Avg. bwd time: 20.3245 / Avg. batch time: 466.8117 (ms) / GPU bubble ratio: 49.57%
[rank0]:2025-12-30 15:28:53,729 - Avg. fwd time: 8.1768 / Avg. bwd time: 18.7994 / Avg. batch time: 486.4380 (ms) / GPU bubble ratio: 55.63%
[rank0]:2025-12-30 15:30:23,384 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-30 15:30:27,068 - Avg. fwd time: 10.7254 / Avg. bwd time: 30.9346 / Avg. batch time: 392.8164 (ms) / GPU bubble ratio: 15.16%
[rank2]:2025-12-30 15:30:27,116 - Avg. fwd time: 6.9595 / Avg. bwd time: 18.4585 / Avg. batch time: 434.8603 (ms) / GPU bubble ratio: 53.24%
[rank1]:2025-12-30 15:30:27,138 - Avg. fwd time: 9.1013 / Avg. bwd time: 20.2644 / Avg. batch time: 465.2397 (ms) / GPU bubble ratio: 49.50%
[rank0]:2025-12-30 15:30:27,148 - Avg. fwd time: 8.1767 / Avg. bwd time: 18.7108 / Avg. batch time: 484.5327 (ms) / GPU bubble ratio: 55.61%
[rank0]:2025-12-30 15:30:27,184 -  step: 500  loss: -8.0000  grad_norm:  0.1407  memory: 19.09GiB(40.19%)  tps: 8,769  tflops: 68.55  mfu: 21.97%
[rank3]:2025-12-30 15:30:27,182 -  step: 500  loss:  0.2293  grad_norm:  0.1407  memory: 29.36GiB(61.81%)  tps: 8,769  tflops: 68.56  mfu: 21.97%
[rank2]:2025-12-30 15:30:27,170 -  step: 500  loss: -8.0000  grad_norm:  0.1407  memory: 13.15GiB(27.69%)  tps: 8,769  tflops: 68.55  mfu: 21.97%
[rank2]:2025-12-30 15:30:27,232 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/frozen_ratio_history/rank2/251230_1530_stage2_step500.svg
[rank1]:2025-12-30 15:30:27,173 -  step: 500  loss: -8.0000  grad_norm:  0.1407  memory: 16.40GiB(34.52%)  tps: 8,769  tflops: 68.55  mfu: 21.97%
[rank1]:2025-12-30 15:30:27,232 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/frozen_ratio_history/rank1/251230_1530_stage1_step500.svg
[rank0]:2025-12-30 15:30:27,232 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/frozen_ratio_history/rank0/251230_1530_stage0_step500.svg
[rank0]:2025-12-30 15:30:27,386 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/frozen_params_histogram/251230_1530_rank0_stage0.svg
[rank0]:	> Counts Sum: 333440, Total Sum: 1018240 (32.75%), Ratio(%) per element: [36.91, 36.91, 35.75, 35.17, 34.59, 34.3, 35.75, 35.75, 21.22, 21.22, 35.75, 34.59, 34.88, 36.62, 36.04, 35.46, 36.62, 21.8, 22.96, 35.75, 35.75, 36.33, 35.17, 36.33, 35.46, 34.88, 21.8, 25.0, 34.88, 35.75, 35.75, 35.75, 34.3, 35.75, 35.46, 22.38, 22.67]
[rank3]:2025-12-30 15:30:27,321 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/pipeline_schedule/251230_1530_step500_rank3.svg
[rank3]:			> Batch Time: 447.75 ms, GPU Bubble Ratio: 54.78%, 49.79%, 54.51%, 33.94%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-7-32ms      | [S0,MB4,F]  32-8-40ms      | [S0,MB5,F]  40-7-48ms      | [S0,MB6,F]  48-8-56ms      | [S0,MB7,F]  56-8-65ms      | [S0,MB0,B]  271-25-297ms   | [S0,MB1,B]  304-25-329ms   | [S0,MB2,B]  333-25-359ms   | [S0,MB3,B]  363-25-389ms   | [S0,MB4,B]  390-25-416ms   | [S0,MB5,B]  418-0-418ms    | [S0,MB6,B]  433-9-442ms    | [S0,MB7,B]  447-0-447ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-8-32ms      | [S1,MB2,F]  35-8-44ms      | [S1,MB3,F]  56-8-65ms      | [S1,MB4,F]  74-8-83ms      | [S1,MB5,F]  91-8-100ms     | [S1,MB6,F]  109-8-118ms    | [S1,MB7,F]  127-8-136ms    | [S1,MB0,B]  243-24-268ms   | [S1,MB1,B]  279-19-299ms   | [S1,MB2,B]  305-25-330ms   | [S1,MB3,B]  334-25-359ms   | [S1,MB4,B]  363-13-376ms   | [S1,MB5,B]  390-20-411ms   | [S1,MB6,B]  418-11-429ms   | [S1,MB7,B]  432-11-444ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-6-39ms      | [S2,MB2,F]  53-6-60ms      | [S2,MB3,F]  71-6-77ms      | [S2,MB4,F]  88-6-95ms      | [S2,MB5,F]  106-6-113ms    | [S2,MB6,F]  124-6-131ms    | [S2,MB7,F]  142-6-149ms    | [S2,MB0,B]  220-19-240ms   | [S2,MB1,B]  256-19-276ms   | [S2,MB2,B]  282-20-302ms   | [S2,MB3,B]  305-20-326ms   | [S2,MB4,B]  333-20-353ms   | [S2,MB5,B]  364-20-384ms   | [S2,MB6,B]  390-19-410ms   | [S2,MB7,B]  417-8-426ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  50-10-60ms     | [S3,MB2,F]  67-10-78ms     | [S3,MB3,F]  85-10-96ms     | [S3,MB4,F]  103-10-113ms   | [S3,MB5,F]  121-10-131ms   | [S3,MB6,F]  139-10-150ms   | [S3,MB7,F]  157-10-168ms   | [S3,MB0,B]  174-40-214ms   | [S3,MB1,B]  213-36-250ms   | [S3,MB2,B]  249-22-272ms   | [S3,MB3,B]  273-21-295ms   | [S3,MB4,B]  295-22-317ms   | [S3,MB5,B]  317-22-339ms   | [S3,MB6,B]  339-22-361ms   | [S3,MB7,B]  361-21-383ms  
[rank3]:2025-12-30 15:30:27,365 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/frozen_ratio_history/rank3/251230_1530_stage3_step500.svg
[rank2]:2025-12-30 15:30:27,384 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/frozen_params_histogram/251230_1530_rank2_stage2.svg
[rank2]:	> Counts Sum: 134240, Total Sum: 990720 (13.55%), Ratio(%) per element: [14.82, 13.95, 13.95, 14.24, 13.95, 14.24, 13.66, 11.62, 11.91, 13.95, 14.53, 13.37, 13.37, 13.37, 13.08, 14.24, 11.91, 11.91, 15.11, 14.24, 13.37, 14.24, 13.66, 14.53, 13.08, 11.62, 11.91, 14.53, 14.53, 14.82, 14.24, 13.95, 13.95, 14.53, 11.62, 11.62]
[rank1]:2025-12-30 15:30:27,377 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/frozen_params_histogram/251230_1530_rank1_stage1.svg
[rank1]:	> Counts Sum: 470880, Total Sum: 1238400 (38.02%), Ratio(%) per element: [39.24, 42.44, 43.6, 42.73, 42.15, 43.89, 42.44, 21.22, 21.51, 43.6, 41.56, 41.56, 41.86, 41.86, 45.34, 42.44, 21.8, 21.22, 43.02, 39.53, 42.73, 43.02, 41.27, 40.98, 40.11, 26.45, 26.74, 43.89, 42.15, 40.98, 38.95, 41.86, 44.18, 40.69, 22.96, 21.8, 43.31, 43.6, 43.31, 43.02, 42.73, 44.18, 44.76, 22.96, 21.22]
[rank3]:2025-12-30 15:30:27,498 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/frozen_params_histogram/251230_1530_rank3_stage3.svg
[rank3]:	> Counts Sum: 577040, Total Sum: 798080 (72.30%), Ratio(%) per element: [79.06, 75.87, 77.32, 78.19, 78.19, 77.32, 77.61, 59.88, 59.01, 79.06, 76.16, 77.9, 75.0, 76.74, 77.32, 78.48, 59.01, 59.01, 75.0, 77.9, 77.61, 73.83, 79.06, 77.9, 76.16, 60.75, 59.01, 59.01, 59.3]
[rank2]:2025-12-30 15:30:28,490 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/afr_time_plot/251230_1530_stage2.svg
[rank1]:2025-12-30 15:30:28,485 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/afr_time_plot/251230_1530_stage1.svg
[rank0]:2025-12-30 15:30:28,532 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/afr_time_plot/251230_1530_stage0.svg
[rank3]:2025-12-30 15:30:28,580 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/afr_time_plot/251230_1530_stage3.svg
[rank3]:2025-12-30 15:32:01,661 - Avg. fwd time: 10.7239 / Avg. bwd time: 30.7121 / Avg. batch time: 391.0218 (ms) / GPU bubble ratio: 15.23%
[rank2]:2025-12-30 15:32:01,697 - Avg. fwd time: 6.9592 / Avg. bwd time: 18.4616 / Avg. batch time: 433.5197 (ms) / GPU bubble ratio: 53.09%
[rank1]:2025-12-30 15:32:01,719 - Avg. fwd time: 9.1017 / Avg. bwd time: 20.2131 / Avg. batch time: 463.8103 (ms) / GPU bubble ratio: 49.44%
[rank0]:2025-12-30 15:32:01,729 - Avg. fwd time: 8.1769 / Avg. bwd time: 18.6316 / Avg. batch time: 482.8002 (ms) / GPU bubble ratio: 55.58%
[rank0]:2025-12-30 15:33:31,317 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-30 15:33:35,037 - Avg. fwd time: 10.7227 / Avg. bwd time: 30.5103 / Avg. batch time: 389.3979 (ms) / GPU bubble ratio: 15.29%
[rank2]:2025-12-30 15:33:35,081 - Avg. fwd time: 6.9591 / Avg. bwd time: 18.4624 / Avg. batch time: 432.3169 (ms) / GPU bubble ratio: 52.96%
[rank1]:2025-12-30 15:33:35,103 - Avg. fwd time: 9.1021 / Avg. bwd time: 20.1683 / Avg. batch time: 462.5235 (ms) / GPU bubble ratio: 49.37%
[rank0]:2025-12-30 15:33:35,113 - Avg. fwd time: 8.1771 / Avg. bwd time: 18.5594 / Avg. batch time: 481.2389 (ms) / GPU bubble ratio: 55.55%
[rank0]:2025-12-30 15:33:35,149 -  step: 550  loss: -8.0000  grad_norm:  0.1727  memory: 19.09GiB(40.19%)  tps: 8,717  tflops: 68.14  mfu: 21.84%
[rank2]:2025-12-30 15:33:35,135 -  step: 550  loss: -8.0000  grad_norm:  0.1727  memory: 13.15GiB(27.69%)  tps: 8,717  tflops: 68.14  mfu: 21.84%
[rank1]:2025-12-30 15:33:35,138 -  step: 550  loss: -8.0000  grad_norm:  0.1727  memory: 16.40GiB(34.52%)  tps: 8,717  tflops: 68.14  mfu: 21.84%
[rank3]:2025-12-30 15:33:35,148 -  step: 550  loss:  0.2348  grad_norm:  0.1727  memory: 29.36GiB(61.81%)  tps: 8,717  tflops: 68.14  mfu: 21.84%
[rank2]:2025-12-30 15:35:08,709 - Avg. fwd time: 6.9590 / Avg. bwd time: 18.4649 / Avg. batch time: 431.2661 (ms) / GPU bubble ratio: 52.84%
[rank3]:2025-12-30 15:35:08,668 - Avg. fwd time: 10.7221 / Avg. bwd time: 30.3324 / Avg. batch time: 387.9693 (ms) / GPU bubble ratio: 15.34%
[rank0]:2025-12-30 15:35:08,742 - Avg. fwd time: 8.1775 / Avg. bwd time: 18.4928 / Avg. batch time: 479.8581 (ms) / GPU bubble ratio: 55.54%
[rank1]:2025-12-30 15:35:08,731 - Avg. fwd time: 9.1025 / Avg. bwd time: 20.1213 / Avg. batch time: 461.3928 (ms) / GPU bubble ratio: 49.33%
[rank0]:2025-12-30 15:36:38,469 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-30 15:36:42,250 - Avg. fwd time: 6.9589 / Avg. bwd time: 18.4661 / Avg. batch time: 430.2777 (ms) / GPU bubble ratio: 52.73%
[rank3]:2025-12-30 15:36:42,214 - Avg. fwd time: 10.7221 / Avg. bwd time: 30.1676 / Avg. batch time: 386.6500 (ms) / GPU bubble ratio: 15.40%
[rank0]:2025-12-30 15:36:42,283 - Avg. fwd time: 8.1783 / Avg. bwd time: 18.4325 / Avg. batch time: 478.5763 (ms) / GPU bubble ratio: 55.52%
[rank1]:2025-12-30 15:36:42,272 - Avg. fwd time: 9.1035 / Avg. bwd time: 20.0875 / Avg. batch time: 460.3405 (ms) / GPU bubble ratio: 49.27%
[rank1]:2025-12-30 15:36:42,308 -  step: 600  loss: -8.0000  grad_norm:  0.6769  memory: 16.40GiB(34.52%)  tps: 8,754  tflops: 68.43  mfu: 21.93%
[rank2]:2025-12-30 15:36:42,305 -  step: 600  loss: -8.0000  grad_norm:  0.6769  memory: 13.15GiB(27.69%)  tps: 8,754  tflops: 68.43  mfu: 21.93%
[rank3]:2025-12-30 15:36:42,317 -  step: 600  loss:  0.2313  grad_norm:  0.6769  memory: 29.36GiB(61.81%)  tps: 8,754  tflops: 68.43  mfu: 21.93%
[rank0]:2025-12-30 15:36:42,319 -  step: 600  loss: -8.0000  grad_norm:  0.6769  memory: 19.09GiB(40.19%)  tps: 8,754  tflops: 68.43  mfu: 21.93%
[rank0]:2025-12-30 15:36:42,369 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/frozen_ratio_history/rank0/251230_1536_stage0_step600.svg
[rank1]:2025-12-30 15:36:42,372 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/frozen_ratio_history/rank1/251230_1536_stage1_step600.svg
[rank2]:2025-12-30 15:36:42,368 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/frozen_ratio_history/rank2/251230_1536_stage2_step600.svg
[rank3]:2025-12-30 15:36:42,456 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/pipeline_schedule/251230_1536_step600_rank3.svg
[rank3]:			> Batch Time: 450.25 ms, GPU Bubble Ratio: 55.05%, 49.56%, 54.82%, 33.77%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-7-32ms      | [S0,MB4,F]  32-8-40ms      | [S0,MB5,F]  40-7-48ms      | [S0,MB6,F]  48-8-56ms      | [S0,MB7,F]  56-8-65ms      | [S0,MB0,B]  272-25-297ms   | [S0,MB1,B]  306-25-332ms   | [S0,MB2,B]  336-25-361ms   | [S0,MB3,B]  365-25-391ms   | [S0,MB4,B]  393-25-418ms   | [S0,MB5,B]  420-0-420ms    | [S0,MB6,B]  435-9-444ms    | [S0,MB7,B]  450-0-450ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-8-32ms      | [S1,MB2,F]  35-8-44ms      | [S1,MB3,F]  56-8-65ms      | [S1,MB4,F]  74-8-83ms      | [S1,MB5,F]  91-8-100ms     | [S1,MB6,F]  109-8-118ms    | [S1,MB7,F]  127-8-136ms    | [S1,MB0,B]  244-24-269ms   | [S1,MB1,B]  282-20-303ms   | [S1,MB2,B]  308-25-333ms   | [S1,MB3,B]  336-25-362ms   | [S1,MB4,B]  365-13-379ms   | [S1,MB5,B]  393-20-413ms   | [S1,MB6,B]  420-11-432ms   | [S1,MB7,B]  435-11-446ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-6-39ms      | [S2,MB2,F]  53-6-60ms      | [S2,MB3,F]  71-6-77ms      | [S2,MB4,F]  88-6-95ms      | [S2,MB5,F]  106-6-113ms    | [S2,MB6,F]  124-6-131ms    | [S2,MB7,F]  142-6-149ms    | [S2,MB0,B]  221-19-240ms   | [S2,MB1,B]  259-19-279ms   | [S2,MB2,B]  284-20-304ms   | [S2,MB3,B]  308-20-328ms   | [S2,MB4,B]  336-20-356ms   | [S2,MB5,B]  366-20-386ms   | [S2,MB6,B]  393-19-412ms   | [S2,MB7,B]  420-8-429ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  50-10-60ms     | [S3,MB2,F]  67-10-77ms     | [S3,MB3,F]  85-10-95ms     | [S3,MB4,F]  103-10-113ms   | [S3,MB5,F]  121-10-131ms   | [S3,MB6,F]  139-10-150ms   | [S3,MB7,F]  157-10-168ms   | [S3,MB0,B]  174-40-214ms   | [S3,MB1,B]  214-37-252ms   | [S3,MB2,B]  252-23-275ms   | [S3,MB3,B]  275-21-297ms   | [S3,MB4,B]  297-22-319ms   | [S3,MB5,B]  319-22-341ms   | [S3,MB6,B]  341-22-364ms   | [S3,MB7,B]  364-22-386ms  
[rank1]:2025-12-30 15:36:42,522 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/frozen_params_histogram/251230_1536_rank1_stage1.svg
[rank1]:	> Counts Sum: 588480, Total Sum: 1526400 (38.55%), Ratio(%) per element: [40.8, 42.68, 44.33, 42.92, 42.21, 43.63, 42.45, 21.93, 22.16, 43.39, 42.45, 41.74, 42.92, 42.68, 44.57, 43.39, 22.4, 21.93, 44.33, 41.27, 41.98, 43.16, 42.68, 41.74, 40.56, 26.41, 26.41, 44.33, 41.98, 42.45, 40.09, 43.63, 43.86, 41.27, 23.58, 22.64, 43.63, 43.86, 43.39, 43.86, 44.1, 45.28, 44.1, 23.58, 21.93]
[rank2]:2025-12-30 15:36:42,517 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/frozen_params_histogram/251230_1536_rank2_stage2.svg
[rank2]:	> Counts Sum: 163840, Total Sum: 1221120 (13.42%), Ratio(%) per element: [14.38, 13.91, 13.67, 13.91, 13.67, 13.91, 13.44, 11.79, 12.02, 13.91, 14.15, 13.2, 13.44, 13.2, 13.2, 13.91, 12.02, 12.02, 14.85, 14.15, 13.2, 13.91, 13.44, 14.38, 12.97, 11.79, 12.02, 14.38, 14.38, 14.38, 14.15, 13.67, 13.67, 14.15, 11.79, 11.79]
[rank3]:2025-12-30 15:36:42,500 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/frozen_ratio_history/rank3/251230_1536_stage3_step600.svg
[rank0]:2025-12-30 15:36:42,523 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/frozen_params_histogram/251230_1536_rank0_stage0.svg
[rank0]:	> Counts Sum: 415840, Total Sum: 1255040 (33.13%), Ratio(%) per element: [37.02, 37.02, 36.08, 35.61, 34.9, 34.9, 36.08, 36.08, 22.16, 22.16, 36.08, 35.14, 35.37, 36.79, 36.08, 35.84, 36.79, 22.4, 23.34, 36.08, 36.08, 36.55, 35.61, 36.55, 35.84, 35.37, 22.4, 25.0, 35.37, 36.08, 36.08, 36.08, 34.9, 36.08, 35.84, 22.87, 23.11]
[rank3]:2025-12-30 15:36:42,632 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/frozen_params_histogram/251230_1536_rank3_stage3.svg
[rank3]:	> Counts Sum: 725840, Total Sum: 983680 (73.79%), Ratio(%) per element: [79.24, 76.88, 77.83, 78.77, 78.77, 78.53, 78.53, 62.73, 62.02, 79.95, 77.59, 78.53, 76.65, 78.06, 78.3, 79.48, 62.02, 62.02, 76.41, 78.53, 78.06, 75.23, 79.71, 79.0, 77.12, 63.44, 62.02, 62.02, 62.26]
[rank2]:2025-12-30 15:36:43,843 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/afr_time_plot/251230_1536_stage2.svg
[rank3]:2025-12-30 15:36:43,964 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/afr_time_plot/251230_1536_stage3.svg
[rank0]:2025-12-30 15:36:43,932 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/afr_time_plot/251230_1536_stage0.svg
[rank1]:2025-12-30 15:36:43,952 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/afr_time_plot/251230_1536_stage1.svg
[rank3]:2025-12-30 15:38:17,459 - Avg. fwd time: 10.7223 / Avg. bwd time: 30.0154 / Avg. batch time: 385.4332 (ms) / GPU bubble ratio: 15.45%
[rank2]:2025-12-30 15:38:17,498 - Avg. fwd time: 6.9591 / Avg. bwd time: 18.4673 / Avg. batch time: 429.4092 (ms) / GPU bubble ratio: 52.63%
[rank1]:2025-12-30 15:38:17,521 - Avg. fwd time: 9.1051 / Avg. bwd time: 20.0622 / Avg. batch time: 459.4119 (ms) / GPU bubble ratio: 49.21%
[rank0]:2025-12-30 15:38:17,533 - Avg. fwd time: 8.1790 / Avg. bwd time: 18.3780 / Avg. batch time: 477.4389 (ms) / GPU bubble ratio: 55.50%
[rank0]:2025-12-30 15:39:46,935 - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-12-30 15:39:50,682 - Avg. fwd time: 6.9594 / Avg. bwd time: 18.4714 / Avg. batch time: 428.5086 (ms) / GPU bubble ratio: 52.52%
[rank1]:2025-12-30 15:39:50,705 - Avg. fwd time: 9.1065 / Avg. bwd time: 20.0230 / Avg. batch time: 458.4460 (ms) / GPU bubble ratio: 49.17%
[rank3]:2025-12-30 15:39:50,636 - Avg. fwd time: 10.7240 / Avg. bwd time: 29.8579 / Avg. batch time: 384.1868 (ms) / GPU bubble ratio: 15.50%
[rank0]:2025-12-30 15:39:50,716 - Avg. fwd time: 8.1796 / Avg. bwd time: 18.3289 / Avg. batch time: 476.2799 (ms) / GPU bubble ratio: 55.47%
[rank2]:2025-12-30 15:39:50,738 -  step: 650  loss: -8.0000  grad_norm:  0.1210  memory: 13.15GiB(27.69%)  tps: 8,695  tflops: 67.97  mfu: 21.79%
[rank1]:2025-12-30 15:39:50,742 -  step: 650  loss: -8.0000  grad_norm:  0.1210  memory: 16.40GiB(34.52%)  tps: 8,695  tflops: 67.97  mfu: 21.79%
[rank3]:2025-12-30 15:39:50,752 -  step: 650  loss:  0.2368  grad_norm:  0.1210  memory: 29.36GiB(61.81%)  tps: 8,695  tflops: 67.97  mfu: 21.79%
[rank0]:2025-12-30 15:39:50,752 -  step: 650  loss: -8.0000  grad_norm:  0.1210  memory: 19.09GiB(40.19%)  tps: 8,695  tflops: 67.97  mfu: 21.79%
[rank3]:2025-12-30 15:41:24,321 - Avg. fwd time: 10.7248 / Avg. bwd time: 29.7325 / Avg. batch time: 383.1897 (ms) / GPU bubble ratio: 15.54%
[rank2]:2025-12-30 15:41:24,361 - Avg. fwd time: 6.9596 / Avg. bwd time: 18.4747 / Avg. batch time: 427.7697 (ms) / GPU bubble ratio: 52.43%
[rank1]:2025-12-30 15:41:24,384 - Avg. fwd time: 9.1080 / Avg. bwd time: 19.9952 / Avg. batch time: 457.6549 (ms) / GPU bubble ratio: 49.13%
[rank0]:2025-12-30 15:41:24,396 - Avg. fwd time: 8.1802 / Avg. bwd time: 18.2845 / Avg. batch time: 475.3084 (ms) / GPU bubble ratio: 55.46%
[rank0]:2025-12-30 15:42:54,166 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-30 15:42:57,859 - Avg. fwd time: 10.7248 / Avg. bwd time: 29.6128 / Avg. batch time: 382.2309 (ms) / GPU bubble ratio: 15.57%
[rank2]:2025-12-30 15:42:57,899 - Avg. fwd time: 6.9594 / Avg. bwd time: 18.4759 / Avg. batch time: 427.0624 (ms) / GPU bubble ratio: 52.35%
[rank1]:2025-12-30 15:42:57,923 - Avg. fwd time: 9.1089 / Avg. bwd time: 19.9655 / Avg. batch time: 456.8948 (ms) / GPU bubble ratio: 49.09%
[rank3]:2025-12-30 15:42:57,969 -  step: 700  loss:  0.1992  grad_norm:  0.1850  memory: 29.36GiB(61.81%)  tps: 8,751  tflops: 68.41  mfu: 21.93%
[rank0]:2025-12-30 15:42:57,934 - Avg. fwd time: 8.1812 / Avg. bwd time: 18.2426 / Avg. batch time: 474.3804 (ms) / GPU bubble ratio: 55.44%
[rank0]:2025-12-30 15:42:57,971 -  step: 700  loss: -8.0000  grad_norm:  0.1850  memory: 19.09GiB(40.19%)  tps: 8,751  tflops: 68.41  mfu: 21.93%
[rank2]:2025-12-30 15:42:57,956 -  step: 700  loss: -8.0000  grad_norm:  0.1850  memory: 13.15GiB(27.69%)  tps: 8,751  tflops: 68.41  mfu: 21.93%
[rank2]:2025-12-30 15:42:58,021 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/frozen_ratio_history/rank2/251230_1542_stage2_step700.svg
[rank1]:2025-12-30 15:42:57,960 -  step: 700  loss: -8.0000  grad_norm:  0.1850  memory: 16.40GiB(34.52%)  tps: 8,751  tflops: 68.41  mfu: 21.93%
[rank1]:2025-12-30 15:42:58,021 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/frozen_ratio_history/rank1/251230_1542_stage1_step700.svg
[rank0]:2025-12-30 15:42:58,024 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/frozen_ratio_history/rank0/251230_1542_stage0_step700.svg
[rank3]:2025-12-30 15:42:58,113 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/pipeline_schedule/251230_1542_step700_rank3.svg
[rank3]:			> Batch Time: 449.50 ms, GPU Bubble Ratio: 54.87%, 49.11%, 54.53%, 34.10%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-7-32ms      | [S0,MB4,F]  32-8-40ms      | [S0,MB5,F]  40-7-48ms      | [S0,MB6,F]  48-8-56ms      | [S0,MB7,F]  56-8-65ms      | [S0,MB0,B]  273-25-298ms   | [S0,MB1,B]  305-25-331ms   | [S0,MB2,B]  335-25-361ms   | [S0,MB3,B]  365-25-390ms   | [S0,MB4,B]  392-25-418ms   | [S0,MB5,B]  419-0-419ms    | [S0,MB6,B]  434-9-443ms    | [S0,MB7,B]  449-0-449ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-8-32ms      | [S1,MB2,F]  35-8-44ms      | [S1,MB3,F]  56-9-65ms      | [S1,MB4,F]  74-8-83ms      | [S1,MB5,F]  91-8-100ms     | [S1,MB6,F]  109-8-118ms    | [S1,MB7,F]  127-8-136ms    | [S1,MB0,B]  244-25-269ms   | [S1,MB1,B]  281-20-302ms   | [S1,MB2,B]  307-25-332ms   | [S1,MB3,B]  335-25-361ms   | [S1,MB4,B]  365-12-377ms   | [S1,MB5,B]  392-23-415ms   | [S1,MB6,B]  419-11-431ms   | [S1,MB7,B]  434-11-445ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-6-39ms      | [S2,MB2,F]  53-6-60ms      | [S2,MB3,F]  71-6-77ms      | [S2,MB4,F]  88-6-95ms      | [S2,MB5,F]  106-6-113ms    | [S2,MB6,F]  124-6-131ms    | [S2,MB7,F]  142-6-149ms    | [S2,MB0,B]  221-19-241ms   | [S2,MB1,B]  258-19-277ms   | [S2,MB2,B]  283-19-303ms   | [S2,MB3,B]  307-20-327ms   | [S2,MB4,B]  335-20-355ms   | [S2,MB5,B]  365-20-385ms   | [S2,MB6,B]  392-20-412ms   | [S2,MB7,B]  419-8-428ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  50-10-60ms     | [S3,MB2,F]  67-10-78ms     | [S3,MB3,F]  85-10-95ms     | [S3,MB4,F]  103-10-113ms   | [S3,MB5,F]  121-10-132ms   | [S3,MB6,F]  139-10-150ms   | [S3,MB7,F]  158-10-168ms   | [S3,MB0,B]  174-40-215ms   | [S3,MB1,B]  215-36-251ms   | [S3,MB2,B]  251-22-274ms   | [S3,MB3,B]  274-21-295ms   | [S3,MB4,B]  296-22-318ms   | [S3,MB5,B]  318-22-340ms   | [S3,MB6,B]  340-22-363ms   | [S3,MB7,B]  363-21-385ms  
[rank3]:2025-12-30 15:42:58,161 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/frozen_ratio_history/rank3/251230_1542_stage3_step700.svg
[rank0]:2025-12-30 15:42:58,184 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/frozen_params_histogram/251230_1542_rank0_stage0.svg
[rank0]:	> Counts Sum: 498240, Total Sum: 1491840 (33.40%), Ratio(%) per element: [37.1, 37.1, 36.3, 35.91, 35.31, 35.31, 36.3, 36.3, 22.81, 22.81, 36.11, 35.51, 35.71, 36.9, 36.3, 36.11, 36.7, 23.01, 24.0, 36.3, 36.3, 36.7, 35.51, 36.7, 36.11, 35.71, 23.01, 25.0, 35.71, 36.3, 36.3, 36.3, 35.31, 35.91, 36.11, 23.21, 23.41]
[rank2]:2025-12-30 15:42:58,171 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/frozen_params_histogram/251230_1542_rank2_stage2.svg
[rank2]:	> Counts Sum: 193440, Total Sum: 1451520 (13.33%), Ratio(%) per element: [14.28, 13.88, 13.49, 13.69, 13.49, 13.88, 13.49, 11.9, 12.1, 13.69, 13.88, 13.09, 13.29, 13.09, 13.09, 13.69, 12.1, 12.1, 14.48, 14.28, 13.09, 13.69, 13.49, 14.08, 12.89, 11.9, 12.1, 14.08, 14.28, 14.28, 13.88, 13.49, 13.69, 13.88, 11.9, 11.9]
[rank1]:2025-12-30 15:42:58,172 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/frozen_params_histogram/251230_1542_rank1_stage1.svg
[rank1]:	> Counts Sum: 706080, Total Sum: 1814400 (38.92%), Ratio(%) per element: [41.86, 43.45, 44.44, 43.65, 42.65, 43.25, 43.05, 22.61, 22.61, 43.25, 43.05, 41.86, 42.46, 43.05, 44.84, 43.84, 22.81, 22.42, 44.24, 41.86, 42.26, 43.65, 43.25, 42.46, 41.46, 26.19, 26.19, 44.64, 42.65, 42.85, 40.47, 44.04, 43.84, 41.66, 23.8, 23.01, 44.04, 43.84, 43.84, 44.44, 44.44, 45.03, 45.03, 24.0, 22.61]
[rank3]:2025-12-30 15:42:58,296 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/frozen_params_histogram/251230_1542_rank3_stage3.svg
[rank3]:	> Counts Sum: 874640, Total Sum: 1169280 (74.80%), Ratio(%) per element: [79.36, 77.77, 78.57, 79.16, 79.56, 79.96, 79.36, 64.68, 64.08, 80.15, 78.17, 78.96, 77.38, 78.37, 78.57, 79.56, 64.08, 64.08, 77.38, 79.16, 78.76, 75.99, 79.36, 80.35, 78.37, 65.27, 64.08, 64.08, 64.48]
[rank2]:2025-12-30 15:42:59,739 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/afr_time_plot/251230_1542_stage2.svg
[rank1]:2025-12-30 15:42:59,776 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/afr_time_plot/251230_1542_stage1.svg
[rank3]:2025-12-30 15:42:59,855 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/afr_time_plot/251230_1542_stage3.svg
[rank0]:2025-12-30 15:42:59,846 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/afr_time_plot/251230_1542_stage0.svg
[rank3]:2025-12-30 15:44:33,202 - Avg. fwd time: 10.7244 / Avg. bwd time: 29.4996 / Avg. batch time: 381.3233 (ms) / GPU bubble ratio: 15.61%
[rank2]:2025-12-30 15:44:33,241 - Avg. fwd time: 6.9593 / Avg. bwd time: 18.4752 / Avg. batch time: 426.4038 (ms) / GPU bubble ratio: 52.28%
[rank1]:2025-12-30 15:44:33,265 - Avg. fwd time: 9.1094 / Avg. bwd time: 19.9441 / Avg. batch time: 456.1891 (ms) / GPU bubble ratio: 49.05%
[rank0]:2025-12-30 15:44:33,278 - Avg. fwd time: 8.1818 / Avg. bwd time: 18.2012 / Avg. batch time: 473.5185 (ms) / GPU bubble ratio: 55.43%
[rank0]:2025-12-30 15:46:03,007 - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-12-30 15:46:06,773 - Avg. fwd time: 6.9592 / Avg. bwd time: 18.4735 / Avg. batch time: 425.7868 (ms) / GPU bubble ratio: 52.22%
[rank1]:2025-12-30 15:46:06,796 - Avg. fwd time: 9.1098 / Avg. bwd time: 19.9154 / Avg. batch time: 455.5255 (ms) / GPU bubble ratio: 49.03%
[rank3]:2025-12-30 15:46:06,734 - Avg. fwd time: 10.7250 / Avg. bwd time: 29.3934 / Avg. batch time: 380.4772 (ms) / GPU bubble ratio: 15.65%
[rank0]:2025-12-30 15:46:06,809 - Avg. fwd time: 8.1824 / Avg. bwd time: 18.1628 / Avg. batch time: 472.7085 (ms) / GPU bubble ratio: 55.41%
[rank0]:2025-12-30 15:46:06,845 -  step: 750  loss: -8.0000  grad_norm:  0.1688  memory: 19.09GiB(40.19%)  tps: 8,675  tflops: 67.81  mfu: 21.74%
[rank2]:2025-12-30 15:46:06,831 -  step: 750  loss: -8.0000  grad_norm:  0.1688  memory: 13.15GiB(27.69%)  tps: 8,675  tflops: 67.81  mfu: 21.74%
[rank1]:2025-12-30 15:46:06,834 -  step: 750  loss: -8.0000  grad_norm:  0.1688  memory: 16.40GiB(34.52%)  tps: 8,675  tflops: 67.81  mfu: 21.74%
[rank3]:2025-12-30 15:46:06,844 -  step: 750  loss:  0.2428  grad_norm:  0.1688  memory: 29.36GiB(61.81%)  tps: 8,675  tflops: 67.81  mfu: 21.74%
[rank2]:2025-12-30 15:47:40,311 - Avg. fwd time: 6.9591 / Avg. bwd time: 18.4733 / Avg. batch time: 425.2074 (ms) / GPU bubble ratio: 52.15%
[rank1]:2025-12-30 15:47:40,335 - Avg. fwd time: 9.1101 / Avg. bwd time: 19.8977 / Avg. batch time: 454.9079 (ms) / GPU bubble ratio: 48.99%
[rank3]:2025-12-30 15:47:40,270 - Avg. fwd time: 10.7245 / Avg. bwd time: 29.2952 / Avg. batch time: 379.6862 (ms) / GPU bubble ratio: 15.68%
[rank0]:2025-12-30 15:47:40,348 - Avg. fwd time: 8.1826 / Avg. bwd time: 18.1276 / Avg. batch time: 471.9547 (ms) / GPU bubble ratio: 55.40%
[rank0]:2025-12-30 15:49:09,996 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-30 15:49:13,737 - Avg. fwd time: 10.7240 / Avg. bwd time: 29.2003 / Avg. batch time: 378.9220 (ms) / GPU bubble ratio: 15.71%
[rank1]:2025-12-30 15:49:13,802 - Avg. fwd time: 9.1101 / Avg. bwd time: 19.8747 / Avg. batch time: 454.3048 (ms) / GPU bubble ratio: 48.96%
[rank1]:2025-12-30 15:49:13,841 -  step: 800  loss: -8.0000  grad_norm:  0.5636  memory: 16.40GiB(34.52%)  tps: 8,761  tflops: 68.49  mfu: 21.95%
[rank1]:2025-12-30 15:49:13,841 - â„¹ï¸ final step: 800  loss: -8.0000  grad_norm:  0.5636  tps: 8,860  tflops: 69.26  mfu: 20.36%
[rank1]:2025-12-30 15:49:13,841 - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-12-30 15:49:13,842 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank2]:2025-12-30 15:49:13,778 - Avg. fwd time: 6.9590 / Avg. bwd time: 18.4726 / Avg. batch time: 424.6467 (ms) / GPU bubble ratio: 52.09%
[rank2]:2025-12-30 15:49:13,838 -  step: 800  loss: -8.0000  grad_norm:  0.5636  memory: 13.15GiB(27.69%)  tps: 8,761  tflops: 68.49  mfu: 21.95%
[rank2]:2025-12-30 15:49:13,838 - â„¹ï¸ final step: 800  loss: -8.0000  grad_norm:  0.5636  tps: 8,855  tflops: 69.22  mfu: 20.27%
[rank2]:2025-12-30 15:49:13,838 - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-12-30 15:49:13,839 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank3]:2025-12-30 15:49:13,850 -  step: 800  loss:  0.2456  grad_norm:  0.5636  memory: 29.36GiB(61.81%)  tps: 8,761  tflops: 68.49  mfu: 21.95%
[rank3]:2025-12-30 15:49:13,851 - â„¹ï¸ final step: 800  loss:  0.2456  grad_norm:  0.5636  tps: 8,862  tflops: 69.28  mfu: 20.40%
[rank3]:2025-12-30 15:49:13,851 - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-12-30 15:49:13,852 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-30 15:49:13,816 - Avg. fwd time: 8.1831 / Avg. bwd time: 18.0948 / Avg. batch time: 471.2250 (ms) / GPU bubble ratio: 55.39%
[rank0]:2025-12-30 15:49:13,852 -  step: 800  loss: -8.0000  grad_norm:  0.5636  memory: 19.09GiB(40.19%)  tps: 8,761  tflops: 68.49  mfu: 21.95%
[rank0]:2025-12-30 15:49:13,852 - â„¹ï¸ final step: 800  loss: -8.0000  grad_norm:  0.5636  tps: 8,855  tflops: 69.23  mfu: 20.27%
[rank0]:2025-12-30 15:49:13,852 - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-12-30 15:49:13,853 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-30 15:49:15,769 - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank1]:2025-12-30 15:49:15,839 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/frozen_ratio_history/rank1/251230_1549_stage1_final800.svg
[rank2]:2025-12-30 15:49:15,839 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/frozen_ratio_history/rank2/251230_1549_stage2_final800.svg
[rank0]:2025-12-30 15:49:15,840 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/frozen_ratio_history/rank0/251230_1549_stage0_final800.svg
[rank3]:2025-12-30 15:49:15,925 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/pipeline_schedule/251230_1549_final800_rank3.svg
[rank3]:			> Batch Time: 450.25 ms, GPU Bubble Ratio: 55.02%, 49.56%, 54.75%, 33.55%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-24ms      | [S0,MB3,F]  24-7-32ms      | [S0,MB4,F]  32-8-40ms      | [S0,MB5,F]  40-7-48ms      | [S0,MB6,F]  48-8-56ms      | [S0,MB7,F]  56-8-65ms      | [S0,MB0,B]  272-25-298ms   | [S0,MB1,B]  306-25-331ms   | [S0,MB2,B]  336-25-361ms   | [S0,MB3,B]  366-25-391ms   | [S0,MB4,B]  393-25-419ms   | [S0,MB5,B]  420-0-420ms    | [S0,MB6,B]  435-9-444ms    | [S0,MB7,B]  450-0-450ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-8-32ms      | [S1,MB2,F]  35-8-44ms      | [S1,MB3,F]  56-8-65ms      | [S1,MB4,F]  74-8-83ms      | [S1,MB5,F]  92-8-100ms     | [S1,MB6,F]  109-8-118ms    | [S1,MB7,F]  128-8-136ms    | [S1,MB0,B]  244-25-269ms   | [S1,MB1,B]  281-21-302ms   | [S1,MB2,B]  307-25-333ms   | [S1,MB3,B]  336-25-362ms   | [S1,MB4,B]  366-12-378ms   | [S1,MB5,B]  393-21-414ms   | [S1,MB6,B]  420-11-432ms   | [S1,MB7,B]  435-11-446ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-6-39ms      | [S2,MB2,F]  53-6-60ms      | [S2,MB3,F]  71-6-77ms      | [S2,MB4,F]  88-6-95ms      | [S2,MB5,F]  106-6-113ms    | [S2,MB6,F]  124-6-131ms    | [S2,MB7,F]  142-6-149ms    | [S2,MB0,B]  221-19-241ms   | [S2,MB1,B]  258-19-278ms   | [S2,MB2,B]  284-19-304ms   | [S2,MB3,B]  308-20-328ms   | [S2,MB4,B]  336-20-356ms   | [S2,MB5,B]  366-20-386ms   | [S2,MB6,B]  393-19-413ms   | [S2,MB7,B]  420-8-429ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB1,F]  50-10-60ms     | [S3,MB2,F]  67-10-78ms     | [S3,MB3,F]  85-10-96ms     | [S3,MB4,F]  103-10-114ms   | [S3,MB5,F]  121-10-132ms   | [S3,MB6,F]  139-10-150ms   | [S3,MB7,F]  158-10-168ms   | [S3,MB0,B]  174-40-214ms   | [S3,MB1,B]  214-37-252ms   | [S3,MB2,B]  252-23-275ms   | [S3,MB3,B]  275-22-297ms   | [S3,MB4,B]  297-22-319ms   | [S3,MB5,B]  319-22-342ms   | [S3,MB6,B]  342-22-365ms   | [S3,MB7,B]  365-22-387ms  
[rank1]:2025-12-30 15:49:15,985 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/frozen_params_histogram/251230_1549_rank1_stage1.svg
[rank1]:	> Counts Sum: 823680, Total Sum: 2102400 (39.18%), Ratio(%) per element: [43.32, 43.49, 44.69, 44.0, 43.15, 43.15, 44.0, 22.94, 22.94, 43.66, 43.49, 42.8, 42.8, 43.32, 44.86, 44.17, 23.11, 23.11, 43.83, 42.63, 42.97, 43.49, 42.97, 42.29, 41.95, 26.36, 26.02, 44.34, 42.63, 43.15, 41.26, 44.52, 43.83, 42.12, 23.97, 23.28, 43.66, 44.17, 44.0, 44.52, 44.69, 45.2, 44.86, 24.14, 22.94]
[rank2]:2025-12-30 15:49:15,989 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/frozen_params_histogram/251230_1549_rank2_stage2.svg
[rank2]:	> Counts Sum: 223040, Total Sum: 1681920 (13.26%), Ratio(%) per element: [14.21, 13.86, 13.35, 13.52, 13.52, 13.86, 13.35, 11.98, 12.15, 13.52, 13.86, 13.01, 13.18, 13.01, 13.01, 13.69, 12.15, 12.15, 14.21, 14.04, 13.18, 13.52, 13.35, 13.86, 12.84, 11.98, 12.15, 13.86, 14.04, 14.04, 13.69, 13.35, 13.69, 14.04, 11.98, 11.98]
[rank3]:2025-12-30 15:49:16,059 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/pipeline_schedule/251230_1549_thry_final800_rank3.svg
[rank3]:			> Batch Time: 288.31 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-8-8ms        | [S0,MB1,F]  8-8-17ms       | [S0,MB2,F]  17-8-26ms      | [S0,MB3,F]  26-8-34ms      | [S0,MB4,F]  34-8-43ms      | [S0,MB5,F]  43-8-52ms      | [S0,MB6,F]  52-8-61ms      | [S0,MB7,F]  61-8-69ms      | [S0,MB0,B]  148-17-165ms   | [S0,MB1,B]  165-17-183ms   | [S0,MB2,B]  183-17-200ms   | [S0,MB3,B]  200-17-218ms   | [S0,MB4,B]  218-17-235ms   | [S0,MB5,B]  235-17-253ms   | [S0,MB6,B]  253-17-270ms   | [S0,MB7,B]  270-17-288ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  8-8-17ms       | [S1,MB1,F]  17-8-26ms      | [S1,MB2,F]  26-8-34ms      | [S1,MB3,F]  34-8-43ms      | [S1,MB4,F]  43-8-52ms      | [S1,MB5,F]  52-8-61ms      | [S1,MB6,F]  61-8-69ms      | [S1,MB7,F]  69-8-78ms      | [S1,MB0,B]  131-17-148ms   | [S1,MB1,B]  148-17-165ms   | [S1,MB2,B]  165-17-183ms   | [S1,MB3,B]  183-17-200ms   | [S1,MB4,B]  200-17-218ms   | [S1,MB5,B]  218-17-235ms   | [S1,MB6,B]  235-17-253ms   | [S1,MB7,B]  253-17-270ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  17-8-26ms      | [S2,MB1,F]  26-8-34ms      | [S2,MB2,F]  34-8-43ms      | [S2,MB3,F]  43-8-52ms      | [S2,MB4,F]  52-8-61ms      | [S2,MB5,F]  61-8-69ms      | [S2,MB6,F]  69-8-78ms      | [S2,MB7,F]  78-8-87ms      | [S2,MB0,B]  113-17-131ms   | [S2,MB1,B]  131-17-148ms   | [S2,MB2,B]  148-17-165ms   | [S2,MB3,B]  165-17-183ms   | [S2,MB4,B]  183-17-200ms   | [S2,MB5,B]  200-17-218ms   | [S2,MB6,B]  218-17-235ms   | [S2,MB7,B]  235-17-253ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  26-8-34ms      | [S3,MB1,F]  34-8-43ms      | [S3,MB2,F]  43-8-52ms      | [S3,MB3,F]  52-8-61ms      | [S3,MB4,F]  61-8-69ms      | [S3,MB5,F]  69-8-78ms      | [S3,MB6,F]  78-8-87ms      | [S3,MB7,F]  87-8-96ms      | [S3,MB0,B]  96-17-113ms    | [S3,MB1,B]  113-17-131ms   | [S3,MB2,B]  131-17-148ms   | [S3,MB3,B]  148-17-165ms   | [S3,MB4,B]  165-17-183ms   | [S3,MB5,B]  183-17-200ms   | [S3,MB6,B]  200-17-218ms   | [S3,MB7,B]  218-17-235ms  
[rank0]:2025-12-30 15:49:16,029 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/frozen_params_histogram/251230_1549_rank0_stage0.svg
[rank0]:	> Counts Sum: 580640, Total Sum: 1728640 (33.59%), Ratio(%) per element: [37.15, 37.15, 36.47, 36.13, 35.61, 35.61, 36.3, 36.47, 23.11, 23.11, 36.3, 35.78, 35.95, 36.98, 36.47, 36.3, 36.81, 23.28, 24.14, 36.47, 36.47, 36.81, 35.78, 36.81, 36.13, 35.95, 23.28, 25.0, 35.95, 36.47, 36.47, 36.47, 35.61, 36.13, 36.3, 23.8, 23.63]
[rank3]:2025-12-30 15:49:16,106 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/frozen_ratio_history/rank3/251230_1549_stage3_final800.svg
[rank3]:2025-12-30 15:49:16,238 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/frozen_params_histogram/251230_1549_rank3_stage3.svg
[rank3]:	> Counts Sum: 1023440, Total Sum: 1354880 (75.54%), Ratio(%) per element: [79.62, 78.42, 78.93, 79.45, 79.62, 80.47, 79.96, 66.09, 65.58, 80.47, 78.25, 79.62, 78.08, 79.1, 79.45, 79.96, 65.58, 65.75, 77.39, 79.79, 79.79, 76.71, 79.62, 80.47, 78.59, 66.6, 65.58, 65.58, 65.92]
[rank1]:2025-12-30 15:49:17,827 - âœ… Scatter Plot of Stage 1 is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/afr_time_plot/251230_1549_stage1.svg
[rank1]:2025-12-30 15:49:17,830 - Destroying the purge thread.
[rank2]:2025-12-30 15:49:17,800 - âœ… Scatter Plot of Stage 2 is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/afr_time_plot/251230_1549_stage2.svg
[rank2]:2025-12-30 15:49:17,803 - Destroying the purge thread.
[rank0]:2025-12-30 15:49:17,965 - âœ… Scatter Plot of Stage 0 is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/afr_time_plot/251230_1549_stage0.svg
[rank0]:2025-12-30 15:49:17,968 - Sleeping 2 seconds for other ranks to complete
[rank3]:2025-12-30 15:49:18,066 - âœ… Scatter Plot of Stage 3 is saved as: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1/afr_time_plot/251230_1549_stage3.svg
[rank3]:2025-12-30 15:49:18,070 - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank1]:2025-12-30 15:49:18,337 - Process group destroyed
[rank2]:2025-12-30 15:49:18,341 - Process group destroyed
[rank3]:wandb: uploading history steps 15-16, summary, console lines 331-352
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–ˆâ–‡â–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–ˆâ–‡â–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 3.69757
[rank3]:wandb:               final/avg_loss 0.24563
[rank3]:wandb:             final/avg_mfu(%) 20.39723
[rank3]:wandb:             final/avg_tflops 69.27938
[rank3]:wandb:    final/avg_throughput(tps) 8862.04369
[rank3]:wandb:              final/grad_norm 0.56364
[rank3]:wandb:               final/max_loss 0.24563
[rank3]:wandb:                    grad_norm 0.56364
[rank3]:wandb: loss_metrics/global_avg_loss 0.24563
[rank3]:wandb: loss_metrics/global_max_loss 0.24563
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1230_GPipe_timelyapf_22_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/2jc21rrd
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1230_GPipe_timelyapf_22_dm1/20251230-1456/wandb/run-20251230_145649-2jc21rrd/logs
[rank3]:2025-12-30 15:49:19,297 - Process group destroyed
[rank0]:2025-12-30 15:49:19,969 - Training completed
[rank0]:2025-12-30 15:49:19,969 - Destroying the purge thread.
[rank0]:2025-12-30 15:49:20,385 - Process group destroyed
[rank2]:Stage 2: Modules to keep: {'layers.11', 'layers.10', 'layers.9', 'layers.12'}
[rank0]:Stage 0: Modules to keep: {'layers.1', 'layers.3', 'layers.2', 'tok_embeddings', 'layers.0'}
[rank1]:Stage 1: Modules to keep: {'layers.5', 'layers.8', 'layers.6', 'layers.7', 'layers.4'}
[rank3]:Stage 3: Modules to keep: {'norm', 'layers.14', 'layers.13', 'output', 'layers.15'}
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1104_llama1b/config_1230.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, with bf16 autocast
[rank3]:1107: for timelyapf: clone().cpu() removed to fix freezing issue.!!! yay~~~
[rank3]:1108: steps 1200 (3 epochs) -> 800 (2 epochs) / alpaca dataset
[rank3]:    - learning rate : tried lr=3e-6 (->3e-9), 5e-6(->0), 1e-5(->0). BEST: lr=5e-6
[rank3]:1109: switch to alpaca_gpt4+alpaca_cleaned dataset
[rank3]:1224: everything same as 1109 (dataset: alpaca_gpt4) but debugged requires_grad bug
[rank3]:1227: everything same as 1224 but seed=42->11
[rank3]:1230: everything same as 1224 but seed=42->22
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1230_GPipe_timelyapf_22_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1230_GPipe_timelyapf_22_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1230_GPipe_timelyapf_22_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1230_GPipe_timelyapf_22_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1230_GPipe_timelyapf_22_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1230_GPipe_timelyapf_22_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 22
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: GPipe
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1230_GPipe_timelyapf_22_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1230_GPipe_timelyapf_22_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: timelyapf
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.01
[rank3]:		- percentile: 80
[rank3]:
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
