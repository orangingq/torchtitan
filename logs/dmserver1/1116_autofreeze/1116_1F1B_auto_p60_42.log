
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 11. 28. (ê¸ˆ) 17:12:43 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 1,2,3,4
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1116_autofreeze/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1116_autofreeze/1116_1F1B_auto_p60_42.log
âœ”ï¸AutoFreeze configuration experiment on different PERCENTILE values.
âœ”ï¸Running with autofreeze (percentile=60) x 1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1116_autofreeze/config_1116.toml --job.description="AutoFreeze configuration experiment on different PERCENTILE values." --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=auto --freezing.percentile=60
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank0]:2025-11-28 17:12:49,504 - INFO - Starting job: "AutoFreeze configuration experiment on different PERCENTILE values."
[rank1]:2025-11-28 17:12:49,504 - INFO - Starting job: "AutoFreeze configuration experiment on different PERCENTILE values."
[rank3]:2025-11-28 17:12:49,616 - INFO - Starting job: "AutoFreeze configuration experiment on different PERCENTILE values."
[rank1]:2025-11-28 17:12:49,718 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-11-28 17:12:49,724 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-11-28 17:12:49,726 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-28 17:12:49,728 - INFO - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-11-28 17:12:49,730 - INFO - Loading tokenizer from tokenizer.json
[rank3]:2025-11-28 17:12:49,814 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-11-28 17:12:49,817 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-11-28 17:12:49,810 - INFO - Starting job: "AutoFreeze configuration experiment on different PERCENTILE values."
[rank1]:2025-11-28 17:12:49,721 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-11-28 17:12:49,962 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-11-28 17:12:49,965 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-28 17:12:50,118 - INFO - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank1]:2025-11-28 17:12:52,973 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-11-28 17:12:53,013 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-11-28 17:12:53,035 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-11-28 17:12:53,035 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2025-11-28 17:12:53,248 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank1]:2025-11-28 17:12:53,248 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-11-28 17:12:53,248 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-11-28 17:12:53,249 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank0]:2025-11-28 17:12:53,399 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-11-28 17:12:53,437 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-28 17:12:53,438 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-11-28 17:12:53,465 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-11-28 17:12:53,465 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2025-11-28 17:12:53,658 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-28 17:12:53,658 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-11-28 17:12:53,659 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank2]:2025-11-28 17:12:54,398 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-11-28 17:12:54,438 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-11-28 17:12:54,467 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-11-28 17:12:54,467 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank2]:2025-11-28 17:12:54,650 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-11-28 17:12:54,650 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-11-28 17:12:54,651 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank3]:wandb: setting up run at454goi
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1116_1F1B_auto_p60_42_dm1/20251128-1712/wandb/run-20251128_171254-at454goi
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1116_1F1B_auto_p60_42_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/at454goi
[rank3]:2025-11-28 17:12:55,494 - INFO - WandB logging enabled
[rank3]:2025-11-28 17:12:55,495 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-11-28 17:12:55,536 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-11-28 17:12:55,565 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-11-28 17:12:55,566 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2025-11-28 17:12:55,766 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-11-28 17:12:55,750 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-11-28 17:12:55,750 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-11-28 17:12:55,751 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2025-11-28 17:12:55,766 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank2]:2025-11-28 17:12:55,770 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-28 17:12:55,766 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1116_1F1B_auto_p60_42_dm1
[rank0]:2025-11-28 17:12:55,766 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-28 17:12:55,767 - INFO - Trainer is initialized with local batch size 16, global batch size 128, gradient accumulation steps 8, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2025-11-28 17:12:55,767 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank0]:2025-11-28 17:12:58,156 - INFO - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-11-28 17:12:58,156 - INFO - Finished loading the checkpoint in 2.39 seconds.
[rank0]:2025-11-28 17:12:58,156 - INFO - Training starts at step 1
[rank1]:2025-11-28 17:13:03,688 - INFO -  step:  1  loss: -8.0000  grad_norm: 116.5367  memory:  6.76GiB(14.24%)  tps: 3,070  tflops: 24.00  mfu: 7.69%
[rank1]:2025-11-28 17:13:03,689 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-11-28 17:13:03,694 - INFO -  step:  1  loss: 10.6088  grad_norm: 116.5367  memory: 12.97GiB(27.31%)  tps: 4,018  tflops: 31.41  mfu: 10.07%
[rank0]:2025-11-28 17:13:03,723 - INFO -  step:  1  loss: -8.0000  grad_norm: 116.5367  memory:  9.19GiB(19.34%)  tps: 3,186  tflops: 24.91  mfu: 7.98%
[rank3]:2025-11-28 17:13:03,694 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-28 17:13:03,723 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-11-28 17:13:03,683 - INFO -  step:  1  loss: -8.0000  grad_norm: 116.5367  memory:  4.63GiB(9.75%)  tps: 3,544  tflops: 27.71  mfu: 8.88%
[rank2]:2025-11-28 17:13:03,684 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-11-28 17:15:05,328 - INFO - Avg. fwd time: 13.4390 / Avg. bwd time: 42.1715 / Avg. batch time: 508.5452 (ms) / GPU bubble ratio: 12.52%
[rank0]:2025-11-28 17:15:05,396 - INFO - Avg. fwd time: 7.6220 / Avg. bwd time: 24.1184 / Avg. batch time: 617.6064 (ms) / GPU bubble ratio: 58.89%
[rank2]:2025-11-28 17:15:05,366 - INFO - Avg. fwd time: 7.3613 / Avg. bwd time: 19.1301 / Avg. batch time: 540.7484 (ms) / GPU bubble ratio: 60.81%
[rank1]:2025-11-28 17:15:05,400 - INFO - Avg. fwd time: 9.2326 / Avg. bwd time: 23.7589 / Avg. batch time: 579.7010 (ms) / GPU bubble ratio: 54.47%
[rank0]:2025-11-28 17:17:08,352 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-28 17:17:13,141 - INFO - Avg. fwd time: 13.6201 / Avg. bwd time: 42.4783 / Avg. batch time: 512.3675 (ms) / GPU bubble ratio: 12.41%
[rank2]:2025-11-28 17:17:13,179 - INFO - Avg. fwd time: 7.3745 / Avg. bwd time: 19.1920 / Avg. batch time: 544.1447 (ms) / GPU bubble ratio: 60.94%
[rank0]:2025-11-28 17:17:13,210 - INFO - Avg. fwd time: 7.6429 / Avg. bwd time: 24.1856 / Avg. batch time: 620.2963 (ms) / GPU bubble ratio: 58.95%
[rank1]:2025-11-28 17:17:13,214 - INFO - Avg. fwd time: 9.2497 / Avg. bwd time: 23.8411 / Avg. batch time: 582.7308 (ms) / GPU bubble ratio: 54.57%
[rank2]:2025-11-28 17:17:13,440 - INFO -  step: 50  loss: -8.0000  grad_norm: 12.6622  memory:  6.43GiB(13.53%)  tps: 6,429  tflops: 50.26  mfu: 16.11%
[rank0]:2025-11-28 17:17:13,455 - INFO -  step: 50  loss: -8.0000  grad_norm: 12.6622  memory: 12.97GiB(27.31%)  tps: 6,429  tflops: 50.26  mfu: 16.11%
[rank3]:2025-11-28 17:17:13,453 - INFO -  step: 50  loss:  9.9166  grad_norm: 12.6622  memory: 16.39GiB(34.50%)  tps: 6,429  tflops: 50.26  mfu: 16.11%
[rank1]:2025-11-28 17:17:13,444 - INFO -  step: 50  loss: -8.0000  grad_norm: 12.6622  memory:  9.03GiB(19.01%)  tps: 6,429  tflops: 50.26  mfu: 16.11%
[rank0]:2025-11-28 17:18:04,660 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 0.0000e+00
[rank3]:2025-11-28 17:18:04,656 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 0.0000e+00
[rank1]:2025-11-28 17:18:04,648 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 0.0000e+00
[rank2]:2025-11-28 17:18:04,645 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 0.0000e+00
[rank0]:2025-11-28 17:18:55,904 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 4.8420e+00
[rank3]:2025-11-28 17:18:55,899 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 3.4432e+00
[rank1]:2025-11-28 17:18:55,891 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 3.7449e+00
[rank2]:2025-11-28 17:18:55,887 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 3.2884e+00
[rank3]:2025-11-28 17:19:19,590 - INFO - Avg. fwd time: 13.7130 / Avg. bwd time: 42.1305 / Avg. batch time: 510.3016 (ms) / GPU bubble ratio: 12.45%
[rank2]:2025-11-28 17:19:19,616 - INFO - Avg. fwd time: 7.3699 / Avg. bwd time: 19.2228 / Avg. batch time: 541.9601 (ms) / GPU bubble ratio: 60.75%
[rank0]:2025-11-28 17:19:19,676 - INFO - Avg. fwd time: 7.6525 / Avg. bwd time: 24.2166 / Avg. batch time: 617.9288 (ms) / GPU bubble ratio: 58.74%
[rank1]:2025-11-28 17:19:19,646 - INFO - Avg. fwd time: 9.2468 / Avg. bwd time: 23.8763 / Avg. batch time: 580.4420 (ms) / GPU bubble ratio: 54.35%
[rank3]:2025-11-28 17:19:43,460 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 4.8291e+00
[rank2]:2025-11-28 17:19:43,456 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.9961e+00
[rank1]:2025-11-28 17:19:43,461 - INFO - Freezing Ratio: [Stage1] 0.20, Threshold: 8.3957e-01
[rank0]:2025-11-28 17:19:43,472 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 3.9144e+00
[rank2]:2025-11-28 17:20:33,681 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.4754e+00
[rank3]:2025-11-28 17:20:33,700 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.8886e+00
[rank0]:2025-11-28 17:20:33,701 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 3.9892e+00
[rank1]:2025-11-28 17:20:33,689 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.0422e+00
[rank0]:2025-11-28 17:21:16,266 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-28 17:21:20,612 - INFO - Avg. fwd time: 13.7978 / Avg. bwd time: 41.4324 / Avg. batch time: 505.3771 (ms) / GPU bubble ratio: 12.57%
[rank2]:2025-11-28 17:21:20,690 - INFO - Avg. fwd time: 7.4421 / Avg. bwd time: 18.6931 / Avg. batch time: 536.4290 (ms) / GPU bubble ratio: 61.02%
[rank1]:2025-11-28 17:21:20,724 - INFO - Avg. fwd time: 9.2819 / Avg. bwd time: 23.6246 / Avg. batch time: 574.5943 (ms) / GPU bubble ratio: 54.18%
[rank0]:2025-11-28 17:21:20,721 - INFO - Avg. fwd time: 7.7004 / Avg. bwd time: 23.9609 / Avg. batch time: 611.7870 (ms) / GPU bubble ratio: 58.60%
[rank2]:2025-11-28 17:21:20,939 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 4.2188e+00
[rank2]:2025-11-28 17:21:20,940 - INFO -  step: 100  loss: -8.0000  grad_norm:  8.5971  memory:  6.43GiB(13.53%)  tps: 6,620  tflops: 51.75  mfu: 16.59%
[rank3]:2025-11-28 17:21:20,943 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 3.1640e+00
[rank3]:2025-11-28 17:21:20,946 - INFO -  step: 100  loss:  8.4348  grad_norm:  8.5971  memory: 16.39GiB(34.50%)  tps: 6,620  tflops: 51.75  mfu: 16.59%
[rank1]:2025-11-28 17:21:20,943 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 4.4518e+00
[rank1]:2025-11-28 17:21:20,944 - INFO -  step: 100  loss: -8.0000  grad_norm:  8.5971  memory:  9.03GiB(19.01%)  tps: 6,620  tflops: 51.75  mfu: 16.59%
[rank0]:2025-11-28 17:21:20,956 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 3.3951e+00
[rank0]:2025-11-28 17:21:20,957 - INFO -  step: 100  loss: -8.0000  grad_norm:  8.5971  memory: 12.97GiB(27.31%)  tps: 6,620  tflops: 51.75  mfu: 16.59%
[rank2]:2025-11-28 17:21:21,028 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p60_42_dm1/frozen_ratio_history/rank2/251128_1721_stage2_step100.svg
[rank1]:2025-11-28 17:21:21,025 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p60_42_dm1/frozen_ratio_history/rank1/251128_1721_stage1_step100.svg
[rank0]:2025-11-28 17:21:21,024 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p60_42_dm1/frozen_ratio_history/rank0/251128_1721_stage0_step100.svg
[rank3]:2025-11-28 17:21:21,118 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p60_42_dm1/pipeline_schedule/251128_1721_real_step100_rank3.svg
[rank3]:			> Batch Time: 578.34 ms, GPU Bubble Ratio: 55.51%, 53.97%, 63.06%, 29.61%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms                       | [S0,MB1,F]  9-7-17ms                      | [S0,MB2,F]  17-7-25ms                     | [S0,MB3,F]  25-7-33ms                     | [S0,MB0,B]  140-24-165ms                  | [S0,MB4,F]  165-7-172ms                   | [S0,MB1,B]  195-24-219ms                  | [S0,MB5,F]  219-7-227ms                   | [S0,MB2,B]  253-24-278ms                  | [S0,MB6,F]  278-7-285ms                   | [S0,MB3,B]  314-24-339ms                  | [S0,MB7,F]  339-7-346ms                   | [S0,MB4,B]  375-24-400ms                  | [S0,MB5,B]  434-24-458ms                  | [S0,MB6,B]  492-24-516ms                  | [S0,MB7,B]  554-24-578ms                 
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms                     | [S1,MB1,F]  23-8-32ms                     | [S1,MB2,F]  35-8-44ms                     | [S1,MB0,B]  111-24-135ms                  | [S1,MB3,F]  139-8-147ms                   | [S1,MB1,B]  166-24-190ms                  | [S1,MB4,F]  193-9-202ms                   | [S1,MB2,B]  224-24-248ms                  | [S1,MB5,F]  252-9-261ms                   | [S1,MB3,B]  285-24-309ms                  | [S1,MB6,F]  313-9-322ms                   | [S1,MB4,B]  346-24-370ms                  | [S1,MB7,F]  374-9-383ms                   | [S1,MB5,B]  407-24-431ms                  | [S1,MB6,B]  465-23-489ms                  | [S1,MB7,B]  526-23-550ms                 
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms                     | [S2,MB1,F]  32-7-39ms                     | [S2,MB0,B]  86-19-106ms                   | [S2,MB2,F]  109-7-116ms                   | [S2,MB1,B]  141-19-161ms                  | [S2,MB3,F]  164-7-171ms                   | [S2,MB2,B]  200-19-219ms                  | [S2,MB4,F]  223-7-230ms                   | [S2,MB3,B]  260-19-280ms                  | [S2,MB5,F]  283-7-290ms                   | [S2,MB4,B]  322-19-341ms                  | [S2,MB6,F]  345-7-352ms                   | [S2,MB5,B]  382-19-402ms                  | [S2,MB7,F]  405-7-412ms                   | [S2,MB6,B]  442-19-462ms                  | [S2,MB7,B]  503-19-523ms                 
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-43ms                    | [S3,MB0,B]  49-33-82ms                    | [S3,MB1,F]  85-11-96ms                    | [S3,MB1,B]  102-34-137ms                  | [S3,MB2,F]  140-14-154ms                  | [S3,MB2,B]  160-36-196ms                  | [S3,MB3,F]  198-15-214ms                  | [S3,MB3,B]  219-36-256ms                  | [S3,MB4,F]  259-15-274ms                  | [S3,MB4,B]  280-37-317ms                  | [S3,MB5,F]  320-15-335ms                  | [S3,MB5,B]  341-37-379ms                  | [S3,MB6,F]  381-14-396ms                  | [S3,MB6,B]  403-37-440ms                  | [S3,MB7,F]  441-14-456ms                  | [S3,MB7,B]  464-37-501ms                 
[rank3]:2025-11-28 17:21:21,166 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p60_42_dm1/frozen_ratio_history/rank3/251128_1721_stage3_step100.svg
[rank1]:2025-11-28 17:22:10,963 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.3091e+00
[rank2]:2025-11-28 17:22:10,963 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.1576e+00
[rank0]:2025-11-28 17:22:10,982 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 2.9517e+00
[rank3]:2025-11-28 17:22:10,983 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.5433e-01
[rank0]:2025-11-28 17:22:58,627 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 3.2613e+00
[rank3]:2025-11-28 17:22:58,614 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.6341e+00
[rank1]:2025-11-28 17:22:58,615 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.0071e+00
[rank2]:2025-11-28 17:22:58,611 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.9145e+00
[rank2]:2025-11-28 17:23:23,197 - INFO - Avg. fwd time: 7.5028 / Avg. bwd time: 18.2272 / Avg. batch time: 533.3661 (ms) / GPU bubble ratio: 61.41%
[rank1]:2025-11-28 17:23:23,218 - INFO - Avg. fwd time: 9.3837 / Avg. bwd time: 22.8136 / Avg. batch time: 570.6793 (ms) / GPU bubble ratio: 54.86%
[rank3]:2025-11-28 17:23:23,174 - INFO - Avg. fwd time: 13.8539 / Avg. bwd time: 41.0460 / Avg. batch time: 502.7263 (ms) / GPU bubble ratio: 12.64%
[rank0]:2025-11-28 17:23:23,186 - INFO - Avg. fwd time: 7.7354 / Avg. bwd time: 23.7326 / Avg. batch time: 607.6016 (ms) / GPU bubble ratio: 58.57%
[rank2]:2025-11-28 17:23:48,512 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.7995e+00
[rank1]:2025-11-28 17:23:48,512 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 3.2173e+00
[rank3]:2025-11-28 17:23:48,532 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.0362e+00
[rank0]:2025-11-28 17:23:48,532 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 4.1663e+01
[rank2]:2025-11-28 17:24:35,576 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.5801e+00
[rank3]:2025-11-28 17:24:35,580 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 3.1885e+00
[rank1]:2025-11-28 17:24:35,580 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 2.8565e-01
[rank0]:2025-11-28 17:24:35,588 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 3.0428e+00
[rank0]:2025-11-28 17:25:20,231 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-28 17:25:25,132 - INFO - Avg. fwd time: 13.8792 / Avg. bwd time: 40.9164 / Avg. batch time: 501.8909 (ms) / GPU bubble ratio: 12.66%
[rank2]:2025-11-28 17:25:25,153 - INFO - Avg. fwd time: 7.5545 / Avg. bwd time: 17.8385 / Avg. batch time: 532.0865 (ms) / GPU bubble ratio: 61.82%
[rank1]:2025-11-28 17:25:25,176 - INFO - Avg. fwd time: 9.4692 / Avg. bwd time: 22.1565 / Avg. batch time: 568.7180 (ms) / GPU bubble ratio: 55.51%
[rank1]:2025-11-28 17:25:25,216 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 4.3484e+00
[rank1]:2025-11-28 17:25:25,216 - INFO -  step: 150  loss: -8.0000  grad_norm: 10.7018  memory:  9.03GiB(19.01%)  tps: 6,707  tflops: 52.43  mfu: 16.81%
[rank0]:2025-11-28 17:25:25,201 - INFO - Avg. fwd time: 7.8109 / Avg. bwd time: 23.1840 / Avg. batch time: 605.0803 (ms) / GPU bubble ratio: 59.02%
[rank0]:2025-11-28 17:25:25,231 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 4.0302e+00
[rank0]:2025-11-28 17:25:25,232 - INFO -  step: 150  loss: -8.0000  grad_norm: 10.7018  memory: 12.97GiB(27.31%)  tps: 6,707  tflops: 52.43  mfu: 16.81%
[rank2]:2025-11-28 17:25:25,216 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 4.4019e+00
[rank2]:2025-11-28 17:25:25,216 - INFO -  step: 150  loss: -8.0000  grad_norm: 10.7018  memory:  6.43GiB(13.53%)  tps: 6,707  tflops: 52.43  mfu: 16.81%
[rank3]:2025-11-28 17:25:25,235 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 8.7316e-01
[rank3]:2025-11-28 17:25:25,239 - INFO -  step: 150  loss:  3.9072  grad_norm: 10.7018  memory: 16.39GiB(34.50%)  tps: 6,707  tflops: 52.43  mfu: 16.80%
[rank2]:2025-11-28 17:26:12,413 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 5.2774e+00
[rank3]:2025-11-28 17:26:12,416 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 3.0535e+00
[rank1]:2025-11-28 17:26:12,417 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.7223e+00
[rank0]:2025-11-28 17:26:12,424 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 5.4780e+00
[rank2]:2025-11-28 17:27:01,983 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 3.5614e+00
[rank3]:2025-11-28 17:27:02,002 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.2471e+00
[rank0]:2025-11-28 17:27:01,998 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 1.7139e+00
[rank1]:2025-11-28 17:27:01,983 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.5705e+00
[rank3]:2025-11-28 17:27:25,169 - INFO - Avg. fwd time: 13.8990 / Avg. bwd time: 40.6870 / Avg. batch time: 500.2097 (ms) / GPU bubble ratio: 12.70%
[rank2]:2025-11-28 17:27:25,248 - INFO - Avg. fwd time: 7.5693 / Avg. bwd time: 17.7236 / Avg. batch time: 530.2551 (ms) / GPU bubble ratio: 61.84%
[rank0]:2025-11-28 17:27:25,242 - INFO - Avg. fwd time: 7.8594 / Avg. bwd time: 22.8264 / Avg. batch time: 602.6394 (ms) / GPU bubble ratio: 59.26%
[rank1]:2025-11-28 17:27:25,284 - INFO - Avg. fwd time: 9.4997 / Avg. bwd time: 21.9378 / Avg. batch time: 566.6503 (ms) / GPU bubble ratio: 55.62%
[rank2]:2025-11-28 17:27:49,029 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.2505e+01
[rank3]:2025-11-28 17:27:49,033 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 8.9727e-01
[rank0]:2025-11-28 17:27:49,040 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 9.0006e+00
[rank1]:2025-11-28 17:27:49,033 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 4.0651e+00
[rank1]:2025-11-28 17:28:38,678 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 3.6021e+00
[rank2]:2025-11-28 17:28:38,678 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 4.4044e+00
[rank3]:2025-11-28 17:28:38,698 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 8.7017e-01
[rank0]:2025-11-28 17:28:38,694 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 3.7854e+00
[rank0]:2025-11-28 17:29:21,096 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-28 17:29:25,621 - INFO - Avg. fwd time: 7.5773 / Avg. bwd time: 17.6675 / Avg. batch time: 528.3031 (ms) / GPU bubble ratio: 61.77%
[rank3]:2025-11-28 17:29:25,539 - INFO - Avg. fwd time: 13.9174 / Avg. bwd time: 40.4345 / Avg. batch time: 498.3431 (ms) / GPU bubble ratio: 12.75%
[rank0]:2025-11-28 17:29:25,612 - INFO - Avg. fwd time: 7.9005 / Avg. bwd time: 22.5354 / Avg. batch time: 600.2507 (ms) / GPU bubble ratio: 59.44%
[rank1]:2025-11-28 17:29:25,656 - INFO - Avg. fwd time: 9.5209 / Avg. bwd time: 21.8139 / Avg. batch time: 564.5595 (ms) / GPU bubble ratio: 55.60%
[rank2]:2025-11-28 17:29:25,871 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.7106e+00
[rank2]:2025-11-28 17:29:25,872 - INFO -  step: 200  loss: -8.0000  grad_norm:  8.5795  memory:  6.43GiB(13.53%)  tps: 6,808  tflops: 53.22  mfu: 17.06%
[rank3]:2025-11-28 17:29:25,875 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 9.9800e-01
[rank3]:2025-11-28 17:29:25,878 - INFO -  step: 200  loss:  1.1391  grad_norm:  8.5795  memory: 16.39GiB(34.50%)  tps: 6,809  tflops: 53.23  mfu: 17.06%
[rank0]:2025-11-28 17:29:25,883 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 4.8633e+00
[rank0]:2025-11-28 17:29:25,884 - INFO -  step: 200  loss: -8.0000  grad_norm:  8.5795  memory: 12.97GiB(27.31%)  tps: 6,808  tflops: 53.22  mfu: 17.06%
[rank0]:2025-11-28 17:29:25,934 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p60_42_dm1/frozen_ratio_history/rank0/251128_1729_stage0_step200.svg
[rank1]:2025-11-28 17:29:25,876 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 6.0904e-01
[rank1]:2025-11-28 17:29:25,876 - INFO -  step: 200  loss: -8.0000  grad_norm:  8.5795  memory:  9.03GiB(19.01%)  tps: 6,808  tflops: 53.22  mfu: 17.06%
[rank1]:2025-11-28 17:29:25,936 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p60_42_dm1/frozen_ratio_history/rank1/251128_1729_stage1_step200.svg
[rank2]:2025-11-28 17:29:25,934 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p60_42_dm1/frozen_ratio_history/rank2/251128_1729_stage2_step200.svg
[rank3]:2025-11-28 17:29:26,028 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p60_42_dm1/pipeline_schedule/251128_1729_real_step200_rank3.svg
[rank3]:			> Batch Time: 567.67 ms, GPU Bubble Ratio: 58.10%, 53.08%, 62.40%, 29.21%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms                       | [S0,MB1,F]  9-8-17ms                      | [S0,MB2,F]  17-8-26ms                     | [S0,MB3,F]  26-7-33ms                     | [S0,MB0,B]  140-21-162ms                  | [S0,MB4,F]  162-7-169ms                   | [S0,MB1,B]  195-21-216ms                  | [S0,MB5,F]  216-7-224ms                   | [S0,MB2,B]  252-21-274ms                  | [S0,MB6,F]  274-7-281ms                   | [S0,MB3,B]  311-21-333ms                  | [S0,MB7,F]  333-7-341ms                   | [S0,MB4,B]  370-21-392ms                  | [S0,MB5,B]  428-21-450ms                  | [S0,MB6,B]  486-21-507ms                  | [S0,MB7,B]  546-21-567ms                 
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms                     | [S1,MB1,F]  23-8-32ms                     | [S1,MB2,F]  35-8-44ms                     | [S1,MB0,B]  111-24-135ms                  | [S1,MB3,F]  138-8-147ms                   | [S1,MB1,B]  165-24-189ms                  | [S1,MB4,F]  193-9-202ms                   | [S1,MB2,B]  223-24-247ms                  | [S1,MB5,F]  250-9-260ms                   | [S1,MB3,B]  282-24-306ms                  | [S1,MB6,F]  310-9-319ms                   | [S1,MB4,B]  341-24-365ms                  | [S1,MB7,F]  369-8-378ms                   | [S1,MB5,B]  401-24-425ms                  | [S1,MB6,B]  458-23-482ms                  | [S1,MB7,B]  518-23-542ms                 
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms                     | [S2,MB1,F]  32-7-39ms                     | [S2,MB0,B]  86-19-106ms                   | [S2,MB2,F]  109-7-116ms                   | [S2,MB1,B]  141-19-160ms                  | [S2,MB3,F]  164-7-171ms                   | [S2,MB2,B]  198-19-218ms                  | [S2,MB4,F]  221-7-228ms                   | [S2,MB3,B]  257-19-277ms                  | [S2,MB5,F]  280-7-287ms                   | [S2,MB4,B]  316-19-335ms                  | [S2,MB6,F]  339-7-346ms                   | [S2,MB5,B]  376-19-395ms                  | [S2,MB7,F]  399-7-406ms                   | [S2,MB6,B]  436-19-455ms                  | [S2,MB7,B]  496-19-515ms                 
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms                    | [S3,MB0,B]  48-33-82ms                    | [S3,MB1,F]  84-11-96ms                    | [S3,MB1,B]  102-35-137ms                  | [S3,MB2,F]  139-13-153ms                  | [S3,MB2,B]  158-36-195ms                  | [S3,MB3,F]  197-13-211ms                  | [S3,MB3,B]  216-36-253ms                  | [S3,MB4,F]  256-14-271ms                  | [S3,MB4,B]  275-36-312ms                  | [S3,MB5,F]  315-15-330ms                  | [S3,MB5,B]  335-36-372ms                  | [S3,MB6,F]  374-15-390ms                  | [S3,MB6,B]  395-36-432ms                  | [S3,MB7,F]  434-14-449ms                  | [S3,MB7,B]  455-37-492ms                 
[rank3]:2025-11-28 17:29:26,078 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p60_42_dm1/frozen_ratio_history/rank3/251128_1729_stage3_step200.svg
[rank2]:2025-11-28 17:30:15,757 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 6.8760e+00
[rank3]:2025-11-28 17:30:15,777 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 7.0680e-01
[rank0]:2025-11-28 17:30:15,773 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 2.6849e+00
[rank1]:2025-11-28 17:30:15,757 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 3.8012e+00
[rank2]:2025-11-28 17:31:02,848 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.1686e+01
[rank3]:2025-11-28 17:31:02,852 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.9754e+00
[rank0]:2025-11-28 17:31:02,860 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 5.0576e+00
[rank1]:2025-11-28 17:31:02,853 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 3.2810e+00
[rank3]:2025-11-28 17:31:27,595 - INFO - Avg. fwd time: 13.9343 / Avg. bwd time: 40.3895 / Avg. batch time: 498.1142 (ms) / GPU bubble ratio: 12.75%
[rank2]:2025-11-28 17:31:27,616 - INFO - Avg. fwd time: 7.6001 / Avg. bwd time: 17.5102 / Avg. batch time: 527.9585 (ms) / GPU bubble ratio: 61.95%
[rank0]:2025-11-28 17:31:27,664 - INFO - Avg. fwd time: 7.9489 / Avg. bwd time: 22.1978 / Avg. batch time: 599.2889 (ms) / GPU bubble ratio: 59.76%
[rank1]:2025-11-28 17:31:27,640 - INFO - Avg. fwd time: 9.5602 / Avg. bwd time: 21.5479 / Avg. batch time: 563.9426 (ms) / GPU bubble ratio: 55.87%
[rank2]:2025-11-28 17:31:52,251 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.4483e+00
[rank3]:2025-11-28 17:31:52,271 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 5.1152e-01
[rank0]:2025-11-28 17:31:52,262 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 4.3399e+00
[rank1]:2025-11-28 17:31:52,251 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 4.4990e+00
[rank1]:2025-11-28 17:32:39,607 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.7494e+00
[rank2]:2025-11-28 17:32:39,603 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.6113e+00
[rank3]:2025-11-28 17:32:39,606 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 3.5420e+00
[rank0]:2025-11-28 17:32:39,615 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.0280e+00
[rank0]:2025-11-28 17:33:24,017 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-28 17:33:28,645 - INFO - Avg. fwd time: 13.9468 / Avg. bwd time: 40.3445 / Avg. batch time: 497.8494 (ms) / GPU bubble ratio: 12.76%
[rank0]:2025-11-28 17:33:28,639 - INFO - Avg. fwd time: 7.9931 / Avg. bwd time: 21.8819 / Avg. batch time: 598.4025 (ms) / GPU bubble ratio: 60.06%
[rank2]:2025-11-28 17:33:28,667 - INFO - Avg. fwd time: 7.6139 / Avg. bwd time: 17.4118 / Avg. batch time: 527.5735 (ms) / GPU bubble ratio: 62.05%
[rank1]:2025-11-28 17:33:28,690 - INFO - Avg. fwd time: 9.5842 / Avg. bwd time: 21.3780 / Avg. batch time: 563.3798 (ms) / GPU bubble ratio: 56.03%
[rank2]:2025-11-28 17:33:28,917 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 9.0807e+00
[rank2]:2025-11-28 17:33:28,918 - INFO -  step: 250  loss: -8.0000  grad_norm:  2.3399  memory:  6.43GiB(13.53%)  tps: 6,741  tflops: 52.70  mfu: 16.89%
[rank3]:2025-11-28 17:33:28,937 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 9.4725e-01
[rank3]:2025-11-28 17:33:28,940 - INFO -  step: 250  loss:  0.4208  grad_norm:  2.3399  memory: 16.39GiB(34.50%)  tps: 6,741  tflops: 52.70  mfu: 16.89%
[rank0]:2025-11-28 17:33:28,929 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 2.2453e+00
[rank0]:2025-11-28 17:33:28,929 - INFO -  step: 250  loss: -8.0000  grad_norm:  2.3399  memory: 12.97GiB(27.31%)  tps: 6,741  tflops: 52.70  mfu: 16.89%
[rank1]:2025-11-28 17:33:28,917 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.9963e+00
[rank1]:2025-11-28 17:33:28,918 - INFO -  step: 250  loss: -8.0000  grad_norm:  2.3399  memory:  9.03GiB(19.01%)  tps: 6,741  tflops: 52.70  mfu: 16.89%
[rank2]:2025-11-28 17:34:15,513 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.5212e+00
[rank3]:2025-11-28 17:34:15,528 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.2767e+00
[rank1]:2025-11-28 17:34:15,529 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 4.0022e-01
[rank0]:2025-11-28 17:34:15,536 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.1082e-01
[rank2]:2025-11-28 17:35:04,948 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.0219e+00
[rank3]:2025-11-28 17:35:04,967 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.4949e+00
[rank1]:2025-11-28 17:35:04,948 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 8.4981e+00
[rank0]:2025-11-28 17:35:04,959 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 7.8809e+00
[rank3]:2025-11-28 17:35:27,960 - INFO - Avg. fwd time: 13.9603 / Avg. bwd time: 40.2570 / Avg. batch time: 497.2620 (ms) / GPU bubble ratio: 12.77%
[rank0]:2025-11-28 17:35:28,026 - INFO - Avg. fwd time: 8.0312 / Avg. bwd time: 21.6209 / Avg. batch time: 596.9702 (ms) / GPU bubble ratio: 60.26%
[rank2]:2025-11-28 17:35:28,021 - INFO - Avg. fwd time: 7.6780 / Avg. bwd time: 16.9573 / Avg. batch time: 526.5091 (ms) / GPU bubble ratio: 62.57%
[rank1]:2025-11-28 17:35:28,069 - INFO - Avg. fwd time: 9.6017 / Avg. bwd time: 21.2758 / Avg. batch time: 562.2098 (ms) / GPU bubble ratio: 56.06%
[rank2]:2025-11-28 17:35:51,606 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 3.7367e-01
[rank3]:2025-11-28 17:35:51,621 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.9805e-01
[rank1]:2025-11-28 17:35:51,622 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.8963e-01
[rank0]:2025-11-28 17:35:51,630 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.7024e-01
[rank2]:2025-11-28 17:36:41,085 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.4537e+00
[rank1]:2025-11-28 17:36:41,085 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.3369e+00
[rank0]:2025-11-28 17:36:41,097 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 8.5537e-01
[rank3]:2025-11-28 17:36:41,105 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.4375e-01
[rank0]:2025-11-28 17:37:23,570 - INFO - [GC] Peforming periodical GC collection 0.02 seconds
[rank2]:2025-11-28 17:37:28,244 - INFO - Avg. fwd time: 7.7338 / Avg. bwd time: 16.5604 / Avg. batch time: 525.2468 (ms) / GPU bubble ratio: 63.00%
[rank3]:2025-11-28 17:37:28,222 - INFO - Avg. fwd time: 13.9846 / Avg. bwd time: 40.1240 / Avg. batch time: 496.4115 (ms) / GPU bubble ratio: 12.80%
[rank1]:2025-11-28 17:37:28,276 - INFO - Avg. fwd time: 9.6132 / Avg. bwd time: 21.2616 / Avg. batch time: 560.9295 (ms) / GPU bubble ratio: 55.97%
[rank2]:2025-11-28 17:37:28,318 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.1085e+00
[rank2]:2025-11-28 17:37:28,318 - INFO -  step: 300  loss: -8.0000  grad_norm:  0.4783  memory:  6.43GiB(13.53%)  tps: 6,844  tflops: 53.50  mfu: 17.15%
[rank3]:2025-11-28 17:37:28,333 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.3425e+00
[rank3]:2025-11-28 17:37:28,336 - INFO -  step: 300  loss:  0.2899  grad_norm:  0.4783  memory: 16.39GiB(34.50%)  tps: 6,844  tflops: 53.50  mfu: 17.15%
[rank1]:2025-11-28 17:37:28,333 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 2.3023e-01
[rank1]:2025-11-28 17:37:28,334 - INFO -  step: 300  loss: -8.0000  grad_norm:  0.4783  memory:  9.03GiB(19.01%)  tps: 6,843  tflops: 53.50  mfu: 17.15%
[rank0]:2025-11-28 17:37:28,306 - INFO - Avg. fwd time: 8.0851 / Avg. bwd time: 21.4499 / Avg. batch time: 595.5778 (ms) / GPU bubble ratio: 60.33%
[rank0]:2025-11-28 17:37:28,341 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.1623e-01
[rank0]:2025-11-28 17:37:28,342 - INFO -  step: 300  loss: -8.0000  grad_norm:  0.4783  memory: 12.97GiB(27.31%)  tps: 6,843  tflops: 53.50  mfu: 17.15%
[rank2]:2025-11-28 17:37:28,409 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p60_42_dm1/frozen_ratio_history/rank2/251128_1737_stage2_step300.svg
[rank1]:2025-11-28 17:37:28,406 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p60_42_dm1/frozen_ratio_history/rank1/251128_1737_stage1_step300.svg
[rank0]:2025-11-28 17:37:28,408 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p60_42_dm1/frozen_ratio_history/rank0/251128_1737_stage0_step300.svg
[rank3]:2025-11-28 17:37:28,484 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p60_42_dm1/pipeline_schedule/251128_1737_real_step300_rank3.svg
[rank3]:			> Batch Time: 567.73 ms, GPU Bubble Ratio: 57.80%, 52.79%, 71.96%, 28.39%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-10-10ms                     | [S0,MB1,F]  10-8-18ms                     | [S0,MB2,F]  18-8-27ms                     | [S0,MB3,F]  27-8-35ms                     | [S0,MB0,B]  133-21-155ms                  | [S0,MB4,F]  155-7-163ms                   | [S0,MB1,B]  189-21-210ms                  | [S0,MB5,F]  210-7-218ms                   | [S0,MB2,B]  246-21-268ms                  | [S0,MB6,F]  268-7-275ms                   | [S0,MB3,B]  306-21-328ms                  | [S0,MB7,F]  328-7-335ms                   | [S0,MB4,B]  366-21-388ms                  | [S0,MB5,B]  425-21-447ms                  | [S0,MB6,B]  485-21-506ms                  | [S0,MB7,B]  546-21-567ms                 
[rank3]:			  [Rank 1]	[S1,MB0,F]  10-11-21ms                    | [S1,MB1,F]  24-8-33ms                     | [S1,MB2,F]  36-8-45ms                     | [S1,MB0,B]  103-24-128ms                  | [S1,MB3,F]  131-8-140ms                   | [S1,MB1,B]  158-24-182ms                  | [S1,MB4,F]  186-9-195ms                   | [S1,MB2,B]  215-24-240ms                  | [S1,MB5,F]  243-9-253ms                   | [S1,MB3,B]  275-24-300ms                  | [S1,MB6,F]  303-9-313ms                   | [S1,MB4,B]  337-24-361ms                  | [S1,MB7,F]  364-9-373ms                   | [S1,MB5,B]  398-24-422ms                  | [S1,MB6,B]  457-24-481ms                  | [S1,MB7,B]  517-24-541ms                 
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-8-30ms                     | [S2,MB1,F]  33-8-41ms                     | [S2,MB0,B]  87-11-98ms                    | [S2,MB2,F]  102-8-110ms                   | [S2,MB1,B]  142-11-153ms                  | [S2,MB3,F]  157-8-165ms                   | [S2,MB2,B]  199-11-210ms                  | [S2,MB4,F]  214-8-222ms                   | [S2,MB3,B]  259-11-271ms                  | [S2,MB5,F]  274-8-283ms                   | [S2,MB4,B]  320-11-331ms                  | [S2,MB6,F]  335-8-343ms                   | [S2,MB5,B]  381-11-393ms                  | [S2,MB7,F]  396-8-405ms                   | [S2,MB6,B]  442-11-454ms                  | [S2,MB7,B]  503-11-514ms                 
[rank3]:			  [Rank 3]	[S3,MB0,F]  30-13-43ms                    | [S3,MB0,B]  49-34-83ms                    | [S3,MB1,F]  85-11-97ms                    | [S3,MB1,B]  103-34-138ms                  | [S3,MB2,F]  140-13-154ms                  | [S3,MB2,B]  159-35-195ms                  | [S3,MB3,F]  197-15-213ms                  | [S3,MB3,B]  219-36-255ms                  | [S3,MB4,F]  258-16-274ms                  | [S3,MB4,B]  279-37-316ms                  | [S3,MB5,F]  318-15-334ms                  | [S3,MB5,B]  340-37-377ms                  | [S3,MB6,F]  380-15-395ms                  | [S3,MB6,B]  401-37-439ms                  | [S3,MB7,F]  441-14-456ms                  | [S3,MB7,B]  462-37-500ms                 
[rank3]:2025-11-28 17:37:28,530 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p60_42_dm1/frozen_ratio_history/rank3/251128_1737_stage3_step300.svg
[rank2]:2025-11-28 17:38:18,674 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.8865e-01
[rank1]:2025-11-28 17:38:18,667 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 3.4539e-01
[rank3]:2025-11-28 17:38:18,690 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 8.3049e-02
[rank0]:2025-11-28 17:38:18,679 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 1.4958e+00
[rank2]:2025-11-28 17:39:05,383 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.4862e+00
[rank3]:2025-11-28 17:39:05,399 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.8123e-01
[rank0]:2025-11-28 17:39:05,407 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.2714e-01
[rank1]:2025-11-28 17:39:05,400 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 2.6971e-01
[rank2]:2025-11-28 17:39:29,831 - INFO - Avg. fwd time: 7.7701 / Avg. bwd time: 16.3049 / Avg. batch time: 524.8755 (ms) / GPU bubble ratio: 63.31%
[rank3]:2025-11-28 17:39:29,809 - INFO - Avg. fwd time: 13.9831 / Avg. bwd time: 40.1076 / Avg. batch time: 496.2707 (ms) / GPU bubble ratio: 12.80%
[rank0]:2025-11-28 17:39:29,801 - INFO - Avg. fwd time: 8.1314 / Avg. bwd time: 21.2611 / Avg. batch time: 594.9924 (ms) / GPU bubble ratio: 60.48%
[rank1]:2025-11-28 17:39:29,852 - INFO - Avg. fwd time: 9.6306 / Avg. bwd time: 21.1525 / Avg. batch time: 560.4535 (ms) / GPU bubble ratio: 56.06%
[rank2]:2025-11-28 17:39:54,952 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.1480e-01
[rank3]:2025-11-28 17:39:54,971 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.9109e-01
[rank0]:2025-11-28 17:39:54,964 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 4.7894e-01
[rank1]:2025-11-28 17:39:54,952 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 3.1791e-01
[rank2]:2025-11-28 17:40:41,687 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.5244e+00
[rank3]:2025-11-28 17:40:41,703 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.6748e+00
[rank0]:2025-11-28 17:40:41,711 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.0309e-01
[rank1]:2025-11-28 17:40:41,703 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 6.3542e-01
[rank0]:2025-11-28 17:41:26,344 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-11-28 17:41:31,020 - INFO - Avg. fwd time: 8.1601 / Avg. bwd time: 21.0460 / Avg. batch time: 594.5255 (ms) / GPU bubble ratio: 60.70%
[rank2]:2025-11-28 17:41:31,049 - INFO - Avg. fwd time: 7.8045 / Avg. bwd time: 16.0602 / Avg. batch time: 524.7748 (ms) / GPU bubble ratio: 63.62%
[rank3]:2025-11-28 17:41:31,027 - INFO - Avg. fwd time: 13.9859 / Avg. bwd time: 40.1245 / Avg. batch time: 496.4292 (ms) / GPU bubble ratio: 12.80%
[rank1]:2025-11-28 17:41:31,070 - INFO - Avg. fwd time: 9.6517 / Avg. bwd time: 21.0040 / Avg. batch time: 560.2033 (ms) / GPU bubble ratio: 56.22%
[rank2]:2025-11-28 17:41:31,301 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.7969e-01
[rank2]:2025-11-28 17:41:31,301 - INFO -  step: 350  loss: -8.0000  grad_norm:  0.1323  memory:  6.43GiB(13.53%)  tps: 6,743  tflops: 52.71  mfu: 16.90%
[rank3]:2025-11-28 17:41:31,320 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.2745e-01
[rank0]:2025-11-28 17:41:31,312 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 1.7644e+00
[rank0]:2025-11-28 17:41:31,313 - INFO -  step: 350  loss: -8.0000  grad_norm:  0.1323  memory: 12.97GiB(27.31%)  tps: 6,743  tflops: 52.72  mfu: 16.90%
[rank1]:2025-11-28 17:41:31,300 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.5386e-01
[rank1]:2025-11-28 17:41:31,301 - INFO -  step: 350  loss: -8.0000  grad_norm:  0.1323  memory:  9.03GiB(19.01%)  tps: 6,743  tflops: 52.72  mfu: 16.90%
[rank3]:2025-11-28 17:41:31,324 - INFO -  step: 350  loss:  0.2358  grad_norm:  0.1323  memory: 16.39GiB(34.50%)  tps: 6,743  tflops: 52.71  mfu: 16.89%
[rank2]:2025-11-28 17:42:18,061 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.8998e+00
[rank3]:2025-11-28 17:42:18,076 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 3.0498e+00
[rank0]:2025-11-28 17:42:18,084 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 7.8995e-01
[rank1]:2025-11-28 17:42:18,077 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.0710e+00
[rank1]:2025-11-28 17:43:07,653 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 9.2256e-01
[rank3]:2025-11-28 17:43:07,673 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.3561e-01
[rank2]:2025-11-28 17:43:07,653 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 6.4969e-01
[rank0]:2025-11-28 17:43:07,664 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 6.2391e-01
[rank3]:2025-11-28 17:43:30,930 - INFO - Avg. fwd time: 13.9924 / Avg. bwd time: 40.0548 / Avg. batch time: 495.9194 (ms) / GPU bubble ratio: 12.81%
[rank2]:2025-11-28 17:43:30,952 - INFO - Avg. fwd time: 7.8396 / Avg. bwd time: 15.8143 / Avg. batch time: 524.0084 (ms) / GPU bubble ratio: 63.89%
[rank1]:2025-11-28 17:43:30,986 - INFO - Avg. fwd time: 9.6576 / Avg. bwd time: 20.9830 / Avg. batch time: 559.4155 (ms) / GPU bubble ratio: 56.18%
[rank0]:2025-11-28 17:43:31,017 - INFO - Avg. fwd time: 8.1763 / Avg. bwd time: 20.9322 / Avg. batch time: 593.6288 (ms) / GPU bubble ratio: 60.77%
[rank3]:2025-11-28 17:43:54,361 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 7.4166e-01
[rank2]:2025-11-28 17:43:54,346 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 7.4795e-01
[rank0]:2025-11-28 17:43:54,370 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.3641e-01
[rank1]:2025-11-28 17:43:54,362 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.8179e-01
[rank3]:2025-11-28 17:44:43,830 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.6801e-01
[rank2]:2025-11-28 17:44:43,810 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 6.9758e-01
[rank0]:2025-11-28 17:44:43,822 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 7.9833e-01
[rank1]:2025-11-28 17:44:43,810 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 6.8554e-01
[rank0]:2025-11-28 17:45:25,836 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-28 17:45:30,193 - INFO - Avg. fwd time: 14.0041 / Avg. bwd time: 40.0050 / Avg. batch time: 495.6093 (ms) / GPU bubble ratio: 12.82%
[rank2]:2025-11-28 17:45:30,255 - INFO - Avg. fwd time: 7.8655 / Avg. bwd time: 15.6317 / Avg. batch time: 523.5041 (ms) / GPU bubble ratio: 64.09%
[rank0]:2025-11-28 17:45:30,261 - INFO - Avg. fwd time: 8.1876 / Avg. bwd time: 20.8416 / Avg. batch time: 593.0000 (ms) / GPU bubble ratio: 60.84%
[rank1]:2025-11-28 17:45:30,300 - INFO - Avg. fwd time: 9.6649 / Avg. bwd time: 20.9604 / Avg. batch time: 558.8848 (ms) / GPU bubble ratio: 56.16%
[rank2]:2025-11-28 17:45:30,498 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 6.1672e-01
[rank2]:2025-11-28 17:45:30,498 - INFO -  step: 400  loss: -8.0000  grad_norm:  0.4090  memory:  6.43GiB(13.53%)  tps: 6,850  tflops: 53.55  mfu: 17.16%
[rank3]:2025-11-28 17:45:30,513 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 4.6785e-01
[rank3]:2025-11-28 17:45:30,516 - INFO -  step: 400  loss:  0.2212  grad_norm:  0.4090  memory: 16.39GiB(34.50%)  tps: 6,850  tflops: 53.55  mfu: 17.16%
[rank0]:2025-11-28 17:45:30,521 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.6044e-01
[rank0]:2025-11-28 17:45:30,522 - INFO -  step: 400  loss: -8.0000  grad_norm:  0.4090  memory: 12.97GiB(27.31%)  tps: 6,849  tflops: 53.54  mfu: 17.16%
[rank1]:2025-11-28 17:45:30,513 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 9.8333e-02
[rank1]:2025-11-28 17:45:30,514 - INFO -  step: 400  loss: -8.0000  grad_norm:  0.4090  memory:  9.03GiB(19.01%)  tps: 6,849  tflops: 53.54  mfu: 17.16%
[rank2]:2025-11-28 17:45:30,578 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p60_42_dm1/frozen_ratio_history/rank2/251128_1745_stage2_step400.svg
[rank0]:2025-11-28 17:45:30,578 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p60_42_dm1/frozen_ratio_history/rank0/251128_1745_stage0_step400.svg
[rank1]:2025-11-28 17:45:30,576 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p60_42_dm1/frozen_ratio_history/rank1/251128_1745_stage1_step400.svg
[rank3]:2025-11-28 17:45:30,661 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p60_42_dm1/pipeline_schedule/251128_1745_real_step400_rank3.svg
[rank3]:			> Batch Time: 565.72 ms, GPU Bubble Ratio: 57.80%, 52.63%, 71.91%, 28.23%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms                       | [S0,MB1,F]  9-8-17ms                      | [S0,MB2,F]  17-8-26ms                     | [S0,MB3,F]  26-7-34ms                     | [S0,MB0,B]  132-21-154ms                  | [S0,MB4,F]  154-7-162ms                   | [S0,MB1,B]  186-21-208ms                  | [S0,MB5,F]  208-7-216ms                   | [S0,MB2,B]  243-21-265ms                  | [S0,MB6,F]  265-7-273ms                   | [S0,MB3,B]  304-21-326ms                  | [S0,MB7,F]  326-7-333ms                   | [S0,MB4,B]  365-21-387ms                  | [S0,MB5,B]  425-21-447ms                  | [S0,MB6,B]  484-21-505ms                  | [S0,MB7,B]  544-21-565ms                 
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms                     | [S1,MB1,F]  23-8-32ms                     | [S1,MB2,F]  35-8-44ms                     | [S1,MB0,B]  103-24-127ms                  | [S1,MB3,F]  131-8-139ms                   | [S1,MB1,B]  157-24-181ms                  | [S1,MB4,F]  184-9-194ms                   | [S1,MB2,B]  214-24-238ms                  | [S1,MB5,F]  242-9-251ms                   | [S1,MB3,B]  274-24-299ms                  | [S1,MB6,F]  302-9-312ms                   | [S1,MB4,B]  336-24-360ms                  | [S1,MB7,F]  363-9-372ms                   | [S1,MB5,B]  397-24-421ms                  | [S1,MB6,B]  456-24-480ms                  | [S1,MB7,B]  516-24-540ms                 
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms                     | [S2,MB1,F]  32-8-41ms                     | [S2,MB0,B]  86-11-98ms                    | [S2,MB2,F]  101-8-109ms                   | [S2,MB1,B]  140-11-152ms                  | [S2,MB3,F]  155-8-164ms                   | [S2,MB2,B]  197-11-209ms                  | [S2,MB4,F]  212-8-221ms                   | [S2,MB3,B]  258-11-269ms                  | [S2,MB5,F]  273-8-281ms                   | [S2,MB4,B]  319-11-331ms                  | [S2,MB6,F]  334-8-343ms                   | [S2,MB5,B]  380-11-392ms                  | [S2,MB7,F]  395-8-404ms                   | [S2,MB6,B]  441-11-453ms                  | [S2,MB7,B]  501-11-513ms                 
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms                    | [S3,MB0,B]  48-33-82ms                    | [S3,MB1,F]  85-11-96ms                    | [S3,MB1,B]  102-34-137ms                  | [S3,MB2,F]  139-13-152ms                  | [S3,MB2,B]  158-35-194ms                  | [S3,MB3,F]  196-15-212ms                  | [S3,MB3,B]  218-36-254ms                  | [S3,MB4,F]  256-16-273ms                  | [S3,MB4,B]  278-37-315ms                  | [S3,MB5,F]  318-15-333ms                  | [S3,MB5,B]  340-37-377ms                  | [S3,MB6,F]  379-15-394ms                  | [S3,MB6,B]  400-37-438ms                  | [S3,MB7,F]  440-14-455ms                  | [S3,MB7,B]  461-37-498ms                 
[rank3]:2025-11-28 17:45:30,710 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p60_42_dm1/frozen_ratio_history/rank3/251128_1745_stage3_step400.svg
[rank3]:2025-11-28 17:45:58,780 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-11-28 17:45:58,997 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-11-28 17:45:59,015 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-11-28 17:45:59,034 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank3]:2025-11-28 17:46:20,095 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 3.5896e-01
[rank2]:2025-11-28 17:46:20,075 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 7.4739e-01
[rank1]:2025-11-28 17:46:20,075 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 7.2902e-01
[rank0]:2025-11-28 17:46:20,087 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 4.6776e-01
[rank3]:2025-11-28 17:47:06,713 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 4.3351e-01
[rank2]:2025-11-28 17:47:06,698 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 5.4474e-01
[rank0]:2025-11-28 17:47:06,721 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.3470e-01
[rank1]:2025-11-28 17:47:06,713 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 2.2341e-01
[rank0]:2025-11-28 17:47:31,191 - INFO - Avg. fwd time: 8.2030 / Avg. bwd time: 20.7219 / Avg. batch time: 592.5626 (ms) / GPU bubble ratio: 60.95%
[rank2]:2025-11-28 17:47:31,222 - INFO - Avg. fwd time: 7.8906 / Avg. bwd time: 15.4561 / Avg. batch time: 523.2642 (ms) / GPU bubble ratio: 64.31%
[rank3]:2025-11-28 17:47:31,199 - INFO - Avg. fwd time: 14.0123 / Avg. bwd time: 39.9870 / Avg. batch time: 495.5275 (ms) / GPU bubble ratio: 12.82%
[rank1]:2025-11-28 17:47:31,243 - INFO - Avg. fwd time: 9.6767 / Avg. bwd time: 20.8970 / Avg. batch time: 558.5782 (ms) / GPU bubble ratio: 56.21%
[rank2]:2025-11-28 17:47:55,984 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 8.0446e-01
[rank3]:2025-11-28 17:47:56,004 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.9790e-01
[rank0]:2025-11-28 17:47:55,996 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 7.3925e-01
[rank1]:2025-11-28 17:47:55,984 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.1557e+00
[rank2]:2025-11-28 17:48:42,637 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.3414e+00
[rank1]:2025-11-28 17:48:42,653 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 7.9998e-01
[rank0]:2025-11-28 17:48:42,660 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 5.7300e-01
[rank3]:2025-11-28 17:48:42,652 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.6209e+00
[rank0]:2025-11-28 17:49:27,129 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-11-28 17:49:32,019 - INFO - Avg. fwd time: 9.6910 / Avg. bwd time: 20.7967 / Avg. batch time: 558.4613 (ms) / GPU bubble ratio: 56.33%
[rank3]:2025-11-28 17:49:31,969 - INFO - Avg. fwd time: 14.0115 / Avg. bwd time: 40.0053 / Avg. batch time: 495.6645 (ms) / GPU bubble ratio: 12.82%
[rank2]:2025-11-28 17:49:31,994 - INFO - Avg. fwd time: 7.9101 / Avg. bwd time: 15.3157 / Avg. batch time: 523.2494 (ms) / GPU bubble ratio: 64.49%
[rank0]:2025-11-28 17:49:32,045 - INFO - Avg. fwd time: 8.2198 / Avg. bwd time: 20.5865 / Avg. batch time: 592.3017 (ms) / GPU bubble ratio: 61.09%
[rank1]:2025-11-28 17:49:32,060 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 3.7219e+00
[rank1]:2025-11-28 17:49:32,060 - INFO -  step: 450  loss: -8.0000  grad_norm:  0.1218  memory:  9.03GiB(19.01%)  tps: 6,783  tflops: 53.03  mfu: 17.00%
[rank3]:2025-11-28 17:49:32,079 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 6.6590e-01
[rank3]:2025-11-28 17:49:32,082 - INFO -  step: 450  loss:  0.2357  grad_norm:  0.1218  memory: 16.39GiB(34.50%)  tps: 6,782  tflops: 53.02  mfu: 16.99%
[rank2]:2025-11-28 17:49:32,059 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.8211e+00
[rank2]:2025-11-28 17:49:32,060 - INFO -  step: 450  loss: -8.0000  grad_norm:  0.1218  memory:  6.43GiB(13.53%)  tps: 6,783  tflops: 53.02  mfu: 16.99%
[rank0]:2025-11-28 17:49:32,071 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 5.8549e+00
[rank0]:2025-11-28 17:49:32,072 - INFO -  step: 450  loss: -8.0000  grad_norm:  0.1218  memory: 12.97GiB(27.31%)  tps: 6,783  tflops: 53.03  mfu: 17.00%
[rank1]:2025-11-28 17:50:18,659 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.7900e-01
[rank2]:2025-11-28 17:50:18,643 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 3.4954e-01
[rank3]:2025-11-28 17:50:18,658 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 4.0475e-01
[rank0]:2025-11-28 17:50:18,666 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.1066e-01
[rank3]:2025-11-28 17:51:08,043 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 6.6004e-01
[rank1]:2025-11-28 17:51:08,023 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.3790e+00
[rank2]:2025-11-28 17:51:08,023 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.0551e+00
[rank0]:2025-11-28 17:51:08,035 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 1.1246e+00
[rank3]:2025-11-28 17:51:31,012 - INFO - Avg. fwd time: 14.0154 / Avg. bwd time: 39.9662 / Avg. batch time: 495.3791 (ms) / GPU bubble ratio: 12.82%
[rank2]:2025-11-28 17:51:31,074 - INFO - Avg. fwd time: 7.9286 / Avg. bwd time: 15.1851 / Avg. batch time: 522.8232 (ms) / GPU bubble ratio: 64.63%
[rank0]:2025-11-28 17:51:31,080 - INFO - Avg. fwd time: 8.2271 / Avg. bwd time: 20.5260 / Avg. batch time: 591.7935 (ms) / GPU bubble ratio: 61.13%
[rank1]:2025-11-28 17:51:31,123 - INFO - Avg. fwd time: 9.6942 / Avg. bwd time: 20.7851 / Avg. batch time: 558.0201 (ms) / GPU bubble ratio: 56.30%
[rank2]:2025-11-28 17:51:54,612 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.2895e+00
[rank1]:2025-11-28 17:51:54,628 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 5.9570e-01
[rank0]:2025-11-28 17:51:54,636 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.7823e-01
[rank3]:2025-11-28 17:51:54,627 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.1349e+00
[rank2]:2025-11-28 17:52:44,001 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.0075e+00
[rank3]:2025-11-28 17:52:44,020 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 6.7791e-01
[rank1]:2025-11-28 17:52:44,002 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.7725e+00
[rank0]:2025-11-28 17:52:44,012 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 2.4452e+00
[rank0]:2025-11-28 17:53:25,939 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-28 17:53:30,281 - INFO - Avg. fwd time: 14.0235 / Avg. bwd time: 39.9027 / Avg. batch time: 494.9326 (ms) / GPU bubble ratio: 12.83%
[rank0]:2025-11-28 17:53:30,347 - INFO - Avg. fwd time: 8.2323 / Avg. bwd time: 20.4803 / Avg. batch time: 591.1475 (ms) / GPU bubble ratio: 61.14%
[rank2]:2025-11-28 17:53:30,343 - INFO - Avg. fwd time: 7.9492 / Avg. bwd time: 15.0391 / Avg. batch time: 522.2201 (ms) / GPU bubble ratio: 64.78%
[rank1]:2025-11-28 17:53:30,393 - INFO - Avg. fwd time: 9.6952 / Avg. bwd time: 20.8005 / Avg. batch time: 557.4281 (ms) / GPU bubble ratio: 56.23%
[rank3]:2025-11-28 17:53:30,599 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 4.9429e+00
[rank3]:2025-11-28 17:53:30,602 - INFO -  step: 500  loss:  0.2306  grad_norm:  0.4621  memory: 16.39GiB(34.50%)  tps: 6,869  tflops: 53.70  mfu: 17.21%
[rank0]:2025-11-28 17:53:30,607 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 7.6248e-01
[rank0]:2025-11-28 17:53:30,607 - INFO -  step: 500  loss: -8.0000  grad_norm:  0.4621  memory: 12.97GiB(27.31%)  tps: 6,869  tflops: 53.70  mfu: 17.21%
[rank1]:2025-11-28 17:53:30,599 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.9014e+00
[rank1]:2025-11-28 17:53:30,600 - INFO -  step: 500  loss: -8.0000  grad_norm:  0.4621  memory:  9.03GiB(19.01%)  tps: 6,868  tflops: 53.69  mfu: 17.21%
[rank2]:2025-11-28 17:53:30,583 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 5.1707e+00
[rank2]:2025-11-28 17:53:30,584 - INFO -  step: 500  loss: -8.0000  grad_norm:  0.4621  memory:  6.43GiB(13.53%)  tps: 6,869  tflops: 53.70  mfu: 17.21%
[rank2]:2025-11-28 17:53:30,661 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p60_42_dm1/frozen_ratio_history/rank2/251128_1753_stage2_step500.svg
[rank3]:2025-11-28 17:53:30,746 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p60_42_dm1/pipeline_schedule/251128_1753_real_step500_rank3.svg
[rank3]:			> Batch Time: 565.19 ms, GPU Bubble Ratio: 57.74%, 52.65%, 71.85%, 28.12%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms                       | [S0,MB1,F]  9-8-17ms                      | [S0,MB2,F]  17-8-26ms                     | [S0,MB3,F]  26-7-34ms                     | [S0,MB0,B]  132-21-154ms                  | [S0,MB4,F]  154-7-162ms                   | [S0,MB1,B]  187-21-209ms                  | [S0,MB5,F]  209-7-216ms                   | [S0,MB2,B]  244-21-265ms                  | [S0,MB6,F]  266-7-273ms                   | [S0,MB3,B]  304-21-326ms                  | [S0,MB7,F]  326-7-333ms                   | [S0,MB4,B]  365-21-387ms                  | [S0,MB5,B]  424-21-445ms                  | [S0,MB6,B]  484-21-505ms                  | [S0,MB7,B]  543-21-565ms                 
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms                     | [S1,MB1,F]  23-8-32ms                     | [S1,MB2,F]  35-8-44ms                     | [S1,MB0,B]  103-24-127ms                  | [S1,MB3,F]  131-8-140ms                   | [S1,MB1,B]  158-24-182ms                  | [S1,MB4,F]  185-9-194ms                   | [S1,MB2,B]  214-24-239ms                  | [S1,MB5,F]  242-9-251ms                   | [S1,MB3,B]  275-24-299ms                  | [S1,MB6,F]  302-9-312ms                   | [S1,MB4,B]  336-24-360ms                  | [S1,MB7,F]  363-9-372ms                   | [S1,MB5,B]  396-24-420ms                  | [S1,MB6,B]  456-24-480ms                  | [S1,MB7,B]  516-24-540ms                 
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms                     | [S2,MB1,F]  32-8-41ms                     | [S2,MB0,B]  86-11-98ms                    | [S2,MB2,F]  101-8-110ms                   | [S2,MB1,B]  141-11-153ms                  | [S2,MB3,F]  156-8-164ms                   | [S2,MB2,B]  198-11-209ms                  | [S2,MB4,F]  213-8-221ms                   | [S2,MB3,B]  258-11-270ms                  | [S2,MB5,F]  273-8-282ms                   | [S2,MB4,B]  319-11-330ms                  | [S2,MB6,F]  334-8-342ms                   | [S2,MB5,B]  380-11-391ms                  | [S2,MB7,F]  395-8-403ms                   | [S2,MB6,B]  441-11-453ms                  | [S2,MB7,B]  501-11-512ms                 
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-43ms                    | [S3,MB0,B]  49-34-83ms                    | [S3,MB1,F]  85-11-97ms                    | [S3,MB1,B]  102-35-138ms                  | [S3,MB2,F]  140-13-153ms                  | [S3,MB2,B]  159-35-194ms                  | [S3,MB3,F]  196-15-211ms                  | [S3,MB3,B]  218-36-254ms                  | [S3,MB4,F]  257-15-272ms                  | [S3,MB4,B]  278-37-316ms                  | [S3,MB5,F]  318-15-333ms                  | [S3,MB5,B]  339-37-377ms                  | [S3,MB6,F]  378-14-393ms                  | [S3,MB6,B]  400-37-438ms                  | [S3,MB7,F]  440-14-454ms                  | [S3,MB7,B]  460-37-498ms                 
[rank0]:2025-11-28 17:53:30,661 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p60_42_dm1/frozen_ratio_history/rank0/251128_1753_stage0_step500.svg
[rank1]:2025-11-28 17:53:30,674 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p60_42_dm1/frozen_ratio_history/rank1/251128_1753_stage1_step500.svg
[rank3]:2025-11-28 17:53:30,790 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p60_42_dm1/frozen_ratio_history/rank3/251128_1753_stage3_step500.svg
[rank3]:2025-11-28 17:54:20,191 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 7.7869e-02
[rank0]:2025-11-28 17:54:20,184 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 1.5490e+00
[rank1]:2025-11-28 17:54:20,172 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 4.5978e-01
[rank2]:2025-11-28 17:54:20,172 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.8766e-01
[rank2]:2025-11-28 17:55:06,775 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.1118e+00
[rank3]:2025-11-28 17:55:06,791 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.2970e+00
[rank0]:2025-11-28 17:55:06,799 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 5.0309e-01
[rank1]:2025-11-28 17:55:06,791 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.0974e+00
[rank3]:2025-11-28 17:55:31,296 - INFO - Avg. fwd time: 14.0246 / Avg. bwd time: 39.9063 / Avg. batch time: 494.9680 (ms) / GPU bubble ratio: 12.83%
[rank0]:2025-11-28 17:55:31,379 - INFO - Avg. fwd time: 8.2434 / Avg. bwd time: 20.3888 / Avg. batch time: 590.9301 (ms) / GPU bubble ratio: 61.24%
[rank1]:2025-11-28 17:55:31,352 - INFO - Avg. fwd time: 9.7048 / Avg. bwd time: 20.7381 / Avg. batch time: 557.3078 (ms) / GPU bubble ratio: 56.30%
[rank2]:2025-11-28 17:55:31,321 - INFO - Avg. fwd time: 7.9641 / Avg. bwd time: 14.9329 / Avg. batch time: 522.1634 (ms) / GPU bubble ratio: 64.92%
[rank0]:2025-11-28 17:55:56,134 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 3.5010e+00
[rank1]:2025-11-28 17:55:56,124 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 3.8504e+00
[rank2]:2025-11-28 17:55:56,123 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.5905e+00
[rank3]:2025-11-28 17:55:56,143 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 6.2612e-01
[rank2]:2025-11-28 17:56:42,694 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.3281e+00
[rank0]:2025-11-28 17:56:42,717 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.8844e-01
[rank1]:2025-11-28 17:56:42,711 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 3.9440e-01
[rank3]:2025-11-28 17:56:42,709 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.3370e+00
[rank0]:2025-11-28 17:57:27,140 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-28 17:57:31,830 - INFO - Avg. fwd time: 14.0294 / Avg. bwd time: 39.9047 / Avg. batch time: 494.9916 (ms) / GPU bubble ratio: 12.83%
[rank0]:2025-11-28 17:57:31,824 - INFO - Avg. fwd time: 8.2519 / Avg. bwd time: 20.3207 / Avg. batch time: 590.7409 (ms) / GPU bubble ratio: 61.31%
[rank2]:2025-11-28 17:57:31,854 - INFO - Avg. fwd time: 7.9761 / Avg. bwd time: 14.8482 / Avg. batch time: 522.0938 (ms) / GPU bubble ratio: 65.03%
[rank1]:2025-11-28 17:57:31,869 - INFO - Avg. fwd time: 9.7125 / Avg. bwd time: 20.6946 / Avg. batch time: 557.1927 (ms) / GPU bubble ratio: 56.34%
[rank1]:2025-11-28 17:57:32,099 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 4.3148e-01
[rank1]:2025-11-28 17:57:32,100 - INFO -  step: 550  loss: -8.0000  grad_norm:  0.1022  memory:  9.03GiB(19.01%)  tps: 6,784  tflops: 53.04  mfu: 17.00%
[rank3]:2025-11-28 17:57:32,119 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.0673e-01
[rank3]:2025-11-28 17:57:32,122 - INFO -  step: 550  loss:  0.2365  grad_norm:  0.1022  memory: 16.39GiB(34.50%)  tps: 6,784  tflops: 53.03  mfu: 17.00%
[rank0]:2025-11-28 17:57:32,111 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 7.7570e-01
[rank0]:2025-11-28 17:57:32,111 - INFO -  step: 550  loss: -8.0000  grad_norm:  0.1022  memory: 12.97GiB(27.31%)  tps: 6,784  tflops: 53.04  mfu: 17.00%
[rank2]:2025-11-28 17:57:32,099 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 6.1320e-01
[rank2]:2025-11-28 17:57:32,099 - INFO -  step: 550  loss: -8.0000  grad_norm:  0.1022  memory:  6.43GiB(13.53%)  tps: 6,784  tflops: 53.03  mfu: 17.00%
[rank3]:2025-11-28 17:58:18,751 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.7358e+00
[rank1]:2025-11-28 17:58:18,751 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 4.5906e-01
[rank0]:2025-11-28 17:58:18,759 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 4.2608e-01
[rank2]:2025-11-28 17:58:18,736 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.2132e+00
[rank1]:2025-11-28 17:59:08,116 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.2766e-01
[rank3]:2025-11-28 17:59:08,135 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.3111e-01
[rank2]:2025-11-28 17:59:08,115 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 8.1255e-01
[rank0]:2025-11-28 17:59:08,127 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 3.9394e-01
[rank3]:2025-11-28 17:59:31,088 - INFO - Avg. fwd time: 14.0349 / Avg. bwd time: 39.8798 / Avg. batch time: 494.8340 (ms) / GPU bubble ratio: 12.84%
[rank1]:2025-11-28 17:59:31,193 - INFO - Avg. fwd time: 9.7167 / Avg. bwd time: 20.6767 / Avg. batch time: 556.9064 (ms) / GPU bubble ratio: 56.34%
[rank2]:2025-11-28 17:59:31,151 - INFO - Avg. fwd time: 7.9902 / Avg. bwd time: 14.7480 / Avg. batch time: 521.8277 (ms) / GPU bubble ratio: 65.14%
[rank0]:2025-11-28 17:59:31,157 - INFO - Avg. fwd time: 8.2582 / Avg. bwd time: 20.2670 / Avg. batch time: 590.3944 (ms) / GPU bubble ratio: 61.35%
[rank1]:2025-11-28 17:59:54,677 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 3.8941e-01
[rank3]:2025-11-28 17:59:54,677 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.3831e+00
[rank2]:2025-11-28 17:59:54,661 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.2028e+00
[rank0]:2025-11-28 17:59:54,685 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 4.5513e-01
[rank1]:2025-11-28 18:00:44,059 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.1157e+00
[rank3]:2025-11-28 18:00:44,079 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.8191e-01
[rank0]:2025-11-28 18:00:44,071 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 3.2793e+00
[rank2]:2025-11-28 18:00:44,059 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 6.6082e-01
[rank0]:2025-11-28 18:01:26,014 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-28 18:01:30,611 - INFO - Avg. fwd time: 14.0406 / Avg. bwd time: 39.8329 / Avg. batch time: 494.5015 (ms) / GPU bubble ratio: 12.84%
[rank2]:2025-11-28 18:01:30,634 - INFO - Avg. fwd time: 8.0050 / Avg. bwd time: 14.6454 / Avg. batch time: 521.3865 (ms) / GPU bubble ratio: 65.25%
[rank1]:2025-11-28 18:01:30,670 - INFO - Avg. fwd time: 9.7171 / Avg. bwd time: 20.6938 / Avg. batch time: 556.4814 (ms) / GPU bubble ratio: 56.28%
[rank1]:2025-11-28 18:01:30,730 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 2.8332e-01
[rank1]:2025-11-28 18:01:30,730 - INFO -  step: 600  loss: -8.0000  grad_norm:  0.7181  memory:  9.03GiB(19.01%)  tps: 6,866  tflops: 53.67  mfu: 17.20%
[rank3]:2025-11-28 18:01:30,729 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.3113e+00
[rank3]:2025-11-28 18:01:30,733 - INFO -  step: 600  loss:  0.2311  grad_norm:  0.7181  memory: 16.39GiB(34.50%)  tps: 6,866  tflops: 53.68  mfu: 17.20%
[rank2]:2025-11-28 18:01:30,714 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.5106e+00
[rank2]:2025-11-28 18:01:30,714 - INFO -  step: 600  loss: -8.0000  grad_norm:  0.7181  memory:  6.43GiB(13.53%)  tps: 6,866  tflops: 53.68  mfu: 17.20%
[rank0]:2025-11-28 18:01:30,702 - INFO - Avg. fwd time: 8.2612 / Avg. bwd time: 20.2403 / Avg. batch time: 589.9377 (ms) / GPU bubble ratio: 61.35%
[rank0]:2025-11-28 18:01:30,738 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.3014e-01
[rank0]:2025-11-28 18:01:30,738 - INFO -  step: 600  loss: -8.0000  grad_norm:  0.7181  memory: 12.97GiB(27.31%)  tps: 6,866  tflops: 53.67  mfu: 17.20%
[rank1]:2025-11-28 18:01:30,792 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p60_42_dm1/frozen_ratio_history/rank1/251128_1801_stage1_step600.svg
[rank2]:2025-11-28 18:01:30,792 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p60_42_dm1/frozen_ratio_history/rank2/251128_1801_stage2_step600.svg
[rank0]:2025-11-28 18:01:30,791 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p60_42_dm1/frozen_ratio_history/rank0/251128_1801_stage0_step600.svg
[rank3]:2025-11-28 18:01:30,878 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p60_42_dm1/pipeline_schedule/251128_1801_real_step600_rank3.svg
[rank3]:			> Batch Time: 566.69 ms, GPU Bubble Ratio: 57.93%, 52.69%, 71.96%, 28.17%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms                       | [S0,MB1,F]  9-8-17ms                      | [S0,MB2,F]  17-8-26ms                     | [S0,MB3,F]  26-7-34ms                     | [S0,MB0,B]  132-21-154ms                  | [S0,MB4,F]  154-7-161ms                   | [S0,MB1,B]  186-21-208ms                  | [S0,MB5,F]  208-7-215ms                   | [S0,MB2,B]  244-21-266ms                  | [S0,MB6,F]  266-7-273ms                   | [S0,MB3,B]  304-21-326ms                  | [S0,MB7,F]  326-7-334ms                   | [S0,MB4,B]  366-21-388ms                  | [S0,MB5,B]  425-21-447ms                  | [S0,MB6,B]  484-21-506ms                  | [S0,MB7,B]  545-21-566ms                 
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms                     | [S1,MB1,F]  23-8-32ms                     | [S1,MB2,F]  35-8-44ms                     | [S1,MB0,B]  103-24-127ms                  | [S1,MB3,F]  130-8-139ms                   | [S1,MB1,B]  157-24-181ms                  | [S1,MB4,F]  184-9-193ms                   | [S1,MB2,B]  214-24-239ms                  | [S1,MB5,F]  242-9-252ms                   | [S1,MB3,B]  275-24-299ms                  | [S1,MB6,F]  303-9-312ms                   | [S1,MB4,B]  336-24-360ms                  | [S1,MB7,F]  364-9-373ms                   | [S1,MB5,B]  398-24-422ms                  | [S1,MB6,B]  457-24-481ms                  | [S1,MB7,B]  517-24-541ms                 
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms                     | [S2,MB1,F]  32-8-40ms                     | [S2,MB0,B]  86-11-98ms                    | [S2,MB2,F]  101-8-109ms                   | [S2,MB1,B]  140-11-152ms                  | [S2,MB3,F]  155-8-164ms                   | [S2,MB2,B]  198-11-209ms                  | [S2,MB4,F]  213-8-221ms                   | [S2,MB3,B]  258-11-270ms                  | [S2,MB5,F]  273-8-282ms                   | [S2,MB4,B]  320-11-331ms                  | [S2,MB6,F]  335-8-343ms                   | [S2,MB5,B]  381-11-393ms                  | [S2,MB7,F]  396-8-404ms                   | [S2,MB6,B]  442-11-454ms                  | [S2,MB7,B]  502-11-514ms                 
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms                    | [S3,MB0,B]  48-34-82ms                    | [S3,MB1,F]  85-11-96ms                    | [S3,MB1,B]  102-34-137ms                  | [S3,MB2,F]  139-13-152ms                  | [S3,MB2,B]  159-35-194ms                  | [S3,MB3,F]  196-15-212ms                  | [S3,MB3,B]  218-36-254ms                  | [S3,MB4,F]  257-16-273ms                  | [S3,MB4,B]  279-37-316ms                  | [S3,MB5,F]  318-15-334ms                  | [S3,MB5,B]  340-37-377ms                  | [S3,MB6,F]  380-15-395ms                  | [S3,MB6,B]  401-37-438ms                  | [S3,MB7,F]  441-14-456ms                  | [S3,MB7,B]  462-37-499ms                 
[rank3]:2025-11-28 18:01:30,926 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p60_42_dm1/frozen_ratio_history/rank3/251128_1801_stage3_step600.svg
[rank1]:2025-11-28 18:02:20,308 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 8.1263e-01
[rank2]:2025-11-28 18:02:20,308 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 6.2240e-01
[rank0]:2025-11-28 18:02:20,320 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 3.1092e-01
[rank3]:2025-11-28 18:02:20,328 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.4046e-01
[rank2]:2025-11-28 18:03:06,881 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.8812e+00
[rank1]:2025-11-28 18:03:06,897 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 9.3049e-01
[rank3]:2025-11-28 18:03:06,897 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 3.2659e+00
[rank0]:2025-11-28 18:03:06,905 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 5.2360e-01
[rank1]:2025-11-28 18:03:31,482 - INFO - Avg. fwd time: 9.7231 / Avg. bwd time: 20.6573 / Avg. batch time: 556.4373 (ms) / GPU bubble ratio: 56.32%
[rank3]:2025-11-28 18:03:31,438 - INFO - Avg. fwd time: 14.0437 / Avg. bwd time: 39.8355 / Avg. batch time: 494.5450 (ms) / GPU bubble ratio: 12.84%
[rank0]:2025-11-28 18:03:31,431 - INFO - Avg. fwd time: 8.2675 / Avg. bwd time: 20.1857 / Avg. batch time: 589.8347 (ms) / GPU bubble ratio: 61.41%
[rank2]:2025-11-28 18:03:31,460 - INFO - Avg. fwd time: 8.0139 / Avg. bwd time: 14.5812 / Avg. batch time: 521.3803 (ms) / GPU bubble ratio: 65.33%
[rank1]:2025-11-28 18:03:56,430 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.9236e+00
[rank3]:2025-11-28 18:03:56,449 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 3.6485e-01
[rank0]:2025-11-28 18:03:56,441 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 1.7223e+00
[rank2]:2025-11-28 18:03:56,430 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.8222e+00
[rank2]:2025-11-28 18:04:43,014 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.0376e+00
[rank1]:2025-11-28 18:04:43,030 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 2.5806e-01
[rank3]:2025-11-28 18:04:43,030 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.7035e+00
[rank0]:2025-11-28 18:04:43,037 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.6701e-01
[rank0]:2025-11-28 18:05:27,573 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-11-28 18:05:32,255 - INFO - Avg. fwd time: 9.7314 / Avg. bwd time: 20.5971 / Avg. batch time: 556.4979 (ms) / GPU bubble ratio: 56.40%
[rank3]:2025-11-28 18:05:32,210 - INFO - Avg. fwd time: 14.0427 / Avg. bwd time: 39.8606 / Avg. batch time: 494.7360 (ms) / GPU bubble ratio: 12.84%
[rank2]:2025-11-28 18:05:32,232 - INFO - Avg. fwd time: 8.0231 / Avg. bwd time: 14.5188 / Avg. batch time: 521.5020 (ms) / GPU bubble ratio: 65.42%
[rank0]:2025-11-28 18:05:32,201 - INFO - Avg. fwd time: 8.2765 / Avg. bwd time: 20.1135 / Avg. batch time: 589.8171 (ms) / GPU bubble ratio: 61.49%
[rank2]:2025-11-28 18:05:32,475 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.2482e+00
[rank2]:2025-11-28 18:05:32,476 - INFO -  step: 650  loss: -8.0000  grad_norm:  0.0881  memory:  6.43GiB(13.53%)  tps: 6,777  tflops: 52.98  mfu: 16.98%
[rank0]:2025-11-28 18:05:32,487 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 1.0492e+00
[rank0]:2025-11-28 18:05:32,487 - INFO -  step: 650  loss: -8.0000  grad_norm:  0.0881  memory: 12.97GiB(27.31%)  tps: 6,777  tflops: 52.98  mfu: 16.98%
[rank1]:2025-11-28 18:05:32,475 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.2242e+00
[rank1]:2025-11-28 18:05:32,476 - INFO -  step: 650  loss: -8.0000  grad_norm:  0.0881  memory:  9.03GiB(19.01%)  tps: 6,777  tflops: 52.98  mfu: 16.98%
[rank3]:2025-11-28 18:05:32,495 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 3.7567e-01
[rank3]:2025-11-28 18:05:32,499 - INFO -  step: 650  loss:  0.2403  grad_norm:  0.0881  memory: 16.39GiB(34.50%)  tps: 6,777  tflops: 52.98  mfu: 16.98%
[rank1]:2025-11-28 18:06:19,129 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 4.7773e-01
[rank3]:2025-11-28 18:06:19,129 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.3547e+00
[rank0]:2025-11-28 18:06:19,137 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.9760e-01
[rank2]:2025-11-28 18:06:19,114 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 9.2144e-01
[rank1]:2025-11-28 18:07:08,540 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 9.7520e-01
[rank3]:2025-11-28 18:07:08,559 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 5.5723e-02
[rank0]:2025-11-28 18:07:08,551 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 1.1724e+00
[rank2]:2025-11-28 18:07:08,540 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.9807e-01
[rank3]:2025-11-28 18:07:31,795 - INFO - Avg. fwd time: 14.0471 / Avg. bwd time: 39.8317 / Avg. batch time: 494.5388 (ms) / GPU bubble ratio: 12.84%
[rank2]:2025-11-28 18:07:31,819 - INFO - Avg. fwd time: 8.0341 / Avg. bwd time: 14.4416 / Avg. batch time: 521.2222 (ms) / GPU bubble ratio: 65.50%
[rank1]:2025-11-28 18:07:31,855 - INFO - Avg. fwd time: 9.7323 / Avg. bwd time: 20.6005 / Avg. batch time: 556.2211 (ms) / GPU bubble ratio: 56.37%
[rank0]:2025-11-28 18:07:31,889 - INFO - Avg. fwd time: 8.2795 / Avg. bwd time: 20.0860 / Avg. batch time: 589.5108 (ms) / GPU bubble ratio: 61.51%
[rank1]:2025-11-28 18:07:55,232 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 9.7962e-01
[rank3]:2025-11-28 18:07:55,232 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.9435e+00
[rank0]:2025-11-28 18:07:55,239 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 4.3677e-01
[rank2]:2025-11-28 18:07:55,216 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.8004e+00
[rank1]:2025-11-28 18:08:44,689 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.7320e+00
[rank3]:2025-11-28 18:08:44,708 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 4.8414e-01
[rank2]:2025-11-28 18:08:44,689 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.7081e+00
[rank0]:2025-11-28 18:08:44,700 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 2.3021e+00
[rank0]:2025-11-28 18:09:26,582 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-28 18:09:30,922 - INFO - Avg. fwd time: 14.0507 / Avg. bwd time: 39.8129 / Avg. batch time: 494.4157 (ms) / GPU bubble ratio: 12.84%
[rank2]:2025-11-28 18:09:30,983 - INFO - Avg. fwd time: 8.0428 / Avg. bwd time: 14.3813 / Avg. batch time: 521.0334 (ms) / GPU bubble ratio: 65.57%
[rank0]:2025-11-28 18:09:30,989 - INFO - Avg. fwd time: 8.2822 / Avg. bwd time: 20.0614 / Avg. batch time: 589.2904 (ms) / GPU bubble ratio: 61.52%
[rank1]:2025-11-28 18:09:31,032 - INFO - Avg. fwd time: 9.7341 / Avg. bwd time: 20.5993 / Avg. batch time: 556.0296 (ms) / GPU bubble ratio: 56.36%
[rank1]:2025-11-28 18:09:31,238 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.0415e+00
[rank1]:2025-11-28 18:09:31,239 - INFO -  step: 700  loss: -8.0000  grad_norm:  0.3011  memory:  9.03GiB(19.01%)  tps: 6,862  tflops: 53.64  mfu: 17.19%
[rank3]:2025-11-28 18:09:31,238 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.2664e+00
[rank3]:2025-11-28 18:09:31,241 - INFO -  step: 700  loss:  0.2011  grad_norm:  0.3011  memory: 16.39GiB(34.50%)  tps: 6,863  tflops: 53.65  mfu: 17.20%
[rank2]:2025-11-28 18:09:31,222 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.1032e+00
[rank2]:2025-11-28 18:09:31,223 - INFO -  step: 700  loss: -8.0000  grad_norm:  0.3011  memory:  6.43GiB(13.53%)  tps: 6,863  tflops: 53.65  mfu: 17.19%
[rank0]:2025-11-28 18:09:31,246 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 7.2446e-01
[rank0]:2025-11-28 18:09:31,246 - INFO -  step: 700  loss: -8.0000  grad_norm:  0.3011  memory: 12.97GiB(27.31%)  tps: 6,862  tflops: 53.65  mfu: 17.19%
[rank0]:2025-11-28 18:09:31,302 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p60_42_dm1/frozen_ratio_history/rank0/251128_1809_stage0_step700.svg
[rank1]:2025-11-28 18:09:31,309 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p60_42_dm1/frozen_ratio_history/rank1/251128_1809_stage1_step700.svg
[rank3]:2025-11-28 18:09:31,386 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p60_42_dm1/pipeline_schedule/251128_1809_real_step700_rank3.svg
[rank3]:			> Batch Time: 566.19 ms, GPU Bubble Ratio: 57.90%, 52.68%, 71.91%, 28.23%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms                       | [S0,MB1,F]  9-8-17ms                      | [S0,MB2,F]  17-8-26ms                     | [S0,MB3,F]  26-7-33ms                     | [S0,MB0,B]  132-21-154ms                  | [S0,MB4,F]  154-7-162ms                   | [S0,MB1,B]  187-21-208ms                  | [S0,MB5,F]  208-7-216ms                   | [S0,MB2,B]  244-21-265ms                  | [S0,MB6,F]  265-7-273ms                   | [S0,MB3,B]  304-21-326ms                  | [S0,MB7,F]  326-7-334ms                   | [S0,MB4,B]  365-21-387ms                  | [S0,MB5,B]  425-21-446ms                  | [S0,MB6,B]  484-21-506ms                  | [S0,MB7,B]  544-21-566ms                 
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms                     | [S1,MB1,F]  23-8-32ms                     | [S1,MB2,F]  35-8-44ms                     | [S1,MB0,B]  103-24-127ms                  | [S1,MB3,F]  131-8-139ms                   | [S1,MB1,B]  157-24-181ms                  | [S1,MB4,F]  185-9-194ms                   | [S1,MB2,B]  214-24-238ms                  | [S1,MB5,F]  242-9-251ms                   | [S1,MB3,B]  275-24-299ms                  | [S1,MB6,F]  303-9-312ms                   | [S1,MB4,B]  336-24-360ms                  | [S1,MB7,F]  364-9-373ms                   | [S1,MB5,B]  397-24-421ms                  | [S1,MB6,B]  457-24-481ms                  | [S1,MB7,B]  517-24-541ms                 
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms                     | [S2,MB1,F]  32-8-41ms                     | [S2,MB0,B]  86-11-98ms                    | [S2,MB2,F]  101-8-110ms                   | [S2,MB1,B]  141-11-152ms                  | [S2,MB3,F]  156-8-164ms                   | [S2,MB2,B]  198-11-209ms                  | [S2,MB4,F]  213-8-221ms                   | [S2,MB3,B]  258-11-270ms                  | [S2,MB5,F]  273-8-282ms                   | [S2,MB4,B]  319-11-331ms                  | [S2,MB6,F]  334-8-343ms                   | [S2,MB5,B]  381-11-392ms                  | [S2,MB7,F]  396-8-404ms                   | [S2,MB6,B]  442-11-454ms                  | [S2,MB7,B]  502-11-514ms                 
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-43ms                    | [S3,MB0,B]  48-34-83ms                    | [S3,MB1,F]  85-11-96ms                    | [S3,MB1,B]  102-35-137ms                  | [S3,MB2,F]  139-13-153ms                  | [S3,MB2,B]  158-35-194ms                  | [S3,MB3,F]  196-15-212ms                  | [S3,MB3,B]  218-36-255ms                  | [S3,MB4,F]  257-15-273ms                  | [S3,MB4,B]  279-37-316ms                  | [S3,MB5,F]  318-15-333ms                  | [S3,MB5,B]  340-37-377ms                  | [S3,MB6,F]  379-14-394ms                  | [S3,MB6,B]  401-37-438ms                  | [S3,MB7,F]  441-14-455ms                  | [S3,MB7,B]  461-37-499ms                 
[rank2]:2025-11-28 18:09:31,301 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p60_42_dm1/frozen_ratio_history/rank2/251128_1809_stage2_step700.svg
[rank3]:2025-11-28 18:09:31,435 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p60_42_dm1/frozen_ratio_history/rank3/251128_1809_stage3_step700.svg
[rank2]:2025-11-28 18:10:20,863 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.6227e+00
[rank1]:2025-11-28 18:10:20,863 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 3.1807e+00
[rank3]:2025-11-28 18:10:20,883 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 8.7810e-01
[rank0]:2025-11-28 18:10:20,875 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 1.9222e+00
[rank1]:2025-11-28 18:11:07,545 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 9.7473e-01
[rank3]:2025-11-28 18:11:07,545 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.4686e+00
[rank2]:2025-11-28 18:11:07,529 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.0803e+00
[rank0]:2025-11-28 18:11:07,553 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 4.5816e-01
[rank3]:2025-11-28 18:11:31,927 - INFO - Avg. fwd time: 14.0526 / Avg. bwd time: 39.8098 / Avg. batch time: 494.4044 (ms) / GPU bubble ratio: 12.84%
[rank2]:2025-11-28 18:11:31,952 - INFO - Avg. fwd time: 8.0509 / Avg. bwd time: 14.3236 / Avg. batch time: 520.9749 (ms) / GPU bubble ratio: 65.64%
[rank0]:2025-11-28 18:11:31,921 - INFO - Avg. fwd time: 8.2865 / Avg. bwd time: 20.0195 / Avg. batch time: 589.1594 (ms) / GPU bubble ratio: 61.56%
[rank1]:2025-11-28 18:11:31,974 - INFO - Avg. fwd time: 9.7383 / Avg. bwd time: 20.5755 / Avg. batch time: 555.9456 (ms) / GPU bubble ratio: 56.38%
[rank1]:2025-11-28 18:11:57,004 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.2471e+00
[rank3]:2025-11-28 18:11:57,023 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 3.0545e-01
[rank2]:2025-11-28 18:11:57,004 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 8.0061e-01
[rank0]:2025-11-28 18:11:57,016 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 3.5238e-01
[rank1]:2025-11-28 18:12:43,620 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.6465e+00
[rank0]:2025-11-28 18:12:43,628 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.9487e-01
[rank2]:2025-11-28 18:12:43,604 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.4131e+00
[rank3]:2025-11-28 18:12:43,620 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.8278e+00
[rank0]:2025-11-28 18:13:28,209 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-28 18:13:33,109 - INFO - Avg. fwd time: 14.0534 / Avg. bwd time: 39.8313 / Avg. batch time: 494.5826 (ms) / GPU bubble ratio: 12.84%
[rank1]:2025-11-28 18:13:33,166 - INFO - Avg. fwd time: 9.7451 / Avg. bwd time: 20.5265 / Avg. batch time: 556.0256 (ms) / GPU bubble ratio: 56.45%
[rank2]:2025-11-28 18:13:33,137 - INFO - Avg. fwd time: 8.0573 / Avg. bwd time: 14.2787 / Avg. batch time: 521.1034 (ms) / GPU bubble ratio: 65.71%
[rank2]:2025-11-28 18:13:33,208 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.1418e-01
[rank2]:2025-11-28 18:13:33,209 - INFO -  step: 750  loss: -8.0000  grad_norm:  0.1155  memory:  6.43GiB(13.53%)  tps: 6,771  tflops: 52.93  mfu: 16.96%
[rank0]:2025-11-28 18:13:33,195 - INFO - Avg. fwd time: 8.2932 / Avg. bwd time: 19.9628 / Avg. batch time: 589.1808 (ms) / GPU bubble ratio: 61.63%
[rank1]:2025-11-28 18:13:33,208 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 6.1151e-01
[rank1]:2025-11-28 18:13:33,209 - INFO -  step: 750  loss: -8.0000  grad_norm:  0.1155  memory:  9.03GiB(19.01%)  tps: 6,771  tflops: 52.93  mfu: 16.97%
[rank0]:2025-11-28 18:13:33,220 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 3.4256e-01
[rank0]:2025-11-28 18:13:33,221 - INFO -  step: 750  loss: -8.0000  grad_norm:  0.1155  memory: 12.97GiB(27.31%)  tps: 6,771  tflops: 52.93  mfu: 16.97%
[rank3]:2025-11-28 18:13:33,228 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.6101e-01
[rank3]:2025-11-28 18:13:33,231 - INFO -  step: 750  loss:  0.2465  grad_norm:  0.1155  memory: 16.39GiB(34.50%)  tps: 6,771  tflops: 52.93  mfu: 16.96%
[rank1]:2025-11-28 18:14:19,833 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 4.0646e-01
[rank2]:2025-11-28 18:14:19,818 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 9.3061e-01
[rank3]:2025-11-28 18:14:19,833 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.7227e+00
[rank0]:2025-11-28 18:14:19,841 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.8525e-01
[rank1]:2025-11-28 18:15:09,346 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 7.5762e-01
[rank0]:2025-11-28 18:15:09,358 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 6.4991e-01
[rank3]:2025-11-28 18:15:09,366 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 3.0442e-01
[rank2]:2025-11-28 18:15:09,346 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.9465e-01
[rank3]:2025-11-28 18:15:32,335 - INFO - Avg. fwd time: 14.0561 / Avg. bwd time: 39.8144 / Avg. batch time: 494.4673 (ms) / GPU bubble ratio: 12.84%
[rank1]:2025-11-28 18:15:32,446 - INFO - Avg. fwd time: 9.7460 / Avg. bwd time: 20.5275 / Avg. batch time: 555.8555 (ms) / GPU bubble ratio: 56.43%
[rank0]:2025-11-28 18:15:32,402 - INFO - Avg. fwd time: 8.2947 / Avg. bwd time: 19.9441 / Avg. batch time: 588.9889 (ms) / GPU bubble ratio: 61.64%
[rank2]:2025-11-28 18:15:32,400 - INFO - Avg. fwd time: 8.0644 / Avg. bwd time: 14.2291 / Avg. batch time: 520.9336 (ms) / GPU bubble ratio: 65.76%
[rank1]:2025-11-28 18:15:55,934 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 7.4956e-01
[rank3]:2025-11-28 18:15:55,932 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.1824e+00
[rank2]:2025-11-28 18:15:55,916 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.9191e+00
[rank0]:2025-11-28 18:15:55,940 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 4.3626e-01
[rank3]:2025-11-28 18:16:45,421 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 7.7270e-02
[rank0]:2025-11-28 18:16:45,413 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 1.1714e+00
[rank2]:2025-11-28 18:16:45,401 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.4502e-01
[rank1]:2025-11-28 18:16:45,401 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.5599e-01
[rank0]:2025-11-28 18:17:27,395 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-28 18:17:31,810 - INFO - Avg. fwd time: 14.0585 / Avg. bwd time: 39.7827 / Avg. batch time: 494.2322 (ms) / GPU bubble ratio: 12.85%
[rank0]:2025-11-28 18:17:31,878 - INFO - Avg. fwd time: 8.2950 / Avg. bwd time: 19.9349 / Avg. batch time: 588.6938 (ms) / GPU bubble ratio: 61.64%
[rank2]:2025-11-28 18:17:31,873 - INFO - Avg. fwd time: 8.0731 / Avg. bwd time: 14.1691 / Avg. batch time: 520.6331 (ms) / GPU bubble ratio: 65.82%
[rank1]:2025-11-28 18:17:31,922 - INFO - Avg. fwd time: 9.7450 / Avg. bwd time: 20.5453 / Avg. batch time: 555.5718 (ms) / GPU bubble ratio: 56.38%
[rank2]:2025-11-28 18:17:32,114 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 3.1135e+00
[rank2]:2025-11-28 18:17:32,115 - INFO -  step: 800  loss: -8.0000  grad_norm:  0.6254  memory:  6.43GiB(13.53%)  tps: 6,858  tflops: 53.61  mfu: 17.18%
[rank2]:2025-11-28 18:17:32,115 - INFO -  final step: 800  loss: -8.0000  grad_norm:  0.6254  tps: 7,183  tflops: 56.15  mfu: 16.49%
[rank2]:2025-11-28 18:17:32,115 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-28 18:17:32,116 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-11-28 18:17:32,137 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 5.8274e-01
[rank0]:2025-11-28 18:17:32,138 - INFO -  step: 800  loss: -8.0000  grad_norm:  0.6254  memory: 12.97GiB(27.31%)  tps: 6,858  tflops: 53.61  mfu: 17.18%
[rank0]:2025-11-28 18:17:32,138 - INFO -  final step: 800  loss: -8.0000  grad_norm:  0.6254  tps: 7,181  tflops: 56.14  mfu: 16.43%
[rank0]:2025-11-28 18:17:32,138 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-28 18:17:32,139 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank3]:2025-11-28 18:17:32,130 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.9034e+00
[rank3]:2025-11-28 18:17:32,133 - INFO -  step: 800  loss:  0.2469  grad_norm:  0.6254  memory: 16.39GiB(34.50%)  tps: 6,858  tflops: 53.61  mfu: 17.18%
[rank3]:2025-11-28 18:17:32,133 - INFO -  final step: 800  loss:  0.2469  grad_norm:  0.6254  tps: 7,185  tflops: 56.17  mfu: 16.56%
[rank3]:2025-11-28 18:17:32,134 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-11-28 18:17:32,134 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank1]:2025-11-28 18:17:32,130 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 8.6475e-01
[rank1]:2025-11-28 18:17:32,131 - INFO -  step: 800  loss: -8.0000  grad_norm:  0.6254  memory:  9.03GiB(19.01%)  tps: 6,857  tflops: 53.61  mfu: 17.18%
[rank1]:2025-11-28 18:17:32,131 - INFO -  final step: 800  loss: -8.0000  grad_norm:  0.6254  tps: 7,180  tflops: 56.13  mfu: 16.42%
[rank1]:2025-11-28 18:17:32,131 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-11-28 18:17:32,132 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-11-28 18:17:34,216 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-11-28 18:17:34,288 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p60_42_dm1/frozen_ratio_history/rank0/251128_1817_stage0_final800.svg
[rank2]:2025-11-28 18:17:34,293 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p60_42_dm1/frozen_ratio_history/rank2/251128_1817_stage2_final800.svg
[rank1]:2025-11-28 18:17:34,288 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p60_42_dm1/frozen_ratio_history/rank1/251128_1817_stage1_final800.svg
[rank3]:2025-11-28 18:17:34,374 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p60_42_dm1/pipeline_schedule/251128_1817_real_final800_rank3.svg
[rank3]:			> Batch Time: 598.66 ms, GPU Bubble Ratio: 60.11%, 55.64%, 70.38%, 26.79%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms                       | [S0,MB1,F]  9-8-17ms                      | [S0,MB2,F]  18-8-26ms                     | [S0,MB3,F]  26-8-34ms                     | [S0,MB0,B]  133-21-154ms                  | [S0,MB4,F]  153-7-161ms                   | [S0,MB1,B]  191-21-213ms                  | [S0,MB5,F]  209-7-217ms                   | [S0,MB2,B]  254-21-276ms                  | [S0,MB6,F]  272-7-280ms                   | [S0,MB3,B]  318-21-339ms                  | [S0,MB7,F]  336-7-344ms                   | [S0,MB4,B]  382-21-404ms                  | [S0,MB5,B]  446-21-468ms                  | [S0,MB6,B]  512-21-533ms                  | [S0,MB7,B]  577-21-598ms                 
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms                     | [S1,MB1,F]  23-8-32ms                     | [S1,MB2,F]  36-9-45ms                     | [S1,MB0,B]  110-21-131ms                  | [S1,MB3,F]  131-9-140ms                   | [S1,MB1,B]  167-23-191ms                  | [S1,MB4,F]  190-9-199ms                   | [S1,MB2,B]  231-23-255ms                  | [S1,MB5,F]  252-9-262ms                   | [S1,MB3,B]  295-23-319ms                  | [S1,MB6,F]  316-9-326ms                   | [S1,MB4,B]  360-23-383ms                  | [S1,MB7,F]  380-9-390ms                   | [S1,MB5,B]  426-23-449ms                  | [S1,MB6,B]  491-23-515ms                  | [S1,MB7,B]  556-23-580ms                 
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms                     | [S2,MB1,F]  32-8-40ms                     | [S2,MB0,B]  87-14-101ms                   | [S2,MB2,F]  109-8-117ms                   | [S2,MB1,B]  147-14-161ms                  | [S2,MB3,F]  166-7-174ms                   | [S2,MB2,B]  211-14-225ms                  | [S2,MB4,F]  230-8-238ms                   | [S2,MB3,B]  275-13-289ms                  | [S2,MB5,F]  294-8-302ms                   | [S2,MB4,B]  339-14-353ms                  | [S2,MB6,F]  358-8-366ms                   | [S2,MB5,B]  405-14-419ms                  | [S2,MB7,F]  424-8-432ms                   | [S2,MB6,B]  473-14-487ms                  | [S2,MB7,B]  538-14-552ms                 
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-43ms                    | [S3,MB0,B]  48-34-83ms                    | [S3,MB1,F]  85-11-97ms                    | [S3,MB1,B]  103-40-143ms                  | [S3,MB2,F]  146-13-159ms                  | [S3,MB2,B]  165-41-207ms                  | [S3,MB3,F]  210-14-224ms                  | [S3,MB3,B]  229-42-271ms                  | [S3,MB4,F]  274-15-289ms                  | [S3,MB4,B]  293-42-335ms                  | [S3,MB5,F]  338-15-353ms                  | [S3,MB5,B]  359-41-401ms                  | [S3,MB6,F]  404-14-418ms                  | [S3,MB6,B]  424-42-466ms                  | [S3,MB7,F]  471-14-486ms                  | [S3,MB7,B]  491-42-533ms                 
[rank0]:2025-11-28 18:17:34,449 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p60_42_dm1/frozen_params_histogram/251128_1817_rank0_stage0.svg
[rank0]:	> Counts Sum: 1215, Total Sum: 2775 (43.78%), Ratio(%) per element: [0.0, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 45.33, 45.33, 45.33, 45.33, 45.33, 45.33, 45.33, 45.33, 45.33, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-11-28 18:17:34,449 - INFO - Sleeping 2 seconds for other ranks to complete
[rank3]:2025-11-28 18:17:34,506 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p60_42_dm1/pipeline_schedule/251128_1817_thry_final800_rank3.svg
[rank3]:			> Batch Time: 329.99 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms                       | [S0,MB1,F]  9-9-19ms                      | [S0,MB2,F]  19-9-29ms                     | [S0,MB3,F]  29-9-39ms                     | [S0,MB0,B]  99-19-119ms                   | [S0,MB4,F]  119-9-129ms                   | [S0,MB1,B]  129-19-149ms                  | [S0,MB5,F]  149-9-159ms                   | [S0,MB2,B]  159-19-179ms                  | [S0,MB6,F]  179-9-189ms                   | [S0,MB3,B]  189-19-209ms                  | [S0,MB7,F]  209-9-219ms                   | [S0,MB4,B]  219-19-239ms                  | [S0,MB5,B]  249-19-269ms                  | [S0,MB6,B]  279-19-299ms                  | [S0,MB7,B]  309-19-329ms                 
[rank2]:2025-11-28 18:17:34,454 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p60_42_dm1/frozen_params_histogram/251128_1817_rank2_stage2.svg
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-9-19ms                      | [S1,MB1,F]  19-9-29ms                     | [S1,MB2,F]  29-9-39ms                     | [S1,MB0,B]  79-19-99ms                    | [S1,MB3,F]  99-9-109ms                    | [S1,MB1,B]  109-19-129ms                  | [S1,MB4,F]  129-9-139ms                   | [S1,MB2,B]  139-19-159ms                  | [S1,MB5,F]  159-9-169ms                   | [S1,MB3,B]  169-19-189ms                  | [S1,MB6,F]  189-9-199ms                   | [S1,MB4,B]  199-19-219ms                  | [S1,MB7,F]  219-9-229ms                   | [S1,MB5,B]  229-19-249ms                  | [S1,MB6,B]  259-19-279ms                  | [S1,MB7,B]  289-19-309ms                 
[rank2]:	> Counts Sum: 1422, Total Sum: 2700 (52.67%), Ratio(%) per element: [86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 37.33, 37.33, 37.33, 37.33, 37.33, 37.33, 37.33, 37.33, 37.33, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-11-28 18:17:34,454 - INFO - Destroying the purge thread.
[rank3]:			  [Rank 2]	[S2,MB0,F]  19-9-29ms                     | [S2,MB1,F]  29-9-39ms                     | [S2,MB0,B]  59-19-79ms                    | [S2,MB2,F]  79-9-89ms                     | [S2,MB1,B]  89-19-109ms                   | [S2,MB3,F]  109-9-119ms                   | [S2,MB2,B]  119-19-139ms                  | [S2,MB4,F]  139-9-149ms                   | [S2,MB3,B]  149-19-169ms                  | [S2,MB5,F]  169-9-179ms                   | [S2,MB4,B]  179-19-199ms                  | [S2,MB6,F]  199-9-209ms                   | [S2,MB5,B]  209-19-229ms                  | [S2,MB7,F]  229-9-239ms                   | [S2,MB6,B]  239-19-259ms                  | [S2,MB7,B]  269-19-289ms                 
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-9-39ms                     | [S3,MB0,B]  39-19-59ms                    | [S3,MB1,F]  59-9-69ms                     | [S3,MB1,B]  69-19-89ms                    | [S3,MB2,F]  89-9-99ms                     | [S3,MB2,B]  99-19-119ms                   | [S3,MB3,F]  119-9-129ms                   | [S3,MB3,B]  129-19-149ms                  | [S3,MB4,F]  149-9-159ms                   | [S3,MB4,B]  159-19-179ms                  | [S3,MB5,F]  179-9-189ms                   | [S3,MB5,B]  189-19-209ms                  | [S3,MB6,F]  209-9-219ms                   | [S3,MB6,B]  219-19-239ms                  | [S3,MB7,F]  239-9-249ms                   | [S3,MB7,B]  249-19-269ms                 
[rank1]:2025-11-28 18:17:34,442 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p60_42_dm1/frozen_params_histogram/251128_1817_rank1_stage1.svg
[rank1]:	> Counts Sum: 981, Total Sum: 3375 (29.07%), Ratio(%) per element: [49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-11-28 18:17:34,442 - INFO - Destroying the purge thread.
[rank3]:2025-11-28 18:17:34,554 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p60_42_dm1/frozen_ratio_history/rank3/251128_1817_stage3_final800.svg
[rank2]:2025-11-28 18:17:34,677 - INFO - Process group destroyed
[rank3]:2025-11-28 18:17:34,687 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p60_42_dm1/frozen_params_histogram/251128_1817_rank3_stage3.svg
[rank3]:	> Counts Sum: 666, Total Sum: 2175 (30.62%), Ratio(%) per element: [49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-11-28 18:17:34,687 - INFO - Destroying the purge thread.
[rank1]:2025-11-28 18:17:34,690 - INFO - Process group destroyed
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading output.log
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–‚â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–ˆâ–‡â–ƒâ–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–ˆâ–‡â–ƒâ–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 4.56066
[rank3]:wandb:               final/avg_loss 0.24688
[rank3]:wandb:             final/avg_mfu(%) 16.55613
[rank3]:wandb:             final/avg_tflops 56.16838
[rank3]:wandb:    final/avg_throughput(tps) 7184.91781
[rank3]:wandb:              final/grad_norm 0.62535
[rank3]:wandb:               final/max_loss 0.24688
[rank3]:wandb:                    grad_norm 0.62535
[rank3]:wandb: loss_metrics/global_avg_loss 0.24688
[rank3]:wandb: loss_metrics/global_max_loss 0.24688
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1116_1F1B_auto_p60_42_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/at454goi
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1116_1F1B_auto_p60_42_dm1/20251128-1712/wandb/run-20251128_171254-at454goi/logs
[rank3]:2025-11-28 18:17:36,182 - INFO - Process group destroyed
[rank0]:2025-11-28 18:17:36,449 - INFO - Training completed
[rank0]:2025-11-28 18:17:36,450 - INFO - Destroying the purge thread.
[rank0]:2025-11-28 18:17:36,737 - INFO - Process group destroyed
[rank1]:Stage 1: Modules to keep: {'layers.6', 'layers.5', 'layers.8', 'layers.7', 'layers.4'}
[rank0]:Stage 0: Modules to keep: {'layers.0', 'layers.1', 'tok_embeddings', 'layers.3', 'layers.2'}
[rank2]:Stage 2: Modules to keep: {'layers.11', 'layers.12', 'layers.10', 'layers.9'}
[rank3]:Stage 3: Modules to keep: {'output', 'layers.15', 'norm', 'layers.14', 'layers.13'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1116_autofreeze/config_1116.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "AutoFreeze configuration experiment on different PERCENTILE values."
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1116_1F1B_auto_p60_42_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1116_1F1B_auto_p60_42_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1116_1F1B_auto_p60_42_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1116_1F1B_auto_p60_42_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1116_1F1B_auto_p60_42_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1116_1F1B_auto_p60_42_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 42
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: 1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1116_1F1B_auto_p60_42_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1116_1F1B_auto_p60_42_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: auto
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.05
[rank3]:		- percentile: 60
[rank3]:
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
