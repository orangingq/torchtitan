
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 12. 27. (í† ) 01:18:55 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 1,2,3,4
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1116_autofreeze/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1116_autofreeze/1226_1F1B_auto_p60_42.log
âœ”ï¸AutoFreeze configuration experiment on different PERCENTILE values.
âœ”ï¸Running with autofreeze (percentile=60) x 1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1116_autofreeze/config_1226.toml --job.description="AutoFreeze configuration experiment on different PERCENTILE values." --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=auto --freezing.percentile=60
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank1]:2025-12-27 01:19:01,648 - Starting job: "AutoFreeze configuration experiment on different PERCENTILE values."
[rank2]:2025-12-27 01:19:01,620 - Starting job: "AutoFreeze configuration experiment on different PERCENTILE values."
[rank0]:2025-12-27 01:19:01,683 - Starting job: "AutoFreeze configuration experiment on different PERCENTILE values."
[rank3]:2025-12-27 01:19:01,755 - Starting job: "AutoFreeze configuration experiment on different PERCENTILE values."
[rank2]:2025-12-27 01:19:01,811 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-12-27 01:19:01,814 - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-12-27 01:19:01,895 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-12-27 01:19:01,898 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-27 01:19:01,966 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-12-27 01:19:01,968 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-27 01:19:01,972 - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-12-27 01:19:01,973 - Loading tokenizer from tokenizer.json
[rank3]:2025-12-27 01:19:01,984 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-12-27 01:19:01,986 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-27 01:19:02,368 - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank0]:2025-12-27 01:19:05,169 - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank2]:2025-12-27 01:19:05,251 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-12-27 01:19:05,314 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-12-27 01:19:05,353 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-27 01:19:05,354 - Model llama3 1B size: 1,498,482,688 total parameters
[rank2]:2025-12-27 01:19:05,291 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-27 01:19:05,319 - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-12-27 01:19:05,320 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2025-12-27 01:19:05,432 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-12-27 01:19:05,379 - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-12-27 01:19:05,379 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2025-12-27 01:19:05,473 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-27 01:19:05,499 - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-12-27 01:19:05,500 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2025-12-27 01:19:05,563 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-27 01:19:05,563 - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-12-27 01:19:05,564 - CUDA memory usage for model: 1.90GiB(3.99%)
[rank2]:2025-12-27 01:19:05,504 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-27 01:19:05,504 - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-12-27 01:19:05,505 - CUDA memory usage for model: 0.92GiB(1.94%)
[rank1]:2025-12-27 01:19:05,686 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-27 01:19:05,686 - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-12-27 01:19:05,687 - CUDA memory usage for model: 1.13GiB(2.39%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run 92t1isgq
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1226_1F1B_auto_p60_42_dm1/20251227-0119/wandb/run-20251227_011906-92t1isgq
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1226_1F1B_auto_p60_42_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/92t1isgq
[rank3]:2025-12-27 01:19:07,558 - WandB logging enabled
[rank3]:2025-12-27 01:19:07,559 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-12-27 01:19:07,599 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-27 01:19:07,629 - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-12-27 01:19:07,629 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2025-12-27 01:19:07,838 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-27 01:19:07,837 - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1226_1F1B_auto_p60_42_dm1
[rank0]:2025-12-27 01:19:07,837 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-27 01:19:07,838 - Trainer is initialized with local batch size 16, global batch size 128, gradient accumulation steps 8, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2025-12-27 01:19:07,838 - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank3]:2025-12-27 01:19:07,821 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-27 01:19:07,822 - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-12-27 01:19:07,823 - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2025-12-27 01:19:07,837 - Mixed precision training with TP or PP is handled by autocast
[rank2]:2025-12-27 01:19:07,838 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-27 01:19:10,482 - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-12-27 01:19:10,482 - Finished loading the checkpoint in 2.64 seconds.
[rank0]:2025-12-27 01:19:10,482 - Training starts at step 1
[rank2]:2025-12-27 01:19:16,134 -  step:  1  loss: -8.0000  grad_norm: 116.5368  memory:  5.20GiB(10.94%)  tps: 3,022  tflops: 23.63  mfu: 7.57%
[rank2]:2025-12-27 01:19:16,134 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-12-27 01:19:16,137 -  step:  1  loss: -8.0000  grad_norm: 116.5368  memory:  7.10GiB(14.94%)  tps: 3,073  tflops: 24.02  mfu: 7.70%
[rank1]:2025-12-27 01:19:16,137 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-12-27 01:19:16,145 -  step:  1  loss: 10.6088  grad_norm: 116.5368  memory: 12.97GiB(27.31%)  tps: 3,836  tflops: 29.99  mfu: 9.61%
[rank3]:2025-12-27 01:19:16,146 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-27 01:19:16,176 -  step:  1  loss: -8.0000  grad_norm: 116.5368  memory:  9.62GiB(20.24%)  tps: 3,028  tflops: 23.67  mfu: 7.59%
[rank0]:2025-12-27 01:19:16,177 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-12-27 01:21:19,321 - Avg. fwd time: 13.6015 / Avg. bwd time: 42.7336 / Avg. batch time: 514.2713 (ms) / GPU bubble ratio: 12.37%
[rank2]:2025-12-27 01:21:19,346 - Avg. fwd time: 7.3783 / Avg. bwd time: 19.9596 / Avg. batch time: 547.1844 (ms) / GPU bubble ratio: 60.03%
[rank0]:2025-12-27 01:21:19,406 - Avg. fwd time: 7.6503 / Avg. bwd time: 24.9521 / Avg. batch time: 625.8768 (ms) / GPU bubble ratio: 58.33%
[rank1]:2025-12-27 01:21:19,376 - Avg. fwd time: 9.2665 / Avg. bwd time: 24.7752 / Avg. batch time: 587.1343 (ms) / GPU bubble ratio: 53.62%
[rank0]:2025-12-27 01:23:23,457 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-27 01:23:28,516 - Avg. fwd time: 13.7158 / Avg. bwd time: 42.9406 / Avg. batch time: 516.7672 (ms) / GPU bubble ratio: 12.29%
[rank2]:2025-12-27 01:23:28,541 - Avg. fwd time: 7.3872 / Avg. bwd time: 20.0038 / Avg. batch time: 549.3266 (ms) / GPU bubble ratio: 60.11%
[rank2]:2025-12-27 01:23:28,622 -  step: 50  loss: -8.0000  grad_norm: 12.5786  memory:  6.98GiB(14.69%)  tps: 6,359  tflops: 49.71  mfu: 15.93%
[rank0]:2025-12-27 01:23:28,601 - Avg. fwd time: 7.6558 / Avg. bwd time: 25.0019 / Avg. batch time: 627.3559 (ms) / GPU bubble ratio: 58.36%
[rank1]:2025-12-27 01:23:28,571 - Avg. fwd time: 9.2894 / Avg. bwd time: 24.8373 / Avg. batch time: 588.9476 (ms) / GPU bubble ratio: 53.64%
[rank1]:2025-12-27 01:23:28,626 -  step: 50  loss: -8.0000  grad_norm: 12.5786  memory:  9.50GiB(19.99%)  tps: 6,359  tflops: 49.71  mfu: 15.93%
[rank3]:2025-12-27 01:23:28,635 -  step: 50  loss:  9.9043  grad_norm: 12.5786  memory: 16.39GiB(34.50%)  tps: 6,359  tflops: 49.71  mfu: 15.93%
[rank0]:2025-12-27 01:23:28,637 -  step: 50  loss: -8.0000  grad_norm: 12.5786  memory: 13.42GiB(28.26%)  tps: 6,360  tflops: 49.72  mfu: 15.94%
[rank3]:2025-12-27 01:24:15,204 - Freezing Ratio: [Stage3] 0.00, Threshold: 0.0000e+00
[rank2]:2025-12-27 01:24:15,192 - Freezing Ratio: [Stage2] 0.00, Threshold: 0.0000e+00
[rank0]:2025-12-27 01:24:15,208 - Freezing Ratio: [Stage0] 0.00, Threshold: 0.0000e+00
[rank1]:2025-12-27 01:24:15,196 - Freezing Ratio: [Stage1] 0.00, Threshold: 0.0000e+00
[rank2]:2025-12-27 01:25:06,848 - Freezing Ratio: [Stage2] 0.00, Threshold: 1.1032e+00
[rank1]:2025-12-27 01:25:06,852 - Freezing Ratio: [Stage1] 0.00, Threshold: 1.8383e+00
[rank3]:2025-12-27 01:25:06,859 - Freezing Ratio: [Stage3] 0.62, Threshold: 2.3887e+00
[rank0]:2025-12-27 01:25:06,864 - Freezing Ratio: [Stage0] 0.00, Threshold: 4.3645e+00
[rank2]:2025-12-27 01:25:35,547 - Avg. fwd time: 7.3877 / Avg. bwd time: 20.0322 / Avg. batch time: 546.2599 (ms) / GPU bubble ratio: 59.84%
[rank3]:2025-12-27 01:25:35,521 - Avg. fwd time: 13.8069 / Avg. bwd time: 42.4828 / Avg. batch time: 513.8082 (ms) / GPU bubble ratio: 12.36%
[rank1]:2025-12-27 01:25:35,577 - Avg. fwd time: 9.3038 / Avg. bwd time: 24.8778 / Avg. batch time: 585.7929 (ms) / GPU bubble ratio: 53.32%
[rank0]:2025-12-27 01:25:35,607 - Avg. fwd time: 7.6641 / Avg. bwd time: 25.0346 / Avg. batch time: 624.1164 (ms) / GPU bubble ratio: 58.09%
[rank2]:2025-12-27 01:25:54,775 - Freezing Ratio: [Stage2] 0.25, Threshold: 7.4219e-01
[rank3]:2025-12-27 01:25:54,779 - Freezing Ratio: [Stage3] 0.00, Threshold: 2.4576e+00
[rank0]:2025-12-27 01:25:54,793 - Freezing Ratio: [Stage0] 0.24, Threshold: 1.9477e+00
[rank1]:2025-12-27 01:25:54,780 - Freezing Ratio: [Stage1] 0.00, Threshold: 9.1458e-01
[rank2]:2025-12-27 01:26:46,021 - Freezing Ratio: [Stage2] 0.75, Threshold: 9.5833e+00
[rank0]:2025-12-27 01:26:46,036 - Freezing Ratio: [Stage0] 0.49, Threshold: 1.1446e+01
[rank3]:2025-12-27 01:26:46,036 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.9154e+00
[rank1]:2025-12-27 01:26:46,029 - Freezing Ratio: [Stage1] 0.00, Threshold: 6.1143e+00
[rank0]:2025-12-27 01:27:32,366 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-27 01:27:32,388 - Freezing Ratio: [Stage0] 0.24, Threshold: 3.8881e+00
[rank2]:2025-12-27 01:27:32,368 - Freezing Ratio: [Stage2] 0.25, Threshold: 3.4191e+00
[rank3]:2025-12-27 01:27:32,384 - Freezing Ratio: [Stage3] 0.00, Threshold: 2.6941e+00
[rank1]:2025-12-27 01:27:32,384 - Freezing Ratio: [Stage1] 0.00, Threshold: 1.5863e+00
[rank0]:2025-12-27 01:27:37,438 - Avg. fwd time: 7.7777 / Avg. bwd time: 24.1586 / Avg. batch time: 616.3328 (ms) / GPU bubble ratio: 58.55%
[rank2]:2025-12-27 01:27:37,380 - Avg. fwd time: 7.5333 / Avg. bwd time: 18.8669 / Avg. batch time: 539.4597 (ms) / GPU bubble ratio: 60.85%
[rank3]:2025-12-27 01:27:37,357 - Avg. fwd time: 13.9090 / Avg. bwd time: 41.6892 / Avg. batch time: 508.2561 (ms) / GPU bubble ratio: 12.49%
[rank1]:2025-12-27 01:27:37,410 - Avg. fwd time: 9.2979 / Avg. bwd time: 24.8983 / Avg. batch time: 578.9443 (ms) / GPU bubble ratio: 52.75%
[rank0]:2025-12-27 01:27:37,470 -  step: 100  loss: -8.0000  grad_norm:  8.2641  memory: 13.42GiB(28.26%)  tps: 6,584  tflops: 51.47  mfu: 16.50%
[rank2]:2025-12-27 01:27:37,455 -  step: 100  loss: -8.0000  grad_norm:  8.2641  memory:  6.98GiB(14.69%)  tps: 6,584  tflops: 51.47  mfu: 16.50%
[rank2]:2025-12-27 01:27:37,541 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p60_42_dm1/frozen_ratio_history/rank2/251227_0127_stage2_step100.svg
[rank3]:2025-12-27 01:27:37,470 -  step: 100  loss:  8.5343  grad_norm:  8.2641  memory: 16.39GiB(34.50%)  tps: 6,584  tflops: 51.47  mfu: 16.50%
[rank1]:2025-12-27 01:27:37,462 -  step: 100  loss: -8.0000  grad_norm:  8.2641  memory:  9.50GiB(19.99%)  tps: 6,584  tflops: 51.47  mfu: 16.50%
[rank1]:2025-12-27 01:27:37,536 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p60_42_dm1/frozen_ratio_history/rank1/251227_0127_stage1_step100.svg
[rank0]:2025-12-27 01:27:37,540 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p60_42_dm1/frozen_ratio_history/rank0/251227_0127_stage0_step100.svg
[rank3]:2025-12-27 01:27:37,632 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p60_42_dm1/pipeline_schedule/251227_0127_step100_rank3.svg
[rank3]:			> Batch Time: 566.48 ms, GPU Bubble Ratio: 60.62%, 51.59%, 71.75%, 28.05%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-8-18ms       | [S0,MB2,F]  18-8-26ms      | [S0,MB3,F]  26-8-35ms      | [S0,MB0,B]  133-19-153ms   | [S0,MB4,F]  153-7-161ms    | [S0,MB1,B]  188-19-208ms   | [S0,MB5,F]  208-7-216ms    | [S0,MB2,B]  246-19-266ms   | [S0,MB6,F]  266-8-274ms    | [S0,MB3,B]  307-19-326ms   | [S0,MB7,F]  326-7-334ms    | [S0,MB4,B]  368-19-388ms   | [S0,MB5,B]  427-19-446ms   | [S0,MB6,B]  486-19-506ms   | [S0,MB7,B]  547-19-566ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-8-32ms      | [S1,MB2,F]  35-8-44ms      | [S1,MB0,B]  103-25-128ms   | [S1,MB3,F]  132-9-141ms    | [S1,MB1,B]  158-25-183ms   | [S1,MB4,F]  187-9-196ms    | [S1,MB2,B]  216-25-241ms   | [S1,MB5,F]  245-9-254ms    | [S1,MB3,B]  276-25-301ms   | [S1,MB6,F]  305-9-314ms    | [S1,MB4,B]  338-25-363ms   | [S1,MB7,F]  367-8-375ms    | [S1,MB5,B]  399-24-424ms   | [S1,MB6,B]  458-25-483ms   | [S1,MB7,B]  518-24-543ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-8-40ms      | [S2,MB0,B]  86-11-98ms     | [S2,MB2,F]  102-8-110ms    | [S2,MB1,B]  141-11-153ms   | [S2,MB3,F]  156-8-165ms    | [S2,MB2,B]  199-11-211ms   | [S2,MB4,F]  214-8-223ms    | [S2,MB3,B]  260-11-271ms   | [S2,MB5,F]  275-8-283ms    | [S2,MB4,B]  321-11-333ms   | [S2,MB6,F]  336-8-344ms    | [S2,MB5,B]  382-11-394ms   | [S2,MB7,F]  397-8-406ms    | [S2,MB6,B]  443-11-455ms   | [S2,MB7,B]  503-11-515ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  48-34-83ms     | [S3,MB1,F]  85-11-96ms     | [S3,MB1,B]  102-35-137ms   | [S3,MB2,F]  140-13-153ms   | [S3,MB2,B]  159-36-196ms   | [S3,MB3,F]  198-15-213ms   | [S3,MB3,B]  219-37-256ms   | [S3,MB4,F]  258-15-273ms   | [S3,MB4,B]  279-37-317ms   | [S3,MB5,F]  319-15-334ms   | [S3,MB5,B]  341-38-379ms   | [S3,MB6,F]  381-14-395ms   | [S3,MB6,B]  402-38-440ms   | [S3,MB7,F]  442-14-456ms   | [S3,MB7,B]  462-37-500ms  
[rank0]:2025-12-27 01:27:37,695 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p60_42_dm1/frozen_params_histogram/251227_0127_rank0_stage0.svg
[rank0]:	> Counts Sum: 36, Total Sum: 185 (19.46%), Ratio(%) per element: [0.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-12-27 01:27:37,695 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p60_42_dm1/frozen_params_histogram/251227_0127_rank2_stage2.svg
[rank2]:	> Counts Sum: 45, Total Sum: 180 (25.00%), Ratio(%) per element: [60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-27 01:27:37,676 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p60_42_dm1/frozen_ratio_history/rank3/251227_0127_stage3_step100.svg
[rank1]:2025-12-27 01:27:37,685 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p60_42_dm1/frozen_params_histogram/251227_0127_rank1_stage1.svg
[rank1]:	> Counts Sum: 0, Total Sum: 225 (0.00%), Ratio(%) per element: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-27 01:27:37,812 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p60_42_dm1/frozen_params_histogram/251227_0127_rank3_stage3.svg
[rank3]:	> Counts Sum: 36, Total Sum: 145 (24.83%), Ratio(%) per element: [40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-12-27 01:28:23,750 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1103e+00
[rank3]:2025-12-27 01:28:23,750 - Freezing Ratio: [Stage3] 0.62, Threshold: 3.1560e-01
[rank2]:2025-12-27 01:28:23,734 - Freezing Ratio: [Stage2] 0.75, Threshold: 4.1371e-01
[rank1]:2025-12-27 01:28:23,742 - Freezing Ratio: [Stage1] 0.40, Threshold: 1.6282e+00
[rank0]:2025-12-27 01:29:09,633 - Freezing Ratio: [Stage0] 0.24, Threshold: 1.7141e+00
[rank2]:2025-12-27 01:29:09,618 - Freezing Ratio: [Stage2] 0.25, Threshold: 3.5170e+00
[rank3]:2025-12-27 01:29:09,633 - Freezing Ratio: [Stage3] 0.00, Threshold: 4.1022e+00
[rank1]:2025-12-27 01:29:09,626 - Freezing Ratio: [Stage1] 0.00, Threshold: 2.4134e+00
[rank3]:2025-12-27 01:29:40,168 - Avg. fwd time: 13.9587 / Avg. bwd time: 41.4344 / Avg. batch time: 506.6034 (ms) / GPU bubble ratio: 12.53%
[rank2]:2025-12-27 01:29:40,191 - Avg. fwd time: 7.6291 / Avg. bwd time: 18.0777 / Avg. batch time: 537.0531 (ms) / GPU bubble ratio: 61.71%
[rank0]:2025-12-27 01:29:40,250 - Avg. fwd time: 7.8850 / Avg. bwd time: 23.3093 / Avg. batch time: 612.5576 (ms) / GPU bubble ratio: 59.26%
[rank1]:2025-12-27 01:29:40,222 - Avg. fwd time: 9.3422 / Avg. bwd time: 24.4520 / Avg. batch time: 576.0556 (ms) / GPU bubble ratio: 53.07%
[rank0]:2025-12-27 01:30:00,882 - Freezing Ratio: [Stage0] 0.73, Threshold: 3.3816e-01
[rank3]:2025-12-27 01:30:00,881 - Freezing Ratio: [Stage3] 0.62, Threshold: 2.9852e+00
[rank2]:2025-12-27 01:30:00,866 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.1225e+00
[rank1]:2025-12-27 01:30:00,874 - Freezing Ratio: [Stage1] 0.40, Threshold: 1.5280e+00
[rank3]:2025-12-27 01:30:46,663 - Freezing Ratio: [Stage3] 0.00, Threshold: 5.9568e+00
[rank0]:2025-12-27 01:30:46,663 - Freezing Ratio: [Stage0] 0.24, Threshold: 4.9201e+00
[rank2]:2025-12-27 01:30:46,647 - Freezing Ratio: [Stage2] 0.25, Threshold: 2.2331e+00
[rank1]:2025-12-27 01:30:46,655 - Freezing Ratio: [Stage1] 0.00, Threshold: 4.5108e+00
[rank2]:2025-12-27 01:31:37,773 - Freezing Ratio: [Stage2] 0.75, Threshold: 2.8161e-01
[rank3]:2025-12-27 01:31:37,789 - Freezing Ratio: [Stage3] 0.62, Threshold: 2.9913e-01
[rank0]:2025-12-27 01:31:37,772 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-27 01:31:37,789 - Freezing Ratio: [Stage0] 0.73, Threshold: 3.4769e-01
[rank1]:2025-12-27 01:31:37,782 - Freezing Ratio: [Stage1] 0.40, Threshold: 1.3724e+00
[rank3]:2025-12-27 01:31:42,327 - Avg. fwd time: 14.0006 / Avg. bwd time: 41.2302 / Avg. batch time: 505.2962 (ms) / GPU bubble ratio: 12.56%
[rank2]:2025-12-27 01:31:42,345 - Avg. fwd time: 7.6979 / Avg. bwd time: 17.5160 / Avg. batch time: 535.1369 (ms) / GPU bubble ratio: 62.31%
[rank1]:2025-12-27 01:31:42,370 - Avg. fwd time: 9.3767 / Avg. bwd time: 24.1188 / Avg. batch time: 573.7827 (ms) / GPU bubble ratio: 53.30%
[rank3]:2025-12-27 01:31:42,417 -  step: 150  loss:  4.2068  grad_norm: 10.4059  memory: 16.39GiB(34.50%)  tps: 6,689  tflops: 52.29  mfu: 16.76%
[rank0]:2025-12-27 01:31:42,393 - Avg. fwd time: 7.9619 / Avg. bwd time: 22.7057 / Avg. batch time: 609.6549 (ms) / GPU bubble ratio: 59.76%
[rank0]:2025-12-27 01:31:42,416 -  step: 150  loss: -8.0000  grad_norm: 10.4059  memory: 13.42GiB(28.26%)  tps: 6,689  tflops: 52.29  mfu: 16.76%
[rank2]:2025-12-27 01:31:42,402 -  step: 150  loss: -8.0000  grad_norm: 10.4059  memory:  6.98GiB(14.69%)  tps: 6,689  tflops: 52.29  mfu: 16.76%
[rank1]:2025-12-27 01:31:42,408 -  step: 150  loss: -8.0000  grad_norm: 10.4059  memory:  9.50GiB(19.99%)  tps: 6,689  tflops: 52.29  mfu: 16.76%
[rank0]:2025-12-27 01:32:23,671 - Freezing Ratio: [Stage0] 0.24, Threshold: 3.2947e+00
[rank3]:2025-12-27 01:32:23,672 - Freezing Ratio: [Stage3] 0.00, Threshold: 4.5616e+00
[rank2]:2025-12-27 01:32:23,656 - Freezing Ratio: [Stage2] 0.25, Threshold: 2.8960e+00
[rank1]:2025-12-27 01:32:23,664 - Freezing Ratio: [Stage1] 0.00, Threshold: 2.6216e+00
[rank0]:2025-12-27 01:33:14,842 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1022e+00
[rank3]:2025-12-27 01:33:14,842 - Freezing Ratio: [Stage3] 0.62, Threshold: 2.1467e+00
[rank2]:2025-12-27 01:33:14,826 - Freezing Ratio: [Stage2] 0.75, Threshold: 2.3116e+00
[rank1]:2025-12-27 01:33:14,834 - Freezing Ratio: [Stage1] 0.40, Threshold: 5.5198e+00
[rank2]:2025-12-27 01:33:42,269 - Avg. fwd time: 7.7643 / Avg. bwd time: 16.9841 / Avg. batch time: 532.4749 (ms) / GPU bubble ratio: 62.82%
[rank1]:2025-12-27 01:33:42,295 - Avg. fwd time: 9.4167 / Avg. bwd time: 23.7526 / Avg. batch time: 570.7388 (ms) / GPU bubble ratio: 53.51%
[rank3]:2025-12-27 01:33:42,251 - Avg. fwd time: 14.0410 / Avg. bwd time: 40.9289 / Avg. batch time: 503.2003 (ms) / GPU bubble ratio: 12.61%
[rank0]:2025-12-27 01:33:42,317 - Avg. fwd time: 8.0339 / Avg. bwd time: 22.1458 / Avg. batch time: 606.0288 (ms) / GPU bubble ratio: 60.16%
[rank2]:2025-12-27 01:34:00,737 - Freezing Ratio: [Stage2] 0.25, Threshold: 2.6961e+00
[rank1]:2025-12-27 01:34:00,745 - Freezing Ratio: [Stage1] 0.00, Threshold: 1.0034e+00
[rank3]:2025-12-27 01:34:00,753 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.8841e+00
[rank0]:2025-12-27 01:34:00,753 - Freezing Ratio: [Stage0] 0.24, Threshold: 1.1752e+00
[rank0]:2025-12-27 01:34:51,892 - Freezing Ratio: [Stage0] 0.73, Threshold: 6.2654e+00
[rank2]:2025-12-27 01:34:51,876 - Freezing Ratio: [Stage2] 0.75, Threshold: 2.6241e+00
[rank1]:2025-12-27 01:34:51,884 - Freezing Ratio: [Stage1] 0.40, Threshold: 1.0275e+01
[rank3]:2025-12-27 01:34:51,892 - Freezing Ratio: [Stage3] 0.62, Threshold: 4.7713e-01
[rank0]:2025-12-27 01:35:37,773 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-27 01:35:37,775 - Freezing Ratio: [Stage2] 0.25, Threshold: 2.3769e+00
[rank1]:2025-12-27 01:35:37,783 - Freezing Ratio: [Stage1] 0.00, Threshold: 2.6505e+00
[rank3]:2025-12-27 01:35:37,790 - Freezing Ratio: [Stage3] 0.00, Threshold: 3.2687e+00
[rank0]:2025-12-27 01:35:37,790 - Freezing Ratio: [Stage0] 0.24, Threshold: 5.3886e+00
[rank2]:2025-12-27 01:35:42,873 - Avg. fwd time: 7.8102 / Avg. bwd time: 16.6154 / Avg. batch time: 530.8711 (ms) / GPU bubble ratio: 63.19%
[rank3]:2025-12-27 01:35:42,849 - Avg. fwd time: 14.0786 / Avg. bwd time: 40.7412 / Avg. batch time: 501.9928 (ms) / GPU bubble ratio: 12.64%
[rank0]:2025-12-27 01:35:42,935 - Avg. fwd time: 8.0849 / Avg. bwd time: 21.7556 / Avg. batch time: 603.7613 (ms) / GPU bubble ratio: 60.46%
[rank0]:2025-12-27 01:35:42,967 -  step: 200  loss: -8.0000  grad_norm:  8.8972  memory: 13.42GiB(28.26%)  tps: 6,811  tflops: 53.25  mfu: 17.07%
[rank2]:2025-12-27 01:35:42,953 -  step: 200  loss: -8.0000  grad_norm:  8.8972  memory:  6.98GiB(14.69%)  tps: 6,811  tflops: 53.25  mfu: 17.07%
[rank1]:2025-12-27 01:35:42,907 - Avg. fwd time: 9.4442 / Avg. bwd time: 23.5080 / Avg. batch time: 568.8766 (ms) / GPU bubble ratio: 53.66%
[rank1]:2025-12-27 01:35:42,960 -  step: 200  loss: -8.0000  grad_norm:  8.8972  memory:  9.50GiB(19.99%)  tps: 6,811  tflops: 53.25  mfu: 17.07%
[rank3]:2025-12-27 01:35:42,970 -  step: 200  loss:  1.1971  grad_norm:  8.8972  memory: 16.39GiB(34.50%)  tps: 6,811  tflops: 53.25  mfu: 17.07%
[rank0]:2025-12-27 01:35:43,024 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p60_42_dm1/frozen_ratio_history/rank0/251227_0135_stage0_step200.svg
[rank2]:2025-12-27 01:35:43,024 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p60_42_dm1/frozen_ratio_history/rank2/251227_0135_stage2_step200.svg
[rank1]:2025-12-27 01:35:43,025 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p60_42_dm1/frozen_ratio_history/rank1/251227_0135_stage1_step200.svg
[rank3]:2025-12-27 01:35:43,107 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p60_42_dm1/pipeline_schedule/251227_0135_step200_rank3.svg
[rank3]:			> Batch Time: 562.06 ms, GPU Bubble Ratio: 63.97%, 58.38%, 71.60%, 27.19%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-36ms      | [S0,MB0,B]  127-16-144ms   | [S0,MB4,F]  144-8-152ms    | [S0,MB1,B]  183-16-200ms   | [S0,MB5,F]  200-8-208ms    | [S0,MB2,B]  243-16-259ms   | [S0,MB6,F]  260-8-268ms    | [S0,MB3,B]  305-16-321ms   | [S0,MB7,F]  321-8-330ms    | [S0,MB4,B]  365-16-382ms   | [S0,MB5,B]  424-16-441ms   | [S0,MB6,B]  484-16-501ms   | [S0,MB7,B]  545-16-562ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-9-33ms      | [S1,MB2,F]  36-9-46ms      | [S1,MB0,B]  103-19-122ms   | [S1,MB3,F]  126-9-136ms    | [S1,MB1,B]  159-19-178ms   | [S1,MB4,F]  182-9-192ms    | [S1,MB2,B]  218-19-238ms   | [S1,MB5,F]  241-9-251ms    | [S1,MB3,B]  280-19-299ms   | [S1,MB6,F]  303-9-313ms    | [S1,MB4,B]  341-19-360ms   | [S1,MB7,F]  363-9-373ms    | [S1,MB5,B]  401-19-421ms   | [S1,MB6,B]  461-19-481ms   | [S1,MB7,B]  522-19-542ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  33-8-41ms      | [S2,MB0,B]  86-11-98ms     | [S2,MB2,F]  101-8-110ms    | [S2,MB1,B]  142-11-154ms   | [S2,MB3,F]  158-8-166ms    | [S2,MB2,B]  202-11-213ms   | [S2,MB4,F]  217-8-225ms    | [S2,MB3,B]  264-11-275ms   | [S2,MB5,F]  279-8-287ms    | [S2,MB4,B]  324-11-336ms   | [S2,MB6,F]  339-8-347ms    | [S2,MB5,B]  385-11-397ms   | [S2,MB7,F]  400-8-408ms    | [S2,MB6,B]  447-11-458ms   | [S2,MB7,B]  508-11-519ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  48-34-82ms     | [S3,MB1,F]  85-12-97ms     | [S3,MB1,B]  103-35-139ms   | [S3,MB2,F]  141-14-156ms   | [S3,MB2,B]  162-36-199ms   | [S3,MB3,F]  201-14-215ms   | [S3,MB3,B]  222-37-260ms   | [S3,MB4,F]  262-15-278ms   | [S3,MB4,B]  283-37-320ms   | [S3,MB5,F]  323-15-338ms   | [S3,MB5,B]  344-37-382ms   | [S3,MB6,F]  384-15-399ms   | [S3,MB6,B]  406-37-444ms   | [S3,MB7,F]  445-15-460ms   | [S3,MB7,B]  468-37-506ms  
[rank0]:2025-12-27 01:35:43,178 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p60_42_dm1/frozen_params_histogram/251227_0135_rank0_stage0.svg
[rank0]:	> Counts Sum: 216, Total Sum: 555 (38.92%), Ratio(%) per element: [0.0, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-12-27 01:35:43,174 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p60_42_dm1/frozen_params_histogram/251227_0135_rank2_stage2.svg
[rank2]:	> Counts Sum: 225, Total Sum: 540 (41.67%), Ratio(%) per element: [86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-12-27 01:35:43,170 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p60_42_dm1/frozen_params_histogram/251227_0135_rank1_stage1.svg
[rank1]:	> Counts Sum: 90, Total Sum: 675 (13.33%), Ratio(%) per element: [33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-27 01:35:43,153 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p60_42_dm1/frozen_ratio_history/rank3/251227_0135_stage3_step200.svg
[rank3]:2025-12-27 01:35:43,284 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p60_42_dm1/frozen_params_histogram/251227_0135_rank3_stage3.svg
[rank3]:	> Counts Sum: 126, Total Sum: 435 (28.97%), Ratio(%) per element: [46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-12-27 01:36:29,419 - Freezing Ratio: [Stage0] 0.73, Threshold: 9.4519e-01
[rank2]:2025-12-27 01:36:29,403 - Freezing Ratio: [Stage2] 0.75, Threshold: 9.7924e-01
[rank1]:2025-12-27 01:36:29,412 - Freezing Ratio: [Stage1] 0.40, Threshold: 5.0315e+00
[rank3]:2025-12-27 01:36:29,419 - Freezing Ratio: [Stage3] 0.62, Threshold: 8.8385e-01
[rank1]:2025-12-27 01:37:15,309 - Freezing Ratio: [Stage1] 0.60, Threshold: 1.1088e+01
[rank2]:2025-12-27 01:37:15,302 - Freezing Ratio: [Stage2] 0.25, Threshold: 5.6326e+00
[rank3]:2025-12-27 01:37:15,317 - Freezing Ratio: [Stage3] 0.00, Threshold: 7.5924e+00
[rank0]:2025-12-27 01:37:15,317 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.2258e+01
[rank3]:2025-12-27 01:37:45,343 - Avg. fwd time: 14.0924 / Avg. bwd time: 40.7258 / Avg. batch time: 501.9761 (ms) / GPU bubble ratio: 12.64%
[rank0]:2025-12-27 01:37:45,414 - Avg. fwd time: 8.1306 / Avg. bwd time: 21.4034 / Avg. batch time: 602.8997 (ms) / GPU bubble ratio: 60.81%
[rank1]:2025-12-27 01:37:45,391 - Avg. fwd time: 9.4802 / Avg. bwd time: 23.1941 / Avg. batch time: 568.3779 (ms) / GPU bubble ratio: 54.01%
[rank2]:2025-12-27 01:37:45,368 - Avg. fwd time: 7.8323 / Avg. bwd time: 16.4330 / Avg. batch time: 530.6949 (ms) / GPU bubble ratio: 63.42%
[rank0]:2025-12-27 01:38:05,346 - Freezing Ratio: [Stage0] 0.73, Threshold: 3.0774e+00
[rank1]:2025-12-27 01:38:05,335 - Freezing Ratio: [Stage1] 0.40, Threshold: 2.3818e+00
[rank2]:2025-12-27 01:38:05,338 - Freezing Ratio: [Stage2] 0.75, Threshold: 4.9144e-01
[rank3]:2025-12-27 01:38:05,354 - Freezing Ratio: [Stage3] 0.62, Threshold: 6.5477e-01
[rank0]:2025-12-27 01:38:51,410 - Freezing Ratio: [Stage0] 0.73, Threshold: 3.4876e+00
[rank1]:2025-12-27 01:38:51,402 - Freezing Ratio: [Stage1] 0.80, Threshold: 4.0341e+00
[rank2]:2025-12-27 01:38:51,395 - Freezing Ratio: [Stage2] 0.25, Threshold: 2.3306e+00
[rank3]:2025-12-27 01:38:51,410 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.7189e+00
[rank1]:2025-12-27 01:39:41,276 - Freezing Ratio: [Stage1] 0.40, Threshold: 1.0017e+00
[rank0]:2025-12-27 01:39:41,284 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-27 01:39:41,292 - Freezing Ratio: [Stage0] 0.73, Threshold: 8.4545e-01
[rank2]:2025-12-27 01:39:41,284 - Freezing Ratio: [Stage2] 0.75, Threshold: 4.3246e-01
[rank3]:2025-12-27 01:39:41,301 - Freezing Ratio: [Stage3] 0.62, Threshold: 5.2546e-01
[rank2]:2025-12-27 01:39:45,794 - Avg. fwd time: 7.8525 / Avg. bwd time: 16.2687 / Avg. batch time: 530.3581 (ms) / GPU bubble ratio: 63.62%
[rank3]:2025-12-27 01:39:45,775 - Avg. fwd time: 14.1108 / Avg. bwd time: 40.6890 / Avg. batch time: 501.8242 (ms) / GPU bubble ratio: 12.64%
[rank2]:2025-12-27 01:39:45,852 -  step: 250  loss: -8.0000  grad_norm:  2.1373  memory:  6.98GiB(14.69%)  tps: 6,745  tflops: 52.73  mfu: 16.90%
[rank0]:2025-12-27 01:39:45,843 - Avg. fwd time: 8.1923 / Avg. bwd time: 20.9187 / Avg. batch time: 601.3910 (ms) / GPU bubble ratio: 61.28%
[rank0]:2025-12-27 01:39:45,867 -  step: 250  loss: -8.0000  grad_norm:  2.1373  memory: 13.42GiB(28.26%)  tps: 6,745  tflops: 52.73  mfu: 16.90%
[rank1]:2025-12-27 01:39:45,820 - Avg. fwd time: 9.5566 / Avg. bwd time: 22.5328 / Avg. batch time: 567.3711 (ms) / GPU bubble ratio: 54.75%
[rank1]:2025-12-27 01:39:45,859 -  step: 250  loss: -8.0000  grad_norm:  2.1373  memory:  9.50GiB(19.99%)  tps: 6,745  tflops: 52.73  mfu: 16.90%
[rank3]:2025-12-27 01:39:45,868 -  step: 250  loss:  0.4148  grad_norm:  2.1373  memory: 16.39GiB(34.50%)  tps: 6,745  tflops: 52.73  mfu: 16.90%
[rank2]:2025-12-27 01:40:27,094 - Freezing Ratio: [Stage2] 0.25, Threshold: 1.5540e+00
[rank0]:2025-12-27 01:40:27,109 - Freezing Ratio: [Stage0] 0.73, Threshold: 2.1331e+00
[rank1]:2025-12-27 01:40:27,101 - Freezing Ratio: [Stage1] 0.80, Threshold: 4.0060e-01
[rank3]:2025-12-27 01:40:27,109 - Freezing Ratio: [Stage3] 0.00, Threshold: 7.0754e-01
[rank2]:2025-12-27 01:41:16,655 - Freezing Ratio: [Stage2] 0.75, Threshold: 2.4357e+00
[rank1]:2025-12-27 01:41:16,647 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.2734e+01
[rank0]:2025-12-27 01:41:16,663 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.5344e+01
[rank3]:2025-12-27 01:41:16,671 - Freezing Ratio: [Stage3] 0.62, Threshold: 2.6149e+00
[rank2]:2025-12-27 01:41:43,659 - Avg. fwd time: 7.8793 / Avg. bwd time: 16.0503 / Avg. batch time: 528.9754 (ms) / GPU bubble ratio: 63.81%
[rank1]:2025-12-27 01:41:43,679 - Avg. fwd time: 9.6288 / Avg. bwd time: 21.9067 / Avg. batch time: 565.3542 (ms) / GPU bubble ratio: 55.38%
[rank3]:2025-12-27 01:41:43,639 - Avg. fwd time: 14.1186 / Avg. bwd time: 40.5382 / Avg. batch time: 500.6770 (ms) / GPU bubble ratio: 12.67%
[rank0]:2025-12-27 01:41:43,703 - Avg. fwd time: 8.2415 / Avg. bwd time: 20.5212 / Avg. batch time: 598.9630 (ms) / GPU bubble ratio: 61.58%
[rank1]:2025-12-27 01:42:01,688 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.7730e+00
[rank0]:2025-12-27 01:42:01,703 - Freezing Ratio: [Stage0] 0.73, Threshold: 2.7735e+00
[rank3]:2025-12-27 01:42:01,703 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.4176e+00
[rank2]:2025-12-27 01:42:01,688 - Freezing Ratio: [Stage2] 0.25, Threshold: 2.1295e+00
[rank2]:2025-12-27 01:42:51,305 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.4007e-01
[rank1]:2025-12-27 01:42:51,298 - Freezing Ratio: [Stage1] 0.80, Threshold: 9.5290e-01
[rank0]:2025-12-27 01:42:51,313 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.0951e+00
[rank3]:2025-12-27 01:42:51,321 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.4200e-01
[rank2]:2025-12-27 01:43:36,400 - Freezing Ratio: [Stage2] 0.25, Threshold: 1.5076e+00
[rank1]:2025-12-27 01:43:36,400 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.5061e+00
[rank0]:2025-12-27 01:43:36,399 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-27 01:43:36,415 - Freezing Ratio: [Stage0] 0.73, Threshold: 2.0617e+00
[rank3]:2025-12-27 01:43:36,416 - Freezing Ratio: [Stage3] 0.00, Threshold: 5.5796e-01
[rank1]:2025-12-27 01:43:41,329 - Avg. fwd time: 9.7093 / Avg. bwd time: 21.2106 / Avg. batch time: 563.5798 (ms) / GPU bubble ratio: 56.11%
[rank3]:2025-12-27 01:43:41,283 - Avg. fwd time: 14.1121 / Avg. bwd time: 40.4330 / Avg. batch time: 499.7816 (ms) / GPU bubble ratio: 12.69%
[rank2]:2025-12-27 01:43:41,309 - Avg. fwd time: 7.8989 / Avg. bwd time: 15.8873 / Avg. batch time: 527.9035 (ms) / GPU bubble ratio: 63.95%
[rank2]:2025-12-27 01:43:41,369 -  step: 300  loss: -8.0000  grad_norm:  0.9382  memory:  6.98GiB(14.69%)  tps: 6,957  tflops: 54.38  mfu: 17.43%
[rank1]:2025-12-27 01:43:41,362 -  step: 300  loss: -8.0000  grad_norm:  0.9382  memory:  9.50GiB(19.99%)  tps: 6,957  tflops: 54.39  mfu: 17.43%
[rank0]:2025-12-27 01:43:41,353 - Avg. fwd time: 8.2821 / Avg. bwd time: 20.1901 / Avg. batch time: 596.8476 (ms) / GPU bubble ratio: 61.84%
[rank0]:2025-12-27 01:43:41,376 -  step: 300  loss: -8.0000  grad_norm:  0.9382  memory: 13.42GiB(28.26%)  tps: 6,957  tflops: 54.39  mfu: 17.43%
[rank0]:2025-12-27 01:43:41,436 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p60_42_dm1/frozen_ratio_history/rank0/251227_0143_stage0_step300.svg
[rank3]:2025-12-27 01:43:41,384 -  step: 300  loss:  0.2953  grad_norm:  0.9382  memory: 16.39GiB(34.50%)  tps: 6,957  tflops: 54.38  mfu: 17.43%
[rank2]:2025-12-27 01:43:41,450 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p60_42_dm1/frozen_ratio_history/rank2/251227_0143_stage2_step300.svg
[rank1]:2025-12-27 01:43:41,439 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p60_42_dm1/frozen_ratio_history/rank1/251227_0143_stage1_step300.svg
[rank3]:2025-12-27 01:43:41,538 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p60_42_dm1/pipeline_schedule/251227_0143_step300_rank3.svg
[rank3]:			> Batch Time: 549.58 ms, GPU Bubble Ratio: 63.10%, 64.81%, 70.83%, 26.02%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-36ms      | [S0,MB0,B]  122-16-139ms   | [S0,MB4,F]  139-8-147ms    | [S0,MB1,B]  178-16-195ms   | [S0,MB5,F]  195-8-203ms    | [S0,MB2,B]  236-16-252ms   | [S0,MB6,F]  253-8-261ms    | [S0,MB3,B]  295-16-312ms   | [S0,MB7,F]  312-8-320ms    | [S0,MB4,B]  355-16-372ms   | [S0,MB5,B]  414-16-430ms   | [S0,MB6,B]  473-16-489ms   | [S0,MB7,B]  533-16-549ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-10-34ms     | [S1,MB2,F]  37-10-48ms     | [S1,MB0,B]  103-13-117ms   | [S1,MB3,F]  120-10-131ms   | [S1,MB1,B]  159-13-173ms   | [S1,MB4,F]  177-10-187ms   | [S1,MB2,B]  217-13-231ms   | [S1,MB5,F]  234-10-245ms   | [S1,MB3,B]  277-13-290ms   | [S1,MB6,F]  294-10-304ms   | [S1,MB4,B]  337-13-350ms   | [S1,MB7,F]  354-10-364ms   | [S1,MB5,B]  397-13-410ms   | [S1,MB6,B]  456-13-469ms   | [S1,MB7,B]  515-13-529ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  34-8-42ms      | [S2,MB0,B]  86-11-98ms     | [S2,MB2,F]  102-8-110ms    | [S2,MB1,B]  143-11-154ms   | [S2,MB3,F]  158-8-166ms    | [S2,MB2,B]  200-11-212ms   | [S2,MB4,F]  215-8-224ms    | [S2,MB3,B]  260-11-271ms   | [S2,MB5,F]  275-8-283ms    | [S2,MB4,B]  320-11-331ms   | [S2,MB6,F]  335-8-343ms    | [S2,MB5,B]  380-11-392ms   | [S2,MB7,F]  396-8-404ms    | [S2,MB6,B]  441-11-452ms   | [S2,MB7,B]  501-11-512ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  48-34-83ms     | [S3,MB1,F]  85-11-97ms     | [S3,MB1,B]  103-35-138ms   | [S3,MB2,F]  141-13-154ms   | [S3,MB2,B]  160-36-196ms   | [S3,MB3,F]  199-14-213ms   | [S3,MB3,B]  219-37-256ms   | [S3,MB4,F]  258-14-273ms   | [S3,MB4,B]  279-37-316ms   | [S3,MB5,F]  318-15-333ms   | [S3,MB5,B]  339-37-376ms   | [S3,MB6,F]  379-15-394ms   | [S3,MB6,B]  400-37-437ms   | [S3,MB7,F]  439-14-454ms   | [S3,MB7,B]  460-37-498ms  
[rank1]:2025-12-27 01:43:41,589 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p60_42_dm1/frozen_params_histogram/251227_0143_rank1_stage1.svg
[rank1]:	> Counts Sum: 387, Total Sum: 1125 (34.40%), Ratio(%) per element: [60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 28.0, 28.0, 28.0, 28.0, 28.0, 28.0, 28.0, 28.0, 28.0, 24.0, 24.0, 24.0, 24.0, 24.0, 24.0, 24.0, 24.0, 24.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-12-27 01:43:41,592 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p60_42_dm1/frozen_params_histogram/251227_0143_rank0_stage0.svg
[rank0]:	> Counts Sum: 486, Total Sum: 925 (52.54%), Ratio(%) per element: [0.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 64.0, 64.0, 64.0, 64.0, 64.0, 64.0, 64.0, 64.0, 64.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-27 01:43:41,583 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p60_42_dm1/frozen_ratio_history/rank3/251227_0143_stage3_step300.svg
[rank2]:2025-12-27 01:43:41,607 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p60_42_dm1/frozen_params_histogram/251227_0143_rank2_stage2.svg
[rank2]:	> Counts Sum: 405, Total Sum: 900 (45.00%), Ratio(%) per element: [92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 44.0, 44.0, 44.0, 44.0, 44.0, 44.0, 44.0, 44.0, 44.0, 44.0, 44.0, 44.0, 44.0, 44.0, 44.0, 44.0, 44.0, 44.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-27 01:43:41,713 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p60_42_dm1/frozen_params_histogram/251227_0143_rank3_stage3.svg
[rank3]:	> Counts Sum: 216, Total Sum: 725 (29.79%), Ratio(%) per element: [48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-12-27 01:44:26,242 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.3420e-01
[rank1]:2025-12-27 01:44:26,234 - Freezing Ratio: [Stage1] 0.80, Threshold: 8.4525e-01
[rank0]:2025-12-27 01:44:26,250 - Freezing Ratio: [Stage0] 0.73, Threshold: 2.4281e+00
[rank3]:2025-12-27 01:44:26,258 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.9804e-01
[rank1]:2025-12-27 01:45:11,318 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.9863e+00
[rank0]:2025-12-27 01:45:11,333 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.5898e+00
[rank3]:2025-12-27 01:45:11,333 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.9269e+00
[rank2]:2025-12-27 01:45:11,318 - Freezing Ratio: [Stage2] 0.25, Threshold: 1.6080e+00
[rank3]:2025-12-27 01:45:41,003 - Avg. fwd time: 14.0980 / Avg. bwd time: 40.4325 / Avg. batch time: 499.6640 (ms) / GPU bubble ratio: 12.69%
[rank2]:2025-12-27 01:45:41,028 - Avg. fwd time: 7.9064 / Avg. bwd time: 15.8207 / Avg. batch time: 527.7414 (ms) / GPU bubble ratio: 64.03%
[rank1]:2025-12-27 01:45:41,050 - Avg. fwd time: 9.7780 / Avg. bwd time: 20.6217 / Avg. batch time: 562.8228 (ms) / GPU bubble ratio: 56.79%
[rank0]:2025-12-27 01:45:41,074 - Avg. fwd time: 8.3169 / Avg. bwd time: 19.9101 / Avg. batch time: 595.8011 (ms) / GPU bubble ratio: 62.10%
[rank2]:2025-12-27 01:46:01,050 - Freezing Ratio: [Stage2] 0.75, Threshold: 8.8118e-01
[rank1]:2025-12-27 01:46:01,042 - Freezing Ratio: [Stage1] 0.80, Threshold: 5.0920e+00
[rank0]:2025-12-27 01:46:01,057 - Freezing Ratio: [Stage0] 0.73, Threshold: 3.5215e+00
[rank3]:2025-12-27 01:46:01,065 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.1201e+00
[rank2]:2025-12-27 01:46:46,231 - Freezing Ratio: [Stage2] 0.25, Threshold: 2.6860e-01
[rank1]:2025-12-27 01:46:46,232 - Freezing Ratio: [Stage1] 0.80, Threshold: 6.5754e-01
[rank0]:2025-12-27 01:46:46,247 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1423e+00
[rank3]:2025-12-27 01:46:46,247 - Freezing Ratio: [Stage3] 0.00, Threshold: 6.4046e-01
[rank1]:2025-12-27 01:47:35,906 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.2525e+00
[rank0]:2025-12-27 01:47:35,914 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-27 01:47:35,921 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.5169e+00
[rank3]:2025-12-27 01:47:35,931 - Freezing Ratio: [Stage3] 0.62, Threshold: 2.7840e-01
[rank2]:2025-12-27 01:47:35,914 - Freezing Ratio: [Stage2] 0.75, Threshold: 3.1182e-01
[rank3]:2025-12-27 01:47:40,368 - Avg. fwd time: 14.0944 / Avg. bwd time: 40.4190 / Avg. batch time: 499.5263 (ms) / GPU bubble ratio: 12.70%
[rank2]:2025-12-27 01:47:40,388 - Avg. fwd time: 7.9156 / Avg. bwd time: 15.7469 / Avg. batch time: 527.5184 (ms) / GPU bubble ratio: 64.11%
[rank1]:2025-12-27 01:47:40,409 - Avg. fwd time: 9.8376 / Avg. bwd time: 20.1168 / Avg. batch time: 562.0914 (ms) / GPU bubble ratio: 57.37%
[rank1]:2025-12-27 01:47:40,443 -  step: 350  loss: -8.0000  grad_norm:  0.4407  memory:  9.50GiB(19.99%)  tps: 6,853  tflops: 53.57  mfu: 17.17%
[rank0]:2025-12-27 01:47:40,434 - Avg. fwd time: 8.3475 / Avg. bwd time: 19.6702 / Avg. batch time: 594.8239 (ms) / GPU bubble ratio: 62.32%
[rank0]:2025-12-27 01:47:40,457 -  step: 350  loss: -8.0000  grad_norm:  0.4407  memory: 13.42GiB(28.26%)  tps: 6,853  tflops: 53.57  mfu: 17.17%
[rank3]:2025-12-27 01:47:40,459 -  step: 350  loss:  0.2440  grad_norm:  0.4407  memory: 16.39GiB(34.50%)  tps: 6,853  tflops: 53.57  mfu: 17.17%
[rank2]:2025-12-27 01:47:40,443 -  step: 350  loss: -8.0000  grad_norm:  0.4407  memory:  6.98GiB(14.69%)  tps: 6,853  tflops: 53.57  mfu: 17.17%
[rank1]:2025-12-27 01:48:21,208 - Freezing Ratio: [Stage1] 0.80, Threshold: 2.3958e-01
[rank3]:2025-12-27 01:48:21,224 - Freezing Ratio: [Stage3] 0.00, Threshold: 4.9092e-01
[rank2]:2025-12-27 01:48:21,208 - Freezing Ratio: [Stage2] 0.25, Threshold: 4.7567e-01
[rank0]:2025-12-27 01:48:21,223 - Freezing Ratio: [Stage0] 0.73, Threshold: 4.1987e-01
[rank1]:2025-12-27 01:49:10,954 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.3943e+00
[rank0]:2025-12-27 01:49:10,969 - Freezing Ratio: [Stage0] 0.73, Threshold: 7.9257e-01
[rank3]:2025-12-27 01:49:10,977 - Freezing Ratio: [Stage3] 0.62, Threshold: 8.9119e-02
[rank2]:2025-12-27 01:49:10,961 - Freezing Ratio: [Stage2] 0.75, Threshold: 9.3660e-02
[rank3]:2025-12-27 01:49:37,996 - Avg. fwd time: 14.0979 / Avg. bwd time: 40.3352 / Avg. batch time: 498.8835 (ms) / GPU bubble ratio: 12.71%
[rank2]:2025-12-27 01:49:38,016 - Avg. fwd time: 7.9319 / Avg. bwd time: 15.6216 / Avg. batch time: 526.7404 (ms) / GPU bubble ratio: 64.23%
[rank1]:2025-12-27 01:49:38,038 - Avg. fwd time: 9.8893 / Avg. bwd time: 19.6795 / Avg. batch time: 560.8739 (ms) / GPU bubble ratio: 57.82%
[rank0]:2025-12-27 01:49:38,063 - Avg. fwd time: 8.3739 / Avg. bwd time: 19.4625 / Avg. batch time: 593.3927 (ms) / GPU bubble ratio: 62.47%
[rank1]:2025-12-27 01:49:56,240 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.9102e+00
[rank3]:2025-12-27 01:49:56,255 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.0721e+00
[rank2]:2025-12-27 01:49:56,239 - Freezing Ratio: [Stage2] 0.25, Threshold: 5.6893e-01
[rank0]:2025-12-27 01:49:56,255 - Freezing Ratio: [Stage0] 0.73, Threshold: 4.4968e-01
[rank2]:2025-12-27 01:50:45,920 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.3670e-01
[rank1]:2025-12-27 01:50:45,912 - Freezing Ratio: [Stage1] 0.80, Threshold: 2.6594e-01
[rank0]:2025-12-27 01:50:45,927 - Freezing Ratio: [Stage0] 0.73, Threshold: 3.7389e+00
[rank3]:2025-12-27 01:50:45,935 - Freezing Ratio: [Stage3] 0.62, Threshold: 9.7193e-02
[rank0]:2025-12-27 01:51:31,251 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-27 01:51:31,268 - Freezing Ratio: [Stage0] 0.73, Threshold: 2.2577e+00
[rank1]:2025-12-27 01:51:31,253 - Freezing Ratio: [Stage1] 0.80, Threshold: 6.0331e-01
[rank3]:2025-12-27 01:51:31,268 - Freezing Ratio: [Stage3] 0.00, Threshold: 3.6984e-01
[rank2]:2025-12-27 01:51:31,252 - Freezing Ratio: [Stage2] 0.25, Threshold: 6.9055e-01
[rank2]:2025-12-27 01:51:36,233 - Avg. fwd time: 7.9446 / Avg. bwd time: 15.5262 / Avg. batch time: 526.2542 (ms) / GPU bubble ratio: 64.32%
[rank1]:2025-12-27 01:51:36,255 - Avg. fwd time: 9.9351 / Avg. bwd time: 19.2967 / Avg. batch time: 560.0033 (ms) / GPU bubble ratio: 58.24%
[rank3]:2025-12-27 01:51:36,207 - Avg. fwd time: 14.1029 / Avg. bwd time: 40.2826 / Avg. batch time: 498.5008 (ms) / GPU bubble ratio: 12.72%
[rank2]:2025-12-27 01:51:36,296 -  step: 400  loss: -8.0000  grad_norm:  0.2561  memory:  6.98GiB(14.69%)  tps: 6,947  tflops: 54.31  mfu: 17.41%
[rank0]:2025-12-27 01:51:36,280 - Avg. fwd time: 8.3973 / Avg. bwd time: 19.2807 / Avg. batch time: 592.3358 (ms) / GPU bubble ratio: 62.62%
[rank0]:2025-12-27 01:51:36,303 -  step: 400  loss: -8.0000  grad_norm:  0.2561  memory: 13.42GiB(28.26%)  tps: 6,947  tflops: 54.31  mfu: 17.41%
[rank0]:2025-12-27 01:51:36,368 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p60_42_dm1/frozen_ratio_history/rank0/251227_0151_stage0_step400.svg
[rank1]:2025-12-27 01:51:36,289 -  step: 400  loss: -8.0000  grad_norm:  0.2561  memory:  9.50GiB(19.99%)  tps: 6,947  tflops: 54.31  mfu: 17.41%
[rank1]:2025-12-27 01:51:36,369 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p60_42_dm1/frozen_ratio_history/rank1/251227_0151_stage1_step400.svg
[rank3]:2025-12-27 01:51:36,311 -  step: 400  loss:  0.2270  grad_norm:  0.2561  memory: 16.39GiB(34.50%)  tps: 6,947  tflops: 54.31  mfu: 17.41%
[rank2]:2025-12-27 01:51:36,368 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p60_42_dm1/frozen_ratio_history/rank2/251227_0151_stage2_step400.svg
[rank3]:2025-12-27 01:51:36,448 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p60_42_dm1/pipeline_schedule/251227_0151_step400_rank3.svg
[rank3]:			> Batch Time: 548.58 ms, GPU Bubble Ratio: 63.02%, 64.75%, 70.82%, 26.28%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-36ms      | [S0,MB0,B]  122-16-138ms   | [S0,MB4,F]  138-8-146ms    | [S0,MB1,B]  177-16-194ms   | [S0,MB5,F]  194-8-202ms    | [S0,MB2,B]  234-16-250ms   | [S0,MB6,F]  250-8-259ms    | [S0,MB3,B]  293-16-310ms   | [S0,MB7,F]  310-8-318ms    | [S0,MB4,B]  354-16-370ms   | [S0,MB5,B]  413-16-429ms   | [S0,MB6,B]  472-16-489ms   | [S0,MB7,B]  532-16-548ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-10-34ms     | [S1,MB2,F]  37-10-48ms     | [S1,MB0,B]  103-13-116ms   | [S1,MB3,F]  120-10-131ms   | [S1,MB1,B]  159-13-172ms   | [S1,MB4,F]  176-10-186ms   | [S1,MB2,B]  215-13-228ms   | [S1,MB5,F]  232-10-243ms   | [S1,MB3,B]  274-13-288ms   | [S1,MB6,F]  291-10-302ms   | [S1,MB4,B]  335-13-349ms   | [S1,MB7,F]  352-10-363ms   | [S1,MB5,B]  396-13-409ms   | [S1,MB6,B]  455-13-469ms   | [S1,MB7,B]  515-13-528ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  34-8-42ms      | [S2,MB0,B]  86-11-98ms     | [S2,MB2,F]  101-8-110ms    | [S2,MB1,B]  142-11-153ms   | [S2,MB3,F]  157-8-165ms    | [S2,MB2,B]  198-11-210ms   | [S2,MB4,F]  213-8-222ms    | [S2,MB3,B]  258-11-269ms   | [S2,MB5,F]  273-8-281ms    | [S2,MB4,B]  319-11-330ms   | [S2,MB6,F]  334-8-342ms    | [S2,MB5,B]  380-11-391ms   | [S2,MB7,F]  395-8-403ms    | [S2,MB6,B]  440-11-452ms   | [S2,MB7,B]  500-11-511ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  48-34-82ms     | [S3,MB1,F]  85-11-96ms     | [S3,MB1,B]  103-35-138ms   | [S3,MB2,F]  140-12-153ms   | [S3,MB2,B]  159-36-195ms   | [S3,MB3,F]  197-14-211ms   | [S3,MB3,B]  217-36-254ms   | [S3,MB4,F]  256-15-272ms   | [S3,MB4,B]  278-37-315ms   | [S3,MB5,F]  317-15-332ms   | [S3,MB5,B]  338-37-376ms   | [S3,MB6,F]  378-14-393ms   | [S3,MB6,B]  399-37-436ms   | [S3,MB7,F]  439-14-454ms   | [S3,MB7,B]  459-37-497ms  
[rank3]:2025-12-27 01:51:36,496 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p60_42_dm1/frozen_ratio_history/rank3/251227_0151_stage3_step400.svg
[rank2]:2025-12-27 01:51:36,519 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p60_42_dm1/frozen_params_histogram/251227_0151_rank2_stage2.svg
[rank2]:	> Counts Sum: 585, Total Sum: 1260 (46.43%), Ratio(%) per element: [94.28, 94.28, 94.28, 94.28, 94.28, 94.28, 94.28, 94.28, 94.28, 45.71, 45.71, 45.71, 45.71, 45.71, 45.71, 45.71, 45.71, 45.71, 45.71, 45.71, 45.71, 45.71, 45.71, 45.71, 45.71, 45.71, 45.71, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-12-27 01:51:36,521 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p60_42_dm1/frozen_params_histogram/251227_0151_rank0_stage0.svg
[rank0]:	> Counts Sum: 756, Total Sum: 1295 (58.38%), Ratio(%) per element: [0.0, 94.28, 94.28, 94.28, 94.28, 94.28, 94.28, 94.28, 94.28, 94.28, 74.28, 74.28, 74.28, 74.28, 74.28, 74.28, 74.28, 74.28, 74.28, 71.42, 71.42, 71.42, 71.42, 71.42, 71.42, 71.42, 71.42, 71.42, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-12-27 01:51:36,514 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p60_42_dm1/frozen_params_histogram/251227_0151_rank1_stage1.svg
[rank1]:	> Counts Sum: 747, Total Sum: 1575 (47.43%), Ratio(%) per element: [71.42, 71.42, 71.42, 71.42, 71.42, 71.42, 71.42, 71.42, 71.42, 71.42, 71.42, 71.42, 71.42, 71.42, 71.42, 71.42, 71.42, 71.42, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 45.71, 45.71, 45.71, 45.71, 45.71, 45.71, 45.71, 45.71, 45.71, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-27 01:51:36,629 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p60_42_dm1/frozen_params_histogram/251227_0151_rank3_stage3.svg
[rank3]:	> Counts Sum: 306, Total Sum: 1015 (30.15%), Ratio(%) per element: [48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-27 01:52:04,838 - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-12-27 01:52:05,061 - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-12-27 01:52:05,094 - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-12-27 01:52:05,075 - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-12-27 01:52:21,288 - Freezing Ratio: [Stage2] 0.75, Threshold: 5.4158e-01
[rank0]:2025-12-27 01:52:21,296 - Freezing Ratio: [Stage0] 0.73, Threshold: 2.9581e+00
[rank1]:2025-12-27 01:52:21,280 - Freezing Ratio: [Stage1] 0.80, Threshold: 2.8424e+00
[rank3]:2025-12-27 01:52:21,304 - Freezing Ratio: [Stage3] 0.62, Threshold: 4.2946e-01
[rank2]:2025-12-27 01:53:06,346 - Freezing Ratio: [Stage2] 0.25, Threshold: 8.5086e+00
[rank0]:2025-12-27 01:53:06,362 - Freezing Ratio: [Stage0] 0.73, Threshold: 9.3502e+00
[rank1]:2025-12-27 01:53:06,346 - Freezing Ratio: [Stage1] 0.80, Threshold: 8.7305e+00
[rank3]:2025-12-27 01:53:06,362 - Freezing Ratio: [Stage3] 0.00, Threshold: 6.9948e+00
[rank2]:2025-12-27 01:53:36,197 - Avg. fwd time: 7.9482 / Avg. bwd time: 15.4964 / Avg. batch time: 526.3228 (ms) / GPU bubble ratio: 64.36%
[rank1]:2025-12-27 01:53:36,219 - Avg. fwd time: 9.9751 / Avg. bwd time: 18.9591 / Avg. batch time: 559.7324 (ms) / GPU bubble ratio: 58.65%
[rank3]:2025-12-27 01:53:36,170 - Avg. fwd time: 14.0965 / Avg. bwd time: 40.2996 / Avg. batch time: 498.5854 (ms) / GPU bubble ratio: 12.72%
[rank0]:2025-12-27 01:53:36,245 - Avg. fwd time: 8.4178 / Avg. bwd time: 19.1205 / Avg. batch time: 591.8990 (ms) / GPU bubble ratio: 62.78%
[rank0]:2025-12-27 01:53:56,055 - Freezing Ratio: [Stage0] 0.73, Threshold: 8.7436e-01
[rank1]:2025-12-27 01:53:56,040 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.8208e+00
[rank3]:2025-12-27 01:53:56,063 - Freezing Ratio: [Stage3] 0.62, Threshold: 3.4274e-01
[rank2]:2025-12-27 01:53:56,047 - Freezing Ratio: [Stage2] 0.75, Threshold: 3.3515e-01
[rank3]:2025-12-27 01:54:41,355 - Freezing Ratio: [Stage3] 0.00, Threshold: 2.0823e+00
[rank2]:2025-12-27 01:54:41,339 - Freezing Ratio: [Stage2] 0.25, Threshold: 2.1883e+00
[rank1]:2025-12-27 01:54:41,339 - Freezing Ratio: [Stage1] 0.80, Threshold: 2.1789e+00
[rank0]:2025-12-27 01:54:41,355 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.9460e+00
[rank3]:2025-12-27 01:55:31,220 - Freezing Ratio: [Stage3] 0.62, Threshold: 6.7670e-01
[rank2]:2025-12-27 01:55:31,203 - Freezing Ratio: [Stage2] 0.75, Threshold: 6.0247e-01
[rank1]:2025-12-27 01:55:31,195 - Freezing Ratio: [Stage1] 0.80, Threshold: 2.7990e+00
[rank0]:2025-12-27 01:55:31,203 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-27 01:55:31,211 - Freezing Ratio: [Stage0] 0.73, Threshold: 2.1014e+00
[rank3]:2025-12-27 01:55:35,653 - Avg. fwd time: 14.0982 / Avg. bwd time: 40.3008 / Avg. batch time: 498.6082 (ms) / GPU bubble ratio: 12.72%
[rank2]:2025-12-27 01:55:35,674 - Avg. fwd time: 7.9530 / Avg. bwd time: 15.4572 / Avg. batch time: 526.2977 (ms) / GPU bubble ratio: 64.42%
[rank2]:2025-12-27 01:55:35,731 -  step: 450  loss: -8.0000  grad_norm:  0.1692  memory:  6.98GiB(14.69%)  tps: 6,843  tflops: 53.49  mfu: 17.15%
[rank1]:2025-12-27 01:55:35,697 - Avg. fwd time: 10.0103 / Avg. bwd time: 18.6589 / Avg. batch time: 559.4046 (ms) / GPU bubble ratio: 59.00%
[rank1]:2025-12-27 01:55:35,731 -  step: 450  loss: -8.0000  grad_norm:  0.1692  memory:  9.50GiB(19.99%)  tps: 6,843  tflops: 53.49  mfu: 17.14%
[rank0]:2025-12-27 01:55:35,722 - Avg. fwd time: 8.4356 / Avg. bwd time: 18.9782 / Avg. batch time: 591.4240 (ms) / GPU bubble ratio: 62.92%
[rank0]:2025-12-27 01:55:35,745 -  step: 450  loss: -8.0000  grad_norm:  0.1692  memory: 13.42GiB(28.26%)  tps: 6,843  tflops: 53.49  mfu: 17.14%
[rank3]:2025-12-27 01:55:35,747 -  step: 450  loss:  0.2519  grad_norm:  0.1692  memory: 16.39GiB(34.50%)  tps: 6,843  tflops: 53.49  mfu: 17.15%
[rank2]:2025-12-27 01:56:16,510 - Freezing Ratio: [Stage2] 0.25, Threshold: 3.8943e-01
[rank1]:2025-12-27 01:56:16,510 - Freezing Ratio: [Stage1] 0.80, Threshold: 2.2067e-01
[rank0]:2025-12-27 01:56:16,525 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.0387e+00
[rank3]:2025-12-27 01:56:16,525 - Freezing Ratio: [Stage3] 0.00, Threshold: 4.7054e-01
[rank2]:2025-12-27 01:57:06,292 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.0411e-01
[rank0]:2025-12-27 01:57:06,299 - Freezing Ratio: [Stage0] 0.73, Threshold: 8.9416e-01
[rank3]:2025-12-27 01:57:06,308 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.4602e-01
[rank1]:2025-12-27 01:57:06,284 - Freezing Ratio: [Stage1] 0.80, Threshold: 4.3249e-01
[rank3]:2025-12-27 01:57:33,537 - Avg. fwd time: 14.1057 / Avg. bwd time: 40.2461 / Avg. batch time: 498.2293 (ms) / GPU bubble ratio: 12.73%
[rank1]:2025-12-27 01:57:33,581 - Avg. fwd time: 10.0420 / Avg. bwd time: 18.3902 / Avg. batch time: 558.6638 (ms) / GPU bubble ratio: 59.29%
[rank2]:2025-12-27 01:57:33,558 - Avg. fwd time: 7.9642 / Avg. bwd time: 15.3732 / Avg. batch time: 525.8278 (ms) / GPU bubble ratio: 64.49%
[rank0]:2025-12-27 01:57:33,607 - Avg. fwd time: 8.4519 / Avg. bwd time: 18.8510 / Avg. batch time: 590.5522 (ms) / GPU bubble ratio: 63.01%
[rank3]:2025-12-27 01:57:51,700 - Freezing Ratio: [Stage3] 0.00, Threshold: 3.6726e-01
[rank1]:2025-12-27 01:57:51,684 - Freezing Ratio: [Stage1] 0.80, Threshold: 6.3506e-01
[rank2]:2025-12-27 01:57:51,684 - Freezing Ratio: [Stage2] 0.25, Threshold: 2.9339e-01
[rank0]:2025-12-27 01:57:51,700 - Freezing Ratio: [Stage0] 0.73, Threshold: 7.4581e-01
[rank2]:2025-12-27 01:58:41,610 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.3529e-01
[rank0]:2025-12-27 01:58:41,618 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.3175e+00
[rank1]:2025-12-27 01:58:41,602 - Freezing Ratio: [Stage1] 0.80, Threshold: 5.1766e-01
[rank3]:2025-12-27 01:58:41,626 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.0531e-01
[rank2]:2025-12-27 01:59:26,953 - Freezing Ratio: [Stage2] 0.25, Threshold: 1.4619e+00
[rank0]:2025-12-27 01:59:26,952 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-27 01:59:26,968 - Freezing Ratio: [Stage0] 0.73, Threshold: 2.1800e+00
[rank1]:2025-12-27 01:59:26,953 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.1707e+00
[rank3]:2025-12-27 01:59:26,969 - Freezing Ratio: [Stage3] 0.00, Threshold: 3.4067e-01
[rank1]:2025-12-27 01:59:31,917 - Avg. fwd time: 10.0706 / Avg. bwd time: 18.1484 / Avg. batch time: 558.1067 (ms) / GPU bubble ratio: 59.55%
[rank3]:2025-12-27 01:59:31,866 - Avg. fwd time: 14.1101 / Avg. bwd time: 40.2113 / Avg. batch time: 497.9860 (ms) / GPU bubble ratio: 12.73%
[rank2]:2025-12-27 01:59:31,894 - Avg. fwd time: 7.9729 / Avg. bwd time: 15.3093 / Avg. batch time: 525.5140 (ms) / GPU bubble ratio: 64.56%
[rank2]:2025-12-27 01:59:31,959 -  step: 500  loss: -8.0000  grad_norm:  0.1497  memory:  6.98GiB(14.69%)  tps: 6,936  tflops: 54.22  mfu: 17.38%
[rank0]:2025-12-27 01:59:31,944 - Avg. fwd time: 8.4668 / Avg. bwd time: 18.7368 / Avg. batch time: 589.8779 (ms) / GPU bubble ratio: 63.11%
[rank0]:2025-12-27 01:59:31,967 -  step: 500  loss: -8.0000  grad_norm:  0.1497  memory: 13.42GiB(28.26%)  tps: 6,936  tflops: 54.22  mfu: 17.38%
[rank1]:2025-12-27 01:59:31,953 -  step: 500  loss: -8.0000  grad_norm:  0.1497  memory:  9.50GiB(19.99%)  tps: 6,936  tflops: 54.22  mfu: 17.38%
[rank1]:2025-12-27 01:59:32,027 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p60_42_dm1/frozen_ratio_history/rank1/251227_0159_stage1_step500.svg
[rank3]:2025-12-27 01:59:31,975 -  step: 500  loss:  0.2382  grad_norm:  0.1497  memory: 16.39GiB(34.50%)  tps: 6,936  tflops: 54.22  mfu: 17.38%
[rank2]:2025-12-27 01:59:32,026 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p60_42_dm1/frozen_ratio_history/rank2/251227_0159_stage2_step500.svg
[rank0]:2025-12-27 01:59:32,026 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p60_42_dm1/frozen_ratio_history/rank0/251227_0159_stage0_step500.svg
[rank3]:2025-12-27 01:59:32,118 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p60_42_dm1/pipeline_schedule/251227_0159_step500_rank3.svg
[rank3]:			> Batch Time: 556.58 ms, GPU Bubble Ratio: 63.51%, 65.21%, 71.15%, 26.09%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-36ms      | [S0,MB0,B]  122-16-139ms   | [S0,MB4,F]  139-8-147ms    | [S0,MB1,B]  178-16-195ms   | [S0,MB5,F]  195-8-204ms    | [S0,MB2,B]  236-16-253ms   | [S0,MB6,F]  253-8-261ms    | [S0,MB3,B]  297-16-314ms   | [S0,MB7,F]  314-8-322ms    | [S0,MB4,B]  359-16-375ms   | [S0,MB5,B]  419-16-435ms   | [S0,MB6,B]  479-16-495ms   | [S0,MB7,B]  540-16-556ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-10-34ms     | [S1,MB2,F]  37-10-48ms     | [S1,MB0,B]  103-13-117ms   | [S1,MB3,F]  120-10-131ms   | [S1,MB1,B]  160-13-173ms   | [S1,MB4,F]  177-10-187ms   | [S1,MB2,B]  217-13-231ms   | [S1,MB5,F]  234-10-245ms   | [S1,MB3,B]  279-13-292ms   | [S1,MB6,F]  296-10-306ms   | [S1,MB4,B]  340-13-353ms   | [S1,MB7,F]  357-10-367ms   | [S1,MB5,B]  402-13-415ms   | [S1,MB6,B]  461-13-475ms   | [S1,MB7,B]  522-13-536ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  34-8-42ms      | [S2,MB0,B]  87-11-98ms     | [S2,MB2,F]  102-8-110ms    | [S2,MB1,B]  143-11-155ms   | [S2,MB3,F]  158-8-167ms    | [S2,MB2,B]  201-11-213ms   | [S2,MB4,F]  216-8-224ms    | [S2,MB3,B]  262-11-273ms   | [S2,MB5,F]  277-8-285ms    | [S2,MB4,B]  323-11-335ms   | [S2,MB6,F]  338-8-347ms    | [S2,MB5,B]  385-11-397ms   | [S2,MB7,F]  400-8-408ms    | [S2,MB6,B]  447-11-458ms   | [S2,MB7,B]  508-11-519ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  48-34-83ms     | [S3,MB1,F]  85-12-97ms     | [S3,MB1,B]  104-35-139ms   | [S3,MB2,F]  141-14-156ms   | [S3,MB2,B]  161-36-198ms   | [S3,MB3,F]  200-15-215ms   | [S3,MB3,B]  221-37-258ms   | [S3,MB4,F]  260-15-276ms   | [S3,MB4,B]  282-37-320ms   | [S3,MB5,F]  321-15-337ms   | [S3,MB5,B]  343-38-381ms   | [S3,MB6,F]  383-15-398ms   | [S3,MB6,B]  405-38-443ms   | [S3,MB7,F]  445-14-460ms   | [S3,MB7,B]  466-38-504ms  
[rank3]:2025-12-27 01:59:32,162 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p60_42_dm1/frozen_ratio_history/rank3/251227_0159_stage3_step500.svg
[rank2]:2025-12-27 01:59:32,178 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p60_42_dm1/frozen_params_histogram/251227_0159_rank2_stage2.svg
[rank2]:	> Counts Sum: 765, Total Sum: 1620 (47.22%), Ratio(%) per element: [95.55, 95.55, 95.55, 95.55, 95.55, 95.55, 95.55, 95.55, 95.55, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-12-27 01:59:32,182 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p60_42_dm1/frozen_params_histogram/251227_0159_rank0_stage0.svg
[rank0]:	> Counts Sum: 1026, Total Sum: 1665 (61.62%), Ratio(%) per element: [0.0, 95.55, 95.55, 95.55, 95.55, 95.55, 95.55, 95.55, 95.55, 95.55, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 77.77, 77.77, 77.77, 77.77, 77.77, 77.77, 77.77, 77.77, 77.77, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-12-27 01:59:32,173 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p60_42_dm1/frozen_params_histogram/251227_0159_rank1_stage1.svg
[rank1]:	> Counts Sum: 1107, Total Sum: 2025 (54.67%), Ratio(%) per element: [77.77, 77.77, 77.77, 77.77, 77.77, 77.77, 77.77, 77.77, 77.77, 77.77, 77.77, 77.77, 77.77, 77.77, 77.77, 77.77, 77.77, 77.77, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 57.77, 57.77, 57.77, 57.77, 57.77, 57.77, 57.77, 57.77, 57.77, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-27 01:59:32,296 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p60_42_dm1/frozen_params_histogram/251227_0159_rank3_stage3.svg
[rank3]:	> Counts Sum: 396, Total Sum: 1305 (30.34%), Ratio(%) per element: [48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-12-27 02:00:17,110 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.7750e+00
[rank2]:2025-12-27 02:00:17,118 - Freezing Ratio: [Stage2] 0.75, Threshold: 2.0692e-01
[rank0]:2025-12-27 02:00:17,126 - Freezing Ratio: [Stage0] 0.73, Threshold: 8.5805e-01
[rank3]:2025-12-27 02:00:17,134 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.9665e-01
[rank2]:2025-12-27 02:01:02,508 - Freezing Ratio: [Stage2] 0.25, Threshold: 2.3028e+00
[rank1]:2025-12-27 02:01:02,508 - Freezing Ratio: [Stage1] 0.80, Threshold: 3.1215e+00
[rank3]:2025-12-27 02:01:02,523 - Freezing Ratio: [Stage3] 0.00, Threshold: 2.3621e+00
[rank0]:2025-12-27 02:01:02,523 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.9158e+00
[rank1]:2025-12-27 02:01:32,403 - Avg. fwd time: 10.0966 / Avg. bwd time: 17.9297 / Avg. batch time: 558.0748 (ms) / GPU bubble ratio: 59.82%
[rank3]:2025-12-27 02:01:32,352 - Avg. fwd time: 14.1121 / Avg. bwd time: 40.2327 / Avg. batch time: 498.1738 (ms) / GPU bubble ratio: 12.73%
[rank2]:2025-12-27 02:01:32,380 - Avg. fwd time: 7.9751 / Avg. bwd time: 15.2953 / Avg. batch time: 525.7020 (ms) / GPU bubble ratio: 64.59%
[rank0]:2025-12-27 02:01:32,429 - Avg. fwd time: 8.4804 / Avg. bwd time: 18.6334 / Avg. batch time: 589.7408 (ms) / GPU bubble ratio: 63.22%
[rank1]:2025-12-27 02:01:52,431 - Freezing Ratio: [Stage1] 0.80, Threshold: 8.9895e-01
[rank2]:2025-12-27 02:01:52,439 - Freezing Ratio: [Stage2] 0.75, Threshold: 8.2504e-02
[rank0]:2025-12-27 02:01:52,446 - Freezing Ratio: [Stage0] 0.73, Threshold: 8.6287e-01
[rank3]:2025-12-27 02:01:52,454 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.6009e-01
[rank1]:2025-12-27 02:02:37,777 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.7444e+00
[rank3]:2025-12-27 02:02:37,793 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.1812e+00
[rank2]:2025-12-27 02:02:37,777 - Freezing Ratio: [Stage2] 0.25, Threshold: 1.4941e+00
[rank0]:2025-12-27 02:02:37,792 - Freezing Ratio: [Stage0] 0.73, Threshold: 7.7755e-01
[rank1]:2025-12-27 02:03:27,611 - Freezing Ratio: [Stage1] 0.80, Threshold: 6.6699e-01
[rank3]:2025-12-27 02:03:27,636 - Freezing Ratio: [Stage3] 0.62, Threshold: 2.0700e-01
[rank0]:2025-12-27 02:03:27,620 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-27 02:03:27,627 - Freezing Ratio: [Stage0] 0.73, Threshold: 6.6154e-01
[rank2]:2025-12-27 02:03:27,620 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.6940e-01
[rank3]:2025-12-27 02:03:32,131 - Avg. fwd time: 14.1145 / Avg. bwd time: 40.2396 / Avg. batch time: 498.2490 (ms) / GPU bubble ratio: 12.73%
[rank0]:2025-12-27 02:03:32,203 - Avg. fwd time: 8.4929 / Avg. bwd time: 18.5393 / Avg. batch time: 589.4915 (ms) / GPU bubble ratio: 63.31%
[rank2]:2025-12-27 02:03:32,153 - Avg. fwd time: 7.9786 / Avg. bwd time: 15.2720 / Avg. batch time: 525.7483 (ms) / GPU bubble ratio: 64.62%
[rank2]:2025-12-27 02:03:32,212 -  step: 550  loss: -8.0000  grad_norm:  0.2368  memory:  6.98GiB(14.69%)  tps: 6,820  tflops: 53.31  mfu: 17.09%
[rank1]:2025-12-27 02:03:32,176 - Avg. fwd time: 10.1203 / Avg. bwd time: 17.7307 / Avg. batch time: 557.9208 (ms) / GPU bubble ratio: 60.06%
[rank1]:2025-12-27 02:03:32,212 -  step: 550  loss: -8.0000  grad_norm:  0.2368  memory:  9.50GiB(19.99%)  tps: 6,819  tflops: 53.31  mfu: 17.09%
[rank3]:2025-12-27 02:03:32,228 -  step: 550  loss:  0.2439  grad_norm:  0.2368  memory: 16.39GiB(34.50%)  tps: 6,820  tflops: 53.31  mfu: 17.09%
[rank0]:2025-12-27 02:03:32,226 -  step: 550  loss: -8.0000  grad_norm:  0.2368  memory: 13.42GiB(28.26%)  tps: 6,819  tflops: 53.31  mfu: 17.09%
[rank1]:2025-12-27 02:04:13,192 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.8170e+00
[rank3]:2025-12-27 02:04:13,207 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.1487e+00
[rank2]:2025-12-27 02:04:13,192 - Freezing Ratio: [Stage2] 0.25, Threshold: 1.9127e+00
[rank0]:2025-12-27 02:04:13,207 - Freezing Ratio: [Stage0] 0.73, Threshold: 7.1422e-01
[rank1]:2025-12-27 02:05:03,041 - Freezing Ratio: [Stage1] 0.80, Threshold: 2.5854e+00
[rank3]:2025-12-27 02:05:03,065 - Freezing Ratio: [Stage3] 0.62, Threshold: 2.8506e-01
[rank2]:2025-12-27 02:05:03,048 - Freezing Ratio: [Stage2] 0.75, Threshold: 4.5372e-01
[rank0]:2025-12-27 02:05:03,056 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1637e+00
[rank2]:2025-12-27 02:05:30,163 - Avg. fwd time: 7.9870 / Avg. bwd time: 15.2106 / Avg. batch time: 525.3921 (ms) / GPU bubble ratio: 64.68%
[rank1]:2025-12-27 02:05:30,187 - Avg. fwd time: 10.1420 / Avg. bwd time: 17.5491 / Avg. batch time: 557.3828 (ms) / GPU bubble ratio: 60.26%
[rank3]:2025-12-27 02:05:30,140 - Avg. fwd time: 14.1204 / Avg. bwd time: 40.1973 / Avg. batch time: 497.9582 (ms) / GPU bubble ratio: 12.74%
[rank0]:2025-12-27 02:05:30,215 - Avg. fwd time: 8.5042 / Avg. bwd time: 18.4533 / Avg. batch time: 588.8671 (ms) / GPU bubble ratio: 63.38%
[rank2]:2025-12-27 02:05:48,360 - Freezing Ratio: [Stage2] 0.25, Threshold: 8.5907e-01
[rank0]:2025-12-27 02:05:48,375 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.6627e+00
[rank1]:2025-12-27 02:05:48,360 - Freezing Ratio: [Stage1] 0.80, Threshold: 4.4933e-01
[rank3]:2025-12-27 02:05:48,375 - Freezing Ratio: [Stage3] 0.00, Threshold: 6.5410e-01
[rank1]:2025-12-27 02:06:38,153 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.7707e-01
[rank3]:2025-12-27 02:06:38,176 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.4905e-01
[rank2]:2025-12-27 02:06:38,160 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.1984e-01
[rank0]:2025-12-27 02:06:38,168 - Freezing Ratio: [Stage0] 0.73, Threshold: 2.0956e+00
[rank2]:2025-12-27 02:07:23,393 - Freezing Ratio: [Stage2] 0.25, Threshold: 5.6887e-01
[rank0]:2025-12-27 02:07:23,391 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-27 02:07:23,408 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.3338e+00
[rank1]:2025-12-27 02:07:23,393 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.1754e+00
[rank3]:2025-12-27 02:07:23,409 - Freezing Ratio: [Stage3] 0.00, Threshold: 2.7660e-01
[rank2]:2025-12-27 02:07:28,387 - Avg. fwd time: 7.9935 / Avg. bwd time: 15.1638 / Avg. batch time: 525.1259 (ms) / GPU bubble ratio: 64.72%
[rank3]:2025-12-27 02:07:28,358 - Avg. fwd time: 14.1213 / Avg. bwd time: 40.1696 / Avg. batch time: 497.7432 (ms) / GPU bubble ratio: 12.74%
[rank1]:2025-12-27 02:07:28,411 - Avg. fwd time: 10.1620 / Avg. bwd time: 17.3827 / Avg. batch time: 556.9494 (ms) / GPU bubble ratio: 60.44%
[rank1]:2025-12-27 02:07:28,447 -  step: 600  loss: -8.0000  grad_norm:  0.1788  memory:  9.50GiB(19.99%)  tps: 6,935  tflops: 54.22  mfu: 17.38%
[rank2]:2025-12-27 02:07:28,454 -  step: 600  loss: -8.0000  grad_norm:  0.1788  memory:  6.98GiB(14.69%)  tps: 6,935  tflops: 54.22  mfu: 17.38%
[rank3]:2025-12-27 02:07:28,469 -  step: 600  loss:  0.2385  grad_norm:  0.1788  memory: 16.39GiB(34.50%)  tps: 6,935  tflops: 54.22  mfu: 17.38%
[rank0]:2025-12-27 02:07:28,438 - Avg. fwd time: 8.5143 / Avg. bwd time: 18.3746 / Avg. batch time: 588.3526 (ms) / GPU bubble ratio: 63.44%
[rank0]:2025-12-27 02:07:28,462 -  step: 600  loss: -8.0000  grad_norm:  0.1788  memory: 13.42GiB(28.26%)  tps: 6,935  tflops: 54.22  mfu: 17.38%
[rank0]:2025-12-27 02:07:28,522 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p60_42_dm1/frozen_ratio_history/rank0/251227_0207_stage0_step600.svg
[rank1]:2025-12-27 02:07:28,524 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p60_42_dm1/frozen_ratio_history/rank1/251227_0207_stage1_step600.svg
[rank2]:2025-12-27 02:07:28,525 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p60_42_dm1/frozen_ratio_history/rank2/251227_0207_stage2_step600.svg
[rank3]:2025-12-27 02:07:28,606 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p60_42_dm1/pipeline_schedule/251227_0207_step600_rank3.svg
[rank3]:			> Batch Time: 548.59 ms, GPU Bubble Ratio: 63.00%, 64.75%, 70.82%, 26.12%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-36ms      | [S0,MB0,B]  122-16-138ms   | [S0,MB4,F]  138-8-147ms    | [S0,MB1,B]  177-16-194ms   | [S0,MB5,F]  194-8-202ms    | [S0,MB2,B]  233-16-250ms   | [S0,MB6,F]  250-8-258ms    | [S0,MB3,B]  293-16-309ms   | [S0,MB7,F]  310-8-318ms    | [S0,MB4,B]  354-16-370ms   | [S0,MB5,B]  413-16-429ms   | [S0,MB6,B]  472-16-488ms   | [S0,MB7,B]  532-16-548ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-10-34ms     | [S1,MB2,F]  37-10-47ms     | [S1,MB0,B]  103-13-116ms   | [S1,MB3,F]  120-10-131ms   | [S1,MB1,B]  158-13-172ms   | [S1,MB4,F]  175-10-186ms   | [S1,MB2,B]  214-13-228ms   | [S1,MB5,F]  231-10-242ms   | [S1,MB3,B]  274-13-287ms   | [S1,MB6,F]  291-10-302ms   | [S1,MB4,B]  335-13-349ms   | [S1,MB7,F]  352-10-362ms   | [S1,MB5,B]  396-13-409ms   | [S1,MB6,B]  455-13-468ms   | [S1,MB7,B]  515-13-528ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  34-8-42ms      | [S2,MB0,B]  86-11-98ms     | [S2,MB2,F]  101-8-110ms    | [S2,MB1,B]  141-11-153ms   | [S2,MB3,F]  157-8-165ms    | [S2,MB2,B]  198-11-209ms   | [S2,MB4,F]  213-8-221ms    | [S2,MB3,B]  257-11-269ms   | [S2,MB5,F]  273-8-281ms    | [S2,MB4,B]  318-11-330ms   | [S2,MB6,F]  333-8-342ms    | [S2,MB5,B]  379-11-391ms   | [S2,MB7,F]  394-8-403ms    | [S2,MB6,B]  440-11-452ms   | [S2,MB7,B]  500-11-511ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  48-34-82ms     | [S3,MB1,F]  84-11-96ms     | [S3,MB1,B]  102-35-138ms   | [S3,MB2,F]  140-12-152ms   | [S3,MB2,B]  158-35-194ms   | [S3,MB3,F]  196-14-211ms   | [S3,MB3,B]  217-36-254ms   | [S3,MB4,F]  256-15-271ms   | [S3,MB4,B]  277-37-315ms   | [S3,MB5,F]  317-15-332ms   | [S3,MB5,B]  338-37-376ms   | [S3,MB6,F]  378-14-393ms   | [S3,MB6,B]  399-37-436ms   | [S3,MB7,F]  438-14-453ms   | [S3,MB7,B]  459-37-497ms  
[rank2]:2025-12-27 02:07:28,683 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p60_42_dm1/frozen_params_histogram/251227_0207_rank2_stage2.svg
[rank2]:	> Counts Sum: 945, Total Sum: 1980 (47.73%), Ratio(%) per element: [96.36, 96.36, 96.36, 96.36, 96.36, 96.36, 96.36, 96.36, 96.36, 47.27, 47.27, 47.27, 47.27, 47.27, 47.27, 47.27, 47.27, 47.27, 47.27, 47.27, 47.27, 47.27, 47.27, 47.27, 47.27, 47.27, 47.27, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-27 02:07:28,651 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p60_42_dm1/frozen_ratio_history/rank3/251227_0207_stage3_step600.svg
[rank0]:2025-12-27 02:07:28,673 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p60_42_dm1/frozen_params_histogram/251227_0207_rank0_stage0.svg
[rank0]:	> Counts Sum: 1296, Total Sum: 2035 (63.69%), Ratio(%) per element: [0.0, 96.36, 96.36, 96.36, 96.36, 96.36, 96.36, 96.36, 96.36, 96.36, 83.63, 83.63, 83.63, 83.63, 83.63, 83.63, 83.63, 83.63, 83.63, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-12-27 02:07:28,667 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p60_42_dm1/frozen_params_histogram/251227_0207_rank1_stage1.svg
[rank1]:	> Counts Sum: 1467, Total Sum: 2475 (59.27%), Ratio(%) per element: [81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 67.27, 67.27, 67.27, 67.27, 67.27, 67.27, 67.27, 67.27, 67.27, 65.45, 65.45, 65.45, 65.45, 65.45, 65.45, 65.45, 65.45, 65.45, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-27 02:07:28,782 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p60_42_dm1/frozen_params_histogram/251227_0207_rank3_stage3.svg
[rank3]:	> Counts Sum: 486, Total Sum: 1595 (30.47%), Ratio(%) per element: [49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-12-27 02:08:13,538 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.3017e-01
[rank3]:2025-12-27 02:08:13,554 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.4468e-01
[rank0]:2025-12-27 02:08:13,546 - Freezing Ratio: [Stage0] 0.73, Threshold: 9.5119e-01
[rank1]:2025-12-27 02:08:13,531 - Freezing Ratio: [Stage1] 0.80, Threshold: 7.2756e-01
[rank1]:2025-12-27 02:08:58,643 - Freezing Ratio: [Stage1] 0.80, Threshold: 7.9330e-01
[rank2]:2025-12-27 02:08:58,643 - Freezing Ratio: [Stage2] 0.25, Threshold: 6.2352e-01
[rank3]:2025-12-27 02:08:58,659 - Freezing Ratio: [Stage3] 0.00, Threshold: 4.2030e-01
[rank0]:2025-12-27 02:08:58,659 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.6319e+00
[rank2]:2025-12-27 02:09:28,520 - Avg. fwd time: 7.9945 / Avg. bwd time: 15.1578 / Avg. batch time: 525.2365 (ms) / GPU bubble ratio: 64.74%
[rank3]:2025-12-27 02:09:28,491 - Avg. fwd time: 14.1187 / Avg. bwd time: 40.1853 / Avg. batch time: 497.8486 (ms) / GPU bubble ratio: 12.74%
[rank0]:2025-12-27 02:09:28,573 - Avg. fwd time: 8.5236 / Avg. bwd time: 18.3022 / Avg. batch time: 588.2354 (ms) / GPU bubble ratio: 63.52%
[rank1]:2025-12-27 02:09:28,545 - Avg. fwd time: 10.1803 / Avg. bwd time: 17.2296 / Avg. batch time: 556.9067 (ms) / GPU bubble ratio: 60.63%
[rank1]:2025-12-27 02:09:48,417 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.3659e+00
[rank2]:2025-12-27 02:09:48,424 - Freezing Ratio: [Stage2] 0.75, Threshold: 3.0269e-01
[rank3]:2025-12-27 02:09:48,440 - Freezing Ratio: [Stage3] 0.62, Threshold: 3.0001e-01
[rank0]:2025-12-27 02:09:48,432 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1819e+00
[rank1]:2025-12-27 02:10:33,876 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.3128e+00
[rank2]:2025-12-27 02:10:33,876 - Freezing Ratio: [Stage2] 0.25, Threshold: 1.4014e+00
[rank3]:2025-12-27 02:10:33,892 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.1708e+00
[rank0]:2025-12-27 02:10:33,891 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.8774e+00
[rank2]:2025-12-27 02:11:23,783 - Freezing Ratio: [Stage2] 0.75, Threshold: 4.0493e-01
[rank1]:2025-12-27 02:11:23,776 - Freezing Ratio: [Stage1] 0.80, Threshold: 5.9916e-01
[rank0]:2025-12-27 02:11:23,784 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-27 02:11:23,791 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.5021e+00
[rank3]:2025-12-27 02:11:23,800 - Freezing Ratio: [Stage3] 0.62, Threshold: 4.5229e-01
[rank2]:2025-12-27 02:11:28,276 - Avg. fwd time: 7.9967 / Avg. bwd time: 15.1434 / Avg. batch time: 525.2946 (ms) / GPU bubble ratio: 64.76%
[rank3]:2025-12-27 02:11:28,252 - Avg. fwd time: 14.1205 / Avg. bwd time: 40.1929 / Avg. batch time: 497.9248 (ms) / GPU bubble ratio: 12.74%
[rank0]:2025-12-27 02:11:28,328 - Avg. fwd time: 8.5322 / Avg. bwd time: 18.2353 / Avg. batch time: 588.0828 (ms) / GPU bubble ratio: 63.59%
[rank0]:2025-12-27 02:11:28,352 -  step: 650  loss: -8.0000  grad_norm:  0.1271  memory: 13.42GiB(28.26%)  tps: 6,830  tflops: 53.39  mfu: 17.11%
[rank2]:2025-12-27 02:11:28,337 -  step: 650  loss: -8.0000  grad_norm:  0.1271  memory:  6.98GiB(14.69%)  tps: 6,830  tflops: 53.39  mfu: 17.11%
[rank3]:2025-12-27 02:11:28,353 -  step: 650  loss:  0.2522  grad_norm:  0.1271  memory: 16.39GiB(34.50%)  tps: 6,830  tflops: 53.39  mfu: 17.11%
[rank1]:2025-12-27 02:11:28,300 - Avg. fwd time: 10.1972 / Avg. bwd time: 17.0885 / Avg. batch time: 556.8233 (ms) / GPU bubble ratio: 60.80%
[rank1]:2025-12-27 02:11:28,337 -  step: 650  loss: -8.0000  grad_norm:  0.1271  memory:  9.50GiB(19.99%)  tps: 6,830  tflops: 53.39  mfu: 17.11%
[rank1]:2025-12-27 02:12:09,124 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.4901e+00
[rank3]:2025-12-27 02:12:09,140 - Freezing Ratio: [Stage3] 0.00, Threshold: 2.9478e+00
[rank2]:2025-12-27 02:12:09,125 - Freezing Ratio: [Stage2] 0.25, Threshold: 2.4042e+00
[rank0]:2025-12-27 02:12:09,140 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.8814e+00
[rank0]:2025-12-27 02:12:58,772 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.9672e+00
[rank1]:2025-12-27 02:12:58,756 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.8186e+00
[rank2]:2025-12-27 02:12:58,764 - Freezing Ratio: [Stage2] 0.75, Threshold: 3.8603e-01
[rank3]:2025-12-27 02:12:58,780 - Freezing Ratio: [Stage3] 0.62, Threshold: 4.1628e-01
[rank3]:2025-12-27 02:13:25,855 - Avg. fwd time: 14.1202 / Avg. bwd time: 40.1551 / Avg. batch time: 497.6198 (ms) / GPU bubble ratio: 12.74%
[rank1]:2025-12-27 02:13:25,904 - Avg. fwd time: 10.2126 / Avg. bwd time: 16.9574 / Avg. batch time: 556.3347 (ms) / GPU bubble ratio: 60.93%
[rank2]:2025-12-27 02:13:25,879 - Avg. fwd time: 8.0028 / Avg. bwd time: 15.0955 / Avg. batch time: 524.9379 (ms) / GPU bubble ratio: 64.80%
[rank0]:2025-12-27 02:13:25,933 - Avg. fwd time: 8.5400 / Avg. bwd time: 18.1732 / Avg. batch time: 587.5317 (ms) / GPU bubble ratio: 63.63%
[rank1]:2025-12-27 02:13:43,938 - Freezing Ratio: [Stage1] 0.80, Threshold: 2.6221e+00
[rank2]:2025-12-27 02:13:43,937 - Freezing Ratio: [Stage2] 0.25, Threshold: 2.2848e+00
[rank3]:2025-12-27 02:13:43,953 - Freezing Ratio: [Stage3] 0.00, Threshold: 2.3812e+00
[rank0]:2025-12-27 02:13:43,953 - Freezing Ratio: [Stage0] 0.73, Threshold: 2.2991e+00
[rank2]:2025-12-27 02:14:33,522 - Freezing Ratio: [Stage2] 0.75, Threshold: 6.3199e-02
[rank3]:2025-12-27 02:14:33,538 - Freezing Ratio: [Stage3] 0.62, Threshold: 7.2922e-02
[rank0]:2025-12-27 02:14:33,529 - Freezing Ratio: [Stage0] 0.73, Threshold: 6.3871e-01
[rank1]:2025-12-27 02:14:33,514 - Freezing Ratio: [Stage1] 0.80, Threshold: 4.2319e-01
[rank0]:2025-12-27 02:15:18,526 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-27 02:15:18,542 - Freezing Ratio: [Stage0] 0.73, Threshold: 2.0131e+00
[rank1]:2025-12-27 02:15:18,527 - Freezing Ratio: [Stage1] 0.80, Threshold: 3.5132e+00
[rank2]:2025-12-27 02:15:18,527 - Freezing Ratio: [Stage2] 0.25, Threshold: 4.2133e+00
[rank3]:2025-12-27 02:15:18,543 - Freezing Ratio: [Stage3] 0.00, Threshold: 4.4890e+00
[rank3]:2025-12-27 02:15:23,392 - Avg. fwd time: 14.1173 / Avg. bwd time: 40.1216 / Avg. batch time: 497.3292 (ms) / GPU bubble ratio: 12.75%
[rank1]:2025-12-27 02:15:23,447 - Avg. fwd time: 10.2263 / Avg. bwd time: 16.8351 / Avg. batch time: 555.8793 (ms) / GPU bubble ratio: 61.05%
[rank2]:2025-12-27 02:15:23,422 - Avg. fwd time: 8.0072 / Avg. bwd time: 15.0585 / Avg. batch time: 524.6059 (ms) / GPU bubble ratio: 64.83%
[rank2]:2025-12-27 02:15:23,491 -  step: 700  loss: -8.0000  grad_norm:  0.1843  memory:  6.98GiB(14.69%)  tps: 6,967  tflops: 54.47  mfu: 17.46%
[rank3]:2025-12-27 02:15:23,508 -  step: 700  loss:  0.2104  grad_norm:  0.1843  memory: 16.39GiB(34.50%)  tps: 6,967  tflops: 54.47  mfu: 17.46%
[rank0]:2025-12-27 02:15:23,475 - Avg. fwd time: 8.5468 / Avg. bwd time: 18.1149 / Avg. batch time: 587.0164 (ms) / GPU bubble ratio: 63.66%
[rank0]:2025-12-27 02:15:23,499 -  step: 700  loss: -8.0000  grad_norm:  0.1843  memory: 13.42GiB(28.26%)  tps: 6,968  tflops: 54.47  mfu: 17.46%
[rank1]:2025-12-27 02:15:23,485 -  step: 700  loss: -8.0000  grad_norm:  0.1843  memory:  9.50GiB(19.99%)  tps: 6,968  tflops: 54.47  mfu: 17.46%
[rank1]:2025-12-27 02:15:23,563 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p60_42_dm1/frozen_ratio_history/rank1/251227_0215_stage1_step700.svg
[rank2]:2025-12-27 02:15:23,562 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p60_42_dm1/frozen_ratio_history/rank2/251227_0215_stage2_step700.svg
[rank0]:2025-12-27 02:15:23,564 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p60_42_dm1/frozen_ratio_history/rank0/251227_0215_stage0_step700.svg
[rank3]:2025-12-27 02:15:23,648 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p60_42_dm1/pipeline_schedule/251227_0215_step700_rank3.svg
[rank3]:			> Batch Time: 548.56 ms, GPU Bubble Ratio: 63.03%, 64.77%, 70.78%, 26.12%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-36ms      | [S0,MB0,B]  122-16-138ms   | [S0,MB4,F]  138-8-147ms    | [S0,MB1,B]  177-16-194ms   | [S0,MB5,F]  194-8-202ms    | [S0,MB2,B]  234-16-251ms   | [S0,MB6,F]  251-8-259ms    | [S0,MB3,B]  294-16-310ms   | [S0,MB7,F]  311-8-319ms    | [S0,MB4,B]  354-16-371ms   | [S0,MB5,B]  413-16-430ms   | [S0,MB6,B]  472-16-488ms   | [S0,MB7,B]  532-16-548ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-10-20ms      | [S1,MB1,F]  23-10-34ms     | [S1,MB2,F]  37-10-47ms     | [S1,MB0,B]  103-13-117ms   | [S1,MB3,F]  120-10-131ms   | [S1,MB1,B]  159-13-172ms   | [S1,MB4,F]  176-10-186ms   | [S1,MB2,B]  216-13-229ms   | [S1,MB5,F]  233-10-243ms   | [S1,MB3,B]  275-13-288ms   | [S1,MB6,F]  292-10-303ms   | [S1,MB4,B]  336-13-349ms   | [S1,MB7,F]  353-10-363ms   | [S1,MB5,B]  396-13-410ms   | [S1,MB6,B]  455-13-468ms   | [S1,MB7,B]  515-13-528ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  34-8-42ms      | [S2,MB0,B]  86-11-98ms     | [S2,MB2,F]  101-8-110ms    | [S2,MB1,B]  142-11-153ms   | [S2,MB3,F]  157-8-165ms    | [S2,MB2,B]  199-11-211ms   | [S2,MB4,F]  214-8-222ms    | [S2,MB3,B]  258-11-270ms   | [S2,MB5,F]  273-8-282ms    | [S2,MB4,B]  319-11-331ms   | [S2,MB6,F]  334-8-342ms    | [S2,MB5,B]  380-11-391ms   | [S2,MB7,F]  395-8-403ms    | [S2,MB6,B]  440-11-451ms   | [S2,MB7,B]  500-11-511ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  48-34-82ms     | [S3,MB1,F]  85-11-96ms     | [S3,MB1,B]  103-35-138ms   | [S3,MB2,F]  140-13-153ms   | [S3,MB2,B]  159-36-195ms   | [S3,MB3,F]  197-14-212ms   | [S3,MB3,B]  217-36-254ms   | [S3,MB4,F]  257-15-272ms   | [S3,MB4,B]  278-37-315ms   | [S3,MB5,F]  317-15-333ms   | [S3,MB5,B]  338-37-376ms   | [S3,MB6,F]  378-15-393ms   | [S3,MB6,B]  399-37-436ms   | [S3,MB7,F]  438-14-453ms   | [S3,MB7,B]  459-37-497ms  
[rank3]:2025-12-27 02:15:23,695 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p60_42_dm1/frozen_ratio_history/rank3/251227_0215_stage3_step700.svg
[rank0]:2025-12-27 02:15:23,717 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p60_42_dm1/frozen_params_histogram/251227_0215_rank0_stage0.svg
[rank0]:	> Counts Sum: 1566, Total Sum: 2405 (65.11%), Ratio(%) per element: [0.0, 96.92, 96.92, 96.92, 96.92, 96.92, 96.92, 96.92, 96.92, 96.92, 86.15, 86.15, 86.15, 86.15, 86.15, 86.15, 86.15, 86.15, 86.15, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-12-27 02:15:23,707 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p60_42_dm1/frozen_params_histogram/251227_0215_rank1_stage1.svg
[rank1]:	> Counts Sum: 1827, Total Sum: 2925 (62.46%), Ratio(%) per element: [84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 72.3, 72.3, 72.3, 72.3, 72.3, 72.3, 72.3, 72.3, 72.3, 70.76, 70.76, 70.76, 70.76, 70.76, 70.76, 70.76, 70.76, 70.76, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-12-27 02:15:23,710 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p60_42_dm1/frozen_params_histogram/251227_0215_rank2_stage2.svg
[rank2]:	> Counts Sum: 1125, Total Sum: 2340 (48.08%), Ratio(%) per element: [96.92, 96.92, 96.92, 96.92, 96.92, 96.92, 96.92, 96.92, 96.92, 47.69, 47.69, 47.69, 47.69, 47.69, 47.69, 47.69, 47.69, 47.69, 47.69, 47.69, 47.69, 47.69, 47.69, 47.69, 47.69, 47.69, 47.69, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-27 02:15:23,826 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p60_42_dm1/frozen_params_histogram/251227_0215_rank3_stage3.svg
[rank3]:	> Counts Sum: 576, Total Sum: 1885 (30.56%), Ratio(%) per element: [49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-12-27 02:16:08,377 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.2780e+00
[rank1]:2025-12-27 02:16:08,361 - Freezing Ratio: [Stage1] 0.80, Threshold: 4.5862e-01
[rank2]:2025-12-27 02:16:08,369 - Freezing Ratio: [Stage2] 0.75, Threshold: 6.6215e-02
[rank3]:2025-12-27 02:16:08,384 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.0403e-01
[rank2]:2025-12-27 02:16:53,515 - Freezing Ratio: [Stage2] 0.25, Threshold: 3.2645e-01
[rank3]:2025-12-27 02:16:53,531 - Freezing Ratio: [Stage3] 0.00, Threshold: 5.1862e-01
[rank0]:2025-12-27 02:16:53,531 - Freezing Ratio: [Stage0] 0.73, Threshold: 7.8317e-01
[rank1]:2025-12-27 02:16:53,515 - Freezing Ratio: [Stage1] 0.80, Threshold: 2.4334e-01
[rank3]:2025-12-27 02:17:23,166 - Avg. fwd time: 14.1137 / Avg. bwd time: 40.1302 / Avg. batch time: 497.3696 (ms) / GPU bubble ratio: 12.75%
[rank1]:2025-12-27 02:17:23,221 - Avg. fwd time: 10.2393 / Avg. bwd time: 16.7212 / Avg. batch time: 555.8121 (ms) / GPU bubble ratio: 61.19%
[rank2]:2025-12-27 02:17:23,196 - Avg. fwd time: 8.0070 / Avg. bwd time: 15.0563 / Avg. batch time: 524.6537 (ms) / GPU bubble ratio: 64.83%
[rank0]:2025-12-27 02:17:23,250 - Avg. fwd time: 8.5530 / Avg. bwd time: 18.0606 / Avg. batch time: 586.8938 (ms) / GPU bubble ratio: 63.72%
[rank1]:2025-12-27 02:17:43,145 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.2671e+00
[rank2]:2025-12-27 02:17:43,153 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.1395e-01
[rank3]:2025-12-27 02:17:43,169 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.3279e-01
[rank0]:2025-12-27 02:17:43,161 - Freezing Ratio: [Stage0] 0.73, Threshold: 3.8788e-01
[rank2]:2025-12-27 02:18:28,344 - Freezing Ratio: [Stage2] 0.25, Threshold: 2.2778e+00
[rank3]:2025-12-27 02:18:28,360 - Freezing Ratio: [Stage3] 0.00, Threshold: 2.4934e+00
[rank0]:2025-12-27 02:18:28,360 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.4163e+00
[rank1]:2025-12-27 02:18:28,344 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.5623e+00
[rank0]:2025-12-27 02:19:18,043 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-27 02:19:18,050 - Freezing Ratio: [Stage0] 0.73, Threshold: 9.5097e-01
[rank1]:2025-12-27 02:19:18,035 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.7220e+00
[rank2]:2025-12-27 02:19:18,043 - Freezing Ratio: [Stage2] 0.75, Threshold: 3.1484e-01
[rank3]:2025-12-27 02:19:18,059 - Freezing Ratio: [Stage3] 0.62, Threshold: 3.9494e-01
[rank3]:2025-12-27 02:19:22,520 - Avg. fwd time: 14.1127 / Avg. bwd time: 40.1324 / Avg. batch time: 497.3789 (ms) / GPU bubble ratio: 12.75%
[rank1]:2025-12-27 02:19:22,570 - Avg. fwd time: 10.2516 / Avg. bwd time: 16.6152 / Avg. batch time: 555.7013 (ms) / GPU bubble ratio: 61.32%
[rank2]:2025-12-27 02:19:22,544 - Avg. fwd time: 8.0080 / Avg. bwd time: 15.0469 / Avg. batch time: 524.6497 (ms) / GPU bubble ratio: 64.85%
[rank2]:2025-12-27 02:19:22,609 -  step: 750  loss: -8.0000  grad_norm:  0.0946  memory:  6.98GiB(14.69%)  tps: 6,852  tflops: 53.56  mfu: 17.17%
[rank3]:2025-12-27 02:19:22,624 -  step: 750  loss:  0.2566  grad_norm:  0.0946  memory: 16.39GiB(34.50%)  tps: 6,852  tflops: 53.57  mfu: 17.17%
[rank0]:2025-12-27 02:19:22,600 - Avg. fwd time: 8.5592 / Avg. bwd time: 18.0102 / Avg. batch time: 586.7320 (ms) / GPU bubble ratio: 63.77%
[rank0]:2025-12-27 02:19:22,623 -  step: 750  loss: -8.0000  grad_norm:  0.0946  memory: 13.42GiB(28.26%)  tps: 6,852  tflops: 53.56  mfu: 17.17%
[rank1]:2025-12-27 02:19:22,609 -  step: 750  loss: -8.0000  grad_norm:  0.0946  memory:  9.50GiB(19.99%)  tps: 6,852  tflops: 53.56  mfu: 17.17%
[rank0]:2025-12-27 02:20:03,330 - Freezing Ratio: [Stage0] 0.73, Threshold: 6.3934e-01
[rank1]:2025-12-27 02:20:03,315 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.2631e+00
[rank2]:2025-12-27 02:20:03,315 - Freezing Ratio: [Stage2] 0.25, Threshold: 1.1280e+00
[rank3]:2025-12-27 02:20:03,331 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.4790e+00
[rank1]:2025-12-27 02:20:53,101 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.3312e+00
[rank2]:2025-12-27 02:20:53,109 - Freezing Ratio: [Stage2] 0.75, Threshold: 3.1645e-01
[rank3]:2025-12-27 02:20:53,125 - Freezing Ratio: [Stage3] 0.62, Threshold: 2.9702e-01
[rank0]:2025-12-27 02:20:53,117 - Freezing Ratio: [Stage0] 0.73, Threshold: 5.9534e-01
[rank3]:2025-12-27 02:21:20,265 - Avg. fwd time: 14.1134 / Avg. bwd time: 40.1028 / Avg. batch time: 497.1483 (ms) / GPU bubble ratio: 12.76%
[rank1]:2025-12-27 02:21:20,316 - Avg. fwd time: 10.2634 / Avg. bwd time: 16.5162 / Avg. batch time: 555.3302 (ms) / GPU bubble ratio: 61.42%
[rank2]:2025-12-27 02:21:20,290 - Avg. fwd time: 8.0130 / Avg. bwd time: 15.0084 / Avg. batch time: 524.3774 (ms) / GPU bubble ratio: 64.88%
[rank0]:2025-12-27 02:21:20,346 - Avg. fwd time: 8.5650 / Avg. bwd time: 17.9633 / Avg. batch time: 586.3141 (ms) / GPU bubble ratio: 63.80%
[rank1]:2025-12-27 02:21:38,561 - Freezing Ratio: [Stage1] 0.80, Threshold: 2.4166e+00
[rank2]:2025-12-27 02:21:38,561 - Freezing Ratio: [Stage2] 0.25, Threshold: 2.8780e+00
[rank3]:2025-12-27 02:21:38,577 - Freezing Ratio: [Stage3] 0.00, Threshold: 2.7279e+00
[rank0]:2025-12-27 02:21:38,576 - Freezing Ratio: [Stage0] 0.73, Threshold: 2.3410e+00
[rank2]:2025-12-27 02:22:28,363 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.8037e-01
[rank3]:2025-12-27 02:22:28,379 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.3121e-01
[rank0]:2025-12-27 02:22:28,371 - Freezing Ratio: [Stage0] 0.73, Threshold: 4.7227e-01
[rank1]:2025-12-27 02:22:28,355 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.1601e+00
[rank1]:2025-12-27 02:23:13,792 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.7738e+00
[rank2]:2025-12-27 02:23:13,792 - Freezing Ratio: [Stage2] 0.25, Threshold: 1.7315e+00
[rank3]:2025-12-27 02:23:13,808 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.5511e+00
[rank0]:2025-12-27 02:23:13,791 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-27 02:23:13,808 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.4819e+00
[rank2]:2025-12-27 02:23:18,823 - Avg. fwd time: 8.0170 / Avg. bwd time: 14.9795 / Avg. batch time: 524.2438 (ms) / GPU bubble ratio: 64.91%
[rank3]:2025-12-27 02:23:18,792 - Avg. fwd time: 14.1174 / Avg. bwd time: 40.0861 / Avg. batch time: 497.0461 (ms) / GPU bubble ratio: 12.76%
[rank0]:2025-12-27 02:23:18,880 - Avg. fwd time: 8.5708 / Avg. bwd time: 17.9194 / Avg. batch time: 586.0453 (ms) / GPU bubble ratio: 63.84%
[rank1]:2025-12-27 02:23:18,850 - Avg. fwd time: 10.2746 / Avg. bwd time: 16.4235 / Avg. batch time: 555.1044 (ms) / GPU bubble ratio: 61.52%
[rank1]:2025-12-27 02:23:18,889 -  step: 800  loss: -8.0000  grad_norm:  0.2264  memory:  9.50GiB(19.99%)  tps: 6,934  tflops: 54.21  mfu: 17.37%
[rank1]:2025-12-27 02:23:18,889 - â„¹ï¸ final step: 800  loss: -8.0000  grad_norm:  0.2264  tps: 7,228  tflops: 56.51  mfu: 16.53%
[rank1]:2025-12-27 02:23:18,889 - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-12-27 02:23:18,890 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank2]:2025-12-27 02:23:18,895 -  step: 800  loss: -8.0000  grad_norm:  0.2264  memory:  6.98GiB(14.69%)  tps: 6,934  tflops: 54.21  mfu: 17.37%
[rank2]:2025-12-27 02:23:18,895 - â„¹ï¸ final step: 800  loss: -8.0000  grad_norm:  0.2264  tps: 7,228  tflops: 56.50  mfu: 16.52%
[rank2]:2025-12-27 02:23:18,895 - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-12-27 02:23:18,896 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank3]:2025-12-27 02:23:18,911 -  step: 800  loss:  0.2575  grad_norm:  0.2264  memory: 16.39GiB(34.50%)  tps: 6,934  tflops: 54.21  mfu: 17.37%
[rank3]:2025-12-27 02:23:18,912 - â„¹ï¸ final step: 800  loss:  0.2575  grad_norm:  0.2264  tps: 7,232  tflops: 56.54  mfu: 16.64%
[rank3]:2025-12-27 02:23:18,912 - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-12-27 02:23:18,913 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-27 02:23:18,903 -  step: 800  loss: -8.0000  grad_norm:  0.2264  memory: 13.42GiB(28.26%)  tps: 6,934  tflops: 54.21  mfu: 17.37%
[rank0]:2025-12-27 02:23:18,903 - â„¹ï¸ final step: 800  loss: -8.0000  grad_norm:  0.2264  tps: 7,228  tflops: 56.50  mfu: 16.52%
[rank0]:2025-12-27 02:23:18,903 - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-12-27 02:23:18,904 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-27 02:23:20,924 - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank1]:2025-12-27 02:23:21,001 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p60_42_dm1/frozen_ratio_history/rank1/251227_0223_stage1_final800.svg
[rank2]:2025-12-27 02:23:21,000 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p60_42_dm1/frozen_ratio_history/rank2/251227_0223_stage2_final800.svg
[rank0]:2025-12-27 02:23:21,000 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p60_42_dm1/frozen_ratio_history/rank0/251227_0223_stage0_final800.svg
[rank3]:2025-12-27 02:23:21,080 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p60_42_dm1/pipeline_schedule/251227_0223_final800_rank3.svg
[rank3]:			> Batch Time: 599.09 ms, GPU Bubble Ratio: 66.15%, 67.76%, 66.93%, 26.37%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-36ms      | [S0,MB0,B]  132-16-148ms   | [S0,MB4,F]  149-8-157ms    | [S0,MB1,B]  192-16-208ms   | [S0,MB5,F]  209-8-217ms    | [S0,MB2,B]  256-16-272ms   | [S0,MB6,F]  272-8-281ms    | [S0,MB3,B]  321-16-337ms   | [S0,MB7,F]  338-8-346ms    | [S0,MB4,B]  386-16-403ms   | [S0,MB5,B]  452-16-468ms   | [S0,MB6,B]  517-16-533ms   | [S0,MB7,B]  582-16-599ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-10-34ms     | [S1,MB2,F]  37-10-47ms     | [S1,MB0,B]  106-13-120ms   | [S1,MB3,F]  130-10-141ms   | [S1,MB1,B]  171-13-184ms   | [S1,MB4,F]  190-10-201ms   | [S1,MB2,B]  236-13-249ms   | [S1,MB5,F]  254-10-264ms   | [S1,MB3,B]  301-13-314ms   | [S1,MB6,F]  319-10-329ms   | [S1,MB4,B]  366-13-379ms   | [S1,MB7,F]  385-10-395ms   | [S1,MB5,B]  433-13-446ms   | [S1,MB6,B]  498-13-511ms   | [S1,MB7,B]  563-13-576ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  34-7-41ms      | [S2,MB0,B]  87-14-102ms    | [S2,MB2,F]  105-7-112ms    | [S2,MB1,B]  148-17-165ms   | [S2,MB3,F]  169-7-177ms    | [S2,MB2,B]  213-17-230ms   | [S2,MB4,F]  234-7-242ms    | [S2,MB3,B]  278-17-295ms   | [S2,MB5,F]  299-7-307ms    | [S2,MB4,B]  343-17-360ms   | [S2,MB6,F]  364-7-372ms    | [S2,MB5,B]  410-17-427ms   | [S2,MB7,F]  431-7-439ms    | [S2,MB6,B]  477-17-494ms   | [S2,MB7,B]  542-17-559ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  48-34-83ms     | [S3,MB1,F]  85-11-97ms     | [S3,MB1,B]  105-40-146ms   | [S3,MB2,F]  146-13-160ms   | [S3,MB2,B]  166-41-208ms   | [S3,MB3,F]  211-14-225ms   | [S3,MB3,B]  231-42-273ms   | [S3,MB4,F]  276-15-291ms   | [S3,MB4,B]  296-42-339ms   | [S3,MB5,F]  341-15-356ms   | [S3,MB5,B]  362-42-404ms   | [S3,MB6,F]  408-14-423ms   | [S3,MB6,B]  428-42-471ms   | [S3,MB7,F]  475-14-490ms   | [S3,MB7,B]  495-42-537ms  
[rank0]:2025-12-27 02:23:21,157 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p60_42_dm1/frozen_params_histogram/251227_0223_rank0_stage0.svg
[rank0]:	> Counts Sum: 1836, Total Sum: 2775 (66.16%), Ratio(%) per element: [0.0, 97.33, 97.33, 97.33, 97.33, 97.33, 97.33, 97.33, 97.33, 97.33, 88.0, 88.0, 88.0, 88.0, 88.0, 88.0, 88.0, 88.0, 88.0, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-12-27 02:23:21,157 - Sleeping 2 seconds for other ranks to complete
[rank1]:2025-12-27 02:23:21,154 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p60_42_dm1/frozen_params_histogram/251227_0223_rank1_stage1.svg
[rank1]:	> Counts Sum: 2187, Total Sum: 3375 (64.80%), Ratio(%) per element: [86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 74.66, 74.66, 74.66, 74.66, 74.66, 74.66, 74.66, 74.66, 74.66, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-12-27 02:23:21,154 - Destroying the purge thread.
[rank2]:2025-12-27 02:23:21,154 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p60_42_dm1/frozen_params_histogram/251227_0223_rank2_stage2.svg
[rank2]:	> Counts Sum: 1305, Total Sum: 2700 (48.33%), Ratio(%) per element: [97.33, 97.33, 97.33, 97.33, 97.33, 97.33, 97.33, 97.33, 97.33, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-12-27 02:23:21,154 - Destroying the purge thread.
[rank3]:2025-12-27 02:23:21,216 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p60_42_dm1/pipeline_schedule/251227_0223_thry_final800_rank3.svg
[rank3]:			> Batch Time: 339.31 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-10-10ms      | [S0,MB1,F]  10-10-20ms     | [S0,MB2,F]  20-10-30ms     | [S0,MB3,F]  30-10-41ms     | [S0,MB0,B]  102-20-123ms   | [S0,MB4,F]  123-10-133ms   | [S0,MB1,B]  133-20-154ms   | [S0,MB5,F]  154-10-164ms   | [S0,MB2,B]  164-20-185ms   | [S0,MB6,F]  185-10-195ms   | [S0,MB3,B]  195-20-215ms   | [S0,MB7,F]  215-10-226ms   | [S0,MB4,B]  226-20-246ms   | [S0,MB5,B]  257-20-277ms   | [S0,MB6,B]  287-20-308ms   | [S0,MB7,B]  318-20-339ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  10-10-20ms     | [S1,MB1,F]  20-10-30ms     | [S1,MB2,F]  30-10-41ms     | [S1,MB0,B]  82-20-102ms    | [S1,MB3,F]  102-10-113ms   | [S1,MB1,B]  113-20-133ms   | [S1,MB4,F]  133-10-143ms   | [S1,MB2,B]  143-20-164ms   | [S1,MB5,F]  164-10-174ms   | [S1,MB3,B]  174-20-195ms   | [S1,MB6,F]  195-10-205ms   | [S1,MB4,B]  205-20-226ms   | [S1,MB7,F]  226-10-236ms   | [S1,MB5,B]  236-20-257ms   | [S1,MB6,B]  267-20-287ms   | [S1,MB7,B]  298-20-318ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-10-30ms     | [S2,MB1,F]  30-10-41ms     | [S2,MB0,B]  61-20-82ms     | [S2,MB2,F]  82-10-92ms     | [S2,MB1,B]  92-20-113ms    | [S2,MB3,F]  113-10-123ms   | [S2,MB2,B]  123-20-143ms   | [S2,MB4,F]  143-10-154ms   | [S2,MB3,B]  154-20-174ms   | [S2,MB5,F]  174-10-185ms   | [S2,MB4,B]  185-20-205ms   | [S2,MB6,F]  205-10-215ms   | [S2,MB5,B]  215-20-236ms   | [S2,MB7,F]  236-10-246ms   | [S2,MB6,B]  246-20-267ms   | [S2,MB7,B]  277-20-298ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  30-10-41ms     | [S3,MB0,B]  41-20-61ms     | [S3,MB1,F]  61-10-71ms     | [S3,MB1,B]  71-20-92ms     | [S3,MB2,F]  92-10-102ms    | [S3,MB2,B]  102-20-123ms   | [S3,MB3,F]  123-10-133ms   | [S3,MB3,B]  133-20-154ms   | [S3,MB4,F]  154-10-164ms   | [S3,MB4,B]  164-20-185ms   | [S3,MB5,F]  185-10-195ms   | [S3,MB5,B]  195-20-215ms   | [S3,MB6,F]  215-10-226ms   | [S3,MB6,B]  226-20-246ms   | [S3,MB7,F]  246-10-257ms   | [S3,MB7,B]  257-20-277ms  
[rank3]:2025-12-27 02:23:21,265 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p60_42_dm1/frozen_ratio_history/rank3/251227_0223_stage3_final800.svg
[rank1]:2025-12-27 02:23:21,324 - Process group destroyed
[rank2]:2025-12-27 02:23:21,355 - Process group destroyed
[rank3]:2025-12-27 02:23:21,395 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p60_42_dm1/frozen_params_histogram/251227_0223_rank3_stage3.svg
[rank3]:	> Counts Sum: 666, Total Sum: 2175 (30.62%), Ratio(%) per element: [49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-27 02:23:21,396 - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–ˆâ–‡â–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–ˆâ–‡â–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 4.53091
[rank3]:wandb:               final/avg_loss 0.25749
[rank3]:wandb:             final/avg_mfu(%) 16.64002
[rank3]:wandb:             final/avg_tflops 56.53727
[rank3]:wandb:    final/avg_throughput(tps) 7232.10584
[rank3]:wandb:              final/grad_norm 0.22642
[rank3]:wandb:               final/max_loss 0.25749
[rank3]:wandb:                    grad_norm 0.22642
[rank3]:wandb: loss_metrics/global_avg_loss 0.25749
[rank3]:wandb: loss_metrics/global_max_loss 0.25749
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1226_1F1B_auto_p60_42_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/92t1isgq
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1226_1F1B_auto_p60_42_dm1/20251227-0119/wandb/run-20251227_011906-92t1isgq/logs
[rank3]:2025-12-27 02:23:22,756 - Process group destroyed
[rank0]:2025-12-27 02:23:23,157 - Training completed
[rank0]:2025-12-27 02:23:23,158 - Destroying the purge thread.
[rank0]:2025-12-27 02:23:23,312 - Process group destroyed
[rank2]:Stage 2: Modules to keep: {'layers.10', 'layers.12', 'layers.9', 'layers.11'}
[rank0]:Stage 0: Modules to keep: {'layers.2', 'layers.0', 'layers.1', 'tok_embeddings', 'layers.3'}
[rank1]:Stage 1: Modules to keep: {'layers.7', 'layers.5', 'layers.8', 'layers.4', 'layers.6'}
[rank3]:Stage 3: Modules to keep: {'norm', 'layers.13', 'layers.15', 'layers.14', 'output'}
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1116_autofreeze/config_1226.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "AutoFreeze configuration experiment on different PERCENTILE values."
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1226_1F1B_auto_p60_42_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1226_1F1B_auto_p60_42_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1226_1F1B_auto_p60_42_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1226_1F1B_auto_p60_42_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1226_1F1B_auto_p60_42_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1226_1F1B_auto_p60_42_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 42
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: 1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1226_1F1B_auto_p60_42_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1226_1F1B_auto_p60_42_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: auto
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.05
[rank3]:		- percentile: 60
[rank3]:
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
