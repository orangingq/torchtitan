
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 11. 28. (ê¸ˆ) 19:21:28 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 1,2,3,4
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1116_autofreeze/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1116_autofreeze/1116_1F1B_auto_p80_42.log
âœ”ï¸AutoFreeze configuration experiment on different PERCENTILE values.
âœ”ï¸Running with autofreeze (percentile=80) x 1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1116_autofreeze/config_1116.toml --job.description="AutoFreeze configuration experiment on different PERCENTILE values." --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=auto --freezing.percentile=80
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank2]:2025-11-28 19:21:34,784 - INFO - Starting job: "AutoFreeze configuration experiment on different PERCENTILE values."
[rank3]:2025-11-28 19:21:34,845 - INFO - Starting job: "AutoFreeze configuration experiment on different PERCENTILE values."
[rank1]:2025-11-28 19:21:34,992 - INFO - Starting job: "AutoFreeze configuration experiment on different PERCENTILE values."
[rank2]:2025-11-28 19:21:34,940 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-11-28 19:21:34,942 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-28 19:21:34,959 - INFO - Starting job: "AutoFreeze configuration experiment on different PERCENTILE values."
[rank3]:2025-11-28 19:21:35,047 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-11-28 19:21:35,051 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-28 19:21:35,209 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-11-28 19:21:35,212 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-28 19:21:35,216 - INFO - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-11-28 19:21:35,217 - INFO - Loading tokenizer from tokenizer.json
[rank1]:2025-11-28 19:21:35,233 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-11-28 19:21:35,235 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-28 19:21:35,614 - INFO - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank2]:2025-11-28 19:21:38,357 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-11-28 19:21:38,394 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-11-28 19:21:38,414 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-11-28 19:21:38,414 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank2]:2025-11-28 19:21:38,591 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-11-28 19:21:38,591 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-11-28 19:21:38,592 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank1]:2025-11-28 19:21:38,628 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-11-28 19:21:38,664 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-11-28 19:21:38,690 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-11-28 19:21:38,691 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2025-11-28 19:21:38,754 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank1]:2025-11-28 19:21:38,876 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-11-28 19:21:38,876 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-11-28 19:21:38,877 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank0]:2025-11-28 19:21:38,906 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-11-28 19:21:38,946 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-28 19:21:38,947 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-11-28 19:21:38,975 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-11-28 19:21:38,975 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2025-11-28 19:21:39,160 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-28 19:21:39,160 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-11-28 19:21:39,161 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run c2k1o0ws
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1116_1F1B_auto_p80_42_dm1/20251128-1921/wandb/run-20251128_192139-c2k1o0ws
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1116_1F1B_auto_p80_42_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/c2k1o0ws
[rank3]:2025-11-28 19:21:40,803 - INFO - WandB logging enabled
[rank3]:2025-11-28 19:21:40,803 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-11-28 19:21:40,848 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-11-28 19:21:40,877 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-11-28 19:21:40,877 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2025-11-28 19:21:41,100 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank2]:2025-11-28 19:21:41,098 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-28 19:21:41,098 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1116_1F1B_auto_p80_42_dm1
[rank0]:2025-11-28 19:21:41,098 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-28 19:21:41,098 - INFO - Trainer is initialized with local batch size 16, global batch size 128, gradient accumulation steps 8, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2025-11-28 19:21:41,099 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank3]:2025-11-28 19:21:41,080 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-11-28 19:21:41,081 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-11-28 19:21:41,082 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2025-11-28 19:21:41,098 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-28 19:21:43,511 - INFO - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-11-28 19:21:43,511 - INFO - Finished loading the checkpoint in 2.41 seconds.
[rank0]:2025-11-28 19:21:43,511 - INFO - Training starts at step 1
[rank1]:2025-11-28 19:21:49,154 - INFO -  step:  1  loss: -8.0000  grad_norm: 116.5364  memory:  6.76GiB(14.24%)  tps: 3,124  tflops: 24.42  mfu: 7.83%
[rank1]:2025-11-28 19:21:49,154 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-11-28 19:21:49,152 - INFO -  step:  1  loss: -8.0000  grad_norm: 116.5364  memory:  4.63GiB(9.75%)  tps: 3,046  tflops: 23.81  mfu: 7.63%
[rank2]:2025-11-28 19:21:49,152 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-28 19:21:49,188 - INFO -  step:  1  loss: -8.0000  grad_norm: 116.5364  memory:  9.19GiB(19.34%)  tps: 3,200  tflops: 25.01  mfu: 8.02%
[rank0]:2025-11-28 19:21:49,188 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-11-28 19:21:49,161 - INFO -  step:  1  loss: 10.6088  grad_norm: 116.5364  memory: 12.97GiB(27.31%)  tps: 3,943  tflops: 30.83  mfu: 9.88%
[rank3]:2025-11-28 19:21:49,162 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-11-28 19:23:51,124 - INFO - Avg. fwd time: 13.5516 / Avg. bwd time: 42.3119 / Avg. batch time: 510.5308 (ms) / GPU bubble ratio: 12.46%
[rank1]:2025-11-28 19:23:51,198 - INFO - Avg. fwd time: 9.2819 / Avg. bwd time: 23.8364 / Avg. batch time: 581.7074 (ms) / GPU bubble ratio: 54.45%
[rank2]:2025-11-28 19:23:51,163 - INFO - Avg. fwd time: 7.3857 / Avg. bwd time: 19.1607 / Avg. batch time: 542.7088 (ms) / GPU bubble ratio: 60.87%
[rank0]:2025-11-28 19:23:51,194 - INFO - Avg. fwd time: 7.6539 / Avg. bwd time: 24.1535 / Avg. batch time: 619.7111 (ms) / GPU bubble ratio: 58.94%
[rank0]:2025-11-28 19:25:54,459 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-28 19:25:59,248 - INFO - Avg. fwd time: 13.7185 / Avg. bwd time: 42.6246 / Avg. batch time: 514.2813 (ms) / GPU bubble ratio: 12.35%
[rank1]:2025-11-28 19:25:59,320 - INFO - Avg. fwd time: 9.3049 / Avg. bwd time: 23.9186 / Avg. batch time: 584.7317 (ms) / GPU bubble ratio: 54.55%
[rank2]:2025-11-28 19:25:59,286 - INFO - Avg. fwd time: 7.4004 / Avg. bwd time: 19.2226 / Avg. batch time: 546.0738 (ms) / GPU bubble ratio: 61.00%
[rank0]:2025-11-28 19:25:59,316 - INFO - Avg. fwd time: 7.6691 / Avg. bwd time: 24.2181 / Avg. batch time: 622.3519 (ms) / GPU bubble ratio: 59.01%
[rank3]:2025-11-28 19:25:59,562 - INFO -  step: 50  loss:  9.9035  grad_norm: 12.5544  memory: 16.39GiB(34.50%)  tps: 6,412  tflops: 50.13  mfu: 16.07%
[rank1]:2025-11-28 19:25:59,553 - INFO -  step: 50  loss: -8.0000  grad_norm: 12.5544  memory:  9.03GiB(19.01%)  tps: 6,412  tflops: 50.13  mfu: 16.07%
[rank2]:2025-11-28 19:25:59,550 - INFO -  step: 50  loss: -8.0000  grad_norm: 12.5544  memory:  6.43GiB(13.53%)  tps: 6,412  tflops: 50.13  mfu: 16.07%
[rank0]:2025-11-28 19:25:59,564 - INFO -  step: 50  loss: -8.0000  grad_norm: 12.5544  memory: 12.97GiB(27.31%)  tps: 6,413  tflops: 50.13  mfu: 16.07%
[rank2]:2025-11-28 19:26:50,852 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 0.0000e+00
[rank1]:2025-11-28 19:26:50,857 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 0.0000e+00
[rank3]:2025-11-28 19:26:50,865 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 0.0000e+00
[rank0]:2025-11-28 19:26:50,869 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 0.0000e+00
[rank2]:2025-11-28 19:27:42,315 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.3928e+00
[rank1]:2025-11-28 19:27:42,319 - INFO - Freezing Ratio: [Stage1] 0.20, Threshold: 4.0026e+00
[rank3]:2025-11-28 19:27:42,327 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 3.7760e+00
[rank0]:2025-11-28 19:27:42,331 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.8840e+00
[rank3]:2025-11-28 19:28:05,610 - INFO - Avg. fwd time: 13.7969 / Avg. bwd time: 42.2980 / Avg. batch time: 512.2522 (ms) / GPU bubble ratio: 12.39%
[rank2]:2025-11-28 19:28:05,628 - INFO - Avg. fwd time: 7.4697 / Avg. bwd time: 18.7208 / Avg. batch time: 543.4029 (ms) / GPU bubble ratio: 61.44%
[rank1]:2025-11-28 19:28:05,655 - INFO - Avg. fwd time: 9.3221 / Avg. bwd time: 23.7726 / Avg. batch time: 581.7840 (ms) / GPU bubble ratio: 54.49%
[rank0]:2025-11-28 19:28:05,686 - INFO - Avg. fwd time: 7.6704 / Avg. bwd time: 24.2482 / Avg. batch time: 619.2999 (ms) / GPU bubble ratio: 58.77%
[rank3]:2025-11-28 19:28:29,054 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 3.9060e+00
[rank2]:2025-11-28 19:28:29,038 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 3.8647e+00
[rank0]:2025-11-28 19:28:29,066 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 5.3964e+00
[rank1]:2025-11-28 19:28:29,050 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 9.7228e-01
[rank1]:2025-11-28 19:29:19,784 - INFO - Freezing Ratio: [Stage1] 0.20, Threshold: 3.0975e+00
[rank3]:2025-11-28 19:29:19,791 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 6.8556e+00
[rank2]:2025-11-28 19:29:19,780 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 9.0921e-01
[rank0]:2025-11-28 19:29:19,787 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 3.6184e+00
[rank0]:2025-11-28 19:30:01,758 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-28 19:30:06,091 - INFO - Avg. fwd time: 13.8710 / Avg. bwd time: 41.6086 / Avg. batch time: 507.3091 (ms) / GPU bubble ratio: 12.51%
[rank0]:2025-11-28 19:30:06,191 - INFO - Avg. fwd time: 7.7428 / Avg. bwd time: 23.7186 / Avg. batch time: 612.4636 (ms) / GPU bubble ratio: 58.91%
[rank2]:2025-11-28 19:30:06,150 - INFO - Avg. fwd time: 7.5928 / Avg. bwd time: 17.8329 / Avg. batch time: 537.5010 (ms) / GPU bubble ratio: 62.16%
[rank1]:2025-11-28 19:30:06,190 - INFO - Avg. fwd time: 9.3679 / Avg. bwd time: 23.4911 / Avg. batch time: 575.5386 (ms) / GPU bubble ratio: 54.33%
[rank2]:2025-11-28 19:30:06,401 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 8.6501e+00
[rank2]:2025-11-28 19:30:06,401 - INFO -  step: 100  loss: -8.0000  grad_norm:  8.2306  memory:  6.43GiB(13.53%)  tps: 6,637  tflops: 51.89  mfu: 16.63%
[rank1]:2025-11-28 19:30:06,413 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 3.9844e+00
[rank1]:2025-11-28 19:30:06,413 - INFO -  step: 100  loss: -8.0000  grad_norm:  8.2306  memory:  9.03GiB(19.01%)  tps: 6,637  tflops: 51.88  mfu: 16.63%
[rank3]:2025-11-28 19:30:06,416 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 3.5454e+00
[rank3]:2025-11-28 19:30:06,420 - INFO -  step: 100  loss:  8.5174  grad_norm:  8.2306  memory: 16.39GiB(34.50%)  tps: 6,637  tflops: 51.89  mfu: 16.63%
[rank0]:2025-11-28 19:30:06,428 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 3.4030e+00
[rank0]:2025-11-28 19:30:06,429 - INFO -  step: 100  loss: -8.0000  grad_norm:  8.2306  memory: 12.97GiB(27.31%)  tps: 6,637  tflops: 51.88  mfu: 16.63%
[rank0]:2025-11-28 19:30:06,499 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p80_42_dm1/frozen_ratio_history/rank0/251128_1930_stage0_step100.svg
[rank2]:2025-11-28 19:30:06,500 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p80_42_dm1/frozen_ratio_history/rank2/251128_1930_stage2_step100.svg
[rank1]:2025-11-28 19:30:06,505 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p80_42_dm1/frozen_ratio_history/rank1/251128_1930_stage1_step100.svg
[rank3]:2025-11-28 19:30:06,602 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p80_42_dm1/pipeline_schedule/251128_1930_real_step100_rank3.svg
[rank3]:			> Batch Time: 565.84 ms, GPU Bubble Ratio: 54.62%, 56.01%, 71.92%, 28.06%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms                       | [S0,MB1,F]  9-7-17ms                      | [S0,MB2,F]  17-7-25ms                     | [S0,MB3,F]  25-7-32ms                     | [S0,MB0,B]  129-24-154ms                  | [S0,MB4,F]  154-7-161ms                   | [S0,MB1,B]  184-24-209ms                  | [S0,MB5,F]  209-7-216ms                   | [S0,MB2,B]  241-24-266ms                  | [S0,MB6,F]  266-7-273ms                   | [S0,MB3,B]  302-24-326ms                  | [S0,MB7,F]  326-7-333ms                   | [S0,MB4,B]  363-24-387ms                  | [S0,MB5,B]  422-24-447ms                  | [S0,MB6,B]  481-24-506ms                  | [S0,MB7,B]  541-24-565ms                 
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms                     | [S1,MB1,F]  23-9-33ms                     | [S1,MB2,F]  36-9-45ms                     | [S1,MB0,B]  103-21-124ms                  | [S1,MB3,F]  128-9-137ms                   | [S1,MB1,B]  158-21-179ms                  | [S1,MB4,F]  182-9-192ms                   | [S1,MB2,B]  215-21-236ms                  | [S1,MB5,F]  239-9-249ms                   | [S1,MB3,B]  275-21-297ms                  | [S1,MB6,F]  300-9-310ms                   | [S1,MB4,B]  336-21-358ms                  | [S1,MB7,F]  361-9-371ms                   | [S1,MB5,B]  397-21-419ms                  | [S1,MB6,B]  457-21-478ms                  | [S1,MB7,B]  516-21-538ms                 
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms                     | [S2,MB1,F]  33-8-41ms                     | [S2,MB0,B]  86-11-98ms                    | [S2,MB2,F]  101-8-110ms                   | [S2,MB1,B]  141-11-153ms                  | [S2,MB3,F]  156-8-165ms                   | [S2,MB2,B]  198-11-210ms                  | [S2,MB4,F]  213-8-221ms                   | [S2,MB3,B]  259-11-270ms                  | [S2,MB5,F]  274-8-282ms                   | [S2,MB4,B]  320-11-331ms                  | [S2,MB6,F]  335-8-343ms                   | [S2,MB5,B]  381-11-393ms                  | [S2,MB7,F]  396-8-404ms                   | [S2,MB6,B]  442-11-453ms                  | [S2,MB7,B]  502-11-513ms                 
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-43ms                    | [S3,MB0,B]  48-34-83ms                    | [S3,MB1,F]  85-11-96ms                    | [S3,MB1,B]  102-35-137ms                  | [S3,MB2,F]  140-13-153ms                  | [S3,MB2,B]  159-35-194ms                  | [S3,MB3,F]  197-15-212ms                  | [S3,MB3,B]  218-36-255ms                  | [S3,MB4,F]  257-15-273ms                  | [S3,MB4,B]  278-37-316ms                  | [S3,MB5,F]  318-15-334ms                  | [S3,MB5,B]  339-37-377ms                  | [S3,MB6,F]  380-15-395ms                  | [S3,MB6,B]  400-37-438ms                  | [S3,MB7,F]  441-14-455ms                  | [S3,MB7,B]  461-37-499ms                 
[rank3]:2025-11-28 19:30:06,650 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p80_42_dm1/frozen_ratio_history/rank3/251128_1930_stage3_step100.svg
[rank2]:2025-11-28 19:30:57,386 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.3446e+00
[rank1]:2025-11-28 19:30:57,390 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.1513e+00
[rank3]:2025-11-28 19:30:57,398 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.1113e+00
[rank0]:2025-11-28 19:30:57,394 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 3.6550e+00
[rank1]:2025-11-28 19:31:43,703 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.1366e+00
[rank3]:2025-11-28 19:31:43,718 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.4641e+00
[rank0]:2025-11-28 19:31:43,731 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 3.0395e+00
[rank2]:2025-11-28 19:31:43,703 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.8504e+00
[rank3]:2025-11-28 19:32:08,619 - INFO - Avg. fwd time: 13.9390 / Avg. bwd time: 41.2206 / Avg. batch time: 504.7374 (ms) / GPU bubble ratio: 12.57%
[rank0]:2025-11-28 19:32:08,638 - INFO - Avg. fwd time: 7.8117 / Avg. bwd time: 23.2529 / Avg. batch time: 608.1095 (ms) / GPU bubble ratio: 59.13%
[rank2]:2025-11-28 19:32:08,658 - INFO - Avg. fwd time: 7.6577 / Avg. bwd time: 17.3360 / Avg. batch time: 534.4984 (ms) / GPU bubble ratio: 62.59%
[rank1]:2025-11-28 19:32:08,692 - INFO - Avg. fwd time: 9.4670 / Avg. bwd time: 22.6845 / Avg. batch time: 571.6898 (ms) / GPU bubble ratio: 55.01%
[rank3]:2025-11-28 19:32:34,493 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 9.5563e+00
[rank0]:2025-11-28 19:32:34,489 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 9.6874e+00
[rank2]:2025-11-28 19:32:34,481 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.3375e+00
[rank1]:2025-11-28 19:32:34,486 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 9.7554e-01
[rank0]:2025-11-28 19:33:19,560 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.8539e+00
[rank3]:2025-11-28 19:33:19,560 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.5316e+00
[rank2]:2025-11-28 19:33:19,545 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.7218e+00
[rank1]:2025-11-28 19:33:19,545 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.4496e+00
[rank0]:2025-11-28 19:34:05,264 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-28 19:34:10,278 - INFO - Avg. fwd time: 13.9553 / Avg. bwd time: 41.0889 / Avg. batch time: 503.8073 (ms) / GPU bubble ratio: 12.59%
[rank2]:2025-11-28 19:34:10,305 - INFO - Avg. fwd time: 7.6819 / Avg. bwd time: 17.1506 / Avg. batch time: 533.3325 (ms) / GPU bubble ratio: 62.75%
[rank1]:2025-11-28 19:34:10,335 - INFO - Avg. fwd time: 9.5267 / Avg. bwd time: 22.2073 / Avg. batch time: 570.0260 (ms) / GPU bubble ratio: 55.46%
[rank1]:2025-11-28 19:34:10,388 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 9.0665e-01
[rank1]:2025-11-28 19:34:10,389 - INFO -  step: 150  loss: -8.0000  grad_norm: 10.2869  memory:  9.03GiB(19.01%)  tps: 6,715  tflops: 52.50  mfu: 16.83%
[rank0]:2025-11-28 19:34:10,361 - INFO - Avg. fwd time: 7.9375 / Avg. bwd time: 22.3263 / Avg. batch time: 605.4980 (ms) / GPU bubble ratio: 60.01%
[rank0]:2025-11-28 19:34:10,392 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 4.0245e+00
[rank0]:2025-11-28 19:34:10,392 - INFO -  step: 150  loss: -8.0000  grad_norm: 10.2869  memory: 12.97GiB(27.31%)  tps: 6,716  tflops: 52.50  mfu: 16.83%
[rank3]:2025-11-28 19:34:10,395 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.9367e+00
[rank3]:2025-11-28 19:34:10,399 - INFO -  step: 150  loss:  4.2753  grad_norm: 10.2869  memory: 16.39GiB(34.50%)  tps: 6,715  tflops: 52.50  mfu: 16.83%
[rank2]:2025-11-28 19:34:10,384 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.7220e+00
[rank2]:2025-11-28 19:34:10,384 - INFO -  step: 150  loss: -8.0000  grad_norm: 10.2869  memory:  6.43GiB(13.53%)  tps: 6,715  tflops: 52.50  mfu: 16.83%
[rank1]:2025-11-28 19:34:55,619 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.9373e+00
[rank0]:2025-11-28 19:34:55,635 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 2.3591e+00
[rank3]:2025-11-28 19:34:55,635 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.1915e+00
[rank2]:2025-11-28 19:34:55,619 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 3.8383e+00
[rank0]:2025-11-28 19:35:46,253 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 4.9799e+00
[rank3]:2025-11-28 19:35:46,257 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.8205e+01
[rank2]:2025-11-28 19:35:46,246 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.1809e+00
[rank1]:2025-11-28 19:35:46,250 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 9.0799e-01
[rank0]:2025-11-28 19:36:08,441 - INFO - Avg. fwd time: 8.0224 / Avg. bwd time: 21.6973 / Avg. batch time: 602.1575 (ms) / GPU bubble ratio: 60.52%
[rank3]:2025-11-28 19:36:08,405 - INFO - Avg. fwd time: 13.9658 / Avg. bwd time: 40.8524 / Avg. batch time: 501.9934 (ms) / GPU bubble ratio: 12.64%
[rank2]:2025-11-28 19:36:08,464 - INFO - Avg. fwd time: 7.7225 / Avg. bwd time: 16.8564 / Avg. batch time: 531.1904 (ms) / GPU bubble ratio: 62.98%
[rank1]:2025-11-28 19:36:08,483 - INFO - Avg. fwd time: 9.5960 / Avg. bwd time: 21.6731 / Avg. batch time: 567.3347 (ms) / GPU bubble ratio: 55.91%
[rank1]:2025-11-28 19:36:31,257 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.2793e+00
[rank0]:2025-11-28 19:36:31,272 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 2.2743e+00
[rank3]:2025-11-28 19:36:31,272 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.1948e+00
[rank2]:2025-11-28 19:36:31,256 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.3573e+00
[rank1]:2025-11-28 19:37:21,864 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.4262e-01
[rank0]:2025-11-28 19:37:21,868 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 6.6493e-01
[rank3]:2025-11-28 19:37:21,871 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.9953e+00
[rank2]:2025-11-28 19:37:21,860 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 6.9909e-01
[rank0]:2025-11-28 19:38:02,295 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-28 19:38:06,511 - INFO - Avg. fwd time: 13.9665 / Avg. bwd time: 40.5817 / Avg. batch time: 499.8262 (ms) / GPU bubble ratio: 12.69%
[rank0]:2025-11-28 19:38:06,546 - INFO - Avg. fwd time: 8.1009 / Avg. bwd time: 21.1217 / Avg. batch time: 598.4687 (ms) / GPU bubble ratio: 60.94%
[rank1]:2025-11-28 19:38:06,586 - INFO - Avg. fwd time: 9.6683 / Avg. bwd time: 21.1139 / Avg. batch time: 564.2375 (ms) / GPU bubble ratio: 56.36%
[rank2]:2025-11-28 19:38:06,570 - INFO - Avg. fwd time: 7.7671 / Avg. bwd time: 16.5312 / Avg. batch time: 528.6663 (ms) / GPU bubble ratio: 63.23%
[rank1]:2025-11-28 19:38:06,797 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.0319e+00
[rank1]:2025-11-28 19:38:06,797 - INFO -  step: 200  loss: -8.0000  grad_norm:  7.7966  memory:  9.03GiB(19.01%)  tps: 6,930  tflops: 54.18  mfu: 17.36%
[rank2]:2025-11-28 19:38:06,797 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.5654e+00
[rank2]:2025-11-28 19:38:06,797 - INFO -  step: 200  loss: -8.0000  grad_norm:  7.7966  memory:  6.43GiB(13.53%)  tps: 6,930  tflops: 54.18  mfu: 17.36%
[rank3]:2025-11-28 19:38:06,812 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 4.5687e+00
[rank3]:2025-11-28 19:38:06,816 - INFO -  step: 200  loss:  1.2643  grad_norm:  7.7966  memory: 16.39GiB(34.50%)  tps: 6,930  tflops: 54.18  mfu: 17.36%
[rank0]:2025-11-28 19:38:06,812 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.6127e+00
[rank0]:2025-11-28 19:38:06,813 - INFO -  step: 200  loss: -8.0000  grad_norm:  7.7966  memory: 12.97GiB(27.31%)  tps: 6,930  tflops: 54.18  mfu: 17.36%
[rank1]:2025-11-28 19:38:06,871 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p80_42_dm1/frozen_ratio_history/rank1/251128_1938_stage1_step200.svg
[rank2]:2025-11-28 19:38:06,869 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p80_42_dm1/frozen_ratio_history/rank2/251128_1938_stage2_step200.svg
[rank0]:2025-11-28 19:38:06,870 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p80_42_dm1/frozen_ratio_history/rank0/251128_1938_stage0_step200.svg
[rank3]:2025-11-28 19:38:06,958 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p80_42_dm1/pipeline_schedule/251128_1938_real_step200_rank3.svg
[rank3]:			> Batch Time: 546.83 ms, GPU Bubble Ratio: 63.27%, 64.89%, 71.03%, 26.30%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms                       | [S0,MB1,F]  9-9-18ms                      | [S0,MB2,F]  18-9-27ms                     | [S0,MB3,F]  27-8-36ms                     | [S0,MB0,B]  121-16-137ms                  | [S0,MB4,F]  137-8-145ms                   | [S0,MB1,B]  175-16-191ms                  | [S0,MB5,F]  191-8-200ms                   | [S0,MB2,B]  232-16-248ms                  | [S0,MB6,F]  248-8-256ms                   | [S0,MB3,B]  291-16-308ms                  | [S0,MB7,F]  308-8-316ms                   | [S0,MB4,B]  352-16-369ms                  | [S0,MB5,B]  411-16-428ms                  | [S0,MB6,B]  471-16-487ms                  | [S0,MB7,B]  530-16-546ms                 
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-10-20ms                     | [S1,MB1,F]  23-10-34ms                    | [S1,MB2,F]  37-10-48ms                    | [S1,MB0,B]  102-13-116ms                  | [S1,MB3,F]  119-10-130ms                  | [S1,MB1,B]  156-13-170ms                  | [S1,MB4,F]  173-10-184ms                  | [S1,MB2,B]  213-13-226ms                  | [S1,MB5,F]  230-10-241ms                  | [S1,MB3,B]  273-13-286ms                  | [S1,MB6,F]  290-10-300ms                  | [S1,MB4,B]  334-13-347ms                  | [S1,MB7,F]  351-10-361ms                  | [S1,MB5,B]  395-13-408ms                  | [S1,MB6,B]  453-13-467ms                  | [S1,MB7,B]  513-13-527ms                 
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms                     | [S2,MB1,F]  34-8-42ms                     | [S2,MB0,B]  86-11-97ms                    | [S2,MB2,F]  101-8-109ms                   | [S2,MB1,B]  140-11-151ms                  | [S2,MB3,F]  155-8-163ms                   | [S2,MB2,B]  197-11-208ms                  | [S2,MB4,F]  212-8-220ms                   | [S2,MB3,B]  256-11-268ms                  | [S2,MB5,F]  271-8-280ms                   | [S2,MB4,B]  317-11-329ms                  | [S2,MB6,F]  332-8-341ms                   | [S2,MB5,B]  378-11-390ms                  | [S2,MB7,F]  393-8-401ms                   | [S2,MB6,B]  439-11-450ms                  | [S2,MB7,B]  499-11-510ms                 
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms                    | [S3,MB0,B]  48-33-82ms                    | [S3,MB1,F]  84-11-96ms                    | [S3,MB1,B]  102-34-137ms                  | [S3,MB2,F]  139-12-151ms                  | [S3,MB2,B]  157-35-193ms                  | [S3,MB3,F]  195-14-210ms                  | [S3,MB3,B]  216-36-253ms                  | [S3,MB4,F]  255-15-270ms                  | [S3,MB4,B]  276-37-313ms                  | [S3,MB5,F]  316-15-331ms                  | [S3,MB5,B]  337-37-374ms                  | [S3,MB6,F]  377-15-392ms                  | [S3,MB6,B]  398-37-435ms                  | [S3,MB7,F]  437-14-452ms                  | [S3,MB7,B]  458-37-495ms                 
[rank3]:2025-11-28 19:38:07,005 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p80_42_dm1/frozen_ratio_history/rank3/251128_1938_stage3_step200.svg
[rank1]:2025-11-28 19:38:57,564 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 8.1537e-01
[rank2]:2025-11-28 19:38:57,560 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.3487e+00
[rank3]:2025-11-28 19:38:57,571 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.2248e+01
[rank0]:2025-11-28 19:38:57,568 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.2504e+00
[rank1]:2025-11-28 19:39:42,524 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.3214e+00
[rank2]:2025-11-28 19:39:42,524 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.4577e+00
[rank3]:2025-11-28 19:39:42,539 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 8.3296e-01
[rank0]:2025-11-28 19:39:42,539 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.9853e+00
[rank3]:2025-11-28 19:40:07,880 - INFO - Avg. fwd time: 13.9728 / Avg. bwd time: 40.5086 / Avg. batch time: 499.2887 (ms) / GPU bubble ratio: 12.71%
[rank1]:2025-11-28 19:40:07,939 - INFO - Avg. fwd time: 9.6931 / Avg. bwd time: 20.9201 / Avg. batch time: 563.4632 (ms) / GPU bubble ratio: 56.54%
[rank2]:2025-11-28 19:40:07,907 - INFO - Avg. fwd time: 7.7762 / Avg. bwd time: 16.4581 / Avg. batch time: 528.0941 (ms) / GPU bubble ratio: 63.29%
[rank0]:2025-11-28 19:40:07,965 - INFO - Avg. fwd time: 8.1526 / Avg. bwd time: 20.7377 / Avg. batch time: 597.3011 (ms) / GPU bubble ratio: 61.31%
[rank1]:2025-11-28 19:40:33,105 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 3.8032e-01
[rank2]:2025-11-28 19:40:33,101 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 7.6987e-01
[rank3]:2025-11-28 19:40:33,113 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.2688e+00
[rank0]:2025-11-28 19:40:33,109 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.9095e+00
[rank2]:2025-11-28 19:41:18,169 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 8.9177e+00
[rank1]:2025-11-28 19:41:18,169 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.0168e+01
[rank3]:2025-11-28 19:41:18,185 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 4.9076e+00
[rank0]:2025-11-28 19:41:18,185 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 7.6734e+00
[rank0]:2025-11-28 19:42:03,108 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-11-28 19:42:07,830 - INFO - Avg. fwd time: 7.7835 / Avg. bwd time: 16.3959 / Avg. batch time: 527.5394 (ms) / GPU bubble ratio: 63.33%
[rank1]:2025-11-28 19:42:07,837 - INFO - Avg. fwd time: 9.7520 / Avg. bwd time: 20.4486 / Avg. batch time: 562.4297 (ms) / GPU bubble ratio: 57.04%
[rank3]:2025-11-28 19:42:07,792 - INFO - Avg. fwd time: 13.9697 / Avg. bwd time: 40.4531 / Avg. batch time: 498.8169 (ms) / GPU bubble ratio: 12.72%
[rank0]:2025-11-28 19:42:07,801 - INFO - Avg. fwd time: 8.1877 / Avg. bwd time: 20.4697 / Avg. batch time: 595.9894 (ms) / GPU bubble ratio: 61.53%
[rank0]:2025-11-28 19:42:08,087 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.8080e+00
[rank0]:2025-11-28 19:42:08,087 - INFO -  step: 250  loss: -8.0000  grad_norm:  7.4143  memory: 12.97GiB(27.31%)  tps: 6,791  tflops: 53.09  mfu: 17.01%
[rank2]:2025-11-28 19:42:08,079 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.4529e+00
[rank2]:2025-11-28 19:42:08,080 - INFO -  step: 250  loss: -8.0000  grad_norm:  7.4143  memory:  6.43GiB(13.53%)  tps: 6,790  tflops: 53.08  mfu: 17.01%
[rank1]:2025-11-28 19:42:08,067 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 4.3666e+00
[rank1]:2025-11-28 19:42:08,068 - INFO -  step: 250  loss: -8.0000  grad_norm:  7.4143  memory:  9.03GiB(19.01%)  tps: 6,791  tflops: 53.09  mfu: 17.01%
[rank3]:2025-11-28 19:42:08,091 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 5.2742e+00
[rank3]:2025-11-28 19:42:08,099 - INFO -  step: 250  loss:  1.2524  grad_norm:  7.4143  memory: 16.39GiB(34.50%)  tps: 6,791  tflops: 53.09  mfu: 17.01%
[rank2]:2025-11-28 19:42:53,084 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.2337e+00
[rank1]:2025-11-28 19:42:53,084 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.7702e+00
[rank3]:2025-11-28 19:42:53,099 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.5622e+00
[rank0]:2025-11-28 19:42:53,099 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.6445e+00
[rank2]:2025-11-28 19:43:43,028 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.0869e+00
[rank1]:2025-11-28 19:43:43,016 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.0133e+01
[rank3]:2025-11-28 19:43:43,039 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.3436e+00
[rank0]:2025-11-28 19:43:43,035 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.2311e+01
[rank3]:2025-11-28 19:44:05,292 - INFO - Avg. fwd time: 13.9775 / Avg. bwd time: 40.3631 / Avg. batch time: 498.1580 (ms) / GPU bubble ratio: 12.73%
[rank0]:2025-11-28 19:44:05,328 - INFO - Avg. fwd time: 8.2250 / Avg. bwd time: 20.1943 / Avg. batch time: 594.2174 (ms) / GPU bubble ratio: 61.74%
[rank2]:2025-11-28 19:44:05,353 - INFO - Avg. fwd time: 7.7994 / Avg. bwd time: 16.2758 / Avg. batch time: 526.7402 (ms) / GPU bubble ratio: 63.44%
[rank1]:2025-11-28 19:44:05,372 - INFO - Avg. fwd time: 9.8376 / Avg. bwd time: 19.7697 / Avg. batch time: 560.9448 (ms) / GPU bubble ratio: 57.78%
[rank2]:2025-11-28 19:44:28,181 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.3143e+01
[rank1]:2025-11-28 19:44:28,181 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.2675e+01
[rank3]:2025-11-28 19:44:28,196 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 6.1619e+00
[rank0]:2025-11-28 19:44:28,196 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.0151e+01
[rank1]:2025-11-28 19:45:17,298 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 3.7752e+00
[rank0]:2025-11-28 19:45:17,314 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.9627e+00
[rank2]:2025-11-28 19:45:17,298 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.5097e+00
[rank3]:2025-11-28 19:45:17,322 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.8733e+00
[rank0]:2025-11-28 19:45:57,905 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-28 19:46:02,337 - INFO - Avg. fwd time: 13.9842 / Avg. bwd time: 40.2377 / Avg. batch time: 497.2057 (ms) / GPU bubble ratio: 12.76%
[rank0]:2025-11-28 19:46:02,404 - INFO - Avg. fwd time: 8.2713 / Avg. bwd time: 19.8582 / Avg. batch time: 591.9170 (ms) / GPU bubble ratio: 61.98%
[rank2]:2025-11-28 19:46:02,357 - INFO - Avg. fwd time: 7.8585 / Avg. bwd time: 15.8455 / Avg. batch time: 525.3407 (ms) / GPU bubble ratio: 63.90%
[rank2]:2025-11-28 19:46:02,414 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.0606e+00
[rank2]:2025-11-28 19:46:02,414 - INFO -  step: 300  loss: -8.0000  grad_norm:  1.0611  memory:  6.43GiB(13.53%)  tps: 6,992  tflops: 54.66  mfu: 17.52%
[rank1]:2025-11-28 19:46:02,379 - INFO - Avg. fwd time: 9.9076 / Avg. bwd time: 19.2113 / Avg. batch time: 558.9841 (ms) / GPU bubble ratio: 58.33%
[rank1]:2025-11-28 19:46:02,414 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 7.3207e+00
[rank1]:2025-11-28 19:46:02,414 - INFO -  step: 300  loss: -8.0000  grad_norm:  1.0611  memory:  9.03GiB(19.01%)  tps: 6,991  tflops: 54.66  mfu: 17.52%
[rank3]:2025-11-28 19:46:02,429 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 3.0018e+00
[rank3]:2025-11-28 19:46:02,432 - INFO -  step: 300  loss:  0.3531  grad_norm:  1.0611  memory: 16.39GiB(34.50%)  tps: 6,992  tflops: 54.66  mfu: 17.52%
[rank0]:2025-11-28 19:46:02,429 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1314e+01
[rank0]:2025-11-28 19:46:02,429 - INFO -  step: 300  loss: -8.0000  grad_norm:  1.0611  memory: 12.97GiB(27.31%)  tps: 6,991  tflops: 54.66  mfu: 17.52%
[rank0]:2025-11-28 19:46:02,485 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p80_42_dm1/frozen_ratio_history/rank0/251128_1946_stage0_step300.svg
[rank2]:2025-11-28 19:46:02,486 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p80_42_dm1/frozen_ratio_history/rank2/251128_1946_stage2_step300.svg
[rank1]:2025-11-28 19:46:02,487 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p80_42_dm1/frozen_ratio_history/rank1/251128_1946_stage1_step300.svg
[rank3]:2025-11-28 19:46:02,573 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p80_42_dm1/pipeline_schedule/251128_1946_real_step300_rank3.svg
[rank3]:			> Batch Time: 548.39 ms, GPU Bubble Ratio: 63.24%, 64.89%, 71.01%, 25.92%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms                       | [S0,MB1,F]  9-9-18ms                      | [S0,MB2,F]  18-9-27ms                     | [S0,MB3,F]  27-8-36ms                     | [S0,MB0,B]  121-16-138ms                  | [S0,MB4,F]  138-8-146ms                   | [S0,MB1,B]  176-16-193ms                  | [S0,MB5,F]  193-8-201ms                   | [S0,MB2,B]  233-16-250ms                  | [S0,MB6,F]  250-8-258ms                   | [S0,MB3,B]  294-16-310ms                  | [S0,MB7,F]  310-8-318ms                   | [S0,MB4,B]  354-16-370ms                  | [S0,MB5,B]  413-16-429ms                  | [S0,MB6,B]  472-16-488ms                  | [S0,MB7,B]  532-16-548ms                 
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms                     | [S1,MB1,F]  23-10-34ms                    | [S1,MB2,F]  37-10-48ms                    | [S1,MB0,B]  103-13-116ms                  | [S1,MB3,F]  120-10-130ms                  | [S1,MB1,B]  158-13-171ms                  | [S1,MB4,F]  175-10-185ms                  | [S1,MB2,B]  215-13-228ms                  | [S1,MB5,F]  231-10-242ms                  | [S1,MB3,B]  275-13-288ms                  | [S1,MB6,F]  292-10-303ms                  | [S1,MB4,B]  336-13-349ms                  | [S1,MB7,F]  353-10-363ms                  | [S1,MB5,B]  396-13-410ms                  | [S1,MB6,B]  456-13-469ms                  | [S1,MB7,B]  515-13-528ms                 
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms                     | [S2,MB1,F]  34-8-42ms                     | [S2,MB0,B]  86-11-98ms                    | [S2,MB2,F]  101-8-110ms                   | [S2,MB1,B]  141-11-153ms                  | [S2,MB3,F]  156-8-165ms                   | [S2,MB2,B]  198-11-209ms                  | [S2,MB4,F]  213-8-221ms                   | [S2,MB3,B]  259-11-270ms                  | [S2,MB5,F]  273-8-282ms                   | [S2,MB4,B]  319-11-330ms                  | [S2,MB6,F]  334-8-342ms                   | [S2,MB5,B]  380-11-391ms                  | [S2,MB7,F]  395-8-403ms                   | [S2,MB6,B]  441-11-452ms                  | [S2,MB7,B]  501-11-512ms                 
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms                    | [S3,MB0,B]  48-34-82ms                    | [S3,MB1,F]  85-11-96ms                    | [S3,MB1,B]  102-35-137ms                  | [S3,MB2,F]  140-13-153ms                  | [S3,MB2,B]  158-36-194ms                  | [S3,MB3,F]  196-15-212ms                  | [S3,MB3,B]  218-36-255ms                  | [S3,MB4,F]  257-15-273ms                  | [S3,MB4,B]  278-37-315ms                  | [S3,MB5,F]  317-15-333ms                  | [S3,MB5,B]  338-37-376ms                  | [S3,MB6,F]  378-14-393ms                  | [S3,MB6,B]  399-37-437ms                  | [S3,MB7,F]  439-14-454ms                  | [S3,MB7,B]  460-37-498ms                 
[rank3]:2025-11-28 19:46:02,618 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p80_42_dm1/frozen_ratio_history/rank3/251128_1946_stage3_step300.svg
[rank0]:2025-11-28 19:46:51,664 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.2353e+00
[rank1]:2025-11-28 19:46:51,649 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 3.9231e-01
[rank2]:2025-11-28 19:46:51,648 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 8.7963e-01
[rank3]:2025-11-28 19:46:51,672 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 5.2593e-01
[rank1]:2025-11-28 19:47:36,739 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 5.7647e-01
[rank2]:2025-11-28 19:47:36,739 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 8.1817e-01
[rank3]:2025-11-28 19:47:36,755 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 4.9703e-01
[rank0]:2025-11-28 19:47:36,755 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1778e+00
[rank0]:2025-11-28 19:48:00,842 - INFO - Avg. fwd time: 8.3053 / Avg. bwd time: 19.6148 / Avg. batch time: 590.8830 (ms) / GPU bubble ratio: 62.20%
[rank1]:2025-11-28 19:48:00,894 - INFO - Avg. fwd time: 9.9596 / Avg. bwd time: 18.8066 / Avg. batch time: 558.2011 (ms) / GPU bubble ratio: 58.77%
[rank2]:2025-11-28 19:48:00,876 - INFO - Avg. fwd time: 7.9018 / Avg. bwd time: 15.5337 / Avg. batch time: 524.9657 (ms) / GPU bubble ratio: 64.29%
[rank3]:2025-11-28 19:48:00,857 - INFO - Avg. fwd time: 13.9818 / Avg. bwd time: 40.2291 / Avg. batch time: 497.1175 (ms) / GPU bubble ratio: 12.76%
[rank1]:2025-11-28 19:48:25,730 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 5.9495e-01
[rank2]:2025-11-28 19:48:25,730 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 8.4822e-01
[rank3]:2025-11-28 19:48:25,753 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 5.8573e-01
[rank0]:2025-11-28 19:48:25,745 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.9267e+00
[rank1]:2025-11-28 19:49:10,786 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.5375e+00
[rank2]:2025-11-28 19:49:10,786 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.7567e+00
[rank3]:2025-11-28 19:49:10,802 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.5766e+00
[rank0]:2025-11-28 19:49:10,801 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.0217e+00
[rank0]:2025-11-28 19:49:54,890 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-11-28 19:49:59,518 - INFO - Avg. fwd time: 8.3388 / Avg. bwd time: 19.3708 / Avg. batch time: 590.0151 (ms) / GPU bubble ratio: 62.43%
[rank2]:2025-11-28 19:49:59,548 - INFO - Avg. fwd time: 7.9452 / Avg. bwd time: 15.2205 / Avg. batch time: 524.7598 (ms) / GPU bubble ratio: 64.68%
[rank3]:2025-11-28 19:49:59,532 - INFO - Avg. fwd time: 13.9813 / Avg. bwd time: 40.2455 / Avg. batch time: 497.2412 (ms) / GPU bubble ratio: 12.76%
[rank1]:2025-11-28 19:49:59,568 - INFO - Avg. fwd time: 10.0114 / Avg. bwd time: 18.4006 / Avg. batch time: 557.5867 (ms) / GPU bubble ratio: 59.24%
[rank0]:2025-11-28 19:49:59,811 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.8113e+00
[rank0]:2025-11-28 19:49:59,811 - INFO -  step: 350  loss: -8.0000  grad_norm:  0.1735  memory: 12.97GiB(27.31%)  tps: 6,902  tflops: 53.96  mfu: 17.29%
[rank1]:2025-11-28 19:49:59,796 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 5.4754e-01
[rank1]:2025-11-28 19:49:59,796 - INFO -  step: 350  loss: -8.0000  grad_norm:  0.1735  memory:  9.03GiB(19.01%)  tps: 6,902  tflops: 53.96  mfu: 17.29%
[rank2]:2025-11-28 19:49:59,796 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.0421e+00
[rank2]:2025-11-28 19:49:59,796 - INFO -  step: 350  loss: -8.0000  grad_norm:  0.1735  memory:  6.43GiB(13.53%)  tps: 6,902  tflops: 53.96  mfu: 17.29%
[rank3]:2025-11-28 19:49:59,819 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 3.8106e-01
[rank3]:2025-11-28 19:49:59,823 - INFO -  step: 350  loss:  0.2535  grad_norm:  0.1735  memory: 16.39GiB(34.50%)  tps: 6,902  tflops: 53.95  mfu: 17.29%
[rank0]:2025-11-28 19:50:44,972 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.0644e+00
[rank1]:2025-11-28 19:50:44,956 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.3834e+00
[rank2]:2025-11-28 19:50:44,956 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.9030e+00
[rank3]:2025-11-28 19:50:44,972 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 3.1212e+00
[rank1]:2025-11-28 19:51:33,962 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 8.4773e-01
[rank2]:2025-11-28 19:51:33,962 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.1857e+00
[rank3]:2025-11-28 19:51:33,985 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 5.9458e-01
[rank0]:2025-11-28 19:51:33,977 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 4.9608e-01
[rank2]:2025-11-28 19:51:56,410 - INFO - Avg. fwd time: 7.9827 / Avg. bwd time: 14.9513 / Avg. batch time: 523.9391 (ms) / GPU bubble ratio: 64.98%
[rank3]:2025-11-28 19:51:56,389 - INFO - Avg. fwd time: 13.9831 / Avg. bwd time: 40.1765 / Avg. batch time: 496.7025 (ms) / GPU bubble ratio: 12.77%
[rank0]:2025-11-28 19:51:56,457 - INFO - Avg. fwd time: 8.3682 / Avg. bwd time: 19.1612 / Avg. batch time: 588.6294 (ms) / GPU bubble ratio: 62.59%
[rank1]:2025-11-28 19:51:56,432 - INFO - Avg. fwd time: 10.0564 / Avg. bwd time: 18.0516 / Avg. batch time: 556.4163 (ms) / GPU bubble ratio: 59.59%
[rank2]:2025-11-28 19:52:19,048 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.1129e-01
[rank3]:2025-11-28 19:52:19,064 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.4580e-01
[rank0]:2025-11-28 19:52:19,064 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.0821e+00
[rank1]:2025-11-28 19:52:19,048 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 5.3676e-01
[rank2]:2025-11-28 19:53:07,925 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 8.7718e-01
[rank0]:2025-11-28 19:53:07,941 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 7.8536e-01
[rank1]:2025-11-28 19:53:07,925 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 5.5446e-01
[rank3]:2025-11-28 19:53:07,949 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 6.1266e-01
[rank0]:2025-11-28 19:53:48,515 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-28 19:53:52,782 - INFO - Avg. fwd time: 13.9848 / Avg. bwd time: 40.1263 / Avg. batch time: 496.3132 (ms) / GPU bubble ratio: 12.78%
[rank0]:2025-11-28 19:53:52,819 - INFO - Avg. fwd time: 8.3898 / Avg. bwd time: 19.0033 / Avg. batch time: 587.5979 (ms) / GPU bubble ratio: 62.70%
[rank2]:2025-11-28 19:53:52,844 - INFO - Avg. fwd time: 8.0107 / Avg. bwd time: 14.7487 / Avg. batch time: 523.3362 (ms) / GPU bubble ratio: 65.21%
[rank1]:2025-11-28 19:53:52,862 - INFO - Avg. fwd time: 10.0901 / Avg. bwd time: 17.7891 / Avg. batch time: 555.5487 (ms) / GPU bubble ratio: 59.85%
[rank3]:2025-11-28 19:53:53,087 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.6852e-01
[rank3]:2025-11-28 19:53:53,091 - INFO -  step: 400  loss:  0.2257  grad_norm:  0.0783  memory: 16.39GiB(34.50%)  tps: 7,024  tflops: 54.91  mfu: 17.60%
[rank2]:2025-11-28 19:53:53,072 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 6.8420e-01
[rank2]:2025-11-28 19:53:53,072 - INFO -  step: 400  loss: -8.0000  grad_norm:  0.0783  memory:  6.43GiB(13.53%)  tps: 7,023  tflops: 54.91  mfu: 17.60%
[rank0]:2025-11-28 19:53:53,087 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 9.2515e-01
[rank0]:2025-11-28 19:53:53,088 - INFO -  step: 400  loss: -8.0000  grad_norm:  0.0783  memory: 12.97GiB(27.31%)  tps: 7,023  tflops: 54.91  mfu: 17.60%
[rank1]:2025-11-28 19:53:53,072 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 8.3306e-01
[rank1]:2025-11-28 19:53:53,072 - INFO -  step: 400  loss: -8.0000  grad_norm:  0.0783  memory:  9.03GiB(19.01%)  tps: 7,023  tflops: 54.91  mfu: 17.60%
[rank2]:2025-11-28 19:53:53,147 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p80_42_dm1/frozen_ratio_history/rank2/251128_1953_stage2_step400.svg
[rank0]:2025-11-28 19:53:53,147 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p80_42_dm1/frozen_ratio_history/rank0/251128_1953_stage0_step400.svg
[rank1]:2025-11-28 19:53:53,149 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p80_42_dm1/frozen_ratio_history/rank1/251128_1953_stage1_step400.svg
[rank3]:2025-11-28 19:53:53,233 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p80_42_dm1/pipeline_schedule/251128_1953_real_step400_rank3.svg
[rank3]:			> Batch Time: 547.89 ms, GPU Bubble Ratio: 63.24%, 64.89%, 71.04%, 26.26%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms                       | [S0,MB1,F]  9-9-18ms                      | [S0,MB2,F]  18-9-27ms                     | [S0,MB3,F]  27-8-36ms                     | [S0,MB0,B]  121-16-137ms                  | [S0,MB4,F]  138-8-146ms                   | [S0,MB1,B]  176-16-192ms                  | [S0,MB5,F]  192-8-200ms                   | [S0,MB2,B]  232-16-249ms                  | [S0,MB6,F]  249-8-257ms                   | [S0,MB3,B]  292-16-308ms                  | [S0,MB7,F]  309-8-317ms                   | [S0,MB4,B]  353-16-369ms                  | [S0,MB5,B]  412-16-429ms                  | [S0,MB6,B]  471-16-487ms                  | [S0,MB7,B]  531-16-547ms                 
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-10-20ms                     | [S1,MB1,F]  23-10-34ms                    | [S1,MB2,F]  37-10-48ms                    | [S1,MB0,B]  102-13-116ms                  | [S1,MB3,F]  119-10-130ms                  | [S1,MB1,B]  157-13-170ms                  | [S1,MB4,F]  174-10-184ms                  | [S1,MB2,B]  214-13-227ms                  | [S1,MB5,F]  231-10-241ms                  | [S1,MB3,B]  273-13-287ms                  | [S1,MB6,F]  290-10-301ms                  | [S1,MB4,B]  334-13-348ms                  | [S1,MB7,F]  351-10-362ms                  | [S1,MB5,B]  395-13-409ms                  | [S1,MB6,B]  454-13-468ms                  | [S1,MB7,B]  514-13-528ms                 
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms                     | [S2,MB1,F]  34-8-42ms                     | [S2,MB0,B]  86-11-97ms                    | [S2,MB2,F]  101-8-109ms                   | [S2,MB1,B]  141-11-152ms                  | [S2,MB3,F]  155-8-164ms                   | [S2,MB2,B]  197-11-209ms                  | [S2,MB4,F]  212-8-220ms                   | [S2,MB3,B]  257-11-269ms                  | [S2,MB5,F]  272-8-280ms                   | [S2,MB4,B]  318-11-329ms                  | [S2,MB6,F]  333-8-341ms                   | [S2,MB5,B]  379-11-390ms                  | [S2,MB7,F]  394-8-402ms                   | [S2,MB6,B]  440-11-451ms                  | [S2,MB7,B]  500-11-511ms                 
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms                    | [S3,MB0,B]  48-33-82ms                    | [S3,MB1,F]  84-11-96ms                    | [S3,MB1,B]  102-35-137ms                  | [S3,MB2,F]  139-12-152ms                  | [S3,MB2,B]  158-35-193ms                  | [S3,MB3,F]  196-14-210ms                  | [S3,MB3,B]  217-36-253ms                  | [S3,MB4,F]  256-15-271ms                  | [S3,MB4,B]  277-37-314ms                  | [S3,MB5,F]  317-15-332ms                  | [S3,MB5,B]  338-37-375ms                  | [S3,MB6,F]  377-14-392ms                  | [S3,MB6,B]  398-37-436ms                  | [S3,MB7,F]  438-14-453ms                  | [S3,MB7,B]  458-37-496ms                 
[rank3]:2025-11-28 19:53:53,283 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p80_42_dm1/frozen_ratio_history/rank3/251128_1953_stage3_step400.svg
[rank3]:2025-11-28 19:54:21,100 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-11-28 19:54:21,311 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-11-28 19:54:21,347 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-11-28 19:54:21,326 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-11-28 19:54:42,257 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.3654e+00
[rank0]:2025-11-28 19:54:42,273 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.7153e+00
[rank1]:2025-11-28 19:54:42,257 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.2889e+00
[rank3]:2025-11-28 19:54:42,281 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 9.2871e-01
[rank3]:2025-11-28 19:55:27,296 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 3.2700e-01
[rank2]:2025-11-28 19:55:27,281 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.3275e-01
[rank0]:2025-11-28 19:55:27,296 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.6937e-01
[rank1]:2025-11-28 19:55:27,281 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 5.9489e-01
[rank0]:2025-11-28 19:55:51,541 - INFO - Avg. fwd time: 8.4131 / Avg. bwd time: 18.8404 / Avg. batch time: 586.8247 (ms) / GPU bubble ratio: 62.85%
[rank1]:2025-11-28 19:55:51,591 - INFO - Avg. fwd time: 10.1252 / Avg. bwd time: 17.5179 / Avg. batch time: 554.9417 (ms) / GPU bubble ratio: 60.15%
[rank3]:2025-11-28 19:55:51,555 - INFO - Avg. fwd time: 13.9857 / Avg. bwd time: 40.1074 / Avg. batch time: 496.1684 (ms) / GPU bubble ratio: 12.78%
[rank2]:2025-11-28 19:55:51,573 - INFO - Avg. fwd time: 8.0399 / Avg. bwd time: 14.5394 / Avg. batch time: 523.0025 (ms) / GPU bubble ratio: 65.46%
[rank2]:2025-11-28 19:56:16,068 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.1201e+00
[rank0]:2025-11-28 19:56:16,083 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 7.0002e-01
[rank1]:2025-11-28 19:56:16,068 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 9.9359e-01
[rank3]:2025-11-28 19:56:16,091 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 5.2184e-01
[rank1]:2025-11-28 19:57:01,182 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.6180e+00
[rank3]:2025-11-28 19:57:01,197 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.6783e+00
[rank2]:2025-11-28 19:57:01,182 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.7830e+00
[rank0]:2025-11-28 19:57:01,197 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.1557e+00
[rank0]:2025-11-28 19:57:45,233 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-28 19:57:50,031 - INFO - Avg. fwd time: 13.9799 / Avg. bwd time: 40.1242 / Avg. batch time: 496.2543 (ms) / GPU bubble ratio: 12.78%
[rank2]:2025-11-28 19:57:50,055 - INFO - Avg. fwd time: 8.0654 / Avg. bwd time: 14.3542 / Avg. batch time: 522.8920 (ms) / GPU bubble ratio: 65.70%
[rank2]:2025-11-28 19:57:50,114 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.4627e+00
[rank2]:2025-11-28 19:57:50,115 - INFO -  step: 450  loss: -8.0000  grad_norm:  0.0970  memory:  6.43GiB(13.53%)  tps: 6,912  tflops: 54.03  mfu: 17.32%
[rank0]:2025-11-28 19:57:50,104 - INFO - Avg. fwd time: 8.4328 / Avg. bwd time: 18.6964 / Avg. batch time: 586.3281 (ms) / GPU bubble ratio: 62.98%
[rank0]:2025-11-28 19:57:50,130 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 6.8562e+00
[rank0]:2025-11-28 19:57:50,130 - INFO -  step: 450  loss: -8.0000  grad_norm:  0.0970  memory: 12.97GiB(27.31%)  tps: 6,912  tflops: 54.03  mfu: 17.32%
[rank1]:2025-11-28 19:57:50,078 - INFO - Avg. fwd time: 10.1556 / Avg. bwd time: 17.2783 / Avg. batch time: 554.5918 (ms) / GPU bubble ratio: 60.43%
[rank1]:2025-11-28 19:57:50,114 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 5.0121e+00
[rank1]:2025-11-28 19:57:50,115 - INFO -  step: 450  loss: -8.0000  grad_norm:  0.0970  memory:  9.03GiB(19.01%)  tps: 6,912  tflops: 54.03  mfu: 17.32%
[rank3]:2025-11-28 19:57:50,137 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.8573e+00
[rank3]:2025-11-28 19:57:50,141 - INFO -  step: 450  loss:  0.2466  grad_norm:  0.0970  memory: 16.39GiB(34.50%)  tps: 6,912  tflops: 54.03  mfu: 17.32%
[rank1]:2025-11-28 19:58:35,208 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 5.6761e-01
[rank3]:2025-11-28 19:58:35,224 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 3.4930e-01
[rank0]:2025-11-28 19:58:35,223 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 7.9000e-01
[rank2]:2025-11-28 19:58:35,208 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 8.5207e-01
[rank2]:2025-11-28 19:59:24,148 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.5996e+00
[rank1]:2025-11-28 19:59:24,148 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.9108e+00
[rank3]:2025-11-28 19:59:24,172 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.1979e+00
[rank0]:2025-11-28 19:59:24,163 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.6301e+00
[rank3]:2025-11-28 19:59:46,438 - INFO - Avg. fwd time: 13.9825 / Avg. bwd time: 40.0864 / Avg. batch time: 495.9712 (ms) / GPU bubble ratio: 12.79%
[rank0]:2025-11-28 19:59:46,473 - INFO - Avg. fwd time: 8.4482 / Avg. bwd time: 18.5856 / Avg. batch time: 585.5930 (ms) / GPU bubble ratio: 63.07%
[rank1]:2025-11-28 19:59:46,518 - INFO - Avg. fwd time: 10.1794 / Avg. bwd time: 17.0941 / Avg. batch time: 553.9705 (ms) / GPU bubble ratio: 60.61%
[rank2]:2025-11-28 19:59:46,500 - INFO - Avg. fwd time: 8.0852 / Avg. bwd time: 14.2118 / Avg. batch time: 522.4569 (ms) / GPU bubble ratio: 65.86%
[rank1]:2025-11-28 20:00:09,255 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.8889e+00
[rank3]:2025-11-28 20:00:09,271 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.5681e+00
[rank0]:2025-11-28 20:00:09,271 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.9442e+00
[rank2]:2025-11-28 20:00:09,255 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.7992e+00
[rank0]:2025-11-28 20:00:58,352 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.6003e+00
[rank2]:2025-11-28 20:00:58,337 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.7795e+00
[rank1]:2025-11-28 20:00:58,337 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.7054e+00
[rank3]:2025-11-28 20:00:58,360 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.8403e+00
[rank0]:2025-11-28 20:01:38,928 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-28 20:01:43,126 - INFO - Avg. fwd time: 13.9847 / Avg. bwd time: 40.0250 / Avg. batch time: 495.4981 (ms) / GPU bubble ratio: 12.80%
[rank0]:2025-11-28 20:01:43,162 - INFO - Avg. fwd time: 8.4643 / Avg. bwd time: 18.4693 / Avg. batch time: 584.6448 (ms) / GPU bubble ratio: 63.15%
[rank2]:2025-11-28 20:01:43,188 - INFO - Avg. fwd time: 8.1057 / Avg. bwd time: 14.0616 / Avg. batch time: 521.8244 (ms) / GPU bubble ratio: 66.02%
[rank1]:2025-11-28 20:01:43,207 - INFO - Avg. fwd time: 10.2038 / Avg. bwd time: 16.8999 / Avg. batch time: 553.1417 (ms) / GPU bubble ratio: 60.80%
[rank0]:2025-11-28 20:01:43,425 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.7767e+00
[rank0]:2025-11-28 20:01:43,426 - INFO -  step: 500  loss: -8.0000  grad_norm:  0.0840  memory: 12.97GiB(27.31%)  tps: 7,023  tflops: 54.90  mfu: 17.60%
[rank2]:2025-11-28 20:01:43,410 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.3524e+00
[rank2]:2025-11-28 20:01:43,411 - INFO -  step: 500  loss: -8.0000  grad_norm:  0.0840  memory:  6.43GiB(13.53%)  tps: 7,023  tflops: 54.90  mfu: 17.60%
[rank1]:2025-11-28 20:01:43,410 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 4.3026e+00
[rank1]:2025-11-28 20:01:43,411 - INFO -  step: 500  loss: -8.0000  grad_norm:  0.0840  memory:  9.03GiB(19.01%)  tps: 7,023  tflops: 54.90  mfu: 17.60%
[rank1]:2025-11-28 20:01:43,490 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p80_42_dm1/frozen_ratio_history/rank1/251128_2001_stage1_step500.svg
[rank3]:2025-11-28 20:01:43,426 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.3236e+00
[rank3]:2025-11-28 20:01:43,430 - INFO -  step: 500  loss:  0.2451  grad_norm:  0.0840  memory: 16.39GiB(34.50%)  tps: 7,023  tflops: 54.90  mfu: 17.60%
[rank0]:2025-11-28 20:01:43,482 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p80_42_dm1/frozen_ratio_history/rank0/251128_2001_stage0_step500.svg
[rank2]:2025-11-28 20:01:43,483 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p80_42_dm1/frozen_ratio_history/rank2/251128_2001_stage2_step500.svg
[rank3]:2025-11-28 20:01:43,569 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p80_42_dm1/pipeline_schedule/251128_2001_real_step500_rank3.svg
[rank3]:			> Batch Time: 547.89 ms, GPU Bubble Ratio: 63.16%, 64.79%, 70.99%, 25.98%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms                       | [S0,MB1,F]  9-9-18ms                      | [S0,MB2,F]  18-9-27ms                     | [S0,MB3,F]  27-8-36ms                     | [S0,MB0,B]  121-16-138ms                  | [S0,MB4,F]  138-8-146ms                   | [S0,MB1,B]  177-16-193ms                  | [S0,MB5,F]  193-8-202ms                   | [S0,MB2,B]  234-16-250ms                  | [S0,MB6,F]  250-8-259ms                   | [S0,MB3,B]  293-16-310ms                  | [S0,MB7,F]  310-8-318ms                   | [S0,MB4,B]  353-16-370ms                  | [S0,MB5,B]  412-16-429ms                  | [S0,MB6,B]  471-16-487ms                  | [S0,MB7,B]  531-16-547ms                 
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms                     | [S1,MB1,F]  23-10-34ms                    | [S1,MB2,F]  37-10-48ms                    | [S1,MB0,B]  103-13-116ms                  | [S1,MB3,F]  120-10-130ms                  | [S1,MB1,B]  158-13-172ms                  | [S1,MB4,F]  175-10-186ms                  | [S1,MB2,B]  215-13-229ms                  | [S1,MB5,F]  232-10-243ms                  | [S1,MB3,B]  275-13-288ms                  | [S1,MB6,F]  291-10-302ms                  | [S1,MB4,B]  335-13-348ms                  | [S1,MB7,F]  352-10-362ms                  | [S1,MB5,B]  396-13-409ms                  | [S1,MB6,B]  454-13-467ms                  | [S1,MB7,B]  514-13-527ms                 
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms                     | [S2,MB1,F]  34-8-42ms                     | [S2,MB0,B]  86-11-98ms                    | [S2,MB2,F]  101-8-110ms                   | [S2,MB1,B]  142-11-153ms                  | [S2,MB3,F]  157-8-165ms                   | [S2,MB2,B]  199-11-210ms                  | [S2,MB4,F]  214-8-222ms                   | [S2,MB3,B]  258-11-269ms                  | [S2,MB5,F]  273-8-281ms                   | [S2,MB4,B]  318-11-330ms                  | [S2,MB6,F]  333-8-342ms                   | [S2,MB5,B]  379-11-390ms                  | [S2,MB7,F]  394-8-402ms                   | [S2,MB6,B]  439-11-451ms                  | [S2,MB7,B]  500-11-511ms                 
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-43ms                    | [S3,MB0,B]  48-34-82ms                    | [S3,MB1,F]  85-11-97ms                    | [S3,MB1,B]  103-35-138ms                  | [S3,MB2,F]  140-13-154ms                  | [S3,MB2,B]  159-36-195ms                  | [S3,MB3,F]  197-14-211ms                  | [S3,MB3,B]  217-36-254ms                  | [S3,MB4,F]  257-14-272ms                  | [S3,MB4,B]  277-37-314ms                  | [S3,MB5,F]  317-15-332ms                  | [S3,MB5,B]  338-37-375ms                  | [S3,MB6,F]  377-14-392ms                  | [S3,MB6,B]  398-37-436ms                  | [S3,MB7,F]  438-14-453ms                  | [S3,MB7,B]  459-37-496ms                 
[rank3]:2025-11-28 20:01:43,612 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p80_42_dm1/frozen_ratio_history/rank3/251128_2001_stage3_step500.svg
[rank1]:2025-11-28 20:02:32,632 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.5134e-01
[rank3]:2025-11-28 20:02:32,655 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 4.6719e-01
[rank0]:2025-11-28 20:02:32,647 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 5.1183e-01
[rank2]:2025-11-28 20:02:32,631 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 7.6602e-01
[rank1]:2025-11-28 20:03:17,683 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.6327e+00
[rank3]:2025-11-28 20:03:17,698 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.2447e+00
[rank0]:2025-11-28 20:03:17,698 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.9072e+00
[rank2]:2025-11-28 20:03:17,683 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.8364e+00
[rank3]:2025-11-28 20:03:42,016 - INFO - Avg. fwd time: 13.9819 / Avg. bwd time: 40.0289 / Avg. batch time: 495.5068 (ms) / GPU bubble ratio: 12.80%
[rank2]:2025-11-28 20:03:42,038 - INFO - Avg. fwd time: 8.1238 / Avg. bwd time: 13.9258 / Avg. batch time: 521.7130 (ms) / GPU bubble ratio: 66.19%
[rank1]:2025-11-28 20:03:42,065 - INFO - Avg. fwd time: 10.2254 / Avg. bwd time: 16.7241 / Avg. batch time: 552.8531 (ms) / GPU bubble ratio: 61.00%
[rank0]:2025-11-28 20:03:42,092 - INFO - Avg. fwd time: 8.4780 / Avg. bwd time: 18.3638 / Avg. batch time: 584.2486 (ms) / GPU bubble ratio: 63.25%
[rank1]:2025-11-28 20:04:06,642 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 3.6985e+00
[rank3]:2025-11-28 20:04:06,666 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.8671e+00
[rank0]:2025-11-28 20:04:06,657 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 4.4619e+00
[rank2]:2025-11-28 20:04:06,642 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.8754e+00
[rank1]:2025-11-28 20:04:51,624 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 9.2068e-01
[rank3]:2025-11-28 20:04:51,640 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.2881e+00
[rank2]:2025-11-28 20:04:51,624 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.3209e+00
[rank0]:2025-11-28 20:04:51,640 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.5711e+00
[rank0]:2025-11-28 20:05:35,649 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-28 20:05:40,294 - INFO - Avg. fwd time: 13.9816 / Avg. bwd time: 40.0277 / Avg. batch time: 495.4948 (ms) / GPU bubble ratio: 12.80%
[rank0]:2025-11-28 20:05:40,280 - INFO - Avg. fwd time: 8.4889 / Avg. bwd time: 18.2813 / Avg. batch time: 583.8969 (ms) / GPU bubble ratio: 63.32%
[rank2]:2025-11-28 20:05:40,311 - INFO - Avg. fwd time: 8.1381 / Avg. bwd time: 13.8196 / Avg. batch time: 521.5869 (ms) / GPU bubble ratio: 66.32%
[rank1]:2025-11-28 20:05:40,335 - INFO - Avg. fwd time: 10.2422 / Avg. bwd time: 16.5865 / Avg. batch time: 552.5871 (ms) / GPU bubble ratio: 61.16%
[rank1]:2025-11-28 20:05:40,551 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 4.4059e-01
[rank1]:2025-11-28 20:05:40,551 - INFO -  step: 550  loss: -8.0000  grad_norm:  0.0790  memory:  9.03GiB(19.01%)  tps: 6,909  tflops: 54.01  mfu: 17.31%
[rank3]:2025-11-28 20:05:40,574 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 4.0681e-01
[rank3]:2025-11-28 20:05:40,578 - INFO -  step: 550  loss:  0.2496  grad_norm:  0.0790  memory: 16.39GiB(34.50%)  tps: 6,909  tflops: 54.01  mfu: 17.31%
[rank0]:2025-11-28 20:05:40,566 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.9364e-01
[rank0]:2025-11-28 20:05:40,567 - INFO -  step: 550  loss: -8.0000  grad_norm:  0.0790  memory: 12.97GiB(27.31%)  tps: 6,909  tflops: 54.01  mfu: 17.31%
[rank2]:2025-11-28 20:05:40,551 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.9759e-01
[rank2]:2025-11-28 20:05:40,551 - INFO -  step: 550  loss: -8.0000  grad_norm:  0.0790  memory:  6.43GiB(13.53%)  tps: 6,909  tflops: 54.01  mfu: 17.31%
[rank1]:2025-11-28 20:06:25,620 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 9.4405e-01
[rank3]:2025-11-28 20:06:25,636 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.8133e+00
[rank0]:2025-11-28 20:06:25,635 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.6983e+00
[rank2]:2025-11-28 20:06:25,620 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.9210e+00
[rank2]:2025-11-28 20:07:14,465 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 8.1613e-01
[rank1]:2025-11-28 20:07:14,465 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 3.1157e-01
[rank3]:2025-11-28 20:07:14,488 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 5.6498e-01
[rank0]:2025-11-28 20:07:14,480 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 9.3290e-01
[rank3]:2025-11-28 20:07:36,659 - INFO - Avg. fwd time: 13.9808 / Avg. bwd time: 40.0004 / Avg. batch time: 495.2704 (ms) / GPU bubble ratio: 12.81%
[rank1]:2025-11-28 20:07:36,738 - INFO - Avg. fwd time: 10.2598 / Avg. bwd time: 16.4391 / Avg. batch time: 552.0917 (ms) / GPU bubble ratio: 61.31%
[rank0]:2025-11-28 20:07:36,695 - INFO - Avg. fwd time: 8.5005 / Avg. bwd time: 18.1933 / Avg. batch time: 583.3097 (ms) / GPU bubble ratio: 63.39%
[rank2]:2025-11-28 20:07:36,719 - INFO - Avg. fwd time: 8.1531 / Avg. bwd time: 13.7061 / Avg. batch time: 521.2407 (ms) / GPU bubble ratio: 66.45%
[rank1]:2025-11-28 20:07:59,473 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.0353e+00
[rank3]:2025-11-28 20:07:59,488 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.2856e+00
[rank0]:2025-11-28 20:07:59,488 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.5046e+00
[rank2]:2025-11-28 20:07:59,473 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.3225e+00
[rank3]:2025-11-28 20:08:48,355 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 5.5769e-01
[rank1]:2025-11-28 20:08:48,332 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 9.9486e-01
[rank0]:2025-11-28 20:08:48,347 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.2232e+00
[rank2]:2025-11-28 20:08:48,331 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 9.8475e-01
[rank0]:2025-11-28 20:09:28,904 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-28 20:09:33,373 - INFO - Avg. fwd time: 13.9813 / Avg. bwd time: 39.9519 / Avg. batch time: 494.8856 (ms) / GPU bubble ratio: 12.82%
[rank1]:2025-11-28 20:09:33,421 - INFO - Avg. fwd time: 10.2763 / Avg. bwd time: 16.3047 / Avg. batch time: 551.4620 (ms) / GPU bubble ratio: 61.44%
[rank2]:2025-11-28 20:09:33,396 - INFO - Avg. fwd time: 8.1672 / Avg. bwd time: 13.6025 / Avg. batch time: 520.7456 (ms) / GPU bubble ratio: 66.56%
[rank2]:2025-11-28 20:09:33,458 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 9.3715e-01
[rank2]:2025-11-28 20:09:33,459 - INFO -  step: 600  loss: -8.0000  grad_norm:  0.0885  memory:  6.43GiB(13.53%)  tps: 7,035  tflops: 54.99  mfu: 17.63%
[rank3]:2025-11-28 20:09:33,474 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.2169e+00
[rank3]:2025-11-28 20:09:33,477 - INFO -  step: 600  loss:  0.2363  grad_norm:  0.0885  memory: 16.39GiB(34.50%)  tps: 7,035  tflops: 55.00  mfu: 17.63%
[rank0]:2025-11-28 20:09:33,448 - INFO - Avg. fwd time: 8.5114 / Avg. bwd time: 18.1133 / Avg. batch time: 582.5985 (ms) / GPU bubble ratio: 63.44%
[rank0]:2025-11-28 20:09:33,474 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.9477e+00
[rank0]:2025-11-28 20:09:33,474 - INFO -  step: 600  loss: -8.0000  grad_norm:  0.0885  memory: 12.97GiB(27.31%)  tps: 7,035  tflops: 54.99  mfu: 17.63%
[rank0]:2025-11-28 20:09:33,531 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p80_42_dm1/frozen_ratio_history/rank0/251128_2009_stage0_step600.svg
[rank1]:2025-11-28 20:09:33,458 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 5.6373e-01
[rank1]:2025-11-28 20:09:33,459 - INFO -  step: 600  loss: -8.0000  grad_norm:  0.0885  memory:  9.03GiB(19.01%)  tps: 7,035  tflops: 54.99  mfu: 17.63%
[rank2]:2025-11-28 20:09:33,532 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p80_42_dm1/frozen_ratio_history/rank2/251128_2009_stage2_step600.svg
[rank3]:2025-11-28 20:09:33,616 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p80_42_dm1/pipeline_schedule/251128_2009_real_step600_rank3.svg
[rank3]:			> Batch Time: 547.38 ms, GPU Bubble Ratio: 63.21%, 64.93%, 71.04%, 26.05%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms                       | [S0,MB1,F]  9-9-18ms                      | [S0,MB2,F]  18-9-27ms                     | [S0,MB3,F]  27-8-36ms                     | [S0,MB0,B]  121-16-137ms                  | [S0,MB4,F]  137-8-146ms                   | [S0,MB1,B]  175-16-192ms                  | [S0,MB5,F]  192-8-200ms                   | [S0,MB2,B]  232-16-248ms                  | [S0,MB6,F]  248-8-257ms                   | [S0,MB3,B]  292-16-309ms                  | [S0,MB7,F]  309-8-317ms                   | [S0,MB4,B]  353-16-370ms                  | [S0,MB5,B]  412-16-428ms                  | [S0,MB6,B]  471-16-487ms                  | [S0,MB7,B]  531-16-547ms                 
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms                     | [S1,MB1,F]  23-10-34ms                    | [S1,MB2,F]  37-10-48ms                    | [S1,MB0,B]  102-13-116ms                  | [S1,MB3,F]  119-10-130ms                  | [S1,MB1,B]  157-13-170ms                  | [S1,MB4,F]  174-10-184ms                  | [S1,MB2,B]  214-13-227ms                  | [S1,MB5,F]  230-10-241ms                  | [S1,MB3,B]  273-13-287ms                  | [S1,MB6,F]  290-10-301ms                  | [S1,MB4,B]  334-13-348ms                  | [S1,MB7,F]  351-10-362ms                  | [S1,MB5,B]  395-13-409ms                  | [S1,MB6,B]  454-13-468ms                  | [S1,MB7,B]  514-13-527ms                 
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms                     | [S2,MB1,F]  34-8-42ms                     | [S2,MB0,B]  86-11-97ms                    | [S2,MB2,F]  101-8-109ms                   | [S2,MB1,B]  140-11-152ms                  | [S2,MB3,F]  155-8-164ms                   | [S2,MB2,B]  197-11-209ms                  | [S2,MB4,F]  212-8-221ms                   | [S2,MB3,B]  257-11-268ms                  | [S2,MB5,F]  272-8-280ms                   | [S2,MB4,B]  318-11-329ms                  | [S2,MB6,F]  333-8-341ms                   | [S2,MB5,B]  379-11-390ms                  | [S2,MB7,F]  394-8-402ms                   | [S2,MB6,B]  440-11-451ms                  | [S2,MB7,B]  499-11-511ms                 
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms                    | [S3,MB0,B]  48-33-82ms                    | [S3,MB1,F]  84-11-96ms                    | [S3,MB1,B]  102-35-137ms                  | [S3,MB2,F]  139-12-152ms                  | [S3,MB2,B]  158-35-193ms                  | [S3,MB3,F]  196-14-210ms                  | [S3,MB3,B]  217-36-253ms                  | [S3,MB4,F]  256-15-271ms                  | [S3,MB4,B]  277-37-314ms                  | [S3,MB5,F]  317-15-332ms                  | [S3,MB5,B]  337-37-375ms                  | [S3,MB6,F]  377-14-392ms                  | [S3,MB6,B]  398-37-436ms                  | [S3,MB7,F]  438-14-453ms                  | [S3,MB7,B]  459-37-496ms                 
[rank1]:2025-11-28 20:09:33,542 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p80_42_dm1/frozen_ratio_history/rank1/251128_2009_stage1_step600.svg
[rank3]:2025-11-28 20:09:33,662 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p80_42_dm1/frozen_ratio_history/rank3/251128_2009_stage3_step600.svg
[rank2]:2025-11-28 20:10:22,529 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.6719e-01
[rank3]:2025-11-28 20:10:22,553 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 4.2608e-01
[rank0]:2025-11-28 20:10:22,545 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.4245e+00
[rank1]:2025-11-28 20:10:22,529 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 3.2161e-01
[rank3]:2025-11-28 20:11:07,527 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 3.0956e+00
[rank0]:2025-11-28 20:11:07,527 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.7591e+00
[rank1]:2025-11-28 20:11:07,512 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.4676e+00
[rank2]:2025-11-28 20:11:07,512 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.9712e+00
[rank3]:2025-11-28 20:11:31,844 - INFO - Avg. fwd time: 13.9808 / Avg. bwd time: 39.9518 / Avg. batch time: 494.8824 (ms) / GPU bubble ratio: 12.82%
[rank0]:2025-11-28 20:11:31,831 - INFO - Avg. fwd time: 8.5197 / Avg. bwd time: 18.0499 / Avg. batch time: 582.3537 (ms) / GPU bubble ratio: 63.50%
[rank1]:2025-11-28 20:11:31,880 - INFO - Avg. fwd time: 10.2888 / Avg. bwd time: 16.1987 / Avg. batch time: 551.2827 (ms) / GPU bubble ratio: 61.56%
[rank2]:2025-11-28 20:11:31,861 - INFO - Avg. fwd time: 8.1780 / Avg. bwd time: 13.5207 / Avg. batch time: 520.6738 (ms) / GPU bubble ratio: 66.66%
[rank0]:2025-11-28 20:11:56,498 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.9157e+00
[rank3]:2025-11-28 20:11:56,506 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.0863e+00
[rank1]:2025-11-28 20:11:56,483 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.7960e+00
[rank2]:2025-11-28 20:11:56,483 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.1837e+00
[rank1]:2025-11-28 20:12:41,579 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 8.4418e-01
[rank2]:2025-11-28 20:12:41,579 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.3793e+00
[rank0]:2025-11-28 20:12:41,594 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 7.4675e-01
[rank3]:2025-11-28 20:12:41,595 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.9378e+00
[rank0]:2025-11-28 20:13:25,592 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-11-28 20:13:30,186 - INFO - Avg. fwd time: 8.1901 / Avg. bwd time: 13.4323 / Avg. batch time: 520.7123 (ms) / GPU bubble ratio: 66.78%
[rank0]:2025-11-28 20:13:30,157 - INFO - Avg. fwd time: 8.5291 / Avg. bwd time: 17.9815 / Avg. batch time: 582.2062 (ms) / GPU bubble ratio: 63.57%
[rank3]:2025-11-28 20:13:30,168 - INFO - Avg. fwd time: 13.9785 / Avg. bwd time: 39.9707 / Avg. batch time: 495.0162 (ms) / GPU bubble ratio: 12.81%
[rank1]:2025-11-28 20:13:30,204 - INFO - Avg. fwd time: 10.3030 / Avg. bwd time: 16.0843 / Avg. batch time: 551.2060 (ms) / GPU bubble ratio: 61.70%
[rank1]:2025-11-28 20:13:30,421 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.1467e+00
[rank1]:2025-11-28 20:13:30,422 - INFO -  step: 650  loss: -8.0000  grad_norm:  0.0741  memory:  9.03GiB(19.01%)  tps: 6,914  tflops: 54.05  mfu: 17.32%
[rank2]:2025-11-28 20:13:30,421 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.9133e+00
[rank2]:2025-11-28 20:13:30,422 - INFO -  step: 650  loss: -8.0000  grad_norm:  0.0741  memory:  6.43GiB(13.53%)  tps: 6,914  tflops: 54.05  mfu: 17.32%
[rank0]:2025-11-28 20:13:30,437 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 8.9274e-01
[rank0]:2025-11-28 20:13:30,437 - INFO -  step: 650  loss: -8.0000  grad_norm:  0.0741  memory: 12.97GiB(27.31%)  tps: 6,914  tflops: 54.05  mfu: 17.32%
[rank3]:2025-11-28 20:13:30,445 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.2268e+00
[rank3]:2025-11-28 20:13:30,448 - INFO -  step: 650  loss:  0.2493  grad_norm:  0.0741  memory: 16.39GiB(34.50%)  tps: 6,914  tflops: 54.05  mfu: 17.32%
[rank0]:2025-11-28 20:14:15,381 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 8.9445e-01
[rank3]:2025-11-28 20:14:15,381 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.1234e+00
[rank1]:2025-11-28 20:14:15,366 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.2943e+00
[rank2]:2025-11-28 20:14:15,366 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 9.9681e-01
[rank1]:2025-11-28 20:15:03,980 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 6.8838e-01
[rank2]:2025-11-28 20:15:03,979 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.5426e-01
[rank3]:2025-11-28 20:15:04,003 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.0713e-01
[rank0]:2025-11-28 20:15:03,995 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 5.7643e-01
[rank3]:2025-11-28 20:15:26,445 - INFO - Avg. fwd time: 13.9780 / Avg. bwd time: 39.9318 / Avg. batch time: 494.7023 (ms) / GPU bubble ratio: 12.82%
[rank2]:2025-11-28 20:15:26,469 - INFO - Avg. fwd time: 8.2004 / Avg. bwd time: 13.3502 / Avg. batch time: 520.3101 (ms) / GPU bubble ratio: 66.86%
[rank1]:2025-11-28 20:15:26,494 - INFO - Avg. fwd time: 10.3153 / Avg. bwd time: 15.9781 / Avg. batch time: 550.6971 (ms) / GPU bubble ratio: 61.80%
[rank0]:2025-11-28 20:15:26,522 - INFO - Avg. fwd time: 8.5367 / Avg. bwd time: 17.9179 / Avg. batch time: 581.6307 (ms) / GPU bubble ratio: 63.61%
[rank1]:2025-11-28 20:15:48,968 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.9349e+00
[rank2]:2025-11-28 20:15:48,968 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.9416e+00
[rank3]:2025-11-28 20:15:48,983 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.4904e+00
[rank0]:2025-11-28 20:15:48,983 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.6522e+00
[rank0]:2025-11-28 20:16:37,772 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.4626e+00
[rank2]:2025-11-28 20:16:37,757 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.6924e+00
[rank1]:2025-11-28 20:16:37,757 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.7643e+00
[rank3]:2025-11-28 20:16:37,780 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.6730e+00
[rank0]:2025-11-28 20:17:18,236 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-28 20:17:22,495 - INFO - Avg. fwd time: 8.2089 / Avg. bwd time: 13.2848 / Avg. batch time: 520.0456 (ms) / GPU bubble ratio: 66.94%
[rank3]:2025-11-28 20:17:22,433 - INFO - Avg. fwd time: 13.9793 / Avg. bwd time: 39.9063 / Avg. batch time: 494.5091 (ms) / GPU bubble ratio: 12.83%
[rank0]:2025-11-28 20:17:22,470 - INFO - Avg. fwd time: 8.5430 / Avg. bwd time: 17.8673 / Avg. batch time: 581.2259 (ms) / GPU bubble ratio: 63.65%
[rank1]:2025-11-28 20:17:22,514 - INFO - Avg. fwd time: 10.3253 / Avg. bwd time: 15.8935 / Avg. batch time: 550.3465 (ms) / GPU bubble ratio: 61.89%
[rank0]:2025-11-28 20:17:22,730 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.8672e+00
[rank0]:2025-11-28 20:17:22,730 - INFO -  step: 700  loss: -8.0000  grad_norm:  0.0788  memory: 12.97GiB(27.31%)  tps: 7,053  tflops: 55.14  mfu: 17.67%
[rank2]:2025-11-28 20:17:22,715 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.3167e+00
[rank1]:2025-11-28 20:17:22,715 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 3.2317e+00
[rank2]:2025-11-28 20:17:22,715 - INFO -  step: 700  loss: -8.0000  grad_norm:  0.0788  memory:  6.43GiB(13.53%)  tps: 7,053  tflops: 55.14  mfu: 17.67%
[rank1]:2025-11-28 20:17:22,715 - INFO -  step: 700  loss: -8.0000  grad_norm:  0.0788  memory:  9.03GiB(19.01%)  tps: 7,053  tflops: 55.14  mfu: 17.67%
[rank1]:2025-11-28 20:17:22,791 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p80_42_dm1/frozen_ratio_history/rank1/251128_2017_stage1_step700.svg
[rank2]:2025-11-28 20:17:22,791 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p80_42_dm1/frozen_ratio_history/rank2/251128_2017_stage2_step700.svg
[rank3]:2025-11-28 20:17:22,730 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.7654e+00
[rank3]:2025-11-28 20:17:22,733 - INFO -  step: 700  loss:  0.2145  grad_norm:  0.0788  memory: 16.39GiB(34.50%)  tps: 7,053  tflops: 55.14  mfu: 17.67%
[rank0]:2025-11-28 20:17:22,788 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p80_42_dm1/frozen_ratio_history/rank0/251128_2017_stage0_step700.svg
[rank3]:2025-11-28 20:17:22,872 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p80_42_dm1/pipeline_schedule/251128_2017_real_step700_rank3.svg
[rank3]:			> Batch Time: 547.86 ms, GPU Bubble Ratio: 63.25%, 64.94%, 71.08%, 26.08%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms                       | [S0,MB1,F]  9-9-18ms                      | [S0,MB2,F]  18-9-27ms                     | [S0,MB3,F]  27-8-36ms                     | [S0,MB0,B]  121-16-137ms                  | [S0,MB4,F]  137-8-146ms                   | [S0,MB1,B]  175-16-192ms                  | [S0,MB5,F]  192-8-200ms                   | [S0,MB2,B]  232-16-249ms                  | [S0,MB6,F]  249-8-257ms                   | [S0,MB3,B]  292-16-309ms                  | [S0,MB7,F]  309-8-317ms                   | [S0,MB4,B]  353-16-369ms                  | [S0,MB5,B]  412-16-429ms                  | [S0,MB6,B]  471-16-487ms                  | [S0,MB7,B]  531-16-547ms                 
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms                     | [S1,MB1,F]  23-10-34ms                    | [S1,MB2,F]  37-10-48ms                    | [S1,MB0,B]  102-13-116ms                  | [S1,MB3,F]  119-10-130ms                  | [S1,MB1,B]  157-13-170ms                  | [S1,MB4,F]  174-10-184ms                  | [S1,MB2,B]  214-13-227ms                  | [S1,MB5,F]  231-10-241ms                  | [S1,MB3,B]  273-13-287ms                  | [S1,MB6,F]  290-10-301ms                  | [S1,MB4,B]  334-13-348ms                  | [S1,MB7,F]  351-10-362ms                  | [S1,MB5,B]  396-13-409ms                  | [S1,MB6,B]  454-13-468ms                  | [S1,MB7,B]  514-13-528ms                 
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms                     | [S2,MB1,F]  34-8-42ms                     | [S2,MB0,B]  86-11-97ms                    | [S2,MB2,F]  101-8-109ms                   | [S2,MB1,B]  140-11-152ms                  | [S2,MB3,F]  155-8-164ms                   | [S2,MB2,B]  197-11-209ms                  | [S2,MB4,F]  212-8-221ms                   | [S2,MB3,B]  257-11-269ms                  | [S2,MB5,F]  272-8-280ms                   | [S2,MB4,B]  318-11-330ms                  | [S2,MB6,F]  333-8-341ms                   | [S2,MB5,B]  379-11-391ms                  | [S2,MB7,F]  394-8-402ms                   | [S2,MB6,B]  440-11-451ms                  | [S2,MB7,B]  500-11-511ms                 
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms                    | [S3,MB0,B]  48-33-82ms                    | [S3,MB1,F]  84-11-96ms                    | [S3,MB1,B]  102-35-137ms                  | [S3,MB2,F]  139-13-152ms                  | [S3,MB2,B]  158-35-194ms                  | [S3,MB3,F]  196-14-210ms                  | [S3,MB3,B]  217-36-253ms                  | [S3,MB4,F]  256-15-271ms                  | [S3,MB4,B]  277-37-315ms                  | [S3,MB5,F]  317-15-332ms                  | [S3,MB5,B]  338-37-375ms                  | [S3,MB6,F]  378-15-393ms                  | [S3,MB6,B]  398-37-436ms                  | [S3,MB7,F]  438-14-453ms                  | [S3,MB7,B]  459-37-497ms                 
[rank3]:2025-11-28 20:17:22,920 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p80_42_dm1/frozen_ratio_history/rank3/251128_2017_stage3_step700.svg
[rank1]:2025-11-28 20:18:11,511 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.6884e+00
[rank2]:2025-11-28 20:18:11,511 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.0368e+00
[rank3]:2025-11-28 20:18:11,534 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.5952e+00
[rank0]:2025-11-28 20:18:11,526 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.6901e+00
[rank1]:2025-11-28 20:18:56,562 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.6604e+00
[rank2]:2025-11-28 20:18:56,562 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.3461e+00
[rank3]:2025-11-28 20:18:56,577 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.5543e+00
[rank0]:2025-11-28 20:18:56,577 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.7530e+00
[rank1]:2025-11-28 20:19:20,648 - INFO - Avg. fwd time: 10.3359 / Avg. bwd time: 15.8015 / Avg. batch time: 550.0979 (ms) / GPU bubble ratio: 61.99%
[rank2]:2025-11-28 20:19:20,629 - INFO - Avg. fwd time: 8.2178 / Avg. bwd time: 13.2138 / Avg. batch time: 519.8911 (ms) / GPU bubble ratio: 67.02%
[rank3]:2025-11-28 20:19:20,611 - INFO - Avg. fwd time: 13.9770 / Avg. bwd time: 39.8968 / Avg. batch time: 494.4153 (ms) / GPU bubble ratio: 12.83%
[rank0]:2025-11-28 20:19:20,596 - INFO - Avg. fwd time: 8.5497 / Avg. bwd time: 17.8122 / Avg. batch time: 580.9177 (ms) / GPU bubble ratio: 63.70%
[rank1]:2025-11-28 20:19:45,384 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.2475e+00
[rank2]:2025-11-28 20:19:45,384 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.2185e+00
[rank3]:2025-11-28 20:19:45,408 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 9.8026e-01
[rank0]:2025-11-28 20:19:45,399 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1548e+00
[rank1]:2025-11-28 20:20:30,378 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 4.2897e+00
[rank2]:2025-11-28 20:20:30,377 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.9489e+00
[rank3]:2025-11-28 20:20:30,393 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 3.1782e+00
[rank0]:2025-11-28 20:20:30,393 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.9531e+00
[rank0]:2025-11-28 20:21:14,261 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-11-28 20:21:19,122 - INFO - Avg. fwd time: 8.2264 / Avg. bwd time: 13.1477 / Avg. batch time: 519.9217 (ms) / GPU bubble ratio: 67.11%
[rank3]:2025-11-28 20:21:19,098 - INFO - Avg. fwd time: 13.9754 / Avg. bwd time: 39.9111 / Avg. batch time: 494.5172 (ms) / GPU bubble ratio: 12.83%
[rank2]:2025-11-28 20:21:19,187 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 8.0041e-01
[rank2]:2025-11-28 20:21:19,188 - INFO -  step: 750  loss: -8.0000  grad_norm:  0.0940  memory:  6.43GiB(13.53%)  tps: 6,929  tflops: 54.16  mfu: 17.36%
[rank1]:2025-11-28 20:21:19,148 - INFO - Avg. fwd time: 10.3460 / Avg. bwd time: 15.7160 / Avg. batch time: 550.0426 (ms) / GPU bubble ratio: 62.09%
[rank1]:2025-11-28 20:21:19,187 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 4.4267e-01
[rank1]:2025-11-28 20:21:19,188 - INFO -  step: 750  loss: -8.0000  grad_norm:  0.0940  memory:  9.03GiB(19.01%)  tps: 6,929  tflops: 54.16  mfu: 17.36%
[rank3]:2025-11-28 20:21:19,210 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 4.4402e-01
[rank3]:2025-11-28 20:21:19,214 - INFO -  step: 750  loss:  0.2620  grad_norm:  0.0940  memory: 16.39GiB(34.50%)  tps: 6,928  tflops: 54.16  mfu: 17.36%
[rank0]:2025-11-28 20:21:19,177 - INFO - Avg. fwd time: 8.5560 / Avg. bwd time: 17.7610 / Avg. batch time: 580.8091 (ms) / GPU bubble ratio: 63.75%
[rank0]:2025-11-28 20:21:19,202 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.4344e+00
[rank0]:2025-11-28 20:21:19,203 - INFO -  step: 750  loss: -8.0000  grad_norm:  0.0940  memory: 12.97GiB(27.31%)  tps: 6,929  tflops: 54.16  mfu: 17.36%
[rank2]:2025-11-28 20:22:04,171 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 9.1327e-01
[rank1]:2025-11-28 20:22:04,172 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.4911e+00
[rank3]:2025-11-28 20:22:04,187 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.5570e+00
[rank0]:2025-11-28 20:22:04,187 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.7799e+00
[rank1]:2025-11-28 20:22:53,052 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.1389e+00
[rank2]:2025-11-28 20:22:53,052 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 6.4540e-01
[rank3]:2025-11-28 20:22:53,076 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 6.8242e-01
[rank0]:2025-11-28 20:22:53,068 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.9780e+00
[rank3]:2025-11-28 20:23:15,271 - INFO - Avg. fwd time: 13.9756 / Avg. bwd time: 39.8906 / Avg. batch time: 494.3553 (ms) / GPU bubble ratio: 12.83%
[rank2]:2025-11-28 20:23:15,332 - INFO - Avg. fwd time: 8.2332 / Avg. bwd time: 13.0947 / Avg. batch time: 519.7016 (ms) / GPU bubble ratio: 67.17%
[rank0]:2025-11-28 20:23:15,307 - INFO - Avg. fwd time: 8.5611 / Avg. bwd time: 17.7199 / Avg. batch time: 580.4748 (ms) / GPU bubble ratio: 63.78%
[rank1]:2025-11-28 20:23:15,351 - INFO - Avg. fwd time: 10.3541 / Avg. bwd time: 15.6474 / Avg. batch time: 549.7526 (ms) / GPU bubble ratio: 62.16%
[rank2]:2025-11-28 20:23:38,032 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.9404e+00
[rank3]:2025-11-28 20:23:38,047 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.9046e+00
[rank0]:2025-11-28 20:23:38,047 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.9474e+00
[rank1]:2025-11-28 20:23:38,032 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.6806e+00
[rank1]:2025-11-28 20:24:26,776 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 3.7687e-01
[rank3]:2025-11-28 20:24:26,800 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.5057e-01
[rank2]:2025-11-28 20:24:26,776 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.4954e-01
[rank0]:2025-11-28 20:24:26,792 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.7937e-01
[rank0]:2025-11-28 20:25:07,312 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-28 20:25:11,569 - INFO - Avg. fwd time: 13.9763 / Avg. bwd time: 39.8544 / Avg. batch time: 494.0711 (ms) / GPU bubble ratio: 12.84%
[rank2]:2025-11-28 20:25:11,634 - INFO - Avg. fwd time: 8.2409 / Avg. bwd time: 13.0367 / Avg. batch time: 519.3534 (ms) / GPU bubble ratio: 67.22%
[rank0]:2025-11-28 20:25:11,607 - INFO - Avg. fwd time: 8.5669 / Avg. bwd time: 17.6751 / Avg. batch time: 580.0034 (ms) / GPU bubble ratio: 63.80%
[rank1]:2025-11-28 20:25:11,653 - INFO - Avg. fwd time: 10.3632 / Avg. bwd time: 15.5724 / Avg. batch time: 549.3284 (ms) / GPU bubble ratio: 62.23%
[rank1]:2025-11-28 20:25:11,855 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.7908e+00
[rank1]:2025-11-28 20:25:11,856 - INFO -  step: 800  loss: -8.0000  grad_norm:  0.0794  memory:  9.03GiB(19.01%)  tps: 7,042  tflops: 55.05  mfu: 17.64%
[rank1]:2025-11-28 20:25:11,856 - INFO -  final step: 800  loss: -8.0000  grad_norm:  0.0794  tps: 7,304  tflops: 57.10  mfu: 16.71%
[rank1]:2025-11-28 20:25:11,856 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-11-28 20:25:11,857 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank3]:2025-11-28 20:25:11,871 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.6263e+00
[rank3]:2025-11-28 20:25:11,874 - INFO -  step: 800  loss:  0.2554  grad_norm:  0.0794  memory: 16.39GiB(34.50%)  tps: 7,042  tflops: 55.05  mfu: 17.64%
[rank3]:2025-11-28 20:25:11,875 - INFO -  final step: 800  loss:  0.2554  grad_norm:  0.0794  tps: 7,309  tflops: 57.13  mfu: 16.83%
[rank3]:2025-11-28 20:25:11,876 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-11-28 20:25:11,877 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank2]:2025-11-28 20:25:11,855 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.2354e+00
[rank2]:2025-11-28 20:25:11,855 - INFO -  step: 800  loss: -8.0000  grad_norm:  0.0794  memory:  6.43GiB(13.53%)  tps: 7,042  tflops: 55.05  mfu: 17.64%
[rank2]:2025-11-28 20:25:11,855 - INFO -  final step: 800  loss: -8.0000  grad_norm:  0.0794  tps: 7,304  tflops: 57.10  mfu: 16.69%
[rank2]:2025-11-28 20:25:11,855 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-28 20:25:11,856 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-11-28 20:25:11,870 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.8643e+00
[rank0]:2025-11-28 20:25:11,871 - INFO -  step: 800  loss: -8.0000  grad_norm:  0.0794  memory: 12.97GiB(27.31%)  tps: 7,042  tflops: 55.05  mfu: 17.64%
[rank0]:2025-11-28 20:25:11,871 - INFO -  final step: 800  loss: -8.0000  grad_norm:  0.0794  tps: 7,305  tflops: 57.11  mfu: 16.72%
[rank0]:2025-11-28 20:25:11,871 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-28 20:25:11,872 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-11-28 20:25:13,799 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank2]:2025-11-28 20:25:13,875 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p80_42_dm1/frozen_ratio_history/rank2/251128_2025_stage2_final800.svg
[rank0]:2025-11-28 20:25:13,872 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p80_42_dm1/frozen_ratio_history/rank0/251128_2025_stage0_final800.svg
[rank1]:2025-11-28 20:25:13,876 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p80_42_dm1/frozen_ratio_history/rank1/251128_2025_stage1_final800.svg
[rank3]:2025-11-28 20:25:13,953 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p80_42_dm1/pipeline_schedule/251128_2025_real_final800_rank3.svg
[rank3]:			> Batch Time: 587.89 ms, GPU Bubble Ratio: 65.78%, 67.32%, 73.03%, 25.50%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms                       | [S0,MB1,F]  9-9-18ms                      | [S0,MB2,F]  18-9-27ms                     | [S0,MB3,F]  27-8-36ms                     | [S0,MB0,B]  125-16-142ms                  | [S0,MB4,F]  142-8-150ms                   | [S0,MB1,B]  184-16-201ms                  | [S0,MB5,F]  201-8-209ms                   | [S0,MB2,B]  247-16-263ms                  | [S0,MB6,F]  264-8-272ms                   | [S0,MB3,B]  311-16-327ms                  | [S0,MB7,F]  328-8-336ms                   | [S0,MB4,B]  376-16-392ms                  | [S0,MB5,B]  440-16-456ms                  | [S0,MB6,B]  506-16-523ms                  | [S0,MB7,B]  571-16-587ms                 
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms                     | [S1,MB1,F]  23-10-34ms                    | [S1,MB2,F]  37-10-48ms                    | [S1,MB0,B]  104-13-117ms                  | [S1,MB3,F]  124-10-134ms                  | [S1,MB1,B]  166-13-179ms                  | [S1,MB4,F]  183-10-193ms                  | [S1,MB2,B]  228-13-242ms                  | [S1,MB5,F]  245-10-256ms                  | [S1,MB3,B]  292-13-306ms                  | [S1,MB6,F]  309-10-320ms                  | [S1,MB4,B]  357-13-370ms                  | [S1,MB7,F]  374-10-385ms                  | [S1,MB5,B]  423-13-437ms                  | [S1,MB6,B]  489-13-503ms                  | [S1,MB7,B]  554-13-567ms                 
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms                     | [S2,MB1,F]  34-8-42ms                     | [S2,MB0,B]  87-11-98ms                    | [S2,MB2,F]  102-8-111ms                   | [S2,MB1,B]  148-11-159ms                  | [S2,MB3,F]  164-8-173ms                   | [S2,MB2,B]  212-11-223ms                  | [S2,MB4,F]  227-8-235ms                   | [S2,MB3,B]  275-11-287ms                  | [S2,MB5,F]  291-8-299ms                   | [S2,MB4,B]  340-11-351ms                  | [S2,MB6,F]  356-8-364ms                   | [S2,MB5,B]  405-11-417ms                  | [S2,MB7,F]  422-8-430ms                   | [S2,MB6,B]  473-11-484ms                  | [S2,MB7,B]  538-11-549ms                 
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms                    | [S3,MB0,B]  48-34-83ms                    | [S3,MB1,F]  85-11-96ms                    | [S3,MB1,B]  103-40-143ms                  | [S3,MB2,F]  146-13-159ms                  | [S3,MB2,B]  165-41-207ms                  | [S3,MB3,F]  210-14-224ms                  | [S3,MB3,B]  229-42-271ms                  | [S3,MB4,F]  274-14-288ms                  | [S3,MB4,B]  293-42-335ms                  | [S3,MB5,F]  338-15-353ms                  | [S3,MB5,B]  359-41-401ms                  | [S3,MB6,F]  404-14-418ms                  | [S3,MB6,B]  424-42-467ms                  | [S3,MB7,F]  472-14-486ms                  | [S3,MB7,B]  491-42-533ms                 
[rank2]:2025-11-28 20:25:14,034 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p80_42_dm1/frozen_params_histogram/251128_2025_rank2_stage2.svg
[rank2]:	> Counts Sum: 1728, Total Sum: 2700 (64.00%), Ratio(%) per element: [85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-11-28 20:25:14,034 - INFO - Destroying the purge thread.
[rank0]:2025-11-28 20:25:14,028 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p80_42_dm1/frozen_params_histogram/251128_2025_rank0_stage0.svg
[rank0]:	> Counts Sum: 1827, Total Sum: 2775 (65.84%), Ratio(%) per element: [0.0, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 81.33, 81.33, 81.33, 81.33, 81.33, 81.33, 81.33, 81.33, 81.33, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-11-28 20:25:14,028 - INFO - Sleeping 2 seconds for other ranks to complete
[rank1]:2025-11-28 20:25:14,028 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p80_42_dm1/frozen_params_histogram/251128_2025_rank1_stage1.svg
[rank1]:	> Counts Sum: 2322, Total Sum: 3375 (68.80%), Ratio(%) per element: [88.0, 88.0, 88.0, 88.0, 88.0, 88.0, 88.0, 88.0, 88.0, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-11-28 20:25:14,028 - INFO - Destroying the purge thread.
[rank3]:2025-11-28 20:25:14,082 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p80_42_dm1/pipeline_schedule/251128_2025_thry_final800_rank3.svg
[rank3]:			> Batch Time: 344.00 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-10-10ms                     | [S0,MB1,F]  10-10-20ms                    | [S0,MB2,F]  20-10-31ms                    | [S0,MB3,F]  31-10-41ms                    | [S0,MB0,B]  104-20-125ms                  | [S0,MB4,F]  125-10-135ms                  | [S0,MB1,B]  135-20-156ms                  | [S0,MB5,F]  156-10-166ms                  | [S0,MB2,B]  166-20-187ms                  | [S0,MB6,F]  187-10-198ms                  | [S0,MB3,B]  198-20-218ms                  | [S0,MB7,F]  218-10-229ms                  | [S0,MB4,B]  229-20-250ms                  | [S0,MB5,B]  260-20-281ms                  | [S0,MB6,B]  291-20-312ms                  | [S0,MB7,B]  323-20-344ms                 
[rank3]:			  [Rank 1]	[S1,MB0,F]  10-10-20ms                    | [S1,MB1,F]  20-10-31ms                    | [S1,MB2,F]  31-10-41ms                    | [S1,MB0,B]  83-20-104ms                   | [S1,MB3,F]  104-10-114ms                  | [S1,MB1,B]  114-20-135ms                  | [S1,MB4,F]  135-10-145ms                  | [S1,MB2,B]  145-20-166ms                  | [S1,MB5,F]  166-10-177ms                  | [S1,MB3,B]  177-20-198ms                  | [S1,MB6,F]  198-10-208ms                  | [S1,MB4,B]  208-20-229ms                  | [S1,MB7,F]  229-10-239ms                  | [S1,MB5,B]  239-20-260ms                  | [S1,MB6,B]  271-20-291ms                  | [S1,MB7,B]  302-20-323ms                 
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-10-31ms                    | [S2,MB1,F]  31-10-41ms                    | [S2,MB0,B]  62-20-83ms                    | [S2,MB2,F]  83-10-93ms                    | [S2,MB1,B]  93-20-114ms                   | [S2,MB3,F]  114-10-125ms                  | [S2,MB2,B]  125-20-145ms                  | [S2,MB4,F]  145-10-156ms                  | [S2,MB3,B]  156-20-177ms                  | [S2,MB5,F]  177-10-187ms                  | [S2,MB4,B]  187-20-208ms                  | [S2,MB6,F]  208-10-218ms                  | [S2,MB5,B]  218-20-239ms                  | [S2,MB7,F]  239-10-250ms                  | [S2,MB6,B]  250-20-271ms                  | [S2,MB7,B]  281-20-302ms                 
[rank3]:			  [Rank 3]	[S3,MB0,F]  31-10-41ms                    | [S3,MB0,B]  41-20-62ms                    | [S3,MB1,F]  62-10-72ms                    | [S3,MB1,B]  72-20-93ms                    | [S3,MB2,F]  93-10-104ms                   | [S3,MB2,B]  104-20-125ms                  | [S3,MB3,F]  125-10-135ms                  | [S3,MB3,B]  135-20-156ms                  | [S3,MB4,F]  156-10-166ms                  | [S3,MB4,B]  166-20-187ms                  | [S3,MB5,F]  187-10-198ms                  | [S3,MB5,B]  198-20-218ms                  | [S3,MB6,F]  218-10-229ms                  | [S3,MB6,B]  229-20-250ms                  | [S3,MB7,F]  250-10-260ms                  | [S3,MB7,B]  260-20-281ms                 
[rank3]:2025-11-28 20:25:14,129 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p80_42_dm1/frozen_ratio_history/rank3/251128_2025_stage3_final800.svg
[rank3]:2025-11-28 20:25:14,260 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p80_42_dm1/frozen_params_histogram/251128_2025_rank3_stage3.svg
[rank3]:	> Counts Sum: 666, Total Sum: 2175 (30.62%), Ratio(%) per element: [49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-11-28 20:25:14,261 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank2]:2025-11-28 20:25:14,519 - INFO - Process group destroyed
[rank1]:2025-11-28 20:25:14,512 - INFO - Process group destroyed
[rank3]:wandb: uploading history steps 15-16, summary, console lines 355-378
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–ˆâ–‡â–„â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–ˆâ–‡â–„â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 4.48351
[rank3]:wandb:               final/avg_loss 0.25539
[rank3]:wandb:             final/avg_mfu(%) 16.82632
[rank3]:wandb:             final/avg_tflops 57.13491
[rank3]:wandb:    final/avg_throughput(tps) 7308.55372
[rank3]:wandb:              final/grad_norm 0.07937
[rank3]:wandb:               final/max_loss 0.25539
[rank3]:wandb:                    grad_norm 0.07937
[rank3]:wandb: loss_metrics/global_avg_loss 0.25539
[rank3]:wandb: loss_metrics/global_max_loss 0.25539
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1116_1F1B_auto_p80_42_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/c2k1o0ws
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1116_1F1B_auto_p80_42_dm1/20251128-1921/wandb/run-20251128_192139-c2k1o0ws/logs
[rank3]:2025-11-28 20:25:15,981 - INFO - Process group destroyed
[rank0]:2025-11-28 20:25:16,028 - INFO - Training completed
[rank0]:2025-11-28 20:25:16,029 - INFO - Destroying the purge thread.
[rank0]:2025-11-28 20:25:16,513 - INFO - Process group destroyed
[rank2]:Stage 2: Modules to keep: {'layers.12', 'layers.9', 'layers.11', 'layers.10'}
[rank1]:Stage 1: Modules to keep: {'layers.4', 'layers.5', 'layers.8', 'layers.7', 'layers.6'}
[rank0]:Stage 0: Modules to keep: {'layers.2', 'layers.0', 'tok_embeddings', 'layers.1', 'layers.3'}
[rank3]:Stage 3: Modules to keep: {'layers.14', 'layers.15', 'output', 'layers.13', 'norm'}
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1116_autofreeze/config_1116.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "AutoFreeze configuration experiment on different PERCENTILE values."
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1116_1F1B_auto_p80_42_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1116_1F1B_auto_p80_42_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1116_1F1B_auto_p80_42_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1116_1F1B_auto_p80_42_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1116_1F1B_auto_p80_42_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1116_1F1B_auto_p80_42_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 42
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: 1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1116_1F1B_auto_p80_42_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1116_1F1B_auto_p80_42_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: auto
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.05
[rank3]:		- percentile: 80
[rank3]:
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
