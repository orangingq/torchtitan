
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 12. 27. (í† ) 02:23:25 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 1,2,3,4
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1116_autofreeze/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1116_autofreeze/1226_1F1B_auto_p70_42.log
âœ”ï¸AutoFreeze configuration experiment on different PERCENTILE values.
âœ”ï¸Running with autofreeze (percentile=70) x 1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1116_autofreeze/config_1226.toml --job.description="AutoFreeze configuration experiment on different PERCENTILE values." --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=auto --freezing.percentile=70
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank0]:2025-12-27 02:23:32,069 - Starting job: "AutoFreeze configuration experiment on different PERCENTILE values."
[rank1]:2025-12-27 02:23:32,045 - Starting job: "AutoFreeze configuration experiment on different PERCENTILE values."
[rank0]:2025-12-27 02:23:32,289 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-12-27 02:23:32,292 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-27 02:23:32,294 - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-12-27 02:23:32,295 - Loading tokenizer from tokenizer.json
[rank2]:2025-12-27 02:23:32,253 - Starting job: "AutoFreeze configuration experiment on different PERCENTILE values."
[rank1]:2025-12-27 02:23:32,260 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-12-27 02:23:32,262 - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-12-27 02:23:32,290 - Starting job: "AutoFreeze configuration experiment on different PERCENTILE values."
[rank2]:2025-12-27 02:23:32,463 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-12-27 02:23:32,466 - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-12-27 02:23:32,522 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-12-27 02:23:32,525 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-27 02:23:32,684 - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank0]:2025-12-27 02:23:35,585 - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank0]:2025-12-27 02:23:35,751 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-12-27 02:23:35,793 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-27 02:23:35,793 - Model llama3 1B size: 1,498,482,688 total parameters
[rank1]:2025-12-27 02:23:35,735 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-12-27 02:23:35,787 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-27 02:23:35,816 - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-12-27 02:23:35,816 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2025-12-27 02:23:35,814 - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-12-27 02:23:35,814 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2025-12-27 02:23:36,028 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-27 02:23:36,028 - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-12-27 02:23:36,028 - CUDA memory usage for model: 1.90GiB(3.99%)
[rank1]:2025-12-27 02:23:36,021 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-27 02:23:36,021 - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-12-27 02:23:36,021 - CUDA memory usage for model: 1.13GiB(2.39%)
[rank2]:2025-12-27 02:23:36,226 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-12-27 02:23:36,266 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-27 02:23:36,294 - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-12-27 02:23:36,294 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank2]:2025-12-27 02:23:36,480 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-27 02:23:36,480 - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-12-27 02:23:36,481 - CUDA memory usage for model: 0.92GiB(1.94%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run yg2b53gb
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1226_1F1B_auto_p70_42_dm1/20251227-0223/wandb/run-20251227_022337-yg2b53gb
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1226_1F1B_auto_p70_42_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/yg2b53gb
[rank3]:2025-12-27 02:23:38,279 - WandB logging enabled
[rank3]:2025-12-27 02:23:38,279 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-12-27 02:23:38,316 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-27 02:23:38,345 - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-12-27 02:23:38,345 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank2]:2025-12-27 02:23:38,545 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-27 02:23:38,545 - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1226_1F1B_auto_p70_42_dm1
[rank0]:2025-12-27 02:23:38,545 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-27 02:23:38,546 - Trainer is initialized with local batch size 16, global batch size 128, gradient accumulation steps 8, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2025-12-27 02:23:38,546 - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank1]:2025-12-27 02:23:38,545 - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-12-27 02:23:38,528 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-27 02:23:38,529 - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-12-27 02:23:38,530 - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2025-12-27 02:23:38,545 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-27 02:23:41,167 - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-12-27 02:23:41,167 - Finished loading the checkpoint in 2.62 seconds.
[rank0]:2025-12-27 02:23:41,167 - Training starts at step 1
[rank3]:2025-12-27 02:23:46,832 -  step:  1  loss: 10.6088  grad_norm: 116.5370  memory: 12.97GiB(27.31%)  tps: 3,849  tflops: 30.09  mfu: 9.65%
[rank3]:2025-12-27 02:23:46,832 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-12-27 02:23:46,820 -  step:  1  loss: -8.0000  grad_norm: 116.5370  memory:  5.20GiB(10.94%)  tps: 3,105  tflops: 24.27  mfu: 7.78%
[rank2]:2025-12-27 02:23:46,821 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-12-27 02:23:46,831 -  step:  1  loss: -8.0000  grad_norm: 116.5370  memory:  7.10GiB(14.94%)  tps: 2,967  tflops: 23.20  mfu: 7.43%
[rank1]:2025-12-27 02:23:46,831 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-27 02:23:46,857 -  step:  1  loss: -8.0000  grad_norm: 116.5370  memory:  9.62GiB(20.24%)  tps: 2,962  tflops: 23.15  mfu: 7.42%
[rank0]:2025-12-27 02:23:46,858 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-12-27 02:25:49,983 - Avg. fwd time: 13.6292 / Avg. bwd time: 42.7134 / Avg. batch time: 514.3451 (ms) / GPU bubble ratio: 12.37%
[rank0]:2025-12-27 02:25:50,068 - Avg. fwd time: 7.6595 / Avg. bwd time: 24.9650 / Avg. batch time: 625.9504 (ms) / GPU bubble ratio: 58.30%
[rank1]:2025-12-27 02:25:50,038 - Avg. fwd time: 9.2819 / Avg. bwd time: 24.7839 / Avg. batch time: 587.2383 (ms) / GPU bubble ratio: 53.59%
[rank2]:2025-12-27 02:25:50,009 - Avg. fwd time: 7.4072 / Avg. bwd time: 19.9604 / Avg. batch time: 547.2720 (ms) / GPU bubble ratio: 59.99%
[rank0]:2025-12-27 02:27:53,959 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-27 02:27:59,018 - Avg. fwd time: 13.7165 / Avg. bwd time: 42.9086 / Avg. batch time: 516.5227 (ms) / GPU bubble ratio: 12.30%
[rank2]:2025-12-27 02:27:59,043 - Avg. fwd time: 7.4035 / Avg. bwd time: 20.0054 / Avg. batch time: 549.0751 (ms) / GPU bubble ratio: 60.07%
[rank1]:2025-12-27 02:27:59,073 - Avg. fwd time: 9.2989 / Avg. bwd time: 24.8466 / Avg. batch time: 588.7070 (ms) / GPU bubble ratio: 53.60%
[rank1]:2025-12-27 02:27:59,128 -  step: 50  loss: -8.0000  grad_norm: 12.5977  memory:  9.50GiB(19.99%)  tps: 6,364  tflops: 49.75  mfu: 15.95%
[rank0]:2025-12-27 02:27:59,103 - Avg. fwd time: 7.6641 / Avg. bwd time: 25.0094 / Avg. batch time: 627.0884 (ms) / GPU bubble ratio: 58.32%
[rank0]:2025-12-27 02:27:59,139 -  step: 50  loss: -8.0000  grad_norm: 12.5977  memory: 13.42GiB(28.26%)  tps: 6,364  tflops: 49.75  mfu: 15.95%
[rank3]:2025-12-27 02:27:59,136 -  step: 50  loss:  9.9090  grad_norm: 12.5977  memory: 16.39GiB(34.50%)  tps: 6,364  tflops: 49.75  mfu: 15.95%
[rank2]:2025-12-27 02:27:59,124 -  step: 50  loss: -8.0000  grad_norm: 12.5977  memory:  6.98GiB(14.69%)  tps: 6,364  tflops: 49.75  mfu: 15.95%
[rank3]:2025-12-27 02:28:45,712 - Freezing Ratio: [Stage3] 0.00, Threshold: 0.0000e+00
[rank2]:2025-12-27 02:28:45,701 - Freezing Ratio: [Stage2] 0.00, Threshold: 0.0000e+00
[rank1]:2025-12-27 02:28:45,704 - Freezing Ratio: [Stage1] 0.00, Threshold: 0.0000e+00
[rank0]:2025-12-27 02:28:45,716 - Freezing Ratio: [Stage0] 0.00, Threshold: 0.0000e+00
[rank2]:2025-12-27 02:29:37,367 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.1537e+00
[rank1]:2025-12-27 02:29:37,371 - Freezing Ratio: [Stage1] 0.00, Threshold: 1.9506e+00
[rank3]:2025-12-27 02:29:37,379 - Freezing Ratio: [Stage3] 0.62, Threshold: 2.3602e+00
[rank0]:2025-12-27 02:29:37,383 - Freezing Ratio: [Stage0] 0.00, Threshold: 5.2378e+00
[rank1]:2025-12-27 02:30:05,671 - Avg. fwd time: 9.3023 / Avg. bwd time: 24.8841 / Avg. batch time: 584.9618 (ms) / GPU bubble ratio: 53.25%
[rank3]:2025-12-27 02:30:05,624 - Avg. fwd time: 13.8100 / Avg. bwd time: 42.4651 / Avg. batch time: 513.6816 (ms) / GPU bubble ratio: 12.36%
[rank0]:2025-12-27 02:30:05,701 - Avg. fwd time: 7.6701 / Avg. bwd time: 25.0372 / Avg. batch time: 623.2525 (ms) / GPU bubble ratio: 58.02%
[rank2]:2025-12-27 02:30:05,641 - Avg. fwd time: 7.4863 / Avg. bwd time: 19.3431 / Avg. batch time: 545.4261 (ms) / GPU bubble ratio: 60.65%
[rank1]:2025-12-27 02:30:24,513 - Freezing Ratio: [Stage1] 0.00, Threshold: 1.8064e+00
[rank3]:2025-12-27 02:30:24,512 - Freezing Ratio: [Stage3] 0.00, Threshold: 2.7100e+00
[rank0]:2025-12-27 02:30:24,524 - Freezing Ratio: [Stage0] 0.49, Threshold: 2.6828e+00
[rank2]:2025-12-27 02:30:24,497 - Freezing Ratio: [Stage2] 0.00, Threshold: 1.7217e+00
[rank2]:2025-12-27 02:31:15,619 - Freezing Ratio: [Stage2] 0.75, Threshold: 6.5723e-01
[rank0]:2025-12-27 02:31:15,627 - Freezing Ratio: [Stage0] 0.49, Threshold: 1.3028e+01
[rank1]:2025-12-27 02:31:15,623 - Freezing Ratio: [Stage1] 0.00, Threshold: 4.1912e+00
[rank3]:2025-12-27 02:31:15,630 - Freezing Ratio: [Stage3] 0.62, Threshold: 3.5551e+00
[rank2]:2025-12-27 02:32:01,971 - Freezing Ratio: [Stage2] 0.00, Threshold: 4.6909e+00
[rank0]:2025-12-27 02:32:01,970 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-27 02:32:01,990 - Freezing Ratio: [Stage0] 0.49, Threshold: 3.4963e+00
[rank1]:2025-12-27 02:32:01,987 - Freezing Ratio: [Stage1] 0.60, Threshold: 2.9611e+00
[rank3]:2025-12-27 02:32:01,987 - Freezing Ratio: [Stage3] 0.00, Threshold: 2.3107e+00
[rank1]:2025-12-27 02:32:06,930 - Avg. fwd time: 9.3053 / Avg. bwd time: 24.8215 / Avg. batch time: 578.0607 (ms) / GPU bubble ratio: 52.77%
[rank3]:2025-12-27 02:32:06,882 - Avg. fwd time: 13.8943 / Avg. bwd time: 41.6762 / Avg. batch time: 508.0204 (ms) / GPU bubble ratio: 12.49%
[rank2]:2025-12-27 02:32:06,908 - Avg. fwd time: 7.6127 / Avg. bwd time: 18.3198 / Avg. batch time: 538.6615 (ms) / GPU bubble ratio: 61.49%
[rank2]:2025-12-27 02:32:06,975 -  step: 100  loss: -8.0000  grad_norm:  7.5103  memory:  6.98GiB(14.69%)  tps: 6,610  tflops: 51.68  mfu: 16.56%
[rank0]:2025-12-27 02:32:06,955 - Avg. fwd time: 7.8213 / Avg. bwd time: 23.8458 / Avg. batch time: 615.1031 (ms) / GPU bubble ratio: 58.81%
[rank0]:2025-12-27 02:32:06,982 -  step: 100  loss: -8.0000  grad_norm:  7.5103  memory: 13.42GiB(28.26%)  tps: 6,611  tflops: 51.68  mfu: 16.56%
[rank1]:2025-12-27 02:32:06,968 -  step: 100  loss: -8.0000  grad_norm:  7.5103  memory:  9.50GiB(19.99%)  tps: 6,611  tflops: 51.68  mfu: 16.56%
[rank3]:2025-12-27 02:32:06,987 -  step: 100  loss:  8.6025  grad_norm:  7.5103  memory: 16.39GiB(34.50%)  tps: 6,610  tflops: 51.68  mfu: 16.56%
[rank2]:2025-12-27 02:32:07,063 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p70_42_dm1/frozen_ratio_history/rank2/251227_0232_stage2_step100.svg
[rank0]:2025-12-27 02:32:07,062 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p70_42_dm1/frozen_ratio_history/rank0/251227_0232_stage0_step100.svg
[rank1]:2025-12-27 02:32:07,075 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p70_42_dm1/frozen_ratio_history/rank1/251227_0232_stage1_step100.svg
[rank3]:2025-12-27 02:32:07,151 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p70_42_dm1/pipeline_schedule/251227_0232_step100_rank3.svg
[rank3]:			> Batch Time: 566.42 ms, GPU Bubble Ratio: 60.70%, 51.36%, 71.71%, 28.16%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-8-18ms       | [S0,MB2,F]  18-8-26ms      | [S0,MB3,F]  26-8-35ms      | [S0,MB0,B]  134-19-153ms   | [S0,MB4,F]  153-7-161ms    | [S0,MB1,B]  189-19-208ms   | [S0,MB5,F]  208-7-216ms    | [S0,MB2,B]  246-19-266ms   | [S0,MB6,F]  266-7-274ms    | [S0,MB3,B]  307-19-326ms   | [S0,MB7,F]  326-7-334ms    | [S0,MB4,B]  368-19-388ms   | [S0,MB5,B]  428-19-447ms   | [S0,MB6,B]  487-19-507ms   | [S0,MB7,B]  547-19-566ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-8-32ms      | [S1,MB2,F]  35-8-44ms      | [S1,MB0,B]  103-25-128ms   | [S1,MB3,F]  132-9-141ms    | [S1,MB1,B]  158-25-183ms   | [S1,MB4,F]  187-9-196ms    | [S1,MB2,B]  216-25-241ms   | [S1,MB5,F]  245-9-254ms    | [S1,MB3,B]  276-25-301ms   | [S1,MB6,F]  305-9-314ms    | [S1,MB4,B]  338-25-363ms   | [S1,MB7,F]  367-9-376ms    | [S1,MB5,B]  399-25-424ms   | [S1,MB6,B]  459-25-484ms   | [S1,MB7,B]  518-24-543ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-8-40ms      | [S2,MB0,B]  86-11-98ms     | [S2,MB2,F]  101-8-110ms    | [S2,MB1,B]  141-11-153ms   | [S2,MB3,F]  156-8-165ms    | [S2,MB2,B]  199-11-211ms   | [S2,MB4,F]  214-8-223ms    | [S2,MB3,B]  260-11-271ms   | [S2,MB5,F]  275-8-283ms    | [S2,MB4,B]  321-11-333ms   | [S2,MB6,F]  336-8-345ms    | [S2,MB5,B]  383-11-394ms   | [S2,MB7,F]  398-8-406ms    | [S2,MB6,B]  444-11-455ms   | [S2,MB7,B]  504-11-515ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  48-34-83ms     | [S3,MB1,F]  85-11-96ms     | [S3,MB1,B]  102-35-137ms   | [S3,MB2,F]  140-13-153ms   | [S3,MB2,B]  159-36-196ms   | [S3,MB3,F]  197-15-213ms   | [S3,MB3,B]  219-37-256ms   | [S3,MB4,F]  258-15-273ms   | [S3,MB4,B]  280-37-317ms   | [S3,MB5,F]  320-15-335ms   | [S3,MB5,B]  341-38-379ms   | [S3,MB6,F]  381-14-396ms   | [S3,MB6,B]  402-38-440ms   | [S3,MB7,F]  442-14-456ms   | [S3,MB7,B]  462-37-500ms  
[rank0]:2025-12-27 02:32:07,224 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p70_42_dm1/frozen_params_histogram/251227_0232_rank0_stage0.svg
[rank0]:	> Counts Sum: 54, Total Sum: 185 (29.19%), Ratio(%) per element: [0.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-12-27 02:32:07,238 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p70_42_dm1/frozen_params_histogram/251227_0232_rank1_stage1.svg
[rank1]:	> Counts Sum: 27, Total Sum: 225 (12.00%), Ratio(%) per element: [20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-27 02:32:07,194 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p70_42_dm1/frozen_ratio_history/rank3/251227_0232_stage3_step100.svg
[rank2]:2025-12-27 02:32:07,215 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p70_42_dm1/frozen_params_histogram/251227_0232_rank2_stage2.svg
[rank2]:	> Counts Sum: 54, Total Sum: 180 (30.00%), Ratio(%) per element: [40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-27 02:32:07,328 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p70_42_dm1/frozen_params_histogram/251227_0232_rank3_stage3.svg
[rank3]:	> Counts Sum: 36, Total Sum: 145 (24.83%), Ratio(%) per element: [40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-12-27 02:32:52,484 - Freezing Ratio: [Stage1] 0.00, Threshold: 1.8197e+00
[rank3]:2025-12-27 02:32:52,503 - Freezing Ratio: [Stage3] 0.62, Threshold: 6.6947e-01
[rank2]:2025-12-27 02:32:52,492 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.6321e-01
[rank0]:2025-12-27 02:32:52,499 - Freezing Ratio: [Stage0] 0.49, Threshold: 1.9265e+00
[rank3]:2025-12-27 02:33:38,983 - Freezing Ratio: [Stage3] 0.00, Threshold: 3.7439e+00
[rank2]:2025-12-27 02:33:38,968 - Freezing Ratio: [Stage2] 0.00, Threshold: 2.6829e+00
[rank0]:2025-12-27 02:33:38,987 - Freezing Ratio: [Stage0] 0.49, Threshold: 2.2270e+00
[rank1]:2025-12-27 02:33:38,984 - Freezing Ratio: [Stage1] 0.60, Threshold: 2.1710e+00
[rank3]:2025-12-27 02:34:09,007 - Avg. fwd time: 13.9176 / Avg. bwd time: 41.4185 / Avg. batch time: 506.1322 (ms) / GPU bubble ratio: 12.54%
[rank2]:2025-12-27 02:34:09,033 - Avg. fwd time: 7.6523 / Avg. bwd time: 17.9800 / Avg. batch time: 536.4534 (ms) / GPU bubble ratio: 61.78%
[rank0]:2025-12-27 02:34:09,080 - Avg. fwd time: 7.9356 / Avg. bwd time: 22.9448 / Avg. batch time: 610.9288 (ms) / GPU bubble ratio: 59.56%
[rank1]:2025-12-27 02:34:09,055 - Avg. fwd time: 9.4131 / Avg. bwd time: 23.8216 / Avg. batch time: 574.8138 (ms) / GPU bubble ratio: 53.75%
[rank2]:2025-12-27 02:34:29,382 - Freezing Ratio: [Stage2] 0.75, Threshold: 5.9769e-01
[rank0]:2025-12-27 02:34:29,390 - Freezing Ratio: [Stage0] 0.49, Threshold: 8.7201e+00
[rank1]:2025-12-27 02:34:29,374 - Freezing Ratio: [Stage1] 0.00, Threshold: 2.1092e+00
[rank3]:2025-12-27 02:34:29,394 - Freezing Ratio: [Stage3] 0.62, Threshold: 2.4836e+00
[rank2]:2025-12-27 02:35:15,695 - Freezing Ratio: [Stage2] 0.00, Threshold: 2.5852e+00
[rank0]:2025-12-27 02:35:15,714 - Freezing Ratio: [Stage0] 0.73, Threshold: 4.0870e+00
[rank1]:2025-12-27 02:35:15,710 - Freezing Ratio: [Stage1] 0.60, Threshold: 1.5052e+00
[rank3]:2025-12-27 02:35:15,710 - Freezing Ratio: [Stage3] 0.00, Threshold: 3.3346e+00
[rank2]:2025-12-27 02:36:05,687 - Freezing Ratio: [Stage2] 0.75, Threshold: 8.6469e-02
[rank1]:2025-12-27 02:36:05,679 - Freezing Ratio: [Stage1] 0.00, Threshold: 1.5290e+00
[rank0]:2025-12-27 02:36:05,681 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-27 02:36:05,690 - Freezing Ratio: [Stage0] 0.49, Threshold: 2.2824e+00
[rank3]:2025-12-27 02:36:05,698 - Freezing Ratio: [Stage3] 0.62, Threshold: 6.2206e-01
[rank2]:2025-12-27 02:36:10,289 - Avg. fwd time: 7.6870 / Avg. bwd time: 17.6984 / Avg. batch time: 534.6427 (ms) / GPU bubble ratio: 62.02%
[rank1]:2025-12-27 02:36:10,319 - Avg. fwd time: 9.4811 / Avg. bwd time: 23.2132 / Avg. batch time: 572.3695 (ms) / GPU bubble ratio: 54.30%
[rank0]:2025-12-27 02:36:10,344 - Avg. fwd time: 8.0368 / Avg. bwd time: 22.1544 / Avg. batch time: 607.6710 (ms) / GPU bubble ratio: 60.25%
[rank3]:2025-12-27 02:36:10,271 - Avg. fwd time: 13.9432 / Avg. bwd time: 41.2080 / Avg. batch time: 504.6450 (ms) / GPU bubble ratio: 12.57%
[rank2]:2025-12-27 02:36:10,354 -  step: 150  loss: -8.0000  grad_norm:  9.8707  memory:  6.98GiB(14.69%)  tps: 6,732  tflops: 52.63  mfu: 16.87%
[rank1]:2025-12-27 02:36:10,368 -  step: 150  loss: -8.0000  grad_norm:  9.8707  memory:  9.50GiB(19.99%)  tps: 6,731  tflops: 52.62  mfu: 16.87%
[rank0]:2025-12-27 02:36:10,372 -  step: 150  loss: -8.0000  grad_norm:  9.8707  memory: 13.42GiB(28.26%)  tps: 6,732  tflops: 52.62  mfu: 16.87%
[rank3]:2025-12-27 02:36:10,370 -  step: 150  loss:  4.9453  grad_norm:  9.8707  memory: 16.39GiB(34.50%)  tps: 6,732  tflops: 52.63  mfu: 16.87%
[rank2]:2025-12-27 02:36:52,168 - Freezing Ratio: [Stage2] 0.00, Threshold: 2.1276e+00
[rank1]:2025-12-27 02:36:52,184 - Freezing Ratio: [Stage1] 0.60, Threshold: 1.9801e+00
[rank0]:2025-12-27 02:36:52,187 - Freezing Ratio: [Stage0] 0.73, Threshold: 2.2697e+00
[rank3]:2025-12-27 02:36:52,183 - Freezing Ratio: [Stage3] 0.00, Threshold: 4.4042e+00
[rank1]:2025-12-27 02:37:42,393 - Freezing Ratio: [Stage1] 0.00, Threshold: 3.1838e+00
[rank2]:2025-12-27 02:37:42,401 - Freezing Ratio: [Stage2] 0.75, Threshold: 3.9834e-01
[rank3]:2025-12-27 02:37:42,413 - Freezing Ratio: [Stage3] 0.62, Threshold: 4.8455e+00
[rank0]:2025-12-27 02:37:42,404 - Freezing Ratio: [Stage0] 0.49, Threshold: 4.8393e+00
[rank1]:2025-12-27 02:38:10,166 - Avg. fwd time: 9.5060 / Avg. bwd time: 22.9754 / Avg. batch time: 569.5507 (ms) / GPU bubble ratio: 54.38%
[rank2]:2025-12-27 02:38:10,134 - Avg. fwd time: 7.7370 / Avg. bwd time: 17.3017 / Avg. batch time: 532.0797 (ms) / GPU bubble ratio: 62.35%
[rank3]:2025-12-27 02:38:10,116 - Avg. fwd time: 13.9805 / Avg. bwd time: 40.9043 / Avg. batch time: 502.5087 (ms) / GPU bubble ratio: 12.62%
[rank0]:2025-12-27 02:38:10,191 - Avg. fwd time: 8.1104 / Avg. bwd time: 21.5899 / Avg. batch time: 604.2839 (ms) / GPU bubble ratio: 60.68%
[rank2]:2025-12-27 02:38:28,792 - Freezing Ratio: [Stage2] 0.00, Threshold: 4.5976e+00
[rank3]:2025-12-27 02:38:28,807 - Freezing Ratio: [Stage3] 0.00, Threshold: 4.9842e+00
[rank0]:2025-12-27 02:38:28,811 - Freezing Ratio: [Stage0] 0.73, Threshold: 2.3751e+00
[rank1]:2025-12-27 02:38:28,807 - Freezing Ratio: [Stage1] 0.60, Threshold: 4.1688e+00
[rank1]:2025-12-27 02:39:18,718 - Freezing Ratio: [Stage1] 0.00, Threshold: 1.2039e+00
[rank2]:2025-12-27 02:39:18,726 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.6078e-01
[rank0]:2025-12-27 02:39:18,730 - Freezing Ratio: [Stage0] 0.49, Threshold: 1.1501e+00
[rank3]:2025-12-27 02:39:18,738 - Freezing Ratio: [Stage3] 0.62, Threshold: 4.1859e-01
[rank0]:2025-12-27 02:40:05,165 - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-12-27 02:40:05,183 - Freezing Ratio: [Stage1] 0.60, Threshold: 2.1605e+00
[rank2]:2025-12-27 02:40:05,167 - Freezing Ratio: [Stage2] 0.00, Threshold: 2.4672e+00
[rank0]:2025-12-27 02:40:05,186 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.6215e+00
[rank3]:2025-12-27 02:40:05,183 - Freezing Ratio: [Stage3] 0.00, Threshold: 3.1541e+00
[rank3]:2025-12-27 02:40:10,167 - Avg. fwd time: 14.0049 / Avg. bwd time: 40.7060 / Avg. batch time: 501.1127 (ms) / GPU bubble ratio: 12.66%
[rank2]:2025-12-27 02:40:10,195 - Avg. fwd time: 7.7688 / Avg. bwd time: 17.0466 / Avg. batch time: 530.4053 (ms) / GPU bubble ratio: 62.57%
[rank0]:2025-12-27 02:40:10,241 - Avg. fwd time: 8.1663 / Avg. bwd time: 21.1521 / Avg. batch time: 601.9200 (ms) / GPU bubble ratio: 61.03%
[rank0]:2025-12-27 02:40:10,264 -  step: 200  loss: -8.0000  grad_norm:  7.1573  memory: 13.42GiB(28.26%)  tps: 6,830  tflops: 53.39  mfu: 17.11%
[rank3]:2025-12-27 02:40:10,272 -  step: 200  loss:  1.3338  grad_norm:  7.1573  memory: 16.39GiB(34.50%)  tps: 6,830  tflops: 53.39  mfu: 17.11%
[rank1]:2025-12-27 02:40:10,218 - Avg. fwd time: 9.5297 / Avg. bwd time: 22.7543 / Avg. batch time: 567.6404 (ms) / GPU bubble ratio: 54.50%
[rank1]:2025-12-27 02:40:10,253 -  step: 200  loss: -8.0000  grad_norm:  7.1573  memory:  9.50GiB(19.99%)  tps: 6,830  tflops: 53.39  mfu: 17.11%
[rank2]:2025-12-27 02:40:10,260 -  step: 200  loss: -8.0000  grad_norm:  7.1573  memory:  6.98GiB(14.69%)  tps: 6,829  tflops: 53.39  mfu: 17.11%
[rank2]:2025-12-27 02:40:10,326 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p70_42_dm1/frozen_ratio_history/rank2/251227_0240_stage2_step200.svg
[rank0]:2025-12-27 02:40:10,325 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p70_42_dm1/frozen_ratio_history/rank0/251227_0240_stage0_step200.svg
[rank1]:2025-12-27 02:40:10,324 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p70_42_dm1/frozen_ratio_history/rank1/251227_0240_stage1_step200.svg
[rank3]:2025-12-27 02:40:10,411 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p70_42_dm1/pipeline_schedule/251227_0240_step200_rank3.svg
[rank3]:			> Batch Time: 567.38 ms, GPU Bubble Ratio: 60.86%, 51.84%, 71.88%, 28.14%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-8-18ms       | [S0,MB2,F]  18-8-26ms      | [S0,MB3,F]  26-8-35ms      | [S0,MB0,B]  133-19-153ms   | [S0,MB4,F]  153-7-161ms    | [S0,MB1,B]  187-19-207ms   | [S0,MB5,F]  207-7-215ms    | [S0,MB2,B]  245-19-265ms   | [S0,MB6,F]  265-7-273ms    | [S0,MB3,B]  306-19-326ms   | [S0,MB7,F]  326-7-334ms    | [S0,MB4,B]  368-19-387ms   | [S0,MB5,B]  428-19-447ms   | [S0,MB6,B]  487-19-506ms   | [S0,MB7,B]  548-19-567ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-8-32ms      | [S1,MB2,F]  35-8-44ms      | [S1,MB0,B]  103-25-128ms   | [S1,MB3,F]  132-9-141ms    | [S1,MB1,B]  157-25-182ms   | [S1,MB4,F]  186-8-195ms    | [S1,MB2,B]  215-24-240ms   | [S1,MB5,F]  244-8-253ms    | [S1,MB3,B]  276-24-301ms   | [S1,MB6,F]  305-8-313ms    | [S1,MB4,B]  338-24-363ms   | [S1,MB7,F]  366-8-375ms    | [S1,MB5,B]  400-24-424ms   | [S1,MB6,B]  459-24-484ms   | [S1,MB7,B]  519-24-544ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-8-40ms      | [S2,MB0,B]  86-11-98ms     | [S2,MB2,F]  101-8-110ms    | [S2,MB1,B]  141-11-152ms   | [S2,MB3,F]  156-8-164ms    | [S2,MB2,B]  198-11-210ms   | [S2,MB4,F]  213-8-222ms    | [S2,MB3,B]  259-11-271ms   | [S2,MB5,F]  274-8-283ms    | [S2,MB4,B]  321-11-333ms   | [S2,MB6,F]  336-8-345ms    | [S2,MB5,B]  383-11-394ms   | [S2,MB7,F]  398-8-406ms    | [S2,MB6,B]  444-11-456ms   | [S2,MB7,B]  504-11-516ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  48-34-82ms     | [S3,MB1,F]  85-11-96ms     | [S3,MB1,B]  102-34-137ms   | [S3,MB2,F]  139-14-153ms   | [S3,MB2,B]  159-35-195ms   | [S3,MB3,F]  197-15-213ms   | [S3,MB3,B]  219-36-256ms   | [S3,MB4,F]  258-16-274ms   | [S3,MB4,B]  280-37-318ms   | [S3,MB5,F]  320-15-335ms   | [S3,MB5,B]  341-37-379ms   | [S3,MB6,F]  381-15-397ms   | [S3,MB6,B]  402-37-440ms   | [S3,MB7,F]  442-15-458ms   | [S3,MB7,B]  463-37-501ms  
[rank3]:2025-12-27 02:40:10,456 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p70_42_dm1/frozen_ratio_history/rank3/251227_0240_stage3_step200.svg
[rank1]:2025-12-27 02:40:10,466 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p70_42_dm1/frozen_params_histogram/251227_0240_rank1_stage1.svg
[rank1]:	> Counts Sum: 162, Total Sum: 675 (24.00%), Ratio(%) per element: [40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-12-27 02:40:10,477 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p70_42_dm1/frozen_params_histogram/251227_0240_rank2_stage2.svg
[rank2]:	> Counts Sum: 189, Total Sum: 540 (35.00%), Ratio(%) per element: [46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-12-27 02:40:10,475 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p70_42_dm1/frozen_params_histogram/251227_0240_rank0_stage0.svg
[rank0]:	> Counts Sum: 270, Total Sum: 555 (48.65%), Ratio(%) per element: [0.0, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-27 02:40:10,589 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p70_42_dm1/frozen_params_histogram/251227_0240_rank3_stage3.svg
[rank3]:	> Counts Sum: 126, Total Sum: 435 (28.97%), Ratio(%) per element: [46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-12-27 02:40:55,581 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.0421e+00
[rank0]:2025-12-27 02:40:55,584 - Freezing Ratio: [Stage0] 0.49, Threshold: 4.2609e+00
[rank3]:2025-12-27 02:40:55,592 - Freezing Ratio: [Stage3] 0.62, Threshold: 3.2086e+00
[rank1]:2025-12-27 02:40:55,573 - Freezing Ratio: [Stage1] 0.00, Threshold: 4.9852e+00
[rank3]:2025-12-27 02:41:41,901 - Freezing Ratio: [Stage3] 0.00, Threshold: 4.6609e+00
[rank1]:2025-12-27 02:41:41,901 - Freezing Ratio: [Stage1] 0.60, Threshold: 3.3133e+00
[rank2]:2025-12-27 02:41:41,885 - Freezing Ratio: [Stage2] 0.00, Threshold: 5.7272e+00
[rank0]:2025-12-27 02:41:41,905 - Freezing Ratio: [Stage0] 0.73, Threshold: 2.7622e+00
[rank2]:2025-12-27 02:42:11,919 - Avg. fwd time: 7.7735 / Avg. bwd time: 17.0006 / Avg. batch time: 530.1261 (ms) / GPU bubble ratio: 62.61%
[rank3]:2025-12-27 02:42:11,892 - Avg. fwd time: 14.0097 / Avg. bwd time: 40.6687 / Avg. batch time: 500.8483 (ms) / GPU bubble ratio: 12.66%
[rank1]:2025-12-27 02:42:11,942 - Avg. fwd time: 9.5662 / Avg. bwd time: 22.4287 / Avg. batch time: 567.0267 (ms) / GPU bubble ratio: 54.86%
[rank0]:2025-12-27 02:42:11,965 - Avg. fwd time: 8.2164 / Avg. bwd time: 20.7599 / Avg. batch time: 600.9028 (ms) / GPU bubble ratio: 61.42%
[rank1]:2025-12-27 02:42:31,860 - Freezing Ratio: [Stage1] 0.00, Threshold: 8.9892e+00
[rank2]:2025-12-27 02:42:31,868 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.3452e+00
[rank0]:2025-12-27 02:42:31,871 - Freezing Ratio: [Stage0] 0.49, Threshold: 6.2775e+00
[rank3]:2025-12-27 02:42:31,879 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.8132e+00
[rank1]:2025-12-27 02:43:18,344 - Freezing Ratio: [Stage1] 0.60, Threshold: 3.5601e+00
[rank0]:2025-12-27 02:43:18,347 - Freezing Ratio: [Stage0] 0.73, Threshold: 4.6756e+00
[rank2]:2025-12-27 02:43:18,328 - Freezing Ratio: [Stage2] 0.00, Threshold: 4.3149e+00
[rank3]:2025-12-27 02:43:18,343 - Freezing Ratio: [Stage3] 0.00, Threshold: 4.6725e+00
[rank0]:2025-12-27 02:44:08,493 - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-12-27 02:44:08,489 - Freezing Ratio: [Stage1] 0.00, Threshold: 3.9293e+00
[rank2]:2025-12-27 02:44:08,497 - Freezing Ratio: [Stage2] 0.75, Threshold: 2.6610e-01
[rank0]:2025-12-27 02:44:08,500 - Freezing Ratio: [Stage0] 0.49, Threshold: 4.5378e+00
[rank3]:2025-12-27 02:44:08,509 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.4049e+00
[rank2]:2025-12-27 02:44:13,080 - Avg. fwd time: 7.7810 / Avg. bwd time: 16.9292 / Avg. batch time: 529.6764 (ms) / GPU bubble ratio: 62.68%
[rank3]:2025-12-27 02:44:13,061 - Avg. fwd time: 14.0171 / Avg. bwd time: 40.6167 / Avg. batch time: 500.4882 (ms) / GPU bubble ratio: 12.67%
[rank1]:2025-12-27 02:44:13,111 - Avg. fwd time: 9.5899 / Avg. bwd time: 22.2018 / Avg. batch time: 566.3411 (ms) / GPU bubble ratio: 55.09%
[rank0]:2025-12-27 02:44:13,137 - Avg. fwd time: 8.2540 / Avg. bwd time: 20.4568 / Avg. batch time: 599.9059 (ms) / GPU bubble ratio: 61.71%
[rank0]:2025-12-27 02:44:13,165 -  step: 250  loss: -8.0000  grad_norm:  7.6903  memory: 13.42GiB(28.26%)  tps: 6,745  tflops: 52.73  mfu: 16.90%
[rank2]:2025-12-27 02:44:13,147 -  step: 250  loss: -8.0000  grad_norm:  7.6903  memory:  6.98GiB(14.69%)  tps: 6,746  tflops: 52.73  mfu: 16.90%
[rank3]:2025-12-27 02:44:13,164 -  step: 250  loss:  1.6442  grad_norm:  7.6903  memory: 16.39GiB(34.50%)  tps: 6,745  tflops: 52.73  mfu: 16.90%
[rank1]:2025-12-27 02:44:13,161 -  step: 250  loss: -8.0000  grad_norm:  7.6903  memory:  9.50GiB(19.99%)  tps: 6,745  tflops: 52.73  mfu: 16.90%
[rank3]:2025-12-27 02:44:55,024 - Freezing Ratio: [Stage3] 0.00, Threshold: 2.3729e+00
[rank2]:2025-12-27 02:44:55,009 - Freezing Ratio: [Stage2] 0.00, Threshold: 4.1626e+00
[rank0]:2025-12-27 02:44:55,028 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.7591e+00
[rank1]:2025-12-27 02:44:55,024 - Freezing Ratio: [Stage1] 0.60, Threshold: 2.2350e+00
[rank1]:2025-12-27 02:45:45,040 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.0371e+01
[rank2]:2025-12-27 02:45:45,048 - Freezing Ratio: [Stage2] 0.75, Threshold: 7.7309e-01
[rank3]:2025-12-27 02:45:45,060 - Freezing Ratio: [Stage3] 0.62, Threshold: 2.2420e+00
[rank0]:2025-12-27 02:45:45,052 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.0320e+01
[rank2]:2025-12-27 02:46:12,202 - Avg. fwd time: 7.8031 / Avg. bwd time: 16.7464 / Avg. batch time: 528.4943 (ms) / GPU bubble ratio: 62.84%
[rank3]:2025-12-27 02:46:12,183 - Avg. fwd time: 14.0336 / Avg. bwd time: 40.4773 / Avg. batch time: 499.5044 (ms) / GPU bubble ratio: 12.70%
[rank0]:2025-12-27 02:46:12,247 - Avg. fwd time: 8.2874 / Avg. bwd time: 20.1899 / Avg. batch time: 598.1322 (ms) / GPU bubble ratio: 61.91%
[rank1]:2025-12-27 02:46:12,223 - Avg. fwd time: 9.6245 / Avg. bwd time: 21.8915 / Avg. batch time: 564.8413 (ms) / GPU bubble ratio: 55.36%
[rank2]:2025-12-27 02:46:30,272 - Freezing Ratio: [Stage2] 0.00, Threshold: 7.6202e+00
[rank0]:2025-12-27 02:46:30,287 - Freezing Ratio: [Stage0] 0.73, Threshold: 9.0849e+00
[rank1]:2025-12-27 02:46:30,272 - Freezing Ratio: [Stage1] 0.60, Threshold: 8.1549e+00
[rank3]:2025-12-27 02:46:30,287 - Freezing Ratio: [Stage3] 0.00, Threshold: 5.1699e+00
[rank2]:2025-12-27 02:47:20,537 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.9156e-01
[rank0]:2025-12-27 02:47:20,541 - Freezing Ratio: [Stage0] 0.73, Threshold: 2.8166e+00
[rank3]:2025-12-27 02:47:20,549 - Freezing Ratio: [Stage3] 0.62, Threshold: 9.1739e-01
[rank1]:2025-12-27 02:47:20,529 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.9583e+00
[rank0]:2025-12-27 02:48:05,777 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-27 02:48:05,793 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.0543e+00
[rank2]:2025-12-27 02:48:05,778 - Freezing Ratio: [Stage2] 0.00, Threshold: 2.7037e+00
[rank3]:2025-12-27 02:48:05,794 - Freezing Ratio: [Stage3] 0.00, Threshold: 2.1283e+00
[rank1]:2025-12-27 02:48:05,778 - Freezing Ratio: [Stage1] 0.60, Threshold: 1.4248e+00
[rank3]:2025-12-27 02:48:10,708 - Avg. fwd time: 14.0396 / Avg. bwd time: 40.3884 / Avg. batch time: 498.8383 (ms) / GPU bubble ratio: 12.71%
[rank0]:2025-12-27 02:48:10,784 - Avg. fwd time: 8.3285 / Avg. bwd time: 19.8833 / Avg. batch time: 596.4349 (ms) / GPU bubble ratio: 62.16%
[rank2]:2025-12-27 02:48:10,736 - Avg. fwd time: 7.8183 / Avg. bwd time: 16.6234 / Avg. batch time: 527.6939 (ms) / GPU bubble ratio: 62.95%
[rank2]:2025-12-27 02:48:10,803 -  step: 300  loss: -8.0000  grad_norm:  2.3763  memory:  6.98GiB(14.69%)  tps: 6,894  tflops: 53.89  mfu: 17.27%
[rank3]:2025-12-27 02:48:10,816 -  step: 300  loss:  0.4670  grad_norm:  2.3763  memory: 16.39GiB(34.50%)  tps: 6,894  tflops: 53.90  mfu: 17.27%
[rank1]:2025-12-27 02:48:10,760 - Avg. fwd time: 9.6941 / Avg. bwd time: 21.2988 / Avg. batch time: 563.4446 (ms) / GPU bubble ratio: 56.00%
[rank1]:2025-12-27 02:48:10,796 -  step: 300  loss: -8.0000  grad_norm:  2.3763  memory:  9.50GiB(19.99%)  tps: 6,895  tflops: 53.90  mfu: 17.28%
[rank0]:2025-12-27 02:48:10,807 -  step: 300  loss: -8.0000  grad_norm:  2.3763  memory: 13.42GiB(28.26%)  tps: 6,894  tflops: 53.90  mfu: 17.27%
[rank0]:2025-12-27 02:48:10,871 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p70_42_dm1/frozen_ratio_history/rank0/251227_0248_stage0_step300.svg
[rank2]:2025-12-27 02:48:10,867 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p70_42_dm1/frozen_ratio_history/rank2/251227_0248_stage2_step300.svg
[rank1]:2025-12-27 02:48:10,870 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p70_42_dm1/frozen_ratio_history/rank1/251227_0248_stage1_step300.svg
[rank3]:2025-12-27 02:48:10,953 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p70_42_dm1/pipeline_schedule/251227_0248_step300_rank3.svg
[rank3]:			> Batch Time: 552.58 ms, GPU Bubble Ratio: 63.23%, 64.94%, 70.98%, 25.88%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-18ms       | [S0,MB2,F]  18-9-28ms      | [S0,MB3,F]  28-8-36ms      | [S0,MB0,B]  122-16-139ms   | [S0,MB4,F]  139-8-147ms    | [S0,MB1,B]  179-16-196ms   | [S0,MB5,F]  196-8-204ms    | [S0,MB2,B]  237-16-254ms   | [S0,MB6,F]  254-8-262ms    | [S0,MB3,B]  297-16-314ms   | [S0,MB7,F]  314-8-322ms    | [S0,MB4,B]  358-16-375ms   | [S0,MB5,B]  416-16-433ms   | [S0,MB6,B]  476-16-492ms   | [S0,MB7,B]  536-16-552ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  24-10-34ms     | [S1,MB2,F]  37-10-48ms     | [S1,MB0,B]  103-13-117ms   | [S1,MB3,F]  121-10-131ms   | [S1,MB1,B]  160-13-174ms   | [S1,MB4,F]  177-10-188ms   | [S1,MB2,B]  218-13-232ms   | [S1,MB5,F]  235-10-246ms   | [S1,MB3,B]  278-13-292ms   | [S1,MB6,F]  295-10-306ms   | [S1,MB4,B]  339-13-353ms   | [S1,MB7,F]  356-10-367ms   | [S1,MB5,B]  399-13-413ms   | [S1,MB6,B]  459-13-472ms   | [S1,MB7,B]  518-13-532ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  34-8-42ms      | [S2,MB0,B]  87-11-98ms     | [S2,MB2,F]  102-8-110ms    | [S2,MB1,B]  144-11-155ms   | [S2,MB3,F]  159-8-167ms    | [S2,MB2,B]  202-11-214ms   | [S2,MB4,F]  217-8-225ms    | [S2,MB3,B]  262-11-273ms   | [S2,MB5,F]  277-8-285ms    | [S2,MB4,B]  323-11-334ms   | [S2,MB6,F]  338-8-346ms    | [S2,MB5,B]  383-11-394ms   | [S2,MB7,F]  398-8-406ms    | [S2,MB6,B]  444-11-456ms   | [S2,MB7,B]  504-11-515ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-43ms     | [S3,MB0,B]  49-34-83ms     | [S3,MB1,F]  85-12-97ms     | [S3,MB1,B]  104-35-140ms   | [S3,MB2,F]  142-13-156ms   | [S3,MB2,B]  162-36-198ms   | [S3,MB3,F]  200-15-216ms   | [S3,MB3,B]  221-37-258ms   | [S3,MB4,F]  260-15-276ms   | [S3,MB4,B]  281-37-319ms   | [S3,MB5,F]  321-15-336ms   | [S3,MB5,B]  342-37-380ms   | [S3,MB6,F]  381-14-396ms   | [S3,MB6,B]  402-37-440ms   | [S3,MB7,F]  442-14-457ms   | [S3,MB7,B]  462-37-500ms  
[rank3]:2025-12-27 02:48:10,997 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p70_42_dm1/frozen_ratio_history/rank3/251227_0248_stage3_step300.svg
[rank1]:2025-12-27 02:48:11,014 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p70_42_dm1/frozen_params_histogram/251227_0248_rank1_stage1.svg
[rank1]:	> Counts Sum: 369, Total Sum: 1125 (32.80%), Ratio(%) per element: [52.0, 52.0, 52.0, 52.0, 52.0, 52.0, 52.0, 52.0, 52.0, 52.0, 52.0, 52.0, 52.0, 52.0, 52.0, 52.0, 52.0, 52.0, 52.0, 52.0, 52.0, 52.0, 52.0, 52.0, 52.0, 52.0, 52.0, 8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-12-27 02:48:11,034 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p70_42_dm1/frozen_params_histogram/251227_0248_rank0_stage0.svg
[rank0]:	> Counts Sum: 513, Total Sum: 925 (55.46%), Ratio(%) per element: [0.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 44.0, 44.0, 44.0, 44.0, 44.0, 44.0, 44.0, 44.0, 44.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-12-27 02:48:11,018 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p70_42_dm1/frozen_params_histogram/251227_0248_rank2_stage2.svg
[rank2]:	> Counts Sum: 324, Total Sum: 900 (36.00%), Ratio(%) per element: [48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-27 02:48:11,130 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p70_42_dm1/frozen_params_histogram/251227_0248_rank3_stage3.svg
[rank3]:	> Counts Sum: 216, Total Sum: 725 (29.79%), Ratio(%) per element: [48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-12-27 02:48:56,067 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.3222e+00
[rank3]:2025-12-27 02:48:56,078 - Freezing Ratio: [Stage3] 0.62, Threshold: 3.5361e+00
[rank1]:2025-12-27 02:48:56,059 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.0160e+01
[rank0]:2025-12-27 02:48:56,070 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.4443e+01
[rank1]:2025-12-27 02:49:41,232 - Freezing Ratio: [Stage1] 0.60, Threshold: 5.9797e-01
[rank0]:2025-12-27 02:49:41,247 - Freezing Ratio: [Stage0] 0.73, Threshold: 3.7553e-01
[rank2]:2025-12-27 02:49:41,232 - Freezing Ratio: [Stage2] 0.00, Threshold: 7.2679e-01
[rank3]:2025-12-27 02:49:41,248 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.6587e+00
[rank2]:2025-12-27 02:50:11,223 - Avg. fwd time: 7.8174 / Avg. bwd time: 16.6260 / Avg. batch time: 527.7005 (ms) / GPU bubble ratio: 62.94%
[rank3]:2025-12-27 02:50:11,195 - Avg. fwd time: 14.0359 / Avg. bwd time: 40.3906 / Avg. batch time: 498.8278 (ms) / GPU bubble ratio: 12.71%
[rank1]:2025-12-27 02:50:11,247 - Avg. fwd time: 9.7482 / Avg. bwd time: 20.8339 / Avg. batch time: 562.9819 (ms) / GPU bubble ratio: 56.54%
[rank0]:2025-12-27 02:50:11,272 - Avg. fwd time: 8.3624 / Avg. bwd time: 19.6248 / Avg. batch time: 595.7095 (ms) / GPU bubble ratio: 62.42%
[rank0]:2025-12-27 02:50:31,458 - Freezing Ratio: [Stage0] 0.73, Threshold: 5.1345e+00
[rank2]:2025-12-27 02:50:31,455 - Freezing Ratio: [Stage2] 0.75, Threshold: 9.2075e-01
[rank3]:2025-12-27 02:50:31,466 - Freezing Ratio: [Stage3] 0.62, Threshold: 2.8794e+00
[rank1]:2025-12-27 02:50:31,447 - Freezing Ratio: [Stage1] 0.80, Threshold: 4.0265e+00
[rank1]:2025-12-27 02:51:16,661 - Freezing Ratio: [Stage1] 0.60, Threshold: 1.2545e+00
[rank0]:2025-12-27 02:51:16,676 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.7357e+00
[rank2]:2025-12-27 02:51:16,661 - Freezing Ratio: [Stage2] 0.00, Threshold: 1.5926e+00
[rank3]:2025-12-27 02:51:16,677 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.2724e+00
[rank2]:2025-12-27 02:52:06,667 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.8103e-01
[rank0]:2025-12-27 02:52:06,663 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-27 02:52:06,671 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.6714e+00
[rank1]:2025-12-27 02:52:06,659 - Freezing Ratio: [Stage1] 0.80, Threshold: 3.3035e-01
[rank3]:2025-12-27 02:52:06,680 - Freezing Ratio: [Stage3] 0.62, Threshold: 6.1120e-01
[rank3]:2025-12-27 02:52:11,134 - Avg. fwd time: 14.0352 / Avg. bwd time: 40.3781 / Avg. batch time: 498.7204 (ms) / GPU bubble ratio: 12.72%
[rank2]:2025-12-27 02:52:11,154 - Avg. fwd time: 7.8200 / Avg. bwd time: 16.6032 / Avg. batch time: 527.5608 (ms) / GPU bubble ratio: 62.96%
[rank2]:2025-12-27 02:52:11,209 -  step: 350  loss: -8.0000  grad_norm:  0.2409  memory:  6.98GiB(14.69%)  tps: 6,815  tflops: 53.28  mfu: 17.08%
[rank0]:2025-12-27 02:52:11,200 - Avg. fwd time: 8.3920 / Avg. bwd time: 19.4032 / Avg. batch time: 594.9378 (ms) / GPU bubble ratio: 62.62%
[rank1]:2025-12-27 02:52:11,176 - Avg. fwd time: 9.7962 / Avg. bwd time: 20.4270 / Avg. batch time: 562.4325 (ms) / GPU bubble ratio: 57.01%
[rank1]:2025-12-27 02:52:11,209 -  step: 350  loss: -8.0000  grad_norm:  0.2409  memory:  9.50GiB(19.99%)  tps: 6,815  tflops: 53.28  mfu: 17.08%
[rank3]:2025-12-27 02:52:11,225 -  step: 350  loss:  0.2539  grad_norm:  0.2409  memory: 16.39GiB(34.50%)  tps: 6,815  tflops: 53.28  mfu: 17.08%
[rank0]:2025-12-27 02:52:11,224 -  step: 350  loss: -8.0000  grad_norm:  0.2409  memory: 13.42GiB(28.26%)  tps: 6,815  tflops: 53.28  mfu: 17.08%
[rank2]:2025-12-27 02:52:51,910 - Freezing Ratio: [Stage2] 0.00, Threshold: 5.2876e-01
[rank0]:2025-12-27 02:52:51,925 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.0863e+00
[rank1]:2025-12-27 02:52:51,910 - Freezing Ratio: [Stage1] 0.60, Threshold: 3.8294e-01
[rank3]:2025-12-27 02:52:51,926 - Freezing Ratio: [Stage3] 0.00, Threshold: 7.5545e-01
[rank1]:2025-12-27 02:53:42,043 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.3608e+00
[rank2]:2025-12-27 02:53:42,051 - Freezing Ratio: [Stage2] 0.75, Threshold: 7.7142e-02
[rank0]:2025-12-27 02:53:42,054 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.4521e+00
[rank3]:2025-12-27 02:53:42,063 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.9038e-01
[rank2]:2025-12-27 02:54:09,053 - Avg. fwd time: 7.8343 / Avg. bwd time: 16.4921 / Avg. batch time: 526.7910 (ms) / GPU bubble ratio: 63.06%
[rank3]:2025-12-27 02:54:09,032 - Avg. fwd time: 14.0391 / Avg. bwd time: 40.2932 / Avg. batch time: 498.0710 (ms) / GPU bubble ratio: 12.73%
[rank1]:2025-12-27 02:54:09,075 - Avg. fwd time: 9.8415 / Avg. bwd time: 20.0436 / Avg. batch time: 561.2765 (ms) / GPU bubble ratio: 57.40%
[rank0]:2025-12-27 02:54:09,100 - Avg. fwd time: 8.4169 / Avg. bwd time: 19.2116 / Avg. batch time: 593.5849 (ms) / GPU bubble ratio: 62.76%
[rank2]:2025-12-27 02:54:27,257 - Freezing Ratio: [Stage2] 0.00, Threshold: 9.3912e-01
[rank0]:2025-12-27 02:54:27,272 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.7464e+00
[rank1]:2025-12-27 02:54:27,257 - Freezing Ratio: [Stage1] 0.60, Threshold: 2.7500e+00
[rank3]:2025-12-27 02:54:27,272 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.4267e+00
[rank2]:2025-12-27 02:55:17,205 - Freezing Ratio: [Stage2] 0.75, Threshold: 5.2905e-02
[rank0]:2025-12-27 02:55:17,209 - Freezing Ratio: [Stage0] 0.73, Threshold: 7.8785e-01
[rank1]:2025-12-27 02:55:17,197 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.6245e-01
[rank3]:2025-12-27 02:55:17,217 - Freezing Ratio: [Stage3] 0.62, Threshold: 2.1388e-01
[rank2]:2025-12-27 02:56:02,406 - Freezing Ratio: [Stage2] 0.00, Threshold: 6.0803e-01
[rank1]:2025-12-27 02:56:02,406 - Freezing Ratio: [Stage1] 0.60, Threshold: 6.6277e-01
[rank0]:2025-12-27 02:56:02,404 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-27 02:56:02,421 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1749e+00
[rank3]:2025-12-27 02:56:02,421 - Freezing Ratio: [Stage3] 0.00, Threshold: 6.9471e-01
[rank3]:2025-12-27 02:56:07,400 - Avg. fwd time: 14.0421 / Avg. bwd time: 40.2354 / Avg. batch time: 497.6310 (ms) / GPU bubble ratio: 12.74%
[rank2]:2025-12-27 02:56:07,429 - Avg. fwd time: 7.8441 / Avg. bwd time: 16.4163 / Avg. batch time: 526.2682 (ms) / GPU bubble ratio: 63.12%
[rank2]:2025-12-27 02:56:07,498 -  step: 400  loss: -8.0000  grad_norm:  0.0966  memory:  6.98GiB(14.69%)  tps: 6,934  tflops: 54.21  mfu: 17.37%
[rank0]:2025-12-27 02:56:07,479 - Avg. fwd time: 8.4391 / Avg. bwd time: 19.0441 / Avg. batch time: 592.5624 (ms) / GPU bubble ratio: 62.90%
[rank0]:2025-12-27 02:56:07,503 -  step: 400  loss: -8.0000  grad_norm:  0.0966  memory: 13.42GiB(28.26%)  tps: 6,934  tflops: 54.21  mfu: 17.37%
[rank1]:2025-12-27 02:56:07,454 - Avg. fwd time: 9.8805 / Avg. bwd time: 19.7155 / Avg. batch time: 560.4240 (ms) / GPU bubble ratio: 57.75%
[rank1]:2025-12-27 02:56:07,492 -  step: 400  loss: -8.0000  grad_norm:  0.0966  memory:  9.50GiB(19.99%)  tps: 6,934  tflops: 54.21  mfu: 17.37%
[rank3]:2025-12-27 02:56:07,511 -  step: 400  loss:  0.2213  grad_norm:  0.0966  memory: 16.39GiB(34.50%)  tps: 6,934  tflops: 54.21  mfu: 17.37%
[rank2]:2025-12-27 02:56:07,566 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p70_42_dm1/frozen_ratio_history/rank2/251227_0256_stage2_step400.svg
[rank0]:2025-12-27 02:56:07,566 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p70_42_dm1/frozen_ratio_history/rank0/251227_0256_stage0_step400.svg
[rank1]:2025-12-27 02:56:07,567 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p70_42_dm1/frozen_ratio_history/rank1/251227_0256_stage1_step400.svg
[rank3]:2025-12-27 02:56:07,646 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p70_42_dm1/pipeline_schedule/251227_0256_step400_rank3.svg
[rank3]:			> Batch Time: 548.56 ms, GPU Bubble Ratio: 63.01%, 64.83%, 70.87%, 26.28%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-36ms      | [S0,MB0,B]  122-16-138ms   | [S0,MB4,F]  138-8-147ms    | [S0,MB1,B]  176-16-193ms   | [S0,MB5,F]  193-8-201ms    | [S0,MB2,B]  233-16-249ms   | [S0,MB6,F]  250-8-258ms    | [S0,MB3,B]  293-16-310ms   | [S0,MB7,F]  310-8-318ms    | [S0,MB4,B]  354-16-370ms   | [S0,MB5,B]  413-16-429ms   | [S0,MB6,B]  472-16-488ms   | [S0,MB7,B]  532-16-548ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-10-34ms     | [S1,MB2,F]  37-10-47ms     | [S1,MB0,B]  103-13-116ms   | [S1,MB3,F]  120-10-131ms   | [S1,MB1,B]  158-13-171ms   | [S1,MB4,F]  175-10-185ms   | [S1,MB2,B]  214-13-228ms   | [S1,MB5,F]  231-10-242ms   | [S1,MB3,B]  274-13-288ms   | [S1,MB6,F]  291-10-302ms   | [S1,MB4,B]  335-13-349ms   | [S1,MB7,F]  352-10-363ms   | [S1,MB5,B]  396-13-409ms   | [S1,MB6,B]  455-13-468ms   | [S1,MB7,B]  515-13-528ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  34-8-42ms      | [S2,MB0,B]  86-11-98ms     | [S2,MB2,F]  101-8-110ms    | [S2,MB1,B]  141-11-153ms   | [S2,MB3,F]  156-8-165ms    | [S2,MB2,B]  198-11-209ms   | [S2,MB4,F]  213-8-221ms    | [S2,MB3,B]  258-11-269ms   | [S2,MB5,F]  273-8-281ms    | [S2,MB4,B]  319-11-330ms   | [S2,MB6,F]  334-8-342ms    | [S2,MB5,B]  380-11-391ms   | [S2,MB7,F]  395-8-403ms    | [S2,MB6,B]  440-11-452ms   | [S2,MB7,B]  500-11-511ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  48-34-82ms     | [S3,MB1,F]  85-11-96ms     | [S3,MB1,B]  102-35-137ms   | [S3,MB2,F]  140-12-153ms   | [S3,MB2,B]  158-35-194ms   | [S3,MB3,F]  196-14-211ms   | [S3,MB3,B]  217-36-254ms   | [S3,MB4,F]  256-15-272ms   | [S3,MB4,B]  278-37-315ms   | [S3,MB5,F]  317-15-332ms   | [S3,MB5,B]  338-37-376ms   | [S3,MB6,F]  378-14-393ms   | [S3,MB6,B]  399-37-436ms   | [S3,MB7,F]  439-14-453ms   | [S3,MB7,B]  459-37-497ms  
[rank0]:2025-12-27 02:56:07,722 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p70_42_dm1/frozen_params_histogram/251227_0256_rank0_stage0.svg
[rank0]:	> Counts Sum: 783, Total Sum: 1295 (60.46%), Ratio(%) per element: [0.0, 94.28, 94.28, 94.28, 94.28, 94.28, 94.28, 94.28, 94.28, 94.28, 94.28, 94.28, 94.28, 94.28, 94.28, 94.28, 94.28, 94.28, 94.28, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-12-27 02:56:07,714 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p70_42_dm1/frozen_params_histogram/251227_0256_rank1_stage1.svg
[rank1]:	> Counts Sum: 684, Total Sum: 1575 (43.43%), Ratio(%) per element: [65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-27 02:56:07,694 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p70_42_dm1/frozen_ratio_history/rank3/251227_0256_stage3_step400.svg
[rank2]:2025-12-27 02:56:07,720 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p70_42_dm1/frozen_params_histogram/251227_0256_rank2_stage2.svg
[rank2]:	> Counts Sum: 459, Total Sum: 1260 (36.43%), Ratio(%) per element: [48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-27 02:56:07,824 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p70_42_dm1/frozen_params_histogram/251227_0256_rank3_stage3.svg
[rank3]:	> Counts Sum: 306, Total Sum: 1015 (30.15%), Ratio(%) per element: [48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 48.57, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-27 02:56:36,150 - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-12-27 02:56:36,375 - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-12-27 02:56:36,411 - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-12-27 02:56:36,392 - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-12-27 02:56:52,699 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.9136e+00
[rank2]:2025-12-27 02:56:52,707 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.9211e-01
[rank0]:2025-12-27 02:56:52,711 - Freezing Ratio: [Stage0] 0.73, Threshold: 2.2005e+00
[rank3]:2025-12-27 02:56:52,719 - Freezing Ratio: [Stage3] 0.62, Threshold: 6.9222e-01
[rank1]:2025-12-27 02:57:37,755 - Freezing Ratio: [Stage1] 0.60, Threshold: 8.6470e+00
[rank2]:2025-12-27 02:57:37,755 - Freezing Ratio: [Stage2] 0.00, Threshold: 7.5597e+00
[rank3]:2025-12-27 02:57:37,771 - Freezing Ratio: [Stage3] 0.00, Threshold: 6.8556e+00
[rank0]:2025-12-27 02:57:37,771 - Freezing Ratio: [Stage0] 0.73, Threshold: 6.9348e+00
[rank3]:2025-12-27 02:58:07,694 - Avg. fwd time: 14.0370 / Avg. bwd time: 40.2441 / Avg. batch time: 497.6587 (ms) / GPU bubble ratio: 12.74%
[rank2]:2025-12-27 02:58:07,724 - Avg. fwd time: 7.8419 / Avg. bwd time: 16.4298 / Avg. batch time: 526.3245 (ms) / GPU bubble ratio: 63.11%
[rank0]:2025-12-27 02:58:07,774 - Avg. fwd time: 8.4584 / Avg. bwd time: 18.8960 / Avg. batch time: 592.2023 (ms) / GPU bubble ratio: 63.05%
[rank1]:2025-12-27 02:58:07,749 - Avg. fwd time: 9.9110 / Avg. bwd time: 19.4531 / Avg. batch time: 560.2154 (ms) / GPU bubble ratio: 58.07%
[rank1]:2025-12-27 02:58:27,636 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.5114e+00
[rank2]:2025-12-27 02:58:27,644 - Freezing Ratio: [Stage2] 0.75, Threshold: 2.3204e-01
[rank3]:2025-12-27 02:58:27,655 - Freezing Ratio: [Stage3] 0.62, Threshold: 8.9335e-01
[rank0]:2025-12-27 02:58:27,648 - Freezing Ratio: [Stage0] 0.73, Threshold: 9.3687e-01
[rank2]:2025-12-27 02:59:12,766 - Freezing Ratio: [Stage2] 0.00, Threshold: 2.1474e+00
[rank0]:2025-12-27 02:59:12,781 - Freezing Ratio: [Stage0] 0.73, Threshold: 2.2064e+00
[rank3]:2025-12-27 02:59:12,781 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.7288e+00
[rank1]:2025-12-27 02:59:12,766 - Freezing Ratio: [Stage1] 0.60, Threshold: 1.7602e+00
[rank2]:2025-12-27 03:00:02,797 - Freezing Ratio: [Stage2] 0.75, Threshold: 4.3435e-01
[rank3]:2025-12-27 03:00:02,810 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.1496e+00
[rank0]:2025-12-27 03:00:02,793 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-27 03:00:02,801 - Freezing Ratio: [Stage0] 0.73, Threshold: 2.8394e+00
[rank1]:2025-12-27 03:00:02,789 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.8502e+00
[rank3]:2025-12-27 03:00:07,239 - Avg. fwd time: 14.0335 / Avg. bwd time: 40.2363 / Avg. batch time: 497.5676 (ms) / GPU bubble ratio: 12.74%
[rank2]:2025-12-27 03:00:07,261 - Avg. fwd time: 7.8422 / Avg. bwd time: 16.4225 / Avg. batch time: 526.2194 (ms) / GPU bubble ratio: 63.11%
[rank2]:2025-12-27 03:00:07,318 -  step: 450  loss: -8.0000  grad_norm:  0.0985  memory:  6.98GiB(14.69%)  tps: 6,832  tflops: 53.41  mfu: 17.12%
[rank3]:2025-12-27 03:00:07,334 -  step: 450  loss:  0.2429  grad_norm:  0.0985  memory: 16.39GiB(34.50%)  tps: 6,832  tflops: 53.41  mfu: 17.12%
[rank0]:2025-12-27 03:00:07,309 - Avg. fwd time: 8.4750 / Avg. bwd time: 18.7643 / Avg. batch time: 591.7183 (ms) / GPU bubble ratio: 63.17%
[rank0]:2025-12-27 03:00:07,332 -  step: 450  loss: -8.0000  grad_norm:  0.0985  memory: 13.42GiB(28.26%)  tps: 6,832  tflops: 53.41  mfu: 17.12%
[rank1]:2025-12-27 03:00:07,283 - Avg. fwd time: 9.9385 / Avg. bwd time: 19.2130 / Avg. batch time: 559.8674 (ms) / GPU bubble ratio: 58.35%
[rank1]:2025-12-27 03:00:07,318 -  step: 450  loss: -8.0000  grad_norm:  0.0985  memory:  9.50GiB(19.99%)  tps: 6,832  tflops: 53.41  mfu: 17.12%
[rank2]:2025-12-27 03:00:47,953 - Freezing Ratio: [Stage2] 0.00, Threshold: 8.0152e-01
[rank0]:2025-12-27 03:00:47,969 - Freezing Ratio: [Stage0] 0.73, Threshold: 8.5270e-01
[rank3]:2025-12-27 03:00:47,969 - Freezing Ratio: [Stage3] 0.00, Threshold: 3.3539e-01
[rank1]:2025-12-27 03:00:47,953 - Freezing Ratio: [Stage1] 0.60, Threshold: 3.2843e-01
[rank0]:2025-12-27 03:01:37,885 - Freezing Ratio: [Stage0] 0.73, Threshold: 4.2739e-01
[rank1]:2025-12-27 03:01:37,873 - Freezing Ratio: [Stage1] 0.80, Threshold: 3.4521e-01
[rank2]:2025-12-27 03:01:37,881 - Freezing Ratio: [Stage2] 0.75, Threshold: 6.7349e-02
[rank3]:2025-12-27 03:01:37,894 - Freezing Ratio: [Stage3] 0.62, Threshold: 3.4698e-01
[rank3]:2025-12-27 03:02:04,997 - Avg. fwd time: 14.0375 / Avg. bwd time: 40.1732 / Avg. batch time: 497.0925 (ms) / GPU bubble ratio: 12.76%
[rank2]:2025-12-27 03:02:05,019 - Avg. fwd time: 7.8518 / Avg. bwd time: 16.3434 / Avg. batch time: 525.6581 (ms) / GPU bubble ratio: 63.18%
[rank0]:2025-12-27 03:02:05,067 - Avg. fwd time: 8.4900 / Avg. bwd time: 18.6466 / Avg. batch time: 590.7932 (ms) / GPU bubble ratio: 63.25%
[rank1]:2025-12-27 03:02:05,041 - Avg. fwd time: 9.9665 / Avg. bwd time: 18.9740 / Avg. batch time: 559.0647 (ms) / GPU bubble ratio: 58.59%
[rank0]:2025-12-27 03:02:23,140 - Freezing Ratio: [Stage0] 0.73, Threshold: 2.6822e-01
[rank1]:2025-12-27 03:02:23,125 - Freezing Ratio: [Stage1] 0.60, Threshold: 4.8557e-01
[rank3]:2025-12-27 03:02:23,140 - Freezing Ratio: [Stage3] 0.00, Threshold: 3.1489e-01
[rank2]:2025-12-27 03:02:23,125 - Freezing Ratio: [Stage2] 0.00, Threshold: 3.8042e-01
[rank0]:2025-12-27 03:03:13,196 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1995e+00
[rank1]:2025-12-27 03:03:13,184 - Freezing Ratio: [Stage1] 0.80, Threshold: 6.0409e-01
[rank3]:2025-12-27 03:03:13,204 - Freezing Ratio: [Stage3] 0.62, Threshold: 2.4132e-01
[rank2]:2025-12-27 03:03:13,192 - Freezing Ratio: [Stage2] 0.75, Threshold: 6.0825e-02
[rank2]:2025-12-27 03:03:58,292 - Freezing Ratio: [Stage2] 0.00, Threshold: 8.7503e-01
[rank0]:2025-12-27 03:03:58,290 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-27 03:03:58,307 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.5864e+00
[rank1]:2025-12-27 03:03:58,292 - Freezing Ratio: [Stage1] 0.60, Threshold: 8.3126e-01
[rank3]:2025-12-27 03:03:58,307 - Freezing Ratio: [Stage3] 0.00, Threshold: 9.8525e-01
[rank1]:2025-12-27 03:04:03,278 - Avg. fwd time: 9.9912 / Avg. bwd time: 18.7649 / Avg. batch time: 558.4598 (ms) / GPU bubble ratio: 58.81%
[rank3]:2025-12-27 03:04:03,222 - Avg. fwd time: 14.0391 / Avg. bwd time: 40.1298 / Avg. batch time: 496.7574 (ms) / GPU bubble ratio: 12.76%
[rank2]:2025-12-27 03:04:03,252 - Avg. fwd time: 7.8585 / Avg. bwd time: 16.2895 / Avg. batch time: 525.2636 (ms) / GPU bubble ratio: 63.22%
[rank2]:2025-12-27 03:04:03,323 -  step: 500  loss: -8.0000  grad_norm:  0.1099  memory:  6.98GiB(14.69%)  tps: 6,942  tflops: 54.27  mfu: 17.39%
[rank0]:2025-12-27 03:04:03,304 - Avg. fwd time: 8.5037 / Avg. bwd time: 18.5408 / Avg. batch time: 590.0797 (ms) / GPU bubble ratio: 63.33%
[rank0]:2025-12-27 03:04:03,327 -  step: 500  loss: -8.0000  grad_norm:  0.1099  memory: 13.42GiB(28.26%)  tps: 6,943  tflops: 54.27  mfu: 17.40%
[rank1]:2025-12-27 03:04:03,316 -  step: 500  loss: -8.0000  grad_norm:  0.1099  memory:  9.50GiB(19.99%)  tps: 6,942  tflops: 54.27  mfu: 17.40%
[rank3]:2025-12-27 03:04:03,335 -  step: 500  loss:  0.2398  grad_norm:  0.1099  memory: 16.39GiB(34.50%)  tps: 6,942  tflops: 54.27  mfu: 17.39%
[rank2]:2025-12-27 03:04:03,387 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p70_42_dm1/frozen_ratio_history/rank2/251227_0304_stage2_step500.svg
[rank0]:2025-12-27 03:04:03,387 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p70_42_dm1/frozen_ratio_history/rank0/251227_0304_stage0_step500.svg
[rank1]:2025-12-27 03:04:03,389 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p70_42_dm1/frozen_ratio_history/rank1/251227_0304_stage1_step500.svg
[rank3]:2025-12-27 03:04:03,474 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p70_42_dm1/pipeline_schedule/251227_0304_step500_rank3.svg
[rank3]:			> Batch Time: 550.55 ms, GPU Bubble Ratio: 63.12%, 64.85%, 70.94%, 26.06%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-36ms      | [S0,MB0,B]  122-16-139ms   | [S0,MB4,F]  139-8-147ms    | [S0,MB1,B]  178-16-194ms   | [S0,MB5,F]  194-8-203ms    | [S0,MB2,B]  235-16-252ms   | [S0,MB6,F]  252-8-260ms    | [S0,MB3,B]  295-16-311ms   | [S0,MB7,F]  311-8-320ms    | [S0,MB4,B]  355-16-372ms   | [S0,MB5,B]  414-16-431ms   | [S0,MB6,B]  474-16-490ms   | [S0,MB7,B]  534-16-550ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-10-34ms     | [S1,MB2,F]  37-10-48ms     | [S1,MB0,B]  103-13-117ms   | [S1,MB3,F]  120-10-131ms   | [S1,MB1,B]  159-13-172ms   | [S1,MB4,F]  176-10-186ms   | [S1,MB2,B]  216-13-230ms   | [S1,MB5,F]  233-10-244ms   | [S1,MB3,B]  276-13-289ms   | [S1,MB6,F]  293-10-303ms   | [S1,MB4,B]  337-13-350ms   | [S1,MB7,F]  354-10-364ms   | [S1,MB5,B]  397-13-411ms   | [S1,MB6,B]  457-13-470ms   | [S1,MB7,B]  517-13-530ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  34-8-42ms      | [S2,MB0,B]  86-11-98ms     | [S2,MB2,F]  101-8-110ms    | [S2,MB1,B]  142-11-153ms   | [S2,MB3,F]  157-8-165ms    | [S2,MB2,B]  200-11-211ms   | [S2,MB4,F]  215-8-223ms    | [S2,MB3,B]  259-11-271ms   | [S2,MB5,F]  274-8-283ms    | [S2,MB4,B]  320-11-332ms   | [S2,MB6,F]  335-8-343ms    | [S2,MB5,B]  381-11-392ms   | [S2,MB7,F]  396-8-404ms    | [S2,MB6,B]  442-11-453ms   | [S2,MB7,B]  502-11-513ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  48-34-82ms     | [S3,MB1,F]  85-11-97ms     | [S3,MB1,B]  103-35-138ms   | [S3,MB2,F]  140-13-154ms   | [S3,MB2,B]  160-36-196ms   | [S3,MB3,F]  198-14-213ms   | [S3,MB3,B]  219-36-256ms   | [S3,MB4,F]  258-15-273ms   | [S3,MB4,B]  279-37-316ms   | [S3,MB5,F]  318-15-334ms   | [S3,MB5,B]  339-37-377ms   | [S3,MB6,F]  379-14-394ms   | [S3,MB6,B]  400-37-437ms   | [S3,MB7,F]  440-14-455ms   | [S3,MB7,B]  460-37-498ms  
[rank2]:2025-12-27 03:04:03,535 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p70_42_dm1/frozen_params_histogram/251227_0304_rank2_stage2.svg
[rank2]:	> Counts Sum: 594, Total Sum: 1620 (36.67%), Ratio(%) per element: [48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-12-27 03:04:03,539 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p70_42_dm1/frozen_params_histogram/251227_0304_rank0_stage0.svg
[rank0]:	> Counts Sum: 1053, Total Sum: 1665 (63.24%), Ratio(%) per element: [0.0, 95.55, 95.55, 95.55, 95.55, 95.55, 95.55, 95.55, 95.55, 95.55, 95.55, 95.55, 95.55, 95.55, 95.55, 95.55, 95.55, 95.55, 95.55, 68.88, 68.88, 68.88, 68.88, 68.88, 68.88, 68.88, 68.88, 68.88, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-12-27 03:04:03,533 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p70_42_dm1/frozen_params_histogram/251227_0304_rank1_stage1.svg
[rank1]:	> Counts Sum: 999, Total Sum: 2025 (49.33%), Ratio(%) per element: [73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-27 03:04:03,517 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p70_42_dm1/frozen_ratio_history/rank3/251227_0304_stage3_step500.svg
[rank3]:2025-12-27 03:04:03,648 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p70_42_dm1/frozen_params_histogram/251227_0304_rank3_stage3.svg
[rank3]:	> Counts Sum: 396, Total Sum: 1305 (30.34%), Ratio(%) per element: [48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 48.88, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-12-27 03:04:48,501 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.2916e-01
[rank0]:2025-12-27 03:04:48,505 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.3063e+00
[rank1]:2025-12-27 03:04:48,493 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.4194e+00
[rank3]:2025-12-27 03:04:48,513 - Freezing Ratio: [Stage3] 0.62, Threshold: 4.1724e-01
[rank1]:2025-12-27 03:05:33,604 - Freezing Ratio: [Stage1] 0.60, Threshold: 3.0988e+00
[rank2]:2025-12-27 03:05:33,604 - Freezing Ratio: [Stage2] 0.00, Threshold: 2.5160e+00
[rank0]:2025-12-27 03:05:33,619 - Freezing Ratio: [Stage0] 0.73, Threshold: 2.5895e+00
[rank3]:2025-12-27 03:05:33,620 - Freezing Ratio: [Stage3] 0.00, Threshold: 2.6883e+00
[rank1]:2025-12-27 03:06:03,543 - Avg. fwd time: 10.0106 / Avg. bwd time: 18.5976 / Avg. batch time: 558.3700 (ms) / GPU bubble ratio: 59.01%
[rank3]:2025-12-27 03:06:03,486 - Avg. fwd time: 14.0333 / Avg. bwd time: 40.1419 / Avg. batch time: 496.8059 (ms) / GPU bubble ratio: 12.76%
[rank2]:2025-12-27 03:06:03,516 - Avg. fwd time: 7.8560 / Avg. bwd time: 16.3060 / Avg. batch time: 525.3421 (ms) / GPU bubble ratio: 63.21%
[rank0]:2025-12-27 03:06:03,569 - Avg. fwd time: 8.5160 / Avg. bwd time: 18.4449 / Avg. batch time: 589.8899 (ms) / GPU bubble ratio: 63.44%
[rank2]:2025-12-27 03:06:23,697 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.2231e-01
[rank0]:2025-12-27 03:06:23,701 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1432e+00
[rank1]:2025-12-27 03:06:23,689 - Freezing Ratio: [Stage1] 0.80, Threshold: 7.5214e-01
[rank3]:2025-12-27 03:06:23,709 - Freezing Ratio: [Stage3] 0.62, Threshold: 5.0623e-01
[rank2]:2025-12-27 03:07:08,751 - Freezing Ratio: [Stage2] 0.00, Threshold: 9.1031e-01
[rank3]:2025-12-27 03:07:08,766 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.2004e+00
[rank0]:2025-12-27 03:07:08,766 - Freezing Ratio: [Stage0] 0.73, Threshold: 8.4698e-01
[rank1]:2025-12-27 03:07:08,751 - Freezing Ratio: [Stage1] 0.60, Threshold: 1.5269e+00
[rank2]:2025-12-27 03:07:58,720 - Freezing Ratio: [Stage2] 0.75, Threshold: 7.0540e-02
[rank3]:2025-12-27 03:07:58,732 - Freezing Ratio: [Stage3] 0.62, Threshold: 3.0341e-01
[rank0]:2025-12-27 03:07:58,715 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-27 03:07:58,724 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.5241e+00
[rank1]:2025-12-27 03:07:58,712 - Freezing Ratio: [Stage1] 0.80, Threshold: 3.8875e-01
[rank3]:2025-12-27 03:08:03,189 - Avg. fwd time: 14.0319 / Avg. bwd time: 40.1425 / Avg. batch time: 496.7990 (ms) / GPU bubble ratio: 12.76%
[rank2]:2025-12-27 03:08:03,211 - Avg. fwd time: 7.8559 / Avg. bwd time: 16.3056 / Avg. batch time: 525.3294 (ms) / GPU bubble ratio: 63.21%
[rank2]:2025-12-27 03:08:03,271 -  step: 550  loss: -8.0000  grad_norm:  0.0705  memory:  6.98GiB(14.69%)  tps: 6,828  tflops: 53.38  mfu: 17.11%
[rank3]:2025-12-27 03:08:03,287 -  step: 550  loss:  0.2452  grad_norm:  0.0705  memory: 16.39GiB(34.50%)  tps: 6,828  tflops: 53.38  mfu: 17.11%
[rank0]:2025-12-27 03:08:03,262 - Avg. fwd time: 8.5271 / Avg. bwd time: 18.3577 / Avg. batch time: 589.6279 (ms) / GPU bubble ratio: 63.52%
[rank0]:2025-12-27 03:08:03,285 -  step: 550  loss: -8.0000  grad_norm:  0.0705  memory: 13.42GiB(28.26%)  tps: 6,828  tflops: 53.38  mfu: 17.11%
[rank1]:2025-12-27 03:08:03,235 - Avg. fwd time: 10.0291 / Avg. bwd time: 18.4402 / Avg. batch time: 558.1990 (ms) / GPU bubble ratio: 59.20%
[rank1]:2025-12-27 03:08:03,271 -  step: 550  loss: -8.0000  grad_norm:  0.0705  memory:  9.50GiB(19.99%)  tps: 6,828  tflops: 53.38  mfu: 17.11%
[rank3]:2025-12-27 03:08:44,059 - Freezing Ratio: [Stage3] 0.00, Threshold: 7.2277e-01
[rank1]:2025-12-27 03:08:44,043 - Freezing Ratio: [Stage1] 0.60, Threshold: 1.6285e+00
[rank2]:2025-12-27 03:08:44,043 - Freezing Ratio: [Stage2] 0.00, Threshold: 1.1588e+00
[rank0]:2025-12-27 03:08:44,058 - Freezing Ratio: [Stage0] 0.73, Threshold: 7.0133e-01
[rank1]:2025-12-27 03:09:34,109 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.7283e+00
[rank3]:2025-12-27 03:09:34,128 - Freezing Ratio: [Stage3] 0.62, Threshold: 5.5837e-01
[rank2]:2025-12-27 03:09:34,117 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.1310e-01
[rank0]:2025-12-27 03:09:34,120 - Freezing Ratio: [Stage0] 0.73, Threshold: 8.1084e-01
[rank3]:2025-12-27 03:10:01,032 - Avg. fwd time: 14.0350 / Avg. bwd time: 40.0970 / Avg. batch time: 496.4603 (ms) / GPU bubble ratio: 12.77%
[rank2]:2025-12-27 03:10:01,055 - Avg. fwd time: 7.8636 / Avg. bwd time: 16.2452 / Avg. batch time: 524.9257 (ms) / GPU bubble ratio: 63.26%
[rank0]:2025-12-27 03:10:01,106 - Avg. fwd time: 8.5373 / Avg. bwd time: 18.2781 / Avg. batch time: 588.9769 (ms) / GPU bubble ratio: 63.58%
[rank1]:2025-12-27 03:10:01,079 - Avg. fwd time: 10.0486 / Avg. bwd time: 18.2763 / Avg. batch time: 557.6313 (ms) / GPU bubble ratio: 59.36%
[rank2]:2025-12-27 03:10:19,231 - Freezing Ratio: [Stage2] 0.00, Threshold: 1.3380e+00
[rank0]:2025-12-27 03:10:19,246 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.9826e+00
[rank1]:2025-12-27 03:10:19,231 - Freezing Ratio: [Stage1] 0.60, Threshold: 6.1102e-01
[rank3]:2025-12-27 03:10:19,247 - Freezing Ratio: [Stage3] 0.00, Threshold: 9.2200e-01
[rank1]:2025-12-27 03:11:09,232 - Freezing Ratio: [Stage1] 0.80, Threshold: 3.5298e-01
[rank3]:2025-12-27 03:11:09,252 - Freezing Ratio: [Stage3] 0.62, Threshold: 3.0243e-01
[rank2]:2025-12-27 03:11:09,240 - Freezing Ratio: [Stage2] 0.75, Threshold: 8.1795e-02
[rank0]:2025-12-27 03:11:09,244 - Freezing Ratio: [Stage0] 0.73, Threshold: 5.0238e-01
[rank2]:2025-12-27 03:11:54,344 - Freezing Ratio: [Stage2] 0.00, Threshold: 3.4832e-01
[rank0]:2025-12-27 03:11:54,343 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-27 03:11:54,360 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.0544e+00
[rank1]:2025-12-27 03:11:54,344 - Freezing Ratio: [Stage1] 0.60, Threshold: 1.0354e+00
[rank3]:2025-12-27 03:11:54,360 - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0474e-01
[rank2]:2025-12-27 03:11:59,374 - Avg. fwd time: 7.8688 / Avg. bwd time: 16.2041 / Avg. batch time: 524.6565 (ms) / GPU bubble ratio: 63.29%
[rank1]:2025-12-27 03:11:59,401 - Avg. fwd time: 10.0659 / Avg. bwd time: 18.1309 / Avg. batch time: 557.2160 (ms) / GPU bubble ratio: 59.52%
[rank3]:2025-12-27 03:11:59,342 - Avg. fwd time: 14.0372 / Avg. bwd time: 40.0670 / Avg. batch time: 496.2365 (ms) / GPU bubble ratio: 12.78%
[rank2]:2025-12-27 03:11:59,447 -  step: 600  loss: -8.0000  grad_norm:  0.1111  memory:  6.98GiB(14.69%)  tps: 6,937  tflops: 54.23  mfu: 17.38%
[rank0]:2025-12-27 03:11:59,428 - Avg. fwd time: 8.5467 / Avg. bwd time: 18.2051 / Avg. batch time: 588.4849 (ms) / GPU bubble ratio: 63.63%
[rank0]:2025-12-27 03:11:59,451 -  step: 600  loss: -8.0000  grad_norm:  0.1111  memory: 13.42GiB(28.26%)  tps: 6,937  tflops: 54.23  mfu: 17.38%
[rank0]:2025-12-27 03:11:59,511 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p70_42_dm1/frozen_ratio_history/rank0/251227_0311_stage0_step600.svg
[rank1]:2025-12-27 03:11:59,440 -  step: 600  loss: -8.0000  grad_norm:  0.1111  memory:  9.50GiB(19.99%)  tps: 6,937  tflops: 54.23  mfu: 17.38%
[rank1]:2025-12-27 03:11:59,513 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p70_42_dm1/frozen_ratio_history/rank1/251227_0311_stage1_step600.svg
[rank3]:2025-12-27 03:11:59,459 -  step: 600  loss:  0.2310  grad_norm:  0.1111  memory: 16.39GiB(34.50%)  tps: 6,937  tflops: 54.23  mfu: 17.38%
[rank2]:2025-12-27 03:11:59,513 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p70_42_dm1/frozen_ratio_history/rank2/251227_0311_stage2_step600.svg
[rank3]:2025-12-27 03:11:59,597 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p70_42_dm1/pipeline_schedule/251227_0311_step600_rank3.svg
[rank3]:			> Batch Time: 548.56 ms, GPU Bubble Ratio: 63.03%, 64.85%, 70.92%, 26.20%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-36ms      | [S0,MB0,B]  121-16-138ms   | [S0,MB4,F]  138-8-146ms    | [S0,MB1,B]  176-16-192ms   | [S0,MB5,F]  193-8-201ms    | [S0,MB2,B]  233-16-249ms   | [S0,MB6,F]  249-8-258ms    | [S0,MB3,B]  293-16-309ms   | [S0,MB7,F]  309-8-318ms    | [S0,MB4,B]  354-16-370ms   | [S0,MB5,B]  413-16-429ms   | [S0,MB6,B]  472-16-488ms   | [S0,MB7,B]  532-16-548ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-10-34ms     | [S1,MB2,F]  37-10-47ms     | [S1,MB0,B]  103-13-116ms   | [S1,MB3,F]  120-10-130ms   | [S1,MB1,B]  157-13-171ms   | [S1,MB4,F]  174-10-185ms   | [S1,MB2,B]  214-13-227ms   | [S1,MB5,F]  231-10-241ms   | [S1,MB3,B]  274-13-287ms   | [S1,MB6,F]  291-10-301ms   | [S1,MB4,B]  335-13-348ms   | [S1,MB7,F]  352-10-362ms   | [S1,MB5,B]  396-13-409ms   | [S1,MB6,B]  455-13-468ms   | [S1,MB7,B]  514-13-528ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  34-8-42ms      | [S2,MB0,B]  86-11-98ms     | [S2,MB2,F]  101-8-109ms    | [S2,MB1,B]  141-11-152ms   | [S2,MB3,F]  156-8-164ms    | [S2,MB2,B]  197-11-209ms   | [S2,MB4,F]  212-8-221ms    | [S2,MB3,B]  257-11-269ms   | [S2,MB5,F]  272-8-281ms    | [S2,MB4,B]  318-11-330ms   | [S2,MB6,F]  333-8-342ms    | [S2,MB5,B]  379-11-391ms   | [S2,MB7,F]  394-8-403ms    | [S2,MB6,B]  440-11-451ms   | [S2,MB7,B]  500-11-511ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  48-34-82ms     | [S3,MB1,F]  84-11-96ms     | [S3,MB1,B]  102-35-137ms   | [S3,MB2,F]  139-12-152ms   | [S3,MB2,B]  158-35-194ms   | [S3,MB3,F]  196-14-211ms   | [S3,MB3,B]  217-36-254ms   | [S3,MB4,F]  256-15-271ms   | [S3,MB4,B]  277-37-315ms   | [S3,MB5,F]  317-15-332ms   | [S3,MB5,B]  338-37-376ms   | [S3,MB6,F]  378-14-393ms   | [S3,MB6,B]  399-37-436ms   | [S3,MB7,F]  438-14-453ms   | [S3,MB7,B]  459-37-497ms  
[rank2]:2025-12-27 03:11:59,664 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p70_42_dm1/frozen_params_histogram/251227_0311_rank2_stage2.svg
[rank2]:	> Counts Sum: 729, Total Sum: 1980 (36.82%), Ratio(%) per element: [49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-12-27 03:11:59,662 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p70_42_dm1/frozen_params_histogram/251227_0311_rank0_stage0.svg
[rank0]:	> Counts Sum: 1323, Total Sum: 2035 (65.01%), Ratio(%) per element: [0.0, 96.36, 96.36, 96.36, 96.36, 96.36, 96.36, 96.36, 96.36, 96.36, 96.36, 96.36, 96.36, 96.36, 96.36, 96.36, 96.36, 96.36, 96.36, 74.54, 74.54, 74.54, 74.54, 74.54, 74.54, 74.54, 74.54, 74.54, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-12-27 03:11:59,657 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p70_42_dm1/frozen_params_histogram/251227_0311_rank1_stage1.svg
[rank1]:	> Counts Sum: 1314, Total Sum: 2475 (53.09%), Ratio(%) per element: [78.18, 78.18, 78.18, 78.18, 78.18, 78.18, 78.18, 78.18, 78.18, 78.18, 78.18, 78.18, 78.18, 78.18, 78.18, 78.18, 78.18, 78.18, 78.18, 78.18, 78.18, 78.18, 78.18, 78.18, 78.18, 78.18, 78.18, 30.9, 30.9, 30.9, 30.9, 30.9, 30.9, 30.9, 30.9, 30.9, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-27 03:11:59,642 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p70_42_dm1/frozen_ratio_history/rank3/251227_0311_stage3_step600.svg
[rank3]:2025-12-27 03:11:59,775 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p70_42_dm1/frozen_params_histogram/251227_0311_rank3_stage3.svg
[rank3]:	> Counts Sum: 486, Total Sum: 1595 (30.47%), Ratio(%) per element: [49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-12-27 03:12:44,757 - Freezing Ratio: [Stage0] 0.73, Threshold: 9.5784e-01
[rank1]:2025-12-27 03:12:44,746 - Freezing Ratio: [Stage1] 0.80, Threshold: 2.3671e-01
[rank3]:2025-12-27 03:12:44,766 - Freezing Ratio: [Stage3] 0.62, Threshold: 3.4268e-01
[rank2]:2025-12-27 03:12:44,754 - Freezing Ratio: [Stage2] 0.75, Threshold: 9.6455e-02
[rank3]:2025-12-27 03:13:29,748 - Freezing Ratio: [Stage3] 0.00, Threshold: 5.7593e-01
[rank1]:2025-12-27 03:13:29,733 - Freezing Ratio: [Stage1] 0.60, Threshold: 5.3127e-01
[rank2]:2025-12-27 03:13:29,733 - Freezing Ratio: [Stage2] 0.00, Threshold: 6.8771e-01
[rank0]:2025-12-27 03:13:29,748 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1771e+00
[rank3]:2025-12-27 03:13:59,738 - Avg. fwd time: 14.0344 / Avg. bwd time: 40.0811 / Avg. batch time: 496.3252 (ms) / GPU bubble ratio: 12.77%
[rank2]:2025-12-27 03:13:59,770 - Avg. fwd time: 7.8664 / Avg. bwd time: 16.2213 / Avg. batch time: 524.7753 (ms) / GPU bubble ratio: 63.28%
[rank0]:2025-12-27 03:13:59,825 - Avg. fwd time: 8.5552 / Avg. bwd time: 18.1379 / Avg. batch time: 588.4179 (ms) / GPU bubble ratio: 63.71%
[rank1]:2025-12-27 03:13:59,798 - Avg. fwd time: 10.0794 / Avg. bwd time: 18.0158 / Avg. batch time: 557.2196 (ms) / GPU bubble ratio: 59.66%
[rank2]:2025-12-27 03:14:19,736 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.4666e-01
[rank0]:2025-12-27 03:14:19,740 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.4306e+00
[rank3]:2025-12-27 03:14:19,748 - Freezing Ratio: [Stage3] 0.62, Threshold: 4.0211e-01
[rank1]:2025-12-27 03:14:19,728 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.4566e+00
[rank2]:2025-12-27 03:15:04,944 - Freezing Ratio: [Stage2] 0.00, Threshold: 1.6551e+00
[rank3]:2025-12-27 03:15:04,960 - Freezing Ratio: [Stage3] 0.00, Threshold: 9.4323e-01
[rank0]:2025-12-27 03:15:04,960 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.6591e+00
[rank1]:2025-12-27 03:15:04,944 - Freezing Ratio: [Stage1] 0.60, Threshold: 1.6956e+00
[rank3]:2025-12-27 03:15:55,031 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.0661e+00
[rank0]:2025-12-27 03:15:55,014 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-27 03:15:55,022 - Freezing Ratio: [Stage0] 0.73, Threshold: 3.1791e+00
[rank1]:2025-12-27 03:15:55,010 - Freezing Ratio: [Stage1] 0.80, Threshold: 6.8150e-01
[rank2]:2025-12-27 03:15:55,018 - Freezing Ratio: [Stage2] 0.75, Threshold: 4.1135e-01
[rank2]:2025-12-27 03:15:59,502 - Avg. fwd time: 7.8658 / Avg. bwd time: 16.2240 / Avg. batch time: 524.7854 (ms) / GPU bubble ratio: 63.28%
[rank3]:2025-12-27 03:15:59,479 - Avg. fwd time: 14.0333 / Avg. bwd time: 40.0837 / Avg. batch time: 496.3366 (ms) / GPU bubble ratio: 12.77%
[rank1]:2025-12-27 03:15:59,527 - Avg. fwd time: 10.0922 / Avg. bwd time: 17.9049 / Avg. batch time: 557.1182 (ms) / GPU bubble ratio: 59.80%
[rank2]:2025-12-27 03:15:59,563 -  step: 650  loss: -8.0000  grad_norm:  0.0683  memory:  6.98GiB(14.69%)  tps: 6,823  tflops: 53.34  mfu: 17.10%
[rank3]:2025-12-27 03:15:59,579 -  step: 650  loss:  0.2456  grad_norm:  0.0683  memory: 16.39GiB(34.50%)  tps: 6,823  tflops: 53.34  mfu: 17.10%
[rank0]:2025-12-27 03:15:59,554 - Avg. fwd time: 8.5632 / Avg. bwd time: 18.0759 / Avg. batch time: 588.2524 (ms) / GPU bubble ratio: 63.77%
[rank0]:2025-12-27 03:15:59,578 -  step: 650  loss: -8.0000  grad_norm:  0.0683  memory: 13.42GiB(28.26%)  tps: 6,823  tflops: 53.34  mfu: 17.10%
[rank1]:2025-12-27 03:15:59,563 -  step: 650  loss: -8.0000  grad_norm:  0.0683  memory:  9.50GiB(19.99%)  tps: 6,823  tflops: 53.34  mfu: 17.10%
[rank2]:2025-12-27 03:16:40,171 - Freezing Ratio: [Stage2] 0.00, Threshold: 3.6181e+00
[rank1]:2025-12-27 03:16:40,171 - Freezing Ratio: [Stage1] 0.60, Threshold: 2.1318e+00
[rank3]:2025-12-27 03:16:40,187 - Freezing Ratio: [Stage3] 0.00, Threshold: 3.1298e+00
[rank0]:2025-12-27 03:16:40,186 - Freezing Ratio: [Stage0] 0.73, Threshold: 2.5983e+00
[rank2]:2025-12-27 03:17:30,180 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.8817e-01
[rank1]:2025-12-27 03:17:30,172 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.0143e+00
[rank3]:2025-12-27 03:17:30,192 - Freezing Ratio: [Stage3] 0.62, Threshold: 6.3707e-01
[rank0]:2025-12-27 03:17:30,184 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.8351e+00
[rank2]:2025-12-27 03:17:57,365 - Avg. fwd time: 7.8718 / Avg. bwd time: 16.1755 / Avg. batch time: 524.4478 (ms) / GPU bubble ratio: 63.32%
[rank3]:2025-12-27 03:17:57,341 - Avg. fwd time: 14.0346 / Avg. bwd time: 40.0470 / Avg. batch time: 496.0515 (ms) / GPU bubble ratio: 12.78%
[rank1]:2025-12-27 03:17:57,390 - Avg. fwd time: 10.1063 / Avg. bwd time: 17.7850 / Avg. batch time: 556.6607 (ms) / GPU bubble ratio: 59.92%
[rank0]:2025-12-27 03:17:57,419 - Avg. fwd time: 8.5706 / Avg. bwd time: 18.0188 / Avg. batch time: 587.7363 (ms) / GPU bubble ratio: 63.81%
[rank3]:2025-12-27 03:18:15,420 - Freezing Ratio: [Stage3] 0.00, Threshold: 2.5091e+00
[rank0]:2025-12-27 03:18:15,420 - Freezing Ratio: [Stage0] 0.73, Threshold: 2.0914e+00
[rank2]:2025-12-27 03:18:15,404 - Freezing Ratio: [Stage2] 0.00, Threshold: 2.5768e+00
[rank1]:2025-12-27 03:18:15,405 - Freezing Ratio: [Stage1] 0.60, Threshold: 2.4680e+00
[rank0]:2025-12-27 03:19:05,488 - Freezing Ratio: [Stage0] 0.73, Threshold: 7.0972e-01
[rank2]:2025-12-27 03:19:05,484 - Freezing Ratio: [Stage2] 0.75, Threshold: 7.9391e-02
[rank1]:2025-12-27 03:19:05,476 - Freezing Ratio: [Stage1] 0.80, Threshold: 2.6392e-01
[rank3]:2025-12-27 03:19:05,496 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.4232e-01
[rank1]:2025-12-27 03:19:50,573 - Freezing Ratio: [Stage1] 0.60, Threshold: 4.9988e+00
[rank2]:2025-12-27 03:19:50,573 - Freezing Ratio: [Stage2] 0.00, Threshold: 5.1482e+00
[rank3]:2025-12-27 03:19:50,589 - Freezing Ratio: [Stage3] 0.00, Threshold: 5.2774e+00
[rank0]:2025-12-27 03:19:50,571 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-27 03:19:50,588 - Freezing Ratio: [Stage0] 0.73, Threshold: 3.1444e+00
[rank2]:2025-12-27 03:19:55,517 - Avg. fwd time: 7.8758 / Avg. bwd time: 16.1427 / Avg. batch time: 524.1957 (ms) / GPU bubble ratio: 63.34%
[rank3]:2025-12-27 03:19:55,484 - Avg. fwd time: 14.0340 / Avg. bwd time: 40.0206 / Avg. batch time: 495.8357 (ms) / GPU bubble ratio: 12.79%
[rank1]:2025-12-27 03:19:55,545 - Avg. fwd time: 10.1189 / Avg. bwd time: 17.6779 / Avg. batch time: 556.3011 (ms) / GPU bubble ratio: 60.03%
[rank1]:2025-12-27 03:19:55,586 -  step: 700  loss: -8.0000  grad_norm:  0.1009  memory:  9.50GiB(19.99%)  tps: 6,942  tflops: 54.27  mfu: 17.39%
[rank2]:2025-12-27 03:19:55,592 -  step: 700  loss: -8.0000  grad_norm:  0.1009  memory:  6.98GiB(14.69%)  tps: 6,942  tflops: 54.27  mfu: 17.39%
[rank3]:2025-12-27 03:19:55,605 -  step: 700  loss:  0.2106  grad_norm:  0.1009  memory: 16.39GiB(34.50%)  tps: 6,942  tflops: 54.27  mfu: 17.39%
[rank0]:2025-12-27 03:19:55,573 - Avg. fwd time: 8.5774 / Avg. bwd time: 17.9656 / Avg. batch time: 587.3217 (ms) / GPU bubble ratio: 63.85%
[rank0]:2025-12-27 03:19:55,596 -  step: 700  loss: -8.0000  grad_norm:  0.1009  memory: 13.42GiB(28.26%)  tps: 6,942  tflops: 54.27  mfu: 17.39%
[rank0]:2025-12-27 03:19:55,659 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p70_42_dm1/frozen_ratio_history/rank0/251227_0319_stage0_step700.svg
[rank1]:2025-12-27 03:19:55,661 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p70_42_dm1/frozen_ratio_history/rank1/251227_0319_stage1_step700.svg
[rank2]:2025-12-27 03:19:55,659 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p70_42_dm1/frozen_ratio_history/rank2/251227_0319_stage2_step700.svg
[rank3]:2025-12-27 03:19:55,744 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p70_42_dm1/pipeline_schedule/251227_0319_step700_rank3.svg
[rank3]:			> Batch Time: 550.06 ms, GPU Bubble Ratio: 63.09%, 64.83%, 70.91%, 25.92%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-36ms      | [S0,MB0,B]  122-16-138ms   | [S0,MB4,F]  138-8-147ms    | [S0,MB1,B]  178-16-195ms   | [S0,MB5,F]  195-8-203ms    | [S0,MB2,B]  235-16-252ms   | [S0,MB6,F]  252-8-260ms    | [S0,MB3,B]  295-16-311ms   | [S0,MB7,F]  311-8-320ms    | [S0,MB4,B]  355-16-372ms   | [S0,MB5,B]  414-16-431ms   | [S0,MB6,B]  473-16-490ms   | [S0,MB7,B]  533-16-550ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-10-34ms     | [S1,MB2,F]  37-10-48ms     | [S1,MB0,B]  103-13-117ms   | [S1,MB3,F]  120-10-131ms   | [S1,MB1,B]  159-13-173ms   | [S1,MB4,F]  176-10-187ms   | [S1,MB2,B]  216-13-230ms   | [S1,MB5,F]  234-10-244ms   | [S1,MB3,B]  276-13-290ms   | [S1,MB6,F]  293-10-304ms   | [S1,MB4,B]  336-13-350ms   | [S1,MB7,F]  353-10-364ms   | [S1,MB5,B]  397-13-411ms   | [S1,MB6,B]  456-13-470ms   | [S1,MB7,B]  516-13-530ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  34-8-42ms      | [S2,MB0,B]  86-11-98ms     | [S2,MB2,F]  101-8-110ms    | [S2,MB1,B]  143-11-154ms   | [S2,MB3,F]  158-8-166ms    | [S2,MB2,B]  200-11-211ms   | [S2,MB4,F]  215-8-223ms    | [S2,MB3,B]  260-11-271ms   | [S2,MB5,F]  275-8-283ms    | [S2,MB4,B]  320-11-331ms   | [S2,MB6,F]  335-8-343ms    | [S2,MB5,B]  381-11-392ms   | [S2,MB7,F]  396-8-404ms    | [S2,MB6,B]  441-11-453ms   | [S2,MB7,B]  502-11-513ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  48-34-82ms     | [S3,MB1,F]  85-11-97ms     | [S3,MB1,B]  103-35-138ms   | [S3,MB2,F]  141-13-154ms   | [S3,MB2,B]  160-36-196ms   | [S3,MB3,F]  198-14-213ms   | [S3,MB3,B]  219-37-256ms   | [S3,MB4,F]  258-15-273ms   | [S3,MB4,B]  278-37-316ms   | [S3,MB5,F]  318-15-333ms   | [S3,MB5,B]  339-37-377ms   | [S3,MB6,F]  379-14-394ms   | [S3,MB6,B]  400-37-437ms   | [S3,MB7,F]  440-14-454ms   | [S3,MB7,B]  460-38-498ms  
[rank1]:2025-12-27 03:19:55,804 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p70_42_dm1/frozen_params_histogram/251227_0319_rank1_stage1.svg
[rank1]:	> Counts Sum: 1629, Total Sum: 2925 (55.69%), Ratio(%) per element: [81.53, 81.53, 81.53, 81.53, 81.53, 81.53, 81.53, 81.53, 81.53, 81.53, 81.53, 81.53, 81.53, 81.53, 81.53, 81.53, 81.53, 81.53, 81.53, 81.53, 81.53, 81.53, 81.53, 81.53, 81.53, 81.53, 81.53, 33.84, 33.84, 33.84, 33.84, 33.84, 33.84, 33.84, 33.84, 33.84, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-12-27 03:19:55,813 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p70_42_dm1/frozen_params_histogram/251227_0319_rank2_stage2.svg
[rank2]:	> Counts Sum: 864, Total Sum: 2340 (36.92%), Ratio(%) per element: [49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-27 03:19:55,793 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p70_42_dm1/frozen_ratio_history/rank3/251227_0319_stage3_step700.svg
[rank0]:2025-12-27 03:19:55,811 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p70_42_dm1/frozen_params_histogram/251227_0319_rank0_stage0.svg
[rank0]:	> Counts Sum: 1593, Total Sum: 2405 (66.24%), Ratio(%) per element: [0.0, 96.92, 96.92, 96.92, 96.92, 96.92, 96.92, 96.92, 96.92, 96.92, 96.92, 96.92, 96.92, 96.92, 96.92, 96.92, 96.92, 96.92, 96.92, 78.46, 78.46, 78.46, 78.46, 78.46, 78.46, 78.46, 78.46, 78.46, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-27 03:19:55,924 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p70_42_dm1/frozen_params_histogram/251227_0319_rank3_stage3.svg
[rank3]:	> Counts Sum: 576, Total Sum: 1885 (30.56%), Ratio(%) per element: [49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 49.23, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-12-27 03:20:40,813 - Freezing Ratio: [Stage1] 0.80, Threshold: 2.5649e-01
[rank2]:2025-12-27 03:20:40,821 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.0682e-01
[rank3]:2025-12-27 03:20:40,832 - Freezing Ratio: [Stage3] 0.62, Threshold: 3.3391e-01
[rank0]:2025-12-27 03:20:40,824 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.3395e+00
[rank1]:2025-12-27 03:21:26,004 - Freezing Ratio: [Stage1] 0.60, Threshold: 1.9431e-01
[rank2]:2025-12-27 03:21:26,004 - Freezing Ratio: [Stage2] 0.00, Threshold: 1.3002e-01
[rank3]:2025-12-27 03:21:26,020 - Freezing Ratio: [Stage3] 0.00, Threshold: 7.1328e-01
[rank0]:2025-12-27 03:21:26,019 - Freezing Ratio: [Stage0] 0.73, Threshold: 6.5075e-01
[rank3]:2025-12-27 03:21:55,910 - Avg. fwd time: 14.0314 / Avg. bwd time: 40.0340 / Avg. batch time: 495.9210 (ms) / GPU bubble ratio: 12.78%
[rank1]:2025-12-27 03:21:55,971 - Avg. fwd time: 10.1284 / Avg. bwd time: 17.5939 / Avg. batch time: 556.3302 (ms) / GPU bubble ratio: 60.14%
[rank2]:2025-12-27 03:21:55,943 - Avg. fwd time: 7.8732 / Avg. bwd time: 16.1595 / Avg. batch time: 524.3089 (ms) / GPU bubble ratio: 63.33%
[rank0]:2025-12-27 03:21:56,000 - Avg. fwd time: 8.5836 / Avg. bwd time: 17.9160 / Avg. batch time: 587.2997 (ms) / GPU bubble ratio: 63.90%
[rank2]:2025-12-27 03:22:16,124 - Freezing Ratio: [Stage2] 0.75, Threshold: 8.6874e-02
[rank0]:2025-12-27 03:22:16,127 - Freezing Ratio: [Stage0] 0.73, Threshold: 7.9787e-01
[rank3]:2025-12-27 03:22:16,135 - Freezing Ratio: [Stage3] 0.62, Threshold: 3.2867e-01
[rank1]:2025-12-27 03:22:16,116 - Freezing Ratio: [Stage1] 0.80, Threshold: 9.9506e-01
[rank1]:2025-12-27 03:23:01,233 - Freezing Ratio: [Stage1] 0.60, Threshold: 1.1867e+00
[rank0]:2025-12-27 03:23:01,248 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.8661e+00
[rank2]:2025-12-27 03:23:01,233 - Freezing Ratio: [Stage2] 0.00, Threshold: 2.7284e+00
[rank3]:2025-12-27 03:23:01,249 - Freezing Ratio: [Stage3] 0.00, Threshold: 2.5476e+00
[rank1]:2025-12-27 03:23:51,214 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.2358e+00
[rank0]:2025-12-27 03:23:51,218 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-27 03:23:51,226 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.9843e+00
[rank2]:2025-12-27 03:23:51,222 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.2778e-01
[rank3]:2025-12-27 03:23:51,234 - Freezing Ratio: [Stage3] 0.62, Threshold: 9.9565e-01
[rank2]:2025-12-27 03:23:55,739 - Avg. fwd time: 7.8725 / Avg. bwd time: 16.1637 / Avg. batch time: 524.3390 (ms) / GPU bubble ratio: 63.33%
[rank3]:2025-12-27 03:23:55,713 - Avg. fwd time: 14.0313 / Avg. bwd time: 40.0376 / Avg. batch time: 495.9502 (ms) / GPU bubble ratio: 12.78%
[rank1]:2025-12-27 03:23:55,765 - Avg. fwd time: 10.1380 / Avg. bwd time: 17.5118 / Avg. batch time: 556.2780 (ms) / GPU bubble ratio: 60.24%
[rank1]:2025-12-27 03:23:55,803 -  step: 750  loss: -8.0000  grad_norm:  0.0838  memory:  9.50GiB(19.99%)  tps: 6,820  tflops: 53.32  mfu: 17.09%
[rank0]:2025-12-27 03:23:55,794 - Avg. fwd time: 8.5895 / Avg. bwd time: 17.8697 / Avg. batch time: 587.1995 (ms) / GPU bubble ratio: 63.95%
[rank0]:2025-12-27 03:23:55,817 -  step: 750  loss: -8.0000  grad_norm:  0.0838  memory: 13.42GiB(28.26%)  tps: 6,820  tflops: 53.32  mfu: 17.09%
[rank2]:2025-12-27 03:23:55,803 -  step: 750  loss: -8.0000  grad_norm:  0.0838  memory:  6.98GiB(14.69%)  tps: 6,821  tflops: 53.32  mfu: 17.09%
[rank3]:2025-12-27 03:23:55,820 -  step: 750  loss:  0.2538  grad_norm:  0.0838  memory: 16.39GiB(34.50%)  tps: 6,821  tflops: 53.32  mfu: 17.09%
[rank1]:2025-12-27 03:24:36,459 - Freezing Ratio: [Stage1] 0.60, Threshold: 7.8173e-01
[rank0]:2025-12-27 03:24:36,474 - Freezing Ratio: [Stage0] 0.73, Threshold: 7.8819e-01
[rank2]:2025-12-27 03:24:36,458 - Freezing Ratio: [Stage2] 0.00, Threshold: 1.0005e+00
[rank3]:2025-12-27 03:24:36,474 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.3062e+00
[rank1]:2025-12-27 03:25:26,625 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.2412e+00
[rank0]:2025-12-27 03:25:26,636 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.5379e+00
[rank2]:2025-12-27 03:25:26,633 - Freezing Ratio: [Stage2] 0.75, Threshold: 9.9960e-02
[rank3]:2025-12-27 03:25:26,645 - Freezing Ratio: [Stage3] 0.62, Threshold: 5.1996e-01
[rank1]:2025-12-27 03:25:53,706 - Avg. fwd time: 10.1488 / Avg. bwd time: 17.4200 / Avg. batch time: 555.9279 (ms) / GPU bubble ratio: 60.33%
[rank2]:2025-12-27 03:25:53,680 - Avg. fwd time: 7.8777 / Avg. bwd time: 16.1233 / Avg. batch time: 524.0808 (ms) / GPU bubble ratio: 63.36%
[rank3]:2025-12-27 03:25:53,654 - Avg. fwd time: 14.0343 / Avg. bwd time: 40.0077 / Avg. batch time: 495.7357 (ms) / GPU bubble ratio: 12.79%
[rank0]:2025-12-27 03:25:53,735 - Avg. fwd time: 8.5948 / Avg. bwd time: 17.8264 / Avg. batch time: 586.8046 (ms) / GPU bubble ratio: 63.98%
[rank1]:2025-12-27 03:26:11,897 - Freezing Ratio: [Stage1] 0.60, Threshold: 3.1058e+00
[rank0]:2025-12-27 03:26:11,912 - Freezing Ratio: [Stage0] 0.73, Threshold: 2.7214e+00
[rank2]:2025-12-27 03:26:11,897 - Freezing Ratio: [Stage2] 0.00, Threshold: 2.2266e+00
[rank3]:2025-12-27 03:26:11,913 - Freezing Ratio: [Stage3] 0.00, Threshold: 2.6527e+00
[rank2]:2025-12-27 03:27:01,909 - Freezing Ratio: [Stage2] 0.75, Threshold: 6.5832e-02
[rank3]:2025-12-27 03:27:01,921 - Freezing Ratio: [Stage3] 0.62, Threshold: 3.4244e-01
[rank1]:2025-12-27 03:27:01,901 - Freezing Ratio: [Stage1] 0.80, Threshold: 9.5355e-01
[rank0]:2025-12-27 03:27:01,913 - Freezing Ratio: [Stage0] 0.73, Threshold: 4.6784e-01
[rank1]:2025-12-27 03:27:47,232 - Freezing Ratio: [Stage1] 0.60, Threshold: 1.8759e+00
[rank0]:2025-12-27 03:27:47,230 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-27 03:27:47,247 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1170e+00
[rank2]:2025-12-27 03:27:47,232 - Freezing Ratio: [Stage2] 0.00, Threshold: 1.9419e+00
[rank3]:2025-12-27 03:27:47,247 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.7488e+00
[rank3]:2025-12-27 03:27:52,260 - Avg. fwd time: 14.0386 / Avg. bwd time: 39.9891 / Avg. batch time: 495.6208 (ms) / GPU bubble ratio: 12.79%
[rank1]:2025-12-27 03:27:52,324 - Avg. fwd time: 10.1587 / Avg. bwd time: 17.3377 / Avg. batch time: 555.7014 (ms) / GPU bubble ratio: 60.42%
[rank0]:2025-12-27 03:27:52,354 - Avg. fwd time: 8.6001 / Avg. bwd time: 17.7859 / Avg. batch time: 586.5375 (ms) / GPU bubble ratio: 64.01%
[rank2]:2025-12-27 03:27:52,294 - Avg. fwd time: 7.8811 / Avg. bwd time: 16.0962 / Avg. batch time: 523.9360 (ms) / GPU bubble ratio: 63.39%
[rank2]:2025-12-27 03:27:52,372 -  step: 800  loss: -8.0000  grad_norm:  0.1042  memory:  6.98GiB(14.69%)  tps: 6,926  tflops: 54.14  mfu: 17.35%
[rank2]:2025-12-27 03:27:52,372 - â„¹ï¸ final step: 800  loss: -8.0000  grad_norm:  0.1042  tps: 7,223  tflops: 56.47  mfu: 16.52%
[rank2]:2025-12-27 03:27:52,373 - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-12-27 03:27:52,373 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank3]:2025-12-27 03:27:52,385 -  step: 800  loss:  0.2508  grad_norm:  0.1042  memory: 16.39GiB(34.50%)  tps: 6,926  tflops: 54.14  mfu: 17.35%
[rank3]:2025-12-27 03:27:52,385 - â„¹ï¸ final step: 800  loss:  0.2508  grad_norm:  0.1042  tps: 7,227  tflops: 56.50  mfu: 16.63%
[rank3]:2025-12-27 03:27:52,386 - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-12-27 03:27:52,386 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank1]:2025-12-27 03:27:52,366 -  step: 800  loss: -8.0000  grad_norm:  0.1042  memory:  9.50GiB(19.99%)  tps: 6,926  tflops: 54.14  mfu: 17.35%
[rank1]:2025-12-27 03:27:52,366 - â„¹ï¸ final step: 800  loss: -8.0000  grad_norm:  0.1042  tps: 7,222  tflops: 56.46  mfu: 16.50%
[rank1]:2025-12-27 03:27:52,366 - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-12-27 03:27:52,367 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-27 03:27:52,377 -  step: 800  loss: -8.0000  grad_norm:  0.1042  memory: 13.42GiB(28.26%)  tps: 6,926  tflops: 54.14  mfu: 17.35%
[rank0]:2025-12-27 03:27:52,377 - â„¹ï¸ final step: 800  loss: -8.0000  grad_norm:  0.1042  tps: 7,222  tflops: 56.46  mfu: 16.50%
[rank0]:2025-12-27 03:27:52,377 - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-12-27 03:27:52,378 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-27 03:27:54,435 - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank1]:2025-12-27 03:27:54,522 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p70_42_dm1/frozen_ratio_history/rank1/251227_0327_stage1_final800.svg
[rank0]:2025-12-27 03:27:54,516 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p70_42_dm1/frozen_ratio_history/rank0/251227_0327_stage0_final800.svg
[rank2]:2025-12-27 03:27:54,515 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p70_42_dm1/frozen_ratio_history/rank2/251227_0327_stage2_final800.svg
[rank0]:2025-12-27 03:27:54,670 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p70_42_dm1/frozen_params_histogram/251227_0327_rank0_stage0.svg
[rank0]:	> Counts Sum: 1863, Total Sum: 2775 (67.14%), Ratio(%) per element: [0.0, 97.33, 97.33, 97.33, 97.33, 97.33, 97.33, 97.33, 97.33, 97.33, 97.33, 97.33, 97.33, 97.33, 97.33, 97.33, 97.33, 97.33, 97.33, 81.33, 81.33, 81.33, 81.33, 81.33, 81.33, 81.33, 81.33, 81.33, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-12-27 03:27:54,670 - Sleeping 2 seconds for other ranks to complete
[rank2]:2025-12-27 03:27:54,663 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p70_42_dm1/frozen_params_histogram/251227_0327_rank2_stage2.svg
[rank2]:	> Counts Sum: 999, Total Sum: 2700 (37.00%), Ratio(%) per element: [49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-12-27 03:27:54,664 - Destroying the purge thread.
[rank3]:2025-12-27 03:27:54,601 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p70_42_dm1/pipeline_schedule/251227_0327_final800_rank3.svg
[rank3]:			> Batch Time: 602.06 ms, GPU Bubble Ratio: 66.33%, 64.51%, 63.97%, 26.88%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-36ms      | [S0,MB0,B]  134-16-151ms   | [S0,MB4,F]  154-8-162ms    | [S0,MB1,B]  196-16-212ms   | [S0,MB5,F]  213-8-221ms    | [S0,MB2,B]  260-16-277ms   | [S0,MB6,F]  277-8-285ms    | [S0,MB3,B]  325-16-342ms   | [S0,MB7,F]  342-8-350ms    | [S0,MB4,B]  390-16-407ms   | [S0,MB5,B]  455-16-472ms   | [S0,MB6,B]  520-16-537ms   | [S0,MB7,B]  585-16-602ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-10-33ms     | [S1,MB2,F]  37-10-47ms     | [S1,MB0,B]  108-16-124ms   | [S1,MB3,F]  132-10-142ms   | [S1,MB1,B]  173-16-189ms   | [S1,MB4,F]  194-10-204ms   | [S1,MB2,B]  238-16-254ms   | [S1,MB5,F]  259-10-269ms   | [S1,MB3,B]  303-16-319ms   | [S1,MB6,F]  323-10-333ms   | [S1,MB4,B]  368-16-384ms   | [S1,MB7,F]  389-10-399ms   | [S1,MB5,B]  434-16-451ms   | [S1,MB6,B]  499-16-516ms   | [S1,MB7,B]  564-16-580ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  33-7-41ms      | [S2,MB0,B]  87-16-104ms    | [S2,MB2,F]  106-7-113ms    | [S2,MB1,B]  148-20-168ms   | [S2,MB3,F]  171-7-179ms    | [S2,MB2,B]  213-19-233ms   | [S2,MB4,F]  236-7-243ms    | [S2,MB3,B]  278-19-298ms   | [S2,MB5,F]  301-7-308ms    | [S2,MB4,B]  343-19-363ms   | [S2,MB6,F]  366-7-373ms    | [S2,MB5,B]  409-19-429ms   | [S2,MB7,F]  433-7-440ms    | [S2,MB6,B]  476-19-496ms   | [S2,MB7,B]  541-19-561ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  48-34-83ms     | [S3,MB1,F]  85-11-97ms     | [S3,MB1,B]  105-40-146ms   | [S3,MB2,F]  146-13-160ms   | [S3,MB2,B]  166-42-208ms   | [S3,MB3,F]  211-13-225ms   | [S3,MB3,B]  230-42-273ms   | [S3,MB4,F]  276-14-291ms   | [S3,MB4,B]  296-42-338ms   | [S3,MB5,F]  341-15-356ms   | [S3,MB5,B]  362-42-404ms   | [S3,MB6,F]  408-14-422ms   | [S3,MB6,B]  428-42-470ms   | [S3,MB7,F]  474-14-489ms   | [S3,MB7,B]  494-42-537ms  
[rank1]:2025-12-27 03:27:54,678 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p70_42_dm1/frozen_params_histogram/251227_0327_rank1_stage1.svg
[rank1]:	> Counts Sum: 1944, Total Sum: 3375 (57.60%), Ratio(%) per element: [84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 36.0, 36.0, 36.0, 36.0, 36.0, 36.0, 36.0, 36.0, 36.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-12-27 03:27:54,678 - Destroying the purge thread.
[rank3]:2025-12-27 03:27:54,732 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p70_42_dm1/pipeline_schedule/251227_0327_thry_final800_rank3.svg
[rank3]:			> Batch Time: 334.12 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-10-10ms      | [S0,MB1,F]  10-10-20ms     | [S0,MB2,F]  20-10-30ms     | [S0,MB3,F]  30-10-40ms     | [S0,MB0,B]  101-20-121ms   | [S0,MB4,F]  121-10-131ms   | [S0,MB1,B]  131-20-151ms   | [S0,MB5,F]  151-10-161ms   | [S0,MB2,B]  161-20-182ms   | [S0,MB6,F]  182-10-192ms   | [S0,MB3,B]  192-20-212ms   | [S0,MB7,F]  212-10-222ms   | [S0,MB4,B]  222-20-242ms   | [S0,MB5,B]  253-20-273ms   | [S0,MB6,B]  283-20-303ms   | [S0,MB7,B]  313-20-334ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  10-10-20ms     | [S1,MB1,F]  20-10-30ms     | [S1,MB2,F]  30-10-40ms     | [S1,MB0,B]  80-20-101ms    | [S1,MB3,F]  101-10-111ms   | [S1,MB1,B]  111-20-131ms   | [S1,MB4,F]  131-10-141ms   | [S1,MB2,B]  141-20-161ms   | [S1,MB5,F]  161-10-172ms   | [S1,MB3,B]  172-20-192ms   | [S1,MB6,F]  192-10-202ms   | [S1,MB4,B]  202-20-222ms   | [S1,MB7,F]  222-10-232ms   | [S1,MB5,B]  232-20-253ms   | [S1,MB6,B]  263-20-283ms   | [S1,MB7,B]  293-20-313ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-10-30ms     | [S2,MB1,F]  30-10-40ms     | [S2,MB0,B]  60-20-80ms     | [S2,MB2,F]  80-10-91ms     | [S2,MB1,B]  91-20-111ms    | [S2,MB3,F]  111-10-121ms   | [S2,MB2,B]  121-20-141ms   | [S2,MB4,F]  141-10-151ms   | [S2,MB3,B]  151-20-172ms   | [S2,MB5,F]  172-10-182ms   | [S2,MB4,B]  182-20-202ms   | [S2,MB6,F]  202-10-212ms   | [S2,MB5,B]  212-20-232ms   | [S2,MB7,F]  232-10-242ms   | [S2,MB6,B]  242-20-263ms   | [S2,MB7,B]  273-20-293ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  30-10-40ms     | [S3,MB0,B]  40-20-60ms     | [S3,MB1,F]  60-10-70ms     | [S3,MB1,B]  70-20-91ms     | [S3,MB2,F]  91-10-101ms    | [S3,MB2,B]  101-20-121ms   | [S3,MB3,F]  121-10-131ms   | [S3,MB3,B]  131-20-151ms   | [S3,MB4,F]  151-10-161ms   | [S3,MB4,B]  161-20-182ms   | [S3,MB5,F]  182-10-192ms   | [S3,MB5,B]  192-20-212ms   | [S3,MB6,F]  212-10-222ms   | [S3,MB6,B]  222-20-242ms   | [S3,MB7,F]  242-10-253ms   | [S3,MB7,B]  253-20-273ms  
[rank3]:2025-12-27 03:27:54,781 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p70_42_dm1/frozen_ratio_history/rank3/251227_0327_stage3_final800.svg
[rank3]:2025-12-27 03:27:54,908 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p70_42_dm1/frozen_params_histogram/251227_0327_rank3_stage3.svg
[rank3]:	> Counts Sum: 666, Total Sum: 2175 (30.62%), Ratio(%) per element: [49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-27 03:27:54,909 - Destroying the purge thread.
[rank1]:2025-12-27 03:27:55,057 - Process group destroyed
[rank2]:2025-12-27 03:27:55,046 - Process group destroyed
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading history steps 16-16, summary, console lines 368-383
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–ˆâ–‡â–„â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–ˆâ–‡â–„â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 4.53415
[rank3]:wandb:               final/avg_loss 0.25078
[rank3]:wandb:             final/avg_mfu(%) 16.62924
[rank3]:wandb:             final/avg_tflops 56.49683
[rank3]:wandb:    final/avg_throughput(tps) 7226.93179
[rank3]:wandb:              final/grad_norm 0.10417
[rank3]:wandb:               final/max_loss 0.25078
[rank3]:wandb:                    grad_norm 0.10417
[rank3]:wandb: loss_metrics/global_avg_loss 0.25078
[rank3]:wandb: loss_metrics/global_max_loss 0.25078
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1226_1F1B_auto_p70_42_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/yg2b53gb
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1226_1F1B_auto_p70_42_dm1/20251227-0223/wandb/run-20251227_022337-yg2b53gb/logs
[rank3]:2025-12-27 03:27:56,531 - Process group destroyed
[rank0]:2025-12-27 03:27:56,671 - Training completed
[rank0]:2025-12-27 03:27:56,671 - Destroying the purge thread.
[rank0]:2025-12-27 03:27:57,071 - Process group destroyed
[rank0]:Stage 0: Modules to keep: {'layers.3', 'layers.0', 'tok_embeddings', 'layers.2', 'layers.1'}
[rank1]:Stage 1: Modules to keep: {'layers.5', 'layers.4', 'layers.8', 'layers.7', 'layers.6'}
[rank2]:Stage 2: Modules to keep: {'layers.9', 'layers.12', 'layers.11', 'layers.10'}
[rank3]:Stage 3: Modules to keep: {'output', 'layers.13', 'layers.15', 'layers.14', 'norm'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1116_autofreeze/config_1226.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "AutoFreeze configuration experiment on different PERCENTILE values."
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1226_1F1B_auto_p70_42_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1226_1F1B_auto_p70_42_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1226_1F1B_auto_p70_42_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1226_1F1B_auto_p70_42_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1226_1F1B_auto_p70_42_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1226_1F1B_auto_p70_42_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 42
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: 1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1226_1F1B_auto_p70_42_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1226_1F1B_auto_p70_42_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: auto
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.05
[rank3]:		- percentile: 70
[rank3]:
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
