
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 12. 26. (ê¸ˆ) 23:12:21 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 1,2,3,4
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1116_autofreeze/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1116_autofreeze/1226_1F1B_auto_p40_42.log
âœ”ï¸AutoFreeze configuration experiment on different PERCENTILE values.
âœ”ï¸Running with autofreeze (percentile=40) x 1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1116_autofreeze/config_1226.toml --job.description="AutoFreeze configuration experiment on different PERCENTILE values." --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=auto --freezing.percentile=40
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank2]:2025-12-26 23:12:27,599 - Starting job: "AutoFreeze configuration experiment on different PERCENTILE values."
[rank3]:2025-12-26 23:12:27,599 - Starting job: "AutoFreeze configuration experiment on different PERCENTILE values."
[rank0]:2025-12-26 23:12:27,710 - Starting job: "AutoFreeze configuration experiment on different PERCENTILE values."
[rank1]:2025-12-26 23:12:27,770 - Starting job: "AutoFreeze configuration experiment on different PERCENTILE values."
[rank2]:2025-12-26 23:12:27,922 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-12-26 23:12:27,924 - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-12-26 23:12:27,936 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-12-26 23:12:27,938 - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-12-26 23:12:28,113 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-12-26 23:12:28,116 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-26 23:12:28,121 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-12-26 23:12:28,123 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-26 23:12:28,126 - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-12-26 23:12:28,127 - Loading tokenizer from tokenizer.json
[rank0]:2025-12-26 23:12:28,527 - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank1]:2025-12-26 23:12:31,508 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-12-26 23:12:31,548 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-26 23:12:31,576 - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-12-26 23:12:31,576 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank2]:2025-12-26 23:12:31,676 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-12-26 23:12:31,717 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-26 23:12:31,638 - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank2]:2025-12-26 23:12:31,745 - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-12-26 23:12:31,745 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2025-12-26 23:12:31,784 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-26 23:12:31,784 - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-12-26 23:12:31,785 - CUDA memory usage for model: 1.13GiB(2.39%)
[rank0]:2025-12-26 23:12:31,790 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-12-26 23:12:31,831 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-26 23:12:31,832 - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-12-26 23:12:31,858 - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-12-26 23:12:31,859 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank2]:2025-12-26 23:12:31,930 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-26 23:12:31,930 - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-12-26 23:12:31,931 - CUDA memory usage for model: 0.92GiB(1.94%)
[rank0]:2025-12-26 23:12:32,069 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-26 23:12:32,070 - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-12-26 23:12:32,070 - CUDA memory usage for model: 1.90GiB(3.99%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run sa23o3p1
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1226_1F1B_auto_p40_42_dm1/20251226-2312/wandb/run-20251226_231232-sa23o3p1
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1226_1F1B_auto_p40_42_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/sa23o3p1
[rank3]:2025-12-26 23:12:33,854 - WandB logging enabled
[rank3]:2025-12-26 23:12:33,854 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-12-26 23:12:33,891 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-26 23:12:33,919 - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-12-26 23:12:33,919 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank2]:2025-12-26 23:12:34,121 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-26 23:12:34,121 - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1226_1F1B_auto_p40_42_dm1
[rank0]:2025-12-26 23:12:34,122 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-26 23:12:34,122 - Trainer is initialized with local batch size 16, global batch size 128, gradient accumulation steps 8, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2025-12-26 23:12:34,122 - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank3]:2025-12-26 23:12:34,104 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-26 23:12:34,105 - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-12-26 23:12:34,105 - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2025-12-26 23:12:34,121 - Mixed precision training with TP or PP is handled by autocast
[rank1]:2025-12-26 23:12:34,122 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-26 23:12:36,709 - [GC] GC collection for checkpoint loading. 0.01 seconds
[rank0]:2025-12-26 23:12:36,709 - Finished loading the checkpoint in 2.59 seconds.
[rank0]:2025-12-26 23:12:36,709 - Training starts at step 1
[rank2]:2025-12-26 23:12:42,409 -  step:  1  loss: -8.0000  grad_norm: 116.5363  memory:  5.20GiB(10.94%)  tps: 3,065  tflops: 23.96  mfu: 7.68%
[rank2]:2025-12-26 23:12:42,409 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-12-26 23:12:42,412 -  step:  1  loss: -8.0000  grad_norm: 116.5363  memory:  7.10GiB(14.94%)  tps: 3,017  tflops: 23.58  mfu: 7.56%
[rank1]:2025-12-26 23:12:42,412 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-12-26 23:12:42,420 -  step:  1  loss: 10.6088  grad_norm: 116.5363  memory: 12.97GiB(27.31%)  tps: 3,843  tflops: 30.05  mfu: 9.63%
[rank3]:2025-12-26 23:12:42,420 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-26 23:12:42,448 -  step:  1  loss: -8.0000  grad_norm: 116.5363  memory:  9.62GiB(20.24%)  tps: 3,086  tflops: 24.13  mfu: 7.73%
[rank0]:2025-12-26 23:12:42,449 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-12-26 23:14:44,672 - Avg. fwd time: 13.3806 / Avg. bwd time: 42.4382 / Avg. batch time: 510.1229 (ms) / GPU bubble ratio: 12.46%
[rank2]:2025-12-26 23:14:44,697 - Avg. fwd time: 7.3639 / Avg. bwd time: 19.9319 / Avg. batch time: 543.0249 (ms) / GPU bubble ratio: 59.79%
[rank1]:2025-12-26 23:14:44,726 - Avg. fwd time: 9.2452 / Avg. bwd time: 24.7399 / Avg. batch time: 582.9685 (ms) / GPU bubble ratio: 53.36%
[rank0]:2025-12-26 23:14:44,756 - Avg. fwd time: 7.6515 / Avg. bwd time: 24.9191 / Avg. batch time: 621.6283 (ms) / GPU bubble ratio: 58.08%
[rank0]:2025-12-26 23:16:48,034 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-26 23:16:53,049 - Avg. fwd time: 13.5438 / Avg. bwd time: 42.6394 / Avg. batch time: 512.9480 (ms) / GPU bubble ratio: 12.38%
[rank2]:2025-12-26 23:16:53,074 - Avg. fwd time: 7.3646 / Avg. bwd time: 19.9791 / Avg. batch time: 545.4949 (ms) / GPU bubble ratio: 59.90%
[rank1]:2025-12-26 23:16:53,103 - Avg. fwd time: 9.2518 / Avg. bwd time: 24.7973 / Avg. batch time: 585.0774 (ms) / GPU bubble ratio: 53.44%
[rank1]:2025-12-26 23:16:53,158 -  step: 50  loss: -8.0000  grad_norm: 12.5272  memory:  9.50GiB(19.99%)  tps: 6,403  tflops: 50.06  mfu: 16.04%
[rank0]:2025-12-26 23:16:53,133 - Avg. fwd time: 7.6474 / Avg. bwd time: 24.9701 / Avg. batch time: 623.4036 (ms) / GPU bubble ratio: 58.14%
[rank0]:2025-12-26 23:16:53,169 -  step: 50  loss: -8.0000  grad_norm: 12.5272  memory: 13.42GiB(28.26%)  tps: 6,404  tflops: 50.06  mfu: 16.05%
[rank3]:2025-12-26 23:16:53,166 -  step: 50  loss:  9.9075  grad_norm: 12.5272  memory: 16.39GiB(34.50%)  tps: 6,403  tflops: 50.06  mfu: 16.04%
[rank2]:2025-12-26 23:16:53,155 -  step: 50  loss: -8.0000  grad_norm: 12.5272  memory:  6.98GiB(14.69%)  tps: 6,403  tflops: 50.06  mfu: 16.04%
[rank3]:2025-12-26 23:17:39,544 - Freezing Ratio: [Stage3] 0.00, Threshold: 0.0000e+00
[rank2]:2025-12-26 23:17:39,532 - Freezing Ratio: [Stage2] 0.00, Threshold: 0.0000e+00
[rank1]:2025-12-26 23:17:39,537 - Freezing Ratio: [Stage1] 0.00, Threshold: 0.0000e+00
[rank0]:2025-12-26 23:17:39,548 - Freezing Ratio: [Stage0] 0.00, Threshold: 0.0000e+00
[rank1]:2025-12-26 23:18:31,071 - Freezing Ratio: [Stage1] 0.00, Threshold: 1.5732e+00
[rank0]:2025-12-26 23:18:31,084 - Freezing Ratio: [Stage0] 0.00, Threshold: 2.6304e+00
[rank3]:2025-12-26 23:18:31,078 - Freezing Ratio: [Stage3] 0.31, Threshold: 2.0924e+00
[rank2]:2025-12-26 23:18:31,067 - Freezing Ratio: [Stage2] 0.00, Threshold: 8.7745e-01
[rank3]:2025-12-26 23:19:00,635 - Avg. fwd time: 13.6244 / Avg. bwd time: 42.4810 / Avg. batch time: 512.2886 (ms) / GPU bubble ratio: 12.38%
[rank2]:2025-12-26 23:19:00,661 - Avg. fwd time: 7.3607 / Avg. bwd time: 20.0099 / Avg. batch time: 544.7335 (ms) / GPU bubble ratio: 59.80%
[rank1]:2025-12-26 23:19:00,691 - Avg. fwd time: 9.2561 / Avg. bwd time: 24.8301 / Avg. batch time: 584.2152 (ms) / GPU bubble ratio: 53.32%
[rank0]:2025-12-26 23:19:00,721 - Avg. fwd time: 7.6534 / Avg. bwd time: 24.9990 / Avg. batch time: 622.4667 (ms) / GPU bubble ratio: 58.03%
[rank2]:2025-12-26 23:19:20,394 - Freezing Ratio: [Stage2] 0.25, Threshold: 6.7819e-01
[rank1]:2025-12-26 23:19:20,398 - Freezing Ratio: [Stage1] 0.00, Threshold: 7.6578e-01
[rank0]:2025-12-26 23:19:20,410 - Freezing Ratio: [Stage0] 0.24, Threshold: 1.2486e+00
[rank3]:2025-12-26 23:19:20,402 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.7871e+00
[rank2]:2025-12-26 23:20:11,345 - Freezing Ratio: [Stage2] 0.00, Threshold: 5.7835e+00
[rank0]:2025-12-26 23:20:11,361 - Freezing Ratio: [Stage0] 0.00, Threshold: 7.6313e+00
[rank1]:2025-12-26 23:20:11,353 - Freezing Ratio: [Stage1] 0.00, Threshold: 5.3086e+00
[rank3]:2025-12-26 23:20:11,361 - Freezing Ratio: [Stage3] 0.31, Threshold: 4.2293e+00
[rank0]:2025-12-26 23:21:00,415 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-26 23:21:00,445 - Freezing Ratio: [Stage0] 0.24, Threshold: 3.1970e+00
[rank2]:2025-12-26 23:21:00,429 - Freezing Ratio: [Stage2] 0.50, Threshold: 1.7481e+00
[rank1]:2025-12-26 23:21:00,433 - Freezing Ratio: [Stage1] 0.00, Threshold: 1.3878e+00
[rank3]:2025-12-26 23:21:00,437 - Freezing Ratio: [Stage3] 0.00, Threshold: 2.9685e+00
[rank2]:2025-12-26 23:21:05,360 - Avg. fwd time: 7.3988 / Avg. bwd time: 19.6800 / Avg. batch time: 541.1767 (ms) / GPU bubble ratio: 59.97%
[rank1]:2025-12-26 23:21:05,390 - Avg. fwd time: 9.2508 / Avg. bwd time: 24.8475 / Avg. batch time: 580.6087 (ms) / GPU bubble ratio: 53.02%
[rank3]:2025-12-26 23:21:05,340 - Avg. fwd time: 13.6104 / Avg. bwd time: 42.1036 / Avg. batch time: 509.1437 (ms) / GPU bubble ratio: 12.46%
[rank0]:2025-12-26 23:21:05,418 - Avg. fwd time: 7.6914 / Avg. bwd time: 24.6973 / Avg. batch time: 618.5056 (ms) / GPU bubble ratio: 58.11%
[rank0]:2025-12-26 23:21:05,450 -  step: 100  loss: -8.0000  grad_norm:  8.2861  memory: 13.42GiB(28.26%)  tps: 6,494  tflops: 50.77  mfu: 16.27%
[rank2]:2025-12-26 23:21:05,432 -  step: 100  loss: -8.0000  grad_norm:  8.2861  memory:  6.98GiB(14.69%)  tps: 6,494  tflops: 50.77  mfu: 16.27%
[rank1]:2025-12-26 23:21:05,442 -  step: 100  loss: -8.0000  grad_norm:  8.2861  memory:  9.50GiB(19.99%)  tps: 6,494  tflops: 50.77  mfu: 16.27%
[rank3]:2025-12-26 23:21:05,451 -  step: 100  loss:  8.3622  grad_norm:  8.2861  memory: 16.39GiB(34.50%)  tps: 6,494  tflops: 50.77  mfu: 16.27%
[rank0]:2025-12-26 23:21:05,521 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p40_42_dm1/frozen_ratio_history/rank0/251226_2321_stage0_step100.svg
[rank2]:2025-12-26 23:21:05,520 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p40_42_dm1/frozen_ratio_history/rank2/251226_2321_stage2_step100.svg
[rank1]:2025-12-26 23:21:05,520 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p40_42_dm1/frozen_ratio_history/rank1/251226_2321_stage1_step100.svg
[rank3]:2025-12-26 23:21:05,619 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p40_42_dm1/pipeline_schedule/251226_2321_step100_rank3.svg
[rank3]:			> Batch Time: 603.62 ms, GPU Bubble Ratio: 56.38%, 54.64%, 63.52%, 29.45%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-7-33ms      | [S0,MB0,B]  144-25-170ms   | [S0,MB4,F]  170-7-177ms    | [S0,MB1,B]  202-25-227ms   | [S0,MB5,F]  227-7-234ms    | [S0,MB2,B]  263-25-288ms   | [S0,MB6,F]  288-7-295ms    | [S0,MB3,B]  326-25-351ms   | [S0,MB7,F]  351-7-358ms    | [S0,MB4,B]  390-25-415ms   | [S0,MB5,B]  452-25-477ms   | [S0,MB6,B]  514-25-539ms   | [S0,MB7,B]  578-25-603ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-8-32ms      | [S1,MB2,F]  35-8-44ms      | [S1,MB0,B]  114-25-139ms   | [S1,MB3,F]  143-8-152ms    | [S1,MB1,B]  172-25-197ms   | [S1,MB4,F]  200-9-209ms    | [S1,MB2,B]  233-25-258ms   | [S1,MB5,F]  261-9-271ms    | [S1,MB3,B]  296-25-321ms   | [S1,MB6,F]  325-8-334ms    | [S1,MB4,B]  360-24-385ms   | [S1,MB7,F]  388-8-397ms    | [S1,MB5,B]  424-24-449ms   | [S1,MB6,B]  486-24-511ms   | [S1,MB7,B]  550-24-575ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-7-39ms      | [S2,MB0,B]  89-20-110ms    | [S2,MB2,F]  113-7-120ms    | [S2,MB1,B]  147-20-167ms   | [S2,MB3,F]  170-7-177ms    | [S2,MB2,B]  209-20-229ms   | [S2,MB4,F]  231-7-238ms    | [S2,MB3,B]  272-20-292ms   | [S2,MB5,F]  295-7-302ms    | [S2,MB4,B]  335-20-356ms   | [S2,MB6,F]  358-7-365ms    | [S2,MB5,B]  399-20-419ms   | [S2,MB7,F]  422-7-429ms    | [S2,MB6,B]  463-20-483ms   | [S2,MB7,B]  526-20-546ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  48-37-85ms     | [S3,MB1,F]  88-11-99ms     | [S3,MB1,B]  105-38-143ms   | [S3,MB2,F]  146-12-158ms   | [S3,MB2,B]  165-39-205ms   | [S3,MB3,F]  207-13-221ms   | [S3,MB3,B]  227-41-268ms   | [S3,MB4,F]  270-13-284ms   | [S3,MB4,B]  290-41-332ms   | [S3,MB5,F]  333-13-347ms   | [S3,MB5,B]  354-40-395ms   | [S3,MB6,F]  397-14-412ms   | [S3,MB6,B]  418-40-458ms   | [S3,MB7,F]  461-14-475ms   | [S3,MB7,B]  481-40-522ms  
[rank1]:2025-12-26 23:21:05,670 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p40_42_dm1/frozen_params_histogram/251226_2321_rank1_stage1.svg
[rank1]:	> Counts Sum: 0, Total Sum: 225 (0.00%), Ratio(%) per element: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-26 23:21:05,664 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p40_42_dm1/frozen_ratio_history/rank3/251226_2321_stage3_step100.svg
[rank0]:2025-12-26 23:21:05,677 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p40_42_dm1/frozen_params_histogram/251226_2321_rank0_stage0.svg
[rank0]:	> Counts Sum: 18, Total Sum: 185 (9.73%), Ratio(%) per element: [0.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-12-26 23:21:05,677 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p40_42_dm1/frozen_params_histogram/251226_2321_rank2_stage2.svg
[rank2]:	> Counts Sum: 27, Total Sum: 180 (15.00%), Ratio(%) per element: [40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-26 23:21:05,800 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p40_42_dm1/frozen_params_histogram/251226_2321_rank3_stage3.svg
[rank3]:	> Counts Sum: 18, Total Sum: 145 (12.41%), Ratio(%) per element: [40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-12-26 23:21:51,304 - Freezing Ratio: [Stage0] 0.00, Threshold: 1.3504e+00
[rank2]:2025-12-26 23:21:51,285 - Freezing Ratio: [Stage2] 0.00, Threshold: 1.8785e+00
[rank1]:2025-12-26 23:21:51,297 - Freezing Ratio: [Stage1] 0.40, Threshold: 1.0341e+00
[rank3]:2025-12-26 23:21:51,304 - Freezing Ratio: [Stage3] 0.31, Threshold: 1.2628e+00
[rank1]:2025-12-26 23:22:40,201 - Freezing Ratio: [Stage1] 0.00, Threshold: 3.0725e+00
[rank3]:2025-12-26 23:22:40,212 - Freezing Ratio: [Stage3] 0.00, Threshold: 4.3630e+00
[rank0]:2025-12-26 23:22:40,220 - Freezing Ratio: [Stage0] 0.24, Threshold: 2.2941e+00
[rank2]:2025-12-26 23:22:40,205 - Freezing Ratio: [Stage2] 0.50, Threshold: 6.9532e-01
[rank2]:2025-12-26 23:23:10,426 - Avg. fwd time: 7.4745 / Avg. bwd time: 19.0675 / Avg. batch time: 539.7679 (ms) / GPU bubble ratio: 60.66%
[rank1]:2025-12-26 23:23:10,456 - Avg. fwd time: 9.3015 / Avg. bwd time: 24.4037 / Avg. batch time: 578.7154 (ms) / GPU bubble ratio: 53.41%
[rank3]:2025-12-26 23:23:10,405 - Avg. fwd time: 13.6170 / Avg. bwd time: 41.9954 / Avg. batch time: 508.3132 (ms) / GPU bubble ratio: 12.48%
[rank0]:2025-12-26 23:23:10,484 - Avg. fwd time: 7.7300 / Avg. bwd time: 24.4244 / Avg. batch time: 616.3077 (ms) / GPU bubble ratio: 58.26%
[rank2]:2025-12-26 23:23:30,960 - Freezing Ratio: [Stage2] 0.00, Threshold: 6.4791e+00
[rank1]:2025-12-26 23:23:30,972 - Freezing Ratio: [Stage1] 0.40, Threshold: 2.0817e+00
[rank3]:2025-12-26 23:23:30,979 - Freezing Ratio: [Stage3] 0.31, Threshold: 4.5623e+00
[rank0]:2025-12-26 23:23:30,980 - Freezing Ratio: [Stage0] 0.00, Threshold: 4.7969e+00
[rank2]:2025-12-26 23:24:19,810 - Freezing Ratio: [Stage2] 0.50, Threshold: 4.1986e-01
[rank1]:2025-12-26 23:24:19,806 - Freezing Ratio: [Stage1] 0.00, Threshold: 2.6861e+00
[rank3]:2025-12-26 23:24:19,818 - Freezing Ratio: [Stage3] 0.00, Threshold: 3.1384e+00
[rank0]:2025-12-26 23:24:19,826 - Freezing Ratio: [Stage0] 0.24, Threshold: 2.7510e+00
[rank1]:2025-12-26 23:25:10,420 - Freezing Ratio: [Stage1] 0.40, Threshold: 5.3496e-01
[rank3]:2025-12-26 23:25:10,428 - Freezing Ratio: [Stage3] 0.31, Threshold: 1.7914e+00
[rank0]:2025-12-26 23:25:10,410 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-26 23:25:10,427 - Freezing Ratio: [Stage0] 0.00, Threshold: 9.5220e-01
[rank2]:2025-12-26 23:25:10,408 - Freezing Ratio: [Stage2] 0.00, Threshold: 1.2766e+00
[rank3]:2025-12-26 23:25:15,223 - Avg. fwd time: 13.6299 / Avg. bwd time: 41.9107 / Avg. batch time: 507.7310 (ms) / GPU bubble ratio: 12.49%
[rank2]:2025-12-26 23:25:15,249 - Avg. fwd time: 7.5196 / Avg. bwd time: 18.7015 / Avg. batch time: 538.7720 (ms) / GPU bubble ratio: 61.07%
[rank1]:2025-12-26 23:25:15,274 - Avg. fwd time: 9.3399 / Avg. bwd time: 24.0738 / Avg. batch time: 577.3632 (ms) / GPU bubble ratio: 53.70%
[rank1]:2025-12-26 23:25:15,323 -  step: 150  loss: -8.0000  grad_norm: 11.4461  memory:  9.50GiB(19.99%)  tps: 6,557  tflops: 51.26  mfu: 16.43%
[rank3]:2025-12-26 23:25:15,336 -  step: 150  loss:  3.6607  grad_norm: 11.4461  memory: 16.39GiB(34.50%)  tps: 6,557  tflops: 51.26  mfu: 16.43%
[rank0]:2025-12-26 23:25:15,305 - Avg. fwd time: 7.7541 / Avg. bwd time: 24.2643 / Avg. batch time: 614.7784 (ms) / GPU bubble ratio: 58.34%
[rank0]:2025-12-26 23:25:15,341 -  step: 150  loss: -8.0000  grad_norm: 11.4461  memory: 13.42GiB(28.26%)  tps: 6,556  tflops: 51.26  mfu: 16.43%
[rank2]:2025-12-26 23:25:15,326 -  step: 150  loss: -8.0000  grad_norm: 11.4461  memory:  6.98GiB(14.69%)  tps: 6,556  tflops: 51.25  mfu: 16.43%
[rank2]:2025-12-26 23:25:59,347 - Freezing Ratio: [Stage2] 0.50, Threshold: 5.1670e-01
[rank1]:2025-12-26 23:25:59,343 - Freezing Ratio: [Stage1] 0.00, Threshold: 2.9497e+00
[rank3]:2025-12-26 23:25:59,355 - Freezing Ratio: [Stage3] 0.00, Threshold: 3.2926e+00
[rank0]:2025-12-26 23:25:59,364 - Freezing Ratio: [Stage0] 0.24, Threshold: 2.5128e+00
[rank2]:2025-12-26 23:26:50,102 - Freezing Ratio: [Stage2] 0.50, Threshold: 1.3790e+01
[rank1]:2025-12-26 23:26:50,114 - Freezing Ratio: [Stage1] 0.40, Threshold: 9.9039e+00
[rank3]:2025-12-26 23:26:50,121 - Freezing Ratio: [Stage3] 0.31, Threshold: 8.3180e+00
[rank0]:2025-12-26 23:26:50,121 - Freezing Ratio: [Stage0] 0.49, Threshold: 2.4023e+01
[rank3]:2025-12-26 23:27:18,806 - Avg. fwd time: 13.6442 / Avg. bwd time: 41.7753 / Avg. batch time: 506.7521 (ms) / GPU bubble ratio: 12.51%
[rank2]:2025-12-26 23:27:18,827 - Avg. fwd time: 7.5604 / Avg. bwd time: 18.3756 / Avg. batch time: 537.4335 (ms) / GPU bubble ratio: 61.39%
[rank1]:2025-12-26 23:27:18,853 - Avg. fwd time: 9.3817 / Avg. bwd time: 23.7111 / Avg. batch time: 575.6407 (ms) / GPU bubble ratio: 54.01%
[rank0]:2025-12-26 23:27:18,879 - Avg. fwd time: 7.7871 / Avg. bwd time: 24.0226 / Avg. batch time: 612.8031 (ms) / GPU bubble ratio: 58.47%
[rank0]:2025-12-26 23:27:38,175 - Freezing Ratio: [Stage0] 0.24, Threshold: 3.3837e+00
[rank2]:2025-12-26 23:27:38,159 - Freezing Ratio: [Stage2] 0.50, Threshold: 3.5750e+00
[rank1]:2025-12-26 23:27:38,163 - Freezing Ratio: [Stage1] 0.00, Threshold: 3.8531e+00
[rank3]:2025-12-26 23:27:38,175 - Freezing Ratio: [Stage3] 0.00, Threshold: 3.4114e+00
[rank0]:2025-12-26 23:28:28,927 - Freezing Ratio: [Stage0] 0.49, Threshold: 1.4869e+00
[rank1]:2025-12-26 23:28:28,920 - Freezing Ratio: [Stage1] 0.40, Threshold: 1.1885e+00
[rank2]:2025-12-26 23:28:28,908 - Freezing Ratio: [Stage2] 0.75, Threshold: 2.4538e+00
[rank3]:2025-12-26 23:28:28,928 - Freezing Ratio: [Stage3] 0.31, Threshold: 2.6308e+00
[rank1]:2025-12-26 23:29:16,613 - Freezing Ratio: [Stage1] 0.00, Threshold: 1.5515e+00
[rank2]:2025-12-26 23:29:16,605 - Freezing Ratio: [Stage2] 0.50, Threshold: 2.2015e+00
[rank3]:2025-12-26 23:29:16,625 - Freezing Ratio: [Stage3] 0.00, Threshold: 2.2096e+00
[rank0]:2025-12-26 23:29:16,603 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-26 23:29:16,624 - Freezing Ratio: [Stage0] 0.24, Threshold: 1.8072e+00
[rank1]:2025-12-26 23:29:21,724 - Avg. fwd time: 9.4088 / Avg. bwd time: 23.4740 / Avg. batch time: 574.2828 (ms) / GPU bubble ratio: 54.19%
[rank2]:2025-12-26 23:29:21,693 - Avg. fwd time: 7.6438 / Avg. bwd time: 17.7341 / Avg. batch time: 536.3286 (ms) / GPU bubble ratio: 62.15%
[rank3]:2025-12-26 23:29:21,671 - Avg. fwd time: 13.6712 / Avg. bwd time: 41.6945 / Avg. batch time: 506.3160 (ms) / GPU bubble ratio: 12.52%
[rank0]:2025-12-26 23:29:21,753 - Avg. fwd time: 7.8412 / Avg. bwd time: 23.6013 / Avg. batch time: 611.0170 (ms) / GPU bubble ratio: 58.83%
[rank0]:2025-12-26 23:29:21,785 -  step: 200  loss: -8.0000  grad_norm:  8.9594  memory: 13.42GiB(28.26%)  tps: 6,648  tflops: 51.97  mfu: 16.66%
[rank1]:2025-12-26 23:29:21,778 -  step: 200  loss: -8.0000  grad_norm:  8.9594  memory:  9.50GiB(19.99%)  tps: 6,648  tflops: 51.97  mfu: 16.66%
[rank2]:2025-12-26 23:29:21,767 -  step: 200  loss: -8.0000  grad_norm:  8.9594  memory:  6.98GiB(14.69%)  tps: 6,648  tflops: 51.97  mfu: 16.66%
[rank2]:2025-12-26 23:29:21,843 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p40_42_dm1/frozen_ratio_history/rank2/251226_2329_stage2_step200.svg
[rank3]:2025-12-26 23:29:21,787 -  step: 200  loss:  1.1134  grad_norm:  8.9594  memory: 16.39GiB(34.50%)  tps: 6,648  tflops: 51.97  mfu: 16.66%
[rank0]:2025-12-26 23:29:21,838 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p40_42_dm1/frozen_ratio_history/rank0/251226_2329_stage0_step200.svg
[rank1]:2025-12-26 23:29:21,843 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p40_42_dm1/frozen_ratio_history/rank1/251226_2329_stage1_step200.svg
[rank3]:2025-12-26 23:29:21,937 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p40_42_dm1/pipeline_schedule/251226_2329_step200_rank3.svg
[rank3]:			> Batch Time: 582.98 ms, GPU Bubble Ratio: 61.79%, 59.90%, 72.55%, 26.70%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-8-18ms       | [S0,MB2,F]  18-8-26ms      | [S0,MB3,F]  26-8-35ms      | [S0,MB0,B]  131-19-150ms   | [S0,MB4,F]  150-7-158ms    | [S0,MB1,B]  188-19-208ms   | [S0,MB5,F]  208-7-215ms    | [S0,MB2,B]  251-19-270ms   | [S0,MB6,F]  270-7-278ms    | [S0,MB3,B]  314-19-334ms   | [S0,MB7,F]  334-7-341ms    | [S0,MB4,B]  378-19-398ms   | [S0,MB5,B]  440-19-459ms   | [S0,MB6,B]  502-19-521ms   | [S0,MB7,B]  563-19-582ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-9-33ms      | [S1,MB2,F]  36-9-46ms      | [S1,MB0,B]  106-19-125ms   | [S1,MB3,F]  129-9-139ms    | [S1,MB1,B]  164-19-183ms   | [S1,MB4,F]  187-9-196ms    | [S1,MB2,B]  226-19-246ms   | [S1,MB5,F]  249-9-259ms    | [S1,MB3,B]  290-19-309ms   | [S1,MB6,F]  313-9-322ms    | [S1,MB4,B]  354-19-373ms   | [S1,MB7,F]  377-9-386ms    | [S1,MB5,B]  417-19-437ms   | [S1,MB6,B]  479-19-498ms   | [S1,MB7,B]  541-19-560ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  33-8-41ms      | [S2,MB0,B]  89-11-101ms    | [S2,MB2,F]  104-8-113ms    | [S2,MB1,B]  147-11-159ms   | [S2,MB3,F]  162-8-171ms    | [S2,MB2,B]  210-11-221ms   | [S2,MB4,F]  225-8-233ms    | [S2,MB3,B]  273-11-285ms   | [S2,MB5,F]  288-8-297ms    | [S2,MB4,B]  337-11-349ms   | [S2,MB6,F]  352-8-361ms    | [S2,MB5,B]  401-11-412ms   | [S2,MB7,F]  416-8-424ms    | [S2,MB6,B]  464-11-475ms   | [S2,MB7,B]  526-11-537ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  48-37-85ms     | [S3,MB1,F]  88-11-99ms     | [S3,MB1,B]  105-38-143ms   | [S3,MB2,F]  146-13-160ms   | [S3,MB2,B]  166-39-206ms   | [S3,MB3,F]  208-14-222ms   | [S3,MB3,B]  229-40-270ms   | [S3,MB4,F]  272-14-286ms   | [S3,MB4,B]  293-41-334ms   | [S3,MB5,F]  336-13-349ms   | [S3,MB5,B]  356-40-397ms   | [S3,MB6,F]  399-13-413ms   | [S3,MB6,B]  419-40-459ms   | [S3,MB7,F]  462-15-478ms   | [S3,MB7,B]  483-40-523ms  
[rank0]:2025-12-26 23:29:21,991 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p40_42_dm1/frozen_params_histogram/251226_2329_rank0_stage0.svg
[rank0]:	> Counts Sum: 99, Total Sum: 555 (17.84%), Ratio(%) per element: [0.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 13.33, 13.33, 13.33, 13.33, 13.33, 13.33, 13.33, 13.33, 13.33, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-12-26 23:29:21,988 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p40_42_dm1/frozen_params_histogram/251226_2329_rank1_stage1.svg
[rank1]:	> Counts Sum: 90, Total Sum: 675 (13.33%), Ratio(%) per element: [33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-12-26 23:29:21,992 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p40_42_dm1/frozen_params_histogram/251226_2329_rank2_stage2.svg
[rank2]:	> Counts Sum: 162, Total Sum: 540 (30.00%), Ratio(%) per element: [60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 53.33, 53.33, 53.33, 53.33, 53.33, 53.33, 53.33, 53.33, 53.33, 6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-26 23:29:21,986 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p40_42_dm1/frozen_ratio_history/rank3/251226_2329_stage3_step200.svg
[rank3]:2025-12-26 23:29:22,125 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p40_42_dm1/frozen_params_histogram/251226_2329_rank3_stage3.svg
[rank3]:	> Counts Sum: 63, Total Sum: 435 (14.48%), Ratio(%) per element: [46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-12-26 23:30:07,893 - Freezing Ratio: [Stage2] 0.75, Threshold: 9.9504e-01
[rank3]:2025-12-26 23:30:07,913 - Freezing Ratio: [Stage3] 0.31, Threshold: 1.7790e+00
[rank0]:2025-12-26 23:30:07,913 - Freezing Ratio: [Stage0] 0.49, Threshold: 8.7412e-01
[rank1]:2025-12-26 23:30:07,905 - Freezing Ratio: [Stage1] 0.40, Threshold: 1.0900e+00
[rank1]:2025-12-26 23:30:55,426 - Freezing Ratio: [Stage1] 0.00, Threshold: 4.4670e+00
[rank2]:2025-12-26 23:30:55,418 - Freezing Ratio: [Stage2] 0.50, Threshold: 2.5572e+00
[rank3]:2025-12-26 23:30:55,438 - Freezing Ratio: [Stage3] 0.00, Threshold: 2.0735e+00
[rank0]:2025-12-26 23:30:55,438 - Freezing Ratio: [Stage0] 0.24, Threshold: 4.6054e+00
[rank3]:2025-12-26 23:31:25,930 - Avg. fwd time: 13.6825 / Avg. bwd time: 41.6921 / Avg. batch time: 506.3844 (ms) / GPU bubble ratio: 12.52%
[rank1]:2025-12-26 23:31:25,983 - Avg. fwd time: 9.4189 / Avg. bwd time: 23.3924 / Avg. batch time: 573.7995 (ms) / GPU bubble ratio: 54.25%
[rank2]:2025-12-26 23:31:25,951 - Avg. fwd time: 7.7084 / Avg. bwd time: 17.2389 / Avg. batch time: 535.9376 (ms) / GPU bubble ratio: 62.76%
[rank0]:2025-12-26 23:31:26,012 - Avg. fwd time: 7.8774 / Avg. bwd time: 23.3249 / Avg. batch time: 610.2549 (ms) / GPU bubble ratio: 59.10%
[rank0]:2025-12-26 23:31:46,265 - Freezing Ratio: [Stage0] 0.49, Threshold: 1.0706e+00
[rank1]:2025-12-26 23:31:46,257 - Freezing Ratio: [Stage1] 0.40, Threshold: 9.6182e-01
[rank2]:2025-12-26 23:31:46,245 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.3301e+00
[rank3]:2025-12-26 23:31:46,264 - Freezing Ratio: [Stage3] 0.31, Threshold: 1.7672e+00
[rank0]:2025-12-26 23:32:34,157 - Freezing Ratio: [Stage0] 0.24, Threshold: 3.6460e+00
[rank1]:2025-12-26 23:32:34,146 - Freezing Ratio: [Stage1] 0.00, Threshold: 3.9527e+00
[rank2]:2025-12-26 23:32:34,138 - Freezing Ratio: [Stage2] 0.50, Threshold: 3.0142e+00
[rank3]:2025-12-26 23:32:34,158 - Freezing Ratio: [Stage3] 0.00, Threshold: 4.2515e+00
[rank0]:2025-12-26 23:33:25,206 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-26 23:33:25,223 - Freezing Ratio: [Stage0] 0.49, Threshold: 4.6627e+00
[rank1]:2025-12-26 23:33:25,215 - Freezing Ratio: [Stage1] 0.40, Threshold: 3.5966e+00
[rank2]:2025-12-26 23:33:25,203 - Freezing Ratio: [Stage2] 0.75, Threshold: 2.0730e+00
[rank3]:2025-12-26 23:33:25,224 - Freezing Ratio: [Stage3] 0.31, Threshold: 3.5552e+00
[rank1]:2025-12-26 23:33:29,951 - Avg. fwd time: 9.4283 / Avg. bwd time: 23.3052 / Avg. batch time: 573.3802 (ms) / GPU bubble ratio: 54.33%
[rank2]:2025-12-26 23:33:29,925 - Avg. fwd time: 7.7610 / Avg. bwd time: 16.8329 / Avg. batch time: 535.6155 (ms) / GPU bubble ratio: 63.27%
[rank3]:2025-12-26 23:33:29,906 - Avg. fwd time: 13.7064 / Avg. bwd time: 41.6819 / Avg. batch time: 506.4929 (ms) / GPU bubble ratio: 12.51%
[rank0]:2025-12-26 23:33:29,977 - Avg. fwd time: 7.9073 / Avg. bwd time: 23.0932 / Avg. batch time: 609.6003 (ms) / GPU bubble ratio: 59.32%
[rank0]:2025-12-26 23:33:30,005 -  step: 250  loss: -8.0000  grad_norm:  4.2633  memory: 13.42GiB(28.26%)  tps: 6,601  tflops: 51.60  mfu: 16.54%
[rank1]:2025-12-26 23:33:29,993 -  step: 250  loss: -8.0000  grad_norm:  4.2633  memory:  9.50GiB(19.99%)  tps: 6,601  tflops: 51.60  mfu: 16.54%
[rank2]:2025-12-26 23:33:29,987 -  step: 250  loss: -8.0000  grad_norm:  4.2633  memory:  6.98GiB(14.69%)  tps: 6,601  tflops: 51.60  mfu: 16.54%
[rank3]:2025-12-26 23:33:30,006 -  step: 250  loss:  0.3976  grad_norm:  4.2633  memory: 16.39GiB(34.50%)  tps: 6,601  tflops: 51.60  mfu: 16.54%
[rank1]:2025-12-26 23:34:13,014 - Freezing Ratio: [Stage1] 0.60, Threshold: 2.6735e+01
[rank2]:2025-12-26 23:34:13,006 - Freezing Ratio: [Stage2] 0.75, Threshold: 2.0573e+01
[rank3]:2025-12-26 23:34:13,025 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.9789e+01
[rank0]:2025-12-26 23:34:13,026 - Freezing Ratio: [Stage0] 0.73, Threshold: 2.4775e+01
[rank0]:2025-12-26 23:34:58,533 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.0786e+01
[rank1]:2025-12-26 23:34:58,521 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.1296e+01
[rank2]:2025-12-26 23:34:58,517 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.1511e+01
[rank3]:2025-12-26 23:34:58,533 - Freezing Ratio: [Stage3] 0.62, Threshold: 9.2251e+00
[rank2]:2025-12-26 23:35:25,612 - Avg. fwd time: 7.8242 / Avg. bwd time: 16.3547 / Avg. batch time: 532.5233 (ms) / GPU bubble ratio: 63.68%
[rank3]:2025-12-26 23:35:25,593 - Avg. fwd time: 13.7498 / Avg. bwd time: 41.3146 / Avg. batch time: 503.8975 (ms) / GPU bubble ratio: 12.58%
[rank0]:2025-12-26 23:35:25,657 - Avg. fwd time: 7.9716 / Avg. bwd time: 22.5939 / Avg. batch time: 605.4023 (ms) / GPU bubble ratio: 59.61%
[rank1]:2025-12-26 23:35:25,633 - Avg. fwd time: 9.4987 / Avg. bwd time: 22.7160 / Avg. batch time: 569.6904 (ms) / GPU bubble ratio: 54.76%
[rank1]:2025-12-26 23:35:43,721 - Freezing Ratio: [Stage1] 0.60, Threshold: 1.8689e+00
[rank2]:2025-12-26 23:35:43,721 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.9608e+00
[rank3]:2025-12-26 23:35:43,737 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.1216e+00
[rank0]:2025-12-26 23:35:43,737 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.9689e+00
[rank2]:2025-12-26 23:36:29,405 - Freezing Ratio: [Stage2] 0.75, Threshold: 7.9020e-01
[rank3]:2025-12-26 23:36:29,421 - Freezing Ratio: [Stage3] 0.62, Threshold: 7.2304e-01
[rank0]:2025-12-26 23:36:29,420 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1121e+00
[rank1]:2025-12-26 23:36:29,409 - Freezing Ratio: [Stage1] 0.80, Threshold: 3.6996e-01
[rank0]:2025-12-26 23:37:14,606 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-26 23:37:14,623 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.8630e+00
[rank1]:2025-12-26 23:37:14,607 - Freezing Ratio: [Stage1] 0.60, Threshold: 1.2673e+00
[rank2]:2025-12-26 23:37:14,607 - Freezing Ratio: [Stage2] 0.75, Threshold: 8.7424e-01
[rank3]:2025-12-26 23:37:14,623 - Freezing Ratio: [Stage3] 0.62, Threshold: 5.6884e-01
[rank2]:2025-12-26 23:37:19,074 - Avg. fwd time: 7.8772 / Avg. bwd time: 15.9569 / Avg. batch time: 529.3160 (ms) / GPU bubble ratio: 63.98%
[rank3]:2025-12-26 23:37:19,055 - Avg. fwd time: 13.8017 / Avg. bwd time: 40.9137 / Avg. batch time: 501.1024 (ms) / GPU bubble ratio: 12.65%
[rank0]:2025-12-26 23:37:19,122 - Avg. fwd time: 8.0367 / Avg. bwd time: 22.0928 / Avg. batch time: 601.0229 (ms) / GPU bubble ratio: 59.90%
[rank1]:2025-12-26 23:37:19,098 - Avg. fwd time: 9.5777 / Avg. bwd time: 22.0617 / Avg. batch time: 565.8227 (ms) / GPU bubble ratio: 55.27%
[rank1]:2025-12-26 23:37:19,135 -  step: 300  loss: -8.0000  grad_norm:  0.5347  memory:  9.50GiB(19.99%)  tps: 7,150  tflops: 55.90  mfu: 17.92%
[rank2]:2025-12-26 23:37:19,132 -  step: 300  loss: -8.0000  grad_norm:  0.5347  memory:  6.98GiB(14.69%)  tps: 7,150  tflops: 55.90  mfu: 17.92%
[rank3]:2025-12-26 23:37:19,148 -  step: 300  loss:  0.2842  grad_norm:  0.5347  memory: 16.39GiB(34.50%)  tps: 7,150  tflops: 55.90  mfu: 17.92%
[rank0]:2025-12-26 23:37:19,146 -  step: 300  loss: -8.0000  grad_norm:  0.5347  memory: 13.42GiB(28.26%)  tps: 7,150  tflops: 55.90  mfu: 17.92%
[rank0]:2025-12-26 23:37:19,201 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p40_42_dm1/frozen_ratio_history/rank0/251226_2337_stage0_step300.svg
[rank1]:2025-12-26 23:37:19,203 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p40_42_dm1/frozen_ratio_history/rank1/251226_2337_stage1_step300.svg
[rank2]:2025-12-26 23:37:19,200 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p40_42_dm1/frozen_ratio_history/rank2/251226_2337_stage2_step300.svg
[rank3]:2025-12-26 23:37:19,285 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p40_42_dm1/pipeline_schedule/251226_2337_step300_rank3.svg
[rank3]:			> Batch Time: 549.09 ms, GPU Bubble Ratio: 62.98%, 64.72%, 70.78%, 25.99%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-36ms      | [S0,MB0,B]  122-16-139ms   | [S0,MB4,F]  139-8-147ms    | [S0,MB1,B]  178-16-195ms   | [S0,MB5,F]  195-8-203ms    | [S0,MB2,B]  236-16-252ms   | [S0,MB6,F]  252-8-261ms    | [S0,MB3,B]  295-16-312ms   | [S0,MB7,F]  312-8-320ms    | [S0,MB4,B]  355-16-371ms   | [S0,MB5,B]  413-16-430ms   | [S0,MB6,B]  472-16-489ms   | [S0,MB7,B]  532-16-549ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-10-34ms     | [S1,MB2,F]  37-10-48ms     | [S1,MB0,B]  103-13-117ms   | [S1,MB3,F]  120-10-131ms   | [S1,MB1,B]  159-13-172ms   | [S1,MB4,F]  177-10-187ms   | [S1,MB2,B]  216-13-229ms   | [S1,MB5,F]  234-10-244ms   | [S1,MB3,B]  275-13-289ms   | [S1,MB6,F]  294-10-304ms   | [S1,MB4,B]  336-13-350ms   | [S1,MB7,F]  353-10-364ms   | [S1,MB5,B]  396-13-410ms   | [S1,MB6,B]  455-13-469ms   | [S1,MB7,B]  515-13-529ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  34-8-42ms      | [S2,MB0,B]  86-11-98ms     | [S2,MB2,F]  102-8-110ms    | [S2,MB1,B]  142-11-154ms   | [S2,MB3,F]  157-8-165ms    | [S2,MB2,B]  199-11-211ms   | [S2,MB4,F]  214-8-222ms    | [S2,MB3,B]  258-11-270ms   | [S2,MB5,F]  273-8-282ms    | [S2,MB4,B]  319-11-331ms   | [S2,MB6,F]  334-8-343ms    | [S2,MB5,B]  380-11-391ms   | [S2,MB7,F]  395-8-403ms    | [S2,MB6,B]  440-11-452ms   | [S2,MB7,B]  500-11-512ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  48-34-83ms     | [S3,MB1,F]  85-12-97ms     | [S3,MB1,B]  103-35-138ms   | [S3,MB2,F]  140-13-154ms   | [S3,MB2,B]  159-36-196ms   | [S3,MB3,F]  197-14-212ms   | [S3,MB3,B]  218-36-255ms   | [S3,MB4,F]  257-15-272ms   | [S3,MB4,B]  278-37-315ms   | [S3,MB5,F]  318-15-333ms   | [S3,MB5,B]  339-37-376ms   | [S3,MB6,F]  378-15-393ms   | [S3,MB6,B]  399-37-437ms   | [S3,MB7,F]  439-14-454ms   | [S3,MB7,B]  460-37-497ms  
[rank2]:2025-12-26 23:37:19,348 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p40_42_dm1/frozen_params_histogram/251226_2337_rank2_stage2.svg
[rank2]:	> Counts Sum: 414, Total Sum: 900 (46.00%), Ratio(%) per element: [76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 72.0, 72.0, 72.0, 72.0, 72.0, 72.0, 72.0, 72.0, 72.0, 36.0, 36.0, 36.0, 36.0, 36.0, 36.0, 36.0, 36.0, 36.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-26 23:37:19,329 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p40_42_dm1/frozen_ratio_history/rank3/251226_2337_stage3_step300.svg
[rank0]:2025-12-26 23:37:19,357 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p40_42_dm1/frozen_params_histogram/251226_2337_rank0_stage0.svg
[rank0]:	> Counts Sum: 306, Total Sum: 925 (33.08%), Ratio(%) per element: [0.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-12-26 23:37:19,351 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p40_42_dm1/frozen_params_histogram/251226_2337_rank1_stage1.svg
[rank1]:	> Counts Sum: 297, Total Sum: 1125 (26.40%), Ratio(%) per element: [52.0, 52.0, 52.0, 52.0, 52.0, 52.0, 52.0, 52.0, 52.0, 52.0, 52.0, 52.0, 52.0, 52.0, 52.0, 52.0, 52.0, 52.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-26 23:37:19,463 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p40_42_dm1/frozen_params_histogram/251226_2337_rank3_stage3.svg
[rank3]:	> Counts Sum: 180, Total Sum: 725 (24.83%), Ratio(%) per element: [60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-12-26 23:38:00,371 - Freezing Ratio: [Stage0] 0.73, Threshold: 6.5153e-01
[rank1]:2025-12-26 23:38:00,359 - Freezing Ratio: [Stage1] 0.80, Threshold: 2.8815e-01
[rank2]:2025-12-26 23:38:00,355 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.2687e+00
[rank3]:2025-12-26 23:38:00,371 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.1023e+00
[rank1]:2025-12-26 23:38:45,460 - Freezing Ratio: [Stage1] 0.60, Threshold: 1.8378e+00
[rank2]:2025-12-26 23:38:45,459 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.7072e+00
[rank3]:2025-12-26 23:38:45,475 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.8991e+00
[rank0]:2025-12-26 23:38:45,475 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.0688e+00
[rank3]:2025-12-26 23:39:12,659 - Avg. fwd time: 13.8430 / Avg. bwd time: 40.5692 / Avg. batch time: 498.6747 (ms) / GPU bubble ratio: 12.71%
[rank2]:2025-12-26 23:39:12,679 - Avg. fwd time: 7.9221 / Avg. bwd time: 15.6197 / Avg. batch time: 526.5676 (ms) / GPU bubble ratio: 64.23%
[rank0]:2025-12-26 23:39:12,728 - Avg. fwd time: 8.0921 / Avg. bwd time: 21.6686 / Avg. batch time: 597.3170 (ms) / GPU bubble ratio: 60.14%
[rank1]:2025-12-26 23:39:12,703 - Avg. fwd time: 9.6399 / Avg. bwd time: 21.5435 / Avg. batch time: 562.5504 (ms) / GPU bubble ratio: 55.65%
[rank0]:2025-12-26 23:39:31,206 - Freezing Ratio: [Stage0] 0.73, Threshold: 3.0556e+00
[rank1]:2025-12-26 23:39:31,194 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.6519e+00
[rank2]:2025-12-26 23:39:31,190 - Freezing Ratio: [Stage2] 0.75, Threshold: 4.0781e+00
[rank3]:2025-12-26 23:39:31,206 - Freezing Ratio: [Stage3] 0.62, Threshold: 5.4750e+00
[rank0]:2025-12-26 23:40:16,363 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.4730e+00
[rank1]:2025-12-26 23:40:16,348 - Freezing Ratio: [Stage1] 0.60, Threshold: 6.1580e-01
[rank2]:2025-12-26 23:40:16,348 - Freezing Ratio: [Stage2] 0.75, Threshold: 5.6243e-01
[rank3]:2025-12-26 23:40:16,364 - Freezing Ratio: [Stage3] 0.62, Threshold: 8.6163e-01
[rank2]:2025-12-26 23:41:01,775 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.1471e+00
[rank3]:2025-12-26 23:41:01,791 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.0657e+00
[rank0]:2025-12-26 23:41:01,783 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-26 23:41:01,791 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.6574e+00
[rank1]:2025-12-26 23:41:01,779 - Freezing Ratio: [Stage1] 0.80, Threshold: 2.7836e-01
[rank2]:2025-12-26 23:41:06,263 - Avg. fwd time: 7.9610 / Avg. bwd time: 15.3304 / Avg. batch time: 524.2607 (ms) / GPU bubble ratio: 64.46%
[rank3]:2025-12-26 23:41:06,243 - Avg. fwd time: 13.8846 / Avg. bwd time: 40.2772 / Avg. batch time: 496.6687 (ms) / GPU bubble ratio: 12.76%
[rank0]:2025-12-26 23:41:06,309 - Avg. fwd time: 8.1399 / Avg. bwd time: 21.3049 / Avg. batch time: 594.1823 (ms) / GPU bubble ratio: 60.36%
[rank0]:2025-12-26 23:41:06,332 -  step: 350  loss: -8.0000  grad_norm:  0.2610  memory: 13.42GiB(28.26%)  tps: 7,212  tflops: 56.38  mfu: 18.07%
[rank1]:2025-12-26 23:41:06,284 - Avg. fwd time: 9.6951 / Avg. bwd time: 21.0907 / Avg. batch time: 559.7871 (ms) / GPU bubble ratio: 56.00%
[rank1]:2025-12-26 23:41:06,318 -  step: 350  loss: -8.0000  grad_norm:  0.2610  memory:  9.50GiB(19.99%)  tps: 7,212  tflops: 56.38  mfu: 18.07%
[rank2]:2025-12-26 23:41:06,318 -  step: 350  loss: -8.0000  grad_norm:  0.2610  memory:  6.98GiB(14.69%)  tps: 7,212  tflops: 56.38  mfu: 18.07%
[rank3]:2025-12-26 23:41:06,334 -  step: 350  loss:  0.2382  grad_norm:  0.2610  memory: 16.39GiB(34.50%)  tps: 7,212  tflops: 56.38  mfu: 18.07%
[rank1]:2025-12-26 23:41:46,999 - Freezing Ratio: [Stage1] 0.60, Threshold: 4.2985e-01
[rank2]:2025-12-26 23:41:46,999 - Freezing Ratio: [Stage2] 0.75, Threshold: 5.9414e-01
[rank3]:2025-12-26 23:41:47,015 - Freezing Ratio: [Stage3] 0.62, Threshold: 7.0824e-01
[rank0]:2025-12-26 23:41:47,015 - Freezing Ratio: [Stage0] 0.73, Threshold: 3.9195e-01
[rank3]:2025-12-26 23:42:32,621 - Freezing Ratio: [Stage3] 0.62, Threshold: 4.9650e-01
[rank0]:2025-12-26 23:42:32,621 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.2709e+00
[rank1]:2025-12-26 23:42:32,609 - Freezing Ratio: [Stage1] 0.80, Threshold: 7.9503e-01
[rank2]:2025-12-26 23:42:32,606 - Freezing Ratio: [Stage2] 0.75, Threshold: 7.4636e-01
[rank2]:2025-12-26 23:42:59,627 - Avg. fwd time: 7.9946 / Avg. bwd time: 15.0793 / Avg. batch time: 522.2157 (ms) / GPU bubble ratio: 64.65%
[rank3]:2025-12-26 23:42:59,606 - Avg. fwd time: 13.9185 / Avg. bwd time: 40.0205 / Avg. batch time: 494.8854 (ms) / GPU bubble ratio: 12.81%
[rank0]:2025-12-26 23:42:59,673 - Avg. fwd time: 8.1811 / Avg. bwd time: 20.9895 / Avg. batch time: 591.3884 (ms) / GPU bubble ratio: 60.54%
[rank1]:2025-12-26 23:42:59,648 - Avg. fwd time: 9.7466 / Avg. bwd time: 20.6668 / Avg. batch time: 557.3156 (ms) / GPU bubble ratio: 56.34%
[rank3]:2025-12-26 23:43:17,783 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.2955e+00
[rank0]:2025-12-26 23:43:17,783 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.3688e+00
[rank1]:2025-12-26 23:43:17,767 - Freezing Ratio: [Stage1] 0.60, Threshold: 2.5340e+00
[rank2]:2025-12-26 23:43:17,767 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.0693e+00
[rank1]:2025-12-26 23:44:03,165 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.2834e-01
[rank2]:2025-12-26 23:44:03,161 - Freezing Ratio: [Stage2] 0.75, Threshold: 3.4520e-01
[rank3]:2025-12-26 23:44:03,177 - Freezing Ratio: [Stage3] 0.62, Threshold: 5.4164e-01
[rank0]:2025-12-26 23:44:03,177 - Freezing Ratio: [Stage0] 0.73, Threshold: 9.6706e-01
[rank2]:2025-12-26 23:44:48,339 - Freezing Ratio: [Stage2] 0.75, Threshold: 4.6051e-01
[rank3]:2025-12-26 23:44:48,354 - Freezing Ratio: [Stage3] 0.62, Threshold: 2.7808e-01
[rank1]:2025-12-26 23:44:48,339 - Freezing Ratio: [Stage1] 0.60, Threshold: 5.6879e-01
[rank0]:2025-12-26 23:44:48,337 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-26 23:44:48,354 - Freezing Ratio: [Stage0] 0.73, Threshold: 7.6103e-01
[rank3]:2025-12-26 23:44:52,889 - Avg. fwd time: 13.9469 / Avg. bwd time: 39.7948 / Avg. batch time: 493.3070 (ms) / GPU bubble ratio: 12.85%
[rank2]:2025-12-26 23:44:52,909 - Avg. fwd time: 8.0242 / Avg. bwd time: 14.8592 / Avg. batch time: 520.4086 (ms) / GPU bubble ratio: 64.82%
[rank2]:2025-12-26 23:44:52,968 -  step: 400  loss: -8.0000  grad_norm:  0.5070  memory:  6.98GiB(14.69%)  tps: 7,229  tflops: 56.51  mfu: 18.11%
[rank3]:2025-12-26 23:44:52,984 -  step: 400  loss:  0.2256  grad_norm:  0.5070  memory: 16.39GiB(34.50%)  tps: 7,229  tflops: 56.51  mfu: 18.11%
[rank1]:2025-12-26 23:44:52,934 - Avg. fwd time: 9.7908 / Avg. bwd time: 20.3029 / Avg. batch time: 555.1429 (ms) / GPU bubble ratio: 56.63%
[rank1]:2025-12-26 23:44:52,972 -  step: 400  loss: -8.0000  grad_norm:  0.5070  memory:  9.50GiB(19.99%)  tps: 7,229  tflops: 56.51  mfu: 18.11%
[rank0]:2025-12-26 23:44:52,959 - Avg. fwd time: 8.2174 / Avg. bwd time: 20.7135 / Avg. batch time: 588.9330 (ms) / GPU bubble ratio: 60.70%
[rank0]:2025-12-26 23:44:52,982 -  step: 400  loss: -8.0000  grad_norm:  0.5070  memory: 13.42GiB(28.26%)  tps: 7,229  tflops: 56.51  mfu: 18.11%
[rank0]:2025-12-26 23:44:53,039 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p40_42_dm1/frozen_ratio_history/rank0/251226_2344_stage0_step400.svg
[rank2]:2025-12-26 23:44:53,041 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p40_42_dm1/frozen_ratio_history/rank2/251226_2344_stage2_step400.svg
[rank1]:2025-12-26 23:44:53,041 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p40_42_dm1/frozen_ratio_history/rank1/251226_2344_stage1_step400.svg
[rank2]:2025-12-26 23:44:53,189 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p40_42_dm1/frozen_params_histogram/251226_2344_rank2_stage2.svg
[rank2]:	> Counts Sum: 684, Total Sum: 1260 (54.29%), Ratio(%) per element: [82.85, 82.85, 82.85, 82.85, 82.85, 82.85, 82.85, 82.85, 82.85, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 54.28, 54.28, 54.28, 54.28, 54.28, 54.28, 54.28, 54.28, 54.28, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-26 23:44:53,123 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p40_42_dm1/pipeline_schedule/251226_2344_step400_rank3.svg
[rank3]:			> Batch Time: 548.59 ms, GPU Bubble Ratio: 62.98%, 64.79%, 70.81%, 26.09%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-36ms      | [S0,MB0,B]  122-16-138ms   | [S0,MB4,F]  138-8-147ms    | [S0,MB1,B]  177-16-193ms   | [S0,MB5,F]  193-8-201ms    | [S0,MB2,B]  233-16-250ms   | [S0,MB6,F]  250-8-258ms    | [S0,MB3,B]  293-16-310ms   | [S0,MB7,F]  310-8-318ms    | [S0,MB4,B]  354-16-370ms   | [S0,MB5,B]  413-16-429ms   | [S0,MB6,B]  471-16-488ms   | [S0,MB7,B]  532-16-548ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-10-34ms     | [S1,MB2,F]  37-10-47ms     | [S1,MB0,B]  103-13-116ms   | [S1,MB3,F]  120-10-130ms   | [S1,MB1,B]  158-13-171ms   | [S1,MB4,F]  175-10-185ms   | [S1,MB2,B]  214-13-228ms   | [S1,MB5,F]  231-10-242ms   | [S1,MB3,B]  274-13-288ms   | [S1,MB6,F]  291-10-302ms   | [S1,MB4,B]  335-13-348ms   | [S1,MB7,F]  352-10-363ms   | [S1,MB5,B]  395-13-409ms   | [S1,MB6,B]  454-13-468ms   | [S1,MB7,B]  514-13-528ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  34-8-42ms      | [S2,MB0,B]  86-11-98ms     | [S2,MB2,F]  101-8-110ms    | [S2,MB1,B]  141-11-153ms   | [S2,MB3,F]  156-8-164ms    | [S2,MB2,B]  198-11-209ms   | [S2,MB4,F]  213-8-221ms    | [S2,MB3,B]  258-11-269ms   | [S2,MB5,F]  273-8-281ms    | [S2,MB4,B]  318-11-330ms   | [S2,MB6,F]  333-8-342ms    | [S2,MB5,B]  379-11-390ms   | [S2,MB7,F]  394-8-402ms    | [S2,MB6,B]  439-11-451ms   | [S2,MB7,B]  499-11-511ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  48-34-82ms     | [S3,MB1,F]  85-11-96ms     | [S3,MB1,B]  102-35-137ms   | [S3,MB2,F]  139-13-152ms   | [S3,MB2,B]  158-36-194ms   | [S3,MB3,F]  196-14-211ms   | [S3,MB3,B]  217-36-254ms   | [S3,MB4,F]  256-15-272ms   | [S3,MB4,B]  277-37-315ms   | [S3,MB5,F]  317-15-332ms   | [S3,MB5,B]  338-37-375ms   | [S3,MB6,F]  377-15-393ms   | [S3,MB6,B]  398-37-436ms   | [S3,MB7,F]  438-14-453ms   | [S3,MB7,B]  459-37-496ms  
[rank3]:2025-12-26 23:44:53,172 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p40_42_dm1/frozen_ratio_history/rank3/251226_2344_stage3_step400.svg
[rank1]:2025-12-26 23:44:53,183 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p40_42_dm1/frozen_params_histogram/251226_2344_rank1_stage1.svg
[rank1]:	> Counts Sum: 612, Total Sum: 1575 (38.86%), Ratio(%) per element: [65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 42.85, 42.85, 42.85, 42.85, 42.85, 42.85, 42.85, 42.85, 42.85, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-12-26 23:44:53,190 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p40_42_dm1/frozen_params_histogram/251226_2344_rank0_stage0.svg
[rank0]:	> Counts Sum: 576, Total Sum: 1295 (44.48%), Ratio(%) per element: [0.0, 82.85, 82.85, 82.85, 82.85, 82.85, 82.85, 82.85, 82.85, 82.85, 57.14, 57.14, 57.14, 57.14, 57.14, 57.14, 57.14, 57.14, 57.14, 42.85, 42.85, 42.85, 42.85, 42.85, 42.85, 42.85, 42.85, 42.85, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-26 23:44:53,302 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p40_42_dm1/frozen_params_histogram/251226_2344_rank3_stage3.svg
[rank3]:	> Counts Sum: 360, Total Sum: 1015 (35.47%), Ratio(%) per element: [71.42, 71.42, 71.42, 71.42, 71.42, 71.42, 71.42, 71.42, 71.42, 42.85, 42.85, 42.85, 42.85, 42.85, 42.85, 42.85, 42.85, 42.85, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-26 23:45:18,955 - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-12-26 23:45:19,197 - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-12-26 23:45:19,217 - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-12-26 23:45:19,235 - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-12-26 23:45:34,079 - Freezing Ratio: [Stage0] 0.73, Threshold: 2.7859e+00
[rank2]:2025-12-26 23:45:34,063 - Freezing Ratio: [Stage2] 0.75, Threshold: 2.6891e+00
[rank1]:2025-12-26 23:45:34,067 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.1638e+00
[rank3]:2025-12-26 23:45:34,079 - Freezing Ratio: [Stage3] 0.62, Threshold: 2.1348e+00
[rank1]:2025-12-26 23:46:19,050 - Freezing Ratio: [Stage1] 0.80, Threshold: 9.1725e+00
[rank2]:2025-12-26 23:46:19,050 - Freezing Ratio: [Stage2] 0.75, Threshold: 8.2356e+00
[rank3]:2025-12-26 23:46:19,066 - Freezing Ratio: [Stage3] 0.62, Threshold: 7.1390e+00
[rank0]:2025-12-26 23:46:19,065 - Freezing Ratio: [Stage0] 0.73, Threshold: 9.3667e+00
[rank1]:2025-12-26 23:46:46,122 - Avg. fwd time: 9.8310 / Avg. bwd time: 19.9682 / Avg. batch time: 553.1705 (ms) / GPU bubble ratio: 56.90%
[rank2]:2025-12-26 23:46:46,100 - Avg. fwd time: 8.0501 / Avg. bwd time: 14.6652 / Avg. batch time: 518.7743 (ms) / GPU bubble ratio: 64.97%
[rank3]:2025-12-26 23:46:46,079 - Avg. fwd time: 13.9646 / Avg. bwd time: 39.5951 / Avg. batch time: 491.8504 (ms) / GPU bubble ratio: 12.88%
[rank0]:2025-12-26 23:46:46,148 - Avg. fwd time: 8.2492 / Avg. bwd time: 20.4702 / Avg. batch time: 586.7114 (ms) / GPU bubble ratio: 60.84%
[rank1]:2025-12-26 23:47:04,095 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.9959e+00
[rank2]:2025-12-26 23:47:04,095 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.7835e+00
[rank3]:2025-12-26 23:47:04,110 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.9213e+00
[rank0]:2025-12-26 23:47:04,110 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.4974e+00
[rank1]:2025-12-26 23:47:49,222 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.9711e+00
[rank2]:2025-12-26 23:47:49,222 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.9023e+00
[rank3]:2025-12-26 23:47:49,237 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.8796e+00
[rank0]:2025-12-26 23:47:49,237 - Freezing Ratio: [Stage0] 0.73, Threshold: 2.6566e+00
[rank1]:2025-12-26 23:48:34,349 - Freezing Ratio: [Stage1] 0.80, Threshold: 2.1168e+00
[rank2]:2025-12-26 23:48:34,348 - Freezing Ratio: [Stage2] 0.75, Threshold: 2.4995e+00
[rank3]:2025-12-26 23:48:34,365 - Freezing Ratio: [Stage3] 0.62, Threshold: 3.0036e+00
[rank0]:2025-12-26 23:48:34,356 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-26 23:48:34,364 - Freezing Ratio: [Stage0] 0.73, Threshold: 3.2215e+00
[rank3]:2025-12-26 23:48:38,795 - Avg. fwd time: 13.9797 / Avg. bwd time: 39.4175 / Avg. batch time: 490.5485 (ms) / GPU bubble ratio: 12.92%
[rank1]:2025-12-26 23:48:38,839 - Avg. fwd time: 9.8736 / Avg. bwd time: 19.6121 / Avg. batch time: 551.3292 (ms) / GPU bubble ratio: 57.22%
[rank1]:2025-12-26 23:48:38,874 -  step: 450  loss: -8.0000  grad_norm:  0.1506  memory:  9.50GiB(19.99%)  tps: 7,253  tflops: 56.70  mfu: 18.17%
[rank2]:2025-12-26 23:48:38,816 - Avg. fwd time: 8.0728 / Avg. bwd time: 14.4927 / Avg. batch time: 517.2919 (ms) / GPU bubble ratio: 65.10%
[rank2]:2025-12-26 23:48:38,874 -  step: 450  loss: -8.0000  grad_norm:  0.1506  memory:  6.98GiB(14.69%)  tps: 7,253  tflops: 56.70  mfu: 18.17%
[rank3]:2025-12-26 23:48:38,890 -  step: 450  loss:  0.2425  grad_norm:  0.1506  memory: 16.39GiB(34.50%)  tps: 7,253  tflops: 56.70  mfu: 18.17%
[rank0]:2025-12-26 23:48:38,865 - Avg. fwd time: 8.2770 / Avg. bwd time: 20.2539 / Avg. batch time: 584.6480 (ms) / GPU bubble ratio: 60.96%
[rank0]:2025-12-26 23:48:38,888 -  step: 450  loss: -8.0000  grad_norm:  0.1506  memory: 13.42GiB(28.26%)  tps: 7,253  tflops: 56.70  mfu: 18.17%
[rank2]:2025-12-26 23:49:19,530 - Freezing Ratio: [Stage2] 0.75, Threshold: 5.5602e-01
[rank1]:2025-12-26 23:49:19,530 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.0313e+00
[rank3]:2025-12-26 23:49:19,546 - Freezing Ratio: [Stage3] 0.62, Threshold: 2.7590e-01
[rank0]:2025-12-26 23:49:19,546 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1703e+00
[rank0]:2025-12-26 23:50:04,732 - Freezing Ratio: [Stage0] 0.73, Threshold: 8.5528e-01
[rank1]:2025-12-26 23:50:04,717 - Freezing Ratio: [Stage1] 0.80, Threshold: 4.8655e-01
[rank2]:2025-12-26 23:50:04,717 - Freezing Ratio: [Stage2] 0.75, Threshold: 5.9933e-01
[rank3]:2025-12-26 23:50:04,732 - Freezing Ratio: [Stage3] 0.62, Threshold: 8.5952e-01
[rank3]:2025-12-26 23:50:31,836 - Avg. fwd time: 13.9979 / Avg. bwd time: 39.2607 / Avg. batch time: 489.4385 (ms) / GPU bubble ratio: 12.95%
[rank1]:2025-12-26 23:50:31,881 - Avg. fwd time: 9.9119 / Avg. bwd time: 19.2937 / Avg. batch time: 549.7361 (ms) / GPU bubble ratio: 57.50%
[rank2]:2025-12-26 23:50:31,858 - Avg. fwd time: 8.0933 / Avg. bwd time: 14.3383 / Avg. batch time: 516.0198 (ms) / GPU bubble ratio: 65.22%
[rank0]:2025-12-26 23:50:31,907 - Avg. fwd time: 8.3020 / Avg. bwd time: 20.0603 / Avg. batch time: 582.8576 (ms) / GPU bubble ratio: 61.07%
[rank1]:2025-12-26 23:50:49,923 - Freezing Ratio: [Stage1] 0.80, Threshold: 8.2147e-01
[rank2]:2025-12-26 23:50:49,923 - Freezing Ratio: [Stage2] 0.75, Threshold: 4.3801e-01
[rank3]:2025-12-26 23:50:49,939 - Freezing Ratio: [Stage3] 0.62, Threshold: 3.7547e-01
[rank0]:2025-12-26 23:50:49,938 - Freezing Ratio: [Stage0] 0.73, Threshold: 5.4773e-01
[rank0]:2025-12-26 23:51:35,142 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.3631e+00
[rank1]:2025-12-26 23:51:35,127 - Freezing Ratio: [Stage1] 0.80, Threshold: 9.5030e-01
[rank2]:2025-12-26 23:51:35,127 - Freezing Ratio: [Stage2] 0.75, Threshold: 9.3249e-01
[rank3]:2025-12-26 23:51:35,143 - Freezing Ratio: [Stage3] 0.62, Threshold: 3.8096e-01
[rank0]:2025-12-26 23:52:20,210 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-26 23:52:20,227 - Freezing Ratio: [Stage0] 0.73, Threshold: 3.9559e+00
[rank1]:2025-12-26 23:52:20,211 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.6919e+00
[rank2]:2025-12-26 23:52:20,211 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.6950e+00
[rank3]:2025-12-26 23:52:20,227 - Freezing Ratio: [Stage3] 0.62, Threshold: 4.5864e-01
[rank2]:2025-12-26 23:52:24,684 - Avg. fwd time: 8.1116 / Avg. bwd time: 14.1989 / Avg. batch time: 514.8145 (ms) / GPU bubble ratio: 65.33%
[rank3]:2025-12-26 23:52:24,662 - Avg. fwd time: 14.0113 / Avg. bwd time: 39.1152 / Avg. batch time: 488.3794 (ms) / GPU bubble ratio: 12.98%
[rank0]:2025-12-26 23:52:24,734 - Avg. fwd time: 8.3244 / Avg. bwd time: 19.8857 / Avg. batch time: 581.1860 (ms) / GPU bubble ratio: 61.17%
[rank1]:2025-12-26 23:52:24,707 - Avg. fwd time: 9.9462 / Avg. bwd time: 19.0066 / Avg. batch time: 548.2422 (ms) / GPU bubble ratio: 57.75%
[rank1]:2025-12-26 23:52:24,743 -  step: 500  loss: -8.0000  grad_norm:  0.0825  memory:  9.50GiB(19.99%)  tps: 7,254  tflops: 56.71  mfu: 18.18%
[rank2]:2025-12-26 23:52:24,743 -  step: 500  loss: -8.0000  grad_norm:  0.0825  memory:  6.98GiB(14.69%)  tps: 7,254  tflops: 56.71  mfu: 18.18%
[rank3]:2025-12-26 23:52:24,758 -  step: 500  loss:  0.2337  grad_norm:  0.0825  memory: 16.39GiB(34.50%)  tps: 7,254  tflops: 56.71  mfu: 18.18%
[rank0]:2025-12-26 23:52:24,757 -  step: 500  loss: -8.0000  grad_norm:  0.0825  memory: 13.42GiB(28.26%)  tps: 7,254  tflops: 56.71  mfu: 18.18%
[rank0]:2025-12-26 23:52:24,809 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p40_42_dm1/frozen_ratio_history/rank0/251226_2352_stage0_step500.svg
[rank1]:2025-12-26 23:52:24,810 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p40_42_dm1/frozen_ratio_history/rank1/251226_2352_stage1_step500.svg
[rank2]:2025-12-26 23:52:24,811 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p40_42_dm1/frozen_ratio_history/rank2/251226_2352_stage2_step500.svg
[rank3]:2025-12-26 23:52:24,901 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p40_42_dm1/pipeline_schedule/251226_2352_step500_rank3.svg
[rank3]:			> Batch Time: 548.08 ms, GPU Bubble Ratio: 62.93%, 64.73%, 70.76%, 26.07%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-36ms      | [S0,MB0,B]  122-16-138ms   | [S0,MB4,F]  138-8-147ms    | [S0,MB1,B]  176-16-193ms   | [S0,MB5,F]  193-8-201ms    | [S0,MB2,B]  233-16-250ms   | [S0,MB6,F]  250-8-258ms    | [S0,MB3,B]  293-16-309ms   | [S0,MB7,F]  309-8-318ms    | [S0,MB4,B]  353-16-370ms   | [S0,MB5,B]  412-16-429ms   | [S0,MB6,B]  471-16-488ms   | [S0,MB7,B]  531-16-548ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-10-34ms     | [S1,MB2,F]  37-10-48ms     | [S1,MB0,B]  103-13-116ms   | [S1,MB3,F]  120-10-130ms   | [S1,MB1,B]  157-13-171ms   | [S1,MB4,F]  175-10-185ms   | [S1,MB2,B]  214-13-228ms   | [S1,MB5,F]  231-10-242ms   | [S1,MB3,B]  274-13-288ms   | [S1,MB6,F]  291-10-302ms   | [S1,MB4,B]  335-13-348ms   | [S1,MB7,F]  352-10-362ms   | [S1,MB5,B]  395-13-409ms   | [S1,MB6,B]  454-13-468ms   | [S1,MB7,B]  514-13-528ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  34-8-42ms      | [S2,MB0,B]  86-11-98ms     | [S2,MB2,F]  101-8-110ms    | [S2,MB1,B]  141-11-153ms   | [S2,MB3,F]  156-8-164ms    | [S2,MB2,B]  198-11-209ms   | [S2,MB4,F]  213-8-221ms    | [S2,MB3,B]  257-11-269ms   | [S2,MB5,F]  272-8-281ms    | [S2,MB4,B]  318-11-330ms   | [S2,MB6,F]  333-8-341ms    | [S2,MB5,B]  378-11-390ms   | [S2,MB7,F]  394-8-402ms    | [S2,MB6,B]  439-11-451ms   | [S2,MB7,B]  499-11-511ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  48-34-82ms     | [S3,MB1,F]  85-11-96ms     | [S3,MB1,B]  102-35-137ms   | [S3,MB2,F]  139-12-152ms   | [S3,MB2,B]  158-35-194ms   | [S3,MB3,F]  196-14-211ms   | [S3,MB3,B]  217-36-253ms   | [S3,MB4,F]  256-15-271ms   | [S3,MB4,B]  277-37-314ms   | [S3,MB5,F]  316-15-332ms   | [S3,MB5,B]  337-37-375ms   | [S3,MB6,F]  377-15-392ms   | [S3,MB6,B]  398-37-435ms   | [S3,MB7,F]  438-15-453ms   | [S3,MB7,B]  459-37-496ms  
[rank1]:2025-12-26 23:52:24,959 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p40_42_dm1/frozen_params_histogram/251226_2352_rank1_stage1.svg
[rank1]:	> Counts Sum: 972, Total Sum: 2025 (48.00%), Ratio(%) per element: [73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 55.55, 55.55, 55.55, 55.55, 55.55, 55.55, 55.55, 55.55, 55.55, 37.77, 37.77, 37.77, 37.77, 37.77, 37.77, 37.77, 37.77, 37.77, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-12-26 23:52:24,964 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p40_42_dm1/frozen_params_histogram/251226_2352_rank2_stage2.svg
[rank2]:	> Counts Sum: 954, Total Sum: 1620 (58.89%), Ratio(%) per element: [86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 84.44, 84.44, 84.44, 84.44, 84.44, 84.44, 84.44, 84.44, 84.44, 64.44, 64.44, 64.44, 64.44, 64.44, 64.44, 64.44, 64.44, 64.44, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-26 23:52:24,946 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p40_42_dm1/frozen_ratio_history/rank3/251226_2352_stage3_step500.svg
[rank0]:2025-12-26 23:52:24,963 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p40_42_dm1/frozen_params_histogram/251226_2352_rank0_stage0.svg
[rank0]:	> Counts Sum: 846, Total Sum: 1665 (50.81%), Ratio(%) per element: [0.0, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 55.55, 55.55, 55.55, 55.55, 55.55, 55.55, 55.55, 55.55, 55.55, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-26 23:52:25,077 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p40_42_dm1/frozen_params_histogram/251226_2352_rank3_stage3.svg
[rank3]:	> Counts Sum: 540, Total Sum: 1305 (41.38%), Ratio(%) per element: [77.77, 77.77, 77.77, 77.77, 77.77, 77.77, 77.77, 77.77, 77.77, 55.55, 55.55, 55.55, 55.55, 55.55, 55.55, 55.55, 55.55, 55.55, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-26 23:53:05,558 - Freezing Ratio: [Stage3] 0.62, Threshold: 9.8444e-01
[rank0]:2025-12-26 23:53:05,558 - Freezing Ratio: [Stage0] 0.73, Threshold: 6.5532e-01
[rank1]:2025-12-26 23:53:05,542 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.7663e+00
[rank2]:2025-12-26 23:53:05,542 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.2290e+00
[rank1]:2025-12-26 23:53:50,525 - Freezing Ratio: [Stage1] 0.80, Threshold: 2.9649e+00
[rank2]:2025-12-26 23:53:50,525 - Freezing Ratio: [Stage2] 0.75, Threshold: 2.3426e+00
[rank0]:2025-12-26 23:53:50,540 - Freezing Ratio: [Stage0] 0.73, Threshold: 2.4685e+00
[rank3]:2025-12-26 23:53:50,541 - Freezing Ratio: [Stage3] 0.62, Threshold: 2.4116e+00
[rank3]:2025-12-26 23:54:17,447 - Avg. fwd time: 14.0217 / Avg. bwd time: 38.9793 / Avg. batch time: 487.3737 (ms) / GPU bubble ratio: 13.00%
[rank1]:2025-12-26 23:54:17,493 - Avg. fwd time: 9.9769 / Avg. bwd time: 18.7463 / Avg. batch time: 546.8603 (ms) / GPU bubble ratio: 57.98%
[rank2]:2025-12-26 23:54:17,469 - Avg. fwd time: 8.1280 / Avg. bwd time: 14.0724 / Avg. batch time: 513.6950 (ms) / GPU bubble ratio: 65.43%
[rank0]:2025-12-26 23:54:17,520 - Avg. fwd time: 8.3444 / Avg. bwd time: 19.7272 / Avg. batch time: 579.6419 (ms) / GPU bubble ratio: 61.26%
[rank1]:2025-12-26 23:54:35,601 - Freezing Ratio: [Stage1] 0.80, Threshold: 5.1398e-01
[rank2]:2025-12-26 23:54:35,601 - Freezing Ratio: [Stage2] 0.75, Threshold: 5.4453e-01
[rank0]:2025-12-26 23:54:35,617 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.4343e+00
[rank3]:2025-12-26 23:54:35,617 - Freezing Ratio: [Stage3] 0.62, Threshold: 7.7799e-01
[rank1]:2025-12-26 23:55:20,653 - Freezing Ratio: [Stage1] 0.80, Threshold: 2.4022e+00
[rank2]:2025-12-26 23:55:20,653 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.7840e+00
[rank3]:2025-12-26 23:55:20,669 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.1110e+00
[rank0]:2025-12-26 23:55:20,669 - Freezing Ratio: [Stage0] 0.73, Threshold: 8.0073e-01
[rank0]:2025-12-26 23:56:05,689 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-26 23:56:05,696 - Freezing Ratio: [Stage0] 0.73, Threshold: 6.6186e-01
[rank1]:2025-12-26 23:56:05,681 - Freezing Ratio: [Stage1] 0.80, Threshold: 6.3223e-01
[rank2]:2025-12-26 23:56:05,681 - Freezing Ratio: [Stage2] 0.75, Threshold: 9.9511e-01
[rank3]:2025-12-26 23:56:05,696 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.0660e+00
[rank2]:2025-12-26 23:56:10,173 - Avg. fwd time: 8.1430 / Avg. bwd time: 13.9575 / Avg. batch time: 512.6957 (ms) / GPU bubble ratio: 65.51%
[rank3]:2025-12-26 23:56:10,151 - Avg. fwd time: 14.0332 / Avg. bwd time: 38.8581 / Avg. batch time: 486.4957 (ms) / GPU bubble ratio: 13.02%
[rank1]:2025-12-26 23:56:10,197 - Avg. fwd time: 10.0050 / Avg. bwd time: 18.5097 / Avg. batch time: 545.6226 (ms) / GPU bubble ratio: 58.19%
[rank1]:2025-12-26 23:56:10,233 -  step: 550  loss: -8.0000  grad_norm:  0.2016  memory:  9.50GiB(19.99%)  tps: 7,266  tflops: 56.80  mfu: 18.21%
[rank2]:2025-12-26 23:56:10,233 -  step: 550  loss: -8.0000  grad_norm:  0.2016  memory:  6.98GiB(14.69%)  tps: 7,266  tflops: 56.80  mfu: 18.21%
[rank3]:2025-12-26 23:56:10,249 -  step: 550  loss:  0.2410  grad_norm:  0.2016  memory: 16.39GiB(34.50%)  tps: 7,266  tflops: 56.80  mfu: 18.21%
[rank0]:2025-12-26 23:56:10,224 - Avg. fwd time: 8.3623 / Avg. bwd time: 19.5832 / Avg. batch time: 578.2564 (ms) / GPU bubble ratio: 61.34%
[rank0]:2025-12-26 23:56:10,247 -  step: 550  loss: -8.0000  grad_norm:  0.2016  memory: 13.42GiB(28.26%)  tps: 7,266  tflops: 56.80  mfu: 18.21%
[rank1]:2025-12-26 23:56:50,888 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.5328e+00
[rank2]:2025-12-26 23:56:50,888 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.8877e+00
[rank3]:2025-12-26 23:56:50,904 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.3046e+00
[rank0]:2025-12-26 23:56:50,903 - Freezing Ratio: [Stage0] 0.73, Threshold: 7.6711e-01
[rank1]:2025-12-26 23:57:36,036 - Freezing Ratio: [Stage1] 0.80, Threshold: 2.7084e+00
[rank2]:2025-12-26 23:57:36,036 - Freezing Ratio: [Stage2] 0.75, Threshold: 2.2118e+00
[rank0]:2025-12-26 23:57:36,052 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.3770e+00
[rank3]:2025-12-26 23:57:36,052 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.4962e+00
[rank3]:2025-12-26 23:58:03,017 - Avg. fwd time: 14.0445 / Avg. bwd time: 38.7495 / Avg. batch time: 485.7170 (ms) / GPU bubble ratio: 13.05%
[rank2]:2025-12-26 23:58:03,040 - Avg. fwd time: 8.1569 / Avg. bwd time: 13.8527 / Avg. batch time: 511.8069 (ms) / GPU bubble ratio: 65.60%
[rank1]:2025-12-26 23:58:03,064 - Avg. fwd time: 10.0309 / Avg. bwd time: 18.2939 / Avg. batch time: 544.5177 (ms) / GPU bubble ratio: 58.39%
[rank0]:2025-12-26 23:58:03,091 - Avg. fwd time: 8.3790 / Avg. bwd time: 19.4521 / Avg. batch time: 577.0174 (ms) / GPU bubble ratio: 61.41%
[rank1]:2025-12-26 23:58:21,174 - Freezing Ratio: [Stage1] 0.80, Threshold: 6.0816e-01
[rank2]:2025-12-26 23:58:21,175 - Freezing Ratio: [Stage2] 0.75, Threshold: 9.1463e-01
[rank0]:2025-12-26 23:58:21,190 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.2498e+00
[rank3]:2025-12-26 23:58:21,190 - Freezing Ratio: [Stage3] 0.62, Threshold: 6.7840e-01
[rank1]:2025-12-26 23:59:06,344 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.5888e-01
[rank2]:2025-12-26 23:59:06,343 - Freezing Ratio: [Stage2] 0.75, Threshold: 5.4669e-01
[rank0]:2025-12-26 23:59:06,359 - Freezing Ratio: [Stage0] 0.73, Threshold: 3.6218e-01
[rank3]:2025-12-26 23:59:06,359 - Freezing Ratio: [Stage3] 0.62, Threshold: 6.1763e-01
[rank0]:2025-12-26 23:59:51,488 - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-12-26 23:59:51,490 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.1786e+00
[rank2]:2025-12-26 23:59:51,490 - Freezing Ratio: [Stage2] 0.75, Threshold: 7.7887e-01
[rank0]:2025-12-26 23:59:51,505 - Freezing Ratio: [Stage0] 0.73, Threshold: 2.0988e-01
[rank3]:2025-12-26 23:59:51,505 - Freezing Ratio: [Stage3] 0.62, Threshold: 4.0455e-01
[rank3]:2025-12-26 23:59:56,003 - Avg. fwd time: 14.0540 / Avg. bwd time: 38.6535 / Avg. batch time: 485.0253 (ms) / GPU bubble ratio: 13.06%
[rank1]:2025-12-26 23:59:56,050 - Avg. fwd time: 10.0548 / Avg. bwd time: 18.0964 / Avg. batch time: 543.5264 (ms) / GPU bubble ratio: 58.57%
[rank2]:2025-12-26 23:59:56,026 - Avg. fwd time: 8.1697 / Avg. bwd time: 13.7566 / Avg. batch time: 511.0141 (ms) / GPU bubble ratio: 65.67%
[rank0]:2025-12-26 23:59:56,078 - Avg. fwd time: 8.3943 / Avg. bwd time: 19.3320 / Avg. batch time: 575.9039 (ms) / GPU bubble ratio: 61.48%
[rank0]:2025-12-26 23:59:56,101 -  step: 600  loss: -8.0000  grad_norm:  0.4401  memory: 13.42GiB(28.26%)  tps: 7,254  tflops: 56.71  mfu: 18.18%
[rank3]:2025-12-26 23:59:56,102 -  step: 600  loss:  0.2370  grad_norm:  0.4401  memory: 16.39GiB(34.50%)  tps: 7,254  tflops: 56.71  mfu: 18.18%
[rank1]:2025-12-26 23:59:56,087 -  step: 600  loss: -8.0000  grad_norm:  0.4401  memory:  9.50GiB(19.99%)  tps: 7,254  tflops: 56.71  mfu: 18.18%
[rank2]:2025-12-26 23:59:56,087 -  step: 600  loss: -8.0000  grad_norm:  0.4401  memory:  6.98GiB(14.69%)  tps: 7,254  tflops: 56.71  mfu: 18.18%
[rank2]:2025-12-26 23:59:56,155 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p40_42_dm1/frozen_ratio_history/rank2/251226_2359_stage2_step600.svg
[rank0]:2025-12-26 23:59:56,184 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p40_42_dm1/frozen_ratio_history/rank0/251226_2359_stage0_step600.svg
[rank1]:2025-12-26 23:59:56,185 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p40_42_dm1/frozen_ratio_history/rank1/251226_2359_stage1_step600.svg
[rank3]:2025-12-26 23:59:56,240 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p40_42_dm1/pipeline_schedule/251226_2359_step600_rank3.svg
[rank3]:			> Batch Time: 548.08 ms, GPU Bubble Ratio: 62.96%, 64.75%, 70.80%, 26.18%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-36ms      | [S0,MB0,B]  121-16-138ms   | [S0,MB4,F]  138-8-146ms    | [S0,MB1,B]  176-16-193ms   | [S0,MB5,F]  193-8-201ms    | [S0,MB2,B]  233-16-249ms   | [S0,MB6,F]  250-8-258ms    | [S0,MB3,B]  293-16-309ms   | [S0,MB7,F]  309-8-317ms    | [S0,MB4,B]  353-16-370ms   | [S0,MB5,B]  412-16-429ms   | [S0,MB6,B]  471-16-488ms   | [S0,MB7,B]  531-16-548ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-10-20ms      | [S1,MB1,F]  23-10-34ms     | [S1,MB2,F]  37-10-47ms     | [S1,MB0,B]  103-13-116ms   | [S1,MB3,F]  120-10-130ms   | [S1,MB1,B]  158-13-171ms   | [S1,MB4,F]  175-10-185ms   | [S1,MB2,B]  214-13-228ms   | [S1,MB5,F]  231-10-242ms   | [S1,MB3,B]  274-13-287ms   | [S1,MB6,F]  291-10-301ms   | [S1,MB4,B]  334-13-348ms   | [S1,MB7,F]  351-10-362ms   | [S1,MB5,B]  395-13-409ms   | [S1,MB6,B]  454-13-468ms   | [S1,MB7,B]  514-13-528ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  34-8-42ms      | [S2,MB0,B]  86-11-98ms     | [S2,MB2,F]  101-8-110ms    | [S2,MB1,B]  141-11-152ms   | [S2,MB3,F]  156-8-164ms    | [S2,MB2,B]  198-11-209ms   | [S2,MB4,F]  212-8-221ms    | [S2,MB3,B]  257-11-269ms   | [S2,MB5,F]  272-8-281ms    | [S2,MB4,B]  318-11-330ms   | [S2,MB6,F]  333-8-341ms    | [S2,MB5,B]  379-11-390ms   | [S2,MB7,F]  394-8-402ms    | [S2,MB6,B]  439-11-451ms   | [S2,MB7,B]  499-11-511ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  48-34-82ms     | [S3,MB1,F]  84-11-96ms     | [S3,MB1,B]  102-35-137ms   | [S3,MB2,F]  139-12-152ms   | [S3,MB2,B]  158-35-194ms   | [S3,MB3,F]  196-14-211ms   | [S3,MB3,B]  217-36-253ms   | [S3,MB4,F]  255-15-271ms   | [S3,MB4,B]  277-37-314ms   | [S3,MB5,F]  316-15-332ms   | [S3,MB5,B]  337-37-375ms   | [S3,MB6,F]  377-15-392ms   | [S3,MB6,B]  398-37-435ms   | [S3,MB7,F]  438-14-453ms   | [S3,MB7,B]  459-37-496ms  
[rank3]:2025-12-26 23:59:56,286 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p40_42_dm1/frozen_ratio_history/rank3/251226_2359_stage3_step600.svg
[rank1]:2025-12-26 23:59:56,334 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p40_42_dm1/frozen_params_histogram/251226_2359_rank1_stage1.svg
[rank1]:	> Counts Sum: 1332, Total Sum: 2475 (53.82%), Ratio(%) per element: [78.18, 78.18, 78.18, 78.18, 78.18, 78.18, 78.18, 78.18, 78.18, 78.18, 78.18, 78.18, 78.18, 78.18, 78.18, 78.18, 78.18, 78.18, 63.63, 63.63, 63.63, 63.63, 63.63, 63.63, 63.63, 63.63, 63.63, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-12-26 23:59:56,304 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p40_42_dm1/frozen_params_histogram/251226_2359_rank2_stage2.svg
[rank2]:	> Counts Sum: 1224, Total Sum: 1980 (61.82%), Ratio(%) per element: [89.09, 89.09, 89.09, 89.09, 89.09, 89.09, 89.09, 89.09, 89.09, 87.27, 87.27, 87.27, 87.27, 87.27, 87.27, 87.27, 87.27, 87.27, 70.9, 70.9, 70.9, 70.9, 70.9, 70.9, 70.9, 70.9, 70.9, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-12-26 23:59:56,340 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p40_42_dm1/frozen_params_histogram/251226_2359_rank0_stage0.svg
[rank0]:	> Counts Sum: 1116, Total Sum: 2035 (54.84%), Ratio(%) per element: [0.0, 89.09, 89.09, 89.09, 89.09, 89.09, 89.09, 89.09, 89.09, 89.09, 72.72, 72.72, 72.72, 72.72, 72.72, 72.72, 72.72, 72.72, 72.72, 63.63, 63.63, 63.63, 63.63, 63.63, 63.63, 63.63, 63.63, 63.63, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-26 23:59:56,419 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p40_42_dm1/frozen_params_histogram/251226_2359_rank3_stage3.svg
[rank3]:	> Counts Sum: 720, Total Sum: 1595 (45.14%), Ratio(%) per element: [81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 81.81, 63.63, 63.63, 63.63, 63.63, 63.63, 63.63, 63.63, 63.63, 63.63, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-12-27 00:00:37,060 - Freezing Ratio: [Stage2] 0.75, Threshold: 6.9131e-01
[rank1]:2025-12-27 00:00:37,060 - Freezing Ratio: [Stage1] 0.80, Threshold: 7.9117e-01
[rank0]:2025-12-27 00:00:37,075 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1064e+00
[rank3]:2025-12-27 00:00:37,075 - Freezing Ratio: [Stage3] 0.62, Threshold: 7.4746e-01
[rank3]:2025-12-27 00:01:22,120 - Freezing Ratio: [Stage3] 0.62, Threshold: 4.3006e-01
[rank2]:2025-12-27 00:01:22,105 - Freezing Ratio: [Stage2] 0.75, Threshold: 7.7535e-01
[rank1]:2025-12-27 00:01:22,105 - Freezing Ratio: [Stage1] 0.80, Threshold: 8.9395e-01
[rank0]:2025-12-27 00:01:22,120 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.5744e+00
[rank2]:2025-12-27 00:01:49,296 - Avg. fwd time: 8.1815 / Avg. bwd time: 13.6685 / Avg. batch time: 510.3058 (ms) / GPU bubble ratio: 65.75%
[rank1]:2025-12-27 00:01:49,321 - Avg. fwd time: 10.0767 / Avg. bwd time: 17.9148 / Avg. batch time: 542.6360 (ms) / GPU bubble ratio: 58.73%
[rank0]:2025-12-27 00:01:49,349 - Avg. fwd time: 8.4084 / Avg. bwd time: 19.2217 / Avg. batch time: 574.9018 (ms) / GPU bubble ratio: 61.55%
[rank3]:2025-12-27 00:01:49,273 - Avg. fwd time: 14.0634 / Avg. bwd time: 38.5661 / Avg. batch time: 484.4002 (ms) / GPU bubble ratio: 13.08%
[rank2]:2025-12-27 00:02:07,335 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.4553e+00
[rank1]:2025-12-27 00:02:07,336 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.4527e+00
[rank0]:2025-12-27 00:02:07,351 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1137e+00
[rank3]:2025-12-27 00:02:07,351 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.3811e+00
[rank2]:2025-12-27 00:02:52,665 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.3510e+00
[rank1]:2025-12-27 00:02:52,665 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.2224e+00
[rank0]:2025-12-27 00:02:52,680 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.0671e+00
[rank3]:2025-12-27 00:02:52,681 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.0413e+00
[rank2]:2025-12-27 00:03:38,030 - Freezing Ratio: [Stage2] 0.75, Threshold: 2.0872e+00
[rank1]:2025-12-27 00:03:38,030 - Freezing Ratio: [Stage1] 0.80, Threshold: 7.1943e-01
[rank0]:2025-12-27 00:03:38,038 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-27 00:03:38,045 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.5299e+00
[rank3]:2025-12-27 00:03:38,045 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.7219e+00
[rank3]:2025-12-27 00:03:42,502 - Avg. fwd time: 14.0731 / Avg. bwd time: 38.4886 / Avg. batch time: 483.8569 (ms) / GPU bubble ratio: 13.10%
[rank2]:2025-12-27 00:03:42,526 - Avg. fwd time: 8.1925 / Avg. bwd time: 13.5873 / Avg. batch time: 509.6770 (ms) / GPU bubble ratio: 65.81%
[rank1]:2025-12-27 00:03:42,551 - Avg. fwd time: 10.0971 / Avg. bwd time: 17.7473 / Avg. batch time: 541.8389 (ms) / GPU bubble ratio: 58.89%
[rank0]:2025-12-27 00:03:42,579 - Avg. fwd time: 8.4213 / Avg. bwd time: 19.1199 / Avg. batch time: 574.0018 (ms) / GPU bubble ratio: 61.62%
[rank0]:2025-12-27 00:03:42,602 -  step: 650  loss: -8.0000  grad_norm:  0.0691  memory: 13.42GiB(28.26%)  tps: 7,234  tflops: 56.55  mfu: 18.12%
[rank3]:2025-12-27 00:03:42,604 -  step: 650  loss:  0.2448  grad_norm:  0.0691  memory: 16.39GiB(34.50%)  tps: 7,234  tflops: 56.55  mfu: 18.12%
[rank2]:2025-12-27 00:03:42,588 -  step: 650  loss: -8.0000  grad_norm:  0.0691  memory:  6.98GiB(14.69%)  tps: 7,234  tflops: 56.55  mfu: 18.12%
[rank1]:2025-12-27 00:03:42,588 -  step: 650  loss: -8.0000  grad_norm:  0.0691  memory:  9.50GiB(19.99%)  tps: 7,234  tflops: 56.55  mfu: 18.12%
[rank2]:2025-12-27 00:04:23,276 - Freezing Ratio: [Stage2] 0.75, Threshold: 2.2216e+00
[rank1]:2025-12-27 00:04:23,276 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.2750e+00
[rank0]:2025-12-27 00:04:23,292 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.9979e+00
[rank3]:2025-12-27 00:04:23,292 - Freezing Ratio: [Stage3] 0.62, Threshold: 2.6302e+00
[rank2]:2025-12-27 00:05:08,387 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.8859e+00
[rank1]:2025-12-27 00:05:08,387 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.6553e+00
[rank0]:2025-12-27 00:05:08,402 - Freezing Ratio: [Stage0] 0.73, Threshold: 2.3435e+00
[rank3]:2025-12-27 00:05:08,403 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.7586e+00
[rank3]:2025-12-27 00:05:35,511 - Avg. fwd time: 14.0809 / Avg. bwd time: 38.4132 / Avg. batch time: 483.3147 (ms) / GPU bubble ratio: 13.11%
[rank2]:2025-12-27 00:05:35,534 - Avg. fwd time: 8.2025 / Avg. bwd time: 13.5119 / Avg. batch time: 509.0551 (ms) / GPU bubble ratio: 65.87%
[rank1]:2025-12-27 00:05:35,560 - Avg. fwd time: 10.1158 / Avg. bwd time: 17.5921 / Avg. batch time: 541.0613 (ms) / GPU bubble ratio: 59.03%
[rank0]:2025-12-27 00:05:35,589 - Avg. fwd time: 8.4333 / Avg. bwd time: 19.0255 / Avg. batch time: 573.1293 (ms) / GPU bubble ratio: 61.67%
[rank2]:2025-12-27 00:05:53,594 - Freezing Ratio: [Stage2] 0.75, Threshold: 2.4299e+00
[rank1]:2025-12-27 00:05:53,594 - Freezing Ratio: [Stage1] 0.80, Threshold: 2.6146e+00
[rank0]:2025-12-27 00:05:53,610 - Freezing Ratio: [Stage0] 0.73, Threshold: 2.8160e+00
[rank3]:2025-12-27 00:05:53,610 - Freezing Ratio: [Stage3] 0.62, Threshold: 2.3069e+00
[rank2]:2025-12-27 00:06:38,796 - Freezing Ratio: [Stage2] 0.75, Threshold: 3.4956e-01
[rank1]:2025-12-27 00:06:38,796 - Freezing Ratio: [Stage1] 0.80, Threshold: 3.9895e-01
[rank3]:2025-12-27 00:06:38,812 - Freezing Ratio: [Stage3] 0.62, Threshold: 3.5388e-01
[rank0]:2025-12-27 00:06:38,811 - Freezing Ratio: [Stage0] 0.73, Threshold: 7.6349e-01
[rank2]:2025-12-27 00:07:23,828 - Freezing Ratio: [Stage2] 0.75, Threshold: 4.5856e+00
[rank1]:2025-12-27 00:07:23,828 - Freezing Ratio: [Stage1] 0.80, Threshold: 4.5399e+00
[rank3]:2025-12-27 00:07:23,843 - Freezing Ratio: [Stage3] 0.62, Threshold: 4.7522e+00
[rank0]:2025-12-27 00:07:23,827 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-27 00:07:23,843 - Freezing Ratio: [Stage0] 0.73, Threshold: 3.4700e+00
[rank3]:2025-12-27 00:07:28,281 - Avg. fwd time: 14.0882 / Avg. bwd time: 38.3376 / Avg. batch time: 482.7672 (ms) / GPU bubble ratio: 13.12%
[rank2]:2025-12-27 00:07:28,305 - Avg. fwd time: 8.2115 / Avg. bwd time: 13.4415 / Avg. batch time: 508.4332 (ms) / GPU bubble ratio: 65.93%
[rank1]:2025-12-27 00:07:28,331 - Avg. fwd time: 10.1330 / Avg. bwd time: 17.4476 / Avg. batch time: 540.2941 (ms) / GPU bubble ratio: 59.16%
[rank1]:2025-12-27 00:07:28,369 -  step: 700  loss: -8.0000  grad_norm:  0.1998  memory:  9.50GiB(19.99%)  tps: 7,257  tflops: 56.73  mfu: 18.18%
[rank3]:2025-12-27 00:07:28,385 -  step: 700  loss:  0.2079  grad_norm:  0.1998  memory: 16.39GiB(34.50%)  tps: 7,257  tflops: 56.73  mfu: 18.18%
[rank0]:2025-12-27 00:07:28,360 - Avg. fwd time: 8.4440 / Avg. bwd time: 18.9375 / Avg. batch time: 572.2736 (ms) / GPU bubble ratio: 61.72%
[rank0]:2025-12-27 00:07:28,383 -  step: 700  loss: -8.0000  grad_norm:  0.1998  memory: 13.42GiB(28.26%)  tps: 7,257  tflops: 56.73  mfu: 18.18%
[rank2]:2025-12-27 00:07:28,369 -  step: 700  loss: -8.0000  grad_norm:  0.1998  memory:  6.98GiB(14.69%)  tps: 7,257  tflops: 56.73  mfu: 18.18%
[rank2]:2025-12-27 00:07:28,441 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p40_42_dm1/frozen_ratio_history/rank2/251227_0007_stage2_step700.svg
[rank1]:2025-12-27 00:07:28,441 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p40_42_dm1/frozen_ratio_history/rank1/251227_0007_stage1_step700.svg
[rank0]:2025-12-27 00:07:28,440 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p40_42_dm1/frozen_ratio_history/rank0/251227_0007_stage0_step700.svg
[rank3]:2025-12-27 00:07:28,526 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p40_42_dm1/pipeline_schedule/251227_0007_step700_rank3.svg
[rank3]:			> Batch Time: 547.58 ms, GPU Bubble Ratio: 62.93%, 64.70%, 70.75%, 26.09%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-36ms      | [S0,MB0,B]  122-16-138ms   | [S0,MB4,F]  138-8-147ms    | [S0,MB1,B]  176-16-193ms   | [S0,MB5,F]  193-8-201ms    | [S0,MB2,B]  233-16-249ms   | [S0,MB6,F]  249-8-258ms    | [S0,MB3,B]  292-16-309ms   | [S0,MB7,F]  309-8-317ms    | [S0,MB4,B]  353-16-370ms   | [S0,MB5,B]  412-16-429ms   | [S0,MB6,B]  471-16-487ms   | [S0,MB7,B]  531-16-547ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-10-20ms      | [S1,MB1,F]  23-10-34ms     | [S1,MB2,F]  37-10-48ms     | [S1,MB0,B]  103-13-116ms   | [S1,MB3,F]  120-10-130ms   | [S1,MB1,B]  157-13-171ms   | [S1,MB4,F]  174-10-185ms   | [S1,MB2,B]  214-13-228ms   | [S1,MB5,F]  231-10-242ms   | [S1,MB3,B]  274-13-287ms   | [S1,MB6,F]  291-10-301ms   | [S1,MB4,B]  334-13-348ms   | [S1,MB7,F]  352-10-362ms   | [S1,MB5,B]  395-13-409ms   | [S1,MB6,B]  454-13-467ms   | [S1,MB7,B]  514-13-527ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  34-8-42ms      | [S2,MB0,B]  86-11-98ms     | [S2,MB2,F]  101-8-110ms    | [S2,MB1,B]  141-11-152ms   | [S2,MB3,F]  156-8-164ms    | [S2,MB2,B]  197-11-209ms   | [S2,MB4,F]  212-8-221ms    | [S2,MB3,B]  257-11-269ms   | [S2,MB5,F]  272-8-280ms    | [S2,MB4,B]  318-11-329ms   | [S2,MB6,F]  333-8-341ms    | [S2,MB5,B]  379-11-390ms   | [S2,MB7,F]  394-8-402ms    | [S2,MB6,B]  439-11-451ms   | [S2,MB7,B]  499-11-510ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  48-34-82ms     | [S3,MB1,F]  84-11-96ms     | [S3,MB1,B]  102-35-137ms   | [S3,MB2,F]  139-12-152ms   | [S3,MB2,B]  158-35-194ms   | [S3,MB3,F]  196-14-211ms   | [S3,MB3,B]  217-36-253ms   | [S3,MB4,F]  255-15-271ms   | [S3,MB4,B]  277-36-314ms   | [S3,MB5,F]  316-15-332ms   | [S3,MB5,B]  337-37-375ms   | [S3,MB6,F]  377-15-392ms   | [S3,MB6,B]  398-37-435ms   | [S3,MB7,F]  437-14-452ms   | [S3,MB7,B]  458-37-496ms  
[rank3]:2025-12-27 00:07:28,574 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p40_42_dm1/frozen_ratio_history/rank3/251227_0007_stage3_step700.svg
[rank0]:2025-12-27 00:07:28,597 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p40_42_dm1/frozen_params_histogram/251227_0007_rank0_stage0.svg
[rank0]:	> Counts Sum: 1386, Total Sum: 2405 (57.63%), Ratio(%) per element: [0.0, 90.76, 90.76, 90.76, 90.76, 90.76, 90.76, 90.76, 90.76, 90.76, 76.92, 76.92, 76.92, 76.92, 76.92, 76.92, 76.92, 76.92, 76.92, 69.23, 69.23, 69.23, 69.23, 69.23, 69.23, 69.23, 69.23, 69.23, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-12-27 00:07:28,592 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p40_42_dm1/frozen_params_histogram/251227_0007_rank2_stage2.svg
[rank2]:	> Counts Sum: 1494, Total Sum: 2340 (63.85%), Ratio(%) per element: [90.76, 90.76, 90.76, 90.76, 90.76, 90.76, 90.76, 90.76, 90.76, 89.23, 89.23, 89.23, 89.23, 89.23, 89.23, 89.23, 89.23, 89.23, 75.38, 75.38, 75.38, 75.38, 75.38, 75.38, 75.38, 75.38, 75.38, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-12-27 00:07:28,584 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p40_42_dm1/frozen_params_histogram/251227_0007_rank1_stage1.svg
[rank1]:	> Counts Sum: 1692, Total Sum: 2925 (57.85%), Ratio(%) per element: [81.53, 81.53, 81.53, 81.53, 81.53, 81.53, 81.53, 81.53, 81.53, 81.53, 81.53, 81.53, 81.53, 81.53, 81.53, 81.53, 81.53, 81.53, 69.23, 69.23, 69.23, 69.23, 69.23, 69.23, 69.23, 69.23, 69.23, 56.92, 56.92, 56.92, 56.92, 56.92, 56.92, 56.92, 56.92, 56.92, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-27 00:07:28,707 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p40_42_dm1/frozen_params_histogram/251227_0007_rank3_stage3.svg
[rank3]:	> Counts Sum: 900, Total Sum: 1885 (47.75%), Ratio(%) per element: [84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 84.61, 69.23, 69.23, 69.23, 69.23, 69.23, 69.23, 69.23, 69.23, 69.23, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-12-27 00:08:09,156 - Freezing Ratio: [Stage2] 0.75, Threshold: 3.9520e-01
[rank1]:2025-12-27 00:08:09,156 - Freezing Ratio: [Stage1] 0.80, Threshold: 6.8918e-01
[rank3]:2025-12-27 00:08:09,172 - Freezing Ratio: [Stage3] 0.62, Threshold: 6.0074e-01
[rank0]:2025-12-27 00:08:09,171 - Freezing Ratio: [Stage0] 0.73, Threshold: 9.8183e-01
[rank1]:2025-12-27 00:08:54,279 - Freezing Ratio: [Stage1] 0.80, Threshold: 3.5539e-01
[rank0]:2025-12-27 00:08:54,294 - Freezing Ratio: [Stage0] 0.73, Threshold: 3.7216e-01
[rank3]:2025-12-27 00:08:54,295 - Freezing Ratio: [Stage3] 0.62, Threshold: 6.6938e-01
[rank2]:2025-12-27 00:08:54,279 - Freezing Ratio: [Stage2] 0.75, Threshold: 2.2605e-01
[rank2]:2025-12-27 00:09:21,314 - Avg. fwd time: 8.2199 / Avg. bwd time: 13.3760 / Avg. batch time: 507.8705 (ms) / GPU bubble ratio: 65.98%
[rank3]:2025-12-27 00:09:21,290 - Avg. fwd time: 14.0945 / Avg. bwd time: 38.2680 / Avg. batch time: 482.2606 (ms) / GPU bubble ratio: 13.14%
[rank1]:2025-12-27 00:09:21,340 - Avg. fwd time: 10.1489 / Avg. bwd time: 17.3131 / Avg. batch time: 539.5963 (ms) / GPU bubble ratio: 59.29%
[rank0]:2025-12-27 00:09:21,369 - Avg. fwd time: 8.4542 / Avg. bwd time: 18.8555 / Avg. batch time: 571.4945 (ms) / GPU bubble ratio: 61.77%
[rank2]:2025-12-27 00:09:39,510 - Freezing Ratio: [Stage2] 0.75, Threshold: 5.6972e-01
[rank1]:2025-12-27 00:09:39,510 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.4416e+00
[rank3]:2025-12-27 00:09:39,525 - Freezing Ratio: [Stage3] 0.62, Threshold: 6.4619e-01
[rank0]:2025-12-27 00:09:39,525 - Freezing Ratio: [Stage0] 0.73, Threshold: 9.7279e-01
[rank2]:2025-12-27 00:10:24,597 - Freezing Ratio: [Stage2] 0.75, Threshold: 2.3404e+00
[rank3]:2025-12-27 00:10:24,612 - Freezing Ratio: [Stage3] 0.62, Threshold: 2.4317e+00
[rank0]:2025-12-27 00:10:24,612 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.3296e+00
[rank1]:2025-12-27 00:10:24,597 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.2690e+00
[rank0]:2025-12-27 00:11:09,772 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-27 00:11:09,780 - Freezing Ratio: [Stage0] 0.73, Threshold: 5.3791e-01
[rank3]:2025-12-27 00:11:09,780 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.8506e+00
[rank1]:2025-12-27 00:11:09,764 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.6127e+00
[rank2]:2025-12-27 00:11:09,764 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.6398e+00
[rank3]:2025-12-27 00:11:14,254 - Avg. fwd time: 14.1007 / Avg. bwd time: 38.2068 / Avg. batch time: 481.8208 (ms) / GPU bubble ratio: 13.15%
[rank1]:2025-12-27 00:11:14,305 - Avg. fwd time: 10.1640 / Avg. bwd time: 17.1877 / Avg. batch time: 538.9660 (ms) / GPU bubble ratio: 59.40%
[rank1]:2025-12-27 00:11:14,343 -  step: 750  loss: -8.0000  grad_norm:  0.1236  memory:  9.50GiB(19.99%)  tps: 7,250  tflops: 56.68  mfu: 18.17%
[rank2]:2025-12-27 00:11:14,279 - Avg. fwd time: 8.2280 / Avg. bwd time: 13.3150 / Avg. batch time: 507.3662 (ms) / GPU bubble ratio: 66.03%
[rank2]:2025-12-27 00:11:14,343 -  step: 750  loss: -8.0000  grad_norm:  0.1236  memory:  6.98GiB(14.69%)  tps: 7,250  tflops: 56.68  mfu: 18.17%
[rank0]:2025-12-27 00:11:14,334 - Avg. fwd time: 8.4636 / Avg. bwd time: 18.7791 / Avg. batch time: 570.7869 (ms) / GPU bubble ratio: 61.82%
[rank0]:2025-12-27 00:11:14,357 -  step: 750  loss: -8.0000  grad_norm:  0.1236  memory: 13.42GiB(28.26%)  tps: 7,250  tflops: 56.68  mfu: 18.17%
[rank3]:2025-12-27 00:11:14,359 -  step: 750  loss:  0.2554  grad_norm:  0.1236  memory: 16.39GiB(34.50%)  tps: 7,250  tflops: 56.68  mfu: 18.17%
[rank3]:2025-12-27 00:11:55,065 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.5159e+00
[rank1]:2025-12-27 00:11:55,049 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.2849e+00
[rank2]:2025-12-27 00:11:55,049 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.1506e+00
[rank0]:2025-12-27 00:11:55,065 - Freezing Ratio: [Stage0] 0.73, Threshold: 6.6230e-01
[rank2]:2025-12-27 00:12:40,276 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.6550e+00
[rank0]:2025-12-27 00:12:40,292 - Freezing Ratio: [Stage0] 0.73, Threshold: 8.1705e-01
[rank3]:2025-12-27 00:12:40,292 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.5297e+00
[rank1]:2025-12-27 00:12:40,276 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.8850e+00
[rank3]:2025-12-27 00:13:07,313 - Avg. fwd time: 14.1072 / Avg. bwd time: 38.1503 / Avg. batch time: 481.4200 (ms) / GPU bubble ratio: 13.16%
[rank1]:2025-12-27 00:13:07,365 - Avg. fwd time: 10.1783 / Avg. bwd time: 17.0705 / Avg. batch time: 538.3877 (ms) / GPU bubble ratio: 59.51%
[rank2]:2025-12-27 00:13:07,338 - Avg. fwd time: 8.2356 / Avg. bwd time: 13.2579 / Avg. batch time: 506.9051 (ms) / GPU bubble ratio: 66.08%
[rank0]:2025-12-27 00:13:07,394 - Avg. fwd time: 8.4725 / Avg. bwd time: 18.7077 / Avg. batch time: 570.1372 (ms) / GPU bubble ratio: 61.86%
[rank0]:2025-12-27 00:13:25,559 - Freezing Ratio: [Stage0] 0.73, Threshold: 3.0164e+00
[rank3]:2025-12-27 00:13:25,560 - Freezing Ratio: [Stage3] 0.62, Threshold: 2.7929e+00
[rank1]:2025-12-27 00:13:25,544 - Freezing Ratio: [Stage1] 0.80, Threshold: 3.5594e+00
[rank2]:2025-12-27 00:13:25,544 - Freezing Ratio: [Stage2] 0.75, Threshold: 3.4053e+00
[rank1]:2025-12-27 00:14:10,771 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.0698e+00
[rank2]:2025-12-27 00:14:10,771 - Freezing Ratio: [Stage2] 0.75, Threshold: 7.0398e-01
[rank0]:2025-12-27 00:14:10,787 - Freezing Ratio: [Stage0] 0.73, Threshold: 4.7200e-01
[rank3]:2025-12-27 00:14:10,787 - Freezing Ratio: [Stage3] 0.62, Threshold: 5.4897e-01
[rank1]:2025-12-27 00:14:56,018 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.7905e+00
[rank2]:2025-12-27 00:14:56,018 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.7303e+00
[rank0]:2025-12-27 00:14:56,017 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-27 00:14:56,034 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1736e+00
[rank3]:2025-12-27 00:14:56,034 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.4426e+00
[rank3]:2025-12-27 00:15:00,595 - Avg. fwd time: 14.1155 / Avg. bwd time: 38.0984 / Avg. batch time: 481.0721 (ms) / GPU bubble ratio: 13.17%
[rank1]:2025-12-27 00:15:00,647 - Avg. fwd time: 10.1919 / Avg. bwd time: 16.9607 / Avg. batch time: 537.8750 (ms) / GPU bubble ratio: 59.62%
[rank2]:2025-12-27 00:15:00,621 - Avg. fwd time: 8.2428 / Avg. bwd time: 13.2046 / Avg. batch time: 506.5016 (ms) / GPU bubble ratio: 66.12%
[rank0]:2025-12-27 00:15:00,677 - Avg. fwd time: 8.4812 / Avg. bwd time: 18.6409 / Avg. batch time: 569.5593 (ms) / GPU bubble ratio: 61.90%
[rank3]:2025-12-27 00:15:00,702 -  step: 800  loss:  0.2571  grad_norm:  0.5791  memory: 16.39GiB(34.50%)  tps: 7,239  tflops: 56.59  mfu: 18.14%
[rank3]:2025-12-27 00:15:00,703 - â„¹ï¸ final step: 800  loss:  0.2571  grad_norm:  0.5791  tps: 7,434  tflops: 58.11  mfu: 17.12%
[rank3]:2025-12-27 00:15:00,704 - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-12-27 00:15:00,704 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank1]:2025-12-27 00:15:00,686 -  step: 800  loss: -8.0000  grad_norm:  0.5791  memory:  9.50GiB(19.99%)  tps: 7,239  tflops: 56.59  mfu: 18.14%
[rank1]:2025-12-27 00:15:00,686 - â„¹ï¸ final step: 800  loss: -8.0000  grad_norm:  0.5791  tps: 7,429  tflops: 58.08  mfu: 17.00%
[rank1]:2025-12-27 00:15:00,686 - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-12-27 00:15:00,687 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank2]:2025-12-27 00:15:00,686 -  step: 800  loss: -8.0000  grad_norm:  0.5791  memory:  6.98GiB(14.69%)  tps: 7,239  tflops: 56.59  mfu: 18.14%
[rank2]:2025-12-27 00:15:00,686 - â„¹ï¸ final step: 800  loss: -8.0000  grad_norm:  0.5791  tps: 7,429  tflops: 58.08  mfu: 17.00%
[rank2]:2025-12-27 00:15:00,686 - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-12-27 00:15:00,687 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-27 00:15:00,700 -  step: 800  loss: -8.0000  grad_norm:  0.5791  memory: 13.42GiB(28.26%)  tps: 7,239  tflops: 56.59  mfu: 18.14%
[rank0]:2025-12-27 00:15:00,700 - â„¹ï¸ final step: 800  loss: -8.0000  grad_norm:  0.5791  tps: 7,430  tflops: 58.08  mfu: 17.01%
[rank0]:2025-12-27 00:15:00,701 - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-12-27 00:15:00,701 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-27 00:15:02,506 - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-12-27 00:15:02,579 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p40_42_dm1/frozen_ratio_history/rank0/251227_0015_stage0_final800.svg
[rank1]:2025-12-27 00:15:02,580 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p40_42_dm1/frozen_ratio_history/rank1/251227_0015_stage1_final800.svg
[rank2]:2025-12-27 00:15:02,579 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p40_42_dm1/frozen_ratio_history/rank2/251227_0015_stage2_final800.svg
[rank3]:2025-12-27 00:15:02,663 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p40_42_dm1/pipeline_schedule/251227_0015_final800_rank3.svg
[rank3]:			> Batch Time: 553.61 ms, GPU Bubble Ratio: 63.36%, 65.14%, 71.08%, 26.48%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-9-18ms       | [S0,MB2,F]  18-9-27ms      | [S0,MB3,F]  27-8-36ms      | [S0,MB0,B]  122-16-139ms   | [S0,MB4,F]  139-8-147ms    | [S0,MB1,B]  179-16-196ms   | [S0,MB5,F]  196-8-204ms    | [S0,MB2,B]  237-16-254ms   | [S0,MB6,F]  254-8-262ms    | [S0,MB3,B]  297-16-314ms   | [S0,MB7,F]  314-8-322ms    | [S0,MB4,B]  357-16-374ms   | [S0,MB5,B]  416-16-433ms   | [S0,MB6,B]  475-16-492ms   | [S0,MB7,B]  537-16-553ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-10-34ms     | [S1,MB2,F]  37-10-47ms     | [S1,MB0,B]  103-13-117ms   | [S1,MB3,F]  121-10-131ms   | [S1,MB1,B]  160-13-173ms   | [S1,MB4,F]  178-10-188ms   | [S1,MB2,B]  218-13-232ms   | [S1,MB5,F]  236-10-246ms   | [S1,MB3,B]  278-13-291ms   | [S1,MB6,F]  295-10-306ms   | [S1,MB4,B]  338-13-352ms   | [S1,MB7,F]  356-10-366ms   | [S1,MB5,B]  399-13-412ms   | [S1,MB6,B]  458-13-471ms   | [S1,MB7,B]  518-13-532ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  34-8-42ms      | [S2,MB0,B]  86-11-98ms     | [S2,MB2,F]  102-8-110ms    | [S2,MB1,B]  143-11-155ms   | [S2,MB3,F]  158-8-166ms    | [S2,MB2,B]  201-11-213ms   | [S2,MB4,F]  216-8-225ms    | [S2,MB3,B]  261-11-272ms   | [S2,MB5,F]  276-8-284ms    | [S2,MB4,B]  321-11-333ms   | [S2,MB6,F]  336-8-345ms    | [S2,MB5,B]  382-11-394ms   | [S2,MB7,F]  397-8-405ms    | [S2,MB6,B]  443-11-454ms   | [S2,MB7,B]  503-11-515ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  48-34-83ms     | [S3,MB1,F]  85-11-97ms     | [S3,MB1,B]  103-35-139ms   | [S3,MB2,F]  141-13-155ms   | [S3,MB2,B]  161-36-197ms   | [S3,MB3,F]  200-14-214ms   | [S3,MB3,B]  220-37-257ms   | [S3,MB4,F]  259-15-274ms   | [S3,MB4,B]  280-37-317ms   | [S3,MB5,F]  320-15-335ms   | [S3,MB5,B]  340-37-378ms   | [S3,MB6,F]  380-14-395ms   | [S3,MB6,B]  401-37-439ms   | [S3,MB7,F]  441-14-456ms   | [S3,MB7,B]  462-37-500ms  
[rank1]:2025-12-27 00:15:02,724 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p40_42_dm1/frozen_params_histogram/251227_0015_rank1_stage1.svg
[rank1]:	> Counts Sum: 2052, Total Sum: 3375 (60.80%), Ratio(%) per element: [84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 62.66, 62.66, 62.66, 62.66, 62.66, 62.66, 62.66, 62.66, 62.66, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-12-27 00:15:02,724 - Destroying the purge thread.
[rank2]:2025-12-27 00:15:02,730 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p40_42_dm1/frozen_params_histogram/251227_0015_rank2_stage2.svg
[rank2]:	> Counts Sum: 1764, Total Sum: 2700 (65.33%), Ratio(%) per element: [92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 90.66, 90.66, 90.66, 90.66, 90.66, 90.66, 90.66, 90.66, 90.66, 78.66, 78.66, 78.66, 78.66, 78.66, 78.66, 78.66, 78.66, 78.66, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-12-27 00:15:02,730 - Destroying the purge thread.
[rank0]:2025-12-27 00:15:02,731 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p40_42_dm1/frozen_params_histogram/251227_0015_rank0_stage0.svg
[rank0]:	> Counts Sum: 1656, Total Sum: 2775 (59.68%), Ratio(%) per element: [0.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-12-27 00:15:02,731 - Sleeping 2 seconds for other ranks to complete
[rank3]:2025-12-27 00:15:02,794 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p40_42_dm1/pipeline_schedule/251227_0015_thry_final800_rank3.svg
[rank3]:			> Batch Time: 343.69 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-10-10ms      | [S0,MB1,F]  10-10-20ms     | [S0,MB2,F]  20-10-31ms     | [S0,MB3,F]  31-10-41ms     | [S0,MB0,B]  104-20-124ms   | [S0,MB4,F]  124-10-135ms   | [S0,MB1,B]  135-20-156ms   | [S0,MB5,F]  156-10-166ms   | [S0,MB2,B]  166-20-187ms   | [S0,MB6,F]  187-10-197ms   | [S0,MB3,B]  197-20-218ms   | [S0,MB7,F]  218-10-229ms   | [S0,MB4,B]  229-20-249ms   | [S0,MB5,B]  260-20-281ms   | [S0,MB6,B]  291-20-312ms   | [S0,MB7,B]  322-20-343ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  10-10-20ms     | [S1,MB1,F]  20-10-31ms     | [S1,MB2,F]  31-10-41ms     | [S1,MB0,B]  83-20-104ms    | [S1,MB3,F]  104-10-114ms   | [S1,MB1,B]  114-20-135ms   | [S1,MB4,F]  135-10-145ms   | [S1,MB2,B]  145-20-166ms   | [S1,MB5,F]  166-10-177ms   | [S1,MB3,B]  177-20-197ms   | [S1,MB6,F]  197-10-208ms   | [S1,MB4,B]  208-20-229ms   | [S1,MB7,F]  229-10-239ms   | [S1,MB5,B]  239-20-260ms   | [S1,MB6,B]  270-20-291ms   | [S1,MB7,B]  302-20-322ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-10-31ms     | [S2,MB1,F]  31-10-41ms     | [S2,MB0,B]  62-20-83ms     | [S2,MB2,F]  83-10-93ms     | [S2,MB1,B]  93-20-114ms    | [S2,MB3,F]  114-10-124ms   | [S2,MB2,B]  124-20-145ms   | [S2,MB4,F]  145-10-156ms   | [S2,MB3,B]  156-20-177ms   | [S2,MB5,F]  177-10-187ms   | [S2,MB4,B]  187-20-208ms   | [S2,MB6,F]  208-10-218ms   | [S2,MB5,B]  218-20-239ms   | [S2,MB7,F]  239-10-249ms   | [S2,MB6,B]  249-20-270ms   | [S2,MB7,B]  281-20-302ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  31-10-41ms     | [S3,MB0,B]  41-20-62ms     | [S3,MB1,F]  62-10-72ms     | [S3,MB1,B]  72-20-93ms     | [S3,MB2,F]  93-10-104ms    | [S3,MB2,B]  104-20-124ms   | [S3,MB3,F]  124-10-135ms   | [S3,MB3,B]  135-20-156ms   | [S3,MB4,F]  156-10-166ms   | [S3,MB4,B]  166-20-187ms   | [S3,MB5,F]  187-10-197ms   | [S3,MB5,B]  197-20-218ms   | [S3,MB6,F]  218-10-229ms   | [S3,MB6,B]  229-20-249ms   | [S3,MB7,F]  249-10-260ms   | [S3,MB7,B]  260-20-281ms  
[rank3]:2025-12-27 00:15:02,843 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p40_42_dm1/frozen_ratio_history/rank3/251227_0015_stage3_final800.svg
[rank2]:2025-12-27 00:15:02,959 - Process group destroyed
[rank3]:2025-12-27 00:15:02,972 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p40_42_dm1/frozen_params_histogram/251227_0015_rank3_stage3.svg
[rank3]:	> Counts Sum: 1080, Total Sum: 2175 (49.66%), Ratio(%) per element: [86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-27 00:15:02,973 - Destroying the purge thread.
[rank1]:2025-12-27 00:15:03,001 - Process group destroyed
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading history steps 15-16, summary, console lines 362-383
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–ˆâ–†â–ƒâ–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–ˆâ–†â–ƒâ–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 4.40796
[rank3]:wandb:               final/avg_loss 0.25708
[rank3]:wandb:             final/avg_mfu(%) 17.11838
[rank3]:wandb:             final/avg_tflops 58.11419
[rank3]:wandb:    final/avg_throughput(tps) 7433.82055
[rank3]:wandb:              final/grad_norm 0.57908
[rank3]:wandb:               final/max_loss 0.25708
[rank3]:wandb:                    grad_norm 0.57908
[rank3]:wandb: loss_metrics/global_avg_loss 0.25708
[rank3]:wandb: loss_metrics/global_max_loss 0.25708
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1226_1F1B_auto_p40_42_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/sa23o3p1
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1226_1F1B_auto_p40_42_dm1/20251226-2312/wandb/run-20251226_231232-sa23o3p1/logs
[rank3]:2025-12-27 00:15:04,419 - Process group destroyed
[rank0]:2025-12-27 00:15:04,732 - Training completed
[rank0]:2025-12-27 00:15:04,732 - Destroying the purge thread.
[rank0]:2025-12-27 00:15:04,977 - Process group destroyed
[rank1]:Stage 1: Modules to keep: {'layers.7', 'layers.8', 'layers.5', 'layers.4', 'layers.6'}
[rank2]:Stage 2: Modules to keep: {'layers.12', 'layers.10', 'layers.11', 'layers.9'}
[rank0]:Stage 0: Modules to keep: {'tok_embeddings', 'layers.2', 'layers.3', 'layers.1', 'layers.0'}
[rank3]:Stage 3: Modules to keep: {'layers.14', 'layers.15', 'norm', 'layers.13', 'output'}
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1116_autofreeze/config_1226.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "AutoFreeze configuration experiment on different PERCENTILE values."
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1226_1F1B_auto_p40_42_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1226_1F1B_auto_p40_42_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1226_1F1B_auto_p40_42_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1226_1F1B_auto_p40_42_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1226_1F1B_auto_p40_42_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1226_1F1B_auto_p40_42_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 42
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: 1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1226_1F1B_auto_p40_42_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1226_1F1B_auto_p40_42_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: auto
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.05
[rank3]:		- percentile: 40
[rank3]:
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
