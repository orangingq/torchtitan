
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 11. 28. (ê¸ˆ) 18:17:38 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 1,2,3,4
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1116_autofreeze/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1116_autofreeze/1116_1F1B_auto_p70_42.log
âœ”ï¸AutoFreeze configuration experiment on different PERCENTILE values.
âœ”ï¸Running with autofreeze (percentile=70) x 1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1116_autofreeze/config_1116.toml --job.description="AutoFreeze configuration experiment on different PERCENTILE values." --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=auto --freezing.percentile=70
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank1]:2025-11-28 18:17:45,183 - INFO - Starting job: "AutoFreeze configuration experiment on different PERCENTILE values."
[rank3]:2025-11-28 18:17:45,226 - INFO - Starting job: "AutoFreeze configuration experiment on different PERCENTILE values."
[rank2]:2025-11-28 18:17:45,243 - INFO - Starting job: "AutoFreeze configuration experiment on different PERCENTILE values."
[rank1]:2025-11-28 18:17:45,408 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-11-28 18:17:45,411 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-28 18:17:45,480 - INFO - Starting job: "AutoFreeze configuration experiment on different PERCENTILE values."
[rank3]:2025-11-28 18:17:45,509 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-11-28 18:17:45,512 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-11-28 18:17:45,514 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-11-28 18:17:45,516 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-28 18:17:45,651 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-11-28 18:17:45,655 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-28 18:17:45,660 - INFO - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-11-28 18:17:45,662 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-11-28 18:17:46,053 - INFO - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank0]:2025-11-28 18:17:48,826 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank1]:2025-11-28 18:17:48,912 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-11-28 18:17:48,945 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-11-28 18:17:48,967 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-11-28 18:17:48,968 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank2]:2025-11-28 18:17:48,962 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-11-28 18:17:49,013 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-28 18:17:48,977 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-11-28 18:17:49,017 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-11-28 18:17:49,042 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank0]:2025-11-28 18:17:49,018 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-11-28 18:17:49,042 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-11-28 18:17:49,042 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank2]:2025-11-28 18:17:49,042 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2025-11-28 18:17:49,158 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-11-28 18:17:49,158 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-11-28 18:17:49,158 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank2]:2025-11-28 18:17:49,223 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-11-28 18:17:49,224 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-11-28 18:17:49,224 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank0]:2025-11-28 18:17:49,254 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-28 18:17:49,254 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-11-28 18:17:49,255 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run rjw7qj2i
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1116_1F1B_auto_p70_42_dm1/20251128-1817/wandb/run-20251128_181750-rjw7qj2i
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1116_1F1B_auto_p70_42_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/rjw7qj2i
[rank3]:2025-11-28 18:17:51,647 - INFO - WandB logging enabled
[rank3]:2025-11-28 18:17:51,648 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-11-28 18:17:51,689 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-11-28 18:17:51,718 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-11-28 18:17:51,719 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank3]:2025-11-28 18:17:51,909 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-11-28 18:17:51,910 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-11-28 18:17:51,911 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2025-11-28 18:17:51,927 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-28 18:17:51,927 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1116_1F1B_auto_p70_42_dm1
[rank0]:2025-11-28 18:17:51,928 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-28 18:17:51,928 - INFO - Trainer is initialized with local batch size 16, global batch size 128, gradient accumulation steps 8, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2025-11-28 18:17:51,928 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank2]:2025-11-28 18:17:51,927 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank1]:2025-11-28 18:17:51,927 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-28 18:17:54,391 - INFO - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-11-28 18:17:54,391 - INFO - Finished loading the checkpoint in 2.46 seconds.
[rank0]:2025-11-28 18:17:54,391 - INFO - Training starts at step 1
[rank2]:2025-11-28 18:18:00,017 - INFO -  step:  1  loss: -8.0000  grad_norm: 116.5370  memory:  4.63GiB(9.75%)  tps: 2,978  tflops: 23.28  mfu: 7.46%
[rank2]:2025-11-28 18:18:00,017 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-28 18:18:00,055 - INFO -  step:  1  loss: -8.0000  grad_norm: 116.5370  memory:  9.19GiB(19.34%)  tps: 2,969  tflops: 23.21  mfu: 7.44%
[rank0]:2025-11-28 18:18:00,055 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-11-28 18:18:00,027 - INFO -  step:  1  loss: 10.6088  grad_norm: 116.5370  memory: 12.97GiB(27.31%)  tps: 3,931  tflops: 30.73  mfu: 9.85%
[rank3]:2025-11-28 18:18:00,028 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-11-28 18:18:00,020 - INFO -  step:  1  loss: -8.0000  grad_norm: 116.5370  memory:  6.76GiB(14.24%)  tps: 2,959  tflops: 23.13  mfu: 7.41%
[rank1]:2025-11-28 18:18:00,020 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-11-28 18:20:02,017 - INFO - Avg. fwd time: 7.3750 / Avg. bwd time: 19.1547 / Avg. batch time: 542.1703 (ms) / GPU bubble ratio: 60.85%
[rank3]:2025-11-28 18:20:01,978 - INFO - Avg. fwd time: 13.5241 / Avg. bwd time: 42.2562 / Avg. batch time: 509.9416 (ms) / GPU bubble ratio: 12.49%
[rank0]:2025-11-28 18:20:02,048 - INFO - Avg. fwd time: 7.6544 / Avg. bwd time: 24.1645 / Avg. batch time: 619.2914 (ms) / GPU bubble ratio: 58.90%
[rank1]:2025-11-28 18:20:02,051 - INFO - Avg. fwd time: 9.2632 / Avg. bwd time: 23.8223 / Avg. batch time: 581.2710 (ms) / GPU bubble ratio: 54.46%
[rank0]:2025-11-28 18:22:05,489 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-28 18:22:10,277 - INFO - Avg. fwd time: 13.7233 / Avg. bwd time: 42.6293 / Avg. batch time: 514.3978 (ms) / GPU bubble ratio: 12.36%
[rank0]:2025-11-28 18:22:10,346 - INFO - Avg. fwd time: 7.6760 / Avg. bwd time: 24.2272 / Avg. batch time: 622.5656 (ms) / GPU bubble ratio: 59.00%
[rank2]:2025-11-28 18:22:10,315 - INFO - Avg. fwd time: 7.3894 / Avg. bwd time: 19.2178 / Avg. batch time: 546.2251 (ms) / GPU bubble ratio: 61.03%
[rank1]:2025-11-28 18:22:10,349 - INFO - Avg. fwd time: 9.2836 / Avg. bwd time: 23.9034 / Avg. batch time: 584.9315 (ms) / GPU bubble ratio: 54.61%
[rank2]:2025-11-28 18:22:10,580 - INFO -  step: 50  loss: -8.0000  grad_norm: 14.2158  memory:  6.43GiB(13.53%)  tps: 6,408  tflops: 50.10  mfu: 16.06%
[rank1]:2025-11-28 18:22:10,583 - INFO -  step: 50  loss: -8.0000  grad_norm: 14.2158  memory:  9.03GiB(19.01%)  tps: 6,408  tflops: 50.10  mfu: 16.06%
[rank0]:2025-11-28 18:22:10,594 - INFO -  step: 50  loss: -8.0000  grad_norm: 14.2158  memory: 12.97GiB(27.31%)  tps: 6,409  tflops: 50.10  mfu: 16.06%
[rank3]:2025-11-28 18:22:10,592 - INFO -  step: 50  loss:  9.9179  grad_norm: 14.2158  memory: 16.39GiB(34.50%)  tps: 6,408  tflops: 50.10  mfu: 16.06%
[rank3]:2025-11-28 18:23:01,874 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 0.0000e+00
[rank0]:2025-11-28 18:23:01,878 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 0.0000e+00
[rank2]:2025-11-28 18:23:01,862 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 0.0000e+00
[rank1]:2025-11-28 18:23:01,866 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 0.0000e+00
[rank2]:2025-11-28 18:23:53,323 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.1342e+00
[rank1]:2025-11-28 18:23:53,327 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 3.8521e+00
[rank3]:2025-11-28 18:23:53,334 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 3.4980e+00
[rank0]:2025-11-28 18:23:53,339 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.3621e+00
[rank3]:2025-11-28 18:24:16,739 - INFO - Avg. fwd time: 13.8001 / Avg. bwd time: 42.2913 / Avg. batch time: 512.2658 (ms) / GPU bubble ratio: 12.40%
[rank2]:2025-11-28 18:24:16,757 - INFO - Avg. fwd time: 7.4601 / Avg. bwd time: 18.7146 / Avg. batch time: 543.4449 (ms) / GPU bubble ratio: 61.47%
[rank0]:2025-11-28 18:24:16,817 - INFO - Avg. fwd time: 7.6799 / Avg. bwd time: 24.2557 / Avg. batch time: 619.5708 (ms) / GPU bubble ratio: 58.76%
[rank1]:2025-11-28 18:24:16,787 - INFO - Avg. fwd time: 9.2836 / Avg. bwd time: 23.9388 / Avg. batch time: 582.0411 (ms) / GPU bubble ratio: 54.34%
[rank3]:2025-11-28 18:24:40,265 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 3.7865e+00
[rank0]:2025-11-28 18:24:40,277 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 4.8507e+00
[rank2]:2025-11-28 18:24:40,249 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 4.5258e+00
[rank1]:2025-11-28 18:24:40,265 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 9.3709e-01
[rank1]:2025-11-28 18:25:31,015 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.9458e+00
[rank3]:2025-11-28 18:25:31,023 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 4.4185e+00
[rank0]:2025-11-28 18:25:31,019 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 3.1492e+00
[rank2]:2025-11-28 18:25:31,011 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.2128e-01
[rank0]:2025-11-28 18:26:13,149 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-28 18:26:17,501 - INFO - Avg. fwd time: 13.8562 / Avg. bwd time: 41.6102 / Avg. batch time: 507.2424 (ms) / GPU bubble ratio: 12.52%
[rank1]:2025-11-28 18:26:17,608 - INFO - Avg. fwd time: 9.2955 / Avg. bwd time: 23.9614 / Avg. batch time: 576.0054 (ms) / GPU bubble ratio: 53.81%
[rank2]:2025-11-28 18:26:17,560 - INFO - Avg. fwd time: 7.5837 / Avg. bwd time: 17.8250 / Avg. batch time: 537.4552 (ms) / GPU bubble ratio: 62.18%
[rank0]:2025-11-28 18:26:17,604 - INFO - Avg. fwd time: 7.7558 / Avg. bwd time: 23.7274 / Avg. batch time: 612.9484 (ms) / GPU bubble ratio: 58.91%
[rank2]:2025-11-28 18:26:17,812 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 9.6347e+00
[rank2]:2025-11-28 18:26:17,812 - INFO -  step: 100  loss: -8.0000  grad_norm:  8.2518  memory:  6.43GiB(13.53%)  tps: 6,627  tflops: 51.81  mfu: 16.60%
[rank3]:2025-11-28 18:26:17,827 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 4.1873e+00
[rank1]:2025-11-28 18:26:17,828 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 4.2519e+00
[rank1]:2025-11-28 18:26:17,829 - INFO -  step: 100  loss: -8.0000  grad_norm:  8.2518  memory:  9.03GiB(19.01%)  tps: 6,627  tflops: 51.80  mfu: 16.60%
[rank3]:2025-11-28 18:26:17,830 - INFO -  step: 100  loss:  8.5052  grad_norm:  8.2518  memory: 16.39GiB(34.50%)  tps: 6,627  tflops: 51.81  mfu: 16.60%
[rank0]:2025-11-28 18:26:17,839 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 3.4977e+00
[rank0]:2025-11-28 18:26:17,840 - INFO -  step: 100  loss: -8.0000  grad_norm:  8.2518  memory: 12.97GiB(27.31%)  tps: 6,627  tflops: 51.80  mfu: 16.60%
[rank0]:2025-11-28 18:26:17,926 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p70_42_dm1/frozen_ratio_history/rank0/251128_1826_stage0_step100.svg
[rank1]:2025-11-28 18:26:17,926 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p70_42_dm1/frozen_ratio_history/rank1/251128_1826_stage1_step100.svg
[rank2]:2025-11-28 18:26:17,928 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p70_42_dm1/frozen_ratio_history/rank2/251128_1826_stage2_step100.svg
[rank3]:2025-11-28 18:26:18,016 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p70_42_dm1/pipeline_schedule/251128_1826_real_step100_rank3.svg
[rank3]:			> Batch Time: 566.36 ms, GPU Bubble Ratio: 54.55%, 52.79%, 71.97%, 28.28%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms                       | [S0,MB1,F]  9-7-17ms                      | [S0,MB2,F]  17-7-25ms                     | [S0,MB3,F]  25-7-32ms                     | [S0,MB0,B]  132-24-157ms                  | [S0,MB4,F]  157-7-164ms                   | [S0,MB1,B]  188-24-212ms                  | [S0,MB5,F]  212-7-219ms                   | [S0,MB2,B]  244-24-269ms                  | [S0,MB6,F]  269-7-276ms                   | [S0,MB3,B]  304-24-328ms                  | [S0,MB7,F]  328-7-335ms                   | [S0,MB4,B]  364-24-389ms                  | [S0,MB5,B]  423-24-447ms                  | [S0,MB6,B]  482-24-506ms                  | [S0,MB7,B]  542-24-566ms                 
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms                     | [S1,MB1,F]  23-8-32ms                     | [S1,MB2,F]  35-8-44ms                     | [S1,MB0,B]  103-24-127ms                  | [S1,MB3,F]  130-8-139ms                   | [S1,MB1,B]  158-24-182ms                  | [S1,MB4,F]  186-9-195ms                   | [S1,MB2,B]  215-24-239ms                  | [S1,MB5,F]  243-9-252ms                   | [S1,MB3,B]  274-24-299ms                  | [S1,MB6,F]  302-9-311ms                   | [S1,MB4,B]  335-24-359ms                  | [S1,MB7,F]  363-9-372ms                   | [S1,MB5,B]  396-24-420ms                  | [S1,MB6,B]  454-24-478ms                  | [S1,MB7,B]  514-23-538ms                 
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms                     | [S2,MB1,F]  32-8-41ms                     | [S2,MB0,B]  86-11-98ms                    | [S2,MB2,F]  101-8-110ms                   | [S2,MB1,B]  142-11-153ms                  | [S2,MB3,F]  157-8-165ms                   | [S2,MB2,B]  199-11-210ms                  | [S2,MB4,F]  214-8-222ms                   | [S2,MB3,B]  258-11-269ms                  | [S2,MB5,F]  273-8-281ms                   | [S2,MB4,B]  319-11-330ms                  | [S2,MB6,F]  334-8-342ms                   | [S2,MB5,B]  379-11-391ms                  | [S2,MB7,F]  394-8-402ms                   | [S2,MB6,B]  440-11-451ms                  | [S2,MB7,B]  500-11-511ms                 
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-43ms                    | [S3,MB0,B]  49-33-83ms                    | [S3,MB1,F]  85-11-97ms                    | [S3,MB1,B]  103-35-138ms                  | [S3,MB2,F]  140-13-153ms                  | [S3,MB2,B]  159-36-195ms                  | [S3,MB3,F]  197-14-212ms                  | [S3,MB3,B]  217-36-254ms                  | [S3,MB4,F]  257-15-272ms                  | [S3,MB4,B]  277-37-315ms                  | [S3,MB5,F]  317-15-332ms                  | [S3,MB5,B]  338-37-375ms                  | [S3,MB6,F]  378-15-393ms                  | [S3,MB6,B]  398-37-436ms                  | [S3,MB7,F]  438-14-453ms                  | [S3,MB7,B]  459-37-497ms                 
[rank3]:2025-11-28 18:26:18,062 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p70_42_dm1/frozen_ratio_history/rank3/251128_1826_stage3_step100.svg
[rank2]:2025-11-28 18:27:07,488 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.0546e+00
[rank1]:2025-11-28 18:27:07,492 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 3.1253e+00
[rank0]:2025-11-28 18:27:07,507 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 3.6290e+00
[rank3]:2025-11-28 18:27:07,512 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.5887e+00
[rank2]:2025-11-28 18:27:54,402 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.7563e+00
[rank1]:2025-11-28 18:27:54,418 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.8732e+00
[rank3]:2025-11-28 18:27:54,418 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.8628e+00
[rank0]:2025-11-28 18:27:54,430 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 3.4145e+00
[rank2]:2025-11-28 18:28:18,724 - INFO - Avg. fwd time: 7.7732 / Avg. bwd time: 16.4416 / Avg. batch time: 533.2481 (ms) / GPU bubble ratio: 63.67%
[rank1]:2025-11-28 18:28:18,748 - INFO - Avg. fwd time: 9.4106 / Avg. bwd time: 23.0919 / Avg. batch time: 570.8822 (ms) / GPU bubble ratio: 54.45%
[rank0]:2025-11-28 18:28:18,709 - INFO - Avg. fwd time: 7.8180 / Avg. bwd time: 23.2620 / Avg. batch time: 607.3133 (ms) / GPU bubble ratio: 59.06%
[rank3]:2025-11-28 18:28:18,706 - INFO - Avg. fwd time: 13.8956 / Avg. bwd time: 41.2151 / Avg. batch time: 504.3757 (ms) / GPU bubble ratio: 12.59%
[rank2]:2025-11-28 18:28:43,858 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.3314e+00
[rank1]:2025-11-28 18:28:43,862 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.4986e+00
[rank0]:2025-11-28 18:28:43,877 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 8.4029e+00
[rank3]:2025-11-28 18:28:43,881 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 6.9676e+00
[rank2]:2025-11-28 18:29:30,693 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.3075e+00
[rank1]:2025-11-28 18:29:30,709 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.7098e+00
[rank3]:2025-11-28 18:29:30,709 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 3.1222e+00
[rank0]:2025-11-28 18:29:30,721 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 3.2667e+00
[rank0]:2025-11-28 18:30:15,307 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-11-28 18:30:20,226 - INFO - Avg. fwd time: 7.8965 / Avg. bwd time: 15.5434 / Avg. batch time: 531.4968 (ms) / GPU bubble ratio: 64.72%
[rank3]:2025-11-28 18:30:20,207 - INFO - Avg. fwd time: 13.9262 / Avg. bwd time: 41.0859 / Avg. batch time: 503.5782 (ms) / GPU bubble ratio: 12.61%
[rank2]:2025-11-28 18:30:20,285 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.8730e+00
[rank2]:2025-11-28 18:30:20,286 - INFO -  step: 150  loss: -8.0000  grad_norm: 10.3942  memory:  6.43GiB(13.53%)  tps: 6,757  tflops: 52.82  mfu: 16.93%
[rank1]:2025-11-28 18:30:20,249 - INFO - Avg. fwd time: 9.5007 / Avg. bwd time: 22.3929 / Avg. batch time: 568.4058 (ms) / GPU bubble ratio: 55.11%
[rank1]:2025-11-28 18:30:20,289 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.4340e+00
[rank1]:2025-11-28 18:30:20,289 - INFO -  step: 150  loss: -8.0000  grad_norm: 10.3942  memory:  9.03GiB(19.01%)  tps: 6,757  tflops: 52.83  mfu: 16.93%
[rank3]:2025-11-28 18:30:20,308 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 9.4565e-01
[rank3]:2025-11-28 18:30:20,312 - INFO -  step: 150  loss:  4.2319  grad_norm: 10.3942  memory: 16.39GiB(34.50%)  tps: 6,757  tflops: 52.82  mfu: 16.93%
[rank0]:2025-11-28 18:30:20,274 - INFO - Avg. fwd time: 7.8721 / Avg. bwd time: 22.8704 / Avg. batch time: 604.4222 (ms) / GPU bubble ratio: 59.31%
[rank0]:2025-11-28 18:30:20,305 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 2.4164e+00
[rank0]:2025-11-28 18:30:20,305 - INFO -  step: 150  loss: -8.0000  grad_norm: 10.3942  memory: 12.97GiB(27.31%)  tps: 6,757  tflops: 52.83  mfu: 16.93%
[rank1]:2025-11-28 18:31:07,244 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 3.2155e+00
[rank2]:2025-11-28 18:31:07,229 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 7.6425e+00
[rank0]:2025-11-28 18:31:07,258 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 6.0028e+00
[rank3]:2025-11-28 18:31:07,244 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.4637e+00
[rank2]:2025-11-28 18:31:56,788 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.1466e+01
[rank1]:2025-11-28 18:31:56,792 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 8.1143e+00
[rank3]:2025-11-28 18:31:56,812 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 5.7708e+00
[rank0]:2025-11-28 18:31:56,808 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 6.4869e+00
[rank3]:2025-11-28 18:32:19,853 - INFO - Avg. fwd time: 13.9478 / Avg. bwd time: 40.8580 / Avg. batch time: 501.9218 (ms) / GPU bubble ratio: 12.65%
[rank2]:2025-11-28 18:32:19,912 - INFO - Avg. fwd time: 7.9720 / Avg. bwd time: 14.9921 / Avg. batch time: 529.2534 (ms) / GPU bubble ratio: 65.29%
[rank1]:2025-11-28 18:32:19,960 - INFO - Avg. fwd time: 9.5324 / Avg. bwd time: 22.1458 / Avg. batch time: 565.8942 (ms) / GPU bubble ratio: 55.22%
[rank0]:2025-11-28 18:32:19,956 - INFO - Avg. fwd time: 7.8895 / Avg. bwd time: 22.7525 / Avg. batch time: 601.7778 (ms) / GPU bubble ratio: 59.26%
[rank1]:2025-11-28 18:32:43,622 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.2543e+00
[rank2]:2025-11-28 18:32:43,606 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.5297e+00
[rank0]:2025-11-28 18:32:43,633 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.6306e+00
[rank3]:2025-11-28 18:32:43,621 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.3777e+00
[rank1]:2025-11-28 18:33:32,786 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 3.1737e+00
[rank2]:2025-11-28 18:33:32,782 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.8908e+00
[rank0]:2025-11-28 18:33:32,797 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 2.5862e+00
[rank3]:2025-11-28 18:33:32,805 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.6644e+00
[rank0]:2025-11-28 18:34:14,904 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-28 18:34:19,337 - INFO - Avg. fwd time: 8.0385 / Avg. bwd time: 14.5088 / Avg. batch time: 526.7894 (ms) / GPU bubble ratio: 65.76%
[rank3]:2025-11-28 18:34:19,276 - INFO - Avg. fwd time: 13.9622 / Avg. bwd time: 40.6017 / Avg. batch time: 499.9737 (ms) / GPU bubble ratio: 12.69%
[rank1]:2025-11-28 18:34:19,385 - INFO - Avg. fwd time: 9.5518 / Avg. bwd time: 21.9994 / Avg. batch time: 563.2646 (ms) / GPU bubble ratio: 55.19%
[rank0]:2025-11-28 18:34:19,381 - INFO - Avg. fwd time: 7.9191 / Avg. bwd time: 22.5638 / Avg. batch time: 598.9458 (ms) / GPU bubble ratio: 59.28%
[rank1]:2025-11-28 18:34:19,604 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 2.1576e+00
[rank1]:2025-11-28 18:34:19,604 - INFO -  step: 200  loss: -8.0000  grad_norm:  9.0607  memory:  9.03GiB(19.01%)  tps: 6,846  tflops: 53.52  mfu: 17.15%
[rank2]:2025-11-28 18:34:19,588 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.2304e+00
[rank2]:2025-11-28 18:34:19,588 - INFO -  step: 200  loss: -8.0000  grad_norm:  9.0607  memory:  6.43GiB(13.53%)  tps: 6,847  tflops: 53.52  mfu: 17.15%
[rank3]:2025-11-28 18:34:19,603 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 3.4446e+00
[rank3]:2025-11-28 18:34:19,607 - INFO -  step: 200  loss:  1.3050  grad_norm:  9.0607  memory: 16.39GiB(34.50%)  tps: 6,847  tflops: 53.53  mfu: 17.16%
[rank0]:2025-11-28 18:34:19,617 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.0629e-01
[rank0]:2025-11-28 18:34:19,617 - INFO -  step: 200  loss: -8.0000  grad_norm:  9.0607  memory: 12.97GiB(27.31%)  tps: 6,846  tflops: 53.52  mfu: 17.15%
[rank1]:2025-11-28 18:34:19,674 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p70_42_dm1/frozen_ratio_history/rank1/251128_1834_stage1_step200.svg
[rank2]:2025-11-28 18:34:19,672 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p70_42_dm1/frozen_ratio_history/rank2/251128_1834_stage2_step200.svg
[rank3]:2025-11-28 18:34:19,758 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p70_42_dm1/pipeline_schedule/251128_1834_real_step200_rank3.svg
[rank3]:			> Batch Time: 565.83 ms, GPU Bubble Ratio: 54.61%, 52.86%, 72.03%, 28.64%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms                       | [S0,MB1,F]  9-7-17ms                      | [S0,MB2,F]  17-7-25ms                     | [S0,MB3,F]  25-7-32ms                     | [S0,MB0,B]  132-24-156ms                  | [S0,MB4,F]  156-7-163ms                   | [S0,MB1,B]  186-24-211ms                  | [S0,MB5,F]  211-7-218ms                   | [S0,MB2,B]  243-24-267ms                  | [S0,MB6,F]  267-7-274ms                   | [S0,MB3,B]  302-24-327ms                  | [S0,MB7,F]  327-7-334ms                   | [S0,MB4,B]  363-24-387ms                  | [S0,MB5,B]  422-24-446ms                  | [S0,MB6,B]  481-24-505ms                  | [S0,MB7,B]  541-24-565ms                 
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms                     | [S1,MB1,F]  23-8-32ms                     | [S1,MB2,F]  35-8-44ms                     | [S1,MB0,B]  102-24-127ms                  | [S1,MB3,F]  130-8-139ms                   | [S1,MB1,B]  157-24-181ms                  | [S1,MB4,F]  185-8-194ms                   | [S1,MB2,B]  214-24-238ms                  | [S1,MB5,F]  241-9-250ms                   | [S1,MB3,B]  273-24-297ms                  | [S1,MB6,F]  301-9-310ms                   | [S1,MB4,B]  334-24-358ms                  | [S1,MB7,F]  361-9-371ms                   | [S1,MB5,B]  395-24-419ms                  | [S1,MB6,B]  454-24-478ms                  | [S1,MB7,B]  514-23-538ms                 
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms                     | [S2,MB1,F]  32-8-41ms                     | [S2,MB0,B]  86-11-97ms                    | [S2,MB2,F]  101-8-109ms                   | [S2,MB1,B]  141-11-152ms                  | [S2,MB3,F]  155-8-164ms                   | [S2,MB2,B]  197-11-208ms                  | [S2,MB4,F]  212-8-220ms                   | [S2,MB3,B]  257-11-268ms                  | [S2,MB5,F]  271-8-280ms                   | [S2,MB4,B]  317-11-329ms                  | [S2,MB6,F]  332-8-341ms                   | [S2,MB5,B]  378-11-390ms                  | [S2,MB7,F]  393-8-402ms                   | [S2,MB6,B]  439-11-451ms                  | [S2,MB7,B]  499-11-510ms                 
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms                    | [S3,MB0,B]  48-33-82ms                    | [S3,MB1,F]  84-11-96ms                    | [S3,MB1,B]  102-35-137ms                  | [S3,MB2,F]  139-12-152ms                  | [S3,MB2,B]  158-35-193ms                  | [S3,MB3,F]  196-14-210ms                  | [S3,MB3,B]  216-36-253ms                  | [S3,MB4,F]  255-15-270ms                  | [S3,MB4,B]  276-37-313ms                  | [S3,MB5,F]  316-15-331ms                  | [S3,MB5,B]  337-37-374ms                  | [S3,MB6,F]  377-15-392ms                  | [S3,MB6,B]  398-37-436ms                  | [S3,MB7,F]  438-14-453ms                  | [S3,MB7,B]  459-37-496ms                 
[rank0]:2025-11-28 18:34:19,672 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p70_42_dm1/frozen_ratio_history/rank0/251128_1834_stage0_step200.svg
[rank3]:2025-11-28 18:34:19,805 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p70_42_dm1/frozen_ratio_history/rank3/251128_1834_stage3_step200.svg
[rank2]:2025-11-28 18:35:09,021 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.8353e+01
[rank1]:2025-11-28 18:35:09,025 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.3640e+01
[rank3]:2025-11-28 18:35:09,044 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 4.2202e+00
[rank0]:2025-11-28 18:35:09,036 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.5987e+01
[rank1]:2025-11-28 18:35:54,113 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 5.2374e+00
[rank2]:2025-11-28 18:35:54,113 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 6.1672e+00
[rank3]:2025-11-28 18:35:54,129 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.5055e+00
[rank0]:2025-11-28 18:35:54,128 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 4.1404e+00
[rank1]:2025-11-28 18:36:18,868 - INFO - Avg. fwd time: 9.6482 / Avg. bwd time: 21.2357 / Avg. batch time: 561.8720 (ms) / GPU bubble ratio: 56.03%
[rank2]:2025-11-28 18:36:18,845 - INFO - Avg. fwd time: 8.0898 / Avg. bwd time: 14.1399 / Avg. batch time: 526.1652 (ms) / GPU bubble ratio: 66.20%
[rank3]:2025-11-28 18:36:18,826 - INFO - Avg. fwd time: 13.9723 / Avg. bwd time: 40.5554 / Avg. batch time: 499.6828 (ms) / GPU bubble ratio: 12.70%
[rank0]:2025-11-28 18:36:18,892 - INFO - Avg. fwd time: 8.0137 / Avg. bwd time: 21.8847 / Avg. batch time: 596.8628 (ms) / GPU bubble ratio: 59.93%
[rank2]:2025-11-28 18:36:43,440 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 8.8533e-01
[rank0]:2025-11-28 18:36:43,456 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.9280e+00
[rank1]:2025-11-28 18:36:43,444 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 6.3765e-01
[rank3]:2025-11-28 18:36:43,464 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 7.7282e-01
[rank1]:2025-11-28 18:37:28,570 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.1057e+01
[rank2]:2025-11-28 18:37:28,570 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.0029e+00
[rank3]:2025-11-28 18:37:28,586 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 3.5306e+00
[rank0]:2025-11-28 18:37:28,585 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.4028e+01
[rank0]:2025-11-28 18:38:12,690 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-11-28 18:38:17,335 - INFO - Avg. fwd time: 9.7301 / Avg. bwd time: 20.5799 / Avg. batch time: 560.5480 (ms) / GPU bubble ratio: 56.74%
[rank2]:2025-11-28 18:38:17,316 - INFO - Avg. fwd time: 8.1243 / Avg. bwd time: 13.8892 / Avg. batch time: 525.5040 (ms) / GPU bubble ratio: 66.49%
[rank3]:2025-11-28 18:38:17,298 - INFO - Avg. fwd time: 13.9716 / Avg. bwd time: 40.5076 / Avg. batch time: 499.2947 (ms) / GPU bubble ratio: 12.71%
[rank0]:2025-11-28 18:38:17,284 - INFO - Avg. fwd time: 8.0815 / Avg. bwd time: 21.3842 / Avg. batch time: 595.0281 (ms) / GPU bubble ratio: 60.38%
[rank2]:2025-11-28 18:38:17,563 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.9091e+00
[rank2]:2025-11-28 18:38:17,563 - INFO -  step: 250  loss: -8.0000  grad_norm:  2.6706  memory:  6.43GiB(13.53%)  tps: 6,885  tflops: 53.82  mfu: 17.25%
[rank0]:2025-11-28 18:38:17,578 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 8.9908e-01
[rank0]:2025-11-28 18:38:17,579 - INFO -  step: 250  loss: -8.0000  grad_norm:  2.6706  memory: 12.97GiB(27.31%)  tps: 6,885  tflops: 53.82  mfu: 17.25%
[rank1]:2025-11-28 18:38:17,563 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 8.3662e-01
[rank1]:2025-11-28 18:38:17,563 - INFO -  step: 250  loss: -8.0000  grad_norm:  2.6706  memory:  9.03GiB(19.01%)  tps: 6,885  tflops: 53.83  mfu: 17.25%
[rank3]:2025-11-28 18:38:17,586 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 8.0170e-01
[rank3]:2025-11-28 18:38:17,590 - INFO -  step: 250  loss:  0.4542  grad_norm:  2.6706  memory: 16.39GiB(34.50%)  tps: 6,885  tflops: 53.82  mfu: 17.25%
[rank2]:2025-11-28 18:39:02,593 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.6909e+00
[rank1]:2025-11-28 18:39:02,593 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 3.9341e+00
[rank0]:2025-11-28 18:39:02,608 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 4.7280e+00
[rank3]:2025-11-28 18:39:02,609 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.7229e+00
[rank2]:2025-11-28 18:39:51,634 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.6805e+00
[rank1]:2025-11-28 18:39:51,634 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 5.5920e+00
[rank3]:2025-11-28 18:39:51,657 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.1329e+00
[rank0]:2025-11-28 18:39:51,649 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 5.3078e+00
[rank3]:2025-11-28 18:40:13,884 - INFO - Avg. fwd time: 13.9697 / Avg. bwd time: 40.4204 / Avg. batch time: 498.5774 (ms) / GPU bubble ratio: 12.73%
[rank0]:2025-11-28 18:40:13,919 - INFO - Avg. fwd time: 8.1470 / Avg. bwd time: 20.9055 / Avg. batch time: 592.8650 (ms) / GPU bubble ratio: 60.80%
[rank2]:2025-11-28 18:40:13,946 - INFO - Avg. fwd time: 8.1576 / Avg. bwd time: 13.6502 / Avg. batch time: 524.5261 (ms) / GPU bubble ratio: 66.74%
[rank1]:2025-11-28 18:40:13,964 - INFO - Avg. fwd time: 9.8168 / Avg. bwd time: 19.8944 / Avg. batch time: 558.8770 (ms) / GPU bubble ratio: 57.47%
[rank2]:2025-11-28 18:40:36,847 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.5098e+00
[rank1]:2025-11-28 18:40:36,848 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.6008e+00
[rank0]:2025-11-28 18:40:36,863 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.2502e+00
[rank3]:2025-11-28 18:40:36,863 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 7.0887e-01
[rank1]:2025-11-28 18:41:26,053 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 4.9797e-01
[rank2]:2025-11-28 18:41:26,053 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 8.2514e-01
[rank3]:2025-11-28 18:41:26,076 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.8492e-01
[rank0]:2025-11-28 18:41:26,068 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.2947e+00
[rank0]:2025-11-28 18:42:06,681 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-28 18:42:11,155 - INFO - Avg. fwd time: 9.8878 / Avg. bwd time: 19.3297 / Avg. batch time: 557.1724 (ms) / GPU bubble ratio: 58.05%
[rank2]:2025-11-28 18:42:11,133 - INFO - Avg. fwd time: 8.1846 / Avg. bwd time: 13.4547 / Avg. batch time: 523.3901 (ms) / GPU bubble ratio: 66.92%
[rank3]:2025-11-28 18:42:11,113 - INFO - Avg. fwd time: 13.9790 / Avg. bwd time: 40.2960 / Avg. batch time: 497.6539 (ms) / GPU bubble ratio: 12.75%
[rank0]:2025-11-28 18:42:11,180 - INFO - Avg. fwd time: 8.2013 / Avg. bwd time: 20.5113 / Avg. batch time: 590.7622 (ms) / GPU bubble ratio: 61.12%
[rank1]:2025-11-28 18:42:11,190 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 4.4931e-01
[rank1]:2025-11-28 18:42:11,190 - INFO -  step: 300  loss: -8.0000  grad_norm:  0.5294  memory:  9.03GiB(19.01%)  tps: 7,013  tflops: 54.82  mfu: 17.57%
[rank1]:2025-11-28 18:42:11,266 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p70_42_dm1/frozen_ratio_history/rank1/251128_1842_stage1_step300.svg
[rank2]:2025-11-28 18:42:11,190 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.3259e+00
[rank2]:2025-11-28 18:42:11,190 - INFO -  step: 300  loss: -8.0000  grad_norm:  0.5294  memory:  6.43GiB(13.53%)  tps: 7,013  tflops: 54.82  mfu: 17.57%
[rank2]:2025-11-28 18:42:11,261 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p70_42_dm1/frozen_ratio_history/rank2/251128_1842_stage2_step300.svg
[rank3]:2025-11-28 18:42:11,205 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 8.9247e-01
[rank3]:2025-11-28 18:42:11,208 - INFO -  step: 300  loss:  0.3042  grad_norm:  0.5294  memory: 16.39GiB(34.50%)  tps: 7,013  tflops: 54.83  mfu: 17.57%
[rank0]:2025-11-28 18:42:11,205 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1075e+00
[rank0]:2025-11-28 18:42:11,206 - INFO -  step: 300  loss: -8.0000  grad_norm:  0.5294  memory: 12.97GiB(27.31%)  tps: 7,013  tflops: 54.82  mfu: 17.57%
[rank0]:2025-11-28 18:42:11,261 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p70_42_dm1/frozen_ratio_history/rank0/251128_1842_stage0_step300.svg
[rank3]:2025-11-28 18:42:11,349 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p70_42_dm1/pipeline_schedule/251128_1842_real_step300_rank3.svg
[rank3]:			> Batch Time: 548.42 ms, GPU Bubble Ratio: 63.19%, 64.85%, 70.97%, 25.94%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms                       | [S0,MB1,F]  9-9-18ms                      | [S0,MB2,F]  18-9-27ms                     | [S0,MB3,F]  27-8-36ms                     | [S0,MB0,B]  121-16-138ms                  | [S0,MB4,F]  138-8-146ms                   | [S0,MB1,B]  176-16-193ms                  | [S0,MB5,F]  193-8-201ms                   | [S0,MB2,B]  234-16-250ms                  | [S0,MB6,F]  250-8-259ms                   | [S0,MB3,B]  294-16-310ms                  | [S0,MB7,F]  310-8-319ms                   | [S0,MB4,B]  354-16-371ms                  | [S0,MB5,B]  413-16-429ms                  | [S0,MB6,B]  472-16-488ms                  | [S0,MB7,B]  532-16-548ms                 
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms                     | [S1,MB1,F]  23-10-34ms                    | [S1,MB2,F]  37-10-48ms                    | [S1,MB0,B]  103-13-116ms                  | [S1,MB3,F]  120-10-130ms                  | [S1,MB1,B]  158-13-171ms                  | [S1,MB4,F]  175-10-185ms                  | [S1,MB2,B]  215-13-228ms                  | [S1,MB5,F]  232-10-243ms                  | [S1,MB3,B]  275-13-288ms                  | [S1,MB6,F]  292-10-303ms                  | [S1,MB4,B]  335-13-349ms                  | [S1,MB7,F]  352-10-363ms                  | [S1,MB5,B]  396-13-410ms                  | [S1,MB6,B]  455-13-469ms                  | [S1,MB7,B]  515-13-528ms                 
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms                     | [S2,MB1,F]  34-8-42ms                     | [S2,MB0,B]  86-11-98ms                    | [S2,MB2,F]  101-8-110ms                   | [S2,MB1,B]  141-11-153ms                  | [S2,MB3,F]  156-8-164ms                   | [S2,MB2,B]  198-11-210ms                  | [S2,MB4,F]  213-8-222ms                   | [S2,MB3,B]  259-11-270ms                  | [S2,MB5,F]  273-8-282ms                   | [S2,MB4,B]  319-11-330ms                  | [S2,MB6,F]  334-8-342ms                   | [S2,MB5,B]  380-11-391ms                  | [S2,MB7,F]  395-8-403ms                   | [S2,MB6,B]  441-11-452ms                  | [S2,MB7,B]  500-11-512ms                 
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms                    | [S3,MB0,B]  48-34-82ms                    | [S3,MB1,F]  85-11-96ms                    | [S3,MB1,B]  102-35-138ms                  | [S3,MB2,F]  140-13-153ms                  | [S3,MB2,B]  158-36-195ms                  | [S3,MB3,F]  197-14-212ms                  | [S3,MB3,B]  218-36-255ms                  | [S3,MB4,F]  257-15-272ms                  | [S3,MB4,B]  278-37-315ms                  | [S3,MB5,F]  317-15-333ms                  | [S3,MB5,B]  338-37-376ms                  | [S3,MB6,F]  378-15-393ms                  | [S3,MB6,B]  399-37-437ms                  | [S3,MB7,F]  439-14-454ms                  | [S3,MB7,B]  459-37-497ms                 
[rank3]:2025-11-28 18:42:11,395 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p70_42_dm1/frozen_ratio_history/rank3/251128_1842_stage3_step300.svg
[rank1]:2025-11-28 18:43:00,378 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 6.6874e-01
[rank3]:2025-11-28 18:43:00,402 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.1439e-01
[rank2]:2025-11-28 18:43:00,378 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.3958e-01
[rank0]:2025-11-28 18:43:00,394 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 8.2831e-01
[rank3]:2025-11-28 18:43:45,535 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 7.4408e-01
[rank1]:2025-11-28 18:43:45,519 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.4529e+00
[rank2]:2025-11-28 18:43:45,519 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.0003e+00
[rank0]:2025-11-28 18:43:45,535 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.6133e+00
[rank2]:2025-11-28 18:44:09,721 - INFO - Avg. fwd time: 8.2049 / Avg. bwd time: 13.3121 / Avg. batch time: 523.1512 (ms) / GPU bubble ratio: 67.10%
[rank0]:2025-11-28 18:44:09,690 - INFO - Avg. fwd time: 8.2410 / Avg. bwd time: 20.2244 / Avg. batch time: 589.8138 (ms) / GPU bubble ratio: 61.39%
[rank3]:2025-11-28 18:44:09,702 - INFO - Avg. fwd time: 13.9776 / Avg. bwd time: 40.2825 / Avg. batch time: 497.5316 (ms) / GPU bubble ratio: 12.75%
[rank1]:2025-11-28 18:44:09,740 - INFO - Avg. fwd time: 9.9404 / Avg. bwd time: 18.9187 / Avg. batch time: 556.5178 (ms) / GPU bubble ratio: 58.51%
[rank0]:2025-11-28 18:44:34,652 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.2243e+00
[rank1]:2025-11-28 18:44:34,636 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 7.8481e-01
[rank2]:2025-11-28 18:44:34,636 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.0140e+00
[rank3]:2025-11-28 18:44:34,659 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 3.6169e-01
[rank3]:2025-11-28 18:45:19,685 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.1290e+00
[rank1]:2025-11-28 18:45:19,669 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 9.8179e-01
[rank2]:2025-11-28 18:45:19,669 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.4203e+00
[rank0]:2025-11-28 18:45:19,685 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.4214e+00
[rank0]:2025-11-28 18:46:03,774 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-28 18:46:08,413 - INFO - Avg. fwd time: 13.9765 / Avg. bwd time: 40.2958 / Avg. batch time: 497.6274 (ms) / GPU bubble ratio: 12.75%
[rank0]:2025-11-28 18:46:08,400 - INFO - Avg. fwd time: 8.2806 / Avg. bwd time: 19.9363 / Avg. batch time: 589.0366 (ms) / GPU bubble ratio: 61.68%
[rank1]:2025-11-28 18:46:08,449 - INFO - Avg. fwd time: 9.9927 / Avg. bwd time: 18.5056 / Avg. batch time: 556.0371 (ms) / GPU bubble ratio: 59.00%
[rank2]:2025-11-28 18:46:08,431 - INFO - Avg. fwd time: 8.2250 / Avg. bwd time: 13.1686 / Avg. batch time: 523.0876 (ms) / GPU bubble ratio: 67.28%
[rank1]:2025-11-28 18:46:08,678 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 5.2125e-01
[rank1]:2025-11-28 18:46:08,679 - INFO -  step: 350  loss: -8.0000  grad_norm:  0.1781  memory:  9.03GiB(19.01%)  tps: 6,899  tflops: 53.93  mfu: 17.29%
[rank2]:2025-11-28 18:46:08,678 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 7.3596e-01
[rank2]:2025-11-28 18:46:08,679 - INFO -  step: 350  loss: -8.0000  grad_norm:  0.1781  memory:  6.43GiB(13.53%)  tps: 6,899  tflops: 53.93  mfu: 17.29%
[rank3]:2025-11-28 18:46:08,702 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.6168e-01
[rank3]:2025-11-28 18:46:08,705 - INFO -  step: 350  loss:  0.2491  grad_norm:  0.1781  memory: 16.39GiB(34.50%)  tps: 6,899  tflops: 53.93  mfu: 17.29%
[rank0]:2025-11-28 18:46:08,693 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1741e+00
[rank0]:2025-11-28 18:46:08,694 - INFO -  step: 350  loss: -8.0000  grad_norm:  0.1781  memory: 12.97GiB(27.31%)  tps: 6,899  tflops: 53.93  mfu: 17.29%
[rank3]:2025-11-28 18:46:53,836 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.9614e+00
[rank0]:2025-11-28 18:46:53,836 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.5200e+00
[rank1]:2025-11-28 18:46:53,820 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.8517e+00
[rank2]:2025-11-28 18:46:53,820 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.1001e+00
[rank2]:2025-11-28 18:47:42,810 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.6752e+00
[rank0]:2025-11-28 18:47:42,825 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.5206e+00
[rank3]:2025-11-28 18:47:42,833 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 3.5873e-01
[rank1]:2025-11-28 18:47:42,810 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.3956e+00
[rank3]:2025-11-28 18:48:05,236 - INFO - Avg. fwd time: 13.9778 / Avg. bwd time: 40.2222 / Avg. batch time: 497.0460 (ms) / GPU bubble ratio: 12.76%
[rank1]:2025-11-28 18:48:05,279 - INFO - Avg. fwd time: 10.0381 / Avg. bwd time: 18.1503 / Avg. batch time: 554.9631 (ms) / GPU bubble ratio: 59.37%
[rank2]:2025-11-28 18:48:05,257 - INFO - Avg. fwd time: 8.2425 / Avg. bwd time: 13.0449 / Avg. batch time: 522.3705 (ms) / GPU bubble ratio: 67.40%
[rank0]:2025-11-28 18:48:05,305 - INFO - Avg. fwd time: 8.3147 / Avg. bwd time: 19.6884 / Avg. batch time: 587.7086 (ms) / GPU bubble ratio: 61.88%
[rank1]:2025-11-28 18:48:27,936 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 4.4883e-01
[rank2]:2025-11-28 18:48:27,936 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 6.8792e-01
[rank0]:2025-11-28 18:48:27,952 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1637e+00
[rank3]:2025-11-28 18:48:27,952 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 9.4455e-01
[rank2]:2025-11-28 18:49:16,890 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 6.2734e-01
[rank0]:2025-11-28 18:49:16,905 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 9.8917e-01
[rank1]:2025-11-28 18:49:16,890 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 6.5045e-01
[rank3]:2025-11-28 18:49:16,913 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.4681e-01
[rank0]:2025-11-28 18:49:57,439 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-28 18:50:01,676 - INFO - Avg. fwd time: 13.9817 / Avg. bwd time: 40.1708 / Avg. batch time: 496.6644 (ms) / GPU bubble ratio: 12.77%
[rank2]:2025-11-28 18:50:01,734 - INFO - Avg. fwd time: 8.2555 / Avg. bwd time: 12.9518 / Avg. batch time: 521.8863 (ms) / GPU bubble ratio: 67.49%
[rank1]:2025-11-28 18:50:01,756 - INFO - Avg. fwd time: 10.0720 / Avg. bwd time: 17.8829 / Avg. batch time: 554.2086 (ms) / GPU bubble ratio: 59.65%
[rank0]:2025-11-28 18:50:01,712 - INFO - Avg. fwd time: 8.3401 / Avg. bwd time: 19.5019 / Avg. batch time: 586.7607 (ms) / GPU bubble ratio: 62.04%
[rank2]:2025-11-28 18:50:01,969 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 7.4802e-01
[rank2]:2025-11-28 18:50:01,969 - INFO -  step: 400  loss: -8.0000  grad_norm:  0.2707  memory:  6.43GiB(13.53%)  tps: 7,023  tflops: 54.90  mfu: 17.60%
[rank1]:2025-11-28 18:50:01,969 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 3.4078e-01
[rank1]:2025-11-28 18:50:01,969 - INFO -  step: 400  loss: -8.0000  grad_norm:  0.2707  memory:  9.03GiB(19.01%)  tps: 7,023  tflops: 54.90  mfu: 17.60%
[rank0]:2025-11-28 18:50:01,984 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 7.9925e-01
[rank0]:2025-11-28 18:50:01,984 - INFO -  step: 400  loss: -8.0000  grad_norm:  0.2707  memory: 12.97GiB(27.31%)  tps: 7,023  tflops: 54.90  mfu: 17.60%
[rank3]:2025-11-28 18:50:01,984 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.4591e-01
[rank3]:2025-11-28 18:50:01,988 - INFO -  step: 400  loss:  0.2288  grad_norm:  0.2707  memory: 16.39GiB(34.50%)  tps: 7,023  tflops: 54.90  mfu: 17.60%
[rank2]:2025-11-28 18:50:02,044 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p70_42_dm1/frozen_ratio_history/rank2/251128_1850_stage2_step400.svg
[rank1]:2025-11-28 18:50:02,046 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p70_42_dm1/frozen_ratio_history/rank1/251128_1850_stage1_step400.svg
[rank0]:2025-11-28 18:50:02,044 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p70_42_dm1/frozen_ratio_history/rank0/251128_1850_stage0_step400.svg
[rank3]:2025-11-28 18:50:02,127 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p70_42_dm1/pipeline_schedule/251128_1850_real_step400_rank3.svg
[rank3]:			> Batch Time: 547.91 ms, GPU Bubble Ratio: 63.20%, 64.89%, 71.00%, 26.25%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms                       | [S0,MB1,F]  9-9-18ms                      | [S0,MB2,F]  18-9-27ms                     | [S0,MB3,F]  27-8-36ms                     | [S0,MB0,B]  121-16-137ms                  | [S0,MB4,F]  137-8-146ms                   | [S0,MB1,B]  176-16-192ms                  | [S0,MB5,F]  192-8-200ms                   | [S0,MB2,B]  232-16-248ms                  | [S0,MB6,F]  249-8-257ms                   | [S0,MB3,B]  292-16-309ms                  | [S0,MB7,F]  309-8-317ms                   | [S0,MB4,B]  354-16-370ms                  | [S0,MB5,B]  412-16-429ms                  | [S0,MB6,B]  471-16-487ms                  | [S0,MB7,B]  531-16-547ms                 
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-10-20ms                     | [S1,MB1,F]  23-10-34ms                    | [S1,MB2,F]  37-10-47ms                    | [S1,MB0,B]  102-13-116ms                  | [S1,MB3,F]  119-10-130ms                  | [S1,MB1,B]  157-13-171ms                  | [S1,MB4,F]  174-10-185ms                  | [S1,MB2,B]  214-13-227ms                  | [S1,MB5,F]  230-10-241ms                  | [S1,MB3,B]  274-13-287ms                  | [S1,MB6,F]  291-10-301ms                  | [S1,MB4,B]  335-13-348ms                  | [S1,MB7,F]  352-10-362ms                  | [S1,MB5,B]  395-13-409ms                  | [S1,MB6,B]  454-13-468ms                  | [S1,MB7,B]  514-13-528ms                 
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms                     | [S2,MB1,F]  34-8-42ms                     | [S2,MB0,B]  86-11-97ms                    | [S2,MB2,F]  101-8-109ms                   | [S2,MB1,B]  141-11-152ms                  | [S2,MB3,F]  156-8-164ms                   | [S2,MB2,B]  197-11-209ms                  | [S2,MB4,F]  212-8-220ms                   | [S2,MB3,B]  257-11-269ms                  | [S2,MB5,F]  272-8-280ms                   | [S2,MB4,B]  318-11-330ms                  | [S2,MB6,F]  333-8-342ms                   | [S2,MB5,B]  379-11-390ms                  | [S2,MB7,F]  394-8-402ms                   | [S2,MB6,B]  440-11-451ms                  | [S2,MB7,B]  499-11-511ms                 
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms                    | [S3,MB0,B]  48-33-82ms                    | [S3,MB1,F]  84-11-96ms                    | [S3,MB1,B]  102-35-137ms                  | [S3,MB2,F]  139-12-152ms                  | [S3,MB2,B]  158-35-193ms                  | [S3,MB3,F]  196-14-210ms                  | [S3,MB3,B]  217-36-253ms                  | [S3,MB4,F]  256-15-271ms                  | [S3,MB4,B]  277-37-314ms                  | [S3,MB5,F]  317-15-332ms                  | [S3,MB5,B]  338-37-375ms                  | [S3,MB6,F]  377-14-392ms                  | [S3,MB6,B]  398-37-436ms                  | [S3,MB7,F]  438-14-453ms                  | [S3,MB7,B]  459-37-496ms                 
[rank3]:2025-11-28 18:50:02,175 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p70_42_dm1/frozen_ratio_history/rank3/251128_1850_stage3_step400.svg
[rank3]:2025-11-28 18:50:29,958 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-11-28 18:50:30,185 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-11-28 18:50:30,169 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-11-28 18:50:30,204 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-11-28 18:50:51,104 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 7.1591e-01
[rank1]:2025-11-28 18:50:51,088 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 8.1804e-01
[rank2]:2025-11-28 18:50:51,088 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.2840e+00
[rank3]:2025-11-28 18:50:51,112 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 7.1171e-01
[rank0]:2025-11-28 18:51:36,069 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.7482e-01
[rank1]:2025-11-28 18:51:36,053 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 5.9198e-01
[rank3]:2025-11-28 18:51:36,069 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.4773e-01
[rank2]:2025-11-28 18:51:36,053 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.6604e-01
[rank3]:2025-11-28 18:52:00,272 - INFO - Avg. fwd time: 13.9819 / Avg. bwd time: 40.1487 / Avg. batch time: 496.4885 (ms) / GPU bubble ratio: 12.78%
[rank0]:2025-11-28 18:52:00,259 - INFO - Avg. fwd time: 8.3665 / Avg. bwd time: 19.3091 / Avg. batch time: 586.0275 (ms) / GPU bubble ratio: 62.22%
[rank2]:2025-11-28 18:52:00,289 - INFO - Avg. fwd time: 8.2693 / Avg. bwd time: 12.8552 / Avg. batch time: 521.6331 (ms) / GPU bubble ratio: 67.60%
[rank1]:2025-11-28 18:52:00,308 - INFO - Avg. fwd time: 10.1075 / Avg. bwd time: 17.6064 / Avg. batch time: 553.6761 (ms) / GPU bubble ratio: 59.96%
[rank3]:2025-11-28 18:52:24,846 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 4.4593e-01
[rank2]:2025-11-28 18:52:24,822 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.1286e+00
[rank1]:2025-11-28 18:52:24,822 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.1334e+00
[rank0]:2025-11-28 18:52:24,837 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.0413e+00
[rank1]:2025-11-28 18:53:09,896 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.9733e+00
[rank3]:2025-11-28 18:53:09,911 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.4641e+00
[rank0]:2025-11-28 18:53:09,911 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.6671e+00
[rank2]:2025-11-28 18:53:09,896 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.5607e+00
[rank0]:2025-11-28 18:53:53,976 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-28 18:53:58,767 - INFO - Avg. fwd time: 13.9796 / Avg. bwd time: 40.1625 / Avg. batch time: 496.5809 (ms) / GPU bubble ratio: 12.78%
[rank2]:2025-11-28 18:53:58,788 - INFO - Avg. fwd time: 8.2811 / Avg. bwd time: 12.7699 / Avg. batch time: 521.6308 (ms) / GPU bubble ratio: 67.72%
[rank3]:2025-11-28 18:53:58,870 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.1381e+00
[rank1]:2025-11-28 18:53:58,811 - INFO - Avg. fwd time: 10.1383 / Avg. bwd time: 17.3623 / Avg. batch time: 553.4284 (ms) / GPU bubble ratio: 60.25%
[rank1]:2025-11-28 18:53:58,847 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 3.1436e+00
[rank1]:2025-11-28 18:53:58,847 - INFO -  step: 450  loss: -8.0000  grad_norm:  0.1118  memory:  9.03GiB(19.01%)  tps: 6,917  tflops: 54.07  mfu: 17.33%
[rank3]:2025-11-28 18:53:58,874 - INFO -  step: 450  loss:  0.2436  grad_norm:  0.1118  memory: 16.39GiB(34.50%)  tps: 6,916  tflops: 54.07  mfu: 17.33%
[rank0]:2025-11-28 18:53:58,837 - INFO - Avg. fwd time: 8.3892 / Avg. bwd time: 19.1388 / Avg. batch time: 585.6025 (ms) / GPU bubble ratio: 62.39%
[rank0]:2025-11-28 18:53:58,862 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 5.2290e+00
[rank0]:2025-11-28 18:53:58,863 - INFO -  step: 450  loss: -8.0000  grad_norm:  0.1118  memory: 12.97GiB(27.31%)  tps: 6,917  tflops: 54.07  mfu: 17.33%
[rank2]:2025-11-28 18:53:58,847 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.6035e+00
[rank2]:2025-11-28 18:53:58,847 - INFO -  step: 450  loss: -8.0000  grad_norm:  0.1118  memory:  6.43GiB(13.53%)  tps: 6,917  tflops: 54.07  mfu: 17.33%
[rank0]:2025-11-28 18:54:43,899 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 7.8977e-01
[rank1]:2025-11-28 18:54:43,884 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 8.2024e-01
[rank2]:2025-11-28 18:54:43,884 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.9700e-01
[rank3]:2025-11-28 18:54:43,900 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0044e-01
[rank2]:2025-11-28 18:55:32,815 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.7639e+00
[rank1]:2025-11-28 18:55:32,815 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 3.0294e+00
[rank0]:2025-11-28 18:55:32,831 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.6386e+00
[rank3]:2025-11-28 18:55:32,839 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.5927e+00
[rank0]:2025-11-28 18:55:55,112 - INFO - Avg. fwd time: 8.4073 / Avg. bwd time: 19.0078 / Avg. batch time: 584.8702 (ms) / GPU bubble ratio: 62.50%
[rank3]:2025-11-28 18:55:55,075 - INFO - Avg. fwd time: 13.9790 / Avg. bwd time: 40.1213 / Avg. batch time: 496.2454 (ms) / GPU bubble ratio: 12.78%
[rank2]:2025-11-28 18:55:55,139 - INFO - Avg. fwd time: 8.2904 / Avg. bwd time: 12.7041 / Avg. batch time: 521.2211 (ms) / GPU bubble ratio: 67.78%
[rank1]:2025-11-28 18:55:55,157 - INFO - Avg. fwd time: 10.1623 / Avg. bwd time: 17.1746 / Avg. batch time: 552.8294 (ms) / GPU bubble ratio: 60.44%
[rank1]:2025-11-28 18:56:17,894 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.8252e+00
[rank0]:2025-11-28 18:56:17,909 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.7742e+00
[rank3]:2025-11-28 18:56:17,909 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.4077e+00
[rank2]:2025-11-28 18:56:17,894 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.2797e+00
[rank0]:2025-11-28 18:57:06,929 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.9120e+00
[rank2]:2025-11-28 18:57:06,914 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.2643e+00
[rank3]:2025-11-28 18:57:06,937 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.2677e+00
[rank1]:2025-11-28 18:57:06,914 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.6448e+00
[rank0]:2025-11-28 18:57:47,508 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-28 18:57:51,704 - INFO - Avg. fwd time: 13.9828 / Avg. bwd time: 40.0577 / Avg. batch time: 495.7662 (ms) / GPU bubble ratio: 12.80%
[rank0]:2025-11-28 18:57:51,740 - INFO - Avg. fwd time: 8.4259 / Avg. bwd time: 18.8701 / Avg. batch time: 583.9710 (ms) / GPU bubble ratio: 62.61%
[rank1]:2025-11-28 18:57:51,785 - INFO - Avg. fwd time: 10.1872 / Avg. bwd time: 16.9771 / Avg. batch time: 552.0722 (ms) / GPU bubble ratio: 60.64%
[rank2]:2025-11-28 18:57:51,767 - INFO - Avg. fwd time: 8.2999 / Avg. bwd time: 12.6351 / Avg. batch time: 520.6634 (ms) / GPU bubble ratio: 67.83%
[rank3]:2025-11-28 18:57:52,004 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 4.2857e+00
[rank3]:2025-11-28 18:57:52,007 - INFO -  step: 500  loss:  0.2423  grad_norm:  0.0910  memory: 16.39GiB(34.50%)  tps: 7,028  tflops: 54.94  mfu: 17.61%
[rank1]:2025-11-28 18:57:51,988 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 3.3682e+00
[rank1]:2025-11-28 18:57:51,988 - INFO -  step: 500  loss: -8.0000  grad_norm:  0.0910  memory:  9.03GiB(19.01%)  tps: 7,028  tflops: 54.94  mfu: 17.61%
[rank2]:2025-11-28 18:57:51,988 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.0025e+00
[rank2]:2025-11-28 18:57:51,988 - INFO -  step: 500  loss: -8.0000  grad_norm:  0.0910  memory:  6.43GiB(13.53%)  tps: 7,028  tflops: 54.94  mfu: 17.61%
[rank0]:2025-11-28 18:57:52,003 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.9087e+00
[rank0]:2025-11-28 18:57:52,004 - INFO -  step: 500  loss: -8.0000  grad_norm:  0.0910  memory: 12.97GiB(27.31%)  tps: 7,028  tflops: 54.94  mfu: 17.61%
[rank0]:2025-11-28 18:57:52,059 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p70_42_dm1/frozen_ratio_history/rank0/251128_1857_stage0_step500.svg
[rank1]:2025-11-28 18:57:52,062 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p70_42_dm1/frozen_ratio_history/rank1/251128_1857_stage1_step500.svg
[rank2]:2025-11-28 18:57:52,058 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p70_42_dm1/frozen_ratio_history/rank2/251128_1857_stage2_step500.svg
[rank3]:2025-11-28 18:57:52,146 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p70_42_dm1/pipeline_schedule/251128_1857_real_step500_rank3.svg
[rank3]:			> Batch Time: 547.89 ms, GPU Bubble Ratio: 63.14%, 64.79%, 70.94%, 26.01%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms                       | [S0,MB1,F]  9-9-18ms                      | [S0,MB2,F]  18-9-27ms                     | [S0,MB3,F]  27-8-36ms                     | [S0,MB0,B]  121-16-138ms                  | [S0,MB4,F]  138-8-146ms                   | [S0,MB1,B]  177-16-194ms                  | [S0,MB5,F]  194-8-202ms                   | [S0,MB2,B]  233-16-250ms                  | [S0,MB6,F]  250-8-258ms                   | [S0,MB3,B]  293-16-310ms                  | [S0,MB7,F]  310-8-318ms                   | [S0,MB4,B]  353-16-370ms                  | [S0,MB5,B]  412-16-428ms                  | [S0,MB6,B]  471-16-488ms                  | [S0,MB7,B]  531-16-547ms                 
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms                     | [S1,MB1,F]  23-10-34ms                    | [S1,MB2,F]  37-10-48ms                    | [S1,MB0,B]  103-13-116ms                  | [S1,MB3,F]  120-10-130ms                  | [S1,MB1,B]  159-13-172ms                  | [S1,MB4,F]  176-10-186ms                  | [S1,MB2,B]  215-13-228ms                  | [S1,MB5,F]  232-10-242ms                  | [S1,MB3,B]  275-13-288ms                  | [S1,MB6,F]  291-10-302ms                  | [S1,MB4,B]  335-13-348ms                  | [S1,MB7,F]  352-10-362ms                  | [S1,MB5,B]  395-13-409ms                  | [S1,MB6,B]  455-13-468ms                  | [S1,MB7,B]  514-13-528ms                 
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms                     | [S2,MB1,F]  34-8-42ms                     | [S2,MB0,B]  86-11-98ms                    | [S2,MB2,F]  101-8-110ms                   | [S2,MB1,B]  142-11-153ms                  | [S2,MB3,F]  157-8-165ms                   | [S2,MB2,B]  198-11-210ms                  | [S2,MB4,F]  213-8-222ms                   | [S2,MB3,B]  258-11-269ms                  | [S2,MB5,F]  273-8-281ms                   | [S2,MB4,B]  318-11-330ms                  | [S2,MB6,F]  333-8-341ms                   | [S2,MB5,B]  379-11-390ms                  | [S2,MB7,F]  394-8-402ms                   | [S2,MB6,B]  440-11-452ms                  | [S2,MB7,B]  500-11-511ms                 
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-43ms                    | [S3,MB0,B]  48-34-83ms                    | [S3,MB1,F]  85-11-97ms                    | [S3,MB1,B]  103-35-138ms                  | [S3,MB2,F]  140-12-153ms                  | [S3,MB2,B]  158-36-195ms                  | [S3,MB3,F]  197-14-211ms                  | [S3,MB3,B]  217-36-254ms                  | [S3,MB4,F]  256-15-271ms                  | [S3,MB4,B]  277-37-314ms                  | [S3,MB5,F]  316-15-332ms                  | [S3,MB5,B]  337-37-375ms                  | [S3,MB6,F]  377-14-392ms                  | [S3,MB6,B]  398-37-436ms                  | [S3,MB7,F]  439-14-453ms                  | [S3,MB7,B]  459-37-497ms                 
[rank3]:2025-11-28 18:57:52,190 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p70_42_dm1/frozen_ratio_history/rank3/251128_1857_stage3_step500.svg
[rank0]:2025-11-28 18:58:41,021 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 5.9494e-01
[rank2]:2025-11-28 18:58:41,006 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.9717e-01
[rank1]:2025-11-28 18:58:41,006 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.5982e-01
[rank3]:2025-11-28 18:58:41,029 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.8029e-01
[rank0]:2025-11-28 18:59:25,977 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.9303e+00
[rank2]:2025-11-28 18:59:25,962 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.1185e+00
[rank3]:2025-11-28 18:59:25,977 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.3925e+00
[rank1]:2025-11-28 18:59:25,962 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.6143e+00
[rank2]:2025-11-28 18:59:50,145 - INFO - Avg. fwd time: 8.3085 / Avg. bwd time: 12.5725 / Avg. batch time: 520.5161 (ms) / GPU bubble ratio: 67.91%
[rank1]:2025-11-28 18:59:50,169 - INFO - Avg. fwd time: 10.2095 / Avg. bwd time: 16.7990 / Avg. batch time: 551.7459 (ms) / GPU bubble ratio: 60.84%
[rank3]:2025-11-28 18:59:50,123 - INFO - Avg. fwd time: 13.9757 / Avg. bwd time: 40.0522 / Avg. batch time: 495.6643 (ms) / GPU bubble ratio: 12.80%
[rank0]:2025-11-28 18:59:50,196 - INFO - Avg. fwd time: 8.4424 / Avg. bwd time: 18.7457 / Avg. batch time: 583.5174 (ms) / GPU bubble ratio: 62.73%
[rank1]:2025-11-28 19:00:14,599 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 3.1098e+00
[rank0]:2025-11-28 19:00:14,615 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.6525e+00
[rank2]:2025-11-28 19:00:14,599 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.2896e+00
[rank3]:2025-11-28 19:00:14,623 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.2557e+00
[rank2]:2025-11-28 19:00:59,543 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 9.4423e-01
[rank3]:2025-11-28 19:00:59,558 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.2381e+00
[rank1]:2025-11-28 19:00:59,543 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 7.4854e-01
[rank0]:2025-11-28 19:00:59,558 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1453e+00
[rank0]:2025-11-28 19:01:43,355 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-11-28 19:01:47,962 - INFO - Avg. fwd time: 8.4553 / Avg. bwd time: 18.6480 / Avg. batch time: 583.1127 (ms) / GPU bubble ratio: 62.82%
[rank3]:2025-11-28 19:01:47,975 - INFO - Avg. fwd time: 13.9752 / Avg. bwd time: 40.0398 / Avg. batch time: 495.5596 (ms) / GPU bubble ratio: 12.80%
[rank2]:2025-11-28 19:01:47,993 - INFO - Avg. fwd time: 8.3150 / Avg. bwd time: 12.5231 / Avg. batch time: 520.3541 (ms) / GPU bubble ratio: 67.96%
[rank1]:2025-11-28 19:01:48,011 - INFO - Avg. fwd time: 10.2269 / Avg. bwd time: 16.6595 / Avg. batch time: 551.4422 (ms) / GPU bubble ratio: 60.99%
[rank0]:2025-11-28 19:01:48,248 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 7.1074e-01
[rank0]:2025-11-28 19:01:48,249 - INFO -  step: 550  loss: -8.0000  grad_norm:  0.0955  memory: 12.97GiB(27.31%)  tps: 6,935  tflops: 54.22  mfu: 17.38%
[rank3]:2025-11-28 19:01:48,256 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.9003e-01
[rank3]:2025-11-28 19:01:48,260 - INFO -  step: 550  loss:  0.2490  grad_norm:  0.0955  memory: 16.39GiB(34.50%)  tps: 6,935  tflops: 54.21  mfu: 17.38%
[rank2]:2025-11-28 19:01:48,233 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 6.9239e-01
[rank2]:2025-11-28 19:01:48,233 - INFO -  step: 550  loss: -8.0000  grad_norm:  0.0955  memory:  6.43GiB(13.53%)  tps: 6,935  tflops: 54.22  mfu: 17.38%
[rank1]:2025-11-28 19:01:48,233 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.6095e-01
[rank1]:2025-11-28 19:01:48,233 - INFO -  step: 550  loss: -8.0000  grad_norm:  0.0955  memory:  9.03GiB(19.01%)  tps: 6,935  tflops: 54.22  mfu: 17.38%
[rank0]:2025-11-28 19:02:33,301 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.4039e+00
[rank3]:2025-11-28 19:02:33,302 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.7599e+00
[rank2]:2025-11-28 19:02:33,286 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.6346e+00
[rank1]:2025-11-28 19:02:33,286 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.6429e+00
[rank0]:2025-11-28 19:03:22,164 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 4.3822e-01
[rank3]:2025-11-28 19:03:22,172 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 3.0206e-01
[rank2]:2025-11-28 19:03:22,149 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.7134e+00
[rank1]:2025-11-28 19:03:22,149 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 6.6523e-01
[rank0]:2025-11-28 19:03:44,336 - INFO - Avg. fwd time: 8.4690 / Avg. bwd time: 18.5440 / Avg. batch time: 582.5459 (ms) / GPU bubble ratio: 62.90%
[rank3]:2025-11-28 19:03:44,298 - INFO - Avg. fwd time: 13.9742 / Avg. bwd time: 40.0096 / Avg. batch time: 495.3099 (ms) / GPU bubble ratio: 12.81%
[rank2]:2025-11-28 19:03:44,362 - INFO - Avg. fwd time: 8.3218 / Avg. bwd time: 12.4703 / Avg. batch time: 520.0436 (ms) / GPU bubble ratio: 68.01%
[rank1]:2025-11-28 19:03:44,381 - INFO - Avg. fwd time: 10.2453 / Avg. bwd time: 16.5105 / Avg. batch time: 550.9813 (ms) / GPU bubble ratio: 61.15%
[rank0]:2025-11-28 19:04:07,131 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.3875e+00
[rank3]:2025-11-28 19:04:07,131 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.4527e+00
[rank2]:2025-11-28 19:04:07,115 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.0408e+00
[rank1]:2025-11-28 19:04:07,115 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.1842e+00
[rank0]:2025-11-28 19:04:55,918 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.1945e+00
[rank3]:2025-11-28 19:04:55,926 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 5.2426e-01
[rank1]:2025-11-28 19:04:55,902 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.4477e+00
[rank2]:2025-11-28 19:04:55,902 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.3228e+00
[rank0]:2025-11-28 19:05:36,428 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-28 19:05:40,998 - INFO - Avg. fwd time: 8.4817 / Avg. bwd time: 18.4493 / Avg. batch time: 581.8522 (ms) / GPU bubble ratio: 62.97%
[rank3]:2025-11-28 19:05:40,923 - INFO - Avg. fwd time: 13.9742 / Avg. bwd time: 39.9588 / Avg. batch time: 494.9030 (ms) / GPU bubble ratio: 12.82%
[rank1]:2025-11-28 19:05:40,971 - INFO - Avg. fwd time: 10.2628 / Avg. bwd time: 16.3748 / Avg. batch time: 550.3845 (ms) / GPU bubble ratio: 61.28%
[rank1]:2025-11-28 19:05:41,008 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 6.7069e-01
[rank1]:2025-11-28 19:05:41,009 - INFO -  step: 600  loss: -8.0000  grad_norm:  0.3990  memory:  9.03GiB(19.01%)  tps: 7,039  tflops: 55.02  mfu: 17.64%
[rank2]:2025-11-28 19:05:40,946 - INFO - Avg. fwd time: 8.3286 / Avg. bwd time: 12.4223 / Avg. batch time: 519.5827 (ms) / GPU bubble ratio: 68.05%
[rank2]:2025-11-28 19:05:41,008 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.6725e+00
[rank2]:2025-11-28 19:05:41,009 - INFO -  step: 600  loss: -8.0000  grad_norm:  0.3990  memory:  6.43GiB(13.53%)  tps: 7,039  tflops: 55.02  mfu: 17.64%
[rank0]:2025-11-28 19:05:41,024 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 9.4378e-01
[rank0]:2025-11-28 19:05:41,024 - INFO -  step: 600  loss: -8.0000  grad_norm:  0.3990  memory: 12.97GiB(27.31%)  tps: 7,039  tflops: 55.02  mfu: 17.64%
[rank0]:2025-11-28 19:05:41,081 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p70_42_dm1/frozen_ratio_history/rank0/251128_1905_stage0_step600.svg
[rank3]:2025-11-28 19:05:41,024 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.2827e+00
[rank3]:2025-11-28 19:05:41,027 - INFO -  step: 600  loss:  0.2403  grad_norm:  0.3990  memory: 16.39GiB(34.50%)  tps: 7,039  tflops: 55.03  mfu: 17.64%
[rank1]:2025-11-28 19:05:41,084 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p70_42_dm1/frozen_ratio_history/rank1/251128_1905_stage1_step600.svg
[rank2]:2025-11-28 19:05:41,080 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p70_42_dm1/frozen_ratio_history/rank2/251128_1905_stage2_step600.svg
[rank3]:2025-11-28 19:05:41,167 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p70_42_dm1/pipeline_schedule/251128_1905_real_step600_rank3.svg
[rank3]:			> Batch Time: 547.39 ms, GPU Bubble Ratio: 63.17%, 64.86%, 70.99%, 26.08%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms                       | [S0,MB1,F]  9-9-18ms                      | [S0,MB2,F]  18-9-27ms                     | [S0,MB3,F]  27-8-36ms                     | [S0,MB0,B]  121-16-137ms                  | [S0,MB4,F]  137-8-146ms                   | [S0,MB1,B]  176-16-192ms                  | [S0,MB5,F]  192-8-200ms                   | [S0,MB2,B]  232-16-249ms                  | [S0,MB6,F]  249-8-257ms                   | [S0,MB3,B]  292-16-309ms                  | [S0,MB7,F]  309-8-317ms                   | [S0,MB4,B]  353-16-370ms                  | [S0,MB5,B]  412-16-428ms                  | [S0,MB6,B]  471-16-487ms                  | [S0,MB7,B]  531-16-547ms                 
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms                     | [S1,MB1,F]  23-10-34ms                    | [S1,MB2,F]  37-10-48ms                    | [S1,MB0,B]  102-13-116ms                  | [S1,MB3,F]  119-10-130ms                  | [S1,MB1,B]  157-13-170ms                  | [S1,MB4,F]  174-10-184ms                  | [S1,MB2,B]  214-13-227ms                  | [S1,MB5,F]  230-10-241ms                  | [S1,MB3,B]  274-13-287ms                  | [S1,MB6,F]  290-10-301ms                  | [S1,MB4,B]  334-13-348ms                  | [S1,MB7,F]  351-10-362ms                  | [S1,MB5,B]  395-13-409ms                  | [S1,MB6,B]  454-13-468ms                  | [S1,MB7,B]  514-13-527ms                 
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms                     | [S2,MB1,F]  34-8-42ms                     | [S2,MB0,B]  86-11-97ms                    | [S2,MB2,F]  101-8-109ms                   | [S2,MB1,B]  140-11-152ms                  | [S2,MB3,F]  155-8-164ms                   | [S2,MB2,B]  197-11-209ms                  | [S2,MB4,F]  212-8-221ms                   | [S2,MB3,B]  257-11-269ms                  | [S2,MB5,F]  272-8-281ms                   | [S2,MB4,B]  318-11-329ms                  | [S2,MB6,F]  333-8-341ms                   | [S2,MB5,B]  379-11-390ms                  | [S2,MB7,F]  393-8-402ms                   | [S2,MB6,B]  439-11-451ms                  | [S2,MB7,B]  499-11-511ms                 
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms                    | [S3,MB0,B]  48-33-82ms                    | [S3,MB1,F]  84-11-96ms                    | [S3,MB1,B]  102-35-137ms                  | [S3,MB2,F]  139-12-152ms                  | [S3,MB2,B]  158-35-193ms                  | [S3,MB3,F]  196-14-210ms                  | [S3,MB3,B]  217-36-253ms                  | [S3,MB4,F]  256-15-271ms                  | [S3,MB4,B]  277-37-314ms                  | [S3,MB5,F]  316-15-332ms                  | [S3,MB5,B]  337-37-375ms                  | [S3,MB6,F]  377-15-392ms                  | [S3,MB6,B]  398-37-436ms                  | [S3,MB7,F]  438-14-453ms                  | [S3,MB7,B]  459-37-496ms                 
[rank3]:2025-11-28 19:05:41,214 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p70_42_dm1/frozen_ratio_history/rank3/251128_1905_stage3_step600.svg
[rank2]:2025-11-28 19:06:30,068 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.4271e+00
[rank1]:2025-11-28 19:06:30,069 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 8.4040e-01
[rank0]:2025-11-28 19:06:30,084 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 4.0267e-01
[rank3]:2025-11-28 19:06:30,092 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 3.8723e-01
[rank2]:2025-11-28 19:07:15,016 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.6735e+00
[rank3]:2025-11-28 19:07:15,032 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 3.1990e+00
[rank1]:2025-11-28 19:07:15,016 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.3960e+00
[rank0]:2025-11-28 19:07:15,032 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.8612e+00
[rank0]:2025-11-28 19:07:39,342 - INFO - Avg. fwd time: 8.4915 / Avg. bwd time: 18.3746 / Avg. batch time: 581.6199 (ms) / GPU bubble ratio: 63.05%
[rank2]:2025-11-28 19:07:39,371 - INFO - Avg. fwd time: 8.3336 / Avg. bwd time: 12.3847 / Avg. batch time: 519.5352 (ms) / GPU bubble ratio: 68.10%
[rank3]:2025-11-28 19:07:39,353 - INFO - Avg. fwd time: 13.9726 / Avg. bwd time: 39.9575 / Avg. batch time: 494.8782 (ms) / GPU bubble ratio: 12.82%
[rank1]:2025-11-28 19:07:39,396 - INFO - Avg. fwd time: 10.2759 / Avg. bwd time: 16.2677 / Avg. batch time: 550.2287 (ms) / GPU bubble ratio: 61.41%
[rank0]:2025-11-28 19:08:03,991 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.1146e+00
[rank2]:2025-11-28 19:08:03,975 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.2486e+00
[rank1]:2025-11-28 19:08:03,975 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.5815e+00
[rank3]:2025-11-28 19:08:03,999 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 7.5648e-01
[rank0]:2025-11-28 19:08:49,028 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 9.2561e-01
[rank2]:2025-11-28 19:08:49,012 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.6662e+00
[rank3]:2025-11-28 19:08:49,028 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.5756e+00
[rank1]:2025-11-28 19:08:49,012 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 8.6313e-01
[rank0]:2025-11-28 19:09:33,120 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-11-28 19:09:37,722 - INFO - Avg. fwd time: 8.5028 / Avg. bwd time: 18.2941 / Avg. batch time: 581.5041 (ms) / GPU bubble ratio: 63.13%
[rank2]:2025-11-28 19:09:37,752 - INFO - Avg. fwd time: 8.3396 / Avg. bwd time: 12.3440 / Avg. batch time: 519.6178 (ms) / GPU bubble ratio: 68.16%
[rank3]:2025-11-28 19:09:37,733 - INFO - Avg. fwd time: 13.9702 / Avg. bwd time: 39.9761 / Avg. batch time: 495.0080 (ms) / GPU bubble ratio: 12.82%
[rank1]:2025-11-28 19:09:37,770 - INFO - Avg. fwd time: 10.2910 / Avg. bwd time: 16.1523 / Avg. batch time: 550.1953 (ms) / GPU bubble ratio: 61.55%
[rank0]:2025-11-28 19:09:38,003 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 9.6846e-01
[rank0]:2025-11-28 19:09:38,004 - INFO -  step: 650  loss: -8.0000  grad_norm:  0.0879  memory: 12.97GiB(27.31%)  tps: 6,914  tflops: 54.05  mfu: 17.32%
[rank2]:2025-11-28 19:09:37,988 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.1530e+00
[rank2]:2025-11-28 19:09:37,988 - INFO -  step: 650  loss: -8.0000  grad_norm:  0.0879  memory:  6.43GiB(13.53%)  tps: 6,914  tflops: 54.05  mfu: 17.32%
[rank3]:2025-11-28 19:09:38,011 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 6.8446e-01
[rank3]:2025-11-28 19:09:38,015 - INFO -  step: 650  loss:  0.2484  grad_norm:  0.0879  memory: 16.39GiB(34.50%)  tps: 6,913  tflops: 54.05  mfu: 17.32%
[rank1]:2025-11-28 19:09:37,988 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.2471e+00
[rank1]:2025-11-28 19:09:37,988 - INFO -  step: 650  loss: -8.0000  grad_norm:  0.0879  memory:  9.03GiB(19.01%)  tps: 6,914  tflops: 54.05  mfu: 17.32%
[rank0]:2025-11-28 19:10:23,047 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1565e+00
[rank2]:2025-11-28 19:10:23,031 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.0757e+00
[rank3]:2025-11-28 19:10:23,047 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 9.2058e-01
[rank1]:2025-11-28 19:10:23,031 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.2925e+00
[rank0]:2025-11-28 19:11:11,938 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 6.6174e-01
[rank2]:2025-11-28 19:11:11,923 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.8280e-01
[rank3]:2025-11-28 19:11:11,947 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 8.3327e-02
[rank1]:2025-11-28 19:11:11,923 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 4.4626e-01
[rank2]:2025-11-28 19:11:34,456 - INFO - Avg. fwd time: 8.3448 / Avg. bwd time: 12.3066 / Avg. batch time: 519.3356 (ms) / GPU bubble ratio: 68.19%
[rank1]:2025-11-28 19:11:34,481 - INFO - Avg. fwd time: 10.3044 / Avg. bwd time: 16.0458 / Avg. batch time: 549.8067 (ms) / GPU bubble ratio: 61.66%
[rank3]:2025-11-28 19:11:34,432 - INFO - Avg. fwd time: 13.9717 / Avg. bwd time: 39.9447 / Avg. batch time: 494.7679 (ms) / GPU bubble ratio: 12.82%
[rank0]:2025-11-28 19:11:34,510 - INFO - Avg. fwd time: 8.5125 / Avg. bwd time: 18.2199 / Avg. batch time: 581.0395 (ms) / GPU bubble ratio: 63.19%
[rank0]:2025-11-28 19:11:57,071 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.6223e+00
[rank1]:2025-11-28 19:11:57,055 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.3032e+00
[rank2]:2025-11-28 19:11:57,055 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.6115e+00
[rank3]:2025-11-28 19:11:57,071 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.1052e+00
[rank0]:2025-11-28 19:12:46,100 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.7612e+00
[rank2]:2025-11-28 19:12:46,084 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.9296e+00
[rank3]:2025-11-28 19:12:46,107 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 9.5690e-01
[rank1]:2025-11-28 19:12:46,084 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 3.0416e+00
[rank0]:2025-11-28 19:13:26,663 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-28 19:13:30,898 - INFO - Avg. fwd time: 8.5208 / Avg. bwd time: 18.1607 / Avg. batch time: 580.7214 (ms) / GPU bubble ratio: 63.24%
[rank2]:2025-11-28 19:13:30,923 - INFO - Avg. fwd time: 8.3491 / Avg. bwd time: 12.2766 / Avg. batch time: 519.1626 (ms) / GPU bubble ratio: 68.22%
[rank3]:2025-11-28 19:13:30,860 - INFO - Avg. fwd time: 13.9738 / Avg. bwd time: 39.9255 / Avg. batch time: 494.6303 (ms) / GPU bubble ratio: 12.82%
[rank1]:2025-11-28 19:13:30,946 - INFO - Avg. fwd time: 10.3154 / Avg. bwd time: 15.9610 / Avg. batch time: 549.5483 (ms) / GPU bubble ratio: 61.75%
[rank0]:2025-11-28 19:13:31,158 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.0127e+00
[rank0]:2025-11-28 19:13:31,159 - INFO -  step: 700  loss: -8.0000  grad_norm:  0.1090  memory: 12.97GiB(27.31%)  tps: 7,027  tflops: 54.93  mfu: 17.61%
[rank0]:2025-11-28 19:13:31,217 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p70_42_dm1/frozen_ratio_history/rank0/251128_1913_stage0_step700.svg
[rank2]:2025-11-28 19:13:31,143 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.0789e+00
[rank2]:2025-11-28 19:13:31,143 - INFO -  step: 700  loss: -8.0000  grad_norm:  0.1090  memory:  6.43GiB(13.53%)  tps: 7,027  tflops: 54.93  mfu: 17.61%
[rank2]:2025-11-28 19:13:31,218 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p70_42_dm1/frozen_ratio_history/rank2/251128_1913_stage2_step700.svg
[rank3]:2025-11-28 19:13:31,159 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.0285e+00
[rank3]:2025-11-28 19:13:31,162 - INFO -  step: 700  loss:  0.2136  grad_norm:  0.1090  memory: 16.39GiB(34.50%)  tps: 7,027  tflops: 54.94  mfu: 17.61%
[rank1]:2025-11-28 19:13:31,143 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.7602e+00
[rank1]:2025-11-28 19:13:31,144 - INFO -  step: 700  loss: -8.0000  grad_norm:  0.1090  memory:  9.03GiB(19.01%)  tps: 7,027  tflops: 54.93  mfu: 17.61%
[rank1]:2025-11-28 19:13:31,218 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p70_42_dm1/frozen_ratio_history/rank1/251128_1913_stage1_step700.svg
[rank3]:2025-11-28 19:13:31,303 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p70_42_dm1/pipeline_schedule/251128_1913_real_step700_rank3.svg
[rank3]:			> Batch Time: 548.89 ms, GPU Bubble Ratio: 63.22%, 64.90%, 71.04%, 25.95%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms                       | [S0,MB1,F]  9-9-18ms                      | [S0,MB2,F]  18-9-27ms                     | [S0,MB3,F]  27-8-36ms                     | [S0,MB0,B]  121-16-138ms                  | [S0,MB4,F]  138-8-146ms                   | [S0,MB1,B]  176-16-193ms                  | [S0,MB5,F]  193-8-201ms                   | [S0,MB2,B]  234-16-250ms                  | [S0,MB6,F]  250-8-258ms                   | [S0,MB3,B]  293-16-310ms                  | [S0,MB7,F]  310-8-318ms                   | [S0,MB4,B]  354-16-370ms                  | [S0,MB5,B]  413-16-429ms                  | [S0,MB6,B]  472-16-488ms                  | [S0,MB7,B]  532-16-548ms                 
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms                     | [S1,MB1,F]  23-10-34ms                    | [S1,MB2,F]  37-10-48ms                    | [S1,MB0,B]  103-13-116ms                  | [S1,MB3,F]  120-10-130ms                  | [S1,MB1,B]  158-13-171ms                  | [S1,MB4,F]  175-10-185ms                  | [S1,MB2,B]  215-13-228ms                  | [S1,MB5,F]  232-10-242ms                  | [S1,MB3,B]  275-13-288ms                  | [S1,MB6,F]  292-10-302ms                  | [S1,MB4,B]  335-13-349ms                  | [S1,MB7,F]  352-10-363ms                  | [S1,MB5,B]  396-13-409ms                  | [S1,MB6,B]  455-13-469ms                  | [S1,MB7,B]  515-13-529ms                 
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms                     | [S2,MB1,F]  34-8-42ms                     | [S2,MB0,B]  86-11-98ms                    | [S2,MB2,F]  101-8-110ms                   | [S2,MB1,B]  141-11-153ms                  | [S2,MB3,F]  156-8-165ms                   | [S2,MB2,B]  199-11-210ms                  | [S2,MB4,F]  213-8-222ms                   | [S2,MB3,B]  258-11-269ms                  | [S2,MB5,F]  273-8-282ms                   | [S2,MB4,B]  319-11-330ms                  | [S2,MB6,F]  334-8-342ms                   | [S2,MB5,B]  380-11-391ms                  | [S2,MB7,F]  394-8-403ms                   | [S2,MB6,B]  440-11-452ms                  | [S2,MB7,B]  500-11-512ms                 
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-43ms                    | [S3,MB0,B]  48-34-83ms                    | [S3,MB1,F]  85-11-96ms                    | [S3,MB1,B]  102-35-138ms                  | [S3,MB2,F]  140-13-153ms                  | [S3,MB2,B]  159-36-195ms                  | [S3,MB3,F]  197-14-212ms                  | [S3,MB3,B]  217-36-254ms                  | [S3,MB4,F]  257-15-272ms                  | [S3,MB4,B]  278-37-315ms                  | [S3,MB5,F]  317-15-333ms                  | [S3,MB5,B]  338-37-376ms                  | [S3,MB6,F]  378-14-393ms                  | [S3,MB6,B]  399-37-437ms                  | [S3,MB7,F]  439-14-453ms                  | [S3,MB7,B]  459-37-497ms                 
[rank3]:2025-11-28 19:13:31,351 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p70_42_dm1/frozen_ratio_history/rank3/251128_1913_stage3_step700.svg
[rank1]:2025-11-28 19:14:20,292 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 3.1082e+00
[rank2]:2025-11-28 19:14:20,292 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.3252e+00
[rank0]:2025-11-28 19:14:20,308 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.3616e+00
[rank3]:2025-11-28 19:14:20,316 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.8925e+00
[rank2]:2025-11-28 19:15:05,424 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.9970e+00
[rank0]:2025-11-28 19:15:05,439 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.6907e+00
[rank1]:2025-11-28 19:15:05,424 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.2120e+00
[rank3]:2025-11-28 19:15:05,440 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.3841e+00
[rank0]:2025-11-28 19:15:29,538 - INFO - Avg. fwd time: 8.5293 / Avg. bwd time: 18.0964 / Avg. batch time: 580.5016 (ms) / GPU bubble ratio: 63.31%
[rank2]:2025-11-28 19:15:29,568 - INFO - Avg. fwd time: 8.3535 / Avg. bwd time: 12.2442 / Avg. batch time: 519.1027 (ms) / GPU bubble ratio: 68.26%
[rank3]:2025-11-28 19:15:29,550 - INFO - Avg. fwd time: 13.9748 / Avg. bwd time: 39.9196 / Avg. batch time: 494.5908 (ms) / GPU bubble ratio: 12.83%
[rank1]:2025-11-28 19:15:29,586 - INFO - Avg. fwd time: 10.3269 / Avg. bwd time: 15.8686 / Avg. batch time: 549.3947 (ms) / GPU bubble ratio: 61.86%
[rank2]:2025-11-28 19:15:54,390 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.7272e+00
[rank1]:2025-11-28 19:15:54,390 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.5465e+00
[rank0]:2025-11-28 19:15:54,406 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 9.7728e-01
[rank3]:2025-11-28 19:15:54,414 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 7.0140e-01
[rank2]:2025-11-28 19:16:39,481 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.8963e+00
[rank0]:2025-11-28 19:16:39,496 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.6092e+00
[rank1]:2025-11-28 19:16:39,481 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 3.9098e+00
[rank3]:2025-11-28 19:16:39,497 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 3.0933e+00
[rank0]:2025-11-28 19:17:23,527 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-11-28 19:17:28,423 - INFO - Avg. fwd time: 8.3578 / Avg. bwd time: 12.2140 / Avg. batch time: 519.2113 (ms) / GPU bubble ratio: 68.30%
[rank3]:2025-11-28 19:17:28,399 - INFO - Avg. fwd time: 13.9742 / Avg. bwd time: 39.9380 / Avg. batch time: 494.7339 (ms) / GPU bubble ratio: 12.82%
[rank2]:2025-11-28 19:17:28,488 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.0214e+00
[rank2]:2025-11-28 19:17:28,489 - INFO -  step: 750  loss: -8.0000  grad_norm:  0.1083  memory:  6.43GiB(13.53%)  tps: 6,903  tflops: 53.96  mfu: 17.30%
[rank0]:2025-11-28 19:17:28,478 - INFO - Avg. fwd time: 8.5375 / Avg. bwd time: 18.0366 / Avg. batch time: 580.4654 (ms) / GPU bubble ratio: 63.38%
[rank0]:2025-11-28 19:17:28,503 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 5.8532e-01
[rank0]:2025-11-28 19:17:28,504 - INFO -  step: 750  loss: -8.0000  grad_norm:  0.1083  memory: 12.97GiB(27.31%)  tps: 6,903  tflops: 53.96  mfu: 17.30%
[rank3]:2025-11-28 19:17:28,511 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 3.4754e-01
[rank3]:2025-11-28 19:17:28,515 - INFO -  step: 750  loss:  0.2617  grad_norm:  0.1083  memory: 16.39GiB(34.50%)  tps: 6,903  tflops: 53.96  mfu: 17.30%
[rank1]:2025-11-28 19:17:28,449 - INFO - Avg. fwd time: 10.3377 / Avg. bwd time: 15.7826 / Avg. batch time: 549.4177 (ms) / GPU bubble ratio: 61.97%
[rank1]:2025-11-28 19:17:28,488 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 3.8965e-01
[rank1]:2025-11-28 19:17:28,488 - INFO -  step: 750  loss: -8.0000  grad_norm:  0.1083  memory:  9.03GiB(19.01%)  tps: 6,903  tflops: 53.96  mfu: 17.30%
[rank2]:2025-11-28 19:18:13,573 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 7.1153e-01
[rank3]:2025-11-28 19:18:13,589 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.5629e+00
[rank0]:2025-11-28 19:18:13,589 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.2610e+00
[rank1]:2025-11-28 19:18:13,574 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.1877e+00
[rank2]:2025-11-28 19:19:02,556 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 9.0527e-01
[rank0]:2025-11-28 19:19:02,572 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 6.9878e-01
[rank1]:2025-11-28 19:19:02,557 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 4.6852e-01
[rank3]:2025-11-28 19:19:02,580 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 4.5965e-01
[rank2]:2025-11-28 19:19:24,985 - INFO - Avg. fwd time: 8.3611 / Avg. bwd time: 12.1897 / Avg. batch time: 519.0438 (ms) / GPU bubble ratio: 68.33%
[rank3]:2025-11-28 19:19:24,922 - INFO - Avg. fwd time: 13.9751 / Avg. bwd time: 39.9197 / Avg. batch time: 494.5954 (ms) / GPU bubble ratio: 12.83%
[rank0]:2025-11-28 19:19:24,960 - INFO - Avg. fwd time: 8.5441 / Avg. bwd time: 17.9886 / Avg. batch time: 580.1794 (ms) / GPU bubble ratio: 63.41%
[rank1]:2025-11-28 19:19:25,003 - INFO - Avg. fwd time: 10.3463 / Avg. bwd time: 15.7136 / Avg. batch time: 549.1803 (ms) / GPU bubble ratio: 62.04%
[rank2]:2025-11-28 19:19:47,794 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.5960e+00
[rank3]:2025-11-28 19:19:47,809 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.9312e+00
[rank1]:2025-11-28 19:19:47,794 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.4148e+00
[rank0]:2025-11-28 19:19:47,809 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.4505e+00
[rank2]:2025-11-28 19:20:36,818 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.1743e-01
[rank3]:2025-11-28 19:20:36,842 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 9.2785e-02
[rank1]:2025-11-28 19:20:36,818 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 3.9804e-01
[rank0]:2025-11-28 19:20:36,834 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 8.8728e-01
[rank0]:2025-11-28 19:21:17,518 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-28 19:21:21,812 - INFO - Avg. fwd time: 13.9786 / Avg. bwd time: 39.8885 / Avg. batch time: 494.3732 (ms) / GPU bubble ratio: 12.83%
[rank0]:2025-11-28 19:21:21,852 - INFO - Avg. fwd time: 8.5515 / Avg. bwd time: 17.9360 / Avg. batch time: 579.7963 (ms) / GPU bubble ratio: 63.45%
[rank2]:2025-11-28 19:21:21,879 - INFO - Avg. fwd time: 8.3649 / Avg. bwd time: 12.1630 / Avg. batch time: 518.7901 (ms) / GPU bubble ratio: 68.34%
[rank1]:2025-11-28 19:21:21,897 - INFO - Avg. fwd time: 10.3560 / Avg. bwd time: 15.6380 / Avg. batch time: 548.8502 (ms) / GPU bubble ratio: 62.11%
[rank2]:2025-11-28 19:21:22,092 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.3769e+00
[rank2]:2025-11-28 19:21:22,093 - INFO -  step: 800  loss: -8.0000  grad_norm:  0.3774  memory:  6.43GiB(13.53%)  tps: 7,014  tflops: 54.83  mfu: 17.57%
[rank2]:2025-11-28 19:21:22,093 - INFO -  final step: 800  loss: -8.0000  grad_norm:  0.3774  tps: 7,305  tflops: 57.10  mfu: 16.69%
[rank2]:2025-11-28 19:21:22,093 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-28 19:21:22,094 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank3]:2025-11-28 19:21:22,108 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.9478e+00
[rank3]:2025-11-28 19:21:22,111 - INFO -  step: 800  loss:  0.2595  grad_norm:  0.3774  memory: 16.39GiB(34.50%)  tps: 7,014  tflops: 54.83  mfu: 17.57%
[rank3]:2025-11-28 19:21:22,112 - INFO -  final step: 800  loss:  0.2595  grad_norm:  0.3774  tps: 7,310  tflops: 57.14  mfu: 16.83%
[rank3]:2025-11-28 19:21:22,112 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-11-28 19:21:22,113 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-11-28 19:21:22,108 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.4192e+00
[rank0]:2025-11-28 19:21:22,108 - INFO -  step: 800  loss: -8.0000  grad_norm:  0.3774  memory: 12.97GiB(27.31%)  tps: 7,014  tflops: 54.83  mfu: 17.57%
[rank0]:2025-11-28 19:21:22,109 - INFO -  final step: 800  loss: -8.0000  grad_norm:  0.3774  tps: 7,305  tflops: 57.10  mfu: 16.68%
[rank0]:2025-11-28 19:21:22,109 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-28 19:21:22,109 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank1]:2025-11-28 19:21:22,092 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.3623e+00
[rank1]:2025-11-28 19:21:22,093 - INFO -  step: 800  loss: -8.0000  grad_norm:  0.3774  memory:  9.03GiB(19.01%)  tps: 7,014  tflops: 54.83  mfu: 17.57%
[rank1]:2025-11-28 19:21:22,093 - INFO -  final step: 800  loss: -8.0000  grad_norm:  0.3774  tps: 7,304  tflops: 57.10  mfu: 16.68%
[rank1]:2025-11-28 19:21:22,093 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-11-28 19:21:22,094 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-11-28 19:21:23,994 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank2]:2025-11-28 19:21:24,068 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p70_42_dm1/frozen_ratio_history/rank2/251128_1921_stage2_final800.svg
[rank0]:2025-11-28 19:21:24,068 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p70_42_dm1/frozen_ratio_history/rank0/251128_1921_stage0_final800.svg
[rank1]:2025-11-28 19:21:24,068 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p70_42_dm1/frozen_ratio_history/rank1/251128_1921_stage1_final800.svg
[rank2]:2025-11-28 19:21:24,224 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p70_42_dm1/frozen_params_histogram/251128_1921_rank2_stage2.svg
[rank2]:	> Counts Sum: 1971, Total Sum: 2700 (73.00%), Ratio(%) per element: [97.33, 97.33, 97.33, 97.33, 97.33, 97.33, 97.33, 97.33, 97.33, 97.33, 97.33, 97.33, 97.33, 97.33, 97.33, 97.33, 97.33, 97.33, 97.33, 97.33, 97.33, 97.33, 97.33, 97.33, 97.33, 97.33, 97.33, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-11-28 19:21:24,225 - INFO - Destroying the purge thread.
[rank3]:2025-11-28 19:21:24,149 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p70_42_dm1/pipeline_schedule/251128_1921_real_final800_rank3.svg
[rank3]:			> Batch Time: 587.91 ms, GPU Bubble Ratio: 65.72%, 67.29%, 72.97%, 25.44%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms                       | [S0,MB1,F]  9-9-18ms                      | [S0,MB2,F]  18-9-27ms                     | [S0,MB3,F]  27-8-36ms                     | [S0,MB0,B]  126-16-143ms                  | [S0,MB4,F]  143-8-151ms                   | [S0,MB1,B]  186-16-202ms                  | [S0,MB5,F]  202-8-211ms                   | [S0,MB2,B]  248-16-264ms                  | [S0,MB6,F]  265-8-274ms                   | [S0,MB3,B]  311-16-328ms                  | [S0,MB7,F]  329-8-337ms                   | [S0,MB4,B]  376-16-392ms                  | [S0,MB5,B]  440-16-456ms                  | [S0,MB6,B]  506-16-523ms                  | [S0,MB7,B]  571-16-587ms                 
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms                     | [S1,MB1,F]  23-10-34ms                    | [S1,MB2,F]  37-10-47ms                    | [S1,MB0,B]  104-13-117ms                  | [S1,MB3,F]  125-10-135ms                  | [S1,MB1,B]  165-13-179ms                  | [S1,MB4,F]  184-10-194ms                  | [S1,MB2,B]  229-13-242ms                  | [S1,MB5,F]  246-10-256ms                  | [S1,MB3,B]  292-13-306ms                  | [S1,MB6,F]  310-10-320ms                  | [S1,MB4,B]  357-13-370ms                  | [S1,MB7,F]  374-10-385ms                  | [S1,MB5,B]  423-13-436ms                  | [S1,MB6,B]  489-13-503ms                  | [S1,MB7,B]  554-13-567ms                 
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms                     | [S2,MB1,F]  34-8-42ms                     | [S2,MB0,B]  87-11-98ms                    | [S2,MB2,F]  102-8-110ms                   | [S2,MB1,B]  148-11-159ms                  | [S2,MB3,F]  163-8-172ms                   | [S2,MB2,B]  212-11-223ms                  | [S2,MB4,F]  227-8-235ms                   | [S2,MB3,B]  275-11-287ms                  | [S2,MB5,F]  291-8-299ms                   | [S2,MB4,B]  340-11-351ms                  | [S2,MB6,F]  355-8-364ms                   | [S2,MB5,B]  406-11-417ms                  | [S2,MB7,F]  422-8-430ms                   | [S2,MB6,B]  474-11-485ms                  | [S2,MB7,B]  539-11-550ms                 
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms                    | [S3,MB0,B]  48-34-83ms                    | [S3,MB1,F]  85-11-97ms                    | [S3,MB1,B]  103-40-144ms                  | [S3,MB2,F]  146-13-159ms                  | [S3,MB2,B]  166-41-207ms                  | [S3,MB3,F]  210-14-224ms                  | [S3,MB3,B]  229-42-271ms                  | [S3,MB4,F]  274-14-289ms                  | [S3,MB4,B]  293-42-336ms                  | [S3,MB5,F]  338-15-353ms                  | [S3,MB5,B]  359-41-401ms                  | [S3,MB6,F]  404-14-419ms                  | [S3,MB6,B]  425-42-467ms                  | [S3,MB7,F]  472-14-487ms                  | [S3,MB7,B]  492-42-534ms                 
[rank0]:2025-11-28 19:21:24,229 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p70_42_dm1/frozen_params_histogram/251128_1921_rank0_stage0.svg
[rank0]:	> Counts Sum: 1764, Total Sum: 2775 (63.57%), Ratio(%) per element: [0.0, 89.33, 89.33, 89.33, 89.33, 89.33, 89.33, 89.33, 89.33, 89.33, 89.33, 89.33, 89.33, 89.33, 89.33, 89.33, 89.33, 89.33, 89.33, 82.66, 82.66, 82.66, 82.66, 82.66, 82.66, 82.66, 82.66, 82.66, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-11-28 19:21:24,229 - INFO - Sleeping 2 seconds for other ranks to complete
[rank1]:2025-11-28 19:21:24,222 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p70_42_dm1/frozen_params_histogram/251128_1921_rank1_stage1.svg
[rank1]:	> Counts Sum: 2313, Total Sum: 3375 (68.53%), Ratio(%) per element: [88.0, 88.0, 88.0, 88.0, 88.0, 88.0, 88.0, 88.0, 88.0, 88.0, 88.0, 88.0, 88.0, 88.0, 88.0, 88.0, 88.0, 88.0, 88.0, 88.0, 88.0, 88.0, 88.0, 88.0, 88.0, 88.0, 88.0, 78.66, 78.66, 78.66, 78.66, 78.66, 78.66, 78.66, 78.66, 78.66, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-11-28 19:21:24,222 - INFO - Destroying the purge thread.
[rank2]:2025-11-28 19:21:24,338 - INFO - Process group destroyed
[rank3]:2025-11-28 19:21:24,279 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p70_42_dm1/pipeline_schedule/251128_1921_thry_final800_rank3.svg
[rank3]:			> Batch Time: 344.25 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-10-10ms                     | [S0,MB1,F]  10-10-20ms                    | [S0,MB2,F]  20-10-31ms                    | [S0,MB3,F]  31-10-41ms                    | [S0,MB0,B]  104-20-125ms                  | [S0,MB4,F]  125-10-135ms                  | [S0,MB1,B]  135-20-156ms                  | [S0,MB5,F]  156-10-166ms                  | [S0,MB2,B]  166-20-187ms                  | [S0,MB6,F]  187-10-198ms                  | [S0,MB3,B]  198-20-219ms                  | [S0,MB7,F]  219-10-229ms                  | [S0,MB4,B]  229-20-250ms                  | [S0,MB5,B]  260-20-281ms                  | [S0,MB6,B]  292-20-312ms                  | [S0,MB7,B]  323-20-344ms                 
[rank3]:			  [Rank 1]	[S1,MB0,F]  10-10-20ms                    | [S1,MB1,F]  20-10-31ms                    | [S1,MB2,F]  31-10-41ms                    | [S1,MB0,B]  83-20-104ms                   | [S1,MB3,F]  104-10-114ms                  | [S1,MB1,B]  114-20-135ms                  | [S1,MB4,F]  135-10-146ms                  | [S1,MB2,B]  146-20-166ms                  | [S1,MB5,F]  166-10-177ms                  | [S1,MB3,B]  177-20-198ms                  | [S1,MB6,F]  198-10-208ms                  | [S1,MB4,B]  208-20-229ms                  | [S1,MB7,F]  229-10-239ms                  | [S1,MB5,B]  239-20-260ms                  | [S1,MB6,B]  271-20-292ms                  | [S1,MB7,B]  302-20-323ms                 
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-10-31ms                    | [S2,MB1,F]  31-10-41ms                    | [S2,MB0,B]  62-20-83ms                    | [S2,MB2,F]  83-10-93ms                    | [S2,MB1,B]  93-20-114ms                   | [S2,MB3,F]  114-10-125ms                  | [S2,MB2,B]  125-20-146ms                  | [S2,MB4,F]  146-10-156ms                  | [S2,MB3,B]  156-20-177ms                  | [S2,MB5,F]  177-10-187ms                  | [S2,MB4,B]  187-20-208ms                  | [S2,MB6,F]  208-10-219ms                  | [S2,MB5,B]  219-20-239ms                  | [S2,MB7,F]  239-10-250ms                  | [S2,MB6,B]  250-20-271ms                  | [S2,MB7,B]  281-20-302ms                 
[rank3]:			  [Rank 3]	[S3,MB0,F]  31-10-41ms                    | [S3,MB0,B]  41-20-62ms                    | [S3,MB1,F]  62-10-73ms                    | [S3,MB1,B]  73-20-93ms                    | [S3,MB2,F]  93-10-104ms                   | [S3,MB2,B]  104-20-125ms                  | [S3,MB3,F]  125-10-135ms                  | [S3,MB3,B]  135-20-156ms                  | [S3,MB4,F]  156-10-166ms                  | [S3,MB4,B]  166-20-187ms                  | [S3,MB5,F]  187-10-198ms                  | [S3,MB5,B]  198-20-219ms                  | [S3,MB6,F]  219-10-229ms                  | [S3,MB6,B]  229-20-250ms                  | [S3,MB7,F]  250-10-260ms                  | [S3,MB7,B]  260-20-281ms                 
[rank3]:2025-11-28 19:21:24,328 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p70_42_dm1/frozen_ratio_history/rank3/251128_1921_stage3_final800.svg
[rank1]:2025-11-28 19:21:24,337 - INFO - Process group destroyed
[rank3]:2025-11-28 19:21:24,464 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p70_42_dm1/frozen_params_histogram/251128_1921_rank3_stage3.svg
[rank3]:	> Counts Sum: 666, Total Sum: 2175 (30.62%), Ratio(%) per element: [49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 49.33, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-11-28 19:21:24,465 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading history steps 15-16, summary, console lines 355-378
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–ˆâ–‡â–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–ˆâ–‡â–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 4.48281
[rank3]:wandb:               final/avg_loss 0.25946
[rank3]:wandb:             final/avg_mfu(%) 16.82675
[rank3]:wandb:             final/avg_tflops 57.14393
[rank3]:wandb:    final/avg_throughput(tps) 7309.7081
[rank3]:wandb:              final/grad_norm 0.37743
[rank3]:wandb:               final/max_loss 0.25946
[rank3]:wandb:                    grad_norm 0.37743
[rank3]:wandb: loss_metrics/global_avg_loss 0.25946
[rank3]:wandb: loss_metrics/global_max_loss 0.25946
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1116_1F1B_auto_p70_42_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/rjw7qj2i
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1116_1F1B_auto_p70_42_dm1/20251128-1817/wandb/run-20251128_181750-rjw7qj2i/logs
[rank3]:2025-11-28 19:21:25,793 - INFO - Process group destroyed
[rank0]:2025-11-28 19:21:26,229 - INFO - Training completed
[rank0]:2025-11-28 19:21:26,230 - INFO - Destroying the purge thread.
[rank0]:2025-11-28 19:21:26,341 - INFO - Process group destroyed
[rank1]:Stage 1: Modules to keep: {'layers.6', 'layers.5', 'layers.4', 'layers.7', 'layers.8'}
[rank0]:Stage 0: Modules to keep: {'layers.3', 'layers.2', 'layers.0', 'layers.1', 'tok_embeddings'}
[rank2]:Stage 2: Modules to keep: {'layers.9', 'layers.10', 'layers.12', 'layers.11'}
[rank3]:Stage 3: Modules to keep: {'layers.13', 'norm', 'layers.14', 'layers.15', 'output'}
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1116_autofreeze/config_1116.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "AutoFreeze configuration experiment on different PERCENTILE values."
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1116_1F1B_auto_p70_42_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1116_1F1B_auto_p70_42_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1116_1F1B_auto_p70_42_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1116_1F1B_auto_p70_42_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1116_1F1B_auto_p70_42_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1116_1F1B_auto_p70_42_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 42
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: 1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1116_1F1B_auto_p70_42_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1116_1F1B_auto_p70_42_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: auto
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.05
[rank3]:		- percentile: 70
[rank3]:
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
