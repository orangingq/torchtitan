
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 12. 26. (ê¸ˆ) 22:08:56 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 1,2,3,4
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1116_autofreeze/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1116_autofreeze/1226_1F1B_auto_p30_42.log
âœ”ï¸AutoFreeze configuration experiment on different PERCENTILE values.
âœ”ï¸Running with autofreeze (percentile=30) x 1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1116_autofreeze/config_1226.toml --job.description="AutoFreeze configuration experiment on different PERCENTILE values." --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=auto --freezing.percentile=30
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank2]:2025-12-26 22:09:02,213 - Starting job: "AutoFreeze configuration experiment on different PERCENTILE values."
[rank0]:2025-12-26 22:09:02,220 - Starting job: "AutoFreeze configuration experiment on different PERCENTILE values."
[rank3]:2025-12-26 22:09:02,325 - Starting job: "AutoFreeze configuration experiment on different PERCENTILE values."
[rank2]:2025-12-26 22:09:02,405 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-12-26 22:09:02,407 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-26 22:09:02,422 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-12-26 22:09:02,424 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-26 22:09:02,427 - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-12-26 22:09:02,428 - Loading tokenizer from tokenizer.json
[rank3]:2025-12-26 22:09:02,529 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-12-26 22:09:02,532 - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-12-26 22:09:02,518 - Starting job: "AutoFreeze configuration experiment on different PERCENTILE values."
[rank1]:2025-12-26 22:09:02,700 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-12-26 22:09:02,703 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-26 22:09:02,823 - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank0]:2025-12-26 22:09:05,533 - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank0]:2025-12-26 22:09:05,685 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-12-26 22:09:05,724 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-26 22:09:05,725 - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-12-26 22:09:05,752 - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-12-26 22:09:05,753 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank2]:2025-12-26 22:09:05,903 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-12-26 22:09:05,944 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-26 22:09:05,971 - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-12-26 22:09:05,971 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2025-12-26 22:09:05,947 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-26 22:09:05,947 - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-12-26 22:09:05,948 - CUDA memory usage for model: 1.90GiB(3.99%)
[rank1]:2025-12-26 22:09:05,991 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-12-26 22:09:06,028 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-26 22:09:06,056 - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-12-26 22:09:06,056 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank2]:2025-12-26 22:09:06,160 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-26 22:09:06,160 - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-12-26 22:09:06,160 - CUDA memory usage for model: 0.92GiB(1.94%)
[rank1]:2025-12-26 22:09:06,263 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-26 22:09:06,263 - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-12-26 22:09:06,264 - CUDA memory usage for model: 1.13GiB(2.39%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run glbz3mu8
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1226_1F1B_auto_p30_42_dm1/20251226-2209/wandb/run-20251226_220908-glbz3mu8
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1226_1F1B_auto_p30_42_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/glbz3mu8
[rank3]:2025-12-26 22:09:09,782 - WandB logging enabled
[rank3]:2025-12-26 22:09:09,783 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-12-26 22:09:09,824 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-26 22:09:09,854 - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-12-26 22:09:09,854 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank2]:2025-12-26 22:09:10,088 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-26 22:09:10,086 - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1226_1F1B_auto_p30_42_dm1
[rank0]:2025-12-26 22:09:10,086 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-26 22:09:10,087 - Trainer is initialized with local batch size 16, global batch size 128, gradient accumulation steps 8, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2025-12-26 22:09:10,087 - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank1]:2025-12-26 22:09:10,086 - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-12-26 22:09:10,067 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-26 22:09:10,068 - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-12-26 22:09:10,069 - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2025-12-26 22:09:10,086 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-26 22:09:12,503 - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-12-26 22:09:12,503 - Finished loading the checkpoint in 2.42 seconds.
[rank0]:2025-12-26 22:09:12,503 - Training starts at step 1
[rank3]:2025-12-26 22:09:18,180 -  step:  1  loss: 10.6088  grad_norm: 116.5366  memory: 12.97GiB(27.31%)  tps: 3,923  tflops: 30.66  mfu: 9.83%
[rank3]:2025-12-26 22:09:18,181 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-12-26 22:09:18,176 -  step:  1  loss: -8.0000  grad_norm: 116.5366  memory:  7.10GiB(14.94%)  tps: 2,698  tflops: 21.09  mfu: 6.76%
[rank1]:2025-12-26 22:09:18,176 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-12-26 22:09:18,168 -  step:  1  loss: -8.0000  grad_norm: 116.5366  memory:  5.20GiB(10.94%)  tps: 2,681  tflops: 20.96  mfu: 6.72%
[rank2]:2025-12-26 22:09:18,168 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-26 22:09:18,209 -  step:  1  loss: -8.0000  grad_norm: 116.5366  memory:  9.62GiB(20.24%)  tps: 2,625  tflops: 20.52  mfu: 6.58%
[rank0]:2025-12-26 22:09:18,209 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-12-26 22:11:18,940 - Avg. fwd time: 7.3427 / Avg. bwd time: 19.8536 / Avg. batch time: 534.9305 (ms) / GPU bubble ratio: 59.33%
[rank3]:2025-12-26 22:11:18,915 - Avg. fwd time: 13.0198 / Avg. bwd time: 41.8068 / Avg. batch time: 502.1370 (ms) / GPU bubble ratio: 12.65%
[rank0]:2025-12-26 22:11:19,000 - Avg. fwd time: 7.5914 / Avg. bwd time: 24.8380 / Avg. batch time: 613.4874 (ms) / GPU bubble ratio: 57.71%
[rank1]:2025-12-26 22:11:18,970 - Avg. fwd time: 9.1831 / Avg. bwd time: 24.6644 / Avg. batch time: 574.7167 (ms) / GPU bubble ratio: 52.88%
[rank0]:2025-12-26 22:13:21,960 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-26 22:13:26,992 - Avg. fwd time: 7.3479 / Avg. bwd time: 19.9284 / Avg. batch time: 540.3451 (ms) / GPU bubble ratio: 59.62%
[rank1]:2025-12-26 22:13:27,022 - Avg. fwd time: 9.2177 / Avg. bwd time: 24.7533 / Avg. batch time: 579.8550 (ms) / GPU bubble ratio: 53.13%
[rank3]:2025-12-26 22:13:26,967 - Avg. fwd time: 13.3135 / Avg. bwd time: 42.2398 / Avg. batch time: 507.8788 (ms) / GPU bubble ratio: 12.49%
[rank0]:2025-12-26 22:13:27,051 - Avg. fwd time: 7.6098 / Avg. bwd time: 24.9166 / Avg. batch time: 618.2767 (ms) / GPU bubble ratio: 57.91%
[rank0]:2025-12-26 22:13:27,087 -  step: 50  loss: -8.0000  grad_norm: 12.4890  memory: 13.42GiB(28.26%)  tps: 6,451  tflops: 50.43  mfu: 16.16%
[rank2]:2025-12-26 22:13:27,073 -  step: 50  loss: -8.0000  grad_norm: 12.4890  memory:  6.98GiB(14.69%)  tps: 6,451  tflops: 50.43  mfu: 16.16%
[rank1]:2025-12-26 22:13:27,076 -  step: 50  loss: -8.0000  grad_norm: 12.4890  memory:  9.50GiB(19.99%)  tps: 6,451  tflops: 50.43  mfu: 16.16%
[rank3]:2025-12-26 22:13:27,085 -  step: 50  loss:  9.9044  grad_norm: 12.4890  memory: 16.39GiB(34.50%)  tps: 6,451  tflops: 50.43  mfu: 16.16%
[rank0]:2025-12-26 22:14:13,440 - Freezing Ratio: [Stage0] 0.00, Threshold: 0.0000e+00
[rank1]:2025-12-26 22:14:13,428 - Freezing Ratio: [Stage1] 0.00, Threshold: 0.0000e+00
[rank2]:2025-12-26 22:14:13,424 - Freezing Ratio: [Stage2] 0.00, Threshold: 0.0000e+00
[rank3]:2025-12-26 22:14:13,436 - Freezing Ratio: [Stage3] 0.00, Threshold: 0.0000e+00
[rank2]:2025-12-26 22:15:04,852 - Freezing Ratio: [Stage2] 0.00, Threshold: 7.8638e-01
[rank3]:2025-12-26 22:15:04,863 - Freezing Ratio: [Stage3] 0.31, Threshold: 1.8043e+00
[rank1]:2025-12-26 22:15:04,856 - Freezing Ratio: [Stage1] 0.00, Threshold: 1.6653e+00
[rank0]:2025-12-26 22:15:04,869 - Freezing Ratio: [Stage0] 0.00, Threshold: 2.2042e+00
[rank3]:2025-12-26 22:15:34,396 - Avg. fwd time: 13.4587 / Avg. bwd time: 42.1888 / Avg. batch time: 508.6057 (ms) / GPU bubble ratio: 12.47%
[rank1]:2025-12-26 22:15:34,451 - Avg. fwd time: 9.2385 / Avg. bwd time: 24.8101 / Avg. batch time: 580.4384 (ms) / GPU bubble ratio: 53.07%
[rank2]:2025-12-26 22:15:34,421 - Avg. fwd time: 7.3501 / Avg. bwd time: 19.9775 / Avg. batch time: 540.9896 (ms) / GPU bubble ratio: 59.59%
[rank0]:2025-12-26 22:15:34,482 - Avg. fwd time: 7.6216 / Avg. bwd time: 24.9642 / Avg. batch time: 618.7549 (ms) / GPU bubble ratio: 57.87%
[rank2]:2025-12-26 22:15:54,123 - Freezing Ratio: [Stage2] 0.25, Threshold: 7.1863e-01
[rank3]:2025-12-26 22:15:54,131 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.6875e+00
[rank1]:2025-12-26 22:15:54,128 - Freezing Ratio: [Stage1] 0.00, Threshold: 8.1055e-01
[rank0]:2025-12-26 22:15:54,139 - Freezing Ratio: [Stage0] 0.00, Threshold: 8.7148e-01
[rank2]:2025-12-26 22:16:45,477 - Freezing Ratio: [Stage2] 0.00, Threshold: 6.5620e+00
[rank3]:2025-12-26 22:16:45,493 - Freezing Ratio: [Stage3] 0.31, Threshold: 3.9491e+00
[rank1]:2025-12-26 22:16:45,485 - Freezing Ratio: [Stage1] 0.00, Threshold: 5.7679e+00
[rank0]:2025-12-26 22:16:45,498 - Freezing Ratio: [Stage0] 0.00, Threshold: 9.0897e+00
[rank0]:2025-12-26 22:17:34,521 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-12-26 22:17:34,543 - Freezing Ratio: [Stage3] 0.00, Threshold: 3.3709e+00
[rank2]:2025-12-26 22:17:34,535 - Freezing Ratio: [Stage2] 0.25, Threshold: 1.6652e+00
[rank1]:2025-12-26 22:17:34,539 - Freezing Ratio: [Stage1] 0.00, Threshold: 1.2763e+00
[rank0]:2025-12-26 22:17:34,551 - Freezing Ratio: [Stage0] 0.00, Threshold: 4.1537e+00
[rank3]:2025-12-26 22:17:39,531 - Avg. fwd time: 13.4900 / Avg. bwd time: 41.8789 / Avg. batch time: 506.3658 (ms) / GPU bubble ratio: 12.52%
[rank2]:2025-12-26 22:17:39,554 - Avg. fwd time: 7.3891 / Avg. bwd time: 19.6861 / Avg. batch time: 538.3816 (ms) / GPU bubble ratio: 59.77%
[rank1]:2025-12-26 22:17:39,584 - Avg. fwd time: 9.2436 / Avg. bwd time: 24.8422 / Avg. batch time: 577.8072 (ms) / GPU bubble ratio: 52.81%
[rank0]:2025-12-26 22:17:39,614 - Avg. fwd time: 7.6230 / Avg. bwd time: 24.9898 / Avg. batch time: 616.0627 (ms) / GPU bubble ratio: 57.65%
[rank0]:2025-12-26 22:17:39,650 -  step: 100  loss: -8.0000  grad_norm:  8.1933  memory: 13.42GiB(28.26%)  tps: 6,487  tflops: 50.71  mfu: 16.25%
[rank3]:2025-12-26 22:17:39,648 -  step: 100  loss:  8.3186  grad_norm:  8.1933  memory: 16.39GiB(34.50%)  tps: 6,487  tflops: 50.71  mfu: 16.25%
[rank2]:2025-12-26 22:17:39,633 -  step: 100  loss: -8.0000  grad_norm:  8.1933  memory:  6.98GiB(14.69%)  tps: 6,487  tflops: 50.71  mfu: 16.25%
[rank1]:2025-12-26 22:17:39,639 -  step: 100  loss: -8.0000  grad_norm:  8.1933  memory:  9.50GiB(19.99%)  tps: 6,487  tflops: 50.71  mfu: 16.25%
[rank1]:2025-12-26 22:17:39,718 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p30_42_dm1/frozen_ratio_history/rank1/251226_2217_stage1_step100.svg
[rank0]:2025-12-26 22:17:39,717 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p30_42_dm1/frozen_ratio_history/rank0/251226_2217_stage0_step100.svg
[rank2]:2025-12-26 22:17:39,718 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p30_42_dm1/frozen_ratio_history/rank2/251226_2217_stage2_step100.svg
[rank3]:2025-12-26 22:17:39,818 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p30_42_dm1/pipeline_schedule/251226_2217_step100_rank3.svg
[rank3]:			> Batch Time: 603.14 ms, GPU Bubble Ratio: 56.46%, 54.57%, 63.48%, 29.31%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB0,B]  145-25-170ms   | [S0,MB4,F]  170-7-177ms    | [S0,MB1,B]  203-25-228ms   | [S0,MB5,F]  228-7-235ms    | [S0,MB2,B]  264-25-289ms   | [S0,MB6,F]  290-7-297ms    | [S0,MB3,B]  328-25-353ms   | [S0,MB7,F]  353-7-360ms    | [S0,MB4,B]  391-25-416ms   | [S0,MB5,B]  452-25-477ms   | [S0,MB6,B]  514-25-539ms   | [S0,MB7,B]  578-25-603ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-8-32ms      | [S1,MB2,F]  35-8-44ms      | [S1,MB0,B]  114-25-140ms   | [S1,MB3,F]  143-8-152ms    | [S1,MB1,B]  173-25-198ms   | [S1,MB4,F]  201-9-210ms    | [S1,MB2,B]  234-25-259ms   | [S1,MB5,F]  263-9-272ms    | [S1,MB3,B]  298-25-323ms   | [S1,MB6,F]  326-9-335ms    | [S1,MB4,B]  361-25-386ms   | [S1,MB7,F]  389-8-398ms    | [S1,MB5,B]  423-24-448ms   | [S1,MB6,B]  485-25-510ms   | [S1,MB7,B]  549-24-574ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-7-39ms      | [S2,MB0,B]  89-20-110ms    | [S2,MB2,F]  113-7-120ms    | [S2,MB1,B]  147-20-167ms   | [S2,MB3,F]  171-7-178ms    | [S2,MB2,B]  209-20-229ms   | [S2,MB4,F]  232-7-240ms    | [S2,MB3,B]  272-20-292ms   | [S2,MB5,F]  296-7-303ms    | [S2,MB4,B]  335-20-356ms   | [S2,MB6,F]  359-7-366ms    | [S2,MB5,B]  398-20-418ms   | [S2,MB7,F]  422-7-429ms    | [S2,MB6,B]  462-20-482ms   | [S2,MB7,B]  525-20-545ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  48-37-85ms     | [S3,MB1,F]  88-11-99ms     | [S3,MB1,B]  105-38-143ms   | [S3,MB2,F]  146-13-159ms   | [S3,MB2,B]  165-39-204ms   | [S3,MB3,F]  207-14-221ms   | [S3,MB3,B]  227-40-267ms   | [S3,MB4,F]  271-13-284ms   | [S3,MB4,B]  291-41-332ms   | [S3,MB5,F]  334-13-347ms   | [S3,MB5,B]  354-40-395ms   | [S3,MB6,F]  396-14-411ms   | [S3,MB6,B]  418-40-458ms   | [S3,MB7,F]  460-14-474ms   | [S3,MB7,B]  481-40-521ms  
[rank3]:2025-12-26 22:17:39,862 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p30_42_dm1/frozen_ratio_history/rank3/251226_2217_stage3_step100.svg
[rank1]:2025-12-26 22:17:39,867 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p30_42_dm1/frozen_params_histogram/251226_2217_rank1_stage1.svg
[rank1]:	> Counts Sum: 0, Total Sum: 225 (0.00%), Ratio(%) per element: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-12-26 22:17:39,878 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p30_42_dm1/frozen_params_histogram/251226_2217_rank0_stage0.svg
[rank0]:	> Counts Sum: 0, Total Sum: 185 (0.00%), Ratio(%) per element: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-12-26 22:17:39,875 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p30_42_dm1/frozen_params_histogram/251226_2217_rank2_stage2.svg
[rank2]:	> Counts Sum: 18, Total Sum: 180 (10.00%), Ratio(%) per element: [40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-26 22:17:39,998 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p30_42_dm1/frozen_params_histogram/251226_2217_rank3_stage3.svg
[rank3]:	> Counts Sum: 18, Total Sum: 145 (12.41%), Ratio(%) per element: [40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-12-26 22:18:26,049 - Freezing Ratio: [Stage1] 0.00, Threshold: 6.1853e-01
[rank0]:2025-12-26 22:18:26,061 - Freezing Ratio: [Stage0] 0.00, Threshold: 1.0694e+00
[rank2]:2025-12-26 22:18:26,041 - Freezing Ratio: [Stage2] 0.00, Threshold: 8.7529e-01
[rank3]:2025-12-26 22:18:26,056 - Freezing Ratio: [Stage3] 0.31, Threshold: 1.9060e+00
[rank2]:2025-12-26 22:19:15,293 - Freezing Ratio: [Stage2] 0.25, Threshold: 3.0216e+00
[rank3]:2025-12-26 22:19:15,301 - Freezing Ratio: [Stage3] 0.00, Threshold: 4.7946e+00
[rank1]:2025-12-26 22:19:15,297 - Freezing Ratio: [Stage1] 0.40, Threshold: 2.6151e+00
[rank0]:2025-12-26 22:19:15,310 - Freezing Ratio: [Stage0] 0.00, Threshold: 3.8760e+00
[rank2]:2025-12-26 22:19:45,487 - Avg. fwd time: 7.4222 / Avg. bwd time: 19.4193 / Avg. batch time: 537.6547 (ms) / GPU bubble ratio: 60.06%
[rank3]:2025-12-26 22:19:45,464 - Avg. fwd time: 13.5145 / Avg. bwd time: 41.7922 / Avg. batch time: 505.8643 (ms) / GPU bubble ratio: 12.54%
[rank1]:2025-12-26 22:19:45,512 - Avg. fwd time: 9.2785 / Avg. bwd time: 24.5881 / Avg. batch time: 576.7954 (ms) / GPU bubble ratio: 53.03%
[rank0]:2025-12-26 22:19:45,543 - Avg. fwd time: 7.6256 / Avg. bwd time: 25.0022 / Avg. batch time: 615.0181 (ms) / GPU bubble ratio: 57.56%
[rank1]:2025-12-26 22:20:05,984 - Freezing Ratio: [Stage1] 0.00, Threshold: 1.6136e+00
[rank2]:2025-12-26 22:20:05,984 - Freezing Ratio: [Stage2] 0.00, Threshold: 2.1292e+00
[rank0]:2025-12-26 22:20:06,003 - Freezing Ratio: [Stage0] 0.00, Threshold: 2.7659e+00
[rank3]:2025-12-26 22:20:05,999 - Freezing Ratio: [Stage3] 0.31, Threshold: 2.6760e+00
[rank1]:2025-12-26 22:20:55,174 - Freezing Ratio: [Stage1] 0.40, Threshold: 1.3266e+00
[rank3]:2025-12-26 22:20:55,177 - Freezing Ratio: [Stage3] 0.00, Threshold: 2.5900e+00
[rank2]:2025-12-26 22:20:55,170 - Freezing Ratio: [Stage2] 0.25, Threshold: 5.6643e+00
[rank0]:2025-12-26 22:20:55,185 - Freezing Ratio: [Stage0] 0.00, Threshold: 7.3350e+00
[rank1]:2025-12-26 22:21:45,850 - Freezing Ratio: [Stage1] 0.00, Threshold: 3.1718e+00
[rank3]:2025-12-26 22:21:45,865 - Freezing Ratio: [Stage3] 0.31, Threshold: 3.6442e+00
[rank2]:2025-12-26 22:21:45,850 - Freezing Ratio: [Stage2] 0.00, Threshold: 4.3811e+00
[rank0]:2025-12-26 22:21:45,848 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-26 22:21:45,870 - Freezing Ratio: [Stage0] 0.00, Threshold: 2.9444e+00
[rank3]:2025-12-26 22:21:50,737 - Avg. fwd time: 13.5345 / Avg. bwd time: 41.7150 / Avg. batch time: 505.4018 (ms) / GPU bubble ratio: 12.55%
[rank2]:2025-12-26 22:21:50,763 - Avg. fwd time: 7.4410 / Avg. bwd time: 19.2636 / Avg. batch time: 536.9895 (ms) / GPU bubble ratio: 60.22%
[rank1]:2025-12-26 22:21:50,793 - Avg. fwd time: 9.3357 / Avg. bwd time: 24.1187 / Avg. batch time: 575.6396 (ms) / GPU bubble ratio: 53.51%
[rank1]:2025-12-26 22:21:50,849 -  step: 150  loss: -8.0000  grad_norm: 40.3962  memory:  9.50GiB(19.99%)  tps: 6,522  tflops: 50.99  mfu: 16.34%
[rank3]:2025-12-26 22:21:50,855 -  step: 150  loss:  3.6830  grad_norm: 40.3962  memory: 16.39GiB(34.50%)  tps: 6,522  tflops: 50.99  mfu: 16.34%
[rank2]:2025-12-26 22:21:50,846 -  step: 150  loss: -8.0000  grad_norm: 40.3962  memory:  6.98GiB(14.69%)  tps: 6,522  tflops: 50.99  mfu: 16.34%
[rank0]:2025-12-26 22:21:50,824 - Avg. fwd time: 7.6313 / Avg. bwd time: 25.0155 / Avg. batch time: 613.8680 (ms) / GPU bubble ratio: 57.45%
[rank0]:2025-12-26 22:21:50,860 -  step: 150  loss: -8.0000  grad_norm: 40.3962  memory: 13.42GiB(28.26%)  tps: 6,522  tflops: 50.99  mfu: 16.34%
[rank1]:2025-12-26 22:22:35,108 - Freezing Ratio: [Stage1] 0.40, Threshold: 3.3773e+00
[rank3]:2025-12-26 22:22:35,112 - Freezing Ratio: [Stage3] 0.31, Threshold: 2.6137e+01
[rank0]:2025-12-26 22:22:35,121 - Freezing Ratio: [Stage0] 0.24, Threshold: 1.6754e+01
[rank2]:2025-12-26 22:22:35,104 - Freezing Ratio: [Stage2] 0.25, Threshold: 1.9533e+01
[rank2]:2025-12-26 22:23:23,543 - Freezing Ratio: [Stage2] 0.00, Threshold: 4.9323e+00
[rank1]:2025-12-26 22:23:23,543 - Freezing Ratio: [Stage1] 0.00, Threshold: 4.9486e+00
[rank3]:2025-12-26 22:23:23,554 - Freezing Ratio: [Stage3] 0.31, Threshold: 3.0169e+00
[rank0]:2025-12-26 22:23:23,558 - Freezing Ratio: [Stage0] 0.00, Threshold: 4.5019e+00
[rank2]:2025-12-26 22:23:52,947 - Avg. fwd time: 7.4467 / Avg. bwd time: 19.2198 / Avg. batch time: 534.3701 (ms) / GPU bubble ratio: 60.08%
[rank3]:2025-12-26 22:23:52,921 - Avg. fwd time: 13.5444 / Avg. bwd time: 41.3850 / Avg. batch time: 502.8550 (ms) / GPU bubble ratio: 12.61%
[rank1]:2025-12-26 22:23:52,978 - Avg. fwd time: 9.3601 / Avg. bwd time: 23.9162 / Avg. batch time: 572.8004 (ms) / GPU bubble ratio: 53.52%
[rank0]:2025-12-26 22:23:53,010 - Avg. fwd time: 7.6553 / Avg. bwd time: 24.8661 / Avg. batch time: 610.8712 (ms) / GPU bubble ratio: 57.41%
[rank2]:2025-12-26 22:24:12,801 - Freezing Ratio: [Stage2] 0.25, Threshold: 4.6240e-01
[rank3]:2025-12-26 22:24:12,808 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.3817e+00
[rank1]:2025-12-26 22:24:12,805 - Freezing Ratio: [Stage1] 0.40, Threshold: 1.6739e-01
[rank0]:2025-12-26 22:24:12,817 - Freezing Ratio: [Stage0] 0.24, Threshold: 1.1105e+00
[rank2]:2025-12-26 22:24:59,363 - Freezing Ratio: [Stage2] 0.00, Threshold: 1.3019e+00
[rank0]:2025-12-26 22:24:59,379 - Freezing Ratio: [Stage0] 0.00, Threshold: 1.5909e+00
[rank1]:2025-12-26 22:24:59,363 - Freezing Ratio: [Stage1] 0.00, Threshold: 1.1873e+00
[rank3]:2025-12-26 22:24:59,371 - Freezing Ratio: [Stage3] 0.31, Threshold: 2.2333e+00
[rank2]:2025-12-26 22:25:48,682 - Freezing Ratio: [Stage2] 0.25, Threshold: 1.9195e+00
[rank3]:2025-12-26 22:25:48,690 - Freezing Ratio: [Stage3] 0.62, Threshold: 5.4811e-01
[rank0]:2025-12-26 22:25:48,668 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-26 22:25:48,698 - Freezing Ratio: [Stage0] 0.24, Threshold: 1.6239e+00
[rank1]:2025-12-26 22:25:48,687 - Freezing Ratio: [Stage1] 0.40, Threshold: 4.8759e-01
[rank3]:2025-12-26 22:25:53,268 - Avg. fwd time: 13.6035 / Avg. bwd time: 40.9584 / Avg. batch time: 499.9052 (ms) / GPU bubble ratio: 12.68%
[rank2]:2025-12-26 22:25:53,292 - Avg. fwd time: 7.4520 / Avg. bwd time: 19.1797 / Avg. batch time: 531.3565 (ms) / GPU bubble ratio: 59.90%
[rank0]:2025-12-26 22:25:53,346 - Avg. fwd time: 7.6749 / Avg. bwd time: 24.7450 / Avg. batch time: 607.5322 (ms) / GPU bubble ratio: 57.31%
[rank1]:2025-12-26 22:25:53,318 - Avg. fwd time: 9.3821 / Avg. bwd time: 23.7414 / Avg. batch time: 569.5943 (ms) / GPU bubble ratio: 53.48%
[rank1]:2025-12-26 22:25:53,364 -  step: 200  loss: -8.0000  grad_norm:  8.1086  memory:  9.50GiB(19.99%)  tps: 6,756  tflops: 52.81  mfu: 16.93%
[rank3]:2025-12-26 22:25:53,373 -  step: 200  loss:  1.0813  grad_norm:  8.1086  memory: 18.36GiB(38.65%)  tps: 6,756  tflops: 52.81  mfu: 16.93%
[rank2]:2025-12-26 22:25:53,364 -  step: 200  loss: -8.0000  grad_norm:  8.1086  memory:  6.98GiB(14.69%)  tps: 6,756  tflops: 52.81  mfu: 16.93%
[rank2]:2025-12-26 22:25:53,427 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p30_42_dm1/frozen_ratio_history/rank2/251226_2225_stage2_step200.svg
[rank0]:2025-12-26 22:25:53,378 -  step: 200  loss: -8.0000  grad_norm:  8.1086  memory: 13.42GiB(28.26%)  tps: 6,756  tflops: 52.81  mfu: 16.93%
[rank0]:2025-12-26 22:25:53,428 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p30_42_dm1/frozen_ratio_history/rank0/251226_2225_stage0_step200.svg
[rank1]:2025-12-26 22:25:53,433 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p30_42_dm1/frozen_ratio_history/rank1/251226_2225_stage1_step200.svg
[rank3]:2025-12-26 22:25:53,518 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p30_42_dm1/pipeline_schedule/251226_2225_step200_rank3.svg
[rank3]:			> Batch Time: 595.67 ms, GPU Bubble Ratio: 55.76%, 53.82%, 63.00%, 28.99%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-7-33ms      | [S0,MB0,B]  145-25-170ms   | [S0,MB4,F]  170-7-177ms    | [S0,MB1,B]  202-25-227ms   | [S0,MB5,F]  227-7-235ms    | [S0,MB2,B]  263-25-288ms   | [S0,MB6,F]  288-7-295ms    | [S0,MB3,B]  324-25-349ms   | [S0,MB7,F]  349-7-356ms    | [S0,MB4,B]  387-25-413ms   | [S0,MB5,B]  449-25-474ms   | [S0,MB6,B]  509-25-534ms   | [S0,MB7,B]  570-25-595ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  24-8-32ms      | [S1,MB2,F]  35-8-44ms      | [S1,MB0,B]  114-25-140ms   | [S1,MB3,F]  143-9-152ms    | [S1,MB1,B]  172-25-197ms   | [S1,MB4,F]  200-9-210ms    | [S1,MB2,B]  232-25-258ms   | [S1,MB5,F]  261-9-271ms    | [S1,MB3,B]  294-25-319ms   | [S1,MB6,F]  322-9-331ms    | [S1,MB4,B]  357-25-382ms   | [S1,MB7,F]  386-8-395ms    | [S1,MB5,B]  420-25-445ms   | [S1,MB6,B]  481-25-506ms   | [S1,MB7,B]  542-25-567ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-7-39ms      | [S2,MB0,B]  89-20-109ms    | [S2,MB2,F]  113-7-120ms    | [S2,MB1,B]  147-20-167ms   | [S2,MB3,F]  170-7-177ms    | [S2,MB2,B]  207-20-227ms   | [S2,MB4,F]  231-7-238ms    | [S2,MB3,B]  268-20-289ms   | [S2,MB5,F]  292-7-299ms    | [S2,MB4,B]  332-20-352ms   | [S2,MB6,F]  356-7-363ms    | [S2,MB5,B]  395-20-415ms   | [S2,MB7,F]  419-7-426ms    | [S2,MB6,B]  457-20-477ms   | [S2,MB7,B]  519-20-539ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-43ms     | [S3,MB0,B]  48-36-85ms     | [S3,MB1,F]  87-11-99ms     | [S3,MB1,B]  105-37-143ms   | [S3,MB2,F]  145-13-159ms   | [S3,MB2,B]  164-38-203ms   | [S3,MB3,F]  206-14-220ms   | [S3,MB3,B]  225-39-265ms   | [S3,MB4,F]  267-14-281ms   | [S3,MB4,B]  288-40-329ms   | [S3,MB5,F]  330-13-344ms   | [S3,MB5,B]  351-40-391ms   | [S3,MB6,F]  393-13-407ms   | [S3,MB6,B]  413-39-453ms   | [S3,MB7,F]  455-14-470ms   | [S3,MB7,B]  476-39-515ms  
[rank1]:2025-12-26 22:25:53,578 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p30_42_dm1/frozen_params_histogram/251226_2225_rank1_stage1.svg
[rank1]:	> Counts Sum: 90, Total Sum: 675 (13.33%), Ratio(%) per element: [33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 33.33, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-26 22:25:53,564 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p30_42_dm1/frozen_ratio_history/rank3/251226_2225_stage3_step200.svg
[rank2]:2025-12-26 22:25:53,578 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p30_42_dm1/frozen_params_histogram/251226_2225_rank2_stage2.svg
[rank2]:	> Counts Sum: 63, Total Sum: 540 (11.67%), Ratio(%) per element: [46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-12-26 22:25:53,585 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p30_42_dm1/frozen_params_histogram/251226_2225_rank0_stage0.svg
[rank0]:	> Counts Sum: 27, Total Sum: 555 (4.86%), Ratio(%) per element: [0.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-26 22:25:53,706 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p30_42_dm1/frozen_params_histogram/251226_2225_rank3_stage3.svg
[rank3]:	> Counts Sum: 108, Total Sum: 435 (24.83%), Ratio(%) per element: [66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 13.33, 13.33, 13.33, 13.33, 13.33, 13.33, 13.33, 13.33, 13.33, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-12-26 22:26:35,628 - Freezing Ratio: [Stage1] 0.00, Threshold: 2.1788e+00
[rank3]:2025-12-26 22:26:35,636 - Freezing Ratio: [Stage3] 0.31, Threshold: 3.5166e+00
[rank2]:2025-12-26 22:26:35,628 - Freezing Ratio: [Stage2] 0.00, Threshold: 2.9619e+00
[rank0]:2025-12-26 22:26:35,644 - Freezing Ratio: [Stage0] 0.00, Threshold: 1.7586e+00
[rank2]:2025-12-26 22:27:24,720 - Freezing Ratio: [Stage2] 0.25, Threshold: 8.5849e+00
[rank3]:2025-12-26 22:27:24,726 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.9010e+00
[rank0]:2025-12-26 22:27:24,734 - Freezing Ratio: [Stage0] 0.24, Threshold: 6.4839e+00
[rank1]:2025-12-26 22:27:24,722 - Freezing Ratio: [Stage1] 0.40, Threshold: 1.3141e+00
[rank2]:2025-12-26 22:27:52,689 - Avg. fwd time: 7.4616 / Avg. bwd time: 19.0994 / Avg. batch time: 528.5250 (ms) / GPU bubble ratio: 59.80%
[rank3]:2025-12-26 22:27:52,664 - Avg. fwd time: 13.6482 / Avg. bwd time: 40.5675 / Avg. batch time: 497.1236 (ms) / GPU bubble ratio: 12.75%
[rank1]:2025-12-26 22:27:52,716 - Avg. fwd time: 9.4074 / Avg. bwd time: 23.5039 / Avg. batch time: 566.5150 (ms) / GPU bubble ratio: 53.52%
[rank0]:2025-12-26 22:27:52,745 - Avg. fwd time: 7.6975 / Avg. bwd time: 24.5995 / Avg. batch time: 604.3079 (ms) / GPU bubble ratio: 57.24%
[rank1]:2025-12-26 22:28:11,359 - Freezing Ratio: [Stage1] 0.00, Threshold: 2.2848e+00
[rank2]:2025-12-26 22:28:11,359 - Freezing Ratio: [Stage2] 0.00, Threshold: 3.4869e+00
[rank3]:2025-12-26 22:28:11,366 - Freezing Ratio: [Stage3] 0.31, Threshold: 3.2880e+00
[rank0]:2025-12-26 22:28:11,374 - Freezing Ratio: [Stage0] 0.00, Threshold: 2.8680e+00
[rank2]:2025-12-26 22:29:00,560 - Freezing Ratio: [Stage2] 0.25, Threshold: 1.5305e+00
[rank3]:2025-12-26 22:29:00,568 - Freezing Ratio: [Stage3] 0.62, Threshold: 6.3974e-01
[rank0]:2025-12-26 22:29:00,576 - Freezing Ratio: [Stage0] 0.24, Threshold: 3.4518e+00
[rank1]:2025-12-26 22:29:00,564 - Freezing Ratio: [Stage1] 0.40, Threshold: 6.5527e-01
[rank3]:2025-12-26 22:29:47,235 - Freezing Ratio: [Stage3] 0.31, Threshold: 3.3859e+00
[rank0]:2025-12-26 22:29:47,226 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-26 22:29:47,243 - Freezing Ratio: [Stage0] 0.00, Threshold: 1.3238e+00
[rank1]:2025-12-26 22:29:47,227 - Freezing Ratio: [Stage1] 0.00, Threshold: 1.1978e+00
[rank2]:2025-12-26 22:29:47,227 - Freezing Ratio: [Stage2] 0.00, Threshold: 2.4830e+00
[rank3]:2025-12-26 22:29:52,059 - Avg. fwd time: 13.6907 / Avg. bwd time: 40.2644 / Avg. batch time: 495.0333 (ms) / GPU bubble ratio: 12.81%
[rank2]:2025-12-26 22:29:52,087 - Avg. fwd time: 7.4682 / Avg. bwd time: 19.0485 / Avg. batch time: 526.3632 (ms) / GPU bubble ratio: 59.70%
[rank0]:2025-12-26 22:29:52,151 - Avg. fwd time: 7.7131 / Avg. bwd time: 24.4952 / Avg. batch time: 601.8588 (ms) / GPU bubble ratio: 57.19%
[rank1]:2025-12-26 22:29:52,119 - Avg. fwd time: 9.4253 / Avg. bwd time: 23.3383 / Avg. batch time: 564.1768 (ms) / GPU bubble ratio: 53.54%
[rank1]:2025-12-26 22:29:52,176 -  step: 250  loss: -8.0000  grad_norm:  1.9034  memory:  9.50GiB(19.99%)  tps: 6,861  tflops: 53.63  mfu: 17.19%
[rank2]:2025-12-26 22:29:52,173 -  step: 250  loss: -8.0000  grad_norm:  1.9034  memory:  6.98GiB(14.69%)  tps: 6,861  tflops: 53.63  mfu: 17.19%
[rank3]:2025-12-26 22:29:52,183 -  step: 250  loss:  0.3803  grad_norm:  1.9034  memory: 18.36GiB(38.65%)  tps: 6,861  tflops: 53.63  mfu: 17.19%
[rank0]:2025-12-26 22:29:52,187 -  step: 250  loss: -8.0000  grad_norm:  1.9034  memory: 13.42GiB(28.26%)  tps: 6,861  tflops: 53.63  mfu: 17.19%
[rank3]:2025-12-26 22:30:36,584 - Freezing Ratio: [Stage3] 0.62, Threshold: 2.5902e-01
[rank0]:2025-12-26 22:30:36,591 - Freezing Ratio: [Stage0] 0.24, Threshold: 1.2760e+00
[rank1]:2025-12-26 22:30:36,580 - Freezing Ratio: [Stage1] 0.40, Threshold: 2.6579e-01
[rank2]:2025-12-26 22:30:36,576 - Freezing Ratio: [Stage2] 0.25, Threshold: 7.6724e-01
[rank1]:2025-12-26 22:31:23,177 - Freezing Ratio: [Stage1] 0.40, Threshold: 1.3053e+01
[rank2]:2025-12-26 22:31:23,177 - Freezing Ratio: [Stage2] 0.25, Threshold: 1.4872e+01
[rank3]:2025-12-26 22:31:23,185 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.2429e+01
[rank0]:2025-12-26 22:31:23,193 - Freezing Ratio: [Stage0] 0.49, Threshold: 1.1764e+01
[rank3]:2025-12-26 22:31:50,968 - Avg. fwd time: 13.7388 / Avg. bwd time: 39.9938 / Avg. batch time: 493.2477 (ms) / GPU bubble ratio: 12.85%
[rank1]:2025-12-26 22:31:51,020 - Avg. fwd time: 9.4462 / Avg. bwd time: 23.1635 / Avg. batch time: 562.1300 (ms) / GPU bubble ratio: 53.59%
[rank2]:2025-12-26 22:31:50,994 - Avg. fwd time: 7.4761 / Avg. bwd time: 18.9873 / Avg. batch time: 524.4996 (ms) / GPU bubble ratio: 59.64%
[rank0]:2025-12-26 22:31:51,047 - Avg. fwd time: 7.7366 / Avg. bwd time: 24.3268 / Avg. batch time: 599.6382 (ms) / GPU bubble ratio: 57.22%
[rank1]:2025-12-26 22:32:09,640 - Freezing Ratio: [Stage1] 0.40, Threshold: 1.8887e+00
[rank2]:2025-12-26 22:32:09,640 - Freezing Ratio: [Stage2] 0.50, Threshold: 1.8710e+00
[rank3]:2025-12-26 22:32:09,648 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.0210e+00
[rank0]:2025-12-26 22:32:09,652 - Freezing Ratio: [Stage0] 0.24, Threshold: 1.6051e+00
[rank3]:2025-12-26 22:32:56,291 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.1738e+00
[rank0]:2025-12-26 22:32:56,299 - Freezing Ratio: [Stage0] 0.49, Threshold: 1.0519e+00
[rank2]:2025-12-26 22:32:56,280 - Freezing Ratio: [Stage2] 0.25, Threshold: 1.1706e+00
[rank1]:2025-12-26 22:32:56,284 - Freezing Ratio: [Stage1] 0.40, Threshold: 1.4650e+00
[rank3]:2025-12-26 22:33:42,712 - Freezing Ratio: [Stage3] 0.62, Threshold: 8.0439e-01
[rank0]:2025-12-26 22:33:42,695 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-26 22:33:42,716 - Freezing Ratio: [Stage0] 0.24, Threshold: 2.6154e+00
[rank2]:2025-12-26 22:33:42,704 - Freezing Ratio: [Stage2] 0.50, Threshold: 8.5882e-01
[rank1]:2025-12-26 22:33:42,704 - Freezing Ratio: [Stage1] 0.60, Threshold: 1.6766e+00
[rank3]:2025-12-26 22:33:47,271 - Avg. fwd time: 13.8065 / Avg. bwd time: 39.6675 / Avg. batch time: 491.2016 (ms) / GPU bubble ratio: 12.91%
[rank2]:2025-12-26 22:33:47,294 - Avg. fwd time: 7.5073 / Avg. bwd time: 18.7445 / Avg. batch time: 522.1989 (ms) / GPU bubble ratio: 59.78%
[rank0]:2025-12-26 22:33:47,348 - Avg. fwd time: 7.7832 / Avg. bwd time: 24.0237 / Avg. batch time: 596.7222 (ms) / GPU bubble ratio: 57.36%
[rank0]:2025-12-26 22:33:47,379 -  step: 300  loss: -8.0000  grad_norm:  0.3790  memory: 13.42GiB(28.26%)  tps: 6,966  tflops: 54.46  mfu: 17.45%
[rank2]:2025-12-26 22:33:47,362 -  step: 300  loss: -8.0000  grad_norm:  0.3790  memory:  6.98GiB(14.69%)  tps: 6,966  tflops: 54.46  mfu: 17.45%
[rank1]:2025-12-26 22:33:47,318 - Avg. fwd time: 9.4826 / Avg. bwd time: 22.8379 / Avg. batch time: 559.5016 (ms) / GPU bubble ratio: 53.79%
[rank1]:2025-12-26 22:33:47,362 -  step: 300  loss: -8.0000  grad_norm:  0.3790  memory:  9.50GiB(19.99%)  tps: 6,966  tflops: 54.46  mfu: 17.46%
[rank3]:2025-12-26 22:33:47,375 -  step: 300  loss:  0.2821  grad_norm:  0.3790  memory: 18.36GiB(38.65%)  tps: 6,966  tflops: 54.46  mfu: 17.45%
[rank0]:2025-12-26 22:33:47,428 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p30_42_dm1/frozen_ratio_history/rank0/251226_2233_stage0_step300.svg
[rank2]:2025-12-26 22:33:47,431 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p30_42_dm1/frozen_ratio_history/rank2/251226_2233_stage2_step300.svg
[rank1]:2025-12-26 22:33:47,430 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p30_42_dm1/frozen_ratio_history/rank1/251226_2233_stage1_step300.svg
[rank3]:2025-12-26 22:33:47,520 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p30_42_dm1/pipeline_schedule/251226_2233_step300_rank3.svg
[rank3]:			> Batch Time: 564.47 ms, GPU Bubble Ratio: 60.49%, 58.47%, 64.47%, 28.24%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-8-18ms       | [S0,MB2,F]  18-8-27ms      | [S0,MB3,F]  27-8-35ms      | [S0,MB0,B]  134-19-153ms   | [S0,MB4,F]  153-7-161ms    | [S0,MB1,B]  188-19-207ms   | [S0,MB5,F]  207-7-215ms    | [S0,MB2,B]  245-19-265ms   | [S0,MB6,F]  265-7-273ms    | [S0,MB3,B]  305-19-325ms   | [S0,MB7,F]  325-7-333ms    | [S0,MB4,B]  366-19-386ms   | [S0,MB5,B]  425-19-444ms   | [S0,MB6,B]  484-19-504ms   | [S0,MB7,B]  545-19-564ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-9-33ms      | [S1,MB2,F]  36-9-46ms      | [S1,MB0,B]  109-19-128ms   | [S1,MB3,F]  132-9-142ms    | [S1,MB1,B]  163-19-183ms   | [S1,MB4,F]  186-9-196ms    | [S1,MB2,B]  220-19-240ms   | [S1,MB5,F]  243-9-253ms    | [S1,MB3,B]  281-19-300ms   | [S1,MB6,F]  303-9-313ms    | [S1,MB4,B]  342-19-361ms   | [S1,MB7,F]  364-9-374ms    | [S1,MB5,B]  403-19-422ms   | [S1,MB6,B]  462-19-481ms   | [S1,MB7,B]  522-19-541ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  33-7-41ms      | [S2,MB0,B]  86-17-104ms    | [S2,MB2,F]  107-7-115ms    | [S2,MB1,B]  141-17-158ms   | [S2,MB3,F]  162-7-169ms    | [S2,MB2,B]  198-17-216ms   | [S2,MB4,F]  219-7-226ms    | [S2,MB3,B]  259-17-276ms   | [S2,MB5,F]  279-7-287ms    | [S2,MB4,B]  320-17-337ms   | [S2,MB6,F]  340-7-348ms    | [S2,MB5,B]  381-17-398ms   | [S2,MB7,F]  401-7-409ms    | [S2,MB6,B]  442-17-459ms   | [S2,MB7,B]  502-17-519ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-43ms     | [S3,MB0,B]  48-34-83ms     | [S3,MB1,F]  85-11-96ms     | [S3,MB1,B]  102-34-137ms   | [S3,MB2,F]  139-13-153ms   | [S3,MB2,B]  159-35-195ms   | [S3,MB3,F]  197-15-212ms   | [S3,MB3,B]  218-36-255ms   | [S3,MB4,F]  257-15-273ms   | [S3,MB4,B]  279-36-316ms   | [S3,MB5,F]  318-15-334ms   | [S3,MB5,B]  340-36-377ms   | [S3,MB6,F]  379-15-395ms   | [S3,MB6,B]  400-36-437ms   | [S3,MB7,F]  441-15-456ms   | [S3,MB7,B]  461-37-498ms  
[rank3]:2025-12-26 22:33:47,565 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p30_42_dm1/frozen_ratio_history/rank3/251226_2233_stage3_step300.svg
[rank0]:2025-12-26 22:33:47,586 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p30_42_dm1/frozen_params_histogram/251226_2233_rank0_stage0.svg
[rank0]:	> Counts Sum: 108, Total Sum: 925 (11.68%), Ratio(%) per element: [0.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-12-26 22:33:47,584 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p30_42_dm1/frozen_params_histogram/251226_2233_rank2_stage2.svg
[rank2]:	> Counts Sum: 144, Total Sum: 900 (16.00%), Ratio(%) per element: [56.0, 56.0, 56.0, 56.0, 56.0, 56.0, 56.0, 56.0, 56.0, 8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-12-26 22:33:47,577 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p30_42_dm1/frozen_params_histogram/251226_2233_rank1_stage1.svg
[rank1]:	> Counts Sum: 225, Total Sum: 1125 (20.00%), Ratio(%) per element: [48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 4.0, 4.0, 4.0, 4.0, 4.0, 4.0, 4.0, 4.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-26 22:33:47,698 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p30_42_dm1/frozen_params_histogram/251226_2233_rank3_stage3.svg
[rank3]:	> Counts Sum: 261, Total Sum: 725 (36.00%), Ratio(%) per element: [80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 36.0, 36.0, 36.0, 36.0, 36.0, 36.0, 36.0, 36.0, 36.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-26 22:34:29,300 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.3241e+00
[rank0]:2025-12-26 22:34:29,308 - Freezing Ratio: [Stage0] 0.49, Threshold: 1.2754e+00
[rank2]:2025-12-26 22:34:29,288 - Freezing Ratio: [Stage2] 0.25, Threshold: 2.0763e+00
[rank1]:2025-12-26 22:34:29,288 - Freezing Ratio: [Stage1] 0.40, Threshold: 2.0048e+00
[rank1]:2025-12-26 22:35:15,721 - Freezing Ratio: [Stage1] 0.60, Threshold: 1.6776e+00
[rank2]:2025-12-26 22:35:15,721 - Freezing Ratio: [Stage2] 0.50, Threshold: 1.4212e+00
[rank3]:2025-12-26 22:35:15,729 - Freezing Ratio: [Stage3] 0.62, Threshold: 2.0510e+00
[rank0]:2025-12-26 22:35:15,733 - Freezing Ratio: [Stage0] 0.24, Threshold: 2.2222e+00
[rank3]:2025-12-26 22:35:43,379 - Avg. fwd time: 13.8643 / Avg. bwd time: 39.3964 / Avg. batch time: 489.4866 (ms) / GPU bubble ratio: 12.95%
[rank1]:2025-12-26 22:35:43,426 - Avg. fwd time: 9.5293 / Avg. bwd time: 22.4385 / Avg. batch time: 557.1566 (ms) / GPU bubble ratio: 54.10%
[rank2]:2025-12-26 22:35:43,402 - Avg. fwd time: 7.5387 / Avg. bwd time: 18.5034 / Avg. batch time: 520.2586 (ms) / GPU bubble ratio: 59.96%
[rank0]:2025-12-26 22:35:43,456 - Avg. fwd time: 7.8108 / Avg. bwd time: 23.8026 / Avg. batch time: 594.1494 (ms) / GPU bubble ratio: 57.43%
[rank2]:2025-12-26 22:36:02,065 - Freezing Ratio: [Stage2] 0.25, Threshold: 3.9068e+00
[rank1]:2025-12-26 22:36:02,065 - Freezing Ratio: [Stage1] 0.40, Threshold: 3.7420e+00
[rank3]:2025-12-26 22:36:02,077 - Freezing Ratio: [Stage3] 0.62, Threshold: 4.6893e+00
[rank0]:2025-12-26 22:36:02,085 - Freezing Ratio: [Stage0] 0.49, Threshold: 1.6235e+00
[rank0]:2025-12-26 22:36:48,461 - Freezing Ratio: [Stage0] 0.24, Threshold: 3.4940e+00
[rank2]:2025-12-26 22:36:48,449 - Freezing Ratio: [Stage2] 0.50, Threshold: 5.6200e-01
[rank3]:2025-12-26 22:36:48,457 - Freezing Ratio: [Stage3] 0.62, Threshold: 8.2392e-01
[rank1]:2025-12-26 22:36:48,449 - Freezing Ratio: [Stage1] 0.60, Threshold: 4.9638e-01
[rank3]:2025-12-26 22:37:34,682 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.0623e+00
[rank2]:2025-12-26 22:37:34,670 - Freezing Ratio: [Stage2] 0.25, Threshold: 9.6807e-01
[rank1]:2025-12-26 22:37:34,670 - Freezing Ratio: [Stage1] 0.40, Threshold: 1.2343e+00
[rank0]:2025-12-26 22:37:34,673 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-26 22:37:34,689 - Freezing Ratio: [Stage0] 0.49, Threshold: 1.3884e+00
[rank3]:2025-12-26 22:37:39,261 - Avg. fwd time: 13.9180 / Avg. bwd time: 39.1589 / Avg. batch time: 488.0075 (ms) / GPU bubble ratio: 12.99%
[rank2]:2025-12-26 22:37:39,287 - Avg. fwd time: 7.5647 / Avg. bwd time: 18.3037 / Avg. batch time: 518.5668 (ms) / GPU bubble ratio: 60.09%
[rank0]:2025-12-26 22:37:39,342 - Avg. fwd time: 7.8363 / Avg. bwd time: 23.6042 / Avg. batch time: 591.9187 (ms) / GPU bubble ratio: 57.51%
[rank0]:2025-12-26 22:37:39,370 -  step: 350  loss: -8.0000  grad_norm:  0.1394  memory: 13.42GiB(28.26%)  tps: 7,062  tflops: 55.21  mfu: 17.70%
[rank3]:2025-12-26 22:37:39,368 -  step: 350  loss:  0.2323  grad_norm:  0.1394  memory: 18.36GiB(38.65%)  tps: 7,062  tflops: 55.21  mfu: 17.70%
[rank2]:2025-12-26 22:37:39,359 -  step: 350  loss: -8.0000  grad_norm:  0.1394  memory:  6.98GiB(14.69%)  tps: 7,062  tflops: 55.21  mfu: 17.70%
[rank1]:2025-12-26 22:37:39,315 - Avg. fwd time: 9.5684 / Avg. bwd time: 22.1028 / Avg. batch time: 555.1259 (ms) / GPU bubble ratio: 54.36%
[rank1]:2025-12-26 22:37:39,358 -  step: 350  loss: -8.0000  grad_norm:  0.1394  memory:  9.50GiB(19.99%)  tps: 7,062  tflops: 55.21  mfu: 17.70%
[rank0]:2025-12-26 22:38:21,095 - Freezing Ratio: [Stage0] 0.24, Threshold: 3.4871e-01
[rank3]:2025-12-26 22:38:21,091 - Freezing Ratio: [Stage3] 0.62, Threshold: 3.7145e-01
[rank2]:2025-12-26 22:38:21,083 - Freezing Ratio: [Stage2] 0.50, Threshold: 2.4074e-01
[rank1]:2025-12-26 22:38:21,083 - Freezing Ratio: [Stage1] 0.60, Threshold: 1.7002e-01
[rank2]:2025-12-26 22:39:07,499 - Freezing Ratio: [Stage2] 0.25, Threshold: 9.8592e-01
[rank3]:2025-12-26 22:39:07,511 - Freezing Ratio: [Stage3] 0.62, Threshold: 8.5293e-01
[rank1]:2025-12-26 22:39:07,499 - Freezing Ratio: [Stage1] 0.40, Threshold: 1.9511e+00
[rank0]:2025-12-26 22:39:07,519 - Freezing Ratio: [Stage0] 0.49, Threshold: 6.9798e-01
[rank3]:2025-12-26 22:39:35,246 - Avg. fwd time: 13.9601 / Avg. bwd time: 38.9512 / Avg. batch time: 486.6891 (ms) / GPU bubble ratio: 13.03%
[rank0]:2025-12-26 22:39:35,328 - Avg. fwd time: 7.8641 / Avg. bwd time: 23.4020 / Avg. batch time: 589.9867 (ms) / GPU bubble ratio: 57.60%
[rank2]:2025-12-26 22:39:35,272 - Avg. fwd time: 7.5832 / Avg. bwd time: 18.1613 / Avg. batch time: 517.0953 (ms) / GPU bubble ratio: 60.17%
[rank1]:2025-12-26 22:39:35,300 - Avg. fwd time: 9.5983 / Avg. bwd time: 21.8422 / Avg. batch time: 553.3910 (ms) / GPU bubble ratio: 54.55%
[rank2]:2025-12-26 22:39:53,869 - Freezing Ratio: [Stage2] 0.50, Threshold: 9.8858e-01
[rank3]:2025-12-26 22:39:53,877 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.6194e+00
[rank1]:2025-12-26 22:39:53,869 - Freezing Ratio: [Stage1] 0.60, Threshold: 1.9526e+00
[rank0]:2025-12-26 22:39:53,881 - Freezing Ratio: [Stage0] 0.24, Threshold: 4.0184e+00
[rank0]:2025-12-26 22:40:40,170 - Freezing Ratio: [Stage0] 0.49, Threshold: 7.3858e-01
[rank2]:2025-12-26 22:40:40,151 - Freezing Ratio: [Stage2] 0.25, Threshold: 1.8840e-01
[rank1]:2025-12-26 22:40:40,150 - Freezing Ratio: [Stage1] 0.40, Threshold: 2.5401e-01
[rank3]:2025-12-26 22:40:40,162 - Freezing Ratio: [Stage3] 0.62, Threshold: 7.1906e-01
[rank0]:2025-12-26 22:41:26,533 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-26 22:41:26,555 - Freezing Ratio: [Stage0] 0.24, Threshold: 4.7910e-01
[rank2]:2025-12-26 22:41:26,543 - Freezing Ratio: [Stage2] 0.50, Threshold: 2.0289e-01
[rank3]:2025-12-26 22:41:26,550 - Freezing Ratio: [Stage3] 0.62, Threshold: 3.2022e-01
[rank1]:2025-12-26 22:41:26,543 - Freezing Ratio: [Stage1] 0.60, Threshold: 3.4386e-01
[rank2]:2025-12-26 22:41:31,153 - Avg. fwd time: 7.6008 / Avg. bwd time: 18.0295 / Avg. batch time: 515.8039 (ms) / GPU bubble ratio: 60.25%
[rank3]:2025-12-26 22:41:31,130 - Avg. fwd time: 13.9979 / Avg. bwd time: 38.7705 / Avg. batch time: 485.5394 (ms) / GPU bubble ratio: 13.06%
[rank1]:2025-12-26 22:41:31,178 - Avg. fwd time: 9.6262 / Avg. bwd time: 21.6075 / Avg. batch time: 551.8624 (ms) / GPU bubble ratio: 54.72%
[rank0]:2025-12-26 22:41:31,209 - Avg. fwd time: 7.8872 / Avg. bwd time: 23.2328 / Avg. batch time: 588.2900 (ms) / GPU bubble ratio: 57.68%
[rank0]:2025-12-26 22:41:31,241 -  step: 400  loss: -8.0000  grad_norm:  0.6054  memory: 13.42GiB(28.26%)  tps: 7,066  tflops: 55.24  mfu: 17.70%
[rank2]:2025-12-26 22:41:31,223 -  step: 400  loss: -8.0000  grad_norm:  0.6054  memory:  6.98GiB(14.69%)  tps: 7,066  tflops: 55.24  mfu: 17.71%
[rank2]:2025-12-26 22:41:31,302 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p30_42_dm1/frozen_ratio_history/rank2/251226_2241_stage2_step400.svg
[rank3]:2025-12-26 22:41:31,236 -  step: 400  loss:  0.2231  grad_norm:  0.6054  memory: 18.36GiB(38.65%)  tps: 7,066  tflops: 55.24  mfu: 17.71%
[rank1]:2025-12-26 22:41:31,223 -  step: 400  loss: -8.0000  grad_norm:  0.6054  memory:  9.50GiB(19.99%)  tps: 7,066  tflops: 55.24  mfu: 17.71%
[rank1]:2025-12-26 22:41:31,296 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p30_42_dm1/frozen_ratio_history/rank1/251226_2241_stage1_step400.svg
[rank0]:2025-12-26 22:41:31,294 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p30_42_dm1/frozen_ratio_history/rank0/251226_2241_stage0_step400.svg
[rank3]:2025-12-26 22:41:31,378 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p30_42_dm1/pipeline_schedule/251226_2241_step400_rank3.svg
[rank3]:			> Batch Time: 565.00 ms, GPU Bubble Ratio: 60.53%, 58.62%, 64.53%, 28.12%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-8-18ms       | [S0,MB2,F]  18-8-26ms      | [S0,MB3,F]  26-8-35ms      | [S0,MB0,B]  133-19-153ms   | [S0,MB4,F]  153-7-161ms    | [S0,MB1,B]  187-19-207ms   | [S0,MB5,F]  207-7-215ms    | [S0,MB2,B]  245-19-265ms   | [S0,MB6,F]  265-7-273ms    | [S0,MB3,B]  305-19-325ms   | [S0,MB7,F]  325-7-333ms    | [S0,MB4,B]  367-19-386ms   | [S0,MB5,B]  426-19-445ms   | [S0,MB6,B]  485-19-504ms   | [S0,MB7,B]  545-19-565ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-9-33ms      | [S1,MB2,F]  36-9-46ms      | [S1,MB0,B]  109-19-128ms   | [S1,MB3,F]  132-9-141ms    | [S1,MB1,B]  163-19-182ms   | [S1,MB4,F]  186-9-195ms    | [S1,MB2,B]  221-19-240ms   | [S1,MB5,F]  243-9-253ms    | [S1,MB3,B]  281-19-300ms   | [S1,MB6,F]  304-9-313ms    | [S1,MB4,B]  342-19-362ms   | [S1,MB7,F]  365-9-375ms    | [S1,MB5,B]  404-19-423ms   | [S1,MB6,B]  462-19-482ms   | [S1,MB7,B]  522-19-541ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  33-7-40ms      | [S2,MB0,B]  86-17-104ms    | [S2,MB2,F]  107-7-115ms    | [S2,MB1,B]  140-17-158ms   | [S2,MB3,F]  161-7-169ms    | [S2,MB2,B]  199-17-216ms   | [S2,MB4,F]  219-7-226ms    | [S2,MB3,B]  259-17-276ms   | [S2,MB5,F]  279-7-287ms    | [S2,MB4,B]  320-17-338ms   | [S2,MB6,F]  341-7-348ms    | [S2,MB5,B]  382-17-399ms   | [S2,MB7,F]  402-7-410ms    | [S2,MB6,B]  443-17-460ms   | [S2,MB7,B]  502-17-519ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-43ms     | [S3,MB0,B]  48-34-83ms     | [S3,MB1,F]  85-11-96ms     | [S3,MB1,B]  102-34-137ms   | [S3,MB2,F]  139-14-153ms   | [S3,MB2,B]  159-35-195ms   | [S3,MB3,F]  197-16-213ms   | [S3,MB3,B]  219-36-255ms   | [S3,MB4,F]  258-16-274ms   | [S3,MB4,B]  280-36-317ms   | [S3,MB5,F]  319-15-335ms   | [S3,MB5,B]  341-36-378ms   | [S3,MB6,F]  380-15-396ms   | [S3,MB6,B]  402-36-439ms   | [S3,MB7,F]  441-15-456ms   | [S3,MB7,B]  462-37-499ms  
[rank0]:2025-12-26 22:41:31,457 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p30_42_dm1/frozen_params_histogram/251226_2241_rank0_stage0.svg
[rank0]:	> Counts Sum: 243, Total Sum: 1295 (18.76%), Ratio(%) per element: [0.0, 57.14, 57.14, 57.14, 57.14, 57.14, 57.14, 57.14, 57.14, 57.14, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-12-26 22:41:31,453 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p30_42_dm1/frozen_params_histogram/251226_2241_rank2_stage2.svg
[rank2]:	> Counts Sum: 279, Total Sum: 1260 (22.14%), Ratio(%) per element: [68.57, 68.57, 68.57, 68.57, 68.57, 68.57, 68.57, 68.57, 68.57, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-26 22:41:31,427 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p30_42_dm1/frozen_ratio_history/rank3/251226_2241_stage3_step400.svg
[rank1]:2025-12-26 22:41:31,443 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p30_42_dm1/frozen_params_histogram/251226_2241_rank1_stage1.svg
[rank1]:	> Counts Sum: 450, Total Sum: 1575 (28.57%), Ratio(%) per element: [62.85, 62.85, 62.85, 62.85, 62.85, 62.85, 62.85, 62.85, 62.85, 62.85, 62.85, 62.85, 62.85, 62.85, 62.85, 62.85, 62.85, 62.85, 17.14, 17.14, 17.14, 17.14, 17.14, 17.14, 17.14, 17.14, 17.14, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-26 22:41:31,569 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p30_42_dm1/frozen_params_histogram/251226_2241_rank3_stage3.svg
[rank3]:	> Counts Sum: 441, Total Sum: 1015 (43.45%), Ratio(%) per element: [85.71, 85.71, 85.71, 85.71, 85.71, 85.71, 85.71, 85.71, 85.71, 54.28, 54.28, 54.28, 54.28, 54.28, 54.28, 54.28, 54.28, 54.28, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-26 22:41:57,752 - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-12-26 22:41:58,001 - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-12-26 22:41:58,018 - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-12-26 22:41:58,045 - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-12-26 22:42:13,145 - Freezing Ratio: [Stage0] 0.49, Threshold: 1.6784e+00
[rank2]:2025-12-26 22:42:13,125 - Freezing Ratio: [Stage2] 0.25, Threshold: 2.9945e+00
[rank3]:2025-12-26 22:42:13,136 - Freezing Ratio: [Stage3] 0.62, Threshold: 2.4065e+00
[rank1]:2025-12-26 22:42:13,125 - Freezing Ratio: [Stage1] 0.40, Threshold: 3.0728e+00
[rank0]:2025-12-26 22:42:59,506 - Freezing Ratio: [Stage0] 0.49, Threshold: 9.2008e+00
[rank1]:2025-12-26 22:42:59,494 - Freezing Ratio: [Stage1] 0.60, Threshold: 5.8115e+00
[rank2]:2025-12-26 22:42:59,494 - Freezing Ratio: [Stage2] 0.50, Threshold: 5.6266e+00
[rank3]:2025-12-26 22:42:59,502 - Freezing Ratio: [Stage3] 0.62, Threshold: 7.8306e+00
[rank2]:2025-12-26 22:43:27,030 - Avg. fwd time: 7.6196 / Avg. bwd time: 17.8859 / Avg. batch time: 514.6897 (ms) / GPU bubble ratio: 60.36%
[rank3]:2025-12-26 22:43:27,006 - Avg. fwd time: 14.0333 / Avg. bwd time: 38.6124 / Avg. batch time: 484.5530 (ms) / GPU bubble ratio: 13.08%
[rank1]:2025-12-26 22:43:27,059 - Avg. fwd time: 9.6535 / Avg. bwd time: 21.3730 / Avg. batch time: 550.5111 (ms) / GPU bubble ratio: 54.91%
[rank0]:2025-12-26 22:43:27,090 - Avg. fwd time: 7.9084 / Avg. bwd time: 23.0698 / Avg. batch time: 586.7761 (ms) / GPU bubble ratio: 57.76%
[rank2]:2025-12-26 22:43:45,367 - Freezing Ratio: [Stage2] 0.25, Threshold: 1.5784e+00
[rank3]:2025-12-26 22:43:45,379 - Freezing Ratio: [Stage3] 0.62, Threshold: 2.0563e+00
[rank1]:2025-12-26 22:43:45,367 - Freezing Ratio: [Stage1] 0.40, Threshold: 2.1237e+00
[rank0]:2025-12-26 22:43:45,383 - Freezing Ratio: [Stage0] 0.49, Threshold: 1.5023e+00
[rank0]:2025-12-26 22:44:31,817 - Freezing Ratio: [Stage0] 0.49, Threshold: 2.5504e+00
[rank2]:2025-12-26 22:44:31,805 - Freezing Ratio: [Stage2] 0.50, Threshold: 1.2370e+00
[rank3]:2025-12-26 22:44:31,812 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.5239e+00
[rank1]:2025-12-26 22:44:31,805 - Freezing Ratio: [Stage1] 0.60, Threshold: 9.9618e-01
[rank0]:2025-12-26 22:45:17,848 - [GC] Peforming periodical GC collection 0.02 seconds
[rank0]:2025-12-26 22:45:17,857 - Freezing Ratio: [Stage0] 0.49, Threshold: 2.6968e+00
[rank2]:2025-12-26 22:45:17,841 - Freezing Ratio: [Stage2] 0.25, Threshold: 1.6634e+00
[rank3]:2025-12-26 22:45:17,853 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.7167e+00
[rank1]:2025-12-26 22:45:17,841 - Freezing Ratio: [Stage1] 0.40, Threshold: 1.6191e+00
[rank3]:2025-12-26 22:45:22,396 - Avg. fwd time: 14.0592 / Avg. bwd time: 38.4715 / Avg. batch time: 483.6291 (ms) / GPU bubble ratio: 13.11%
[rank0]:2025-12-26 22:45:22,483 - Avg. fwd time: 7.9348 / Avg. bwd time: 22.8676 / Avg. batch time: 585.3154 (ms) / GPU bubble ratio: 57.90%
[rank0]:2025-12-26 22:45:22,510 -  step: 450  loss: -8.0000  grad_norm:  0.1288  memory: 13.42GiB(28.26%)  tps: 7,084  tflops: 55.38  mfu: 17.75%
[rank2]:2025-12-26 22:45:22,423 - Avg. fwd time: 7.6353 / Avg. bwd time: 17.7646 / Avg. batch time: 513.6354 (ms) / GPU bubble ratio: 60.44%
[rank2]:2025-12-26 22:45:22,499 -  step: 450  loss: -8.0000  grad_norm:  0.1288  memory:  6.98GiB(14.69%)  tps: 7,084  tflops: 55.38  mfu: 17.75%
[rank3]:2025-12-26 22:45:22,509 -  step: 450  loss:  0.2321  grad_norm:  0.1288  memory: 18.36GiB(38.65%)  tps: 7,084  tflops: 55.38  mfu: 17.75%
[rank1]:2025-12-26 22:45:22,452 - Avg. fwd time: 9.6771 / Avg. bwd time: 21.1714 / Avg. batch time: 549.2528 (ms) / GPU bubble ratio: 55.07%
[rank1]:2025-12-26 22:45:22,499 -  step: 450  loss: -8.0000  grad_norm:  0.1288  memory:  9.50GiB(19.99%)  tps: 7,084  tflops: 55.38  mfu: 17.75%
[rank0]:2025-12-26 22:46:04,265 - Freezing Ratio: [Stage0] 0.49, Threshold: 1.5845e+00
[rank3]:2025-12-26 22:46:04,260 - Freezing Ratio: [Stage3] 0.62, Threshold: 6.0334e-01
[rank2]:2025-12-26 22:46:04,253 - Freezing Ratio: [Stage2] 0.50, Threshold: 5.5043e-01
[rank1]:2025-12-26 22:46:04,253 - Freezing Ratio: [Stage1] 0.60, Threshold: 5.9031e-01
[rank0]:2025-12-26 22:46:50,165 - Freezing Ratio: [Stage0] 0.49, Threshold: 2.8252e-01
[rank2]:2025-12-26 22:46:50,149 - Freezing Ratio: [Stage2] 0.25, Threshold: 3.4031e-01
[rank3]:2025-12-26 22:46:50,161 - Freezing Ratio: [Stage3] 0.62, Threshold: 8.1123e-01
[rank1]:2025-12-26 22:46:50,149 - Freezing Ratio: [Stage1] 0.40, Threshold: 4.1307e-01
[rank2]:2025-12-26 22:47:17,963 - Avg. fwd time: 7.6462 / Avg. bwd time: 17.6805 / Avg. batch time: 512.7110 (ms) / GPU bubble ratio: 60.48%
[rank3]:2025-12-26 22:47:17,936 - Avg. fwd time: 14.0809 / Avg. bwd time: 38.3460 / Avg. batch time: 482.7973 (ms) / GPU bubble ratio: 13.13%
[rank0]:2025-12-26 22:47:18,022 - Avg. fwd time: 7.9586 / Avg. bwd time: 22.6867 / Avg. batch time: 584.0500 (ms) / GPU bubble ratio: 58.02%
[rank1]:2025-12-26 22:47:17,993 - Avg. fwd time: 9.6955 / Avg. bwd time: 21.0155 / Avg. batch time: 548.1700 (ms) / GPU bubble ratio: 55.18%
[rank3]:2025-12-26 22:47:36,617 - Freezing Ratio: [Stage3] 0.62, Threshold: 4.8196e-01
[rank2]:2025-12-26 22:47:36,609 - Freezing Ratio: [Stage2] 0.50, Threshold: 1.6456e-01
[rank0]:2025-12-26 22:47:36,621 - Freezing Ratio: [Stage0] 0.49, Threshold: 7.4476e-01
[rank1]:2025-12-26 22:47:36,609 - Freezing Ratio: [Stage1] 0.60, Threshold: 1.3762e-01
[rank2]:2025-12-26 22:48:22,642 - Freezing Ratio: [Stage2] 0.25, Threshold: 1.3015e+00
[rank1]:2025-12-26 22:48:22,642 - Freezing Ratio: [Stage1] 0.40, Threshold: 1.3075e+00
[rank0]:2025-12-26 22:48:22,658 - Freezing Ratio: [Stage0] 0.49, Threshold: 2.0068e+00
[rank3]:2025-12-26 22:48:22,654 - Freezing Ratio: [Stage3] 0.62, Threshold: 8.1842e-01
[rank0]:2025-12-26 22:49:09,005 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-26 22:49:09,026 - Freezing Ratio: [Stage0] 0.49, Threshold: 3.2570e+00
[rank2]:2025-12-26 22:49:09,014 - Freezing Ratio: [Stage2] 0.50, Threshold: 1.4099e+00
[rank1]:2025-12-26 22:49:09,014 - Freezing Ratio: [Stage1] 0.60, Threshold: 1.0454e+00
[rank3]:2025-12-26 22:49:09,022 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.0558e+00
[rank2]:2025-12-26 22:49:13,532 - Avg. fwd time: 7.6566 / Avg. bwd time: 17.5981 / Avg. batch time: 511.8633 (ms) / GPU bubble ratio: 60.53%
[rank3]:2025-12-26 22:49:13,506 - Avg. fwd time: 14.1009 / Avg. bwd time: 38.2302 / Avg. batch time: 482.0374 (ms) / GPU bubble ratio: 13.15%
[rank0]:2025-12-26 22:49:13,588 - Avg. fwd time: 7.9803 / Avg. bwd time: 22.5229 / Avg. batch time: 582.8927 (ms) / GPU bubble ratio: 58.14%
[rank0]:2025-12-26 22:49:13,615 -  step: 500  loss: -8.0000  grad_norm:  0.0986  memory: 13.42GiB(28.26%)  tps: 7,089  tflops: 55.42  mfu: 17.76%
[rank2]:2025-12-26 22:49:13,601 -  step: 500  loss: -8.0000  grad_norm:  0.0986  memory:  6.98GiB(14.69%)  tps: 7,090  tflops: 55.42  mfu: 17.76%
[rank1]:2025-12-26 22:49:13,558 - Avg. fwd time: 9.7125 / Avg. bwd time: 20.8687 / Avg. batch time: 547.1749 (ms) / GPU bubble ratio: 55.29%
[rank1]:2025-12-26 22:49:13,601 -  step: 500  loss: -8.0000  grad_norm:  0.0986  memory:  9.50GiB(19.99%)  tps: 7,090  tflops: 55.42  mfu: 17.76%
[rank3]:2025-12-26 22:49:13,614 -  step: 500  loss:  0.2267  grad_norm:  0.0986  memory: 18.36GiB(38.65%)  tps: 7,090  tflops: 55.42  mfu: 17.76%
[rank0]:2025-12-26 22:49:13,675 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p30_42_dm1/frozen_ratio_history/rank0/251226_2249_stage0_step500.svg
[rank2]:2025-12-26 22:49:13,664 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p30_42_dm1/frozen_ratio_history/rank2/251226_2249_stage2_step500.svg
[rank1]:2025-12-26 22:49:13,665 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p30_42_dm1/frozen_ratio_history/rank1/251226_2249_stage1_step500.svg
[rank2]:2025-12-26 22:49:13,814 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p30_42_dm1/frozen_params_histogram/251226_2249_rank2_stage2.svg
[rank2]:	> Counts Sum: 414, Total Sum: 1620 (25.56%), Ratio(%) per element: [75.55, 75.55, 75.55, 75.55, 75.55, 75.55, 75.55, 75.55, 75.55, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-12-26 22:49:13,811 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p30_42_dm1/frozen_params_histogram/251226_2249_rank1_stage1.svg
[rank1]:	> Counts Sum: 675, Total Sum: 2025 (33.33%), Ratio(%) per element: [71.11, 71.11, 71.11, 71.11, 71.11, 71.11, 71.11, 71.11, 71.11, 71.11, 71.11, 71.11, 71.11, 71.11, 71.11, 71.11, 71.11, 71.11, 24.44, 24.44, 24.44, 24.44, 24.44, 24.44, 24.44, 24.44, 24.44, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-26 22:49:13,756 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p30_42_dm1/pipeline_schedule/251226_2249_step500_rank3.svg
[rank3]:			> Batch Time: 563.95 ms, GPU Bubble Ratio: 60.44%, 58.48%, 64.49%, 28.30%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-8-18ms       | [S0,MB2,F]  18-8-27ms      | [S0,MB3,F]  26-8-35ms      | [S0,MB0,B]  133-19-153ms   | [S0,MB4,F]  153-7-161ms    | [S0,MB1,B]  187-19-207ms   | [S0,MB5,F]  207-8-215ms    | [S0,MB2,B]  245-19-264ms   | [S0,MB6,F]  264-7-272ms    | [S0,MB3,B]  305-19-324ms   | [S0,MB7,F]  324-7-332ms    | [S0,MB4,B]  366-19-385ms   | [S0,MB5,B]  425-19-444ms   | [S0,MB6,B]  484-19-503ms   | [S0,MB7,B]  544-19-563ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-9-33ms      | [S1,MB2,F]  36-9-46ms      | [S1,MB0,B]  109-19-128ms   | [S1,MB3,F]  132-9-141ms    | [S1,MB1,B]  163-19-182ms   | [S1,MB4,F]  186-9-195ms    | [S1,MB2,B]  220-19-240ms   | [S1,MB5,F]  243-9-253ms    | [S1,MB3,B]  280-19-300ms   | [S1,MB6,F]  303-9-313ms    | [S1,MB4,B]  341-19-361ms   | [S1,MB7,F]  364-9-374ms    | [S1,MB5,B]  402-19-422ms   | [S1,MB6,B]  461-19-481ms   | [S1,MB7,B]  521-19-540ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  33-7-41ms      | [S2,MB0,B]  86-17-104ms    | [S2,MB2,F]  107-7-115ms    | [S2,MB1,B]  141-17-158ms   | [S2,MB3,F]  161-7-169ms    | [S2,MB2,B]  198-17-215ms   | [S2,MB4,F]  219-7-226ms    | [S2,MB3,B]  258-17-276ms   | [S2,MB5,F]  279-7-286ms    | [S2,MB4,B]  319-17-336ms   | [S2,MB6,F]  340-7-347ms    | [S2,MB5,B]  380-17-397ms   | [S2,MB7,F]  401-7-408ms    | [S2,MB6,B]  441-17-458ms   | [S2,MB7,B]  501-17-518ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  48-34-82ms     | [S3,MB1,F]  85-11-96ms     | [S3,MB1,B]  102-34-137ms   | [S3,MB2,F]  139-13-153ms   | [S3,MB2,B]  159-35-194ms   | [S3,MB3,F]  197-15-212ms   | [S3,MB3,B]  218-36-254ms   | [S3,MB4,F]  257-15-273ms   | [S3,MB4,B]  278-36-315ms   | [S3,MB5,F]  318-15-333ms   | [S3,MB5,B]  339-36-376ms   | [S3,MB6,F]  378-15-393ms   | [S3,MB6,B]  400-37-437ms   | [S3,MB7,F]  439-14-454ms   | [S3,MB7,B]  460-37-497ms  
[rank3]:2025-12-26 22:49:13,801 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p30_42_dm1/frozen_ratio_history/rank3/251226_2249_stage3_step500.svg
[rank0]:2025-12-26 22:49:13,833 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p30_42_dm1/frozen_params_histogram/251226_2249_rank0_stage0.svg
[rank0]:	> Counts Sum: 423, Total Sum: 1665 (25.41%), Ratio(%) per element: [0.0, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 37.77, 37.77, 37.77, 37.77, 37.77, 37.77, 37.77, 37.77, 37.77, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-26 22:49:13,934 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p30_42_dm1/frozen_params_histogram/251226_2249_rank3_stage3.svg
[rank3]:	> Counts Sum: 621, Total Sum: 1305 (47.59%), Ratio(%) per element: [88.88, 88.88, 88.88, 88.88, 88.88, 88.88, 88.88, 88.88, 88.88, 64.44, 64.44, 64.44, 64.44, 64.44, 64.44, 64.44, 64.44, 64.44, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-12-26 22:49:55,168 - Freezing Ratio: [Stage2] 0.25, Threshold: 9.4871e-01
[rank1]:2025-12-26 22:49:55,168 - Freezing Ratio: [Stage1] 0.40, Threshold: 1.8816e+00
[rank3]:2025-12-26 22:49:55,181 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.0386e+00
[rank0]:2025-12-26 22:49:55,184 - Freezing Ratio: [Stage0] 0.49, Threshold: 8.4550e-01
[rank1]:2025-12-26 22:50:41,531 - Freezing Ratio: [Stage1] 0.60, Threshold: 1.9210e+00
[rank2]:2025-12-26 22:50:41,530 - Freezing Ratio: [Stage2] 0.50, Threshold: 1.5341e+00
[rank0]:2025-12-26 22:50:41,542 - Freezing Ratio: [Stage0] 0.73, Threshold: 2.0366e+00
[rank3]:2025-12-26 22:50:41,538 - Freezing Ratio: [Stage3] 0.62, Threshold: 2.6074e+00
[rank2]:2025-12-26 22:51:08,756 - Avg. fwd time: 7.6689 / Avg. bwd time: 17.5013 / Avg. batch time: 511.0900 (ms) / GPU bubble ratio: 60.60%
[rank3]:2025-12-26 22:51:08,730 - Avg. fwd time: 14.1172 / Avg. bwd time: 38.1286 / Avg. batch time: 481.3500 (ms) / GPU bubble ratio: 13.17%
[rank1]:2025-12-26 22:51:08,783 - Avg. fwd time: 9.7309 / Avg. bwd time: 20.7141 / Avg. batch time: 546.2464 (ms) / GPU bubble ratio: 55.41%
[rank0]:2025-12-26 22:51:08,810 - Avg. fwd time: 8.0035 / Avg. bwd time: 22.3421 / Avg. batch time: 581.7803 (ms) / GPU bubble ratio: 58.27%
[rank1]:2025-12-26 22:51:27,157 - Freezing Ratio: [Stage1] 0.40, Threshold: 5.0778e-01
[rank0]:2025-12-26 22:51:27,168 - Freezing Ratio: [Stage0] 0.49, Threshold: 7.7463e-01
[rank2]:2025-12-26 22:51:27,157 - Freezing Ratio: [Stage2] 0.25, Threshold: 7.4851e-01
[rank3]:2025-12-26 22:51:27,169 - Freezing Ratio: [Stage3] 0.62, Threshold: 7.6787e-01
[rank1]:2025-12-26 22:52:13,419 - Freezing Ratio: [Stage1] 0.60, Threshold: 1.4156e+00
[rank2]:2025-12-26 22:52:13,419 - Freezing Ratio: [Stage2] 0.50, Threshold: 1.2718e+00
[rank0]:2025-12-26 22:52:13,430 - Freezing Ratio: [Stage0] 0.73, Threshold: 2.6996e-01
[rank3]:2025-12-26 22:52:13,426 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.9549e+00
[rank1]:2025-12-26 22:52:58,896 - Freezing Ratio: [Stage1] 0.40, Threshold: 7.1811e-01
[rank2]:2025-12-26 22:52:58,896 - Freezing Ratio: [Stage2] 0.25, Threshold: 7.8335e-01
[rank3]:2025-12-26 22:52:58,908 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.1804e+00
[rank0]:2025-12-26 22:52:58,901 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-26 22:52:58,908 - Freezing Ratio: [Stage0] 0.49, Threshold: 2.9849e-01
[rank2]:2025-12-26 22:53:03,507 - Avg. fwd time: 7.6793 / Avg. bwd time: 17.4182 / Avg. batch time: 510.3630 (ms) / GPU bubble ratio: 60.66%
[rank3]:2025-12-26 22:53:03,479 - Avg. fwd time: 14.1314 / Avg. bwd time: 38.0356 / Avg. batch time: 480.7129 (ms) / GPU bubble ratio: 13.18%
[rank1]:2025-12-26 22:53:03,537 - Avg. fwd time: 9.7468 / Avg. bwd time: 20.5780 / Avg. batch time: 545.3816 (ms) / GPU bubble ratio: 55.52%
[rank1]:2025-12-26 22:53:03,583 -  step: 550  loss: -8.0000  grad_norm:  0.1273  memory:  9.50GiB(19.99%)  tps: 7,124  tflops: 55.69  mfu: 17.85%
[rank2]:2025-12-26 22:53:03,583 -  step: 550  loss: -8.0000  grad_norm:  0.1273  memory:  6.98GiB(14.69%)  tps: 7,124  tflops: 55.69  mfu: 17.85%
[rank0]:2025-12-26 22:53:03,567 - Avg. fwd time: 8.0297 / Avg. bwd time: 22.1360 / Avg. batch time: 580.7057 (ms) / GPU bubble ratio: 58.44%
[rank0]:2025-12-26 22:53:03,594 -  step: 550  loss: -8.0000  grad_norm:  0.1273  memory: 13.42GiB(28.26%)  tps: 7,124  tflops: 55.69  mfu: 17.85%
[rank3]:2025-12-26 22:53:03,593 -  step: 550  loss:  0.2349  grad_norm:  0.1273  memory: 18.36GiB(38.65%)  tps: 7,124  tflops: 55.69  mfu: 17.85%
[rank1]:2025-12-26 22:53:45,400 - Freezing Ratio: [Stage1] 0.60, Threshold: 1.0186e+00
[rank0]:2025-12-26 22:53:45,412 - Freezing Ratio: [Stage0] 0.73, Threshold: 5.1235e-01
[rank3]:2025-12-26 22:53:45,408 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.3026e+00
[rank2]:2025-12-26 22:53:45,400 - Freezing Ratio: [Stage2] 0.50, Threshold: 9.4784e-01
[rank1]:2025-12-26 22:54:31,031 - Freezing Ratio: [Stage1] 0.40, Threshold: 2.8036e+00
[rank3]:2025-12-26 22:54:31,043 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.8115e+00
[rank0]:2025-12-26 22:54:31,043 - Freezing Ratio: [Stage0] 0.49, Threshold: 1.6792e+00
[rank2]:2025-12-26 22:54:31,031 - Freezing Ratio: [Stage2] 0.25, Threshold: 2.3737e+00
[rank2]:2025-12-26 22:54:58,760 - Avg. fwd time: 7.6862 / Avg. bwd time: 17.3624 / Avg. batch time: 509.7508 (ms) / GPU bubble ratio: 60.69%
[rank3]:2025-12-26 22:54:58,731 - Avg. fwd time: 14.1488 / Avg. bwd time: 37.9497 / Avg. batch time: 480.1617 (ms) / GPU bubble ratio: 13.20%
[rank1]:2025-12-26 22:54:58,790 - Avg. fwd time: 9.7584 / Avg. bwd time: 20.4734 / Avg. batch time: 544.6633 (ms) / GPU bubble ratio: 55.60%
[rank0]:2025-12-26 22:54:58,820 - Avg. fwd time: 8.0513 / Avg. bwd time: 21.9675 / Avg. batch time: 579.8160 (ms) / GPU bubble ratio: 58.58%
[rank1]:2025-12-26 22:55:17,407 - Freezing Ratio: [Stage1] 0.60, Threshold: 3.6064e-01
[rank2]:2025-12-26 22:55:17,408 - Freezing Ratio: [Stage2] 0.50, Threshold: 6.5558e-01
[rank3]:2025-12-26 22:55:17,415 - Freezing Ratio: [Stage3] 0.62, Threshold: 6.6895e-01
[rank0]:2025-12-26 22:55:17,419 - Freezing Ratio: [Stage0] 0.73, Threshold: 4.1609e-01
[rank2]:2025-12-26 22:56:02,873 - Freezing Ratio: [Stage2] 0.25, Threshold: 5.1777e-01
[rank1]:2025-12-26 22:56:02,873 - Freezing Ratio: [Stage1] 0.40, Threshold: 1.9818e-01
[rank0]:2025-12-26 22:56:02,884 - Freezing Ratio: [Stage0] 0.49, Threshold: 7.0406e-01
[rank3]:2025-12-26 22:56:02,885 - Freezing Ratio: [Stage3] 0.62, Threshold: 4.7902e-01
[rank1]:2025-12-26 22:56:49,211 - Freezing Ratio: [Stage1] 0.60, Threshold: 6.8083e-01
[rank2]:2025-12-26 22:56:49,211 - Freezing Ratio: [Stage2] 0.50, Threshold: 3.6351e-01
[rank3]:2025-12-26 22:56:49,219 - Freezing Ratio: [Stage3] 0.62, Threshold: 5.7358e-01
[rank0]:2025-12-26 22:56:49,201 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-26 22:56:49,222 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.0540e-01
[rank2]:2025-12-26 22:56:53,828 - Avg. fwd time: 7.6933 / Avg. bwd time: 17.3067 / Avg. batch time: 509.1700 (ms) / GPU bubble ratio: 60.72%
[rank3]:2025-12-26 22:56:53,802 - Avg. fwd time: 14.1625 / Avg. bwd time: 37.8716 / Avg. batch time: 479.6417 (ms) / GPU bubble ratio: 13.21%
[rank1]:2025-12-26 22:56:53,855 - Avg. fwd time: 9.7700 / Avg. bwd time: 20.3730 / Avg. batch time: 543.9808 (ms) / GPU bubble ratio: 55.67%
[rank1]:2025-12-26 22:56:53,895 -  step: 600  loss: -8.0000  grad_norm:  0.2881  memory:  9.50GiB(19.99%)  tps: 7,114  tflops: 55.61  mfu: 17.82%
[rank2]:2025-12-26 22:56:53,895 -  step: 600  loss: -8.0000  grad_norm:  0.2881  memory:  6.98GiB(14.69%)  tps: 7,114  tflops: 55.61  mfu: 17.82%
[rank3]:2025-12-26 22:56:53,908 -  step: 600  loss:  0.2300  grad_norm:  0.2881  memory: 18.36GiB(38.65%)  tps: 7,114  tflops: 55.61  mfu: 17.82%
[rank0]:2025-12-26 22:56:53,883 - Avg. fwd time: 8.0717 / Avg. bwd time: 21.8084 / Avg. batch time: 578.9703 (ms) / GPU bubble ratio: 58.71%
[rank0]:2025-12-26 22:56:53,906 -  step: 600  loss: -8.0000  grad_norm:  0.2881  memory: 13.42GiB(28.26%)  tps: 7,114  tflops: 55.61  mfu: 17.82%
[rank1]:2025-12-26 22:56:53,960 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p30_42_dm1/frozen_ratio_history/rank1/251226_2256_stage1_step600.svg
[rank2]:2025-12-26 22:56:53,959 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p30_42_dm1/frozen_ratio_history/rank2/251226_2256_stage2_step600.svg
[rank0]:2025-12-26 22:56:53,969 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p30_42_dm1/frozen_ratio_history/rank0/251226_2256_stage0_step600.svg
[rank1]:2025-12-26 22:56:54,107 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p30_42_dm1/frozen_params_histogram/251226_2256_rank1_stage1.svg
[rank1]:	> Counts Sum: 900, Total Sum: 2475 (36.36%), Ratio(%) per element: [76.36, 76.36, 76.36, 76.36, 76.36, 76.36, 76.36, 76.36, 76.36, 76.36, 76.36, 76.36, 76.36, 76.36, 76.36, 76.36, 76.36, 76.36, 29.09, 29.09, 29.09, 29.09, 29.09, 29.09, 29.09, 29.09, 29.09, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-12-26 22:56:54,109 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p30_42_dm1/frozen_params_histogram/251226_2256_rank2_stage2.svg
[rank2]:	> Counts Sum: 549, Total Sum: 1980 (27.73%), Ratio(%) per element: [80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 30.9, 30.9, 30.9, 30.9, 30.9, 30.9, 30.9, 30.9, 30.9, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-26 22:56:54,059 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p30_42_dm1/pipeline_schedule/251226_2256_step600_rank3.svg
[rank3]:			> Batch Time: 565.45 ms, GPU Bubble Ratio: 60.58%, 58.71%, 64.61%, 28.02%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-8-18ms       | [S0,MB2,F]  18-8-26ms      | [S0,MB3,F]  26-8-35ms      | [S0,MB0,B]  133-19-152ms   | [S0,MB4,F]  152-7-160ms    | [S0,MB1,B]  187-19-206ms   | [S0,MB5,F]  206-8-214ms    | [S0,MB2,B]  245-19-264ms   | [S0,MB6,F]  264-7-272ms    | [S0,MB3,B]  306-19-325ms   | [S0,MB7,F]  325-7-332ms    | [S0,MB4,B]  367-19-386ms   | [S0,MB5,B]  426-19-446ms   | [S0,MB6,B]  485-19-505ms   | [S0,MB7,B]  546-19-565ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-9-33ms      | [S1,MB2,F]  36-9-46ms      | [S1,MB0,B]  108-19-128ms   | [S1,MB3,F]  131-9-141ms    | [S1,MB1,B]  162-19-182ms   | [S1,MB4,F]  185-9-195ms    | [S1,MB2,B]  221-19-240ms   | [S1,MB5,F]  243-9-253ms    | [S1,MB3,B]  281-19-301ms   | [S1,MB6,F]  304-9-314ms    | [S1,MB4,B]  342-19-362ms   | [S1,MB7,F]  365-9-375ms    | [S1,MB5,B]  403-19-423ms   | [S1,MB6,B]  463-19-482ms   | [S1,MB7,B]  523-19-542ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  33-7-40ms      | [S2,MB0,B]  86-17-104ms    | [S2,MB2,F]  107-7-114ms    | [S2,MB1,B]  140-17-158ms   | [S2,MB3,F]  161-7-168ms    | [S2,MB2,B]  198-17-216ms   | [S2,MB4,F]  219-7-227ms    | [S2,MB3,B]  259-17-276ms   | [S2,MB5,F]  280-7-287ms    | [S2,MB4,B]  320-17-337ms   | [S2,MB6,F]  341-7-348ms    | [S2,MB5,B]  381-17-398ms   | [S2,MB7,F]  402-7-409ms    | [S2,MB6,B]  442-17-459ms   | [S2,MB7,B]  502-17-519ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  48-34-82ms     | [S3,MB1,F]  85-11-96ms     | [S3,MB1,B]  102-34-137ms   | [S3,MB2,F]  139-14-153ms   | [S3,MB2,B]  159-35-195ms   | [S3,MB3,F]  197-16-213ms   | [S3,MB3,B]  219-36-255ms   | [S3,MB4,F]  257-16-274ms   | [S3,MB4,B]  280-36-316ms   | [S3,MB5,F]  318-16-335ms   | [S3,MB5,B]  341-36-378ms   | [S3,MB6,F]  379-15-395ms   | [S3,MB6,B]  401-36-438ms   | [S3,MB7,F]  440-15-456ms   | [S3,MB7,B]  462-37-499ms  
[rank3]:2025-12-26 22:56:54,108 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p30_42_dm1/frozen_ratio_history/rank3/251226_2256_stage3_step600.svg
[rank0]:2025-12-26 22:56:54,126 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p30_42_dm1/frozen_params_histogram/251226_2256_rank0_stage0.svg
[rank0]:	> Counts Sum: 648, Total Sum: 2035 (31.84%), Ratio(%) per element: [0.0, 72.72, 72.72, 72.72, 72.72, 72.72, 72.72, 72.72, 72.72, 72.72, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 49.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 9.09, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-26 22:56:54,242 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p30_42_dm1/frozen_params_histogram/251226_2256_rank3_stage3.svg
[rank3]:	> Counts Sum: 801, Total Sum: 1595 (50.22%), Ratio(%) per element: [90.9, 90.9, 90.9, 90.9, 90.9, 90.9, 90.9, 90.9, 90.9, 70.9, 70.9, 70.9, 70.9, 70.9, 70.9, 70.9, 70.9, 70.9, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-12-26 22:57:35,144 - Freezing Ratio: [Stage1] 0.40, Threshold: 9.0244e-01
[rank3]:2025-12-26 22:57:35,156 - Freezing Ratio: [Stage3] 0.62, Threshold: 9.8326e-01
[rank2]:2025-12-26 22:57:35,144 - Freezing Ratio: [Stage2] 0.25, Threshold: 9.8092e-01
[rank0]:2025-12-26 22:57:35,156 - Freezing Ratio: [Stage0] 0.49, Threshold: 1.2292e+00
[rank1]:2025-12-26 22:58:21,381 - Freezing Ratio: [Stage1] 0.60, Threshold: 4.5157e-01
[rank3]:2025-12-26 22:58:21,389 - Freezing Ratio: [Stage3] 0.62, Threshold: 8.1624e-01
[rank2]:2025-12-26 22:58:21,381 - Freezing Ratio: [Stage2] 0.50, Threshold: 5.5681e-01
[rank0]:2025-12-26 22:58:21,393 - Freezing Ratio: [Stage0] 0.73, Threshold: 5.9144e-01
[rank3]:2025-12-26 22:58:48,845 - Avg. fwd time: 14.1747 / Avg. bwd time: 37.8006 / Avg. batch time: 479.1681 (ms) / GPU bubble ratio: 13.22%
[rank2]:2025-12-26 22:58:48,871 - Avg. fwd time: 7.7022 / Avg. bwd time: 17.2370 / Avg. batch time: 508.6388 (ms) / GPU bubble ratio: 60.77%
[rank1]:2025-12-26 22:58:48,899 - Avg. fwd time: 9.7828 / Avg. bwd time: 20.2622 / Avg. batch time: 543.3384 (ms) / GPU bubble ratio: 55.76%
[rank0]:2025-12-26 22:58:48,928 - Avg. fwd time: 8.0928 / Avg. bwd time: 21.6439 / Avg. batch time: 578.1601 (ms) / GPU bubble ratio: 58.85%
[rank2]:2025-12-26 22:59:07,016 - Freezing Ratio: [Stage2] 0.25, Threshold: 1.6953e+00
[rank1]:2025-12-26 22:59:07,016 - Freezing Ratio: [Stage1] 0.40, Threshold: 1.4804e+00
[rank3]:2025-12-26 22:59:07,028 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.3833e+00
[rank0]:2025-12-26 22:59:07,028 - Freezing Ratio: [Stage0] 0.49, Threshold: 2.8791e-01
[rank1]:2025-12-26 22:59:53,439 - Freezing Ratio: [Stage1] 0.60, Threshold: 4.0593e-01
[rank3]:2025-12-26 22:59:53,447 - Freezing Ratio: [Stage3] 0.62, Threshold: 9.2725e-01
[rank0]:2025-12-26 22:59:53,451 - Freezing Ratio: [Stage0] 0.73, Threshold: 2.2449e-01
[rank2]:2025-12-26 22:59:53,439 - Freezing Ratio: [Stage2] 0.50, Threshold: 4.9321e-01
[rank1]:2025-12-26 23:00:39,151 - Freezing Ratio: [Stage1] 0.40, Threshold: 7.4146e-01
[rank0]:2025-12-26 23:00:39,156 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-26 23:00:39,163 - Freezing Ratio: [Stage0] 0.49, Threshold: 1.9510e+00
[rank3]:2025-12-26 23:00:39,163 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.4384e+00
[rank2]:2025-12-26 23:00:39,152 - Freezing Ratio: [Stage2] 0.25, Threshold: 1.8905e+00
[rank3]:2025-12-26 23:00:43,732 - Avg. fwd time: 14.1836 / Avg. bwd time: 37.7373 / Avg. batch time: 478.7307 (ms) / GPU bubble ratio: 13.24%
[rank1]:2025-12-26 23:00:43,792 - Avg. fwd time: 9.7941 / Avg. bwd time: 20.1644 / Avg. batch time: 542.7369 (ms) / GPU bubble ratio: 55.84%
[rank0]:2025-12-26 23:00:43,823 - Avg. fwd time: 8.1117 / Avg. bwd time: 21.4964 / Avg. batch time: 577.4079 (ms) / GPU bubble ratio: 58.98%
[rank2]:2025-12-26 23:00:43,762 - Avg. fwd time: 7.7099 / Avg. bwd time: 17.1772 / Avg. batch time: 508.1363 (ms) / GPU bubble ratio: 60.82%
[rank2]:2025-12-26 23:00:43,840 -  step: 650  loss: -8.0000  grad_norm:  0.1064  memory:  6.98GiB(14.69%)  tps: 7,125  tflops: 55.70  mfu: 17.85%
[rank1]:2025-12-26 23:00:43,840 -  step: 650  loss: -8.0000  grad_norm:  0.1064  memory:  9.50GiB(19.99%)  tps: 7,125  tflops: 55.70  mfu: 17.85%
[rank0]:2025-12-26 23:00:43,851 -  step: 650  loss: -8.0000  grad_norm:  0.1064  memory: 13.42GiB(28.26%)  tps: 7,125  tflops: 55.70  mfu: 17.85%
[rank3]:2025-12-26 23:00:43,850 -  step: 650  loss:  0.2363  grad_norm:  0.1064  memory: 18.36GiB(38.65%)  tps: 7,125  tflops: 55.70  mfu: 17.85%
[rank1]:2025-12-26 23:01:25,625 - Freezing Ratio: [Stage1] 0.60, Threshold: 9.3951e-01
[rank3]:2025-12-26 23:01:25,633 - Freezing Ratio: [Stage3] 0.62, Threshold: 2.4313e+00
[rank0]:2025-12-26 23:01:25,637 - Freezing Ratio: [Stage0] 0.73, Threshold: 7.0200e-01
[rank2]:2025-12-26 23:01:25,625 - Freezing Ratio: [Stage2] 0.50, Threshold: 1.3421e+00
[rank1]:2025-12-26 23:02:11,186 - Freezing Ratio: [Stage1] 0.40, Threshold: 1.6857e+00
[rank3]:2025-12-26 23:02:11,197 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.8325e+00
[rank0]:2025-12-26 23:02:11,197 - Freezing Ratio: [Stage0] 0.49, Threshold: 2.1574e+00
[rank2]:2025-12-26 23:02:11,186 - Freezing Ratio: [Stage2] 0.25, Threshold: 2.0026e+00
[rank3]:2025-12-26 23:02:38,997 - Avg. fwd time: 14.1962 / Avg. bwd time: 37.6767 / Avg. batch time: 478.3447 (ms) / GPU bubble ratio: 13.25%
[rank1]:2025-12-26 23:02:39,064 - Avg. fwd time: 9.8022 / Avg. bwd time: 20.0904 / Avg. batch time: 542.2336 (ms) / GPU bubble ratio: 55.90%
[rank0]:2025-12-26 23:02:39,096 - Avg. fwd time: 8.1270 / Avg. bwd time: 21.3765 / Avg. batch time: 576.7824 (ms) / GPU bubble ratio: 59.08%
[rank2]:2025-12-26 23:02:39,032 - Avg. fwd time: 7.7147 / Avg. bwd time: 17.1387 / Avg. batch time: 507.7073 (ms) / GPU bubble ratio: 60.84%
[rank1]:2025-12-26 23:02:57,646 - Freezing Ratio: [Stage1] 0.60, Threshold: 1.5180e+00
[rank0]:2025-12-26 23:02:57,658 - Freezing Ratio: [Stage0] 0.73, Threshold: 7.1493e-01
[rank3]:2025-12-26 23:02:57,654 - Freezing Ratio: [Stage3] 0.62, Threshold: 2.3165e+00
[rank2]:2025-12-26 23:02:57,646 - Freezing Ratio: [Stage2] 0.50, Threshold: 1.5468e+00
[rank1]:2025-12-26 23:03:43,434 - Freezing Ratio: [Stage1] 0.40, Threshold: 6.2471e-01
[rank0]:2025-12-26 23:03:43,446 - Freezing Ratio: [Stage0] 0.49, Threshold: 7.3568e-01
[rank3]:2025-12-26 23:03:43,446 - Freezing Ratio: [Stage3] 0.62, Threshold: 4.7268e-01
[rank2]:2025-12-26 23:03:43,434 - Freezing Ratio: [Stage2] 0.25, Threshold: 3.3121e-01
[rank1]:2025-12-26 23:04:29,819 - Freezing Ratio: [Stage1] 0.60, Threshold: 2.6120e+00
[rank0]:2025-12-26 23:04:29,809 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-26 23:04:29,830 - Freezing Ratio: [Stage0] 0.73, Threshold: 9.2936e-01
[rank3]:2025-12-26 23:04:29,826 - Freezing Ratio: [Stage3] 0.62, Threshold: 4.4721e+00
[rank2]:2025-12-26 23:04:29,818 - Freezing Ratio: [Stage2] 0.50, Threshold: 2.8351e+00
[rank1]:2025-12-26 23:04:34,327 - Avg. fwd time: 9.8098 / Avg. bwd time: 20.0173 / Avg. batch time: 541.7544 (ms) / GPU bubble ratio: 55.95%
[rank3]:2025-12-26 23:04:34,267 - Avg. fwd time: 14.2085 / Avg. bwd time: 37.6196 / Avg. batch time: 477.9836 (ms) / GPU bubble ratio: 13.26%
[rank2]:2025-12-26 23:04:34,295 - Avg. fwd time: 7.7195 / Avg. bwd time: 17.0987 / Avg. batch time: 507.3020 (ms) / GPU bubble ratio: 60.86%
[rank1]:2025-12-26 23:04:34,369 -  step: 700  loss: -8.0000  grad_norm:  0.1280  memory:  9.50GiB(19.99%)  tps: 7,107  tflops: 55.56  mfu: 17.81%
[rank0]:2025-12-26 23:04:34,357 - Avg. fwd time: 8.1417 / Avg. bwd time: 21.2608 / Avg. batch time: 576.1883 (ms) / GPU bubble ratio: 59.18%
[rank0]:2025-12-26 23:04:34,380 -  step: 700  loss: -8.0000  grad_norm:  0.1280  memory: 13.42GiB(28.26%)  tps: 7,107  tflops: 55.56  mfu: 17.81%
[rank0]:2025-12-26 23:04:34,437 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p30_42_dm1/frozen_ratio_history/rank0/251226_2304_stage0_step700.svg
[rank3]:2025-12-26 23:04:34,381 -  step: 700  loss:  0.1995  grad_norm:  0.1280  memory: 18.36GiB(38.65%)  tps: 7,107  tflops: 55.56  mfu: 17.81%
[rank2]:2025-12-26 23:04:34,369 -  step: 700  loss: -8.0000  grad_norm:  0.1280  memory:  6.98GiB(14.69%)  tps: 7,107  tflops: 55.56  mfu: 17.81%
[rank2]:2025-12-26 23:04:34,433 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p30_42_dm1/frozen_ratio_history/rank2/251226_2304_stage2_step700.svg
[rank1]:2025-12-26 23:04:34,438 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p30_42_dm1/frozen_ratio_history/rank1/251226_2304_stage1_step700.svg
[rank3]:2025-12-26 23:04:34,528 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p30_42_dm1/pipeline_schedule/251226_2304_step700_rank3.svg
[rank3]:			> Batch Time: 564.44 ms, GPU Bubble Ratio: 60.47%, 58.54%, 64.52%, 28.30%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-8-18ms       | [S0,MB2,F]  18-8-27ms      | [S0,MB3,F]  27-8-35ms      | [S0,MB0,B]  133-19-153ms   | [S0,MB4,F]  153-7-161ms    | [S0,MB1,B]  187-19-206ms   | [S0,MB5,F]  206-8-214ms    | [S0,MB2,B]  245-19-264ms   | [S0,MB6,F]  264-8-272ms    | [S0,MB3,B]  305-19-324ms   | [S0,MB7,F]  324-8-332ms    | [S0,MB4,B]  366-19-385ms   | [S0,MB5,B]  425-19-444ms   | [S0,MB6,B]  484-19-503ms   | [S0,MB7,B]  545-19-564ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-9-33ms      | [S1,MB2,F]  36-9-46ms      | [S1,MB0,B]  109-19-128ms   | [S1,MB3,F]  132-9-141ms    | [S1,MB1,B]  162-19-182ms   | [S1,MB4,F]  185-9-195ms    | [S1,MB2,B]  220-19-239ms   | [S1,MB5,F]  243-9-253ms    | [S1,MB3,B]  280-19-300ms   | [S1,MB6,F]  303-9-313ms    | [S1,MB4,B]  341-19-360ms   | [S1,MB7,F]  364-9-374ms    | [S1,MB5,B]  402-19-421ms   | [S1,MB6,B]  462-19-481ms   | [S1,MB7,B]  522-19-541ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  33-7-41ms      | [S2,MB0,B]  86-17-104ms    | [S2,MB2,F]  107-7-115ms    | [S2,MB1,B]  141-17-158ms   | [S2,MB3,F]  161-7-169ms    | [S2,MB2,B]  198-17-215ms   | [S2,MB4,F]  218-7-226ms    | [S2,MB3,B]  258-17-275ms   | [S2,MB5,F]  279-7-286ms    | [S2,MB4,B]  319-17-336ms   | [S2,MB6,F]  340-7-347ms    | [S2,MB5,B]  380-17-397ms   | [S2,MB7,F]  401-7-408ms    | [S2,MB6,B]  441-17-458ms   | [S2,MB7,B]  501-17-519ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  48-34-82ms     | [S3,MB1,F]  85-11-96ms     | [S3,MB1,B]  102-34-137ms   | [S3,MB2,F]  139-13-152ms   | [S3,MB2,B]  158-35-194ms   | [S3,MB3,F]  196-15-212ms   | [S3,MB3,B]  217-36-254ms   | [S3,MB4,F]  256-15-272ms   | [S3,MB4,B]  278-36-315ms   | [S3,MB5,F]  317-15-333ms   | [S3,MB5,B]  339-37-376ms   | [S3,MB6,F]  378-15-393ms   | [S3,MB6,B]  400-37-437ms   | [S3,MB7,F]  439-15-455ms   | [S3,MB7,B]  460-37-498ms  
[rank1]:2025-12-26 23:04:34,589 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p30_42_dm1/frozen_params_histogram/251226_2304_rank1_stage1.svg
[rank1]:	> Counts Sum: 1125, Total Sum: 2925 (38.46%), Ratio(%) per element: [80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 32.3, 32.3, 32.3, 32.3, 32.3, 32.3, 32.3, 32.3, 32.3, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-12-26 23:04:34,596 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p30_42_dm1/frozen_params_histogram/251226_2304_rank0_stage0.svg
[rank0]:	> Counts Sum: 873, Total Sum: 2405 (36.30%), Ratio(%) per element: [0.0, 76.92, 76.92, 76.92, 76.92, 76.92, 76.92, 76.92, 76.92, 76.92, 56.92, 56.92, 56.92, 56.92, 56.92, 56.92, 56.92, 56.92, 56.92, 15.38, 15.38, 15.38, 15.38, 15.38, 15.38, 15.38, 15.38, 15.38, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-26 23:04:34,577 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p30_42_dm1/frozen_ratio_history/rank3/251226_2304_stage3_step700.svg
[rank2]:2025-12-26 23:04:34,585 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p30_42_dm1/frozen_params_histogram/251226_2304_rank2_stage2.svg
[rank2]:	> Counts Sum: 684, Total Sum: 2340 (29.23%), Ratio(%) per element: [83.07, 83.07, 83.07, 83.07, 83.07, 83.07, 83.07, 83.07, 83.07, 33.84, 33.84, 33.84, 33.84, 33.84, 33.84, 33.84, 33.84, 33.84, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-26 23:04:34,708 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p30_42_dm1/frozen_params_histogram/251226_2304_rank3_stage3.svg
[rank3]:	> Counts Sum: 981, Total Sum: 1885 (52.04%), Ratio(%) per element: [92.3, 92.3, 92.3, 92.3, 92.3, 92.3, 92.3, 92.3, 92.3, 75.38, 75.38, 75.38, 75.38, 75.38, 75.38, 75.38, 75.38, 75.38, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-12-26 23:05:15,511 - Freezing Ratio: [Stage2] 0.25, Threshold: 4.0838e-01
[rank1]:2025-12-26 23:05:15,511 - Freezing Ratio: [Stage1] 0.40, Threshold: 7.9706e-01
[rank0]:2025-12-26 23:05:15,523 - Freezing Ratio: [Stage0] 0.49, Threshold: 8.9377e-01
[rank3]:2025-12-26 23:05:15,523 - Freezing Ratio: [Stage3] 0.62, Threshold: 5.2903e-01
[rank2]:2025-12-26 23:06:01,873 - Freezing Ratio: [Stage2] 0.50, Threshold: 1.0176e-01
[rank1]:2025-12-26 23:06:01,874 - Freezing Ratio: [Stage1] 0.60, Threshold: 1.4570e-01
[rank0]:2025-12-26 23:06:01,885 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.9932e-01
[rank3]:2025-12-26 23:06:01,881 - Freezing Ratio: [Stage3] 0.62, Threshold: 7.0869e-01
[rank3]:2025-12-26 23:06:29,094 - Avg. fwd time: 14.2151 / Avg. bwd time: 37.5668 / Avg. batch time: 477.6113 (ms) / GPU bubble ratio: 13.27%
[rank1]:2025-12-26 23:06:29,155 - Avg. fwd time: 9.8193 / Avg. bwd time: 19.9335 / Avg. batch time: 541.2531 (ms) / GPU bubble ratio: 56.02%
[rank0]:2025-12-26 23:06:29,184 - Avg. fwd time: 8.1569 / Avg. bwd time: 21.1376 / Avg. batch time: 575.5602 (ms) / GPU bubble ratio: 59.28%
[rank2]:2025-12-26 23:06:29,122 - Avg. fwd time: 7.7262 / Avg. bwd time: 17.0454 / Avg. batch time: 506.8853 (ms) / GPU bubble ratio: 60.90%
[rank1]:2025-12-26 23:06:47,565 - Freezing Ratio: [Stage1] 0.40, Threshold: 1.5389e+00
[rank3]:2025-12-26 23:06:47,577 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.0353e+00
[rank0]:2025-12-26 23:06:47,577 - Freezing Ratio: [Stage0] 0.49, Threshold: 1.1210e+00
[rank2]:2025-12-26 23:06:47,566 - Freezing Ratio: [Stage2] 0.25, Threshold: 7.3392e-01
[rank1]:2025-12-26 23:07:33,898 - Freezing Ratio: [Stage1] 0.60, Threshold: 7.7490e-01
[rank3]:2025-12-26 23:07:33,905 - Freezing Ratio: [Stage3] 0.62, Threshold: 2.2301e+00
[rank0]:2025-12-26 23:07:33,910 - Freezing Ratio: [Stage0] 0.73, Threshold: 4.9882e-01
[rank2]:2025-12-26 23:07:33,898 - Freezing Ratio: [Stage2] 0.50, Threshold: 1.2216e+00
[rank1]:2025-12-26 23:08:19,399 - Freezing Ratio: [Stage1] 0.40, Threshold: 1.6327e+00
[rank0]:2025-12-26 23:08:19,404 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-26 23:08:19,411 - Freezing Ratio: [Stage0] 0.49, Threshold: 6.8287e-01
[rank3]:2025-12-26 23:08:19,411 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.9430e+00
[rank2]:2025-12-26 23:08:19,399 - Freezing Ratio: [Stage2] 0.25, Threshold: 1.7434e+00
[rank3]:2025-12-26 23:08:23,983 - Avg. fwd time: 14.2247 / Avg. bwd time: 37.5192 / Avg. batch time: 477.3045 (ms) / GPU bubble ratio: 13.27%
[rank2]:2025-12-26 23:08:24,013 - Avg. fwd time: 7.7320 / Avg. bwd time: 16.9995 / Avg. batch time: 506.5288 (ms) / GPU bubble ratio: 60.94%
[rank1]:2025-12-26 23:08:24,046 - Avg. fwd time: 9.8277 / Avg. bwd time: 19.8591 / Avg. batch time: 540.8216 (ms) / GPU bubble ratio: 56.09%
[rank1]:2025-12-26 23:08:24,095 -  step: 750  loss: -8.0000  grad_norm:  0.1406  memory:  9.50GiB(19.99%)  tps: 7,132  tflops: 55.75  mfu: 17.87%
[rank0]:2025-12-26 23:08:24,078 - Avg. fwd time: 8.1707 / Avg. bwd time: 21.0264 / Avg. batch time: 575.0132 (ms) / GPU bubble ratio: 59.38%
[rank0]:2025-12-26 23:08:24,106 -  step: 750  loss: -8.0000  grad_norm:  0.1406  memory: 13.42GiB(28.26%)  tps: 7,132  tflops: 55.75  mfu: 17.87%
[rank3]:2025-12-26 23:08:24,104 -  step: 750  loss:  0.2447  grad_norm:  0.1406  memory: 18.36GiB(38.65%)  tps: 7,132  tflops: 55.76  mfu: 17.87%
[rank2]:2025-12-26 23:08:24,095 -  step: 750  loss: -8.0000  grad_norm:  0.1406  memory:  6.98GiB(14.69%)  tps: 7,132  tflops: 55.75  mfu: 17.87%
[rank1]:2025-12-26 23:09:05,780 - Freezing Ratio: [Stage1] 0.60, Threshold: 5.7899e-01
[rank3]:2025-12-26 23:09:05,787 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.5489e+00
[rank0]:2025-12-26 23:09:05,791 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.9652e-01
[rank2]:2025-12-26 23:09:05,780 - Freezing Ratio: [Stage2] 0.50, Threshold: 7.0446e-01
[rank1]:2025-12-26 23:09:51,388 - Freezing Ratio: [Stage1] 0.40, Threshold: 1.9581e+00
[rank3]:2025-12-26 23:09:51,399 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.7818e+00
[rank2]:2025-12-26 23:09:51,388 - Freezing Ratio: [Stage2] 0.25, Threshold: 2.1009e+00
[rank0]:2025-12-26 23:09:51,399 - Freezing Ratio: [Stage0] 0.49, Threshold: 1.2263e+00
[rank3]:2025-12-26 23:10:19,089 - Avg. fwd time: 14.2320 / Avg. bwd time: 37.4747 / Avg. batch time: 477.0036 (ms) / GPU bubble ratio: 13.28%
[rank1]:2025-12-26 23:10:19,153 - Avg. fwd time: 9.8336 / Avg. bwd time: 19.8041 / Avg. batch time: 540.4333 (ms) / GPU bubble ratio: 56.13%
[rank0]:2025-12-26 23:10:19,187 - Avg. fwd time: 8.1815 / Avg. bwd time: 20.9370 / Avg. batch time: 574.5312 (ms) / GPU bubble ratio: 59.45%
[rank2]:2025-12-26 23:10:19,120 - Avg. fwd time: 7.7354 / Avg. bwd time: 16.9714 / Avg. batch time: 506.1962 (ms) / GPU bubble ratio: 60.95%
[rank3]:2025-12-26 23:10:37,714 - Freezing Ratio: [Stage3] 0.62, Threshold: 3.2327e+00
[rank0]:2025-12-26 23:10:37,718 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.0880e+00
[rank2]:2025-12-26 23:10:37,706 - Freezing Ratio: [Stage2] 0.50, Threshold: 2.2747e+00
[rank1]:2025-12-26 23:10:37,706 - Freezing Ratio: [Stage1] 0.60, Threshold: 2.2490e+00
[rank2]:2025-12-26 23:11:23,202 - Freezing Ratio: [Stage2] 0.25, Threshold: 9.3611e-01
[rank1]:2025-12-26 23:11:23,202 - Freezing Ratio: [Stage1] 0.40, Threshold: 1.1078e+00
[rank3]:2025-12-26 23:11:23,214 - Freezing Ratio: [Stage3] 0.62, Threshold: 5.1044e-01
[rank0]:2025-12-26 23:11:23,214 - Freezing Ratio: [Stage0] 0.49, Threshold: 8.1389e-01
[rank0]:2025-12-26 23:12:09,635 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-26 23:12:09,655 - Freezing Ratio: [Stage0] 0.73, Threshold: 3.2955e-01
[rank2]:2025-12-26 23:12:09,645 - Freezing Ratio: [Stage2] 0.50, Threshold: 8.7429e-01
[rank1]:2025-12-26 23:12:09,644 - Freezing Ratio: [Stage1] 0.60, Threshold: 9.1927e-01
[rank3]:2025-12-26 23:12:09,652 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.4766e+00
[rank3]:2025-12-26 23:12:14,217 - Avg. fwd time: 14.2403 / Avg. bwd time: 37.4333 / Avg. batch time: 476.7359 (ms) / GPU bubble ratio: 13.29%
[rank2]:2025-12-26 23:12:14,245 - Avg. fwd time: 7.7392 / Avg. bwd time: 16.9416 / Avg. batch time: 505.8960 (ms) / GPU bubble ratio: 60.97%
[rank1]:2025-12-26 23:12:14,275 - Avg. fwd time: 9.8397 / Avg. bwd time: 19.7492 / Avg. batch time: 540.0777 (ms) / GPU bubble ratio: 56.17%
[rank1]:2025-12-26 23:12:14,317 -  step: 800  loss: -8.0000  grad_norm:  0.3088  memory:  9.50GiB(19.99%)  tps: 7,117  tflops: 55.63  mfu: 17.83%
[rank1]:2025-12-26 23:12:14,317 - â„¹ï¸ final step: 800  loss: -8.0000  grad_norm:  0.3088  tps: 7,352  tflops: 57.48  mfu: 16.77%
[rank1]:2025-12-26 23:12:14,318 - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-12-26 23:12:14,319 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank3]:2025-12-26 23:12:14,330 -  step: 800  loss:  0.2473  grad_norm:  0.3088  memory: 18.36GiB(38.65%)  tps: 7,117  tflops: 55.63  mfu: 17.83%
[rank3]:2025-12-26 23:12:14,330 - â„¹ï¸ final step: 800  loss:  0.2473  grad_norm:  0.3088  tps: 7,360  tflops: 57.54  mfu: 16.95%
[rank3]:2025-12-26 23:12:14,331 - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-12-26 23:12:14,332 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-26 23:12:14,305 - Avg. fwd time: 8.1923 / Avg. bwd time: 20.8497 / Avg. batch time: 574.0846 (ms) / GPU bubble ratio: 59.53%
[rank0]:2025-12-26 23:12:14,328 -  step: 800  loss: -8.0000  grad_norm:  0.3088  memory: 13.42GiB(28.26%)  tps: 7,117  tflops: 55.63  mfu: 17.83%
[rank0]:2025-12-26 23:12:14,328 - â„¹ï¸ final step: 800  loss: -8.0000  grad_norm:  0.3088  tps: 7,352  tflops: 57.47  mfu: 16.76%
[rank0]:2025-12-26 23:12:14,328 - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-12-26 23:12:14,329 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank2]:2025-12-26 23:12:14,317 -  step: 800  loss: -8.0000  grad_norm:  0.3088  memory:  6.98GiB(14.69%)  tps: 7,117  tflops: 55.63  mfu: 17.83%
[rank2]:2025-12-26 23:12:14,317 - â„¹ï¸ final step: 800  loss: -8.0000  grad_norm:  0.3088  tps: 7,352  tflops: 57.48  mfu: 16.76%
[rank2]:2025-12-26 23:12:14,318 - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-12-26 23:12:14,318 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-26 23:12:16,314 - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank1]:2025-12-26 23:12:16,399 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p30_42_dm1/frozen_ratio_history/rank1/251226_2312_stage1_final800.svg
[rank0]:2025-12-26 23:12:16,388 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p30_42_dm1/frozen_ratio_history/rank0/251226_2312_stage0_final800.svg
[rank2]:2025-12-26 23:12:16,385 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p30_42_dm1/frozen_ratio_history/rank2/251226_2312_stage2_final800.svg
[rank3]:2025-12-26 23:12:16,474 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p30_42_dm1/pipeline_schedule/251226_2312_final800_rank3.svg
[rank3]:			> Batch Time: 565.50 ms, GPU Bubble Ratio: 60.64%, 58.63%, 64.59%, 28.20%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-8-18ms       | [S0,MB2,F]  18-8-26ms      | [S0,MB3,F]  26-8-34ms      | [S0,MB0,B]  133-19-153ms   | [S0,MB4,F]  153-7-161ms    | [S0,MB1,B]  187-19-207ms   | [S0,MB5,F]  207-7-215ms    | [S0,MB2,B]  245-19-265ms   | [S0,MB6,F]  265-7-273ms    | [S0,MB3,B]  306-19-325ms   | [S0,MB7,F]  325-7-333ms    | [S0,MB4,B]  367-19-386ms   | [S0,MB5,B]  426-19-446ms   | [S0,MB6,B]  485-19-505ms   | [S0,MB7,B]  546-19-565ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-9-33ms      | [S1,MB2,F]  36-9-46ms      | [S1,MB0,B]  108-19-128ms   | [S1,MB3,F]  131-9-141ms    | [S1,MB1,B]  163-19-182ms   | [S1,MB4,F]  186-9-195ms    | [S1,MB2,B]  221-19-240ms   | [S1,MB5,F]  243-9-253ms    | [S1,MB3,B]  282-19-301ms   | [S1,MB6,F]  304-9-314ms    | [S1,MB4,B]  343-19-362ms   | [S1,MB7,F]  365-9-375ms    | [S1,MB5,B]  404-19-423ms   | [S1,MB6,B]  463-19-482ms   | [S1,MB7,B]  523-19-542ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  33-7-41ms      | [S2,MB0,B]  86-17-104ms    | [S2,MB2,F]  107-7-114ms    | [S2,MB1,B]  141-17-159ms   | [S2,MB3,F]  161-7-169ms    | [S2,MB2,B]  199-17-217ms   | [S2,MB4,F]  219-7-227ms    | [S2,MB3,B]  260-17-277ms   | [S2,MB5,F]  280-7-287ms    | [S2,MB4,B]  321-17-338ms   | [S2,MB6,F]  341-7-349ms    | [S2,MB5,B]  382-17-400ms   | [S2,MB7,F]  402-7-410ms    | [S2,MB6,B]  443-17-461ms   | [S2,MB7,B]  503-17-521ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  48-34-83ms     | [S3,MB1,F]  85-11-96ms     | [S3,MB1,B]  102-35-138ms   | [S3,MB2,F]  140-13-154ms   | [S3,MB2,B]  160-36-196ms   | [S3,MB3,F]  198-15-213ms   | [S3,MB3,B]  219-36-256ms   | [S3,MB4,F]  258-15-274ms   | [S3,MB4,B]  280-37-317ms   | [S3,MB5,F]  319-15-335ms   | [S3,MB5,B]  341-37-379ms   | [S3,MB6,F]  381-15-396ms   | [S3,MB6,B]  402-37-440ms   | [S3,MB7,F]  442-14-457ms   | [S3,MB7,B]  463-37-500ms  
[rank0]:2025-12-26 23:12:16,541 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p30_42_dm1/frozen_params_histogram/251226_2312_rank0_stage0.svg
[rank0]:	> Counts Sum: 1098, Total Sum: 2775 (39.57%), Ratio(%) per element: [0.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 62.66, 62.66, 62.66, 62.66, 62.66, 62.66, 62.66, 62.66, 62.66, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-12-26 23:12:16,541 - Sleeping 2 seconds for other ranks to complete
[rank2]:2025-12-26 23:12:16,535 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p30_42_dm1/frozen_params_histogram/251226_2312_rank2_stage2.svg
[rank2]:	> Counts Sum: 819, Total Sum: 2700 (30.33%), Ratio(%) per element: [85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 36.0, 36.0, 36.0, 36.0, 36.0, 36.0, 36.0, 36.0, 36.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-12-26 23:12:16,535 - Destroying the purge thread.
[rank1]:2025-12-26 23:12:16,559 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p30_42_dm1/frozen_params_histogram/251226_2312_rank1_stage1.svg
[rank1]:	> Counts Sum: 1350, Total Sum: 3375 (40.00%), Ratio(%) per element: [82.66, 82.66, 82.66, 82.66, 82.66, 82.66, 82.66, 82.66, 82.66, 82.66, 82.66, 82.66, 82.66, 82.66, 82.66, 82.66, 82.66, 82.66, 34.66, 34.66, 34.66, 34.66, 34.66, 34.66, 34.66, 34.66, 34.66, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-12-26 23:12:16,559 - Destroying the purge thread.
[rank3]:2025-12-26 23:12:16,607 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p30_42_dm1/pipeline_schedule/251226_2312_thry_final800_rank3.svg
[rank3]:			> Batch Time: 331.84 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-10-10ms      | [S0,MB1,F]  10-10-20ms     | [S0,MB2,F]  20-10-30ms     | [S0,MB3,F]  30-10-40ms     | [S0,MB0,B]  100-20-120ms   | [S0,MB4,F]  120-10-130ms   | [S0,MB1,B]  130-20-150ms   | [S0,MB5,F]  150-10-160ms   | [S0,MB2,B]  160-20-181ms   | [S0,MB6,F]  181-10-191ms   | [S0,MB3,B]  191-20-211ms   | [S0,MB7,F]  211-10-221ms   | [S0,MB4,B]  221-20-241ms   | [S0,MB5,B]  251-20-271ms   | [S0,MB6,B]  281-20-301ms   | [S0,MB7,B]  311-20-331ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  10-10-20ms     | [S1,MB1,F]  20-10-30ms     | [S1,MB2,F]  30-10-40ms     | [S1,MB0,B]  80-20-100ms    | [S1,MB3,F]  100-10-110ms   | [S1,MB1,B]  110-20-130ms   | [S1,MB4,F]  130-10-140ms   | [S1,MB2,B]  140-20-160ms   | [S1,MB5,F]  160-10-170ms   | [S1,MB3,B]  170-20-191ms   | [S1,MB6,F]  191-10-201ms   | [S1,MB4,B]  201-20-221ms   | [S1,MB7,F]  221-10-231ms   | [S1,MB5,B]  231-20-251ms   | [S1,MB6,B]  261-20-281ms   | [S1,MB7,B]  291-20-311ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-10-30ms     | [S2,MB1,F]  30-10-40ms     | [S2,MB0,B]  60-20-80ms     | [S2,MB2,F]  80-10-90ms     | [S2,MB1,B]  90-20-110ms    | [S2,MB3,F]  110-10-120ms   | [S2,MB2,B]  120-20-140ms   | [S2,MB4,F]  140-10-150ms   | [S2,MB3,B]  150-20-170ms   | [S2,MB5,F]  170-10-181ms   | [S2,MB4,B]  181-20-201ms   | [S2,MB6,F]  201-10-211ms   | [S2,MB5,B]  211-20-231ms   | [S2,MB7,F]  231-10-241ms   | [S2,MB6,B]  241-20-261ms   | [S2,MB7,B]  271-20-291ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  30-10-40ms     | [S3,MB0,B]  40-20-60ms     | [S3,MB1,F]  60-10-70ms     | [S3,MB1,B]  70-20-90ms     | [S3,MB2,F]  90-10-100ms    | [S3,MB2,B]  100-20-120ms   | [S3,MB3,F]  120-10-130ms   | [S3,MB3,B]  130-20-150ms   | [S3,MB4,F]  150-10-160ms   | [S3,MB4,B]  160-20-181ms   | [S3,MB5,F]  181-10-191ms   | [S3,MB5,B]  191-20-211ms   | [S3,MB6,F]  211-10-221ms   | [S3,MB6,B]  221-20-241ms   | [S3,MB7,F]  241-10-251ms   | [S3,MB7,B]  251-20-271ms  
[rank3]:2025-12-26 23:12:16,656 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p30_42_dm1/frozen_ratio_history/rank3/251226_2312_stage3_final800.svg
[rank3]:2025-12-26 23:12:16,786 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p30_42_dm1/frozen_params_histogram/251226_2312_rank3_stage3.svg
[rank3]:	> Counts Sum: 1161, Total Sum: 2175 (53.38%), Ratio(%) per element: [93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 78.66, 78.66, 78.66, 78.66, 78.66, 78.66, 78.66, 78.66, 78.66, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-26 23:12:16,787 - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank1]:2025-12-26 23:12:16,978 - Process group destroyed
[rank2]:2025-12-26 23:12:16,977 - Process group destroyed
[rank3]:wandb: uploading history steps 15-16, summary, console lines 363-383
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–â–ƒâ–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–ˆâ–†â–ƒâ–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–ˆâ–†â–ƒâ–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 4.45231
[rank3]:wandb:               final/avg_loss 0.24728
[rank3]:wandb:             final/avg_mfu(%) 16.94792
[rank3]:wandb:             final/avg_tflops 57.53539
[rank3]:wandb:    final/avg_throughput(tps) 7359.78265
[rank3]:wandb:              final/grad_norm 0.3088
[rank3]:wandb:               final/max_loss 0.24728
[rank3]:wandb:                    grad_norm 0.3088
[rank3]:wandb: loss_metrics/global_avg_loss 0.24728
[rank3]:wandb: loss_metrics/global_max_loss 0.24728
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1226_1F1B_auto_p30_42_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/glbz3mu8
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1226_1F1B_auto_p30_42_dm1/20251226-2209/wandb/run-20251226_220908-glbz3mu8/logs
[rank3]:2025-12-26 23:12:17,901 - Process group destroyed
[rank0]:2025-12-26 23:12:18,541 - Training completed
[rank0]:2025-12-26 23:12:18,542 - Destroying the purge thread.
[rank0]:2025-12-26 23:12:19,019 - Process group destroyed
[rank0]:Stage 0: Modules to keep: {'layers.1', 'layers.3', 'tok_embeddings', 'layers.2', 'layers.0'}
[rank2]:Stage 2: Modules to keep: {'layers.9', 'layers.11', 'layers.12', 'layers.10'}
[rank1]:Stage 1: Modules to keep: {'layers.8', 'layers.4', 'layers.6', 'layers.5', 'layers.7'}
[rank3]:Stage 3: Modules to keep: {'layers.15', 'layers.14', 'norm', 'layers.13', 'output'}
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1116_autofreeze/config_1226.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "AutoFreeze configuration experiment on different PERCENTILE values."
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1226_1F1B_auto_p30_42_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1226_1F1B_auto_p30_42_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1226_1F1B_auto_p30_42_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1226_1F1B_auto_p30_42_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1226_1F1B_auto_p30_42_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1226_1F1B_auto_p30_42_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 42
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: 1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1226_1F1B_auto_p30_42_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1226_1F1B_auto_p30_42_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: auto
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.05
[rank3]:		- percentile: 30
[rank3]:
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
