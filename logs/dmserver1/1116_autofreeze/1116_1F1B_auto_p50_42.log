
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 11. 28. (ê¸ˆ) 16:06:42 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 1,2,3,4
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1116_autofreeze/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1116_autofreeze/1116_1F1B_auto_p50_42.log
âœ”ï¸AutoFreeze configuration experiment on different PERCENTILE values.
âœ”ï¸Running with autofreeze (percentile=50) x 1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1116_autofreeze/config_1116.toml --job.description="AutoFreeze configuration experiment on different PERCENTILE values." --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=auto --freezing.percentile=50
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank3]:2025-11-28 16:06:48,783 - INFO - Starting job: "AutoFreeze configuration experiment on different PERCENTILE values."
[rank1]:2025-11-28 16:06:48,782 - INFO - Starting job: "AutoFreeze configuration experiment on different PERCENTILE values."
[rank2]:2025-11-28 16:06:48,786 - INFO - Starting job: "AutoFreeze configuration experiment on different PERCENTILE values."
[rank0]:2025-11-28 16:06:48,862 - INFO - Starting job: "AutoFreeze configuration experiment on different PERCENTILE values."
[rank3]:2025-11-28 16:06:49,117 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-11-28 16:06:49,119 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-11-28 16:06:49,133 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-11-28 16:06:49,086 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-11-28 16:06:49,135 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-11-28 16:06:49,088 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-28 16:06:49,181 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-11-28 16:06:49,183 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-28 16:06:49,187 - INFO - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-11-28 16:06:49,188 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-11-28 16:06:49,567 - INFO - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank0]:2025-11-28 16:06:52,414 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank1]:2025-11-28 16:06:52,532 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-11-28 16:06:52,584 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-11-28 16:06:52,628 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-28 16:06:52,629 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-11-28 16:06:52,652 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-11-28 16:06:52,652 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank2]:2025-11-28 16:06:52,588 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-11-28 16:06:52,572 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-11-28 16:06:52,621 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-11-28 16:06:52,644 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank1]:2025-11-28 16:06:52,597 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-11-28 16:06:52,597 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank2]:2025-11-28 16:06:52,644 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank2]:2025-11-28 16:06:52,819 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-11-28 16:06:52,819 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-11-28 16:06:52,820 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank1]:2025-11-28 16:06:52,784 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-11-28 16:06:52,784 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-11-28 16:06:52,785 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank0]:2025-11-28 16:06:52,869 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-28 16:06:52,869 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-11-28 16:06:52,870 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run 6fx3cf2h
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1116_1F1B_auto_p50_42_dm1/20251128-1606/wandb/run-20251128_160654-6fx3cf2h
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1116_1F1B_auto_p50_42_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/6fx3cf2h
[rank3]:2025-11-28 16:06:55,831 - INFO - WandB logging enabled
[rank3]:2025-11-28 16:06:55,831 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-11-28 16:06:55,870 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-11-28 16:06:55,899 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-11-28 16:06:55,899 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank3]:2025-11-28 16:06:56,081 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-11-28 16:06:56,082 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-11-28 16:06:56,083 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank0]:2025-11-28 16:06:56,098 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1116_1F1B_auto_p50_42_dm1
[rank0]:2025-11-28 16:06:56,099 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-11-28 16:06:56,098 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-28 16:06:56,099 - INFO - Trainer is initialized with local batch size 16, global batch size 128, gradient accumulation steps 8, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2025-11-28 16:06:56,099 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank1]:2025-11-28 16:06:56,098 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank2]:2025-11-28 16:06:56,098 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-28 16:06:58,519 - INFO - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-11-28 16:06:58,519 - INFO - Finished loading the checkpoint in 2.42 seconds.
[rank0]:2025-11-28 16:06:58,519 - INFO - Training starts at step 1
[rank3]:2025-11-28 16:07:04,096 - INFO -  step:  1  loss: 10.6088  grad_norm: 116.5369  memory: 12.97GiB(27.31%)  tps: 3,984  tflops: 31.15  mfu: 9.98%
[rank3]:2025-11-28 16:07:04,097 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-11-28 16:07:04,089 - INFO -  step:  1  loss: -8.0000  grad_norm: 116.5369  memory:  6.76GiB(14.24%)  tps: 2,845  tflops: 22.24  mfu: 7.13%
[rank1]:2025-11-28 16:07:04,089 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-28 16:07:04,128 - INFO -  step:  1  loss: -8.0000  grad_norm: 116.5369  memory:  9.19GiB(19.34%)  tps: 2,850  tflops: 22.28  mfu: 7.14%
[rank0]:2025-11-28 16:07:04,128 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-11-28 16:07:04,086 - INFO -  step:  1  loss: -8.0000  grad_norm: 116.5369  memory:  4.63GiB(9.75%)  tps: 2,858  tflops: 22.34  mfu: 7.16%
[rank2]:2025-11-28 16:07:04,086 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-11-28 16:09:05,712 - INFO - Avg. fwd time: 13.5042 / Avg. bwd time: 42.1672 / Avg. batch time: 508.9912 (ms) / GPU bubble ratio: 12.50%
[rank0]:2025-11-28 16:09:05,782 - INFO - Avg. fwd time: 7.6270 / Avg. bwd time: 24.1260 / Avg. batch time: 617.9301 (ms) / GPU bubble ratio: 58.89%
[rank2]:2025-11-28 16:09:05,751 - INFO - Avg. fwd time: 7.3578 / Avg. bwd time: 19.1235 / Avg. batch time: 541.0968 (ms) / GPU bubble ratio: 60.85%
[rank1]:2025-11-28 16:09:05,785 - INFO - Avg. fwd time: 9.2309 / Avg. bwd time: 23.7634 / Avg. batch time: 579.9977 (ms) / GPU bubble ratio: 54.49%
[rank0]:2025-11-28 16:11:08,255 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-28 16:11:13,077 - INFO - Avg. fwd time: 7.3737 / Avg. bwd time: 19.1854 / Avg. batch time: 543.1138 (ms) / GPU bubble ratio: 60.88%
[rank0]:2025-11-28 16:11:13,108 - INFO - Avg. fwd time: 7.6483 / Avg. bwd time: 24.1874 / Avg. batch time: 619.2596 (ms) / GPU bubble ratio: 58.87%
[rank3]:2025-11-28 16:11:13,038 - INFO - Avg. fwd time: 13.5450 / Avg. bwd time: 42.4401 / Avg. batch time: 511.3922 (ms) / GPU bubble ratio: 12.42%
[rank1]:2025-11-28 16:11:13,112 - INFO - Avg. fwd time: 9.2574 / Avg. bwd time: 23.8466 / Avg. batch time: 581.6824 (ms) / GPU bubble ratio: 54.47%
[rank2]:2025-11-28 16:11:13,337 - INFO -  step: 50  loss: -8.0000  grad_norm: 13.0741  memory:  6.43GiB(13.53%)  tps: 6,442  tflops: 50.36  mfu: 16.14%
[rank1]:2025-11-28 16:11:13,340 - INFO -  step: 50  loss: -8.0000  grad_norm: 13.0741  memory:  9.03GiB(19.01%)  tps: 6,442  tflops: 50.36  mfu: 16.14%
[rank0]:2025-11-28 16:11:13,352 - INFO -  step: 50  loss: -8.0000  grad_norm: 13.0741  memory: 12.97GiB(27.31%)  tps: 6,443  tflops: 50.36  mfu: 16.14%
[rank3]:2025-11-28 16:11:13,349 - INFO -  step: 50  loss:  9.9265  grad_norm: 13.0741  memory: 16.39GiB(34.50%)  tps: 6,442  tflops: 50.36  mfu: 16.14%
[rank1]:2025-11-28 16:12:04,216 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 0.0000e+00
[rank0]:2025-11-28 16:12:04,229 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 0.0000e+00
[rank2]:2025-11-28 16:12:04,213 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 0.0000e+00
[rank3]:2025-11-28 16:12:04,224 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 0.0000e+00
[rank1]:2025-11-28 16:12:55,316 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 3.5742e+00
[rank2]:2025-11-28 16:12:55,312 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 3.2350e+00
[rank0]:2025-11-28 16:12:55,328 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 4.4942e+00
[rank3]:2025-11-28 16:12:55,324 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 3.3196e+00
[rank2]:2025-11-28 16:13:20,847 - INFO - Avg. fwd time: 7.3682 / Avg. bwd time: 19.2151 / Avg. batch time: 543.7226 (ms) / GPU bubble ratio: 60.89%
[rank3]:2025-11-28 16:13:20,821 - INFO - Avg. fwd time: 13.5623 / Avg. bwd time: 42.5165 / Avg. batch time: 512.1078 (ms) / GPU bubble ratio: 12.40%
[rank1]:2025-11-28 16:13:20,878 - INFO - Avg. fwd time: 9.2496 / Avg. bwd time: 23.8761 / Avg. batch time: 582.1910 (ms) / GPU bubble ratio: 54.48%
[rank0]:2025-11-28 16:13:20,908 - INFO - Avg. fwd time: 7.6498 / Avg. bwd time: 24.2108 / Avg. batch time: 619.6552 (ms) / GPU bubble ratio: 58.87%
[rank2]:2025-11-28 16:13:46,488 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.0441e+00
[rank3]:2025-11-28 16:13:46,500 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 3.4190e+00
[rank0]:2025-11-28 16:13:46,504 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 3.0721e+00
[rank1]:2025-11-28 16:13:46,492 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 7.3679e-01
[rank1]:2025-11-28 16:14:36,702 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.2111e+00
[rank2]:2025-11-28 16:14:36,690 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.8310e+00
[rank3]:2025-11-28 16:14:36,709 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 3.0733e+00
[rank0]:2025-11-28 16:14:36,710 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 1.8621e+00
[rank0]:2025-11-28 16:15:20,578 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-28 16:15:25,119 - INFO - Avg. fwd time: 13.5540 / Avg. bwd time: 42.2989 / Avg. batch time: 510.2797 (ms) / GPU bubble ratio: 12.44%
[rank1]:2025-11-28 16:15:25,195 - INFO - Avg. fwd time: 9.2608 / Avg. bwd time: 23.8935 / Avg. batch time: 579.7125 (ms) / GPU bubble ratio: 54.25%
[rank2]:2025-11-28 16:15:25,160 - INFO - Avg. fwd time: 7.4423 / Avg. bwd time: 18.6842 / Avg. batch time: 541.2933 (ms) / GPU bubble ratio: 61.39%
[rank0]:2025-11-28 16:15:25,191 - INFO - Avg. fwd time: 7.6887 / Avg. bwd time: 23.9479 / Avg. batch time: 616.8531 (ms) / GPU bubble ratio: 58.97%
[rank3]:2025-11-28 16:15:25,419 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.4577e+00
[rank3]:2025-11-28 16:15:25,422 - INFO -  step: 100  loss:  8.3792  grad_norm:  8.3274  memory: 16.39GiB(34.50%)  tps: 6,500  tflops: 50.81  mfu: 16.29%
[rank2]:2025-11-28 16:15:25,412 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.4448e+00
[rank2]:2025-11-28 16:15:25,412 - INFO -  step: 100  loss: -8.0000  grad_norm:  8.3274  memory:  6.43GiB(13.53%)  tps: 6,500  tflops: 50.81  mfu: 16.29%
[rank0]:2025-11-28 16:15:25,427 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 2.7763e+00
[rank0]:2025-11-28 16:15:25,427 - INFO -  step: 100  loss: -8.0000  grad_norm:  8.3274  memory: 12.97GiB(27.31%)  tps: 6,500  tflops: 50.81  mfu: 16.29%
[rank1]:2025-11-28 16:15:25,416 - INFO - Freezing Ratio: [Stage1] 0.20, Threshold: 2.6845e+00
[rank1]:2025-11-28 16:15:25,416 - INFO -  step: 100  loss: -8.0000  grad_norm:  8.3274  memory:  9.03GiB(19.01%)  tps: 6,500  tflops: 50.81  mfu: 16.29%
[rank1]:2025-11-28 16:15:25,501 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p50_42_dm1/frozen_ratio_history/rank1/251128_1615_stage1_step100.svg
[rank2]:2025-11-28 16:15:25,509 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p50_42_dm1/frozen_ratio_history/rank2/251128_1615_stage2_step100.svg
[rank0]:2025-11-28 16:15:25,498 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p50_42_dm1/frozen_ratio_history/rank0/251128_1615_stage0_step100.svg
[rank3]:2025-11-28 16:15:25,586 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p50_42_dm1/pipeline_schedule/251128_1615_real_step100_rank3.svg
[rank3]:			> Batch Time: 593.31 ms, GPU Bubble Ratio: 56.79%, 55.01%, 63.98%, 28.79%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms                       | [S0,MB1,F]  9-7-17ms                      | [S0,MB2,F]  17-7-25ms                     | [S0,MB3,F]  25-7-32ms                     | [S0,MB0,B]  143-24-167ms                  | [S0,MB4,F]  167-7-174ms                   | [S0,MB1,B]  200-24-224ms                  | [S0,MB5,F]  224-7-231ms                   | [S0,MB2,B]  259-24-284ms                  | [S0,MB6,F]  284-7-291ms                   | [S0,MB3,B]  321-24-345ms                  | [S0,MB7,F]  345-7-352ms                   | [S0,MB4,B]  385-24-409ms                  | [S0,MB5,B]  444-24-469ms                  | [S0,MB6,B]  505-24-529ms                  | [S0,MB7,B]  569-24-593ms                 
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms                     | [S1,MB1,F]  23-8-32ms                     | [S1,MB2,F]  35-8-44ms                     | [S1,MB0,B]  113-24-138ms                  | [S1,MB3,F]  141-8-150ms                   | [S1,MB1,B]  170-24-194ms                  | [S1,MB4,F]  198-9-207ms                   | [S1,MB2,B]  230-24-254ms                  | [S1,MB5,F]  258-9-267ms                   | [S1,MB3,B]  292-24-316ms                  | [S1,MB6,F]  319-9-328ms                   | [S1,MB4,B]  356-24-380ms                  | [S1,MB7,F]  383-9-392ms                   | [S1,MB5,B]  418-24-442ms                  | [S1,MB6,B]  477-23-501ms                  | [S1,MB7,B]  540-23-563ms                 
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms                     | [S2,MB1,F]  32-7-39ms                     | [S2,MB0,B]  89-19-108ms                   | [S2,MB2,F]  112-7-119ms                   | [S2,MB1,B]  146-19-165ms                  | [S2,MB3,F]  169-7-176ms                   | [S2,MB2,B]  206-19-225ms                  | [S2,MB4,F]  229-7-236ms                   | [S2,MB3,B]  267-19-286ms                  | [S2,MB5,F]  290-7-297ms                   | [S2,MB4,B]  331-19-351ms                  | [S2,MB6,F]  354-7-361ms                   | [S2,MB5,B]  393-19-413ms                  | [S2,MB7,F]  416-7-423ms                   | [S2,MB6,B]  455-19-474ms                  | [S2,MB7,B]  517-19-536ms                 
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-43ms                    | [S3,MB0,B]  48-36-85ms                    | [S3,MB1,F]  87-11-99ms                    | [S3,MB1,B]  104-37-142ms                  | [S3,MB2,F]  144-12-157ms                  | [S3,MB2,B]  163-39-202ms                  | [S3,MB3,F]  204-14-218ms                  | [S3,MB3,B]  223-39-263ms                  | [S3,MB4,F]  265-14-279ms                  | [S3,MB4,B]  286-40-327ms                  | [S3,MB5,F]  330-13-344ms                  | [S3,MB5,B]  349-40-390ms                  | [S3,MB6,F]  392-13-406ms                  | [S3,MB6,B]  411-40-451ms                  | [S3,MB7,F]  453-14-467ms                  | [S3,MB7,B]  474-40-514ms                 
[rank3]:2025-11-28 16:15:25,633 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p50_42_dm1/frozen_ratio_history/rank3/251128_1615_stage3_step100.svg
[rank1]:2025-11-28 16:16:15,653 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 8.5085e-01
[rank3]:2025-11-28 16:16:15,665 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 1.2807e+00
[rank2]:2025-11-28 16:16:15,645 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.1187e+00
[rank0]:2025-11-28 16:16:15,665 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 3.5357e+00
[rank1]:2025-11-28 16:17:04,693 - INFO - Freezing Ratio: [Stage1] 0.20, Threshold: 1.7328e+00
[rank3]:2025-11-28 16:17:04,696 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.8852e+00
[rank2]:2025-11-28 16:17:04,688 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 8.0311e-01
[rank0]:2025-11-28 16:17:04,704 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 3.0512e+00
[rank3]:2025-11-28 16:17:29,293 - INFO - Avg. fwd time: 13.5518 / Avg. bwd time: 42.0361 / Avg. batch time: 508.1506 (ms) / GPU bubble ratio: 12.49%
[rank0]:2025-11-28 16:17:29,313 - INFO - Avg. fwd time: 7.7210 / Avg. bwd time: 23.7171 / Avg. batch time: 613.7049 (ms) / GPU bubble ratio: 59.02%
[rank1]:2025-11-28 16:17:29,353 - INFO - Avg. fwd time: 9.3000 / Avg. bwd time: 23.6079 / Avg. batch time: 576.8352 (ms) / GPU bubble ratio: 54.36%
[rank2]:2025-11-28 16:17:29,315 - INFO - Avg. fwd time: 7.5045 / Avg. bwd time: 18.2176 / Avg. batch time: 538.7487 (ms) / GPU bubble ratio: 61.80%
[rank1]:2025-11-28 16:17:54,768 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 7.4920e+00
[rank3]:2025-11-28 16:17:54,779 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 7.1969e+00
[rank2]:2025-11-28 16:17:54,760 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.6048e+00
[rank0]:2025-11-28 16:17:54,780 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 1.3880e+01
[rank3]:2025-11-28 16:18:43,398 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.6227e+00
[rank2]:2025-11-28 16:18:43,391 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.1717e+00
[rank0]:2025-11-28 16:18:43,403 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 3.5313e+00
[rank1]:2025-11-28 16:18:43,395 - INFO - Freezing Ratio: [Stage1] 0.20, Threshold: 2.3056e+00
[rank0]:2025-11-28 16:19:28,401 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-28 16:19:33,317 - INFO - Avg. fwd time: 13.5790 / Avg. bwd time: 41.9419 / Avg. batch time: 507.6093 (ms) / GPU bubble ratio: 12.50%
[rank2]:2025-11-28 16:19:33,338 - INFO - Avg. fwd time: 7.5564 / Avg. bwd time: 17.8293 / Avg. batch time: 537.7655 (ms) / GPU bubble ratio: 62.24%
[rank1]:2025-11-28 16:19:33,366 - INFO - Avg. fwd time: 9.3292 / Avg. bwd time: 23.3802 / Avg. batch time: 575.5969 (ms) / GPU bubble ratio: 54.54%
[rank1]:2025-11-28 16:19:33,414 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 4.2664e+00
[rank3]:2025-11-28 16:19:33,425 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 3.7384e+00
[rank3]:2025-11-28 16:19:33,428 - INFO -  step: 150  loss:  3.7436  grad_norm: 10.8999  memory: 16.39GiB(34.50%)  tps: 6,606  tflops: 51.65  mfu: 16.55%
[rank0]:2025-11-28 16:19:33,391 - INFO - Avg. fwd time: 7.7965 / Avg. bwd time: 23.1699 / Avg. batch time: 611.9010 (ms) / GPU bubble ratio: 59.51%
[rank0]:2025-11-28 16:19:33,421 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 4.0238e+00
[rank0]:2025-11-28 16:19:33,422 - INFO -  step: 150  loss: -8.0000  grad_norm: 10.8999  memory: 12.97GiB(27.31%)  tps: 6,607  tflops: 51.65  mfu: 16.55%
[rank2]:2025-11-28 16:19:33,406 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 4.1630e+00
[rank2]:2025-11-28 16:19:33,407 - INFO -  step: 150  loss: -8.0000  grad_norm: 10.8999  memory:  6.43GiB(13.53%)  tps: 6,607  tflops: 51.65  mfu: 16.55%
[rank1]:2025-11-28 16:19:33,415 - INFO -  step: 150  loss: -8.0000  grad_norm: 10.8999  memory:  9.03GiB(19.01%)  tps: 6,607  tflops: 51.65  mfu: 16.55%
[rank0]:2025-11-28 16:20:22,302 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 7.5838e+00
[rank3]:2025-11-28 16:20:22,298 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.3211e+00
[rank2]:2025-11-28 16:20:22,291 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 5.0935e+00
[rank1]:2025-11-28 16:20:22,295 - INFO - Freezing Ratio: [Stage1] 0.20, Threshold: 8.7572e+00
[rank3]:2025-11-28 16:21:12,188 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 1.1095e+01
[rank0]:2025-11-28 16:21:12,184 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 4.8148e+00
[rank2]:2025-11-28 16:21:12,168 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.0627e+01
[rank1]:2025-11-28 16:21:12,177 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 6.1607e+00
[rank3]:2025-11-28 16:21:35,909 - INFO - Avg. fwd time: 13.5956 / Avg. bwd time: 41.8072 / Avg. batch time: 506.6569 (ms) / GPU bubble ratio: 12.52%
[rank0]:2025-11-28 16:21:35,934 - INFO - Avg. fwd time: 7.8455 / Avg. bwd time: 22.8118 / Avg. batch time: 610.2204 (ms) / GPU bubble ratio: 59.81%
[rank2]:2025-11-28 16:21:35,930 - INFO - Avg. fwd time: 7.5876 / Avg. bwd time: 17.5980 / Avg. batch time: 536.5486 (ms) / GPU bubble ratio: 62.45%
[rank1]:2025-11-28 16:21:35,978 - INFO - Avg. fwd time: 9.3408 / Avg. bwd time: 23.3040 / Avg. batch time: 574.2852 (ms) / GPU bubble ratio: 54.52%
[rank3]:2025-11-28 16:22:00,362 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.4560e+00
[rank2]:2025-11-28 16:22:00,343 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 4.0234e+00
[rank1]:2025-11-28 16:22:00,359 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.9144e+00
[rank0]:2025-11-28 16:22:00,367 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.7001e+00
[rank2]:2025-11-28 16:22:50,032 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.3735e+00
[rank1]:2025-11-28 16:22:50,036 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 4.3114e+00
[rank0]:2025-11-28 16:22:50,048 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 4.4296e+00
[rank3]:2025-11-28 16:22:50,052 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 3.7506e+00
[rank0]:2025-11-28 16:23:33,370 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-28 16:23:37,938 - INFO - Avg. fwd time: 7.8858 / Avg. bwd time: 22.5228 / Avg. batch time: 608.0345 (ms) / GPU bubble ratio: 59.99%
[rank3]:2025-11-28 16:23:37,913 - INFO - Avg. fwd time: 13.6197 / Avg. bwd time: 41.6627 / Avg. batch time: 505.6905 (ms) / GPU bubble ratio: 12.54%
[rank2]:2025-11-28 16:23:37,934 - INFO - Avg. fwd time: 7.6835 / Avg. bwd time: 16.9044 / Avg. batch time: 534.8561 (ms) / GPU bubble ratio: 63.22%
[rank1]:2025-11-28 16:23:37,982 - INFO - Avg. fwd time: 9.3605 / Avg. bwd time: 23.1298 / Avg. batch time: 572.4042 (ms) / GPU bubble ratio: 54.59%
[rank2]:2025-11-28 16:23:38,191 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 3.5016e+00
[rank2]:2025-11-28 16:23:38,192 - INFO -  step: 200  loss: -8.0000  grad_norm:  9.4592  memory:  6.43GiB(13.53%)  tps: 6,693  tflops: 52.33  mfu: 16.77%
[rank1]:2025-11-28 16:23:38,207 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.5385e+00
[rank1]:2025-11-28 16:23:38,207 - INFO -  step: 200  loss: -8.0000  grad_norm:  9.4592  memory:  9.03GiB(19.01%)  tps: 6,693  tflops: 52.32  mfu: 16.77%
[rank0]:2025-11-28 16:23:38,215 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 4.7952e-01
[rank0]:2025-11-28 16:23:38,215 - INFO -  step: 200  loss: -8.0000  grad_norm:  9.4592  memory: 12.97GiB(27.31%)  tps: 6,693  tflops: 52.32  mfu: 16.77%
[rank0]:2025-11-28 16:23:38,266 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p50_42_dm1/frozen_ratio_history/rank0/251128_1623_stage0_step200.svg
[rank3]:2025-11-28 16:23:38,211 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.9708e+00
[rank3]:2025-11-28 16:23:38,214 - INFO -  step: 200  loss:  1.1133  grad_norm:  9.4592  memory: 16.39GiB(34.50%)  tps: 6,693  tflops: 52.32  mfu: 16.77%
[rank2]:2025-11-28 16:23:38,272 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p50_42_dm1/frozen_ratio_history/rank2/251128_1623_stage2_step200.svg
[rank1]:2025-11-28 16:23:38,270 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p50_42_dm1/frozen_ratio_history/rank1/251128_1623_stage1_step200.svg
[rank3]:2025-11-28 16:23:38,389 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p50_42_dm1/pipeline_schedule/251128_1623_real_step200_rank3.svg
[rank3]:			> Batch Time: 584.19 ms, GPU Bubble Ratio: 59.33%, 54.52%, 72.89%, 27.55%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms                       | [S0,MB1,F]  9-8-17ms                      | [S0,MB2,F]  17-8-25ms                     | [S0,MB3,F]  25-7-33ms                     | [S0,MB0,B]  135-21-156ms                  | [S0,MB4,F]  156-7-164ms                   | [S0,MB1,B]  191-21-213ms                  | [S0,MB5,F]  213-7-220ms                   | [S0,MB2,B]  250-21-272ms                  | [S0,MB6,F]  272-7-279ms                   | [S0,MB3,B]  313-21-335ms                  | [S0,MB7,F]  335-7-342ms                   | [S0,MB4,B]  377-21-399ms                  | [S0,MB5,B]  438-21-460ms                  | [S0,MB6,B]  500-21-521ms                  | [S0,MB7,B]  562-21-584ms                 
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-10-20ms                     | [S1,MB1,F]  23-8-32ms                     | [S1,MB2,F]  35-8-44ms                     | [S1,MB0,B]  105-24-129ms                  | [S1,MB3,F]  133-8-142ms                   | [S1,MB1,B]  162-24-186ms                  | [S1,MB4,F]  189-9-198ms                   | [S1,MB2,B]  221-24-245ms                  | [S1,MB5,F]  249-8-258ms                   | [S1,MB3,B]  284-24-308ms                  | [S1,MB6,F]  311-8-320ms                   | [S1,MB4,B]  348-24-372ms                  | [S1,MB7,F]  375-8-384ms                   | [S1,MB5,B]  411-24-435ms                  | [S1,MB6,B]  472-24-496ms                  | [S1,MB7,B]  535-23-559ms                 
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms                     | [S2,MB1,F]  32-8-40ms                     | [S2,MB0,B]  89-11-100ms                   | [S2,MB2,F]  103-8-112ms                   | [S2,MB1,B]  145-11-157ms                  | [S2,MB3,F]  160-8-168ms                   | [S2,MB2,B]  204-11-216ms                  | [S2,MB4,F]  219-8-228ms                   | [S2,MB3,B]  267-11-278ms                  | [S2,MB5,F]  282-8-290ms                   | [S2,MB4,B]  331-11-343ms                  | [S2,MB6,F]  346-8-354ms                   | [S2,MB5,B]  394-11-406ms                  | [S2,MB7,F]  409-8-418ms                   | [S2,MB6,B]  458-11-469ms                  | [S2,MB7,B]  520-11-532ms                 
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms                    | [S3,MB0,B]  48-36-85ms                    | [S3,MB1,F]  87-10-98ms                    | [S3,MB1,B]  104-37-142ms                  | [S3,MB2,F]  144-12-157ms                  | [S3,MB2,B]  162-38-201ms                  | [S3,MB3,F]  203-14-217ms                  | [S3,MB3,B]  223-39-263ms                  | [S3,MB4,F]  266-14-280ms                  | [S3,MB4,B]  286-40-327ms                  | [S3,MB5,F]  330-13-344ms                  | [S3,MB5,B]  350-40-390ms                  | [S3,MB6,F]  393-14-407ms                  | [S3,MB6,B]  413-40-453ms                  | [S3,MB7,F]  456-14-470ms                  | [S3,MB7,B]  477-40-517ms                 
[rank3]:2025-11-28 16:23:38,455 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p50_42_dm1/frozen_ratio_history/rank3/251128_1623_stage3_step200.svg
[rank0]:2025-11-28 16:24:28,239 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 7.5988e-01
[rank3]:2025-11-28 16:24:28,243 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 2.7950e+00
[rank2]:2025-11-28 16:24:28,224 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.3268e+00
[rank1]:2025-11-28 16:24:28,228 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.8579e+00
[rank2]:2025-11-28 16:25:16,336 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.2579e+00
[rank1]:2025-11-28 16:25:16,352 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 5.7249e-01
[rank0]:2025-11-28 16:25:16,359 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 2.9935e+00
[rank3]:2025-11-28 16:25:16,355 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.5728e+00
[rank3]:2025-11-28 16:25:41,217 - INFO - Avg. fwd time: 13.6358 / Avg. bwd time: 41.6284 / Avg. batch time: 505.5444 (ms) / GPU bubble ratio: 12.55%
[rank2]:2025-11-28 16:25:41,239 - INFO - Avg. fwd time: 7.7488 / Avg. bwd time: 16.4358 / Avg. batch time: 534.3043 (ms) / GPU bubble ratio: 63.79%
[rank1]:2025-11-28 16:25:41,266 - INFO - Avg. fwd time: 9.3914 / Avg. bwd time: 22.8820 / Avg. batch time: 571.5973 (ms) / GPU bubble ratio: 54.83%
[rank0]:2025-11-28 16:25:41,292 - INFO - Avg. fwd time: 7.9256 / Avg. bwd time: 22.2442 / Avg. batch time: 606.9430 (ms) / GPU bubble ratio: 60.23%
[rank2]:2025-11-28 16:26:06,112 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.4351e-01
[rank1]:2025-11-28 16:26:06,116 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 8.6120e-01
[rank0]:2025-11-28 16:26:06,128 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 1.3403e+00
[rank3]:2025-11-28 16:26:06,132 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 5.9129e-01
[rank3]:2025-11-28 16:26:54,344 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 4.4171e+00
[rank2]:2025-11-28 16:26:54,325 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 5.6337e+00
[rank1]:2025-11-28 16:26:54,341 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 5.4935e+00
[rank0]:2025-11-28 16:26:54,348 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 6.6261e+00
[rank0]:2025-11-28 16:27:39,036 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-28 16:27:43,727 - INFO - Avg. fwd time: 13.6418 / Avg. bwd time: 41.5934 / Avg. batch time: 505.3098 (ms) / GPU bubble ratio: 12.55%
[rank0]:2025-11-28 16:27:43,734 - INFO - Avg. fwd time: 7.9516 / Avg. bwd time: 22.0562 / Avg. batch time: 605.9915 (ms) / GPU bubble ratio: 60.39%
[rank2]:2025-11-28 16:27:43,749 - INFO - Avg. fwd time: 7.7932 / Avg. bwd time: 16.1107 / Avg. batch time: 533.7179 (ms) / GPU bubble ratio: 64.17%
[rank1]:2025-11-28 16:27:43,779 - INFO - Avg. fwd time: 9.4093 / Avg. bwd time: 22.7193 / Avg. batch time: 570.8403 (ms) / GPU bubble ratio: 54.97%
[rank3]:2025-11-28 16:27:44,026 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 4.2373e+00
[rank2]:2025-11-28 16:27:44,006 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.9880e+00
[rank2]:2025-11-28 16:27:44,006 - INFO -  step: 250  loss: -8.0000  grad_norm:  2.0881  memory:  6.43GiB(13.53%)  tps: 6,665  tflops: 52.11  mfu: 16.70%
[rank1]:2025-11-28 16:27:44,010 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 3.1783e+00
[rank1]:2025-11-28 16:27:44,011 - INFO -  step: 250  loss: -8.0000  grad_norm:  2.0881  memory:  9.03GiB(19.01%)  tps: 6,666  tflops: 52.11  mfu: 16.70%
[rank0]:2025-11-28 16:27:44,021 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 5.2552e+00
[rank0]:2025-11-28 16:27:44,022 - INFO -  step: 250  loss: -8.0000  grad_norm:  2.0881  memory: 12.97GiB(27.31%)  tps: 6,665  tflops: 52.11  mfu: 16.70%
[rank3]:2025-11-28 16:27:44,029 - INFO -  step: 250  loss:  0.4013  grad_norm:  2.0881  memory: 16.39GiB(34.50%)  tps: 6,665  tflops: 52.11  mfu: 16.70%
[rank2]:2025-11-28 16:28:32,214 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.8247e+00
[rank1]:2025-11-28 16:28:32,230 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 2.8242e+00
[rank0]:2025-11-28 16:28:32,237 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 6.7997e-01
[rank3]:2025-11-28 16:28:32,233 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.2748e+00
[rank3]:2025-11-28 16:29:22,059 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 5.2804e+00
[rank2]:2025-11-28 16:29:22,036 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.5596e+00
[rank1]:2025-11-28 16:29:22,041 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0744e+00
[rank0]:2025-11-28 16:29:22,052 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 5.9197e+00
[rank3]:2025-11-28 16:29:45,860 - INFO - Avg. fwd time: 13.6576 / Avg. bwd time: 41.5430 / Avg. batch time: 505.0309 (ms) / GPU bubble ratio: 12.56%
[rank2]:2025-11-28 16:29:45,880 - INFO - Avg. fwd time: 7.8390 / Avg. bwd time: 15.7802 / Avg. batch time: 533.0836 (ms) / GPU bubble ratio: 64.55%
[rank1]:2025-11-28 16:29:45,928 - INFO - Avg. fwd time: 9.4234 / Avg. bwd time: 22.6046 / Avg. batch time: 570.0827 (ms) / GPU bubble ratio: 55.05%
[rank0]:2025-11-28 16:29:45,885 - INFO - Avg. fwd time: 7.9741 / Avg. bwd time: 21.8972 / Avg. batch time: 605.0688 (ms) / GPU bubble ratio: 60.51%
[rank0]:2025-11-28 16:30:10,281 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 6.4818e-01
[rank3]:2025-11-28 16:30:10,277 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 4.0510e-01
[rank2]:2025-11-28 16:30:10,258 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 4.2365e-01
[rank1]:2025-11-28 16:30:10,273 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 4.3659e-01
[rank3]:2025-11-28 16:31:00,074 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 1.3297e+00
[rank2]:2025-11-28 16:31:00,054 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.0940e+00
[rank1]:2025-11-28 16:31:00,058 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.3407e+00
[rank0]:2025-11-28 16:31:00,070 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 1.4505e+00
[rank0]:2025-11-28 16:31:43,326 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-28 16:31:48,044 - INFO - Avg. fwd time: 13.6634 / Avg. bwd time: 41.4704 / Avg. batch time: 504.4932 (ms) / GPU bubble ratio: 12.57%
[rank2]:2025-11-28 16:31:48,064 - INFO - Avg. fwd time: 7.8798 / Avg. bwd time: 15.4847 / Avg. batch time: 532.2315 (ms) / GPU bubble ratio: 64.88%
[rank2]:2025-11-28 16:31:48,138 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.9378e+00
[rank2]:2025-11-28 16:31:48,139 - INFO -  step: 300  loss: -8.0000  grad_norm:  0.4078  memory:  6.43GiB(13.53%)  tps: 6,711  tflops: 52.46  mfu: 16.82%
[rank1]:2025-11-28 16:31:48,096 - INFO - Avg. fwd time: 9.4296 / Avg. bwd time: 22.5541 / Avg. batch time: 569.1748 (ms) / GPU bubble ratio: 55.05%
[rank1]:2025-11-28 16:31:48,154 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 7.6417e-01
[rank1]:2025-11-28 16:31:48,154 - INFO -  step: 300  loss: -8.0000  grad_norm:  0.4078  memory:  9.03GiB(19.01%)  tps: 6,711  tflops: 52.46  mfu: 16.81%
[rank0]:2025-11-28 16:31:48,126 - INFO - Avg. fwd time: 7.9893 / Avg. bwd time: 21.7879 / Avg. batch time: 604.0482 (ms) / GPU bubble ratio: 60.56%
[rank0]:2025-11-28 16:31:48,161 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 8.0471e-01
[rank0]:2025-11-28 16:31:48,162 - INFO -  step: 300  loss: -8.0000  grad_norm:  0.4078  memory: 12.97GiB(27.31%)  tps: 6,711  tflops: 52.46  mfu: 16.82%
[rank0]:2025-11-28 16:31:48,211 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p50_42_dm1/frozen_ratio_history/rank0/251128_1631_stage0_step300.svg
[rank3]:2025-11-28 16:31:48,157 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.8869e+00
[rank3]:2025-11-28 16:31:48,161 - INFO -  step: 300  loss:  0.2868  grad_norm:  0.4078  memory: 16.39GiB(34.50%)  tps: 6,711  tflops: 52.46  mfu: 16.82%
[rank2]:2025-11-28 16:31:48,215 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p50_42_dm1/frozen_ratio_history/rank2/251128_1631_stage2_step300.svg
[rank1]:2025-11-28 16:31:48,215 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p50_42_dm1/frozen_ratio_history/rank1/251128_1631_stage1_step300.svg
[rank3]:2025-11-28 16:31:48,300 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p50_42_dm1/pipeline_schedule/251128_1631_real_step300_rank3.svg
[rank3]:			> Batch Time: 587.20 ms, GPU Bubble Ratio: 59.43%, 54.66%, 72.94%, 27.81%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms                       | [S0,MB1,F]  9-8-17ms                      | [S0,MB2,F]  17-8-26ms                     | [S0,MB3,F]  26-7-33ms                     | [S0,MB0,B]  135-21-157ms                  | [S0,MB4,F]  157-7-164ms                   | [S0,MB1,B]  192-21-213ms                  | [S0,MB5,F]  214-7-221ms                   | [S0,MB2,B]  252-21-274ms                  | [S0,MB6,F]  274-7-281ms                   | [S0,MB3,B]  315-21-336ms                  | [S0,MB7,F]  336-7-344ms                   | [S0,MB4,B]  379-21-400ms                  | [S0,MB5,B]  440-21-462ms                  | [S0,MB6,B]  502-21-523ms                  | [S0,MB7,B]  565-21-587ms                 
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms                     | [S1,MB1,F]  23-8-32ms                     | [S1,MB2,F]  35-8-44ms                     | [S1,MB0,B]  105-24-130ms                  | [S1,MB3,F]  133-8-142ms                   | [S1,MB1,B]  162-24-187ms                  | [S1,MB4,F]  190-9-199ms                   | [S1,MB2,B]  222-24-246ms                  | [S1,MB5,F]  250-9-259ms                   | [S1,MB3,B]  285-24-309ms                  | [S1,MB6,F]  313-8-322ms                   | [S1,MB4,B]  349-24-373ms                  | [S1,MB7,F]  377-8-386ms                   | [S1,MB5,B]  413-24-437ms                  | [S1,MB6,B]  474-24-498ms                  | [S1,MB7,B]  538-23-562ms                 
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms                     | [S2,MB1,F]  32-8-41ms                     | [S2,MB0,B]  89-11-100ms                   | [S2,MB2,F]  104-8-112ms                   | [S2,MB1,B]  146-11-157ms                  | [S2,MB3,F]  161-8-169ms                   | [S2,MB2,B]  206-11-217ms                  | [S2,MB4,F]  221-8-229ms                   | [S2,MB3,B]  268-11-280ms                  | [S2,MB5,F]  283-8-292ms                   | [S2,MB4,B]  333-11-344ms                  | [S2,MB6,F]  348-8-356ms                   | [S2,MB5,B]  396-11-408ms                  | [S2,MB7,F]  411-8-419ms                   | [S2,MB6,B]  459-11-471ms                  | [S2,MB7,B]  523-11-534ms                 
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms                    | [S3,MB0,B]  48-36-85ms                    | [S3,MB1,F]  87-11-99ms                    | [S3,MB1,B]  104-37-142ms                  | [S3,MB2,F]  144-12-157ms                  | [S3,MB2,B]  163-38-202ms                  | [S3,MB3,F]  204-14-219ms                  | [S3,MB3,B]  224-39-264ms                  | [S3,MB4,F]  267-14-281ms                  | [S3,MB4,B]  287-40-328ms                  | [S3,MB5,F]  331-13-345ms                  | [S3,MB5,B]  351-40-392ms                  | [S3,MB6,F]  395-13-408ms                  | [S3,MB6,B]  415-40-456ms                  | [S3,MB7,F]  458-14-472ms                  | [S3,MB7,B]  479-40-519ms                 
[rank3]:2025-11-28 16:31:48,344 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p50_42_dm1/frozen_ratio_history/rank3/251128_1631_stage3_step300.svg
[rank3]:2025-11-28 16:32:37,984 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 3.8700e-01
[rank2]:2025-11-28 16:32:37,965 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.0134e-01
[rank1]:2025-11-28 16:32:37,968 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.9011e-01
[rank0]:2025-11-28 16:32:37,980 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 5.2632e-01
[rank3]:2025-11-28 16:33:26,275 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.8957e+00
[rank2]:2025-11-28 16:33:26,255 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.4235e+00
[rank1]:2025-11-28 16:33:26,271 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.3782e+00
[rank0]:2025-11-28 16:33:26,279 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.3565e+00
[rank0]:2025-11-28 16:33:50,850 - INFO - Avg. fwd time: 8.0057 / Avg. bwd time: 21.6759 / Avg. batch time: 603.6265 (ms) / GPU bubble ratio: 60.66%
[rank3]:2025-11-28 16:33:50,842 - INFO - Avg. fwd time: 13.6677 / Avg. bwd time: 41.4610 / Avg. batch time: 504.4491 (ms) / GPU bubble ratio: 12.57%
[rank2]:2025-11-28 16:33:50,865 - INFO - Avg. fwd time: 7.9053 / Avg. bwd time: 15.3029 / Avg. batch time: 532.0304 (ms) / GPU bubble ratio: 65.10%
[rank1]:2025-11-28 16:33:50,893 - INFO - Avg. fwd time: 9.4414 / Avg. bwd time: 22.4526 / Avg. batch time: 568.8684 (ms) / GPU bubble ratio: 55.15%
[rank2]:2025-11-28 16:34:16,023 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.3941e+00
[rank3]:2025-11-28 16:34:16,042 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 3.6481e+00
[rank1]:2025-11-28 16:34:16,027 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.4031e+00
[rank0]:2025-11-28 16:34:16,038 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 2.1249e+00
[rank2]:2025-11-28 16:35:04,269 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.8395e+00
[rank3]:2025-11-28 16:35:04,288 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.2561e+00
[rank1]:2025-11-28 16:35:04,285 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.2068e+00
[rank0]:2025-11-28 16:35:04,292 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.2954e+00
[rank0]:2025-11-28 16:35:48,994 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-28 16:35:53,683 - INFO - Avg. fwd time: 13.6703 / Avg. bwd time: 41.4639 / Avg. batch time: 504.4927 (ms) / GPU bubble ratio: 12.57%
[rank0]:2025-11-28 16:35:53,692 - INFO - Avg. fwd time: 8.0231 / Avg. bwd time: 21.5514 / Avg. batch time: 603.2243 (ms) / GPU bubble ratio: 60.78%
[rank2]:2025-11-28 16:35:53,706 - INFO - Avg. fwd time: 7.9288 / Avg. bwd time: 15.1333 / Avg. batch time: 531.8865 (ms) / GPU bubble ratio: 65.31%
[rank1]:2025-11-28 16:35:53,734 - INFO - Avg. fwd time: 9.4577 / Avg. bwd time: 22.3259 / Avg. batch time: 568.5940 (ms) / GPU bubble ratio: 55.28%
[rank2]:2025-11-28 16:35:53,961 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.4544e-01
[rank2]:2025-11-28 16:35:53,962 - INFO -  step: 350  loss: -8.0000  grad_norm:  0.1377  memory:  6.43GiB(13.53%)  tps: 6,665  tflops: 52.10  mfu: 16.70%
[rank3]:2025-11-28 16:35:53,981 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 6.8459e-01
[rank3]:2025-11-28 16:35:53,984 - INFO -  step: 350  loss:  0.2345  grad_norm:  0.1377  memory: 16.39GiB(34.50%)  tps: 6,665  tflops: 52.10  mfu: 16.70%
[rank0]:2025-11-28 16:35:53,977 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 2.3804e+00
[rank0]:2025-11-28 16:35:53,977 - INFO -  step: 350  loss: -8.0000  grad_norm:  0.1377  memory: 12.97GiB(27.31%)  tps: 6,665  tflops: 52.11  mfu: 16.70%
[rank1]:2025-11-28 16:35:53,965 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 7.6924e-01
[rank1]:2025-11-28 16:35:53,965 - INFO -  step: 350  loss: -8.0000  grad_norm:  0.1377  memory:  9.03GiB(19.01%)  tps: 6,665  tflops: 52.11  mfu: 16.70%
[rank2]:2025-11-28 16:36:42,269 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.5570e+00
[rank3]:2025-11-28 16:36:42,288 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.9112e+00
[rank0]:2025-11-28 16:36:42,292 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 4.1535e+00
[rank1]:2025-11-28 16:36:42,285 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 2.4643e+00
[rank2]:2025-11-28 16:37:32,011 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.5738e-01
[rank1]:2025-11-28 16:37:32,015 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 7.1673e-01
[rank0]:2025-11-28 16:37:32,027 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 1.3392e+00
[rank3]:2025-11-28 16:37:32,031 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 5.2519e-01
[rank2]:2025-11-28 16:37:55,994 - INFO - Avg. fwd time: 7.9544 / Avg. bwd time: 14.9512 / Avg. batch time: 531.4042 (ms) / GPU bubble ratio: 65.52%
[rank3]:2025-11-28 16:37:55,974 - INFO - Avg. fwd time: 13.6769 / Avg. bwd time: 41.4217 / Avg. batch time: 504.2066 (ms) / GPU bubble ratio: 12.58%
[rank1]:2025-11-28 16:37:56,027 - INFO - Avg. fwd time: 9.4613 / Avg. bwd time: 22.2862 / Avg. batch time: 568.0697 (ms) / GPU bubble ratio: 55.29%
[rank0]:2025-11-28 16:37:56,058 - INFO - Avg. fwd time: 8.0340 / Avg. bwd time: 21.4791 / Avg. batch time: 602.6272 (ms) / GPU bubble ratio: 60.82%
[rank2]:2025-11-28 16:38:20,212 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 7.1754e-01
[rank3]:2025-11-28 16:38:20,232 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 8.4781e-01
[rank1]:2025-11-28 16:38:20,229 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 5.8274e-01
[rank0]:2025-11-28 16:38:20,236 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 6.6098e-01
[rank2]:2025-11-28 16:39:09,885 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.1217e-01
[rank3]:2025-11-28 16:39:09,905 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 8.8692e-01
[rank1]:2025-11-28 16:39:09,889 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 8.8289e-01
[rank0]:2025-11-28 16:39:09,901 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 9.9899e-01
[rank0]:2025-11-28 16:39:53,247 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-28 16:39:57,792 - INFO - Avg. fwd time: 13.6801 / Avg. bwd time: 41.3922 / Avg. batch time: 503.9944 (ms) / GPU bubble ratio: 12.58%
[rank0]:2025-11-28 16:39:57,821 - INFO - Avg. fwd time: 8.0421 / Avg. bwd time: 21.4223 / Avg. batch time: 602.1745 (ms) / GPU bubble ratio: 60.86%
[rank2]:2025-11-28 16:39:57,816 - INFO - Avg. fwd time: 7.9733 / Avg. bwd time: 14.8167 / Avg. batch time: 531.0466 (ms) / GPU bubble ratio: 65.67%
[rank1]:2025-11-28 16:39:57,864 - INFO - Avg. fwd time: 9.4662 / Avg. bwd time: 22.2524 / Avg. batch time: 567.6753 (ms) / GPU bubble ratio: 55.30%
[rank3]:2025-11-28 16:39:58,081 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.5557e-01
[rank3]:2025-11-28 16:39:58,084 - INFO -  step: 400  loss:  0.2218  grad_norm:  0.7242  memory: 16.39GiB(34.50%)  tps: 6,712  tflops: 52.47  mfu: 16.82%
[rank2]:2025-11-28 16:39:58,061 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 5.3184e-01
[rank2]:2025-11-28 16:39:58,062 - INFO -  step: 400  loss: -8.0000  grad_norm:  0.7242  memory:  6.43GiB(13.53%)  tps: 6,712  tflops: 52.47  mfu: 16.82%
[rank1]:2025-11-28 16:39:58,077 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 2.9938e-01
[rank1]:2025-11-28 16:39:58,078 - INFO -  step: 400  loss: -8.0000  grad_norm:  0.7242  memory:  9.03GiB(19.01%)  tps: 6,712  tflops: 52.47  mfu: 16.82%
[rank0]:2025-11-28 16:39:58,085 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.0276e+00
[rank0]:2025-11-28 16:39:58,085 - INFO -  step: 400  loss: -8.0000  grad_norm:  0.7242  memory: 12.97GiB(27.31%)  tps: 6,712  tflops: 52.47  mfu: 16.82%
[rank0]:2025-11-28 16:39:58,137 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p50_42_dm1/frozen_ratio_history/rank0/251128_1639_stage0_step400.svg
[rank2]:2025-11-28 16:39:58,142 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p50_42_dm1/frozen_ratio_history/rank2/251128_1639_stage2_step400.svg
[rank1]:2025-11-28 16:39:58,144 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p50_42_dm1/frozen_ratio_history/rank1/251128_1639_stage1_step400.svg
[rank3]:2025-11-28 16:39:58,227 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p50_42_dm1/pipeline_schedule/251128_1639_real_step400_rank3.svg
[rank3]:			> Batch Time: 585.19 ms, GPU Bubble Ratio: 59.35%, 54.47%, 72.88%, 27.37%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms                       | [S0,MB1,F]  9-8-17ms                      | [S0,MB2,F]  17-8-25ms                     | [S0,MB3,F]  25-7-33ms                     | [S0,MB0,B]  135-21-156ms                  | [S0,MB4,F]  156-7-164ms                   | [S0,MB1,B]  191-21-213ms                  | [S0,MB5,F]  213-7-221ms                   | [S0,MB2,B]  252-21-274ms                  | [S0,MB6,F]  274-7-282ms                   | [S0,MB3,B]  315-21-336ms                  | [S0,MB7,F]  336-7-344ms                   | [S0,MB4,B]  379-21-400ms                  | [S0,MB5,B]  440-21-462ms                  | [S0,MB6,B]  501-21-523ms                  | [S0,MB7,B]  563-21-585ms                 
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-10-20ms                     | [S1,MB1,F]  23-8-32ms                     | [S1,MB2,F]  35-8-44ms                     | [S1,MB0,B]  105-24-130ms                  | [S1,MB3,F]  133-8-142ms                   | [S1,MB1,B]  162-24-186ms                  | [S1,MB4,F]  190-9-199ms                   | [S1,MB2,B]  223-24-247ms                  | [S1,MB5,F]  251-9-260ms                   | [S1,MB3,B]  285-24-309ms                  | [S1,MB6,F]  313-8-321ms                   | [S1,MB4,B]  349-24-373ms                  | [S1,MB7,F]  377-8-386ms                   | [S1,MB5,B]  413-24-437ms                  | [S1,MB6,B]  474-24-498ms                  | [S1,MB7,B]  536-23-559ms                 
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms                     | [S2,MB1,F]  32-8-40ms                     | [S2,MB0,B]  89-11-100ms                   | [S2,MB2,F]  104-8-112ms                   | [S2,MB1,B]  146-11-157ms                  | [S2,MB3,F]  161-8-169ms                   | [S2,MB2,B]  206-11-217ms                  | [S2,MB4,F]  221-8-230ms                   | [S2,MB3,B]  269-11-280ms                  | [S2,MB5,F]  284-8-292ms                   | [S2,MB4,B]  333-11-344ms                  | [S2,MB6,F]  348-8-356ms                   | [S2,MB5,B]  396-11-408ms                  | [S2,MB7,F]  411-8-420ms                   | [S2,MB6,B]  459-11-470ms                  | [S2,MB7,B]  521-11-532ms                 
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms                    | [S3,MB0,B]  48-36-85ms                    | [S3,MB1,F]  87-11-98ms                    | [S3,MB1,B]  104-37-142ms                  | [S3,MB2,F]  144-13-158ms                  | [S3,MB2,B]  163-38-202ms                  | [S3,MB3,F]  205-14-220ms                  | [S3,MB3,B]  225-39-264ms                  | [S3,MB4,F]  267-14-281ms                  | [S3,MB4,B]  288-41-329ms                  | [S3,MB5,F]  331-14-345ms                  | [S3,MB5,B]  351-40-392ms                  | [S3,MB6,F]  395-13-409ms                  | [S3,MB6,B]  414-40-455ms                  | [S3,MB7,F]  458-14-472ms                  | [S3,MB7,B]  477-40-517ms                 
[rank3]:2025-11-28 16:39:58,276 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p50_42_dm1/frozen_ratio_history/rank3/251128_1639_stage3_step400.svg
[rank3]:2025-11-28 16:40:26,497 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-11-28 16:40:26,715 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-11-28 16:40:26,737 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-11-28 16:40:26,758 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-11-28 16:40:47,879 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 6.1941e-01
[rank1]:2025-11-28 16:40:47,883 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 7.3513e-01
[rank0]:2025-11-28 16:40:47,894 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 1.0045e+00
[rank3]:2025-11-28 16:40:47,899 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 1.5351e+00
[rank2]:2025-11-28 16:41:35,906 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 4.6298e-01
[rank3]:2025-11-28 16:41:35,926 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 3.6993e-01
[rank1]:2025-11-28 16:41:35,922 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 4.7054e-01
[rank0]:2025-11-28 16:41:35,930 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 8.2110e-01
[rank2]:2025-11-28 16:42:00,572 - INFO - Avg. fwd time: 7.9908 / Avg. bwd time: 14.6902 / Avg. batch time: 530.8327 (ms) / GPU bubble ratio: 65.82%
[rank3]:2025-11-28 16:42:00,548 - INFO - Avg. fwd time: 13.6826 / Avg. bwd time: 41.3767 / Avg. batch time: 503.8882 (ms) / GPU bubble ratio: 12.58%
[rank1]:2025-11-28 16:42:00,600 - INFO - Avg. fwd time: 9.4742 / Avg. bwd time: 22.1908 / Avg. batch time: 567.3963 (ms) / GPU bubble ratio: 55.35%
[rank0]:2025-11-28 16:42:00,555 - INFO - Avg. fwd time: 8.0525 / Avg. bwd time: 21.3505 / Avg. batch time: 601.8215 (ms) / GPU bubble ratio: 60.91%
[rank2]:2025-11-28 16:42:25,501 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 7.5436e-01
[rank1]:2025-11-28 16:42:25,505 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.2989e+00
[rank0]:2025-11-28 16:42:25,517 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 7.7614e-01
[rank3]:2025-11-28 16:42:25,521 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 1.1175e+00
[rank0]:2025-11-28 16:43:13,713 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 2.6090e+00
[rank2]:2025-11-28 16:43:13,689 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.4856e+00
[rank3]:2025-11-28 16:43:13,709 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.7010e+00
[rank1]:2025-11-28 16:43:13,705 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 2.0566e+00
[rank0]:2025-11-28 16:43:58,366 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-28 16:44:03,244 - INFO - Avg. fwd time: 13.6843 / Avg. bwd time: 41.3774 / Avg. batch time: 503.9066 (ms) / GPU bubble ratio: 12.58%
[rank2]:2025-11-28 16:44:03,268 - INFO - Avg. fwd time: 8.0039 / Avg. bwd time: 14.5935 / Avg. batch time: 530.7427 (ms) / GPU bubble ratio: 65.94%
[rank2]:2025-11-28 16:44:03,340 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.5931e+00
[rank2]:2025-11-28 16:44:03,340 - INFO -  step: 450  loss: -8.0000  grad_norm:  0.1077  memory:  6.43GiB(13.53%)  tps: 6,680  tflops: 52.22  mfu: 16.74%
[rank1]:2025-11-28 16:44:03,296 - INFO - Avg. fwd time: 9.4848 / Avg. bwd time: 22.1068 / Avg. batch time: 567.2208 (ms) / GPU bubble ratio: 55.44%
[rank1]:2025-11-28 16:44:03,344 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 3.9729e+00
[rank1]:2025-11-28 16:44:03,344 - INFO -  step: 450  loss: -8.0000  grad_norm:  0.1077  memory:  9.03GiB(19.01%)  tps: 6,680  tflops: 52.22  mfu: 16.74%
[rank0]:2025-11-28 16:44:03,325 - INFO - Avg. fwd time: 8.0630 / Avg. bwd time: 21.2723 / Avg. batch time: 601.5659 (ms) / GPU bubble ratio: 60.99%
[rank0]:2025-11-28 16:44:03,356 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 5.5089e+00
[rank0]:2025-11-28 16:44:03,356 - INFO -  step: 450  loss: -8.0000  grad_norm:  0.1077  memory: 12.97GiB(27.31%)  tps: 6,680  tflops: 52.22  mfu: 16.74%
[rank3]:2025-11-28 16:44:03,360 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 3.5373e+00
[rank3]:2025-11-28 16:44:03,363 - INFO -  step: 450  loss:  0.2344  grad_norm:  0.1077  memory: 16.39GiB(34.50%)  tps: 6,680  tflops: 52.22  mfu: 16.74%
[rank2]:2025-11-28 16:44:51,410 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 3.8960e-01
[rank1]:2025-11-28 16:44:51,426 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 3.3681e-01
[rank0]:2025-11-28 16:44:51,433 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 8.7517e-01
[rank3]:2025-11-28 16:44:51,429 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 6.5178e-01
[rank2]:2025-11-28 16:45:41,062 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.7745e+00
[rank1]:2025-11-28 16:45:41,066 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.2795e+00
[rank0]:2025-11-28 16:45:41,078 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 1.9335e+00
[rank3]:2025-11-28 16:45:41,081 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 3.5574e+00
[rank3]:2025-11-28 16:46:04,962 - INFO - Avg. fwd time: 13.6852 / Avg. bwd time: 41.3530 / Avg. batch time: 503.7184 (ms) / GPU bubble ratio: 12.59%
[rank2]:2025-11-28 16:46:04,984 - INFO - Avg. fwd time: 8.0174 / Avg. bwd time: 14.4965 / Avg. batch time: 530.4477 (ms) / GPU bubble ratio: 66.05%
[rank0]:2025-11-28 16:46:04,986 - INFO - Avg. fwd time: 8.0686 / Avg. bwd time: 21.2336 / Avg. batch time: 601.2078 (ms) / GPU bubble ratio: 61.01%
[rank1]:2025-11-28 16:46:05,031 - INFO - Avg. fwd time: 9.4869 / Avg. bwd time: 22.0857 / Avg. batch time: 566.9019 (ms) / GPU bubble ratio: 55.45%
[rank2]:2025-11-28 16:46:29,327 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.5173e+00
[rank1]:2025-11-28 16:46:29,343 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.3878e+00
[rank0]:2025-11-28 16:46:29,350 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.2188e+00
[rank3]:2025-11-28 16:46:29,346 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.5330e+00
[rank3]:2025-11-28 16:47:19,076 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 2.8790e+00
[rank2]:2025-11-28 16:47:19,056 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.6308e+00
[rank1]:2025-11-28 16:47:19,060 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.5583e+00
[rank0]:2025-11-28 16:47:19,072 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 2.8715e+00
[rank0]:2025-11-28 16:48:02,449 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-28 16:48:06,960 - INFO - Avg. fwd time: 13.6888 / Avg. bwd time: 41.3169 / Avg. batch time: 503.4577 (ms) / GPU bubble ratio: 12.60%
[rank0]:2025-11-28 16:48:06,983 - INFO - Avg. fwd time: 8.0730 / Avg. bwd time: 21.2019 / Avg. batch time: 600.7868 (ms) / GPU bubble ratio: 61.02%
[rank2]:2025-11-28 16:48:06,979 - INFO - Avg. fwd time: 8.0327 / Avg. bwd time: 14.3858 / Avg. batch time: 530.0660 (ms) / GPU bubble ratio: 66.16%
[rank1]:2025-11-28 16:48:07,028 - INFO - Avg. fwd time: 9.4874 / Avg. bwd time: 22.0816 / Avg. batch time: 566.5131 (ms) / GPU bubble ratio: 55.42%
[rank3]:2025-11-28 16:48:07,248 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 4.9107e+00
[rank3]:2025-11-28 16:48:07,252 - INFO -  step: 500  loss:  0.2284  grad_norm:  0.4774  memory: 16.39GiB(34.50%)  tps: 6,718  tflops: 52.52  mfu: 16.83%
[rank2]:2025-11-28 16:48:07,229 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 5.2404e+00
[rank2]:2025-11-28 16:48:07,230 - INFO -  step: 500  loss: -8.0000  grad_norm:  0.4774  memory:  6.43GiB(13.53%)  tps: 6,718  tflops: 52.52  mfu: 16.83%
[rank1]:2025-11-28 16:48:07,246 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 4.4203e+00
[rank1]:2025-11-28 16:48:07,246 - INFO -  step: 500  loss: -8.0000  grad_norm:  0.4774  memory:  9.03GiB(19.01%)  tps: 6,717  tflops: 52.51  mfu: 16.83%
[rank0]:2025-11-28 16:48:07,253 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 3.9874e+00
[rank0]:2025-11-28 16:48:07,253 - INFO -  step: 500  loss: -8.0000  grad_norm:  0.4774  memory: 12.97GiB(27.31%)  tps: 6,718  tflops: 52.52  mfu: 16.83%
[rank0]:2025-11-28 16:48:07,301 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p50_42_dm1/frozen_ratio_history/rank0/251128_1648_stage0_step500.svg
[rank2]:2025-11-28 16:48:07,305 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p50_42_dm1/frozen_ratio_history/rank2/251128_1648_stage2_step500.svg
[rank1]:2025-11-28 16:48:07,309 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p50_42_dm1/frozen_ratio_history/rank1/251128_1648_stage1_step500.svg
[rank3]:2025-11-28 16:48:07,391 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p50_42_dm1/pipeline_schedule/251128_1648_real_step500_rank3.svg
[rank3]:			> Batch Time: 587.17 ms, GPU Bubble Ratio: 59.42%, 54.66%, 72.93%, 27.52%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms                       | [S0,MB1,F]  9-8-17ms                      | [S0,MB2,F]  17-8-26ms                     | [S0,MB3,F]  26-7-34ms                     | [S0,MB0,B]  135-21-157ms                  | [S0,MB4,F]  157-7-164ms                   | [S0,MB1,B]  192-21-214ms                  | [S0,MB5,F]  214-7-221ms                   | [S0,MB2,B]  252-21-273ms                  | [S0,MB6,F]  273-7-281ms                   | [S0,MB3,B]  315-21-336ms                  | [S0,MB7,F]  336-7-344ms                   | [S0,MB4,B]  379-21-400ms                  | [S0,MB5,B]  441-21-462ms                  | [S0,MB6,B]  502-21-523ms                  | [S0,MB7,B]  565-21-587ms                 
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms                     | [S1,MB1,F]  23-8-32ms                     | [S1,MB2,F]  35-8-44ms                     | [S1,MB0,B]  106-24-130ms                  | [S1,MB3,F]  133-8-142ms                   | [S1,MB1,B]  163-24-187ms                  | [S1,MB4,F]  190-9-199ms                   | [S1,MB2,B]  222-24-246ms                  | [S1,MB5,F]  250-9-259ms                   | [S1,MB3,B]  285-24-309ms                  | [S1,MB6,F]  313-8-322ms                   | [S1,MB4,B]  349-24-373ms                  | [S1,MB7,F]  377-9-386ms                   | [S1,MB5,B]  413-24-437ms                  | [S1,MB6,B]  475-24-499ms                  | [S1,MB7,B]  538-23-562ms                 
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms                     | [S2,MB1,F]  32-8-41ms                     | [S2,MB0,B]  89-11-101ms                   | [S2,MB2,F]  104-8-112ms                   | [S2,MB1,B]  146-11-158ms                  | [S2,MB3,F]  161-8-169ms                   | [S2,MB2,B]  206-11-217ms                  | [S2,MB4,F]  221-8-229ms                   | [S2,MB3,B]  269-11-280ms                  | [S2,MB5,F]  283-8-292ms                   | [S2,MB4,B]  333-11-344ms                  | [S2,MB6,F]  348-8-356ms                   | [S2,MB5,B]  397-11-408ms                  | [S2,MB7,F]  411-8-420ms                   | [S2,MB6,B]  460-11-471ms                  | [S2,MB7,B]  523-11-534ms                 
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-43ms                    | [S3,MB0,B]  48-36-85ms                    | [S3,MB1,F]  88-11-99ms                    | [S3,MB1,B]  105-37-142ms                  | [S3,MB2,F]  145-12-158ms                  | [S3,MB2,B]  163-38-202ms                  | [S3,MB3,F]  204-14-219ms                  | [S3,MB3,B]  225-40-265ms                  | [S3,MB4,F]  267-14-281ms                  | [S3,MB4,B]  288-40-329ms                  | [S3,MB5,F]  331-14-345ms                  | [S3,MB5,B]  351-40-392ms                  | [S3,MB6,F]  395-14-409ms                  | [S3,MB6,B]  416-40-456ms                  | [S3,MB7,F]  459-14-473ms                  | [S3,MB7,B]  479-40-520ms                 
[rank3]:2025-11-28 16:48:07,438 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p50_42_dm1/frozen_ratio_history/rank3/251128_1648_stage3_step500.svg
[rank1]:2025-11-28 16:48:57,247 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 3.9241e-01
[rank0]:2025-11-28 16:48:57,259 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 1.0478e+00
[rank3]:2025-11-28 16:48:57,262 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 3.4555e-01
[rank2]:2025-11-28 16:48:57,243 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.1890e-01
[rank3]:2025-11-28 16:49:45,544 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.9583e+00
[rank2]:2025-11-28 16:49:45,525 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.1610e+00
[rank1]:2025-11-28 16:49:45,541 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 2.5177e+00
[rank0]:2025-11-28 16:49:45,549 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.7687e+00
[rank2]:2025-11-28 16:50:10,384 - INFO - Avg. fwd time: 8.0428 / Avg. bwd time: 14.3115 / Avg. batch time: 530.0765 (ms) / GPU bubble ratio: 66.26%
[rank3]:2025-11-28 16:50:10,359 - INFO - Avg. fwd time: 13.6956 / Avg. bwd time: 41.3185 / Avg. batch time: 503.5248 (ms) / GPU bubble ratio: 12.59%
[rank1]:2025-11-28 16:50:10,417 - INFO - Avg. fwd time: 9.4934 / Avg. bwd time: 22.0272 / Avg. batch time: 566.4684 (ms) / GPU bubble ratio: 55.48%
[rank0]:2025-11-28 16:50:10,447 - INFO - Avg. fwd time: 8.0801 / Avg. bwd time: 21.1482 / Avg. batch time: 600.6890 (ms) / GPU bubble ratio: 61.07%
[rank2]:2025-11-28 16:50:35,376 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.3783e+00
[rank3]:2025-11-28 16:50:35,396 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 2.6945e+00
[rank1]:2025-11-28 16:50:35,380 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 3.7339e+00
[rank0]:2025-11-28 16:50:35,392 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 3.1014e+00
[rank2]:2025-11-28 16:51:23,563 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.3891e+00
[rank1]:2025-11-28 16:51:23,579 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.0016e+00
[rank3]:2025-11-28 16:51:23,583 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.3313e+00
[rank0]:2025-11-28 16:51:23,587 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.3870e+00
[rank0]:2025-11-28 16:52:08,420 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-28 16:52:13,126 - INFO - Avg. fwd time: 13.7008 / Avg. bwd time: 41.3169 / Avg. batch time: 503.5538 (ms) / GPU bubble ratio: 12.59%
[rank1]:2025-11-28 16:52:13,177 - INFO - Avg. fwd time: 9.4977 / Avg. bwd time: 21.9879 / Avg. batch time: 566.3878 (ms) / GPU bubble ratio: 55.53%
[rank2]:2025-11-28 16:52:13,150 - INFO - Avg. fwd time: 8.0511 / Avg. bwd time: 14.2517 / Avg. batch time: 530.0371 (ms) / GPU bubble ratio: 66.34%
[rank0]:2025-11-28 16:52:13,134 - INFO - Avg. fwd time: 8.0856 / Avg. bwd time: 21.1079 / Avg. batch time: 600.5668 (ms) / GPU bubble ratio: 61.11%
[rank2]:2025-11-28 16:52:13,400 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.7413e-01
[rank2]:2025-11-28 16:52:13,400 - INFO -  step: 550  loss: -8.0000  grad_norm:  0.1092  memory:  6.43GiB(13.53%)  tps: 6,656  tflops: 52.03  mfu: 16.68%
[rank3]:2025-11-28 16:52:13,419 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 5.0084e-01
[rank3]:2025-11-28 16:52:13,423 - INFO -  step: 550  loss:  0.2348  grad_norm:  0.1092  memory: 16.39GiB(34.50%)  tps: 6,656  tflops: 52.03  mfu: 16.68%
[rank1]:2025-11-28 16:52:13,403 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 4.6718e-01
[rank1]:2025-11-28 16:52:13,404 - INFO -  step: 550  loss: -8.0000  grad_norm:  0.1092  memory:  9.03GiB(19.01%)  tps: 6,656  tflops: 52.03  mfu: 16.68%
[rank0]:2025-11-28 16:52:13,415 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 5.2353e-01
[rank0]:2025-11-28 16:52:13,416 - INFO -  step: 550  loss: -8.0000  grad_norm:  0.1092  memory: 12.97GiB(27.31%)  tps: 6,656  tflops: 52.03  mfu: 16.68%
[rank3]:2025-11-28 16:53:01,689 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.6458e+00
[rank1]:2025-11-28 16:53:01,686 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.0157e+00
[rank2]:2025-11-28 16:53:01,670 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.7717e+00
[rank0]:2025-11-28 16:53:01,693 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 2.0383e+00
[rank3]:2025-11-28 16:53:51,498 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 6.1945e-01
[rank2]:2025-11-28 16:53:51,479 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.6602e-01
[rank1]:2025-11-28 16:53:51,483 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.2100e-01
[rank0]:2025-11-28 16:53:51,494 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 5.8552e-01
[rank3]:2025-11-28 16:54:15,218 - INFO - Avg. fwd time: 13.7046 / Avg. bwd time: 41.3023 / Avg. batch time: 503.4667 (ms) / GPU bubble ratio: 12.59%
[rank2]:2025-11-28 16:54:15,240 - INFO - Avg. fwd time: 8.0613 / Avg. bwd time: 14.1780 / Avg. batch time: 529.8678 (ms) / GPU bubble ratio: 66.42%
[rank0]:2025-11-28 16:54:15,242 - INFO - Avg. fwd time: 8.0902 / Avg. bwd time: 21.0744 / Avg. batch time: 600.3400 (ms) / GPU bubble ratio: 61.14%
[rank1]:2025-11-28 16:54:15,287 - INFO - Avg. fwd time: 9.4993 / Avg. bwd time: 21.9653 / Avg. batch time: 566.1948 (ms) / GPU bubble ratio: 55.54%
[rank2]:2025-11-28 16:54:39,571 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.1526e+00
[rank0]:2025-11-28 16:54:39,594 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.9565e+00
[rank3]:2025-11-28 16:54:39,590 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.3781e+00
[rank1]:2025-11-28 16:54:39,587 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 9.1643e-01
[rank1]:2025-11-28 16:55:29,347 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.3677e+00
[rank2]:2025-11-28 16:55:29,343 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 6.8402e-01
[rank0]:2025-11-28 16:55:29,359 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 3.5581e+00
[rank3]:2025-11-28 16:55:29,363 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 1.0125e+00
[rank0]:2025-11-28 16:56:12,669 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-28 16:56:17,506 - INFO - Avg. fwd time: 9.4989 / Avg. bwd time: 21.9668 / Avg. batch time: 565.9241 (ms) / GPU bubble ratio: 55.52%
[rank2]:2025-11-28 16:56:17,471 - INFO - Avg. fwd time: 8.0725 / Avg. bwd time: 14.0995 / Avg. batch time: 529.5966 (ms) / GPU bubble ratio: 66.51%
[rank3]:2025-11-28 16:56:17,448 - INFO - Avg. fwd time: 13.7086 / Avg. bwd time: 41.2752 / Avg. batch time: 503.2801 (ms) / GPU bubble ratio: 12.60%
[rank0]:2025-11-28 16:56:17,539 - INFO - Avg. fwd time: 8.0933 / Avg. bwd time: 21.0551 / Avg. batch time: 600.0510 (ms) / GPU bubble ratio: 61.14%
[rank1]:2025-11-28 16:56:17,566 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 2.5942e-01
[rank1]:2025-11-28 16:56:17,567 - INFO -  step: 600  loss: -8.0000  grad_norm:  0.7523  memory:  9.03GiB(19.01%)  tps: 6,710  tflops: 52.46  mfu: 16.81%
[rank2]:2025-11-28 16:56:17,551 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 9.2450e-01
[rank2]:2025-11-28 16:56:17,551 - INFO -  step: 600  loss: -8.0000  grad_norm:  0.7523  memory:  6.43GiB(13.53%)  tps: 6,711  tflops: 52.46  mfu: 16.81%
[rank3]:2025-11-28 16:56:17,570 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.1121e+00
[rank3]:2025-11-28 16:56:17,573 - INFO -  step: 600  loss:  0.2306  grad_norm:  0.7523  memory: 16.39GiB(34.50%)  tps: 6,711  tflops: 52.46  mfu: 16.81%
[rank0]:2025-11-28 16:56:17,574 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 7.7745e-01
[rank0]:2025-11-28 16:56:17,575 - INFO -  step: 600  loss: -8.0000  grad_norm:  0.7523  memory: 12.97GiB(27.31%)  tps: 6,710  tflops: 52.46  mfu: 16.81%
[rank0]:2025-11-28 16:56:17,624 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p50_42_dm1/frozen_ratio_history/rank0/251128_1656_stage0_step600.svg
[rank3]:2025-11-28 16:56:17,713 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p50_42_dm1/pipeline_schedule/251128_1656_real_step600_rank3.svg
[rank3]:			> Batch Time: 586.17 ms, GPU Bubble Ratio: 59.40%, 54.64%, 72.95%, 27.40%
[rank2]:2025-11-28 16:56:17,628 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p50_42_dm1/frozen_ratio_history/rank2/251128_1656_stage2_step600.svg
[rank1]:2025-11-28 16:56:17,630 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p50_42_dm1/frozen_ratio_history/rank1/251128_1656_stage1_step600.svg
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms                       | [S0,MB1,F]  9-8-17ms                      | [S0,MB2,F]  17-8-26ms                     | [S0,MB3,F]  26-7-34ms                     | [S0,MB0,B]  135-21-156ms                  | [S0,MB4,F]  156-7-164ms                   | [S0,MB1,B]  192-21-213ms                  | [S0,MB5,F]  213-7-221ms                   | [S0,MB2,B]  253-21-274ms                  | [S0,MB6,F]  275-7-282ms                   | [S0,MB3,B]  316-21-338ms                  | [S0,MB7,F]  338-7-345ms                   | [S0,MB4,B]  380-21-401ms                  | [S0,MB5,B]  441-21-463ms                  | [S0,MB6,B]  502-21-523ms                  | [S0,MB7,B]  564-21-586ms                 
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms                     | [S1,MB1,F]  23-8-32ms                     | [S1,MB2,F]  35-8-44ms                     | [S1,MB0,B]  105-24-129ms                  | [S1,MB3,F]  133-8-142ms                   | [S1,MB1,B]  162-24-186ms                  | [S1,MB4,F]  190-9-199ms                   | [S1,MB2,B]  223-24-248ms                  | [S1,MB5,F]  251-9-260ms                   | [S1,MB3,B]  287-24-311ms                  | [S1,MB6,F]  315-8-323ms                   | [S1,MB4,B]  351-23-375ms                  | [S1,MB7,F]  378-8-387ms                   | [S1,MB5,B]  414-24-438ms                  | [S1,MB6,B]  474-24-498ms                  | [S1,MB7,B]  537-23-561ms                 
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms                     | [S2,MB1,F]  32-8-40ms                     | [S2,MB0,B]  89-11-100ms                   | [S2,MB2,F]  104-8-112ms                   | [S2,MB1,B]  146-11-157ms                  | [S2,MB3,F]  161-8-169ms                   | [S2,MB2,B]  207-11-218ms                  | [S2,MB4,F]  222-8-230ms                   | [S2,MB3,B]  270-11-282ms                  | [S2,MB5,F]  285-8-294ms                   | [S2,MB4,B]  334-11-346ms                  | [S2,MB6,F]  349-8-357ms                   | [S2,MB5,B]  397-11-408ms                  | [S2,MB7,F]  412-8-420ms                   | [S2,MB6,B]  459-11-471ms                  | [S2,MB7,B]  522-11-533ms                 
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms                    | [S3,MB0,B]  48-36-85ms                    | [S3,MB1,F]  87-11-98ms                    | [S3,MB1,B]  104-37-142ms                  | [S3,MB2,F]  144-14-159ms                  | [S3,MB2,B]  164-38-203ms                  | [S3,MB3,F]  205-14-220ms                  | [S3,MB3,B]  226-40-266ms                  | [S3,MB4,F]  269-14-283ms                  | [S3,MB4,B]  289-41-330ms                  | [S3,MB5,F]  332-13-346ms                  | [S3,MB5,B]  352-40-393ms                  | [S3,MB6,F]  395-13-409ms                  | [S3,MB6,B]  415-40-456ms                  | [S3,MB7,F]  458-14-473ms                  | [S3,MB7,B]  479-39-519ms                 
[rank3]:2025-11-28 16:56:17,760 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p50_42_dm1/frozen_ratio_history/rank3/251128_1656_stage3_step600.svg
[rank0]:2025-11-28 16:57:07,407 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 6.6117e-01
[rank3]:2025-11-28 16:57:07,412 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 4.6929e-01
[rank1]:2025-11-28 16:57:07,396 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 9.3331e-01
[rank2]:2025-11-28 16:57:07,392 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.4344e-01
[rank3]:2025-11-28 16:57:55,449 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 3.2836e+00
[rank1]:2025-11-28 16:57:55,446 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 2.2464e+00
[rank2]:2025-11-28 16:57:55,430 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.8609e+00
[rank0]:2025-11-28 16:57:55,453 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 2.6426e+00
[rank0]:2025-11-28 16:58:20,105 - INFO - Avg. fwd time: 8.0975 / Avg. bwd time: 21.0231 / Avg. batch time: 599.9246 (ms) / GPU bubble ratio: 61.17%
[rank2]:2025-11-28 16:58:20,120 - INFO - Avg. fwd time: 8.0785 / Avg. bwd time: 14.0546 / Avg. batch time: 529.5368 (ms) / GPU bubble ratio: 66.56%
[rank3]:2025-11-28 16:58:20,097 - INFO - Avg. fwd time: 13.7076 / Avg. bwd time: 41.2725 / Avg. batch time: 503.2507 (ms) / GPU bubble ratio: 12.60%
[rank1]:2025-11-28 16:58:20,148 - INFO - Avg. fwd time: 9.5026 / Avg. bwd time: 21.9348 / Avg. batch time: 565.8311 (ms) / GPU bubble ratio: 55.55%
[rank2]:2025-11-28 16:58:45,151 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.5033e+00
[rank3]:2025-11-28 16:58:45,171 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 1.9039e+00
[rank1]:2025-11-28 16:58:45,155 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.0448e+00
[rank0]:2025-11-28 16:58:45,167 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 2.3930e+00
[rank2]:2025-11-28 16:59:33,264 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 7.6070e-01
[rank0]:2025-11-28 16:59:33,288 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 7.7520e-01
[rank1]:2025-11-28 16:59:33,280 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 6.3481e-01
[rank3]:2025-11-28 16:59:33,284 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.4738e+00
[rank0]:2025-11-28 17:00:18,069 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-11-28 17:00:22,756 - INFO - Avg. fwd time: 8.1037 / Avg. bwd time: 20.9819 / Avg. batch time: 599.8451 (ms) / GPU bubble ratio: 61.21%
[rank1]:2025-11-28 17:00:22,794 - INFO - Avg. fwd time: 9.5090 / Avg. bwd time: 21.8867 / Avg. batch time: 565.7939 (ms) / GPU bubble ratio: 55.61%
[rank2]:2025-11-28 17:00:22,772 - INFO - Avg. fwd time: 8.0846 / Avg. bwd time: 14.0128 / Avg. batch time: 529.5484 (ms) / GPU bubble ratio: 66.62%
[rank3]:2025-11-28 17:00:22,750 - INFO - Avg. fwd time: 13.7067 / Avg. bwd time: 41.2810 / Avg. batch time: 503.3116 (ms) / GPU bubble ratio: 12.60%
[rank1]:2025-11-28 17:00:23,023 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.1364e+00
[rank1]:2025-11-28 17:00:23,024 - INFO -  step: 650  loss: -8.0000  grad_norm:  0.0911  memory:  9.03GiB(19.01%)  tps: 6,675  tflops: 52.18  mfu: 16.72%
[rank2]:2025-11-28 17:00:23,019 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.0094e+00
[rank2]:2025-11-28 17:00:23,020 - INFO -  step: 650  loss: -8.0000  grad_norm:  0.0911  memory:  6.43GiB(13.53%)  tps: 6,675  tflops: 52.18  mfu: 16.72%
[rank3]:2025-11-28 17:00:23,039 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 1.6799e+00
[rank3]:2025-11-28 17:00:23,042 - INFO -  step: 650  loss:  0.2384  grad_norm:  0.0911  memory: 16.39GiB(34.50%)  tps: 6,675  tflops: 52.18  mfu: 16.72%
[rank0]:2025-11-28 17:00:23,035 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 1.1405e+00
[rank0]:2025-11-28 17:00:23,035 - INFO -  step: 650  loss: -8.0000  grad_norm:  0.0911  memory: 12.97GiB(27.31%)  tps: 6,675  tflops: 52.18  mfu: 16.72%
[rank1]:2025-11-28 17:01:11,153 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.0843e+00
[rank3]:2025-11-28 17:01:11,156 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.0456e+00
[rank2]:2025-11-28 17:01:11,137 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.0682e+00
[rank0]:2025-11-28 17:01:11,160 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.2770e+00
[rank2]:2025-11-28 17:02:00,777 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.6605e-01
[rank0]:2025-11-28 17:02:00,792 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 1.0123e+00
[rank1]:2025-11-28 17:02:00,781 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.0954e+00
[rank3]:2025-11-28 17:02:00,797 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 2.8059e-01
[rank2]:2025-11-28 17:02:24,842 - INFO - Avg. fwd time: 8.0927 / Avg. bwd time: 13.9545 / Avg. batch time: 529.3332 (ms) / GPU bubble ratio: 66.68%
[rank3]:2025-11-28 17:02:24,818 - INFO - Avg. fwd time: 13.7066 / Avg. bwd time: 41.2623 / Avg. batch time: 503.1604 (ms) / GPU bubble ratio: 12.60%
[rank1]:2025-11-28 17:02:24,878 - INFO - Avg. fwd time: 9.5097 / Avg. bwd time: 21.8816 / Avg. batch time: 565.5734 (ms) / GPU bubble ratio: 55.60%
[rank0]:2025-11-28 17:02:24,912 - INFO - Avg. fwd time: 8.1064 / Avg. bwd time: 20.9632 / Avg. batch time: 599.6070 (ms) / GPU bubble ratio: 61.22%
[rank2]:2025-11-28 17:02:49,026 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.5050e+00
[rank0]:2025-11-28 17:02:49,050 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 2.1587e+00
[rank3]:2025-11-28 17:02:49,046 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.1112e+00
[rank1]:2025-11-28 17:02:49,043 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 2.5811e+00
[rank2]:2025-11-28 17:03:38,753 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.3498e+00
[rank3]:2025-11-28 17:03:38,772 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 2.1993e+00
[rank1]:2025-11-28 17:03:38,757 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.9047e+00
[rank0]:2025-11-28 17:03:38,768 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 2.8283e+00
[rank0]:2025-11-28 17:04:21,985 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-28 17:04:26,525 - INFO - Avg. fwd time: 8.0991 / Avg. bwd time: 13.9093 / Avg. batch time: 529.1827 (ms) / GPU bubble ratio: 66.73%
[rank3]:2025-11-28 17:04:26,504 - INFO - Avg. fwd time: 13.7057 / Avg. bwd time: 41.2510 / Avg. batch time: 503.0609 (ms) / GPU bubble ratio: 12.60%
[rank1]:2025-11-28 17:04:26,571 - INFO - Avg. fwd time: 9.5107 / Avg. bwd time: 21.8747 / Avg. batch time: 565.4152 (ms) / GPU bubble ratio: 55.59%
[rank0]:2025-11-28 17:04:26,526 - INFO - Avg. fwd time: 8.1089 / Avg. bwd time: 20.9472 / Avg. batch time: 599.4323 (ms) / GPU bubble ratio: 61.22%
[rank0]:2025-11-28 17:04:26,790 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 3.7145e+00
[rank0]:2025-11-28 17:04:26,790 - INFO -  step: 700  loss: -8.0000  grad_norm:  0.2262  memory: 12.97GiB(27.31%)  tps: 6,722  tflops: 52.55  mfu: 16.84%
[rank2]:2025-11-28 17:04:26,766 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.1201e+00
[rank2]:2025-11-28 17:04:26,767 - INFO -  step: 700  loss: -8.0000  grad_norm:  0.2262  memory:  6.43GiB(13.53%)  tps: 6,722  tflops: 52.55  mfu: 16.84%
[rank2]:2025-11-28 17:04:26,846 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p50_42_dm1/frozen_ratio_history/rank2/251128_1704_stage2_step700.svg
[rank3]:2025-11-28 17:04:26,786 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.0860e+00
[rank3]:2025-11-28 17:04:26,789 - INFO -  step: 700  loss:  0.2019  grad_norm:  0.2262  memory: 16.39GiB(34.50%)  tps: 6,722  tflops: 52.55  mfu: 16.84%
[rank1]:2025-11-28 17:04:26,783 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 2.4020e+00
[rank1]:2025-11-28 17:04:26,783 - INFO -  step: 700  loss: -8.0000  grad_norm:  0.2262  memory:  9.03GiB(19.01%)  tps: 6,721  tflops: 52.54  mfu: 16.84%
[rank1]:2025-11-28 17:04:26,850 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p50_42_dm1/frozen_ratio_history/rank1/251128_1704_stage1_step700.svg
[rank0]:2025-11-28 17:04:26,842 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p50_42_dm1/frozen_ratio_history/rank0/251128_1704_stage0_step700.svg
[rank3]:2025-11-28 17:04:26,929 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p50_42_dm1/pipeline_schedule/251128_1704_real_step700_rank3.svg
[rank3]:			> Batch Time: 583.69 ms, GPU Bubble Ratio: 59.19%, 54.43%, 72.80%, 27.37%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms                       | [S0,MB1,F]  9-8-17ms                      | [S0,MB2,F]  17-8-26ms                     | [S0,MB3,F]  26-7-34ms                     | [S0,MB0,B]  135-21-157ms                  | [S0,MB4,F]  157-7-164ms                   | [S0,MB1,B]  192-21-213ms                  | [S0,MB5,F]  213-7-221ms                   | [S0,MB2,B]  251-21-273ms                  | [S0,MB6,F]  273-7-281ms                   | [S0,MB3,B]  314-21-336ms                  | [S0,MB7,F]  336-7-344ms                   | [S0,MB4,B]  378-21-400ms                  | [S0,MB5,B]  439-21-461ms                  | [S0,MB6,B]  501-21-522ms                  | [S0,MB7,B]  562-21-583ms                 
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms                     | [S1,MB1,F]  23-8-32ms                     | [S1,MB2,F]  35-8-44ms                     | [S1,MB0,B]  105-24-130ms                  | [S1,MB3,F]  133-8-142ms                   | [S1,MB1,B]  162-24-186ms                  | [S1,MB4,F]  190-9-199ms                   | [S1,MB2,B]  222-24-246ms                  | [S1,MB5,F]  250-9-259ms                   | [S1,MB3,B]  285-24-309ms                  | [S1,MB6,F]  313-8-322ms                   | [S1,MB4,B]  349-24-373ms                  | [S1,MB7,F]  376-8-385ms                   | [S1,MB5,B]  412-24-436ms                  | [S1,MB6,B]  473-24-497ms                  | [S1,MB7,B]  535-23-559ms                 
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms                     | [S2,MB1,F]  32-8-40ms                     | [S2,MB0,B]  89-11-100ms                   | [S2,MB2,F]  104-8-112ms                   | [S2,MB1,B]  146-11-157ms                  | [S2,MB3,F]  161-8-169ms                   | [S2,MB2,B]  205-11-217ms                  | [S2,MB4,F]  220-8-229ms                   | [S2,MB3,B]  269-11-280ms                  | [S2,MB5,F]  284-8-292ms                   | [S2,MB4,B]  332-11-344ms                  | [S2,MB6,F]  347-8-355ms                   | [S2,MB5,B]  395-11-407ms                  | [S2,MB7,F]  410-8-419ms                   | [S2,MB6,B]  459-11-470ms                  | [S2,MB7,B]  520-11-531ms                 
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms                    | [S3,MB0,B]  48-36-85ms                    | [S3,MB1,F]  87-11-99ms                    | [S3,MB1,B]  104-37-142ms                  | [S3,MB2,F]  144-12-157ms                  | [S3,MB2,B]  163-38-201ms                  | [S3,MB3,F]  204-14-219ms                  | [S3,MB3,B]  224-40-264ms                  | [S3,MB4,F]  267-14-281ms                  | [S3,MB4,B]  287-41-328ms                  | [S3,MB5,F]  330-13-344ms                  | [S3,MB5,B]  350-40-391ms                  | [S3,MB6,F]  394-13-407ms                  | [S3,MB6,B]  414-40-454ms                  | [S3,MB7,F]  457-14-472ms                  | [S3,MB7,B]  477-40-517ms                 
[rank3]:2025-11-28 17:04:26,976 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p50_42_dm1/frozen_ratio_history/rank3/251128_1704_stage3_step700.svg
[rank0]:2025-11-28 17:05:16,674 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 1.9194e+00
[rank2]:2025-11-28 17:05:16,659 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.1247e+00
[rank1]:2025-11-28 17:05:16,663 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 3.2330e+00
[rank3]:2025-11-28 17:05:16,678 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 4.0518e+00
[rank2]:2025-11-28 17:06:04,857 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.1019e+00
[rank1]:2025-11-28 17:06:04,873 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 2.1241e+00
[rank3]:2025-11-28 17:06:04,877 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.3446e+00
[rank0]:2025-11-28 17:06:04,881 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 2.0068e+00
[rank3]:2025-11-28 17:06:29,331 - INFO - Avg. fwd time: 13.7052 / Avg. bwd time: 41.2464 / Avg. batch time: 503.0204 (ms) / GPU bubble ratio: 12.61%
[rank0]:2025-11-28 17:06:29,338 - INFO - Avg. fwd time: 8.1125 / Avg. bwd time: 20.9221 / Avg. batch time: 599.3127 (ms) / GPU bubble ratio: 61.24%
[rank2]:2025-11-28 17:06:29,352 - INFO - Avg. fwd time: 8.1047 / Avg. bwd time: 13.8680 / Avg. batch time: 529.1124 (ms) / GPU bubble ratio: 66.78%
[rank1]:2025-11-28 17:06:29,383 - INFO - Avg. fwd time: 9.5135 / Avg. bwd time: 21.8521 / Avg. batch time: 565.3209 (ms) / GPU bubble ratio: 55.61%
[rank1]:2025-11-28 17:06:54,562 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.1859e+00
[rank0]:2025-11-28 17:06:54,573 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 8.3891e-01
[rank2]:2025-11-28 17:06:54,558 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 6.1797e-01
[rank3]:2025-11-28 17:06:54,577 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 1.2462e+00
[rank2]:2025-11-28 17:07:42,720 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.3562e+00
[rank0]:2025-11-28 17:07:42,744 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.2132e+00
[rank1]:2025-11-28 17:07:42,736 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 3.7328e+00
[rank3]:2025-11-28 17:07:42,739 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.7465e+00
[rank0]:2025-11-28 17:08:27,572 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-11-28 17:08:32,555 - INFO - Avg. fwd time: 9.5185 / Avg. bwd time: 21.8132 / Avg. batch time: 565.3396 (ms) / GPU bubble ratio: 55.66%
[rank2]:2025-11-28 17:08:32,523 - INFO - Avg. fwd time: 8.1088 / Avg. bwd time: 13.8385 / Avg. batch time: 529.1693 (ms) / GPU bubble ratio: 66.82%
[rank3]:2025-11-28 17:08:32,495 - INFO - Avg. fwd time: 13.7068 / Avg. bwd time: 41.2563 / Avg. batch time: 503.1120 (ms) / GPU bubble ratio: 12.60%
[rank0]:2025-11-28 17:08:32,586 - INFO - Avg. fwd time: 8.1170 / Avg. bwd time: 20.8900 / Avg. batch time: 599.3001 (ms) / GPU bubble ratio: 61.28%
[rank0]:2025-11-28 17:08:32,616 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 3.6983e-01
[rank0]:2025-11-28 17:08:32,617 - INFO -  step: 750  loss: -8.0000  grad_norm:  0.1259  memory: 12.97GiB(27.31%)  tps: 6,665  tflops: 52.10  mfu: 16.70%
[rank1]:2025-11-28 17:08:32,605 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 8.5940e-01
[rank1]:2025-11-28 17:08:32,605 - INFO -  step: 750  loss: -8.0000  grad_norm:  0.1259  memory:  9.03GiB(19.01%)  tps: 6,665  tflops: 52.10  mfu: 16.70%
[rank2]:2025-11-28 17:08:32,601 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.9343e-01
[rank2]:2025-11-28 17:08:32,602 - INFO -  step: 750  loss: -8.0000  grad_norm:  0.1259  memory:  6.43GiB(13.53%)  tps: 6,665  tflops: 52.10  mfu: 16.70%
[rank3]:2025-11-28 17:08:32,620 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 7.0566e-01
[rank3]:2025-11-28 17:08:32,624 - INFO -  step: 750  loss:  0.2440  grad_norm:  0.1259  memory: 16.39GiB(34.50%)  tps: 6,665  tflops: 52.10  mfu: 16.70%
[rank3]:2025-11-28 17:09:20,838 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.5026e+00
[rank2]:2025-11-28 17:09:20,818 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.2053e+00
[rank1]:2025-11-28 17:09:20,834 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 9.4907e-01
[rank0]:2025-11-28 17:09:20,842 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.0082e+00
[rank2]:2025-11-28 17:10:10,604 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.7001e-01
[rank1]:2025-11-28 17:10:10,608 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 6.8203e-01
[rank3]:2025-11-28 17:10:10,623 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 1.0517e+00
[rank0]:2025-11-28 17:10:10,619 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 8.3066e-01
[rank2]:2025-11-28 17:10:34,455 - INFO - Avg. fwd time: 8.1140 / Avg. bwd time: 13.8012 / Avg. batch time: 529.0645 (ms) / GPU bubble ratio: 66.86%
[rank3]:2025-11-28 17:10:34,435 - INFO - Avg. fwd time: 13.7099 / Avg. bwd time: 41.2455 / Avg. batch time: 503.0497 (ms) / GPU bubble ratio: 12.60%
[rank0]:2025-11-28 17:10:34,457 - INFO - Avg. fwd time: 8.1188 / Avg. bwd time: 20.8775 / Avg. batch time: 599.1771 (ms) / GPU bubble ratio: 61.29%
[rank1]:2025-11-28 17:10:34,503 - INFO - Avg. fwd time: 9.5190 / Avg. bwd time: 21.8088 / Avg. batch time: 565.2292 (ms) / GPU bubble ratio: 55.66%
[rank1]:2025-11-28 17:10:58,789 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.7174e+00
[rank2]:2025-11-28 17:10:58,773 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.9064e+00
[rank3]:2025-11-28 17:10:58,792 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.1172e+00
[rank0]:2025-11-28 17:10:58,797 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 2.2169e+00
[rank2]:2025-11-28 17:11:48,535 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.3927e-01
[rank3]:2025-11-28 17:11:48,554 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 3.1879e-01
[rank1]:2025-11-28 17:11:48,538 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 3.4697e-01
[rank0]:2025-11-28 17:11:48,550 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 8.2721e-01
[rank0]:2025-11-28 17:12:31,933 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-28 17:12:36,522 - INFO - Avg. fwd time: 8.1206 / Avg. bwd time: 13.7547 / Avg. batch time: 528.8918 (ms) / GPU bubble ratio: 66.91%
[rank3]:2025-11-28 17:12:36,500 - INFO - Avg. fwd time: 13.7128 / Avg. bwd time: 41.2275 / Avg. batch time: 502.9288 (ms) / GPU bubble ratio: 12.61%
[rank0]:2025-11-28 17:12:36,525 - INFO - Avg. fwd time: 8.1201 / Avg. bwd time: 20.8696 / Avg. batch time: 599.0011 (ms) / GPU bubble ratio: 61.28%
[rank1]:2025-11-28 17:12:36,569 - INFO - Avg. fwd time: 9.5179 / Avg. bwd time: 21.8152 / Avg. batch time: 565.0619 (ms) / GPU bubble ratio: 55.64%
[rank1]:2025-11-28 17:12:36,785 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 2.1601e+00
[rank1]:2025-11-28 17:12:36,785 - INFO -  step: 800  loss: -8.0000  grad_norm:  0.7375  memory:  9.03GiB(19.01%)  tps: 6,710  tflops: 52.45  mfu: 16.81%
[rank1]:2025-11-28 17:12:36,785 - INFO -  final step: 800  loss: -8.0000  grad_norm:  0.7375  tps: 7,062  tflops: 55.21  mfu: 16.12%
[rank1]:2025-11-28 17:12:36,786 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-11-28 17:12:36,786 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank2]:2025-11-28 17:12:36,769 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.9022e+00
[rank2]:2025-11-28 17:12:36,769 - INFO -  step: 800  loss: -8.0000  grad_norm:  0.7375  memory:  6.43GiB(13.53%)  tps: 6,710  tflops: 52.46  mfu: 16.81%
[rank2]:2025-11-28 17:12:36,769 - INFO -  final step: 800  loss: -8.0000  grad_norm:  0.7375  tps: 7,062  tflops: 55.21  mfu: 16.12%
[rank2]:2025-11-28 17:12:36,769 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-28 17:12:36,770 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank3]:2025-11-28 17:12:36,788 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.9740e+00
[rank3]:2025-11-28 17:12:36,792 - INFO -  step: 800  loss:  0.2462  grad_norm:  0.7375  memory: 16.39GiB(34.50%)  tps: 6,710  tflops: 52.46  mfu: 16.81%
[rank3]:2025-11-28 17:12:36,792 - INFO -  final step: 800  loss:  0.2462  grad_norm:  0.7375  tps: 7,068  tflops: 55.25  mfu: 16.29%
[rank3]:2025-11-28 17:12:36,793 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-11-28 17:12:36,793 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-11-28 17:12:36,793 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 3.0776e+00
[rank0]:2025-11-28 17:12:36,793 - INFO -  step: 800  loss: -8.0000  grad_norm:  0.7375  memory: 12.97GiB(27.31%)  tps: 6,710  tflops: 52.46  mfu: 16.81%
[rank0]:2025-11-28 17:12:36,793 - INFO -  final step: 800  loss: -8.0000  grad_norm:  0.7375  tps: 7,062  tflops: 55.21  mfu: 16.12%
[rank0]:2025-11-28 17:12:36,793 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-28 17:12:36,794 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-11-28 17:12:38,724 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank1]:2025-11-28 17:12:38,801 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p50_42_dm1/frozen_ratio_history/rank1/251128_1712_stage1_final800.svg
[rank2]:2025-11-28 17:12:38,799 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p50_42_dm1/frozen_ratio_history/rank2/251128_1712_stage2_final800.svg
[rank0]:2025-11-28 17:12:38,796 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p50_42_dm1/frozen_ratio_history/rank0/251128_1712_stage0_final800.svg
[rank3]:2025-11-28 17:12:38,886 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p50_42_dm1/pipeline_schedule/251128_1712_real_final800_rank3.svg
[rank3]:			> Batch Time: 601.64 ms, GPU Bubble Ratio: 60.36%, 56.00%, 70.55%, 27.02%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms                       | [S0,MB1,F]  9-8-17ms                      | [S0,MB2,F]  18-8-26ms                     | [S0,MB3,F]  26-8-34ms                     | [S0,MB0,B]  135-21-157ms                  | [S0,MB4,F]  156-7-163ms                   | [S0,MB1,B]  193-21-215ms                  | [S0,MB5,F]  214-7-221ms                   | [S0,MB2,B]  256-21-278ms                  | [S0,MB6,F]  277-7-284ms                   | [S0,MB3,B]  321-21-343ms                  | [S0,MB7,F]  341-7-349ms                   | [S0,MB4,B]  386-21-408ms                  | [S0,MB5,B]  450-21-471ms                  | [S0,MB6,B]  514-21-536ms                  | [S0,MB7,B]  580-21-601ms                 
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms                     | [S1,MB1,F]  23-8-32ms                     | [S1,MB2,F]  35-9-44ms                     | [S1,MB0,B]  110-21-131ms                  | [S1,MB3,F]  133-9-143ms                   | [S1,MB1,B]  169-23-193ms                  | [S1,MB4,F]  192-9-201ms                   | [S1,MB2,B]  231-23-255ms                  | [S1,MB5,F]  255-9-264ms                   | [S1,MB3,B]  295-23-319ms                  | [S1,MB6,F]  319-9-329ms                   | [S1,MB4,B]  360-23-384ms                  | [S1,MB7,F]  384-9-394ms                   | [S1,MB5,B]  426-23-449ms                  | [S1,MB6,B]  490-23-514ms                  | [S1,MB7,B]  556-23-580ms                 
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms                     | [S2,MB1,F]  32-8-40ms                     | [S2,MB0,B]  90-14-104ms                   | [S2,MB2,F]  108-8-116ms                   | [S2,MB1,B]  148-14-162ms                  | [S2,MB3,F]  167-8-175ms                   | [S2,MB2,B]  211-14-225ms                  | [S2,MB4,F]  229-8-237ms                   | [S2,MB3,B]  275-13-289ms                  | [S2,MB5,F]  293-8-301ms                   | [S2,MB4,B]  340-14-354ms                  | [S2,MB6,F]  359-8-367ms                   | [S2,MB5,B]  406-14-420ms                  | [S2,MB7,F]  424-8-432ms                   | [S2,MB6,B]  472-14-486ms                  | [S2,MB7,B]  538-13-552ms                 
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms                    | [S3,MB0,B]  48-37-86ms                    | [S3,MB1,F]  88-10-99ms                    | [S3,MB1,B]  105-39-145ms                  | [S3,MB2,F]  147-13-160ms                  | [S3,MB2,B]  166-41-208ms                  | [S3,MB3,F]  209-14-224ms                  | [S3,MB3,B]  229-42-272ms                  | [S3,MB4,F]  274-14-288ms                  | [S3,MB4,B]  294-42-336ms                  | [S3,MB5,F]  339-14-353ms                  | [S3,MB5,B]  359-42-401ms                  | [S3,MB6,F]  404-14-418ms                  | [S3,MB6,B]  424-42-467ms                  | [S3,MB7,F]  470-14-485ms                  | [S3,MB7,B]  490-42-533ms                 
[rank0]:2025-11-28 17:12:38,957 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p50_42_dm1/frozen_params_histogram/251128_1712_rank0_stage0.svg
[rank0]:	> Counts Sum: 945, Total Sum: 2775 (34.05%), Ratio(%) per element: [0.0, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 45.33, 45.33, 45.33, 45.33, 45.33, 45.33, 45.33, 45.33, 45.33, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-11-28 17:12:38,957 - INFO - Sleeping 2 seconds for other ranks to complete
[rank1]:2025-11-28 17:12:38,956 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p50_42_dm1/frozen_params_histogram/251128_1712_rank1_stage1.svg
[rank1]:	> Counts Sum: 612, Total Sum: 3375 (18.13%), Ratio(%) per element: [48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 42.66, 42.66, 42.66, 42.66, 42.66, 42.66, 42.66, 42.66, 42.66, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-11-28 17:12:38,956 - INFO - Destroying the purge thread.
[rank3]:2025-11-28 17:12:39,020 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p50_42_dm1/pipeline_schedule/251128_1712_thry_final800_rank3.svg
[rank3]:			> Batch Time: 325.25 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms                       | [S0,MB1,F]  9-9-19ms                      | [S0,MB2,F]  19-9-29ms                     | [S0,MB3,F]  29-9-39ms                     | [S0,MB0,B]  98-19-118ms                   | [S0,MB4,F]  118-9-128ms                   | [S0,MB1,B]  128-19-147ms                  | [S0,MB5,F]  147-9-157ms                   | [S0,MB2,B]  157-19-177ms                  | [S0,MB6,F]  177-9-187ms                   | [S0,MB3,B]  187-19-206ms                  | [S0,MB7,F]  206-9-216ms                   | [S0,MB4,B]  216-19-236ms                  | [S0,MB5,B]  246-19-266ms                  | [S0,MB6,B]  275-19-295ms                  | [S0,MB7,B]  305-19-325ms                 
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-9-19ms                      | [S1,MB1,F]  19-9-29ms                     | [S1,MB2,F]  29-9-39ms                     | [S1,MB0,B]  78-19-98ms                    | [S1,MB3,F]  98-9-108ms                    | [S1,MB1,B]  108-19-128ms                  | [S1,MB4,F]  128-9-137ms                   | [S1,MB2,B]  137-19-157ms                  | [S1,MB5,F]  157-9-167ms                   | [S1,MB3,B]  167-19-187ms                  | [S1,MB6,F]  187-9-197ms                   | [S1,MB4,B]  197-19-216ms                  | [S1,MB7,F]  216-9-226ms                   | [S1,MB5,B]  226-19-246ms                  | [S1,MB6,B]  256-19-275ms                  | [S1,MB7,B]  285-19-305ms                 
[rank3]:			  [Rank 2]	[S2,MB0,F]  19-9-29ms                     | [S2,MB1,F]  29-9-39ms                     | [S2,MB0,B]  59-19-78ms                    | [S2,MB2,F]  78-9-88ms                     | [S2,MB1,B]  88-19-108ms                   | [S2,MB3,F]  108-9-118ms                   | [S2,MB2,B]  118-19-137ms                  | [S2,MB4,F]  137-9-147ms                   | [S2,MB3,B]  147-19-167ms                  | [S2,MB5,F]  167-9-177ms                   | [S2,MB4,B]  177-19-197ms                  | [S2,MB6,F]  197-9-206ms                   | [S2,MB5,B]  206-19-226ms                  | [S2,MB7,F]  226-9-236ms                   | [S2,MB6,B]  236-19-256ms                  | [S2,MB7,B]  266-19-285ms                 
[rank2]:2025-11-28 17:12:38,956 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p50_42_dm1/frozen_params_histogram/251128_1712_rank2_stage2.svg
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-9-39ms                     | [S3,MB0,B]  39-19-59ms                    | [S3,MB1,F]  59-9-68ms                     | [S3,MB1,B]  68-19-88ms                    | [S3,MB2,F]  88-9-98ms                     | [S3,MB2,B]  98-19-118ms                   | [S3,MB3,F]  118-9-128ms                   | [S3,MB3,B]  128-19-147ms                  | [S3,MB4,F]  147-9-157ms                   | [S3,MB4,B]  157-19-177ms                  | [S3,MB5,F]  177-9-187ms                   | [S3,MB5,B]  187-19-206ms                  | [S3,MB6,F]  206-9-216ms                   | [S3,MB6,B]  216-19-236ms                  | [S3,MB7,F]  236-9-246ms                   | [S3,MB7,B]  246-19-266ms                 
[rank2]:	> Counts Sum: 1530, Total Sum: 2700 (56.67%), Ratio(%) per element: [92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 42.66, 42.66, 42.66, 42.66, 42.66, 42.66, 42.66, 42.66, 42.66, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-11-28 17:12:38,957 - INFO - Destroying the purge thread.
[rank1]:2025-11-28 17:12:39,121 - INFO - Process group destroyed
[rank2]:2025-11-28 17:12:39,122 - INFO - Process group destroyed
[rank3]:2025-11-28 17:12:39,069 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p50_42_dm1/frozen_ratio_history/rank3/251128_1712_stage3_final800.svg
[rank3]:2025-11-28 17:12:39,205 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p50_42_dm1/frozen_params_histogram/251128_1712_rank3_stage3.svg
[rank3]:	> Counts Sum: 324, Total Sum: 2175 (14.90%), Ratio(%) per element: [48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 48.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-11-28 17:12:39,206 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading wandb-summary.json
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–ˆâ–‡â–ƒâ–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–ˆâ–‡â–ƒâ–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 4.63634
[rank3]:wandb:               final/avg_loss 0.24617
[rank3]:wandb:             final/avg_mfu(%) 16.28863
[rank3]:wandb:             final/avg_tflops 55.25158
[rank3]:wandb:    final/avg_throughput(tps) 7067.64277
[rank3]:wandb:              final/grad_norm 0.73747
[rank3]:wandb:               final/max_loss 0.24617
[rank3]:wandb:                    grad_norm 0.73747
[rank3]:wandb: loss_metrics/global_avg_loss 0.24617
[rank3]:wandb: loss_metrics/global_max_loss 0.24617
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1116_1F1B_auto_p50_42_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/6fx3cf2h
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1116_1F1B_auto_p50_42_dm1/20251128-1606/wandb/run-20251128_160654-6fx3cf2h/logs
[rank0]:2025-11-28 17:12:40,957 - INFO - Training completed
[rank0]:2025-11-28 17:12:40,958 - INFO - Destroying the purge thread.
[rank3]:2025-11-28 17:12:41,068 - INFO - Process group destroyed
[rank0]:2025-11-28 17:12:41,109 - INFO - Process group destroyed
[rank2]:Stage 2: Modules to keep: {'layers.11', 'layers.10', 'layers.12', 'layers.9'}
[rank0]:Stage 0: Modules to keep: {'layers.0', 'tok_embeddings', 'layers.1', 'layers.2', 'layers.3'}
[rank1]:Stage 1: Modules to keep: {'layers.7', 'layers.5', 'layers.4', 'layers.6', 'layers.8'}
[rank3]:Stage 3: Modules to keep: {'layers.15', 'norm', 'output', 'layers.14', 'layers.13'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1116_autofreeze/config_1116.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "AutoFreeze configuration experiment on different PERCENTILE values."
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1116_1F1B_auto_p50_42_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1116_1F1B_auto_p50_42_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1116_1F1B_auto_p50_42_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1116_1F1B_auto_p50_42_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1116_1F1B_auto_p50_42_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1116_1F1B_auto_p50_42_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 42
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: 1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1116_1F1B_auto_p50_42_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1116_1F1B_auto_p50_42_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: auto
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.05
[rank3]:		- percentile: 50
[rank3]:
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
