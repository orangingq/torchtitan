
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 11. 28. (ê¸ˆ) 15:02:52 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 1,2,3,4
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1116_autofreeze/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1116_autofreeze/1116_1F1B_auto_p40_42.log
âœ”ï¸AutoFreeze configuration experiment on different PERCENTILE values.
âœ”ï¸Running with autofreeze (percentile=40) x 1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1116_autofreeze/config_1116.toml --job.description="AutoFreeze configuration experiment on different PERCENTILE values." --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=auto --freezing.percentile=40
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank2]:2025-11-28 15:02:59,178 - INFO - Starting job: "AutoFreeze configuration experiment on different PERCENTILE values."
[rank3]:2025-11-28 15:02:59,178 - INFO - Starting job: "AutoFreeze configuration experiment on different PERCENTILE values."
[rank0]:2025-11-28 15:02:59,377 - INFO - Starting job: "AutoFreeze configuration experiment on different PERCENTILE values."
[rank1]:2025-11-28 15:02:59,354 - INFO - Starting job: "AutoFreeze configuration experiment on different PERCENTILE values."
[rank2]:2025-11-28 15:02:59,414 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-11-28 15:02:59,416 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-11-28 15:02:59,404 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-11-28 15:02:59,406 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-11-28 15:02:59,590 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-11-28 15:02:59,593 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-28 15:02:59,612 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-11-28 15:02:59,614 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-28 15:02:59,618 - INFO - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-11-28 15:02:59,619 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-11-28 15:03:00,006 - INFO - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank2]:2025-11-28 15:03:02,743 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-11-28 15:03:02,782 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-28 15:03:02,732 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank2]:2025-11-28 15:03:02,808 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-11-28 15:03:02,808 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2025-11-28 15:03:02,885 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-11-28 15:03:02,989 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-11-28 15:03:02,989 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-11-28 15:03:02,990 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank0]:2025-11-28 15:03:02,925 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-28 15:03:02,927 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-11-28 15:03:02,953 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-11-28 15:03:02,953 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2025-11-28 15:03:03,048 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-11-28 15:03:03,090 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-28 15:03:03,154 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-28 15:03:03,155 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-11-28 15:03:03,155 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank1]:2025-11-28 15:03:03,120 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-11-28 15:03:03,120 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2025-11-28 15:03:03,303 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-11-28 15:03:03,304 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-11-28 15:03:03,304 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run yawgndk0
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1116_1F1B_auto_p40_42_dm1/20251128-1503/wandb/run-20251128_150303-yawgndk0
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1116_1F1B_auto_p40_42_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/yawgndk0
[rank3]:2025-11-28 15:03:04,909 - INFO - WandB logging enabled
[rank3]:2025-11-28 15:03:04,909 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-11-28 15:03:04,948 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-11-28 15:03:04,977 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-11-28 15:03:04,978 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2025-11-28 15:03:05,182 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1116_1F1B_auto_p40_42_dm1
[rank0]:2025-11-28 15:03:05,183 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-28 15:03:05,184 - INFO - Trainer is initialized with local batch size 16, global batch size 128, gradient accumulation steps 8, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2025-11-28 15:03:05,184 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank2]:2025-11-28 15:03:05,180 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank1]:2025-11-28 15:03:05,179 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-11-28 15:03:05,162 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-11-28 15:03:05,163 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-11-28 15:03:05,164 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2025-11-28 15:03:05,179 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-28 15:03:07,501 - INFO - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-11-28 15:03:07,501 - INFO - Finished loading the checkpoint in 2.32 seconds.
[rank0]:2025-11-28 15:03:07,501 - INFO - Training starts at step 1
[rank2]:2025-11-28 15:03:12,934 - INFO -  step:  1  loss: -8.0000  grad_norm: 116.5373  memory:  4.63GiB(9.75%)  tps: 3,228  tflops: 25.23  mfu: 8.09%
[rank3]:2025-11-28 15:03:12,944 - INFO -  step:  1  loss: 10.6088  grad_norm: 116.5373  memory: 12.97GiB(27.31%)  tps: 4,099  tflops: 32.05  mfu: 10.27%
[rank3]:2025-11-28 15:03:12,945 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-11-28 15:03:12,935 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-28 15:03:12,982 - INFO -  step:  1  loss: -8.0000  grad_norm: 116.5373  memory:  9.19GiB(19.34%)  tps: 3,259  tflops: 25.47  mfu: 8.16%
[rank0]:2025-11-28 15:03:12,982 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-11-28 15:03:12,938 - INFO -  step:  1  loss: -8.0000  grad_norm: 116.5373  memory:  6.76GiB(14.24%)  tps: 3,328  tflops: 26.01  mfu: 8.34%
[rank1]:2025-11-28 15:03:12,943 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-11-28 15:05:12,732 - INFO - Avg. fwd time: 12.9579 / Avg. bwd time: 41.4207 / Avg. batch time: 498.7264 (ms) / GPU bubble ratio: 12.77%
[rank2]:2025-11-28 15:05:12,771 - INFO - Avg. fwd time: 7.3244 / Avg. bwd time: 19.0606 / Avg. batch time: 530.7522 (ms) / GPU bubble ratio: 60.23%
[rank1]:2025-11-28 15:05:12,805 - INFO - Avg. fwd time: 9.1908 / Avg. bwd time: 23.6988 / Avg. batch time: 569.6010 (ms) / GPU bubble ratio: 53.81%
[rank0]:2025-11-28 15:05:12,801 - INFO - Avg. fwd time: 7.5771 / Avg. bwd time: 24.0329 / Avg. batch time: 607.3917 (ms) / GPU bubble ratio: 58.37%
[rank0]:2025-11-28 15:07:15,022 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-28 15:07:19,813 - INFO - Avg. fwd time: 7.3545 / Avg. bwd time: 19.1485 / Avg. batch time: 537.6535 (ms) / GPU bubble ratio: 60.56%
[rank3]:2025-11-28 15:07:19,775 - INFO - Avg. fwd time: 13.2904 / Avg. bwd time: 42.0081 / Avg. batch time: 505.9704 (ms) / GPU bubble ratio: 12.57%
[rank0]:2025-11-28 15:07:19,844 - INFO - Avg. fwd time: 7.6245 / Avg. bwd time: 24.1402 / Avg. batch time: 613.6973 (ms) / GPU bubble ratio: 58.59%
[rank1]:2025-11-28 15:07:19,847 - INFO - Avg. fwd time: 9.2353 / Avg. bwd time: 23.8235 / Avg. batch time: 576.2052 (ms) / GPU bubble ratio: 54.10%
[rank0]:2025-11-28 15:07:20,086 - INFO -  step: 50  loss: -8.0000  grad_norm: 12.7217  memory: 12.97GiB(27.31%)  tps: 6,498  tflops: 50.80  mfu: 16.28%
[rank2]:2025-11-28 15:07:20,072 - INFO -  step: 50  loss: -8.0000  grad_norm: 12.7217  memory:  6.43GiB(13.53%)  tps: 6,497  tflops: 50.79  mfu: 16.28%
[rank3]:2025-11-28 15:07:20,084 - INFO -  step: 50  loss:  9.9137  grad_norm: 12.7217  memory: 16.39GiB(34.50%)  tps: 6,497  tflops: 50.79  mfu: 16.28%
[rank1]:2025-11-28 15:07:20,076 - INFO -  step: 50  loss: -8.0000  grad_norm: 12.7217  memory:  9.03GiB(19.01%)  tps: 6,497  tflops: 50.79  mfu: 16.28%
[rank3]:2025-11-28 15:08:11,025 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 0.0000e+00
[rank0]:2025-11-28 15:08:11,031 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 0.0000e+00
[rank2]:2025-11-28 15:08:11,026 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 0.0000e+00
[rank1]:2025-11-28 15:08:11,026 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 0.0000e+00
[rank0]:2025-11-28 15:09:02,046 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 3.5915e+00
[rank3]:2025-11-28 15:09:02,042 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 3.2368e+00
[rank2]:2025-11-28 15:09:02,030 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 3.1557e+00
[rank1]:2025-11-28 15:09:02,034 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 3.5549e+00
[rank3]:2025-11-28 15:09:27,581 - INFO - Avg. fwd time: 13.3991 / Avg. bwd time: 42.2217 / Avg. batch time: 508.5174 (ms) / GPU bubble ratio: 12.50%
[rank0]:2025-11-28 15:09:27,667 - INFO - Avg. fwd time: 7.6399 / Avg. bwd time: 24.1851 / Avg. batch time: 616.0109 (ms) / GPU bubble ratio: 58.67%
[rank2]:2025-11-28 15:09:27,607 - INFO - Avg. fwd time: 7.3564 / Avg. bwd time: 19.1897 / Avg. batch time: 540.1124 (ms) / GPU bubble ratio: 60.68%
[rank1]:2025-11-28 15:09:27,637 - INFO - Avg. fwd time: 9.2372 / Avg. bwd time: 23.8702 / Avg. batch time: 578.5867 (ms) / GPU bubble ratio: 54.22%
[rank0]:2025-11-28 15:09:53,252 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 4.0788e+00
[rank3]:2025-11-28 15:09:53,248 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 3.4310e+00
[rank1]:2025-11-28 15:09:53,240 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 7.0862e-01
[rank2]:2025-11-28 15:09:53,236 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.5536e+00
[rank1]:2025-11-28 15:10:43,444 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.0670e+00
[rank0]:2025-11-28 15:10:43,451 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 1.6352e+00
[rank3]:2025-11-28 15:10:43,451 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 2.8598e+00
[rank2]:2025-11-28 15:10:43,432 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.4899e+00
[rank0]:2025-11-28 15:11:27,384 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-28 15:11:31,925 - INFO - Avg. fwd time: 13.4364 / Avg. bwd time: 42.0604 / Avg. batch time: 507.5048 (ms) / GPU bubble ratio: 12.52%
[rank2]:2025-11-28 15:11:31,967 - INFO - Avg. fwd time: 7.4325 / Avg. bwd time: 18.6642 / Avg. batch time: 538.5067 (ms) / GPU bubble ratio: 61.23%
[rank0]:2025-11-28 15:11:31,998 - INFO - Avg. fwd time: 7.6827 / Avg. bwd time: 23.9307 / Avg. batch time: 614.0724 (ms) / GPU bubble ratio: 58.81%
[rank1]:2025-11-28 15:11:32,002 - INFO - Avg. fwd time: 9.2569 / Avg. bwd time: 23.8969 / Avg. batch time: 576.9486 (ms) / GPU bubble ratio: 54.03%
[rank2]:2025-11-28 15:11:32,218 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 6.8765e-01
[rank2]:2025-11-28 15:11:32,219 - INFO -  step: 100  loss: -8.0000  grad_norm:  8.4206  memory:  6.43GiB(13.53%)  tps: 6,498  tflops: 50.80  mfu: 16.28%
[rank0]:2025-11-28 15:11:32,234 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 2.6514e+00
[rank0]:2025-11-28 15:11:32,234 - INFO -  step: 100  loss: -8.0000  grad_norm:  8.4206  memory: 12.97GiB(27.31%)  tps: 6,498  tflops: 50.80  mfu: 16.28%
[rank3]:2025-11-28 15:11:32,227 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 3.0371e+00
[rank3]:2025-11-28 15:11:32,230 - INFO -  step: 100  loss:  8.3514  grad_norm:  8.4206  memory: 16.39GiB(34.50%)  tps: 6,498  tflops: 50.80  mfu: 16.28%
[rank1]:2025-11-28 15:11:32,222 - INFO - Freezing Ratio: [Stage1] 0.20, Threshold: 2.9553e+00
[rank1]:2025-11-28 15:11:32,223 - INFO -  step: 100  loss: -8.0000  grad_norm:  8.4206  memory:  9.03GiB(19.01%)  tps: 6,498  tflops: 50.80  mfu: 16.28%
[rank2]:2025-11-28 15:11:32,324 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p40_42_dm1/frozen_ratio_history/rank2/251128_1511_stage2_step100.svg
[rank0]:2025-11-28 15:11:32,304 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p40_42_dm1/frozen_ratio_history/rank0/251128_1511_stage0_step100.svg
[rank1]:2025-11-28 15:11:32,310 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p40_42_dm1/frozen_ratio_history/rank1/251128_1511_stage1_step100.svg
[rank3]:2025-11-28 15:11:32,415 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p40_42_dm1/pipeline_schedule/251128_1511_real_step100_rank3.svg
[rank3]:			> Batch Time: 596.33 ms, GPU Bubble Ratio: 56.97%, 55.15%, 64.18%, 28.95%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms                       | [S0,MB1,F]  9-7-17ms                      | [S0,MB2,F]  17-7-25ms                     | [S0,MB3,F]  25-7-32ms                     | [S0,MB0,B]  143-24-167ms                  | [S0,MB4,F]  168-7-175ms                   | [S0,MB1,B]  200-24-224ms                  | [S0,MB5,F]  225-7-232ms                   | [S0,MB2,B]  260-24-285ms                  | [S0,MB6,F]  285-7-292ms                   | [S0,MB3,B]  323-24-347ms                  | [S0,MB7,F]  348-7-355ms                   | [S0,MB4,B]  386-24-411ms                  | [S0,MB5,B]  448-24-472ms                  | [S0,MB6,B]  508-24-532ms                  | [S0,MB7,B]  572-24-596ms                 
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms                     | [S1,MB1,F]  23-8-32ms                     | [S1,MB2,F]  35-8-44ms                     | [S1,MB0,B]  114-24-138ms                  | [S1,MB3,F]  141-8-150ms                   | [S1,MB1,B]  171-24-195ms                  | [S1,MB4,F]  198-9-207ms                   | [S1,MB2,B]  231-24-255ms                  | [S1,MB5,F]  259-9-268ms                   | [S1,MB3,B]  294-24-318ms                  | [S1,MB6,F]  321-9-331ms                   | [S1,MB4,B]  357-24-381ms                  | [S1,MB7,F]  385-9-394ms                   | [S1,MB5,B]  420-24-444ms                  | [S1,MB6,B]  480-24-504ms                  | [S1,MB7,B]  544-23-568ms                 
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms                     | [S2,MB1,F]  32-7-39ms                     | [S2,MB0,B]  89-19-109ms                   | [S2,MB2,F]  112-7-119ms                   | [S2,MB1,B]  146-19-166ms                  | [S2,MB3,F]  169-7-176ms                   | [S2,MB2,B]  206-19-226ms                  | [S2,MB4,F]  229-7-237ms                   | [S2,MB3,B]  269-19-289ms                  | [S2,MB5,F]  292-7-299ms                   | [S2,MB4,B]  332-19-352ms                  | [S2,MB6,F]  355-7-363ms                   | [S2,MB5,B]  396-19-416ms                  | [S2,MB7,F]  419-7-426ms                   | [S2,MB6,B]  458-19-477ms                  | [S2,MB7,B]  522-19-541ms                 
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-43ms                    | [S3,MB0,B]  49-36-85ms                    | [S3,MB1,F]  88-11-99ms                    | [S3,MB1,B]  105-37-142ms                  | [S3,MB2,F]  145-12-158ms                  | [S3,MB2,B]  163-39-202ms                  | [S3,MB3,F]  205-14-219ms                  | [S3,MB3,B]  225-40-265ms                  | [S3,MB4,F]  268-14-282ms                  | [S3,MB4,B]  288-40-329ms                  | [S3,MB5,F]  331-13-345ms                  | [S3,MB5,B]  351-40-392ms                  | [S3,MB6,F]  395-13-408ms                  | [S3,MB6,B]  414-40-455ms                  | [S3,MB7,F]  456-14-471ms                  | [S3,MB7,B]  478-40-518ms                 
[rank3]:2025-11-28 15:11:32,462 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p40_42_dm1/frozen_ratio_history/rank3/251128_1511_stage3_step100.svg
[rank2]:2025-11-28 15:12:22,536 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.0459e+00
[rank0]:2025-11-28 15:12:22,555 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 2.2816e+00
[rank3]:2025-11-28 15:12:22,555 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 1.1262e+00
[rank1]:2025-11-28 15:12:22,544 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 7.4115e-01
[rank2]:2025-11-28 15:13:11,619 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 5.1119e-01
[rank0]:2025-11-28 15:13:11,635 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 2.8989e+00
[rank3]:2025-11-28 15:13:11,626 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.1567e+00
[rank1]:2025-11-28 15:13:11,622 - INFO - Freezing Ratio: [Stage1] 0.20, Threshold: 2.1788e+00
[rank2]:2025-11-28 15:13:36,205 - INFO - Avg. fwd time: 7.4962 / Avg. bwd time: 18.2019 / Avg. batch time: 536.6293 (ms) / GPU bubble ratio: 61.69%
[rank0]:2025-11-28 15:13:36,200 - INFO - Avg. fwd time: 7.7180 / Avg. bwd time: 23.7049 / Avg. batch time: 611.6138 (ms) / GPU bubble ratio: 58.90%
[rank3]:2025-11-28 15:13:36,182 - INFO - Avg. fwd time: 13.4649 / Avg. bwd time: 41.8475 / Avg. batch time: 506.0158 (ms) / GPU bubble ratio: 12.55%
[rank1]:2025-11-28 15:13:36,242 - INFO - Avg. fwd time: 9.3019 / Avg. bwd time: 23.6188 / Avg. batch time: 574.7533 (ms) / GPU bubble ratio: 54.18%
[rank0]:2025-11-28 15:14:01,623 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.2886e+00
[rank2]:2025-11-28 15:14:01,603 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.8636e+00
[rank3]:2025-11-28 15:14:01,623 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 6.4643e+00
[rank1]:2025-11-28 15:14:01,611 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.6587e+00
[rank2]:2025-11-28 15:14:50,379 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 3.7173e-01
[rank0]:2025-11-28 15:14:50,395 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 1.4654e+00
[rank3]:2025-11-28 15:14:50,387 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.7586e+00
[rank1]:2025-11-28 15:14:50,383 - INFO - Freezing Ratio: [Stage1] 0.20, Threshold: 1.1351e+00
[rank0]:2025-11-28 15:15:35,369 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-28 15:15:40,278 - INFO - Avg. fwd time: 13.4689 / Avg. bwd time: 41.7626 / Avg. batch time: 505.3592 (ms) / GPU bubble ratio: 12.57%
[rank2]:2025-11-28 15:15:40,300 - INFO - Avg. fwd time: 7.5501 / Avg. bwd time: 17.8180 / Avg. batch time: 535.5374 (ms) / GPU bubble ratio: 62.10%
[rank1]:2025-11-28 15:15:40,328 - INFO - Avg. fwd time: 9.3372 / Avg. bwd time: 23.3971 / Avg. batch time: 573.4115 (ms) / GPU bubble ratio: 54.33%
[rank0]:2025-11-28 15:15:40,356 - INFO - Avg. fwd time: 7.7465 / Avg. bwd time: 23.5163 / Avg. batch time: 610.0609 (ms) / GPU bubble ratio: 59.00%
[rank2]:2025-11-28 15:15:40,372 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.3595e+00
[rank2]:2025-11-28 15:15:40,379 - INFO -  step: 150  loss: -8.0000  grad_norm: 11.4207  memory:  6.43GiB(13.53%)  tps: 6,602  tflops: 51.61  mfu: 16.54%
[rank3]:2025-11-28 15:15:40,391 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 1.4589e+00
[rank3]:2025-11-28 15:15:40,395 - INFO -  step: 150  loss:  3.6023  grad_norm: 11.4207  memory: 16.39GiB(34.50%)  tps: 6,602  tflops: 51.61  mfu: 16.54%
[rank1]:2025-11-28 15:15:40,380 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.2023e+00
[rank1]:2025-11-28 15:15:40,380 - INFO -  step: 150  loss: -8.0000  grad_norm: 11.4207  memory:  9.03GiB(19.01%)  tps: 6,602  tflops: 51.61  mfu: 16.54%
[rank0]:2025-11-28 15:15:40,391 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 1.2569e+00
[rank0]:2025-11-28 15:15:40,391 - INFO -  step: 150  loss: -8.0000  grad_norm: 11.4207  memory: 12.97GiB(27.31%)  tps: 6,602  tflops: 51.61  mfu: 16.54%
[rank2]:2025-11-28 15:16:29,490 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 6.9147e-01
[rank3]:2025-11-28 15:16:29,498 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 3.3723e+00
[rank1]:2025-11-28 15:16:29,494 - INFO - Freezing Ratio: [Stage1] 0.20, Threshold: 1.2144e+00
[rank0]:2025-11-28 15:16:29,506 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 5.4987e+00
[rank2]:2025-11-28 15:17:19,659 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.0827e+01
[rank1]:2025-11-28 15:17:19,667 - INFO - Freezing Ratio: [Stage1] 0.20, Threshold: 2.1797e+01
[rank3]:2025-11-28 15:17:19,679 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 1.7976e+01
[rank0]:2025-11-28 15:17:19,678 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.9509e+01
[rank3]:2025-11-28 15:17:43,217 - INFO - Avg. fwd time: 13.4921 / Avg. bwd time: 41.6479 / Avg. batch time: 504.6241 (ms) / GPU bubble ratio: 12.58%
[rank0]:2025-11-28 15:17:43,230 - INFO - Avg. fwd time: 7.7668 / Avg. bwd time: 23.3863 / Avg. batch time: 608.7905 (ms) / GPU bubble ratio: 59.06%
[rank2]:2025-11-28 15:17:43,238 - INFO - Avg. fwd time: 7.5828 / Avg. bwd time: 17.5880 / Avg. batch time: 534.5385 (ms) / GPU bubble ratio: 62.33%
[rank1]:2025-11-28 15:17:43,278 - INFO - Avg. fwd time: 9.3552 / Avg. bwd time: 23.2848 / Avg. batch time: 572.2817 (ms) / GPU bubble ratio: 54.37%
[rank2]:2025-11-28 15:18:07,307 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 5.6690e+00
[rank3]:2025-11-28 15:18:07,326 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.1716e+00
[rank1]:2025-11-28 15:18:07,319 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 5.3476e+00
[rank0]:2025-11-28 15:18:07,326 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 4.9932e+00
[rank2]:2025-11-28 15:18:57,149 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.1113e+00
[rank3]:2025-11-28 15:18:57,169 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 2.0854e+00
[rank1]:2025-11-28 15:18:57,149 - INFO - Freezing Ratio: [Stage1] 0.20, Threshold: 2.5691e+00
[rank0]:2025-11-28 15:18:57,169 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 2.1635e+00
[rank0]:2025-11-28 15:19:40,167 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-28 15:19:44,741 - INFO - Avg. fwd time: 7.6805 / Avg. bwd time: 16.8997 / Avg. batch time: 533.2176 (ms) / GPU bubble ratio: 63.12%
[rank3]:2025-11-28 15:19:44,721 - INFO - Avg. fwd time: 13.5363 / Avg. bwd time: 41.5294 / Avg. batch time: 504.0262 (ms) / GPU bubble ratio: 12.60%
[rank1]:2025-11-28 15:19:44,782 - INFO - Avg. fwd time: 9.4164 / Avg. bwd time: 22.7689 / Avg. batch time: 570.4312 (ms) / GPU bubble ratio: 54.86%
[rank0]:2025-11-28 15:19:44,733 - INFO - Avg. fwd time: 7.8293 / Avg. bwd time: 22.9417 / Avg. batch time: 606.4800 (ms) / GPU bubble ratio: 59.41%
[rank2]:2025-11-28 15:19:44,994 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.4130e+00
[rank2]:2025-11-28 15:19:44,995 - INFO -  step: 200  loss: -8.0000  grad_norm:  8.4213  memory:  6.43GiB(13.53%)  tps: 6,698  tflops: 52.36  mfu: 16.78%
[rank2]:2025-11-28 15:19:45,071 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p40_42_dm1/frozen_ratio_history/rank2/251128_1519_stage2_step200.svg
[rank3]:2025-11-28 15:19:45,014 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.1406e+00
[rank3]:2025-11-28 15:19:45,017 - INFO -  step: 200  loss:  1.1625  grad_norm:  8.4213  memory: 16.39GiB(34.50%)  tps: 6,698  tflops: 52.36  mfu: 16.78%
[rank1]:2025-11-28 15:19:45,006 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 2.1954e-01
[rank1]:2025-11-28 15:19:45,007 - INFO -  step: 200  loss: -8.0000  grad_norm:  8.4213  memory:  9.03GiB(19.01%)  tps: 6,698  tflops: 52.36  mfu: 16.78%
[rank1]:2025-11-28 15:19:45,069 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p40_42_dm1/frozen_ratio_history/rank1/251128_1519_stage1_step200.svg
[rank0]:2025-11-28 15:19:45,014 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 1.3974e+00
[rank0]:2025-11-28 15:19:45,014 - INFO -  step: 200  loss: -8.0000  grad_norm:  8.4213  memory: 12.97GiB(27.31%)  tps: 6,698  tflops: 52.36  mfu: 16.78%
[rank0]:2025-11-28 15:19:45,067 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p40_42_dm1/frozen_ratio_history/rank0/251128_1519_stage0_step200.svg
[rank3]:2025-11-28 15:19:45,158 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p40_42_dm1/pipeline_schedule/251128_1519_real_step200_rank3.svg
[rank3]:			> Batch Time: 581.56 ms, GPU Bubble Ratio: 62.23%, 57.46%, 72.71%, 26.83%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms                       | [S0,MB1,F]  9-8-18ms                      | [S0,MB2,F]  18-8-26ms                     | [S0,MB3,F]  26-8-35ms                     | [S0,MB0,B]  132-19-151ms                  | [S0,MB4,F]  151-7-159ms                   | [S0,MB1,B]  189-19-208ms                  | [S0,MB5,F]  208-7-216ms                   | [S0,MB2,B]  250-19-269ms                  | [S0,MB6,F]  269-7-277ms                   | [S0,MB3,B]  313-19-332ms                  | [S0,MB7,F]  332-7-340ms                   | [S0,MB4,B]  376-19-395ms                  | [S0,MB5,B]  438-19-457ms                  | [S0,MB6,B]  500-19-519ms                  | [S0,MB7,B]  562-19-581ms                 
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-10-20ms                     | [S1,MB1,F]  23-9-32ms                     | [S1,MB2,F]  35-9-45ms                     | [S1,MB0,B]  105-21-127ms                  | [S1,MB3,F]  130-9-140ms                   | [S1,MB1,B]  162-21-184ms                  | [S1,MB4,F]  187-9-197ms                   | [S1,MB2,B]  223-21-245ms                  | [S1,MB5,F]  248-9-257ms                   | [S1,MB3,B]  286-21-307ms                  | [S1,MB6,F]  311-9-320ms                   | [S1,MB4,B]  349-21-371ms                  | [S1,MB7,F]  374-9-384ms                   | [S1,MB5,B]  413-21-434ms                  | [S1,MB6,B]  475-21-496ms                  | [S1,MB7,B]  537-21-559ms                 
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms                     | [S2,MB1,F]  32-8-41ms                     | [S2,MB0,B]  89-11-100ms                   | [S2,MB2,F]  104-8-112ms                   | [S2,MB1,B]  146-11-157ms                  | [S2,MB3,F]  161-8-169ms                   | [S2,MB2,B]  207-11-218ms                  | [S2,MB4,F]  222-8-230ms                   | [S2,MB3,B]  269-11-281ms                  | [S2,MB5,F]  284-8-293ms                   | [S2,MB4,B]  333-11-344ms                  | [S2,MB6,F]  348-8-356ms                   | [S2,MB5,B]  396-11-408ms                  | [S2,MB7,F]  411-8-420ms                   | [S2,MB6,B]  460-11-472ms                  | [S2,MB7,B]  523-11-534ms                 
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms                    | [S3,MB0,B]  48-36-85ms                    | [S3,MB1,F]  87-11-98ms                    | [S3,MB1,B]  104-37-142ms                  | [S3,MB2,F]  144-14-159ms                  | [S3,MB2,B]  164-38-203ms                  | [S3,MB3,F]  205-15-220ms                  | [S3,MB3,B]  226-40-266ms                  | [S3,MB4,F]  268-14-282ms                  | [S3,MB4,B]  289-41-330ms                  | [S3,MB5,F]  332-13-345ms                  | [S3,MB5,B]  352-40-393ms                  | [S3,MB6,F]  395-13-409ms                  | [S3,MB6,B]  415-40-455ms                  | [S3,MB7,F]  459-14-473ms                  | [S3,MB7,B]  479-39-519ms                 
[rank3]:2025-11-28 15:19:45,205 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p40_42_dm1/frozen_ratio_history/rank3/251128_1519_stage3_step200.svg
[rank2]:2025-11-28 15:20:35,131 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.7607e-01
[rank3]:2025-11-28 15:20:35,150 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 1.1351e+00
[rank1]:2025-11-28 15:20:35,131 - INFO - Freezing Ratio: [Stage1] 0.20, Threshold: 9.8056e-01
[rank0]:2025-11-28 15:20:35,150 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 5.4260e-01
[rank2]:2025-11-28 15:21:22,770 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 3.3162e+00
[rank3]:2025-11-28 15:21:22,789 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.8823e+00
[rank1]:2025-11-28 15:21:22,781 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 9.6398e-01
[rank0]:2025-11-28 15:21:22,789 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 4.8288e+00
[rank2]:2025-11-28 15:21:47,787 - INFO - Avg. fwd time: 7.7467 / Avg. bwd time: 16.4357 / Avg. batch time: 532.9490 (ms) / GPU bubble ratio: 63.70%
[rank3]:2025-11-28 15:21:47,765 - INFO - Avg. fwd time: 13.5694 / Avg. bwd time: 41.5170 / Avg. batch time: 504.1870 (ms) / GPU bubble ratio: 12.59%
[rank1]:2025-11-28 15:21:47,811 - INFO - Avg. fwd time: 9.4806 / Avg. bwd time: 22.2595 / Avg. batch time: 569.6466 (ms) / GPU bubble ratio: 55.42%
[rank0]:2025-11-28 15:21:47,840 - INFO - Avg. fwd time: 7.8703 / Avg. bwd time: 22.6618 / Avg. batch time: 605.4108 (ms) / GPU bubble ratio: 59.65%
[rank3]:2025-11-28 15:22:12,789 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 1.8457e+00
[rank1]:2025-11-28 15:22:12,769 - INFO - Freezing Ratio: [Stage1] 0.20, Threshold: 2.5020e+00
[rank0]:2025-11-28 15:22:12,788 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 2.3845e+00
[rank2]:2025-11-28 15:22:12,769 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 9.4376e-01
[rank2]:2025-11-28 15:23:00,705 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.2365e+01
[rank3]:2025-11-28 15:23:00,724 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 1.0587e+01
[rank1]:2025-11-28 15:23:00,717 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 3.1880e+00
[rank0]:2025-11-28 15:23:00,724 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.1148e+01
[rank0]:2025-11-28 15:23:42,984 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-28 15:23:47,404 - INFO - Avg. fwd time: 13.5927 / Avg. bwd time: 41.4030 / Avg. batch time: 503.4580 (ms) / GPU bubble ratio: 12.61%
[rank0]:2025-11-28 15:23:47,400 - INFO - Avg. fwd time: 7.9197 / Avg. bwd time: 22.3053 / Avg. batch time: 603.5357 (ms) / GPU bubble ratio: 59.94%
[rank2]:2025-11-28 15:23:47,424 - INFO - Avg. fwd time: 7.8040 / Avg. bwd time: 16.0322 / Avg. batch time: 531.7923 (ms) / GPU bubble ratio: 64.14%
[rank1]:2025-11-28 15:23:47,449 - INFO - Avg. fwd time: 9.5222 / Avg. bwd time: 21.9165 / Avg. batch time: 568.1388 (ms) / GPU bubble ratio: 55.73%
[rank2]:2025-11-28 15:23:47,658 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.1414e+00
[rank2]:2025-11-28 15:23:47,658 - INFO -  step: 250  loss: -8.0000  grad_norm:  2.1481  memory:  6.43GiB(13.53%)  tps: 6,752  tflops: 52.78  mfu: 16.92%
[rank1]:2025-11-28 15:23:47,661 - INFO - Freezing Ratio: [Stage1] 0.20, Threshold: 1.7283e+00
[rank1]:2025-11-28 15:23:47,662 - INFO -  step: 250  loss: -8.0000  grad_norm:  2.1481  memory:  9.03GiB(19.01%)  tps: 6,752  tflops: 52.78  mfu: 16.92%
[rank3]:2025-11-28 15:23:47,677 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.2120e+00
[rank3]:2025-11-28 15:23:47,681 - INFO -  step: 250  loss:  0.4007  grad_norm:  2.1481  memory: 16.39GiB(34.50%)  tps: 6,752  tflops: 52.78  mfu: 16.92%
[rank0]:2025-11-28 15:23:47,673 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 3.2820e+00
[rank0]:2025-11-28 15:23:47,673 - INFO -  step: 250  loss: -8.0000  grad_norm:  2.1481  memory: 12.97GiB(27.31%)  tps: 6,752  tflops: 52.78  mfu: 16.92%
[rank2]:2025-11-28 15:24:33,879 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 6.3634e+00
[rank1]:2025-11-28 15:24:33,891 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.2279e+00
[rank3]:2025-11-28 15:24:33,895 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 4.8601e+00
[rank0]:2025-11-28 15:24:33,899 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.4056e+00
[rank2]:2025-11-28 15:25:20,943 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.5959e+00
[rank1]:2025-11-28 15:25:20,947 - INFO - Freezing Ratio: [Stage1] 0.20, Threshold: 2.9292e+00
[rank3]:2025-11-28 15:25:20,962 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.5945e+00
[rank0]:2025-11-28 15:25:20,958 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 4.2796e+00
[rank3]:2025-11-28 15:25:43,806 - INFO - Avg. fwd time: 13.6561 / Avg. bwd time: 41.0695 / Avg. batch time: 501.2919 (ms) / GPU bubble ratio: 12.66%
[rank0]:2025-11-28 15:25:43,863 - INFO - Avg. fwd time: 7.9794 / Avg. bwd time: 21.8719 / Avg. batch time: 600.1644 (ms) / GPU bubble ratio: 60.21%
[rank2]:2025-11-28 15:25:43,864 - INFO - Avg. fwd time: 7.8678 / Avg. bwd time: 15.5897 / Avg. batch time: 529.1603 (ms) / GPU bubble ratio: 64.54%
[rank1]:2025-11-28 15:25:43,904 - INFO - Avg. fwd time: 9.5605 / Avg. bwd time: 21.6299 / Avg. batch time: 565.2130 (ms) / GPU bubble ratio: 55.85%
[rank0]:2025-11-28 15:26:07,296 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 5.9131e-01
[rank2]:2025-11-28 15:26:07,276 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 6.1830e-01
[rank1]:2025-11-28 15:26:07,288 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.5479e-01
[rank3]:2025-11-28 15:26:07,292 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 2.8210e-01
[rank0]:2025-11-28 15:26:54,359 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 2.0623e+00
[rank2]:2025-11-28 15:26:54,343 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.9888e-01
[rank1]:2025-11-28 15:26:54,347 - INFO - Freezing Ratio: [Stage1] 0.20, Threshold: 7.7029e-01
[rank3]:2025-11-28 15:26:54,363 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.7778e-01
[rank0]:2025-11-28 15:27:35,921 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-28 15:27:40,462 - INFO - Avg. fwd time: 13.7119 / Avg. bwd time: 40.7629 / Avg. batch time: 499.2823 (ms) / GPU bubble ratio: 12.72%
[rank2]:2025-11-28 15:27:40,482 - INFO - Avg. fwd time: 7.9200 / Avg. bwd time: 15.2250 / Avg. batch time: 526.7698 (ms) / GPU bubble ratio: 64.85%
[rank2]:2025-11-28 15:27:40,550 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.3225e+00
[rank2]:2025-11-28 15:27:40,550 - INFO -  step: 300  loss: -8.0000  grad_norm:  0.3788  memory:  6.43GiB(13.53%)  tps: 7,035  tflops: 55.00  mfu: 17.63%
[rank1]:2025-11-28 15:27:40,512 - INFO - Avg. fwd time: 9.5866 / Avg. bwd time: 21.4381 / Avg. batch time: 562.6260 (ms) / GPU bubble ratio: 55.89%
[rank1]:2025-11-28 15:27:40,562 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 6.2753e-02
[rank1]:2025-11-28 15:27:40,562 - INFO -  step: 300  loss: -8.0000  grad_norm:  0.3788  memory:  9.03GiB(19.01%)  tps: 7,035  tflops: 54.99  mfu: 17.63%
[rank3]:2025-11-28 15:27:40,565 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 1.3577e+00
[rank3]:2025-11-28 15:27:40,569 - INFO -  step: 300  loss:  0.2884  grad_norm:  0.3788  memory: 16.39GiB(34.50%)  tps: 7,035  tflops: 55.00  mfu: 17.63%
[rank0]:2025-11-28 15:27:40,539 - INFO - Avg. fwd time: 8.0256 / Avg. bwd time: 21.5365 / Avg. batch time: 597.2370 (ms) / GPU bubble ratio: 60.40%
[rank0]:2025-11-28 15:27:40,569 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 4.7830e-01
[rank0]:2025-11-28 15:27:40,570 - INFO -  step: 300  loss: -8.0000  grad_norm:  0.3788  memory: 12.97GiB(27.31%)  tps: 7,035  tflops: 55.00  mfu: 17.63%
[rank0]:2025-11-28 15:27:40,622 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p40_42_dm1/frozen_ratio_history/rank0/251128_1527_stage0_step300.svg
[rank2]:2025-11-28 15:27:40,622 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p40_42_dm1/frozen_ratio_history/rank2/251128_1527_stage2_step300.svg
[rank1]:2025-11-28 15:27:40,621 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p40_42_dm1/frozen_ratio_history/rank1/251128_1527_stage1_step300.svg
[rank3]:2025-11-28 15:27:40,710 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p40_42_dm1/pipeline_schedule/251128_1527_real_step300_rank3.svg
[rank3]:			> Batch Time: 565.08 ms, GPU Bubble Ratio: 61.06%, 55.95%, 71.81%, 27.78%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms                       | [S0,MB1,F]  9-8-18ms                      | [S0,MB2,F]  18-8-27ms                     | [S0,MB3,F]  27-8-35ms                     | [S0,MB0,B]  130-19-149ms                  | [S0,MB4,F]  149-7-157ms                   | [S0,MB1,B]  184-19-203ms                  | [S0,MB5,F]  203-7-211ms                   | [S0,MB2,B]  243-19-262ms                  | [S0,MB6,F]  262-7-270ms                   | [S0,MB3,B]  304-19-323ms                  | [S0,MB7,F]  323-7-331ms                   | [S0,MB4,B]  366-19-385ms                  | [S0,MB5,B]  426-19-445ms                  | [S0,MB6,B]  485-19-504ms                  | [S0,MB7,B]  546-19-565ms                 
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms                     | [S1,MB1,F]  23-9-33ms                     | [S1,MB2,F]  36-9-45ms                     | [S1,MB0,B]  103-21-125ms                  | [S1,MB3,F]  128-9-137ms                   | [S1,MB1,B]  157-21-179ms                  | [S1,MB4,F]  182-9-192ms                   | [S1,MB2,B]  216-21-238ms                  | [S1,MB5,F]  241-9-251ms                   | [S1,MB3,B]  277-21-299ms                  | [S1,MB6,F]  302-9-312ms                   | [S1,MB4,B]  339-21-361ms                  | [S1,MB7,F]  364-9-374ms                   | [S1,MB5,B]  401-21-422ms                  | [S1,MB6,B]  460-21-482ms                  | [S1,MB7,B]  521-21-542ms                 
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms                     | [S2,MB1,F]  33-8-41ms                     | [S2,MB0,B]  87-11-98ms                    | [S2,MB2,F]  101-8-110ms                   | [S2,MB1,B]  141-11-152ms                  | [S2,MB3,F]  156-8-164ms                   | [S2,MB2,B]  200-11-211ms                  | [S2,MB4,F]  215-8-223ms                   | [S2,MB3,B]  261-11-272ms                  | [S2,MB5,F]  276-8-284ms                   | [S2,MB4,B]  323-11-334ms                  | [S2,MB6,F]  338-8-346ms                   | [S2,MB5,B]  384-11-396ms                  | [S2,MB7,F]  399-8-408ms                   | [S2,MB6,B]  446-11-457ms                  | [S2,MB7,B]  506-11-518ms                 
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-43ms                    | [S3,MB0,B]  48-34-83ms                    | [S3,MB1,F]  85-11-97ms                    | [S3,MB1,B]  102-34-137ms                  | [S3,MB2,F]  139-14-154ms                  | [S3,MB2,B]  160-35-196ms                  | [S3,MB3,F]  198-16-214ms                  | [S3,MB3,B]  220-36-257ms                  | [S3,MB4,F]  259-16-275ms                  | [S3,MB4,B]  281-37-318ms                  | [S3,MB5,F]  321-15-337ms                  | [S3,MB5,B]  343-37-380ms                  | [S3,MB6,F]  383-15-398ms                  | [S3,MB6,B]  404-37-441ms                  | [S3,MB7,F]  444-14-459ms                  | [S3,MB7,B]  465-37-503ms                 
[rank3]:2025-11-28 15:27:40,756 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p40_42_dm1/frozen_ratio_history/rank3/251128_1527_stage3_step300.svg
[rank2]:2025-11-28 15:28:27,718 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.5788e-01
[rank1]:2025-11-28 15:28:27,722 - INFO - Freezing Ratio: [Stage1] 0.20, Threshold: 2.7829e-01
[rank3]:2025-11-28 15:28:27,738 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.7612e-01
[rank0]:2025-11-28 15:28:27,733 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 7.0835e-01
[rank2]:2025-11-28 15:29:14,078 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.1205e+00
[rank1]:2025-11-28 15:29:14,089 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 2.2246e-01
[rank3]:2025-11-28 15:29:14,094 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 9.6109e-01
[rank0]:2025-11-28 15:29:14,098 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 7.3981e-01
[rank3]:2025-11-28 15:29:37,260 - INFO - Avg. fwd time: 13.7432 / Avg. bwd time: 40.5831 / Avg. batch time: 498.0929 (ms) / GPU bubble ratio: 12.75%
[rank0]:2025-11-28 15:29:37,255 - INFO - Avg. fwd time: 8.0647 / Avg. bwd time: 21.2600 / Avg. batch time: 595.3221 (ms) / GPU bubble ratio: 60.59%
[rank2]:2025-11-28 15:29:37,279 - INFO - Avg. fwd time: 7.9589 / Avg. bwd time: 14.9597 / Avg. batch time: 525.3415 (ms) / GPU bubble ratio: 65.10%
[rank1]:2025-11-28 15:29:37,304 - INFO - Avg. fwd time: 9.6142 / Avg. bwd time: 21.2339 / Avg. batch time: 560.9913 (ms) / GPU bubble ratio: 56.01%
[rank2]:2025-11-28 15:30:01,242 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.6006e-01
[rank1]:2025-11-28 15:30:01,245 - INFO - Freezing Ratio: [Stage1] 0.20, Threshold: 6.3635e-01
[rank3]:2025-11-28 15:30:01,261 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.3120e-01
[rank0]:2025-11-28 15:30:01,257 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.6477e+00
[rank0]:2025-11-28 15:30:47,563 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.0275e+00
[rank2]:2025-11-28 15:30:47,544 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.8852e+00
[rank1]:2025-11-28 15:30:47,555 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 2.3343e-01
[rank3]:2025-11-28 15:30:47,559 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 2.5235e+00
[rank0]:2025-11-28 15:31:29,862 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-28 15:31:34,307 - INFO - Avg. fwd time: 13.7688 / Avg. bwd time: 40.4193 / Avg. batch time: 496.9836 (ms) / GPU bubble ratio: 12.77%
[rank0]:2025-11-28 15:31:34,300 - INFO - Avg. fwd time: 8.1058 / Avg. bwd time: 20.9699 / Avg. batch time: 593.4026 (ms) / GPU bubble ratio: 60.80%
[rank2]:2025-11-28 15:31:34,323 - INFO - Avg. fwd time: 7.9978 / Avg. bwd time: 14.6932 / Avg. batch time: 523.9503 (ms) / GPU bubble ratio: 65.35%
[rank1]:2025-11-28 15:31:34,348 - INFO - Avg. fwd time: 9.6441 / Avg. bwd time: 21.0033 / Avg. batch time: 559.3665 (ms) / GPU bubble ratio: 56.17%
[rank2]:2025-11-28 15:31:34,556 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 7.0453e-01
[rank2]:2025-11-28 15:31:34,556 - INFO -  step: 350  loss: -8.0000  grad_norm:  0.2953  memory:  6.43GiB(13.53%)  tps: 7,002  tflops: 54.73  mfu: 17.54%
[rank1]:2025-11-28 15:31:34,560 - INFO - Freezing Ratio: [Stage1] 0.20, Threshold: 4.3149e-01
[rank1]:2025-11-28 15:31:34,560 - INFO -  step: 350  loss: -8.0000  grad_norm:  0.2953  memory:  9.03GiB(19.01%)  tps: 7,002  tflops: 54.74  mfu: 17.54%
[rank3]:2025-11-28 15:31:34,576 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.8982e-01
[rank3]:2025-11-28 15:31:34,579 - INFO -  step: 350  loss:  0.2388  grad_norm:  0.2953  memory: 16.39GiB(34.50%)  tps: 7,001  tflops: 54.73  mfu: 17.54%
[rank0]:2025-11-28 15:31:34,571 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 6.0405e-01
[rank0]:2025-11-28 15:31:34,572 - INFO -  step: 350  loss: -8.0000  grad_norm:  0.2953  memory: 12.97GiB(27.31%)  tps: 7,002  tflops: 54.74  mfu: 17.54%
[rank0]:2025-11-28 15:32:20,893 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1996e+00
[rank2]:2025-11-28 15:32:20,874 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.5568e+00
[rank1]:2025-11-28 15:32:20,885 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 4.6539e-01
[rank3]:2025-11-28 15:32:20,889 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 3.0178e+00
[rank2]:2025-11-28 15:33:07,965 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 8.6758e-01
[rank1]:2025-11-28 15:33:07,969 - INFO - Freezing Ratio: [Stage1] 0.20, Threshold: 1.1671e+00
[rank3]:2025-11-28 15:33:07,984 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 3.1417e-01
[rank0]:2025-11-28 15:33:07,980 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.6330e+00
[rank2]:2025-11-28 15:33:31,039 - INFO - Avg. fwd time: 8.0314 / Avg. bwd time: 14.4638 / Avg. batch time: 522.4988 (ms) / GPU bubble ratio: 65.56%
[rank3]:2025-11-28 15:33:31,018 - INFO - Avg. fwd time: 13.8035 / Avg. bwd time: 40.2338 / Avg. batch time: 495.7743 (ms) / GPU bubble ratio: 12.80%
[rank0]:2025-11-28 15:33:31,097 - INFO - Avg. fwd time: 8.1363 / Avg. bwd time: 20.7553 / Avg. batch time: 591.6045 (ms) / GPU bubble ratio: 60.93%
[rank1]:2025-11-28 15:33:31,069 - INFO - Avg. fwd time: 9.6621 / Avg. bwd time: 20.8752 / Avg. batch time: 557.7845 (ms) / GPU bubble ratio: 56.20%
[rank0]:2025-11-28 15:33:54,226 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 6.4462e-01
[rank2]:2025-11-28 15:33:54,206 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 7.8291e-01
[rank1]:2025-11-28 15:33:54,218 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 2.1363e-01
[rank3]:2025-11-28 15:33:54,222 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 8.0064e-01
[rank0]:2025-11-28 15:34:41,285 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.6086e+00
[rank2]:2025-11-28 15:34:41,270 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.3755e+00
[rank1]:2025-11-28 15:34:41,274 - INFO - Freezing Ratio: [Stage1] 0.20, Threshold: 1.6111e+00
[rank3]:2025-11-28 15:34:41,289 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 4.4760e-01
[rank0]:2025-11-28 15:35:22,921 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-28 15:35:27,261 - INFO - Avg. fwd time: 13.8264 / Avg. bwd time: 40.0946 / Avg. batch time: 494.8423 (ms) / GPU bubble ratio: 12.83%
[rank0]:2025-11-28 15:35:27,319 - INFO - Avg. fwd time: 8.1597 / Avg. bwd time: 20.5912 / Avg. batch time: 590.2213 (ms) / GPU bubble ratio: 61.03%
[rank2]:2025-11-28 15:35:27,322 - INFO - Avg. fwd time: 8.0565 / Avg. bwd time: 14.2910 / Avg. batch time: 521.3835 (ms) / GPU bubble ratio: 65.71%
[rank1]:2025-11-28 15:35:27,365 - INFO - Avg. fwd time: 9.6759 / Avg. bwd time: 20.7740 / Avg. batch time: 556.5659 (ms) / GPU bubble ratio: 56.23%
[rank2]:2025-11-28 15:35:27,562 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.6311e-01
[rank2]:2025-11-28 15:35:27,562 - INFO -  step: 400  loss: -8.0000  grad_norm:  0.5155  memory:  6.43GiB(13.53%)  tps: 7,032  tflops: 54.97  mfu: 17.62%
[rank1]:2025-11-28 15:35:27,573 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 5.2767e-02
[rank1]:2025-11-28 15:35:27,574 - INFO -  step: 400  loss: -8.0000  grad_norm:  0.5155  memory:  9.03GiB(19.01%)  tps: 7,031  tflops: 54.97  mfu: 17.62%
[rank3]:2025-11-28 15:35:27,577 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 3.3285e-01
[rank3]:2025-11-28 15:35:27,581 - INFO -  step: 400  loss:  0.2260  grad_norm:  0.5155  memory: 16.39GiB(34.50%)  tps: 7,032  tflops: 54.97  mfu: 17.62%
[rank0]:2025-11-28 15:35:27,581 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.7965e-01
[rank0]:2025-11-28 15:35:27,582 - INFO -  step: 400  loss: -8.0000  grad_norm:  0.5155  memory: 12.97GiB(27.31%)  tps: 7,031  tflops: 54.97  mfu: 17.62%
[rank0]:2025-11-28 15:35:27,639 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p40_42_dm1/frozen_ratio_history/rank0/251128_1535_stage0_step400.svg
[rank2]:2025-11-28 15:35:27,639 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p40_42_dm1/frozen_ratio_history/rank2/251128_1535_stage2_step400.svg
[rank1]:2025-11-28 15:35:27,638 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p40_42_dm1/frozen_ratio_history/rank1/251128_1535_stage1_step400.svg
[rank3]:2025-11-28 15:35:27,727 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p40_42_dm1/pipeline_schedule/251128_1535_real_step400_rank3.svg
[rank3]:			> Batch Time: 564.06 ms, GPU Bubble Ratio: 61.03%, 55.90%, 71.81%, 27.65%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms                       | [S0,MB1,F]  9-8-18ms                      | [S0,MB2,F]  18-8-27ms                     | [S0,MB3,F]  27-8-35ms                     | [S0,MB0,B]  130-19-149ms                  | [S0,MB4,F]  149-7-157ms                   | [S0,MB1,B]  184-19-203ms                  | [S0,MB5,F]  203-7-211ms                   | [S0,MB2,B]  243-19-262ms                  | [S0,MB6,F]  262-7-269ms                   | [S0,MB3,B]  304-19-323ms                  | [S0,MB7,F]  323-7-331ms                   | [S0,MB4,B]  365-19-384ms                  | [S0,MB5,B]  425-19-444ms                  | [S0,MB6,B]  485-19-504ms                  | [S0,MB7,B]  545-19-564ms                 
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms                     | [S1,MB1,F]  23-9-32ms                     | [S1,MB2,F]  36-9-45ms                     | [S1,MB0,B]  103-21-124ms                  | [S1,MB3,F]  128-9-137ms                   | [S1,MB1,B]  157-21-179ms                  | [S1,MB4,F]  182-9-192ms                   | [S1,MB2,B]  216-21-237ms                  | [S1,MB5,F]  241-9-251ms                   | [S1,MB3,B]  277-21-299ms                  | [S1,MB6,F]  302-9-311ms                   | [S1,MB4,B]  339-21-360ms                  | [S1,MB7,F]  364-9-373ms                   | [S1,MB5,B]  400-21-421ms                  | [S1,MB6,B]  460-21-481ms                  | [S1,MB7,B]  519-21-541ms                 
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms                     | [S2,MB1,F]  32-8-41ms                     | [S2,MB0,B]  86-11-98ms                    | [S2,MB2,F]  101-8-110ms                   | [S2,MB1,B]  141-11-152ms                  | [S2,MB3,F]  156-8-164ms                   | [S2,MB2,B]  199-11-211ms                  | [S2,MB4,F]  214-8-223ms                   | [S2,MB3,B]  261-11-272ms                  | [S2,MB5,F]  275-8-284ms                   | [S2,MB4,B]  322-11-333ms                  | [S2,MB6,F]  337-8-345ms                   | [S2,MB5,B]  383-11-395ms                  | [S2,MB7,F]  398-8-407ms                   | [S2,MB6,B]  445-11-457ms                  | [S2,MB7,B]  505-11-516ms                 
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms                    | [S3,MB0,B]  48-34-82ms                    | [S3,MB1,F]  85-11-96ms                    | [S3,MB1,B]  102-34-137ms                  | [S3,MB2,F]  139-14-154ms                  | [S3,MB2,B]  160-35-196ms                  | [S3,MB3,F]  198-16-214ms                  | [S3,MB3,B]  220-36-257ms                  | [S3,MB4,F]  259-16-275ms                  | [S3,MB4,B]  281-37-318ms                  | [S3,MB5,F]  320-15-336ms                  | [S3,MB5,B]  342-37-380ms                  | [S3,MB6,F]  382-15-397ms                  | [S3,MB6,B]  403-37-441ms                  | [S3,MB7,F]  443-14-458ms                  | [S3,MB7,B]  464-37-502ms                 
[rank3]:2025-11-28 15:35:27,777 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p40_42_dm1/frozen_ratio_history/rank3/251128_1535_stage3_step400.svg
[rank3]:2025-11-28 15:35:54,409 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-11-28 15:35:54,625 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-11-28 15:35:54,643 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-11-28 15:35:54,662 - WARNING - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-11-28 15:36:14,726 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 9.0811e-01
[rank1]:2025-11-28 15:36:14,729 - INFO - Freezing Ratio: [Stage1] 0.20, Threshold: 2.8029e-01
[rank3]:2025-11-28 15:36:14,745 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 4.5966e-01
[rank0]:2025-11-28 15:36:14,742 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 4.2129e-01
[rank3]:2025-11-28 15:37:01,056 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 2.6882e-01
[rank0]:2025-11-28 15:37:01,059 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.6593e-01
[rank2]:2025-11-28 15:37:01,040 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.1157e-01
[rank1]:2025-11-28 15:37:01,052 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.2717e-01
[rank0]:2025-11-28 15:37:24,315 - INFO - Avg. fwd time: 8.1858 / Avg. bwd time: 20.4087 / Avg. batch time: 588.9082 (ms) / GPU bubble ratio: 61.16%
[rank2]:2025-11-28 15:37:24,337 - INFO - Avg. fwd time: 8.0828 / Avg. bwd time: 14.1122 / Avg. batch time: 520.3890 (ms) / GPU bubble ratio: 65.88%
[rank1]:2025-11-28 15:37:24,361 - INFO - Avg. fwd time: 9.6943 / Avg. bwd time: 20.6433 / Avg. batch time: 555.4382 (ms) / GPU bubble ratio: 56.30%
[rank3]:2025-11-28 15:37:24,317 - INFO - Avg. fwd time: 13.8493 / Avg. bwd time: 39.9675 / Avg. batch time: 494.0061 (ms) / GPU bubble ratio: 12.85%
[rank1]:2025-11-28 15:37:47,890 - INFO - Freezing Ratio: [Stage1] 0.20, Threshold: 1.2630e+00
[rank3]:2025-11-28 15:37:47,906 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 3.7232e-01
[rank0]:2025-11-28 15:37:47,902 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.0961e+00
[rank2]:2025-11-28 15:37:47,887 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.2749e+00
[rank0]:2025-11-28 15:38:34,204 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 8.0734e-01
[rank2]:2025-11-28 15:38:34,185 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 6.4350e-01
[rank1]:2025-11-28 15:38:34,196 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 4.1023e-01
[rank3]:2025-11-28 15:38:34,200 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 9.0880e-01
[rank0]:2025-11-28 15:39:16,524 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-28 15:39:21,134 - INFO - Avg. fwd time: 13.8614 / Avg. bwd time: 39.8713 / Avg. batch time: 493.3311 (ms) / GPU bubble ratio: 12.87%
[rank2]:2025-11-28 15:39:21,155 - INFO - Avg. fwd time: 8.1056 / Avg. bwd time: 13.9544 / Avg. batch time: 519.5464 (ms) / GPU bubble ratio: 66.03%
[rank1]:2025-11-28 15:39:21,181 - INFO - Avg. fwd time: 9.7131 / Avg. bwd time: 20.4982 / Avg. batch time: 554.4499 (ms) / GPU bubble ratio: 56.41%
[rank3]:2025-11-28 15:39:21,236 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 8.7382e-01
[rank3]:2025-11-28 15:39:21,240 - INFO -  step: 450  loss:  0.2430  grad_norm:  0.2616  memory: 16.39GiB(34.50%)  tps: 7,012  tflops: 54.82  mfu: 17.57%
[rank0]:2025-11-28 15:39:21,207 - INFO - Avg. fwd time: 8.2103 / Avg. bwd time: 20.2327 / Avg. batch time: 587.7413 (ms) / GPU bubble ratio: 61.29%
[rank0]:2025-11-28 15:39:21,232 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.3935e+00
[rank0]:2025-11-28 15:39:21,233 - INFO -  step: 450  loss: -8.0000  grad_norm:  0.2616  memory: 12.97GiB(27.31%)  tps: 7,012  tflops: 54.82  mfu: 17.57%
[rank2]:2025-11-28 15:39:21,217 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.4978e+00
[rank2]:2025-11-28 15:39:21,217 - INFO -  step: 450  loss: -8.0000  grad_norm:  0.2616  memory:  6.43GiB(13.53%)  tps: 7,012  tflops: 54.82  mfu: 17.57%
[rank1]:2025-11-28 15:39:21,221 - INFO - Freezing Ratio: [Stage1] 0.20, Threshold: 1.3412e+00
[rank1]:2025-11-28 15:39:21,221 - INFO -  step: 450  loss: -8.0000  grad_norm:  0.2616  memory:  9.03GiB(19.01%)  tps: 7,012  tflops: 54.82  mfu: 17.57%
[rank2]:2025-11-28 15:40:07,451 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.8620e-01
[rank1]:2025-11-28 15:40:07,463 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.3827e-01
[rank3]:2025-11-28 15:40:07,466 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 4.4939e-01
[rank0]:2025-11-28 15:40:07,470 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.0611e-01
[rank2]:2025-11-28 15:40:54,402 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.3896e+00
[rank1]:2025-11-28 15:40:54,405 - INFO - Freezing Ratio: [Stage1] 0.20, Threshold: 2.4027e+00
[rank3]:2025-11-28 15:40:54,421 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.3951e+00
[rank0]:2025-11-28 15:40:54,417 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 2.6963e+00
[rank3]:2025-11-28 15:41:17,180 - INFO - Avg. fwd time: 13.8785 / Avg. bwd time: 39.7719 / Avg. batch time: 492.6720 (ms) / GPU bubble ratio: 12.88%
[rank2]:2025-11-28 15:41:17,239 - INFO - Avg. fwd time: 8.1233 / Avg. bwd time: 13.8327 / Avg. batch time: 518.7562 (ms) / GPU bubble ratio: 66.14%
[rank0]:2025-11-28 15:41:17,238 - INFO - Avg. fwd time: 8.2267 / Avg. bwd time: 20.1193 / Avg. batch time: 586.7653 (ms) / GPU bubble ratio: 61.35%
[rank1]:2025-11-28 15:41:17,280 - INFO - Avg. fwd time: 9.7226 / Avg. bwd time: 20.4305 / Avg. batch time: 553.5894 (ms) / GPU bubble ratio: 56.43%
[rank3]:2025-11-28 15:41:40,617 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 1.1231e+00
[rank0]:2025-11-28 15:41:40,620 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 8.3512e-01
[rank2]:2025-11-28 15:41:40,601 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.5248e+00
[rank1]:2025-11-28 15:41:40,613 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 2.7744e-01
[rank2]:2025-11-28 15:42:27,727 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.8981e+00
[rank1]:2025-11-28 15:42:27,730 - INFO - Freezing Ratio: [Stage1] 0.20, Threshold: 2.5746e+00
[rank3]:2025-11-28 15:42:27,746 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 9.1072e-01
[rank0]:2025-11-28 15:42:27,742 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.9122e+00
[rank0]:2025-11-28 15:43:09,374 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-28 15:43:13,695 - INFO - Avg. fwd time: 13.8994 / Avg. bwd time: 39.6568 / Avg. batch time: 491.9169 (ms) / GPU bubble ratio: 12.90%
[rank0]:2025-11-28 15:43:13,752 - INFO - Avg. fwd time: 8.2428 / Avg. bwd time: 20.0091 / Avg. batch time: 585.7075 (ms) / GPU bubble ratio: 61.41%
[rank2]:2025-11-28 15:43:13,758 - INFO - Avg. fwd time: 8.1417 / Avg. bwd time: 13.7047 / Avg. batch time: 517.8631 (ms) / GPU bubble ratio: 66.25%
[rank1]:2025-11-28 15:43:13,799 - INFO - Avg. fwd time: 9.7298 / Avg. bwd time: 20.3770 / Avg. batch time: 552.6410 (ms) / GPU bubble ratio: 56.42%
[rank2]:2025-11-28 15:43:13,994 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.8273e+00
[rank2]:2025-11-28 15:43:13,994 - INFO -  step: 500  loss: -8.0000  grad_norm:  0.2933  memory:  6.43GiB(13.53%)  tps: 7,039  tflops: 55.02  mfu: 17.64%
[rank1]:2025-11-28 15:43:14,006 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 8.0414e-01
[rank1]:2025-11-28 15:43:14,006 - INFO -  step: 500  loss: -8.0000  grad_norm:  0.2933  memory:  9.03GiB(19.01%)  tps: 7,038  tflops: 55.02  mfu: 17.64%
[rank3]:2025-11-28 15:43:14,009 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 2.1060e+00
[rank3]:2025-11-28 15:43:14,013 - INFO -  step: 500  loss:  0.2320  grad_norm:  0.2933  memory: 16.39GiB(34.50%)  tps: 7,039  tflops: 55.03  mfu: 17.64%
[rank0]:2025-11-28 15:43:14,014 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1245e+00
[rank0]:2025-11-28 15:43:14,014 - INFO -  step: 500  loss: -8.0000  grad_norm:  0.2933  memory: 12.97GiB(27.31%)  tps: 7,038  tflops: 55.02  mfu: 17.64%
[rank0]:2025-11-28 15:43:14,066 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p40_42_dm1/frozen_ratio_history/rank0/251128_1543_stage0_step500.svg
[rank2]:2025-11-28 15:43:14,073 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p40_42_dm1/frozen_ratio_history/rank2/251128_1543_stage2_step500.svg
[rank1]:2025-11-28 15:43:14,065 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p40_42_dm1/frozen_ratio_history/rank1/251128_1543_stage1_step500.svg
[rank3]:2025-11-28 15:43:14,161 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p40_42_dm1/pipeline_schedule/251128_1543_real_step500_rank3.svg
[rank3]:			> Batch Time: 565.56 ms, GPU Bubble Ratio: 61.03%, 55.99%, 71.85%, 27.48%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms                       | [S0,MB1,F]  9-8-18ms                      | [S0,MB2,F]  18-8-27ms                     | [S0,MB3,F]  27-8-35ms                     | [S0,MB0,B]  130-19-149ms                  | [S0,MB4,F]  149-8-157ms                   | [S0,MB1,B]  184-19-203ms                  | [S0,MB5,F]  204-7-211ms                   | [S0,MB2,B]  243-19-262ms                  | [S0,MB6,F]  262-7-270ms                   | [S0,MB3,B]  304-19-323ms                  | [S0,MB7,F]  323-7-331ms                   | [S0,MB4,B]  367-19-386ms                  | [S0,MB5,B]  427-19-446ms                  | [S0,MB6,B]  486-19-505ms                  | [S0,MB7,B]  546-19-565ms                 
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms                     | [S1,MB1,F]  23-9-33ms                     | [S1,MB2,F]  36-9-45ms                     | [S1,MB0,B]  103-21-125ms                  | [S1,MB3,F]  128-9-138ms                   | [S1,MB1,B]  158-21-179ms                  | [S1,MB4,F]  183-9-192ms                   | [S1,MB2,B]  216-21-238ms                  | [S1,MB5,F]  241-9-251ms                   | [S1,MB3,B]  278-21-299ms                  | [S1,MB6,F]  303-9-312ms                   | [S1,MB4,B]  340-21-361ms                  | [S1,MB7,F]  365-9-374ms                   | [S1,MB5,B]  402-21-423ms                  | [S1,MB6,B]  461-21-483ms                  | [S1,MB7,B]  521-21-543ms                 
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms                     | [S2,MB1,F]  33-8-41ms                     | [S2,MB0,B]  87-11-98ms                    | [S2,MB2,F]  102-8-110ms                   | [S2,MB1,B]  141-11-153ms                  | [S2,MB3,F]  156-8-165ms                   | [S2,MB2,B]  200-11-211ms                  | [S2,MB4,F]  215-8-223ms                   | [S2,MB3,B]  261-11-273ms                  | [S2,MB5,F]  276-8-284ms                   | [S2,MB4,B]  324-11-335ms                  | [S2,MB6,F]  339-8-347ms                   | [S2,MB5,B]  385-11-397ms                  | [S2,MB7,F]  400-8-409ms                   | [S2,MB6,B]  447-11-458ms                  | [S2,MB7,B]  507-11-518ms                 
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-43ms                    | [S3,MB0,B]  49-34-83ms                    | [S3,MB1,F]  85-11-97ms                    | [S3,MB1,B]  103-34-137ms                  | [S3,MB2,F]  140-14-154ms                  | [S3,MB2,B]  160-35-196ms                  | [S3,MB3,F]  198-16-214ms                  | [S3,MB3,B]  220-36-257ms                  | [S3,MB4,F]  260-16-276ms                  | [S3,MB4,B]  282-37-319ms                  | [S3,MB5,F]  322-15-338ms                  | [S3,MB5,B]  343-37-381ms                  | [S3,MB6,F]  384-14-399ms                  | [S3,MB6,B]  405-38-443ms                  | [S3,MB7,F]  445-14-459ms                  | [S3,MB7,B]  466-37-503ms                 
[rank3]:2025-11-28 15:43:14,207 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p40_42_dm1/frozen_ratio_history/rank3/251128_1543_stage3_step500.svg
[rank2]:2025-11-28 15:44:01,085 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.8054e-01
[rank1]:2025-11-28 15:44:01,089 - INFO - Freezing Ratio: [Stage1] 0.20, Threshold: 3.6465e-01
[rank3]:2025-11-28 15:44:01,105 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.8054e-01
[rank0]:2025-11-28 15:44:01,101 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 6.8450e-01
[rank2]:2025-11-28 15:44:47,349 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.1266e+00
[rank3]:2025-11-28 15:44:47,364 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 1.8714e+00
[rank0]:2025-11-28 15:44:47,368 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 6.4774e-01
[rank1]:2025-11-28 15:44:47,361 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 4.4145e-01
[rank3]:2025-11-28 15:45:10,693 - INFO - Avg. fwd time: 13.9073 / Avg. bwd time: 39.5801 / Avg. batch time: 491.3660 (ms) / GPU bubble ratio: 12.92%
[rank2]:2025-11-28 15:45:10,715 - INFO - Avg. fwd time: 8.1582 / Avg. bwd time: 13.5894 / Avg. batch time: 517.2157 (ms) / GPU bubble ratio: 66.36%
[rank1]:2025-11-28 15:45:10,742 - INFO - Avg. fwd time: 9.7428 / Avg. bwd time: 20.2786 / Avg. batch time: 551.8950 (ms) / GPU bubble ratio: 56.48%
[rank0]:2025-11-28 15:45:10,769 - INFO - Avg. fwd time: 8.2607 / Avg. bwd time: 19.8847 / Avg. batch time: 584.8363 (ms) / GPU bubble ratio: 61.50%
[rank2]:2025-11-28 15:45:34,297 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.9190e+00
[rank1]:2025-11-28 15:45:34,301 - INFO - Freezing Ratio: [Stage1] 0.20, Threshold: 3.0763e+00
[rank3]:2025-11-28 15:45:34,317 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.1008e+00
[rank0]:2025-11-28 15:45:34,313 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 2.3565e+00
[rank2]:2025-11-28 15:46:20,468 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.3123e+00
[rank3]:2025-11-28 15:46:20,484 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 1.5394e+00
[rank0]:2025-11-28 15:46:20,487 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 4.5069e-01
[rank1]:2025-11-28 15:46:20,480 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.9077e-01
[rank0]:2025-11-28 15:47:02,750 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-11-28 15:47:07,203 - INFO - Avg. fwd time: 8.1714 / Avg. bwd time: 13.4993 / Avg. batch time: 516.7039 (ms) / GPU bubble ratio: 66.45%
[rank1]:2025-11-28 15:47:07,227 - INFO - Avg. fwd time: 9.7525 / Avg. bwd time: 20.2051 / Avg. batch time: 551.3090 (ms) / GPU bubble ratio: 56.53%
[rank3]:2025-11-28 15:47:07,183 - INFO - Avg. fwd time: 13.9170 / Avg. bwd time: 39.5188 / Avg. batch time: 490.9521 (ms) / GPU bubble ratio: 12.93%
[rank0]:2025-11-28 15:47:07,179 - INFO - Avg. fwd time: 8.2745 / Avg. bwd time: 19.7894 / Avg. batch time: 584.1532 (ms) / GPU bubble ratio: 61.57%
[rank0]:2025-11-28 15:47:07,454 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 3.7656e-01
[rank0]:2025-11-28 15:47:07,454 - INFO -  step: 550  loss: -8.0000  grad_norm:  0.4889  memory: 12.97GiB(27.31%)  tps: 7,019  tflops: 54.87  mfu: 17.59%
[rank2]:2025-11-28 15:47:07,438 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 9.0092e-01
[rank2]:2025-11-28 15:47:07,439 - INFO -  step: 550  loss: -8.0000  grad_norm:  0.4889  memory:  6.43GiB(13.53%)  tps: 7,018  tflops: 54.87  mfu: 17.59%
[rank1]:2025-11-28 15:47:07,442 - INFO - Freezing Ratio: [Stage1] 0.20, Threshold: 6.0723e-01
[rank1]:2025-11-28 15:47:07,442 - INFO -  step: 550  loss: -8.0000  grad_norm:  0.4889  memory:  9.03GiB(19.01%)  tps: 7,019  tflops: 54.87  mfu: 17.59%
[rank3]:2025-11-28 15:47:07,458 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 3.1118e-01
[rank3]:2025-11-28 15:47:07,461 - INFO -  step: 550  loss:  0.2400  grad_norm:  0.4889  memory: 16.39GiB(34.50%)  tps: 7,018  tflops: 54.87  mfu: 17.59%
[rank2]:2025-11-28 15:47:53,792 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.7219e+00
[rank1]:2025-11-28 15:47:53,803 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 4.5043e-01
[rank0]:2025-11-28 15:47:53,811 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.4795e+00
[rank3]:2025-11-28 15:47:53,807 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 1.7500e+00
[rank1]:2025-11-28 15:48:40,777 - INFO - Freezing Ratio: [Stage1] 0.20, Threshold: 1.9319e+00
[rank3]:2025-11-28 15:48:40,793 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.1125e-01
[rank2]:2025-11-28 15:48:40,774 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.0374e+00
[rank0]:2025-11-28 15:48:40,789 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 2.2004e+00
[rank3]:2025-11-28 15:49:03,572 - INFO - Avg. fwd time: 13.9292 / Avg. bwd time: 39.4423 / Avg. batch time: 490.4365 (ms) / GPU bubble ratio: 12.94%
[rank1]:2025-11-28 15:49:03,675 - INFO - Avg. fwd time: 9.7608 / Avg. bwd time: 20.1458 / Avg. batch time: 550.6295 (ms) / GPU bubble ratio: 56.55%
[rank2]:2025-11-28 15:49:03,634 - INFO - Avg. fwd time: 8.1852 / Avg. bwd time: 13.4030 / Avg. batch time: 516.0835 (ms) / GPU bubble ratio: 66.54%
[rank0]:2025-11-28 15:49:03,627 - INFO - Avg. fwd time: 8.2878 / Avg. bwd time: 19.6969 / Avg. batch time: 583.3797 (ms) / GPU bubble ratio: 61.62%
[rank1]:2025-11-28 15:49:26,988 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.6444e-01
[rank3]:2025-11-28 15:49:26,992 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 1.4455e+00
[rank2]:2025-11-28 15:49:26,976 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.2198e+00
[rank0]:2025-11-28 15:49:26,996 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 5.7272e-01
[rank1]:2025-11-28 15:50:14,019 - INFO - Freezing Ratio: [Stage1] 0.20, Threshold: 1.6657e+00
[rank3]:2025-11-28 15:50:14,035 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 3.9110e-01
[rank2]:2025-11-28 15:50:14,015 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.3705e+00
[rank0]:2025-11-28 15:50:14,030 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 2.2961e+00
[rank0]:2025-11-28 15:50:55,596 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-28 15:51:00,236 - INFO - Avg. fwd time: 9.7659 / Avg. bwd time: 20.1137 / Avg. batch time: 549.9701 (ms) / GPU bubble ratio: 56.54%
[rank3]:2025-11-28 15:51:00,180 - INFO - Avg. fwd time: 13.9430 / Avg. bwd time: 39.3620 / Avg. batch time: 489.9027 (ms) / GPU bubble ratio: 12.95%
[rank2]:2025-11-28 15:51:00,203 - INFO - Avg. fwd time: 8.1982 / Avg. bwd time: 13.3152 / Avg. batch time: 515.4558 (ms) / GPU bubble ratio: 66.61%
[rank2]:2025-11-28 15:51:00,277 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 7.7498e-01
[rank0]:2025-11-28 15:51:00,266 - INFO - Avg. fwd time: 8.2990 / Avg. bwd time: 19.6234 / Avg. batch time: 582.6480 (ms) / GPU bubble ratio: 61.66%
[rank1]:2025-11-28 15:51:00,289 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.3590e-01
[rank1]:2025-11-28 15:51:00,289 - INFO -  step: 600  loss: -8.0000  grad_norm:  0.5516  memory:  9.03GiB(19.01%)  tps: 7,036  tflops: 55.01  mfu: 17.63%
[rank3]:2025-11-28 15:51:00,292 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 1.3709e+00
[rank3]:2025-11-28 15:51:00,296 - INFO -  step: 600  loss:  0.2349  grad_norm:  0.5516  memory: 16.39GiB(34.50%)  tps: 7,037  tflops: 55.01  mfu: 17.63%
[rank2]:2025-11-28 15:51:00,278 - INFO -  step: 600  loss: -8.0000  grad_norm:  0.5516  memory:  6.43GiB(13.53%)  tps: 7,037  tflops: 55.01  mfu: 17.63%
[rank2]:2025-11-28 15:51:00,377 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p40_42_dm1/frozen_ratio_history/rank2/251128_1551_stage2_step600.svg
[rank0]:2025-11-28 15:51:00,296 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.6577e-01
[rank0]:2025-11-28 15:51:00,296 - INFO -  step: 600  loss: -8.0000  grad_norm:  0.5516  memory: 12.97GiB(27.31%)  tps: 7,037  tflops: 55.01  mfu: 17.63%
[rank0]:2025-11-28 15:51:00,351 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p40_42_dm1/frozen_ratio_history/rank0/251128_1551_stage0_step600.svg
[rank1]:2025-11-28 15:51:00,350 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p40_42_dm1/frozen_ratio_history/rank1/251128_1551_stage1_step600.svg
[rank3]:2025-11-28 15:51:00,439 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p40_42_dm1/pipeline_schedule/251128_1551_real_step600_rank3.svg
[rank3]:			> Batch Time: 564.55 ms, GPU Bubble Ratio: 61.04%, 55.90%, 71.84%, 27.74%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms                       | [S0,MB1,F]  9-8-18ms                      | [S0,MB2,F]  18-8-27ms                     | [S0,MB3,F]  27-8-35ms                     | [S0,MB0,B]  129-19-148ms                  | [S0,MB4,F]  149-7-156ms                   | [S0,MB1,B]  184-19-203ms                  | [S0,MB5,F]  203-7-211ms                   | [S0,MB2,B]  243-19-262ms                  | [S0,MB6,F]  262-7-270ms                   | [S0,MB3,B]  304-19-323ms                  | [S0,MB7,F]  323-7-331ms                   | [S0,MB4,B]  366-19-385ms                  | [S0,MB5,B]  426-19-445ms                  | [S0,MB6,B]  485-19-504ms                  | [S0,MB7,B]  545-19-564ms                 
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms                     | [S1,MB1,F]  23-9-33ms                     | [S1,MB2,F]  36-9-45ms                     | [S1,MB0,B]  103-21-124ms                  | [S1,MB3,F]  128-9-137ms                   | [S1,MB1,B]  157-21-179ms                  | [S1,MB4,F]  182-9-192ms                   | [S1,MB2,B]  216-21-237ms                  | [S1,MB5,F]  241-9-251ms                   | [S1,MB3,B]  277-21-299ms                  | [S1,MB6,F]  302-9-312ms                   | [S1,MB4,B]  339-21-360ms                  | [S1,MB7,F]  364-9-373ms                   | [S1,MB5,B]  401-21-422ms                  | [S1,MB6,B]  460-21-481ms                  | [S1,MB7,B]  520-21-542ms                 
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms                     | [S2,MB1,F]  33-8-41ms                     | [S2,MB0,B]  86-11-98ms                    | [S2,MB2,F]  101-8-110ms                   | [S2,MB1,B]  141-11-152ms                  | [S2,MB3,F]  156-8-164ms                   | [S2,MB2,B]  200-11-211ms                  | [S2,MB4,F]  214-8-223ms                   | [S2,MB3,B]  261-11-272ms                  | [S2,MB5,F]  276-8-284ms                   | [S2,MB4,B]  322-11-334ms                  | [S2,MB6,F]  337-8-346ms                   | [S2,MB5,B]  384-11-396ms                  | [S2,MB7,F]  399-8-408ms                   | [S2,MB6,B]  445-11-457ms                  | [S2,MB7,B]  506-11-517ms                 
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms                    | [S3,MB0,B]  48-34-83ms                    | [S3,MB1,F]  85-11-96ms                    | [S3,MB1,B]  102-34-137ms                  | [S3,MB2,F]  139-14-154ms                  | [S3,MB2,B]  160-35-196ms                  | [S3,MB3,F]  198-15-214ms                  | [S3,MB3,B]  220-36-257ms                  | [S3,MB4,F]  259-16-275ms                  | [S3,MB4,B]  281-37-318ms                  | [S3,MB5,F]  321-15-336ms                  | [S3,MB5,B]  343-37-380ms                  | [S3,MB6,F]  382-15-398ms                  | [S3,MB6,B]  404-37-442ms                  | [S3,MB7,F]  443-14-458ms                  | [S3,MB7,B]  465-37-503ms                 
[rank3]:2025-11-28 15:51:00,486 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p40_42_dm1/frozen_ratio_history/rank3/251128_1551_stage3_step600.svg
[rank1]:2025-11-28 15:51:47,476 - INFO - Freezing Ratio: [Stage1] 0.20, Threshold: 6.8312e-01
[rank3]:2025-11-28 15:51:47,492 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.3545e-01
[rank0]:2025-11-28 15:51:47,488 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 6.5000e-01
[rank2]:2025-11-28 15:51:47,472 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.2667e-01
[rank2]:2025-11-28 15:52:33,586 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.8590e+00
[rank1]:2025-11-28 15:52:33,598 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 5.2233e-01
[rank3]:2025-11-28 15:52:33,602 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 3.2674e+00
[rank0]:2025-11-28 15:52:33,605 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.3117e+00
[rank3]:2025-11-28 15:52:56,980 - INFO - Avg. fwd time: 13.9479 / Avg. bwd time: 39.3164 / Avg. batch time: 489.5764 (ms) / GPU bubble ratio: 12.96%
[rank2]:2025-11-28 15:52:57,000 - INFO - Avg. fwd time: 8.2082 / Avg. bwd time: 13.2459 / Avg. batch time: 515.0740 (ms) / GPU bubble ratio: 66.68%
[rank0]:2025-11-28 15:52:56,977 - INFO - Avg. fwd time: 8.3095 / Avg. bwd time: 19.5488 / Avg. batch time: 582.1312 (ms) / GPU bubble ratio: 61.72%
[rank1]:2025-11-28 15:52:57,025 - INFO - Avg. fwd time: 9.7732 / Avg. bwd time: 20.0552 / Avg. batch time: 549.5299 (ms) / GPU bubble ratio: 56.58%
[rank3]:2025-11-28 15:53:20,591 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 7.0948e-01
[rank1]:2025-11-28 15:53:20,576 - INFO - Freezing Ratio: [Stage1] 0.20, Threshold: 1.7673e+00
[rank0]:2025-11-28 15:53:20,587 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.8095e+00
[rank2]:2025-11-28 15:53:20,572 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.7186e+00
[rank3]:2025-11-28 15:54:06,898 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 1.8452e+00
[rank1]:2025-11-28 15:54:06,894 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 2.0346e-01
[rank2]:2025-11-28 15:54:06,883 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 7.5153e-01
[rank0]:2025-11-28 15:54:06,902 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 4.1921e-01
[rank0]:2025-11-28 15:54:49,360 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-11-28 15:54:53,778 - INFO - Avg. fwd time: 8.3226 / Avg. bwd time: 19.4617 / Avg. batch time: 581.6304 (ms) / GPU bubble ratio: 61.78%
[rank3]:2025-11-28 15:54:53,782 - INFO - Avg. fwd time: 13.9532 / Avg. bwd time: 39.2795 / Avg. batch time: 489.3236 (ms) / GPU bubble ratio: 12.97%
[rank1]:2025-11-28 15:54:53,825 - INFO - Avg. fwd time: 9.7836 / Avg. bwd time: 19.9782 / Avg. batch time: 549.1180 (ms) / GPU bubble ratio: 56.64%
[rank2]:2025-11-28 15:54:53,804 - INFO - Avg. fwd time: 8.2195 / Avg. bwd time: 13.1711 / Avg. batch time: 514.7395 (ms) / GPU bubble ratio: 66.75%
[rank3]:2025-11-28 15:54:54,050 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 7.3826e-01
[rank3]:2025-11-28 15:54:54,053 - INFO -  step: 650  loss:  0.2449  grad_norm:  0.0899  memory: 16.39GiB(34.50%)  tps: 7,009  tflops: 54.79  mfu: 17.56%
[rank1]:2025-11-28 15:54:54,034 - INFO - Freezing Ratio: [Stage1] 0.20, Threshold: 1.4554e+00
[rank1]:2025-11-28 15:54:54,035 - INFO -  step: 650  loss: -8.0000  grad_norm:  0.0899  memory:  9.03GiB(19.01%)  tps: 7,009  tflops: 54.80  mfu: 17.56%
[rank0]:2025-11-28 15:54:54,045 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 6.3776e-01
[rank0]:2025-11-28 15:54:54,046 - INFO -  step: 650  loss: -8.0000  grad_norm:  0.0899  memory: 12.97GiB(27.31%)  tps: 7,009  tflops: 54.79  mfu: 17.56%
[rank2]:2025-11-28 15:54:54,030 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.8551e+00
[rank2]:2025-11-28 15:54:54,031 - INFO -  step: 650  loss: -8.0000  grad_norm:  0.0899  memory:  6.43GiB(13.53%)  tps: 7,009  tflops: 54.79  mfu: 17.56%
[rank3]:2025-11-28 15:55:40,320 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 1.0390e+00
[rank1]:2025-11-28 15:55:40,316 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 2.2764e-01
[rank2]:2025-11-28 15:55:40,305 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.0404e+00
[rank0]:2025-11-28 15:55:40,324 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 9.5114e-02
[rank3]:2025-11-28 15:56:27,445 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.0670e-01
[rank1]:2025-11-28 15:56:27,429 - INFO - Freezing Ratio: [Stage1] 0.20, Threshold: 6.1782e-01
[rank2]:2025-11-28 15:56:27,426 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.1921e-01
[rank0]:2025-11-28 15:56:27,441 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 5.3056e-01
[rank3]:2025-11-28 15:56:50,593 - INFO - Avg. fwd time: 13.9663 / Avg. bwd time: 39.2211 / Avg. batch time: 488.9604 (ms) / GPU bubble ratio: 12.98%
[rank2]:2025-11-28 15:56:50,617 - INFO - Avg. fwd time: 8.2295 / Avg. bwd time: 13.1023 / Avg. batch time: 514.3016 (ms) / GPU bubble ratio: 66.82%
[rank1]:2025-11-28 15:56:50,651 - INFO - Avg. fwd time: 9.7884 / Avg. bwd time: 19.9466 / Avg. batch time: 548.6486 (ms) / GPU bubble ratio: 56.64%
[rank0]:2025-11-28 15:56:50,682 - INFO - Avg. fwd time: 8.3316 / Avg. bwd time: 19.4008 / Avg. batch time: 581.1003 (ms) / GPU bubble ratio: 61.82%
[rank2]:2025-11-28 15:57:13,868 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.1065e+00
[rank3]:2025-11-28 15:57:13,884 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 2.4684e+00
[rank1]:2025-11-28 15:57:13,880 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 5.3324e-01
[rank0]:2025-11-28 15:57:13,887 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.0484e+00
[rank0]:2025-11-28 15:58:01,140 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 3.0167e+00
[rank2]:2025-11-28 15:58:01,124 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.4122e+00
[rank3]:2025-11-28 15:58:01,144 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 9.0735e-01
[rank1]:2025-11-28 15:58:01,128 - INFO - Freezing Ratio: [Stage1] 0.20, Threshold: 3.1302e+00
[rank0]:2025-11-28 15:58:42,737 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-28 15:58:47,062 - INFO - Avg. fwd time: 13.9762 / Avg. bwd time: 39.1793 / Avg. batch time: 488.7046 (ms) / GPU bubble ratio: 12.99%
[rank1]:2025-11-28 15:58:47,165 - INFO - Avg. fwd time: 9.7924 / Avg. bwd time: 19.9183 / Avg. batch time: 548.3038 (ms) / GPU bubble ratio: 56.65%
[rank0]:2025-11-28 15:58:47,117 - INFO - Avg. fwd time: 8.3392 / Avg. bwd time: 19.3510 / Avg. batch time: 580.7044 (ms) / GPU bubble ratio: 61.85%
[rank2]:2025-11-28 15:58:47,125 - INFO - Avg. fwd time: 8.2377 / Avg. bwd time: 13.0472 / Avg. batch time: 513.9853 (ms) / GPU bubble ratio: 66.87%
[rank1]:2025-11-28 15:58:47,369 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 4.8899e-01
[rank1]:2025-11-28 15:58:47,369 - INFO -  step: 700  loss: -8.0000  grad_norm:  0.4193  memory:  9.03GiB(19.01%)  tps: 7,022  tflops: 54.89  mfu: 17.59%
[rank0]:2025-11-28 15:58:47,377 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.2692e+00
[rank0]:2025-11-28 15:58:47,377 - INFO -  step: 700  loss: -8.0000  grad_norm:  0.4193  memory: 12.97GiB(27.31%)  tps: 7,022  tflops: 54.89  mfu: 17.59%
[rank2]:2025-11-28 15:58:47,357 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 9.7828e-01
[rank2]:2025-11-28 15:58:47,358 - INFO -  step: 700  loss: -8.0000  grad_norm:  0.4193  memory:  6.43GiB(13.53%)  tps: 7,022  tflops: 54.89  mfu: 17.59%
[rank3]:2025-11-28 15:58:47,373 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 5.9581e-01
[rank3]:2025-11-28 15:58:47,376 - INFO -  step: 700  loss:  0.2050  grad_norm:  0.4193  memory: 16.39GiB(34.50%)  tps: 7,022  tflops: 54.90  mfu: 17.59%
[rank1]:2025-11-28 15:58:47,430 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p40_42_dm1/frozen_ratio_history/rank1/251128_1558_stage1_step700.svg
[rank0]:2025-11-28 15:58:47,432 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p40_42_dm1/frozen_ratio_history/rank0/251128_1558_stage0_step700.svg
[rank2]:2025-11-28 15:58:47,433 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p40_42_dm1/frozen_ratio_history/rank2/251128_1558_stage2_step700.svg
[rank3]:2025-11-28 15:58:47,518 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p40_42_dm1/pipeline_schedule/251128_1558_real_step700_rank3.svg
[rank3]:			> Batch Time: 565.58 ms, GPU Bubble Ratio: 61.06%, 56.02%, 71.88%, 27.55%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms                       | [S0,MB1,F]  9-8-18ms                      | [S0,MB2,F]  18-8-26ms                     | [S0,MB3,F]  26-8-35ms                     | [S0,MB0,B]  130-19-149ms                  | [S0,MB4,F]  149-7-157ms                   | [S0,MB1,B]  184-19-203ms                  | [S0,MB5,F]  203-8-211ms                   | [S0,MB2,B]  243-19-262ms                  | [S0,MB6,F]  262-7-270ms                   | [S0,MB3,B]  305-19-324ms                  | [S0,MB7,F]  324-8-332ms                   | [S0,MB4,B]  366-19-385ms                  | [S0,MB5,B]  426-19-445ms                  | [S0,MB6,B]  486-19-505ms                  | [S0,MB7,B]  546-19-565ms                 
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms                     | [S1,MB1,F]  23-9-33ms                     | [S1,MB2,F]  36-9-45ms                     | [S1,MB0,B]  103-21-124ms                  | [S1,MB3,F]  128-9-137ms                   | [S1,MB1,B]  157-21-179ms                  | [S1,MB4,F]  182-9-192ms                   | [S1,MB2,B]  216-21-238ms                  | [S1,MB5,F]  241-9-251ms                   | [S1,MB3,B]  278-21-299ms                  | [S1,MB6,F]  303-9-312ms                   | [S1,MB4,B]  339-21-361ms                  | [S1,MB7,F]  364-9-374ms                   | [S1,MB5,B]  402-21-423ms                  | [S1,MB6,B]  461-21-483ms                  | [S1,MB7,B]  522-21-543ms                 
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms                     | [S2,MB1,F]  33-8-41ms                     | [S2,MB0,B]  86-11-98ms                    | [S2,MB2,F]  101-8-110ms                   | [S2,MB1,B]  141-11-152ms                  | [S2,MB3,F]  156-8-164ms                   | [S2,MB2,B]  200-11-211ms                  | [S2,MB4,F]  215-8-223ms                   | [S2,MB3,B]  261-11-272ms                  | [S2,MB5,F]  276-8-284ms                   | [S2,MB4,B]  323-11-334ms                  | [S2,MB6,F]  338-8-346ms                   | [S2,MB5,B]  385-11-396ms                  | [S2,MB7,F]  400-8-408ms                   | [S2,MB6,B]  447-11-458ms                  | [S2,MB7,B]  507-11-518ms                 
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-43ms                    | [S3,MB0,B]  48-34-83ms                    | [S3,MB1,F]  85-11-97ms                    | [S3,MB1,B]  102-34-137ms                  | [S3,MB2,F]  139-14-154ms                  | [S3,MB2,B]  160-35-196ms                  | [S3,MB3,F]  198-16-214ms                  | [S3,MB3,B]  220-36-257ms                  | [S3,MB4,F]  259-16-276ms                  | [S3,MB4,B]  282-37-319ms                  | [S3,MB5,F]  321-15-337ms                  | [S3,MB5,B]  343-37-381ms                  | [S3,MB6,F]  384-15-399ms                  | [S3,MB6,B]  405-37-443ms                  | [S3,MB7,F]  445-14-460ms                  | [S3,MB7,B]  466-37-503ms                 
[rank3]:2025-11-28 15:58:47,567 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p40_42_dm1/frozen_ratio_history/rank3/251128_1558_stage3_step700.svg
[rank3]:2025-11-28 15:59:34,628 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.6489e+00
[rank1]:2025-11-28 15:59:34,613 - INFO - Freezing Ratio: [Stage1] 0.20, Threshold: 3.5717e+00
[rank0]:2025-11-28 15:59:34,624 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 2.8336e+00
[rank2]:2025-11-28 15:59:34,609 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.3836e+00
[rank0]:2025-11-28 16:00:20,925 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 9.0034e-01
[rank2]:2025-11-28 16:00:20,906 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.4062e+00
[rank3]:2025-11-28 16:00:20,921 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 2.0068e+00
[rank1]:2025-11-28 16:00:20,917 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 4.3681e-01
[rank3]:2025-11-28 16:00:44,123 - INFO - Avg. fwd time: 13.9849 / Avg. bwd time: 39.1382 / Avg. batch time: 488.4431 (ms) / GPU bubble ratio: 12.99%
[rank2]:2025-11-28 16:00:44,141 - INFO - Avg. fwd time: 8.2463 / Avg. bwd time: 12.9874 / Avg. batch time: 513.6757 (ms) / GPU bubble ratio: 66.93%
[rank0]:2025-11-28 16:00:44,117 - INFO - Avg. fwd time: 8.3479 / Avg. bwd time: 19.2891 / Avg. batch time: 580.2835 (ms) / GPU bubble ratio: 61.90%
[rank1]:2025-11-28 16:00:44,166 - INFO - Avg. fwd time: 9.7984 / Avg. bwd time: 19.8724 / Avg. batch time: 547.9470 (ms) / GPU bubble ratio: 56.68%
[rank1]:2025-11-28 16:01:07,960 - INFO - Freezing Ratio: [Stage1] 0.20, Threshold: 1.4126e+00
[rank2]:2025-11-28 16:01:07,956 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.0912e+00
[rank0]:2025-11-28 16:01:07,971 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 8.4740e-01
[rank3]:2025-11-28 16:01:07,975 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 6.2492e-01
[rank1]:2025-11-28 16:01:54,273 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 7.2690e-01
[rank3]:2025-11-28 16:01:54,277 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 2.5316e+00
[rank2]:2025-11-28 16:01:54,261 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.4723e+00
[rank0]:2025-11-28 16:01:54,280 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 5.4884e-01
[rank0]:2025-11-28 16:02:36,596 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-28 16:02:41,249 - INFO - Avg. fwd time: 13.9881 / Avg. bwd time: 39.1107 / Avg. batch time: 488.2493 (ms) / GPU bubble ratio: 13.00%
[rank2]:2025-11-28 16:02:41,273 - INFO - Avg. fwd time: 8.2544 / Avg. bwd time: 12.9317 / Avg. batch time: 513.4215 (ms) / GPU bubble ratio: 66.99%
[rank3]:2025-11-28 16:02:41,361 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.5788e-01
[rank3]:2025-11-28 16:02:41,364 - INFO -  step: 750  loss:  0.2510  grad_norm:  0.1486  memory: 16.39GiB(34.50%)  tps: 7,002  tflops: 54.74  mfu: 17.54%
[rank1]:2025-11-28 16:02:41,302 - INFO - Avg. fwd time: 9.8061 / Avg. bwd time: 19.8121 / Avg. batch time: 547.6331 (ms) / GPU bubble ratio: 56.73%
[rank1]:2025-11-28 16:02:41,346 - INFO - Freezing Ratio: [Stage1] 0.20, Threshold: 5.9299e-01
[rank1]:2025-11-28 16:02:41,346 - INFO -  step: 750  loss: -8.0000  grad_norm:  0.1486  memory:  9.03GiB(19.01%)  tps: 7,002  tflops: 54.74  mfu: 17.55%
[rank2]:2025-11-28 16:02:41,342 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 7.5161e-01
[rank2]:2025-11-28 16:02:41,343 - INFO -  step: 750  loss: -8.0000  grad_norm:  0.1486  memory:  6.43GiB(13.53%)  tps: 7,002  tflops: 54.74  mfu: 17.54%
[rank0]:2025-11-28 16:02:41,332 - INFO - Avg. fwd time: 8.3574 / Avg. bwd time: 19.2228 / Avg. batch time: 579.9029 (ms) / GPU bubble ratio: 61.95%
[rank0]:2025-11-28 16:02:41,357 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 3.7769e-01
[rank0]:2025-11-28 16:02:41,358 - INFO -  step: 750  loss: -8.0000  grad_norm:  0.1486  memory: 12.97GiB(27.31%)  tps: 7,002  tflops: 54.74  mfu: 17.55%
[rank2]:2025-11-28 16:03:27,878 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.3331e+00
[rank3]:2025-11-28 16:03:27,893 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 1.3702e+00
[rank1]:2025-11-28 16:03:27,890 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.9443e-01
[rank0]:2025-11-28 16:03:27,898 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 4.6965e-01
[rank3]:2025-11-28 16:04:15,687 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 5.3040e-01
[rank2]:2025-11-28 16:04:15,667 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.6808e-01
[rank0]:2025-11-28 16:04:15,688 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 4.4309e-01
[rank1]:2025-11-28 16:04:15,671 - INFO - Freezing Ratio: [Stage1] 0.20, Threshold: 5.4641e-01
[rank3]:2025-11-28 16:04:38,870 - INFO - Avg. fwd time: 13.9906 / Avg. bwd time: 39.0689 / Avg. batch time: 487.9643 (ms) / GPU bubble ratio: 13.01%
[rank2]:2025-11-28 16:04:38,925 - INFO - Avg. fwd time: 8.2606 / Avg. bwd time: 12.8866 / Avg. batch time: 513.0905 (ms) / GPU bubble ratio: 67.03%
[rank0]:2025-11-28 16:04:38,921 - INFO - Avg. fwd time: 8.3729 / Avg. bwd time: 19.1826 / Avg. batch time: 579.5403 (ms) / GPU bubble ratio: 61.96%
[rank1]:2025-11-28 16:04:38,960 - INFO - Avg. fwd time: 9.8082 / Avg. bwd time: 19.7896 / Avg. batch time: 547.2829 (ms) / GPU bubble ratio: 56.73%
[rank1]:2025-11-28 16:05:02,568 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 3.0267e-01
[rank0]:2025-11-28 16:05:02,576 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 7.2917e-01
[rank2]:2025-11-28 16:05:02,556 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.0429e+00
[rank3]:2025-11-28 16:05:02,572 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 2.3177e+00
[rank3]:2025-11-28 16:05:49,518 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.4566e-01
[rank0]:2025-11-28 16:05:49,513 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 3.2991e-01
[rank1]:2025-11-28 16:05:49,502 - INFO - Freezing Ratio: [Stage1] 0.20, Threshold: 3.3140e-01
[rank2]:2025-11-28 16:05:49,498 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.8813e-01
[rank0]:2025-11-28 16:06:31,138 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-28 16:06:35,493 - INFO - Avg. fwd time: 13.9974 / Avg. bwd time: 39.0191 / Avg. batch time: 487.6222 (ms) / GPU bubble ratio: 13.02%
[rank0]:2025-11-28 16:06:35,544 - INFO - Avg. fwd time: 8.3824 / Avg. bwd time: 19.1440 / Avg. batch time: 579.1042 (ms) / GPU bubble ratio: 61.97%
[rank1]:2025-11-28 16:06:35,592 - INFO - Avg. fwd time: 9.8105 / Avg. bwd time: 19.7757 / Avg. batch time: 546.8748 (ms) / GPU bubble ratio: 56.72%
[rank2]:2025-11-28 16:06:35,550 - INFO - Avg. fwd time: 8.2675 / Avg. bwd time: 12.8371 / Avg. batch time: 512.6935 (ms) / GPU bubble ratio: 67.07%
[rank3]:2025-11-28 16:06:35,794 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 2.4130e+00
[rank3]:2025-11-28 16:06:35,797 - INFO -  step: 800  loss:  0.2524  grad_norm:  0.4263  memory: 16.39GiB(34.50%)  tps: 6,989  tflops: 54.64  mfu: 17.51%
[rank3]:2025-11-28 16:06:35,798 - INFO -  final step: 800  loss:  0.2524  grad_norm:  0.4263  tps: 7,309  tflops: 57.14  mfu: 16.85%
[rank0]:2025-11-28 16:06:35,798 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1662e+00
[rank0]:2025-11-28 16:06:35,798 - INFO -  step: 800  loss: -8.0000  grad_norm:  0.4263  memory: 12.97GiB(27.31%)  tps: 6,989  tflops: 54.63  mfu: 17.51%
[rank0]:2025-11-28 16:06:35,798 - INFO -  final step: 800  loss: -8.0000  grad_norm:  0.4263  tps: 7,305  tflops: 57.11  mfu: 16.73%
[rank0]:2025-11-28 16:06:35,798 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-28 16:06:35,799 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank1]:2025-11-28 16:06:35,790 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 4.3630e-01
[rank1]:2025-11-28 16:06:35,791 - INFO -  step: 800  loss: -8.0000  grad_norm:  0.4263  memory:  9.03GiB(19.01%)  tps: 6,988  tflops: 54.63  mfu: 17.51%
[rank1]:2025-11-28 16:06:35,791 - INFO -  final step: 800  loss: -8.0000  grad_norm:  0.4263  tps: 7,305  tflops: 57.11  mfu: 16.74%
[rank1]:2025-11-28 16:06:35,791 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-11-28 16:06:35,792 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank2]:2025-11-28 16:06:35,779 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.1458e+00
[rank2]:2025-11-28 16:06:35,779 - INFO -  step: 800  loss: -8.0000  grad_norm:  0.4263  memory:  6.43GiB(13.53%)  tps: 6,989  tflops: 54.63  mfu: 17.51%
[rank2]:2025-11-28 16:06:35,779 - INFO -  final step: 800  loss: -8.0000  grad_norm:  0.4263  tps: 7,305  tflops: 57.10  mfu: 16.72%
[rank2]:2025-11-28 16:06:35,779 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-28 16:06:35,780 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank3]:2025-11-28 16:06:35,798 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-11-28 16:06:35,799 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-11-28 16:06:38,076 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-11-28 16:06:38,148 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p40_42_dm1/frozen_ratio_history/rank0/251128_1606_stage0_final800.svg
[rank1]:2025-11-28 16:06:38,148 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p40_42_dm1/frozen_ratio_history/rank1/251128_1606_stage1_final800.svg
[rank2]:2025-11-28 16:06:38,148 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p40_42_dm1/frozen_ratio_history/rank2/251128_1606_stage2_final800.svg
[rank3]:2025-11-28 16:06:38,233 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p40_42_dm1/pipeline_schedule/251128_1606_real_final800_rank3.svg
[rank3]:			> Batch Time: 573.05 ms, GPU Bubble Ratio: 61.59%, 56.52%, 72.25%, 25.71%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms                       | [S0,MB1,F]  9-8-18ms                      | [S0,MB2,F]  18-8-27ms                     | [S0,MB3,F]  27-8-35ms                     | [S0,MB0,B]  129-19-148ms                  | [S0,MB4,F]  148-7-156ms                   | [S0,MB1,B]  185-19-204ms                  | [S0,MB5,F]  203-7-211ms                   | [S0,MB2,B]  244-19-263ms                  | [S0,MB6,F]  263-7-270ms                   | [S0,MB3,B]  307-19-326ms                  | [S0,MB7,F]  325-7-333ms                   | [S0,MB4,B]  370-19-389ms                  | [S0,MB5,B]  431-19-450ms                  | [S0,MB6,B]  491-19-510ms                  | [S0,MB7,B]  554-19-573ms                 
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms                     | [S1,MB1,F]  23-9-33ms                     | [S1,MB2,F]  36-9-45ms                     | [S1,MB0,B]  105-21-127ms                  | [S1,MB3,F]  128-9-137ms                   | [S1,MB1,B]  162-21-183ms                  | [S1,MB4,F]  183-9-193ms                   | [S1,MB2,B]  222-21-244ms                  | [S1,MB5,F]  243-9-253ms                   | [S1,MB3,B]  285-21-306ms                  | [S1,MB6,F]  305-9-315ms                   | [S1,MB4,B]  348-21-369ms                  | [S1,MB7,F]  369-9-378ms                   | [S1,MB5,B]  411-21-432ms                  | [S1,MB6,B]  471-21-492ms                  | [S1,MB7,B]  533-21-554ms                 
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms                     | [S2,MB1,F]  33-8-41ms                     | [S2,MB0,B]  89-11-100ms                   | [S2,MB2,F]  104-8-112ms                   | [S2,MB1,B]  145-11-157ms                  | [S2,MB3,F]  161-8-169ms                   | [S2,MB2,B]  205-11-217ms                  | [S2,MB4,F]  221-8-229ms                   | [S2,MB3,B]  268-11-279ms                  | [S2,MB5,F]  284-8-292ms                   | [S2,MB4,B]  331-11-342ms                  | [S2,MB6,F]  347-8-355ms                   | [S2,MB5,B]  393-11-405ms                  | [S2,MB7,F]  409-8-417ms                   | [S2,MB6,B]  455-11-467ms                  | [S2,MB7,B]  518-11-529ms                 
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms                    | [S3,MB0,B]  48-36-85ms                    | [S3,MB1,F]  87-11-98ms                    | [S3,MB1,B]  104-37-142ms                  | [S3,MB2,F]  144-13-158ms                  | [S3,MB2,B]  163-38-201ms                  | [S3,MB3,F]  204-14-219ms                  | [S3,MB3,B]  224-40-264ms                  | [S3,MB4,F]  266-14-281ms                  | [S3,MB4,B]  286-40-327ms                  | [S3,MB5,F]  329-14-344ms                  | [S3,MB5,B]  349-40-389ms                  | [S3,MB6,F]  392-14-406ms                  | [S3,MB6,B]  411-39-451ms                  | [S3,MB7,F]  454-14-468ms                  | [S3,MB7,B]  474-39-514ms                 
[rank0]:2025-11-28 16:06:38,307 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p40_42_dm1/frozen_params_histogram/251128_1606_rank0_stage0.svg
[rank0]:	> Counts Sum: 1431, Total Sum: 2775 (51.57%), Ratio(%) per element: [0.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 81.33, 81.33, 81.33, 81.33, 81.33, 81.33, 81.33, 81.33, 81.33, 38.66, 38.66, 38.66, 38.66, 38.66, 38.66, 38.66, 38.66, 38.66, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-11-28 16:06:38,307 - INFO - Sleeping 2 seconds for other ranks to complete
[rank1]:2025-11-28 16:06:38,300 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p40_42_dm1/frozen_params_histogram/251128_1606_rank1_stage1.svg
[rank1]:	> Counts Sum: 1188, Total Sum: 3375 (35.20%), Ratio(%) per element: [90.66, 90.66, 90.66, 90.66, 90.66, 90.66, 90.66, 90.66, 90.66, 42.66, 42.66, 42.66, 42.66, 42.66, 42.66, 42.66, 42.66, 42.66, 42.66, 42.66, 42.66, 42.66, 42.66, 42.66, 42.66, 42.66, 42.66, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-11-28 16:06:38,301 - INFO - Destroying the purge thread.
[rank2]:2025-11-28 16:06:38,311 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p40_42_dm1/frozen_params_histogram/251128_1606_rank2_stage2.svg
[rank2]:	> Counts Sum: 1791, Total Sum: 2700 (66.33%), Ratio(%) per element: [92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 81.33, 81.33, 81.33, 81.33, 81.33, 81.33, 81.33, 81.33, 81.33, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-11-28 16:06:38,311 - INFO - Destroying the purge thread.
[rank3]:2025-11-28 16:06:38,368 - INFO - 
[rank3]:Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p40_42_dm1/pipeline_schedule/251128_1606_thry_final800_rank3.svg
[rank3]:			> Batch Time: 334.80 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-10-10ms                     | [S0,MB1,F]  10-10-20ms                    | [S0,MB2,F]  20-10-30ms                    | [S0,MB3,F]  30-10-40ms                    | [S0,MB0,B]  101-20-121ms                  | [S0,MB4,F]  121-10-131ms                  | [S0,MB1,B]  131-20-152ms                  | [S0,MB5,F]  152-10-162ms                  | [S0,MB2,B]  162-20-182ms                  | [S0,MB6,F]  182-10-192ms                  | [S0,MB3,B]  192-20-213ms                  | [S0,MB7,F]  213-10-223ms                  | [S0,MB4,B]  223-20-243ms                  | [S0,MB5,B]  253-20-273ms                  | [S0,MB6,B]  284-20-304ms                  | [S0,MB7,B]  314-20-334ms                 
[rank3]:			  [Rank 1]	[S1,MB0,F]  10-10-20ms                    | [S1,MB1,F]  20-10-30ms                    | [S1,MB2,F]  30-10-40ms                    | [S1,MB0,B]  81-20-101ms                   | [S1,MB3,F]  101-10-111ms                  | [S1,MB1,B]  111-20-131ms                  | [S1,MB4,F]  131-10-142ms                  | [S1,MB2,B]  142-20-162ms                  | [S1,MB5,F]  162-10-172ms                  | [S1,MB3,B]  172-20-192ms                  | [S1,MB6,F]  192-10-202ms                  | [S1,MB4,B]  202-20-223ms                  | [S1,MB7,F]  223-10-233ms                  | [S1,MB5,B]  233-20-253ms                  | [S1,MB6,B]  263-20-284ms                  | [S1,MB7,B]  294-20-314ms                 
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-10-30ms                    | [S2,MB1,F]  30-10-40ms                    | [S2,MB0,B]  60-20-81ms                    | [S2,MB2,F]  81-10-91ms                    | [S2,MB1,B]  91-20-111ms                   | [S2,MB3,F]  111-10-121ms                  | [S2,MB2,B]  121-20-142ms                  | [S2,MB4,F]  142-10-152ms                  | [S2,MB3,B]  152-20-172ms                  | [S2,MB5,F]  172-10-182ms                  | [S2,MB4,B]  182-20-202ms                  | [S2,MB6,F]  202-10-213ms                  | [S2,MB5,B]  213-20-233ms                  | [S2,MB7,F]  233-10-243ms                  | [S2,MB6,B]  243-20-263ms                  | [S2,MB7,B]  273-20-294ms                 
[rank3]:			  [Rank 3]	[S3,MB0,F]  30-10-40ms                    | [S3,MB0,B]  40-20-60ms                    | [S3,MB1,F]  60-10-71ms                    | [S3,MB1,B]  71-20-91ms                    | [S3,MB2,F]  91-10-101ms                   | [S3,MB2,B]  101-20-121ms                  | [S3,MB3,F]  121-10-131ms                  | [S3,MB3,B]  131-20-152ms                  | [S3,MB4,F]  152-10-162ms                  | [S3,MB4,B]  162-20-182ms                  | [S3,MB5,F]  182-10-192ms                  | [S3,MB5,B]  192-20-213ms                  | [S3,MB6,F]  213-10-223ms                  | [S3,MB6,B]  223-20-243ms                  | [S3,MB7,F]  243-10-253ms                  | [S3,MB7,B]  253-20-273ms                 
[rank3]:2025-11-28 16:06:38,418 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p40_42_dm1/frozen_ratio_history/rank3/251128_1606_stage3_final800.svg
[rank3]:2025-11-28 16:06:38,555 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1116_1F1B_auto_p40_42_dm1/frozen_params_histogram/251128_1606_rank3_stage3.svg
[rank3]:	> Counts Sum: 837, Total Sum: 2175 (38.48%), Ratio(%) per element: [86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 37.33, 37.33, 37.33, 37.33, 37.33, 37.33, 37.33, 37.33, 37.33, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-11-28 16:06:38,556 - INFO - Destroying the purge thread.
[rank1]:2025-11-28 16:06:38,540 - INFO - Process group destroyed
[rank2]:2025-11-28 16:06:38,546 - INFO - Process group destroyed
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading history steps 15-16, summary, console lines 355-378
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–‚â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–ˆâ–†â–ƒâ–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–ˆâ–†â–ƒâ–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 4.48331
[rank3]:wandb:               final/avg_loss 0.25244
[rank3]:wandb:             final/avg_mfu(%) 16.85279
[rank3]:wandb:             final/avg_tflops 57.13747
[rank3]:wandb:    final/avg_throughput(tps) 7308.88139
[rank3]:wandb:              final/grad_norm 0.42632
[rank3]:wandb:               final/max_loss 0.25244
[rank3]:wandb:                    grad_norm 0.42632
[rank3]:wandb: loss_metrics/global_avg_loss 0.25244
[rank3]:wandb: loss_metrics/global_max_loss 0.25244
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1116_1F1B_auto_p40_42_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/yawgndk0
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1116_1F1B_auto_p40_42_dm1/20251128-1503/wandb/run-20251128_150303-yawgndk0/logs
[rank3]:2025-11-28 16:06:40,017 - INFO - Process group destroyed
[rank0]:2025-11-28 16:06:40,308 - INFO - Training completed
[rank0]:2025-11-28 16:06:40,308 - INFO - Destroying the purge thread.
[rank0]:2025-11-28 16:06:40,537 - INFO - Process group destroyed
[rank2]:Stage 2: Modules to keep: {'layers.10', 'layers.12', 'layers.9', 'layers.11'}
[rank0]:Stage 0: Modules to keep: {'layers.0', 'layers.1', 'tok_embeddings', 'layers.2', 'layers.3'}
[rank1]:Stage 1: Modules to keep: {'layers.4', 'layers.8', 'layers.7', 'layers.6', 'layers.5'}
[rank3]:Stage 3: Modules to keep: {'layers.15', 'output', 'layers.13', 'norm', 'layers.14'}
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1116_autofreeze/config_1116.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "AutoFreeze configuration experiment on different PERCENTILE values."
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1116_1F1B_auto_p40_42_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1116_1F1B_auto_p40_42_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1116_1F1B_auto_p40_42_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1116_1F1B_auto_p40_42_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1116_1F1B_auto_p40_42_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1116_1F1B_auto_p40_42_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 42
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: 1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1116_1F1B_auto_p40_42_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1116_1F1B_auto_p40_42_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: auto
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.05
[rank3]:		- percentile: 40
[rank3]:
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
