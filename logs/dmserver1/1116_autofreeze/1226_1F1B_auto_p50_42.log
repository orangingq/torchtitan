
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 12. 27. (í† ) 00:15:07 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 1,2,3,4
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1116_autofreeze/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1116_autofreeze/1226_1F1B_auto_p50_42.log
âœ”ï¸AutoFreeze configuration experiment on different PERCENTILE values.
âœ”ï¸Running with autofreeze (percentile=50) x 1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1116_autofreeze/config_1226.toml --job.description="AutoFreeze configuration experiment on different PERCENTILE values." --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=auto --freezing.percentile=50
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank2]:2025-12-27 00:15:13,349 - Starting job: "AutoFreeze configuration experiment on different PERCENTILE values."
[rank3]:2025-12-27 00:15:13,349 - Starting job: "AutoFreeze configuration experiment on different PERCENTILE values."
[rank0]:2025-12-27 00:15:13,507 - Starting job: "AutoFreeze configuration experiment on different PERCENTILE values."
[rank1]:2025-12-27 00:15:13,516 - Starting job: "AutoFreeze configuration experiment on different PERCENTILE values."
[rank2]:2025-12-27 00:15:13,618 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-12-27 00:15:13,620 - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-12-27 00:15:13,612 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-12-27 00:15:13,614 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-27 00:15:13,770 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-12-27 00:15:13,773 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-27 00:15:13,777 - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-12-27 00:15:13,778 - Loading tokenizer from tokenizer.json
[rank1]:2025-12-27 00:15:13,791 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-12-27 00:15:13,794 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-12-27 00:15:14,175 - Preparing alpaca_gpt4 dataset from vicgalle/alpaca-gpt4
[rank0]:2025-12-27 00:15:17,010 - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank2]:2025-12-27 00:15:17,217 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-12-27 00:15:17,168 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-12-27 00:15:17,209 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-27 00:15:17,211 - Model llama3 1B size: 1,498,482,688 total parameters
[rank2]:2025-12-27 00:15:17,254 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-27 00:15:17,280 - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-12-27 00:15:17,280 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2025-12-27 00:15:17,238 - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-12-27 00:15:17,239 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2025-12-27 00:15:17,242 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-12-27 00:15:17,281 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-27 00:15:17,308 - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-12-27 00:15:17,309 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank2]:2025-12-27 00:15:17,467 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-12-27 00:15:17,467 - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-12-27 00:15:17,468 - CUDA memory usage for model: 0.92GiB(1.94%)
[rank0]:2025-12-27 00:15:17,432 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-12-27 00:15:17,432 - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-12-27 00:15:17,433 - CUDA memory usage for model: 1.90GiB(3.99%)
[rank1]:2025-12-27 00:15:17,494 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-12-27 00:15:17,494 - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-12-27 00:15:17,495 - CUDA memory usage for model: 1.13GiB(2.39%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run 3wb2crjg
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1226_1F1B_auto_p50_42_dm1/20251227-0015/wandb/run-20251227_001518-3wb2crjg
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1226_1F1B_auto_p50_42_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/3wb2crjg
[rank3]:2025-12-27 00:15:19,610 - WandB logging enabled
[rank3]:2025-12-27 00:15:19,610 - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-12-27 00:15:19,649 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-27 00:15:19,679 - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-12-27 00:15:19,679 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank3]:2025-12-27 00:15:19,868 - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-12-27 00:15:19,869 - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-12-27 00:15:19,870 - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2025-12-27 00:15:19,886 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-27 00:15:19,887 - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1226_1F1B_auto_p50_42_dm1
[rank0]:2025-12-27 00:15:19,887 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-27 00:15:19,888 - Trainer is initialized with local batch size 16, global batch size 128, gradient accumulation steps 8, sequence length 1024, total steps 800 (warmup 100)
[rank0]:2025-12-27 00:15:19,888 - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp.
[rank2]:2025-12-27 00:15:19,888 - Mixed precision training with TP or PP is handled by autocast
[rank1]:2025-12-27 00:15:19,887 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-12-27 00:15:22,467 - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-12-27 00:15:22,467 - Finished loading the checkpoint in 2.58 seconds.
[rank0]:2025-12-27 00:15:22,467 - Training starts at step 1
[rank2]:2025-12-27 00:15:28,126 -  step:  1  loss: -8.0000  grad_norm: 116.5370  memory:  5.20GiB(10.94%)  tps: 3,014  tflops: 23.56  mfu: 7.55%
[rank2]:2025-12-27 00:15:28,127 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-12-27 00:15:28,132 -  step:  1  loss: -8.0000  grad_norm: 116.5370  memory:  7.10GiB(14.94%)  tps: 3,020  tflops: 23.61  mfu: 7.57%
[rank1]:2025-12-27 00:15:28,132 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-12-27 00:15:28,137 -  step:  1  loss: 10.6088  grad_norm: 116.5370  memory: 12.97GiB(27.31%)  tps: 3,862  tflops: 30.19  mfu: 9.68%
[rank3]:2025-12-27 00:15:28,138 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-12-27 00:15:28,165 -  step:  1  loss: -8.0000  grad_norm: 116.5370  memory:  9.62GiB(20.24%)  tps: 2,991  tflops: 23.38  mfu: 7.49%
[rank0]:2025-12-27 00:15:28,165 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-12-27 00:17:31,271 - Avg. fwd time: 9.2648 / Avg. bwd time: 24.7813 / Avg. batch time: 587.0687 (ms) / GPU bubble ratio: 53.61%
[rank3]:2025-12-27 00:17:31,216 - Avg. fwd time: 13.5955 / Avg. bwd time: 42.7346 / Avg. batch time: 514.2253 (ms) / GPU bubble ratio: 12.37%
[rank2]:2025-12-27 00:17:31,241 - Avg. fwd time: 7.3798 / Avg. bwd time: 19.9609 / Avg. batch time: 547.1425 (ms) / GPU bubble ratio: 60.02%
[rank0]:2025-12-27 00:17:31,301 - Avg. fwd time: 7.6571 / Avg. bwd time: 24.9577 / Avg. batch time: 625.7873 (ms) / GPU bubble ratio: 58.31%
[rank0]:2025-12-27 00:19:35,372 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-27 00:19:40,437 - Avg. fwd time: 7.3894 / Avg. bwd time: 20.0096 / Avg. batch time: 549.3190 (ms) / GPU bubble ratio: 60.10%
[rank1]:2025-12-27 00:19:40,467 - Avg. fwd time: 9.2891 / Avg. bwd time: 24.8418 / Avg. batch time: 588.9192 (ms) / GPU bubble ratio: 53.64%
[rank3]:2025-12-27 00:19:40,412 - Avg. fwd time: 13.7139 / Avg. bwd time: 42.9423 / Avg. batch time: 516.7459 (ms) / GPU bubble ratio: 12.29%
[rank2]:2025-12-27 00:19:40,519 -  step: 50  loss: -8.0000  grad_norm: 12.5686  memory:  6.98GiB(14.69%)  tps: 6,362  tflops: 49.73  mfu: 15.94%
[rank1]:2025-12-27 00:19:40,522 -  step: 50  loss: -8.0000  grad_norm: 12.5686  memory:  9.50GiB(19.99%)  tps: 6,362  tflops: 49.73  mfu: 15.94%
[rank3]:2025-12-27 00:19:40,530 -  step: 50  loss:  9.9061  grad_norm: 12.5686  memory: 16.39GiB(34.50%)  tps: 6,362  tflops: 49.73  mfu: 15.94%
[rank0]:2025-12-27 00:19:40,497 - Avg. fwd time: 7.6644 / Avg. bwd time: 25.0061 / Avg. batch time: 627.3236 (ms) / GPU bubble ratio: 58.34%
[rank0]:2025-12-27 00:19:40,533 -  step: 50  loss: -8.0000  grad_norm: 12.5686  memory: 13.42GiB(28.26%)  tps: 6,362  tflops: 49.74  mfu: 15.94%
[rank2]:2025-12-27 00:20:27,115 - Freezing Ratio: [Stage2] 0.00, Threshold: 0.0000e+00
[rank1]:2025-12-27 00:20:27,119 - Freezing Ratio: [Stage1] 0.00, Threshold: 0.0000e+00
[rank3]:2025-12-27 00:20:27,126 - Freezing Ratio: [Stage3] 0.00, Threshold: 0.0000e+00
[rank0]:2025-12-27 00:20:27,131 - Freezing Ratio: [Stage0] 0.00, Threshold: 0.0000e+00
[rank2]:2025-12-27 00:21:18,885 - Freezing Ratio: [Stage2] 0.00, Threshold: 9.4586e-01
[rank1]:2025-12-27 00:21:18,889 - Freezing Ratio: [Stage1] 0.00, Threshold: 1.7930e+00
[rank3]:2025-12-27 00:21:18,897 - Freezing Ratio: [Stage3] 0.31, Threshold: 2.3964e+00
[rank0]:2025-12-27 00:21:18,902 - Freezing Ratio: [Stage0] 0.00, Threshold: 3.5307e+00
[rank3]:2025-12-27 00:21:48,650 - Avg. fwd time: 13.7835 / Avg. bwd time: 42.7715 / Avg. batch time: 515.9042 (ms) / GPU bubble ratio: 12.30%
[rank2]:2025-12-27 00:21:48,676 - Avg. fwd time: 7.3896 / Avg. bwd time: 20.0399 / Avg. batch time: 548.3736 (ms) / GPU bubble ratio: 59.98%
[rank1]:2025-12-27 00:21:48,706 - Avg. fwd time: 9.2945 / Avg. bwd time: 24.8770 / Avg. batch time: 587.8846 (ms) / GPU bubble ratio: 53.50%
[rank0]:2025-12-27 00:21:48,736 - Avg. fwd time: 7.6685 / Avg. bwd time: 25.0335 / Avg. batch time: 626.1882 (ms) / GPU bubble ratio: 58.22%
[rank1]:2025-12-27 00:22:08,579 - Freezing Ratio: [Stage1] 0.00, Threshold: 7.2624e-01
[rank2]:2025-12-27 00:22:08,575 - Freezing Ratio: [Stage2] 0.25, Threshold: 7.3102e-01
[rank3]:2025-12-27 00:22:08,582 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.8557e+00
[rank0]:2025-12-27 00:22:08,591 - Freezing Ratio: [Stage0] 0.24, Threshold: 1.6096e+00
[rank2]:2025-12-27 00:22:59,799 - Freezing Ratio: [Stage2] 0.00, Threshold: 6.6591e+00
[rank0]:2025-12-27 00:22:59,814 - Freezing Ratio: [Stage0] 0.00, Threshold: 8.8994e+00
[rank3]:2025-12-27 00:22:59,814 - Freezing Ratio: [Stage3] 0.31, Threshold: 5.9491e+00
[rank1]:2025-12-27 00:22:59,806 - Freezing Ratio: [Stage1] 0.00, Threshold: 6.0581e+00
[rank0]:2025-12-27 00:23:49,033 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-27 00:23:49,062 - Freezing Ratio: [Stage0] 0.24, Threshold: 4.0474e+00
[rank2]:2025-12-27 00:23:49,047 - Freezing Ratio: [Stage2] 0.50, Threshold: 2.6317e+00
[rank3]:2025-12-27 00:23:49,054 - Freezing Ratio: [Stage3] 0.00, Threshold: 2.7797e+00
[rank1]:2025-12-27 00:23:49,050 - Freezing Ratio: [Stage1] 0.00, Threshold: 2.1197e+00
[rank2]:2025-12-27 00:23:53,996 - Avg. fwd time: 7.4252 / Avg. bwd time: 19.7056 / Avg. batch time: 544.6921 (ms) / GPU bubble ratio: 60.15%
[rank3]:2025-12-27 00:23:53,977 - Avg. fwd time: 13.7801 / Avg. bwd time: 42.3683 / Avg. batch time: 512.6325 (ms) / GPU bubble ratio: 12.38%
[rank0]:2025-12-27 00:23:54,054 - Avg. fwd time: 7.7063 / Avg. bwd time: 24.7296 / Avg. batch time: 622.0785 (ms) / GPU bubble ratio: 58.29%
[rank0]:2025-12-27 00:23:54,086 -  step: 100  loss: -8.0000  grad_norm:  8.1683  memory: 13.42GiB(28.26%)  tps: 6,462  tflops: 50.52  mfu: 16.19%
[rank2]:2025-12-27 00:23:54,068 -  step: 100  loss: -8.0000  grad_norm:  8.1683  memory:  6.98GiB(14.69%)  tps: 6,462  tflops: 50.52  mfu: 16.19%
[rank3]:2025-12-27 00:23:54,087 -  step: 100  loss:  8.3462  grad_norm:  8.1683  memory: 16.39GiB(34.50%)  tps: 6,462  tflops: 50.51  mfu: 16.19%
[rank1]:2025-12-27 00:23:54,026 - Avg. fwd time: 9.2834 / Avg. bwd time: 24.8904 / Avg. batch time: 584.1500 (ms) / GPU bubble ratio: 53.20%
[rank1]:2025-12-27 00:23:54,078 -  step: 100  loss: -8.0000  grad_norm:  8.1683  memory:  9.50GiB(19.99%)  tps: 6,462  tflops: 50.51  mfu: 16.19%
[rank0]:2025-12-27 00:23:54,157 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p50_42_dm1/frozen_ratio_history/rank0/251227_0023_stage0_step100.svg
[rank2]:2025-12-27 00:23:54,156 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p50_42_dm1/frozen_ratio_history/rank2/251227_0023_stage2_step100.svg
[rank1]:2025-12-27 00:23:54,155 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p50_42_dm1/frozen_ratio_history/rank1/251227_0023_stage1_step100.svg
[rank3]:2025-12-27 00:23:54,249 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p50_42_dm1/pipeline_schedule/251227_0023_step100_rank3.svg
[rank3]:			> Batch Time: 604.62 ms, GPU Bubble Ratio: 56.43%, 54.72%, 63.56%, 29.23%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-7-33ms      | [S0,MB0,B]  144-25-169ms   | [S0,MB4,F]  170-7-177ms    | [S0,MB1,B]  202-25-227ms   | [S0,MB5,F]  227-7-234ms    | [S0,MB2,B]  263-25-289ms   | [S0,MB6,F]  288-7-296ms    | [S0,MB3,B]  327-25-352ms   | [S0,MB7,F]  352-7-359ms    | [S0,MB4,B]  390-25-415ms   | [S0,MB5,B]  452-25-477ms   | [S0,MB6,B]  515-25-540ms   | [S0,MB7,B]  579-25-604ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-8-32ms      | [S1,MB2,F]  35-8-44ms      | [S1,MB0,B]  114-25-139ms   | [S1,MB3,F]  143-8-152ms    | [S1,MB1,B]  172-25-197ms   | [S1,MB4,F]  200-9-209ms    | [S1,MB2,B]  233-25-258ms   | [S1,MB5,F]  262-9-271ms    | [S1,MB3,B]  297-25-322ms   | [S1,MB6,F]  325-8-334ms    | [S1,MB4,B]  360-25-385ms   | [S1,MB7,F]  389-8-397ms    | [S1,MB5,B]  424-24-449ms   | [S1,MB6,B]  486-25-511ms   | [S1,MB7,B]  551-24-575ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  32-7-39ms      | [S2,MB0,B]  89-20-110ms    | [S2,MB2,F]  113-7-120ms    | [S2,MB1,B]  147-20-167ms   | [S2,MB3,F]  170-7-177ms    | [S2,MB2,B]  209-20-229ms   | [S2,MB4,F]  231-7-239ms    | [S2,MB3,B]  273-20-293ms   | [S2,MB5,F]  295-7-302ms    | [S2,MB4,B]  337-20-357ms   | [S2,MB6,F]  359-7-366ms    | [S2,MB5,B]  399-20-419ms   | [S2,MB7,F]  422-7-430ms    | [S2,MB6,B]  463-20-483ms   | [S2,MB7,B]  527-20-547ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  48-37-85ms     | [S3,MB1,F]  88-11-99ms     | [S3,MB1,B]  105-38-143ms   | [S3,MB2,F]  146-12-158ms   | [S3,MB2,B]  165-39-204ms   | [S3,MB3,F]  207-14-221ms   | [S3,MB3,B]  227-41-269ms   | [S3,MB4,F]  272-13-285ms   | [S3,MB4,B]  291-41-332ms   | [S3,MB5,F]  335-13-349ms   | [S3,MB5,B]  355-40-396ms   | [S3,MB6,F]  397-14-412ms   | [S3,MB6,B]  419-40-459ms   | [S3,MB7,F]  461-14-476ms   | [S3,MB7,B]  482-40-523ms  
[rank3]:2025-12-27 00:23:54,293 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p50_42_dm1/frozen_ratio_history/rank3/251227_0023_stage3_step100.svg
[rank1]:2025-12-27 00:23:54,303 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p50_42_dm1/frozen_params_histogram/251227_0023_rank1_stage1.svg
[rank1]:	> Counts Sum: 0, Total Sum: 225 (0.00%), Ratio(%) per element: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-12-27 00:23:54,313 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p50_42_dm1/frozen_params_histogram/251227_0023_rank0_stage0.svg
[rank0]:	> Counts Sum: 18, Total Sum: 185 (9.73%), Ratio(%) per element: [0.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-12-27 00:23:54,311 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p50_42_dm1/frozen_params_histogram/251227_0023_rank2_stage2.svg
[rank2]:	> Counts Sum: 27, Total Sum: 180 (15.00%), Ratio(%) per element: [40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-27 00:23:54,429 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p50_42_dm1/frozen_params_histogram/251227_0023_rank3_stage3.svg
[rank3]:	> Counts Sum: 18, Total Sum: 145 (12.41%), Ratio(%) per element: [40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-12-27 00:24:39,955 - Freezing Ratio: [Stage0] 0.00, Threshold: 1.3756e+00
[rank2]:2025-12-27 00:24:39,935 - Freezing Ratio: [Stage2] 0.00, Threshold: 2.2359e+00
[rank3]:2025-12-27 00:24:39,955 - Freezing Ratio: [Stage3] 0.31, Threshold: 2.0509e+00
[rank1]:2025-12-27 00:24:39,947 - Freezing Ratio: [Stage1] 0.40, Threshold: 8.8267e-01
[rank0]:2025-12-27 00:25:28,818 - Freezing Ratio: [Stage0] 0.24, Threshold: 2.8360e+00
[rank2]:2025-12-27 00:25:28,802 - Freezing Ratio: [Stage2] 0.50, Threshold: 1.7863e+00
[rank3]:2025-12-27 00:25:28,810 - Freezing Ratio: [Stage3] 0.00, Threshold: 4.5143e+00
[rank1]:2025-12-27 00:25:28,798 - Freezing Ratio: [Stage1] 0.00, Threshold: 3.1667e+00
[rank2]:2025-12-27 00:25:58,945 - Avg. fwd time: 7.4955 / Avg. bwd time: 19.0899 / Avg. batch time: 542.4570 (ms) / GPU bubble ratio: 60.79%
[rank3]:2025-12-27 00:25:58,924 - Avg. fwd time: 13.7418 / Avg. bwd time: 42.2031 / Avg. batch time: 510.9837 (ms) / GPU bubble ratio: 12.41%
[rank1]:2025-12-27 00:25:58,976 - Avg. fwd time: 9.3274 / Avg. bwd time: 24.4393 / Avg. batch time: 581.4238 (ms) / GPU bubble ratio: 53.54%
[rank0]:2025-12-27 00:25:59,004 - Avg. fwd time: 7.7427 / Avg. bwd time: 24.4512 / Avg. batch time: 619.0385 (ms) / GPU bubble ratio: 58.39%
[rank0]:2025-12-27 00:26:19,427 - Freezing Ratio: [Stage0] 0.00, Threshold: 5.2418e+00
[rank2]:2025-12-27 00:26:19,408 - Freezing Ratio: [Stage2] 0.00, Threshold: 7.2385e+00
[rank3]:2025-12-27 00:26:19,427 - Freezing Ratio: [Stage3] 0.31, Threshold: 9.9866e+00
[rank1]:2025-12-27 00:26:19,420 - Freezing Ratio: [Stage1] 0.40, Threshold: 3.5707e+00
[rank2]:2025-12-27 00:27:08,145 - Freezing Ratio: [Stage2] 0.50, Threshold: 1.4505e+00
[rank3]:2025-12-27 00:27:08,153 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.9150e+00
[rank1]:2025-12-27 00:27:08,141 - Freezing Ratio: [Stage1] 0.00, Threshold: 2.4404e+00
[rank0]:2025-12-27 00:27:08,161 - Freezing Ratio: [Stage0] 0.24, Threshold: 2.5598e+00
[rank1]:2025-12-27 00:27:58,836 - Freezing Ratio: [Stage1] 0.40, Threshold: 2.4002e+00
[rank2]:2025-12-27 00:27:58,824 - Freezing Ratio: [Stage2] 0.00, Threshold: 3.2776e+00
[rank0]:2025-12-27 00:27:58,827 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-27 00:27:58,844 - Freezing Ratio: [Stage0] 0.00, Threshold: 2.5398e+00
[rank3]:2025-12-27 00:27:58,844 - Freezing Ratio: [Stage3] 0.31, Threshold: 2.7864e+00
[rank3]:2025-12-27 00:28:03,598 - Avg. fwd time: 13.7279 / Avg. bwd time: 42.0721 / Avg. batch time: 509.8140 (ms) / GPU bubble ratio: 12.44%
[rank0]:2025-12-27 00:28:03,681 - Avg. fwd time: 7.7641 / Avg. bwd time: 24.2856 / Avg. batch time: 616.9008 (ms) / GPU bubble ratio: 58.44%
[rank0]:2025-12-27 00:28:03,718 -  step: 150  loss: -8.0000  grad_norm: 11.9138  memory: 13.42GiB(28.26%)  tps: 6,563  tflops: 51.31  mfu: 16.45%
[rank2]:2025-12-27 00:28:03,625 - Avg. fwd time: 7.5363 / Avg. bwd time: 18.7202 / Avg. batch time: 540.8700 (ms) / GPU bubble ratio: 61.16%
[rank2]:2025-12-27 00:28:03,703 -  step: 150  loss: -8.0000  grad_norm: 11.9138  memory:  6.98GiB(14.69%)  tps: 6,563  tflops: 51.31  mfu: 16.44%
[rank3]:2025-12-27 00:28:03,712 -  step: 150  loss:  3.5419  grad_norm: 11.9138  memory: 16.39GiB(34.50%)  tps: 6,563  tflops: 51.31  mfu: 16.45%
[rank1]:2025-12-27 00:28:03,650 - Avg. fwd time: 9.3592 / Avg. bwd time: 24.1023 / Avg. batch time: 579.4732 (ms) / GPU bubble ratio: 53.80%
[rank1]:2025-12-27 00:28:03,700 -  step: 150  loss: -8.0000  grad_norm: 11.9138  memory:  9.52GiB(20.03%)  tps: 6,564  tflops: 51.31  mfu: 16.45%
[rank3]:2025-12-27 00:28:47,774 - Freezing Ratio: [Stage3] 0.31, Threshold: 9.0589e+00
[rank2]:2025-12-27 00:28:47,766 - Freezing Ratio: [Stage2] 0.50, Threshold: 7.0812e+00
[rank1]:2025-12-27 00:28:47,762 - Freezing Ratio: [Stage1] 0.40, Threshold: 2.7954e+01
[rank0]:2025-12-27 00:28:47,783 - Freezing Ratio: [Stage0] 0.49, Threshold: 2.3574e+01
[rank3]:2025-12-27 00:29:35,925 - Freezing Ratio: [Stage3] 0.31, Threshold: 5.0930e+00
[rank2]:2025-12-27 00:29:35,909 - Freezing Ratio: [Stage2] 0.00, Threshold: 5.8166e+00
[rank0]:2025-12-27 00:29:35,925 - Freezing Ratio: [Stage0] 0.00, Threshold: 6.9104e+00
[rank1]:2025-12-27 00:29:35,913 - Freezing Ratio: [Stage1] 0.40, Threshold: 7.1398e+00
[rank3]:2025-12-27 00:30:05,025 - Avg. fwd time: 13.7343 / Avg. bwd time: 41.7268 / Avg. batch time: 507.0921 (ms) / GPU bubble ratio: 12.50%
[rank2]:2025-12-27 00:30:05,052 - Avg. fwd time: 7.5504 / Avg. bwd time: 18.5904 / Avg. batch time: 537.9855 (ms) / GPU bubble ratio: 61.13%
[rank1]:2025-12-27 00:30:05,077 - Avg. fwd time: 9.4350 / Avg. bwd time: 23.4127 / Avg. batch time: 575.8783 (ms) / GPU bubble ratio: 54.37%
[rank0]:2025-12-27 00:30:05,109 - Avg. fwd time: 7.7914 / Avg. bwd time: 24.0767 / Avg. batch time: 613.0759 (ms) / GPU bubble ratio: 58.42%
[rank1]:2025-12-27 00:30:24,821 - Freezing Ratio: [Stage1] 0.40, Threshold: 8.7640e-01
[rank3]:2025-12-27 00:30:24,832 - Freezing Ratio: [Stage3] 0.62, Threshold: 2.5855e+00
[rank0]:2025-12-27 00:30:24,840 - Freezing Ratio: [Stage0] 0.49, Threshold: 3.3681e-01
[rank2]:2025-12-27 00:30:24,825 - Freezing Ratio: [Stage2] 0.50, Threshold: 1.1699e+00
[rank2]:2025-12-27 00:31:11,118 - Freezing Ratio: [Stage2] 0.00, Threshold: 1.9485e+00
[rank3]:2025-12-27 00:31:11,130 - Freezing Ratio: [Stage3] 0.31, Threshold: 2.5292e+00
[rank0]:2025-12-27 00:31:11,134 - Freezing Ratio: [Stage0] 0.00, Threshold: 1.6971e+00
[rank1]:2025-12-27 00:31:11,123 - Freezing Ratio: [Stage1] 0.60, Threshold: 6.6865e-01
[rank1]:2025-12-27 00:31:59,863 - Freezing Ratio: [Stage1] 0.40, Threshold: 2.3306e+00
[rank2]:2025-12-27 00:31:59,871 - Freezing Ratio: [Stage2] 0.50, Threshold: 1.0134e+00
[rank3]:2025-12-27 00:31:59,878 - Freezing Ratio: [Stage3] 0.62, Threshold: 7.3348e-01
[rank0]:2025-12-27 00:31:59,857 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-27 00:31:59,887 - Freezing Ratio: [Stage0] 0.49, Threshold: 1.4005e+00
[rank2]:2025-12-27 00:32:04,476 - Avg. fwd time: 7.5664 / Avg. bwd time: 18.4715 / Avg. batch time: 534.7743 (ms) / GPU bubble ratio: 61.05%
[rank3]:2025-12-27 00:32:04,455 - Avg. fwd time: 13.7892 / Avg. bwd time: 41.2895 / Avg. batch time: 504.0248 (ms) / GPU bubble ratio: 12.58%
[rank0]:2025-12-27 00:32:04,528 - Avg. fwd time: 7.8168 / Avg. bwd time: 23.8983 / Avg. batch time: 608.9943 (ms) / GPU bubble ratio: 58.34%
[rank1]:2025-12-27 00:32:04,502 - Avg. fwd time: 9.5082 / Avg. bwd time: 22.7579 / Avg. batch time: 571.9961 (ms) / GPU bubble ratio: 54.87%
[rank1]:2025-12-27 00:32:04,544 -  step: 200  loss: -8.0000  grad_norm:  7.9138  memory:  9.52GiB(20.03%)  tps: 6,803  tflops: 53.18  mfu: 17.05%
[rank2]:2025-12-27 00:32:04,541 -  step: 200  loss: -8.0000  grad_norm:  7.9138  memory:  6.98GiB(14.69%)  tps: 6,803  tflops: 53.18  mfu: 17.05%
[rank2]:2025-12-27 00:32:04,605 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p50_42_dm1/frozen_ratio_history/rank2/251227_0032_stage2_step200.svg
[rank3]:2025-12-27 00:32:04,554 -  step: 200  loss:  1.0796  grad_norm:  7.9138  memory: 16.39GiB(34.50%)  tps: 6,803  tflops: 53.18  mfu: 17.05%
[rank0]:2025-12-27 00:32:04,555 -  step: 200  loss: -8.0000  grad_norm:  7.9138  memory: 13.42GiB(28.26%)  tps: 6,803  tflops: 53.18  mfu: 17.05%
[rank0]:2025-12-27 00:32:04,604 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p50_42_dm1/frozen_ratio_history/rank0/251227_0032_stage0_step200.svg
[rank1]:2025-12-27 00:32:04,605 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p50_42_dm1/frozen_ratio_history/rank1/251227_0032_stage1_step200.svg
[rank3]:2025-12-27 00:32:04,698 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p50_42_dm1/pipeline_schedule/251227_0032_step200_rank3.svg
[rank3]:			> Batch Time: 588.19 ms, GPU Bubble Ratio: 55.15%, 63.68%, 62.48%, 27.81%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-17ms       | [S0,MB2,F]  17-7-25ms      | [S0,MB3,F]  25-7-32ms      | [S0,MB0,B]  136-25-161ms   | [S0,MB4,F]  161-7-168ms    | [S0,MB1,B]  193-25-218ms   | [S0,MB5,F]  218-7-226ms    | [S0,MB2,B]  253-25-278ms   | [S0,MB6,F]  278-7-285ms    | [S0,MB3,B]  315-25-341ms   | [S0,MB7,F]  341-7-348ms    | [S0,MB4,B]  378-25-403ms   | [S0,MB5,B]  439-25-464ms   | [S0,MB6,B]  499-25-524ms   | [S0,MB7,B]  563-25-588ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-10-33ms     | [S1,MB2,F]  36-10-46ms     | [S1,MB0,B]  114-16-131ms   | [S1,MB3,F]  134-10-145ms   | [S1,MB1,B]  171-16-188ms   | [S1,MB4,F]  191-10-201ms   | [S1,MB2,B]  231-16-248ms   | [S1,MB5,F]  251-10-261ms   | [S1,MB3,B]  294-16-310ms   | [S1,MB6,F]  314-10-324ms   | [S1,MB4,B]  357-16-373ms   | [S1,MB7,F]  377-10-387ms   | [S1,MB5,B]  419-16-436ms   | [S1,MB6,B]  480-16-496ms   | [S1,MB7,B]  543-16-559ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  33-7-40ms      | [S2,MB0,B]  89-20-109ms    | [S2,MB2,F]  113-7-120ms    | [S2,MB1,B]  146-20-166ms   | [S2,MB3,F]  170-7-177ms    | [S2,MB2,B]  206-20-226ms   | [S2,MB4,F]  230-7-237ms    | [S2,MB3,B]  268-20-289ms   | [S2,MB5,F]  292-7-299ms    | [S2,MB4,B]  331-20-352ms   | [S2,MB6,F]  355-7-362ms    | [S2,MB5,B]  394-20-414ms   | [S2,MB7,F]  417-7-424ms    | [S2,MB6,B]  456-20-476ms   | [S2,MB7,B]  519-20-539ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  48-36-85ms     | [S3,MB1,F]  87-11-99ms     | [S3,MB1,B]  104-37-142ms   | [S3,MB2,F]  144-13-158ms   | [S3,MB2,B]  163-39-202ms   | [S3,MB3,F]  204-14-219ms   | [S3,MB3,B]  224-40-264ms   | [S3,MB4,F]  267-13-281ms   | [S3,MB4,B]  287-41-328ms   | [S3,MB5,F]  330-13-343ms   | [S3,MB5,B]  349-40-390ms   | [S3,MB6,F]  392-14-406ms   | [S3,MB6,B]  412-40-452ms   | [S3,MB7,F]  454-14-469ms   | [S3,MB7,B]  476-39-516ms  
[rank1]:2025-12-27 00:32:04,746 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p50_42_dm1/frozen_params_histogram/251227_0032_rank1_stage1.svg
[rank1]:	> Counts Sum: 153, Total Sum: 675 (22.67%), Ratio(%) per element: [53.33, 53.33, 53.33, 53.33, 53.33, 53.33, 53.33, 53.33, 53.33, 53.33, 53.33, 53.33, 53.33, 53.33, 53.33, 53.33, 53.33, 53.33, 6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 6.66, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-12-27 00:32:04,755 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p50_42_dm1/frozen_params_histogram/251227_0032_rank2_stage2.svg
[rank2]:	> Counts Sum: 117, Total Sum: 540 (21.67%), Ratio(%) per element: [46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-27 00:32:04,744 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p50_42_dm1/frozen_ratio_history/rank3/251227_0032_stage3_step200.svg
[rank0]:2025-12-27 00:32:04,754 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p50_42_dm1/frozen_params_histogram/251227_0032_rank0_stage0.svg
[rank0]:	> Counts Sum: 90, Total Sum: 555 (16.22%), Ratio(%) per element: [0.0, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-27 00:32:04,876 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p50_42_dm1/frozen_params_histogram/251227_0032_rank3_stage3.svg
[rank3]:	> Counts Sum: 108, Total Sum: 435 (24.83%), Ratio(%) per element: [66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 13.33, 13.33, 13.33, 13.33, 13.33, 13.33, 13.33, 13.33, 13.33, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-12-27 00:32:46,631 - Freezing Ratio: [Stage1] 0.60, Threshold: 2.0629e+00
[rank2]:2025-12-27 00:32:46,627 - Freezing Ratio: [Stage2] 0.00, Threshold: 3.6514e+00
[rank3]:2025-12-27 00:32:46,639 - Freezing Ratio: [Stage3] 0.31, Threshold: 3.7994e+00
[rank0]:2025-12-27 00:32:46,642 - Freezing Ratio: [Stage0] 0.00, Threshold: 1.3237e+00
[rank1]:2025-12-27 00:33:35,353 - Freezing Ratio: [Stage1] 0.40, Threshold: 3.8380e+00
[rank2]:2025-12-27 00:33:35,360 - Freezing Ratio: [Stage2] 0.50, Threshold: 1.1039e+00
[rank3]:2025-12-27 00:33:35,368 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.5305e+00
[rank0]:2025-12-27 00:33:35,377 - Freezing Ratio: [Stage0] 0.49, Threshold: 1.7159e+00
[rank2]:2025-12-27 00:34:03,235 - Avg. fwd time: 7.5917 / Avg. bwd time: 18.2800 / Avg. batch time: 531.9040 (ms) / GPU bubble ratio: 61.09%
[rank3]:2025-12-27 00:34:03,213 - Avg. fwd time: 13.8401 / Avg. bwd time: 40.9003 / Avg. batch time: 501.3144 (ms) / GPU bubble ratio: 12.65%
[rank0]:2025-12-27 00:34:03,287 - Avg. fwd time: 7.8500 / Avg. bwd time: 23.6585 / Avg. batch time: 605.3594 (ms) / GPU bubble ratio: 58.36%
[rank1]:2025-12-27 00:34:03,261 - Avg. fwd time: 9.5650 / Avg. bwd time: 22.2512 / Avg. batch time: 568.6080 (ms) / GPU bubble ratio: 55.24%
[rank1]:2025-12-27 00:34:21,843 - Freezing Ratio: [Stage1] 0.60, Threshold: 3.5287e+00
[rank2]:2025-12-27 00:34:21,839 - Freezing Ratio: [Stage2] 0.00, Threshold: 3.5124e+00
[rank3]:2025-12-27 00:34:21,851 - Freezing Ratio: [Stage3] 0.31, Threshold: 2.0716e+00
[rank0]:2025-12-27 00:34:21,855 - Freezing Ratio: [Stage0] 0.00, Threshold: 3.6041e+00
[rank1]:2025-12-27 00:35:10,819 - Freezing Ratio: [Stage1] 0.40, Threshold: 4.5457e+00
[rank2]:2025-12-27 00:35:10,827 - Freezing Ratio: [Stage2] 0.50, Threshold: 2.3692e+00
[rank3]:2025-12-27 00:35:10,835 - Freezing Ratio: [Stage3] 0.62, Threshold: 2.9012e+00
[rank0]:2025-12-27 00:35:10,844 - Freezing Ratio: [Stage0] 0.49, Threshold: 2.4432e+00
[rank2]:2025-12-27 00:35:57,304 - Freezing Ratio: [Stage2] 0.00, Threshold: 1.4469e+00
[rank3]:2025-12-27 00:35:57,316 - Freezing Ratio: [Stage3] 0.31, Threshold: 1.5404e+00
[rank0]:2025-12-27 00:35:57,308 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-27 00:35:57,319 - Freezing Ratio: [Stage0] 0.00, Threshold: 1.6287e+00
[rank1]:2025-12-27 00:35:57,308 - Freezing Ratio: [Stage1] 0.60, Threshold: 7.6009e-01
[rank2]:2025-12-27 00:36:02,099 - Avg. fwd time: 7.6089 / Avg. bwd time: 18.1508 / Avg. batch time: 529.7490 (ms) / GPU bubble ratio: 61.10%
[rank3]:2025-12-27 00:36:02,072 - Avg. fwd time: 13.8907 / Avg. bwd time: 40.5996 / Avg. batch time: 499.3095 (ms) / GPU bubble ratio: 12.69%
[rank0]:2025-12-27 00:36:02,155 - Avg. fwd time: 7.8726 / Avg. bwd time: 23.4903 / Avg. batch time: 602.6000 (ms) / GPU bubble ratio: 58.36%
[rank1]:2025-12-27 00:36:02,122 - Avg. fwd time: 9.6106 / Avg. bwd time: 21.8350 / Avg. batch time: 566.0265 (ms) / GPU bubble ratio: 55.56%
[rank1]:2025-12-27 00:36:02,169 -  step: 250  loss: -8.0000  grad_norm:  1.9522  memory:  9.52GiB(20.03%)  tps: 6,895  tflops: 53.90  mfu: 17.28%
[rank2]:2025-12-27 00:36:02,176 -  step: 250  loss: -8.0000  grad_norm:  1.9522  memory:  6.98GiB(14.69%)  tps: 6,895  tflops: 53.90  mfu: 17.28%
[rank3]:2025-12-27 00:36:02,186 -  step: 250  loss:  0.3916  grad_norm:  1.9522  memory: 16.39GiB(34.50%)  tps: 6,895  tflops: 53.90  mfu: 17.28%
[rank0]:2025-12-27 00:36:02,191 -  step: 250  loss: -8.0000  grad_norm:  1.9522  memory: 13.42GiB(28.26%)  tps: 6,895  tflops: 53.90  mfu: 17.28%
[rank1]:2025-12-27 00:36:46,232 - Freezing Ratio: [Stage1] 0.40, Threshold: 1.4552e+00
[rank2]:2025-12-27 00:36:46,240 - Freezing Ratio: [Stage2] 0.50, Threshold: 3.6448e-01
[rank3]:2025-12-27 00:36:46,247 - Freezing Ratio: [Stage3] 0.62, Threshold: 6.4321e-01
[rank0]:2025-12-27 00:36:46,256 - Freezing Ratio: [Stage0] 0.49, Threshold: 1.5588e+00
[rank1]:2025-12-27 00:37:32,683 - Freezing Ratio: [Stage1] 0.60, Threshold: 1.2940e+01
[rank2]:2025-12-27 00:37:32,680 - Freezing Ratio: [Stage2] 0.50, Threshold: 1.1395e+01
[rank3]:2025-12-27 00:37:32,691 - Freezing Ratio: [Stage3] 0.31, Threshold: 8.8797e+00
[rank0]:2025-12-27 00:37:32,695 - Freezing Ratio: [Stage0] 0.49, Threshold: 1.1266e+01
[rank2]:2025-12-27 00:38:01,394 - Avg. fwd time: 7.6280 / Avg. bwd time: 18.0039 / Avg. batch time: 528.2619 (ms) / GPU bubble ratio: 61.18%
[rank3]:2025-12-27 00:38:01,372 - Avg. fwd time: 13.9205 / Avg. bwd time: 40.4049 / Avg. batch time: 497.9863 (ms) / GPU bubble ratio: 12.73%
[rank1]:2025-12-27 00:38:01,418 - Avg. fwd time: 9.6537 / Avg. bwd time: 21.4531 / Avg. batch time: 564.1483 (ms) / GPU bubble ratio: 55.89%
[rank0]:2025-12-27 00:38:01,444 - Avg. fwd time: 7.8960 / Avg. bwd time: 23.3108 / Avg. batch time: 600.5352 (ms) / GPU bubble ratio: 58.43%
[rank2]:2025-12-27 00:38:20,704 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.5107e+00
[rank3]:2025-12-27 00:38:20,720 - Freezing Ratio: [Stage3] 0.62, Threshold: 4.7964e-01
[rank0]:2025-12-27 00:38:20,720 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.8109e+00
[rank1]:2025-12-27 00:38:20,704 - Freezing Ratio: [Stage1] 0.40, Threshold: 1.7996e+00
[rank2]:2025-12-27 00:39:06,878 - Freezing Ratio: [Stage2] 0.50, Threshold: 8.9753e-01
[rank0]:2025-12-27 00:39:06,893 - Freezing Ratio: [Stage0] 0.49, Threshold: 1.5736e+00
[rank1]:2025-12-27 00:39:06,886 - Freezing Ratio: [Stage1] 0.60, Threshold: 1.3635e+00
[rank3]:2025-12-27 00:39:06,894 - Freezing Ratio: [Stage3] 0.31, Threshold: 7.8080e-01
[rank2]:2025-12-27 00:39:54,821 - Freezing Ratio: [Stage2] 0.75, Threshold: 4.3991e-01
[rank0]:2025-12-27 00:39:54,815 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-27 00:39:54,837 - Freezing Ratio: [Stage0] 0.73, Threshold: 9.2036e-01
[rank1]:2025-12-27 00:39:54,821 - Freezing Ratio: [Stage1] 0.40, Threshold: 1.6730e+00
[rank3]:2025-12-27 00:39:54,837 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.7353e-01
[rank3]:2025-12-27 00:39:59,326 - Avg. fwd time: 13.9601 / Avg. bwd time: 40.2425 / Avg. batch time: 497.0013 (ms) / GPU bubble ratio: 12.75%
[rank2]:2025-12-27 00:39:59,345 - Avg. fwd time: 7.6798 / Avg. bwd time: 17.6034 / Avg. batch time: 526.8601 (ms) / GPU bubble ratio: 61.61%
[rank1]:2025-12-27 00:39:59,371 - Avg. fwd time: 9.6897 / Avg. bwd time: 21.1449 / Avg. batch time: 562.4319 (ms) / GPU bubble ratio: 56.14%
[rank3]:2025-12-27 00:39:59,420 -  step: 300  loss:  0.2876  grad_norm:  0.3485  memory: 16.39GiB(34.50%)  tps: 6,906  tflops: 53.99  mfu: 17.30%
[rank2]:2025-12-27 00:39:59,404 -  step: 300  loss: -8.0000  grad_norm:  0.3485  memory:  6.98GiB(14.69%)  tps: 6,906  tflops: 53.99  mfu: 17.30%
[rank0]:2025-12-27 00:39:59,396 - Avg. fwd time: 7.9496 / Avg. bwd time: 22.8833 / Avg. batch time: 598.3823 (ms) / GPU bubble ratio: 58.78%
[rank0]:2025-12-27 00:39:59,419 -  step: 300  loss: -8.0000  grad_norm:  0.3485  memory: 13.42GiB(28.26%)  tps: 6,906  tflops: 53.99  mfu: 17.30%
[rank0]:2025-12-27 00:39:59,471 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p50_42_dm1/frozen_ratio_history/rank0/251227_0039_stage0_step300.svg
[rank1]:2025-12-27 00:39:59,411 -  step: 300  loss: -8.0000  grad_norm:  0.3485  memory:  9.52GiB(20.03%)  tps: 6,906  tflops: 53.99  mfu: 17.30%
[rank1]:2025-12-27 00:39:59,470 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p50_42_dm1/frozen_ratio_history/rank1/251227_0039_stage1_step300.svg
[rank2]:2025-12-27 00:39:59,471 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p50_42_dm1/frozen_ratio_history/rank2/251227_0039_stage2_step300.svg
[rank3]:2025-12-27 00:39:59,565 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p50_42_dm1/pipeline_schedule/251227_0039_step300_rank3.svg
[rank3]:			> Batch Time: 583.98 ms, GPU Bubble Ratio: 61.74%, 63.33%, 69.06%, 26.43%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-8-18ms       | [S0,MB2,F]  18-8-27ms      | [S0,MB3,F]  27-8-35ms      | [S0,MB0,B]  131-19-150ms   | [S0,MB4,F]  150-7-158ms    | [S0,MB1,B]  188-19-208ms   | [S0,MB5,F]  208-7-216ms    | [S0,MB2,B]  250-19-269ms   | [S0,MB6,F]  269-7-277ms    | [S0,MB3,B]  313-19-333ms   | [S0,MB7,F]  333-8-341ms    | [S0,MB4,B]  377-19-397ms   | [S0,MB5,B]  439-19-458ms   | [S0,MB6,B]  501-19-520ms   | [S0,MB7,B]  564-19-583ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-10-33ms     | [S1,MB2,F]  36-10-47ms     | [S1,MB0,B]  109-16-126ms   | [S1,MB3,F]  129-10-139ms   | [S1,MB1,B]  167-16-183ms   | [S1,MB4,F]  187-10-197ms   | [S1,MB2,B]  228-16-244ms   | [S1,MB5,F]  248-10-258ms   | [S1,MB3,B]  292-16-308ms   | [S1,MB6,F]  312-10-322ms   | [S1,MB4,B]  355-16-372ms   | [S1,MB7,F]  375-10-386ms   | [S1,MB5,B]  419-16-435ms   | [S1,MB6,B]  481-16-497ms   | [S1,MB7,B]  544-16-561ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  33-7-41ms      | [S2,MB0,B]  89-14-104ms    | [S2,MB2,F]  107-8-115ms    | [S2,MB1,B]  147-14-162ms   | [S2,MB3,F]  165-8-173ms    | [S2,MB2,B]  208-14-223ms   | [S2,MB4,F]  226-8-234ms    | [S2,MB3,B]  272-14-287ms   | [S2,MB5,F]  290-8-298ms    | [S2,MB4,B]  336-14-350ms   | [S2,MB6,F]  354-8-362ms    | [S2,MB5,B]  399-14-414ms   | [S2,MB7,F]  417-8-425ms    | [S2,MB6,B]  463-14-478ms   | [S2,MB7,B]  526-14-541ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  48-37-85ms     | [S3,MB1,F]  88-11-99ms     | [S3,MB1,B]  105-38-143ms   | [S3,MB2,F]  146-14-160ms   | [S3,MB2,B]  164-39-204ms   | [S3,MB3,F]  207-14-221ms   | [S3,MB3,B]  227-40-267ms   | [S3,MB4,F]  271-14-285ms   | [S3,MB4,B]  290-41-332ms   | [S3,MB5,F]  334-14-349ms   | [S3,MB5,B]  355-40-395ms   | [S3,MB6,F]  398-14-412ms   | [S3,MB6,B]  419-40-459ms   | [S3,MB7,F]  461-15-477ms   | [S3,MB7,B]  482-40-523ms  
[rank3]:2025-12-27 00:39:59,613 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p50_42_dm1/frozen_ratio_history/rank3/251227_0039_stage3_step300.svg
[rank2]:2025-12-27 00:39:59,623 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p50_42_dm1/frozen_params_histogram/251227_0039_rank2_stage2.svg
[rank2]:	> Counts Sum: 261, Total Sum: 900 (29.00%), Ratio(%) per element: [56.0, 56.0, 56.0, 56.0, 56.0, 56.0, 56.0, 56.0, 56.0, 52.0, 52.0, 52.0, 52.0, 52.0, 52.0, 52.0, 52.0, 52.0, 8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-12-27 00:39:59,621 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p50_42_dm1/frozen_params_histogram/251227_0039_rank0_stage0.svg
[rank0]:	> Counts Sum: 234, Total Sum: 925 (25.30%), Ratio(%) per element: [0.0, 56.0, 56.0, 56.0, 56.0, 56.0, 56.0, 56.0, 56.0, 56.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-12-27 00:39:59,613 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p50_42_dm1/frozen_params_histogram/251227_0039_rank1_stage1.svg
[rank1]:	> Counts Sum: 378, Total Sum: 1125 (33.60%), Ratio(%) per element: [72.0, 72.0, 72.0, 72.0, 72.0, 72.0, 72.0, 72.0, 72.0, 72.0, 72.0, 72.0, 72.0, 72.0, 72.0, 72.0, 72.0, 72.0, 24.0, 24.0, 24.0, 24.0, 24.0, 24.0, 24.0, 24.0, 24.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-27 00:39:59,755 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p50_42_dm1/frozen_params_histogram/251227_0039_rank3_stage3.svg
[rank3]:	> Counts Sum: 243, Total Sum: 725 (33.52%), Ratio(%) per element: [80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 28.0, 28.0, 28.0, 28.0, 28.0, 28.0, 28.0, 28.0, 28.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-12-27 00:40:40,987 - Freezing Ratio: [Stage2] 0.50, Threshold: 1.5134e+00
[rank0]:2025-12-27 00:40:41,003 - Freezing Ratio: [Stage0] 0.49, Threshold: 1.2598e+00
[rank1]:2025-12-27 00:40:40,995 - Freezing Ratio: [Stage1] 0.60, Threshold: 1.0864e+00
[rank3]:2025-12-27 00:40:41,003 - Freezing Ratio: [Stage3] 0.31, Threshold: 1.2662e+00
[rank1]:2025-12-27 00:41:28,786 - Freezing Ratio: [Stage1] 0.40, Threshold: 1.4538e+00
[rank0]:2025-12-27 00:41:28,802 - Freezing Ratio: [Stage0] 0.73, Threshold: 7.1193e-01
[rank3]:2025-12-27 00:41:28,802 - Freezing Ratio: [Stage3] 0.62, Threshold: 8.3848e-01
[rank2]:2025-12-27 00:41:28,786 - Freezing Ratio: [Stage2] 0.75, Threshold: 6.1735e-01
[rank3]:2025-12-27 00:41:56,150 - Avg. fwd time: 13.9889 / Avg. bwd time: 40.0511 / Avg. batch time: 495.6959 (ms) / GPU bubble ratio: 12.79%
[rank2]:2025-12-27 00:41:56,170 - Avg. fwd time: 7.7281 / Avg. bwd time: 17.2282 / Avg. batch time: 525.2059 (ms) / GPU bubble ratio: 61.99%
[rank1]:2025-12-27 00:41:56,198 - Avg. fwd time: 9.7158 / Avg. bwd time: 20.9188 / Avg. batch time: 560.5454 (ms) / GPU bubble ratio: 56.28%
[rank0]:2025-12-27 00:41:56,222 - Avg. fwd time: 7.9993 / Avg. bwd time: 22.4851 / Avg. batch time: 596.0890 (ms) / GPU bubble ratio: 59.09%
[rank2]:2025-12-27 00:42:14,705 - Freezing Ratio: [Stage2] 0.50, Threshold: 2.9745e+00
[rank1]:2025-12-27 00:42:14,712 - Freezing Ratio: [Stage1] 0.60, Threshold: 2.1752e+00
[rank0]:2025-12-27 00:42:14,720 - Freezing Ratio: [Stage0] 0.49, Threshold: 2.5261e+00
[rank3]:2025-12-27 00:42:14,720 - Freezing Ratio: [Stage3] 0.31, Threshold: 5.1786e+00
[rank2]:2025-12-27 00:43:02,267 - Freezing Ratio: [Stage2] 0.75, Threshold: 2.7746e-01
[rank1]:2025-12-27 00:43:02,267 - Freezing Ratio: [Stage1] 0.40, Threshold: 1.1186e+00
[rank0]:2025-12-27 00:43:02,283 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.2404e+00
[rank3]:2025-12-27 00:43:02,283 - Freezing Ratio: [Stage3] 0.62, Threshold: 4.1632e-01
[rank0]:2025-12-27 00:43:47,893 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-12-27 00:43:47,901 - Freezing Ratio: [Stage3] 0.31, Threshold: 1.3768e+00
[rank2]:2025-12-27 00:43:47,885 - Freezing Ratio: [Stage2] 0.50, Threshold: 1.3980e+00
[rank1]:2025-12-27 00:43:47,893 - Freezing Ratio: [Stage1] 0.60, Threshold: 1.1903e+00
[rank0]:2025-12-27 00:43:47,901 - Freezing Ratio: [Stage0] 0.49, Threshold: 1.9645e+00
[rank2]:2025-12-27 00:43:52,652 - Avg. fwd time: 7.7685 / Avg. bwd time: 16.9140 / Avg. batch time: 523.7019 (ms) / GPU bubble ratio: 62.30%
[rank1]:2025-12-27 00:43:52,676 - Avg. fwd time: 9.7391 / Avg. bwd time: 20.7153 / Avg. batch time: 558.8336 (ms) / GPU bubble ratio: 56.40%
[rank0]:2025-12-27 00:43:52,704 - Avg. fwd time: 8.0408 / Avg. bwd time: 22.1508 / Avg. batch time: 594.0386 (ms) / GPU bubble ratio: 59.34%
[rank3]:2025-12-27 00:43:52,629 - Avg. fwd time: 14.0042 / Avg. bwd time: 39.8891 / Avg. batch time: 494.5188 (ms) / GPU bubble ratio: 12.82%
[rank2]:2025-12-27 00:43:52,717 -  step: 350  loss: -8.0000  grad_norm:  0.1786  memory:  6.98GiB(14.69%)  tps: 7,022  tflops: 54.90  mfu: 17.60%
[rank1]:2025-12-27 00:43:52,717 -  step: 350  loss: -8.0000  grad_norm:  0.1786  memory:  9.52GiB(20.03%)  tps: 7,023  tflops: 54.90  mfu: 17.60%
[rank0]:2025-12-27 00:43:52,731 -  step: 350  loss: -8.0000  grad_norm:  0.1786  memory: 13.42GiB(28.26%)  tps: 7,022  tflops: 54.90  mfu: 17.60%
[rank3]:2025-12-27 00:43:52,733 -  step: 350  loss:  0.2382  grad_norm:  0.1786  memory: 16.39GiB(34.50%)  tps: 7,022  tflops: 54.90  mfu: 17.60%
[rank2]:2025-12-27 00:44:35,507 - Freezing Ratio: [Stage2] 0.75, Threshold: 3.0162e-01
[rank1]:2025-12-27 00:44:35,507 - Freezing Ratio: [Stage1] 0.40, Threshold: 6.4901e-01
[rank0]:2025-12-27 00:44:35,522 - Freezing Ratio: [Stage0] 0.73, Threshold: 5.4695e-01
[rank3]:2025-12-27 00:44:35,523 - Freezing Ratio: [Stage3] 0.62, Threshold: 2.3493e-01
[rank2]:2025-12-27 00:45:21,321 - Freezing Ratio: [Stage2] 0.50, Threshold: 6.8862e-01
[rank1]:2025-12-27 00:45:21,329 - Freezing Ratio: [Stage1] 0.60, Threshold: 1.2489e+00
[rank0]:2025-12-27 00:45:21,337 - Freezing Ratio: [Stage0] 0.49, Threshold: 7.4547e-01
[rank3]:2025-12-27 00:45:21,337 - Freezing Ratio: [Stage3] 0.31, Threshold: 5.7304e-01
[rank3]:2025-12-27 00:45:49,719 - Avg. fwd time: 14.0034 / Avg. bwd time: 39.7809 / Avg. batch time: 493.6455 (ms) / GPU bubble ratio: 12.84%
[rank2]:2025-12-27 00:45:49,742 - Avg. fwd time: 7.7991 / Avg. bwd time: 16.6718 / Avg. batch time: 522.5733 (ms) / GPU bubble ratio: 62.54%
[rank1]:2025-12-27 00:45:49,767 - Avg. fwd time: 9.7627 / Avg. bwd time: 20.5078 / Avg. batch time: 557.4926 (ms) / GPU bubble ratio: 56.56%
[rank0]:2025-12-27 00:45:49,795 - Avg. fwd time: 8.0725 / Avg. bwd time: 21.8914 / Avg. batch time: 592.4348 (ms) / GPU bubble ratio: 59.54%
[rank3]:2025-12-27 00:46:08,894 - Freezing Ratio: [Stage3] 0.62, Threshold: 5.8866e-01
[rank0]:2025-12-27 00:46:08,895 - Freezing Ratio: [Stage0] 0.73, Threshold: 9.5763e-01
[rank2]:2025-12-27 00:46:08,879 - Freezing Ratio: [Stage2] 0.75, Threshold: 5.3561e-01
[rank1]:2025-12-27 00:46:08,879 - Freezing Ratio: [Stage1] 0.40, Threshold: 2.6537e+00
[rank2]:2025-12-27 00:46:54,550 - Freezing Ratio: [Stage2] 0.50, Threshold: 1.9602e-01
[rank1]:2025-12-27 00:46:54,558 - Freezing Ratio: [Stage1] 0.60, Threshold: 2.1326e-01
[rank0]:2025-12-27 00:46:54,565 - Freezing Ratio: [Stage0] 0.49, Threshold: 3.8415e-01
[rank3]:2025-12-27 00:46:54,566 - Freezing Ratio: [Stage3] 0.31, Threshold: 5.5015e-01
[rank3]:2025-12-27 00:47:42,323 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.1684e-01
[rank0]:2025-12-27 00:47:42,301 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-27 00:47:42,322 - Freezing Ratio: [Stage0] 0.73, Threshold: 2.1723e-01
[rank2]:2025-12-27 00:47:42,307 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.5033e-01
[rank1]:2025-12-27 00:47:42,307 - Freezing Ratio: [Stage1] 0.40, Threshold: 3.9191e-01
[rank3]:2025-12-27 00:47:46,904 - Avg. fwd time: 14.0127 / Avg. bwd time: 39.6827 / Avg. batch time: 492.9335 (ms) / GPU bubble ratio: 12.86%
[rank2]:2025-12-27 00:47:46,924 - Avg. fwd time: 7.8273 / Avg. bwd time: 16.4526 / Avg. batch time: 521.6321 (ms) / GPU bubble ratio: 62.76%
[rank2]:2025-12-27 00:47:46,986 -  step: 400  loss: -8.0000  grad_norm:  0.2936  memory:  6.98GiB(14.69%)  tps: 6,994  tflops: 54.67  mfu: 17.52%
[rank1]:2025-12-27 00:47:46,952 - Avg. fwd time: 9.7832 / Avg. bwd time: 20.3338 / Avg. batch time: 556.3741 (ms) / GPU bubble ratio: 56.70%
[rank1]:2025-12-27 00:47:46,993 -  step: 400  loss: -8.0000  grad_norm:  0.2936  memory:  9.52GiB(20.03%)  tps: 6,993  tflops: 54.67  mfu: 17.52%
[rank3]:2025-12-27 00:47:47,002 -  step: 400  loss:  0.2271  grad_norm:  0.2936  memory: 16.39GiB(34.50%)  tps: 6,994  tflops: 54.67  mfu: 17.52%
[rank0]:2025-12-27 00:47:46,977 - Avg. fwd time: 8.1017 / Avg. bwd time: 21.6576 / Avg. batch time: 591.0795 (ms) / GPU bubble ratio: 59.72%
[rank0]:2025-12-27 00:47:47,000 -  step: 400  loss: -8.0000  grad_norm:  0.2936  memory: 13.42GiB(28.26%)  tps: 6,994  tflops: 54.67  mfu: 17.52%
[rank2]:2025-12-27 00:47:47,056 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p50_42_dm1/frozen_ratio_history/rank2/251227_0047_stage2_step400.svg
[rank1]:2025-12-27 00:47:47,056 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p50_42_dm1/frozen_ratio_history/rank1/251227_0047_stage1_step400.svg
[rank0]:2025-12-27 00:47:47,057 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p50_42_dm1/frozen_ratio_history/rank0/251227_0047_stage0_step400.svg
[rank1]:2025-12-27 00:47:47,199 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p50_42_dm1/frozen_params_histogram/251227_0047_rank1_stage1.svg
[rank1]:	> Counts Sum: 603, Total Sum: 1575 (38.29%), Ratio(%) per element: [80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 31.42, 31.42, 31.42, 31.42, 31.42, 31.42, 31.42, 31.42, 31.42, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-27 00:47:47,139 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p50_42_dm1/pipeline_schedule/251227_0047_step400_rank3.svg
[rank3]:			> Batch Time: 579.95 ms, GPU Bubble Ratio: 61.59%, 63.21%, 68.95%, 26.43%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-8-18ms       | [S0,MB2,F]  18-8-26ms      | [S0,MB3,F]  26-8-35ms      | [S0,MB0,B]  130-19-149ms   | [S0,MB4,F]  150-7-157ms    | [S0,MB1,B]  188-19-207ms   | [S0,MB5,F]  207-7-215ms    | [S0,MB2,B]  248-19-267ms   | [S0,MB6,F]  267-7-275ms    | [S0,MB3,B]  311-19-330ms   | [S0,MB7,F]  330-7-338ms    | [S0,MB4,B]  375-19-394ms   | [S0,MB5,B]  435-19-454ms   | [S0,MB6,B]  496-19-515ms   | [S0,MB7,B]  560-19-579ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-10-33ms     | [S1,MB2,F]  36-10-46ms     | [S1,MB0,B]  108-16-125ms   | [S1,MB3,F]  128-10-138ms   | [S1,MB1,B]  166-16-183ms   | [S1,MB4,F]  186-10-196ms   | [S1,MB2,B]  226-16-242ms   | [S1,MB5,F]  246-10-256ms   | [S1,MB3,B]  289-16-306ms   | [S1,MB6,F]  309-10-319ms   | [S1,MB4,B]  353-16-370ms   | [S1,MB7,F]  373-10-383ms   | [S1,MB5,B]  415-16-431ms   | [S1,MB6,B]  476-16-492ms   | [S1,MB7,B]  540-16-556ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  33-7-41ms      | [S2,MB0,B]  89-14-103ms    | [S2,MB2,F]  107-7-115ms    | [S2,MB1,B]  147-14-161ms   | [S2,MB3,F]  165-7-173ms    | [S2,MB2,B]  206-14-221ms   | [S2,MB4,F]  224-7-232ms    | [S2,MB3,B]  270-14-284ms   | [S2,MB5,F]  288-7-295ms    | [S2,MB4,B]  333-14-348ms   | [S2,MB6,F]  351-7-359ms    | [S2,MB5,B]  396-14-410ms   | [S2,MB7,F]  414-7-421ms    | [S2,MB6,B]  459-14-473ms   | [S2,MB7,B]  522-14-536ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  48-36-85ms     | [S3,MB1,F]  87-11-99ms     | [S3,MB1,B]  105-38-143ms   | [S3,MB2,F]  145-14-160ms   | [S3,MB2,B]  164-39-203ms   | [S3,MB3,F]  205-14-220ms   | [S3,MB3,B]  226-40-266ms   | [S3,MB4,F]  268-14-282ms   | [S3,MB4,B]  289-40-330ms   | [S3,MB5,F]  332-13-346ms   | [S3,MB5,B]  351-40-392ms   | [S3,MB6,F]  394-14-408ms   | [S3,MB6,B]  415-40-455ms   | [S3,MB7,F]  457-14-471ms   | [S3,MB7,B]  478-39-518ms  
[rank3]:2025-12-27 00:47:47,186 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p50_42_dm1/frozen_ratio_history/rank3/251227_0047_stage3_step400.svg
[rank0]:2025-12-27 00:47:47,209 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p50_42_dm1/frozen_params_histogram/251227_0047_rank0_stage0.svg
[rank0]:	> Counts Sum: 459, Total Sum: 1295 (35.44%), Ratio(%) per element: [0.0, 68.57, 68.57, 68.57, 68.57, 68.57, 68.57, 68.57, 68.57, 68.57, 57.14, 57.14, 57.14, 57.14, 57.14, 57.14, 57.14, 57.14, 57.14, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-12-27 00:47:47,203 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p50_42_dm1/frozen_params_histogram/251227_0047_rank2_stage2.svg
[rank2]:	> Counts Sum: 486, Total Sum: 1260 (38.57%), Ratio(%) per element: [68.57, 68.57, 68.57, 68.57, 68.57, 68.57, 68.57, 68.57, 68.57, 65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 65.71, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-27 00:47:47,318 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p50_42_dm1/frozen_params_histogram/251227_0047_rank3_stage3.svg
[rank3]:	> Counts Sum: 378, Total Sum: 1015 (37.24%), Ratio(%) per element: [85.71, 85.71, 85.71, 85.71, 85.71, 85.71, 85.71, 85.71, 85.71, 34.28, 34.28, 34.28, 34.28, 34.28, 34.28, 34.28, 34.28, 34.28, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-27 00:48:13,155 - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-12-27 00:48:13,393 - Dataset alpaca_gpt4 is being re-looped
[rank1]:2025-12-27 00:48:13,414 - Dataset alpaca_gpt4 is being re-looped
[rank0]:2025-12-27 00:48:13,433 - Dataset alpaca_gpt4 is being re-looped
[rank2]:2025-12-27 00:48:28,398 - Freezing Ratio: [Stage2] 0.50, Threshold: 2.8036e+00
[rank1]:2025-12-27 00:48:28,406 - Freezing Ratio: [Stage1] 0.60, Threshold: 2.9889e+00
[rank3]:2025-12-27 00:48:28,414 - Freezing Ratio: [Stage3] 0.31, Threshold: 2.1891e+00
[rank0]:2025-12-27 00:48:28,413 - Freezing Ratio: [Stage0] 0.49, Threshold: 2.8703e+00
[rank2]:2025-12-27 00:49:16,093 - Freezing Ratio: [Stage2] 0.75, Threshold: 4.4410e+00
[rank1]:2025-12-27 00:49:16,094 - Freezing Ratio: [Stage1] 0.60, Threshold: 9.5736e+00
[rank3]:2025-12-27 00:49:16,109 - Freezing Ratio: [Stage3] 0.62, Threshold: 3.5345e+00
[rank0]:2025-12-27 00:49:16,109 - Freezing Ratio: [Stage0] 0.73, Threshold: 4.4635e+00
[rank3]:2025-12-27 00:49:43,370 - Avg. fwd time: 14.0266 / Avg. bwd time: 39.5679 / Avg. batch time: 492.1243 (ms) / GPU bubble ratio: 12.88%
[rank2]:2025-12-27 00:49:43,391 - Avg. fwd time: 7.8558 / Avg. bwd time: 16.2325 / Avg. batch time: 520.6173 (ms) / GPU bubble ratio: 62.99%
[rank1]:2025-12-27 00:49:43,417 - Avg. fwd time: 9.8025 / Avg. bwd time: 20.1671 / Avg. batch time: 555.1900 (ms) / GPU bubble ratio: 56.82%
[rank0]:2025-12-27 00:49:43,442 - Avg. fwd time: 8.1310 / Avg. bwd time: 21.4251 / Avg. batch time: 589.6589 (ms) / GPU bubble ratio: 59.90%
[rank2]:2025-12-27 00:50:01,469 - Freezing Ratio: [Stage2] 0.50, Threshold: 1.8216e+00
[rank1]:2025-12-27 00:50:01,472 - Freezing Ratio: [Stage1] 0.60, Threshold: 2.0709e+00
[rank3]:2025-12-27 00:50:01,484 - Freezing Ratio: [Stage3] 0.31, Threshold: 1.7730e+00
[rank0]:2025-12-27 00:50:01,484 - Freezing Ratio: [Stage0] 0.49, Threshold: 1.4302e+00
[rank2]:2025-12-27 00:50:49,290 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.0072e+00
[rank1]:2025-12-27 00:50:49,290 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.8848e+00
[rank0]:2025-12-27 00:50:49,306 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.0247e+00
[rank3]:2025-12-27 00:50:49,306 - Freezing Ratio: [Stage3] 0.62, Threshold: 9.4712e-01
[rank2]:2025-12-27 00:51:34,564 - Freezing Ratio: [Stage2] 0.50, Threshold: 1.9353e+00
[rank1]:2025-12-27 00:51:34,564 - Freezing Ratio: [Stage1] 0.60, Threshold: 1.5982e+00
[rank0]:2025-12-27 00:51:34,572 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-27 00:51:34,579 - Freezing Ratio: [Stage0] 0.49, Threshold: 2.4260e+00
[rank3]:2025-12-27 00:51:34,579 - Freezing Ratio: [Stage3] 0.31, Threshold: 2.5769e+00
[rank2]:2025-12-27 00:51:39,268 - Avg. fwd time: 7.8800 / Avg. bwd time: 16.0431 / Avg. batch time: 519.7107 (ms) / GPU bubble ratio: 63.17%
[rank1]:2025-12-27 00:51:39,294 - Avg. fwd time: 9.8342 / Avg. bwd time: 19.8969 / Avg. batch time: 554.0105 (ms) / GPU bubble ratio: 57.07%
[rank0]:2025-12-27 00:51:39,322 - Avg. fwd time: 8.1562 / Avg. bwd time: 21.2249 / Avg. batch time: 588.2776 (ms) / GPU bubble ratio: 60.04%
[rank3]:2025-12-27 00:51:39,244 - Avg. fwd time: 14.0312 / Avg. bwd time: 39.4750 / Avg. batch time: 491.4166 (ms) / GPU bubble ratio: 12.89%
[rank2]:2025-12-27 00:51:39,335 -  step: 450  loss: -8.0000  grad_norm:  0.2314  memory:  6.98GiB(14.69%)  tps: 7,051  tflops: 55.13  mfu: 17.67%
[rank1]:2025-12-27 00:51:39,335 -  step: 450  loss: -8.0000  grad_norm:  0.2314  memory:  9.52GiB(20.03%)  tps: 7,052  tflops: 55.13  mfu: 17.67%
[rank0]:2025-12-27 00:51:39,350 -  step: 450  loss: -8.0000  grad_norm:  0.2314  memory: 13.42GiB(28.26%)  tps: 7,051  tflops: 55.13  mfu: 17.67%
[rank3]:2025-12-27 00:51:39,352 -  step: 450  loss:  0.2382  grad_norm:  0.2314  memory: 16.39GiB(34.50%)  tps: 7,052  tflops: 55.13  mfu: 17.67%
[rank2]:2025-12-27 00:52:22,353 - Freezing Ratio: [Stage2] 0.75, Threshold: 3.3389e-01
[rank1]:2025-12-27 00:52:22,353 - Freezing Ratio: [Stage1] 0.80, Threshold: 5.9125e-01
[rank3]:2025-12-27 00:52:22,368 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.2469e-01
[rank0]:2025-12-27 00:52:22,368 - Freezing Ratio: [Stage0] 0.73, Threshold: 5.2510e-01
[rank2]:2025-12-27 00:53:07,473 - Freezing Ratio: [Stage2] 0.50, Threshold: 6.0532e-01
[rank1]:2025-12-27 00:53:07,472 - Freezing Ratio: [Stage1] 0.60, Threshold: 5.5515e-01
[rank0]:2025-12-27 00:53:07,488 - Freezing Ratio: [Stage0] 0.49, Threshold: 7.2297e-01
[rank3]:2025-12-27 00:53:07,488 - Freezing Ratio: [Stage3] 0.31, Threshold: 1.0659e+00
[rank3]:2025-12-27 00:53:36,184 - Avg. fwd time: 14.0331 / Avg. bwd time: 39.4183 / Avg. batch time: 490.9771 (ms) / GPU bubble ratio: 12.91%
[rank2]:2025-12-27 00:53:36,209 - Avg. fwd time: 7.8986 / Avg. bwd time: 15.8979 / Avg. batch time: 519.1175 (ms) / GPU bubble ratio: 63.33%
[rank1]:2025-12-27 00:53:36,235 - Avg. fwd time: 9.8629 / Avg. bwd time: 19.6551 / Avg. batch time: 553.1732 (ms) / GPU bubble ratio: 57.31%
[rank0]:2025-12-27 00:53:36,264 - Avg. fwd time: 8.1755 / Avg. bwd time: 21.0700 / Avg. batch time: 587.2835 (ms) / GPU bubble ratio: 60.16%
[rank2]:2025-12-27 00:53:55,395 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.3379e-01
[rank1]:2025-12-27 00:53:55,395 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.3582e-01
[rank0]:2025-12-27 00:53:55,410 - Freezing Ratio: [Stage0] 0.73, Threshold: 4.1442e-01
[rank3]:2025-12-27 00:53:55,410 - Freezing Ratio: [Stage3] 0.62, Threshold: 3.0988e-01
[rank1]:2025-12-27 00:54:40,764 - Freezing Ratio: [Stage1] 0.60, Threshold: 1.5924e+00
[rank3]:2025-12-27 00:54:40,780 - Freezing Ratio: [Stage3] 0.31, Threshold: 4.7324e-01
[rank2]:2025-12-27 00:54:40,764 - Freezing Ratio: [Stage2] 0.50, Threshold: 1.2816e+00
[rank0]:2025-12-27 00:54:40,780 - Freezing Ratio: [Stage0] 0.49, Threshold: 2.5151e+00
[rank2]:2025-12-27 00:55:28,572 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.2351e+00
[rank1]:2025-12-27 00:55:28,572 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.2663e+00
[rank0]:2025-12-27 00:55:28,567 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-27 00:55:28,587 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.9390e+00
[rank3]:2025-12-27 00:55:28,587 - Freezing Ratio: [Stage3] 0.62, Threshold: 4.8180e-01
[rank3]:2025-12-27 00:55:33,019 - Avg. fwd time: 14.0346 / Avg. bwd time: 39.3646 / Avg. batch time: 490.5582 (ms) / GPU bubble ratio: 12.92%
[rank2]:2025-12-27 00:55:33,041 - Avg. fwd time: 7.9163 / Avg. bwd time: 15.7616 / Avg. batch time: 518.5556 (ms) / GPU bubble ratio: 63.47%
[rank2]:2025-12-27 00:55:33,100 -  step: 500  loss: -8.0000  grad_norm:  0.2746  memory:  6.98GiB(14.69%)  tps: 7,009  tflops: 54.79  mfu: 17.56%
[rank1]:2025-12-27 00:55:33,064 - Avg. fwd time: 9.8897 / Avg. bwd time: 19.4319 / Avg. batch time: 552.3866 (ms) / GPU bubble ratio: 57.53%
[rank1]:2025-12-27 00:55:33,100 -  step: 500  loss: -8.0000  grad_norm:  0.2746  memory:  9.52GiB(20.03%)  tps: 7,009  tflops: 54.79  mfu: 17.56%
[rank0]:2025-12-27 00:55:33,091 - Avg. fwd time: 8.1939 / Avg. bwd time: 20.9249 / Avg. batch time: 586.3512 (ms) / GPU bubble ratio: 60.27%
[rank0]:2025-12-27 00:55:33,114 -  step: 500  loss: -8.0000  grad_norm:  0.2746  memory: 13.42GiB(28.26%)  tps: 7,009  tflops: 54.79  mfu: 17.56%
[rank3]:2025-12-27 00:55:33,116 -  step: 500  loss:  0.2313  grad_norm:  0.2746  memory: 16.39GiB(34.50%)  tps: 7,009  tflops: 54.79  mfu: 17.56%
[rank2]:2025-12-27 00:55:33,168 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p50_42_dm1/frozen_ratio_history/rank2/251227_0055_stage2_step500.svg
[rank1]:2025-12-27 00:55:33,169 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p50_42_dm1/frozen_ratio_history/rank1/251227_0055_stage1_step500.svg
[rank0]:2025-12-27 00:55:33,168 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p50_42_dm1/frozen_ratio_history/rank0/251227_0055_stage0_step500.svg
[rank3]:2025-12-27 00:55:33,254 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p50_42_dm1/pipeline_schedule/251227_0055_step500_rank3.svg
[rank3]:			> Batch Time: 584.47 ms, GPU Bubble Ratio: 61.79%, 63.33%, 69.10%, 26.57%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-8-18ms       | [S0,MB2,F]  18-8-27ms      | [S0,MB3,F]  27-8-35ms      | [S0,MB0,B]  131-19-150ms   | [S0,MB4,F]  150-8-158ms    | [S0,MB1,B]  188-19-208ms   | [S0,MB5,F]  208-8-216ms    | [S0,MB2,B]  249-19-269ms   | [S0,MB6,F]  269-7-277ms    | [S0,MB3,B]  313-19-333ms   | [S0,MB7,F]  333-8-341ms    | [S0,MB4,B]  376-19-396ms   | [S0,MB5,B]  438-19-457ms   | [S0,MB6,B]  500-19-519ms   | [S0,MB7,B]  565-19-584ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-10-33ms     | [S1,MB2,F]  37-10-47ms     | [S1,MB0,B]  109-16-125ms   | [S1,MB3,F]  129-10-139ms   | [S1,MB1,B]  167-16-183ms   | [S1,MB4,F]  187-10-197ms   | [S1,MB2,B]  228-16-244ms   | [S1,MB5,F]  247-10-258ms   | [S1,MB3,B]  291-16-308ms   | [S1,MB6,F]  311-10-322ms   | [S1,MB4,B]  354-16-371ms   | [S1,MB7,F]  374-10-385ms   | [S1,MB5,B]  418-16-434ms   | [S1,MB6,B]  480-16-496ms   | [S1,MB7,B]  545-16-561ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  33-8-41ms      | [S2,MB0,B]  89-14-104ms    | [S2,MB2,F]  107-8-115ms    | [S2,MB1,B]  147-14-161ms   | [S2,MB3,F]  165-8-173ms    | [S2,MB2,B]  208-14-222ms   | [S2,MB4,F]  226-8-234ms    | [S2,MB3,B]  272-14-286ms   | [S2,MB5,F]  290-8-298ms    | [S2,MB4,B]  335-14-349ms   | [S2,MB6,F]  353-8-361ms    | [S2,MB5,B]  398-14-413ms   | [S2,MB7,F]  416-8-424ms    | [S2,MB6,B]  462-14-477ms   | [S2,MB7,B]  527-14-541ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  48-37-85ms     | [S3,MB1,F]  88-11-99ms     | [S3,MB1,B]  105-38-143ms   | [S3,MB2,F]  146-13-159ms   | [S3,MB2,B]  164-39-204ms   | [S3,MB3,F]  206-14-221ms   | [S3,MB3,B]  226-41-268ms   | [S3,MB4,F]  270-13-284ms   | [S3,MB4,B]  290-41-331ms   | [S3,MB5,F]  333-14-347ms   | [S3,MB5,B]  354-40-394ms   | [S3,MB6,F]  397-15-412ms   | [S3,MB6,B]  418-40-458ms   | [S3,MB7,F]  461-15-476ms   | [S3,MB7,B]  482-40-522ms  
[rank2]:2025-12-27 00:55:33,319 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p50_42_dm1/frozen_params_histogram/251227_0055_rank2_stage2.svg
[rank2]:	> Counts Sum: 711, Total Sum: 1620 (43.89%), Ratio(%) per element: [75.55, 75.55, 75.55, 75.55, 75.55, 75.55, 75.55, 75.55, 75.55, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-12-27 00:55:33,314 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p50_42_dm1/frozen_params_histogram/251227_0055_rank1_stage1.svg
[rank1]:	> Counts Sum: 909, Total Sum: 2025 (44.89%), Ratio(%) per element: [84.44, 84.44, 84.44, 84.44, 84.44, 84.44, 84.44, 84.44, 84.44, 84.44, 84.44, 84.44, 84.44, 84.44, 84.44, 84.44, 84.44, 84.44, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 8.88, 8.88, 8.88, 8.88, 8.88, 8.88, 8.88, 8.88, 8.88, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-12-27 00:55:33,319 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p50_42_dm1/frozen_params_histogram/251227_0055_rank0_stage0.svg
[rank0]:	> Counts Sum: 684, Total Sum: 1665 (41.08%), Ratio(%) per element: [0.0, 75.55, 75.55, 75.55, 75.55, 75.55, 75.55, 75.55, 75.55, 75.55, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-27 00:55:33,298 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p50_42_dm1/frozen_ratio_history/rank3/251227_0055_stage3_step500.svg
[rank3]:2025-12-27 00:55:33,431 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p50_42_dm1/frozen_params_histogram/251227_0055_rank3_stage3.svg
[rank3]:	> Counts Sum: 513, Total Sum: 1305 (39.31%), Ratio(%) per element: [88.88, 88.88, 88.88, 88.88, 88.88, 88.88, 88.88, 88.88, 88.88, 37.77, 37.77, 37.77, 37.77, 37.77, 37.77, 37.77, 37.77, 37.77, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-12-27 00:56:13,954 - Freezing Ratio: [Stage2] 0.50, Threshold: 8.7464e-01
[rank1]:2025-12-27 00:56:13,954 - Freezing Ratio: [Stage1] 0.60, Threshold: 1.7858e+00
[rank0]:2025-12-27 00:56:13,969 - Freezing Ratio: [Stage0] 0.49, Threshold: 1.2365e+00
[rank3]:2025-12-27 00:56:13,970 - Freezing Ratio: [Stage3] 0.31, Threshold: 5.3759e-01
[rank2]:2025-12-27 00:57:01,876 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.1398e+00
[rank1]:2025-12-27 00:57:01,876 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.4674e+00
[rank0]:2025-12-27 00:57:01,892 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.4424e+00
[rank3]:2025-12-27 00:57:01,892 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.1692e+00
[rank3]:2025-12-27 00:57:28,963 - Avg. fwd time: 14.0393 / Avg. bwd time: 39.2911 / Avg. batch time: 490.0068 (ms) / GPU bubble ratio: 12.93%
[rank2]:2025-12-27 00:57:28,986 - Avg. fwd time: 7.9355 / Avg. bwd time: 15.6165 / Avg. batch time: 517.8724 (ms) / GPU bubble ratio: 63.62%
[rank1]:2025-12-27 00:57:29,009 - Avg. fwd time: 9.9168 / Avg. bwd time: 19.2079 / Avg. batch time: 551.4780 (ms) / GPU bubble ratio: 57.75%
[rank0]:2025-12-27 00:57:29,036 - Avg. fwd time: 8.2134 / Avg. bwd time: 20.7719 / Avg. batch time: 585.2871 (ms) / GPU bubble ratio: 60.38%
[rank3]:2025-12-27 00:57:47,237 - Freezing Ratio: [Stage3] 0.31, Threshold: 6.7889e-01
[rank2]:2025-12-27 00:57:47,221 - Freezing Ratio: [Stage2] 0.50, Threshold: 4.9818e-01
[rank1]:2025-12-27 00:57:47,222 - Freezing Ratio: [Stage1] 0.60, Threshold: 5.8102e-01
[rank0]:2025-12-27 00:57:47,237 - Freezing Ratio: [Stage0] 0.49, Threshold: 7.7584e-01
[rank2]:2025-12-27 00:58:34,938 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.0624e+00
[rank1]:2025-12-27 00:58:34,937 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.1305e+00
[rank0]:2025-12-27 00:58:34,953 - Freezing Ratio: [Stage0] 0.73, Threshold: 6.1901e-01
[rank3]:2025-12-27 00:58:34,953 - Freezing Ratio: [Stage3] 0.62, Threshold: 7.2155e-01
[rank2]:2025-12-27 00:59:20,117 - Freezing Ratio: [Stage2] 0.50, Threshold: 1.0260e+00
[rank1]:2025-12-27 00:59:20,118 - Freezing Ratio: [Stage1] 0.60, Threshold: 4.8565e-01
[rank0]:2025-12-27 00:59:20,125 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-27 00:59:20,133 - Freezing Ratio: [Stage0] 0.49, Threshold: 3.7622e-01
[rank3]:2025-12-27 00:59:20,133 - Freezing Ratio: [Stage3] 0.31, Threshold: 1.2963e+00
[rank2]:2025-12-27 00:59:24,912 - Avg. fwd time: 7.9522 / Avg. bwd time: 15.4897 / Avg. batch time: 517.2772 (ms) / GPU bubble ratio: 63.75%
[rank1]:2025-12-27 00:59:24,938 - Avg. fwd time: 9.9407 / Avg. bwd time: 19.0093 / Avg. batch time: 550.6828 (ms) / GPU bubble ratio: 57.94%
[rank3]:2025-12-27 00:59:24,886 - Avg. fwd time: 14.0444 / Avg. bwd time: 39.2283 / Avg. batch time: 489.5448 (ms) / GPU bubble ratio: 12.94%
[rank2]:2025-12-27 00:59:24,982 -  step: 550  loss: -8.0000  grad_norm:  0.1237  memory:  6.98GiB(14.69%)  tps: 7,066  tflops: 55.24  mfu: 17.70%
[rank1]:2025-12-27 00:59:24,982 -  step: 550  loss: -8.0000  grad_norm:  0.1237  memory:  9.52GiB(20.03%)  tps: 7,066  tflops: 55.24  mfu: 17.70%
[rank0]:2025-12-27 00:59:24,969 - Avg. fwd time: 8.2303 / Avg. bwd time: 20.6379 / Avg. batch time: 584.3557 (ms) / GPU bubble ratio: 60.48%
[rank0]:2025-12-27 00:59:24,996 -  step: 550  loss: -8.0000  grad_norm:  0.1237  memory: 13.42GiB(28.26%)  tps: 7,066  tflops: 55.24  mfu: 17.70%
[rank3]:2025-12-27 00:59:24,998 -  step: 550  loss:  0.2384  grad_norm:  0.1237  memory: 16.39GiB(34.50%)  tps: 7,066  tflops: 55.24  mfu: 17.70%
[rank2]:2025-12-27 01:00:07,977 - Freezing Ratio: [Stage2] 0.75, Threshold: 8.0158e-01
[rank1]:2025-12-27 01:00:07,977 - Freezing Ratio: [Stage1] 0.80, Threshold: 7.3905e-01
[rank0]:2025-12-27 01:00:07,993 - Freezing Ratio: [Stage0] 0.73, Threshold: 7.5551e-01
[rank3]:2025-12-27 01:00:07,993 - Freezing Ratio: [Stage3] 0.62, Threshold: 6.8406e-01
[rank1]:2025-12-27 01:00:53,166 - Freezing Ratio: [Stage1] 0.60, Threshold: 2.8543e+00
[rank2]:2025-12-27 01:00:53,165 - Freezing Ratio: [Stage2] 0.50, Threshold: 2.2725e+00
[rank0]:2025-12-27 01:00:53,181 - Freezing Ratio: [Stage0] 0.49, Threshold: 2.1003e+00
[rank3]:2025-12-27 01:00:53,181 - Freezing Ratio: [Stage3] 0.31, Threshold: 1.5608e+00
[rank3]:2025-12-27 01:01:21,471 - Avg. fwd time: 14.0399 / Avg. bwd time: 39.1873 / Avg. batch time: 489.1789 (ms) / GPU bubble ratio: 12.95%
[rank2]:2025-12-27 01:01:21,496 - Avg. fwd time: 7.9644 / Avg. bwd time: 15.3932 / Avg. batch time: 516.8090 (ms) / GPU bubble ratio: 63.84%
[rank1]:2025-12-27 01:01:21,524 - Avg. fwd time: 9.9596 / Avg. bwd time: 18.8474 / Avg. batch time: 550.0515 (ms) / GPU bubble ratio: 58.10%
[rank0]:2025-12-27 01:01:21,554 - Avg. fwd time: 8.2430 / Avg. bwd time: 20.5347 / Avg. batch time: 583.6207 (ms) / GPU bubble ratio: 60.55%
[rank2]:2025-12-27 01:01:40,593 - Freezing Ratio: [Stage2] 0.75, Threshold: 4.9683e-01
[rank1]:2025-12-27 01:01:40,593 - Freezing Ratio: [Stage1] 0.80, Threshold: 3.9362e-01
[rank0]:2025-12-27 01:01:40,608 - Freezing Ratio: [Stage0] 0.73, Threshold: 6.6012e-01
[rank3]:2025-12-27 01:01:40,608 - Freezing Ratio: [Stage3] 0.62, Threshold: 2.4855e-01
[rank2]:2025-12-27 01:02:25,638 - Freezing Ratio: [Stage2] 0.50, Threshold: 5.6013e-01
[rank1]:2025-12-27 01:02:25,638 - Freezing Ratio: [Stage1] 0.60, Threshold: 2.0871e-01
[rank3]:2025-12-27 01:02:25,654 - Freezing Ratio: [Stage3] 0.31, Threshold: 3.9711e-01
[rank0]:2025-12-27 01:02:25,653 - Freezing Ratio: [Stage0] 0.49, Threshold: 6.3609e-01
[rank0]:2025-12-27 01:03:13,151 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-27 01:03:13,157 - Freezing Ratio: [Stage2] 0.75, Threshold: 3.0401e-01
[rank1]:2025-12-27 01:03:13,157 - Freezing Ratio: [Stage1] 0.80, Threshold: 4.3339e-01
[rank3]:2025-12-27 01:03:13,172 - Freezing Ratio: [Stage3] 0.62, Threshold: 2.8100e-01
[rank0]:2025-12-27 01:03:13,172 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.0725e-01
[rank3]:2025-12-27 01:03:17,657 - Avg. fwd time: 14.0375 / Avg. bwd time: 39.1400 / Avg. batch time: 488.7813 (ms) / GPU bubble ratio: 12.96%
[rank2]:2025-12-27 01:03:17,680 - Avg. fwd time: 7.9762 / Avg. bwd time: 15.2997 / Avg. batch time: 516.3132 (ms) / GPU bubble ratio: 63.94%
[rank1]:2025-12-27 01:03:17,704 - Avg. fwd time: 9.9774 / Avg. bwd time: 18.6937 / Avg. batch time: 549.4004 (ms) / GPU bubble ratio: 58.25%
[rank1]:2025-12-27 01:03:17,740 -  step: 600  loss: -8.0000  grad_norm:  0.2915  memory:  9.52GiB(20.03%)  tps: 7,039  tflops: 55.03  mfu: 17.64%
[rank3]:2025-12-27 01:03:17,756 -  step: 600  loss:  0.2347  grad_norm:  0.2915  memory: 16.39GiB(34.50%)  tps: 7,039  tflops: 55.03  mfu: 17.64%
[rank0]:2025-12-27 01:03:17,731 - Avg. fwd time: 8.2552 / Avg. bwd time: 20.4350 / Avg. batch time: 582.8694 (ms) / GPU bubble ratio: 60.62%
[rank0]:2025-12-27 01:03:17,755 -  step: 600  loss: -8.0000  grad_norm:  0.2915  memory: 13.42GiB(28.26%)  tps: 7,039  tflops: 55.03  mfu: 17.64%
[rank2]:2025-12-27 01:03:17,740 -  step: 600  loss: -8.0000  grad_norm:  0.2915  memory:  6.98GiB(14.69%)  tps: 7,039  tflops: 55.03  mfu: 17.64%
[rank2]:2025-12-27 01:03:17,808 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p50_42_dm1/frozen_ratio_history/rank2/251227_0103_stage2_step600.svg
[rank1]:2025-12-27 01:03:17,810 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p50_42_dm1/frozen_ratio_history/rank1/251227_0103_stage1_step600.svg
[rank0]:2025-12-27 01:03:17,809 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p50_42_dm1/frozen_ratio_history/rank0/251227_0103_stage0_step600.svg
[rank3]:2025-12-27 01:03:17,902 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p50_42_dm1/pipeline_schedule/251227_0103_step600_rank3.svg
[rank3]:			> Batch Time: 571.94 ms, GPU Bubble Ratio: 61.10%, 62.74%, 68.55%, 26.35%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-8-18ms       | [S0,MB2,F]  18-8-26ms      | [S0,MB3,F]  26-8-35ms      | [S0,MB0,B]  130-19-149ms   | [S0,MB4,F]  149-7-157ms    | [S0,MB1,B]  187-19-206ms   | [S0,MB5,F]  206-7-214ms    | [S0,MB2,B]  246-19-266ms   | [S0,MB6,F]  266-7-273ms    | [S0,MB3,B]  308-19-327ms   | [S0,MB7,F]  327-7-335ms    | [S0,MB4,B]  370-19-389ms   | [S0,MB5,B]  430-19-449ms   | [S0,MB6,B]  490-19-509ms   | [S0,MB7,B]  552-19-571ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-10-20ms      | [S1,MB1,F]  23-10-33ms     | [S1,MB2,F]  36-10-46ms     | [S1,MB0,B]  108-16-125ms   | [S1,MB3,F]  128-10-138ms   | [S1,MB1,B]  165-16-182ms   | [S1,MB4,F]  185-10-195ms   | [S1,MB2,B]  225-16-241ms   | [S1,MB5,F]  244-10-255ms   | [S1,MB3,B]  286-16-302ms   | [S1,MB6,F]  306-10-316ms   | [S1,MB4,B]  348-16-364ms   | [S1,MB7,F]  368-10-378ms   | [S1,MB5,B]  410-16-426ms   | [S1,MB6,B]  470-16-486ms   | [S1,MB7,B]  532-16-549ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  33-7-41ms      | [S2,MB0,B]  89-14-103ms    | [S2,MB2,F]  107-7-115ms    | [S2,MB1,B]  146-14-160ms   | [S2,MB3,F]  164-7-172ms    | [S2,MB2,B]  205-14-220ms   | [S2,MB4,F]  223-7-231ms    | [S2,MB3,B]  267-14-281ms   | [S2,MB5,F]  284-7-292ms    | [S2,MB4,B]  329-14-343ms   | [S2,MB6,F]  347-7-355ms    | [S2,MB5,B]  391-14-405ms   | [S2,MB7,F]  408-7-416ms    | [S2,MB6,B]  452-14-467ms   | [S2,MB7,B]  515-14-529ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  48-36-85ms     | [S3,MB1,F]  87-11-99ms     | [S3,MB1,B]  105-37-142ms   | [S3,MB2,F]  144-13-158ms   | [S3,MB2,B]  163-38-202ms   | [S3,MB3,F]  204-14-218ms   | [S3,MB3,B]  223-39-263ms   | [S3,MB4,F]  265-13-279ms   | [S3,MB4,B]  285-40-325ms   | [S3,MB5,F]  327-13-341ms   | [S3,MB5,B]  347-40-387ms   | [S3,MB6,F]  390-13-403ms   | [S3,MB6,B]  409-40-449ms   | [S3,MB7,F]  451-13-465ms   | [S3,MB7,B]  473-39-512ms  
[rank3]:2025-12-27 01:03:17,950 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p50_42_dm1/frozen_ratio_history/rank3/251227_0103_stage3_step600.svg
[rank0]:2025-12-27 01:03:17,960 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p50_42_dm1/frozen_params_histogram/251227_0103_rank0_stage0.svg
[rank0]:	> Counts Sum: 909, Total Sum: 2035 (44.67%), Ratio(%) per element: [0.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 72.72, 72.72, 72.72, 72.72, 72.72, 72.72, 72.72, 72.72, 72.72, 30.9, 30.9, 30.9, 30.9, 30.9, 30.9, 30.9, 30.9, 30.9, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-12-27 01:03:17,955 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p50_42_dm1/frozen_params_histogram/251227_0103_rank2_stage2.svg
[rank2]:	> Counts Sum: 936, Total Sum: 1980 (47.27%), Ratio(%) per element: [80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 78.18, 78.18, 78.18, 78.18, 78.18, 78.18, 78.18, 78.18, 78.18, 30.9, 30.9, 30.9, 30.9, 30.9, 30.9, 30.9, 30.9, 30.9, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-12-27 01:03:17,955 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p50_42_dm1/frozen_params_histogram/251227_0103_rank1_stage1.svg
[rank1]:	> Counts Sum: 1224, Total Sum: 2475 (49.45%), Ratio(%) per element: [87.27, 87.27, 87.27, 87.27, 87.27, 87.27, 87.27, 87.27, 87.27, 87.27, 87.27, 87.27, 87.27, 87.27, 87.27, 87.27, 87.27, 87.27, 56.36, 56.36, 56.36, 56.36, 56.36, 56.36, 56.36, 56.36, 56.36, 16.36, 16.36, 16.36, 16.36, 16.36, 16.36, 16.36, 16.36, 16.36, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-27 01:03:18,092 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p50_42_dm1/frozen_params_histogram/251227_0103_rank3_stage3.svg
[rank3]:	> Counts Sum: 648, Total Sum: 1595 (40.63%), Ratio(%) per element: [90.9, 90.9, 90.9, 90.9, 90.9, 90.9, 90.9, 90.9, 90.9, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-12-27 01:03:58,627 - Freezing Ratio: [Stage0] 0.49, Threshold: 1.2886e+00
[rank2]:2025-12-27 01:03:58,611 - Freezing Ratio: [Stage2] 0.50, Threshold: 8.9274e-01
[rank1]:2025-12-27 01:03:58,611 - Freezing Ratio: [Stage1] 0.60, Threshold: 9.7979e-01
[rank3]:2025-12-27 01:03:58,627 - Freezing Ratio: [Stage3] 0.31, Threshold: 4.8556e-01
[rank0]:2025-12-27 01:04:46,093 - Freezing Ratio: [Stage0] 0.73, Threshold: 8.8352e-01
[rank2]:2025-12-27 01:04:46,077 - Freezing Ratio: [Stage2] 0.75, Threshold: 4.4309e-01
[rank1]:2025-12-27 01:04:46,077 - Freezing Ratio: [Stage1] 0.80, Threshold: 5.5741e-01
[rank3]:2025-12-27 01:04:46,093 - Freezing Ratio: [Stage3] 0.62, Threshold: 2.2969e-01
[rank3]:2025-12-27 01:05:13,099 - Avg. fwd time: 14.0376 / Avg. bwd time: 39.0785 / Avg. batch time: 488.2903 (ms) / GPU bubble ratio: 12.98%
[rank2]:2025-12-27 01:05:13,123 - Avg. fwd time: 7.9896 / Avg. bwd time: 15.1957 / Avg. batch time: 515.7340 (ms) / GPU bubble ratio: 64.04%
[rank1]:2025-12-27 01:05:13,147 - Avg. fwd time: 9.9961 / Avg. bwd time: 18.5342 / Avg. batch time: 548.6611 (ms) / GPU bubble ratio: 58.40%
[rank0]:2025-12-27 01:05:13,175 - Avg. fwd time: 8.2686 / Avg. bwd time: 20.3254 / Avg. batch time: 582.0178 (ms) / GPU bubble ratio: 60.70%
[rank2]:2025-12-27 01:05:31,161 - Freezing Ratio: [Stage2] 0.50, Threshold: 1.5363e+00
[rank1]:2025-12-27 01:05:31,161 - Freezing Ratio: [Stage1] 0.60, Threshold: 1.4091e+00
[rank3]:2025-12-27 01:05:31,177 - Freezing Ratio: [Stage3] 0.31, Threshold: 1.1846e+00
[rank0]:2025-12-27 01:05:31,176 - Freezing Ratio: [Stage0] 0.49, Threshold: 7.0378e-01
[rank2]:2025-12-27 01:06:18,925 - Freezing Ratio: [Stage2] 0.75, Threshold: 6.4577e-01
[rank1]:2025-12-27 01:06:18,925 - Freezing Ratio: [Stage1] 0.80, Threshold: 5.1824e-01
[rank3]:2025-12-27 01:06:18,940 - Freezing Ratio: [Stage3] 0.62, Threshold: 4.8529e-01
[rank0]:2025-12-27 01:06:18,941 - Freezing Ratio: [Stage0] 0.73, Threshold: 5.1647e-01
[rank2]:2025-12-27 01:07:04,231 - Freezing Ratio: [Stage2] 0.50, Threshold: 1.8409e+00
[rank1]:2025-12-27 01:07:04,231 - Freezing Ratio: [Stage1] 0.60, Threshold: 7.5170e-01
[rank3]:2025-12-27 01:07:04,247 - Freezing Ratio: [Stage3] 0.31, Threshold: 1.5264e+00
[rank0]:2025-12-27 01:07:04,240 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-27 01:07:04,247 - Freezing Ratio: [Stage0] 0.49, Threshold: 1.7512e+00
[rank3]:2025-12-27 01:07:08,914 - Avg. fwd time: 14.0406 / Avg. bwd time: 39.0312 / Avg. batch time: 487.9361 (ms) / GPU bubble ratio: 12.99%
[rank1]:2025-12-27 01:07:08,968 - Avg. fwd time: 10.0131 / Avg. bwd time: 18.3917 / Avg. batch time: 548.0669 (ms) / GPU bubble ratio: 58.54%
[rank2]:2025-12-27 01:07:08,940 - Avg. fwd time: 8.0014 / Avg. bwd time: 15.1043 / Avg. batch time: 515.2829 (ms) / GPU bubble ratio: 64.13%
[rank2]:2025-12-27 01:07:09,013 -  step: 650  loss: -8.0000  grad_norm:  0.0915  memory:  6.98GiB(14.69%)  tps: 7,084  tflops: 55.38  mfu: 17.75%
[rank3]:2025-12-27 01:07:09,029 -  step: 650  loss:  0.2427  grad_norm:  0.0915  memory: 16.39GiB(34.50%)  tps: 7,084  tflops: 55.38  mfu: 17.75%
[rank1]:2025-12-27 01:07:09,013 -  step: 650  loss: -8.0000  grad_norm:  0.0915  memory:  9.52GiB(20.03%)  tps: 7,084  tflops: 55.38  mfu: 17.75%
[rank0]:2025-12-27 01:07:09,000 - Avg. fwd time: 8.2806 / Avg. bwd time: 20.2288 / Avg. batch time: 581.3261 (ms) / GPU bubble ratio: 60.77%
[rank0]:2025-12-27 01:07:09,027 -  step: 650  loss: -8.0000  grad_norm:  0.0915  memory: 13.42GiB(28.26%)  tps: 7,084  tflops: 55.38  mfu: 17.75%
[rank2]:2025-12-27 01:07:51,979 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.1333e+00
[rank3]:2025-12-27 01:07:51,995 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.3232e+00
[rank1]:2025-12-27 01:07:51,979 - Freezing Ratio: [Stage1] 0.80, Threshold: 6.0795e-01
[rank0]:2025-12-27 01:07:51,995 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.0341e+00
[rank2]:2025-12-27 01:08:37,124 - Freezing Ratio: [Stage2] 0.50, Threshold: 2.1505e+00
[rank3]:2025-12-27 01:08:37,139 - Freezing Ratio: [Stage3] 0.31, Threshold: 1.8444e+00
[rank1]:2025-12-27 01:08:37,124 - Freezing Ratio: [Stage1] 0.60, Threshold: 1.8629e+00
[rank0]:2025-12-27 01:08:37,139 - Freezing Ratio: [Stage0] 0.49, Threshold: 2.1977e+00
[rank2]:2025-12-27 01:09:05,861 - Avg. fwd time: 8.0101 / Avg. bwd time: 15.0366 / Avg. batch time: 515.0250 (ms) / GPU bubble ratio: 64.20%
[rank3]:2025-12-27 01:09:05,834 - Avg. fwd time: 14.0418 / Avg. bwd time: 39.0069 / Avg. batch time: 487.7510 (ms) / GPU bubble ratio: 12.99%
[rank1]:2025-12-27 01:09:05,889 - Avg. fwd time: 10.0267 / Avg. bwd time: 18.2771 / Avg. batch time: 547.6939 (ms) / GPU bubble ratio: 58.66%
[rank0]:2025-12-27 01:09:05,920 - Avg. fwd time: 8.2896 / Avg. bwd time: 20.1564 / Avg. batch time: 580.8805 (ms) / GPU bubble ratio: 60.82%
[rank3]:2025-12-27 01:09:25,037 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.1101e+00
[rank0]:2025-12-27 01:09:25,037 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.2396e+00
[rank1]:2025-12-27 01:09:25,021 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.3701e+00
[rank2]:2025-12-27 01:09:25,021 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.1965e+00
[rank1]:2025-12-27 01:10:10,408 - Freezing Ratio: [Stage1] 0.60, Threshold: 4.1825e-01
[rank2]:2025-12-27 01:10:10,408 - Freezing Ratio: [Stage2] 0.50, Threshold: 3.0895e-01
[rank3]:2025-12-27 01:10:10,423 - Freezing Ratio: [Stage3] 0.31, Threshold: 3.3748e-01
[rank0]:2025-12-27 01:10:10,423 - Freezing Ratio: [Stage0] 0.49, Threshold: 6.4799e-01
[rank0]:2025-12-27 01:10:58,140 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-12-27 01:10:58,160 - Freezing Ratio: [Stage0] 0.73, Threshold: 1.8738e+00
[rank1]:2025-12-27 01:10:58,145 - Freezing Ratio: [Stage1] 0.80, Threshold: 2.1335e+00
[rank2]:2025-12-27 01:10:58,145 - Freezing Ratio: [Stage2] 0.75, Threshold: 2.2619e+00
[rank3]:2025-12-27 01:10:58,161 - Freezing Ratio: [Stage3] 0.62, Threshold: 2.1728e+00
[rank2]:2025-12-27 01:11:02,614 - Avg. fwd time: 8.0186 / Avg. bwd time: 14.9697 / Avg. batch time: 514.7672 (ms) / GPU bubble ratio: 64.27%
[rank3]:2025-12-27 01:11:02,590 - Avg. fwd time: 14.0442 / Avg. bwd time: 38.9812 / Avg. batch time: 487.5647 (ms) / GPU bubble ratio: 13.00%
[rank0]:2025-12-27 01:11:02,668 - Avg. fwd time: 8.2983 / Avg. bwd time: 20.0852 / Avg. batch time: 580.4398 (ms) / GPU bubble ratio: 60.88%
[rank1]:2025-12-27 01:11:02,639 - Avg. fwd time: 10.0399 / Avg. bwd time: 18.1666 / Avg. batch time: 547.3251 (ms) / GPU bubble ratio: 58.77%
[rank1]:2025-12-27 01:11:02,677 -  step: 700  loss: -8.0000  grad_norm:  0.1094  memory:  9.52GiB(20.03%)  tps: 7,012  tflops: 54.81  mfu: 17.57%
[rank2]:2025-12-27 01:11:02,677 -  step: 700  loss: -8.0000  grad_norm:  0.1094  memory:  6.98GiB(14.69%)  tps: 7,012  tflops: 54.81  mfu: 17.57%
[rank3]:2025-12-27 01:11:02,692 -  step: 700  loss:  0.2036  grad_norm:  0.1094  memory: 16.39GiB(34.50%)  tps: 7,012  tflops: 54.82  mfu: 17.57%
[rank0]:2025-12-27 01:11:02,691 -  step: 700  loss: -8.0000  grad_norm:  0.1094  memory: 13.42GiB(28.26%)  tps: 7,012  tflops: 54.81  mfu: 17.57%
[rank0]:2025-12-27 01:11:02,747 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p50_42_dm1/frozen_ratio_history/rank0/251227_0111_stage0_step700.svg
[rank1]:2025-12-27 01:11:02,748 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p50_42_dm1/frozen_ratio_history/rank1/251227_0111_stage1_step700.svg
[rank2]:2025-12-27 01:11:02,747 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p50_42_dm1/frozen_ratio_history/rank2/251227_0111_stage2_step700.svg
[rank3]:2025-12-27 01:11:02,840 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p50_42_dm1/pipeline_schedule/251227_0111_step700_rank3.svg
[rank3]:			> Batch Time: 581.97 ms, GPU Bubble Ratio: 61.59%, 63.19%, 68.98%, 26.52%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-8-18ms       | [S0,MB2,F]  18-8-27ms      | [S0,MB3,F]  27-8-35ms      | [S0,MB0,B]  130-19-150ms   | [S0,MB4,F]  150-8-158ms    | [S0,MB1,B]  188-19-207ms   | [S0,MB5,F]  207-8-215ms    | [S0,MB2,B]  249-19-268ms   | [S0,MB6,F]  268-8-276ms    | [S0,MB3,B]  312-19-331ms   | [S0,MB7,F]  331-8-339ms    | [S0,MB4,B]  375-19-395ms   | [S0,MB5,B]  436-19-455ms   | [S0,MB6,B]  498-19-517ms   | [S0,MB7,B]  562-19-581ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-10-33ms     | [S1,MB2,F]  37-10-47ms     | [S1,MB0,B]  109-16-125ms   | [S1,MB3,F]  129-10-139ms   | [S1,MB1,B]  166-16-183ms   | [S1,MB4,F]  186-10-196ms   | [S1,MB2,B]  227-16-243ms   | [S1,MB5,F]  247-10-257ms   | [S1,MB3,B]  290-16-307ms   | [S1,MB6,F]  310-10-321ms   | [S1,MB4,B]  354-16-370ms   | [S1,MB7,F]  374-10-384ms   | [S1,MB5,B]  416-16-433ms   | [S1,MB6,B]  478-16-494ms   | [S1,MB7,B]  542-16-559ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  33-8-41ms      | [S2,MB0,B]  89-14-104ms    | [S2,MB2,F]  107-8-115ms    | [S2,MB1,B]  147-14-161ms   | [S2,MB3,F]  165-7-173ms    | [S2,MB2,B]  207-14-222ms   | [S2,MB4,F]  225-8-233ms    | [S2,MB3,B]  271-14-285ms   | [S2,MB5,F]  289-8-297ms    | [S2,MB4,B]  334-14-349ms   | [S2,MB6,F]  352-8-360ms    | [S2,MB5,B]  397-14-411ms   | [S2,MB7,F]  415-8-423ms    | [S2,MB6,B]  460-14-475ms   | [S2,MB7,B]  524-14-539ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  48-36-85ms     | [S3,MB1,F]  88-11-99ms     | [S3,MB1,B]  105-38-143ms   | [S3,MB2,F]  145-13-158ms   | [S3,MB2,B]  164-39-203ms   | [S3,MB3,F]  206-14-220ms   | [S3,MB3,B]  225-40-266ms   | [S3,MB4,F]  269-13-283ms   | [S3,MB4,B]  289-41-330ms   | [S3,MB5,F]  333-14-347ms   | [S3,MB5,B]  352-40-393ms   | [S3,MB6,F]  395-15-410ms   | [S3,MB6,B]  416-40-456ms   | [S3,MB7,F]  458-15-474ms   | [S3,MB7,B]  480-40-521ms  
[rank2]:2025-12-27 01:11:02,897 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p50_42_dm1/frozen_params_histogram/251227_0111_rank2_stage2.svg
[rank2]:	> Counts Sum: 1161, Total Sum: 2340 (49.62%), Ratio(%) per element: [83.07, 83.07, 83.07, 83.07, 83.07, 83.07, 83.07, 83.07, 83.07, 81.53, 81.53, 81.53, 81.53, 81.53, 81.53, 81.53, 81.53, 81.53, 33.84, 33.84, 33.84, 33.84, 33.84, 33.84, 33.84, 33.84, 33.84, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-27 01:11:02,890 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p50_42_dm1/frozen_ratio_history/rank3/251227_0111_stage3_step700.svg
[rank0]:2025-12-27 01:11:02,898 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p50_42_dm1/frozen_params_histogram/251227_0111_rank0_stage0.svg
[rank0]:	> Counts Sum: 1134, Total Sum: 2405 (47.15%), Ratio(%) per element: [0.0, 83.07, 83.07, 83.07, 83.07, 83.07, 83.07, 83.07, 83.07, 83.07, 76.92, 76.92, 76.92, 76.92, 76.92, 76.92, 76.92, 76.92, 76.92, 33.84, 33.84, 33.84, 33.84, 33.84, 33.84, 33.84, 33.84, 33.84, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-12-27 01:11:02,892 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p50_42_dm1/frozen_params_histogram/251227_0111_rank1_stage1.svg
[rank1]:	> Counts Sum: 1539, Total Sum: 2925 (52.62%), Ratio(%) per element: [89.23, 89.23, 89.23, 89.23, 89.23, 89.23, 89.23, 89.23, 89.23, 89.23, 89.23, 89.23, 89.23, 89.23, 89.23, 89.23, 89.23, 89.23, 63.07, 63.07, 63.07, 63.07, 63.07, 63.07, 63.07, 63.07, 63.07, 21.53, 21.53, 21.53, 21.53, 21.53, 21.53, 21.53, 21.53, 21.53, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-27 01:11:03,030 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p50_42_dm1/frozen_params_histogram/251227_0111_rank3_stage3.svg
[rank3]:	> Counts Sum: 783, Total Sum: 1885 (41.54%), Ratio(%) per element: [92.3, 92.3, 92.3, 92.3, 92.3, 92.3, 92.3, 92.3, 92.3, 41.53, 41.53, 41.53, 41.53, 41.53, 41.53, 41.53, 41.53, 41.53, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-27 01:11:43,618 - Freezing Ratio: [Stage3] 0.31, Threshold: 6.0045e-01
[rank0]:2025-12-27 01:11:43,618 - Freezing Ratio: [Stage0] 0.49, Threshold: 1.0594e+00
[rank1]:2025-12-27 01:11:43,603 - Freezing Ratio: [Stage1] 0.60, Threshold: 8.8402e-01
[rank2]:2025-12-27 01:11:43,603 - Freezing Ratio: [Stage2] 0.50, Threshold: 3.4493e-01
[rank3]:2025-12-27 01:12:31,476 - Freezing Ratio: [Stage3] 0.62, Threshold: 4.6122e-01
[rank0]:2025-12-27 01:12:31,476 - Freezing Ratio: [Stage0] 0.73, Threshold: 2.1285e-01
[rank1]:2025-12-27 01:12:31,461 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.7571e-01
[rank2]:2025-12-27 01:12:31,461 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.7755e-01
[rank2]:2025-12-27 01:12:58,556 - Avg. fwd time: 8.0289 / Avg. bwd time: 14.8918 / Avg. batch time: 514.4034 (ms) / GPU bubble ratio: 64.35%
[rank3]:2025-12-27 01:12:58,532 - Avg. fwd time: 14.0480 / Avg. bwd time: 38.9401 / Avg. batch time: 487.2654 (ms) / GPU bubble ratio: 13.00%
[rank0]:2025-12-27 01:12:58,611 - Avg. fwd time: 8.3085 / Avg. bwd time: 20.0033 / Avg. batch time: 579.8735 (ms) / GPU bubble ratio: 60.94%
[rank1]:2025-12-27 01:12:58,582 - Avg. fwd time: 10.0542 / Avg. bwd time: 18.0478 / Avg. batch time: 546.8418 (ms) / GPU bubble ratio: 58.89%
[rank2]:2025-12-27 01:13:16,811 - Freezing Ratio: [Stage2] 0.50, Threshold: 5.2920e-01
[rank3]:2025-12-27 01:13:16,826 - Freezing Ratio: [Stage3] 0.31, Threshold: 1.0136e+00
[rank0]:2025-12-27 01:13:16,826 - Freezing Ratio: [Stage0] 0.49, Threshold: 1.3290e+00
[rank1]:2025-12-27 01:13:16,811 - Freezing Ratio: [Stage1] 0.60, Threshold: 2.0044e+00
[rank2]:2025-12-27 01:14:04,641 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.1014e+00
[rank3]:2025-12-27 01:14:04,657 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.1799e+00
[rank0]:2025-12-27 01:14:04,656 - Freezing Ratio: [Stage0] 0.73, Threshold: 6.7724e-01
[rank1]:2025-12-27 01:14:04,641 - Freezing Ratio: [Stage1] 0.80, Threshold: 5.6524e-01
[rank3]:2025-12-27 01:14:49,878 - Freezing Ratio: [Stage3] 0.31, Threshold: 1.8645e+00
[rank0]:2025-12-27 01:14:49,869 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-12-27 01:14:49,877 - Freezing Ratio: [Stage0] 0.49, Threshold: 5.1587e-01
[rank1]:2025-12-27 01:14:49,861 - Freezing Ratio: [Stage1] 0.60, Threshold: 1.5353e+00
[rank2]:2025-12-27 01:14:49,861 - Freezing Ratio: [Stage2] 0.50, Threshold: 1.5268e+00
[rank2]:2025-12-27 01:14:54,644 - Avg. fwd time: 8.0381 / Avg. bwd time: 14.8229 / Avg. batch time: 514.0975 (ms) / GPU bubble ratio: 64.43%
[rank3]:2025-12-27 01:14:54,617 - Avg. fwd time: 14.0510 / Avg. bwd time: 38.9080 / Avg. batch time: 487.0324 (ms) / GPU bubble ratio: 13.01%
[rank1]:2025-12-27 01:14:54,673 - Avg. fwd time: 10.0672 / Avg. bwd time: 17.9408 / Avg. batch time: 546.4290 (ms) / GPU bubble ratio: 58.99%
[rank2]:2025-12-27 01:14:54,718 -  step: 750  loss: -8.0000  grad_norm:  0.1713  memory:  6.98GiB(14.69%)  tps: 7,061  tflops: 55.20  mfu: 17.69%
[rank3]:2025-12-27 01:14:54,734 -  step: 750  loss:  0.2505  grad_norm:  0.1713  memory: 16.39GiB(34.50%)  tps: 7,061  tflops: 55.20  mfu: 17.69%
[rank0]:2025-12-27 01:14:54,705 - Avg. fwd time: 8.3178 / Avg. bwd time: 19.9307 / Avg. batch time: 579.3886 (ms) / GPU bubble ratio: 61.00%
[rank0]:2025-12-27 01:14:54,732 -  step: 750  loss: -8.0000  grad_norm:  0.1713  memory: 13.42GiB(28.26%)  tps: 7,061  tflops: 55.20  mfu: 17.69%
[rank1]:2025-12-27 01:14:54,718 -  step: 750  loss: -8.0000  grad_norm:  0.1713  memory:  9.52GiB(20.03%)  tps: 7,061  tflops: 55.20  mfu: 17.69%
[rank1]:2025-12-27 01:15:37,722 - Freezing Ratio: [Stage1] 0.80, Threshold: 6.7683e-01
[rank3]:2025-12-27 01:15:37,738 - Freezing Ratio: [Stage3] 0.62, Threshold: 8.1873e-01
[rank0]:2025-12-27 01:15:37,738 - Freezing Ratio: [Stage0] 0.73, Threshold: 2.6711e-01
[rank2]:2025-12-27 01:15:37,722 - Freezing Ratio: [Stage2] 0.75, Threshold: 6.3871e-01
[rank2]:2025-12-27 01:16:23,049 - Freezing Ratio: [Stage2] 0.50, Threshold: 1.8870e+00
[rank3]:2025-12-27 01:16:23,065 - Freezing Ratio: [Stage3] 0.31, Threshold: 1.5479e+00
[rank1]:2025-12-27 01:16:23,049 - Freezing Ratio: [Stage1] 0.60, Threshold: 2.0655e+00
[rank0]:2025-12-27 01:16:23,065 - Freezing Ratio: [Stage0] 0.49, Threshold: 1.2765e+00
[rank3]:2025-12-27 01:16:51,699 - Avg. fwd time: 14.0519 / Avg. bwd time: 38.8927 / Avg. batch time: 486.9182 (ms) / GPU bubble ratio: 13.01%
[rank2]:2025-12-27 01:16:51,728 - Avg. fwd time: 8.0446 / Avg. bwd time: 14.7731 / Avg. batch time: 513.9297 (ms) / GPU bubble ratio: 64.48%
[rank1]:2025-12-27 01:16:51,757 - Avg. fwd time: 10.0773 / Avg. bwd time: 17.8554 / Avg. batch time: 546.1760 (ms) / GPU bubble ratio: 59.09%
[rank0]:2025-12-27 01:16:51,790 - Avg. fwd time: 8.3245 / Avg. bwd time: 19.8774 / Avg. batch time: 579.0837 (ms) / GPU bubble ratio: 61.04%
[rank1]:2025-12-27 01:17:10,963 - Freezing Ratio: [Stage1] 0.80, Threshold: 1.9778e+00
[rank2]:2025-12-27 01:17:10,963 - Freezing Ratio: [Stage2] 0.75, Threshold: 1.6562e+00
[rank3]:2025-12-27 01:17:10,980 - Freezing Ratio: [Stage3] 0.62, Threshold: 1.3790e+00
[rank0]:2025-12-27 01:17:10,979 - Freezing Ratio: [Stage0] 0.73, Threshold: 2.4829e+00
[rank2]:2025-12-27 01:17:56,239 - Freezing Ratio: [Stage2] 0.50, Threshold: 9.1387e-01
[rank0]:2025-12-27 01:17:56,254 - Freezing Ratio: [Stage0] 0.49, Threshold: 3.5023e-01
[rank3]:2025-12-27 01:17:56,255 - Freezing Ratio: [Stage3] 0.31, Threshold: 5.4008e-01
[rank1]:2025-12-27 01:17:56,239 - Freezing Ratio: [Stage1] 0.60, Threshold: 1.1339e+00
[rank0]:2025-12-27 01:18:44,158 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-12-27 01:18:44,164 - Freezing Ratio: [Stage2] 0.75, Threshold: 7.8020e-01
[rank3]:2025-12-27 01:18:44,179 - Freezing Ratio: [Stage3] 0.62, Threshold: 7.0567e-01
[rank1]:2025-12-27 01:18:44,164 - Freezing Ratio: [Stage1] 0.80, Threshold: 7.8532e-01
[rank0]:2025-12-27 01:18:44,179 - Freezing Ratio: [Stage0] 0.73, Threshold: 5.0316e-01
[rank2]:2025-12-27 01:18:48,769 - Avg. fwd time: 8.0512 / Avg. bwd time: 14.7228 / Avg. batch time: 513.7715 (ms) / GPU bubble ratio: 64.54%
[rank3]:2025-12-27 01:18:48,743 - Avg. fwd time: 14.0561 / Avg. bwd time: 38.8755 / Avg. batch time: 486.8137 (ms) / GPU bubble ratio: 13.02%
[rank0]:2025-12-27 01:18:48,825 - Avg. fwd time: 8.3315 / Avg. bwd time: 19.8240 / Avg. batch time: 578.7899 (ms) / GPU bubble ratio: 61.08%
[rank0]:2025-12-27 01:18:48,848 -  step: 800  loss: -8.0000  grad_norm:  0.3339  memory: 13.42GiB(28.26%)  tps: 6,998  tflops: 54.71  mfu: 17.53%
[rank0]:2025-12-27 01:18:48,849 - â„¹ï¸ final step: 800  loss: -8.0000  grad_norm:  0.3339  tps: 7,307  tflops: 57.13  mfu: 16.70%
[rank0]:2025-12-27 01:18:48,849 - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-12-27 01:18:48,849 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank2]:2025-12-27 01:18:48,834 -  step: 800  loss: -8.0000  grad_norm:  0.3339  memory:  6.98GiB(14.69%)  tps: 6,998  tflops: 54.71  mfu: 17.53%
[rank2]:2025-12-27 01:18:48,835 - â„¹ï¸ final step: 800  loss: -8.0000  grad_norm:  0.3339  tps: 7,307  tflops: 57.13  mfu: 16.71%
[rank2]:2025-12-27 01:18:48,835 - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-12-27 01:18:48,835 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank3]:2025-12-27 01:18:48,851 -  step: 800  loss:  0.2535  grad_norm:  0.3339  memory: 16.39GiB(34.50%)  tps: 6,998  tflops: 54.71  mfu: 17.54%
[rank3]:2025-12-27 01:18:48,851 - â„¹ï¸ final step: 800  loss:  0.2535  grad_norm:  0.3339  tps: 7,312  tflops: 57.16  mfu: 16.83%
[rank3]:2025-12-27 01:18:48,852 - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-12-27 01:18:48,853 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank1]:2025-12-27 01:18:48,796 - Avg. fwd time: 10.0875 / Avg. bwd time: 17.7718 / Avg. batch time: 545.9344 (ms) / GPU bubble ratio: 59.18%
[rank1]:2025-12-27 01:18:48,834 -  step: 800  loss: -8.0000  grad_norm:  0.3339  memory:  9.52GiB(20.03%)  tps: 6,998  tflops: 54.71  mfu: 17.53%
[rank1]:2025-12-27 01:18:48,834 - â„¹ï¸ final step: 800  loss: -8.0000  grad_norm:  0.3339  tps: 7,307  tflops: 57.13  mfu: 16.71%
[rank1]:2025-12-27 01:18:48,835 - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-12-27 01:18:48,835 - Saving a model only checkpoint in torch.float16 at last step, step 800.
[rank0]:2025-12-27 01:18:50,832 - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-12-27 01:18:50,907 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p50_42_dm1/frozen_ratio_history/rank0/251227_0118_stage0_final800.svg
[rank2]:2025-12-27 01:18:50,908 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p50_42_dm1/frozen_ratio_history/rank2/251227_0118_stage2_final800.svg
[rank3]:2025-12-27 01:18:50,990 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p50_42_dm1/pipeline_schedule/251227_0118_final800_rank3.svg
[rank3]:			> Batch Time: 577.47 ms, GPU Bubble Ratio: 61.38%, 63.02%, 68.77%, 26.31%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-8-18ms       | [S0,MB2,F]  18-8-26ms      | [S0,MB3,F]  26-8-35ms      | [S0,MB0,B]  130-19-150ms   | [S0,MB4,F]  150-7-158ms    | [S0,MB1,B]  188-19-207ms   | [S0,MB5,F]  207-7-215ms    | [S0,MB2,B]  248-19-267ms   | [S0,MB6,F]  268-7-275ms    | [S0,MB3,B]  311-19-330ms   | [S0,MB7,F]  330-7-338ms    | [S0,MB4,B]  374-19-393ms   | [S0,MB5,B]  434-19-454ms   | [S0,MB6,B]  495-19-515ms   | [S0,MB7,B]  558-19-577ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  23-10-33ms     | [S1,MB2,F]  36-10-46ms     | [S1,MB0,B]  108-16-125ms   | [S1,MB3,F]  129-10-139ms   | [S1,MB1,B]  166-16-182ms   | [S1,MB4,F]  186-10-196ms   | [S1,MB2,B]  226-16-243ms   | [S1,MB5,F]  246-10-256ms   | [S1,MB3,B]  289-16-305ms   | [S1,MB6,F]  309-10-319ms   | [S1,MB4,B]  351-16-368ms   | [S1,MB7,F]  372-10-382ms   | [S1,MB5,B]  414-16-430ms   | [S1,MB6,B]  475-16-491ms   | [S1,MB7,B]  537-16-553ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  33-7-41ms      | [S2,MB0,B]  88-14-103ms    | [S2,MB2,F]  107-8-115ms    | [S2,MB1,B]  146-14-160ms   | [S2,MB3,F]  164-7-172ms    | [S2,MB2,B]  206-14-220ms   | [S2,MB4,F]  225-7-233ms    | [S2,MB3,B]  268-14-282ms   | [S2,MB5,F]  287-7-295ms    | [S2,MB4,B]  331-14-345ms   | [S2,MB6,F]  350-8-358ms    | [S2,MB5,B]  393-14-407ms   | [S2,MB7,F]  412-7-420ms    | [S2,MB6,B]  455-14-470ms   | [S2,MB7,B]  517-14-531ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-13-42ms     | [S3,MB0,B]  48-36-85ms     | [S3,MB1,F]  87-11-99ms     | [S3,MB1,B]  104-37-142ms   | [S3,MB2,F]  144-13-158ms   | [S3,MB2,B]  163-38-202ms   | [S3,MB3,F]  204-14-219ms   | [S3,MB3,B]  224-39-264ms   | [S3,MB4,F]  266-14-280ms   | [S3,MB4,B]  287-40-327ms   | [S3,MB5,F]  329-14-343ms   | [S3,MB5,B]  349-40-390ms   | [S3,MB6,F]  391-14-406ms   | [S3,MB6,B]  412-39-452ms   | [S3,MB7,F]  454-14-468ms   | [S3,MB7,B]  474-39-514ms  
[rank1]:2025-12-27 01:18:50,909 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p50_42_dm1/frozen_ratio_history/rank1/251227_0118_stage1_final800.svg
[rank0]:2025-12-27 01:18:51,058 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p50_42_dm1/frozen_params_histogram/251227_0118_rank0_stage0.svg
[rank0]:	> Counts Sum: 1359, Total Sum: 2775 (48.97%), Ratio(%) per element: [0.0, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 36.0, 36.0, 36.0, 36.0, 36.0, 36.0, 36.0, 36.0, 36.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-12-27 01:18:51,059 - Sleeping 2 seconds for other ranks to complete
[rank2]:2025-12-27 01:18:51,060 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p50_42_dm1/frozen_params_histogram/251227_0118_rank2_stage2.svg
[rank2]:	> Counts Sum: 1386, Total Sum: 2700 (51.33%), Ratio(%) per element: [85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 36.0, 36.0, 36.0, 36.0, 36.0, 36.0, 36.0, 36.0, 36.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-12-27 01:18:51,061 - Destroying the purge thread.
[rank1]:2025-12-27 01:18:51,052 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p50_42_dm1/frozen_params_histogram/251227_0118_rank1_stage1.svg
[rank1]:	> Counts Sum: 1854, Total Sum: 3375 (54.93%), Ratio(%) per element: [90.66, 90.66, 90.66, 90.66, 90.66, 90.66, 90.66, 90.66, 90.66, 90.66, 90.66, 90.66, 90.66, 90.66, 90.66, 90.66, 90.66, 90.66, 68.0, 68.0, 68.0, 68.0, 68.0, 68.0, 68.0, 68.0, 68.0, 25.33, 25.33, 25.33, 25.33, 25.33, 25.33, 25.33, 25.33, 25.33, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-12-27 01:18:51,052 - Destroying the purge thread.
[rank3]:2025-12-27 01:18:51,125 - âœ… Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p50_42_dm1/pipeline_schedule/251227_0118_thry_final800_rank3.svg
[rank3]:			> Batch Time: 335.26 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-10-10ms      | [S0,MB1,F]  10-10-20ms     | [S0,MB2,F]  20-10-30ms     | [S0,MB3,F]  30-10-40ms     | [S0,MB0,B]  101-20-121ms   | [S0,MB4,F]  121-10-132ms   | [S0,MB1,B]  132-20-152ms   | [S0,MB5,F]  152-10-162ms   | [S0,MB2,B]  162-20-182ms   | [S0,MB6,F]  182-10-193ms   | [S0,MB3,B]  193-20-213ms   | [S0,MB7,F]  213-10-223ms   | [S0,MB4,B]  223-20-243ms   | [S0,MB5,B]  253-20-274ms   | [S0,MB6,B]  284-20-304ms   | [S0,MB7,B]  314-20-335ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  10-10-20ms     | [S1,MB1,F]  20-10-30ms     | [S1,MB2,F]  30-10-40ms     | [S1,MB0,B]  81-20-101ms    | [S1,MB3,F]  101-10-111ms   | [S1,MB1,B]  111-20-132ms   | [S1,MB4,F]  132-10-142ms   | [S1,MB2,B]  142-20-162ms   | [S1,MB5,F]  162-10-172ms   | [S1,MB3,B]  172-20-193ms   | [S1,MB6,F]  193-10-203ms   | [S1,MB4,B]  203-20-223ms   | [S1,MB7,F]  223-10-233ms   | [S1,MB5,B]  233-20-253ms   | [S1,MB6,B]  264-20-284ms   | [S1,MB7,B]  294-20-314ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-10-30ms     | [S2,MB1,F]  30-10-40ms     | [S2,MB0,B]  60-20-81ms     | [S2,MB2,F]  81-10-91ms     | [S2,MB1,B]  91-20-111ms    | [S2,MB3,F]  111-10-121ms   | [S2,MB2,B]  121-20-142ms   | [S2,MB4,F]  142-10-152ms   | [S2,MB3,B]  152-20-172ms   | [S2,MB5,F]  172-10-182ms   | [S2,MB4,B]  182-20-203ms   | [S2,MB6,F]  203-10-213ms   | [S2,MB5,B]  213-20-233ms   | [S2,MB7,F]  233-10-243ms   | [S2,MB6,B]  243-20-264ms   | [S2,MB7,B]  274-20-294ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  30-10-40ms     | [S3,MB0,B]  40-20-60ms     | [S3,MB1,F]  60-10-71ms     | [S3,MB1,B]  71-20-91ms     | [S3,MB2,F]  91-10-101ms    | [S3,MB2,B]  101-20-121ms   | [S3,MB3,F]  121-10-132ms   | [S3,MB3,B]  132-20-152ms   | [S3,MB4,F]  152-10-162ms   | [S3,MB4,B]  162-20-182ms   | [S3,MB5,F]  182-10-193ms   | [S3,MB5,B]  193-20-213ms   | [S3,MB6,F]  213-10-223ms   | [S3,MB6,B]  223-20-243ms   | [S3,MB7,F]  243-10-253ms   | [S3,MB7,B]  253-20-274ms  
[rank3]:2025-12-27 01:18:51,177 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p50_42_dm1/frozen_ratio_history/rank3/251227_0118_stage3_final800.svg
[rank2]:2025-12-27 01:18:51,339 - Process group destroyed
[rank3]:2025-12-27 01:18:51,307 - âœ… Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1226_1F1B_auto_p50_42_dm1/frozen_params_histogram/251227_0118_rank3_stage3.svg
[rank3]:	> Counts Sum: 918, Total Sum: 2175 (42.21%), Ratio(%) per element: [93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 42.66, 42.66, 42.66, 42.66, 42.66, 42.66, 42.66, 42.66, 42.66, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-12-27 01:18:51,308 - Destroying the purge thread.
[rank1]:2025-12-27 01:18:51,351 - Process group destroyed
[rank3]:wandb: updating run metadata
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–ˆâ–†â–ƒâ–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–ˆâ–†â–ƒâ–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 4.48136
[rank3]:wandb:               final/avg_loss 0.2535
[rank3]:wandb:             final/avg_mfu(%) 16.83034
[rank3]:wandb:             final/avg_tflops 57.16232
[rank3]:wandb:    final/avg_throughput(tps) 7312.06027
[rank3]:wandb:              final/grad_norm 0.33392
[rank3]:wandb:               final/max_loss 0.2535
[rank3]:wandb:                    grad_norm 0.33392
[rank3]:wandb: loss_metrics/global_avg_loss 0.2535
[rank3]:wandb: loss_metrics/global_max_loss 0.2535
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1226_1F1B_auto_p50_42_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/3wb2crjg
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1226_1F1B_auto_p50_42_dm1/20251227-0015/wandb/run-20251227_001518-3wb2crjg/logs
[rank3]:2025-12-27 01:18:52,800 - Process group destroyed
[rank0]:2025-12-27 01:18:53,059 - Training completed
[rank0]:2025-12-27 01:18:53,059 - Destroying the purge thread.
[rank0]:2025-12-27 01:18:53,307 - Process group destroyed
[rank1]:Stage 1: Modules to keep: {'layers.5', 'layers.4', 'layers.8', 'layers.6', 'layers.7'}
[rank2]:Stage 2: Modules to keep: {'layers.12', 'layers.10', 'layers.9', 'layers.11'}
[rank0]:Stage 0: Modules to keep: {'layers.0', 'tok_embeddings', 'layers.3', 'layers.1', 'layers.2'}
[rank3]:Stage 3: Modules to keep: {'norm', 'layers.13', 'layers.14', 'output', 'layers.15'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1116_autofreeze/config_1226.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "AutoFreeze configuration experiment on different PERCENTILE values."
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1226_1F1B_auto_p50_42_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1226_1F1B_auto_p50_42_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1226_1F1B_auto_p50_42_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1226_1F1B_auto_p50_42_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1226_1F1B_auto_p50_42_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1226_1F1B_auto_p50_42_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.01
[rank3]:	- training:
[rank3]:		- dataset: alpaca_gpt4
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 800
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 42
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: 1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1226_1F1B_auto_p50_42_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1226_1F1B_auto_p50_42_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: auto
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.05
[rank3]:		- percentile: 50
[rank3]:
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
