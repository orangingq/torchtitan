
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 10. 30. (ëª©) 04:49:58 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 3,4,5,6
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1029_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1029_llama1b/1029_Interleaved1F1B_nofreeze.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
âœ”ï¸Running with nofreeze x Interleaved1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1029_llama1b/config.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast" --parallelism.pipeline_parallel_degree=4  --freezing.no-freeze
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank0]:2025-10-30 04:50:04,542 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank1]:2025-10-30 04:50:04,456 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank3]:2025-10-30 04:50:04,455 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank2]:2025-10-30 04:50:04,655 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank0]:2025-10-30 04:50:05,117 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-10-30 04:50:05,120 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-30 04:50:05,124 - INFO - [GC] Initial GC collection 0.00 seconds
[rank1]:2025-10-30 04:50:05,128 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-10-30 04:50:05,133 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-10-30 04:50:05,130 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-10-30 04:50:05,133 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-10-30 04:50:05,145 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-10-30 04:50:05,147 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-30 04:50:05,536 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-10-30 04:50:05,939 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank2]:2025-10-30 04:50:08,866 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-10-30 04:50:08,907 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-10-30 04:50:08,934 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.5', 'layers.6']
[rank2]:2025-10-30 04:50:08,946 - INFO - PP rank 2 is building stage_idx 6 with modules ['layers.13', 'layers.14']
[rank2]:2025-10-30 04:50:08,947 - INFO - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank0]:2025-10-30 04:50:09,073 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=512, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank2]:2025-10-30 04:50:09,117 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-10-30 04:50:09,117 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-10-30 04:50:09,117 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank0]:2025-10-30 04:50:09,220 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-10-30 04:50:09,206 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-10-30 04:50:09,247 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-10-30 04:50:09,260 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-10-30 04:50:09,261 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-10-30 04:50:09,287 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1']
[rank0]:2025-10-30 04:50:09,299 - INFO - PP rank 0 is building stage_idx 4 with modules ['layers.9', 'layers.10']
[rank1]:2025-10-30 04:50:09,275 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.2', 'layers.3', 'layers.4']
[rank1]:2025-10-30 04:50:09,288 - INFO - PP rank 1 is building stage_idx 5 with modules ['layers.11', 'layers.12']
[rank1]:2025-10-30 04:50:09,290 - INFO - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank0]:2025-10-30 04:50:09,301 - INFO - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank1]:2025-10-30 04:50:09,480 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-10-30 04:50:09,480 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-10-30 04:50:09,480 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank0]:2025-10-30 04:50:09,484 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-10-30 04:50:09,484 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-10-30 04:50:09,485 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run vyzk2nyy
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1029_Interleaved1F1B_nofreeze_dm1/20251030-0450/wandb/run-20251030_045009-vyzk2nyy
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1029_Interleaved1F1B_nofreeze_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/vyzk2nyy
[rank3]:2025-10-30 04:50:10,974 - INFO - WandB logging enabled
[rank3]:2025-10-30 04:50:10,975 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-10-30 04:50:11,013 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-10-30 04:50:11,041 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.7', 'layers.8']
[rank3]:2025-10-30 04:50:11,054 - INFO - PP rank 3 is building stage_idx 7 with modules ['layers.15', 'norm', 'output']
[rank3]:2025-10-30 04:50:11,056 - INFO - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank0]:2025-10-30 04:50:11,255 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1029_Interleaved1F1B_nofreeze_dm1
[rank0]:2025-10-30 04:50:11,255 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank2]:2025-10-30 04:50:11,255 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-10-30 04:50:11,239 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-10-30 04:50:11,239 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-10-30 04:50:11,240 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2025-10-30 04:50:11,255 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-10-30 04:50:11,256 - INFO - Preparing c4_validation dataset from allenai/c4
[rank1]:2025-10-30 04:50:11,262 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-10-30 04:50:17,263 - INFO - Trainer is initialized with local batch size 32, global batch size 64, gradient accumulation steps 2, sequence length 512, total steps 2400 (warmup 100)
[rank0]:2025-10-30 04:50:17,263 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B-Instruct/original_dcp.
[rank0]:2025-10-30 04:50:19,604 - INFO - [GC] GC collection for checkpoint loading. 0.01 seconds
[rank0]:2025-10-30 04:50:19,605 - INFO - Finished loading the checkpoint in 2.34 seconds.
[rank0]:2025-10-30 04:50:19,605 - INFO - Training starts at step 1
[rank0]:2025-10-30 04:50:22,311 - INFO -  step:  1  loss: -2.0000  grad_norm: 85.2017  memory: 10.87GiB(22.87%)  tps: 628  tflops: 4.78  mfu: 1.53%
[rank0]:2025-10-30 04:50:22,312 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-30 04:50:22,286 - INFO -  step:  1  loss:  9.0164  grad_norm: 85.2017  memory: 14.83GiB(31.21%)  tps: 727  tflops: 5.54  mfu: 1.77%
[rank3]:2025-10-30 04:50:22,286 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-10-30 04:50:22,286 - INFO -  step:  1  loss: -2.0000  grad_norm: 85.2017  memory:  9.21GiB(19.38%)  tps: 628  tflops: 4.79  mfu: 1.53%
[rank1]:2025-10-30 04:50:22,287 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-10-30 04:50:22,275 - INFO -  step:  1  loss: -2.0000  grad_norm: 85.2017  memory:  6.24GiB(13.13%)  tps: 613  tflops: 4.67  mfu: 1.50%
[rank2]:2025-10-30 04:50:22,275 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-10-30 04:50:41,779 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 04:50:41,779 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 04:50:41,779 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 04:50:41,779 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 04:50:41,779 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 04:50:41,779 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 04:50:41,779 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 04:50:41,780 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 04:50:41,780 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 04:50:41,780 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 04:50:41,780 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 04:50:41,780 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 04:50:41,780 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 04:50:41,780 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 04:50:41,780 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 04:50:41,780 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 04:50:41,780 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 04:50:41,780 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 04:50:41,780 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 04:50:41,780 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 04:50:41,781 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 04:50:41,781 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 04:50:41,781 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 04:50:41,781 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 04:50:41,781 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 04:50:41,781 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 04:50:41,781 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 04:50:41,781 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 04:50:41,781 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 04:50:41,781 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 04:50:41,781 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 04:50:41,781 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 04:50:41,750 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 04:50:41,751 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 04:50:41,751 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 04:50:41,752 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 04:50:41,752 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 04:50:41,752 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 04:50:41,752 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 04:50:41,753 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 04:50:41,753 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 04:50:41,753 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 04:50:41,753 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 04:50:41,754 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 04:50:41,754 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 04:50:41,754 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 04:50:41,754 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 04:50:41,755 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 04:50:41,755 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 04:50:41,755 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 04:50:41,755 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 04:50:41,755 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 04:50:41,756 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 04:50:41,756 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 04:50:41,756 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 04:50:41,756 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 04:50:41,757 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 04:50:41,757 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 04:50:41,757 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 04:50:41,757 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 04:50:41,757 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 04:50:41,758 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 04:50:41,758 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 04:50:41,758 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 04:50:41,822 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 04:50:41,822 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 04:50:41,822 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 04:50:41,822 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 04:50:41,822 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 04:50:41,822 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 04:50:41,822 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 04:50:41,822 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 04:50:41,822 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 04:50:41,823 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 04:50:41,823 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 04:50:41,823 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 04:50:41,823 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 04:50:41,823 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 04:50:41,823 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 04:50:41,823 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 04:50:41,823 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 04:50:41,823 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 04:50:41,823 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 04:50:41,823 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 04:50:41,823 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 04:50:41,824 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 04:50:41,824 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 04:50:41,824 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 04:50:41,824 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 04:50:41,824 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 04:50:41,824 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 04:50:41,824 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 04:50:41,824 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 04:50:41,824 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 04:50:41,824 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 04:50:41,824 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 04:50:41,800 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 04:50:41,800 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 04:50:41,800 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 04:50:41,800 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 04:50:41,800 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 04:50:41,801 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 04:50:41,801 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 04:50:41,801 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 04:50:41,801 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 04:50:41,801 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 04:50:41,801 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 04:50:41,801 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 04:50:41,801 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 04:50:41,801 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 04:50:41,801 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 04:50:41,801 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 04:50:41,802 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 04:50:41,802 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 04:50:41,802 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 04:50:41,802 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 04:50:41,802 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 04:50:41,802 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 04:50:41,802 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 04:50:41,802 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 04:50:41,802 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 04:50:41,802 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 04:50:41,802 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 04:50:41,803 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 04:50:41,803 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 04:50:41,803 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 04:50:41,803 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 04:50:41,803 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 04:51:25,895 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-30 04:51:27,225 - INFO -  step: 50  loss: -2.0000  grad_norm: 35.5229  memory: 11.85GiB(24.93%)  tps: 6,181  tflops: 47.08  mfu: 15.09%
[rank0]:2025-10-30 04:51:27,236 - INFO -  step: 50  loss: -2.0000  grad_norm: 35.5229  memory: 14.71GiB(30.97%)  tps: 6,183  tflops: 47.09  mfu: 15.09%
[rank3]:2025-10-30 04:51:27,233 - INFO -  step: 50  loss:  8.4844  grad_norm: 35.5229  memory: 18.19GiB(38.28%)  tps: 6,181  tflops: 47.07  mfu: 15.09%
[rank2]:2025-10-30 04:51:27,221 - INFO -  step: 50  loss: -2.0000  grad_norm: 35.5229  memory:  8.13GiB(17.12%)  tps: 6,181  tflops: 47.07  mfu: 15.09%
[rank0]:2025-10-30 04:52:31,752 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-30 04:52:33,080 - INFO -  step: 100  loss:  5.6441  grad_norm: 61.5045  memory: 18.19GiB(38.28%)  tps: 6,221  tflops: 47.38  mfu: 15.19%
[rank2]:2025-10-30 04:52:33,068 - INFO -  step: 100  loss: -2.0000  grad_norm: 61.5045  memory:  8.13GiB(17.12%)  tps: 6,221  tflops: 47.38  mfu: 15.19%
[rank1]:2025-10-30 04:52:33,071 - INFO -  step: 100  loss: -2.0000  grad_norm: 61.5045  memory: 11.85GiB(24.93%)  tps: 6,221  tflops: 47.38  mfu: 15.19%
[rank0]:2025-10-30 04:52:33,082 - INFO -  step: 100  loss: -2.0000  grad_norm: 61.5045  memory: 14.71GiB(30.97%)  tps: 6,221  tflops: 47.38  mfu: 15.19%
[rank3]:2025-10-30 04:52:33,406 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_nofreeze_dm1/pipeline_schedule/251030_0452_real_step100_rank3.svg
[rank3]:> Batch Time: 500.39 ms, GPU Bubble Ratio: 49.20%, 46.37%, 56.76%, 13.04%
[rank3]:2025-10-30 04:52:33,730 - INFO - Avg. fwd time: 6.3261 / Avg. bwd time: 20.9562 / Avg. batch time: 549.6069 (ms) / GPU bubble ratio: 20.58%
[rank2]:2025-10-30 04:52:33,785 - INFO - Avg. fwd time: 3.8232 / Avg. bwd time: 9.6876 / Avg. batch time: 582.2797 (ms) / GPU bubble ratio: 62.87%
[rank0]:2025-10-30 04:52:33,805 - INFO - Avg. fwd time: 4.0775 / Avg. bwd time: 11.9007 / Avg. batch time: 634.1020 (ms) / GPU bubble ratio: 59.68%
[rank1]:2025-10-30 04:52:33,877 - INFO - Avg. fwd time: 4.7961 / Avg. bwd time: 12.2001 / Avg. batch time: 611.2859 (ms) / GPU bubble ratio: 55.51%
[rank0]:2025-10-30 04:53:38,008 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-30 04:53:39,348 - INFO -  step: 150  loss: -2.0000  grad_norm: 24.4772  memory:  8.13GiB(17.12%)  tps: 6,180  tflops: 47.07  mfu: 15.09%
[rank3]:2025-10-30 04:53:39,360 - INFO -  step: 150  loss:  0.9934  grad_norm: 24.4772  memory: 18.19GiB(38.28%)  tps: 6,180  tflops: 47.07  mfu: 15.09%
[rank1]:2025-10-30 04:53:39,351 - INFO -  step: 150  loss: -2.0000  grad_norm: 24.4772  memory: 11.85GiB(24.93%)  tps: 6,180  tflops: 47.07  mfu: 15.09%
[rank0]:2025-10-30 04:53:39,362 - INFO -  step: 150  loss: -2.0000  grad_norm: 24.4772  memory: 14.71GiB(30.97%)  tps: 6,180  tflops: 47.07  mfu: 15.09%
[rank0]:2025-10-30 04:54:43,661 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-30 04:54:44,995 - INFO -  step: 200  loss: -2.0000  grad_norm:  1.2899  memory: 11.85GiB(24.93%)  tps: 6,240  tflops: 47.52  mfu: 15.23%
[rank1]:2025-10-30 04:54:44,995 - INFO - ðŸ”Ž  Running validation at step 200
[rank2]:2025-10-30 04:54:44,991 - INFO -  step: 200  loss: -2.0000  grad_norm:  1.2899  memory:  8.13GiB(17.12%)  tps: 6,240  tflops: 47.52  mfu: 15.23%
[rank3]:2025-10-30 04:54:45,003 - INFO -  step: 200  loss:  0.2871  grad_norm:  1.2899  memory: 18.19GiB(38.28%)  tps: 6,240  tflops: 47.52  mfu: 15.23%
[rank2]:2025-10-30 04:54:44,991 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-10-30 04:54:45,006 - INFO -  step: 200  loss: -2.0000  grad_norm:  1.2899  memory: 14.71GiB(30.97%)  tps: 6,240  tflops: 47.52  mfu: 15.23%
[rank0]:2025-10-30 04:54:45,006 - INFO - ðŸ”Ž  Running validation at step 200
[rank3]:2025-10-30 04:54:45,004 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-10-30 04:55:12,548 - INFO - validate step: 200  loss: -1.0000  memory: 14.71GiB(30.97%)  tps: 14,872
[rank3]:2025-10-30 04:55:12,569 - INFO - validate step: 200  loss:  0.9441  memory: 18.19GiB(38.28%)  tps: 14,860
[rank1]:2025-10-30 04:55:12,559 - INFO - validate step: 200  loss: -1.0000  memory: 11.85GiB(24.93%)  tps: 14,860
[rank2]:2025-10-30 04:55:12,571 - INFO - validate step: 200  loss: -1.0000  memory:  8.13GiB(17.12%)  tps: 14,852
[rank3]:2025-10-30 04:55:12,878 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_nofreeze_dm1/pipeline_schedule/251030_0455_real_step200_rank3.svg
[rank3]:> Batch Time: 501.18 ms, GPU Bubble Ratio: 49.20%, 46.34%, 56.79%, 12.96%
[rank3]:2025-10-30 04:55:13,207 - INFO - Avg. fwd time: 6.3492 / Avg. bwd time: 21.0666 / Avg. batch time: 548.4633 (ms) / GPU bubble ratio: 20.02%
[rank2]:2025-10-30 04:55:13,264 - INFO - Avg. fwd time: 3.8307 / Avg. bwd time: 9.7270 / Avg. batch time: 581.5419 (ms) / GPU bubble ratio: 62.70%
[rank0]:2025-10-30 04:55:13,284 - INFO - Avg. fwd time: 4.0906 / Avg. bwd time: 11.9527 / Avg. batch time: 633.4305 (ms) / GPU bubble ratio: 59.48%
[rank1]:2025-10-30 04:55:13,360 - INFO - Avg. fwd time: 4.7909 / Avg. bwd time: 12.1480 / Avg. batch time: 610.5842 (ms) / GPU bubble ratio: 55.61%
[rank0]:2025-10-30 04:56:17,152 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-30 04:56:18,456 - INFO -  step: 250  loss: -2.0000  grad_norm:  1.6042  memory:  8.13GiB(17.12%)  tps: 6,217  tflops: 47.35  mfu: 15.18%
[rank3]:2025-10-30 04:56:18,468 - INFO -  step: 250  loss:  0.2617  grad_norm:  1.6042  memory: 18.19GiB(38.28%)  tps: 6,216  tflops: 47.34  mfu: 15.17%
[rank1]:2025-10-30 04:56:18,460 - INFO -  step: 250  loss: -2.0000  grad_norm:  1.6042  memory: 11.85GiB(24.93%)  tps: 6,215  tflops: 47.34  mfu: 15.17%
[rank0]:2025-10-30 04:56:18,471 - INFO -  step: 250  loss: -2.0000  grad_norm:  1.6042  memory: 14.71GiB(30.97%)  tps: 6,213  tflops: 47.32  mfu: 15.17%
[rank0]:2025-10-30 04:57:22,622 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-30 04:57:23,936 - INFO -  step: 300  loss: -2.0000  grad_norm:  1.1301  memory:  8.13GiB(17.12%)  tps: 6,255  tflops: 47.64  mfu: 15.27%
[rank3]:2025-10-30 04:57:23,948 - INFO -  step: 300  loss:  0.2272  grad_norm:  1.1301  memory: 18.19GiB(38.28%)  tps: 6,256  tflops: 47.64  mfu: 15.27%
[rank1]:2025-10-30 04:57:23,940 - INFO -  step: 300  loss: -2.0000  grad_norm:  1.1301  memory: 11.85GiB(24.93%)  tps: 6,256  tflops: 47.65  mfu: 15.27%
[rank0]:2025-10-30 04:57:23,950 - INFO -  step: 300  loss: -2.0000  grad_norm:  1.1301  memory: 14.71GiB(30.97%)  tps: 6,255  tflops: 47.64  mfu: 15.27%
[rank3]:2025-10-30 04:57:24,261 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_nofreeze_dm1/pipeline_schedule/251030_0457_real_step300_rank3.svg
[rank3]:> Batch Time: 500.47 ms, GPU Bubble Ratio: 49.13%, 46.24%, 56.71%, 13.00%
[rank3]:2025-10-30 04:57:24,817 - INFO - Avg. fwd time: 6.3378 / Avg. bwd time: 21.0438 / Avg. batch time: 546.9014 (ms) / GPU bubble ratio: 19.89%
[rank2]:2025-10-30 04:57:24,846 - INFO - Avg. fwd time: 3.8300 / Avg. bwd time: 9.7393 / Avg. batch time: 580.8075 (ms) / GPU bubble ratio: 62.62%
[rank1]:2025-10-30 04:57:24,872 - INFO - Avg. fwd time: 4.7877 / Avg. bwd time: 12.1341 / Avg. batch time: 609.8574 (ms) / GPU bubble ratio: 55.60%
[rank0]:2025-10-30 04:57:24,895 - INFO - Avg. fwd time: 4.0928 / Avg. bwd time: 11.9673 / Avg. batch time: 632.7279 (ms) / GPU bubble ratio: 59.39%
[rank0]:2025-10-30 04:58:28,505 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-30 04:58:29,818 - INFO -  step: 350  loss: -2.0000  grad_norm:  0.4100  memory:  8.13GiB(17.12%)  tps: 6,217  tflops: 47.35  mfu: 15.18%
[rank1]:2025-10-30 04:58:29,822 - INFO -  step: 350  loss: -2.0000  grad_norm:  0.4100  memory: 11.85GiB(24.93%)  tps: 6,217  tflops: 47.35  mfu: 15.18%
[rank3]:2025-10-30 04:58:29,831 - INFO -  step: 350  loss:  0.1814  grad_norm:  0.4100  memory: 18.19GiB(38.28%)  tps: 6,217  tflops: 47.35  mfu: 15.18%
[rank0]:2025-10-30 04:58:29,833 - INFO -  step: 350  loss: -2.0000  grad_norm:  0.4100  memory: 14.71GiB(30.97%)  tps: 6,217  tflops: 47.35  mfu: 15.18%
[rank0]:2025-10-30 04:59:34,126 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-30 04:59:35,461 - INFO -  step: 400  loss: -2.0000  grad_norm:  0.7819  memory: 11.85GiB(24.93%)  tps: 6,240  tflops: 47.53  mfu: 15.23%
[rank1]:2025-10-30 04:59:35,465 - INFO - ðŸ”Ž  Running validation at step 400
[rank2]:2025-10-30 04:59:35,457 - INFO -  step: 400  loss: -2.0000  grad_norm:  0.7819  memory:  8.13GiB(17.12%)  tps: 6,240  tflops: 47.53  mfu: 15.23%
[rank2]:2025-10-30 04:59:35,457 - INFO - ðŸ”Ž  Running validation at step 400
[rank3]:2025-10-30 04:59:35,469 - INFO -  step: 400  loss:  0.2202  grad_norm:  0.7819  memory: 18.19GiB(38.28%)  tps: 6,240  tflops: 47.53  mfu: 15.23%
[rank3]:2025-10-30 04:59:35,469 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-10-30 04:59:35,471 - INFO -  step: 400  loss: -2.0000  grad_norm:  0.7819  memory: 14.71GiB(30.97%)  tps: 6,240  tflops: 47.53  mfu: 15.23%
[rank0]:2025-10-30 04:59:35,471 - INFO - ðŸ”Ž  Running validation at step 400
[rank1]:2025-10-30 05:00:00,500 - INFO - validate step: 400  loss: -1.0000  memory: 11.85GiB(24.93%)  tps: 16,361
[rank3]:2025-10-30 05:00:00,510 - INFO - validate step: 400  loss:  0.9318  memory: 18.19GiB(38.28%)  tps: 16,358
[rank2]:2025-10-30 05:00:00,512 - INFO - validate step: 400  loss: -1.0000  memory:  8.13GiB(17.12%)  tps: 16,349
[rank0]:2025-10-30 05:00:00,492 - INFO - validate step: 400  loss: -1.0000  memory: 14.71GiB(30.97%)  tps: 16,371
[rank3]:2025-10-30 05:00:00,821 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_nofreeze_dm1/pipeline_schedule/251030_0500_real_step400_rank3.svg
[rank3]:> Batch Time: 500.06 ms, GPU Bubble Ratio: 49.08%, 46.15%, 56.68%, 13.02%
[rank3]:2025-10-30 05:00:01,151 - INFO - Avg. fwd time: 6.3349 / Avg. bwd time: 21.0360 / Avg. batch time: 546.3094 (ms) / GPU bubble ratio: 19.84%
[rank2]:2025-10-30 05:00:01,206 - INFO - Avg. fwd time: 3.8300 / Avg. bwd time: 9.7447 / Avg. batch time: 579.9486 (ms) / GPU bubble ratio: 62.55%
[rank0]:2025-10-30 05:00:01,227 - INFO - Avg. fwd time: 4.0937 / Avg. bwd time: 11.9753 / Avg. batch time: 631.8675 (ms) / GPU bubble ratio: 59.31%
[rank1]:2025-10-30 05:00:01,303 - INFO - Avg. fwd time: 4.7860 / Avg. bwd time: 12.1293 / Avg. batch time: 608.9985 (ms) / GPU bubble ratio: 55.56%
[rank0]:2025-10-30 05:01:05,185 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-30 05:01:06,495 - INFO -  step: 450  loss: -2.0000  grad_norm:  1.3021  memory: 11.85GiB(24.93%)  tps: 6,207  tflops: 47.27  mfu: 15.15%
[rank2]:2025-10-30 05:01:06,491 - INFO -  step: 450  loss: -2.0000  grad_norm:  1.3021  memory:  8.13GiB(17.12%)  tps: 6,208  tflops: 47.28  mfu: 15.15%
[rank3]:2025-10-30 05:01:06,503 - INFO -  step: 450  loss:  0.2257  grad_norm:  1.3021  memory: 18.19GiB(38.28%)  tps: 6,207  tflops: 47.27  mfu: 15.15%
[rank0]:2025-10-30 05:01:06,505 - INFO -  step: 450  loss: -2.0000  grad_norm:  1.3021  memory: 14.71GiB(30.97%)  tps: 6,205  tflops: 47.26  mfu: 15.15%
[rank0]:2025-10-30 05:02:10,850 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-30 05:02:12,192 - INFO -  step: 500  loss:  0.2547  grad_norm:  0.4730  memory: 18.19GiB(38.28%)  tps: 6,236  tflops: 47.49  mfu: 15.22%
[rank2]:2025-10-30 05:02:12,180 - INFO -  step: 500  loss: -2.0000  grad_norm:  0.4730  memory:  8.13GiB(17.12%)  tps: 6,236  tflops: 47.49  mfu: 15.22%
[rank0]:2025-10-30 05:02:12,194 - INFO -  step: 500  loss: -2.0000  grad_norm:  0.4730  memory: 14.71GiB(30.97%)  tps: 6,236  tflops: 47.49  mfu: 15.22%
[rank1]:2025-10-30 05:02:12,183 - INFO -  step: 500  loss: -2.0000  grad_norm:  0.4730  memory: 11.85GiB(24.93%)  tps: 6,236  tflops: 47.49  mfu: 15.22%
[rank3]:2025-10-30 05:02:12,501 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_nofreeze_dm1/pipeline_schedule/251030_0502_real_step500_rank3.svg
[rank3]:> Batch Time: 500.05 ms, GPU Bubble Ratio: 49.05%, 46.13%, 56.65%, 13.02%
[rank3]:2025-10-30 05:02:12,834 - INFO - Avg. fwd time: 6.3342 / Avg. bwd time: 21.0415 / Avg. batch time: 546.0998 (ms) / GPU bubble ratio: 19.79%
[rank2]:2025-10-30 05:02:12,889 - INFO - Avg. fwd time: 3.8303 / Avg. bwd time: 9.7494 / Avg. batch time: 579.8259 (ms) / GPU bubble ratio: 62.53%
[rank0]:2025-10-30 05:02:12,910 - INFO - Avg. fwd time: 4.0950 / Avg. bwd time: 11.9819 / Avg. batch time: 631.7683 (ms) / GPU bubble ratio: 59.28%
[rank1]:2025-10-30 05:02:12,990 - INFO - Avg. fwd time: 4.7857 / Avg. bwd time: 12.1271 / Avg. batch time: 608.8828 (ms) / GPU bubble ratio: 55.56%
[rank0]:2025-10-30 05:03:17,045 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-30 05:03:18,388 - INFO -  step: 550  loss: -2.0000  grad_norm:  0.5542  memory:  8.13GiB(17.12%)  tps: 6,187  tflops: 47.12  mfu: 15.10%
[rank0]:2025-10-30 05:03:18,403 - INFO -  step: 550  loss: -2.0000  grad_norm:  0.5542  memory: 14.71GiB(30.97%)  tps: 6,187  tflops: 47.12  mfu: 15.10%
[rank1]:2025-10-30 05:03:18,392 - INFO -  step: 550  loss: -2.0000  grad_norm:  0.5542  memory: 11.85GiB(24.93%)  tps: 6,187  tflops: 47.12  mfu: 15.10%
[rank3]:2025-10-30 05:03:18,401 - INFO -  step: 550  loss:  0.2529  grad_norm:  0.5542  memory: 18.19GiB(38.28%)  tps: 6,187  tflops: 47.12  mfu: 15.10%
[rank0]:2025-10-30 05:04:22,952 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-30 05:04:24,288 - INFO -  step: 600  loss: -2.0000  grad_norm:  0.7482  memory: 11.85GiB(24.93%)  tps: 6,216  tflops: 47.34  mfu: 15.17%
[rank1]:2025-10-30 05:04:24,288 - INFO - ðŸ”Ž  Running validation at step 600
[rank2]:2025-10-30 05:04:24,284 - INFO -  step: 600  loss: -2.0000  grad_norm:  0.7482  memory:  8.13GiB(17.12%)  tps: 6,216  tflops: 47.34  mfu: 15.17%
[rank2]:2025-10-30 05:04:24,284 - INFO - ðŸ”Ž  Running validation at step 600
[rank3]:2025-10-30 05:04:24,296 - INFO -  step: 600  loss:  0.2167  grad_norm:  0.7482  memory: 18.19GiB(38.28%)  tps: 6,216  tflops: 47.34  mfu: 15.17%
[rank3]:2025-10-30 05:04:24,297 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-10-30 05:04:24,298 - INFO -  step: 600  loss: -2.0000  grad_norm:  0.7482  memory: 14.71GiB(30.97%)  tps: 6,216  tflops: 47.34  mfu: 15.17%
[rank0]:2025-10-30 05:04:24,298 - INFO - ðŸ”Ž  Running validation at step 600
[rank1]:2025-10-30 05:04:49,458 - INFO - validate step: 600  loss: -1.0000  memory: 11.85GiB(24.93%)  tps: 16,273
[rank2]:2025-10-30 05:04:49,469 - INFO - validate step: 600  loss: -1.0000  memory:  8.13GiB(17.12%)  tps: 16,264
[rank3]:2025-10-30 05:04:49,469 - INFO - validate step: 600  loss:  0.9306  memory: 18.19GiB(38.28%)  tps: 16,273
[rank0]:2025-10-30 05:04:49,449 - INFO - validate step: 600  loss: -1.0000  memory: 14.71GiB(30.97%)  tps: 16,286
[rank3]:2025-10-30 05:04:49,779 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_nofreeze_dm1/pipeline_schedule/251030_0504_real_step600_rank3.svg
[rank3]:> Batch Time: 500.39 ms, GPU Bubble Ratio: 49.05%, 46.16%, 56.67%, 13.02%
[rank2]:2025-10-30 05:04:50,372 - INFO - Avg. fwd time: 3.8316 / Avg. bwd time: 9.7545 / Avg. batch time: 580.3220 (ms) / GPU bubble ratio: 62.54%
[rank3]:2025-10-30 05:04:50,348 - INFO - Avg. fwd time: 6.3403 / Avg. bwd time: 21.0624 / Avg. batch time: 546.3418 (ms) / GPU bubble ratio: 19.75%
[rank0]:2025-10-30 05:04:50,420 - INFO - Avg. fwd time: 4.0971 / Avg. bwd time: 11.9877 / Avg. batch time: 632.2858 (ms) / GPU bubble ratio: 59.30%
[rank1]:2025-10-30 05:04:50,396 - INFO - Avg. fwd time: 4.7850 / Avg. bwd time: 12.1253 / Avg. batch time: 609.3889 (ms) / GPU bubble ratio: 55.60%
[rank0]:2025-10-30 05:05:54,058 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-30 05:05:55,379 - INFO -  step: 650  loss: -2.0000  grad_norm:  0.6031  memory:  8.13GiB(17.12%)  tps: 6,215  tflops: 47.33  mfu: 15.17%
[rank3]:2025-10-30 05:05:55,392 - INFO -  step: 650  loss:  0.3556  grad_norm:  0.6031  memory: 18.19GiB(38.28%)  tps: 6,214  tflops: 47.32  mfu: 15.17%
[rank0]:2025-10-30 05:05:55,394 - INFO -  step: 650  loss: -2.0000  grad_norm:  0.6031  memory: 14.71GiB(30.97%)  tps: 6,211  tflops: 47.31  mfu: 15.16%
[rank1]:2025-10-30 05:05:55,383 - INFO -  step: 650  loss: -2.0000  grad_norm:  0.6031  memory: 11.85GiB(24.93%)  tps: 6,213  tflops: 47.32  mfu: 15.17%
[rank0]:2025-10-30 05:06:59,669 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-30 05:07:00,993 - INFO -  step: 700  loss: -2.0000  grad_norm:  0.6216  memory: 14.71GiB(30.97%)  tps: 6,244  tflops: 47.56  mfu: 15.24%
[rank1]:2025-10-30 05:07:00,983 - INFO -  step: 700  loss: -2.0000  grad_norm:  0.6216  memory: 11.85GiB(24.93%)  tps: 6,244  tflops: 47.56  mfu: 15.24%
[rank2]:2025-10-30 05:07:00,979 - INFO -  step: 700  loss: -2.0000  grad_norm:  0.6216  memory:  8.13GiB(17.12%)  tps: 6,244  tflops: 47.56  mfu: 15.24%
[rank3]:2025-10-30 05:07:00,991 - INFO -  step: 700  loss:  0.2306  grad_norm:  0.6216  memory: 18.19GiB(38.28%)  tps: 6,244  tflops: 47.56  mfu: 15.24%
[rank3]:2025-10-30 05:07:01,311 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_nofreeze_dm1/pipeline_schedule/251030_0507_real_step700_rank3.svg
[rank3]:> Batch Time: 500.23 ms, GPU Bubble Ratio: 49.03%, 46.12%, 56.65%, 13.02%
[rank3]:2025-10-30 05:07:01,644 - INFO - Avg. fwd time: 6.3364 / Avg. bwd time: 21.0541 / Avg. batch time: 546.0317 (ms) / GPU bubble ratio: 19.74%
[rank2]:2025-10-30 05:07:01,699 - INFO - Avg. fwd time: 3.8314 / Avg. bwd time: 9.7568 / Avg. batch time: 579.8431 (ms) / GPU bubble ratio: 62.51%
[rank0]:2025-10-30 05:07:01,719 - INFO - Avg. fwd time: 4.0977 / Avg. bwd time: 11.9902 / Avg. batch time: 631.8172 (ms) / GPU bubble ratio: 59.26%
[rank1]:2025-10-30 05:07:01,798 - INFO - Avg. fwd time: 4.7858 / Avg. bwd time: 12.1258 / Avg. batch time: 608.9149 (ms) / GPU bubble ratio: 55.56%
[rank0]:2025-10-30 05:08:05,505 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-30 05:08:06,832 - INFO -  step: 750  loss: -2.0000  grad_norm:  0.4788  memory: 11.85GiB(24.93%)  tps: 6,220  tflops: 47.38  mfu: 15.18%
[rank2]:2025-10-30 05:08:06,828 - INFO -  step: 750  loss: -2.0000  grad_norm:  0.4788  memory:  8.13GiB(17.12%)  tps: 6,220  tflops: 47.38  mfu: 15.18%
[rank3]:2025-10-30 05:08:06,841 - INFO -  step: 750  loss:  0.2235  grad_norm:  0.4788  memory: 18.19GiB(38.28%)  tps: 6,220  tflops: 47.38  mfu: 15.18%
[rank0]:2025-10-30 05:08:06,843 - INFO -  step: 750  loss: -2.0000  grad_norm:  0.4788  memory: 14.71GiB(30.97%)  tps: 6,220  tflops: 47.38  mfu: 15.18%
[rank0]:2025-10-30 05:09:11,085 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-30 05:09:12,418 - INFO -  step: 800  loss: -2.0000  grad_norm:  0.7381  memory: 11.85GiB(24.93%)  tps: 6,245  tflops: 47.57  mfu: 15.25%
[rank1]:2025-10-30 05:09:12,418 - INFO - ðŸ”Ž  Running validation at step 800
[rank2]:2025-10-30 05:09:12,414 - INFO -  step: 800  loss: -2.0000  grad_norm:  0.7381  memory:  8.13GiB(17.12%)  tps: 6,245  tflops: 47.57  mfu: 15.25%
[rank2]:2025-10-30 05:09:12,414 - INFO - ðŸ”Ž  Running validation at step 800
[rank3]:2025-10-30 05:09:12,427 - INFO -  step: 800  loss:  0.2612  grad_norm:  0.7381  memory: 18.19GiB(38.28%)  tps: 6,245  tflops: 47.57  mfu: 15.25%
[rank3]:2025-10-30 05:09:12,427 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-10-30 05:09:12,428 - INFO -  step: 800  loss: -2.0000  grad_norm:  0.7381  memory: 14.71GiB(30.97%)  tps: 6,245  tflops: 47.57  mfu: 15.25%
[rank0]:2025-10-30 05:09:12,429 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-10-30 05:09:38,009 - INFO - validate step: 800  loss: -1.0000  memory: 14.71GiB(30.97%)  tps: 16,013
[rank0]:2025-10-30 05:09:38,009 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-30 05:09:38,016 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank1]:2025-10-30 05:09:38,013 - INFO - validate step: 800  loss: -1.0000  memory: 11.85GiB(24.93%)  tps: 16,004
[rank1]:2025-10-30 05:09:38,013 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-30 05:09:38,029 - INFO - validate step: 800  loss: -1.0000  memory:  8.13GiB(17.12%)  tps: 15,991
[rank2]:2025-10-30 05:09:38,030 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-30 05:09:38,027 - INFO - validate step: 800  loss:  0.9323  memory: 18.19GiB(38.28%)  tps: 16,001
[rank3]:2025-10-30 05:09:38,028 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-30 05:09:39,954 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 1.92 seconds.
[rank1]:2025-10-30 05:09:40,417 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 2.40 seconds.
[rank3]:2025-10-30 05:09:41,348 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.32 seconds.
[rank0]:2025-10-30 05:09:41,952 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-30 05:09:41,955 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.95 seconds.
[rank3]:2025-10-30 05:09:42,459 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_nofreeze_dm1/pipeline_schedule/251030_0509_real_step800_rank3.svg
[rank3]:> Batch Time: 500.05 ms, GPU Bubble Ratio: 49.01%, 46.10%, 56.64%, 13.03%
[rank2]:2025-10-30 05:09:42,856 - INFO - Avg. fwd time: 3.8313 / Avg. bwd time: 9.7583 / Avg. batch time: 579.6532 (ms) / GPU bubble ratio: 62.49%
[rank3]:2025-10-30 05:09:42,800 - INFO - Avg. fwd time: 6.3329 / Avg. bwd time: 21.0514 / Avg. batch time: 545.8231 (ms) / GPU bubble ratio: 19.73%
[rank0]:2025-10-30 05:09:42,877 - INFO - Avg. fwd time: 4.0981 / Avg. bwd time: 11.9924 / Avg. batch time: 631.6223 (ms) / GPU bubble ratio: 59.24%
[rank1]:2025-10-30 05:09:42,955 - INFO - Avg. fwd time: 4.7861 / Avg. bwd time: 12.1256 / Avg. batch time: 608.7230 (ms) / GPU bubble ratio: 55.55%
[rank3]:2025-10-30 05:09:56,193 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-30 05:09:56,246 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-30 05:09:56,225 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-30 05:09:56,272 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-30 05:10:47,009 - INFO - [GC] Peforming periodical GC collection 0.31 seconds
[rank1]:2025-10-30 05:10:48,329 - INFO -  step: 850  loss: -2.0000  grad_norm:  3.6402  memory: 11.85GiB(24.93%)  tps: 5,825  tflops: 44.37  mfu: 14.22%
[rank2]:2025-10-30 05:10:48,325 - INFO -  step: 850  loss: -2.0000  grad_norm:  3.6402  memory:  8.13GiB(17.12%)  tps: 5,827  tflops: 44.38  mfu: 14.22%
[rank3]:2025-10-30 05:10:48,337 - INFO -  step: 850  loss:  0.2075  grad_norm:  3.6402  memory: 18.19GiB(38.28%)  tps: 5,826  tflops: 44.37  mfu: 14.22%
[rank0]:2025-10-30 05:10:48,339 - INFO -  step: 850  loss: -2.0000  grad_norm:  3.6402  memory: 14.71GiB(30.97%)  tps: 5,824  tflops: 44.36  mfu: 14.22%
[rank0]:2025-10-30 05:11:52,718 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-30 05:11:54,033 - INFO -  step: 900  loss: -2.0000  grad_norm:  0.4112  memory: 11.85GiB(24.93%)  tps: 6,234  tflops: 47.48  mfu: 15.22%
[rank2]:2025-10-30 05:11:54,029 - INFO -  step: 900  loss: -2.0000  grad_norm:  0.4112  memory:  8.13GiB(17.12%)  tps: 6,234  tflops: 47.48  mfu: 15.22%
[rank3]:2025-10-30 05:11:54,041 - INFO -  step: 900  loss:  0.2183  grad_norm:  0.4112  memory: 18.19GiB(38.28%)  tps: 6,234  tflops: 47.48  mfu: 15.22%
[rank0]:2025-10-30 05:11:54,043 - INFO -  step: 900  loss: -2.0000  grad_norm:  0.4112  memory: 14.71GiB(30.97%)  tps: 6,234  tflops: 47.48  mfu: 15.22%
[rank3]:2025-10-30 05:11:54,354 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_nofreeze_dm1/pipeline_schedule/251030_0511_real_step900_rank3.svg
[rank3]:> Batch Time: 499.95 ms, GPU Bubble Ratio: 49.00%, 46.08%, 56.61%, 13.03%
[rank2]:2025-10-30 05:11:54,940 - INFO - Avg. fwd time: 3.8314 / Avg. bwd time: 9.7597 / Avg. batch time: 579.8127 (ms) / GPU bubble ratio: 62.50%
[rank3]:2025-10-30 05:11:54,915 - INFO - Avg. fwd time: 6.3319 / Avg. bwd time: 21.0501 / Avg. batch time: 545.7200 (ms) / GPU bubble ratio: 19.72%
[rank0]:2025-10-30 05:11:54,989 - INFO - Avg. fwd time: 4.0983 / Avg. bwd time: 11.9936 / Avg. batch time: 631.7927 (ms) / GPU bubble ratio: 59.25%
[rank1]:2025-10-30 05:11:54,965 - INFO - Avg. fwd time: 4.7866 / Avg. bwd time: 12.1249 / Avg. batch time: 608.8871 (ms) / GPU bubble ratio: 55.56%
[rank0]:2025-10-30 05:12:58,933 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-30 05:13:00,274 - INFO -  step: 950  loss: -2.0000  grad_norm:  0.4605  memory: 14.71GiB(30.97%)  tps: 6,185  tflops: 47.10  mfu: 15.10%
[rank1]:2025-10-30 05:13:00,263 - INFO -  step: 950  loss: -2.0000  grad_norm:  0.4605  memory: 11.85GiB(24.93%)  tps: 6,185  tflops: 47.10  mfu: 15.10%
[rank2]:2025-10-30 05:13:00,259 - INFO -  step: 950  loss: -2.0000  grad_norm:  0.4605  memory:  8.13GiB(17.12%)  tps: 6,185  tflops: 47.10  mfu: 15.10%
[rank3]:2025-10-30 05:13:00,272 - INFO -  step: 950  loss:  0.1893  grad_norm:  0.4605  memory: 18.19GiB(38.28%)  tps: 6,185  tflops: 47.10  mfu: 15.10%
[rank0]:2025-10-30 05:14:04,725 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-30 05:14:06,078 - INFO -  step: 1000  loss: -2.0000  grad_norm:  0.7229  memory: 14.71GiB(30.97%)  tps: 6,225  tflops: 47.41  mfu: 15.19%
[rank0]:2025-10-30 05:14:06,078 - INFO - ðŸ”Ž  Running validation at step 1000
[rank1]:2025-10-30 05:14:06,067 - INFO -  step: 1000  loss: -2.0000  grad_norm:  0.7229  memory: 11.85GiB(24.93%)  tps: 6,225  tflops: 47.41  mfu: 15.19%
[rank1]:2025-10-30 05:14:06,068 - INFO - ðŸ”Ž  Running validation at step 1000
[rank2]:2025-10-30 05:14:06,064 - INFO -  step: 1000  loss: -2.0000  grad_norm:  0.7229  memory:  8.13GiB(17.12%)  tps: 6,225  tflops: 47.41  mfu: 15.19%
[rank2]:2025-10-30 05:14:06,064 - INFO - ðŸ”Ž  Running validation at step 1000
[rank3]:2025-10-30 05:14:06,076 - INFO -  step: 1000  loss:  0.2699  grad_norm:  0.7229  memory: 18.19GiB(38.28%)  tps: 6,225  tflops: 47.41  mfu: 15.20%
[rank3]:2025-10-30 05:14:06,076 - INFO - ðŸ”Ž  Running validation at step 1000
[rank3]:2025-10-30 05:14:31,178 - INFO - validate step: 1000  loss:  0.9498  memory: 18.19GiB(38.28%)  tps: 16,318
[rank0]:2025-10-30 05:14:31,160 - INFO - validate step: 1000  loss: -1.0000  memory: 14.71GiB(30.97%)  tps: 16,331
[rank1]:2025-10-30 05:14:31,171 - INFO - validate step: 1000  loss: -1.0000  memory: 11.85GiB(24.93%)  tps: 16,317
[rank2]:2025-10-30 05:14:31,179 - INFO - validate step: 1000  loss: -1.0000  memory:  8.13GiB(17.12%)  tps: 16,309
[rank3]:2025-10-30 05:14:31,502 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_nofreeze_dm1/pipeline_schedule/251030_0514_real_step1000_rank3.svg
[rank3]:> Batch Time: 500.17 ms, GPU Bubble Ratio: 49.02%, 46.10%, 56.62%, 13.02%
[rank3]:2025-10-30 05:14:31,828 - INFO - Avg. fwd time: 6.3354 / Avg. bwd time: 21.0599 / Avg. batch time: 545.8787 (ms) / GPU bubble ratio: 19.70%
[rank0]:2025-10-30 05:14:31,908 - INFO - Avg. fwd time: 4.0992 / Avg. bwd time: 11.9956 / Avg. batch time: 631.7930 (ms) / GPU bubble ratio: 59.24%
[rank2]:2025-10-30 05:14:31,888 - INFO - Avg. fwd time: 3.8320 / Avg. bwd time: 9.7617 / Avg. batch time: 579.8116 (ms) / GPU bubble ratio: 62.49%
[rank1]:2025-10-30 05:14:31,985 - INFO - Avg. fwd time: 4.7872 / Avg. bwd time: 12.1265 / Avg. batch time: 608.8849 (ms) / GPU bubble ratio: 55.56%
[rank0]:2025-10-30 05:15:35,813 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-30 05:15:37,136 - INFO -  step: 1050  loss: -2.0000  grad_norm:  0.5789  memory:  8.13GiB(17.12%)  tps: 6,210  tflops: 47.30  mfu: 15.16%
[rank1]:2025-10-30 05:15:37,139 - INFO -  step: 1050  loss: -2.0000  grad_norm:  0.5789  memory: 11.85GiB(24.93%)  tps: 6,209  tflops: 47.29  mfu: 15.16%
[rank3]:2025-10-30 05:15:37,147 - INFO -  step: 1050  loss:  0.2811  grad_norm:  0.5789  memory: 18.19GiB(38.28%)  tps: 6,209  tflops: 47.29  mfu: 15.16%
[rank0]:2025-10-30 05:15:37,150 - INFO -  step: 1050  loss: -2.0000  grad_norm:  0.5789  memory: 14.71GiB(30.97%)  tps: 6,207  tflops: 47.27  mfu: 15.15%
[rank0]:2025-10-30 05:16:41,443 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-30 05:16:42,773 - INFO -  step: 1100  loss: -2.0000  grad_norm:  0.5810  memory: 14.71GiB(30.97%)  tps: 6,242  tflops: 47.54  mfu: 15.24%
[rank1]:2025-10-30 05:16:42,762 - INFO -  step: 1100  loss: -2.0000  grad_norm:  0.5810  memory: 11.85GiB(24.93%)  tps: 6,242  tflops: 47.54  mfu: 15.24%
[rank2]:2025-10-30 05:16:42,758 - INFO -  step: 1100  loss: -2.0000  grad_norm:  0.5810  memory:  8.13GiB(17.12%)  tps: 6,242  tflops: 47.54  mfu: 15.24%
[rank3]:2025-10-30 05:16:42,770 - INFO -  step: 1100  loss:  0.2924  grad_norm:  0.5810  memory: 18.19GiB(38.28%)  tps: 6,242  tflops: 47.54  mfu: 15.24%
[rank3]:2025-10-30 05:16:43,088 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_nofreeze_dm1/pipeline_schedule/251030_0516_real_step1100_rank3.svg
[rank3]:> Batch Time: 500.15 ms, GPU Bubble Ratio: 49.02%, 46.09%, 56.62%, 13.02%
[rank3]:2025-10-30 05:16:43,426 - INFO - Avg. fwd time: 6.3351 / Avg. bwd time: 21.0605 / Avg. batch time: 545.8286 (ms) / GPU bubble ratio: 19.69%
[rank2]:2025-10-30 05:16:43,482 - INFO - Avg. fwd time: 3.8320 / Avg. bwd time: 9.7628 / Avg. batch time: 579.7381 (ms) / GPU bubble ratio: 62.48%
[rank0]:2025-10-30 05:16:43,502 - INFO - Avg. fwd time: 4.0991 / Avg. bwd time: 11.9967 / Avg. batch time: 631.7118 (ms) / GPU bubble ratio: 59.23%
[rank1]:2025-10-30 05:16:43,576 - INFO - Avg. fwd time: 4.7877 / Avg. bwd time: 12.1267 / Avg. batch time: 608.8050 (ms) / GPU bubble ratio: 55.55%
[rank0]:2025-10-30 05:17:47,362 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-30 05:17:48,697 - INFO -  step: 1150  loss: -2.0000  grad_norm:  0.4395  memory: 11.85GiB(24.93%)  tps: 6,212  tflops: 47.31  mfu: 15.16%
[rank2]:2025-10-30 05:17:48,693 - INFO -  step: 1150  loss: -2.0000  grad_norm:  0.4395  memory:  8.13GiB(17.12%)  tps: 6,212  tflops: 47.31  mfu: 15.16%
[rank3]:2025-10-30 05:17:48,705 - INFO -  step: 1150  loss:  0.2215  grad_norm:  0.4395  memory: 18.19GiB(38.28%)  tps: 6,212  tflops: 47.31  mfu: 15.16%
[rank0]:2025-10-30 05:17:48,708 - INFO -  step: 1150  loss: -2.0000  grad_norm:  0.4395  memory: 14.71GiB(30.97%)  tps: 6,212  tflops: 47.31  mfu: 15.16%
[rank0]:2025-10-30 05:18:53,041 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-30 05:18:54,374 - INFO -  step: 1200  loss: -2.0000  grad_norm:  0.6874  memory: 11.85GiB(24.93%)  tps: 6,237  tflops: 47.50  mfu: 15.22%
[rank1]:2025-10-30 05:18:54,375 - INFO - ðŸ”Ž  Running validation at step 1200
[rank2]:2025-10-30 05:18:54,371 - INFO -  step: 1200  loss: -2.0000  grad_norm:  0.6874  memory:  8.13GiB(17.12%)  tps: 6,237  tflops: 47.50  mfu: 15.22%
[rank2]:2025-10-30 05:18:54,371 - INFO - ðŸ”Ž  Running validation at step 1200
[rank3]:2025-10-30 05:18:54,383 - INFO -  step: 1200  loss:  0.1706  grad_norm:  0.6874  memory: 18.19GiB(38.28%)  tps: 6,237  tflops: 47.50  mfu: 15.22%
[rank3]:2025-10-30 05:18:54,383 - INFO - ðŸ”Ž  Running validation at step 1200
[rank0]:2025-10-30 05:18:54,385 - INFO -  step: 1200  loss: -2.0000  grad_norm:  0.6874  memory: 14.71GiB(30.97%)  tps: 6,237  tflops: 47.50  mfu: 15.22%
[rank0]:2025-10-30 05:18:54,385 - INFO - ðŸ”Ž  Running validation at step 1200
[rank0]:2025-10-30 05:19:19,352 - INFO - validate step: 1200  loss: -1.0000  memory: 14.71GiB(30.97%)  tps: 16,406
[rank1]:2025-10-30 05:19:19,358 - INFO - validate step: 1200  loss: -1.0000  memory: 11.85GiB(24.93%)  tps: 16,395
[rank2]:2025-10-30 05:19:19,371 - INFO - validate step: 1200  loss: -1.0000  memory:  8.13GiB(17.12%)  tps: 16,384
[rank3]:2025-10-30 05:19:19,370 - INFO - validate step: 1200  loss:  0.9592  memory: 18.19GiB(38.28%)  tps: 16,393
[rank3]:2025-10-30 05:19:19,704 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_nofreeze_dm1/pipeline_schedule/251030_0519_real_step1200_rank3.svg
[rank3]:> Batch Time: 500.16 ms, GPU Bubble Ratio: 49.02%, 46.08%, 56.62%, 13.01%
[rank2]:2025-10-30 05:19:20,304 - INFO - Avg. fwd time: 3.8319 / Avg. bwd time: 9.7633 / Avg. batch time: 579.8354 (ms) / GPU bubble ratio: 62.49%
[rank3]:2025-10-30 05:19:20,279 - INFO - Avg. fwd time: 6.3359 / Avg. bwd time: 21.0612 / Avg. batch time: 545.8109 (ms) / GPU bubble ratio: 19.69%
[rank0]:2025-10-30 05:19:20,355 - INFO - Avg. fwd time: 4.0991 / Avg. bwd time: 11.9973 / Avg. batch time: 631.8042 (ms) / GPU bubble ratio: 59.24%
[rank1]:2025-10-30 05:19:20,330 - INFO - Avg. fwd time: 4.7879 / Avg. bwd time: 12.1263 / Avg. batch time: 608.8995 (ms) / GPU bubble ratio: 55.55%
[rank0]:2025-10-30 05:20:24,082 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-30 05:20:25,405 - INFO -  step: 1250  loss: -2.0000  grad_norm:  0.6347  memory:  8.13GiB(17.12%)  tps: 6,203  tflops: 47.24  mfu: 15.14%
[rank3]:2025-10-30 05:20:25,418 - INFO -  step: 1250  loss:  0.2770  grad_norm:  0.6347  memory: 18.19GiB(38.28%)  tps: 6,202  tflops: 47.23  mfu: 15.14%
[rank0]:2025-10-30 05:20:25,420 - INFO -  step: 1250  loss: -2.0000  grad_norm:  0.6347  memory: 14.71GiB(30.97%)  tps: 6,200  tflops: 47.22  mfu: 15.13%
[rank1]:2025-10-30 05:20:25,409 - INFO -  step: 1250  loss: -2.0000  grad_norm:  0.6347  memory: 11.85GiB(24.93%)  tps: 6,201  tflops: 47.23  mfu: 15.14%
[rank0]:2025-10-30 05:21:29,731 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-30 05:21:31,074 - INFO -  step: 1300  loss: -2.0000  grad_norm:  0.5285  memory: 14.71GiB(30.97%)  tps: 6,239  tflops: 47.52  mfu: 15.23%
[rank1]:2025-10-30 05:21:31,063 - INFO -  step: 1300  loss: -2.0000  grad_norm:  0.5285  memory: 11.85GiB(24.93%)  tps: 6,239  tflops: 47.52  mfu: 15.23%
[rank2]:2025-10-30 05:21:31,059 - INFO -  step: 1300  loss: -2.0000  grad_norm:  0.5285  memory:  8.13GiB(17.12%)  tps: 6,239  tflops: 47.52  mfu: 15.23%
[rank3]:2025-10-30 05:21:31,071 - INFO -  step: 1300  loss:  0.2431  grad_norm:  0.5285  memory: 18.19GiB(38.28%)  tps: 6,239  tflops: 47.52  mfu: 15.23%
[rank3]:2025-10-30 05:21:31,389 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_nofreeze_dm1/pipeline_schedule/251030_0521_real_step1300_rank3.svg
[rank3]:> Batch Time: 500.14 ms, GPU Bubble Ratio: 49.02%, 46.09%, 56.62%, 13.01%
[rank3]:2025-10-30 05:21:31,721 - INFO - Avg. fwd time: 6.3357 / Avg. bwd time: 21.0620 / Avg. batch time: 545.7920 (ms) / GPU bubble ratio: 19.68%
[rank2]:2025-10-30 05:21:31,777 - INFO - Avg. fwd time: 3.8322 / Avg. bwd time: 9.7639 / Avg. batch time: 579.7078 (ms) / GPU bubble ratio: 62.47%
[rank0]:2025-10-30 05:21:31,797 - INFO - Avg. fwd time: 4.0990 / Avg. bwd time: 11.9979 / Avg. batch time: 631.6668 (ms) / GPU bubble ratio: 59.23%
[rank1]:2025-10-30 05:21:31,875 - INFO - Avg. fwd time: 4.7879 / Avg. bwd time: 12.1253 / Avg. batch time: 608.7651 (ms) / GPU bubble ratio: 55.55%
[rank0]:2025-10-30 05:22:35,624 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-30 05:22:36,960 - INFO -  step: 1350  loss: -2.0000  grad_norm:  0.4602  memory:  8.13GiB(17.12%)  tps: 6,215  tflops: 47.34  mfu: 15.17%
[rank3]:2025-10-30 05:22:36,972 - INFO -  step: 1350  loss:  0.2404  grad_norm:  0.4602  memory: 18.19GiB(38.28%)  tps: 6,216  tflops: 47.34  mfu: 15.17%
[rank1]:2025-10-30 05:22:36,963 - INFO -  step: 1350  loss: -2.0000  grad_norm:  0.4602  memory: 11.85GiB(24.93%)  tps: 6,215  tflops: 47.34  mfu: 15.17%
[rank0]:2025-10-30 05:22:36,974 - INFO -  step: 1350  loss: -2.0000  grad_norm:  0.4602  memory: 14.71GiB(30.97%)  tps: 6,215  tflops: 47.34  mfu: 15.17%
[rank0]:2025-10-30 05:23:41,369 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-30 05:23:42,717 - INFO -  step: 1400  loss:  0.2092  grad_norm:  0.7109  memory: 18.19GiB(38.28%)  tps: 6,230  tflops: 47.45  mfu: 15.21%
[rank3]:2025-10-30 05:23:42,717 - INFO - ðŸ”Ž  Running validation at step 1400
[rank1]:2025-10-30 05:23:42,708 - INFO -  step: 1400  loss: -2.0000  grad_norm:  0.7109  memory: 11.85GiB(24.93%)  tps: 6,230  tflops: 47.45  mfu: 15.21%
[rank1]:2025-10-30 05:23:42,708 - INFO - ðŸ”Ž  Running validation at step 1400
[rank0]:2025-10-30 05:23:42,719 - INFO -  step: 1400  loss: -2.0000  grad_norm:  0.7109  memory: 14.71GiB(30.97%)  tps: 6,230  tflops: 47.45  mfu: 15.21%
[rank0]:2025-10-30 05:23:42,719 - INFO - ðŸ”Ž  Running validation at step 1400
[rank2]:2025-10-30 05:23:42,704 - INFO -  step: 1400  loss: -2.0000  grad_norm:  0.7109  memory:  8.13GiB(17.12%)  tps: 6,230  tflops: 47.45  mfu: 15.21%
[rank2]:2025-10-30 05:23:42,705 - INFO - ðŸ”Ž  Running validation at step 1400
[rank0]:2025-10-30 05:24:07,779 - INFO - validate step: 1400  loss: -1.0000  memory: 14.71GiB(30.97%)  tps: 16,345
[rank3]:2025-10-30 05:24:07,798 - INFO - validate step: 1400  loss:  0.9596  memory: 18.19GiB(38.28%)  tps: 16,332
[rank1]:2025-10-30 05:24:07,785 - INFO - validate step: 1400  loss: -1.0000  memory: 11.85GiB(24.93%)  tps: 16,334
[rank2]:2025-10-30 05:24:07,798 - INFO - validate step: 1400  loss: -1.0000  memory:  8.13GiB(17.12%)  tps: 16,323
[rank3]:2025-10-30 05:24:08,111 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_nofreeze_dm1/pipeline_schedule/251030_0524_real_step1400_rank3.svg
[rank3]:> Batch Time: 500.13 ms, GPU Bubble Ratio: 49.01%, 46.08%, 56.61%, 13.01%
[rank3]:2025-10-30 05:24:08,455 - INFO - Avg. fwd time: 6.3352 / Avg. bwd time: 21.0634 / Avg. batch time: 545.7771 (ms) / GPU bubble ratio: 19.68%
[rank0]:2025-10-30 05:24:08,532 - INFO - Avg. fwd time: 4.0992 / Avg. bwd time: 11.9999 / Avg. batch time: 631.6443 (ms) / GPU bubble ratio: 59.22%
[rank2]:2025-10-30 05:24:08,512 - INFO - Avg. fwd time: 3.8326 / Avg. bwd time: 9.7654 / Avg. batch time: 579.6882 (ms) / GPU bubble ratio: 62.47%
[rank1]:2025-10-30 05:24:08,609 - INFO - Avg. fwd time: 4.7886 / Avg. bwd time: 12.1260 / Avg. batch time: 608.7447 (ms) / GPU bubble ratio: 55.54%
[rank0]:2025-10-30 05:25:12,599 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-30 05:25:13,931 - INFO -  step: 1450  loss:  0.2170  grad_norm:  0.5374  memory: 18.19GiB(38.28%)  tps: 6,194  tflops: 47.17  mfu: 15.12%
[rank0]:2025-10-30 05:25:13,934 - INFO -  step: 1450  loss: -2.0000  grad_norm:  0.5374  memory: 14.71GiB(30.97%)  tps: 6,192  tflops: 47.16  mfu: 15.11%
[rank1]:2025-10-30 05:25:13,923 - INFO -  step: 1450  loss: -2.0000  grad_norm:  0.5374  memory: 11.85GiB(24.93%)  tps: 6,193  tflops: 47.17  mfu: 15.12%
[rank2]:2025-10-30 05:25:13,919 - INFO -  step: 1450  loss: -2.0000  grad_norm:  0.5374  memory:  8.13GiB(17.12%)  tps: 6,195  tflops: 47.18  mfu: 15.12%
[rank0]:2025-10-30 05:26:18,205 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-30 05:26:19,526 - INFO -  step: 1500  loss:  0.2535  grad_norm:  0.4752  memory: 18.19GiB(38.28%)  tps: 6,245  tflops: 47.56  mfu: 15.24%
[rank0]:2025-10-30 05:26:19,528 - INFO -  step: 1500  loss: -2.0000  grad_norm:  0.4752  memory: 14.71GiB(30.97%)  tps: 6,244  tflops: 47.56  mfu: 15.24%
[rank1]:2025-10-30 05:26:19,517 - INFO -  step: 1500  loss: -2.0000  grad_norm:  0.4752  memory: 11.85GiB(24.93%)  tps: 6,244  tflops: 47.56  mfu: 15.24%
[rank2]:2025-10-30 05:26:19,514 - INFO -  step: 1500  loss: -2.0000  grad_norm:  0.4752  memory:  8.13GiB(17.12%)  tps: 6,244  tflops: 47.56  mfu: 15.24%
[rank3]:2025-10-30 05:26:19,846 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_nofreeze_dm1/pipeline_schedule/251030_0526_real_step1500_rank3.svg
[rank3]:> Batch Time: 500.11 ms, GPU Bubble Ratio: 49.00%, 46.06%, 56.60%, 13.02%
[rank3]:2025-10-30 05:26:20,410 - INFO - Avg. fwd time: 6.3358 / Avg. bwd time: 21.0645 / Avg. batch time: 545.7804 (ms) / GPU bubble ratio: 19.67%
[rank2]:2025-10-30 05:26:20,439 - INFO - Avg. fwd time: 3.8329 / Avg. bwd time: 9.7666 / Avg. batch time: 579.7883 (ms) / GPU bubble ratio: 62.47%
[rank0]:2025-10-30 05:26:20,493 - INFO - Avg. fwd time: 4.0995 / Avg. bwd time: 12.0014 / Avg. batch time: 631.7475 (ms) / GPU bubble ratio: 59.22%
[rank1]:2025-10-30 05:26:20,465 - INFO - Avg. fwd time: 4.7892 / Avg. bwd time: 12.1268 / Avg. batch time: 608.8465 (ms) / GPU bubble ratio: 55.55%
[rank0]:2025-10-30 05:27:24,124 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-30 05:27:25,443 - INFO -  step: 1550  loss: -2.0000  grad_norm:  0.4301  memory: 11.85GiB(24.93%)  tps: 6,213  tflops: 47.32  mfu: 15.17%
[rank2]:2025-10-30 05:27:25,439 - INFO -  step: 1550  loss: -2.0000  grad_norm:  0.4301  memory:  8.13GiB(17.12%)  tps: 6,213  tflops: 47.32  mfu: 15.17%
[rank3]:2025-10-30 05:27:25,452 - INFO -  step: 1550  loss:  0.2066  grad_norm:  0.4301  memory: 18.19GiB(38.28%)  tps: 6,213  tflops: 47.32  mfu: 15.17%
[rank0]:2025-10-30 05:27:25,453 - INFO -  step: 1550  loss: -2.0000  grad_norm:  0.4301  memory: 14.71GiB(30.97%)  tps: 6,213  tflops: 47.32  mfu: 15.17%
[rank0]:2025-10-30 05:28:29,825 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-30 05:28:31,176 - INFO -  step: 1600  loss: -2.0000  grad_norm:  0.7335  memory: 14.71GiB(30.97%)  tps: 6,232  tflops: 47.47  mfu: 15.21%
[rank3]:2025-10-30 05:28:31,174 - INFO -  step: 1600  loss:  0.1745  grad_norm:  0.7335  memory: 18.19GiB(38.28%)  tps: 6,232  tflops: 47.47  mfu: 15.21%
[rank0]:2025-10-30 05:28:31,176 - INFO - ðŸ”Ž  Running validation at step 1600
[rank3]:2025-10-30 05:28:31,174 - INFO - ðŸ”Ž  Running validation at step 1600
[rank1]:2025-10-30 05:28:31,166 - INFO -  step: 1600  loss: -2.0000  grad_norm:  0.7335  memory: 11.85GiB(24.93%)  tps: 6,232  tflops: 47.47  mfu: 15.21%
[rank1]:2025-10-30 05:28:31,166 - INFO - ðŸ”Ž  Running validation at step 1600
[rank2]:2025-10-30 05:28:31,162 - INFO -  step: 1600  loss: -2.0000  grad_norm:  0.7335  memory:  8.13GiB(17.12%)  tps: 6,232  tflops: 47.47  mfu: 15.21%
[rank2]:2025-10-30 05:28:31,162 - INFO - ðŸ”Ž  Running validation at step 1600
[rank0]:2025-10-30 05:28:56,381 - INFO - validate step: 1600  loss: -1.0000  memory: 14.71GiB(30.97%)  tps: 16,251
[rank0]:2025-10-30 05:28:56,381 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-30 05:28:56,390 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank3]:2025-10-30 05:28:56,399 - INFO - validate step: 1600  loss:  0.9618  memory: 18.19GiB(38.28%)  tps: 16,239
[rank3]:2025-10-30 05:28:56,400 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-30 05:28:56,391 - INFO - validate step: 1600  loss: -1.0000  memory: 11.85GiB(24.93%)  tps: 16,238
[rank1]:2025-10-30 05:28:56,391 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-30 05:28:56,401 - INFO - validate step: 1600  loss: -1.0000  memory:  8.13GiB(17.12%)  tps: 16,229
[rank2]:2025-10-30 05:28:56,402 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-30 05:28:58,322 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 1.92 seconds.
[rank1]:2025-10-30 05:28:59,006 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 2.61 seconds.
[rank3]:2025-10-30 05:29:00,153 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.75 seconds.
[rank0]:2025-10-30 05:29:00,179 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-30 05:29:00,186 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.80 seconds.
[rank3]:2025-10-30 05:29:00,736 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_nofreeze_dm1/pipeline_schedule/251030_0529_real_step1600_rank3.svg
[rank3]:> Batch Time: 500.06 ms, GPU Bubble Ratio: 48.99%, 46.06%, 56.60%, 13.02%
[rank3]:2025-10-30 05:29:01,090 - INFO - Avg. fwd time: 6.3347 / Avg. bwd time: 21.0637 / Avg. batch time: 545.7351 (ms) / GPU bubble ratio: 19.67%
[rank2]:2025-10-30 05:29:01,146 - INFO - Avg. fwd time: 3.8330 / Avg. bwd time: 9.7671 / Avg. batch time: 579.6660 (ms) / GPU bubble ratio: 62.46%
[rank0]:2025-10-30 05:29:01,167 - INFO - Avg. fwd time: 4.0996 / Avg. bwd time: 12.0024 / Avg. batch time: 631.6203 (ms) / GPU bubble ratio: 59.21%
[rank1]:2025-10-30 05:29:01,242 - INFO - Avg. fwd time: 4.7894 / Avg. bwd time: 12.1260 / Avg. batch time: 608.7208 (ms) / GPU bubble ratio: 55.54%
[rank3]:2025-10-30 05:29:28,736 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-30 05:29:29,003 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-30 05:29:28,985 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-30 05:29:29,018 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-30 05:30:05,324 - INFO - [GC] Peforming periodical GC collection 0.31 seconds
[rank2]:2025-10-30 05:30:06,661 - INFO -  step: 1650  loss: -2.0000  grad_norm:  0.7814  memory:  8.13GiB(17.12%)  tps: 5,830  tflops: 44.40  mfu: 14.23%
[rank3]:2025-10-30 05:30:06,673 - INFO -  step: 1650  loss:  0.2738  grad_norm:  0.7814  memory: 18.19GiB(38.28%)  tps: 5,829  tflops: 44.39  mfu: 14.23%
[rank0]:2025-10-30 05:30:06,675 - INFO -  step: 1650  loss: -2.0000  grad_norm:  0.7814  memory: 14.71GiB(30.97%)  tps: 5,827  tflops: 44.38  mfu: 14.22%
[rank1]:2025-10-30 05:30:06,665 - INFO -  step: 1650  loss: -2.0000  grad_norm:  0.7814  memory: 11.85GiB(24.93%)  tps: 5,829  tflops: 44.39  mfu: 14.23%
[rank0]:2025-10-30 05:31:10,966 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-30 05:31:12,313 - INFO -  step: 1700  loss:  0.2222  grad_norm:  0.5496  memory: 18.19GiB(38.28%)  tps: 6,240  tflops: 47.53  mfu: 15.23%
[rank0]:2025-10-30 05:31:12,315 - INFO -  step: 1700  loss: -2.0000  grad_norm:  0.5496  memory: 14.71GiB(30.97%)  tps: 6,240  tflops: 47.53  mfu: 15.23%
[rank1]:2025-10-30 05:31:12,304 - INFO -  step: 1700  loss: -2.0000  grad_norm:  0.5496  memory: 11.85GiB(24.93%)  tps: 6,240  tflops: 47.53  mfu: 15.23%
[rank2]:2025-10-30 05:31:12,301 - INFO -  step: 1700  loss: -2.0000  grad_norm:  0.5496  memory:  8.13GiB(17.12%)  tps: 6,240  tflops: 47.53  mfu: 15.23%
[rank3]:2025-10-30 05:31:12,632 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_nofreeze_dm1/pipeline_schedule/251030_0531_real_step1700_rank3.svg
[rank3]:> Batch Time: 500.01 ms, GPU Bubble Ratio: 48.99%, 46.04%, 56.58%, 13.02%
[rank3]:2025-10-30 05:31:12,984 - INFO - Avg. fwd time: 6.3338 / Avg. bwd time: 21.0636 / Avg. batch time: 545.7100 (ms) / GPU bubble ratio: 19.67%
[rank2]:2025-10-30 05:31:13,034 - INFO - Avg. fwd time: 3.8331 / Avg. bwd time: 9.7679 / Avg. batch time: 579.7164 (ms) / GPU bubble ratio: 62.46%
[rank0]:2025-10-30 05:31:13,054 - INFO - Avg. fwd time: 4.0993 / Avg. bwd time: 12.0030 / Avg. batch time: 631.6648 (ms) / GPU bubble ratio: 59.21%
[rank1]:2025-10-30 05:31:13,129 - INFO - Avg. fwd time: 4.7897 / Avg. bwd time: 12.1254 / Avg. batch time: 608.7671 (ms) / GPU bubble ratio: 55.54%
[rank0]:2025-10-30 05:32:16,952 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-30 05:32:18,293 - INFO -  step: 1750  loss:  0.1827  grad_norm:  0.4378  memory: 18.19GiB(38.28%)  tps: 6,208  tflops: 47.28  mfu: 15.15%
[rank0]:2025-10-30 05:32:18,295 - INFO -  step: 1750  loss: -2.0000  grad_norm:  0.4378  memory: 14.71GiB(30.97%)  tps: 6,208  tflops: 47.28  mfu: 15.15%
[rank1]:2025-10-30 05:32:18,285 - INFO -  step: 1750  loss: -2.0000  grad_norm:  0.4378  memory: 11.85GiB(24.93%)  tps: 6,208  tflops: 47.28  mfu: 15.15%
[rank2]:2025-10-30 05:32:18,281 - INFO -  step: 1750  loss: -2.0000  grad_norm:  0.4378  memory:  8.13GiB(17.12%)  tps: 6,208  tflops: 47.28  mfu: 15.15%
[rank0]:2025-10-30 05:33:22,627 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-30 05:33:23,984 - INFO -  step: 1800  loss: -2.0000  grad_norm:  0.6952  memory: 14.71GiB(30.97%)  tps: 6,235  tflops: 47.49  mfu: 15.22%
[rank0]:2025-10-30 05:33:23,984 - INFO - ðŸ”Ž  Running validation at step 1800
[rank3]:2025-10-30 05:33:23,982 - INFO -  step: 1800  loss:  0.1643  grad_norm:  0.6952  memory: 18.19GiB(38.28%)  tps: 6,236  tflops: 47.49  mfu: 15.22%
[rank3]:2025-10-30 05:33:23,983 - INFO - ðŸ”Ž  Running validation at step 1800
[rank1]:2025-10-30 05:33:23,974 - INFO -  step: 1800  loss: -2.0000  grad_norm:  0.6952  memory: 11.85GiB(24.93%)  tps: 6,235  tflops: 47.49  mfu: 15.22%
[rank1]:2025-10-30 05:33:23,974 - INFO - ðŸ”Ž  Running validation at step 1800
[rank2]:2025-10-30 05:33:23,970 - INFO -  step: 1800  loss: -2.0000  grad_norm:  0.6952  memory:  8.13GiB(17.12%)  tps: 6,235  tflops: 47.49  mfu: 15.22%
[rank2]:2025-10-30 05:33:23,970 - INFO - ðŸ”Ž  Running validation at step 1800
[rank0]:2025-10-30 05:33:48,977 - INFO - validate step: 1800  loss: -1.0000  memory: 14.71GiB(30.97%)  tps: 16,389
[rank1]:2025-10-30 05:33:48,986 - INFO - validate step: 1800  loss: -1.0000  memory: 11.85GiB(24.93%)  tps: 16,376
[rank3]:2025-10-30 05:33:48,996 - INFO - validate step: 1800  loss:  0.9741  memory: 18.19GiB(38.28%)  tps: 16,376
[rank2]:2025-10-30 05:33:48,996 - INFO - validate step: 1800  loss: -1.0000  memory:  8.13GiB(17.12%)  tps: 16,367
[rank3]:2025-10-30 05:33:49,319 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_nofreeze_dm1/pipeline_schedule/251030_0533_real_step1800_rank3.svg
[rank3]:> Batch Time: 500.07 ms, GPU Bubble Ratio: 48.99%, 46.04%, 56.59%, 13.02%
[rank3]:2025-10-30 05:33:49,892 - INFO - Avg. fwd time: 6.3341 / Avg. bwd time: 21.0660 / Avg. batch time: 545.7370 (ms) / GPU bubble ratio: 19.67%
[rank2]:2025-10-30 05:33:49,915 - INFO - Avg. fwd time: 3.8335 / Avg. bwd time: 9.7690 / Avg. batch time: 579.8081 (ms) / GPU bubble ratio: 62.46%
[rank0]:2025-10-30 05:33:49,971 - INFO - Avg. fwd time: 4.0996 / Avg. bwd time: 12.0046 / Avg. batch time: 631.7536 (ms) / GPU bubble ratio: 59.21%
[rank1]:2025-10-30 05:33:49,943 - INFO - Avg. fwd time: 4.7904 / Avg. bwd time: 12.1259 / Avg. batch time: 608.8573 (ms) / GPU bubble ratio: 55.55%
[rank0]:2025-10-30 05:34:53,675 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-30 05:34:55,010 - INFO -  step: 1850  loss: -2.0000  grad_norm:  0.7575  memory:  8.13GiB(17.12%)  tps: 6,205  tflops: 47.26  mfu: 15.15%
[rank1]:2025-10-30 05:34:55,013 - INFO -  step: 1850  loss: -2.0000  grad_norm:  0.7575  memory: 11.85GiB(24.93%)  tps: 6,204  tflops: 47.25  mfu: 15.14%
[rank0]:2025-10-30 05:34:55,024 - INFO -  step: 1850  loss: -2.0000  grad_norm:  0.7575  memory: 14.71GiB(30.97%)  tps: 6,202  tflops: 47.23  mfu: 15.14%
[rank3]:2025-10-30 05:34:55,022 - INFO -  step: 1850  loss:  0.2688  grad_norm:  0.7575  memory: 18.19GiB(38.28%)  tps: 6,204  tflops: 47.25  mfu: 15.14%
[rank0]:2025-10-30 05:35:59,197 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-30 05:36:00,515 - INFO -  step: 1900  loss: -2.0000  grad_norm:  0.5080  memory:  8.13GiB(17.12%)  tps: 6,253  tflops: 47.62  mfu: 15.26%
[rank0]:2025-10-30 05:36:00,529 - INFO -  step: 1900  loss: -2.0000  grad_norm:  0.5080  memory: 14.71GiB(30.97%)  tps: 6,253  tflops: 47.62  mfu: 15.26%
[rank1]:2025-10-30 05:36:00,519 - INFO -  step: 1900  loss: -2.0000  grad_norm:  0.5080  memory: 11.85GiB(24.93%)  tps: 6,253  tflops: 47.62  mfu: 15.26%
[rank3]:2025-10-30 05:36:00,527 - INFO -  step: 1900  loss:  0.1708  grad_norm:  0.5080  memory: 18.19GiB(38.28%)  tps: 6,253  tflops: 47.63  mfu: 15.26%
[rank3]:2025-10-30 05:36:00,842 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_nofreeze_dm1/pipeline_schedule/251030_0536_real_step1900_rank3.svg
[rank3]:> Batch Time: 500.07 ms, GPU Bubble Ratio: 48.99%, 46.04%, 56.59%, 13.02%
[rank3]:2025-10-30 05:36:01,179 - INFO - Avg. fwd time: 6.3337 / Avg. bwd time: 21.0665 / Avg. batch time: 545.7269 (ms) / GPU bubble ratio: 19.67%
[rank0]:2025-10-30 05:36:01,256 - INFO - Avg. fwd time: 4.0997 / Avg. bwd time: 12.0052 / Avg. batch time: 631.6469 (ms) / GPU bubble ratio: 59.21%
[rank2]:2025-10-30 05:36:01,236 - INFO - Avg. fwd time: 3.8337 / Avg. bwd time: 9.7695 / Avg. batch time: 579.7094 (ms) / GPU bubble ratio: 62.46%
[rank1]:2025-10-30 05:36:01,332 - INFO - Avg. fwd time: 4.7907 / Avg. bwd time: 12.1257 / Avg. batch time: 608.7535 (ms) / GPU bubble ratio: 55.54%
[rank0]:2025-10-30 05:37:05,163 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-30 05:37:06,478 - INFO -  step: 1950  loss: -2.0000  grad_norm:  0.3886  memory: 11.85GiB(24.93%)  tps: 6,210  tflops: 47.30  mfu: 15.16%
[rank3]:2025-10-30 05:37:06,487 - INFO -  step: 1950  loss:  0.1561  grad_norm:  0.3886  memory: 18.19GiB(38.28%)  tps: 6,210  tflops: 47.30  mfu: 15.16%
[rank2]:2025-10-30 05:37:06,475 - INFO -  step: 1950  loss: -2.0000  grad_norm:  0.3886  memory:  8.13GiB(17.12%)  tps: 6,210  tflops: 47.30  mfu: 15.16%
[rank0]:2025-10-30 05:37:06,489 - INFO -  step: 1950  loss: -2.0000  grad_norm:  0.3886  memory: 14.71GiB(30.97%)  tps: 6,210  tflops: 47.30  mfu: 15.16%
[rank0]:2025-10-30 05:38:10,826 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-30 05:38:12,167 - INFO -  step: 2000  loss: -2.0000  grad_norm:  0.7909  memory: 11.85GiB(24.93%)  tps: 6,236  tflops: 47.49  mfu: 15.22%
[rank1]:2025-10-30 05:38:12,167 - INFO - ðŸ”Ž  Running validation at step 2000
[rank3]:2025-10-30 05:38:12,176 - INFO -  step: 2000  loss:  0.1926  grad_norm:  0.7909  memory: 18.19GiB(38.28%)  tps: 6,236  tflops: 47.49  mfu: 15.22%
[rank3]:2025-10-30 05:38:12,177 - INFO - ðŸ”Ž  Running validation at step 2000
[rank2]:2025-10-30 05:38:12,163 - INFO -  step: 2000  loss: -2.0000  grad_norm:  0.7909  memory:  8.13GiB(17.12%)  tps: 6,236  tflops: 47.49  mfu: 15.22%
[rank2]:2025-10-30 05:38:12,163 - INFO - ðŸ”Ž  Running validation at step 2000
[rank0]:2025-10-30 05:38:12,178 - INFO -  step: 2000  loss: -2.0000  grad_norm:  0.7909  memory: 14.71GiB(30.97%)  tps: 6,235  tflops: 47.49  mfu: 15.22%
[rank0]:2025-10-30 05:38:12,178 - INFO - ðŸ”Ž  Running validation at step 2000
[rank0]:2025-10-30 05:38:37,252 - INFO - validate step: 2000  loss: -1.0000  memory: 14.71GiB(30.97%)  tps: 16,336
[rank1]:2025-10-30 05:38:37,258 - INFO - validate step: 2000  loss: -1.0000  memory: 11.85GiB(24.93%)  tps: 16,325
[rank3]:2025-10-30 05:38:37,271 - INFO - validate step: 2000  loss:  0.9808  memory: 18.19GiB(38.28%)  tps: 16,323
[rank2]:2025-10-30 05:38:37,272 - INFO - validate step: 2000  loss: -1.0000  memory:  8.13GiB(17.12%)  tps: 16,314
[rank3]:2025-10-30 05:38:37,590 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_nofreeze_dm1/pipeline_schedule/251030_0538_real_step2000_rank3.svg
[rank3]:> Batch Time: 500.12 ms, GPU Bubble Ratio: 48.99%, 46.05%, 56.59%, 13.02%
[rank3]:2025-10-30 05:38:37,930 - INFO - Avg. fwd time: 6.3338 / Avg. bwd time: 21.0670 / Avg. batch time: 545.7224 (ms) / GPU bubble ratio: 19.66%
[rank2]:2025-10-30 05:38:37,986 - INFO - Avg. fwd time: 3.8337 / Avg. bwd time: 9.7698 / Avg. batch time: 579.7019 (ms) / GPU bubble ratio: 62.45%
[rank0]:2025-10-30 05:38:38,007 - INFO - Avg. fwd time: 4.0995 / Avg. bwd time: 12.0057 / Avg. batch time: 631.6288 (ms) / GPU bubble ratio: 59.20%
[rank1]:2025-10-30 05:38:38,082 - INFO - Avg. fwd time: 4.7907 / Avg. bwd time: 12.1248 / Avg. batch time: 608.7408 (ms) / GPU bubble ratio: 55.54%
[rank0]:2025-10-30 05:39:41,822 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-30 05:39:43,140 - INFO -  step: 2050  loss: -2.0000  grad_norm:  0.5753  memory: 14.71GiB(30.97%)  tps: 6,217  tflops: 47.35  mfu: 15.18%
[rank3]:2025-10-30 05:39:43,138 - INFO -  step: 2050  loss:  0.1746  grad_norm:  0.5753  memory: 18.19GiB(38.28%)  tps: 6,219  tflops: 47.36  mfu: 15.18%
[rank1]:2025-10-30 05:39:43,129 - INFO -  step: 2050  loss: -2.0000  grad_norm:  0.5753  memory: 11.85GiB(24.93%)  tps: 6,218  tflops: 47.36  mfu: 15.18%
[rank2]:2025-10-30 05:39:43,125 - INFO -  step: 2050  loss: -2.0000  grad_norm:  0.5753  memory:  8.13GiB(17.12%)  tps: 6,220  tflops: 47.37  mfu: 15.18%
[rank0]:2025-10-30 05:40:47,511 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-30 05:40:48,840 - INFO -  step: 2100  loss: -2.0000  grad_norm:  0.6177  memory: 14.71GiB(30.97%)  tps: 6,234  tflops: 47.48  mfu: 15.22%
[rank1]:2025-10-30 05:40:48,829 - INFO -  step: 2100  loss: -2.0000  grad_norm:  0.6177  memory: 11.85GiB(24.93%)  tps: 6,234  tflops: 47.48  mfu: 15.22%
[rank3]:2025-10-30 05:40:48,838 - INFO -  step: 2100  loss:  0.1992  grad_norm:  0.6177  memory: 18.19GiB(38.28%)  tps: 6,235  tflops: 47.48  mfu: 15.22%
[rank2]:2025-10-30 05:40:48,825 - INFO -  step: 2100  loss: -2.0000  grad_norm:  0.6177  memory:  8.13GiB(17.12%)  tps: 6,234  tflops: 47.48  mfu: 15.22%
[rank3]:2025-10-30 05:40:49,157 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_nofreeze_dm1/pipeline_schedule/251030_0540_real_step2100_rank3.svg
[rank3]:> Batch Time: 500.12 ms, GPU Bubble Ratio: 48.99%, 46.05%, 56.59%, 13.02%
[rank3]:2025-10-30 05:40:49,734 - INFO - Avg. fwd time: 6.3338 / Avg. bwd time: 21.0683 / Avg. batch time: 545.7307 (ms) / GPU bubble ratio: 19.66%
[rank2]:2025-10-30 05:40:49,760 - INFO - Avg. fwd time: 3.8338 / Avg. bwd time: 9.7703 / Avg. batch time: 579.7666 (ms) / GPU bubble ratio: 62.46%
[rank0]:2025-10-30 05:40:49,817 - INFO - Avg. fwd time: 4.0994 / Avg. bwd time: 12.0062 / Avg. batch time: 631.6895 (ms) / GPU bubble ratio: 59.21%
[rank1]:2025-10-30 05:40:49,788 - INFO - Avg. fwd time: 4.7907 / Avg. bwd time: 12.1239 / Avg. batch time: 608.8027 (ms) / GPU bubble ratio: 55.55%
[rank0]:2025-10-30 05:41:53,514 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-30 05:41:54,854 - INFO -  step: 2150  loss: -2.0000  grad_norm:  0.5117  memory: 14.71GiB(30.97%)  tps: 6,205  tflops: 47.26  mfu: 15.15%
[rank1]:2025-10-30 05:41:54,843 - INFO -  step: 2150  loss: -2.0000  grad_norm:  0.5117  memory: 11.85GiB(24.93%)  tps: 6,205  tflops: 47.26  mfu: 15.15%
[rank3]:2025-10-30 05:41:54,853 - INFO -  step: 2150  loss:  0.1770  grad_norm:  0.5117  memory: 18.19GiB(38.28%)  tps: 6,205  tflops: 47.26  mfu: 15.15%
[rank2]:2025-10-30 05:41:54,840 - INFO -  step: 2150  loss: -2.0000  grad_norm:  0.5117  memory:  8.13GiB(17.12%)  tps: 6,205  tflops: 47.26  mfu: 15.15%
[rank0]:2025-10-30 05:42:59,092 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-30 05:43:00,425 - INFO -  step: 2200  loss: -2.0000  grad_norm:  0.7603  memory: 14.71GiB(30.97%)  tps: 6,247  tflops: 47.58  mfu: 15.25%
[rank0]:2025-10-30 05:43:00,425 - INFO - ðŸ”Ž  Running validation at step 2200
[rank1]:2025-10-30 05:43:00,415 - INFO -  step: 2200  loss: -2.0000  grad_norm:  0.7603  memory: 11.85GiB(24.93%)  tps: 6,247  tflops: 47.58  mfu: 15.25%
[rank1]:2025-10-30 05:43:00,415 - INFO - ðŸ”Ž  Running validation at step 2200
[rank3]:2025-10-30 05:43:00,423 - INFO -  step: 2200  loss:  0.2028  grad_norm:  0.7603  memory: 18.19GiB(38.28%)  tps: 6,247  tflops: 47.58  mfu: 15.25%
[rank3]:2025-10-30 05:43:00,423 - INFO - ðŸ”Ž  Running validation at step 2200
[rank2]:2025-10-30 05:43:00,411 - INFO -  step: 2200  loss: -2.0000  grad_norm:  0.7603  memory:  8.13GiB(17.12%)  tps: 6,247  tflops: 47.58  mfu: 15.25%
[rank2]:2025-10-30 05:43:00,411 - INFO - ðŸ”Ž  Running validation at step 2200
[rank0]:2025-10-30 05:43:25,422 - INFO - validate step: 2200  loss: -1.0000  memory: 14.71GiB(30.97%)  tps: 16,386
[rank1]:2025-10-30 05:43:25,428 - INFO - validate step: 2200  loss: -1.0000  memory: 11.85GiB(24.93%)  tps: 16,375
[rank3]:2025-10-30 05:43:25,441 - INFO - validate step: 2200  loss:  0.9823  memory: 18.19GiB(38.28%)  tps: 16,373
[rank2]:2025-10-30 05:43:25,441 - INFO - validate step: 2200  loss: -1.0000  memory:  8.13GiB(17.12%)  tps: 16,365
[rank3]:2025-10-30 05:43:25,758 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_nofreeze_dm1/pipeline_schedule/251030_0543_real_step2200_rank3.svg
[rank3]:> Batch Time: 500.13 ms, GPU Bubble Ratio: 48.99%, 46.05%, 56.59%, 13.01%
[rank0]:2025-10-30 05:43:26,175 - INFO - Avg. fwd time: 4.0996 / Avg. bwd time: 12.0071 / Avg. batch time: 631.6148 (ms) / GPU bubble ratio: 59.20%
[rank3]:2025-10-30 05:43:26,098 - INFO - Avg. fwd time: 6.3337 / Avg. bwd time: 21.0693 / Avg. batch time: 545.7341 (ms) / GPU bubble ratio: 19.66%
[rank2]:2025-10-30 05:43:26,154 - INFO - Avg. fwd time: 3.8339 / Avg. bwd time: 9.7708 / Avg. batch time: 579.6973 (ms) / GPU bubble ratio: 62.45%
[rank1]:2025-10-30 05:43:26,252 - INFO - Avg. fwd time: 4.7911 / Avg. bwd time: 12.1241 / Avg. batch time: 608.7311 (ms) / GPU bubble ratio: 55.54%
[rank0]:2025-10-30 05:44:30,111 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-30 05:44:31,431 - INFO -  step: 2250  loss: -2.0000  grad_norm:  0.7391  memory: 14.71GiB(30.97%)  tps: 6,205  tflops: 47.26  mfu: 15.15%
[rank1]:2025-10-30 05:44:31,421 - INFO -  step: 2250  loss: -2.0000  grad_norm:  0.7391  memory: 11.85GiB(24.93%)  tps: 6,207  tflops: 47.27  mfu: 15.15%
[rank3]:2025-10-30 05:44:31,433 - INFO -  step: 2250  loss:  0.1937  grad_norm:  0.7391  memory: 18.19GiB(38.28%)  tps: 6,207  tflops: 47.27  mfu: 15.15%
[rank2]:2025-10-30 05:44:31,417 - INFO -  step: 2250  loss: -2.0000  grad_norm:  0.7391  memory:  8.13GiB(17.12%)  tps: 6,208  tflops: 47.28  mfu: 15.16%
[rank0]:2025-10-30 05:45:35,744 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-30 05:45:37,061 - INFO -  step: 2300  loss: -2.0000  grad_norm:  0.5146  memory: 11.85GiB(24.93%)  tps: 6,240  tflops: 47.53  mfu: 15.23%
[rank3]:2025-10-30 05:45:37,071 - INFO -  step: 2300  loss:  0.1870  grad_norm:  0.5146  memory: 18.19GiB(38.28%)  tps: 6,240  tflops: 47.53  mfu: 15.23%
[rank2]:2025-10-30 05:45:37,057 - INFO -  step: 2300  loss: -2.0000  grad_norm:  0.5146  memory:  8.13GiB(17.12%)  tps: 6,240  tflops: 47.53  mfu: 15.23%
[rank0]:2025-10-30 05:45:37,072 - INFO -  step: 2300  loss: -2.0000  grad_norm:  0.5146  memory: 14.71GiB(30.97%)  tps: 6,240  tflops: 47.53  mfu: 15.23%
[rank3]:2025-10-30 05:45:37,396 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_nofreeze_dm1/pipeline_schedule/251030_0545_real_step2300_rank3.svg
[rank3]:> Batch Time: 500.13 ms, GPU Bubble Ratio: 48.99%, 46.05%, 56.59%, 13.01%
[rank3]:2025-10-30 05:45:37,738 - INFO - Avg. fwd time: 6.3335 / Avg. bwd time: 21.0701 / Avg. batch time: 545.7334 (ms) / GPU bubble ratio: 19.66%
[rank0]:2025-10-30 05:45:37,815 - INFO - Avg. fwd time: 4.0996 / Avg. bwd time: 12.0079 / Avg. batch time: 631.5961 (ms) / GPU bubble ratio: 59.20%
[rank2]:2025-10-30 05:45:37,795 - INFO - Avg. fwd time: 3.8339 / Avg. bwd time: 9.7712 / Avg. batch time: 579.6855 (ms) / GPU bubble ratio: 62.45%
[rank1]:2025-10-30 05:45:37,893 - INFO - Avg. fwd time: 4.7914 / Avg. bwd time: 12.1238 / Avg. batch time: 608.7153 (ms) / GPU bubble ratio: 55.54%
[rank0]:2025-10-30 05:46:41,649 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-30 05:46:42,965 - INFO -  step: 2350  loss: -2.0000  grad_norm:  0.3926  memory: 11.85GiB(24.93%)  tps: 6,215  tflops: 47.34  mfu: 15.17%
[rank2]:2025-10-30 05:46:42,961 - INFO -  step: 2350  loss: -2.0000  grad_norm:  0.3926  memory:  8.13GiB(17.12%)  tps: 6,215  tflops: 47.34  mfu: 15.17%
[rank0]:2025-10-30 05:46:42,976 - INFO -  step: 2350  loss: -2.0000  grad_norm:  0.3926  memory: 14.71GiB(30.97%)  tps: 6,215  tflops: 47.34  mfu: 15.17%
[rank3]:2025-10-30 05:46:42,974 - INFO -  step: 2350  loss:  0.1754  grad_norm:  0.3926  memory: 18.19GiB(38.28%)  tps: 6,215  tflops: 47.34  mfu: 15.17%
[rank0]:2025-10-30 05:47:47,245 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-30 05:47:48,589 - INFO -  step: 2400  loss: -2.0000  grad_norm:  0.7079  memory: 14.71GiB(30.97%)  tps: 6,243  tflops: 47.55  mfu: 15.24%
[rank0]:2025-10-30 05:47:48,589 - INFO -  final step: 2400  loss: -2.0000  grad_norm:  0.7079  tps: 6,310  tflops: 48.06  mfu: 14.87%
[rank0]:2025-10-30 05:47:48,589 - INFO - ðŸ”Ž  Running validation at step 2400
[rank3]:2025-10-30 05:47:48,586 - INFO -  step: 2400  loss:  0.1963  grad_norm:  0.7079  memory: 18.19GiB(38.28%)  tps: 6,243  tflops: 47.55  mfu: 15.24%
[rank3]:2025-10-30 05:47:48,587 - INFO -  final step: 2400  loss:  0.1963  grad_norm:  0.7079  tps: 6,314  tflops: 48.09  mfu: 14.88%
[rank3]:2025-10-30 05:47:48,587 - INFO - ðŸ”Ž  Running validation at step 2400
[rank1]:2025-10-30 05:47:48,578 - INFO -  step: 2400  loss: -2.0000  grad_norm:  0.7079  memory: 11.85GiB(24.93%)  tps: 6,243  tflops: 47.55  mfu: 15.24%
[rank1]:2025-10-30 05:47:48,578 - INFO -  final step: 2400  loss: -2.0000  grad_norm:  0.7079  tps: 6,311  tflops: 48.06  mfu: 14.87%
[rank1]:2025-10-30 05:47:48,578 - INFO - ðŸ”Ž  Running validation at step 2400
[rank2]:2025-10-30 05:47:48,574 - INFO -  step: 2400  loss: -2.0000  grad_norm:  0.7079  memory:  8.13GiB(17.12%)  tps: 6,243  tflops: 47.55  mfu: 15.24%
[rank2]:2025-10-30 05:47:48,574 - INFO -  final step: 2400  loss: -2.0000  grad_norm:  0.7079  tps: 6,310  tflops: 48.06  mfu: 14.87%
[rank2]:2025-10-30 05:47:48,574 - INFO - ðŸ”Ž  Running validation at step 2400
[rank0]:2025-10-30 05:48:13,598 - INFO - validate step: 2400  loss: -1.0000  memory: 14.71GiB(30.97%)  tps: 16,378
[rank0]:2025-10-30 05:48:13,599 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-30 05:48:13,601 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank1]:2025-10-30 05:48:13,605 - INFO - validate step: 2400  loss: -1.0000  memory: 11.85GiB(24.93%)  tps: 16,367
[rank1]:2025-10-30 05:48:13,606 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-30 05:48:13,608 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank3]:2025-10-30 05:48:13,617 - INFO - validate step: 2400  loss:  0.9812  memory: 18.19GiB(38.28%)  tps: 16,365
[rank3]:2025-10-30 05:48:13,618 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-30 05:48:13,620 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank2]:2025-10-30 05:48:13,618 - INFO - validate step: 2400  loss: -1.0000  memory:  8.13GiB(17.12%)  tps: 16,356
[rank2]:2025-10-30 05:48:13,618 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-30 05:48:13,620 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank0]:2025-10-30 05:48:16,126 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank0]:2025-10-30 05:48:16,144 - INFO - Sleeping 2 seconds for other ranks to complete
[rank1]:2025-10-30 05:48:16,144 - INFO - Destroying the purge thread.
[rank2]:2025-10-30 05:48:16,144 - INFO - Destroying the purge thread.
[rank1]:2025-10-30 05:48:16,215 - INFO - Process group destroyed
[rank2]:2025-10-30 05:48:16,242 - INFO - Process group destroyed
[rank3]:2025-10-30 05:48:16,458 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_nofreeze_dm1/pipeline_schedule/251030_0548_real_final2400_rank3.svg
[rank3]:> Batch Time: 500.12 ms, GPU Bubble Ratio: 48.99%, 46.05%, 56.59%, 13.01%
[rank3]:2025-10-30 05:48:16,765 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_nofreeze_dm1/pipeline_schedule/251030_0548_thry_final2400_rank3.svg
[rank3]:> Batch Time: 270.57 ms, GPU Bubble Ratio: 15.79%, 15.79%, 15.79%, 15.79%
[rank3]:2025-10-30 05:48:16,766 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading history steps 48-48, summary, console lines 356-363
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–„â–†â–ƒâ–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–ˆâ–…â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–ˆâ–…â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 1.29738
[rank3]:wandb:               final/avg_loss 0.19635
[rank3]:wandb:             final/avg_mfu(%) 14.87635
[rank3]:wandb:             final/avg_tflops 48.09087
[rank3]:wandb:    final/avg_throughput(tps) 6314.27625
[rank3]:wandb:              final/grad_norm 0.70794
[rank3]:wandb:               final/max_loss 0.19635
[rank3]:wandb:                    grad_norm 0.70794
[rank3]:wandb: loss_metrics/global_avg_loss 0.19635
[rank3]:wandb: loss_metrics/global_max_loss 0.19635
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1029_Interleaved1F1B_nofreeze_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/vyzk2nyy
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1029_Interleaved1F1B_nofreeze_dm1/20251030-0450/wandb/run-20251030_045009-vyzk2nyy/logs
[rank0]:2025-10-30 05:48:18,144 - INFO - Training completed
[rank0]:2025-10-30 05:48:18,145 - INFO - Destroying the purge thread.
[rank3]:2025-10-30 05:48:18,203 - INFO - Process group destroyed
[rank0]:2025-10-30 05:48:18,385 - INFO - Process group destroyed
[rank2]:Stage 2: Modules to keep: {'layers.6', 'layers.5'}
[rank2]:Stage 6: Modules to keep: {'layers.14', 'layers.13'}
[rank1]:Stage 1: Modules to keep: {'layers.3', 'layers.2', 'layers.4'}
[rank1]:Stage 5: Modules to keep: {'layers.12', 'layers.11'}
[rank0]:Stage 0: Modules to keep: {'tok_embeddings', 'layers.1', 'layers.0'}
[rank0]:Stage 4: Modules to keep: {'layers.10', 'layers.9'}
[rank3]:Stage 3: Modules to keep: {'layers.8', 'layers.7'}
[rank3]:Stage 7: Modules to keep: {'norm', 'output', 'layers.15'}
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : [rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1029_llama1b/config.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1029_Interleaved1F1B_nofreeze_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1029_Interleaved1F1B_nofreeze_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1029_Interleaved1F1B_nofreeze_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1029_Interleaved1F1B_nofreeze_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_nofreeze_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1029_Interleaved1F1B_nofreeze_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B-Instruct
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 1e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: alpaca
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 512
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 2400
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: Interleaved1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 4
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 2
[rank3]:		- stages_list: [3, 7]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1029_Interleaved1F1B_nofreeze_dm1
[rank3]:		- interval: 800
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B-Instruct/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1029_Interleaved1F1B_nofreeze_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: True
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: False
[rank3]:		- metric_type: apf
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- aggressiveness: 0
[rank3]:
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:3
