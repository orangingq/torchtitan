
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 10. 31. (ê¸ˆ) 03:15:34 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 3,4,5,6
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1029_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1029_llama1b/1030_GPipe_auto.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
+ more freezing in autofreeze mode. (self.percentile = getattr(config.freezing, percentile, 50->70))
âœ”ï¸Running with auto x GPipe ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1029_llama1b/config.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
+ more freezing in autofreeze mode. (self.percentile = getattr(config.freezing, percentile, 50->70))" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=auto
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank1]:2025-10-31 03:15:40,809 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
[rank1]:+ more freezing in autofreeze mode. (self.percentile = getattr(config.freezing, percentile, 50->70))"
[rank3]:2025-10-31 03:15:40,810 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
[rank3]:+ more freezing in autofreeze mode. (self.percentile = getattr(config.freezing, percentile, 50->70))"
[rank0]:2025-10-31 03:15:40,921 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
[rank0]:+ more freezing in autofreeze mode. (self.percentile = getattr(config.freezing, percentile, 50->70))"
[rank2]:2025-10-31 03:15:41,012 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
[rank2]:+ more freezing in autofreeze mode. (self.percentile = getattr(config.freezing, percentile, 50->70))"
[rank0]:2025-10-31 03:15:41,510 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-10-31 03:15:41,512 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-31 03:15:41,516 - INFO - [GC] Initial GC collection 0.00 seconds
[rank1]:2025-10-31 03:15:41,493 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-10-31 03:15:41,495 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-10-31 03:15:41,525 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-10-31 03:15:41,541 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-10-31 03:15:41,544 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-10-31 03:15:41,527 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-31 03:15:41,955 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-10-31 03:15:42,351 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank0]:2025-10-31 03:15:45,420 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=512, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank0]:2025-10-31 03:15:45,566 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-10-31 03:15:45,610 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-10-31 03:15:45,611 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank1]:2025-10-31 03:15:45,583 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-10-31 03:15:45,625 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-10-31 03:15:45,638 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-10-31 03:15:45,638 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2025-10-31 03:15:45,653 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-10-31 03:15:45,653 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-10-31 03:15:45,821 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-10-31 03:15:45,822 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-10-31 03:15:45,830 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank1]:2025-10-31 03:15:45,830 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-10-31 03:15:45,830 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-10-31 03:15:45,831 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank2]:2025-10-31 03:15:46,181 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-10-31 03:15:46,221 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-10-31 03:15:46,246 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-10-31 03:15:46,247 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank2]:2025-10-31 03:15:46,896 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-10-31 03:15:46,896 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-10-31 03:15:46,896 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run 0gjamkjj
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1030_GPipe_auto_dm1/20251031-0315/wandb/run-20251031_031547-0gjamkjj
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1030_GPipe_auto_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/0gjamkjj
[rank3]:2025-10-31 03:15:48,234 - INFO - WandB logging enabled
[rank3]:2025-10-31 03:15:48,466 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-10-31 03:15:48,504 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-10-31 03:15:48,533 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-10-31 03:15:48,533 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-10-31 03:15:48,731 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1030_GPipe_auto_dm1
[rank0]:2025-10-31 03:15:48,731 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-10-31 03:15:48,732 - INFO - Preparing c4_validation dataset from allenai/c4
[rank1]:2025-10-31 03:15:48,731 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank2]:2025-10-31 03:15:48,731 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-10-31 03:15:48,715 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-10-31 03:15:48,716 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-10-31 03:15:48,717 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2025-10-31 03:15:48,731 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-10-31 03:15:53,473 - INFO - Trainer is initialized with local batch size 32, global batch size 64, gradient accumulation steps 2, sequence length 512, total steps 2400 (warmup 100)
[rank0]:2025-10-31 03:15:53,474 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B-Instruct/original_dcp.
[rank0]:2025-10-31 03:15:57,032 - INFO - [GC] GC collection for checkpoint loading. 0.01 seconds
[rank0]:2025-10-31 03:15:57,032 - INFO - Finished loading the checkpoint in 3.56 seconds.
[rank0]:2025-10-31 03:15:57,032 - INFO - Training starts at step 1
[rank3]:2025-10-31 03:16:00,186 - INFO -  step:  1  loss:  9.0164  grad_norm: 85.2043  memory: 23.19GiB(48.82%)  tps: 701  tflops: 5.34  mfu: 1.71%
[rank3]:2025-10-31 03:16:00,187 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-10-31 03:16:00,220 - INFO -  step:  1  loss: -2.0000  grad_norm: 85.2043  memory: 12.28GiB(25.84%)  tps: 561  tflops: 4.27  mfu: 1.37%
[rank0]:2025-10-31 03:16:00,220 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-10-31 03:16:00,176 - INFO -  step:  1  loss: -2.0000  grad_norm: 85.2043  memory:  9.35GiB(19.67%)  tps: 587  tflops: 4.47  mfu: 1.43%
[rank2]:2025-10-31 03:16:00,176 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-10-31 03:16:00,179 - INFO -  step:  1  loss: -2.0000  grad_norm: 85.2043  memory: 11.50GiB(24.20%)  tps: 563  tflops: 4.29  mfu: 1.37%
[rank1]:2025-10-31 03:16:00,179 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-31 03:16:18,341 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-31 03:16:18,342 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-31 03:16:18,343 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-31 03:16:18,343 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-31 03:16:18,343 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-31 03:16:18,344 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-31 03:16:18,344 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-31 03:16:18,344 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-31 03:16:18,345 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-31 03:16:18,345 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-31 03:16:18,345 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-31 03:16:18,346 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-31 03:16:18,346 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-31 03:16:18,346 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-31 03:16:18,346 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-31 03:16:18,347 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-31 03:16:18,368 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-31 03:16:18,369 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-31 03:16:18,369 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-31 03:16:18,369 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-31 03:16:18,369 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-31 03:16:18,369 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-31 03:16:18,369 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-31 03:16:18,369 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-31 03:16:18,369 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-31 03:16:18,369 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-31 03:16:18,369 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-31 03:16:18,369 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-31 03:16:18,370 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-31 03:16:18,370 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-31 03:16:18,370 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-31 03:16:18,370 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-31 03:16:18,425 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-31 03:16:18,425 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-31 03:16:18,425 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-31 03:16:18,425 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-31 03:16:18,425 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-31 03:16:18,425 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-31 03:16:18,425 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-31 03:16:18,426 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-31 03:16:18,426 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-31 03:16:18,426 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-31 03:16:18,426 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-31 03:16:18,426 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-31 03:16:18,426 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-31 03:16:18,426 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-31 03:16:18,426 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-31 03:16:18,426 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-31 03:16:18,396 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-31 03:16:18,397 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-31 03:16:18,397 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-31 03:16:18,397 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-31 03:16:18,397 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-31 03:16:18,397 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-31 03:16:18,397 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-31 03:16:18,397 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-31 03:16:18,397 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-31 03:16:18,397 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-31 03:16:18,397 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-31 03:16:18,398 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-31 03:16:18,398 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-31 03:16:18,398 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-31 03:16:18,398 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-31 03:16:18,398 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-31 03:16:59,647 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-31 03:17:00,903 - INFO -  step: 50  loss:  8.4869  grad_norm: 35.3775  memory: 27.51GiB(57.90%)  tps: 6,611  tflops: 50.35  mfu: 16.14%
[rank1]:2025-10-31 03:17:00,895 - INFO -  step: 50  loss: -2.0000  grad_norm: 35.3775  memory: 14.64GiB(30.82%)  tps: 6,611  tflops: 50.35  mfu: 16.14%
[rank2]:2025-10-31 03:17:00,891 - INFO -  step: 50  loss: -2.0000  grad_norm: 35.3775  memory: 11.81GiB(24.85%)  tps: 6,611  tflops: 50.35  mfu: 16.14%
[rank0]:2025-10-31 03:17:00,907 - INFO -  step: 50  loss: -2.0000  grad_norm: 35.3775  memory: 16.57GiB(34.88%)  tps: 6,614  tflops: 50.38  mfu: 16.15%
[rank2]:2025-10-31 03:17:13,245 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 0.0000e+00
[rank3]:2025-10-31 03:17:13,257 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 0.0000e+00
[rank1]:2025-10-31 03:17:13,249 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 0.0000e+00
[rank0]:2025-10-31 03:17:13,262 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 0.0000e+00
[rank2]:2025-10-31 03:17:25,663 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.2789e+00
[rank3]:2025-10-31 03:17:25,675 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 3.3088e+00
[rank1]:2025-10-31 03:17:25,667 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 8.7029e-01
[rank0]:2025-10-31 03:17:25,679 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 1.5709e+00
[rank3]:2025-10-31 03:17:37,429 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.0627e+00
[rank1]:2025-10-31 03:17:37,430 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 3.2375e+00
[rank2]:2025-10-31 03:17:37,414 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.5818e+00
[rank0]:2025-10-31 03:17:37,442 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 3.4089e+00
[rank3]:2025-10-31 03:17:49,923 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 3.7794e+00
[rank1]:2025-10-31 03:17:49,915 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.1953e+00
[rank2]:2025-10-31 03:17:49,911 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.5238e-01
[rank0]:2025-10-31 03:17:49,927 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 2.5092e+01
[rank0]:2025-10-31 03:17:59,906 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-31 03:18:01,038 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 3.0834e+00
[rank3]:2025-10-31 03:18:01,041 - INFO -  step: 100  loss:  6.2547  grad_norm: 62.0668  memory: 28.00GiB(58.93%)  tps: 6,811  tflops: 51.88  mfu: 16.63%
[rank1]:2025-10-31 03:18:01,026 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.9003e+00
[rank1]:2025-10-31 03:18:01,027 - INFO -  step: 100  loss: -2.0000  grad_norm: 62.0668  memory: 14.66GiB(30.86%)  tps: 6,812  tflops: 51.88  mfu: 16.63%
[rank2]:2025-10-31 03:18:01,022 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.6628e+00
[rank2]:2025-10-31 03:18:01,023 - INFO -  step: 100  loss: -2.0000  grad_norm: 62.0668  memory: 11.83GiB(24.89%)  tps: 6,812  tflops: 51.88  mfu: 16.63%
[rank0]:2025-10-31 03:18:01,046 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 2.1737e+00
[rank0]:2025-10-31 03:18:01,046 - INFO -  step: 100  loss: -2.0000  grad_norm: 62.0668  memory: 16.57GiB(34.88%)  tps: 6,811  tflops: 51.87  mfu: 16.63%
[rank1]:2025-10-31 03:18:01,127 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank1/251031_0318_stage1_step100.svg
[rank2]:2025-10-31 03:18:01,128 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank2/251031_0318_stage2_step100.svg
[rank0]:2025-10-31 03:18:01,129 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank0/251031_0318_stage0_step100.svg
[rank3]:2025-10-31 03:18:01,248 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/pipeline_schedule/251031_0318_real_step100_rank3.svg
[rank3]:> Batch Time: 514.42 ms, GPU Bubble Ratio: 51.74%, 50.06%, 61.29%, 18.35%
[rank3]:2025-10-31 03:18:01,315 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank3/251031_0318_stage3_step100.svg
[rank3]:2025-10-31 03:18:01,617 - INFO - Avg. fwd time: 10.6196 / Avg. bwd time: 41.6848 / Avg. batch time: 487.8287 (ms) / GPU bubble ratio: 14.23%
[rank2]:2025-10-31 03:18:01,687 - INFO - Avg. fwd time: 6.9644 / Avg. bwd time: 17.2169 / Avg. batch time: 518.7963 (ms) / GPU bubble ratio: 62.71%
[rank1]:2025-10-31 03:18:01,725 - INFO - Avg. fwd time: 9.2848 / Avg. bwd time: 23.3138 / Avg. batch time: 556.7446 (ms) / GPU bubble ratio: 53.16%
[rank0]:2025-10-31 03:18:01,732 - INFO - Avg. fwd time: 8.4390 / Avg. bwd time: 23.3578 / Avg. batch time: 593.2453 (ms) / GPU bubble ratio: 57.12%
[rank3]:2025-10-31 03:18:13,768 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.9063e+00
[rank1]:2025-10-31 03:18:13,763 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 2.9269e+00
[rank2]:2025-10-31 03:18:13,756 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.1121e-01
[rank0]:2025-10-31 03:18:13,772 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 4.7005e+00
[rank3]:2025-10-31 03:18:24,923 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.1888e+00
[rank2]:2025-10-31 03:18:24,907 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.1201e+01
[rank1]:2025-10-31 03:18:24,911 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.9795e+00
[rank0]:2025-10-31 03:18:24,930 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 4.4188e+00
[rank3]:2025-10-31 03:18:37,318 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.2706e+00
[rank2]:2025-10-31 03:18:37,295 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.4475e+00
[rank1]:2025-10-31 03:18:37,311 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 8.8230e-01
[rank0]:2025-10-31 03:18:37,323 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 6.8355e+00
[rank3]:2025-10-31 03:18:48,437 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.1193e+00
[rank2]:2025-10-31 03:18:48,421 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.8101e+00
[rank1]:2025-10-31 03:18:48,425 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.4798e+00
[rank0]:2025-10-31 03:18:48,445 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 3.4898e+00
[rank0]:2025-10-31 03:18:59,511 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-31 03:19:00,769 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.9101e+00
[rank3]:2025-10-31 03:19:00,774 - INFO -  step: 150  loss:  1.2216  grad_norm: 25.8032  memory: 28.00GiB(58.93%)  tps: 6,857  tflops: 52.23  mfu: 16.74%
[rank2]:2025-10-31 03:19:00,746 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.6158e+00
[rank2]:2025-10-31 03:19:00,746 - INFO -  step: 150  loss: -2.0000  grad_norm: 25.8032  memory: 11.83GiB(24.89%)  tps: 6,858  tflops: 52.23  mfu: 16.74%
[rank1]:2025-10-31 03:19:00,762 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 4.0275e+00
[rank1]:2025-10-31 03:19:00,762 - INFO -  step: 150  loss: -2.0000  grad_norm: 25.8032  memory: 14.66GiB(30.86%)  tps: 6,857  tflops: 52.22  mfu: 16.74%
[rank0]:2025-10-31 03:19:00,774 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.5566e+00
[rank0]:2025-10-31 03:19:00,774 - INFO -  step: 150  loss: -2.0000  grad_norm: 25.8032  memory: 16.57GiB(34.88%)  tps: 6,858  tflops: 52.23  mfu: 16.74%
[rank3]:2025-10-31 03:19:11,743 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 8.7789e+00
[rank1]:2025-10-31 03:19:11,731 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.1556e+01
[rank2]:2025-10-31 03:19:11,727 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 8.9260e+00
[rank0]:2025-10-31 03:19:11,743 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1431e+01
[rank1]:2025-10-31 03:19:23,544 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 2.4476e+00
[rank3]:2025-10-31 03:19:23,567 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.1585e+00
[rank2]:2025-10-31 03:19:23,543 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.1562e+00
[rank0]:2025-10-31 03:19:23,559 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 8.0814e-01
[rank1]:2025-10-31 03:19:34,483 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 7.6296e+00
[rank3]:2025-10-31 03:19:34,495 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 9.9074e+00
[rank2]:2025-10-31 03:19:34,479 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 9.1149e+00
[rank0]:2025-10-31 03:19:34,494 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 8.4216e+00
[rank1]:2025-10-31 03:19:45,373 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.5645e+01
[rank3]:2025-10-31 03:19:45,389 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.2484e+01
[rank2]:2025-10-31 03:19:45,373 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.3888e+01
[rank0]:2025-10-31 03:19:45,389 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.1208e+01
[rank0]:2025-10-31 03:19:55,184 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-31 03:19:56,291 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 5.7773e+00
[rank1]:2025-10-31 03:19:56,292 - INFO -  step: 200  loss: -2.0000  grad_norm:  0.5109  memory: 14.66GiB(30.86%)  tps: 7,376  tflops: 56.18  mfu: 18.01%
[rank1]:2025-10-31 03:19:56,292 - INFO - ðŸ”Ž  Running validation at step 200
[rank3]:2025-10-31 03:19:56,307 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 8.2938e+00
[rank3]:2025-10-31 03:19:56,310 - INFO -  step: 200  loss:  0.2901  grad_norm:  0.5109  memory: 28.00GiB(58.93%)  tps: 7,376  tflops: 56.17  mfu: 18.00%
[rank3]:2025-10-31 03:19:56,310 - INFO - ðŸ”Ž  Running validation at step 200
[rank2]:2025-10-31 03:19:56,291 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 7.6670e+00
[rank2]:2025-10-31 03:19:56,291 - INFO -  step: 200  loss: -2.0000  grad_norm:  0.5109  memory: 11.83GiB(24.89%)  tps: 7,374  tflops: 56.16  mfu: 18.00%
[rank2]:2025-10-31 03:19:56,291 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-10-31 03:19:56,306 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 4.1935e+00
[rank0]:2025-10-31 03:19:56,307 - INFO -  step: 200  loss: -2.0000  grad_norm:  0.5109  memory: 16.57GiB(34.88%)  tps: 7,376  tflops: 56.18  mfu: 18.01%
[rank0]:2025-10-31 03:19:56,307 - INFO - ðŸ”Ž  Running validation at step 200
[rank1]:2025-10-31 03:20:18,431 - INFO - validate step: 200  loss: -1.0000  memory: 14.66GiB(30.86%)  tps: 18,501
[rank3]:2025-10-31 03:20:18,441 - INFO - validate step: 200  loss:  0.9406  memory: 28.00GiB(58.93%)  tps: 18,508
[rank2]:2025-10-31 03:20:18,448 - INFO - validate step: 200  loss: -1.0000  memory: 11.83GiB(24.89%)  tps: 18,487
[rank0]:2025-10-31 03:20:18,413 - INFO - validate step: 200  loss: -1.0000  memory: 16.57GiB(34.88%)  tps: 18,528
[rank1]:2025-10-31 03:20:18,531 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank1/251031_0320_stage1_step200.svg
[rank2]:2025-10-31 03:20:18,527 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank2/251031_0320_stage2_step200.svg
[rank0]:2025-10-31 03:20:18,527 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank0/251031_0320_stage0_step200.svg
[rank3]:2025-10-31 03:20:18,637 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/pipeline_schedule/251031_0320_real_step200_rank3.svg
[rank3]:> Batch Time: 503.60 ms, GPU Bubble Ratio: 50.67%, 49.09%, 70.35%, 17.18%
[rank3]:2025-10-31 03:20:18,707 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank3/251031_0320_stage3_step200.svg
[rank3]:2025-10-31 03:20:18,938 - INFO - Avg. fwd time: 10.8825 / Avg. bwd time: 40.4937 / Avg. batch time: 475.0794 (ms) / GPU bubble ratio: 13.49%
[rank2]:2025-10-31 03:20:18,995 - INFO - Avg. fwd time: 7.4835 / Avg. bwd time: 14.0454 / Avg. batch time: 502.2176 (ms) / GPU bubble ratio: 65.71%
[rank1]:2025-10-31 03:20:19,048 - INFO - Avg. fwd time: 9.5914 / Avg. bwd time: 20.0668 / Avg. batch time: 536.7598 (ms) / GPU bubble ratio: 55.80%
[rank0]:2025-10-31 03:20:19,023 - INFO - Avg. fwd time: 8.4757 / Avg. bwd time: 21.2625 / Avg. batch time: 571.0501 (ms) / GPU bubble ratio: 58.34%
[rank1]:2025-10-31 03:20:29,571 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.6637e-01
[rank3]:2025-10-31 03:20:29,587 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 3.4921e-01
[rank2]:2025-10-31 03:20:29,571 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.6088e-01
[rank0]:2025-10-31 03:20:29,586 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 9.3052e-01
[rank1]:2025-10-31 03:20:40,473 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.0509e+00
[rank3]:2025-10-31 03:20:40,489 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.0807e+00
[rank2]:2025-10-31 03:20:40,473 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 8.8599e-01
[rank0]:2025-10-31 03:20:40,489 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.0683e+00
[rank1]:2025-10-31 03:20:51,353 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 5.6367e-01
[rank3]:2025-10-31 03:20:51,369 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 8.6501e-01
[rank2]:2025-10-31 03:20:51,353 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 9.2881e-01
[rank0]:2025-10-31 03:20:51,369 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 8.3650e-01
[rank2]:2025-10-31 03:21:02,249 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.0694e+00
[rank1]:2025-10-31 03:21:02,249 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 5.2857e-01
[rank3]:2025-10-31 03:21:02,265 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.9073e+00
[rank0]:2025-10-31 03:21:02,264 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 7.7854e-01
[rank0]:2025-10-31 03:21:12,050 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-31 03:21:13,140 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.0898e+00
[rank1]:2025-10-31 03:21:13,140 - INFO -  step: 250  loss: -2.0000  grad_norm:  0.3478  memory: 14.66GiB(30.86%)  tps: 7,487  tflops: 57.02  mfu: 18.28%
[rank3]:2025-10-31 03:21:13,155 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.6722e+00
[rank3]:2025-10-31 03:21:13,158 - INFO -  step: 250  loss:  0.2664  grad_norm:  0.3478  memory: 28.00GiB(58.93%)  tps: 7,486  tflops: 57.02  mfu: 18.27%
[rank2]:2025-10-31 03:21:13,140 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.0120e+00
[rank2]:2025-10-31 03:21:13,140 - INFO -  step: 250  loss: -2.0000  grad_norm:  0.3478  memory: 11.83GiB(24.89%)  tps: 7,489  tflops: 57.04  mfu: 18.28%
[rank0]:2025-10-31 03:21:13,155 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 7.1065e-01
[rank0]:2025-10-31 03:21:13,156 - INFO -  step: 250  loss: -2.0000  grad_norm:  0.3478  memory: 16.57GiB(34.88%)  tps: 7,482  tflops: 56.99  mfu: 18.27%
[rank1]:2025-10-31 03:21:24,041 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.0778e+00
[rank3]:2025-10-31 03:21:24,056 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 8.0560e-01
[rank2]:2025-10-31 03:21:24,041 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 9.3441e-01
[rank0]:2025-10-31 03:21:24,056 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.0668e+00
[rank1]:2025-10-31 03:21:34,919 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.3808e-01
[rank3]:2025-10-31 03:21:34,935 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 8.1024e-01
[rank2]:2025-10-31 03:21:34,919 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 9.4369e-01
[rank0]:2025-10-31 03:21:34,935 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 7.1277e-01
[rank2]:2025-10-31 03:21:45,807 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.1518e-01
[rank0]:2025-10-31 03:21:45,822 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.0570e+00
[rank1]:2025-10-31 03:21:45,807 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 3.3729e-01
[rank3]:2025-10-31 03:21:45,823 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.3866e+00
[rank2]:2025-10-31 03:21:56,731 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 7.5013e-01
[rank1]:2025-10-31 03:21:56,732 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 4.3502e-01
[rank3]:2025-10-31 03:21:56,747 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 6.8166e-01
[rank0]:2025-10-31 03:21:56,747 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 6.6826e-01
[rank0]:2025-10-31 03:22:06,544 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-31 03:22:07,625 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 7.8146e-01
[rank2]:2025-10-31 03:22:07,626 - INFO -  step: 300  loss: -2.0000  grad_norm:  0.3350  memory: 11.83GiB(24.89%)  tps: 7,518  tflops: 57.26  mfu: 18.35%
[rank0]:2025-10-31 03:22:07,641 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 6.8601e-01
[rank0]:2025-10-31 03:22:07,641 - INFO -  step: 300  loss: -2.0000  grad_norm:  0.3350  memory: 16.57GiB(34.88%)  tps: 7,518  tflops: 57.26  mfu: 18.35%
[rank1]:2025-10-31 03:22:07,625 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 3.9569e-01
[rank1]:2025-10-31 03:22:07,626 - INFO -  step: 300  loss: -2.0000  grad_norm:  0.3350  memory: 14.66GiB(30.86%)  tps: 7,518  tflops: 57.26  mfu: 18.35%
[rank1]:2025-10-31 03:22:07,722 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank1/251031_0322_stage1_step300.svg
[rank3]:2025-10-31 03:22:07,641 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 9.8979e-01
[rank3]:2025-10-31 03:22:07,644 - INFO -  step: 300  loss:  0.2306  grad_norm:  0.3350  memory: 28.00GiB(58.93%)  tps: 7,518  tflops: 57.26  mfu: 18.35%
[rank2]:2025-10-31 03:22:07,718 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank2/251031_0322_stage2_step300.svg
[rank0]:2025-10-31 03:22:07,719 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank0/251031_0322_stage0_step300.svg
[rank3]:2025-10-31 03:22:07,825 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/pipeline_schedule/251031_0322_real_step300_rank3.svg
[rank3]:> Batch Time: 474.77 ms, GPU Bubble Ratio: 51.10%, 56.61%, 68.55%, 16.07%
[rank3]:2025-10-31 03:22:07,893 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank3/251031_0322_stage3_step300.svg
[rank1]:2025-10-31 03:22:08,389 - INFO - Avg. fwd time: 9.9010 / Avg. bwd time: 17.6069 / Avg. batch time: 523.1760 (ms) / GPU bubble ratio: 57.94%
[rank3]:2025-10-31 03:22:08,355 - INFO - Avg. fwd time: 11.0597 / Avg. bwd time: 39.2845 / Avg. batch time: 465.2159 (ms) / GPU bubble ratio: 13.43%
[rank2]:2025-10-31 03:22:08,371 - INFO - Avg. fwd time: 7.6774 / Avg. bwd time: 12.8476 / Avg. batch time: 491.1811 (ms) / GPU bubble ratio: 66.57%
[rank0]:2025-10-31 03:22:08,410 - INFO - Avg. fwd time: 8.6571 / Avg. bwd time: 19.3478 / Avg. batch time: 555.4745 (ms) / GPU bubble ratio: 59.67%
[rank1]:2025-10-31 03:22:18,773 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.2519e+00
[rank3]:2025-10-31 03:22:18,788 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.6405e+00
[rank2]:2025-10-31 03:22:18,773 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.3865e+00
[rank0]:2025-10-31 03:22:18,788 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.1277e+00
[rank1]:2025-10-31 03:22:29,680 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.6917e+00
[rank3]:2025-10-31 03:22:29,696 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 8.0367e-01
[rank2]:2025-10-31 03:22:29,680 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.8489e+00
[rank0]:2025-10-31 03:22:29,695 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.8325e+00
[rank2]:2025-10-31 03:22:40,572 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 7.8913e-01
[rank0]:2025-10-31 03:22:40,587 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.7311e+00
[rank1]:2025-10-31 03:22:40,572 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.2721e-01
[rank3]:2025-10-31 03:22:40,588 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 7.5476e-01
[rank1]:2025-10-31 03:22:51,432 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.0301e-01
[rank3]:2025-10-31 03:22:51,447 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.1998e+00
[rank2]:2025-10-31 03:22:51,432 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.3277e+00
[rank0]:2025-10-31 03:22:51,447 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 6.3554e-01
[rank0]:2025-10-31 03:23:01,270 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-31 03:23:02,355 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 5.6704e-01
[rank1]:2025-10-31 03:23:02,356 - INFO -  step: 350  loss: -2.0000  grad_norm:  0.2269  memory: 14.66GiB(30.86%)  tps: 7,484  tflops: 57.00  mfu: 18.27%
[rank3]:2025-10-31 03:23:02,377 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.1913e+00
[rank3]:2025-10-31 03:23:02,380 - INFO -  step: 350  loss:  0.1834  grad_norm:  0.2269  memory: 28.00GiB(58.93%)  tps: 7,483  tflops: 57.00  mfu: 18.27%
[rank2]:2025-10-31 03:23:02,355 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.1327e+00
[rank2]:2025-10-31 03:23:02,356 - INFO -  step: 350  loss: -2.0000  grad_norm:  0.2269  memory: 11.83GiB(24.89%)  tps: 7,484  tflops: 57.00  mfu: 18.27%
[rank0]:2025-10-31 03:23:02,370 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.6174e+00
[rank0]:2025-10-31 03:23:02,371 - INFO -  step: 350  loss: -2.0000  grad_norm:  0.2269  memory: 16.57GiB(34.88%)  tps: 7,484  tflops: 57.00  mfu: 18.27%
[rank1]:2025-10-31 03:23:13,253 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 5.8455e-01
[rank3]:2025-10-31 03:23:13,269 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.4062e+00
[rank2]:2025-10-31 03:23:13,253 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 9.8807e-01
[rank0]:2025-10-31 03:23:13,268 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 6.8805e-01
[rank1]:2025-10-31 03:23:24,206 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 3.1675e-01
[rank3]:2025-10-31 03:23:24,222 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 4.5771e-01
[rank2]:2025-10-31 03:23:24,206 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.1921e+00
[rank0]:2025-10-31 03:23:24,221 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.5107e-01
[rank1]:2025-10-31 03:23:35,100 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.4058e+00
[rank3]:2025-10-31 03:23:35,115 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 5.4781e-01
[rank2]:2025-10-31 03:23:35,100 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 7.9855e-01
[rank0]:2025-10-31 03:23:35,115 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.0162e+00
[rank1]:2025-10-31 03:23:45,979 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.0859e+00
[rank3]:2025-10-31 03:23:45,995 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 9.8254e-01
[rank2]:2025-10-31 03:23:45,979 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.4491e+00
[rank0]:2025-10-31 03:23:45,995 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.8025e+00
[rank0]:2025-10-31 03:23:55,790 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-31 03:23:56,887 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.9687e-01
[rank2]:2025-10-31 03:23:56,888 - INFO -  step: 400  loss: -2.0000  grad_norm:  0.3756  memory: 11.83GiB(24.89%)  tps: 7,511  tflops: 57.21  mfu: 18.34%
[rank2]:2025-10-31 03:23:56,888 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-10-31 03:23:56,903 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 4.1063e-01
[rank0]:2025-10-31 03:23:56,903 - INFO -  step: 400  loss: -2.0000  grad_norm:  0.3756  memory: 16.57GiB(34.88%)  tps: 7,511  tflops: 57.21  mfu: 18.34%
[rank0]:2025-10-31 03:23:56,903 - INFO - ðŸ”Ž  Running validation at step 400
[rank1]:2025-10-31 03:23:56,887 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 5.2024e-01
[rank1]:2025-10-31 03:23:56,888 - INFO -  step: 400  loss: -2.0000  grad_norm:  0.3756  memory: 14.66GiB(30.86%)  tps: 7,511  tflops: 57.21  mfu: 18.34%
[rank1]:2025-10-31 03:23:56,888 - INFO - ðŸ”Ž  Running validation at step 400
[rank3]:2025-10-31 03:23:56,903 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 4.8873e-01
[rank3]:2025-10-31 03:23:56,906 - INFO -  step: 400  loss:  0.2201  grad_norm:  0.3756  memory: 28.00GiB(58.93%)  tps: 7,512  tflops: 57.21  mfu: 18.34%
[rank3]:2025-10-31 03:23:56,907 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-10-31 03:24:16,707 - INFO - validate step: 400  loss: -1.0000  memory: 16.57GiB(34.88%)  tps: 20,683
[rank1]:2025-10-31 03:24:16,723 - INFO - validate step: 400  loss: -1.0000  memory: 14.66GiB(30.86%)  tps: 20,651
[rank3]:2025-10-31 03:24:16,732 - INFO - validate step: 400  loss:  0.9352  memory: 28.00GiB(58.93%)  tps: 20,661
[rank2]:2025-10-31 03:24:16,740 - INFO - validate step: 400  loss: -1.0000  memory: 11.83GiB(24.89%)  tps: 20,633
[rank0]:2025-10-31 03:24:16,824 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank0/251031_0324_stage0_step400.svg
[rank1]:2025-10-31 03:24:16,826 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank1/251031_0324_stage1_step400.svg
[rank2]:2025-10-31 03:24:16,823 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank2/251031_0324_stage2_step400.svg
[rank3]:2025-10-31 03:24:16,924 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/pipeline_schedule/251031_0324_real_step400_rank3.svg
[rank3]:> Batch Time: 463.83 ms, GPU Bubble Ratio: 56.91%, 59.47%, 67.80%, 14.77%
[rank3]:2025-10-31 03:24:16,998 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank3/251031_0324_stage3_step400.svg
[rank3]:2025-10-31 03:24:17,228 - INFO - Avg. fwd time: 11.1341 / Avg. bwd time: 38.7739 / Avg. batch time: 461.0416 (ms) / GPU bubble ratio: 13.40%
[rank2]:2025-10-31 03:24:17,286 - INFO - Avg. fwd time: 7.7613 / Avg. bwd time: 12.3308 / Avg. batch time: 486.1785 (ms) / GPU bubble ratio: 66.94%
[rank0]:2025-10-31 03:24:17,314 - INFO - Avg. fwd time: 8.7372 / Avg. bwd time: 18.5253 / Avg. batch time: 548.5177 (ms) / GPU bubble ratio: 60.24%
[rank1]:2025-10-31 03:24:17,341 - INFO - Avg. fwd time: 10.0334 / Avg. bwd time: 16.5488 / Avg. batch time: 517.0769 (ms) / GPU bubble ratio: 58.87%
[rank1]:2025-10-31 03:24:27,837 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 9.8409e-01
[rank3]:2025-10-31 03:24:27,853 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 9.9057e-01
[rank2]:2025-10-31 03:24:27,837 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.7949e-01
[rank0]:2025-10-31 03:24:27,853 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.3942e+00
[rank2]:2025-10-31 03:24:38,741 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.1294e+00
[rank0]:2025-10-31 03:24:38,757 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 7.8375e-01
[rank1]:2025-10-31 03:24:38,742 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.7475e+00
[rank3]:2025-10-31 03:24:38,757 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.5879e+00
[rank2]:2025-10-31 03:24:49,660 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.0394e-01
[rank0]:2025-10-31 03:24:49,676 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 6.6368e-01
[rank1]:2025-10-31 03:24:49,660 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 5.6874e-01
[rank3]:2025-10-31 03:24:49,676 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 5.3767e-01
[rank1]:2025-10-31 03:25:00,594 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 7.5593e-01
[rank3]:2025-10-31 03:25:00,610 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 4.3052e-01
[rank2]:2025-10-31 03:25:00,594 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 6.8924e-01
[rank0]:2025-10-31 03:25:00,609 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.0125e+00
[rank0]:2025-10-31 03:25:10,444 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-31 03:25:11,529 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.3764e+00
[rank1]:2025-10-31 03:25:11,529 - INFO -  step: 450  loss: -2.0000  grad_norm:  0.2510  memory: 14.66GiB(30.86%)  tps: 7,474  tflops: 56.92  mfu: 18.24%
[rank3]:2025-10-31 03:25:11,545 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.1000e+00
[rank3]:2025-10-31 03:25:11,548 - INFO -  step: 450  loss:  0.2286  grad_norm:  0.2510  memory: 28.00GiB(58.93%)  tps: 7,473  tflops: 56.91  mfu: 18.24%
[rank2]:2025-10-31 03:25:11,529 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.4097e+00
[rank2]:2025-10-31 03:25:11,529 - INFO -  step: 450  loss: -2.0000  grad_norm:  0.2510  memory: 11.83GiB(24.89%)  tps: 7,476  tflops: 56.94  mfu: 18.25%
[rank0]:2025-10-31 03:25:11,544 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 6.6411e-01
[rank0]:2025-10-31 03:25:11,544 - INFO -  step: 450  loss: -2.0000  grad_norm:  0.2510  memory: 16.57GiB(34.88%)  tps: 7,469  tflops: 56.89  mfu: 18.23%
[rank1]:2025-10-31 03:25:22,429 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 3.8518e+00
[rank3]:2025-10-31 03:25:22,444 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.6503e+00
[rank2]:2025-10-31 03:25:22,429 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.9672e+00
[rank0]:2025-10-31 03:25:22,444 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.9461e+00
[rank1]:2025-10-31 03:25:33,324 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.5258e+00
[rank3]:2025-10-31 03:25:33,339 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.3618e+00
[rank2]:2025-10-31 03:25:33,323 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.6296e+00
[rank0]:2025-10-31 03:25:33,339 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.5533e+00
[rank1]:2025-10-31 03:25:44,204 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 4.5324e-01
[rank3]:2025-10-31 03:25:44,220 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 6.5415e-01
[rank2]:2025-10-31 03:25:44,204 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 7.4133e-01
[rank0]:2025-10-31 03:25:44,219 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 6.6145e-01
[rank1]:2025-10-31 03:25:55,120 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 5.6588e-01
[rank3]:2025-10-31 03:25:55,136 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.2557e+00
[rank2]:2025-10-31 03:25:55,120 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.3250e+00
[rank0]:2025-10-31 03:25:55,135 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.6610e+00
[rank0]:2025-10-31 03:26:04,899 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-31 03:26:05,993 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 7.3640e-01
[rank1]:2025-10-31 03:26:05,993 - INFO -  step: 500  loss: -2.0000  grad_norm:  0.3264  memory: 14.66GiB(30.86%)  tps: 7,521  tflops: 57.28  mfu: 18.36%
[rank3]:2025-10-31 03:26:06,012 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 7.5873e-01
[rank3]:2025-10-31 03:26:06,017 - INFO -  step: 500  loss:  0.2592  grad_norm:  0.3264  memory: 28.00GiB(58.93%)  tps: 7,520  tflops: 57.27  mfu: 18.36%
[rank2]:2025-10-31 03:26:05,993 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.0745e+00
[rank2]:2025-10-31 03:26:05,993 - INFO -  step: 500  loss: -2.0000  grad_norm:  0.3264  memory: 11.83GiB(24.89%)  tps: 7,521  tflops: 57.28  mfu: 18.36%
[rank0]:2025-10-31 03:26:06,008 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 4.4102e-01
[rank0]:2025-10-31 03:26:06,008 - INFO -  step: 500  loss: -2.0000  grad_norm:  0.3264  memory: 16.57GiB(34.88%)  tps: 7,521  tflops: 57.28  mfu: 18.36%
[rank1]:2025-10-31 03:26:06,098 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank1/251031_0326_stage1_step500.svg
[rank2]:2025-10-31 03:26:06,094 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank2/251031_0326_stage2_step500.svg
[rank0]:2025-10-31 03:26:06,093 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank0/251031_0326_stage0_step500.svg
[rank3]:2025-10-31 03:26:06,204 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/pipeline_schedule/251031_0326_real_step500_rank3.svg
[rank3]:> Batch Time: 462.47 ms, GPU Bubble Ratio: 56.73%, 59.34%, 67.70%, 14.81%
[rank3]:2025-10-31 03:26:06,271 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank3/251031_0326_stage3_step500.svg
[rank3]:2025-10-31 03:26:06,497 - INFO - Avg. fwd time: 11.1869 / Avg. bwd time: 38.4079 / Avg. batch time: 458.0506 (ms) / GPU bubble ratio: 13.38%
[rank2]:2025-10-31 03:26:06,554 - INFO - Avg. fwd time: 7.8220 / Avg. bwd time: 11.9676 / Avg. batch time: 482.7521 (ms) / GPU bubble ratio: 67.21%
[rank1]:2025-10-31 03:26:06,607 - INFO - Avg. fwd time: 10.1266 / Avg. bwd time: 15.8006 / Avg. batch time: 512.8757 (ms) / GPU bubble ratio: 59.56%
[rank0]:2025-10-31 03:26:06,582 - INFO - Avg. fwd time: 8.7971 / Avg. bwd time: 17.9437 / Avg. batch time: 543.7229 (ms) / GPU bubble ratio: 60.66%
[rank1]:2025-10-31 03:26:17,140 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.0334e+00
[rank3]:2025-10-31 03:26:17,155 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.6469e+00
[rank2]:2025-10-31 03:26:17,140 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.9815e+00
[rank0]:2025-10-31 03:26:17,155 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.0622e+00
[rank1]:2025-10-31 03:26:28,047 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.9863e+00
[rank3]:2025-10-31 03:26:28,062 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.1091e+00
[rank2]:2025-10-31 03:26:28,047 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.2248e+00
[rank0]:2025-10-31 03:26:28,062 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.3933e+00
[rank1]:2025-10-31 03:26:38,964 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 4.0696e-01
[rank3]:2025-10-31 03:26:38,980 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.7927e+00
[rank2]:2025-10-31 03:26:38,964 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.7245e+00
[rank0]:2025-10-31 03:26:38,980 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1892e+00
[rank1]:2025-10-31 03:26:49,839 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 4.3497e-01
[rank3]:2025-10-31 03:26:49,855 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.6750e+00
[rank2]:2025-10-31 03:26:49,839 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.5309e+00
[rank0]:2025-10-31 03:26:49,855 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 9.5476e-01
[rank0]:2025-10-31 03:26:59,654 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-31 03:27:00,745 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.1546e+00
[rank1]:2025-10-31 03:27:00,746 - INFO -  step: 550  loss: -2.0000  grad_norm:  0.3136  memory: 14.66GiB(30.86%)  tps: 7,481  tflops: 56.98  mfu: 18.26%
[rank3]:2025-10-31 03:27:00,762 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.5392e+00
[rank3]:2025-10-31 03:27:00,765 - INFO -  step: 550  loss:  0.2576  grad_norm:  0.3136  memory: 28.00GiB(58.93%)  tps: 7,482  tflops: 56.98  mfu: 18.26%
[rank2]:2025-10-31 03:27:00,745 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 9.9060e-01
[rank2]:2025-10-31 03:27:00,746 - INFO -  step: 550  loss: -2.0000  grad_norm:  0.3136  memory: 11.83GiB(24.89%)  tps: 7,481  tflops: 56.98  mfu: 18.26%
[rank0]:2025-10-31 03:27:00,760 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.6822e+00
[rank0]:2025-10-31 03:27:00,761 - INFO -  step: 550  loss: -2.0000  grad_norm:  0.3136  memory: 16.57GiB(34.88%)  tps: 7,481  tflops: 56.98  mfu: 18.26%
[rank1]:2025-10-31 03:27:11,657 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 5.1857e-01
[rank3]:2025-10-31 03:27:11,672 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 7.4739e-01
[rank2]:2025-10-31 03:27:11,656 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.7904e-01
[rank0]:2025-10-31 03:27:11,672 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 6.6949e-01
[rank2]:2025-10-31 03:27:22,547 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.1940e+00
[rank0]:2025-10-31 03:27:22,563 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.4492e+00
[rank1]:2025-10-31 03:27:22,548 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.8055e+00
[rank3]:2025-10-31 03:27:22,563 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.4225e+00
[rank1]:2025-10-31 03:27:33,404 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.4300e-01
[rank3]:2025-10-31 03:27:33,419 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 5.1150e-01
[rank2]:2025-10-31 03:27:33,404 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.2616e-01
[rank0]:2025-10-31 03:27:33,419 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1740e+00
[rank1]:2025-10-31 03:27:44,305 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.3166e+00
[rank3]:2025-10-31 03:27:44,321 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.2471e+00
[rank2]:2025-10-31 03:27:44,305 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.5076e+00
[rank0]:2025-10-31 03:27:44,321 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.0975e+00
[rank0]:2025-10-31 03:27:54,096 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-31 03:27:55,197 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 8.2226e-01
[rank3]:2025-10-31 03:27:55,200 - INFO -  step: 600  loss:  0.2177  grad_norm:  0.3713  memory: 28.00GiB(58.93%)  tps: 7,525  tflops: 57.31  mfu: 18.37%
[rank3]:2025-10-31 03:27:55,201 - INFO - ðŸ”Ž  Running validation at step 600
[rank2]:2025-10-31 03:27:55,181 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 8.6133e-01
[rank2]:2025-10-31 03:27:55,182 - INFO -  step: 600  loss: -2.0000  grad_norm:  0.3713  memory: 11.83GiB(24.89%)  tps: 7,524  tflops: 57.31  mfu: 18.37%
[rank2]:2025-10-31 03:27:55,190 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-10-31 03:27:55,197 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.3959e+00
[rank0]:2025-10-31 03:27:55,197 - INFO -  step: 600  loss: -2.0000  grad_norm:  0.3713  memory: 16.57GiB(34.88%)  tps: 7,524  tflops: 57.31  mfu: 18.37%
[rank0]:2025-10-31 03:27:55,197 - INFO - ðŸ”Ž  Running validation at step 600
[rank1]:2025-10-31 03:27:55,182 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.1192e+00
[rank1]:2025-10-31 03:27:55,190 - INFO -  step: 600  loss: -2.0000  grad_norm:  0.3713  memory: 14.66GiB(30.86%)  tps: 7,523  tflops: 57.30  mfu: 18.37%
[rank1]:2025-10-31 03:27:55,190 - INFO - ðŸ”Ž  Running validation at step 600
[rank3]:2025-10-31 03:28:15,123 - INFO - validate step: 600  loss:  0.9351  memory: 28.00GiB(58.93%)  tps: 20,561
[rank2]:2025-10-31 03:28:15,130 - INFO - validate step: 600  loss: -1.0000  memory: 11.83GiB(24.89%)  tps: 20,542
[rank0]:2025-10-31 03:28:15,096 - INFO - validate step: 600  loss: -1.0000  memory: 16.57GiB(34.88%)  tps: 20,584
[rank1]:2025-10-31 03:28:15,115 - INFO - validate step: 600  loss: -1.0000  memory: 14.66GiB(30.86%)  tps: 20,557
[rank2]:2025-10-31 03:28:15,207 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank2/251031_0328_stage2_step600.svg
[rank0]:2025-10-31 03:28:15,207 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank0/251031_0328_stage0_step600.svg
[rank1]:2025-10-31 03:28:15,217 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank1/251031_0328_stage1_step600.svg
[rank3]:2025-10-31 03:28:15,314 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/pipeline_schedule/251031_0328_real_step600_rank3.svg
[rank3]:> Batch Time: 461.70 ms, GPU Bubble Ratio: 56.64%, 59.27%, 67.65%, 14.82%
[rank3]:2025-10-31 03:28:15,382 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank3/251031_0328_stage3_step600.svg
[rank1]:2025-10-31 03:28:15,883 - INFO - Avg. fwd time: 10.1868 / Avg. bwd time: 15.3133 / Avg. batch time: 510.2129 (ms) / GPU bubble ratio: 60.02%
[rank3]:2025-10-31 03:28:15,848 - INFO - Avg. fwd time: 11.2197 / Avg. bwd time: 38.1652 / Avg. batch time: 456.0551 (ms) / GPU bubble ratio: 13.37%
[rank2]:2025-10-31 03:28:15,865 - INFO - Avg. fwd time: 7.8601 / Avg. bwd time: 11.7291 / Avg. batch time: 480.5928 (ms) / GPU bubble ratio: 67.39%
[rank0]:2025-10-31 03:28:15,905 - INFO - Avg. fwd time: 8.8351 / Avg. bwd time: 17.5653 / Avg. batch time: 540.6672 (ms) / GPU bubble ratio: 60.94%
[rank1]:2025-10-31 03:28:26,265 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.9799e-01
[rank3]:2025-10-31 03:28:26,281 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 5.5393e-01
[rank2]:2025-10-31 03:28:26,265 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.5131e-01
[rank0]:2025-10-31 03:28:26,280 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 6.8354e-01
[rank1]:2025-10-31 03:28:37,187 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.5533e+00
[rank3]:2025-10-31 03:28:37,202 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 8.8088e-01
[rank2]:2025-10-31 03:28:37,186 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 8.3493e-01
[rank0]:2025-10-31 03:28:37,202 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.0469e+00
[rank1]:2025-10-31 03:28:48,103 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 4.9694e-01
[rank3]:2025-10-31 03:28:48,119 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.0375e+00
[rank2]:2025-10-31 03:28:48,103 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 7.0361e-01
[rank0]:2025-10-31 03:28:48,119 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 5.3559e-01
[rank1]:2025-10-31 03:28:59,030 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.3431e+00
[rank3]:2025-10-31 03:28:59,046 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.7178e+00
[rank2]:2025-10-31 03:28:59,030 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.3404e+00
[rank0]:2025-10-31 03:28:59,046 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.9658e+00
[rank0]:2025-10-31 03:29:08,882 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-31 03:29:09,993 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.9620e+00
[rank3]:2025-10-31 03:29:09,996 - INFO -  step: 650  loss:  0.3572  grad_norm:  0.2910  memory: 28.00GiB(58.93%)  tps: 7,465  tflops: 56.85  mfu: 18.22%
[rank2]:2025-10-31 03:29:09,977 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.2077e+00
[rank2]:2025-10-31 03:29:09,977 - INFO -  step: 650  loss: -2.0000  grad_norm:  0.2910  memory: 11.83GiB(24.89%)  tps: 7,468  tflops: 56.88  mfu: 18.23%
[rank0]:2025-10-31 03:29:09,993 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.5753e+00
[rank0]:2025-10-31 03:29:09,993 - INFO -  step: 650  loss: -2.0000  grad_norm:  0.2910  memory: 16.57GiB(34.88%)  tps: 7,461  tflops: 56.83  mfu: 18.21%
[rank1]:2025-10-31 03:29:09,977 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.5935e+00
[rank1]:2025-10-31 03:29:09,978 - INFO -  step: 650  loss: -2.0000  grad_norm:  0.2910  memory: 14.66GiB(30.86%)  tps: 7,466  tflops: 56.86  mfu: 18.23%
[rank2]:2025-10-31 03:29:20,913 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 7.7245e-01
[rank0]:2025-10-31 03:29:20,929 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 9.3258e-01
[rank1]:2025-10-31 03:29:20,913 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 9.3110e-01
[rank3]:2025-10-31 03:29:20,929 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 6.2056e-01
[rank2]:2025-10-31 03:29:31,845 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.0972e+00
[rank1]:2025-10-31 03:29:31,845 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 4.2382e-01
[rank3]:2025-10-31 03:29:31,861 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 8.0556e-01
[rank0]:2025-10-31 03:29:31,861 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.2324e+00
[rank3]:2025-10-31 03:29:42,827 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 9.1310e-01
[rank2]:2025-10-31 03:29:42,811 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.4309e-01
[rank0]:2025-10-31 03:29:42,826 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1795e+00
[rank1]:2025-10-31 03:29:42,811 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.2761e+00
[rank3]:2025-10-31 03:29:53,762 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 3.8545e-01
[rank2]:2025-10-31 03:29:53,746 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.4061e-01
[rank0]:2025-10-31 03:29:53,761 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.3155e+00
[rank1]:2025-10-31 03:29:53,746 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.3599e-01
[rank0]:2025-10-31 03:30:03,536 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-31 03:30:04,621 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 5.7269e-01
[rank1]:2025-10-31 03:30:04,621 - INFO -  step: 700  loss: -2.0000  grad_norm:  0.3281  memory: 14.66GiB(30.86%)  tps: 7,496  tflops: 57.09  mfu: 18.30%
[rank3]:2025-10-31 03:30:04,636 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 9.1240e-01
[rank3]:2025-10-31 03:30:04,639 - INFO -  step: 700  loss:  0.2357  grad_norm:  0.3281  memory: 28.00GiB(58.93%)  tps: 7,496  tflops: 57.09  mfu: 18.30%
[rank2]:2025-10-31 03:30:04,620 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.1356e+00
[rank2]:2025-10-31 03:30:04,621 - INFO -  step: 700  loss: -2.0000  grad_norm:  0.3281  memory: 11.83GiB(24.89%)  tps: 7,496  tflops: 57.09  mfu: 18.30%
[rank0]:2025-10-31 03:30:04,636 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1455e+00
[rank0]:2025-10-31 03:30:04,636 - INFO -  step: 700  loss: -2.0000  grad_norm:  0.3281  memory: 16.57GiB(34.88%)  tps: 7,496  tflops: 57.09  mfu: 18.30%
[rank1]:2025-10-31 03:30:04,725 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank1/251031_0330_stage1_step700.svg
[rank2]:2025-10-31 03:30:04,721 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank2/251031_0330_stage2_step700.svg
[rank0]:2025-10-31 03:30:04,721 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank0/251031_0330_stage0_step700.svg
[rank3]:2025-10-31 03:30:04,828 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/pipeline_schedule/251031_0330_real_step700_rank3.svg
[rank3]:> Batch Time: 461.29 ms, GPU Bubble Ratio: 56.58%, 59.23%, 67.62%, 14.83%
[rank3]:2025-10-31 03:30:04,901 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank3/251031_0330_stage3_step700.svg
[rank3]:2025-10-31 03:30:05,128 - INFO - Avg. fwd time: 11.2429 / Avg. bwd time: 38.0394 / Avg. batch time: 455.0422 (ms) / GPU bubble ratio: 13.36%
[rank2]:2025-10-31 03:30:05,184 - INFO - Avg. fwd time: 7.8840 / Avg. bwd time: 11.5833 / Avg. batch time: 479.2986 (ms) / GPU bubble ratio: 67.51%
[rank1]:2025-10-31 03:30:05,236 - INFO - Avg. fwd time: 10.2242 / Avg. bwd time: 15.0140 / Avg. batch time: 508.6083 (ms) / GPU bubble ratio: 60.30%
[rank0]:2025-10-31 03:30:05,212 - INFO - Avg. fwd time: 8.8595 / Avg. bwd time: 17.3332 / Avg. batch time: 538.8225 (ms) / GPU bubble ratio: 61.11%
[rank3]:2025-10-31 03:30:15,774 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 6.6516e-01
[rank2]:2025-10-31 03:30:15,758 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.0852e+00
[rank0]:2025-10-31 03:30:15,773 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.0264e+00
[rank1]:2025-10-31 03:30:15,758 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 3.1503e-01
[rank1]:2025-10-31 03:30:26,658 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 9.6796e-01
[rank3]:2025-10-31 03:30:26,674 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 3.9791e-01
[rank2]:2025-10-31 03:30:26,658 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.6160e-01
[rank0]:2025-10-31 03:30:26,673 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 7.8599e-01
[rank3]:2025-10-31 03:30:37,606 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.3763e+00
[rank2]:2025-10-31 03:30:37,590 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.5249e+00
[rank0]:2025-10-31 03:30:37,606 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.3332e+00
[rank1]:2025-10-31 03:30:37,590 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.9631e+00
[rank3]:2025-10-31 03:30:48,522 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 3.5322e-01
[rank2]:2025-10-31 03:30:48,507 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 6.8848e-01
[rank0]:2025-10-31 03:30:48,522 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.5327e+00
[rank1]:2025-10-31 03:30:48,507 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.5396e+00
[rank0]:2025-10-31 03:30:58,341 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-31 03:30:59,442 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.2819e+00
[rank3]:2025-10-31 03:30:59,444 - INFO -  step: 750  loss:  0.2255  grad_norm:  0.2566  memory: 28.00GiB(58.93%)  tps: 7,474  tflops: 56.92  mfu: 18.24%
[rank2]:2025-10-31 03:30:59,426 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.2113e+00
[rank2]:2025-10-31 03:30:59,426 - INFO -  step: 750  loss: -2.0000  grad_norm:  0.2566  memory: 11.83GiB(24.89%)  tps: 7,474  tflops: 56.92  mfu: 18.24%
[rank0]:2025-10-31 03:30:59,441 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.3196e+00
[rank0]:2025-10-31 03:30:59,442 - INFO -  step: 750  loss: -2.0000  grad_norm:  0.2566  memory: 16.57GiB(34.88%)  tps: 7,474  tflops: 56.92  mfu: 18.24%
[rank1]:2025-10-31 03:30:59,426 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.3560e+00
[rank1]:2025-10-31 03:30:59,427 - INFO -  step: 750  loss: -2.0000  grad_norm:  0.2566  memory: 14.66GiB(30.86%)  tps: 7,474  tflops: 56.92  mfu: 18.24%
[rank1]:2025-10-31 03:31:10,380 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 7.2196e-01
[rank3]:2025-10-31 03:31:10,396 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.9471e+00
[rank2]:2025-10-31 03:31:10,380 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 7.4274e-01
[rank0]:2025-10-31 03:31:10,395 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 5.7492e-01
[rank1]:2025-10-31 03:31:21,317 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 8.0455e-01
[rank3]:2025-10-31 03:31:21,333 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 5.5868e-01
[rank2]:2025-10-31 03:31:21,317 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.2953e-01
[rank0]:2025-10-31 03:31:21,332 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 6.3134e-01
[rank1]:2025-10-31 03:31:32,234 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 3.1748e+00
[rank3]:2025-10-31 03:31:32,250 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 9.2285e-01
[rank2]:2025-10-31 03:31:32,234 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.5858e+00
[rank0]:2025-10-31 03:31:32,249 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.5075e+00
[rank3]:2025-10-31 03:31:43,198 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 5.1960e-01
[rank2]:2025-10-31 03:31:43,182 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 7.8517e-01
[rank0]:2025-10-31 03:31:43,198 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 8.0955e-01
[rank1]:2025-10-31 03:31:43,182 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 7.5376e-01
[rank0]:2025-10-31 03:31:53,028 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-31 03:31:54,130 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.3308e+00
[rank2]:2025-10-31 03:31:54,130 - INFO -  step: 800  loss: -2.0000  grad_norm:  0.3781  memory: 11.83GiB(24.89%)  tps: 7,488  tflops: 57.03  mfu: 18.28%
[rank2]:2025-10-31 03:31:54,130 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-10-31 03:31:54,145 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.6115e+00
[rank0]:2025-10-31 03:31:54,146 - INFO -  step: 800  loss: -2.0000  grad_norm:  0.3781  memory: 16.57GiB(34.88%)  tps: 7,488  tflops: 57.03  mfu: 18.28%
[rank0]:2025-10-31 03:31:54,146 - INFO - ðŸ”Ž  Running validation at step 800
[rank1]:2025-10-31 03:31:54,130 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.1639e+00
[rank1]:2025-10-31 03:31:54,130 - INFO -  step: 800  loss: -2.0000  grad_norm:  0.3781  memory: 14.66GiB(30.86%)  tps: 7,488  tflops: 57.03  mfu: 18.28%
[rank1]:2025-10-31 03:31:54,130 - INFO - ðŸ”Ž  Running validation at step 800
[rank3]:2025-10-31 03:31:54,146 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 9.4347e-01
[rank3]:2025-10-31 03:31:54,149 - INFO -  step: 800  loss:  0.2599  grad_norm:  0.3781  memory: 28.00GiB(58.93%)  tps: 7,488  tflops: 57.03  mfu: 18.28%
[rank3]:2025-10-31 03:31:54,149 - INFO - ðŸ”Ž  Running validation at step 800
[rank3]:2025-10-31 03:32:14,148 - INFO - validate step: 800  loss:  0.9358  memory: 28.00GiB(58.93%)  tps: 20,482
[rank3]:2025-10-31 03:32:14,149 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-31 03:32:14,156 - INFO - validate step: 800  loss: -1.0000  memory: 11.83GiB(24.89%)  tps: 20,454
[rank2]:2025-10-31 03:32:14,157 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-31 03:32:14,121 - INFO - validate step: 800  loss: -1.0000  memory: 16.57GiB(34.88%)  tps: 20,506
[rank0]:2025-10-31 03:32:14,122 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-31 03:32:14,128 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank1]:2025-10-31 03:32:14,139 - INFO - validate step: 800  loss: -1.0000  memory: 14.66GiB(30.86%)  tps: 20,472
[rank1]:2025-10-31 03:32:14,140 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-31 03:32:16,033 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 1.88 seconds.
[rank1]:2025-10-31 03:32:16,407 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 2.27 seconds.
[rank3]:2025-10-31 03:32:17,381 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.23 seconds.
[rank0]:2025-10-31 03:32:17,825 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-31 03:32:17,834 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.71 seconds.
[rank1]:2025-10-31 03:32:17,923 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank1/251031_0332_stage1_step800.svg
[rank2]:2025-10-31 03:32:17,920 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank2/251031_0332_stage2_step800.svg
[rank0]:2025-10-31 03:32:18,116 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank0/251031_0332_stage0_step800.svg
[rank3]:2025-10-31 03:32:18,173 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/pipeline_schedule/251031_0332_real_step800_rank3.svg
[rank3]:> Batch Time: 461.04 ms, GPU Bubble Ratio: 56.54%, 59.20%, 67.60%, 14.84%
[rank3]:2025-10-31 03:32:18,249 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank3/251031_0332_stage3_step800.svg
[rank3]:2025-10-31 03:32:19,289 - INFO - Avg. fwd time: 11.2621 / Avg. bwd time: 37.9227 / Avg. batch time: 454.0938 (ms) / GPU bubble ratio: 13.35%
[rank2]:2025-10-31 03:32:19,346 - INFO - Avg. fwd time: 7.9051 / Avg. bwd time: 11.4549 / Avg. batch time: 478.1956 (ms) / GPU bubble ratio: 67.61%
[rank0]:2025-10-31 03:32:19,374 - INFO - Avg. fwd time: 8.8804 / Avg. bwd time: 17.1284 / Avg. batch time: 537.2299 (ms) / GPU bubble ratio: 61.27%
[rank1]:2025-10-31 03:32:19,397 - INFO - Avg. fwd time: 10.2562 / Avg. bwd time: 14.7493 / Avg. batch time: 507.2295 (ms) / GPU bubble ratio: 60.56%
[rank1]:2025-10-31 03:32:29,915 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 6.2806e-01
[rank3]:2025-10-31 03:32:29,931 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 4.1802e-01
[rank2]:2025-10-31 03:32:29,915 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.3630e+00
[rank0]:2025-10-31 03:32:29,931 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 9.7898e-01
[rank3]:2025-10-31 03:32:30,435 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-31 03:32:30,453 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-31 03:32:30,491 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-31 03:32:30,469 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-31 03:32:40,833 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.4123e+00
[rank3]:2025-10-31 03:32:40,848 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.2570e-01
[rank2]:2025-10-31 03:32:40,833 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 6.9504e-01
[rank0]:2025-10-31 03:32:40,848 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 9.8102e-01
[rank2]:2025-10-31 03:32:51,695 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.0979e+00
[rank0]:2025-10-31 03:32:51,711 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 5.2259e-01
[rank1]:2025-10-31 03:32:51,695 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 4.4958e-01
[rank3]:2025-10-31 03:32:51,711 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 7.6324e-01
[rank0]:2025-10-31 03:33:02,543 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.0894e+00
[rank1]:2025-10-31 03:33:02,528 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.5209e+00
[rank3]:2025-10-31 03:33:02,544 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 5.1977e-01
[rank2]:2025-10-31 03:33:02,528 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.8672e-01
[rank0]:2025-10-31 03:33:12,615 - INFO - [GC] Peforming periodical GC collection 0.28 seconds
[rank1]:2025-10-31 03:33:13,695 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 5.0307e-01
[rank1]:2025-10-31 03:33:13,696 - INFO -  step: 850  loss: -2.0000  grad_norm:  0.2919  memory: 14.66GiB(30.86%)  tps: 6,878  tflops: 52.38  mfu: 16.79%
[rank3]:2025-10-31 03:33:13,710 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.3257e+00
[rank3]:2025-10-31 03:33:13,714 - INFO -  step: 850  loss:  0.2071  grad_norm:  0.2919  memory: 28.00GiB(58.93%)  tps: 6,877  tflops: 52.37  mfu: 16.79%
[rank2]:2025-10-31 03:33:13,695 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.1262e+00
[rank2]:2025-10-31 03:33:13,695 - INFO -  step: 850  loss: -2.0000  grad_norm:  0.2919  memory: 11.83GiB(24.89%)  tps: 6,880  tflops: 52.40  mfu: 16.79%
[rank0]:2025-10-31 03:33:13,710 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.2359e+00
[rank0]:2025-10-31 03:33:13,711 - INFO -  step: 850  loss: -2.0000  grad_norm:  0.2919  memory: 16.57GiB(34.88%)  tps: 6,874  tflops: 52.35  mfu: 16.78%
[rank1]:2025-10-31 03:33:24,558 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 7.1621e-01
[rank3]:2025-10-31 03:33:24,573 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.6276e+00
[rank2]:2025-10-31 03:33:24,558 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.5160e+00
[rank0]:2025-10-31 03:33:24,573 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 7.5477e-01
[rank3]:2025-10-31 03:33:35,450 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.0894e+00
[rank2]:2025-10-31 03:33:35,434 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.2447e+00
[rank0]:2025-10-31 03:33:35,449 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.0360e+00
[rank1]:2025-10-31 03:33:35,434 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.9045e+00
[rank1]:2025-10-31 03:33:46,342 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 5.0941e-01
[rank3]:2025-10-31 03:33:46,366 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.0185e+00
[rank2]:2025-10-31 03:33:46,342 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.6034e-01
[rank0]:2025-10-31 03:33:46,358 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 6.9461e-01
[rank1]:2025-10-31 03:33:57,220 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.1648e+00
[rank3]:2025-10-31 03:33:57,235 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.0419e+00
[rank2]:2025-10-31 03:33:57,219 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.5924e+00
[rank0]:2025-10-31 03:33:57,235 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1963e+00
[rank0]:2025-10-31 03:34:07,001 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-31 03:34:08,100 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.7199e+00
[rank3]:2025-10-31 03:34:08,103 - INFO -  step: 900  loss:  0.2228  grad_norm:  0.2537  memory: 28.00GiB(58.93%)  tps: 7,531  tflops: 57.36  mfu: 18.38%
[rank2]:2025-10-31 03:34:08,085 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.8542e+00
[rank2]:2025-10-31 03:34:08,085 - INFO -  step: 900  loss: -2.0000  grad_norm:  0.2537  memory: 11.83GiB(24.89%)  tps: 7,531  tflops: 57.36  mfu: 18.38%
[rank0]:2025-10-31 03:34:08,100 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.7756e+00
[rank0]:2025-10-31 03:34:08,100 - INFO -  step: 900  loss: -2.0000  grad_norm:  0.2537  memory: 16.57GiB(34.88%)  tps: 7,531  tflops: 57.36  mfu: 18.38%
[rank1]:2025-10-31 03:34:08,084 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.4090e+00
[rank1]:2025-10-31 03:34:08,085 - INFO -  step: 900  loss: -2.0000  grad_norm:  0.2537  memory: 14.66GiB(30.86%)  tps: 7,531  tflops: 57.36  mfu: 18.38%
[rank2]:2025-10-31 03:34:08,178 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank2/251031_0334_stage2_step900.svg
[rank0]:2025-10-31 03:34:08,178 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank0/251031_0334_stage0_step900.svg
[rank1]:2025-10-31 03:34:08,182 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank1/251031_0334_stage1_step900.svg
[rank3]:2025-10-31 03:34:08,291 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/pipeline_schedule/251031_0334_real_step900_rank3.svg
[rank3]:> Batch Time: 460.55 ms, GPU Bubble Ratio: 56.50%, 59.16%, 67.57%, 14.84%
[rank3]:2025-10-31 03:34:08,359 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank3/251031_0334_stage3_step900.svg
[rank1]:2025-10-31 03:34:08,857 - INFO - Avg. fwd time: 10.2793 / Avg. bwd time: 14.5457 / Avg. batch time: 506.4236 (ms) / GPU bubble ratio: 60.78%
[rank3]:2025-10-31 03:34:08,821 - INFO - Avg. fwd time: 11.2743 / Avg. bwd time: 37.8053 / Avg. batch time: 453.5730 (ms) / GPU bubble ratio: 13.43%
[rank2]:2025-10-31 03:34:08,838 - INFO - Avg. fwd time: 7.9207 / Avg. bwd time: 11.3555 / Avg. batch time: 477.5987 (ms) / GPU bubble ratio: 67.71%
[rank0]:2025-10-31 03:34:08,879 - INFO - Avg. fwd time: 8.8958 / Avg. bwd time: 16.9701 / Avg. batch time: 536.2718 (ms) / GPU bubble ratio: 61.41%
[rank3]:2025-10-31 03:34:19,219 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 4.8323e-01
[rank2]:2025-10-31 03:34:19,203 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.1282e-01
[rank0]:2025-10-31 03:34:19,218 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 7.2103e-01
[rank1]:2025-10-31 03:34:19,203 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 3.9616e-01
[rank1]:2025-10-31 03:34:30,149 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.7974e+00
[rank3]:2025-10-31 03:34:30,165 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.4846e+00
[rank2]:2025-10-31 03:34:30,149 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.7888e+00
[rank0]:2025-10-31 03:34:30,165 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.6877e+00
[rank1]:2025-10-31 03:34:41,073 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.6061e+00
[rank3]:2025-10-31 03:34:41,088 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.5012e+00
[rank2]:2025-10-31 03:34:41,073 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.7334e+00
[rank0]:2025-10-31 03:34:41,088 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.0151e+00
[rank2]:2025-10-31 03:34:51,959 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.0366e+00
[rank1]:2025-10-31 03:34:51,960 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.1358e+00
[rank3]:2025-10-31 03:34:51,977 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.5265e+00
[rank0]:2025-10-31 03:34:51,975 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.4098e+00
[rank0]:2025-10-31 03:35:01,746 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-31 03:35:02,826 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.1401e+00
[rank1]:2025-10-31 03:35:02,826 - INFO -  step: 950  loss: -2.0000  grad_norm:  0.2379  memory: 14.66GiB(30.86%)  tps: 7,483  tflops: 56.99  mfu: 18.27%
[rank3]:2025-10-31 03:35:02,841 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.8126e+00
[rank3]:2025-10-31 03:35:02,844 - INFO -  step: 950  loss:  0.1918  grad_norm:  0.2379  memory: 28.00GiB(58.93%)  tps: 7,483  tflops: 56.99  mfu: 18.27%
[rank2]:2025-10-31 03:35:02,826 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.6149e+00
[rank2]:2025-10-31 03:35:02,826 - INFO -  step: 950  loss: -2.0000  grad_norm:  0.2379  memory: 11.83GiB(24.89%)  tps: 7,483  tflops: 56.99  mfu: 18.27%
[rank0]:2025-10-31 03:35:02,841 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.0161e+00
[rank0]:2025-10-31 03:35:02,841 - INFO -  step: 950  loss: -2.0000  grad_norm:  0.2379  memory: 16.57GiB(34.88%)  tps: 7,483  tflops: 56.99  mfu: 18.27%
[rank1]:2025-10-31 03:35:13,732 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.0531e+00
[rank3]:2025-10-31 03:35:13,753 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.7043e+00
[rank2]:2025-10-31 03:35:13,732 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.3049e+00
[rank0]:2025-10-31 03:35:13,748 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.3641e+00
[rank1]:2025-10-31 03:35:24,662 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.2358e+00
[rank3]:2025-10-31 03:35:24,677 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 7.5621e-01
[rank2]:2025-10-31 03:35:24,662 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 6.7583e-01
[rank0]:2025-10-31 03:35:24,677 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 6.6398e-01
[rank2]:2025-10-31 03:35:35,518 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.3126e+00
[rank0]:2025-10-31 03:35:35,533 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.6463e+00
[rank1]:2025-10-31 03:35:35,518 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 7.5510e-01
[rank3]:2025-10-31 03:35:35,538 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.3786e+00
[rank1]:2025-10-31 03:35:46,394 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 9.1554e-01
[rank3]:2025-10-31 03:35:46,409 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 7.9158e-01
[rank2]:2025-10-31 03:35:46,394 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.1563e-01
[rank0]:2025-10-31 03:35:46,409 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 7.6094e-01
[rank0]:2025-10-31 03:35:56,167 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-31 03:35:57,272 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.1748e+00
[rank1]:2025-10-31 03:35:57,273 - INFO -  step: 1000  loss: -2.0000  grad_norm:  0.3806  memory: 14.66GiB(30.86%)  tps: 7,523  tflops: 57.30  mfu: 18.36%
[rank1]:2025-10-31 03:35:57,273 - INFO - ðŸ”Ž  Running validation at step 1000
[rank3]:2025-10-31 03:35:57,289 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.6907e+00
[rank3]:2025-10-31 03:35:57,292 - INFO -  step: 1000  loss:  0.2801  grad_norm:  0.3806  memory: 28.00GiB(58.93%)  tps: 7,523  tflops: 57.30  mfu: 18.36%
[rank3]:2025-10-31 03:35:57,293 - INFO - ðŸ”Ž  Running validation at step 1000
[rank2]:2025-10-31 03:35:57,272 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.0744e+00
[rank2]:2025-10-31 03:35:57,273 - INFO -  step: 1000  loss: -2.0000  grad_norm:  0.3806  memory: 11.83GiB(24.89%)  tps: 7,523  tflops: 57.30  mfu: 18.36%
[rank2]:2025-10-31 03:35:57,273 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-10-31 03:35:57,288 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 7.0807e-01
[rank0]:2025-10-31 03:35:57,288 - INFO -  step: 1000  loss: -2.0000  grad_norm:  0.3806  memory: 16.57GiB(34.88%)  tps: 7,523  tflops: 57.30  mfu: 18.36%
[rank0]:2025-10-31 03:35:57,288 - INFO - ðŸ”Ž  Running validation at step 1000
[rank1]:2025-10-31 03:36:17,030 - INFO - validate step: 1000  loss: -1.0000  memory: 14.66GiB(30.86%)  tps: 20,732
[rank3]:2025-10-31 03:36:17,041 - INFO - validate step: 1000  loss:  0.9430  memory: 28.00GiB(58.93%)  tps: 20,742
[rank2]:2025-10-31 03:36:17,047 - INFO - validate step: 1000  loss: -1.0000  memory: 11.83GiB(24.89%)  tps: 20,714
[rank0]:2025-10-31 03:36:17,013 - INFO - validate step: 1000  loss: -1.0000  memory: 16.57GiB(34.88%)  tps: 20,766
[rank1]:2025-10-31 03:36:17,129 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank1/251031_0336_stage1_step1000.svg
[rank2]:2025-10-31 03:36:17,126 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank2/251031_0336_stage2_step1000.svg
[rank0]:2025-10-31 03:36:17,126 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank0/251031_0336_stage0_step1000.svg
[rank3]:2025-10-31 03:36:17,234 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/pipeline_schedule/251031_0336_real_step1000_rank3.svg
[rank3]:> Batch Time: 460.13 ms, GPU Bubble Ratio: 56.46%, 59.13%, 67.54%, 14.86%
[rank3]:2025-10-31 03:36:17,302 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank3/251031_0336_stage3_step1000.svg
[rank3]:2025-10-31 03:36:17,536 - INFO - Avg. fwd time: 11.2849 / Avg. bwd time: 37.7337 / Avg. batch time: 452.9536 (ms) / GPU bubble ratio: 13.42%
[rank1]:2025-10-31 03:36:17,641 - INFO - Avg. fwd time: 10.2960 / Avg. bwd time: 14.4059 / Avg. batch time: 505.5092 (ms) / GPU bubble ratio: 60.91%
[rank2]:2025-10-31 03:36:17,593 - INFO - Avg. fwd time: 7.9320 / Avg. bwd time: 11.2878 / Avg. batch time: 476.8309 (ms) / GPU bubble ratio: 67.75%
[rank0]:2025-10-31 03:36:17,621 - INFO - Avg. fwd time: 8.9069 / Avg. bwd time: 16.8619 / Avg. batch time: 535.2422 (ms) / GPU bubble ratio: 61.48%
[rank1]:2025-10-31 03:36:28,162 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.6634e-01
[rank3]:2025-10-31 03:36:28,177 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 3.2226e-01
[rank2]:2025-10-31 03:36:28,161 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.4455e-01
[rank0]:2025-10-31 03:36:28,177 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1681e+00
[rank1]:2025-10-31 03:36:39,041 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.1855e+00
[rank3]:2025-10-31 03:36:39,058 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.3664e+00
[rank2]:2025-10-31 03:36:39,041 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.2901e+00
[rank0]:2025-10-31 03:36:39,056 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.2403e+00
[rank1]:2025-10-31 03:36:49,959 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.9749e-01
[rank3]:2025-10-31 03:36:49,975 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.9584e-01
[rank2]:2025-10-31 03:36:49,959 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.1435e-01
[rank0]:2025-10-31 03:36:49,974 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 5.7983e-01
[rank1]:2025-10-31 03:37:00,876 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.1656e+00
[rank3]:2025-10-31 03:37:00,892 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.7111e+00
[rank2]:2025-10-31 03:37:00,876 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.0419e+00
[rank0]:2025-10-31 03:37:00,892 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.6699e+00
[rank0]:2025-10-31 03:37:10,724 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-31 03:37:11,811 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.5504e+00
[rank1]:2025-10-31 03:37:11,812 - INFO -  step: 1050  loss: -2.0000  grad_norm:  0.2855  memory: 14.66GiB(30.86%)  tps: 7,477  tflops: 56.95  mfu: 18.25%
[rank3]:2025-10-31 03:37:11,827 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 3.1059e+00
[rank3]:2025-10-31 03:37:11,830 - INFO -  step: 1050  loss:  0.3032  grad_norm:  0.2855  memory: 28.00GiB(58.93%)  tps: 7,476  tflops: 56.94  mfu: 18.25%
[rank2]:2025-10-31 03:37:11,811 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.8174e+00
[rank2]:2025-10-31 03:37:11,812 - INFO -  step: 1050  loss: -2.0000  grad_norm:  0.2855  memory: 11.83GiB(24.89%)  tps: 7,479  tflops: 56.96  mfu: 18.26%
[rank0]:2025-10-31 03:37:11,827 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 5.1884e+00
[rank0]:2025-10-31 03:37:11,827 - INFO -  step: 1050  loss: -2.0000  grad_norm:  0.2855  memory: 16.57GiB(34.88%)  tps: 7,473  tflops: 56.91  mfu: 18.24%
[rank1]:2025-10-31 03:37:22,677 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.3367e+00
[rank3]:2025-10-31 03:37:22,692 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 3.2539e+00
[rank2]:2025-10-31 03:37:22,677 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.2001e+00
[rank0]:2025-10-31 03:37:22,692 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.2005e+00
[rank2]:2025-10-31 03:37:33,565 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.8400e+00
[rank0]:2025-10-31 03:37:33,581 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.6209e+00
[rank1]:2025-10-31 03:37:33,566 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.3084e+00
[rank3]:2025-10-31 03:37:33,582 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.4889e+00
[rank1]:2025-10-31 03:37:44,464 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.1649e+00
[rank3]:2025-10-31 03:37:44,480 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 8.0772e-01
[rank2]:2025-10-31 03:37:44,464 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.0076e+00
[rank0]:2025-10-31 03:37:44,480 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.4824e+00
[rank1]:2025-10-31 03:37:55,377 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.7951e+00
[rank3]:2025-10-31 03:37:55,393 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 3.9334e+00
[rank2]:2025-10-31 03:37:55,377 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.0936e+00
[rank0]:2025-10-31 03:37:55,392 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.3335e+00
[rank0]:2025-10-31 03:38:05,185 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-31 03:38:06,272 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 4.9573e-01
[rank1]:2025-10-31 03:38:06,273 - INFO -  step: 1100  loss: -2.0000  grad_norm:  0.2930  memory: 14.66GiB(30.86%)  tps: 7,521  tflops: 57.28  mfu: 18.36%
[rank3]:2025-10-31 03:38:06,288 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 6.5791e-01
[rank3]:2025-10-31 03:38:06,290 - INFO -  step: 1100  loss:  0.3164  grad_norm:  0.2930  memory: 28.00GiB(58.93%)  tps: 7,521  tflops: 57.28  mfu: 18.36%
[rank2]:2025-10-31 03:38:06,272 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 7.6222e-01
[rank2]:2025-10-31 03:38:06,273 - INFO -  step: 1100  loss: -2.0000  grad_norm:  0.2930  memory: 11.83GiB(24.89%)  tps: 7,521  tflops: 57.28  mfu: 18.36%
[rank0]:2025-10-31 03:38:06,288 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 5.0524e-01
[rank0]:2025-10-31 03:38:06,288 - INFO -  step: 1100  loss: -2.0000  grad_norm:  0.2930  memory: 16.57GiB(34.88%)  tps: 7,521  tflops: 57.28  mfu: 18.36%
[rank1]:2025-10-31 03:38:06,373 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank1/251031_0338_stage1_step1100.svg
[rank2]:2025-10-31 03:38:06,368 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank2/251031_0338_stage2_step1100.svg
[rank0]:2025-10-31 03:38:06,368 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank0/251031_0338_stage0_step1100.svg
[rank3]:2025-10-31 03:38:06,477 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/pipeline_schedule/251031_0338_real_step1100_rank3.svg
[rank3]:> Batch Time: 459.79 ms, GPU Bubble Ratio: 56.42%, 59.10%, 67.51%, 14.87%
[rank3]:2025-10-31 03:38:06,545 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank3/251031_0338_stage3_step1100.svg
[rank3]:2025-10-31 03:38:06,770 - INFO - Avg. fwd time: 11.2958 / Avg. bwd time: 37.6593 / Avg. batch time: 452.3195 (ms) / GPU bubble ratio: 13.41%
[rank1]:2025-10-31 03:38:06,872 - INFO - Avg. fwd time: 10.3122 / Avg. bwd time: 14.2725 / Avg. batch time: 504.6574 (ms) / GPU bubble ratio: 61.03%
[rank2]:2025-10-31 03:38:06,825 - INFO - Avg. fwd time: 7.9429 / Avg. bwd time: 11.2229 / Avg. batch time: 476.1202 (ms) / GPU bubble ratio: 67.80%
[rank0]:2025-10-31 03:38:06,853 - INFO - Avg. fwd time: 8.9181 / Avg. bwd time: 16.7583 / Avg. batch time: 534.2857 (ms) / GPU bubble ratio: 61.55%
[rank1]:2025-10-31 03:38:17,378 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.0686e-01
[rank3]:2025-10-31 03:38:17,395 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 5.1284e-01
[rank2]:2025-10-31 03:38:17,378 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.2760e-01
[rank0]:2025-10-31 03:38:17,394 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.5507e-01
[rank1]:2025-10-31 03:38:28,302 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.2987e+00
[rank3]:2025-10-31 03:38:28,322 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 9.0176e-01
[rank2]:2025-10-31 03:38:28,302 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.3217e+00
[rank0]:2025-10-31 03:38:28,317 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.8731e+00
[rank1]:2025-10-31 03:38:39,222 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.2355e+00
[rank3]:2025-10-31 03:38:39,244 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.9536e-01
[rank2]:2025-10-31 03:38:39,222 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.2715e-01
[rank0]:2025-10-31 03:38:39,238 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 4.2373e-01
[rank1]:2025-10-31 03:38:50,115 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.8760e-01
[rank3]:2025-10-31 03:38:50,131 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.2617e+00
[rank2]:2025-10-31 03:38:50,115 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 7.9035e-01
[rank0]:2025-10-31 03:38:50,130 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.2385e-01
[rank0]:2025-10-31 03:38:59,969 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-31 03:39:01,057 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.8065e+00
[rank1]:2025-10-31 03:39:01,057 - INFO -  step: 1150  loss: -2.0000  grad_norm:  0.2414  memory: 14.66GiB(30.86%)  tps: 7,477  tflops: 56.94  mfu: 18.25%
[rank2]:2025-10-31 03:39:01,056 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.0377e+00
[rank2]:2025-10-31 03:39:01,057 - INFO -  step: 1150  loss: -2.0000  grad_norm:  0.2414  memory: 11.83GiB(24.89%)  tps: 7,478  tflops: 56.95  mfu: 18.25%
[rank3]:2025-10-31 03:39:01,079 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.4884e+00
[rank3]:2025-10-31 03:39:01,082 - INFO -  step: 1150  loss:  0.2423  grad_norm:  0.2414  memory: 28.00GiB(58.93%)  tps: 7,476  tflops: 56.94  mfu: 18.25%
[rank0]:2025-10-31 03:39:01,072 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.2701e+00
[rank0]:2025-10-31 03:39:01,072 - INFO -  step: 1150  loss: -2.0000  grad_norm:  0.2414  memory: 16.57GiB(34.88%)  tps: 7,477  tflops: 56.94  mfu: 18.25%
[rank1]:2025-10-31 03:39:11,949 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.5932e-01
[rank2]:2025-10-31 03:39:11,949 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 6.9300e-01
[rank3]:2025-10-31 03:39:11,965 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 5.3822e-01
[rank0]:2025-10-31 03:39:11,965 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 7.2997e-01
[rank0]:2025-10-31 03:39:22,824 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.5452e+00
[rank1]:2025-10-31 03:39:22,809 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 3.7134e-01
[rank2]:2025-10-31 03:39:22,809 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.7366e-01
[rank3]:2025-10-31 03:39:22,824 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 4.7333e-01
[rank1]:2025-10-31 03:39:33,679 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.6144e+00
[rank2]:2025-10-31 03:39:33,679 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.5382e+00
[rank3]:2025-10-31 03:39:33,695 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.0489e+00
[rank0]:2025-10-31 03:39:33,695 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.8818e+00
[rank1]:2025-10-31 03:39:44,583 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.4947e+00
[rank2]:2025-10-31 03:39:44,583 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.8636e+00
[rank3]:2025-10-31 03:39:44,605 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.6324e+00
[rank0]:2025-10-31 03:39:44,598 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.0798e+00
[rank0]:2025-10-31 03:39:54,414 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-31 03:39:55,516 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 5.8580e-01
[rank1]:2025-10-31 03:39:55,516 - INFO -  step: 1200  loss: -2.0000  grad_norm:  0.3648  memory: 14.66GiB(30.86%)  tps: 7,521  tflops: 57.28  mfu: 18.36%
[rank1]:2025-10-31 03:39:55,516 - INFO - ðŸ”Ž  Running validation at step 1200
[rank2]:2025-10-31 03:39:55,516 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.6592e-01
[rank2]:2025-10-31 03:39:55,516 - INFO -  step: 1200  loss: -2.0000  grad_norm:  0.3648  memory: 11.83GiB(24.89%)  tps: 7,521  tflops: 57.28  mfu: 18.36%
[rank2]:2025-10-31 03:39:55,516 - INFO - ðŸ”Ž  Running validation at step 1200
[rank3]:2025-10-31 03:39:55,531 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.1046e+00
[rank3]:2025-10-31 03:39:55,535 - INFO -  step: 1200  loss:  0.1856  grad_norm:  0.3648  memory: 28.00GiB(58.93%)  tps: 7,522  tflops: 57.29  mfu: 18.36%
[rank3]:2025-10-31 03:39:55,535 - INFO - ðŸ”Ž  Running validation at step 1200
[rank0]:2025-10-31 03:39:55,531 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 8.1056e-01
[rank0]:2025-10-31 03:39:55,532 - INFO -  step: 1200  loss: -2.0000  grad_norm:  0.3648  memory: 16.57GiB(34.88%)  tps: 7,521  tflops: 57.28  mfu: 18.36%
[rank0]:2025-10-31 03:39:55,532 - INFO - ðŸ”Ž  Running validation at step 1200
[rank0]:2025-10-31 03:40:15,395 - INFO - validate step: 1200  loss: -1.0000  memory: 16.57GiB(34.88%)  tps: 20,622
[rank1]:2025-10-31 03:40:15,411 - INFO - validate step: 1200  loss: -1.0000  memory: 14.66GiB(30.86%)  tps: 20,589
[rank2]:2025-10-31 03:40:15,428 - INFO - validate step: 1200  loss: -1.0000  memory: 11.83GiB(24.89%)  tps: 20,572
[rank3]:2025-10-31 03:40:15,422 - INFO - validate step: 1200  loss:  0.9441  memory: 28.00GiB(58.93%)  tps: 20,598
[rank0]:2025-10-31 03:40:15,509 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank0/251031_0340_stage0_step1200.svg
[rank1]:2025-10-31 03:40:15,512 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank1/251031_0340_stage1_step1200.svg
[rank2]:2025-10-31 03:40:15,508 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank2/251031_0340_stage2_step1200.svg
[rank3]:2025-10-31 03:40:15,614 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/pipeline_schedule/251031_0340_real_step1200_rank3.svg
[rank3]:> Batch Time: 459.61 ms, GPU Bubble Ratio: 56.40%, 59.08%, 67.50%, 14.87%
[rank3]:2025-10-31 03:40:15,684 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank3/251031_0340_stage3_step1200.svg
[rank2]:2025-10-31 03:40:16,175 - INFO - Avg. fwd time: 7.9516 / Avg. bwd time: 11.1691 / Avg. batch time: 475.6505 (ms) / GPU bubble ratio: 67.84%
[rank3]:2025-10-31 03:40:16,156 - INFO - Avg. fwd time: 11.3054 / Avg. bwd time: 37.6041 / Avg. batch time: 451.8514 (ms) / GPU bubble ratio: 13.41%
[rank0]:2025-10-31 03:40:16,217 - INFO - Avg. fwd time: 8.9275 / Avg. bwd time: 16.6726 / Avg. batch time: 533.6137 (ms) / GPU bubble ratio: 61.62%
[rank1]:2025-10-31 03:40:16,194 - INFO - Avg. fwd time: 10.3253 / Avg. bwd time: 14.1621 / Avg. batch time: 504.0731 (ms) / GPU bubble ratio: 61.14%
[rank0]:2025-10-31 03:40:26,625 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1797e+00
[rank1]:2025-10-31 03:40:26,609 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.0031e+00
[rank2]:2025-10-31 03:40:26,609 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.1778e+00
[rank3]:2025-10-31 03:40:26,625 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.1097e+00
[rank1]:2025-10-31 03:40:37,464 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 9.9814e-01
[rank2]:2025-10-31 03:40:37,464 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.3021e-01
[rank3]:2025-10-31 03:40:37,480 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.1974e+00
[rank0]:2025-10-31 03:40:37,479 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 6.4049e-01
[rank3]:2025-10-31 03:40:48,341 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.0035e-01
[rank0]:2025-10-31 03:40:48,340 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 4.7068e-01
[rank1]:2025-10-31 03:40:48,324 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.1035e+00
[rank2]:2025-10-31 03:40:48,324 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 9.1645e-01
[rank1]:2025-10-31 03:40:59,182 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.7437e+00
[rank2]:2025-10-31 03:40:59,182 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.3058e+00
[rank3]:2025-10-31 03:40:59,207 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 8.1149e-01
[rank0]:2025-10-31 03:40:59,197 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.9963e+00
[rank0]:2025-10-31 03:41:09,005 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-31 03:41:10,094 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.8569e+00
[rank1]:2025-10-31 03:41:10,094 - INFO -  step: 1250  loss: -2.0000  grad_norm:  0.2982  memory: 14.66GiB(30.86%)  tps: 7,490  tflops: 57.05  mfu: 18.28%
[rank2]:2025-10-31 03:41:10,094 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.1708e+00
[rank2]:2025-10-31 03:41:10,094 - INFO -  step: 1250  loss: -2.0000  grad_norm:  0.2982  memory: 11.83GiB(24.89%)  tps: 7,493  tflops: 57.07  mfu: 18.29%
[rank3]:2025-10-31 03:41:10,109 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.5127e+00
[rank3]:2025-10-31 03:41:10,113 - INFO -  step: 1250  loss:  0.2972  grad_norm:  0.2982  memory: 28.00GiB(58.93%)  tps: 7,490  tflops: 57.04  mfu: 18.28%
[rank0]:2025-10-31 03:41:10,109 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.8014e+00
[rank0]:2025-10-31 03:41:10,110 - INFO -  step: 1250  loss: -2.0000  grad_norm:  0.2982  memory: 16.57GiB(34.88%)  tps: 7,486  tflops: 57.02  mfu: 18.27%
[rank1]:2025-10-31 03:41:20,990 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 6.8921e-01
[rank2]:2025-10-31 03:41:20,990 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.0893e+00
[rank3]:2025-10-31 03:41:21,006 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.3044e+00
[rank0]:2025-10-31 03:41:21,006 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1611e+00
[rank2]:2025-10-31 03:41:31,871 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.6555e+00
[rank3]:2025-10-31 03:41:31,887 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.0070e+00
[rank0]:2025-10-31 03:41:31,887 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.2482e+00
[rank1]:2025-10-31 03:41:31,871 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.5892e+00
[rank2]:2025-10-31 03:41:42,768 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 6.9701e-01
[rank3]:2025-10-31 03:41:42,785 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 5.0763e-01
[rank0]:2025-10-31 03:41:42,783 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.4923e+00
[rank1]:2025-10-31 03:41:42,768 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.2437e+00
[rank0]:2025-10-31 03:41:53,736 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.4809e+00
[rank1]:2025-10-31 03:41:53,721 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 6.0398e-01
[rank2]:2025-10-31 03:41:53,721 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.9595e-01
[rank3]:2025-10-31 03:41:53,737 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.6628e-01
[rank0]:2025-10-31 03:42:03,531 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-31 03:42:04,620 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.5573e+00
[rank2]:2025-10-31 03:42:04,620 - INFO -  step: 1300  loss: -2.0000  grad_norm:  0.2875  memory: 11.83GiB(24.89%)  tps: 7,512  tflops: 57.21  mfu: 18.34%
[rank3]:2025-10-31 03:42:04,635 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.4413e+00
[rank0]:2025-10-31 03:42:04,635 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.2382e+00
[rank0]:2025-10-31 03:42:04,635 - INFO -  step: 1300  loss: -2.0000  grad_norm:  0.2875  memory: 16.57GiB(34.88%)  tps: 7,512  tflops: 57.21  mfu: 18.34%
[rank1]:2025-10-31 03:42:04,620 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.1114e+00
[rank1]:2025-10-31 03:42:04,620 - INFO -  step: 1300  loss: -2.0000  grad_norm:  0.2875  memory: 14.66GiB(30.86%)  tps: 7,512  tflops: 57.21  mfu: 18.34%
[rank3]:2025-10-31 03:42:04,638 - INFO -  step: 1300  loss:  0.2644  grad_norm:  0.2875  memory: 28.00GiB(58.93%)  tps: 7,512  tflops: 57.22  mfu: 18.34%
[rank0]:2025-10-31 03:42:04,718 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank0/251031_0342_stage0_step1300.svg
[rank1]:2025-10-31 03:42:04,738 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank1/251031_0342_stage1_step1300.svg
[rank2]:2025-10-31 03:42:04,734 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank2/251031_0342_stage2_step1300.svg
[rank3]:2025-10-31 03:42:04,824 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/pipeline_schedule/251031_0342_real_step1300_rank3.svg
[rank3]:> Batch Time: 459.33 ms, GPU Bubble Ratio: 56.37%, 59.05%, 67.48%, 14.88%
[rank3]:2025-10-31 03:42:04,897 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank3/251031_0342_stage3_step1300.svg
[rank3]:2025-10-31 03:42:05,127 - INFO - Avg. fwd time: 11.3112 / Avg. bwd time: 37.5588 / Avg. batch time: 451.4581 (ms) / GPU bubble ratio: 13.40%
[rank2]:2025-10-31 03:42:05,182 - INFO - Avg. fwd time: 7.9579 / Avg. bwd time: 11.1299 / Avg. batch time: 475.1588 (ms) / GPU bubble ratio: 67.86%
[rank0]:2025-10-31 03:42:05,211 - INFO - Avg. fwd time: 8.9330 / Avg. bwd time: 16.6102 / Avg. batch time: 532.9741 (ms) / GPU bubble ratio: 61.66%
[rank1]:2025-10-31 03:42:05,235 - INFO - Avg. fwd time: 10.3350 / Avg. bwd time: 14.0820 / Avg. batch time: 503.4974 (ms) / GPU bubble ratio: 61.20%
[rank2]:2025-10-31 03:42:15,737 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.5462e+00
[rank0]:2025-10-31 03:42:15,752 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.5146e+00
[rank1]:2025-10-31 03:42:15,737 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.6331e+00
[rank3]:2025-10-31 03:42:15,760 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.4619e+00
[rank1]:2025-10-31 03:42:26,615 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.6248e+00
[rank2]:2025-10-31 03:42:26,614 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.3198e+00
[rank3]:2025-10-31 03:42:26,630 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.2896e+00
[rank0]:2025-10-31 03:42:26,630 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 9.9944e-01
[rank2]:2025-10-31 03:42:37,570 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.7982e-01
[rank0]:2025-10-31 03:42:37,585 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 4.4935e-01
[rank1]:2025-10-31 03:42:37,570 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 3.4922e-01
[rank3]:2025-10-31 03:42:37,586 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 5.4738e-01
[rank1]:2025-10-31 03:42:48,443 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.7733e+00
[rank2]:2025-10-31 03:42:48,443 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 7.5072e-01
[rank3]:2025-10-31 03:42:48,458 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 4.4415e-01
[rank0]:2025-10-31 03:42:48,458 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.8882e+00
[rank0]:2025-10-31 03:42:58,259 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-31 03:42:59,354 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 7.8692e-01
[rank1]:2025-10-31 03:42:59,355 - INFO -  step: 1350  loss: -2.0000  grad_norm:  0.2414  memory: 14.66GiB(30.86%)  tps: 7,483  tflops: 57.00  mfu: 18.27%
[rank2]:2025-10-31 03:42:59,354 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.5560e-01
[rank2]:2025-10-31 03:42:59,355 - INFO -  step: 1350  loss: -2.0000  grad_norm:  0.2414  memory: 11.83GiB(24.89%)  tps: 7,483  tflops: 57.00  mfu: 18.27%
[rank3]:2025-10-31 03:42:59,370 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 6.1913e-01
[rank3]:2025-10-31 03:42:59,373 - INFO -  step: 1350  loss:  0.2614  grad_norm:  0.2414  memory: 28.00GiB(58.93%)  tps: 7,484  tflops: 57.00  mfu: 18.27%
[rank0]:2025-10-31 03:42:59,370 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.0601e+00
[rank0]:2025-10-31 03:42:59,370 - INFO -  step: 1350  loss: -2.0000  grad_norm:  0.2414  memory: 16.57GiB(34.88%)  tps: 7,483  tflops: 57.00  mfu: 18.27%
[rank2]:2025-10-31 03:43:10,296 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.4106e+00
[rank3]:2025-10-31 03:43:10,312 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.2643e+00
[rank0]:2025-10-31 03:43:10,311 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.9065e+00
[rank1]:2025-10-31 03:43:10,296 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.6297e+00
[rank2]:2025-10-31 03:43:21,197 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.6611e+00
[rank3]:2025-10-31 03:43:21,213 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.3139e+00
[rank0]:2025-10-31 03:43:21,212 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.6086e+00
[rank1]:2025-10-31 03:43:21,197 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 5.3281e-01
[rank1]:2025-10-31 03:43:32,072 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.6390e+00
[rank2]:2025-10-31 03:43:32,072 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.4928e-01
[rank3]:2025-10-31 03:43:32,088 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.4478e-01
[rank0]:2025-10-31 03:43:32,088 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 8.2062e-01
[rank2]:2025-10-31 03:43:42,949 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 9.6237e-01
[rank3]:2025-10-31 03:43:42,964 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.3272e+00
[rank0]:2025-10-31 03:43:42,964 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 4.4583e-01
[rank1]:2025-10-31 03:43:42,949 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.1298e+00
[rank0]:2025-10-31 03:43:52,719 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-31 03:43:53,807 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.5893e-01
[rank1]:2025-10-31 03:43:53,808 - INFO -  step: 1400  loss: -2.0000  grad_norm:  0.3864  memory: 14.66GiB(30.86%)  tps: 7,522  tflops: 57.29  mfu: 18.36%
[rank1]:2025-10-31 03:43:53,808 - INFO - ðŸ”Ž  Running validation at step 1400
[rank2]:2025-10-31 03:43:53,807 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 8.5809e-01
[rank2]:2025-10-31 03:43:53,808 - INFO -  step: 1400  loss: -2.0000  grad_norm:  0.3864  memory: 11.83GiB(24.89%)  tps: 7,522  tflops: 57.29  mfu: 18.36%
[rank2]:2025-10-31 03:43:53,808 - INFO - ðŸ”Ž  Running validation at step 1400
[rank3]:2025-10-31 03:43:53,823 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.2899e+00
[rank3]:2025-10-31 03:43:53,827 - INFO -  step: 1400  loss:  0.2302  grad_norm:  0.3864  memory: 28.00GiB(58.93%)  tps: 7,522  tflops: 57.29  mfu: 18.36%
[rank3]:2025-10-31 03:43:53,827 - INFO - ðŸ”Ž  Running validation at step 1400
[rank0]:2025-10-31 03:43:53,823 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.4765e+00
[rank0]:2025-10-31 03:43:53,823 - INFO -  step: 1400  loss: -2.0000  grad_norm:  0.3864  memory: 16.57GiB(34.88%)  tps: 7,522  tflops: 57.29  mfu: 18.36%
[rank0]:2025-10-31 03:43:53,823 - INFO - ðŸ”Ž  Running validation at step 1400
[rank0]:2025-10-31 03:44:13,816 - INFO - validate step: 1400  loss: -1.0000  memory: 16.57GiB(34.88%)  tps: 20,487
[rank1]:2025-10-31 03:44:13,835 - INFO - validate step: 1400  loss: -1.0000  memory: 14.66GiB(30.86%)  tps: 20,453
[rank2]:2025-10-31 03:44:13,850 - INFO - validate step: 1400  loss: -1.0000  memory: 11.83GiB(24.89%)  tps: 20,437
[rank3]:2025-10-31 03:44:13,844 - INFO - validate step: 1400  loss:  0.9467  memory: 28.00GiB(58.93%)  tps: 20,464
[rank0]:2025-10-31 03:44:13,934 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank0/251031_0344_stage0_step1400.svg
[rank1]:2025-10-31 03:44:13,938 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank1/251031_0344_stage1_step1400.svg
[rank2]:2025-10-31 03:44:13,934 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank2/251031_0344_stage2_step1400.svg
[rank3]:2025-10-31 03:44:14,039 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/pipeline_schedule/251031_0344_real_step1400_rank3.svg
[rank3]:> Batch Time: 459.18 ms, GPU Bubble Ratio: 56.35%, 59.04%, 67.47%, 14.88%
[rank3]:2025-10-31 03:44:14,112 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank3/251031_0344_stage3_step1400.svg
[rank3]:2025-10-31 03:44:14,345 - INFO - Avg. fwd time: 11.3166 / Avg. bwd time: 37.5186 / Avg. batch time: 451.1035 (ms) / GPU bubble ratio: 13.39%
[rank0]:2025-10-31 03:44:14,428 - INFO - Avg. fwd time: 8.9385 / Avg. bwd time: 16.5477 / Avg. batch time: 532.4218 (ms) / GPU bubble ratio: 61.71%
[rank1]:2025-10-31 03:44:14,451 - INFO - Avg. fwd time: 10.3447 / Avg. bwd time: 14.0011 / Avg. batch time: 503.0082 (ms) / GPU bubble ratio: 61.28%
[rank2]:2025-10-31 03:44:14,399 - INFO - Avg. fwd time: 7.9643 / Avg. bwd time: 11.0906 / Avg. batch time: 474.7550 (ms) / GPU bubble ratio: 67.89%
[rank2]:2025-10-31 03:44:24,994 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.8289e-01
[rank3]:2025-10-31 03:44:25,010 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 6.4315e-01
[rank0]:2025-10-31 03:44:25,010 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1889e+00
[rank1]:2025-10-31 03:44:24,994 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.0619e-01
[rank1]:2025-10-31 03:44:35,890 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.5591e+00
[rank2]:2025-10-31 03:44:35,890 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.9163e-01
[rank3]:2025-10-31 03:44:35,906 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 4.0853e-01
[rank0]:2025-10-31 03:44:35,906 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 4.3770e-01
[rank0]:2025-10-31 03:44:46,783 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1698e+00
[rank1]:2025-10-31 03:44:46,768 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.9350e-01
[rank2]:2025-10-31 03:44:46,768 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.5967e-01
[rank3]:2025-10-31 03:44:46,783 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 5.3608e-01
[rank1]:2025-10-31 03:44:57,703 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 8.9530e-01
[rank2]:2025-10-31 03:44:57,703 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.5836e+00
[rank3]:2025-10-31 03:44:57,719 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.6916e+00
[rank0]:2025-10-31 03:44:57,719 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 4.3570e-01
[rank0]:2025-10-31 03:45:07,572 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-31 03:45:08,661 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.7344e+00
[rank2]:2025-10-31 03:45:08,661 - INFO -  step: 1450  loss: -2.0000  grad_norm:  0.3277  memory: 11.83GiB(24.89%)  tps: 7,473  tflops: 56.92  mfu: 18.24%
[rank3]:2025-10-31 03:45:08,676 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.6493e+00
[rank3]:2025-10-31 03:45:08,679 - INFO -  step: 1450  loss:  0.2368  grad_norm:  0.3277  memory: 28.00GiB(58.93%)  tps: 7,470  tflops: 56.89  mfu: 18.23%
[rank0]:2025-10-31 03:45:08,676 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.8499e+00
[rank0]:2025-10-31 03:45:08,676 - INFO -  step: 1450  loss: -2.0000  grad_norm:  0.3277  memory: 16.57GiB(34.88%)  tps: 7,466  tflops: 56.87  mfu: 18.23%
[rank1]:2025-10-31 03:45:08,661 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.3640e+00
[rank1]:2025-10-31 03:45:08,661 - INFO -  step: 1450  loss: -2.0000  grad_norm:  0.3277  memory: 14.66GiB(30.86%)  tps: 7,471  tflops: 56.90  mfu: 18.24%
[rank2]:2025-10-31 03:45:19,579 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.3971e+00
[rank3]:2025-10-31 03:45:19,595 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.4310e+00
[rank0]:2025-10-31 03:45:19,595 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.0656e+00
[rank1]:2025-10-31 03:45:19,579 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 3.0365e+00
[rank2]:2025-10-31 03:45:30,494 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.5911e+00
[rank3]:2025-10-31 03:45:30,510 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.2098e+00
[rank0]:2025-10-31 03:45:30,510 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 9.3077e-01
[rank1]:2025-10-31 03:45:30,495 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.1760e+00
[rank0]:2025-10-31 03:45:41,450 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.3177e+00
[rank1]:2025-10-31 03:45:41,435 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.4334e+00
[rank2]:2025-10-31 03:45:41,435 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.1025e+00
[rank3]:2025-10-31 03:45:41,451 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.1614e+00
[rank1]:2025-10-31 03:45:52,368 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.5262e+00
[rank2]:2025-10-31 03:45:52,367 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.6074e+00
[rank3]:2025-10-31 03:45:52,384 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 3.3439e+00
[rank0]:2025-10-31 03:45:52,383 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.2825e+00
[rank0]:2025-10-31 03:46:02,160 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-31 03:46:03,261 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 7.9191e-01
[rank3]:2025-10-31 03:46:03,263 - INFO -  step: 1500  loss:  0.2749  grad_norm:  0.2918  memory: 28.00GiB(58.93%)  tps: 7,504  tflops: 57.15  mfu: 18.32%
[rank0]:2025-10-31 03:46:03,260 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.9724e+00
[rank0]:2025-10-31 03:46:03,261 - INFO -  step: 1500  loss: -2.0000  grad_norm:  0.2918  memory: 16.57GiB(34.88%)  tps: 7,504  tflops: 57.15  mfu: 18.32%
[rank1]:2025-10-31 03:46:03,245 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.6399e-01
[rank1]:2025-10-31 03:46:03,245 - INFO -  step: 1500  loss: -2.0000  grad_norm:  0.2918  memory: 14.66GiB(30.86%)  tps: 7,504  tflops: 57.15  mfu: 18.32%
[rank2]:2025-10-31 03:46:03,245 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.0220e+00
[rank2]:2025-10-31 03:46:03,245 - INFO -  step: 1500  loss: -2.0000  grad_norm:  0.2918  memory: 11.83GiB(24.89%)  tps: 7,504  tflops: 57.15  mfu: 18.32%
[rank0]:2025-10-31 03:46:03,349 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank0/251031_0346_stage0_step1500.svg
[rank1]:2025-10-31 03:46:03,353 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank1/251031_0346_stage1_step1500.svg
[rank2]:2025-10-31 03:46:03,349 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank2/251031_0346_stage2_step1500.svg
[rank3]:2025-10-31 03:46:03,454 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/pipeline_schedule/251031_0346_real_step1500_rank3.svg
[rank3]:> Batch Time: 459.09 ms, GPU Bubble Ratio: 56.35%, 59.03%, 67.47%, 14.89%
[rank3]:2025-10-31 03:46:03,528 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank3/251031_0346_stage3_step1500.svg
[rank2]:2025-10-31 03:46:04,000 - INFO - Avg. fwd time: 7.9699 / Avg. bwd time: 11.0572 / Avg. batch time: 474.4977 (ms) / GPU bubble ratio: 67.92%
[rank3]:2025-10-31 03:46:03,982 - INFO - Avg. fwd time: 11.3223 / Avg. bwd time: 37.4874 / Avg. batch time: 450.8344 (ms) / GPU bubble ratio: 13.39%
[rank0]:2025-10-31 03:46:04,043 - INFO - Avg. fwd time: 8.9435 / Avg. bwd time: 16.4939 / Avg. batch time: 532.0378 (ms) / GPU bubble ratio: 61.75%
[rank1]:2025-10-31 03:46:04,020 - INFO - Avg. fwd time: 10.3529 / Avg. bwd time: 13.9322 / Avg. batch time: 502.6790 (ms) / GPU bubble ratio: 61.35%
[rank2]:2025-10-31 03:46:14,347 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 8.1134e-01
[rank3]:2025-10-31 03:46:14,364 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 8.9154e-01
[rank0]:2025-10-31 03:46:14,363 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 5.9955e-01
[rank1]:2025-10-31 03:46:14,347 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 4.5043e-01
[rank2]:2025-10-31 03:46:25,265 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.2740e+00
[rank3]:2025-10-31 03:46:25,282 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.2313e+00
[rank0]:2025-10-31 03:46:25,281 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.7833e+00
[rank1]:2025-10-31 03:46:25,265 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.8932e+00
[rank1]:2025-10-31 03:46:36,153 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.2314e+00
[rank2]:2025-10-31 03:46:36,153 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.5007e+00
[rank3]:2025-10-31 03:46:36,169 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.8943e+00
[rank0]:2025-10-31 03:46:36,168 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.5084e+00
[rank2]:2025-10-31 03:46:47,002 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 8.3533e-01
[rank3]:2025-10-31 03:46:47,017 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 7.3966e-01
[rank0]:2025-10-31 03:46:47,017 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1630e+00
[rank1]:2025-10-31 03:46:47,002 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.8175e+00
[rank0]:2025-10-31 03:46:56,807 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-31 03:46:57,891 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.0519e+00
[rank2]:2025-10-31 03:46:57,892 - INFO -  step: 1550  loss: -2.0000  grad_norm:  0.2500  memory: 11.83GiB(24.89%)  tps: 7,495  tflops: 57.09  mfu: 18.30%
[rank3]:2025-10-31 03:46:57,915 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 8.5227e-01
[rank3]:2025-10-31 03:46:57,918 - INFO -  step: 1550  loss:  0.2286  grad_norm:  0.2500  memory: 28.00GiB(58.93%)  tps: 7,494  tflops: 57.08  mfu: 18.29%
[rank0]:2025-10-31 03:46:57,906 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 8.3078e-01
[rank0]:2025-10-31 03:46:57,907 - INFO -  step: 1550  loss: -2.0000  grad_norm:  0.2500  memory: 16.57GiB(34.88%)  tps: 7,496  tflops: 57.09  mfu: 18.30%
[rank1]:2025-10-31 03:46:57,891 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 7.6848e-01
[rank1]:2025-10-31 03:46:57,891 - INFO -  step: 1550  loss: -2.0000  grad_norm:  0.2500  memory: 14.66GiB(30.86%)  tps: 7,496  tflops: 57.09  mfu: 18.30%
[rank2]:2025-10-31 03:47:08,823 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.0814e-01
[rank3]:2025-10-31 03:47:08,839 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 5.0407e-01
[rank0]:2025-10-31 03:47:08,839 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 9.5896e-01
[rank1]:2025-10-31 03:47:08,823 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 7.9220e-01
[rank2]:2025-10-31 03:47:19,724 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.2223e+00
[rank3]:2025-10-31 03:47:19,740 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.1746e+00
[rank0]:2025-10-31 03:47:19,740 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.7581e+00
[rank1]:2025-10-31 03:47:19,724 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 4.2183e-01
[rank2]:2025-10-31 03:47:30,655 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 8.9307e-01
[rank3]:2025-10-31 03:47:30,670 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.1918e+00
[rank0]:2025-10-31 03:47:30,670 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 9.1216e-01
[rank1]:2025-10-31 03:47:30,655 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 3.3174e-01
[rank0]:2025-10-31 03:47:41,612 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1598e+00
[rank1]:2025-10-31 03:47:41,597 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 4.7825e-01
[rank2]:2025-10-31 03:47:41,596 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.0623e-01
[rank3]:2025-10-31 03:47:41,612 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 4.3317e-01
[rank0]:2025-10-31 03:47:51,468 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-31 03:47:52,563 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 7.5022e-01
[rank2]:2025-10-31 03:47:52,564 - INFO -  step: 1600  loss: -2.0000  grad_norm:  0.3935  memory: 11.83GiB(24.89%)  tps: 7,492  tflops: 57.06  mfu: 18.29%
[rank2]:2025-10-31 03:47:52,564 - INFO - ðŸ”Ž  Running validation at step 1600
[rank3]:2025-10-31 03:47:52,579 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.1065e+00
[rank3]:2025-10-31 03:47:52,582 - INFO -  step: 1600  loss:  0.1961  grad_norm:  0.3935  memory: 28.00GiB(58.93%)  tps: 7,493  tflops: 57.07  mfu: 18.29%
[rank3]:2025-10-31 03:47:52,582 - INFO - ðŸ”Ž  Running validation at step 1600
[rank0]:2025-10-31 03:47:52,579 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 9.9405e-01
[rank0]:2025-10-31 03:47:52,579 - INFO -  step: 1600  loss: -2.0000  grad_norm:  0.3935  memory: 16.57GiB(34.88%)  tps: 7,492  tflops: 57.06  mfu: 18.29%
[rank0]:2025-10-31 03:47:52,579 - INFO - ðŸ”Ž  Running validation at step 1600
[rank1]:2025-10-31 03:47:52,564 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 6.3667e-01
[rank1]:2025-10-31 03:47:52,565 - INFO -  step: 1600  loss: -2.0000  grad_norm:  0.3935  memory: 14.66GiB(30.86%)  tps: 7,492  tflops: 57.06  mfu: 18.29%
[rank1]:2025-10-31 03:47:52,565 - INFO - ðŸ”Ž  Running validation at step 1600
[rank3]:2025-10-31 03:48:12,732 - INFO - validate step: 1600  loss:  0.9468  memory: 28.00GiB(58.93%)  tps: 20,330
[rank3]:2025-10-31 03:48:12,733 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-31 03:48:12,704 - INFO - validate step: 1600  loss: -1.0000  memory: 16.57GiB(34.88%)  tps: 20,354
[rank0]:2025-10-31 03:48:12,705 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-31 03:48:12,713 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank1]:2025-10-31 03:48:12,721 - INFO - validate step: 1600  loss: -1.0000  memory: 14.66GiB(30.86%)  tps: 20,321
[rank1]:2025-10-31 03:48:12,722 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-31 03:48:12,739 - INFO - validate step: 1600  loss: -1.0000  memory: 11.83GiB(24.89%)  tps: 20,302
[rank2]:2025-10-31 03:48:12,740 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-31 03:48:14,605 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 1.86 seconds.
[rank1]:2025-10-31 03:48:14,843 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 2.12 seconds.
[rank3]:2025-10-31 03:48:16,015 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.28 seconds.
[rank0]:2025-10-31 03:48:16,307 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-31 03:48:16,314 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.61 seconds.
[rank2]:2025-10-31 03:48:16,410 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank2/251031_0348_stage2_step1600.svg
[rank1]:2025-10-31 03:48:16,411 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank1/251031_0348_stage1_step1600.svg
[rank0]:2025-10-31 03:48:16,602 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank0/251031_0348_stage0_step1600.svg
[rank3]:2025-10-31 03:48:16,706 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/pipeline_schedule/251031_0348_real_step1600_rank3.svg
[rank3]:> Batch Time: 458.93 ms, GPU Bubble Ratio: 56.33%, 59.02%, 67.46%, 14.89%
[rank3]:2025-10-31 03:48:16,798 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank3/251031_0348_stage3_step1600.svg
[rank3]:2025-10-31 03:48:17,043 - INFO - Avg. fwd time: 11.3273 / Avg. bwd time: 37.4604 / Avg. batch time: 450.6094 (ms) / GPU bubble ratio: 13.38%
[rank2]:2025-10-31 03:48:17,100 - INFO - Avg. fwd time: 7.9740 / Avg. bwd time: 11.0320 / Avg. batch time: 474.2007 (ms) / GPU bubble ratio: 67.94%
[rank0]:2025-10-31 03:48:17,129 - INFO - Avg. fwd time: 8.9473 / Avg. bwd time: 16.4536 / Avg. batch time: 531.6410 (ms) / GPU bubble ratio: 61.78%
[rank1]:2025-10-31 03:48:17,150 - INFO - Avg. fwd time: 10.3587 / Avg. bwd time: 13.8798 / Avg. batch time: 502.3253 (ms) / GPU bubble ratio: 61.40%
[rank2]:2025-10-31 03:48:27,718 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 9.6378e-01
[rank3]:2025-10-31 03:48:27,734 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.2313e+00
[rank0]:2025-10-31 03:48:27,733 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1634e+00
[rank1]:2025-10-31 03:48:27,718 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.1795e+00
[rank1]:2025-10-31 03:48:38,617 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.1297e+00
[rank2]:2025-10-31 03:48:38,617 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.0872e+00
[rank3]:2025-10-31 03:48:38,633 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.5119e+00
[rank0]:2025-10-31 03:48:38,632 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.2263e+00
[rank3]:2025-10-31 03:48:39,998 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-31 03:48:40,229 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-31 03:48:40,262 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-31 03:48:40,243 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-31 03:48:49,496 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.1894e+00
[rank2]:2025-10-31 03:48:49,496 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 9.2186e-01
[rank3]:2025-10-31 03:48:49,512 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 9.0788e-01
[rank0]:2025-10-31 03:48:49,511 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.7314e+00
[rank1]:2025-10-31 03:49:00,353 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 9.5155e-01
[rank2]:2025-10-31 03:49:00,353 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.0150e+00
[rank3]:2025-10-31 03:49:00,369 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 9.4811e-01
[rank0]:2025-10-31 03:49:00,369 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.6056e+00
[rank0]:2025-10-31 03:49:10,426 - INFO - [GC] Peforming periodical GC collection 0.26 seconds
[rank3]:2025-10-31 03:49:11,515 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 7.5555e-01
[rank3]:2025-10-31 03:49:11,518 - INFO -  step: 1650  loss:  0.2824  grad_norm:  0.3007  memory: 28.00GiB(58.93%)  tps: 6,968  tflops: 53.07  mfu: 17.01%
[rank0]:2025-10-31 03:49:11,514 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 4.6706e-01
[rank0]:2025-10-31 03:49:11,515 - INFO -  step: 1650  loss: -2.0000  grad_norm:  0.3007  memory: 16.57GiB(34.88%)  tps: 6,965  tflops: 53.04  mfu: 17.00%
[rank1]:2025-10-31 03:49:11,499 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 6.0388e-01
[rank1]:2025-10-31 03:49:11,499 - INFO -  step: 1650  loss: -2.0000  grad_norm:  0.3007  memory: 14.66GiB(30.86%)  tps: 6,969  tflops: 53.07  mfu: 17.01%
[rank2]:2025-10-31 03:49:11,499 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 7.8394e-01
[rank2]:2025-10-31 03:49:11,500 - INFO -  step: 1650  loss: -2.0000  grad_norm:  0.3007  memory: 11.83GiB(24.89%)  tps: 6,971  tflops: 53.09  mfu: 17.02%
[rank0]:2025-10-31 03:49:22,353 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.7602e+00
[rank1]:2025-10-31 03:49:22,338 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.1381e+00
[rank2]:2025-10-31 03:49:22,338 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.8741e-01
[rank3]:2025-10-31 03:49:22,354 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 5.5390e-01
[rank2]:2025-10-31 03:49:33,207 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 6.4666e-01
[rank3]:2025-10-31 03:49:33,224 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 6.8896e-01
[rank0]:2025-10-31 03:49:33,223 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.4157e+00
[rank1]:2025-10-31 03:49:33,207 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 6.4502e-01
[rank3]:2025-10-31 03:49:44,163 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.0380e+00
[rank0]:2025-10-31 03:49:44,163 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.6285e+00
[rank1]:2025-10-31 03:49:44,147 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.0171e+00
[rank2]:2025-10-31 03:49:44,147 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.0448e+00
[rank3]:2025-10-31 03:49:55,066 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 8.5105e-01
[rank0]:2025-10-31 03:49:55,066 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 4.3133e-01
[rank1]:2025-10-31 03:49:55,050 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 4.4797e-01
[rank2]:2025-10-31 03:49:55,050 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.6553e-01
[rank0]:2025-10-31 03:50:04,851 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-31 03:50:05,950 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.4871e+00
[rank2]:2025-10-31 03:50:05,950 - INFO -  step: 1700  loss: -2.0000  grad_norm:  0.2970  memory: 11.83GiB(24.89%)  tps: 7,522  tflops: 57.29  mfu: 18.36%
[rank3]:2025-10-31 03:50:05,965 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.3967e+00
[rank3]:2025-10-31 03:50:05,969 - INFO -  step: 1700  loss:  0.2484  grad_norm:  0.2970  memory: 28.00GiB(58.93%)  tps: 7,523  tflops: 57.29  mfu: 18.36%
[rank0]:2025-10-31 03:50:05,965 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.5110e+00
[rank0]:2025-10-31 03:50:05,965 - INFO -  step: 1700  loss: -2.0000  grad_norm:  0.2970  memory: 16.57GiB(34.88%)  tps: 7,522  tflops: 57.29  mfu: 18.36%
[rank1]:2025-10-31 03:50:05,950 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 4.5706e+00
[rank1]:2025-10-31 03:50:05,950 - INFO -  step: 1700  loss: -2.0000  grad_norm:  0.2970  memory: 14.66GiB(30.86%)  tps: 7,522  tflops: 57.29  mfu: 18.36%
[rank2]:2025-10-31 03:50:06,056 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank2/251031_0350_stage2_step1700.svg
[rank0]:2025-10-31 03:50:06,056 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank0/251031_0350_stage0_step1700.svg
[rank1]:2025-10-31 03:50:06,058 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank1/251031_0350_stage1_step1700.svg
[rank3]:2025-10-31 03:50:06,160 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/pipeline_schedule/251031_0350_real_step1700_rank3.svg
[rank3]:> Batch Time: 458.84 ms, GPU Bubble Ratio: 56.32%, 59.02%, 67.45%, 14.89%
[rank3]:2025-10-31 03:50:06,235 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank3/251031_0350_stage3_step1700.svg
[rank3]:2025-10-31 03:50:06,471 - INFO - Avg. fwd time: 11.3306 / Avg. bwd time: 37.4310 / Avg. batch time: 450.3569 (ms) / GPU bubble ratio: 13.38%
[rank2]:2025-10-31 03:50:06,527 - INFO - Avg. fwd time: 7.9782 / Avg. bwd time: 11.0057 / Avg. batch time: 473.9123 (ms) / GPU bubble ratio: 67.95%
[rank0]:2025-10-31 03:50:06,556 - INFO - Avg. fwd time: 8.9533 / Avg. bwd time: 16.4116 / Avg. batch time: 531.2600 (ms) / GPU bubble ratio: 61.80%
[rank1]:2025-10-31 03:50:06,579 - INFO - Avg. fwd time: 10.3645 / Avg. bwd time: 13.8258 / Avg. batch time: 501.9809 (ms) / GPU bubble ratio: 61.45%
[rank1]:2025-10-31 03:50:17,048 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.2720e+00
[rank2]:2025-10-31 03:50:17,048 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.4509e+00
[rank3]:2025-10-31 03:50:17,070 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.1737e+00
[rank0]:2025-10-31 03:50:17,063 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.8600e+00
[rank1]:2025-10-31 03:50:28,022 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 5.6198e-01
[rank2]:2025-10-31 03:50:28,022 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.4826e+00
[rank3]:2025-10-31 03:50:28,038 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.5090e+00
[rank0]:2025-10-31 03:50:28,038 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 7.8130e-01
[rank1]:2025-10-31 03:50:38,959 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.5574e-01
[rank2]:2025-10-31 03:50:38,958 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.4507e-01
[rank3]:2025-10-31 03:50:38,974 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 6.6413e-01
[rank0]:2025-10-31 03:50:38,974 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 5.5839e-01
[rank0]:2025-10-31 03:50:49,852 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 8.9580e-01
[rank3]:2025-10-31 03:50:49,852 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.0831e+00
[rank1]:2025-10-31 03:50:49,837 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 4.1662e-01
[rank2]:2025-10-31 03:50:49,837 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.0223e-01
[rank0]:2025-10-31 03:50:59,628 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-31 03:51:00,715 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 3.8197e-01
[rank1]:2025-10-31 03:51:00,715 - INFO -  step: 1750  loss: -2.0000  grad_norm:  0.2431  memory: 14.66GiB(30.86%)  tps: 7,479  tflops: 56.96  mfu: 18.26%
[rank2]:2025-10-31 03:51:00,714 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.1064e-01
[rank2]:2025-10-31 03:51:00,715 - INFO -  step: 1750  loss: -2.0000  grad_norm:  0.2431  memory: 11.83GiB(24.89%)  tps: 7,479  tflops: 56.96  mfu: 18.26%
[rank0]:2025-10-31 03:51:00,730 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.6930e-01
[rank0]:2025-10-31 03:51:00,730 - INFO -  step: 1750  loss: -2.0000  grad_norm:  0.2431  memory: 16.57GiB(34.88%)  tps: 7,479  tflops: 56.96  mfu: 18.26%
[rank3]:2025-10-31 03:51:00,737 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 3.6700e-01
[rank3]:2025-10-31 03:51:00,741 - INFO -  step: 1750  loss:  0.2040  grad_norm:  0.2431  memory: 28.00GiB(58.93%)  tps: 7,479  tflops: 56.96  mfu: 18.26%
[rank1]:2025-10-31 03:51:11,593 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.7047e+00
[rank2]:2025-10-31 03:51:11,593 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.9396e+00
[rank0]:2025-10-31 03:51:11,608 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.7234e+00
[rank3]:2025-10-31 03:51:11,608 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.8462e+00
[rank3]:2025-10-31 03:51:22,503 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.2625e+00
[rank1]:2025-10-31 03:51:22,487 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.0193e+00
[rank2]:2025-10-31 03:51:22,486 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.5966e+00
[rank0]:2025-10-31 03:51:22,502 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.1145e+00
[rank1]:2025-10-31 03:51:33,339 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 5.2266e-01
[rank2]:2025-10-31 03:51:33,339 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 6.9997e-01
[rank0]:2025-10-31 03:51:33,354 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 6.2304e-01
[rank3]:2025-10-31 03:51:33,355 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.6166e+00
[rank1]:2025-10-31 03:51:44,255 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 3.4286e-01
[rank2]:2025-10-31 03:51:44,255 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.7618e-01
[rank0]:2025-10-31 03:51:44,270 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 5.4020e-01
[rank3]:2025-10-31 03:51:44,270 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 6.4640e-01
[rank0]:2025-10-31 03:51:54,089 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-31 03:51:55,191 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 6.7783e-01
[rank1]:2025-10-31 03:51:55,192 - INFO -  step: 1800  loss: -2.0000  grad_norm:  0.3745  memory: 14.66GiB(30.86%)  tps: 7,519  tflops: 57.27  mfu: 18.35%
[rank1]:2025-10-31 03:51:55,192 - INFO - ðŸ”Ž  Running validation at step 1800
[rank2]:2025-10-31 03:51:55,191 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.6013e-01
[rank2]:2025-10-31 03:51:55,191 - INFO -  step: 1800  loss: -2.0000  grad_norm:  0.3745  memory: 11.83GiB(24.89%)  tps: 7,519  tflops: 57.27  mfu: 18.35%
[rank2]:2025-10-31 03:51:55,191 - INFO - ðŸ”Ž  Running validation at step 1800
[rank0]:2025-10-31 03:51:55,206 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 8.7830e-01
[rank0]:2025-10-31 03:51:55,207 - INFO -  step: 1800  loss: -2.0000  grad_norm:  0.3745  memory: 16.57GiB(34.88%)  tps: 7,519  tflops: 57.27  mfu: 18.35%
[rank0]:2025-10-31 03:51:55,207 - INFO - ðŸ”Ž  Running validation at step 1800
[rank3]:2025-10-31 03:51:55,207 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.1081e+00
[rank3]:2025-10-31 03:51:55,210 - INFO -  step: 1800  loss:  0.1862  grad_norm:  0.3745  memory: 28.00GiB(58.93%)  tps: 7,520  tflops: 57.27  mfu: 18.36%
[rank3]:2025-10-31 03:51:55,211 - INFO - ðŸ”Ž  Running validation at step 1800
[rank1]:2025-10-31 03:52:15,194 - INFO - validate step: 1800  loss: -1.0000  memory: 14.66GiB(30.86%)  tps: 20,478
[rank2]:2025-10-31 03:52:15,212 - INFO - validate step: 1800  loss: -1.0000  memory: 11.83GiB(24.89%)  tps: 20,460
[rank0]:2025-10-31 03:52:15,177 - INFO - validate step: 1800  loss: -1.0000  memory: 16.57GiB(34.88%)  tps: 20,511
[rank3]:2025-10-31 03:52:15,204 - INFO - validate step: 1800  loss:  0.9510  memory: 28.00GiB(58.93%)  tps: 20,488
[rank1]:2025-10-31 03:52:15,301 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank1/251031_0352_stage1_step1800.svg
[rank2]:2025-10-31 03:52:15,299 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank2/251031_0352_stage2_step1800.svg
[rank0]:2025-10-31 03:52:15,299 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank0/251031_0352_stage0_step1800.svg
[rank3]:2025-10-31 03:52:15,401 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/pipeline_schedule/251031_0352_real_step1800_rank3.svg
[rank3]:> Batch Time: 458.68 ms, GPU Bubble Ratio: 56.30%, 59.00%, 67.44%, 14.90%
[rank3]:2025-10-31 03:52:15,475 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank3/251031_0352_stage3_step1800.svg
[rank3]:2025-10-31 03:52:15,950 - INFO - Avg. fwd time: 11.3354 / Avg. bwd time: 37.4052 / Avg. batch time: 450.1430 (ms) / GPU bubble ratio: 13.38%
[rank1]:2025-10-31 03:52:15,990 - INFO - Avg. fwd time: 10.3703 / Avg. bwd time: 13.7784 / Avg. batch time: 501.7330 (ms) / GPU bubble ratio: 61.50%
[rank2]:2025-10-31 03:52:15,969 - INFO - Avg. fwd time: 7.9821 / Avg. bwd time: 10.9827 / Avg. batch time: 473.7143 (ms) / GPU bubble ratio: 67.97%
[rank0]:2025-10-31 03:52:16,014 - INFO - Avg. fwd time: 8.9574 / Avg. bwd time: 16.3749 / Avg. batch time: 530.9767 (ms) / GPU bubble ratio: 61.83%
[rank1]:2025-10-31 03:52:26,386 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 8.4479e-01
[rank2]:2025-10-31 03:52:26,386 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.4722e+00
[rank0]:2025-10-31 03:52:26,401 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.5999e+00
[rank3]:2025-10-31 03:52:26,402 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.5534e+00
[rank2]:2025-10-31 03:52:37,261 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.2711e+00
[rank0]:2025-10-31 03:52:37,276 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.7319e+00
[rank3]:2025-10-31 03:52:37,276 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 9.2027e-01
[rank1]:2025-10-31 03:52:37,261 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.4054e+00
[rank1]:2025-10-31 03:52:48,143 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.0296e+00
[rank2]:2025-10-31 03:52:48,143 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.6278e-01
[rank0]:2025-10-31 03:52:48,158 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 7.0411e-01
[rank3]:2025-10-31 03:52:48,159 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 3.8304e-01
[rank1]:2025-10-31 03:52:59,058 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 5.3519e-01
[rank2]:2025-10-31 03:52:59,058 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 6.3062e-01
[rank0]:2025-10-31 03:52:59,073 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 4.8669e-01
[rank3]:2025-10-31 03:52:59,073 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 6.9520e-01
[rank0]:2025-10-31 03:53:08,898 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-31 03:53:09,993 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 6.6538e-01
[rank1]:2025-10-31 03:53:09,993 - INFO -  step: 1850  loss: -2.0000  grad_norm:  0.3547  memory: 14.66GiB(30.86%)  tps: 7,475  tflops: 56.93  mfu: 18.25%
[rank2]:2025-10-31 03:53:09,993 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.2733e+00
[rank2]:2025-10-31 03:53:09,993 - INFO -  step: 1850  loss: -2.0000  grad_norm:  0.3547  memory: 11.83GiB(24.89%)  tps: 7,477  tflops: 56.95  mfu: 18.25%
[rank0]:2025-10-31 03:53:10,008 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.6348e+00
[rank0]:2025-10-31 03:53:10,009 - INFO -  step: 1850  loss: -2.0000  grad_norm:  0.3547  memory: 16.57GiB(34.88%)  tps: 7,470  tflops: 56.89  mfu: 18.24%
[rank3]:2025-10-31 03:53:10,008 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.3769e+00
[rank3]:2025-10-31 03:53:10,011 - INFO -  step: 1850  loss:  0.2870  grad_norm:  0.3547  memory: 28.00GiB(58.93%)  tps: 7,474  tflops: 56.92  mfu: 18.24%
[rank3]:2025-10-31 03:53:20,866 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 8.1170e-01
[rank1]:2025-10-31 03:53:20,851 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 5.7482e-01
[rank2]:2025-10-31 03:53:20,851 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.8524e-01
[rank0]:2025-10-31 03:53:20,866 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 8.1910e-01
[rank1]:2025-10-31 03:53:31,773 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.1499e+00
[rank2]:2025-10-31 03:53:31,773 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.4675e+00
[rank0]:2025-10-31 03:53:31,789 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.8197e+00
[rank3]:2025-10-31 03:53:31,789 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.3717e+00
[rank1]:2025-10-31 03:53:42,647 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.3287e+00
[rank2]:2025-10-31 03:53:42,647 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.8676e+00
[rank3]:2025-10-31 03:53:42,672 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.5295e+00
[rank0]:2025-10-31 03:53:42,663 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.7411e+00
[rank1]:2025-10-31 03:53:53,518 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 4.1284e-01
[rank2]:2025-10-31 03:53:53,518 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.7371e-01
[rank0]:2025-10-31 03:53:53,533 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 6.1673e-01
[rank3]:2025-10-31 03:53:53,533 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 9.9034e-01
[rank0]:2025-10-31 03:54:03,354 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-31 03:54:04,428 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.0494e+00
[rank1]:2025-10-31 03:54:04,428 - INFO -  step: 1900  loss: -2.0000  grad_norm:  0.2654  memory: 14.66GiB(30.86%)  tps: 7,525  tflops: 57.31  mfu: 18.37%
[rank2]:2025-10-31 03:54:04,428 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 6.0325e-01
[rank2]:2025-10-31 03:54:04,428 - INFO -  step: 1900  loss: -2.0000  grad_norm:  0.2654  memory: 11.83GiB(24.89%)  tps: 7,525  tflops: 57.31  mfu: 18.37%
[rank0]:2025-10-31 03:54:04,443 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.1549e+00
[rank0]:2025-10-31 03:54:04,444 - INFO -  step: 1900  loss: -2.0000  grad_norm:  0.2654  memory: 16.57GiB(34.88%)  tps: 7,525  tflops: 57.31  mfu: 18.37%
[rank3]:2025-10-31 03:54:04,444 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 9.0786e-01
[rank3]:2025-10-31 03:54:04,446 - INFO -  step: 1900  loss:  0.2064  grad_norm:  0.2654  memory: 28.00GiB(58.93%)  tps: 7,525  tflops: 57.31  mfu: 18.37%
[rank1]:2025-10-31 03:54:04,535 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank1/251031_0354_stage1_step1900.svg
[rank2]:2025-10-31 03:54:04,531 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank2/251031_0354_stage2_step1900.svg
[rank0]:2025-10-31 03:54:04,532 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank0/251031_0354_stage0_step1900.svg
[rank3]:2025-10-31 03:54:04,634 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/pipeline_schedule/251031_0354_real_step1900_rank3.svg
[rank3]:> Batch Time: 458.61 ms, GPU Bubble Ratio: 56.29%, 58.99%, 67.43%, 14.90%
[rank3]:2025-10-31 03:54:04,708 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank3/251031_0354_stage3_step1900.svg
[rank3]:2025-10-31 03:54:04,939 - INFO - Avg. fwd time: 11.3384 / Avg. bwd time: 37.3842 / Avg. batch time: 449.9639 (ms) / GPU bubble ratio: 13.38%
[rank1]:2025-10-31 03:54:05,047 - INFO - Avg. fwd time: 10.3748 / Avg. bwd time: 13.7422 / Avg. batch time: 501.4594 (ms) / GPU bubble ratio: 61.52%
[rank2]:2025-10-31 03:54:04,997 - INFO - Avg. fwd time: 7.9851 / Avg. bwd time: 10.9651 / Avg. batch time: 473.4790 (ms) / GPU bubble ratio: 67.98%
[rank0]:2025-10-31 03:54:05,025 - INFO - Avg. fwd time: 8.9602 / Avg. bwd time: 16.3467 / Avg. batch time: 530.6735 (ms) / GPU bubble ratio: 61.85%
[rank1]:2025-10-31 03:54:15,621 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 3.5875e-01
[rank2]:2025-10-31 03:54:15,620 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.3040e-01
[rank0]:2025-10-31 03:54:15,636 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 4.8243e-01
[rank3]:2025-10-31 03:54:15,644 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 6.2173e-01
[rank1]:2025-10-31 03:54:26,573 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.5382e+00
[rank2]:2025-10-31 03:54:26,572 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.5415e+00
[rank0]:2025-10-31 03:54:26,588 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.6979e+00
[rank3]:2025-10-31 03:54:26,589 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.1268e+00
[rank1]:2025-10-31 03:54:37,500 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 3.0026e-01
[rank2]:2025-10-31 03:54:37,500 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 9.8727e-01
[rank0]:2025-10-31 03:54:37,515 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 7.3172e-01
[rank3]:2025-10-31 03:54:37,517 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 8.8709e-01
[rank3]:2025-10-31 03:54:48,361 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 4.2984e-01
[rank2]:2025-10-31 03:54:48,345 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.7147e-01
[rank1]:2025-10-31 03:54:48,345 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.5816e+00
[rank0]:2025-10-31 03:54:48,360 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.3409e+00
[rank0]:2025-10-31 03:54:58,121 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-31 03:54:59,205 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.1739e+00
[rank2]:2025-10-31 03:54:59,206 - INFO -  step: 1950  loss: -2.0000  grad_norm:  0.2233  memory: 11.83GiB(24.89%)  tps: 7,478  tflops: 56.95  mfu: 18.25%
[rank1]:2025-10-31 03:54:59,205 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.3227e+00
[rank1]:2025-10-31 03:54:59,205 - INFO -  step: 1950  loss: -2.0000  grad_norm:  0.2233  memory: 14.66GiB(30.86%)  tps: 7,478  tflops: 56.95  mfu: 18.25%
[rank0]:2025-10-31 03:54:59,221 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.4814e+00
[rank0]:2025-10-31 03:54:59,221 - INFO -  step: 1950  loss: -2.0000  grad_norm:  0.2233  memory: 16.57GiB(34.88%)  tps: 7,478  tflops: 56.95  mfu: 18.25%
[rank3]:2025-10-31 03:54:59,228 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 5.1504e-01
[rank3]:2025-10-31 03:54:59,231 - INFO -  step: 1950  loss:  0.1852  grad_norm:  0.2233  memory: 28.00GiB(58.93%)  tps: 7,477  tflops: 56.94  mfu: 18.25%
[rank3]:2025-10-31 03:55:10,097 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 6.4729e-01
[rank2]:2025-10-31 03:55:10,081 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.0120e-01
[rank1]:2025-10-31 03:55:10,081 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 6.1044e-01
[rank0]:2025-10-31 03:55:10,097 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 4.5610e-01
[rank2]:2025-10-31 03:55:21,018 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.6005e+00
[rank1]:2025-10-31 03:55:21,018 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 3.6025e+00
[rank0]:2025-10-31 03:55:21,033 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.5971e+00
[rank3]:2025-10-31 03:55:21,035 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 5.4766e+00
[rank3]:2025-10-31 03:55:31,927 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.6333e+00
[rank2]:2025-10-31 03:55:31,911 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.1391e+00
[rank1]:2025-10-31 03:55:31,911 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 5.7530e-01
[rank0]:2025-10-31 03:55:31,926 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1536e+00
[rank2]:2025-10-31 03:55:42,790 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.7699e+00
[rank1]:2025-10-31 03:55:42,790 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.5610e+00
[rank0]:2025-10-31 03:55:42,805 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 9.7371e-01
[rank3]:2025-10-31 03:55:42,806 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.7787e+00
[rank0]:2025-10-31 03:55:52,604 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-31 03:55:53,690 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.9151e-01
[rank2]:2025-10-31 03:55:53,691 - INFO -  step: 2000  loss: -2.0000  grad_norm:  0.3874  memory: 11.83GiB(24.89%)  tps: 7,518  tflops: 57.26  mfu: 18.35%
[rank2]:2025-10-31 03:55:53,691 - INFO - ðŸ”Ž  Running validation at step 2000
[rank1]:2025-10-31 03:55:53,690 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 3.7873e-01
[rank1]:2025-10-31 03:55:53,691 - INFO -  step: 2000  loss: -2.0000  grad_norm:  0.3874  memory: 14.66GiB(30.86%)  tps: 7,518  tflops: 57.26  mfu: 18.35%
[rank1]:2025-10-31 03:55:53,691 - INFO - ðŸ”Ž  Running validation at step 2000
[rank0]:2025-10-31 03:55:53,706 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 4.6190e-01
[rank0]:2025-10-31 03:55:53,706 - INFO -  step: 2000  loss: -2.0000  grad_norm:  0.3874  memory: 16.57GiB(34.88%)  tps: 7,518  tflops: 57.26  mfu: 18.35%
[rank0]:2025-10-31 03:55:53,706 - INFO - ðŸ”Ž  Running validation at step 2000
[rank3]:2025-10-31 03:55:53,706 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.0962e+00
[rank3]:2025-10-31 03:55:53,709 - INFO -  step: 2000  loss:  0.2266  grad_norm:  0.3874  memory: 28.00GiB(58.93%)  tps: 7,519  tflops: 57.27  mfu: 18.35%
[rank3]:2025-10-31 03:55:53,709 - INFO - ðŸ”Ž  Running validation at step 2000
[rank2]:2025-10-31 03:56:13,612 - INFO - validate step: 2000  loss: -1.0000  memory: 11.83GiB(24.89%)  tps: 20,561
[rank1]:2025-10-31 03:56:13,595 - INFO - validate step: 2000  loss: -1.0000  memory: 14.66GiB(30.86%)  tps: 20,579
[rank0]:2025-10-31 03:56:13,577 - INFO - validate step: 2000  loss: -1.0000  memory: 16.57GiB(34.88%)  tps: 20,613
[rank3]:2025-10-31 03:56:13,606 - INFO - validate step: 2000  loss:  0.9499  memory: 28.00GiB(58.93%)  tps: 20,588
[rank2]:2025-10-31 03:56:13,701 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank2/251031_0356_stage2_step2000.svg
[rank1]:2025-10-31 03:56:13,704 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank1/251031_0356_stage1_step2000.svg
[rank0]:2025-10-31 03:56:13,701 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank0/251031_0356_stage0_step2000.svg
[rank3]:2025-10-31 03:56:13,814 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/pipeline_schedule/251031_0356_real_step2000_rank3.svg
[rank3]:> Batch Time: 458.52 ms, GPU Bubble Ratio: 56.29%, 58.99%, 67.42%, 14.90%
[rank3]:2025-10-31 03:56:13,895 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank3/251031_0356_stage3_step2000.svg
[rank3]:2025-10-31 03:56:14,132 - INFO - Avg. fwd time: 11.3409 / Avg. bwd time: 37.3662 / Avg. batch time: 449.8039 (ms) / GPU bubble ratio: 13.37%
[rank2]:2025-10-31 03:56:14,189 - INFO - Avg. fwd time: 7.9880 / Avg. bwd time: 10.9462 / Avg. batch time: 473.2959 (ms) / GPU bubble ratio: 68.00%
[rank1]:2025-10-31 03:56:14,241 - INFO - Avg. fwd time: 10.3789 / Avg. bwd time: 13.7034 / Avg. batch time: 501.2337 (ms) / GPU bubble ratio: 61.56%
[rank0]:2025-10-31 03:56:14,218 - INFO - Avg. fwd time: 8.9627 / Avg. bwd time: 16.3168 / Avg. batch time: 530.4161 (ms) / GPU bubble ratio: 61.87%
[rank3]:2025-10-31 03:56:24,809 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.6126e+00
[rank2]:2025-10-31 03:56:24,784 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.5781e+00
[rank1]:2025-10-31 03:56:24,784 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.2328e+00
[rank0]:2025-10-31 03:56:24,800 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.1785e+00
[rank2]:2025-10-31 03:56:35,646 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.5553e+00
[rank1]:2025-10-31 03:56:35,646 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 3.4386e-01
[rank0]:2025-10-31 03:56:35,661 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.0969e+00
[rank3]:2025-10-31 03:56:35,662 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.4802e+00
[rank1]:2025-10-31 03:56:46,554 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 4.9072e-01
[rank2]:2025-10-31 03:56:46,554 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.9241e-01
[rank0]:2025-10-31 03:56:46,569 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 8.3899e-01
[rank3]:2025-10-31 03:56:46,577 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 3.5853e-01
[rank1]:2025-10-31 03:56:57,460 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.4255e+00
[rank2]:2025-10-31 03:56:57,460 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.1869e+00
[rank0]:2025-10-31 03:56:57,476 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.5804e+00
[rank3]:2025-10-31 03:56:57,478 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.7889e+00
[rank0]:2025-10-31 03:57:07,288 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-31 03:57:08,363 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.6983e+00
[rank1]:2025-10-31 03:57:08,364 - INFO -  step: 2050  loss: -2.0000  grad_norm:  0.3378  memory: 14.66GiB(30.86%)  tps: 7,479  tflops: 56.96  mfu: 18.26%
[rank2]:2025-10-31 03:57:08,363 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.7573e+00
[rank2]:2025-10-31 03:57:08,364 - INFO -  step: 2050  loss: -2.0000  grad_norm:  0.3378  memory: 11.83GiB(24.89%)  tps: 7,481  tflops: 56.98  mfu: 18.26%
[rank0]:2025-10-31 03:57:08,378 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.5686e+00
[rank0]:2025-10-31 03:57:08,379 - INFO -  step: 2050  loss: -2.0000  grad_norm:  0.3378  memory: 16.57GiB(34.88%)  tps: 7,474  tflops: 56.93  mfu: 18.25%
[rank3]:2025-10-31 03:57:08,379 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.7052e+00
[rank3]:2025-10-31 03:57:08,382 - INFO -  step: 2050  loss:  0.1975  grad_norm:  0.3378  memory: 28.00GiB(58.93%)  tps: 7,478  tflops: 56.95  mfu: 18.25%
[rank3]:2025-10-31 03:57:19,276 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.0345e+00
[rank1]:2025-10-31 03:57:19,260 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 3.3426e+00
[rank2]:2025-10-31 03:57:19,260 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.6787e+00
[rank0]:2025-10-31 03:57:19,275 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.7318e+00
[rank1]:2025-10-31 03:57:30,156 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 4.0195e-01
[rank2]:2025-10-31 03:57:30,156 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.6071e-01
[rank0]:2025-10-31 03:57:30,172 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.0040e+00
[rank3]:2025-10-31 03:57:30,172 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 3.9728e-01
[rank2]:2025-10-31 03:57:41,076 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.0067e-01
[rank3]:2025-10-31 03:57:41,091 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.4176e+00
[rank1]:2025-10-31 03:57:41,076 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 3.6254e-01
[rank0]:2025-10-31 03:57:41,091 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 5.4317e-01
[rank1]:2025-10-31 03:57:52,030 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 7.2743e-01
[rank2]:2025-10-31 03:57:52,030 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 9.6010e-01
[rank0]:2025-10-31 03:57:52,046 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.5553e+00
[rank3]:2025-10-31 03:57:52,046 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.4327e+00
[rank0]:2025-10-31 03:58:01,792 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-31 03:58:02,887 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.0578e+00
[rank1]:2025-10-31 03:58:02,887 - INFO -  step: 2100  loss: -2.0000  grad_norm:  0.3016  memory: 14.66GiB(30.86%)  tps: 7,512  tflops: 57.22  mfu: 18.34%
[rank2]:2025-10-31 03:58:02,887 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.0079e-01
[rank2]:2025-10-31 03:58:02,887 - INFO -  step: 2100  loss: -2.0000  grad_norm:  0.3016  memory: 11.83GiB(24.89%)  tps: 7,512  tflops: 57.22  mfu: 18.34%
[rank0]:2025-10-31 03:58:02,902 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 6.4891e-01
[rank0]:2025-10-31 03:58:02,903 - INFO -  step: 2100  loss: -2.0000  grad_norm:  0.3016  memory: 16.57GiB(34.88%)  tps: 7,512  tflops: 57.22  mfu: 18.34%
[rank3]:2025-10-31 03:58:02,903 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 8.5247e-01
[rank3]:2025-10-31 03:58:02,906 - INFO -  step: 2100  loss:  0.2374  grad_norm:  0.3016  memory: 28.00GiB(58.93%)  tps: 7,513  tflops: 57.22  mfu: 18.34%
[rank1]:2025-10-31 03:58:02,990 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank1/251031_0358_stage1_step2100.svg
[rank2]:2025-10-31 03:58:02,988 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank2/251031_0358_stage2_step2100.svg
[rank0]:2025-10-31 03:58:02,988 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank0/251031_0358_stage0_step2100.svg
[rank3]:2025-10-31 03:58:03,097 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/pipeline_schedule/251031_0358_real_step2100_rank3.svg
[rank3]:> Batch Time: 458.43 ms, GPU Bubble Ratio: 56.28%, 58.98%, 67.42%, 14.90%
[rank3]:2025-10-31 03:58:03,166 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank3/251031_0358_stage3_step2100.svg
[rank1]:2025-10-31 03:58:03,682 - INFO - Avg. fwd time: 10.3829 / Avg. bwd time: 13.6689 / Avg. batch time: 501.0671 (ms) / GPU bubble ratio: 61.60%
[rank2]:2025-10-31 03:58:03,661 - INFO - Avg. fwd time: 7.9908 / Avg. bwd time: 10.9295 / Avg. batch time: 473.1654 (ms) / GPU bubble ratio: 68.01%
[rank0]:2025-10-31 03:58:03,707 - INFO - Avg. fwd time: 8.9654 / Avg. bwd time: 16.2902 / Avg. batch time: 530.2229 (ms) / GPU bubble ratio: 61.89%
[rank3]:2025-10-31 03:58:03,641 - INFO - Avg. fwd time: 11.3439 / Avg. bwd time: 37.3486 / Avg. batch time: 449.6530 (ms) / GPU bubble ratio: 13.37%
[rank1]:2025-10-31 03:58:14,078 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.6290e+00
[rank2]:2025-10-31 03:58:14,078 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.7198e+00
[rank0]:2025-10-31 03:58:14,093 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.0642e+00
[rank3]:2025-10-31 03:58:14,094 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.4241e+00
[rank1]:2025-10-31 03:58:25,001 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.6395e-01
[rank2]:2025-10-31 03:58:25,001 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.1825e-01
[rank0]:2025-10-31 03:58:25,016 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 5.6105e-01
[rank3]:2025-10-31 03:58:25,017 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 6.6565e-01
[rank1]:2025-10-31 03:58:35,872 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.6358e+00
[rank2]:2025-10-31 03:58:35,872 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.9738e+00
[rank0]:2025-10-31 03:58:35,887 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.2169e+00
[rank3]:2025-10-31 03:58:35,888 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.5816e+00
[rank1]:2025-10-31 03:58:46,733 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 4.8264e-01
[rank2]:2025-10-31 03:58:46,733 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.3246e-01
[rank0]:2025-10-31 03:58:46,748 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.3025e-01
[rank3]:2025-10-31 03:58:46,748 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 5.0885e-01
[rank0]:2025-10-31 03:58:56,508 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-31 03:58:57,593 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.8156e-01
[rank1]:2025-10-31 03:58:57,593 - INFO -  step: 2150  loss: -2.0000  grad_norm:  0.2474  memory: 14.66GiB(30.86%)  tps: 7,487  tflops: 57.03  mfu: 18.28%
[rank2]:2025-10-31 03:58:57,593 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.7912e-01
[rank2]:2025-10-31 03:58:57,593 - INFO -  step: 2150  loss: -2.0000  grad_norm:  0.2474  memory: 11.83GiB(24.89%)  tps: 7,487  tflops: 57.03  mfu: 18.28%
[rank0]:2025-10-31 03:58:57,608 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 9.2492e-01
[rank0]:2025-10-31 03:58:57,609 - INFO -  step: 2150  loss: -2.0000  grad_norm:  0.2474  memory: 16.57GiB(34.88%)  tps: 7,487  tflops: 57.03  mfu: 18.28%
[rank3]:2025-10-31 03:58:57,609 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 3.9030e-01
[rank3]:2025-10-31 03:58:57,612 - INFO -  step: 2150  loss:  0.2153  grad_norm:  0.2474  memory: 28.00GiB(58.93%)  tps: 7,488  tflops: 57.03  mfu: 18.28%
[rank3]:2025-10-31 03:59:08,522 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 8.3877e-01
[rank1]:2025-10-31 03:59:08,506 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.4027e+00
[rank2]:2025-10-31 03:59:08,506 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 9.8518e-01
[rank0]:2025-10-31 03:59:08,521 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.8361e+00
[rank1]:2025-10-31 03:59:19,406 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.4222e+00
[rank2]:2025-10-31 03:59:19,406 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.9853e+00
[rank0]:2025-10-31 03:59:19,421 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.7047e+00
[rank3]:2025-10-31 03:59:19,422 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.3801e+00
[rank1]:2025-10-31 03:59:30,299 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 3.1157e-01
[rank2]:2025-10-31 03:59:30,299 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 7.1728e-01
[rank0]:2025-10-31 03:59:30,314 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 4.7031e-01
[rank3]:2025-10-31 03:59:30,319 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.0660e+00
[rank1]:2025-10-31 03:59:41,195 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.4593e-01
[rank2]:2025-10-31 03:59:41,195 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.7918e-01
[rank0]:2025-10-31 03:59:41,210 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 9.7765e-01
[rank3]:2025-10-31 03:59:41,211 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.9591e-01
[rank0]:2025-10-31 03:59:50,993 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-31 03:59:52,098 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.2161e+00
[rank1]:2025-10-31 03:59:52,098 - INFO -  step: 2200  loss: -2.0000  grad_norm:  0.3877  memory: 14.66GiB(30.86%)  tps: 7,515  tflops: 57.24  mfu: 18.34%
[rank1]:2025-10-31 03:59:52,098 - INFO - ðŸ”Ž  Running validation at step 2200
[rank2]:2025-10-31 03:59:52,098 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.0160e+00
[rank2]:2025-10-31 03:59:52,098 - INFO -  step: 2200  loss: -2.0000  grad_norm:  0.3877  memory: 11.83GiB(24.89%)  tps: 7,515  tflops: 57.24  mfu: 18.34%
[rank2]:2025-10-31 03:59:52,098 - INFO - ðŸ”Ž  Running validation at step 2200
[rank0]:2025-10-31 03:59:52,113 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 7.1069e-01
[rank0]:2025-10-31 03:59:52,113 - INFO -  step: 2200  loss: -2.0000  grad_norm:  0.3877  memory: 16.57GiB(34.88%)  tps: 7,515  tflops: 57.24  mfu: 18.34%
[rank0]:2025-10-31 03:59:52,114 - INFO - ðŸ”Ž  Running validation at step 2200
[rank3]:2025-10-31 03:59:52,113 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 6.8368e-01
[rank3]:2025-10-31 03:59:52,116 - INFO -  step: 2200  loss:  0.2345  grad_norm:  0.3877  memory: 28.00GiB(58.93%)  tps: 7,515  tflops: 57.24  mfu: 18.35%
[rank3]:2025-10-31 03:59:52,117 - INFO - ðŸ”Ž  Running validation at step 2200
[rank1]:2025-10-31 04:00:12,031 - INFO - validate step: 2200  loss: -1.0000  memory: 14.66GiB(30.86%)  tps: 20,549
[rank2]:2025-10-31 04:00:12,047 - INFO - validate step: 2200  loss: -1.0000  memory: 11.83GiB(24.89%)  tps: 20,533
[rank0]:2025-10-31 04:00:12,014 - INFO - validate step: 2200  loss: -1.0000  memory: 16.57GiB(34.88%)  tps: 20,583
[rank3]:2025-10-31 04:00:12,039 - INFO - validate step: 2200  loss:  0.9520  memory: 28.00GiB(58.93%)  tps: 20,560
[rank1]:2025-10-31 04:00:12,132 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank1/251031_0400_stage1_step2200.svg
[rank2]:2025-10-31 04:00:12,129 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank2/251031_0400_stage2_step2200.svg
[rank0]:2025-10-31 04:00:12,130 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank0/251031_0400_stage0_step2200.svg
[rank3]:2025-10-31 04:00:12,240 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/pipeline_schedule/251031_0400_real_step2200_rank3.svg
[rank3]:> Batch Time: 458.41 ms, GPU Bubble Ratio: 56.28%, 58.98%, 67.42%, 14.90%
[rank3]:2025-10-31 04:00:12,309 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank3/251031_0400_stage3_step2200.svg
[rank3]:2025-10-31 04:00:12,549 - INFO - Avg. fwd time: 11.3460 / Avg. bwd time: 37.3338 / Avg. batch time: 449.5252 (ms) / GPU bubble ratio: 13.37%
[rank1]:2025-10-31 04:00:12,657 - INFO - Avg. fwd time: 10.3857 / Avg. bwd time: 13.6416 / Avg. batch time: 500.8629 (ms) / GPU bubble ratio: 61.62%
[rank2]:2025-10-31 04:00:12,607 - INFO - Avg. fwd time: 7.9928 / Avg. bwd time: 10.9163 / Avg. batch time: 472.9915 (ms) / GPU bubble ratio: 68.02%
[rank0]:2025-10-31 04:00:12,635 - INFO - Avg. fwd time: 8.9672 / Avg. bwd time: 16.2693 / Avg. batch time: 529.9965 (ms) / GPU bubble ratio: 61.91%
[rank3]:2025-10-31 04:00:23,226 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.3689e+00
[rank1]:2025-10-31 04:00:23,205 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 7.0322e-01
[rank2]:2025-10-31 04:00:23,205 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.3837e+00
[rank0]:2025-10-31 04:00:23,221 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 6.1052e-01
[rank1]:2025-10-31 04:00:34,102 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.1670e+00
[rank2]:2025-10-31 04:00:34,102 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.8921e-01
[rank0]:2025-10-31 04:00:34,118 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.0377e+00
[rank3]:2025-10-31 04:00:34,122 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 7.5689e-01
[rank2]:2025-10-31 04:00:45,077 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 7.9952e-01
[rank1]:2025-10-31 04:00:45,077 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 6.0372e-01
[rank0]:2025-10-31 04:00:45,092 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.8336e-01
[rank3]:2025-10-31 04:00:45,092 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 4.6130e-01
[rank2]:2025-10-31 04:00:56,078 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.5769e-01
[rank1]:2025-10-31 04:00:56,078 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 4.1486e-01
[rank0]:2025-10-31 04:00:56,094 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.2877e+00
[rank3]:2025-10-31 04:00:56,094 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 5.2474e-01
[rank0]:2025-10-31 04:01:05,945 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-31 04:01:07,025 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.2215e-01
[rank2]:2025-10-31 04:01:07,025 - INFO -  step: 2250  loss: -2.0000  grad_norm:  0.3166  memory: 11.83GiB(24.89%)  tps: 7,450  tflops: 56.74  mfu: 18.19%
[rank1]:2025-10-31 04:01:07,024 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 7.3815e-01
[rank1]:2025-10-31 04:01:07,025 - INFO -  step: 2250  loss: -2.0000  grad_norm:  0.3166  memory: 14.66GiB(30.86%)  tps: 7,448  tflops: 56.73  mfu: 18.18%
[rank0]:2025-10-31 04:01:07,040 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.7940e-01
[rank0]:2025-10-31 04:01:07,040 - INFO -  step: 2250  loss: -2.0000  grad_norm:  0.3166  memory: 16.57GiB(34.88%)  tps: 7,444  tflops: 56.69  mfu: 18.17%
[rank3]:2025-10-31 04:01:07,040 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 8.2211e-01
[rank3]:2025-10-31 04:01:07,043 - INFO -  step: 2250  loss:  0.2210  grad_norm:  0.3166  memory: 28.00GiB(58.93%)  tps: 7,447  tflops: 56.72  mfu: 18.18%
[rank1]:2025-10-31 04:01:17,868 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 6.5678e-01
[rank0]:2025-10-31 04:01:17,883 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.6909e-01
[rank3]:2025-10-31 04:01:17,883 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 7.7697e-01
[rank2]:2025-10-31 04:01:17,868 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.5545e-01
[rank2]:2025-10-31 04:01:28,767 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.2627e-01
[rank1]:2025-10-31 04:01:28,767 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 5.6942e-01
[rank0]:2025-10-31 04:01:28,782 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.1660e-01
[rank3]:2025-10-31 04:01:28,783 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.8303e-01
[rank2]:2025-10-31 04:01:39,660 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.2096e+00
[rank1]:2025-10-31 04:01:39,660 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 8.9635e-01
[rank0]:2025-10-31 04:01:39,676 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 5.8051e-01
[rank3]:2025-10-31 04:01:39,676 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.5730e+00
[rank2]:2025-10-31 04:01:50,579 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 7.4926e-01
[rank1]:2025-10-31 04:01:50,579 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.9397e-01
[rank0]:2025-10-31 04:01:50,594 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.7012e-01
[rank3]:2025-10-31 04:01:50,595 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.0081e+00
[rank0]:2025-10-31 04:02:00,400 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-31 04:02:01,474 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 6.4677e-01
[rank2]:2025-10-31 04:02:01,475 - INFO -  step: 2300  loss: -2.0000  grad_norm:  0.2559  memory: 11.83GiB(24.89%)  tps: 7,523  tflops: 57.29  mfu: 18.36%
[rank1]:2025-10-31 04:02:01,475 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.4408e-01
[rank1]:2025-10-31 04:02:01,475 - INFO -  step: 2300  loss: -2.0000  grad_norm:  0.2559  memory: 14.66GiB(30.86%)  tps: 7,524  tflops: 57.30  mfu: 18.37%
[rank0]:2025-10-31 04:02:01,490 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 6.4761e-01
[rank0]:2025-10-31 04:02:01,490 - INFO -  step: 2300  loss: -2.0000  grad_norm:  0.2559  memory: 16.57GiB(34.88%)  tps: 7,523  tflops: 57.29  mfu: 18.36%
[rank3]:2025-10-31 04:02:01,490 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.1564e+00
[rank3]:2025-10-31 04:02:01,493 - INFO -  step: 2300  loss:  0.2147  grad_norm:  0.2559  memory: 28.00GiB(58.93%)  tps: 7,523  tflops: 57.29  mfu: 18.36%
[rank2]:2025-10-31 04:02:01,575 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank2/251031_0402_stage2_step2300.svg
[rank1]:2025-10-31 04:02:01,580 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank1/251031_0402_stage1_step2300.svg
[rank0]:2025-10-31 04:02:01,575 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank0/251031_0402_stage0_step2300.svg
[rank3]:2025-10-31 04:02:01,686 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/pipeline_schedule/251031_0402_real_step2300_rank3.svg
[rank3]:> Batch Time: 458.41 ms, GPU Bubble Ratio: 56.28%, 58.98%, 67.42%, 14.90%
[rank3]:2025-10-31 04:02:01,754 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank3/251031_0402_stage3_step2300.svg
[rank3]:2025-10-31 04:02:01,993 - INFO - Avg. fwd time: 11.3481 / Avg. bwd time: 37.3236 / Avg. batch time: 449.4339 (ms) / GPU bubble ratio: 13.36%
[rank2]:2025-10-31 04:02:02,049 - INFO - Avg. fwd time: 7.9950 / Avg. bwd time: 10.9021 / Avg. batch time: 472.8826 (ms) / GPU bubble ratio: 68.03%
[rank1]:2025-10-31 04:02:02,099 - INFO - Avg. fwd time: 10.3888 / Avg. bwd time: 13.6126 / Avg. batch time: 500.7218 (ms) / GPU bubble ratio: 61.65%
[rank0]:2025-10-31 04:02:02,077 - INFO - Avg. fwd time: 8.9688 / Avg. bwd time: 16.2469 / Avg. batch time: 529.8322 (ms) / GPU bubble ratio: 61.93%
[rank2]:2025-10-31 04:02:12,594 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.5734e-01
[rank1]:2025-10-31 04:02:12,595 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 6.0962e-01
[rank0]:2025-10-31 04:02:12,610 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 7.5360e-01
[rank3]:2025-10-31 04:02:12,610 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 3.9405e-01
[rank2]:2025-10-31 04:02:23,509 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.5283e-01
[rank1]:2025-10-31 04:02:23,509 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 3.5225e-01
[rank0]:2025-10-31 04:02:23,524 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 6.6803e-01
[rank3]:2025-10-31 04:02:23,525 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 8.0939e-01
[rank3]:2025-10-31 04:02:34,403 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.7895e+00
[rank2]:2025-10-31 04:02:34,388 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.4641e+00
[rank1]:2025-10-31 04:02:34,387 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.1134e+00
[rank0]:2025-10-31 04:02:34,403 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.5721e+00
[rank3]:2025-10-31 04:02:45,316 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 6.9232e-01
[rank2]:2025-10-31 04:02:45,300 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.6738e+00
[rank1]:2025-10-31 04:02:45,301 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 2.5637e-01
[rank0]:2025-10-31 04:02:45,316 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 8.0389e-01
[rank0]:2025-10-31 04:02:55,095 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-31 04:02:56,181 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.9088e+00
[rank1]:2025-10-31 04:02:56,181 - INFO -  step: 2350  loss: -2.0000  grad_norm:  0.2225  memory: 14.66GiB(30.86%)  tps: 7,487  tflops: 57.02  mfu: 18.28%
[rank0]:2025-10-31 04:02:56,196 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.2636e+00
[rank0]:2025-10-31 04:02:56,197 - INFO -  step: 2350  loss: -2.0000  grad_norm:  0.2225  memory: 16.57GiB(34.88%)  tps: 7,487  tflops: 57.03  mfu: 18.28%
[rank3]:2025-10-31 04:02:56,196 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.1477e+00
[rank3]:2025-10-31 04:02:56,199 - INFO -  step: 2350  loss:  0.2130  grad_norm:  0.2225  memory: 28.00GiB(58.93%)  tps: 7,488  tflops: 57.03  mfu: 18.28%
[rank2]:2025-10-31 04:02:56,181 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.6972e+00
[rank2]:2025-10-31 04:02:56,181 - INFO -  step: 2350  loss: -2.0000  grad_norm:  0.2225  memory: 11.83GiB(24.89%)  tps: 7,487  tflops: 57.02  mfu: 18.28%
[rank2]:2025-10-31 04:03:07,056 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 6.0143e-01
[rank1]:2025-10-31 04:03:07,056 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 3.8180e-01
[rank0]:2025-10-31 04:03:07,071 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 8.4564e-01
[rank3]:2025-10-31 04:03:07,072 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.0174e+00
[rank2]:2025-10-31 04:03:17,971 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 7.3046e-01
[rank1]:2025-10-31 04:03:17,971 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 3.4229e-01
[rank0]:2025-10-31 04:03:17,986 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.2488e+00
[rank3]:2025-10-31 04:03:17,986 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.0749e+00
[rank1]:2025-10-31 04:03:28,848 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 5.6718e-01
[rank0]:2025-10-31 04:03:28,863 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.1920e-01
[rank3]:2025-10-31 04:03:28,864 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.1162e+00
[rank2]:2025-10-31 04:03:28,848 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 8.1272e-01
[rank1]:2025-10-31 04:03:39,747 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 1.0755e+00
[rank0]:2025-10-31 04:03:39,762 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 5.8260e-01
[rank3]:2025-10-31 04:03:39,763 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.0592e+00
[rank2]:2025-10-31 04:03:39,747 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.1301e+00
[rank0]:2025-10-31 04:03:49,560 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-31 04:03:50,664 - INFO - Freezing Ratio: [Stage1] 0.80, Threshold: 5.0166e-01
[rank1]:2025-10-31 04:03:50,665 - INFO -  step: 2400  loss: -2.0000  grad_norm:  0.3804  memory: 14.66GiB(30.86%)  tps: 7,518  tflops: 57.26  mfu: 18.35%
[rank1]:2025-10-31 04:03:50,665 - INFO -  final step: 2400  loss: -2.0000  grad_norm:  0.3804  tps: 7,536  tflops: 57.39  mfu: 17.78%
[rank1]:2025-10-31 04:03:50,665 - INFO - ðŸ”Ž  Running validation at step 2400
[rank0]:2025-10-31 04:03:50,680 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.0223e+00
[rank0]:2025-10-31 04:03:50,680 - INFO -  step: 2400  loss: -2.0000  grad_norm:  0.3804  memory: 16.57GiB(34.88%)  tps: 7,518  tflops: 57.26  mfu: 18.35%
[rank0]:2025-10-31 04:03:50,680 - INFO -  final step: 2400  loss: -2.0000  grad_norm:  0.3804  tps: 7,534  tflops: 57.38  mfu: 17.78%
[rank0]:2025-10-31 04:03:50,680 - INFO - ðŸ”Ž  Running validation at step 2400
[rank3]:2025-10-31 04:03:50,680 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.6180e+00
[rank3]:2025-10-31 04:03:50,683 - INFO -  step: 2400  loss:  0.2221  grad_norm:  0.3804  memory: 28.00GiB(58.93%)  tps: 7,518  tflops: 57.26  mfu: 18.35%
[rank3]:2025-10-31 04:03:50,683 - INFO -  final step: 2400  loss:  0.2221  grad_norm:  0.3804  tps: 7,544  tflops: 57.45  mfu: 17.79%
[rank3]:2025-10-31 04:03:50,684 - INFO - ðŸ”Ž  Running validation at step 2400
[rank2]:2025-10-31 04:03:50,664 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.3921e+00
[rank2]:2025-10-31 04:03:50,665 - INFO -  step: 2400  loss: -2.0000  grad_norm:  0.3804  memory: 11.83GiB(24.89%)  tps: 7,518  tflops: 57.26  mfu: 18.35%
[rank2]:2025-10-31 04:03:50,665 - INFO -  final step: 2400  loss: -2.0000  grad_norm:  0.3804  tps: 7,538  tflops: 57.41  mfu: 17.79%
[rank2]:2025-10-31 04:03:50,665 - INFO - ðŸ”Ž  Running validation at step 2400
[rank0]:2025-10-31 04:04:10,511 - INFO - validate step: 2400  loss: -1.0000  memory: 16.57GiB(34.88%)  tps: 20,656
[rank0]:2025-10-31 04:04:10,511 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-31 04:04:10,513 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank2]:2025-10-31 04:04:10,544 - INFO - validate step: 2400  loss: -1.0000  memory: 11.83GiB(24.89%)  tps: 20,605
[rank2]:2025-10-31 04:04:10,545 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-31 04:04:10,546 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank1]:2025-10-31 04:04:10,536 - INFO - validate step: 2400  loss: -1.0000  memory: 14.66GiB(30.86%)  tps: 20,614
[rank1]:2025-10-31 04:04:10,536 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-31 04:04:10,538 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank3]:2025-10-31 04:04:10,537 - INFO - validate step: 2400  loss:  0.9521  memory: 28.00GiB(58.93%)  tps: 20,632
[rank3]:2025-10-31 04:04:10,538 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-31 04:04:10,540 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank1]:2025-10-31 04:04:13,314 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank1/251031_0404_stage1_final2400.svg
[rank0]:2025-10-31 04:04:13,222 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank0]:2025-10-31 04:04:13,310 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank0/251031_0404_stage0_final2400.svg
[rank2]:2025-10-31 04:04:13,309 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank2/251031_0404_stage2_final2400.svg
[rank3]:2025-10-31 04:04:13,420 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/pipeline_schedule/251031_0404_real_final2400_rank3.svg
[rank3]:> Batch Time: 458.31 ms, GPU Bubble Ratio: 56.27%, 58.97%, 67.41%, 14.91%
[rank2]:2025-10-31 04:04:13,526 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/frozen_params_histogram/251031_0404_rank2_stage2.svg
[rank2]:	> Counts Sum: 6264, Total Sum: 8460 (74.04%), Ratio(%) per element: [98.72, 98.72, 98.72, 98.72, 98.72, 98.72, 98.72, 98.72, 98.72, 98.72, 98.72, 98.72, 98.72, 98.72, 98.72, 98.72, 98.72, 98.72, 98.72, 98.72, 98.72, 98.72, 98.72, 98.72, 98.72, 98.72, 98.72, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-10-31 04:04:13,526 - INFO - Destroying the purge thread.
[rank1]:2025-10-31 04:04:13,526 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/frozen_params_histogram/251031_0404_rank1_stage1.svg
[rank1]:	> Counts Sum: 8199, Total Sum: 10575 (77.53%), Ratio(%) per element: [97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 95.31, 95.31, 95.31, 95.31, 95.31, 95.31, 95.31, 95.31, 95.31, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-10-31 04:04:13,526 - INFO - Destroying the purge thread.
[rank0]:2025-10-31 04:04:13,531 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/frozen_params_histogram/251031_0404_rank0_stage0.svg
[rank0]:	> Counts Sum: 6129, Total Sum: 8695 (70.49%), Ratio(%) per element: [0.0, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 96.17, 96.17, 96.17, 96.17, 96.17, 96.17, 96.17, 96.17, 96.17, 96.17, 96.17, 96.17, 96.17, 96.17, 96.17, 96.17, 96.17, 96.17, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-10-31 04:04:13,531 - INFO - Sleeping 2 seconds for other ranks to complete
[rank3]:2025-10-31 04:04:13,614 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/pipeline_schedule/251031_0404_thry_final2400_rank3.svg
[rank3]:> Batch Time: 320.59 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:2025-10-31 04:04:13,686 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank3/251031_0404_stage3_final2400.svg
[rank3]:2025-10-31 04:04:13,877 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1/frozen_params_histogram/251031_0404_rank3_stage3.svg
[rank3]:	> Counts Sum: 4122, Total Sum: 6815 (60.48%), Ratio(%) per element: [97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-10-31 04:04:13,878 - INFO - Destroying the purge thread.
[rank2]:2025-10-31 04:04:13,927 - INFO - Process group destroyed
[rank3]:wandb: updating run metadata
[rank1]:2025-10-31 04:04:14,029 - INFO - Process group destroyed
[rank3]:wandb: uploading history steps 48-48, summary, console lines 600-607
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–„â–†â–ƒâ–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–ˆâ–†â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–ˆâ–†â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 1.08596
[rank3]:wandb:               final/avg_loss 0.22205
[rank3]:wandb:             final/avg_mfu(%) 17.79053
[rank3]:wandb:             final/avg_tflops 57.45342
[rank3]:wandb:    final/avg_throughput(tps) 7543.56811
[rank3]:wandb:              final/grad_norm 0.38041
[rank3]:wandb:               final/max_loss 0.22205
[rank3]:wandb:                    grad_norm 0.38041
[rank3]:wandb: loss_metrics/global_avg_loss 0.22205
[rank3]:wandb: loss_metrics/global_max_loss 0.22205
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1030_GPipe_auto_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/0gjamkjj
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1030_GPipe_auto_dm1/20251031-0315/wandb/run-20251031_031547-0gjamkjj/logs
[rank0]:2025-10-31 04:04:15,531 - INFO - Training completed
[rank0]:2025-10-31 04:04:15,532 - INFO - Destroying the purge thread.
[rank3]:2025-10-31 04:04:15,734 - INFO - Process group destroyed
[rank0]:2025-10-31 04:04:15,757 - INFO - Process group destroyed
[rank1]:Stage 1: Modules to keep: {'layers.8', 'layers.6', 'layers.5', 'layers.7', 'layers.4'}
[rank0]:Stage 0: Modules to keep: {'layers.0', 'layers.2', 'tok_embeddings', 'layers.1', 'layers.3'}
[rank2]:Stage 2: Modules to keep: {'layers.10', 'layers.12', 'layers.9', 'layers.11'}
[rank3]:Stage 3: Modules to keep: {'layers.14', 'output', 'layers.13', 'layers.15', 'norm'}
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1029_llama1b/config.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
[rank3]:+ more freezing in autofreeze mode. (self.percentile = getattr(config.freezing, percentile, 50->70))"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1030_GPipe_auto_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1030_GPipe_auto_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1030_GPipe_auto_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1030_GPipe_auto_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1030_GPipe_auto_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1030_GPipe_auto_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B-Instruct
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 1e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: alpaca
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 512
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 2400
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: GPipe
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 4
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1030_GPipe_auto_dm1
[rank3]:		- interval: 800
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B-Instruct/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1030_GPipe_auto_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: True
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: auto
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- aggressiveness: 0
[rank3]:
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
