
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 11. 02. (ì¼) 04:21:53 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 3,4,5,6
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1029_llama1b/run_1031.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1029_llama1b/1031_1F1B_fullrand7.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
+ more freezing in autofreeze mode. 
+ lr_scheduler min_lr = 0 -> 1e-6, cosine decay.

âœ”ï¸Running with fullrand7 x 1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1029_llama1b/config_1031.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
+ more freezing in autofreeze mode. 
+ lr_scheduler min_lr = 0 -> 1e-6, cosine decay.
" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=fullrand7
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank0]:2025-11-02 04:21:59,972 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
[rank0]:+ more freezing in autofreeze mode. 
[rank0]:+ lr_scheduler min_lr = 0 -> 1e-6, cosine decay.
[rank0]:"
[rank3]:2025-11-02 04:22:00,059 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
[rank3]:+ more freezing in autofreeze mode. 
[rank3]:+ lr_scheduler min_lr = 0 -> 1e-6, cosine decay.
[rank3]:"
[rank1]:2025-11-02 04:22:00,137 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
[rank1]:+ more freezing in autofreeze mode. 
[rank1]:+ lr_scheduler min_lr = 0 -> 1e-6, cosine decay.
[rank1]:"
[rank2]:2025-11-02 04:22:00,275 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
[rank2]:+ more freezing in autofreeze mode. 
[rank2]:+ lr_scheduler min_lr = 0 -> 1e-6, cosine decay.
[rank2]:"
[rank0]:2025-11-02 04:22:00,660 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-11-02 04:22:00,662 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-02 04:22:00,665 - INFO - [GC] Initial GC collection 0.00 seconds
[rank1]:2025-11-02 04:22:00,647 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-11-02 04:22:00,650 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-11-02 04:22:00,635 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-11-02 04:22:00,637 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-11-02 04:22:00,682 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-11-02 04:22:00,684 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-02 04:22:01,137 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-11-02 04:22:01,535 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank0]:2025-11-02 04:22:04,254 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=512, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank1]:2025-11-02 04:22:04,474 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-11-02 04:22:04,412 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-11-02 04:22:04,454 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-02 04:22:04,408 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-11-02 04:22:04,454 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-02 04:22:04,455 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank1]:2025-11-02 04:22:04,512 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-11-02 04:22:04,539 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-11-02 04:22:04,539 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank2]:2025-11-02 04:22:04,481 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-11-02 04:22:04,481 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2025-11-02 04:22:04,481 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-11-02 04:22:04,481 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank2]:2025-11-02 04:22:04,666 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-11-02 04:22:04,666 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-11-02 04:22:04,667 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank0]:2025-11-02 04:22:04,666 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-02 04:22:04,666 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-11-02 04:22:04,667 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank1]:2025-11-02 04:22:04,732 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-11-02 04:22:04,733 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-11-02 04:22:04,733 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run 89nui3g0
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1031_1F1B_fullrand7_dm1/20251102-0422/wandb/run-20251102_042205-89nui3g0
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1031_1F1B_fullrand7_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/89nui3g0
[rank3]:2025-11-02 04:22:06,594 - INFO - WandB logging enabled
[rank3]:2025-11-02 04:22:06,595 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-11-02 04:22:06,633 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-11-02 04:22:06,662 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-11-02 04:22:06,663 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2025-11-02 04:22:06,862 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-02 04:22:06,861 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1031_1F1B_fullrand7_dm1
[rank0]:2025-11-02 04:22:06,862 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-02 04:22:06,864 - INFO - Preparing c4_validation dataset from allenai/c4
[rank2]:2025-11-02 04:22:06,862 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-11-02 04:22:06,844 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-11-02 04:22:06,845 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-11-02 04:22:06,846 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2025-11-02 04:22:06,862 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-02 04:22:12,294 - INFO - Trainer is initialized with local batch size 32, global batch size 64, gradient accumulation steps 2, sequence length 512, total steps 2400 (warmup 300)
[rank0]:2025-11-02 04:22:12,294 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B-Instruct/original_dcp.
[rank0]:2025-11-02 04:22:15,539 - INFO - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-11-02 04:22:15,539 - INFO - Finished loading the checkpoint in 3.25 seconds.
[rank0]:2025-11-02 04:22:15,539 - INFO - Training starts at step 1
[rank3]:2025-11-02 04:22:18,213 - INFO -  step:  1  loss:  9.0164  grad_norm: 85.2016  memory: 12.97GiB(27.30%)  tps: 708  tflops: 5.39  mfu: 1.73%
[rank3]:2025-11-02 04:22:18,214 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-11-02 04:22:18,204 - INFO -  step:  1  loss: -2.0000  grad_norm: 85.2016  memory:  4.61GiB(9.71%)  tps: 596  tflops: 4.54  mfu: 1.45%
[rank2]:2025-11-02 04:22:18,210 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-02 04:22:18,242 - INFO -  step:  1  loss: -2.0000  grad_norm: 85.2016  memory:  9.19GiB(19.34%)  tps: 594  tflops: 4.53  mfu: 1.45%
[rank0]:2025-11-02 04:22:18,243 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-11-02 04:22:18,209 - INFO -  step:  1  loss: -2.0000  grad_norm: 85.2016  memory:  6.74GiB(14.20%)  tps: 598  tflops: 4.56  mfu: 1.46%
[rank1]:2025-11-02 04:22:18,210 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-02 04:23:18,578 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-02 04:23:19,855 - INFO -  step: 50  loss: -2.0000  grad_norm: 49.2200  memory: 12.97GiB(27.31%)  tps: 6,515  tflops: 49.62  mfu: 15.90%
[rank2]:2025-11-02 04:23:19,840 - INFO -  step: 50  loss: -2.0000  grad_norm: 49.2200  memory:  6.43GiB(13.53%)  tps: 6,513  tflops: 49.61  mfu: 15.90%
[rank3]:2025-11-02 04:23:19,852 - INFO -  step: 50  loss:  9.8009  grad_norm: 49.2200  memory: 16.39GiB(34.50%)  tps: 6,512  tflops: 49.60  mfu: 15.90%
[rank1]:2025-11-02 04:23:19,844 - INFO -  step: 50  loss: -2.0000  grad_norm: 49.2200  memory:  9.03GiB(19.01%)  tps: 6,513  tflops: 49.60  mfu: 15.90%
[rank0]:2025-11-02 04:24:20,986 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 04:24:21,934 - INFO - Avg. fwd time: 12.3486 / Avg. bwd time: 40.0996 / Avg. batch time: 495.8759 (ms) / GPU bubble ratio: 15.38%
[rank0]:2025-11-02 04:24:22,002 - INFO - Avg. fwd time: 7.9032 / Avg. bwd time: 23.4239 / Avg. batch time: 606.6592 (ms) / GPU bubble ratio: 58.69%
[rank2]:2025-11-02 04:24:21,973 - INFO - Avg. fwd time: 7.4202 / Avg. bwd time: 18.2242 / Avg. batch time: 526.8953 (ms) / GPU bubble ratio: 61.06%
[rank1]:2025-11-02 04:24:22,005 - INFO - Avg. fwd time: 9.4939 / Avg. bwd time: 23.3047 / Avg. batch time: 569.4950 (ms) / GPU bubble ratio: 53.93%
[rank2]:2025-11-02 04:24:22,222 - INFO -  step: 100  loss: -2.0000  grad_norm: 31.7874  memory:  6.43GiB(13.53%)  tps: 6,566  tflops: 50.01  mfu: 16.03%
[rank2]:2025-11-02 04:24:22,222 - WARNING - Nothing to draw before the end of warmup.
[rank3]:2025-11-02 04:24:22,234 - INFO -  step: 100  loss:  8.5678  grad_norm: 31.7874  memory: 16.39GiB(34.50%)  tps: 6,566  tflops: 50.01  mfu: 16.03%
[rank3]:2025-11-02 04:24:22,235 - WARNING - Nothing to draw before the end of warmup.
[rank1]:2025-11-02 04:24:22,225 - INFO -  step: 100  loss: -2.0000  grad_norm: 31.7874  memory:  9.03GiB(19.01%)  tps: 6,566  tflops: 50.01  mfu: 16.03%
[rank1]:2025-11-02 04:24:22,225 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-11-02 04:24:22,236 - INFO -  step: 100  loss: -2.0000  grad_norm: 31.7874  memory: 12.97GiB(27.31%)  tps: 6,566  tflops: 50.01  mfu: 16.03%
[rank0]:2025-11-02 04:24:22,236 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-11-02 04:25:23,292 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-02 04:25:24,578 - INFO -  step: 150  loss: -2.0000  grad_norm: 46.5046  memory: 12.97GiB(27.31%)  tps: 6,570  tflops: 50.04  mfu: 16.04%
[rank2]:2025-11-02 04:25:24,564 - INFO -  step: 150  loss: -2.0000  grad_norm: 46.5046  memory:  6.43GiB(13.53%)  tps: 6,570  tflops: 50.04  mfu: 16.04%
[rank3]:2025-11-02 04:25:24,576 - INFO -  step: 150  loss:  5.0347  grad_norm: 46.5046  memory: 16.39GiB(34.50%)  tps: 6,570  tflops: 50.04  mfu: 16.04%
[rank1]:2025-11-02 04:25:24,567 - INFO -  step: 150  loss: -2.0000  grad_norm: 46.5046  memory:  9.03GiB(19.01%)  tps: 6,570  tflops: 50.04  mfu: 16.04%
[rank0]:2025-11-02 04:26:25,966 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 04:26:26,979 - INFO - Avg. fwd time: 7.1591 / Avg. bwd time: 18.2280 / Avg. batch time: 525.1742 (ms) / GPU bubble ratio: 61.33%
[rank3]:2025-11-02 04:26:26,940 - INFO - Avg. fwd time: 12.3899 / Avg. bwd time: 40.1914 / Avg. batch time: 494.6656 (ms) / GPU bubble ratio: 14.96%
[rank1]:2025-11-02 04:26:27,012 - INFO - Avg. fwd time: 9.2491 / Avg. bwd time: 23.3848 / Avg. batch time: 565.0986 (ms) / GPU bubble ratio: 53.80%
[rank0]:2025-11-02 04:26:27,008 - INFO - Avg. fwd time: 7.6543 / Avg. bwd time: 23.4753 / Avg. batch time: 601.8771 (ms) / GPU bubble ratio: 58.62%
[rank0]:2025-11-02 04:26:27,252 - INFO -  step: 200  loss: -2.0000  grad_norm: 38.9791  memory: 12.97GiB(27.31%)  tps: 6,535  tflops: 49.78  mfu: 15.95%
[rank0]:2025-11-02 04:26:27,253 - INFO - ðŸ”Ž  Running validation at step 200
[rank2]:2025-11-02 04:26:27,237 - INFO -  step: 200  loss: -2.0000  grad_norm: 38.9791  memory:  6.43GiB(13.53%)  tps: 6,535  tflops: 49.78  mfu: 15.95%
[rank2]:2025-11-02 04:26:27,238 - INFO - ðŸ”Ž  Running validation at step 200
[rank3]:2025-11-02 04:26:27,250 - INFO -  step: 200  loss:  1.7725  grad_norm: 38.9791  memory: 16.39GiB(34.50%)  tps: 6,536  tflops: 49.78  mfu: 15.95%
[rank3]:2025-11-02 04:26:27,250 - INFO - ðŸ”Ž  Running validation at step 200
[rank1]:2025-11-02 04:26:27,241 - INFO -  step: 200  loss: -2.0000  grad_norm: 38.9791  memory:  9.03GiB(19.01%)  tps: 6,535  tflops: 49.78  mfu: 15.95%
[rank1]:2025-11-02 04:26:27,241 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-11-02 04:26:49,478 - INFO - validate step: 200  loss: -1.0000  memory: 12.97GiB(27.31%)  tps: 18,429
[rank0]:2025-11-02 04:26:49,479 - WARNING - Nothing to draw before the end of warmup.
[rank2]:2025-11-02 04:26:49,512 - INFO - validate step: 200  loss: -1.0000  memory:  6.43GiB(13.53%)  tps: 18,389
[rank2]:2025-11-02 04:26:49,513 - WARNING - Nothing to draw before the end of warmup.
[rank3]:2025-11-02 04:26:49,503 - INFO - validate step: 200  loss:  1.5286  memory: 16.39GiB(34.50%)  tps: 18,408
[rank3]:2025-11-02 04:26:49,504 - WARNING - Nothing to draw before the end of warmup.
[rank1]:2025-11-02 04:26:49,493 - INFO - validate step: 200  loss: -1.0000  memory:  9.03GiB(19.01%)  tps: 18,407
[rank1]:2025-11-02 04:26:49,494 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-11-02 04:27:50,578 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-11-02 04:27:51,823 - INFO -  step: 250  loss: -2.0000  grad_norm: 27.6829  memory:  9.03GiB(19.01%)  tps: 6,572  tflops: 50.05  mfu: 16.04%
[rank2]:2025-11-02 04:27:51,819 - INFO -  step: 250  loss: -2.0000  grad_norm: 27.6829  memory:  6.43GiB(13.53%)  tps: 6,574  tflops: 50.07  mfu: 16.05%
[rank0]:2025-11-02 04:27:51,833 - INFO -  step: 250  loss: -2.0000  grad_norm: 27.6829  memory: 12.97GiB(27.31%)  tps: 6,569  tflops: 50.03  mfu: 16.04%
[rank3]:2025-11-02 04:27:51,832 - INFO -  step: 250  loss:  0.6302  grad_norm: 27.6829  memory: 16.39GiB(34.50%)  tps: 6,572  tflops: 50.05  mfu: 16.04%
[rank3]:2025-11-02 04:28:03,987 - INFO - [Step 260] ã€°ï¸ Monitoring Upperbound
[rank2]:2025-11-02 04:28:16,606 - WARNING - [Step 270] â³ Monitoring Upperbound... (540/550)
[rank3]:2025-11-02 04:28:16,582 - WARNING - [Step 270] â³ Monitoring Upperbound... (540/550)
[rank1]:2025-11-02 04:28:16,635 - WARNING - [Step 270] â³ Monitoring Upperbound... (540/550)
[rank0]:2025-11-02 04:28:16,663 - WARNING - [Step 270] â³ Monitoring Upperbound... (540/550)
[rank3]:2025-11-02 04:28:28,874 - INFO - [Step 280] âœ”ï¸  Setting Upperbound
[rank2]:2025-11-02 04:28:29,199 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-02 04:28:29,225 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-02 04:28:29,255 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-02 04:28:29,210 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-02 04:28:29,236 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-02 04:28:29,264 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-02 04:28:29,175 - INFO - [Step 280] ã€°ï¸ Monitoring Lowerbound
[rank3]:2025-11-02 04:28:29,194 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-02 04:28:29,214 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-02 04:28:29,234 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-02 04:28:29,258 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-02 04:28:29,209 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-02 04:28:29,241 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-02 04:28:29,269 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-02 04:28:29,283 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-02 04:28:29,310 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-02 04:28:29,348 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-02 04:28:29,330 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-02 04:28:29,282 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-02 04:28:29,304 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-02 04:28:29,334 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-02 04:28:29,331 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-02 04:28:29,370 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-02 04:28:29,403 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-02 04:28:29,386 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-02 04:28:29,418 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-02 04:28:29,374 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-02 04:28:29,375 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-02 04:28:29,375 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-02 04:28:29,376 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-02 04:28:29,376 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-02 04:28:29,416 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-02 04:28:29,436 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-02 04:28:44,955 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 04:28:45,765 - INFO - Avg. fwd time: 7.1741 / Avg. bwd time: 17.5584 / Avg. batch time: 513.8456 (ms) / GPU bubble ratio: 61.49%
[rank3]:2025-11-02 04:28:45,751 - INFO - Avg. fwd time: 12.4606 / Avg. bwd time: 38.8956 / Avg. batch time: 484.1663 (ms) / GPU bubble ratio: 15.14%
[rank3]:2025-11-02 04:28:45,765 - INFO - [Step 300] âœ”ï¸  Setting Lowerbound
[rank0]:2025-11-02 04:28:45,786 - INFO - Avg. fwd time: 7.6543 / Avg. bwd time: 21.9370 / Avg. batch time: 587.1706 (ms) / GPU bubble ratio: 59.68%
[rank1]:2025-11-02 04:28:45,781 - INFO - Avg. fwd time: 9.2949 / Avg. bwd time: 22.5566 / Avg. batch time: 552.1071 (ms) / GPU bubble ratio: 53.85%
[rank1]:2025-11-02 04:28:45,807 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.02/0.02, [MB7] 1.00/1.00
[rank1]:2025-11-02 04:28:45,808 - INFO -  step: 300  loss: -2.0000  grad_norm:  0.0000  memory:  9.03GiB(19.01%)  tps: 7,587  tflops: 57.79  mfu: 18.52%
[rank2]:2025-11-02 04:28:45,812 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-02 04:28:45,813 - INFO -  step: 300  loss: -2.0000  grad_norm:  0.0000  memory:  6.43GiB(13.53%)  tps: 7,586  tflops: 57.78  mfu: 18.52%
[rank0]:2025-11-02 04:28:45,803 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.56/0.56, [MB7] 1.00/1.00
[rank0]:2025-11-02 04:28:45,804 - INFO -  step: 300  loss: -2.0000  grad_norm:  0.0000  memory: 12.97GiB(27.31%)  tps: 7,589  tflops: 57.80  mfu: 18.53%
[rank3]:2025-11-02 04:28:46,011 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/pipeline_schedule/251102_0428_max_batch_time.svg
[rank3]:> Batch Time: 509.70 ms, GPU Bubble Ratio: 51.45%, 49.13%, 60.57%, 18.48%
[rank3]:2025-11-02 04:28:46,196 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/pipeline_schedule/251102_0428_min_batch_time.svg
[rank3]:> Batch Time: 308.95 ms, GPU Bubble Ratio: 80.79%, 49.47%, 61.09%, 15.24%
[rank3]:2025-11-02 04:28:46,403 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/pipeline_schedule/251102_0428_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 335.45 ms, GPU Bubble Ratio: 37.35%, 26.66%, 43.14%, 14.04%
[rank3]:2025-11-02 04:28:46,403 - INFO - 	> Batch Time: 335.45 ms (Average Freeze Ratio: 0.31, Time Reduction Rate: 0.34)
[rank3]:2025-11-02 04:28:46,404 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.40/0.40, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-11-02 04:28:46,407 - INFO -  step: 300  loss:  0.2943  grad_norm:  0.0000  memory: 16.39GiB(34.50%)  tps: 7,506  tflops: 57.16  mfu: 18.32%
[rank0]:2025-11-02 04:28:46,491 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251102_0428_stage0_step300.svg
[rank1]:2025-11-02 04:28:46,499 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251102_0428_stage1_step300.svg
[rank2]:2025-11-02 04:28:46,499 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251102_0428_stage2_step300.svg
[rank3]:2025-11-02 04:28:46,585 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/pipeline_schedule/251102_0428_real_step300_rank3.svg
[rank3]:> Batch Time: 320.53 ms, GPU Bubble Ratio: 78.46%, 46.71%, 58.72%, 14.59%
[rank3]:2025-11-02 04:28:46,655 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251102_0428_stage3_step300.svg
[rank0]:2025-11-02 04:29:39,358 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 04:29:40,179 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.27/0.40, [MB2] 0.67/1.00, [MB3] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank1]:2025-11-02 04:29:40,397 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.01/0.02, [MB7] 0.67/1.00
[rank3]:2025-11-02 04:29:40,447 - INFO -  step: 350  loss:  0.1917  grad_norm:  0.5118  memory: 17.37GiB(36.55%)  tps: 7,580  tflops: 57.73  mfu: 18.50%
[rank2]:2025-11-02 04:29:40,373 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.67/1.00
[rank2]:2025-11-02 04:29:40,436 - INFO -  step: 350  loss: -2.0000  grad_norm:  0.5118  memory:  6.51GiB(13.70%)  tps: 7,499  tflops: 57.11  mfu: 18.31%
[rank0]:2025-11-02 04:29:40,422 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.38/0.56, [MB7] 0.67/1.00
[rank0]:2025-11-02 04:29:40,451 - INFO -  step: 350  loss: -2.0000  grad_norm:  0.5118  memory: 13.15GiB(27.68%)  tps: 7,495  tflops: 57.09  mfu: 18.30%
[rank1]:2025-11-02 04:29:40,439 - INFO -  step: 350  loss: -2.0000  grad_norm:  0.5118  memory:  9.36GiB(19.71%)  tps: 7,498  tflops: 57.10  mfu: 18.30%
[rank0]:2025-11-02 04:30:30,884 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 04:30:31,641 - INFO - Avg. fwd time: 12.6418 / Avg. bwd time: 36.4294 / Avg. batch time: 466.0332 (ms) / GPU bubble ratio: 15.76%
[rank3]:2025-11-02 04:30:31,650 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.40/0.40, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank2]:2025-11-02 04:30:31,706 - INFO - Avg. fwd time: 7.1824 / Avg. bwd time: 17.3299 / Avg. batch time: 495.5748 (ms) / GPU bubble ratio: 60.43%
[rank1]:2025-11-02 04:30:31,743 - INFO - Avg. fwd time: 9.3506 / Avg. bwd time: 21.9631 / Avg. batch time: 533.2148 (ms) / GPU bubble ratio: 53.02%
[rank0]:2025-11-02 04:30:31,737 - INFO - Avg. fwd time: 7.7289 / Avg. bwd time: 20.5614 / Avg. batch time: 567.4474 (ms) / GPU bubble ratio: 60.12%
[rank1]:2025-11-02 04:30:31,869 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.02/0.02, [MB7] 1.00/1.00
[rank3]:2025-11-02 04:30:31,913 - INFO -  step: 400  loss:  0.2251  grad_norm:  0.3041  memory: 17.37GiB(36.55%)  tps: 7,959  tflops: 60.62  mfu: 19.43%
[rank3]:2025-11-02 04:30:31,914 - INFO - ðŸ”Ž  Running validation at step 400
[rank2]:2025-11-02 04:30:31,847 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-02 04:30:31,903 - INFO -  step: 400  loss: -2.0000  grad_norm:  0.3041  memory:  6.53GiB(13.74%)  tps: 7,959  tflops: 60.61  mfu: 19.43%
[rank2]:2025-11-02 04:30:31,903 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-11-02 04:30:31,889 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.56/0.56, [MB7] 1.00/1.00
[rank0]:2025-11-02 04:30:31,918 - INFO -  step: 400  loss: -2.0000  grad_norm:  0.3041  memory: 13.15GiB(27.68%)  tps: 7,959  tflops: 60.62  mfu: 19.43%
[rank0]:2025-11-02 04:30:31,918 - INFO - ðŸ”Ž  Running validation at step 400
[rank1]:2025-11-02 04:30:31,907 - INFO -  step: 400  loss: -2.0000  grad_norm:  0.3041  memory:  9.42GiB(19.83%)  tps: 7,958  tflops: 60.61  mfu: 19.43%
[rank1]:2025-11-02 04:30:31,907 - INFO - ðŸ”Ž  Running validation at step 400
[rank3]:2025-11-02 04:30:53,033 - INFO - validate step: 400  loss:  0.9335  memory: 17.37GiB(36.55%)  tps: 19,396
[rank2]:2025-11-02 04:30:53,044 - INFO - validate step: 400  loss: -1.0000  memory:  6.53GiB(13.74%)  tps: 19,375
[rank0]:2025-11-02 04:30:53,004 - INFO - validate step: 400  loss: -1.0000  memory: 13.15GiB(27.68%)  tps: 19,425
[rank1]:2025-11-02 04:30:53,019 - INFO - validate step: 400  loss: -1.0000  memory:  9.42GiB(19.83%)  tps: 19,401
[rank2]:2025-11-02 04:30:53,122 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251102_0430_stage2_step400.svg
[rank0]:2025-11-02 04:30:53,126 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251102_0430_stage0_step400.svg
[rank1]:2025-11-02 04:30:53,124 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251102_0430_stage1_step400.svg
[rank3]:2025-11-02 04:30:53,239 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/pipeline_schedule/251102_0430_real_step400_rank3.svg
[rank3]:> Batch Time: 388.52 ms, GPU Bubble Ratio: 53.96%, 40.06%, 52.41%, 21.36%
[rank3]:2025-11-02 04:30:53,315 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251102_0430_stage3_step400.svg
[rank0]:2025-11-02 04:31:40,941 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-02 04:31:41,827 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.40/0.40, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank2]:2025-11-02 04:31:41,848 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-02 04:31:41,909 - INFO -  step: 450  loss: -2.0000  grad_norm:  0.4628  memory:  6.53GiB(13.74%)  tps: 8,382  tflops: 63.84  mfu: 20.46%
[rank0]:2025-11-02 04:31:41,896 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.56/0.56, [MB7] 1.00/1.00
[rank0]:2025-11-02 04:31:41,924 - INFO -  step: 450  loss: -2.0000  grad_norm:  0.4628  memory: 13.15GiB(27.68%)  tps: 8,373  tflops: 63.77  mfu: 20.44%
[rank1]:2025-11-02 04:31:41,874 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.02/0.02, [MB7] 1.00/1.00
[rank1]:2025-11-02 04:31:41,913 - INFO -  step: 450  loss: -2.0000  grad_norm:  0.4628  memory:  9.42GiB(19.83%)  tps: 8,377  tflops: 63.80  mfu: 20.45%
[rank3]:2025-11-02 04:31:41,904 - INFO -  step: 450  loss:  0.2300  grad_norm:  0.4628  memory: 17.37GiB(36.55%)  tps: 8,382  tflops: 63.84  mfu: 20.46%
[rank0]:2025-11-02 04:32:29,891 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 04:32:30,634 - INFO - Avg. fwd time: 12.8424 / Avg. bwd time: 33.7134 / Avg. batch time: 445.7415 (ms) / GPU bubble ratio: 16.44%
[rank0]:2025-11-02 04:32:30,693 - INFO - Avg. fwd time: 7.8258 / Avg. bwd time: 18.3556 / Avg. batch time: 545.2398 (ms) / GPU bubble ratio: 61.59%
[rank2]:2025-11-02 04:32:30,699 - INFO - Avg. fwd time: 7.2216 / Avg. bwd time: 16.9460 / Avg. batch time: 474.9584 (ms) / GPU bubble ratio: 59.29%
[rank1]:2025-11-02 04:32:30,735 - INFO - Avg. fwd time: 9.4439 / Avg. bwd time: 21.2291 / Avg. batch time: 512.0000 (ms) / GPU bubble ratio: 52.07%
[rank2]:2025-11-02 04:32:30,995 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/pipeline_schedule_adjustment/251102_0432_rank2_trend_line.svg
[rank1]:2025-11-02 04:32:31,004 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/pipeline_schedule_adjustment/251102_0432_rank1_trend_line.svg
[rank3]:2025-11-02 04:32:31,004 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/pipeline_schedule_adjustment/251102_0432_rank3_trend_line.svg
[rank2]:2025-11-02 04:32:31,033 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-02 04:32:31,034 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-02 04:32:31,034 - INFO -  step: 500  loss: -2.0000  grad_norm:  0.2722  memory:  6.53GiB(13.74%)  tps: 8,338  tflops: 63.50  mfu: 20.35%
[rank0]:2025-11-02 04:32:31,025 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/pipeline_schedule_adjustment/251102_0432_rank0_trend_line.svg
[rank0]:2025-11-02 04:32:31,033 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank0]:2025-11-02 04:32:31,034 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank0]:2025-11-02 04:32:31,034 - INFO -  step: 500  loss: -2.0000  grad_norm:  0.2722  memory: 13.15GiB(27.68%)  tps: 8,340  tflops: 63.52  mfu: 20.36%
[rank1]:2025-11-02 04:32:31,033 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank1]:2025-11-02 04:32:31,034 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank1]:2025-11-02 04:32:31,035 - INFO -  step: 500  loss: -2.0000  grad_norm:  0.2722  memory:  9.42GiB(19.83%)  tps: 8,339  tflops: 63.51  mfu: 20.36%
[rank3]:2025-11-02 04:32:31,228 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/pipeline_schedule/251102_0432_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 372.00 ms, GPU Bubble Ratio: 59.59%, 39.95%, 50.75%, 20.07%
[rank3]:2025-11-02 04:32:31,229 - INFO - 	> Batch Time: 372.00 ms (Average Freeze Ratio: 0.23)
[rank3]:2025-11-02 04:32:31,229 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 0.40/0.40, [MB7] 0.00/0.00
[rank3]:2025-11-02 04:32:31,230 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 0.40/0.40, [MB7] 0.00/0.00
[rank3]:2025-11-02 04:32:31,233 - INFO -  step: 500  loss:  0.2626  grad_norm:  0.2722  memory: 17.37GiB(36.55%)  tps: 8,304  tflops: 63.24  mfu: 20.27%
[rank2]:2025-11-02 04:32:31,299 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251102_0432_stage2_step500.svg
[rank1]:2025-11-02 04:32:31,301 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251102_0432_stage1_step500.svg
[rank0]:2025-11-02 04:32:31,305 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251102_0432_stage0_step500.svg
[rank3]:2025-11-02 04:32:31,414 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/pipeline_schedule/251102_0432_real_step500_rank3.svg
[rank3]:> Batch Time: 380.94 ms, GPU Bubble Ratio: 61.86%, 40.81%, 51.94%, 21.38%
[rank3]:2025-11-02 04:32:31,477 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251102_0432_stage3_step500.svg
[rank0]:2025-11-02 04:33:20,207 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 04:33:21,215 - INFO -  step: 550  loss: -2.0000  grad_norm:  0.5482  memory:  6.53GiB(13.74%)  tps: 8,163  tflops: 62.17  mfu: 19.93%
[rank0]:2025-11-02 04:33:21,229 - INFO -  step: 550  loss: -2.0000  grad_norm:  0.5482  memory: 13.15GiB(27.68%)  tps: 8,160  tflops: 62.15  mfu: 19.92%
[rank1]:2025-11-02 04:33:21,218 - INFO -  step: 550  loss: -2.0000  grad_norm:  0.5482  memory:  9.42GiB(19.83%)  tps: 8,162  tflops: 62.16  mfu: 19.92%
[rank3]:2025-11-02 04:33:21,223 - INFO -  step: 550  loss:  0.2570  grad_norm:  0.5482  memory: 17.37GiB(36.55%)  tps: 8,194  tflops: 62.41  mfu: 20.00%
[rank0]:2025-11-02 04:34:09,752 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 04:34:10,701 - INFO - Avg. fwd time: 7.2500 / Avg. bwd time: 16.6961 / Avg. batch time: 461.0692 (ms) / GPU bubble ratio: 58.45%
[rank1]:2025-11-02 04:34:10,731 - INFO - Avg. fwd time: 9.4247 / Avg. bwd time: 21.6981 / Avg. batch time: 498.2775 (ms) / GPU bubble ratio: 50.03%
[rank3]:2025-11-02 04:34:10,680 - INFO - Avg. fwd time: 12.9316 / Avg. bwd time: 31.9487 / Avg. batch time: 432.1021 (ms) / GPU bubble ratio: 16.91%
[rank0]:2025-11-02 04:34:10,760 - INFO - Avg. fwd time: 7.7723 / Avg. bwd time: 19.1786 / Avg. batch time: 532.0873 (ms) / GPU bubble ratio: 59.48%
[rank2]:2025-11-02 04:34:10,909 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/pipeline_schedule_adjustment/251102_0434_rank2_trend_line.svg
[rank0]:2025-11-02 04:34:10,931 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/pipeline_schedule_adjustment/251102_0434_rank0_trend_line.svg
[rank0]:2025-11-02 04:34:10,939 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank0]:2025-11-02 04:34:10,940 - INFO -  step: 600  loss: -2.0000  grad_norm:  0.7888  memory: 13.15GiB(27.68%)  tps: 8,240  tflops: 62.76  mfu: 20.11%
[rank0]:2025-11-02 04:34:10,940 - INFO - ðŸ”Ž  Running validation at step 600
[rank1]:2025-11-02 04:34:10,915 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/pipeline_schedule_adjustment/251102_0434_rank1_trend_line.svg
[rank1]:2025-11-02 04:34:10,939 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank1]:2025-11-02 04:34:10,940 - INFO -  step: 600  loss: -2.0000  grad_norm:  0.7888  memory:  9.42GiB(19.83%)  tps: 8,238  tflops: 62.74  mfu: 20.11%
[rank1]:2025-11-02 04:34:10,940 - INFO - ðŸ”Ž  Running validation at step 600
[rank3]:2025-11-02 04:34:10,918 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/pipeline_schedule_adjustment/251102_0434_rank3_trend_line.svg
[rank2]:2025-11-02 04:34:10,938 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-02 04:34:10,940 - INFO -  step: 600  loss: -2.0000  grad_norm:  0.7888  memory:  6.53GiB(13.74%)  tps: 8,237  tflops: 62.74  mfu: 20.11%
[rank2]:2025-11-02 04:34:10,940 - INFO - ðŸ”Ž  Running validation at step 600
[rank3]:2025-11-02 04:34:11,132 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/pipeline_schedule/251102_0434_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 373.93 ms, GPU Bubble Ratio: 49.60%, 36.22%, 51.36%, 21.71%
[rank3]:2025-11-02 04:34:11,133 - INFO - 	> Batch Time: 373.93 ms (Average Freeze Ratio: 0.23)
[rank3]:2025-11-02 04:34:11,133 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 0.40/0.40, [MB7] 0.00/0.00
[rank3]:2025-11-02 04:34:11,137 - INFO -  step: 600  loss:  0.2194  grad_norm:  0.7888  memory: 17.37GiB(36.55%)  tps: 8,206  tflops: 62.50  mfu: 20.03%
[rank3]:2025-11-02 04:34:11,138 - INFO - ðŸ”Ž  Running validation at step 600
[rank2]:2025-11-02 04:34:30,622 - INFO - validate step: 600  loss: -1.0000  memory:  6.53GiB(13.74%)  tps: 20,811
[rank0]:2025-11-02 04:34:30,590 - INFO - validate step: 600  loss: -1.0000  memory: 13.15GiB(27.68%)  tps: 20,845
[rank1]:2025-11-02 04:34:30,605 - INFO - validate step: 600  loss: -1.0000  memory:  9.42GiB(19.83%)  tps: 20,829
[rank3]:2025-11-02 04:34:30,612 - INFO - validate step: 600  loss:  0.9293  memory: 17.37GiB(36.55%)  tps: 21,034
[rank2]:2025-11-02 04:34:30,695 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251102_0434_stage2_step600.svg
[rank0]:2025-11-02 04:34:30,694 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251102_0434_stage0_step600.svg
[rank1]:2025-11-02 04:34:30,693 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251102_0434_stage1_step600.svg
[rank3]:2025-11-02 04:34:30,820 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/pipeline_schedule/251102_0434_real_step600_rank3.svg
[rank3]:> Batch Time: 386.91 ms, GPU Bubble Ratio: 35.30%, 30.71%, 52.70%, 23.77%
[rank3]:2025-11-02 04:34:30,888 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251102_0434_stage3_step600.svg
[rank0]:2025-11-02 04:35:19,263 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-02 04:35:20,251 - INFO -  step: 650  loss:  0.3579  grad_norm:  1.3360  memory: 17.37GiB(36.55%)  tps: 8,252  tflops: 62.85  mfu: 20.14%
[rank2]:2025-11-02 04:35:20,255 - INFO -  step: 650  loss: -2.0000  grad_norm:  1.3360  memory:  6.53GiB(13.74%)  tps: 8,252  tflops: 62.85  mfu: 20.15%
[rank0]:2025-11-02 04:35:20,272 - INFO -  step: 650  loss: -2.0000  grad_norm:  1.3360  memory: 13.15GiB(27.68%)  tps: 8,245  tflops: 62.79  mfu: 20.13%
[rank1]:2025-11-02 04:35:20,259 - INFO -  step: 650  loss: -2.0000  grad_norm:  1.3360  memory:  9.42GiB(19.83%)  tps: 8,249  tflops: 62.83  mfu: 20.14%
[rank0]:2025-11-02 04:36:08,951 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 04:36:09,680 - INFO - Avg. fwd time: 12.9954 / Avg. bwd time: 30.8207 / Avg. batch time: 423.4403 (ms) / GPU bubble ratio: 17.22%
[rank2]:2025-11-02 04:36:09,739 - INFO - Avg. fwd time: 7.2676 / Avg. bwd time: 16.5417 / Avg. batch time: 452.3052 (ms) / GPU bubble ratio: 57.89%
[rank0]:2025-11-02 04:36:09,777 - INFO - Avg. fwd time: 7.7389 / Avg. bwd time: 19.7843 / Avg. batch time: 523.8654 (ms) / GPU bubble ratio: 57.97%
[rank1]:2025-11-02 04:36:09,782 - INFO - Avg. fwd time: 9.4054 / Avg. bwd time: 22.0264 / Avg. batch time: 489.6456 (ms) / GPU bubble ratio: 48.65%
[rank2]:2025-11-02 04:36:09,948 - INFO -  step: 700  loss: -2.0000  grad_norm:  0.5780  memory:  6.53GiB(13.74%)  tps: 8,243  tflops: 62.78  mfu: 20.12%
[rank0]:2025-11-02 04:36:09,963 - INFO -  step: 700  loss: -2.0000  grad_norm:  0.5780  memory: 13.15GiB(27.68%)  tps: 8,243  tflops: 62.78  mfu: 20.12%
[rank1]:2025-11-02 04:36:09,952 - INFO -  step: 700  loss: -2.0000  grad_norm:  0.5780  memory:  9.42GiB(19.83%)  tps: 8,243  tflops: 62.78  mfu: 20.12%
[rank3]:2025-11-02 04:36:09,958 - INFO -  step: 700  loss:  0.2332  grad_norm:  0.5780  memory: 17.37GiB(36.55%)  tps: 8,241  tflops: 62.76  mfu: 20.12%
[rank2]:2025-11-02 04:36:10,041 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251102_0436_stage2_step700.svg
[rank0]:2025-11-02 04:36:10,041 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251102_0436_stage0_step700.svg
[rank1]:2025-11-02 04:36:10,041 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251102_0436_stage1_step700.svg
[rank3]:2025-11-02 04:36:10,164 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/pipeline_schedule/251102_0436_real_step700_rank3.svg
[rank3]:> Batch Time: 388.50 ms, GPU Bubble Ratio: 35.45%, 31.19%, 52.84%, 23.72%
[rank3]:2025-11-02 04:36:10,235 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251102_0436_stage3_step700.svg
[rank0]:2025-11-02 04:36:58,686 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 04:36:59,681 - INFO -  step: 750  loss:  0.2257  grad_norm:  0.3875  memory: 17.37GiB(36.55%)  tps: 8,238  tflops: 62.74  mfu: 20.11%
[rank1]:2025-11-02 04:36:59,691 - INFO -  step: 750  loss: -2.0000  grad_norm:  0.3875  memory:  9.42GiB(19.83%)  tps: 8,235  tflops: 62.72  mfu: 20.10%
[rank2]:2025-11-02 04:36:59,688 - INFO -  step: 750  loss: -2.0000  grad_norm:  0.3875  memory:  6.53GiB(13.74%)  tps: 8,235  tflops: 62.72  mfu: 20.10%
[rank0]:2025-11-02 04:36:59,702 - INFO -  step: 750  loss: -2.0000  grad_norm:  0.3875  memory: 13.15GiB(27.68%)  tps: 8,235  tflops: 62.72  mfu: 20.10%
[rank0]:2025-11-02 04:37:48,355 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 04:37:49,090 - INFO - Avg. fwd time: 13.0462 / Avg. bwd time: 29.8554 / Avg. batch time: 415.9923 (ms) / GPU bubble ratio: 17.50%
[rank2]:2025-11-02 04:37:49,150 - INFO - Avg. fwd time: 7.2833 / Avg. bwd time: 16.4072 / Avg. batch time: 444.7316 (ms) / GPU bubble ratio: 57.38%
[rank0]:2025-11-02 04:37:49,188 - INFO - Avg. fwd time: 7.7083 / Avg. bwd time: 20.3209 / Avg. batch time: 516.7559 (ms) / GPU bubble ratio: 56.61%
[rank1]:2025-11-02 04:37:49,191 - INFO - Avg. fwd time: 9.3908 / Avg. bwd time: 22.3168 / Avg. batch time: 482.1842 (ms) / GPU bubble ratio: 47.39%
[rank2]:2025-11-02 04:37:49,513 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/pipeline_schedule_adjustment/251102_0437_rank2_trend_line.svg
[rank3]:2025-11-02 04:37:49,509 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/pipeline_schedule_adjustment/251102_0437_rank3_trend_line.svg
[rank1]:2025-11-02 04:37:49,524 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/pipeline_schedule_adjustment/251102_0437_rank1_trend_line.svg
[rank2]:2025-11-02 04:37:49,559 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-02 04:37:49,560 - INFO -  step: 800  loss: -2.0000  grad_norm:  0.7125  memory:  6.53GiB(13.74%)  tps: 8,213  tflops: 62.55  mfu: 20.05%
[rank2]:2025-11-02 04:37:49,560 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-11-02 04:37:49,551 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/pipeline_schedule_adjustment/251102_0437_rank0_trend_line.svg
[rank0]:2025-11-02 04:37:49,559 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-11-02 04:37:49,560 - INFO -  step: 800  loss: -2.0000  grad_norm:  0.7125  memory: 13.15GiB(27.68%)  tps: 8,215  tflops: 62.57  mfu: 20.05%
[rank0]:2025-11-02 04:37:49,561 - INFO - ðŸ”Ž  Running validation at step 800
[rank1]:2025-11-02 04:37:49,559 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-11-02 04:37:49,560 - INFO -  step: 800  loss: -2.0000  grad_norm:  0.7125  memory:  9.42GiB(19.83%)  tps: 8,214  tflops: 62.56  mfu: 20.05%
[rank1]:2025-11-02 04:37:49,561 - INFO - ðŸ”Ž  Running validation at step 800
[rank3]:2025-11-02 04:37:49,751 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/pipeline_schedule/251102_0437_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 371.74 ms, GPU Bubble Ratio: 42.64%, 33.24%, 51.34%, 22.16%
[rank3]:2025-11-02 04:37:49,752 - INFO - 	> Batch Time: 371.74 ms (Average Freeze Ratio: 0.29)
[rank3]:2025-11-02 04:37:49,752 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 0.40/0.40, [MB7] 0.00/0.00
[rank3]:2025-11-02 04:37:49,756 - INFO -  step: 800  loss:  0.2621  grad_norm:  0.7125  memory: 17.37GiB(36.55%)  tps: 8,180  tflops: 62.30  mfu: 19.97%
[rank3]:2025-11-02 04:37:49,757 - INFO - ðŸ”Ž  Running validation at step 800
[rank2]:2025-11-02 04:38:09,226 - INFO - validate step: 800  loss: -1.0000  memory:  6.53GiB(13.74%)  tps: 20,828
[rank0]:2025-11-02 04:38:09,195 - INFO - validate step: 800  loss: -1.0000  memory: 13.15GiB(27.68%)  tps: 20,862
[rank1]:2025-11-02 04:38:09,209 - INFO - validate step: 800  loss: -1.0000  memory:  9.42GiB(19.83%)  tps: 20,847
[rank3]:2025-11-02 04:38:09,215 - INFO - validate step: 800  loss:  0.9303  memory: 17.37GiB(36.55%)  tps: 21,051
[rank2]:2025-11-02 04:38:09,303 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251102_0438_stage2_step800.svg
[rank0]:2025-11-02 04:38:09,302 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251102_0438_stage0_step800.svg
[rank1]:2025-11-02 04:38:09,303 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251102_0438_stage1_step800.svg
[rank3]:2025-11-02 04:38:09,419 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/pipeline_schedule/251102_0438_real_step800_rank3.svg
[rank3]:> Batch Time: 385.91 ms, GPU Bubble Ratio: 34.96%, 30.61%, 52.45%, 23.93%
[rank3]:2025-11-02 04:38:09,489 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251102_0438_stage3_step800.svg
[rank3]:2025-11-02 04:38:19,459 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-11-02 04:38:19,644 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-11-02 04:38:19,664 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-11-02 04:38:19,684 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-11-02 04:38:57,051 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-11-02 04:38:58,023 - INFO -  step: 850  loss: -2.0000  grad_norm:  0.3514  memory:  9.42GiB(19.83%)  tps: 8,391  tflops: 63.91  mfu: 20.48%
[rank3]:2025-11-02 04:38:58,028 - INFO -  step: 850  loss:  0.2077  grad_norm:  0.3514  memory: 17.37GiB(36.55%)  tps: 8,392  tflops: 63.91  mfu: 20.49%
[rank2]:2025-11-02 04:38:58,019 - INFO -  step: 850  loss: -2.0000  grad_norm:  0.3514  memory:  6.53GiB(13.74%)  tps: 8,395  tflops: 63.94  mfu: 20.49%
[rank0]:2025-11-02 04:38:58,035 - INFO -  step: 850  loss: -2.0000  grad_norm:  0.3514  memory: 13.15GiB(27.68%)  tps: 8,387  tflops: 63.87  mfu: 20.47%
[rank0]:2025-11-02 04:39:45,251 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 04:39:46,143 - INFO - Avg. fwd time: 13.0948 / Avg. bwd time: 29.0773 / Avg. batch time: 410.0920 (ms) / GPU bubble ratio: 17.73%
[rank1]:2025-11-02 04:39:46,192 - INFO - Avg. fwd time: 9.4402 / Avg. bwd time: 21.8958 / Avg. batch time: 475.8704 (ms) / GPU bubble ratio: 47.32%
[rank2]:2025-11-02 04:39:46,165 - INFO - Avg. fwd time: 7.2954 / Avg. bwd time: 16.3053 / Avg. batch time: 438.7603 (ms) / GPU bubble ratio: 56.97%
[rank2]:2025-11-02 04:39:46,236 - INFO -  step: 900  loss: -2.0000  grad_norm:  0.2958  memory:  6.53GiB(13.74%)  tps: 8,495  tflops: 64.70  mfu: 20.74%
[rank0]:2025-11-02 04:39:46,215 - INFO - Avg. fwd time: 7.7608 / Avg. bwd time: 19.2831 / Avg. batch time: 509.8994 (ms) / GPU bubble ratio: 57.57%
[rank0]:2025-11-02 04:39:46,251 - INFO -  step: 900  loss: -2.0000  grad_norm:  0.2958  memory: 13.15GiB(27.68%)  tps: 8,495  tflops: 64.70  mfu: 20.74%
[rank3]:2025-11-02 04:39:46,229 - INFO -  step: 900  loss:  0.2252  grad_norm:  0.2958  memory: 17.37GiB(36.55%)  tps: 8,498  tflops: 64.72  mfu: 20.74%
[rank1]:2025-11-02 04:39:46,240 - INFO -  step: 900  loss: -2.0000  grad_norm:  0.2958  memory:  9.42GiB(19.83%)  tps: 8,495  tflops: 64.70  mfu: 20.74%
[rank2]:2025-11-02 04:39:46,317 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251102_0439_stage2_step900.svg
[rank0]:2025-11-02 04:39:46,317 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251102_0439_stage0_step900.svg
[rank1]:2025-11-02 04:39:46,318 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251102_0439_stage1_step900.svg
[rank3]:2025-11-02 04:39:46,446 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/pipeline_schedule/251102_0439_real_step900_rank3.svg
[rank3]:> Batch Time: 369.64 ms, GPU Bubble Ratio: 59.07%, 39.06%, 50.38%, 21.92%
[rank3]:2025-11-02 04:39:46,513 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251102_0439_stage3_step900.svg
[rank0]:2025-11-02 04:40:34,134 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 04:40:35,113 - INFO -  step: 950  loss: -2.0000  grad_norm:  0.2382  memory:  6.53GiB(13.74%)  tps: 8,380  tflops: 63.83  mfu: 20.46%
[rank0]:2025-11-02 04:40:35,128 - INFO -  step: 950  loss: -2.0000  grad_norm:  0.2382  memory: 13.15GiB(27.68%)  tps: 8,380  tflops: 63.83  mfu: 20.46%
[rank3]:2025-11-02 04:40:35,122 - INFO -  step: 950  loss:  0.1959  grad_norm:  0.2382  memory: 17.37GiB(36.55%)  tps: 8,378  tflops: 63.81  mfu: 20.45%
[rank1]:2025-11-02 04:40:35,118 - INFO -  step: 950  loss: -2.0000  grad_norm:  0.2382  memory:  9.42GiB(19.83%)  tps: 8,380  tflops: 63.82  mfu: 20.46%
[rank0]:2025-11-02 04:41:22,488 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 04:41:23,216 - INFO - Avg. fwd time: 13.1267 / Avg. bwd time: 28.5637 / Avg. batch time: 406.1937 (ms) / GPU bubble ratio: 17.89%
[rank2]:2025-11-02 04:41:23,276 - INFO - Avg. fwd time: 7.3039 / Avg. bwd time: 16.2357 / Avg. batch time: 434.8228 (ms) / GPU bubble ratio: 56.69%
[rank0]:2025-11-02 04:41:23,311 - INFO - Avg. fwd time: 7.7996 / Avg. bwd time: 18.5055 / Avg. batch time: 505.2873 (ms) / GPU bubble ratio: 58.35%
[rank1]:2025-11-02 04:41:23,311 - INFO - Avg. fwd time: 9.4757 / Avg. bwd time: 21.5759 / Avg. batch time: 471.6705 (ms) / GPU bubble ratio: 47.33%
[rank2]:2025-11-02 04:41:23,468 - INFO -  step: 1000  loss: -2.0000  grad_norm:  0.3236  memory:  6.53GiB(13.74%)  tps: 8,471  tflops: 64.51  mfu: 20.68%
[rank2]:2025-11-02 04:41:23,468 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-11-02 04:41:23,482 - INFO -  step: 1000  loss: -2.0000  grad_norm:  0.3236  memory: 13.15GiB(27.68%)  tps: 8,471  tflops: 64.52  mfu: 20.68%
[rank0]:2025-11-02 04:41:23,482 - INFO - ðŸ”Ž  Running validation at step 1000
[rank3]:2025-11-02 04:41:23,462 - INFO -  step: 1000  loss:  0.2833  grad_norm:  0.3236  memory: 17.37GiB(36.55%)  tps: 8,474  tflops: 64.54  mfu: 20.68%
[rank3]:2025-11-02 04:41:23,463 - INFO - ðŸ”Ž  Running validation at step 1000
[rank1]:2025-11-02 04:41:23,472 - INFO -  step: 1000  loss: -2.0000  grad_norm:  0.3236  memory:  9.42GiB(19.83%)  tps: 8,471  tflops: 64.52  mfu: 20.68%
[rank1]:2025-11-02 04:41:23,472 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-11-02 04:41:43,299 - INFO - validate step: 1000  loss: -1.0000  memory: 13.15GiB(27.68%)  tps: 20,670
[rank3]:2025-11-02 04:41:43,317 - INFO - validate step: 1000  loss:  0.9395  memory: 17.37GiB(36.55%)  tps: 20,631
[rank1]:2025-11-02 04:41:43,313 - INFO - validate step: 1000  loss: -1.0000  memory:  9.42GiB(19.83%)  tps: 20,645
[rank2]:2025-11-02 04:41:43,330 - INFO - validate step: 1000  loss: -1.0000  memory:  6.53GiB(13.74%)  tps: 20,622
[rank2]:2025-11-02 04:41:43,404 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251102_0441_stage2_step1000.svg
[rank0]:2025-11-02 04:41:43,404 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251102_0441_stage0_step1000.svg
[rank1]:2025-11-02 04:41:43,403 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251102_0441_stage1_step1000.svg
[rank3]:2025-11-02 04:41:43,528 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/pipeline_schedule/251102_0441_real_step1000_rank3.svg
[rank3]:> Batch Time: 373.99 ms, GPU Bubble Ratio: 59.57%, 39.78%, 50.97%, 21.62%
[rank3]:2025-11-02 04:41:43,593 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251102_0441_stage3_step1000.svg
[rank0]:2025-11-02 04:42:31,061 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-11-02 04:42:32,051 - INFO -  step: 1050  loss: -2.0000  grad_norm:  0.3236  memory:  6.53GiB(13.74%)  tps: 8,407  tflops: 64.03  mfu: 20.52%
[rank0]:2025-11-02 04:42:32,066 - INFO -  step: 1050  loss: -2.0000  grad_norm:  0.3236  memory: 13.15GiB(27.68%)  tps: 8,399  tflops: 63.97  mfu: 20.50%
[rank3]:2025-11-02 04:42:32,060 - INFO -  step: 1050  loss:  0.3118  grad_norm:  0.3236  memory: 17.37GiB(36.55%)  tps: 8,404  tflops: 64.00  mfu: 20.51%
[rank1]:2025-11-02 04:42:32,055 - INFO -  step: 1050  loss: -2.0000  grad_norm:  0.3236  memory:  9.42GiB(19.83%)  tps: 8,403  tflops: 64.00  mfu: 20.51%
[rank0]:2025-11-02 04:43:19,705 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 04:43:20,439 - INFO - Avg. fwd time: 13.1590 / Avg. bwd time: 28.0661 / Avg. batch time: 402.4330 (ms) / GPU bubble ratio: 18.05%
[rank2]:2025-11-02 04:43:20,498 - INFO - Avg. fwd time: 7.3124 / Avg. bwd time: 16.1684 / Avg. batch time: 431.0025 (ms) / GPU bubble ratio: 56.42%
[rank0]:2025-11-02 04:43:20,533 - INFO - Avg. fwd time: 7.8373 / Avg. bwd time: 17.7606 / Avg. batch time: 500.8220 (ms) / GPU bubble ratio: 59.11%
[rank1]:2025-11-02 04:43:20,534 - INFO - Avg. fwd time: 9.5107 / Avg. bwd time: 21.2693 / Avg. batch time: 467.5970 (ms) / GPU bubble ratio: 47.34%
[rank1]:2025-11-02 04:43:20,699 - INFO -  step: 1100  loss: -2.0000  grad_norm:  0.3366  memory:  9.42GiB(19.83%)  tps: 8,420  tflops: 64.13  mfu: 20.56%
[rank2]:2025-11-02 04:43:20,695 - INFO -  step: 1100  loss: -2.0000  grad_norm:  0.3366  memory:  6.53GiB(13.74%)  tps: 8,420  tflops: 64.13  mfu: 20.56%
[rank0]:2025-11-02 04:43:20,710 - INFO -  step: 1100  loss: -2.0000  grad_norm:  0.3366  memory: 13.15GiB(27.68%)  tps: 8,420  tflops: 64.13  mfu: 20.56%
[rank3]:2025-11-02 04:43:20,703 - INFO -  step: 1100  loss:  0.3268  grad_norm:  0.3366  memory: 17.37GiB(36.55%)  tps: 8,421  tflops: 64.14  mfu: 20.56%
[rank1]:2025-11-02 04:43:20,782 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251102_0443_stage1_step1100.svg
[rank2]:2025-11-02 04:43:20,782 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251102_0443_stage2_step1100.svg
[rank0]:2025-11-02 04:43:20,781 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251102_0443_stage0_step1100.svg
[rank3]:2025-11-02 04:43:20,904 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/pipeline_schedule/251102_0443_real_step1100_rank3.svg
[rank3]:> Batch Time: 378.45 ms, GPU Bubble Ratio: 60.01%, 40.54%, 51.52%, 21.31%
[rank3]:2025-11-02 04:43:20,984 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251102_0443_stage3_step1100.svg
[rank0]:2025-11-02 04:44:08,453 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 04:44:09,448 - INFO -  step: 1150  loss:  0.2285  grad_norm:  0.2728  memory: 17.37GiB(36.55%)  tps: 8,403  tflops: 64.00  mfu: 20.51%
[rank1]:2025-11-02 04:44:09,445 - INFO -  step: 1150  loss: -2.0000  grad_norm:  0.2728  memory:  9.42GiB(19.83%)  tps: 8,403  tflops: 64.00  mfu: 20.51%
[rank2]:2025-11-02 04:44:09,441 - INFO -  step: 1150  loss: -2.0000  grad_norm:  0.2728  memory:  6.53GiB(13.74%)  tps: 8,403  tflops: 64.00  mfu: 20.51%
[rank0]:2025-11-02 04:44:09,456 - INFO -  step: 1150  loss: -2.0000  grad_norm:  0.2728  memory: 13.15GiB(27.68%)  tps: 8,403  tflops: 64.00  mfu: 20.51%
[rank0]:2025-11-02 04:44:56,982 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 04:44:57,903 - INFO - Avg. fwd time: 13.1852 / Avg. bwd time: 27.6586 / Avg. batch time: 399.3500 (ms) / GPU bubble ratio: 18.18%
[rank2]:2025-11-02 04:44:57,926 - INFO - Avg. fwd time: 7.3191 / Avg. bwd time: 16.1126 / Avg. batch time: 427.8835 (ms) / GPU bubble ratio: 56.19%
[rank0]:2025-11-02 04:44:57,976 - INFO - Avg. fwd time: 7.8678 / Avg. bwd time: 17.1447 / Avg. batch time: 497.1750 (ms) / GPU bubble ratio: 59.75%
[rank1]:2025-11-02 04:44:57,952 - INFO - Avg. fwd time: 9.5397 / Avg. bwd time: 21.0173 / Avg. batch time: 464.2765 (ms) / GPU bubble ratio: 47.35%
[rank2]:2025-11-02 04:44:58,233 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/pipeline_schedule_adjustment/251102_0444_rank2_trend_line.svg
[rank3]:2025-11-02 04:44:58,242 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/pipeline_schedule_adjustment/251102_0444_rank3_trend_line.svg
[rank1]:2025-11-02 04:44:58,271 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/pipeline_schedule_adjustment/251102_0444_rank1_trend_line.svg
[rank1]:2025-11-02 04:44:58,308 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-11-02 04:44:58,310 - INFO -  step: 1200  loss: -2.0000  grad_norm:  0.3156  memory:  9.42GiB(19.83%)  tps: 8,382  tflops: 63.84  mfu: 20.46%
[rank1]:2025-11-02 04:44:58,310 - INFO - ðŸ”Ž  Running validation at step 1200
[rank2]:2025-11-02 04:44:58,308 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-02 04:44:58,310 - INFO -  step: 1200  loss: -2.0000  grad_norm:  0.3156  memory:  6.53GiB(13.74%)  tps: 8,382  tflops: 63.84  mfu: 20.46%
[rank2]:2025-11-02 04:44:58,310 - INFO - ðŸ”Ž  Running validation at step 1200
[rank0]:2025-11-02 04:44:58,300 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/pipeline_schedule_adjustment/251102_0444_rank0_trend_line.svg
[rank0]:2025-11-02 04:44:58,308 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank0]:2025-11-02 04:44:58,310 - INFO -  step: 1200  loss: -2.0000  grad_norm:  0.3156  memory: 13.15GiB(27.68%)  tps: 8,384  tflops: 63.86  mfu: 20.47%
[rank0]:2025-11-02 04:44:58,310 - INFO - ðŸ”Ž  Running validation at step 1200
[rank3]:2025-11-02 04:44:58,506 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/pipeline_schedule/251102_0444_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 366.53 ms, GPU Bubble Ratio: 50.36%, 35.68%, 50.82%, 21.75%
[rank3]:2025-11-02 04:44:58,506 - INFO - 	> Batch Time: 366.53 ms (Average Freeze Ratio: 0.26)
[rank3]:2025-11-02 04:44:58,508 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 0.40/0.40, [MB7] 0.00/0.00
[rank3]:2025-11-02 04:44:58,516 - INFO -  step: 1200  loss:  0.1820  grad_norm:  0.3156  memory: 17.37GiB(36.55%)  tps: 8,348  tflops: 63.58  mfu: 20.38%
[rank3]:2025-11-02 04:44:58,517 - INFO - ðŸ”Ž  Running validation at step 1200
[rank1]:2025-11-02 04:45:18,047 - INFO - validate step: 1200  loss: -1.0000  memory:  9.42GiB(19.83%)  tps: 20,753
[rank1]:2025-11-02 04:45:18,047 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-02 04:45:18,063 - INFO - validate step: 1200  loss: -1.0000  memory:  6.53GiB(13.74%)  tps: 20,737
[rank2]:2025-11-02 04:45:18,063 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-02 04:45:18,032 - INFO - validate step: 1200  loss: -1.0000  memory: 13.15GiB(27.68%)  tps: 20,769
[rank0]:2025-11-02 04:45:18,032 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-02 04:45:18,039 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank3]:2025-11-02 04:45:18,053 - INFO - validate step: 1200  loss:  0.9497  memory: 17.37GiB(36.55%)  tps: 20,968
[rank3]:2025-11-02 04:45:18,054 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-02 04:45:19,935 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 1.87 seconds.
[rank1]:2025-11-02 04:45:20,313 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 2.27 seconds.
[rank3]:2025-11-02 04:45:21,484 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.43 seconds.
[rank0]:2025-11-02 04:45:22,025 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-11-02 04:45:22,034 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 4.00 seconds.
[rank1]:2025-11-02 04:45:22,110 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251102_0445_stage1_step1200.svg
[rank2]:2025-11-02 04:45:22,110 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251102_0445_stage2_step1200.svg
[rank0]:2025-11-02 04:45:22,245 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251102_0445_stage0_step1200.svg
[rank3]:2025-11-02 04:45:22,373 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/pipeline_schedule/251102_0445_real_step1200_rank3.svg
[rank3]:> Batch Time: 375.92 ms, GPU Bubble Ratio: 59.73%, 40.00%, 51.19%, 21.50%
[rank3]:2025-11-02 04:45:22,443 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251102_0445_stage3_step1200.svg
[rank0]:2025-11-02 04:46:11,594 - INFO - [GC] Peforming periodical GC collection 0.25 seconds
[rank0]:2025-11-02 04:46:12,587 - INFO -  step: 1250  loss: -2.0000  grad_norm:  0.5106  memory: 13.15GiB(27.68%)  tps: 7,508  tflops: 57.18  mfu: 18.33%
[rank3]:2025-11-02 04:46:12,565 - INFO -  step: 1250  loss:  0.2954  grad_norm:  0.5106  memory: 17.37GiB(36.55%)  tps: 7,514  tflops: 57.23  mfu: 18.34%
[rank1]:2025-11-02 04:46:12,575 - INFO -  step: 1250  loss: -2.0000  grad_norm:  0.5106  memory:  9.42GiB(19.83%)  tps: 7,512  tflops: 57.21  mfu: 18.34%
[rank2]:2025-11-02 04:46:12,571 - INFO -  step: 1250  loss: -2.0000  grad_norm:  0.5106  memory:  6.53GiB(13.74%)  tps: 7,514  tflops: 57.23  mfu: 18.34%
[rank0]:2025-11-02 04:47:00,664 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 04:47:01,397 - INFO - Avg. fwd time: 13.2048 / Avg. bwd time: 27.3856 / Avg. batch time: 397.3122 (ms) / GPU bubble ratio: 18.27%
[rank1]:2025-11-02 04:47:01,492 - INFO - Avg. fwd time: 9.5596 / Avg. bwd time: 20.8338 / Avg. batch time: 462.0598 (ms) / GPU bubble ratio: 47.38%
[rank2]:2025-11-02 04:47:01,456 - INFO - Avg. fwd time: 7.3239 / Avg. bwd time: 16.0720 / Avg. batch time: 425.8142 (ms) / GPU bubble ratio: 56.04%
[rank0]:2025-11-02 04:47:01,492 - INFO - Avg. fwd time: 7.8430 / Avg. bwd time: 17.6020 / Avg. batch time: 495.2483 (ms) / GPU bubble ratio: 58.90%
[rank3]:2025-11-02 04:47:01,645 - INFO -  step: 1300  loss:  0.2621  grad_norm:  0.5033  memory: 17.37GiB(36.55%)  tps: 8,346  tflops: 63.56  mfu: 20.37%
[rank1]:2025-11-02 04:47:01,655 - INFO -  step: 1300  loss: -2.0000  grad_norm:  0.5033  memory:  9.42GiB(19.83%)  tps: 8,346  tflops: 63.56  mfu: 20.37%
[rank2]:2025-11-02 04:47:01,651 - INFO -  step: 1300  loss: -2.0000  grad_norm:  0.5033  memory:  6.53GiB(13.74%)  tps: 8,346  tflops: 63.56  mfu: 20.37%
[rank0]:2025-11-02 04:47:01,665 - INFO -  step: 1300  loss: -2.0000  grad_norm:  0.5033  memory: 13.15GiB(27.68%)  tps: 8,346  tflops: 63.56  mfu: 20.37%
[rank0]:2025-11-02 04:47:01,738 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251102_0447_stage0_step1300.svg
[rank1]:2025-11-02 04:47:01,739 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251102_0447_stage1_step1300.svg
[rank2]:2025-11-02 04:47:01,737 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251102_0447_stage2_step1300.svg
[rank3]:2025-11-02 04:47:01,857 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/pipeline_schedule/251102_0447_real_step1300_rank3.svg
[rank3]:> Batch Time: 378.46 ms, GPU Bubble Ratio: 33.92%, 40.39%, 51.57%, 23.32%
[rank3]:2025-11-02 04:47:01,925 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251102_0447_stage3_step1300.svg
[rank0]:2025-11-02 04:47:49,834 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 04:47:50,844 - INFO -  step: 1350  loss:  0.2495  grad_norm:  0.3955  memory: 17.37GiB(36.55%)  tps: 8,326  tflops: 63.41  mfu: 20.32%
[rank1]:2025-11-02 04:47:50,842 - INFO -  step: 1350  loss: -2.0000  grad_norm:  0.3955  memory:  9.42GiB(19.83%)  tps: 8,327  tflops: 63.42  mfu: 20.33%
[rank2]:2025-11-02 04:47:50,838 - INFO -  step: 1350  loss: -2.0000  grad_norm:  0.3955  memory:  6.53GiB(13.74%)  tps: 8,327  tflops: 63.42  mfu: 20.33%
[rank0]:2025-11-02 04:47:50,852 - INFO -  step: 1350  loss: -2.0000  grad_norm:  0.3955  memory: 13.15GiB(27.68%)  tps: 8,327  tflops: 63.42  mfu: 20.33%
[rank0]:2025-11-02 04:48:38,945 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 04:48:39,684 - INFO - Avg. fwd time: 13.2260 / Avg. bwd time: 27.0567 / Avg. batch time: 394.8219 (ms) / GPU bubble ratio: 18.38%
[rank2]:2025-11-02 04:48:39,744 - INFO - Avg. fwd time: 7.3290 / Avg. bwd time: 16.0322 / Avg. batch time: 423.3052 (ms) / GPU bubble ratio: 55.85%
[rank0]:2025-11-02 04:48:39,780 - INFO - Avg. fwd time: 7.8179 / Avg. bwd time: 18.0703 / Avg. batch time: 492.8823 (ms) / GPU bubble ratio: 57.98%
[rank1]:2025-11-02 04:48:39,780 - INFO - Avg. fwd time: 9.5796 / Avg. bwd time: 20.6518 / Avg. batch time: 459.4108 (ms) / GPU bubble ratio: 47.36%
[rank1]:2025-11-02 04:48:39,945 - INFO -  step: 1400  loss: -2.0000  grad_norm:  0.6747  memory:  9.42GiB(19.83%)  tps: 8,342  tflops: 63.53  mfu: 20.36%
[rank1]:2025-11-02 04:48:39,945 - INFO - ðŸ”Ž  Running validation at step 1400
[rank2]:2025-11-02 04:48:39,941 - INFO -  step: 1400  loss: -2.0000  grad_norm:  0.6747  memory:  6.53GiB(13.74%)  tps: 8,342  tflops: 63.53  mfu: 20.36%
[rank2]:2025-11-02 04:48:39,941 - INFO - ðŸ”Ž  Running validation at step 1400
[rank0]:2025-11-02 04:48:39,956 - INFO -  step: 1400  loss: -2.0000  grad_norm:  0.6747  memory: 13.15GiB(27.68%)  tps: 8,342  tflops: 63.53  mfu: 20.36%
[rank0]:2025-11-02 04:48:39,956 - INFO - ðŸ”Ž  Running validation at step 1400
[rank3]:2025-11-02 04:48:39,936 - INFO -  step: 1400  loss:  0.2202  grad_norm:  0.6747  memory: 17.37GiB(36.55%)  tps: 8,344  tflops: 63.55  mfu: 20.37%
[rank3]:2025-11-02 04:48:39,936 - INFO - ðŸ”Ž  Running validation at step 1400
[rank0]:2025-11-02 04:48:59,871 - INFO - validate step: 1400  loss: -1.0000  memory: 13.15GiB(27.68%)  tps: 20,568
[rank3]:2025-11-02 04:48:59,891 - INFO - validate step: 1400  loss:  0.9483  memory: 17.37GiB(36.55%)  tps: 20,527
[rank1]:2025-11-02 04:48:59,886 - INFO - validate step: 1400  loss: -1.0000  memory:  9.42GiB(19.83%)  tps: 20,541
[rank2]:2025-11-02 04:48:59,904 - INFO - validate step: 1400  loss: -1.0000  memory:  6.53GiB(13.74%)  tps: 20,519
[rank0]:2025-11-02 04:48:59,980 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251102_0448_stage0_step1400.svg
[rank1]:2025-11-02 04:48:59,981 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251102_0448_stage1_step1400.svg
[rank2]:2025-11-02 04:48:59,980 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251102_0448_stage2_step1400.svg
[rank3]:2025-11-02 04:49:00,099 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/pipeline_schedule/251102_0448_real_step1400_rank3.svg
[rank3]:> Batch Time: 378.56 ms, GPU Bubble Ratio: 33.82%, 40.43%, 51.54%, 23.34%
[rank3]:2025-11-02 04:49:00,169 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251102_0448_stage3_step1400.svg
[rank0]:2025-11-02 04:49:48,536 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-02 04:49:49,515 - INFO -  step: 1450  loss:  0.2264  grad_norm:  0.5994  memory: 17.37GiB(36.55%)  tps: 8,254  tflops: 62.87  mfu: 20.15%
[rank1]:2025-11-02 04:49:49,524 - INFO -  step: 1450  loss: -2.0000  grad_norm:  0.5994  memory:  9.42GiB(19.83%)  tps: 8,252  tflops: 62.85  mfu: 20.14%
[rank2]:2025-11-02 04:49:49,520 - INFO -  step: 1450  loss: -2.0000  grad_norm:  0.5994  memory:  6.53GiB(13.74%)  tps: 8,255  tflops: 62.88  mfu: 20.15%
[rank0]:2025-11-02 04:49:49,535 - INFO -  step: 1450  loss: -2.0000  grad_norm:  0.5994  memory: 13.15GiB(27.68%)  tps: 8,248  tflops: 62.81  mfu: 20.13%
[rank0]:2025-11-02 04:50:37,752 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 04:50:38,697 - INFO - Avg. fwd time: 7.3335 / Avg. bwd time: 15.9976 / Avg. batch time: 421.3371 (ms) / GPU bubble ratio: 55.70%
[rank0]:2025-11-02 04:50:38,757 - INFO - Avg. fwd time: 7.7972 / Avg. bwd time: 18.4738 / Avg. batch time: 491.0392 (ms) / GPU bubble ratio: 57.20%
[rank3]:2025-11-02 04:50:38,673 - INFO - Avg. fwd time: 13.2388 / Avg. bwd time: 26.8042 / Avg. batch time: 392.8804 (ms) / GPU bubble ratio: 18.46%
[rank1]:2025-11-02 04:50:38,725 - INFO - Avg. fwd time: 9.5971 / Avg. bwd time: 20.4940 / Avg. batch time: 457.3169 (ms) / GPU bubble ratio: 47.36%
[rank1]:2025-11-02 04:50:38,781 - INFO -  step: 1500  loss: -2.0000  grad_norm:  0.4327  memory:  9.42GiB(19.83%)  tps: 8,316  tflops: 63.33  mfu: 20.30%
[rank2]:2025-11-02 04:50:38,778 - INFO -  step: 1500  loss: -2.0000  grad_norm:  0.4327  memory:  6.53GiB(13.74%)  tps: 8,315  tflops: 63.33  mfu: 20.30%
[rank0]:2025-11-02 04:50:38,793 - INFO -  step: 1500  loss: -2.0000  grad_norm:  0.4327  memory: 13.15GiB(27.68%)  tps: 8,315  tflops: 63.33  mfu: 20.30%
[rank3]:2025-11-02 04:50:38,785 - INFO -  step: 1500  loss:  0.2626  grad_norm:  0.4327  memory: 17.37GiB(36.55%)  tps: 8,314  tflops: 63.32  mfu: 20.29%
[rank1]:2025-11-02 04:50:38,869 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251102_0450_stage1_step1500.svg
[rank2]:2025-11-02 04:50:38,869 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251102_0450_stage2_step1500.svg
[rank0]:2025-11-02 04:50:38,874 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251102_0450_stage0_step1500.svg
[rank3]:2025-11-02 04:50:38,990 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/pipeline_schedule/251102_0450_real_step1500_rank3.svg
[rank3]:> Batch Time: 378.59 ms, GPU Bubble Ratio: 33.73%, 40.47%, 51.55%, 23.41%
[rank3]:2025-11-02 04:50:39,061 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251102_0450_stage3_step1500.svg
[rank0]:2025-11-02 04:51:27,267 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 04:51:28,261 - INFO -  step: 1550  loss: -2.0000  grad_norm:  0.4007  memory:  6.53GiB(13.74%)  tps: 8,278  tflops: 63.04  mfu: 20.21%
[rank3]:2025-11-02 04:51:28,267 - INFO -  step: 1550  loss:  0.2184  grad_norm:  0.4007  memory: 17.37GiB(36.55%)  tps: 8,278  tflops: 63.05  mfu: 20.21%
[rank0]:2025-11-02 04:51:28,276 - INFO -  step: 1550  loss: -2.0000  grad_norm:  0.4007  memory: 13.15GiB(27.68%)  tps: 8,278  tflops: 63.04  mfu: 20.21%
[rank1]:2025-11-02 04:51:28,264 - INFO -  step: 1550  loss: -2.0000  grad_norm:  0.4007  memory:  9.42GiB(19.83%)  tps: 8,278  tflops: 63.04  mfu: 20.21%
[rank0]:2025-11-02 04:52:16,510 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 04:52:17,252 - INFO - Avg. fwd time: 13.2507 / Avg. bwd time: 26.6061 / Avg. batch time: 391.3727 (ms) / GPU bubble ratio: 18.53%
[rank2]:2025-11-02 04:52:17,312 - INFO - Avg. fwd time: 7.3369 / Avg. bwd time: 15.9720 / Avg. batch time: 419.8159 (ms) / GPU bubble ratio: 55.58%
[rank0]:2025-11-02 04:52:17,349 - INFO - Avg. fwd time: 7.7817 / Avg. bwd time: 18.7779 / Avg. batch time: 489.6083 (ms) / GPU bubble ratio: 56.60%
[rank1]:2025-11-02 04:52:17,349 - INFO - Avg. fwd time: 9.6107 / Avg. bwd time: 20.3764 / Avg. batch time: 455.6982 (ms) / GPU bubble ratio: 47.36%
[rank3]:2025-11-02 04:52:17,844 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/pipeline_schedule_adjustment/251102_0452_rank3_trend_line.svg
[rank1]:2025-11-02 04:52:17,881 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/pipeline_schedule_adjustment/251102_0452_rank1_trend_line.svg
[rank2]:2025-11-02 04:52:17,861 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/pipeline_schedule_adjustment/251102_0452_rank2_trend_line.svg
[rank2]:2025-11-02 04:52:17,919 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-02 04:52:17,921 - INFO -  step: 1600  loss: -2.0000  grad_norm:  0.7204  memory:  6.53GiB(13.74%)  tps: 8,248  tflops: 62.82  mfu: 20.13%
[rank2]:2025-11-02 04:52:17,921 - INFO - ðŸ”Ž  Running validation at step 1600
[rank0]:2025-11-02 04:52:17,912 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/pipeline_schedule_adjustment/251102_0452_rank0_trend_line.svg
[rank0]:2025-11-02 04:52:17,919 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-11-02 04:52:17,922 - INFO -  step: 1600  loss: -2.0000  grad_norm:  0.7204  memory: 13.15GiB(27.68%)  tps: 8,251  tflops: 62.84  mfu: 20.14%
[rank0]:2025-11-02 04:52:17,922 - INFO - ðŸ”Ž  Running validation at step 1600
[rank1]:2025-11-02 04:52:17,919 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank1]:2025-11-02 04:52:17,921 - INFO -  step: 1600  loss: -2.0000  grad_norm:  0.7204  memory:  9.42GiB(19.83%)  tps: 8,249  tflops: 62.82  mfu: 20.14%
[rank1]:2025-11-02 04:52:17,922 - INFO - ðŸ”Ž  Running validation at step 1600
[rank3]:2025-11-02 04:52:18,116 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/pipeline_schedule/251102_0452_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 367.24 ms, GPU Bubble Ratio: 44.62%, 37.25%, 50.98%, 22.14%
[rank3]:2025-11-02 04:52:18,116 - INFO - 	> Batch Time: 367.24 ms (Average Freeze Ratio: 0.26)
[rank3]:2025-11-02 04:52:18,117 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 0.40/0.40, [MB7] 0.00/0.00
[rank3]:2025-11-02 04:52:18,122 - INFO -  step: 1600  loss:  0.1836  grad_norm:  0.7204  memory: 17.37GiB(36.55%)  tps: 8,216  tflops: 62.58  mfu: 20.06%
[rank3]:2025-11-02 04:52:18,123 - INFO - ðŸ”Ž  Running validation at step 1600
[rank2]:2025-11-02 04:52:37,664 - INFO - validate step: 1600  loss: -1.0000  memory:  6.53GiB(13.74%)  tps: 20,748
[rank3]:2025-11-02 04:52:37,653 - INFO - validate step: 1600  loss:  0.9500  memory: 17.37GiB(36.55%)  tps: 20,974
[rank0]:2025-11-02 04:52:37,632 - INFO - validate step: 1600  loss: -1.0000  memory: 13.15GiB(27.68%)  tps: 20,781
[rank1]:2025-11-02 04:52:37,647 - INFO - validate step: 1600  loss: -1.0000  memory:  9.42GiB(19.83%)  tps: 20,766
[rank1]:2025-11-02 04:52:37,740 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251102_0452_stage1_step1600.svg
[rank2]:2025-11-02 04:52:37,744 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251102_0452_stage2_step1600.svg
[rank0]:2025-11-02 04:52:37,741 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251102_0452_stage0_step1600.svg
[rank3]:2025-11-02 04:52:37,863 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/pipeline_schedule/251102_0452_real_step1600_rank3.svg
[rank3]:> Batch Time: 378.70 ms, GPU Bubble Ratio: 33.73%, 40.42%, 51.54%, 23.34%
[rank3]:2025-11-02 04:52:37,939 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251102_0452_stage3_step1600.svg
[rank3]:2025-11-02 04:52:58,543 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-11-02 04:52:58,759 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-11-02 04:52:58,733 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-11-02 04:52:58,778 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-11-02 04:53:25,634 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-11-02 04:53:26,617 - INFO -  step: 1650  loss: -2.0000  grad_norm:  0.3497  memory:  6.53GiB(13.74%)  tps: 8,367  tflops: 63.73  mfu: 20.43%
[rank3]:2025-11-02 04:53:26,610 - INFO -  step: 1650  loss:  0.2809  grad_norm:  0.3497  memory: 17.37GiB(36.55%)  tps: 8,367  tflops: 63.72  mfu: 20.42%
[rank0]:2025-11-02 04:53:26,632 - INFO -  step: 1650  loss: -2.0000  grad_norm:  0.3497  memory: 13.15GiB(27.68%)  tps: 8,359  tflops: 63.67  mfu: 20.41%
[rank1]:2025-11-02 04:53:26,620 - INFO -  step: 1650  loss: -2.0000  grad_norm:  0.3497  memory:  9.42GiB(19.83%)  tps: 8,364  tflops: 63.70  mfu: 20.42%
[rank0]:2025-11-02 04:54:14,469 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 04:54:15,199 - INFO - Avg. fwd time: 13.2644 / Avg. bwd time: 26.4038 / Avg. batch time: 389.8286 (ms) / GPU bubble ratio: 18.59%
[rank2]:2025-11-02 04:54:15,260 - INFO - Avg. fwd time: 7.3406 / Avg. bwd time: 15.9458 / Avg. batch time: 418.2522 (ms) / GPU bubble ratio: 55.46%
[rank0]:2025-11-02 04:54:15,292 - INFO - Avg. fwd time: 7.8057 / Avg. bwd time: 18.3612 / Avg. batch time: 487.9376 (ms) / GPU bubble ratio: 57.10%
[rank1]:2025-11-02 04:54:15,299 - INFO - Avg. fwd time: 9.5946 / Avg. bwd time: 20.5781 / Avg. batch time: 454.2568 (ms) / GPU bubble ratio: 46.86%
[rank1]:2025-11-02 04:54:15,456 - INFO -  step: 1700  loss: -2.0000  grad_norm:  0.4240  memory:  9.42GiB(19.83%)  tps: 8,387  tflops: 63.88  mfu: 20.47%
[rank2]:2025-11-02 04:54:15,452 - INFO -  step: 1700  loss: -2.0000  grad_norm:  0.4240  memory:  6.53GiB(13.74%)  tps: 8,387  tflops: 63.88  mfu: 20.47%
[rank3]:2025-11-02 04:54:15,446 - INFO -  step: 1700  loss:  0.2420  grad_norm:  0.4240  memory: 17.37GiB(36.55%)  tps: 8,388  tflops: 63.88  mfu: 20.47%
[rank0]:2025-11-02 04:54:15,467 - INFO -  step: 1700  loss: -2.0000  grad_norm:  0.4240  memory: 13.15GiB(27.68%)  tps: 8,388  tflops: 63.88  mfu: 20.47%
[rank0]:2025-11-02 04:54:15,542 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251102_0454_stage0_step1700.svg
[rank1]:2025-11-02 04:54:15,541 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251102_0454_stage1_step1700.svg
[rank2]:2025-11-02 04:54:15,543 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251102_0454_stage2_step1700.svg
[rank3]:2025-11-02 04:54:15,659 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/pipeline_schedule/251102_0454_real_step1700_rank3.svg
[rank3]:> Batch Time: 379.92 ms, GPU Bubble Ratio: 60.05%, 29.65%, 51.70%, 22.30%
[rank3]:2025-11-02 04:54:15,730 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251102_0454_stage3_step1700.svg
[rank0]:2025-11-02 04:55:03,538 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-02 04:55:04,533 - INFO -  step: 1750  loss: -2.0000  grad_norm:  0.3184  memory:  9.42GiB(19.83%)  tps: 8,346  tflops: 63.57  mfu: 20.37%
[rank2]:2025-11-02 04:55:04,529 - INFO -  step: 1750  loss: -2.0000  grad_norm:  0.3184  memory:  6.53GiB(13.74%)  tps: 8,346  tflops: 63.57  mfu: 20.37%
[rank3]:2025-11-02 04:55:04,536 - INFO -  step: 1750  loss:  0.2058  grad_norm:  0.3184  memory: 17.37GiB(36.55%)  tps: 8,344  tflops: 63.55  mfu: 20.37%
[rank0]:2025-11-02 04:55:04,544 - INFO -  step: 1750  loss: -2.0000  grad_norm:  0.3184  memory: 13.15GiB(27.68%)  tps: 8,346  tflops: 63.57  mfu: 20.37%
[rank0]:2025-11-02 04:55:52,194 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 04:55:53,121 - INFO - Avg. fwd time: 13.2817 / Avg. bwd time: 26.2093 / Avg. batch time: 388.3784 (ms) / GPU bubble ratio: 18.65%
[rank1]:2025-11-02 04:55:53,178 - INFO - Avg. fwd time: 9.5775 / Avg. bwd time: 20.7923 / Avg. batch time: 452.9353 (ms) / GPU bubble ratio: 46.36%
[rank2]:2025-11-02 04:55:53,146 - INFO - Avg. fwd time: 7.3437 / Avg. bwd time: 15.9228 / Avg. batch time: 416.7960 (ms) / GPU bubble ratio: 55.34%
[rank2]:2025-11-02 04:55:53,225 - INFO -  step: 1800  loss: -2.0000  grad_norm:  0.3643  memory:  6.53GiB(13.74%)  tps: 8,411  tflops: 64.06  mfu: 20.53%
[rank2]:2025-11-02 04:55:53,225 - INFO - ðŸ”Ž  Running validation at step 1800
[rank0]:2025-11-02 04:55:53,203 - INFO - Avg. fwd time: 7.8313 / Avg. bwd time: 17.9161 / Avg. batch time: 486.3729 (ms) / GPU bubble ratio: 57.65%
[rank0]:2025-11-02 04:55:53,239 - INFO -  step: 1800  loss: -2.0000  grad_norm:  0.3643  memory: 13.15GiB(27.68%)  tps: 8,412  tflops: 64.06  mfu: 20.53%
[rank0]:2025-11-02 04:55:53,239 - INFO - ðŸ”Ž  Running validation at step 1800
[rank3]:2025-11-02 04:55:53,232 - INFO -  step: 1800  loss:  0.1871  grad_norm:  0.3643  memory: 17.37GiB(36.55%)  tps: 8,412  tflops: 64.06  mfu: 20.53%
[rank3]:2025-11-02 04:55:53,233 - INFO - ðŸ”Ž  Running validation at step 1800
[rank1]:2025-11-02 04:55:53,228 - INFO -  step: 1800  loss: -2.0000  grad_norm:  0.3643  memory:  9.42GiB(19.83%)  tps: 8,412  tflops: 64.07  mfu: 20.54%
[rank1]:2025-11-02 04:55:53,228 - INFO - ðŸ”Ž  Running validation at step 1800
[rank0]:2025-11-02 04:56:13,287 - INFO - validate step: 1800  loss: -1.0000  memory: 13.15GiB(27.68%)  tps: 20,432
[rank1]:2025-11-02 04:56:13,301 - INFO - validate step: 1800  loss: -1.0000  memory:  9.42GiB(19.83%)  tps: 20,406
[rank2]:2025-11-02 04:56:13,318 - INFO - validate step: 1800  loss: -1.0000  memory:  6.53GiB(13.74%)  tps: 20,385
[rank3]:2025-11-02 04:56:13,307 - INFO - validate step: 1800  loss:  0.9488  memory: 17.37GiB(36.55%)  tps: 20,406
[rank1]:2025-11-02 04:56:13,398 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251102_0456_stage1_step1800.svg
[rank2]:2025-11-02 04:56:13,397 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251102_0456_stage2_step1800.svg
[rank0]:2025-11-02 04:56:13,397 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251102_0456_stage0_step1800.svg
[rank3]:2025-11-02 04:56:13,518 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/pipeline_schedule/251102_0456_real_step1800_rank3.svg
[rank3]:> Batch Time: 375.87 ms, GPU Bubble Ratio: 59.58%, 28.92%, 51.13%, 22.56%
[rank3]:2025-11-02 04:56:13,594 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251102_0456_stage3_step1800.svg
[rank0]:2025-11-02 04:57:01,528 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-11-02 04:57:02,514 - INFO -  step: 1850  loss: -2.0000  grad_norm:  0.3793  memory:  6.53GiB(13.74%)  tps: 8,326  tflops: 63.41  mfu: 20.32%
[rank3]:2025-11-02 04:57:02,522 - INFO -  step: 1850  loss:  0.2888  grad_norm:  0.3793  memory: 17.37GiB(36.55%)  tps: 8,323  tflops: 63.39  mfu: 20.32%
[rank0]:2025-11-02 04:57:02,528 - INFO -  step: 1850  loss: -2.0000  grad_norm:  0.3793  memory: 13.15GiB(27.68%)  tps: 8,318  tflops: 63.35  mfu: 20.31%
[rank1]:2025-11-02 04:57:02,518 - INFO -  step: 1850  loss: -2.0000  grad_norm:  0.3793  memory:  9.42GiB(19.83%)  tps: 8,323  tflops: 63.39  mfu: 20.32%
[rank0]:2025-11-02 04:57:50,332 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 04:57:51,062 - INFO - Avg. fwd time: 13.2930 / Avg. bwd time: 26.0751 / Avg. batch time: 387.3707 (ms) / GPU bubble ratio: 18.70%
[rank1]:2025-11-02 04:57:51,163 - INFO - Avg. fwd time: 9.5649 / Avg. bwd time: 20.9561 / Avg. batch time: 452.0190 (ms) / GPU bubble ratio: 45.98%
[rank2]:2025-11-02 04:57:51,116 - INFO - Avg. fwd time: 7.3463 / Avg. bwd time: 15.9052 / Avg. batch time: 415.7816 (ms) / GPU bubble ratio: 55.26%
[rank0]:2025-11-02 04:57:51,158 - INFO - Avg. fwd time: 7.8507 / Avg. bwd time: 17.5740 / Avg. batch time: 485.2667 (ms) / GPU bubble ratio: 58.09%
[rank3]:2025-11-02 04:57:51,304 - INFO -  step: 1900  loss:  0.1825  grad_norm:  0.2829  memory: 17.37GiB(36.55%)  tps: 8,397  tflops: 63.95  mfu: 20.50%
[rank1]:2025-11-02 04:57:51,313 - INFO -  step: 1900  loss: -2.0000  grad_norm:  0.2829  memory:  9.42GiB(19.83%)  tps: 8,394  tflops: 63.93  mfu: 20.49%
[rank2]:2025-11-02 04:57:51,309 - INFO -  step: 1900  loss: -2.0000  grad_norm:  0.2829  memory:  6.53GiB(13.74%)  tps: 8,394  tflops: 63.93  mfu: 20.49%
[rank0]:2025-11-02 04:57:51,326 - INFO -  step: 1900  loss: -2.0000  grad_norm:  0.2829  memory: 13.15GiB(27.68%)  tps: 8,394  tflops: 63.93  mfu: 20.49%
[rank0]:2025-11-02 04:57:51,402 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251102_0457_stage0_step1900.svg
[rank1]:2025-11-02 04:57:51,402 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251102_0457_stage1_step1900.svg
[rank2]:2025-11-02 04:57:51,401 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251102_0457_stage2_step1900.svg
[rank3]:2025-11-02 04:57:51,516 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/pipeline_schedule/251102_0457_real_step1900_rank3.svg
[rank3]:> Batch Time: 376.76 ms, GPU Bubble Ratio: 59.69%, 29.01%, 51.26%, 22.51%
[rank3]:2025-11-02 04:57:51,587 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251102_0457_stage3_step1900.svg
[rank0]:2025-11-02 04:58:39,491 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-02 04:58:40,496 - INFO -  step: 1950  loss: -2.0000  grad_norm:  0.2303  memory:  9.42GiB(19.83%)  tps: 8,328  tflops: 63.43  mfu: 20.33%
[rank2]:2025-11-02 04:58:40,492 - INFO -  step: 1950  loss: -2.0000  grad_norm:  0.2303  memory:  6.53GiB(13.74%)  tps: 8,328  tflops: 63.43  mfu: 20.33%
[rank3]:2025-11-02 04:58:40,503 - INFO -  step: 1950  loss:  0.1673  grad_norm:  0.2303  memory: 17.37GiB(36.55%)  tps: 8,326  tflops: 63.41  mfu: 20.32%
[rank0]:2025-11-02 04:58:40,507 - INFO -  step: 1950  loss: -2.0000  grad_norm:  0.2303  memory: 13.15GiB(27.68%)  tps: 8,328  tflops: 63.43  mfu: 20.33%
[rank0]:2025-11-02 04:59:28,504 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 04:59:29,248 - INFO - Avg. fwd time: 13.3034 / Avg. bwd time: 25.9378 / Avg. batch time: 386.3287 (ms) / GPU bubble ratio: 18.74%
[rank2]:2025-11-02 04:59:29,303 - INFO - Avg. fwd time: 7.3489 / Avg. bwd time: 15.8867 / Avg. batch time: 414.7204 (ms) / GPU bubble ratio: 55.18%
[rank0]:2025-11-02 04:59:29,344 - INFO - Avg. fwd time: 7.8707 / Avg. bwd time: 17.2137 / Avg. batch time: 484.1091 (ms) / GPU bubble ratio: 58.55%
[rank1]:2025-11-02 04:59:29,350 - INFO - Avg. fwd time: 9.5517 / Avg. bwd time: 21.1286 / Avg. batch time: 451.0627 (ms) / GPU bubble ratio: 45.59%
[rank1]:2025-11-02 04:59:29,500 - INFO -  step: 2000  loss: -2.0000  grad_norm:  0.3656  memory:  9.42GiB(19.83%)  tps: 8,359  tflops: 63.66  mfu: 20.40%
[rank1]:2025-11-02 04:59:29,500 - INFO - ðŸ”Ž  Running validation at step 2000
[rank2]:2025-11-02 04:59:29,496 - INFO -  step: 2000  loss: -2.0000  grad_norm:  0.3656  memory:  6.53GiB(13.74%)  tps: 8,359  tflops: 63.66  mfu: 20.40%
[rank2]:2025-11-02 04:59:29,496 - INFO - ðŸ”Ž  Running validation at step 2000
[rank3]:2025-11-02 04:59:29,487 - INFO -  step: 2000  loss:  0.2209  grad_norm:  0.3656  memory: 17.37GiB(36.55%)  tps: 8,362  tflops: 63.69  mfu: 20.41%
[rank3]:2025-11-02 04:59:29,488 - INFO - ðŸ”Ž  Running validation at step 2000
[rank0]:2025-11-02 04:59:29,512 - INFO -  step: 2000  loss: -2.0000  grad_norm:  0.3656  memory: 13.15GiB(27.68%)  tps: 8,358  tflops: 63.66  mfu: 20.40%
[rank0]:2025-11-02 04:59:29,513 - INFO - ðŸ”Ž  Running validation at step 2000
[rank1]:2025-11-02 04:59:49,007 - INFO - validate step: 2000  loss: -1.0000  memory:  9.42GiB(19.83%)  tps: 20,997
[rank2]:2025-11-02 04:59:49,024 - INFO - validate step: 2000  loss: -1.0000  memory:  6.53GiB(13.74%)  tps: 20,976
[rank3]:2025-11-02 04:59:49,012 - INFO - validate step: 2000  loss:  0.9494  memory: 17.37GiB(36.55%)  tps: 20,980
[rank0]:2025-11-02 04:59:48,992 - INFO - validate step: 2000  loss: -1.0000  memory: 13.15GiB(27.68%)  tps: 21,028
[rank1]:2025-11-02 04:59:49,105 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251102_0459_stage1_step2000.svg
[rank2]:2025-11-02 04:59:49,103 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251102_0459_stage2_step2000.svg
[rank0]:2025-11-02 04:59:49,105 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251102_0459_stage0_step2000.svg
[rank3]:2025-11-02 04:59:49,218 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/pipeline_schedule/251102_0459_real_step2000_rank3.svg
[rank3]:> Batch Time: 379.76 ms, GPU Bubble Ratio: 60.08%, 29.55%, 51.67%, 22.28%
[rank3]:2025-11-02 04:59:49,291 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251102_0459_stage3_step2000.svg
[rank0]:2025-11-02 05:00:37,306 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-11-02 05:00:38,286 - INFO -  step: 2050  loss: -2.0000  grad_norm:  0.3214  memory:  9.42GiB(19.83%)  tps: 8,312  tflops: 63.31  mfu: 20.29%
[rank2]:2025-11-02 05:00:38,282 - INFO -  step: 2050  loss: -2.0000  grad_norm:  0.3214  memory:  6.53GiB(13.74%)  tps: 8,315  tflops: 63.33  mfu: 20.30%
[rank3]:2025-11-02 05:00:38,290 - INFO -  step: 2050  loss:  0.1930  grad_norm:  0.3214  memory: 17.37GiB(36.55%)  tps: 8,312  tflops: 63.31  mfu: 20.29%
[rank0]:2025-11-02 05:00:38,297 - INFO -  step: 2050  loss: -2.0000  grad_norm:  0.3214  memory: 13.15GiB(27.68%)  tps: 8,308  tflops: 63.27  mfu: 20.28%
[rank0]:2025-11-02 05:01:26,086 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 05:01:26,991 - INFO - Avg. fwd time: 13.3134 / Avg. bwd time: 25.8088 / Avg. batch time: 385.3551 (ms) / GPU bubble ratio: 18.78%
[rank1]:2025-11-02 05:01:27,049 - INFO - Avg. fwd time: 9.5389 / Avg. bwd time: 21.2837 / Avg. batch time: 450.1745 (ms) / GPU bubble ratio: 45.23%
[rank2]:2025-11-02 05:01:27,016 - INFO - Avg. fwd time: 7.3514 / Avg. bwd time: 15.8703 / Avg. batch time: 413.7326 (ms) / GPU bubble ratio: 55.10%
[rank3]:2025-11-02 05:01:27,090 - INFO -  step: 2100  loss:  0.2291  grad_norm:  0.4038  memory: 17.37GiB(36.55%)  tps: 8,394  tflops: 63.93  mfu: 20.49%
[rank0]:2025-11-02 05:01:27,076 - INFO - Avg. fwd time: 7.8888 / Avg. bwd time: 16.8899 / Avg. batch time: 483.0415 (ms) / GPU bubble ratio: 58.96%
[rank0]:2025-11-02 05:01:27,112 - INFO -  step: 2100  loss: -2.0000  grad_norm:  0.4038  memory: 13.15GiB(27.68%)  tps: 8,391  tflops: 63.91  mfu: 20.48%
[rank1]:2025-11-02 05:01:27,101 - INFO -  step: 2100  loss: -2.0000  grad_norm:  0.4038  memory:  9.42GiB(19.83%)  tps: 8,391  tflops: 63.91  mfu: 20.48%
[rank2]:2025-11-02 05:01:27,097 - INFO -  step: 2100  loss: -2.0000  grad_norm:  0.4038  memory:  6.53GiB(13.74%)  tps: 8,391  tflops: 63.91  mfu: 20.48%
[rank2]:2025-11-02 05:01:27,180 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251102_0501_stage2_step2100.svg
[rank0]:2025-11-02 05:01:27,182 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251102_0501_stage0_step2100.svg
[rank1]:2025-11-02 05:01:27,183 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251102_0501_stage1_step2100.svg
[rank3]:2025-11-02 05:01:27,301 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/pipeline_schedule/251102_0501_real_step2100_rank3.svg
[rank3]:> Batch Time: 374.84 ms, GPU Bubble Ratio: 59.53%, 28.96%, 51.01%, 22.64%
[rank3]:2025-11-02 05:01:27,367 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251102_0501_stage3_step2100.svg
[rank0]:2025-11-02 05:02:15,206 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 05:02:16,174 - INFO -  step: 2150  loss:  0.1934  grad_norm:  0.3661  memory: 17.37GiB(36.55%)  tps: 8,345  tflops: 63.56  mfu: 20.37%
[rank1]:2025-11-02 05:02:16,185 - INFO -  step: 2150  loss: -2.0000  grad_norm:  0.3661  memory:  9.42GiB(19.83%)  tps: 8,345  tflops: 63.56  mfu: 20.37%
[rank2]:2025-11-02 05:02:16,181 - INFO -  step: 2150  loss: -2.0000  grad_norm:  0.3661  memory:  6.53GiB(13.74%)  tps: 8,345  tflops: 63.56  mfu: 20.37%
[rank0]:2025-11-02 05:02:16,196 - INFO -  step: 2150  loss: -2.0000  grad_norm:  0.3661  memory: 13.15GiB(27.68%)  tps: 8,345  tflops: 63.56  mfu: 20.37%
[rank0]:2025-11-02 05:03:03,921 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 05:03:04,659 - INFO - Avg. fwd time: 13.3230 / Avg. bwd time: 25.7015 / Avg. batch time: 384.5556 (ms) / GPU bubble ratio: 18.82%
[rank1]:2025-11-02 05:03:04,753 - INFO - Avg. fwd time: 9.5297 / Avg. bwd time: 21.4059 / Avg. batch time: 449.4456 (ms) / GPU bubble ratio: 44.94%
[rank2]:2025-11-02 05:03:04,719 - INFO - Avg. fwd time: 7.3532 / Avg. bwd time: 15.8570 / Avg. batch time: 412.9277 (ms) / GPU bubble ratio: 55.03%
[rank0]:2025-11-02 05:03:04,754 - INFO - Avg. fwd time: 7.9029 / Avg. bwd time: 16.6369 / Avg. batch time: 482.1722 (ms) / GPU bubble ratio: 59.28%
[rank2]:2025-11-02 05:03:04,909 - INFO -  step: 2200  loss: -2.0000  grad_norm:  0.3845  memory:  6.53GiB(13.74%)  tps: 8,406  tflops: 64.02  mfu: 20.52%
[rank2]:2025-11-02 05:03:04,909 - INFO - ðŸ”Ž  Running validation at step 2200
[rank3]:2025-11-02 05:03:04,904 - INFO -  step: 2200  loss:  0.2214  grad_norm:  0.3845  memory: 17.37GiB(36.55%)  tps: 8,406  tflops: 64.02  mfu: 20.52%
[rank3]:2025-11-02 05:03:04,904 - INFO - ðŸ”Ž  Running validation at step 2200
[rank0]:2025-11-02 05:03:04,925 - INFO -  step: 2200  loss: -2.0000  grad_norm:  0.3845  memory: 13.15GiB(27.68%)  tps: 8,406  tflops: 64.02  mfu: 20.52%
[rank0]:2025-11-02 05:03:04,925 - INFO - ðŸ”Ž  Running validation at step 2200
[rank1]:2025-11-02 05:03:04,912 - INFO -  step: 2200  loss: -2.0000  grad_norm:  0.3845  memory:  9.42GiB(19.83%)  tps: 8,406  tflops: 64.02  mfu: 20.52%
[rank1]:2025-11-02 05:03:04,913 - INFO - ðŸ”Ž  Running validation at step 2200
[rank3]:2025-11-02 05:03:24,565 - INFO - validate step: 2200  loss:  0.9546  memory: 17.37GiB(36.55%)  tps: 20,835
[rank0]:2025-11-02 05:03:24,544 - INFO - validate step: 2200  loss: -1.0000  memory: 13.15GiB(27.68%)  tps: 20,878
[rank1]:2025-11-02 05:03:24,559 - INFO - validate step: 2200  loss: -1.0000  memory:  9.42GiB(19.83%)  tps: 20,848
[rank2]:2025-11-02 05:03:24,576 - INFO - validate step: 2200  loss: -1.0000  memory:  6.53GiB(13.74%)  tps: 20,827
[rank0]:2025-11-02 05:03:24,648 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251102_0503_stage0_step2200.svg
[rank1]:2025-11-02 05:03:24,649 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251102_0503_stage1_step2200.svg
[rank2]:2025-11-02 05:03:24,648 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251102_0503_stage2_step2200.svg
[rank3]:2025-11-02 05:03:24,773 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/pipeline_schedule/251102_0503_real_step2200_rank3.svg
[rank3]:> Batch Time: 376.12 ms, GPU Bubble Ratio: 59.60%, 28.67%, 51.20%, 22.57%
[rank3]:2025-11-02 05:03:24,838 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251102_0503_stage3_step2200.svg
[rank0]:2025-11-02 05:04:12,674 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-11-02 05:04:13,652 - INFO -  step: 2250  loss: -2.0000  grad_norm:  0.3437  memory:  9.42GiB(19.83%)  tps: 8,344  tflops: 63.55  mfu: 20.37%
[rank2]:2025-11-02 05:04:13,648 - INFO -  step: 2250  loss: -2.0000  grad_norm:  0.3437  memory:  6.53GiB(13.74%)  tps: 8,347  tflops: 63.57  mfu: 20.38%
[rank3]:2025-11-02 05:04:13,641 - INFO -  step: 2250  loss:  0.2084  grad_norm:  0.3437  memory: 17.37GiB(36.55%)  tps: 8,346  tflops: 63.57  mfu: 20.37%
[rank0]:2025-11-02 05:04:13,663 - INFO -  step: 2250  loss: -2.0000  grad_norm:  0.3437  memory: 13.15GiB(27.68%)  tps: 8,339  tflops: 63.51  mfu: 20.36%
[rank0]:2025-11-02 05:05:01,712 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 05:05:02,441 - INFO - Avg. fwd time: 13.3323 / Avg. bwd time: 25.5926 / Avg. batch time: 383.7389 (ms) / GPU bubble ratio: 18.85%
[rank2]:2025-11-02 05:05:02,501 - INFO - Avg. fwd time: 7.3550 / Avg. bwd time: 15.8427 / Avg. batch time: 412.1013 (ms) / GPU bubble ratio: 54.97%
[rank0]:2025-11-02 05:05:02,536 - INFO - Avg. fwd time: 7.9186 / Avg. bwd time: 16.3667 / Avg. batch time: 481.2827 (ms) / GPU bubble ratio: 59.63%
[rank1]:2025-11-02 05:05:02,541 - INFO - Avg. fwd time: 9.5196 / Avg. bwd time: 21.5358 / Avg. batch time: 448.7010 (ms) / GPU bubble ratio: 44.63%
[rank3]:2025-11-02 05:05:02,683 - INFO -  step: 2300  loss:  0.2014  grad_norm:  0.3106  memory: 17.37GiB(36.55%)  tps: 8,353  tflops: 63.61  mfu: 20.39%
[rank0]:2025-11-02 05:05:02,702 - INFO -  step: 2300  loss: -2.0000  grad_norm:  0.3106  memory: 13.15GiB(27.68%)  tps: 8,353  tflops: 63.61  mfu: 20.39%
[rank1]:2025-11-02 05:05:02,691 - INFO -  step: 2300  loss: -2.0000  grad_norm:  0.3106  memory:  9.42GiB(19.83%)  tps: 8,352  tflops: 63.61  mfu: 20.39%
[rank2]:2025-11-02 05:05:02,687 - INFO -  step: 2300  loss: -2.0000  grad_norm:  0.3106  memory:  6.53GiB(13.74%)  tps: 8,353  tflops: 63.61  mfu: 20.39%
[rank2]:2025-11-02 05:05:02,774 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251102_0505_stage2_step2300.svg
[rank0]:2025-11-02 05:05:02,778 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251102_0505_stage0_step2300.svg
[rank1]:2025-11-02 05:05:02,773 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251102_0505_stage1_step2300.svg
[rank3]:2025-11-02 05:05:02,896 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/pipeline_schedule/251102_0505_real_step2300_rank3.svg
[rank3]:> Batch Time: 381.06 ms, GPU Bubble Ratio: 60.14%, 29.84%, 51.84%, 22.25%
[rank3]:2025-11-02 05:05:02,963 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251102_0505_stage3_step2300.svg
[rank0]:2025-11-02 05:05:50,759 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 05:05:51,746 - INFO -  step: 2350  loss: -2.0000  grad_norm:  0.2572  memory:  6.53GiB(13.74%)  tps: 8,349  tflops: 63.59  mfu: 20.38%
[rank3]:2025-11-02 05:05:51,755 - INFO -  step: 2350  loss:  0.1940  grad_norm:  0.2572  memory: 17.37GiB(36.55%)  tps: 8,347  tflops: 63.57  mfu: 20.38%
[rank0]:2025-11-02 05:05:51,761 - INFO -  step: 2350  loss: -2.0000  grad_norm:  0.2572  memory: 13.15GiB(27.68%)  tps: 8,349  tflops: 63.59  mfu: 20.38%
[rank1]:2025-11-02 05:05:51,750 - INFO -  step: 2350  loss: -2.0000  grad_norm:  0.2572  memory:  9.42GiB(19.83%)  tps: 8,349  tflops: 63.59  mfu: 20.38%
[rank0]:2025-11-02 05:06:39,738 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 05:06:40,653 - INFO - Avg. fwd time: 13.3391 / Avg. bwd time: 25.4953 / Avg. batch time: 382.9978 (ms) / GPU bubble ratio: 18.88%
[rank2]:2025-11-02 05:06:40,680 - INFO - Avg. fwd time: 7.3567 / Avg. bwd time: 15.8296 / Avg. batch time: 411.3476 (ms) / GPU bubble ratio: 54.91%
[rank0]:2025-11-02 05:06:40,741 - INFO - Avg. fwd time: 7.9326 / Avg. bwd time: 16.1198 / Avg. batch time: 480.4697 (ms) / GPU bubble ratio: 59.95%
[rank1]:2025-11-02 05:06:40,714 - INFO - Avg. fwd time: 9.5111 / Avg. bwd time: 21.6552 / Avg. batch time: 448.0240 (ms) / GPU bubble ratio: 44.35%
[rank2]:2025-11-02 05:06:40,762 - INFO -  step: 2400  loss: -2.0000  grad_norm:  0.3632  memory:  6.53GiB(13.74%)  tps: 8,357  tflops: 63.65  mfu: 20.40%
[rank2]:2025-11-02 05:06:40,762 - INFO -  final step: 2400  loss: -2.0000  grad_norm:  0.3632  tps: 8,176  tflops: 62.27  mfu: 19.39%
[rank2]:2025-11-02 05:06:40,762 - INFO - ðŸ”Ž  Running validation at step 2400
[rank3]:2025-11-02 05:06:40,756 - INFO -  step: 2400  loss:  0.2088  grad_norm:  0.3632  memory: 17.37GiB(36.55%)  tps: 8,359  tflops: 63.67  mfu: 20.41%
[rank3]:2025-11-02 05:06:40,757 - INFO -  final step: 2400  loss:  0.2088  grad_norm:  0.3632  tps: 8,180  tflops: 62.30  mfu: 19.39%
[rank3]:2025-11-02 05:06:40,757 - INFO - ðŸ”Ž  Running validation at step 2400
[rank0]:2025-11-02 05:06:40,776 - INFO -  step: 2400  loss: -2.0000  grad_norm:  0.3632  memory: 13.15GiB(27.68%)  tps: 8,357  tflops: 63.65  mfu: 20.40%
[rank0]:2025-11-02 05:06:40,776 - INFO -  final step: 2400  loss: -2.0000  grad_norm:  0.3632  tps: 8,174  tflops: 62.25  mfu: 19.39%
[rank0]:2025-11-02 05:06:40,776 - INFO - ðŸ”Ž  Running validation at step 2400
[rank1]:2025-11-02 05:06:40,765 - INFO -  step: 2400  loss: -2.0000  grad_norm:  0.3632  memory:  9.42GiB(19.83%)  tps: 8,357  tflops: 63.65  mfu: 20.40%
[rank1]:2025-11-02 05:06:40,766 - INFO -  final step: 2400  loss: -2.0000  grad_norm:  0.3632  tps: 8,175  tflops: 62.26  mfu: 19.39%
[rank1]:2025-11-02 05:06:40,766 - INFO - ðŸ”Ž  Running validation at step 2400
[rank3]:2025-11-02 05:07:00,563 - INFO - validate step: 2400  loss:  0.9543  memory: 17.37GiB(36.55%)  tps: 20,682
[rank3]:2025-11-02 05:07:00,565 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-11-02 05:07:00,567 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank1]:2025-11-02 05:07:00,559 - INFO - validate step: 2400  loss: -1.0000  memory:  9.42GiB(19.83%)  tps: 20,694
[rank1]:2025-11-02 05:07:00,560 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-11-02 05:07:00,562 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank0]:2025-11-02 05:07:00,545 - INFO - validate step: 2400  loss: -1.0000  memory: 13.15GiB(27.68%)  tps: 20,720
[rank0]:2025-11-02 05:07:00,546 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-02 05:07:00,548 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank2]:2025-11-02 05:07:00,578 - INFO - validate step: 2400  loss: -1.0000  memory:  6.53GiB(13.74%)  tps: 20,671
[rank2]:2025-11-02 05:07:00,579 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-02 05:07:00,581 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank0]:2025-11-02 05:07:03,258 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank2]:2025-11-02 05:07:03,341 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251102_0507_stage2_final2400.svg
[rank1]:2025-11-02 05:07:03,341 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251102_0507_stage1_final2400.svg
[rank0]:2025-11-02 05:07:03,341 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251102_0507_stage0_final2400.svg
[rank3]:2025-11-02 05:07:03,461 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/pipeline_schedule/251102_0507_real_final2400_rank3.svg
[rank3]:> Batch Time: 380.15 ms, GPU Bubble Ratio: 59.34%, 31.10%, 51.50%, 22.29%
[rank1]:2025-11-02 05:07:03,546 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/frozen_params_histogram/251102_0507_rank1_stage1.svg
[rank1]:	> Counts Sum: 1424400, Total Sum: 1526400 (93.32%), Ratio(%) per element: [93.39, 93.33, 93.27, 93.27, 93.33, 93.21, 93.45, 93.27, 93.33, 93.45, 93.39, 93.33, 93.27, 93.21, 93.39, 93.04, 93.16, 93.39, 93.27, 93.33, 93.27, 93.33, 93.33, 93.27, 93.27, 93.27, 93.33, 93.45, 93.27, 93.51, 93.27, 93.27, 93.39, 93.27, 93.39, 93.33, 93.39, 93.33, 93.27, 93.21, 93.27, 93.33, 93.33, 93.27, 93.27]
[rank1]:2025-11-02 05:07:03,546 - INFO - Destroying the purge thread.
[rank0]:2025-11-02 05:07:03,556 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/frozen_params_histogram/251102_0507_rank0_stage0.svg
[rank0]:	> Counts Sum: 1134680, Total Sum: 1255040 (90.41%), Ratio(%) per element: [89.97, 90.03, 90.09, 90.21, 90.33, 89.91, 90.27, 90.21, 90.03, 90.21, 90.21, 90.03, 90.27, 89.91, 90.09, 90.21, 90.5, 90.33, 90.68, 90.27, 90.5, 90.44, 90.44, 90.38, 90.38, 90.38, 90.74, 90.62, 90.44, 90.86, 90.74, 90.86, 90.91, 90.74, 90.91, 90.91, 90.97]
[rank0]:2025-11-02 05:07:03,556 - INFO - Sleeping 2 seconds for other ranks to complete
[rank2]:2025-11-02 05:07:03,551 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/frozen_params_histogram/251102_0507_rank2_stage2.svg
[rank2]:	> Counts Sum: 1060560, Total Sum: 1221120 (86.85%), Ratio(%) per element: [86.67, 86.96, 86.91, 86.79, 86.91, 86.73, 86.85, 86.91, 86.85, 86.85, 86.91, 86.91, 86.79, 86.96, 86.79, 86.91, 86.96, 86.91, 86.85, 86.85, 86.85, 86.79, 86.91, 86.79, 86.85, 86.73, 86.96, 86.79, 86.91, 86.73, 86.79, 86.85, 86.96, 86.85, 86.79, 86.73]
[rank2]:2025-11-02 05:07:03,551 - INFO - Destroying the purge thread.
[rank3]:2025-11-02 05:07:03,645 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/pipeline_schedule/251102_0507_thry_final2400_rank3.svg
[rank3]:> Batch Time: 314.60 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:2025-11-02 05:07:03,727 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251102_0507_stage3_final2400.svg
[rank3]:2025-11-02 05:07:03,911 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1/frozen_params_histogram/251102_0507_rank3_stage3.svg
[rank3]:	> Counts Sum: 204840, Total Sum: 983680 (20.82%), Ratio(%) per element: [20.28, 21.75, 20.28, 20.22, 20.69, 21.28, 21.04, 21.4, 19.63, 20.81, 20.57, 20.57, 21.52, 20.4, 21.46, 21.04, 20.34, 20.4, 21.46, 20.34, 20.28, 21.16, 21.28, 20.51, 21.4, 21.16, 20.81, 21.1, 20.57]
[rank3]:2025-11-02 05:07:03,912 - INFO - Destroying the purge thread.
[rank2]:2025-11-02 05:07:04,014 - INFO - Process group destroyed
[rank3]:wandb: updating run metadata
[rank1]:2025-11-02 05:07:04,008 - INFO - Process group destroyed
[rank3]:wandb: uploading history steps 48-48, summary, console lines 395-405
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–…â–„â–…â–„â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–‡â–ˆâ–‡â–…â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–‡â–ˆâ–‡â–…â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 1.00146
[rank3]:wandb:               final/avg_loss 0.20885
[rank3]:wandb:             final/avg_mfu(%) 19.38899
[rank3]:wandb:             final/avg_tflops 62.30103
[rank3]:wandb:    final/avg_throughput(tps) 8180.05339
[rank3]:wandb:              final/grad_norm 0.36323
[rank3]:wandb:               final/max_loss 0.20885
[rank3]:wandb:                    grad_norm 0.36323
[rank3]:wandb: loss_metrics/global_avg_loss 0.20885
[rank3]:wandb: loss_metrics/global_max_loss 0.20885
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1031_1F1B_fullrand7_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/89nui3g0
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1031_1F1B_fullrand7_dm1/20251102-0422/wandb/run-20251102_042205-89nui3g0/logs
[rank3]:2025-11-02 05:07:05,053 - INFO - Process group destroyed
[rank0]:2025-11-02 05:07:05,557 - INFO - Training completed
[rank0]:2025-11-02 05:07:05,557 - INFO - Destroying the purge thread.
[rank0]:2025-11-02 05:07:05,675 - INFO - Process group destroyed
[rank1]:Stage 1: Modules to keep: {'layers.7', 'layers.8', 'layers.4', 'layers.6', 'layers.5'}
[rank2]:Stage 2: Modules to keep: {'layers.12', 'layers.10', 'layers.11', 'layers.9'}
[rank0]:Stage 0: Modules to keep: {'layers.0', 'tok_embeddings', 'layers.3', 'layers.1', 'layers.2'}
[rank3]:Stage 3: Modules to keep: {'layers.13', 'output', 'layers.14', 'norm', 'layers.15'}
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1029_llama1b/config_1031.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
[rank3]:+ more freezing in autofreeze mode. 
[rank3]:+ lr_scheduler min_lr = 0 -> 1e-6, cosine decay.
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1031_1F1B_fullrand7_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1031_1F1B_fullrand7_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1031_1F1B_fullrand7_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1031_1F1B_fullrand7_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1031_1F1B_fullrand7_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1031_1F1B_fullrand7_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B-Instruct
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 1e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 300
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: alpaca
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 512
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 2400
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: 1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 4
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1031_1F1B_fullrand7_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B-Instruct/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1031_1F1B_fullrand7_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: True
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: fullrand7
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- threshold: 0.05
[rank3]:		- percentile: 70
[rank3]:
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
