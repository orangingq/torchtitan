
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 10. 30. (ëª©) 16:31:26 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 3,4,5,6
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1029_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1029_llama1b/1029_Interleaved1F1B_timelyapf.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
âœ”ï¸Running with timelyapf x Interleaved1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1029_llama1b/config.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=timelyapf
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank1]:2025-10-30 16:31:32,249 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank2]:2025-10-30 16:31:32,249 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank3]:2025-10-30 16:31:32,329 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank0]:2025-10-30 16:31:32,450 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank1]:2025-10-30 16:31:32,821 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-10-30 16:31:32,823 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-30 16:31:32,843 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-10-30 16:31:32,848 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-30 16:31:32,851 - INFO - [GC] Initial GC collection 0.00 seconds
[rank2]:2025-10-30 16:31:32,810 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-10-30 16:31:32,812 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-10-30 16:31:32,837 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-10-30 16:31:32,840 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-30 16:31:33,297 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-10-30 16:31:33,689 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank0]:2025-10-30 16:31:36,792 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=512, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank1]:2025-10-30 16:31:36,882 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-10-30 16:31:36,924 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-10-30 16:31:36,952 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.2', 'layers.3', 'layers.4']
[rank1]:2025-10-30 16:31:36,965 - INFO - PP rank 1 is building stage_idx 5 with modules ['layers.11', 'layers.12']
[rank1]:2025-10-30 16:31:36,966 - INFO - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank0]:2025-10-30 16:31:36,943 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-10-30 16:31:36,982 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-10-30 16:31:36,984 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank0]:2025-10-30 16:31:37,011 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1']
[rank0]:2025-10-30 16:31:37,023 - INFO - PP rank 0 is building stage_idx 4 with modules ['layers.9', 'layers.10']
[rank0]:2025-10-30 16:31:37,025 - INFO - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank1]:2025-10-30 16:31:37,137 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-10-30 16:31:37,137 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-10-30 16:31:37,138 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank2]:2025-10-30 16:31:37,127 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-10-30 16:31:37,167 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-10-30 16:31:37,194 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.5', 'layers.6']
[rank2]:2025-10-30 16:31:37,207 - INFO - PP rank 2 is building stage_idx 6 with modules ['layers.13', 'layers.14']
[rank2]:2025-10-30 16:31:37,208 - INFO - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank0]:2025-10-30 16:31:37,197 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-10-30 16:31:37,197 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-10-30 16:31:37,198 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank2]:2025-10-30 16:31:37,383 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-10-30 16:31:37,383 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-10-30 16:31:37,384 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run rha2dr1b
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1029_Interleaved1F1B_timelyapf_dm1/20251030-1631/wandb/run-20251030_163137-rha2dr1b
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1029_Interleaved1F1B_timelyapf_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/rha2dr1b
[rank3]:2025-10-30 16:31:38,852 - INFO - WandB logging enabled
[rank3]:2025-10-30 16:31:38,853 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-10-30 16:31:38,891 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-10-30 16:31:38,920 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.7', 'layers.8']
[rank3]:2025-10-30 16:31:38,933 - INFO - PP rank 3 is building stage_idx 7 with modules ['layers.15', 'norm', 'output']
[rank3]:2025-10-30 16:31:38,934 - INFO - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank2]:2025-10-30 16:31:39,124 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-10-30 16:31:39,107 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-10-30 16:31:39,108 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-10-30 16:31:39,109 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank1]:2025-10-30 16:31:39,124 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-10-30 16:31:39,124 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-10-30 16:31:39,124 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1029_Interleaved1F1B_timelyapf_dm1
[rank0]:2025-10-30 16:31:39,124 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-10-30 16:31:39,125 - INFO - Preparing c4_validation dataset from allenai/c4
[rank0]:2025-10-30 16:31:44,400 - INFO - Trainer is initialized with local batch size 32, global batch size 64, gradient accumulation steps 2, sequence length 512, total steps 2400 (warmup 100)
[rank0]:2025-10-30 16:31:44,400 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B-Instruct/original_dcp.
[rank0]:2025-10-30 16:31:46,635 - INFO - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-10-30 16:31:46,635 - INFO - Finished loading the checkpoint in 2.23 seconds.
[rank0]:2025-10-30 16:31:46,635 - INFO - Training starts at step 1
[rank2]:2025-10-30 16:31:49,843 - INFO -  step:  1  loss: -2.0000  grad_norm: 85.2039  memory:  6.22GiB(13.09%)  tps: 646  tflops: 4.92  mfu: 1.58%
[rank2]:2025-10-30 16:31:49,844 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-30 16:31:49,855 - INFO -  step:  1  loss:  9.0164  grad_norm: 85.2039  memory: 14.83GiB(31.21%)  tps: 747  tflops: 5.69  mfu: 1.82%
[rank3]:2025-10-30 16:31:49,856 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-10-30 16:31:49,859 - INFO -  step:  1  loss: -2.0000  grad_norm: 85.2039  memory:  9.23GiB(19.43%)  tps: 633  tflops: 4.82  mfu: 1.55%
[rank1]:2025-10-30 16:31:49,859 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-10-30 16:31:49,881 - INFO -  step:  1  loss: -2.0000  grad_norm: 85.2039  memory: 10.89GiB(22.92%)  tps: 635  tflops: 4.84  mfu: 1.55%
[rank0]:2025-10-30 16:31:49,882 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-30 16:32:09,037 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 16:32:09,038 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 16:32:09,038 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 16:32:09,038 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 16:32:09,039 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 16:32:09,039 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 16:32:09,039 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 16:32:09,040 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 16:32:09,040 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 16:32:09,040 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 16:32:09,041 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 16:32:09,041 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 16:32:09,041 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 16:32:09,041 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 16:32:09,042 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 16:32:09,042 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 16:32:09,042 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 16:32:09,042 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 16:32:09,043 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 16:32:09,043 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 16:32:09,043 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 16:32:09,083 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 16:32:09,044 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 16:32:09,044 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 16:32:09,044 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 16:32:09,084 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 16:32:09,084 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 16:32:09,084 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 16:32:09,044 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 16:32:09,045 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 16:32:09,045 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 16:32:09,084 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 16:32:09,084 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 16:32:09,061 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 16:32:09,062 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 16:32:09,084 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 16:32:09,045 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 16:32:09,062 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 16:32:09,084 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 16:32:09,046 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 16:32:09,062 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 16:32:09,046 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 16:32:09,084 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 16:32:09,062 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 16:32:09,046 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 16:32:09,084 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 16:32:09,062 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 16:32:09,046 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 16:32:09,084 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 16:32:09,062 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 16:32:09,084 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 16:32:09,084 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 16:32:09,085 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 16:32:09,085 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 16:32:09,062 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 16:32:09,085 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 16:32:09,062 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 16:32:09,062 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 16:32:09,063 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 16:32:09,063 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 16:32:09,063 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 16:32:09,063 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 16:32:09,063 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 16:32:09,063 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 16:32:09,063 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 16:32:09,063 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 16:32:09,063 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 16:32:09,063 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 16:32:09,063 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 16:32:09,064 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 16:32:09,064 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 16:32:09,064 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 16:32:09,064 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 16:32:09,064 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 16:32:09,064 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 16:32:09,064 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 16:32:09,064 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 16:32:09,064 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 16:32:09,064 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 16:32:09,064 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 16:32:09,085 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 16:32:09,085 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 16:32:09,085 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 16:32:09,085 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 16:32:09,085 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 16:32:09,085 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 16:32:09,085 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 16:32:09,085 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 16:32:09,086 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 16:32:09,105 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 16:32:09,086 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 16:32:09,086 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 16:32:09,086 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 16:32:09,086 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 16:32:09,086 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 16:32:09,086 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 16:32:09,086 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 16:32:09,105 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 16:32:09,105 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 16:32:09,105 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 16:32:09,105 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 16:32:09,105 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 16:32:09,106 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 16:32:09,106 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 16:32:09,106 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 16:32:09,106 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 16:32:09,106 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 16:32:09,106 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 16:32:09,106 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 16:32:09,106 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 16:32:09,106 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 16:32:09,106 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 16:32:09,106 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 16:32:09,106 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 16:32:09,107 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 16:32:09,107 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 16:32:09,107 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 16:32:09,107 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 16:32:09,107 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 16:32:09,107 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 16:32:09,107 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 16:32:09,107 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 16:32:09,107 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 16:32:09,107 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 16:32:09,107 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 16:32:09,107 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 16:32:09,108 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 16:32:09,108 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 16:32:53,030 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-30 16:32:54,370 - INFO -  step: 50  loss:  8.4823  grad_norm: 35.4403  memory: 18.19GiB(38.28%)  tps: 6,222  tflops: 47.39  mfu: 15.19%
[rank1]:2025-10-30 16:32:54,362 - INFO -  step: 50  loss: -2.0000  grad_norm: 35.4403  memory: 11.85GiB(24.93%)  tps: 6,223  tflops: 47.40  mfu: 15.19%
[rank0]:2025-10-30 16:32:54,372 - INFO -  step: 50  loss: -2.0000  grad_norm: 35.4403  memory: 14.71GiB(30.97%)  tps: 6,224  tflops: 47.41  mfu: 15.19%
[rank2]:2025-10-30 16:32:54,358 - INFO -  step: 50  loss: -2.0000  grad_norm: 35.4403  memory:  8.11GiB(17.07%)  tps: 6,222  tflops: 47.39  mfu: 15.19%
[rank3]:2025-10-30 16:33:07,222 - INFO - [Step 60] ã€°ï¸ Monitoring Upperbound
[rank3]:2025-10-30 16:33:20,985 - WARNING - [Step 70] â³ Monitoring Upperbound... (140/150)
[rank1]:2025-10-30 16:33:21,225 - WARNING - [Step 70] â³ Monitoring Upperbound... (140/150)
[rank2]:2025-10-30 16:33:21,208 - WARNING - [Step 70] â³ Monitoring Upperbound... (140/150)
[rank0]:2025-10-30 16:33:21,241 - WARNING - [Step 70] â³ Monitoring Upperbound... (140/150)
[rank3]:2025-10-30 16:33:36,503 - INFO - [Step 80] âœ”ï¸  Setting Upperbound
[rank3]:2025-10-30 16:33:36,798 - INFO - [Step 80] ã€°ï¸ Monitoring Lowerbound
[rank2]:2025-10-30 16:33:36,836 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-30 16:33:36,845 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-30 16:33:36,850 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-30 16:33:36,866 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-30 16:33:36,882 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-30 16:33:36,854 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-30 16:33:36,870 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-30 16:33:36,892 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-30 16:33:36,859 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-30 16:33:36,875 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-30 16:33:36,891 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-30 16:33:39,192 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-30 16:33:39,201 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-30 16:33:39,210 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-30 16:33:39,219 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-30 16:33:39,232 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-30 16:33:39,223 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-30 16:33:39,195 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-30 16:33:39,249 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-30 16:33:39,222 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-30 16:33:39,249 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-30 16:33:39,253 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-30 16:33:39,274 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-30 16:33:39,296 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-30 16:33:39,323 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-30 16:33:39,252 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-30 16:33:39,323 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-30 16:33:39,346 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-30 16:33:39,307 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-30 16:33:39,334 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-30 16:33:39,337 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-30 16:33:39,344 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-30 16:33:39,355 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-30 16:33:39,389 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-30 16:33:39,397 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-30 16:33:39,404 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-30 16:33:39,415 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-30 16:33:39,422 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-30 16:33:39,428 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-30 16:33:39,394 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-30 16:33:39,414 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-30 16:33:39,419 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-30 16:33:39,427 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-30 16:33:39,435 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-30 16:33:39,441 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-30 16:33:39,365 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-30 16:33:39,395 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-30 16:33:39,406 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-30 16:33:39,416 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-30 16:33:39,424 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-30 16:33:39,435 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-30 16:33:39,444 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-30 16:33:39,388 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-30 16:33:39,404 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-30 16:33:39,413 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-30 16:33:39,418 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-30 16:33:39,425 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-30 16:33:39,434 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-30 16:33:39,445 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-30 16:33:39,454 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-30 16:33:39,468 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-30 16:33:39,480 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-30 16:33:39,452 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-30 16:33:39,459 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-30 16:33:59,643 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-30 16:34:00,589 - INFO -  step: 100  loss: -2.0000  grad_norm:  0.0000  memory:  8.11GiB(17.07%)  tps: 6,184  tflops: 47.10  mfu: 15.10%
[rank1]:2025-10-30 16:34:00,590 - INFO -  step: 100  loss: -2.0000  grad_norm:  0.0000  memory: 11.85GiB(24.93%)  tps: 6,185  tflops: 47.10  mfu: 15.10%
[rank0]:2025-10-30 16:34:00,590 - INFO -  step: 100  loss: -2.0000  grad_norm:  0.0000  memory: 14.71GiB(30.97%)  tps: 6,186  tflops: 47.11  mfu: 15.10%
[rank3]:2025-10-30 16:34:02,967 - INFO -  step: 100  loss:  7.9834  grad_norm:  0.0000  memory: 18.19GiB(38.28%)  tps: 5,971  tflops: 45.48  mfu: 14.58%
[rank2]:2025-10-30 16:34:03,050 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251030_1634_stage2_step100.svg
[rank1]:2025-10-30 16:34:03,051 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251030_1634_stage1_step100.svg
[rank0]:2025-10-30 16:34:03,052 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251030_1634_stage0_step100.svg
[rank2]:2025-10-30 16:34:03,111 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251030_1634_stage6_step100.svg
[rank1]:2025-10-30 16:34:03,112 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251030_1634_stage5_step100.svg
[rank0]:2025-10-30 16:34:03,110 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251030_1634_stage4_step100.svg
[rank3]:2025-10-30 16:34:03,292 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/pipeline_schedule/251030_1634_real_step100_rank3.svg
[rank3]:> Batch Time: 497.96 ms, GPU Bubble Ratio: 49.12%, 46.42%, 56.77%, 13.13%
[rank3]:2025-10-30 16:34:03,357 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251030_1634_stage3_step100.svg
[rank3]:2025-10-30 16:34:03,413 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251030_1634_stage7_step100.svg
[rank0]:2025-10-30 16:34:03,590 - INFO - Avg. fwd time: 4.3941 / Avg. bwd time: 10.7819 / Avg. batch time: 658.0991 (ms) / GPU bubble ratio: 63.10%
[rank3]:2025-10-30 16:34:03,663 - INFO - Avg. fwd time: 6.4153 / Avg. bwd time: 19.9696 / Avg. batch time: 535.1489 (ms) / GPU bubble ratio: 21.11%
[rank2]:2025-10-30 16:34:03,684 - INFO - Avg. fwd time: 4.1404 / Avg. bwd time: 9.0898 / Avg. batch time: 609.3138 (ms) / GPU bubble ratio: 65.26%
[rank1]:2025-10-30 16:34:03,701 - INFO - Avg. fwd time: 4.9934 / Avg. bwd time: 11.2268 / Avg. batch time: 636.9498 (ms) / GPU bubble ratio: 59.26%
[rank3]:2025-10-30 16:34:12,921 - INFO - [Step 110] âœ”ï¸  Setting Lowerbound
[rank3]:2025-10-30 16:34:13,276 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/pipeline_schedule/251030_1634_max_batch_time.svg
[rank3]:> Batch Time: 504.29 ms, GPU Bubble Ratio: 49.10%, 46.68%, 56.94%, 12.94%
[rank3]:2025-10-30 16:34:13,632 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/pipeline_schedule/251030_1634_min_batch_time.svg
[rank3]:> Batch Time: 310.27 ms, GPU Bubble Ratio: 67.67%, 46.79%, 56.09%, 11.09%
[rank3]:2025-10-30 16:34:14,015 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/pipeline_schedule/251030_1634_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 320.67 ms, GPU Bubble Ratio: 33.23%, 27.62%, 38.92%, 9.79%
[rank3]:2025-10-30 16:34:14,016 - INFO - 	> Batch Time: 320.67 ms (Average Freeze Ratio: 0.42, Time Reduction Rate: 0.36)
[rank0]:2025-10-30 16:35:05,204 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-30 16:35:06,279 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank1]:2025-10-30 16:35:06,280 - INFO -  step: 150  loss: -2.0000  grad_norm: 23.0441  memory: 11.87GiB(24.98%)  tps: 6,235  tflops: 47.49  mfu: 15.22%
[rank2]:2025-10-30 16:35:06,274 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.50/0.76, [MB4] 0.67/1.00, [MB5] 0.55/0.82, [MB6] 0.38/0.57, [MB7] 0.67/1.00
[rank2]:2025-10-30 16:35:06,275 - INFO -  step: 150  loss: -2.0000  grad_norm: 23.0441  memory:  8.40GiB(17.69%)  tps: 6,236  tflops: 47.49  mfu: 15.22%
[rank0]:2025-10-30 16:35:06,288 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.43/0.64, [MB4] 0.00/0.00, [MB5] 0.47/0.71, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank0]:2025-10-30 16:35:06,288 - INFO -  step: 150  loss: -2.0000  grad_norm: 23.0441  memory: 14.91GiB(31.39%)  tps: 6,235  tflops: 47.48  mfu: 15.22%
[rank3]:2025-10-30 16:35:08,703 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.13/0.20, [MB1] 0.67/1.00, [MB2] 0.67/1.00, [MB3] 0.67/1.00, [MB0] 0.67/1.00, [MB1] 0.67/1.00, [MB2] 0.67/1.00, [MB3] 0.45/0.67, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.35/0.53
[rank3]:2025-10-30 16:35:08,706 - INFO -  step: 150  loss:  4.7781  grad_norm: 23.0441  memory: 18.19GiB(38.28%)  tps: 6,231  tflops: 47.46  mfu: 15.21%
[rank0]:2025-10-30 16:36:08,378 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-30 16:36:09,391 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.76/0.76, [MB4] 1.00/1.00, [MB5] 0.82/0.82, [MB6] 0.57/0.57, [MB7] 1.00/1.00
[rank2]:2025-10-30 16:36:09,391 - INFO -  step: 200  loss: -2.0000  grad_norm:  0.2633  memory:  8.40GiB(17.69%)  tps: 6,490  tflops: 49.43  mfu: 15.84%
[rank2]:2025-10-30 16:36:09,392 - INFO - ðŸ”Ž  Running validation at step 200
[rank1]:2025-10-30 16:36:09,391 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-30 16:36:09,399 - INFO -  step: 200  loss: -2.0000  grad_norm:  0.2633  memory: 12.18GiB(25.63%)  tps: 6,489  tflops: 49.42  mfu: 15.84%
[rank1]:2025-10-30 16:36:09,399 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-10-30 16:36:09,390 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.64/0.64, [MB4] 0.00/0.00, [MB5] 0.71/0.71, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank0]:2025-10-30 16:36:09,391 - INFO -  step: 200  loss: -2.0000  grad_norm:  0.2633  memory: 14.91GiB(31.39%)  tps: 6,491  tflops: 49.44  mfu: 15.85%
[rank0]:2025-10-30 16:36:09,398 - INFO - ðŸ”Ž  Running validation at step 200
[rank3]:2025-10-30 16:36:11,764 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.20/0.20, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 0.67/0.67, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 0.53/0.53
[rank3]:2025-10-30 16:36:11,766 - INFO -  step: 200  loss:  3.6828  grad_norm:  0.2633  memory: 18.19GiB(38.28%)  tps: 6,496  tflops: 49.47  mfu: 15.86%
[rank3]:2025-10-30 16:36:11,767 - INFO - ðŸ”Ž  Running validation at step 200
[rank1]:2025-10-30 16:36:40,468 - INFO - validate step: 200  loss: -1.0000  memory: 12.18GiB(25.63%)  tps: 13,184
[rank0]:2025-10-30 16:36:40,462 - INFO - validate step: 200  loss: -1.0000  memory: 14.91GiB(31.39%)  tps: 13,186
[rank3]:2025-10-30 16:36:40,486 - INFO - validate step: 200  loss:  2.0591  memory: 18.19GiB(38.28%)  tps: 14,263
[rank1]:2025-10-30 16:36:40,566 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251030_1636_stage1_step200.svg
[rank0]:2025-10-30 16:36:40,564 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251030_1636_stage0_step200.svg
[rank2]:2025-10-30 16:36:40,487 - INFO - validate step: 200  loss: -1.0000  memory:  8.40GiB(17.69%)  tps: 13,173
[rank2]:2025-10-30 16:36:40,566 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251030_1636_stage2_step200.svg
[rank1]:2025-10-30 16:36:40,633 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251030_1636_stage5_step200.svg
[rank0]:2025-10-30 16:36:40,629 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251030_1636_stage4_step200.svg
[rank2]:2025-10-30 16:36:40,632 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251030_1636_stage6_step200.svg
[rank3]:2025-10-30 16:36:40,798 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/pipeline_schedule/251030_1636_real_step200_rank3.svg
[rank3]:> Batch Time: 378.32 ms, GPU Bubble Ratio: 42.51%, 38.95%, 48.89%, 14.91%
[rank3]:2025-10-30 16:36:40,863 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251030_1636_stage3_step200.svg
[rank3]:2025-10-30 16:36:40,924 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251030_1636_stage7_step200.svg
[rank0]:2025-10-30 16:36:41,173 - INFO - Avg. fwd time: 4.4805 / Avg. bwd time: 8.3091 / Avg. batch time: 630.0452 (ms) / GPU bubble ratio: 67.52%
[rank3]:2025-10-30 16:36:41,180 - INFO - Avg. fwd time: 6.8747 / Avg. bwd time: 15.7783 / Avg. batch time: 480.6182 (ms) / GPU bubble ratio: 24.59%
[rank1]:2025-10-30 16:36:41,227 - INFO - Avg. fwd time: 5.2581 / Avg. bwd time: 9.3713 / Avg. batch time: 613.1603 (ms) / GPU bubble ratio: 61.83%
[rank2]:2025-10-30 16:36:41,215 - INFO - Avg. fwd time: 4.2393 / Avg. bwd time: 7.8743 / Avg. batch time: 590.0735 (ms) / GPU bubble ratio: 67.15%
[rank0]:2025-10-30 16:37:38,923 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-30 16:37:39,907 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.64/0.64, [MB4] 0.00/0.00, [MB5] 0.71/0.71, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank0]:2025-10-30 16:37:39,908 - INFO -  step: 250  loss: -2.0000  grad_norm:  0.7266  memory: 14.91GiB(31.39%)  tps: 6,890  tflops: 52.48  mfu: 16.82%
[rank1]:2025-10-30 16:37:39,908 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-30 16:37:39,908 - INFO -  step: 250  loss: -2.0000  grad_norm:  0.7266  memory: 12.18GiB(25.63%)  tps: 6,891  tflops: 52.48  mfu: 16.82%
[rank2]:2025-10-30 16:37:39,908 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.76/0.76, [MB4] 1.00/1.00, [MB5] 0.82/0.82, [MB6] 0.57/0.57, [MB7] 1.00/1.00
[rank2]:2025-10-30 16:37:39,908 - INFO -  step: 250  loss: -2.0000  grad_norm:  0.7266  memory:  8.40GiB(17.69%)  tps: 6,893  tflops: 52.50  mfu: 16.83%
[rank3]:2025-10-30 16:37:42,262 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.20/0.20, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 0.67/0.67, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 0.53/0.53
[rank3]:2025-10-30 16:37:42,265 - INFO -  step: 250  loss:  4.3084  grad_norm:  0.7266  memory: 18.19GiB(38.28%)  tps: 6,630  tflops: 50.50  mfu: 16.19%
[rank0]:2025-10-30 16:38:40,241 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-30 16:38:41,442 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/pipeline_schedule_adjustment/251030_1638_rank3_trend_line.svg
[rank0]:2025-10-30 16:38:41,472 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/pipeline_schedule_adjustment/251030_1638_rank0_trend_line.svg
[rank0]:2025-10-30 16:38:41,514 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-30 16:38:41,516 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-30 16:38:41,516 - INFO -  step: 300  loss: -2.0000  grad_norm:  1.5957  memory: 14.91GiB(31.39%)  tps: 6,648  tflops: 50.64  mfu: 16.23%
[rank1]:2025-10-30 16:38:41,483 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/pipeline_schedule_adjustment/251030_1638_rank1_trend_line.svg
[rank1]:2025-10-30 16:38:41,513 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-30 16:38:41,516 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-30 16:38:41,516 - INFO -  step: 300  loss: -2.0000  grad_norm:  1.5957  memory: 12.18GiB(25.63%)  tps: 6,649  tflops: 50.64  mfu: 16.23%
[rank2]:2025-10-30 16:38:41,500 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/pipeline_schedule_adjustment/251030_1638_rank2_trend_line.svg
[rank2]:2025-10-30 16:38:41,514 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank2]:2025-10-30 16:38:41,516 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank2]:2025-10-30 16:38:41,517 - INFO -  step: 300  loss: -2.0000  grad_norm:  1.5957  memory:  8.40GiB(17.69%)  tps: 6,648  tflops: 50.64  mfu: 16.23%
[rank3]:2025-10-30 16:38:41,826 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/pipeline_schedule/251030_1638_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 327.14 ms, GPU Bubble Ratio: 52.84%, 40.56%, 47.06%, 10.81%
[rank3]:2025-10-30 16:38:41,827 - INFO - 	> Batch Time: 327.14 ms (Average Freeze Ratio: 0.31)
[rank3]:2025-10-30 16:38:41,827 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 0.20/0.20, [MB4] 1.00/1.00, [MB5] 0.79/0.79, [MB6] 0.00/0.00, [MB7] 0.81/0.81
[rank3]:2025-10-30 16:38:44,186 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 0.20/0.20, [MB4] 1.00/1.00, [MB5] 0.79/0.79, [MB6] 0.00/0.00, [MB7] 0.81/0.81
[rank3]:2025-10-30 16:38:44,189 - INFO -  step: 300  loss:  4.1981  grad_norm:  1.5957  memory: 18.19GiB(38.28%)  tps: 6,615  tflops: 50.38  mfu: 16.15%
[rank0]:2025-10-30 16:38:44,260 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251030_1638_stage0_step300.svg
[rank0]:2025-10-30 16:38:44,323 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251030_1638_stage4_step300.svg
[rank1]:2025-10-30 16:38:44,263 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251030_1638_stage1_step300.svg
[rank1]:2025-10-30 16:38:44,330 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251030_1638_stage5_step300.svg
[rank2]:2025-10-30 16:38:44,266 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251030_1638_stage2_step300.svg
[rank2]:2025-10-30 16:38:44,336 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251030_1638_stage6_step300.svg
[rank3]:2025-10-30 16:38:44,495 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/pipeline_schedule/251030_1638_real_step300_rank3.svg
[rank3]:> Batch Time: 357.01 ms, GPU Bubble Ratio: 51.09%, 41.54%, 49.07%, 13.87%
[rank3]:2025-10-30 16:38:44,558 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251030_1638_stage3_step300.svg
[rank3]:2025-10-30 16:38:44,619 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251030_1638_stage7_step300.svg
[rank3]:2025-10-30 16:38:45,065 - INFO - Avg. fwd time: 7.0344 / Avg. bwd time: 14.2930 / Avg. batch time: 462.4918 (ms) / GPU bubble ratio: 26.22%
[rank0]:2025-10-30 16:38:45,109 - INFO - Avg. fwd time: 4.5236 / Avg. bwd time: 6.7669 / Avg. batch time: 614.0942 (ms) / GPU bubble ratio: 70.58%
[rank1]:2025-10-30 16:38:45,101 - INFO - Avg. fwd time: 5.3712 / Avg. bwd time: 8.4592 / Avg. batch time: 600.2471 (ms) / GPU bubble ratio: 63.13%
[rank2]:2025-10-30 16:38:45,086 - INFO - Avg. fwd time: 4.3060 / Avg. bwd time: 7.4355 / Avg. batch time: 579.5670 (ms) / GPU bubble ratio: 67.59%
[rank0]:2025-10-30 16:39:43,058 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-30 16:39:44,066 - INFO -  step: 350  loss: -2.0000  grad_norm:  0.7236  memory: 14.91GiB(31.39%)  tps: 6,548  tflops: 49.87  mfu: 15.99%
[rank2]:2025-10-30 16:39:44,073 - INFO -  step: 350  loss: -2.0000  grad_norm:  0.7236  memory:  8.40GiB(17.69%)  tps: 6,548  tflops: 49.87  mfu: 15.98%
[rank1]:2025-10-30 16:39:44,067 - INFO -  step: 350  loss: -2.0000  grad_norm:  0.7236  memory: 12.18GiB(25.63%)  tps: 6,548  tflops: 49.87  mfu: 15.99%
[rank3]:2025-10-30 16:39:46,457 - INFO -  step: 350  loss:  3.8442  grad_norm:  0.0000  memory: 18.19GiB(38.28%)  tps: 6,578  tflops: 50.10  mfu: 16.06%
[rank0]:2025-10-30 16:40:45,054 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-30 16:40:46,353 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/pipeline_schedule_adjustment/251030_1640_rank3_trend_line.svg
[rank0]:2025-10-30 16:40:46,358 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/pipeline_schedule_adjustment/251030_1640_rank0_trend_line.svg
[rank0]:2025-10-30 16:40:46,381 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.57/0.57, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-30 16:40:46,384 - INFO -  step: 400  loss: -2.0000  grad_norm:  0.2709  memory: 14.91GiB(31.39%)  tps: 6,573  tflops: 50.06  mfu: 16.04%
[rank1]:2025-10-30 16:40:46,368 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/pipeline_schedule_adjustment/251030_1640_rank1_trend_line.svg
[rank1]:2025-10-30 16:40:46,381 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-30 16:40:46,384 - INFO -  step: 400  loss: -2.0000  grad_norm:  0.2709  memory: 12.18GiB(25.63%)  tps: 6,573  tflops: 50.06  mfu: 16.04%
[rank1]:2025-10-30 16:40:46,384 - INFO - ðŸ”Ž  Running validation at step 400
[rank2]:2025-10-30 16:40:46,363 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/pipeline_schedule_adjustment/251030_1640_rank2_trend_line.svg
[rank2]:2025-10-30 16:40:46,381 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00, [MB4] 0.22/0.22, [MB5] 0.05/0.05, [MB6] 0.25/0.25, [MB7] 1.00/1.00
[rank2]:2025-10-30 16:40:46,384 - INFO -  step: 400  loss: -2.0000  grad_norm:  0.2709  memory:  8.40GiB(17.69%)  tps: 6,573  tflops: 50.06  mfu: 16.05%
[rank2]:2025-10-30 16:40:46,384 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-10-30 16:40:46,384 - INFO - ðŸ”Ž  Running validation at step 400
[rank3]:2025-10-30 16:40:46,691 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/pipeline_schedule/251030_1640_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 324.84 ms, GPU Bubble Ratio: 54.43%, 38.81%, 43.80%, 11.14%
[rank3]:2025-10-30 16:40:46,692 - INFO - 	> Batch Time: 324.84 ms (Average Freeze Ratio: 0.32)
[rank3]:2025-10-30 16:40:46,693 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 0.20/0.20, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank3]:2025-10-30 16:40:49,072 - INFO -  step: 400  loss:  3.6605  grad_norm:  0.0000  memory: 18.19GiB(38.28%)  tps: 6,542  tflops: 49.82  mfu: 15.97%
[rank3]:2025-10-30 16:40:49,073 - INFO - ðŸ”Ž  Running validation at step 400
[rank3]:2025-10-30 16:41:15,772 - INFO - validate step: 400  loss:  1.9385  memory: 18.19GiB(38.28%)  tps: 15,342
[rank0]:2025-10-30 16:41:15,748 - INFO - validate step: 400  loss: -1.0000  memory: 14.91GiB(31.39%)  tps: 13,949
[rank2]:2025-10-30 16:41:15,786 - INFO - validate step: 400  loss: -1.0000  memory:  8.40GiB(17.69%)  tps: 13,931
[rank1]:2025-10-30 16:41:15,753 - INFO - validate step: 400  loss: -1.0000  memory: 12.18GiB(25.63%)  tps: 13,947
[rank0]:2025-10-30 16:41:15,869 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251030_1641_stage0_step400.svg
[rank2]:2025-10-30 16:41:15,868 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251030_1641_stage2_step400.svg
[rank1]:2025-10-30 16:41:15,869 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251030_1641_stage1_step400.svg
[rank0]:2025-10-30 16:41:15,940 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251030_1641_stage4_step400.svg
[rank2]:2025-10-30 16:41:15,939 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251030_1641_stage6_step400.svg
[rank1]:2025-10-30 16:41:15,941 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251030_1641_stage5_step400.svg
[rank3]:2025-10-30 16:41:16,100 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/pipeline_schedule/251030_1641_real_step400_rank3.svg
[rank3]:> Batch Time: 349.24 ms, GPU Bubble Ratio: 59.68%, 40.80%, 46.64%, 13.03%
[rank3]:2025-10-30 16:41:16,172 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251030_1641_stage3_step400.svg
[rank3]:2025-10-30 16:41:16,240 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251030_1641_stage7_step400.svg
[rank3]:2025-10-30 16:41:16,495 - INFO - Avg. fwd time: 7.1124 / Avg. bwd time: 13.5384 / Avg. batch time: 454.1324 (ms) / GPU bubble ratio: 27.24%
[rank0]:2025-10-30 16:41:16,481 - INFO - Avg. fwd time: 4.5067 / Avg. bwd time: 6.3075 / Avg. batch time: 611.8429 (ms) / GPU bubble ratio: 71.72%
[rank2]:2025-10-30 16:41:16,559 - INFO - Avg. fwd time: 4.2848 / Avg. bwd time: 7.7272 / Avg. batch time: 579.6818 (ms) / GPU bubble ratio: 66.85%
[rank1]:2025-10-30 16:41:16,567 - INFO - Avg. fwd time: 5.3824 / Avg. bwd time: 8.4003 / Avg. batch time: 599.3132 (ms) / GPU bubble ratio: 63.20%
[rank0]:2025-10-30 16:42:17,654 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-30 16:42:18,638 - INFO -  step: 450  loss: -2.0000  grad_norm:  2.8485  memory: 14.91GiB(31.39%)  tps: 6,513  tflops: 49.60  mfu: 15.90%
[rank2]:2025-10-30 16:42:18,638 - INFO -  step: 450  loss: -2.0000  grad_norm:  2.8485  memory:  8.58GiB(18.06%)  tps: 6,517  tflops: 49.63  mfu: 15.91%
[rank1]:2025-10-30 16:42:18,638 - INFO -  step: 450  loss: -2.0000  grad_norm:  2.8485  memory: 12.18GiB(25.63%)  tps: 6,513  tflops: 49.61  mfu: 15.90%
[rank3]:2025-10-30 16:42:21,126 - INFO -  step: 450  loss:  3.8003  grad_norm:  0.0000  memory: 18.19GiB(38.28%)  tps: 6,268  tflops: 47.74  mfu: 15.30%
[rank0]:2025-10-30 16:43:19,283 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-30 16:43:20,268 - INFO -  step: 500  loss: -2.0000  grad_norm:  2.3699  memory: 14.91GiB(31.39%)  tps: 6,646  tflops: 50.62  mfu: 16.22%
[rank2]:2025-10-30 16:43:20,269 - INFO -  step: 500  loss: -2.0000  grad_norm:  2.3699  memory:  8.58GiB(18.06%)  tps: 6,646  tflops: 50.62  mfu: 16.22%
[rank1]:2025-10-30 16:43:20,269 - INFO -  step: 500  loss: -2.0000  grad_norm:  2.3699  memory: 12.18GiB(25.63%)  tps: 6,646  tflops: 50.62  mfu: 16.22%
[rank3]:2025-10-30 16:43:22,733 - INFO -  step: 500  loss:  3.6815  grad_norm:  0.0000  memory: 18.19GiB(38.28%)  tps: 6,649  tflops: 50.64  mfu: 16.23%
[rank0]:2025-10-30 16:43:22,808 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251030_1643_stage0_step500.svg
[rank0]:2025-10-30 16:43:22,871 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251030_1643_stage4_step500.svg
[rank2]:2025-10-30 16:43:22,812 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251030_1643_stage2_step500.svg
[rank2]:2025-10-30 16:43:22,878 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251030_1643_stage6_step500.svg
[rank1]:2025-10-30 16:43:22,812 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251030_1643_stage1_step500.svg
[rank1]:2025-10-30 16:43:22,879 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251030_1643_stage5_step500.svg
[rank3]:2025-10-30 16:43:23,044 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/pipeline_schedule/251030_1643_real_step500_rank3.svg
[rank3]:> Batch Time: 347.15 ms, GPU Bubble Ratio: 60.04%, 37.62%, 48.92%, 13.20%
[rank3]:2025-10-30 16:43:23,109 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251030_1643_stage3_step500.svg
[rank3]:2025-10-30 16:43:23,168 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251030_1643_stage7_step500.svg
[rank3]:2025-10-30 16:43:23,419 - INFO - Avg. fwd time: 7.1761 / Avg. bwd time: 12.9804 / Avg. batch time: 448.3535 (ms) / GPU bubble ratio: 28.07%
[rank0]:2025-10-30 16:43:23,397 - INFO - Avg. fwd time: 4.5205 / Avg. bwd time: 5.8200 / Avg. batch time: 609.5737 (ms) / GPU bubble ratio: 72.86%
[rank2]:2025-10-30 16:43:23,458 - INFO - Avg. fwd time: 4.3141 / Avg. bwd time: 7.4859 / Avg. batch time: 579.0886 (ms) / GPU bubble ratio: 67.40%
[rank1]:2025-10-30 16:43:23,495 - INFO - Avg. fwd time: 5.4014 / Avg. bwd time: 8.3558 / Avg. batch time: 597.9839 (ms) / GPU bubble ratio: 63.19%
[rank0]:2025-10-30 16:44:21,125 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-30 16:44:22,117 - INFO -  step: 550  loss: -2.0000  grad_norm:  0.5610  memory: 14.91GiB(31.39%)  tps: 6,623  tflops: 50.44  mfu: 16.17%
[rank2]:2025-10-30 16:44:22,117 - INFO -  step: 550  loss: -2.0000  grad_norm:  0.5610  memory:  8.58GiB(18.06%)  tps: 6,623  tflops: 50.44  mfu: 16.17%
[rank1]:2025-10-30 16:44:22,117 - INFO -  step: 550  loss: -2.0000  grad_norm:  0.5610  memory: 12.18GiB(25.63%)  tps: 6,623  tflops: 50.44  mfu: 16.17%
[rank3]:2025-10-30 16:44:24,578 - INFO -  step: 550  loss:  3.5660  grad_norm:  0.0000  memory: 18.19GiB(38.28%)  tps: 6,623  tflops: 50.44  mfu: 16.17%
[rank0]:2025-10-30 16:45:22,605 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-30 16:45:23,987 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/pipeline_schedule_adjustment/251030_1645_rank3_trend_line.svg
[rank2]:2025-10-30 16:45:24,004 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/pipeline_schedule_adjustment/251030_1645_rank2_trend_line.svg
[rank2]:2025-10-30 16:45:24,020 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-30 16:45:24,023 - INFO -  step: 600  loss: -2.0000  grad_norm:  0.1965  memory:  8.58GiB(18.06%)  tps: 6,616  tflops: 50.39  mfu: 16.15%
[rank2]:2025-10-30 16:45:24,023 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-10-30 16:45:23,994 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/pipeline_schedule_adjustment/251030_1645_rank0_trend_line.svg
[rank0]:2025-10-30 16:45:24,019 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank0]:2025-10-30 16:45:24,022 - INFO -  step: 600  loss: -2.0000  grad_norm:  0.1965  memory: 14.91GiB(31.39%)  tps: 6,617  tflops: 50.39  mfu: 16.15%
[rank0]:2025-10-30 16:45:24,022 - INFO - ðŸ”Ž  Running validation at step 600
[rank1]:2025-10-30 16:45:24,006 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/pipeline_schedule_adjustment/251030_1645_rank1_trend_line.svg
[rank1]:2025-10-30 16:45:24,019 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 0.81/0.81, [MB7] 1.00/1.00
[rank1]:2025-10-30 16:45:24,023 - INFO -  step: 600  loss: -2.0000  grad_norm:  0.1965  memory: 12.18GiB(25.63%)  tps: 6,617  tflops: 50.39  mfu: 16.15%
[rank1]:2025-10-30 16:45:24,023 - INFO - ðŸ”Ž  Running validation at step 600
[rank3]:2025-10-30 16:45:24,332 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/pipeline_schedule/251030_1645_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 320.04 ms, GPU Bubble Ratio: 56.43%, 36.85%, 45.25%, 12.70%
[rank3]:2025-10-30 16:45:24,333 - INFO - 	> Batch Time: 320.04 ms (Average Freeze Ratio: 0.22)
[rank3]:2025-10-30 16:45:24,334 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 0.20/0.20, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank3]:2025-10-30 16:45:26,804 - INFO -  step: 600  loss:  3.6541  grad_norm:  0.0000  memory: 18.19GiB(38.28%)  tps: 6,583  tflops: 50.14  mfu: 16.07%
[rank3]:2025-10-30 16:45:26,805 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-10-30 16:45:53,760 - INFO - validate step: 600  loss: -1.0000  memory: 14.91GiB(31.39%)  tps: 13,774
[rank1]:2025-10-30 16:45:53,767 - INFO - validate step: 600  loss: -1.0000  memory: 12.18GiB(25.63%)  tps: 13,771
[rank3]:2025-10-30 16:45:53,785 - INFO - validate step: 600  loss:  1.9180  memory: 18.19GiB(38.28%)  tps: 15,182
[rank2]:2025-10-30 16:45:53,787 - INFO - validate step: 600  loss: -1.0000  memory:  8.58GiB(18.06%)  tps: 13,762
[rank2]:2025-10-30 16:45:53,868 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251030_1645_stage2_step600.svg
[rank0]:2025-10-30 16:45:53,867 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251030_1645_stage0_step600.svg
[rank1]:2025-10-30 16:45:53,867 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251030_1645_stage1_step600.svg
[rank2]:2025-10-30 16:45:53,934 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251030_1645_stage6_step600.svg
[rank0]:2025-10-30 16:45:53,933 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251030_1645_stage4_step600.svg
[rank1]:2025-10-30 16:45:53,934 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251030_1645_stage5_step600.svg
[rank3]:2025-10-30 16:45:54,100 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/pipeline_schedule/251030_1645_real_step600_rank3.svg
[rank3]:> Batch Time: 343.07 ms, GPU Bubble Ratio: 59.93%, 36.71%, 49.23%, 13.46%
[rank3]:2025-10-30 16:45:54,168 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251030_1645_stage3_step600.svg
[rank3]:2025-10-30 16:45:54,231 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251030_1645_stage7_step600.svg
[rank3]:2025-10-30 16:45:54,687 - INFO - Avg. fwd time: 7.2185 / Avg. bwd time: 12.6101 / Avg. batch time: 444.5272 (ms) / GPU bubble ratio: 28.63%
[rank2]:2025-10-30 16:45:54,705 - INFO - Avg. fwd time: 4.3361 / Avg. bwd time: 7.2895 / Avg. batch time: 575.8783 (ms) / GPU bubble ratio: 67.70%
[rank0]:2025-10-30 16:45:54,730 - INFO - Avg. fwd time: 4.5332 / Avg. bwd time: 5.4807 / Avg. batch time: 605.2834 (ms) / GPU bubble ratio: 73.53%
[rank1]:2025-10-30 16:45:54,721 - INFO - Avg. fwd time: 5.4147 / Avg. bwd time: 8.3263 / Avg. batch time: 594.2998 (ms) / GPU bubble ratio: 63.01%
[rank0]:2025-10-30 16:46:57,547 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-30 16:46:58,634 - INFO -  step: 650  loss: -2.0000  grad_norm:  4.8452  memory:  8.58GiB(18.06%)  tps: 6,316  tflops: 48.11  mfu: 15.42%
[rank0]:2025-10-30 16:46:58,654 - INFO -  step: 650  loss: -2.0000  grad_norm:  4.8452  memory: 14.91GiB(31.39%)  tps: 6,312  tflops: 48.07  mfu: 15.41%
[rank1]:2025-10-30 16:46:58,633 - INFO -  step: 650  loss: -2.0000  grad_norm:  4.8452  memory: 12.18GiB(25.63%)  tps: 6,315  tflops: 48.09  mfu: 15.41%
[rank3]:2025-10-30 16:47:01,118 - INFO -  step: 650  loss:  3.5827  grad_norm:  4.8452  memory: 18.19GiB(38.28%)  tps: 6,083  tflops: 46.33  mfu: 14.85%
[rank0]:2025-10-30 16:48:04,518 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-30 16:48:05,607 - INFO -  step: 700  loss: -2.0000  grad_norm: 27.3503  memory:  8.58GiB(18.06%)  tps: 6,116  tflops: 46.58  mfu: 14.93%
[rank0]:2025-10-30 16:48:05,626 - INFO -  step: 700  loss: -2.0000  grad_norm: 27.3503  memory: 14.91GiB(31.39%)  tps: 6,116  tflops: 46.58  mfu: 14.93%
[rank1]:2025-10-30 16:48:05,606 - INFO -  step: 700  loss: -2.0000  grad_norm: 27.3503  memory: 12.18GiB(25.63%)  tps: 6,116  tflops: 46.58  mfu: 14.93%
[rank3]:2025-10-30 16:48:08,107 - INFO -  step: 700  loss:  3.6277  grad_norm: 27.3503  memory: 18.19GiB(38.28%)  tps: 6,115  tflops: 46.57  mfu: 14.93%
[rank2]:2025-10-30 16:48:08,193 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251030_1648_stage2_step700.svg
[rank0]:2025-10-30 16:48:08,188 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251030_1648_stage0_step700.svg
[rank0]:2025-10-30 16:48:08,254 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251030_1648_stage4_step700.svg
[rank1]:2025-10-30 16:48:08,190 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251030_1648_stage1_step700.svg
[rank1]:2025-10-30 16:48:08,262 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251030_1648_stage5_step700.svg
[rank2]:2025-10-30 16:48:08,264 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251030_1648_stage6_step700.svg
[rank3]:2025-10-30 16:48:08,411 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/pipeline_schedule/251030_1648_real_step700_rank3.svg
[rank3]:> Batch Time: 345.61 ms, GPU Bubble Ratio: 59.99%, 37.36%, 49.77%, 13.23%
[rank3]:2025-10-30 16:48:08,479 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251030_1648_stage3_step700.svg
[rank3]:2025-10-30 16:48:08,544 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251030_1648_stage7_step700.svg
[rank3]:2025-10-30 16:48:08,826 - INFO - Avg. fwd time: 7.1926 / Avg. bwd time: 12.7572 / Avg. batch time: 444.6690 (ms) / GPU bubble ratio: 28.22%
[rank2]:2025-10-30 16:48:08,839 - INFO - Avg. fwd time: 4.3345 / Avg. bwd time: 7.1696 / Avg. batch time: 577.8985 (ms) / GPU bubble ratio: 68.15%
[rank1]:2025-10-30 16:48:08,854 - INFO - Avg. fwd time: 5.4214 / Avg. bwd time: 8.1124 / Avg. batch time: 596.6734 (ms) / GPU bubble ratio: 63.71%
[rank0]:2025-10-30 16:48:08,894 - INFO - Avg. fwd time: 4.4787 / Avg. bwd time: 6.3378 / Avg. batch time: 610.0940 (ms) / GPU bubble ratio: 71.63%
[rank0]:2025-10-30 16:49:11,674 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-30 16:49:12,789 - INFO -  step: 750  loss: -2.0000  grad_norm:  3.1665  memory: 14.91GiB(31.39%)  tps: 6,099  tflops: 46.45  mfu: 14.89%
[rank2]:2025-10-30 16:49:12,769 - INFO -  step: 750  loss: -2.0000  grad_norm:  3.1665  memory:  8.58GiB(18.06%)  tps: 6,099  tflops: 46.45  mfu: 14.89%
[rank1]:2025-10-30 16:49:12,769 - INFO -  step: 750  loss: -2.0000  grad_norm:  3.1665  memory: 12.18GiB(25.63%)  tps: 6,099  tflops: 46.45  mfu: 14.89%
[rank3]:2025-10-30 16:49:15,315 - INFO -  step: 750  loss:  3.5776  grad_norm:  3.1665  memory: 18.19GiB(38.28%)  tps: 6,095  tflops: 46.42  mfu: 14.88%
[rank0]:2025-10-30 16:50:18,464 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-30 16:50:20,012 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/pipeline_schedule_adjustment/251030_1650_rank3_trend_line.svg
[rank0]:2025-10-30 16:50:20,064 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/pipeline_schedule_adjustment/251030_1650_rank0_trend_line.svg
[rank0]:2025-10-30 16:50:20,077 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-30 16:50:20,080 - INFO -  step: 800  loss: -2.0000  grad_norm:  0.6882  memory: 14.91GiB(31.39%)  tps: 6,087  tflops: 46.36  mfu: 14.86%
[rank0]:2025-10-30 16:50:20,080 - INFO - ðŸ”Ž  Running validation at step 800
[rank1]:2025-10-30 16:50:20,059 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/pipeline_schedule_adjustment/251030_1650_rank1_trend_line.svg
[rank1]:2025-10-30 16:50:20,077 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 0.37/0.37, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-30 16:50:20,081 - INFO -  step: 800  loss: -2.0000  grad_norm:  0.6882  memory: 12.18GiB(25.63%)  tps: 6,085  tflops: 46.35  mfu: 14.85%
[rank1]:2025-10-30 16:50:20,081 - INFO - ðŸ”Ž  Running validation at step 800
[rank2]:2025-10-30 16:50:20,048 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/pipeline_schedule_adjustment/251030_1650_rank2_trend_line.svg
[rank2]:2025-10-30 16:50:20,077 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank2]:2025-10-30 16:50:20,080 - INFO -  step: 800  loss: -2.0000  grad_norm:  0.6882  memory:  8.58GiB(18.06%)  tps: 6,085  tflops: 46.35  mfu: 14.85%
[rank2]:2025-10-30 16:50:20,080 - INFO - ðŸ”Ž  Running validation at step 800
[rank3]:2025-10-30 16:50:20,384 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/pipeline_schedule/251030_1650_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 320.78 ms, GPU Bubble Ratio: 45.96%, 38.38%, 46.92%, 10.66%
[rank3]:2025-10-30 16:50:20,385 - INFO - 	> Batch Time: 320.78 ms (Average Freeze Ratio: 0.33)
[rank3]:2025-10-30 16:50:20,385 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 0.20/0.20, [MB4] 1.00/1.00, [MB5] 0.34/0.34, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank3]:2025-10-30 16:50:22,849 - INFO -  step: 800  loss:  3.5700  grad_norm:  0.6882  memory: 18.19GiB(38.28%)  tps: 6,065  tflops: 46.19  mfu: 14.81%
[rank3]:2025-10-30 16:50:22,849 - INFO - ðŸ”Ž  Running validation at step 800
[rank3]:2025-10-30 16:50:49,795 - INFO - validate step: 800  loss:  1.8972  memory: 18.19GiB(38.28%)  tps: 15,202
[rank3]:2025-10-30 16:50:49,796 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-30 16:50:49,772 - INFO - validate step: 800  loss: -1.0000  memory: 14.91GiB(31.39%)  tps: 13,795
[rank0]:2025-10-30 16:50:49,772 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-30 16:50:49,782 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank1]:2025-10-30 16:50:49,775 - INFO - validate step: 800  loss: -1.0000  memory: 12.18GiB(25.63%)  tps: 13,794
[rank1]:2025-10-30 16:50:49,776 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-30 16:50:49,794 - INFO - validate step: 800  loss: -1.0000  memory:  8.58GiB(18.06%)  tps: 13,785
[rank2]:2025-10-30 16:50:49,795 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-30 16:50:52,016 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 2.22 seconds.
[rank1]:2025-10-30 16:50:52,447 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 2.67 seconds.
[rank3]:2025-10-30 16:50:53,194 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.40 seconds.
[rank0]:2025-10-30 16:50:53,559 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-30 16:50:53,567 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.79 seconds.
[rank1]:2025-10-30 16:50:53,657 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251030_1650_stage1_step800.svg
[rank2]:2025-10-30 16:50:53,659 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251030_1650_stage2_step800.svg
[rank0]:2025-10-30 16:50:53,672 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251030_1650_stage0_step800.svg
[rank1]:2025-10-30 16:50:53,729 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251030_1650_stage5_step800.svg
[rank2]:2025-10-30 16:50:53,730 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251030_1650_stage6_step800.svg
[rank3]:2025-10-30 16:50:54,022 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/pipeline_schedule/251030_1650_real_step800_rank3.svg
[rank3]:> Batch Time: 346.58 ms, GPU Bubble Ratio: 59.33%, 40.21%, 50.03%, 12.98%
[rank0]:2025-10-30 16:50:53,989 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251030_1650_stage4_step800.svg
[rank3]:2025-10-30 16:50:54,099 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251030_1650_stage3_step800.svg
[rank3]:2025-10-30 16:50:54,169 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251030_1650_stage7_step800.svg
[rank3]:2025-10-30 16:50:54,489 - INFO - Avg. fwd time: 7.1694 / Avg. bwd time: 12.8885 / Avg. batch time: 444.8053 (ms) / GPU bubble ratio: 27.85%
[rank0]:2025-10-30 16:50:54,524 - INFO - Avg. fwd time: 4.4304 / Avg. bwd time: 7.0930 / Avg. batch time: 611.9123 (ms) / GPU bubble ratio: 69.87%
[rank1]:2025-10-30 16:50:54,511 - INFO - Avg. fwd time: 5.4269 / Avg. bwd time: 7.9227 / Avg. batch time: 596.3374 (ms) / GPU bubble ratio: 64.18%
[rank2]:2025-10-30 16:50:54,505 - INFO - Avg. fwd time: 4.3325 / Avg. bwd time: 7.0632 / Avg. batch time: 577.2607 (ms) / GPU bubble ratio: 68.41%
[rank3]:2025-10-30 16:51:07,521 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-30 16:51:07,571 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-30 16:51:07,564 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-30 16:51:07,553 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-30 16:51:53,899 - INFO - [GC] Peforming periodical GC collection 0.33 seconds
[rank0]:2025-10-30 16:51:54,893 - INFO -  step: 850  loss: -2.0000  grad_norm:  0.5469  memory: 14.91GiB(31.39%)  tps: 6,290  tflops: 47.90  mfu: 15.35%
[rank1]:2025-10-30 16:51:54,893 - INFO -  step: 850  loss: -2.0000  grad_norm:  0.5469  memory: 12.18GiB(25.63%)  tps: 6,290  tflops: 47.91  mfu: 15.35%
[rank2]:2025-10-30 16:51:54,900 - INFO -  step: 850  loss: -2.0000  grad_norm:  0.5469  memory:  8.58GiB(18.06%)  tps: 6,291  tflops: 47.92  mfu: 15.36%
[rank3]:2025-10-30 16:51:57,493 - INFO -  step: 850  loss:  3.6548  grad_norm:  0.0000  memory: 18.19GiB(38.28%)  tps: 6,051  tflops: 46.08  mfu: 14.77%
[rank0]:2025-10-30 16:52:56,403 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-30 16:52:57,400 - INFO -  step: 900  loss: -2.0000  grad_norm:  0.7166  memory: 12.18GiB(25.63%)  tps: 6,553  tflops: 49.91  mfu: 16.00%
[rank0]:2025-10-30 16:52:57,400 - INFO -  step: 900  loss: -2.0000  grad_norm:  0.7166  memory: 14.91GiB(31.39%)  tps: 6,553  tflops: 49.91  mfu: 16.00%
[rank2]:2025-10-30 16:52:57,407 - INFO -  step: 900  loss: -2.0000  grad_norm:  0.7166  memory:  8.58GiB(18.06%)  tps: 6,553  tflops: 49.91  mfu: 16.00%
[rank3]:2025-10-30 16:52:59,909 - INFO -  step: 900  loss:  3.5524  grad_norm:  0.0000  memory: 18.19GiB(38.28%)  tps: 6,563  tflops: 49.98  mfu: 16.02%
[rank1]:2025-10-30 16:52:59,988 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251030_1652_stage1_step900.svg
[rank0]:2025-10-30 16:52:59,984 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251030_1652_stage0_step900.svg
[rank2]:2025-10-30 16:52:59,986 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251030_1652_stage2_step900.svg
[rank1]:2025-10-30 16:53:00,052 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251030_1652_stage5_step900.svg
[rank0]:2025-10-30 16:53:00,044 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251030_1652_stage4_step900.svg
[rank2]:2025-10-30 16:53:00,049 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251030_1652_stage6_step900.svg
[rank3]:2025-10-30 16:53:00,219 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/pipeline_schedule/251030_1652_real_step900_rank3.svg
[rank3]:> Batch Time: 344.57 ms, GPU Bubble Ratio: 59.67%, 42.35%, 49.67%, 12.86%
[rank3]:2025-10-30 16:53:00,283 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251030_1652_stage3_step900.svg
[rank3]:2025-10-30 16:53:00,342 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251030_1652_stage7_step900.svg
[rank3]:2025-10-30 16:53:00,785 - INFO - Avg. fwd time: 7.1947 / Avg. bwd time: 12.6660 / Avg. batch time: 442.4206 (ms) / GPU bubble ratio: 28.17%
[rank2]:2025-10-30 16:53:00,816 - INFO - Avg. fwd time: 4.3203 / Avg. bwd time: 7.2442 / Avg. batch time: 576.6958 (ms) / GPU bubble ratio: 67.92%
[rank1]:2025-10-30 16:53:00,833 - INFO - Avg. fwd time: 5.4402 / Avg. bwd time: 7.7867 / Avg. batch time: 595.4625 (ms) / GPU bubble ratio: 64.46%
[rank0]:2025-10-30 16:53:00,843 - INFO - Avg. fwd time: 4.4561 / Avg. bwd time: 6.7071 / Avg. batch time: 610.2839 (ms) / GPU bubble ratio: 70.73%
[rank0]:2025-10-30 16:53:59,298 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-30 16:54:00,300 - INFO -  step: 950  loss: -2.0000  grad_norm:  0.1763  memory: 12.18GiB(25.63%)  tps: 6,512  tflops: 49.60  mfu: 15.90%
[rank0]:2025-10-30 16:54:00,300 - INFO -  step: 950  loss: -2.0000  grad_norm:  0.1763  memory: 14.91GiB(31.39%)  tps: 6,512  tflops: 49.60  mfu: 15.90%
[rank2]:2025-10-30 16:54:00,306 - INFO -  step: 950  loss: -2.0000  grad_norm:  0.1763  memory:  8.58GiB(18.06%)  tps: 6,512  tflops: 49.60  mfu: 15.90%
[rank3]:2025-10-30 16:54:02,833 - INFO -  step: 950  loss:  3.6119  grad_norm:  0.0000  memory: 18.19GiB(38.28%)  tps: 6,510  tflops: 49.58  mfu: 15.89%
[rank0]:2025-10-30 16:55:01,747 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-30 16:55:02,763 - INFO -  step: 1000  loss: -2.0000  grad_norm:  0.1526  memory: 12.18GiB(25.63%)  tps: 6,558  tflops: 49.94  mfu: 16.01%
[rank1]:2025-10-30 16:55:02,763 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-10-30 16:55:02,762 - INFO -  step: 1000  loss: -2.0000  grad_norm:  0.1526  memory: 14.91GiB(31.39%)  tps: 6,558  tflops: 49.94  mfu: 16.01%
[rank0]:2025-10-30 16:55:02,762 - INFO - ðŸ”Ž  Running validation at step 1000
[rank2]:2025-10-30 16:55:02,769 - INFO -  step: 1000  loss: -2.0000  grad_norm:  0.1526  memory:  8.58GiB(18.06%)  tps: 6,558  tflops: 49.94  mfu: 16.01%
[rank2]:2025-10-30 16:55:02,769 - INFO - ðŸ”Ž  Running validation at step 1000
[rank3]:2025-10-30 16:55:05,267 - INFO -  step: 1000  loss:  3.4645  grad_norm:  0.0000  memory: 18.19GiB(38.28%)  tps: 6,561  tflops: 49.97  mfu: 16.02%
[rank3]:2025-10-30 16:55:05,268 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-10-30 16:55:32,015 - INFO - validate step: 1000  loss: -1.0000  memory: 14.91GiB(31.39%)  tps: 14,002
[rank3]:2025-10-30 16:55:32,038 - INFO - validate step: 1000  loss:  1.8969  memory: 18.19GiB(38.28%)  tps: 15,301
[rank1]:2025-10-30 16:55:32,025 - INFO - validate step: 1000  loss: -1.0000  memory: 12.18GiB(25.63%)  tps: 13,998
[rank0]:2025-10-30 16:55:32,120 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251030_1655_stage0_step1000.svg
[rank2]:2025-10-30 16:55:32,043 - INFO - validate step: 1000  loss: -1.0000  memory:  8.58GiB(18.06%)  tps: 13,992
[rank2]:2025-10-30 16:55:32,122 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251030_1655_stage2_step1000.svg
[rank1]:2025-10-30 16:55:32,123 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251030_1655_stage1_step1000.svg
[rank1]:2025-10-30 16:55:32,189 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251030_1655_stage5_step1000.svg
[rank0]:2025-10-30 16:55:32,183 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251030_1655_stage4_step1000.svg
[rank2]:2025-10-30 16:55:32,190 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251030_1655_stage6_step1000.svg
[rank3]:2025-10-30 16:55:32,347 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/pipeline_schedule/251030_1655_real_step1000_rank3.svg
[rank3]:> Batch Time: 341.36 ms, GPU Bubble Ratio: 59.72%, 41.98%, 49.08%, 13.09%
[rank3]:2025-10-30 16:55:32,411 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251030_1655_stage3_step1000.svg
[rank3]:2025-10-30 16:55:32,470 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251030_1655_stage7_step1000.svg
[rank0]:2025-10-30 16:55:32,661 - INFO - Avg. fwd time: 4.4764 / Avg. bwd time: 6.4040 / Avg. batch time: 610.2626 (ms) / GPU bubble ratio: 71.47%
[rank3]:2025-10-30 16:55:32,727 - INFO - Avg. fwd time: 7.2146 / Avg. bwd time: 12.5021 / Avg. batch time: 440.6934 (ms) / GPU bubble ratio: 28.42%
[rank1]:2025-10-30 16:55:32,784 - INFO - Avg. fwd time: 5.4503 / Avg. bwd time: 7.6934 / Avg. batch time: 596.0582 (ms) / GPU bubble ratio: 64.72%
[rank2]:2025-10-30 16:55:32,798 - INFO - Avg. fwd time: 4.3115 / Avg. bwd time: 7.3798 / Avg. batch time: 577.5295 (ms) / GPU bubble ratio: 67.61%
[rank0]:2025-10-30 16:56:31,609 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-30 16:56:32,619 - INFO -  step: 1050  loss: -2.0000  grad_norm:  0.9406  memory: 14.91GiB(31.39%)  tps: 6,759  tflops: 51.47  mfu: 16.50%
[rank1]:2025-10-30 16:56:32,620 - INFO -  step: 1050  loss: -2.0000  grad_norm:  0.9406  memory: 12.18GiB(25.63%)  tps: 6,760  tflops: 51.48  mfu: 16.50%
[rank2]:2025-10-30 16:56:32,626 - INFO -  step: 1050  loss: -2.0000  grad_norm:  0.9406  memory:  8.58GiB(18.06%)  tps: 6,761  tflops: 51.49  mfu: 16.50%
[rank3]:2025-10-30 16:56:35,124 - INFO -  step: 1050  loss:  3.5146  grad_norm:  0.0000  memory: 18.19GiB(38.28%)  tps: 6,493  tflops: 49.45  mfu: 15.85%
[rank0]:2025-10-30 16:57:34,146 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-30 16:57:35,152 - INFO -  step: 1100  loss: -2.0000  grad_norm:  0.3090  memory: 12.18GiB(25.63%)  tps: 6,550  tflops: 49.89  mfu: 15.99%
[rank0]:2025-10-30 16:57:35,152 - INFO -  step: 1100  loss: -2.0000  grad_norm:  0.3090  memory: 14.91GiB(31.39%)  tps: 6,550  tflops: 49.89  mfu: 15.99%
[rank2]:2025-10-30 16:57:35,159 - INFO -  step: 1100  loss: -2.0000  grad_norm:  0.3090  memory:  8.58GiB(18.06%)  tps: 6,550  tflops: 49.89  mfu: 15.99%
[rank3]:2025-10-30 16:57:37,722 - INFO -  step: 1100  loss:  3.4071  grad_norm:  0.0000  memory: 18.19GiB(38.28%)  tps: 6,544  tflops: 49.84  mfu: 15.97%
[rank1]:2025-10-30 16:57:37,803 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251030_1657_stage1_step1100.svg
[rank0]:2025-10-30 16:57:37,800 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251030_1657_stage0_step1100.svg
[rank0]:2025-10-30 16:57:37,863 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251030_1657_stage4_step1100.svg
[rank2]:2025-10-30 16:57:37,802 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251030_1657_stage2_step1100.svg
[rank2]:2025-10-30 16:57:37,868 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251030_1657_stage6_step1100.svg
[rank1]:2025-10-30 16:57:37,870 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251030_1657_stage5_step1100.svg
[rank3]:2025-10-30 16:57:38,034 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/pipeline_schedule/251030_1657_real_step1100_rank3.svg
[rank3]:> Batch Time: 339.37 ms, GPU Bubble Ratio: 59.91%, 41.68%, 48.49%, 13.21%
[rank3]:2025-10-30 16:57:38,102 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251030_1657_stage3_step1100.svg
[rank3]:2025-10-30 16:57:38,166 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251030_1657_stage7_step1100.svg
[rank0]:2025-10-30 16:57:38,354 - INFO - Avg. fwd time: 4.4954 / Avg. bwd time: 6.1130 / Avg. batch time: 608.7413 (ms) / GPU bubble ratio: 72.12%
[rank3]:2025-10-30 16:57:38,419 - INFO - Avg. fwd time: 7.2336 / Avg. bwd time: 12.3439 / Avg. batch time: 439.0255 (ms) / GPU bubble ratio: 28.65%
[rank2]:2025-10-30 16:57:38,489 - INFO - Avg. fwd time: 4.3028 / Avg. bwd time: 7.5088 / Avg. batch time: 576.8298 (ms) / GPU bubble ratio: 67.24%
[rank1]:2025-10-30 16:57:38,476 - INFO - Avg. fwd time: 5.4597 / Avg. bwd time: 7.6032 / Avg. batch time: 595.1286 (ms) / GPU bubble ratio: 64.88%
[rank0]:2025-10-30 16:58:37,160 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-30 16:58:38,170 - INFO -  step: 1150  loss: -2.0000  grad_norm:  0.2358  memory:  8.58GiB(18.06%)  tps: 6,500  tflops: 49.51  mfu: 15.87%
[rank1]:2025-10-30 16:58:38,164 - INFO -  step: 1150  loss: -2.0000  grad_norm:  0.2358  memory: 12.18GiB(25.63%)  tps: 6,500  tflops: 49.51  mfu: 15.87%
[rank0]:2025-10-30 16:58:38,163 - INFO -  step: 1150  loss: -2.0000  grad_norm:  0.2358  memory: 14.91GiB(31.39%)  tps: 6,500  tflops: 49.51  mfu: 15.87%
[rank3]:2025-10-30 16:58:40,824 - INFO -  step: 1150  loss:  3.5079  grad_norm:  0.0000  memory: 18.19GiB(38.28%)  tps: 6,491  tflops: 49.44  mfu: 15.85%
[rank0]:2025-10-30 16:59:39,930 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-30 16:59:40,937 - INFO -  step: 1200  loss: -2.0000  grad_norm:  0.1748  memory: 14.91GiB(31.39%)  tps: 6,525  tflops: 49.70  mfu: 15.93%
[rank0]:2025-10-30 16:59:40,937 - INFO - ðŸ”Ž  Running validation at step 1200
[rank2]:2025-10-30 16:59:40,944 - INFO -  step: 1200  loss: -2.0000  grad_norm:  0.1748  memory:  8.58GiB(18.06%)  tps: 6,525  tflops: 49.70  mfu: 15.93%
[rank2]:2025-10-30 16:59:40,944 - INFO - ðŸ”Ž  Running validation at step 1200
[rank1]:2025-10-30 16:59:40,937 - INFO -  step: 1200  loss: -2.0000  grad_norm:  0.1748  memory: 12.18GiB(25.63%)  tps: 6,525  tflops: 49.70  mfu: 15.93%
[rank1]:2025-10-30 16:59:40,938 - INFO - ðŸ”Ž  Running validation at step 1200
[rank3]:2025-10-30 16:59:43,463 - INFO -  step: 1200  loss:  3.5872  grad_norm:  0.0000  memory: 18.19GiB(38.28%)  tps: 6,539  tflops: 49.80  mfu: 15.96%
[rank3]:2025-10-30 16:59:43,463 - INFO - ðŸ”Ž  Running validation at step 1200
[rank1]:2025-10-30 17:00:10,444 - INFO - validate step: 1200  loss: -1.0000  memory: 12.18GiB(25.63%)  tps: 13,882
[rank3]:2025-10-30 17:00:10,460 - INFO - validate step: 1200  loss:  1.9063  memory: 18.19GiB(38.28%)  tps: 15,173
[rank0]:2025-10-30 17:00:10,434 - INFO - validate step: 1200  loss: -1.0000  memory: 14.91GiB(31.39%)  tps: 13,886
[rank2]:2025-10-30 17:00:10,464 - INFO - validate step: 1200  loss: -1.0000  memory:  8.58GiB(18.06%)  tps: 13,875
[rank1]:2025-10-30 17:00:10,547 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251030_1700_stage1_step1200.svg
[rank0]:2025-10-30 17:00:10,549 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251030_1700_stage0_step1200.svg
[rank2]:2025-10-30 17:00:10,552 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251030_1700_stage2_step1200.svg
[rank1]:2025-10-30 17:00:10,615 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251030_1700_stage5_step1200.svg
[rank0]:2025-10-30 17:00:10,614 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251030_1700_stage4_step1200.svg
[rank2]:2025-10-30 17:00:10,624 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251030_1700_stage6_step1200.svg
[rank3]:2025-10-30 17:00:10,772 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/pipeline_schedule/251030_1700_real_step1200_rank3.svg
[rank3]:> Batch Time: 339.24 ms, GPU Bubble Ratio: 59.97%, 41.68%, 45.72%, 13.32%
[rank3]:2025-10-30 17:00:10,840 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251030_1700_stage3_step1200.svg
[rank3]:2025-10-30 17:00:10,903 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251030_1700_stage7_step1200.svg
[rank3]:2025-10-30 17:00:11,353 - INFO - Avg. fwd time: 7.2490 / Avg. bwd time: 12.2146 / Avg. batch time: 437.6503 (ms) / GPU bubble ratio: 28.84%
[rank2]:2025-10-30 17:00:11,385 - INFO - Avg. fwd time: 4.2959 / Avg. bwd time: 7.6161 / Avg. batch time: 576.4426 (ms) / GPU bubble ratio: 66.94%
[rank1]:2025-10-30 17:00:11,402 - INFO - Avg. fwd time: 5.4676 / Avg. bwd time: 7.5296 / Avg. batch time: 594.5554 (ms) / GPU bubble ratio: 65.02%
[rank0]:2025-10-30 17:00:11,414 - INFO - Avg. fwd time: 4.5111 / Avg. bwd time: 5.8733 / Avg. batch time: 607.6839 (ms) / GPU bubble ratio: 72.66%
[rank0]:2025-10-30 17:01:10,301 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-30 17:01:11,311 - INFO -  step: 1250  loss: -2.0000  grad_norm:  0.3996  memory: 12.18GiB(25.63%)  tps: 6,730  tflops: 51.25  mfu: 16.43%
[rank0]:2025-10-30 17:01:11,310 - INFO -  step: 1250  loss: -2.0000  grad_norm:  0.3996  memory: 14.91GiB(31.39%)  tps: 6,728  tflops: 51.25  mfu: 16.42%
[rank2]:2025-10-30 17:01:11,317 - INFO -  step: 1250  loss: -2.0000  grad_norm:  0.3996  memory:  8.58GiB(18.06%)  tps: 6,731  tflops: 51.27  mfu: 16.43%
[rank3]:2025-10-30 17:01:13,853 - INFO -  step: 1250  loss:  3.4937  grad_norm:  0.0000  memory: 18.19GiB(38.28%)  tps: 6,462  tflops: 49.21  mfu: 15.77%
[rank0]:2025-10-30 17:02:13,053 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-30 17:02:14,059 - INFO -  step: 1300  loss: -2.0000  grad_norm:  1.0879  memory:  8.58GiB(18.06%)  tps: 6,528  tflops: 49.72  mfu: 15.94%
[rank1]:2025-10-30 17:02:14,053 - INFO -  step: 1300  loss: -2.0000  grad_norm:  1.0879  memory: 12.18GiB(25.63%)  tps: 6,528  tflops: 49.72  mfu: 15.94%
[rank0]:2025-10-30 17:02:14,052 - INFO -  step: 1300  loss: -2.0000  grad_norm:  1.0879  memory: 14.91GiB(31.39%)  tps: 6,528  tflops: 49.72  mfu: 15.94%
[rank3]:2025-10-30 17:02:16,592 - INFO -  step: 1300  loss:  3.5015  grad_norm:  0.0000  memory: 18.19GiB(38.28%)  tps: 6,529  tflops: 49.73  mfu: 15.94%
[rank1]:2025-10-30 17:02:16,677 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251030_1702_stage1_step1300.svg
[rank0]:2025-10-30 17:02:16,676 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251030_1702_stage0_step1300.svg
[rank0]:2025-10-30 17:02:16,743 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251030_1702_stage4_step1300.svg
[rank2]:2025-10-30 17:02:16,676 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251030_1702_stage2_step1300.svg
[rank2]:2025-10-30 17:02:16,745 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251030_1702_stage6_step1300.svg
[rank1]:2025-10-30 17:02:16,747 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251030_1702_stage5_step1300.svg
[rank3]:2025-10-30 17:02:16,908 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/pipeline_schedule/251030_1702_real_step1300_rank3.svg
[rank3]:> Batch Time: 344.71 ms, GPU Bubble Ratio: 60.72%, 42.62%, 40.79%, 14.78%
[rank3]:2025-10-30 17:02:16,977 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251030_1702_stage3_step1300.svg
[rank3]:2025-10-30 17:02:17,041 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251030_1702_stage7_step1300.svg
[rank0]:2025-10-30 17:02:17,230 - INFO - Avg. fwd time: 4.5228 / Avg. bwd time: 5.6987 / Avg. batch time: 608.1096 (ms) / GPU bubble ratio: 73.11%
[rank3]:2025-10-30 17:02:17,298 - INFO - Avg. fwd time: 7.2606 / Avg. bwd time: 12.1205 / Avg. batch time: 436.6538 (ms) / GPU bubble ratio: 28.98%
[rank2]:2025-10-30 17:02:17,367 - INFO - Avg. fwd time: 4.2906 / Avg. bwd time: 7.6934 / Avg. batch time: 577.3610 (ms) / GPU bubble ratio: 66.79%
[rank1]:2025-10-30 17:02:17,353 - INFO - Avg. fwd time: 5.4732 / Avg. bwd time: 7.4756 / Avg. batch time: 595.3357 (ms) / GPU bubble ratio: 65.20%
[rank0]:2025-10-30 17:03:16,006 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-30 17:03:17,011 - INFO -  step: 1350  loss: -2.0000  grad_norm:  0.3001  memory: 14.91GiB(31.39%)  tps: 6,506  tflops: 49.55  mfu: 15.88%
[rank2]:2025-10-30 17:03:17,017 - INFO -  step: 1350  loss: -2.0000  grad_norm:  0.3001  memory:  8.58GiB(18.06%)  tps: 6,506  tflops: 49.55  mfu: 15.88%
[rank1]:2025-10-30 17:03:17,011 - INFO -  step: 1350  loss: -2.0000  grad_norm:  0.3001  memory: 12.18GiB(25.63%)  tps: 6,506  tflops: 49.55  mfu: 15.88%
[rank3]:2025-10-30 17:03:19,596 - INFO -  step: 1350  loss:  3.5202  grad_norm:  0.0000  memory: 18.19GiB(38.28%)  tps: 6,501  tflops: 49.52  mfu: 15.87%
[rank0]:2025-10-30 17:04:18,622 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-30 17:04:19,633 - INFO -  step: 1400  loss: -2.0000  grad_norm:  0.1559  memory: 12.18GiB(25.63%)  tps: 6,541  tflops: 49.82  mfu: 15.97%
[rank1]:2025-10-30 17:04:19,633 - INFO - ðŸ”Ž  Running validation at step 1400
[rank0]:2025-10-30 17:04:19,633 - INFO -  step: 1400  loss: -2.0000  grad_norm:  0.1559  memory: 14.91GiB(31.39%)  tps: 6,541  tflops: 49.82  mfu: 15.97%
[rank0]:2025-10-30 17:04:19,633 - INFO - ðŸ”Ž  Running validation at step 1400
[rank2]:2025-10-30 17:04:19,639 - INFO -  step: 1400  loss: -2.0000  grad_norm:  0.1559  memory:  8.58GiB(18.06%)  tps: 6,541  tflops: 49.82  mfu: 15.97%
[rank2]:2025-10-30 17:04:19,640 - INFO - ðŸ”Ž  Running validation at step 1400
[rank3]:2025-10-30 17:04:22,173 - INFO -  step: 1400  loss:  3.5369  grad_norm:  0.0000  memory: 18.19GiB(38.28%)  tps: 6,546  tflops: 49.85  mfu: 15.98%
[rank3]:2025-10-30 17:04:22,173 - INFO - ðŸ”Ž  Running validation at step 1400
[rank1]:2025-10-30 17:04:49,094 - INFO - validate step: 1400  loss: -1.0000  memory: 12.18GiB(25.63%)  tps: 13,904
[rank3]:2025-10-30 17:04:49,108 - INFO - validate step: 1400  loss:  1.9043  memory: 18.19GiB(38.28%)  tps: 15,207
[rank0]:2025-10-30 17:04:49,085 - INFO - validate step: 1400  loss: -1.0000  memory: 14.91GiB(31.39%)  tps: 13,908
[rank2]:2025-10-30 17:04:49,111 - INFO - validate step: 1400  loss: -1.0000  memory:  8.58GiB(18.06%)  tps: 13,899
[rank1]:2025-10-30 17:04:49,205 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251030_1704_stage1_step1400.svg
[rank2]:2025-10-30 17:04:49,199 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251030_1704_stage2_step1400.svg
[rank0]:2025-10-30 17:04:49,198 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251030_1704_stage0_step1400.svg
[rank1]:2025-10-30 17:04:49,282 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251030_1704_stage5_step1400.svg
[rank2]:2025-10-30 17:04:49,270 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251030_1704_stage6_step1400.svg
[rank0]:2025-10-30 17:04:49,267 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251030_1704_stage4_step1400.svg
[rank3]:2025-10-30 17:04:49,425 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/pipeline_schedule/251030_1704_real_step1400_rank3.svg
[rank3]:> Batch Time: 344.62 ms, GPU Bubble Ratio: 60.76%, 42.62%, 40.37%, 14.84%
[rank3]:2025-10-30 17:04:49,497 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251030_1704_stage3_step1400.svg
[rank3]:2025-10-30 17:04:49,564 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251030_1704_stage7_step1400.svg
[rank3]:2025-10-30 17:04:49,823 - INFO - Avg. fwd time: 7.2711 / Avg. bwd time: 12.0245 / Avg. batch time: 435.6178 (ms) / GPU bubble ratio: 29.13%
[rank0]:2025-10-30 17:04:49,755 - INFO - Avg. fwd time: 4.5343 / Avg. bwd time: 5.5235 / Avg. batch time: 607.0407 (ms) / GPU bubble ratio: 73.49%
[rank1]:2025-10-30 17:04:49,878 - INFO - Avg. fwd time: 5.4788 / Avg. bwd time: 7.4217 / Avg. batch time: 594.6220 (ms) / GPU bubble ratio: 65.29%
[rank2]:2025-10-30 17:04:49,895 - INFO - Avg. fwd time: 4.2855 / Avg. bwd time: 7.7716 / Avg. batch time: 576.7862 (ms) / GPU bubble ratio: 66.55%
[rank0]:2025-10-30 17:05:48,876 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-30 17:05:49,877 - INFO -  step: 1450  loss: -2.0000  grad_norm:  0.2051  memory: 12.18GiB(25.63%)  tps: 6,739  tflops: 51.32  mfu: 16.45%
[rank0]:2025-10-30 17:05:49,876 - INFO -  step: 1450  loss: -2.0000  grad_norm:  0.2051  memory: 14.91GiB(31.39%)  tps: 6,738  tflops: 51.32  mfu: 16.45%
[rank2]:2025-10-30 17:05:49,883 - INFO -  step: 1450  loss: -2.0000  grad_norm:  0.2051  memory:  8.58GiB(18.06%)  tps: 6,740  tflops: 51.33  mfu: 16.45%
[rank3]:2025-10-30 17:05:52,414 - INFO -  step: 1450  loss:  3.6093  grad_norm:  0.0000  memory: 18.19GiB(38.28%)  tps: 6,470  tflops: 49.28  mfu: 15.79%
[rank0]:2025-10-30 17:06:51,580 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-30 17:06:52,587 - INFO -  step: 1500  loss: -2.0000  grad_norm:  0.2542  memory:  8.58GiB(18.06%)  tps: 6,532  tflops: 49.75  mfu: 15.95%
[rank0]:2025-10-30 17:06:52,581 - INFO -  step: 1500  loss: -2.0000  grad_norm:  0.2542  memory: 14.91GiB(31.39%)  tps: 6,532  tflops: 49.75  mfu: 15.95%
[rank1]:2025-10-30 17:06:52,581 - INFO -  step: 1500  loss: -2.0000  grad_norm:  0.2542  memory: 12.18GiB(25.63%)  tps: 6,532  tflops: 49.75  mfu: 15.95%
[rank3]:2025-10-30 17:06:55,114 - INFO -  step: 1500  loss:  3.4797  grad_norm:  0.0000  memory: 18.19GiB(38.28%)  tps: 6,533  tflops: 49.76  mfu: 15.95%
[rank2]:2025-10-30 17:06:55,200 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251030_1706_stage2_step1500.svg
[rank0]:2025-10-30 17:06:55,199 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251030_1706_stage0_step1500.svg
[rank1]:2025-10-30 17:06:55,204 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251030_1706_stage1_step1500.svg
[rank1]:2025-10-30 17:06:55,274 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251030_1706_stage5_step1500.svg
[rank2]:2025-10-30 17:06:55,269 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251030_1706_stage6_step1500.svg
[rank0]:2025-10-30 17:06:55,266 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251030_1706_stage4_step1500.svg
[rank3]:2025-10-30 17:06:55,428 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/pipeline_schedule/251030_1706_real_step1500_rank3.svg
[rank3]:> Batch Time: 344.57 ms, GPU Bubble Ratio: 61.30%, 42.62%, 40.27%, 14.87%
[rank3]:2025-10-30 17:06:55,498 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251030_1706_stage3_step1500.svg
[rank3]:2025-10-30 17:06:55,564 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251030_1706_stage7_step1500.svg
[rank1]:2025-10-30 17:06:56,058 - INFO - Avg. fwd time: 5.4836 / Avg. bwd time: 7.3757 / Avg. batch time: 594.2568 (ms) / GPU bubble ratio: 65.38%
[rank3]:2025-10-30 17:06:56,008 - INFO - Avg. fwd time: 7.2805 / Avg. bwd time: 11.9435 / Avg. batch time: 434.7510 (ms) / GPU bubble ratio: 29.25%
[rank2]:2025-10-30 17:06:56,039 - INFO - Avg. fwd time: 4.2810 / Avg. bwd time: 7.8394 / Avg. batch time: 576.5375 (ms) / GPU bubble ratio: 66.36%
[rank0]:2025-10-30 17:06:56,070 - INFO - Avg. fwd time: 4.5440 / Avg. bwd time: 5.3730 / Avg. batch time: 606.3771 (ms) / GPU bubble ratio: 73.83%
[rank0]:2025-10-30 17:07:54,584 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-30 17:07:55,596 - INFO -  step: 1550  loss: -2.0000  grad_norm:  0.2563  memory:  8.58GiB(18.06%)  tps: 6,501  tflops: 49.51  mfu: 15.87%
[rank0]:2025-10-30 17:07:55,589 - INFO -  step: 1550  loss: -2.0000  grad_norm:  0.2563  memory: 14.91GiB(31.39%)  tps: 6,501  tflops: 49.51  mfu: 15.87%
[rank1]:2025-10-30 17:07:55,590 - INFO -  step: 1550  loss: -2.0000  grad_norm:  0.2563  memory: 12.18GiB(25.63%)  tps: 6,501  tflops: 49.51  mfu: 15.87%
[rank3]:2025-10-30 17:07:58,171 - INFO -  step: 1550  loss:  3.5344  grad_norm:  0.0000  memory: 18.19GiB(38.28%)  tps: 6,496  tflops: 49.47  mfu: 15.86%
[rank0]:2025-10-30 17:08:57,202 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-30 17:08:59,081 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/pipeline_schedule_adjustment/251030_1708_rank0_trend_line.svg
[rank3]:2025-10-30 17:08:59,090 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/pipeline_schedule_adjustment/251030_1708_rank3_trend_line.svg
[rank2]:2025-10-30 17:08:59,127 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/pipeline_schedule_adjustment/251030_1708_rank2_trend_line.svg
[rank2]:2025-10-30 17:08:59,264 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00, [MB4] 0.72/0.72, [MB5] 0.31/0.31, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank2]:2025-10-30 17:08:59,269 - INFO -  step: 1600  loss: -2.0000  grad_norm:  0.1819  memory:  8.58GiB(18.06%)  tps: 6,433  tflops: 48.99  mfu: 15.70%
[rank2]:2025-10-30 17:08:59,269 - INFO - ðŸ”Ž  Running validation at step 1600
[rank0]:2025-10-30 17:08:59,264 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-30 17:08:59,269 - INFO -  step: 1600  loss: -2.0000  grad_norm:  0.1819  memory: 14.91GiB(31.39%)  tps: 6,432  tflops: 48.99  mfu: 15.70%
[rank0]:2025-10-30 17:08:59,269 - INFO - ðŸ”Ž  Running validation at step 1600
[rank1]:2025-10-30 17:08:59,250 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/pipeline_schedule_adjustment/251030_1708_rank1_trend_line.svg
[rank1]:2025-10-30 17:08:59,265 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00, [MB4] 0.78/0.78, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-30 17:08:59,270 - INFO -  step: 1600  loss: -2.0000  grad_norm:  0.1819  memory: 12.18GiB(25.63%)  tps: 6,432  tflops: 48.99  mfu: 15.70%
[rank1]:2025-10-30 17:08:59,270 - INFO - ðŸ”Ž  Running validation at step 1600
[rank3]:2025-10-30 17:08:59,576 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/pipeline_schedule/251030_1708_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 316.98 ms, GPU Bubble Ratio: 54.42%, 40.15%, 42.62%, 10.79%
[rank3]:2025-10-30 17:08:59,577 - INFO - 	> Batch Time: 316.98 ms (Average Freeze Ratio: 0.34)
[rank3]:2025-10-30 17:08:59,578 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 0.20/0.20, [MB4] 0.74/0.74, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank3]:2025-10-30 17:09:02,128 - INFO -  step: 1600  loss:  3.5649  grad_norm:  0.0000  memory: 18.19GiB(38.28%)  tps: 6,404  tflops: 48.78  mfu: 15.63%
[rank3]:2025-10-30 17:09:02,129 - INFO - ðŸ”Ž  Running validation at step 1600
[rank1]:2025-10-30 17:09:28,858 - INFO - validate step: 1600  loss: -1.0000  memory: 12.18GiB(25.63%)  tps: 13,843
[rank1]:2025-10-30 17:09:28,859 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-30 17:09:28,873 - INFO - validate step: 1600  loss:  1.9047  memory: 18.19GiB(38.28%)  tps: 15,316
[rank3]:2025-10-30 17:09:28,876 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-30 17:09:28,875 - INFO - validate step: 1600  loss: -1.0000  memory:  8.58GiB(18.06%)  tps: 13,835
[rank2]:2025-10-30 17:09:28,876 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-30 17:09:28,851 - INFO - validate step: 1600  loss: -1.0000  memory: 14.91GiB(31.39%)  tps: 13,846
[rank0]:2025-10-30 17:09:28,852 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-30 17:09:28,864 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank2]:2025-10-30 17:09:30,896 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 2.02 seconds.
[rank1]:2025-10-30 17:09:31,632 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 2.77 seconds.
[rank3]:2025-10-30 17:09:32,279 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.40 seconds.
[rank0]:2025-10-30 17:09:32,500 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-30 17:09:32,508 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.66 seconds.
[rank2]:2025-10-30 17:09:32,612 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251030_1709_stage2_step1600.svg
[rank0]:2025-10-30 17:09:32,617 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251030_1709_stage0_step1600.svg
[rank1]:2025-10-30 17:09:32,618 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251030_1709_stage1_step1600.svg
[rank2]:2025-10-30 17:09:32,685 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251030_1709_stage6_step1600.svg
[rank1]:2025-10-30 17:09:32,697 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251030_1709_stage5_step1600.svg
[rank0]:2025-10-30 17:09:32,907 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251030_1709_stage4_step1600.svg
[rank3]:2025-10-30 17:09:33,029 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/pipeline_schedule/251030_1709_real_step1600_rank3.svg
[rank3]:> Batch Time: 344.60 ms, GPU Bubble Ratio: 62.48%, 42.62%, 40.19%, 14.90%
[rank3]:2025-10-30 17:09:33,109 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251030_1709_stage3_step1600.svg
[rank3]:2025-10-30 17:09:33,182 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251030_1709_stage7_step1600.svg
[rank0]:2025-10-30 17:09:33,416 - INFO - Avg. fwd time: 4.5515 / Avg. bwd time: 5.2600 / Avg. batch time: 606.6502 (ms) / GPU bubble ratio: 74.12%
[rank3]:2025-10-30 17:09:33,445 - INFO - Avg. fwd time: 7.2880 / Avg. bwd time: 11.8829 / Avg. batch time: 434.1138 (ms) / GPU bubble ratio: 29.34%
[rank2]:2025-10-30 17:09:33,511 - INFO - Avg. fwd time: 4.2778 / Avg. bwd time: 7.8910 / Avg. batch time: 577.1301 (ms) / GPU bubble ratio: 66.26%
[rank1]:2025-10-30 17:09:33,502 - INFO - Avg. fwd time: 5.4875 / Avg. bwd time: 7.3416 / Avg. batch time: 594.7616 (ms) / GPU bubble ratio: 65.49%
[rank3]:2025-10-30 17:09:59,885 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-30 17:10:00,100 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-30 17:10:00,092 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-30 17:10:00,099 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-30 17:10:32,976 - INFO - [GC] Peforming periodical GC collection 0.34 seconds
[rank2]:2025-10-30 17:10:33,979 - INFO -  step: 1650  loss: -2.0000  grad_norm:  0.4610  memory:  8.58GiB(18.06%)  tps: 6,291  tflops: 47.92  mfu: 15.36%
[rank0]:2025-10-30 17:10:33,979 - INFO -  step: 1650  loss: -2.0000  grad_norm:  0.4610  memory: 14.91GiB(31.39%)  tps: 6,289  tflops: 47.90  mfu: 15.35%
[rank1]:2025-10-30 17:10:33,980 - INFO -  step: 1650  loss: -2.0000  grad_norm:  0.4610  memory: 12.18GiB(25.63%)  tps: 6,290  tflops: 47.90  mfu: 15.35%
[rank3]:2025-10-30 17:10:36,558 - INFO -  step: 1650  loss:  3.5589  grad_norm:  0.0000  memory: 18.19GiB(38.28%)  tps: 6,052  tflops: 46.09  mfu: 14.77%
[rank0]:2025-10-30 17:11:35,133 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-30 17:11:36,127 - INFO -  step: 1700  loss: -2.0000  grad_norm:  0.2343  memory: 12.18GiB(25.63%)  tps: 6,591  tflops: 50.20  mfu: 16.09%
[rank2]:2025-10-30 17:11:36,127 - INFO -  step: 1700  loss: -2.0000  grad_norm:  0.2343  memory:  8.58GiB(18.06%)  tps: 6,591  tflops: 50.20  mfu: 16.09%
[rank0]:2025-10-30 17:11:36,126 - INFO -  step: 1700  loss: -2.0000  grad_norm:  0.2343  memory: 14.91GiB(31.39%)  tps: 6,591  tflops: 50.20  mfu: 16.09%
[rank3]:2025-10-30 17:11:38,615 - INFO -  step: 1700  loss:  3.4839  grad_norm:  0.0000  memory: 18.19GiB(38.28%)  tps: 6,601  tflops: 50.27  mfu: 16.11%
[rank0]:2025-10-30 17:11:38,702 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251030_1711_stage0_step1700.svg
[rank1]:2025-10-30 17:11:38,704 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251030_1711_stage1_step1700.svg
[rank2]:2025-10-30 17:11:38,703 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251030_1711_stage2_step1700.svg
[rank2]:2025-10-30 17:11:38,774 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251030_1711_stage6_step1700.svg
[rank0]:2025-10-30 17:11:38,771 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251030_1711_stage4_step1700.svg
[rank1]:2025-10-30 17:11:38,776 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251030_1711_stage5_step1700.svg
[rank3]:2025-10-30 17:11:38,926 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/pipeline_schedule/251030_1711_real_step1700_rank3.svg
[rank3]:> Batch Time: 344.48 ms, GPU Bubble Ratio: 61.39%, 42.56%, 40.24%, 14.90%
[rank3]:2025-10-30 17:11:38,996 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251030_1711_stage3_step1700.svg
[rank3]:2025-10-30 17:11:39,062 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251030_1711_stage7_step1700.svg
[rank3]:2025-10-30 17:11:39,324 - INFO - Avg. fwd time: 7.2964 / Avg. bwd time: 11.8219 / Avg. batch time: 433.7911 (ms) / GPU bubble ratio: 29.48%
[rank2]:2025-10-30 17:11:39,364 - INFO - Avg. fwd time: 4.2866 / Avg. bwd time: 7.8134 / Avg. batch time: 576.6716 (ms) / GPU bubble ratio: 66.43%
[rank0]:2025-10-30 17:11:39,314 - INFO - Avg. fwd time: 4.5462 / Avg. bwd time: 5.2231 / Avg. batch time: 605.8717 (ms) / GPU bubble ratio: 74.20%
[rank1]:2025-10-30 17:11:39,401 - INFO - Avg. fwd time: 5.4859 / Avg. bwd time: 7.3890 / Avg. batch time: 594.2152 (ms) / GPU bubble ratio: 65.33%
[rank0]:2025-10-30 17:12:37,740 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-30 17:12:38,736 - INFO -  step: 1750  loss: -2.0000  grad_norm:  0.4265  memory: 12.18GiB(25.63%)  tps: 6,542  tflops: 49.83  mfu: 15.97%
[rank2]:2025-10-30 17:12:38,736 - INFO -  step: 1750  loss: -2.0000  grad_norm:  0.4265  memory:  8.58GiB(18.06%)  tps: 6,542  tflops: 49.83  mfu: 15.97%
[rank0]:2025-10-30 17:12:38,736 - INFO -  step: 1750  loss: -2.0000  grad_norm:  0.4265  memory: 14.91GiB(31.39%)  tps: 6,542  tflops: 49.83  mfu: 15.97%
[rank3]:2025-10-30 17:12:41,234 - INFO -  step: 1750  loss:  3.5155  grad_norm:  0.0000  memory: 18.19GiB(38.28%)  tps: 6,541  tflops: 49.82  mfu: 15.97%
[rank0]:2025-10-30 17:13:39,726 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-30 17:13:40,727 - INFO -  step: 1800  loss: -2.0000  grad_norm:  0.1602  memory:  8.58GiB(18.06%)  tps: 6,607  tflops: 50.32  mfu: 16.13%
[rank2]:2025-10-30 17:13:40,727 - INFO - ðŸ”Ž  Running validation at step 1800
[rank0]:2025-10-30 17:13:40,727 - INFO -  step: 1800  loss: -2.0000  grad_norm:  0.1602  memory: 14.91GiB(31.39%)  tps: 6,607  tflops: 50.32  mfu: 16.13%
[rank0]:2025-10-30 17:13:40,727 - INFO - ðŸ”Ž  Running validation at step 1800
[rank1]:2025-10-30 17:13:40,727 - INFO -  step: 1800  loss: -2.0000  grad_norm:  0.1602  memory: 12.18GiB(25.63%)  tps: 6,607  tflops: 50.32  mfu: 16.13%
[rank1]:2025-10-30 17:13:40,727 - INFO - ðŸ”Ž  Running validation at step 1800
[rank3]:2025-10-30 17:13:43,224 - INFO -  step: 1800  loss:  3.5900  grad_norm:  0.0000  memory: 18.19GiB(38.28%)  tps: 6,608  tflops: 50.33  mfu: 16.13%
[rank3]:2025-10-30 17:13:43,225 - INFO - ðŸ”Ž  Running validation at step 1800
[rank1]:2025-10-30 17:14:09,909 - INFO - validate step: 1800  loss: -1.0000  memory: 12.18GiB(25.63%)  tps: 14,036
[rank3]:2025-10-30 17:14:09,927 - INFO - validate step: 1800  loss:  1.9093  memory: 18.19GiB(38.28%)  tps: 15,340
[rank2]:2025-10-30 17:14:09,928 - INFO - validate step: 1800  loss: -1.0000  memory:  8.58GiB(18.06%)  tps: 14,027
[rank0]:2025-10-30 17:14:09,900 - INFO - validate step: 1800  loss: -1.0000  memory: 14.91GiB(31.39%)  tps: 14,040
[rank1]:2025-10-30 17:14:10,021 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251030_1714_stage1_step1800.svg
[rank2]:2025-10-30 17:14:10,020 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251030_1714_stage2_step1800.svg
[rank0]:2025-10-30 17:14:10,016 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251030_1714_stage0_step1800.svg
[rank0]:2025-10-30 17:14:10,083 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251030_1714_stage4_step1800.svg
[rank1]:2025-10-30 17:14:10,099 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251030_1714_stage5_step1800.svg
[rank2]:2025-10-30 17:14:10,096 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251030_1714_stage6_step1800.svg
[rank3]:2025-10-30 17:14:10,240 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/pipeline_schedule/251030_1714_real_step1800_rank3.svg
[rank3]:> Batch Time: 344.44 ms, GPU Bubble Ratio: 60.74%, 42.52%, 40.31%, 14.89%
[rank3]:2025-10-30 17:14:10,311 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251030_1714_stage3_step1800.svg
[rank3]:2025-10-30 17:14:10,378 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251030_1714_stage7_step1800.svg
[rank3]:2025-10-30 17:14:10,837 - INFO - Avg. fwd time: 7.3039 / Avg. bwd time: 11.7682 / Avg. batch time: 433.5126 (ms) / GPU bubble ratio: 29.61%
[rank2]:2025-10-30 17:14:10,859 - INFO - Avg. fwd time: 4.2955 / Avg. bwd time: 7.7315 / Avg. batch time: 576.0845 (ms) / GPU bubble ratio: 66.60%
[rank0]:2025-10-30 17:14:10,892 - INFO - Avg. fwd time: 4.5405 / Avg. bwd time: 5.1982 / Avg. batch time: 605.0021 (ms) / GPU bubble ratio: 74.24%
[rank1]:2025-10-30 17:14:10,879 - INFO - Avg. fwd time: 5.4838 / Avg. bwd time: 7.4383 / Avg. batch time: 593.5505 (ms) / GPU bubble ratio: 65.17%
[rank0]:2025-10-30 17:15:09,371 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-30 17:15:10,372 - INFO -  step: 1850  loss: -2.0000  grad_norm:  0.2114  memory: 14.91GiB(31.39%)  tps: 6,773  tflops: 51.59  mfu: 16.53%
[rank1]:2025-10-30 17:15:10,373 - INFO -  step: 1850  loss: -2.0000  grad_norm:  0.2114  memory: 12.18GiB(25.63%)  tps: 6,774  tflops: 51.59  mfu: 16.54%
[rank2]:2025-10-30 17:15:10,373 - INFO -  step: 1850  loss: -2.0000  grad_norm:  0.2114  memory:  8.58GiB(18.06%)  tps: 6,776  tflops: 51.61  mfu: 16.54%
[rank3]:2025-10-30 17:15:12,908 - INFO -  step: 1850  loss:  3.4899  grad_norm:  0.0000  memory: 18.19GiB(38.28%)  tps: 6,504  tflops: 49.53  mfu: 15.88%
[rank0]:2025-10-30 17:16:11,814 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-30 17:16:12,804 - INFO -  step: 1900  loss: -2.0000  grad_norm:  0.2086  memory: 12.18GiB(25.63%)  tps: 6,561  tflops: 49.97  mfu: 16.02%
[rank2]:2025-10-30 17:16:12,804 - INFO -  step: 1900  loss: -2.0000  grad_norm:  0.2086  memory:  8.58GiB(18.06%)  tps: 6,561  tflops: 49.97  mfu: 16.02%
[rank0]:2025-10-30 17:16:12,804 - INFO -  step: 1900  loss: -2.0000  grad_norm:  0.2086  memory: 14.91GiB(31.39%)  tps: 6,561  tflops: 49.97  mfu: 16.02%
[rank3]:2025-10-30 17:16:15,486 - INFO -  step: 1900  loss:  3.5214  grad_norm:  0.0000  memory: 18.19GiB(38.28%)  tps: 6,546  tflops: 49.85  mfu: 15.98%
[rank1]:2025-10-30 17:16:15,577 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251030_1716_stage1_step1900.svg
[rank2]:2025-10-30 17:16:15,576 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251030_1716_stage2_step1900.svg
[rank0]:2025-10-30 17:16:15,576 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251030_1716_stage0_step1900.svg
[rank0]:2025-10-30 17:16:15,646 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251030_1716_stage4_step1900.svg
[rank1]:2025-10-30 17:16:15,649 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251030_1716_stage5_step1900.svg
[rank2]:2025-10-30 17:16:15,649 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251030_1716_stage6_step1900.svg
[rank3]:2025-10-30 17:16:15,805 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/pipeline_schedule/251030_1716_real_step1900_rank3.svg
[rank3]:> Batch Time: 344.31 ms, GPU Bubble Ratio: 60.66%, 42.48%, 40.62%, 14.87%
[rank3]:2025-10-30 17:16:15,878 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251030_1716_stage3_step1900.svg
[rank3]:2025-10-30 17:16:15,946 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251030_1716_stage7_step1900.svg
[rank3]:2025-10-30 17:16:16,206 - INFO - Avg. fwd time: 7.3103 / Avg. bwd time: 11.7297 / Avg. batch time: 433.3489 (ms) / GPU bubble ratio: 29.70%
[rank2]:2025-10-30 17:16:16,247 - INFO - Avg. fwd time: 4.3024 / Avg. bwd time: 7.6688 / Avg. batch time: 576.5542 (ms) / GPU bubble ratio: 66.78%
[rank0]:2025-10-30 17:16:16,197 - INFO - Avg. fwd time: 4.5360 / Avg. bwd time: 5.1792 / Avg. batch time: 605.2491 (ms) / GPU bubble ratio: 74.32%
[rank1]:2025-10-30 17:16:16,281 - INFO - Avg. fwd time: 5.4824 / Avg. bwd time: 7.4765 / Avg. batch time: 593.9593 (ms) / GPU bubble ratio: 65.09%
[rank0]:2025-10-30 17:17:14,557 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-30 17:17:15,552 - INFO -  step: 1950  loss: -2.0000  grad_norm:  0.1653  memory: 12.18GiB(25.63%)  tps: 6,528  tflops: 49.72  mfu: 15.93%
[rank2]:2025-10-30 17:17:15,552 - INFO -  step: 1950  loss: -2.0000  grad_norm:  0.1653  memory:  8.58GiB(18.06%)  tps: 6,528  tflops: 49.72  mfu: 15.93%
[rank0]:2025-10-30 17:17:15,551 - INFO -  step: 1950  loss: -2.0000  grad_norm:  0.1653  memory: 14.91GiB(31.39%)  tps: 6,528  tflops: 49.72  mfu: 15.93%
[rank3]:2025-10-30 17:17:18,115 - INFO -  step: 1950  loss:  3.5464  grad_norm:  0.0000  memory: 18.19GiB(38.28%)  tps: 6,540  tflops: 49.81  mfu: 15.97%
[rank0]:2025-10-30 17:18:16,658 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-30 17:18:17,665 - INFO -  step: 2000  loss: -2.0000  grad_norm:  0.1739  memory: 12.18GiB(25.63%)  tps: 6,595  tflops: 50.23  mfu: 16.10%
[rank1]:2025-10-30 17:18:17,665 - INFO - ðŸ”Ž  Running validation at step 2000
[rank2]:2025-10-30 17:18:17,665 - INFO -  step: 2000  loss: -2.0000  grad_norm:  0.1739  memory:  8.58GiB(18.06%)  tps: 6,594  tflops: 50.23  mfu: 16.10%
[rank2]:2025-10-30 17:18:17,665 - INFO - ðŸ”Ž  Running validation at step 2000
[rank0]:2025-10-30 17:18:17,664 - INFO -  step: 2000  loss: -2.0000  grad_norm:  0.1739  memory: 14.91GiB(31.39%)  tps: 6,595  tflops: 50.23  mfu: 16.10%
[rank0]:2025-10-30 17:18:17,664 - INFO - ðŸ”Ž  Running validation at step 2000
[rank3]:2025-10-30 17:18:20,164 - INFO -  step: 2000  loss:  3.5194  grad_norm:  0.0000  memory: 18.19GiB(38.28%)  tps: 6,601  tflops: 50.28  mfu: 16.11%
[rank3]:2025-10-30 17:18:20,165 - INFO - ðŸ”Ž  Running validation at step 2000
[rank1]:2025-10-30 17:18:46,986 - INFO - validate step: 2000  loss: -1.0000  memory: 12.18GiB(25.63%)  tps: 13,969
[rank3]:2025-10-30 17:18:47,006 - INFO - validate step: 2000  loss:  1.9166  memory: 18.19GiB(38.28%)  tps: 15,261
[rank2]:2025-10-30 17:18:47,007 - INFO - validate step: 2000  loss: -1.0000  memory:  8.58GiB(18.06%)  tps: 13,959
[rank0]:2025-10-30 17:18:46,980 - INFO - validate step: 2000  loss: -1.0000  memory: 14.91GiB(31.39%)  tps: 13,972
[rank1]:2025-10-30 17:18:47,111 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251030_1718_stage1_step2000.svg
[rank2]:2025-10-30 17:18:47,116 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251030_1718_stage2_step2000.svg
[rank0]:2025-10-30 17:18:47,110 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251030_1718_stage0_step2000.svg
[rank1]:2025-10-30 17:18:47,187 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251030_1718_stage5_step2000.svg
[rank2]:2025-10-30 17:18:47,196 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251030_1718_stage6_step2000.svg
[rank0]:2025-10-30 17:18:47,182 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251030_1718_stage4_step2000.svg
[rank3]:2025-10-30 17:18:47,333 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/pipeline_schedule/251030_1718_real_step2000_rank3.svg
[rank3]:> Batch Time: 338.50 ms, GPU Bubble Ratio: 59.87%, 41.46%, 45.21%, 13.42%
[rank3]:2025-10-30 17:18:47,405 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251030_1718_stage3_step2000.svg
[rank3]:2025-10-30 17:18:47,473 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251030_1718_stage7_step2000.svg
[rank3]:2025-10-30 17:18:47,737 - INFO - Avg. fwd time: 7.3160 / Avg. bwd time: 11.6855 / Avg. batch time: 433.1096 (ms) / GPU bubble ratio: 29.80%
[rank0]:2025-10-30 17:18:47,728 - INFO - Avg. fwd time: 4.5313 / Avg. bwd time: 5.1589 / Avg. batch time: 604.4327 (ms) / GPU bubble ratio: 74.35%
[rank1]:2025-10-30 17:18:47,813 - INFO - Avg. fwd time: 5.4807 / Avg. bwd time: 7.5164 / Avg. batch time: 593.3139 (ms) / GPU bubble ratio: 64.95%
[rank2]:2025-10-30 17:18:47,776 - INFO - Avg. fwd time: 4.3093 / Avg. bwd time: 7.6023 / Avg. batch time: 575.9734 (ms) / GPU bubble ratio: 66.91%
[rank0]:2025-10-30 17:19:46,292 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-30 17:19:47,282 - INFO -  step: 2050  loss: -2.0000  grad_norm:  0.1942  memory: 12.18GiB(25.63%)  tps: 6,793  tflops: 51.74  mfu: 16.58%
[rank2]:2025-10-30 17:19:47,282 - INFO -  step: 2050  loss: -2.0000  grad_norm:  0.1942  memory:  8.58GiB(18.06%)  tps: 6,796  tflops: 51.76  mfu: 16.59%
[rank0]:2025-10-30 17:19:47,281 - INFO -  step: 2050  loss: -2.0000  grad_norm:  0.1942  memory: 14.91GiB(31.39%)  tps: 6,793  tflops: 51.73  mfu: 16.58%
[rank3]:2025-10-30 17:19:49,777 - INFO -  step: 2050  loss:  3.6470  grad_norm:  0.0000  memory: 18.19GiB(38.28%)  tps: 6,526  tflops: 49.70  mfu: 15.93%
[rank0]:2025-10-30 17:20:48,318 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-30 17:20:49,310 - INFO -  step: 2100  loss: -2.0000  grad_norm:  0.4316  memory: 14.91GiB(31.39%)  tps: 6,603  tflops: 50.29  mfu: 16.12%
[rank1]:2025-10-30 17:20:49,310 - INFO -  step: 2100  loss: -2.0000  grad_norm:  0.4316  memory: 12.18GiB(25.63%)  tps: 6,603  tflops: 50.29  mfu: 16.12%
[rank2]:2025-10-30 17:20:49,311 - INFO -  step: 2100  loss: -2.0000  grad_norm:  0.4316  memory:  8.58GiB(18.06%)  tps: 6,603  tflops: 50.29  mfu: 16.12%
[rank3]:2025-10-30 17:20:51,790 - INFO -  step: 2100  loss:  3.5017  grad_norm:  0.0000  memory: 18.19GiB(38.28%)  tps: 6,605  tflops: 50.31  mfu: 16.12%
[rank2]:2025-10-30 17:20:51,882 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251030_1720_stage2_step2100.svg
[rank0]:2025-10-30 17:20:51,876 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251030_1720_stage0_step2100.svg
[rank1]:2025-10-30 17:20:51,878 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251030_1720_stage1_step2100.svg
[rank1]:2025-10-30 17:20:51,943 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251030_1720_stage5_step2100.svg
[rank2]:2025-10-30 17:20:51,951 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251030_1720_stage6_step2100.svg
[rank0]:2025-10-30 17:20:51,939 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251030_1720_stage4_step2100.svg
[rank3]:2025-10-30 17:20:52,103 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/pipeline_schedule/251030_1720_real_step2100_rank3.svg
[rank3]:> Batch Time: 338.24 ms, GPU Bubble Ratio: 59.78%, 41.38%, 47.48%, 13.35%
[rank3]:2025-10-30 17:20:52,167 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251030_1720_stage3_step2100.svg
[rank3]:2025-10-30 17:20:52,226 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251030_1720_stage7_step2100.svg
[rank3]:2025-10-30 17:20:52,677 - INFO - Avg. fwd time: 7.3214 / Avg. bwd time: 11.6464 / Avg. batch time: 432.9015 (ms) / GPU bubble ratio: 29.90%
[rank2]:2025-10-30 17:20:52,701 - INFO - Avg. fwd time: 4.3157 / Avg. bwd time: 7.5426 / Avg. batch time: 575.5388 (ms) / GPU bubble ratio: 67.03%
[rank1]:2025-10-30 17:20:52,722 - INFO - Avg. fwd time: 5.4792 / Avg. bwd time: 7.5524 / Avg. batch time: 592.8239 (ms) / GPU bubble ratio: 64.83%
[rank0]:2025-10-30 17:20:52,737 - INFO - Avg. fwd time: 4.5270 / Avg. bwd time: 5.1408 / Avg. batch time: 603.7922 (ms) / GPU bubble ratio: 74.38%
[rank0]:2025-10-30 17:21:50,662 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-30 17:21:51,659 - INFO -  step: 2150  loss: -2.0000  grad_norm:  0.1852  memory:  8.58GiB(18.06%)  tps: 6,570  tflops: 50.04  mfu: 16.04%
[rank0]:2025-10-30 17:21:51,659 - INFO -  step: 2150  loss: -2.0000  grad_norm:  0.1852  memory: 14.91GiB(31.39%)  tps: 6,570  tflops: 50.03  mfu: 16.04%
[rank1]:2025-10-30 17:21:51,660 - INFO -  step: 2150  loss: -2.0000  grad_norm:  0.1852  memory: 12.18GiB(25.63%)  tps: 6,569  tflops: 50.03  mfu: 16.04%
[rank3]:2025-10-30 17:21:54,200 - INFO -  step: 2150  loss:  3.5076  grad_norm:  0.0000  memory: 18.19GiB(38.28%)  tps: 6,563  tflops: 49.99  mfu: 16.02%
[rank0]:2025-10-30 17:22:52,660 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-30 17:22:53,664 - INFO -  step: 2200  loss: -2.0000  grad_norm:  0.1747  memory:  8.58GiB(18.06%)  tps: 6,606  tflops: 50.31  mfu: 16.13%
[rank2]:2025-10-30 17:22:53,664 - INFO - ðŸ”Ž  Running validation at step 2200
[rank0]:2025-10-30 17:22:53,664 - INFO -  step: 2200  loss: -2.0000  grad_norm:  0.1747  memory: 14.91GiB(31.39%)  tps: 6,606  tflops: 50.31  mfu: 16.13%
[rank0]:2025-10-30 17:22:53,664 - INFO - ðŸ”Ž  Running validation at step 2200
[rank1]:2025-10-30 17:22:53,664 - INFO -  step: 2200  loss: -2.0000  grad_norm:  0.1747  memory: 12.18GiB(25.63%)  tps: 6,606  tflops: 50.31  mfu: 16.13%
[rank1]:2025-10-30 17:22:53,664 - INFO - ðŸ”Ž  Running validation at step 2200
[rank3]:2025-10-30 17:22:56,158 - INFO -  step: 2200  loss:  3.5393  grad_norm:  0.0000  memory: 18.19GiB(38.28%)  tps: 6,611  tflops: 50.35  mfu: 16.14%
[rank3]:2025-10-30 17:22:56,159 - INFO - ðŸ”Ž  Running validation at step 2200
[rank1]:2025-10-30 17:23:22,754 - INFO - validate step: 2200  loss: -1.0000  memory: 12.18GiB(25.63%)  tps: 14,081
[rank3]:2025-10-30 17:23:22,771 - INFO - validate step: 2200  loss:  1.9170  memory: 18.19GiB(38.28%)  tps: 15,392
[rank2]:2025-10-30 17:23:22,772 - INFO - validate step: 2200  loss: -1.0000  memory:  8.58GiB(18.06%)  tps: 14,072
[rank0]:2025-10-30 17:23:22,745 - INFO - validate step: 2200  loss: -1.0000  memory: 14.91GiB(31.39%)  tps: 14,085
[rank1]:2025-10-30 17:23:22,862 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251030_1723_stage1_step2200.svg
[rank2]:2025-10-30 17:23:22,860 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251030_1723_stage2_step2200.svg
[rank0]:2025-10-30 17:23:22,855 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251030_1723_stage0_step2200.svg
[rank0]:2025-10-30 17:23:22,917 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251030_1723_stage4_step2200.svg
[rank1]:2025-10-30 17:23:22,932 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251030_1723_stage5_step2200.svg
[rank2]:2025-10-30 17:23:22,927 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251030_1723_stage6_step2200.svg
[rank3]:2025-10-30 17:23:23,085 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/pipeline_schedule/251030_1723_real_step2200_rank3.svg
[rank3]:> Batch Time: 338.29 ms, GPU Bubble Ratio: 59.36%, 41.35%, 48.40%, 13.37%
[rank3]:2025-10-30 17:23:23,150 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251030_1723_stage3_step2200.svg
[rank3]:2025-10-30 17:23:23,210 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251030_1723_stage7_step2200.svg
[rank3]:2025-10-30 17:23:23,476 - INFO - Avg. fwd time: 7.3254 / Avg. bwd time: 11.6159 / Avg. batch time: 432.7407 (ms) / GPU bubble ratio: 29.97%
[rank0]:2025-10-30 17:23:23,467 - INFO - Avg. fwd time: 4.5237 / Avg. bwd time: 5.1267 / Avg. batch time: 603.8264 (ms) / GPU bubble ratio: 74.43%
[rank1]:2025-10-30 17:23:23,554 - INFO - Avg. fwd time: 5.4779 / Avg. bwd time: 7.5805 / Avg. batch time: 592.9764 (ms) / GPU bubble ratio: 64.76%
[rank2]:2025-10-30 17:23:23,516 - INFO - Avg. fwd time: 4.3208 / Avg. bwd time: 7.4962 / Avg. batch time: 575.7361 (ms) / GPU bubble ratio: 67.16%
[rank0]:2025-10-30 17:24:21,978 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-30 17:24:22,968 - INFO -  step: 2250  loss: -2.0000  grad_norm:  0.5815  memory:  8.58GiB(18.06%)  tps: 6,804  tflops: 51.82  mfu: 16.61%
[rank0]:2025-10-30 17:24:22,968 - INFO -  step: 2250  loss: -2.0000  grad_norm:  0.5815  memory: 14.91GiB(31.39%)  tps: 6,801  tflops: 51.80  mfu: 16.60%
[rank1]:2025-10-30 17:24:22,969 - INFO -  step: 2250  loss: -2.0000  grad_norm:  0.5815  memory: 12.18GiB(25.63%)  tps: 6,802  tflops: 51.81  mfu: 16.61%
[rank3]:2025-10-30 17:24:25,500 - INFO -  step: 2250  loss:  3.6442  grad_norm:  0.0000  memory: 18.19GiB(38.28%)  tps: 6,530  tflops: 49.73  mfu: 15.94%
[rank0]:2025-10-30 17:25:24,265 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-30 17:25:25,254 - INFO -  step: 2300  loss: -2.0000  grad_norm:  0.2002  memory:  8.58GiB(18.06%)  tps: 6,576  tflops: 50.09  mfu: 16.05%
[rank0]:2025-10-30 17:25:25,254 - INFO -  step: 2300  loss: -2.0000  grad_norm:  0.2002  memory: 14.91GiB(31.39%)  tps: 6,576  tflops: 50.09  mfu: 16.05%
[rank1]:2025-10-30 17:25:25,254 - INFO -  step: 2300  loss: -2.0000  grad_norm:  0.2002  memory: 12.18GiB(25.63%)  tps: 6,576  tflops: 50.09  mfu: 16.05%
[rank3]:2025-10-30 17:25:27,778 - INFO -  step: 2300  loss:  3.5707  grad_norm:  0.0000  memory: 18.19GiB(38.28%)  tps: 6,577  tflops: 50.09  mfu: 16.06%
[rank2]:2025-10-30 17:25:27,866 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251030_1725_stage2_step2300.svg
[rank0]:2025-10-30 17:25:27,865 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251030_1725_stage0_step2300.svg
[rank1]:2025-10-30 17:25:27,868 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251030_1725_stage1_step2300.svg
[rank1]:2025-10-30 17:25:27,934 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251030_1725_stage5_step2300.svg
[rank2]:2025-10-30 17:25:27,931 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251030_1725_stage6_step2300.svg
[rank0]:2025-10-30 17:25:27,927 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251030_1725_stage4_step2300.svg
[rank3]:2025-10-30 17:25:28,095 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/pipeline_schedule/251030_1725_real_step2300_rank3.svg
[rank3]:> Batch Time: 338.35 ms, GPU Bubble Ratio: 59.07%, 41.28%, 48.48%, 13.40%
[rank3]:2025-10-30 17:25:28,160 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251030_1725_stage3_step2300.svg
[rank3]:2025-10-30 17:25:28,221 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251030_1725_stage7_step2300.svg
[rank0]:2025-10-30 17:25:28,478 - INFO - Avg. fwd time: 4.5201 / Avg. bwd time: 5.1116 / Avg. batch time: 603.2478 (ms) / GPU bubble ratio: 74.45%
[rank3]:2025-10-30 17:25:28,490 - INFO - Avg. fwd time: 7.3297 / Avg. bwd time: 11.5829 / Avg. batch time: 432.5620 (ms) / GPU bubble ratio: 30.04%
[rank2]:2025-10-30 17:25:28,527 - INFO - Avg. fwd time: 4.3261 / Avg. bwd time: 7.4465 / Avg. batch time: 575.3317 (ms) / GPU bubble ratio: 67.26%
[rank1]:2025-10-30 17:25:28,564 - INFO - Avg. fwd time: 5.4765 / Avg. bwd time: 7.6106 / Avg. batch time: 592.5235 (ms) / GPU bubble ratio: 64.66%
[rank0]:2025-10-30 17:26:26,736 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-30 17:26:27,732 - INFO -  step: 2350  loss: -2.0000  grad_norm:  0.1667  memory:  8.58GiB(18.06%)  tps: 6,556  tflops: 49.93  mfu: 16.00%
[rank0]:2025-10-30 17:26:27,731 - INFO -  step: 2350  loss: -2.0000  grad_norm:  0.1667  memory: 14.91GiB(31.39%)  tps: 6,556  tflops: 49.93  mfu: 16.00%
[rank1]:2025-10-30 17:26:27,732 - INFO -  step: 2350  loss: -2.0000  grad_norm:  0.1667  memory: 12.18GiB(25.63%)  tps: 6,556  tflops: 49.93  mfu: 16.00%
[rank3]:2025-10-30 17:26:30,319 - INFO -  step: 2350  loss:  3.5245  grad_norm:  0.0000  memory: 18.19GiB(38.28%)  tps: 6,550  tflops: 49.88  mfu: 15.99%
[rank0]:2025-10-30 17:27:28,895 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-30 17:27:29,895 - INFO -  step: 2400  loss: -2.0000  grad_norm:  0.1842  memory: 14.91GiB(31.39%)  tps: 6,589  tflops: 50.18  mfu: 16.08%
[rank0]:2025-10-30 17:27:29,896 - INFO -  final step: 2400  loss: -2.0000  grad_norm:  0.1842  tps: 6,629  tflops: 50.49  mfu: 15.63%
[rank0]:2025-10-30 17:27:29,896 - INFO - ðŸ”Ž  Running validation at step 2400
[rank2]:2025-10-30 17:27:29,896 - INFO -  step: 2400  loss: -2.0000  grad_norm:  0.1842  memory:  8.58GiB(18.06%)  tps: 6,589  tflops: 50.18  mfu: 16.08%
[rank2]:2025-10-30 17:27:29,896 - INFO -  final step: 2400  loss: -2.0000  grad_norm:  0.1842  tps: 6,630  tflops: 50.50  mfu: 15.63%
[rank2]:2025-10-30 17:27:29,896 - INFO - ðŸ”Ž  Running validation at step 2400
[rank1]:2025-10-30 17:27:29,896 - INFO -  step: 2400  loss: -2.0000  grad_norm:  0.1842  memory: 12.18GiB(25.63%)  tps: 6,589  tflops: 50.18  mfu: 16.08%
[rank1]:2025-10-30 17:27:29,896 - INFO -  final step: 2400  loss: -2.0000  grad_norm:  0.1842  tps: 6,629  tflops: 50.49  mfu: 15.63%
[rank1]:2025-10-30 17:27:29,896 - INFO - ðŸ”Ž  Running validation at step 2400
[rank3]:2025-10-30 17:27:32,426 - INFO -  step: 2400  loss:  3.5661  grad_norm:  0.0000  memory: 18.19GiB(38.28%)  tps: 6,595  tflops: 50.23  mfu: 16.10%
[rank3]:2025-10-30 17:27:32,426 - INFO -  final step: 2400  loss:  3.5661  grad_norm:  0.0000  tps: 6,567  tflops: 50.01  mfu: 15.48%
[rank3]:2025-10-30 17:27:32,427 - INFO - ðŸ”Ž  Running validation at step 2400
[rank1]:2025-10-30 17:27:59,280 - INFO - validate step: 2400  loss: -1.0000  memory: 12.18GiB(25.63%)  tps: 13,940
[rank1]:2025-10-30 17:27:59,280 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-30 17:27:59,282 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank3]:2025-10-30 17:27:59,298 - INFO - validate step: 2400  loss:  1.9166  memory: 18.19GiB(38.28%)  tps: 15,244
[rank3]:2025-10-30 17:27:59,299 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-30 17:27:59,301 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank0]:2025-10-30 17:27:59,272 - INFO - validate step: 2400  loss: -1.0000  memory: 14.91GiB(31.39%)  tps: 13,944
[rank0]:2025-10-30 17:27:59,272 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-30 17:27:59,275 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank2]:2025-10-30 17:27:59,301 - INFO - validate step: 2400  loss: -1.0000  memory:  8.58GiB(18.06%)  tps: 13,930
[rank2]:2025-10-30 17:27:59,301 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-30 17:27:59,303 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank0]:2025-10-30 17:28:01,974 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank0]:2025-10-30 17:28:02,067 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251030_1728_stage0_final2400.svg
[rank2]:2025-10-30 17:28:02,072 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251030_1728_stage2_final2400.svg
[rank1]:2025-10-30 17:28:02,069 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251030_1728_stage1_final2400.svg
[rank0]:2025-10-30 17:28:02,217 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/frozen_params_histogram/251030_1728_rank0_stage0.svg
[rank0]:	> Counts Sum: 606980, Total Sum: 705280 (86.06%), Ratio(%) per element: [85.93, 85.93, 85.99, 85.88, 86.09, 86.09, 85.99, 86.04, 86.09, 86.09, 86.2, 86.04, 85.99, 86.2, 85.93, 86.15, 86.26, 86.36, 85.82]
[rank2]:2025-10-30 17:28:02,229 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/frozen_params_histogram/251030_1728_rank2_stage2.svg
[rank2]:	> Counts Sum: 532800, Total Sum: 668160 (79.74%), Ratio(%) per element: [79.04, 80.28, 80.28, 79.2, 79.47, 79.68, 79.36, 79.84, 79.63, 79.57, 80.71, 79.95, 79.25, 79.79, 79.74, 79.2, 79.95, 80.33]
[rank1]:2025-10-30 17:28:02,255 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/frozen_params_histogram/251030_1728_rank1_stage1.svg
[rank1]:	> Counts Sum: 538640, Total Sum: 1002240 (53.74%), Ratio(%) per element: [53.55, 53.5, 53.71, 53.82, 54.31, 53.82, 53.07, 53.5, 53.71, 53.44, 53.82, 53.93, 53.98, 53.55, 53.98, 53.93, 53.66, 54.36, 53.87, 53.6, 53.5, 53.82, 53.82, 53.71, 53.6, 53.77, 53.6]
[rank1]:2025-10-30 17:28:02,324 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251030_1728_stage5_final2400.svg
[rank3]:2025-10-30 17:28:02,300 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/pipeline_schedule/251030_1728_real_final2400_rank3.svg
[rank3]:> Batch Time: 339.08 ms, GPU Bubble Ratio: 58.42%, 39.14%, 48.62%, 13.58%
[rank0]:2025-10-30 17:28:02,283 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251030_1728_stage4_final2400.svg
[rank2]:2025-10-30 17:28:02,302 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251030_1728_stage6_final2400.svg
[rank0]:2025-10-30 17:28:02,425 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/frozen_params_histogram/251030_1728_rank0_stage4.svg
[rank0]:	> Counts Sum: 623020, Total Sum: 668160 (93.24%), Ratio(%) per element: [93.26, 93.26, 93.37, 93.48, 92.99, 92.83, 93.21, 93.26, 93.26, 93.21, 93.31, 93.31, 93.26, 93.42, 93.31, 93.1, 93.37, 93.1]
[rank0]:2025-10-30 17:28:02,425 - INFO - Sleeping 2 seconds for other ranks to complete
[rank2]:2025-10-30 17:28:02,455 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/frozen_params_histogram/251030_1728_rank2_stage6.svg
[rank2]:	> Counts Sum: 579320, Total Sum: 668160 (86.70%), Ratio(%) per element: [86.63, 86.69, 86.63, 86.79, 86.58, 86.69, 86.74, 86.74, 86.69, 86.69, 86.79, 86.69, 86.69, 86.69, 86.69, 86.69, 86.69, 86.79]
[rank2]:2025-10-30 17:28:02,455 - INFO - Destroying the purge thread.
[rank1]:2025-10-30 17:28:02,469 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/frozen_params_histogram/251030_1728_rank1_stage5.svg
[rank1]:	> Counts Sum: 617540, Total Sum: 668160 (92.42%), Ratio(%) per element: [92.4, 92.56, 92.29, 92.45, 92.51, 92.4, 92.4, 92.4, 92.4, 92.4, 92.51, 92.56, 92.45, 92.34, 92.4, 92.34, 92.34, 92.4]
[rank1]:2025-10-30 17:28:02,470 - INFO - Destroying the purge thread.
[rank3]:2025-10-30 17:28:02,600 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/pipeline_schedule/251030_1728_thry_final2400_rank3.svg
[rank3]:> Batch Time: 310.97 ms, GPU Bubble Ratio: 15.79%, 15.79%, 15.79%, 15.79%
[rank3]:2025-10-30 17:28:02,665 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251030_1728_stage3_final2400.svg
[rank3]:2025-10-30 17:28:02,805 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/frozen_params_histogram/251030_1728_rank3_stage3.svg
[rank3]:	> Counts Sum: 209400, Total Sum: 668160 (31.34%), Ratio(%) per element: [30.81, 30.98, 31.3, 31.78, 31.08, 31.25, 31.51, 31.46, 31.08, 31.46, 31.73, 32.7, 30.98, 30.98, 30.98, 31.57, 30.98, 31.41]
[rank2]:2025-10-30 17:28:02,819 - INFO - Process group destroyed
[rank1]:2025-10-30 17:28:02,844 - INFO - Process group destroyed
[rank3]:2025-10-30 17:28:02,867 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251030_1728_stage7_final2400.svg
[rank3]:2025-10-30 17:28:02,981 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1/frozen_params_histogram/251030_1728_rank3_stage7.svg
[rank3]:	> Counts Sum: 45420, Total Sum: 408320 (11.12%), Ratio(%) per element: [11.85, 12.71, 12.66, 12.55, 11.69, 12.06, 12.17, 12.6, 11.85, 12.06, 0.1]
[rank3]:2025-10-30 17:28:02,982 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading history steps 48-48, summary, console lines 459-472
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–„â–â–ƒâ–â–â–â–â–â–â–â–ƒâ–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–‡â–‡â–ƒâ–â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–‡â–ƒâ–â–‚â–‚â–â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 1.24754
[rank3]:wandb:               final/avg_loss 3.56609
[rank3]:wandb:             final/avg_mfu(%) 15.48122
[rank3]:wandb:             final/avg_tflops 50.01187
[rank3]:wandb:    final/avg_throughput(tps) 6566.50056
[rank3]:wandb:              final/grad_norm 0
[rank3]:wandb:               final/max_loss 3.56609
[rank3]:wandb:                    grad_norm 0
[rank3]:wandb: loss_metrics/global_avg_loss 3.56609
[rank3]:wandb: loss_metrics/global_max_loss 3.56609
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1029_Interleaved1F1B_timelyapf_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/rha2dr1b
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1029_Interleaved1F1B_timelyapf_dm1/20251030-1631/wandb/run-20251030_163137-rha2dr1b/logs
[rank3]:2025-10-30 17:28:04,354 - INFO - Process group destroyed
[rank0]:2025-10-30 17:28:04,426 - INFO - Training completed
[rank0]:2025-10-30 17:28:04,426 - INFO - Destroying the purge thread.
[rank0]:2025-10-30 17:28:04,518 - INFO - Process group destroyed
[rank1]:Stage 1: Modules to keep: {'layers.2', 'layers.4', 'layers.3'}
[rank1]:Stage 5: Modules to keep: {'layers.11', 'layers.12'}
[rank0]:Stage 0: Modules to keep: {'layers.1', 'tok_embeddings', 'layers.0'}
[rank0]:Stage 4: Modules to keep: {'layers.9', 'layers.10'}
[rank2]:Stage 2: Modules to keep: {'layers.6', 'layers.5'}
[rank2]:Stage 6: Modules to keep: {'layers.14', 'layers.13'}
[rank3]:Stage 3: Modules to keep: {'layers.8', 'layers.7'}
[rank3]:Stage 7: Modules to keep: {'layers.15', 'norm', 'output'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1029_llama1b/config.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1029_Interleaved1F1B_timelyapf_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1029_Interleaved1F1B_timelyapf_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1029_Interleaved1F1B_timelyapf_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1029_Interleaved1F1B_timelyapf_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyapf_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1029_Interleaved1F1B_timelyapf_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B-Instruct
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 1e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: alpaca
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 512
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 2400
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: Interleaved1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 4
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 2
[rank3]:		- stages_list: [3, 7]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1029_Interleaved1F1B_timelyapf_dm1
[rank3]:		- interval: 800
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B-Instruct/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1029_Interleaved1F1B_timelyapf_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: True
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: timelyapf
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- aggressiveness: 0
[rank3]:
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
