
❄️❄️❄️❄️❄️❄️❄️❄️❄️❄️❄️❄️❄️❄️❄️❄️❄️❄️❄️❄️❄️❄️❄️❄️❄️❄️❄️❄️
✔️Current Timestamp: 2025. 11. 04. (화) 16:19:08 KST
✔️SERVER: dmserver1 (143.248.135.95),  GPUs: 0
✔️SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1029_llama1b/eval/eval.sh
✔️OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1029_llama1b/eval/eval_1031_GPipe_fullrand7_dm1.log
✔️RESULT: /data2/shcho/torchtitan/checkpoint/1031_GPipe_fullrand7_dm1/step-2400/eval_1031_GPipe_fullrand7_dm1.json
✔️Main Table Experiment
☑️> python3 -m timelyfreeze.evaluation --model_path=/data2/shcho/torchtitan/checkpoint/1031_GPipe_fullrand7_dm1/step-2400 --dtype=float16 --model_type=Llama-3.2-1B-Instruct --batch_size=32 --device_map=cuda --tasks=mmlu,hellaswag,arc_challenge,truthfulqa_mc1 --output_json=/data2/shcho/torchtitan/checkpoint/1031_GPipe_fullrand7_dm1/step-2400/eval_1031_GPipe_fullrand7_dm1.json
❄️❄️❄️❄️❄️❄️❄️❄️❄️❄️❄️❄️❄️❄️❄️❄️❄️❄️❄️❄️❄️❄️❄️❄️❄️❄️❄️❄️
Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
`torch_dtype` is deprecated! Use `dtype` instead!
Loading checkpoint shards:   0%|          | 0/5 [00:00<?, ?it/s]Loading checkpoint shards:  20%|██        | 1/5 [00:00<00:02,  1.61it/s]Loading checkpoint shards:  40%|████      | 2/5 [00:00<00:01,  2.29it/s]Loading checkpoint shards:  60%|██████    | 3/5 [00:01<00:00,  2.62it/s]Loading checkpoint shards:  80%|████████  | 4/5 [00:01<00:00,  2.93it/s]Loading checkpoint shards: 100%|██████████| 5/5 [00:02<00:00,  2.33it/s]Loading checkpoint shards: 100%|██████████| 5/5 [00:02<00:00,  2.37it/s]
`trust_remote_code` is not supported anymore.
Please check that the Hugging Face dataset 'cais/mmlu' isn't based on a loading script and remove `trust_remote_code`.
If the dataset is based on a loading script, please ask the dataset author to remove it and convert it to a standard format like Parquet.
`trust_remote_code` is not supported anymore.
Please check that the Hugging Face dataset 'cais/mmlu' isn't based on a loading script and remove `trust_remote_code`.
If the dataset is based on a loading script, please ask the dataset author to remove it and convert it to a standard format like Parquet.
`trust_remote_code` is not supported anymore.
Please check that the Hugging Face dataset 'cais/mmlu' isn't based on a loading script and remove `trust_remote_code`.
If the dataset is based on a loading script, please ask the dataset author to remove it and convert it to a standard format like Parquet.
`trust_remote_code` is not supported anymore.
Please check that the Hugging Face dataset 'cais/mmlu' isn't based on a loading script and remove `trust_remote_code`.
If the dataset is based on a loading script, please ask the dataset author to remove it and convert it to a standard format like Parquet.
`trust_remote_code` is not supported anymore.
Please check that the Hugging Face dataset 'cais/mmlu' isn't based on a loading script and remove `trust_remote_code`.
If the dataset is based on a loading script, please ask the dataset author to remove it and convert it to a standard format like Parquet.
`trust_remote_code` is not supported anymore.
Please check that the Hugging Face dataset 'cais/mmlu' isn't based on a loading script and remove `trust_remote_code`.
If the dataset is based on a loading script, please ask the dataset author to remove it and convert it to a standard format like Parquet.
`trust_remote_code` is not supported anymore.
Please check that the Hugging Face dataset 'cais/mmlu' isn't based on a loading script and remove `trust_remote_code`.
If the dataset is based on a loading script, please ask the dataset author to remove it and convert it to a standard format like Parquet.
`trust_remote_code` is not supported anymore.
Please check that the Hugging Face dataset 'cais/mmlu' isn't based on a loading script and remove `trust_remote_code`.
If the dataset is based on a loading script, please ask the dataset author to remove it and convert it to a standard format like Parquet.
`trust_remote_code` is not supported anymore.
Please check that the Hugging Face dataset 'cais/mmlu' isn't based on a loading script and remove `trust_remote_code`.
If the dataset is based on a loading script, please ask the dataset author to remove it and convert it to a standard format like Parquet.
`trust_remote_code` is not supported anymore.
Please check that the Hugging Face dataset 'cais/mmlu' isn't based on a loading script and remove `trust_remote_code`.
If the dataset is based on a loading script, please ask the dataset author to remove it and convert it to a standard format like Parquet.
`trust_remote_code` is not supported anymore.
Please check that the Hugging Face dataset 'cais/mmlu' isn't based on a loading script and remove `trust_remote_code`.
If the dataset is based on a loading script, please ask the dataset author to remove it and convert it to a standard format like Parquet.
`trust_remote_code` is not supported anymore.
Please check that the Hugging Face dataset 'cais/mmlu' isn't based on a loading script and remove `trust_remote_code`.
If the dataset is based on a loading script, please ask the dataset author to remove it and convert it to a standard format like Parquet.
`trust_remote_code` is not supported anymore.
Please check that the Hugging Face dataset 'cais/mmlu' isn't based on a loading script and remove `trust_remote_code`.
If the dataset is based on a loading script, please ask the dataset author to remove it and convert it to a standard format like Parquet.
`trust_remote_code` is not supported anymore.
Please check that the Hugging Face dataset 'cais/mmlu' isn't based on a loading script and remove `trust_remote_code`.
If the dataset is based on a loading script, please ask the dataset author to remove it and convert it to a standard format like Parquet.
`trust_remote_code` is not supported anymore.
Please check that the Hugging Face dataset 'cais/mmlu' isn't based on a loading script and remove `trust_remote_code`.
If the dataset is based on a loading script, please ask the dataset author to remove it and convert it to a standard format like Parquet.
`trust_remote_code` is not supported anymore.
Please check that the Hugging Face dataset 'cais/mmlu' isn't based on a loading script and remove `trust_remote_code`.
If the dataset is based on a loading script, please ask the dataset author to remove it and convert it to a standard format like Parquet.
`trust_remote_code` is not supported anymore.
Please check that the Hugging Face dataset 'cais/mmlu' isn't based on a loading script and remove `trust_remote_code`.
If the dataset is based on a loading script, please ask the dataset author to remove it and convert it to a standard format like Parquet.
`trust_remote_code` is not supported anymore.
Please check that the Hugging Face dataset 'cais/mmlu' isn't based on a loading script and remove `trust_remote_code`.
If the dataset is based on a loading script, please ask the dataset author to remove it and convert it to a standard format like Parquet.
`trust_remote_code` is not supported anymore.
Please check that the Hugging Face dataset 'cais/mmlu' isn't based on a loading script and remove `trust_remote_code`.
If the dataset is based on a loading script, please ask the dataset author to remove it and convert it to a standard format like Parquet.
`trust_remote_code` is not supported anymore.
Please check that the Hugging Face dataset 'cais/mmlu' isn't based on a loading script and remove `trust_remote_code`.
If the dataset is based on a loading script, please ask the dataset author to remove it and convert it to a standard format like Parquet.
`trust_remote_code` is not supported anymore.
Please check that the Hugging Face dataset 'cais/mmlu' isn't based on a loading script and remove `trust_remote_code`.
If the dataset is based on a loading script, please ask the dataset author to remove it and convert it to a standard format like Parquet.
`trust_remote_code` is not supported anymore.
Please check that the Hugging Face dataset 'cais/mmlu' isn't based on a loading script and remove `trust_remote_code`.
If the dataset is based on a loading script, please ask the dataset author to remove it and convert it to a standard format like Parquet.
`trust_remote_code` is not supported anymore.
Please check that the Hugging Face dataset 'cais/mmlu' isn't based on a loading script and remove `trust_remote_code`.
If the dataset is based on a loading script, please ask the dataset author to remove it and convert it to a standard format like Parquet.
`trust_remote_code` is not supported anymore.
Please check that the Hugging Face dataset 'cais/mmlu' isn't based on a loading script and remove `trust_remote_code`.
If the dataset is based on a loading script, please ask the dataset author to remove it and convert it to a standard format like Parquet.
`trust_remote_code` is not supported anymore.
Please check that the Hugging Face dataset 'cais/mmlu' isn't based on a loading script and remove `trust_remote_code`.
If the dataset is based on a loading script, please ask the dataset author to remove it and convert it to a standard format like Parquet.
`trust_remote_code` is not supported anymore.
Please check that the Hugging Face dataset 'cais/mmlu' isn't based on a loading script and remove `trust_remote_code`.
If the dataset is based on a loading script, please ask the dataset author to remove it and convert it to a standard format like Parquet.
`trust_remote_code` is not supported anymore.
Please check that the Hugging Face dataset 'cais/mmlu' isn't based on a loading script and remove `trust_remote_code`.
If the dataset is based on a loading script, please ask the dataset author to remove it and convert it to a standard format like Parquet.
`trust_remote_code` is not supported anymore.
Please check that the Hugging Face dataset 'cais/mmlu' isn't based on a loading script and remove `trust_remote_code`.
If the dataset is based on a loading script, please ask the dataset author to remove it and convert it to a standard format like Parquet.
`trust_remote_code` is not supported anymore.
Please check that the Hugging Face dataset 'cais/mmlu' isn't based on a loading script and remove `trust_remote_code`.
If the dataset is based on a loading script, please ask the dataset author to remove it and convert it to a standard format like Parquet.
`trust_remote_code` is not supported anymore.
Please check that the Hugging Face dataset 'cais/mmlu' isn't based on a loading script and remove `trust_remote_code`.
If the dataset is based on a loading script, please ask the dataset author to remove it and convert it to a standard format like Parquet.
`trust_remote_code` is not supported anymore.
Please check that the Hugging Face dataset 'cais/mmlu' isn't based on a loading script and remove `trust_remote_code`.
If the dataset is based on a loading script, please ask the dataset author to remove it and convert it to a standard format like Parquet.
`trust_remote_code` is not supported anymore.
Please check that the Hugging Face dataset 'cais/mmlu' isn't based on a loading script and remove `trust_remote_code`.
If the dataset is based on a loading script, please ask the dataset author to remove it and convert it to a standard format like Parquet.
`trust_remote_code` is not supported anymore.
Please check that the Hugging Face dataset 'cais/mmlu' isn't based on a loading script and remove `trust_remote_code`.
If the dataset is based on a loading script, please ask the dataset author to remove it and convert it to a standard format like Parquet.
`trust_remote_code` is not supported anymore.
Please check that the Hugging Face dataset 'cais/mmlu' isn't based on a loading script and remove `trust_remote_code`.
If the dataset is based on a loading script, please ask the dataset author to remove it and convert it to a standard format like Parquet.
`trust_remote_code` is not supported anymore.
Please check that the Hugging Face dataset 'cais/mmlu' isn't based on a loading script and remove `trust_remote_code`.
If the dataset is based on a loading script, please ask the dataset author to remove it and convert it to a standard format like Parquet.
`trust_remote_code` is not supported anymore.
Please check that the Hugging Face dataset 'cais/mmlu' isn't based on a loading script and remove `trust_remote_code`.
If the dataset is based on a loading script, please ask the dataset author to remove it and convert it to a standard format like Parquet.
`trust_remote_code` is not supported anymore.
Please check that the Hugging Face dataset 'cais/mmlu' isn't based on a loading script and remove `trust_remote_code`.
If the dataset is based on a loading script, please ask the dataset author to remove it and convert it to a standard format like Parquet.
`trust_remote_code` is not supported anymore.
Please check that the Hugging Face dataset 'cais/mmlu' isn't based on a loading script and remove `trust_remote_code`.
If the dataset is based on a loading script, please ask the dataset author to remove it and convert it to a standard format like Parquet.
`trust_remote_code` is not supported anymore.
Please check that the Hugging Face dataset 'cais/mmlu' isn't based on a loading script and remove `trust_remote_code`.
If the dataset is based on a loading script, please ask the dataset author to remove it and convert it to a standard format like Parquet.
`trust_remote_code` is not supported anymore.
Please check that the Hugging Face dataset 'cais/mmlu' isn't based on a loading script and remove `trust_remote_code`.
If the dataset is based on a loading script, please ask the dataset author to remove it and convert it to a standard format like Parquet.
`trust_remote_code` is not supported anymore.
Please check that the Hugging Face dataset 'cais/mmlu' isn't based on a loading script and remove `trust_remote_code`.
If the dataset is based on a loading script, please ask the dataset author to remove it and convert it to a standard format like Parquet.
`trust_remote_code` is not supported anymore.
Please check that the Hugging Face dataset 'cais/mmlu' isn't based on a loading script and remove `trust_remote_code`.
If the dataset is based on a loading script, please ask the dataset author to remove it and convert it to a standard format like Parquet.
`trust_remote_code` is not supported anymore.
Please check that the Hugging Face dataset 'cais/mmlu' isn't based on a loading script and remove `trust_remote_code`.
If the dataset is based on a loading script, please ask the dataset author to remove it and convert it to a standard format like Parquet.
`trust_remote_code` is not supported anymore.
Please check that the Hugging Face dataset 'cais/mmlu' isn't based on a loading script and remove `trust_remote_code`.
If the dataset is based on a loading script, please ask the dataset author to remove it and convert it to a standard format like Parquet.
`trust_remote_code` is not supported anymore.
Please check that the Hugging Face dataset 'cais/mmlu' isn't based on a loading script and remove `trust_remote_code`.
If the dataset is based on a loading script, please ask the dataset author to remove it and convert it to a standard format like Parquet.
`trust_remote_code` is not supported anymore.
Please check that the Hugging Face dataset 'cais/mmlu' isn't based on a loading script and remove `trust_remote_code`.
If the dataset is based on a loading script, please ask the dataset author to remove it and convert it to a standard format like Parquet.
`trust_remote_code` is not supported anymore.
Please check that the Hugging Face dataset 'cais/mmlu' isn't based on a loading script and remove `trust_remote_code`.
If the dataset is based on a loading script, please ask the dataset author to remove it and convert it to a standard format like Parquet.
`trust_remote_code` is not supported anymore.
Please check that the Hugging Face dataset 'cais/mmlu' isn't based on a loading script and remove `trust_remote_code`.
If the dataset is based on a loading script, please ask the dataset author to remove it and convert it to a standard format like Parquet.
`trust_remote_code` is not supported anymore.
Please check that the Hugging Face dataset 'cais/mmlu' isn't based on a loading script and remove `trust_remote_code`.
If the dataset is based on a loading script, please ask the dataset author to remove it and convert it to a standard format like Parquet.
`trust_remote_code` is not supported anymore.
Please check that the Hugging Face dataset 'cais/mmlu' isn't based on a loading script and remove `trust_remote_code`.
If the dataset is based on a loading script, please ask the dataset author to remove it and convert it to a standard format like Parquet.
`trust_remote_code` is not supported anymore.
Please check that the Hugging Face dataset 'cais/mmlu' isn't based on a loading script and remove `trust_remote_code`.
If the dataset is based on a loading script, please ask the dataset author to remove it and convert it to a standard format like Parquet.
`trust_remote_code` is not supported anymore.
Please check that the Hugging Face dataset 'cais/mmlu' isn't based on a loading script and remove `trust_remote_code`.
If the dataset is based on a loading script, please ask the dataset author to remove it and convert it to a standard format like Parquet.
`trust_remote_code` is not supported anymore.
Please check that the Hugging Face dataset 'cais/mmlu' isn't based on a loading script and remove `trust_remote_code`.
If the dataset is based on a loading script, please ask the dataset author to remove it and convert it to a standard format like Parquet.
`trust_remote_code` is not supported anymore.
Please check that the Hugging Face dataset 'cais/mmlu' isn't based on a loading script and remove `trust_remote_code`.
If the dataset is based on a loading script, please ask the dataset author to remove it and convert it to a standard format like Parquet.
`trust_remote_code` is not supported anymore.
Please check that the Hugging Face dataset 'cais/mmlu' isn't based on a loading script and remove `trust_remote_code`.
If the dataset is based on a loading script, please ask the dataset author to remove it and convert it to a standard format like Parquet.
`trust_remote_code` is not supported anymore.
Please check that the Hugging Face dataset 'cais/mmlu' isn't based on a loading script and remove `trust_remote_code`.
If the dataset is based on a loading script, please ask the dataset author to remove it and convert it to a standard format like Parquet.
`trust_remote_code` is not supported anymore.
Please check that the Hugging Face dataset 'cais/mmlu' isn't based on a loading script and remove `trust_remote_code`.
If the dataset is based on a loading script, please ask the dataset author to remove it and convert it to a standard format like Parquet.
`trust_remote_code` is not supported anymore.
Please check that the Hugging Face dataset 'hellaswag' isn't based on a loading script and remove `trust_remote_code`.
If the dataset is based on a loading script, please ask the dataset author to remove it and convert it to a standard format like Parquet.
  0%|          | 0/817 [00:00<?, ?it/s] 12%|█▏        | 100/817 [00:00<00:00, 998.37it/s] 25%|██▍       | 202/817 [00:00<00:00, 1008.83it/s] 37%|███▋      | 305/817 [00:00<00:00, 1014.11it/s] 50%|████▉     | 407/817 [00:00<00:00, 1014.60it/s] 62%|██████▏   | 509/817 [00:00<00:00, 1014.00it/s] 75%|███████▍  | 611/817 [00:00<00:00, 1010.83it/s] 87%|████████▋ | 713/817 [00:00<00:00, 1007.19it/s]100%|█████████▉| 814/817 [00:00<00:00, 997.55it/s] 100%|██████████| 817/817 [00:00<00:00, 1005.33it/s]
  0%|          | 0/1172 [00:00<?, ?it/s] 13%|█▎        | 150/1172 [00:00<00:00, 1495.06it/s] 26%|██▌       | 301/1172 [00:00<00:00, 1501.79it/s] 39%|███▊      | 452/1172 [00:00<00:00, 1502.36it/s] 51%|█████▏    | 603/1172 [00:00<00:00, 1501.18it/s] 64%|██████▍   | 754/1172 [00:00<00:00, 1502.52it/s] 77%|███████▋  | 905/1172 [00:00<00:00, 1502.21it/s] 90%|█████████ | 1056/1172 [00:00<00:00, 1501.69it/s]100%|██████████| 1172/1172 [00:00<00:00, 1501.19it/s]
  0%|          | 0/10042 [00:00<?, ?it/s]  3%|▎         | 348/10042 [00:00<00:02, 3479.81it/s]  7%|▋         | 698/10042 [00:00<00:02, 3486.87it/s] 10%|█         | 1047/10042 [00:00<00:02, 3441.14it/s] 14%|█▍        | 1395/10042 [00:00<00:02, 3454.16it/s] 17%|█▋        | 1743/10042 [00:00<00:02, 3461.32it/s] 21%|██        | 2091/10042 [00:00<00:02, 3466.87it/s] 24%|██▍       | 2441/10042 [00:00<00:02, 3475.06it/s] 28%|██▊       | 2790/10042 [00:00<00:02, 3479.72it/s] 31%|███▏      | 3140/10042 [00:00<00:01, 3483.51it/s] 35%|███▍      | 3489/10042 [00:01<00:01, 3481.87it/s] 38%|███▊      | 3838/10042 [00:01<00:01, 3478.01it/s] 42%|████▏     | 4187/10042 [00:01<00:01, 3478.65it/s] 45%|████▌     | 4535/10042 [00:01<00:01, 3478.08it/s] 49%|████▊     | 4883/10042 [00:01<00:02, 1786.73it/s] 52%|█████▏    | 5227/10042 [00:01<00:02, 2086.12it/s] 55%|█████▌    | 5566/10042 [00:01<00:01, 2353.95it/s] 59%|█████▉    | 5920/10042 [00:02<00:01, 2621.65it/s] 62%|██████▏   | 6274/10042 [00:02<00:01, 2845.16it/s] 66%|██████▌   | 6619/10042 [00:02<00:01, 2999.81it/s] 69%|██████▉   | 6965/10042 [00:02<00:00, 3123.18it/s] 73%|███████▎  | 7309/10042 [00:02<00:00, 3208.86it/s] 76%|███████▋  | 7658/10042 [00:02<00:00, 3286.64it/s] 80%|███████▉  | 8012/10042 [00:02<00:00, 3358.48it/s] 83%|████████▎ | 8368/10042 [00:02<00:00, 3417.03it/s] 87%|████████▋ | 8726/10042 [00:02<00:00, 3464.15it/s] 90%|█████████ | 9078/10042 [00:02<00:00, 3441.93it/s] 94%|█████████▍| 9429/10042 [00:03<00:00, 3459.51it/s] 97%|█████████▋| 9785/10042 [00:03<00:00, 3487.37it/s]100%|██████████| 10042/10042 [00:03<00:00, 3140.39it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 91%|█████████ | 91/100 [00:00<00:00, 902.05it/s]100%|██████████| 100/100 [00:00<00:00, 902.18it/s]
  0%|          | 0/151 [00:00<?, ?it/s] 61%|██████    | 92/151 [00:00<00:00, 915.76it/s]100%|██████████| 151/151 [00:00<00:00, 916.78it/s]
  0%|          | 0/145 [00:00<?, ?it/s] 61%|██████    | 88/145 [00:00<00:00, 870.24it/s]100%|██████████| 145/145 [00:00<00:00, 886.08it/s]
  0%|          | 0/216 [00:00<?, ?it/s] 42%|████▏     | 91/216 [00:00<00:00, 908.34it/s] 85%|████████▍ | 183/216 [00:00<00:00, 910.71it/s]100%|██████████| 216/216 [00:00<00:00, 908.95it/s]
  0%|          | 0/270 [00:00<?, ?it/s] 34%|███▍      | 92/270 [00:00<00:00, 914.90it/s] 68%|██████▊   | 184/270 [00:00<00:00, 917.81it/s]100%|██████████| 270/270 [00:00<00:00, 917.13it/s]
  0%|          | 0/152 [00:00<?, ?it/s] 59%|█████▉    | 90/152 [00:00<00:00, 891.16it/s]100%|██████████| 152/152 [00:00<00:00, 899.96it/s]
  0%|          | 0/102 [00:00<?, ?it/s] 91%|█████████ | 93/102 [00:00<00:00, 925.82it/s]100%|██████████| 102/102 [00:00<00:00, 923.90it/s]
  0%|          | 0/203 [00:00<?, ?it/s] 46%|████▌     | 93/203 [00:00<00:00, 924.95it/s] 92%|█████████▏| 186/203 [00:00<00:00, 924.52it/s]100%|██████████| 203/203 [00:00<00:00, 924.43it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 93%|█████████▎| 93/100 [00:00<00:00, 925.05it/s]100%|██████████| 100/100 [00:00<00:00, 922.71it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 93%|█████████▎| 93/100 [00:00<00:00, 923.27it/s]100%|██████████| 100/100 [00:00<00:00, 920.52it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 92%|█████████▏| 92/100 [00:00<00:00, 919.43it/s]100%|██████████| 100/100 [00:00<00:00, 918.05it/s]
  0%|          | 0/144 [00:00<?, ?it/s] 62%|██████▏   | 89/144 [00:00<00:00, 888.93it/s]100%|██████████| 144/144 [00:00<00:00, 901.76it/s]
  0%|          | 0/135 [00:00<?, ?it/s] 67%|██████▋   | 91/135 [00:00<00:00, 907.22it/s]100%|██████████| 135/135 [00:00<00:00, 901.38it/s]
  0%|          | 0/112 [00:00<?, ?it/s] 82%|████████▏ | 92/112 [00:00<00:00, 912.62it/s]100%|██████████| 112/112 [00:00<00:00, 913.17it/s]
  0%|          | 0/235 [00:00<?, ?it/s] 40%|███▉      | 93/235 [00:00<00:00, 928.68it/s] 79%|███████▉  | 186/235 [00:00<00:00, 926.66it/s]100%|██████████| 235/235 [00:00<00:00, 926.35it/s]
  0%|          | 0/310 [00:00<?, ?it/s] 30%|███       | 93/310 [00:00<00:00, 926.56it/s] 60%|██████    | 186/310 [00:00<00:00, 923.07it/s] 90%|█████████ | 279/310 [00:00<00:00, 910.16it/s]100%|██████████| 310/310 [00:00<00:00, 911.29it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 92%|█████████▏| 92/100 [00:00<00:00, 918.68it/s]100%|██████████| 100/100 [00:00<00:00, 918.46it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 93%|█████████▎| 93/100 [00:00<00:00, 922.76it/s]100%|██████████| 100/100 [00:00<00:00, 920.47it/s]
  0%|          | 0/378 [00:00<?, ?it/s] 25%|██▍       | 93/378 [00:00<00:00, 923.61it/s] 49%|████▉     | 186/378 [00:00<00:00, 920.70it/s] 74%|███████▍  | 279/378 [00:00<00:00, 909.73it/s] 98%|█████████▊| 370/378 [00:00<00:00, 905.53it/s]100%|██████████| 378/378 [00:00<00:00, 909.64it/s]
  0%|          | 0/234 [00:00<?, ?it/s] 40%|███▉      | 93/234 [00:00<00:00, 929.39it/s] 79%|███████▉  | 186/234 [00:00<00:00, 925.99it/s]100%|██████████| 234/234 [00:00<00:00, 925.26it/s]
  0%|          | 0/783 [00:00<?, ?it/s] 12%|█▏        | 93/783 [00:00<00:00, 920.52it/s] 24%|██▍       | 186/783 [00:00<00:00, 923.99it/s] 36%|███▌      | 279/783 [00:00<00:00, 923.49it/s] 48%|████▊     | 372/783 [00:00<00:00, 922.93it/s] 59%|█████▉    | 465/783 [00:00<00:00, 924.93it/s] 71%|███████▏  | 558/783 [00:00<00:00, 922.46it/s] 83%|████████▎ | 651/783 [00:00<00:00, 923.51it/s] 95%|█████████▌| 744/783 [00:00<00:00, 923.94it/s]100%|██████████| 783/783 [00:00<00:00, 921.86it/s]
  0%|          | 0/272 [00:00<?, ?it/s] 33%|███▎      | 91/272 [00:00<00:00, 899.98it/s] 67%|██████▋   | 183/272 [00:00<00:00, 908.69it/s]100%|██████████| 272/272 [00:00<00:00, 911.13it/s]
  0%|          | 0/282 [00:00<?, ?it/s] 33%|███▎      | 93/282 [00:00<00:00, 926.05it/s] 66%|██████▌   | 186/282 [00:00<00:00, 920.92it/s] 99%|█████████▉| 279/282 [00:00<00:00, 923.14it/s]100%|██████████| 282/282 [00:00<00:00, 922.37it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 93%|█████████▎| 93/100 [00:00<00:00, 922.02it/s]100%|██████████| 100/100 [00:00<00:00, 920.00it/s]
  0%|          | 0/103 [00:00<?, ?it/s] 90%|█████████ | 93/103 [00:00<00:00, 926.08it/s]100%|██████████| 103/103 [00:00<00:00, 924.91it/s]
  0%|          | 0/223 [00:00<?, ?it/s] 41%|████▏     | 92/223 [00:00<00:00, 910.56it/s] 83%|████████▎ | 184/223 [00:00<00:00, 902.45it/s]100%|██████████| 223/223 [00:00<00:00, 905.52it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 93%|█████████▎| 93/100 [00:00<00:00, 924.28it/s]100%|██████████| 100/100 [00:00<00:00, 922.14it/s]
  0%|          | 0/306 [00:00<?, ?it/s] 30%|███       | 93/306 [00:00<00:00, 926.96it/s] 61%|██████    | 186/306 [00:00<00:00, 926.66it/s] 91%|█████████ | 279/306 [00:00<00:00, 925.92it/s]100%|██████████| 306/306 [00:00<00:00, 925.73it/s]
  0%|          | 0/173 [00:00<?, ?it/s] 54%|█████▍    | 93/173 [00:00<00:00, 924.02it/s]100%|██████████| 173/173 [00:00<00:00, 924.51it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 93%|█████████▎| 93/100 [00:00<00:00, 928.03it/s]100%|██████████| 100/100 [00:00<00:00, 927.90it/s]
  0%|          | 0/265 [00:00<?, ?it/s] 35%|███▍      | 92/265 [00:00<00:00, 913.93it/s] 69%|██████▉   | 184/265 [00:00<00:00, 903.19it/s]100%|██████████| 265/265 [00:00<00:00, 903.28it/s]
  0%|          | 0/166 [00:00<?, ?it/s] 56%|█████▌    | 93/166 [00:00<00:00, 924.21it/s]100%|██████████| 166/166 [00:00<00:00, 922.88it/s]
  0%|          | 0/545 [00:00<?, ?it/s] 17%|█▋        | 92/545 [00:00<00:00, 914.03it/s] 34%|███▍      | 185/545 [00:00<00:00, 917.76it/s] 51%|█████     | 278/545 [00:00<00:00, 921.53it/s] 68%|██████▊   | 371/545 [00:00<00:00, 922.10it/s] 85%|████████▌ | 464/545 [00:00<00:00, 916.80it/s]100%|██████████| 545/545 [00:00<00:00, 914.46it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 89%|████████▉ | 89/100 [00:00<00:00, 882.15it/s]100%|██████████| 100/100 [00:00<00:00, 885.62it/s]
  0%|          | 0/110 [00:00<?, ?it/s] 85%|████████▍ | 93/110 [00:00<00:00, 924.57it/s]100%|██████████| 110/110 [00:00<00:00, 922.65it/s]
  0%|          | 0/201 [00:00<?, ?it/s] 46%|████▋     | 93/201 [00:00<00:00, 928.80it/s] 93%|█████████▎| 187/201 [00:00<00:00, 929.95it/s]100%|██████████| 201/201 [00:00<00:00, 929.12it/s]
  0%|          | 0/193 [00:00<?, ?it/s] 48%|████▊     | 93/193 [00:00<00:00, 922.71it/s] 96%|█████████▋| 186/193 [00:00<00:00, 922.49it/s]100%|██████████| 193/193 [00:00<00:00, 921.85it/s]
  0%|          | 0/131 [00:00<?, ?it/s] 69%|██████▉   | 91/131 [00:00<00:00, 908.13it/s]100%|██████████| 131/131 [00:00<00:00, 903.95it/s]
  0%|          | 0/390 [00:00<?, ?it/s] 24%|██▎       | 92/390 [00:00<00:00, 917.07it/s] 47%|████▋     | 185/390 [00:00<00:00, 922.02it/s] 71%|███████▏  | 278/390 [00:00<00:00, 921.75it/s] 95%|█████████▌| 371/390 [00:00<00:00, 922.21it/s]100%|██████████| 390/390 [00:00<00:00, 922.08it/s]
  0%|          | 0/114 [00:00<?, ?it/s] 82%|████████▏ | 93/114 [00:00<00:00, 925.89it/s]100%|██████████| 114/114 [00:00<00:00, 925.72it/s]
  0%|          | 0/198 [00:00<?, ?it/s] 47%|████▋     | 93/198 [00:00<00:00, 926.92it/s] 94%|█████████▍| 186/198 [00:00<00:00, 909.89it/s]100%|██████████| 198/198 [00:00<00:00, 911.41it/s]
  0%|          | 0/238 [00:00<?, ?it/s] 39%|███▊      | 92/238 [00:00<00:00, 912.54it/s] 77%|███████▋  | 184/238 [00:00<00:00, 910.34it/s]100%|██████████| 238/238 [00:00<00:00, 912.46it/s]
  0%|          | 0/612 [00:00<?, ?it/s] 15%|█▌        | 93/612 [00:00<00:00, 925.82it/s] 30%|███       | 186/612 [00:00<00:00, 923.19it/s] 46%|████▌     | 279/612 [00:00<00:00, 924.13it/s] 61%|██████    | 372/612 [00:00<00:00, 914.63it/s] 76%|███████▌  | 466/612 [00:00<00:00, 920.31it/s] 91%|█████████▏| 559/612 [00:00<00:00, 921.83it/s]100%|██████████| 612/612 [00:00<00:00, 921.16it/s]
  0%|          | 0/245 [00:00<?, ?it/s] 38%|███▊      | 92/245 [00:00<00:00, 912.17it/s] 76%|███████▌  | 186/245 [00:00<00:00, 923.23it/s]100%|██████████| 245/245 [00:00<00:00, 920.61it/s]
  0%|          | 0/311 [00:00<?, ?it/s] 29%|██▉       | 90/311 [00:00<00:00, 898.17it/s] 59%|█████▊    | 182/311 [00:00<00:00, 909.18it/s] 88%|████████▊ | 275/311 [00:00<00:00, 917.69it/s]100%|██████████| 311/311 [00:00<00:00, 914.61it/s]
  0%|          | 0/204 [00:00<?, ?it/s] 45%|████▌     | 92/204 [00:00<00:00, 918.49it/s] 90%|█████████ | 184/204 [00:00<00:00, 918.96it/s]100%|██████████| 204/204 [00:00<00:00, 917.48it/s]
  0%|          | 0/165 [00:00<?, ?it/s] 55%|█████▍    | 90/165 [00:00<00:00, 899.79it/s]100%|██████████| 165/165 [00:00<00:00, 905.60it/s]
  0%|          | 0/108 [00:00<?, ?it/s] 86%|████████▌ | 93/108 [00:00<00:00, 927.37it/s]100%|██████████| 108/108 [00:00<00:00, 925.42it/s]
  0%|          | 0/346 [00:00<?, ?it/s] 27%|██▋       | 93/346 [00:00<00:00, 925.94it/s] 54%|█████▍    | 186/346 [00:00<00:00, 925.81it/s] 81%|████████  | 279/346 [00:00<00:00, 927.69it/s]100%|██████████| 346/346 [00:00<00:00, 925.88it/s]
  0%|          | 0/237 [00:00<?, ?it/s] 38%|███▊      | 90/237 [00:00<00:00, 890.15it/s] 76%|███████▋  | 181/237 [00:00<00:00, 900.74it/s]100%|██████████| 237/237 [00:00<00:00, 903.49it/s]
  0%|          | 0/121 [00:00<?, ?it/s] 75%|███████▌  | 91/121 [00:00<00:00, 901.66it/s]100%|██████████| 121/121 [00:00<00:00, 898.50it/s]
  0%|          | 0/163 [00:00<?, ?it/s] 56%|█████▋    | 92/163 [00:00<00:00, 914.76it/s]100%|██████████| 163/163 [00:00<00:00, 918.11it/s]
  0%|          | 0/126 [00:00<?, ?it/s] 75%|███████▍  | 94/126 [00:00<00:00, 930.33it/s]100%|██████████| 126/126 [00:00<00:00, 928.03it/s]
  0%|          | 0/171 [00:00<?, ?it/s] 55%|█████▍    | 94/171 [00:00<00:00, 934.60it/s]100%|██████████| 171/171 [00:00<00:00, 270.03it/s]
  0%|          | 0/895 [00:00<?, ?it/s] 10%|█         | 92/895 [00:00<00:00, 916.40it/s] 21%|██        | 185/895 [00:00<00:00, 918.95it/s] 31%|███       | 278/895 [00:00<00:00, 920.48it/s] 41%|████▏     | 371/895 [00:00<00:00, 922.57it/s] 52%|█████▏    | 464/895 [00:00<00:00, 922.98it/s] 62%|██████▏   | 557/895 [00:00<00:00, 920.95it/s] 73%|███████▎  | 650/895 [00:00<00:00, 921.52it/s] 83%|████████▎ | 743/895 [00:00<00:00, 919.04it/s] 93%|█████████▎| 836/895 [00:00<00:00, 920.68it/s]100%|██████████| 895/895 [00:00<00:00, 919.83it/s]
  0%|          | 0/324 [00:00<?, ?it/s] 29%|██▊       | 93/324 [00:00<00:00, 919.66it/s] 57%|█████▋    | 185/324 [00:00<00:00, 918.70it/s] 85%|████████▌ | 277/324 [00:00<00:00, 907.04it/s]100%|██████████| 324/324 [00:00<00:00, 909.35it/s]
  0%|          | 0/1534 [00:00<?, ?it/s]  6%|▌         | 92/1534 [00:00<00:01, 917.80it/s] 12%|█▏        | 185/1534 [00:00<00:01, 921.97it/s] 18%|█▊        | 278/1534 [00:00<00:01, 923.12it/s] 24%|██▍       | 371/1534 [00:00<00:01, 923.61it/s] 30%|███       | 464/1534 [00:00<00:01, 922.78it/s] 36%|███▋      | 557/1534 [00:00<00:01, 922.58it/s] 42%|████▏     | 650/1534 [00:00<00:00, 922.93it/s] 48%|████▊     | 743/1534 [00:00<00:00, 923.85it/s] 54%|█████▍    | 836/1534 [00:00<00:00, 924.60it/s] 61%|██████    | 929/1534 [00:01<00:00, 922.32it/s] 67%|██████▋   | 1022/1534 [00:01<00:00, 913.70it/s] 73%|███████▎  | 1114/1534 [00:01<00:00, 911.33it/s] 79%|███████▊  | 1206/1534 [00:01<00:00, 906.49it/s] 85%|████████▍ | 1297/1534 [00:01<00:00, 905.21it/s] 90%|█████████ | 1388/1534 [00:01<00:00, 902.32it/s] 96%|█████████▋| 1479/1534 [00:01<00:00, 903.98it/s]100%|██████████| 1534/1534 [00:01<00:00, 914.50it/s]
Running loglikelihood requests:   0%|          | 0/105137 [00:00<?, ?it/s]Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/home/shcho/torchtitan/timelyfreeze/evaluation.py", line 114, in <module>
    main()
  File "/home/shcho/torchtitan/timelyfreeze/evaluation.py", line 61, in main
    results = evaluator.simple_evaluate(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/lm_eval/utils.py", line 439, in _wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/lm_eval/evaluator.py", line 342, in simple_evaluate
    results = evaluate(
              ^^^^^^^^^
  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/lm_eval/utils.py", line 439, in _wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/lm_eval/evaluator.py", line 570, in evaluate
    resps = getattr(lm, reqtype)(cloned_reqs)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/lm_eval/api/model.py", line 382, in loglikelihood
    return self._loglikelihood_tokens(new_reqs, disable_tqdm=disable_tqdm)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/lm_eval/models/huggingface.py", line 1213, in _loglikelihood_tokens
    multi_logits = F.log_softmax(
                   ^^^^^^^^^^^^^^
  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/nn/functional.py", line 2264, in log_softmax
    ret = input.log_softmax(dim)
          ^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 7.52 GiB. GPU 0 has a total capacity of 47.51 GiB of which 5.05 GiB is free. Process 966660 has 32.09 GiB memory in use. Including non-PyTorch memory, this process has 10.34 GiB memory in use. Of the allocated memory 9.83 GiB is allocated by PyTorch, and 14.38 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Running loglikelihood requests:   0%|          | 0/105137 [00:02<?, ?it/s]
