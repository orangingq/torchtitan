
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 11. 02. (ì¼) 05:07:07 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 3,4,5,6
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1029_llama1b/run_1031.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1029_llama1b/1031_1F1B_timelyapf.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
+ more freezing in autofreeze mode. 
+ lr_scheduler min_lr = 0 -> 1e-6, cosine decay.

âœ”ï¸Running with timelyapf x 1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1029_llama1b/config_1031.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
+ more freezing in autofreeze mode. 
+ lr_scheduler min_lr = 0 -> 1e-6, cosine decay.
" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=timelyapf
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank2]:2025-11-02 05:07:13,771 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
[rank2]:+ more freezing in autofreeze mode. 
[rank2]:+ lr_scheduler min_lr = 0 -> 1e-6, cosine decay.
[rank2]:"
[rank3]:2025-11-02 05:07:13,772 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
[rank3]:+ more freezing in autofreeze mode. 
[rank3]:+ lr_scheduler min_lr = 0 -> 1e-6, cosine decay.
[rank3]:"
[rank0]:2025-11-02 05:07:13,934 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
[rank0]:+ more freezing in autofreeze mode. 
[rank0]:+ lr_scheduler min_lr = 0 -> 1e-6, cosine decay.
[rank0]:"
[rank1]:2025-11-02 05:07:14,051 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
[rank1]:+ more freezing in autofreeze mode. 
[rank1]:+ lr_scheduler min_lr = 0 -> 1e-6, cosine decay.
[rank1]:"
[rank0]:2025-11-02 05:07:14,487 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-11-02 05:07:14,490 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-02 05:07:14,495 - INFO - [GC] Initial GC collection 0.00 seconds
[rank2]:2025-11-02 05:07:14,495 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-11-02 05:07:14,497 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-11-02 05:07:14,527 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-11-02 05:07:14,530 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-11-02 05:07:14,512 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-11-02 05:07:14,514 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-02 05:07:14,917 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-11-02 05:07:15,313 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank2]:2025-11-02 05:07:18,276 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-11-02 05:07:18,364 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=512, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank2]:2025-11-02 05:07:18,319 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-11-02 05:07:18,346 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-11-02 05:07:18,347 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2025-11-02 05:07:18,432 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-11-02 05:07:18,473 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-11-02 05:07:18,500 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-11-02 05:07:18,500 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2025-11-02 05:07:18,511 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-11-02 05:07:18,549 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-02 05:07:18,550 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-11-02 05:07:18,575 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-11-02 05:07:18,576 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank2]:2025-11-02 05:07:18,516 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-11-02 05:07:18,516 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-11-02 05:07:18,517 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank1]:2025-11-02 05:07:18,669 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-11-02 05:07:18,669 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-11-02 05:07:18,670 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank0]:2025-11-02 05:07:18,759 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-02 05:07:18,759 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-11-02 05:07:18,760 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run krb6pl9e
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1031_1F1B_timelyapf_dm1/20251102-0507/wandb/run-20251102_050719-krb6pl9e
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1031_1F1B_timelyapf_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/krb6pl9e
[rank3]:2025-11-02 05:07:20,348 - INFO - WandB logging enabled
[rank3]:2025-11-02 05:07:20,349 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-11-02 05:07:20,389 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-11-02 05:07:20,418 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-11-02 05:07:20,419 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank3]:2025-11-02 05:07:20,600 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-11-02 05:07:20,601 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-11-02 05:07:20,601 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank1]:2025-11-02 05:07:20,617 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank2]:2025-11-02 05:07:20,617 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-02 05:07:20,617 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1031_1F1B_timelyapf_dm1
[rank0]:2025-11-02 05:07:20,617 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-02 05:07:20,617 - INFO - Preparing c4_validation dataset from allenai/c4
[rank3]:2025-11-02 05:07:20,616 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-02 05:07:25,372 - INFO - Trainer is initialized with local batch size 32, global batch size 64, gradient accumulation steps 2, sequence length 512, total steps 2400 (warmup 300)
[rank0]:2025-11-02 05:07:25,372 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B-Instruct/original_dcp.
[rank0]:2025-11-02 05:07:27,873 - INFO - [GC] GC collection for checkpoint loading. 0.01 seconds
[rank0]:2025-11-02 05:07:27,873 - INFO - Finished loading the checkpoint in 2.50 seconds.
[rank0]:2025-11-02 05:07:27,873 - INFO - Training starts at step 1
[rank2]:2025-11-02 05:07:31,087 - INFO -  step:  1  loss: -2.0000  grad_norm: 85.2028  memory:  4.61GiB(9.71%)  tps: 642  tflops: 4.89  mfu: 1.57%
[rank2]:2025-11-02 05:07:31,087 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-11-02 05:07:31,097 - INFO -  step:  1  loss:  9.0164  grad_norm: 85.2028  memory: 12.97GiB(27.30%)  tps: 765  tflops: 5.83  mfu: 1.87%
[rank3]:2025-11-02 05:07:31,097 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-02 05:07:31,128 - INFO -  step:  1  loss: -2.0000  grad_norm: 85.2028  memory:  9.17GiB(19.29%)  tps: 651  tflops: 4.96  mfu: 1.59%
[rank0]:2025-11-02 05:07:31,129 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-11-02 05:07:31,091 - INFO -  step:  1  loss: -2.0000  grad_norm: 85.2028  memory:  6.74GiB(14.20%)  tps: 649  tflops: 4.94  mfu: 1.58%
[rank1]:2025-11-02 05:07:31,095 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-02 05:08:30,862 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-02 05:08:32,141 - INFO -  step: 50  loss: -2.0000  grad_norm: 49.3062  memory: 12.97GiB(27.31%)  tps: 6,579  tflops: 50.11  mfu: 16.06%
[rank2]:2025-11-02 05:08:32,126 - INFO -  step: 50  loss: -2.0000  grad_norm: 49.3062  memory:  6.43GiB(13.53%)  tps: 6,576  tflops: 50.09  mfu: 16.05%
[rank3]:2025-11-02 05:08:32,139 - INFO -  step: 50  loss:  9.8046  grad_norm: 49.3062  memory: 16.39GiB(34.50%)  tps: 6,576  tflops: 50.09  mfu: 16.05%
[rank1]:2025-11-02 05:08:32,132 - INFO -  step: 50  loss: -2.0000  grad_norm: 49.3062  memory:  9.03GiB(19.01%)  tps: 6,577  tflops: 50.09  mfu: 16.05%
[rank0]:2025-11-02 05:09:33,374 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-02 05:09:34,386 - INFO - Avg. fwd time: 7.9880 / Avg. bwd time: 23.4119 / Avg. batch time: 606.4641 (ms) / GPU bubble ratio: 58.58%
[rank3]:2025-11-02 05:09:34,318 - INFO - Avg. fwd time: 12.4477 / Avg. bwd time: 40.4718 / Avg. batch time: 495.5497 (ms) / GPU bubble ratio: 14.57%
[rank2]:2025-11-02 05:09:34,356 - INFO - Avg. fwd time: 6.9692 / Avg. bwd time: 18.1321 / Avg. batch time: 526.4262 (ms) / GPU bubble ratio: 61.85%
[rank1]:2025-11-02 05:09:34,390 - INFO - Avg. fwd time: 9.0865 / Avg. bwd time: 23.3428 / Avg. batch time: 564.8141 (ms) / GPU bubble ratio: 54.07%
[rank0]:2025-11-02 05:09:34,620 - INFO -  step: 100  loss: -2.0000  grad_norm: 31.6669  memory: 12.97GiB(27.31%)  tps: 6,556  tflops: 49.93  mfu: 16.00%
[rank0]:2025-11-02 05:09:34,621 - WARNING - Nothing to draw before the end of warmup.
[rank3]:2025-11-02 05:09:34,618 - INFO -  step: 100  loss:  8.5679  grad_norm: 31.6669  memory: 16.39GiB(34.50%)  tps: 6,556  tflops: 49.93  mfu: 16.00%
[rank3]:2025-11-02 05:09:34,618 - WARNING - Nothing to draw before the end of warmup.
[rank2]:2025-11-02 05:09:34,606 - INFO -  step: 100  loss: -2.0000  grad_norm: 31.6669  memory:  6.43GiB(13.53%)  tps: 6,556  tflops: 49.93  mfu: 16.00%
[rank2]:2025-11-02 05:09:34,606 - WARNING - Nothing to draw before the end of warmup.
[rank1]:2025-11-02 05:09:34,610 - INFO -  step: 100  loss: -2.0000  grad_norm: 31.6669  memory:  9.03GiB(19.01%)  tps: 6,556  tflops: 49.93  mfu: 16.00%
[rank1]:2025-11-02 05:09:34,610 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-11-02 05:10:35,932 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-02 05:10:37,222 - INFO -  step: 150  loss: -2.0000  grad_norm: 46.0416  memory: 12.97GiB(27.31%)  tps: 6,543  tflops: 49.83  mfu: 15.97%
[rank3]:2025-11-02 05:10:37,220 - INFO -  step: 150  loss:  5.0055  grad_norm: 46.0416  memory: 16.39GiB(34.50%)  tps: 6,543  tflops: 49.83  mfu: 15.97%
[rank2]:2025-11-02 05:10:37,207 - INFO -  step: 150  loss: -2.0000  grad_norm: 46.0416  memory:  6.43GiB(13.53%)  tps: 6,543  tflops: 49.83  mfu: 15.97%
[rank1]:2025-11-02 05:10:37,211 - INFO -  step: 150  loss: -2.0000  grad_norm: 46.0416  memory:  9.03GiB(19.01%)  tps: 6,543  tflops: 49.83  mfu: 15.97%
[rank0]:2025-11-02 05:11:38,447 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 05:11:39,424 - INFO - Avg. fwd time: 12.4701 / Avg. bwd time: 40.4176 / Avg. batch time: 495.1926 (ms) / GPU bubble ratio: 14.56%
[rank0]:2025-11-02 05:11:39,493 - INFO - Avg. fwd time: 7.6949 / Avg. bwd time: 23.4681 / Avg. batch time: 602.4261 (ms) / GPU bubble ratio: 58.62%
[rank2]:2025-11-02 05:11:39,463 - INFO - Avg. fwd time: 6.9470 / Avg. bwd time: 18.1762 / Avg. batch time: 525.6376 (ms) / GPU bubble ratio: 61.76%
[rank1]:2025-11-02 05:11:39,497 - INFO - Avg. fwd time: 9.0774 / Avg. bwd time: 23.4015 / Avg. batch time: 563.6021 (ms) / GPU bubble ratio: 53.90%
[rank0]:2025-11-02 05:11:39,738 - INFO -  step: 200  loss: -2.0000  grad_norm: 39.1088  memory: 12.97GiB(27.31%)  tps: 6,552  tflops: 49.90  mfu: 15.99%
[rank0]:2025-11-02 05:11:39,739 - INFO - ðŸ”Ž  Running validation at step 200
[rank2]:2025-11-02 05:11:39,724 - INFO -  step: 200  loss: -2.0000  grad_norm: 39.1088  memory:  6.43GiB(13.53%)  tps: 6,552  tflops: 49.90  mfu: 15.99%
[rank2]:2025-11-02 05:11:39,724 - INFO - ðŸ”Ž  Running validation at step 200
[rank3]:2025-11-02 05:11:39,736 - INFO -  step: 200  loss:  1.7903  grad_norm: 39.1088  memory: 16.39GiB(34.50%)  tps: 6,552  tflops: 49.90  mfu: 15.99%
[rank3]:2025-11-02 05:11:39,737 - INFO - ðŸ”Ž  Running validation at step 200
[rank1]:2025-11-02 05:11:39,728 - INFO -  step: 200  loss: -2.0000  grad_norm: 39.1088  memory:  9.03GiB(19.01%)  tps: 6,552  tflops: 49.90  mfu: 15.99%
[rank1]:2025-11-02 05:11:39,728 - INFO - ðŸ”Ž  Running validation at step 200
[rank2]:2025-11-02 05:12:00,576 - INFO - validate step: 200  loss: -1.0000  memory:  6.43GiB(13.53%)  tps: 19,643
[rank2]:2025-11-02 05:12:00,577 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-11-02 05:12:00,546 - INFO - validate step: 200  loss: -1.0000  memory: 12.97GiB(27.31%)  tps: 19,686
[rank0]:2025-11-02 05:12:00,547 - WARNING - Nothing to draw before the end of warmup.
[rank3]:2025-11-02 05:12:00,570 - INFO - validate step: 200  loss:  1.5333  memory: 16.39GiB(34.50%)  tps: 19,662
[rank3]:2025-11-02 05:12:00,571 - WARNING - Nothing to draw before the end of warmup.
[rank1]:2025-11-02 05:12:00,564 - INFO - validate step: 200  loss: -1.0000  memory:  9.03GiB(19.01%)  tps: 19,659
[rank1]:2025-11-02 05:12:00,565 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-11-02 05:13:01,680 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-11-02 05:13:02,922 - INFO -  step: 250  loss: -2.0000  grad_norm: 98.3860  memory:  6.43GiB(13.53%)  tps: 6,570  tflops: 50.04  mfu: 16.04%
[rank0]:2025-11-02 05:13:02,936 - INFO -  step: 250  loss: -2.0000  grad_norm: 98.3860  memory: 12.97GiB(27.31%)  tps: 6,565  tflops: 50.00  mfu: 16.03%
[rank3]:2025-11-02 05:13:02,934 - INFO -  step: 250  loss:  0.7102  grad_norm: 98.3860  memory: 16.39GiB(34.50%)  tps: 6,568  tflops: 50.02  mfu: 16.03%
[rank1]:2025-11-02 05:13:02,925 - INFO -  step: 250  loss: -2.0000  grad_norm: 98.3860  memory:  9.03GiB(19.01%)  tps: 6,568  tflops: 50.02  mfu: 16.03%
[rank3]:2025-11-02 05:13:15,070 - INFO - [Step 260] ã€°ï¸ Monitoring Upperbound
[rank2]:2025-11-02 05:13:28,356 - WARNING - [Step 270] â³ Monitoring Upperbound... (540/550)
[rank3]:2025-11-02 05:13:28,332 - WARNING - [Step 270] â³ Monitoring Upperbound... (540/550)
[rank0]:2025-11-02 05:13:28,412 - WARNING - [Step 270] â³ Monitoring Upperbound... (540/550)
[rank1]:2025-11-02 05:13:28,384 - WARNING - [Step 270] â³ Monitoring Upperbound... (540/550)
[rank3]:2025-11-02 05:13:42,998 - INFO - [Step 280] âœ”ï¸  Setting Upperbound
[rank3]:2025-11-02 05:13:43,296 - INFO - [Step 280] ã€°ï¸ Monitoring Lowerbound
[rank0]:2025-11-02 05:13:43,331 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-02 05:13:43,329 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-02 05:13:43,322 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-02 05:13:43,342 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-02 05:13:43,365 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-02 05:13:43,349 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-02 05:13:43,371 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-02 05:13:43,362 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-02 05:13:45,802 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-02 05:13:45,825 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-02 05:13:45,805 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-02 05:13:45,858 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-02 05:13:45,881 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-02 05:13:45,922 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-02 05:13:45,842 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-02 05:13:45,865 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-02 05:13:45,889 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-02 05:13:45,912 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-02 05:13:45,936 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-02 05:13:45,906 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-02 05:13:45,902 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-02 05:13:45,943 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-02 05:13:45,961 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-02 05:13:45,994 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-02 05:13:45,960 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-02 05:13:45,950 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-02 05:13:45,951 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-02 05:13:45,952 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-02 05:13:45,952 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-02 05:13:45,975 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-02 05:13:45,990 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-02 05:13:46,012 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-02 05:14:03,927 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 05:14:04,736 - INFO - Avg. fwd time: 7.0351 / Avg. bwd time: 17.5187 / Avg. batch time: 527.2143 (ms) / GPU bubble ratio: 62.74%
[rank0]:2025-11-02 05:14:04,756 - INFO - Avg. fwd time: 7.6805 / Avg. bwd time: 21.9255 / Avg. batch time: 600.5659 (ms) / GPU bubble ratio: 60.56%
[rank3]:2025-11-02 05:14:04,723 - INFO - Avg. fwd time: 12.5056 / Avg. bwd time: 39.0342 / Avg. batch time: 484.3694 (ms) / GPU bubble ratio: 14.88%
[rank3]:2025-11-02 05:14:04,736 - INFO - [Step 300] âœ”ï¸  Setting Lowerbound
[rank1]:2025-11-02 05:14:04,752 - INFO - Avg. fwd time: 9.1965 / Avg. bwd time: 22.5705 / Avg. batch time: 564.1898 (ms) / GPU bubble ratio: 54.96%
[rank1]:2025-11-02 05:14:04,774 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-11-02 05:14:04,774 - INFO -  step: 300  loss: -2.0000  grad_norm:  0.0000  memory:  9.03GiB(19.01%)  tps: 6,623  tflops: 50.44  mfu: 16.17%
[rank2]:2025-11-02 05:14:04,773 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-02 05:14:04,774 - INFO -  step: 300  loss: -2.0000  grad_norm:  0.0000  memory:  6.43GiB(13.53%)  tps: 6,622  tflops: 50.44  mfu: 16.17%
[rank0]:2025-11-02 05:14:04,774 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.55/0.55, [MB7] 1.00/1.00
[rank0]:2025-11-02 05:14:04,775 - INFO -  step: 300  loss: -2.0000  grad_norm:  0.0000  memory: 12.97GiB(27.31%)  tps: 6,624  tflops: 50.45  mfu: 16.17%
[rank3]:2025-11-02 05:14:04,966 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/pipeline_schedule/251102_0514_max_batch_time.svg
[rank3]:> Batch Time: 513.13 ms, GPU Bubble Ratio: 51.82%, 49.35%, 60.88%, 18.34%
[rank3]:2025-11-02 05:14:05,151 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/pipeline_schedule/251102_0514_min_batch_time.svg
[rank3]:> Batch Time: 310.85 ms, GPU Bubble Ratio: 80.95%, 49.73%, 61.44%, 15.11%
[rank3]:2025-11-02 05:14:05,353 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/pipeline_schedule/251102_0514_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 337.61 ms, GPU Bubble Ratio: 37.72%, 26.89%, 43.57%, 13.92%
[rank3]:2025-11-02 05:14:05,353 - INFO - 	> Batch Time: 337.61 ms (Average Freeze Ratio: 0.31, Time Reduction Rate: 0.34)
[rank3]:2025-11-02 05:14:07,850 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.40/0.40, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-11-02 05:14:07,854 - INFO -  step: 300  loss:  0.3285  grad_norm:  0.0000  memory: 16.39GiB(34.50%)  tps: 6,310  tflops: 48.05  mfu: 15.40%
[rank2]:2025-11-02 05:14:07,939 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251102_0514_stage2_step300.svg
[rank0]:2025-11-02 05:14:07,941 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251102_0514_stage0_step300.svg
[rank1]:2025-11-02 05:14:07,939 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251102_0514_stage1_step300.svg
[rank3]:2025-11-02 05:14:08,045 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/pipeline_schedule/251102_0514_real_step300_rank3.svg
[rank3]:> Batch Time: 319.17 ms, GPU Bubble Ratio: 78.38%, 46.64%, 58.66%, 14.63%
[rank3]:2025-11-02 05:14:08,113 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251102_0514_stage3_step300.svg
[rank0]:2025-11-02 05:15:07,375 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 05:15:08,395 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.67/1.00
[rank2]:2025-11-02 05:15:08,396 - INFO -  step: 350  loss: -2.0000  grad_norm:  2.4590  memory:  6.53GiB(13.74%)  tps: 6,438  tflops: 49.03  mfu: 15.72%
[rank0]:2025-11-02 05:15:08,410 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.37/0.55, [MB7] 0.67/1.00
[rank0]:2025-11-02 05:15:08,410 - INFO -  step: 350  loss: -2.0000  grad_norm:  2.4590  memory: 13.23GiB(27.85%)  tps: 6,437  tflops: 49.02  mfu: 15.71%
[rank1]:2025-11-02 05:15:08,399 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.67/1.00
[rank1]:2025-11-02 05:15:08,399 - INFO -  step: 350  loss: -2.0000  grad_norm:  2.4590  memory:  9.36GiB(19.71%)  tps: 6,438  tflops: 49.03  mfu: 15.72%
[rank3]:2025-11-02 05:15:10,944 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.27/0.40, [MB2] 0.67/1.00, [MB3] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank3]:2025-11-02 05:15:10,948 - INFO -  step: 350  loss:  0.2298  grad_norm:  2.4590  memory: 16.39GiB(34.50%)  tps: 6,492  tflops: 49.45  mfu: 15.85%
[rank0]:2025-11-02 05:16:08,900 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 05:16:09,632 - INFO - Avg. fwd time: 12.7101 / Avg. bwd time: 35.6866 / Avg. batch time: 459.6147 (ms) / GPU bubble ratio: 15.76%
[rank2]:2025-11-02 05:16:09,698 - INFO - Avg. fwd time: 7.0783 / Avg. bwd time: 17.2681 / Avg. batch time: 524.2903 (ms) / GPU bubble ratio: 62.85%
[rank0]:2025-11-02 05:16:09,729 - INFO - Avg. fwd time: 7.7536 / Avg. bwd time: 20.8939 / Avg. batch time: 596.5081 (ms) / GPU bubble ratio: 61.58%
[rank1]:2025-11-02 05:16:09,734 - INFO - Avg. fwd time: 9.2697 / Avg. bwd time: 22.0091 / Avg. batch time: 560.9653 (ms) / GPU bubble ratio: 55.39%
[rank2]:2025-11-02 05:16:09,891 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-02 05:16:09,892 - INFO -  step: 400  loss: -2.0000  grad_norm:  0.2790  memory:  6.55GiB(13.78%)  tps: 6,661  tflops: 50.73  mfu: 16.26%
[rank2]:2025-11-02 05:16:09,892 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-11-02 05:16:09,907 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.55/0.55, [MB7] 1.00/1.00
[rank0]:2025-11-02 05:16:09,907 - INFO -  step: 400  loss: -2.0000  grad_norm:  0.2790  memory: 13.35GiB(28.09%)  tps: 6,661  tflops: 50.73  mfu: 16.26%
[rank0]:2025-11-02 05:16:09,907 - INFO - ðŸ”Ž  Running validation at step 400
[rank1]:2025-11-02 05:16:09,895 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-11-02 05:16:09,896 - INFO -  step: 400  loss: -2.0000  grad_norm:  0.2790  memory:  9.40GiB(19.79%)  tps: 6,661  tflops: 50.73  mfu: 16.26%
[rank1]:2025-11-02 05:16:09,896 - INFO - ðŸ”Ž  Running validation at step 400
[rank3]:2025-11-02 05:16:12,427 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.40/0.40, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-11-02 05:16:12,430 - INFO -  step: 400  loss:  0.2577  grad_norm:  0.2790  memory: 16.39GiB(34.50%)  tps: 6,662  tflops: 50.74  mfu: 16.26%
[rank3]:2025-11-02 05:16:12,430 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-11-02 05:16:33,156 - INFO - validate step: 400  loss: -1.0000  memory: 13.35GiB(28.09%)  tps: 17,618
[rank1]:2025-11-02 05:16:33,174 - INFO - validate step: 400  loss: -1.0000  memory:  9.40GiB(19.79%)  tps: 17,596
[rank2]:2025-11-02 05:16:33,195 - INFO - validate step: 400  loss: -1.0000  memory:  6.55GiB(13.78%)  tps: 17,578
[rank3]:2025-11-02 05:16:33,185 - INFO - validate step: 400  loss:  0.9443  memory: 16.39GiB(34.50%)  tps: 19,737
[rank0]:2025-11-02 05:16:33,272 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251102_0516_stage0_step400.svg
[rank1]:2025-11-02 05:16:33,271 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251102_0516_stage1_step400.svg
[rank2]:2025-11-02 05:16:33,272 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251102_0516_stage2_step400.svg
[rank3]:2025-11-02 05:16:33,385 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/pipeline_schedule/251102_0516_real_step400_rank3.svg
[rank3]:> Batch Time: 381.56 ms, GPU Bubble Ratio: 43.87%, 39.20%, 51.05%, 22.83%
[rank3]:2025-11-02 05:16:33,455 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251102_0516_stage3_step400.svg
[rank0]:2025-11-02 05:17:30,261 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-11-02 05:17:31,230 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-02 05:17:31,230 - INFO -  step: 450  loss: -2.0000  grad_norm:  3.4939  memory:  6.55GiB(13.78%)  tps: 7,058  tflops: 53.75  mfu: 17.23%
[rank0]:2025-11-02 05:17:31,246 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.55/0.55, [MB7] 1.00/1.00
[rank0]:2025-11-02 05:17:31,246 - INFO -  step: 450  loss: -2.0000  grad_norm:  3.4939  memory: 13.35GiB(28.09%)  tps: 7,051  tflops: 53.70  mfu: 17.21%
[rank1]:2025-11-02 05:17:31,234 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-11-02 05:17:31,234 - INFO -  step: 450  loss: -2.0000  grad_norm:  3.4939  memory:  9.40GiB(19.79%)  tps: 7,055  tflops: 53.73  mfu: 17.22%
[rank3]:2025-11-02 05:17:33,685 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.40/0.40, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-11-02 05:17:33,689 - INFO -  step: 450  loss:  0.2725  grad_norm:  3.4939  memory: 16.39GiB(34.50%)  tps: 6,770  tflops: 51.56  mfu: 16.53%
[rank0]:2025-11-02 05:18:30,342 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 05:18:31,114 - INFO - Avg. fwd time: 7.1373 / Avg. bwd time: 16.8952 / Avg. batch time: 520.2761 (ms) / GPU bubble ratio: 63.05%
[rank3]:2025-11-02 05:18:31,050 - INFO - Avg. fwd time: 12.8975 / Avg. bwd time: 32.9202 / Avg. batch time: 438.9573 (ms) / GPU bubble ratio: 16.50%
[rank0]:2025-11-02 05:18:31,107 - INFO - Avg. fwd time: 7.8431 / Avg. bwd time: 18.7269 / Avg. batch time: 590.7778 (ms) / GPU bubble ratio: 64.02%
[rank1]:2025-11-02 05:18:31,149 - INFO - Avg. fwd time: 9.3791 / Avg. bwd time: 21.2325 / Avg. batch time: 556.5020 (ms) / GPU bubble ratio: 55.99%
[rank2]:2025-11-02 05:18:31,407 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/pipeline_schedule_adjustment/251102_0518_rank2_trend_line.svg
[rank3]:2025-11-02 05:18:31,400 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/pipeline_schedule_adjustment/251102_0518_rank3_trend_line.svg
[rank0]:2025-11-02 05:18:31,423 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/pipeline_schedule_adjustment/251102_0518_rank0_trend_line.svg
[rank0]:2025-11-02 05:18:31,430 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank0]:2025-11-02 05:18:31,431 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank0]:2025-11-02 05:18:31,432 - INFO -  step: 500  loss: -2.0000  grad_norm:  0.3289  memory: 13.35GiB(28.09%)  tps: 6,806  tflops: 51.83  mfu: 16.61%
[rank1]:2025-11-02 05:18:31,411 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/pipeline_schedule_adjustment/251102_0518_rank1_trend_line.svg
[rank1]:2025-11-02 05:18:31,430 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank1]:2025-11-02 05:18:31,431 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank1]:2025-11-02 05:18:31,432 - INFO -  step: 500  loss: -2.0000  grad_norm:  0.3289  memory:  9.40GiB(19.79%)  tps: 6,804  tflops: 51.82  mfu: 16.61%
[rank2]:2025-11-02 05:18:31,430 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-02 05:18:31,432 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-02 05:18:31,432 - INFO -  step: 500  loss: -2.0000  grad_norm:  0.3289  memory:  6.55GiB(13.78%)  tps: 6,804  tflops: 51.82  mfu: 16.61%
[rank3]:2025-11-02 05:18:31,625 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/pipeline_schedule/251102_0518_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 358.42 ms, GPU Bubble Ratio: 55.92%, 37.46%, 49.04%, 21.08%
[rank3]:2025-11-02 05:18:31,625 - INFO - 	> Batch Time: 358.42 ms (Average Freeze Ratio: 0.23)
[rank3]:2025-11-02 05:18:31,626 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 0.40/0.40, [MB7] 0.00/0.00
[rank3]:2025-11-02 05:18:34,095 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 0.40/0.40, [MB7] 0.00/0.00
[rank3]:2025-11-02 05:18:34,098 - INFO -  step: 500  loss:  0.3006  grad_norm:  0.3289  memory: 16.39GiB(34.50%)  tps: 6,781  tflops: 51.64  mfu: 16.55%
[rank1]:2025-11-02 05:18:34,166 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251102_0518_stage1_step500.svg
[rank2]:2025-11-02 05:18:34,166 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251102_0518_stage2_step500.svg
[rank0]:2025-11-02 05:18:34,169 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251102_0518_stage0_step500.svg
[rank3]:2025-11-02 05:18:34,288 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/pipeline_schedule/251102_0518_real_step500_rank3.svg
[rank3]:> Batch Time: 370.30 ms, GPU Bubble Ratio: 59.60%, 39.35%, 50.61%, 21.94%
[rank3]:2025-11-02 05:18:34,352 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251102_0518_stage3_step500.svg
[rank0]:2025-11-02 05:19:31,978 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 05:19:32,971 - INFO -  step: 550  loss: -2.0000  grad_norm:  2.1009  memory:  6.55GiB(13.78%)  tps: 6,656  tflops: 50.69  mfu: 16.25%
[rank0]:2025-11-02 05:19:32,987 - INFO -  step: 550  loss: -2.0000  grad_norm:  2.1009  memory: 13.35GiB(28.09%)  tps: 6,654  tflops: 50.68  mfu: 16.24%
[rank1]:2025-11-02 05:19:32,975 - INFO -  step: 550  loss: -2.0000  grad_norm:  2.1009  memory:  9.40GiB(19.79%)  tps: 6,656  tflops: 50.69  mfu: 16.25%
[rank3]:2025-11-02 05:19:35,452 - INFO -  step: 550  loss:  0.2913  grad_norm:  2.1009  memory: 16.39GiB(34.50%)  tps: 6,676  tflops: 50.85  mfu: 16.30%
[rank0]:2025-11-02 05:20:33,154 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 05:20:34,067 - INFO - Avg. fwd time: 12.9947 / Avg. bwd time: 31.1062 / Avg. batch time: 425.1241 (ms) / GPU bubble ratio: 17.01%
[rank2]:2025-11-02 05:20:34,089 - INFO - Avg. fwd time: 7.1774 / Avg. bwd time: 16.6519 / Avg. batch time: 515.3356 (ms) / GPU bubble ratio: 63.01%
[rank0]:2025-11-02 05:20:34,149 - INFO - Avg. fwd time: 7.7820 / Avg. bwd time: 19.4823 / Avg. batch time: 586.5523 (ms) / GPU bubble ratio: 62.81%
[rank1]:2025-11-02 05:20:34,118 - INFO - Avg. fwd time: 9.3606 / Avg. bwd time: 21.6898 / Avg. batch time: 551.9039 (ms) / GPU bubble ratio: 54.99%
[rank3]:2025-11-02 05:20:34,294 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/pipeline_schedule_adjustment/251102_0520_rank3_trend_line.svg
[rank1]:2025-11-02 05:20:34,297 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/pipeline_schedule_adjustment/251102_0520_rank1_trend_line.svg
[rank2]:2025-11-02 05:20:34,310 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/pipeline_schedule_adjustment/251102_0520_rank2_trend_line.svg
[rank2]:2025-11-02 05:20:34,320 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-02 05:20:34,322 - INFO -  step: 600  loss: -2.0000  grad_norm:  0.6841  memory:  6.55GiB(13.78%)  tps: 6,676  tflops: 50.85  mfu: 16.30%
[rank2]:2025-11-02 05:20:34,322 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-11-02 05:20:34,313 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/pipeline_schedule_adjustment/251102_0520_rank0_trend_line.svg
[rank0]:2025-11-02 05:20:34,320 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank0]:2025-11-02 05:20:34,321 - INFO -  step: 600  loss: -2.0000  grad_norm:  0.6841  memory: 13.35GiB(28.09%)  tps: 6,678  tflops: 50.86  mfu: 16.30%
[rank0]:2025-11-02 05:20:34,322 - INFO - ðŸ”Ž  Running validation at step 600
[rank1]:2025-11-02 05:20:34,320 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-11-02 05:20:34,322 - INFO -  step: 600  loss: -2.0000  grad_norm:  0.6841  memory:  9.40GiB(19.79%)  tps: 6,677  tflops: 50.85  mfu: 16.30%
[rank1]:2025-11-02 05:20:34,322 - INFO - ðŸ”Ž  Running validation at step 600
[rank3]:2025-11-02 05:20:34,516 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/pipeline_schedule/251102_0520_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 363.92 ms, GPU Bubble Ratio: 47.00%, 34.39%, 50.14%, 22.38%
[rank3]:2025-11-02 05:20:34,517 - INFO - 	> Batch Time: 363.92 ms (Average Freeze Ratio: 0.26)
[rank3]:2025-11-02 05:20:34,517 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 0.40/0.40, [MB7] 0.00/0.00
[rank3]:2025-11-02 05:20:37,004 - INFO -  step: 600  loss:  0.2531  grad_norm:  0.6841  memory: 16.39GiB(34.50%)  tps: 6,655  tflops: 50.68  mfu: 16.24%
[rank3]:2025-11-02 05:20:37,004 - INFO - ðŸ”Ž  Running validation at step 600
[rank3]:2025-11-02 05:20:56,219 - INFO - validate step: 600  loss:  0.9419  memory: 16.39GiB(34.50%)  tps: 21,319
[rank0]:2025-11-02 05:20:56,197 - INFO - validate step: 600  loss: -1.0000  memory: 13.35GiB(28.09%)  tps: 18,724
[rank1]:2025-11-02 05:20:56,214 - INFO - validate step: 600  loss: -1.0000  memory:  9.40GiB(19.79%)  tps: 18,710
[rank2]:2025-11-02 05:20:56,229 - INFO - validate step: 600  loss: -1.0000  memory:  6.55GiB(13.78%)  tps: 18,697
[rank0]:2025-11-02 05:20:56,302 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251102_0520_stage0_step600.svg
[rank1]:2025-11-02 05:20:56,302 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251102_0520_stage1_step600.svg
[rank2]:2025-11-02 05:20:56,302 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251102_0520_stage2_step600.svg
[rank3]:2025-11-02 05:20:56,421 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/pipeline_schedule/251102_0520_real_step600_rank3.svg
[rank3]:> Batch Time: 380.32 ms, GPU Bubble Ratio: 34.41%, 30.24%, 51.89%, 24.21%
[rank3]:2025-11-02 05:20:56,488 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251102_0520_stage3_step600.svg
[rank0]:2025-11-02 05:21:53,938 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-11-02 05:21:54,919 - INFO -  step: 650  loss: -2.0000  grad_norm:  1.0473  memory:  9.40GiB(19.79%)  tps: 6,977  tflops: 53.14  mfu: 17.03%
[rank2]:2025-11-02 05:21:54,915 - INFO -  step: 650  loss: -2.0000  grad_norm:  1.0473  memory:  6.55GiB(13.78%)  tps: 6,980  tflops: 53.16  mfu: 17.04%
[rank0]:2025-11-02 05:21:54,929 - INFO -  step: 650  loss: -2.0000  grad_norm:  1.0473  memory: 13.35GiB(28.09%)  tps: 6,974  tflops: 53.12  mfu: 17.02%
[rank3]:2025-11-02 05:21:57,381 - INFO -  step: 650  loss:  0.3921  grad_norm:  1.0473  memory: 16.39GiB(34.50%)  tps: 6,697  tflops: 51.01  mfu: 16.35%
[rank0]:2025-11-02 05:22:54,854 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 05:22:55,575 - INFO - Avg. fwd time: 13.0603 / Avg. bwd time: 29.9890 / Avg. batch time: 416.6915 (ms) / GPU bubble ratio: 17.35%
[rank0]:2025-11-02 05:22:55,669 - INFO - Avg. fwd time: 7.7389 / Avg. bwd time: 20.0360 / Avg. batch time: 584.2332 (ms) / GPU bubble ratio: 61.97%
[rank1]:2025-11-02 05:22:55,669 - INFO - Avg. fwd time: 9.4173 / Avg. bwd time: 21.2581 / Avg. batch time: 549.3056 (ms) / GPU bubble ratio: 55.32%
[rank2]:2025-11-02 05:22:55,634 - INFO - Avg. fwd time: 7.2009 / Avg. bwd time: 16.5002 / Avg. batch time: 513.0251 (ms) / GPU bubble ratio: 63.04%
[rank0]:2025-11-02 05:22:55,848 - INFO -  step: 700  loss: -2.0000  grad_norm:  3.7178  memory: 13.35GiB(28.09%)  tps: 6,724  tflops: 51.21  mfu: 16.41%
[rank1]:2025-11-02 05:22:55,836 - INFO -  step: 700  loss: -2.0000  grad_norm:  3.7178  memory:  9.40GiB(19.79%)  tps: 6,724  tflops: 51.21  mfu: 16.41%
[rank2]:2025-11-02 05:22:55,832 - INFO -  step: 700  loss: -2.0000  grad_norm:  3.7178  memory:  6.55GiB(13.78%)  tps: 6,724  tflops: 51.21  mfu: 16.41%
[rank3]:2025-11-02 05:22:58,306 - INFO -  step: 700  loss:  0.2716  grad_norm:  3.7178  memory: 16.39GiB(34.50%)  tps: 6,723  tflops: 51.21  mfu: 16.41%
[rank0]:2025-11-02 05:22:58,380 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251102_0522_stage0_step700.svg
[rank1]:2025-11-02 05:22:58,380 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251102_0522_stage1_step700.svg
[rank2]:2025-11-02 05:22:58,381 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251102_0522_stage2_step700.svg
[rank3]:2025-11-02 05:22:58,513 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/pipeline_schedule/251102_0522_real_step700_rank3.svg
[rank3]:> Batch Time: 375.92 ms, GPU Bubble Ratio: 33.65%, 40.10%, 51.38%, 23.43%
[rank3]:2025-11-02 05:22:58,586 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251102_0522_stage3_step700.svg
[rank0]:2025-11-02 05:23:55,866 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-02 05:23:56,868 - INFO -  step: 750  loss: -2.0000  grad_norm:  0.5071  memory: 13.35GiB(28.09%)  tps: 6,713  tflops: 51.12  mfu: 16.39%
[rank1]:2025-11-02 05:23:56,857 - INFO -  step: 750  loss: -2.0000  grad_norm:  0.5071  memory:  9.40GiB(19.79%)  tps: 6,712  tflops: 51.12  mfu: 16.39%
[rank2]:2025-11-02 05:23:56,854 - INFO -  step: 750  loss: -2.0000  grad_norm:  0.5071  memory:  6.55GiB(13.78%)  tps: 6,712  tflops: 51.12  mfu: 16.39%
[rank3]:2025-11-02 05:23:59,311 - INFO -  step: 750  loss:  0.2582  grad_norm:  0.5071  memory: 16.39GiB(34.50%)  tps: 6,714  tflops: 51.14  mfu: 16.39%
[rank0]:2025-11-02 05:24:56,646 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 05:24:57,378 - INFO - Avg. fwd time: 13.1097 / Avg. bwd time: 29.0127 / Avg. batch time: 409.2554 (ms) / GPU bubble ratio: 17.66%
[rank1]:2025-11-02 05:24:57,473 - INFO - Avg. fwd time: 9.4660 / Avg. bwd time: 20.8710 / Avg. batch time: 547.8959 (ms) / GPU bubble ratio: 55.70%
[rank2]:2025-11-02 05:24:57,438 - INFO - Avg. fwd time: 7.2212 / Avg. bwd time: 16.3659 / Avg. batch time: 511.8729 (ms) / GPU bubble ratio: 63.14%
[rank0]:2025-11-02 05:24:57,474 - INFO - Avg. fwd time: 7.7001 / Avg. bwd time: 20.5219 / Avg. batch time: 583.0634 (ms) / GPU bubble ratio: 61.28%
[rank3]:2025-11-02 05:24:57,797 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/pipeline_schedule_adjustment/251102_0524_rank3_trend_line.svg
[rank0]:2025-11-02 05:24:57,833 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/pipeline_schedule_adjustment/251102_0524_rank0_trend_line.svg
[rank0]:2025-11-02 05:24:57,841 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-11-02 05:24:57,843 - INFO -  step: 800  loss: -2.0000  grad_norm:  0.6160  memory: 13.35GiB(28.09%)  tps: 6,718  tflops: 51.16  mfu: 16.40%
[rank0]:2025-11-02 05:24:57,843 - INFO - ðŸ”Ž  Running validation at step 800
[rank1]:2025-11-02 05:24:57,806 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/pipeline_schedule_adjustment/251102_0524_rank1_trend_line.svg
[rank1]:2025-11-02 05:24:57,841 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank1]:2025-11-02 05:24:57,843 - INFO -  step: 800  loss: -2.0000  grad_norm:  0.6160  memory:  9.40GiB(19.79%)  tps: 6,716  tflops: 51.15  mfu: 16.40%
[rank1]:2025-11-02 05:24:57,843 - INFO - ðŸ”Ž  Running validation at step 800
[rank2]:2025-11-02 05:24:57,799 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/pipeline_schedule_adjustment/251102_0524_rank2_trend_line.svg
[rank2]:2025-11-02 05:24:57,841 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-02 05:24:57,843 - INFO -  step: 800  loss: -2.0000  grad_norm:  0.6160  memory:  6.55GiB(13.78%)  tps: 6,716  tflops: 51.15  mfu: 16.39%
[rank2]:2025-11-02 05:24:57,843 - INFO - ðŸ”Ž  Running validation at step 800
[rank3]:2025-11-02 05:24:58,038 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/pipeline_schedule/251102_0524_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 364.34 ms, GPU Bubble Ratio: 40.68%, 36.70%, 50.45%, 22.65%
[rank3]:2025-11-02 05:24:58,038 - INFO - 	> Batch Time: 364.34 ms (Average Freeze Ratio: 0.26)
[rank3]:2025-11-02 05:24:58,039 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 0.40/0.40, [MB7] 0.00/0.00
[rank3]:2025-11-02 05:25:00,515 - INFO -  step: 800  loss:  0.2947  grad_norm:  0.6160  memory: 16.39GiB(34.50%)  tps: 6,693  tflops: 50.97  mfu: 16.34%
[rank3]:2025-11-02 05:25:00,515 - INFO - ðŸ”Ž  Running validation at step 800
[rank3]:2025-11-02 05:25:19,658 - INFO - validate step: 800  loss:  0.9374  memory: 16.39GiB(34.50%)  tps: 21,397
[rank0]:2025-11-02 05:25:19,638 - INFO - validate step: 800  loss: -1.0000  memory: 13.35GiB(28.09%)  tps: 18,794
[rank1]:2025-11-02 05:25:19,653 - INFO - validate step: 800  loss: -1.0000  memory:  9.40GiB(19.79%)  tps: 18,780
[rank2]:2025-11-02 05:25:19,670 - INFO - validate step: 800  loss: -1.0000  memory:  6.55GiB(13.78%)  tps: 18,766
[rank0]:2025-11-02 05:25:19,748 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251102_0525_stage0_step800.svg
[rank1]:2025-11-02 05:25:19,748 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251102_0525_stage1_step800.svg
[rank2]:2025-11-02 05:25:19,748 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251102_0525_stage2_step800.svg
[rank3]:2025-11-02 05:25:19,863 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/pipeline_schedule/251102_0525_real_step800_rank3.svg
[rank3]:> Batch Time: 376.87 ms, GPU Bubble Ratio: 33.96%, 40.39%, 51.48%, 23.34%
[rank3]:2025-11-02 05:25:19,934 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251102_0525_stage3_step800.svg
[rank3]:2025-11-02 05:25:32,455 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-11-02 05:25:32,680 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-11-02 05:25:32,662 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-11-02 05:25:32,640 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-11-02 05:26:17,019 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-11-02 05:26:17,979 - INFO -  step: 850  loss: -2.0000  grad_norm:  1.1312  memory:  9.40GiB(19.79%)  tps: 7,023  tflops: 53.49  mfu: 17.14%
[rank2]:2025-11-02 05:26:17,975 - INFO -  step: 850  loss: -2.0000  grad_norm:  1.1312  memory:  6.55GiB(13.78%)  tps: 7,025  tflops: 53.51  mfu: 17.15%
[rank0]:2025-11-02 05:26:17,990 - INFO -  step: 850  loss: -2.0000  grad_norm:  1.1312  memory: 13.35GiB(28.09%)  tps: 7,019  tflops: 53.46  mfu: 17.14%
[rank3]:2025-11-02 05:26:20,431 - INFO -  step: 850  loss:  0.2457  grad_norm:  1.1312  memory: 16.39GiB(34.50%)  tps: 6,740  tflops: 51.33  mfu: 16.45%
[rank0]:2025-11-02 05:27:17,480 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 05:27:18,370 - INFO - Avg. fwd time: 13.1502 / Avg. bwd time: 28.2615 / Avg. batch time: 403.5230 (ms) / GPU bubble ratio: 17.90%
[rank0]:2025-11-02 05:27:18,452 - INFO - Avg. fwd time: 7.7541 / Avg. bwd time: 19.4553 / Avg. batch time: 580.5090 (ms) / GPU bubble ratio: 62.50%
[rank1]:2025-11-02 05:27:18,429 - INFO - Avg. fwd time: 9.4409 / Avg. bwd time: 21.2098 / Avg. batch time: 545.9811 (ms) / GPU bubble ratio: 55.09%
[rank2]:2025-11-02 05:27:18,392 - INFO - Avg. fwd time: 7.2371 / Avg. bwd time: 16.2635 / Avg. batch time: 509.7140 (ms) / GPU bubble ratio: 63.12%
[rank2]:2025-11-02 05:27:18,474 - INFO -  step: 900  loss: -2.0000  grad_norm:  2.1624  memory:  6.55GiB(13.78%)  tps: 6,770  tflops: 51.57  mfu: 16.53%
[rank0]:2025-11-02 05:27:18,488 - INFO -  step: 900  loss: -2.0000  grad_norm:  2.1624  memory: 13.35GiB(28.09%)  tps: 6,770  tflops: 51.57  mfu: 16.53%
[rank1]:2025-11-02 05:27:18,480 - INFO -  step: 900  loss: -2.0000  grad_norm:  2.1624  memory:  9.40GiB(19.79%)  tps: 6,770  tflops: 51.56  mfu: 16.53%
[rank3]:2025-11-02 05:27:20,934 - INFO -  step: 900  loss:  0.2618  grad_norm:  2.1624  memory: 16.39GiB(34.50%)  tps: 6,770  tflops: 51.56  mfu: 16.53%
[rank0]:2025-11-02 05:27:21,003 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251102_0527_stage0_step900.svg
[rank1]:2025-11-02 05:27:21,002 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251102_0527_stage1_step900.svg
[rank2]:2025-11-02 05:27:21,002 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251102_0527_stage2_step900.svg
[rank3]:2025-11-02 05:27:21,125 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/pipeline_schedule/251102_0527_real_step900_rank3.svg
[rank3]:> Batch Time: 371.72 ms, GPU Bubble Ratio: 59.39%, 28.76%, 50.85%, 22.69%
[rank3]:2025-11-02 05:27:21,188 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251102_0527_stage3_step900.svg
[rank0]:2025-11-02 05:28:18,190 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-02 05:28:19,184 - INFO -  step: 950  loss: -2.0000  grad_norm:  0.3656  memory: 13.35GiB(28.09%)  tps: 6,748  tflops: 51.40  mfu: 16.47%
[rank2]:2025-11-02 05:28:19,170 - INFO -  step: 950  loss: -2.0000  grad_norm:  0.3656  memory:  6.55GiB(13.78%)  tps: 6,748  tflops: 51.40  mfu: 16.47%
[rank1]:2025-11-02 05:28:19,174 - INFO -  step: 950  loss: -2.0000  grad_norm:  0.3656  memory:  9.40GiB(19.79%)  tps: 6,749  tflops: 51.40  mfu: 16.47%
[rank3]:2025-11-02 05:28:21,645 - INFO -  step: 950  loss:  0.2304  grad_norm:  0.3656  memory: 16.39GiB(34.50%)  tps: 6,747  tflops: 51.39  mfu: 16.47%
[rank0]:2025-11-02 05:29:18,643 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 05:29:19,434 - INFO - Avg. fwd time: 7.2492 / Avg. bwd time: 16.1952 / Avg. batch time: 508.5298 (ms) / GPU bubble ratio: 63.12%
[rank3]:2025-11-02 05:29:19,374 - INFO - Avg. fwd time: 13.1791 / Avg. bwd time: 27.7471 / Avg. batch time: 399.6035 (ms) / GPU bubble ratio: 18.07%
[rank0]:2025-11-02 05:29:19,469 - INFO - Avg. fwd time: 7.7953 / Avg. bwd time: 18.6588 / Avg. batch time: 579.0345 (ms) / GPU bubble ratio: 63.45%
[rank1]:2025-11-02 05:29:19,474 - INFO - Avg. fwd time: 9.4223 / Avg. bwd time: 21.4742 / Avg. batch time: 544.9805 (ms) / GPU bubble ratio: 54.65%
[rank2]:2025-11-02 05:29:19,630 - INFO -  step: 1000  loss: -2.0000  grad_norm:  0.3339  memory:  6.55GiB(13.78%)  tps: 6,775  tflops: 51.60  mfu: 16.54%
[rank2]:2025-11-02 05:29:19,630 - INFO - ðŸ”Ž  Running validation at step 1000
[rank1]:2025-11-02 05:29:19,634 - INFO -  step: 1000  loss: -2.0000  grad_norm:  0.3339  memory:  9.40GiB(19.79%)  tps: 6,775  tflops: 51.60  mfu: 16.54%
[rank1]:2025-11-02 05:29:19,634 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-11-02 05:29:19,644 - INFO -  step: 1000  loss: -2.0000  grad_norm:  0.3339  memory: 13.35GiB(28.09%)  tps: 6,775  tflops: 51.60  mfu: 16.54%
[rank0]:2025-11-02 05:29:19,644 - INFO - ðŸ”Ž  Running validation at step 1000
[rank3]:2025-11-02 05:29:22,083 - INFO -  step: 1000  loss:  0.3121  grad_norm:  0.3339  memory: 16.39GiB(34.50%)  tps: 6,777  tflops: 51.62  mfu: 16.54%
[rank3]:2025-11-02 05:29:22,083 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-11-02 05:29:41,235 - INFO - validate step: 1000  loss: -1.0000  memory: 13.35GiB(28.09%)  tps: 18,971
[rank1]:2025-11-02 05:29:41,249 - INFO - validate step: 1000  loss: -1.0000  memory:  9.40GiB(19.79%)  tps: 18,950
[rank3]:2025-11-02 05:29:41,255 - INFO - validate step: 1000  loss:  0.9432  memory: 16.39GiB(34.50%)  tps: 21,366
[rank0]:2025-11-02 05:29:41,341 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251102_0529_stage0_step1000.svg
[rank2]:2025-11-02 05:29:41,271 - INFO - validate step: 1000  loss: -1.0000  memory:  6.55GiB(13.78%)  tps: 18,927
[rank2]:2025-11-02 05:29:41,341 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251102_0529_stage2_step1000.svg
[rank1]:2025-11-02 05:29:41,340 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251102_0529_stage1_step1000.svg
[rank3]:2025-11-02 05:29:41,458 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/pipeline_schedule/251102_0529_real_step1000_rank3.svg
[rank3]:> Batch Time: 373.12 ms, GPU Bubble Ratio: 59.46%, 28.69%, 50.94%, 22.68%
[rank3]:2025-11-02 05:29:41,522 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251102_0529_stage3_step1000.svg
[rank0]:2025-11-02 05:30:38,519 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-11-02 05:30:39,511 - INFO -  step: 1050  loss: -2.0000  grad_norm:  0.3792  memory: 13.35GiB(28.09%)  tps: 7,029  tflops: 53.53  mfu: 17.16%
[rank1]:2025-11-02 05:30:39,499 - INFO -  step: 1050  loss: -2.0000  grad_norm:  0.3792  memory:  9.40GiB(19.79%)  tps: 7,032  tflops: 53.56  mfu: 17.17%
[rank2]:2025-11-02 05:30:39,496 - INFO -  step: 1050  loss: -2.0000  grad_norm:  0.3792  memory:  6.55GiB(13.78%)  tps: 7,035  tflops: 53.58  mfu: 17.17%
[rank3]:2025-11-02 05:30:41,925 - INFO -  step: 1050  loss:  0.3322  grad_norm:  0.3792  memory: 16.39GiB(34.50%)  tps: 6,751  tflops: 51.42  mfu: 16.48%
[rank0]:2025-11-02 05:31:38,894 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 05:31:39,613 - INFO - Avg. fwd time: 13.2078 / Avg. bwd time: 27.2510 / Avg. batch time: 395.8298 (ms) / GPU bubble ratio: 18.23%
[rank0]:2025-11-02 05:31:39,707 - INFO - Avg. fwd time: 7.8354 / Avg. bwd time: 17.8969 / Avg. batch time: 578.3027 (ms) / GPU bubble ratio: 64.40%
[rank1]:2025-11-02 05:31:39,711 - INFO - Avg. fwd time: 9.4053 / Avg. bwd time: 21.7326 / Avg. batch time: 544.6978 (ms) / GPU bubble ratio: 54.27%
[rank2]:2025-11-02 05:31:39,672 - INFO - Avg. fwd time: 7.2610 / Avg. bwd time: 16.1319 / Avg. batch time: 508.0583 (ms) / GPU bubble ratio: 63.16%
[rank0]:2025-11-02 05:31:39,879 - INFO -  step: 1100  loss: -2.0000  grad_norm:  0.3560  memory: 13.35GiB(28.09%)  tps: 6,785  tflops: 51.68  mfu: 16.56%
[rank1]:2025-11-02 05:31:39,868 - INFO -  step: 1100  loss: -2.0000  grad_norm:  0.3560  memory:  9.40GiB(19.79%)  tps: 6,785  tflops: 51.68  mfu: 16.56%
[rank2]:2025-11-02 05:31:39,864 - INFO -  step: 1100  loss: -2.0000  grad_norm:  0.3560  memory:  6.55GiB(13.78%)  tps: 6,785  tflops: 51.68  mfu: 16.56%
[rank3]:2025-11-02 05:31:42,315 - INFO -  step: 1100  loss:  0.3539  grad_norm:  0.3560  memory: 16.39GiB(34.50%)  tps: 6,783  tflops: 51.66  mfu: 16.56%
[rank0]:2025-11-02 05:31:42,388 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251102_0531_stage0_step1100.svg
[rank1]:2025-11-02 05:31:42,388 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251102_0531_stage1_step1100.svg
[rank2]:2025-11-02 05:31:42,393 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251102_0531_stage2_step1100.svg
[rank3]:2025-11-02 05:31:42,521 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/pipeline_schedule/251102_0531_real_step1100_rank3.svg
[rank3]:> Batch Time: 372.49 ms, GPU Bubble Ratio: 59.33%, 28.63%, 50.80%, 22.73%
[rank3]:2025-11-02 05:31:42,586 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251102_0531_stage3_step1100.svg
[rank0]:2025-11-02 05:32:39,454 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-02 05:32:40,446 - INFO -  step: 1150  loss: -2.0000  grad_norm:  0.4536  memory: 13.35GiB(28.09%)  tps: 6,763  tflops: 51.51  mfu: 16.51%
[rank1]:2025-11-02 05:32:40,437 - INFO -  step: 1150  loss: -2.0000  grad_norm:  0.4536  memory:  9.40GiB(19.79%)  tps: 6,763  tflops: 51.51  mfu: 16.51%
[rank2]:2025-11-02 05:32:40,432 - INFO -  step: 1150  loss: -2.0000  grad_norm:  0.4536  memory:  6.55GiB(13.78%)  tps: 6,763  tflops: 51.51  mfu: 16.51%
[rank3]:2025-11-02 05:32:42,964 - INFO -  step: 1150  loss:  0.2828  grad_norm:  0.4536  memory: 16.39GiB(34.50%)  tps: 6,754  tflops: 51.44  mfu: 16.49%
[rank0]:2025-11-02 05:33:39,829 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-02 05:33:40,782 - INFO - Avg. fwd time: 9.3901 / Avg. bwd time: 21.9451 / Avg. batch time: 543.4188 (ms) / GPU bubble ratio: 53.87%
[rank2]:2025-11-02 05:33:40,752 - INFO - Avg. fwd time: 7.2699 / Avg. bwd time: 16.0781 / Avg. batch time: 506.6237 (ms) / GPU bubble ratio: 63.13%
[rank3]:2025-11-02 05:33:40,729 - INFO - Avg. fwd time: 13.2285 / Avg. bwd time: 26.8371 / Avg. batch time: 392.6550 (ms) / GPU bubble ratio: 18.37%
[rank0]:2025-11-02 05:33:40,806 - INFO - Avg. fwd time: 7.8677 / Avg. bwd time: 17.2678 / Avg. batch time: 576.6530 (ms) / GPU bubble ratio: 65.13%
[rank1]:2025-11-02 05:33:41,090 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/pipeline_schedule_adjustment/251102_0533_rank1_trend_line.svg
[rank2]:2025-11-02 05:33:41,063 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/pipeline_schedule_adjustment/251102_0533_rank2_trend_line.svg
[rank3]:2025-11-02 05:33:41,061 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/pipeline_schedule_adjustment/251102_0533_rank3_trend_line.svg
[rank0]:2025-11-02 05:33:41,113 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/pipeline_schedule_adjustment/251102_0533_rank0_trend_line.svg
[rank0]:2025-11-02 05:33:41,120 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank0]:2025-11-02 05:33:41,122 - INFO -  step: 1200  loss: -2.0000  grad_norm:  0.3152  memory: 13.35GiB(28.09%)  tps: 6,751  tflops: 51.41  mfu: 16.48%
[rank0]:2025-11-02 05:33:41,123 - INFO - ðŸ”Ž  Running validation at step 1200
[rank1]:2025-11-02 05:33:41,120 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-11-02 05:33:41,123 - INFO -  step: 1200  loss: -2.0000  grad_norm:  0.3152  memory:  9.40GiB(19.79%)  tps: 6,750  tflops: 51.41  mfu: 16.48%
[rank1]:2025-11-02 05:33:41,123 - INFO - ðŸ”Ž  Running validation at step 1200
[rank2]:2025-11-02 05:33:41,120 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-02 05:33:41,123 - INFO -  step: 1200  loss: -2.0000  grad_norm:  0.3152  memory:  6.55GiB(13.78%)  tps: 6,749  tflops: 51.40  mfu: 16.47%
[rank2]:2025-11-02 05:33:41,123 - INFO - ðŸ”Ž  Running validation at step 1200
[rank3]:2025-11-02 05:33:41,319 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/pipeline_schedule/251102_0533_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 360.88 ms, GPU Bubble Ratio: 49.28%, 32.00%, 50.13%, 22.11%
[rank3]:2025-11-02 05:33:41,320 - INFO - 	> Batch Time: 360.88 ms (Average Freeze Ratio: 0.26)
[rank3]:2025-11-02 05:33:41,320 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 0.40/0.40, [MB7] 0.00/0.00
[rank3]:2025-11-02 05:33:43,783 - INFO -  step: 1200  loss:  0.2124  grad_norm:  0.3152  memory: 16.39GiB(34.50%)  tps: 6,735  tflops: 51.29  mfu: 16.44%
[rank3]:2025-11-02 05:33:43,784 - INFO - ðŸ”Ž  Running validation at step 1200
[rank0]:2025-11-02 05:34:02,977 - INFO - validate step: 1200  loss: -1.0000  memory: 13.35GiB(28.09%)  tps: 18,743
[rank0]:2025-11-02 05:34:02,977 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-02 05:34:02,986 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank1]:2025-11-02 05:34:02,989 - INFO - validate step: 1200  loss: -1.0000  memory:  9.40GiB(19.79%)  tps: 18,732
[rank1]:2025-11-02 05:34:02,990 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-02 05:34:03,004 - INFO - validate step: 1200  loss: -1.0000  memory:  6.55GiB(13.78%)  tps: 18,720
[rank2]:2025-11-02 05:34:03,005 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-11-02 05:34:02,992 - INFO - validate step: 1200  loss:  0.9516  memory: 16.39GiB(34.50%)  tps: 21,325
[rank3]:2025-11-02 05:34:02,993 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-02 05:34:04,811 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 1.81 seconds.
[rank1]:2025-11-02 05:34:05,291 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 2.30 seconds.
[rank3]:2025-11-02 05:34:06,195 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.20 seconds.
[rank0]:2025-11-02 05:34:07,161 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-11-02 05:34:07,170 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 4.19 seconds.
[rank1]:2025-11-02 05:34:07,247 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251102_0534_stage1_step1200.svg
[rank2]:2025-11-02 05:34:07,248 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251102_0534_stage2_step1200.svg
[rank0]:2025-11-02 05:34:07,387 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251102_0534_stage0_step1200.svg
[rank3]:2025-11-02 05:34:07,502 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/pipeline_schedule/251102_0534_real_step1200_rank3.svg
[rank3]:> Batch Time: 372.59 ms, GPU Bubble Ratio: 59.43%, 28.72%, 50.85%, 22.71%
[rank3]:2025-11-02 05:34:07,573 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251102_0534_stage3_step1200.svg
[rank0]:2025-11-02 05:35:06,169 - INFO - [GC] Peforming periodical GC collection 0.22 seconds
[rank0]:2025-11-02 05:35:07,162 - INFO -  step: 1250  loss: -2.0000  grad_norm:  0.8302  memory: 13.35GiB(28.09%)  tps: 6,382  tflops: 48.60  mfu: 15.58%
[rank1]:2025-11-02 05:35:07,151 - INFO -  step: 1250  loss: -2.0000  grad_norm:  0.8302  memory:  9.40GiB(19.79%)  tps: 6,384  tflops: 48.62  mfu: 15.58%
[rank2]:2025-11-02 05:35:07,147 - INFO -  step: 1250  loss: -2.0000  grad_norm:  0.8302  memory:  6.55GiB(13.78%)  tps: 6,386  tflops: 48.64  mfu: 15.59%
[rank3]:2025-11-02 05:35:09,638 - INFO -  step: 1250  loss:  0.3249  grad_norm:  0.8302  memory: 16.39GiB(34.50%)  tps: 6,146  tflops: 46.81  mfu: 15.00%
[rank0]:2025-11-02 05:36:06,878 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 05:36:07,606 - INFO - Avg. fwd time: 13.2444 / Avg. bwd time: 26.5506 / Avg. batch time: 390.5055 (ms) / GPU bubble ratio: 18.47%
[rank2]:2025-11-02 05:36:07,665 - INFO - Avg. fwd time: 7.2766 / Avg. bwd time: 16.0389 / Avg. batch time: 506.2480 (ms) / GPU bubble ratio: 63.16%
[rank0]:2025-11-02 05:36:07,701 - INFO - Avg. fwd time: 7.8410 / Avg. bwd time: 17.7144 / Avg. batch time: 576.3867 (ms) / GPU bubble ratio: 64.53%
[rank1]:2025-11-02 05:36:07,701 - INFO - Avg. fwd time: 9.4172 / Avg. bwd time: 21.6981 / Avg. batch time: 542.8869 (ms) / GPU bubble ratio: 54.15%
[rank1]:2025-11-02 05:36:07,864 - INFO -  step: 1300  loss: -2.0000  grad_norm:  1.0170  memory:  9.40GiB(19.79%)  tps: 6,747  tflops: 51.38  mfu: 16.47%
[rank2]:2025-11-02 05:36:07,860 - INFO -  step: 1300  loss: -2.0000  grad_norm:  1.0170  memory:  6.55GiB(13.78%)  tps: 6,747  tflops: 51.38  mfu: 16.47%
[rank0]:2025-11-02 05:36:07,875 - INFO -  step: 1300  loss: -2.0000  grad_norm:  1.0170  memory: 13.35GiB(28.09%)  tps: 6,746  tflops: 51.38  mfu: 16.47%
[rank3]:2025-11-02 05:36:10,295 - INFO -  step: 1300  loss:  0.2927  grad_norm:  1.0170  memory: 16.39GiB(34.50%)  tps: 6,753  tflops: 51.43  mfu: 16.48%
[rank1]:2025-11-02 05:36:10,370 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251102_0536_stage1_step1300.svg
[rank2]:2025-11-02 05:36:10,371 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251102_0536_stage2_step1300.svg
[rank0]:2025-11-02 05:36:10,370 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251102_0536_stage0_step1300.svg
[rank3]:2025-11-02 05:36:10,492 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/pipeline_schedule/251102_0536_real_step1300_rank3.svg
[rank3]:> Batch Time: 376.36 ms, GPU Bubble Ratio: 33.59%, 40.15%, 51.31%, 23.53%
[rank3]:2025-11-02 05:36:10,559 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251102_0536_stage3_step1300.svg
[rank0]:2025-11-02 05:37:07,832 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-02 05:37:08,830 - INFO -  step: 1350  loss: -2.0000  grad_norm:  1.0356  memory:  9.40GiB(19.79%)  tps: 6,719  tflops: 51.17  mfu: 16.40%
[rank2]:2025-11-02 05:37:08,826 - INFO -  step: 1350  loss: -2.0000  grad_norm:  1.0356  memory:  6.55GiB(13.78%)  tps: 6,718  tflops: 51.17  mfu: 16.40%
[rank0]:2025-11-02 05:37:08,841 - INFO -  step: 1350  loss: -2.0000  grad_norm:  1.0356  memory: 13.35GiB(28.09%)  tps: 6,719  tflops: 51.17  mfu: 16.40%
[rank3]:2025-11-02 05:37:11,274 - INFO -  step: 1350  loss:  0.3012  grad_norm:  1.0356  memory: 16.39GiB(34.50%)  tps: 6,717  tflops: 51.16  mfu: 16.40%
[rank0]:2025-11-02 05:38:08,505 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 05:38:09,247 - INFO - Avg. fwd time: 13.2610 / Avg. bwd time: 26.2506 / Avg. batch time: 388.2360 (ms) / GPU bubble ratio: 18.58%
[rank2]:2025-11-02 05:38:09,308 - INFO - Avg. fwd time: 7.2835 / Avg. bwd time: 16.0013 / Avg. batch time: 506.0243 (ms) / GPU bubble ratio: 63.19%
[rank1]:2025-11-02 05:38:09,344 - INFO - Avg. fwd time: 9.4454 / Avg. bwd time: 21.4505 / Avg. batch time: 542.5002 (ms) / GPU bubble ratio: 54.44%
[rank0]:2025-11-02 05:38:09,344 - INFO - Avg. fwd time: 7.8129 / Avg. bwd time: 18.1706 / Avg. batch time: 576.2529 (ms) / GPU bubble ratio: 63.93%
[rank2]:2025-11-02 05:38:09,505 - INFO -  step: 1400  loss: -2.0000  grad_norm:  0.6576  memory:  6.55GiB(13.78%)  tps: 6,750  tflops: 51.41  mfu: 16.48%
[rank2]:2025-11-02 05:38:09,505 - INFO - ðŸ”Ž  Running validation at step 1400
[rank1]:2025-11-02 05:38:09,509 - INFO -  step: 1400  loss: -2.0000  grad_norm:  0.6576  memory:  9.40GiB(19.79%)  tps: 6,750  tflops: 51.41  mfu: 16.48%
[rank1]:2025-11-02 05:38:09,509 - INFO - ðŸ”Ž  Running validation at step 1400
[rank0]:2025-11-02 05:38:09,521 - INFO -  step: 1400  loss: -2.0000  grad_norm:  0.6576  memory: 13.35GiB(28.09%)  tps: 6,750  tflops: 51.41  mfu: 16.48%
[rank0]:2025-11-02 05:38:09,521 - INFO - ðŸ”Ž  Running validation at step 1400
[rank3]:2025-11-02 05:38:11,952 - INFO -  step: 1400  loss:  0.2480  grad_norm:  0.6576  memory: 16.39GiB(34.50%)  tps: 6,751  tflops: 51.41  mfu: 16.48%
[rank3]:2025-11-02 05:38:11,953 - INFO - ðŸ”Ž  Running validation at step 1400
[rank3]:2025-11-02 05:38:31,089 - INFO - validate step: 1400  loss:  0.9504  memory: 16.39GiB(34.50%)  tps: 21,405
[rank1]:2025-11-02 05:38:31,085 - INFO - validate step: 1400  loss: -1.0000  memory:  9.40GiB(19.79%)  tps: 18,984
[rank0]:2025-11-02 05:38:31,070 - INFO - validate step: 1400  loss: -1.0000  memory: 13.35GiB(28.09%)  tps: 19,009
[rank2]:2025-11-02 05:38:31,101 - INFO - validate step: 1400  loss: -1.0000  memory:  6.55GiB(13.78%)  tps: 18,966
[rank2]:2025-11-02 05:38:31,180 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251102_0538_stage2_step1400.svg
[rank1]:2025-11-02 05:38:31,176 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251102_0538_stage1_step1400.svg
[rank0]:2025-11-02 05:38:31,177 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251102_0538_stage0_step1400.svg
[rank3]:2025-11-02 05:38:31,297 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/pipeline_schedule/251102_0538_real_step1400_rank3.svg
[rank3]:> Batch Time: 375.89 ms, GPU Bubble Ratio: 33.60%, 40.14%, 51.24%, 23.48%
[rank3]:2025-11-02 05:38:31,366 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251102_0538_stage3_step1400.svg
[rank0]:2025-11-02 05:39:28,757 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-11-02 05:39:29,731 - INFO -  step: 1450  loss: -2.0000  grad_norm:  2.1834  memory:  6.55GiB(13.78%)  tps: 6,986  tflops: 53.21  mfu: 17.05%
[rank1]:2025-11-02 05:39:29,734 - INFO -  step: 1450  loss: -2.0000  grad_norm:  2.1834  memory:  9.40GiB(19.79%)  tps: 6,984  tflops: 53.19  mfu: 17.05%
[rank0]:2025-11-02 05:39:29,745 - INFO -  step: 1450  loss: -2.0000  grad_norm:  2.1834  memory: 13.35GiB(28.09%)  tps: 6,981  tflops: 53.17  mfu: 17.04%
[rank3]:2025-11-02 05:39:32,176 - INFO -  step: 1450  loss:  0.2648  grad_norm:  2.1834  memory: 16.39GiB(34.50%)  tps: 6,705  tflops: 51.07  mfu: 16.37%
[rank0]:2025-11-02 05:40:29,519 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 05:40:30,441 - INFO - Avg. fwd time: 7.2898 / Avg. bwd time: 15.9691 / Avg. batch time: 505.1040 (ms) / GPU bubble ratio: 63.16%
[rank3]:2025-11-02 05:40:30,417 - INFO - Avg. fwd time: 13.2750 / Avg. bwd time: 25.9934 / Avg. batch time: 386.2896 (ms) / GPU bubble ratio: 18.68%
[rank0]:2025-11-02 05:40:30,500 - INFO - Avg. fwd time: 7.7886 / Avg. bwd time: 18.5635 / Avg. batch time: 575.4168 (ms) / GPU bubble ratio: 63.36%
[rank1]:2025-11-02 05:40:30,468 - INFO - Avg. fwd time: 9.4696 / Avg. bwd time: 21.2384 / Avg. batch time: 541.4476 (ms) / GPU bubble ratio: 54.63%
[rank1]:2025-11-02 05:40:30,526 - INFO -  step: 1500  loss: -2.0000  grad_norm:  2.0200  memory:  9.40GiB(19.79%)  tps: 6,738  tflops: 51.32  mfu: 16.45%
[rank2]:2025-11-02 05:40:30,523 - INFO -  step: 1500  loss: -2.0000  grad_norm:  2.0200  memory:  6.55GiB(13.78%)  tps: 6,738  tflops: 51.32  mfu: 16.45%
[rank0]:2025-11-02 05:40:30,537 - INFO -  step: 1500  loss: -2.0000  grad_norm:  2.0200  memory: 13.35GiB(28.09%)  tps: 6,738  tflops: 51.32  mfu: 16.45%
[rank3]:2025-11-02 05:40:32,956 - INFO -  step: 1500  loss:  0.2900  grad_norm:  2.0200  memory: 16.39GiB(34.50%)  tps: 6,739  tflops: 51.33  mfu: 16.45%
[rank1]:2025-11-02 05:40:33,032 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251102_0540_stage1_step1500.svg
[rank2]:2025-11-02 05:40:33,034 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251102_0540_stage2_step1500.svg
[rank0]:2025-11-02 05:40:33,032 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251102_0540_stage0_step1500.svg
[rank3]:2025-11-02 05:40:33,155 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/pipeline_schedule/251102_0540_real_step1500_rank3.svg
[rank3]:> Batch Time: 376.28 ms, GPU Bubble Ratio: 33.70%, 40.24%, 51.31%, 23.44%
[rank3]:2025-11-02 05:40:33,227 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251102_0540_stage3_step1500.svg
[rank0]:2025-11-02 05:41:30,367 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-02 05:41:31,368 - INFO -  step: 1550  loss: -2.0000  grad_norm:  0.5069  memory: 13.35GiB(28.09%)  tps: 6,733  tflops: 51.28  mfu: 16.44%
[rank1]:2025-11-02 05:41:31,357 - INFO -  step: 1550  loss: -2.0000  grad_norm:  0.5069  memory:  9.40GiB(19.79%)  tps: 6,733  tflops: 51.28  mfu: 16.44%
[rank2]:2025-11-02 05:41:31,354 - INFO -  step: 1550  loss: -2.0000  grad_norm:  0.5069  memory:  6.55GiB(13.78%)  tps: 6,733  tflops: 51.28  mfu: 16.44%
[rank3]:2025-11-02 05:41:33,799 - INFO -  step: 1550  loss:  0.2682  grad_norm:  0.5069  memory: 16.39GiB(34.50%)  tps: 6,732  tflops: 51.28  mfu: 16.43%
[rank0]:2025-11-02 05:42:30,945 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 05:42:31,685 - INFO - Avg. fwd time: 13.2855 / Avg. bwd time: 25.7971 / Avg. batch time: 384.8029 (ms) / GPU bubble ratio: 18.75%
[rank1]:2025-11-02 05:42:31,783 - INFO - Avg. fwd time: 9.4870 / Avg. bwd time: 21.0763 / Avg. batch time: 540.7407 (ms) / GPU bubble ratio: 54.78%
[rank2]:2025-11-02 05:42:31,747 - INFO - Avg. fwd time: 7.2940 / Avg. bwd time: 15.9443 / Avg. batch time: 504.5060 (ms) / GPU bubble ratio: 63.15%
[rank0]:2025-11-02 05:42:31,783 - INFO - Avg. fwd time: 7.7699 / Avg. bwd time: 18.8589 / Avg. batch time: 574.8709 (ms) / GPU bubble ratio: 62.94%
[rank1]:2025-11-02 05:42:32,296 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/pipeline_schedule_adjustment/251102_0542_rank1_trend_line.svg
[rank2]:2025-11-02 05:42:32,290 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/pipeline_schedule_adjustment/251102_0542_rank2_trend_line.svg
[rank3]:2025-11-02 05:42:32,252 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/pipeline_schedule_adjustment/251102_0542_rank3_trend_line.svg
[rank0]:2025-11-02 05:42:32,328 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/pipeline_schedule_adjustment/251102_0542_rank0_trend_line.svg
[rank0]:2025-11-02 05:42:32,336 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-11-02 05:42:32,339 - INFO -  step: 1600  loss: -2.0000  grad_norm:  0.6743  memory: 13.35GiB(28.09%)  tps: 6,718  tflops: 51.17  mfu: 16.40%
[rank0]:2025-11-02 05:42:32,339 - INFO - ðŸ”Ž  Running validation at step 1600
[rank1]:2025-11-02 05:42:32,336 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-11-02 05:42:32,339 - INFO -  step: 1600  loss: -2.0000  grad_norm:  0.6743  memory:  9.40GiB(19.79%)  tps: 6,717  tflops: 51.16  mfu: 16.40%
[rank1]:2025-11-02 05:42:32,339 - INFO - ðŸ”Ž  Running validation at step 1600
[rank2]:2025-11-02 05:42:32,336 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-02 05:42:32,338 - INFO -  step: 1600  loss: -2.0000  grad_norm:  0.6743  memory:  6.55GiB(13.78%)  tps: 6,716  tflops: 51.15  mfu: 16.40%
[rank2]:2025-11-02 05:42:32,339 - INFO - ðŸ”Ž  Running validation at step 1600
[rank3]:2025-11-02 05:42:32,532 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/pipeline_schedule/251102_0542_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 362.92 ms, GPU Bubble Ratio: 43.74%, 34.41%, 50.46%, 22.62%
[rank3]:2025-11-02 05:42:32,533 - INFO - 	> Batch Time: 362.92 ms (Average Freeze Ratio: 0.29)
[rank3]:2025-11-02 05:42:32,533 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 0.40/0.40, [MB7] 0.00/0.00
[rank3]:2025-11-02 05:42:34,965 - INFO -  step: 1600  loss:  0.2180  grad_norm:  0.6743  memory: 16.39GiB(34.50%)  tps: 6,697  tflops: 51.00  mfu: 16.35%
[rank3]:2025-11-02 05:42:34,965 - INFO - ðŸ”Ž  Running validation at step 1600
[rank0]:2025-11-02 05:42:54,069 - INFO - validate step: 1600  loss: -1.0000  memory: 13.35GiB(28.09%)  tps: 18,849
[rank1]:2025-11-02 05:42:54,084 - INFO - validate step: 1600  loss: -1.0000  memory:  9.40GiB(19.79%)  tps: 18,836
[rank2]:2025-11-02 05:42:54,102 - INFO - validate step: 1600  loss: -1.0000  memory:  6.55GiB(13.78%)  tps: 18,821
[rank3]:2025-11-02 05:42:54,090 - INFO - validate step: 1600  loss:  0.9536  memory: 16.39GiB(34.50%)  tps: 21,418
[rank0]:2025-11-02 05:42:54,180 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251102_0542_stage0_step1600.svg
[rank1]:2025-11-02 05:42:54,179 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251102_0542_stage1_step1600.svg
[rank2]:2025-11-02 05:42:54,181 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251102_0542_stage2_step1600.svg
[rank3]:2025-11-02 05:42:54,298 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/pipeline_schedule/251102_0542_real_step1600_rank3.svg
[rank3]:> Batch Time: 375.41 ms, GPU Bubble Ratio: 33.46%, 40.15%, 51.23%, 23.50%
[rank3]:2025-11-02 05:42:54,370 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251102_0542_stage3_step1600.svg
[rank3]:2025-11-02 05:43:19,522 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-11-02 05:43:19,727 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-11-02 05:43:19,706 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-11-02 05:43:19,746 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-11-02 05:43:50,926 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-11-02 05:43:51,904 - INFO -  step: 1650  loss: -2.0000  grad_norm:  1.2535  memory:  9.40GiB(19.79%)  tps: 7,084  tflops: 53.95  mfu: 17.29%
[rank2]:2025-11-02 05:43:51,896 - INFO -  step: 1650  loss: -2.0000  grad_norm:  1.2535  memory:  6.55GiB(13.78%)  tps: 7,087  tflops: 53.98  mfu: 17.30%
[rank0]:2025-11-02 05:43:51,911 - INFO -  step: 1650  loss: -2.0000  grad_norm:  1.2535  memory: 13.35GiB(28.09%)  tps: 7,081  tflops: 53.93  mfu: 17.29%
[rank3]:2025-11-02 05:43:54,319 - INFO -  step: 1650  loss:  0.3088  grad_norm:  1.2535  memory: 16.39GiB(34.50%)  tps: 6,801  tflops: 51.80  mfu: 16.60%
[rank0]:2025-11-02 05:44:50,850 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 05:44:51,571 - INFO - Avg. fwd time: 13.2951 / Avg. bwd time: 25.5990 / Avg. batch time: 383.2942 (ms) / GPU bubble ratio: 18.82%
[rank0]:2025-11-02 05:44:51,663 - INFO - Avg. fwd time: 7.7903 / Avg. bwd time: 18.4360 / Avg. batch time: 574.4586 (ms) / GPU bubble ratio: 63.48%
[rank1]:2025-11-02 05:44:51,663 - INFO - Avg. fwd time: 9.5059 / Avg. bwd time: 20.9085 / Avg. batch time: 540.5752 (ms) / GPU bubble ratio: 54.99%
[rank2]:2025-11-02 05:44:51,628 - INFO - Avg. fwd time: 7.2982 / Avg. bwd time: 15.9177 / Avg. batch time: 504.4516 (ms) / GPU bubble ratio: 63.18%
[rank2]:2025-11-02 05:44:51,815 - INFO -  step: 1700  loss: -2.0000  grad_norm:  0.3795  memory:  6.55GiB(13.78%)  tps: 6,836  tflops: 52.06  mfu: 16.69%
[rank0]:2025-11-02 05:44:51,832 - INFO -  step: 1700  loss: -2.0000  grad_norm:  0.3795  memory: 13.35GiB(28.09%)  tps: 6,836  tflops: 52.06  mfu: 16.69%
[rank1]:2025-11-02 05:44:51,819 - INFO -  step: 1700  loss: -2.0000  grad_norm:  0.3795  memory:  9.40GiB(19.79%)  tps: 6,836  tflops: 52.07  mfu: 16.69%
[rank3]:2025-11-02 05:44:54,246 - INFO -  step: 1700  loss:  0.2687  grad_norm:  0.3795  memory: 16.39GiB(34.50%)  tps: 6,835  tflops: 52.06  mfu: 16.69%
[rank2]:2025-11-02 05:44:54,326 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251102_0544_stage2_step1700.svg
[rank0]:2025-11-02 05:44:54,322 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251102_0544_stage0_step1700.svg
[rank1]:2025-11-02 05:44:54,321 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251102_0544_stage1_step1700.svg
[rank3]:2025-11-02 05:44:54,436 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/pipeline_schedule/251102_0544_real_step1700_rank3.svg
[rank3]:> Batch Time: 369.34 ms, GPU Bubble Ratio: 59.07%, 39.17%, 50.39%, 21.89%
[rank3]:2025-11-02 05:44:54,507 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251102_0544_stage3_step1700.svg
[rank0]:2025-11-02 05:45:51,058 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-02 05:45:52,042 - INFO -  step: 1750  loss: -2.0000  grad_norm:  0.2664  memory: 13.35GiB(28.09%)  tps: 6,803  tflops: 51.81  mfu: 16.61%
[rank1]:2025-11-02 05:45:52,032 - INFO -  step: 1750  loss: -2.0000  grad_norm:  0.2664  memory:  9.40GiB(19.79%)  tps: 6,803  tflops: 51.81  mfu: 16.61%
[rank2]:2025-11-02 05:45:52,028 - INFO -  step: 1750  loss: -2.0000  grad_norm:  0.2664  memory:  6.55GiB(13.78%)  tps: 6,803  tflops: 51.81  mfu: 16.61%
[rank3]:2025-11-02 05:45:54,479 - INFO -  step: 1750  loss:  0.2344  grad_norm:  0.2664  memory: 16.39GiB(34.50%)  tps: 6,800  tflops: 51.79  mfu: 16.60%
[rank0]:2025-11-02 05:46:51,049 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 05:46:51,956 - INFO - Avg. fwd time: 13.3056 / Avg. bwd time: 25.4228 / Avg. batch time: 381.9683 (ms) / GPU bubble ratio: 18.89%
[rank2]:2025-11-02 05:46:51,981 - INFO - Avg. fwd time: 7.3023 / Avg. bwd time: 15.8960 / Avg. batch time: 503.7302 (ms) / GPU bubble ratio: 63.16%
[rank1]:2025-11-02 05:46:52,009 - INFO - Avg. fwd time: 9.5231 / Avg. bwd time: 20.7624 / Avg. batch time: 539.7605 (ms) / GPU bubble ratio: 55.11%
[rank2]:2025-11-02 05:46:52,057 - INFO -  step: 1800  loss: -2.0000  grad_norm:  0.3034  memory:  6.55GiB(13.78%)  tps: 6,823  tflops: 51.97  mfu: 16.66%
[rank2]:2025-11-02 05:46:52,057 - INFO - ðŸ”Ž  Running validation at step 1800
[rank0]:2025-11-02 05:46:52,035 - INFO - Avg. fwd time: 7.8124 / Avg. bwd time: 17.9867 / Avg. batch time: 573.3873 (ms) / GPU bubble ratio: 64.00%
[rank0]:2025-11-02 05:46:52,071 - INFO -  step: 1800  loss: -2.0000  grad_norm:  0.3034  memory: 13.35GiB(28.09%)  tps: 6,823  tflops: 51.97  mfu: 16.66%
[rank0]:2025-11-02 05:46:52,071 - INFO - ðŸ”Ž  Running validation at step 1800
[rank1]:2025-11-02 05:46:52,061 - INFO -  step: 1800  loss: -2.0000  grad_norm:  0.3034  memory:  9.40GiB(19.79%)  tps: 6,823  tflops: 51.97  mfu: 16.66%
[rank1]:2025-11-02 05:46:52,061 - INFO - ðŸ”Ž  Running validation at step 1800
[rank3]:2025-11-02 05:46:54,503 - INFO -  step: 1800  loss:  0.2137  grad_norm:  0.3034  memory: 16.39GiB(34.50%)  tps: 6,824  tflops: 51.97  mfu: 16.66%
[rank3]:2025-11-02 05:46:54,504 - INFO - ðŸ”Ž  Running validation at step 1800
[rank0]:2025-11-02 05:47:13,709 - INFO - validate step: 1800  loss: -1.0000  memory: 13.35GiB(28.09%)  tps: 18,930
[rank1]:2025-11-02 05:47:13,724 - INFO - validate step: 1800  loss: -1.0000  memory:  9.40GiB(19.79%)  tps: 18,908
[rank3]:2025-11-02 05:47:13,730 - INFO - validate step: 1800  loss:  0.9507  memory: 16.39GiB(34.50%)  tps: 21,305
[rank2]:2025-11-02 05:47:13,742 - INFO - validate step: 1800  loss: -1.0000  memory:  6.55GiB(13.78%)  tps: 18,889
[rank2]:2025-11-02 05:47:13,821 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251102_0547_stage2_step1800.svg
[rank0]:2025-11-02 05:47:13,821 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251102_0547_stage0_step1800.svg
[rank1]:2025-11-02 05:47:13,820 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251102_0547_stage1_step1800.svg
[rank3]:2025-11-02 05:47:13,934 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/pipeline_schedule/251102_0547_real_step1800_rank3.svg
[rank3]:> Batch Time: 370.05 ms, GPU Bubble Ratio: 59.11%, 39.12%, 50.41%, 21.90%
[rank3]:2025-11-02 05:47:14,005 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251102_0547_stage3_step1800.svg
[rank0]:2025-11-02 05:48:10,849 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-11-02 05:48:11,832 - INFO -  step: 1850  loss: -2.0000  grad_norm:  1.2737  memory: 13.35GiB(28.09%)  tps: 7,047  tflops: 53.67  mfu: 17.20%
[rank1]:2025-11-02 05:48:11,821 - INFO -  step: 1850  loss: -2.0000  grad_norm:  1.2737  memory:  9.40GiB(19.79%)  tps: 7,050  tflops: 53.70  mfu: 17.21%
[rank2]:2025-11-02 05:48:11,818 - INFO -  step: 1850  loss: -2.0000  grad_norm:  1.2737  memory:  6.55GiB(13.78%)  tps: 7,053  tflops: 53.72  mfu: 17.22%
[rank3]:2025-11-02 05:48:14,346 - INFO -  step: 1850  loss:  0.3124  grad_norm:  1.2737  memory: 16.39GiB(34.50%)  tps: 6,757  tflops: 51.47  mfu: 16.50%
[rank0]:2025-11-02 05:49:10,987 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 05:49:11,765 - INFO - Avg. fwd time: 7.3059 / Avg. bwd time: 15.8793 / Avg. batch time: 503.4696 (ms) / GPU bubble ratio: 63.16%
[rank3]:2025-11-02 05:49:11,705 - INFO - Avg. fwd time: 13.3158 / Avg. bwd time: 25.2901 / Avg. batch time: 380.9891 (ms) / GPU bubble ratio: 18.94%
[rank0]:2025-11-02 05:49:11,800 - INFO - Avg. fwd time: 7.8295 / Avg. bwd time: 17.6416 / Avg. batch time: 572.8587 (ms) / GPU bubble ratio: 64.43%
[rank1]:2025-11-02 05:49:11,800 - INFO - Avg. fwd time: 9.5370 / Avg. bwd time: 20.6505 / Avg. batch time: 539.4303 (ms) / GPU bubble ratio: 55.23%
[rank2]:2025-11-02 05:49:11,948 - INFO -  step: 1900  loss: -2.0000  grad_norm:  0.7222  memory:  6.55GiB(13.78%)  tps: 6,812  tflops: 51.88  mfu: 16.63%
[rank0]:2025-11-02 05:49:11,963 - INFO -  step: 1900  loss: -2.0000  grad_norm:  0.7222  memory: 13.35GiB(28.09%)  tps: 6,812  tflops: 51.88  mfu: 16.63%
[rank1]:2025-11-02 05:49:11,952 - INFO -  step: 1900  loss: -2.0000  grad_norm:  0.7222  memory:  9.40GiB(19.79%)  tps: 6,812  tflops: 51.88  mfu: 16.63%
[rank3]:2025-11-02 05:49:14,418 - INFO -  step: 1900  loss:  0.2201  grad_norm:  0.7222  memory: 16.39GiB(34.50%)  tps: 6,819  tflops: 51.93  mfu: 16.65%
[rank0]:2025-11-02 05:49:14,495 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251102_0549_stage0_step1900.svg
[rank1]:2025-11-02 05:49:14,495 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251102_0549_stage1_step1900.svg
[rank2]:2025-11-02 05:49:14,499 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251102_0549_stage2_step1900.svg
[rank3]:2025-11-02 05:49:14,629 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/pipeline_schedule/251102_0549_real_step1900_rank3.svg
[rank3]:> Batch Time: 368.63 ms, GPU Bubble Ratio: 58.99%, 38.98%, 50.26%, 21.95%
[rank3]:2025-11-02 05:49:14,707 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251102_0549_stage3_step1900.svg
[rank0]:2025-11-02 05:50:11,376 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 05:50:12,356 - INFO -  step: 1950  loss: -2.0000  grad_norm:  0.3036  memory:  6.55GiB(13.78%)  tps: 6,781  tflops: 51.64  mfu: 16.55%
[rank0]:2025-11-02 05:50:12,371 - INFO -  step: 1950  loss: -2.0000  grad_norm:  0.3036  memory: 13.35GiB(28.09%)  tps: 6,781  tflops: 51.64  mfu: 16.55%
[rank1]:2025-11-02 05:50:12,360 - INFO -  step: 1950  loss: -2.0000  grad_norm:  0.3036  memory:  9.40GiB(19.79%)  tps: 6,781  tflops: 51.64  mfu: 16.55%
[rank3]:2025-11-02 05:50:14,832 - INFO -  step: 1950  loss:  0.2021  grad_norm:  0.3036  memory: 16.39GiB(34.50%)  tps: 6,780  tflops: 51.64  mfu: 16.55%
[rank0]:2025-11-02 05:51:11,569 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 05:51:12,302 - INFO - Avg. fwd time: 13.3234 / Avg. bwd time: 25.1483 / Avg. batch time: 379.9151 (ms) / GPU bubble ratio: 18.99%
[rank1]:2025-11-02 05:51:12,398 - INFO - Avg. fwd time: 9.5504 / Avg. bwd time: 20.5310 / Avg. batch time: 539.4568 (ms) / GPU bubble ratio: 55.39%
[rank2]:2025-11-02 05:51:12,362 - INFO - Avg. fwd time: 7.3089 / Avg. bwd time: 15.8610 / Avg. batch time: 503.5732 (ms) / GPU bubble ratio: 63.19%
[rank0]:2025-11-02 05:51:12,397 - INFO - Avg. fwd time: 7.8465 / Avg. bwd time: 17.2773 / Avg. batch time: 572.6729 (ms) / GPU bubble ratio: 64.90%
[rank2]:2025-11-02 05:51:12,549 - INFO -  step: 2000  loss: -2.0000  grad_norm:  0.3448  memory:  6.55GiB(13.78%)  tps: 6,805  tflops: 51.83  mfu: 16.61%
[rank2]:2025-11-02 05:51:12,549 - INFO - ðŸ”Ž  Running validation at step 2000
[rank1]:2025-11-02 05:51:12,553 - INFO -  step: 2000  loss: -2.0000  grad_norm:  0.3448  memory:  9.40GiB(19.79%)  tps: 6,805  tflops: 51.83  mfu: 16.61%
[rank1]:2025-11-02 05:51:12,553 - INFO - ðŸ”Ž  Running validation at step 2000
[rank0]:2025-11-02 05:51:12,564 - INFO -  step: 2000  loss: -2.0000  grad_norm:  0.3448  memory: 13.35GiB(28.09%)  tps: 6,805  tflops: 51.83  mfu: 16.61%
[rank0]:2025-11-02 05:51:12,564 - INFO - ðŸ”Ž  Running validation at step 2000
[rank3]:2025-11-02 05:51:15,035 - INFO -  step: 2000  loss:  0.2614  grad_norm:  0.3448  memory: 16.39GiB(34.50%)  tps: 6,804  tflops: 51.82  mfu: 16.61%
[rank3]:2025-11-02 05:51:15,036 - INFO - ðŸ”Ž  Running validation at step 2000
[rank1]:2025-11-02 05:51:34,141 - INFO - validate step: 2000  loss: -1.0000  memory:  9.40GiB(19.79%)  tps: 18,973
[rank0]:2025-11-02 05:51:34,125 - INFO - validate step: 2000  loss: -1.0000  memory: 13.35GiB(28.09%)  tps: 18,997
[rank3]:2025-11-02 05:51:34,147 - INFO - validate step: 2000  loss:  0.9486  memory: 16.39GiB(34.50%)  tps: 21,433
[rank2]:2025-11-02 05:51:34,159 - INFO - validate step: 2000  loss: -1.0000  memory:  6.55GiB(13.78%)  tps: 18,955
[rank1]:2025-11-02 05:51:34,237 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251102_0551_stage1_step2000.svg
[rank0]:2025-11-02 05:51:34,238 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251102_0551_stage0_step2000.svg
[rank2]:2025-11-02 05:51:34,238 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251102_0551_stage2_step2000.svg
[rank3]:2025-11-02 05:51:34,362 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/pipeline_schedule/251102_0551_real_step2000_rank3.svg
[rank3]:> Batch Time: 368.55 ms, GPU Bubble Ratio: 59.08%, 39.03%, 50.31%, 21.94%
[rank3]:2025-11-02 05:51:34,441 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251102_0551_stage3_step2000.svg
[rank0]:2025-11-02 05:52:31,408 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-11-02 05:52:32,366 - INFO -  step: 2050  loss: -2.0000  grad_norm:  0.5175  memory:  9.40GiB(19.79%)  tps: 7,035  tflops: 53.58  mfu: 17.17%
[rank0]:2025-11-02 05:52:32,377 - INFO -  step: 2050  loss: -2.0000  grad_norm:  0.5175  memory: 13.35GiB(28.09%)  tps: 7,032  tflops: 53.55  mfu: 17.16%
[rank2]:2025-11-02 05:52:32,362 - INFO -  step: 2050  loss: -2.0000  grad_norm:  0.5175  memory:  6.55GiB(13.78%)  tps: 7,037  tflops: 53.60  mfu: 17.18%
[rank3]:2025-11-02 05:52:34,858 - INFO -  step: 2050  loss:  0.2254  grad_norm:  0.5175  memory: 16.39GiB(34.50%)  tps: 6,747  tflops: 51.39  mfu: 16.47%
[rank0]:2025-11-02 05:53:31,558 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-02 05:53:32,504 - INFO - Avg. fwd time: 9.5624 / Avg. bwd time: 20.4242 / Avg. batch time: 538.9545 (ms) / GPU bubble ratio: 55.49%
[rank3]:2025-11-02 05:53:32,450 - INFO - Avg. fwd time: 13.3319 / Avg. bwd time: 25.0221 / Avg. batch time: 378.9736 (ms) / GPU bubble ratio: 19.04%
[rank0]:2025-11-02 05:53:32,531 - INFO - Avg. fwd time: 7.8621 / Avg. bwd time: 16.9500 / Avg. batch time: 571.9822 (ms) / GPU bubble ratio: 65.30%
[rank2]:2025-11-02 05:53:32,476 - INFO - Avg. fwd time: 7.3120 / Avg. bwd time: 15.8452 / Avg. batch time: 503.1371 (ms) / GPU bubble ratio: 63.18%
[rank1]:2025-11-02 05:53:32,556 - INFO -  step: 2100  loss: -2.0000  grad_norm:  0.3538  memory:  9.40GiB(19.79%)  tps: 6,805  tflops: 51.83  mfu: 16.61%
[rank0]:2025-11-02 05:53:32,567 - INFO -  step: 2100  loss: -2.0000  grad_norm:  0.3538  memory: 13.35GiB(28.09%)  tps: 6,805  tflops: 51.83  mfu: 16.61%
[rank2]:2025-11-02 05:53:32,553 - INFO -  step: 2100  loss: -2.0000  grad_norm:  0.3538  memory:  6.55GiB(13.78%)  tps: 6,805  tflops: 51.83  mfu: 16.61%
[rank3]:2025-11-02 05:53:35,005 - INFO -  step: 2100  loss:  0.2585  grad_norm:  0.3538  memory: 16.39GiB(34.50%)  tps: 6,810  tflops: 51.87  mfu: 16.62%
[rank1]:2025-11-02 05:53:35,075 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251102_0553_stage1_step2100.svg
[rank0]:2025-11-02 05:53:35,076 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251102_0553_stage0_step2100.svg
[rank2]:2025-11-02 05:53:35,078 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251102_0553_stage2_step2100.svg
[rank3]:2025-11-02 05:53:35,204 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/pipeline_schedule/251102_0553_real_step2100_rank3.svg
[rank3]:> Batch Time: 368.37 ms, GPU Bubble Ratio: 58.99%, 38.94%, 50.24%, 22.02%
[rank3]:2025-11-02 05:53:35,271 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251102_0553_stage3_step2100.svg
[rank0]:2025-11-02 05:54:31,953 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-02 05:54:32,925 - INFO -  step: 2150  loss: -2.0000  grad_norm:  0.3721  memory:  9.40GiB(19.79%)  tps: 6,785  tflops: 51.68  mfu: 16.56%
[rank2]:2025-11-02 05:54:32,921 - INFO -  step: 2150  loss: -2.0000  grad_norm:  0.3721  memory:  6.55GiB(13.78%)  tps: 6,785  tflops: 51.68  mfu: 16.56%
[rank0]:2025-11-02 05:54:32,935 - INFO -  step: 2150  loss: -2.0000  grad_norm:  0.3721  memory: 13.35GiB(28.09%)  tps: 6,785  tflops: 51.68  mfu: 16.56%
[rank3]:2025-11-02 05:54:35,378 - INFO -  step: 2150  loss:  0.2285  grad_norm:  0.3721  memory: 16.39GiB(34.50%)  tps: 6,785  tflops: 51.67  mfu: 16.56%
[rank0]:2025-11-02 05:55:31,929 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 05:55:32,660 - INFO - Avg. fwd time: 13.3386 / Avg. bwd time: 24.9224 / Avg. batch time: 378.2298 (ms) / GPU bubble ratio: 19.07%
[rank1]:2025-11-02 05:55:32,757 - INFO - Avg. fwd time: 9.5719 / Avg. bwd time: 20.3412 / Avg. batch time: 538.6375 (ms) / GPU bubble ratio: 55.57%
[rank2]:2025-11-02 05:55:32,720 - INFO - Avg. fwd time: 7.3143 / Avg. bwd time: 15.8331 / Avg. batch time: 502.8707 (ms) / GPU bubble ratio: 63.18%
[rank0]:2025-11-02 05:55:32,755 - INFO - Avg. fwd time: 7.8741 / Avg. bwd time: 16.6944 / Avg. batch time: 571.5169 (ms) / GPU bubble ratio: 65.61%
[rank1]:2025-11-02 05:55:32,910 - INFO -  step: 2200  loss: -2.0000  grad_norm:  0.3456  memory:  9.40GiB(19.79%)  tps: 6,828  tflops: 52.01  mfu: 16.67%
[rank1]:2025-11-02 05:55:32,910 - INFO - ðŸ”Ž  Running validation at step 2200
[rank2]:2025-11-02 05:55:32,906 - INFO -  step: 2200  loss: -2.0000  grad_norm:  0.3456  memory:  6.55GiB(13.78%)  tps: 6,828  tflops: 52.01  mfu: 16.67%
[rank2]:2025-11-02 05:55:32,907 - INFO - ðŸ”Ž  Running validation at step 2200
[rank0]:2025-11-02 05:55:32,921 - INFO -  step: 2200  loss: -2.0000  grad_norm:  0.3456  memory: 13.35GiB(28.09%)  tps: 6,828  tflops: 52.01  mfu: 16.67%
[rank0]:2025-11-02 05:55:32,921 - INFO - ðŸ”Ž  Running validation at step 2200
[rank3]:2025-11-02 05:55:35,373 - INFO -  step: 2200  loss:  0.2671  grad_norm:  0.3456  memory: 16.39GiB(34.50%)  tps: 6,827  tflops: 52.00  mfu: 16.67%
[rank3]:2025-11-02 05:55:35,373 - INFO - ðŸ”Ž  Running validation at step 2200
[rank0]:2025-11-02 05:55:54,626 - INFO - validate step: 2200  loss: -1.0000  memory: 13.35GiB(28.09%)  tps: 18,871
[rank1]:2025-11-02 05:55:54,639 - INFO - validate step: 2200  loss: -1.0000  memory:  9.40GiB(19.79%)  tps: 18,851
[rank3]:2025-11-02 05:55:54,645 - INFO - validate step: 2200  loss:  0.9528  memory: 16.39GiB(34.50%)  tps: 21,255
[rank2]:2025-11-02 05:55:54,658 - INFO - validate step: 2200  loss: -1.0000  memory:  6.55GiB(13.78%)  tps: 18,832
[rank0]:2025-11-02 05:55:54,729 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251102_0555_stage0_step2200.svg
[rank1]:2025-11-02 05:55:54,728 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251102_0555_stage1_step2200.svg
[rank2]:2025-11-02 05:55:54,730 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251102_0555_stage2_step2200.svg
[rank3]:2025-11-02 05:55:54,850 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/pipeline_schedule/251102_0555_real_step2200_rank3.svg
[rank3]:> Batch Time: 368.52 ms, GPU Bubble Ratio: 59.02%, 38.96%, 50.23%, 21.97%
[rank3]:2025-11-02 05:55:54,919 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251102_0555_stage3_step2200.svg
[rank0]:2025-11-02 05:56:51,845 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-11-02 05:56:52,812 - INFO -  step: 2250  loss: -2.0000  grad_norm:  0.3250  memory:  9.40GiB(19.79%)  tps: 7,041  tflops: 53.63  mfu: 17.19%
[rank2]:2025-11-02 05:56:52,808 - INFO -  step: 2250  loss: -2.0000  grad_norm:  0.3250  memory:  6.55GiB(13.78%)  tps: 7,044  tflops: 53.65  mfu: 17.19%
[rank0]:2025-11-02 05:56:52,823 - INFO -  step: 2250  loss: -2.0000  grad_norm:  0.3250  memory: 13.35GiB(28.09%)  tps: 7,038  tflops: 53.61  mfu: 17.18%
[rank3]:2025-11-02 05:56:55,270 - INFO -  step: 2250  loss:  0.2454  grad_norm:  0.3250  memory: 16.39GiB(34.50%)  tps: 6,756  tflops: 51.46  mfu: 16.49%
[rank0]:2025-11-02 05:57:51,895 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 05:57:52,620 - INFO - Avg. fwd time: 13.3459 / Avg. bwd time: 24.8196 / Avg. batch time: 377.4660 (ms) / GPU bubble ratio: 19.11%
[rank1]:2025-11-02 05:57:52,715 - INFO - Avg. fwd time: 9.5822 / Avg. bwd time: 20.2535 / Avg. batch time: 538.7016 (ms) / GPU bubble ratio: 55.69%
[rank2]:2025-11-02 05:57:52,679 - INFO - Avg. fwd time: 7.3170 / Avg. bwd time: 15.8207 / Avg. batch time: 502.9903 (ms) / GPU bubble ratio: 63.20%
[rank0]:2025-11-02 05:57:52,714 - INFO - Avg. fwd time: 7.8874 / Avg. bwd time: 16.4221 / Avg. batch time: 571.4235 (ms) / GPU bubble ratio: 65.97%
[rank1]:2025-11-02 05:57:52,863 - INFO -  step: 2300  loss: -2.0000  grad_norm:  0.3758  memory:  9.40GiB(19.79%)  tps: 6,821  tflops: 51.95  mfu: 16.65%
[rank2]:2025-11-02 05:57:52,860 - INFO -  step: 2300  loss: -2.0000  grad_norm:  0.3758  memory:  6.55GiB(13.78%)  tps: 6,821  tflops: 51.95  mfu: 16.65%
[rank0]:2025-11-02 05:57:52,874 - INFO -  step: 2300  loss: -2.0000  grad_norm:  0.3758  memory: 13.35GiB(28.09%)  tps: 6,821  tflops: 51.95  mfu: 16.65%
[rank3]:2025-11-02 05:57:55,322 - INFO -  step: 2300  loss:  0.2385  grad_norm:  0.3758  memory: 16.39GiB(34.50%)  tps: 6,821  tflops: 51.95  mfu: 16.65%
[rank0]:2025-11-02 05:57:55,394 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251102_0557_stage0_step2300.svg
[rank1]:2025-11-02 05:57:55,393 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251102_0557_stage1_step2300.svg
[rank2]:2025-11-02 05:57:55,396 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251102_0557_stage2_step2300.svg
[rank3]:2025-11-02 05:57:55,518 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/pipeline_schedule/251102_0557_real_step2300_rank3.svg
[rank3]:> Batch Time: 368.95 ms, GPU Bubble Ratio: 59.03%, 39.02%, 50.29%, 21.95%
[rank3]:2025-11-02 05:57:55,584 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251102_0557_stage3_step2300.svg
[rank0]:2025-11-02 05:58:52,228 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-02 05:58:53,204 - INFO -  step: 2350  loss: -2.0000  grad_norm:  0.2474  memory:  9.40GiB(19.79%)  tps: 6,788  tflops: 51.70  mfu: 16.57%
[rank0]:2025-11-02 05:58:53,215 - INFO -  step: 2350  loss: -2.0000  grad_norm:  0.2474  memory: 13.35GiB(28.09%)  tps: 6,788  tflops: 51.70  mfu: 16.57%
[rank2]:2025-11-02 05:58:53,200 - INFO -  step: 2350  loss: -2.0000  grad_norm:  0.2474  memory:  6.55GiB(13.78%)  tps: 6,788  tflops: 51.70  mfu: 16.57%
[rank3]:2025-11-02 05:58:55,684 - INFO -  step: 2350  loss:  0.2341  grad_norm:  0.2474  memory: 16.39GiB(34.50%)  tps: 6,786  tflops: 51.68  mfu: 16.57%
[rank0]:2025-11-02 05:59:52,383 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 05:59:53,291 - INFO - Avg. fwd time: 13.3522 / Avg. bwd time: 24.7213 / Avg. batch time: 376.7307 (ms) / GPU bubble ratio: 19.15%
[rank2]:2025-11-02 05:59:53,317 - INFO - Avg. fwd time: 7.3190 / Avg. bwd time: 15.8086 / Avg. batch time: 502.5762 (ms) / GPU bubble ratio: 63.19%
[rank1]:2025-11-02 05:59:53,347 - INFO - Avg. fwd time: 9.5914 / Avg. bwd time: 20.1717 / Avg. batch time: 538.2358 (ms) / GPU bubble ratio: 55.76%
[rank1]:2025-11-02 05:59:53,400 - INFO -  step: 2400  loss: -2.0000  grad_norm:  0.3301  memory:  9.40GiB(19.79%)  tps: 6,804  tflops: 51.82  mfu: 16.61%
[rank1]:2025-11-02 05:59:53,400 - INFO -  final step: 2400  loss: -2.0000  grad_norm:  0.3301  tps: 6,884  tflops: 52.43  mfu: 16.23%
[rank1]:2025-11-02 05:59:53,400 - INFO - ðŸ”Ž  Running validation at step 2400
[rank0]:2025-11-02 05:59:53,374 - INFO - Avg. fwd time: 7.8995 / Avg. bwd time: 16.1731 / Avg. batch time: 570.8142 (ms) / GPU bubble ratio: 66.26%
[rank0]:2025-11-02 05:59:53,410 - INFO -  step: 2400  loss: -2.0000  grad_norm:  0.3301  memory: 13.35GiB(28.09%)  tps: 6,805  tflops: 51.82  mfu: 16.61%
[rank0]:2025-11-02 05:59:53,411 - INFO -  final step: 2400  loss: -2.0000  grad_norm:  0.3301  tps: 6,884  tflops: 52.43  mfu: 16.23%
[rank0]:2025-11-02 05:59:53,411 - INFO - ðŸ”Ž  Running validation at step 2400
[rank2]:2025-11-02 05:59:53,396 - INFO -  step: 2400  loss: -2.0000  grad_norm:  0.3301  memory:  6.55GiB(13.78%)  tps: 6,804  tflops: 51.82  mfu: 16.61%
[rank2]:2025-11-02 05:59:53,396 - INFO -  final step: 2400  loss: -2.0000  grad_norm:  0.3301  tps: 6,885  tflops: 52.43  mfu: 16.23%
[rank2]:2025-11-02 05:59:53,396 - INFO - ðŸ”Ž  Running validation at step 2400
[rank3]:2025-11-02 05:59:55,884 - INFO -  step: 2400  loss:  0.2458  grad_norm:  0.3301  memory: 16.39GiB(34.50%)  tps: 6,804  tflops: 51.82  mfu: 16.61%
[rank3]:2025-11-02 05:59:55,884 - INFO -  final step: 2400  loss:  0.2458  grad_norm:  0.3301  tps: 6,824  tflops: 51.97  mfu: 16.08%
[rank3]:2025-11-02 05:59:55,885 - INFO - ðŸ”Ž  Running validation at step 2400
[rank1]:2025-11-02 06:00:15,114 - INFO - validate step: 2400  loss: -1.0000  memory:  9.40GiB(19.79%)  tps: 18,863
[rank1]:2025-11-02 06:00:15,115 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-11-02 06:00:15,117 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank3]:2025-11-02 06:00:15,119 - INFO - validate step: 2400  loss:  0.9529  memory: 16.39GiB(34.50%)  tps: 21,297
[rank3]:2025-11-02 06:00:15,119 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-11-02 06:00:15,121 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank0]:2025-11-02 06:00:15,099 - INFO - validate step: 2400  loss: -1.0000  memory: 13.35GiB(28.09%)  tps: 18,886
[rank0]:2025-11-02 06:00:15,100 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-02 06:00:15,102 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank2]:2025-11-02 06:00:15,132 - INFO - validate step: 2400  loss: -1.0000  memory:  6.55GiB(13.78%)  tps: 18,845
[rank2]:2025-11-02 06:00:15,133 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-02 06:00:15,135 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank0]:2025-11-02 06:00:17,331 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank1]:2025-11-02 06:00:17,410 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251102_0600_stage1_final2400.svg
[rank0]:2025-11-02 06:00:17,411 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251102_0600_stage0_final2400.svg
[rank2]:2025-11-02 06:00:17,413 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251102_0600_stage2_final2400.svg
[rank3]:2025-11-02 06:00:17,527 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/pipeline_schedule/251102_0600_real_final2400_rank3.svg
[rank3]:> Batch Time: 370.06 ms, GPU Bubble Ratio: 58.29%, 38.61%, 50.25%, 22.12%
[rank1]:2025-11-02 06:00:17,608 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/frozen_params_histogram/251102_0600_rank1_stage1.svg
[rank1]:	> Counts Sum: 1370700, Total Sum: 1526400 (89.80%), Ratio(%) per element: [89.68, 89.85, 89.85, 89.79, 89.85, 89.79, 89.79, 89.68, 89.79, 89.68, 89.79, 89.74, 89.85, 89.79, 89.79, 89.79, 89.85, 89.74, 89.74, 89.85, 89.68, 89.91, 89.79, 89.85, 89.74, 89.68, 89.85, 89.85, 89.91, 89.85, 89.74, 89.74, 89.91, 89.79, 89.85, 89.68, 89.85, 89.85, 89.79, 89.85, 89.74, 89.85, 89.79, 89.79, 89.68]
[rank1]:2025-11-02 06:00:17,609 - INFO - Destroying the purge thread.
[rank0]:2025-11-02 06:00:17,626 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/frozen_params_histogram/251102_0600_rank0_stage0.svg
[rank0]:	> Counts Sum: 1134940, Total Sum: 1255040 (90.43%), Ratio(%) per element: [90.56, 90.44, 90.5, 90.56, 90.5, 90.33, 90.62, 90.44, 90.21, 90.68, 90.21, 90.27, 90.21, 90.44, 90.44, 90.5, 90.56, 90.62, 90.62, 90.27, 90.44, 90.5, 90.68, 90.27, 90.27, 90.44, 90.33, 90.09, 90.44, 90.33, 90.56, 90.38, 90.33, 90.62, 90.5, 90.21, 90.38]
[rank0]:2025-11-02 06:00:17,627 - INFO - Sleeping 2 seconds for other ranks to complete
[rank2]:2025-11-02 06:00:17,627 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/frozen_params_histogram/251102_0600_rank2_stage2.svg
[rank2]:	> Counts Sum: 1060560, Total Sum: 1221120 (86.85%), Ratio(%) per element: [86.85, 86.85, 86.96, 86.79, 86.73, 86.91, 86.85, 86.79, 86.85, 86.91, 86.91, 86.91, 86.91, 86.79, 86.96, 86.85, 86.85, 86.85, 86.79, 86.85, 86.91, 86.79, 86.91, 86.85, 86.79, 86.85, 86.91, 86.73, 86.96, 86.73, 86.73, 86.79, 86.91, 86.73, 86.85, 86.96]
[rank2]:2025-11-02 06:00:17,628 - INFO - Destroying the purge thread.
[rank3]:2025-11-02 06:00:17,709 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/pipeline_schedule/251102_0600_thry_final2400_rank3.svg
[rank3]:> Batch Time: 318.94 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:2025-11-02 06:00:17,774 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251102_0600_stage3_final2400.svg
[rank1]:2025-11-02 06:00:17,829 - INFO - Process group destroyed
[rank2]:2025-11-02 06:00:17,800 - INFO - Process group destroyed
[rank3]:2025-11-02 06:00:17,961 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/frozen_params_histogram/251102_0600_rank3_stage3.svg
[rank3]:	> Counts Sum: 204840, Total Sum: 983680 (20.82%), Ratio(%) per element: [20.69, 21.34, 21.46, 21.4, 21.04, 21.34, 21.04, 20.57, 20.34, 21.75, 20.63, 21.81, 21.16, 21.04, 20.75, 20.34, 21.46, 20.51, 21.58, 21.28, 20.45, 20.99, 21.99, 21.46, 21.52, 21.28, 20.99, 21.16, 12.38]
[rank3]:2025-11-02 06:00:17,962 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading history steps 48-48, summary, console lines 395-405
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–…â–„â–…â–„â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–‡â–ˆâ–‡â–…â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–‡â–ˆâ–‡â–…â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 1.20049
[rank3]:wandb:               final/avg_loss 0.24576
[rank3]:wandb:             final/avg_mfu(%) 16.08083
[rank3]:wandb:             final/avg_tflops 51.97219
[rank3]:wandb:    final/avg_throughput(tps) 6823.88852
[rank3]:wandb:              final/grad_norm 0.33009
[rank3]:wandb:               final/max_loss 0.24576
[rank3]:wandb:                    grad_norm 0.33009
[rank3]:wandb: loss_metrics/global_avg_loss 0.24576
[rank3]:wandb: loss_metrics/global_max_loss 0.24576
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1031_1F1B_timelyapf_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/krb6pl9e
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1031_1F1B_timelyapf_dm1/20251102-0507/wandb/run-20251102_050719-krb6pl9e/logs
[rank3]:2025-11-02 06:00:19,460 - INFO - Process group destroyed
[rank0]:2025-11-02 06:00:19,627 - INFO - Training completed
[rank0]:2025-11-02 06:00:19,627 - INFO - Destroying the purge thread.
[rank0]:2025-11-02 06:00:19,898 - INFO - Process group destroyed
[rank2]:Stage 2: Modules to keep: {'layers.10', 'layers.9', 'layers.12', 'layers.11'}
[rank1]:Stage 1: Modules to keep: {'layers.7', 'layers.4', 'layers.6', 'layers.8', 'layers.5'}
[rank0]:Stage 0: Modules to keep: {'layers.1', 'layers.0', 'layers.2', 'tok_embeddings', 'layers.3'}
[rank3]:Stage 3: Modules to keep: {'layers.14', 'layers.13', 'layers.15', 'norm', 'output'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1029_llama1b/config_1031.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
[rank3]:+ more freezing in autofreeze mode. 
[rank3]:+ lr_scheduler min_lr = 0 -> 1e-6, cosine decay.
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1031_1F1B_timelyapf_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1031_1F1B_timelyapf_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1031_1F1B_timelyapf_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1031_1F1B_timelyapf_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1031_1F1B_timelyapf_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B-Instruct
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 1e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 300
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: alpaca
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 512
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 2400
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: 1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 4
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1031_1F1B_timelyapf_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B-Instruct/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1031_1F1B_timelyapf_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: True
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: timelyapf
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- threshold: 0.05
[rank3]:		- percentile: 70
[rank3]:
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3

ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 11. 04. (í™”) 00:36:19 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 3,4,5,6
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1029_llama1b/run_1031.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1029_llama1b/1031_1F1B_timelyapf.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
+ more freezing in autofreeze mode. 
+ lr_scheduler min_lr = 0 -> 1e-6, cosine decay.

âœ”ï¸Running with timelyapf x 1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1029_llama1b/config_1031.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
+ more freezing in autofreeze mode. 
+ lr_scheduler min_lr = 0 -> 1e-6, cosine decay.
" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=timelyapf
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank1]:2025-11-04 00:36:25,037 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
[rank1]:+ more freezing in autofreeze mode. 
[rank1]:+ lr_scheduler min_lr = 0 -> 1e-6, cosine decay.
[rank1]:"
[rank0]:2025-11-04 00:36:25,209 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
[rank0]:+ more freezing in autofreeze mode. 
[rank0]:+ lr_scheduler min_lr = 0 -> 1e-6, cosine decay.
[rank0]:"
[rank1]:2025-11-04 00:36:25,217 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-11-04 00:36:25,219 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-04 00:36:25,350 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-11-04 00:36:25,352 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-04 00:36:25,355 - INFO - [GC] Initial GC collection 0.00 seconds
[rank2]:2025-11-04 00:36:25,720 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
[rank2]:+ more freezing in autofreeze mode. 
[rank2]:+ lr_scheduler min_lr = 0 -> 1e-6, cosine decay.
[rank2]:"
[rank3]:2025-11-04 00:36:25,720 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
[rank3]:+ more freezing in autofreeze mode. 
[rank3]:+ lr_scheduler min_lr = 0 -> 1e-6, cosine decay.
[rank3]:"
[rank2]:2025-11-04 00:36:25,967 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-11-04 00:36:25,971 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-11-04 00:36:25,970 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-11-04 00:36:25,973 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-04 00:36:26,300 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-11-04 00:36:26,704 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank0]:2025-11-04 00:36:29,605 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=512, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank0]:2025-11-04 00:36:29,767 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-11-04 00:36:29,786 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-11-04 00:36:29,807 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-04 00:36:29,808 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-11-04 00:36:29,833 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank2]:2025-11-04 00:36:29,825 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-04 00:36:29,841 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank2]:2025-11-04 00:36:29,853 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-11-04 00:36:29,853 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank0]:2025-11-04 00:36:30,021 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-04 00:36:30,021 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-11-04 00:36:30,021 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank2]:2025-11-04 00:36:30,028 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-11-04 00:36:30,028 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-11-04 00:36:30,028 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank1]:2025-11-04 00:36:30,121 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-11-04 00:36:30,158 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-11-04 00:36:30,182 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-11-04 00:36:30,182 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2025-11-04 00:36:30,336 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-11-04 00:36:30,336 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-11-04 00:36:30,337 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run k6oqxv99
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1031_1F1B_timelyapf_dm1/20251104-0036/wandb/run-20251104_003630-k6oqxv99
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1031_1F1B_timelyapf_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/k6oqxv99
[rank3]:2025-11-04 00:36:31,711 - INFO - WandB logging enabled
[rank3]:2025-11-04 00:36:31,712 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-11-04 00:36:31,750 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-11-04 00:36:31,778 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-11-04 00:36:31,779 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank3]:2025-11-04 00:36:31,983 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-11-04 00:36:31,984 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-11-04 00:36:31,985 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank0]:2025-11-04 00:36:32,000 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1031_1F1B_timelyapf_dm1
[rank0]:2025-11-04 00:36:32,000 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-04 00:36:32,001 - INFO - Preparing c4_validation dataset from allenai/c4
[rank2]:2025-11-04 00:36:32,000 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-11-04 00:36:31,999 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank1]:2025-11-04 00:36:32,000 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-04 00:36:36,810 - INFO - Trainer is initialized with local batch size 32, global batch size 64, gradient accumulation steps 2, sequence length 512, total steps 2400 (warmup 300)
[rank0]:2025-11-04 00:36:36,810 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B-Instruct/original_dcp.
[rank0]:2025-11-04 00:36:43,196 - INFO - [GC] GC collection for checkpoint loading. 0.01 seconds
[rank0]:2025-11-04 00:36:43,196 - INFO - Finished loading the checkpoint in 6.39 seconds.
[rank0]:2025-11-04 00:36:43,196 - INFO - Training starts at step 1
[rank2]:2025-11-04 00:36:45,130 - INFO -  step:  1  loss: -2.0000  grad_norm: 85.2022  memory:  4.61GiB(9.71%)  tps: 535  tflops: 4.08  mfu: 1.31%
[rank2]:2025-11-04 00:36:45,130 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-04 00:36:45,162 - INFO -  step:  1  loss: -2.0000  grad_norm: 85.2022  memory:  9.19GiB(19.34%)  tps: 533  tflops: 4.06  mfu: 1.30%
[rank0]:2025-11-04 00:36:45,162 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-11-04 00:36:45,148 - INFO -  step:  1  loss: -2.0000  grad_norm: 85.2022  memory:  6.74GiB(14.20%)  tps: 547  tflops: 4.16  mfu: 1.33%
[rank1]:2025-11-04 00:36:45,148 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-11-04 00:36:45,135 - INFO -  step:  1  loss:  9.0164  grad_norm: 85.2022  memory: 12.97GiB(27.30%)  tps: 612  tflops: 4.66  mfu: 1.49%
[rank3]:2025-11-04 00:36:45,136 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-04 00:37:44,775 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-04 00:37:46,040 - INFO -  step: 50  loss: -2.0000  grad_norm: 49.2956  memory:  6.43GiB(13.53%)  tps: 6,590  tflops: 50.19  mfu: 16.09%
[rank0]:2025-11-04 00:37:46,055 - INFO -  step: 50  loss: -2.0000  grad_norm: 49.2956  memory: 12.97GiB(27.31%)  tps: 6,592  tflops: 50.21  mfu: 16.09%
[rank3]:2025-11-04 00:37:46,053 - INFO -  step: 50  loss:  9.8058  grad_norm: 49.2956  memory: 16.39GiB(34.50%)  tps: 6,590  tflops: 50.19  mfu: 16.09%
[rank1]:2025-11-04 00:37:46,044 - INFO -  step: 50  loss: -2.0000  grad_norm: 49.2956  memory:  9.03GiB(19.01%)  tps: 6,592  tflops: 50.20  mfu: 16.09%
[rank0]:2025-11-04 00:38:47,306 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 00:38:48,254 - INFO - Avg. fwd time: 12.4048 / Avg. bwd time: 39.9459 / Avg. batch time: 491.4263 (ms) / GPU bubble ratio: 14.78%
[rank1]:2025-11-04 00:38:48,326 - INFO - Avg. fwd time: 9.0823 / Avg. bwd time: 23.2490 / Avg. batch time: 561.1128 (ms) / GPU bubble ratio: 53.90%
[rank2]:2025-11-04 00:38:48,293 - INFO - Avg. fwd time: 6.9436 / Avg. bwd time: 18.0807 / Avg. batch time: 522.3932 (ms) / GPU bubble ratio: 61.68%
[rank0]:2025-11-04 00:38:48,322 - INFO - Avg. fwd time: 7.5112 / Avg. bwd time: 23.7129 / Avg. batch time: 598.9603 (ms) / GPU bubble ratio: 58.30%
[rank3]:2025-11-04 00:38:48,554 - INFO -  step: 100  loss:  8.5667  grad_norm: 31.6565  memory: 16.39GiB(34.50%)  tps: 6,554  tflops: 49.91  mfu: 16.00%
[rank3]:2025-11-04 00:38:48,554 - WARNING - Nothing to draw before the end of warmup.
[rank1]:2025-11-04 00:38:48,545 - INFO -  step: 100  loss: -2.0000  grad_norm: 31.6565  memory:  9.03GiB(19.01%)  tps: 6,554  tflops: 49.91  mfu: 16.00%
[rank1]:2025-11-04 00:38:48,545 - WARNING - Nothing to draw before the end of warmup.
[rank2]:2025-11-04 00:38:48,541 - INFO -  step: 100  loss: -2.0000  grad_norm: 31.6565  memory:  6.43GiB(13.53%)  tps: 6,554  tflops: 49.91  mfu: 16.00%
[rank2]:2025-11-04 00:38:48,542 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-11-04 00:38:48,556 - INFO -  step: 100  loss: -2.0000  grad_norm: 31.6565  memory: 12.97GiB(27.31%)  tps: 6,554  tflops: 49.91  mfu: 16.00%
[rank0]:2025-11-04 00:38:48,556 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-11-04 00:39:49,874 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-04 00:39:51,166 - INFO -  step: 150  loss: -2.0000  grad_norm: 46.5799  memory:  9.03GiB(19.01%)  tps: 6,541  tflops: 49.82  mfu: 15.97%
[rank0]:2025-11-04 00:39:51,177 - INFO -  step: 150  loss: -2.0000  grad_norm: 46.5799  memory: 12.97GiB(27.31%)  tps: 6,541  tflops: 49.82  mfu: 15.97%
[rank3]:2025-11-04 00:39:51,175 - INFO -  step: 150  loss:  5.0118  grad_norm: 46.5799  memory: 16.39GiB(34.50%)  tps: 6,541  tflops: 49.82  mfu: 15.97%
[rank2]:2025-11-04 00:39:51,162 - INFO -  step: 150  loss: -2.0000  grad_norm: 46.5799  memory:  6.43GiB(13.53%)  tps: 6,541  tflops: 49.82  mfu: 15.97%
[rank0]:2025-11-04 00:40:52,583 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-04 00:40:53,597 - INFO - Avg. fwd time: 6.9371 / Avg. bwd time: 18.1281 / Avg. batch time: 523.9296 (ms) / GPU bubble ratio: 61.73%
[rank0]:2025-11-04 00:40:53,626 - INFO - Avg. fwd time: 7.5215 / Avg. bwd time: 23.7687 / Avg. batch time: 599.3752 (ms) / GPU bubble ratio: 58.24%
[rank3]:2025-11-04 00:40:53,558 - INFO - Avg. fwd time: 12.5462 / Avg. bwd time: 40.0834 / Avg. batch time: 493.4335 (ms) / GPU bubble ratio: 14.67%
[rank1]:2025-11-04 00:40:53,630 - INFO - Avg. fwd time: 9.0833 / Avg. bwd time: 23.3096 / Avg. batch time: 562.0717 (ms) / GPU bubble ratio: 53.89%
[rank2]:2025-11-04 00:40:53,855 - INFO -  step: 200  loss: -2.0000  grad_norm: 38.8517  memory:  6.43GiB(13.53%)  tps: 6,533  tflops: 49.76  mfu: 15.95%
[rank2]:2025-11-04 00:40:53,856 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-11-04 00:40:53,870 - INFO -  step: 200  loss: -2.0000  grad_norm: 38.8517  memory: 12.97GiB(27.31%)  tps: 6,533  tflops: 49.76  mfu: 15.95%
[rank0]:2025-11-04 00:40:53,870 - INFO - ðŸ”Ž  Running validation at step 200
[rank3]:2025-11-04 00:40:53,868 - INFO -  step: 200  loss:  1.7729  grad_norm: 38.8517  memory: 16.39GiB(34.50%)  tps: 6,534  tflops: 49.76  mfu: 15.95%
[rank3]:2025-11-04 00:40:53,869 - INFO - ðŸ”Ž  Running validation at step 200
[rank1]:2025-11-04 00:40:53,859 - INFO -  step: 200  loss: -2.0000  grad_norm: 38.8517  memory:  9.03GiB(19.01%)  tps: 6,533  tflops: 49.76  mfu: 15.95%
[rank1]:2025-11-04 00:40:53,859 - INFO - ðŸ”Ž  Running validation at step 200
[rank2]:2025-11-04 00:41:24,249 - INFO - validate step: 200  loss: -1.0000  memory:  6.43GiB(13.53%)  tps: 13,477
[rank2]:2025-11-04 00:41:24,250 - WARNING - Nothing to draw before the end of warmup.
[rank3]:2025-11-04 00:41:24,243 - INFO - validate step: 200  loss:  1.5277  memory: 16.39GiB(34.50%)  tps: 13,486
[rank3]:2025-11-04 00:41:24,244 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-11-04 00:41:24,220 - INFO - validate step: 200  loss: -1.0000  memory: 12.97GiB(27.31%)  tps: 13,496
[rank0]:2025-11-04 00:41:24,221 - WARNING - Nothing to draw before the end of warmup.
[rank1]:2025-11-04 00:41:24,236 - INFO - validate step: 200  loss: -1.0000  memory:  9.03GiB(19.01%)  tps: 13,484
[rank1]:2025-11-04 00:41:24,237 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-11-04 00:42:25,555 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-11-04 00:42:26,813 - INFO -  step: 250  loss: -2.0000  grad_norm: 41.9709  memory:  6.43GiB(13.53%)  tps: 6,547  tflops: 49.86  mfu: 15.98%
[rank3]:2025-11-04 00:42:26,825 - INFO -  step: 250  loss:  0.6180  grad_norm: 41.9709  memory: 16.39GiB(34.50%)  tps: 6,545  tflops: 49.85  mfu: 15.98%
[rank0]:2025-11-04 00:42:26,828 - INFO -  step: 250  loss: -2.0000  grad_norm: 41.9709  memory: 12.97GiB(27.31%)  tps: 6,542  tflops: 49.83  mfu: 15.97%
[rank1]:2025-11-04 00:42:26,817 - INFO -  step: 250  loss: -2.0000  grad_norm: 41.9709  memory:  9.03GiB(19.01%)  tps: 6,545  tflops: 49.85  mfu: 15.98%
[rank3]:2025-11-04 00:42:38,976 - INFO - [Step 260] ã€°ï¸ Monitoring Upperbound
[rank2]:2025-11-04 00:42:53,323 - WARNING - [Step 270] â³ Monitoring Upperbound... (540/550)
[rank3]:2025-11-04 00:42:53,298 - WARNING - [Step 270] â³ Monitoring Upperbound... (540/550)
[rank0]:2025-11-04 00:42:53,382 - WARNING - [Step 270] â³ Monitoring Upperbound... (540/550)
[rank1]:2025-11-04 00:42:53,352 - WARNING - [Step 270] â³ Monitoring Upperbound... (540/550)
[rank3]:2025-11-04 00:43:11,420 - INFO - [Step 280] âœ”ï¸  Setting Upperbound
[rank3]:2025-11-04 00:43:11,728 - INFO - [Step 280] ã€°ï¸ Monitoring Lowerbound
[rank2]:2025-11-04 00:43:14,028 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-04 00:43:14,059 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-04 00:43:14,095 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-04 00:43:14,724 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-04 00:43:14,759 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-04 00:43:16,817 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-04 00:43:16,844 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-04 00:43:16,874 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-04 00:43:17,956 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-04 00:43:18,010 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-04 00:43:17,953 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-04 00:43:17,977 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-04 00:43:17,997 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-04 00:43:18,021 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-04 00:43:18,032 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-04 00:43:18,076 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-04 00:43:18,116 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-04 00:43:18,045 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-04 00:43:18,068 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-04 00:43:18,092 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-04 00:43:18,117 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-04 00:43:18,056 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-04 00:43:18,103 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-04 00:43:18,103 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-04 00:43:18,104 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-04 00:43:18,104 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-04 00:43:18,058 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-04 00:43:18,098 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-04 00:43:18,130 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-04 00:43:18,144 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-04 00:43:18,147 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-04 00:43:18,164 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-04 00:43:33,620 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-04 00:43:34,431 - INFO - Avg. fwd time: 7.0299 / Avg. bwd time: 17.4826 / Avg. batch time: 517.3782 (ms) / GPU bubble ratio: 62.10%
[rank3]:2025-11-04 00:43:34,416 - INFO - Avg. fwd time: 12.5975 / Avg. bwd time: 38.7791 / Avg. batch time: 483.3357 (ms) / GPU bubble ratio: 14.96%
[rank3]:2025-11-04 00:43:34,420 - INFO - [Step 300] âœ”ï¸  Setting Lowerbound
[rank0]:2025-11-04 00:43:34,452 - INFO - Avg. fwd time: 7.6117 / Avg. bwd time: 22.2183 / Avg. batch time: 590.0295 (ms) / GPU bubble ratio: 59.55%
[rank1]:2025-11-04 00:43:34,447 - INFO - Avg. fwd time: 9.2004 / Avg. bwd time: 22.4899 / Avg. batch time: 554.4828 (ms) / GPU bubble ratio: 54.28%
[rank1]:2025-11-04 00:43:34,468 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.02/0.02, [MB7] 1.00/1.00
[rank1]:2025-11-04 00:43:34,469 - INFO -  step: 300  loss: -2.0000  grad_norm:  0.0000  memory:  9.03GiB(19.01%)  tps: 6,055  tflops: 46.11  mfu: 14.78%
[rank2]:2025-11-04 00:43:34,468 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-04 00:43:34,469 - INFO -  step: 300  loss: -2.0000  grad_norm:  0.0000  memory:  6.43GiB(13.53%)  tps: 6,054  tflops: 46.11  mfu: 14.78%
[rank0]:2025-11-04 00:43:34,468 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.57/0.57, [MB7] 1.00/1.00
[rank0]:2025-11-04 00:43:34,469 - INFO -  step: 300  loss: -2.0000  grad_norm:  0.0000  memory: 12.97GiB(27.31%)  tps: 6,056  tflops: 46.12  mfu: 14.78%
[rank3]:2025-11-04 00:43:34,624 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/pipeline_schedule/251104_0043_max_batch_time.svg
[rank3]:> Batch Time: 512.23 ms, GPU Bubble Ratio: 50.99%, 49.35%, 60.77%, 18.49%
[rank3]:2025-11-04 00:43:34,770 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/pipeline_schedule/251104_0043_min_batch_time.svg
[rank3]:> Batch Time: 308.53 ms, GPU Bubble Ratio: 80.46%, 49.38%, 61.09%, 15.29%
[rank3]:2025-11-04 00:43:34,937 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/pipeline_schedule/251104_0043_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 335.87 ms, GPU Bubble Ratio: 36.60%, 26.70%, 43.22%, 14.05%
[rank3]:2025-11-04 00:43:34,938 - INFO - 	> Batch Time: 335.87 ms (Average Freeze Ratio: 0.31, Time Reduction Rate: 0.34)
[rank3]:2025-11-04 00:43:34,940 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.40/0.40, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-11-04 00:43:34,944 - INFO -  step: 300  loss:  0.2922  grad_norm:  0.0215  memory: 16.39GiB(34.50%)  tps: 6,013  tflops: 45.80  mfu: 14.68%
[rank2]:2025-11-04 00:43:35,005 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251104_0043_stage2_step300.svg
[rank0]:2025-11-04 00:43:35,005 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251104_0043_stage0_step300.svg
[rank1]:2025-11-04 00:43:35,004 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251104_0043_stage1_step300.svg
[rank3]:2025-11-04 00:43:35,085 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/pipeline_schedule/251104_0043_real_step300_rank3.svg
[rank3]:> Batch Time: 401.50 ms, GPU Bubble Ratio: 82.58%, 57.48%, 67.11%, 32.37%
[rank3]:2025-11-04 00:43:35,131 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251104_0043_stage3_step300.svg
[rank0]:2025-11-04 00:44:54,236 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-04 00:44:57,805 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.67/1.00
[rank2]:2025-11-04 00:44:57,805 - INFO -  step: 350  loss: -2.0000  grad_norm:  1.1080  memory:  6.51GiB(13.70%)  tps: 4,915  tflops: 37.43  mfu: 12.00%
[rank1]:2025-11-04 00:44:59,346 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.01/0.02, [MB7] 0.67/1.00
[rank1]:2025-11-04 00:44:59,347 - INFO -  step: 350  loss: -2.0000  grad_norm:  1.1080  memory:  9.36GiB(19.71%)  tps: 4,826  tflops: 36.75  mfu: 11.78%
[rank3]:2025-11-04 00:45:00,657 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.27/0.40, [MB2] 0.67/1.00, [MB3] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank3]:2025-11-04 00:45:00,661 - INFO -  step: 350  loss:  0.1931  grad_norm:  1.1080  memory: 17.37GiB(36.55%)  tps: 4,779  tflops: 36.39  mfu: 11.66%
[rank0]:2025-11-04 00:45:00,758 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.38/0.57, [MB7] 0.67/1.00
[rank0]:2025-11-04 00:45:00,758 - INFO -  step: 350  loss: -2.0000  grad_norm:  1.1080  memory: 13.42GiB(28.26%)  tps: 4,747  tflops: 36.15  mfu: 11.59%
[rank0]:2025-11-04 00:46:09,699 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 00:46:10,438 - INFO - Avg. fwd time: 12.7798 / Avg. bwd time: 35.9179 / Avg. batch time: 462.0140 (ms) / GPU bubble ratio: 15.68%
[rank2]:2025-11-04 00:46:10,505 - INFO - Avg. fwd time: 7.0775 / Avg. bwd time: 17.1528 / Avg. batch time: 495.1818 (ms) / GPU bubble ratio: 60.85%
[rank0]:2025-11-04 00:46:10,503 - INFO - Avg. fwd time: 7.7563 / Avg. bwd time: 20.7723 / Avg. batch time: 566.4311 (ms) / GPU bubble ratio: 59.71%
[rank1]:2025-11-04 00:46:10,540 - INFO - Avg. fwd time: 9.2916 / Avg. bwd time: 21.7368 / Avg. batch time: 531.8069 (ms) / GPU bubble ratio: 53.32%
[rank1]:2025-11-04 00:46:13,696 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.02/0.02, [MB7] 1.00/1.00
[rank1]:2025-11-04 00:46:13,697 - INFO -  step: 400  loss: -2.0000  grad_norm:  0.2899  memory:  9.38GiB(19.75%)  tps: 5,509  tflops: 41.96  mfu: 13.45%
[rank1]:2025-11-04 00:46:13,697 - INFO - ðŸ”Ž  Running validation at step 400
[rank2]:2025-11-04 00:46:14,002 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-04 00:46:14,003 - INFO -  step: 400  loss: -2.0000  grad_norm:  0.2899  memory:  6.51GiB(13.70%)  tps: 5,376  tflops: 40.94  mfu: 13.12%
[rank2]:2025-11-04 00:46:14,003 - INFO - ðŸ”Ž  Running validation at step 400
[rank3]:2025-11-04 00:46:15,367 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.40/0.40, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-11-04 00:46:15,371 - INFO -  step: 400  loss:  0.2257  grad_norm:  0.2899  memory: 17.37GiB(36.55%)  tps: 5,483  tflops: 41.76  mfu: 13.38%
[rank3]:2025-11-04 00:46:15,371 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-11-04 00:46:15,931 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.57/0.57, [MB7] 1.00/1.00
[rank0]:2025-11-04 00:46:15,931 - INFO -  step: 400  loss: -2.0000  grad_norm:  0.2899  memory: 13.42GiB(28.26%)  tps: 5,449  tflops: 41.50  mfu: 13.30%
[rank0]:2025-11-04 00:46:15,931 - INFO - ðŸ”Ž  Running validation at step 400
[rank2]:2025-11-04 00:46:37,307 - INFO - validate step: 400  loss: -1.0000  memory:  6.51GiB(13.70%)  tps: 17,577
[rank0]:2025-11-04 00:46:37,267 - INFO - validate step: 400  loss: -1.0000  memory: 13.42GiB(28.26%)  tps: 19,198
[rank1]:2025-11-04 00:46:37,288 - INFO - validate step: 400  loss: -1.0000  memory:  9.38GiB(19.75%)  tps: 17,363
[rank3]:2025-11-04 00:46:37,299 - INFO - validate step: 400  loss:  0.9376  memory: 17.37GiB(36.55%)  tps: 18,680
[rank2]:2025-11-04 00:46:37,361 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251104_0046_stage2_step400.svg
[rank0]:2025-11-04 00:46:37,360 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251104_0046_stage0_step400.svg
[rank1]:2025-11-04 00:46:37,361 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251104_0046_stage1_step400.svg
[rank3]:2025-11-04 00:46:37,452 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/pipeline_schedule/251104_0046_real_step400_rank3.svg
[rank3]:> Batch Time: 463.77 ms, GPU Bubble Ratio: 59.83%, 51.83%, 60.72%, 35.53%
[rank3]:2025-11-04 00:46:37,499 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251104_0046_stage3_step400.svg
[rank0]:2025-11-04 00:47:49,716 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-04 00:47:52,551 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.40/0.40, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-11-04 00:47:52,555 - INFO -  step: 450  loss:  0.2306  grad_norm:  0.5415  memory: 17.37GiB(36.55%)  tps: 5,443  tflops: 41.45  mfu: 13.29%
[rank2]:2025-11-04 00:47:53,118 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-04 00:47:53,119 - INFO -  step: 450  loss: -2.0000  grad_norm:  0.5415  memory:  6.51GiB(13.70%)  tps: 5,403  tflops: 41.15  mfu: 13.19%
[rank1]:2025-11-04 00:47:53,485 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.02/0.02, [MB7] 1.00/1.00
[rank1]:2025-11-04 00:47:53,485 - INFO -  step: 450  loss: -2.0000  grad_norm:  0.5415  memory:  9.38GiB(19.75%)  tps: 5,376  tflops: 40.94  mfu: 13.12%
[rank0]:2025-11-04 00:47:57,634 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.57/0.57, [MB7] 1.00/1.00
[rank0]:2025-11-04 00:47:57,635 - INFO -  step: 450  loss: -2.0000  grad_norm:  0.5415  memory: 13.42GiB(28.26%)  tps: 5,097  tflops: 38.82  mfu: 12.44%
[rank0]:2025-11-04 00:49:05,321 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 00:49:06,038 - INFO - Avg. fwd time: 12.9545 / Avg. bwd time: 33.1980 / Avg. batch time: 441.6826 (ms) / GPU bubble ratio: 16.41%
[rank2]:2025-11-04 00:49:06,104 - INFO - Avg. fwd time: 7.1330 / Avg. bwd time: 16.7916 / Avg. batch time: 473.7022 (ms) / GPU bubble ratio: 59.60%
[rank0]:2025-11-04 00:49:06,097 - INFO - Avg. fwd time: 7.8665 / Avg. bwd time: 18.5855 / Avg. batch time: 543.5043 (ms) / GPU bubble ratio: 61.06%
[rank1]:2025-11-04 00:49:06,139 - INFO - Avg. fwd time: 9.3919 / Avg. bwd time: 20.9973 / Avg. batch time: 509.9024 (ms) / GPU bubble ratio: 52.32%
[rank3]:2025-11-04 00:49:07,297 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.40/0.40, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-11-04 00:49:07,301 - INFO -  step: 500  loss:  0.2642  grad_norm:  0.2602  memory: 17.37GiB(36.55%)  tps: 5,480  tflops: 41.74  mfu: 13.38%
[rank2]:2025-11-04 00:49:08,340 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-04 00:49:08,341 - INFO -  step: 500  loss: -2.0000  grad_norm:  0.2602  memory:  6.51GiB(13.70%)  tps: 5,445  tflops: 41.47  mfu: 13.29%
[rank1]:2025-11-04 00:49:09,619 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.02/0.02, [MB7] 1.00/1.00
[rank1]:2025-11-04 00:49:09,620 - INFO -  step: 500  loss: -2.0000  grad_norm:  0.2602  memory:  9.38GiB(19.75%)  tps: 5,380  tflops: 40.98  mfu: 13.13%
[rank0]:2025-11-04 00:49:11,495 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.57/0.57, [MB7] 1.00/1.00
[rank0]:2025-11-04 00:49:11,495 - INFO -  step: 500  loss: -2.0000  grad_norm:  0.2602  memory: 13.42GiB(28.26%)  tps: 5,546  tflops: 42.24  mfu: 13.54%
[rank0]:2025-11-04 00:49:11,545 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251104_0049_stage0_step500.svg
[rank2]:2025-11-04 00:49:11,560 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251104_0049_stage2_step500.svg
[rank1]:2025-11-04 00:49:11,560 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251104_0049_stage1_step500.svg
[rank3]:2025-11-04 00:49:11,640 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/pipeline_schedule/251104_0049_real_step500_rank3.svg
[rank3]:> Batch Time: 456.50 ms, GPU Bubble Ratio: 67.87%, 51.05%, 60.07%, 36.66%
[rank3]:2025-11-04 00:49:11,682 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251104_0049_stage3_step500.svg
[rank0]:2025-11-04 00:50:18,624 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-04 00:50:21,806 - INFO -  step: 550  loss: -2.0000  grad_norm:  0.3025  memory:  6.51GiB(13.70%)  tps: 5,576  tflops: 42.46  mfu: 13.61%
[rank1]:2025-11-04 00:50:22,170 - INFO -  step: 550  loss: -2.0000  grad_norm:  0.3025  memory:  9.38GiB(19.75%)  tps: 5,646  tflops: 43.00  mfu: 13.78%
[rank3]:2025-11-04 00:50:22,968 - INFO -  step: 550  loss:  0.2606  grad_norm:  0.3025  memory: 17.37GiB(36.55%)  tps: 5,413  tflops: 41.23  mfu: 13.21%
[rank0]:2025-11-04 00:50:24,304 - INFO -  step: 550  loss: -2.0000  grad_norm:  0.3025  memory: 13.42GiB(28.26%)  tps: 5,626  tflops: 42.85  mfu: 13.73%
[rank0]:2025-11-04 00:51:30,169 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 00:51:31,070 - INFO - Avg. fwd time: 13.0673 / Avg. bwd time: 31.4238 / Avg. batch time: 428.4073 (ms) / GPU bubble ratio: 16.92%
[rank0]:2025-11-04 00:51:31,143 - INFO - Avg. fwd time: 7.9339 / Avg. bwd time: 17.1184 / Avg. batch time: 528.5144 (ms) / GPU bubble ratio: 62.08%
[rank2]:2025-11-04 00:51:31,092 - INFO - Avg. fwd time: 7.1689 / Avg. bwd time: 16.5560 / Avg. batch time: 459.6674 (ms) / GPU bubble ratio: 58.71%
[rank1]:2025-11-04 00:51:31,119 - INFO - Avg. fwd time: 9.4566 / Avg. bwd time: 20.5128 / Avg. batch time: 495.5902 (ms) / GPU bubble ratio: 51.62%
[rank3]:2025-11-04 00:51:32,218 - INFO -  step: 600  loss:  0.2213  grad_norm:  0.3259  memory: 17.37GiB(36.55%)  tps: 5,915  tflops: 45.05  mfu: 14.44%
[rank3]:2025-11-04 00:51:32,219 - INFO - ðŸ”Ž  Running validation at step 600
[rank2]:2025-11-04 00:51:33,224 - INFO -  step: 600  loss: -2.0000  grad_norm:  0.3259  memory:  6.51GiB(13.70%)  tps: 5,735  tflops: 43.68  mfu: 14.00%
[rank2]:2025-11-04 00:51:33,224 - INFO - ðŸ”Ž  Running validation at step 600
[rank1]:2025-11-04 00:51:33,761 - INFO -  step: 600  loss: -2.0000  grad_norm:  0.3259  memory:  9.38GiB(19.75%)  tps: 5,721  tflops: 43.58  mfu: 13.97%
[rank1]:2025-11-04 00:51:33,761 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-11-04 00:51:35,837 - INFO -  step: 600  loss: -2.0000  grad_norm:  0.3259  memory: 13.42GiB(28.26%)  tps: 5,726  tflops: 43.61  mfu: 13.98%
[rank0]:2025-11-04 00:51:35,837 - INFO - ðŸ”Ž  Running validation at step 600
[rank3]:2025-11-04 00:51:56,632 - INFO - validate step: 600  loss:  0.9348  memory: 17.37GiB(36.55%)  tps: 16,779
[rank2]:2025-11-04 00:51:56,639 - INFO - validate step: 600  loss: -1.0000  memory:  6.51GiB(13.70%)  tps: 17,493
[rank0]:2025-11-04 00:51:56,602 - INFO - validate step: 600  loss: -1.0000  memory: 13.42GiB(28.26%)  tps: 19,725
[rank1]:2025-11-04 00:51:56,620 - INFO - validate step: 600  loss: -1.0000  memory:  9.38GiB(19.75%)  tps: 17,919
[rank1]:2025-11-04 00:51:56,689 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251104_0051_stage1_step600.svg
[rank2]:2025-11-04 00:51:56,689 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251104_0051_stage2_step600.svg
[rank0]:2025-11-04 00:51:56,689 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251104_0051_stage0_step600.svg
[rank3]:2025-11-04 00:51:56,778 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/pipeline_schedule/251104_0051_real_step600_rank3.svg
[rank3]:> Batch Time: 456.73 ms, GPU Bubble Ratio: 67.88%, 51.04%, 60.10%, 36.61%
[rank3]:2025-11-04 00:51:56,821 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251104_0051_stage3_step600.svg
[rank0]:2025-11-04 00:53:03,443 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-11-04 00:53:06,286 - INFO -  step: 650  loss: -2.0000  grad_norm:  0.2918  memory:  6.51GiB(13.70%)  tps: 5,881  tflops: 44.79  mfu: 14.36%
[rank1]:2025-11-04 00:53:06,858 - INFO -  step: 650  loss: -2.0000  grad_norm:  0.2918  memory:  9.38GiB(19.75%)  tps: 5,832  tflops: 44.41  mfu: 14.24%
[rank3]:2025-11-04 00:53:07,407 - INFO -  step: 650  loss:  0.3598  grad_norm:  0.2918  memory: 17.37GiB(36.55%)  tps: 5,788  tflops: 44.08  mfu: 14.13%
[rank0]:2025-11-04 00:53:09,182 - INFO -  step: 650  loss: -2.0000  grad_norm:  0.2918  memory: 13.42GiB(28.26%)  tps: 5,643  tflops: 42.98  mfu: 13.78%
[rank0]:2025-11-04 00:54:15,087 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 00:54:15,831 - INFO - Avg. fwd time: 13.1450 / Avg. bwd time: 30.3345 / Avg. batch time: 420.3230 (ms) / GPU bubble ratio: 17.25%
[rank2]:2025-11-04 00:54:15,894 - INFO - Avg. fwd time: 7.1923 / Avg. bwd time: 16.4140 / Avg. batch time: 451.1325 (ms) / GPU bubble ratio: 58.14%
[rank0]:2025-11-04 00:54:15,889 - INFO - Avg. fwd time: 7.9765 / Avg. bwd time: 16.2226 / Avg. batch time: 519.4052 (ms) / GPU bubble ratio: 62.73%
[rank1]:2025-11-04 00:54:15,930 - INFO - Avg. fwd time: 9.4986 / Avg. bwd time: 20.2219 / Avg. batch time: 486.8989 (ms) / GPU bubble ratio: 51.17%
[rank2]:2025-11-04 00:54:17,992 - INFO -  step: 700  loss: -2.0000  grad_norm:  0.2074  memory:  6.51GiB(13.70%)  tps: 5,712  tflops: 43.51  mfu: 13.94%
[rank1]:2025-11-04 00:54:18,554 - INFO -  step: 700  loss: -2.0000  grad_norm:  0.2074  memory:  9.38GiB(19.75%)  tps: 5,713  tflops: 43.51  mfu: 13.95%
[rank3]:2025-11-04 00:54:19,815 - INFO -  step: 700  loss:  0.2344  grad_norm:  0.2074  memory: 17.37GiB(36.55%)  tps: 5,657  tflops: 43.09  mfu: 13.81%
[rank2]:2025-11-04 00:54:20,879 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251104_0054_stage2_step700.svg
[rank0]:2025-11-04 00:54:20,815 - INFO -  step: 700  loss: -2.0000  grad_norm:  0.2074  memory: 13.42GiB(28.26%)  tps: 5,718  tflops: 43.55  mfu: 13.96%
[rank0]:2025-11-04 00:54:20,878 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251104_0054_stage0_step700.svg
[rank1]:2025-11-04 00:54:20,868 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251104_0054_stage1_step700.svg
[rank3]:2025-11-04 00:54:20,952 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/pipeline_schedule/251104_0054_real_step700_rank3.svg
[rank3]:> Batch Time: 456.00 ms, GPU Bubble Ratio: 67.84%, 50.80%, 59.97%, 36.15%
[rank3]:2025-11-04 00:54:20,997 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251104_0054_stage3_step700.svg
[rank0]:2025-11-04 00:55:26,597 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 00:55:28,142 - INFO -  step: 750  loss:  0.2273  grad_norm:  0.2421  memory: 17.37GiB(36.55%)  tps: 5,995  tflops: 45.66  mfu: 14.63%
[rank2]:2025-11-04 00:55:29,522 - INFO -  step: 750  loss: -2.0000  grad_norm:  0.2421  memory:  6.51GiB(13.70%)  tps: 5,726  tflops: 43.61  mfu: 13.98%
[rank1]:2025-11-04 00:55:29,954 - INFO -  step: 750  loss: -2.0000  grad_norm:  0.2421  memory:  9.38GiB(19.75%)  tps: 5,737  tflops: 43.69  mfu: 14.00%
[rank0]:2025-11-04 00:55:32,156 - INFO -  step: 750  loss: -2.0000  grad_norm:  0.2421  memory: 13.42GiB(28.26%)  tps: 5,741  tflops: 43.73  mfu: 14.02%
[rank0]:2025-11-04 00:56:37,897 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 00:56:38,624 - INFO - Avg. fwd time: 13.2091 / Avg. bwd time: 29.3778 / Avg. batch time: 413.1909 (ms) / GPU bubble ratio: 17.55%
[rank0]:2025-11-04 00:56:38,682 - INFO - Avg. fwd time: 8.0130 / Avg. bwd time: 15.4260 / Avg. batch time: 511.3187 (ms) / GPU bubble ratio: 63.33%
[rank2]:2025-11-04 00:56:38,688 - INFO - Avg. fwd time: 7.2127 / Avg. bwd time: 16.2888 / Avg. batch time: 443.5827 (ms) / GPU bubble ratio: 57.62%
[rank1]:2025-11-04 00:56:38,724 - INFO - Avg. fwd time: 9.5355 / Avg. bwd time: 19.9615 / Avg. batch time: 479.1873 (ms) / GPU bubble ratio: 50.75%
[rank3]:2025-11-04 00:56:39,989 - INFO -  step: 800  loss:  0.2641  grad_norm:  0.2670  memory: 17.37GiB(36.55%)  tps: 5,701  tflops: 43.42  mfu: 13.92%
[rank3]:2025-11-04 00:56:39,989 - INFO - ðŸ”Ž  Running validation at step 800
[rank2]:2025-11-04 00:56:40,872 - INFO -  step: 800  loss: -2.0000  grad_norm:  0.2670  memory:  6.51GiB(13.70%)  tps: 5,741  tflops: 43.72  mfu: 14.01%
[rank2]:2025-11-04 00:56:40,872 - INFO - ðŸ”Ž  Running validation at step 800
[rank1]:2025-11-04 00:56:41,331 - INFO -  step: 800  loss: -2.0000  grad_norm:  0.2670  memory:  9.38GiB(19.75%)  tps: 5,739  tflops: 43.71  mfu: 14.01%
[rank1]:2025-11-04 00:56:41,332 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-11-04 00:56:43,494 - INFO -  step: 800  loss: -2.0000  grad_norm:  0.2670  memory: 13.42GiB(28.26%)  tps: 5,742  tflops: 43.73  mfu: 14.02%
[rank0]:2025-11-04 00:56:43,494 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-11-04 00:57:04,212 - INFO - validate step: 800  loss: -1.0000  memory: 13.42GiB(28.26%)  tps: 19,770
[rank1]:2025-11-04 00:57:04,231 - INFO - validate step: 800  loss: -1.0000  memory:  9.38GiB(19.75%)  tps: 17,887
[rank3]:2025-11-04 00:57:04,243 - INFO - validate step: 800  loss:  0.9329  memory: 17.37GiB(36.55%)  tps: 16,889
[rank0]:2025-11-04 00:57:04,305 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251104_0057_stage0_step800.svg
[rank2]:2025-11-04 00:57:04,251 - INFO - validate step: 800  loss: -1.0000  memory:  6.51GiB(13.70%)  tps: 17,520
[rank2]:2025-11-04 00:57:04,304 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251104_0057_stage2_step800.svg
[rank1]:2025-11-04 00:57:04,305 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251104_0057_stage1_step800.svg
[rank3]:2025-11-04 00:57:04,401 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/pipeline_schedule/251104_0057_real_step800_rank3.svg
[rank3]:> Batch Time: 458.98 ms, GPU Bubble Ratio: 68.07%, 51.24%, 60.23%, 36.65%
[rank3]:2025-11-04 00:57:04,447 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251104_0057_stage3_step800.svg
[rank3]:2025-11-04 00:57:19,286 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-11-04 00:57:19,510 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-11-04 00:57:19,468 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-11-04 00:57:19,491 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-11-04 00:58:10,456 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-11-04 00:58:13,384 - INFO -  step: 850  loss: -2.0000  grad_norm:  0.2800  memory:  6.51GiB(13.70%)  tps: 5,925  tflops: 45.12  mfu: 14.46%
[rank1]:2025-11-04 00:58:13,903 - INFO -  step: 850  loss: -2.0000  grad_norm:  0.2800  memory:  9.38GiB(19.75%)  tps: 5,879  tflops: 44.78  mfu: 14.35%
[rank3]:2025-11-04 00:58:14,868 - INFO -  step: 850  loss:  0.2091  grad_norm:  0.2800  memory: 17.37GiB(36.55%)  tps: 5,800  tflops: 44.17  mfu: 14.16%
[rank0]:2025-11-04 00:58:16,101 - INFO -  step: 850  loss: -2.0000  grad_norm:  0.2800  memory: 13.42GiB(28.26%)  tps: 5,698  tflops: 43.40  mfu: 13.91%
[rank0]:2025-11-04 00:59:21,769 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 00:59:22,663 - INFO - Avg. fwd time: 13.2576 / Avg. bwd time: 28.6437 / Avg. batch time: 407.7116 (ms) / GPU bubble ratio: 17.78%
[rank2]:2025-11-04 00:59:22,686 - INFO - Avg. fwd time: 7.2275 / Avg. bwd time: 16.1902 / Avg. batch time: 437.7933 (ms) / GPU bubble ratio: 57.21%
[rank1]:2025-11-04 00:59:22,713 - INFO - Avg. fwd time: 9.5619 / Avg. bwd time: 19.7602 / Avg. batch time: 473.2795 (ms) / GPU bubble ratio: 50.44%
[rank0]:2025-11-04 00:59:22,737 - INFO - Avg. fwd time: 8.0403 / Avg. bwd time: 14.8176 / Avg. batch time: 505.1211 (ms) / GPU bubble ratio: 63.80%
[rank3]:2025-11-04 00:59:23,798 - INFO -  step: 900  loss:  0.2278  grad_norm:  0.2758  memory: 17.37GiB(36.55%)  tps: 5,942  tflops: 45.26  mfu: 14.51%
[rank2]:2025-11-04 00:59:24,831 - INFO -  step: 900  loss: -2.0000  grad_norm:  0.2758  memory:  6.51GiB(13.70%)  tps: 5,733  tflops: 43.66  mfu: 13.99%
[rank1]:2025-11-04 00:59:25,216 - INFO -  step: 900  loss: -2.0000  grad_norm:  0.2758  memory:  9.38GiB(19.75%)  tps: 5,744  tflops: 43.75  mfu: 14.02%
[rank0]:2025-11-04 00:59:27,305 - INFO -  step: 900  loss: -2.0000  grad_norm:  0.2758  memory: 13.42GiB(28.26%)  tps: 5,752  tflops: 43.81  mfu: 14.04%
[rank1]:2025-11-04 00:59:27,351 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251104_0059_stage1_step900.svg
[rank0]:2025-11-04 00:59:27,351 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251104_0059_stage0_step900.svg
[rank2]:2025-11-04 00:59:27,350 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251104_0059_stage2_step900.svg
[rank3]:2025-11-04 00:59:27,443 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/pipeline_schedule/251104_0059_real_step900_rank3.svg
[rank3]:> Batch Time: 452.95 ms, GPU Bubble Ratio: 67.70%, 50.74%, 59.79%, 36.32%
[rank3]:2025-11-04 00:59:27,484 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251104_0059_stage3_step900.svg
[rank0]:2025-11-04 01:00:33,508 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-04 01:00:36,519 - INFO -  step: 950  loss: -2.0000  grad_norm:  0.2330  memory:  6.51GiB(13.70%)  tps: 5,714  tflops: 43.52  mfu: 13.95%
[rank1]:2025-11-04 01:00:37,155 - INFO -  step: 950  loss: -2.0000  grad_norm:  0.2330  memory:  9.38GiB(19.75%)  tps: 5,694  tflops: 43.36  mfu: 13.90%
[rank3]:2025-11-04 01:00:37,692 - INFO -  step: 950  loss:  0.1975  grad_norm:  0.2330  memory: 17.37GiB(36.55%)  tps: 5,543  tflops: 42.22  mfu: 13.53%
[rank0]:2025-11-04 01:00:39,092 - INFO -  step: 950  loss: -2.0000  grad_norm:  0.2330  memory: 13.42GiB(28.26%)  tps: 5,706  tflops: 43.46  mfu: 13.93%
[rank0]:2025-11-04 01:01:44,926 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 01:01:45,657 - INFO - Avg. fwd time: 13.2933 / Avg. bwd time: 28.1467 / Avg. batch time: 404.0220 (ms) / GPU bubble ratio: 17.95%
[rank0]:2025-11-04 01:01:45,717 - INFO - Avg. fwd time: 8.0592 / Avg. bwd time: 14.4122 / Avg. batch time: 500.9485 (ms) / GPU bubble ratio: 64.11%
[rank2]:2025-11-04 01:01:45,723 - INFO - Avg. fwd time: 7.2378 / Avg. bwd time: 16.1233 / Avg. batch time: 433.8964 (ms) / GPU bubble ratio: 56.93%
[rank1]:2025-11-04 01:01:45,759 - INFO - Avg. fwd time: 9.5806 / Avg. bwd time: 19.6233 / Avg. batch time: 469.3041 (ms) / GPU bubble ratio: 50.22%
[rank3]:2025-11-04 01:01:46,474 - INFO -  step: 1000  loss:  0.2831  grad_norm:  0.3272  memory: 17.37GiB(36.55%)  tps: 5,955  tflops: 45.36  mfu: 14.54%
[rank3]:2025-11-04 01:01:46,475 - INFO - ðŸ”Ž  Running validation at step 1000
[rank2]:2025-11-04 01:01:47,914 - INFO -  step: 1000  loss: -2.0000  grad_norm:  0.3272  memory:  6.51GiB(13.70%)  tps: 5,737  tflops: 43.70  mfu: 14.00%
[rank2]:2025-11-04 01:01:47,915 - INFO - ðŸ”Ž  Running validation at step 1000
[rank1]:2025-11-04 01:01:48,481 - INFO -  step: 1000  loss: -2.0000  grad_norm:  0.3272  memory:  9.38GiB(19.75%)  tps: 5,743  tflops: 43.74  mfu: 14.02%
[rank1]:2025-11-04 01:01:48,481 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-11-04 01:01:50,420 - INFO -  step: 1000  loss: -2.0000  grad_norm:  0.3272  memory: 13.42GiB(28.26%)  tps: 5,742  tflops: 43.74  mfu: 14.02%
[rank0]:2025-11-04 01:01:50,421 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-11-04 01:02:11,220 - INFO - validate step: 1000  loss: -1.0000  memory: 13.42GiB(28.26%)  tps: 19,693
[rank2]:2025-11-04 01:02:11,257 - INFO - validate step: 1000  loss: -1.0000  memory:  6.51GiB(13.70%)  tps: 17,548
[rank1]:2025-11-04 01:02:11,239 - INFO - validate step: 1000  loss: -1.0000  memory:  9.38GiB(19.75%)  tps: 17,998
[rank3]:2025-11-04 01:02:11,248 - INFO - validate step: 1000  loss:  0.9446  memory: 17.37GiB(36.55%)  tps: 16,535
[rank0]:2025-11-04 01:02:11,305 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251104_0102_stage0_step1000.svg
[rank2]:2025-11-04 01:02:11,304 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251104_0102_stage2_step1000.svg
[rank1]:2025-11-04 01:02:11,305 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251104_0102_stage1_step1000.svg
[rank3]:2025-11-04 01:02:11,395 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/pipeline_schedule/251104_0102_real_step1000_rank3.svg
[rank3]:> Batch Time: 459.25 ms, GPU Bubble Ratio: 67.26%, 51.24%, 60.29%, 35.95%
[rank3]:2025-11-04 01:02:11,437 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251104_0102_stage3_step1000.svg
[rank0]:2025-11-04 01:03:17,792 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-11-04 01:03:20,751 - INFO -  step: 1050  loss: -2.0000  grad_norm:  0.3073  memory:  6.51GiB(13.70%)  tps: 5,894  tflops: 44.89  mfu: 14.39%
[rank1]:2025-11-04 01:03:21,335 - INFO -  step: 1050  loss: -2.0000  grad_norm:  0.3073  memory:  9.38GiB(19.75%)  tps: 5,843  tflops: 44.50  mfu: 14.26%
[rank3]:2025-11-04 01:03:22,207 - INFO -  step: 1050  loss:  0.3072  grad_norm:  0.3073  memory: 17.37GiB(36.55%)  tps: 5,773  tflops: 43.97  mfu: 14.09%
[rank0]:2025-11-04 01:03:23,525 - INFO -  step: 1050  loss: -2.0000  grad_norm:  0.3073  memory: 13.42GiB(28.26%)  tps: 5,665  tflops: 43.15  mfu: 13.83%
[rank0]:2025-11-04 01:04:29,010 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 01:04:29,754 - INFO - Avg. fwd time: 13.3251 / Avg. bwd time: 27.6551 / Avg. batch time: 400.3483 (ms) / GPU bubble ratio: 18.11%
[rank1]:2025-11-04 01:04:29,855 - INFO - Avg. fwd time: 9.5997 / Avg. bwd time: 19.4924 / Avg. batch time: 465.3410 (ms) / GPU bubble ratio: 49.99%
[rank2]:2025-11-04 01:04:29,819 - INFO - Avg. fwd time: 7.2484 / Avg. bwd time: 16.0601 / Avg. batch time: 430.0129 (ms) / GPU bubble ratio: 56.64%
[rank0]:2025-11-04 01:04:29,813 - INFO - Avg. fwd time: 8.0778 / Avg. bwd time: 14.0190 / Avg. batch time: 496.7947 (ms) / GPU bubble ratio: 64.42%
[rank2]:2025-11-04 01:04:32,057 - INFO -  step: 1100  loss: -2.0000  grad_norm:  0.2912  memory:  6.51GiB(13.70%)  tps: 5,744  tflops: 43.75  mfu: 14.02%
[rank1]:2025-11-04 01:04:32,609 - INFO -  step: 1100  loss: -2.0000  grad_norm:  0.2912  memory:  9.38GiB(19.75%)  tps: 5,747  tflops: 43.77  mfu: 14.03%
[rank3]:2025-11-04 01:04:33,097 - INFO -  step: 1100  loss:  0.3260  grad_norm:  0.2912  memory: 17.37GiB(36.55%)  tps: 5,778  tflops: 44.01  mfu: 14.10%
[rank0]:2025-11-04 01:04:34,645 - INFO -  step: 1100  loss: -2.0000  grad_norm:  0.2912  memory: 13.42GiB(28.26%)  tps: 5,759  tflops: 43.86  mfu: 14.06%
[rank1]:2025-11-04 01:04:34,694 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251104_0104_stage1_step1100.svg
[rank2]:2025-11-04 01:04:34,693 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251104_0104_stage2_step1100.svg
[rank0]:2025-11-04 01:04:34,693 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251104_0104_stage0_step1100.svg
[rank3]:2025-11-04 01:04:34,792 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/pipeline_schedule/251104_0104_real_step1100_rank3.svg
[rank3]:> Batch Time: 459.77 ms, GPU Bubble Ratio: 67.26%, 51.37%, 60.32%, 35.74%
[rank3]:2025-11-04 01:04:34,834 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251104_0104_stage3_step1100.svg
[rank0]:2025-11-04 01:05:40,309 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-04 01:05:43,454 - INFO -  step: 1150  loss: -2.0000  grad_norm:  0.2493  memory:  6.51GiB(13.70%)  tps: 5,737  tflops: 43.69  mfu: 14.00%
[rank1]:2025-11-04 01:05:43,844 - INFO -  step: 1150  loss: -2.0000  grad_norm:  0.2493  memory:  9.38GiB(19.75%)  tps: 5,750  tflops: 43.79  mfu: 14.04%
[rank3]:2025-11-04 01:05:44,670 - INFO -  step: 1150  loss:  0.2373  grad_norm:  0.2493  memory: 17.37GiB(36.55%)  tps: 5,723  tflops: 43.59  mfu: 13.97%
[rank0]:2025-11-04 01:05:45,945 - INFO -  step: 1150  loss: -2.0000  grad_norm:  0.2493  memory: 13.42GiB(28.26%)  tps: 5,745  tflops: 43.75  mfu: 14.02%
[rank0]:2025-11-04 01:06:51,976 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 01:06:52,879 - INFO - Avg. fwd time: 13.3538 / Avg. bwd time: 27.2515 / Avg. batch time: 397.3517 (ms) / GPU bubble ratio: 18.25%
[rank1]:2025-11-04 01:06:52,930 - INFO - Avg. fwd time: 9.6155 / Avg. bwd time: 19.3832 / Avg. batch time: 462.1108 (ms) / GPU bubble ratio: 49.80%
[rank2]:2025-11-04 01:06:52,902 - INFO - Avg. fwd time: 7.2571 / Avg. bwd time: 16.0075 / Avg. batch time: 426.8496 (ms) / GPU bubble ratio: 56.40%
[rank0]:2025-11-04 01:06:52,955 - INFO - Avg. fwd time: 8.0931 / Avg. bwd time: 13.6907 / Avg. batch time: 493.4106 (ms) / GPU bubble ratio: 64.68%
[rank3]:2025-11-04 01:06:53,696 - INFO -  step: 1200  loss:  0.1836  grad_norm:  0.3225  memory: 17.37GiB(36.55%)  tps: 5,934  tflops: 45.20  mfu: 14.49%
[rank3]:2025-11-04 01:06:53,697 - INFO - ðŸ”Ž  Running validation at step 1200
[rank2]:2025-11-04 01:06:55,018 - INFO -  step: 1200  loss: -2.0000  grad_norm:  0.3225  memory:  6.51GiB(13.70%)  tps: 5,724  tflops: 43.59  mfu: 13.97%
[rank2]:2025-11-04 01:06:55,018 - INFO - ðŸ”Ž  Running validation at step 1200
[rank1]:2025-11-04 01:06:55,467 - INFO -  step: 1200  loss: -2.0000  grad_norm:  0.3225  memory:  9.38GiB(19.75%)  tps: 5,719  tflops: 43.56  mfu: 13.96%
[rank1]:2025-11-04 01:06:55,467 - INFO - ðŸ”Ž  Running validation at step 1200
[rank0]:2025-11-04 01:06:57,483 - INFO -  step: 1200  loss: -2.0000  grad_norm:  0.3225  memory: 13.42GiB(28.26%)  tps: 5,726  tflops: 43.61  mfu: 13.98%
[rank0]:2025-11-04 01:06:57,483 - INFO - ðŸ”Ž  Running validation at step 1200
[rank0]:2025-11-04 01:07:18,294 - INFO - validate step: 1200  loss: -1.0000  memory: 13.42GiB(28.26%)  tps: 19,682
[rank0]:2025-11-04 01:07:18,295 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-04 01:07:18,301 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank3]:2025-11-04 01:07:18,323 - INFO - validate step: 1200  loss:  0.9506  memory: 17.37GiB(36.55%)  tps: 16,634
[rank3]:2025-11-04 01:07:18,325 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-04 01:07:18,331 - INFO - validate step: 1200  loss: -1.0000  memory:  6.51GiB(13.70%)  tps: 17,570
[rank2]:2025-11-04 01:07:18,332 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-11-04 01:07:18,311 - INFO - validate step: 1200  loss: -1.0000  memory:  9.38GiB(19.75%)  tps: 17,930
[rank1]:2025-11-04 01:07:18,312 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-04 01:07:19,958 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 1.63 seconds.
[rank1]:2025-11-04 01:07:20,402 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 2.09 seconds.
[rank3]:2025-11-04 01:07:21,582 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.26 seconds.
[rank0]:2025-11-04 01:07:21,871 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-11-04 01:07:21,880 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.59 seconds.
[rank2]:2025-11-04 01:07:21,931 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251104_0107_stage2_step1200.svg
[rank1]:2025-11-04 01:07:21,931 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251104_0107_stage1_step1200.svg
[rank0]:2025-11-04 01:07:21,949 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251104_0107_stage0_step1200.svg
[rank3]:2025-11-04 01:07:22,048 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/pipeline_schedule/251104_0107_real_step1200_rank3.svg
[rank3]:> Batch Time: 457.28 ms, GPU Bubble Ratio: 67.78%, 51.07%, 60.10%, 36.56%
[rank3]:2025-11-04 01:07:22,199 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251104_0107_stage3_step1200.svg
[rank0]:2025-11-04 01:08:30,113 - INFO - [GC] Peforming periodical GC collection 0.20 seconds
[rank1]:2025-11-04 01:08:33,315 - INFO -  step: 1250  loss: -2.0000  grad_norm:  0.2807  memory:  9.38GiB(19.75%)  tps: 5,461  tflops: 41.59  mfu: 13.33%
[rank2]:2025-11-04 01:08:33,406 - INFO -  step: 1250  loss: -2.0000  grad_norm:  0.2807  memory:  6.51GiB(13.70%)  tps: 5,456  tflops: 41.55  mfu: 13.32%
[rank3]:2025-11-04 01:08:34,523 - INFO -  step: 1250  loss:  0.2972  grad_norm:  0.2807  memory: 17.37GiB(36.55%)  tps: 5,375  tflops: 40.94  mfu: 13.12%
[rank0]:2025-11-04 01:08:35,751 - INFO -  step: 1250  loss: -2.0000  grad_norm:  0.2807  memory: 13.42GiB(28.26%)  tps: 5,288  tflops: 40.28  mfu: 12.91%
[rank0]:2025-11-04 01:09:41,332 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 01:09:42,072 - INFO - Avg. fwd time: 13.3707 / Avg. bwd time: 26.9610 / Avg. batch time: 395.1811 (ms) / GPU bubble ratio: 18.35%
[rank1]:2025-11-04 01:09:42,175 - INFO - Avg. fwd time: 9.6267 / Avg. bwd time: 19.3034 / Avg. batch time: 459.7884 (ms) / GPU bubble ratio: 49.66%
[rank2]:2025-11-04 01:09:42,139 - INFO - Avg. fwd time: 7.2631 / Avg. bwd time: 15.9681 / Avg. batch time: 424.5760 (ms) / GPU bubble ratio: 56.23%
[rank0]:2025-11-04 01:09:42,133 - INFO - Avg. fwd time: 8.1063 / Avg. bwd time: 13.4462 / Avg. batch time: 490.9874 (ms) / GPU bubble ratio: 64.88%
[rank2]:2025-11-04 01:09:44,371 - INFO -  step: 1300  loss: -2.0000  grad_norm:  0.2770  memory:  6.51GiB(13.70%)  tps: 5,772  tflops: 43.96  mfu: 14.09%
[rank1]:2025-11-04 01:09:44,793 - INFO -  step: 1300  loss: -2.0000  grad_norm:  0.2770  memory:  9.38GiB(19.75%)  tps: 5,730  tflops: 43.64  mfu: 13.99%
[rank3]:2025-11-04 01:09:45,503 - INFO -  step: 1300  loss:  0.2628  grad_norm:  0.2770  memory: 17.37GiB(36.55%)  tps: 5,771  tflops: 43.95  mfu: 14.09%
[rank2]:2025-11-04 01:09:46,987 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251104_0109_stage2_step1300.svg
[rank0]:2025-11-04 01:09:46,935 - INFO -  step: 1300  loss: -2.0000  grad_norm:  0.2770  memory: 13.42GiB(28.26%)  tps: 5,754  tflops: 43.82  mfu: 14.05%
[rank0]:2025-11-04 01:09:46,986 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251104_0109_stage0_step1300.svg
[rank1]:2025-11-04 01:09:46,987 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251104_0109_stage1_step1300.svg
[rank3]:2025-11-04 01:09:47,084 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/pipeline_schedule/251104_0109_real_step1300_rank3.svg
[rank3]:> Batch Time: 456.47 ms, GPU Bubble Ratio: 67.87%, 51.00%, 60.07%, 36.69%
[rank3]:2025-11-04 01:09:47,130 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251104_0109_stage3_step1300.svg
[rank0]:2025-11-04 01:10:52,551 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 01:10:54,565 - INFO -  step: 1350  loss:  0.2593  grad_norm:  0.2485  memory: 17.37GiB(36.55%)  tps: 5,931  tflops: 45.17  mfu: 14.48%
[rank2]:2025-11-04 01:10:55,565 - INFO -  step: 1350  loss: -2.0000  grad_norm:  0.2485  memory:  6.51GiB(13.70%)  tps: 5,753  tflops: 43.82  mfu: 14.04%
[rank1]:2025-11-04 01:10:56,013 - INFO -  step: 1350  loss: -2.0000  grad_norm:  0.2485  memory:  9.38GiB(19.75%)  tps: 5,751  tflops: 43.80  mfu: 14.04%
[rank0]:2025-11-04 01:10:58,025 - INFO -  step: 1350  loss: -2.0000  grad_norm:  0.2485  memory: 13.42GiB(28.26%)  tps: 5,762  tflops: 43.88  mfu: 14.07%
[rank0]:2025-11-04 01:12:03,685 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 01:12:04,429 - INFO - Avg. fwd time: 13.3878 / Avg. bwd time: 26.6737 / Avg. batch time: 393.0216 (ms) / GPU bubble ratio: 18.45%
[rank2]:2025-11-04 01:12:04,497 - INFO - Avg. fwd time: 7.2691 / Avg. bwd time: 15.9290 / Avg. batch time: 422.2974 (ms) / GPU bubble ratio: 56.05%
[rank0]:2025-11-04 01:12:04,490 - INFO - Avg. fwd time: 8.1169 / Avg. bwd time: 13.2015 / Avg. batch time: 488.5458 (ms) / GPU bubble ratio: 65.09%
[rank1]:2025-11-04 01:12:04,532 - INFO - Avg. fwd time: 9.6379 / Avg. bwd time: 19.2240 / Avg. batch time: 457.4619 (ms) / GPU bubble ratio: 49.53%
[rank2]:2025-11-04 01:12:06,673 - INFO -  step: 1400  loss: -2.0000  grad_norm:  0.2368  memory:  6.51GiB(13.70%)  tps: 5,760  tflops: 43.87  mfu: 14.06%
[rank2]:2025-11-04 01:12:06,674 - INFO - ðŸ”Ž  Running validation at step 1400
[rank1]:2025-11-04 01:12:07,367 - INFO -  step: 1400  loss: -2.0000  grad_norm:  0.2368  memory:  9.38GiB(19.75%)  tps: 5,740  tflops: 43.72  mfu: 14.01%
[rank1]:2025-11-04 01:12:07,367 - INFO - ðŸ”Ž  Running validation at step 1400
[rank3]:2025-11-04 01:12:07,867 - INFO -  step: 1400  loss:  0.2302  grad_norm:  0.2368  memory: 17.37GiB(36.55%)  tps: 5,588  tflops: 42.56  mfu: 13.64%
[rank3]:2025-11-04 01:12:07,867 - INFO - ðŸ”Ž  Running validation at step 1400
[rank0]:2025-11-04 01:12:09,249 - INFO -  step: 1400  loss: -2.0000  grad_norm:  0.2368  memory: 13.42GiB(28.26%)  tps: 5,751  tflops: 43.80  mfu: 14.04%
[rank0]:2025-11-04 01:12:09,249 - INFO - ðŸ”Ž  Running validation at step 1400
[rank1]:2025-11-04 01:12:30,084 - INFO - validate step: 1400  loss: -1.0000  memory:  9.38GiB(19.75%)  tps: 18,031
[rank2]:2025-11-04 01:12:30,103 - INFO - validate step: 1400  loss: -1.0000  memory:  6.51GiB(13.70%)  tps: 17,482
[rank0]:2025-11-04 01:12:30,067 - INFO - validate step: 1400  loss: -1.0000  memory: 13.42GiB(28.26%)  tps: 19,676
[rank3]:2025-11-04 01:12:30,097 - INFO - validate step: 1400  loss:  0.9477  memory: 17.37GiB(36.55%)  tps: 18,426
[rank1]:2025-11-04 01:12:30,154 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251104_0112_stage1_step1400.svg
[rank2]:2025-11-04 01:12:30,153 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251104_0112_stage2_step1400.svg
[rank0]:2025-11-04 01:12:30,154 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251104_0112_stage0_step1400.svg
[rank3]:2025-11-04 01:12:30,243 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/pipeline_schedule/251104_0112_real_step1400_rank3.svg
[rank3]:> Batch Time: 458.50 ms, GPU Bubble Ratio: 67.23%, 51.25%, 60.24%, 35.80%
[rank3]:2025-11-04 01:12:30,289 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251104_0112_stage3_step1400.svg
[rank0]:2025-11-04 01:13:36,681 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-04 01:13:38,536 - INFO -  step: 1450  loss:  0.2325  grad_norm:  0.2442  memory: 17.37GiB(36.55%)  tps: 5,985  tflops: 45.58  mfu: 14.61%
[rank2]:2025-11-04 01:13:39,683 - INFO -  step: 1450  loss: -2.0000  grad_norm:  0.2442  memory:  6.51GiB(13.70%)  tps: 5,887  tflops: 44.84  mfu: 14.37%
[rank1]:2025-11-04 01:13:40,218 - INFO -  step: 1450  loss: -2.0000  grad_norm:  0.2442  memory:  9.38GiB(19.75%)  tps: 5,840  tflops: 44.48  mfu: 14.26%
[rank0]:2025-11-04 01:13:42,251 - INFO -  step: 1450  loss: -2.0000  grad_norm:  0.2442  memory: 13.42GiB(28.26%)  tps: 5,674  tflops: 43.22  mfu: 13.85%
[rank0]:2025-11-04 01:14:47,855 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 01:14:48,752 - INFO - Avg. fwd time: 13.4039 / Avg. bwd time: 26.4212 / Avg. batch time: 391.1333 (ms) / GPU bubble ratio: 18.54%
[rank1]:2025-11-04 01:14:48,805 - INFO - Avg. fwd time: 9.6481 / Avg. bwd time: 19.1588 / Avg. batch time: 455.4331 (ms) / GPU bubble ratio: 49.40%
[rank2]:2025-11-04 01:14:48,777 - INFO - Avg. fwd time: 7.2751 / Avg. bwd time: 15.8966 / Avg. batch time: 420.3013 (ms) / GPU bubble ratio: 55.90%
[rank0]:2025-11-04 01:14:48,831 - INFO - Avg. fwd time: 8.1265 / Avg. bwd time: 12.9887 / Avg. batch time: 486.4204 (ms) / GPU bubble ratio: 65.27%
[rank3]:2025-11-04 01:14:49,748 - INFO -  step: 1500  loss:  0.2707  grad_norm:  0.3136  memory: 17.37GiB(36.55%)  tps: 5,752  tflops: 43.81  mfu: 14.04%
[rank2]:2025-11-04 01:14:50,890 - INFO -  step: 1500  loss: -2.0000  grad_norm:  0.3136  memory:  6.51GiB(13.70%)  tps: 5,752  tflops: 43.81  mfu: 14.04%
[rank1]:2025-11-04 01:14:51,231 - INFO -  step: 1500  loss: -2.0000  grad_norm:  0.3136  memory:  9.38GiB(19.75%)  tps: 5,768  tflops: 43.93  mfu: 14.08%
[rank0]:2025-11-04 01:14:53,449 - INFO -  step: 1500  loss: -2.0000  grad_norm:  0.3136  memory: 13.42GiB(28.26%)  tps: 5,753  tflops: 43.82  mfu: 14.04%
[rank0]:2025-11-04 01:14:53,500 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251104_0114_stage0_step1500.svg
[rank1]:2025-11-04 01:14:53,501 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251104_0114_stage1_step1500.svg
[rank2]:2025-11-04 01:14:53,500 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251104_0114_stage2_step1500.svg
[rank3]:2025-11-04 01:14:53,588 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/pipeline_schedule/251104_0114_real_step1500_rank3.svg
[rank3]:> Batch Time: 455.70 ms, GPU Bubble Ratio: 67.83%, 50.77%, 59.90%, 36.55%
[rank3]:2025-11-04 01:14:53,635 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251104_0114_stage3_step1500.svg
[rank0]:2025-11-04 01:15:59,612 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-04 01:16:02,624 - INFO -  step: 1550  loss: -2.0000  grad_norm:  0.2480  memory:  6.51GiB(13.70%)  tps: 5,710  tflops: 43.49  mfu: 13.94%
[rank1]:2025-11-04 01:16:03,139 - INFO -  step: 1550  loss: -2.0000  grad_norm:  0.2480  memory:  9.38GiB(19.75%)  tps: 5,696  tflops: 43.38  mfu: 13.90%
[rank3]:2025-11-04 01:16:03,834 - INFO -  step: 1550  loss:  0.2258  grad_norm:  0.2480  memory: 17.37GiB(36.55%)  tps: 5,529  tflops: 42.11  mfu: 13.50%
[rank0]:2025-11-04 01:16:05,200 - INFO -  step: 1550  loss: -2.0000  grad_norm:  0.2480  memory: 13.42GiB(28.26%)  tps: 5,709  tflops: 43.48  mfu: 13.94%
[rank0]:2025-11-04 01:17:11,126 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 01:17:11,860 - INFO - Avg. fwd time: 13.4161 / Avg. bwd time: 26.2386 / Avg. batch time: 389.7718 (ms) / GPU bubble ratio: 18.61%
[rank2]:2025-11-04 01:17:11,927 - INFO - Avg. fwd time: 7.2792 / Avg. bwd time: 15.8723 / Avg. batch time: 418.8640 (ms) / GPU bubble ratio: 55.78%
[rank0]:2025-11-04 01:17:11,921 - INFO - Avg. fwd time: 8.1335 / Avg. bwd time: 12.8282 / Avg. batch time: 484.8778 (ms) / GPU bubble ratio: 65.42%
[rank1]:2025-11-04 01:17:11,964 - INFO - Avg. fwd time: 9.6558 / Avg. bwd time: 19.1080 / Avg. batch time: 453.9645 (ms) / GPU bubble ratio: 49.31%
[rank3]:2025-11-04 01:17:13,176 - INFO -  step: 1600  loss:  0.1934  grad_norm:  0.2881  memory: 17.37GiB(36.55%)  tps: 5,907  tflops: 44.99  mfu: 14.42%
[rank3]:2025-11-04 01:17:13,177 - INFO - ðŸ”Ž  Running validation at step 1600
[rank2]:2025-11-04 01:17:14,210 - INFO -  step: 1600  loss: -2.0000  grad_norm:  0.2881  memory:  6.51GiB(13.70%)  tps: 5,722  tflops: 43.58  mfu: 13.97%
[rank2]:2025-11-04 01:17:14,210 - INFO - ðŸ”Ž  Running validation at step 1600
[rank1]:2025-11-04 01:17:14,582 - INFO -  step: 1600  loss: -2.0000  grad_norm:  0.2881  memory:  9.38GiB(19.75%)  tps: 5,733  tflops: 43.67  mfu: 14.00%
[rank1]:2025-11-04 01:17:14,582 - INFO - ðŸ”Ž  Running validation at step 1600
[rank0]:2025-11-04 01:17:16,631 - INFO -  step: 1600  loss: -2.0000  grad_norm:  0.2881  memory: 13.42GiB(28.26%)  tps: 5,734  tflops: 43.67  mfu: 14.00%
[rank0]:2025-11-04 01:17:16,631 - INFO - ðŸ”Ž  Running validation at step 1600
[rank1]:2025-11-04 01:17:37,430 - INFO - validate step: 1600  loss: -1.0000  memory:  9.38GiB(19.75%)  tps: 17,927
[rank0]:2025-11-04 01:17:37,413 - INFO - validate step: 1600  loss: -1.0000  memory: 13.42GiB(28.26%)  tps: 19,710
[rank3]:2025-11-04 01:17:37,442 - INFO - validate step: 1600  loss:  0.9512  memory: 17.37GiB(36.55%)  tps: 16,881
[rank2]:2025-11-04 01:17:37,450 - INFO - validate step: 1600  loss: -1.0000  memory:  6.51GiB(13.70%)  tps: 17,625
[rank1]:2025-11-04 01:17:37,506 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251104_0117_stage1_step1600.svg
[rank0]:2025-11-04 01:17:37,507 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251104_0117_stage0_step1600.svg
[rank2]:2025-11-04 01:17:37,506 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251104_0117_stage2_step1600.svg
[rank3]:2025-11-04 01:17:37,600 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/pipeline_schedule/251104_0117_real_step1600_rank3.svg
[rank3]:> Batch Time: 459.53 ms, GPU Bubble Ratio: 67.98%, 51.28%, 60.28%, 35.96%
[rank3]:2025-11-04 01:17:37,648 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251104_0117_stage3_step1600.svg
[rank3]:2025-11-04 01:18:07,850 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-11-04 01:18:08,035 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-11-04 01:18:08,057 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-11-04 01:18:08,076 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-11-04 01:18:44,262 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-04 01:18:46,178 - INFO -  step: 1650  loss:  0.2830  grad_norm:  0.2888  memory: 17.37GiB(36.55%)  tps: 5,959  tflops: 45.39  mfu: 14.55%
[rank2]:2025-11-04 01:18:47,342 - INFO -  step: 1650  loss: -2.0000  grad_norm:  0.2888  memory:  6.51GiB(13.70%)  tps: 5,860  tflops: 44.63  mfu: 14.31%
[rank1]:2025-11-04 01:18:47,693 - INFO -  step: 1650  loss: -2.0000  grad_norm:  0.2888  memory:  9.38GiB(19.75%)  tps: 5,830  tflops: 44.40  mfu: 14.23%
[rank0]:2025-11-04 01:18:49,801 - INFO -  step: 1650  loss: -2.0000  grad_norm:  0.2888  memory: 13.42GiB(28.26%)  tps: 5,658  tflops: 43.10  mfu: 13.81%
[rank0]:2025-11-04 01:19:55,742 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 01:19:56,462 - INFO - Avg. fwd time: 13.4298 / Avg. bwd time: 26.0448 / Avg. batch time: 388.3317 (ms) / GPU bubble ratio: 18.68%
[rank0]:2025-11-04 01:19:56,522 - INFO - Avg. fwd time: 8.1406 / Avg. bwd time: 12.6636 / Avg. batch time: 483.2451 (ms) / GPU bubble ratio: 65.56%
[rank2]:2025-11-04 01:19:56,528 - INFO - Avg. fwd time: 7.2832 / Avg. bwd time: 15.8463 / Avg. batch time: 417.3395 (ms) / GPU bubble ratio: 55.66%
[rank1]:2025-11-04 01:19:56,564 - INFO - Avg. fwd time: 9.6630 / Avg. bwd time: 19.0552 / Avg. batch time: 452.4101 (ms) / GPU bubble ratio: 49.22%
[rank3]:2025-11-04 01:19:57,382 - INFO -  step: 1700  loss:  0.2442  grad_norm:  0.3508  memory: 17.37GiB(36.55%)  tps: 5,753  tflops: 43.81  mfu: 14.04%
[rank2]:2025-11-04 01:19:58,700 - INFO -  step: 1700  loss: -2.0000  grad_norm:  0.3508  memory:  6.51GiB(13.70%)  tps: 5,740  tflops: 43.72  mfu: 14.01%
[rank1]:2025-11-04 01:19:59,225 - INFO -  step: 1700  loss: -2.0000  grad_norm:  0.3508  memory:  9.38GiB(19.75%)  tps: 5,726  tflops: 43.61  mfu: 13.98%
[rank1]:2025-11-04 01:20:01,437 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251104_0119_stage1_step1700.svg
[rank0]:2025-11-04 01:20:01,386 - INFO -  step: 1700  loss: -2.0000  grad_norm:  0.3508  memory: 13.42GiB(28.26%)  tps: 5,722  tflops: 43.58  mfu: 13.97%
[rank0]:2025-11-04 01:20:01,438 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251104_0120_stage0_step1700.svg
[rank2]:2025-11-04 01:20:01,437 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251104_0119_stage2_step1700.svg
[rank3]:2025-11-04 01:20:01,536 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/pipeline_schedule/251104_0119_real_step1700_rank3.svg
[rank3]:> Batch Time: 455.48 ms, GPU Bubble Ratio: 67.80%, 50.92%, 59.97%, 36.54%
[rank3]:2025-11-04 01:20:01,583 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251104_0119_stage3_step1700.svg
[rank0]:2025-11-04 01:21:07,395 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-04 01:21:10,454 - INFO -  step: 1750  loss: -2.0000  grad_norm:  0.2560  memory:  6.51GiB(13.70%)  tps: 5,708  tflops: 43.48  mfu: 13.93%
[rank1]:2025-11-04 01:21:10,938 - INFO -  step: 1750  loss: -2.0000  grad_norm:  0.2560  memory:  9.38GiB(19.75%)  tps: 5,712  tflops: 43.50  mfu: 13.94%
[rank3]:2025-11-04 01:21:11,744 - INFO -  step: 1750  loss:  0.2073  grad_norm:  0.2560  memory: 17.37GiB(36.55%)  tps: 5,508  tflops: 41.95  mfu: 13.45%
[rank0]:2025-11-04 01:21:13,072 - INFO -  step: 1750  loss: -2.0000  grad_norm:  0.2560  memory: 13.42GiB(28.26%)  tps: 5,714  tflops: 43.52  mfu: 13.95%
[rank0]:2025-11-04 01:22:19,035 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 01:22:19,941 - INFO - Avg. fwd time: 13.4409 / Avg. bwd time: 25.8734 / Avg. batch time: 387.0506 (ms) / GPU bubble ratio: 18.74%
[rank2]:2025-11-04 01:22:19,966 - INFO - Avg. fwd time: 7.2868 / Avg. bwd time: 15.8231 / Avg. batch time: 415.9867 (ms) / GPU bubble ratio: 55.56%
[rank1]:2025-11-04 01:22:19,995 - INFO - Avg. fwd time: 9.6696 / Avg. bwd time: 19.0080 / Avg. batch time: 451.0300 (ms) / GPU bubble ratio: 49.13%
[rank0]:2025-11-04 01:22:20,022 - INFO - Avg. fwd time: 8.1467 / Avg. bwd time: 12.5210 / Avg. batch time: 481.7980 (ms) / GPU bubble ratio: 65.68%
[rank3]:2025-11-04 01:22:20,737 - INFO -  step: 1800  loss:  0.1878  grad_norm:  0.3356  memory: 17.37GiB(36.55%)  tps: 5,937  tflops: 45.22  mfu: 14.49%
[rank3]:2025-11-04 01:22:20,738 - INFO - ðŸ”Ž  Running validation at step 1800
[rank2]:2025-11-04 01:22:22,133 - INFO -  step: 1800  loss: -2.0000  grad_norm:  0.3356  memory:  6.51GiB(13.70%)  tps: 5,714  tflops: 43.52  mfu: 13.95%
[rank2]:2025-11-04 01:22:22,133 - INFO - ðŸ”Ž  Running validation at step 1800
[rank1]:2025-11-04 01:22:22,504 - INFO -  step: 1800  loss: -2.0000  grad_norm:  0.3356  memory:  9.38GiB(19.75%)  tps: 5,723  tflops: 43.59  mfu: 13.97%
[rank1]:2025-11-04 01:22:22,505 - INFO - ðŸ”Ž  Running validation at step 1800
[rank0]:2025-11-04 01:22:24,590 - INFO -  step: 1800  loss: -2.0000  grad_norm:  0.3356  memory: 13.42GiB(28.26%)  tps: 5,727  tflops: 43.62  mfu: 13.98%
[rank0]:2025-11-04 01:22:24,591 - INFO - ðŸ”Ž  Running validation at step 1800
[rank0]:2025-11-04 01:22:45,419 - INFO - validate step: 1800  loss: -1.0000  memory: 13.42GiB(28.26%)  tps: 19,665
[rank1]:2025-11-04 01:22:45,436 - INFO - validate step: 1800  loss: -1.0000  memory:  9.38GiB(19.75%)  tps: 17,862
[rank3]:2025-11-04 01:22:45,448 - INFO - validate step: 1800  loss:  0.9509  memory: 17.37GiB(36.55%)  tps: 16,577
[rank2]:2025-11-04 01:22:45,455 - INFO - validate step: 1800  loss: -1.0000  memory:  6.51GiB(13.70%)  tps: 17,563
[rank2]:2025-11-04 01:22:45,507 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251104_0122_stage2_step1800.svg
[rank0]:2025-11-04 01:22:45,508 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251104_0122_stage0_step1800.svg
[rank1]:2025-11-04 01:22:45,508 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251104_0122_stage1_step1800.svg
[rank3]:2025-11-04 01:22:45,596 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/pipeline_schedule/251104_0122_real_step1800_rank3.svg
[rank3]:> Batch Time: 458.78 ms, GPU Bubble Ratio: 68.04%, 51.26%, 60.24%, 36.85%
[rank3]:2025-11-04 01:22:45,643 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251104_0122_stage3_step1800.svg
[rank0]:2025-11-04 01:23:52,321 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-11-04 01:23:55,252 - INFO -  step: 1850  loss: -2.0000  grad_norm:  0.2975  memory:  6.51GiB(13.70%)  tps: 5,869  tflops: 44.70  mfu: 14.33%
[rank1]:2025-11-04 01:23:55,909 - INFO -  step: 1850  loss: -2.0000  grad_norm:  0.2975  memory:  9.38GiB(19.75%)  tps: 5,812  tflops: 44.27  mfu: 14.19%
[rank3]:2025-11-04 01:23:56,657 - INFO -  step: 1850  loss:  0.2896  grad_norm:  0.2975  memory: 17.37GiB(36.55%)  tps: 5,752  tflops: 43.81  mfu: 14.04%
[rank0]:2025-11-04 01:23:58,102 - INFO -  step: 1850  loss: -2.0000  grad_norm:  0.2975  memory: 13.42GiB(28.26%)  tps: 5,635  tflops: 42.92  mfu: 13.76%
[rank0]:2025-11-04 01:25:04,038 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 01:25:04,763 - INFO - Avg. fwd time: 13.4506 / Avg. bwd time: 25.7480 / Avg. batch time: 386.1257 (ms) / GPU bubble ratio: 18.79%
[rank0]:2025-11-04 01:25:04,821 - INFO - Avg. fwd time: 8.1521 / Avg. bwd time: 12.4081 / Avg. batch time: 480.7439 (ms) / GPU bubble ratio: 65.79%
[rank2]:2025-11-04 01:25:04,826 - INFO - Avg. fwd time: 7.2899 / Avg. bwd time: 15.8062 / Avg. batch time: 415.0077 (ms) / GPU bubble ratio: 55.48%
[rank1]:2025-11-04 01:25:04,861 - INFO - Avg. fwd time: 9.6753 / Avg. bwd time: 18.9725 / Avg. batch time: 450.0279 (ms) / GPU bubble ratio: 49.07%
[rank3]:2025-11-04 01:25:05,890 - INFO -  step: 1900  loss:  0.1986  grad_norm:  0.2876  memory: 17.37GiB(36.55%)  tps: 5,916  tflops: 45.06  mfu: 14.44%
[rank2]:2025-11-04 01:25:06,973 - INFO -  step: 1900  loss: -2.0000  grad_norm:  0.2876  memory:  6.51GiB(13.70%)  tps: 5,711  tflops: 43.50  mfu: 13.94%
[rank1]:2025-11-04 01:25:07,561 - INFO -  step: 1900  loss: -2.0000  grad_norm:  0.2876  memory:  9.38GiB(19.75%)  tps: 5,717  tflops: 43.54  mfu: 13.95%
[rank1]:2025-11-04 01:25:09,719 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251104_0125_stage1_step1900.svg
[rank0]:2025-11-04 01:25:09,667 - INFO -  step: 1900  loss: -2.0000  grad_norm:  0.2876  memory: 13.42GiB(28.26%)  tps: 5,724  tflops: 43.59  mfu: 13.97%
[rank0]:2025-11-04 01:25:09,719 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251104_0125_stage0_step1900.svg
[rank2]:2025-11-04 01:25:09,718 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251104_0125_stage2_step1900.svg
[rank3]:2025-11-04 01:25:09,807 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/pipeline_schedule/251104_0125_real_step1900_rank3.svg
[rank3]:> Batch Time: 459.80 ms, GPU Bubble Ratio: 68.00%, 51.27%, 60.31%, 35.94%
[rank3]:2025-11-04 01:25:09,854 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251104_0125_stage3_step1900.svg
[rank0]:2025-11-04 01:26:15,755 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-04 01:26:18,776 - INFO -  step: 1950  loss: -2.0000  grad_norm:  0.1813  memory:  6.51GiB(13.70%)  tps: 5,705  tflops: 43.45  mfu: 13.93%
[rank1]:2025-11-04 01:26:19,301 - INFO -  step: 1950  loss: -2.0000  grad_norm:  0.1813  memory:  9.38GiB(19.75%)  tps: 5,709  tflops: 43.48  mfu: 13.94%
[rank3]:2025-11-04 01:26:19,654 - INFO -  step: 1950  loss:  0.1654  grad_norm:  0.1813  memory: 17.37GiB(36.55%)  tps: 5,553  tflops: 42.29  mfu: 13.56%
[rank0]:2025-11-04 01:26:21,426 - INFO -  step: 1950  loss: -2.0000  grad_norm:  0.1813  memory: 13.42GiB(28.26%)  tps: 5,708  tflops: 43.47  mfu: 13.93%
[rank0]:2025-11-04 01:27:27,118 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 01:27:27,866 - INFO - Avg. fwd time: 13.4597 / Avg. bwd time: 25.6062 / Avg. batch time: 385.0655 (ms) / GPU bubble ratio: 18.84%
[rank0]:2025-11-04 01:27:27,927 - INFO - Avg. fwd time: 8.1572 / Avg. bwd time: 12.2966 / Avg. batch time: 479.5468 (ms) / GPU bubble ratio: 65.88%
[rank2]:2025-11-04 01:27:27,932 - INFO - Avg. fwd time: 7.2931 / Avg. bwd time: 15.7884 / Avg. batch time: 413.8875 (ms) / GPU bubble ratio: 55.39%
[rank1]:2025-11-04 01:27:27,968 - INFO - Avg. fwd time: 9.6810 / Avg. bwd time: 18.9348 / Avg. batch time: 448.8852 (ms) / GPU bubble ratio: 49.00%
[rank2]:2025-11-04 01:27:30,133 - INFO -  step: 2000  loss: -2.0000  grad_norm:  0.3515  memory:  6.51GiB(13.70%)  tps: 5,740  tflops: 43.72  mfu: 14.01%
[rank2]:2025-11-04 01:27:30,133 - INFO - ðŸ”Ž  Running validation at step 2000
[rank1]:2025-11-04 01:27:30,835 - INFO -  step: 2000  loss: -2.0000  grad_norm:  0.3515  memory:  9.38GiB(19.75%)  tps: 5,726  tflops: 43.61  mfu: 13.98%
[rank1]:2025-11-04 01:27:30,836 - INFO - ðŸ”Ž  Running validation at step 2000
[rank3]:2025-11-04 01:27:31,481 - INFO -  step: 2000  loss:  0.2229  grad_norm:  0.3515  memory: 17.37GiB(36.55%)  tps: 5,703  tflops: 43.43  mfu: 13.92%
[rank3]:2025-11-04 01:27:31,482 - INFO - ðŸ”Ž  Running validation at step 2000
[rank0]:2025-11-04 01:27:32,828 - INFO -  step: 2000  loss: -2.0000  grad_norm:  0.3515  memory: 13.42GiB(28.26%)  tps: 5,737  tflops: 43.69  mfu: 14.00%
[rank0]:2025-11-04 01:27:32,829 - INFO - ðŸ”Ž  Running validation at step 2000
[rank1]:2025-11-04 01:27:53,622 - INFO - validate step: 2000  loss: -1.0000  memory:  9.38GiB(19.75%)  tps: 17,976
[rank3]:2025-11-04 01:27:53,634 - INFO - validate step: 2000  loss:  0.9532  memory: 17.37GiB(36.55%)  tps: 18,491
[rank0]:2025-11-04 01:27:53,601 - INFO - validate step: 2000  loss: -1.0000  memory: 13.42GiB(28.26%)  tps: 19,718
[rank0]:2025-11-04 01:27:53,694 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251104_0127_stage0_step2000.svg
[rank2]:2025-11-04 01:27:53,640 - INFO - validate step: 2000  loss: -1.0000  memory:  6.51GiB(13.70%)  tps: 17,425
[rank2]:2025-11-04 01:27:53,692 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251104_0127_stage2_step2000.svg
[rank1]:2025-11-04 01:27:53,693 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251104_0127_stage1_step2000.svg
[rank3]:2025-11-04 01:27:53,779 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/pipeline_schedule/251104_0127_real_step2000_rank3.svg
[rank3]:> Batch Time: 459.56 ms, GPU Bubble Ratio: 67.26%, 51.31%, 60.30%, 35.92%
[rank3]:2025-11-04 01:27:53,828 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251104_0127_stage3_step2000.svg
[rank0]:2025-11-04 01:29:00,303 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-11-04 01:29:03,322 - INFO -  step: 2050  loss: -2.0000  grad_norm:  0.3145  memory:  6.51GiB(13.70%)  tps: 5,878  tflops: 44.77  mfu: 14.35%
[rank1]:2025-11-04 01:29:03,950 - INFO -  step: 2050  loss: -2.0000  grad_norm:  0.3145  memory:  9.38GiB(19.75%)  tps: 5,824  tflops: 44.36  mfu: 14.22%
[rank3]:2025-11-04 01:29:05,017 - INFO -  step: 2050  loss:  0.1963  grad_norm:  0.3145  memory: 17.37GiB(36.55%)  tps: 5,738  tflops: 43.70  mfu: 14.01%
[rank0]:2025-11-04 01:29:05,982 - INFO -  step: 2050  loss: -2.0000  grad_norm:  0.3145  memory: 13.42GiB(28.26%)  tps: 5,659  tflops: 43.10  mfu: 13.81%
[rank0]:2025-11-04 01:30:11,747 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 01:30:12,642 - INFO - Avg. fwd time: 13.4692 / Avg. bwd time: 25.4800 / Avg. batch time: 384.1339 (ms) / GPU bubble ratio: 18.88%
[rank2]:2025-11-04 01:30:12,668 - INFO - Avg. fwd time: 7.2962 / Avg. bwd time: 15.7728 / Avg. batch time: 412.9029 (ms) / GPU bubble ratio: 55.30%
[rank1]:2025-11-04 01:30:12,698 - INFO - Avg. fwd time: 9.6865 / Avg. bwd time: 18.9021 / Avg. batch time: 447.8858 (ms) / GPU bubble ratio: 48.94%
[rank0]:2025-11-04 01:30:12,726 - INFO - Avg. fwd time: 8.1620 / Avg. bwd time: 12.1943 / Avg. batch time: 478.4999 (ms) / GPU bubble ratio: 65.97%
[rank3]:2025-11-04 01:30:13,520 - INFO -  step: 2100  loss:  0.2331  grad_norm:  0.3085  memory: 17.37GiB(36.55%)  tps: 5,979  tflops: 45.54  mfu: 14.60%
[rank2]:2025-11-04 01:30:14,741 - INFO -  step: 2100  loss: -2.0000  grad_norm:  0.3085  memory:  6.51GiB(13.70%)  tps: 5,735  tflops: 43.68  mfu: 14.00%
[rank1]:2025-11-04 01:30:15,321 - INFO -  step: 2100  loss: -2.0000  grad_norm:  0.3085  memory:  9.38GiB(19.75%)  tps: 5,739  tflops: 43.71  mfu: 14.01%
[rank0]:2025-11-04 01:30:17,375 - INFO -  step: 2100  loss: -2.0000  grad_norm:  0.3085  memory: 13.42GiB(28.26%)  tps: 5,737  tflops: 43.70  mfu: 14.01%
[rank1]:2025-11-04 01:30:17,423 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251104_0130_stage1_step2100.svg
[rank0]:2025-11-04 01:30:17,423 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251104_0130_stage0_step2100.svg
[rank2]:2025-11-04 01:30:17,423 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251104_0130_stage2_step2100.svg
[rank3]:2025-11-04 01:30:17,514 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/pipeline_schedule/251104_0130_real_step2100_rank3.svg
[rank3]:> Batch Time: 456.47 ms, GPU Bubble Ratio: 67.90%, 50.93%, 60.02%, 36.63%
[rank3]:2025-11-04 01:30:17,557 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251104_0130_stage3_step2100.svg
[rank0]:2025-11-04 01:31:23,381 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-04 01:31:26,383 - INFO -  step: 2150  loss: -2.0000  grad_norm:  0.2915  memory:  6.51GiB(13.70%)  tps: 5,717  tflops: 43.54  mfu: 13.96%
[rank1]:2025-11-04 01:31:26,922 - INFO -  step: 2150  loss: -2.0000  grad_norm:  0.2915  memory:  9.38GiB(19.75%)  tps: 5,721  tflops: 43.57  mfu: 13.96%
[rank3]:2025-11-04 01:31:27,740 - INFO -  step: 2150  loss:  0.2054  grad_norm:  0.2915  memory: 17.37GiB(36.55%)  tps: 5,519  tflops: 42.03  mfu: 13.47%
[rank0]:2025-11-04 01:31:29,040 - INFO -  step: 2150  loss: -2.0000  grad_norm:  0.2915  memory: 13.42GiB(28.26%)  tps: 5,716  tflops: 43.53  mfu: 13.95%
[rank0]:2025-11-04 01:32:35,111 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 01:32:35,847 - INFO - Avg. fwd time: 13.4760 / Avg. bwd time: 25.3870 / Avg. batch time: 383.4436 (ms) / GPU bubble ratio: 18.92%
[rank0]:2025-11-04 01:32:35,905 - INFO - Avg. fwd time: 8.1658 / Avg. bwd time: 12.1115 / Avg. batch time: 477.7121 (ms) / GPU bubble ratio: 66.04%
[rank1]:2025-11-04 01:32:35,947 - INFO - Avg. fwd time: 9.6906 / Avg. bwd time: 18.8753 / Avg. batch time: 447.1365 (ms) / GPU bubble ratio: 48.89%
[rank2]:2025-11-04 01:32:35,911 - INFO - Avg. fwd time: 7.2983 / Avg. bwd time: 15.7602 / Avg. batch time: 412.1735 (ms) / GPU bubble ratio: 55.25%
[rank3]:2025-11-04 01:32:36,684 - INFO -  step: 2200  loss:  0.2337  grad_norm:  0.3567  memory: 17.37GiB(36.55%)  tps: 5,941  tflops: 45.25  mfu: 14.50%
[rank3]:2025-11-04 01:32:36,684 - INFO - ðŸ”Ž  Running validation at step 2200
[rank2]:2025-11-04 01:32:38,204 - INFO -  step: 2200  loss: -2.0000  grad_norm:  0.3567  memory:  6.51GiB(13.70%)  tps: 5,703  tflops: 43.44  mfu: 13.92%
[rank2]:2025-11-04 01:32:38,204 - INFO - ðŸ”Ž  Running validation at step 2200
[rank1]:2025-11-04 01:32:38,580 - INFO -  step: 2200  loss: -2.0000  grad_norm:  0.3567  memory:  9.38GiB(19.75%)  tps: 5,716  tflops: 43.54  mfu: 13.95%
[rank1]:2025-11-04 01:32:38,580 - INFO - ðŸ”Ž  Running validation at step 2200
[rank0]:2025-11-04 01:32:40,618 - INFO -  step: 2200  loss: -2.0000  grad_norm:  0.3567  memory: 13.42GiB(28.26%)  tps: 5,722  tflops: 43.58  mfu: 13.97%
[rank0]:2025-11-04 01:32:40,618 - INFO - ðŸ”Ž  Running validation at step 2200
[rank3]:2025-11-04 01:33:01,481 - INFO - validate step: 2200  loss:  0.9548  memory: 17.37GiB(36.55%)  tps: 16,519
[rank1]:2025-11-04 01:33:01,471 - INFO - validate step: 2200  loss: -1.0000  memory:  9.38GiB(19.75%)  tps: 17,894
[rank0]:2025-11-04 01:33:01,452 - INFO - validate step: 2200  loss: -1.0000  memory: 13.42GiB(28.26%)  tps: 19,660
[rank0]:2025-11-04 01:33:01,538 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251104_0133_stage0_step2200.svg
[rank2]:2025-11-04 01:33:01,489 - INFO - validate step: 2200  loss: -1.0000  memory:  6.51GiB(13.70%)  tps: 17,591
[rank2]:2025-11-04 01:33:01,537 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251104_0133_stage2_step2200.svg
[rank1]:2025-11-04 01:33:01,537 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251104_0133_stage1_step2200.svg
[rank3]:2025-11-04 01:33:01,633 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/pipeline_schedule/251104_0133_real_step2200_rank3.svg
[rank3]:> Batch Time: 461.22 ms, GPU Bubble Ratio: 68.27%, 51.44%, 60.43%, 35.91%
[rank3]:2025-11-04 01:33:01,676 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251104_0133_stage3_step2200.svg
[rank0]:2025-11-04 01:34:08,347 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-11-04 01:34:11,363 - INFO -  step: 2250  loss: -2.0000  grad_norm:  0.3078  memory:  6.51GiB(13.70%)  tps: 5,862  tflops: 44.65  mfu: 14.31%
[rank1]:2025-11-04 01:34:11,784 - INFO -  step: 2250  loss: -2.0000  grad_norm:  0.3078  memory:  9.38GiB(19.75%)  tps: 5,825  tflops: 44.37  mfu: 14.22%
[rank3]:2025-11-04 01:34:12,915 - INFO -  step: 2250  loss:  0.2197  grad_norm:  0.3078  memory: 17.37GiB(36.55%)  tps: 5,734  tflops: 43.67  mfu: 14.00%
[rank0]:2025-11-04 01:34:14,124 - INFO -  step: 2250  loss: -2.0000  grad_norm:  0.3078  memory: 13.42GiB(28.26%)  tps: 5,636  tflops: 42.93  mfu: 13.76%
[rank0]:2025-11-04 01:35:20,087 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 01:35:20,812 - INFO - Avg. fwd time: 13.4841 / Avg. bwd time: 25.2839 / Avg. batch time: 382.6851 (ms) / GPU bubble ratio: 18.96%
[rank1]:2025-11-04 01:35:20,910 - INFO - Avg. fwd time: 9.6950 / Avg. bwd time: 18.8481 / Avg. batch time: 446.3179 (ms) / GPU bubble ratio: 48.84%
[rank2]:2025-11-04 01:35:20,876 - INFO - Avg. fwd time: 7.3008 / Avg. bwd time: 15.7473 / Avg. batch time: 411.3701 (ms) / GPU bubble ratio: 55.18%
[rank0]:2025-11-04 01:35:20,870 - INFO - Avg. fwd time: 8.1701 / Avg. bwd time: 12.0192 / Avg. batch time: 476.8531 (ms) / GPU bubble ratio: 66.13%
[rank3]:2025-11-04 01:35:21,512 - INFO -  step: 2300  loss:  0.2109  grad_norm:  0.2821  memory: 17.37GiB(36.55%)  tps: 5,971  tflops: 45.48  mfu: 14.58%
[rank2]:2025-11-04 01:35:22,959 - INFO -  step: 2300  loss: -2.0000  grad_norm:  0.2821  memory:  6.51GiB(13.70%)  tps: 5,721  tflops: 43.57  mfu: 13.97%
[rank1]:2025-11-04 01:35:23,554 - INFO -  step: 2300  loss: -2.0000  grad_norm:  0.2821  memory:  9.38GiB(19.75%)  tps: 5,707  tflops: 43.47  mfu: 13.93%
[rank1]:2025-11-04 01:35:25,724 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251104_0135_stage1_step2300.svg
[rank2]:2025-11-04 01:35:25,724 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251104_0135_stage2_step2300.svg
[rank0]:2025-11-04 01:35:25,676 - INFO -  step: 2300  loss: -2.0000  grad_norm:  0.2821  memory: 13.42GiB(28.26%)  tps: 5,725  tflops: 43.60  mfu: 13.97%
[rank0]:2025-11-04 01:35:25,724 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251104_0135_stage0_step2300.svg
[rank3]:2025-11-04 01:35:25,815 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/pipeline_schedule/251104_0135_real_step2300_rank3.svg
[rank3]:> Batch Time: 456.22 ms, GPU Bubble Ratio: 67.83%, 50.86%, 59.96%, 36.61%
[rank3]:2025-11-04 01:35:25,858 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251104_0135_stage3_step2300.svg
[rank0]:2025-11-04 01:36:31,787 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-04 01:36:34,867 - INFO -  step: 2350  loss: -2.0000  grad_norm:  0.2194  memory:  6.51GiB(13.70%)  tps: 5,696  tflops: 43.38  mfu: 13.90%
[rank1]:2025-11-04 01:36:35,256 - INFO -  step: 2350  loss: -2.0000  grad_norm:  0.2194  memory:  9.38GiB(19.75%)  tps: 5,713  tflops: 43.51  mfu: 13.94%
[rank3]:2025-11-04 01:36:36,048 - INFO -  step: 2350  loss:  0.2067  grad_norm:  0.2194  memory: 17.37GiB(36.55%)  tps: 5,495  tflops: 41.85  mfu: 13.41%
[rank0]:2025-11-04 01:36:37,506 - INFO -  step: 2350  loss: -2.0000  grad_norm:  0.2194  memory: 13.42GiB(28.26%)  tps: 5,702  tflops: 43.43  mfu: 13.92%
[rank0]:2025-11-04 01:37:43,017 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 01:37:43,925 - INFO - Avg. fwd time: 13.4907 / Avg. bwd time: 25.1843 / Avg. batch time: 381.9419 (ms) / GPU bubble ratio: 18.99%
[rank1]:2025-11-04 01:37:43,983 - INFO - Avg. fwd time: 9.6989 / Avg. bwd time: 18.8234 / Avg. batch time: 445.5224 (ms) / GPU bubble ratio: 48.78%
[rank2]:2025-11-04 01:37:43,952 - INFO - Avg. fwd time: 7.3032 / Avg. bwd time: 15.7355 / Avg. batch time: 410.5858 (ms) / GPU bubble ratio: 55.11%
[rank0]:2025-11-04 01:37:44,012 - INFO - Avg. fwd time: 8.1738 / Avg. bwd time: 11.9446 / Avg. batch time: 476.0214 (ms) / GPU bubble ratio: 66.19%
[rank3]:2025-11-04 01:37:44,813 - INFO -  step: 2400  loss:  0.2186  grad_norm:  0.2954  memory: 17.37GiB(36.55%)  tps: 5,957  tflops: 45.37  mfu: 14.54%
[rank3]:2025-11-04 01:37:44,814 - INFO -  final step: 2400  loss:  0.2186  grad_norm:  0.2954  tps: 5,895  tflops: 44.90  mfu: 13.94%
[rank3]:2025-11-04 01:37:44,814 - INFO - ðŸ”Ž  Running validation at step 2400
[rank2]:2025-11-04 01:37:46,173 - INFO -  step: 2400  loss: -2.0000  grad_norm:  0.2954  memory:  6.51GiB(13.70%)  tps: 5,744  tflops: 43.75  mfu: 14.02%
[rank2]:2025-11-04 01:37:46,174 - INFO -  final step: 2400  loss: -2.0000  grad_norm:  0.2954  tps: 5,882  tflops: 44.80  mfu: 13.90%
[rank2]:2025-11-04 01:37:46,174 - INFO - ðŸ”Ž  Running validation at step 2400
[rank1]:2025-11-04 01:37:46,550 - INFO -  step: 2400  loss: -2.0000  grad_norm:  0.2954  memory:  9.38GiB(19.75%)  tps: 5,745  tflops: 43.76  mfu: 14.02%
[rank1]:2025-11-04 01:37:46,550 - INFO -  final step: 2400  loss: -2.0000  grad_norm:  0.2954  tps: 5,874  tflops: 44.74  mfu: 13.88%
[rank1]:2025-11-04 01:37:46,551 - INFO - ðŸ”Ž  Running validation at step 2400
[rank0]:2025-11-04 01:37:48,591 - INFO -  step: 2400  loss: -2.0000  grad_norm:  0.2954  memory: 13.42GiB(28.26%)  tps: 5,762  tflops: 43.89  mfu: 14.07%
[rank0]:2025-11-04 01:37:48,591 - INFO -  final step: 2400  loss: -2.0000  grad_norm:  0.2954  tps: 5,835  tflops: 44.44  mfu: 13.79%
[rank0]:2025-11-04 01:37:48,591 - INFO - ðŸ”Ž  Running validation at step 2400
[rank0]:2025-11-04 01:38:09,454 - INFO - validate step: 2400  loss: -1.0000  memory: 13.42GiB(28.26%)  tps: 19,634
[rank0]:2025-11-04 01:38:09,455 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-04 01:38:09,457 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank3]:2025-11-04 01:38:09,482 - INFO - validate step: 2400  loss:  0.9549  memory: 17.37GiB(36.55%)  tps: 16,605
[rank3]:2025-11-04 01:38:09,485 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-11-04 01:38:09,489 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank1]:2025-11-04 01:38:09,473 - INFO - validate step: 2400  loss: -1.0000  memory:  9.38GiB(19.75%)  tps: 17,869
[rank1]:2025-11-04 01:38:09,474 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-11-04 01:38:09,476 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank2]:2025-11-04 01:38:09,491 - INFO - validate step: 2400  loss: -1.0000  memory:  6.51GiB(13.70%)  tps: 17,566
[rank2]:2025-11-04 01:38:09,492 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-04 01:38:09,494 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank0]:2025-11-04 01:38:11,923 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank1]:2025-11-04 01:38:11,991 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251104_0138_stage1_final2400.svg
[rank2]:2025-11-04 01:38:11,989 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251104_0138_stage2_final2400.svg
[rank0]:2025-11-04 01:38:11,987 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251104_0138_stage0_final2400.svg
[rank3]:2025-11-04 01:38:12,075 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/pipeline_schedule/251104_0138_real_final2400_rank3.svg
[rank3]:> Batch Time: 460.05 ms, GPU Bubble Ratio: 67.39%, 51.05%, 60.12%, 35.80%
[rank1]:2025-11-04 01:38:12,152 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/frozen_params_histogram/251104_0138_rank1_stage1.svg
[rank1]:	> Counts Sum: 1321580, Total Sum: 1526400 (86.58%), Ratio(%) per element: [86.43, 86.55, 86.61, 86.49, 86.2, 86.49, 86.49, 87.08, 87.2, 86.73, 86.37, 86.49, 86.49, 86.55, 86.55, 86.37, 87.2, 87.08, 86.85, 86.14, 86.37, 86.49, 86.14, 86.55, 86.26, 87.08, 87.08, 86.49, 86.26, 86.14, 86.55, 86.49, 86.49, 86.32, 87.14, 87.14, 86.37, 86.37, 86.26, 86.43, 86.43, 86.26, 86.49, 87.08, 86.85]
[rank1]:2025-11-04 01:38:12,153 - INFO - Destroying the purge thread.
[rank2]:2025-11-04 01:38:12,145 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/frozen_params_histogram/251104_0138_rank2_stage2.svg
[rank2]:	> Counts Sum: 1060560, Total Sum: 1221120 (86.85%), Ratio(%) per element: [86.79, 86.73, 86.79, 86.79, 86.73, 86.79, 86.67, 87.2, 86.79, 86.79, 86.67, 86.79, 86.73, 86.91, 86.73, 86.91, 87.08, 86.85, 86.73, 86.85, 86.79, 86.85, 86.85, 86.73, 86.79, 87.08, 87.08, 86.85, 86.85, 86.79, 86.91, 86.85, 86.73, 86.73, 87.2, 87.14]
[rank2]:2025-11-04 01:38:12,146 - INFO - Destroying the purge thread.
[rank0]:2025-11-04 01:38:12,145 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/frozen_params_histogram/251104_0138_rank0_stage0.svg
[rank0]:	> Counts Sum: 1003040, Total Sum: 1255040 (79.92%), Ratio(%) per element: [77.83, 78.53, 78.3, 78.24, 77.71, 78.12, 78.06, 78.06, 86.96, 83.49, 78.18, 77.47, 78.77, 77.71, 78.47, 78.24, 77.77, 86.96, 86.61, 77.94, 77.83, 77.88, 78.59, 78.24, 78.3, 78.3, 86.26, 87.02, 78.06, 78.71, 78.06, 77.83, 78.89, 78.0, 77.53, 87.02, 86.96]
[rank0]:2025-11-04 01:38:12,145 - INFO - Sleeping 2 seconds for other ranks to complete
[rank3]:2025-11-04 01:38:12,216 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/pipeline_schedule/251104_0138_thry_final2400_rank3.svg
[rank3]:> Batch Time: 320.69 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:2025-11-04 01:38:12,258 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251104_0138_stage3_final2400.svg
[rank1]:2025-11-04 01:38:12,315 - INFO - Process group destroyed
[rank2]:2025-11-04 01:38:12,331 - INFO - Process group destroyed
[rank3]:2025-11-04 01:38:12,389 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/frozen_params_histogram/251104_0138_rank3_stage3.svg
[rank3]:	> Counts Sum: 204840, Total Sum: 983680 (20.82%), Ratio(%) per element: [19.45, 18.86, 18.92, 18.57, 19.04, 19.51, 19.1, 26.35, 26.88, 19.04, 18.86, 18.57, 18.86, 19.16, 19.33, 19.16, 26.65, 26.53, 18.8, 19.04, 18.86, 19.33, 18.92, 18.63, 18.75, 26.35, 26.88, 26.29, 19.04]
[rank3]:2025-11-04 01:38:12,390 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading history steps 48-48, summary, console lines 370-380
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–…â–„â–…â–„â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–‡â–ˆâ–‡â–…â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–‡â–ˆâ–‡â–…â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 1.38956
[rank3]:wandb:               final/avg_loss 0.2186
[rank3]:wandb:             final/avg_mfu(%) 13.93648
[rank3]:wandb:             final/avg_tflops 44.90052
[rank3]:wandb:    final/avg_throughput(tps) 5895.38654
[rank3]:wandb:              final/grad_norm 0.29538
[rank3]:wandb:               final/max_loss 0.2186
[rank3]:wandb:                    grad_norm 0.29538
[rank3]:wandb: loss_metrics/global_avg_loss 0.2186
[rank3]:wandb: loss_metrics/global_max_loss 0.2186
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1031_1F1B_timelyapf_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/k6oqxv99
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1031_1F1B_timelyapf_dm1/20251104-0036/wandb/run-20251104_003630-k6oqxv99/logs
[rank3]:2025-11-04 01:38:13,837 - INFO - Process group destroyed
[rank0]:2025-11-04 01:38:14,145 - INFO - Training completed
[rank0]:2025-11-04 01:38:14,146 - INFO - Destroying the purge thread.
[rank0]:2025-11-04 01:38:14,360 - INFO - Process group destroyed
[rank0]:Stage 0: Modules to keep: {'tok_embeddings', 'layers.3', 'layers.2', 'layers.0', 'layers.1'}
[rank2]:Stage 2: Modules to keep: {'layers.11', 'layers.10', 'layers.9', 'layers.12'}
[rank1]:Stage 1: Modules to keep: {'layers.6', 'layers.8', 'layers.7', 'layers.4', 'layers.5'}
[rank3]:Stage 3: Modules to keep: {'norm', 'layers.15', 'output', 'layers.13', 'layers.14'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1029_llama1b/config_1031.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
[rank3]:+ more freezing in autofreeze mode. 
[rank3]:+ lr_scheduler min_lr = 0 -> 1e-6, cosine decay.
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1031_1F1B_timelyapf_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1031_1F1B_timelyapf_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1031_1F1B_timelyapf_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1031_1F1B_timelyapf_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1031_1F1B_timelyapf_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B-Instruct
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 1e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 300
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: alpaca
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 512
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 2400
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: 1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 4
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1031_1F1B_timelyapf_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B-Instruct/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1031_1F1B_timelyapf_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: True
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: timelyapf
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- threshold: 0.05
[rank3]:		- percentile: 70
[rank3]:
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3

ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 11. 04. (í™”) 01:45:02 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 3,4,5,6
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1029_llama1b/run_1031.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1029_llama1b/1031_1F1B_timelyapf.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
+ more freezing in autofreeze mode. 
+ lr_scheduler min_lr = 0 -> 1e-6, cosine decay.

âœ”ï¸Running with timelyapf x 1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1029_llama1b/config_1031.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
+ more freezing in autofreeze mode. 
+ lr_scheduler min_lr = 0 -> 1e-6, cosine decay.
" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=timelyapf
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank2]:2025-11-04 01:45:08,309 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
[rank2]:+ more freezing in autofreeze mode. 
[rank2]:+ lr_scheduler min_lr = 0 -> 1e-6, cosine decay.
[rank2]:"
[rank3]:2025-11-04 01:45:08,309 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
[rank3]:+ more freezing in autofreeze mode. 
[rank3]:+ lr_scheduler min_lr = 0 -> 1e-6, cosine decay.
[rank3]:"
[rank0]:2025-11-04 01:45:08,422 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
[rank0]:+ more freezing in autofreeze mode. 
[rank0]:+ lr_scheduler min_lr = 0 -> 1e-6, cosine decay.
[rank0]:"
[rank1]:2025-11-04 01:45:08,447 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
[rank1]:+ more freezing in autofreeze mode. 
[rank1]:+ lr_scheduler min_lr = 0 -> 1e-6, cosine decay.
[rank1]:"
[rank2]:2025-11-04 01:45:08,544 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-11-04 01:45:08,546 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-11-04 01:45:08,548 - INFO - Deterministic algorithm enabled (expect perf degradation).
[rank3]:2025-11-04 01:45:08,540 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-11-04 01:45:08,542 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-11-04 01:45:08,547 - INFO - Deterministic algorithm enabled (expect perf degradation).
[rank0]:2025-11-04 01:45:08,653 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-11-04 01:45:08,656 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-04 01:45:08,660 - INFO - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-11-04 01:45:08,660 - INFO - Deterministic algorithm enabled (expect perf degradation).
[rank1]:2025-11-04 01:45:08,678 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-11-04 01:45:08,681 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-11-04 01:45:08,691 - INFO - Deterministic algorithm enabled (expect perf degradation).
[rank0]:2025-11-04 01:45:09,172 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-11-04 01:45:09,615 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank0]:2025-11-04 01:45:12,430 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=512, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank0]:2025-11-04 01:45:12,596 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-11-04 01:45:12,572 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-11-04 01:45:12,608 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-04 01:45:12,632 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-04 01:45:12,633 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-11-04 01:45:12,661 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-11-04 01:45:12,661 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank2]:2025-11-04 01:45:12,630 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-11-04 01:45:12,670 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-11-04 01:45:12,698 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-11-04 01:45:12,698 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2025-11-04 01:45:12,635 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-11-04 01:45:12,635 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2025-11-04 01:45:12,799 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-11-04 01:45:12,799 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-11-04 01:45:12,800 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank0]:2025-11-04 01:45:12,843 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-04 01:45:12,843 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-11-04 01:45:12,844 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank2]:2025-11-04 01:45:12,862 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-11-04 01:45:12,862 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-11-04 01:45:12,863 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run 5e3zcjnj
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1031_1F1B_timelyapf_dm1/20251104-0145/wandb/run-20251104_014514-5e3zcjnj
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1031_1F1B_timelyapf_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/5e3zcjnj
[rank3]:2025-11-04 01:45:15,059 - INFO - WandB logging enabled
[rank3]:2025-11-04 01:45:15,060 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-11-04 01:45:15,097 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-11-04 01:45:15,126 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-11-04 01:45:15,127 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank3]:2025-11-04 01:45:15,317 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-11-04 01:45:15,318 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-11-04 01:45:15,319 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank0]:2025-11-04 01:45:15,334 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1031_1F1B_timelyapf_dm1
[rank0]:2025-11-04 01:45:15,335 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-04 01:45:15,335 - INFO - Preparing c4_validation dataset from allenai/c4
[rank2]:2025-11-04 01:45:15,334 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-11-04 01:45:15,334 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank1]:2025-11-04 01:45:15,334 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-04 01:45:20,298 - INFO - Trainer is initialized with local batch size 32, global batch size 64, gradient accumulation steps 2, sequence length 512, total steps 2400 (warmup 300)
[rank0]:2025-11-04 01:45:20,298 - WARNING - checkpoint.initial_load_path is provided but the checkpoint.folder exists. Checkpointer will use the checkpoints from the checkpoint.folder /data2/shcho/torchtitan/checkpoint/1031_1F1B_timelyapf_dm1.
[rank0]:2025-11-04 01:45:20,298 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/checkpoint/1031_1F1B_timelyapf_dm1/step-2400.
[rank1]:2025-11-04 01:45:20,746 - WARNING - checkpoint.initial_load_path is provided but the checkpoint.folder exists. Checkpointer will use the checkpoints from the checkpoint.folder /data2/shcho/torchtitan/checkpoint/1031_1F1B_timelyapf_dm1.
[rank2]:2025-11-04 01:45:20,987 - WARNING - checkpoint.initial_load_path is provided but the checkpoint.folder exists. Checkpointer will use the checkpoints from the checkpoint.folder /data2/shcho/torchtitan/checkpoint/1031_1F1B_timelyapf_dm1.
[rank3]:2025-11-04 01:45:21,643 - WARNING - checkpoint.initial_load_path is provided but the checkpoint.folder exists. Checkpointer will use the checkpoints from the checkpoint.folder /data2/shcho/torchtitan/checkpoint/1031_1F1B_timelyapf_dm1.
[rank0]:2025-11-04 01:45:23,661 - INFO - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-11-04 01:45:23,661 - INFO - Finished loading the checkpoint in 3.36 seconds.
[rank0]:2025-11-04 01:45:23,661 - INFO - Training starts at step 1
[rank0]:2025-11-04 01:45:25,599 - INFO -  step:  1  loss: -2.0000  grad_norm:  0.4953  memory:  9.17GiB(19.29%)  tps: 632  tflops: 4.81  mfu: 1.54%
[rank0]:2025-11-04 01:45:25,599 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-11-04 01:45:25,571 - INFO -  step:  1  loss:  0.2712  grad_norm:  0.4953  memory: 12.97GiB(27.30%)  tps: 782  tflops: 5.96  mfu: 1.91%
[rank3]:2025-11-04 01:45:25,572 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-11-04 01:45:25,563 - INFO -  step:  1  loss: -2.0000  grad_norm:  0.4953  memory:  6.72GiB(14.15%)  tps: 632  tflops: 4.82  mfu: 1.54%
[rank1]:2025-11-04 01:45:25,568 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-11-04 01:45:25,560 - INFO -  step:  1  loss: -2.0000  grad_norm:  0.4953  memory:  4.59GiB(9.67%)  tps: 636  tflops: 4.84  mfu: 1.55%
[rank2]:2025-11-04 01:45:25,560 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-04 01:46:28,082 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-04 01:46:29,396 - INFO -  step: 50  loss: -2.0000  grad_norm:  0.6966  memory:  6.39GiB(13.45%)  tps: 6,288  tflops: 47.89  mfu: 15.35%
[rank0]:2025-11-04 01:46:29,411 - INFO -  step: 50  loss: -2.0000  grad_norm:  0.6966  memory: 12.97GiB(27.31%)  tps: 6,291  tflops: 47.91  mfu: 15.36%
[rank3]:2025-11-04 01:46:29,408 - INFO -  step: 50  loss:  0.2274  grad_norm:  0.6966  memory: 16.39GiB(34.50%)  tps: 6,288  tflops: 47.89  mfu: 15.35%
[rank1]:2025-11-04 01:46:29,400 - INFO -  step: 50  loss: -2.0000  grad_norm:  0.6966  memory:  8.99GiB(18.92%)  tps: 6,289  tflops: 47.89  mfu: 15.35%
[rank0]:2025-11-04 01:47:33,562 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-04 01:47:34,673 - INFO - Avg. fwd time: 7.1213 / Avg. bwd time: 18.7919 / Avg. batch time: 548.1166 (ms) / GPU bubble ratio: 62.18%
[rank3]:2025-11-04 01:47:34,642 - INFO - Avg. fwd time: 12.3807 / Avg. bwd time: 41.9379 / Avg. batch time: 516.2383 (ms) / GPU bubble ratio: 15.82%
[rank1]:2025-11-04 01:47:34,701 - INFO - Avg. fwd time: 9.2904 / Avg. bwd time: 24.1251 / Avg. batch time: 587.6318 (ms) / GPU bubble ratio: 54.51%
[rank0]:2025-11-04 01:47:34,715 - INFO - Avg. fwd time: 7.9159 / Avg. bwd time: 25.6373 / Avg. batch time: 627.5569 (ms) / GPU bubble ratio: 57.23%
[rank2]:2025-11-04 01:47:34,878 - INFO -  step: 100  loss: -2.0000  grad_norm:  0.4586  memory:  6.39GiB(13.45%)  tps: 6,255  tflops: 47.64  mfu: 15.27%
[rank2]:2025-11-04 01:47:34,878 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-11-04 01:47:34,892 - INFO -  step: 100  loss: -2.0000  grad_norm:  0.4586  memory: 12.97GiB(27.31%)  tps: 6,255  tflops: 47.64  mfu: 15.27%
[rank0]:2025-11-04 01:47:34,892 - WARNING - Nothing to draw before the end of warmup.
[rank3]:2025-11-04 01:47:34,890 - INFO -  step: 100  loss:  0.2112  grad_norm:  0.4586  memory: 16.39GiB(34.50%)  tps: 6,255  tflops: 47.64  mfu: 15.27%
[rank3]:2025-11-04 01:47:34,890 - WARNING - Nothing to draw before the end of warmup.
[rank1]:2025-11-04 01:47:34,881 - INFO -  step: 100  loss: -2.0000  grad_norm:  0.4586  memory:  8.99GiB(18.92%)  tps: 6,255  tflops: 47.64  mfu: 15.27%
[rank1]:2025-11-04 01:47:34,881 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-11-04 01:48:39,235 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 01:48:40,589 - INFO -  step: 150  loss:  0.2714  grad_norm:  0.5424  memory: 16.39GiB(34.50%)  tps: 6,235  tflops: 47.48  mfu: 15.22%
[rank0]:2025-11-04 01:48:40,591 - INFO -  step: 150  loss: -2.0000  grad_norm:  0.5424  memory: 12.97GiB(27.31%)  tps: 6,235  tflops: 47.48  mfu: 15.22%
[rank1]:2025-11-04 01:48:40,580 - INFO -  step: 150  loss: -2.0000  grad_norm:  0.5424  memory:  8.99GiB(18.92%)  tps: 6,235  tflops: 47.48  mfu: 15.22%
[rank2]:2025-11-04 01:48:40,577 - INFO -  step: 150  loss: -2.0000  grad_norm:  0.5424  memory:  6.39GiB(13.45%)  tps: 6,235  tflops: 47.48  mfu: 15.22%
[rank0]:2025-11-04 01:49:44,925 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 01:49:46,019 - INFO - Avg. fwd time: 12.5118 / Avg. bwd time: 42.1284 / Avg. batch time: 518.7079 (ms) / GPU bubble ratio: 15.73%
[rank1]:2025-11-04 01:49:46,078 - INFO - Avg. fwd time: 9.3183 / Avg. bwd time: 24.2098 / Avg. batch time: 589.3496 (ms) / GPU bubble ratio: 54.49%
[rank2]:2025-11-04 01:49:46,049 - INFO - Avg. fwd time: 7.1295 / Avg. bwd time: 18.8436 / Avg. batch time: 550.1800 (ms) / GPU bubble ratio: 62.23%
[rank0]:2025-11-04 01:49:46,092 - INFO - Avg. fwd time: 7.9239 / Avg. bwd time: 25.6872 / Avg. batch time: 628.8716 (ms) / GPU bubble ratio: 57.24%
[rank3]:2025-11-04 01:49:46,268 - INFO -  step: 200  loss:  0.2279  grad_norm:  0.8148  memory: 16.39GiB(34.50%)  tps: 6,237  tflops: 47.50  mfu: 15.22%
[rank3]:2025-11-04 01:49:46,269 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-11-04 01:49:46,271 - INFO -  step: 200  loss: -2.0000  grad_norm:  0.8148  memory: 12.97GiB(27.31%)  tps: 6,236  tflops: 47.50  mfu: 15.22%
[rank0]:2025-11-04 01:49:46,271 - INFO - ðŸ”Ž  Running validation at step 200
[rank1]:2025-11-04 01:49:46,260 - INFO -  step: 200  loss: -2.0000  grad_norm:  0.8148  memory:  8.99GiB(18.92%)  tps: 6,236  tflops: 47.50  mfu: 15.22%
[rank1]:2025-11-04 01:49:46,260 - INFO - ðŸ”Ž  Running validation at step 200
[rank2]:2025-11-04 01:49:46,256 - INFO -  step: 200  loss: -2.0000  grad_norm:  0.8148  memory:  6.39GiB(13.45%)  tps: 6,236  tflops: 47.50  mfu: 15.22%
[rank2]:2025-11-04 01:49:46,256 - INFO - ðŸ”Ž  Running validation at step 200
[rank1]:2025-11-04 01:50:08,740 - INFO - validate step: 200  loss: -1.0000  memory:  8.99GiB(18.92%)  tps: 18,220
[rank1]:2025-11-04 01:50:08,742 - WARNING - Nothing to draw before the end of warmup.
[rank2]:2025-11-04 01:50:08,758 - INFO - validate step: 200  loss: -1.0000  memory:  6.39GiB(13.45%)  tps: 18,203
[rank2]:2025-11-04 01:50:08,759 - WARNING - Nothing to draw before the end of warmup.
[rank3]:2025-11-04 01:50:08,753 - INFO - validate step: 200  loss:  0.9623  memory: 16.39GiB(34.50%)  tps: 18,218
[rank3]:2025-11-04 01:50:08,754 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-11-04 01:50:08,725 - INFO - validate step: 200  loss: -1.0000  memory: 12.97GiB(27.31%)  tps: 18,242
[rank0]:2025-11-04 01:50:08,726 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-11-04 01:51:13,128 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-11-04 01:51:14,441 - INFO -  step: 250  loss: -2.0000  grad_norm:  0.6442  memory:  6.39GiB(13.45%)  tps: 6,236  tflops: 47.50  mfu: 15.22%
[rank3]:2025-11-04 01:51:14,452 - INFO -  step: 250  loss:  0.2171  grad_norm:  0.6442  memory: 16.39GiB(34.50%)  tps: 6,235  tflops: 47.48  mfu: 15.22%
[rank0]:2025-11-04 01:51:14,456 - INFO -  step: 250  loss: -2.0000  grad_norm:  0.6442  memory: 12.97GiB(27.31%)  tps: 6,232  tflops: 47.46  mfu: 15.21%
[rank1]:2025-11-04 01:51:14,444 - INFO -  step: 250  loss: -2.0000  grad_norm:  0.6442  memory:  8.99GiB(18.92%)  tps: 6,234  tflops: 47.48  mfu: 15.22%
[rank3]:2025-11-04 01:51:27,328 - INFO - [Step 260] ã€°ï¸ Monitoring Upperbound
[rank2]:2025-11-04 01:51:41,769 - WARNING - [Step 270] â³ Monitoring Upperbound... (540/550)
[rank3]:2025-11-04 01:51:41,744 - WARNING - [Step 270] â³ Monitoring Upperbound... (540/550)
[rank1]:2025-11-04 01:51:41,799 - WARNING - [Step 270] â³ Monitoring Upperbound... (540/550)
[rank0]:2025-11-04 01:51:41,831 - WARNING - [Step 270] â³ Monitoring Upperbound... (540/550)
[rank3]:2025-11-04 01:52:00,468 - INFO - [Step 280] âœ”ï¸  Setting Upperbound
[rank3]:2025-11-04 01:52:00,717 - INFO - [Step 280] ã€°ï¸ Monitoring Lowerbound
[rank2]:2025-11-04 01:52:03,115 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-04 01:52:03,698 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-04 01:52:05,472 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-04 01:52:05,498 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-04 01:52:06,087 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-04 01:52:06,076 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-04 01:52:06,072 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-04 01:52:06,101 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-04 01:52:06,088 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-04 01:52:06,145 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-04 01:52:06,194 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-04 01:52:06,156 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-04 01:52:06,199 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-04 01:52:06,221 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-04 01:52:06,202 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-04 01:52:06,248 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-04 01:52:06,192 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-04 01:52:06,238 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-04 01:52:06,242 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-04 01:52:06,275 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-04 01:52:06,310 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-04 01:52:06,264 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-04 01:52:06,312 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-04 01:52:06,344 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-04 01:52:06,289 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-04 01:52:06,289 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-04 01:52:06,290 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-04 01:52:06,290 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-04 01:52:06,285 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-04 01:52:06,335 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-04 01:52:06,328 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-04 01:52:06,357 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-04 01:52:22,754 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-04 01:52:23,633 - INFO - Avg. fwd time: 9.4475 / Avg. bwd time: 23.3635 / Avg. batch time: 578.0050 (ms) / GPU bubble ratio: 54.59%
[rank2]:2025-11-04 01:52:23,617 - INFO - Avg. fwd time: 7.2375 / Avg. bwd time: 18.1804 / Avg. batch time: 539.8226 (ms) / GPU bubble ratio: 62.33%
[rank2]:2025-11-04 01:52:23,657 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-04 01:52:23,658 - INFO -  step: 300  loss: -2.0000  grad_norm:  0.0000  memory:  6.39GiB(13.45%)  tps: 5,918  tflops: 45.07  mfu: 14.45%
[rank0]:2025-11-04 01:52:23,639 - INFO - Avg. fwd time: 8.0169 / Avg. bwd time: 24.0022 / Avg. batch time: 615.6409 (ms) / GPU bubble ratio: 58.39%
[rank0]:2025-11-04 01:52:23,660 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.58/0.58, [MB7] 1.00/1.00
[rank0]:2025-11-04 01:52:23,661 - INFO -  step: 300  loss: -2.0000  grad_norm:  0.0000  memory: 12.97GiB(27.31%)  tps: 5,919  tflops: 45.08  mfu: 14.45%
[rank3]:2025-11-04 01:52:23,603 - INFO - Avg. fwd time: 12.6598 / Avg. bwd time: 40.7936 / Avg. batch time: 509.1649 (ms) / GPU bubble ratio: 16.01%
[rank3]:2025-11-04 01:52:23,606 - INFO - [Step 300] âœ”ï¸  Setting Lowerbound
[rank1]:2025-11-04 01:52:23,655 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.02/0.02, [MB7] 1.00/1.00
[rank1]:2025-11-04 01:52:23,656 - INFO -  step: 300  loss: -2.0000  grad_norm:  0.0000  memory:  8.99GiB(18.92%)  tps: 5,918  tflops: 45.07  mfu: 14.45%
[rank3]:2025-11-04 01:52:23,857 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/pipeline_schedule/251104_0152_max_batch_time.svg
[rank3]:> Batch Time: 534.46 ms, GPU Bubble Ratio: 49.69%, 49.79%, 61.07%, 18.54%
[rank3]:2025-11-04 01:52:24,000 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/pipeline_schedule/251104_0152_min_batch_time.svg
[rank3]:> Batch Time: 319.45 ms, GPU Bubble Ratio: 80.25%, 48.80%, 60.49%, 15.47%
[rank3]:2025-11-04 01:52:24,155 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/pipeline_schedule/251104_0152_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 349.13 ms, GPU Bubble Ratio: 34.78%, 27.02%, 43.35%, 14.16%
[rank3]:2025-11-04 01:52:24,155 - INFO - 	> Batch Time: 349.13 ms (Average Freeze Ratio: 0.31, Time Reduction Rate: 0.35)
[rank3]:2025-11-04 01:52:24,157 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.40/0.40, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-11-04 01:52:24,160 - INFO -  step: 300  loss:  0.1979  grad_norm:  0.0005  memory: 16.39GiB(34.50%)  tps: 5,876  tflops: 44.75  mfu: 14.34%
[rank1]:2025-11-04 01:52:24,219 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251104_0152_stage1_step300.svg
[rank2]:2025-11-04 01:52:24,224 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251104_0152_stage2_step300.svg
[rank0]:2025-11-04 01:52:24,226 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251104_0152_stage0_step300.svg
[rank3]:2025-11-04 01:52:24,293 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/pipeline_schedule/251104_0152_real_step300_rank3.svg
[rank3]:> Batch Time: 427.50 ms, GPU Bubble Ratio: 82.63%, 58.16%, 67.55%, 33.07%
[rank3]:2025-11-04 01:52:24,338 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251104_0152_stage3_step300.svg
[rank0]:2025-11-04 01:53:40,622 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-04 01:53:44,254 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.67/1.00
[rank2]:2025-11-04 01:53:44,255 - INFO -  step: 350  loss: -2.0000  grad_norm:  0.2499  memory:  6.51GiB(13.70%)  tps: 5,082  tflops: 38.71  mfu: 12.41%
[rank1]:2025-11-04 01:53:44,731 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.01/0.02, [MB7] 0.67/1.00
[rank1]:2025-11-04 01:53:44,732 - INFO -  step: 350  loss: -2.0000  grad_norm:  0.2499  memory:  9.36GiB(19.71%)  tps: 5,052  tflops: 38.48  mfu: 12.33%
[rank3]:2025-11-04 01:53:46,870 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.27/0.40, [MB2] 0.67/1.00, [MB3] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank3]:2025-11-04 01:53:46,873 - INFO -  step: 350  loss:  0.1550  grad_norm:  0.2499  memory: 17.37GiB(36.55%)  tps: 4,952  tflops: 37.72  mfu: 12.09%
[rank0]:2025-11-04 01:53:47,479 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.39/0.58, [MB7] 0.67/1.00
[rank0]:2025-11-04 01:53:47,480 - INFO -  step: 350  loss: -2.0000  grad_norm:  0.2499  memory: 13.29GiB(27.97%)  tps: 4,887  tflops: 37.22  mfu: 11.93%
[rank0]:2025-11-04 01:55:00,862 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-04 01:55:01,742 - INFO - Avg. fwd time: 7.3022 / Avg. bwd time: 17.8021 / Avg. batch time: 516.6443 (ms) / GPU bubble ratio: 61.13%
[rank3]:2025-11-04 01:55:01,717 - INFO - Avg. fwd time: 12.9785 / Avg. bwd time: 37.5820 / Avg. batch time: 486.2931 (ms) / GPU bubble ratio: 16.82%
[rank0]:2025-11-04 01:55:01,784 - INFO - Avg. fwd time: 8.1748 / Avg. bwd time: 22.2148 / Avg. batch time: 591.0191 (ms) / GPU bubble ratio: 58.86%
[rank1]:2025-11-04 01:55:01,771 - INFO - Avg. fwd time: 9.5564 / Avg. bwd time: 22.5805 / Avg. batch time: 554.4033 (ms) / GPU bubble ratio: 53.63%
[rank3]:2025-11-04 01:55:02,965 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.40/0.40, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-11-04 01:55:02,970 - INFO -  step: 400  loss:  0.1911  grad_norm:  0.3609  memory: 17.37GiB(36.55%)  tps: 5,383  tflops: 41.00  mfu: 13.14%
[rank3]:2025-11-04 01:55:02,970 - INFO - ðŸ”Ž  Running validation at step 400
[rank2]:2025-11-04 01:55:04,263 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-04 01:55:04,263 - INFO -  step: 400  loss: -2.0000  grad_norm:  0.3609  memory:  6.51GiB(13.70%)  tps: 5,119  tflops: 38.99  mfu: 12.50%
[rank2]:2025-11-04 01:55:04,264 - INFO - ðŸ”Ž  Running validation at step 400
[rank1]:2025-11-04 01:55:05,010 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.02/0.02, [MB7] 1.00/1.00
[rank1]:2025-11-04 01:55:05,010 - INFO -  step: 400  loss: -2.0000  grad_norm:  0.3609  memory:  9.38GiB(19.75%)  tps: 5,102  tflops: 38.86  mfu: 12.46%
[rank1]:2025-11-04 01:55:05,011 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-11-04 01:55:07,270 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.58/0.58, [MB7] 1.00/1.00
[rank0]:2025-11-04 01:55:07,271 - INFO -  step: 400  loss: -2.0000  grad_norm:  0.3609  memory: 13.40GiB(28.22%)  tps: 5,133  tflops: 39.10  mfu: 12.53%
[rank0]:2025-11-04 01:55:07,271 - INFO - ðŸ”Ž  Running validation at step 400
[rank3]:2025-11-04 01:55:29,431 - INFO - validate step: 400  loss:  0.9892  memory: 17.37GiB(36.55%)  tps: 15,480
[rank0]:2025-11-04 01:55:29,397 - INFO - validate step: 400  loss: -1.0000  memory: 13.40GiB(28.22%)  tps: 18,512
[rank1]:2025-11-04 01:55:29,416 - INFO - validate step: 400  loss: -1.0000  memory:  9.38GiB(19.75%)  tps: 16,783
[rank1]:2025-11-04 01:55:29,491 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251104_0155_stage1_step400.svg
[rank2]:2025-11-04 01:55:29,437 - INFO - validate step: 400  loss: -1.0000  memory:  6.51GiB(13.70%)  tps: 16,271
[rank2]:2025-11-04 01:55:29,495 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251104_0155_stage2_step400.svg
[rank0]:2025-11-04 01:55:29,493 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251104_0155_stage0_step400.svg
[rank3]:2025-11-04 01:55:29,585 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/pipeline_schedule/251104_0155_real_step400_rank3.svg
[rank3]:> Batch Time: 492.34 ms, GPU Bubble Ratio: 61.59%, 52.79%, 61.52%, 36.49%
[rank3]:2025-11-04 01:55:29,632 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251104_0155_stage3_step400.svg
[rank0]:2025-11-04 01:56:42,082 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-04 01:56:44,285 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.40/0.40, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-11-04 01:56:44,289 - INFO -  step: 450  loss:  0.2036  grad_norm:  0.4671  memory: 17.37GiB(36.55%)  tps: 5,472  tflops: 41.67  mfu: 13.36%
[rank2]:2025-11-04 01:56:45,388 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-04 01:56:45,389 - INFO -  step: 450  loss: -2.0000  grad_norm:  0.4671  memory:  6.51GiB(13.70%)  tps: 5,393  tflops: 41.07  mfu: 13.16%
[rank1]:2025-11-04 01:56:46,025 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.02/0.02, [MB7] 1.00/1.00
[rank1]:2025-11-04 01:56:46,025 - INFO -  step: 450  loss: -2.0000  grad_norm:  0.4671  memory:  9.38GiB(19.75%)  tps: 5,347  tflops: 40.72  mfu: 13.05%
[rank0]:2025-11-04 01:56:48,503 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.58/0.58, [MB7] 1.00/1.00
[rank0]:2025-11-04 01:56:48,504 - INFO -  step: 450  loss: -2.0000  grad_norm:  0.4671  memory: 13.40GiB(28.22%)  tps: 5,178  tflops: 39.44  mfu: 12.64%
[rank0]:2025-11-04 01:58:00,811 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 01:58:01,659 - INFO - Avg. fwd time: 13.2608 / Avg. bwd time: 34.7435 / Avg. batch time: 465.9335 (ms) / GPU bubble ratio: 17.58%
[rank2]:2025-11-04 01:58:01,699 - INFO - Avg. fwd time: 7.3649 / Avg. bwd time: 17.4383 / Avg. batch time: 495.9504 (ms) / GPU bubble ratio: 59.99%
[rank0]:2025-11-04 01:58:01,741 - INFO - Avg. fwd time: 8.2989 / Avg. bwd time: 19.9695 / Avg. batch time: 568.9475 (ms) / GPU bubble ratio: 60.25%
[rank1]:2025-11-04 01:58:01,728 - INFO - Avg. fwd time: 9.6671 / Avg. bwd time: 21.8125 / Avg. batch time: 533.2969 (ms) / GPU bubble ratio: 52.78%
[rank2]:2025-11-04 01:58:04,207 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-04 01:58:04,207 - INFO -  step: 500  loss: -2.0000  grad_norm:  0.2636  memory:  6.51GiB(13.70%)  tps: 5,197  tflops: 39.58  mfu: 12.69%
[rank1]:2025-11-04 01:58:04,811 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.02/0.02, [MB7] 1.00/1.00
[rank1]:2025-11-04 01:58:04,811 - INFO -  step: 500  loss: -2.0000  grad_norm:  0.2636  memory:  9.38GiB(19.75%)  tps: 5,199  tflops: 39.60  mfu: 12.69%
[rank3]:2025-11-04 01:58:06,120 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.40/0.40, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-11-04 01:58:06,123 - INFO -  step: 500  loss:  0.2341  grad_norm:  0.2636  memory: 17.37GiB(36.55%)  tps: 5,005  tflops: 38.12  mfu: 12.22%
[rank0]:2025-11-04 01:58:07,462 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.58/0.58, [MB7] 1.00/1.00
[rank0]:2025-11-04 01:58:07,462 - INFO -  step: 500  loss: -2.0000  grad_norm:  0.2636  memory: 13.40GiB(28.22%)  tps: 5,188  tflops: 39.51  mfu: 12.66%
[rank1]:2025-11-04 01:58:07,511 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251104_0158_stage1_step500.svg
[rank2]:2025-11-04 01:58:07,510 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251104_0158_stage2_step500.svg
[rank0]:2025-11-04 01:58:07,511 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251104_0158_stage0_step500.svg
[rank3]:2025-11-04 01:58:07,603 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/pipeline_schedule/251104_0158_real_step500_rank3.svg
[rank3]:> Batch Time: 487.02 ms, GPU Bubble Ratio: 67.44%, 52.37%, 61.12%, 36.46%
[rank3]:2025-11-04 01:58:07,645 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251104_0158_stage3_step500.svg
[rank0]:2025-11-04 01:59:20,218 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 01:59:22,809 - INFO -  step: 550  loss:  0.2330  grad_norm:  0.3101  memory: 17.37GiB(36.55%)  tps: 5,341  tflops: 40.68  mfu: 13.04%
[rank2]:2025-11-04 01:59:23,658 - INFO -  step: 550  loss: -2.0000  grad_norm:  0.3101  memory:  6.51GiB(13.70%)  tps: 5,155  tflops: 39.26  mfu: 12.58%
[rank1]:2025-11-04 01:59:24,230 - INFO -  step: 550  loss: -2.0000  grad_norm:  0.3101  memory:  9.38GiB(19.75%)  tps: 5,158  tflops: 39.28  mfu: 12.59%
[rank0]:2025-11-04 01:59:26,736 - INFO -  step: 550  loss: -2.0000  grad_norm:  0.3101  memory: 13.40GiB(28.22%)  tps: 5,167  tflops: 39.35  mfu: 12.61%
[rank0]:2025-11-04 02:00:39,863 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-04 02:00:40,858 - INFO - Avg. fwd time: 7.4056 / Avg. bwd time: 17.2028 / Avg. batch time: 482.6765 (ms) / GPU bubble ratio: 59.21%
[rank1]:2025-11-04 02:00:40,885 - INFO - Avg. fwd time: 9.7388 / Avg. bwd time: 21.3158 / Avg. batch time: 519.7548 (ms) / GPU bubble ratio: 52.20%
[rank3]:2025-11-04 02:00:40,835 - INFO - Avg. fwd time: 13.4421 / Avg. bwd time: 32.9231 / Avg. batch time: 452.8760 (ms) / GPU bubble ratio: 18.10%
[rank0]:2025-11-04 02:00:40,911 - INFO - Avg. fwd time: 8.3762 / Avg. bwd time: 18.4458 / Avg. batch time: 554.7712 (ms) / GPU bubble ratio: 61.32%
[rank2]:2025-11-04 02:00:43,353 - INFO -  step: 600  loss: -2.0000  grad_norm:  0.2165  memory:  6.51GiB(13.70%)  tps: 5,140  tflops: 39.14  mfu: 12.55%
[rank2]:2025-11-04 02:00:43,354 - INFO - ðŸ”Ž  Running validation at step 600
[rank1]:2025-11-04 02:00:43,950 - INFO -  step: 600  loss: -2.0000  grad_norm:  0.2165  memory:  9.38GiB(19.75%)  tps: 5,138  tflops: 39.13  mfu: 12.54%
[rank1]:2025-11-04 02:00:43,950 - INFO - ðŸ”Ž  Running validation at step 600
[rank3]:2025-11-04 02:00:45,073 - INFO -  step: 600  loss:  0.2052  grad_norm:  0.2165  memory: 17.37GiB(36.55%)  tps: 4,979  tflops: 37.92  mfu: 12.15%
[rank3]:2025-11-04 02:00:45,073 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-11-04 02:00:46,530 - INFO -  step: 600  loss: -2.0000  grad_norm:  0.2165  memory: 13.40GiB(28.22%)  tps: 5,133  tflops: 39.10  mfu: 12.53%
[rank0]:2025-11-04 02:00:46,530 - INFO - ðŸ”Ž  Running validation at step 600
[rank1]:2025-11-04 02:01:09,148 - INFO - validate step: 600  loss: -1.0000  memory:  9.38GiB(19.75%)  tps: 16,255
[rank3]:2025-11-04 02:01:09,165 - INFO - validate step: 600  loss:  0.9909  memory: 17.37GiB(36.55%)  tps: 17,002
[rank2]:2025-11-04 02:01:09,172 - INFO - validate step: 600  loss: -1.0000  memory:  6.51GiB(13.70%)  tps: 15,865
[rank0]:2025-11-04 02:01:09,130 - INFO - validate step: 600  loss: -1.0000  memory: 13.40GiB(28.22%)  tps: 18,124
[rank0]:2025-11-04 02:01:09,224 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251104_0201_stage0_step600.svg
[rank1]:2025-11-04 02:01:09,225 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251104_0201_stage1_step600.svg
[rank2]:2025-11-04 02:01:09,231 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251104_0201_stage2_step600.svg
[rank3]:2025-11-04 02:01:09,325 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/pipeline_schedule/251104_0201_real_step600_rank3.svg
[rank3]:> Batch Time: 486.03 ms, GPU Bubble Ratio: 66.73%, 52.26%, 61.08%, 36.39%
[rank3]:2025-11-04 02:01:09,368 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251104_0201_stage3_step600.svg
[rank0]:2025-11-04 02:02:22,315 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-04 02:02:24,769 - INFO -  step: 650  loss:  0.3285  grad_norm:  0.3243  memory: 17.37GiB(36.55%)  tps: 5,418  tflops: 41.26  mfu: 13.23%
[rank2]:2025-11-04 02:02:25,647 - INFO -  step: 650  loss: -2.0000  grad_norm:  0.3243  memory:  6.51GiB(13.70%)  tps: 5,356  tflops: 40.79  mfu: 13.07%
[rank1]:2025-11-04 02:02:26,280 - INFO -  step: 650  loss: -2.0000  grad_norm:  0.3243  memory:  9.38GiB(19.75%)  tps: 5,310  tflops: 40.45  mfu: 12.96%
[rank0]:2025-11-04 02:02:28,934 - INFO -  step: 650  loss: -2.0000  grad_norm:  0.3243  memory: 13.40GiB(28.22%)  tps: 5,133  tflops: 39.09  mfu: 12.53%
[rank0]:2025-11-04 02:03:41,392 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 02:03:42,219 - INFO - Avg. fwd time: 13.5633 / Avg. bwd time: 31.7996 / Avg. batch time: 444.8955 (ms) / GPU bubble ratio: 18.43%
[rank0]:2025-11-04 02:03:42,301 - INFO - Avg. fwd time: 8.4257 / Avg. bwd time: 17.4811 / Avg. batch time: 546.1217 (ms) / GPU bubble ratio: 62.05%
[rank2]:2025-11-04 02:03:42,261 - INFO - Avg. fwd time: 7.4318 / Avg. bwd time: 17.0594 / Avg. batch time: 474.5841 (ms) / GPU bubble ratio: 58.72%
[rank1]:2025-11-04 02:03:42,288 - INFO - Avg. fwd time: 9.7841 / Avg. bwd time: 21.0107 / Avg. batch time: 511.4886 (ms) / GPU bubble ratio: 51.84%
[rank3]:2025-11-04 02:03:43,260 - INFO -  step: 700  loss:  0.2267  grad_norm:  0.2520  memory: 17.37GiB(36.55%)  tps: 5,219  tflops: 39.75  mfu: 12.74%
[rank2]:2025-11-04 02:03:44,765 - INFO -  step: 700  loss: -2.0000  grad_norm:  0.2520  memory:  6.51GiB(13.70%)  tps: 5,177  tflops: 39.43  mfu: 12.64%
[rank1]:2025-11-04 02:03:45,449 - INFO -  step: 700  loss: -2.0000  grad_norm:  0.2520  memory:  9.38GiB(19.75%)  tps: 5,174  tflops: 39.40  mfu: 12.63%
[rank0]:2025-11-04 02:03:48,001 - INFO -  step: 700  loss: -2.0000  grad_norm:  0.2520  memory: 13.40GiB(28.22%)  tps: 5,180  tflops: 39.46  mfu: 12.65%
[rank1]:2025-11-04 02:03:48,052 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank1/251104_0203_stage1_step700.svg
[rank0]:2025-11-04 02:03:48,052 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank0/251104_0203_stage0_step700.svg
[rank2]:2025-11-04 02:03:48,053 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank2/251104_0203_stage2_step700.svg
[rank3]:2025-11-04 02:03:48,143 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/pipeline_schedule/251104_0203_real_step700_rank3.svg
[rank3]:> Batch Time: 485.70 ms, GPU Bubble Ratio: 67.46%, 52.14%, 60.98%, 36.99%
[rank3]:2025-11-04 02:03:48,189 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_1F1B_timelyapf_dm1/freeze_ratio_history/rank3/251104_0203_stage3_step700.svg
