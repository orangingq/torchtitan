
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 10. 29. (ìˆ˜) 20:35:12 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 3,4,5,6
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1029_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1029_llama1b/1029_GPipe_auto.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
âœ”ï¸Running with auto x GPipe ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1029_llama1b/config.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=auto
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank2]:2025-10-29 20:35:18,609 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank3]:2025-10-29 20:35:18,610 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank0]:2025-10-29 20:35:18,743 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank1]:2025-10-29 20:35:18,859 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank2]:2025-10-29 20:35:19,105 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-10-29 20:35:19,107 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-29 20:35:19,119 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-10-29 20:35:19,094 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-10-29 20:35:19,121 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-29 20:35:19,126 - INFO - [GC] Initial GC collection 0.00 seconds
[rank3]:2025-10-29 20:35:19,096 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-10-29 20:35:19,161 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-10-29 20:35:19,163 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-29 20:35:19,562 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-10-29 20:35:19,980 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank1]:2025-10-29 20:35:23,664 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-10-29 20:35:23,707 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-10-29 20:35:23,734 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-10-29 20:35:23,735 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-10-29 20:35:23,803 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=512, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank2]:2025-10-29 20:35:23,932 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-10-29 20:35:23,971 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-10-29 20:35:24,000 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-10-29 20:35:24,000 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-10-29 20:35:24,255 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-10-29 20:35:24,292 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-10-29 20:35:24,294 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-10-29 20:35:24,320 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-10-29 20:35:24,320 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank2]:2025-10-29 20:35:24,488 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-10-29 20:35:24,488 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-10-29 20:35:24,489 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank1]:2025-10-29 20:35:24,478 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-10-29 20:35:24,478 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-10-29 20:35:24,479 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank0]:2025-10-29 20:35:24,498 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-10-29 20:35:24,498 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-10-29 20:35:24,499 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run 3gtlh194
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1029_GPipe_auto_dm1/20251029-2035/wandb/run-20251029_203525-3gtlh194
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1029_GPipe_auto_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/3gtlh194
[rank3]:2025-10-29 20:35:26,076 - INFO - WandB logging enabled
[rank3]:2025-10-29 20:35:26,077 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-10-29 20:35:26,116 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-10-29 20:35:26,145 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-10-29 20:35:26,146 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-10-29 20:35:26,355 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1029_GPipe_auto_dm1
[rank0]:2025-10-29 20:35:26,355 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-10-29 20:35:26,355 - INFO - Preparing c4_validation dataset from allenai/c4
[rank2]:2025-10-29 20:35:26,354 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank1]:2025-10-29 20:35:26,354 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-10-29 20:35:26,338 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-10-29 20:35:26,339 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-10-29 20:35:26,340 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2025-10-29 20:35:26,355 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-10-29 20:35:31,786 - INFO - Trainer is initialized with local batch size 32, global batch size 64, gradient accumulation steps 2, sequence length 512, total steps 2400 (warmup 100)
[rank0]:2025-10-29 20:35:31,786 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B-Instruct/original_dcp.
[rank0]:2025-10-29 20:35:33,914 - INFO - [GC] GC collection for checkpoint loading. 0.01 seconds
[rank0]:2025-10-29 20:35:33,914 - INFO - Finished loading the checkpoint in 2.13 seconds.
[rank0]:2025-10-29 20:35:33,914 - INFO - Training starts at step 1
[rank2]:2025-10-29 20:35:36,494 - INFO -  step:  1  loss: -2.0000  grad_norm: 85.2027  memory:  9.35GiB(19.67%)  tps: 654  tflops: 4.98  mfu: 1.60%
[rank2]:2025-10-29 20:35:36,494 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-10-29 20:35:36,503 - INFO -  step:  1  loss: -2.0000  grad_norm: 85.2027  memory: 11.50GiB(24.20%)  tps: 640  tflops: 4.88  mfu: 1.56%
[rank1]:2025-10-29 20:35:36,503 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-29 20:35:36,504 - INFO -  step:  1  loss:  9.0164  grad_norm: 85.2027  memory: 23.19GiB(48.82%)  tps: 789  tflops: 6.01  mfu: 1.93%
[rank3]:2025-10-29 20:35:36,504 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-10-29 20:35:36,533 - INFO -  step:  1  loss: -2.0000  grad_norm: 85.2027  memory: 12.28GiB(25.84%)  tps: 669  tflops: 5.10  mfu: 1.63%
[rank0]:2025-10-29 20:35:36,533 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-29 20:35:54,785 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 20:35:54,786 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 20:35:54,786 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 20:35:54,787 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 20:35:54,787 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 20:35:54,787 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 20:35:54,788 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 20:35:54,788 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 20:35:54,788 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 20:35:54,789 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 20:35:54,789 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 20:35:54,789 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 20:35:54,789 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 20:35:54,790 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 20:35:54,790 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 20:35:54,790 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 20:35:54,813 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 20:35:54,813 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 20:35:54,813 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 20:35:54,813 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 20:35:54,813 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 20:35:54,813 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 20:35:54,813 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 20:35:54,813 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 20:35:54,814 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 20:35:54,814 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 20:35:54,814 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 20:35:54,814 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 20:35:54,814 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 20:35:54,814 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 20:35:54,814 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 20:35:54,814 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 20:35:54,841 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 20:35:54,841 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 20:35:54,841 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 20:35:54,841 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 20:35:54,842 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 20:35:54,842 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 20:35:54,842 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 20:35:54,842 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 20:35:54,842 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 20:35:54,842 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 20:35:54,842 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 20:35:54,842 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 20:35:54,842 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 20:35:54,842 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 20:35:54,842 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 20:35:54,843 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 20:35:54,869 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 20:35:54,869 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 20:35:54,870 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 20:35:54,870 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 20:35:54,870 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 20:35:54,870 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 20:35:54,870 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 20:35:54,870 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 20:35:54,870 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 20:35:54,870 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 20:35:54,870 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 20:35:54,870 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 20:35:54,870 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 20:35:54,870 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 20:35:54,871 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 20:35:54,871 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 20:36:36,091 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 20:36:37,348 - INFO -  step: 50  loss: -2.0000  grad_norm: 35.3319  memory: 16.57GiB(34.88%)  tps: 6,600  tflops: 50.27  mfu: 16.11%
[rank2]:2025-10-29 20:36:37,333 - INFO -  step: 50  loss: -2.0000  grad_norm: 35.3319  memory: 11.81GiB(24.85%)  tps: 6,598  tflops: 50.25  mfu: 16.11%
[rank3]:2025-10-29 20:36:37,346 - INFO -  step: 50  loss:  8.4873  grad_norm: 35.3319  memory: 27.51GiB(57.90%)  tps: 6,598  tflops: 50.25  mfu: 16.11%
[rank1]:2025-10-29 20:36:37,337 - INFO -  step: 50  loss: -2.0000  grad_norm: 35.3319  memory: 14.64GiB(30.82%)  tps: 6,598  tflops: 50.26  mfu: 16.11%
[rank0]:2025-10-29 20:36:49,661 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 0.0000e+00
[rank2]:2025-10-29 20:36:49,644 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 0.0000e+00
[rank3]:2025-10-29 20:36:49,656 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 0.0000e+00
[rank1]:2025-10-29 20:36:49,649 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 0.0000e+00
[rank0]:2025-10-29 20:37:01,968 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 2.0261e+00
[rank2]:2025-10-29 20:37:01,953 - INFO - Freezing Ratio: [Stage2] 0.25, Threshold: 1.3251e+00
[rank3]:2025-10-29 20:37:01,964 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 3.4660e+00
[rank1]:2025-10-29 20:37:01,957 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 8.6042e-01
[rank0]:2025-10-29 20:37:13,877 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 4.1455e+00
[rank1]:2025-10-29 20:37:13,865 - INFO - Freezing Ratio: [Stage1] 0.20, Threshold: 3.2840e+00
[rank2]:2025-10-29 20:37:13,857 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 3.6965e+00
[rank3]:2025-10-29 20:37:13,869 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.7639e+00
[rank2]:2025-10-29 20:37:26,168 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.9687e+00
[rank1]:2025-10-29 20:37:26,168 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.7096e+00
[rank0]:2025-10-29 20:37:26,183 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 2.5423e+01
[rank3]:2025-10-29 20:37:26,179 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 1.0483e+01
[rank0]:2025-10-29 20:37:36,787 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 20:37:37,981 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 4.1510e+00
[rank2]:2025-10-29 20:37:37,981 - INFO -  step: 100  loss: -2.0000  grad_norm: 64.6275  memory: 11.81GiB(24.85%)  tps: 6,754  tflops: 51.44  mfu: 16.49%
[rank0]:2025-10-29 20:37:38,006 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 2.0545e+00
[rank0]:2025-10-29 20:37:38,006 - INFO -  step: 100  loss: -2.0000  grad_norm: 64.6275  memory: 16.57GiB(34.88%)  tps: 6,753  tflops: 51.43  mfu: 16.48%
[rank3]:2025-10-29 20:37:37,996 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 4.9495e+00
[rank3]:2025-10-29 20:37:37,999 - INFO -  step: 100  loss:  5.8982  grad_norm: 64.6275  memory: 27.51GiB(57.90%)  tps: 6,753  tflops: 51.43  mfu: 16.49%
[rank1]:2025-10-29 20:37:37,993 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 9.0786e-01
[rank1]:2025-10-29 20:37:37,993 - INFO -  step: 100  loss: -2.0000  grad_norm: 64.6275  memory: 14.64GiB(30.82%)  tps: 6,753  tflops: 51.43  mfu: 16.48%
[rank0]:2025-10-29 20:37:38,084 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_2037_stage0_step100.svg
[rank2]:2025-10-29 20:37:38,086 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_2037_stage2_step100.svg
[rank1]:2025-10-29 20:37:38,098 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_2037_stage1_step100.svg
[rank3]:2025-10-29 20:37:38,209 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/pipeline_schedule/251029_2037_real_step100_rank3.svg
[rank3]:> Batch Time: 514.55 ms, GPU Bubble Ratio: 51.76%, 49.97%, 61.22%, 18.41%
[rank3]:2025-10-29 20:37:38,275 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_2037_stage3_step100.svg
[rank3]:2025-10-29 20:37:38,576 - INFO - Avg. fwd time: 10.5818 / Avg. bwd time: 41.8497 / Avg. batch time: 484.5555 (ms) / GPU bubble ratio: 13.44%
[rank2]:2025-10-29 20:37:38,646 - INFO - Avg. fwd time: 6.8780 / Avg. bwd time: 17.8365 / Avg. batch time: 514.5953 (ms) / GPU bubble ratio: 61.58%
[rank1]:2025-10-29 20:37:38,670 - INFO - Avg. fwd time: 8.9109 / Avg. bwd time: 23.1432 / Avg. batch time: 552.4801 (ms) / GPU bubble ratio: 53.59%
[rank0]:2025-10-29 20:37:38,686 - INFO - Avg. fwd time: 8.3323 / Avg. bwd time: 23.3645 / Avg. batch time: 588.9691 (ms) / GPU bubble ratio: 56.95%
[rank0]:2025-10-29 20:37:50,531 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 4.6956e+00
[rank3]:2025-10-29 20:37:50,528 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 2.1906e+00
[rank2]:2025-10-29 20:37:50,516 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 9.0415e-01
[rank1]:2025-10-29 20:37:50,512 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 3.4084e+00
[rank0]:2025-10-29 20:38:02,360 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 2.9926e+00
[rank3]:2025-10-29 20:38:02,350 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.0519e+00
[rank1]:2025-10-29 20:38:02,347 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.6315e+00
[rank2]:2025-10-29 20:38:02,335 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.2454e+00
[rank0]:2025-10-29 20:38:14,663 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 1.5929e+01
[rank3]:2025-10-29 20:38:14,659 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 5.6004e+00
[rank1]:2025-10-29 20:38:14,643 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.0054e+00
[rank2]:2025-10-29 20:38:14,647 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.3750e+00
[rank0]:2025-10-29 20:38:26,500 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 3.5516e+00
[rank3]:2025-10-29 20:38:26,493 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.2797e+00
[rank1]:2025-10-29 20:38:26,489 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.5462e+00
[rank2]:2025-10-29 20:38:26,477 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.5687e+00
[rank0]:2025-10-29 20:38:37,532 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 20:38:38,787 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.8023e+00
[rank0]:2025-10-29 20:38:38,788 - INFO -  step: 150  loss: -2.0000  grad_norm: 24.1290  memory: 16.57GiB(34.88%)  tps: 6,739  tflops: 51.32  mfu: 16.45%
[rank1]:2025-10-29 20:38:38,767 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 3.8775e+00
[rank1]:2025-10-29 20:38:38,767 - INFO -  step: 150  loss: -2.0000  grad_norm: 24.1290  memory: 14.64GiB(30.82%)  tps: 6,740  tflops: 51.33  mfu: 16.45%
[rank3]:2025-10-29 20:38:38,782 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 3.2065e+00
[rank3]:2025-10-29 20:38:38,785 - INFO -  step: 150  loss:  1.1547  grad_norm: 24.1290  memory: 27.51GiB(57.90%)  tps: 6,739  tflops: 51.32  mfu: 16.45%
[rank2]:2025-10-29 20:38:38,771 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.9364e+00
[rank2]:2025-10-29 20:38:38,771 - INFO -  step: 150  loss: -2.0000  grad_norm: 24.1290  memory: 11.81GiB(24.85%)  tps: 6,738  tflops: 51.32  mfu: 16.45%
[rank0]:2025-10-29 20:38:50,449 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.3342e+01
[rank1]:2025-10-29 20:38:50,445 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.1561e+01
[rank3]:2025-10-29 20:38:50,449 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 7.2478e+00
[rank2]:2025-10-29 20:38:50,433 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.0819e+01
[rank0]:2025-10-29 20:39:02,454 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.4941e+00
[rank1]:2025-10-29 20:39:02,443 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.0741e+00
[rank3]:2025-10-29 20:39:02,458 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 2.7138e+00
[rank2]:2025-10-29 20:39:02,439 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.4123e+00
[rank0]:2025-10-29 20:39:14,062 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.0838e+01
[rank1]:2025-10-29 20:39:14,058 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.2300e+01
[rank3]:2025-10-29 20:39:14,062 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 8.1320e+00
[rank2]:2025-10-29 20:39:14,046 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.0617e+01
[rank0]:2025-10-29 20:39:25,947 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.1672e+01
[rank1]:2025-10-29 20:39:25,940 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.6061e+01
[rank3]:2025-10-29 20:39:25,955 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 1.2741e+01
[rank2]:2025-10-29 20:39:25,936 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.3191e+01
[rank0]:2025-10-29 20:39:36,239 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 20:39:37,418 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.4184e+00
[rank0]:2025-10-29 20:39:37,419 - INFO -  step: 200  loss: -2.0000  grad_norm:  0.5281  memory: 16.57GiB(34.88%)  tps: 6,986  tflops: 53.21  mfu: 17.05%
[rank0]:2025-10-29 20:39:37,419 - INFO - ðŸ”Ž  Running validation at step 200
[rank1]:2025-10-29 20:39:37,412 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 5.7401e-01
[rank1]:2025-10-29 20:39:37,412 - INFO -  step: 200  loss: -2.0000  grad_norm:  0.5281  memory: 14.64GiB(30.82%)  tps: 6,984  tflops: 53.20  mfu: 17.05%
[rank1]:2025-10-29 20:39:37,412 - INFO - ðŸ”Ž  Running validation at step 200
[rank3]:2025-10-29 20:39:37,422 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.3178e+00
[rank3]:2025-10-29 20:39:37,426 - INFO -  step: 200  loss:  0.2856  grad_norm:  0.5281  memory: 27.51GiB(57.90%)  tps: 6,985  tflops: 53.20  mfu: 17.05%
[rank3]:2025-10-29 20:39:37,426 - INFO - ðŸ”Ž  Running validation at step 200
[rank2]:2025-10-29 20:39:37,403 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.2202e+00
[rank2]:2025-10-29 20:39:37,404 - INFO -  step: 200  loss: -2.0000  grad_norm:  0.5281  memory: 11.83GiB(24.89%)  tps: 6,986  tflops: 53.21  mfu: 17.05%
[rank2]:2025-10-29 20:39:37,404 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-10-29 20:39:58,697 - INFO - validate step: 200  loss: -1.0000  memory: 16.57GiB(34.88%)  tps: 19,250
[rank3]:2025-10-29 20:39:58,723 - INFO - validate step: 200  loss:  0.9423  memory: 27.51GiB(57.90%)  tps: 19,233
[rank1]:2025-10-29 20:39:58,713 - INFO - validate step: 200  loss: -1.0000  memory: 14.64GiB(30.82%)  tps: 19,230
[rank2]:2025-10-29 20:39:58,730 - INFO - validate step: 200  loss: -1.0000  memory: 11.83GiB(24.89%)  tps: 19,207
[rank0]:2025-10-29 20:39:58,808 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_2039_stage0_step200.svg
[rank1]:2025-10-29 20:39:58,812 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_2039_stage1_step200.svg
[rank2]:2025-10-29 20:39:58,810 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_2039_stage2_step200.svg
[rank3]:2025-10-29 20:39:58,915 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/pipeline_schedule/251029_2039_real_step200_rank3.svg
[rank3]:> Batch Time: 512.49 ms, GPU Bubble Ratio: 51.47%, 49.79%, 61.20%, 18.41%
[rank3]:2025-10-29 20:39:58,983 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_2039_stage3_step200.svg
[rank0]:2025-10-29 20:39:59,314 - INFO - Avg. fwd time: 8.3328 / Avg. bwd time: 22.0582 / Avg. batch time: 580.1128 (ms) / GPU bubble ratio: 58.09%
[rank3]:2025-10-29 20:39:59,292 - INFO - Avg. fwd time: 10.6954 / Avg. bwd time: 41.5139 / Avg. batch time: 479.7921 (ms) / GPU bubble ratio: 12.95%
[rank2]:2025-10-29 20:39:59,320 - INFO - Avg. fwd time: 7.1825 / Avg. bwd time: 16.0972 / Avg. batch time: 508.4472 (ms) / GPU bubble ratio: 63.37%
[rank1]:2025-10-29 20:39:59,382 - INFO - Avg. fwd time: 9.1434 / Avg. bwd time: 21.9177 / Avg. batch time: 545.0075 (ms) / GPU bubble ratio: 54.41%
[rank1]:2025-10-29 20:40:10,846 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 5.3253e-01
[rank3]:2025-10-29 20:40:10,862 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 3.5439e-01
[rank0]:2025-10-29 20:40:10,854 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.2361e+00
[rank2]:2025-10-29 20:40:10,842 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.7314e-01
[rank1]:2025-10-29 20:40:22,237 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.7696e+00
[rank3]:2025-10-29 20:40:22,248 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.1111e+00
[rank0]:2025-10-29 20:40:22,244 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.3806e+00
[rank2]:2025-10-29 20:40:22,229 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 7.5045e-01
[rank1]:2025-10-29 20:40:34,099 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 4.3487e-01
[rank0]:2025-10-29 20:40:34,107 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 6.3462e-01
[rank2]:2025-10-29 20:40:34,095 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.3901e-01
[rank3]:2025-10-29 20:40:34,115 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 5.0359e-01
[rank2]:2025-10-29 20:40:45,521 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.0202e+00
[rank1]:2025-10-29 20:40:45,530 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 5.1604e-01
[rank3]:2025-10-29 20:40:45,545 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.2255e+00
[rank0]:2025-10-29 20:40:45,537 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.3867e+00
[rank0]:2025-10-29 20:40:56,211 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-29 20:40:57,398 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.0137e+00
[rank1]:2025-10-29 20:40:57,406 - INFO -  step: 250  loss: -2.0000  grad_norm:  0.3732  memory: 14.66GiB(30.86%)  tps: 6,979  tflops: 53.15  mfu: 17.04%
[rank3]:2025-10-29 20:40:57,417 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 1.4001e+00
[rank3]:2025-10-29 20:40:57,420 - INFO -  step: 250  loss:  0.2636  grad_norm:  0.3732  memory: 27.51GiB(57.90%)  tps: 6,978  tflops: 53.15  mfu: 17.03%
[rank0]:2025-10-29 20:40:57,409 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.0509e+00
[rank0]:2025-10-29 20:40:57,410 - INFO -  step: 250  loss: -2.0000  grad_norm:  0.3732  memory: 16.57GiB(34.88%)  tps: 6,976  tflops: 53.13  mfu: 17.03%
[rank2]:2025-10-29 20:40:57,397 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.0181e-01
[rank2]:2025-10-29 20:40:57,398 - INFO -  step: 250  loss: -2.0000  grad_norm:  0.3732  memory: 11.83GiB(24.89%)  tps: 6,982  tflops: 53.17  mfu: 17.04%
[rank1]:2025-10-29 20:41:08,741 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 9.9577e-01
[rank3]:2025-10-29 20:41:08,752 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 9.4278e-01
[rank0]:2025-10-29 20:41:08,748 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.4375e+00
[rank2]:2025-10-29 20:41:08,732 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.0421e+00
[rank1]:2025-10-29 20:41:20,580 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 2.3750e-01
[rank3]:2025-10-29 20:41:20,600 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 6.1532e-01
[rank0]:2025-10-29 20:41:20,591 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.0941e-01
[rank2]:2025-10-29 20:41:20,580 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.8720e-01
[rank1]:2025-10-29 20:41:32,011 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 2.0702e-01
[rank0]:2025-10-29 20:41:32,018 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.8858e+00
[rank3]:2025-10-29 20:41:32,028 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 8.9577e-01
[rank2]:2025-10-29 20:41:32,003 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 3.7929e-01
[rank2]:2025-10-29 20:41:43,900 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.6802e-01
[rank1]:2025-10-29 20:41:43,901 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 2.8007e-01
[rank3]:2025-10-29 20:41:43,920 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 4.0112e-01
[rank0]:2025-10-29 20:41:43,912 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.0656e+00
[rank0]:2025-10-29 20:41:54,112 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 20:41:55,248 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 4.1742e-01
[rank1]:2025-10-29 20:41:55,249 - INFO -  step: 300  loss: -2.0000  grad_norm:  0.3017  memory: 14.66GiB(30.86%)  tps: 7,081  tflops: 53.93  mfu: 17.29%
[rank0]:2025-10-29 20:41:55,255 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 7.7494e-01
[rank0]:2025-10-29 20:41:55,256 - INFO -  step: 300  loss: -2.0000  grad_norm:  0.3017  memory: 16.57GiB(34.88%)  tps: 7,081  tflops: 53.93  mfu: 17.29%
[rank3]:2025-10-29 20:41:55,260 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.1220e+00
[rank3]:2025-10-29 20:41:55,263 - INFO -  step: 300  loss:  0.2283  grad_norm:  0.3017  memory: 27.51GiB(57.90%)  tps: 7,081  tflops: 53.93  mfu: 17.29%
[rank2]:2025-10-29 20:41:55,240 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.2456e+00
[rank2]:2025-10-29 20:41:55,241 - INFO -  step: 300  loss: -2.0000  grad_norm:  0.3017  memory: 11.83GiB(24.89%)  tps: 7,082  tflops: 53.94  mfu: 17.29%
[rank1]:2025-10-29 20:41:55,336 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_2041_stage1_step300.svg
[rank0]:2025-10-29 20:41:55,340 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_2041_stage0_step300.svg
[rank2]:2025-10-29 20:41:55,342 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_2041_stage2_step300.svg
[rank3]:2025-10-29 20:41:55,455 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/pipeline_schedule/251029_2041_real_step300_rank3.svg
[rank3]:> Batch Time: 502.38 ms, GPU Bubble Ratio: 50.37%, 54.92%, 66.72%, 16.84%
[rank3]:2025-10-29 20:41:55,526 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_2041_stage3_step300.svg
[rank1]:2025-10-29 20:41:56,062 - INFO - Avg. fwd time: 9.3774 / Avg. bwd time: 20.3853 / Avg. batch time: 541.1611 (ms) / GPU bubble ratio: 56.00%
[rank0]:2025-10-29 20:41:56,083 - INFO - Avg. fwd time: 8.5611 / Avg. bwd time: 19.8560 / Avg. batch time: 573.9831 (ms) / GPU bubble ratio: 60.39%
[rank3]:2025-10-29 20:41:56,023 - INFO - Avg. fwd time: 10.7387 / Avg. bwd time: 41.4599 / Avg. batch time: 478.8059 (ms) / GPU bubble ratio: 12.79%
[rank2]:2025-10-29 20:41:56,042 - INFO - Avg. fwd time: 7.4162 / Avg. bwd time: 14.6139 / Avg. batch time: 506.2131 (ms) / GPU bubble ratio: 65.18%
[rank1]:2025-10-29 20:42:07,299 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.6225e+00
[rank3]:2025-10-29 20:42:07,319 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 1.7591e+00
[rank0]:2025-10-29 20:42:07,311 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.9343e+00
[rank2]:2025-10-29 20:42:07,299 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.3572e+00
[rank1]:2025-10-29 20:42:18,720 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.6459e+00
[rank3]:2025-10-29 20:42:18,731 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.2196e+00
[rank0]:2025-10-29 20:42:18,726 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.8349e+00
[rank2]:2025-10-29 20:42:18,711 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.7673e+00
[rank1]:2025-10-29 20:42:30,545 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 2.5827e-01
[rank0]:2025-10-29 20:42:30,556 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.5751e+00
[rank2]:2025-10-29 20:42:30,545 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.6195e-01
[rank3]:2025-10-29 20:42:30,564 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 6.6782e-01
[rank2]:2025-10-29 20:42:41,884 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.4243e+00
[rank3]:2025-10-29 20:42:41,904 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.2827e+00
[rank1]:2025-10-29 20:42:41,893 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 2.2836e-01
[rank0]:2025-10-29 20:42:41,900 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 6.7943e-01
[rank0]:2025-10-29 20:42:52,535 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 20:42:53,736 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 1.1143e+00
[rank3]:2025-10-29 20:42:53,739 - INFO -  step: 350  loss:  0.1823  grad_norm:  0.2511  memory: 27.51GiB(57.90%)  tps: 7,005  tflops: 53.35  mfu: 17.10%
[rank1]:2025-10-29 20:42:53,716 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 6.2932e-01
[rank1]:2025-10-29 20:42:53,716 - INFO -  step: 350  loss: -2.0000  grad_norm:  0.2511  memory: 14.66GiB(30.86%)  tps: 7,006  tflops: 53.36  mfu: 17.10%
[rank0]:2025-10-29 20:42:53,727 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.3670e+00
[rank0]:2025-10-29 20:42:53,728 - INFO -  step: 350  loss: -2.0000  grad_norm:  0.2511  memory: 16.57GiB(34.88%)  tps: 7,005  tflops: 53.35  mfu: 17.10%
[rank2]:2025-10-29 20:42:53,716 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.3983e-01
[rank2]:2025-10-29 20:42:53,716 - INFO -  step: 350  loss: -2.0000  grad_norm:  0.2511  memory: 11.83GiB(24.89%)  tps: 7,005  tflops: 53.35  mfu: 17.10%
[rank3]:2025-10-29 20:43:05,094 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.1516e+00
[rank1]:2025-10-29 20:43:05,082 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 7.9612e-01
[rank2]:2025-10-29 20:43:05,074 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 8.2808e-01
[rank0]:2025-10-29 20:43:05,089 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 6.4748e-01
[rank1]:2025-10-29 20:43:16,873 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 4.3931e-01
[rank3]:2025-10-29 20:43:16,893 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 9.3873e-01
[rank2]:2025-10-29 20:43:16,873 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 7.2907e-01
[rank0]:2025-10-29 20:43:16,885 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 6.0963e-01
[rank1]:2025-10-29 20:43:28,200 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.1208e+00
[rank3]:2025-10-29 20:43:28,210 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 4.7435e-01
[rank2]:2025-10-29 20:43:28,190 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 7.8125e-01
[rank0]:2025-10-29 20:43:28,206 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.7305e+00
[rank1]:2025-10-29 20:43:40,008 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.2817e+00
[rank3]:2025-10-29 20:43:40,027 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 1.0497e+00
[rank2]:2025-10-29 20:43:40,008 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 7.2510e-01
[rank0]:2025-10-29 20:43:40,019 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.5260e+00
[rank0]:2025-10-29 20:43:50,246 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 20:43:51,410 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 5.0772e-01
[rank1]:2025-10-29 20:43:51,410 - INFO -  step: 400  loss: -2.0000  grad_norm:  0.3964  memory: 14.66GiB(30.86%)  tps: 7,100  tflops: 54.07  mfu: 17.33%
[rank1]:2025-10-29 20:43:51,410 - INFO - ðŸ”Ž  Running validation at step 400
[rank3]:2025-10-29 20:43:51,420 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 4.6501e-01
[rank3]:2025-10-29 20:43:51,424 - INFO -  step: 400  loss:  0.2192  grad_norm:  0.3964  memory: 27.51GiB(57.90%)  tps: 7,101  tflops: 54.08  mfu: 17.33%
[rank3]:2025-10-29 20:43:51,424 - INFO - ðŸ”Ž  Running validation at step 400
[rank2]:2025-10-29 20:43:51,401 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 5.0743e-01
[rank2]:2025-10-29 20:43:51,401 - INFO -  step: 400  loss: -2.0000  grad_norm:  0.3964  memory: 11.83GiB(24.89%)  tps: 7,101  tflops: 54.08  mfu: 17.33%
[rank2]:2025-10-29 20:43:51,401 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-10-29 20:43:51,416 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.2544e-01
[rank0]:2025-10-29 20:43:51,417 - INFO -  step: 400  loss: -2.0000  grad_norm:  0.3964  memory: 16.57GiB(34.88%)  tps: 7,100  tflops: 54.08  mfu: 17.33%
[rank0]:2025-10-29 20:43:51,417 - INFO - ðŸ”Ž  Running validation at step 400
[rank3]:2025-10-29 20:44:11,668 - INFO - validate step: 400  loss:  0.9359  memory: 27.51GiB(57.90%)  tps: 20,235
[rank1]:2025-10-29 20:44:11,659 - INFO - validate step: 400  loss: -1.0000  memory: 14.66GiB(30.86%)  tps: 20,229
[rank0]:2025-10-29 20:44:11,645 - INFO - validate step: 400  loss: -1.0000  memory: 16.57GiB(34.88%)  tps: 20,249
[rank2]:2025-10-29 20:44:11,674 - INFO - validate step: 400  loss: -1.0000  memory: 11.83GiB(24.89%)  tps: 20,205
[rank1]:2025-10-29 20:44:11,755 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_2044_stage1_step400.svg
[rank0]:2025-10-29 20:44:11,760 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_2044_stage0_step400.svg
[rank2]:2025-10-29 20:44:11,757 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_2044_stage2_step400.svg
[rank3]:2025-10-29 20:44:11,856 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/pipeline_schedule/251029_2044_real_step400_rank3.svg
[rank3]:> Batch Time: 494.16 ms, GPU Bubble Ratio: 59.65%, 54.49%, 66.19%, 15.50%
[rank3]:2025-10-29 20:44:11,929 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_2044_stage3_step400.svg
[rank3]:2025-10-29 20:44:12,233 - INFO - Avg. fwd time: 10.7476 / Avg. bwd time: 41.4460 / Avg. batch time: 478.3882 (ms) / GPU bubble ratio: 12.72%
[rank0]:2025-10-29 20:44:12,253 - INFO - Avg. fwd time: 8.6588 / Avg. bwd time: 18.9088 / Avg. batch time: 570.8769 (ms) / GPU bubble ratio: 61.37%
[rank2]:2025-10-29 20:44:12,260 - INFO - Avg. fwd time: 7.5087 / Avg. bwd time: 14.0129 / Avg. batch time: 504.9660 (ms) / GPU bubble ratio: 65.90%
[rank1]:2025-10-29 20:44:12,316 - INFO - Avg. fwd time: 9.5005 / Avg. bwd time: 19.5621 / Avg. batch time: 539.0411 (ms) / GPU bubble ratio: 56.87%
[rank0]:2025-10-29 20:44:23,707 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.3702e+00
[rank1]:2025-10-29 20:44:23,695 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 8.2755e-01
[rank2]:2025-10-29 20:44:23,695 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.5755e-01
[rank3]:2025-10-29 20:44:23,715 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 2.9280e-01
[rank2]:2025-10-29 20:44:35,109 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.0545e+00
[rank1]:2025-10-29 20:44:35,118 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.3490e+00
[rank3]:2025-10-29 20:44:35,129 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.1324e+00
[rank0]:2025-10-29 20:44:35,124 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 5.0027e-01
[rank3]:2025-10-29 20:44:46,913 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 5.0172e-01
[rank0]:2025-10-29 20:44:46,905 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 5.6404e-01
[rank2]:2025-10-29 20:44:46,893 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.9028e-01
[rank1]:2025-10-29 20:44:46,893 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 5.9143e-01
[rank1]:2025-10-29 20:44:58,250 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 4.3741e-01
[rank2]:2025-10-29 20:44:58,241 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 5.6960e-01
[rank3]:2025-10-29 20:44:58,261 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 4.0062e-01
[rank0]:2025-10-29 20:44:58,257 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 8.4383e-01
[rank0]:2025-10-29 20:45:08,907 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-29 20:45:10,099 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 1.2538e+00
[rank3]:2025-10-29 20:45:10,102 - INFO -  step: 450  loss:  0.2252  grad_norm:  0.3136  memory: 27.51GiB(57.90%)  tps: 7,010  tflops: 53.39  mfu: 17.11%
[rank0]:2025-10-29 20:45:10,090 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 6.8897e-01
[rank0]:2025-10-29 20:45:10,090 - INFO -  step: 450  loss: -2.0000  grad_norm:  0.3136  memory: 16.57GiB(34.88%)  tps: 7,008  tflops: 53.38  mfu: 17.11%
[rank2]:2025-10-29 20:45:10,079 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 7.2555e-01
[rank2]:2025-10-29 20:45:10,079 - INFO -  step: 450  loss: -2.0000  grad_norm:  0.3136  memory: 11.83GiB(24.89%)  tps: 7,013  tflops: 53.41  mfu: 17.12%
[rank1]:2025-10-29 20:45:10,078 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.3760e+00
[rank1]:2025-10-29 20:45:10,079 - INFO -  step: 450  loss: -2.0000  grad_norm:  0.3136  memory: 14.66GiB(30.86%)  tps: 7,011  tflops: 53.40  mfu: 17.12%
[rank3]:2025-10-29 20:45:21,453 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.9573e+00
[rank0]:2025-10-29 20:45:21,449 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.6943e+00
[rank2]:2025-10-29 20:45:21,434 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 3.2844e+00
[rank1]:2025-10-29 20:45:21,442 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 3.8905e+00
[rank3]:2025-10-29 20:45:33,269 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 1.2851e+00
[rank0]:2025-10-29 20:45:33,261 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.3086e+00
[rank2]:2025-10-29 20:45:33,249 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 8.4910e-01
[rank1]:2025-10-29 20:45:33,249 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.6350e+00
[rank3]:2025-10-29 20:45:44,689 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 6.9625e-01
[rank0]:2025-10-29 20:45:44,685 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.0510e+00
[rank1]:2025-10-29 20:45:44,677 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 3.9437e-01
[rank2]:2025-10-29 20:45:44,669 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 6.9244e-01
[rank1]:2025-10-29 20:45:56,531 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 6.0679e-01
[rank2]:2025-10-29 20:45:56,531 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.8581e-01
[rank3]:2025-10-29 20:45:56,551 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 4.9949e-01
[rank0]:2025-10-29 20:45:56,542 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 8.0736e-01
[rank0]:2025-10-29 20:46:06,716 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 20:46:07,848 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 9.4204e-01
[rank1]:2025-10-29 20:46:07,849 - INFO -  step: 500  loss: -2.0000  grad_norm:  0.3221  memory: 14.66GiB(30.86%)  tps: 7,090  tflops: 54.00  mfu: 17.31%
[rank2]:2025-10-29 20:46:07,840 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 8.8970e-01
[rank2]:2025-10-29 20:46:07,840 - INFO -  step: 500  loss: -2.0000  grad_norm:  0.3221  memory: 11.83GiB(24.89%)  tps: 7,091  tflops: 54.01  mfu: 17.31%
[rank3]:2025-10-29 20:46:07,862 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.8035e-01
[rank3]:2025-10-29 20:46:07,865 - INFO -  step: 500  loss:  0.2573  grad_norm:  0.3221  memory: 27.51GiB(57.90%)  tps: 7,091  tflops: 54.01  mfu: 17.31%
[rank0]:2025-10-29 20:46:07,855 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 6.5086e-01
[rank0]:2025-10-29 20:46:07,856 - INFO -  step: 500  loss: -2.0000  grad_norm:  0.3221  memory: 16.57GiB(34.88%)  tps: 7,091  tflops: 54.01  mfu: 17.31%
[rank0]:2025-10-29 20:46:07,940 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_2046_stage0_step500.svg
[rank1]:2025-10-29 20:46:07,936 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_2046_stage1_step500.svg
[rank2]:2025-10-29 20:46:07,942 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_2046_stage2_step500.svg
[rank3]:2025-10-29 20:46:08,048 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/pipeline_schedule/251029_2046_real_step500_rank3.svg
[rank3]:> Batch Time: 493.43 ms, GPU Bubble Ratio: 59.54%, 54.48%, 66.40%, 15.48%
[rank3]:2025-10-29 20:46:08,117 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_2046_stage3_step500.svg
[rank3]:2025-10-29 20:46:08,425 - INFO - Avg. fwd time: 10.7546 / Avg. bwd time: 41.4012 / Avg. batch time: 477.8119 (ms) / GPU bubble ratio: 12.68%
[rank0]:2025-10-29 20:46:08,446 - INFO - Avg. fwd time: 8.7271 / Avg. bwd time: 18.2369 / Avg. batch time: 568.5422 (ms) / GPU bubble ratio: 62.06%
[rank2]:2025-10-29 20:46:08,452 - INFO - Avg. fwd time: 7.5809 / Avg. bwd time: 13.5466 / Avg. batch time: 503.9013 (ms) / GPU bubble ratio: 66.46%
[rank1]:2025-10-29 20:46:08,506 - INFO - Avg. fwd time: 9.5814 / Avg. bwd time: 19.0200 / Avg. batch time: 537.4032 (ms) / GPU bubble ratio: 57.42%
[rank0]:2025-10-29 20:46:19,851 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.2176e+00
[rank1]:2025-10-29 20:46:19,839 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.9060e+00
[rank2]:2025-10-29 20:46:19,839 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.4905e+00
[rank3]:2025-10-29 20:46:19,859 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 1.7719e+00
[rank3]:2025-10-29 20:46:31,248 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.2656e+00
[rank0]:2025-10-29 20:46:31,243 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.5736e+00
[rank1]:2025-10-29 20:46:31,236 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 2.0548e+00
[rank2]:2025-10-29 20:46:31,228 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.2336e+00
[rank3]:2025-10-29 20:46:43,125 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 1.5795e+00
[rank0]:2025-10-29 20:46:43,116 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.8366e+00
[rank1]:2025-10-29 20:46:43,105 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 5.4106e-01
[rank2]:2025-10-29 20:46:43,104 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 9.2862e-01
[rank0]:2025-10-29 20:46:54,503 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.6066e+00
[rank2]:2025-10-29 20:46:54,488 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.6346e+00
[rank1]:2025-10-29 20:46:54,495 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 4.3112e-01
[rank3]:2025-10-29 20:46:54,507 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.4035e+00
[rank0]:2025-10-29 20:47:05,149 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 20:47:06,360 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 9.0905e-01
[rank3]:2025-10-29 20:47:06,363 - INFO -  step: 550  loss:  0.2554  grad_norm:  0.3475  memory: 27.51GiB(57.90%)  tps: 7,002  tflops: 53.33  mfu: 17.09%
[rank0]:2025-10-29 20:47:06,351 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.0587e+00
[rank0]:2025-10-29 20:47:06,351 - INFO -  step: 550  loss: -2.0000  grad_norm:  0.3475  memory: 16.57GiB(34.88%)  tps: 7,002  tflops: 53.33  mfu: 17.09%
[rank1]:2025-10-29 20:47:06,339 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 8.9390e-01
[rank1]:2025-10-29 20:47:06,340 - INFO -  step: 550  loss: -2.0000  grad_norm:  0.3475  memory: 14.66GiB(30.86%)  tps: 7,003  tflops: 53.34  mfu: 17.09%
[rank2]:2025-10-29 20:47:06,339 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.5309e-01
[rank2]:2025-10-29 20:47:06,339 - INFO -  step: 550  loss: -2.0000  grad_norm:  0.3475  memory: 11.83GiB(24.89%)  tps: 7,002  tflops: 53.33  mfu: 17.09%
[rank3]:2025-10-29 20:47:17,792 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 7.3902e-01
[rank0]:2025-10-29 20:47:17,787 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 9.7027e-01
[rank1]:2025-10-29 20:47:17,780 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 3.7385e-01
[rank2]:2025-10-29 20:47:17,772 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 5.0477e-01
[rank3]:2025-10-29 20:47:29,632 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 2.5414e+00
[rank0]:2025-10-29 20:47:29,624 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.3024e+00
[rank2]:2025-10-29 20:47:29,612 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.1208e+00
[rank1]:2025-10-29 20:47:29,612 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.7838e+00
[rank0]:2025-10-29 20:47:40,968 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 8.5467e-01
[rank2]:2025-10-29 20:47:40,952 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 5.4342e-01
[rank1]:2025-10-29 20:47:40,961 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 3.7261e-01
[rank3]:2025-10-29 20:47:40,972 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 6.4862e-01
[rank0]:2025-10-29 20:47:52,786 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.7900e+00
[rank2]:2025-10-29 20:47:52,775 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 6.2589e-01
[rank1]:2025-10-29 20:47:52,775 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.2695e+00
[rank3]:2025-10-29 20:47:52,795 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 1.0889e+00
[rank0]:2025-10-29 20:48:02,982 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 20:48:04,145 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 7.1798e-01
[rank3]:2025-10-29 20:48:04,148 - INFO -  step: 600  loss:  0.2167  grad_norm:  0.3963  memory: 27.51GiB(57.90%)  tps: 7,089  tflops: 53.99  mfu: 17.30%
[rank3]:2025-10-29 20:48:04,148 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-10-29 20:48:04,140 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.2343e+00
[rank0]:2025-10-29 20:48:04,141 - INFO -  step: 600  loss: -2.0000  grad_norm:  0.3963  memory: 16.57GiB(34.88%)  tps: 7,088  tflops: 53.98  mfu: 17.30%
[rank0]:2025-10-29 20:48:04,141 - INFO - ðŸ”Ž  Running validation at step 600
[rank2]:2025-10-29 20:48:04,125 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 7.2514e-01
[rank2]:2025-10-29 20:48:04,125 - INFO -  step: 600  loss: -2.0000  grad_norm:  0.3963  memory: 11.83GiB(24.89%)  tps: 7,088  tflops: 53.99  mfu: 17.30%
[rank2]:2025-10-29 20:48:04,125 - INFO - ðŸ”Ž  Running validation at step 600
[rank1]:2025-10-29 20:48:04,133 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.1102e+00
[rank1]:2025-10-29 20:48:04,134 - INFO -  step: 600  loss: -2.0000  grad_norm:  0.3963  memory: 14.66GiB(30.86%)  tps: 7,087  tflops: 53.98  mfu: 17.30%
[rank1]:2025-10-29 20:48:04,134 - INFO - ðŸ”Ž  Running validation at step 600
[rank3]:2025-10-29 20:48:23,708 - INFO - validate step: 600  loss:  0.9370  memory: 27.51GiB(57.90%)  tps: 20,942
[rank0]:2025-10-29 20:48:23,683 - INFO - validate step: 600  loss: -1.0000  memory: 16.57GiB(34.88%)  tps: 20,960
[rank2]:2025-10-29 20:48:23,715 - INFO - validate step: 600  loss: -1.0000  memory: 11.83GiB(24.89%)  tps: 20,909
[rank1]:2025-10-29 20:48:23,698 - INFO - validate step: 600  loss: -1.0000  memory: 14.66GiB(30.86%)  tps: 20,936
[rank0]:2025-10-29 20:48:23,793 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_2048_stage0_step600.svg
[rank2]:2025-10-29 20:48:23,794 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_2048_stage2_step600.svg
[rank1]:2025-10-29 20:48:23,790 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_2048_stage1_step600.svg
[rank3]:2025-10-29 20:48:23,896 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/pipeline_schedule/251029_2048_real_step600_rank3.svg
[rank3]:> Batch Time: 493.47 ms, GPU Bubble Ratio: 59.54%, 54.86%, 66.41%, 15.46%
[rank3]:2025-10-29 20:48:23,965 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_2048_stage3_step600.svg
[rank3]:2025-10-29 20:48:24,476 - INFO - Avg. fwd time: 10.7630 / Avg. bwd time: 41.3786 / Avg. batch time: 477.5220 (ms) / GPU bubble ratio: 12.65%
[rank2]:2025-10-29 20:48:24,495 - INFO - Avg. fwd time: 7.6264 / Avg. bwd time: 13.2439 / Avg. batch time: 503.4226 (ms) / GPU bubble ratio: 66.83%
[rank1]:2025-10-29 20:48:24,516 - INFO - Avg. fwd time: 9.6310 / Avg. bwd time: 18.6626 / Avg. batch time: 536.5459 (ms) / GPU bubble ratio: 57.81%
[rank0]:2025-10-29 20:48:24,538 - INFO - Avg. fwd time: 8.7704 / Avg. bwd time: 17.7983 / Avg. batch time: 567.2295 (ms) / GPU bubble ratio: 62.53%
[rank0]:2025-10-29 20:48:35,735 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 5.1116e-01
[rank1]:2025-10-29 20:48:35,723 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 3.9184e-01
[rank2]:2025-10-29 20:48:35,723 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.3879e-01
[rank3]:2025-10-29 20:48:35,743 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 4.7510e-01
[rank3]:2025-10-29 20:48:47,132 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.1563e+00
[rank1]:2025-10-29 20:48:47,119 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.0179e+00
[rank0]:2025-10-29 20:48:47,126 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 7.5845e-01
[rank2]:2025-10-29 20:48:47,111 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 8.3244e-01
[rank3]:2025-10-29 20:48:58,957 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 9.5164e-01
[rank1]:2025-10-29 20:48:58,937 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 4.7214e-01
[rank2]:2025-10-29 20:48:58,937 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.8002e-01
[rank0]:2025-10-29 20:48:58,949 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 7.2739e-01
[rank3]:2025-10-29 20:49:10,337 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.3934e+00
[rank1]:2025-10-29 20:49:10,326 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.0111e+00
[rank2]:2025-10-29 20:49:10,318 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.2347e+00
[rank0]:2025-10-29 20:49:10,333 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.2324e+00
[rank0]:2025-10-29 20:49:20,968 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-29 20:49:22,177 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 1.6483e+00
[rank3]:2025-10-29 20:49:22,180 - INFO -  step: 650  loss:  0.3555  grad_norm:  0.3280  memory: 27.51GiB(57.90%)  tps: 7,005  tflops: 53.35  mfu: 17.10%
[rank1]:2025-10-29 20:49:22,158 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.8181e+00
[rank1]:2025-10-29 20:49:22,158 - INFO -  step: 650  loss: -2.0000  grad_norm:  0.3280  memory: 14.66GiB(30.86%)  tps: 7,007  tflops: 53.36  mfu: 17.10%
[rank2]:2025-10-29 20:49:22,157 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.1220e+00
[rank2]:2025-10-29 20:49:22,158 - INFO -  step: 650  loss: -2.0000  grad_norm:  0.3280  memory: 11.83GiB(24.89%)  tps: 7,009  tflops: 53.38  mfu: 17.11%
[rank0]:2025-10-29 20:49:22,169 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.8302e+00
[rank0]:2025-10-29 20:49:22,170 - INFO -  step: 650  loss: -2.0000  grad_norm:  0.3280  memory: 16.57GiB(34.88%)  tps: 7,003  tflops: 53.34  mfu: 17.10%
[rank3]:2025-10-29 20:49:33,517 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.7346e-01
[rank1]:2025-10-29 20:49:33,506 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 6.9487e-01
[rank2]:2025-10-29 20:49:33,498 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 7.5483e-01
[rank0]:2025-10-29 20:49:33,513 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 5.4998e-01
[rank1]:2025-10-29 20:49:45,319 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 5.3008e-01
[rank2]:2025-10-29 20:49:45,319 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.5718e-01
[rank0]:2025-10-29 20:49:45,330 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1966e+00
[rank3]:2025-10-29 20:49:45,339 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 9.8318e-01
[rank3]:2025-10-29 20:49:56,795 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 8.3079e-01
[rank1]:2025-10-29 20:49:56,783 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.4511e+00
[rank2]:2025-10-29 20:49:56,776 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.4622e-01
[rank0]:2025-10-29 20:49:56,791 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.0031e+00
[rank1]:2025-10-29 20:50:08,612 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 3.4770e-01
[rank3]:2025-10-29 20:50:08,636 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 5.4067e-01
[rank2]:2025-10-29 20:50:08,612 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.0124e-01
[rank0]:2025-10-29 20:50:08,624 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1357e+00
[rank0]:2025-10-29 20:50:18,794 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 20:50:19,930 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 5.1241e-01
[rank1]:2025-10-29 20:50:19,931 - INFO -  step: 700  loss: -2.0000  grad_norm:  0.3263  memory: 14.66GiB(30.86%)  tps: 7,090  tflops: 54.00  mfu: 17.31%
[rank3]:2025-10-29 20:50:19,942 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.8229e-01
[rank3]:2025-10-29 20:50:19,945 - INFO -  step: 700  loss:  0.2334  grad_norm:  0.3263  memory: 27.51GiB(57.90%)  tps: 7,091  tflops: 54.01  mfu: 17.31%
[rank2]:2025-10-29 20:50:19,922 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 8.8847e-01
[rank2]:2025-10-29 20:50:19,922 - INFO -  step: 700  loss: -2.0000  grad_norm:  0.3263  memory: 11.83GiB(24.89%)  tps: 7,091  tflops: 54.01  mfu: 17.31%
[rank0]:2025-10-29 20:50:19,937 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 7.5726e-01
[rank0]:2025-10-29 20:50:19,937 - INFO -  step: 700  loss: -2.0000  grad_norm:  0.3263  memory: 16.57GiB(34.88%)  tps: 7,090  tflops: 54.00  mfu: 17.31%
[rank1]:2025-10-29 20:50:20,024 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_2050_stage1_step700.svg
[rank2]:2025-10-29 20:50:20,031 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_2050_stage2_step700.svg
[rank0]:2025-10-29 20:50:20,026 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_2050_stage0_step700.svg
[rank3]:2025-10-29 20:50:20,146 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/pipeline_schedule/251029_2050_real_step700_rank3.svg
[rank3]:> Batch Time: 493.34 ms, GPU Bubble Ratio: 59.52%, 54.89%, 66.41%, 15.45%
[rank3]:2025-10-29 20:50:20,221 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_2050_stage3_step700.svg
[rank3]:2025-10-29 20:50:20,521 - INFO - Avg. fwd time: 10.7626 / Avg. bwd time: 41.3922 / Avg. batch time: 477.5286 (ms) / GPU bubble ratio: 12.63%
[rank2]:2025-10-29 20:50:20,547 - INFO - Avg. fwd time: 7.6509 / Avg. bwd time: 13.0808 / Avg. batch time: 503.1603 (ms) / GPU bubble ratio: 67.04%
[rank0]:2025-10-29 20:50:20,541 - INFO - Avg. fwd time: 8.7982 / Avg. bwd time: 17.5285 / Avg. batch time: 566.4303 (ms) / GPU bubble ratio: 62.82%
[rank1]:2025-10-29 20:50:20,602 - INFO - Avg. fwd time: 9.6645 / Avg. bwd time: 18.4185 / Avg. batch time: 536.0247 (ms) / GPU bubble ratio: 58.09%
[rank2]:2025-10-29 20:50:32,016 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.5111e-01
[rank1]:2025-10-29 20:50:32,016 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 2.8108e-01
[rank3]:2025-10-29 20:50:32,035 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 7.8836e-01
[rank0]:2025-10-29 20:50:32,027 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.7378e+00
[rank1]:2025-10-29 20:50:43,396 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 8.5169e-01
[rank2]:2025-10-29 20:50:43,388 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 3.2704e-01
[rank3]:2025-10-29 20:50:43,407 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 6.0630e-01
[rank0]:2025-10-29 20:50:43,403 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 8.1513e-01
[rank1]:2025-10-29 20:50:55,208 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.7953e+00
[rank3]:2025-10-29 20:50:55,228 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 1.8821e+00
[rank2]:2025-10-29 20:50:55,208 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.1707e+00
[rank0]:2025-10-29 20:50:55,220 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.4488e+00
[rank1]:2025-10-29 20:51:06,555 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.9459e+00
[rank2]:2025-10-29 20:51:06,547 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.0348e+00
[rank3]:2025-10-29 20:51:06,566 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 7.6651e-01
[rank0]:2025-10-29 20:51:06,562 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.6614e+00
[rank0]:2025-10-29 20:51:17,161 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 20:51:18,354 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.6597e+00
[rank1]:2025-10-29 20:51:18,354 - INFO -  step: 750  loss: -2.0000  grad_norm:  0.2593  memory: 14.66GiB(30.86%)  tps: 7,011  tflops: 53.40  mfu: 17.11%
[rank2]:2025-10-29 20:51:18,354 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 6.8053e-01
[rank2]:2025-10-29 20:51:18,354 - INFO -  step: 750  loss: -2.0000  grad_norm:  0.2593  memory: 11.83GiB(24.89%)  tps: 7,010  tflops: 53.39  mfu: 17.11%
[rank0]:2025-10-29 20:51:18,365 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.3324e+00
[rank0]:2025-10-29 20:51:18,366 - INFO -  step: 750  loss: -2.0000  grad_norm:  0.2593  memory: 16.57GiB(34.88%)  tps: 7,010  tflops: 53.39  mfu: 17.11%
[rank3]:2025-10-29 20:51:18,373 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 1.2150e+00
[rank3]:2025-10-29 20:51:18,377 - INFO -  step: 750  loss:  0.2242  grad_norm:  0.2593  memory: 27.51GiB(57.90%)  tps: 7,010  tflops: 53.39  mfu: 17.11%
[rank1]:2025-10-29 20:51:29,756 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 5.4073e-01
[rank2]:2025-10-29 20:51:29,748 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 6.6970e-01
[rank0]:2025-10-29 20:51:29,763 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 5.2784e-01
[rank3]:2025-10-29 20:51:29,780 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.6390e+00
[rank2]:2025-10-29 20:51:41,599 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.8228e-01
[rank3]:2025-10-29 20:51:41,619 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 7.4046e-01
[rank1]:2025-10-29 20:51:41,599 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 6.2050e-01
[rank0]:2025-10-29 20:51:41,610 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 6.1440e-01
[rank2]:2025-10-29 20:51:52,952 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.7268e+00
[rank3]:2025-10-29 20:51:52,975 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.8528e+00
[rank1]:2025-10-29 20:51:52,960 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 2.7265e+00
[rank0]:2025-10-29 20:51:52,967 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.5032e+00
[rank1]:2025-10-29 20:52:04,779 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 8.3142e-01
[rank3]:2025-10-29 20:52:04,798 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 3.7848e-01
[rank2]:2025-10-29 20:52:04,779 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.8517e-01
[rank0]:2025-10-29 20:52:04,790 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 4.6486e-01
[rank0]:2025-10-29 20:52:15,032 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 20:52:16,178 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.5520e+00
[rank1]:2025-10-29 20:52:16,178 - INFO -  step: 800  loss: -2.0000  grad_norm:  0.4020  memory: 14.66GiB(30.86%)  tps: 7,084  tflops: 53.95  mfu: 17.29%
[rank1]:2025-10-29 20:52:16,178 - INFO - ðŸ”Ž  Running validation at step 800
[rank3]:2025-10-29 20:52:16,189 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 9.4778e-01
[rank3]:2025-10-29 20:52:16,192 - INFO -  step: 800  loss:  0.2596  grad_norm:  0.4020  memory: 27.51GiB(57.90%)  tps: 7,085  tflops: 53.96  mfu: 17.29%
[rank3]:2025-10-29 20:52:16,193 - INFO - ðŸ”Ž  Running validation at step 800
[rank2]:2025-10-29 20:52:16,171 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.2071e+00
[rank2]:2025-10-29 20:52:16,171 - INFO -  step: 800  loss: -2.0000  grad_norm:  0.4020  memory: 11.83GiB(24.89%)  tps: 7,084  tflops: 53.96  mfu: 17.29%
[rank2]:2025-10-29 20:52:16,171 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-10-29 20:52:16,185 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.8326e+00
[rank0]:2025-10-29 20:52:16,186 - INFO -  step: 800  loss: -2.0000  grad_norm:  0.4020  memory: 16.57GiB(34.88%)  tps: 7,084  tflops: 53.95  mfu: 17.29%
[rank0]:2025-10-29 20:52:16,186 - INFO - ðŸ”Ž  Running validation at step 800
[rank1]:2025-10-29 20:52:35,814 - INFO - validate step: 800  loss: -1.0000  memory: 14.66GiB(30.86%)  tps: 20,861
[rank1]:2025-10-29 20:52:35,815 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-29 20:52:35,824 - INFO - validate step: 800  loss:  0.9369  memory: 27.51GiB(57.90%)  tps: 20,866
[rank3]:2025-10-29 20:52:35,825 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-29 20:52:35,832 - INFO - validate step: 800  loss: -1.0000  memory: 11.83GiB(24.89%)  tps: 20,833
[rank2]:2025-10-29 20:52:35,833 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-29 20:52:35,796 - INFO - validate step: 800  loss: -1.0000  memory: 16.57GiB(34.88%)  tps: 20,887
[rank0]:2025-10-29 20:52:35,797 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-29 20:52:35,803 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank2]:2025-10-29 20:52:37,701 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 1.87 seconds.
[rank1]:2025-10-29 20:52:38,287 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 2.47 seconds.
[rank3]:2025-10-29 20:52:39,196 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.37 seconds.
[rank0]:2025-10-29 20:52:39,661 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-29 20:52:39,670 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.87 seconds.
[rank2]:2025-10-29 20:52:39,762 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_2052_stage2_step800.svg
[rank1]:2025-10-29 20:52:39,760 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_2052_stage1_step800.svg
[rank0]:2025-10-29 20:52:39,950 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_2052_stage0_step800.svg
[rank3]:2025-10-29 20:52:40,014 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/pipeline_schedule/251029_2052_real_step800_rank3.svg
[rank3]:> Batch Time: 492.97 ms, GPU Bubble Ratio: 59.49%, 54.87%, 66.40%, 15.45%
[rank3]:2025-10-29 20:52:40,089 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_2052_stage3_step800.svg
[rank3]:2025-10-29 20:52:41,048 - INFO - Avg. fwd time: 10.7650 / Avg. bwd time: 41.3703 / Avg. batch time: 477.2782 (ms) / GPU bubble ratio: 12.61%
[rank0]:2025-10-29 20:52:41,072 - INFO - Avg. fwd time: 8.8199 / Avg. bwd time: 17.2907 / Avg. batch time: 565.5584 (ms) / GPU bubble ratio: 63.07%
[rank1]:2025-10-29 20:52:41,132 - INFO - Avg. fwd time: 9.6896 / Avg. bwd time: 18.2300 / Avg. batch time: 535.4027 (ms) / GPU bubble ratio: 58.28%
[rank2]:2025-10-29 20:52:41,078 - INFO - Avg. fwd time: 7.6759 / Avg. bwd time: 12.9121 / Avg. batch time: 502.7447 (ms) / GPU bubble ratio: 67.24%
[rank1]:2025-10-29 20:52:52,560 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 4.6928e-01
[rank2]:2025-10-29 20:52:52,561 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 7.9420e-01
[rank3]:2025-10-29 20:52:52,580 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 8.9135e-01
[rank0]:2025-10-29 20:52:52,572 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.0476e+00
[rank3]:2025-10-29 20:52:53,090 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-29 20:52:53,130 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-29 20:52:53,107 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-29 20:52:53,150 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-29 20:53:03,961 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.1905e+00
[rank2]:2025-10-29 20:53:03,952 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 7.0944e-01
[rank3]:2025-10-29 20:53:03,972 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 7.3226e-01
[rank0]:2025-10-29 20:53:03,968 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 9.3566e-01
[rank2]:2025-10-29 20:53:15,714 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.6948e-01
[rank0]:2025-10-29 20:53:15,726 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 5.4391e-01
[rank1]:2025-10-29 20:53:15,714 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 4.6880e-01
[rank3]:2025-10-29 20:53:15,734 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 8.7871e-01
[rank1]:2025-10-29 20:53:27,117 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.4560e+00
[rank3]:2025-10-29 20:53:27,129 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.7089e-01
[rank2]:2025-10-29 20:53:27,109 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 3.6349e-01
[rank0]:2025-10-29 20:53:27,125 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 6.6612e-01
[rank0]:2025-10-29 20:53:38,006 - INFO - [GC] Peforming periodical GC collection 0.26 seconds
[rank1]:2025-10-29 20:53:39,181 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 5.2629e-01
[rank1]:2025-10-29 20:53:39,181 - INFO -  step: 850  loss: -2.0000  grad_norm:  0.3251  memory: 14.66GiB(30.86%)  tps: 6,464  tflops: 49.23  mfu: 15.78%
[rank2]:2025-10-29 20:53:39,181 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.2413e-01
[rank2]:2025-10-29 20:53:39,181 - INFO -  step: 850  loss: -2.0000  grad_norm:  0.3251  memory: 11.83GiB(24.89%)  tps: 6,466  tflops: 49.25  mfu: 15.78%
[rank3]:2025-10-29 20:53:39,200 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 9.5646e-01
[rank3]:2025-10-29 20:53:39,203 - INFO -  step: 850  loss:  0.2054  grad_norm:  0.3251  memory: 27.51GiB(57.90%)  tps: 6,463  tflops: 49.22  mfu: 15.78%
[rank0]:2025-10-29 20:53:39,192 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.0143e+00
[rank0]:2025-10-29 20:53:39,193 - INFO -  step: 850  loss: -2.0000  grad_norm:  0.3251  memory: 16.57GiB(34.88%)  tps: 6,461  tflops: 49.21  mfu: 15.77%
[rank1]:2025-10-29 20:53:50,548 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 4.2463e-01
[rank2]:2025-10-29 20:53:50,540 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.4994e+00
[rank3]:2025-10-29 20:53:50,562 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.4427e+00
[rank0]:2025-10-29 20:53:50,555 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.3850e+00
[rank1]:2025-10-29 20:54:02,361 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.2500e+00
[rank2]:2025-10-29 20:54:02,361 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.2058e-01
[rank3]:2025-10-29 20:54:02,381 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 9.3149e-01
[rank0]:2025-10-29 20:54:02,373 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.4177e+00
[rank1]:2025-10-29 20:54:13,720 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 3.4578e-01
[rank2]:2025-10-29 20:54:13,713 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 4.8044e-01
[rank3]:2025-10-29 20:54:13,732 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.0144e+00
[rank0]:2025-10-29 20:54:13,727 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 4.6976e-01
[rank1]:2025-10-29 20:54:25,563 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.4030e+00
[rank3]:2025-10-29 20:54:25,583 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 2.2208e+00
[rank2]:2025-10-29 20:54:25,563 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 9.5121e-01
[rank0]:2025-10-29 20:54:25,574 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.4866e+00
[rank0]:2025-10-29 20:54:35,777 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 20:54:36,925 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.1323e+00
[rank3]:2025-10-29 20:54:36,928 - INFO -  step: 900  loss:  0.2213  grad_norm:  0.2844  memory: 27.51GiB(57.90%)  tps: 7,096  tflops: 54.04  mfu: 17.32%
[rank2]:2025-10-29 20:54:36,906 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.1862e+00
[rank2]:2025-10-29 20:54:36,906 - INFO -  step: 900  loss: -2.0000  grad_norm:  0.2844  memory: 11.83GiB(24.89%)  tps: 7,096  tflops: 54.04  mfu: 17.32%
[rank0]:2025-10-29 20:54:36,921 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.9264e+00
[rank0]:2025-10-29 20:54:36,921 - INFO -  step: 900  loss: -2.0000  grad_norm:  0.2844  memory: 16.57GiB(34.88%)  tps: 7,095  tflops: 54.04  mfu: 17.32%
[rank1]:2025-10-29 20:54:36,913 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.7678e+00
[rank1]:2025-10-29 20:54:36,914 - INFO -  step: 900  loss: -2.0000  grad_norm:  0.2844  memory: 14.66GiB(30.86%)  tps: 7,095  tflops: 54.04  mfu: 17.32%
[rank1]:2025-10-29 20:54:37,003 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_2054_stage1_step900.svg
[rank2]:2025-10-29 20:54:37,007 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_2054_stage2_step900.svg
[rank0]:2025-10-29 20:54:37,005 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_2054_stage0_step900.svg
[rank3]:2025-10-29 20:54:37,115 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/pipeline_schedule/251029_2054_real_step900_rank3.svg
[rank3]:> Batch Time: 492.80 ms, GPU Bubble Ratio: 59.47%, 54.87%, 66.38%, 15.45%
[rank3]:2025-10-29 20:54:37,183 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_2054_stage3_step900.svg
[rank3]:2025-10-29 20:54:37,689 - INFO - Avg. fwd time: 10.7656 / Avg. bwd time: 41.3539 / Avg. batch time: 477.4536 (ms) / GPU bubble ratio: 12.67%
[rank2]:2025-10-29 20:54:37,709 - INFO - Avg. fwd time: 7.6948 / Avg. bwd time: 12.7843 / Avg. batch time: 502.8319 (ms) / GPU bubble ratio: 67.42%
[rank1]:2025-10-29 20:54:37,731 - INFO - Avg. fwd time: 9.7101 / Avg. bwd time: 18.0855 / Avg. batch time: 535.3388 (ms) / GPU bubble ratio: 58.46%
[rank0]:2025-10-29 20:54:37,752 - INFO - Avg. fwd time: 8.8400 / Avg. bwd time: 17.1092 / Avg. batch time: 565.3251 (ms) / GPU bubble ratio: 63.28%
[rank1]:2025-10-29 20:54:48,973 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 3.0296e-01
[rank3]:2025-10-29 20:54:48,994 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 3.8367e-01
[rank2]:2025-10-29 20:54:48,974 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 9.9109e-02
[rank0]:2025-10-29 20:54:48,985 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1501e+00
[rank1]:2025-10-29 20:55:00,410 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 2.9457e+00
[rank2]:2025-10-29 20:55:00,402 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 3.2513e+00
[rank3]:2025-10-29 20:55:00,422 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.6612e+00
[rank0]:2025-10-29 20:55:00,417 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.3904e+00
[rank1]:2025-10-29 20:55:12,253 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 2.2213e+00
[rank3]:2025-10-29 20:55:12,273 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 1.8586e+00
[rank2]:2025-10-29 20:55:12,252 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.0690e+00
[rank0]:2025-10-29 20:55:12,264 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.6650e+00
[rank3]:2025-10-29 20:55:23,698 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.7732e+00
[rank2]:2025-10-29 20:55:23,676 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.1587e+00
[rank0]:2025-10-29 20:55:23,691 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.2006e+00
[rank1]:2025-10-29 20:55:23,683 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 2.6213e+00
[rank0]:2025-10-29 20:55:34,285 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-29 20:55:35,473 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 2.1252e+00
[rank1]:2025-10-29 20:55:35,473 - INFO -  step: 950  loss: -2.0000  grad_norm:  0.2680  memory: 14.66GiB(30.86%)  tps: 6,995  tflops: 53.27  mfu: 17.07%
[rank3]:2025-10-29 20:55:35,494 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 1.6960e+00
[rank3]:2025-10-29 20:55:35,498 - INFO -  step: 950  loss:  0.1904  grad_norm:  0.2680  memory: 27.51GiB(57.90%)  tps: 6,994  tflops: 53.27  mfu: 17.07%
[rank0]:2025-10-29 20:55:35,484 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.1114e+00
[rank0]:2025-10-29 20:55:35,485 - INFO -  step: 950  loss: -2.0000  grad_norm:  0.2680  memory: 16.57GiB(34.88%)  tps: 6,994  tflops: 53.27  mfu: 17.07%
[rank2]:2025-10-29 20:55:35,473 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 8.4559e-01
[rank2]:2025-10-29 20:55:35,473 - INFO -  step: 950  loss: -2.0000  grad_norm:  0.2680  memory: 11.83GiB(24.89%)  tps: 6,994  tflops: 53.27  mfu: 17.07%
[rank1]:2025-10-29 20:55:46,869 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 2.1221e+00
[rank3]:2025-10-29 20:55:46,881 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.7341e+00
[rank0]:2025-10-29 20:55:46,877 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.5275e+00
[rank2]:2025-10-29 20:55:46,861 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.6044e+00
[rank1]:2025-10-29 20:55:58,710 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.5641e+00
[rank3]:2025-10-29 20:55:58,730 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 1.0533e+00
[rank0]:2025-10-29 20:55:58,721 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 8.3872e-01
[rank2]:2025-10-29 20:55:58,710 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.2434e-01
[rank1]:2025-10-29 20:56:10,018 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 6.2259e-01
[rank3]:2025-10-29 20:56:10,030 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.7917e+00
[rank0]:2025-10-29 20:56:10,024 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.4088e+00
[rank2]:2025-10-29 20:56:10,009 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.0271e+00
[rank1]:2025-10-29 20:56:21,818 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 9.0761e-01
[rank3]:2025-10-29 20:56:21,838 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 4.6181e-01
[rank0]:2025-10-29 20:56:21,829 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 5.4839e-01
[rank2]:2025-10-29 20:56:21,818 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 8.4932e-02
[rank0]:2025-10-29 20:56:32,125 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 20:56:33,256 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 6.3405e-01
[rank1]:2025-10-29 20:56:33,257 - INFO -  step: 1000  loss: -2.0000  grad_norm:  0.4008  memory: 14.66GiB(30.86%)  tps: 7,089  tflops: 53.99  mfu: 17.30%
[rank1]:2025-10-29 20:56:33,257 - INFO - ðŸ”Ž  Running validation at step 1000
[rank3]:2025-10-29 20:56:33,268 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.5946e+00
[rank3]:2025-10-29 20:56:33,272 - INFO -  step: 1000  loss:  0.2699  grad_norm:  0.4008  memory: 27.51GiB(57.90%)  tps: 7,090  tflops: 54.00  mfu: 17.31%
[rank3]:2025-10-29 20:56:33,272 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-10-29 20:56:33,264 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 5.4427e-01
[rank0]:2025-10-29 20:56:33,264 - INFO -  step: 1000  loss: -2.0000  grad_norm:  0.4008  memory: 16.57GiB(34.88%)  tps: 7,089  tflops: 53.99  mfu: 17.31%
[rank0]:2025-10-29 20:56:33,264 - INFO - ðŸ”Ž  Running validation at step 1000
[rank2]:2025-10-29 20:56:33,249 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.8005e+00
[rank2]:2025-10-29 20:56:33,249 - INFO -  step: 1000  loss: -2.0000  grad_norm:  0.4008  memory: 11.83GiB(24.89%)  tps: 7,090  tflops: 54.00  mfu: 17.31%
[rank2]:2025-10-29 20:56:33,249 - INFO - ðŸ”Ž  Running validation at step 1000
[rank1]:2025-10-29 20:56:53,659 - INFO - validate step: 1000  loss: -1.0000  memory: 14.66GiB(30.86%)  tps: 20,076
[rank3]:2025-10-29 20:56:53,670 - INFO - validate step: 1000  loss:  0.9517  memory: 27.51GiB(57.90%)  tps: 20,082
[rank0]:2025-10-29 20:56:53,644 - INFO - validate step: 1000  loss: -1.0000  memory: 16.57GiB(34.88%)  tps: 20,099
[rank2]:2025-10-29 20:56:53,679 - INFO - validate step: 1000  loss: -1.0000  memory: 11.83GiB(24.89%)  tps: 20,049
[rank1]:2025-10-29 20:56:53,755 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_2056_stage1_step1000.svg
[rank0]:2025-10-29 20:56:53,757 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_2056_stage0_step1000.svg
[rank2]:2025-10-29 20:56:53,761 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_2056_stage2_step1000.svg
[rank3]:2025-10-29 20:56:53,870 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/pipeline_schedule/251029_2056_real_step1000_rank3.svg
[rank3]:> Batch Time: 492.84 ms, GPU Bubble Ratio: 59.47%, 54.88%, 66.39%, 15.44%
[rank3]:2025-10-29 20:56:53,940 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_2056_stage3_step1000.svg
[rank3]:2025-10-29 20:56:54,252 - INFO - Avg. fwd time: 10.7654 / Avg. bwd time: 41.3672 / Avg. batch time: 477.4742 (ms) / GPU bubble ratio: 12.65%
[rank0]:2025-10-29 20:56:54,272 - INFO - Avg. fwd time: 8.8532 / Avg. bwd time: 16.9842 / Avg. batch time: 564.9518 (ms) / GPU bubble ratio: 63.41%
[rank2]:2025-10-29 20:56:54,281 - INFO - Avg. fwd time: 7.7059 / Avg. bwd time: 12.7126 / Avg. batch time: 502.7116 (ms) / GPU bubble ratio: 67.51%
[rank1]:2025-10-29 20:56:54,338 - INFO - Avg. fwd time: 9.7263 / Avg. bwd time: 17.9693 / Avg. batch time: 535.0957 (ms) / GPU bubble ratio: 58.59%
[rank2]:2025-10-29 20:57:05,718 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.3031e-01
[rank3]:2025-10-29 20:57:05,737 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 2.9188e-01
[rank1]:2025-10-29 20:57:05,718 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 6.1393e-01
[rank0]:2025-10-29 20:57:05,729 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.6457e+00
[rank2]:2025-10-29 20:57:17,131 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.0766e+00
[rank3]:2025-10-29 20:57:17,157 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.5452e+00
[rank1]:2025-10-29 20:57:17,140 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 2.3371e+00
[rank0]:2025-10-29 20:57:17,147 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.7993e+00
[rank3]:2025-10-29 20:57:29,011 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 4.0242e-01
[rank1]:2025-10-29 20:57:28,987 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 2.6369e-01
[rank0]:2025-10-29 20:57:28,998 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 6.4553e-01
[rank2]:2025-10-29 20:57:28,987 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.8937e-01
[rank3]:2025-10-29 20:57:40,439 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.9693e+00
[rank1]:2025-10-29 20:57:40,427 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 2.3527e+00
[rank0]:2025-10-29 20:57:40,434 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.8934e+00
[rank2]:2025-10-29 20:57:40,418 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.3912e+00
[rank0]:2025-10-29 20:57:51,117 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-29 20:57:52,330 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 3.2694e+00
[rank3]:2025-10-29 20:57:52,333 - INFO -  step: 1050  loss:  0.2980  grad_norm:  0.3432  memory: 27.51GiB(57.90%)  tps: 6,982  tflops: 53.18  mfu: 17.04%
[rank1]:2025-10-29 20:57:52,310 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 2.8167e+00
[rank1]:2025-10-29 20:57:52,310 - INFO -  step: 1050  loss: -2.0000  grad_norm:  0.3432  memory: 14.66GiB(30.86%)  tps: 6,984  tflops: 53.19  mfu: 17.05%
[rank0]:2025-10-29 20:57:52,321 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 4.8612e+00
[rank0]:2025-10-29 20:57:52,322 - INFO -  step: 1050  loss: -2.0000  grad_norm:  0.3432  memory: 16.57GiB(34.88%)  tps: 6,981  tflops: 53.17  mfu: 17.04%
[rank2]:2025-10-29 20:57:52,310 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.0550e+00
[rank2]:2025-10-29 20:57:52,310 - INFO -  step: 1050  loss: -2.0000  grad_norm:  0.3432  memory: 11.83GiB(24.89%)  tps: 6,986  tflops: 53.21  mfu: 17.05%
[rank3]:2025-10-29 20:58:03,739 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 3.2659e+00
[rank1]:2025-10-29 20:58:03,727 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 2.0440e+00
[rank0]:2025-10-29 20:58:03,734 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.8908e+00
[rank2]:2025-10-29 20:58:03,719 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 3.0885e+00
[rank1]:2025-10-29 20:58:15,491 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 8.6512e-01
[rank0]:2025-10-29 20:58:15,503 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.7585e+00
[rank2]:2025-10-29 20:58:15,491 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 8.3898e-01
[rank3]:2025-10-29 20:58:15,511 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 1.2245e+00
[rank1]:2025-10-29 20:58:26,874 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 8.2486e-01
[rank3]:2025-10-29 20:58:26,885 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 9.4626e-01
[rank0]:2025-10-29 20:58:26,881 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.8691e+00
[rank2]:2025-10-29 20:58:26,866 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.2724e+00
[rank1]:2025-10-29 20:58:38,710 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 3.3829e+00
[rank0]:2025-10-29 20:58:38,722 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 4.2202e+00
[rank2]:2025-10-29 20:58:38,710 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.6964e+00
[rank3]:2025-10-29 20:58:38,733 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 3.2467e+00
[rank0]:2025-10-29 20:58:48,979 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 20:58:50,113 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.1004e+00
[rank1]:2025-10-29 20:58:50,113 - INFO -  step: 1100  loss: -2.0000  grad_norm:  0.3385  memory: 14.66GiB(30.86%)  tps: 7,086  tflops: 53.97  mfu: 17.30%
[rank3]:2025-10-29 20:58:50,124 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 6.7920e-01
[rank3]:2025-10-29 20:58:50,127 - INFO -  step: 1100  loss:  0.3202  grad_norm:  0.3385  memory: 27.51GiB(57.90%)  tps: 7,087  tflops: 53.98  mfu: 17.30%
[rank0]:2025-10-29 20:58:50,120 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 9.7741e-01
[rank0]:2025-10-29 20:58:50,120 - INFO -  step: 1100  loss: -2.0000  grad_norm:  0.3385  memory: 16.57GiB(34.88%)  tps: 7,087  tflops: 53.97  mfu: 17.30%
[rank2]:2025-10-29 20:58:50,105 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 8.7963e-01
[rank2]:2025-10-29 20:58:50,105 - INFO -  step: 1100  loss: -2.0000  grad_norm:  0.3385  memory: 11.83GiB(24.89%)  tps: 7,087  tflops: 53.98  mfu: 17.30%
[rank1]:2025-10-29 20:58:50,205 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_2058_stage1_step1100.svg
[rank0]:2025-10-29 20:58:50,207 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_2058_stage0_step1100.svg
[rank2]:2025-10-29 20:58:50,209 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_2058_stage2_step1100.svg
[rank3]:2025-10-29 20:58:50,367 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/pipeline_schedule/251029_2058_real_step1100_rank3.svg
[rank3]:> Batch Time: 492.70 ms, GPU Bubble Ratio: 59.46%, 54.86%, 66.38%, 15.44%
[rank3]:2025-10-29 20:58:50,438 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_2058_stage3_step1100.svg
[rank0]:2025-10-29 20:58:50,764 - INFO - Avg. fwd time: 8.8679 / Avg. bwd time: 16.8640 / Avg. batch time: 564.5733 (ms) / GPU bubble ratio: 63.54%
[rank2]:2025-10-29 20:58:50,770 - INFO - Avg. fwd time: 7.7192 / Avg. bwd time: 12.6257 / Avg. batch time: 502.5560 (ms) / GPU bubble ratio: 67.61%
[rank1]:2025-10-29 20:58:50,822 - INFO - Avg. fwd time: 9.7387 / Avg. bwd time: 17.8766 / Avg. batch time: 534.8368 (ms) / GPU bubble ratio: 58.69%
[rank3]:2025-10-29 20:58:50,742 - INFO - Avg. fwd time: 10.7680 / Avg. bwd time: 41.3662 / Avg. batch time: 477.4056 (ms) / GPU bubble ratio: 12.64%
[rank3]:2025-10-29 20:59:02,213 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 5.4412e-01
[rank1]:2025-10-29 20:59:02,194 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 6.9409e-01
[rank0]:2025-10-29 20:59:02,205 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 5.3399e-01
[rank2]:2025-10-29 20:59:02,194 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.0591e-01
[rank3]:2025-10-29 20:59:13,620 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.2843e+00
[rank1]:2025-10-29 20:59:13,608 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.4489e+00
[rank2]:2025-10-29 20:59:13,600 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.5712e+00
[rank0]:2025-10-29 20:59:13,616 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.4589e+00
[rank2]:2025-10-29 20:59:25,489 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.0025e-01
[rank0]:2025-10-29 20:59:25,501 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 5.2194e-01
[rank1]:2025-10-29 20:59:25,490 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.1030e+00
[rank3]:2025-10-29 20:59:25,509 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 4.3730e-01
[rank1]:2025-10-29 20:59:36,840 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.7713e-01
[rank3]:2025-10-29 20:59:36,851 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 7.0515e-01
[rank2]:2025-10-29 20:59:36,832 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 6.2536e-01
[rank0]:2025-10-29 20:59:36,847 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.2733e-01
[rank0]:2025-10-29 20:59:47,441 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 20:59:48,623 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.0713e+00
[rank2]:2025-10-29 20:59:48,623 - INFO -  step: 1150  loss: -2.0000  grad_norm:  0.2789  memory: 11.83GiB(24.89%)  tps: 7,000  tflops: 53.31  mfu: 17.09%
[rank0]:2025-10-29 20:59:48,634 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.4931e+00
[rank0]:2025-10-29 20:59:48,635 - INFO -  step: 1150  loss: -2.0000  grad_norm:  0.2789  memory: 16.57GiB(34.88%)  tps: 7,000  tflops: 53.31  mfu: 17.09%
[rank1]:2025-10-29 20:59:48,623 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.8780e+00
[rank1]:2025-10-29 20:59:48,623 - INFO -  step: 1150  loss: -2.0000  grad_norm:  0.2789  memory: 14.66GiB(30.86%)  tps: 7,001  tflops: 53.32  mfu: 17.09%
[rank3]:2025-10-29 20:59:48,643 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 2.2248e+00
[rank3]:2025-10-29 20:59:48,646 - INFO -  step: 1150  loss:  0.2354  grad_norm:  0.2789  memory: 27.51GiB(57.90%)  tps: 7,000  tflops: 53.31  mfu: 17.09%
[rank0]:2025-10-29 21:00:00,044 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.0770e+00
[rank2]:2025-10-29 21:00:00,029 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 6.9778e-01
[rank1]:2025-10-29 21:00:00,037 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 2.5165e-01
[rank3]:2025-10-29 21:00:00,049 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.9506e-01
[rank1]:2025-10-29 21:00:11,885 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 2.7303e-01
[rank3]:2025-10-29 21:00:11,905 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 4.5689e-01
[rank0]:2025-10-29 21:00:11,896 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.9376e+00
[rank2]:2025-10-29 21:00:11,885 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.8251e-01
[rank1]:2025-10-29 21:00:23,326 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 2.7763e+00
[rank3]:2025-10-29 21:00:23,338 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.7890e+00
[rank2]:2025-10-29 21:00:23,319 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 3.1194e+00
[rank0]:2025-10-29 21:00:23,334 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.5971e+00
[rank1]:2025-10-29 21:00:35,156 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 2.8057e+00
[rank2]:2025-10-29 21:00:35,156 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.5050e+00
[rank0]:2025-10-29 21:00:35,167 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.0358e+00
[rank3]:2025-10-29 21:00:35,180 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 2.7038e+00
[rank0]:2025-10-29 21:00:45,382 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 21:00:46,512 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 3.2029e-01
[rank2]:2025-10-29 21:00:46,512 - INFO -  step: 1200  loss: -2.0000  grad_norm:  0.3884  memory: 11.83GiB(24.89%)  tps: 7,076  tflops: 53.89  mfu: 17.27%
[rank2]:2025-10-29 21:00:46,512 - INFO - ðŸ”Ž  Running validation at step 1200
[rank1]:2025-10-29 21:00:46,519 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 8.4601e-01
[rank1]:2025-10-29 21:00:46,520 - INFO -  step: 1200  loss: -2.0000  grad_norm:  0.3884  memory: 14.66GiB(30.86%)  tps: 7,075  tflops: 53.88  mfu: 17.27%
[rank1]:2025-10-29 21:00:46,520 - INFO - ðŸ”Ž  Running validation at step 1200
[rank3]:2025-10-29 21:00:46,531 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 8.9848e-01
[rank3]:2025-10-29 21:00:46,534 - INFO -  step: 1200  loss:  0.1785  grad_norm:  0.3884  memory: 27.51GiB(57.90%)  tps: 7,076  tflops: 53.89  mfu: 17.27%
[rank3]:2025-10-29 21:00:46,535 - INFO - ðŸ”Ž  Running validation at step 1200
[rank0]:2025-10-29 21:00:46,527 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.4021e+00
[rank0]:2025-10-29 21:00:46,527 - INFO -  step: 1200  loss: -2.0000  grad_norm:  0.3884  memory: 16.57GiB(34.88%)  tps: 7,075  tflops: 53.89  mfu: 17.27%
[rank0]:2025-10-29 21:00:46,527 - INFO - ðŸ”Ž  Running validation at step 1200
[rank1]:2025-10-29 21:01:06,857 - INFO - validate step: 1200  loss: -1.0000  memory: 14.66GiB(30.86%)  tps: 20,141
[rank3]:2025-10-29 21:01:06,867 - INFO - validate step: 1200  loss:  0.9521  memory: 27.51GiB(57.90%)  tps: 20,147
[rank0]:2025-10-29 21:01:06,841 - INFO - validate step: 1200  loss: -1.0000  memory: 16.57GiB(34.88%)  tps: 20,164
[rank2]:2025-10-29 21:01:06,873 - INFO - validate step: 1200  loss: -1.0000  memory: 11.83GiB(24.89%)  tps: 20,117
[rank1]:2025-10-29 21:01:06,953 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_2101_stage1_step1200.svg
[rank0]:2025-10-29 21:01:06,955 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_2101_stage0_step1200.svg
[rank2]:2025-10-29 21:01:06,955 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_2101_stage2_step1200.svg
[rank3]:2025-10-29 21:01:07,060 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/pipeline_schedule/251029_2101_real_step1200_rank3.svg
[rank3]:> Batch Time: 492.70 ms, GPU Bubble Ratio: 59.45%, 54.88%, 66.38%, 15.43%
[rank3]:2025-10-29 21:01:07,131 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_2101_stage3_step1200.svg
[rank1]:2025-10-29 21:01:07,700 - INFO - Avg. fwd time: 9.7483 / Avg. bwd time: 17.7971 / Avg. batch time: 534.6932 (ms) / GPU bubble ratio: 58.79%
[rank3]:2025-10-29 21:01:07,657 - INFO - Avg. fwd time: 10.7695 / Avg. bwd time: 41.3644 / Avg. batch time: 477.3361 (ms) / GPU bubble ratio: 12.63%
[rank0]:2025-10-29 21:01:07,722 - INFO - Avg. fwd time: 8.8782 / Avg. bwd time: 16.7642 / Avg. batch time: 564.3266 (ms) / GPU bubble ratio: 63.65%
[rank2]:2025-10-29 21:01:07,677 - INFO - Avg. fwd time: 7.7299 / Avg. bwd time: 12.5548 / Avg. batch time: 502.4986 (ms) / GPU bubble ratio: 67.71%
[rank1]:2025-10-29 21:01:19,004 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.1286e+00
[rank3]:2025-10-29 21:01:19,024 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 9.9675e-01
[rank0]:2025-10-29 21:01:19,016 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.0291e+00
[rank2]:2025-10-29 21:01:19,004 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 6.1106e-01
[rank1]:2025-10-29 21:01:30,405 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.5153e+00
[rank3]:2025-10-29 21:01:30,416 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 8.0963e-01
[rank0]:2025-10-29 21:01:30,412 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1468e+00
[rank2]:2025-10-29 21:01:30,397 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 3.5496e-01
[rank2]:2025-10-29 21:01:42,283 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.0233e-01
[rank1]:2025-10-29 21:01:42,283 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.6765e+00
[rank3]:2025-10-29 21:01:42,303 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 2.4686e-01
[rank0]:2025-10-29 21:01:42,295 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1699e+00
[rank2]:2025-10-29 21:01:53,692 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.2888e+00
[rank1]:2025-10-29 21:01:53,700 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.8092e+00
[rank3]:2025-10-29 21:01:53,711 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 9.6755e-01
[rank0]:2025-10-29 21:01:53,707 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.5247e+00
[rank0]:2025-10-29 21:02:04,438 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-29 21:02:05,631 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 3.6505e+00
[rank1]:2025-10-29 21:02:05,632 - INFO -  step: 1250  loss: -2.0000  grad_norm:  0.3451  memory: 14.66GiB(30.86%)  tps: 6,969  tflops: 53.08  mfu: 17.01%
[rank3]:2025-10-29 21:02:05,651 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 2.6813e+00
[rank3]:2025-10-29 21:02:05,654 - INFO -  step: 1250  loss:  0.2899  grad_norm:  0.3451  memory: 27.51GiB(57.90%)  tps: 6,968  tflops: 53.07  mfu: 17.01%
[rank2]:2025-10-29 21:02:05,631 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.6693e+00
[rank2]:2025-10-29 21:02:05,632 - INFO -  step: 1250  loss: -2.0000  grad_norm:  0.3451  memory: 11.83GiB(24.89%)  tps: 6,971  tflops: 53.09  mfu: 17.02%
[rank0]:2025-10-29 21:02:05,643 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 4.3490e+00
[rank0]:2025-10-29 21:02:05,643 - INFO -  step: 1250  loss: -2.0000  grad_norm:  0.3451  memory: 16.57GiB(34.88%)  tps: 6,966  tflops: 53.05  mfu: 17.00%
[rank2]:2025-10-29 21:02:16,997 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.1121e+00
[rank0]:2025-10-29 21:02:17,013 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 8.3675e-01
[rank1]:2025-10-29 21:02:17,006 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 6.5045e-01
[rank3]:2025-10-29 21:02:17,017 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.1492e+00
[rank2]:2025-10-29 21:02:28,837 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 8.5083e-01
[rank1]:2025-10-29 21:02:28,836 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.2748e+00
[rank3]:2025-10-29 21:02:28,856 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 1.3446e+00
[rank0]:2025-10-29 21:02:28,848 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.6223e+00
[rank1]:2025-10-29 21:02:40,203 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.2877e+00
[rank3]:2025-10-29 21:02:40,215 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 7.3092e-01
[rank2]:2025-10-29 21:02:40,195 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.0992e+00
[rank0]:2025-10-29 21:02:40,210 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.9459e+00
[rank1]:2025-10-29 21:02:52,029 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 7.9753e-01
[rank3]:2025-10-29 21:02:52,051 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 2.6281e-01
[rank2]:2025-10-29 21:02:52,029 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.0380e-01
[rank0]:2025-10-29 21:02:52,041 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1800e+00
[rank0]:2025-10-29 21:03:02,284 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 21:03:03,436 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 2.0989e+00
[rank1]:2025-10-29 21:03:03,437 - INFO -  step: 1300  loss: -2.0000  grad_norm:  0.3288  memory: 14.66GiB(30.86%)  tps: 7,086  tflops: 53.97  mfu: 17.30%
[rank3]:2025-10-29 21:03:03,448 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.6592e+00
[rank3]:2025-10-29 21:03:03,451 - INFO -  step: 1300  loss:  0.2562  grad_norm:  0.3288  memory: 27.51GiB(57.90%)  tps: 7,087  tflops: 53.98  mfu: 17.30%
[rank2]:2025-10-29 21:03:03,428 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.6940e+00
[rank2]:2025-10-29 21:03:03,429 - INFO -  step: 1300  loss: -2.0000  grad_norm:  0.3288  memory: 11.83GiB(24.89%)  tps: 7,087  tflops: 53.98  mfu: 17.30%
[rank0]:2025-10-29 21:03:03,444 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.9909e+00
[rank0]:2025-10-29 21:03:03,444 - INFO -  step: 1300  loss: -2.0000  grad_norm:  0.3288  memory: 16.57GiB(34.88%)  tps: 7,086  tflops: 53.97  mfu: 17.30%
[rank1]:2025-10-29 21:03:03,530 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_2103_stage1_step1300.svg
[rank2]:2025-10-29 21:03:03,534 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_2103_stage2_step1300.svg
[rank0]:2025-10-29 21:03:03,531 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_2103_stage0_step1300.svg
[rank3]:2025-10-29 21:03:03,635 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/pipeline_schedule/251029_2103_real_step1300_rank3.svg
[rank3]:> Batch Time: 492.84 ms, GPU Bubble Ratio: 59.46%, 54.89%, 66.39%, 15.42%
[rank3]:2025-10-29 21:03:03,708 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_2103_stage3_step1300.svg
[rank3]:2025-10-29 21:03:04,022 - INFO - Avg. fwd time: 10.7696 / Avg. bwd time: 41.3851 / Avg. batch time: 477.4526 (ms) / GPU bubble ratio: 12.61%
[rank2]:2025-10-29 21:03:04,052 - INFO - Avg. fwd time: 7.7356 / Avg. bwd time: 12.5156 / Avg. batch time: 502.5201 (ms) / GPU bubble ratio: 67.76%
[rank0]:2025-10-29 21:03:04,040 - INFO - Avg. fwd time: 8.8848 / Avg. bwd time: 16.6915 / Avg. batch time: 564.1918 (ms) / GPU bubble ratio: 63.73%
[rank1]:2025-10-29 21:03:04,109 - INFO - Avg. fwd time: 9.7573 / Avg. bwd time: 17.7267 / Avg. batch time: 534.6359 (ms) / GPU bubble ratio: 58.87%
[rank1]:2025-10-29 21:03:15,443 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 2.7503e+00
[rank3]:2025-10-29 21:03:15,462 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 2.5484e+00
[rank2]:2025-10-29 21:03:15,443 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.2850e+00
[rank0]:2025-10-29 21:03:15,454 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.5775e+00
[rank1]:2025-10-29 21:03:26,850 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.5592e+00
[rank3]:2025-10-29 21:03:26,861 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.1065e+00
[rank2]:2025-10-29 21:03:26,842 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.2219e+00
[rank0]:2025-10-29 21:03:26,857 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.0558e+00
[rank1]:2025-10-29 21:03:38,677 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 2.6552e-01
[rank3]:2025-10-29 21:03:38,697 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 5.6122e-01
[rank2]:2025-10-29 21:03:38,677 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.8499e-01
[rank0]:2025-10-29 21:03:38,688 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 5.3641e-01
[rank1]:2025-10-29 21:03:50,099 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.8804e+00
[rank3]:2025-10-29 21:03:50,111 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 7.1771e-01
[rank2]:2025-10-29 21:03:50,091 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 8.5818e-01
[rank0]:2025-10-29 21:03:50,107 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.2018e+00
[rank0]:2025-10-29 21:04:00,778 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 21:04:01,971 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 8.5836e-01
[rank1]:2025-10-29 21:04:01,971 - INFO -  step: 1350  loss: -2.0000  grad_norm:  0.2856  memory: 14.66GiB(30.86%)  tps: 6,998  tflops: 53.30  mfu: 17.08%
[rank3]:2025-10-29 21:04:01,991 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 2.7676e-01
[rank3]:2025-10-29 21:04:01,994 - INFO -  step: 1350  loss:  0.2530  grad_norm:  0.2856  memory: 27.51GiB(57.90%)  tps: 6,997  tflops: 53.29  mfu: 17.08%
[rank2]:2025-10-29 21:04:01,971 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.3060e-01
[rank2]:2025-10-29 21:04:01,971 - INFO -  step: 1350  loss: -2.0000  grad_norm:  0.2856  memory: 11.83GiB(24.89%)  tps: 6,997  tflops: 53.29  mfu: 17.08%
[rank0]:2025-10-29 21:04:01,982 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.0861e+00
[rank0]:2025-10-29 21:04:01,983 - INFO -  step: 1350  loss: -2.0000  grad_norm:  0.2856  memory: 16.57GiB(34.88%)  tps: 6,997  tflops: 53.29  mfu: 17.08%
[rank1]:2025-10-29 21:04:13,336 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.5644e+00
[rank3]:2025-10-29 21:04:13,348 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.3368e+00
[rank2]:2025-10-29 21:04:13,328 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.4713e+00
[rank0]:2025-10-29 21:04:13,343 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.0977e+00
[rank0]:2025-10-29 21:04:25,179 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.6764e+00
[rank2]:2025-10-29 21:04:25,167 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 7.9923e-01
[rank1]:2025-10-29 21:04:25,167 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 4.9367e-01
[rank3]:2025-10-29 21:04:25,187 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 1.2377e+00
[rank0]:2025-10-29 21:04:36,494 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 8.1355e-01
[rank2]:2025-10-29 21:04:36,479 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 5.3785e-01
[rank1]:2025-10-29 21:04:36,487 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.4253e+00
[rank3]:2025-10-29 21:04:36,499 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.7739e-01
[rank1]:2025-10-29 21:04:48,280 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.3244e+00
[rank0]:2025-10-29 21:04:48,292 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 7.1208e-01
[rank3]:2025-10-29 21:04:48,300 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 1.4331e+00
[rank2]:2025-10-29 21:04:48,280 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.4103e-01
[rank0]:2025-10-29 21:04:58,528 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 21:04:59,680 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 2.4241e-01
[rank1]:2025-10-29 21:04:59,681 - INFO -  step: 1400  loss: -2.0000  grad_norm:  0.4142  memory: 14.66GiB(30.86%)  tps: 7,098  tflops: 54.06  mfu: 17.33%
[rank1]:2025-10-29 21:04:59,681 - INFO - ðŸ”Ž  Running validation at step 1400
[rank0]:2025-10-29 21:04:59,688 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.2375e+00
[rank0]:2025-10-29 21:04:59,688 - INFO -  step: 1400  loss: -2.0000  grad_norm:  0.4142  memory: 16.57GiB(34.88%)  tps: 7,098  tflops: 54.06  mfu: 17.33%
[rank0]:2025-10-29 21:04:59,688 - INFO - ðŸ”Ž  Running validation at step 1400
[rank3]:2025-10-29 21:04:59,696 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.1490e+00
[rank3]:2025-10-29 21:04:59,699 - INFO -  step: 1400  loss:  0.2215  grad_norm:  0.4142  memory: 27.51GiB(57.90%)  tps: 7,098  tflops: 54.06  mfu: 17.33%
[rank3]:2025-10-29 21:04:59,699 - INFO - ðŸ”Ž  Running validation at step 1400
[rank2]:2025-10-29 21:04:59,672 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 6.3298e-01
[rank2]:2025-10-29 21:04:59,673 - INFO -  step: 1400  loss: -2.0000  grad_norm:  0.4142  memory: 11.83GiB(24.89%)  tps: 7,099  tflops: 54.06  mfu: 17.33%
[rank2]:2025-10-29 21:04:59,673 - INFO - ðŸ”Ž  Running validation at step 1400
[rank1]:2025-10-29 21:05:20,168 - INFO - validate step: 1400  loss: -1.0000  memory: 14.66GiB(30.86%)  tps: 19,994
[rank0]:2025-10-29 21:05:20,151 - INFO - validate step: 1400  loss: -1.0000  memory: 16.57GiB(34.88%)  tps: 20,017
[rank3]:2025-10-29 21:05:20,178 - INFO - validate step: 1400  loss:  0.9550  memory: 27.51GiB(57.90%)  tps: 20,003
[rank2]:2025-10-29 21:05:20,185 - INFO - validate step: 1400  loss: -1.0000  memory: 11.83GiB(24.89%)  tps: 19,969
[rank1]:2025-10-29 21:05:20,267 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_2105_stage1_step1400.svg
[rank0]:2025-10-29 21:05:20,269 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_2105_stage0_step1400.svg
[rank2]:2025-10-29 21:05:20,271 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_2105_stage2_step1400.svg
[rank3]:2025-10-29 21:05:20,370 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/pipeline_schedule/251029_2105_real_step1400_rank3.svg
[rank3]:> Batch Time: 492.69 ms, GPU Bubble Ratio: 59.45%, 54.89%, 66.38%, 15.42%
[rank3]:2025-10-29 21:05:20,444 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_2105_stage3_step1400.svg
[rank0]:2025-10-29 21:05:20,777 - INFO - Avg. fwd time: 8.8914 / Avg. bwd time: 16.6188 / Avg. batch time: 563.8929 (ms) / GPU bubble ratio: 63.81%
[rank3]:2025-10-29 21:05:20,757 - INFO - Avg. fwd time: 10.7712 / Avg. bwd time: 41.3773 / Avg. batch time: 477.3544 (ms) / GPU bubble ratio: 12.60%
[rank2]:2025-10-29 21:05:20,786 - INFO - Avg. fwd time: 7.7438 / Avg. bwd time: 12.4622 / Avg. batch time: 502.3646 (ms) / GPU bubble ratio: 67.82%
[rank1]:2025-10-29 21:05:20,843 - INFO - Avg. fwd time: 9.7636 / Avg. bwd time: 17.6702 / Avg. batch time: 534.4143 (ms) / GPU bubble ratio: 58.93%
[rank1]:2025-10-29 21:05:32,183 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 2.6416e-01
[rank0]:2025-10-29 21:05:32,194 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 9.0162e-01
[rank3]:2025-10-29 21:05:32,203 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 4.3530e-01
[rank2]:2025-10-29 21:05:32,183 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 6.3002e-02
[rank3]:2025-10-29 21:05:43,576 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 7.2281e-01
[rank2]:2025-10-29 21:05:43,551 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 7.9385e-01
[rank1]:2025-10-29 21:05:43,559 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.4456e+00
[rank0]:2025-10-29 21:05:43,567 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1586e+00
[rank2]:2025-10-29 21:05:55,379 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.3932e-01
[rank1]:2025-10-29 21:05:55,379 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 4.3845e-01
[rank0]:2025-10-29 21:05:55,391 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 7.2953e-01
[rank3]:2025-10-29 21:05:55,404 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 4.6562e-01
[rank1]:2025-10-29 21:06:06,841 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 8.6231e-01
[rank0]:2025-10-29 21:06:06,849 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 6.8213e-01
[rank3]:2025-10-29 21:06:06,853 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.8196e+00
[rank2]:2025-10-29 21:06:06,833 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.6177e+00
[rank0]:2025-10-29 21:06:17,469 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-29 21:06:18,639 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 2.4506e+00
[rank1]:2025-10-29 21:06:18,640 - INFO -  step: 1450  loss: -2.0000  grad_norm:  0.3346  memory: 14.66GiB(30.86%)  tps: 7,005  tflops: 53.35  mfu: 17.10%
[rank0]:2025-10-29 21:06:18,651 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.4758e+00
[rank0]:2025-10-29 21:06:18,651 - INFO -  step: 1450  loss: -2.0000  grad_norm:  0.3346  memory: 16.57GiB(34.88%)  tps: 7,002  tflops: 53.33  mfu: 17.09%
[rank2]:2025-10-29 21:06:18,639 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 9.8170e-01
[rank2]:2025-10-29 21:06:18,639 - INFO -  step: 1450  loss: -2.0000  grad_norm:  0.3346  memory: 11.83GiB(24.89%)  tps: 7,007  tflops: 53.37  mfu: 17.11%
[rank3]:2025-10-29 21:06:18,659 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 1.8180e+00
[rank3]:2025-10-29 21:06:18,662 - INFO -  step: 1450  loss:  0.2303  grad_norm:  0.3346  memory: 27.51GiB(57.90%)  tps: 7,004  tflops: 53.34  mfu: 17.10%
[rank1]:2025-10-29 21:06:29,991 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 3.6720e+00
[rank0]:2025-10-29 21:06:29,999 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.5440e+00
[rank3]:2025-10-29 21:06:30,003 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.1193e+00
[rank2]:2025-10-29 21:06:29,983 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.9253e+00
[rank2]:2025-10-29 21:06:41,839 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 9.4534e-01
[rank0]:2025-10-29 21:06:41,851 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.4378e+00
[rank1]:2025-10-29 21:06:41,840 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.7819e+00
[rank3]:2025-10-29 21:06:41,862 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 1.4900e+00
[rank1]:2025-10-29 21:06:53,228 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.3573e+00
[rank0]:2025-10-29 21:06:53,236 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1233e+00
[rank3]:2025-10-29 21:06:53,242 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.2670e+00
[rank2]:2025-10-29 21:06:53,221 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.4137e+00
[rank2]:2025-10-29 21:07:05,087 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.1881e+00
[rank0]:2025-10-29 21:07:05,099 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 5.9646e+00
[rank1]:2025-10-29 21:07:05,087 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 3.4109e+00
[rank3]:2025-10-29 21:07:05,111 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 3.3148e+00
[rank0]:2025-10-29 21:07:15,329 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 21:07:16,490 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 4.8529e-01
[rank3]:2025-10-29 21:07:16,493 - INFO -  step: 1500  loss:  0.2653  grad_norm:  0.3174  memory: 27.51GiB(57.90%)  tps: 7,083  tflops: 53.94  mfu: 17.29%
[rank2]:2025-10-29 21:07:16,470 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 7.9401e-01
[rank2]:2025-10-29 21:07:16,471 - INFO -  step: 1500  loss: -2.0000  grad_norm:  0.3174  memory: 11.83GiB(24.89%)  tps: 7,083  tflops: 53.94  mfu: 17.29%
[rank0]:2025-10-29 21:07:16,486 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.6226e+00
[rank0]:2025-10-29 21:07:16,486 - INFO -  step: 1500  loss: -2.0000  grad_norm:  0.3174  memory: 16.57GiB(34.88%)  tps: 7,082  tflops: 53.94  mfu: 17.29%
[rank1]:2025-10-29 21:07:16,478 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 2.3961e-01
[rank1]:2025-10-29 21:07:16,479 - INFO -  step: 1500  loss: -2.0000  grad_norm:  0.3174  memory: 14.66GiB(30.86%)  tps: 7,082  tflops: 53.94  mfu: 17.29%
[rank1]:2025-10-29 21:07:16,577 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_2107_stage1_step1500.svg
[rank2]:2025-10-29 21:07:16,581 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_2107_stage2_step1500.svg
[rank0]:2025-10-29 21:07:16,580 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_2107_stage0_step1500.svg
[rank3]:2025-10-29 21:07:16,686 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/pipeline_schedule/251029_2107_real_step1500_rank3.svg
[rank3]:> Batch Time: 492.70 ms, GPU Bubble Ratio: 59.45%, 54.89%, 66.38%, 15.42%
[rank3]:2025-10-29 21:07:16,766 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_2107_stage3_step1500.svg
[rank3]:2025-10-29 21:07:17,264 - INFO - Avg. fwd time: 10.7727 / Avg. bwd time: 41.3694 / Avg. batch time: 477.2603 (ms) / GPU bubble ratio: 12.60%
[rank2]:2025-10-29 21:07:17,285 - INFO - Avg. fwd time: 7.7506 / Avg. bwd time: 12.4173 / Avg. batch time: 502.2752 (ms) / GPU bubble ratio: 67.88%
[rank0]:2025-10-29 21:07:17,331 - INFO - Avg. fwd time: 8.8978 / Avg. bwd time: 16.5563 / Avg. batch time: 563.6870 (ms) / GPU bubble ratio: 63.87%
[rank1]:2025-10-29 21:07:17,308 - INFO - Avg. fwd time: 9.7696 / Avg. bwd time: 17.6220 / Avg. batch time: 534.2723 (ms) / GPU bubble ratio: 58.98%
[rank0]:2025-10-29 21:07:28,573 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 7.2778e-01
[rank1]:2025-10-29 21:07:28,561 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.1031e+00
[rank3]:2025-10-29 21:07:28,581 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 9.4532e-01
[rank2]:2025-10-29 21:07:28,561 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.6164e-01
[rank0]:2025-10-29 21:07:39,982 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.0629e+00
[rank1]:2025-10-29 21:07:39,974 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.6864e+00
[rank3]:2025-10-29 21:07:39,986 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.3949e+00
[rank2]:2025-10-29 21:07:39,967 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.4129e+00
[rank0]:2025-10-29 21:07:51,810 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.3821e+00
[rank1]:2025-10-29 21:07:51,799 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.9239e+00
[rank3]:2025-10-29 21:07:51,818 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 1.7510e+00
[rank2]:2025-10-29 21:07:51,799 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 9.0344e-01
[rank0]:2025-10-29 21:08:03,210 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.2140e+00
[rank1]:2025-10-29 21:08:03,202 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.4871e+00
[rank3]:2025-10-29 21:08:03,214 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 8.4131e-01
[rank2]:2025-10-29 21:08:03,195 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 7.6246e-01
[rank0]:2025-10-29 21:08:13,873 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 21:08:15,056 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.5654e-01
[rank2]:2025-10-29 21:08:15,056 - INFO -  step: 1550  loss: -2.0000  grad_norm:  0.2690  memory: 11.83GiB(24.89%)  tps: 6,992  tflops: 53.25  mfu: 17.07%
[rank1]:2025-10-29 21:08:15,055 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.1296e+00
[rank1]:2025-10-29 21:08:15,056 - INFO -  step: 1550  loss: -2.0000  grad_norm:  0.2690  memory: 14.66GiB(30.86%)  tps: 6,993  tflops: 53.26  mfu: 17.07%
[rank0]:2025-10-29 21:08:15,067 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.3958e+00
[rank0]:2025-10-29 21:08:15,068 - INFO -  step: 1550  loss: -2.0000  grad_norm:  0.2690  memory: 16.57GiB(34.88%)  tps: 6,992  tflops: 53.25  mfu: 17.07%
[rank3]:2025-10-29 21:08:15,080 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 1.0451e+00
[rank3]:2025-10-29 21:08:15,083 - INFO -  step: 1550  loss:  0.2209  grad_norm:  0.2690  memory: 27.51GiB(57.90%)  tps: 6,991  tflops: 53.25  mfu: 17.07%
[rank1]:2025-10-29 21:08:26,440 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 7.1979e-01
[rank0]:2025-10-29 21:08:26,448 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 7.6708e-01
[rank3]:2025-10-29 21:08:26,452 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 3.9219e-01
[rank2]:2025-10-29 21:08:26,432 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 3.3269e-01
[rank2]:2025-10-29 21:08:38,321 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 6.2068e-01
[rank1]:2025-10-29 21:08:38,322 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 5.0988e-01
[rank0]:2025-10-29 21:08:38,333 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.9249e+00
[rank3]:2025-10-29 21:08:38,341 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 5.4169e-01
[rank2]:2025-10-29 21:08:49,698 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 7.9280e-01
[rank1]:2025-10-29 21:08:49,706 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 2.5726e-01
[rank0]:2025-10-29 21:08:49,714 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 8.7751e-01
[rank3]:2025-10-29 21:08:49,720 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.2344e-01
[rank2]:2025-10-29 21:09:01,534 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.3582e-01
[rank1]:2025-10-29 21:09:01,534 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 5.4020e-01
[rank0]:2025-10-29 21:09:01,545 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1837e+00
[rank3]:2025-10-29 21:09:01,560 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 4.2034e-01
[rank0]:2025-10-29 21:09:11,758 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 21:09:12,932 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 8.4891e-01
[rank3]:2025-10-29 21:09:12,944 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.0838e+00
[rank3]:2025-10-29 21:09:12,948 - INFO -  step: 1600  loss:  0.1867  grad_norm:  0.4260  memory: 27.51GiB(57.90%)  tps: 7,079  tflops: 53.91  mfu: 17.28%
[rank3]:2025-10-29 21:09:12,948 - INFO - ðŸ”Ž  Running validation at step 1600
[rank2]:2025-10-29 21:09:12,924 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 7.6891e-01
[rank2]:2025-10-29 21:09:12,925 - INFO -  step: 1600  loss: -2.0000  grad_norm:  0.4260  memory: 11.83GiB(24.89%)  tps: 7,078  tflops: 53.91  mfu: 17.28%
[rank2]:2025-10-29 21:09:12,925 - INFO - ðŸ”Ž  Running validation at step 1600
[rank0]:2025-10-29 21:09:12,940 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1611e+00
[rank0]:2025-10-29 21:09:12,940 - INFO -  step: 1600  loss: -2.0000  grad_norm:  0.4260  memory: 16.57GiB(34.88%)  tps: 7,078  tflops: 53.91  mfu: 17.28%
[rank0]:2025-10-29 21:09:12,940 - INFO - ðŸ”Ž  Running validation at step 1600
[rank1]:2025-10-29 21:09:12,932 - INFO -  step: 1600  loss: -2.0000  grad_norm:  0.4260  memory: 14.66GiB(30.86%)  tps: 7,077  tflops: 53.90  mfu: 17.28%
[rank1]:2025-10-29 21:09:12,933 - INFO - ðŸ”Ž  Running validation at step 1600
[rank1]:2025-10-29 21:09:32,486 - INFO - validate step: 1600  loss: -1.0000  memory: 14.66GiB(30.86%)  tps: 20,948
[rank1]:2025-10-29 21:09:32,486 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-29 21:09:32,469 - INFO - validate step: 1600  loss: -1.0000  memory: 16.57GiB(34.88%)  tps: 20,974
[rank0]:2025-10-29 21:09:32,470 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-29 21:09:32,479 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank3]:2025-10-29 21:09:32,495 - INFO - validate step: 1600  loss:  0.9549  memory: 27.51GiB(57.90%)  tps: 20,956
[rank3]:2025-10-29 21:09:32,496 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-29 21:09:32,502 - INFO - validate step: 1600  loss: -1.0000  memory: 11.83GiB(24.89%)  tps: 20,922
[rank2]:2025-10-29 21:09:32,503 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-29 21:09:34,284 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 1.78 seconds.
[rank1]:2025-10-29 21:09:34,817 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 2.33 seconds.
[rank3]:2025-10-29 21:09:36,023 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.53 seconds.
[rank0]:2025-10-29 21:09:36,145 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-29 21:09:36,152 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.68 seconds.
[rank1]:2025-10-29 21:09:36,247 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_2109_stage1_step1600.svg
[rank2]:2025-10-29 21:09:36,249 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_2109_stage2_step1600.svg
[rank0]:2025-10-29 21:09:36,416 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_2109_stage0_step1600.svg
[rank3]:2025-10-29 21:09:36,549 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/pipeline_schedule/251029_2109_real_step1600_rank3.svg
[rank3]:> Batch Time: 492.73 ms, GPU Bubble Ratio: 59.46%, 54.90%, 66.38%, 15.41%
[rank3]:2025-10-29 21:09:36,653 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_2109_stage3_step1600.svg
[rank3]:2025-10-29 21:09:36,971 - INFO - Avg. fwd time: 10.7723 / Avg. bwd time: 41.3836 / Avg. batch time: 477.3384 (ms) / GPU bubble ratio: 12.59%
[rank2]:2025-10-29 21:09:36,995 - INFO - Avg. fwd time: 7.7540 / Avg. bwd time: 12.3934 / Avg. batch time: 502.2848 (ms) / GPU bubble ratio: 67.91%
[rank1]:2025-10-29 21:09:37,059 - INFO - Avg. fwd time: 9.7754 / Avg. bwd time: 17.5746 / Avg. batch time: 534.2275 (ms) / GPU bubble ratio: 59.04%
[rank0]:2025-10-29 21:09:36,992 - INFO - Avg. fwd time: 8.9025 / Avg. bwd time: 16.5094 / Avg. batch time: 563.5923 (ms) / GPU bubble ratio: 63.93%
[rank1]:2025-10-29 21:09:48,435 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.2548e+00
[rank0]:2025-10-29 21:09:48,447 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.0752e+00
[rank3]:2025-10-29 21:09:48,456 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 1.1244e+00
[rank2]:2025-10-29 21:09:48,435 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.5734e-01
[rank1]:2025-10-29 21:09:59,743 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.9893e+00
[rank0]:2025-10-29 21:09:59,750 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.7153e+00
[rank3]:2025-10-29 21:09:59,756 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.3006e+00
[rank2]:2025-10-29 21:09:59,734 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.1398e+00
[rank3]:2025-10-29 21:10:01,291 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-29 21:10:01,486 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-29 21:10:01,502 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-29 21:10:01,521 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-29 21:10:11,516 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.6410e-01
[rank0]:2025-10-29 21:10:11,528 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.0819e+00
[rank1]:2025-10-29 21:10:11,516 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.2591e+00
[rank3]:2025-10-29 21:10:11,536 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 6.6453e-01
[rank2]:2025-10-29 21:10:22,925 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 5.9209e-01
[rank0]:2025-10-29 21:10:22,940 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1632e+00
[rank1]:2025-10-29 21:10:22,933 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 4.0074e-01
[rank3]:2025-10-29 21:10:22,944 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 6.2623e-01
[rank0]:2025-10-29 21:10:33,816 - INFO - [GC] Peforming periodical GC collection 0.25 seconds
[rank0]:2025-10-29 21:10:35,023 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 4.8672e-01
[rank0]:2025-10-29 21:10:35,024 - INFO -  step: 1650  loss: -2.0000  grad_norm:  0.3245  memory: 16.57GiB(34.88%)  tps: 6,548  tflops: 49.87  mfu: 15.98%
[rank1]:2025-10-29 21:10:35,012 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 4.7208e-01
[rank1]:2025-10-29 21:10:35,012 - INFO -  step: 1650  loss: -2.0000  grad_norm:  0.3245  memory: 14.66GiB(30.86%)  tps: 6,551  tflops: 49.89  mfu: 15.99%
[rank3]:2025-10-29 21:10:35,031 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 6.6488e-01
[rank3]:2025-10-29 21:10:35,034 - INFO -  step: 1650  loss:  0.2750  grad_norm:  0.3245  memory: 27.51GiB(57.90%)  tps: 6,550  tflops: 49.88  mfu: 15.99%
[rank2]:2025-10-29 21:10:35,011 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.8009e-01
[rank2]:2025-10-29 21:10:35,012 - INFO -  step: 1650  loss: -2.0000  grad_norm:  0.3245  memory: 11.83GiB(24.89%)  tps: 6,553  tflops: 49.91  mfu: 16.00%
[rank1]:2025-10-29 21:10:46,400 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 2.1255e+00
[rank0]:2025-10-29 21:10:46,408 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.6939e+00
[rank3]:2025-10-29 21:10:46,412 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 6.2054e-01
[rank2]:2025-10-29 21:10:46,392 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 4.1569e-01
[rank2]:2025-10-29 21:10:58,292 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.3721e-01
[rank1]:2025-10-29 21:10:58,292 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.0378e+00
[rank0]:2025-10-29 21:10:58,303 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1291e+00
[rank3]:2025-10-29 21:10:58,311 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 5.7073e-01
[rank1]:2025-10-29 21:11:09,780 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.8311e+00
[rank0]:2025-10-29 21:11:09,787 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.8304e+00
[rank3]:2025-10-29 21:11:09,791 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.2583e+00
[rank2]:2025-10-29 21:11:09,772 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.3471e+00
[rank1]:2025-10-29 21:11:21,645 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 3.8547e-01
[rank0]:2025-10-29 21:11:21,656 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 5.4807e-01
[rank3]:2025-10-29 21:11:21,664 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 2.6741e-01
[rank2]:2025-10-29 21:11:21,644 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.2240e-01
[rank0]:2025-10-29 21:11:31,914 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 21:11:33,048 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 3.7348e+00
[rank2]:2025-10-29 21:11:33,049 - INFO -  step: 1700  loss: -2.0000  grad_norm:  0.3447  memory: 11.83GiB(24.89%)  tps: 7,058  tflops: 53.75  mfu: 17.23%
[rank1]:2025-10-29 21:11:33,056 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 4.7092e+00
[rank1]:2025-10-29 21:11:33,056 - INFO -  step: 1700  loss: -2.0000  grad_norm:  0.3447  memory: 14.66GiB(30.86%)  tps: 7,057  tflops: 53.75  mfu: 17.23%
[rank0]:2025-10-29 21:11:33,063 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.7453e+00
[rank0]:2025-10-29 21:11:33,064 - INFO -  step: 1700  loss: -2.0000  grad_norm:  0.3447  memory: 16.57GiB(34.88%)  tps: 7,057  tflops: 53.75  mfu: 17.23%
[rank3]:2025-10-29 21:11:33,068 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 3.1217e+00
[rank3]:2025-10-29 21:11:33,071 - INFO -  step: 1700  loss:  0.2375  grad_norm:  0.3447  memory: 27.51GiB(57.90%)  tps: 7,058  tflops: 53.75  mfu: 17.23%
[rank1]:2025-10-29 21:11:33,156 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_2111_stage1_step1700.svg
[rank0]:2025-10-29 21:11:33,158 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_2111_stage0_step1700.svg
[rank2]:2025-10-29 21:11:33,162 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_2111_stage2_step1700.svg
[rank3]:2025-10-29 21:11:33,266 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/pipeline_schedule/251029_2111_real_step1700_rank3.svg
[rank3]:> Batch Time: 492.71 ms, GPU Bubble Ratio: 59.45%, 54.90%, 66.38%, 15.41%
[rank3]:2025-10-29 21:11:33,343 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_2111_stage3_step1700.svg
[rank0]:2025-10-29 21:11:33,671 - INFO - Avg. fwd time: 8.9085 / Avg. bwd time: 16.4606 / Avg. batch time: 563.4360 (ms) / GPU bubble ratio: 63.98%
[rank3]:2025-10-29 21:11:33,650 - INFO - Avg. fwd time: 10.7729 / Avg. bwd time: 41.3813 / Avg. batch time: 477.3001 (ms) / GPU bubble ratio: 12.58%
[rank2]:2025-10-29 21:11:33,676 - INFO - Avg. fwd time: 7.7593 / Avg. bwd time: 12.3569 / Avg. batch time: 502.2112 (ms) / GPU bubble ratio: 67.96%
[rank1]:2025-10-29 21:11:33,731 - INFO - Avg. fwd time: 9.7795 / Avg. bwd time: 17.5379 / Avg. batch time: 534.1130 (ms) / GPU bubble ratio: 59.08%
[rank2]:2025-10-29 21:11:45,153 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.2437e+00
[rank1]:2025-10-29 21:11:45,153 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 2.4441e+00
[rank0]:2025-10-29 21:11:45,165 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.1743e+00
[rank3]:2025-10-29 21:11:45,173 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 2.1301e+00
[rank2]:2025-10-29 21:11:56,646 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.3466e+00
[rank1]:2025-10-29 21:11:56,653 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 4.3098e-01
[rank0]:2025-10-29 21:11:56,661 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.0464e+00
[rank3]:2025-10-29 21:11:56,665 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.3026e+00
[rank1]:2025-10-29 21:12:08,556 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 3.7938e-01
[rank3]:2025-10-29 21:12:08,576 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 2.4780e-01
[rank2]:2025-10-29 21:12:08,557 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.1843e-01
[rank0]:2025-10-29 21:12:08,568 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 8.4022e-01
[rank2]:2025-10-29 21:12:19,994 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 4.5545e-01
[rank1]:2025-10-29 21:12:20,002 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 4.0710e-01
[rank0]:2025-10-29 21:12:20,010 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.2776e+00
[rank3]:2025-10-29 21:12:20,014 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 7.8537e-01
[rank0]:2025-10-29 21:12:30,711 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-29 21:12:31,898 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.4349e-01
[rank2]:2025-10-29 21:12:31,898 - INFO -  step: 1750  loss: -2.0000  grad_norm:  0.2847  memory: 11.83GiB(24.89%)  tps: 6,960  tflops: 53.01  mfu: 16.99%
[rank1]:2025-10-29 21:12:31,898 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 4.4720e-01
[rank1]:2025-10-29 21:12:31,898 - INFO -  step: 1750  loss: -2.0000  grad_norm:  0.2847  memory: 14.66GiB(30.86%)  tps: 6,961  tflops: 53.02  mfu: 16.99%
[rank0]:2025-10-29 21:12:31,909 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 9.8833e-01
[rank0]:2025-10-29 21:12:31,910 - INFO -  step: 1750  loss: -2.0000  grad_norm:  0.2847  memory: 16.57GiB(34.88%)  tps: 6,961  tflops: 53.01  mfu: 16.99%
[rank3]:2025-10-29 21:12:31,917 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 3.8583e-01
[rank3]:2025-10-29 21:12:31,921 - INFO -  step: 1750  loss:  0.1962  grad_norm:  0.2847  memory: 27.51GiB(57.90%)  tps: 6,960  tflops: 53.01  mfu: 16.99%
[rank1]:2025-10-29 21:12:43,375 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 3.0504e+00
[rank0]:2025-10-29 21:12:43,382 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.2931e+00
[rank3]:2025-10-29 21:12:43,386 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.9504e+00
[rank2]:2025-10-29 21:12:43,367 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.2607e+00
[rank1]:2025-10-29 21:12:55,267 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 2.2149e+00
[rank0]:2025-10-29 21:12:55,278 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.5559e+00
[rank3]:2025-10-29 21:12:55,286 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 1.4265e+00
[rank2]:2025-10-29 21:12:55,267 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 7.5259e-01
[rank1]:2025-10-29 21:13:06,706 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 2.3406e-01
[rank0]:2025-10-29 21:13:06,713 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 4.6274e-01
[rank3]:2025-10-29 21:13:06,718 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 9.6818e-01
[rank2]:2025-10-29 21:13:06,698 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 5.3917e-01
[rank1]:2025-10-29 21:13:18,603 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 6.7027e-01
[rank0]:2025-10-29 21:13:18,615 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 7.9353e-01
[rank3]:2025-10-29 21:13:18,623 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 5.4116e-01
[rank2]:2025-10-29 21:13:18,603 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.2825e-01
[rank0]:2025-10-29 21:13:28,883 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 21:13:30,040 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 3.2257e-01
[rank1]:2025-10-29 21:13:30,041 - INFO -  step: 1800  loss: -2.0000  grad_norm:  0.3993  memory: 14.66GiB(30.86%)  tps: 7,045  tflops: 53.65  mfu: 17.20%
[rank1]:2025-10-29 21:13:30,041 - INFO - ðŸ”Ž  Running validation at step 1800
[rank0]:2025-10-29 21:13:30,048 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 4.3459e-01
[rank0]:2025-10-29 21:13:30,048 - INFO -  step: 1800  loss: -2.0000  grad_norm:  0.3993  memory: 16.57GiB(34.88%)  tps: 7,045  tflops: 53.66  mfu: 17.20%
[rank0]:2025-10-29 21:13:30,048 - INFO - ðŸ”Ž  Running validation at step 1800
[rank3]:2025-10-29 21:13:30,052 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.1054e+00
[rank3]:2025-10-29 21:13:30,056 - INFO -  step: 1800  loss:  0.1765  grad_norm:  0.3993  memory: 27.51GiB(57.90%)  tps: 7,046  tflops: 53.66  mfu: 17.20%
[rank3]:2025-10-29 21:13:30,057 - INFO - ðŸ”Ž  Running validation at step 1800
[rank2]:2025-10-29 21:13:30,033 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 3.4204e-01
[rank2]:2025-10-29 21:13:30,033 - INFO -  step: 1800  loss: -2.0000  grad_norm:  0.3993  memory: 11.83GiB(24.89%)  tps: 7,046  tflops: 53.66  mfu: 17.20%
[rank2]:2025-10-29 21:13:30,033 - INFO - ðŸ”Ž  Running validation at step 1800
[rank1]:2025-10-29 21:13:49,756 - INFO - validate step: 1800  loss: -1.0000  memory: 14.66GiB(30.86%)  tps: 20,776
[rank0]:2025-10-29 21:13:49,741 - INFO - validate step: 1800  loss: -1.0000  memory: 16.57GiB(34.88%)  tps: 20,800
[rank3]:2025-10-29 21:13:49,767 - INFO - validate step: 1800  loss:  0.9633  memory: 27.51GiB(57.90%)  tps: 20,783
[rank2]:2025-10-29 21:13:49,777 - INFO - validate step: 1800  loss: -1.0000  memory: 11.83GiB(24.89%)  tps: 20,746
[rank1]:2025-10-29 21:13:49,861 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_2113_stage1_step1800.svg
[rank0]:2025-10-29 21:13:49,863 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_2113_stage0_step1800.svg
[rank2]:2025-10-29 21:13:49,869 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_2113_stage2_step1800.svg
[rank3]:2025-10-29 21:13:49,972 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/pipeline_schedule/251029_2113_real_step1800_rank3.svg
[rank3]:> Batch Time: 492.89 ms, GPU Bubble Ratio: 59.47%, 54.92%, 66.39%, 15.40%
[rank3]:2025-10-29 21:13:50,051 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_2113_stage3_step1800.svg
[rank3]:2025-10-29 21:13:50,568 - INFO - Avg. fwd time: 10.7749 / Avg. bwd time: 41.3958 / Avg. batch time: 477.4168 (ms) / GPU bubble ratio: 12.58%
[rank2]:2025-10-29 21:13:50,590 - INFO - Avg. fwd time: 7.7641 / Avg. bwd time: 12.3256 / Avg. batch time: 502.3461 (ms) / GPU bubble ratio: 68.01%
[rank1]:2025-10-29 21:13:50,614 - INFO - Avg. fwd time: 9.7834 / Avg. bwd time: 17.5049 / Avg. batch time: 534.2142 (ms) / GPU bubble ratio: 59.14%
[rank0]:2025-10-29 21:13:50,638 - INFO - Avg. fwd time: 8.9126 / Avg. bwd time: 16.4175 / Avg. batch time: 563.4948 (ms) / GPU bubble ratio: 64.04%
[rank1]:2025-10-29 21:14:01,854 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.0300e+00
[rank0]:2025-10-29 21:14:01,865 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.4824e+00
[rank3]:2025-10-29 21:14:01,874 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 9.9851e-01
[rank2]:2025-10-29 21:14:01,854 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 7.4440e-01
[rank2]:2025-10-29 21:14:13,234 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.9941e+00
[rank1]:2025-10-29 21:14:13,242 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 3.2023e+00
[rank0]:2025-10-29 21:14:13,250 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.4969e+00
[rank3]:2025-10-29 21:14:13,254 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.5999e+00
[rank2]:2025-10-29 21:14:25,062 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.3402e-01
[rank1]:2025-10-29 21:14:25,062 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.7724e+00
[rank0]:2025-10-29 21:14:25,074 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.7262e+00
[rank3]:2025-10-29 21:14:25,083 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 8.4188e-01
[rank1]:2025-10-29 21:14:36,504 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 3.4410e-01
[rank0]:2025-10-29 21:14:36,512 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.5076e-01
[rank3]:2025-10-29 21:14:36,516 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 6.0249e-01
[rank2]:2025-10-29 21:14:36,496 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 6.8269e-01
[rank0]:2025-10-29 21:14:47,202 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-29 21:14:48,390 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.3213e-01
[rank2]:2025-10-29 21:14:48,391 - INFO -  step: 1850  loss: -2.0000  grad_norm:  0.3897  memory: 11.83GiB(24.89%)  tps: 6,988  tflops: 53.22  mfu: 17.06%
[rank1]:2025-10-29 21:14:48,390 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 3.4523e-01
[rank1]:2025-10-29 21:14:48,391 - INFO -  step: 1850  loss: -2.0000  grad_norm:  0.3897  memory: 14.66GiB(30.86%)  tps: 6,986  tflops: 53.20  mfu: 17.05%
[rank3]:2025-10-29 21:14:48,411 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 7.4612e-01
[rank0]:2025-10-29 21:14:48,402 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1330e+00
[rank3]:2025-10-29 21:14:48,413 - INFO -  step: 1850  loss:  0.2734  grad_norm:  0.3897  memory: 27.51GiB(57.90%)  tps: 6,984  tflops: 53.19  mfu: 17.05%
[rank0]:2025-10-29 21:14:48,402 - INFO -  step: 1850  loss: -2.0000  grad_norm:  0.3897  memory: 16.57GiB(34.88%)  tps: 6,982  tflops: 53.18  mfu: 17.04%
[rank1]:2025-10-29 21:14:59,733 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.5055e+00
[rank0]:2025-10-29 21:14:59,740 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 7.1850e-01
[rank3]:2025-10-29 21:14:59,745 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 3.3472e-01
[rank2]:2025-10-29 21:14:59,725 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 4.4143e-01
[rank1]:2025-10-29 21:15:11,556 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 6.6056e-01
[rank0]:2025-10-29 21:15:11,567 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1009e+00
[rank3]:2025-10-29 21:15:11,577 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 6.9762e-01
[rank2]:2025-10-29 21:15:11,555 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.9870e-01
[rank1]:2025-10-29 21:15:22,904 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 2.3445e+00
[rank0]:2025-10-29 21:15:22,911 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.0008e+00
[rank3]:2025-10-29 21:15:22,918 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.6036e+00
[rank2]:2025-10-29 21:15:22,896 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.0149e+00
[rank1]:2025-10-29 21:15:34,693 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 6.2005e-01
[rank0]:2025-10-29 21:15:34,705 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 4.4973e-01
[rank3]:2025-10-29 21:15:34,714 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 4.3842e-01
[rank2]:2025-10-29 21:15:34,693 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 7.9166e-02
[rank0]:2025-10-29 21:15:44,898 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 21:15:46,037 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 2.2961e+00
[rank1]:2025-10-29 21:15:46,038 - INFO -  step: 1900  loss: -2.0000  grad_norm:  0.2897  memory: 14.66GiB(30.86%)  tps: 7,105  tflops: 54.12  mfu: 17.34%
[rank0]:2025-10-29 21:15:46,045 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.0181e+00
[rank0]:2025-10-29 21:15:46,045 - INFO -  step: 1900  loss: -2.0000  grad_norm:  0.2897  memory: 16.57GiB(34.88%)  tps: 7,106  tflops: 54.12  mfu: 17.35%
[rank3]:2025-10-29 21:15:46,049 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.1509e+00
[rank3]:2025-10-29 21:15:46,055 - INFO -  step: 1900  loss:  0.1924  grad_norm:  0.2897  memory: 27.51GiB(57.90%)  tps: 7,106  tflops: 54.12  mfu: 17.35%
[rank2]:2025-10-29 21:15:46,029 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 9.9943e-01
[rank2]:2025-10-29 21:15:46,030 - INFO -  step: 1900  loss: -2.0000  grad_norm:  0.2897  memory: 11.83GiB(24.89%)  tps: 7,106  tflops: 54.12  mfu: 17.35%
[rank1]:2025-10-29 21:15:46,147 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_2115_stage1_step1900.svg
[rank0]:2025-10-29 21:15:46,152 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_2115_stage0_step1900.svg
[rank2]:2025-10-29 21:15:46,160 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_2115_stage2_step1900.svg
[rank3]:2025-10-29 21:15:46,291 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/pipeline_schedule/251029_2115_real_step1900_rank3.svg
[rank3]:> Batch Time: 492.94 ms, GPU Bubble Ratio: 59.47%, 54.92%, 66.39%, 15.40%
[rank3]:2025-10-29 21:15:46,383 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_2115_stage3_step1900.svg
[rank0]:2025-10-29 21:15:46,710 - INFO - Avg. fwd time: 8.9161 / Avg. bwd time: 16.3846 / Avg. batch time: 563.3796 (ms) / GPU bubble ratio: 64.07%
[rank3]:2025-10-29 21:15:46,689 - INFO - Avg. fwd time: 10.7739 / Avg. bwd time: 41.3995 / Avg. batch time: 477.4207 (ms) / GPU bubble ratio: 12.57%
[rank2]:2025-10-29 21:15:46,721 - INFO - Avg. fwd time: 7.7667 / Avg. bwd time: 12.3105 / Avg. batch time: 502.2998 (ms) / GPU bubble ratio: 68.02%
[rank1]:2025-10-29 21:15:46,772 - INFO - Avg. fwd time: 9.7878 / Avg. bwd time: 17.4717 / Avg. batch time: 534.1327 (ms) / GPU bubble ratio: 59.17%
[rank1]:2025-10-29 21:15:58,170 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 4.3077e-01
[rank2]:2025-10-29 21:15:58,170 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.2614e-01
[rank0]:2025-10-29 21:15:58,181 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 6.0626e-01
[rank3]:2025-10-29 21:15:58,195 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 4.3126e-01
[rank1]:2025-10-29 21:16:09,529 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.6660e+00
[rank0]:2025-10-29 21:16:09,537 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.4643e+00
[rank3]:2025-10-29 21:16:09,541 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.2189e+00
[rank2]:2025-10-29 21:16:09,522 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.5737e+00
[rank1]:2025-10-29 21:16:21,347 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.9461e-01
[rank0]:2025-10-29 21:16:21,359 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 5.4024e-01
[rank3]:2025-10-29 21:16:21,367 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 3.7265e-01
[rank2]:2025-10-29 21:16:21,347 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.3619e-01
[rank1]:2025-10-29 21:16:32,680 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.8281e+00
[rank3]:2025-10-29 21:16:32,695 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.6062e-01
[rank0]:2025-10-29 21:16:32,688 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.7045e+00
[rank2]:2025-10-29 21:16:32,673 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 4.7368e-01
[rank0]:2025-10-29 21:16:43,288 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 21:16:44,498 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 7.2374e-01
[rank3]:2025-10-29 21:16:44,501 - INFO -  step: 1950  loss:  0.1734  grad_norm:  0.2472  memory: 27.51GiB(57.90%)  tps: 7,008  tflops: 53.38  mfu: 17.11%
[rank0]:2025-10-29 21:16:44,489 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.2567e+00
[rank0]:2025-10-29 21:16:44,490 - INFO -  step: 1950  loss: -2.0000  grad_norm:  0.2472  memory: 16.57GiB(34.88%)  tps: 7,008  tflops: 53.38  mfu: 17.11%
[rank1]:2025-10-29 21:16:44,478 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.7318e+00
[rank1]:2025-10-29 21:16:44,478 - INFO -  step: 1950  loss: -2.0000  grad_norm:  0.2472  memory: 14.66GiB(30.86%)  tps: 7,009  tflops: 53.38  mfu: 17.11%
[rank2]:2025-10-29 21:16:44,478 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 6.4439e-01
[rank2]:2025-10-29 21:16:44,478 - INFO -  step: 1950  loss: -2.0000  grad_norm:  0.2472  memory: 11.83GiB(24.89%)  tps: 7,008  tflops: 53.37  mfu: 17.11%
[rank3]:2025-10-29 21:16:55,909 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.1232e-01
[rank1]:2025-10-29 21:16:55,897 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 2.7286e-01
[rank0]:2025-10-29 21:16:55,905 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 5.2156e-01
[rank2]:2025-10-29 21:16:55,889 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 3.2674e-01
[rank3]:2025-10-29 21:17:07,826 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 3.9482e+00
[rank0]:2025-10-29 21:17:07,818 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.8401e+00
[rank1]:2025-10-29 21:17:07,806 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 3.1255e+00
[rank2]:2025-10-29 21:17:07,806 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.0351e+00
[rank3]:2025-10-29 21:17:19,243 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.0810e+00
[rank1]:2025-10-29 21:17:19,228 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 4.1343e-01
[rank0]:2025-10-29 21:17:19,236 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1613e+00
[rank2]:2025-10-29 21:17:19,220 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 8.1606e-01
[rank1]:2025-10-29 21:17:31,089 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.6637e+00
[rank0]:2025-10-29 21:17:31,100 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.4343e+00
[rank2]:2025-10-29 21:17:31,089 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 9.4596e-01
[rank3]:2025-10-29 21:17:31,109 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 1.3454e+00
[rank0]:2025-10-29 21:17:41,371 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 21:17:42,555 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.1993e+00
[rank3]:2025-10-29 21:17:42,558 - INFO -  step: 2000  loss:  0.2139  grad_norm:  0.4186  memory: 27.51GiB(57.90%)  tps: 7,055  tflops: 53.74  mfu: 17.22%
[rank3]:2025-10-29 21:17:42,558 - INFO - ðŸ”Ž  Running validation at step 2000
[rank1]:2025-10-29 21:17:42,543 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 2.7969e-01
[rank1]:2025-10-29 21:17:42,544 - INFO -  step: 2000  loss: -2.0000  grad_norm:  0.4186  memory: 14.66GiB(30.86%)  tps: 7,054  tflops: 53.73  mfu: 17.22%
[rank1]:2025-10-29 21:17:42,544 - INFO - ðŸ”Ž  Running validation at step 2000
[rank0]:2025-10-29 21:17:42,551 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.4689e-01
[rank0]:2025-10-29 21:17:42,551 - INFO -  step: 2000  loss: -2.0000  grad_norm:  0.4186  memory: 16.57GiB(34.88%)  tps: 7,055  tflops: 53.73  mfu: 17.22%
[rank0]:2025-10-29 21:17:42,551 - INFO - ðŸ”Ž  Running validation at step 2000
[rank2]:2025-10-29 21:17:42,535 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 4.2154e-01
[rank2]:2025-10-29 21:17:42,536 - INFO -  step: 2000  loss: -2.0000  grad_norm:  0.4186  memory: 11.83GiB(24.89%)  tps: 7,055  tflops: 53.73  mfu: 17.22%
[rank2]:2025-10-29 21:17:42,536 - INFO - ðŸ”Ž  Running validation at step 2000
[rank3]:2025-10-29 21:18:02,213 - INFO - validate step: 2000  loss:  0.9626  memory: 27.51GiB(57.90%)  tps: 20,841
[rank1]:2025-10-29 21:18:02,203 - INFO - validate step: 2000  loss: -1.0000  memory: 14.66GiB(30.86%)  tps: 20,835
[rank0]:2025-10-29 21:18:02,188 - INFO - validate step: 2000  loss: -1.0000  memory: 16.57GiB(34.88%)  tps: 20,860
[rank2]:2025-10-29 21:18:02,222 - INFO - validate step: 2000  loss: -1.0000  memory: 11.83GiB(24.89%)  tps: 20,807
[rank0]:2025-10-29 21:18:02,311 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_2118_stage0_step2000.svg
[rank1]:2025-10-29 21:18:02,309 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_2118_stage1_step2000.svg
[rank2]:2025-10-29 21:18:02,312 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_2118_stage2_step2000.svg
[rank3]:2025-10-29 21:18:02,409 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/pipeline_schedule/251029_2118_real_step2000_rank3.svg
[rank3]:> Batch Time: 492.87 ms, GPU Bubble Ratio: 59.46%, 54.92%, 66.39%, 15.40%
[rank3]:2025-10-29 21:18:02,488 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_2118_stage3_step2000.svg
[rank3]:2025-10-29 21:18:02,804 - INFO - Avg. fwd time: 10.7751 / Avg. bwd time: 41.3946 / Avg. batch time: 477.3675 (ms) / GPU bubble ratio: 12.57%
[rank0]:2025-10-29 21:18:02,818 - INFO - Avg. fwd time: 8.9199 / Avg. bwd time: 16.3505 / Avg. batch time: 563.2474 (ms) / GPU bubble ratio: 64.11%
[rank2]:2025-10-29 21:18:02,832 - INFO - Avg. fwd time: 7.7708 / Avg. bwd time: 12.2845 / Avg. batch time: 502.2312 (ms) / GPU bubble ratio: 68.05%
[rank1]:2025-10-29 21:18:02,888 - INFO - Avg. fwd time: 9.7912 / Avg. bwd time: 17.4467 / Avg. batch time: 534.0344 (ms) / GPU bubble ratio: 59.20%
[rank3]:2025-10-29 21:18:14,298 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 1.5956e+00
[rank0]:2025-10-29 21:18:14,290 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.3291e+00
[rank1]:2025-10-29 21:18:14,279 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 9.8657e-01
[rank2]:2025-10-29 21:18:14,279 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 9.9429e-01
[rank3]:2025-10-29 21:18:25,639 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 9.1249e-01
[rank0]:2025-10-29 21:18:25,626 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 9.3043e-01
[rank1]:2025-10-29 21:18:25,620 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 2.5611e-01
[rank2]:2025-10-29 21:18:25,611 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.1828e+00
[rank0]:2025-10-29 21:18:37,476 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 7.4694e-01
[rank1]:2025-10-29 21:18:37,464 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 5.9211e-01
[rank2]:2025-10-29 21:18:37,464 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.0348e-01
[rank3]:2025-10-29 21:18:37,485 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 2.8075e-01
[rank3]:2025-10-29 21:18:48,872 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.6345e+00
[rank0]:2025-10-29 21:18:48,868 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.0468e+00
[rank1]:2025-10-29 21:18:48,861 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.2357e+00
[rank2]:2025-10-29 21:18:48,853 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.9384e+00
[rank0]:2025-10-29 21:18:59,536 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-29 21:19:00,705 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 2.6507e+00
[rank1]:2025-10-29 21:19:00,705 - INFO -  step: 2050  loss: -2.0000  grad_norm:  0.4091  memory: 14.66GiB(30.86%)  tps: 7,001  tflops: 53.32  mfu: 17.09%
[rank2]:2025-10-29 21:19:00,705 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.3306e+00
[rank2]:2025-10-29 21:19:00,705 - INFO -  step: 2050  loss: -2.0000  grad_norm:  0.4091  memory: 11.83GiB(24.89%)  tps: 7,004  tflops: 53.34  mfu: 17.10%
[rank3]:2025-10-29 21:19:00,725 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 2.6785e+00
[rank3]:2025-10-29 21:19:00,728 - INFO -  step: 2050  loss:  0.1889  grad_norm:  0.4091  memory: 27.51GiB(57.90%)  tps: 7,000  tflops: 53.31  mfu: 17.09%
[rank0]:2025-10-29 21:19:00,716 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.9021e+00
[rank0]:2025-10-29 21:19:00,717 - INFO -  step: 2050  loss: -2.0000  grad_norm:  0.4091  memory: 16.57GiB(34.88%)  tps: 6,998  tflops: 53.30  mfu: 17.08%
[rank3]:2025-10-29 21:19:12,080 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.5147e+00
[rank0]:2025-10-29 21:19:12,075 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.8007e+00
[rank1]:2025-10-29 21:19:12,068 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 3.3615e+00
[rank2]:2025-10-29 21:19:12,060 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.8527e+00
[rank0]:2025-10-29 21:19:23,929 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 9.3930e-01
[rank1]:2025-10-29 21:19:23,917 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 3.8125e-01
[rank2]:2025-10-29 21:19:23,917 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.8324e-01
[rank3]:2025-10-29 21:19:23,941 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 3.5682e-01
[rank3]:2025-10-29 21:19:35,319 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.4333e+00
[rank0]:2025-10-29 21:19:35,315 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 6.5488e-01
[rank1]:2025-10-29 21:19:35,307 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 5.6114e-01
[rank2]:2025-10-29 21:19:35,300 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 6.2789e-01
[rank3]:2025-10-29 21:19:47,229 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 2.8745e-01
[rank0]:2025-10-29 21:19:47,221 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.8983e+00
[rank2]:2025-10-29 21:19:47,209 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.0028e-01
[rank1]:2025-10-29 21:19:47,209 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 9.2106e-01
[rank0]:2025-10-29 21:19:57,407 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 21:19:58,547 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 4.1787e-01
[rank3]:2025-10-29 21:19:58,550 - INFO -  step: 2100  loss:  0.2224  grad_norm:  0.3256  memory: 27.51GiB(57.90%)  tps: 7,084  tflops: 53.95  mfu: 17.29%
[rank2]:2025-10-29 21:19:58,528 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 6.2307e-01
[rank2]:2025-10-29 21:19:58,528 - INFO -  step: 2100  loss: -2.0000  grad_norm:  0.3256  memory: 11.83GiB(24.89%)  tps: 7,084  tflops: 53.95  mfu: 17.29%
[rank0]:2025-10-29 21:19:58,543 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.7298e+00
[rank0]:2025-10-29 21:19:58,544 - INFO -  step: 2100  loss: -2.0000  grad_norm:  0.3256  memory: 16.57GiB(34.88%)  tps: 7,083  tflops: 53.95  mfu: 17.29%
[rank1]:2025-10-29 21:19:58,535 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.0916e+00
[rank1]:2025-10-29 21:19:58,536 - INFO -  step: 2100  loss: -2.0000  grad_norm:  0.3256  memory: 14.66GiB(30.86%)  tps: 7,083  tflops: 53.94  mfu: 17.29%
[rank2]:2025-10-29 21:19:58,634 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_2119_stage2_step2100.svg
[rank0]:2025-10-29 21:19:58,630 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_2119_stage0_step2100.svg
[rank1]:2025-10-29 21:19:58,629 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_2119_stage1_step2100.svg
[rank3]:2025-10-29 21:19:58,739 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/pipeline_schedule/251029_2119_real_step2100_rank3.svg
[rank3]:> Batch Time: 492.93 ms, GPU Bubble Ratio: 59.47%, 54.93%, 66.39%, 15.40%
[rank3]:2025-10-29 21:19:58,810 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_2119_stage3_step2100.svg
[rank3]:2025-10-29 21:19:59,312 - INFO - Avg. fwd time: 10.7772 / Avg. bwd time: 41.3901 / Avg. batch time: 477.3264 (ms) / GPU bubble ratio: 12.57%
[rank2]:2025-10-29 21:19:59,334 - INFO - Avg. fwd time: 7.7747 / Avg. bwd time: 12.2622 / Avg. batch time: 502.2010 (ms) / GPU bubble ratio: 68.08%
[rank0]:2025-10-29 21:19:59,383 - INFO - Avg. fwd time: 8.9235 / Avg. bwd time: 16.3200 / Avg. batch time: 563.1606 (ms) / GPU bubble ratio: 64.14%
[rank1]:2025-10-29 21:19:59,358 - INFO - Avg. fwd time: 9.7947 / Avg. bwd time: 17.4249 / Avg. batch time: 533.9790 (ms) / GPU bubble ratio: 59.22%
[rank1]:2025-10-29 21:20:10,603 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 2.9012e+00
[rank3]:2025-10-29 21:20:10,622 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 2.3786e+00
[rank2]:2025-10-29 21:20:10,603 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.4420e+00
[rank0]:2025-10-29 21:20:10,614 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.6164e+00
[rank3]:2025-10-29 21:20:21,997 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 7.6156e-01
[rank2]:2025-10-29 21:20:21,976 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 6.2654e-01
[rank0]:2025-10-29 21:20:21,991 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 5.1740e-01
[rank1]:2025-10-29 21:20:21,986 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 3.2403e-01
[rank3]:2025-10-29 21:20:33,797 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 1.8797e+00
[rank2]:2025-10-29 21:20:33,777 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 9.1705e-01
[rank0]:2025-10-29 21:20:33,789 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.4848e+00
[rank1]:2025-10-29 21:20:33,777 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.8335e+00
[rank2]:2025-10-29 21:20:45,134 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.8144e-01
[rank1]:2025-10-29 21:20:45,142 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.9866e-01
[rank3]:2025-10-29 21:20:45,154 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 3.1572e-01
[rank0]:2025-10-29 21:20:45,149 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 4.1675e-01
[rank0]:2025-10-29 21:20:55,748 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 21:20:56,956 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.6292e-01
[rank2]:2025-10-29 21:20:56,956 - INFO -  step: 2150  loss: -2.0000  grad_norm:  0.2868  memory: 11.83GiB(24.89%)  tps: 7,010  tflops: 53.39  mfu: 17.11%
[rank1]:2025-10-29 21:20:56,956 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 5.0916e-01
[rank1]:2025-10-29 21:20:56,956 - INFO -  step: 2150  loss: -2.0000  grad_norm:  0.2868  memory: 14.66GiB(30.86%)  tps: 7,011  tflops: 53.40  mfu: 17.12%
[rank3]:2025-10-29 21:20:56,976 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 3.5574e-01
[rank3]:2025-10-29 21:20:56,980 - INFO -  step: 2150  loss:  0.2007  grad_norm:  0.2868  memory: 27.51GiB(57.90%)  tps: 7,010  tflops: 53.39  mfu: 17.11%
[rank0]:2025-10-29 21:20:56,967 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 8.1468e-01
[rank0]:2025-10-29 21:20:56,968 - INFO -  step: 2150  loss: -2.0000  grad_norm:  0.2868  memory: 16.57GiB(34.88%)  tps: 7,011  tflops: 53.40  mfu: 17.11%
[rank3]:2025-10-29 21:21:08,404 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.2648e+00
[rank0]:2025-10-29 21:21:08,398 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.4571e+00
[rank2]:2025-10-29 21:21:08,382 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.4742e+00
[rank1]:2025-10-29 21:21:08,390 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.5428e+00
[rank3]:2025-10-29 21:21:20,268 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 1.9066e+00
[rank0]:2025-10-29 21:21:20,259 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.1076e+00
[rank2]:2025-10-29 21:21:20,248 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.1308e+00
[rank1]:2025-10-29 21:21:20,248 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 2.0291e+00
[rank2]:2025-10-29 21:21:31,595 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 5.9503e-01
[rank1]:2025-10-29 21:21:31,603 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 3.8230e-01
[rank0]:2025-10-29 21:21:31,610 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 6.3524e-01
[rank3]:2025-10-29 21:21:31,614 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 4.6170e-01
[rank2]:2025-10-29 21:21:43,407 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.3644e-01
[rank1]:2025-10-29 21:21:43,407 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 6.4729e-01
[rank0]:2025-10-29 21:21:43,419 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.5307e+00
[rank3]:2025-10-29 21:21:43,427 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 4.0490e-01
[rank0]:2025-10-29 21:21:53,668 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 21:21:54,833 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 7.6897e-01
[rank2]:2025-10-29 21:21:54,834 - INFO -  step: 2200  loss: -2.0000  grad_norm:  0.4150  memory: 11.83GiB(24.89%)  tps: 7,077  tflops: 53.90  mfu: 17.28%
[rank2]:2025-10-29 21:21:54,834 - INFO - ðŸ”Ž  Running validation at step 2200
[rank1]:2025-10-29 21:21:54,841 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 9.9596e-01
[rank1]:2025-10-29 21:21:54,841 - INFO -  step: 2200  loss: -2.0000  grad_norm:  0.4150  memory: 14.66GiB(30.86%)  tps: 7,076  tflops: 53.89  mfu: 17.27%
[rank1]:2025-10-29 21:21:54,841 - INFO - ðŸ”Ž  Running validation at step 2200
[rank0]:2025-10-29 21:21:54,848 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 4.1720e-01
[rank0]:2025-10-29 21:21:54,849 - INFO -  step: 2200  loss: -2.0000  grad_norm:  0.4150  memory: 16.57GiB(34.88%)  tps: 7,077  tflops: 53.90  mfu: 17.27%
[rank0]:2025-10-29 21:21:54,849 - INFO - ðŸ”Ž  Running validation at step 2200
[rank3]:2025-10-29 21:21:54,853 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.9242e-01
[rank3]:2025-10-29 21:21:54,856 - INFO -  step: 2200  loss:  0.2232  grad_norm:  0.4150  memory: 27.51GiB(57.90%)  tps: 7,077  tflops: 53.90  mfu: 17.28%
[rank3]:2025-10-29 21:21:54,857 - INFO - ðŸ”Ž  Running validation at step 2200
[rank0]:2025-10-29 21:22:14,382 - INFO - validate step: 2200  loss: -1.0000  memory: 16.57GiB(34.88%)  tps: 20,970
[rank3]:2025-10-29 21:22:14,406 - INFO - validate step: 2200  loss:  0.9649  memory: 27.51GiB(57.90%)  tps: 20,954
[rank2]:2025-10-29 21:22:14,414 - INFO - validate step: 2200  loss: -1.0000  memory: 11.83GiB(24.89%)  tps: 20,920
[rank1]:2025-10-29 21:22:14,399 - INFO - validate step: 2200  loss: -1.0000  memory: 14.66GiB(30.86%)  tps: 20,943
[rank0]:2025-10-29 21:22:14,512 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_2122_stage0_step2200.svg
[rank2]:2025-10-29 21:22:14,500 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_2122_stage2_step2200.svg
[rank1]:2025-10-29 21:22:14,510 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_2122_stage1_step2200.svg
[rank3]:2025-10-29 21:22:14,607 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/pipeline_schedule/251029_2122_real_step2200_rank3.svg
[rank3]:> Batch Time: 493.15 ms, GPU Bubble Ratio: 59.48%, 54.94%, 66.41%, 15.39%
[rank3]:2025-10-29 21:22:14,680 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_2122_stage3_step2200.svg
[rank0]:2025-10-29 21:22:15,023 - INFO - Avg. fwd time: 8.9264 / Avg. bwd time: 16.2962 / Avg. batch time: 563.0755 (ms) / GPU bubble ratio: 64.16%
[rank3]:2025-10-29 21:22:15,004 - INFO - Avg. fwd time: 10.7773 / Avg. bwd time: 41.3935 / Avg. batch time: 477.3373 (ms) / GPU bubble ratio: 12.56%
[rank2]:2025-10-29 21:22:15,033 - INFO - Avg. fwd time: 7.7765 / Avg. bwd time: 12.2519 / Avg. batch time: 502.1692 (ms) / GPU bubble ratio: 68.09%
[rank1]:2025-10-29 21:22:15,089 - INFO - Avg. fwd time: 9.7983 / Avg. bwd time: 17.3996 / Avg. batch time: 533.9198 (ms) / GPU bubble ratio: 59.25%
[rank1]:2025-10-29 21:22:26,475 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 5.5320e-01
[rank2]:2025-10-29 21:22:26,475 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.5923e-01
[rank0]:2025-10-29 21:22:26,487 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.5100e-01
[rank3]:2025-10-29 21:22:26,496 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 5.4672e-01
[rank2]:2025-10-29 21:22:37,794 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 8.6747e-01
[rank0]:2025-10-29 21:22:37,809 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.5258e+00
[rank3]:2025-10-29 21:22:37,813 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 6.6962e-01
[rank1]:2025-10-29 21:22:37,802 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.2391e+00
[rank2]:2025-10-29 21:22:49,614 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.3860e-01
[rank0]:2025-10-29 21:22:49,626 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 7.0535e-01
[rank3]:2025-10-29 21:22:49,635 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 4.7102e-01
[rank1]:2025-10-29 21:22:49,614 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 7.6991e-01
[rank0]:2025-10-29 21:23:01,088 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.0351e+00
[rank3]:2025-10-29 21:23:01,093 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 3.7822e-01
[rank1]:2025-10-29 21:23:01,081 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.5091e-01
[rank2]:2025-10-29 21:23:01,073 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 3.7615e-01
[rank0]:2025-10-29 21:23:11,731 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-29 21:23:12,897 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 4.3708e-01
[rank0]:2025-10-29 21:23:12,898 - INFO -  step: 2250  loss: -2.0000  grad_norm:  0.3778  memory: 16.57GiB(34.88%)  tps: 7,000  tflops: 53.31  mfu: 17.09%
[rank3]:2025-10-29 21:23:12,906 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 6.4528e-01
[rank3]:2025-10-29 21:23:12,909 - INFO -  step: 2250  loss:  0.2112  grad_norm:  0.3778  memory: 27.51GiB(57.90%)  tps: 7,001  tflops: 53.32  mfu: 17.09%
[rank1]:2025-10-29 21:23:12,886 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 8.4732e-01
[rank1]:2025-10-29 21:23:12,887 - INFO -  step: 2250  loss: -2.0000  grad_norm:  0.3778  memory: 14.66GiB(30.86%)  tps: 7,003  tflops: 53.34  mfu: 17.10%
[rank2]:2025-10-29 21:23:12,886 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.8673e-01
[rank2]:2025-10-29 21:23:12,887 - INFO -  step: 2250  loss: -2.0000  grad_norm:  0.3778  memory: 11.83GiB(24.89%)  tps: 7,005  tflops: 53.35  mfu: 17.10%
[rank2]:2025-10-29 21:23:24,261 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 5.2539e-01
[rank0]:2025-10-29 21:23:24,276 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 7.1662e-01
[rank3]:2025-10-29 21:23:24,281 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 4.1901e-01
[rank1]:2025-10-29 21:23:24,269 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 6.0637e-01
[rank0]:2025-10-29 21:23:36,116 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 4.9855e-01
[rank3]:2025-10-29 21:23:36,129 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 2.3834e-01
[rank1]:2025-10-29 21:23:36,105 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 8.0567e-01
[rank2]:2025-10-29 21:23:36,105 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.4607e-01
[rank1]:2025-10-29 21:23:47,570 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.2457e+00
[rank2]:2025-10-29 21:23:47,562 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.4148e+00
[rank0]:2025-10-29 21:23:47,578 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 8.6578e-01
[rank3]:2025-10-29 21:23:47,582 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.1478e+00
[rank2]:2025-10-29 21:23:59,396 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.5832e-01
[rank0]:2025-10-29 21:23:59,407 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.2399e-01
[rank3]:2025-10-29 21:23:59,415 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 6.1144e-01
[rank1]:2025-10-29 21:23:59,395 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 2.2435e-01
[rank0]:2025-10-29 21:24:09,625 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 21:24:10,760 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 7.5541e-01
[rank0]:2025-10-29 21:24:10,761 - INFO -  step: 2300  loss: -2.0000  grad_norm:  0.3002  memory: 16.57GiB(34.88%)  tps: 7,079  tflops: 53.91  mfu: 17.28%
[rank3]:2025-10-29 21:24:10,766 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.2316e-01
[rank3]:2025-10-29 21:24:10,769 - INFO -  step: 2300  loss:  0.2043  grad_norm:  0.3002  memory: 27.51GiB(57.90%)  tps: 7,079  tflops: 53.92  mfu: 17.28%
[rank1]:2025-10-29 21:24:10,753 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 3.0760e-01
[rank1]:2025-10-29 21:24:10,753 - INFO -  step: 2300  loss: -2.0000  grad_norm:  0.3002  memory: 14.66GiB(30.86%)  tps: 7,078  tflops: 53.91  mfu: 17.28%
[rank2]:2025-10-29 21:24:10,745 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 7.2005e-01
[rank2]:2025-10-29 21:24:10,746 - INFO -  step: 2300  loss: -2.0000  grad_norm:  0.3002  memory: 11.83GiB(24.89%)  tps: 7,079  tflops: 53.92  mfu: 17.28%
[rank0]:2025-10-29 21:24:10,851 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_2124_stage0_step2300.svg
[rank1]:2025-10-29 21:24:10,849 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_2124_stage1_step2300.svg
[rank2]:2025-10-29 21:24:10,855 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_2124_stage2_step2300.svg
[rank3]:2025-10-29 21:24:10,961 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/pipeline_schedule/251029_2124_real_step2300_rank3.svg
[rank3]:> Batch Time: 493.07 ms, GPU Bubble Ratio: 59.48%, 54.93%, 66.40%, 15.39%
[rank3]:2025-10-29 21:24:11,033 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_2124_stage3_step2300.svg
[rank0]:2025-10-29 21:24:11,370 - INFO - Avg. fwd time: 8.9293 / Avg. bwd time: 16.2708 / Avg. batch time: 562.9630 (ms) / GPU bubble ratio: 64.19%
[rank3]:2025-10-29 21:24:11,350 - INFO - Avg. fwd time: 10.7786 / Avg. bwd time: 41.3897 / Avg. batch time: 477.2987 (ms) / GPU bubble ratio: 12.56%
[rank2]:2025-10-29 21:24:11,378 - INFO - Avg. fwd time: 7.7797 / Avg. bwd time: 12.2322 / Avg. batch time: 502.1054 (ms) / GPU bubble ratio: 68.12%
[rank1]:2025-10-29 21:24:11,432 - INFO - Avg. fwd time: 9.8010 / Avg. bwd time: 17.3819 / Avg. batch time: 533.8340 (ms) / GPU bubble ratio: 59.26%
[rank1]:2025-10-29 21:24:22,803 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 9.6176e-01
[rank2]:2025-10-29 21:24:22,803 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.4424e-01
[rank0]:2025-10-29 21:24:22,814 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1344e+00
[rank3]:2025-10-29 21:24:22,823 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 5.3648e-01
[rank2]:2025-10-29 21:24:34,245 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 3.6689e-01
[rank0]:2025-10-29 21:24:34,260 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 7.5868e-01
[rank1]:2025-10-29 21:24:34,253 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 3.8108e-01
[rank3]:2025-10-29 21:24:34,265 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 6.9174e-01
[rank0]:2025-10-29 21:24:46,075 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.5424e+00
[rank3]:2025-10-29 21:24:46,084 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 8.8130e-01
[rank1]:2025-10-29 21:24:46,064 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.0649e+00
[rank2]:2025-10-29 21:24:46,064 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 9.1357e-01
[rank0]:2025-10-29 21:24:57,424 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 6.6070e-01
[rank3]:2025-10-29 21:24:57,429 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.6677e-01
[rank1]:2025-10-29 21:24:57,417 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 7.3083e-01
[rank2]:2025-10-29 21:24:57,408 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 7.5472e-01
[rank0]:2025-10-29 21:25:08,066 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 21:25:09,270 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 2.5114e+00
[rank3]:2025-10-29 21:25:09,273 - INFO -  step: 2350  loss:  0.1993  grad_norm:  0.2551  memory: 27.51GiB(57.90%)  tps: 7,001  tflops: 53.32  mfu: 17.09%
[rank1]:2025-10-29 21:25:09,250 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 2.2355e+00
[rank1]:2025-10-29 21:25:09,251 - INFO -  step: 2350  loss: -2.0000  grad_norm:  0.2551  memory: 14.66GiB(30.86%)  tps: 7,002  tflops: 53.33  mfu: 17.09%
[rank2]:2025-10-29 21:25:09,250 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.0024e+00
[rank2]:2025-10-29 21:25:09,251 - INFO -  step: 2350  loss: -2.0000  grad_norm:  0.2551  memory: 11.83GiB(24.89%)  tps: 7,001  tflops: 53.32  mfu: 17.09%
[rank0]:2025-10-29 21:25:09,262 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.5246e+00
[rank0]:2025-10-29 21:25:09,262 - INFO -  step: 2350  loss: -2.0000  grad_norm:  0.2551  memory: 16.57GiB(34.88%)  tps: 7,002  tflops: 53.33  mfu: 17.09%
[rank2]:2025-10-29 21:25:20,596 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 7.3151e-01
[rank0]:2025-10-29 21:25:20,611 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 6.7923e-01
[rank3]:2025-10-29 21:25:20,618 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.0564e+00
[rank1]:2025-10-29 21:25:20,604 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 3.9778e-01
[rank1]:2025-10-29 21:25:32,512 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 5.0967e-01
[rank2]:2025-10-29 21:25:32,512 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.4299e-01
[rank0]:2025-10-29 21:25:32,524 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 7.9859e-01
[rank3]:2025-10-29 21:25:32,532 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 2.7119e-01
[rank2]:2025-10-29 21:25:43,933 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 4.7061e-01
[rank0]:2025-10-29 21:25:43,948 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 8.5027e-01
[rank3]:2025-10-29 21:25:43,952 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 4.0887e-01
[rank1]:2025-10-29 21:25:43,942 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 3.8027e-01
[rank0]:2025-10-29 21:25:55,863 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.0863e+00
[rank3]:2025-10-29 21:25:55,871 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 1.0995e+00
[rank2]:2025-10-29 21:25:55,851 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.1430e-01
[rank1]:2025-10-29 21:25:55,851 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 9.3253e-01
[rank0]:2025-10-29 21:26:06,152 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 21:26:07,340 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.6403e+00
[rank3]:2025-10-29 21:26:07,343 - INFO -  step: 2400  loss:  0.2131  grad_norm:  0.4096  memory: 27.51GiB(57.90%)  tps: 7,054  tflops: 53.72  mfu: 17.22%
[rank3]:2025-10-29 21:26:07,344 - INFO -  final step: 2400  loss:  0.2131  grad_norm:  0.4096  tps: 7,115  tflops: 54.19  mfu: 16.77%
[rank3]:2025-10-29 21:26:07,344 - INFO - ðŸ”Ž  Running validation at step 2400
[rank2]:2025-10-29 21:26:07,318 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.2056e+00
[rank2]:2025-10-29 21:26:07,318 - INFO -  step: 2400  loss: -2.0000  grad_norm:  0.4096  memory: 11.83GiB(24.89%)  tps: 7,054  tflops: 53.72  mfu: 17.22%
[rank2]:2025-10-29 21:26:07,319 - INFO -  final step: 2400  loss: -2.0000  grad_norm:  0.4096  tps: 7,111  tflops: 54.16  mfu: 16.76%
[rank2]:2025-10-29 21:26:07,319 - INFO - ðŸ”Ž  Running validation at step 2400
[rank1]:2025-10-29 21:26:07,325 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 5.0445e-01
[rank1]:2025-10-29 21:26:07,326 - INFO -  step: 2400  loss: -2.0000  grad_norm:  0.4096  memory: 14.66GiB(30.86%)  tps: 7,053  tflops: 53.72  mfu: 17.22%
[rank1]:2025-10-29 21:26:07,326 - INFO -  final step: 2400  loss: -2.0000  grad_norm:  0.4096  tps: 7,109  tflops: 54.15  mfu: 16.76%
[rank1]:2025-10-29 21:26:07,326 - INFO - ðŸ”Ž  Running validation at step 2400
[rank0]:2025-10-29 21:26:07,333 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 5.8952e-01
[rank0]:2025-10-29 21:26:07,334 - INFO -  step: 2400  loss: -2.0000  grad_norm:  0.4096  memory: 16.57GiB(34.88%)  tps: 7,053  tflops: 53.72  mfu: 17.22%
[rank0]:2025-10-29 21:26:07,334 - INFO -  final step: 2400  loss: -2.0000  grad_norm:  0.4096  tps: 7,110  tflops: 54.15  mfu: 16.76%
[rank0]:2025-10-29 21:26:07,334 - INFO - ðŸ”Ž  Running validation at step 2400
[rank0]:2025-10-29 21:26:27,094 - INFO - validate step: 2400  loss: -1.0000  memory: 16.57GiB(34.88%)  tps: 20,728
[rank0]:2025-10-29 21:26:27,095 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-29 21:26:27,097 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank3]:2025-10-29 21:26:27,119 - INFO - validate step: 2400  loss:  0.9647  memory: 27.51GiB(57.90%)  tps: 20,714
[rank3]:2025-10-29 21:26:27,120 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-29 21:26:27,121 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank2]:2025-10-29 21:26:27,130 - INFO - validate step: 2400  loss: -1.0000  memory: 11.83GiB(24.89%)  tps: 20,676
[rank2]:2025-10-29 21:26:27,130 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-29 21:26:27,132 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank1]:2025-10-29 21:26:27,111 - INFO - validate step: 2400  loss: -1.0000  memory: 14.66GiB(30.86%)  tps: 20,703
[rank1]:2025-10-29 21:26:27,111 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-29 21:26:27,113 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank0]:2025-10-29 21:26:29,410 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank0]:2025-10-29 21:26:29,495 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_2126_stage0_final2400.svg
[rank2]:2025-10-29 21:26:29,501 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_2126_stage2_final2400.svg
[rank1]:2025-10-29 21:26:29,494 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_2126_stage1_final2400.svg
[rank3]:2025-10-29 21:26:29,608 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/pipeline_schedule/251029_2126_real_final2400_rank3.svg
[rank3]:> Batch Time: 493.14 ms, GPU Bubble Ratio: 59.48%, 54.94%, 66.40%, 15.39%
[rank0]:2025-10-29 21:26:29,713 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/frozen_params_histogram/251029_2126_rank0_stage0.svg
[rank0]:	> Counts Sum: 6075, Total Sum: 8695 (69.87%), Ratio(%) per element: [0.0, 96.17, 96.17, 96.17, 96.17, 96.17, 96.17, 96.17, 96.17, 96.17, 96.17, 96.17, 96.17, 96.17, 96.17, 96.17, 96.17, 96.17, 96.17, 94.89, 94.89, 94.89, 94.89, 94.89, 94.89, 94.89, 94.89, 94.89, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-10-29 21:26:29,713 - INFO - Sleeping 2 seconds for other ranks to complete
[rank2]:2025-10-29 21:26:29,725 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/frozen_params_histogram/251029_2126_rank2_stage2.svg
[rank2]:	> Counts Sum: 5130, Total Sum: 8460 (60.64%), Ratio(%) per element: [97.87, 97.87, 97.87, 97.87, 97.87, 97.87, 97.87, 97.87, 97.87, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 47.23, 47.23, 47.23, 47.23, 47.23, 47.23, 47.23, 47.23, 47.23, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-10-29 21:26:29,726 - INFO - Destroying the purge thread.
[rank1]:2025-10-29 21:26:29,696 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/frozen_params_histogram/251029_2126_rank1_stage1.svg
[rank1]:	> Counts Sum: 5076, Total Sum: 10575 (48.00%), Ratio(%) per element: [97.02, 97.02, 97.02, 97.02, 97.02, 97.02, 97.02, 97.02, 97.02, 96.59, 96.59, 96.59, 96.59, 96.59, 96.59, 96.59, 96.59, 96.59, 46.38, 46.38, 46.38, 46.38, 46.38, 46.38, 46.38, 46.38, 46.38, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-10-29 21:26:29,697 - INFO - Destroying the purge thread.
[rank1]:2025-10-29 21:26:29,780 - INFO - Process group destroyed
[rank3]:2025-10-29 21:26:29,792 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/pipeline_schedule/251029_2126_thry_final2400_rank3.svg
[rank3]:> Batch Time: 307.64 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:2025-10-29 21:26:29,864 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_2126_stage3_final2400.svg
[rank3]:2025-10-29 21:26:30,052 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1/frozen_params_histogram/251029_2126_rank3_stage3.svg
[rank3]:	> Counts Sum: 1053, Total Sum: 6815 (15.45%), Ratio(%) per element: [49.78, 49.78, 49.78, 49.78, 49.78, 49.78, 49.78, 49.78, 49.78, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-10-29 21:26:30,053 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank2]:2025-10-29 21:26:30,238 - INFO - Process group destroyed
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–„â–†â–ƒâ–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–ˆâ–†â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–ˆâ–†â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 1.15132
[rank3]:wandb:               final/avg_loss 0.21314
[rank3]:wandb:             final/avg_mfu(%) 16.76793
[rank3]:wandb:             final/avg_tflops 54.19164
[rank3]:wandb:    final/avg_throughput(tps) 7115.29945
[rank3]:wandb:              final/grad_norm 0.40955
[rank3]:wandb:               final/max_loss 0.21314
[rank3]:wandb:                    grad_norm 0.40955
[rank3]:wandb: loss_metrics/global_avg_loss 0.21314
[rank3]:wandb: loss_metrics/global_max_loss 0.21314
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1029_GPipe_auto_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/3gtlh194
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1029_GPipe_auto_dm1/20251029-2035/wandb/run-20251029_203525-3gtlh194/logs
[rank3]:2025-10-29 21:26:31,322 - INFO - Process group destroyed
[rank0]:2025-10-29 21:26:31,713 - INFO - Training completed
[rank0]:2025-10-29 21:26:31,714 - INFO - Destroying the purge thread.
[rank0]:2025-10-29 21:26:31,870 - INFO - Process group destroyed
[rank1]:Stage 1: Modules to keep: {'layers.6', 'layers.7', 'layers.8', 'layers.4', 'layers.5'}
[rank2]:Stage 2: Modules to keep: {'layers.9', 'layers.12', 'layers.11', 'layers.10'}
[rank0]:Stage 0: Modules to keep: {'layers.1', 'tok_embeddings', 'layers.2', 'layers.3', 'layers.0'}
[rank3]:Stage 3: Modules to keep: {'norm', 'layers.14', 'layers.13', 'layers.15', 'output'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1029_llama1b/config.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1029_GPipe_auto_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1029_GPipe_auto_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1029_GPipe_auto_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1029_GPipe_auto_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1029_GPipe_auto_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1029_GPipe_auto_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B-Instruct
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 1e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: alpaca
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 512
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 2400
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: GPipe
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 4
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1029_GPipe_auto_dm1
[rank3]:		- interval: 800
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B-Instruct/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1029_GPipe_auto_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: True
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: auto
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- aggressiveness: 0
[rank3]:
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
