
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 10. 29. (ìˆ˜) 22:09:24 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 3,4,5,6
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1029_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1029_llama1b/1029_GPipe_timelyapf.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
âœ”ï¸Running with timelyapf x GPipe ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1029_llama1b/config.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=timelyapf
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank3]:2025-10-29 22:09:30,877 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank1]:2025-10-29 22:09:30,877 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank2]:2025-10-29 22:09:30,911 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank0]:2025-10-29 22:09:31,197 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank2]:2025-10-29 22:09:31,458 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-10-29 22:09:31,460 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-10-29 22:09:31,447 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-10-29 22:09:31,448 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-10-29 22:09:31,443 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-10-29 22:09:31,446 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-29 22:09:31,507 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-10-29 22:09:31,510 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-29 22:09:31,513 - INFO - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-10-29 22:09:31,917 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-10-29 22:09:32,339 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank2]:2025-10-29 22:09:35,215 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-10-29 22:09:35,264 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-10-29 22:09:35,292 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-10-29 22:09:35,292 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2025-10-29 22:09:35,275 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-10-29 22:09:35,313 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-10-29 22:09:35,340 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-10-29 22:09:35,341 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank2]:2025-10-29 22:09:35,469 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-10-29 22:09:35,469 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-10-29 22:09:35,470 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank0]:2025-10-29 22:09:35,435 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=512, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank1]:2025-10-29 22:09:35,524 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-10-29 22:09:35,524 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-10-29 22:09:35,524 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank0]:2025-10-29 22:09:35,648 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-10-29 22:09:35,688 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-10-29 22:09:35,689 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-10-29 22:09:35,716 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-10-29 22:09:35,716 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-10-29 22:09:35,891 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-10-29 22:09:35,891 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-10-29 22:09:35,892 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run 2j7y6qzp
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1029_GPipe_timelyapf_dm1/20251029-2209/wandb/run-20251029_220936-2j7y6qzp
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1029_GPipe_timelyapf_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/2j7y6qzp
[rank3]:2025-10-29 22:09:37,671 - INFO - WandB logging enabled
[rank3]:2025-10-29 22:09:37,672 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-10-29 22:09:37,712 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-10-29 22:09:37,742 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-10-29 22:09:37,743 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank2]:2025-10-29 22:09:37,953 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-10-29 22:09:37,952 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1029_GPipe_timelyapf_dm1
[rank0]:2025-10-29 22:09:37,953 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-10-29 22:09:37,953 - INFO - Preparing c4_validation dataset from allenai/c4
[rank1]:2025-10-29 22:09:37,952 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-10-29 22:09:37,937 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-10-29 22:09:37,937 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-10-29 22:09:37,938 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2025-10-29 22:09:37,952 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-10-29 22:09:42,238 - INFO - Trainer is initialized with local batch size 32, global batch size 64, gradient accumulation steps 2, sequence length 512, total steps 2400 (warmup 100)
[rank0]:2025-10-29 22:09:42,238 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B-Instruct/original_dcp.
[rank0]:2025-10-29 22:09:45,626 - INFO - [GC] GC collection for checkpoint loading. 0.01 seconds
[rank0]:2025-10-29 22:09:45,626 - INFO - Finished loading the checkpoint in 3.39 seconds.
[rank0]:2025-10-29 22:09:45,626 - INFO - Training starts at step 1
[rank2]:2025-10-29 22:09:49,117 - INFO -  step:  1  loss: -2.0000  grad_norm: 85.2023  memory:  9.35GiB(19.67%)  tps: 591  tflops: 4.50  mfu: 1.44%
[rank2]:2025-10-29 22:09:49,118 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-10-29 22:09:49,155 - INFO -  step:  1  loss: -2.0000  grad_norm: 85.2023  memory: 12.28GiB(25.84%)  tps: 608  tflops: 4.63  mfu: 1.48%
[rank0]:2025-10-29 22:09:49,155 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-10-29 22:09:49,121 - INFO -  step:  1  loss: -2.0000  grad_norm: 85.2023  memory: 11.50GiB(24.20%)  tps: 593  tflops: 4.52  mfu: 1.45%
[rank1]:2025-10-29 22:09:49,121 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-29 22:09:49,127 - INFO -  step:  1  loss:  9.0164  grad_norm: 85.2023  memory: 23.19GiB(48.82%)  tps: 718  tflops: 5.47  mfu: 1.75%
[rank3]:2025-10-29 22:09:49,127 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-10-29 22:10:07,596 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 22:10:07,596 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 22:10:07,596 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 22:10:07,596 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 22:10:07,596 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 22:10:07,596 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 22:10:07,596 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 22:10:07,596 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 22:10:07,596 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 22:10:07,597 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 22:10:07,597 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 22:10:07,597 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 22:10:07,597 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 22:10:07,597 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 22:10:07,597 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 22:10:07,597 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 22:10:07,569 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 22:10:07,570 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 22:10:07,570 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 22:10:07,570 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 22:10:07,571 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 22:10:07,571 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 22:10:07,571 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 22:10:07,571 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 22:10:07,572 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 22:10:07,572 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 22:10:07,572 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 22:10:07,573 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 22:10:07,573 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 22:10:07,573 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 22:10:07,573 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 22:10:07,574 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 22:10:07,624 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 22:10:07,624 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 22:10:07,624 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 22:10:07,624 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 22:10:07,624 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 22:10:07,624 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 22:10:07,624 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 22:10:07,625 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 22:10:07,625 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 22:10:07,625 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 22:10:07,625 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 22:10:07,625 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 22:10:07,625 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 22:10:07,625 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 22:10:07,625 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 22:10:07,625 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 22:10:07,652 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 22:10:07,652 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 22:10:07,652 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 22:10:07,652 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 22:10:07,653 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 22:10:07,653 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 22:10:07,653 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 22:10:07,653 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 22:10:07,653 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 22:10:07,653 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 22:10:07,653 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 22:10:07,653 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 22:10:07,653 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 22:10:07,653 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 22:10:07,653 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 22:10:07,654 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 22:10:49,196 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 22:10:50,447 - INFO -  step: 50  loss: -2.0000  grad_norm: 35.3635  memory: 11.81GiB(24.85%)  tps: 6,545  tflops: 49.85  mfu: 15.98%
[rank0]:2025-10-29 22:10:50,462 - INFO -  step: 50  loss: -2.0000  grad_norm: 35.3635  memory: 16.57GiB(34.88%)  tps: 6,548  tflops: 49.87  mfu: 15.98%
[rank3]:2025-10-29 22:10:50,459 - INFO -  step: 50  loss:  8.4883  grad_norm: 35.3635  memory: 27.51GiB(57.90%)  tps: 6,545  tflops: 49.85  mfu: 15.98%
[rank1]:2025-10-29 22:10:50,450 - INFO -  step: 50  loss: -2.0000  grad_norm: 35.3635  memory: 14.64GiB(30.82%)  tps: 6,545  tflops: 49.85  mfu: 15.98%
[rank3]:2025-10-29 22:11:02,606 - INFO - [Step 60] ã€°ï¸ Monitoring Upperbound
[rank3]:2025-10-29 22:11:15,652 - WARNING - [Step 70] â³ Monitoring Upperbound... (140/150)
[rank0]:2025-10-29 22:11:15,918 - WARNING - [Step 70] â³ Monitoring Upperbound... (140/150)
[rank2]:2025-10-29 22:11:15,866 - WARNING - [Step 70] â³ Monitoring Upperbound... (140/150)
[rank1]:2025-10-29 22:11:15,892 - WARNING - [Step 70] â³ Monitoring Upperbound... (140/150)
[rank3]:2025-10-29 22:11:30,556 - INFO - [Step 80] âœ”ï¸  Setting Upperbound
[rank0]:2025-10-29 22:11:30,914 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 22:11:30,934 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 22:11:30,914 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 22:11:30,860 - INFO - [Step 80] ã€°ï¸ Monitoring Lowerbound
[rank1]:2025-10-29 22:11:30,927 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 22:11:30,947 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 22:11:30,957 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 22:11:30,967 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 22:11:33,441 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 22:11:33,447 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 22:11:33,478 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 22:11:33,514 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 22:11:33,469 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 22:11:33,486 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 22:11:33,502 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 22:11:33,510 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 22:11:33,530 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 22:11:33,486 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 22:11:33,522 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 22:11:33,551 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 22:11:33,634 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 22:11:33,567 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 22:11:33,614 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 22:11:33,651 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 22:11:33,652 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 22:11:33,675 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 22:11:33,714 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 22:11:33,675 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 22:11:33,716 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 22:11:33,692 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 22:11:33,733 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 22:11:33,755 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 22:11:33,774 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 22:11:51,901 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 22:11:52,701 - INFO -  step: 100  loss: -2.0000  grad_norm:  0.0000  memory: 16.57GiB(34.88%)  tps: 6,581  tflops: 50.12  mfu: 16.07%
[rank2]:2025-10-29 22:11:52,700 - INFO -  step: 100  loss: -2.0000  grad_norm:  0.0000  memory: 11.81GiB(24.85%)  tps: 6,580  tflops: 50.11  mfu: 16.06%
[rank1]:2025-10-29 22:11:52,700 - INFO -  step: 100  loss: -2.0000  grad_norm:  0.0000  memory: 14.64GiB(30.82%)  tps: 6,580  tflops: 50.11  mfu: 16.06%
[rank2]:2025-10-29 22:11:55,270 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_2211_stage2_step100.svg
[rank1]:2025-10-29 22:11:55,268 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_2211_stage1_step100.svg
[rank3]:2025-10-29 22:11:55,190 - INFO -  step: 100  loss:  7.9711  grad_norm:  0.0194  memory: 30.93GiB(65.10%)  tps: 6,328  tflops: 48.20  mfu: 15.45%
[rank0]:2025-10-29 22:11:55,271 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_2211_stage0_step100.svg
[rank0]:2025-10-29 22:11:55,325 - INFO - Avg. fwd time: 8.6898 / Avg. bwd time: 20.7990 / Avg. batch time: 626.5724 (ms) / GPU bubble ratio: 62.35%
[rank3]:2025-10-29 22:11:55,405 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/pipeline_schedule/251029_2211_real_step100_rank3.svg
[rank3]:> Batch Time: 518.26 ms, GPU Bubble Ratio: 51.98%, 50.16%, 61.43%, 18.29%
[rank3]:2025-10-29 22:11:55,475 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_2211_stage3_step100.svg
[rank3]:2025-10-29 22:11:55,674 - INFO - Avg. fwd time: 10.8992 / Avg. bwd time: 40.3051 / Avg. batch time: 482.2823 (ms) / GPU bubble ratio: 15.06%
[rank2]:2025-10-29 22:11:55,709 - INFO - Avg. fwd time: 7.0193 / Avg. bwd time: 17.0259 / Avg. batch time: 555.9568 (ms) / GPU bubble ratio: 65.40%
[rank1]:2025-10-29 22:11:55,754 - INFO - Avg. fwd time: 9.5901 / Avg. bwd time: 22.0231 / Avg. batch time: 592.7543 (ms) / GPU bubble ratio: 57.33%
[rank3]:2025-10-29 22:12:03,339 - INFO - [Step 110] âœ”ï¸  Setting Lowerbound
[rank3]:2025-10-29 22:12:03,720 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/pipeline_schedule/251029_2212_max_batch_time.svg
[rank3]:> Batch Time: 523.95 ms, GPU Bubble Ratio: 51.75%, 50.26%, 61.53%, 18.17%
[rank3]:2025-10-29 22:12:03,926 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/pipeline_schedule/251029_2212_min_batch_time.svg
[rank3]:> Batch Time: 302.42 ms, GPU Bubble Ratio: 78.81%, 48.77%, 60.47%, 15.62%
[rank3]:2025-10-29 22:12:04,148 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/pipeline_schedule/251029_2212_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 315.55 ms, GPU Bubble Ratio: 39.20%, 29.83%, 39.41%, 14.97%
[rank3]:2025-10-29 22:12:04,148 - INFO - 	> Batch Time: 315.55 ms (Average Freeze Ratio: 0.43, Time Reduction Rate: 0.40)
[rank0]:2025-10-29 22:12:49,153 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 22:12:50,053 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.67/1.00
[rank1]:2025-10-29 22:12:50,053 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.13/0.19, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.38/0.57, [MB5] 0.09/0.13, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank1]:2025-10-29 22:12:50,053 - INFO -  step: 150  loss: -2.0000  grad_norm:  1.6954  memory: 14.64GiB(30.82%)  tps: 7,142  tflops: 54.39  mfu: 17.43%
[rank0]:2025-10-29 22:12:50,051 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.22/0.33, [MB4] 0.00/0.00, [MB5] 0.43/0.64, [MB6] 0.38/0.56, [MB7] 0.67/1.00
[rank0]:2025-10-29 22:12:50,052 - INFO -  step: 150  loss: -2.0000  grad_norm:  1.6954  memory: 16.79GiB(35.34%)  tps: 7,142  tflops: 54.40  mfu: 17.43%
[rank2]:2025-10-29 22:12:50,053 - INFO -  step: 150  loss: -2.0000  grad_norm:  1.6954  memory: 11.94GiB(25.14%)  tps: 7,142  tflops: 54.39  mfu: 17.43%
[rank3]:2025-10-29 22:12:52,503 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.13/0.20, [MB1] 0.67/1.00, [MB2] 0.67/1.00, [MB3] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank3]:2025-10-29 22:12:52,506 - INFO -  step: 150  loss:  5.0116  grad_norm:  1.6954  memory: 30.93GiB(65.10%)  tps: 7,147  tflops: 54.43  mfu: 17.45%
[rank0]:2025-10-29 22:13:45,436 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 22:13:46,284 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.33/0.33, [MB4] 0.00/0.00, [MB5] 0.64/0.64, [MB6] 0.56/0.56, [MB7] 1.00/1.00
[rank0]:2025-10-29 22:13:46,284 - INFO -  step: 200  loss: -2.0000  grad_norm:  0.0816  memory: 16.79GiB(35.34%)  tps: 7,284  tflops: 55.48  mfu: 17.78%
[rank0]:2025-10-29 22:13:46,284 - INFO - ðŸ”Ž  Running validation at step 200
[rank2]:2025-10-29 22:13:46,282 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-29 22:13:46,283 - INFO -  step: 200  loss: -2.0000  grad_norm:  0.0816  memory: 12.04GiB(25.35%)  tps: 7,284  tflops: 55.48  mfu: 17.78%
[rank2]:2025-10-29 22:13:46,283 - INFO - ðŸ”Ž  Running validation at step 200
[rank1]:2025-10-29 22:13:46,283 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.19/0.19, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.57/0.57, [MB5] 0.13/0.13, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 22:13:46,283 - INFO -  step: 200  loss: -2.0000  grad_norm:  0.0816  memory: 14.91GiB(31.39%)  tps: 7,284  tflops: 55.48  mfu: 17.78%
[rank1]:2025-10-29 22:13:46,283 - INFO - ðŸ”Ž  Running validation at step 200
[rank3]:2025-10-29 22:13:48,759 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.20/0.20, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 22:13:48,763 - INFO -  step: 200  loss:  3.7614  grad_norm:  0.0816  memory: 30.93GiB(65.10%)  tps: 7,281  tflops: 55.46  mfu: 17.77%
[rank3]:2025-10-29 22:13:48,763 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-10-29 22:14:11,724 - INFO - validate step: 200  loss: -1.0000  memory: 16.79GiB(35.34%)  tps: 16,101
[rank1]:2025-10-29 22:14:11,745 - INFO - validate step: 200  loss: -1.0000  memory: 14.91GiB(31.39%)  tps: 16,087
[rank3]:2025-10-29 22:14:11,756 - INFO - validate step: 200  loss:  2.1585  memory: 30.93GiB(65.10%)  tps: 17,814
[rank0]:2025-10-29 22:14:11,844 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_2214_stage0_step200.svg
[rank2]:2025-10-29 22:14:11,769 - INFO - validate step: 200  loss: -1.0000  memory: 12.04GiB(25.35%)  tps: 16,072
[rank2]:2025-10-29 22:14:11,844 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_2214_stage2_step200.svg
[rank1]:2025-10-29 22:14:11,847 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_2214_stage1_step200.svg
[rank3]:2025-10-29 22:14:11,962 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/pipeline_schedule/251029_2214_real_step200_rank3.svg
[rank3]:> Batch Time: 375.30 ms, GPU Bubble Ratio: 47.65%, 44.05%, 55.78%, 20.10%
[rank3]:2025-10-29 22:14:12,028 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_2214_stage3_step200.svg
[rank3]:2025-10-29 22:14:12,231 - INFO - Avg. fwd time: 12.0611 / Avg. bwd time: 30.9452 / Avg. batch time: 410.6033 (ms) / GPU bubble ratio: 16.21%
[rank0]:2025-10-29 22:14:12,264 - INFO - Avg. fwd time: 8.8325 / Avg. bwd time: 14.1217 / Avg. batch time: 575.8899 (ms) / GPU bubble ratio: 68.11%
[rank2]:2025-10-29 22:14:12,282 - INFO - Avg. fwd time: 7.5850 / Avg. bwd time: 13.7622 / Avg. batch time: 517.0994 (ms) / GPU bubble ratio: 66.97%
[rank1]:2025-10-29 22:14:12,317 - INFO - Avg. fwd time: 10.1841 / Avg. bwd time: 17.3440 / Avg. batch time: 549.0193 (ms) / GPU bubble ratio: 59.89%
[rank0]:2025-10-29 22:15:01,153 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-29 22:15:01,949 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.33/0.33, [MB4] 0.00/0.00, [MB5] 0.64/0.64, [MB6] 0.56/0.56, [MB7] 1.00/1.00
[rank0]:2025-10-29 22:15:01,950 - INFO -  step: 250  loss: -2.0000  grad_norm:  0.0000  memory: 16.79GiB(35.34%)  tps: 8,155  tflops: 62.11  mfu: 19.91%
[rank1]:2025-10-29 22:15:01,949 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.19/0.19, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.57/0.57, [MB5] 0.13/0.13, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 22:15:01,950 - INFO -  step: 250  loss: -2.0000  grad_norm:  0.0000  memory: 14.91GiB(31.39%)  tps: 8,159  tflops: 62.14  mfu: 19.92%
[rank2]:2025-10-29 22:15:01,948 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-29 22:15:01,949 - INFO -  step: 250  loss: -2.0000  grad_norm:  0.0000  memory: 12.04GiB(25.35%)  tps: 8,163  tflops: 62.17  mfu: 19.93%
[rank3]:2025-10-29 22:15:04,378 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.20/0.20, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 22:15:04,382 - INFO -  step: 250  loss:  5.1799  grad_norm:  0.0000  memory: 30.93GiB(65.10%)  tps: 7,784  tflops: 59.28  mfu: 19.00%
[rank0]:2025-10-29 22:15:53,462 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 22:15:54,391 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_2215_rank1_trend_line.svg
[rank1]:2025-10-29 22:15:54,399 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 22:15:54,387 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_2215_rank0_trend_line.svg
[rank0]:2025-10-29 22:15:54,398 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 22:15:54,400 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 22:15:54,400 - INFO -  step: 300  loss: -2.0000  grad_norm:  0.0000  memory: 16.79GiB(35.34%)  tps: 7,809  tflops: 59.48  mfu: 19.06%
[rank2]:2025-10-29 22:15:54,376 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_2215_rank2_trend_line.svg
[rank2]:2025-10-29 22:15:54,398 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-29 22:15:54,400 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-29 22:15:54,400 - INFO -  step: 300  loss: -2.0000  grad_norm:  0.0000  memory: 12.04GiB(25.35%)  tps: 7,809  tflops: 59.48  mfu: 19.06%
[rank3]:2025-10-29 22:15:54,381 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_2215_rank3_trend_line.svg
[rank1]:2025-10-29 22:15:54,400 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 22:15:54,401 - INFO -  step: 300  loss: -2.0000  grad_norm:  0.0000  memory: 14.91GiB(31.39%)  tps: 7,809  tflops: 59.48  mfu: 19.06%
[rank3]:2025-10-29 22:15:54,604 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/pipeline_schedule/251029_2215_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 311.61 ms, GPU Bubble Ratio: 64.67%, 45.21%, 57.16%, 16.65%
[rank3]:2025-10-29 22:15:54,605 - INFO - 	> Batch Time: 311.61 ms (Average Freeze Ratio: 0.32)
[rank3]:2025-10-29 22:15:54,605 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 0.20/0.20
[rank3]:2025-10-29 22:15:57,090 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 0.20/0.20
[rank3]:2025-10-29 22:15:57,094 - INFO -  step: 300  loss:  5.5266  grad_norm:  0.0000  memory: 30.93GiB(65.10%)  tps: 7,771  tflops: 59.18  mfu: 18.97%
[rank1]:2025-10-29 22:15:57,164 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_2215_stage1_step300.svg
[rank0]:2025-10-29 22:15:57,162 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_2215_stage0_step300.svg
[rank2]:2025-10-29 22:15:57,162 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_2215_stage2_step300.svg
[rank3]:2025-10-29 22:15:57,282 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/pipeline_schedule/251029_2215_real_step300_rank3.svg
[rank3]:> Batch Time: 339.31 ms, GPU Bubble Ratio: 60.67%, 46.10%, 58.04%, 17.19%
[rank3]:2025-10-29 22:15:57,348 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_2215_stage3_step300.svg
[rank3]:2025-10-29 22:15:57,693 - INFO - Avg. fwd time: 12.5061 / Avg. bwd time: 27.4371 / Avg. batch time: 383.5508 (ms) / GPU bubble ratio: 16.69%
[rank1]:2025-10-29 22:15:57,725 - INFO - Avg. fwd time: 10.4134 / Avg. bwd time: 14.9465 / Avg. batch time: 526.0457 (ms) / GPU bubble ratio: 61.43%
[rank0]:2025-10-29 22:15:57,729 - INFO - Avg. fwd time: 8.9233 / Avg. bwd time: 9.3238 / Avg. batch time: 547.9335 (ms) / GPU bubble ratio: 73.36%
[rank2]:2025-10-29 22:15:57,709 - INFO - Avg. fwd time: 7.8786 / Avg. bwd time: 11.7857 / Avg. batch time: 496.6655 (ms) / GPU bubble ratio: 68.33%
[rank0]:2025-10-29 22:16:51,039 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 22:16:51,934 - INFO -  step: 350  loss: -2.0000  grad_norm:  0.0000  memory: 16.79GiB(35.34%)  tps: 7,119  tflops: 54.22  mfu: 17.38%
[rank1]:2025-10-29 22:16:51,935 - INFO -  step: 350  loss: -2.0000  grad_norm:  0.0000  memory: 14.91GiB(31.39%)  tps: 7,119  tflops: 54.22  mfu: 17.38%
[rank2]:2025-10-29 22:16:51,934 - INFO -  step: 350  loss: -2.0000  grad_norm:  0.0000  memory: 12.04GiB(25.35%)  tps: 7,119  tflops: 54.22  mfu: 17.38%
[rank3]:2025-10-29 22:16:54,588 - INFO -  step: 350  loss:  4.2574  grad_norm:  0.3555  memory: 30.93GiB(65.10%)  tps: 7,124  tflops: 54.26  mfu: 17.39%
[rank0]:2025-10-29 22:17:48,001 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 22:17:49,050 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_2217_rank2_trend_line.svg
[rank3]:2025-10-29 22:17:49,044 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_2217_rank3_trend_line.svg
[rank0]:2025-10-29 22:17:49,061 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_2217_rank0_trend_line.svg
[rank0]:2025-10-29 22:17:49,072 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 22:17:49,074 - INFO -  step: 400  loss: -2.0000  grad_norm:  0.0000  memory: 16.79GiB(35.34%)  tps: 7,168  tflops: 54.60  mfu: 17.50%
[rank0]:2025-10-29 22:17:49,074 - INFO - ðŸ”Ž  Running validation at step 400
[rank2]:2025-10-29 22:17:49,073 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-29 22:17:49,074 - INFO -  step: 400  loss: -2.0000  grad_norm:  0.0000  memory: 12.04GiB(25.35%)  tps: 7,168  tflops: 54.60  mfu: 17.50%
[rank2]:2025-10-29 22:17:49,075 - INFO - ðŸ”Ž  Running validation at step 400
[rank1]:2025-10-29 22:17:49,066 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_2217_rank1_trend_line.svg
[rank1]:2025-10-29 22:17:49,073 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 22:17:49,075 - INFO -  step: 400  loss: -2.0000  grad_norm:  0.0000  memory: 14.91GiB(31.39%)  tps: 7,168  tflops: 54.60  mfu: 17.50%
[rank1]:2025-10-29 22:17:49,075 - INFO - ðŸ”Ž  Running validation at step 400
[rank3]:2025-10-29 22:17:49,268 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/pipeline_schedule/251029_2217_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 325.06 ms, GPU Bubble Ratio: 72.06%, 49.58%, 60.52%, 15.83%
[rank3]:2025-10-29 22:17:49,268 - INFO - 	> Batch Time: 325.06 ms (Average Freeze Ratio: 0.32)
[rank3]:2025-10-29 22:17:49,269 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 0.20/0.20
[rank3]:2025-10-29 22:17:51,823 - INFO -  step: 400  loss:  3.7117  grad_norm:  0.0295  memory: 30.93GiB(65.10%)  tps: 7,157  tflops: 54.51  mfu: 17.47%
[rank3]:2025-10-29 22:17:51,823 - INFO - ðŸ”Ž  Running validation at step 400
[rank2]:2025-10-29 22:18:11,943 - INFO - validate step: 400  loss: -1.0000  memory: 12.04GiB(25.35%)  tps: 17,912
[rank0]:2025-10-29 22:18:11,904 - INFO - validate step: 400  loss: -1.0000  memory: 16.79GiB(35.34%)  tps: 17,942
[rank1]:2025-10-29 22:18:11,926 - INFO - validate step: 400  loss: -1.0000  memory: 14.91GiB(31.39%)  tps: 17,925
[rank3]:2025-10-29 22:18:11,934 - INFO - validate step: 400  loss:  1.9808  memory: 30.93GiB(65.10%)  tps: 20,368
[rank2]:2025-10-29 22:18:12,021 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_2218_stage2_step400.svg
[rank0]:2025-10-29 22:18:12,021 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_2218_stage0_step400.svg
[rank0]:2025-10-29 22:18:12,078 - INFO - Avg. fwd time: 8.9606 / Avg. bwd time: 7.1753 / Avg. batch time: 550.2494 (ms) / GPU bubble ratio: 76.54%
[rank1]:2025-10-29 22:18:12,023 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_2218_stage1_step400.svg
[rank3]:2025-10-29 22:18:12,131 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/pipeline_schedule/251029_2218_real_step400_rank3.svg
[rank3]:> Batch Time: 343.46 ms, GPU Bubble Ratio: 78.94%, 50.44%, 61.52%, 13.70%
[rank3]:2025-10-29 22:18:12,204 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_2218_stage3_step400.svg
[rank2]:2025-10-29 22:18:12,446 - INFO - Avg. fwd time: 8.0047 / Avg. bwd time: 10.9287 / Avg. batch time: 502.3390 (ms) / GPU bubble ratio: 69.85%
[rank3]:2025-10-29 22:18:12,451 - INFO - Avg. fwd time: 12.4899 / Avg. bwd time: 27.3178 / Avg. batch time: 381.4131 (ms) / GPU bubble ratio: 16.50%
[rank1]:2025-10-29 22:18:12,503 - INFO - Avg. fwd time: 10.5093 / Avg. bwd time: 13.9043 / Avg. batch time: 530.6030 (ms) / GPU bubble ratio: 63.19%
[rank0]:2025-10-29 22:19:05,786 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-29 22:19:06,667 - INFO -  step: 450  loss: -2.0000  grad_norm:  0.0000  memory: 16.79GiB(35.34%)  tps: 7,480  tflops: 56.97  mfu: 18.26%
[rank1]:2025-10-29 22:19:06,667 - INFO -  step: 450  loss: -2.0000  grad_norm:  0.0000  memory: 14.91GiB(31.39%)  tps: 7,483  tflops: 56.99  mfu: 18.27%
[rank2]:2025-10-29 22:19:06,667 - INFO -  step: 450  loss: -2.0000  grad_norm:  0.0000  memory: 12.04GiB(25.35%)  tps: 7,485  tflops: 57.01  mfu: 18.27%
[rank3]:2025-10-29 22:19:09,208 - INFO -  step: 450  loss:  3.9682  grad_norm:  0.4562  memory: 30.93GiB(65.10%)  tps: 7,152  tflops: 54.47  mfu: 17.46%
[rank0]:2025-10-29 22:20:02,591 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 22:20:03,475 - INFO -  step: 500  loss: -2.0000  grad_norm:  0.0000  memory: 14.91GiB(31.39%)  tps: 7,210  tflops: 54.92  mfu: 17.60%
[rank0]:2025-10-29 22:20:03,475 - INFO -  step: 500  loss: -2.0000  grad_norm:  0.0000  memory: 16.79GiB(35.34%)  tps: 7,210  tflops: 54.92  mfu: 17.60%
[rank2]:2025-10-29 22:20:03,475 - INFO -  step: 500  loss: -2.0000  grad_norm:  0.0000  memory: 12.04GiB(25.35%)  tps: 7,210  tflops: 54.92  mfu: 17.60%
[rank3]:2025-10-29 22:20:05,925 - INFO -  step: 500  loss:  3.7709  grad_norm:  0.2841  memory: 30.93GiB(65.10%)  tps: 7,222  tflops: 55.00  mfu: 17.63%
[rank1]:2025-10-29 22:20:06,007 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_2220_stage1_step500.svg
[rank0]:2025-10-29 22:20:06,002 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_2220_stage0_step500.svg
[rank2]:2025-10-29 22:20:06,002 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_2220_stage2_step500.svg
[rank3]:2025-10-29 22:20:06,124 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/pipeline_schedule/251029_2220_real_step500_rank3.svg
[rank3]:> Batch Time: 354.86 ms, GPU Bubble Ratio: 79.57%, 52.02%, 62.74%, 13.23%
[rank0]:2025-10-29 22:20:06,058 - INFO - Avg. fwd time: 8.9882 / Avg. bwd time: 5.6553 / Avg. batch time: 548.0259 (ms) / GPU bubble ratio: 78.62%
[rank3]:2025-10-29 22:20:06,189 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_2220_stage3_step500.svg
[rank3]:2025-10-29 22:20:06,430 - INFO - Avg. fwd time: 12.4744 / Avg. bwd time: 27.3041 / Avg. batch time: 380.4350 (ms) / GPU bubble ratio: 16.35%
[rank2]:2025-10-29 22:20:06,427 - INFO - Avg. fwd time: 8.0941 / Avg. bwd time: 10.3255 / Avg. batch time: 502.4814 (ms) / GPU bubble ratio: 70.67%
[rank1]:2025-10-29 22:20:06,479 - INFO - Avg. fwd time: 10.5777 / Avg. bwd time: 13.1709 / Avg. batch time: 529.9606 (ms) / GPU bubble ratio: 64.15%
[rank0]:2025-10-29 22:20:59,510 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 22:21:00,404 - INFO -  step: 550  loss: -2.0000  grad_norm:  0.0000  memory: 14.91GiB(31.39%)  tps: 7,195  tflops: 54.80  mfu: 17.56%
[rank2]:2025-10-29 22:21:00,403 - INFO -  step: 550  loss: -2.0000  grad_norm:  0.0000  memory: 12.04GiB(25.35%)  tps: 7,195  tflops: 54.80  mfu: 17.56%
[rank0]:2025-10-29 22:21:00,404 - INFO -  step: 550  loss: -2.0000  grad_norm:  0.0000  memory: 16.79GiB(35.34%)  tps: 7,195  tflops: 54.80  mfu: 17.56%
[rank3]:2025-10-29 22:21:02,852 - INFO -  step: 550  loss:  3.5861  grad_norm:  0.0914  memory: 30.93GiB(65.10%)  tps: 7,196  tflops: 54.80  mfu: 17.56%
[rank0]:2025-10-29 22:21:56,603 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 22:21:57,729 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_2221_rank0_trend_line.svg
[rank0]:2025-10-29 22:21:57,739 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank0]:2025-10-29 22:21:57,741 - INFO -  step: 600  loss: -2.0000  grad_norm:  0.0000  memory: 16.79GiB(35.34%)  tps: 7,144  tflops: 54.41  mfu: 17.44%
[rank0]:2025-10-29 22:21:57,741 - INFO - ðŸ”Ž  Running validation at step 600
[rank3]:2025-10-29 22:21:57,701 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_2221_rank3_trend_line.svg
[rank1]:2025-10-29 22:21:57,732 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_2221_rank1_trend_line.svg
[rank1]:2025-10-29 22:21:57,739 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank1]:2025-10-29 22:21:57,741 - INFO -  step: 600  loss: -2.0000  grad_norm:  0.0000  memory: 14.91GiB(31.39%)  tps: 7,144  tflops: 54.41  mfu: 17.44%
[rank1]:2025-10-29 22:21:57,741 - INFO - ðŸ”Ž  Running validation at step 600
[rank2]:2025-10-29 22:21:57,719 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_2221_rank2_trend_line.svg
[rank2]:2025-10-29 22:21:57,739 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-29 22:21:57,741 - INFO -  step: 600  loss: -2.0000  grad_norm:  0.0000  memory: 12.04GiB(25.35%)  tps: 7,144  tflops: 54.41  mfu: 17.44%
[rank2]:2025-10-29 22:21:57,741 - INFO - ðŸ”Ž  Running validation at step 600
[rank3]:2025-10-29 22:21:57,937 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/pipeline_schedule/251029_2221_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 336.23 ms, GPU Bubble Ratio: 76.50%, 52.46%, 62.89%, 14.88%
[rank3]:2025-10-29 22:21:57,938 - INFO - 	> Batch Time: 336.23 ms (Average Freeze Ratio: 0.26)
[rank3]:2025-10-29 22:21:57,938 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 0.20/0.20
[rank3]:2025-10-29 22:22:00,383 - INFO -  step: 600  loss:  3.6561  grad_norm:  0.0725  memory: 30.93GiB(65.10%)  tps: 7,120  tflops: 54.23  mfu: 17.38%
[rank3]:2025-10-29 22:22:00,384 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-10-29 22:22:20,364 - INFO - validate step: 600  loss: -1.0000  memory: 16.79GiB(35.34%)  tps: 18,106
[rank3]:2025-10-29 22:22:20,396 - INFO - validate step: 600  loss:  1.9055  memory: 30.93GiB(65.10%)  tps: 20,469
[rank1]:2025-10-29 22:22:20,385 - INFO - validate step: 600  loss: -1.0000  memory: 14.91GiB(31.39%)  tps: 18,089
[rank2]:2025-10-29 22:22:20,405 - INFO - validate step: 600  loss: -1.0000  memory: 12.04GiB(25.35%)  tps: 18,073
[rank0]:2025-10-29 22:22:20,478 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_2222_stage0_step600.svg
[rank1]:2025-10-29 22:22:20,479 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_2222_stage1_step600.svg
[rank2]:2025-10-29 22:22:20,477 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_2222_stage2_step600.svg
[rank3]:2025-10-29 22:22:20,591 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/pipeline_schedule/251029_2222_real_step600_rank3.svg
[rank3]:> Batch Time: 357.99 ms, GPU Bubble Ratio: 79.74%, 52.46%, 63.08%, 13.09%
[rank3]:2025-10-29 22:22:20,657 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_2222_stage3_step600.svg
[rank0]:2025-10-29 22:22:21,110 - INFO - Avg. fwd time: 9.0040 / Avg. bwd time: 4.6668 / Avg. batch time: 546.7360 (ms) / GPU bubble ratio: 80.00%
[rank3]:2025-10-29 22:22:21,072 - INFO - Avg. fwd time: 12.4533 / Avg. bwd time: 27.3348 / Avg. batch time: 380.0303 (ms) / GPU bubble ratio: 16.24%
[rank1]:2025-10-29 22:22:21,103 - INFO - Avg. fwd time: 10.6202 / Avg. bwd time: 12.6901 / Avg. batch time: 529.6995 (ms) / GPU bubble ratio: 64.79%
[rank2]:2025-10-29 22:22:21,087 - INFO - Avg. fwd time: 8.1510 / Avg. bwd time: 9.9294 / Avg. batch time: 502.7327 (ms) / GPU bubble ratio: 71.23%
[rank0]:2025-10-29 22:23:20,452 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-29 22:23:21,490 - INFO -  step: 650  loss: -2.0000  grad_norm:  2.0880  memory: 16.79GiB(35.34%)  tps: 6,701  tflops: 51.04  mfu: 16.36%
[rank1]:2025-10-29 22:23:21,478 - INFO -  step: 650  loss: -2.0000  grad_norm:  2.0880  memory: 14.91GiB(31.39%)  tps: 6,705  tflops: 51.06  mfu: 16.37%
[rank2]:2025-10-29 22:23:21,461 - INFO -  step: 650  loss: -2.0000  grad_norm:  0.0000  memory: 12.04GiB(25.35%)  tps: 6,709  tflops: 51.09  mfu: 16.38%
[rank3]:2025-10-29 22:23:23,913 - INFO -  step: 650  loss:  3.5977  grad_norm:  2.0880  memory: 30.93GiB(65.10%)  tps: 6,449  tflops: 49.12  mfu: 15.74%
[rank0]:2025-10-29 22:24:23,506 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 22:24:24,542 - INFO -  step: 700  loss: -2.0000  grad_norm:  8.9086  memory: 16.79GiB(35.34%)  tps: 6,496  tflops: 49.48  mfu: 15.86%
[rank1]:2025-10-29 22:24:24,531 - INFO -  step: 700  loss: -2.0000  grad_norm:  8.9086  memory: 14.91GiB(31.39%)  tps: 6,496  tflops: 49.48  mfu: 15.86%
[rank2]:2025-10-29 22:24:24,514 - INFO -  step: 700  loss: -2.0000  grad_norm:  0.0000  memory: 12.04GiB(25.35%)  tps: 6,496  tflops: 49.48  mfu: 15.86%
[rank3]:2025-10-29 22:24:26,960 - INFO -  step: 700  loss:  3.6422  grad_norm:  8.9086  memory: 30.93GiB(65.10%)  tps: 6,497  tflops: 49.48  mfu: 15.86%
[rank0]:2025-10-29 22:24:27,037 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_2224_stage0_step700.svg
[rank1]:2025-10-29 22:24:27,047 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_2224_stage1_step700.svg
[rank2]:2025-10-29 22:24:27,037 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_2224_stage2_step700.svg
[rank3]:2025-10-29 22:24:27,151 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/pipeline_schedule/251029_2224_real_step700_rank3.svg
[rank3]:> Batch Time: 359.15 ms, GPU Bubble Ratio: 79.86%, 52.63%, 63.23%, 13.06%
[rank3]:2025-10-29 22:24:27,221 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_2224_stage3_step700.svg
[rank3]:2025-10-29 22:24:27,464 - INFO - Avg. fwd time: 12.4407 / Avg. bwd time: 27.3155 / Avg. batch time: 379.4725 (ms) / GPU bubble ratio: 16.19%
[rank2]:2025-10-29 22:24:27,460 - INFO - Avg. fwd time: 8.1859 / Avg. bwd time: 9.6831 / Avg. batch time: 504.4862 (ms) / GPU bubble ratio: 71.66%
[rank0]:2025-10-29 22:24:27,574 - INFO - Avg. fwd time: 8.8734 / Avg. bwd time: 7.1594 / Avg. batch time: 554.2105 (ms) / GPU bubble ratio: 76.86%
[rank1]:2025-10-29 22:24:27,567 - INFO - Avg. fwd time: 10.3937 / Avg. bwd time: 14.3156 / Avg. batch time: 534.5600 (ms) / GPU bubble ratio: 63.02%
[rank0]:2025-10-29 22:25:26,828 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 22:25:27,867 - INFO -  step: 750  loss: -2.0000  grad_norm:  6.1179  memory: 14.91GiB(31.39%)  tps: 6,467  tflops: 49.26  mfu: 15.79%
[rank2]:2025-10-29 22:25:27,850 - INFO -  step: 750  loss: -2.0000  grad_norm:  0.0000  memory: 12.04GiB(25.35%)  tps: 6,467  tflops: 49.26  mfu: 15.79%
[rank0]:2025-10-29 22:25:27,878 - INFO -  step: 750  loss: -2.0000  grad_norm:  6.1179  memory: 16.79GiB(35.34%)  tps: 6,467  tflops: 49.26  mfu: 15.79%
[rank3]:2025-10-29 22:25:30,360 - INFO -  step: 750  loss:  3.5829  grad_norm:  6.1179  memory: 30.93GiB(65.10%)  tps: 6,461  tflops: 49.21  mfu: 15.77%
[rank0]:2025-10-29 22:26:30,032 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 22:26:31,251 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_2226_rank2_trend_line.svg
[rank3]:2025-10-29 22:26:31,260 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_2226_rank3_trend_line.svg
[rank1]:2025-10-29 22:26:31,279 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_2226_rank1_trend_line.svg
[rank1]:2025-10-29 22:26:31,308 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 22:26:31,310 - INFO -  step: 800  loss: -2.0000  grad_norm:  0.7337  memory: 14.91GiB(31.39%)  tps: 6,456  tflops: 49.17  mfu: 15.76%
[rank1]:2025-10-29 22:26:31,311 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-10-29 22:26:31,302 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_2226_rank0_trend_line.svg
[rank0]:2025-10-29 22:26:31,308 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 22:26:31,310 - INFO -  step: 800  loss: -2.0000  grad_norm:  0.7337  memory: 16.79GiB(35.34%)  tps: 6,457  tflops: 49.18  mfu: 15.76%
[rank0]:2025-10-29 22:26:31,310 - INFO - ðŸ”Ž  Running validation at step 800
[rank2]:2025-10-29 22:26:31,308 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-29 22:26:31,310 - INFO -  step: 800  loss: -2.0000  grad_norm:  0.0000  memory: 12.04GiB(25.35%)  tps: 6,454  tflops: 49.16  mfu: 15.76%
[rank2]:2025-10-29 22:26:31,310 - INFO - ðŸ”Ž  Running validation at step 800
[rank3]:2025-10-29 22:26:31,503 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/pipeline_schedule/251029_2226_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 338.85 ms, GPU Bubble Ratio: 61.77%, 43.10%, 63.66%, 14.05%
[rank3]:2025-10-29 22:26:31,504 - INFO - 	> Batch Time: 338.85 ms (Average Freeze Ratio: 0.32)
[rank3]:2025-10-29 22:26:31,504 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 0.20/0.20
[rank3]:2025-10-29 22:26:34,028 - INFO -  step: 800  loss:  3.5670  grad_norm:  0.7337  memory: 30.93GiB(65.10%)  tps: 6,434  tflops: 49.00  mfu: 15.70%
[rank3]:2025-10-29 22:26:34,028 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-10-29 22:26:54,217 - INFO - validate step: 800  loss: -1.0000  memory: 16.79GiB(35.34%)  tps: 17,881
[rank0]:2025-10-29 22:26:54,218 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-29 22:26:54,226 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank3]:2025-10-29 22:26:54,245 - INFO - validate step: 800  loss:  1.8867  memory: 30.93GiB(65.10%)  tps: 20,262
[rank3]:2025-10-29 22:26:54,245 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-29 22:26:54,236 - INFO - validate step: 800  loss: -1.0000  memory: 14.91GiB(31.39%)  tps: 17,866
[rank1]:2025-10-29 22:26:54,237 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-29 22:26:54,252 - INFO - validate step: 800  loss: -1.0000  memory: 12.04GiB(25.35%)  tps: 17,854
[rank2]:2025-10-29 22:26:54,253 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-29 22:26:56,171 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 1.92 seconds.
[rank1]:2025-10-29 22:26:56,482 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 2.25 seconds.
[rank3]:2025-10-29 22:26:57,460 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.21 seconds.
[rank0]:2025-10-29 22:26:57,981 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-29 22:26:57,989 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.77 seconds.
[rank1]:2025-10-29 22:26:58,078 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_2226_stage1_step800.svg
[rank2]:2025-10-29 22:26:58,075 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_2226_stage2_step800.svg
[rank0]:2025-10-29 22:26:58,267 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_2226_stage0_step800.svg
[rank3]:2025-10-29 22:26:58,332 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/pipeline_schedule/251029_2226_real_step800_rank3.svg
[rank3]:> Batch Time: 359.58 ms, GPU Bubble Ratio: 79.97%, 52.72%, 63.29%, 13.07%
[rank3]:2025-10-29 22:26:58,407 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_2226_stage3_step800.svg
[rank3]:2025-10-29 22:26:58,720 - INFO - Avg. fwd time: 12.4251 / Avg. bwd time: 27.2788 / Avg. batch time: 378.7826 (ms) / GPU bubble ratio: 16.14%
[rank2]:2025-10-29 22:26:58,716 - INFO - Avg. fwd time: 8.2155 / Avg. bwd time: 9.4659 / Avg. batch time: 503.6737 (ms) / GPU bubble ratio: 71.92%
[rank0]:2025-10-29 22:26:58,833 - INFO - Avg. fwd time: 8.7608 / Avg. bwd time: 9.3602 / Avg. batch time: 558.5436 (ms) / GPU bubble ratio: 74.05%
[rank1]:2025-10-29 22:26:58,823 - INFO - Avg. fwd time: 10.1947 / Avg. bwd time: 15.7512 / Avg. batch time: 536.5815 (ms) / GPU bubble ratio: 61.32%
[rank3]:2025-10-29 22:27:11,392 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-29 22:27:11,404 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-29 22:27:11,422 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-29 22:27:11,418 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-29 22:27:54,507 - INFO - [GC] Peforming periodical GC collection 0.29 seconds
[rank0]:2025-10-29 22:27:55,389 - INFO -  step: 850  loss: -2.0000  grad_norm:  0.0000  memory: 16.79GiB(35.34%)  tps: 6,696  tflops: 51.00  mfu: 16.35%
[rank1]:2025-10-29 22:27:55,389 - INFO -  step: 850  loss: -2.0000  grad_norm:  0.0000  memory: 15.73GiB(33.12%)  tps: 6,698  tflops: 51.01  mfu: 16.35%
[rank2]:2025-10-29 22:27:55,389 - INFO -  step: 850  loss: -2.0000  grad_norm:  0.0000  memory: 12.04GiB(25.35%)  tps: 6,700  tflops: 51.03  mfu: 16.35%
[rank3]:2025-10-29 22:27:57,896 - INFO -  step: 850  loss:  3.6547  grad_norm:  0.3774  memory: 30.93GiB(65.10%)  tps: 6,435  tflops: 49.01  mfu: 15.71%
[rank0]:2025-10-29 22:28:50,869 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 22:28:51,756 - INFO -  step: 900  loss: -2.0000  grad_norm:  0.0000  memory: 12.04GiB(25.35%)  tps: 7,267  tflops: 55.35  mfu: 17.74%
[rank0]:2025-10-29 22:28:51,756 - INFO -  step: 900  loss: -2.0000  grad_norm:  0.0000  memory: 16.79GiB(35.34%)  tps: 7,267  tflops: 55.35  mfu: 17.74%
[rank1]:2025-10-29 22:28:51,756 - INFO -  step: 900  loss: -2.0000  grad_norm:  0.0000  memory: 15.73GiB(33.12%)  tps: 7,267  tflops: 55.35  mfu: 17.74%
[rank3]:2025-10-29 22:28:54,197 - INFO -  step: 900  loss:  3.5553  grad_norm:  0.4475  memory: 30.93GiB(65.10%)  tps: 7,275  tflops: 55.41  mfu: 17.76%
[rank0]:2025-10-29 22:28:54,269 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_2228_stage0_step900.svg
[rank1]:2025-10-29 22:28:54,270 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_2228_stage1_step900.svg
[rank2]:2025-10-29 22:28:54,269 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_2228_stage2_step900.svg
[rank3]:2025-10-29 22:28:54,390 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/pipeline_schedule/251029_2228_real_step900_rank3.svg
[rank3]:> Batch Time: 359.17 ms, GPU Bubble Ratio: 79.90%, 52.66%, 63.26%, 13.07%
[rank3]:2025-10-29 22:28:54,453 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_2228_stage3_step900.svg
[rank3]:2025-10-29 22:28:54,849 - INFO - Avg. fwd time: 12.4217 / Avg. bwd time: 27.2138 / Avg. batch time: 378.0852 (ms) / GPU bubble ratio: 16.13%
[rank0]:2025-10-29 22:28:54,886 - INFO - Avg. fwd time: 8.7945 / Avg. bwd time: 8.4011 / Avg. batch time: 557.5774 (ms) / GPU bubble ratio: 75.33%
[rank1]:2025-10-29 22:28:54,880 - INFO - Avg. fwd time: 10.2569 / Avg. bwd time: 15.2129 / Avg. batch time: 536.6027 (ms) / GPU bubble ratio: 62.03%
[rank2]:2025-10-29 22:28:54,864 - INFO - Avg. fwd time: 8.2379 / Avg. bwd time: 9.3032 / Avg. batch time: 504.4879 (ms) / GPU bubble ratio: 72.18%
[rank0]:2025-10-29 22:29:47,601 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 22:29:48,503 - INFO -  step: 950  loss: -2.0000  grad_norm:  0.0000  memory: 12.04GiB(25.35%)  tps: 7,218  tflops: 54.97  mfu: 17.62%
[rank0]:2025-10-29 22:29:48,503 - INFO -  step: 950  loss: -2.0000  grad_norm:  0.0000  memory: 16.79GiB(35.34%)  tps: 7,218  tflops: 54.97  mfu: 17.62%
[rank1]:2025-10-29 22:29:48,504 - INFO -  step: 950  loss: -2.0000  grad_norm:  0.0000  memory: 15.73GiB(33.12%)  tps: 7,218  tflops: 54.97  mfu: 17.62%
[rank3]:2025-10-29 22:29:50,974 - INFO -  step: 950  loss:  3.6124  grad_norm:  0.0484  memory: 30.93GiB(65.10%)  tps: 7,215  tflops: 54.95  mfu: 17.61%
[rank0]:2025-10-29 22:30:44,367 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 22:30:45,287 - INFO -  step: 1000  loss: -2.0000  grad_norm:  0.0000  memory: 15.73GiB(33.12%)  tps: 7,214  tflops: 54.95  mfu: 17.61%
[rank1]:2025-10-29 22:30:45,287 - INFO - ðŸ”Ž  Running validation at step 1000
[rank2]:2025-10-29 22:30:45,286 - INFO -  step: 1000  loss: -2.0000  grad_norm:  0.0000  memory: 12.04GiB(25.35%)  tps: 7,213  tflops: 54.94  mfu: 17.61%
[rank2]:2025-10-29 22:30:45,286 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-10-29 22:30:45,286 - INFO -  step: 1000  loss: -2.0000  grad_norm:  0.0000  memory: 16.79GiB(35.34%)  tps: 7,214  tflops: 54.95  mfu: 17.61%
[rank0]:2025-10-29 22:30:45,287 - INFO - ðŸ”Ž  Running validation at step 1000
[rank3]:2025-10-29 22:30:47,758 - INFO -  step: 1000  loss:  3.4728  grad_norm:  0.0565  memory: 30.93GiB(65.10%)  tps: 7,214  tflops: 54.94  mfu: 17.61%
[rank3]:2025-10-29 22:30:47,758 - INFO - ðŸ”Ž  Running validation at step 1000
[rank3]:2025-10-29 22:31:08,073 - INFO - validate step: 1000  loss:  1.8876  memory: 30.93GiB(65.10%)  tps: 20,164
[rank1]:2025-10-29 22:31:08,063 - INFO - validate step: 1000  loss: -1.0000  memory: 15.73GiB(33.12%)  tps: 17,984
[rank0]:2025-10-29 22:31:08,042 - INFO - validate step: 1000  loss: -1.0000  memory: 16.79GiB(35.34%)  tps: 18,000
[rank2]:2025-10-29 22:31:08,080 - INFO - validate step: 1000  loss: -1.0000  memory: 12.04GiB(25.35%)  tps: 17,970
[rank1]:2025-10-29 22:31:08,154 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_2231_stage1_step1000.svg
[rank0]:2025-10-29 22:31:08,155 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_2231_stage0_step1000.svg
[rank0]:2025-10-29 22:31:08,211 - INFO - Avg. fwd time: 8.8213 / Avg. bwd time: 7.6379 / Avg. batch time: 557.1672 (ms) / GPU bubble ratio: 76.37%
[rank2]:2025-10-29 22:31:08,155 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_2231_stage2_step1000.svg
[rank3]:2025-10-29 22:31:08,272 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/pipeline_schedule/251029_2231_real_step1000_rank3.svg
[rank3]:> Batch Time: 359.40 ms, GPU Bubble Ratio: 79.89%, 52.68%, 63.27%, 13.05%
[rank3]:2025-10-29 22:31:08,338 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_2231_stage3_step1000.svg
[rank3]:2025-10-29 22:31:08,587 - INFO - Avg. fwd time: 12.4216 / Avg. bwd time: 27.1821 / Avg. batch time: 377.6883 (ms) / GPU bubble ratio: 16.11%
[rank2]:2025-10-29 22:31:08,583 - INFO - Avg. fwd time: 8.2540 / Avg. bwd time: 9.1929 / Avg. batch time: 505.5618 (ms) / GPU bubble ratio: 72.39%
[rank1]:2025-10-29 22:31:08,643 - INFO - Avg. fwd time: 10.3075 / Avg. bwd time: 14.7798 / Avg. batch time: 536.9900 (ms) / GPU bubble ratio: 62.63%
[rank0]:2025-10-29 22:32:02,174 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-29 22:32:03,084 - INFO -  step: 1050  loss: -2.0000  grad_norm:  0.0000  memory: 12.04GiB(25.35%)  tps: 7,447  tflops: 56.72  mfu: 18.18%
[rank1]:2025-10-29 22:32:03,085 - INFO -  step: 1050  loss: -2.0000  grad_norm:  0.0000  memory: 15.73GiB(33.12%)  tps: 7,444  tflops: 56.70  mfu: 18.17%
[rank0]:2025-10-29 22:32:03,085 - INFO -  step: 1050  loss: -2.0000  grad_norm:  0.0000  memory: 16.79GiB(35.34%)  tps: 7,442  tflops: 56.68  mfu: 18.17%
[rank3]:2025-10-29 22:32:05,606 - INFO -  step: 1050  loss:  3.5336  grad_norm:  0.7127  memory: 30.93GiB(65.10%)  tps: 7,120  tflops: 54.22  mfu: 17.38%
[rank0]:2025-10-29 22:32:59,057 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 22:32:59,941 - INFO -  step: 1100  loss: -2.0000  grad_norm:  0.0000  memory: 16.79GiB(35.34%)  tps: 7,204  tflops: 54.87  mfu: 17.59%
[rank2]:2025-10-29 22:32:59,941 - INFO -  step: 1100  loss: -2.0000  grad_norm:  0.0000  memory: 12.04GiB(25.35%)  tps: 7,204  tflops: 54.87  mfu: 17.59%
[rank1]:2025-10-29 22:32:59,941 - INFO -  step: 1100  loss: -2.0000  grad_norm:  0.0000  memory: 15.73GiB(33.12%)  tps: 7,204  tflops: 54.87  mfu: 17.59%
[rank0]:2025-10-29 22:33:02,482 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_2232_stage0_step1100.svg
[rank3]:2025-10-29 22:33:02,407 - INFO -  step: 1100  loss:  3.3925  grad_norm:  0.0427  memory: 30.93GiB(65.10%)  tps: 7,211  tflops: 54.92  mfu: 17.60%
[rank2]:2025-10-29 22:33:02,482 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_2232_stage2_step1100.svg
[rank1]:2025-10-29 22:33:02,484 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_2232_stage1_step1100.svg
[rank0]:2025-10-29 22:33:02,539 - INFO - Avg. fwd time: 8.8471 / Avg. bwd time: 6.9061 / Avg. batch time: 555.6349 (ms) / GPU bubble ratio: 77.32%
[rank3]:2025-10-29 22:33:02,607 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/pipeline_schedule/251029_2233_real_step1100_rank3.svg
[rank3]:> Batch Time: 360.15 ms, GPU Bubble Ratio: 79.91%, 52.76%, 63.34%, 13.02%
[rank3]:2025-10-29 22:33:02,672 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_2233_stage3_step1100.svg
[rank3]:2025-10-29 22:33:02,920 - INFO - Avg. fwd time: 12.4192 / Avg. bwd time: 27.2135 / Avg. batch time: 377.7853 (ms) / GPU bubble ratio: 16.07%
[rank2]:2025-10-29 22:33:02,915 - INFO - Avg. fwd time: 8.2705 / Avg. bwd time: 9.0882 / Avg. batch time: 505.4535 (ms) / GPU bubble ratio: 72.53%
[rank1]:2025-10-29 22:33:02,972 - INFO - Avg. fwd time: 10.3577 / Avg. bwd time: 14.3656 / Avg. batch time: 536.2244 (ms) / GPU bubble ratio: 63.11%
[rank0]:2025-10-29 22:33:56,360 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 22:33:57,272 - INFO -  step: 1150  loss: -2.0000  grad_norm:  0.0000  memory: 16.79GiB(35.34%)  tps: 7,145  tflops: 54.41  mfu: 17.44%
[rank1]:2025-10-29 22:33:57,272 - INFO -  step: 1150  loss: -2.0000  grad_norm:  0.0000  memory: 15.73GiB(33.12%)  tps: 7,145  tflops: 54.41  mfu: 17.44%
[rank2]:2025-10-29 22:33:57,272 - INFO -  step: 1150  loss: -2.0000  grad_norm:  0.0000  memory: 12.04GiB(25.35%)  tps: 7,145  tflops: 54.41  mfu: 17.44%
[rank3]:2025-10-29 22:33:59,765 - INFO -  step: 1150  loss:  3.5293  grad_norm:  0.0862  memory: 30.93GiB(65.10%)  tps: 7,141  tflops: 54.39  mfu: 17.43%
[rank0]:2025-10-29 22:34:53,403 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 22:34:54,323 - INFO -  step: 1200  loss: -2.0000  grad_norm:  0.0000  memory: 15.73GiB(33.12%)  tps: 7,180  tflops: 54.68  mfu: 17.53%
[rank1]:2025-10-29 22:34:54,323 - INFO - ðŸ”Ž  Running validation at step 1200
[rank0]:2025-10-29 22:34:54,323 - INFO -  step: 1200  loss: -2.0000  grad_norm:  0.0000  memory: 16.79GiB(35.34%)  tps: 7,180  tflops: 54.68  mfu: 17.53%
[rank0]:2025-10-29 22:34:54,323 - INFO - ðŸ”Ž  Running validation at step 1200
[rank2]:2025-10-29 22:34:54,323 - INFO -  step: 1200  loss: -2.0000  grad_norm:  0.0000  memory: 12.04GiB(25.35%)  tps: 7,180  tflops: 54.68  mfu: 17.53%
[rank2]:2025-10-29 22:34:54,323 - INFO - ðŸ”Ž  Running validation at step 1200
[rank3]:2025-10-29 22:34:56,838 - INFO -  step: 1200  loss:  3.5943  grad_norm:  0.0532  memory: 30.93GiB(65.10%)  tps: 7,177  tflops: 54.66  mfu: 17.52%
[rank3]:2025-10-29 22:34:56,838 - INFO - ðŸ”Ž  Running validation at step 1200
[rank1]:2025-10-29 22:35:16,815 - INFO - validate step: 1200  loss: -1.0000  memory: 15.73GiB(33.12%)  tps: 18,212
[rank3]:2025-10-29 22:35:16,822 - INFO - validate step: 1200  loss:  1.8849  memory: 30.93GiB(65.10%)  tps: 20,497
[rank0]:2025-10-29 22:35:16,791 - INFO - validate step: 1200  loss: -1.0000  memory: 16.79GiB(35.34%)  tps: 18,231
[rank2]:2025-10-29 22:35:16,828 - INFO - validate step: 1200  loss: -1.0000  memory: 12.04GiB(25.35%)  tps: 18,200
[rank1]:2025-10-29 22:35:16,905 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_2235_stage1_step1200.svg
[rank0]:2025-10-29 22:35:16,904 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_2235_stage0_step1200.svg
[rank2]:2025-10-29 22:35:16,904 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_2235_stage2_step1200.svg
[rank3]:2025-10-29 22:35:17,020 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/pipeline_schedule/251029_2235_real_step1200_rank3.svg
[rank3]:> Batch Time: 360.69 ms, GPU Bubble Ratio: 79.92%, 52.82%, 63.38%, 12.99%
[rank3]:2025-10-29 22:35:17,088 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_2235_stage3_step1200.svg
[rank1]:2025-10-29 22:35:17,536 - INFO - Avg. fwd time: 10.3985 / Avg. bwd time: 14.0247 / Avg. batch time: 535.6862 (ms) / GPU bubble ratio: 63.53%
[rank3]:2025-10-29 22:35:17,503 - INFO - Avg. fwd time: 12.4138 / Avg. bwd time: 27.2516 / Avg. batch time: 377.9357 (ms) / GPU bubble ratio: 16.04%
[rank0]:2025-10-29 22:35:17,543 - INFO - Avg. fwd time: 8.8685 / Avg. bwd time: 6.3022 / Avg. batch time: 554.4648 (ms) / GPU bubble ratio: 78.11%
[rank2]:2025-10-29 22:35:17,518 - INFO - Avg. fwd time: 8.2840 / Avg. bwd time: 9.0027 / Avg. batch time: 505.4555 (ms) / GPU bubble ratio: 72.64%
[rank0]:2025-10-29 22:36:10,822 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-29 22:36:11,720 - INFO -  step: 1250  loss: -2.0000  grad_norm:  0.0000  memory: 12.04GiB(25.35%)  tps: 7,462  tflops: 56.83  mfu: 18.22%
[rank0]:2025-10-29 22:36:11,721 - INFO -  step: 1250  loss: -2.0000  grad_norm:  0.0000  memory: 16.79GiB(35.34%)  tps: 7,457  tflops: 56.79  mfu: 18.20%
[rank1]:2025-10-29 22:36:11,721 - INFO -  step: 1250  loss: -2.0000  grad_norm:  0.0000  memory: 15.73GiB(33.12%)  tps: 7,460  tflops: 56.82  mfu: 18.21%
[rank3]:2025-10-29 22:36:14,192 - INFO -  step: 1250  loss:  3.5113  grad_norm:  0.0470  memory: 30.93GiB(65.10%)  tps: 7,140  tflops: 54.38  mfu: 17.43%
[rank0]:2025-10-29 22:37:07,542 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 22:37:08,430 - INFO -  step: 1300  loss: -2.0000  grad_norm:  0.0000  memory: 12.04GiB(25.35%)  tps: 7,223  tflops: 55.01  mfu: 17.63%
[rank0]:2025-10-29 22:37:08,431 - INFO -  step: 1300  loss: -2.0000  grad_norm:  0.0000  memory: 16.79GiB(35.34%)  tps: 7,223  tflops: 55.01  mfu: 17.63%
[rank1]:2025-10-29 22:37:08,431 - INFO -  step: 1300  loss: -2.0000  grad_norm:  0.0000  memory: 15.73GiB(33.12%)  tps: 7,223  tflops: 55.01  mfu: 17.63%
[rank3]:2025-10-29 22:37:10,891 - INFO -  step: 1300  loss:  3.5144  grad_norm:  0.0558  memory: 30.93GiB(65.10%)  tps: 7,224  tflops: 55.02  mfu: 17.64%
[rank2]:2025-10-29 22:37:10,969 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_2237_stage2_step1300.svg
[rank0]:2025-10-29 22:37:10,968 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_2237_stage0_step1300.svg
[rank0]:2025-10-29 22:37:11,024 - INFO - Avg. fwd time: 8.8843 / Avg. bwd time: 5.8628 / Avg. batch time: 554.5669 (ms) / GPU bubble ratio: 78.73%
[rank1]:2025-10-29 22:37:10,969 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_2237_stage1_step1300.svg
[rank3]:2025-10-29 22:37:11,083 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/pipeline_schedule/251029_2237_real_step1300_rank3.svg
[rank3]:> Batch Time: 360.88 ms, GPU Bubble Ratio: 79.91%, 52.84%, 63.39%, 12.98%
[rank3]:2025-10-29 22:37:11,152 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_2237_stage3_step1300.svg
[rank2]:2025-10-29 22:37:11,396 - INFO - Avg. fwd time: 8.2934 / Avg. bwd time: 8.9402 / Avg. batch time: 506.4107 (ms) / GPU bubble ratio: 72.78%
[rank3]:2025-10-29 22:37:11,401 - INFO - Avg. fwd time: 12.4132 / Avg. bwd time: 27.2432 / Avg. batch time: 377.7831 (ms) / GPU bubble ratio: 16.02%
[rank1]:2025-10-29 22:37:11,455 - INFO - Avg. fwd time: 10.4278 / Avg. bwd time: 13.7768 / Avg. batch time: 536.2480 (ms) / GPU bubble ratio: 63.89%
[rank0]:2025-10-29 22:38:04,748 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 22:38:05,641 - INFO -  step: 1350  loss: -2.0000  grad_norm:  0.0000  memory: 12.04GiB(25.35%)  tps: 7,160  tflops: 54.53  mfu: 17.48%
[rank1]:2025-10-29 22:38:05,641 - INFO -  step: 1350  loss: -2.0000  grad_norm:  0.0000  memory: 15.73GiB(33.12%)  tps: 7,160  tflops: 54.53  mfu: 17.48%
[rank0]:2025-10-29 22:38:05,641 - INFO -  step: 1350  loss: -2.0000  grad_norm:  0.0000  memory: 16.79GiB(35.34%)  tps: 7,160  tflops: 54.53  mfu: 17.48%
[rank3]:2025-10-29 22:38:08,098 - INFO -  step: 1350  loss:  3.5200  grad_norm:  0.0458  memory: 30.93GiB(65.10%)  tps: 7,160  tflops: 54.53  mfu: 17.48%
[rank0]:2025-10-29 22:39:01,719 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 22:39:02,625 - INFO -  step: 1400  loss: -2.0000  grad_norm:  0.0000  memory: 15.73GiB(33.12%)  tps: 7,188  tflops: 54.75  mfu: 17.55%
[rank1]:2025-10-29 22:39:02,625 - INFO - ðŸ”Ž  Running validation at step 1400
[rank2]:2025-10-29 22:39:02,624 - INFO -  step: 1400  loss: -2.0000  grad_norm:  0.0000  memory: 12.04GiB(25.35%)  tps: 7,188  tflops: 54.75  mfu: 17.55%
[rank2]:2025-10-29 22:39:02,624 - INFO - ðŸ”Ž  Running validation at step 1400
[rank0]:2025-10-29 22:39:02,625 - INFO -  step: 1400  loss: -2.0000  grad_norm:  0.0000  memory: 16.79GiB(35.34%)  tps: 7,188  tflops: 54.75  mfu: 17.55%
[rank0]:2025-10-29 22:39:02,625 - INFO - ðŸ”Ž  Running validation at step 1400
[rank3]:2025-10-29 22:39:05,086 - INFO -  step: 1400  loss:  3.5459  grad_norm:  0.0579  memory: 30.93GiB(65.10%)  tps: 7,188  tflops: 54.74  mfu: 17.55%
[rank3]:2025-10-29 22:39:05,087 - INFO - ðŸ”Ž  Running validation at step 1400
[rank0]:2025-10-29 22:39:25,192 - INFO - validate step: 1400  loss: -1.0000  memory: 16.79GiB(35.34%)  tps: 18,150
[rank2]:2025-10-29 22:39:25,232 - INFO - validate step: 1400  loss: -1.0000  memory: 12.04GiB(25.35%)  tps: 18,118
[rank3]:2025-10-29 22:39:25,225 - INFO - validate step: 1400  loss:  1.8787  memory: 30.93GiB(65.10%)  tps: 20,341
[rank1]:2025-10-29 22:39:25,214 - INFO - validate step: 1400  loss: -1.0000  memory: 15.73GiB(33.12%)  tps: 18,133
[rank2]:2025-10-29 22:39:25,313 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_2239_stage2_step1400.svg
[rank1]:2025-10-29 22:39:25,314 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_2239_stage1_step1400.svg
[rank0]:2025-10-29 22:39:25,313 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_2239_stage0_step1400.svg
[rank0]:2025-10-29 22:39:25,368 - INFO - Avg. fwd time: 8.8993 / Avg. bwd time: 5.4218 / Avg. batch time: 553.5097 (ms) / GPU bubble ratio: 79.30%
[rank3]:2025-10-29 22:39:25,425 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/pipeline_schedule/251029_2239_real_step1400_rank3.svg
[rank3]:> Batch Time: 361.31 ms, GPU Bubble Ratio: 79.93%, 52.89%, 63.43%, 12.96%
[rank3]:2025-10-29 22:39:25,494 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_2239_stage3_step1400.svg
[rank2]:2025-10-29 22:39:25,740 - INFO - Avg. fwd time: 8.3026 / Avg. bwd time: 8.8771 / Avg. batch time: 506.2118 (ms) / GPU bubble ratio: 72.85%
[rank3]:2025-10-29 22:39:25,745 - INFO - Avg. fwd time: 12.4072 / Avg. bwd time: 27.2707 / Avg. batch time: 377.8723 (ms) / GPU bubble ratio: 16.00%
[rank1]:2025-10-29 22:39:25,797 - INFO - Avg. fwd time: 10.4568 / Avg. bwd time: 13.5273 / Avg. batch time: 535.6534 (ms) / GPU bubble ratio: 64.18%
[rank0]:2025-10-29 22:40:19,013 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-29 22:40:19,929 - INFO -  step: 1450  loss: -2.0000  grad_norm:  0.0000  memory: 16.79GiB(35.34%)  tps: 7,483  tflops: 56.99  mfu: 18.27%
[rank2]:2025-10-29 22:40:19,928 - INFO -  step: 1450  loss: -2.0000  grad_norm:  0.0000  memory: 12.04GiB(25.35%)  tps: 7,489  tflops: 57.04  mfu: 18.28%
[rank1]:2025-10-29 22:40:19,929 - INFO -  step: 1450  loss: -2.0000  grad_norm:  0.0000  memory: 15.73GiB(33.12%)  tps: 7,486  tflops: 57.02  mfu: 18.27%
[rank3]:2025-10-29 22:40:22,360 - INFO -  step: 1450  loss:  3.5963  grad_norm:  0.1788  memory: 30.93GiB(65.10%)  tps: 7,169  tflops: 54.60  mfu: 17.50%
[rank0]:2025-10-29 22:41:15,767 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 22:41:16,666 - INFO -  step: 1500  loss: -2.0000  grad_norm:  0.0000  memory: 16.79GiB(35.34%)  tps: 7,219  tflops: 54.98  mfu: 17.62%
[rank2]:2025-10-29 22:41:16,665 - INFO -  step: 1500  loss: -2.0000  grad_norm:  0.0000  memory: 12.04GiB(25.35%)  tps: 7,219  tflops: 54.98  mfu: 17.62%
[rank1]:2025-10-29 22:41:16,666 - INFO -  step: 1500  loss: -2.0000  grad_norm:  0.0000  memory: 15.73GiB(33.12%)  tps: 7,219  tflops: 54.98  mfu: 17.62%
[rank3]:2025-10-29 22:41:19,122 - INFO -  step: 1500  loss:  3.4820  grad_norm:  0.0554  memory: 30.93GiB(65.10%)  tps: 7,216  tflops: 54.96  mfu: 17.62%
[rank0]:2025-10-29 22:41:19,201 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_2241_stage0_step1500.svg
[rank2]:2025-10-29 22:41:19,202 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_2241_stage2_step1500.svg
[rank1]:2025-10-29 22:41:19,202 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_2241_stage1_step1500.svg
[rank3]:2025-10-29 22:41:19,314 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/pipeline_schedule/251029_2241_real_step1500_rank3.svg
[rank3]:> Batch Time: 361.55 ms, GPU Bubble Ratio: 79.94%, 52.92%, 63.46%, 12.95%
[rank3]:2025-10-29 22:41:19,386 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_2241_stage3_step1500.svg
[rank0]:2025-10-29 22:41:19,826 - INFO - Avg. fwd time: 8.9125 / Avg. bwd time: 5.0426 / Avg. batch time: 552.5589 (ms) / GPU bubble ratio: 79.80%
[rank2]:2025-10-29 22:41:19,801 - INFO - Avg. fwd time: 8.3105 / Avg. bwd time: 8.8226 / Avg. batch time: 505.9977 (ms) / GPU bubble ratio: 72.91%
[rank3]:2025-10-29 22:41:19,785 - INFO - Avg. fwd time: 12.4026 / Avg. bwd time: 27.2870 / Avg. batch time: 377.8959 (ms) / GPU bubble ratio: 15.98%
[rank1]:2025-10-29 22:41:19,819 - INFO - Avg. fwd time: 10.4818 / Avg. bwd time: 13.3126 / Avg. batch time: 535.0989 (ms) / GPU bubble ratio: 64.43%
[rank0]:2025-10-29 22:42:12,774 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 22:42:13,680 - INFO -  step: 1550  loss: -2.0000  grad_norm:  0.0000  memory: 16.79GiB(35.34%)  tps: 7,184  tflops: 54.72  mfu: 17.54%
[rank2]:2025-10-29 22:42:13,679 - INFO -  step: 1550  loss: -2.0000  grad_norm:  0.0000  memory: 12.04GiB(25.35%)  tps: 7,184  tflops: 54.72  mfu: 17.54%
[rank1]:2025-10-29 22:42:13,680 - INFO -  step: 1550  loss: -2.0000  grad_norm:  0.0000  memory: 15.73GiB(33.12%)  tps: 7,184  tflops: 54.72  mfu: 17.54%
[rank3]:2025-10-29 22:42:16,149 - INFO -  step: 1550  loss:  3.5334  grad_norm:  0.0392  memory: 30.93GiB(65.10%)  tps: 7,183  tflops: 54.71  mfu: 17.53%
[rank0]:2025-10-29 22:43:09,385 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 22:43:10,629 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_2243_rank3_trend_line.svg
[rank2]:2025-10-29 22:43:10,711 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_2243_rank2_trend_line.svg
[rank0]:2025-10-29 22:43:10,723 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_2243_rank0_trend_line.svg
[rank0]:2025-10-29 22:43:10,732 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 22:43:10,735 - INFO -  step: 1600  loss: -2.0000  grad_norm:  0.0000  memory: 16.79GiB(35.34%)  tps: 7,179  tflops: 54.68  mfu: 17.52%
[rank0]:2025-10-29 22:43:10,735 - INFO - ðŸ”Ž  Running validation at step 1600
[rank1]:2025-10-29 22:43:10,725 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_2243_rank1_trend_line.svg
[rank1]:2025-10-29 22:43:10,732 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 22:43:10,735 - INFO -  step: 1600  loss: -2.0000  grad_norm:  0.0000  memory: 15.73GiB(33.12%)  tps: 7,179  tflops: 54.68  mfu: 17.52%
[rank1]:2025-10-29 22:43:10,735 - INFO - ðŸ”Ž  Running validation at step 1600
[rank2]:2025-10-29 22:43:10,732 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-29 22:43:10,735 - INFO -  step: 1600  loss: -2.0000  grad_norm:  0.0000  memory: 12.04GiB(25.35%)  tps: 7,179  tflops: 54.68  mfu: 17.52%
[rank2]:2025-10-29 22:43:10,735 - INFO - ðŸ”Ž  Running validation at step 1600
[rank3]:2025-10-29 22:43:10,937 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/pipeline_schedule/251029_2243_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 346.17 ms, GPU Bubble Ratio: 72.59%, 50.11%, 64.94%, 13.91%
[rank3]:2025-10-29 22:43:10,937 - INFO - 	> Batch Time: 346.17 ms (Average Freeze Ratio: 0.32)
[rank3]:2025-10-29 22:43:10,938 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 0.20/0.20, [MB7] 1.00/1.00
[rank3]:2025-10-29 22:43:13,388 - INFO -  step: 1600  loss:  3.5608  grad_norm:  0.0701  memory: 30.93GiB(65.10%)  tps: 7,156  tflops: 54.50  mfu: 17.47%
[rank3]:2025-10-29 22:43:13,388 - INFO - ðŸ”Ž  Running validation at step 1600
[rank3]:2025-10-29 22:43:33,621 - INFO - validate step: 1600  loss:  1.8807  memory: 30.93GiB(65.10%)  tps: 20,245
[rank3]:2025-10-29 22:43:33,621 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-29 22:43:33,592 - INFO - validate step: 1600  loss: -1.0000  memory: 16.79GiB(35.34%)  tps: 17,921
[rank0]:2025-10-29 22:43:33,593 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-29 22:43:33,603 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank1]:2025-10-29 22:43:33,610 - INFO - validate step: 1600  loss: -1.0000  memory: 15.73GiB(33.12%)  tps: 17,906
[rank1]:2025-10-29 22:43:33,611 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-29 22:43:33,632 - INFO - validate step: 1600  loss: -1.0000  memory: 12.04GiB(25.35%)  tps: 17,889
[rank2]:2025-10-29 22:43:33,633 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-29 22:43:35,438 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 1.80 seconds.
[rank1]:2025-10-29 22:43:35,784 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 2.17 seconds.
[rank3]:2025-10-29 22:43:37,086 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.46 seconds.
[rank0]:2025-10-29 22:43:37,329 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-29 22:43:37,336 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.74 seconds.
[rank1]:2025-10-29 22:43:37,423 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_2243_stage1_step1600.svg
[rank2]:2025-10-29 22:43:37,425 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_2243_stage2_step1600.svg
[rank0]:2025-10-29 22:43:37,610 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_2243_stage0_step1600.svg
[rank3]:2025-10-29 22:43:37,719 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/pipeline_schedule/251029_2243_real_step1600_rank3.svg
[rank3]:> Batch Time: 361.64 ms, GPU Bubble Ratio: 79.94%, 52.93%, 63.46%, 12.94%
[rank0]:2025-10-29 22:43:37,729 - INFO - Avg. fwd time: 8.9227 / Avg. bwd time: 4.7574 / Avg. batch time: 552.6762 (ms) / GPU bubble ratio: 80.20%
[rank3]:2025-10-29 22:43:37,803 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_2243_stage3_step1600.svg
[rank3]:2025-10-29 22:43:38,058 - INFO - Avg. fwd time: 12.4016 / Avg. bwd time: 27.2857 / Avg. batch time: 377.8243 (ms) / GPU bubble ratio: 15.97%
[rank1]:2025-10-29 22:43:38,112 - INFO - Avg. fwd time: 10.5010 / Avg. bwd time: 13.1511 / Avg. batch time: 535.5154 (ms) / GPU bubble ratio: 64.67%
[rank2]:2025-10-29 22:43:38,055 - INFO - Avg. fwd time: 8.3168 / Avg. bwd time: 8.7816 / Avg. batch time: 506.6702 (ms) / GPU bubble ratio: 73.00%
[rank3]:2025-10-29 22:43:59,735 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-29 22:43:59,895 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-29 22:43:59,896 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-29 22:43:59,883 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-29 22:44:26,916 - INFO - [GC] Peforming periodical GC collection 0.29 seconds
[rank2]:2025-10-29 22:44:27,740 - INFO -  step: 1650  loss: -2.0000  grad_norm:  0.0000  memory: 12.04GiB(25.35%)  tps: 7,570  tflops: 57.66  mfu: 18.48%
[rank1]:2025-10-29 22:44:27,740 - INFO -  step: 1650  loss: -2.0000  grad_norm:  0.0000  memory: 15.73GiB(33.12%)  tps: 7,567  tflops: 57.63  mfu: 18.47%
[rank0]:2025-10-29 22:44:27,740 - INFO -  step: 1650  loss: -2.0000  grad_norm:  0.0000  memory: 16.79GiB(35.34%)  tps: 7,564  tflops: 57.61  mfu: 18.47%
[rank3]:2025-10-29 22:44:30,223 - INFO -  step: 1650  loss:  3.5595  grad_norm:  0.0000  memory: 30.93GiB(65.10%)  tps: 7,237  tflops: 55.12  mfu: 17.67%
[rank0]:2025-10-29 22:45:19,265 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 22:45:20,064 - INFO -  step: 1700  loss: -2.0000  grad_norm:  0.0000  memory: 12.04GiB(25.35%)  tps: 7,828  tflops: 59.62  mfu: 19.11%
[rank1]:2025-10-29 22:45:20,065 - INFO -  step: 1700  loss: -2.0000  grad_norm:  0.0000  memory: 15.73GiB(33.12%)  tps: 7,828  tflops: 59.62  mfu: 19.11%
[rank0]:2025-10-29 22:45:20,065 - INFO -  step: 1700  loss: -2.0000  grad_norm:  0.0000  memory: 16.79GiB(35.34%)  tps: 7,828  tflops: 59.62  mfu: 19.11%
[rank3]:2025-10-29 22:45:22,483 - INFO -  step: 1700  loss:  3.4680  grad_norm:  0.0000  memory: 30.93GiB(65.10%)  tps: 7,838  tflops: 59.70  mfu: 19.13%
[rank2]:2025-10-29 22:45:22,564 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_2245_stage2_step1700.svg
[rank1]:2025-10-29 22:45:22,567 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_2245_stage1_step1700.svg
[rank0]:2025-10-29 22:45:22,565 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_2245_stage0_step1700.svg
[rank0]:2025-10-29 22:45:22,623 - INFO - Avg. fwd time: 8.9346 / Avg. bwd time: 4.4629 / Avg. batch time: 549.1854 (ms) / GPU bubble ratio: 80.48%
[rank3]:2025-10-29 22:45:22,684 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/pipeline_schedule/251029_2245_real_step1700_rank3.svg
[rank3]:> Batch Time: 360.82 ms, GPU Bubble Ratio: 79.88%, 52.81%, 63.37%, 12.98%
[rank3]:2025-10-29 22:45:22,757 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_2245_stage3_step1700.svg
[rank3]:2025-10-29 22:45:22,962 - INFO - Avg. fwd time: 12.4541 / Avg. bwd time: 26.9225 / Avg. batch time: 375.2863 (ms) / GPU bubble ratio: 16.06%
[rank2]:2025-10-29 22:45:22,999 - INFO - Avg. fwd time: 8.3235 / Avg. bwd time: 8.7397 / Avg. batch time: 503.7370 (ms) / GPU bubble ratio: 72.90%
[rank1]:2025-10-29 22:45:23,045 - INFO - Avg. fwd time: 10.5218 / Avg. bwd time: 12.9862 / Avg. batch time: 532.3241 (ms) / GPU bubble ratio: 64.67%
[rank0]:2025-10-29 22:46:11,723 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 22:46:12,529 - INFO -  step: 1750  loss: -2.0000  grad_norm:  0.0000  memory: 12.04GiB(25.35%)  tps: 7,807  tflops: 59.46  mfu: 19.06%
[rank1]:2025-10-29 22:46:12,529 - INFO -  step: 1750  loss: -2.0000  grad_norm:  0.0000  memory: 15.73GiB(33.12%)  tps: 7,807  tflops: 59.46  mfu: 19.06%
[rank0]:2025-10-29 22:46:12,529 - INFO -  step: 1750  loss: -2.0000  grad_norm:  0.0000  memory: 16.79GiB(35.34%)  tps: 7,807  tflops: 59.46  mfu: 19.06%
[rank3]:2025-10-29 22:46:14,955 - INFO -  step: 1750  loss:  3.4996  grad_norm:  0.0000  memory: 30.93GiB(65.10%)  tps: 7,806  tflops: 59.45  mfu: 19.06%
[rank0]:2025-10-29 22:47:04,115 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 22:47:04,928 - INFO -  step: 1800  loss: -2.0000  grad_norm:  0.0000  memory: 12.04GiB(25.35%)  tps: 7,817  tflops: 59.54  mfu: 19.08%
[rank2]:2025-10-29 22:47:04,928 - INFO - ðŸ”Ž  Running validation at step 1800
[rank1]:2025-10-29 22:47:04,928 - INFO -  step: 1800  loss: -2.0000  grad_norm:  0.0000  memory: 15.73GiB(33.12%)  tps: 7,817  tflops: 59.54  mfu: 19.08%
[rank1]:2025-10-29 22:47:04,928 - INFO - ðŸ”Ž  Running validation at step 1800
[rank0]:2025-10-29 22:47:04,928 - INFO -  step: 1800  loss: -2.0000  grad_norm:  0.0000  memory: 16.79GiB(35.34%)  tps: 7,817  tflops: 59.54  mfu: 19.08%
[rank0]:2025-10-29 22:47:04,928 - INFO - ðŸ”Ž  Running validation at step 1800
[rank3]:2025-10-29 22:47:07,370 - INFO -  step: 1800  loss:  3.5930  grad_norm:  0.0000  memory: 30.93GiB(65.10%)  tps: 7,815  tflops: 59.52  mfu: 19.08%
[rank3]:2025-10-29 22:47:07,371 - INFO - ðŸ”Ž  Running validation at step 1800
[rank1]:2025-10-29 22:47:28,293 - INFO - validate step: 1800  loss: -1.0000  memory: 15.73GiB(33.12%)  tps: 17,531
[rank0]:2025-10-29 22:47:28,271 - INFO - validate step: 1800  loss: -1.0000  memory: 16.79GiB(35.34%)  tps: 17,547
[rank3]:2025-10-29 22:47:28,303 - INFO - validate step: 1800  loss:  1.8804  memory: 30.93GiB(65.10%)  tps: 19,569
[rank2]:2025-10-29 22:47:28,312 - INFO - validate step: 1800  loss: -1.0000  memory: 12.04GiB(25.35%)  tps: 17,516
[rank2]:2025-10-29 22:47:28,398 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_2247_stage2_step1800.svg
[rank1]:2025-10-29 22:47:28,395 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_2247_stage1_step1800.svg
[rank0]:2025-10-29 22:47:28,394 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_2247_stage0_step1800.svg
[rank3]:2025-10-29 22:47:28,507 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/pipeline_schedule/251029_2247_real_step1800_rank3.svg
[rank3]:> Batch Time: 360.01 ms, GPU Bubble Ratio: 79.84%, 52.69%, 63.29%, 13.00%
[rank3]:2025-10-29 22:47:28,578 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_2247_stage3_step1800.svg
[rank3]:2025-10-29 22:47:28,936 - INFO - Avg. fwd time: 12.5043 / Avg. bwd time: 26.5702 / Avg. batch time: 372.8184 (ms) / GPU bubble ratio: 16.15%
[rank2]:2025-10-29 22:47:28,954 - INFO - Avg. fwd time: 8.3296 / Avg. bwd time: 8.7027 / Avg. batch time: 501.0829 (ms) / GPU bubble ratio: 72.81%
[rank1]:2025-10-29 22:47:28,972 - INFO - Avg. fwd time: 10.5402 / Avg. bwd time: 12.8401 / Avg. batch time: 529.4409 (ms) / GPU bubble ratio: 64.67%
[rank0]:2025-10-29 22:47:28,981 - INFO - Avg. fwd time: 8.9440 / Avg. bwd time: 4.2027 / Avg. batch time: 546.0318 (ms) / GPU bubble ratio: 80.74%
[rank0]:2025-10-29 22:48:17,734 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-29 22:48:18,540 - INFO -  step: 1850  loss: -2.0000  grad_norm:  0.0000  memory: 12.04GiB(25.35%)  tps: 8,155  tflops: 62.11  mfu: 19.91%
[rank1]:2025-10-29 22:48:18,541 - INFO -  step: 1850  loss: -2.0000  grad_norm:  0.0000  memory: 15.73GiB(33.12%)  tps: 8,152  tflops: 62.08  mfu: 19.90%
[rank0]:2025-10-29 22:48:18,541 - INFO -  step: 1850  loss: -2.0000  grad_norm:  0.0000  memory: 16.79GiB(35.34%)  tps: 8,148  tflops: 62.06  mfu: 19.89%
[rank3]:2025-10-29 22:48:21,016 - INFO -  step: 1850  loss:  3.4969  grad_norm:  0.0000  memory: 30.93GiB(65.10%)  tps: 7,771  tflops: 59.18  mfu: 18.97%
[rank0]:2025-10-29 22:49:10,025 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 22:49:10,824 - INFO -  step: 1900  loss: -2.0000  grad_norm:  0.0000  memory: 12.04GiB(25.35%)  tps: 7,834  tflops: 59.67  mfu: 19.12%
[rank1]:2025-10-29 22:49:10,825 - INFO -  step: 1900  loss: -2.0000  grad_norm:  0.0000  memory: 15.73GiB(33.12%)  tps: 7,834  tflops: 59.67  mfu: 19.12%
[rank0]:2025-10-29 22:49:10,825 - INFO -  step: 1900  loss: -2.0000  grad_norm:  0.0000  memory: 16.79GiB(35.34%)  tps: 7,834  tflops: 59.67  mfu: 19.12%
[rank3]:2025-10-29 22:49:13,263 - INFO -  step: 1900  loss:  3.5189  grad_norm:  0.0000  memory: 30.93GiB(65.10%)  tps: 7,840  tflops: 59.71  mfu: 19.14%
[rank2]:2025-10-29 22:49:13,345 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_2249_stage2_step1900.svg
[rank1]:2025-10-29 22:49:13,345 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_2249_stage1_step1900.svg
[rank0]:2025-10-29 22:49:13,345 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_2249_stage0_step1900.svg
[rank0]:2025-10-29 22:49:13,402 - INFO - Avg. fwd time: 8.9509 / Avg. bwd time: 4.0027 / Avg. batch time: 544.3544 (ms) / GPU bubble ratio: 80.96%
[rank3]:2025-10-29 22:49:13,460 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/pipeline_schedule/251029_2249_real_step1900_rank3.svg
[rank3]:> Batch Time: 359.18 ms, GPU Bubble Ratio: 79.79%, 52.58%, 63.21%, 13.03%
[rank3]:2025-10-29 22:49:13,532 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_2249_stage3_step1900.svg
[rank3]:2025-10-29 22:49:13,733 - INFO - Avg. fwd time: 12.5431 / Avg. bwd time: 26.2996 / Avg. batch time: 370.9235 (ms) / GPU bubble ratio: 16.22%
[rank2]:2025-10-29 22:49:13,774 - INFO - Avg. fwd time: 8.3340 / Avg. bwd time: 8.6738 / Avg. batch time: 499.7923 (ms) / GPU bubble ratio: 72.78%
[rank1]:2025-10-29 22:49:13,824 - INFO - Avg. fwd time: 10.5545 / Avg. bwd time: 12.7278 / Avg. batch time: 527.9726 (ms) / GPU bubble ratio: 64.72%
[rank0]:2025-10-29 22:50:02,626 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 22:50:03,428 - INFO -  step: 1950  loss: -2.0000  grad_norm:  0.0000  memory: 12.04GiB(25.35%)  tps: 7,787  tflops: 59.30  mfu: 19.01%
[rank0]:2025-10-29 22:50:03,429 - INFO -  step: 1950  loss: -2.0000  grad_norm:  0.0000  memory: 16.79GiB(35.34%)  tps: 7,787  tflops: 59.30  mfu: 19.01%
[rank1]:2025-10-29 22:50:03,429 - INFO -  step: 1950  loss: -2.0000  grad_norm:  0.0000  memory: 15.73GiB(33.12%)  tps: 7,787  tflops: 59.30  mfu: 19.01%
[rank3]:2025-10-29 22:50:05,864 - INFO -  step: 1950  loss:  3.5569  grad_norm:  0.0000  memory: 30.93GiB(65.10%)  tps: 7,787  tflops: 59.31  mfu: 19.01%
[rank0]:2025-10-29 22:50:54,791 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 22:50:55,606 - INFO -  step: 2000  loss: -2.0000  grad_norm:  0.0000  memory: 12.04GiB(25.35%)  tps: 7,850  tflops: 59.79  mfu: 19.16%
[rank2]:2025-10-29 22:50:55,606 - INFO - ðŸ”Ž  Running validation at step 2000
[rank0]:2025-10-29 22:50:55,606 - INFO -  step: 2000  loss: -2.0000  grad_norm:  0.0000  memory: 16.79GiB(35.34%)  tps: 7,850  tflops: 59.79  mfu: 19.16%
[rank0]:2025-10-29 22:50:55,606 - INFO - ðŸ”Ž  Running validation at step 2000
[rank1]:2025-10-29 22:50:55,606 - INFO -  step: 2000  loss: -2.0000  grad_norm:  0.0000  memory: 15.73GiB(33.12%)  tps: 7,850  tflops: 59.79  mfu: 19.16%
[rank1]:2025-10-29 22:50:55,607 - INFO - ðŸ”Ž  Running validation at step 2000
[rank3]:2025-10-29 22:50:58,136 - INFO -  step: 2000  loss:  3.5330  grad_norm:  0.0000  memory: 30.93GiB(65.10%)  tps: 7,836  tflops: 59.68  mfu: 19.13%
[rank3]:2025-10-29 22:50:58,137 - INFO - ðŸ”Ž  Running validation at step 2000
[rank0]:2025-10-29 22:51:19,028 - INFO - validate step: 2000  loss: -1.0000  memory: 16.79GiB(35.34%)  tps: 17,488
[rank1]:2025-10-29 22:51:19,050 - INFO - validate step: 2000  loss: -1.0000  memory: 15.73GiB(33.12%)  tps: 17,472
[rank2]:2025-10-29 22:51:19,068 - INFO - validate step: 2000  loss: -1.0000  memory: 12.04GiB(25.35%)  tps: 17,458
[rank3]:2025-10-29 22:51:19,060 - INFO - validate step: 2000  loss:  1.8791  memory: 30.93GiB(65.10%)  tps: 19,577
[rank0]:2025-10-29 22:51:19,154 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_2251_stage0_step2000.svg
[rank1]:2025-10-29 22:51:19,154 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_2251_stage1_step2000.svg
[rank2]:2025-10-29 22:51:19,154 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_2251_stage2_step2000.svg
[rank0]:2025-10-29 22:51:19,211 - INFO - Avg. fwd time: 8.9580 / Avg. bwd time: 3.7922 / Avg. batch time: 541.6818 (ms) / GPU bubble ratio: 81.17%
[rank3]:2025-10-29 22:51:19,265 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/pipeline_schedule/251029_2251_real_step2000_rank3.svg
[rank3]:> Batch Time: 358.32 ms, GPU Bubble Ratio: 79.74%, 52.46%, 63.12%, 13.06%
[rank3]:2025-10-29 22:51:19,339 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_2251_stage3_step2000.svg
[rank3]:2025-10-29 22:51:19,546 - INFO - Avg. fwd time: 12.5828 / Avg. bwd time: 26.0120 / Avg. batch time: 368.8973 (ms) / GPU bubble ratio: 16.30%
[rank2]:2025-10-29 22:51:19,583 - INFO - Avg. fwd time: 8.3384 / Avg. bwd time: 8.6434 / Avg. batch time: 497.5284 (ms) / GPU bubble ratio: 72.69%
[rank1]:2025-10-29 22:51:19,624 - INFO - Avg. fwd time: 10.5688 / Avg. bwd time: 12.6092 / Avg. batch time: 525.5214 (ms) / GPU bubble ratio: 64.72%
[rank0]:2025-10-29 22:52:08,421 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-29 22:52:09,216 - INFO -  step: 2050  loss: -2.0000  grad_norm:  0.0000  memory: 12.04GiB(25.35%)  tps: 8,168  tflops: 62.21  mfu: 19.94%
[rank1]:2025-10-29 22:52:09,216 - INFO -  step: 2050  loss: -2.0000  grad_norm:  0.0000  memory: 15.73GiB(33.12%)  tps: 8,165  tflops: 62.19  mfu: 19.93%
[rank0]:2025-10-29 22:52:09,216 - INFO -  step: 2050  loss: -2.0000  grad_norm:  0.0000  memory: 16.79GiB(35.34%)  tps: 8,161  tflops: 62.16  mfu: 19.92%
[rank3]:2025-10-29 22:52:11,685 - INFO -  step: 2050  loss:  3.6338  grad_norm:  0.0000  memory: 30.93GiB(65.10%)  tps: 7,784  tflops: 59.28  mfu: 19.00%
[rank0]:2025-10-29 22:53:00,570 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 22:53:01,371 - INFO -  step: 2100  loss: -2.0000  grad_norm:  0.0000  memory: 15.73GiB(33.12%)  tps: 7,854  tflops: 59.81  mfu: 19.17%
[rank0]:2025-10-29 22:53:01,371 - INFO -  step: 2100  loss: -2.0000  grad_norm:  0.0000  memory: 16.79GiB(35.34%)  tps: 7,854  tflops: 59.81  mfu: 19.17%
[rank2]:2025-10-29 22:53:01,371 - INFO -  step: 2100  loss: -2.0000  grad_norm:  0.0000  memory: 12.04GiB(25.35%)  tps: 7,854  tflops: 59.81  mfu: 19.17%
[rank3]:2025-10-29 22:53:03,840 - INFO -  step: 2100  loss:  3.5002  grad_norm:  0.0000  memory: 30.93GiB(65.10%)  tps: 7,854  tflops: 59.82  mfu: 19.17%
[rank1]:2025-10-29 22:53:03,920 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_2253_stage1_step2100.svg
[rank0]:2025-10-29 22:53:03,920 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_2253_stage0_step2100.svg
[rank2]:2025-10-29 22:53:03,923 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_2253_stage2_step2100.svg
[rank3]:2025-10-29 22:53:04,039 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/pipeline_schedule/251029_2253_real_step2100_rank3.svg
[rank3]:> Batch Time: 357.60 ms, GPU Bubble Ratio: 79.69%, 52.36%, 63.04%, 13.09%
[rank3]:2025-10-29 22:53:04,104 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_2253_stage3_step2100.svg
[rank3]:2025-10-29 22:53:04,455 - INFO - Avg. fwd time: 12.6208 / Avg. bwd time: 25.7563 / Avg. batch time: 367.1182 (ms) / GPU bubble ratio: 16.37%
[rank1]:2025-10-29 22:53:04,492 - INFO - Avg. fwd time: 10.5827 / Avg. bwd time: 12.5035 / Avg. batch time: 523.3363 (ms) / GPU bubble ratio: 64.71%
[rank2]:2025-10-29 22:53:04,473 - INFO - Avg. fwd time: 8.3431 / Avg. bwd time: 8.6167 / Avg. batch time: 495.5089 (ms) / GPU bubble ratio: 72.62%
[rank0]:2025-10-29 22:53:04,501 - INFO - Avg. fwd time: 8.9651 / Avg. bwd time: 3.6028 / Avg. batch time: 539.2997 (ms) / GPU bubble ratio: 81.36%
[rank0]:2025-10-29 22:53:53,023 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 22:53:53,829 - INFO -  step: 2150  loss: -2.0000  grad_norm:  0.0000  memory: 16.79GiB(35.34%)  tps: 7,808  tflops: 59.47  mfu: 19.06%
[rank1]:2025-10-29 22:53:53,829 - INFO -  step: 2150  loss: -2.0000  grad_norm:  0.0000  memory: 15.73GiB(33.12%)  tps: 7,808  tflops: 59.47  mfu: 19.06%
[rank2]:2025-10-29 22:53:53,829 - INFO -  step: 2150  loss: -2.0000  grad_norm:  0.0000  memory: 12.04GiB(25.35%)  tps: 7,808  tflops: 59.47  mfu: 19.06%
[rank3]:2025-10-29 22:53:56,250 - INFO -  step: 2150  loss:  3.5171  grad_norm:  0.0000  memory: 30.93GiB(65.10%)  tps: 7,816  tflops: 59.53  mfu: 19.08%
[rank0]:2025-10-29 22:54:45,182 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 22:54:45,997 - INFO -  step: 2200  loss: -2.0000  grad_norm:  0.0000  memory: 16.79GiB(35.34%)  tps: 7,852  tflops: 59.80  mfu: 19.17%
[rank0]:2025-10-29 22:54:45,997 - INFO - ðŸ”Ž  Running validation at step 2200
[rank1]:2025-10-29 22:54:45,997 - INFO -  step: 2200  loss: -2.0000  grad_norm:  0.0000  memory: 15.73GiB(33.12%)  tps: 7,852  tflops: 59.80  mfu: 19.17%
[rank1]:2025-10-29 22:54:45,997 - INFO - ðŸ”Ž  Running validation at step 2200
[rank2]:2025-10-29 22:54:45,997 - INFO -  step: 2200  loss: -2.0000  grad_norm:  0.0000  memory: 12.04GiB(25.35%)  tps: 7,852  tflops: 59.80  mfu: 19.17%
[rank2]:2025-10-29 22:54:45,997 - INFO - ðŸ”Ž  Running validation at step 2200
[rank3]:2025-10-29 22:54:48,389 - INFO -  step: 2200  loss:  3.5473  grad_norm:  0.0000  memory: 30.93GiB(65.10%)  tps: 7,856  tflops: 59.83  mfu: 19.18%
[rank3]:2025-10-29 22:54:48,390 - INFO - ðŸ”Ž  Running validation at step 2200
[rank0]:2025-10-29 22:55:09,314 - INFO - validate step: 2200  loss: -1.0000  memory: 16.79GiB(35.34%)  tps: 17,567
[rank3]:2025-10-29 22:55:09,342 - INFO - validate step: 2200  loss:  1.8807  memory: 30.93GiB(65.10%)  tps: 19,550
[rank1]:2025-10-29 22:55:09,332 - INFO - validate step: 2200  loss: -1.0000  memory: 15.73GiB(33.12%)  tps: 17,554
[rank2]:2025-10-29 22:55:09,350 - INFO - validate step: 2200  loss: -1.0000  memory: 12.04GiB(25.35%)  tps: 17,539
[rank0]:2025-10-29 22:55:09,429 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_2255_stage0_step2200.svg
[rank1]:2025-10-29 22:55:09,428 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_2255_stage1_step2200.svg
[rank2]:2025-10-29 22:55:09,428 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_2255_stage2_step2200.svg
[rank0]:2025-10-29 22:55:09,488 - INFO - Avg. fwd time: 8.9704 / Avg. bwd time: 3.4548 / Avg. batch time: 538.0524 (ms) / GPU bubble ratio: 81.53%
[rank3]:2025-10-29 22:55:09,546 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/pipeline_schedule/251029_2255_real_step2200_rank3.svg
[rank3]:> Batch Time: 356.61 ms, GPU Bubble Ratio: 79.63%, 52.22%, 62.93%, 13.13%
[rank3]:2025-10-29 22:55:09,614 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_2255_stage3_step2200.svg
[rank3]:2025-10-29 22:55:09,823 - INFO - Avg. fwd time: 12.6502 / Avg. bwd time: 25.5557 / Avg. batch time: 365.7206 (ms) / GPU bubble ratio: 16.43%
[rank2]:2025-10-29 22:55:09,860 - INFO - Avg. fwd time: 8.3468 / Avg. bwd time: 8.5959 / Avg. batch time: 494.5464 (ms) / GPU bubble ratio: 72.59%
[rank1]:2025-10-29 22:55:09,901 - INFO - Avg. fwd time: 10.5935 / Avg. bwd time: 12.4209 / Avg. batch time: 522.2438 (ms) / GPU bubble ratio: 64.75%
[rank0]:2025-10-29 22:55:58,605 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-29 22:55:59,398 - INFO -  step: 2250  loss: -2.0000  grad_norm:  0.0000  memory: 16.79GiB(35.34%)  tps: 8,178  tflops: 62.29  mfu: 19.96%
[rank1]:2025-10-29 22:55:59,398 - INFO -  step: 2250  loss: -2.0000  grad_norm:  0.0000  memory: 15.73GiB(33.12%)  tps: 8,181  tflops: 62.31  mfu: 19.97%
[rank2]:2025-10-29 22:55:59,397 - INFO -  step: 2250  loss: -2.0000  grad_norm:  0.0000  memory: 12.04GiB(25.35%)  tps: 8,184  tflops: 62.33  mfu: 19.98%
[rank3]:2025-10-29 22:56:01,780 - INFO -  step: 2250  loss:  3.6261  grad_norm:  0.0000  memory: 30.93GiB(65.10%)  tps: 7,811  tflops: 59.49  mfu: 19.07%
[rank0]:2025-10-29 22:56:50,789 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 22:56:51,583 - INFO -  step: 2300  loss: -2.0000  grad_norm:  0.0000  memory: 16.79GiB(35.34%)  tps: 7,849  tflops: 59.78  mfu: 19.16%
[rank1]:2025-10-29 22:56:51,583 - INFO -  step: 2300  loss: -2.0000  grad_norm:  0.0000  memory: 15.73GiB(33.12%)  tps: 7,849  tflops: 59.78  mfu: 19.16%
[rank2]:2025-10-29 22:56:51,583 - INFO -  step: 2300  loss: -2.0000  grad_norm:  0.0000  memory: 12.04GiB(25.35%)  tps: 7,849  tflops: 59.78  mfu: 19.16%
[rank3]:2025-10-29 22:56:53,983 - INFO -  step: 2300  loss:  3.5546  grad_norm:  0.0000  memory: 30.93GiB(65.10%)  tps: 7,847  tflops: 59.76  mfu: 19.15%
[rank0]:2025-10-29 22:56:54,062 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_2256_stage0_step2300.svg
[rank0]:2025-10-29 22:56:54,123 - INFO - Avg. fwd time: 8.9759 / Avg. bwd time: 3.2969 / Avg. batch time: 535.9946 (ms) / GPU bubble ratio: 81.68%
[rank1]:2025-10-29 22:56:54,063 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_2256_stage1_step2300.svg
[rank2]:2025-10-29 22:56:54,063 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_2256_stage2_step2300.svg
[rank3]:2025-10-29 22:56:54,185 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/pipeline_schedule/251029_2256_real_step2300_rank3.svg
[rank3]:> Batch Time: 355.69 ms, GPU Bubble Ratio: 79.58%, 52.09%, 62.83%, 13.16%
[rank3]:2025-10-29 22:56:54,254 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_2256_stage3_step2300.svg
[rank3]:2025-10-29 22:56:54,463 - INFO - Avg. fwd time: 12.6815 / Avg. bwd time: 25.3429 / Avg. batch time: 364.2383 (ms) / GPU bubble ratio: 16.48%
[rank2]:2025-10-29 22:56:54,500 - INFO - Avg. fwd time: 8.3505 / Avg. bwd time: 8.5735 / Avg. batch time: 492.7937 (ms) / GPU bubble ratio: 72.53%
[rank1]:2025-10-29 22:56:54,538 - INFO - Avg. fwd time: 10.6050 / Avg. bwd time: 12.3326 / Avg. batch time: 520.3516 (ms) / GPU bubble ratio: 64.74%
[rank0]:2025-10-29 22:57:43,046 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 22:57:43,849 - INFO -  step: 2350  loss: -2.0000  grad_norm:  0.0000  memory: 15.73GiB(33.12%)  tps: 7,837  tflops: 59.69  mfu: 19.13%
[rank0]:2025-10-29 22:57:43,849 - INFO -  step: 2350  loss: -2.0000  grad_norm:  0.0000  memory: 16.79GiB(35.34%)  tps: 7,837  tflops: 59.69  mfu: 19.13%
[rank2]:2025-10-29 22:57:43,849 - INFO -  step: 2350  loss: -2.0000  grad_norm:  0.0000  memory: 12.04GiB(25.35%)  tps: 7,837  tflops: 59.69  mfu: 19.13%
[rank3]:2025-10-29 22:57:46,229 - INFO -  step: 2350  loss:  3.5255  grad_norm:  0.0000  memory: 30.93GiB(65.10%)  tps: 7,840  tflops: 59.71  mfu: 19.14%
[rank0]:2025-10-29 22:58:35,094 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 22:58:35,908 - INFO -  step: 2400  loss: -2.0000  grad_norm:  0.0000  memory: 15.73GiB(33.12%)  tps: 7,869  tflops: 59.93  mfu: 19.21%
[rank1]:2025-10-29 22:58:35,908 - INFO -  final step: 2400  loss: -2.0000  grad_norm:  0.0000  tps: 7,473  tflops: 56.91  mfu: 17.69%
[rank1]:2025-10-29 22:58:35,908 - INFO - ðŸ”Ž  Running validation at step 2400
[rank0]:2025-10-29 22:58:35,908 - INFO -  step: 2400  loss: -2.0000  grad_norm:  0.0000  memory: 16.79GiB(35.34%)  tps: 7,868  tflops: 59.93  mfu: 19.21%
[rank0]:2025-10-29 22:58:35,908 - INFO -  final step: 2400  loss: -2.0000  grad_norm:  0.0000  tps: 7,473  tflops: 56.92  mfu: 17.69%
[rank0]:2025-10-29 22:58:35,908 - INFO - ðŸ”Ž  Running validation at step 2400
[rank2]:2025-10-29 22:58:35,907 - INFO -  step: 2400  loss: -2.0000  grad_norm:  0.0000  memory: 12.04GiB(25.35%)  tps: 7,868  tflops: 59.93  mfu: 19.21%
[rank2]:2025-10-29 22:58:35,907 - INFO -  final step: 2400  loss: -2.0000  grad_norm:  0.0000  tps: 7,473  tflops: 56.92  mfu: 17.69%
[rank2]:2025-10-29 22:58:35,908 - INFO - ðŸ”Ž  Running validation at step 2400
[rank3]:2025-10-29 22:58:38,288 - INFO -  step: 2400  loss:  3.5576  grad_norm:  0.0000  memory: 30.93GiB(65.10%)  tps: 7,868  tflops: 59.93  mfu: 19.21%
[rank3]:2025-10-29 22:58:38,288 - INFO -  final step: 2400  loss:  3.5576  grad_norm:  0.0000  tps: 7,396  tflops: 56.33  mfu: 17.50%
[rank3]:2025-10-29 22:58:38,289 - INFO - ðŸ”Ž  Running validation at step 2400
[rank3]:2025-10-29 22:58:58,940 - INFO - validate step: 2400  loss:  1.8808  memory: 30.93GiB(65.10%)  tps: 19,835
[rank3]:2025-10-29 22:58:58,940 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-29 22:58:58,942 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank1]:2025-10-29 22:58:58,930 - INFO - validate step: 2400  loss: -1.0000  memory: 15.73GiB(33.12%)  tps: 17,792
[rank1]:2025-10-29 22:58:58,930 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-29 22:58:58,932 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank0]:2025-10-29 22:58:58,907 - INFO - validate step: 2400  loss: -1.0000  memory: 16.79GiB(35.34%)  tps: 17,809
[rank0]:2025-10-29 22:58:58,908 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-29 22:58:58,911 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank2]:2025-10-29 22:58:58,947 - INFO - validate step: 2400  loss: -1.0000  memory: 12.04GiB(25.35%)  tps: 17,778
[rank2]:2025-10-29 22:58:58,948 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-29 22:58:58,950 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank0]:2025-10-29 22:59:01,483 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank1]:2025-10-29 22:59:01,564 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_2259_stage1_final2400.svg
[rank0]:2025-10-29 22:59:01,563 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_2259_stage0_final2400.svg
[rank2]:2025-10-29 22:59:01,563 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_2259_stage2_final2400.svg
[rank3]:2025-10-29 22:59:01,681 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/pipeline_schedule/251029_2259_real_final2400_rank3.svg
[rank3]:> Batch Time: 354.72 ms, GPU Bubble Ratio: 79.52%, 51.96%, 62.73%, 13.20%
[rank1]:2025-10-29 22:59:01,768 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/frozen_params_histogram/251029_2259_rank1_stage1.svg
[rank1]:	> Counts Sum: 1434380, Total Sum: 1670400 (85.87%), Ratio(%) per element: [85.93, 85.99, 85.99, 86.15, 85.61, 85.93, 85.72, 86.09, 86.2, 86.09, 85.82, 85.88, 85.88, 85.99, 85.72, 85.66, 85.82, 85.82, 85.56, 85.93, 85.88, 85.99, 85.77, 85.99, 85.77, 86.04, 85.99, 85.88, 85.99, 85.56, 85.5, 85.82, 86.04, 85.88, 85.88, 86.09, 85.5, 85.77, 85.93, 85.99, 85.77, 85.93, 85.61, 85.61, 85.99]
[rank1]:2025-10-29 22:59:01,769 - INFO - Destroying the purge thread.
[rank0]:2025-10-29 22:59:01,781 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/frozen_params_histogram/251029_2259_rank0_stage0.svg
[rank0]:	> Counts Sum: 1183840, Total Sum: 1373440 (86.20%), Ratio(%) per element: [85.88, 86.36, 86.36, 85.82, 86.2, 86.42, 86.36, 86.2, 85.93, 86.04, 86.69, 86.04, 86.2, 86.04, 86.26, 85.93, 86.36, 86.36, 86.2, 86.26, 85.99, 86.31, 86.26, 86.42, 86.26, 86.2, 86.47, 86.2, 86.42, 85.99, 86.04, 85.77, 85.88, 86.15, 86.36, 86.26, 86.15]
[rank0]:2025-10-29 22:59:01,781 - INFO - Sleeping 2 seconds for other ranks to complete
[rank2]:2025-10-29 22:59:01,777 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/frozen_params_histogram/251029_2259_rank2_stage2.svg
[rank2]:	> Counts Sum: 1155880, Total Sum: 1336320 (86.50%), Ratio(%) per element: [86.53, 86.53, 86.47, 86.53, 86.53, 86.42, 86.58, 86.53, 86.58, 86.47, 86.42, 86.47, 86.42, 86.53, 86.58, 86.47, 86.47, 86.47, 86.53, 86.53, 86.58, 86.47, 86.42, 86.42, 86.47, 86.47, 86.36, 86.42, 86.53, 86.47, 86.42, 86.63, 86.58, 86.42, 86.53, 86.53]
[rank2]:2025-10-29 22:59:01,778 - INFO - Destroying the purge thread.
[rank3]:2025-10-29 22:59:01,866 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/pipeline_schedule/251029_2259_thry_final2400_rank3.svg
[rank3]:> Batch Time: 337.12 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:2025-10-29 22:59:01,934 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_2259_stage3_final2400.svg
[rank3]:2025-10-29 22:59:02,130 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1/frozen_params_histogram/251029_2259_rank3_stage3.svg
[rank3]:	> Counts Sum: 116080, Total Sum: 1076480 (10.78%), Ratio(%) per element: [11.15, 10.82, 10.99, 11.2, 11.2, 10.99, 11.04, 11.15, 11.47, 10.56, 10.93, 11.09, 10.99, 11.15, 11.53, 10.82, 11.31, 10.93, 10.72, 11.53, 11.69, 10.99, 10.99, 11.74, 11.53, 11.36, 11.63, 11.09, 0.0]
[rank3]:2025-10-29 22:59:02,131 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank1]:2025-10-29 22:59:02,574 - INFO - Process group destroyed
[rank2]:2025-10-29 22:59:02,577 - INFO - Process group destroyed
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–„â–â–â–â–â–â–â–â–â–â–â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–‡â–‡â–ƒâ–â–„â–‚â–â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–‡â–‡â–ƒâ–â–„â–‚â–â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 1.10762
[rank3]:wandb:               final/avg_loss 3.55758
[rank3]:wandb:             final/avg_mfu(%) 17.49691
[rank3]:wandb:             final/avg_tflops 56.33003
[rank3]:wandb:    final/avg_throughput(tps) 7396.06802
[rank3]:wandb:              final/grad_norm 0
[rank3]:wandb:               final/max_loss 3.55758
[rank3]:wandb:                    grad_norm 0
[rank3]:wandb: loss_metrics/global_avg_loss 3.55758
[rank3]:wandb: loss_metrics/global_max_loss 3.55758
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1029_GPipe_timelyapf_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/2j7y6qzp
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1029_GPipe_timelyapf_dm1/20251029-2209/wandb/run-20251029_220936-2j7y6qzp/logs
[rank3]:2025-10-29 22:59:03,554 - INFO - Process group destroyed
[rank0]:2025-10-29 22:59:03,781 - INFO - Training completed
[rank0]:2025-10-29 22:59:03,782 - INFO - Destroying the purge thread.
[rank0]:2025-10-29 22:59:04,432 - INFO - Process group destroyed
[rank2]:Stage 2: Modules to keep: {'layers.9', 'layers.11', 'layers.12', 'layers.10'}
[rank1]:Stage 1: Modules to keep: {'layers.6', 'layers.7', 'layers.4', 'layers.5', 'layers.8'}
[rank0]:Stage 0: Modules to keep: {'layers.0', 'layers.3', 'layers.1', 'tok_embeddings', 'layers.2'}
[rank3]:Stage 3: Modules to keep: {'norm', 'layers.15', 'layers.13', 'output', 'layers.14'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1029_llama1b/config.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1029_GPipe_timelyapf_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1029_GPipe_timelyapf_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1029_GPipe_timelyapf_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1029_GPipe_timelyapf_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1029_GPipe_timelyapf_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1029_GPipe_timelyapf_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B-Instruct
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 1e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: alpaca
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 512
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 2400
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: GPipe
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 4
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1029_GPipe_timelyapf_dm1
[rank3]:		- interval: 800
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B-Instruct/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1029_GPipe_timelyapf_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: True
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: timelyapf
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- aggressiveness: 0
[rank3]:
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
