
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 10. 30. (ëª©) 15:41:38 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 3,4,5,6
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1029_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1029_llama1b/1029_Interleaved1F1B_timelyauto.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
âœ”ï¸Running with timelyauto x Interleaved1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1029_llama1b/config.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=timelyauto
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank1]:2025-10-30 15:41:44,602 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank2]:2025-10-30 15:41:44,521 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank3]:2025-10-30 15:41:44,522 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank0]:2025-10-30 15:41:44,652 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank0]:2025-10-30 15:41:44,982 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-10-30 15:41:44,985 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-30 15:41:44,988 - INFO - [GC] Initial GC collection 0.00 seconds
[rank3]:2025-10-30 15:41:44,998 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-10-30 15:41:45,000 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-10-30 15:41:45,013 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-10-30 15:41:45,016 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-10-30 15:41:45,015 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-10-30 15:41:45,017 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-30 15:41:45,588 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-10-30 15:41:45,977 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank0]:2025-10-30 15:41:48,799 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=512, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank0]:2025-10-30 15:41:48,950 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-10-30 15:41:49,003 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-10-30 15:41:49,005 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank2]:2025-10-30 15:41:48,951 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-10-30 15:41:49,004 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-10-30 15:41:49,031 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1']
[rank0]:2025-10-30 15:41:49,044 - INFO - PP rank 0 is building stage_idx 4 with modules ['layers.9', 'layers.10']
[rank0]:2025-10-30 15:41:49,045 - INFO - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank2]:2025-10-30 15:41:49,031 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.5', 'layers.6']
[rank2]:2025-10-30 15:41:49,043 - INFO - PP rank 2 is building stage_idx 6 with modules ['layers.13', 'layers.14']
[rank2]:2025-10-30 15:41:49,045 - INFO - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank0]:2025-10-30 15:41:49,245 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-10-30 15:41:49,246 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-10-30 15:41:49,246 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank1]:2025-10-30 15:41:49,312 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-10-30 15:41:49,248 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-10-30 15:41:49,248 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-10-30 15:41:49,248 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank1]:2025-10-30 15:41:49,349 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-10-30 15:41:49,375 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.2', 'layers.3', 'layers.4']
[rank1]:2025-10-30 15:41:49,387 - INFO - PP rank 1 is building stage_idx 5 with modules ['layers.11', 'layers.12']
[rank1]:2025-10-30 15:41:49,389 - INFO - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank1]:2025-10-30 15:41:50,334 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-10-30 15:41:50,334 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-10-30 15:41:50,335 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run moqyevd0
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1029_Interleaved1F1B_timelyauto_dm1/20251030-1541/wandb/run-20251030_154150-moqyevd0
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1029_Interleaved1F1B_timelyauto_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/moqyevd0
[rank3]:2025-10-30 15:41:51,493 - INFO - WandB logging enabled
[rank3]:2025-10-30 15:41:51,595 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-10-30 15:41:51,636 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-10-30 15:41:51,666 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.7', 'layers.8']
[rank3]:2025-10-30 15:41:51,680 - INFO - PP rank 3 is building stage_idx 7 with modules ['layers.15', 'norm', 'output']
[rank3]:2025-10-30 15:41:51,682 - INFO - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank1]:2025-10-30 15:41:52,310 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-10-30 15:41:52,310 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1029_Interleaved1F1B_timelyauto_dm1
[rank0]:2025-10-30 15:41:52,310 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-10-30 15:41:52,311 - INFO - Preparing c4_validation dataset from allenai/c4
[rank2]:2025-10-30 15:41:52,310 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-10-30 15:41:52,293 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-10-30 15:41:52,294 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-10-30 15:41:52,294 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2025-10-30 15:41:52,310 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-10-30 15:41:57,988 - INFO - Trainer is initialized with local batch size 32, global batch size 64, gradient accumulation steps 2, sequence length 512, total steps 2400 (warmup 100)
[rank0]:2025-10-30 15:41:57,988 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B-Instruct/original_dcp.
[rank0]:2025-10-30 15:42:00,262 - INFO - [GC] GC collection for checkpoint loading. 0.01 seconds
[rank0]:2025-10-30 15:42:00,262 - INFO - Finished loading the checkpoint in 2.27 seconds.
[rank0]:2025-10-30 15:42:00,263 - INFO - Training starts at step 1
[rank3]:2025-10-30 15:42:03,674 - INFO -  step:  1  loss:  9.0164  grad_norm: 85.2013  memory: 14.85GiB(31.25%)  tps: 681  tflops: 5.18  mfu: 1.66%
[rank3]:2025-10-30 15:42:03,674 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-10-30 15:42:03,671 - INFO -  step:  1  loss: -2.0000  grad_norm: 85.2013  memory:  9.19GiB(19.34%)  tps: 572  tflops: 4.36  mfu: 1.40%
[rank1]:2025-10-30 15:42:03,671 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-10-30 15:42:03,662 - INFO -  step:  1  loss: -2.0000  grad_norm: 85.2013  memory:  6.14GiB(12.92%)  tps: 559  tflops: 4.26  mfu: 1.36%
[rank2]:2025-10-30 15:42:03,662 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-10-30 15:42:03,702 - INFO -  step:  1  loss: -2.0000  grad_norm: 85.2013  memory: 10.83GiB(22.79%)  tps: 557  tflops: 4.24  mfu: 1.36%
[rank0]:2025-10-30 15:42:03,702 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-30 15:42:22,898 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 15:42:22,899 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 15:42:22,900 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 15:42:22,900 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 15:42:22,900 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 15:42:22,901 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 15:42:22,901 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 15:42:22,901 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 15:42:22,901 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 15:42:22,902 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 15:42:22,902 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 15:42:22,902 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 15:42:22,903 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 15:42:22,903 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 15:42:22,903 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 15:42:22,903 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 15:42:22,904 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 15:42:22,904 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 15:42:22,904 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 15:42:22,905 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 15:42:22,905 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 15:42:22,905 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 15:42:22,905 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 15:42:22,906 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 15:42:22,906 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 15:42:22,906 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 15:42:22,906 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 15:42:22,907 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 15:42:22,907 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 15:42:22,907 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 15:42:22,908 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 15:42:22,908 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 15:42:22,946 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 15:42:22,946 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 15:42:22,946 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 15:42:22,946 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 15:42:22,947 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 15:42:22,947 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 15:42:22,947 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 15:42:22,947 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 15:42:22,947 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 15:42:22,947 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 15:42:22,947 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 15:42:22,947 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 15:42:22,947 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 15:42:22,947 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 15:42:22,947 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 15:42:22,947 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 15:42:22,948 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 15:42:22,948 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 15:42:22,948 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 15:42:22,948 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 15:42:22,948 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 15:42:22,948 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 15:42:22,948 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 15:42:22,948 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 15:42:22,948 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 15:42:22,948 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 15:42:22,948 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 15:42:22,948 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 15:42:22,949 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 15:42:22,949 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 15:42:22,949 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 15:42:22,949 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 15:42:22,924 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 15:42:22,925 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 15:42:22,925 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 15:42:22,925 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 15:42:22,925 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 15:42:22,925 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 15:42:22,925 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 15:42:22,925 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 15:42:22,925 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 15:42:22,925 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 15:42:22,926 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 15:42:22,926 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 15:42:22,926 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 15:42:22,926 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 15:42:22,926 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 15:42:22,926 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 15:42:22,926 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 15:42:22,926 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 15:42:22,926 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 15:42:22,926 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 15:42:22,926 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 15:42:22,927 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 15:42:22,927 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 15:42:22,927 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 15:42:22,927 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 15:42:22,927 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 15:42:22,927 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 15:42:22,927 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 15:42:22,927 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 15:42:22,927 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 15:42:22,927 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 15:42:22,928 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 15:42:22,967 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 15:42:22,967 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 15:42:22,967 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 15:42:22,968 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 15:42:22,968 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 15:42:22,968 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 15:42:22,968 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 15:42:22,968 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 15:42:22,968 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 15:42:22,968 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 15:42:22,968 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 15:42:22,968 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 15:42:22,968 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 15:42:22,968 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 15:42:22,968 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 15:42:22,969 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 15:42:22,969 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 15:42:22,969 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 15:42:22,969 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 15:42:22,969 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 15:42:22,969 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 15:42:22,969 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 15:42:22,969 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 15:42:22,969 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 15:42:22,969 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 15:42:22,969 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 15:42:22,969 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 15:42:22,969 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 15:42:22,970 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 15:42:22,970 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 15:42:22,970 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 15:42:22,970 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 15:43:06,853 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-30 15:43:08,193 - INFO -  step: 50  loss:  8.5034  grad_norm: 35.3439  memory: 18.19GiB(38.28%)  tps: 6,222  tflops: 47.39  mfu: 15.19%
[rank1]:2025-10-30 15:43:08,184 - INFO -  step: 50  loss: -2.0000  grad_norm: 35.3439  memory: 11.85GiB(24.93%)  tps: 6,222  tflops: 47.39  mfu: 15.19%
[rank2]:2025-10-30 15:43:08,181 - INFO -  step: 50  loss: -2.0000  grad_norm: 35.3439  memory:  8.11GiB(17.07%)  tps: 6,222  tflops: 47.39  mfu: 15.19%
[rank0]:2025-10-30 15:43:08,195 - INFO -  step: 50  loss: -2.0000  grad_norm: 35.3439  memory: 14.71GiB(30.97%)  tps: 6,224  tflops: 47.40  mfu: 15.19%
[rank3]:2025-10-30 15:43:21,045 - INFO - [Step 60] ã€°ï¸ Monitoring Upperbound
[rank3]:2025-10-30 15:43:34,216 - WARNING - [Step 70] â³ Monitoring Upperbound... (140/150)
[rank2]:2025-10-30 15:43:34,443 - WARNING - [Step 70] â³ Monitoring Upperbound... (140/150)
[rank0]:2025-10-30 15:43:34,476 - WARNING - [Step 70] â³ Monitoring Upperbound... (140/150)
[rank1]:2025-10-30 15:43:34,460 - WARNING - [Step 70] â³ Monitoring Upperbound... (140/150)
[rank3]:2025-10-30 15:43:47,423 - INFO - [Step 80] âœ”ï¸  Setting Upperbound
[rank3]:2025-10-30 15:43:47,719 - INFO - [Step 80] ã€°ï¸ Monitoring Lowerbound
[rank3]:2025-10-30 15:43:47,753 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-30 15:43:47,760 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-30 15:43:47,768 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-30 15:43:47,770 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-30 15:43:47,763 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-30 15:43:47,772 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-30 15:43:47,781 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-30 15:43:47,794 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-30 15:43:47,816 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-30 15:43:47,838 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-30 15:43:47,775 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-30 15:43:47,791 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-30 15:43:47,810 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-30 15:43:47,824 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-30 15:43:47,845 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-30 15:43:47,783 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-30 15:43:47,799 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-30 15:43:47,820 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-30 15:43:47,840 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-30 15:43:47,860 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-30 15:43:47,787 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-30 15:43:47,806 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-30 15:43:47,824 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-30 15:43:47,844 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-30 15:43:47,860 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-30 15:43:47,903 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-30 15:43:47,936 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-30 15:43:47,886 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-30 15:43:47,912 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-30 15:43:47,945 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-30 15:43:47,918 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-30 15:43:47,924 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-30 15:43:47,969 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-30 15:43:47,902 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-30 15:43:47,926 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-30 15:43:47,970 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-30 15:43:47,978 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-30 15:43:47,985 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-30 15:43:47,998 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-30 15:43:48,004 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-30 15:43:48,011 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-30 15:43:47,976 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-30 15:43:47,984 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-30 15:43:47,996 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-30 15:43:48,002 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-30 15:43:48,013 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-30 15:43:48,021 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-30 15:43:48,032 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-30 15:43:47,984 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-30 15:43:47,993 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-30 15:43:47,999 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-30 15:43:48,006 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-30 15:43:48,015 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-30 15:43:48,026 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-30 15:43:48,038 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-30 15:43:47,975 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-30 15:43:47,994 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-30 15:43:47,999 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-30 15:43:48,007 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-30 15:43:48,015 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-30 15:43:48,019 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-30 15:43:48,033 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-30 15:43:48,048 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-30 15:43:48,060 - WARNING - Batch index 161 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-30 15:44:06,005 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-30 15:44:06,965 - INFO -  step: 100  loss:  7.8881  grad_norm:  0.0000  memory: 18.19GiB(38.28%)  tps: 6,969  tflops: 53.08  mfu: 17.01%
[rank2]:2025-10-30 15:44:06,964 - INFO -  step: 100  loss: -2.0000  grad_norm:  0.0000  memory:  8.11GiB(17.07%)  tps: 6,968  tflops: 53.07  mfu: 17.01%
[rank0]:2025-10-30 15:44:06,967 - INFO -  step: 100  loss: -2.0000  grad_norm:  0.0000  memory: 14.71GiB(30.97%)  tps: 6,969  tflops: 53.08  mfu: 17.01%
[rank1]:2025-10-30 15:44:06,967 - INFO -  step: 100  loss: -2.0000  grad_norm:  0.0000  memory: 11.85GiB(24.93%)  tps: 6,968  tflops: 53.07  mfu: 17.01%
[rank2]:2025-10-30 15:44:07,047 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank2/251030_1544_stage2_step100.svg
[rank0]:2025-10-30 15:44:07,047 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank0/251030_1544_stage0_step100.svg
[rank1]:2025-10-30 15:44:07,046 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank1/251030_1544_stage1_step100.svg
[rank2]:2025-10-30 15:44:07,106 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank2/251030_1544_stage6_step100.svg
[rank0]:2025-10-30 15:44:07,104 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank0/251030_1544_stage4_step100.svg
[rank1]:2025-10-30 15:44:07,103 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank1/251030_1544_stage5_step100.svg
[rank3]:2025-10-30 15:44:07,297 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/pipeline_schedule/251030_1544_real_step100_rank3.svg
[rank3]:> Batch Time: 498.82 ms, GPU Bubble Ratio: 49.30%, 46.37%, 56.85%, 13.07%
[rank3]:2025-10-30 15:44:07,361 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank3/251030_1544_stage3_step100.svg
[rank3]:2025-10-30 15:44:07,418 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank3/251030_1544_stage7_step100.svg
[rank0]:2025-10-30 15:44:07,594 - INFO - Avg. fwd time: 4.1288 / Avg. bwd time: 10.7728 / Avg. batch time: 617.0055 (ms) / GPU bubble ratio: 61.36%
[rank3]:2025-10-30 15:44:07,670 - INFO - Avg. fwd time: 6.4210 / Avg. bwd time: 19.7900 / Avg. batch time: 536.7764 (ms) / GPU bubble ratio: 21.87%
[rank2]:2025-10-30 15:44:07,689 - INFO - Avg. fwd time: 3.9213 / Avg. bwd time: 9.3582 / Avg. batch time: 568.1941 (ms) / GPU bubble ratio: 62.61%
[rank1]:2025-10-30 15:44:07,706 - INFO - Avg. fwd time: 5.0151 / Avg. bwd time: 11.2683 / Avg. batch time: 595.9534 (ms) / GPU bubble ratio: 56.28%
[rank3]:2025-10-30 15:44:16,727 - INFO - [Step 110] âœ”ï¸  Setting Lowerbound
[rank3]:2025-10-30 15:44:17,261 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/pipeline_schedule/251030_1544_max_batch_time.svg
[rank3]:> Batch Time: 505.45 ms, GPU Bubble Ratio: 49.28%, 46.58%, 57.04%, 12.85%
[rank3]:2025-10-30 15:44:17,574 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/pipeline_schedule/251030_1544_min_batch_time.svg
[rank3]:> Batch Time: 311.83 ms, GPU Bubble Ratio: 67.96%, 46.86%, 56.34%, 11.02%
[rank3]:2025-10-30 15:44:17,925 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/pipeline_schedule/251030_1544_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 322.38 ms, GPU Bubble Ratio: 33.67%, 27.74%, 39.23%, 9.75%
[rank3]:2025-10-30 15:44:17,925 - INFO - 	> Batch Time: 322.38 ms (Average Freeze Ratio: 0.42, Time Reduction Rate: 0.36)
[rank0]:2025-10-30 15:45:01,806 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-30 15:45:02,927 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.50/0.75, [MB4] 0.67/1.00, [MB5] 0.57/0.85, [MB6] 0.36/0.54, [MB7] 0.67/1.00
[rank2]:2025-10-30 15:45:02,928 - INFO -  step: 150  loss: -2.0000  grad_norm: 16.1420  memory:  8.35GiB(17.57%)  tps: 7,319  tflops: 55.74  mfu: 17.87%
[rank3]:2025-10-30 15:45:02,941 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.13/0.20, [MB1] 0.67/1.00, [MB2] 0.67/1.00, [MB3] 0.67/1.00, [MB0] 0.67/1.00, [MB1] 0.67/1.00, [MB2] 0.67/1.00, [MB3] 0.44/0.66, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.36/0.54
[rank3]:2025-10-30 15:45:02,943 - INFO -  step: 150  loss:  3.7300  grad_norm: 16.1420  memory: 19.24GiB(40.50%)  tps: 7,317  tflops: 55.73  mfu: 17.86%
[rank0]:2025-10-30 15:45:02,930 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.42/0.63, [MB4] 0.09/0.14, [MB5] 0.67/1.00, [MB6] 0.38/0.57, [MB7] 0.67/1.00
[rank0]:2025-10-30 15:45:02,931 - INFO -  step: 150  loss: -2.0000  grad_norm: 16.1420  memory: 15.05GiB(31.67%)  tps: 7,319  tflops: 55.74  mfu: 17.87%
[rank1]:2025-10-30 15:45:02,928 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank1]:2025-10-30 15:45:02,929 - INFO -  step: 150  loss: -2.0000  grad_norm: 16.1420  memory: 12.20GiB(25.67%)  tps: 7,319  tflops: 55.75  mfu: 17.87%
[rank0]:2025-10-30 15:45:56,216 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-30 15:45:57,303 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.75/0.75, [MB4] 1.00/1.00, [MB5] 0.85/0.85, [MB6] 0.54/0.54, [MB7] 1.00/1.00
[rank2]:2025-10-30 15:45:57,304 - INFO -  step: 200  loss: -2.0000  grad_norm:  0.4280  memory:  8.35GiB(17.57%)  tps: 7,533  tflops: 57.37  mfu: 18.39%
[rank2]:2025-10-30 15:45:57,304 - INFO - ðŸ”Ž  Running validation at step 200
[rank3]:2025-10-30 15:45:57,298 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.20/0.20, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 0.66/0.66, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 0.54/0.54
[rank3]:2025-10-30 15:45:57,300 - INFO -  step: 200  loss:  1.3242  grad_norm:  0.4280  memory: 19.24GiB(40.50%)  tps: 7,536  tflops: 57.39  mfu: 18.39%
[rank3]:2025-10-30 15:45:57,301 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-10-30 15:45:57,318 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.63/0.63, [MB4] 0.14/0.14, [MB5] 1.00/1.00, [MB6] 0.57/0.57, [MB7] 1.00/1.00
[rank0]:2025-10-30 15:45:57,318 - INFO -  step: 200  loss: -2.0000  grad_norm:  0.4280  memory: 15.18GiB(31.96%)  tps: 7,531  tflops: 57.36  mfu: 18.38%
[rank0]:2025-10-30 15:45:57,318 - INFO - ðŸ”Ž  Running validation at step 200
[rank1]:2025-10-30 15:45:57,303 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-30 15:45:57,304 - INFO -  step: 200  loss: -2.0000  grad_norm:  0.4280  memory: 12.20GiB(25.67%)  tps: 7,533  tflops: 57.37  mfu: 18.39%
[rank1]:2025-10-30 15:45:57,304 - INFO - ðŸ”Ž  Running validation at step 200
[rank2]:2025-10-30 15:46:26,562 - INFO - validate step: 200  loss: -1.0000  memory:  8.35GiB(17.57%)  tps: 13,999
[rank0]:2025-10-30 15:46:26,536 - INFO - validate step: 200  loss: -1.0000  memory: 15.18GiB(31.96%)  tps: 14,019
[rank3]:2025-10-30 15:46:26,562 - INFO - validate step: 200  loss:  1.4030  memory: 19.24GiB(40.50%)  tps: 13,998
[rank1]:2025-10-30 15:46:26,541 - INFO - validate step: 200  loss: -1.0000  memory: 12.20GiB(25.67%)  tps: 14,010
[rank2]:2025-10-30 15:46:26,639 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank2/251030_1546_stage2_step200.svg
[rank0]:2025-10-30 15:46:26,638 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank0/251030_1546_stage0_step200.svg
[rank1]:2025-10-30 15:46:26,638 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank1/251030_1546_stage1_step200.svg
[rank2]:2025-10-30 15:46:26,706 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank2/251030_1546_stage6_step200.svg
[rank0]:2025-10-30 15:46:26,703 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank0/251030_1546_stage4_step200.svg
[rank1]:2025-10-30 15:46:26,703 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank1/251030_1546_stage5_step200.svg
[rank3]:2025-10-30 15:46:26,873 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/pipeline_schedule/251030_1546_real_step200_rank3.svg
[rank3]:> Batch Time: 443.90 ms, GPU Bubble Ratio: 49.05%, 47.66%, 55.80%, 13.05%
[rank3]:2025-10-30 15:46:26,940 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank3/251030_1546_stage3_step200.svg
[rank3]:2025-10-30 15:46:27,003 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank3/251030_1546_stage7_step200.svg
[rank2]:2025-10-30 15:46:27,304 - INFO - Avg. fwd time: 4.1289 / Avg. bwd time: 8.1077 / Avg. batch time: 527.4518 (ms) / GPU bubble ratio: 62.88%
[rank0]:2025-10-30 15:46:27,307 - INFO - Avg. fwd time: 4.3617 / Avg. bwd time: 8.7889 / Avg. batch time: 568.2149 (ms) / GPU bubble ratio: 62.97%
[rank3]:2025-10-30 15:46:27,272 - INFO - Avg. fwd time: 6.8433 / Avg. bwd time: 16.4909 / Avg. batch time: 494.6453 (ms) / GPU bubble ratio: 24.52%
[rank1]:2025-10-30 15:46:27,315 - INFO - Avg. fwd time: 5.2491 / Avg. bwd time: 9.4407 / Avg. batch time: 550.4163 (ms) / GPU bubble ratio: 57.30%
[rank0]:2025-10-30 15:47:16,028 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-30 15:47:17,026 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.75/0.75, [MB4] 1.00/1.00, [MB5] 0.85/0.85, [MB6] 0.54/0.54, [MB7] 1.00/1.00
[rank2]:2025-10-30 15:47:17,027 - INFO -  step: 250  loss: -2.0000  grad_norm:  0.9898  memory:  8.35GiB(17.57%)  tps: 8,117  tflops: 61.82  mfu: 19.81%
[rank0]:2025-10-30 15:47:17,026 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.63/0.63, [MB4] 0.14/0.14, [MB5] 1.00/1.00, [MB6] 0.57/0.57, [MB7] 1.00/1.00
[rank0]:2025-10-30 15:47:17,026 - INFO -  step: 250  loss: -2.0000  grad_norm:  0.9898  memory: 15.18GiB(31.96%)  tps: 8,113  tflops: 61.79  mfu: 19.80%
[rank3]:2025-10-30 15:47:17,021 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.20/0.20, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 0.66/0.66, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 0.54/0.54
[rank3]:2025-10-30 15:47:17,023 - INFO -  step: 250  loss:  1.8652  grad_norm:  0.9898  memory: 19.24GiB(40.50%)  tps: 8,117  tflops: 61.82  mfu: 19.82%
[rank1]:2025-10-30 15:47:17,026 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-30 15:47:17,026 - INFO -  step: 250  loss: -2.0000  grad_norm:  0.9898  memory: 12.20GiB(25.67%)  tps: 8,113  tflops: 61.79  mfu: 19.81%
[rank0]:2025-10-30 15:48:06,038 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-30 15:48:07,267 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/pipeline_schedule_adjustment/251030_1548_rank2_trend_line.svg
[rank2]:2025-10-30 15:48:07,281 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-30 15:48:07,264 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/pipeline_schedule_adjustment/251030_1548_rank0_trend_line.svg
[rank0]:2025-10-30 15:48:07,280 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-30 15:48:07,283 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-30 15:48:07,284 - INFO -  step: 300  loss: -2.0000  grad_norm:  0.4080  memory: 15.18GiB(31.96%)  tps: 8,150  tflops: 62.07  mfu: 19.90%
[rank3]:2025-10-30 15:48:07,244 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/pipeline_schedule_adjustment/251030_1548_rank3_trend_line.svg
[rank1]:2025-10-30 15:48:07,263 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/pipeline_schedule_adjustment/251030_1548_rank1_trend_line.svg
[rank1]:2025-10-30 15:48:07,280 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 0.96/0.96, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-30 15:48:07,284 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 0.96/0.96, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-30 15:48:07,284 - INFO -  step: 300  loss: -2.0000  grad_norm:  0.4080  memory: 12.20GiB(25.67%)  tps: 8,150  tflops: 62.07  mfu: 19.90%
[rank2]:2025-10-30 15:48:07,284 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-30 15:48:07,285 - INFO -  step: 300  loss: -2.0000  grad_norm:  0.4080  memory:  8.35GiB(17.57%)  tps: 8,150  tflops: 62.07  mfu: 19.89%
[rank0]:2025-10-30 15:48:07,691 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank0/251030_1548_stage0_step300.svg
[rank3]:2025-10-30 15:48:07,612 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/pipeline_schedule/251030_1548_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 341.15 ms, GPU Bubble Ratio: 51.67%, 42.64%, 48.82%, 10.71%
[rank3]:2025-10-30 15:48:07,613 - INFO - 	> Batch Time: 341.15 ms (Average Freeze Ratio: 0.33)
[rank3]:2025-10-30 15:48:07,614 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 0.20/0.20, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 0.09/0.09, [MB7] 1.00/1.00
[rank3]:2025-10-30 15:48:07,617 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 0.20/0.20, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 0.09/0.09, [MB7] 1.00/1.00
[rank3]:2025-10-30 15:48:07,619 - INFO -  step: 300  loss:  1.6073  grad_norm:  0.4080  memory: 19.24GiB(40.50%)  tps: 8,096  tflops: 61.66  mfu: 19.76%
[rank1]:2025-10-30 15:48:07,688 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank1/251030_1548_stage1_step300.svg
[rank2]:2025-10-30 15:48:07,693 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank2/251030_1548_stage2_step300.svg
[rank2]:2025-10-30 15:48:07,760 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank2/251030_1548_stage6_step300.svg
[rank0]:2025-10-30 15:48:07,754 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank0/251030_1548_stage4_step300.svg
[rank1]:2025-10-30 15:48:07,751 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank1/251030_1548_stage5_step300.svg
[rank3]:2025-10-30 15:48:07,947 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/pipeline_schedule/251030_1548_real_step300_rank3.svg
[rank3]:> Batch Time: 373.10 ms, GPU Bubble Ratio: 46.64%, 44.53%, 51.33%, 14.20%
[rank3]:2025-10-30 15:48:08,014 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank3/251030_1548_stage3_step300.svg
[rank3]:2025-10-30 15:48:08,077 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank3/251030_1548_stage7_step300.svg
[rank2]:2025-10-30 15:48:08,544 - INFO - Avg. fwd time: 4.2273 / Avg. bwd time: 7.5851 / Avg. batch time: 505.6669 (ms) / GPU bubble ratio: 62.62%
[rank0]:2025-10-30 15:48:08,565 - INFO - Avg. fwd time: 4.4377 / Avg. bwd time: 7.1583 / Avg. batch time: 540.7926 (ms) / GPU bubble ratio: 65.69%
[rank3]:2025-10-30 15:48:08,523 - INFO - Avg. fwd time: 7.0354 / Avg. bwd time: 14.8823 / Avg. batch time: 473.9982 (ms) / GPU bubble ratio: 26.02%
[rank1]:2025-10-30 15:48:08,557 - INFO - Avg. fwd time: 5.3611 / Avg. bwd time: 8.5080 / Avg. batch time: 526.2607 (ms) / GPU bubble ratio: 57.83%
[rank0]:2025-10-30 15:48:57,253 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-30 15:48:58,261 - INFO -  step: 350  loss: -2.0000  grad_norm:  1.1302  memory: 12.20GiB(25.67%)  tps: 8,035  tflops: 61.20  mfu: 19.61%
[rank3]:2025-10-30 15:48:58,253 - INFO -  step: 350  loss:  1.2306  grad_norm:  0.0000  memory: 19.24GiB(40.50%)  tps: 8,090  tflops: 61.61  mfu: 19.75%
[rank0]:2025-10-30 15:48:58,261 - INFO -  step: 350  loss: -2.0000  grad_norm:  1.1302  memory: 15.18GiB(31.96%)  tps: 8,035  tflops: 61.20  mfu: 19.61%
[rank2]:2025-10-30 15:48:58,261 - INFO -  step: 350  loss: -2.0000  grad_norm:  1.1302  memory:  8.35GiB(17.57%)  tps: 8,035  tflops: 61.20  mfu: 19.61%
[rank0]:2025-10-30 15:49:47,194 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-30 15:49:48,495 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/pipeline_schedule_adjustment/251030_1549_rank0_trend_line.svg
[rank2]:2025-10-30 15:49:48,500 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/pipeline_schedule_adjustment/251030_1549_rank2_trend_line.svg
[rank1]:2025-10-30 15:49:48,499 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/pipeline_schedule_adjustment/251030_1549_rank1_trend_line.svg
[rank1]:2025-10-30 15:49:48,513 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 0.87/0.87, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-30 15:49:48,518 - INFO -  step: 400  loss: -2.0000  grad_norm:  0.2060  memory: 12.20GiB(25.67%)  tps: 8,150  tflops: 62.07  mfu: 19.90%
[rank1]:2025-10-30 15:49:48,518 - INFO - ðŸ”Ž  Running validation at step 400
[rank3]:2025-10-30 15:49:48,499 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/pipeline_schedule_adjustment/251030_1549_rank3_trend_line.svg
[rank0]:2025-10-30 15:49:48,513 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-30 15:49:48,517 - INFO -  step: 400  loss: -2.0000  grad_norm:  0.2060  memory: 15.18GiB(31.96%)  tps: 8,150  tflops: 62.07  mfu: 19.90%
[rank0]:2025-10-30 15:49:48,517 - INFO - ðŸ”Ž  Running validation at step 400
[rank2]:2025-10-30 15:49:48,514 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank2]:2025-10-30 15:49:48,517 - INFO -  step: 400  loss: -2.0000  grad_norm:  0.2060  memory:  8.35GiB(17.57%)  tps: 8,150  tflops: 62.07  mfu: 19.90%
[rank2]:2025-10-30 15:49:48,517 - INFO - ðŸ”Ž  Running validation at step 400
[rank3]:2025-10-30 15:49:48,832 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/pipeline_schedule/251030_1549_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 335.87 ms, GPU Bubble Ratio: 54.08%, 40.49%, 49.89%, 10.58%
[rank3]:2025-10-30 15:49:48,833 - INFO - 	> Batch Time: 335.87 ms (Average Freeze Ratio: 0.31)
[rank3]:2025-10-30 15:49:48,833 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 0.20/0.20, [MB4] 0.58/0.58, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank3]:2025-10-30 15:49:48,838 - INFO -  step: 400  loss:  1.1466  grad_norm:  0.0000  memory: 19.24GiB(40.50%)  tps: 8,098  tflops: 61.67  mfu: 19.77%
[rank3]:2025-10-30 15:49:48,838 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-10-30 15:50:14,791 - INFO - validate step: 400  loss: -1.0000  memory: 15.18GiB(31.96%)  tps: 15,590
[rank2]:2025-10-30 15:50:14,815 - INFO - validate step: 400  loss: -1.0000  memory:  8.35GiB(17.57%)  tps: 15,575
[rank1]:2025-10-30 15:50:14,802 - INFO - validate step: 400  loss: -1.0000  memory: 12.20GiB(25.67%)  tps: 15,584
[rank3]:2025-10-30 15:50:14,811 - INFO - validate step: 400  loss:  1.2278  memory: 19.24GiB(40.50%)  tps: 15,771
[rank0]:2025-10-30 15:50:14,894 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank0/251030_1550_stage0_step400.svg
[rank2]:2025-10-30 15:50:14,894 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank2/251030_1550_stage2_step400.svg
[rank1]:2025-10-30 15:50:14,896 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank1/251030_1550_stage1_step400.svg
[rank1]:2025-10-30 15:50:14,964 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank1/251030_1550_stage5_step400.svg
[rank0]:2025-10-30 15:50:14,962 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank0/251030_1550_stage4_step400.svg
[rank2]:2025-10-30 15:50:14,963 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank2/251030_1550_stage6_step400.svg
[rank3]:2025-10-30 15:50:15,123 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/pipeline_schedule/251030_1550_real_step400_rank3.svg
[rank3]:> Batch Time: 358.61 ms, GPU Bubble Ratio: 60.88%, 42.68%, 50.87%, 12.51%
[rank3]:2025-10-30 15:50:15,192 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank3/251030_1550_stage3_step400.svg
[rank3]:2025-10-30 15:50:15,258 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank3/251030_1550_stage7_step400.svg
[rank0]:2025-10-30 15:50:15,511 - INFO - Avg. fwd time: 4.4374 / Avg. bwd time: 6.6093 / Avg. batch time: 528.2836 (ms) / GPU bubble ratio: 66.54%
[rank3]:2025-10-30 15:50:15,522 - INFO - Avg. fwd time: 7.1341 / Avg. bwd time: 14.0546 / Avg. batch time: 465.1192 (ms) / GPU bubble ratio: 27.11%
[rank2]:2025-10-30 15:50:15,560 - INFO - Avg. fwd time: 4.2758 / Avg. bwd time: 7.3077 / Avg. batch time: 495.6961 (ms) / GPU bubble ratio: 62.61%
[rank1]:2025-10-30 15:50:15,598 - INFO - Avg. fwd time: 5.3846 / Avg. bwd time: 8.4384 / Avg. batch time: 515.2643 (ms) / GPU bubble ratio: 57.08%
[rank0]:2025-10-30 15:51:05,053 - INFO - [GC] Peforming periodical GC collection 0.02 seconds
[rank2]:2025-10-30 15:51:06,078 - INFO -  step: 450  loss: -2.0000  grad_norm:  0.2766  memory:  8.35GiB(17.57%)  tps: 7,990  tflops: 60.86  mfu: 19.51%
[rank0]:2025-10-30 15:51:06,070 - INFO -  step: 450  loss: -2.0000  grad_norm:  0.2766  memory: 15.18GiB(31.96%)  tps: 7,988  tflops: 60.84  mfu: 19.50%
[rank1]:2025-10-30 15:51:06,071 - INFO -  step: 450  loss: -2.0000  grad_norm:  0.2766  memory: 12.20GiB(25.67%)  tps: 7,989  tflops: 60.85  mfu: 19.50%
[rank3]:2025-10-30 15:51:06,062 - INFO -  step: 450  loss:  1.1705  grad_norm:  0.0000  memory: 19.24GiB(40.50%)  tps: 7,992  tflops: 60.87  mfu: 19.51%
[rank0]:2025-10-30 15:51:55,281 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-30 15:51:56,292 - INFO -  step: 500  loss:  1.1706  grad_norm:  0.0000  memory: 19.24GiB(40.50%)  tps: 8,155  tflops: 62.11  mfu: 19.91%
[rank2]:2025-10-30 15:51:56,308 - INFO -  step: 500  loss: -2.0000  grad_norm:  0.3157  memory:  8.35GiB(17.57%)  tps: 8,155  tflops: 62.11  mfu: 19.91%
[rank0]:2025-10-30 15:51:56,300 - INFO -  step: 500  loss: -2.0000  grad_norm:  0.3157  memory: 15.18GiB(31.96%)  tps: 8,155  tflops: 62.11  mfu: 19.91%
[rank1]:2025-10-30 15:51:56,300 - INFO -  step: 500  loss: -2.0000  grad_norm:  0.3157  memory: 12.20GiB(25.67%)  tps: 8,155  tflops: 62.11  mfu: 19.91%
[rank1]:2025-10-30 15:51:56,381 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank1/251030_1551_stage1_step500.svg
[rank2]:2025-10-30 15:51:56,385 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank2/251030_1551_stage2_step500.svg
[rank2]:2025-10-30 15:51:56,450 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank2/251030_1551_stage6_step500.svg
[rank0]:2025-10-30 15:51:56,380 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank0/251030_1551_stage0_step500.svg
[rank0]:2025-10-30 15:51:56,442 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank0/251030_1551_stage4_step500.svg
[rank1]:2025-10-30 15:51:56,444 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank1/251030_1551_stage5_step500.svg
[rank3]:2025-10-30 15:51:56,621 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/pipeline_schedule/251030_1551_real_step500_rank3.svg
[rank3]:> Batch Time: 349.47 ms, GPU Bubble Ratio: 60.51%, 38.02%, 49.10%, 13.15%
[rank3]:2025-10-30 15:51:56,684 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank3/251030_1551_stage3_step500.svg
[rank3]:2025-10-30 15:51:56,745 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank3/251030_1551_stage7_step500.svg
[rank0]:2025-10-30 15:51:56,936 - INFO - Avg. fwd time: 4.4814 / Avg. bwd time: 5.9475 / Avg. batch time: 520.5776 (ms) / GPU bubble ratio: 67.95%
[rank3]:2025-10-30 15:51:57,005 - INFO - Avg. fwd time: 7.2009 / Avg. bwd time: 13.4493 / Avg. batch time: 457.8470 (ms) / GPU bubble ratio: 27.84%
[rank1]:2025-10-30 15:51:57,080 - INFO - Avg. fwd time: 5.3992 / Avg. bwd time: 8.3890 / Avg. batch time: 508.6254 (ms) / GPU bubble ratio: 56.63%
[rank2]:2025-10-30 15:51:57,073 - INFO - Avg. fwd time: 4.2674 / Avg. bwd time: 7.5592 / Avg. batch time: 489.7834 (ms) / GPU bubble ratio: 61.37%
[rank0]:2025-10-30 15:52:46,341 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-30 15:52:47,356 - INFO -  step: 550  loss:  1.1414  grad_norm:  0.0000  memory: 19.24GiB(40.50%)  tps: 8,022  tflops: 61.09  mfu: 19.58%
[rank2]:2025-10-30 15:52:47,372 - INFO -  step: 550  loss: -2.0000  grad_norm:  1.0405  memory:  8.35GiB(17.57%)  tps: 8,021  tflops: 61.09  mfu: 19.58%
[rank0]:2025-10-30 15:52:47,364 - INFO -  step: 550  loss: -2.0000  grad_norm:  1.0405  memory: 15.18GiB(31.96%)  tps: 8,021  tflops: 61.09  mfu: 19.58%
[rank1]:2025-10-30 15:52:47,365 - INFO -  step: 550  loss: -2.0000  grad_norm:  1.0405  memory: 12.20GiB(25.67%)  tps: 8,021  tflops: 61.09  mfu: 19.58%
[rank0]:2025-10-30 15:53:37,144 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-30 15:53:38,559 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/pipeline_schedule_adjustment/251030_1553_rank0_trend_line.svg
[rank1]:2025-10-30 15:53:38,559 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/pipeline_schedule_adjustment/251030_1553_rank1_trend_line.svg
[rank3]:2025-10-30 15:53:38,569 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/pipeline_schedule_adjustment/251030_1553_rank3_trend_line.svg
[rank2]:2025-10-30 15:53:38,621 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/pipeline_schedule_adjustment/251030_1553_rank2_trend_line.svg
[rank2]:2025-10-30 15:53:38,635 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00, [MB4] 0.63/0.63, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-30 15:53:38,641 - INFO -  step: 600  loss: -2.0000  grad_norm:  0.2048  memory:  8.35GiB(17.57%)  tps: 7,989  tflops: 60.85  mfu: 19.50%
[rank2]:2025-10-30 15:53:38,641 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-10-30 15:53:38,634 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank0]:2025-10-30 15:53:38,638 - INFO -  step: 600  loss: -2.0000  grad_norm:  0.2048  memory: 15.18GiB(31.96%)  tps: 7,989  tflops: 60.84  mfu: 19.50%
[rank0]:2025-10-30 15:53:38,638 - INFO - ðŸ”Ž  Running validation at step 600
[rank1]:2025-10-30 15:53:38,634 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 0.76/0.76, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-30 15:53:38,639 - INFO -  step: 600  loss: -2.0000  grad_norm:  0.2048  memory: 12.20GiB(25.67%)  tps: 7,989  tflops: 60.84  mfu: 19.50%
[rank1]:2025-10-30 15:53:38,639 - INFO - ðŸ”Ž  Running validation at step 600
[rank3]:2025-10-30 15:53:38,952 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/pipeline_schedule/251030_1553_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 330.84 ms, GPU Bubble Ratio: 57.94%, 38.66%, 45.06%, 12.03%
[rank3]:2025-10-30 15:53:38,953 - INFO - 	> Batch Time: 330.84 ms (Average Freeze Ratio: 0.23)
[rank3]:2025-10-30 15:53:38,953 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 0.20/0.20, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank3]:2025-10-30 15:53:38,958 - INFO -  step: 600  loss:  1.1261  grad_norm:  0.0000  memory: 19.24GiB(40.50%)  tps: 7,938  tflops: 60.46  mfu: 19.38%
[rank3]:2025-10-30 15:53:38,958 - INFO - ðŸ”Ž  Running validation at step 600
[rank2]:2025-10-30 15:54:05,109 - INFO - validate step: 600  loss: -1.0000  memory:  8.35GiB(17.57%)  tps: 15,475
[rank0]:2025-10-30 15:54:05,085 - INFO - validate step: 600  loss: -1.0000  memory: 15.18GiB(31.96%)  tps: 15,488
[rank1]:2025-10-30 15:54:05,091 - INFO - validate step: 600  loss: -1.0000  memory: 12.20GiB(25.67%)  tps: 15,484
[rank3]:2025-10-30 15:54:05,102 - INFO - validate step: 600  loss:  1.2087  memory: 19.24GiB(40.50%)  tps: 15,668
[rank2]:2025-10-30 15:54:05,191 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank2/251030_1554_stage2_step600.svg
[rank0]:2025-10-30 15:54:05,187 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank0/251030_1554_stage0_step600.svg
[rank1]:2025-10-30 15:54:05,186 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank1/251030_1554_stage1_step600.svg
[rank1]:2025-10-30 15:54:05,250 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank1/251030_1554_stage5_step600.svg
[rank2]:2025-10-30 15:54:05,261 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank2/251030_1554_stage6_step600.svg
[rank0]:2025-10-30 15:54:05,251 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank0/251030_1554_stage4_step600.svg
[rank3]:2025-10-30 15:54:05,417 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/pipeline_schedule/251030_1554_real_step600_rank3.svg
[rank3]:> Batch Time: 349.82 ms, GPU Bubble Ratio: 60.87%, 37.95%, 47.30%, 13.33%
[rank3]:2025-10-30 15:54:05,485 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank3/251030_1554_stage3_step600.svg
[rank3]:2025-10-30 15:54:05,548 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank3/251030_1554_stage7_step600.svg
[rank1]:2025-10-30 15:54:06,050 - INFO - Avg. fwd time: 5.4077 / Avg. bwd time: 8.3572 / Avg. batch time: 505.0076 (ms) / GPU bubble ratio: 56.39%
[rank3]:2025-10-30 15:54:06,012 - INFO - Avg. fwd time: 7.2433 / Avg. bwd time: 13.0799 / Avg. batch time: 453.4181 (ms) / GPU bubble ratio: 28.28%
[rank2]:2025-10-30 15:54:06,035 - INFO - Avg. fwd time: 4.2582 / Avg. bwd time: 7.7621 / Avg. batch time: 486.6351 (ms) / GPU bubble ratio: 60.48%
[rank0]:2025-10-30 15:54:06,059 - INFO - Avg. fwd time: 4.5136 / Avg. bwd time: 5.4933 / Avg. batch time: 516.2663 (ms) / GPU bubble ratio: 68.99%
[rank0]:2025-10-30 15:54:59,941 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-30 15:55:01,048 - INFO -  step: 650  loss:  1.3305  grad_norm: 78.6068  memory: 19.24GiB(40.50%)  tps: 7,322  tflops: 55.76  mfu: 17.87%
[rank2]:2025-10-30 15:55:01,046 - INFO -  step: 650  loss: -2.0000  grad_norm: 78.6068  memory:  8.44GiB(17.77%)  tps: 7,323  tflops: 55.77  mfu: 17.88%
[rank0]:2025-10-30 15:55:01,069 - INFO -  step: 650  loss: -2.0000  grad_norm: 78.6068  memory: 15.18GiB(31.96%)  tps: 7,316  tflops: 55.72  mfu: 17.86%
[rank1]:2025-10-30 15:55:01,046 - INFO -  step: 650  loss: -2.0000  grad_norm: 78.6068  memory: 12.20GiB(25.67%)  tps: 7,320  tflops: 55.75  mfu: 17.87%
[rank0]:2025-10-30 15:55:55,303 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-30 15:55:56,411 - INFO -  step: 700  loss: -2.0000  grad_norm:  4.2893  memory: 12.20GiB(25.67%)  tps: 7,398  tflops: 56.35  mfu: 18.06%
[rank3]:2025-10-30 15:55:56,413 - INFO -  step: 700  loss:  1.1749  grad_norm:  4.2893  memory: 19.24GiB(40.50%)  tps: 7,399  tflops: 56.35  mfu: 18.06%
[rank2]:2025-10-30 15:55:56,411 - INFO -  step: 700  loss: -2.0000  grad_norm:  4.2893  memory:  8.44GiB(17.77%)  tps: 7,398  tflops: 56.35  mfu: 18.06%
[rank0]:2025-10-30 15:55:56,434 - INFO -  step: 700  loss: -2.0000  grad_norm:  4.2893  memory: 15.18GiB(31.96%)  tps: 7,398  tflops: 56.35  mfu: 18.06%
[rank2]:2025-10-30 15:55:56,514 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank2/251030_1555_stage2_step700.svg
[rank0]:2025-10-30 15:55:56,512 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank0/251030_1555_stage0_step700.svg
[rank0]:2025-10-30 15:55:56,579 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank0/251030_1555_stage4_step700.svg
[rank1]:2025-10-30 15:55:56,512 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank1/251030_1555_stage1_step700.svg
[rank1]:2025-10-30 15:55:56,578 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank1/251030_1555_stage5_step700.svg
[rank2]:2025-10-30 15:55:56,585 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank2/251030_1555_stage6_step700.svg
[rank3]:2025-10-30 15:55:56,756 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/pipeline_schedule/251030_1555_real_step700_rank3.svg
[rank3]:> Batch Time: 352.83 ms, GPU Bubble Ratio: 60.98%, 38.65%, 49.74%, 13.02%
[rank3]:2025-10-30 15:55:56,829 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank3/251030_1555_stage3_step700.svg
[rank3]:2025-10-30 15:55:56,895 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank3/251030_1555_stage7_step700.svg
[rank1]:2025-10-30 15:55:57,212 - INFO - Avg. fwd time: 5.4162 / Avg. bwd time: 8.1375 / Avg. batch time: 504.0790 (ms) / GPU bubble ratio: 56.98%
[rank3]:2025-10-30 15:55:57,185 - INFO - Avg. fwd time: 7.2217 / Avg. bwd time: 13.2340 / Avg. batch time: 453.7593 (ms) / GPU bubble ratio: 27.87%
[rank2]:2025-10-30 15:55:57,198 - INFO - Avg. fwd time: 4.2671 / Avg. bwd time: 7.5901 / Avg. batch time: 485.3657 (ms) / GPU bubble ratio: 60.91%
[rank0]:2025-10-30 15:55:57,253 - INFO - Avg. fwd time: 4.4591 / Avg. bwd time: 6.3439 / Avg. batch time: 517.7295 (ms) / GPU bubble ratio: 66.61%
[rank0]:2025-10-30 15:56:51,016 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-30 15:56:52,126 - INFO -  step: 750  loss: -2.0000  grad_norm:  6.8336  memory:  8.44GiB(17.77%)  tps: 7,352  tflops: 55.99  mfu: 17.95%
[rank0]:2025-10-30 15:56:52,149 - INFO -  step: 750  loss: -2.0000  grad_norm:  6.8336  memory: 15.18GiB(31.96%)  tps: 7,352  tflops: 55.99  mfu: 17.95%
[rank3]:2025-10-30 15:56:52,128 - INFO -  step: 750  loss:  1.1244  grad_norm:  6.8336  memory: 19.24GiB(40.50%)  tps: 7,352  tflops: 55.99  mfu: 17.95%
[rank1]:2025-10-30 15:56:52,126 - INFO -  step: 750  loss: -2.0000  grad_norm:  6.8336  memory: 12.20GiB(25.67%)  tps: 7,352  tflops: 55.99  mfu: 17.95%
[rank0]:2025-10-30 15:57:46,373 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-30 15:57:47,953 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/pipeline_schedule_adjustment/251030_1557_rank3_trend_line.svg
[rank2]:2025-10-30 15:57:47,973 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/pipeline_schedule_adjustment/251030_1557_rank2_trend_line.svg
[rank2]:2025-10-30 15:57:48,002 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-30 15:57:47,988 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/pipeline_schedule_adjustment/251030_1557_rank0_trend_line.svg
[rank0]:2025-10-30 15:57:48,002 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-30 15:57:48,009 - INFO -  step: 800  loss: -2.0000  grad_norm:  0.9812  memory: 15.18GiB(31.96%)  tps: 7,333  tflops: 55.85  mfu: 17.90%
[rank0]:2025-10-30 15:57:48,009 - INFO - ðŸ”Ž  Running validation at step 800
[rank1]:2025-10-30 15:57:47,968 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/pipeline_schedule_adjustment/251030_1557_rank1_trend_line.svg
[rank1]:2025-10-30 15:57:48,002 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 0.39/0.39, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-30 15:57:48,007 - INFO -  step: 800  loss: -2.0000  grad_norm:  0.9812  memory: 12.20GiB(25.67%)  tps: 7,330  tflops: 55.83  mfu: 17.89%
[rank1]:2025-10-30 15:57:48,007 - INFO - ðŸ”Ž  Running validation at step 800
[rank2]:2025-10-30 15:57:48,006 - INFO -  step: 800  loss: -2.0000  grad_norm:  0.9812  memory:  8.44GiB(17.77%)  tps: 7,330  tflops: 55.83  mfu: 17.89%
[rank2]:2025-10-30 15:57:48,006 - INFO - ðŸ”Ž  Running validation at step 800
[rank3]:2025-10-30 15:57:48,329 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/pipeline_schedule/251030_1557_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 329.31 ms, GPU Bubble Ratio: 47.40%, 39.80%, 46.07%, 10.88%
[rank3]:2025-10-30 15:57:48,329 - INFO - 	> Batch Time: 329.31 ms (Average Freeze Ratio: 0.35)
[rank3]:2025-10-30 15:57:48,330 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 0.20/0.20, [MB4] 1.00/1.00, [MB5] 0.76/0.76, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank3]:2025-10-30 15:57:48,337 - INFO -  step: 800  loss:  1.1373  grad_norm:  0.9812  memory: 19.24GiB(40.50%)  tps: 7,287  tflops: 55.50  mfu: 17.79%
[rank3]:2025-10-30 15:57:48,337 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-10-30 15:58:13,951 - INFO - validate step: 800  loss: -1.0000  memory: 15.18GiB(31.96%)  tps: 15,789
[rank0]:2025-10-30 15:58:13,952 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-30 15:58:13,962 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank1]:2025-10-30 15:58:13,953 - INFO - validate step: 800  loss: -1.0000  memory: 12.20GiB(25.67%)  tps: 15,787
[rank1]:2025-10-30 15:58:13,954 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-30 15:58:13,967 - INFO - validate step: 800  loss:  1.1997  memory: 19.24GiB(40.50%)  tps: 15,982
[rank3]:2025-10-30 15:58:13,968 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-30 15:58:13,970 - INFO - validate step: 800  loss: -1.0000  memory:  8.44GiB(17.77%)  tps: 15,776
[rank2]:2025-10-30 15:58:13,971 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-30 15:58:15,789 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 1.82 seconds.
[rank1]:2025-10-30 15:58:16,344 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 2.39 seconds.
[rank3]:2025-10-30 15:58:17,260 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.29 seconds.
[rank0]:2025-10-30 15:58:17,850 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-30 15:58:17,858 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.91 seconds.
[rank0]:2025-10-30 15:58:17,960 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank0/251030_1558_stage0_step800.svg
[rank1]:2025-10-30 15:58:17,950 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank1/251030_1558_stage1_step800.svg
[rank2]:2025-10-30 15:58:17,952 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank2/251030_1558_stage2_step800.svg
[rank2]:2025-10-30 15:58:18,026 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank2/251030_1558_stage6_step800.svg
[rank1]:2025-10-30 15:58:18,019 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank1/251030_1558_stage5_step800.svg
[rank0]:2025-10-30 15:58:18,238 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank0/251030_1558_stage4_step800.svg
[rank3]:2025-10-30 15:58:18,334 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/pipeline_schedule/251030_1558_real_step800_rank3.svg
[rank3]:> Batch Time: 355.41 ms, GPU Bubble Ratio: 60.48%, 41.70%, 51.11%, 12.61%
[rank3]:2025-10-30 15:58:18,410 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank3/251030_1558_stage3_step800.svg
[rank3]:2025-10-30 15:58:18,501 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank3/251030_1558_stage7_step800.svg
[rank3]:2025-10-30 15:58:18,785 - INFO - Avg. fwd time: 7.2039 / Avg. bwd time: 13.3654 / Avg. batch time: 453.8473 (ms) / GPU bubble ratio: 27.48%
[rank2]:2025-10-30 15:58:18,810 - INFO - Avg. fwd time: 4.2737 / Avg. bwd time: 7.4296 / Avg. batch time: 484.1961 (ms) / GPU bubble ratio: 61.33%
[rank0]:2025-10-30 15:58:18,864 - INFO - Avg. fwd time: 4.4123 / Avg. bwd time: 7.0993 / Avg. batch time: 518.9880 (ms) / GPU bubble ratio: 64.51%
[rank1]:2025-10-30 15:58:18,824 - INFO - Avg. fwd time: 5.4239 / Avg. bwd time: 7.9454 / Avg. batch time: 503.2170 (ms) / GPU bubble ratio: 57.49%
[rank0]:2025-10-30 15:58:28,997 - WARNING - Dataset alpaca is being re-looped
[rank3]:2025-10-30 15:58:28,957 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-30 15:58:28,991 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-30 15:58:28,978 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-30 15:59:07,651 - INFO - [GC] Peforming periodical GC collection 0.23 seconds
[rank1]:2025-10-30 15:59:08,660 - INFO -  step: 850  loss: -2.0000  grad_norm:  1.8925  memory: 12.20GiB(25.67%)  tps: 7,487  tflops: 57.02  mfu: 18.28%
[rank3]:2025-10-30 15:59:08,652 - INFO -  step: 850  loss:  1.1622  grad_norm:  0.0000  memory: 19.24GiB(40.50%)  tps: 7,490  tflops: 57.05  mfu: 18.28%
[rank2]:2025-10-30 15:59:08,660 - INFO -  step: 850  loss: -2.0000  grad_norm:  1.8925  memory:  8.44GiB(17.77%)  tps: 7,490  tflops: 57.04  mfu: 18.28%
[rank0]:2025-10-30 15:59:08,660 - INFO -  step: 850  loss: -2.0000  grad_norm:  1.8925  memory: 15.18GiB(31.96%)  tps: 7,487  tflops: 57.02  mfu: 18.28%
[rank0]:2025-10-30 15:59:57,531 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-30 15:59:58,528 - INFO -  step: 900  loss: -2.0000  grad_norm:  0.2218  memory: 12.20GiB(25.67%)  tps: 8,214  tflops: 62.56  mfu: 20.05%
[rank3]:2025-10-30 15:59:58,520 - INFO -  step: 900  loss:  1.1158  grad_norm:  0.0000  memory: 19.24GiB(40.50%)  tps: 8,214  tflops: 62.56  mfu: 20.05%
[rank2]:2025-10-30 15:59:58,528 - INFO -  step: 900  loss: -2.0000  grad_norm:  0.2218  memory:  8.44GiB(17.77%)  tps: 8,214  tflops: 62.56  mfu: 20.05%
[rank0]:2025-10-30 15:59:58,528 - INFO -  step: 900  loss: -2.0000  grad_norm:  0.2218  memory: 15.18GiB(31.96%)  tps: 8,214  tflops: 62.56  mfu: 20.05%
[rank0]:2025-10-30 15:59:58,602 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank0/251030_1559_stage0_step900.svg
[rank1]:2025-10-30 15:59:58,601 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank1/251030_1559_stage1_step900.svg
[rank2]:2025-10-30 15:59:58,603 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank2/251030_1559_stage2_step900.svg
[rank2]:2025-10-30 15:59:58,666 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank2/251030_1559_stage6_step900.svg
[rank0]:2025-10-30 15:59:58,662 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank0/251030_1559_stage4_step900.svg
[rank1]:2025-10-30 15:59:58,661 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank1/251030_1559_stage5_step900.svg
[rank3]:2025-10-30 15:59:58,844 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/pipeline_schedule/251030_1559_real_step900_rank3.svg
[rank3]:> Batch Time: 352.72 ms, GPU Bubble Ratio: 60.82%, 43.10%, 50.78%, 12.61%
[rank3]:2025-10-30 15:59:58,907 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank3/251030_1559_stage3_step900.svg
[rank3]:2025-10-30 15:59:58,966 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank3/251030_1559_stage7_step900.svg
[rank3]:2025-10-30 15:59:59,422 - INFO - Avg. fwd time: 7.2358 / Avg. bwd time: 13.1473 / Avg. batch time: 451.5554 (ms) / GPU bubble ratio: 27.78%
[rank2]:2025-10-30 15:59:59,443 - INFO - Avg. fwd time: 4.2943 / Avg. bwd time: 7.3097 / Avg. batch time: 481.7650 (ms) / GPU bubble ratio: 61.46%
[rank0]:2025-10-30 15:59:59,469 - INFO - Avg. fwd time: 4.4398 / Avg. bwd time: 6.7114 / Avg. batch time: 515.4817 (ms) / GPU bubble ratio: 65.39%
[rank1]:2025-10-30 15:59:59,459 - INFO - Avg. fwd time: 5.4418 / Avg. bwd time: 7.8072 / Avg. batch time: 500.4864 (ms) / GPU bubble ratio: 57.64%
[rank0]:2025-10-30 16:00:47,769 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-30 16:00:48,772 - INFO -  step: 950  loss: -2.0000  grad_norm:  0.2243  memory: 15.18GiB(31.96%)  tps: 8,152  tflops: 62.09  mfu: 19.90%
[rank1]:2025-10-30 16:00:48,773 - INFO -  step: 950  loss: -2.0000  grad_norm:  0.2243  memory: 12.20GiB(25.67%)  tps: 8,152  tflops: 62.09  mfu: 19.90%
[rank3]:2025-10-30 16:00:48,764 - INFO -  step: 950  loss:  1.1159  grad_norm:  0.0000  memory: 19.24GiB(40.50%)  tps: 8,152  tflops: 62.09  mfu: 19.90%
[rank2]:2025-10-30 16:00:48,773 - INFO -  step: 950  loss: -2.0000  grad_norm:  0.2243  memory:  8.44GiB(17.77%)  tps: 8,152  tflops: 62.09  mfu: 19.90%
[rank0]:2025-10-30 16:01:37,756 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-30 16:01:38,775 - INFO -  step: 1000  loss: -2.0000  grad_norm:  0.1156  memory:  8.44GiB(17.77%)  tps: 8,192  tflops: 62.39  mfu: 20.00%
[rank2]:2025-10-30 16:01:38,775 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-10-30 16:01:38,775 - INFO -  step: 1000  loss: -2.0000  grad_norm:  0.1156  memory: 15.18GiB(31.96%)  tps: 8,192  tflops: 62.39  mfu: 20.00%
[rank0]:2025-10-30 16:01:38,775 - INFO - ðŸ”Ž  Running validation at step 1000
[rank1]:2025-10-30 16:01:38,775 - INFO -  step: 1000  loss: -2.0000  grad_norm:  0.1156  memory: 12.20GiB(25.67%)  tps: 8,192  tflops: 62.39  mfu: 20.00%
[rank1]:2025-10-30 16:01:38,776 - INFO - ðŸ”Ž  Running validation at step 1000
[rank3]:2025-10-30 16:01:38,767 - INFO -  step: 1000  loss:  1.1253  grad_norm:  0.0000  memory: 19.24GiB(40.50%)  tps: 8,192  tflops: 62.39  mfu: 20.00%
[rank3]:2025-10-30 16:01:38,768 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-10-30 16:02:05,144 - INFO - validate step: 1000  loss: -1.0000  memory: 15.18GiB(31.96%)  tps: 15,534
[rank1]:2025-10-30 16:02:05,152 - INFO - validate step: 1000  loss: -1.0000  memory: 12.20GiB(25.67%)  tps: 15,530
[rank3]:2025-10-30 16:02:05,161 - INFO - validate step: 1000  loss:  1.2008  memory: 19.24GiB(40.50%)  tps: 15,519
[rank2]:2025-10-30 16:02:05,168 - INFO - validate step: 1000  loss: -1.0000  memory:  8.44GiB(17.77%)  tps: 15,519
[rank0]:2025-10-30 16:02:05,246 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank0/251030_1602_stage0_step1000.svg
[rank1]:2025-10-30 16:02:05,250 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank1/251030_1602_stage1_step1000.svg
[rank2]:2025-10-30 16:02:05,246 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank2/251030_1602_stage2_step1000.svg
[rank2]:2025-10-30 16:02:05,311 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank2/251030_1602_stage6_step1000.svg
[rank0]:2025-10-30 16:02:05,308 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank0/251030_1602_stage4_step1000.svg
[rank1]:2025-10-30 16:02:05,312 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank1/251030_1602_stage5_step1000.svg
[rank3]:2025-10-30 16:02:05,488 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/pipeline_schedule/251030_1602_real_step1000_rank3.svg
[rank3]:> Batch Time: 348.12 ms, GPU Bubble Ratio: 60.69%, 43.05%, 50.14%, 12.82%
[rank3]:2025-10-30 16:02:05,554 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank3/251030_1602_stage3_step1000.svg
[rank3]:2025-10-30 16:02:05,618 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank3/251030_1602_stage7_step1000.svg
[rank0]:2025-10-30 16:02:05,818 - INFO - Avg. fwd time: 4.4612 / Avg. bwd time: 6.4070 / Avg. batch time: 512.6500 (ms) / GPU bubble ratio: 66.08%
[rank3]:2025-10-30 16:02:05,888 - INFO - Avg. fwd time: 7.2612 / Avg. bwd time: 12.9867 / Avg. batch time: 449.8902 (ms) / GPU bubble ratio: 27.99%
[rank2]:2025-10-30 16:02:05,923 - INFO - Avg. fwd time: 4.3094 / Avg. bwd time: 7.2271 / Avg. batch time: 479.7997 (ms) / GPU bubble ratio: 61.53%
[rank1]:2025-10-30 16:02:05,935 - INFO - Avg. fwd time: 5.4547 / Avg. bwd time: 7.7128 / Avg. batch time: 498.2910 (ms) / GPU bubble ratio: 57.72%
[rank0]:2025-10-30 16:02:54,366 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-30 16:02:55,374 - INFO -  step: 1050  loss: -2.0000  grad_norm:  0.8841  memory:  8.44GiB(17.77%)  tps: 8,158  tflops: 62.14  mfu: 19.92%
[rank3]:2025-10-30 16:02:55,366 - INFO -  step: 1050  loss:  1.1759  grad_norm:  0.0000  memory: 19.24GiB(40.50%)  tps: 8,159  tflops: 62.14  mfu: 19.92%
[rank0]:2025-10-30 16:02:55,374 - INFO -  step: 1050  loss: -2.0000  grad_norm:  0.8841  memory: 15.18GiB(31.96%)  tps: 8,155  tflops: 62.11  mfu: 19.91%
[rank1]:2025-10-30 16:02:55,375 - INFO -  step: 1050  loss: -2.0000  grad_norm:  0.8841  memory: 12.20GiB(25.67%)  tps: 8,156  tflops: 62.12  mfu: 19.91%
[rank0]:2025-10-30 16:03:44,323 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-30 16:03:45,330 - INFO -  step: 1100  loss: -2.0000  grad_norm:  1.5785  memory: 12.20GiB(25.67%)  tps: 8,199  tflops: 62.45  mfu: 20.02%
[rank2]:2025-10-30 16:03:45,330 - INFO -  step: 1100  loss: -2.0000  grad_norm:  1.5785  memory:  8.44GiB(17.77%)  tps: 8,199  tflops: 62.45  mfu: 20.02%
[rank3]:2025-10-30 16:03:45,322 - INFO -  step: 1100  loss:  1.1685  grad_norm:  0.0000  memory: 19.24GiB(40.50%)  tps: 8,200  tflops: 62.45  mfu: 20.02%
[rank0]:2025-10-30 16:03:45,330 - INFO -  step: 1100  loss: -2.0000  grad_norm:  1.5785  memory: 15.18GiB(31.96%)  tps: 8,199  tflops: 62.45  mfu: 20.02%
[rank0]:2025-10-30 16:03:45,407 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank0/251030_1603_stage0_step1100.svg
[rank1]:2025-10-30 16:03:45,406 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank1/251030_1603_stage1_step1100.svg
[rank2]:2025-10-30 16:03:45,408 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank2/251030_1603_stage2_step1100.svg
[rank0]:2025-10-30 16:03:45,470 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank0/251030_1603_stage4_step1100.svg
[rank1]:2025-10-30 16:03:45,469 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank1/251030_1603_stage5_step1100.svg
[rank2]:2025-10-30 16:03:45,475 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank2/251030_1603_stage6_step1100.svg
[rank3]:2025-10-30 16:03:45,651 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/pipeline_schedule/251030_1603_real_step1100_rank3.svg
[rank3]:> Batch Time: 347.53 ms, GPU Bubble Ratio: 61.19%, 42.97%, 50.04%, 12.81%
[rank3]:2025-10-30 16:03:45,720 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank3/251030_1603_stage3_step1100.svg
[rank3]:2025-10-30 16:03:45,784 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank3/251030_1603_stage7_step1100.svg
[rank0]:2025-10-30 16:03:45,982 - INFO - Avg. fwd time: 4.4814 / Avg. bwd time: 6.1152 / Avg. batch time: 510.0569 (ms) / GPU bubble ratio: 66.76%
[rank3]:2025-10-30 16:03:46,051 - INFO - Avg. fwd time: 7.2848 / Avg. bwd time: 12.8323 / Avg. batch time: 448.2781 (ms) / GPU bubble ratio: 28.20%
[rank1]:2025-10-30 16:03:46,099 - INFO - Avg. fwd time: 5.4673 / Avg. bwd time: 7.6226 / Avg. batch time: 496.3080 (ms) / GPU bubble ratio: 57.80%
[rank2]:2025-10-30 16:03:46,088 - INFO - Avg. fwd time: 4.3239 / Avg. bwd time: 7.1483 / Avg. batch time: 478.0369 (ms) / GPU bubble ratio: 61.60%
[rank0]:2025-10-30 16:04:34,520 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-30 16:04:35,512 - INFO -  step: 1150  loss: -2.0000  grad_norm:  0.1583  memory:  8.44GiB(17.77%)  tps: 8,162  tflops: 62.17  mfu: 19.92%
[rank3]:2025-10-30 16:04:35,504 - INFO -  step: 1150  loss:  1.0941  grad_norm:  0.0000  memory: 19.24GiB(40.50%)  tps: 8,163  tflops: 62.17  mfu: 19.93%
[rank0]:2025-10-30 16:04:35,512 - INFO -  step: 1150  loss: -2.0000  grad_norm:  0.1583  memory: 15.18GiB(31.96%)  tps: 8,162  tflops: 62.17  mfu: 19.92%
[rank1]:2025-10-30 16:04:35,512 - INFO -  step: 1150  loss: -2.0000  grad_norm:  0.1583  memory: 12.20GiB(25.67%)  tps: 8,162  tflops: 62.17  mfu: 19.92%
[rank0]:2025-10-30 16:05:24,247 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-30 16:05:25,232 - INFO -  step: 1200  loss:  1.0809  grad_norm:  0.0000  memory: 19.24GiB(40.50%)  tps: 8,237  tflops: 62.73  mfu: 20.11%
[rank3]:2025-10-30 16:05:25,233 - INFO - ðŸ”Ž  Running validation at step 1200
[rank1]:2025-10-30 16:05:25,241 - INFO -  step: 1200  loss: -2.0000  grad_norm:  0.1202  memory: 12.20GiB(25.67%)  tps: 8,237  tflops: 62.73  mfu: 20.11%
[rank1]:2025-10-30 16:05:25,241 - INFO - ðŸ”Ž  Running validation at step 1200
[rank0]:2025-10-30 16:05:25,240 - INFO -  step: 1200  loss: -2.0000  grad_norm:  0.1202  memory: 15.18GiB(31.96%)  tps: 8,237  tflops: 62.73  mfu: 20.11%
[rank0]:2025-10-30 16:05:25,240 - INFO - ðŸ”Ž  Running validation at step 1200
[rank2]:2025-10-30 16:05:25,240 - INFO -  step: 1200  loss: -2.0000  grad_norm:  0.1202  memory:  8.44GiB(17.77%)  tps: 8,237  tflops: 62.73  mfu: 20.11%
[rank2]:2025-10-30 16:05:25,240 - INFO - ðŸ”Ž  Running validation at step 1200
[rank3]:2025-10-30 16:05:52,970 - INFO - validate step: 1200  loss:  1.2017  memory: 19.24GiB(40.50%)  tps: 14,767
[rank1]:2025-10-30 16:05:52,952 - INFO - validate step: 1200  loss: -1.0000  memory: 12.20GiB(25.67%)  tps: 14,781
[rank0]:2025-10-30 16:05:52,945 - INFO - validate step: 1200  loss: -1.0000  memory: 15.18GiB(31.96%)  tps: 14,784
[rank2]:2025-10-30 16:05:52,977 - INFO - validate step: 1200  loss: -1.0000  memory:  8.44GiB(17.77%)  tps: 14,768
[rank1]:2025-10-30 16:05:53,058 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank1/251030_1605_stage1_step1200.svg
[rank0]:2025-10-30 16:05:53,058 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank0/251030_1605_stage0_step1200.svg
[rank2]:2025-10-30 16:05:53,064 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank2/251030_1605_stage2_step1200.svg
[rank2]:2025-10-30 16:05:53,135 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank2/251030_1605_stage6_step1200.svg
[rank1]:2025-10-30 16:05:53,123 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank1/251030_1605_stage5_step1200.svg
[rank0]:2025-10-30 16:05:53,124 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank0/251030_1605_stage4_step1200.svg
[rank3]:2025-10-30 16:05:53,292 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/pipeline_schedule/251030_1605_real_step1200_rank3.svg
[rank3]:> Batch Time: 346.96 ms, GPU Bubble Ratio: 62.83%, 42.88%, 49.93%, 12.73%
[rank3]:2025-10-30 16:05:53,359 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank3/251030_1605_stage3_step1200.svg
[rank3]:2025-10-30 16:05:53,435 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank3/251030_1605_stage7_step1200.svg
[rank3]:2025-10-30 16:05:53,890 - INFO - Avg. fwd time: 7.3036 / Avg. bwd time: 12.7001 / Avg. batch time: 446.8742 (ms) / GPU bubble ratio: 28.38%
[rank2]:2025-10-30 16:05:53,911 - INFO - Avg. fwd time: 4.3359 / Avg. bwd time: 7.0836 / Avg. batch time: 476.6251 (ms) / GPU bubble ratio: 61.67%
[rank1]:2025-10-30 16:05:53,929 - INFO - Avg. fwd time: 5.4776 / Avg. bwd time: 7.5481 / Avg. batch time: 494.7155 (ms) / GPU bubble ratio: 57.87%
[rank0]:2025-10-30 16:05:53,940 - INFO - Avg. fwd time: 4.4978 / Avg. bwd time: 5.8743 / Avg. batch time: 507.9624 (ms) / GPU bubble ratio: 67.33%
[rank0]:2025-10-30 16:06:42,375 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-30 16:06:43,386 - INFO -  step: 1250  loss: -2.0000  grad_norm:  0.1403  memory:  8.44GiB(17.77%)  tps: 8,126  tflops: 61.89  mfu: 19.84%
[rank3]:2025-10-30 16:06:43,377 - INFO -  step: 1250  loss:  1.1614  grad_norm:  0.0000  memory: 19.24GiB(40.50%)  tps: 8,126  tflops: 61.89  mfu: 19.84%
[rank0]:2025-10-30 16:06:43,385 - INFO -  step: 1250  loss: -2.0000  grad_norm:  0.1403  memory: 15.18GiB(31.96%)  tps: 8,121  tflops: 61.85  mfu: 19.82%
[rank1]:2025-10-30 16:06:43,386 - INFO -  step: 1250  loss: -2.0000  grad_norm:  0.1403  memory: 12.20GiB(25.67%)  tps: 8,122  tflops: 61.86  mfu: 19.83%
[rank0]:2025-10-30 16:07:32,168 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-30 16:07:33,158 - INFO -  step: 1300  loss:  1.1136  grad_norm:  0.0000  memory: 19.24GiB(40.50%)  tps: 8,228  tflops: 62.67  mfu: 20.09%
[rank0]:2025-10-30 16:07:33,166 - INFO -  step: 1300  loss: -2.0000  grad_norm:  0.2327  memory: 15.18GiB(31.96%)  tps: 8,228  tflops: 62.67  mfu: 20.09%
[rank1]:2025-10-30 16:07:33,166 - INFO -  step: 1300  loss: -2.0000  grad_norm:  0.2327  memory: 12.20GiB(25.67%)  tps: 8,228  tflops: 62.67  mfu: 20.09%
[rank2]:2025-10-30 16:07:33,166 - INFO -  step: 1300  loss: -2.0000  grad_norm:  0.2327  memory:  8.44GiB(17.77%)  tps: 8,228  tflops: 62.67  mfu: 20.09%
[rank2]:2025-10-30 16:07:33,255 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank2/251030_1607_stage2_step1300.svg
[rank0]:2025-10-30 16:07:33,247 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank0/251030_1607_stage0_step1300.svg
[rank0]:2025-10-30 16:07:33,312 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank0/251030_1607_stage4_step1300.svg
[rank1]:2025-10-30 16:07:33,246 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank1/251030_1607_stage1_step1300.svg
[rank1]:2025-10-30 16:07:33,310 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank1/251030_1607_stage5_step1300.svg
[rank2]:2025-10-30 16:07:33,326 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank2/251030_1607_stage6_step1300.svg
[rank3]:2025-10-30 16:07:33,479 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/pipeline_schedule/251030_1607_real_step1300_rank3.svg
[rank3]:> Batch Time: 346.85 ms, GPU Bubble Ratio: 62.81%, 42.86%, 49.88%, 12.74%
[rank3]:2025-10-30 16:07:33,547 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank3/251030_1607_stage3_step1300.svg
[rank3]:2025-10-30 16:07:33,613 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank3/251030_1607_stage7_step1300.svg
[rank0]:2025-10-30 16:07:33,813 - INFO - Avg. fwd time: 4.5097 / Avg. bwd time: 5.6993 / Avg. batch time: 506.2905 (ms) / GPU bubble ratio: 67.74%
[rank3]:2025-10-30 16:07:33,882 - INFO - Avg. fwd time: 7.3174 / Avg. bwd time: 12.6073 / Avg. batch time: 445.8967 (ms) / GPU bubble ratio: 28.50%
[rank2]:2025-10-30 16:07:33,919 - INFO - Avg. fwd time: 4.3446 / Avg. bwd time: 7.0367 / Avg. batch time: 475.4516 (ms) / GPU bubble ratio: 61.70%
[rank1]:2025-10-30 16:07:33,931 - INFO - Avg. fwd time: 5.4849 / Avg. bwd time: 7.4943 / Avg. batch time: 493.4108 (ms) / GPU bubble ratio: 57.91%
[rank0]:2025-10-30 16:08:22,525 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-30 16:08:23,533 - INFO -  step: 1350  loss: -2.0000  grad_norm:  0.5519  memory: 15.18GiB(31.96%)  tps: 8,132  tflops: 61.94  mfu: 19.85%
[rank3]:2025-10-30 16:08:23,524 - INFO -  step: 1350  loss:  1.1319  grad_norm:  0.0000  memory: 19.24GiB(40.50%)  tps: 8,133  tflops: 61.94  mfu: 19.85%
[rank1]:2025-10-30 16:08:23,533 - INFO -  step: 1350  loss: -2.0000  grad_norm:  0.5519  memory: 12.20GiB(25.67%)  tps: 8,132  tflops: 61.94  mfu: 19.85%
[rank2]:2025-10-30 16:08:23,533 - INFO -  step: 1350  loss: -2.0000  grad_norm:  0.5519  memory:  8.44GiB(17.77%)  tps: 8,133  tflops: 61.94  mfu: 19.85%
[rank0]:2025-10-30 16:09:12,385 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-30 16:09:13,399 - INFO -  step: 1400  loss: -2.0000  grad_norm:  0.1002  memory: 12.20GiB(25.67%)  tps: 8,214  tflops: 62.56  mfu: 20.05%
[rank1]:2025-10-30 16:09:13,399 - INFO - ðŸ”Ž  Running validation at step 1400
[rank3]:2025-10-30 16:09:13,391 - INFO -  step: 1400  loss:  1.0976  grad_norm:  0.0000  memory: 19.24GiB(40.50%)  tps: 8,214  tflops: 62.56  mfu: 20.05%
[rank3]:2025-10-30 16:09:13,391 - INFO - ðŸ”Ž  Running validation at step 1400
[rank0]:2025-10-30 16:09:13,399 - INFO -  step: 1400  loss: -2.0000  grad_norm:  0.1002  memory: 15.18GiB(31.96%)  tps: 8,214  tflops: 62.56  mfu: 20.05%
[rank0]:2025-10-30 16:09:13,399 - INFO - ðŸ”Ž  Running validation at step 1400
[rank2]:2025-10-30 16:09:13,399 - INFO -  step: 1400  loss: -2.0000  grad_norm:  0.1002  memory:  8.44GiB(17.77%)  tps: 8,214  tflops: 62.56  mfu: 20.05%
[rank2]:2025-10-30 16:09:13,399 - INFO - ðŸ”Ž  Running validation at step 1400
[rank0]:2025-10-30 16:09:39,780 - INFO - validate step: 1400  loss: -1.0000  memory: 15.18GiB(31.96%)  tps: 15,526
[rank2]:2025-10-30 16:09:39,804 - INFO - validate step: 1400  loss: -1.0000  memory:  8.44GiB(17.77%)  tps: 15,512
[rank1]:2025-10-30 16:09:39,787 - INFO - validate step: 1400  loss: -1.0000  memory: 12.20GiB(25.67%)  tps: 15,522
[rank3]:2025-10-30 16:09:39,799 - INFO - validate step: 1400  loss:  1.2064  memory: 19.24GiB(40.50%)  tps: 15,511
[rank2]:2025-10-30 16:09:39,894 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank2/251030_1609_stage2_step1400.svg
[rank1]:2025-10-30 16:09:39,889 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank1/251030_1609_stage1_step1400.svg
[rank1]:2025-10-30 16:09:39,956 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank1/251030_1609_stage5_step1400.svg
[rank0]:2025-10-30 16:09:39,889 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank0/251030_1609_stage0_step1400.svg
[rank0]:2025-10-30 16:09:39,957 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank0/251030_1609_stage4_step1400.svg
[rank2]:2025-10-30 16:09:39,966 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank2/251030_1609_stage6_step1400.svg
[rank3]:2025-10-30 16:09:40,135 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/pipeline_schedule/251030_1609_real_step1400_rank3.svg
[rank3]:> Batch Time: 346.83 ms, GPU Bubble Ratio: 62.81%, 42.85%, 49.85%, 12.75%
[rank3]:2025-10-30 16:09:40,207 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank3/251030_1609_stage3_step1400.svg
[rank3]:2025-10-30 16:09:40,275 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank3/251030_1609_stage7_step1400.svg
[rank0]:2025-10-30 16:09:40,477 - INFO - Avg. fwd time: 4.5218 / Avg. bwd time: 5.5237 / Avg. batch time: 504.7574 (ms) / GPU bubble ratio: 68.16%
[rank3]:2025-10-30 16:09:40,545 - INFO - Avg. fwd time: 7.3322 / Avg. bwd time: 12.5158 / Avg. batch time: 444.9566 (ms) / GPU bubble ratio: 28.63%
[rank2]:2025-10-30 16:09:40,585 - INFO - Avg. fwd time: 4.3536 / Avg. bwd time: 6.9900 / Avg. batch time: 474.4171 (ms) / GPU bubble ratio: 61.74%
[rank1]:2025-10-30 16:09:40,593 - INFO - Avg. fwd time: 5.4926 / Avg. bwd time: 7.4410 / Avg. batch time: 492.2458 (ms) / GPU bubble ratio: 57.96%
[rank0]:2025-10-30 16:10:28,905 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-30 16:10:29,890 - INFO -  step: 1450  loss: -2.0000  grad_norm:  0.3458  memory:  8.44GiB(17.77%)  tps: 8,178  tflops: 62.29  mfu: 19.96%
[rank1]:2025-10-30 16:10:29,890 - INFO -  step: 1450  loss: -2.0000  grad_norm:  0.3458  memory: 12.20GiB(25.67%)  tps: 8,175  tflops: 62.26  mfu: 19.96%
[rank3]:2025-10-30 16:10:29,882 - INFO -  step: 1450  loss:  1.1189  grad_norm:  0.0000  memory: 19.24GiB(40.50%)  tps: 8,179  tflops: 62.29  mfu: 19.96%
[rank0]:2025-10-30 16:10:29,890 - INFO -  step: 1450  loss: -2.0000  grad_norm:  0.3458  memory: 15.18GiB(31.96%)  tps: 8,174  tflops: 62.26  mfu: 19.95%
[rank0]:2025-10-30 16:11:18,863 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-30 16:11:19,867 - INFO -  step: 1500  loss: -2.0000  grad_norm:  0.1335  memory: 12.20GiB(25.67%)  tps: 8,196  tflops: 62.42  mfu: 20.01%
[rank3]:2025-10-30 16:11:19,858 - INFO -  step: 1500  loss:  1.1094  grad_norm:  0.0000  memory: 19.24GiB(40.50%)  tps: 8,196  tflops: 62.42  mfu: 20.01%
[rank0]:2025-10-30 16:11:19,866 - INFO -  step: 1500  loss: -2.0000  grad_norm:  0.1335  memory: 15.18GiB(31.96%)  tps: 8,196  tflops: 62.42  mfu: 20.01%
[rank2]:2025-10-30 16:11:19,866 - INFO -  step: 1500  loss: -2.0000  grad_norm:  0.1335  memory:  8.44GiB(17.77%)  tps: 8,196  tflops: 62.42  mfu: 20.01%
[rank2]:2025-10-30 16:11:19,952 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank2/251030_1611_stage2_step1500.svg
[rank1]:2025-10-30 16:11:19,950 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank1/251030_1611_stage1_step1500.svg
[rank0]:2025-10-30 16:11:19,951 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank0/251030_1611_stage0_step1500.svg
[rank2]:2025-10-30 16:11:20,023 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank2/251030_1611_stage6_step1500.svg
[rank1]:2025-10-30 16:11:20,018 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank1/251030_1611_stage5_step1500.svg
[rank0]:2025-10-30 16:11:20,020 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank0/251030_1611_stage4_step1500.svg
[rank3]:2025-10-30 16:11:20,186 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/pipeline_schedule/251030_1611_real_step1500_rank3.svg
[rank3]:> Batch Time: 346.74 ms, GPU Bubble Ratio: 62.80%, 42.83%, 49.82%, 12.75%
[rank3]:2025-10-30 16:11:20,258 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank3/251030_1611_stage3_step1500.svg
[rank3]:2025-10-30 16:11:20,326 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank3/251030_1611_stage7_step1500.svg
[rank3]:2025-10-30 16:11:20,784 - INFO - Avg. fwd time: 7.3439 / Avg. bwd time: 12.4329 / Avg. batch time: 444.0835 (ms) / GPU bubble ratio: 28.75%
[rank2]:2025-10-30 16:11:20,805 - INFO - Avg. fwd time: 4.3615 / Avg. bwd time: 6.9501 / Avg. batch time: 473.5640 (ms) / GPU bubble ratio: 61.78%
[rank1]:2025-10-30 16:11:20,823 - INFO - Avg. fwd time: 5.4993 / Avg. bwd time: 7.3950 / Avg. batch time: 491.2820 (ms) / GPU bubble ratio: 58.01%
[rank0]:2025-10-30 16:11:20,835 - INFO - Avg. fwd time: 4.5324 / Avg. bwd time: 5.3727 / Avg. batch time: 503.4791 (ms) / GPU bubble ratio: 68.52%
[rank0]:2025-10-30 16:12:09,083 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-30 16:12:10,088 - INFO -  step: 1550  loss: -2.0000  grad_norm:  0.5284  memory:  8.44GiB(17.77%)  tps: 8,156  tflops: 62.12  mfu: 19.91%
[rank1]:2025-10-30 16:12:10,088 - INFO -  step: 1550  loss: -2.0000  grad_norm:  0.5284  memory: 12.20GiB(25.67%)  tps: 8,156  tflops: 62.12  mfu: 19.91%
[rank3]:2025-10-30 16:12:10,080 - INFO -  step: 1550  loss:  1.1170  grad_norm:  0.0000  memory: 19.24GiB(40.50%)  tps: 8,156  tflops: 62.12  mfu: 19.91%
[rank0]:2025-10-30 16:12:10,088 - INFO -  step: 1550  loss: -2.0000  grad_norm:  0.5284  memory: 15.18GiB(31.96%)  tps: 8,156  tflops: 62.12  mfu: 19.91%
[rank0]:2025-10-30 16:12:58,922 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-30 16:13:00,818 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/pipeline_schedule_adjustment/251030_1612_rank0_trend_line.svg
[rank2]:2025-10-30 16:13:00,841 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/pipeline_schedule_adjustment/251030_1612_rank2_trend_line.svg
[rank2]:2025-10-30 16:13:00,855 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank2]:2025-10-30 16:13:00,861 - INFO -  step: 1600  loss: -2.0000  grad_norm:  0.1192  memory:  8.44GiB(17.77%)  tps: 8,067  tflops: 61.44  mfu: 19.69%
[rank2]:2025-10-30 16:13:00,861 - INFO - ðŸ”Ž  Running validation at step 1600
[rank1]:2025-10-30 16:13:00,819 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/pipeline_schedule_adjustment/251030_1612_rank1_trend_line.svg
[rank1]:2025-10-30 16:13:00,855 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-30 16:13:00,861 - INFO -  step: 1600  loss: -2.0000  grad_norm:  0.1192  memory: 12.20GiB(25.67%)  tps: 8,067  tflops: 61.44  mfu: 19.69%
[rank1]:2025-10-30 16:13:00,861 - INFO - ðŸ”Ž  Running validation at step 1600
[rank3]:2025-10-30 16:13:00,840 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/pipeline_schedule_adjustment/251030_1612_rank3_trend_line.svg
[rank0]:2025-10-30 16:13:00,855 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-30 16:13:00,861 - INFO -  step: 1600  loss: -2.0000  grad_norm:  0.1192  memory: 15.18GiB(31.96%)  tps: 8,067  tflops: 61.44  mfu: 19.69%
[rank0]:2025-10-30 16:13:00,861 - INFO - ðŸ”Ž  Running validation at step 1600
[rank3]:2025-10-30 16:13:01,177 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/pipeline_schedule/251030_1612_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 323.57 ms, GPU Bubble Ratio: 55.48%, 41.25%, 48.00%, 10.54%
[rank3]:2025-10-30 16:13:01,178 - INFO - 	> Batch Time: 323.57 ms (Average Freeze Ratio: 0.19)
[rank3]:2025-10-30 16:13:01,179 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 0.22/0.22, [MB6] 0.00/0.00, [MB7] 0.93/0.93
[rank3]:2025-10-30 16:13:01,186 - INFO -  step: 1600  loss:  1.0779  grad_norm:  0.0000  memory: 19.24GiB(40.50%)  tps: 8,015  tflops: 61.04  mfu: 19.57%
[rank3]:2025-10-30 16:13:01,186 - INFO - ðŸ”Ž  Running validation at step 1600
[rank2]:2025-10-30 16:13:27,424 - INFO - validate step: 1600  loss: -1.0000  memory:  8.44GiB(17.77%)  tps: 15,420
[rank2]:2025-10-30 16:13:27,424 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-30 16:13:27,408 - INFO - validate step: 1600  loss: -1.0000  memory: 12.20GiB(25.67%)  tps: 15,429
[rank1]:2025-10-30 16:13:27,409 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-30 16:13:27,418 - INFO - validate step: 1600  loss:  1.2050  memory: 19.24GiB(40.50%)  tps: 15,615
[rank3]:2025-10-30 16:13:27,419 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-30 16:13:27,401 - INFO - validate step: 1600  loss: -1.0000  memory: 15.18GiB(31.96%)  tps: 15,433
[rank0]:2025-10-30 16:13:27,402 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-30 16:13:27,414 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank2]:2025-10-30 16:13:29,096 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 1.67 seconds.
[rank1]:2025-10-30 16:13:29,680 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 2.27 seconds.
[rank3]:2025-10-30 16:13:30,637 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.22 seconds.
[rank0]:2025-10-30 16:13:31,026 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-30 16:13:31,034 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.63 seconds.
[rank1]:2025-10-30 16:13:31,136 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank1/251030_1613_stage1_step1600.svg
[rank0]:2025-10-30 16:13:31,138 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank0/251030_1613_stage0_step1600.svg
[rank2]:2025-10-30 16:13:31,135 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank2/251030_1613_stage2_step1600.svg
[rank2]:2025-10-30 16:13:31,208 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank2/251030_1613_stage6_step1600.svg
[rank1]:2025-10-30 16:13:31,206 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank1/251030_1613_stage5_step1600.svg
[rank0]:2025-10-30 16:13:31,384 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank0/251030_1613_stage4_step1600.svg
[rank3]:2025-10-30 16:13:31,529 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/pipeline_schedule/251030_1613_real_step1600_rank3.svg
[rank3]:> Batch Time: 346.71 ms, GPU Bubble Ratio: 62.79%, 42.83%, 49.80%, 12.76%
[rank3]:2025-10-30 16:13:31,612 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank3/251030_1613_stage3_step1600.svg
[rank3]:2025-10-30 16:13:31,687 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank3/251030_1613_stage7_step1600.svg
[rank0]:2025-10-30 16:13:31,953 - INFO - Avg. fwd time: 4.5403 / Avg. bwd time: 5.2592 / Avg. batch time: 502.3401 (ms) / GPU bubble ratio: 68.79%
[rank2]:2025-10-30 16:13:32,035 - INFO - Avg. fwd time: 4.3673 / Avg. bwd time: 6.9199 / Avg. batch time: 472.7490 (ms) / GPU bubble ratio: 61.80%
[rank1]:2025-10-30 16:13:32,047 - INFO - Avg. fwd time: 5.5044 / Avg. bwd time: 7.3606 / Avg. batch time: 490.3816 (ms) / GPU bubble ratio: 58.02%
[rank3]:2025-10-30 16:13:32,007 - INFO - Avg. fwd time: 7.3530 / Avg. bwd time: 12.3697 / Avg. batch time: 443.4092 (ms) / GPU bubble ratio: 28.83%
[rank3]:2025-10-30 16:13:57,251 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-30 16:13:57,508 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-30 16:13:57,503 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-30 16:13:57,508 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-30 16:14:30,564 - INFO - [GC] Peforming periodical GC collection 0.21 seconds
[rank2]:2025-10-30 16:14:31,784 - INFO -  step: 1650  loss: -2.0000  grad_norm: 14.4077  memory:  8.44GiB(17.77%)  tps: 6,364  tflops: 48.47  mfu: 15.54%
[rank1]:2025-10-30 16:14:31,776 - INFO -  step: 1650  loss: -2.0000  grad_norm: 14.4077  memory: 12.20GiB(25.67%)  tps: 6,363  tflops: 48.47  mfu: 15.53%
[rank3]:2025-10-30 16:14:31,789 - INFO -  step: 1650  loss:  0.5778  grad_norm: 14.4077  memory: 19.24GiB(40.50%)  tps: 6,363  tflops: 48.46  mfu: 15.53%
[rank0]:2025-10-30 16:14:31,776 - INFO -  step: 1650  loss: -2.0000  grad_norm: 14.4077  memory: 15.18GiB(31.96%)  tps: 6,363  tflops: 48.46  mfu: 15.53%
[rank0]:2025-10-30 16:15:30,484 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-30 16:15:31,683 - INFO -  step: 1700  loss: -2.0000  grad_norm:  4.1157  memory: 12.20GiB(25.67%)  tps: 6,837  tflops: 52.07  mfu: 16.69%
[rank3]:2025-10-30 16:15:31,697 - INFO -  step: 1700  loss:  0.3309  grad_norm:  4.1157  memory: 19.24GiB(40.50%)  tps: 6,837  tflops: 52.08  mfu: 16.69%
[rank0]:2025-10-30 16:15:31,683 - INFO -  step: 1700  loss: -2.0000  grad_norm:  4.1157  memory: 15.18GiB(31.96%)  tps: 6,837  tflops: 52.07  mfu: 16.69%
[rank2]:2025-10-30 16:15:31,691 - INFO -  step: 1700  loss: -2.0000  grad_norm:  4.1157  memory:  8.44GiB(17.77%)  tps: 6,837  tflops: 52.07  mfu: 16.69%
[rank1]:2025-10-30 16:15:31,782 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank1/251030_1615_stage1_step1700.svg
[rank0]:2025-10-30 16:15:31,782 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank0/251030_1615_stage0_step1700.svg
[rank2]:2025-10-30 16:15:31,784 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank2/251030_1615_stage2_step1700.svg
[rank2]:2025-10-30 16:15:31,855 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank2/251030_1615_stage6_step1700.svg
[rank1]:2025-10-30 16:15:31,851 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank1/251030_1615_stage5_step1700.svg
[rank0]:2025-10-30 16:15:31,850 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank0/251030_1615_stage4_step1700.svg
[rank3]:2025-10-30 16:15:32,022 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/pipeline_schedule/251030_1615_real_step1700_rank3.svg
[rank3]:> Batch Time: 346.93 ms, GPU Bubble Ratio: 62.81%, 42.87%, 49.83%, 12.74%
[rank3]:2025-10-30 16:15:32,097 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank3/251030_1615_stage3_step1700.svg
[rank3]:2025-10-30 16:15:32,166 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank3/251030_1615_stage7_step1700.svg
[rank3]:2025-10-30 16:15:32,481 - INFO - Avg. fwd time: 7.3142 / Avg. bwd time: 12.6847 / Avg. batch time: 447.9021 (ms) / GPU bubble ratio: 28.56%
[rank0]:2025-10-30 16:15:32,459 - INFO - Avg. fwd time: 4.5351 / Avg. bwd time: 5.2207 / Avg. batch time: 506.9523 (ms) / GPU bubble ratio: 69.21%
[rank2]:2025-10-30 16:15:32,551 - INFO - Avg. fwd time: 4.3590 / Avg. bwd time: 7.0179 / Avg. batch time: 477.6921 (ms) / GPU bubble ratio: 61.89%
[rank1]:2025-10-30 16:15:32,557 - INFO - Avg. fwd time: 5.4946 / Avg. bwd time: 7.4045 / Avg. batch time: 495.2346 (ms) / GPU bubble ratio: 58.33%
[rank0]:2025-10-30 16:16:30,718 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-30 16:16:31,930 - INFO -  step: 1750  loss: -2.0000  grad_norm:  1.3779  memory:  8.44GiB(17.77%)  tps: 6,800  tflops: 51.79  mfu: 16.60%
[rank3]:2025-10-30 16:16:31,937 - INFO -  step: 1750  loss:  0.2415  grad_norm:  1.3779  memory: 19.24GiB(40.50%)  tps: 6,800  tflops: 51.79  mfu: 16.60%
[rank1]:2025-10-30 16:16:31,922 - INFO -  step: 1750  loss: -2.0000  grad_norm:  1.3779  memory: 12.20GiB(25.67%)  tps: 6,800  tflops: 51.79  mfu: 16.60%
[rank0]:2025-10-30 16:16:31,921 - INFO -  step: 1750  loss: -2.0000  grad_norm:  1.3779  memory: 15.18GiB(31.96%)  tps: 6,800  tflops: 51.79  mfu: 16.60%
[rank0]:2025-10-30 16:17:30,538 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-30 16:17:31,748 - INFO -  step: 1800  loss: -2.0000  grad_norm:  0.5435  memory: 12.20GiB(25.67%)  tps: 6,847  tflops: 52.14  mfu: 16.71%
[rank1]:2025-10-30 16:17:31,748 - INFO - ðŸ”Ž  Running validation at step 1800
[rank0]:2025-10-30 16:17:31,747 - INFO -  step: 1800  loss: -2.0000  grad_norm:  0.5435  memory: 15.18GiB(31.96%)  tps: 6,847  tflops: 52.14  mfu: 16.71%
[rank0]:2025-10-30 16:17:31,748 - INFO - ðŸ”Ž  Running validation at step 1800
[rank2]:2025-10-30 16:17:31,755 - INFO -  step: 1800  loss: -2.0000  grad_norm:  0.5435  memory:  8.44GiB(17.77%)  tps: 6,847  tflops: 52.15  mfu: 16.71%
[rank2]:2025-10-30 16:17:31,756 - INFO - ðŸ”Ž  Running validation at step 1800
[rank3]:2025-10-30 16:17:31,762 - INFO -  step: 1800  loss:  0.2034  grad_norm:  0.5435  memory: 19.24GiB(40.50%)  tps: 6,847  tflops: 52.15  mfu: 16.71%
[rank3]:2025-10-30 16:17:31,762 - INFO - ðŸ”Ž  Running validation at step 1800
[rank1]:2025-10-30 16:17:57,679 - INFO - validate step: 1800  loss: -1.0000  memory: 12.20GiB(25.67%)  tps: 15,796
[rank0]:2025-10-30 16:17:57,673 - INFO - validate step: 1800  loss: -1.0000  memory: 15.18GiB(31.96%)  tps: 15,799
[rank2]:2025-10-30 16:17:57,699 - INFO - validate step: 1800  loss: -1.0000  memory:  8.44GiB(17.77%)  tps: 15,789
[rank3]:2025-10-30 16:17:57,695 - INFO - validate step: 1800  loss:  0.9615  memory: 19.24GiB(40.50%)  tps: 15,796
[rank0]:2025-10-30 16:17:57,786 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank0/251030_1617_stage0_step1800.svg
[rank2]:2025-10-30 16:17:57,790 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank2/251030_1617_stage2_step1800.svg
[rank2]:2025-10-30 16:17:57,862 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank2/251030_1617_stage6_step1800.svg
[rank1]:2025-10-30 16:17:57,786 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank1/251030_1617_stage1_step1800.svg
[rank1]:2025-10-30 16:17:57,854 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank1/251030_1617_stage5_step1800.svg
[rank0]:2025-10-30 16:17:57,854 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank0/251030_1617_stage4_step1800.svg
[rank3]:2025-10-30 16:17:58,036 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/pipeline_schedule/251030_1617_real_step1800_rank3.svg
[rank3]:> Batch Time: 347.19 ms, GPU Bubble Ratio: 62.83%, 42.92%, 49.86%, 12.73%
[rank3]:2025-10-30 16:17:58,111 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank3/251030_1617_stage3_step1800.svg
[rank3]:2025-10-30 16:17:58,184 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank3/251030_1617_stage7_step1800.svg
[rank2]:2025-10-30 16:17:58,766 - INFO - Avg. fwd time: 4.3502 / Avg. bwd time: 7.1169 / Avg. batch time: 482.6521 (ms) / GPU bubble ratio: 61.99%
[rank1]:2025-10-30 16:17:58,786 - INFO - Avg. fwd time: 5.4844 / Avg. bwd time: 7.4502 / Avg. batch time: 500.1150 (ms) / GPU bubble ratio: 58.62%
[rank3]:2025-10-30 16:17:58,736 - INFO - Avg. fwd time: 7.2745 / Avg. bwd time: 12.9998 / Avg. batch time: 452.3168 (ms) / GPU bubble ratio: 28.28%
[rank0]:2025-10-30 16:17:58,799 - INFO - Avg. fwd time: 4.5291 / Avg. bwd time: 5.1944 / Avg. batch time: 511.6168 (ms) / GPU bubble ratio: 69.59%
[rank0]:2025-10-30 16:18:56,826 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-30 16:18:58,040 - INFO -  step: 1850  loss: -2.0000  grad_norm:  0.4387  memory: 12.20GiB(25.67%)  tps: 6,786  tflops: 51.68  mfu: 16.56%
[rank3]:2025-10-30 16:18:58,054 - INFO -  step: 1850  loss:  0.3062  grad_norm:  0.4387  memory: 19.24GiB(40.50%)  tps: 6,786  tflops: 51.69  mfu: 16.57%
[rank0]:2025-10-30 16:18:58,040 - INFO -  step: 1850  loss: -2.0000  grad_norm:  0.4387  memory: 15.18GiB(31.96%)  tps: 6,785  tflops: 51.68  mfu: 16.56%
[rank2]:2025-10-30 16:18:58,048 - INFO -  step: 1850  loss: -2.0000  grad_norm:  0.4387  memory:  8.44GiB(17.77%)  tps: 6,787  tflops: 51.69  mfu: 16.57%
[rank0]:2025-10-30 16:19:56,730 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-30 16:19:57,935 - INFO -  step: 1900  loss: -2.0000  grad_norm:  0.3584  memory: 12.20GiB(25.67%)  tps: 6,839  tflops: 52.09  mfu: 16.69%
[rank0]:2025-10-30 16:19:57,935 - INFO -  step: 1900  loss: -2.0000  grad_norm:  0.3584  memory: 15.18GiB(31.96%)  tps: 6,839  tflops: 52.09  mfu: 16.69%
[rank2]:2025-10-30 16:19:57,943 - INFO -  step: 1900  loss: -2.0000  grad_norm:  0.3584  memory:  8.44GiB(17.77%)  tps: 6,839  tflops: 52.09  mfu: 16.69%
[rank1]:2025-10-30 16:19:58,037 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank1/251030_1619_stage1_step1900.svg
[rank3]:2025-10-30 16:19:57,949 - INFO -  step: 1900  loss:  0.2230  grad_norm:  0.3584  memory: 19.24GiB(40.50%)  tps: 6,839  tflops: 52.09  mfu: 16.69%
[rank0]:2025-10-30 16:19:58,037 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank0/251030_1619_stage0_step1900.svg
[rank2]:2025-10-30 16:19:58,042 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank2/251030_1619_stage2_step1900.svg
[rank2]:2025-10-30 16:19:58,114 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank2/251030_1619_stage6_step1900.svg
[rank1]:2025-10-30 16:19:58,106 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank1/251030_1619_stage5_step1900.svg
[rank0]:2025-10-30 16:19:58,107 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank0/251030_1619_stage4_step1900.svg
[rank3]:2025-10-30 16:19:58,279 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/pipeline_schedule/251030_1619_real_step1900_rank3.svg
[rank3]:> Batch Time: 347.49 ms, GPU Bubble Ratio: 62.86%, 42.98%, 49.90%, 12.71%
[rank3]:2025-10-30 16:19:58,350 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank3/251030_1619_stage3_step1900.svg
[rank3]:2025-10-30 16:19:58,418 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank3/251030_1619_stage7_step1900.svg
[rank3]:2025-10-30 16:19:58,728 - INFO - Avg. fwd time: 7.2445 / Avg. bwd time: 13.2405 / Avg. batch time: 455.7131 (ms) / GPU bubble ratio: 28.08%
[rank0]:2025-10-30 16:19:58,708 - INFO - Avg. fwd time: 4.5245 / Avg. bwd time: 5.1740 / Avg. batch time: 515.0643 (ms) / GPU bubble ratio: 69.87%
[rank2]:2025-10-30 16:19:58,798 - INFO - Avg. fwd time: 4.3434 / Avg. bwd time: 7.1926 / Avg. batch time: 486.3296 (ms) / GPU bubble ratio: 62.05%
[rank1]:2025-10-30 16:19:58,805 - INFO - Avg. fwd time: 5.4765 / Avg. bwd time: 7.4851 / Avg. batch time: 503.7291 (ms) / GPU bubble ratio: 58.83%
[rank0]:2025-10-30 16:20:57,194 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-30 16:20:58,398 - INFO -  step: 1950  loss: -2.0000  grad_norm:  0.2680  memory: 12.20GiB(25.67%)  tps: 6,774  tflops: 51.60  mfu: 16.54%
[rank0]:2025-10-30 16:20:58,397 - INFO -  step: 1950  loss: -2.0000  grad_norm:  0.2680  memory: 15.18GiB(31.96%)  tps: 6,774  tflops: 51.60  mfu: 16.54%
[rank3]:2025-10-30 16:20:58,412 - INFO -  step: 1950  loss:  0.1921  grad_norm:  0.2680  memory: 19.24GiB(40.50%)  tps: 6,775  tflops: 51.60  mfu: 16.54%
[rank2]:2025-10-30 16:20:58,406 - INFO -  step: 1950  loss: -2.0000  grad_norm:  0.2680  memory:  8.44GiB(17.77%)  tps: 6,774  tflops: 51.60  mfu: 16.54%
[rank0]:2025-10-30 16:21:57,039 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-30 16:21:58,248 - INFO -  step: 2000  loss: -2.0000  grad_norm:  0.3632  memory:  8.44GiB(17.77%)  tps: 6,845  tflops: 52.13  mfu: 16.71%
[rank2]:2025-10-30 16:21:58,248 - INFO - ðŸ”Ž  Running validation at step 2000
[rank0]:2025-10-30 16:21:58,240 - INFO -  step: 2000  loss: -2.0000  grad_norm:  0.3632  memory: 15.18GiB(31.96%)  tps: 6,845  tflops: 52.13  mfu: 16.71%
[rank0]:2025-10-30 16:21:58,240 - INFO - ðŸ”Ž  Running validation at step 2000
[rank1]:2025-10-30 16:21:58,240 - INFO -  step: 2000  loss: -2.0000  grad_norm:  0.3632  memory: 12.20GiB(25.67%)  tps: 6,845  tflops: 52.13  mfu: 16.71%
[rank1]:2025-10-30 16:21:58,240 - INFO - ðŸ”Ž  Running validation at step 2000
[rank3]:2025-10-30 16:21:58,255 - INFO -  step: 2000  loss:  0.2353  grad_norm:  0.3632  memory: 19.24GiB(40.50%)  tps: 6,845  tflops: 52.13  mfu: 16.71%
[rank3]:2025-10-30 16:21:58,256 - INFO - ðŸ”Ž  Running validation at step 2000
[rank2]:2025-10-30 16:22:24,205 - INFO - validate step: 2000  loss: -1.0000  memory:  8.44GiB(17.77%)  tps: 15,780
[rank3]:2025-10-30 16:22:24,202 - INFO - validate step: 2000  loss:  0.9643  memory: 19.24GiB(40.50%)  tps: 15,787
[rank1]:2025-10-30 16:22:24,186 - INFO - validate step: 2000  loss: -1.0000  memory: 12.20GiB(25.67%)  tps: 15,787
[rank0]:2025-10-30 16:22:24,179 - INFO - validate step: 2000  loss: -1.0000  memory: 15.18GiB(31.96%)  tps: 15,791
[rank2]:2025-10-30 16:22:24,299 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank2/251030_1622_stage2_step2000.svg
[rank1]:2025-10-30 16:22:24,297 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank1/251030_1622_stage1_step2000.svg
[rank0]:2025-10-30 16:22:24,297 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank0/251030_1622_stage0_step2000.svg
[rank2]:2025-10-30 16:22:24,372 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank2/251030_1622_stage6_step2000.svg
[rank1]:2025-10-30 16:22:24,368 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank1/251030_1622_stage5_step2000.svg
[rank0]:2025-10-30 16:22:24,368 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank0/251030_1622_stage4_step2000.svg
[rank3]:2025-10-30 16:22:24,526 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/pipeline_schedule/251030_1622_real_step2000_rank3.svg
[rank3]:> Batch Time: 347.83 ms, GPU Bubble Ratio: 62.90%, 43.04%, 49.95%, 12.69%
[rank3]:2025-10-30 16:22:24,601 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank3/251030_1622_stage3_step2000.svg
[rank3]:2025-10-30 16:22:24,671 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank3/251030_1622_stage7_step2000.svg
[rank3]:2025-10-30 16:22:24,985 - INFO - Avg. fwd time: 7.2138 / Avg. bwd time: 13.4976 / Avg. batch time: 459.3221 (ms) / GPU bubble ratio: 27.85%
[rank0]:2025-10-30 16:22:24,964 - INFO - Avg. fwd time: 4.5196 / Avg. bwd time: 5.1523 / Avg. batch time: 518.7952 (ms) / GPU bubble ratio: 70.17%
[rank2]:2025-10-30 16:22:25,055 - INFO - Avg. fwd time: 4.3361 / Avg. bwd time: 7.2717 / Avg. batch time: 490.3031 (ms) / GPU bubble ratio: 62.12%
[rank1]:2025-10-30 16:22:25,062 - INFO - Avg. fwd time: 5.4681 / Avg. bwd time: 7.5216 / Avg. batch time: 507.6353 (ms) / GPU bubble ratio: 59.06%
[rank0]:2025-10-30 16:23:23,346 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-30 16:23:24,558 - INFO -  step: 2050  loss: -2.0000  grad_norm:  0.3285  memory:  8.44GiB(17.77%)  tps: 6,787  tflops: 51.69  mfu: 16.57%
[rank0]:2025-10-30 16:23:24,550 - INFO -  step: 2050  loss: -2.0000  grad_norm:  0.3285  memory: 15.18GiB(31.96%)  tps: 6,785  tflops: 51.67  mfu: 16.56%
[rank1]:2025-10-30 16:23:24,550 - INFO -  step: 2050  loss: -2.0000  grad_norm:  0.3285  memory: 12.20GiB(25.67%)  tps: 6,786  tflops: 51.68  mfu: 16.56%
[rank3]:2025-10-30 16:23:24,563 - INFO -  step: 2050  loss:  0.2065  grad_norm:  0.3285  memory: 19.24GiB(40.50%)  tps: 6,786  tflops: 51.68  mfu: 16.57%
[rank0]:2025-10-30 16:24:23,372 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-30 16:24:24,576 - INFO -  step: 2100  loss: -2.0000  grad_norm:  0.3251  memory: 15.18GiB(31.96%)  tps: 6,824  tflops: 51.97  mfu: 16.66%
[rank1]:2025-10-30 16:24:24,576 - INFO -  step: 2100  loss: -2.0000  grad_norm:  0.3251  memory: 12.20GiB(25.67%)  tps: 6,824  tflops: 51.97  mfu: 16.66%
[rank3]:2025-10-30 16:24:24,589 - INFO -  step: 2100  loss:  0.2443  grad_norm:  0.3251  memory: 19.24GiB(40.50%)  tps: 6,824  tflops: 51.97  mfu: 16.66%
[rank2]:2025-10-30 16:24:24,583 - INFO -  step: 2100  loss: -2.0000  grad_norm:  0.3251  memory:  8.44GiB(17.77%)  tps: 6,824  tflops: 51.97  mfu: 16.66%
[rank0]:2025-10-30 16:24:24,673 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank0/251030_1624_stage0_step2100.svg
[rank1]:2025-10-30 16:24:24,673 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank1/251030_1624_stage1_step2100.svg
[rank2]:2025-10-30 16:24:24,674 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank2/251030_1624_stage2_step2100.svg
[rank2]:2025-10-30 16:24:24,739 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank2/251030_1624_stage6_step2100.svg
[rank0]:2025-10-30 16:24:24,737 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank0/251030_1624_stage4_step2100.svg
[rank1]:2025-10-30 16:24:24,737 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank1/251030_1624_stage5_step2100.svg
[rank3]:2025-10-30 16:24:24,914 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/pipeline_schedule/251030_1624_real_step2100_rank3.svg
[rank3]:> Batch Time: 348.54 ms, GPU Bubble Ratio: 61.35%, 43.17%, 50.04%, 12.75%
[rank3]:2025-10-30 16:24:24,980 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank3/251030_1624_stage3_step2100.svg
[rank3]:2025-10-30 16:24:25,042 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank3/251030_1624_stage7_step2100.svg
[rank3]:2025-10-30 16:24:25,586 - INFO - Avg. fwd time: 7.1859 / Avg. bwd time: 13.7292 / Avg. batch time: 462.5654 (ms) / GPU bubble ratio: 27.66%
[rank2]:2025-10-30 16:24:25,616 - INFO - Avg. fwd time: 4.3296 / Avg. bwd time: 7.3429 / Avg. batch time: 493.9394 (ms) / GPU bubble ratio: 62.19%
[rank0]:2025-10-30 16:24:25,651 - INFO - Avg. fwd time: 4.5155 / Avg. bwd time: 5.1328 / Avg. batch time: 522.2195 (ms) / GPU bubble ratio: 70.44%
[rank1]:2025-10-30 16:24:25,636 - INFO - Avg. fwd time: 5.4606 / Avg. bwd time: 7.5543 / Avg. batch time: 511.2126 (ms) / GPU bubble ratio: 59.27%
[rank0]:2025-10-30 16:25:23,792 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-30 16:25:25,012 - INFO -  step: 2150  loss: -2.0000  grad_norm:  0.2869  memory:  8.44GiB(17.77%)  tps: 6,778  tflops: 51.62  mfu: 16.55%
[rank3]:2025-10-30 16:25:25,018 - INFO -  step: 2150  loss:  0.2188  grad_norm:  0.2869  memory: 19.24GiB(40.50%)  tps: 6,778  tflops: 51.63  mfu: 16.55%
[rank1]:2025-10-30 16:25:25,004 - INFO -  step: 2150  loss: -2.0000  grad_norm:  0.2869  memory: 12.20GiB(25.67%)  tps: 6,778  tflops: 51.63  mfu: 16.55%
[rank0]:2025-10-30 16:25:25,004 - INFO -  step: 2150  loss: -2.0000  grad_norm:  0.2869  memory: 15.18GiB(31.96%)  tps: 6,778  tflops: 51.62  mfu: 16.55%
[rank0]:2025-10-30 16:26:23,774 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-30 16:26:24,989 - INFO -  step: 2200  loss: -2.0000  grad_norm:  0.3713  memory:  8.44GiB(17.77%)  tps: 6,829  tflops: 52.01  mfu: 16.67%
[rank2]:2025-10-30 16:26:24,989 - INFO - ðŸ”Ž  Running validation at step 2200
[rank0]:2025-10-30 16:26:24,981 - INFO -  step: 2200  loss: -2.0000  grad_norm:  0.3713  memory: 15.18GiB(31.96%)  tps: 6,829  tflops: 52.01  mfu: 16.67%
[rank0]:2025-10-30 16:26:24,981 - INFO - ðŸ”Ž  Running validation at step 2200
[rank1]:2025-10-30 16:26:24,981 - INFO -  step: 2200  loss: -2.0000  grad_norm:  0.3713  memory: 12.20GiB(25.67%)  tps: 6,829  tflops: 52.01  mfu: 16.67%
[rank1]:2025-10-30 16:26:24,981 - INFO - ðŸ”Ž  Running validation at step 2200
[rank3]:2025-10-30 16:26:24,994 - INFO -  step: 2200  loss:  0.2468  grad_norm:  0.3713  memory: 19.24GiB(40.50%)  tps: 6,830  tflops: 52.02  mfu: 16.67%
[rank3]:2025-10-30 16:26:24,995 - INFO - ðŸ”Ž  Running validation at step 2200
[rank0]:2025-10-30 16:26:51,191 - INFO - validate step: 2200  loss: -1.0000  memory: 15.18GiB(31.96%)  tps: 15,627
[rank2]:2025-10-30 16:26:51,214 - INFO - validate step: 2200  loss: -1.0000  memory:  8.44GiB(17.77%)  tps: 15,619
[rank1]:2025-10-30 16:26:51,196 - INFO - validate step: 2200  loss: -1.0000  memory: 12.20GiB(25.67%)  tps: 15,625
[rank3]:2025-10-30 16:26:51,210 - INFO - validate step: 2200  loss:  0.9697  memory: 19.24GiB(40.50%)  tps: 15,625
[rank2]:2025-10-30 16:26:51,299 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank2/251030_1626_stage2_step2200.svg
[rank2]:2025-10-30 16:26:51,362 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank2/251030_1626_stage6_step2200.svg
[rank1]:2025-10-30 16:26:51,297 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank1/251030_1626_stage1_step2200.svg
[rank1]:2025-10-30 16:26:51,359 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank1/251030_1626_stage5_step2200.svg
[rank0]:2025-10-30 16:26:51,300 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank0/251030_1626_stage0_step2200.svg
[rank0]:2025-10-30 16:26:51,363 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank0/251030_1626_stage4_step2200.svg
[rank3]:2025-10-30 16:26:51,532 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/pipeline_schedule/251030_1626_real_step2200_rank3.svg
[rank3]:> Batch Time: 349.17 ms, GPU Bubble Ratio: 61.05%, 43.27%, 50.11%, 12.77%
[rank3]:2025-10-30 16:26:51,600 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank3/251030_1626_stage3_step2200.svg
[rank3]:2025-10-30 16:26:51,661 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank3/251030_1626_stage7_step2200.svg
[rank0]:2025-10-30 16:26:51,959 - INFO - Avg. fwd time: 4.5123 / Avg. bwd time: 5.1176 / Avg. batch time: 524.7890 (ms) / GPU bubble ratio: 70.64%
[rank3]:2025-10-30 16:26:51,980 - INFO - Avg. fwd time: 7.1645 / Avg. bwd time: 13.9113 / Avg. batch time: 465.1103 (ms) / GPU bubble ratio: 27.50%
[rank2]:2025-10-30 16:26:52,049 - INFO - Avg. fwd time: 4.3246 / Avg. bwd time: 7.3986 / Avg. batch time: 496.6775 (ms) / GPU bubble ratio: 62.23%
[rank1]:2025-10-30 16:26:52,054 - INFO - Avg. fwd time: 5.4547 / Avg. bwd time: 7.5797 / Avg. batch time: 513.9034 (ms) / GPU bubble ratio: 59.42%
[rank0]:2025-10-30 16:27:50,400 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-30 16:27:51,615 - INFO -  step: 2250  loss: -2.0000  grad_norm:  0.3401  memory:  8.44GiB(17.77%)  tps: 6,781  tflops: 51.65  mfu: 16.55%
[rank0]:2025-10-30 16:27:51,607 - INFO -  step: 2250  loss: -2.0000  grad_norm:  0.3401  memory: 15.18GiB(31.96%)  tps: 6,780  tflops: 51.64  mfu: 16.55%
[rank1]:2025-10-30 16:27:51,608 - INFO -  step: 2250  loss: -2.0000  grad_norm:  0.3401  memory: 12.20GiB(25.67%)  tps: 6,780  tflops: 51.64  mfu: 16.55%
[rank3]:2025-10-30 16:27:51,621 - INFO -  step: 2250  loss:  0.2411  grad_norm:  0.3401  memory: 19.24GiB(40.50%)  tps: 6,780  tflops: 51.64  mfu: 16.55%
[rank0]:2025-10-30 16:28:50,464 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-30 16:28:51,679 - INFO -  step: 2300  loss: -2.0000  grad_norm:  0.2898  memory:  8.44GiB(17.77%)  tps: 6,819  tflops: 51.94  mfu: 16.65%
[rank3]:2025-10-30 16:28:51,685 - INFO -  step: 2300  loss:  0.2315  grad_norm:  0.2898  memory: 19.24GiB(40.50%)  tps: 6,820  tflops: 51.94  mfu: 16.65%
[rank0]:2025-10-30 16:28:51,672 - INFO -  step: 2300  loss: -2.0000  grad_norm:  0.2898  memory: 15.18GiB(31.96%)  tps: 6,819  tflops: 51.94  mfu: 16.65%
[rank1]:2025-10-30 16:28:51,672 - INFO -  step: 2300  loss: -2.0000  grad_norm:  0.2898  memory: 12.20GiB(25.67%)  tps: 6,819  tflops: 51.94  mfu: 16.65%
[rank2]:2025-10-30 16:28:51,770 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank2/251030_1628_stage2_step2300.svg
[rank0]:2025-10-30 16:28:51,771 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank0/251030_1628_stage0_step2300.svg
[rank0]:2025-10-30 16:28:51,835 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank0/251030_1628_stage4_step2300.svg
[rank1]:2025-10-30 16:28:51,771 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank1/251030_1628_stage1_step2300.svg
[rank1]:2025-10-30 16:28:51,835 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank1/251030_1628_stage5_step2300.svg
[rank2]:2025-10-30 16:28:51,835 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank2/251030_1628_stage6_step2300.svg
[rank3]:2025-10-30 16:28:52,010 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/pipeline_schedule/251030_1628_real_step2300_rank3.svg
[rank3]:> Batch Time: 349.83 ms, GPU Bubble Ratio: 60.58%, 43.24%, 50.17%, 12.79%
[rank3]:2025-10-30 16:28:52,076 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank3/251030_1628_stage3_step2300.svg
[rank3]:2025-10-30 16:28:52,140 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank3/251030_1628_stage7_step2300.svg
[rank0]:2025-10-30 16:28:52,441 - INFO - Avg. fwd time: 4.5091 / Avg. bwd time: 5.1015 / Avg. batch time: 527.6015 (ms) / GPU bubble ratio: 70.86%
[rank3]:2025-10-30 16:28:52,466 - INFO - Avg. fwd time: 7.1425 / Avg. bwd time: 14.1033 / Avg. batch time: 467.8330 (ms) / GPU bubble ratio: 27.34%
[rank1]:2025-10-30 16:28:52,534 - INFO - Avg. fwd time: 5.4485 / Avg. bwd time: 7.6071 / Avg. batch time: 516.8445 (ms) / GPU bubble ratio: 59.58%
[rank2]:2025-10-30 16:28:52,528 - INFO - Avg. fwd time: 4.3193 / Avg. bwd time: 7.4583 / Avg. batch time: 499.6691 (ms) / GPU bubble ratio: 62.29%
[rank0]:2025-10-30 16:29:50,848 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-30 16:29:52,062 - INFO -  step: 2350  loss: -2.0000  grad_norm:  0.2480  memory:  8.44GiB(17.77%)  tps: 6,783  tflops: 51.66  mfu: 16.56%
[rank3]:2025-10-30 16:29:52,068 - INFO -  step: 2350  loss:  0.2098  grad_norm:  0.2480  memory: 19.24GiB(40.50%)  tps: 6,784  tflops: 51.66  mfu: 16.56%
[rank0]:2025-10-30 16:29:52,055 - INFO -  step: 2350  loss: -2.0000  grad_norm:  0.2480  memory: 15.18GiB(31.96%)  tps: 6,783  tflops: 51.66  mfu: 16.56%
[rank1]:2025-10-30 16:29:52,055 - INFO -  step: 2350  loss: -2.0000  grad_norm:  0.2480  memory: 12.20GiB(25.67%)  tps: 6,783  tflops: 51.66  mfu: 16.56%
[rank0]:2025-10-30 16:30:50,771 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-30 16:30:51,975 - INFO -  step: 2400  loss: -2.0000  grad_norm:  0.3650  memory: 15.18GiB(31.96%)  tps: 6,836  tflops: 52.06  mfu: 16.69%
[rank0]:2025-10-30 16:30:51,975 - INFO -  final step: 2400  loss: -2.0000  grad_norm:  0.3650  tps: 7,574  tflops: 57.68  mfu: 17.99%
[rank0]:2025-10-30 16:30:51,975 - INFO - ðŸ”Ž  Running validation at step 2400
[rank3]:2025-10-30 16:30:51,989 - INFO -  step: 2400  loss:  0.2323  grad_norm:  0.3650  memory: 19.24GiB(40.50%)  tps: 6,836  tflops: 52.06  mfu: 16.69%
[rank3]:2025-10-30 16:30:51,990 - INFO -  final step: 2400  loss:  0.2323  grad_norm:  0.3650  tps: 7,578  tflops: 57.72  mfu: 17.99%
[rank3]:2025-10-30 16:30:51,990 - INFO - ðŸ”Ž  Running validation at step 2400
[rank1]:2025-10-30 16:30:51,975 - INFO -  step: 2400  loss: -2.0000  grad_norm:  0.3650  memory: 12.20GiB(25.67%)  tps: 6,836  tflops: 52.06  mfu: 16.69%
[rank1]:2025-10-30 16:30:51,976 - INFO -  final step: 2400  loss: -2.0000  grad_norm:  0.3650  tps: 7,575  tflops: 57.69  mfu: 18.00%
[rank1]:2025-10-30 16:30:51,976 - INFO - ðŸ”Ž  Running validation at step 2400
[rank2]:2025-10-30 16:30:51,983 - INFO -  step: 2400  loss: -2.0000  grad_norm:  0.3650  memory:  8.44GiB(17.77%)  tps: 6,836  tflops: 52.06  mfu: 16.69%
[rank2]:2025-10-30 16:30:51,983 - INFO -  final step: 2400  loss: -2.0000  grad_norm:  0.3650  tps: 7,574  tflops: 57.69  mfu: 18.00%
[rank2]:2025-10-30 16:30:51,983 - INFO - ðŸ”Ž  Running validation at step 2400
[rank0]:2025-10-30 16:31:18,095 - INFO - validate step: 2400  loss: -1.0000  memory: 15.18GiB(31.96%)  tps: 15,682
[rank0]:2025-10-30 16:31:18,095 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-30 16:31:18,098 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank3]:2025-10-30 16:31:18,116 - INFO - validate step: 2400  loss:  0.9671  memory: 19.24GiB(40.50%)  tps: 15,679
[rank3]:2025-10-30 16:31:18,117 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-30 16:31:18,119 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank1]:2025-10-30 16:31:18,101 - INFO - validate step: 2400  loss: -1.0000  memory: 12.20GiB(25.67%)  tps: 15,678
[rank1]:2025-10-30 16:31:18,102 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-30 16:31:18,103 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank2]:2025-10-30 16:31:18,120 - INFO - validate step: 2400  loss: -1.0000  memory:  8.44GiB(17.77%)  tps: 15,672
[rank2]:2025-10-30 16:31:18,120 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-30 16:31:18,122 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank0]:2025-10-30 16:31:20,730 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank0]:2025-10-30 16:31:20,821 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank0/251030_1631_stage0_final2400.svg
[rank1]:2025-10-30 16:31:20,821 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank1/251030_1631_stage1_final2400.svg
[rank2]:2025-10-30 16:31:20,821 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank2/251030_1631_stage2_final2400.svg
[rank2]:2025-10-30 16:31:20,973 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/frozen_params_histogram/251030_1631_rank2_stage2.svg
[rank2]:	> Counts Sum: 595280, Total Sum: 668160 (89.09%), Ratio(%) per element: [89.17, 89.0, 88.9, 89.22, 89.38, 88.9, 89.11, 88.9, 89.11, 89.06, 88.84, 89.33, 89.33, 89.38, 89.27, 89.06, 88.95, 88.68]
[rank0]:2025-10-30 16:31:20,973 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/frozen_params_histogram/251030_1631_rank0_stage0.svg
[rank0]:	> Counts Sum: 606800, Total Sum: 705280 (86.04%), Ratio(%) per element: [87.01, 85.72, 86.2, 85.93, 85.99, 85.82, 85.82, 86.15, 85.93, 86.2, 85.82, 85.88, 85.93, 86.26, 85.99, 86.26, 85.88, 86.09, 85.72]
[rank0]:2025-10-30 16:31:21,039 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank0/251030_1631_stage4_final2400.svg
[rank1]:2025-10-30 16:31:21,006 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/frozen_params_histogram/251030_1631_rank1_stage1.svg
[rank1]:	> Counts Sum: 529240, Total Sum: 1002240 (52.81%), Ratio(%) per element: [52.15, 52.47, 52.2, 52.58, 52.74, 53.44, 52.15, 52.53, 52.64, 52.9, 52.53, 52.85, 52.53, 53.01, 53.34, 52.53, 53.07, 53.34, 52.69, 52.74, 52.53, 53.12, 53.07, 53.39, 53.23, 53.12, 52.74]
[rank2]:2025-10-30 16:31:21,043 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank2/251030_1631_stage6_final2400.svg
[rank3]:2025-10-30 16:31:21,065 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/pipeline_schedule/251030_1631_real_final2400_rank3.svg
[rank3]:> Batch Time: 350.93 ms, GPU Bubble Ratio: 60.03%, 41.70%, 50.28%, 12.90%
[rank1]:2025-10-30 16:31:21,072 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank1/251030_1631_stage5_final2400.svg
[rank2]:2025-10-30 16:31:21,187 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/frozen_params_histogram/251030_1631_rank2_stage6.svg
[rank2]:	> Counts Sum: 579540, Total Sum: 668160 (86.74%), Ratio(%) per element: [86.53, 86.63, 86.9, 86.53, 86.58, 86.69, 86.79, 86.58, 86.69, 86.9, 86.85, 86.96, 86.79, 86.85, 86.69, 86.63, 86.79, 86.79]
[rank2]:2025-10-30 16:31:21,188 - INFO - Destroying the purge thread.
[rank0]:2025-10-30 16:31:21,180 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/frozen_params_histogram/251030_1631_rank0_stage4.svg
[rank0]:	> Counts Sum: 619820, Total Sum: 668160 (92.77%), Ratio(%) per element: [92.61, 92.61, 92.4, 92.56, 92.51, 92.61, 92.72, 92.45, 92.4, 93.1, 92.94, 93.1, 92.88, 93.1, 92.88, 92.83, 93.1, 92.88]
[rank0]:2025-10-30 16:31:21,180 - INFO - Sleeping 2 seconds for other ranks to complete
[rank1]:2025-10-30 16:31:21,212 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/frozen_params_histogram/251030_1631_rank1_stage5.svg
[rank1]:	> Counts Sum: 617540, Total Sum: 668160 (92.42%), Ratio(%) per element: [92.34, 92.51, 92.45, 92.51, 92.45, 92.45, 92.29, 92.4, 92.34, 92.4, 92.4, 92.51, 92.34, 92.45, 92.4, 92.51, 92.4, 92.4]
[rank1]:2025-10-30 16:31:21,212 - INFO - Destroying the purge thread.
[rank3]:2025-10-30 16:31:21,381 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/pipeline_schedule/251030_1631_thry_final2400_rank3.svg
[rank3]:> Batch Time: 310.77 ms, GPU Bubble Ratio: 15.79%, 15.79%, 15.79%, 15.79%
[rank3]:2025-10-30 16:31:21,451 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank3/251030_1631_stage3_final2400.svg
[rank3]:2025-10-30 16:31:21,602 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/frozen_params_histogram/251030_1631_rank3_stage3.svg
[rank3]:	> Counts Sum: 177980, Total Sum: 668160 (26.64%), Ratio(%) per element: [26.07, 26.29, 26.45, 25.53, 26.4, 26.29, 25.8, 26.02, 26.34, 27.85, 27.04, 27.31, 26.56, 27.1, 27.26, 27.42, 27.26, 26.4]
[rank2]:2025-10-30 16:31:21,691 - INFO - Process group destroyed
[rank3]:2025-10-30 16:31:21,667 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/freeze_ratio_history/rank3/251030_1631_stage7_final2400.svg
[rank1]:2025-10-30 16:31:21,703 - INFO - Process group destroyed
[rank3]:2025-10-30 16:31:21,786 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1/frozen_params_histogram/251030_1631_rank3_stage7.svg
[rank3]:	> Counts Sum: 171820, Total Sum: 408320 (42.08%), Ratio(%) per element: [42.07, 41.81, 41.81, 42.45, 42.02, 42.29, 42.18, 42.61, 41.91, 41.59, 42.07]
[rank3]:2025-10-30 16:31:21,787 - INFO - Destroying the purge thread.
[rank3]:wandb: uploading console lines 459-466; updating run metadata
[rank3]:wandb: uploading history steps 48-48, summary, console lines 467-472
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–„â–â–‚â–â–â–â–â–â–â–â–‡â–â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–ˆâ–‡â–„â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–ˆâ–‡â–„â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 1.08098
[rank3]:wandb:               final/avg_loss 0.23229
[rank3]:wandb:             final/avg_mfu(%) 17.99303
[rank3]:wandb:             final/avg_tflops 57.71814
[rank3]:wandb:    final/avg_throughput(tps) 7578.32553
[rank3]:wandb:              final/grad_norm 0.36503
[rank3]:wandb:               final/max_loss 0.23229
[rank3]:wandb:                    grad_norm 0.36503
[rank3]:wandb: loss_metrics/global_avg_loss 0.23229
[rank3]:wandb: loss_metrics/global_max_loss 0.23229
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1029_Interleaved1F1B_timelyauto_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/moqyevd0
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1029_Interleaved1F1B_timelyauto_dm1/20251030-1541/wandb/run-20251030_154150-moqyevd0/logs
[rank0]:2025-10-30 16:31:23,180 - INFO - Training completed
[rank0]:2025-10-30 16:31:23,181 - INFO - Destroying the purge thread.
[rank0]:2025-10-30 16:31:23,552 - INFO - Process group destroyed
[rank3]:2025-10-30 16:31:23,558 - INFO - Process group destroyed
[rank2]:Stage 2: Modules to keep: {'layers.6', 'layers.5'}
[rank2]:Stage 6: Modules to keep: {'layers.14', 'layers.13'}
[rank0]:Stage 0: Modules to keep: {'layers.1', 'layers.0', 'tok_embeddings'}
[rank0]:Stage 4: Modules to keep: {'layers.9', 'layers.10'}
[rank1]:Stage 1: Modules to keep: {'layers.3', 'layers.2', 'layers.4'}
[rank1]:Stage 5: Modules to keep: {'layers.12', 'layers.11'}
[rank3]:Stage 3: Modules to keep: {'layers.8', 'layers.7'}
[rank3]:Stage 7: Modules to keep: {'layers.15', 'norm', 'output'}
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1029_llama1b/config.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1029_Interleaved1F1B_timelyauto_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1029_Interleaved1F1B_timelyauto_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1029_Interleaved1F1B_timelyauto_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1029_Interleaved1F1B_timelyauto_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1029_Interleaved1F1B_timelyauto_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1029_Interleaved1F1B_timelyauto_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B-Instruct
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 1e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: alpaca
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 512
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 2400
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: Interleaved1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 4
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 2
[rank3]:		- stages_list: [3, 7]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1029_Interleaved1F1B_timelyauto_dm1
[rank3]:		- interval: 800
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B-Instruct/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1029_Interleaved1F1B_timelyauto_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: True
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: timelyauto
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- aggressiveness: 0
[rank3]:
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
