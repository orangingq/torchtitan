ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 10. 31. (ê¸ˆ) 23:18:13 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 3,4,5,6
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1029_llama1b/run_1031.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1029_llama1b/1031_Interleaved1F1B_nofreeze.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
+ more freezing in autofreeze mode. 
+ lr_scheduler min_lr = 0 -> 1e-6, cosine decay.

âœ”ï¸Running with nofreeze x Interleaved1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1029_llama1b/config_1031.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
+ more freezing in autofreeze mode. 
+ lr_scheduler min_lr = 0 -> 1e-6, cosine decay.
" --parallelism.pipeline_parallel_degree=4  --freezing.no-freeze
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank3]:2025-10-31 23:18:19,706 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
[rank3]:+ more freezing in autofreeze mode. 
[rank3]:+ lr_scheduler min_lr = 0 -> 1e-6, cosine decay.
[rank3]:"
[rank2]:2025-10-31 23:18:19,757 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
[rank2]:+ more freezing in autofreeze mode. 
[rank2]:+ lr_scheduler min_lr = 0 -> 1e-6, cosine decay.
[rank2]:"
[rank1]:2025-10-31 23:18:19,708 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
[rank1]:+ more freezing in autofreeze mode. 
[rank1]:+ lr_scheduler min_lr = 0 -> 1e-6, cosine decay.
[rank1]:"
[rank0]:2025-10-31 23:18:19,782 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
[rank0]:+ more freezing in autofreeze mode. 
[rank0]:+ lr_scheduler min_lr = 0 -> 1e-6, cosine decay.
[rank0]:"
[rank2]:2025-10-31 23:18:20,065 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-10-31 23:18:20,068 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-10-31 23:18:20,029 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-10-31 23:18:20,031 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-31 23:18:20,086 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-10-31 23:18:20,088 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-31 23:18:20,093 - INFO - [GC] Initial GC collection 0.00 seconds
[rank3]:2025-10-31 23:18:20,015 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-10-31 23:18:20,018 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-31 23:18:21,214 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-10-31 23:18:21,621 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank0]:2025-10-31 23:18:24,504 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=512, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank2]:2025-10-31 23:18:24,634 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-10-31 23:18:24,679 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-10-31 23:18:24,706 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.5', 'layers.6']
[rank1]:2025-10-31 23:18:24,673 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-10-31 23:18:24,712 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-10-31 23:18:24,654 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-10-31 23:18:24,697 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-10-31 23:18:24,699 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank2]:2025-10-31 23:18:24,719 - INFO - PP rank 2 is building stage_idx 6 with modules ['layers.13', 'layers.14']
[rank2]:2025-10-31 23:18:24,720 - INFO - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank1]:2025-10-31 23:18:24,740 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.2', 'layers.3', 'layers.4']
[rank1]:2025-10-31 23:18:24,752 - INFO - PP rank 1 is building stage_idx 5 with modules ['layers.11', 'layers.12']
[rank1]:2025-10-31 23:18:24,753 - INFO - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank0]:2025-10-31 23:18:24,726 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1']
[rank0]:2025-10-31 23:18:24,739 - INFO - PP rank 0 is building stage_idx 4 with modules ['layers.9', 'layers.10']
[rank0]:2025-10-31 23:18:24,740 - INFO - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank2]:2025-10-31 23:18:24,901 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-10-31 23:18:24,901 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-10-31 23:18:24,901 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank1]:2025-10-31 23:18:24,936 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-10-31 23:18:24,936 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-10-31 23:18:24,937 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank0]:2025-10-31 23:18:24,921 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-10-31 23:18:24,921 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-10-31 23:18:24,922 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run fcmg2c9e
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1031_Interleaved1F1B_nofreeze_dm1/20251031-2318/wandb/run-20251031_231825-fcmg2c9e
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1031_Interleaved1F1B_nofreeze_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/fcmg2c9e
[rank3]:2025-10-31 23:18:27,247 - INFO - WandB logging enabled
[rank3]:2025-10-31 23:18:27,249 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-10-31 23:18:27,287 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-10-31 23:18:27,317 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.7', 'layers.8']
[rank3]:2025-10-31 23:18:27,331 - INFO - PP rank 3 is building stage_idx 7 with modules ['layers.15', 'norm', 'output']
[rank3]:2025-10-31 23:18:27,332 - INFO - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank2]:2025-10-31 23:18:27,546 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank1]:2025-10-31 23:18:27,545 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-10-31 23:18:27,529 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-10-31 23:18:27,529 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-10-31 23:18:27,530 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2025-10-31 23:18:27,545 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-10-31 23:18:27,545 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1031_Interleaved1F1B_nofreeze_dm1
[rank0]:2025-10-31 23:18:27,546 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-10-31 23:18:27,546 - INFO - Preparing c4_validation dataset from allenai/c4
[rank0]:2025-10-31 23:18:32,470 - INFO - Trainer is initialized with local batch size 32, global batch size 64, gradient accumulation steps 2, sequence length 512, total steps 2400 (warmup 100)
[rank0]:2025-10-31 23:18:32,470 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B-Instruct/original_dcp.
[rank0]:2025-10-31 23:18:36,062 - INFO - [GC] GC collection for checkpoint loading. 0.01 seconds
[rank0]:2025-10-31 23:18:36,062 - INFO - Finished loading the checkpoint in 3.59 seconds.
[rank0]:2025-10-31 23:18:36,062 - INFO - Training starts at step 1
[rank0]:2025-10-31 23:18:38,922 - INFO -  step:  1  loss: -2.0000  grad_norm: 85.2016  memory: 10.91GiB(22.96%)  tps: 576  tflops: 4.39  mfu: 1.41%
[rank0]:2025-10-31 23:18:38,922 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-10-31 23:18:38,882 - INFO -  step:  1  loss: -2.0000  grad_norm: 85.2016  memory:  6.28GiB(13.21%)  tps: 577  tflops: 4.39  mfu: 1.41%
[rank2]:2025-10-31 23:18:38,882 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-10-31 23:18:38,894 - INFO -  step:  1  loss: -2.0000  grad_norm: 85.2016  memory:  9.23GiB(19.43%)  tps: 578  tflops: 4.40  mfu: 1.41%
[rank1]:2025-10-31 23:18:38,894 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-31 23:18:38,893 - INFO -  step:  1  loss:  9.0164  grad_norm: 85.2016  memory: 14.83GiB(31.21%)  tps: 706  tflops: 5.38  mfu: 1.72%
[rank3]:2025-10-31 23:18:38,894 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-10-31 23:19:42,409 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-31 23:19:43,752 - INFO -  step: 50  loss: -2.0000  grad_norm: 35.5386  memory: 14.71GiB(30.97%)  tps: 6,192  tflops: 47.16  mfu: 15.11%
[rank3]:2025-10-31 23:19:43,750 - INFO -  step: 50  loss:  8.4947  grad_norm: 35.5386  memory: 18.19GiB(38.28%)  tps: 6,189  tflops: 47.14  mfu: 15.11%
[rank2]:2025-10-31 23:19:43,737 - INFO -  step: 50  loss: -2.0000  grad_norm: 35.5386  memory:  8.13GiB(17.12%)  tps: 6,189  tflops: 47.14  mfu: 15.11%
[rank1]:2025-10-31 23:19:43,741 - INFO -  step: 50  loss: -2.0000  grad_norm: 35.5386  memory: 11.87GiB(24.98%)  tps: 6,190  tflops: 47.15  mfu: 15.11%
[rank0]:2025-10-31 23:20:48,421 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-31 23:20:49,423 - INFO - Avg. fwd time: 6.3521 / Avg. bwd time: 21.0666 / Avg. batch time: 548.7571 (ms) / GPU bubble ratio: 20.06%
[rank2]:2025-10-31 23:20:49,479 - INFO - Avg. fwd time: 4.0545 / Avg. bwd time: 9.7057 / Avg. batch time: 581.3044 (ms) / GPU bubble ratio: 62.13%
[rank0]:2025-10-31 23:20:49,499 - INFO - Avg. fwd time: 4.2996 / Avg. bwd time: 11.9459 / Avg. batch time: 633.1889 (ms) / GPU bubble ratio: 58.95%
[rank1]:2025-10-31 23:20:49,576 - INFO - Avg. fwd time: 4.8115 / Avg. bwd time: 12.0521 / Avg. batch time: 610.2818 (ms) / GPU bubble ratio: 55.79%
[rank0]:2025-10-31 23:20:49,751 - INFO -  step: 100  loss: -2.0000  grad_norm: 68.1837  memory: 14.71GiB(30.97%)  tps: 6,206  tflops: 47.27  mfu: 15.15%
[rank3]:2025-10-31 23:20:49,749 - INFO -  step: 100  loss:  6.0575  grad_norm: 68.1837  memory: 18.19GiB(38.28%)  tps: 6,206  tflops: 47.27  mfu: 15.15%
[rank1]:2025-10-31 23:20:49,740 - INFO -  step: 100  loss: -2.0000  grad_norm: 68.1837  memory: 11.87GiB(24.98%)  tps: 6,206  tflops: 47.27  mfu: 15.15%
[rank2]:2025-10-31 23:20:49,737 - INFO -  step: 100  loss: -2.0000  grad_norm: 68.1837  memory:  8.13GiB(17.12%)  tps: 6,206  tflops: 47.27  mfu: 15.15%
[rank3]:2025-10-31 23:20:50,099 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_Interleaved1F1B_nofreeze_dm1/pipeline_schedule/251031_2320_real_step100_rank3.svg
[rank3]:> Batch Time: 504.84 ms, GPU Bubble Ratio: 49.02%, 46.42%, 56.95%, 12.94%
[rank0]:2025-10-31 23:21:54,661 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-31 23:21:56,017 - INFO -  step: 150  loss:  1.0515  grad_norm: 23.8407  memory: 18.19GiB(38.28%)  tps: 6,181  tflops: 47.08  mfu: 15.09%
[rank0]:2025-10-31 23:21:56,019 - INFO -  step: 150  loss: -2.0000  grad_norm: 23.8407  memory: 14.71GiB(30.97%)  tps: 6,181  tflops: 47.08  mfu: 15.09%
[rank1]:2025-10-31 23:21:56,008 - INFO -  step: 150  loss: -2.0000  grad_norm: 23.8407  memory: 11.87GiB(24.98%)  tps: 6,181  tflops: 47.08  mfu: 15.09%
[rank2]:2025-10-31 23:21:56,004 - INFO -  step: 150  loss: -2.0000  grad_norm: 23.8407  memory:  8.13GiB(17.12%)  tps: 6,181  tflops: 47.08  mfu: 15.09%
[rank0]:2025-10-31 23:23:00,519 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-31 23:23:01,539 - INFO - Avg. fwd time: 6.3565 / Avg. bwd time: 21.1338 / Avg. batch time: 548.2005 (ms) / GPU bubble ratio: 19.77%
[rank0]:2025-10-31 23:23:01,616 - INFO - Avg. fwd time: 4.1918 / Avg. bwd time: 11.9663 / Avg. batch time: 633.3047 (ms) / GPU bubble ratio: 59.18%
[rank2]:2025-10-31 23:23:01,596 - INFO - Avg. fwd time: 3.9463 / Avg. bwd time: 9.7255 / Avg. batch time: 581.3285 (ms) / GPU bubble ratio: 62.37%
[rank1]:2025-10-31 23:23:01,696 - INFO - Avg. fwd time: 4.8024 / Avg. bwd time: 12.0744 / Avg. batch time: 610.3898 (ms) / GPU bubble ratio: 55.76%
[rank1]:2025-10-31 23:23:01,862 - INFO -  step: 200  loss: -2.0000  grad_norm:  1.0677  memory: 11.87GiB(24.98%)  tps: 6,220  tflops: 47.37  mfu: 15.18%
[rank1]:2025-10-31 23:23:01,862 - INFO - ðŸ”Ž  Running validation at step 200
[rank2]:2025-10-31 23:23:01,858 - INFO -  step: 200  loss: -2.0000  grad_norm:  1.0677  memory:  8.13GiB(17.12%)  tps: 6,220  tflops: 47.37  mfu: 15.18%
[rank2]:2025-10-31 23:23:01,858 - INFO - ðŸ”Ž  Running validation at step 200
[rank3]:2025-10-31 23:23:01,870 - INFO -  step: 200  loss:  0.2877  grad_norm:  1.0677  memory: 18.19GiB(38.28%)  tps: 6,220  tflops: 47.37  mfu: 15.18%
[rank3]:2025-10-31 23:23:01,871 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-10-31 23:23:01,872 - INFO -  step: 200  loss: -2.0000  grad_norm:  1.0677  memory: 14.71GiB(30.97%)  tps: 6,220  tflops: 47.37  mfu: 15.18%
[rank0]:2025-10-31 23:23:01,873 - INFO - ðŸ”Ž  Running validation at step 200
[rank3]:2025-10-31 23:23:29,154 - INFO - validate step: 200  loss:  0.9452  memory: 18.19GiB(38.28%)  tps: 15,013
[rank0]:2025-10-31 23:23:29,135 - INFO - validate step: 200  loss: -1.0000  memory: 14.71GiB(30.97%)  tps: 15,024
[rank1]:2025-10-31 23:23:29,140 - INFO - validate step: 200  loss: -1.0000  memory: 11.87GiB(24.98%)  tps: 15,016
[rank2]:2025-10-31 23:23:29,155 - INFO - validate step: 200  loss: -1.0000  memory:  8.13GiB(17.12%)  tps: 15,005
[rank3]:2025-10-31 23:23:29,467 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_Interleaved1F1B_nofreeze_dm1/pipeline_schedule/251031_2323_real_step200_rank3.svg
[rank3]:> Batch Time: 503.36 ms, GPU Bubble Ratio: 48.92%, 46.29%, 56.78%, 12.94%
[rank0]:2025-10-31 23:24:33,763 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-31 23:24:35,079 - INFO -  step: 250  loss: -2.0000  grad_norm:  1.1331  memory:  8.13GiB(17.12%)  tps: 6,213  tflops: 47.32  mfu: 15.17%
[rank1]:2025-10-31 23:24:35,083 - INFO -  step: 250  loss: -2.0000  grad_norm:  1.1331  memory: 11.87GiB(24.98%)  tps: 6,212  tflops: 47.31  mfu: 15.16%
[rank0]:2025-10-31 23:24:35,094 - INFO -  step: 250  loss: -2.0000  grad_norm:  1.1331  memory: 14.71GiB(30.97%)  tps: 6,210  tflops: 47.30  mfu: 15.16%
[rank3]:2025-10-31 23:24:35,092 - INFO -  step: 250  loss:  0.2611  grad_norm:  1.1331  memory: 18.19GiB(38.28%)  tps: 6,212  tflops: 47.31  mfu: 15.16%
[rank0]:2025-10-31 23:25:39,577 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-31 23:25:40,817 - INFO - Avg. fwd time: 6.3473 / Avg. bwd time: 21.1271 / Avg. batch time: 547.4456 (ms) / GPU bubble ratio: 19.70%
[rank1]:2025-10-31 23:25:40,866 - INFO - Avg. fwd time: 4.7984 / Avg. bwd time: 12.0941 / Avg. batch time: 609.8995 (ms) / GPU bubble ratio: 55.68%
[rank2]:2025-10-31 23:25:40,843 - INFO - Avg. fwd time: 3.9122 / Avg. bwd time: 9.7391 / Avg. batch time: 580.7846 (ms) / GPU bubble ratio: 62.39%
[rank3]:2025-10-31 23:25:40,921 - INFO -  step: 300  loss:  0.2260  grad_norm:  0.5585  memory: 18.19GiB(38.28%)  tps: 6,222  tflops: 47.39  mfu: 15.19%
[rank0]:2025-10-31 23:25:40,888 - INFO - Avg. fwd time: 4.1555 / Avg. bwd time: 11.9785 / Avg. batch time: 632.8032 (ms) / GPU bubble ratio: 59.21%
[rank0]:2025-10-31 23:25:40,924 - INFO -  step: 300  loss: -2.0000  grad_norm:  0.5585  memory: 14.71GiB(30.97%)  tps: 6,222  tflops: 47.39  mfu: 15.19%
[rank1]:2025-10-31 23:25:40,913 - INFO -  step: 300  loss: -2.0000  grad_norm:  0.5585  memory: 11.87GiB(24.98%)  tps: 6,222  tflops: 47.39  mfu: 15.19%
[rank2]:2025-10-31 23:25:40,909 - INFO -  step: 300  loss: -2.0000  grad_norm:  0.5585  memory:  8.13GiB(17.12%)  tps: 6,222  tflops: 47.39  mfu: 15.19%
[rank3]:2025-10-31 23:25:41,244 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_Interleaved1F1B_nofreeze_dm1/pipeline_schedule/251031_2325_real_step300_rank3.svg
[rank3]:> Batch Time: 504.61 ms, GPU Bubble Ratio: 48.98%, 46.27%, 56.84%, 12.84%
[rank0]:2025-10-31 23:26:45,686 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-31 23:26:47,028 - INFO -  step: 350  loss: -2.0000  grad_norm:  0.4618  memory: 14.71GiB(30.97%)  tps: 6,196  tflops: 47.19  mfu: 15.13%
[rank3]:2025-10-31 23:26:47,026 - INFO -  step: 350  loss:  0.1810  grad_norm:  0.4618  memory: 18.19GiB(38.28%)  tps: 6,196  tflops: 47.19  mfu: 15.13%
[rank2]:2025-10-31 23:26:47,014 - INFO -  step: 350  loss: -2.0000  grad_norm:  0.4618  memory:  8.13GiB(17.12%)  tps: 6,196  tflops: 47.19  mfu: 15.13%
[rank1]:2025-10-31 23:26:47,017 - INFO -  step: 350  loss: -2.0000  grad_norm:  0.4618  memory: 11.87GiB(24.98%)  tps: 6,196  tflops: 47.19  mfu: 15.13%
[rank0]:2025-10-31 23:27:51,451 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-31 23:27:52,469 - INFO - Avg. fwd time: 6.3452 / Avg. bwd time: 21.1276 / Avg. batch time: 547.1950 (ms) / GPU bubble ratio: 19.67%
[rank2]:2025-10-31 23:27:52,525 - INFO - Avg. fwd time: 3.8978 / Avg. bwd time: 9.7449 / Avg. batch time: 580.6783 (ms) / GPU bubble ratio: 62.41%
[rank0]:2025-10-31 23:27:52,546 - INFO - Avg. fwd time: 4.1413 / Avg. bwd time: 11.9846 / Avg. batch time: 632.7103 (ms) / GPU bubble ratio: 59.22%
[rank1]:2025-10-31 23:27:52,624 - INFO - Avg. fwd time: 4.7973 / Avg. bwd time: 12.1021 / Avg. batch time: 609.8119 (ms) / GPU bubble ratio: 55.66%
[rank0]:2025-10-31 23:27:52,801 - INFO -  step: 400  loss: -2.0000  grad_norm:  0.7817  memory: 14.71GiB(30.97%)  tps: 6,227  tflops: 47.43  mfu: 15.20%
[rank0]:2025-10-31 23:27:52,801 - INFO - ðŸ”Ž  Running validation at step 400
[rank3]:2025-10-31 23:27:52,799 - INFO -  step: 400  loss:  0.2197  grad_norm:  0.7817  memory: 18.19GiB(38.28%)  tps: 6,228  tflops: 47.43  mfu: 15.20%
[rank3]:2025-10-31 23:27:52,800 - INFO - ðŸ”Ž  Running validation at step 400
[rank1]:2025-10-31 23:27:52,790 - INFO -  step: 400  loss: -2.0000  grad_norm:  0.7817  memory: 11.87GiB(24.98%)  tps: 6,228  tflops: 47.43  mfu: 15.20%
[rank1]:2025-10-31 23:27:52,791 - INFO - ðŸ”Ž  Running validation at step 400
[rank2]:2025-10-31 23:27:52,787 - INFO -  step: 400  loss: -2.0000  grad_norm:  0.7817  memory:  8.13GiB(17.12%)  tps: 6,227  tflops: 47.43  mfu: 15.20%
[rank2]:2025-10-31 23:27:52,787 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-10-31 23:28:17,942 - INFO - validate step: 400  loss: -1.0000  memory: 14.71GiB(30.97%)  tps: 16,292
[rank3]:2025-10-31 23:28:17,961 - INFO - validate step: 400  loss:  0.9321  memory: 18.19GiB(38.28%)  tps: 16,280
[rank1]:2025-10-31 23:28:17,947 - INFO - validate step: 400  loss: -1.0000  memory: 11.87GiB(24.98%)  tps: 16,282
[rank2]:2025-10-31 23:28:17,961 - INFO - validate step: 400  loss: -1.0000  memory:  8.13GiB(17.12%)  tps: 16,271
[rank3]:2025-10-31 23:28:18,293 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_Interleaved1F1B_nofreeze_dm1/pipeline_schedule/251031_2328_real_step400_rank3.svg
[rank3]:> Batch Time: 502.67 ms, GPU Bubble Ratio: 48.79%, 46.06%, 56.77%, 13.01%
[rank0]:2025-10-31 23:29:22,516 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-31 23:29:23,849 - INFO -  step: 450  loss:  0.2229  grad_norm:  0.6046  memory: 18.19GiB(38.28%)  tps: 6,217  tflops: 47.35  mfu: 15.18%
[rank1]:2025-10-31 23:29:23,840 - INFO -  step: 450  loss: -2.0000  grad_norm:  0.6046  memory: 11.87GiB(24.98%)  tps: 6,216  tflops: 47.34  mfu: 15.17%
[rank2]:2025-10-31 23:29:23,837 - INFO -  step: 450  loss: -2.0000  grad_norm:  0.6046  memory:  8.13GiB(17.12%)  tps: 6,218  tflops: 47.36  mfu: 15.18%
[rank0]:2025-10-31 23:29:23,851 - INFO -  step: 450  loss: -2.0000  grad_norm:  0.6046  memory: 14.71GiB(30.97%)  tps: 6,215  tflops: 47.33  mfu: 15.17%
[rank0]:2025-10-31 23:30:28,243 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-31 23:30:29,249 - INFO - Avg. fwd time: 6.3385 / Avg. bwd time: 21.1155 / Avg. batch time: 546.7557 (ms) / GPU bubble ratio: 19.66%
[rank0]:2025-10-31 23:30:29,324 - INFO - Avg. fwd time: 4.1310 / Avg. bwd time: 11.9864 / Avg. batch time: 632.4065 (ms) / GPU bubble ratio: 59.22%
[rank2]:2025-10-31 23:30:29,304 - INFO - Avg. fwd time: 3.8869 / Avg. bwd time: 9.7467 / Avg. batch time: 580.3566 (ms) / GPU bubble ratio: 62.41%
[rank1]:2025-10-31 23:30:29,401 - INFO - Avg. fwd time: 4.7968 / Avg. bwd time: 12.1078 / Avg. batch time: 609.5024 (ms) / GPU bubble ratio: 55.62%
[rank1]:2025-10-31 23:30:29,562 - INFO -  step: 500  loss: -2.0000  grad_norm:  0.5828  memory: 11.87GiB(24.98%)  tps: 6,232  tflops: 47.47  mfu: 15.21%
[rank2]:2025-10-31 23:30:29,558 - INFO -  step: 500  loss: -2.0000  grad_norm:  0.5828  memory:  8.13GiB(17.12%)  tps: 6,232  tflops: 47.47  mfu: 15.21%
[rank0]:2025-10-31 23:30:29,573 - INFO -  step: 500  loss: -2.0000  grad_norm:  0.5828  memory: 14.71GiB(30.97%)  tps: 6,232  tflops: 47.47  mfu: 15.21%
[rank3]:2025-10-31 23:30:29,571 - INFO -  step: 500  loss:  0.2552  grad_norm:  0.5828  memory: 18.19GiB(38.28%)  tps: 6,233  tflops: 47.47  mfu: 15.21%
[rank3]:2025-10-31 23:30:29,891 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_Interleaved1F1B_nofreeze_dm1/pipeline_schedule/251031_2330_real_step500_rank3.svg
[rank3]:> Batch Time: 503.43 ms, GPU Bubble Ratio: 48.90%, 46.09%, 56.80%, 12.87%
[rank0]:2025-10-31 23:31:34,418 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-31 23:31:35,756 - INFO -  step: 550  loss: -2.0000  grad_norm:  0.5956  memory:  8.13GiB(17.12%)  tps: 6,188  tflops: 47.13  mfu: 15.10%
[rank0]:2025-10-31 23:31:35,771 - INFO -  step: 550  loss: -2.0000  grad_norm:  0.5956  memory: 14.71GiB(30.97%)  tps: 6,188  tflops: 47.13  mfu: 15.10%
[rank3]:2025-10-31 23:31:35,769 - INFO -  step: 550  loss:  0.2527  grad_norm:  0.5956  memory: 18.19GiB(38.28%)  tps: 6,188  tflops: 47.13  mfu: 15.10%
[rank1]:2025-10-31 23:31:35,760 - INFO -  step: 550  loss: -2.0000  grad_norm:  0.5956  memory: 11.87GiB(24.98%)  tps: 6,188  tflops: 47.13  mfu: 15.10%
[rank0]:2025-10-31 23:32:40,344 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-31 23:32:41,600 - INFO - Avg. fwd time: 6.3407 / Avg. bwd time: 21.1286 / Avg. batch time: 546.9007 (ms) / GPU bubble ratio: 19.64%
[rank2]:2025-10-31 23:32:41,625 - INFO - Avg. fwd time: 3.8810 / Avg. bwd time: 9.7503 / Avg. batch time: 580.4942 (ms) / GPU bubble ratio: 62.43%
[rank0]:2025-10-31 23:32:41,673 - INFO - Avg. fwd time: 4.1240 / Avg. bwd time: 11.9894 / Avg. batch time: 632.5637 (ms) / GPU bubble ratio: 59.24%
[rank1]:2025-10-31 23:32:41,649 - INFO - Avg. fwd time: 4.7967 / Avg. bwd time: 12.1146 / Avg. batch time: 609.6608 (ms) / GPU bubble ratio: 55.62%
[rank1]:2025-10-31 23:32:41,697 - INFO -  step: 600  loss: -2.0000  grad_norm:  0.7904  memory: 11.87GiB(24.98%)  tps: 6,212  tflops: 47.31  mfu: 15.16%
[rank1]:2025-10-31 23:32:41,698 - INFO - ðŸ”Ž  Running validation at step 600
[rank3]:2025-10-31 23:32:41,706 - INFO -  step: 600  loss:  0.2171  grad_norm:  0.7904  memory: 18.19GiB(38.28%)  tps: 6,212  tflops: 47.31  mfu: 15.16%
[rank3]:2025-10-31 23:32:41,707 - INFO - ðŸ”Ž  Running validation at step 600
[rank2]:2025-10-31 23:32:41,694 - INFO -  step: 600  loss: -2.0000  grad_norm:  0.7904  memory:  8.13GiB(17.12%)  tps: 6,212  tflops: 47.31  mfu: 15.16%
[rank2]:2025-10-31 23:32:41,694 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-10-31 23:32:41,708 - INFO -  step: 600  loss: -2.0000  grad_norm:  0.7904  memory: 14.71GiB(30.97%)  tps: 6,212  tflops: 47.31  mfu: 15.16%
[rank0]:2025-10-31 23:32:41,708 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-10-31 23:33:06,969 - INFO - validate step: 600  loss: -1.0000  memory: 14.71GiB(30.97%)  tps: 16,215
[rank1]:2025-10-31 23:33:06,976 - INFO - validate step: 600  loss: -1.0000  memory: 11.87GiB(24.98%)  tps: 16,204
[rank3]:2025-10-31 23:33:06,989 - INFO - validate step: 600  loss:  0.9307  memory: 18.19GiB(38.28%)  tps: 16,202
[rank2]:2025-10-31 23:33:06,989 - INFO - validate step: 600  loss: -1.0000  memory:  8.13GiB(17.12%)  tps: 16,193
[rank3]:2025-10-31 23:33:07,303 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_Interleaved1F1B_nofreeze_dm1/pipeline_schedule/251031_2333_real_step600_rank3.svg
[rank3]:> Batch Time: 503.48 ms, GPU Bubble Ratio: 48.86%, 46.05%, 56.74%, 12.88%
[rank0]:2025-10-31 23:34:11,809 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-31 23:34:13,149 - INFO -  step: 650  loss: -2.0000  grad_norm:  0.7039  memory:  8.13GiB(17.12%)  tps: 6,191  tflops: 47.15  mfu: 15.11%
[rank0]:2025-10-31 23:34:13,164 - INFO -  step: 650  loss: -2.0000  grad_norm:  0.7039  memory: 14.71GiB(30.97%)  tps: 6,188  tflops: 47.13  mfu: 15.11%
[rank1]:2025-10-31 23:34:13,153 - INFO -  step: 650  loss: -2.0000  grad_norm:  0.7039  memory: 11.87GiB(24.98%)  tps: 6,189  tflops: 47.14  mfu: 15.11%
[rank3]:2025-10-31 23:34:13,162 - INFO -  step: 650  loss:  0.3560  grad_norm:  0.7039  memory: 18.19GiB(38.28%)  tps: 6,190  tflops: 47.14  mfu: 15.11%
[rank0]:2025-10-31 23:35:17,635 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-31 23:35:18,646 - INFO - Avg. fwd time: 6.3420 / Avg. bwd time: 21.1358 / Avg. batch time: 546.9772 (ms) / GPU bubble ratio: 19.62%
[rank2]:2025-10-31 23:35:18,703 - INFO - Avg. fwd time: 3.8775 / Avg. bwd time: 9.7529 / Avg. batch time: 580.5823 (ms) / GPU bubble ratio: 62.44%
[rank0]:2025-10-31 23:35:18,722 - INFO - Avg. fwd time: 4.1203 / Avg. bwd time: 11.9917 / Avg. batch time: 632.6590 (ms) / GPU bubble ratio: 59.25%
[rank1]:2025-10-31 23:35:18,796 - INFO - Avg. fwd time: 4.7969 / Avg. bwd time: 12.1193 / Avg. batch time: 609.7566 (ms) / GPU bubble ratio: 55.61%
[rank0]:2025-10-31 23:35:18,968 - INFO -  step: 700  loss: -2.0000  grad_norm:  0.9253  memory: 14.71GiB(30.97%)  tps: 6,224  tflops: 47.41  mfu: 15.19%
[rank1]:2025-10-31 23:35:18,958 - INFO -  step: 700  loss: -2.0000  grad_norm:  0.9253  memory: 11.87GiB(24.98%)  tps: 6,224  tflops: 47.41  mfu: 15.19%
[rank3]:2025-10-31 23:35:18,966 - INFO -  step: 700  loss:  0.2310  grad_norm:  0.9253  memory: 18.19GiB(38.28%)  tps: 6,225  tflops: 47.41  mfu: 15.20%
[rank2]:2025-10-31 23:35:18,954 - INFO -  step: 700  loss: -2.0000  grad_norm:  0.9253  memory:  8.13GiB(17.12%)  tps: 6,224  tflops: 47.41  mfu: 15.19%
[rank3]:2025-10-31 23:35:19,280 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_Interleaved1F1B_nofreeze_dm1/pipeline_schedule/251031_2335_real_step700_rank3.svg
[rank3]:> Batch Time: 503.47 ms, GPU Bubble Ratio: 48.84%, 46.10%, 56.76%, 12.87%
[rank0]:2025-10-31 23:36:23,799 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-31 23:36:25,152 - INFO -  step: 750  loss: -2.0000  grad_norm:  0.4447  memory: 14.71GiB(30.97%)  tps: 6,189  tflops: 47.14  mfu: 15.11%
[rank1]:2025-10-31 23:36:25,141 - INFO -  step: 750  loss: -2.0000  grad_norm:  0.4447  memory: 11.87GiB(24.98%)  tps: 6,189  tflops: 47.14  mfu: 15.11%
[rank3]:2025-10-31 23:36:25,150 - INFO -  step: 750  loss:  0.2226  grad_norm:  0.4447  memory: 18.19GiB(38.28%)  tps: 6,189  tflops: 47.14  mfu: 15.11%
[rank2]:2025-10-31 23:36:25,138 - INFO -  step: 750  loss: -2.0000  grad_norm:  0.4447  memory:  8.13GiB(17.12%)  tps: 6,189  tflops: 47.14  mfu: 15.11%
[rank0]:2025-10-31 23:37:29,715 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-31 23:37:30,793 - INFO - Avg. fwd time: 3.8740 / Avg. bwd time: 9.7540 / Avg. batch time: 580.6450 (ms) / GPU bubble ratio: 62.45%
[rank3]:2025-10-31 23:37:30,737 - INFO - Avg. fwd time: 6.3425 / Avg. bwd time: 21.1436 / Avg. batch time: 547.0497 (ms) / GPU bubble ratio: 19.61%
[rank0]:2025-10-31 23:37:30,813 - INFO - Avg. fwd time: 4.1164 / Avg. bwd time: 11.9929 / Avg. batch time: 632.7218 (ms) / GPU bubble ratio: 59.26%
[rank1]:2025-10-31 23:37:30,889 - INFO - Avg. fwd time: 4.7967 / Avg. bwd time: 12.1222 / Avg. batch time: 609.8242 (ms) / GPU bubble ratio: 55.61%
[rank0]:2025-10-31 23:37:31,064 - INFO -  step: 800  loss: -2.0000  grad_norm:  0.7462  memory: 14.71GiB(30.97%)  tps: 6,214  tflops: 47.33  mfu: 15.17%
[rank0]:2025-10-31 23:37:31,064 - INFO - ðŸ”Ž  Running validation at step 800
[rank2]:2025-10-31 23:37:31,050 - INFO -  step: 800  loss: -2.0000  grad_norm:  0.7462  memory:  8.13GiB(17.12%)  tps: 6,214  tflops: 47.33  mfu: 15.17%
[rank2]:2025-10-31 23:37:31,050 - INFO - ðŸ”Ž  Running validation at step 800
[rank1]:2025-10-31 23:37:31,054 - INFO -  step: 800  loss: -2.0000  grad_norm:  0.7462  memory: 11.87GiB(24.98%)  tps: 6,214  tflops: 47.33  mfu: 15.17%
[rank1]:2025-10-31 23:37:31,054 - INFO - ðŸ”Ž  Running validation at step 800
[rank3]:2025-10-31 23:37:31,062 - INFO -  step: 800  loss:  0.2609  grad_norm:  0.7462  memory: 18.19GiB(38.28%)  tps: 6,214  tflops: 47.33  mfu: 15.17%
[rank3]:2025-10-31 23:37:31,063 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-10-31 23:37:56,239 - INFO - validate step: 800  loss: -1.0000  memory: 14.71GiB(30.97%)  tps: 16,271
[rank0]:2025-10-31 23:37:56,240 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-31 23:37:56,246 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank2]:2025-10-31 23:37:56,260 - INFO - validate step: 800  loss: -1.0000  memory:  8.13GiB(17.12%)  tps: 16,248
[rank2]:2025-10-31 23:37:56,260 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-31 23:37:56,243 - INFO - validate step: 800  loss: -1.0000  memory: 11.87GiB(24.98%)  tps: 16,261
[rank1]:2025-10-31 23:37:56,244 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-31 23:37:56,257 - INFO - validate step: 800  loss:  0.9330  memory: 18.19GiB(38.28%)  tps: 16,258
[rank3]:2025-10-31 23:37:56,258 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-31 23:37:58,127 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 1.87 seconds.
[rank1]:2025-10-31 23:37:58,580 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 2.34 seconds.
[rank3]:2025-10-31 23:37:59,677 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.42 seconds.
[rank0]:2025-10-31 23:37:59,933 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-31 23:37:59,940 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.70 seconds.
[rank3]:2025-10-31 23:38:00,406 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_Interleaved1F1B_nofreeze_dm1/pipeline_schedule/251031_2337_real_step800_rank3.svg
[rank3]:> Batch Time: 505.59 ms, GPU Bubble Ratio: 49.09%, 46.43%, 56.96%, 12.84%
[rank3]:2025-10-31 23:38:13,962 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-31 23:38:14,249 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-31 23:38:14,231 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-31 23:38:14,215 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-31 23:39:05,067 - INFO - [GC] Peforming periodical GC collection 0.26 seconds
[rank0]:2025-10-31 23:39:06,391 - INFO -  step: 850  loss: -2.0000  grad_norm:  0.6873  memory: 14.71GiB(30.97%)  tps: 5,839  tflops: 44.47  mfu: 14.25%
[rank1]:2025-10-31 23:39:06,380 - INFO -  step: 850  loss: -2.0000  grad_norm:  0.6873  memory: 11.87GiB(24.98%)  tps: 5,840  tflops: 44.48  mfu: 14.26%
[rank2]:2025-10-31 23:39:06,377 - INFO -  step: 850  loss: -2.0000  grad_norm:  0.6873  memory:  8.13GiB(17.12%)  tps: 5,842  tflops: 44.49  mfu: 14.26%
[rank3]:2025-10-31 23:39:06,389 - INFO -  step: 850  loss:  0.2034  grad_norm:  0.6873  memory: 18.19GiB(38.28%)  tps: 5,841  tflops: 44.48  mfu: 14.26%
[rank0]:2025-10-31 23:40:10,947 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-31 23:40:12,207 - INFO - Avg. fwd time: 3.8715 / Avg. bwd time: 9.7560 / Avg. batch time: 580.6908 (ms) / GPU bubble ratio: 62.45%
[rank3]:2025-10-31 23:40:12,181 - INFO - Avg. fwd time: 6.3411 / Avg. bwd time: 21.1439 / Avg. batch time: 547.0093 (ms) / GPU bubble ratio: 19.61%
[rank0]:2025-10-31 23:40:12,257 - INFO - Avg. fwd time: 4.1141 / Avg. bwd time: 11.9938 / Avg. batch time: 632.7856 (ms) / GPU bubble ratio: 59.27%
[rank0]:2025-10-31 23:40:12,293 - INFO -  step: 900  loss: -2.0000  grad_norm:  0.4496  memory: 14.71GiB(30.97%)  tps: 6,215  tflops: 47.34  mfu: 15.17%
[rank2]:2025-10-31 23:40:12,279 - INFO -  step: 900  loss: -2.0000  grad_norm:  0.4496  memory:  8.13GiB(17.12%)  tps: 6,215  tflops: 47.34  mfu: 15.17%
[rank1]:2025-10-31 23:40:12,232 - INFO - Avg. fwd time: 4.7967 / Avg. bwd time: 12.1248 / Avg. batch time: 609.8765 (ms) / GPU bubble ratio: 55.61%
[rank1]:2025-10-31 23:40:12,282 - INFO -  step: 900  loss: -2.0000  grad_norm:  0.4496  memory: 11.87GiB(24.98%)  tps: 6,215  tflops: 47.34  mfu: 15.17%
[rank3]:2025-10-31 23:40:12,291 - INFO -  step: 900  loss:  0.2182  grad_norm:  0.4496  memory: 18.19GiB(38.28%)  tps: 6,215  tflops: 47.34  mfu: 15.17%
[rank3]:2025-10-31 23:40:12,612 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_Interleaved1F1B_nofreeze_dm1/pipeline_schedule/251031_2340_real_step900_rank3.svg
[rank3]:> Batch Time: 501.66 ms, GPU Bubble Ratio: 48.66%, 45.92%, 56.63%, 12.96%
[rank0]:2025-10-31 23:41:17,065 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-31 23:41:18,394 - INFO -  step: 950  loss: -2.0000  grad_norm:  0.4668  memory: 14.71GiB(30.97%)  tps: 6,197  tflops: 47.19  mfu: 15.13%
[rank2]:2025-10-31 23:41:18,380 - INFO -  step: 950  loss: -2.0000  grad_norm:  0.4668  memory:  8.13GiB(17.12%)  tps: 6,197  tflops: 47.19  mfu: 15.13%
[rank3]:2025-10-31 23:41:18,392 - INFO -  step: 950  loss:  0.1878  grad_norm:  0.4668  memory: 18.19GiB(38.28%)  tps: 6,197  tflops: 47.20  mfu: 15.13%
[rank1]:2025-10-31 23:41:18,383 - INFO -  step: 950  loss: -2.0000  grad_norm:  0.4668  memory: 11.87GiB(24.98%)  tps: 6,197  tflops: 47.19  mfu: 15.13%
[rank0]:2025-10-31 23:42:22,661 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-31 23:42:23,771 - INFO - Avg. fwd time: 4.1126 / Avg. bwd time: 11.9959 / Avg. batch time: 632.6633 (ms) / GPU bubble ratio: 59.26%
[rank2]:2025-10-31 23:42:23,751 - INFO - Avg. fwd time: 3.8698 / Avg. bwd time: 9.7573 / Avg. batch time: 580.5594 (ms) / GPU bubble ratio: 62.44%
[rank3]:2025-10-31 23:42:23,694 - INFO - Avg. fwd time: 6.3369 / Avg. bwd time: 21.1386 / Avg. batch time: 546.8351 (ms) / GPU bubble ratio: 19.61%
[rank1]:2025-10-31 23:42:23,847 - INFO - Avg. fwd time: 4.7981 / Avg. bwd time: 12.1287 / Avg. batch time: 609.7506 (ms) / GPU bubble ratio: 55.58%
[rank0]:2025-10-31 23:42:24,016 - INFO -  step: 1000  loss: -2.0000  grad_norm:  0.7268  memory: 14.71GiB(30.97%)  tps: 6,242  tflops: 47.54  mfu: 15.24%
[rank0]:2025-10-31 23:42:24,017 - INFO - ðŸ”Ž  Running validation at step 1000
[rank1]:2025-10-31 23:42:24,006 - INFO -  step: 1000  loss: -2.0000  grad_norm:  0.7268  memory: 11.87GiB(24.98%)  tps: 6,242  tflops: 47.54  mfu: 15.24%
[rank1]:2025-10-31 23:42:24,006 - INFO - ðŸ”Ž  Running validation at step 1000
[rank2]:2025-10-31 23:42:24,002 - INFO -  step: 1000  loss: -2.0000  grad_norm:  0.7268  memory:  8.13GiB(17.12%)  tps: 6,242  tflops: 47.54  mfu: 15.24%
[rank2]:2025-10-31 23:42:24,002 - INFO - ðŸ”Ž  Running validation at step 1000
[rank3]:2025-10-31 23:42:24,014 - INFO -  step: 1000  loss:  0.2750  grad_norm:  0.7268  memory: 18.19GiB(38.28%)  tps: 6,242  tflops: 47.54  mfu: 15.24%
[rank3]:2025-10-31 23:42:24,015 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-10-31 23:42:49,168 - INFO - validate step: 1000  loss: -1.0000  memory: 14.71GiB(30.97%)  tps: 16,285
[rank1]:2025-10-31 23:42:49,176 - INFO - validate step: 1000  loss: -1.0000  memory: 11.87GiB(24.98%)  tps: 16,274
[rank2]:2025-10-31 23:42:49,188 - INFO - validate step: 1000  loss: -1.0000  memory:  8.13GiB(17.12%)  tps: 16,263
[rank3]:2025-10-31 23:42:49,188 - INFO - validate step: 1000  loss:  0.9470  memory: 18.19GiB(38.28%)  tps: 16,272
[rank3]:2025-10-31 23:42:49,506 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_Interleaved1F1B_nofreeze_dm1/pipeline_schedule/251031_2342_real_step1000_rank3.svg
[rank3]:> Batch Time: 501.21 ms, GPU Bubble Ratio: 48.59%, 45.79%, 56.57%, 13.01%
[rank0]:2025-10-31 23:43:53,965 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-31 23:43:55,294 - INFO -  step: 1050  loss: -2.0000  grad_norm:  0.6524  memory: 11.87GiB(24.98%)  tps: 6,195  tflops: 47.18  mfu: 15.12%
[rank2]:2025-10-31 23:43:55,291 - INFO -  step: 1050  loss: -2.0000  grad_norm:  0.6524  memory:  8.13GiB(17.12%)  tps: 6,196  tflops: 47.19  mfu: 15.13%
[rank0]:2025-10-31 23:43:55,305 - INFO -  step: 1050  loss: -2.0000  grad_norm:  0.6524  memory: 14.71GiB(30.97%)  tps: 6,193  tflops: 47.17  mfu: 15.12%
[rank3]:2025-10-31 23:43:55,303 - INFO -  step: 1050  loss:  0.2824  grad_norm:  0.6524  memory: 18.19GiB(38.28%)  tps: 6,195  tflops: 47.19  mfu: 15.12%
[rank0]:2025-10-31 23:44:59,777 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-31 23:45:00,786 - INFO - Avg. fwd time: 6.3363 / Avg. bwd time: 21.1372 / Avg. batch time: 546.7820 (ms) / GPU bubble ratio: 19.61%
[rank2]:2025-10-31 23:45:00,840 - INFO - Avg. fwd time: 3.8680 / Avg. bwd time: 9.7578 / Avg. batch time: 580.5182 (ms) / GPU bubble ratio: 62.45%
[rank0]:2025-10-31 23:45:00,861 - INFO - Avg. fwd time: 4.1106 / Avg. bwd time: 11.9962 / Avg. batch time: 632.6175 (ms) / GPU bubble ratio: 59.26%
[rank1]:2025-10-31 23:45:00,937 - INFO - Avg. fwd time: 4.7984 / Avg. bwd time: 12.1301 / Avg. batch time: 609.7076 (ms) / GPU bubble ratio: 55.58%
[rank2]:2025-10-31 23:45:01,089 - INFO -  step: 1100  loss: -2.0000  grad_norm:  0.5680  memory:  8.13GiB(17.12%)  tps: 6,225  tflops: 47.41  mfu: 15.20%
[rank3]:2025-10-31 23:45:01,101 - INFO -  step: 1100  loss:  0.2924  grad_norm:  0.5680  memory: 18.19GiB(38.28%)  tps: 6,225  tflops: 47.41  mfu: 15.20%
[rank1]:2025-10-31 23:45:01,093 - INFO -  step: 1100  loss: -2.0000  grad_norm:  0.5680  memory: 11.87GiB(24.98%)  tps: 6,225  tflops: 47.41  mfu: 15.20%
[rank0]:2025-10-31 23:45:01,104 - INFO -  step: 1100  loss: -2.0000  grad_norm:  0.5680  memory: 14.71GiB(30.97%)  tps: 6,225  tflops: 47.41  mfu: 15.20%
[rank3]:2025-10-31 23:45:01,418 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_Interleaved1F1B_nofreeze_dm1/pipeline_schedule/251031_2345_real_step1100_rank3.svg
[rank3]:> Batch Time: 502.35 ms, GPU Bubble Ratio: 48.73%, 45.99%, 56.68%, 12.93%
[rank0]:2025-10-31 23:46:06,153 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-31 23:46:07,489 - INFO -  step: 1150  loss: -2.0000  grad_norm:  0.4713  memory:  8.13GiB(17.12%)  tps: 6,169  tflops: 46.98  mfu: 15.06%
[rank1]:2025-10-31 23:46:07,493 - INFO -  step: 1150  loss: -2.0000  grad_norm:  0.4713  memory: 11.87GiB(24.98%)  tps: 6,169  tflops: 46.98  mfu: 15.06%
[rank0]:2025-10-31 23:46:07,504 - INFO -  step: 1150  loss: -2.0000  grad_norm:  0.4713  memory: 14.71GiB(30.97%)  tps: 6,169  tflops: 46.98  mfu: 15.06%
[rank3]:2025-10-31 23:46:07,502 - INFO -  step: 1150  loss:  0.2215  grad_norm:  0.4713  memory: 18.19GiB(38.28%)  tps: 6,169  tflops: 46.98  mfu: 15.06%
[rank0]:2025-10-31 23:47:12,261 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-31 23:47:13,566 - INFO - Avg. fwd time: 3.8671 / Avg. bwd time: 9.7593 / Avg. batch time: 580.7460 (ms) / GPU bubble ratio: 62.46%
[rank3]:2025-10-31 23:47:13,541 - INFO - Avg. fwd time: 6.3407 / Avg. bwd time: 21.1511 / Avg. batch time: 547.0469 (ms) / GPU bubble ratio: 19.59%
[rank1]:2025-10-31 23:47:13,591 - INFO - Avg. fwd time: 4.7981 / Avg. bwd time: 12.1310 / Avg. batch time: 609.9347 (ms) / GPU bubble ratio: 55.59%
[rank1]:2025-10-31 23:47:13,642 - INFO -  step: 1200  loss: -2.0000  grad_norm:  0.7076  memory: 11.87GiB(24.98%)  tps: 6,192  tflops: 47.16  mfu: 15.12%
[rank1]:2025-10-31 23:47:13,642 - INFO - ðŸ”Ž  Running validation at step 1200
[rank0]:2025-10-31 23:47:13,617 - INFO - Avg. fwd time: 4.1094 / Avg. bwd time: 11.9973 / Avg. batch time: 632.8505 (ms) / GPU bubble ratio: 59.28%
[rank0]:2025-10-31 23:47:13,653 - INFO -  step: 1200  loss: -2.0000  grad_norm:  0.7076  memory: 14.71GiB(30.97%)  tps: 6,192  tflops: 47.16  mfu: 15.12%
[rank0]:2025-10-31 23:47:13,653 - INFO - ðŸ”Ž  Running validation at step 1200
[rank2]:2025-10-31 23:47:13,639 - INFO -  step: 1200  loss: -2.0000  grad_norm:  0.7076  memory:  8.13GiB(17.12%)  tps: 6,192  tflops: 47.16  mfu: 15.12%
[rank2]:2025-10-31 23:47:13,639 - INFO - ðŸ”Ž  Running validation at step 1200
[rank3]:2025-10-31 23:47:13,651 - INFO -  step: 1200  loss:  0.1710  grad_norm:  0.7076  memory: 18.19GiB(38.28%)  tps: 6,192  tflops: 47.16  mfu: 15.12%
[rank3]:2025-10-31 23:47:13,651 - INFO - ðŸ”Ž  Running validation at step 1200
[rank1]:2025-10-31 23:47:38,870 - INFO - validate step: 1200  loss: -1.0000  memory: 11.87GiB(24.98%)  tps: 16,236
[rank3]:2025-10-31 23:47:38,883 - INFO - validate step: 1200  loss:  0.9598  memory: 18.19GiB(38.28%)  tps: 16,234
[rank0]:2025-10-31 23:47:38,865 - INFO - validate step: 1200  loss: -1.0000  memory: 14.71GiB(30.97%)  tps: 16,247
[rank2]:2025-10-31 23:47:38,885 - INFO - validate step: 1200  loss: -1.0000  memory:  8.13GiB(17.12%)  tps: 16,224
[rank3]:2025-10-31 23:47:39,225 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_Interleaved1F1B_nofreeze_dm1/pipeline_schedule/251031_2347_real_step1200_rank3.svg
[rank3]:> Batch Time: 508.96 ms, GPU Bubble Ratio: 49.37%, 46.83%, 57.14%, 12.74%
[rank0]:2025-10-31 23:48:43,981 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-31 23:48:45,318 - INFO -  step: 1250  loss: -2.0000  grad_norm:  0.6848  memory:  8.13GiB(17.12%)  tps: 6,166  tflops: 46.96  mfu: 15.05%
[rank0]:2025-10-31 23:48:45,332 - INFO -  step: 1250  loss: -2.0000  grad_norm:  0.6848  memory: 14.71GiB(30.97%)  tps: 6,162  tflops: 46.93  mfu: 15.04%
[rank1]:2025-10-31 23:48:45,322 - INFO -  step: 1250  loss: -2.0000  grad_norm:  0.6848  memory: 11.87GiB(24.98%)  tps: 6,164  tflops: 46.95  mfu: 15.05%
[rank3]:2025-10-31 23:48:45,331 - INFO -  step: 1250  loss:  0.2776  grad_norm:  0.6848  memory: 18.19GiB(38.28%)  tps: 6,164  tflops: 46.95  mfu: 15.05%
[rank0]:2025-10-31 23:49:50,006 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-31 23:49:51,021 - INFO - Avg. fwd time: 6.3444 / Avg. bwd time: 21.1604 / Avg. batch time: 547.2378 (ms) / GPU bubble ratio: 19.58%
[rank0]:2025-10-31 23:49:51,097 - INFO - Avg. fwd time: 4.1084 / Avg. bwd time: 11.9982 / Avg. batch time: 633.0365 (ms) / GPU bubble ratio: 59.29%
[rank2]:2025-10-31 23:49:51,076 - INFO - Avg. fwd time: 3.8663 / Avg. bwd time: 9.7604 / Avg. batch time: 580.9349 (ms) / GPU bubble ratio: 62.47%
[rank1]:2025-10-31 23:49:51,171 - INFO - Avg. fwd time: 4.7977 / Avg. bwd time: 12.1317 / Avg. batch time: 610.1213 (ms) / GPU bubble ratio: 55.60%
[rank1]:2025-10-31 23:49:51,327 - INFO -  step: 1300  loss: -2.0000  grad_norm:  0.6044  memory: 11.87GiB(24.98%)  tps: 6,206  tflops: 47.26  mfu: 15.15%
[rank0]:2025-10-31 23:49:51,337 - INFO -  step: 1300  loss: -2.0000  grad_norm:  0.6044  memory: 14.71GiB(30.97%)  tps: 6,206  tflops: 47.26  mfu: 15.15%
[rank2]:2025-10-31 23:49:51,323 - INFO -  step: 1300  loss: -2.0000  grad_norm:  0.6044  memory:  8.13GiB(17.12%)  tps: 6,206  tflops: 47.26  mfu: 15.15%
[rank3]:2025-10-31 23:49:51,335 - INFO -  step: 1300  loss:  0.2461  grad_norm:  0.6044  memory: 18.19GiB(38.28%)  tps: 6,206  tflops: 47.26  mfu: 15.15%
[rank3]:2025-10-31 23:49:51,652 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_Interleaved1F1B_nofreeze_dm1/pipeline_schedule/251031_2349_real_step1300_rank3.svg
[rank3]:> Batch Time: 504.73 ms, GPU Bubble Ratio: 48.93%, 46.26%, 56.86%, 12.92%
[rank0]:2025-10-31 23:50:56,193 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-31 23:50:57,535 - INFO -  step: 1350  loss: -2.0000  grad_norm:  0.4584  memory: 11.87GiB(24.98%)  tps: 6,187  tflops: 47.12  mfu: 15.10%
[rank2]:2025-10-31 23:50:57,531 - INFO -  step: 1350  loss: -2.0000  grad_norm:  0.4584  memory:  8.13GiB(17.12%)  tps: 6,187  tflops: 47.12  mfu: 15.10%
[rank0]:2025-10-31 23:50:57,546 - INFO -  step: 1350  loss: -2.0000  grad_norm:  0.4584  memory: 14.71GiB(30.97%)  tps: 6,187  tflops: 47.12  mfu: 15.10%
[rank3]:2025-10-31 23:50:57,544 - INFO -  step: 1350  loss:  0.2349  grad_norm:  0.4584  memory: 18.19GiB(38.28%)  tps: 6,187  tflops: 47.12  mfu: 15.10%
[rank0]:2025-10-31 23:52:02,107 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-31 23:52:03,130 - INFO - Avg. fwd time: 6.3454 / Avg. bwd time: 21.1627 / Avg. batch time: 547.2757 (ms) / GPU bubble ratio: 19.58%
[rank0]:2025-10-31 23:52:03,206 - INFO - Avg. fwd time: 4.1070 / Avg. bwd time: 11.9988 / Avg. batch time: 633.0609 (ms) / GPU bubble ratio: 59.29%
[rank2]:2025-10-31 23:52:03,186 - INFO - Avg. fwd time: 3.8653 / Avg. bwd time: 9.7608 / Avg. batch time: 580.9646 (ms) / GPU bubble ratio: 62.47%
[rank1]:2025-10-31 23:52:03,287 - INFO - Avg. fwd time: 4.7976 / Avg. bwd time: 12.1320 / Avg. batch time: 610.1479 (ms) / GPU bubble ratio: 55.61%
[rank3]:2025-10-31 23:52:03,450 - INFO -  step: 1400  loss:  0.2089  grad_norm:  0.7512  memory: 18.19GiB(38.28%)  tps: 6,215  tflops: 47.34  mfu: 15.17%
[rank3]:2025-10-31 23:52:03,451 - INFO - ðŸ”Ž  Running validation at step 1400
[rank1]:2025-10-31 23:52:03,442 - INFO -  step: 1400  loss: -2.0000  grad_norm:  0.7512  memory: 11.87GiB(24.98%)  tps: 6,215  tflops: 47.33  mfu: 15.17%
[rank1]:2025-10-31 23:52:03,442 - INFO - ðŸ”Ž  Running validation at step 1400
[rank0]:2025-10-31 23:52:03,452 - INFO -  step: 1400  loss: -2.0000  grad_norm:  0.7512  memory: 14.71GiB(30.97%)  tps: 6,215  tflops: 47.33  mfu: 15.17%
[rank0]:2025-10-31 23:52:03,453 - INFO - ðŸ”Ž  Running validation at step 1400
[rank2]:2025-10-31 23:52:03,438 - INFO -  step: 1400  loss: -2.0000  grad_norm:  0.7512  memory:  8.13GiB(17.12%)  tps: 6,215  tflops: 47.33  mfu: 15.17%
[rank2]:2025-10-31 23:52:03,438 - INFO - ðŸ”Ž  Running validation at step 1400
[rank3]:2025-10-31 23:52:28,782 - INFO - validate step: 1400  loss:  0.9612  memory: 18.19GiB(38.28%)  tps: 16,170
[rank1]:2025-10-31 23:52:28,768 - INFO - validate step: 1400  loss: -1.0000  memory: 11.87GiB(24.98%)  tps: 16,173
[rank0]:2025-10-31 23:52:28,765 - INFO - validate step: 1400  loss: -1.0000  memory: 14.71GiB(30.97%)  tps: 16,182
[rank2]:2025-10-31 23:52:28,784 - INFO - validate step: 1400  loss: -1.0000  memory:  8.13GiB(17.12%)  tps: 16,161
[rank3]:2025-10-31 23:52:29,101 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_Interleaved1F1B_nofreeze_dm1/pipeline_schedule/251031_2352_real_step1400_rank3.svg
[rank3]:> Batch Time: 502.75 ms, GPU Bubble Ratio: 48.78%, 46.10%, 56.73%, 13.05%
[rank0]:2025-10-31 23:53:33,420 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-31 23:53:34,737 - INFO -  step: 1450  loss: -2.0000  grad_norm:  0.6832  memory: 11.87GiB(24.98%)  tps: 6,209  tflops: 47.29  mfu: 15.16%
[rank0]:2025-10-31 23:53:34,747 - INFO -  step: 1450  loss: -2.0000  grad_norm:  0.6832  memory: 14.71GiB(30.97%)  tps: 6,208  tflops: 47.28  mfu: 15.15%
[rank2]:2025-10-31 23:53:34,733 - INFO -  step: 1450  loss: -2.0000  grad_norm:  0.6832  memory:  8.13GiB(17.12%)  tps: 6,211  tflops: 47.30  mfu: 15.16%
[rank3]:2025-10-31 23:53:34,745 - INFO -  step: 1450  loss:  0.2171  grad_norm:  0.6832  memory: 18.19GiB(38.28%)  tps: 6,210  tflops: 47.29  mfu: 15.16%
[rank0]:2025-10-31 23:54:39,416 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-31 23:54:40,664 - INFO - Avg. fwd time: 6.3456 / Avg. bwd time: 21.1621 / Avg. batch time: 547.2569 (ms) / GPU bubble ratio: 19.58%
[rank1]:2025-10-31 23:54:40,718 - INFO - Avg. fwd time: 4.7976 / Avg. bwd time: 12.1323 / Avg. batch time: 610.1236 (ms) / GPU bubble ratio: 55.60%
[rank2]:2025-10-31 23:54:40,691 - INFO - Avg. fwd time: 3.8643 / Avg. bwd time: 9.7610 / Avg. batch time: 580.9414 (ms) / GPU bubble ratio: 62.47%
[rank1]:2025-10-31 23:54:40,770 - INFO -  step: 1500  loss: -2.0000  grad_norm:  0.5773  memory: 11.87GiB(24.98%)  tps: 6,203  tflops: 47.24  mfu: 15.14%
[rank0]:2025-10-31 23:54:40,745 - INFO - Avg. fwd time: 4.1058 / Avg. bwd time: 11.9990 / Avg. batch time: 633.0372 (ms) / GPU bubble ratio: 59.30%
[rank0]:2025-10-31 23:54:40,781 - INFO -  step: 1500  loss: -2.0000  grad_norm:  0.5773  memory: 14.71GiB(30.97%)  tps: 6,203  tflops: 47.24  mfu: 15.14%
[rank2]:2025-10-31 23:54:40,767 - INFO -  step: 1500  loss: -2.0000  grad_norm:  0.5773  memory:  8.13GiB(17.12%)  tps: 6,203  tflops: 47.24  mfu: 15.14%
[rank3]:2025-10-31 23:54:40,779 - INFO -  step: 1500  loss:  0.2536  grad_norm:  0.5773  memory: 18.19GiB(38.28%)  tps: 6,203  tflops: 47.24  mfu: 15.14%
[rank3]:2025-10-31 23:54:41,100 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_Interleaved1F1B_nofreeze_dm1/pipeline_schedule/251031_2354_real_step1500_rank3.svg
[rank3]:> Batch Time: 505.38 ms, GPU Bubble Ratio: 49.06%, 46.43%, 56.93%, 12.79%
[rank0]:2025-10-31 23:55:45,872 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-31 23:55:47,209 - INFO -  step: 1550  loss: -2.0000  grad_norm:  0.4538  memory: 11.87GiB(24.98%)  tps: 6,165  tflops: 46.95  mfu: 15.05%
[rank0]:2025-10-31 23:55:47,220 - INFO -  step: 1550  loss: -2.0000  grad_norm:  0.4538  memory: 14.71GiB(30.97%)  tps: 6,165  tflops: 46.95  mfu: 15.05%
[rank2]:2025-10-31 23:55:47,206 - INFO -  step: 1550  loss: -2.0000  grad_norm:  0.4538  memory:  8.13GiB(17.12%)  tps: 6,165  tflops: 46.95  mfu: 15.05%
[rank3]:2025-10-31 23:55:47,218 - INFO -  step: 1550  loss:  0.2061  grad_norm:  0.4538  memory: 18.19GiB(38.28%)  tps: 6,165  tflops: 46.96  mfu: 15.05%
[rank0]:2025-10-31 23:56:52,080 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-31 23:56:53,121 - INFO - Avg. fwd time: 6.3494 / Avg. bwd time: 21.1716 / Avg. batch time: 547.4566 (ms) / GPU bubble ratio: 19.57%
[rank0]:2025-10-31 23:56:53,198 - INFO - Avg. fwd time: 4.1052 / Avg. bwd time: 11.9997 / Avg. batch time: 633.2252 (ms) / GPU bubble ratio: 59.31%
[rank2]:2025-10-31 23:56:53,177 - INFO - Avg. fwd time: 3.8638 / Avg. bwd time: 9.7620 / Avg. batch time: 581.1337 (ms) / GPU bubble ratio: 62.48%
[rank1]:2025-10-31 23:56:53,279 - INFO - Avg. fwd time: 4.7976 / Avg. bwd time: 12.1334 / Avg. batch time: 610.3129 (ms) / GPU bubble ratio: 55.61%
[rank3]:2025-10-31 23:56:53,442 - INFO -  step: 1600  loss:  0.1739  grad_norm:  0.7289  memory: 18.19GiB(38.28%)  tps: 6,185  tflops: 47.11  mfu: 15.10%
[rank3]:2025-10-31 23:56:53,442 - INFO - ðŸ”Ž  Running validation at step 1600
[rank0]:2025-10-31 23:56:53,444 - INFO -  step: 1600  loss: -2.0000  grad_norm:  0.7289  memory: 14.71GiB(30.97%)  tps: 6,185  tflops: 47.11  mfu: 15.10%
[rank0]:2025-10-31 23:56:53,444 - INFO - ðŸ”Ž  Running validation at step 1600
[rank1]:2025-10-31 23:56:53,433 - INFO -  step: 1600  loss: -2.0000  grad_norm:  0.7289  memory: 11.87GiB(24.98%)  tps: 6,185  tflops: 47.11  mfu: 15.10%
[rank1]:2025-10-31 23:56:53,433 - INFO - ðŸ”Ž  Running validation at step 1600
[rank2]:2025-10-31 23:56:53,430 - INFO -  step: 1600  loss: -2.0000  grad_norm:  0.7289  memory:  8.13GiB(17.12%)  tps: 6,185  tflops: 47.11  mfu: 15.10%
[rank2]:2025-10-31 23:56:53,430 - INFO - ðŸ”Ž  Running validation at step 1600
[rank1]:2025-10-31 23:57:18,575 - INFO - validate step: 1600  loss: -1.0000  memory: 11.87GiB(24.98%)  tps: 16,292
[rank1]:2025-10-31 23:57:18,576 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-31 23:57:18,569 - INFO - validate step: 1600  loss: -1.0000  memory: 14.71GiB(30.97%)  tps: 16,303
[rank0]:2025-10-31 23:57:18,570 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-31 23:57:18,578 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank2]:2025-10-31 23:57:18,589 - INFO - validate step: 1600  loss: -1.0000  memory:  8.13GiB(17.12%)  tps: 16,280
[rank2]:2025-10-31 23:57:18,590 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-31 23:57:18,587 - INFO - validate step: 1600  loss:  0.9629  memory: 18.19GiB(38.28%)  tps: 16,290
[rank3]:2025-10-31 23:57:18,588 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-31 23:57:20,805 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 2.23 seconds.
[rank2]:2025-10-31 23:57:21,172 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 2.58 seconds.
[rank3]:2025-10-31 23:57:22,015 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.43 seconds.
[rank0]:2025-10-31 23:57:23,724 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-31 23:57:23,731 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 5.16 seconds.
[rank3]:2025-10-31 23:57:24,278 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_Interleaved1F1B_nofreeze_dm1/pipeline_schedule/251031_2357_real_step1600_rank3.svg
[rank3]:> Batch Time: 507.08 ms, GPU Bubble Ratio: 49.18%, 46.51%, 57.00%, 12.77%
[rank3]:2025-10-31 23:57:52,380 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-31 23:57:52,665 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-31 23:57:52,648 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-31 23:57:52,631 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-31 23:58:29,072 - INFO - [GC] Peforming periodical GC collection 0.26 seconds
[rank1]:2025-10-31 23:58:30,416 - INFO -  step: 1650  loss: -2.0000  grad_norm:  0.6244  memory: 11.87GiB(24.98%)  tps: 5,701  tflops: 43.42  mfu: 13.92%
[rank2]:2025-10-31 23:58:30,413 - INFO -  step: 1650  loss: -2.0000  grad_norm:  0.6244  memory:  8.13GiB(17.12%)  tps: 5,703  tflops: 43.43  mfu: 13.92%
[rank3]:2025-10-31 23:58:30,425 - INFO -  step: 1650  loss:  0.2604  grad_norm:  0.6244  memory: 18.19GiB(38.28%)  tps: 5,702  tflops: 43.43  mfu: 13.92%
[rank0]:2025-10-31 23:58:30,427 - INFO -  step: 1650  loss: -2.0000  grad_norm:  0.6244  memory: 14.71GiB(30.97%)  tps: 5,700  tflops: 43.41  mfu: 13.91%
[rank0]:2025-10-31 23:59:34,965 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-31 23:59:35,987 - INFO - Avg. fwd time: 6.3498 / Avg. bwd time: 21.1742 / Avg. batch time: 547.5024 (ms) / GPU bubble ratio: 19.56%
[rank0]:2025-10-31 23:59:36,065 - INFO - Avg. fwd time: 4.1039 / Avg. bwd time: 11.9996 / Avg. batch time: 633.3165 (ms) / GPU bubble ratio: 59.32%
[rank2]:2025-10-31 23:59:36,044 - INFO - Avg. fwd time: 3.8632 / Avg. bwd time: 9.7625 / Avg. batch time: 581.2288 (ms) / GPU bubble ratio: 62.49%
[rank1]:2025-10-31 23:59:36,141 - INFO - Avg. fwd time: 4.7976 / Avg. bwd time: 12.1338 / Avg. batch time: 610.4052 (ms) / GPU bubble ratio: 55.62%
[rank1]:2025-10-31 23:59:36,297 - INFO -  step: 1700  loss: -2.0000  grad_norm:  0.5543  memory: 11.87GiB(24.98%)  tps: 6,217  tflops: 47.35  mfu: 15.18%
[rank0]:2025-10-31 23:59:36,307 - INFO -  step: 1700  loss: -2.0000  grad_norm:  0.5543  memory: 14.71GiB(30.97%)  tps: 6,217  tflops: 47.35  mfu: 15.18%
[rank2]:2025-10-31 23:59:36,293 - INFO -  step: 1700  loss: -2.0000  grad_norm:  0.5543  memory:  8.13GiB(17.12%)  tps: 6,217  tflops: 47.35  mfu: 15.18%
[rank3]:2025-10-31 23:59:36,305 - INFO -  step: 1700  loss:  0.2222  grad_norm:  0.5543  memory: 18.19GiB(38.28%)  tps: 6,217  tflops: 47.35  mfu: 15.18%
[rank3]:2025-10-31 23:59:36,630 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_Interleaved1F1B_nofreeze_dm1/pipeline_schedule/251031_2359_real_step1700_rank3.svg
[rank3]:> Batch Time: 505.03 ms, GPU Bubble Ratio: 49.04%, 46.33%, 56.88%, 12.82%
[rank0]:2025-11-01 00:00:41,320 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-01 00:00:42,659 - INFO -  step: 1750  loss: -2.0000  grad_norm:  0.4386  memory:  8.13GiB(17.12%)  tps: 6,172  tflops: 47.01  mfu: 15.07%
[rank1]:2025-11-01 00:00:42,663 - INFO -  step: 1750  loss: -2.0000  grad_norm:  0.4386  memory: 11.87GiB(24.98%)  tps: 6,172  tflops: 47.01  mfu: 15.07%
[rank0]:2025-11-01 00:00:42,674 - INFO -  step: 1750  loss: -2.0000  grad_norm:  0.4386  memory: 14.71GiB(30.97%)  tps: 6,172  tflops: 47.01  mfu: 15.07%
[rank3]:2025-11-01 00:00:42,672 - INFO -  step: 1750  loss:  0.1831  grad_norm:  0.4386  memory: 18.19GiB(38.28%)  tps: 6,172  tflops: 47.01  mfu: 15.07%
[rank0]:2025-11-01 00:01:47,382 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-01 00:01:48,654 - INFO - Avg. fwd time: 6.3525 / Avg. bwd time: 21.1802 / Avg. batch time: 547.6274 (ms) / GPU bubble ratio: 19.56%
[rank2]:2025-11-01 00:01:48,678 - INFO - Avg. fwd time: 3.8625 / Avg. bwd time: 9.7628 / Avg. batch time: 581.3265 (ms) / GPU bubble ratio: 62.50%
[rank2]:2025-11-01 00:01:48,756 - INFO -  step: 1800  loss: -2.0000  grad_norm:  0.6957  memory:  8.13GiB(17.12%)  tps: 6,197  tflops: 47.20  mfu: 15.13%
[rank2]:2025-11-01 00:01:48,756 - INFO - ðŸ”Ž  Running validation at step 1800
[rank1]:2025-11-01 00:01:48,706 - INFO - Avg. fwd time: 4.7976 / Avg. bwd time: 12.1336 / Avg. batch time: 610.4998 (ms) / GPU bubble ratio: 55.63%
[rank1]:2025-11-01 00:01:48,759 - INFO -  step: 1800  loss: -2.0000  grad_norm:  0.6957  memory: 11.87GiB(24.98%)  tps: 6,197  tflops: 47.20  mfu: 15.13%
[rank1]:2025-11-01 00:01:48,759 - INFO - ðŸ”Ž  Running validation at step 1800
[rank0]:2025-11-01 00:01:48,734 - INFO - Avg. fwd time: 4.1032 / Avg. bwd time: 11.9997 / Avg. batch time: 633.4126 (ms) / GPU bubble ratio: 59.32%
[rank0]:2025-11-01 00:01:48,770 - INFO -  step: 1800  loss: -2.0000  grad_norm:  0.6957  memory: 14.71GiB(30.97%)  tps: 6,197  tflops: 47.20  mfu: 15.13%
[rank0]:2025-11-01 00:01:48,770 - INFO - ðŸ”Ž  Running validation at step 1800
[rank3]:2025-11-01 00:01:48,768 - INFO -  step: 1800  loss:  0.1599  grad_norm:  0.6957  memory: 18.19GiB(38.28%)  tps: 6,197  tflops: 47.20  mfu: 15.13%
[rank3]:2025-11-01 00:01:48,768 - INFO - ðŸ”Ž  Running validation at step 1800
[rank2]:2025-11-01 00:02:14,000 - INFO - validate step: 1800  loss: -1.0000  memory:  8.13GiB(17.12%)  tps: 16,226
[rank1]:2025-11-01 00:02:13,985 - INFO - validate step: 1800  loss: -1.0000  memory: 11.87GiB(24.98%)  tps: 16,238
[rank0]:2025-11-01 00:02:13,980 - INFO - validate step: 1800  loss: -1.0000  memory: 14.71GiB(30.97%)  tps: 16,248
[rank3]:2025-11-01 00:02:13,998 - INFO - validate step: 1800  loss:  0.9740  memory: 18.19GiB(38.28%)  tps: 16,235
[rank3]:2025-11-01 00:02:14,317 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_Interleaved1F1B_nofreeze_dm1/pipeline_schedule/251101_0002_real_step1800_rank3.svg
[rank3]:> Batch Time: 506.75 ms, GPU Bubble Ratio: 49.21%, 46.49%, 56.99%, 12.78%
[rank0]:2025-11-01 00:03:18,810 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-11-01 00:03:20,148 - INFO -  step: 1850  loss: -2.0000  grad_norm:  0.6731  memory: 11.87GiB(24.98%)  tps: 6,191  tflops: 47.15  mfu: 15.11%
[rank2]:2025-11-01 00:03:20,144 - INFO -  step: 1850  loss: -2.0000  grad_norm:  0.6731  memory:  8.13GiB(17.12%)  tps: 6,193  tflops: 47.16  mfu: 15.12%
[rank0]:2025-11-01 00:03:20,159 - INFO -  step: 1850  loss: -2.0000  grad_norm:  0.6731  memory: 14.71GiB(30.97%)  tps: 6,189  tflops: 47.14  mfu: 15.11%
[rank3]:2025-11-01 00:03:20,157 - INFO -  step: 1850  loss:  0.2553  grad_norm:  0.6731  memory: 18.19GiB(38.28%)  tps: 6,191  tflops: 47.15  mfu: 15.11%
[rank0]:2025-11-01 00:04:24,680 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-01 00:04:25,691 - INFO - Avg. fwd time: 6.3521 / Avg. bwd time: 21.1800 / Avg. batch time: 547.6121 (ms) / GPU bubble ratio: 19.56%
[rank2]:2025-11-01 00:04:25,745 - INFO - Avg. fwd time: 3.8620 / Avg. bwd time: 9.7631 / Avg. batch time: 581.3228 (ms) / GPU bubble ratio: 62.50%
[rank0]:2025-11-01 00:04:25,765 - INFO - Avg. fwd time: 4.1027 / Avg. bwd time: 11.9998 / Avg. batch time: 633.4038 (ms) / GPU bubble ratio: 59.32%
[rank1]:2025-11-01 00:04:25,844 - INFO - Avg. fwd time: 4.7979 / Avg. bwd time: 12.1337 / Avg. batch time: 610.4920 (ms) / GPU bubble ratio: 55.63%
[rank3]:2025-11-01 00:04:26,002 - INFO -  step: 1900  loss:  0.1712  grad_norm:  0.4486  memory: 18.19GiB(38.28%)  tps: 6,221  tflops: 47.38  mfu: 15.19%
[rank1]:2025-11-01 00:04:25,993 - INFO -  step: 1900  loss: -2.0000  grad_norm:  0.4486  memory: 11.87GiB(24.98%)  tps: 6,221  tflops: 47.38  mfu: 15.19%
[rank2]:2025-11-01 00:04:25,989 - INFO -  step: 1900  loss: -2.0000  grad_norm:  0.4486  memory:  8.13GiB(17.12%)  tps: 6,221  tflops: 47.38  mfu: 15.19%
[rank0]:2025-11-01 00:04:26,003 - INFO -  step: 1900  loss: -2.0000  grad_norm:  0.4486  memory: 14.71GiB(30.97%)  tps: 6,221  tflops: 47.38  mfu: 15.19%
[rank3]:2025-11-01 00:04:26,323 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_Interleaved1F1B_nofreeze_dm1/pipeline_schedule/251101_0004_real_step1900_rank3.svg
[rank3]:> Batch Time: 503.69 ms, GPU Bubble Ratio: 48.86%, 46.15%, 56.77%, 12.89%
[rank0]:2025-11-01 00:05:30,890 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-01 00:05:32,225 - INFO -  step: 1950  loss: -2.0000  grad_norm:  0.3841  memory: 11.87GiB(24.98%)  tps: 6,184  tflops: 47.10  mfu: 15.10%
[rank0]:2025-11-01 00:05:32,236 - INFO -  step: 1950  loss: -2.0000  grad_norm:  0.3841  memory: 14.71GiB(30.97%)  tps: 6,184  tflops: 47.10  mfu: 15.10%
[rank2]:2025-11-01 00:05:32,221 - INFO -  step: 1950  loss: -2.0000  grad_norm:  0.3841  memory:  8.13GiB(17.12%)  tps: 6,184  tflops: 47.10  mfu: 15.10%
[rank3]:2025-11-01 00:05:32,234 - INFO -  step: 1950  loss:  0.1562  grad_norm:  0.3841  memory: 18.19GiB(38.28%)  tps: 6,184  tflops: 47.10  mfu: 15.10%
[rank0]:2025-11-01 00:06:36,880 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-01 00:06:37,922 - INFO - Avg. fwd time: 6.3521 / Avg. bwd time: 21.1816 / Avg. batch time: 547.6320 (ms) / GPU bubble ratio: 19.56%
[rank2]:2025-11-01 00:06:37,978 - INFO - Avg. fwd time: 3.8617 / Avg. bwd time: 9.7638 / Avg. batch time: 581.3337 (ms) / GPU bubble ratio: 62.50%
[rank0]:2025-11-01 00:06:37,998 - INFO - Avg. fwd time: 4.1023 / Avg. bwd time: 12.0007 / Avg. batch time: 633.4128 (ms) / GPU bubble ratio: 59.32%
[rank1]:2025-11-01 00:06:38,078 - INFO - Avg. fwd time: 4.7985 / Avg. bwd time: 12.1349 / Avg. batch time: 610.5008 (ms) / GPU bubble ratio: 55.62%
[rank1]:2025-11-01 00:06:38,230 - INFO -  step: 2000  loss: -2.0000  grad_norm:  0.7395  memory: 11.87GiB(24.98%)  tps: 6,206  tflops: 47.26  mfu: 15.15%
[rank1]:2025-11-01 00:06:38,230 - INFO - ðŸ”Ž  Running validation at step 2000
[rank2]:2025-11-01 00:06:38,226 - INFO -  step: 2000  loss: -2.0000  grad_norm:  0.7395  memory:  8.13GiB(17.12%)  tps: 6,206  tflops: 47.26  mfu: 15.15%
[rank2]:2025-11-01 00:06:38,226 - INFO - ðŸ”Ž  Running validation at step 2000
[rank3]:2025-11-01 00:06:38,239 - INFO -  step: 2000  loss:  0.1927  grad_norm:  0.7395  memory: 18.19GiB(38.28%)  tps: 6,206  tflops: 47.26  mfu: 15.15%
[rank3]:2025-11-01 00:06:38,239 - INFO - ðŸ”Ž  Running validation at step 2000
[rank0]:2025-11-01 00:06:38,241 - INFO -  step: 2000  loss: -2.0000  grad_norm:  0.7395  memory: 14.71GiB(30.97%)  tps: 6,206  tflops: 47.26  mfu: 15.15%
[rank0]:2025-11-01 00:06:38,241 - INFO - ðŸ”Ž  Running validation at step 2000
[rank3]:2025-11-01 00:07:03,694 - INFO - validate step: 2000  loss:  0.9817  memory: 18.19GiB(38.28%)  tps: 16,092
[rank2]:2025-11-01 00:07:03,696 - INFO - validate step: 2000  loss: -1.0000  memory:  8.13GiB(17.12%)  tps: 16,082
[rank1]:2025-11-01 00:07:03,680 - INFO - validate step: 2000  loss: -1.0000  memory: 11.87GiB(24.98%)  tps: 16,094
[rank0]:2025-11-01 00:07:03,676 - INFO - validate step: 2000  loss: -1.0000  memory: 14.71GiB(30.97%)  tps: 16,104
[rank3]:2025-11-01 00:07:04,012 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_Interleaved1F1B_nofreeze_dm1/pipeline_schedule/251101_0007_real_step2000_rank3.svg
[rank3]:> Batch Time: 504.83 ms, GPU Bubble Ratio: 48.93%, 46.26%, 56.84%, 12.92%
[rank0]:2025-11-01 00:08:08,787 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-11-01 00:08:10,118 - INFO -  step: 2050  loss: -2.0000  grad_norm:  0.6326  memory:  8.13GiB(17.12%)  tps: 6,167  tflops: 46.97  mfu: 15.05%
[rank1]:2025-11-01 00:08:10,121 - INFO -  step: 2050  loss: -2.0000  grad_norm:  0.6326  memory: 11.87GiB(24.98%)  tps: 6,165  tflops: 46.95  mfu: 15.05%
[rank0]:2025-11-01 00:08:10,132 - INFO -  step: 2050  loss: -2.0000  grad_norm:  0.6326  memory: 14.71GiB(30.97%)  tps: 6,164  tflops: 46.94  mfu: 15.05%
[rank3]:2025-11-01 00:08:10,130 - INFO -  step: 2050  loss:  0.1751  grad_norm:  0.6326  memory: 18.19GiB(38.28%)  tps: 6,166  tflops: 46.96  mfu: 15.05%
[rank0]:2025-11-01 00:09:14,964 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-01 00:09:16,221 - INFO - Avg. fwd time: 6.3550 / Avg. bwd time: 21.1889 / Avg. batch time: 547.7861 (ms) / GPU bubble ratio: 19.55%
[rank2]:2025-11-01 00:09:16,249 - INFO - Avg. fwd time: 3.8615 / Avg. bwd time: 9.7643 / Avg. batch time: 581.4710 (ms) / GPU bubble ratio: 62.51%
[rank0]:2025-11-01 00:09:16,313 - INFO - Avg. fwd time: 4.1016 / Avg. bwd time: 12.0005 / Avg. batch time: 633.5507 (ms) / GPU bubble ratio: 59.33%
[rank1]:2025-11-01 00:09:16,284 - INFO - Avg. fwd time: 4.7985 / Avg. bwd time: 12.1349 / Avg. batch time: 610.6374 (ms) / GPU bubble ratio: 55.63%
[rank3]:2025-11-01 00:09:16,347 - INFO -  step: 2100  loss:  0.1996  grad_norm:  0.5787  memory: 18.19GiB(38.28%)  tps: 6,186  tflops: 47.11  mfu: 15.10%
[rank2]:2025-11-01 00:09:16,335 - INFO -  step: 2100  loss: -2.0000  grad_norm:  0.5787  memory:  8.13GiB(17.12%)  tps: 6,186  tflops: 47.11  mfu: 15.10%
[rank0]:2025-11-01 00:09:16,349 - INFO -  step: 2100  loss: -2.0000  grad_norm:  0.5787  memory: 14.71GiB(30.97%)  tps: 6,186  tflops: 47.11  mfu: 15.10%
[rank1]:2025-11-01 00:09:16,338 - INFO -  step: 2100  loss: -2.0000  grad_norm:  0.5787  memory: 11.87GiB(24.98%)  tps: 6,186  tflops: 47.11  mfu: 15.10%
[rank3]:2025-11-01 00:09:16,679 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_Interleaved1F1B_nofreeze_dm1/pipeline_schedule/251101_0009_real_step2100_rank3.svg
[rank3]:> Batch Time: 507.10 ms, GPU Bubble Ratio: 49.26%, 46.56%, 57.01%, 12.78%
[rank0]:2025-11-01 00:10:21,371 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-01 00:10:22,705 - INFO -  step: 2150  loss: -2.0000  grad_norm:  0.5334  memory: 11.87GiB(24.98%)  tps: 6,172  tflops: 47.01  mfu: 15.07%
[rank3]:2025-11-01 00:10:22,714 - INFO -  step: 2150  loss:  0.1780  grad_norm:  0.5334  memory: 18.19GiB(38.28%)  tps: 6,172  tflops: 47.01  mfu: 15.07%
[rank2]:2025-11-01 00:10:22,702 - INFO -  step: 2150  loss: -2.0000  grad_norm:  0.5334  memory:  8.13GiB(17.12%)  tps: 6,172  tflops: 47.01  mfu: 15.07%
[rank0]:2025-11-01 00:10:22,716 - INFO -  step: 2150  loss: -2.0000  grad_norm:  0.5334  memory: 14.71GiB(30.97%)  tps: 6,172  tflops: 47.01  mfu: 15.07%
[rank0]:2025-11-01 00:11:27,489 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-01 00:11:28,532 - INFO - Avg. fwd time: 6.3572 / Avg. bwd time: 21.1937 / Avg. batch time: 547.8889 (ms) / GPU bubble ratio: 19.54%
[rank2]:2025-11-01 00:11:28,589 - INFO - Avg. fwd time: 3.8611 / Avg. bwd time: 9.7647 / Avg. batch time: 581.5685 (ms) / GPU bubble ratio: 62.51%
[rank0]:2025-11-01 00:11:28,610 - INFO - Avg. fwd time: 4.1010 / Avg. bwd time: 12.0005 / Avg. batch time: 633.6415 (ms) / GPU bubble ratio: 59.34%
[rank1]:2025-11-01 00:11:28,686 - INFO - Avg. fwd time: 4.7984 / Avg. bwd time: 12.1343 / Avg. batch time: 610.7309 (ms) / GPU bubble ratio: 55.64%
[rank2]:2025-11-01 00:11:28,836 - INFO -  step: 2200  loss: -2.0000  grad_norm:  0.7336  memory:  8.13GiB(17.12%)  tps: 6,194  tflops: 47.17  mfu: 15.12%
[rank2]:2025-11-01 00:11:28,836 - INFO - ðŸ”Ž  Running validation at step 2200
[rank3]:2025-11-01 00:11:28,848 - INFO -  step: 2200  loss:  0.2026  grad_norm:  0.7336  memory: 18.19GiB(38.28%)  tps: 6,194  tflops: 47.17  mfu: 15.12%
[rank3]:2025-11-01 00:11:28,848 - INFO - ðŸ”Ž  Running validation at step 2200
[rank0]:2025-11-01 00:11:28,850 - INFO -  step: 2200  loss: -2.0000  grad_norm:  0.7336  memory: 14.71GiB(30.97%)  tps: 6,193  tflops: 47.17  mfu: 15.12%
[rank0]:2025-11-01 00:11:28,850 - INFO - ðŸ”Ž  Running validation at step 2200
[rank1]:2025-11-01 00:11:28,840 - INFO -  step: 2200  loss: -2.0000  grad_norm:  0.7336  memory: 11.87GiB(24.98%)  tps: 6,194  tflops: 47.17  mfu: 15.12%
[rank1]:2025-11-01 00:11:28,840 - INFO - ðŸ”Ž  Running validation at step 2200
[rank0]:2025-11-01 00:11:54,024 - INFO - validate step: 2200  loss: -1.0000  memory: 14.71GiB(30.97%)  tps: 16,271
[rank3]:2025-11-01 00:11:54,041 - INFO - validate step: 2200  loss:  0.9833  memory: 18.19GiB(38.28%)  tps: 16,259
[rank2]:2025-11-01 00:11:54,044 - INFO - validate step: 2200  loss: -1.0000  memory:  8.13GiB(17.12%)  tps: 16,249
[rank1]:2025-11-01 00:11:54,029 - INFO - validate step: 2200  loss: -1.0000  memory: 11.87GiB(24.98%)  tps: 16,261
[rank3]:2025-11-01 00:11:54,372 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_Interleaved1F1B_nofreeze_dm1/pipeline_schedule/251101_0011_real_step2200_rank3.svg
[rank3]:> Batch Time: 507.02 ms, GPU Bubble Ratio: 49.22%, 46.59%, 57.02%, 12.79%
[rank0]:2025-11-01 00:12:59,039 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-11-01 00:13:00,371 - INFO -  step: 2250  loss: -2.0000  grad_norm:  0.5881  memory:  8.13GiB(17.12%)  tps: 6,176  tflops: 47.03  mfu: 15.08%
[rank1]:2025-11-01 00:13:00,374 - INFO -  step: 2250  loss: -2.0000  grad_norm:  0.5881  memory: 11.87GiB(24.98%)  tps: 6,174  tflops: 47.02  mfu: 15.07%
[rank0]:2025-11-01 00:13:00,385 - INFO -  step: 2250  loss: -2.0000  grad_norm:  0.5881  memory: 14.71GiB(30.97%)  tps: 6,172  tflops: 47.01  mfu: 15.07%
[rank3]:2025-11-01 00:13:00,382 - INFO -  step: 2250  loss:  0.1933  grad_norm:  0.5881  memory: 18.19GiB(38.28%)  tps: 6,174  tflops: 47.02  mfu: 15.07%
[rank0]:2025-11-01 00:14:05,023 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-01 00:14:06,050 - INFO - Avg. fwd time: 6.3584 / Avg. bwd time: 21.1963 / Avg. batch time: 547.9437 (ms) / GPU bubble ratio: 19.54%
[rank2]:2025-11-01 00:14:06,107 - INFO - Avg. fwd time: 3.8608 / Avg. bwd time: 9.7650 / Avg. batch time: 581.6153 (ms) / GPU bubble ratio: 62.52%
[rank0]:2025-11-01 00:14:06,128 - INFO - Avg. fwd time: 4.1004 / Avg. bwd time: 12.0003 / Avg. batch time: 633.6831 (ms) / GPU bubble ratio: 59.35%
[rank1]:2025-11-01 00:14:06,203 - INFO - Avg. fwd time: 4.7984 / Avg. bwd time: 12.1339 / Avg. batch time: 610.7734 (ms) / GPU bubble ratio: 55.64%
[rank2]:2025-11-01 00:14:06,348 - INFO -  step: 2300  loss: -2.0000  grad_norm:  0.4937  memory:  8.13GiB(17.12%)  tps: 6,208  tflops: 47.28  mfu: 15.15%
[rank3]:2025-11-01 00:14:06,361 - INFO -  step: 2300  loss:  0.1867  grad_norm:  0.4937  memory: 18.19GiB(38.28%)  tps: 6,208  tflops: 47.28  mfu: 15.16%
[rank1]:2025-11-01 00:14:06,352 - INFO -  step: 2300  loss: -2.0000  grad_norm:  0.4937  memory: 11.87GiB(24.98%)  tps: 6,208  tflops: 47.28  mfu: 15.15%
[rank0]:2025-11-01 00:14:06,363 - INFO -  step: 2300  loss: -2.0000  grad_norm:  0.4937  memory: 14.71GiB(30.97%)  tps: 6,208  tflops: 47.28  mfu: 15.15%
[rank3]:2025-11-01 00:14:06,692 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_Interleaved1F1B_nofreeze_dm1/pipeline_schedule/251101_0014_real_step2300_rank3.svg
[rank3]:> Batch Time: 504.85 ms, GPU Bubble Ratio: 48.98%, 46.30%, 56.83%, 12.90%
[rank0]:2025-11-01 00:15:11,177 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-01 00:15:12,508 - INFO -  step: 2350  loss: -2.0000  grad_norm:  0.3950  memory:  8.13GiB(17.12%)  tps: 6,191  tflops: 47.15  mfu: 15.11%
[rank3]:2025-11-01 00:15:12,520 - INFO -  step: 2350  loss:  0.1759  grad_norm:  0.3950  memory: 18.19GiB(38.28%)  tps: 6,191  tflops: 47.15  mfu: 15.11%
[rank1]:2025-11-01 00:15:12,512 - INFO -  step: 2350  loss: -2.0000  grad_norm:  0.3950  memory: 11.87GiB(24.98%)  tps: 6,191  tflops: 47.15  mfu: 15.11%
[rank0]:2025-11-01 00:15:12,523 - INFO -  step: 2350  loss: -2.0000  grad_norm:  0.3950  memory: 14.71GiB(30.97%)  tps: 6,191  tflops: 47.15  mfu: 15.11%
[rank0]:2025-11-01 00:16:17,301 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-01 00:16:18,576 - INFO - Avg. fwd time: 6.3591 / Avg. bwd time: 21.1989 / Avg. batch time: 547.9916 (ms) / GPU bubble ratio: 19.54%
[rank2]:2025-11-01 00:16:18,602 - INFO - Avg. fwd time: 3.8607 / Avg. bwd time: 9.7657 / Avg. batch time: 581.6498 (ms) / GPU bubble ratio: 62.52%
[rank1]:2025-11-01 00:16:18,633 - INFO - Avg. fwd time: 4.7989 / Avg. bwd time: 12.1346 / Avg. batch time: 610.8069 (ms) / GPU bubble ratio: 55.64%
[rank3]:2025-11-01 00:16:18,697 - INFO -  step: 2400  loss:  0.1965  grad_norm:  0.7029  memory: 18.19GiB(38.28%)  tps: 6,190  tflops: 47.14  mfu: 15.11%
[rank3]:2025-11-01 00:16:18,697 - INFO -  final step: 2400  loss:  0.1965  grad_norm:  0.7029  tps: 6,288  tflops: 47.89  mfu: 14.82%
[rank3]:2025-11-01 00:16:18,698 - INFO - ðŸ”Ž  Running validation at step 2400
[rank2]:2025-11-01 00:16:18,685 - INFO -  step: 2400  loss: -2.0000  grad_norm:  0.7029  memory:  8.13GiB(17.12%)  tps: 6,190  tflops: 47.14  mfu: 15.11%
[rank2]:2025-11-01 00:16:18,685 - INFO -  final step: 2400  loss: -2.0000  grad_norm:  0.7029  tps: 6,283  tflops: 47.86  mfu: 14.81%
[rank2]:2025-11-01 00:16:18,685 - INFO - ðŸ”Ž  Running validation at step 2400
[rank0]:2025-11-01 00:16:18,664 - INFO - Avg. fwd time: 4.1002 / Avg. bwd time: 12.0010 / Avg. batch time: 633.7195 (ms) / GPU bubble ratio: 59.35%
[rank0]:2025-11-01 00:16:18,699 - INFO -  step: 2400  loss: -2.0000  grad_norm:  0.7029  memory: 14.71GiB(30.97%)  tps: 6,190  tflops: 47.14  mfu: 15.11%
[rank0]:2025-11-01 00:16:18,699 - INFO -  final step: 2400  loss: -2.0000  grad_norm:  0.7029  tps: 6,283  tflops: 47.85  mfu: 14.81%
[rank1]:2025-11-01 00:16:18,688 - INFO -  step: 2400  loss: -2.0000  grad_norm:  0.7029  memory: 11.87GiB(24.98%)  tps: 6,190  tflops: 47.14  mfu: 15.11%
[rank1]:2025-11-01 00:16:18,689 - INFO -  final step: 2400  loss: -2.0000  grad_norm:  0.7029  tps: 6,283  tflops: 47.85  mfu: 14.81%
[rank0]:2025-11-01 00:16:18,699 - INFO - ðŸ”Ž  Running validation at step 2400
[rank1]:2025-11-01 00:16:18,689 - INFO - ðŸ”Ž  Running validation at step 2400
[rank3]:2025-11-01 00:16:43,834 - INFO - validate step: 2400  loss:  0.9822  memory: 18.19GiB(38.28%)  tps: 16,296
[rank3]:2025-11-01 00:16:43,835 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-11-01 00:16:43,837 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank2]:2025-11-01 00:16:43,834 - INFO - validate step: 2400  loss: -1.0000  memory:  8.13GiB(17.12%)  tps: 16,287
[rank2]:2025-11-01 00:16:43,835 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-01 00:16:43,837 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank1]:2025-11-01 00:16:43,820 - INFO - validate step: 2400  loss: -1.0000  memory: 11.87GiB(24.98%)  tps: 16,299
[rank1]:2025-11-01 00:16:43,820 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-11-01 00:16:43,822 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank0]:2025-11-01 00:16:43,815 - INFO - validate step: 2400  loss: -1.0000  memory: 14.71GiB(30.97%)  tps: 16,309
[rank0]:2025-11-01 00:16:43,815 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-01 00:16:43,818 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank2]:2025-11-01 00:16:46,333 - INFO - Destroying the purge thread.
[rank1]:2025-11-01 00:16:46,333 - INFO - Destroying the purge thread.
[rank1]:2025-11-01 00:16:46,387 - INFO - Process group destroyed
[rank0]:2025-11-01 00:16:46,314 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank0]:2025-11-01 00:16:46,333 - INFO - Sleeping 2 seconds for other ranks to complete
[rank2]:2025-11-01 00:16:46,390 - INFO - Process group destroyed
[rank3]:2025-11-01 00:16:46,645 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_Interleaved1F1B_nofreeze_dm1/pipeline_schedule/251101_0016_real_final2400_rank3.svg
[rank3]:> Batch Time: 504.29 ms, GPU Bubble Ratio: 48.99%, 46.15%, 56.80%, 12.89%
[rank3]:2025-11-01 00:16:46,952 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_Interleaved1F1B_nofreeze_dm1/pipeline_schedule/251101_0016_thry_final2400_rank3.svg
[rank3]:> Batch Time: 271.13 ms, GPU Bubble Ratio: 15.79%, 15.79%, 15.79%, 15.79%
[rank3]:2025-11-01 00:16:46,953 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading history steps 48-48, summary, console lines 330-337
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–„â–‡â–ƒâ–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–ˆâ–†â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–ˆâ–†â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 1.30271
[rank3]:wandb:               final/avg_loss 0.1965
[rank3]:wandb:             final/avg_mfu(%) 14.81655
[rank3]:wandb:             final/avg_tflops 47.89415
[rank3]:wandb:    final/avg_throughput(tps) 6288.44637
[rank3]:wandb:              final/grad_norm 0.70288
[rank3]:wandb:               final/max_loss 0.1965
[rank3]:wandb:                    grad_norm 0.70288
[rank3]:wandb: loss_metrics/global_avg_loss 0.1965
[rank3]:wandb: loss_metrics/global_max_loss 0.1965
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1031_Interleaved1F1B_nofreeze_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/fcmg2c9e
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1031_Interleaved1F1B_nofreeze_dm1/20251031-2318/wandb/run-20251031_231825-fcmg2c9e/logs
[rank0]:2025-11-01 00:16:48,333 - INFO - Training completed
[rank0]:2025-11-01 00:16:48,334 - INFO - Destroying the purge thread.
[rank3]:2025-11-01 00:16:48,387 - INFO - Process group destroyed
[rank0]:2025-11-01 00:16:48,526 - INFO - Process group destroyed
[rank2]:Stage 2: Modules to keep: {'layers.6', 'layers.5'}
[rank2]:Stage 6: Modules to keep: {'layers.14', 'layers.13'}
[rank1]:Stage 1: Modules to keep: {'layers.2', 'layers.4', 'layers.3'}
[rank1]:Stage 5: Modules to keep: {'layers.11', 'layers.12'}
[rank0]:Stage 0: Modules to keep: {'tok_embeddings', 'layers.1', 'layers.0'}
[rank0]:Stage 4: Modules to keep: {'layers.9', 'layers.10'}
[rank3]:Stage 3: Modules to keep: {'layers.8', 'layers.7'}
[rank3]:Stage 7: Modules to keep: {'output', 'layers.15', 'norm'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1029_llama1b/config_1031.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
[rank3]:+ more freezing in autofreeze mode. 
[rank3]:+ lr_scheduler min_lr = 0 -> 1e-6, cosine decay.
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1031_Interleaved1F1B_nofreeze_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1031_Interleaved1F1B_nofreeze_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1031_Interleaved1F1B_nofreeze_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1031_Interleaved1F1B_nofreeze_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1031_Interleaved1F1B_nofreeze_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1031_Interleaved1F1B_nofreeze_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B-Instruct
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 1e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: alpaca
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 512
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 2400
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: Interleaved1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 4
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 2
[rank3]:		- stages_list: [3, 7]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1031_Interleaved1F1B_nofreeze_dm1
[rank3]:		- interval: 800
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B-Instruct/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1031_Interleaved1F1B_nofreeze_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: True
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: False
[rank3]:		- metric_type: apf
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.9
[rank3]:		- threshold: 0.05
[rank3]:		- percentile: 70
[rank3]:
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3

ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 11. 02. (ì¼) 06:45:35 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 3,4,5,6
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1029_llama1b/run_1031.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1029_llama1b/1031_Interleaved1F1B_nofreeze.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
+ more freezing in autofreeze mode. 
+ lr_scheduler min_lr = 0 -> 1e-6, cosine decay.

âœ”ï¸Running with nofreeze x Interleaved1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1029_llama1b/config_1031.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
+ more freezing in autofreeze mode. 
+ lr_scheduler min_lr = 0 -> 1e-6, cosine decay.
" --parallelism.pipeline_parallel_degree=4  --freezing.no-freeze
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank1]:2025-11-02 06:45:41,669 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
[rank1]:+ more freezing in autofreeze mode. 
[rank1]:+ lr_scheduler min_lr = 0 -> 1e-6, cosine decay.
[rank1]:"
[rank3]:2025-11-02 06:45:41,669 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
[rank3]:+ more freezing in autofreeze mode. 
[rank3]:+ lr_scheduler min_lr = 0 -> 1e-6, cosine decay.
[rank3]:"
[rank2]:2025-11-02 06:45:41,798 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
[rank2]:+ more freezing in autofreeze mode. 
[rank2]:+ lr_scheduler min_lr = 0 -> 1e-6, cosine decay.
[rank2]:"
[rank0]:2025-11-02 06:45:41,767 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
[rank0]:+ more freezing in autofreeze mode. 
[rank0]:+ lr_scheduler min_lr = 0 -> 1e-6, cosine decay.
[rank0]:"
[rank2]:2025-11-02 06:45:42,364 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-11-02 06:45:42,367 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-02 06:45:42,375 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-11-02 06:45:42,377 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-02 06:45:42,381 - INFO - [GC] Initial GC collection 0.00 seconds
[rank1]:2025-11-02 06:45:42,386 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-11-02 06:45:42,389 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-11-02 06:45:42,357 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-11-02 06:45:42,360 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-02 06:45:42,727 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-11-02 06:45:43,122 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank0]:2025-11-02 06:45:46,079 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=512, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank2]:2025-11-02 06:45:46,196 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-11-02 06:45:46,240 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-11-02 06:45:46,268 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.5', 'layers.6']
[rank2]:2025-11-02 06:45:46,281 - INFO - PP rank 2 is building stage_idx 6 with modules ['layers.13', 'layers.14']
[rank2]:2025-11-02 06:45:46,282 - INFO - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank0]:2025-11-02 06:45:46,228 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-11-02 06:45:46,268 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-02 06:45:46,270 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-11-02 06:45:46,296 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1']
[rank0]:2025-11-02 06:45:46,308 - INFO - PP rank 0 is building stage_idx 4 with modules ['layers.9', 'layers.10']
[rank0]:2025-11-02 06:45:46,309 - INFO - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank2]:2025-11-02 06:45:46,461 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-11-02 06:45:46,461 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-11-02 06:45:46,462 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank0]:2025-11-02 06:45:46,494 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-02 06:45:46,495 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-11-02 06:45:46,495 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank1]:2025-11-02 06:45:46,554 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-11-02 06:45:46,594 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-11-02 06:45:46,622 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.2', 'layers.3', 'layers.4']
[rank1]:2025-11-02 06:45:46,635 - INFO - PP rank 1 is building stage_idx 5 with modules ['layers.11', 'layers.12']
[rank1]:2025-11-02 06:45:46,637 - INFO - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank1]:2025-11-02 06:45:47,496 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-11-02 06:45:47,496 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-11-02 06:45:47,497 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank3]:wandb: setting up run nwxkflny
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1031_Interleaved1F1B_nofreeze_dm1/20251102-0645/wandb/run-20251102_064547-nwxkflny
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1031_Interleaved1F1B_nofreeze_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/nwxkflny
[rank3]:2025-11-02 06:45:48,233 - INFO - WandB logging enabled
[rank3]:2025-11-02 06:45:48,234 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-11-02 06:45:48,272 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-11-02 06:45:48,304 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.7', 'layers.8']
[rank3]:2025-11-02 06:45:48,318 - INFO - PP rank 3 is building stage_idx 7 with modules ['layers.15', 'norm', 'output']
[rank3]:2025-11-02 06:45:48,320 - INFO - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank3]:2025-11-02 06:45:48,520 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-11-02 06:45:48,521 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-11-02 06:45:48,522 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank2]:2025-11-02 06:45:48,535 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank1]:2025-11-02 06:45:48,535 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-02 06:45:48,535 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1031_Interleaved1F1B_nofreeze_dm1
[rank0]:2025-11-02 06:45:48,536 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-02 06:45:48,536 - INFO - Preparing c4_validation dataset from allenai/c4
[rank3]:2025-11-02 06:45:48,535 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank1]:2025-11-02 06:45:53,510 - WARNING - checkpoint.initial_load_path is provided but the checkpoint.folder exists. Checkpointer will use the checkpoints from the checkpoint.folder /data2/shcho/torchtitan/checkpoint/1031_Interleaved1F1B_nofreeze_dm1.
[rank3]:2025-11-02 06:45:53,969 - WARNING - checkpoint.initial_load_path is provided but the checkpoint.folder exists. Checkpointer will use the checkpoints from the checkpoint.folder /data2/shcho/torchtitan/checkpoint/1031_Interleaved1F1B_nofreeze_dm1.
[rank0]:2025-11-02 06:45:54,023 - INFO - Trainer is initialized with local batch size 32, global batch size 64, gradient accumulation steps 2, sequence length 512, total steps 2400 (warmup 300)
[rank0]:2025-11-02 06:45:54,023 - WARNING - checkpoint.initial_load_path is provided but the checkpoint.folder exists. Checkpointer will use the checkpoints from the checkpoint.folder /data2/shcho/torchtitan/checkpoint/1031_Interleaved1F1B_nofreeze_dm1.
[rank0]:2025-11-02 06:45:54,024 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/checkpoint/1031_Interleaved1F1B_nofreeze_dm1/step-2400.
[rank2]:2025-11-02 06:45:54,137 - WARNING - checkpoint.initial_load_path is provided but the checkpoint.folder exists. Checkpointer will use the checkpoints from the checkpoint.folder /data2/shcho/torchtitan/checkpoint/1031_Interleaved1F1B_nofreeze_dm1.
[rank0]:2025-11-02 06:45:57,109 - INFO - [GC] GC collection for checkpoint loading. 0.01 seconds
[rank0]:2025-11-02 06:45:57,110 - INFO - Finished loading the checkpoint in 3.09 seconds.
[rank0]:2025-11-02 06:45:57,110 - INFO - Training starts at step 1
[rank2]:2025-11-02 06:45:59,759 - INFO -  step:  1  loss: -2.0000  grad_norm:  0.4578  memory:  6.26GiB(13.17%)  tps: 606  tflops: 4.62  mfu: 1.48%
[rank2]:2025-11-02 06:45:59,759 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-02 06:45:59,800 - INFO -  step:  1  loss: -2.0000  grad_norm:  0.4578  memory: 10.93GiB(23.00%)  tps: 605  tflops: 4.61  mfu: 1.48%
[rank0]:2025-11-02 06:45:59,800 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-11-02 06:45:59,771 - INFO -  step:  1  loss:  0.2455  grad_norm:  0.4578  memory: 14.83GiB(31.21%)  tps: 713  tflops: 5.43  mfu: 1.74%
[rank3]:2025-11-02 06:45:59,771 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-11-02 06:45:59,770 - INFO -  step:  1  loss: -2.0000  grad_norm:  0.4578  memory:  9.23GiB(19.43%)  tps: 622  tflops: 4.74  mfu: 1.52%
[rank1]:2025-11-02 06:45:59,770 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-02 06:47:03,013 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-02 06:47:04,334 - INFO -  step: 50  loss: -2.0000  grad_norm:  0.6701  memory: 11.85GiB(24.93%)  tps: 6,217  tflops: 47.35  mfu: 15.18%
[rank2]:2025-11-02 06:47:04,330 - INFO -  step: 50  loss: -2.0000  grad_norm:  0.6701  memory:  8.13GiB(17.12%)  tps: 6,217  tflops: 47.35  mfu: 15.18%
[rank3]:2025-11-02 06:47:04,342 - INFO -  step: 50  loss:  0.2021  grad_norm:  0.6701  memory: 18.19GiB(38.28%)  tps: 6,217  tflops: 47.35  mfu: 15.18%
[rank0]:2025-11-02 06:47:04,344 - INFO -  step: 50  loss: -2.0000  grad_norm:  0.6701  memory: 14.75GiB(31.06%)  tps: 6,219  tflops: 47.37  mfu: 15.18%
[rank0]:2025-11-02 06:48:08,417 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 06:48:09,427 - INFO - Avg. fwd time: 6.2761 / Avg. bwd time: 20.8709 / Avg. batch time: 544.8978 (ms) / GPU bubble ratio: 20.29%
[rank2]:2025-11-02 06:48:09,483 - INFO - Avg. fwd time: 4.0288 / Avg. bwd time: 9.7798 / Avg. batch time: 577.9630 (ms) / GPU bubble ratio: 61.77%
[rank0]:2025-11-02 06:48:09,508 - INFO - Avg. fwd time: 4.2975 / Avg. bwd time: 11.9576 / Avg. batch time: 629.6549 (ms) / GPU bubble ratio: 58.69%
[rank1]:2025-11-02 06:48:09,578 - INFO - Avg. fwd time: 4.7973 / Avg. bwd time: 12.0777 / Avg. batch time: 606.9148 (ms) / GPU bubble ratio: 55.51%
[rank3]:2025-11-02 06:48:09,752 - INFO -  step: 100  loss:  0.1785  grad_norm:  0.4545  memory: 18.19GiB(38.28%)  tps: 6,262  tflops: 47.69  mfu: 15.29%
[rank2]:2025-11-02 06:48:09,736 - INFO -  step: 100  loss: -2.0000  grad_norm:  0.4545  memory:  8.13GiB(17.12%)  tps: 6,262  tflops: 47.70  mfu: 15.29%
[rank1]:2025-11-02 06:48:09,740 - INFO -  step: 100  loss: -2.0000  grad_norm:  0.4545  memory: 11.85GiB(24.93%)  tps: 6,262  tflops: 47.70  mfu: 15.29%
[rank0]:2025-11-02 06:48:09,751 - INFO -  step: 100  loss: -2.0000  grad_norm:  0.4545  memory: 14.75GiB(31.06%)  tps: 6,262  tflops: 47.70  mfu: 15.29%
[rank3]:2025-11-02 06:48:10,071 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_Interleaved1F1B_nofreeze_dm1/pipeline_schedule/251102_0648_real_step100_rank3.svg
[rank3]:> Batch Time: 499.34 ms, GPU Bubble Ratio: 48.45%, 45.75%, 56.50%, 13.04%
[rank0]:2025-11-02 06:49:14,364 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-02 06:49:15,706 - INFO -  step: 150  loss: -2.0000  grad_norm:  0.4849  memory: 11.85GiB(24.93%)  tps: 6,209  tflops: 47.29  mfu: 15.16%
[rank2]:2025-11-02 06:49:15,702 - INFO -  step: 150  loss: -2.0000  grad_norm:  0.4849  memory:  8.13GiB(17.12%)  tps: 6,209  tflops: 47.29  mfu: 15.16%
[rank3]:2025-11-02 06:49:15,715 - INFO -  step: 150  loss:  0.2358  grad_norm:  0.4849  memory: 18.19GiB(38.28%)  tps: 6,210  tflops: 47.29  mfu: 15.16%
[rank0]:2025-11-02 06:49:15,717 - INFO -  step: 150  loss: -2.0000  grad_norm:  0.4849  memory: 14.75GiB(31.06%)  tps: 6,209  tflops: 47.29  mfu: 15.16%
[rank0]:2025-11-02 06:50:20,028 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 06:50:21,049 - INFO - Avg. fwd time: 6.3000 / Avg. bwd time: 20.9904 / Avg. batch time: 545.2844 (ms) / GPU bubble ratio: 19.92%
[rank0]:2025-11-02 06:50:21,127 - INFO - Avg. fwd time: 4.1907 / Avg. bwd time: 11.9883 / Avg. batch time: 630.5847 (ms) / GPU bubble ratio: 58.95%
[rank2]:2025-11-02 06:50:21,107 - INFO - Avg. fwd time: 3.9263 / Avg. bwd time: 9.7758 / Avg. batch time: 578.8070 (ms) / GPU bubble ratio: 62.12%
[rank1]:2025-11-02 06:50:21,204 - INFO - Avg. fwd time: 4.7976 / Avg. bwd time: 12.1057 / Avg. batch time: 607.8133 (ms) / GPU bubble ratio: 55.50%
[rank3]:2025-11-02 06:50:21,378 - INFO -  step: 200  loss:  0.1841  grad_norm:  0.7237  memory: 18.19GiB(38.28%)  tps: 6,238  tflops: 47.51  mfu: 15.23%
[rank3]:2025-11-02 06:50:21,378 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-11-02 06:50:21,380 - INFO -  step: 200  loss: -2.0000  grad_norm:  0.7237  memory: 14.75GiB(31.06%)  tps: 6,238  tflops: 47.51  mfu: 15.23%
[rank0]:2025-11-02 06:50:21,380 - INFO - ðŸ”Ž  Running validation at step 200
[rank2]:2025-11-02 06:50:21,365 - INFO -  step: 200  loss: -2.0000  grad_norm:  0.7237  memory:  8.13GiB(17.12%)  tps: 6,238  tflops: 47.51  mfu: 15.23%
[rank2]:2025-11-02 06:50:21,366 - INFO - ðŸ”Ž  Running validation at step 200
[rank1]:2025-11-02 06:50:21,369 - INFO -  step: 200  loss: -2.0000  grad_norm:  0.7237  memory: 11.85GiB(24.93%)  tps: 6,238  tflops: 47.51  mfu: 15.23%
[rank1]:2025-11-02 06:50:21,369 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-11-02 06:50:48,500 - INFO - validate step: 200  loss: -1.0000  memory: 14.75GiB(31.06%)  tps: 15,103
[rank3]:2025-11-02 06:50:48,519 - INFO - validate step: 200  loss:  1.0134  memory: 18.19GiB(38.28%)  tps: 15,092
[rank2]:2025-11-02 06:50:48,522 - INFO - validate step: 200  loss: -1.0000  memory:  8.13GiB(17.12%)  tps: 15,083
[rank1]:2025-11-02 06:50:48,503 - INFO - validate step: 200  loss: -1.0000  memory: 11.85GiB(24.93%)  tps: 15,096
[rank3]:2025-11-02 06:50:48,837 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_Interleaved1F1B_nofreeze_dm1/pipeline_schedule/251102_0650_real_step200_rank3.svg
[rank3]:> Batch Time: 501.80 ms, GPU Bubble Ratio: 48.62%, 45.98%, 56.64%, 12.98%
[rank0]:2025-11-02 06:51:53,354 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-11-02 06:51:54,683 - INFO -  step: 250  loss: -2.0000  grad_norm:  0.7165  memory: 14.75GiB(31.06%)  tps: 6,189  tflops: 47.14  mfu: 15.11%
[rank3]:2025-11-02 06:51:54,680 - INFO -  step: 250  loss:  0.1892  grad_norm:  0.7165  memory: 18.19GiB(38.28%)  tps: 6,191  tflops: 47.15  mfu: 15.11%
[rank2]:2025-11-02 06:51:54,668 - INFO -  step: 250  loss: -2.0000  grad_norm:  0.7165  memory:  8.13GiB(17.12%)  tps: 6,192  tflops: 47.16  mfu: 15.12%
[rank1]:2025-11-02 06:51:54,672 - INFO -  step: 250  loss: -2.0000  grad_norm:  0.7165  memory: 11.85GiB(24.93%)  tps: 6,190  tflops: 47.15  mfu: 15.11%
[rank0]:2025-11-02 06:52:59,074 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 06:53:00,299 - INFO - Avg. fwd time: 6.3193 / Avg. bwd time: 21.0508 / Avg. batch time: 545.9584 (ms) / GPU bubble ratio: 19.79%
[rank2]:2025-11-02 06:53:00,328 - INFO - Avg. fwd time: 3.8956 / Avg. bwd time: 9.7750 / Avg. batch time: 579.5314 (ms) / GPU bubble ratio: 62.26%
[rank2]:2025-11-02 06:53:00,394 - INFO -  step: 300  loss: -2.0000  grad_norm:  0.5833  memory:  8.13GiB(17.12%)  tps: 6,232  tflops: 47.46  mfu: 15.21%
[rank3]:2025-11-02 06:53:00,406 - INFO -  step: 300  loss:  0.1649  grad_norm:  0.5833  memory: 18.19GiB(38.28%)  tps: 6,232  tflops: 47.47  mfu: 15.21%
[rank1]:2025-11-02 06:53:00,350 - INFO - Avg. fwd time: 4.7946 / Avg. bwd time: 12.1103 / Avg. batch time: 608.5442 (ms) / GPU bubble ratio: 55.55%
[rank1]:2025-11-02 06:53:00,397 - INFO -  step: 300  loss: -2.0000  grad_norm:  0.5833  memory: 11.85GiB(24.93%)  tps: 6,232  tflops: 47.46  mfu: 15.21%
[rank0]:2025-11-02 06:53:00,373 - INFO - Avg. fwd time: 4.1583 / Avg. bwd time: 11.9933 / Avg. batch time: 631.3252 (ms) / GPU bubble ratio: 59.07%
[rank0]:2025-11-02 06:53:00,408 - INFO -  step: 300  loss: -2.0000  grad_norm:  0.5833  memory: 14.75GiB(31.06%)  tps: 6,232  tflops: 47.46  mfu: 15.21%
[rank3]:2025-11-02 06:53:00,712 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_Interleaved1F1B_nofreeze_dm1/pipeline_schedule/251102_0653_real_step300_rank3.svg
[rank3]:> Batch Time: 502.76 ms, GPU Bubble Ratio: 48.77%, 46.26%, 56.73%, 12.92%
[rank0]:2025-11-02 06:54:05,047 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 06:54:06,367 - INFO -  step: 350  loss: -2.0000  grad_norm:  0.4992  memory:  8.13GiB(17.12%)  tps: 6,209  tflops: 47.29  mfu: 15.16%
[rank3]:2025-11-02 06:54:06,380 - INFO -  step: 350  loss:  0.1448  grad_norm:  0.4992  memory: 18.19GiB(38.28%)  tps: 6,209  tflops: 47.29  mfu: 15.16%
[rank1]:2025-11-02 06:54:06,371 - INFO -  step: 350  loss: -2.0000  grad_norm:  0.4992  memory: 11.85GiB(24.93%)  tps: 6,209  tflops: 47.29  mfu: 15.16%
[rank0]:2025-11-02 06:54:06,382 - INFO -  step: 350  loss: -2.0000  grad_norm:  0.4992  memory: 14.75GiB(31.06%)  tps: 6,209  tflops: 47.29  mfu: 15.16%
[rank0]:2025-11-02 06:55:10,916 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 06:55:11,938 - INFO - Avg. fwd time: 6.3272 / Avg. bwd time: 21.0736 / Avg. batch time: 546.1925 (ms) / GPU bubble ratio: 19.73%
[rank0]:2025-11-02 06:55:12,014 - INFO - Avg. fwd time: 4.1441 / Avg. bwd time: 11.9951 / Avg. batch time: 631.6552 (ms) / GPU bubble ratio: 59.12%
[rank2]:2025-11-02 06:55:11,994 - INFO - Avg. fwd time: 3.8818 / Avg. bwd time: 9.7741 / Avg. batch time: 579.8752 (ms) / GPU bubble ratio: 62.32%
[rank1]:2025-11-02 06:55:12,091 - INFO - Avg. fwd time: 4.7929 / Avg. bwd time: 12.1099 / Avg. batch time: 608.8758 (ms) / GPU bubble ratio: 55.58%
[rank2]:2025-11-02 06:55:12,251 - INFO -  step: 400  loss: -2.0000  grad_norm:  0.7631  memory:  8.13GiB(17.12%)  tps: 6,217  tflops: 47.35  mfu: 15.18%
[rank2]:2025-11-02 06:55:12,251 - INFO - ðŸ”Ž  Running validation at step 400
[rank3]:2025-11-02 06:55:12,263 - INFO -  step: 400  loss:  0.1593  grad_norm:  0.7631  memory: 18.19GiB(38.28%)  tps: 6,217  tflops: 47.35  mfu: 15.18%
[rank3]:2025-11-02 06:55:12,264 - INFO - ðŸ”Ž  Running validation at step 400
[rank1]:2025-11-02 06:55:12,255 - INFO -  step: 400  loss: -2.0000  grad_norm:  0.7631  memory: 11.85GiB(24.93%)  tps: 6,217  tflops: 47.35  mfu: 15.18%
[rank1]:2025-11-02 06:55:12,255 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-11-02 06:55:12,266 - INFO -  step: 400  loss: -2.0000  grad_norm:  0.7631  memory: 14.75GiB(31.06%)  tps: 6,217  tflops: 47.35  mfu: 15.18%
[rank0]:2025-11-02 06:55:12,266 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-11-02 06:55:37,140 - INFO - validate step: 400  loss: -1.0000  memory: 14.75GiB(31.06%)  tps: 16,467
[rank2]:2025-11-02 06:55:37,159 - INFO - validate step: 400  loss: -1.0000  memory:  8.13GiB(17.12%)  tps: 16,445
[rank3]:2025-11-02 06:55:37,159 - INFO - validate step: 400  loss:  1.0262  memory: 18.19GiB(38.28%)  tps: 16,453
[rank1]:2025-11-02 06:55:37,145 - INFO - validate step: 400  loss: -1.0000  memory: 11.85GiB(24.93%)  tps: 16,457
[rank3]:2025-11-02 06:55:37,461 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_Interleaved1F1B_nofreeze_dm1/pipeline_schedule/251102_0655_real_step400_rank3.svg
[rank3]:> Batch Time: 504.74 ms, GPU Bubble Ratio: 48.98%, 46.47%, 56.90%, 12.94%
[rank0]:2025-11-02 06:56:42,008 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-11-02 06:56:43,341 - INFO -  step: 450  loss: -2.0000  grad_norm:  0.5701  memory: 14.75GiB(31.06%)  tps: 6,187  tflops: 47.12  mfu: 15.10%
[rank2]:2025-11-02 06:56:43,327 - INFO -  step: 450  loss: -2.0000  grad_norm:  0.5701  memory:  8.13GiB(17.12%)  tps: 6,190  tflops: 47.15  mfu: 15.11%
[rank3]:2025-11-02 06:56:43,339 - INFO -  step: 450  loss:  0.1768  grad_norm:  0.5701  memory: 18.19GiB(38.28%)  tps: 6,189  tflops: 47.14  mfu: 15.11%
[rank1]:2025-11-02 06:56:43,330 - INFO -  step: 450  loss: -2.0000  grad_norm:  0.5701  memory: 11.85GiB(24.93%)  tps: 6,189  tflops: 47.13  mfu: 15.11%
[rank0]:2025-11-02 06:57:47,801 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 06:57:48,869 - INFO - Avg. fwd time: 3.8731 / Avg. bwd time: 9.7744 / Avg. batch time: 580.2634 (ms) / GPU bubble ratio: 62.37%
[rank3]:2025-11-02 06:57:48,812 - INFO - Avg. fwd time: 6.3383 / Avg. bwd time: 21.1018 / Avg. batch time: 546.6359 (ms) / GPU bubble ratio: 19.68%
[rank0]:2025-11-02 06:57:48,889 - INFO - Avg. fwd time: 4.1341 / Avg. bwd time: 11.9958 / Avg. batch time: 632.0363 (ms) / GPU bubble ratio: 59.17%
[rank1]:2025-11-02 06:57:48,964 - INFO - Avg. fwd time: 4.7918 / Avg. bwd time: 12.1107 / Avg. batch time: 609.2554 (ms) / GPU bubble ratio: 55.61%
[rank2]:2025-11-02 06:57:49,123 - INFO -  step: 500  loss: -2.0000  grad_norm:  0.5699  memory:  8.13GiB(17.12%)  tps: 6,225  tflops: 47.41  mfu: 15.20%
[rank3]:2025-11-02 06:57:49,135 - INFO -  step: 500  loss:  0.1929  grad_norm:  0.5699  memory: 18.19GiB(38.28%)  tps: 6,225  tflops: 47.41  mfu: 15.20%
[rank1]:2025-11-02 06:57:49,127 - INFO -  step: 500  loss: -2.0000  grad_norm:  0.5699  memory: 11.85GiB(24.93%)  tps: 6,225  tflops: 47.41  mfu: 15.20%
[rank0]:2025-11-02 06:57:49,138 - INFO -  step: 500  loss: -2.0000  grad_norm:  0.5699  memory: 14.75GiB(31.06%)  tps: 6,225  tflops: 47.41  mfu: 15.20%
[rank3]:2025-11-02 06:57:49,448 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_Interleaved1F1B_nofreeze_dm1/pipeline_schedule/251102_0657_real_step500_rank3.svg
[rank3]:> Batch Time: 505.64 ms, GPU Bubble Ratio: 49.07%, 46.50%, 56.90%, 12.81%
[rank0]:2025-11-02 06:58:54,067 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-02 06:58:55,413 - INFO -  step: 550  loss: -2.0000  grad_norm:  0.6005  memory: 14.75GiB(31.06%)  tps: 6,180  tflops: 47.07  mfu: 15.09%
[rank2]:2025-11-02 06:58:55,398 - INFO -  step: 550  loss: -2.0000  grad_norm:  0.6005  memory:  8.13GiB(17.12%)  tps: 6,180  tflops: 47.07  mfu: 15.09%
[rank3]:2025-11-02 06:58:55,411 - INFO -  step: 550  loss:  0.1952  grad_norm:  0.6005  memory: 18.19GiB(38.28%)  tps: 6,180  tflops: 47.07  mfu: 15.09%
[rank1]:2025-11-02 06:58:55,402 - INFO -  step: 550  loss: -2.0000  grad_norm:  0.6005  memory: 11.85GiB(24.93%)  tps: 6,180  tflops: 47.07  mfu: 15.09%
[rank0]:2025-11-02 06:59:59,740 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
