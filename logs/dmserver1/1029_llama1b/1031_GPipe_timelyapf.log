
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 11. 02. (ì¼) 00:01:51 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 3,4,5,6
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1029_llama1b/run_1031.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1029_llama1b/1031_GPipe_timelyapf.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
+ more freezing in autofreeze mode. 
+ lr_scheduler min_lr = 0 -> 1e-6, cosine decay.

âœ”ï¸Running with timelyapf x GPipe ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1029_llama1b/config_1031.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
+ more freezing in autofreeze mode. 
+ lr_scheduler min_lr = 0 -> 1e-6, cosine decay.
" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=timelyapf
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank3]:2025-11-02 00:01:57,968 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
[rank3]:+ more freezing in autofreeze mode. 
[rank3]:+ lr_scheduler min_lr = 0 -> 1e-6, cosine decay.
[rank3]:"
[rank1]:2025-11-02 00:01:57,970 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
[rank1]:+ more freezing in autofreeze mode. 
[rank1]:+ lr_scheduler min_lr = 0 -> 1e-6, cosine decay.
[rank1]:"
[rank2]:2025-11-02 00:01:58,096 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
[rank2]:+ more freezing in autofreeze mode. 
[rank2]:+ lr_scheduler min_lr = 0 -> 1e-6, cosine decay.
[rank2]:"
[rank0]:2025-11-02 00:01:58,176 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
[rank0]:+ more freezing in autofreeze mode. 
[rank0]:+ lr_scheduler min_lr = 0 -> 1e-6, cosine decay.
[rank0]:"
[rank3]:2025-11-02 00:01:58,203 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-11-02 00:01:58,205 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-11-02 00:01:58,207 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-11-02 00:01:58,209 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-11-02 00:01:58,313 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-11-02 00:01:58,316 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-02 00:01:58,379 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-11-02 00:01:58,382 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-02 00:01:58,387 - INFO - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-11-02 00:01:58,847 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-11-02 00:01:59,264 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank0]:2025-11-02 00:02:02,135 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=512, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank0]:2025-11-02 00:02:02,289 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-11-02 00:02:02,332 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-02 00:02:02,333 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank1]:2025-11-02 00:02:02,299 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-11-02 00:02:02,338 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-02 00:02:02,358 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-11-02 00:02:02,358 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2025-11-02 00:02:02,367 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-11-02 00:02:02,367 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-11-02 00:02:02,558 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-02 00:02:02,558 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-11-02 00:02:02,559 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank1]:2025-11-02 00:02:02,555 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-11-02 00:02:02,555 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-11-02 00:02:02,556 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank2]:2025-11-02 00:02:04,129 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-11-02 00:02:04,167 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-11-02 00:02:04,195 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-11-02 00:02:04,195 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank2]:2025-11-02 00:02:04,369 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-11-02 00:02:04,369 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-11-02 00:02:04,370 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run 7f1po15r
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1031_GPipe_timelyapf_dm1/20251102-0002/wandb/run-20251102_000204-7f1po15r
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1031_GPipe_timelyapf_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/7f1po15r
[rank3]:2025-11-02 00:02:05,449 - INFO - WandB logging enabled
[rank3]:2025-11-02 00:02:05,450 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-11-02 00:02:05,488 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-11-02 00:02:05,518 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-11-02 00:02:05,519 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank2]:2025-11-02 00:02:05,736 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-02 00:02:05,736 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1031_GPipe_timelyapf_dm1
[rank0]:2025-11-02 00:02:05,736 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-02 00:02:05,737 - INFO - Preparing c4_validation dataset from allenai/c4
[rank1]:2025-11-02 00:02:05,736 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-11-02 00:02:05,719 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-11-02 00:02:05,720 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-11-02 00:02:05,720 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2025-11-02 00:02:05,736 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-02 00:02:10,946 - INFO - Trainer is initialized with local batch size 32, global batch size 64, gradient accumulation steps 2, sequence length 512, total steps 2400 (warmup 300)
[rank0]:2025-11-02 00:02:10,946 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B-Instruct/original_dcp.
[rank0]:2025-11-02 00:02:13,033 - INFO - [GC] GC collection for checkpoint loading. 0.01 seconds
[rank0]:2025-11-02 00:02:13,034 - INFO - Finished loading the checkpoint in 2.09 seconds.
[rank0]:2025-11-02 00:02:13,034 - INFO - Training starts at step 1
[rank2]:2025-11-02 00:02:15,621 - INFO -  step:  1  loss: -2.0000  grad_norm: 85.2032  memory:  9.35GiB(19.67%)  tps: 715  tflops: 5.45  mfu: 1.75%
[rank2]:2025-11-02 00:02:15,622 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-02 00:02:15,659 - INFO -  step:  1  loss: -2.0000  grad_norm: 85.2032  memory: 12.28GiB(25.84%)  tps: 615  tflops: 4.68  mfu: 1.50%
[rank0]:2025-11-02 00:02:15,660 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-11-02 00:02:15,627 - INFO -  step:  1  loss: -2.0000  grad_norm: 85.2032  memory: 11.50GiB(24.20%)  tps: 616  tflops: 4.70  mfu: 1.50%
[rank1]:2025-11-02 00:02:15,627 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-11-02 00:02:15,632 - INFO -  step:  1  loss:  9.0164  grad_norm: 85.2032  memory: 23.19GiB(48.82%)  tps: 808  tflops: 6.15  mfu: 1.97%
[rank3]:2025-11-02 00:02:15,632 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-02 00:03:15,683 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 00:03:16,934 - INFO -  step: 50  loss: -2.0000  grad_norm: 49.3395  memory: 11.81GiB(24.85%)  tps: 6,547  tflops: 49.86  mfu: 15.98%
[rank1]:2025-11-02 00:03:16,938 - INFO -  step: 50  loss: -2.0000  grad_norm: 49.3395  memory: 14.64GiB(30.82%)  tps: 6,547  tflops: 49.86  mfu: 15.98%
[rank3]:2025-11-02 00:03:16,946 - INFO -  step: 50  loss:  9.8047  grad_norm: 49.3395  memory: 27.51GiB(57.90%)  tps: 6,547  tflops: 49.86  mfu: 15.98%
[rank0]:2025-11-02 00:03:16,949 - INFO -  step: 50  loss: -2.0000  grad_norm: 49.3395  memory: 16.57GiB(34.88%)  tps: 6,549  tflops: 49.88  mfu: 15.99%
[rank0]:2025-11-02 00:04:17,819 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 00:04:18,777 - INFO - Avg. fwd time: 10.9216 / Avg. bwd time: 42.8203 / Avg. batch time: 494.1410 (ms) / GPU bubble ratio: 12.99%
[rank2]:2025-11-02 00:04:18,847 - INFO - Avg. fwd time: 6.8884 / Avg. bwd time: 18.2053 / Avg. batch time: 526.3777 (ms) / GPU bubble ratio: 61.86%
[rank1]:2025-11-02 00:04:18,886 - INFO - Avg. fwd time: 9.2273 / Avg. bwd time: 23.7388 / Avg. batch time: 565.4389 (ms) / GPU bubble ratio: 53.36%
[rank0]:2025-11-02 00:04:18,893 - INFO - Avg. fwd time: 8.0189 / Avg. bwd time: 23.5123 / Avg. batch time: 602.9034 (ms) / GPU bubble ratio: 58.16%
[rank2]:2025-11-02 00:04:19,064 - INFO -  step: 100  loss: -2.0000  grad_norm: 32.1189  memory: 11.81GiB(24.85%)  tps: 6,593  tflops: 50.21  mfu: 16.09%
[rank2]:2025-11-02 00:04:19,064 - WARNING - Nothing to draw before the end of warmup.
[rank3]:2025-11-02 00:04:19,076 - INFO -  step: 100  loss:  8.5686  grad_norm: 32.1189  memory: 27.51GiB(57.90%)  tps: 6,593  tflops: 50.21  mfu: 16.09%
[rank3]:2025-11-02 00:04:19,076 - WARNING - Nothing to draw before the end of warmup.
[rank1]:2025-11-02 00:04:19,067 - INFO -  step: 100  loss: -2.0000  grad_norm: 32.1189  memory: 14.64GiB(30.82%)  tps: 6,593  tflops: 50.21  mfu: 16.09%
[rank1]:2025-11-02 00:04:19,067 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-11-02 00:04:19,078 - INFO -  step: 100  loss: -2.0000  grad_norm: 32.1189  memory: 16.57GiB(34.88%)  tps: 6,593  tflops: 50.21  mfu: 16.09%
[rank0]:2025-11-02 00:04:19,078 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-11-02 00:05:20,005 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 00:05:21,279 - INFO -  step: 150  loss: -2.0000  grad_norm: 46.0207  memory: 11.81GiB(24.85%)  tps: 6,584  tflops: 50.14  mfu: 16.07%
[rank3]:2025-11-02 00:05:21,297 - INFO -  step: 150  loss:  5.0207  grad_norm: 46.0207  memory: 27.51GiB(57.90%)  tps: 6,583  tflops: 50.14  mfu: 16.07%
[rank1]:2025-11-02 00:05:21,282 - INFO -  step: 150  loss: -2.0000  grad_norm: 46.0207  memory: 14.64GiB(30.82%)  tps: 6,584  tflops: 50.14  mfu: 16.07%
[rank0]:2025-11-02 00:05:21,293 - INFO -  step: 150  loss: -2.0000  grad_norm: 46.0207  memory: 16.57GiB(34.88%)  tps: 6,584  tflops: 50.14  mfu: 16.07%
[rank0]:2025-11-02 00:06:22,331 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 00:06:23,319 - INFO - Avg. fwd time: 10.7865 / Avg. bwd time: 43.0248 / Avg. batch time: 492.2116 (ms) / GPU bubble ratio: 12.54%
[rank2]:2025-11-02 00:06:23,390 - INFO - Avg. fwd time: 6.8855 / Avg. bwd time: 18.2676 / Avg. batch time: 523.4057 (ms) / GPU bubble ratio: 61.55%
[rank0]:2025-11-02 00:06:23,436 - INFO - Avg. fwd time: 8.0392 / Avg. bwd time: 23.5852 / Avg. batch time: 599.0654 (ms) / GPU bubble ratio: 57.77%
[rank1]:2025-11-02 00:06:23,430 - INFO - Avg. fwd time: 9.0774 / Avg. bwd time: 23.6891 / Avg. batch time: 561.9926 (ms) / GPU bubble ratio: 53.36%
[rank2]:2025-11-02 00:06:23,610 - INFO -  step: 200  loss: -2.0000  grad_norm: 38.8667  memory: 11.81GiB(24.85%)  tps: 6,571  tflops: 50.05  mfu: 16.04%
[rank2]:2025-11-02 00:06:23,611 - INFO - ðŸ”Ž  Running validation at step 200
[rank3]:2025-11-02 00:06:23,623 - INFO -  step: 200  loss:  1.7794  grad_norm: 38.8667  memory: 27.51GiB(57.90%)  tps: 6,572  tflops: 50.05  mfu: 16.04%
[rank3]:2025-11-02 00:06:23,623 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-11-02 00:06:23,625 - INFO -  step: 200  loss: -2.0000  grad_norm: 38.8667  memory: 16.57GiB(34.88%)  tps: 6,571  tflops: 50.05  mfu: 16.04%
[rank0]:2025-11-02 00:06:23,625 - INFO - ðŸ”Ž  Running validation at step 200
[rank1]:2025-11-02 00:06:23,614 - INFO -  step: 200  loss: -2.0000  grad_norm: 38.8667  memory: 14.64GiB(30.82%)  tps: 6,571  tflops: 50.05  mfu: 16.04%
[rank1]:2025-11-02 00:06:23,614 - INFO - ðŸ”Ž  Running validation at step 200
[rank2]:2025-11-02 00:06:45,354 - INFO - validate step: 200  loss: -1.0000  memory: 11.81GiB(24.85%)  tps: 18,838
[rank2]:2025-11-02 00:06:45,355 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-11-02 00:06:45,321 - INFO - validate step: 200  loss: -1.0000  memory: 16.57GiB(34.88%)  tps: 18,879
[rank0]:2025-11-02 00:06:45,322 - WARNING - Nothing to draw before the end of warmup.
[rank1]:2025-11-02 00:06:45,339 - INFO - validate step: 200  loss: -1.0000  memory: 14.64GiB(30.82%)  tps: 18,854
[rank1]:2025-11-02 00:06:45,340 - WARNING - Nothing to draw before the end of warmup.
[rank3]:2025-11-02 00:06:45,349 - INFO - validate step: 200  loss:  1.5317  memory: 27.51GiB(57.90%)  tps: 18,855
[rank3]:2025-11-02 00:06:45,350 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-11-02 00:07:46,571 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-11-02 00:07:47,816 - INFO -  step: 250  loss: -2.0000  grad_norm: 119.0047  memory: 11.81GiB(24.85%)  tps: 6,558  tflops: 49.94  mfu: 16.01%
[rank3]:2025-11-02 00:07:47,828 - INFO -  step: 250  loss:  0.7374  grad_norm: 119.0047  memory: 27.51GiB(57.90%)  tps: 6,556  tflops: 49.93  mfu: 16.00%
[rank0]:2025-11-02 00:07:47,831 - INFO -  step: 250  loss: -2.0000  grad_norm: 119.0047  memory: 16.57GiB(34.88%)  tps: 6,553  tflops: 49.91  mfu: 16.00%
[rank1]:2025-11-02 00:07:47,820 - INFO -  step: 250  loss: -2.0000  grad_norm: 119.0047  memory: 14.64GiB(30.82%)  tps: 6,556  tflops: 49.93  mfu: 16.00%
[rank3]:2025-11-02 00:07:59,982 - INFO - [Step 260] ã€°ï¸ Monitoring Upperbound
[rank2]:2025-11-02 00:08:13,262 - WARNING - [Step 270] â³ Monitoring Upperbound... (540/550)
[rank3]:2025-11-02 00:08:13,238 - WARNING - [Step 270] â³ Monitoring Upperbound... (540/550)
[rank0]:2025-11-02 00:08:13,319 - WARNING - [Step 270] â³ Monitoring Upperbound... (540/550)
[rank1]:2025-11-02 00:08:13,290 - WARNING - [Step 270] â³ Monitoring Upperbound... (540/550)
[rank3]:2025-11-02 00:08:27,890 - INFO - [Step 280] âœ”ï¸  Setting Upperbound
[rank3]:2025-11-02 00:08:28,191 - INFO - [Step 280] ã€°ï¸ Monitoring Lowerbound
[rank0]:2025-11-02 00:08:28,245 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-02 00:08:28,245 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-02 00:08:28,261 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-02 00:08:28,273 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-02 00:08:28,283 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-02 00:08:28,292 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-02 00:08:28,260 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-02 00:08:30,669 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-02 00:08:30,707 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-02 00:08:30,698 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-02 00:08:30,716 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-02 00:08:30,728 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-02 00:08:30,738 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-02 00:08:30,677 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-02 00:08:30,716 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-02 00:08:30,752 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-02 00:08:30,743 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-02 00:08:30,781 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-02 00:08:30,760 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-02 00:08:30,797 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-02 00:08:30,843 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-02 00:08:30,865 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-02 00:08:30,903 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-02 00:08:30,941 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-02 00:08:30,879 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-02 00:08:30,906 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-02 00:08:30,942 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-02 00:08:30,883 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-02 00:08:30,921 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-02 00:08:30,958 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-02 00:08:30,980 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-02 00:08:31,000 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-02 00:08:48,612 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 00:08:49,398 - INFO - Avg. fwd time: 6.9789 / Avg. bwd time: 17.6118 / Avg. batch time: 525.2070 (ms) / GPU bubble ratio: 62.54%
[rank2]:2025-11-02 00:08:49,435 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-02 00:08:49,436 - INFO -  step: 300  loss: -2.0000  grad_norm:  0.0000  memory: 11.81GiB(24.85%)  tps: 6,647  tflops: 50.63  mfu: 16.23%
[rank3]:2025-11-02 00:08:49,384 - INFO - Avg. fwd time: 10.9044 / Avg. bwd time: 41.7077 / Avg. batch time: 481.8522 (ms) / GPU bubble ratio: 12.65%
[rank3]:2025-11-02 00:08:49,387 - INFO - [Step 300] âœ”ï¸  Setting Lowerbound
[rank0]:2025-11-02 00:08:49,418 - INFO - Avg. fwd time: 8.0977 / Avg. bwd time: 22.0600 / Avg. batch time: 598.1256 (ms) / GPU bubble ratio: 59.66%
[rank0]:2025-11-02 00:08:49,436 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.47/0.47, [MB5] 0.10/0.10, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank0]:2025-11-02 00:08:49,436 - INFO -  step: 300  loss: -2.0000  grad_norm:  0.0000  memory: 16.57GiB(34.88%)  tps: 6,649  tflops: 50.64  mfu: 16.23%
[rank1]:2025-11-02 00:08:49,414 - INFO - Avg. fwd time: 9.1475 / Avg. bwd time: 22.8172 / Avg. batch time: 562.7606 (ms) / GPU bubble ratio: 54.56%
[rank1]:2025-11-02 00:08:49,435 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.21/0.21, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.78/0.78, [MB6] 0.94/0.94, [MB7] 1.00/1.00
[rank1]:2025-11-02 00:08:49,436 - INFO -  step: 300  loss: -2.0000  grad_norm:  0.0000  memory: 14.64GiB(30.82%)  tps: 6,648  tflops: 50.63  mfu: 16.23%
[rank3]:2025-11-02 00:08:49,638 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule/251102_0008_max_batch_time.svg
[rank3]:> Batch Time: 525.43 ms, GPU Bubble Ratio: 51.88%, 50.48%, 61.68%, 18.10%
[rank3]:2025-11-02 00:08:49,827 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule/251102_0008_min_batch_time.svg
[rank3]:> Batch Time: 300.95 ms, GPU Bubble Ratio: 78.87%, 48.56%, 60.34%, 15.69%
[rank3]:2025-11-02 00:08:50,032 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule/251102_0008_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 330.22 ms, GPU Bubble Ratio: 42.18%, 33.15%, 42.17%, 14.30%
[rank3]:2025-11-02 00:08:50,033 - INFO - 	> Batch Time: 330.22 ms (Average Freeze Ratio: 0.40, Time Reduction Rate: 0.37)
[rank3]:2025-11-02 00:08:52,477 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.40/0.40, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank2]:2025-11-02 00:08:52,565 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251102_0008_stage2_step300.svg
[rank3]:2025-11-02 00:08:52,480 - INFO -  step: 300  loss:  0.2991  grad_norm:  0.0132  memory: 30.44GiB(64.07%)  tps: 6,336  tflops: 48.25  mfu: 15.47%
[rank0]:2025-11-02 00:08:52,567 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251102_0008_stage0_step300.svg
[rank1]:2025-11-02 00:08:52,569 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251102_0008_stage1_step300.svg
[rank3]:2025-11-02 00:08:52,669 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule/251102_0008_real_step300_rank3.svg
[rank3]:> Batch Time: 322.81 ms, GPU Bubble Ratio: 77.45%, 47.36%, 59.17%, 14.53%
[rank3]:2025-11-02 00:08:52,738 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251102_0008_stage3_step300.svg
[rank0]:2025-11-02 00:09:48,052 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 00:09:48,986 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.67/1.00
[rank2]:2025-11-02 00:09:48,987 - INFO -  step: 350  loss: -2.0000  grad_norm:  0.5424  memory: 11.85GiB(24.93%)  tps: 6,878  tflops: 52.39  mfu: 16.79%
[rank0]:2025-11-02 00:09:48,999 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.31/0.47, [MB5] 0.06/0.10, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank0]:2025-11-02 00:09:49,000 - INFO -  step: 350  loss: -2.0000  grad_norm:  0.5424  memory: 17.04GiB(35.87%)  tps: 6,877  tflops: 52.37  mfu: 16.79%
[rank1]:2025-11-02 00:09:48,991 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.14/0.21, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.52/0.78, [MB6] 0.63/0.94, [MB7] 0.67/1.00
[rank1]:2025-11-02 00:09:48,991 - INFO -  step: 350  loss: -2.0000  grad_norm:  0.5424  memory: 14.99GiB(31.56%)  tps: 6,878  tflops: 52.38  mfu: 16.79%
[rank3]:2025-11-02 00:09:51,429 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.27/0.40, [MB2] 0.67/1.00, [MB3] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank3]:2025-11-02 00:09:51,433 - INFO -  step: 350  loss:  0.2233  grad_norm:  0.5424  memory: 30.69GiB(64.60%)  tps: 6,948  tflops: 52.92  mfu: 16.96%
[rank0]:2025-11-02 00:10:43,931 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-02 00:10:44,454 - INFO - Avg. fwd time: 8.2819 / Avg. bwd time: 19.9143 / Avg. batch time: 585.6051 (ms) / GPU bubble ratio: 61.48%
[rank3]:2025-11-02 00:10:44,582 - INFO - Avg. fwd time: 11.3610 / Avg. bwd time: 37.6219 / Avg. batch time: 452.4640 (ms) / GPU bubble ratio: 13.39%
[rank2]:2025-11-02 00:10:44,633 - INFO - Avg. fwd time: 7.1984 / Avg. bwd time: 16.1541 / Avg. batch time: 516.7796 (ms) / GPU bubble ratio: 63.85%
[rank1]:2025-11-02 00:10:44,669 - INFO - Avg. fwd time: 9.3863 / Avg. bwd time: 21.0506 / Avg. batch time: 552.4225 (ms) / GPU bubble ratio: 55.92%
[rank2]:2025-11-02 00:10:44,772 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-02 00:10:44,773 - INFO -  step: 400  loss: -2.0000  grad_norm:  0.0700  memory: 11.90GiB(25.06%)  tps: 7,343  tflops: 55.92  mfu: 17.92%
[rank2]:2025-11-02 00:10:44,773 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-11-02 00:10:44,773 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.47/0.47, [MB5] 0.10/0.10, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank0]:2025-11-02 00:10:44,774 - INFO -  step: 400  loss: -2.0000  grad_norm:  0.0700  memory: 17.04GiB(35.87%)  tps: 7,344  tflops: 55.93  mfu: 17.93%
[rank0]:2025-11-02 00:10:44,774 - INFO - ðŸ”Ž  Running validation at step 400
[rank1]:2025-11-02 00:10:44,774 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.21/0.21, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.78/0.78, [MB6] 0.94/0.94, [MB7] 1.00/1.00
[rank1]:2025-11-02 00:10:44,775 - INFO -  step: 400  loss: -2.0000  grad_norm:  0.0700  memory: 14.99GiB(31.56%)  tps: 7,343  tflops: 55.92  mfu: 17.92%
[rank1]:2025-11-02 00:10:44,775 - INFO - ðŸ”Ž  Running validation at step 400
[rank3]:2025-11-02 00:10:47,315 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.40/0.40, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-11-02 00:10:47,319 - INFO -  step: 400  loss:  0.2522  grad_norm:  0.0700  memory: 31.14GiB(65.55%)  tps: 7,329  tflops: 55.82  mfu: 17.89%
[rank3]:2025-11-02 00:10:47,319 - INFO - ðŸ”Ž  Running validation at step 400
[rank2]:2025-11-02 00:11:07,910 - INFO - validate step: 400  loss: -1.0000  memory: 11.90GiB(25.06%)  tps: 17,704
[rank3]:2025-11-02 00:11:07,903 - INFO - validate step: 400  loss:  0.9501  memory: 31.14GiB(65.55%)  tps: 19,900
[rank0]:2025-11-02 00:11:07,871 - INFO - validate step: 400  loss: -1.0000  memory: 17.04GiB(35.87%)  tps: 17,734
[rank1]:2025-11-02 00:11:07,892 - INFO - validate step: 400  loss: -1.0000  memory: 14.99GiB(31.56%)  tps: 17,719
[rank2]:2025-11-02 00:11:07,985 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251102_0011_stage2_step400.svg
[rank0]:2025-11-02 00:11:07,987 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251102_0011_stage0_step400.svg
[rank1]:2025-11-02 00:11:07,987 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251102_0011_stage1_step400.svg
[rank3]:2025-11-02 00:11:08,103 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule/251102_0011_real_step400_rank3.svg
[rank3]:> Batch Time: 347.36 ms, GPU Bubble Ratio: 51.03%, 46.17%, 57.48%, 18.69%
[rank3]:2025-11-02 00:11:08,174 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251102_0011_stage3_step400.svg
[rank0]:2025-11-02 00:11:57,350 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-11-02 00:11:58,157 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-02 00:11:58,158 - INFO -  step: 450  loss: -2.0000  grad_norm:  0.0000  memory: 11.90GiB(25.06%)  tps: 8,152  tflops: 62.08  mfu: 19.90%
[rank0]:2025-11-02 00:11:58,158 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.47/0.47, [MB5] 0.10/0.10, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank0]:2025-11-02 00:11:58,158 - INFO -  step: 450  loss: -2.0000  grad_norm:  0.0000  memory: 17.04GiB(35.87%)  tps: 8,145  tflops: 62.04  mfu: 19.88%
[rank1]:2025-11-02 00:11:58,158 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.21/0.21, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.78/0.78, [MB6] 0.94/0.94, [MB7] 1.00/1.00
[rank1]:2025-11-02 00:11:58,158 - INFO -  step: 450  loss: -2.0000  grad_norm:  0.0000  memory: 14.99GiB(31.56%)  tps: 8,149  tflops: 62.06  mfu: 19.89%
[rank3]:2025-11-02 00:12:00,609 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.40/0.40, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-11-02 00:12:00,613 - INFO -  step: 450  loss:  0.2664  grad_norm:  0.0000  memory: 31.14GiB(65.55%)  tps: 7,771  tflops: 59.19  mfu: 18.97%
[rank0]:2025-11-02 00:12:49,712 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-02 00:12:50,163 - INFO - Avg. fwd time: 8.4635 / Avg. bwd time: 15.8358 / Avg. batch time: 569.1920 (ms) / GPU bubble ratio: 65.85%
[rank3]:2025-11-02 00:12:50,340 - INFO - Avg. fwd time: 11.7790 / Avg. bwd time: 34.0822 / Avg. batch time: 427.2435 (ms) / GPU bubble ratio: 14.13%
[rank2]:2025-11-02 00:12:50,376 - INFO - Avg. fwd time: 7.4581 / Avg. bwd time: 14.4631 / Avg. batch time: 506.9502 (ms) / GPU bubble ratio: 65.41%
[rank1]:2025-11-02 00:12:50,421 - INFO - Avg. fwd time: 9.6898 / Avg. bwd time: 18.8452 / Avg. batch time: 540.3032 (ms) / GPU bubble ratio: 57.75%
[rank3]:2025-11-02 00:12:50,640 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251102_0012_rank3_trend_line.svg
[rank2]:2025-11-02 00:12:50,633 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251102_0012_rank2_trend_line.svg
[rank2]:2025-11-02 00:12:50,656 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-02 00:12:50,658 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-02 00:12:50,658 - INFO -  step: 500  loss: -2.0000  grad_norm:  0.0000  memory: 11.90GiB(25.06%)  tps: 7,802  tflops: 59.42  mfu: 19.05%
[rank0]:2025-11-02 00:12:50,647 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251102_0012_rank0_trend_line.svg
[rank0]:2025-11-02 00:12:50,656 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-11-02 00:12:50,658 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-11-02 00:12:50,658 - INFO -  step: 500  loss: -2.0000  grad_norm:  0.0000  memory: 17.04GiB(35.87%)  tps: 7,802  tflops: 59.42  mfu: 19.05%
[rank1]:2025-11-02 00:12:50,649 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251102_0012_rank1_trend_line.svg
[rank1]:2025-11-02 00:12:50,656 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-11-02 00:12:50,658 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-11-02 00:12:50,658 - INFO -  step: 500  loss: -2.0000  grad_norm:  0.0000  memory: 14.99GiB(31.56%)  tps: 7,802  tflops: 59.42  mfu: 19.05%
[rank3]:2025-11-02 00:12:50,859 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule/251102_0012_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 314.65 ms, GPU Bubble Ratio: 62.57%, 44.12%, 58.15%, 16.81%
[rank3]:2025-11-02 00:12:50,860 - INFO - 	> Batch Time: 314.65 ms (Average Freeze Ratio: 0.29)
[rank3]:2025-11-02 00:12:50,860 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 0.40/0.40, [MB7] 0.00/0.00
[rank3]:2025-11-02 00:12:53,337 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 0.40/0.40, [MB7] 0.00/0.00
[rank3]:2025-11-02 00:12:53,340 - INFO -  step: 500  loss:  0.2993  grad_norm:  0.0000  memory: 31.14GiB(65.55%)  tps: 7,769  tflops: 59.17  mfu: 18.96%
[rank1]:2025-11-02 00:12:53,413 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251102_0012_stage1_step500.svg
[rank2]:2025-11-02 00:12:53,408 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251102_0012_stage2_step500.svg
[rank0]:2025-11-02 00:12:53,408 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251102_0012_stage0_step500.svg
[rank3]:2025-11-02 00:12:53,527 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule/251102_0012_real_step500_rank3.svg
[rank3]:> Batch Time: 320.32 ms, GPU Bubble Ratio: 77.20%, 46.67%, 58.71%, 14.63%
[rank3]:2025-11-02 00:12:53,592 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251102_0012_stage3_step500.svg
[rank0]:2025-11-02 00:13:55,201 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 00:13:56,272 - INFO -  step: 550  loss: -2.0000  grad_norm:  0.0000  memory: 11.90GiB(25.06%)  tps: 6,243  tflops: 47.54  mfu: 15.24%
[rank0]:2025-11-02 00:13:56,273 - INFO -  step: 550  loss: -2.0000  grad_norm:  0.0000  memory: 17.04GiB(35.87%)  tps: 6,243  tflops: 47.54  mfu: 15.24%
[rank1]:2025-11-02 00:13:56,273 - INFO -  step: 550  loss: -2.0000  grad_norm:  0.0000  memory: 14.99GiB(31.56%)  tps: 6,243  tflops: 47.54  mfu: 15.24%
[rank3]:2025-11-02 00:13:58,750 - INFO -  step: 550  loss:  0.2684  grad_norm:  0.0957  memory: 31.14GiB(65.55%)  tps: 6,262  tflops: 47.69  mfu: 15.29%
[rank0]:2025-11-02 00:15:00,640 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 00:15:01,682 - INFO - Avg. fwd time: 11.6075 / Avg. bwd time: 34.8703 / Avg. batch time: 432.0572 (ms) / GPU bubble ratio: 13.94%
[rank0]:2025-11-02 00:15:01,718 - INFO - Avg. fwd time: 8.5797 / Avg. bwd time: 13.0649 / Avg. batch time: 577.6388 (ms) / GPU bubble ratio: 70.02%
[rank2]:2025-11-02 00:15:01,697 - INFO - Avg. fwd time: 7.6256 / Avg. bwd time: 13.3434 / Avg. batch time: 519.8532 (ms) / GPU bubble ratio: 67.73%
[rank1]:2025-11-02 00:15:01,713 - INFO - Avg. fwd time: 9.8902 / Avg. bwd time: 17.3709 / Avg. batch time: 551.6643 (ms) / GPU bubble ratio: 60.47%
[rank2]:2025-11-02 00:15:01,856 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251102_0015_rank2_trend_line.svg
[rank1]:2025-11-02 00:15:01,878 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251102_0015_rank1_trend_line.svg
[rank1]:2025-11-02 00:15:01,885 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-11-02 00:15:01,887 - INFO -  step: 600  loss: -2.0000  grad_norm:  0.0000  memory: 14.99GiB(31.56%)  tps: 6,243  tflops: 47.54  mfu: 15.24%
[rank1]:2025-11-02 00:15:01,887 - INFO - ðŸ”Ž  Running validation at step 600
[rank3]:2025-11-02 00:15:01,873 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251102_0015_rank3_trend_line.svg
[rank0]:2025-11-02 00:15:01,879 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251102_0015_rank0_trend_line.svg
[rank0]:2025-11-02 00:15:01,885 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-11-02 00:15:01,887 - INFO -  step: 600  loss: -2.0000  grad_norm:  0.0000  memory: 17.04GiB(35.87%)  tps: 6,243  tflops: 47.55  mfu: 15.24%
[rank0]:2025-11-02 00:15:01,887 - INFO - ðŸ”Ž  Running validation at step 600
[rank2]:2025-11-02 00:15:01,885 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-02 00:15:01,887 - INFO -  step: 600  loss: -2.0000  grad_norm:  0.0000  memory: 11.90GiB(25.06%)  tps: 6,243  tflops: 47.54  mfu: 15.24%
[rank2]:2025-11-02 00:15:01,887 - INFO - ðŸ”Ž  Running validation at step 600
[rank3]:2025-11-02 00:15:02,085 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule/251102_0015_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 359.46 ms, GPU Bubble Ratio: 73.07%, 53.48%, 64.57%, 14.53%
[rank3]:2025-11-02 00:15:02,085 - INFO - 	> Batch Time: 359.46 ms (Average Freeze Ratio: 0.09)
[rank3]:2025-11-02 00:15:02,086 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank3]:2025-11-02 00:15:04,581 - INFO -  step: 600  loss:  0.2219  grad_norm:  0.1036  memory: 31.14GiB(65.55%)  tps: 6,222  tflops: 47.39  mfu: 15.19%
[rank3]:2025-11-02 00:15:04,581 - INFO - ðŸ”Ž  Running validation at step 600
[rank1]:2025-11-02 00:15:23,628 - INFO - validate step: 600  loss: -1.0000  memory: 14.99GiB(31.56%)  tps: 18,841
[rank3]:2025-11-02 00:15:23,637 - INFO - validate step: 600  loss:  0.9459  memory: 31.14GiB(65.55%)  tps: 21,496
[rank0]:2025-11-02 00:15:23,608 - INFO - validate step: 600  loss: -1.0000  memory: 17.04GiB(35.87%)  tps: 18,857
[rank2]:2025-11-02 00:15:23,642 - INFO - validate step: 600  loss: -1.0000  memory: 11.90GiB(25.06%)  tps: 18,828
[rank1]:2025-11-02 00:15:23,717 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251102_0015_stage1_step600.svg
[rank0]:2025-11-02 00:15:23,717 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251102_0015_stage0_step600.svg
[rank2]:2025-11-02 00:15:23,716 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251102_0015_stage2_step600.svg
[rank3]:2025-11-02 00:15:23,824 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule/251102_0015_real_step600_rank3.svg
[rank3]:> Batch Time: 451.15 ms, GPU Bubble Ratio: 83.80%, 62.37%, 70.79%, 10.59%
[rank3]:2025-11-02 00:15:23,890 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251102_0015_stage3_step600.svg
[rank0]:2025-11-02 00:16:28,653 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-11-02 00:16:29,781 - INFO -  step: 650  loss: -2.0000  grad_norm:  0.0000  memory: 17.04GiB(35.87%)  tps: 6,190  tflops: 47.14  mfu: 15.11%
[rank2]:2025-11-02 00:16:29,780 - INFO -  step: 650  loss: -2.0000  grad_norm:  0.0000  memory: 11.90GiB(25.06%)  tps: 6,193  tflops: 47.17  mfu: 15.12%
[rank1]:2025-11-02 00:16:29,781 - INFO -  step: 650  loss: -2.0000  grad_norm:  0.0000  memory: 14.99GiB(31.56%)  tps: 6,192  tflops: 47.16  mfu: 15.11%
[rank3]:2025-11-02 00:16:32,267 - INFO -  step: 650  loss:  0.3653  grad_norm:  0.2455  memory: 31.14GiB(65.55%)  tps: 5,968  tflops: 45.46  mfu: 14.57%
[rank0]:2025-11-02 00:17:36,941 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-02 00:17:37,549 - INFO - Avg. fwd time: 8.6542 / Avg. bwd time: 11.3610 / Avg. batch time: 588.1040 (ms) / GPU bubble ratio: 72.77%
[rank2]:2025-11-02 00:17:37,780 - INFO - Avg. fwd time: 7.7289 / Avg. bwd time: 12.6538 / Avg. batch time: 533.0566 (ms) / GPU bubble ratio: 69.41%
[rank3]:2025-11-02 00:17:37,836 - INFO - Avg. fwd time: 11.4822 / Avg. bwd time: 35.9485 / Avg. batch time: 439.6014 (ms) / GPU bubble ratio: 13.68%
[rank1]:2025-11-02 00:17:37,870 - INFO - Avg. fwd time: 10.0138 / Avg. bwd time: 16.4624 / Avg. batch time: 563.9179 (ms) / GPU bubble ratio: 62.44%
[rank2]:2025-11-02 00:17:38,052 - INFO -  step: 700  loss: -2.0000  grad_norm:  0.0000  memory: 11.90GiB(25.06%)  tps: 6,000  tflops: 45.69  mfu: 14.65%
[rank0]:2025-11-02 00:17:38,053 - INFO -  step: 700  loss: -2.0000  grad_norm:  0.0000  memory: 17.04GiB(35.87%)  tps: 6,000  tflops: 45.70  mfu: 14.65%
[rank1]:2025-11-02 00:17:38,053 - INFO -  step: 700  loss: -2.0000  grad_norm:  0.0000  memory: 14.99GiB(31.56%)  tps: 6,000  tflops: 45.70  mfu: 14.65%
[rank3]:2025-11-02 00:17:40,533 - INFO -  step: 700  loss:  0.2381  grad_norm:  0.1990  memory: 31.14GiB(65.55%)  tps: 6,000  tflops: 45.70  mfu: 14.65%
[rank0]:2025-11-02 00:17:40,610 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251102_0017_stage0_step700.svg
[rank2]:2025-11-02 00:17:40,609 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251102_0017_stage2_step700.svg
[rank1]:2025-11-02 00:17:40,619 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251102_0017_stage1_step700.svg
[rank3]:2025-11-02 00:17:40,721 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule/251102_0017_real_step700_rank3.svg
[rank3]:> Batch Time: 477.27 ms, GPU Bubble Ratio: 84.64%, 64.40%, 72.37%, 10.05%
[rank3]:2025-11-02 00:17:40,793 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251102_0017_stage3_step700.svg
[rank0]:2025-11-02 00:18:45,407 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 00:18:46,541 - INFO -  step: 750  loss: -2.0000  grad_norm:  0.0000  memory: 11.90GiB(25.06%)  tps: 5,981  tflops: 45.55  mfu: 14.60%
[rank1]:2025-11-02 00:18:46,541 - INFO -  step: 750  loss: -2.0000  grad_norm:  0.0000  memory: 14.99GiB(31.56%)  tps: 5,981  tflops: 45.55  mfu: 14.60%
[rank0]:2025-11-02 00:18:46,541 - INFO -  step: 750  loss: -2.0000  grad_norm:  0.0000  memory: 17.04GiB(35.87%)  tps: 5,981  tflops: 45.55  mfu: 14.60%
[rank3]:2025-11-02 00:18:49,170 - INFO -  step: 750  loss:  0.2278  grad_norm:  0.1944  memory: 31.14GiB(65.55%)  tps: 5,968  tflops: 45.45  mfu: 14.57%
[rank0]:2025-11-02 00:19:54,065 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-02 00:19:54,678 - INFO - Avg. fwd time: 8.7173 / Avg. bwd time: 9.8608 / Avg. batch time: 598.4058 (ms) / GPU bubble ratio: 75.16%
[rank2]:2025-11-02 00:19:54,911 - INFO - Avg. fwd time: 7.8190 / Avg. bwd time: 12.0440 / Avg. batch time: 545.7774 (ms) / GPU bubble ratio: 70.88%
[rank3]:2025-11-02 00:19:54,965 - INFO - Avg. fwd time: 11.3729 / Avg. bwd time: 36.8841 / Avg. batch time: 446.1464 (ms) / GPU bubble ratio: 13.47%
[rank1]:2025-11-02 00:19:55,001 - INFO - Avg. fwd time: 10.1211 / Avg. bwd time: 15.6609 / Avg. batch time: 575.7987 (ms) / GPU bubble ratio: 64.18%
[rank3]:2025-11-02 00:19:55,398 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251102_0019_rank3_trend_line.svg
[rank2]:2025-11-02 00:19:55,374 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251102_0019_rank2_trend_line.svg
[rank2]:2025-11-02 00:19:55,405 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-02 00:19:55,407 - INFO -  step: 800  loss: -2.0000  grad_norm:  0.0000  memory: 11.90GiB(25.06%)  tps: 5,948  tflops: 45.30  mfu: 14.52%
[rank2]:2025-11-02 00:19:55,408 - INFO - ðŸ”Ž  Running validation at step 800
[rank1]:2025-11-02 00:19:55,393 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251102_0019_rank1_trend_line.svg
[rank1]:2025-11-02 00:19:55,405 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-11-02 00:19:55,408 - INFO -  step: 800  loss: -2.0000  grad_norm:  0.0000  memory: 14.99GiB(31.56%)  tps: 5,948  tflops: 45.30  mfu: 14.52%
[rank1]:2025-11-02 00:19:55,408 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-11-02 00:19:55,388 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251102_0019_rank0_trend_line.svg
[rank0]:2025-11-02 00:19:55,405 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank0]:2025-11-02 00:19:55,407 - INFO -  step: 800  loss: -2.0000  grad_norm:  0.0000  memory: 17.04GiB(35.87%)  tps: 5,948  tflops: 45.30  mfu: 14.52%
[rank0]:2025-11-02 00:19:55,407 - INFO - ðŸ”Ž  Running validation at step 800
[rank3]:2025-11-02 00:19:55,626 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule/251102_0019_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 370.82 ms, GPU Bubble Ratio: 77.62%, 56.35%, 66.52%, 13.70%
[rank3]:2025-11-02 00:19:55,626 - INFO - 	> Batch Time: 370.82 ms (Average Freeze Ratio: 0.26)
[rank3]:2025-11-02 00:19:55,627 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 0.40/0.40, [MB7] 0.00/0.00
[rank3]:2025-11-02 00:19:58,115 - INFO -  step: 800  loss:  0.2626  grad_norm:  0.3536  memory: 31.14GiB(65.55%)  tps: 5,941  tflops: 45.25  mfu: 14.50%
[rank3]:2025-11-02 00:19:58,115 - INFO - ðŸ”Ž  Running validation at step 800
[rank1]:2025-11-02 00:20:17,182 - INFO - validate step: 800  loss: -1.0000  memory: 14.99GiB(31.56%)  tps: 18,811
[rank0]:2025-11-02 00:20:17,161 - INFO - validate step: 800  loss: -1.0000  memory: 17.04GiB(35.87%)  tps: 18,829
[rank3]:2025-11-02 00:20:17,193 - INFO - validate step: 800  loss:  0.9441  memory: 31.14GiB(65.55%)  tps: 21,471
[rank2]:2025-11-02 00:20:17,198 - INFO - validate step: 800  loss: -1.0000  memory: 11.90GiB(25.06%)  tps: 18,798
[rank2]:2025-11-02 00:20:17,274 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251102_0020_stage2_step800.svg
[rank1]:2025-11-02 00:20:17,276 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251102_0020_stage1_step800.svg
[rank0]:2025-11-02 00:20:17,274 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251102_0020_stage0_step800.svg
[rank3]:2025-11-02 00:20:17,387 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule/251102_0020_real_step800_rank3.svg
[rank3]:> Batch Time: 474.92 ms, GPU Bubble Ratio: 84.61%, 64.26%, 72.30%, 10.10%
[rank3]:2025-11-02 00:20:17,464 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251102_0020_stage3_step800.svg
[rank3]:2025-11-02 00:20:31,797 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-11-02 00:20:32,005 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-11-02 00:20:32,016 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-11-02 00:20:32,044 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-11-02 00:21:22,878 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-11-02 00:21:23,978 - INFO -  step: 850  loss: -2.0000  grad_norm:  0.0000  memory: 14.99GiB(31.56%)  tps: 6,132  tflops: 46.70  mfu: 14.97%
[rank2]:2025-11-02 00:21:23,978 - INFO -  step: 850  loss: -2.0000  grad_norm:  0.0000  memory: 11.90GiB(25.06%)  tps: 6,134  tflops: 46.71  mfu: 14.97%
[rank0]:2025-11-02 00:21:24,007 - INFO -  step: 850  loss: -2.0000  grad_norm:  0.8813  memory: 17.04GiB(35.87%)  tps: 6,128  tflops: 46.67  mfu: 14.96%
[rank3]:2025-11-02 00:21:26,468 - INFO -  step: 850  loss:  0.2112  grad_norm:  0.8813  memory: 31.14GiB(65.55%)  tps: 5,913  tflops: 45.03  mfu: 14.43%
[rank0]:2025-11-02 00:22:31,560 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 00:22:32,633 - INFO - Avg. fwd time: 11.2828 / Avg. bwd time: 37.1849 / Avg. batch time: 447.7764 (ms) / GPU bubble ratio: 13.41%
[rank2]:2025-11-02 00:22:32,648 - INFO - Avg. fwd time: 7.8880 / Avg. bwd time: 11.5764 / Avg. batch time: 550.3800 (ms) / GPU bubble ratio: 71.71%
[rank1]:2025-11-02 00:22:32,665 - INFO - Avg. fwd time: 10.2035 / Avg. bwd time: 15.0464 / Avg. batch time: 579.7561 (ms) / GPU bubble ratio: 65.16%
[rank1]:2025-11-02 00:22:32,704 - INFO -  step: 900  loss: -2.0000  grad_norm:  0.0000  memory: 14.99GiB(31.56%)  tps: 5,960  tflops: 45.39  mfu: 14.55%
[rank2]:2025-11-02 00:22:32,704 - INFO -  step: 900  loss: -2.0000  grad_norm:  0.0000  memory: 11.90GiB(25.06%)  tps: 5,960  tflops: 45.39  mfu: 14.55%
[rank0]:2025-11-02 00:22:32,695 - INFO - Avg. fwd time: 8.6424 / Avg. bwd time: 11.3259 / Avg. batch time: 603.8650 (ms) / GPU bubble ratio: 73.55%
[rank0]:2025-11-02 00:22:32,732 - INFO -  step: 900  loss: -2.0000  grad_norm:  0.4070  memory: 17.04GiB(35.87%)  tps: 5,960  tflops: 45.39  mfu: 14.55%
[rank3]:2025-11-02 00:22:35,192 - INFO -  step: 900  loss:  0.2302  grad_norm:  0.4070  memory: 31.14GiB(65.55%)  tps: 5,960  tflops: 45.39  mfu: 14.55%
[rank1]:2025-11-02 00:22:35,276 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251102_0022_stage1_step900.svg
[rank2]:2025-11-02 00:22:35,287 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251102_0022_stage2_step900.svg
[rank0]:2025-11-02 00:22:35,287 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251102_0022_stage0_step900.svg
[rank3]:2025-11-02 00:22:35,378 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule/251102_0022_real_step900_rank3.svg
[rank3]:> Batch Time: 470.20 ms, GPU Bubble Ratio: 46.05%, 63.94%, 72.05%, 15.47%
[rank3]:2025-11-02 00:22:35,442 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251102_0022_stage3_step900.svg
[rank0]:2025-11-02 00:23:40,632 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-02 00:23:41,766 - INFO -  step: 950  loss: -2.0000  grad_norm:  0.0000  memory: 14.99GiB(31.56%)  tps: 5,931  tflops: 45.17  mfu: 14.48%
[rank2]:2025-11-02 00:23:41,766 - INFO -  step: 950  loss: -2.0000  grad_norm:  0.0000  memory: 11.90GiB(25.06%)  tps: 5,931  tflops: 45.17  mfu: 14.48%
[rank0]:2025-11-02 00:23:41,793 - INFO -  step: 950  loss: -2.0000  grad_norm:  0.3610  memory: 17.04GiB(35.87%)  tps: 5,931  tflops: 45.17  mfu: 14.48%
[rank3]:2025-11-02 00:23:44,238 - INFO -  step: 950  loss:  0.1973  grad_norm:  0.3610  memory: 31.14GiB(65.55%)  tps: 5,932  tflops: 45.18  mfu: 14.48%
[rank0]:2025-11-02 00:24:49,408 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-02 00:24:50,328 - INFO - Avg. fwd time: 10.2592 / Avg. bwd time: 14.6219 / Avg. batch time: 582.5773 (ms) / GPU bubble ratio: 65.83%
[rank3]:2025-11-02 00:24:50,269 - INFO - Avg. fwd time: 11.2187 / Avg. bwd time: 37.3672 / Avg. batch time: 448.6816 (ms) / GPU bubble ratio: 13.37%
[rank2]:2025-11-02 00:24:50,249 - INFO - Avg. fwd time: 7.9350 / Avg. bwd time: 11.2534 / Avg. batch time: 553.6477 (ms) / GPU bubble ratio: 72.27%
[rank0]:2025-11-02 00:24:50,383 - INFO - Avg. fwd time: 8.5872 / Avg. bwd time: 12.4475 / Avg. batch time: 607.8390 (ms) / GPU bubble ratio: 72.32%
[rank1]:2025-11-02 00:24:50,534 - INFO -  step: 1000  loss: -2.0000  grad_norm:  0.0000  memory: 14.99GiB(31.56%)  tps: 5,956  tflops: 45.36  mfu: 14.54%
[rank1]:2025-11-02 00:24:50,534 - INFO - ðŸ”Ž  Running validation at step 1000
[rank2]:2025-11-02 00:24:50,533 - INFO -  step: 1000  loss: -2.0000  grad_norm:  0.0000  memory: 11.90GiB(25.06%)  tps: 5,956  tflops: 45.36  mfu: 14.54%
[rank2]:2025-11-02 00:24:50,533 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-11-02 00:24:50,562 - INFO -  step: 1000  loss: -2.0000  grad_norm:  0.6921  memory: 17.04GiB(35.87%)  tps: 5,956  tflops: 45.36  mfu: 14.54%
[rank0]:2025-11-02 00:24:50,562 - INFO - ðŸ”Ž  Running validation at step 1000
[rank3]:2025-11-02 00:24:53,015 - INFO -  step: 1000  loss:  0.2811  grad_norm:  0.6921  memory: 31.14GiB(65.55%)  tps: 5,956  tflops: 45.36  mfu: 14.54%
[rank3]:2025-11-02 00:24:53,016 - INFO - ðŸ”Ž  Running validation at step 1000
[rank1]:2025-11-02 00:25:12,016 - INFO - validate step: 1000  loss: -1.0000  memory: 14.99GiB(31.56%)  tps: 19,067
[rank3]:2025-11-02 00:25:12,025 - INFO - validate step: 1000  loss:  0.9376  memory: 31.14GiB(65.55%)  tps: 21,549
[rank2]:2025-11-02 00:25:12,031 - INFO - validate step: 1000  loss: -1.0000  memory: 11.90GiB(25.06%)  tps: 19,054
[rank0]:2025-11-02 00:25:12,002 - INFO - validate step: 1000  loss: -1.0000  memory: 17.04GiB(35.87%)  tps: 19,105
[rank1]:2025-11-02 00:25:12,104 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251102_0025_stage1_step1000.svg
[rank2]:2025-11-02 00:25:12,102 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251102_0025_stage2_step1000.svg
[rank0]:2025-11-02 00:25:12,102 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251102_0025_stage0_step1000.svg
[rank3]:2025-11-02 00:25:12,222 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule/251102_0025_real_step1000_rank3.svg
[rank3]:> Batch Time: 470.42 ms, GPU Bubble Ratio: 46.14%, 63.98%, 72.08%, 15.51%
[rank3]:2025-11-02 00:25:12,290 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251102_0025_stage3_step1000.svg
[rank0]:2025-11-02 00:26:17,601 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-11-02 00:26:18,738 - INFO -  step: 1050  loss: -2.0000  grad_norm:  0.0000  memory: 14.99GiB(31.56%)  tps: 6,139  tflops: 46.76  mfu: 14.99%
[rank2]:2025-11-02 00:26:18,738 - INFO -  step: 1050  loss: -2.0000  grad_norm:  0.0000  memory: 11.90GiB(25.06%)  tps: 6,140  tflops: 46.77  mfu: 14.99%
[rank0]:2025-11-02 00:26:18,765 - INFO -  step: 1050  loss: -2.0000  grad_norm:  0.9857  memory: 17.04GiB(35.87%)  tps: 6,135  tflops: 46.73  mfu: 14.98%
[rank3]:2025-11-02 00:26:21,213 - INFO -  step: 1050  loss:  0.3034  grad_norm:  0.9857  memory: 31.14GiB(65.55%)  tps: 5,920  tflops: 45.09  mfu: 14.45%
[rank0]:2025-11-02 00:27:26,328 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 00:27:27,153 - INFO - Avg. fwd time: 7.9800 / Avg. bwd time: 10.9443 / Avg. batch time: 557.5736 (ms) / GPU bubble ratio: 72.85%
[rank3]:2025-11-02 00:27:27,179 - INFO - Avg. fwd time: 11.1558 / Avg. bwd time: 37.5358 / Avg. batch time: 449.4891 (ms) / GPU bubble ratio: 13.34%
[rank1]:2025-11-02 00:27:27,238 - INFO - Avg. fwd time: 10.3116 / Avg. bwd time: 14.2150 / Avg. batch time: 586.0752 (ms) / GPU bubble ratio: 66.52%
[rank0]:2025-11-02 00:27:27,292 - INFO - Avg. fwd time: 8.5330 / Avg. bwd time: 13.5215 / Avg. batch time: 612.4394 (ms) / GPU bubble ratio: 71.19%
[rank1]:2025-11-02 00:27:27,440 - INFO -  step: 1100  loss: -2.0000  grad_norm:  0.0000  memory: 14.99GiB(31.56%)  tps: 5,962  tflops: 45.41  mfu: 14.55%
[rank2]:2025-11-02 00:27:27,440 - INFO -  step: 1100  loss: -2.0000  grad_norm:  0.0000  memory: 11.90GiB(25.06%)  tps: 5,962  tflops: 45.41  mfu: 14.55%
[rank0]:2025-11-02 00:27:27,468 - INFO -  step: 1100  loss: -2.0000  grad_norm:  0.5243  memory: 17.04GiB(35.87%)  tps: 5,962  tflops: 45.41  mfu: 14.55%
[rank3]:2025-11-02 00:27:29,934 - INFO -  step: 1100  loss:  0.3308  grad_norm:  0.5243  memory: 31.14GiB(65.55%)  tps: 5,961  tflops: 45.40  mfu: 14.55%
[rank1]:2025-11-02 00:27:30,008 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251102_0027_stage1_step1100.svg
[rank0]:2025-11-02 00:27:30,005 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251102_0027_stage0_step1100.svg
[rank2]:2025-11-02 00:27:30,004 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251102_0027_stage2_step1100.svg
[rank3]:2025-11-02 00:27:30,128 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule/251102_0027_real_step1100_rank3.svg
[rank3]:> Batch Time: 468.28 ms, GPU Bubble Ratio: 45.95%, 63.82%, 71.92%, 15.52%
[rank3]:2025-11-02 00:27:30,197 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251102_0027_stage3_step1100.svg
[rank0]:2025-11-02 00:28:35,320 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-02 00:28:36,455 - INFO -  step: 1150  loss: -2.0000  grad_norm:  0.0000  memory: 14.99GiB(31.56%)  tps: 5,935  tflops: 45.20  mfu: 14.49%
[rank0]:2025-11-02 00:28:36,482 - INFO -  step: 1150  loss: -2.0000  grad_norm:  0.4049  memory: 17.04GiB(35.87%)  tps: 5,935  tflops: 45.20  mfu: 14.49%
[rank2]:2025-11-02 00:28:36,455 - INFO -  step: 1150  loss: -2.0000  grad_norm:  0.0000  memory: 11.90GiB(25.06%)  tps: 5,935  tflops: 45.20  mfu: 14.49%
[rank3]:2025-11-02 00:28:38,999 - INFO -  step: 1150  loss:  0.2467  grad_norm:  0.4049  memory: 31.14GiB(65.55%)  tps: 5,931  tflops: 45.17  mfu: 14.48%
[rank0]:2025-11-02 00:29:44,226 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 00:29:45,339 - INFO - Avg. fwd time: 8.0172 / Avg. bwd time: 10.6893 / Avg. batch time: 559.8114 (ms) / GPU bubble ratio: 73.27%
[rank3]:2025-11-02 00:29:45,323 - INFO - Avg. fwd time: 11.1053 / Avg. bwd time: 37.6768 / Avg. batch time: 450.1812 (ms) / GPU bubble ratio: 13.31%
[rank1]:2025-11-02 00:29:45,357 - INFO - Avg. fwd time: 10.3548 / Avg. bwd time: 13.8796 / Avg. batch time: 587.9616 (ms) / GPU bubble ratio: 67.03%
[rank0]:2025-11-02 00:29:45,388 - INFO - Avg. fwd time: 8.4880 / Avg. bwd time: 14.4097 / Avg. batch time: 615.2382 (ms) / GPU bubble ratio: 70.23%
[rank3]:2025-11-02 00:29:45,667 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251102_0029_rank3_trend_line.svg
[rank1]:2025-11-02 00:29:45,675 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251102_0029_rank1_trend_line.svg
[rank1]:2025-11-02 00:29:45,710 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank1]:2025-11-02 00:29:45,712 - INFO -  step: 1200  loss: -2.0000  grad_norm:  0.0000  memory: 14.99GiB(31.56%)  tps: 5,914  tflops: 45.04  mfu: 14.44%
[rank1]:2025-11-02 00:29:45,712 - INFO - ðŸ”Ž  Running validation at step 1200
[rank0]:2025-11-02 00:29:45,703 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251102_0029_rank0_trend_line.svg
[rank0]:2025-11-02 00:29:45,710 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-11-02 00:29:45,712 - INFO -  step: 1200  loss: -2.0000  grad_norm:  0.6618  memory: 17.04GiB(35.87%)  tps: 5,917  tflops: 45.06  mfu: 14.44%
[rank0]:2025-11-02 00:29:45,712 - INFO - ðŸ”Ž  Running validation at step 1200
[rank2]:2025-11-02 00:29:45,646 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251102_0029_rank2_trend_line.svg
[rank2]:2025-11-02 00:29:45,710 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-02 00:29:45,712 - INFO -  step: 1200  loss: -2.0000  grad_norm:  0.0000  memory: 11.90GiB(25.06%)  tps: 5,914  tflops: 45.04  mfu: 14.44%
[rank2]:2025-11-02 00:29:45,712 - INFO - ðŸ”Ž  Running validation at step 1200
[rank3]:2025-11-02 00:29:45,901 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule/251102_0029_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 413.96 ms, GPU Bubble Ratio: 62.24%, 61.77%, 70.56%, 11.79%
[rank3]:2025-11-02 00:29:45,902 - INFO - 	> Batch Time: 413.96 ms (Average Freeze Ratio: 0.26)
[rank3]:2025-11-02 00:29:45,902 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 0.40/0.40, [MB7] 0.00/0.00
[rank3]:2025-11-02 00:29:48,378 - INFO -  step: 1200  loss:  0.1963  grad_norm:  0.6618  memory: 31.14GiB(65.55%)  tps: 5,904  tflops: 44.97  mfu: 14.41%
[rank3]:2025-11-02 00:29:48,378 - INFO - ðŸ”Ž  Running validation at step 1200
[rank3]:2025-11-02 00:30:07,488 - INFO - validate step: 1200  loss:  0.9372  memory: 31.14GiB(65.55%)  tps: 21,435
[rank3]:2025-11-02 00:30:07,489 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-11-02 00:30:07,478 - INFO - validate step: 1200  loss: -1.0000  memory: 14.99GiB(31.56%)  tps: 18,819
[rank1]:2025-11-02 00:30:07,478 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-02 00:30:07,468 - INFO - validate step: 1200  loss: -1.0000  memory: 17.04GiB(35.87%)  tps: 18,828
[rank0]:2025-11-02 00:30:07,469 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-02 00:30:07,477 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank2]:2025-11-02 00:30:07,496 - INFO - validate step: 1200  loss: -1.0000  memory: 11.90GiB(25.06%)  tps: 18,804
[rank2]:2025-11-02 00:30:07,497 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-02 00:30:09,349 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 1.85 seconds.
[rank1]:2025-11-02 00:30:10,233 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 2.75 seconds.
[rank0]:2025-11-02 00:30:11,184 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-11-02 00:30:11,192 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.72 seconds.
[rank3]:2025-11-02 00:30:11,272 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.78 seconds.
[rank1]:2025-11-02 00:30:11,355 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251102_0030_stage1_step1200.svg
[rank0]:2025-11-02 00:30:11,353 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251102_0030_stage0_step1200.svg
[rank2]:2025-11-02 00:30:11,353 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251102_0030_stage2_step1200.svg
[rank3]:2025-11-02 00:30:11,637 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule/251102_0030_real_step1200_rank3.svg
[rank3]:> Batch Time: 469.88 ms, GPU Bubble Ratio: 45.94%, 63.92%, 72.02%, 15.43%
[rank3]:2025-11-02 00:30:11,707 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251102_0030_stage3_step1200.svg
[rank0]:2025-11-02 00:31:15,586 - INFO - [GC] Peforming periodical GC collection 0.26 seconds
[rank0]:2025-11-02 00:31:16,683 - INFO -  step: 1250  loss: -2.0000  grad_norm:  0.0000  memory: 17.04GiB(35.87%)  tps: 5,918  tflops: 45.07  mfu: 14.45%
[rank1]:2025-11-02 00:31:16,703 - INFO -  step: 1250  loss: -2.0000  grad_norm:  0.2112  memory: 14.99GiB(31.56%)  tps: 5,917  tflops: 45.06  mfu: 14.44%
[rank2]:2025-11-02 00:31:16,683 - INFO -  step: 1250  loss: -2.0000  grad_norm:  0.0000  memory: 11.90GiB(25.06%)  tps: 5,920  tflops: 45.09  mfu: 14.45%
[rank3]:2025-11-02 00:31:19,169 - INFO -  step: 1250  loss:  0.3226  grad_norm:  0.2112  memory: 31.14GiB(65.55%)  tps: 5,714  tflops: 43.52  mfu: 13.95%
[rank0]:2025-11-02 00:32:22,599 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-02 00:32:23,190 - INFO - Avg. fwd time: 8.5380 / Avg. bwd time: 13.4132 / Avg. batch time: 617.3410 (ms) / GPU bubble ratio: 71.55%
[rank2]:2025-11-02 00:32:23,413 - INFO - Avg. fwd time: 8.0446 / Avg. bwd time: 10.5050 / Avg. batch time: 562.1080 (ms) / GPU bubble ratio: 73.60%
[rank3]:2025-11-02 00:32:23,429 - INFO - Avg. fwd time: 11.0680 / Avg. bwd time: 37.7978 / Avg. batch time: 450.8355 (ms) / GPU bubble ratio: 13.29%
[rank1]:2025-11-02 00:32:23,555 - INFO - Avg. fwd time: 10.2631 / Avg. bwd time: 14.5652 / Avg. batch time: 590.9941 (ms) / GPU bubble ratio: 66.39%
[rank1]:2025-11-02 00:32:23,707 - INFO -  step: 1300  loss: -2.0000  grad_norm:  0.2497  memory: 14.99GiB(31.56%)  tps: 6,113  tflops: 46.56  mfu: 14.92%
[rank0]:2025-11-02 00:32:23,690 - INFO -  step: 1300  loss: -2.0000  grad_norm:  0.0000  memory: 17.04GiB(35.87%)  tps: 6,113  tflops: 46.56  mfu: 14.92%
[rank2]:2025-11-02 00:32:23,690 - INFO -  step: 1300  loss: -2.0000  grad_norm:  0.0000  memory: 11.90GiB(25.06%)  tps: 6,113  tflops: 46.56  mfu: 14.92%
[rank3]:2025-11-02 00:32:26,177 - INFO -  step: 1300  loss:  0.2755  grad_norm:  0.2497  memory: 31.14GiB(65.55%)  tps: 6,113  tflops: 46.56  mfu: 14.92%
[rank1]:2025-11-02 00:32:26,278 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251102_0032_stage1_step1300.svg
[rank0]:2025-11-02 00:32:26,278 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251102_0032_stage0_step1300.svg
[rank2]:2025-11-02 00:32:26,270 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251102_0032_stage2_step1300.svg
[rank3]:2025-11-02 00:32:26,382 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule/251102_0032_real_step1300_rank3.svg
[rank3]:> Batch Time: 463.21 ms, GPU Bubble Ratio: 84.27%, 43.48%, 71.59%, 13.06%
[rank3]:2025-11-02 00:32:26,451 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251102_0032_stage3_step1300.svg
[rank0]:2025-11-02 00:33:29,701 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-02 00:33:30,804 - INFO -  step: 1350  loss: -2.0000  grad_norm:  0.0000  memory: 17.04GiB(35.87%)  tps: 6,103  tflops: 46.48  mfu: 14.90%
[rank2]:2025-11-02 00:33:30,804 - INFO -  step: 1350  loss: -2.0000  grad_norm:  0.0000  memory: 11.90GiB(25.06%)  tps: 6,103  tflops: 46.48  mfu: 14.90%
[rank1]:2025-11-02 00:33:30,823 - INFO -  step: 1350  loss: -2.0000  grad_norm:  0.2173  memory: 14.99GiB(31.56%)  tps: 6,103  tflops: 46.48  mfu: 14.90%
[rank3]:2025-11-02 00:33:33,286 - INFO -  step: 1350  loss:  0.2727  grad_norm:  0.2173  memory: 31.14GiB(65.55%)  tps: 6,104  tflops: 46.49  mfu: 14.90%
[rank0]:2025-11-02 00:34:36,538 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-02 00:34:37,128 - INFO - Avg. fwd time: 8.5801 / Avg. bwd time: 12.4038 / Avg. batch time: 619.8700 (ms) / GPU bubble ratio: 72.92%
[rank3]:2025-11-02 00:34:37,379 - INFO - Avg. fwd time: 11.0300 / Avg. bwd time: 37.9134 / Avg. batch time: 451.4310 (ms) / GPU bubble ratio: 13.27%
[rank2]:2025-11-02 00:34:37,358 - INFO - Avg. fwd time: 8.0721 / Avg. bwd time: 10.3195 / Avg. batch time: 564.8295 (ms) / GPU bubble ratio: 73.95%
[rank1]:2025-11-02 00:34:37,504 - INFO - Avg. fwd time: 10.1717 / Avg. bwd time: 15.2608 / Avg. batch time: 594.4606 (ms) / GPU bubble ratio: 65.77%
[rank1]:2025-11-02 00:34:37,648 - INFO -  step: 1400  loss: -2.0000  grad_norm:  0.2075  memory: 14.99GiB(31.56%)  tps: 6,129  tflops: 46.68  mfu: 14.96%
[rank1]:2025-11-02 00:34:37,648 - INFO - ðŸ”Ž  Running validation at step 1400
[rank2]:2025-11-02 00:34:37,632 - INFO -  step: 1400  loss: -2.0000  grad_norm:  0.0000  memory: 11.90GiB(25.06%)  tps: 6,129  tflops: 46.68  mfu: 14.96%
[rank2]:2025-11-02 00:34:37,632 - INFO - ðŸ”Ž  Running validation at step 1400
[rank0]:2025-11-02 00:34:37,632 - INFO -  step: 1400  loss: -2.0000  grad_norm:  0.0000  memory: 17.04GiB(35.87%)  tps: 6,129  tflops: 46.68  mfu: 14.96%
[rank0]:2025-11-02 00:34:37,632 - INFO - ðŸ”Ž  Running validation at step 1400
[rank3]:2025-11-02 00:34:40,151 - INFO -  step: 1400  loss:  0.2420  grad_norm:  0.2075  memory: 31.14GiB(65.55%)  tps: 6,126  tflops: 46.66  mfu: 14.95%
[rank3]:2025-11-02 00:34:40,152 - INFO - ðŸ”Ž  Running validation at step 1400
[rank1]:2025-11-02 00:34:59,396 - INFO - validate step: 1400  loss: -1.0000  memory: 14.99GiB(31.56%)  tps: 18,834
[rank0]:2025-11-02 00:34:59,372 - INFO - validate step: 1400  loss: -1.0000  memory: 17.04GiB(35.87%)  tps: 18,841
[rank2]:2025-11-02 00:34:59,406 - INFO - validate step: 1400  loss: -1.0000  memory: 11.90GiB(25.06%)  tps: 18,812
[rank3]:2025-11-02 00:34:59,400 - INFO - validate step: 1400  loss:  0.9330  memory: 31.14GiB(65.55%)  tps: 21,281
[rank1]:2025-11-02 00:34:59,487 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251102_0034_stage1_step1400.svg
[rank0]:2025-11-02 00:34:59,483 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251102_0034_stage0_step1400.svg
[rank2]:2025-11-02 00:34:59,482 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251102_0034_stage2_step1400.svg
[rank3]:2025-11-02 00:34:59,592 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule/251102_0034_real_step1400_rank3.svg
[rank3]:> Batch Time: 460.85 ms, GPU Bubble Ratio: 84.17%, 43.37%, 71.47%, 13.12%
[rank3]:2025-11-02 00:34:59,664 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251102_0034_stage3_step1400.svg
[rank0]:2025-11-02 00:36:02,996 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-11-02 00:36:04,094 - INFO -  step: 1450  loss: -2.0000  grad_norm:  0.2071  memory: 14.99GiB(31.56%)  tps: 6,331  tflops: 48.22  mfu: 15.45%
[rank2]:2025-11-02 00:36:04,076 - INFO -  step: 1450  loss: -2.0000  grad_norm:  0.0000  memory: 11.90GiB(25.06%)  tps: 6,334  tflops: 48.24  mfu: 15.46%
[rank0]:2025-11-02 00:36:04,076 - INFO -  step: 1450  loss: -2.0000  grad_norm:  0.0000  memory: 17.04GiB(35.87%)  tps: 6,330  tflops: 48.21  mfu: 15.45%
[rank3]:2025-11-02 00:36:06,680 - INFO -  step: 1450  loss:  0.2409  grad_norm:  0.2071  memory: 31.14GiB(65.55%)  tps: 6,088  tflops: 46.37  mfu: 14.86%
[rank0]:2025-11-02 00:37:09,819 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 00:37:10,853 - INFO - Avg. fwd time: 11.0001 / Avg. bwd time: 38.0157 / Avg. batch time: 451.9896 (ms) / GPU bubble ratio: 13.24%
[rank1]:2025-11-02 00:37:10,902 - INFO - Avg. fwd time: 10.0932 / Avg. bwd time: 15.8633 / Avg. batch time: 596.6201 (ms) / GPU bubble ratio: 65.20%
[rank0]:2025-11-02 00:37:10,909 - INFO - Avg. fwd time: 8.6164 / Avg. bwd time: 11.5356 / Avg. batch time: 621.2052 (ms) / GPU bubble ratio: 74.05%
[rank0]:2025-11-02 00:37:10,912 - INFO -  step: 1500  loss: -2.0000  grad_norm:  0.0000  memory: 17.04GiB(35.87%)  tps: 6,128  tflops: 46.68  mfu: 14.96%
[rank2]:2025-11-02 00:37:10,870 - INFO - Avg. fwd time: 8.0961 / Avg. bwd time: 10.1603 / Avg. batch time: 566.3435 (ms) / GPU bubble ratio: 74.21%
[rank2]:2025-11-02 00:37:10,912 - INFO -  step: 1500  loss: -2.0000  grad_norm:  0.0000  memory: 11.90GiB(25.06%)  tps: 6,129  tflops: 46.68  mfu: 14.96%
[rank1]:2025-11-02 00:37:10,930 - INFO -  step: 1500  loss: -2.0000  grad_norm:  0.2174  memory: 14.99GiB(31.56%)  tps: 6,128  tflops: 46.68  mfu: 14.96%
[rank3]:2025-11-02 00:37:13,399 - INFO -  step: 1500  loss:  0.2750  grad_norm:  0.2174  memory: 31.14GiB(65.55%)  tps: 6,139  tflops: 46.76  mfu: 14.99%
[rank1]:2025-11-02 00:37:13,479 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251102_0037_stage1_step1500.svg
[rank0]:2025-11-02 00:37:13,475 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251102_0037_stage0_step1500.svg
[rank2]:2025-11-02 00:37:13,475 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251102_0037_stage2_step1500.svg
[rank3]:2025-11-02 00:37:13,581 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule/251102_0037_real_step1500_rank3.svg
[rank3]:> Batch Time: 462.73 ms, GPU Bubble Ratio: 84.25%, 43.43%, 71.57%, 13.08%
[rank3]:2025-11-02 00:37:13,654 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251102_0037_stage3_step1500.svg
[rank0]:2025-11-02 00:38:16,587 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 00:38:17,682 - INFO -  step: 1550  loss: -2.0000  grad_norm:  0.0000  memory: 11.90GiB(25.06%)  tps: 6,134  tflops: 46.72  mfu: 14.97%
[rank0]:2025-11-02 00:38:17,682 - INFO -  step: 1550  loss: -2.0000  grad_norm:  0.0000  memory: 17.04GiB(35.87%)  tps: 6,134  tflops: 46.72  mfu: 14.97%
[rank1]:2025-11-02 00:38:17,700 - INFO -  step: 1550  loss: -2.0000  grad_norm:  0.2016  memory: 14.99GiB(31.56%)  tps: 6,135  tflops: 46.72  mfu: 14.97%
[rank3]:2025-11-02 00:38:20,206 - INFO -  step: 1550  loss:  0.2330  grad_norm:  0.2016  memory: 31.14GiB(65.55%)  tps: 6,131  tflops: 46.70  mfu: 14.97%
[rank0]:2025-11-02 00:39:23,176 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-02 00:39:23,767 - INFO - Avg. fwd time: 8.6429 / Avg. bwd time: 10.8828 / Avg. batch time: 622.2555 (ms) / GPU bubble ratio: 74.90%
[rank3]:2025-11-02 00:39:24,019 - INFO - Avg. fwd time: 10.9760 / Avg. bwd time: 38.0799 / Avg. batch time: 452.2959 (ms) / GPU bubble ratio: 13.23%
[rank2]:2025-11-02 00:39:23,994 - INFO - Avg. fwd time: 8.1137 / Avg. bwd time: 10.0400 / Avg. batch time: 567.5315 (ms) / GPU bubble ratio: 74.41%
[rank1]:2025-11-02 00:39:24,140 - INFO - Avg. fwd time: 10.0331 / Avg. bwd time: 16.3151 / Avg. batch time: 598.2893 (ms) / GPU bubble ratio: 64.77%
[rank3]:2025-11-02 00:39:24,617 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251102_0039_rank3_trend_line.svg
[rank1]:2025-11-02 00:39:24,681 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251102_0039_rank1_trend_line.svg
[rank2]:2025-11-02 00:39:24,646 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251102_0039_rank2_trend_line.svg
[rank2]:2025-11-02 00:39:24,689 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-11-02 00:39:24,673 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251102_0039_rank0_trend_line.svg
[rank0]:2025-11-02 00:39:24,688 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-11-02 00:39:24,691 - INFO -  step: 1600  loss: -2.0000  grad_norm:  0.0000  memory: 17.04GiB(35.87%)  tps: 6,113  tflops: 46.56  mfu: 14.92%
[rank0]:2025-11-02 00:39:24,691 - INFO - ðŸ”Ž  Running validation at step 1600
[rank1]:2025-11-02 00:39:24,689 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-11-02 00:39:24,692 - INFO -  step: 1600  loss: -2.0000  grad_norm:  0.2284  memory: 14.99GiB(31.56%)  tps: 6,114  tflops: 46.57  mfu: 14.93%
[rank1]:2025-11-02 00:39:24,692 - INFO - ðŸ”Ž  Running validation at step 1600
[rank2]:2025-11-02 00:39:24,692 - INFO -  step: 1600  loss: -2.0000  grad_norm:  0.0000  memory: 11.90GiB(25.06%)  tps: 6,113  tflops: 46.55  mfu: 14.92%
[rank2]:2025-11-02 00:39:24,692 - INFO - ðŸ”Ž  Running validation at step 1600
[rank3]:2025-11-02 00:39:24,878 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule/251102_0039_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 425.23 ms, GPU Bubble Ratio: 69.70%, 55.47%, 71.53%, 11.38%
[rank3]:2025-11-02 00:39:24,878 - INFO - 	> Batch Time: 425.23 ms (Average Freeze Ratio: 0.29)
[rank3]:2025-11-02 00:39:24,879 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 0.40/0.40, [MB7] 0.00/0.00
[rank3]:2025-11-02 00:39:27,428 - INFO -  step: 1600  loss:  0.1988  grad_norm:  0.2284  memory: 31.14GiB(65.55%)  tps: 6,093  tflops: 46.41  mfu: 14.87%
[rank3]:2025-11-02 00:39:27,428 - INFO - ðŸ”Ž  Running validation at step 1600
[rank1]:2025-11-02 00:39:46,591 - INFO - validate step: 1600  loss: -1.0000  memory: 14.99GiB(31.56%)  tps: 18,704
[rank2]:2025-11-02 00:39:46,604 - INFO - validate step: 1600  loss: -1.0000  memory: 11.90GiB(25.06%)  tps: 18,693
[rank0]:2025-11-02 00:39:46,569 - INFO - validate step: 1600  loss: -1.0000  memory: 17.04GiB(35.87%)  tps: 18,723
[rank3]:2025-11-02 00:39:46,597 - INFO - validate step: 1600  loss:  0.9337  memory: 31.14GiB(65.55%)  tps: 21,370
[rank1]:2025-11-02 00:39:46,684 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251102_0039_stage1_step1600.svg
[rank2]:2025-11-02 00:39:46,681 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251102_0039_stage2_step1600.svg
[rank0]:2025-11-02 00:39:46,682 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251102_0039_stage0_step1600.svg
[rank3]:2025-11-02 00:39:46,778 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule/251102_0039_real_step1600_rank3.svg
[rank3]:> Batch Time: 459.43 ms, GPU Bubble Ratio: 84.19%, 43.05%, 71.39%, 13.15%
[rank3]:2025-11-02 00:39:46,851 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251102_0039_stage3_step1600.svg
[rank3]:2025-11-02 00:40:15,010 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-11-02 00:40:15,224 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-11-02 00:40:15,211 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-11-02 00:40:15,223 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-11-02 00:40:49,103 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-11-02 00:40:50,157 - INFO -  step: 1650  loss: -2.0000  grad_norm:  0.0000  memory: 15.73GiB(33.12%)  tps: 6,444  tflops: 49.08  mfu: 15.73%
[rank2]:2025-11-02 00:40:50,157 - INFO -  step: 1650  loss: -2.0000  grad_norm:  0.0000  memory: 11.90GiB(25.06%)  tps: 6,445  tflops: 49.09  mfu: 15.73%
[rank0]:2025-11-02 00:40:50,157 - INFO -  step: 1650  loss: -2.0000  grad_norm:  0.0000  memory: 17.04GiB(35.87%)  tps: 6,441  tflops: 49.06  mfu: 15.72%
[rank3]:2025-11-02 00:40:52,699 - INFO -  step: 1650  loss:  0.2864  grad_norm:  0.0922  memory: 31.14GiB(65.55%)  tps: 6,197  tflops: 47.19  mfu: 15.13%
[rank0]:2025-11-02 00:41:54,265 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-02 00:41:54,831 - INFO - Avg. fwd time: 8.6718 / Avg. bwd time: 10.2088 / Avg. batch time: 623.2507 (ms) / GPU bubble ratio: 75.77%
[rank2]:2025-11-02 00:41:55,059 - INFO - Avg. fwd time: 8.1317 / Avg. bwd time: 9.9156 / Avg. batch time: 569.5468 (ms) / GPU bubble ratio: 74.65%
[rank3]:2025-11-02 00:41:55,081 - INFO - Avg. fwd time: 10.9523 / Avg. bwd time: 38.1503 / Avg. batch time: 452.8669 (ms) / GPU bubble ratio: 13.26%
[rank1]:2025-11-02 00:41:55,139 - INFO - Avg. fwd time: 10.0965 / Avg. bwd time: 16.0302 / Avg. batch time: 600.0030 (ms) / GPU bubble ratio: 65.16%
[rank0]:2025-11-02 00:41:55,310 - INFO -  step: 1700  loss: -2.0000  grad_norm:  0.0000  memory: 17.04GiB(35.87%)  tps: 6,287  tflops: 47.88  mfu: 15.35%
[rank1]:2025-11-02 00:41:55,310 - INFO -  step: 1700  loss: -2.0000  grad_norm:  0.0000  memory: 15.73GiB(33.12%)  tps: 6,287  tflops: 47.88  mfu: 15.35%
[rank2]:2025-11-02 00:41:55,310 - INFO -  step: 1700  loss: -2.0000  grad_norm:  0.0000  memory: 11.90GiB(25.06%)  tps: 6,287  tflops: 47.88  mfu: 15.35%
[rank3]:2025-11-02 00:41:57,854 - INFO -  step: 1700  loss:  0.2539  grad_norm:  0.0843  memory: 31.14GiB(65.55%)  tps: 6,287  tflops: 47.88  mfu: 15.35%
[rank1]:2025-11-02 00:41:57,933 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251102_0041_stage1_step1700.svg
[rank2]:2025-11-02 00:41:57,932 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251102_0041_stage2_step1700.svg
[rank0]:2025-11-02 00:41:57,934 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251102_0041_stage0_step1700.svg
[rank3]:2025-11-02 00:41:58,032 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule/251102_0041_real_step1700_rank3.svg
[rank3]:> Batch Time: 447.72 ms, GPU Bubble Ratio: 83.71%, 62.14%, 70.64%, 10.70%
[rank3]:2025-11-02 00:41:58,104 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251102_0041_stage3_step1700.svg
[rank0]:2025-11-02 00:42:59,730 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 00:43:00,789 - INFO -  step: 1750  loss: -2.0000  grad_norm:  0.0000  memory: 11.90GiB(25.06%)  tps: 6,255  tflops: 47.64  mfu: 15.27%
[rank0]:2025-11-02 00:43:00,789 - INFO -  step: 1750  loss: -2.0000  grad_norm:  0.0000  memory: 17.04GiB(35.87%)  tps: 6,255  tflops: 47.64  mfu: 15.27%
[rank1]:2025-11-02 00:43:00,789 - INFO -  step: 1750  loss: -2.0000  grad_norm:  0.0000  memory: 15.73GiB(33.12%)  tps: 6,255  tflops: 47.64  mfu: 15.27%
[rank3]:2025-11-02 00:43:03,311 - INFO -  step: 1750  loss:  0.2162  grad_norm:  0.0852  memory: 31.14GiB(65.55%)  tps: 6,258  tflops: 47.66  mfu: 15.28%
[rank0]:2025-11-02 00:44:05,064 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 00:44:06,107 - INFO - Avg. fwd time: 10.9315 / Avg. bwd time: 38.2202 / Avg. batch time: 453.2362 (ms) / GPU bubble ratio: 13.24%
[rank1]:2025-11-02 00:44:06,144 - INFO - Avg. fwd time: 10.1381 / Avg. bwd time: 15.7009 / Avg. batch time: 600.6363 (ms) / GPU bubble ratio: 65.58%
[rank1]:2025-11-02 00:44:06,155 - INFO -  step: 1800  loss: -2.0000  grad_norm:  0.0000  memory: 15.73GiB(33.12%)  tps: 6,266  tflops: 47.73  mfu: 15.30%
[rank1]:2025-11-02 00:44:06,155 - INFO - ðŸ”Ž  Running validation at step 1800
[rank2]:2025-11-02 00:44:06,125 - INFO - Avg. fwd time: 8.1478 / Avg. bwd time: 9.8059 / Avg. batch time: 570.5264 (ms) / GPU bubble ratio: 74.82%
[rank2]:2025-11-02 00:44:06,155 - INFO -  step: 1800  loss: -2.0000  grad_norm:  0.0000  memory: 11.90GiB(25.06%)  tps: 6,266  tflops: 47.73  mfu: 15.30%
[rank2]:2025-11-02 00:44:06,155 - INFO - ðŸ”Ž  Running validation at step 1800
[rank0]:2025-11-02 00:44:06,152 - INFO - Avg. fwd time: 8.6976 / Avg. bwd time: 9.6134 / Avg. batch time: 623.2423 (ms) / GPU bubble ratio: 76.50%
[rank0]:2025-11-02 00:44:06,155 - INFO -  step: 1800  loss: -2.0000  grad_norm:  0.0000  memory: 17.04GiB(35.87%)  tps: 6,266  tflops: 47.73  mfu: 15.30%
[rank0]:2025-11-02 00:44:06,155 - INFO - ðŸ”Ž  Running validation at step 1800
[rank3]:2025-11-02 00:44:08,632 - INFO -  step: 1800  loss:  0.1864  grad_norm:  0.0927  memory: 31.14GiB(65.55%)  tps: 6,271  tflops: 47.76  mfu: 15.31%
[rank3]:2025-11-02 00:44:08,633 - INFO - ðŸ”Ž  Running validation at step 1800
[rank0]:2025-11-02 00:44:27,707 - INFO - validate step: 1800  loss: -1.0000  memory: 17.04GiB(35.87%)  tps: 19,006
[rank3]:2025-11-02 00:44:27,733 - INFO - validate step: 1800  loss:  0.9364  memory: 31.14GiB(65.55%)  tps: 21,445
[rank1]:2025-11-02 00:44:27,723 - INFO - validate step: 1800  loss: -1.0000  memory: 15.73GiB(33.12%)  tps: 18,991
[rank2]:2025-11-02 00:44:27,742 - INFO - validate step: 1800  loss: -1.0000  memory: 11.90GiB(25.06%)  tps: 18,975
[rank1]:2025-11-02 00:44:27,821 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251102_0044_stage1_step1800.svg
[rank2]:2025-11-02 00:44:27,819 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251102_0044_stage2_step1800.svg
[rank0]:2025-11-02 00:44:27,821 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251102_0044_stage0_step1800.svg
[rank3]:2025-11-02 00:44:27,918 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule/251102_0044_real_step1800_rank3.svg
[rank3]:> Batch Time: 450.77 ms, GPU Bubble Ratio: 83.79%, 62.38%, 70.81%, 10.66%
[rank3]:2025-11-02 00:44:27,990 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251102_0044_stage3_step1800.svg
[rank0]:2025-11-02 00:45:30,152 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-11-02 00:45:31,230 - INFO -  step: 1850  loss: -2.0000  grad_norm:  0.0000  memory: 15.73GiB(33.12%)  tps: 6,450  tflops: 49.12  mfu: 15.74%
[rank2]:2025-11-02 00:45:31,229 - INFO -  step: 1850  loss: -2.0000  grad_norm:  0.0000  memory: 11.90GiB(25.06%)  tps: 6,452  tflops: 49.14  mfu: 15.75%
[rank0]:2025-11-02 00:45:31,230 - INFO -  step: 1850  loss: -2.0000  grad_norm:  0.0000  memory: 17.04GiB(35.87%)  tps: 6,448  tflops: 49.11  mfu: 15.74%
[rank3]:2025-11-02 00:45:33,773 - INFO -  step: 1850  loss:  0.2981  grad_norm:  0.1085  memory: 31.14GiB(65.55%)  tps: 6,203  tflops: 47.24  mfu: 15.14%
[rank0]:2025-11-02 00:46:35,681 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-02 00:46:36,264 - INFO - Avg. fwd time: 8.7182 / Avg. bwd time: 9.1557 / Avg. batch time: 623.6080 (ms) / GPU bubble ratio: 77.07%
[rank3]:2025-11-02 00:46:36,508 - INFO - Avg. fwd time: 10.9178 / Avg. bwd time: 38.2893 / Avg. batch time: 453.6615 (ms) / GPU bubble ratio: 13.23%
[rank2]:2025-11-02 00:46:36,487 - INFO - Avg. fwd time: 8.1606 / Avg. bwd time: 9.7222 / Avg. batch time: 571.6522 (ms) / GPU bubble ratio: 74.97%
[rank1]:2025-11-02 00:46:36,569 - INFO - Avg. fwd time: 10.1711 / Avg. bwd time: 15.4485 / Avg. batch time: 601.4962 (ms) / GPU bubble ratio: 65.93%
[rank1]:2025-11-02 00:46:36,736 - INFO -  step: 1900  loss: -2.0000  grad_norm:  0.0000  memory: 15.73GiB(33.12%)  tps: 6,253  tflops: 47.62  mfu: 15.26%
[rank2]:2025-11-02 00:46:36,736 - INFO -  step: 1900  loss: -2.0000  grad_norm:  0.0000  memory: 11.90GiB(25.06%)  tps: 6,253  tflops: 47.62  mfu: 15.26%
[rank0]:2025-11-02 00:46:36,736 - INFO -  step: 1900  loss: -2.0000  grad_norm:  0.0000  memory: 17.04GiB(35.87%)  tps: 6,253  tflops: 47.62  mfu: 15.26%
[rank3]:2025-11-02 00:46:39,211 - INFO -  step: 1900  loss:  0.1816  grad_norm:  0.0759  memory: 31.14GiB(65.55%)  tps: 6,260  tflops: 47.67  mfu: 15.28%
[rank0]:2025-11-02 00:46:39,289 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251102_0046_stage0_step1900.svg
[rank1]:2025-11-02 00:46:39,293 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251102_0046_stage1_step1900.svg
[rank2]:2025-11-02 00:46:39,287 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251102_0046_stage2_step1900.svg
[rank3]:2025-11-02 00:46:39,390 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule/251102_0046_real_step1900_rank3.svg
[rank3]:> Batch Time: 450.49 ms, GPU Bubble Ratio: 83.79%, 62.32%, 70.79%, 10.63%
[rank3]:2025-11-02 00:46:39,464 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251102_0046_stage3_step1900.svg
[rank0]:2025-11-02 00:47:41,404 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 00:47:42,471 - INFO -  step: 1950  loss: -2.0000  grad_norm:  0.0000  memory: 11.90GiB(25.06%)  tps: 6,231  tflops: 47.46  mfu: 15.21%
[rank0]:2025-11-02 00:47:42,472 - INFO -  step: 1950  loss: -2.0000  grad_norm:  0.0000  memory: 17.04GiB(35.87%)  tps: 6,231  tflops: 47.46  mfu: 15.21%
[rank1]:2025-11-02 00:47:42,471 - INFO -  step: 1950  loss: -2.0000  grad_norm:  0.0000  memory: 15.73GiB(33.12%)  tps: 6,231  tflops: 47.46  mfu: 15.21%
[rank3]:2025-11-02 00:47:44,956 - INFO -  step: 1950  loss:  0.1782  grad_norm:  0.0712  memory: 31.14GiB(65.55%)  tps: 6,230  tflops: 47.45  mfu: 15.21%
[rank0]:2025-11-02 00:48:46,942 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-02 00:48:47,535 - INFO - Avg. fwd time: 8.7394 / Avg. bwd time: 8.6739 / Avg. batch time: 624.3203 (ms) / GPU bubble ratio: 77.69%
[rank3]:2025-11-02 00:48:47,788 - INFO - Avg. fwd time: 10.9028 / Avg. bwd time: 38.3588 / Avg. batch time: 454.0783 (ms) / GPU bubble ratio: 13.21%
[rank2]:2025-11-02 00:48:47,762 - INFO - Avg. fwd time: 8.1738 / Avg. bwd time: 9.6338 / Avg. batch time: 573.1652 (ms) / GPU bubble ratio: 75.14%
[rank1]:2025-11-02 00:48:47,848 - INFO - Avg. fwd time: 10.2055 / Avg. bwd time: 15.1826 / Avg. batch time: 602.7288 (ms) / GPU bubble ratio: 66.30%
[rank1]:2025-11-02 00:48:48,021 - INFO -  step: 2000  loss: -2.0000  grad_norm:  0.0000  memory: 15.73GiB(33.12%)  tps: 6,249  tflops: 47.59  mfu: 15.25%
[rank1]:2025-11-02 00:48:48,022 - INFO - ðŸ”Ž  Running validation at step 2000
[rank2]:2025-11-02 00:48:48,021 - INFO -  step: 2000  loss: -2.0000  grad_norm:  0.0000  memory: 11.90GiB(25.06%)  tps: 6,249  tflops: 47.59  mfu: 15.25%
[rank2]:2025-11-02 00:48:48,021 - INFO - ðŸ”Ž  Running validation at step 2000
[rank0]:2025-11-02 00:48:48,021 - INFO -  step: 2000  loss: -2.0000  grad_norm:  0.0000  memory: 17.04GiB(35.87%)  tps: 6,249  tflops: 47.59  mfu: 15.25%
[rank0]:2025-11-02 00:48:48,022 - INFO - ðŸ”Ž  Running validation at step 2000
[rank3]:2025-11-02 00:48:50,512 - INFO -  step: 2000  loss:  0.2368  grad_norm:  0.0805  memory: 31.14GiB(65.55%)  tps: 6,248  tflops: 47.59  mfu: 15.25%
[rank3]:2025-11-02 00:48:50,513 - INFO - ðŸ”Ž  Running validation at step 2000
[rank0]:2025-11-02 00:49:09,682 - INFO - validate step: 2000  loss: -1.0000  memory: 17.04GiB(35.87%)  tps: 18,910
[rank3]:2025-11-02 00:49:09,712 - INFO - validate step: 2000  loss:  0.9366  memory: 31.14GiB(65.55%)  tps: 21,335
[rank1]:2025-11-02 00:49:09,701 - INFO - validate step: 2000  loss: -1.0000  memory: 15.73GiB(33.12%)  tps: 18,894
[rank2]:2025-11-02 00:49:09,718 - INFO - validate step: 2000  loss: -1.0000  memory: 11.90GiB(25.06%)  tps: 18,879
[rank0]:2025-11-02 00:49:09,799 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251102_0049_stage0_step2000.svg
[rank1]:2025-11-02 00:49:09,804 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251102_0049_stage1_step2000.svg
[rank2]:2025-11-02 00:49:09,798 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251102_0049_stage2_step2000.svg
[rank3]:2025-11-02 00:49:09,899 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule/251102_0049_real_step2000_rank3.svg
[rank3]:> Batch Time: 450.71 ms, GPU Bubble Ratio: 83.81%, 62.36%, 70.81%, 10.62%
[rank3]:2025-11-02 00:49:09,974 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251102_0049_stage3_step2000.svg
[rank0]:2025-11-02 00:50:12,107 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-11-02 00:50:13,162 - INFO -  step: 2050  loss: -2.0000  grad_norm:  0.0000  memory: 15.73GiB(33.12%)  tps: 6,454  tflops: 49.16  mfu: 15.76%
[rank2]:2025-11-02 00:50:13,161 - INFO -  step: 2050  loss: -2.0000  grad_norm:  0.0000  memory: 11.90GiB(25.06%)  tps: 6,456  tflops: 49.17  mfu: 15.76%
[rank0]:2025-11-02 00:50:13,161 - INFO -  step: 2050  loss: -2.0000  grad_norm:  0.0000  memory: 17.04GiB(35.87%)  tps: 6,453  tflops: 49.14  mfu: 15.75%
[rank3]:2025-11-02 00:50:15,653 - INFO -  step: 2050  loss:  0.2075  grad_norm:  0.1084  memory: 31.14GiB(65.55%)  tps: 6,212  tflops: 47.31  mfu: 15.16%
[rank0]:2025-11-02 00:51:17,454 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 00:51:18,487 - INFO - Avg. fwd time: 10.8912 / Avg. bwd time: 38.4211 / Avg. batch time: 454.4673 (ms) / GPU bubble ratio: 13.20%
[rank2]:2025-11-02 00:51:18,505 - INFO - Avg. fwd time: 8.1860 / Avg. bwd time: 9.5547 / Avg. batch time: 573.9439 (ms) / GPU bubble ratio: 75.27%
[rank2]:2025-11-02 00:51:18,537 - INFO -  step: 2100  loss: -2.0000  grad_norm:  0.0000  memory: 11.90GiB(25.06%)  tps: 6,265  tflops: 47.72  mfu: 15.29%
[rank1]:2025-11-02 00:51:18,525 - INFO - Avg. fwd time: 10.2368 / Avg. bwd time: 14.9438 / Avg. batch time: 603.2572 (ms) / GPU bubble ratio: 66.61%
[rank1]:2025-11-02 00:51:18,537 - INFO -  step: 2100  loss: -2.0000  grad_norm:  0.0000  memory: 15.73GiB(33.12%)  tps: 6,265  tflops: 47.72  mfu: 15.29%
[rank0]:2025-11-02 00:51:18,534 - INFO - Avg. fwd time: 8.7589 / Avg. bwd time: 8.2403 / Avg. batch time: 624.3832 (ms) / GPU bubble ratio: 78.22%
[rank0]:2025-11-02 00:51:18,537 - INFO -  step: 2100  loss: -2.0000  grad_norm:  0.0000  memory: 17.04GiB(35.87%)  tps: 6,265  tflops: 47.72  mfu: 15.29%
[rank3]:2025-11-02 00:51:21,022 - INFO -  step: 2100  loss:  0.2524  grad_norm:  0.0900  memory: 31.14GiB(65.55%)  tps: 6,266  tflops: 47.72  mfu: 15.30%
[rank0]:2025-11-02 00:51:21,094 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251102_0051_stage0_step2100.svg
[rank2]:2025-11-02 00:51:21,093 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251102_0051_stage2_step2100.svg
[rank1]:2025-11-02 00:51:21,096 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251102_0051_stage1_step2100.svg
[rank3]:2025-11-02 00:51:21,201 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule/251102_0051_real_step2100_rank3.svg
[rank3]:> Batch Time: 451.19 ms, GPU Bubble Ratio: 83.80%, 62.39%, 70.83%, 10.62%
[rank3]:2025-11-02 00:51:21,268 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251102_0051_stage3_step2100.svg
[rank0]:2025-11-02 00:52:22,969 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-02 00:52:24,032 - INFO -  step: 2150  loss: -2.0000  grad_norm:  0.0000  memory: 15.73GiB(33.12%)  tps: 6,254  tflops: 47.63  mfu: 15.27%
[rank0]:2025-11-02 00:52:24,032 - INFO -  step: 2150  loss: -2.0000  grad_norm:  0.0000  memory: 17.04GiB(35.87%)  tps: 6,254  tflops: 47.63  mfu: 15.27%
[rank2]:2025-11-02 00:52:24,031 - INFO -  step: 2150  loss: -2.0000  grad_norm:  0.0000  memory: 11.90GiB(25.06%)  tps: 6,254  tflops: 47.63  mfu: 15.27%
[rank3]:2025-11-02 00:52:26,522 - INFO -  step: 2150  loss:  0.2222  grad_norm:  0.0867  memory: 31.14GiB(65.55%)  tps: 6,254  tflops: 47.63  mfu: 15.27%
[rank0]:2025-11-02 00:53:28,165 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-02 00:53:28,754 - INFO - Avg. fwd time: 8.7732 / Avg. bwd time: 7.9017 / Avg. batch time: 624.5005 (ms) / GPU bubble ratio: 78.64%
[rank2]:2025-11-02 00:53:28,987 - INFO - Avg. fwd time: 8.1950 / Avg. bwd time: 9.4923 / Avg. batch time: 574.6250 (ms) / GPU bubble ratio: 75.38%
[rank3]:2025-11-02 00:53:29,011 - INFO - Avg. fwd time: 10.8793 / Avg. bwd time: 38.4657 / Avg. batch time: 454.7156 (ms) / GPU bubble ratio: 13.19%
[rank1]:2025-11-02 00:53:29,070 - INFO - Avg. fwd time: 10.2604 / Avg. bwd time: 14.7566 / Avg. batch time: 603.7403 (ms) / GPU bubble ratio: 66.85%
[rank1]:2025-11-02 00:53:29,231 - INFO -  step: 2200  loss: -2.0000  grad_norm:  0.0000  memory: 15.73GiB(33.12%)  tps: 6,282  tflops: 47.85  mfu: 15.34%
[rank1]:2025-11-02 00:53:29,231 - INFO - ðŸ”Ž  Running validation at step 2200
[rank0]:2025-11-02 00:53:29,231 - INFO -  step: 2200  loss: -2.0000  grad_norm:  0.0000  memory: 17.04GiB(35.87%)  tps: 6,282  tflops: 47.85  mfu: 15.34%
[rank0]:2025-11-02 00:53:29,231 - INFO - ðŸ”Ž  Running validation at step 2200
[rank2]:2025-11-02 00:53:29,230 - INFO -  step: 2200  loss: -2.0000  grad_norm:  0.0000  memory: 11.90GiB(25.06%)  tps: 6,282  tflops: 47.85  mfu: 15.34%
[rank2]:2025-11-02 00:53:29,231 - INFO - ðŸ”Ž  Running validation at step 2200
[rank3]:2025-11-02 00:53:31,715 - INFO -  step: 2200  loss:  0.2429  grad_norm:  0.0934  memory: 31.14GiB(65.55%)  tps: 6,283  tflops: 47.85  mfu: 15.34%
[rank3]:2025-11-02 00:53:31,715 - INFO - ðŸ”Ž  Running validation at step 2200
[rank0]:2025-11-02 00:53:50,786 - INFO - validate step: 2200  loss: -1.0000  memory: 17.04GiB(35.87%)  tps: 19,003
[rank3]:2025-11-02 00:53:50,815 - INFO - validate step: 2200  loss:  0.9373  memory: 31.14GiB(65.55%)  tps: 21,446
[rank2]:2025-11-02 00:53:50,822 - INFO - validate step: 2200  loss: -1.0000  memory: 11.90GiB(25.06%)  tps: 18,971
[rank1]:2025-11-02 00:53:50,805 - INFO - validate step: 2200  loss: -1.0000  memory: 15.73GiB(33.12%)  tps: 18,986
[rank2]:2025-11-02 00:53:50,896 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251102_0053_stage2_step2200.svg
[rank1]:2025-11-02 00:53:50,894 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251102_0053_stage1_step2200.svg
[rank0]:2025-11-02 00:53:50,899 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251102_0053_stage0_step2200.svg
[rank3]:2025-11-02 00:53:50,998 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule/251102_0053_real_step2200_rank3.svg
[rank3]:> Batch Time: 451.31 ms, GPU Bubble Ratio: 83.84%, 62.43%, 70.88%, 10.65%
[rank3]:2025-11-02 00:53:51,063 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251102_0053_stage3_step2200.svg
[rank0]:2025-11-02 00:54:52,826 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-11-02 00:54:53,883 - INFO -  step: 2250  loss: -2.0000  grad_norm:  0.0000  memory: 11.90GiB(25.06%)  tps: 6,495  tflops: 49.47  mfu: 15.86%
[rank1]:2025-11-02 00:54:53,883 - INFO -  step: 2250  loss: -2.0000  grad_norm:  0.0000  memory: 15.73GiB(33.12%)  tps: 6,494  tflops: 49.46  mfu: 15.85%
[rank0]:2025-11-02 00:54:53,883 - INFO -  step: 2250  loss: -2.0000  grad_norm:  0.0000  memory: 17.04GiB(35.87%)  tps: 6,492  tflops: 49.44  mfu: 15.85%
[rank3]:2025-11-02 00:54:56,387 - INFO -  step: 2250  loss:  0.2221  grad_norm:  0.0917  memory: 31.14GiB(65.55%)  tps: 6,247  tflops: 47.58  mfu: 15.25%
[rank0]:2025-11-02 00:55:58,100 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-02 00:55:58,681 - INFO - Avg. fwd time: 8.7886 / Avg. bwd time: 7.5403 / Avg. batch time: 624.9590 (ms) / GPU bubble ratio: 79.10%
[rank2]:2025-11-02 00:55:58,904 - INFO - Avg. fwd time: 8.2046 / Avg. bwd time: 9.4256 / Avg. batch time: 575.6849 (ms) / GPU bubble ratio: 75.50%
[rank3]:2025-11-02 00:55:58,928 - INFO - Avg. fwd time: 10.8663 / Avg. bwd time: 38.5041 / Avg. batch time: 454.9044 (ms) / GPU bubble ratio: 13.18%
[rank1]:2025-11-02 00:55:58,987 - INFO - Avg. fwd time: 10.2855 / Avg. bwd time: 14.5566 / Avg. batch time: 604.5889 (ms) / GPU bubble ratio: 67.13%
[rank2]:2025-11-02 00:55:59,153 - INFO -  step: 2300  loss: -2.0000  grad_norm:  0.0000  memory: 11.90GiB(25.06%)  tps: 6,276  tflops: 47.80  mfu: 15.32%
[rank1]:2025-11-02 00:55:59,153 - INFO -  step: 2300  loss: -2.0000  grad_norm:  0.0000  memory: 15.73GiB(33.12%)  tps: 6,276  tflops: 47.80  mfu: 15.32%
[rank0]:2025-11-02 00:55:59,153 - INFO -  step: 2300  loss: -2.0000  grad_norm:  0.0000  memory: 17.04GiB(35.87%)  tps: 6,276  tflops: 47.80  mfu: 15.32%
[rank3]:2025-11-02 00:56:01,648 - INFO -  step: 2300  loss:  0.2175  grad_norm:  0.0690  memory: 31.14GiB(65.55%)  tps: 6,277  tflops: 47.80  mfu: 15.32%
[rank1]:2025-11-02 00:56:01,720 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251102_0055_stage1_step2300.svg
[rank0]:2025-11-02 00:56:01,721 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251102_0055_stage0_step2300.svg
[rank2]:2025-11-02 00:56:01,719 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251102_0055_stage2_step2300.svg
[rank3]:2025-11-02 00:56:01,828 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule/251102_0056_real_step2300_rank3.svg
[rank3]:> Batch Time: 448.13 ms, GPU Bubble Ratio: 83.72%, 62.16%, 70.66%, 10.72%
[rank3]:2025-11-02 00:56:01,894 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251102_0056_stage3_step2300.svg
[rank0]:2025-11-02 00:57:03,603 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 00:57:04,656 - INFO -  step: 2350  loss: -2.0000  grad_norm:  0.0000  memory: 11.90GiB(25.06%)  tps: 6,253  tflops: 47.63  mfu: 15.26%
[rank1]:2025-11-02 00:57:04,656 - INFO -  step: 2350  loss: -2.0000  grad_norm:  0.0000  memory: 15.73GiB(33.12%)  tps: 6,253  tflops: 47.63  mfu: 15.26%
[rank0]:2025-11-02 00:57:04,656 - INFO -  step: 2350  loss: -2.0000  grad_norm:  0.0000  memory: 17.04GiB(35.87%)  tps: 6,253  tflops: 47.63  mfu: 15.26%
[rank3]:2025-11-02 00:57:07,151 - INFO -  step: 2350  loss:  0.2163  grad_norm:  0.0648  memory: 31.14GiB(65.55%)  tps: 6,253  tflops: 47.63  mfu: 15.26%
[rank0]:2025-11-02 00:58:08,896 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 00:58:09,959 - INFO - Avg. fwd time: 10.8553 / Avg. bwd time: 38.5480 / Avg. batch time: 455.1543 (ms) / GPU bubble ratio: 13.17%
[rank0]:2025-11-02 00:58:10,008 - INFO - Avg. fwd time: 8.8028 / Avg. bwd time: 7.2105 / Avg. batch time: 624.8863 (ms) / GPU bubble ratio: 79.50%
[rank0]:2025-11-02 00:58:10,011 - INFO -  step: 2400  loss: -2.0000  grad_norm:  0.0000  memory: 17.04GiB(35.87%)  tps: 6,267  tflops: 47.73  mfu: 15.30%
[rank0]:2025-11-02 00:58:10,011 - INFO -  final step: 2400  loss: -2.0000  grad_norm:  0.0000  tps: 6,417  tflops: 48.87  mfu: 15.18%
[rank0]:2025-11-02 00:58:10,011 - INFO - ðŸ”Ž  Running validation at step 2400
[rank2]:2025-11-02 00:58:09,978 - INFO - Avg. fwd time: 8.2135 / Avg. bwd time: 9.3648 / Avg. batch time: 576.1603 (ms) / GPU bubble ratio: 75.59%
[rank2]:2025-11-02 00:58:10,010 - INFO -  step: 2400  loss: -2.0000  grad_norm:  0.0000  memory: 11.90GiB(25.06%)  tps: 6,267  tflops: 47.73  mfu: 15.30%
[rank2]:2025-11-02 00:58:10,010 - INFO -  final step: 2400  loss: -2.0000  grad_norm:  0.0000  tps: 6,421  tflops: 48.91  mfu: 15.19%
[rank2]:2025-11-02 00:58:10,010 - INFO - ðŸ”Ž  Running validation at step 2400
[rank1]:2025-11-02 00:58:09,998 - INFO - Avg. fwd time: 10.3088 / Avg. bwd time: 14.3743 / Avg. batch time: 604.8717 (ms) / GPU bubble ratio: 67.35%
[rank1]:2025-11-02 00:58:10,010 - INFO -  step: 2400  loss: -2.0000  grad_norm:  0.0000  memory: 15.73GiB(33.12%)  tps: 6,267  tflops: 47.73  mfu: 15.30%
[rank1]:2025-11-02 00:58:10,010 - INFO -  final step: 2400  loss: -2.0000  grad_norm:  0.0000  tps: 6,417  tflops: 48.88  mfu: 15.18%
[rank1]:2025-11-02 00:58:10,010 - INFO - ðŸ”Ž  Running validation at step 2400
[rank3]:2025-11-02 00:58:12,493 - INFO -  step: 2400  loss:  0.2234  grad_norm:  0.1022  memory: 31.14GiB(65.55%)  tps: 6,269  tflops: 47.74  mfu: 15.30%
[rank3]:2025-11-02 00:58:12,493 - INFO -  final step: 2400  loss:  0.2234  grad_norm:  0.1022  tps: 6,366  tflops: 48.49  mfu: 15.05%
[rank3]:2025-11-02 00:58:12,494 - INFO - ðŸ”Ž  Running validation at step 2400
[rank0]:2025-11-02 00:58:31,533 - INFO - validate step: 2400  loss: -1.0000  memory: 17.04GiB(35.87%)  tps: 19,032
[rank0]:2025-11-02 00:58:31,534 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-02 00:58:31,536 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank2]:2025-11-02 00:58:31,568 - INFO - validate step: 2400  loss: -1.0000  memory: 11.90GiB(25.06%)  tps: 19,001
[rank2]:2025-11-02 00:58:31,569 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-11-02 00:58:31,553 - INFO - validate step: 2400  loss: -1.0000  memory: 15.73GiB(33.12%)  tps: 19,014
[rank1]:2025-11-02 00:58:31,553 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-11-02 00:58:31,555 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank3]:2025-11-02 00:58:31,563 - INFO - validate step: 2400  loss:  0.9375  memory: 31.14GiB(65.55%)  tps: 21,481
[rank3]:2025-11-02 00:58:31,564 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-11-02 00:58:31,565 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank2]:2025-11-02 00:58:31,570 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank0]:2025-11-02 00:58:34,407 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank1]:2025-11-02 00:58:34,492 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251102_0058_stage1_final2400.svg
[rank0]:2025-11-02 00:58:34,491 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251102_0058_stage0_final2400.svg
[rank2]:2025-11-02 00:58:34,490 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251102_0058_stage2_final2400.svg
[rank3]:2025-11-02 00:58:34,597 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule/251102_0058_real_final2400_rank3.svg
[rank3]:> Batch Time: 450.77 ms, GPU Bubble Ratio: 83.92%, 62.42%, 70.82%, 10.51%
[rank1]:2025-11-02 00:58:34,706 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/frozen_params_histogram/251102_0058_rank1_stage1.svg
[rank1]:	> Counts Sum: 1332360, Total Sum: 1526400 (87.29%), Ratio(%) per element: [87.38, 87.38, 87.44, 87.5, 87.2, 87.02, 87.5, 87.26, 87.38, 86.73, 87.5, 87.08, 87.38, 87.2, 87.32, 87.32, 87.61, 87.2, 87.38, 87.26, 87.5, 87.61, 87.32, 87.08, 87.73, 87.32, 87.26, 87.26, 87.44, 87.32, 86.96, 87.26, 87.55, 87.44, 87.5, 87.5, 87.02, 87.44, 87.38, 87.38, 87.02, 87.44, 87.26, 87.26, 85.49]
[rank1]:2025-11-02 00:58:34,706 - INFO - Destroying the purge thread.
[rank0]:2025-11-02 00:58:34,715 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/frozen_params_histogram/251102_0058_rank0_stage0.svg
[rank0]:	> Counts Sum: 1099880, Total Sum: 1255040 (87.64%), Ratio(%) per element: [87.55, 87.67, 87.79, 87.55, 87.44, 87.55, 87.55, 87.61, 88.03, 87.79, 87.67, 87.79, 87.85, 87.79, 87.38, 87.44, 87.61, 87.85, 87.67, 87.61, 87.44, 87.67, 87.61, 87.44, 87.44, 87.73, 87.73, 87.61, 87.61, 87.32, 87.55, 87.55, 87.55, 87.91, 87.67, 87.79, 87.55]
[rank0]:2025-11-02 00:58:34,715 - INFO - Sleeping 2 seconds for other ranks to complete
[rank2]:2025-11-02 00:58:34,709 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/frozen_params_histogram/251102_0058_rank2_stage2.svg
[rank2]:	> Counts Sum: 1060560, Total Sum: 1221120 (86.85%), Ratio(%) per element: [86.91, 86.91, 86.85, 87.02, 86.85, 86.85, 86.85, 86.85, 86.73, 86.96, 86.91, 86.79, 86.85, 86.96, 86.85, 86.85, 86.91, 86.96, 86.85, 86.85, 86.79, 86.73, 86.91, 86.67, 86.79, 86.96, 86.85, 86.91, 86.79, 86.85, 86.79, 86.85, 86.73, 86.85, 86.79, 86.73]
[rank2]:2025-11-02 00:58:34,709 - INFO - Destroying the purge thread.
[rank3]:2025-11-02 00:58:34,788 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule/251102_0058_thry_final2400_rank3.svg
[rank3]:> Batch Time: 320.31 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:2025-11-02 00:58:34,857 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251102_0058_stage3_final2400.svg
[rank1]:2025-11-02 00:58:35,115 - INFO - Process group destroyed
[rank3]:2025-11-02 00:58:35,048 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/frozen_params_histogram/251102_0058_rank3_stage3.svg
[rank3]:	> Counts Sum: 279240, Total Sum: 983680 (28.39%), Ratio(%) per element: [28.24, 28.83, 28.59, 28.95, 28.53, 29.48, 29.0, 28.77, 28.06, 29.0, 28.83, 28.59, 28.59, 29.0, 28.83, 29.18, 28.71, 28.0, 28.71, 28.71, 28.95, 28.18, 28.36, 29.18, 29.12, 27.83, 28.0, 28.24, 20.63]
[rank3]:2025-11-02 00:58:35,049 - INFO - Destroying the purge thread.
[rank2]:2025-11-02 00:58:35,123 - INFO - Process group destroyed
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading data
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–…â–„â–…â–„â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–‡â–ˆâ–‡â–…â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–‡â–ˆâ–‡â–…â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 1.28674
[rank3]:wandb:               final/avg_loss 0.22336
[rank3]:wandb:             final/avg_mfu(%) 15.05372
[rank3]:wandb:             final/avg_tflops 48.48836
[rank3]:wandb:    final/avg_throughput(tps) 6366.46529
[rank3]:wandb:              final/grad_norm 0.10224
[rank3]:wandb:               final/max_loss 0.22336
[rank3]:wandb:                    grad_norm 0.10224
[rank3]:wandb: loss_metrics/global_avg_loss 0.22336
[rank3]:wandb: loss_metrics/global_max_loss 0.22336
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1031_GPipe_timelyapf_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/7f1po15r
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1031_GPipe_timelyapf_dm1/20251102-0002/wandb/run-20251102_000204-7f1po15r/logs
[rank0]:2025-11-02 00:58:36,716 - INFO - Training completed
[rank0]:2025-11-02 00:58:36,716 - INFO - Destroying the purge thread.
[rank3]:2025-11-02 00:58:36,962 - INFO - Process group destroyed
[rank0]:2025-11-02 00:58:37,034 - INFO - Process group destroyed
[rank1]:Stage 1: Modules to keep: {'layers.4', 'layers.7', 'layers.6', 'layers.8', 'layers.5'}
[rank0]:Stage 0: Modules to keep: {'layers.0', 'tok_embeddings', 'layers.1', 'layers.2', 'layers.3'}
[rank2]:Stage 2: Modules to keep: {'layers.11', 'layers.12', 'layers.9', 'layers.10'}
[rank3]:Stage 3: Modules to keep: {'layers.15', 'layers.13', 'layers.14', 'output', 'norm'}
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1029_llama1b/config_1031.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
[rank3]:+ more freezing in autofreeze mode. 
[rank3]:+ lr_scheduler min_lr = 0 -> 1e-6, cosine decay.
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1031_GPipe_timelyapf_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1031_GPipe_timelyapf_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1031_GPipe_timelyapf_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1031_GPipe_timelyapf_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1031_GPipe_timelyapf_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B-Instruct
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 1e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 300
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: alpaca
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 512
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 2400
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: GPipe
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 4
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1031_GPipe_timelyapf_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B-Instruct/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1031_GPipe_timelyapf_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: True
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: timelyapf
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- threshold: 0.05
[rank3]:		- percentile: 70
[rank3]:
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3

ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 11. 03. (ì›”) 19:40:08 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 3,4,5,6
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1029_llama1b/run_1031.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1029_llama1b/1031_GPipe_timelyapf.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
+ more freezing in autofreeze mode. 
+ lr_scheduler min_lr = 0 -> 1e-6, cosine decay.

âœ”ï¸Running with timelyapf x GPipe ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1029_llama1b/config_1031.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
+ more freezing in autofreeze mode. 
+ lr_scheduler min_lr = 0 -> 1e-6, cosine decay.
" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=timelyapf
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank3]:2025-11-03 19:40:14,462 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
[rank3]:+ more freezing in autofreeze mode. 
[rank3]:+ lr_scheduler min_lr = 0 -> 1e-6, cosine decay.
[rank3]:"
[rank1]:2025-11-03 19:40:14,460 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
[rank1]:+ more freezing in autofreeze mode. 
[rank1]:+ lr_scheduler min_lr = 0 -> 1e-6, cosine decay.
[rank1]:"
[rank0]:2025-11-03 19:40:14,510 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
[rank0]:+ more freezing in autofreeze mode. 
[rank0]:+ lr_scheduler min_lr = 0 -> 1e-6, cosine decay.
[rank0]:"
[rank3]:2025-11-03 19:40:14,683 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-11-03 19:40:14,685 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-11-03 19:40:14,703 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-11-03 19:40:14,705 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-11-03 19:40:14,686 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
[rank2]:+ more freezing in autofreeze mode. 
[rank2]:+ lr_scheduler min_lr = 0 -> 1e-6, cosine decay.
[rank2]:"
[rank0]:2025-11-03 19:40:14,743 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-11-03 19:40:14,745 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-03 19:40:14,749 - INFO - [GC] Initial GC collection 0.00 seconds
[rank2]:2025-11-03 19:40:14,857 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-11-03 19:40:14,860 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-03 19:40:15,145 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-11-03 19:40:15,582 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank0]:2025-11-03 19:40:18,524 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=512, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank1]:2025-11-03 19:40:18,615 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-11-03 19:40:18,653 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-11-03 19:40:18,679 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-11-03 19:40:18,679 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-11-03 19:40:18,686 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-11-03 19:40:18,724 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-03 19:40:18,726 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-11-03 19:40:18,752 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-11-03 19:40:18,753 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2025-11-03 19:40:18,846 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-11-03 19:40:18,846 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-11-03 19:40:18,847 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank0]:2025-11-03 19:40:18,931 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-03 19:40:18,931 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-11-03 19:40:18,932 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank2]:2025-11-03 19:40:21,236 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-11-03 19:40:21,275 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-11-03 19:40:21,301 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-11-03 19:40:21,301 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank2]:2025-11-03 19:40:21,471 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-11-03 19:40:21,471 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-11-03 19:40:21,472 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run 43j5ut6h
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1031_GPipe_timelyapf_dm1/20251103-1940/wandb/run-20251103_194023-43j5ut6h
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1031_GPipe_timelyapf_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/43j5ut6h
[rank3]:2025-11-03 19:40:24,802 - INFO - WandB logging enabled
[rank3]:2025-11-03 19:40:24,803 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-11-03 19:40:24,842 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-11-03 19:40:24,872 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-11-03 19:40:24,872 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank2]:2025-11-03 19:40:25,078 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-11-03 19:40:25,061 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-11-03 19:40:25,061 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-11-03 19:40:25,062 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2025-11-03 19:40:25,077 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-03 19:40:25,077 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1031_GPipe_timelyapf_dm1
[rank0]:2025-11-03 19:40:25,078 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-03 19:40:25,078 - INFO - Preparing c4_validation dataset from allenai/c4
[rank1]:2025-11-03 19:40:25,077 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-03 19:40:34,991 - INFO - Trainer is initialized with local batch size 32, global batch size 64, gradient accumulation steps 2, sequence length 512, total steps 2400 (warmup 300)
[rank0]:2025-11-03 19:40:34,991 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B-Instruct/original_dcp.
[rank0]:2025-11-03 19:40:37,255 - INFO - [GC] GC collection for checkpoint loading. 0.01 seconds
[rank0]:2025-11-03 19:40:37,255 - INFO - Finished loading the checkpoint in 2.26 seconds.
[rank0]:2025-11-03 19:40:37,255 - INFO - Training starts at step 1
[rank1]:2025-11-03 19:40:39,080 - INFO -  step:  1  loss: -2.0000  grad_norm: 85.2031  memory: 11.50GiB(24.20%)  tps: 401  tflops: 3.05  mfu: 0.98%
[rank1]:2025-11-03 19:40:39,080 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-11-03 19:40:39,087 - INFO -  step:  1  loss:  9.0164  grad_norm: 85.2031  memory: 23.19GiB(48.82%)  tps: 575  tflops: 4.38  mfu: 1.40%
[rank3]:2025-11-03 19:40:39,087 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-03 19:40:39,113 - INFO -  step:  1  loss: -2.0000  grad_norm: 85.2031  memory: 12.28GiB(25.84%)  tps: 402  tflops: 3.06  mfu: 0.98%
[rank0]:2025-11-03 19:40:39,114 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-11-03 19:40:39,076 - INFO -  step:  1  loss: -2.0000  grad_norm: 85.2031  memory:  9.35GiB(19.67%)  tps: 460  tflops: 3.51  mfu: 1.12%
[rank2]:2025-11-03 19:40:39,076 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-03 19:41:38,423 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-03 19:41:39,680 - INFO -  step: 50  loss: -2.0000  grad_norm: 49.1804  memory: 14.64GiB(30.82%)  tps: 6,624  tflops: 50.45  mfu: 16.17%
[rank3]:2025-11-03 19:41:39,688 - INFO -  step: 50  loss:  9.7985  grad_norm: 49.1804  memory: 27.51GiB(57.90%)  tps: 6,624  tflops: 50.45  mfu: 16.17%
[rank0]:2025-11-03 19:41:39,691 - INFO -  step: 50  loss: -2.0000  grad_norm: 49.1804  memory: 16.57GiB(34.88%)  tps: 6,626  tflops: 50.47  mfu: 16.18%
[rank2]:2025-11-03 19:41:39,676 - INFO -  step: 50  loss: -2.0000  grad_norm: 49.1804  memory: 11.81GiB(24.85%)  tps: 6,624  tflops: 50.45  mfu: 16.17%
[rank0]:2025-11-03 19:42:40,820 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-03 19:42:41,784 - INFO - Avg. fwd time: 10.7816 / Avg. bwd time: 42.7714 / Avg. batch time: 488.2027 (ms) / GPU bubble ratio: 12.24%
[rank1]:2025-11-03 19:42:41,891 - INFO - Avg. fwd time: 8.9290 / Avg. bwd time: 23.4788 / Avg. batch time: 558.1705 (ms) / GPU bubble ratio: 53.55%
[rank0]:2025-11-03 19:42:41,899 - INFO - Avg. fwd time: 8.0458 / Avg. bwd time: 23.7969 / Avg. batch time: 595.8588 (ms) / GPU bubble ratio: 57.25%
[rank2]:2025-11-03 19:42:41,853 - INFO - Avg. fwd time: 6.8907 / Avg. bwd time: 18.2159 / Avg. batch time: 519.2306 (ms) / GPU bubble ratio: 61.32%
[rank1]:2025-11-03 19:42:42,072 - INFO -  step: 100  loss: -2.0000  grad_norm: 31.6894  memory: 14.64GiB(30.82%)  tps: 6,565  tflops: 50.00  mfu: 16.03%
[rank1]:2025-11-03 19:42:42,076 - WARNING - Nothing to draw before the end of warmup.
[rank3]:2025-11-03 19:42:42,080 - INFO -  step: 100  loss:  8.5692  grad_norm: 31.6894  memory: 27.51GiB(57.90%)  tps: 6,565  tflops: 50.00  mfu: 16.03%
[rank3]:2025-11-03 19:42:42,081 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-11-03 19:42:42,083 - INFO -  step: 100  loss: -2.0000  grad_norm: 31.6894  memory: 16.57GiB(34.88%)  tps: 6,565  tflops: 50.00  mfu: 16.03%
[rank0]:2025-11-03 19:42:42,083 - WARNING - Nothing to draw before the end of warmup.
[rank2]:2025-11-03 19:42:42,068 - INFO -  step: 100  loss: -2.0000  grad_norm: 31.6894  memory: 11.81GiB(24.85%)  tps: 6,565  tflops: 50.00  mfu: 16.03%
[rank2]:2025-11-03 19:42:42,068 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-11-03 19:43:43,353 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-03 19:43:44,634 - INFO -  step: 150  loss: -2.0000  grad_norm: 46.0520  memory: 14.64GiB(30.82%)  tps: 6,548  tflops: 49.87  mfu: 15.98%
[rank3]:2025-11-03 19:43:44,643 - INFO -  step: 150  loss:  5.0156  grad_norm: 46.0520  memory: 27.51GiB(57.90%)  tps: 6,547  tflops: 49.87  mfu: 15.98%
[rank0]:2025-11-03 19:43:44,645 - INFO -  step: 150  loss: -2.0000  grad_norm: 46.0520  memory: 16.57GiB(34.88%)  tps: 6,547  tflops: 49.86  mfu: 15.98%
[rank2]:2025-11-03 19:43:44,630 - INFO -  step: 150  loss: -2.0000  grad_norm: 46.0520  memory: 11.81GiB(24.85%)  tps: 6,547  tflops: 49.86  mfu: 15.98%
[rank0]:2025-11-03 19:44:45,754 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-03 19:44:46,742 - INFO - Avg. fwd time: 10.7840 / Avg. bwd time: 43.0863 / Avg. batch time: 490.6522 (ms) / GPU bubble ratio: 12.17%
[rank0]:2025-11-03 19:44:46,862 - INFO - Avg. fwd time: 8.0632 / Avg. bwd time: 23.8595 / Avg. batch time: 597.1359 (ms) / GPU bubble ratio: 57.23%
[rank1]:2025-11-03 19:44:46,854 - INFO - Avg. fwd time: 8.9364 / Avg. bwd time: 23.5532 / Avg. batch time: 559.8449 (ms) / GPU bubble ratio: 53.57%
[rank2]:2025-11-03 19:44:46,815 - INFO - Avg. fwd time: 6.8841 / Avg. bwd time: 18.2708 / Avg. batch time: 521.2623 (ms) / GPU bubble ratio: 61.39%
[rank0]:2025-11-03 19:44:47,049 - INFO -  step: 200  loss: -2.0000  grad_norm: 39.0055  memory: 16.57GiB(34.88%)  tps: 6,564  tflops: 49.99  mfu: 16.02%
[rank0]:2025-11-03 19:44:47,049 - INFO - ðŸ”Ž  Running validation at step 200
[rank3]:2025-11-03 19:44:47,047 - INFO -  step: 200  loss:  1.7921  grad_norm: 39.0055  memory: 27.51GiB(57.90%)  tps: 6,564  tflops: 49.99  mfu: 16.02%
[rank3]:2025-11-03 19:44:47,047 - INFO - ðŸ”Ž  Running validation at step 200
[rank1]:2025-11-03 19:44:47,038 - INFO -  step: 200  loss: -2.0000  grad_norm: 39.0055  memory: 14.64GiB(30.82%)  tps: 6,564  tflops: 49.99  mfu: 16.02%
[rank1]:2025-11-03 19:44:47,038 - INFO - ðŸ”Ž  Running validation at step 200
[rank2]:2025-11-03 19:44:47,035 - INFO -  step: 200  loss: -2.0000  grad_norm: 39.0055  memory: 11.81GiB(24.85%)  tps: 6,564  tflops: 49.99  mfu: 16.02%
[rank2]:2025-11-03 19:44:47,035 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-11-03 19:45:12,268 - INFO - validate step: 200  loss: -1.0000  memory: 16.57GiB(34.88%)  tps: 16,242
[rank0]:2025-11-03 19:45:12,269 - WARNING - Nothing to draw before the end of warmup.
[rank3]:2025-11-03 19:45:12,295 - INFO - validate step: 200  loss:  1.5360  memory: 27.51GiB(57.90%)  tps: 16,224
[rank3]:2025-11-03 19:45:12,296 - WARNING - Nothing to draw before the end of warmup.
[rank1]:2025-11-03 19:45:12,285 - INFO - validate step: 200  loss: -1.0000  memory: 14.64GiB(30.82%)  tps: 16,224
[rank1]:2025-11-03 19:45:12,285 - WARNING - Nothing to draw before the end of warmup.
[rank2]:2025-11-03 19:45:12,302 - INFO - validate step: 200  loss: -1.0000  memory: 11.81GiB(24.85%)  tps: 16,211
[rank2]:2025-11-03 19:45:12,303 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-11-03 19:46:13,118 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-11-03 19:46:14,375 - INFO -  step: 250  loss: -2.0000  grad_norm: 35.0953  memory: 16.57GiB(34.88%)  tps: 6,595  tflops: 50.23  mfu: 16.10%
[rank1]:2025-11-03 19:46:14,364 - INFO -  step: 250  loss: -2.0000  grad_norm: 35.0953  memory: 14.64GiB(30.82%)  tps: 6,598  tflops: 50.25  mfu: 16.11%
[rank3]:2025-11-03 19:46:14,373 - INFO -  step: 250  loss:  0.6908  grad_norm: 35.0953  memory: 27.51GiB(57.90%)  tps: 6,598  tflops: 50.25  mfu: 16.11%
[rank2]:2025-11-03 19:46:14,360 - INFO -  step: 250  loss: -2.0000  grad_norm: 35.0953  memory: 11.81GiB(24.85%)  tps: 6,600  tflops: 50.27  mfu: 16.11%
[rank3]:2025-11-03 19:46:26,464 - INFO - [Step 260] ã€°ï¸ Monitoring Upperbound
[rank3]:2025-11-03 19:46:40,221 - WARNING - [Step 270] â³ Monitoring Upperbound... (540/550)
[rank2]:2025-11-03 19:46:40,245 - WARNING - [Step 270] â³ Monitoring Upperbound... (540/550)
[rank0]:2025-11-03 19:46:40,302 - WARNING - [Step 270] â³ Monitoring Upperbound... (540/550)
[rank1]:2025-11-03 19:46:40,274 - WARNING - [Step 270] â³ Monitoring Upperbound... (540/550)
[rank3]:2025-11-03 19:46:56,881 - INFO - [Step 280] âœ”ï¸  Setting Upperbound
[rank3]:2025-11-03 19:46:57,182 - INFO - [Step 280] ã€°ï¸ Monitoring Lowerbound
[rank2]:2025-11-03 19:46:59,433 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-03 19:47:01,127 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-03 19:47:01,148 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-03 19:47:01,629 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-03 19:47:01,646 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-03 19:47:01,684 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-03 19:47:01,653 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-03 19:47:01,693 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-03 19:47:01,729 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-03 19:47:01,648 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-03 19:47:01,669 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-03 19:47:01,681 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-03 19:47:01,692 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-03 19:47:01,701 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-03 19:47:01,664 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-03 19:47:01,700 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-03 19:47:01,736 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-03 19:47:01,720 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-03 19:47:01,756 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-03 19:47:01,772 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-03 19:47:01,817 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-03 19:47:01,838 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-03 19:47:01,877 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-03 19:47:01,856 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-03 19:47:01,895 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-03 19:47:01,936 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-03 19:47:01,879 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-03 19:47:01,916 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-03 19:47:01,853 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-03 19:47:01,919 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-03 19:47:01,977 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-03 19:47:01,958 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-03 19:47:17,048 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-03 19:47:17,855 - INFO - Avg. fwd time: 8.1497 / Avg. bwd time: 22.3104 / Avg. batch time: 582.6552 (ms) / GPU bubble ratio: 58.18%
[rank3]:2025-11-03 19:47:17,821 - INFO - Avg. fwd time: 10.9326 / Avg. bwd time: 41.5705 / Avg. batch time: 479.6678 (ms) / GPU bubble ratio: 12.43%
[rank3]:2025-11-03 19:47:17,824 - INFO - [Step 300] âœ”ï¸  Setting Lowerbound
[rank1]:2025-11-03 19:47:17,850 - INFO - Avg. fwd time: 9.0541 / Avg. bwd time: 22.7170 / Avg. batch time: 547.0728 (ms) / GPU bubble ratio: 53.54%
[rank2]:2025-11-03 19:47:17,835 - INFO - Avg. fwd time: 6.9771 / Avg. bwd time: 17.6138 / Avg. batch time: 509.4645 (ms) / GPU bubble ratio: 61.39%
[rank2]:2025-11-03 19:47:17,870 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-03 19:47:17,871 - INFO -  step: 300  loss: -2.0000  grad_norm:  0.0000  memory: 11.81GiB(24.85%)  tps: 6,449  tflops: 49.12  mfu: 15.74%
[rank0]:2025-11-03 19:47:17,870 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.54/0.54, [MB5] 0.14/0.14, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank0]:2025-11-03 19:47:17,871 - INFO -  step: 300  loss: -2.0000  grad_norm:  0.0000  memory: 16.57GiB(34.88%)  tps: 6,451  tflops: 49.13  mfu: 15.75%
[rank1]:2025-11-03 19:47:17,870 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.21/0.21, [MB2] 0.00/0.00, [MB3] 0.44/0.44, [MB4] 0.21/0.21, [MB5] 0.19/0.19, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-11-03 19:47:17,870 - INFO -  step: 300  loss: -2.0000  grad_norm:  0.0000  memory: 14.64GiB(30.82%)  tps: 6,450  tflops: 49.12  mfu: 15.74%
[rank3]:2025-11-03 19:47:18,065 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule/251103_1947_max_batch_time.svg
[rank3]:> Batch Time: 521.57 ms, GPU Bubble Ratio: 50.92%, 50.12%, 61.39%, 18.36%
[rank3]:2025-11-03 19:47:18,244 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule/251103_1947_min_batch_time.svg
[rank3]:> Batch Time: 299.50 ms, GPU Bubble Ratio: 78.36%, 48.40%, 60.23%, 15.76%
[rank3]:2025-11-03 19:47:18,443 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule/251103_1947_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 328.57 ms, GPU Bubble Ratio: 41.92%, 33.43%, 41.89%, 14.37%
[rank3]:2025-11-03 19:47:18,443 - INFO - 	> Batch Time: 328.57 ms (Average Freeze Ratio: 0.41, Time Reduction Rate: 0.37)
[rank3]:2025-11-03 19:47:18,445 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.40/0.40, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-11-03 19:47:18,448 - INFO -  step: 300  loss:  0.2945  grad_norm:  0.0067  memory: 30.44GiB(64.07%)  tps: 6,393  tflops: 48.69  mfu: 15.61%
[rank0]:2025-11-03 19:47:18,530 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251103_1947_stage0_step300.svg
[rank1]:2025-11-03 19:47:18,532 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251103_1947_stage1_step300.svg
[rank2]:2025-11-03 19:47:18,531 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251103_1947_stage2_step300.svg
[rank3]:2025-11-03 19:47:18,631 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule/251103_1947_real_step300_rank3.svg
[rank3]:> Batch Time: 320.87 ms, GPU Bubble Ratio: 77.19%, 47.08%, 58.99%, 14.63%
[rank3]:2025-11-03 19:47:18,702 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251103_1947_stage3_step300.svg
[rank0]:2025-11-03 19:48:15,660 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-03 19:48:16,922 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.27/0.40, [MB2] 0.67/1.00, [MB3] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank3]:2025-11-03 19:48:16,925 - INFO -  step: 350  loss:  0.1953  grad_norm:  2.2361  memory: 31.90GiB(67.15%)  tps: 7,005  tflops: 53.35  mfu: 17.10%
[rank2]:2025-11-03 19:48:17,450 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.67/1.00
[rank2]:2025-11-03 19:48:17,451 - INFO -  step: 350  loss: -2.0000  grad_norm:  2.2361  memory: 12.06GiB(25.39%)  tps: 6,875  tflops: 52.36  mfu: 16.78%
[rank1]:2025-11-03 19:48:17,693 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.14/0.21, [MB2] 0.00/0.00, [MB3] 0.30/0.44, [MB4] 0.14/0.21, [MB5] 0.13/0.19, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank1]:2025-11-03 19:48:17,694 - INFO -  step: 350  loss: -2.0000  grad_norm:  2.2361  memory: 15.11GiB(31.80%)  tps: 6,847  tflops: 52.15  mfu: 16.71%
[rank0]:2025-11-03 19:48:19,585 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.36/0.54, [MB5] 0.09/0.14, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank0]:2025-11-03 19:48:19,585 - INFO -  step: 350  loss: -2.0000  grad_norm:  2.2361  memory: 16.92GiB(35.62%)  tps: 6,637  tflops: 50.55  mfu: 16.20%
[rank0]:2025-11-03 19:49:06,307 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-03 19:49:06,957 - INFO - Avg. fwd time: 11.3368 / Avg. bwd time: 38.0299 / Avg. batch time: 454.5244 (ms) / GPU bubble ratio: 13.11%
[rank0]:2025-11-03 19:49:06,989 - INFO - Avg. fwd time: 8.3472 / Avg. bwd time: 19.8073 / Avg. batch time: 556.9591 (ms) / GPU bubble ratio: 59.56%
[rank2]:2025-11-03 19:49:07,008 - INFO - Avg. fwd time: 7.2020 / Avg. bwd time: 16.0931 / Avg. batch time: 487.9800 (ms) / GPU bubble ratio: 61.81%
[rank1]:2025-11-03 19:49:07,044 - INFO - Avg. fwd time: 9.3372 / Avg. bwd time: 20.7209 / Avg. batch time: 523.9701 (ms) / GPU bubble ratio: 54.11%
[rank2]:2025-11-03 19:49:07,151 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-03 19:49:07,152 - INFO -  step: 400  loss: -2.0000  grad_norm:  0.0875  memory: 12.12GiB(25.51%)  tps: 8,241  tflops: 62.77  mfu: 20.12%
[rank2]:2025-11-03 19:49:07,152 - INFO - ðŸ”Ž  Running validation at step 400
[rank3]:2025-11-03 19:49:07,290 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.40/0.40, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-11-03 19:49:07,293 - INFO -  step: 400  loss:  0.2275  grad_norm:  0.0875  memory: 31.90GiB(67.15%)  tps: 8,132  tflops: 61.94  mfu: 19.85%
[rank3]:2025-11-03 19:49:07,293 - INFO - ðŸ”Ž  Running validation at step 400
[rank1]:2025-11-03 19:49:07,332 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.21/0.21, [MB2] 0.00/0.00, [MB3] 0.44/0.44, [MB4] 0.21/0.21, [MB5] 0.19/0.19, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-11-03 19:49:07,333 - INFO -  step: 400  loss: -2.0000  grad_norm:  0.0875  memory: 15.11GiB(31.80%)  tps: 8,252  tflops: 62.85  mfu: 20.14%
[rank1]:2025-11-03 19:49:07,333 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-11-03 19:49:07,444 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.54/0.54, [MB5] 0.14/0.14, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank0]:2025-11-03 19:49:07,444 - INFO -  step: 400  loss: -2.0000  grad_norm:  0.0875  memory: 17.10GiB(35.99%)  tps: 8,559  tflops: 65.18  mfu: 20.89%
[rank0]:2025-11-03 19:49:07,444 - INFO - ðŸ”Ž  Running validation at step 400
[rank2]:2025-11-03 19:49:28,098 - INFO - validate step: 400  loss: -1.0000  memory: 12.12GiB(25.51%)  tps: 19,555
[rank3]:2025-11-03 19:49:28,092 - INFO - validate step: 400  loss:  0.9404  memory: 31.90GiB(67.15%)  tps: 19,695
[rank0]:2025-11-03 19:49:28,058 - INFO - validate step: 400  loss: -1.0000  memory: 17.10GiB(35.99%)  tps: 19,870
[rank1]:2025-11-03 19:49:28,079 - INFO - validate step: 400  loss: -1.0000  memory: 15.11GiB(31.80%)  tps: 19,743
[rank2]:2025-11-03 19:49:28,175 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251103_1949_stage2_step400.svg
[rank0]:2025-11-03 19:49:28,176 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251103_1949_stage0_step400.svg
[rank1]:2025-11-03 19:49:28,176 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251103_1949_stage1_step400.svg
[rank3]:2025-11-03 19:49:28,286 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule/251103_1949_real_step400_rank3.svg
[rank3]:> Batch Time: 343.75 ms, GPU Bubble Ratio: 54.11%, 45.96%, 57.85%, 18.04%
[rank3]:2025-11-03 19:49:28,356 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251103_1949_stage3_step400.svg
[rank0]:2025-11-03 19:50:07,907 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-11-03 19:50:08,714 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.21/0.21, [MB2] 0.00/0.00, [MB3] 0.44/0.44, [MB4] 0.21/0.21, [MB5] 0.19/0.19, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-11-03 19:50:08,698 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.40/0.40, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-11-03 19:50:08,716 - INFO -  step: 450  loss:  0.2375  grad_norm:  0.0000  memory: 31.90GiB(67.15%)  tps: 10,083  tflops: 76.79  mfu: 24.61%
[rank2]:2025-11-03 19:50:08,699 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-03 19:50:08,715 - INFO -  step: 450  loss: -2.0000  grad_norm:  0.0000  memory: 12.12GiB(25.51%)  tps: 10,084  tflops: 76.81  mfu: 24.62%
[rank0]:2025-11-03 19:50:08,716 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.54/0.54, [MB5] 0.14/0.14, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank0]:2025-11-03 19:50:08,717 - INFO -  step: 450  loss: -2.0000  grad_norm:  0.0000  memory: 17.10GiB(35.99%)  tps: 10,074  tflops: 76.73  mfu: 24.59%
[rank1]:2025-11-03 19:50:08,715 - INFO -  step: 450  loss: -2.0000  grad_norm:  0.0000  memory: 15.11GiB(31.80%)  tps: 10,080  tflops: 76.77  mfu: 24.61%
[rank0]:2025-11-03 19:50:48,285 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-03 19:50:48,737 - INFO - Avg. fwd time: 8.5272 / Avg. bwd time: 15.7678 / Avg. batch time: 522.7580 (ms) / GPU bubble ratio: 62.82%
[rank3]:2025-11-03 19:50:48,914 - INFO - Avg. fwd time: 11.7815 / Avg. bwd time: 34.4340 / Avg. batch time: 429.2788 (ms) / GPU bubble ratio: 13.87%
[rank2]:2025-11-03 19:50:48,951 - INFO - Avg. fwd time: 7.4626 / Avg. bwd time: 14.3959 / Avg. batch time: 459.9937 (ms) / GPU bubble ratio: 61.98%
[rank1]:2025-11-03 19:50:48,996 - INFO - Avg. fwd time: 9.6569 / Avg. bwd time: 18.5703 / Avg. batch time: 493.5920 (ms) / GPU bubble ratio: 54.25%
[rank3]:2025-11-03 19:50:49,206 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251103_1950_rank3_trend_line.svg
[rank2]:2025-11-03 19:50:49,206 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251103_1950_rank2_trend_line.svg
[rank0]:2025-11-03 19:50:49,218 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251103_1950_rank0_trend_line.svg
[rank0]:2025-11-03 19:50:49,225 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-11-03 19:50:49,226 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-11-03 19:50:49,226 - INFO -  step: 500  loss: -2.0000  grad_norm:  0.0000  memory: 17.10GiB(35.99%)  tps: 10,111  tflops: 77.01  mfu: 24.68%
[rank1]:2025-11-03 19:50:49,218 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251103_1950_rank1_trend_line.svg
[rank1]:2025-11-03 19:50:49,225 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-11-03 19:50:49,226 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-11-03 19:50:49,227 - INFO -  step: 500  loss: -2.0000  grad_norm:  0.0000  memory: 15.11GiB(31.80%)  tps: 10,111  tflops: 77.01  mfu: 24.68%
[rank2]:2025-11-03 19:50:49,225 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-03 19:50:49,226 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-03 19:50:49,226 - INFO -  step: 500  loss: -2.0000  grad_norm:  0.0000  memory: 12.12GiB(25.51%)  tps: 10,111  tflops: 77.01  mfu: 24.68%
[rank3]:2025-11-03 19:50:49,419 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule/251103_1950_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 317.41 ms, GPU Bubble Ratio: 65.78%, 46.87%, 59.45%, 16.44%
[rank3]:2025-11-03 19:50:49,420 - INFO - 	> Batch Time: 317.41 ms (Average Freeze Ratio: 0.29)
[rank3]:2025-11-03 19:50:49,420 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 0.40/0.40, [MB7] 0.00/0.00
[rank3]:2025-11-03 19:50:49,422 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 0.40/0.40, [MB7] 0.00/0.00
[rank3]:2025-11-03 19:50:49,425 - INFO -  step: 500  loss:  0.2709  grad_norm:  0.0000  memory: 31.90GiB(67.15%)  tps: 10,062  tflops: 76.64  mfu: 24.56%
[rank2]:2025-11-03 19:50:49,491 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251103_1950_stage2_step500.svg
[rank0]:2025-11-03 19:50:49,490 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251103_1950_stage0_step500.svg
[rank1]:2025-11-03 19:50:49,493 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251103_1950_stage1_step500.svg
[rank3]:2025-11-03 19:50:49,604 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule/251103_1950_real_step500_rank3.svg
[rank3]:> Batch Time: 322.72 ms, GPU Bubble Ratio: 77.21%, 47.02%, 59.04%, 14.53%
[rank3]:2025-11-03 19:50:49,667 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251103_1950_stage3_step500.svg
[rank0]:2025-11-03 19:51:57,016 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-03 19:51:58,091 - INFO -  step: 550  loss: -2.0000  grad_norm:  0.0000  memory: 12.12GiB(25.51%)  tps: 5,948  tflops: 45.30  mfu: 14.52%
[rank0]:2025-11-03 19:51:58,092 - INFO -  step: 550  loss: -2.0000  grad_norm:  0.0000  memory: 17.10GiB(35.99%)  tps: 5,948  tflops: 45.30  mfu: 14.52%
[rank1]:2025-11-03 19:51:58,092 - INFO -  step: 550  loss: -2.0000  grad_norm:  0.0000  memory: 15.11GiB(31.80%)  tps: 5,948  tflops: 45.30  mfu: 14.52%
[rank3]:2025-11-03 19:52:01,792 - INFO -  step: 550  loss:  0.2647  grad_norm:  0.0963  memory: 31.90GiB(67.15%)  tps: 5,660  tflops: 43.11  mfu: 13.82%
[rank0]:2025-11-03 19:53:08,607 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-03 19:53:09,646 - INFO - Avg. fwd time: 11.6165 / Avg. bwd time: 35.1908 / Avg. batch time: 434.0259 (ms) / GPU bubble ratio: 13.72%
[rank2]:2025-11-03 19:53:09,660 - INFO - Avg. fwd time: 7.6289 / Avg. bwd time: 13.2862 / Avg. batch time: 491.0866 (ms) / GPU bubble ratio: 65.93%
[rank0]:2025-11-03 19:53:09,682 - INFO - Avg. fwd time: 8.6424 / Avg. bwd time: 13.0088 / Avg. batch time: 549.3139 (ms) / GPU bubble ratio: 68.47%
[rank1]:2025-11-03 19:53:09,676 - INFO - Avg. fwd time: 9.8624 / Avg. bwd time: 17.1437 / Avg. batch time: 523.0949 (ms) / GPU bubble ratio: 58.70%
[rank0]:2025-11-03 19:53:09,838 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251103_1953_rank0_trend_line.svg
[rank0]:2025-11-03 19:53:09,844 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-11-03 19:53:09,845 - INFO -  step: 600  loss: -2.0000  grad_norm:  0.0000  memory: 17.10GiB(35.99%)  tps: 5,708  tflops: 43.48  mfu: 13.93%
[rank0]:2025-11-03 19:53:09,846 - INFO - ðŸ”Ž  Running validation at step 600
[rank1]:2025-11-03 19:53:09,837 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251103_1953_rank1_trend_line.svg
[rank1]:2025-11-03 19:53:09,844 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-11-03 19:53:09,846 - INFO -  step: 600  loss: -2.0000  grad_norm:  0.0000  memory: 15.11GiB(31.80%)  tps: 5,708  tflops: 43.48  mfu: 13.93%
[rank1]:2025-11-03 19:53:09,846 - INFO - ðŸ”Ž  Running validation at step 600
[rank3]:2025-11-03 19:53:09,829 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251103_1953_rank3_trend_line.svg
[rank2]:2025-11-03 19:53:09,819 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251103_1953_rank2_trend_line.svg
[rank2]:2025-11-03 19:53:09,844 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-03 19:53:09,846 - INFO -  step: 600  loss: -2.0000  grad_norm:  0.0000  memory: 12.12GiB(25.51%)  tps: 5,708  tflops: 43.48  mfu: 13.93%
[rank2]:2025-11-03 19:53:09,846 - INFO - ðŸ”Ž  Running validation at step 600
[rank3]:2025-11-03 19:53:10,043 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule/251103_1953_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 364.79 ms, GPU Bubble Ratio: 75.64%, 55.66%, 65.82%, 14.03%
[rank3]:2025-11-03 19:53:10,044 - INFO - 	> Batch Time: 364.79 ms (Average Freeze Ratio: 0.29)
[rank3]:2025-11-03 19:53:10,044 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 0.40/0.40, [MB7] 0.00/0.00
[rank3]:2025-11-03 19:53:13,722 - INFO -  step: 600  loss:  0.2208  grad_norm:  0.0841  memory: 31.90GiB(67.15%)  tps: 5,695  tflops: 43.37  mfu: 13.90%
[rank3]:2025-11-03 19:53:13,722 - INFO - ðŸ”Ž  Running validation at step 600
[rank1]:2025-11-03 19:53:32,659 - INFO - validate step: 600  loss: -1.0000  memory: 15.11GiB(31.80%)  tps: 17,955
[rank0]:2025-11-03 19:53:32,640 - INFO - validate step: 600  loss: -1.0000  memory: 17.10GiB(35.99%)  tps: 17,970
[rank3]:2025-11-03 19:53:32,668 - INFO - validate step: 600  loss:  0.9428  memory: 31.90GiB(67.15%)  tps: 21,621
[rank2]:2025-11-03 19:53:32,673 - INFO - validate step: 600  loss: -1.0000  memory: 12.12GiB(25.51%)  tps: 17,944
[rank2]:2025-11-03 19:53:32,745 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251103_1953_stage2_step600.svg
[rank1]:2025-11-03 19:53:32,750 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251103_1953_stage1_step600.svg
[rank0]:2025-11-03 19:53:32,745 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251103_1953_stage0_step600.svg
[rank3]:2025-11-03 19:53:32,848 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule/251103_1953_real_step600_rank3.svg
[rank3]:> Batch Time: 451.13 ms, GPU Bubble Ratio: 83.74%, 62.36%, 70.83%, 10.58%
[rank3]:2025-11-03 19:53:32,914 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251103_1953_stage3_step600.svg
[rank0]:2025-11-03 19:54:39,830 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-11-03 19:54:40,899 - INFO -  step: 650  loss: -2.0000  grad_norm:  0.0000  memory: 17.10GiB(35.99%)  tps: 6,001  tflops: 45.70  mfu: 14.65%
[rank2]:2025-11-03 19:54:40,898 - INFO -  step: 650  loss: -2.0000  grad_norm:  0.0000  memory: 12.12GiB(25.51%)  tps: 6,004  tflops: 45.73  mfu: 14.66%
[rank1]:2025-11-03 19:54:40,899 - INFO -  step: 650  loss: -2.0000  grad_norm:  0.0000  memory: 15.11GiB(31.80%)  tps: 6,002  tflops: 45.72  mfu: 14.65%
[rank3]:2025-11-03 19:54:44,586 - INFO -  step: 650  loss:  0.3652  grad_norm:  0.0809  memory: 31.90GiB(67.15%)  tps: 5,696  tflops: 43.38  mfu: 13.90%
[rank0]:2025-11-03 19:55:51,278 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-03 19:55:51,856 - INFO - Avg. fwd time: 8.7123 / Avg. bwd time: 11.3123 / Avg. batch time: 566.8683 (ms) / GPU bubble ratio: 71.74%
[rank3]:2025-11-03 19:55:52,096 - INFO - Avg. fwd time: 11.4948 / Avg. bwd time: 35.7526 / Avg. batch time: 437.5537 (ms) / GPU bubble ratio: 13.62%
[rank2]:2025-11-03 19:55:52,078 - INFO - Avg. fwd time: 7.7307 / Avg. bwd time: 12.6021 / Avg. batch time: 511.4420 (ms) / GPU bubble ratio: 68.20%
[rank1]:2025-11-03 19:55:52,153 - INFO - Avg. fwd time: 9.9875 / Avg. bwd time: 16.2645 / Avg. batch time: 542.4691 (ms) / GPU bubble ratio: 61.29%
[rank2]:2025-11-03 19:55:52,325 - INFO -  step: 700  loss: -2.0000  grad_norm:  0.0000  memory: 12.12GiB(25.51%)  tps: 5,734  tflops: 43.68  mfu: 14.00%
[rank0]:2025-11-03 19:55:52,326 - INFO -  step: 700  loss: -2.0000  grad_norm:  0.0000  memory: 17.10GiB(35.99%)  tps: 5,734  tflops: 43.68  mfu: 14.00%
[rank1]:2025-11-03 19:55:52,327 - INFO -  step: 700  loss: -2.0000  grad_norm:  0.0000  memory: 15.11GiB(31.80%)  tps: 5,734  tflops: 43.68  mfu: 14.00%
[rank3]:2025-11-03 19:55:56,000 - INFO -  step: 700  loss:  0.2393  grad_norm:  0.0793  memory: 31.90GiB(67.15%)  tps: 5,736  tflops: 43.68  mfu: 14.00%
[rank0]:2025-11-03 19:55:56,076 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251103_1955_stage0_step700.svg
[rank1]:2025-11-03 19:55:56,086 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251103_1955_stage1_step700.svg
[rank2]:2025-11-03 19:55:56,076 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251103_1955_stage2_step700.svg
[rank3]:2025-11-03 19:55:56,175 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule/251103_1955_real_step700_rank3.svg
[rank3]:> Batch Time: 450.92 ms, GPU Bubble Ratio: 83.75%, 62.35%, 70.83%, 10.52%
[rank3]:2025-11-03 19:55:56,244 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251103_1955_stage3_step700.svg
[rank0]:2025-11-03 19:57:03,037 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-03 19:57:04,112 - INFO -  step: 750  loss: -2.0000  grad_norm:  0.0000  memory: 12.12GiB(25.51%)  tps: 5,706  tflops: 43.46  mfu: 13.93%
[rank0]:2025-11-03 19:57:04,113 - INFO -  step: 750  loss: -2.0000  grad_norm:  0.0000  memory: 17.10GiB(35.99%)  tps: 5,706  tflops: 43.46  mfu: 13.93%
[rank1]:2025-11-03 19:57:04,112 - INFO -  step: 750  loss: -2.0000  grad_norm:  0.0000  memory: 15.11GiB(31.80%)  tps: 5,706  tflops: 43.46  mfu: 13.93%
[rank3]:2025-11-03 19:57:07,842 - INFO -  step: 750  loss:  0.2292  grad_norm:  0.0723  memory: 31.90GiB(67.15%)  tps: 5,702  tflops: 43.42  mfu: 13.92%
[rank0]:2025-11-03 19:58:14,491 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-03 19:58:15,078 - INFO - Avg. fwd time: 8.7719 / Avg. bwd time: 9.8185 / Avg. batch time: 583.7531 (ms) / GPU bubble ratio: 74.52%
[rank3]:2025-11-03 19:58:15,331 - INFO - Avg. fwd time: 11.3869 / Avg. bwd time: 36.2630 / Avg. batch time: 440.7823 (ms) / GPU bubble ratio: 13.52%
[rank2]:2025-11-03 19:58:15,307 - INFO - Avg. fwd time: 7.8192 / Avg. bwd time: 11.9970 / Avg. batch time: 530.7981 (ms) / GPU bubble ratio: 70.13%
[rank1]:2025-11-03 19:58:15,392 - INFO - Avg. fwd time: 10.0958 / Avg. bwd time: 15.4883 / Avg. batch time: 560.9566 (ms) / GPU bubble ratio: 63.51%
[rank1]:2025-11-03 19:58:15,767 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251103_1958_rank1_trend_line.svg
[rank1]:2025-11-03 19:58:15,774 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank1]:2025-11-03 19:58:15,776 - INFO -  step: 800  loss: -2.0000  grad_norm:  0.0000  memory: 15.11GiB(31.80%)  tps: 5,716  tflops: 43.53  mfu: 13.95%
[rank1]:2025-11-03 19:58:15,776 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-11-03 19:58:15,768 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251103_1958_rank0_trend_line.svg
[rank0]:2025-11-03 19:58:15,774 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank0]:2025-11-03 19:58:15,776 - INFO -  step: 800  loss: -2.0000  grad_norm:  0.0000  memory: 17.10GiB(35.99%)  tps: 5,716  tflops: 43.53  mfu: 13.95%
[rank0]:2025-11-03 19:58:15,776 - INFO - ðŸ”Ž  Running validation at step 800
[rank3]:2025-11-03 19:58:15,749 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251103_1958_rank3_trend_line.svg
[rank2]:2025-11-03 19:58:15,758 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251103_1958_rank2_trend_line.svg
[rank2]:2025-11-03 19:58:15,774 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-03 19:58:15,776 - INFO -  step: 800  loss: -2.0000  grad_norm:  0.0000  memory: 12.12GiB(25.51%)  tps: 5,716  tflops: 43.53  mfu: 13.95%
[rank2]:2025-11-03 19:58:15,776 - INFO - ðŸ”Ž  Running validation at step 800
[rank3]:2025-11-03 19:58:15,957 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule/251103_1958_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 400.40 ms, GPU Bubble Ratio: 81.01%, 60.69%, 69.61%, 12.28%
[rank3]:2025-11-03 19:58:15,958 - INFO - 	> Batch Time: 400.40 ms (Average Freeze Ratio: 0.23)
[rank3]:2025-11-03 19:58:15,958 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 0.40/0.40, [MB7] 0.00/0.00
[rank3]:2025-11-03 19:58:19,740 - INFO -  step: 800  loss:  0.2656  grad_norm:  0.0994  memory: 31.90GiB(67.15%)  tps: 5,697  tflops: 43.39  mfu: 13.91%
[rank3]:2025-11-03 19:58:19,740 - INFO - ðŸ”Ž  Running validation at step 800
[rank1]:2025-11-03 19:58:38,692 - INFO - validate step: 800  loss: -1.0000  memory: 15.11GiB(31.80%)  tps: 17,874
[rank0]:2025-11-03 19:58:38,673 - INFO - validate step: 800  loss: -1.0000  memory: 17.10GiB(35.99%)  tps: 17,889
[rank3]:2025-11-03 19:58:38,704 - INFO - validate step: 800  loss:  0.9443  memory: 31.90GiB(67.15%)  tps: 21,600
[rank2]:2025-11-03 19:58:38,708 - INFO - validate step: 800  loss: -1.0000  memory: 12.12GiB(25.51%)  tps: 17,862
[rank2]:2025-11-03 19:58:38,785 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251103_1958_stage2_step800.svg
[rank1]:2025-11-03 19:58:38,786 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251103_1958_stage1_step800.svg
[rank0]:2025-11-03 19:58:38,785 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251103_1958_stage0_step800.svg
[rank3]:2025-11-03 19:58:38,878 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule/251103_1958_real_step800_rank3.svg
[rank3]:> Batch Time: 449.99 ms, GPU Bubble Ratio: 83.72%, 62.31%, 70.82%, 10.51%
[rank3]:2025-11-03 19:58:38,947 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251103_1958_stage3_step800.svg
[rank3]:2025-11-03 19:58:55,580 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-11-03 19:58:55,790 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-11-03 19:58:55,818 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-11-03 19:58:55,843 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-11-03 19:59:54,070 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-11-03 19:59:55,197 - INFO -  step: 850  loss: -2.0000  grad_norm:  0.0000  memory: 12.12GiB(25.51%)  tps: 5,355  tflops: 40.79  mfu: 13.07%
[rank1]:2025-11-03 19:59:57,822 - INFO -  step: 850  loss: -2.0000  grad_norm:  6.2144  memory: 15.11GiB(31.80%)  tps: 5,176  tflops: 39.42  mfu: 12.64%
[rank3]:2025-11-03 19:59:59,114 - INFO -  step: 850  loss:  0.2201  grad_norm:  6.2144  memory: 31.90GiB(67.15%)  tps: 5,094  tflops: 38.80  mfu: 12.43%
[rank0]:2025-11-03 19:59:59,550 - INFO -  step: 850  loss: -2.0000  grad_norm:  6.2144  memory: 17.10GiB(35.99%)  tps: 5,064  tflops: 38.57  mfu: 12.36%
[rank0]:2025-11-03 20:01:13,993 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-03 20:01:15,074 - INFO - Avg. fwd time: 11.2959 / Avg. bwd time: 36.6156 / Avg. batch time: 442.8725 (ms) / GPU bubble ratio: 13.45%
[rank2]:2025-11-03 20:01:15,089 - INFO - Avg. fwd time: 7.8866 / Avg. bwd time: 11.5340 / Avg. batch time: 524.7648 (ms) / GPU bubble ratio: 70.39%
[rank1]:2025-11-03 20:01:15,119 - INFO - Avg. fwd time: 9.9648 / Avg. bwd time: 16.3712 / Avg. batch time: 555.7564 (ms) / GPU bubble ratio: 62.09%
[rank0]:2025-11-03 20:01:15,149 - INFO - Avg. fwd time: 8.6887 / Avg. bwd time: 11.3119 / Avg. batch time: 580.0460 (ms) / GPU bubble ratio: 72.42%
[rank2]:2025-11-03 20:01:15,157 - INFO -  step: 900  loss: -2.0000  grad_norm:  0.0000  memory: 12.12GiB(25.51%)  tps: 5,123  tflops: 39.01  mfu: 12.50%
[rank1]:2025-11-03 20:01:17,791 - INFO -  step: 900  loss: -2.0000  grad_norm:  0.8191  memory: 15.11GiB(31.80%)  tps: 5,122  tflops: 39.01  mfu: 12.50%
[rank3]:2025-11-03 20:01:19,186 - INFO -  step: 900  loss:  0.2335  grad_norm:  0.8191  memory: 31.90GiB(67.15%)  tps: 5,116  tflops: 38.96  mfu: 12.49%
[rank0]:2025-11-03 20:01:19,646 - INFO -  step: 900  loss: -2.0000  grad_norm:  0.8191  memory: 17.10GiB(35.99%)  tps: 5,114  tflops: 38.95  mfu: 12.48%
[rank2]:2025-11-03 20:01:19,714 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251103_2001_stage2_step900.svg
[rank1]:2025-11-03 20:01:19,718 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251103_2001_stage1_step900.svg
[rank0]:2025-11-03 20:01:19,715 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251103_2001_stage0_step900.svg
[rank3]:2025-11-03 20:01:19,830 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule/251103_2001_real_step900_rank3.svg
[rank3]:> Batch Time: 484.54 ms, GPU Bubble Ratio: 47.43%, 46.38%, 72.93%, 17.44%
[rank3]:2025-11-03 20:01:19,892 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251103_2001_stage3_step900.svg
[rank0]:2025-11-03 20:02:34,516 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-03 20:02:35,677 - INFO -  step: 950  loss: -2.0000  grad_norm:  0.0000  memory: 12.12GiB(25.51%)  tps: 5,087  tflops: 38.74  mfu: 12.42%
[rank1]:2025-11-03 20:02:38,320 - INFO -  step: 950  loss: -2.0000  grad_norm:  0.4181  memory: 15.11GiB(31.80%)  tps: 5,086  tflops: 38.74  mfu: 12.42%
[rank3]:2025-11-03 20:02:39,617 - INFO -  step: 950  loss:  0.1991  grad_norm:  0.4181  memory: 31.90GiB(67.15%)  tps: 5,093  tflops: 38.79  mfu: 12.43%
[rank0]:2025-11-03 20:02:40,072 - INFO -  step: 950  loss: -2.0000  grad_norm:  0.4181  memory: 17.10GiB(35.99%)  tps: 5,093  tflops: 38.79  mfu: 12.43%
[rank0]:2025-11-03 20:03:54,468 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-03 20:03:55,363 - INFO - Avg. fwd time: 11.2333 / Avg. bwd time: 36.8437 / Avg. batch time: 444.1943 (ms) / GPU bubble ratio: 13.41%
[rank2]:2025-11-03 20:03:55,339 - INFO - Avg. fwd time: 7.9333 / Avg. bwd time: 11.2150 / Avg. batch time: 520.5113 (ms) / GPU bubble ratio: 70.57%
[rank1]:2025-11-03 20:03:55,484 - INFO - Avg. fwd time: 9.8662 / Avg. bwd time: 17.0499 / Avg. batch time: 552.1441 (ms) / GPU bubble ratio: 61.00%
[rank0]:2025-11-03 20:03:55,491 - INFO - Avg. fwd time: 8.6290 / Avg. bwd time: 12.4566 / Avg. batch time: 577.5815 (ms) / GPU bubble ratio: 70.79%
[rank2]:2025-11-03 20:03:55,639 - INFO -  step: 1000  loss: -2.0000  grad_norm:  0.0000  memory: 12.12GiB(25.51%)  tps: 5,122  tflops: 39.01  mfu: 12.50%
[rank2]:2025-11-03 20:03:55,639 - INFO - ðŸ”Ž  Running validation at step 1000
[rank1]:2025-11-03 20:03:58,121 - INFO -  step: 1000  loss: -2.0000  grad_norm:  0.6954  memory: 15.11GiB(31.80%)  tps: 5,133  tflops: 39.09  mfu: 12.53%
[rank1]:2025-11-03 20:03:58,121 - INFO - ðŸ”Ž  Running validation at step 1000
[rank3]:2025-11-03 20:03:59,569 - INFO -  step: 1000  loss:  0.2840  grad_norm:  0.6954  memory: 31.90GiB(67.15%)  tps: 5,123  tflops: 39.02  mfu: 12.51%
[rank3]:2025-11-03 20:03:59,570 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-11-03 20:04:00,072 - INFO -  step: 1000  loss: -2.0000  grad_norm:  0.6954  memory: 17.10GiB(35.99%)  tps: 5,120  tflops: 39.00  mfu: 12.50%
[rank0]:2025-11-03 20:04:00,072 - INFO - ðŸ”Ž  Running validation at step 1000
[rank1]:2025-11-03 20:04:19,106 - INFO - validate step: 1000  loss: -1.0000  memory: 15.11GiB(31.80%)  tps: 19,519
[rank0]:2025-11-03 20:04:19,088 - INFO - validate step: 1000  loss: -1.0000  memory: 17.10GiB(35.99%)  tps: 21,540
[rank3]:2025-11-03 20:04:19,113 - INFO - validate step: 1000  loss:  0.9383  memory: 31.90GiB(67.15%)  tps: 20,959
[rank2]:2025-11-03 20:04:19,119 - INFO - validate step: 1000  loss: -1.0000  memory: 12.12GiB(25.51%)  tps: 17,445
[rank1]:2025-11-03 20:04:19,196 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251103_2004_stage1_step1000.svg
[rank0]:2025-11-03 20:04:19,189 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251103_2004_stage0_step1000.svg
[rank2]:2025-11-03 20:04:19,189 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251103_2004_stage2_step1000.svg
[rank3]:2025-11-03 20:04:19,303 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule/251103_2004_real_step1000_rank3.svg
[rank3]:> Batch Time: 482.86 ms, GPU Bubble Ratio: 47.12%, 46.03%, 72.81%, 17.50%
[rank3]:2025-11-03 20:04:19,367 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251103_2004_stage3_step1000.svg
[rank0]:2025-11-03 20:05:34,482 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-11-03 20:05:35,641 - INFO -  step: 1050  loss: -2.0000  grad_norm:  0.0000  memory: 12.12GiB(25.51%)  tps: 5,353  tflops: 40.77  mfu: 13.07%
[rank1]:2025-11-03 20:05:38,118 - INFO -  step: 1050  loss: -2.0000  grad_norm:  0.6880  memory: 15.11GiB(31.80%)  tps: 5,184  tflops: 39.48  mfu: 12.65%
[rank3]:2025-11-03 20:05:39,516 - INFO -  step: 1050  loss:  0.2951  grad_norm:  0.6880  memory: 31.90GiB(67.15%)  tps: 5,094  tflops: 38.80  mfu: 12.44%
[rank0]:2025-11-03 20:05:40,064 - INFO -  step: 1050  loss: -2.0000  grad_norm:  0.6880  memory: 17.10GiB(35.99%)  tps: 5,058  tflops: 38.52  mfu: 12.35%
[rank0]:2025-11-03 20:06:54,592 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-03 20:06:55,460 - INFO - Avg. fwd time: 7.9786 / Avg. bwd time: 10.9103 / Avg. batch time: 516.4735 (ms) / GPU bubble ratio: 70.74%
[rank3]:2025-11-03 20:06:55,481 - INFO - Avg. fwd time: 11.1744 / Avg. bwd time: 37.0676 / Avg. batch time: 445.5124 (ms) / GPU bubble ratio: 13.37%
[rank1]:2025-11-03 20:06:55,597 - INFO - Avg. fwd time: 9.7720 / Avg. bwd time: 17.7030 / Avg. batch time: 548.7305 (ms) / GPU bubble ratio: 59.94%
[rank0]:2025-11-03 20:06:55,605 - INFO - Avg. fwd time: 8.5727 / Avg. bwd time: 13.5531 / Avg. batch time: 575.2705 (ms) / GPU bubble ratio: 69.23%
[rank2]:2025-11-03 20:06:55,751 - INFO -  step: 1100  loss: -2.0000  grad_norm:  0.0000  memory: 12.12GiB(25.51%)  tps: 5,113  tflops: 38.94  mfu: 12.48%
[rank1]:2025-11-03 20:06:58,257 - INFO -  step: 1100  loss: -2.0000  grad_norm:  0.6082  memory: 15.11GiB(31.80%)  tps: 5,111  tflops: 38.93  mfu: 12.48%
[rank3]:2025-11-03 20:06:59,684 - INFO -  step: 1100  loss:  0.3309  grad_norm:  0.6082  memory: 31.90GiB(67.15%)  tps: 5,109  tflops: 38.91  mfu: 12.47%
[rank0]:2025-11-03 20:07:00,110 - INFO -  step: 1100  loss: -2.0000  grad_norm:  0.6082  memory: 17.10GiB(35.99%)  tps: 5,117  tflops: 38.97  mfu: 12.49%
[rank2]:2025-11-03 20:07:00,182 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251103_2006_stage2_step1100.svg
[rank1]:2025-11-03 20:07:00,183 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251103_2006_stage1_step1100.svg
[rank0]:2025-11-03 20:07:00,181 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251103_2007_stage0_step1100.svg
[rank3]:2025-11-03 20:07:00,294 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule/251103_2006_real_step1100_rank3.svg
[rank3]:> Batch Time: 484.66 ms, GPU Bubble Ratio: 47.35%, 46.38%, 72.88%, 17.47%
[rank3]:2025-11-03 20:07:00,359 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251103_2006_stage3_step1100.svg
[rank0]:2025-11-03 20:08:14,363 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-03 20:08:15,522 - INFO -  step: 1150  loss: -2.0000  grad_norm:  0.0000  memory: 12.12GiB(25.51%)  tps: 5,135  tflops: 39.11  mfu: 12.53%
[rank1]:2025-11-03 20:08:18,186 - INFO -  step: 1150  loss: -2.0000  grad_norm:  0.4603  memory: 15.11GiB(31.80%)  tps: 5,125  tflops: 39.03  mfu: 12.51%
[rank3]:2025-11-03 20:08:19,422 - INFO -  step: 1150  loss:  0.2473  grad_norm:  0.4603  memory: 31.90GiB(67.15%)  tps: 5,137  tflops: 39.12  mfu: 12.54%
[rank0]:2025-11-03 20:08:19,886 - INFO -  step: 1150  loss: -2.0000  grad_norm:  0.4603  memory: 17.10GiB(35.99%)  tps: 5,134  tflops: 39.10  mfu: 12.53%
[rank0]:2025-11-03 20:09:33,967 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-03 20:09:35,073 - INFO - Avg. fwd time: 8.0156 / Avg. bwd time: 10.6586 / Avg. batch time: 513.1095 (ms) / GPU bubble ratio: 70.88%
[rank3]:2025-11-03 20:09:35,057 - INFO - Avg. fwd time: 11.1253 / Avg. bwd time: 37.2488 / Avg. batch time: 446.5659 (ms) / GPU bubble ratio: 13.34%
[rank1]:2025-11-03 20:09:35,103 - INFO - Avg. fwd time: 9.6942 / Avg. bwd time: 18.2373 / Avg. batch time: 545.8773 (ms) / GPU bubble ratio: 59.07%
[rank0]:2025-11-03 20:09:35,134 - INFO - Avg. fwd time: 8.5253 / Avg. bwd time: 14.4585 / Avg. batch time: 573.3247 (ms) / GPU bubble ratio: 67.93%
[rank2]:2025-11-03 20:09:35,371 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251103_2009_rank2_trend_line.svg
[rank3]:2025-11-03 20:09:35,390 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251103_2009_rank3_trend_line.svg
[rank1]:2025-11-03 20:09:35,400 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251103_2009_rank1_trend_line.svg
[rank1]:2025-11-03 20:09:35,442 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-03 20:09:35,442 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-03 20:09:35,444 - INFO -  step: 1200  loss: -2.0000  grad_norm:  0.0000  memory: 12.12GiB(25.51%)  tps: 5,125  tflops: 39.03  mfu: 12.51%
[rank2]:2025-11-03 20:09:35,444 - INFO - ðŸ”Ž  Running validation at step 1200
[rank0]:2025-11-03 20:09:35,435 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251103_2009_rank0_trend_line.svg
[rank0]:2025-11-03 20:09:35,442 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank3]:2025-11-03 20:09:35,634 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule/251103_2009_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 422.93 ms, GPU Bubble Ratio: 63.44%, 51.80%, 71.68%, 11.18%
[rank3]:2025-11-03 20:09:35,635 - INFO - 	> Batch Time: 422.93 ms (Average Freeze Ratio: 0.29)
[rank3]:2025-11-03 20:09:35,635 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 0.40/0.40, [MB7] 0.00/0.00
[rank1]:2025-11-03 20:09:38,003 - INFO -  step: 1200  loss: -2.0000  grad_norm:  0.6827  memory: 15.11GiB(31.80%)  tps: 5,132  tflops: 39.08  mfu: 12.53%
[rank1]:2025-11-03 20:09:38,003 - INFO - ðŸ”Ž  Running validation at step 1200
[rank3]:2025-11-03 20:09:39,508 - INFO -  step: 1200  loss:  0.1968  grad_norm:  0.6827  memory: 31.90GiB(67.15%)  tps: 5,115  tflops: 38.95  mfu: 12.49%
[rank3]:2025-11-03 20:09:39,509 - INFO - ðŸ”Ž  Running validation at step 1200
[rank0]:2025-11-03 20:09:39,847 - INFO -  step: 1200  loss: -2.0000  grad_norm:  0.6827  memory: 17.10GiB(35.99%)  tps: 5,123  tflops: 39.01  mfu: 12.50%
[rank0]:2025-11-03 20:09:39,847 - INFO - ðŸ”Ž  Running validation at step 1200
[rank0]:2025-11-03 20:09:58,826 - INFO - validate step: 1200  loss: -1.0000  memory: 17.10GiB(35.99%)  tps: 21,582
[rank0]:2025-11-03 20:09:58,827 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-11-03 20:09:58,842 - INFO - validate step: 1200  loss: -1.0000  memory: 15.11GiB(31.80%)  tps: 19,656
[rank1]:2025-11-03 20:09:58,843 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-03 20:09:58,857 - INFO - validate step: 1200  loss: -1.0000  memory: 12.12GiB(25.51%)  tps: 17,495
[rank2]:2025-11-03 20:09:58,858 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-03 20:09:58,836 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank3]:2025-11-03 20:09:58,851 - INFO - validate step: 1200  loss:  0.9385  memory: 31.90GiB(67.15%)  tps: 21,177
[rank3]:2025-11-03 20:09:58,852 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-03 20:10:00,692 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 1.83 seconds.
[rank1]:2025-11-03 20:10:00,886 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 2.04 seconds.
[rank3]:2025-11-03 20:10:01,960 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.11 seconds.
[rank0]:2025-11-03 20:10:02,405 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-11-03 20:10:02,415 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.59 seconds.
[rank2]:2025-11-03 20:10:02,498 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251103_2010_stage2_step1200.svg
[rank1]:2025-11-03 20:10:02,501 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251103_2010_stage1_step1200.svg
[rank0]:2025-11-03 20:10:02,581 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251103_2010_stage0_step1200.svg
[rank3]:2025-11-03 20:10:02,760 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule/251103_2010_real_step1200_rank3.svg
[rank3]:> Batch Time: 482.63 ms, GPU Bubble Ratio: 47.13%, 46.11%, 72.78%, 17.49%
[rank3]:2025-11-03 20:10:02,829 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251103_2010_stage3_step1200.svg
[rank0]:2025-11-03 20:11:10,451 - INFO - [GC] Peforming periodical GC collection 0.17 seconds
[rank1]:2025-11-03 20:11:11,525 - INFO -  step: 1250  loss: -2.0000  grad_norm:  0.0000  memory: 15.73GiB(33.12%)  tps: 5,636  tflops: 42.92  mfu: 13.76%
[rank0]:2025-11-03 20:11:11,525 - INFO -  step: 1250  loss: -2.0000  grad_norm:  0.0000  memory: 17.10GiB(35.99%)  tps: 5,634  tflops: 42.91  mfu: 13.75%
[rank2]:2025-11-03 20:11:11,524 - INFO -  step: 1250  loss: -2.0000  grad_norm:  0.0000  memory: 12.12GiB(25.51%)  tps: 5,637  tflops: 42.93  mfu: 13.76%
[rank3]:2025-11-03 20:11:15,310 - INFO -  step: 1250  loss:  0.3152  grad_norm:  0.0995  memory: 31.90GiB(67.15%)  tps: 5,357  tflops: 40.80  mfu: 13.08%
[rank0]:2025-11-03 20:12:22,148 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-03 20:12:22,730 - INFO - Avg. fwd time: 8.5752 / Avg. bwd time: 13.4586 / Avg. batch time: 581.2413 (ms) / GPU bubble ratio: 69.67%
[rank2]:2025-11-03 20:12:22,955 - INFO - Avg. fwd time: 8.0426 / Avg. bwd time: 10.4754 / Avg. batch time: 522.6190 (ms) / GPU bubble ratio: 71.65%
[rank3]:2025-11-03 20:12:22,975 - INFO - Avg. fwd time: 11.0923 / Avg. bwd time: 37.3999 / Avg. batch time: 447.5233 (ms) / GPU bubble ratio: 13.31%
[rank1]:2025-11-03 20:12:23,034 - INFO - Avg. fwd time: 9.7714 / Avg. bwd time: 17.6955 / Avg. batch time: 554.8156 (ms) / GPU bubble ratio: 60.39%
[rank2]:2025-11-03 20:12:23,208 - INFO -  step: 1300  loss: -2.0000  grad_norm:  0.0000  memory: 12.12GiB(25.51%)  tps: 5,714  tflops: 43.52  mfu: 13.95%
[rank1]:2025-11-03 20:12:23,209 - INFO -  step: 1300  loss: -2.0000  grad_norm:  0.0000  memory: 15.73GiB(33.12%)  tps: 5,714  tflops: 43.52  mfu: 13.95%
[rank0]:2025-11-03 20:12:23,209 - INFO -  step: 1300  loss: -2.0000  grad_norm:  0.0000  memory: 17.10GiB(35.99%)  tps: 5,714  tflops: 43.52  mfu: 13.95%
[rank3]:2025-11-03 20:12:27,047 - INFO -  step: 1300  loss:  0.2762  grad_norm:  0.0769  memory: 31.90GiB(67.15%)  tps: 5,710  tflops: 43.49  mfu: 13.94%
[rank2]:2025-11-03 20:12:27,120 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251103_2012_stage2_step1300.svg
[rank1]:2025-11-03 20:12:27,122 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251103_2012_stage1_step1300.svg
[rank0]:2025-11-03 20:12:27,120 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251103_2012_stage0_step1300.svg
[rank3]:2025-11-03 20:12:27,223 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule/251103_2012_real_step1300_rank3.svg
[rank3]:> Batch Time: 450.23 ms, GPU Bubble Ratio: 83.71%, 62.34%, 70.81%, 10.54%
[rank3]:2025-11-03 20:12:27,290 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251103_2012_stage3_step1300.svg
[rank0]:2025-11-03 20:13:34,190 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-03 20:13:35,270 - INFO -  step: 1350  loss: -2.0000  grad_norm:  0.0000  memory: 17.10GiB(35.99%)  tps: 5,684  tflops: 43.29  mfu: 13.88%
[rank2]:2025-11-03 20:13:35,269 - INFO -  step: 1350  loss: -2.0000  grad_norm:  0.0000  memory: 12.12GiB(25.51%)  tps: 5,684  tflops: 43.29  mfu: 13.88%
[rank1]:2025-11-03 20:13:35,269 - INFO -  step: 1350  loss: -2.0000  grad_norm:  0.0000  memory: 15.73GiB(33.12%)  tps: 5,684  tflops: 43.29  mfu: 13.88%
[rank3]:2025-11-03 20:13:39,052 - INFO -  step: 1350  loss:  0.2746  grad_norm:  0.0824  memory: 31.90GiB(67.15%)  tps: 5,689  tflops: 43.33  mfu: 13.89%
[rank0]:2025-11-03 20:14:45,828 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-03 20:14:46,416 - INFO - Avg. fwd time: 8.6193 / Avg. bwd time: 12.4458 / Avg. batch time: 589.9217 (ms) / GPU bubble ratio: 71.43%
[rank2]:2025-11-03 20:14:46,642 - INFO - Avg. fwd time: 8.0697 / Avg. bwd time: 10.2913 / Avg. batch time: 532.9471 (ms) / GPU bubble ratio: 72.44%
[rank3]:2025-11-03 20:14:46,667 - INFO - Avg. fwd time: 11.0602 / Avg. bwd time: 37.5648 / Avg. batch time: 448.5887 (ms) / GPU bubble ratio: 13.28%
[rank1]:2025-11-03 20:14:46,727 - INFO - Avg. fwd time: 9.8493 / Avg. bwd time: 17.1459 / Avg. batch time: 564.5616 (ms) / GPU bubble ratio: 61.75%
[rank2]:2025-11-03 20:14:46,900 - INFO -  step: 1400  loss: -2.0000  grad_norm:  0.0000  memory: 12.12GiB(25.51%)  tps: 5,718  tflops: 43.55  mfu: 13.96%
[rank2]:2025-11-03 20:14:46,900 - INFO - ðŸ”Ž  Running validation at step 1400
[rank1]:2025-11-03 20:14:46,901 - INFO -  step: 1400  loss: -2.0000  grad_norm:  0.0000  memory: 15.73GiB(33.12%)  tps: 5,718  tflops: 43.55  mfu: 13.96%
[rank1]:2025-11-03 20:14:46,901 - INFO - ðŸ”Ž  Running validation at step 1400
[rank0]:2025-11-03 20:14:46,901 - INFO -  step: 1400  loss: -2.0000  grad_norm:  0.0000  memory: 17.10GiB(35.99%)  tps: 5,718  tflops: 43.55  mfu: 13.96%
[rank0]:2025-11-03 20:14:46,901 - INFO - ðŸ”Ž  Running validation at step 1400
[rank3]:2025-11-03 20:14:50,651 - INFO -  step: 1400  loss:  0.2425  grad_norm:  0.1113  memory: 31.90GiB(67.15%)  tps: 5,721  tflops: 43.57  mfu: 13.97%
[rank3]:2025-11-03 20:14:50,651 - INFO - ðŸ”Ž  Running validation at step 1400
[rank0]:2025-11-03 20:15:09,683 - INFO - validate step: 1400  loss: -1.0000  memory: 17.10GiB(35.99%)  tps: 17,980
[rank2]:2025-11-03 20:15:09,718 - INFO - validate step: 1400  loss: -1.0000  memory: 12.12GiB(25.51%)  tps: 17,951
[rank3]:2025-11-03 20:15:09,714 - INFO - validate step: 1400  loss:  0.9383  memory: 31.90GiB(67.15%)  tps: 21,488
[rank1]:2025-11-03 20:15:09,702 - INFO - validate step: 1400  loss: -1.0000  memory: 15.73GiB(33.12%)  tps: 17,964
[rank2]:2025-11-03 20:15:09,807 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251103_2015_stage2_step1400.svg
[rank0]:2025-11-03 20:15:09,794 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251103_2015_stage0_step1400.svg
[rank1]:2025-11-03 20:15:09,814 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251103_2015_stage1_step1400.svg
[rank3]:2025-11-03 20:15:09,895 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule/251103_2015_real_step1400_rank3.svg
[rank3]:> Batch Time: 448.68 ms, GPU Bubble Ratio: 83.67%, 62.22%, 70.72%, 10.61%
[rank3]:2025-11-03 20:15:09,965 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251103_2015_stage3_step1400.svg
[rank0]:2025-11-03 20:16:17,062 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-11-03 20:16:18,123 - INFO -  step: 1450  loss: -2.0000  grad_norm:  0.0000  memory: 17.10GiB(35.99%)  tps: 5,985  tflops: 45.58  mfu: 14.61%
[rank2]:2025-11-03 20:16:18,122 - INFO -  step: 1450  loss: -2.0000  grad_norm:  0.0000  memory: 12.12GiB(25.51%)  tps: 5,988  tflops: 45.61  mfu: 14.62%
[rank1]:2025-11-03 20:16:18,123 - INFO -  step: 1450  loss: -2.0000  grad_norm:  0.0000  memory: 15.73GiB(33.12%)  tps: 5,987  tflops: 45.59  mfu: 14.61%
[rank3]:2025-11-03 20:16:21,876 - INFO -  step: 1450  loss:  0.2496  grad_norm:  0.1237  memory: 31.90GiB(67.15%)  tps: 5,676  tflops: 43.23  mfu: 13.86%
[rank0]:2025-11-03 20:17:28,609 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-03 20:17:29,662 - INFO - Avg. fwd time: 8.0931 / Avg. bwd time: 10.1335 / Avg. batch time: 540.5920 (ms) / GPU bubble ratio: 73.03%
[rank3]:2025-11-03 20:17:29,646 - INFO - Avg. fwd time: 11.0343 / Avg. bwd time: 37.7026 / Avg. batch time: 449.4857 (ms) / GPU bubble ratio: 13.26%
[rank1]:2025-11-03 20:17:29,680 - INFO - Avg. fwd time: 9.9167 / Avg. bwd time: 16.6738 / Avg. batch time: 571.7081 (ms) / GPU bubble ratio: 62.79%
[rank1]:2025-11-03 20:17:29,689 - INFO -  step: 1500  loss: -2.0000  grad_norm:  0.0000  memory: 15.73GiB(33.12%)  tps: 5,723  tflops: 43.59  mfu: 13.97%
[rank0]:2025-11-03 20:17:29,688 - INFO - Avg. fwd time: 8.6576 / Avg. bwd time: 11.5747 / Avg. batch time: 596.1565 (ms) / GPU bubble ratio: 72.85%
[rank0]:2025-11-03 20:17:29,690 - INFO -  step: 1500  loss: -2.0000  grad_norm:  0.0000  memory: 17.10GiB(35.99%)  tps: 5,723  tflops: 43.59  mfu: 13.97%
[rank2]:2025-11-03 20:17:29,689 - INFO -  step: 1500  loss: -2.0000  grad_norm:  0.0000  memory: 12.12GiB(25.51%)  tps: 5,723  tflops: 43.59  mfu: 13.97%
[rank3]:2025-11-03 20:17:33,439 - INFO -  step: 1500  loss:  0.2832  grad_norm:  0.0679  memory: 31.90GiB(67.15%)  tps: 5,724  tflops: 43.59  mfu: 13.97%
[rank0]:2025-11-03 20:17:33,515 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251103_2017_stage0_step1500.svg
[rank2]:2025-11-03 20:17:33,515 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251103_2017_stage2_step1500.svg
[rank1]:2025-11-03 20:17:33,519 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251103_2017_stage1_step1500.svg
[rank3]:2025-11-03 20:17:33,617 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule/251103_2017_real_step1500_rank3.svg
[rank3]:> Batch Time: 448.88 ms, GPU Bubble Ratio: 83.67%, 62.20%, 70.72%, 10.56%
[rank3]:2025-11-03 20:17:33,686 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251103_2017_stage3_step1500.svg
[rank0]:2025-11-03 20:18:40,276 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-03 20:18:41,345 - INFO -  step: 1550  loss: -2.0000  grad_norm:  0.0000  memory: 17.10GiB(35.99%)  tps: 5,716  tflops: 43.54  mfu: 13.95%
[rank2]:2025-11-03 20:18:41,344 - INFO -  step: 1550  loss: -2.0000  grad_norm:  0.0000  memory: 12.12GiB(25.51%)  tps: 5,716  tflops: 43.54  mfu: 13.95%
[rank1]:2025-11-03 20:18:41,345 - INFO -  step: 1550  loss: -2.0000  grad_norm:  0.0000  memory: 15.73GiB(33.12%)  tps: 5,716  tflops: 43.54  mfu: 13.95%
[rank3]:2025-11-03 20:18:45,123 - INFO -  step: 1550  loss:  0.2413  grad_norm:  0.0689  memory: 31.90GiB(67.15%)  tps: 5,714  tflops: 43.52  mfu: 13.95%
[rank0]:2025-11-03 20:19:52,000 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-03 20:19:52,577 - INFO - Avg. fwd time: 8.6863 / Avg. bwd time: 10.9197 / Avg. batch time: 601.1080 (ms) / GPU bubble ratio: 73.91%
[rank2]:2025-11-03 20:19:52,809 - INFO - Avg. fwd time: 8.1105 / Avg. bwd time: 10.0147 / Avg. batch time: 546.6098 (ms) / GPU bubble ratio: 73.47%
[rank3]:2025-11-03 20:19:52,834 - INFO - Avg. fwd time: 11.0138 / Avg. bwd time: 37.8018 / Avg. batch time: 450.1171 (ms) / GPU bubble ratio: 13.24%
[rank1]:2025-11-03 20:19:52,895 - INFO - Avg. fwd time: 9.9669 / Avg. bwd time: 16.3184 / Avg. batch time: 577.3493 (ms) / GPU bubble ratio: 63.58%
[rank3]:2025-11-03 20:19:53,383 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251103_2019_rank3_trend_line.svg
[rank0]:2025-11-03 20:19:53,453 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251103_2019_rank0_trend_line.svg
[rank0]:2025-11-03 20:19:53,460 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-11-03 20:19:53,463 - INFO -  step: 1600  loss: -2.0000  grad_norm:  0.0000  memory: 17.10GiB(35.99%)  tps: 5,680  tflops: 43.26  mfu: 13.86%
[rank0]:2025-11-03 20:19:53,463 - INFO - ðŸ”Ž  Running validation at step 1600
[rank2]:2025-11-03 20:19:53,438 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251103_2019_rank2_trend_line.svg
[rank2]:2025-11-03 20:19:53,460 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-03 20:19:53,463 - INFO -  step: 1600  loss: -2.0000  grad_norm:  0.0000  memory: 12.12GiB(25.51%)  tps: 5,680  tflops: 43.26  mfu: 13.86%
[rank2]:2025-11-03 20:19:53,463 - INFO - ðŸ”Ž  Running validation at step 1600
[rank1]:2025-11-03 20:19:53,446 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251103_2019_rank1_trend_line.svg
[rank1]:2025-11-03 20:19:53,460 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-11-03 20:19:53,463 - INFO -  step: 1600  loss: -2.0000  grad_norm:  0.0000  memory: 15.73GiB(33.12%)  tps: 5,680  tflops: 43.26  mfu: 13.86%
[rank1]:2025-11-03 20:19:53,463 - INFO - ðŸ”Ž  Running validation at step 1600
[rank3]:2025-11-03 20:19:53,646 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule/251103_2019_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 433.58 ms, GPU Bubble Ratio: 71.47%, 56.83%, 72.49%, 11.07%
[rank3]:2025-11-03 20:19:53,646 - INFO - 	> Batch Time: 433.58 ms (Average Freeze Ratio: 0.29)
[rank3]:2025-11-03 20:19:53,647 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 0.40/0.40, [MB6] 1.00/1.00, [MB7] 0.00/0.00
[rank3]:2025-11-03 20:19:57,376 - INFO -  step: 1600  loss:  0.2056  grad_norm:  0.1003  memory: 31.90GiB(67.15%)  tps: 5,669  tflops: 43.18  mfu: 13.84%
[rank3]:2025-11-03 20:19:57,377 - INFO - ðŸ”Ž  Running validation at step 1600
[rank0]:2025-11-03 20:20:16,334 - INFO - validate step: 1600  loss: -1.0000  memory: 17.10GiB(35.99%)  tps: 17,909
[rank2]:2025-11-03 20:20:16,368 - INFO - validate step: 1600  loss: -1.0000  memory: 12.12GiB(25.51%)  tps: 17,883
[rank3]:2025-11-03 20:20:16,362 - INFO - validate step: 1600  loss:  0.9394  memory: 31.90GiB(67.15%)  tps: 21,575
[rank1]:2025-11-03 20:20:16,353 - INFO - validate step: 1600  loss: -1.0000  memory: 15.73GiB(33.12%)  tps: 17,895
[rank0]:2025-11-03 20:20:16,446 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251103_2020_stage0_step1600.svg
[rank2]:2025-11-03 20:20:16,446 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251103_2020_stage2_step1600.svg
[rank1]:2025-11-03 20:20:16,449 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251103_2020_stage1_step1600.svg
[rank3]:2025-11-03 20:20:16,542 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule/251103_2020_real_step1600_rank3.svg
[rank3]:> Batch Time: 449.88 ms, GPU Bubble Ratio: 83.68%, 62.32%, 70.79%, 10.54%
[rank3]:2025-11-03 20:20:16,613 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251103_2020_stage3_step1600.svg
[rank3]:2025-11-03 20:20:46,867 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-11-03 20:20:47,074 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-11-03 20:20:47,086 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-11-03 20:20:47,087 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-11-03 20:21:23,572 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-11-03 20:21:24,645 - INFO -  step: 1650  loss: -2.0000  grad_norm:  0.0000  memory: 12.12GiB(25.51%)  tps: 5,999  tflops: 45.69  mfu: 14.64%
[rank0]:2025-11-03 20:21:24,646 - INFO -  step: 1650  loss: -2.0000  grad_norm:  0.0000  memory: 17.10GiB(35.99%)  tps: 5,996  tflops: 45.67  mfu: 14.64%
[rank1]:2025-11-03 20:21:24,645 - INFO -  step: 1650  loss: -2.0000  grad_norm:  0.0000  memory: 15.73GiB(33.12%)  tps: 5,998  tflops: 45.68  mfu: 14.64%
[rank3]:2025-11-03 20:21:28,419 - INFO -  step: 1650  loss:  0.2791  grad_norm:  0.1009  memory: 31.90GiB(67.15%)  tps: 5,685  tflops: 43.29  mfu: 13.88%

ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 11. 03. (ì›”) 23:16:06 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 3,4,5,6
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1029_llama1b/run_1031.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1029_llama1b/1031_GPipe_timelyapf.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
+ more freezing in autofreeze mode. 
+ lr_scheduler min_lr = 0 -> 1e-6, cosine decay.

âœ”ï¸Running with timelyapf x GPipe ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1029_llama1b/config_1031.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
+ more freezing in autofreeze mode. 
+ lr_scheduler min_lr = 0 -> 1e-6, cosine decay.
" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=timelyapf
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank0]:2025-11-03 23:16:13,067 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
[rank0]:+ more freezing in autofreeze mode. 
[rank0]:+ lr_scheduler min_lr = 0 -> 1e-6, cosine decay.
[rank0]:"
[rank1]:2025-11-03 23:16:13,164 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
[rank1]:+ more freezing in autofreeze mode. 
[rank1]:+ lr_scheduler min_lr = 0 -> 1e-6, cosine decay.
[rank1]:"
[rank0]:2025-11-03 23:16:13,229 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-11-03 23:16:13,231 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-03 23:16:13,234 - INFO - [GC] Initial GC collection 0.00 seconds
[rank1]:2025-11-03 23:16:13,328 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-11-03 23:16:13,330 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-11-03 23:16:13,858 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
[rank3]:+ more freezing in autofreeze mode. 
[rank3]:+ lr_scheduler min_lr = 0 -> 1e-6, cosine decay.
[rank3]:"
[rank2]:2025-11-03 23:16:13,855 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
[rank2]:+ more freezing in autofreeze mode. 
[rank2]:+ lr_scheduler min_lr = 0 -> 1e-6, cosine decay.
[rank2]:"
[rank3]:2025-11-03 23:16:14,089 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-11-03 23:16:14,092 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-11-03 23:16:14,060 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-11-03 23:16:14,063 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-03 23:16:14,413 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-11-03 23:16:14,797 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank0]:2025-11-03 23:16:17,659 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=512, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank0]:2025-11-03 23:16:17,806 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-11-03 23:16:17,839 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-03 23:16:17,840 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank1]:2025-11-03 23:16:17,828 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-11-03 23:16:17,869 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-03 23:16:17,864 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-11-03 23:16:17,864 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2025-11-03 23:16:17,895 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-11-03 23:16:17,895 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2025-11-03 23:16:18,102 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-11-03 23:16:18,102 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-11-03 23:16:18,103 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank0]:2025-11-03 23:16:18,042 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-03 23:16:18,042 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-11-03 23:16:18,043 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank2]:2025-11-03 23:16:18,282 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-11-03 23:16:18,307 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-11-03 23:16:18,320 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-11-03 23:16:18,320 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank2]:2025-11-03 23:16:18,522 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-11-03 23:16:18,523 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-11-03 23:16:18,523 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run lvs6kv1r
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1031_GPipe_timelyapf_dm1/20251103-2316/wandb/run-20251103_231619-lvs6kv1r
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1031_GPipe_timelyapf_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/lvs6kv1r
[rank3]:2025-11-03 23:16:20,699 - INFO - WandB logging enabled
[rank3]:2025-11-03 23:16:20,700 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-11-03 23:16:20,738 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-11-03 23:16:20,766 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-11-03 23:16:20,767 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank2]:2025-11-03 23:16:20,963 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-11-03 23:16:20,946 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-11-03 23:16:20,947 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-11-03 23:16:20,962 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-03 23:16:20,962 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1031_GPipe_timelyapf_dm1
[rank3]:2025-11-03 23:16:20,947 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2025-11-03 23:16:20,962 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-03 23:16:20,962 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-03 23:16:20,962 - INFO - Preparing c4_validation dataset from allenai/c4
[rank1]:2025-11-03 23:16:25,582 - WARNING - checkpoint.initial_load_path is provided but the checkpoint.folder exists. Checkpointer will use the checkpoints from the checkpoint.folder /data2/shcho/torchtitan/checkpoint/1031_GPipe_timelyapf_dm1.
[rank2]:2025-11-03 23:16:25,914 - WARNING - checkpoint.initial_load_path is provided but the checkpoint.folder exists. Checkpointer will use the checkpoints from the checkpoint.folder /data2/shcho/torchtitan/checkpoint/1031_GPipe_timelyapf_dm1.
[rank3]:2025-11-03 23:16:26,466 - WARNING - checkpoint.initial_load_path is provided but the checkpoint.folder exists. Checkpointer will use the checkpoints from the checkpoint.folder /data2/shcho/torchtitan/checkpoint/1031_GPipe_timelyapf_dm1.
[rank0]:2025-11-03 23:16:26,918 - INFO - Trainer is initialized with local batch size 32, global batch size 64, gradient accumulation steps 2, sequence length 512, total steps 2400 (warmup 300)
[rank0]:2025-11-03 23:16:26,918 - WARNING - checkpoint.initial_load_path is provided but the checkpoint.folder exists. Checkpointer will use the checkpoints from the checkpoint.folder /data2/shcho/torchtitan/checkpoint/1031_GPipe_timelyapf_dm1.
[rank0]:2025-11-03 23:16:26,918 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/checkpoint/1031_GPipe_timelyapf_dm1/step-1200.
[rank0]:2025-11-03 23:16:28,944 - INFO - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-11-03 23:16:28,944 - INFO - Finished loading the checkpoint in 2.03 seconds.
[rank0]:2025-11-03 23:16:28,944 - INFO - Training starts at step 1
[rank2]:2025-11-03 23:16:30,793 - INFO -  step:  1  loss: -2.0000  grad_norm:  0.4663  memory:  9.35GiB(19.67%)  tps: 656  tflops: 5.00  mfu: 1.60%
[rank2]:2025-11-03 23:16:30,793 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-03 23:16:30,836 - INFO -  step:  1  loss: -2.0000  grad_norm:  0.4663  memory: 12.28GiB(25.84%)  tps: 630  tflops: 4.80  mfu: 1.54%
[rank0]:2025-11-03 23:16:30,836 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-11-03 23:16:30,809 - INFO -  step:  1  loss: -2.0000  grad_norm:  0.4663  memory: 11.50GiB(24.20%)  tps: 633  tflops: 4.82  mfu: 1.55%
[rank1]:2025-11-03 23:16:30,809 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-11-03 23:16:30,803 - INFO -  step:  1  loss:  0.2830  grad_norm:  0.4663  memory: 23.19GiB(48.82%)  tps: 814  tflops: 6.20  mfu: 1.99%
[rank3]:2025-11-03 23:16:30,804 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-03 23:17:29,471 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-03 23:17:30,718 - INFO -  step: 50  loss: -2.0000  grad_norm:  0.6448  memory: 11.81GiB(24.85%)  tps: 6,699  tflops: 51.02  mfu: 16.35%
[rank1]:2025-11-03 23:17:30,721 - INFO -  step: 50  loss: -2.0000  grad_norm:  0.6448  memory: 14.64GiB(30.82%)  tps: 6,700  tflops: 51.03  mfu: 16.36%
[rank3]:2025-11-03 23:17:30,730 - INFO -  step: 50  loss:  0.2356  grad_norm:  0.6448  memory: 27.51GiB(57.90%)  tps: 6,699  tflops: 51.02  mfu: 16.35%
[rank0]:2025-11-03 23:17:30,734 - INFO -  step: 50  loss: -2.0000  grad_norm:  0.6448  memory: 16.57GiB(34.88%)  tps: 6,702  tflops: 51.04  mfu: 16.36%
[rank0]:2025-11-03 23:18:31,176 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-03 23:18:32,127 - INFO - Avg. fwd time: 10.5549 / Avg. bwd time: 41.9990 / Avg. batch time: 480.3784 (ms) / GPU bubble ratio: 12.48%
[rank2]:2025-11-03 23:18:32,196 - INFO - Avg. fwd time: 6.8202 / Avg. bwd time: 18.1727 / Avg. batch time: 511.3066 (ms) / GPU bubble ratio: 60.90%
[rank0]:2025-11-03 23:18:32,241 - INFO - Avg. fwd time: 7.9943 / Avg. bwd time: 23.7748 / Avg. batch time: 588.3152 (ms) / GPU bubble ratio: 56.80%
[rank1]:2025-11-03 23:18:32,234 - INFO - Avg. fwd time: 8.8361 / Avg. bwd time: 23.4691 / Avg. batch time: 550.3638 (ms) / GPU bubble ratio: 53.04%
[rank2]:2025-11-03 23:18:32,409 - INFO -  step: 100  loss: -2.0000  grad_norm:  0.5182  memory: 11.81GiB(24.85%)  tps: 6,640  tflops: 50.57  mfu: 16.21%
[rank2]:2025-11-03 23:18:32,409 - WARNING - Nothing to draw before the end of warmup.
[rank1]:2025-11-03 23:18:32,413 - INFO -  step: 100  loss: -2.0000  grad_norm:  0.5182  memory: 14.64GiB(30.82%)  tps: 6,640  tflops: 50.57  mfu: 16.21%
[rank1]:2025-11-03 23:18:32,413 - WARNING - Nothing to draw before the end of warmup.
[rank3]:2025-11-03 23:18:32,421 - INFO -  step: 100  loss:  0.2123  grad_norm:  0.5182  memory: 27.51GiB(57.90%)  tps: 6,640  tflops: 50.57  mfu: 16.21%
[rank3]:2025-11-03 23:18:32,421 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-11-03 23:18:32,423 - INFO -  step: 100  loss: -2.0000  grad_norm:  0.5182  memory: 16.57GiB(34.88%)  tps: 6,640  tflops: 50.57  mfu: 16.21%
[rank0]:2025-11-03 23:18:32,423 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-11-03 23:19:33,320 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-03 23:19:34,603 - INFO -  step: 150  loss: -2.0000  grad_norm:  0.5520  memory: 11.81GiB(24.85%)  tps: 6,586  tflops: 50.16  mfu: 16.08%
[rank3]:2025-11-03 23:19:34,615 - INFO -  step: 150  loss:  0.2777  grad_norm:  0.5520  memory: 27.51GiB(57.90%)  tps: 6,586  tflops: 50.16  mfu: 16.08%
[rank1]:2025-11-03 23:19:34,606 - INFO -  step: 150  loss: -2.0000  grad_norm:  0.5520  memory: 14.64GiB(30.82%)  tps: 6,586  tflops: 50.16  mfu: 16.08%
[rank0]:2025-11-03 23:19:34,618 - INFO -  step: 150  loss: -2.0000  grad_norm:  0.5520  memory: 16.57GiB(34.88%)  tps: 6,586  tflops: 50.16  mfu: 16.08%
[rank0]:2025-11-03 23:20:35,784 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-03 23:20:36,770 - INFO - Avg. fwd time: 10.6287 / Avg. bwd time: 42.5670 / Avg. batch time: 485.4487 (ms) / GPU bubble ratio: 12.34%
[rank2]:2025-11-03 23:20:36,842 - INFO - Avg. fwd time: 6.8337 / Avg. bwd time: 18.2404 / Avg. batch time: 516.0754 (ms) / GPU bubble ratio: 61.13%
[rank1]:2025-11-03 23:20:36,881 - INFO - Avg. fwd time: 8.8658 / Avg. bwd time: 23.5807 / Avg. batch time: 554.7798 (ms) / GPU bubble ratio: 53.21%
[rank0]:2025-11-03 23:20:36,888 - INFO - Avg. fwd time: 8.0143 / Avg. bwd time: 23.8428 / Avg. batch time: 592.2445 (ms) / GPU bubble ratio: 56.97%
[rank2]:2025-11-03 23:20:37,060 - INFO -  step: 200  loss: -2.0000  grad_norm:  0.8262  memory: 11.81GiB(24.85%)  tps: 6,558  tflops: 49.95  mfu: 16.01%
[rank2]:2025-11-03 23:20:37,060 - INFO - ðŸ”Ž  Running validation at step 200
[rank1]:2025-11-03 23:20:37,064 - INFO -  step: 200  loss: -2.0000  grad_norm:  0.8262  memory: 14.64GiB(30.82%)  tps: 6,558  tflops: 49.95  mfu: 16.01%
[rank1]:2025-11-03 23:20:37,064 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-11-03 23:20:37,076 - INFO -  step: 200  loss: -2.0000  grad_norm:  0.8262  memory: 16.57GiB(34.88%)  tps: 6,558  tflops: 49.95  mfu: 16.01%
[rank0]:2025-11-03 23:20:37,076 - INFO - ðŸ”Ž  Running validation at step 200
[rank3]:2025-11-03 23:20:37,073 - INFO -  step: 200  loss:  0.2286  grad_norm:  0.8262  memory: 27.51GiB(57.90%)  tps: 6,558  tflops: 49.95  mfu: 16.01%
[rank3]:2025-11-03 23:20:37,074 - INFO - ðŸ”Ž  Running validation at step 200
[rank3]:2025-11-03 23:20:59,084 - INFO - validate step: 200  loss:  0.9576  memory: 27.51GiB(57.90%)  tps: 18,611
[rank3]:2025-11-03 23:20:59,085 - WARNING - Nothing to draw before the end of warmup.
[rank1]:2025-11-03 23:20:59,073 - INFO - validate step: 200  loss: -1.0000  memory: 14.64GiB(30.82%)  tps: 18,611
[rank1]:2025-11-03 23:20:59,074 - WARNING - Nothing to draw before the end of warmup.
[rank2]:2025-11-03 23:20:59,096 - INFO - validate step: 200  loss: -1.0000  memory: 11.81GiB(24.85%)  tps: 18,588
[rank2]:2025-11-03 23:20:59,098 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-11-03 23:20:59,057 - INFO - validate step: 200  loss: -1.0000  memory: 16.57GiB(34.88%)  tps: 18,634
[rank0]:2025-11-03 23:20:59,058 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-11-03 23:22:00,256 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-11-03 23:22:01,506 - INFO -  step: 250  loss: -2.0000  grad_norm:  0.7029  memory: 14.64GiB(30.82%)  tps: 6,561  tflops: 49.97  mfu: 16.02%
[rank3]:2025-11-03 23:22:01,514 - INFO -  step: 250  loss:  0.2193  grad_norm:  0.7029  memory: 27.51GiB(57.90%)  tps: 6,561  tflops: 49.97  mfu: 16.02%
[rank2]:2025-11-03 23:22:01,502 - INFO -  step: 250  loss: -2.0000  grad_norm:  0.7029  memory: 11.81GiB(24.85%)  tps: 6,564  tflops: 49.99  mfu: 16.02%
[rank0]:2025-11-03 23:22:01,517 - INFO -  step: 250  loss: -2.0000  grad_norm:  0.7029  memory: 16.57GiB(34.88%)  tps: 6,558  tflops: 49.95  mfu: 16.01%
[rank3]:2025-11-03 23:22:13,675 - INFO - [Step 260] ã€°ï¸ Monitoring Upperbound
[rank3]:2025-11-03 23:22:27,514 - WARNING - [Step 270] â³ Monitoring Upperbound... (540/550)
[rank1]:2025-11-03 23:22:27,571 - WARNING - [Step 270] â³ Monitoring Upperbound... (540/550)
[rank0]:2025-11-03 23:22:27,600 - WARNING - [Step 270] â³ Monitoring Upperbound... (540/550)
[rank2]:2025-11-03 23:22:27,541 - WARNING - [Step 270] â³ Monitoring Upperbound... (540/550)
[rank3]:2025-11-03 23:22:44,708 - INFO - [Step 280] âœ”ï¸  Setting Upperbound
[rank3]:2025-11-03 23:22:45,016 - INFO - [Step 280] ã€°ï¸ Monitoring Lowerbound
[rank2]:2025-11-03 23:22:48,397 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-03 23:22:49,566 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-03 23:22:49,583 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-03 23:22:50,992 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-03 23:22:51,011 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-03 23:22:51,025 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-03 23:22:51,035 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-03 23:22:51,046 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-03 23:22:50,961 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-03 23:22:50,986 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-03 23:22:51,025 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-03 23:22:50,996 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-03 23:22:51,033 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-03 23:22:50,979 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-03 23:22:51,017 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-03 23:22:51,054 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-03 23:22:51,062 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-03 23:22:51,069 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-03 23:22:51,106 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-03 23:22:51,152 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-03 23:22:51,090 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-03 23:22:51,215 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-03 23:22:51,249 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-03 23:22:51,191 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-03 23:22:51,227 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-03 23:22:51,185 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-03 23:22:51,176 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-03 23:22:51,211 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-03 23:22:51,247 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-03 23:22:51,288 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-03 23:22:51,265 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-03 23:22:51,306 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-03 23:23:06,572 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-03 23:23:07,353 - INFO - Avg. fwd time: 10.8350 / Avg. bwd time: 41.3037 / Avg. batch time: 476.9593 (ms) / GPU bubble ratio: 12.55%
[rank3]:2025-11-03 23:23:07,356 - INFO - [Step 300] âœ”ï¸  Setting Lowerbound
[rank2]:2025-11-03 23:23:07,368 - INFO - Avg. fwd time: 6.9430 / Avg. bwd time: 17.5971 / Avg. batch time: 506.8208 (ms) / GPU bubble ratio: 61.26%
[rank0]:2025-11-03 23:23:07,393 - INFO - Avg. fwd time: 8.1090 / Avg. bwd time: 22.3055 / Avg. batch time: 580.3320 (ms) / GPU bubble ratio: 58.07%
[rank0]:2025-11-03 23:23:07,412 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.28/0.28, [MB3] 0.00/0.00, [MB4] 0.27/0.27, [MB5] 0.57/0.57, [MB6] 0.57/0.57, [MB7] 1.00/1.00
[rank0]:2025-11-03 23:23:07,413 - INFO -  step: 300  loss: -2.0000  grad_norm:  0.0000  memory: 16.57GiB(34.88%)  tps: 6,216  tflops: 47.34  mfu: 15.17%
[rank1]:2025-11-03 23:23:07,386 - INFO - Avg. fwd time: 9.0066 / Avg. bwd time: 22.7631 / Avg. batch time: 544.5821 (ms) / GPU bubble ratio: 53.33%
[rank1]:2025-11-03 23:23:07,411 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.22/0.22, [MB2] 0.00/0.00, [MB3] 0.46/0.46, [MB4] 0.22/0.22, [MB5] 0.20/0.20, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-11-03 23:23:07,412 - INFO -  step: 300  loss: -2.0000  grad_norm:  0.0000  memory: 14.64GiB(30.82%)  tps: 6,215  tflops: 47.33  mfu: 15.17%
[rank2]:2025-11-03 23:23:07,409 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-03 23:23:07,410 - INFO -  step: 300  loss: -2.0000  grad_norm:  0.0000  memory: 11.81GiB(24.85%)  tps: 6,215  tflops: 47.33  mfu: 15.17%
[rank3]:2025-11-03 23:23:07,563 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule/251103_2323_max_batch_time.svg
[rank3]:> Batch Time: 522.55 ms, GPU Bubble Ratio: 51.10%, 50.09%, 61.48%, 18.30%
[rank3]:2025-11-03 23:23:07,705 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule/251103_2323_min_batch_time.svg
[rank3]:> Batch Time: 299.41 ms, GPU Bubble Ratio: 78.58%, 48.30%, 60.21%, 15.79%
[rank3]:2025-11-03 23:23:07,860 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule/251103_2323_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 328.51 ms, GPU Bubble Ratio: 42.09%, 33.40%, 41.89%, 14.39%
[rank3]:2025-11-03 23:23:07,860 - INFO - 	> Batch Time: 328.51 ms (Average Freeze Ratio: 0.41, Time Reduction Rate: 0.37)
[rank3]:2025-11-03 23:23:07,862 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.40/0.40, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-11-03 23:23:07,865 - INFO -  step: 300  loss:  0.2054  grad_norm:  0.0004  memory: 30.44GiB(64.07%)  tps: 6,173  tflops: 47.02  mfu: 15.07%
[rank0]:2025-11-03 23:23:07,934 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251103_2323_stage0_step300.svg
[rank1]:2025-11-03 23:23:07,931 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251103_2323_stage1_step300.svg
[rank2]:2025-11-03 23:23:07,926 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251103_2323_stage2_step300.svg
[rank3]:2025-11-03 23:23:08,008 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule/251103_2323_real_step300_rank3.svg
[rank3]:> Batch Time: 391.75 ms, GPU Bubble Ratio: 81.17%, 56.64%, 66.42%, 30.16%
[rank3]:2025-11-03 23:23:08,053 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251103_2323_stage3_step300.svg
[rank0]:2025-11-03 23:24:06,823 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-11-03 23:24:08,374 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.67/1.00
[rank2]:2025-11-03 23:24:08,375 - INFO -  step: 350  loss: -2.0000  grad_norm:  0.1937  memory: 12.12GiB(25.51%)  tps: 6,719  tflops: 51.17  mfu: 16.40%
[rank3]:2025-11-03 23:24:08,898 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.27/0.40, [MB2] 0.67/1.00, [MB3] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank3]:2025-11-03 23:24:08,902 - INFO -  step: 350  loss:  0.1667  grad_norm:  0.1937  memory: 31.41GiB(66.13%)  tps: 6,711  tflops: 51.11  mfu: 16.38%
[rank0]:2025-11-03 23:24:09,157 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.19/0.28, [MB3] 0.00/0.00, [MB4] 0.18/0.27, [MB5] 0.38/0.57, [MB6] 0.38/0.57, [MB7] 0.67/1.00
[rank0]:2025-11-03 23:24:09,158 - INFO -  step: 350  loss: -2.0000  grad_norm:  0.1937  memory: 16.63GiB(35.01%)  tps: 6,634  tflops: 50.52  mfu: 16.19%
[rank1]:2025-11-03 23:24:09,169 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.15/0.22, [MB2] 0.00/0.00, [MB3] 0.30/0.46, [MB4] 0.14/0.22, [MB5] 0.14/0.20, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank1]:2025-11-03 23:24:09,170 - INFO -  step: 350  loss: -2.0000  grad_norm:  0.1937  memory: 14.76GiB(31.06%)  tps: 6,632  tflops: 50.51  mfu: 16.19%
[rank0]:2025-11-03 23:24:58,460 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-03 23:24:58,972 - INFO - Avg. fwd time: 8.3072 / Avg. bwd time: 19.5871 / Avg. batch time: 562.2762 (ms) / GPU bubble ratio: 60.31%
[rank3]:2025-11-03 23:24:59,111 - INFO - Avg. fwd time: 11.2123 / Avg. bwd time: 38.1308 / Avg. batch time: 454.5391 (ms) / GPU bubble ratio: 13.16%
[rank1]:2025-11-03 23:24:59,195 - INFO - Avg. fwd time: 9.3006 / Avg. bwd time: 20.7408 / Avg. batch time: 527.0152 (ms) / GPU bubble ratio: 54.40%
[rank2]:2025-11-03 23:24:59,161 - INFO - Avg. fwd time: 7.1846 / Avg. bwd time: 16.0373 / Avg. batch time: 491.3731 (ms) / GPU bubble ratio: 62.19%
[rank2]:2025-11-03 23:24:59,326 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-03 23:24:59,327 - INFO -  step: 400  loss: -2.0000  grad_norm:  0.0793  memory: 12.12GiB(25.51%)  tps: 8,039  tflops: 61.23  mfu: 19.62%
[rank2]:2025-11-03 23:24:59,327 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-11-03 23:24:59,484 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.28/0.28, [MB3] 0.00/0.00, [MB4] 0.27/0.27, [MB5] 0.57/0.57, [MB6] 0.57/0.57, [MB7] 1.00/1.00
[rank0]:2025-11-03 23:24:59,485 - INFO -  step: 400  loss: -2.0000  grad_norm:  0.0793  memory: 16.63GiB(35.01%)  tps: 8,139  tflops: 61.99  mfu: 19.87%
[rank0]:2025-11-03 23:24:59,485 - INFO - ðŸ”Ž  Running validation at step 400
[rank3]:2025-11-03 23:24:59,546 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.40/0.40, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-11-03 23:24:59,551 - INFO -  step: 400  loss:  0.2147  grad_norm:  0.0793  memory: 31.41GiB(66.13%)  tps: 8,088  tflops: 61.60  mfu: 19.74%
[rank3]:2025-11-03 23:24:59,551 - INFO - ðŸ”Ž  Running validation at step 400
[rank1]:2025-11-03 23:24:59,664 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.22/0.22, [MB2] 0.00/0.00, [MB3] 0.46/0.46, [MB4] 0.22/0.22, [MB5] 0.20/0.20, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-11-03 23:24:59,664 - INFO -  step: 400  loss: -2.0000  grad_norm:  0.0793  memory: 14.82GiB(31.19%)  tps: 8,112  tflops: 61.78  mfu: 19.80%
[rank1]:2025-11-03 23:24:59,665 - INFO - ðŸ”Ž  Running validation at step 400
[rank3]:2025-11-03 23:25:20,815 - INFO - validate step: 400  loss:  0.9541  memory: 31.41GiB(66.13%)  tps: 19,264
[rank0]:2025-11-03 23:25:20,784 - INFO - validate step: 400  loss: -1.0000  memory: 16.63GiB(35.01%)  tps: 19,232
[rank1]:2025-11-03 23:25:20,803 - INFO - validate step: 400  loss: -1.0000  memory: 14.82GiB(31.19%)  tps: 19,377
[rank2]:2025-11-03 23:25:20,827 - INFO - validate step: 400  loss: -1.0000  memory: 12.12GiB(25.51%)  tps: 19,052
[rank0]:2025-11-03 23:25:20,881 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251103_2325_stage0_step400.svg
[rank1]:2025-11-03 23:25:20,882 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251103_2325_stage1_step400.svg
[rank2]:2025-11-03 23:25:20,882 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251103_2325_stage2_step400.svg
[rank3]:2025-11-03 23:25:20,991 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule/251103_2325_real_step400_rank3.svg
[rank3]:> Batch Time: 416.26 ms, GPU Bubble Ratio: 63.57%, 56.42%, 65.39%, 31.17%
[rank3]:2025-11-03 23:25:21,039 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251103_2325_stage3_step400.svg
[rank0]:2025-11-03 23:26:00,947 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-03 23:26:01,745 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.40/0.40, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-11-03 23:26:01,768 - INFO -  step: 450  loss:  0.2218  grad_norm:  0.0000  memory: 31.41GiB(66.13%)  tps: 10,002  tflops: 76.18  mfu: 24.42%
[rank1]:2025-11-03 23:26:01,763 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.22/0.22, [MB2] 0.00/0.00, [MB3] 0.46/0.46, [MB4] 0.22/0.22, [MB5] 0.20/0.20, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-11-03 23:26:01,767 - INFO -  step: 450  loss: -2.0000  grad_norm:  0.0000  memory: 14.82GiB(31.19%)  tps: 9,999  tflops: 76.16  mfu: 24.41%
[rank0]:2025-11-03 23:26:01,768 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.28/0.28, [MB3] 0.00/0.00, [MB4] 0.27/0.27, [MB5] 0.57/0.57, [MB6] 0.57/0.57, [MB7] 1.00/1.00
[rank0]:2025-11-03 23:26:01,769 - INFO -  step: 450  loss: -2.0000  grad_norm:  0.0000  memory: 16.63GiB(35.01%)  tps: 9,994  tflops: 76.12  mfu: 24.40%
[rank2]:2025-11-03 23:26:01,748 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-03 23:26:01,767 - INFO -  step: 450  loss: -2.0000  grad_norm:  0.0000  memory: 12.12GiB(25.51%)  tps: 10,005  tflops: 76.20  mfu: 24.42%
[rank0]:2025-11-03 23:26:41,643 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-03 23:26:42,110 - INFO - Avg. fwd time: 8.5016 / Avg. bwd time: 15.5337 / Avg. batch time: 526.7440 (ms) / GPU bubble ratio: 63.50%
[rank3]:2025-11-03 23:26:42,278 - INFO - Avg. fwd time: 11.6778 / Avg. bwd time: 34.4911 / Avg. batch time: 429.1083 (ms) / GPU bubble ratio: 13.93%
[rank1]:2025-11-03 23:26:42,359 - INFO - Avg. fwd time: 9.6207 / Avg. bwd time: 18.5878 / Avg. batch time: 496.1518 (ms) / GPU bubble ratio: 54.52%
[rank2]:2025-11-03 23:26:42,314 - INFO - Avg. fwd time: 7.4467 / Avg. bwd time: 14.3495 / Avg. batch time: 462.8036 (ms) / GPU bubble ratio: 62.32%
[rank3]:2025-11-03 23:26:42,580 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251103_2326_rank3_trend_line.svg
[rank1]:2025-11-03 23:26:42,582 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251103_2326_rank1_trend_line.svg
[rank2]:2025-11-03 23:26:42,571 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251103_2326_rank2_trend_line.svg
[rank1]:2025-11-03 23:26:42,612 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-11-03 23:26:42,613 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-11-03 23:26:42,614 - INFO -  step: 500  loss: -2.0000  grad_norm:  0.0000  memory: 14.82GiB(31.19%)  tps: 10,028  tflops: 76.37  mfu: 24.48%
[rank2]:2025-11-03 23:26:42,612 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-03 23:26:42,613 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-03 23:26:42,614 - INFO -  step: 500  loss: -2.0000  grad_norm:  0.0000  memory: 12.12GiB(25.51%)  tps: 10,028  tflops: 76.37  mfu: 24.48%
[rank0]:2025-11-03 23:26:42,606 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251103_2326_rank0_trend_line.svg
[rank0]:2025-11-03 23:26:42,613 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-11-03 23:26:42,615 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-11-03 23:26:42,616 - INFO -  step: 500  loss: -2.0000  grad_norm:  0.0000  memory: 16.63GiB(35.01%)  tps: 10,028  tflops: 76.37  mfu: 24.48%
[rank3]:2025-11-03 23:26:42,771 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule/251103_2326_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 320.43 ms, GPU Bubble Ratio: 67.21%, 47.26%, 59.97%, 15.80%
[rank3]:2025-11-03 23:26:42,772 - INFO - 	> Batch Time: 320.43 ms (Average Freeze Ratio: 0.29)
[rank3]:2025-11-03 23:26:42,773 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 0.40/0.40, [MB7] 0.00/0.00
[rank3]:2025-11-03 23:26:42,775 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 0.40/0.40, [MB7] 0.00/0.00
[rank3]:2025-11-03 23:26:42,778 - INFO -  step: 500  loss:  0.2580  grad_norm:  0.0000  memory: 31.41GiB(66.13%)  tps: 9,988  tflops: 76.07  mfu: 24.38%
[rank1]:2025-11-03 23:26:42,824 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251103_2326_stage1_step500.svg
[rank2]:2025-11-03 23:26:42,824 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251103_2326_stage2_step500.svg
[rank0]:2025-11-03 23:26:42,830 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251103_2326_stage0_step500.svg
[rank3]:2025-11-03 23:26:42,930 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule/251103_2326_real_step500_rank3.svg
[rank3]:> Batch Time: 390.75 ms, GPU Bubble Ratio: 81.13%, 56.40%, 66.28%, 29.78%
[rank3]:2025-11-03 23:26:42,974 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251103_2326_stage3_step500.svg
[rank0]:2025-11-03 23:27:52,100 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-11-03 23:27:53,170 - INFO -  step: 550  loss: -2.0000  grad_norm:  0.0000  memory: 12.12GiB(25.51%)  tps: 5,805  tflops: 44.21  mfu: 14.17%
[rank1]:2025-11-03 23:27:53,171 - INFO -  step: 550  loss: -2.0000  grad_norm:  0.0000  memory: 14.82GiB(31.19%)  tps: 5,805  tflops: 44.21  mfu: 14.17%
[rank0]:2025-11-03 23:27:53,172 - INFO -  step: 550  loss: -2.0000  grad_norm:  0.0000  memory: 16.63GiB(35.01%)  tps: 5,805  tflops: 44.21  mfu: 14.17%
[rank3]:2025-11-03 23:27:57,094 - INFO -  step: 550  loss:  0.2530  grad_norm:  0.0964  memory: 31.41GiB(66.13%)  tps: 5,512  tflops: 41.98  mfu: 13.45%
[rank0]:2025-11-03 23:29:04,636 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-03 23:29:05,707 - INFO - Avg. fwd time: 7.6150 / Avg. bwd time: 13.2433 / Avg. batch time: 495.2068 (ms) / GPU bubble ratio: 66.30%
[rank3]:2025-11-03 23:29:05,691 - INFO - Avg. fwd time: 11.5209 / Avg. bwd time: 35.1885 / Avg. batch time: 433.4358 (ms) / GPU bubble ratio: 13.79%
[rank1]:2025-11-03 23:29:05,725 - INFO - Avg. fwd time: 9.8283 / Avg. bwd time: 17.1546 / Avg. batch time: 527.0215 (ms) / GPU bubble ratio: 59.04%
[rank0]:2025-11-03 23:29:05,733 - INFO - Avg. fwd time: 8.6209 / Avg. bwd time: 12.8157 / Avg. batch time: 554.4813 (ms) / GPU bubble ratio: 69.07%
[rank2]:2025-11-03 23:29:05,866 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251103_2329_rank2_trend_line.svg
[rank2]:2025-11-03 23:29:05,902 - INFO - Adjusted Freeze Ratio per Block (no change): [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-03 23:29:05,904 - INFO -  step: 600  loss: -2.0000  grad_norm:  0.0000  memory: 12.12GiB(25.51%)  tps: 5,632  tflops: 42.89  mfu: 13.75%
[rank2]:2025-11-03 23:29:05,904 - INFO - ðŸ”Ž  Running validation at step 600
[rank3]:2025-11-03 23:29:05,880 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251103_2329_rank3_trend_line.svg
[rank1]:2025-11-03 23:29:05,894 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251103_2329_rank1_trend_line.svg
[rank1]:2025-11-03 23:29:05,903 - INFO - Adjusted Freeze Ratio per Block (no change): [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-11-03 23:29:05,905 - INFO -  step: 600  loss: -2.0000  grad_norm:  0.0000  memory: 14.82GiB(31.19%)  tps: 5,632  tflops: 42.89  mfu: 13.75%
[rank1]:2025-11-03 23:29:05,906 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-11-03 23:29:05,896 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251103_2329_rank0_trend_line.svg
[rank0]:2025-11-03 23:29:05,903 - INFO - Adjusted Freeze Ratio per Block (no change): [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-11-03 23:29:05,905 - INFO -  step: 600  loss: -2.0000  grad_norm:  0.0000  memory: 16.63GiB(35.01%)  tps: 5,632  tflops: 42.89  mfu: 13.75%
[rank0]:2025-11-03 23:29:05,905 - INFO - ðŸ”Ž  Running validation at step 600
[rank3]:2025-11-03 23:29:06,055 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule/251103_2329_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 366.36 ms, GPU Bubble Ratio: 76.58%, 55.83%, 66.07%, 13.88%
[rank3]:2025-11-03 23:29:06,056 - INFO - 	> Batch Time: 366.36 ms (Average Freeze Ratio: 0.29)
[rank3]:2025-11-03 23:29:06,056 - INFO - Adjusted Freeze Ratio per Block (no change): [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 0.40/0.40, [MB7] 0.00/0.00
[rank3]:2025-11-03 23:29:09,950 - INFO -  step: 600  loss:  0.2154  grad_norm:  0.1208  memory: 31.41GiB(66.13%)  tps: 5,622  tflops: 42.82  mfu: 13.72%
[rank3]:2025-11-03 23:29:09,951 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-11-03 23:29:29,520 - INFO - validate step: 600  loss: -1.0000  memory: 16.63GiB(35.01%)  tps: 17,346
[rank2]:2025-11-03 23:29:29,558 - INFO - validate step: 600  loss: -1.0000  memory: 12.12GiB(25.51%)  tps: 17,316
[rank3]:2025-11-03 23:29:29,549 - INFO - validate step: 600  loss:  0.9521  memory: 31.41GiB(66.13%)  tps: 20,902
[rank1]:2025-11-03 23:29:29,537 - INFO - validate step: 600  loss: -1.0000  memory: 14.82GiB(31.19%)  tps: 17,333
[rank1]:2025-11-03 23:29:29,610 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251103_2329_stage1_step600.svg
[rank0]:2025-11-03 23:29:29,610 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251103_2329_stage0_step600.svg
[rank2]:2025-11-03 23:29:29,611 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251103_2329_stage2_step600.svg
[rank3]:2025-11-03 23:29:29,717 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule/251103_2329_real_step600_rank3.svg
[rank3]:> Batch Time: 519.50 ms, GPU Bubble Ratio: 85.85%, 67.40%, 74.72%, 22.44%
[rank3]:2025-11-03 23:29:29,765 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251103_2329_stage3_step600.svg
[rank0]:2025-11-03 23:30:41,676 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-11-03 23:30:42,741 - INFO -  step: 650  loss: -2.0000  grad_norm:  0.0000  memory: 12.12GiB(25.51%)  tps: 5,597  tflops: 42.63  mfu: 13.66%
[rank1]:2025-11-03 23:30:42,742 - INFO -  step: 650  loss: -2.0000  grad_norm:  0.0000  memory: 14.82GiB(31.19%)  tps: 5,595  tflops: 42.62  mfu: 13.66%
[rank0]:2025-11-03 23:30:42,743 - INFO -  step: 650  loss: -2.0000  grad_norm:  0.0000  memory: 16.63GiB(35.01%)  tps: 5,594  tflops: 42.60  mfu: 13.66%
[rank3]:2025-11-03 23:30:46,601 - INFO -  step: 650  loss:  0.3574  grad_norm:  0.0819  memory: 31.41GiB(66.13%)  tps: 5,316  tflops: 40.49  mfu: 12.98%
[rank0]:2025-11-03 23:31:59,440 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-03 23:32:00,018 - INFO - Avg. fwd time: 8.6965 / Avg. bwd time: 11.1444 / Avg. batch time: 577.7526 (ms) / GPU bubble ratio: 72.53%
[rank3]:2025-11-03 23:32:00,255 - INFO - Avg. fwd time: 11.4088 / Avg. bwd time: 35.7409 / Avg. batch time: 436.9631 (ms) / GPU bubble ratio: 13.68%
[rank2]:2025-11-03 23:32:00,231 - INFO - Avg. fwd time: 7.7192 / Avg. bwd time: 12.5640 / Avg. batch time: 521.3569 (ms) / GPU bubble ratio: 68.88%
[rank1]:2025-11-03 23:32:00,313 - INFO - Avg. fwd time: 9.9565 / Avg. bwd time: 16.2732 / Avg. batch time: 552.2271 (ms) / GPU bubble ratio: 62.00%
[rank3]:2025-11-03 23:32:00,668 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251103_2332_rank3_trend_line.svg
[rank2]:2025-11-03 23:32:00,661 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251103_2332_rank2_trend_line.svg
[rank2]:2025-11-03 23:32:00,692 - INFO - Adjusted Freeze Ratio per Block (no change): [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-03 23:32:00,694 - INFO -  step: 700  loss: -2.0000  grad_norm:  0.0000  memory: 12.12GiB(25.51%)  tps: 5,254  tflops: 40.02  mfu: 12.83%
[rank0]:2025-11-03 23:32:00,686 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251103_2332_rank0_trend_line.svg
[rank0]:2025-11-03 23:32:00,693 - INFO - Adjusted Freeze Ratio per Block (no change): [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank0]:2025-11-03 23:32:00,695 - INFO -  step: 700  loss: -2.0000  grad_norm:  0.0000  memory: 16.63GiB(35.01%)  tps: 5,255  tflops: 40.02  mfu: 12.83%
[rank1]:2025-11-03 23:32:00,661 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251103_2332_rank1_trend_line.svg
[rank1]:2025-11-03 23:32:00,692 - INFO - Adjusted Freeze Ratio per Block (no change): [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank1]:2025-11-03 23:32:00,694 - INFO -  step: 700  loss: -2.0000  grad_norm:  0.0000  memory: 14.82GiB(31.19%)  tps: 5,255  tflops: 40.02  mfu: 12.83%
[rank3]:2025-11-03 23:32:00,851 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule/251103_2332_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 386.92 ms, GPU Bubble Ratio: 79.70%, 58.87%, 68.31%, 12.89%
[rank3]:2025-11-03 23:32:00,851 - INFO - 	> Batch Time: 386.92 ms (Average Freeze Ratio: 0.23)
[rank3]:2025-11-03 23:32:00,852 - INFO - Adjusted Freeze Ratio per Block (no change): [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 0.40/0.40, [MB7] 0.00/0.00
[rank2]:2025-11-03 23:32:05,213 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251103_2332_stage2_step700.svg
[rank3]:2025-11-03 23:32:05,160 - INFO -  step: 700  loss:  0.2301  grad_norm:  0.0809  memory: 31.41GiB(66.13%)  tps: 5,214  tflops: 39.71  mfu: 12.73%
[rank0]:2025-11-03 23:32:05,216 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251103_2332_stage0_step700.svg
[rank1]:2025-11-03 23:32:05,211 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251103_2332_stage1_step700.svg
[rank3]:2025-11-03 23:32:05,307 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule/251103_2332_real_step700_rank3.svg
[rank3]:> Batch Time: 517.50 ms, GPU Bubble Ratio: 85.79%, 67.23%, 74.59%, 22.40%
[rank3]:2025-11-03 23:32:05,353 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251103_2332_stage3_step700.svg
[rank0]:2025-11-03 23:33:30,500 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-11-03 23:33:31,666 - INFO -  step: 750  loss: -2.0000  grad_norm:  0.0000  memory: 12.12GiB(25.51%)  tps: 4,502  tflops: 34.29  mfu: 10.99%
[rank1]:2025-11-03 23:33:34,678 - INFO -  step: 750  loss: -2.0000  grad_norm:  0.4911  memory: 14.82GiB(31.19%)  tps: 4,358  tflops: 33.19  mfu: 10.64%
[rank3]:2025-11-03 23:33:36,926 - INFO -  step: 750  loss:  0.2246  grad_norm:  0.4911  memory: 31.41GiB(66.13%)  tps: 4,464  tflops: 34.00  mfu: 10.90%
[rank0]:2025-11-03 23:33:38,401 - INFO -  step: 750  loss: -2.0000  grad_norm:  0.4911  memory: 16.63GiB(35.01%)  tps: 4,192  tflops: 31.93  mfu: 10.23%

ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 11. 03. (ì›”) 23:56:12 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 3,4,5,6
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1029_llama1b/run_1031.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1029_llama1b/1031_GPipe_timelyapf.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
+ more freezing in autofreeze mode. 
+ lr_scheduler min_lr = 0 -> 1e-6, cosine decay.

âœ”ï¸Running with timelyapf x GPipe ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1029_llama1b/config_1031.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
+ more freezing in autofreeze mode. 
+ lr_scheduler min_lr = 0 -> 1e-6, cosine decay.
" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=timelyapf
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank0]:2025-11-03 23:56:18,762 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
[rank0]:+ more freezing in autofreeze mode. 
[rank0]:+ lr_scheduler min_lr = 0 -> 1e-6, cosine decay.
[rank0]:"
[rank2]:2025-11-03 23:56:18,781 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
[rank2]:+ more freezing in autofreeze mode. 
[rank2]:+ lr_scheduler min_lr = 0 -> 1e-6, cosine decay.
[rank2]:"
[rank0]:2025-11-03 23:56:18,984 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-11-03 23:56:18,987 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-03 23:56:18,990 - INFO - [GC] Initial GC collection 0.00 seconds
[rank2]:2025-11-03 23:56:18,995 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-11-03 23:56:18,997 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-11-03 23:56:19,437 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
[rank1]:+ more freezing in autofreeze mode. 
[rank1]:+ lr_scheduler min_lr = 0 -> 1e-6, cosine decay.
[rank1]:"
[rank3]:2025-11-03 23:56:19,451 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
[rank3]:+ more freezing in autofreeze mode. 
[rank3]:+ lr_scheduler min_lr = 0 -> 1e-6, cosine decay.
[rank3]:"
[rank1]:2025-11-03 23:56:19,648 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-11-03 23:56:19,651 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-11-03 23:56:19,671 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-11-03 23:56:19,674 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-03 23:56:19,997 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-11-03 23:56:20,384 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank0]:2025-11-03 23:56:23,515 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=512, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank2]:2025-11-03 23:56:23,492 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-11-03 23:56:23,534 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-11-03 23:56:23,563 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-11-03 23:56:23,563 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2025-11-03 23:56:23,497 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-11-03 23:56:23,537 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-11-03 23:56:23,564 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-11-03 23:56:23,564 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-11-03 23:56:23,663 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-11-03 23:56:23,748 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-11-03 23:56:23,749 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-11-03 23:56:23,749 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank0]:2025-11-03 23:56:23,694 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-03 23:56:23,696 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-11-03 23:56:23,722 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank1]:2025-11-03 23:56:23,740 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-03 23:56:23,723 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2025-11-03 23:56:23,740 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-11-03 23:56:23,741 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank0]:2025-11-03 23:56:23,935 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-03 23:56:23,935 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-11-03 23:56:23,936 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run uu8pwxq6
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1031_GPipe_timelyapf_dm1/20251103-2356/wandb/run-20251103_235624-uu8pwxq6
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1031_GPipe_timelyapf_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/uu8pwxq6
[rank3]:2025-11-03 23:56:25,647 - INFO - WandB logging enabled
[rank3]:2025-11-03 23:56:25,648 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-11-03 23:56:25,685 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-11-03 23:56:25,713 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-11-03 23:56:25,713 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank3]:2025-11-03 23:56:25,885 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-11-03 23:56:25,886 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-11-03 23:56:25,887 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2025-11-03 23:56:25,902 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank2]:2025-11-03 23:56:25,902 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-03 23:56:25,902 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1031_GPipe_timelyapf_dm1
[rank0]:2025-11-03 23:56:25,902 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-03 23:56:25,902 - INFO - Preparing c4_validation dataset from allenai/c4
[rank1]:2025-11-03 23:56:25,902 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank1]:2025-11-03 23:56:30,431 - WARNING - checkpoint.initial_load_path is provided but the checkpoint.folder exists. Checkpointer will use the checkpoints from the checkpoint.folder /data2/shcho/torchtitan/checkpoint/1031_GPipe_timelyapf_dm1.
[rank2]:2025-11-03 23:56:30,876 - WARNING - checkpoint.initial_load_path is provided but the checkpoint.folder exists. Checkpointer will use the checkpoints from the checkpoint.folder /data2/shcho/torchtitan/checkpoint/1031_GPipe_timelyapf_dm1.
[rank3]:2025-11-03 23:56:31,625 - WARNING - checkpoint.initial_load_path is provided but the checkpoint.folder exists. Checkpointer will use the checkpoints from the checkpoint.folder /data2/shcho/torchtitan/checkpoint/1031_GPipe_timelyapf_dm1.
[rank0]:2025-11-03 23:56:34,306 - INFO - Trainer is initialized with local batch size 32, global batch size 64, gradient accumulation steps 2, sequence length 512, total steps 2400 (warmup 300)
[rank0]:2025-11-03 23:56:34,307 - WARNING - checkpoint.initial_load_path is provided but the checkpoint.folder exists. Checkpointer will use the checkpoints from the checkpoint.folder /data2/shcho/torchtitan/checkpoint/1031_GPipe_timelyapf_dm1.
[rank0]:2025-11-03 23:56:34,307 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/checkpoint/1031_GPipe_timelyapf_dm1/step-1200.
[rank0]:2025-11-03 23:56:36,454 - INFO - [GC] GC collection for checkpoint loading. 0.01 seconds
[rank0]:2025-11-03 23:56:36,454 - INFO - Finished loading the checkpoint in 2.15 seconds.
[rank0]:2025-11-03 23:56:36,454 - INFO - Training starts at step 1
[rank3]:2025-11-03 23:56:38,382 - INFO -  step:  1  loss:  0.2830  grad_norm:  0.4662  memory: 23.19GiB(48.82%)  tps: 645  tflops: 4.91  mfu: 1.58%
[rank3]:2025-11-03 23:56:38,383 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-11-03 23:56:38,373 - INFO -  step:  1  loss: -2.0000  grad_norm:  0.4662  memory:  9.35GiB(19.67%)  tps: 552  tflops: 4.20  mfu: 1.35%
[rank2]:2025-11-03 23:56:38,373 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-03 23:56:38,408 - INFO -  step:  1  loss: -2.0000  grad_norm:  0.4662  memory: 12.28GiB(25.84%)  tps: 557  tflops: 4.24  mfu: 1.36%
[rank1]:2025-11-03 23:56:38,373 - INFO -  step:  1  loss: -2.0000  grad_norm:  0.4662  memory: 11.50GiB(24.20%)  tps: 552  tflops: 4.21  mfu: 1.35%
[rank1]:2025-11-03 23:56:38,373 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-03 23:56:38,408 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-03 23:57:37,329 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-03 23:57:38,577 - INFO -  step: 50  loss:  0.2357  grad_norm:  0.6962  memory: 27.51GiB(57.90%)  tps: 6,669  tflops: 50.79  mfu: 16.28%
[rank2]:2025-11-03 23:57:38,565 - INFO -  step: 50  loss: -2.0000  grad_norm:  0.6962  memory: 11.81GiB(24.85%)  tps: 6,669  tflops: 50.79  mfu: 16.28%
[rank0]:2025-11-03 23:57:38,580 - INFO -  step: 50  loss: -2.0000  grad_norm:  0.6962  memory: 16.57GiB(34.88%)  tps: 6,671  tflops: 50.81  mfu: 16.28%
[rank1]:2025-11-03 23:57:38,568 - INFO -  step: 50  loss: -2.0000  grad_norm:  0.6962  memory: 14.64GiB(30.82%)  tps: 6,668  tflops: 50.79  mfu: 16.28%
[rank0]:2025-11-03 23:58:39,438 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-03 23:58:40,397 - INFO - Avg. fwd time: 10.6196 / Avg. bwd time: 42.3836 / Avg. batch time: 484.0057 (ms) / GPU bubble ratio: 12.39%
[rank2]:2025-11-03 23:58:40,467 - INFO - Avg. fwd time: 6.8404 / Avg. bwd time: 18.2307 / Avg. batch time: 515.2380 (ms) / GPU bubble ratio: 61.07%
[rank0]:2025-11-03 23:58:40,512 - INFO - Avg. fwd time: 8.0293 / Avg. bwd time: 23.7991 / Avg. batch time: 592.1883 (ms) / GPU bubble ratio: 57.00%
[rank1]:2025-11-03 23:58:40,506 - INFO - Avg. fwd time: 8.8782 / Avg. bwd time: 23.5551 / Avg. batch time: 554.4255 (ms) / GPU bubble ratio: 53.20%
[rank3]:2025-11-03 23:58:40,697 - INFO -  step: 100  loss:  0.2123  grad_norm:  0.5223  memory: 27.51GiB(57.90%)  tps: 6,594  tflops: 50.22  mfu: 16.10%
[rank3]:2025-11-03 23:58:40,697 - WARNING - Nothing to draw before the end of warmup.
[rank2]:2025-11-03 23:58:40,684 - INFO -  step: 100  loss: -2.0000  grad_norm:  0.5223  memory: 11.81GiB(24.85%)  tps: 6,594  tflops: 50.22  mfu: 16.10%
[rank2]:2025-11-03 23:58:40,684 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-11-03 23:58:40,700 - INFO -  step: 100  loss: -2.0000  grad_norm:  0.5223  memory: 16.57GiB(34.88%)  tps: 6,594  tflops: 50.22  mfu: 16.10%
[rank0]:2025-11-03 23:58:40,700 - WARNING - Nothing to draw before the end of warmup.
[rank1]:2025-11-03 23:58:40,688 - INFO -  step: 100  loss: -2.0000  grad_norm:  0.5223  memory: 14.64GiB(30.82%)  tps: 6,594  tflops: 50.22  mfu: 16.10%
[rank1]:2025-11-03 23:58:40,688 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-11-03 23:59:41,549 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-03 23:59:42,827 - INFO -  step: 150  loss: -2.0000  grad_norm:  0.5390  memory: 11.81GiB(24.85%)  tps: 6,591  tflops: 50.20  mfu: 16.09%
[rank3]:2025-11-03 23:59:42,840 - INFO -  step: 150  loss:  0.2775  grad_norm:  0.5390  memory: 27.51GiB(57.90%)  tps: 6,591  tflops: 50.20  mfu: 16.09%
[rank0]:2025-11-03 23:59:42,842 - INFO -  step: 150  loss: -2.0000  grad_norm:  0.5390  memory: 16.57GiB(34.88%)  tps: 6,591  tflops: 50.20  mfu: 16.09%
[rank1]:2025-11-03 23:59:42,831 - INFO -  step: 150  loss: -2.0000  grad_norm:  0.5390  memory: 14.64GiB(30.82%)  tps: 6,591  tflops: 50.20  mfu: 16.09%
[rank0]:2025-11-04 00:00:43,865 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 00:00:44,846 - INFO - Avg. fwd time: 10.6693 / Avg. bwd time: 42.7111 / Avg. batch time: 486.9333 (ms) / GPU bubble ratio: 12.30%
[rank2]:2025-11-04 00:00:44,919 - INFO - Avg. fwd time: 6.8509 / Avg. bwd time: 18.2931 / Avg. batch time: 517.7170 (ms) / GPU bubble ratio: 61.15%
[rank0]:2025-11-04 00:00:44,965 - INFO - Avg. fwd time: 8.0407 / Avg. bwd time: 23.8663 / Avg. batch time: 593.7568 (ms) / GPU bubble ratio: 57.01%
[rank1]:2025-11-04 00:00:44,958 - INFO - Avg. fwd time: 8.8937 / Avg. bwd time: 23.6188 / Avg. batch time: 556.3832 (ms) / GPU bubble ratio: 53.25%
[rank2]:2025-11-04 00:00:45,136 - INFO -  step: 200  loss: -2.0000  grad_norm:  0.8260  memory: 11.81GiB(24.85%)  tps: 6,574  tflops: 50.07  mfu: 16.05%
[rank2]:2025-11-04 00:00:45,136 - INFO - ðŸ”Ž  Running validation at step 200
[rank1]:2025-11-04 00:00:45,140 - INFO -  step: 200  loss: -2.0000  grad_norm:  0.8260  memory: 14.64GiB(30.82%)  tps: 6,574  tflops: 50.07  mfu: 16.05%
[rank1]:2025-11-04 00:00:45,140 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-11-04 00:00:45,151 - INFO -  step: 200  loss: -2.0000  grad_norm:  0.8260  memory: 16.57GiB(34.88%)  tps: 6,574  tflops: 50.07  mfu: 16.05%
[rank0]:2025-11-04 00:00:45,151 - INFO - ðŸ”Ž  Running validation at step 200
[rank3]:2025-11-04 00:00:45,148 - INFO -  step: 200  loss:  0.2290  grad_norm:  0.8260  memory: 27.51GiB(57.90%)  tps: 6,574  tflops: 50.07  mfu: 16.05%
[rank3]:2025-11-04 00:00:45,149 - INFO - ðŸ”Ž  Running validation at step 200
[rank3]:2025-11-04 00:01:07,376 - INFO - validate step: 200  loss:  0.9554  memory: 27.51GiB(57.90%)  tps: 18,429
[rank1]:2025-11-04 00:01:07,369 - INFO - validate step: 200  loss: -1.0000  memory: 14.64GiB(30.82%)  tps: 18,426
[rank1]:2025-11-04 00:01:07,370 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-11-04 00:01:07,350 - INFO - validate step: 200  loss: -1.0000  memory: 16.57GiB(34.88%)  tps: 18,451
[rank0]:2025-11-04 00:01:07,351 - WARNING - Nothing to draw before the end of warmup.
[rank2]:2025-11-04 00:01:07,386 - INFO - validate step: 200  loss: -1.0000  memory: 11.81GiB(24.85%)  tps: 18,410
[rank2]:2025-11-04 00:01:07,387 - WARNING - Nothing to draw before the end of warmup.
[rank3]:2025-11-04 00:01:07,377 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-11-04 00:02:08,373 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-04 00:02:09,638 - INFO -  step: 250  loss:  0.2224  grad_norm:  0.7159  memory: 27.51GiB(57.90%)  tps: 6,579  tflops: 50.11  mfu: 16.06%
[rank1]:2025-11-04 00:02:09,629 - INFO -  step: 250  loss: -2.0000  grad_norm:  0.7159  memory: 14.64GiB(30.82%)  tps: 6,579  tflops: 50.11  mfu: 16.06%
[rank2]:2025-11-04 00:02:09,625 - INFO -  step: 250  loss: -2.0000  grad_norm:  0.7159  memory: 11.81GiB(24.85%)  tps: 6,581  tflops: 50.12  mfu: 16.07%
[rank0]:2025-11-04 00:02:09,640 - INFO -  step: 250  loss: -2.0000  grad_norm:  0.7159  memory: 16.57GiB(34.88%)  tps: 6,576  tflops: 50.08  mfu: 16.05%
[rank3]:2025-11-04 00:02:21,792 - INFO - [Step 260] ã€°ï¸ Monitoring Upperbound
[rank2]:2025-11-04 00:02:36,034 - WARNING - [Step 270] â³ Monitoring Upperbound... (540/550)
[rank3]:2025-11-04 00:02:36,009 - WARNING - [Step 270] â³ Monitoring Upperbound... (540/550)
[rank1]:2025-11-04 00:02:36,064 - WARNING - [Step 270] â³ Monitoring Upperbound... (540/550)
[rank0]:2025-11-04 00:02:36,094 - WARNING - [Step 270] â³ Monitoring Upperbound... (540/550)
[rank3]:2025-11-04 00:02:54,360 - INFO - [Step 280] âœ”ï¸  Setting Upperbound
[rank3]:2025-11-04 00:02:54,668 - INFO - [Step 280] ã€°ï¸ Monitoring Lowerbound
[rank2]:2025-11-04 00:02:57,173 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-04 00:02:59,870 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-04 00:02:59,891 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-04 00:02:59,911 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-04 00:02:59,924 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-04 00:02:59,935 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-04 00:02:59,944 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-04 00:02:59,979 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-04 00:03:00,016 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-04 00:03:00,005 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-04 00:03:00,023 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-04 00:02:59,985 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-04 00:03:00,024 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-04 00:03:00,052 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-04 00:03:00,088 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-04 00:03:00,035 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-04 00:03:00,045 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-04 00:03:00,067 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-04 00:03:00,103 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-04 00:03:00,060 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-04 00:03:00,170 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-04 00:03:00,209 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-04 00:03:00,149 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-04 00:03:00,184 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-04 00:03:00,188 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-04 00:03:00,228 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-04 00:03:00,211 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-04 00:03:00,249 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-04 00:03:00,250 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-04 00:03:00,269 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-04 00:03:00,310 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-04 00:03:00,290 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-04 00:03:15,443 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-04 00:03:16,234 - INFO - Avg. fwd time: 6.9570 / Avg. bwd time: 17.6410 / Avg. batch time: 509.8095 (ms) / GPU bubble ratio: 61.40%
[rank3]:2025-11-04 00:03:16,219 - INFO - Avg. fwd time: 10.8581 / Avg. bwd time: 41.3438 / Avg. batch time: 477.4664 (ms) / GPU bubble ratio: 12.54%
[rank3]:2025-11-04 00:03:16,223 - INFO - [Step 300] âœ”ï¸  Setting Lowerbound
[rank1]:2025-11-04 00:03:16,251 - INFO - Avg. fwd time: 9.0243 / Avg. bwd time: 22.7717 / Avg. batch time: 547.4496 (ms) / GPU bubble ratio: 53.54%
[rank0]:2025-11-04 00:03:16,257 - INFO - Avg. fwd time: 8.1277 / Avg. bwd time: 22.3223 / Avg. batch time: 583.1250 (ms) / GPU bubble ratio: 58.23%
[rank0]:2025-11-04 00:03:16,272 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.57/0.57, [MB5] 0.55/0.55, [MB6] 0.57/0.57, [MB7] 1.00/1.00
[rank0]:2025-11-04 00:03:16,273 - INFO -  step: 300  loss: -2.0000  grad_norm:  0.0000  memory: 16.57GiB(34.88%)  tps: 6,147  tflops: 46.82  mfu: 15.01%
[rank2]:2025-11-04 00:03:16,272 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-04 00:03:16,273 - INFO -  step: 300  loss: -2.0000  grad_norm:  0.0000  memory: 11.81GiB(24.85%)  tps: 6,146  tflops: 46.81  mfu: 15.00%
[rank1]:2025-11-04 00:03:16,274 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.22/0.22, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.89/0.89, [MB6] 0.97/0.97, [MB7] 1.00/1.00
[rank1]:2025-11-04 00:03:16,274 - INFO -  step: 300  loss: -2.0000  grad_norm:  0.0000  memory: 14.64GiB(30.82%)  tps: 6,146  tflops: 46.81  mfu: 15.00%
[rank3]:2025-11-04 00:03:16,430 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule/251104_0003_max_batch_time.svg
[rank3]:> Batch Time: 522.27 ms, GPU Bubble Ratio: 51.03%, 50.21%, 61.43%, 18.23%
[rank3]:2025-11-04 00:03:16,573 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule/251104_0003_min_batch_time.svg
[rank3]:> Batch Time: 299.37 ms, GPU Bubble Ratio: 78.49%, 48.26%, 60.12%, 15.79%
[rank3]:2025-11-04 00:03:16,730 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule/251104_0003_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 328.74 ms, GPU Bubble Ratio: 42.07%, 33.44%, 41.89%, 14.38%
[rank3]:2025-11-04 00:03:16,731 - INFO - 	> Batch Time: 328.74 ms (Average Freeze Ratio: 0.41, Time Reduction Rate: 0.37)
[rank3]:2025-11-04 00:03:16,733 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.40/0.40, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-11-04 00:03:16,735 - INFO -  step: 300  loss:  0.2050  grad_norm:  0.0004  memory: 30.44GiB(64.07%)  tps: 6,105  tflops: 46.49  mfu: 14.90%
[rank2]:2025-11-04 00:03:16,798 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251104_0003_stage2_step300.svg
[rank1]:2025-11-04 00:03:16,801 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251104_0003_stage1_step300.svg
[rank0]:2025-11-04 00:03:16,796 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251104_0003_stage0_step300.svg
[rank3]:2025-11-04 00:03:16,879 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule/251104_0003_real_step300_rank3.svg
[rank3]:> Batch Time: 392.25 ms, GPU Bubble Ratio: 81.32%, 56.67%, 66.39%, 30.15%
[rank3]:2025-11-04 00:03:16,924 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251104_0003_stage3_step300.svg
[rank0]:2025-11-04 00:04:13,380 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 00:04:14,886 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.27/0.40, [MB2] 0.67/1.00, [MB3] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank3]:2025-11-04 00:04:14,890 - INFO -  step: 350  loss:  0.1668  grad_norm:  0.3226  memory: 31.41GiB(66.13%)  tps: 7,044  tflops: 53.65  mfu: 17.19%
[rank2]:2025-11-04 00:04:15,180 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.67/1.00
[rank2]:2025-11-04 00:04:15,181 - INFO -  step: 350  loss: -2.0000  grad_norm:  0.3226  memory: 12.14GiB(25.55%)  tps: 6,953  tflops: 52.96  mfu: 16.97%
[rank1]:2025-11-04 00:04:15,876 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.15/0.22, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.59/0.89, [MB6] 0.65/0.97, [MB7] 0.67/1.00
[rank1]:2025-11-04 00:04:15,877 - INFO -  step: 350  loss: -2.0000  grad_norm:  0.3226  memory: 15.07GiB(31.72%)  tps: 6,872  tflops: 52.34  mfu: 16.78%
[rank0]:2025-11-04 00:04:17,866 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.38/0.57, [MB5] 0.37/0.55, [MB6] 0.38/0.57, [MB7] 0.67/1.00
[rank0]:2025-11-04 00:04:17,867 - INFO -  step: 350  loss: -2.0000  grad_norm:  0.3226  memory: 16.67GiB(35.09%)  tps: 6,650  tflops: 50.65  mfu: 16.23%
[rank0]:2025-11-04 00:05:07,160 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-04 00:05:07,695 - INFO - Avg. fwd time: 8.3250 / Avg. bwd time: 19.6843 / Avg. batch time: 561.5903 (ms) / GPU bubble ratio: 60.10%
[rank3]:2025-11-04 00:05:07,817 - INFO - Avg. fwd time: 11.2455 / Avg. bwd time: 38.0858 / Avg. batch time: 454.4465 (ms) / GPU bubble ratio: 13.16%
[rank2]:2025-11-04 00:05:07,870 - INFO - Avg. fwd time: 7.1856 / Avg. bwd time: 16.1681 / Avg. batch time: 489.4852 (ms) / GPU bubble ratio: 61.83%
[rank1]:2025-11-04 00:05:07,904 - INFO - Avg. fwd time: 9.3134 / Avg. bwd time: 20.7736 / Avg. batch time: 525.5581 (ms) / GPU bubble ratio: 54.20%
[rank2]:2025-11-04 00:05:08,045 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-04 00:05:08,046 - INFO -  step: 400  loss: -2.0000  grad_norm:  0.0810  memory: 12.14GiB(25.55%)  tps: 7,748  tflops: 59.01  mfu: 18.91%
[rank2]:2025-11-04 00:05:08,046 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-11-04 00:05:08,058 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.57/0.57, [MB5] 0.55/0.55, [MB6] 0.57/0.57, [MB7] 1.00/1.00
[rank0]:2025-11-04 00:05:08,058 - INFO -  step: 400  loss: -2.0000  grad_norm:  0.0810  memory: 16.67GiB(35.09%)  tps: 8,161  tflops: 62.15  mfu: 19.92%
[rank0]:2025-11-04 00:05:08,058 - INFO - ðŸ”Ž  Running validation at step 400
[rank3]:2025-11-04 00:05:08,374 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.40/0.40, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-11-04 00:05:08,378 - INFO -  step: 400  loss:  0.2147  grad_norm:  0.0810  memory: 31.41GiB(66.13%)  tps: 7,658  tflops: 58.33  mfu: 18.69%
[rank3]:2025-11-04 00:05:08,378 - INFO - ðŸ”Ž  Running validation at step 400
[rank1]:2025-11-04 00:05:08,498 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.22/0.22, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.89/0.89, [MB6] 0.97/0.97, [MB7] 1.00/1.00
[rank1]:2025-11-04 00:05:08,499 - INFO -  step: 400  loss: -2.0000  grad_norm:  0.0810  memory: 15.07GiB(31.72%)  tps: 7,784  tflops: 59.28  mfu: 19.00%
[rank1]:2025-11-04 00:05:08,499 - INFO - ðŸ”Ž  Running validation at step 400
[rank1]:2025-11-04 00:05:29,133 - INFO - validate step: 400  loss: -1.0000  memory: 15.07GiB(31.72%)  tps: 19,851
[rank0]:2025-11-04 00:05:29,110 - INFO - validate step: 400  loss: -1.0000  memory: 16.67GiB(35.09%)  tps: 19,457
[rank3]:2025-11-04 00:05:29,143 - INFO - validate step: 400  loss:  0.9553  memory: 31.41GiB(66.13%)  tps: 19,727
[rank2]:2025-11-04 00:05:29,150 - INFO - validate step: 400  loss: -1.0000  memory: 12.14GiB(25.55%)  tps: 19,409
[rank2]:2025-11-04 00:05:29,204 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251104_0005_stage2_step400.svg
[rank1]:2025-11-04 00:05:29,205 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251104_0005_stage1_step400.svg
[rank0]:2025-11-04 00:05:29,204 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251104_0005_stage0_step400.svg
[rank3]:2025-11-04 00:05:29,295 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule/251104_0005_real_step400_rank3.svg
[rank3]:> Batch Time: 413.10 ms, GPU Bubble Ratio: 65.94%, 56.02%, 66.43%, 31.16%
[rank3]:2025-11-04 00:05:29,341 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251104_0005_stage3_step400.svg
[rank0]:2025-11-04 00:06:08,982 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-04 00:06:09,777 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.40/0.40, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank2]:2025-11-04 00:06:09,779 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-11-04 00:06:09,795 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.22/0.22, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.89/0.89, [MB6] 0.97/0.97, [MB7] 1.00/1.00
[rank1]:2025-11-04 00:06:09,798 - INFO -  step: 450  loss: -2.0000  grad_norm:  0.0000  memory: 15.07GiB(31.72%)  tps: 10,073  tflops: 76.71  mfu: 24.59%
[rank0]:2025-11-04 00:06:09,799 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.57/0.57, [MB5] 0.55/0.55, [MB6] 0.57/0.57, [MB7] 1.00/1.00
[rank0]:2025-11-04 00:06:09,800 - INFO -  step: 450  loss: -2.0000  grad_norm:  0.0000  memory: 16.67GiB(35.09%)  tps: 10,067  tflops: 76.67  mfu: 24.57%
[rank3]:2025-11-04 00:06:09,799 - INFO -  step: 450  loss:  0.2222  grad_norm:  0.0000  memory: 31.41GiB(66.13%)  tps: 10,075  tflops: 76.74  mfu: 24.59%
[rank2]:2025-11-04 00:06:09,798 - INFO -  step: 450  loss: -2.0000  grad_norm:  0.0000  memory: 12.14GiB(25.55%)  tps: 10,077  tflops: 76.75  mfu: 24.60%
[rank0]:2025-11-04 00:06:49,391 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-04 00:06:49,842 - INFO - Avg. fwd time: 8.5098 / Avg. bwd time: 15.6440 / Avg. batch time: 526.6193 (ms) / GPU bubble ratio: 63.31%
[rank3]:2025-11-04 00:06:50,022 - INFO - Avg. fwd time: 11.7147 / Avg. bwd time: 34.4832 / Avg. batch time: 429.3472 (ms) / GPU bubble ratio: 13.92%
[rank2]:2025-11-04 00:06:50,059 - INFO - Avg. fwd time: 7.4517 / Avg. bwd time: 14.4582 / Avg. batch time: 461.2989 (ms) / GPU bubble ratio: 62.00%
[rank1]:2025-11-04 00:06:50,104 - INFO - Avg. fwd time: 9.6371 / Avg. bwd time: 18.6210 / Avg. batch time: 494.9980 (ms) / GPU bubble ratio: 54.33%
[rank0]:2025-11-04 00:06:50,193 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.57/0.57, [MB5] 0.55/0.55, [MB6] 0.57/0.57, [MB7] 1.00/1.00
[rank0]:2025-11-04 00:06:50,193 - INFO -  step: 500  loss: -2.0000  grad_norm:  0.0000  memory: 16.67GiB(35.09%)  tps: 10,140  tflops: 77.23  mfu: 24.75%
[rank2]:2025-11-04 00:06:50,181 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-04 00:06:50,192 - INFO -  step: 500  loss: -2.0000  grad_norm:  0.0000  memory: 12.14GiB(25.55%)  tps: 10,140  tflops: 77.23  mfu: 24.75%
[rank2]:2025-11-04 00:06:50,243 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251104_0006_stage2_step500.svg
[rank3]:2025-11-04 00:06:50,181 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.40/0.40, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-11-04 00:06:50,193 - INFO -  step: 500  loss:  0.2579  grad_norm:  0.0000  memory: 31.41GiB(66.13%)  tps: 10,141  tflops: 77.23  mfu: 24.75%
[rank1]:2025-11-04 00:06:50,193 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.22/0.22, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.89/0.89, [MB6] 0.97/0.97, [MB7] 1.00/1.00
[rank1]:2025-11-04 00:06:50,193 - INFO -  step: 500  loss: -2.0000  grad_norm:  0.0000  memory: 15.07GiB(31.72%)  tps: 10,140  tflops: 77.23  mfu: 24.75%
[rank1]:2025-11-04 00:06:50,246 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251104_0006_stage1_step500.svg
[rank0]:2025-11-04 00:06:50,242 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251104_0006_stage0_step500.svg
[rank3]:2025-11-04 00:06:50,340 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule/251104_0006_real_step500_rank3.svg
[rank3]:> Batch Time: 391.75 ms, GPU Bubble Ratio: 81.26%, 56.39%, 66.27%, 29.67%
[rank3]:2025-11-04 00:06:50,382 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251104_0006_stage3_step500.svg
[rank0]:2025-11-04 00:07:29,978 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-04 00:07:30,786 - INFO -  step: 550  loss: -2.0000  grad_norm:  0.0000  memory: 12.14GiB(25.55%)  tps: 10,090  tflops: 76.85  mfu: 24.63%
[rank3]:2025-11-04 00:07:30,788 - INFO -  step: 550  loss:  0.2528  grad_norm:  0.0000  memory: 31.41GiB(66.13%)  tps: 10,090  tflops: 76.85  mfu: 24.63%
[rank1]:2025-11-04 00:07:30,788 - INFO -  step: 550  loss: -2.0000  grad_norm:  0.0000  memory: 15.07GiB(31.72%)  tps: 10,090  tflops: 76.85  mfu: 24.63%
[rank0]:2025-11-04 00:07:30,787 - INFO -  step: 550  loss: -2.0000  grad_norm:  0.0000  memory: 16.67GiB(35.09%)  tps: 10,090  tflops: 76.85  mfu: 24.63%
[rank0]:2025-11-04 00:08:10,361 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-04 00:08:11,167 - INFO - Avg. fwd time: 7.6243 / Avg. bwd time: 13.3417 / Avg. batch time: 442.7507 (ms) / GPU bubble ratio: 62.12%
[rank3]:2025-11-04 00:08:11,152 - INFO - Avg. fwd time: 12.0195 / Avg. bwd time: 32.1136 / Avg. batch time: 412.8038 (ms) / GPU bubble ratio: 14.47%
[rank1]:2025-11-04 00:08:11,185 - INFO - Avg. fwd time: 9.8515 / Avg. bwd time: 17.1974 / Avg. batch time: 474.8802 (ms) / GPU bubble ratio: 54.43%
[rank0]:2025-11-04 00:08:11,191 - INFO - Avg. fwd time: 8.6254 / Avg. bwd time: 12.9067 / Avg. batch time: 503.1278 (ms) / GPU bubble ratio: 65.76%
[rank0]:2025-11-04 00:08:11,194 - INFO -  step: 600  loss: -2.0000  grad_norm:  0.0000  memory: 16.67GiB(35.09%)  tps: 10,137  tflops: 77.21  mfu: 24.75%
[rank0]:2025-11-04 00:08:11,194 - INFO - ðŸ”Ž  Running validation at step 600
[rank2]:2025-11-04 00:08:11,192 - INFO -  step: 600  loss: -2.0000  grad_norm:  0.0000  memory: 12.14GiB(25.55%)  tps: 10,137  tflops: 77.21  mfu: 24.75%
[rank2]:2025-11-04 00:08:11,192 - INFO - ðŸ”Ž  Running validation at step 600
[rank3]:2025-11-04 00:08:11,194 - INFO -  step: 600  loss:  0.2146  grad_norm:  0.0000  memory: 31.41GiB(66.13%)  tps: 10,138  tflops: 77.21  mfu: 24.75%
[rank3]:2025-11-04 00:08:11,195 - INFO - ðŸ”Ž  Running validation at step 600
[rank1]:2025-11-04 00:08:11,192 - INFO -  step: 600  loss: -2.0000  grad_norm:  0.0000  memory: 15.07GiB(31.72%)  tps: 10,138  tflops: 77.21  mfu: 24.75%
[rank1]:2025-11-04 00:08:11,192 - INFO - ðŸ”Ž  Running validation at step 600
[rank3]:2025-11-04 00:08:32,393 - INFO - validate step: 600  loss:  0.9536  memory: 31.41GiB(66.13%)  tps: 19,324
[rank2]:2025-11-04 00:08:32,400 - INFO - validate step: 600  loss: -1.0000  memory: 12.14GiB(25.55%)  tps: 19,314
[rank1]:2025-11-04 00:08:32,382 - INFO - validate step: 600  loss: -1.0000  memory: 15.07GiB(31.72%)  tps: 19,330
[rank0]:2025-11-04 00:08:32,359 - INFO - validate step: 600  loss: -1.0000  memory: 16.67GiB(35.09%)  tps: 19,353
[rank2]:2025-11-04 00:08:32,451 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251104_0008_stage2_step600.svg
[rank1]:2025-11-04 00:08:32,451 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251104_0008_stage1_step600.svg
[rank0]:2025-11-04 00:08:32,450 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251104_0008_stage0_step600.svg
[rank3]:2025-11-04 00:08:32,546 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule/251104_0008_real_step600_rank3.svg
[rank3]:> Batch Time: 390.75 ms, GPU Bubble Ratio: 81.25%, 56.33%, 66.22%, 29.70%
[rank3]:2025-11-04 00:08:32,591 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251104_0008_stage3_step600.svg
[rank0]:2025-11-04 00:09:12,222 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-04 00:09:13,038 - INFO -  step: 650  loss:  0.3544  grad_norm:  0.0000  memory: 31.41GiB(66.13%)  tps: 10,078  tflops: 76.76  mfu: 24.60%
[rank2]:2025-11-04 00:09:13,036 - INFO -  step: 650  loss: -2.0000  grad_norm:  0.0000  memory: 12.14GiB(25.55%)  tps: 10,080  tflops: 76.77  mfu: 24.61%
[rank1]:2025-11-04 00:09:13,037 - INFO -  step: 650  loss: -2.0000  grad_norm:  0.0000  memory: 15.07GiB(31.72%)  tps: 10,075  tflops: 76.73  mfu: 24.59%
[rank0]:2025-11-04 00:09:13,037 - INFO -  step: 650  loss: -2.0000  grad_norm:  0.0000  memory: 16.67GiB(35.09%)  tps: 10,069  tflops: 76.69  mfu: 24.58%
[rank0]:2025-11-04 00:09:52,737 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-04 00:09:53,190 - INFO - Avg. fwd time: 8.6980 / Avg. bwd time: 11.2234 / Avg. batch time: 488.7781 (ms) / GPU bubble ratio: 67.39%
[rank3]:2025-11-04 00:09:53,369 - INFO - Avg. fwd time: 12.2085 / Avg. bwd time: 30.6643 / Avg. batch time: 402.7074 (ms) / GPU bubble ratio: 14.83%
[rank2]:2025-11-04 00:09:53,406 - INFO - Avg. fwd time: 7.7310 / Avg. bwd time: 12.6559 / Avg. batch time: 431.4333 (ms) / GPU bubble ratio: 62.20%
[rank1]:2025-11-04 00:09:53,451 - INFO - Avg. fwd time: 9.9844 / Avg. bwd time: 16.3229 / Avg. batch time: 462.6046 (ms) / GPU bubble ratio: 54.51%
[rank0]:2025-11-04 00:09:53,538 - INFO -  step: 700  loss: -2.0000  grad_norm:  0.0000  memory: 16.67GiB(35.09%)  tps: 10,113  tflops: 77.03  mfu: 24.69%
[rank3]:2025-11-04 00:09:53,539 - INFO -  step: 700  loss:  0.2294  grad_norm:  0.0000  memory: 31.41GiB(66.13%)  tps: 10,114  tflops: 77.03  mfu: 24.69%
[rank2]:2025-11-04 00:09:53,537 - INFO -  step: 700  loss: -2.0000  grad_norm:  0.0000  memory: 12.14GiB(25.55%)  tps: 10,113  tflops: 77.03  mfu: 24.69%
[rank2]:2025-11-04 00:09:53,590 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251104_0009_stage2_step700.svg
[rank1]:2025-11-04 00:09:53,539 - INFO -  step: 700  loss: -2.0000  grad_norm:  0.0000  memory: 15.07GiB(31.72%)  tps: 10,113  tflops: 77.02  mfu: 24.69%
[rank1]:2025-11-04 00:09:53,592 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251104_0009_stage1_step700.svg
[rank0]:2025-11-04 00:09:53,590 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251104_0009_stage0_step700.svg
[rank3]:2025-11-04 00:09:53,686 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule/251104_0009_real_step700_rank3.svg
[rank3]:> Batch Time: 392.50 ms, GPU Bubble Ratio: 81.29%, 56.49%, 66.33%, 29.69%
[rank3]:2025-11-04 00:09:53,732 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251104_0009_stage3_step700.svg
[rank0]:2025-11-04 00:10:33,381 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-04 00:10:34,202 - INFO -  step: 750  loss: -2.0000  grad_norm:  0.0000  memory: 16.67GiB(35.09%)  tps: 10,073  tflops: 76.72  mfu: 24.59%
[rank3]:2025-11-04 00:10:34,202 - INFO -  step: 750  loss:  0.2238  grad_norm:  0.0000  memory: 31.41GiB(66.13%)  tps: 10,074  tflops: 76.72  mfu: 24.59%
[rank2]:2025-11-04 00:10:34,200 - INFO -  step: 750  loss: -2.0000  grad_norm:  0.0000  memory: 12.14GiB(25.55%)  tps: 10,073  tflops: 76.72  mfu: 24.59%
[rank1]:2025-11-04 00:10:34,200 - INFO -  step: 750  loss: -2.0000  grad_norm:  0.0000  memory: 15.07GiB(31.72%)  tps: 10,074  tflops: 76.72  mfu: 24.59%
[rank0]:2025-11-04 00:11:13,914 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-04 00:11:14,375 - INFO - Avg. fwd time: 8.7613 / Avg. bwd time: 9.7414 / Avg. batch time: 476.1524 (ms) / GPU bubble ratio: 68.91%
[rank2]:2025-11-04 00:11:14,593 - INFO - Avg. fwd time: 7.8250 / Avg. bwd time: 12.0523 / Avg. batch time: 421.4841 (ms) / GPU bubble ratio: 62.27%
[rank3]:2025-11-04 00:11:14,557 - INFO - Avg. fwd time: 12.3763 / Avg. bwd time: 29.3899 / Avg. batch time: 393.8436 (ms) / GPU bubble ratio: 15.16%
[rank1]:2025-11-04 00:11:14,640 - INFO - Avg. fwd time: 10.1014 / Avg. bwd time: 15.5533 / Avg. batch time: 451.8066 (ms) / GPU bubble ratio: 54.57%
[rank2]:2025-11-04 00:11:14,728 - INFO -  step: 800  loss: -2.0000  grad_norm:  0.0000  memory: 12.14GiB(25.55%)  tps: 10,107  tflops: 76.98  mfu: 24.67%
[rank2]:2025-11-04 00:11:14,728 - INFO - ðŸ”Ž  Running validation at step 800
[rank3]:2025-11-04 00:11:14,729 - INFO -  step: 800  loss:  0.2588  grad_norm:  0.0000  memory: 31.41GiB(66.13%)  tps: 10,107  tflops: 76.98  mfu: 24.67%
[rank3]:2025-11-04 00:11:14,729 - INFO - ðŸ”Ž  Running validation at step 800
[rank1]:2025-11-04 00:11:14,729 - INFO -  step: 800  loss: -2.0000  grad_norm:  0.0000  memory: 15.07GiB(31.72%)  tps: 10,106  tflops: 76.97  mfu: 24.67%
[rank1]:2025-11-04 00:11:14,730 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-11-04 00:11:14,729 - INFO -  step: 800  loss: -2.0000  grad_norm:  0.0000  memory: 16.67GiB(35.09%)  tps: 10,107  tflops: 76.98  mfu: 24.67%
[rank0]:2025-11-04 00:11:14,729 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-11-04 00:11:35,915 - INFO - validate step: 800  loss: -1.0000  memory: 16.67GiB(35.09%)  tps: 19,334
[rank2]:2025-11-04 00:11:35,957 - INFO - validate step: 800  loss: -1.0000  memory: 12.14GiB(25.55%)  tps: 19,295
[rank3]:2025-11-04 00:11:35,949 - INFO - validate step: 800  loss:  0.9537  memory: 31.41GiB(66.13%)  tps: 19,304
[rank1]:2025-11-04 00:11:35,939 - INFO - validate step: 800  loss: -1.0000  memory: 15.07GiB(31.72%)  tps: 19,313
[rank0]:2025-11-04 00:11:36,010 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251104_0011_stage0_step800.svg
[rank2]:2025-11-04 00:11:36,010 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251104_0011_stage2_step800.svg
[rank1]:2025-11-04 00:11:36,012 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251104_0011_stage1_step800.svg
[rank3]:2025-11-04 00:11:36,103 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule/251104_0011_real_step800_rank3.svg
[rank3]:> Batch Time: 392.75 ms, GPU Bubble Ratio: 81.30%, 56.47%, 66.34%, 29.73%
[rank3]:2025-11-04 00:11:36,149 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251104_0011_stage3_step800.svg
[rank3]:2025-11-04 00:11:44,499 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-11-04 00:11:44,648 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-11-04 00:11:44,661 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-11-04 00:11:44,661 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-11-04 00:12:15,861 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-11-04 00:12:16,665 - INFO -  step: 850  loss: -2.0000  grad_norm:  0.0000  memory: 16.67GiB(35.09%)  tps: 10,052  tflops: 76.56  mfu: 24.54%
[rank2]:2025-11-04 00:12:16,664 - INFO -  step: 850  loss: -2.0000  grad_norm:  0.0000  memory: 12.14GiB(25.55%)  tps: 10,062  tflops: 76.64  mfu: 24.56%
[rank3]:2025-11-04 00:12:16,666 - INFO -  step: 850  loss:  0.1972  grad_norm:  0.0000  memory: 31.41GiB(66.13%)  tps: 10,060  tflops: 76.62  mfu: 24.56%
[rank1]:2025-11-04 00:12:16,665 - INFO -  step: 850  loss: -2.0000  grad_norm:  0.0000  memory: 15.07GiB(31.72%)  tps: 10,057  tflops: 76.60  mfu: 24.55%
[rank0]:2025-11-04 00:12:56,423 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-04 00:12:57,225 - INFO - Avg. fwd time: 7.8966 / Avg. bwd time: 11.5889 / Avg. batch time: 413.8599 (ms) / GPU bubble ratio: 62.33%
[rank2]:2025-11-04 00:12:57,254 - INFO -  step: 900  loss: -2.0000  grad_norm:  0.0000  memory: 12.14GiB(25.55%)  tps: 10,091  tflops: 76.86  mfu: 24.63%
[rank3]:2025-11-04 00:12:57,209 - INFO - Avg. fwd time: 12.5045 / Avg. bwd time: 28.4137 / Avg. batch time: 387.0520 (ms) / GPU bubble ratio: 15.43%
[rank3]:2025-11-04 00:12:57,255 - INFO -  step: 900  loss:  0.1985  grad_norm:  0.0000  memory: 31.41GiB(66.13%)  tps: 10,092  tflops: 76.86  mfu: 24.64%
[rank1]:2025-11-04 00:12:57,244 - INFO - Avg. fwd time: 10.1906 / Avg. bwd time: 14.9629 / Avg. batch time: 443.5336 (ms) / GPU bubble ratio: 54.63%
[rank1]:2025-11-04 00:12:57,254 - INFO -  step: 900  loss: -2.0000  grad_norm:  0.0000  memory: 15.07GiB(31.72%)  tps: 10,092  tflops: 76.86  mfu: 24.63%
[rank0]:2025-11-04 00:12:57,253 - INFO - Avg. fwd time: 8.8111 / Avg. bwd time: 8.6051 / Avg. batch time: 466.4865 (ms) / GPU bubble ratio: 70.13%
[rank0]:2025-11-04 00:12:57,256 - INFO -  step: 900  loss: -2.0000  grad_norm:  0.0000  memory: 16.67GiB(35.09%)  tps: 10,091  tflops: 76.86  mfu: 24.63%
[rank0]:2025-11-04 00:12:57,304 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251104_0012_stage0_step900.svg
[rank2]:2025-11-04 00:12:57,303 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251104_0012_stage2_step900.svg
[rank1]:2025-11-04 00:12:57,311 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251104_0012_stage1_step900.svg
[rank3]:2025-11-04 00:12:57,402 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule/251104_0012_real_step900_rank3.svg
[rank3]:> Batch Time: 392.00 ms, GPU Bubble Ratio: 81.25%, 56.50%, 66.34%, 29.74%
[rank3]:2025-11-04 00:12:57,443 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251104_0012_stage3_step900.svg
[rank0]:2025-11-04 00:13:37,399 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-04 00:13:38,210 - INFO -  step: 950  loss: -2.0000  grad_norm:  0.0000  memory: 12.14GiB(25.55%)  tps: 10,001  tflops: 76.17  mfu: 24.41%
[rank3]:2025-11-04 00:13:38,211 - INFO -  step: 950  loss:  0.1574  grad_norm:  0.0000  memory: 31.41GiB(66.13%)  tps: 10,001  tflops: 76.17  mfu: 24.41%
[rank1]:2025-11-04 00:13:38,212 - INFO -  step: 950  loss: -2.0000  grad_norm:  0.0000  memory: 15.07GiB(31.72%)  tps: 10,001  tflops: 76.17  mfu: 24.41%
[rank0]:2025-11-04 00:13:38,212 - INFO -  step: 950  loss: -2.0000  grad_norm:  0.0000  memory: 16.67GiB(35.09%)  tps: 10,001  tflops: 76.17  mfu: 24.41%
[rank0]:2025-11-04 00:14:18,228 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-04 00:14:18,716 - INFO - Avg. fwd time: 8.8495 / Avg. bwd time: 7.8230 / Avg. batch time: 459.8204 (ms) / GPU bubble ratio: 70.99%
[rank3]:2025-11-04 00:14:18,885 - INFO - Avg. fwd time: 12.5915 / Avg. bwd time: 27.7381 / Avg. batch time: 382.3343 (ms) / GPU bubble ratio: 15.61%
[rank2]:2025-11-04 00:14:18,922 - INFO - Avg. fwd time: 7.9460 / Avg. bwd time: 11.2697 / Avg. batch time: 408.5702 (ms) / GPU bubble ratio: 62.37%
[rank1]:2025-11-04 00:14:18,968 - INFO - Avg. fwd time: 10.2519 / Avg. bwd time: 14.5562 / Avg. batch time: 437.7932 (ms) / GPU bubble ratio: 54.67%
[rank2]:2025-11-04 00:14:19,055 - INFO -  step: 1000  loss: -2.0000  grad_norm:  0.0000  memory: 12.14GiB(25.55%)  tps: 10,028  tflops: 76.38  mfu: 24.48%
[rank2]:2025-11-04 00:14:19,055 - INFO - ðŸ”Ž  Running validation at step 1000
[rank3]:2025-11-04 00:14:19,056 - INFO -  step: 1000  loss:  0.2314  grad_norm:  0.0000  memory: 31.41GiB(66.13%)  tps: 10,029  tflops: 76.38  mfu: 24.48%
[rank3]:2025-11-04 00:14:19,056 - INFO - ðŸ”Ž  Running validation at step 1000
[rank1]:2025-11-04 00:14:19,056 - INFO -  step: 1000  loss: -2.0000  grad_norm:  0.0000  memory: 15.07GiB(31.72%)  tps: 10,028  tflops: 76.38  mfu: 24.48%
[rank1]:2025-11-04 00:14:19,056 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-11-04 00:14:19,057 - INFO -  step: 1000  loss: -2.0000  grad_norm:  0.0000  memory: 16.67GiB(35.09%)  tps: 10,028  tflops: 76.38  mfu: 24.48%
[rank0]:2025-11-04 00:14:19,058 - INFO - ðŸ”Ž  Running validation at step 1000
[rank2]:2025-11-04 00:14:40,230 - INFO - validate step: 1000  loss: -1.0000  memory: 12.14GiB(25.55%)  tps: 19,344
[rank3]:2025-11-04 00:14:40,222 - INFO - validate step: 1000  loss:  0.9546  memory: 31.41GiB(66.13%)  tps: 19,353
[rank1]:2025-11-04 00:14:40,216 - INFO - validate step: 1000  loss: -1.0000  memory: 15.07GiB(31.72%)  tps: 19,358
[rank0]:2025-11-04 00:14:40,191 - INFO - validate step: 1000  loss: -1.0000  memory: 16.67GiB(35.09%)  tps: 19,382
[rank0]:2025-11-04 00:14:40,281 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251104_0014_stage0_step1000.svg
[rank2]:2025-11-04 00:14:40,280 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251104_0014_stage2_step1000.svg
[rank1]:2025-11-04 00:14:40,283 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251104_0014_stage1_step1000.svg
[rank3]:2025-11-04 00:14:40,383 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule/251104_0014_real_step1000_rank3.svg
[rank3]:> Batch Time: 391.75 ms, GPU Bubble Ratio: 81.15%, 56.46%, 66.33%, 29.84%
[rank3]:2025-11-04 00:14:40,427 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251104_0014_stage3_step1000.svg
[rank0]:2025-11-04 00:15:20,040 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-04 00:15:20,871 - INFO -  step: 1050  loss:  0.2384  grad_norm:  0.0000  memory: 31.41GiB(66.13%)  tps: 10,077  tflops: 76.75  mfu: 24.60%
[rank2]:2025-11-04 00:15:20,869 - INFO -  step: 1050  loss: -2.0000  grad_norm:  0.0000  memory: 12.14GiB(25.55%)  tps: 10,079  tflops: 76.77  mfu: 24.60%
[rank1]:2025-11-04 00:15:20,869 - INFO -  step: 1050  loss: -2.0000  grad_norm:  0.0000  memory: 15.07GiB(31.72%)  tps: 10,076  tflops: 76.74  mfu: 24.60%
[rank0]:2025-11-04 00:15:20,870 - INFO -  step: 1050  loss: -2.0000  grad_norm:  0.0000  memory: 16.67GiB(35.09%)  tps: 10,069  tflops: 76.69  mfu: 24.58%
[rank0]:2025-11-04 00:16:00,568 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-04 00:16:01,031 - INFO - Avg. fwd time: 8.8815 / Avg. bwd time: 7.0731 / Avg. batch time: 453.3782 (ms) / GPU bubble ratio: 71.85%
[rank3]:2025-11-04 00:16:01,211 - INFO - Avg. fwd time: 12.6752 / Avg. bwd time: 27.0875 / Avg. batch time: 377.7935 (ms) / GPU bubble ratio: 15.80%
[rank2]:2025-11-04 00:16:01,247 - INFO - Avg. fwd time: 7.9930 / Avg. bwd time: 10.9631 / Avg. batch time: 403.4815 (ms) / GPU bubble ratio: 62.41%
[rank1]:2025-11-04 00:16:01,293 - INFO - Avg. fwd time: 10.3104 / Avg. bwd time: 14.1655 / Avg. batch time: 432.2727 (ms) / GPU bubble ratio: 54.70%
[rank0]:2025-11-04 00:16:01,380 - INFO -  step: 1100  loss: -2.0000  grad_norm:  0.0000  memory: 16.67GiB(35.09%)  tps: 10,111  tflops: 77.01  mfu: 24.68%
[rank3]:2025-11-04 00:16:01,380 - INFO -  step: 1100  loss:  0.3034  grad_norm:  0.0000  memory: 31.41GiB(66.13%)  tps: 10,112  tflops: 77.01  mfu: 24.68%
[rank2]:2025-11-04 00:16:01,378 - INFO -  step: 1100  loss: -2.0000  grad_norm:  0.0000  memory: 12.14GiB(25.55%)  tps: 10,111  tflops: 77.01  mfu: 24.68%
[rank2]:2025-11-04 00:16:01,440 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251104_0016_stage2_step1100.svg
[rank1]:2025-11-04 00:16:01,380 - INFO -  step: 1100  loss: -2.0000  grad_norm:  0.0000  memory: 15.07GiB(31.72%)  tps: 10,111  tflops: 77.01  mfu: 24.68%
[rank1]:2025-11-04 00:16:01,441 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251104_0016_stage1_step1100.svg
[rank0]:2025-11-04 00:16:01,440 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251104_0016_stage0_step1100.svg
[rank3]:2025-11-04 00:16:01,545 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule/251104_0016_real_step1100_rank3.svg
[rank3]:> Batch Time: 392.00 ms, GPU Bubble Ratio: 81.27%, 56.43%, 66.31%, 29.72%
[rank3]:2025-11-04 00:16:01,590 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251104_0016_stage3_step1100.svg
[rank0]:2025-11-04 00:16:41,216 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-04 00:16:42,026 - INFO -  step: 1150  loss: -2.0000  grad_norm:  0.0000  memory: 15.07GiB(31.72%)  tps: 10,077  tflops: 76.75  mfu: 24.60%
[rank0]:2025-11-04 00:16:42,026 - INFO -  step: 1150  loss: -2.0000  grad_norm:  0.0000  memory: 16.67GiB(35.09%)  tps: 10,077  tflops: 76.75  mfu: 24.60%
[rank3]:2025-11-04 00:16:42,027 - INFO -  step: 1150  loss:  0.2065  grad_norm:  0.0000  memory: 31.41GiB(66.13%)  tps: 10,078  tflops: 76.75  mfu: 24.60%
[rank2]:2025-11-04 00:16:42,025 - INFO -  step: 1150  loss: -2.0000  grad_norm:  0.0000  memory: 12.14GiB(25.55%)  tps: 10,077  tflops: 76.75  mfu: 24.60%
[rank0]:2025-11-04 00:17:21,766 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 00:17:22,562 - INFO - Avg. fwd time: 12.7454 / Avg. bwd time: 26.5535 / Avg. batch time: 374.0780 (ms) / GPU bubble ratio: 15.96%
[rank0]:2025-11-04 00:17:22,607 - INFO - Avg. fwd time: 8.9070 / Avg. bwd time: 6.4544 / Avg. batch time: 448.0979 (ms) / GPU bubble ratio: 72.58%
[rank0]:2025-11-04 00:17:22,610 - INFO -  step: 1200  loss: -2.0000  grad_norm:  0.0000  memory: 16.67GiB(35.09%)  tps: 10,093  tflops: 76.87  mfu: 24.64%
[rank0]:2025-11-04 00:17:22,610 - INFO - ðŸ”Ž  Running validation at step 1200
[rank2]:2025-11-04 00:17:22,579 - INFO - Avg. fwd time: 8.0321 / Avg. bwd time: 10.7107 / Avg. batch time: 399.3180 (ms) / GPU bubble ratio: 62.45%
[rank2]:2025-11-04 00:17:22,609 - INFO -  step: 1200  loss: -2.0000  grad_norm:  0.0000  memory: 12.14GiB(25.55%)  tps: 10,093  tflops: 76.87  mfu: 24.64%
[rank2]:2025-11-04 00:17:22,609 - INFO - ðŸ”Ž  Running validation at step 1200
[rank3]:2025-11-04 00:17:22,610 - INFO -  step: 1200  loss:  0.1954  grad_norm:  0.0000  memory: 31.41GiB(66.13%)  tps: 10,093  tflops: 76.87  mfu: 24.64%
[rank3]:2025-11-04 00:17:22,611 - INFO - ðŸ”Ž  Running validation at step 1200
[rank1]:2025-11-04 00:17:22,599 - INFO - Avg. fwd time: 10.3592 / Avg. bwd time: 13.8439 / Avg. batch time: 427.7556 (ms) / GPU bubble ratio: 54.73%
[rank1]:2025-11-04 00:17:22,609 - INFO -  step: 1200  loss: -2.0000  grad_norm:  0.0000  memory: 15.07GiB(31.72%)  tps: 10,093  tflops: 76.87  mfu: 24.64%
[rank1]:2025-11-04 00:17:22,609 - INFO - ðŸ”Ž  Running validation at step 1200
[rank0]:2025-11-04 00:17:44,085 - INFO - validate step: 1200  loss: -1.0000  memory: 16.67GiB(35.09%)  tps: 19,074
[rank0]:2025-11-04 00:17:44,086 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-04 00:17:44,093 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank2]:2025-11-04 00:17:44,128 - INFO - validate step: 1200  loss: -1.0000  memory: 12.14GiB(25.55%)  tps: 19,034
[rank2]:2025-11-04 00:17:44,129 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-11-04 00:17:44,111 - INFO - validate step: 1200  loss: -1.0000  memory: 15.07GiB(31.72%)  tps: 19,049
[rank1]:2025-11-04 00:17:44,112 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-11-04 00:17:44,117 - INFO - validate step: 1200  loss:  0.9538  memory: 31.41GiB(66.13%)  tps: 19,046
[rank3]:2025-11-04 00:17:44,119 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-04 00:17:45,972 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 1.84 seconds.
[rank2]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /data2/shcho/torchtitan/checkpoint/1031_GPipe_timelyapf_dm1/step-1200, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank2]:  warnings.warn(
[rank1]:2025-11-04 00:17:47,428 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.32 seconds.
[rank1]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /data2/shcho/torchtitan/checkpoint/1031_GPipe_timelyapf_dm1/step-1200, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank1]:  warnings.warn(
[rank0]:2025-11-04 00:17:47,782 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-11-04 00:17:47,790 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.70 seconds.
[rank0]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /data2/shcho/torchtitan/checkpoint/1031_GPipe_timelyapf_dm1/step-1200, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank0]:  warnings.warn(
[rank3]:2025-11-04 00:17:49,143 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 5.02 seconds.
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /data2/shcho/torchtitan/checkpoint/1031_GPipe_timelyapf_dm1/step-1200, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank3]:  warnings.warn(
[rank2]:2025-11-04 00:17:49,216 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251104_0017_stage2_step1200.svg
[rank1]:2025-11-04 00:17:49,217 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251104_0017_stage1_step1200.svg
[rank0]:2025-11-04 00:17:49,300 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251104_0017_stage0_step1200.svg
[rank3]:2025-11-04 00:17:49,348 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule/251104_0017_real_step1200_rank3.svg
[rank3]:> Batch Time: 392.25 ms, GPU Bubble Ratio: 81.26%, 56.41%, 66.33%, 29.65%
[rank3]:2025-11-04 00:17:49,400 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251104_0017_stage3_step1200.svg
[rank0]:2025-11-04 00:18:29,641 - INFO - [GC] Peforming periodical GC collection 0.32 seconds
[rank1]:2025-11-04 00:18:30,463 - INFO -  step: 1250  loss: -2.0000  grad_norm:  0.0000  memory: 15.07GiB(31.72%)  tps: 8,837  tflops: 67.30  mfu: 21.57%
[rank3]:2025-11-04 00:18:30,463 - INFO -  step: 1250  loss:  0.3156  grad_norm:  0.0000  memory: 31.41GiB(66.13%)  tps: 8,838  tflops: 67.32  mfu: 21.58%
[rank0]:2025-11-04 00:18:30,463 - INFO -  step: 1250  loss: -2.0000  grad_norm:  0.0000  memory: 16.67GiB(35.09%)  tps: 8,832  tflops: 67.27  mfu: 21.56%
[rank2]:2025-11-04 00:18:30,461 - INFO -  step: 1250  loss: -2.0000  grad_norm:  0.0000  memory: 12.14GiB(25.55%)  tps: 8,840  tflops: 67.33  mfu: 21.58%
[rank0]:2025-11-04 00:19:10,183 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-04 00:19:10,642 - INFO - Avg. fwd time: 8.9275 / Avg. bwd time: 6.0042 / Avg. batch time: 444.3181 (ms) / GPU bubble ratio: 73.12%
[rank3]:2025-11-04 00:19:10,822 - INFO - Avg. fwd time: 12.7953 / Avg. bwd time: 26.1648 / Avg. batch time: 371.3726 (ms) / GPU bubble ratio: 16.07%
[rank2]:2025-11-04 00:19:10,858 - INFO - Avg. fwd time: 8.0605 / Avg. bwd time: 10.5277 / Avg. batch time: 396.3439 (ms) / GPU bubble ratio: 62.48%
[rank1]:2025-11-04 00:19:10,904 - INFO - Avg. fwd time: 10.3941 / Avg. bwd time: 13.6098 / Avg. batch time: 424.5253 (ms) / GPU bubble ratio: 54.77%
[rank1]:2025-11-04 00:19:10,989 - INFO -  step: 1300  loss: -2.0000  grad_norm:  0.0000  memory: 15.07GiB(31.72%)  tps: 10,107  tflops: 76.98  mfu: 24.67%
[rank3]:2025-11-04 00:19:10,989 - INFO -  step: 1300  loss:  0.2790  grad_norm:  0.0000  memory: 31.41GiB(66.13%)  tps: 10,108  tflops: 76.98  mfu: 24.67%
[rank2]:2025-11-04 00:19:10,987 - INFO -  step: 1300  loss: -2.0000  grad_norm:  0.0000  memory: 12.14GiB(25.55%)  tps: 10,107  tflops: 76.98  mfu: 24.67%
[rank2]:2025-11-04 00:19:11,039 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251104_0019_stage2_step1300.svg
[rank0]:2025-11-04 00:19:10,988 - INFO -  step: 1300  loss: -2.0000  grad_norm:  0.0000  memory: 16.67GiB(35.09%)  tps: 10,107  tflops: 76.98  mfu: 24.67%
[rank0]:2025-11-04 00:19:11,040 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251104_0019_stage0_step1300.svg
[rank1]:2025-11-04 00:19:11,042 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251104_0019_stage1_step1300.svg
[rank3]:2025-11-04 00:19:11,141 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule/251104_0019_real_step1300_rank3.svg
[rank3]:> Batch Time: 392.25 ms, GPU Bubble Ratio: 81.26%, 56.45%, 66.32%, 29.72%
[rank3]:2025-11-04 00:19:11,188 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251104_0019_stage3_step1300.svg
[rank0]:2025-11-04 00:19:50,821 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-04 00:19:51,647 - INFO -  step: 1350  loss: -2.0000  grad_norm:  0.0000  memory: 15.07GiB(31.72%)  tps: 10,074  tflops: 76.73  mfu: 24.59%
[rank3]:2025-11-04 00:19:51,649 - INFO -  step: 1350  loss:  0.2770  grad_norm:  0.0000  memory: 31.41GiB(66.13%)  tps: 10,074  tflops: 76.73  mfu: 24.59%
[rank2]:2025-11-04 00:19:51,647 - INFO -  step: 1350  loss: -2.0000  grad_norm:  0.0000  memory: 12.14GiB(25.55%)  tps: 10,074  tflops: 76.72  mfu: 24.59%
[rank0]:2025-11-04 00:19:51,649 - INFO -  step: 1350  loss: -2.0000  grad_norm:  0.0000  memory: 16.67GiB(35.09%)  tps: 10,074  tflops: 76.72  mfu: 24.59%
[rank0]:2025-11-04 00:20:31,348 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-04 00:20:31,812 - INFO - Avg. fwd time: 8.9462 / Avg. bwd time: 5.5524 / Avg. batch time: 440.4526 (ms) / GPU bubble ratio: 73.67%
[rank3]:2025-11-04 00:20:31,996 - INFO - Avg. fwd time: 12.8460 / Avg. bwd time: 25.7752 / Avg. batch time: 368.6577 (ms) / GPU bubble ratio: 16.19%
[rank2]:2025-11-04 00:20:32,033 - INFO - Avg. fwd time: 8.0891 / Avg. bwd time: 10.3436 / Avg. batch time: 393.2966 (ms) / GPU bubble ratio: 62.51%
[rank1]:2025-11-04 00:20:32,079 - INFO - Avg. fwd time: 10.4295 / Avg. bwd time: 13.3748 / Avg. batch time: 421.2184 (ms) / GPU bubble ratio: 54.79%
[rank2]:2025-11-04 00:20:32,163 - INFO -  step: 1400  loss: -2.0000  grad_norm:  0.0000  memory: 12.14GiB(25.55%)  tps: 10,110  tflops: 77.00  mfu: 24.68%
[rank2]:2025-11-04 00:20:32,163 - INFO - ðŸ”Ž  Running validation at step 1400
[rank0]:2025-11-04 00:20:32,165 - INFO -  step: 1400  loss: -2.0000  grad_norm:  0.0000  memory: 16.67GiB(35.09%)  tps: 10,110  tflops: 77.00  mfu: 24.68%
[rank0]:2025-11-04 00:20:32,165 - INFO - ðŸ”Ž  Running validation at step 1400
[rank1]:2025-11-04 00:20:32,164 - INFO -  step: 1400  loss: -2.0000  grad_norm:  0.0000  memory: 15.07GiB(31.72%)  tps: 10,109  tflops: 77.00  mfu: 24.68%
[rank1]:2025-11-04 00:20:32,164 - INFO - ðŸ”Ž  Running validation at step 1400
[rank3]:2025-11-04 00:20:32,165 - INFO -  step: 1400  loss:  0.2459  grad_norm:  0.0000  memory: 31.41GiB(66.13%)  tps: 10,110  tflops: 77.00  mfu: 24.68%
[rank3]:2025-11-04 00:20:32,166 - INFO - ðŸ”Ž  Running validation at step 1400
[rank0]:2025-11-04 00:20:53,417 - INFO - validate step: 1400  loss: -1.0000  memory: 16.67GiB(35.09%)  tps: 19,274
[rank1]:2025-11-04 00:20:53,446 - INFO - validate step: 1400  loss: -1.0000  memory: 15.07GiB(31.72%)  tps: 19,247
[rank3]:2025-11-04 00:20:53,450 - INFO - validate step: 1400  loss:  0.9536  memory: 31.41GiB(66.13%)  tps: 19,245
[rank2]:2025-11-04 00:20:53,456 - INFO - validate step: 1400  loss: -1.0000  memory: 12.14GiB(25.55%)  tps: 19,236
[rank0]:2025-11-04 00:20:53,510 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251104_0020_stage0_step1400.svg
[rank1]:2025-11-04 00:20:53,516 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251104_0020_stage1_step1400.svg
[rank2]:2025-11-04 00:20:53,509 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251104_0020_stage2_step1400.svg
[rank3]:2025-11-04 00:20:53,608 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule/251104_0020_real_step1400_rank3.svg
[rank3]:> Batch Time: 391.25 ms, GPU Bubble Ratio: 81.23%, 56.41%, 66.26%, 29.72%
[rank3]:2025-11-04 00:20:53,656 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251104_0020_stage3_step1400.svg
[rank0]:2025-11-04 00:21:33,281 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-11-04 00:21:34,086 - INFO -  step: 1450  loss: -2.0000  grad_norm:  0.0000  memory: 16.67GiB(35.09%)  tps: 10,072  tflops: 76.71  mfu: 24.59%
[rank1]:2025-11-04 00:21:34,086 - INFO -  step: 1450  loss: -2.0000  grad_norm:  0.0000  memory: 15.07GiB(31.72%)  tps: 10,079  tflops: 76.76  mfu: 24.60%
[rank3]:2025-11-04 00:21:34,087 - INFO -  step: 1450  loss:  0.2495  grad_norm:  0.0000  memory: 31.41GiB(66.13%)  tps: 10,080  tflops: 76.77  mfu: 24.61%
[rank2]:2025-11-04 00:21:34,085 - INFO -  step: 1450  loss: -2.0000  grad_norm:  0.0000  memory: 12.14GiB(25.55%)  tps: 10,082  tflops: 76.79  mfu: 24.61%
[rank0]:2025-11-04 00:22:13,776 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 00:22:14,567 - INFO - Avg. fwd time: 12.8890 / Avg. bwd time: 25.4385 / Avg. batch time: 366.3049 (ms) / GPU bubble ratio: 16.29%
[rank2]:2025-11-04 00:22:14,584 - INFO - Avg. fwd time: 8.1135 / Avg. bwd time: 10.1850 / Avg. batch time: 390.6579 (ms) / GPU bubble ratio: 62.53%
[rank0]:2025-11-04 00:22:14,616 - INFO - Avg. fwd time: 8.9618 / Avg. bwd time: 5.1639 / Avg. batch time: 437.1105 (ms) / GPU bubble ratio: 74.15%
[rank0]:2025-11-04 00:22:14,618 - INFO -  step: 1500  loss: -2.0000  grad_norm:  0.0000  memory: 16.67GiB(35.09%)  tps: 10,106  tflops: 76.97  mfu: 24.67%
[rank1]:2025-11-04 00:22:14,606 - INFO - Avg. fwd time: 10.4593 / Avg. bwd time: 13.1723 / Avg. batch time: 418.3560 (ms) / GPU bubble ratio: 54.81%
[rank1]:2025-11-04 00:22:14,617 - INFO -  step: 1500  loss: -2.0000  grad_norm:  0.0000  memory: 15.07GiB(31.72%)  tps: 10,106  tflops: 76.97  mfu: 24.67%
[rank3]:2025-11-04 00:22:14,618 - INFO -  step: 1500  loss:  0.2863  grad_norm:  0.0000  memory: 31.41GiB(66.13%)  tps: 10,106  tflops: 76.97  mfu: 24.67%
[rank2]:2025-11-04 00:22:14,617 - INFO -  step: 1500  loss: -2.0000  grad_norm:  0.0000  memory: 12.14GiB(25.55%)  tps: 10,106  tflops: 76.97  mfu: 24.67%
[rank2]:2025-11-04 00:22:14,671 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251104_0022_stage2_step1500.svg
[rank0]:2025-11-04 00:22:14,671 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251104_0022_stage0_step1500.svg
[rank1]:2025-11-04 00:22:14,674 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251104_0022_stage1_step1500.svg
[rank3]:2025-11-04 00:22:14,768 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule/251104_0022_real_step1500_rank3.svg
[rank3]:> Batch Time: 392.25 ms, GPU Bubble Ratio: 81.31%, 56.51%, 66.33%, 29.78%
[rank3]:2025-11-04 00:22:14,816 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251104_0022_stage3_step1500.svg
[rank0]:2025-11-04 00:22:54,470 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-04 00:22:55,279 - INFO -  step: 1550  loss: -2.0000  grad_norm:  0.0000  memory: 16.67GiB(35.09%)  tps: 10,074  tflops: 76.72  mfu: 24.59%
[rank1]:2025-11-04 00:22:55,279 - INFO -  step: 1550  loss: -2.0000  grad_norm:  0.0000  memory: 15.07GiB(31.72%)  tps: 10,073  tflops: 76.72  mfu: 24.59%
[rank3]:2025-11-04 00:22:55,280 - INFO -  step: 1550  loss:  0.2449  grad_norm:  0.0000  memory: 31.41GiB(66.13%)  tps: 10,074  tflops: 76.73  mfu: 24.59%
[rank2]:2025-11-04 00:22:55,278 - INFO -  step: 1550  loss: -2.0000  grad_norm:  0.0000  memory: 12.14GiB(25.55%)  tps: 10,074  tflops: 76.72  mfu: 24.59%
[rank0]:2025-11-04 00:23:35,035 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-04 00:23:35,497 - INFO - Avg. fwd time: 8.9736 / Avg. bwd time: 4.8717 / Avg. batch time: 434.6169 (ms) / GPU bubble ratio: 74.51%
[rank3]:2025-11-04 00:23:35,682 - INFO - Avg. fwd time: 12.9218 / Avg. bwd time: 25.1868 / Avg. batch time: 364.5518 (ms) / GPU bubble ratio: 16.37%
[rank1]:2025-11-04 00:23:35,765 - INFO - Avg. fwd time: 10.4822 / Avg. bwd time: 13.0204 / Avg. batch time: 416.2249 (ms) / GPU bubble ratio: 54.83%
[rank2]:2025-11-04 00:23:35,718 - INFO - Avg. fwd time: 8.1319 / Avg. bwd time: 10.0659 / Avg. batch time: 388.6933 (ms) / GPU bubble ratio: 62.55%
[rank0]:2025-11-04 00:23:35,850 - INFO -  step: 1600  loss: -2.0000  grad_norm:  0.0000  memory: 16.67GiB(35.09%)  tps: 10,096  tflops: 76.89  mfu: 24.65%
[rank0]:2025-11-04 00:23:35,850 - INFO - ðŸ”Ž  Running validation at step 1600
[rank1]:2025-11-04 00:23:35,850 - INFO -  step: 1600  loss: -2.0000  grad_norm:  0.0000  memory: 15.07GiB(31.72%)  tps: 10,096  tflops: 76.89  mfu: 24.65%
[rank1]:2025-11-04 00:23:35,850 - INFO - ðŸ”Ž  Running validation at step 1600
[rank3]:2025-11-04 00:23:35,850 - INFO -  step: 1600  loss:  0.2079  grad_norm:  0.0000  memory: 31.41GiB(66.13%)  tps: 10,097  tflops: 76.90  mfu: 24.65%
[rank3]:2025-11-04 00:23:35,851 - INFO - ðŸ”Ž  Running validation at step 1600
[rank2]:2025-11-04 00:23:35,848 - INFO -  step: 1600  loss: -2.0000  grad_norm:  0.0000  memory: 12.14GiB(25.55%)  tps: 10,096  tflops: 76.89  mfu: 24.65%
[rank2]:2025-11-04 00:23:35,848 - INFO - ðŸ”Ž  Running validation at step 1600
[rank0]:2025-11-04 00:23:57,207 - INFO - validate step: 1600  loss: -1.0000  memory: 16.67GiB(35.09%)  tps: 19,179
[rank1]:2025-11-04 00:23:57,233 - INFO - validate step: 1600  loss: -1.0000  memory: 15.07GiB(31.72%)  tps: 19,156
[rank1]:2025-11-04 00:23:57,306 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251104_0023_stage1_step1600.svg
[rank3]:2025-11-04 00:23:57,240 - INFO - validate step: 1600  loss:  0.9544  memory: 31.41GiB(66.13%)  tps: 19,151
[rank2]:2025-11-04 00:23:57,248 - INFO - validate step: 1600  loss: -1.0000  memory: 12.14GiB(25.55%)  tps: 19,141
[rank2]:2025-11-04 00:23:57,303 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251104_0023_stage2_step1600.svg
[rank0]:2025-11-04 00:23:57,302 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251104_0023_stage0_step1600.svg
[rank3]:2025-11-04 00:23:57,400 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule/251104_0023_real_step1600_rank3.svg
[rank3]:> Batch Time: 391.50 ms, GPU Bubble Ratio: 81.26%, 56.40%, 66.27%, 29.59%
[rank3]:2025-11-04 00:23:57,450 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251104_0023_stage3_step1600.svg
[rank3]:2025-11-04 00:24:14,671 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-11-04 00:24:14,835 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-11-04 00:24:14,820 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-11-04 00:24:14,832 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-11-04 00:24:37,070 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-11-04 00:24:37,896 - INFO -  step: 1650  loss: -2.0000  grad_norm:  0.0000  memory: 16.67GiB(35.09%)  tps: 10,067  tflops: 76.67  mfu: 24.57%
[rank1]:2025-11-04 00:24:37,895 - INFO -  step: 1650  loss: -2.0000  grad_norm:  0.0000  memory: 15.07GiB(31.72%)  tps: 10,074  tflops: 76.72  mfu: 24.59%
[rank2]:2025-11-04 00:24:37,895 - INFO -  step: 1650  loss: -2.0000  grad_norm:  0.0000  memory: 12.14GiB(25.55%)  tps: 10,077  tflops: 76.75  mfu: 24.60%
[rank3]:2025-11-04 00:24:37,897 - INFO -  step: 1650  loss:  0.2744  grad_norm:  0.0000  memory: 31.41GiB(66.13%)  tps: 10,075  tflops: 76.74  mfu: 24.59%
[rank0]:2025-11-04 00:25:17,566 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-04 00:25:18,024 - INFO - Avg. fwd time: 8.9864 / Avg. bwd time: 4.5700 / Avg. batch time: 432.0415 (ms) / GPU bubble ratio: 74.90%
[rank3]:2025-11-04 00:25:18,207 - INFO - Avg. fwd time: 12.9556 / Avg. bwd time: 24.9277 / Avg. batch time: 362.7472 (ms) / GPU bubble ratio: 16.45%
[rank1]:2025-11-04 00:25:18,290 - INFO - Avg. fwd time: 10.5061 / Avg. bwd time: 12.8637 / Avg. batch time: 414.0231 (ms) / GPU bubble ratio: 54.84%
[rank2]:2025-11-04 00:25:18,243 - INFO - Avg. fwd time: 8.1509 / Avg. bwd time: 9.9429 / Avg. batch time: 386.6652 (ms) / GPU bubble ratio: 62.56%
[rank0]:2025-11-04 00:25:18,373 - INFO -  step: 1700  loss: -2.0000  grad_norm:  0.0000  memory: 16.67GiB(35.09%)  tps: 10,119  tflops: 77.07  mfu: 24.70%
[rank1]:2025-11-04 00:25:18,374 - INFO -  step: 1700  loss: -2.0000  grad_norm:  0.0000  memory: 15.07GiB(31.72%)  tps: 10,119  tflops: 77.07  mfu: 24.70%
[rank2]:2025-11-04 00:25:18,372 - INFO -  step: 1700  loss: -2.0000  grad_norm:  0.0000  memory: 12.14GiB(25.55%)  tps: 10,119  tflops: 77.07  mfu: 24.70%
[rank2]:2025-11-04 00:25:18,428 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251104_0025_stage2_step1700.svg
[rank3]:2025-11-04 00:25:18,374 - INFO -  step: 1700  loss:  0.2341  grad_norm:  0.0000  memory: 31.41GiB(66.13%)  tps: 10,120  tflops: 77.08  mfu: 24.70%
[rank0]:2025-11-04 00:25:18,427 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251104_0025_stage0_step1700.svg
[rank1]:2025-11-04 00:25:18,430 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251104_0025_stage1_step1700.svg
[rank3]:2025-11-04 00:25:18,527 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule/251104_0025_real_step1700_rank3.svg
[rank3]:> Batch Time: 392.75 ms, GPU Bubble Ratio: 81.28%, 56.49%, 66.36%, 29.74%
[rank3]:2025-11-04 00:25:18,576 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251104_0025_stage3_step1700.svg
[rank0]:2025-11-04 00:25:58,237 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-04 00:25:59,046 - INFO -  step: 1750  loss: -2.0000  grad_norm:  0.0000  memory: 16.67GiB(35.09%)  tps: 10,071  tflops: 76.70  mfu: 24.58%
[rank1]:2025-11-04 00:25:59,047 - INFO -  step: 1750  loss: -2.0000  grad_norm:  0.0000  memory: 15.07GiB(31.72%)  tps: 10,071  tflops: 76.70  mfu: 24.58%
[rank2]:2025-11-04 00:25:59,044 - INFO -  step: 1750  loss: -2.0000  grad_norm:  0.0000  memory: 12.14GiB(25.55%)  tps: 10,071  tflops: 76.70  mfu: 24.58%
[rank3]:2025-11-04 00:25:59,047 - INFO -  step: 1750  loss:  0.1888  grad_norm:  0.0000  memory: 31.41GiB(66.13%)  tps: 10,071  tflops: 76.71  mfu: 24.58%
[rank0]:2025-11-04 00:26:38,764 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-04 00:26:39,612 - INFO - Avg. fwd time: 8.9975 / Avg. bwd time: 4.3036 / Avg. batch time: 429.7851 (ms) / GPU bubble ratio: 75.24%
[rank0]:2025-11-04 00:26:39,614 - INFO -  step: 1800  loss: -2.0000  grad_norm:  0.0000  memory: 16.67GiB(35.09%)  tps: 10,097  tflops: 76.90  mfu: 24.65%
[rank0]:2025-11-04 00:26:39,614 - INFO - ðŸ”Ž  Running validation at step 1800
[rank1]:2025-11-04 00:26:39,602 - INFO - Avg. fwd time: 10.5274 / Avg. bwd time: 12.7254 / Avg. batch time: 412.0946 (ms) / GPU bubble ratio: 54.86%
[rank1]:2025-11-04 00:26:39,613 - INFO -  step: 1800  loss: -2.0000  grad_norm:  0.0000  memory: 15.07GiB(31.72%)  tps: 10,097  tflops: 76.90  mfu: 24.65%
[rank1]:2025-11-04 00:26:39,613 - INFO - ðŸ”Ž  Running validation at step 1800
[rank2]:2025-11-04 00:26:39,580 - INFO - Avg. fwd time: 8.1681 / Avg. bwd time: 9.8344 / Avg. batch time: 384.8871 (ms) / GPU bubble ratio: 62.58%
[rank2]:2025-11-04 00:26:39,613 - INFO -  step: 1800  loss: -2.0000  grad_norm:  0.0000  memory: 12.14GiB(25.55%)  tps: 10,097  tflops: 76.90  mfu: 24.65%
[rank2]:2025-11-04 00:26:39,613 - INFO - ðŸ”Ž  Running validation at step 1800
[rank3]:2025-11-04 00:26:39,562 - INFO - Avg. fwd time: 12.9864 / Avg. bwd time: 24.6991 / Avg. batch time: 361.1630 (ms) / GPU bubble ratio: 16.52%
[rank3]:2025-11-04 00:26:39,615 - INFO -  step: 1800  loss:  0.1634  grad_norm:  0.0000  memory: 31.41GiB(66.13%)  tps: 10,097  tflops: 76.90  mfu: 24.65%
[rank3]:2025-11-04 00:26:39,615 - INFO - ðŸ”Ž  Running validation at step 1800
[rank0]:2025-11-04 00:27:00,931 - INFO - validate step: 1800  loss: -1.0000  memory: 16.67GiB(35.09%)  tps: 19,216
[rank1]:2025-11-04 00:27:00,957 - INFO - validate step: 1800  loss: -1.0000  memory: 15.07GiB(31.72%)  tps: 19,191
[rank2]:2025-11-04 00:27:00,970 - INFO - validate step: 1800  loss: -1.0000  memory: 12.14GiB(25.55%)  tps: 19,179
[rank3]:2025-11-04 00:27:00,962 - INFO - validate step: 1800  loss:  0.9539  memory: 31.41GiB(66.13%)  tps: 19,189
[rank0]:2025-11-04 00:27:01,024 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251104_0027_stage0_step1800.svg
[rank1]:2025-11-04 00:27:01,030 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251104_0027_stage1_step1800.svg
[rank2]:2025-11-04 00:27:01,024 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251104_0027_stage2_step1800.svg
[rank3]:2025-11-04 00:27:01,121 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule/251104_0027_real_step1800_rank3.svg
[rank3]:> Batch Time: 393.00 ms, GPU Bubble Ratio: 81.29%, 56.52%, 66.38%, 29.77%
[rank3]:2025-11-04 00:27:01,170 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251104_0027_stage3_step1800.svg
[rank0]:2025-11-04 00:27:40,925 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-11-04 00:27:41,744 - INFO -  step: 1850  loss: -2.0000  grad_norm:  0.0000  memory: 16.67GiB(35.09%)  tps: 10,036  tflops: 76.44  mfu: 24.50%
[rank1]:2025-11-04 00:27:41,744 - INFO -  step: 1850  loss: -2.0000  grad_norm:  0.0000  memory: 15.07GiB(31.72%)  tps: 10,043  tflops: 76.49  mfu: 24.51%
[rank3]:2025-11-04 00:27:41,744 - INFO -  step: 1850  loss:  0.2648  grad_norm:  0.0000  memory: 31.41GiB(66.13%)  tps: 10,044  tflops: 76.50  mfu: 24.52%
[rank2]:2025-11-04 00:27:41,742 - INFO -  step: 1850  loss: -2.0000  grad_norm:  0.0000  memory: 12.14GiB(25.55%)  tps: 10,046  tflops: 76.51  mfu: 24.52%
[rank0]:2025-11-04 00:28:21,470 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-04 00:28:21,929 - INFO - Avg. fwd time: 9.0067 / Avg. bwd time: 4.0987 / Avg. batch time: 428.0571 (ms) / GPU bubble ratio: 75.51%
[rank3]:2025-11-04 00:28:22,112 - INFO - Avg. fwd time: 13.0100 / Avg. bwd time: 24.5244 / Avg. batch time: 359.9531 (ms) / GPU bubble ratio: 16.58%
[rank2]:2025-11-04 00:28:22,147 - INFO - Avg. fwd time: 8.1812 / Avg. bwd time: 9.7511 / Avg. batch time: 383.5294 (ms) / GPU bubble ratio: 62.60%
[rank1]:2025-11-04 00:28:22,194 - INFO - Avg. fwd time: 10.5438 / Avg. bwd time: 12.6192 / Avg. batch time: 410.6189 (ms) / GPU bubble ratio: 54.87%
[rank1]:2025-11-04 00:28:22,275 - INFO -  step: 1900  loss: -2.0000  grad_norm:  0.0000  memory: 15.07GiB(31.72%)  tps: 10,106  tflops: 76.97  mfu: 24.67%
[rank3]:2025-11-04 00:28:22,275 - INFO -  step: 1900  loss:  0.1542  grad_norm:  0.0000  memory: 31.41GiB(66.13%)  tps: 10,107  tflops: 76.97  mfu: 24.67%
[rank2]:2025-11-04 00:28:22,273 - INFO -  step: 1900  loss: -2.0000  grad_norm:  0.0000  memory: 12.14GiB(25.55%)  tps: 10,106  tflops: 76.97  mfu: 24.67%
[rank0]:2025-11-04 00:28:22,275 - INFO -  step: 1900  loss: -2.0000  grad_norm:  0.0000  memory: 16.67GiB(35.09%)  tps: 10,106  tflops: 76.97  mfu: 24.67%
[rank0]:2025-11-04 00:28:22,328 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251104_0028_stage0_step1900.svg
[rank1]:2025-11-04 00:28:22,331 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251104_0028_stage1_step1900.svg
[rank2]:2025-11-04 00:28:22,328 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251104_0028_stage2_step1900.svg
[rank3]:2025-11-04 00:28:22,426 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule/251104_0028_real_step1900_rank3.svg
[rank3]:> Batch Time: 392.50 ms, GPU Bubble Ratio: 81.28%, 56.48%, 66.35%, 29.66%
[rank3]:2025-11-04 00:28:22,474 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251104_0028_stage3_step1900.svg
[rank0]:2025-11-04 00:29:02,139 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-04 00:29:02,962 - INFO -  step: 1950  loss: -2.0000  grad_norm:  0.0000  memory: 16.67GiB(35.09%)  tps: 10,067  tflops: 76.67  mfu: 24.57%
[rank1]:2025-11-04 00:29:02,961 - INFO -  step: 1950  loss: -2.0000  grad_norm:  0.0000  memory: 15.07GiB(31.72%)  tps: 10,068  tflops: 76.68  mfu: 24.58%
[rank3]:2025-11-04 00:29:02,963 - INFO -  step: 1950  loss:  0.1605  grad_norm:  0.0000  memory: 31.41GiB(66.13%)  tps: 10,068  tflops: 76.68  mfu: 24.58%
[rank2]:2025-11-04 00:29:02,960 - INFO -  step: 1950  loss: -2.0000  grad_norm:  0.0000  memory: 12.14GiB(25.55%)  tps: 10,067  tflops: 76.67  mfu: 24.57%
[rank0]:2025-11-04 00:29:42,692 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-04 00:29:43,158 - INFO - Avg. fwd time: 9.0158 / Avg. bwd time: 3.8831 / Avg. batch time: 426.2271 (ms) / GPU bubble ratio: 75.79%
[rank3]:2025-11-04 00:29:43,344 - INFO - Avg. fwd time: 13.0349 / Avg. bwd time: 24.3401 / Avg. batch time: 358.6747 (ms) / GPU bubble ratio: 16.64%
[rank2]:2025-11-04 00:29:43,380 - INFO - Avg. fwd time: 8.1950 / Avg. bwd time: 9.6634 / Avg. batch time: 382.0915 (ms) / GPU bubble ratio: 62.61%
[rank1]:2025-11-04 00:29:43,427 - INFO - Avg. fwd time: 10.5609 / Avg. bwd time: 12.5075 / Avg. batch time: 409.0567 (ms) / GPU bubble ratio: 54.88%
[rank2]:2025-11-04 00:29:43,508 - INFO -  step: 2000  loss: -2.0000  grad_norm:  0.0000  memory: 12.14GiB(25.55%)  tps: 10,102  tflops: 76.94  mfu: 24.66%
[rank2]:2025-11-04 00:29:43,508 - INFO - ðŸ”Ž  Running validation at step 2000
[rank0]:2025-11-04 00:29:43,509 - INFO -  step: 2000  loss: -2.0000  grad_norm:  0.0000  memory: 16.67GiB(35.09%)  tps: 10,102  tflops: 76.94  mfu: 24.66%
[rank0]:2025-11-04 00:29:43,510 - INFO - ðŸ”Ž  Running validation at step 2000
[rank1]:2025-11-04 00:29:43,510 - INFO -  step: 2000  loss: -2.0000  grad_norm:  0.0000  memory: 15.07GiB(31.72%)  tps: 10,101  tflops: 76.93  mfu: 24.66%
[rank1]:2025-11-04 00:29:43,510 - INFO - ðŸ”Ž  Running validation at step 2000
[rank3]:2025-11-04 00:29:43,510 - INFO -  step: 2000  loss:  0.2316  grad_norm:  0.0000  memory: 31.41GiB(66.13%)  tps: 10,102  tflops: 76.94  mfu: 24.66%
[rank3]:2025-11-04 00:29:43,510 - INFO - ðŸ”Ž  Running validation at step 2000
[rank0]:2025-11-04 00:30:04,757 - INFO - validate step: 2000  loss: -1.0000  memory: 16.67GiB(35.09%)  tps: 19,278
[rank1]:2025-11-04 00:30:04,784 - INFO - validate step: 2000  loss: -1.0000  memory: 15.07GiB(31.72%)  tps: 19,254
[rank2]:2025-11-04 00:30:04,797 - INFO - validate step: 2000  loss: -1.0000  memory: 12.14GiB(25.55%)  tps: 19,241
[rank3]:2025-11-04 00:30:04,790 - INFO - validate step: 2000  loss:  0.9530  memory: 31.41GiB(66.13%)  tps: 19,250
[rank0]:2025-11-04 00:30:04,852 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251104_0030_stage0_step2000.svg
[rank1]:2025-11-04 00:30:04,865 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251104_0030_stage1_step2000.svg
[rank2]:2025-11-04 00:30:04,852 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251104_0030_stage2_step2000.svg
[rank3]:2025-11-04 00:30:04,958 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule/251104_0030_real_step2000_rank3.svg
[rank3]:> Batch Time: 391.75 ms, GPU Bubble Ratio: 81.27%, 56.40%, 66.30%, 29.62%
[rank3]:2025-11-04 00:30:05,009 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251104_0030_stage3_step2000.svg
[rank0]:2025-11-04 00:30:44,677 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-11-04 00:30:45,481 - INFO -  step: 2050  loss: -2.0000  grad_norm:  0.0000  memory: 15.07GiB(31.72%)  tps: 10,065  tflops: 76.66  mfu: 24.57%
[rank2]:2025-11-04 00:30:45,479 - INFO -  step: 2050  loss: -2.0000  grad_norm:  0.0000  memory: 12.14GiB(25.55%)  tps: 10,068  tflops: 76.68  mfu: 24.58%
[rank3]:2025-11-04 00:30:45,482 - INFO -  step: 2050  loss:  0.2173  grad_norm:  0.0000  memory: 31.41GiB(66.13%)  tps: 10,067  tflops: 76.67  mfu: 24.57%
[rank0]:2025-11-04 00:30:45,481 - INFO -  step: 2050  loss: -2.0000  grad_norm:  0.0000  memory: 16.67GiB(35.09%)  tps: 10,058  tflops: 76.60  mfu: 24.55%
[rank0]:2025-11-04 00:31:25,169 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-04 00:31:26,002 - INFO - Avg. fwd time: 10.5758 / Avg. bwd time: 12.4064 / Avg. batch time: 407.6326 (ms) / GPU bubble ratio: 54.90%
[rank1]:2025-11-04 00:31:26,014 - INFO -  step: 2100  loss: -2.0000  grad_norm:  0.0000  memory: 15.07GiB(31.72%)  tps: 10,105  tflops: 76.96  mfu: 24.67%
[rank2]:2025-11-04 00:31:25,979 - INFO - Avg. fwd time: 8.2071 / Avg. bwd time: 9.5841 / Avg. batch time: 380.7776 (ms) / GPU bubble ratio: 62.62%
[rank2]:2025-11-04 00:31:26,014 - INFO -  step: 2100  loss: -2.0000  grad_norm:  0.0000  memory: 12.14GiB(25.55%)  tps: 10,105  tflops: 76.96  mfu: 24.67%
[rank3]:2025-11-04 00:31:25,959 - INFO - Avg. fwd time: 13.0563 / Avg. bwd time: 24.1723 / Avg. batch time: 357.5025 (ms) / GPU bubble ratio: 16.69%
[rank3]:2025-11-04 00:31:26,016 - INFO -  step: 2100  loss:  0.2652  grad_norm:  0.0000  memory: 31.41GiB(66.13%)  tps: 10,106  tflops: 76.97  mfu: 24.67%
[rank0]:2025-11-04 00:31:26,013 - INFO - Avg. fwd time: 9.0239 / Avg. bwd time: 3.6891 / Avg. batch time: 424.5653 (ms) / GPU bubble ratio: 76.05%
[rank0]:2025-11-04 00:31:26,016 - INFO -  step: 2100  loss: -2.0000  grad_norm:  0.0000  memory: 16.67GiB(35.09%)  tps: 10,105  tflops: 76.96  mfu: 24.67%
[rank0]:2025-11-04 00:31:26,065 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251104_0031_stage0_step2100.svg
[rank1]:2025-11-04 00:31:26,067 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251104_0031_stage1_step2100.svg
[rank2]:2025-11-04 00:31:26,065 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251104_0031_stage2_step2100.svg
[rank3]:2025-11-04 00:31:26,169 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule/251104_0031_real_step2100_rank3.svg
[rank3]:> Batch Time: 391.75 ms, GPU Bubble Ratio: 81.25%, 56.49%, 66.32%, 29.83%
[rank3]:2025-11-04 00:31:26,213 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251104_0031_stage3_step2100.svg
[rank0]:2025-11-04 00:32:05,780 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-04 00:32:06,589 - INFO -  step: 2150  loss: -2.0000  grad_norm:  0.0000  memory: 15.07GiB(31.72%)  tps: 10,095  tflops: 76.89  mfu: 24.64%
[rank2]:2025-11-04 00:32:06,587 - INFO -  step: 2150  loss: -2.0000  grad_norm:  0.0000  memory: 12.14GiB(25.55%)  tps: 10,095  tflops: 76.89  mfu: 24.64%
[rank3]:2025-11-04 00:32:06,589 - INFO -  step: 2150  loss:  0.2408  grad_norm:  0.0000  memory: 31.41GiB(66.13%)  tps: 10,096  tflops: 76.89  mfu: 24.64%
[rank0]:2025-11-04 00:32:06,589 - INFO -  step: 2150  loss: -2.0000  grad_norm:  0.0000  memory: 16.67GiB(35.09%)  tps: 10,095  tflops: 76.89  mfu: 24.64%
[rank0]:2025-11-04 00:32:46,268 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-04 00:32:46,732 - INFO - Avg. fwd time: 9.0298 / Avg. bwd time: 3.5375 / Avg. batch time: 423.2554 (ms) / GPU bubble ratio: 76.25%
[rank2]:2025-11-04 00:32:46,954 - INFO - Avg. fwd time: 8.2163 / Avg. bwd time: 9.5221 / Avg. batch time: 379.7444 (ms) / GPU bubble ratio: 62.63%
[rank3]:2025-11-04 00:32:46,917 - INFO - Avg. fwd time: 13.0727 / Avg. bwd time: 24.0409 / Avg. batch time: 356.5791 (ms) / GPU bubble ratio: 16.73%
[rank1]:2025-11-04 00:32:46,999 - INFO - Avg. fwd time: 10.5874 / Avg. bwd time: 12.3275 / Avg. batch time: 406.5115 (ms) / GPU bubble ratio: 54.90%
[rank0]:2025-11-04 00:32:47,083 - INFO -  step: 2200  loss: -2.0000  grad_norm:  0.0000  memory: 16.67GiB(35.09%)  tps: 10,115  tflops: 77.04  mfu: 24.69%
[rank0]:2025-11-04 00:32:47,083 - INFO - ðŸ”Ž  Running validation at step 2200
[rank1]:2025-11-04 00:32:47,083 - INFO -  step: 2200  loss: -2.0000  grad_norm:  0.0000  memory: 15.07GiB(31.72%)  tps: 10,115  tflops: 77.04  mfu: 24.69%
[rank1]:2025-11-04 00:32:47,083 - INFO - ðŸ”Ž  Running validation at step 2200
[rank2]:2025-11-04 00:32:47,082 - INFO -  step: 2200  loss: -2.0000  grad_norm:  0.0000  memory: 12.14GiB(25.55%)  tps: 10,115  tflops: 77.04  mfu: 24.69%
[rank2]:2025-11-04 00:32:47,082 - INFO - ðŸ”Ž  Running validation at step 2200
[rank3]:2025-11-04 00:32:47,083 - INFO -  step: 2200  loss:  0.2572  grad_norm:  0.0000  memory: 31.41GiB(66.13%)  tps: 10,116  tflops: 77.04  mfu: 24.69%
[rank3]:2025-11-04 00:32:47,084 - INFO - ðŸ”Ž  Running validation at step 2200
[rank0]:2025-11-04 00:33:08,174 - INFO - validate step: 2200  loss: -1.0000  memory: 16.67GiB(35.09%)  tps: 19,422
[rank1]:2025-11-04 00:33:08,197 - INFO - validate step: 2200  loss: -1.0000  memory: 15.07GiB(31.72%)  tps: 19,400
[rank1]:2025-11-04 00:33:08,265 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251104_0033_stage1_step2200.svg
[rank2]:2025-11-04 00:33:08,216 - INFO - validate step: 2200  loss: -1.0000  memory: 12.14GiB(25.55%)  tps: 19,381
[rank2]:2025-11-04 00:33:08,265 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251104_0033_stage2_step2200.svg
[rank3]:2025-11-04 00:33:08,206 - INFO - validate step: 2200  loss:  0.9543  memory: 31.41GiB(66.13%)  tps: 19,393
[rank0]:2025-11-04 00:33:08,265 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251104_0033_stage0_step2200.svg
[rank3]:2025-11-04 00:33:08,363 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule/251104_0033_real_step2200_rank3.svg
[rank3]:> Batch Time: 391.75 ms, GPU Bubble Ratio: 81.27%, 56.43%, 66.31%, 29.68%
[rank3]:2025-11-04 00:33:08,406 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251104_0033_stage3_step2200.svg
[rank0]:2025-11-04 00:33:48,038 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-11-04 00:33:48,855 - INFO -  step: 2250  loss: -2.0000  grad_norm:  0.0000  memory: 12.14GiB(25.55%)  tps: 10,079  tflops: 76.76  mfu: 24.60%
[rank3]:2025-11-04 00:33:48,857 - INFO -  step: 2250  loss:  0.2411  grad_norm:  0.0000  memory: 31.41GiB(66.13%)  tps: 10,077  tflops: 76.75  mfu: 24.60%
[rank0]:2025-11-04 00:33:48,857 - INFO -  step: 2250  loss: -2.0000  grad_norm:  0.0000  memory: 16.67GiB(35.09%)  tps: 10,068  tflops: 76.68  mfu: 24.58%
[rank1]:2025-11-04 00:33:48,855 - INFO -  step: 2250  loss: -2.0000  grad_norm:  0.0000  memory: 15.07GiB(31.72%)  tps: 10,074  tflops: 76.73  mfu: 24.59%
[rank0]:2025-11-04 00:34:28,576 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-04 00:34:29,034 - INFO - Avg. fwd time: 9.0364 / Avg. bwd time: 3.3758 / Avg. batch time: 421.8647 (ms) / GPU bubble ratio: 76.46%
[rank3]:2025-11-04 00:34:29,218 - INFO - Avg. fwd time: 13.0908 / Avg. bwd time: 23.9016 / Avg. batch time: 355.6071 (ms) / GPU bubble ratio: 16.78%
[rank1]:2025-11-04 00:34:29,299 - INFO - Avg. fwd time: 10.6000 / Avg. bwd time: 12.2435 / Avg. batch time: 405.3222 (ms) / GPU bubble ratio: 54.91%
[rank2]:2025-11-04 00:34:29,254 - INFO - Avg. fwd time: 8.2265 / Avg. bwd time: 9.4560 / Avg. batch time: 378.6488 (ms) / GPU bubble ratio: 62.64%
[rank1]:2025-11-04 00:34:29,380 - INFO -  step: 2300  loss: -2.0000  grad_norm:  0.0000  memory: 15.07GiB(31.72%)  tps: 10,108  tflops: 76.98  mfu: 24.67%
[rank3]:2025-11-04 00:34:29,379 - INFO -  step: 2300  loss:  0.2345  grad_norm:  0.0000  memory: 31.41GiB(66.13%)  tps: 10,108  tflops: 76.99  mfu: 24.68%
[rank2]:2025-11-04 00:34:29,378 - INFO -  step: 2300  loss: -2.0000  grad_norm:  0.0000  memory: 12.14GiB(25.55%)  tps: 10,108  tflops: 76.98  mfu: 24.67%
[rank0]:2025-11-04 00:34:29,380 - INFO -  step: 2300  loss: -2.0000  grad_norm:  0.0000  memory: 16.67GiB(35.09%)  tps: 10,108  tflops: 76.98  mfu: 24.67%
[rank0]:2025-11-04 00:34:29,428 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251104_0034_stage0_step2300.svg
[rank1]:2025-11-04 00:34:29,429 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251104_0034_stage1_step2300.svg
[rank2]:2025-11-04 00:34:29,428 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251104_0034_stage2_step2300.svg
[rank3]:2025-11-04 00:34:29,527 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule/251104_0034_real_step2300_rank3.svg
[rank3]:> Batch Time: 391.75 ms, GPU Bubble Ratio: 81.26%, 56.36%, 66.28%, 29.60%
[rank3]:2025-11-04 00:34:29,571 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251104_0034_stage3_step2300.svg
[rank0]:2025-11-04 00:35:09,189 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-04 00:35:09,999 - INFO -  step: 2350  loss: -2.0000  grad_norm:  0.0000  memory: 15.07GiB(31.72%)  tps: 10,084  tflops: 76.80  mfu: 24.62%
[rank3]:2025-11-04 00:35:09,998 - INFO -  step: 2350  loss:  0.2369  grad_norm:  0.0000  memory: 31.41GiB(66.13%)  tps: 10,084  tflops: 76.81  mfu: 24.62%
[rank2]:2025-11-04 00:35:09,997 - INFO -  step: 2350  loss: -2.0000  grad_norm:  0.0000  memory: 12.14GiB(25.55%)  tps: 10,084  tflops: 76.80  mfu: 24.62%
[rank0]:2025-11-04 00:35:09,998 - INFO -  step: 2350  loss: -2.0000  grad_norm:  0.0000  memory: 16.67GiB(35.09%)  tps: 10,084  tflops: 76.80  mfu: 24.62%
[rank0]:2025-11-04 00:35:49,707 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 00:35:50,505 - INFO - Avg. fwd time: 13.1079 / Avg. bwd time: 23.7757 / Avg. batch time: 354.7351 (ms) / GPU bubble ratio: 16.82%
[rank2]:2025-11-04 00:35:50,525 - INFO - Avg. fwd time: 8.2361 / Avg. bwd time: 9.3961 / Avg. batch time: 377.6659 (ms) / GPU bubble ratio: 62.65%
[rank1]:2025-11-04 00:35:50,547 - INFO - Avg. fwd time: 10.6121 / Avg. bwd time: 12.1673 / Avg. batch time: 404.2556 (ms) / GPU bubble ratio: 54.92%
[rank1]:2025-11-04 00:35:50,559 - INFO -  step: 2400  loss: -2.0000  grad_norm:  0.0000  memory: 15.07GiB(31.72%)  tps: 10,099  tflops: 76.91  mfu: 24.65%
[rank1]:2025-11-04 00:35:50,559 - INFO -  final step: 2400  loss: -2.0000  grad_norm:  0.0000  tps: 9,411  tflops: 71.68  mfu: 22.75%
[rank1]:2025-11-04 00:35:50,559 - INFO - ðŸ”Ž  Running validation at step 2400
[rank0]:2025-11-04 00:35:50,558 - INFO - Avg. fwd time: 9.0425 / Avg. bwd time: 3.2282 / Avg. batch time: 420.6142 (ms) / GPU bubble ratio: 76.66%
[rank0]:2025-11-04 00:35:50,560 - INFO -  step: 2400  loss: -2.0000  grad_norm:  0.0000  memory: 16.67GiB(35.09%)  tps: 10,098  tflops: 76.91  mfu: 24.65%
[rank0]:2025-11-04 00:35:50,560 - INFO -  final step: 2400  loss: -2.0000  grad_norm:  0.0000  tps: 9,412  tflops: 71.69  mfu: 22.75%
[rank0]:2025-11-04 00:35:50,561 - INFO - ðŸ”Ž  Running validation at step 2400
[rank3]:2025-11-04 00:35:50,560 - INFO -  step: 2400  loss:  0.2414  grad_norm:  0.0000  memory: 31.41GiB(66.13%)  tps: 10,099  tflops: 76.91  mfu: 24.65%
[rank3]:2025-11-04 00:35:50,561 - INFO -  final step: 2400  loss:  0.2414  grad_norm:  0.0000  tps: 9,422  tflops: 71.76  mfu: 22.75%
[rank3]:2025-11-04 00:35:50,561 - INFO - ðŸ”Ž  Running validation at step 2400
[rank2]:2025-11-04 00:35:50,559 - INFO -  step: 2400  loss: -2.0000  grad_norm:  0.0000  memory: 12.14GiB(25.55%)  tps: 10,098  tflops: 76.91  mfu: 24.65%
[rank2]:2025-11-04 00:35:50,559 - INFO -  final step: 2400  loss: -2.0000  grad_norm:  0.0000  tps: 9,414  tflops: 71.70  mfu: 22.75%
[rank2]:2025-11-04 00:35:50,559 - INFO - ðŸ”Ž  Running validation at step 2400
[rank1]:2025-11-04 00:36:11,884 - INFO - validate step: 2400  loss: -1.0000  memory: 15.07GiB(31.72%)  tps: 19,208
[rank1]:2025-11-04 00:36:11,885 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-11-04 00:36:11,887 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank0]:2025-11-04 00:36:11,861 - INFO - validate step: 2400  loss: -1.0000  memory: 16.67GiB(35.09%)  tps: 19,229
[rank0]:2025-11-04 00:36:11,862 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-04 00:36:11,865 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank3]:2025-11-04 00:36:11,893 - INFO - validate step: 2400  loss:  0.9544  memory: 31.41GiB(66.13%)  tps: 19,202
[rank3]:2025-11-04 00:36:11,895 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-11-04 00:36:11,897 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank2]:2025-11-04 00:36:11,902 - INFO - validate step: 2400  loss: -1.0000  memory: 12.14GiB(25.55%)  tps: 19,192
[rank2]:2025-11-04 00:36:11,902 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-04 00:36:11,904 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank0]:2025-11-04 00:36:14,156 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank1]:2025-11-04 00:36:14,223 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251104_0036_stage1_final2400.svg
[rank0]:2025-11-04 00:36:14,221 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251104_0036_stage0_final2400.svg
[rank2]:2025-11-04 00:36:14,225 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251104_0036_stage2_final2400.svg
[rank3]:2025-11-04 00:36:14,318 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule/251104_0036_real_final2400_rank3.svg
[rank3]:> Batch Time: 393.00 ms, GPU Bubble Ratio: 81.35%, 56.59%, 66.42%, 29.85%
[rank1]:2025-11-04 00:36:14,378 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/frozen_params_histogram/251104_0036_rank1_stage1.svg
[rank1]:	> Counts Sum: 936580, Total Sum: 1526400 (61.36%), Ratio(%) per element: [61.08, 60.96, 61.08, 60.96, 61.61, 61.14, 60.96, 62.14, 62.5, 60.9, 61.37, 60.61, 61.02, 61.14, 61.49, 61.55, 61.14, 60.67, 61.85, 61.85, 60.84, 61.43, 61.26, 61.26, 60.96, 61.49, 61.61, 60.73, 61.2, 61.43, 61.2, 61.79, 61.32, 62.02, 61.73, 62.32, 61.61, 61.26, 60.31, 61.79, 60.73, 61.32, 62.32, 61.43, 61.55]
[rank1]:2025-11-04 00:36:14,378 - INFO - Destroying the purge thread.
[rank0]:2025-11-04 00:36:14,378 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/frozen_params_histogram/251104_0036_rank0_stage0.svg
[rank0]:	> Counts Sum: 829240, Total Sum: 1255040 (66.07%), Ratio(%) per element: [65.68, 65.86, 67.86, 65.56, 65.91, 64.5, 65.74, 65.68, 66.39, 66.45, 65.09, 65.62, 66.8, 67.04, 66.09, 65.97, 64.91, 66.74, 66.68, 65.86, 64.56, 66.62, 65.56, 65.62, 65.74, 66.98, 66.15, 66.98, 67.27, 65.86, 65.5, 64.85, 65.91, 67.27, 65.33, 68.16, 65.74]
[rank0]:2025-11-04 00:36:14,378 - INFO - Sleeping 2 seconds for other ranks to complete
[rank3]:2025-11-04 00:36:14,461 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/pipeline_schedule/251104_0036_thry_final2400_rank3.svg
[rank3]:> Batch Time: 345.20 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank2]:2025-11-04 00:36:14,381 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/frozen_params_histogram/251104_0036_rank2_stage2.svg
[rank2]:	> Counts Sum: 1060560, Total Sum: 1221120 (86.85%), Ratio(%) per element: [86.85, 86.73, 86.91, 86.79, 86.91, 86.85, 86.73, 86.85, 86.79, 86.79, 86.79, 86.85, 86.79, 86.91, 86.85, 86.85, 86.96, 86.91, 86.79, 86.79, 86.79, 86.85, 86.79, 86.85, 86.85, 86.96, 86.91, 86.85, 86.85, 86.91, 86.91, 86.85, 86.85, 86.79, 86.91, 86.96]
[rank2]:2025-11-04 00:36:14,381 - INFO - Destroying the purge thread.
[rank3]:2025-11-04 00:36:14,506 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251104_0036_stage3_final2400.svg
[rank1]:2025-11-04 00:36:14,590 - INFO - Process group destroyed
[rank3]:2025-11-04 00:36:14,644 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1/frozen_params_histogram/251104_0036_rank3_stage3.svg
[rank3]:	> Counts Sum: 204840, Total Sum: 983680 (20.82%), Ratio(%) per element: [21.22, 20.69, 20.81, 20.99, 20.28, 20.99, 20.69, 21.75, 22.58, 20.28, 20.87, 20.57, 20.1, 20.51, 19.92, 20.75, 21.93, 21.28, 20.81, 19.75, 20.16, 21.46, 19.92, 20.81, 20.1, 20.99, 21.69, 21.4, 20.45]
[rank3]:2025-11-04 00:36:14,645 - INFO - Destroying the purge thread.
[rank2]:2025-11-04 00:36:14,613 - INFO - Process group destroyed
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading history steps 48-48, summary, console lines 373-383
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–…â–‡â–…â–†â–ˆâ–â–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–†â–„â–ƒâ–…â–„â–â–ƒâ–ƒâ–…â–„â–ˆâ–„â–ƒâ–…â–ƒâ–â–„â–„â–†â–ƒâ–‡â–…â–…â–„â–„â–„â–ƒâ–…â–„â–‚â–…â–â–â–„â–ƒâ–„â–…â–„â–„â–„
[rank3]:wandb: loss_metrics/global_max_loss â–†â–„â–ƒâ–…â–ƒâ–â–ƒâ–ƒâ–…â–„â–ˆâ–„â–ƒâ–…â–ƒâ–â–„â–„â–†â–ƒâ–‡â–…â–…â–„â–„â–„â–ƒâ–…â–„â–‚â–…â–â–â–„â–ƒâ–„â–…â–„â–„â–„
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 0.86949
[rank3]:wandb:               final/avg_loss 0.2414
[rank3]:wandb:             final/avg_mfu(%) 22.75418
[rank3]:wandb:             final/avg_tflops 71.75721
[rank3]:wandb:    final/avg_throughput(tps) 9421.63885
[rank3]:wandb:              final/grad_norm 0
[rank3]:wandb:               final/max_loss 0.2414
[rank3]:wandb:                    grad_norm 0
[rank3]:wandb: loss_metrics/global_avg_loss 0.2414
[rank3]:wandb: loss_metrics/global_max_loss 0.2414
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1031_GPipe_timelyapf_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/uu8pwxq6
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1031_GPipe_timelyapf_dm1/20251103-2356/wandb/run-20251103_235624-uu8pwxq6/logs
[rank3]:2025-11-04 00:36:16,091 - INFO - Process group destroyed
[rank0]:2025-11-04 00:36:16,378 - INFO - Training completed
[rank0]:2025-11-04 00:36:16,378 - INFO - Destroying the purge thread.
[rank0]:2025-11-04 00:36:16,578 - INFO - Process group destroyed
[rank2]:Stage 2: Modules to keep: {'layers.11', 'layers.12', 'layers.9', 'layers.10'}
[rank1]:Stage 1: Modules to keep: {'layers.7', 'layers.4', 'layers.8', 'layers.5', 'layers.6'}
[rank0]:Stage 0: Modules to keep: {'layers.0', 'layers.3', 'layers.1', 'tok_embeddings', 'layers.2'}
[rank3]:Stage 3: Modules to keep: {'norm', 'layers.15', 'output', 'layers.13', 'layers.14'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1029_llama1b/config_1031.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
[rank3]:+ more freezing in autofreeze mode. 
[rank3]:+ lr_scheduler min_lr = 0 -> 1e-6, cosine decay.
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1031_GPipe_timelyapf_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1031_GPipe_timelyapf_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1031_GPipe_timelyapf_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1031_GPipe_timelyapf_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1031_GPipe_timelyapf_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1031_GPipe_timelyapf_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B-Instruct
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 1e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 300
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: alpaca
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 512
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 2400
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: GPipe
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 4
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1031_GPipe_timelyapf_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B-Instruct/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1031_GPipe_timelyapf_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: True
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: timelyapf
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- threshold: 0.05
[rank3]:		- percentile: 70
[rank3]:
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
