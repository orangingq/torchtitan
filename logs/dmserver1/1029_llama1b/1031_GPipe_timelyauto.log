
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 11. 02. (ì¼) 00:58:39 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 3,4,5,6
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1029_llama1b/run_1031.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1029_llama1b/1031_GPipe_timelyauto.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
+ more freezing in autofreeze mode. 
+ lr_scheduler min_lr = 0 -> 1e-6, cosine decay.

âœ”ï¸Running with timelyauto x GPipe ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1029_llama1b/config_1031.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
+ more freezing in autofreeze mode. 
+ lr_scheduler min_lr = 0 -> 1e-6, cosine decay.
" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=timelyauto
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank3]:2025-11-02 00:58:45,608 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
[rank3]:+ more freezing in autofreeze mode. 
[rank3]:+ lr_scheduler min_lr = 0 -> 1e-6, cosine decay.
[rank3]:"
[rank2]:2025-11-02 00:58:45,608 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
[rank2]:+ more freezing in autofreeze mode. 
[rank2]:+ lr_scheduler min_lr = 0 -> 1e-6, cosine decay.
[rank2]:"
[rank1]:2025-11-02 00:58:45,721 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
[rank1]:+ more freezing in autofreeze mode. 
[rank1]:+ lr_scheduler min_lr = 0 -> 1e-6, cosine decay.
[rank1]:"
[rank0]:2025-11-02 00:58:45,881 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
[rank0]:+ more freezing in autofreeze mode. 
[rank0]:+ lr_scheduler min_lr = 0 -> 1e-6, cosine decay.
[rank0]:"
[rank0]:2025-11-02 00:58:46,388 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-11-02 00:58:46,391 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-02 00:58:46,395 - INFO - [GC] Initial GC collection 0.00 seconds
[rank1]:2025-11-02 00:58:46,411 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-11-02 00:58:46,413 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-11-02 00:58:46,361 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-11-02 00:58:46,364 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-11-02 00:58:46,426 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-11-02 00:58:46,428 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-02 00:58:46,771 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-11-02 00:58:47,181 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank2]:2025-11-02 00:58:50,053 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-11-02 00:58:50,092 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-11-02 00:58:50,118 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-11-02 00:58:50,118 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-11-02 00:58:50,262 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=512, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank2]:2025-11-02 00:58:50,292 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-11-02 00:58:50,293 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-11-02 00:58:50,293 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank0]:2025-11-02 00:58:50,409 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-11-02 00:58:50,446 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-02 00:58:50,447 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-11-02 00:58:50,473 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-11-02 00:58:50,473 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank1]:2025-11-02 00:58:50,603 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-11-02 00:58:50,649 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-11-02 00:58:50,649 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-11-02 00:58:50,649 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank1]:2025-11-02 00:58:50,648 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-11-02 00:58:50,675 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-11-02 00:58:50,675 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2025-11-02 00:58:50,863 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-11-02 00:58:50,863 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-11-02 00:58:50,864 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run h6jpsja6
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1031_GPipe_timelyauto_dm1/20251102-0058/wandb/run-20251102_005851-h6jpsja6
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1031_GPipe_timelyauto_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/h6jpsja6
[rank3]:2025-11-02 00:58:52,289 - INFO - WandB logging enabled
[rank3]:2025-11-02 00:58:52,290 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-11-02 00:58:52,331 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-11-02 00:58:52,360 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-11-02 00:58:52,361 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-11-02 00:58:52,567 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1031_GPipe_timelyauto_dm1
[rank0]:2025-11-02 00:58:52,567 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-02 00:58:52,568 - INFO - Preparing c4_validation dataset from allenai/c4
[rank2]:2025-11-02 00:58:52,567 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-11-02 00:58:52,550 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-11-02 00:58:52,551 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-11-02 00:58:52,552 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2025-11-02 00:58:52,567 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank1]:2025-11-02 00:58:52,568 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-02 00:58:58,234 - INFO - Trainer is initialized with local batch size 32, global batch size 64, gradient accumulation steps 2, sequence length 512, total steps 2400 (warmup 300)
[rank0]:2025-11-02 00:58:58,234 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B-Instruct/original_dcp.
[rank0]:2025-11-02 00:59:01,719 - INFO - [GC] GC collection for checkpoint loading. 0.01 seconds
[rank0]:2025-11-02 00:59:01,719 - INFO - Finished loading the checkpoint in 3.49 seconds.
[rank0]:2025-11-02 00:59:01,719 - INFO - Training starts at step 1
[rank3]:2025-11-02 00:59:05,077 - INFO -  step:  1  loss:  9.0164  grad_norm: 85.2012  memory: 23.19GiB(48.82%)  tps: 643  tflops: 4.90  mfu: 1.57%
[rank3]:2025-11-02 00:59:05,077 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-11-02 00:59:05,066 - INFO -  step:  1  loss: -2.0000  grad_norm: 85.2012  memory:  9.35GiB(19.67%)  tps: 547  tflops: 4.17  mfu: 1.34%
[rank0]:2025-11-02 00:59:05,106 - INFO -  step:  1  loss: -2.0000  grad_norm: 85.2012  memory: 12.28GiB(25.84%)  tps: 559  tflops: 4.26  mfu: 1.36%
[rank2]:2025-11-02 00:59:05,066 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-02 00:59:05,106 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-11-02 00:59:05,073 - INFO -  step:  1  loss: -2.0000  grad_norm: 85.2012  memory: 11.50GiB(24.20%)  tps: 568  tflops: 4.33  mfu: 1.39%
[rank1]:2025-11-02 00:59:05,074 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-02 01:00:04,976 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-02 01:00:06,224 - INFO -  step: 50  loss: -2.0000  grad_norm: 49.4381  memory: 14.64GiB(30.82%)  tps: 6,564  tflops: 49.99  mfu: 16.02%
[rank2]:2025-11-02 01:00:06,221 - INFO -  step: 50  loss: -2.0000  grad_norm: 49.4381  memory: 11.81GiB(24.85%)  tps: 6,564  tflops: 49.99  mfu: 16.02%
[rank3]:2025-11-02 01:00:06,233 - INFO -  step: 50  loss:  9.8015  grad_norm: 49.4381  memory: 27.51GiB(57.90%)  tps: 6,564  tflops: 49.99  mfu: 16.02%
[rank0]:2025-11-02 01:00:06,236 - INFO -  step: 50  loss: -2.0000  grad_norm: 49.4381  memory: 16.57GiB(34.88%)  tps: 6,567  tflops: 50.01  mfu: 16.03%
[rank0]:2025-11-02 01:01:07,160 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 01:01:08,122 - INFO - Avg. fwd time: 10.6978 / Avg. bwd time: 42.7931 / Avg. batch time: 495.1043 (ms) / GPU bubble ratio: 13.57%
[rank2]:2025-11-02 01:01:08,193 - INFO - Avg. fwd time: 6.8855 / Avg. bwd time: 18.1897 / Avg. batch time: 526.1417 (ms) / GPU bubble ratio: 61.87%
[rank1]:2025-11-02 01:01:08,232 - INFO - Avg. fwd time: 9.3377 / Avg. bwd time: 23.4091 / Avg. batch time: 564.8905 (ms) / GPU bubble ratio: 53.62%
[rank0]:2025-11-02 01:01:08,239 - INFO - Avg. fwd time: 8.5823 / Avg. bwd time: 23.5076 / Avg. batch time: 602.2565 (ms) / GPU bubble ratio: 57.37%
[rank1]:2025-11-02 01:01:08,411 - INFO -  step: 100  loss: -2.0000  grad_norm: 31.6938  memory: 14.64GiB(30.82%)  tps: 6,587  tflops: 50.17  mfu: 16.08%
[rank1]:2025-11-02 01:01:08,411 - WARNING - Nothing to draw before the end of warmup.
[rank2]:2025-11-02 01:01:08,407 - INFO -  step: 100  loss: -2.0000  grad_norm: 31.6938  memory: 11.81GiB(24.85%)  tps: 6,587  tflops: 50.17  mfu: 16.08%
[rank2]:2025-11-02 01:01:08,408 - WARNING - Nothing to draw before the end of warmup.
[rank3]:2025-11-02 01:01:08,420 - INFO -  step: 100  loss:  8.5696  grad_norm: 31.6938  memory: 27.51GiB(57.90%)  tps: 6,587  tflops: 50.17  mfu: 16.08%
[rank3]:2025-11-02 01:01:08,420 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-11-02 01:01:08,422 - INFO -  step: 100  loss: -2.0000  grad_norm: 31.6938  memory: 16.57GiB(34.88%)  tps: 6,587  tflops: 50.17  mfu: 16.08%
[rank0]:2025-11-02 01:01:08,422 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-11-02 01:02:09,604 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-02 01:02:10,855 - INFO -  step: 150  loss: -2.0000  grad_norm: 45.9985  memory: 14.64GiB(30.82%)  tps: 6,560  tflops: 49.96  mfu: 16.01%
[rank0]:2025-11-02 01:02:10,865 - INFO -  step: 150  loss: -2.0000  grad_norm: 45.9985  memory: 16.57GiB(34.88%)  tps: 6,560  tflops: 49.96  mfu: 16.01%
[rank2]:2025-11-02 01:02:10,851 - INFO -  step: 150  loss: -2.0000  grad_norm: 45.9985  memory: 11.81GiB(24.85%)  tps: 6,560  tflops: 49.96  mfu: 16.01%
[rank3]:2025-11-02 01:02:10,863 - INFO -  step: 150  loss:  5.0133  grad_norm: 45.9985  memory: 27.51GiB(57.90%)  tps: 6,560  tflops: 49.96  mfu: 16.01%
[rank0]:2025-11-02 01:03:11,783 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 01:03:12,746 - INFO - Avg. fwd time: 10.6843 / Avg. bwd time: 43.0487 / Avg. batch time: 492.9504 (ms) / GPU bubble ratio: 12.80%
[rank0]:2025-11-02 01:03:12,860 - INFO - Avg. fwd time: 8.3031 / Avg. bwd time: 23.5858 / Avg. batch time: 599.0371 (ms) / GPU bubble ratio: 57.41%
[rank1]:2025-11-02 01:03:12,853 - INFO - Avg. fwd time: 9.1332 / Avg. bwd time: 23.5106 / Avg. batch time: 562.0277 (ms) / GPU bubble ratio: 53.53%
[rank2]:2025-11-02 01:03:12,814 - INFO - Avg. fwd time: 6.8825 / Avg. bwd time: 18.2582 / Avg. batch time: 523.5879 (ms) / GPU bubble ratio: 61.59%
[rank0]:2025-11-02 01:03:13,047 - INFO -  step: 200  loss: -2.0000  grad_norm: 39.4403  memory: 16.57GiB(34.88%)  tps: 6,587  tflops: 50.17  mfu: 16.08%
[rank0]:2025-11-02 01:03:13,047 - INFO - ðŸ”Ž  Running validation at step 200
[rank1]:2025-11-02 01:03:13,036 - INFO -  step: 200  loss: -2.0000  grad_norm: 39.4403  memory: 14.64GiB(30.82%)  tps: 6,587  tflops: 50.17  mfu: 16.08%
[rank1]:2025-11-02 01:03:13,036 - INFO - ðŸ”Ž  Running validation at step 200
[rank2]:2025-11-02 01:03:13,032 - INFO -  step: 200  loss: -2.0000  grad_norm: 39.4403  memory: 11.81GiB(24.85%)  tps: 6,587  tflops: 50.17  mfu: 16.08%
[rank2]:2025-11-02 01:03:13,032 - INFO - ðŸ”Ž  Running validation at step 200
[rank3]:2025-11-02 01:03:13,044 - INFO -  step: 200  loss:  1.8357  grad_norm: 39.4403  memory: 27.51GiB(57.90%)  tps: 6,587  tflops: 50.17  mfu: 16.08%
[rank3]:2025-11-02 01:03:13,044 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-11-02 01:03:34,683 - INFO - validate step: 200  loss: -1.0000  memory: 16.57GiB(34.88%)  tps: 18,931
[rank0]:2025-11-02 01:03:34,684 - WARNING - Nothing to draw before the end of warmup.
[rank1]:2025-11-02 01:03:34,700 - INFO - validate step: 200  loss: -1.0000  memory: 14.64GiB(30.82%)  tps: 18,906
[rank1]:2025-11-02 01:03:34,701 - WARNING - Nothing to draw before the end of warmup.
[rank2]:2025-11-02 01:03:34,718 - INFO - validate step: 200  loss: -1.0000  memory: 11.81GiB(24.85%)  tps: 18,888
[rank2]:2025-11-02 01:03:34,718 - WARNING - Nothing to draw before the end of warmup.
[rank3]:2025-11-02 01:03:34,710 - INFO - validate step: 200  loss:  1.5569  memory: 27.51GiB(57.90%)  tps: 18,906
[rank3]:2025-11-02 01:03:34,711 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-11-02 01:04:35,463 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-02 01:04:36,712 - INFO -  step: 250  loss:  0.7106  grad_norm: 73.8462  memory: 27.51GiB(57.90%)  tps: 6,606  tflops: 50.32  mfu: 16.13%
[rank0]:2025-11-02 01:04:36,713 - INFO -  step: 250  loss: -2.0000  grad_norm: 73.8462  memory: 16.57GiB(34.88%)  tps: 6,603  tflops: 50.29  mfu: 16.12%
[rank2]:2025-11-02 01:04:36,698 - INFO -  step: 250  loss: -2.0000  grad_norm: 73.8462  memory: 11.81GiB(24.85%)  tps: 6,609  tflops: 50.33  mfu: 16.13%
[rank1]:2025-11-02 01:04:36,702 - INFO -  step: 250  loss: -2.0000  grad_norm: 73.8462  memory: 14.64GiB(30.82%)  tps: 6,606  tflops: 50.32  mfu: 16.13%
[rank3]:2025-11-02 01:04:48,742 - INFO - [Step 260] ã€°ï¸ Monitoring Upperbound
[rank3]:2025-11-02 01:05:01,309 - WARNING - [Step 270] â³ Monitoring Upperbound... (540/550)
[rank0]:2025-11-02 01:05:01,391 - WARNING - [Step 270] â³ Monitoring Upperbound... (540/550)
[rank2]:2025-11-02 01:05:01,334 - WARNING - [Step 270] â³ Monitoring Upperbound... (540/550)
[rank1]:2025-11-02 01:05:01,362 - WARNING - [Step 270] â³ Monitoring Upperbound... (540/550)
[rank3]:2025-11-02 01:05:13,472 - INFO - [Step 280] âœ”ï¸  Setting Upperbound
[rank3]:2025-11-02 01:05:13,767 - INFO - [Step 280] ã€°ï¸ Monitoring Lowerbound
[rank2]:2025-11-02 01:05:13,827 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-02 01:05:13,836 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-02 01:05:13,820 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-02 01:05:13,836 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-02 01:05:13,848 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-02 01:05:13,877 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-02 01:05:13,825 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-02 01:05:13,838 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-02 01:05:13,849 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-02 01:05:13,859 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-02 01:05:13,868 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-02 01:05:13,847 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-02 01:05:13,861 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-02 01:05:13,898 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-02 01:05:13,934 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-02 01:05:13,860 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-02 01:05:13,875 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-02 01:05:13,906 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-02 01:05:13,913 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-02 01:05:13,950 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-02 01:05:13,996 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-02 01:05:14,017 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-02 01:05:14,035 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-02 01:05:14,034 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-02 01:05:14,058 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-02 01:05:14,098 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-02 01:05:14,059 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-02 01:05:14,101 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-02 01:05:14,076 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-02 01:05:14,118 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-02 01:05:14,140 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-02 01:05:14,158 - WARNING - Batch index 561 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-02 01:05:29,779 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 01:05:30,554 - INFO - Avg. fwd time: 10.8314 / Avg. bwd time: 41.5508 / Avg. batch time: 480.8922 (ms) / GPU bubble ratio: 12.86%
[rank3]:2025-11-02 01:05:30,558 - INFO - [Step 300] âœ”ï¸  Setting Lowerbound
[rank0]:2025-11-02 01:05:30,589 - INFO - Avg. fwd time: 8.2835 / Avg. bwd time: 22.0544 / Avg. batch time: 583.4674 (ms) / GPU bubble ratio: 58.40%
[rank0]:2025-11-02 01:05:30,613 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.06/0.06, [MB5] 1.00/1.00, [MB6] 0.56/0.56, [MB7] 1.00/1.00
[rank0]:2025-11-02 01:05:30,613 - INFO -  step: 300  loss: -2.0000  grad_norm:  0.0000  memory: 16.57GiB(34.88%)  tps: 7,599  tflops: 57.88  mfu: 18.55%
[rank2]:2025-11-02 01:05:30,568 - INFO - Avg. fwd time: 6.9759 / Avg. bwd time: 17.6047 / Avg. batch time: 510.7185 (ms) / GPU bubble ratio: 61.50%
[rank2]:2025-11-02 01:05:30,604 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-02 01:05:30,605 - INFO -  step: 300  loss: -2.0000  grad_norm:  0.0000  memory: 11.81GiB(24.85%)  tps: 7,598  tflops: 57.87  mfu: 18.55%
[rank1]:2025-11-02 01:05:30,584 - INFO - Avg. fwd time: 9.1847 / Avg. bwd time: 22.6801 / Avg. batch time: 548.1644 (ms) / GPU bubble ratio: 53.50%
[rank1]:2025-11-02 01:05:30,605 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.21/0.21, [MB2] 0.00/0.00, [MB3] 0.42/0.42, [MB4] 0.21/0.21, [MB5] 0.21/0.21, [MB6] 0.97/0.97, [MB7] 1.00/1.00
[rank1]:2025-11-02 01:05:30,606 - INFO -  step: 300  loss: -2.0000  grad_norm:  0.0000  memory: 14.64GiB(30.82%)  tps: 7,599  tflops: 57.87  mfu: 18.55%
[rank3]:2025-11-02 01:05:30,803 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/pipeline_schedule/251102_0105_max_batch_time.svg
[rank3]:> Batch Time: 520.90 ms, GPU Bubble Ratio: 51.43%, 50.22%, 61.42%, 18.22%
[rank3]:2025-11-02 01:05:30,991 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/pipeline_schedule/251102_0105_min_batch_time.svg
[rank3]:> Batch Time: 298.32 ms, GPU Bubble Ratio: 78.51%, 48.14%, 60.08%, 15.82%
[rank3]:2025-11-02 01:05:31,199 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/pipeline_schedule/251102_0105_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 327.14 ms, GPU Bubble Ratio: 41.96%, 33.05%, 41.72%, 14.43%
[rank3]:2025-11-02 01:05:31,199 - INFO - 	> Batch Time: 327.14 ms (Average Freeze Ratio: 0.41, Time Reduction Rate: 0.37)
[rank3]:2025-11-02 01:05:31,202 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.40/0.40, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-11-02 01:05:31,204 - INFO -  step: 300  loss:  0.2973  grad_norm:  0.0105  memory: 31.90GiB(67.15%)  tps: 7,517  tflops: 57.25  mfu: 18.35%
[rank0]:2025-11-02 01:05:31,288 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251102_0105_stage0_step300.svg
[rank2]:2025-11-02 01:05:31,289 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251102_0105_stage2_step300.svg
[rank1]:2025-11-02 01:05:31,287 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251102_0105_stage1_step300.svg
[rank3]:2025-11-02 01:05:31,388 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/pipeline_schedule/251102_0105_real_step300_rank3.svg
[rank3]:> Batch Time: 320.53 ms, GPU Bubble Ratio: 77.31%, 46.98%, 58.91%, 14.63%
[rank3]:2025-11-02 01:05:31,456 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251102_0105_stage3_step300.svg
[rank0]:2025-11-02 01:06:19,020 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 01:06:20,100 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.67/1.00
[rank2]:2025-11-02 01:06:20,101 - INFO -  step: 350  loss: -2.0000  grad_norm:  0.4042  memory: 12.14GiB(25.55%)  tps: 8,276  tflops: 63.03  mfu: 20.20%
[rank1]:2025-11-02 01:06:20,101 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.14/0.21, [MB2] 0.00/0.00, [MB3] 0.28/0.42, [MB4] 0.14/0.21, [MB5] 0.14/0.21, [MB6] 0.65/0.97, [MB7] 0.67/1.00
[rank1]:2025-11-02 01:06:20,101 - INFO -  step: 350  loss: -2.0000  grad_norm:  0.4042  memory: 14.88GiB(31.31%)  tps: 8,276  tflops: 63.03  mfu: 20.20%
[rank3]:2025-11-02 01:06:20,116 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.27/0.40, [MB2] 0.67/1.00, [MB3] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank3]:2025-11-02 01:06:20,121 - INFO -  step: 350  loss:  0.1982  grad_norm:  0.4042  memory: 31.90GiB(67.15%)  tps: 8,374  tflops: 63.78  mfu: 20.44%
[rank0]:2025-11-02 01:06:20,115 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.04/0.06, [MB5] 0.67/1.00, [MB6] 0.38/0.56, [MB7] 0.67/1.00
[rank0]:2025-11-02 01:06:20,116 - INFO -  step: 350  loss: -2.0000  grad_norm:  0.4042  memory: 16.63GiB(35.01%)  tps: 8,274  tflops: 63.02  mfu: 20.20%
[rank0]:2025-11-02 01:07:08,567 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-02 01:07:09,131 - INFO - Avg. fwd time: 8.4085 / Avg. bwd time: 19.9317 / Avg. batch time: 557.9776 (ms) / GPU bubble ratio: 59.37%
[rank3]:2025-11-02 01:07:09,281 - INFO - Avg. fwd time: 11.1138 / Avg. bwd time: 38.8500 / Avg. batch time: 460.9914 (ms) / GPU bubble ratio: 13.29%
[rank2]:2025-11-02 01:07:09,356 - INFO - Avg. fwd time: 7.1964 / Avg. bwd time: 16.1556 / Avg. batch time: 489.4397 (ms) / GPU bubble ratio: 61.83%
[rank1]:2025-11-02 01:07:09,402 - INFO - Avg. fwd time: 9.4234 / Avg. bwd time: 20.7777 / Avg. batch time: 524.8910 (ms) / GPU bubble ratio: 53.97%
[rank0]:2025-11-02 01:07:09,549 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.06/0.06, [MB5] 1.00/1.00, [MB6] 0.56/0.56, [MB7] 1.00/1.00
[rank0]:2025-11-02 01:07:09,550 - INFO -  step: 400  loss: -2.0000  grad_norm:  0.1397  memory: 16.79GiB(35.34%)  tps: 8,286  tflops: 63.11  mfu: 20.23%
[rank0]:2025-11-02 01:07:09,550 - INFO - ðŸ”Ž  Running validation at step 400
[rank2]:2025-11-02 01:07:09,549 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-02 01:07:09,549 - INFO -  step: 400  loss: -2.0000  grad_norm:  0.1397  memory: 12.14GiB(25.55%)  tps: 8,283  tflops: 63.09  mfu: 20.22%
[rank2]:2025-11-02 01:07:09,549 - INFO - ðŸ”Ž  Running validation at step 400
[rank1]:2025-11-02 01:07:09,551 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.21/0.21, [MB2] 0.00/0.00, [MB3] 0.42/0.42, [MB4] 0.21/0.21, [MB5] 0.21/0.21, [MB6] 0.97/0.97, [MB7] 1.00/1.00
[rank1]:2025-11-02 01:07:09,551 - INFO -  step: 400  loss: -2.0000  grad_norm:  0.1397  memory: 14.88GiB(31.31%)  tps: 8,283  tflops: 63.09  mfu: 20.22%
[rank1]:2025-11-02 01:07:09,551 - INFO - ðŸ”Ž  Running validation at step 400
[rank3]:2025-11-02 01:07:09,566 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.40/0.40, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-11-02 01:07:09,569 - INFO -  step: 400  loss:  0.2228  grad_norm:  0.1397  memory: 31.90GiB(67.15%)  tps: 8,284  tflops: 63.09  mfu: 20.22%
[rank3]:2025-11-02 01:07:09,569 - INFO - ðŸ”Ž  Running validation at step 400
[rank3]:2025-11-02 01:07:29,664 - INFO - validate step: 400  loss:  0.9415  memory: 31.90GiB(67.15%)  tps: 20,385
[rank0]:2025-11-02 01:07:29,634 - INFO - validate step: 400  loss: -1.0000  memory: 16.79GiB(35.34%)  tps: 20,394
[rank2]:2025-11-02 01:07:29,672 - INFO - validate step: 400  loss: -1.0000  memory: 12.14GiB(25.55%)  tps: 20,355
[rank1]:2025-11-02 01:07:29,653 - INFO - validate step: 400  loss: -1.0000  memory: 14.88GiB(31.31%)  tps: 20,377
[rank0]:2025-11-02 01:07:29,751 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251102_0107_stage0_step400.svg
[rank2]:2025-11-02 01:07:29,752 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251102_0107_stage2_step400.svg
[rank1]:2025-11-02 01:07:29,753 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251102_0107_stage1_step400.svg
[rank3]:2025-11-02 01:07:29,860 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/pipeline_schedule/251102_0107_real_step400_rank3.svg
[rank3]:> Batch Time: 410.34 ms, GPU Bubble Ratio: 69.47%, 54.99%, 65.50%, 14.02%
[rank3]:2025-11-02 01:07:29,934 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251102_0107_stage3_step400.svg
[rank0]:2025-11-02 01:08:09,494 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-11-02 01:08:10,302 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.06/0.06, [MB5] 1.00/1.00, [MB6] 0.56/0.56, [MB7] 1.00/1.00
[rank0]:2025-11-02 01:08:10,302 - INFO -  step: 450  loss: -2.0000  grad_norm:  0.0000  memory: 16.79GiB(35.34%)  tps: 10,072  tflops: 76.71  mfu: 24.59%
[rank3]:2025-11-02 01:08:10,283 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.40/0.40, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-11-02 01:08:10,301 - INFO -  step: 450  loss:  0.2325  grad_norm:  0.0000  memory: 31.90GiB(67.15%)  tps: 10,080  tflops: 76.77  mfu: 24.61%
[rank2]:2025-11-02 01:08:10,284 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-02 01:08:10,300 - INFO -  step: 450  loss: -2.0000  grad_norm:  0.0000  memory: 12.14GiB(25.55%)  tps: 10,082  tflops: 76.78  mfu: 24.61%
[rank1]:2025-11-02 01:08:10,299 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.21/0.21, [MB2] 0.00/0.00, [MB3] 0.42/0.42, [MB4] 0.21/0.21, [MB5] 0.21/0.21, [MB6] 0.97/0.97, [MB7] 1.00/1.00
[rank1]:2025-11-02 01:08:10,300 - INFO -  step: 450  loss: -2.0000  grad_norm:  0.0000  memory: 14.88GiB(31.31%)  tps: 10,077  tflops: 76.75  mfu: 24.60%
[rank0]:2025-11-02 01:08:49,697 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-02 01:08:50,153 - INFO - Avg. fwd time: 8.5604 / Avg. bwd time: 15.7527 / Avg. batch time: 524.0322 (ms) / GPU bubble ratio: 62.88%
[rank3]:2025-11-02 01:08:50,325 - INFO - Avg. fwd time: 11.5522 / Avg. bwd time: 35.2562 / Avg. batch time: 435.3582 (ms) / GPU bubble ratio: 13.99%
[rank2]:2025-11-02 01:08:50,362 - INFO - Avg. fwd time: 7.4537 / Avg. bwd time: 14.4538 / Avg. batch time: 462.1422 (ms) / GPU bubble ratio: 62.08%
[rank1]:2025-11-02 01:08:50,407 - INFO - Avg. fwd time: 9.7183 / Avg. bwd time: 18.6192 / Avg. batch time: 495.3174 (ms) / GPU bubble ratio: 54.23%
[rank1]:2025-11-02 01:08:50,635 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251102_0108_rank1_trend_line.svg
[rank0]:2025-11-02 01:08:50,637 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251102_0108_rank0_trend_line.svg
[rank0]:2025-11-02 01:08:50,644 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-11-02 01:08:50,646 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-11-02 01:08:50,646 - INFO -  step: 500  loss: -2.0000  grad_norm:  0.0000  memory: 16.79GiB(35.34%)  tps: 10,153  tflops: 77.33  mfu: 24.78%
[rank3]:2025-11-02 01:08:50,621 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251102_0108_rank3_trend_line.svg
[rank2]:2025-11-02 01:08:50,622 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251102_0108_rank2_trend_line.svg
[rank2]:2025-11-02 01:08:50,644 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-02 01:08:50,645 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-02 01:08:50,645 - INFO -  step: 500  loss: -2.0000  grad_norm:  0.0000  memory: 12.14GiB(25.55%)  tps: 10,152  tflops: 77.32  mfu: 24.78%
[rank1]:2025-11-02 01:08:50,644 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-11-02 01:08:50,645 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-11-02 01:08:50,646 - INFO -  step: 500  loss: -2.0000  grad_norm:  0.0000  memory: 14.88GiB(31.31%)  tps: 10,152  tflops: 77.32  mfu: 24.78%
[rank3]:2025-11-02 01:08:50,839 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/pipeline_schedule/251102_0108_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 337.34 ms, GPU Bubble Ratio: 65.34%, 48.72%, 61.02%, 15.52%
[rank3]:2025-11-02 01:08:50,840 - INFO - 	> Batch Time: 337.34 ms (Average Freeze Ratio: 0.29)
[rank3]:2025-11-02 01:08:50,840 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 0.40/0.40, [MB7] 0.00/0.00
[rank3]:2025-11-02 01:08:50,842 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 0.40/0.40, [MB7] 0.00/0.00
[rank3]:2025-11-02 01:08:50,845 - INFO -  step: 500  loss:  0.2653  grad_norm:  0.0000  memory: 31.90GiB(67.15%)  tps: 10,103  tflops: 76.95  mfu: 24.66%
[rank1]:2025-11-02 01:08:50,912 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251102_0108_stage1_step500.svg
[rank0]:2025-11-02 01:08:50,913 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251102_0108_stage0_step500.svg
[rank2]:2025-11-02 01:08:50,913 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251102_0108_stage2_step500.svg
[rank3]:2025-11-02 01:08:51,025 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/pipeline_schedule/251102_0108_real_step500_rank3.svg
[rank3]:> Batch Time: 319.34 ms, GPU Bubble Ratio: 77.14%, 46.71%, 58.70%, 14.63%
[rank3]:2025-11-02 01:08:51,089 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251102_0108_stage3_step500.svg
[rank0]:2025-11-02 01:09:43,254 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-02 01:09:44,321 - INFO -  step: 550  loss: -2.0000  grad_norm:  0.0000  memory: 16.79GiB(35.34%)  tps: 7,631  tflops: 58.12  mfu: 18.63%
[rank3]:2025-11-02 01:09:44,354 - INFO -  step: 550  loss:  0.2630  grad_norm:  0.0884  memory: 31.90GiB(67.15%)  tps: 7,655  tflops: 58.30  mfu: 18.69%
[rank2]:2025-11-02 01:09:44,319 - INFO -  step: 550  loss: -2.0000  grad_norm:  0.0000  memory: 12.14GiB(25.55%)  tps: 7,631  tflops: 58.12  mfu: 18.63%
[rank1]:2025-11-02 01:09:44,321 - INFO -  step: 550  loss: -2.0000  grad_norm:  0.0000  memory: 14.88GiB(31.31%)  tps: 7,631  tflops: 58.12  mfu: 18.63%
[rank0]:2025-11-02 01:10:36,762 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 01:10:37,826 - INFO - Avg. fwd time: 11.4238 / Avg. bwd time: 35.9006 / Avg. batch time: 439.2684 (ms) / GPU bubble ratio: 13.81%
[rank2]:2025-11-02 01:10:37,840 - INFO - Avg. fwd time: 7.6217 / Avg. bwd time: 13.3329 / Avg. batch time: 464.9652 (ms) / GPU bubble ratio: 63.95%
[rank1]:2025-11-02 01:10:37,859 - INFO - Avg. fwd time: 9.9153 / Avg. bwd time: 17.1825 / Avg. batch time: 496.6235 (ms) / GPU bubble ratio: 56.35%
[rank0]:2025-11-02 01:10:37,865 - INFO - Avg. fwd time: 8.6571 / Avg. bwd time: 12.9963 / Avg. batch time: 522.4572 (ms) / GPU bubble ratio: 66.84%
[rank3]:2025-11-02 01:10:38,020 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251102_0110_rank3_trend_line.svg
[rank2]:2025-11-02 01:10:38,005 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251102_0110_rank2_trend_line.svg
[rank2]:2025-11-02 01:10:38,038 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-02 01:10:38,040 - INFO -  step: 600  loss: -2.0000  grad_norm:  0.0000  memory: 12.14GiB(25.55%)  tps: 7,625  tflops: 58.07  mfu: 18.61%
[rank2]:2025-11-02 01:10:38,040 - INFO - ðŸ”Ž  Running validation at step 600
[rank1]:2025-11-02 01:10:38,024 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251102_0110_rank1_trend_line.svg
[rank1]:2025-11-02 01:10:38,038 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-11-02 01:10:38,040 - INFO -  step: 600  loss: -2.0000  grad_norm:  0.0000  memory: 14.88GiB(31.31%)  tps: 7,625  tflops: 58.07  mfu: 18.61%
[rank1]:2025-11-02 01:10:38,040 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-11-02 01:10:38,031 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251102_0110_rank0_trend_line.svg
[rank0]:2025-11-02 01:10:38,038 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-11-02 01:10:38,040 - INFO -  step: 600  loss: -2.0000  grad_norm:  0.0000  memory: 16.79GiB(35.34%)  tps: 7,625  tflops: 58.07  mfu: 18.61%
[rank0]:2025-11-02 01:10:38,040 - INFO - ðŸ”Ž  Running validation at step 600
[rank3]:2025-11-02 01:10:38,236 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/pipeline_schedule/251102_0110_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 377.19 ms, GPU Bubble Ratio: 74.44%, 56.21%, 66.28%, 13.76%
[rank3]:2025-11-02 01:10:38,237 - INFO - 	> Batch Time: 377.19 ms (Average Freeze Ratio: 0.29)
[rank3]:2025-11-02 01:10:38,237 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 0.40/0.40, [MB7] 0.00/0.00
[rank3]:2025-11-02 01:10:38,245 - INFO -  step: 600  loss:  0.2199  grad_norm:  0.1059  memory: 31.90GiB(67.15%)  tps: 7,601  tflops: 57.89  mfu: 18.55%
[rank3]:2025-11-02 01:10:38,246 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-11-02 01:10:57,651 - INFO - validate step: 600  loss: -1.0000  memory: 16.79GiB(35.34%)  tps: 20,886
[rank2]:2025-11-02 01:10:57,686 - INFO - validate step: 600  loss: -1.0000  memory: 12.14GiB(25.55%)  tps: 20,849
[rank1]:2025-11-02 01:10:57,669 - INFO - validate step: 600  loss: -1.0000  memory: 14.88GiB(31.31%)  tps: 20,868
[rank3]:2025-11-02 01:10:57,678 - INFO - validate step: 600  loss:  0.9457  memory: 31.90GiB(67.15%)  tps: 21,079
[rank2]:2025-11-02 01:10:57,760 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251102_0110_stage2_step600.svg
[rank1]:2025-11-02 01:10:57,759 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251102_0110_stage1_step600.svg
[rank0]:2025-11-02 01:10:57,760 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251102_0110_stage0_step600.svg
[rank3]:2025-11-02 01:10:57,859 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/pipeline_schedule/251102_0110_real_step600_rank3.svg
[rank3]:> Batch Time: 453.05 ms, GPU Bubble Ratio: 83.90%, 62.49%, 70.93%, 10.52%
[rank3]:2025-11-02 01:10:57,924 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251102_0110_stage3_step600.svg
[rank0]:2025-11-02 01:11:50,619 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-11-02 01:11:51,706 - INFO -  step: 650  loss: -2.0000  grad_norm:  0.0000  memory: 16.79GiB(35.34%)  tps: 7,578  tflops: 57.71  mfu: 18.50%
[rank2]:2025-11-02 01:11:51,704 - INFO -  step: 650  loss: -2.0000  grad_norm:  0.0000  memory: 12.14GiB(25.55%)  tps: 7,583  tflops: 57.75  mfu: 18.51%
[rank1]:2025-11-02 01:11:51,706 - INFO -  step: 650  loss: -2.0000  grad_norm:  0.0000  memory: 14.88GiB(31.31%)  tps: 7,580  tflops: 57.73  mfu: 18.50%
[rank3]:2025-11-02 01:11:51,738 - INFO -  step: 650  loss:  0.3653  grad_norm:  0.0830  memory: 31.90GiB(67.15%)  tps: 7,577  tflops: 57.71  mfu: 18.50%
[rank0]:2025-11-02 01:12:44,515 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-02 01:12:45,104 - INFO - Avg. fwd time: 8.7181 / Avg. bwd time: 11.3014 / Avg. batch time: 522.9166 (ms) / GPU bubble ratio: 69.37%
[rank3]:2025-11-02 01:12:45,349 - INFO - Avg. fwd time: 11.3295 / Avg. bwd time: 36.4899 / Avg. batch time: 443.1007 (ms) / GPU bubble ratio: 13.66%
[rank2]:2025-11-02 01:12:45,328 - INFO - Avg. fwd time: 7.7260 / Avg. bwd time: 12.6446 / Avg. batch time: 468.1304 (ms) / GPU bubble ratio: 65.19%
[rank1]:2025-11-02 01:12:45,408 - INFO - Avg. fwd time: 10.0364 / Avg. bwd time: 16.2997 / Avg. batch time: 498.8551 (ms) / GPU bubble ratio: 57.77%
[rank0]:2025-11-02 01:12:45,588 - INFO -  step: 700  loss: -2.0000  grad_norm:  0.0000  memory: 16.79GiB(35.34%)  tps: 7,602  tflops: 57.90  mfu: 18.56%
[rank2]:2025-11-02 01:12:45,586 - INFO -  step: 700  loss: -2.0000  grad_norm:  0.0000  memory: 12.14GiB(25.55%)  tps: 7,602  tflops: 57.90  mfu: 18.56%
[rank1]:2025-11-02 01:12:45,587 - INFO -  step: 700  loss: -2.0000  grad_norm:  0.0000  memory: 14.88GiB(31.31%)  tps: 7,602  tflops: 57.90  mfu: 18.56%
[rank0]:2025-11-02 01:12:45,696 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251102_0112_stage0_step700.svg
[rank3]:2025-11-02 01:12:45,620 - INFO -  step: 700  loss:  0.2398  grad_norm:  0.0745  memory: 31.90GiB(67.15%)  tps: 7,602  tflops: 57.90  mfu: 18.56%
[rank2]:2025-11-02 01:12:45,696 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251102_0112_stage2_step700.svg
[rank1]:2025-11-02 01:12:45,695 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251102_0112_stage1_step700.svg
[rank3]:2025-11-02 01:12:45,798 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/pipeline_schedule/251102_0112_real_step700_rank3.svg
[rank3]:> Batch Time: 457.82 ms, GPU Bubble Ratio: 84.05%, 62.84%, 71.21%, 10.44%
[rank3]:2025-11-02 01:12:45,868 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251102_0112_stage3_step700.svg
[rank0]:2025-11-02 01:13:38,643 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-02 01:13:39,730 - INFO -  step: 750  loss: -2.0000  grad_norm:  0.0000  memory: 16.79GiB(35.34%)  tps: 7,565  tflops: 57.62  mfu: 18.47%
[rank3]:2025-11-02 01:13:39,762 - INFO -  step: 750  loss:  0.2299  grad_norm:  0.0682  memory: 31.90GiB(67.15%)  tps: 7,566  tflops: 57.62  mfu: 18.47%
[rank2]:2025-11-02 01:13:39,728 - INFO -  step: 750  loss: -2.0000  grad_norm:  0.0000  memory: 12.14GiB(25.55%)  tps: 7,565  tflops: 57.62  mfu: 18.47%
[rank1]:2025-11-02 01:13:39,728 - INFO -  step: 750  loss: -2.0000  grad_norm:  0.0000  memory: 14.88GiB(31.31%)  tps: 7,566  tflops: 57.62  mfu: 18.47%
[rank0]:2025-11-02 01:14:32,610 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-02 01:14:33,206 - INFO - Avg. fwd time: 8.7717 / Avg. bwd time: 9.8090 / Avg. batch time: 523.3838 (ms) / GPU bubble ratio: 71.60%
[rank2]:2025-11-02 01:14:33,432 - INFO - Avg. fwd time: 7.8169 / Avg. bwd time: 12.0375 / Avg. batch time: 470.9848 (ms) / GPU bubble ratio: 66.28%
[rank3]:2025-11-02 01:14:33,454 - INFO - Avg. fwd time: 11.2482 / Avg. bwd time: 37.0168 / Avg. batch time: 446.5516 (ms) / GPU bubble ratio: 13.53%
[rank1]:2025-11-02 01:14:33,515 - INFO - Avg. fwd time: 10.1428 / Avg. bwd time: 15.5218 / Avg. batch time: 500.8858 (ms) / GPU bubble ratio: 59.01%
[rank0]:2025-11-02 01:14:33,909 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251102_0114_rank0_trend_line.svg
[rank3]:2025-11-02 01:14:33,926 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251102_0114_rank3_trend_line.svg
[rank2]:2025-11-02 01:14:33,905 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251102_0114_rank2_trend_line.svg
[rank2]:2025-11-02 01:14:33,934 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-02 01:14:33,936 - INFO -  step: 800  loss: -2.0000  grad_norm:  0.0000  memory: 12.14GiB(25.55%)  tps: 7,556  tflops: 57.55  mfu: 18.45%
[rank2]:2025-11-02 01:14:33,936 - INFO - ðŸ”Ž  Running validation at step 800
[rank1]:2025-11-02 01:14:33,907 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251102_0114_rank1_trend_line.svg
[rank1]:2025-11-02 01:14:33,933 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank1]:2025-11-02 01:14:33,935 - INFO -  step: 800  loss: -2.0000  grad_norm:  0.0000  memory: 14.88GiB(31.31%)  tps: 7,556  tflops: 57.55  mfu: 18.45%
[rank1]:2025-11-02 01:14:33,935 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-11-02 01:14:33,933 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank0]:2025-11-02 01:14:33,935 - INFO -  step: 800  loss: -2.0000  grad_norm:  0.0000  memory: 16.79GiB(35.34%)  tps: 7,556  tflops: 57.55  mfu: 18.45%
[rank0]:2025-11-02 01:14:33,935 - INFO - ðŸ”Ž  Running validation at step 800
[rank3]:2025-11-02 01:14:34,118 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/pipeline_schedule/251102_0114_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 408.38 ms, GPU Bubble Ratio: 79.67%, 60.68%, 69.62%, 12.39%
[rank3]:2025-11-02 01:14:34,119 - INFO - 	> Batch Time: 408.38 ms (Average Freeze Ratio: 0.23)
[rank3]:2025-11-02 01:14:34,119 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 0.40/0.40, [MB7] 0.00/0.00
[rank3]:2025-11-02 01:14:34,128 - INFO -  step: 800  loss:  0.2654  grad_norm:  0.1241  memory: 31.90GiB(67.15%)  tps: 7,534  tflops: 57.38  mfu: 18.39%
[rank3]:2025-11-02 01:14:34,128 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-11-02 01:14:53,456 - INFO - validate step: 800  loss: -1.0000  memory: 16.79GiB(35.34%)  tps: 20,983
[rank1]:2025-11-02 01:14:53,473 - INFO - validate step: 800  loss: -1.0000  memory: 14.88GiB(31.31%)  tps: 20,965
[rank3]:2025-11-02 01:14:53,485 - INFO - validate step: 800  loss:  0.9482  memory: 31.90GiB(67.15%)  tps: 21,162
[rank2]:2025-11-02 01:14:53,491 - INFO - validate step: 800  loss: -1.0000  memory: 12.14GiB(25.55%)  tps: 20,946
[rank2]:2025-11-02 01:14:53,569 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251102_0114_stage2_step800.svg
[rank1]:2025-11-02 01:14:53,571 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251102_0114_stage1_step800.svg
[rank0]:2025-11-02 01:14:53,569 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251102_0114_stage0_step800.svg
[rank3]:2025-11-02 01:14:53,666 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/pipeline_schedule/251102_0114_real_step800_rank3.svg
[rank3]:> Batch Time: 456.53 ms, GPU Bubble Ratio: 84.00%, 62.77%, 71.14%, 10.38%
[rank3]:2025-11-02 01:14:53,737 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251102_0114_stage3_step800.svg
[rank3]:2025-11-02 01:15:05,837 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-11-02 01:15:06,053 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-11-02 01:15:06,080 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-11-02 01:15:06,108 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-11-02 01:15:51,524 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-11-02 01:15:52,688 - INFO -  step: 850  loss: -2.0000  grad_norm:  0.9324  memory: 14.88GiB(31.31%)  tps: 6,917  tflops: 52.68  mfu: 16.89%
[rank0]:2025-11-02 01:15:52,701 - INFO -  step: 850  loss: -2.0000  grad_norm:  0.9324  memory: 16.79GiB(35.34%)  tps: 6,914  tflops: 52.66  mfu: 16.88%
[rank3]:2025-11-02 01:15:52,699 - INFO -  step: 850  loss:  0.2150  grad_norm:  0.9324  memory: 31.90GiB(67.15%)  tps: 6,917  tflops: 52.69  mfu: 16.89%
[rank2]:2025-11-02 01:15:52,668 - INFO -  step: 850  loss: -2.0000  grad_norm:  0.0000  memory: 12.14GiB(25.55%)  tps: 6,922  tflops: 52.72  mfu: 16.90%
[rank0]:2025-11-02 01:16:50,471 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 01:16:51,574 - INFO - Avg. fwd time: 11.1776 / Avg. bwd time: 37.4110 / Avg. batch time: 449.0476 (ms) / GPU bubble ratio: 13.44%
[rank2]:2025-11-02 01:16:51,589 - INFO - Avg. fwd time: 7.8872 / Avg. bwd time: 11.5726 / Avg. batch time: 473.0158 (ms) / GPU bubble ratio: 67.09%
[rank1]:2025-11-02 01:16:51,620 - INFO - Avg. fwd time: 10.0116 / Avg. bwd time: 16.4166 / Avg. batch time: 503.7945 (ms) / GPU bubble ratio: 58.03%
[rank0]:2025-11-02 01:16:51,650 - INFO - Avg. fwd time: 8.6907 / Avg. bwd time: 11.2822 / Avg. batch time: 527.8097 (ms) / GPU bubble ratio: 69.73%
[rank0]:2025-11-02 01:16:51,691 - INFO -  step: 900  loss: -2.0000  grad_norm:  0.4907  memory: 16.79GiB(35.34%)  tps: 6,944  tflops: 52.88  mfu: 16.95%
[rank3]:2025-11-02 01:16:51,689 - INFO -  step: 900  loss:  0.2329  grad_norm:  0.4907  memory: 31.90GiB(67.15%)  tps: 6,944  tflops: 52.88  mfu: 16.95%
[rank2]:2025-11-02 01:16:51,659 - INFO -  step: 900  loss: -2.0000  grad_norm:  0.0000  memory: 12.14GiB(25.55%)  tps: 6,943  tflops: 52.88  mfu: 16.95%
[rank1]:2025-11-02 01:16:51,679 - INFO -  step: 900  loss: -2.0000  grad_norm:  0.4907  memory: 14.88GiB(31.31%)  tps: 6,944  tflops: 52.88  mfu: 16.95%
[rank1]:2025-11-02 01:16:51,757 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251102_0116_stage1_step900.svg
[rank0]:2025-11-02 01:16:51,757 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251102_0116_stage0_step900.svg
[rank2]:2025-11-02 01:16:51,759 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251102_0116_stage2_step900.svg
[rank3]:2025-11-02 01:16:51,873 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/pipeline_schedule/251102_0116_real_step900_rank3.svg
[rank3]:> Batch Time: 490.79 ms, GPU Bubble Ratio: 48.19%, 46.69%, 73.18%, 17.26%
[rank3]:2025-11-02 01:16:51,936 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251102_0116_stage3_step900.svg
[rank0]:2025-11-02 01:17:49,747 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-02 01:17:50,943 - INFO -  step: 950  loss: -2.0000  grad_norm:  0.4372  memory: 14.88GiB(31.31%)  tps: 6,911  tflops: 52.64  mfu: 16.87%
[rank0]:2025-11-02 01:17:50,955 - INFO -  step: 950  loss: -2.0000  grad_norm:  0.4372  memory: 16.79GiB(35.34%)  tps: 6,911  tflops: 52.64  mfu: 16.87%
[rank3]:2025-11-02 01:17:50,954 - INFO -  step: 950  loss:  0.1989  grad_norm:  0.4372  memory: 31.90GiB(67.15%)  tps: 6,912  tflops: 52.64  mfu: 16.87%
[rank2]:2025-11-02 01:17:50,922 - INFO -  step: 950  loss: -2.0000  grad_norm:  0.0000  memory: 12.14GiB(25.55%)  tps: 6,912  tflops: 52.64  mfu: 16.87%
[rank0]:2025-11-02 01:18:48,867 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 01:18:49,773 - INFO - Avg. fwd time: 11.1308 / Avg. bwd time: 37.6809 / Avg. batch time: 450.7682 (ms) / GPU bubble ratio: 13.37%
[rank2]:2025-11-02 01:18:49,751 - INFO - Avg. fwd time: 7.9356 / Avg. bwd time: 11.2522 / Avg. batch time: 474.4308 (ms) / GPU bubble ratio: 67.64%
[rank1]:2025-11-02 01:18:49,897 - INFO - Avg. fwd time: 9.9128 / Avg. bwd time: 17.1026 / Avg. batch time: 505.8883 (ms) / GPU bubble ratio: 57.28%
[rank0]:2025-11-02 01:18:49,905 - INFO - Avg. fwd time: 8.6338 / Avg. bwd time: 12.4141 / Avg. batch time: 531.0710 (ms) / GPU bubble ratio: 68.29%
[rank2]:2025-11-02 01:18:50,060 - INFO -  step: 1000  loss: -2.0000  grad_norm:  0.0000  memory: 12.14GiB(25.55%)  tps: 6,926  tflops: 52.75  mfu: 16.91%
[rank2]:2025-11-02 01:18:50,060 - INFO - ðŸ”Ž  Running validation at step 1000
[rank1]:2025-11-02 01:18:50,081 - INFO -  step: 1000  loss: -2.0000  grad_norm:  0.5074  memory: 14.88GiB(31.31%)  tps: 6,926  tflops: 52.75  mfu: 16.91%
[rank1]:2025-11-02 01:18:50,081 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-11-02 01:18:50,092 - INFO -  step: 1000  loss: -2.0000  grad_norm:  0.5074  memory: 16.79GiB(35.34%)  tps: 6,926  tflops: 52.75  mfu: 16.91%
[rank0]:2025-11-02 01:18:50,092 - INFO - ðŸ”Ž  Running validation at step 1000
[rank3]:2025-11-02 01:18:50,091 - INFO -  step: 1000  loss:  0.2810  grad_norm:  0.5074  memory: 31.90GiB(67.15%)  tps: 6,927  tflops: 52.75  mfu: 16.91%
[rank3]:2025-11-02 01:18:50,092 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-11-02 01:19:09,468 - INFO - validate step: 1000  loss: -1.0000  memory: 16.79GiB(35.34%)  tps: 21,140
[rank3]:2025-11-02 01:19:09,492 - INFO - validate step: 1000  loss:  0.9395  memory: 31.90GiB(67.15%)  tps: 21,114
[rank2]:2025-11-02 01:19:09,498 - INFO - validate step: 1000  loss: -1.0000  memory: 12.14GiB(25.55%)  tps: 21,072
[rank1]:2025-11-02 01:19:09,483 - INFO - validate step: 1000  loss: -1.0000  memory: 14.88GiB(31.31%)  tps: 21,112
[rank0]:2025-11-02 01:19:09,570 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251102_0119_stage0_step1000.svg
[rank2]:2025-11-02 01:19:09,571 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251102_0119_stage2_step1000.svg
[rank1]:2025-11-02 01:19:09,568 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251102_0119_stage1_step1000.svg
[rank3]:2025-11-02 01:19:09,684 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/pipeline_schedule/251102_0119_real_step1000_rank3.svg
[rank3]:> Batch Time: 493.89 ms, GPU Bubble Ratio: 48.48%, 47.02%, 73.35%, 17.15%
[rank3]:2025-11-02 01:19:09,749 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251102_0119_stage3_step1000.svg
[rank0]:2025-11-02 01:20:07,225 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-11-02 01:20:08,398 - INFO -  step: 1050  loss: -2.0000  grad_norm:  0.0000  memory: 12.14GiB(25.55%)  tps: 6,954  tflops: 52.96  mfu: 16.98%
[rank1]:2025-11-02 01:20:08,419 - INFO -  step: 1050  loss: -2.0000  grad_norm:  0.9466  memory: 14.88GiB(31.31%)  tps: 6,950  tflops: 52.93  mfu: 16.97%
[rank0]:2025-11-02 01:20:08,431 - INFO -  step: 1050  loss: -2.0000  grad_norm:  0.9466  memory: 16.79GiB(35.34%)  tps: 6,947  tflops: 52.91  mfu: 16.96%
[rank3]:2025-11-02 01:20:08,445 - INFO -  step: 1050  loss:  0.3027  grad_norm:  0.9466  memory: 31.90GiB(67.15%)  tps: 6,948  tflops: 52.92  mfu: 16.96%
[rank0]:2025-11-02 01:21:05,764 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 01:21:06,657 - INFO - Avg. fwd time: 11.0835 / Avg. bwd time: 37.8943 / Avg. batch time: 452.0295 (ms) / GPU bubble ratio: 13.32%
[rank2]:2025-11-02 01:21:06,635 - INFO - Avg. fwd time: 7.9827 / Avg. bwd time: 10.9453 / Avg. batch time: 475.3882 (ms) / GPU bubble ratio: 68.15%
[rank1]:2025-11-02 01:21:06,777 - INFO - Avg. fwd time: 9.8189 / Avg. bwd time: 17.7613 / Avg. batch time: 507.4967 (ms) / GPU bubble ratio: 56.52%
[rank0]:2025-11-02 01:21:06,784 - INFO - Avg. fwd time: 8.5806 / Avg. bwd time: 13.5012 / Avg. batch time: 533.8025 (ms) / GPU bubble ratio: 66.91%
[rank3]:2025-11-02 01:21:06,963 - INFO -  step: 1100  loss:  0.3313  grad_norm:  0.6220  memory: 31.90GiB(67.15%)  tps: 7,000  tflops: 53.31  mfu: 17.09%
[rank2]:2025-11-02 01:21:06,932 - INFO -  step: 1100  loss: -2.0000  grad_norm:  0.0000  memory: 12.14GiB(25.55%)  tps: 6,998  tflops: 53.30  mfu: 17.08%
[rank1]:2025-11-02 01:21:06,953 - INFO -  step: 1100  loss: -2.0000  grad_norm:  0.6220  memory: 14.88GiB(31.31%)  tps: 6,998  tflops: 53.30  mfu: 17.08%
[rank0]:2025-11-02 01:21:06,964 - INFO -  step: 1100  loss: -2.0000  grad_norm:  0.6220  memory: 16.79GiB(35.34%)  tps: 6,998  tflops: 53.30  mfu: 17.08%
[rank2]:2025-11-02 01:21:07,036 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251102_0121_stage2_step1100.svg
[rank1]:2025-11-02 01:21:07,033 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251102_0121_stage1_step1100.svg
[rank0]:2025-11-02 01:21:07,034 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251102_0121_stage0_step1100.svg
[rank3]:2025-11-02 01:21:07,147 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/pipeline_schedule/251102_0121_real_step1100_rank3.svg
[rank3]:> Batch Time: 485.68 ms, GPU Bubble Ratio: 47.58%, 46.06%, 72.86%, 17.48%
[rank3]:2025-11-02 01:21:07,213 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251102_0121_stage3_step1100.svg
[rank0]:2025-11-02 01:22:04,514 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 01:22:05,724 - INFO -  step: 1150  loss:  0.2572  grad_norm:  0.5125  memory: 31.90GiB(67.15%)  tps: 6,971  tflops: 53.09  mfu: 17.02%
[rank2]:2025-11-02 01:22:05,692 - INFO -  step: 1150  loss: -2.0000  grad_norm:  0.0000  memory: 12.14GiB(25.55%)  tps: 6,971  tflops: 53.09  mfu: 17.02%
[rank1]:2025-11-02 01:22:05,713 - INFO -  step: 1150  loss: -2.0000  grad_norm:  0.5125  memory: 14.88GiB(31.31%)  tps: 6,971  tflops: 53.09  mfu: 17.02%
[rank0]:2025-11-02 01:22:05,725 - INFO -  step: 1150  loss: -2.0000  grad_norm:  0.5125  memory: 16.79GiB(35.34%)  tps: 6,971  tflops: 53.09  mfu: 17.02%
[rank0]:2025-11-02 01:23:02,925 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 01:23:04,030 - INFO - Avg. fwd time: 11.0434 / Avg. bwd time: 38.0460 / Avg. batch time: 452.8664 (ms) / GPU bubble ratio: 13.28%
[rank2]:2025-11-02 01:23:04,046 - INFO - Avg. fwd time: 8.0206 / Avg. bwd time: 10.6919 / Avg. batch time: 475.9784 (ms) / GPU bubble ratio: 68.55%
[rank1]:2025-11-02 01:23:04,076 - INFO - Avg. fwd time: 9.7411 / Avg. bwd time: 18.3054 / Avg. batch time: 508.6324 (ms) / GPU bubble ratio: 55.89%
[rank0]:2025-11-02 01:23:04,108 - INFO - Avg. fwd time: 8.5368 / Avg. bwd time: 14.3985 / Avg. batch time: 535.8660 (ms) / GPU bubble ratio: 65.76%
[rank3]:2025-11-02 01:23:04,394 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251102_0123_rank3_trend_line.svg
[rank2]:2025-11-02 01:23:04,366 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251102_0123_rank2_trend_line.svg
[rank1]:2025-11-02 01:23:04,397 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251102_0123_rank1_trend_line.svg
[rank1]:2025-11-02 01:23:04,443 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-11-02 01:23:04,449 - INFO -  step: 1200  loss: -2.0000  grad_norm:  0.6808  memory: 14.88GiB(31.31%)  tps: 6,974  tflops: 53.11  mfu: 17.02%
[rank1]:2025-11-02 01:23:04,449 - INFO - ðŸ”Ž  Running validation at step 1200
[rank0]:2025-11-02 01:23:04,436 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251102_0123_rank0_trend_line.svg
[rank0]:2025-11-02 01:23:04,443 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-11-02 01:23:04,449 - INFO -  step: 1200  loss: -2.0000  grad_norm:  0.6808  memory: 16.79GiB(35.34%)  tps: 6,975  tflops: 53.12  mfu: 17.03%
[rank0]:2025-11-02 01:23:04,449 - INFO - ðŸ”Ž  Running validation at step 1200
[rank2]:2025-11-02 01:23:04,443 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-02 01:23:04,446 - INFO -  step: 1200  loss: -2.0000  grad_norm:  0.0000  memory: 12.14GiB(25.55%)  tps: 6,972  tflops: 53.10  mfu: 17.02%
[rank2]:2025-11-02 01:23:04,446 - INFO - ðŸ”Ž  Running validation at step 1200
[rank3]:2025-11-02 01:23:04,637 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/pipeline_schedule/251102_0123_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 426.19 ms, GPU Bubble Ratio: 63.19%, 51.83%, 71.41%, 11.13%
[rank3]:2025-11-02 01:23:04,638 - INFO - 	> Batch Time: 426.19 ms (Average Freeze Ratio: 0.29)
[rank3]:2025-11-02 01:23:04,638 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 0.40/0.40, [MB7] 0.00/0.00
[rank3]:2025-11-02 01:23:04,648 - INFO -  step: 1200  loss:  0.1965  grad_norm:  0.6808  memory: 31.90GiB(67.15%)  tps: 6,952  tflops: 52.94  mfu: 16.97%
[rank3]:2025-11-02 01:23:04,648 - INFO - ðŸ”Ž  Running validation at step 1200
[rank0]:2025-11-02 01:23:23,883 - INFO - validate step: 1200  loss: -1.0000  memory: 16.79GiB(35.34%)  tps: 21,078
[rank0]:2025-11-02 01:23:23,883 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-02 01:23:23,891 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank2]:2025-11-02 01:23:23,912 - INFO - validate step: 1200  loss: -1.0000  memory: 12.14GiB(25.55%)  tps: 21,042
[rank2]:2025-11-02 01:23:23,913 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-11-02 01:23:23,905 - INFO - validate step: 1200  loss:  0.9401  memory: 31.90GiB(67.15%)  tps: 21,271
[rank3]:2025-11-02 01:23:23,906 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-11-02 01:23:23,897 - INFO - validate step: 1200  loss: -1.0000  memory: 14.88GiB(31.31%)  tps: 21,062
[rank1]:2025-11-02 01:23:23,898 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-02 01:23:25,725 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 1.81 seconds.
[rank1]:2025-11-02 01:23:26,180 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 2.28 seconds.
[rank3]:2025-11-02 01:23:27,261 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.35 seconds.
[rank0]:2025-11-02 01:23:27,561 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-11-02 01:23:27,570 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.69 seconds.
[rank2]:2025-11-02 01:23:27,648 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251102_0123_stage2_step1200.svg
[rank1]:2025-11-02 01:23:27,647 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251102_0123_stage1_step1200.svg
[rank0]:2025-11-02 01:23:27,816 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251102_0123_stage0_step1200.svg
[rank3]:2025-11-02 01:23:27,916 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/pipeline_schedule/251102_0123_real_step1200_rank3.svg
[rank3]:> Batch Time: 485.09 ms, GPU Bubble Ratio: 47.53%, 46.01%, 72.86%, 17.49%
[rank3]:2025-11-02 01:23:27,987 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251102_0123_stage3_step1200.svg
[rank0]:2025-11-02 01:24:21,122 - INFO - [GC] Peforming periodical GC collection 0.23 seconds
[rank2]:2025-11-02 01:24:22,194 - INFO -  step: 1250  loss: -2.0000  grad_norm:  0.0000  memory: 12.14GiB(25.55%)  tps: 7,028  tflops: 53.53  mfu: 17.16%
[rank1]:2025-11-02 01:24:22,195 - INFO -  step: 1250  loss: -2.0000  grad_norm:  0.0000  memory: 15.73GiB(33.12%)  tps: 7,026  tflops: 53.51  mfu: 17.15%
[rank0]:2025-11-02 01:24:22,195 - INFO -  step: 1250  loss: -2.0000  grad_norm:  0.0000  memory: 16.79GiB(35.34%)  tps: 7,024  tflops: 53.50  mfu: 17.15%
[rank3]:2025-11-02 01:24:22,234 - INFO -  step: 1250  loss:  0.3145  grad_norm:  0.0980  memory: 31.90GiB(67.15%)  tps: 7,023  tflops: 53.49  mfu: 17.14%
[rank0]:2025-11-02 01:25:14,605 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-02 01:25:15,189 - INFO - Avg. fwd time: 8.5783 / Avg. bwd time: 13.4027 / Avg. batch time: 535.0824 (ms) / GPU bubble ratio: 67.14%
[rank2]:2025-11-02 01:25:15,413 - INFO - Avg. fwd time: 8.0480 / Avg. bwd time: 10.5070 / Avg. batch time: 476.7885 (ms) / GPU bubble ratio: 68.87%
[rank3]:2025-11-02 01:25:15,434 - INFO - Avg. fwd time: 11.0168 / Avg. bwd time: 38.1746 / Avg. batch time: 453.8580 (ms) / GPU bubble ratio: 13.29%
[rank1]:2025-11-02 01:25:15,495 - INFO - Avg. fwd time: 9.8166 / Avg. bwd time: 17.7597 / Avg. batch time: 508.8803 (ms) / GPU bubble ratio: 56.65%
[rank2]:2025-11-02 01:25:15,668 - INFO -  step: 1300  loss: -2.0000  grad_norm:  0.0000  memory: 12.14GiB(25.55%)  tps: 7,660  tflops: 58.34  mfu: 18.70%
[rank1]:2025-11-02 01:25:15,669 - INFO -  step: 1300  loss: -2.0000  grad_norm:  0.0000  memory: 15.73GiB(33.12%)  tps: 7,660  tflops: 58.34  mfu: 18.70%
[rank0]:2025-11-02 01:25:15,670 - INFO -  step: 1300  loss: -2.0000  grad_norm:  0.0000  memory: 16.79GiB(35.34%)  tps: 7,660  tflops: 58.34  mfu: 18.70%
[rank2]:2025-11-02 01:25:15,781 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251102_0125_stage2_step1300.svg
[rank3]:2025-11-02 01:25:15,703 - INFO -  step: 1300  loss:  0.2756  grad_norm:  0.0720  memory: 31.90GiB(67.15%)  tps: 7,661  tflops: 58.35  mfu: 18.70%
[rank1]:2025-11-02 01:25:15,777 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251102_0125_stage1_step1300.svg
[rank0]:2025-11-02 01:25:15,779 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251102_0125_stage0_step1300.svg
[rank3]:2025-11-02 01:25:15,887 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/pipeline_schedule/251102_0125_real_step1300_rank3.svg
[rank3]:> Batch Time: 452.02 ms, GPU Bubble Ratio: 83.87%, 62.43%, 70.89%, 10.53%
[rank3]:2025-11-02 01:25:15,958 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251102_0125_stage3_step1300.svg
[rank0]:2025-11-02 01:26:08,192 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-02 01:26:09,265 - INFO -  step: 1350  loss: -2.0000  grad_norm:  0.0000  memory: 15.73GiB(33.12%)  tps: 7,642  tflops: 58.21  mfu: 18.66%
[rank0]:2025-11-02 01:26:09,268 - INFO -  step: 1350  loss: -2.0000  grad_norm:  0.0000  memory: 16.79GiB(35.34%)  tps: 7,642  tflops: 58.20  mfu: 18.66%
[rank2]:2025-11-02 01:26:09,266 - INFO -  step: 1350  loss: -2.0000  grad_norm:  0.0000  memory: 12.14GiB(25.55%)  tps: 7,642  tflops: 58.20  mfu: 18.66%
[rank3]:2025-11-02 01:26:09,298 - INFO -  step: 1350  loss:  0.2738  grad_norm:  0.0732  memory: 31.90GiB(67.15%)  tps: 7,643  tflops: 58.21  mfu: 18.66%
[rank0]:2025-11-02 01:27:01,757 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-02 01:27:02,351 - INFO - Avg. fwd time: 8.6181 / Avg. bwd time: 12.3941 / Avg. batch time: 534.0686 (ms) / GPU bubble ratio: 68.53%
[rank2]:2025-11-02 01:27:02,579 - INFO - Avg. fwd time: 8.0753 / Avg. bwd time: 10.3213 / Avg. batch time: 477.3942 (ms) / GPU bubble ratio: 69.17%
[rank3]:2025-11-02 01:27:02,603 - INFO - Avg. fwd time: 10.9911 / Avg. bwd time: 38.3046 / Avg. batch time: 454.6410 (ms) / GPU bubble ratio: 13.26%
[rank1]:2025-11-02 01:27:02,665 - INFO - Avg. fwd time: 9.8929 / Avg. bwd time: 17.2060 / Avg. batch time: 508.9138 (ms) / GPU bubble ratio: 57.40%
[rank1]:2025-11-02 01:27:02,842 - INFO -  step: 1400  loss: -2.0000  grad_norm:  0.0000  memory: 15.73GiB(33.12%)  tps: 7,645  tflops: 58.23  mfu: 18.66%
[rank1]:2025-11-02 01:27:02,842 - INFO - ðŸ”Ž  Running validation at step 1400
[rank0]:2025-11-02 01:27:02,842 - INFO -  step: 1400  loss: -2.0000  grad_norm:  0.0000  memory: 16.79GiB(35.34%)  tps: 7,645  tflops: 58.23  mfu: 18.66%
[rank0]:2025-11-02 01:27:02,842 - INFO - ðŸ”Ž  Running validation at step 1400
[rank2]:2025-11-02 01:27:02,840 - INFO -  step: 1400  loss: -2.0000  grad_norm:  0.0000  memory: 12.14GiB(25.55%)  tps: 7,645  tflops: 58.23  mfu: 18.66%
[rank2]:2025-11-02 01:27:02,841 - INFO - ðŸ”Ž  Running validation at step 1400
[rank3]:2025-11-02 01:27:02,875 - INFO -  step: 1400  loss:  0.2422  grad_norm:  0.1044  memory: 31.90GiB(67.15%)  tps: 7,645  tflops: 58.23  mfu: 18.66%
[rank3]:2025-11-02 01:27:02,875 - INFO - ðŸ”Ž  Running validation at step 1400
[rank0]:2025-11-02 01:27:22,194 - INFO - validate step: 1400  loss: -1.0000  memory: 16.79GiB(35.34%)  tps: 21,166
[rank2]:2025-11-02 01:27:22,231 - INFO - validate step: 1400  loss: -1.0000  memory: 12.14GiB(25.55%)  tps: 21,124
[rank3]:2025-11-02 01:27:22,225 - INFO - validate step: 1400  loss:  0.9402  memory: 31.90GiB(67.15%)  tps: 21,169
[rank1]:2025-11-02 01:27:22,212 - INFO - validate step: 1400  loss: -1.0000  memory: 15.73GiB(33.12%)  tps: 21,146
[rank1]:2025-11-02 01:27:22,309 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251102_0127_stage1_step1400.svg
[rank0]:2025-11-02 01:27:22,308 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251102_0127_stage0_step1400.svg
[rank2]:2025-11-02 01:27:22,310 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251102_0127_stage2_step1400.svg
[rank3]:2025-11-02 01:27:22,426 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/pipeline_schedule/251102_0127_real_step1400_rank3.svg
[rank3]:> Batch Time: 453.68 ms, GPU Bubble Ratio: 83.95%, 62.59%, 71.01%, 10.51%
[rank3]:2025-11-02 01:27:22,501 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251102_0127_stage3_step1400.svg
[rank0]:2025-11-02 01:28:14,985 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-11-02 01:28:16,049 - INFO -  step: 1450  loss: -2.0000  grad_norm:  0.0000  memory: 15.73GiB(33.12%)  tps: 7,608  tflops: 57.95  mfu: 18.57%
[rank0]:2025-11-02 01:28:16,049 - INFO -  step: 1450  loss: -2.0000  grad_norm:  0.0000  memory: 16.79GiB(35.34%)  tps: 7,606  tflops: 57.93  mfu: 18.57%
[rank2]:2025-11-02 01:28:16,048 - INFO -  step: 1450  loss: -2.0000  grad_norm:  0.0000  memory: 12.14GiB(25.55%)  tps: 7,611  tflops: 57.97  mfu: 18.58%
[rank3]:2025-11-02 01:28:16,083 - INFO -  step: 1450  loss:  0.2481  grad_norm:  0.1048  memory: 31.90GiB(67.15%)  tps: 7,605  tflops: 57.93  mfu: 18.57%
[rank0]:2025-11-02 01:29:08,915 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 01:29:09,987 - INFO - Avg. fwd time: 8.0989 / Avg. bwd time: 10.1622 / Avg. batch time: 478.1661 (ms) / GPU bubble ratio: 69.45%
[rank3]:2025-11-02 01:29:09,970 - INFO - Avg. fwd time: 10.9703 / Avg. bwd time: 38.4453 / Avg. batch time: 455.5577 (ms) / GPU bubble ratio: 13.22%
[rank1]:2025-11-02 01:29:10,005 - INFO - Avg. fwd time: 9.9589 / Avg. bwd time: 16.7304 / Avg. batch time: 509.1949 (ms) / GPU bubble ratio: 58.07%
[rank1]:2025-11-02 01:29:10,014 - INFO -  step: 1500  loss: -2.0000  grad_norm:  0.0000  memory: 15.73GiB(33.12%)  tps: 7,590  tflops: 57.81  mfu: 18.53%
[rank0]:2025-11-02 01:29:10,013 - INFO - Avg. fwd time: 8.6528 / Avg. bwd time: 11.5266 / Avg. batch time: 533.4453 (ms) / GPU bubble ratio: 69.74%
[rank0]:2025-11-02 01:29:10,015 - INFO -  step: 1500  loss: -2.0000  grad_norm:  0.0000  memory: 16.79GiB(35.34%)  tps: 7,590  tflops: 57.81  mfu: 18.53%
[rank2]:2025-11-02 01:29:10,014 - INFO -  step: 1500  loss: -2.0000  grad_norm:  0.0000  memory: 12.14GiB(25.55%)  tps: 7,590  tflops: 57.81  mfu: 18.53%
[rank3]:2025-11-02 01:29:10,045 - INFO -  step: 1500  loss:  0.2826  grad_norm:  0.0900  memory: 31.90GiB(67.15%)  tps: 7,591  tflops: 57.81  mfu: 18.53%
[rank1]:2025-11-02 01:29:10,120 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251102_0129_stage1_step1500.svg
[rank0]:2025-11-02 01:29:10,121 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251102_0129_stage0_step1500.svg
[rank2]:2025-11-02 01:29:10,124 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251102_0129_stage2_step1500.svg
[rank3]:2025-11-02 01:29:10,227 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/pipeline_schedule/251102_0129_real_step1500_rank3.svg
[rank3]:> Batch Time: 458.62 ms, GPU Bubble Ratio: 84.11%, 62.96%, 71.29%, 10.33%
[rank3]:2025-11-02 01:29:10,298 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251102_0129_stage3_step1500.svg
[rank0]:2025-11-02 01:30:02,943 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-02 01:30:04,020 - INFO -  step: 1550  loss: -2.0000  grad_norm:  0.0000  memory: 15.73GiB(33.12%)  tps: 7,584  tflops: 57.76  mfu: 18.51%
[rank0]:2025-11-02 01:30:04,020 - INFO -  step: 1550  loss: -2.0000  grad_norm:  0.0000  memory: 16.79GiB(35.34%)  tps: 7,585  tflops: 57.77  mfu: 18.51%
[rank2]:2025-11-02 01:30:04,018 - INFO -  step: 1550  loss: -2.0000  grad_norm:  0.0000  memory: 12.14GiB(25.55%)  tps: 7,585  tflops: 57.77  mfu: 18.51%
[rank3]:2025-11-02 01:30:04,054 - INFO -  step: 1550  loss:  0.2403  grad_norm:  0.0654  memory: 31.90GiB(67.15%)  tps: 7,584  tflops: 57.76  mfu: 18.51%
[rank0]:2025-11-02 01:30:56,972 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-02 01:30:57,560 - INFO - Avg. fwd time: 8.6795 / Avg. bwd time: 10.8743 / Avg. batch time: 533.0525 (ms) / GPU bubble ratio: 70.65%
[rank2]:2025-11-02 01:30:57,790 - INFO - Avg. fwd time: 8.1169 / Avg. bwd time: 10.0428 / Avg. batch time: 478.8249 (ms) / GPU bubble ratio: 69.66%
[rank3]:2025-11-02 01:30:57,814 - INFO - Avg. fwd time: 10.9551 / Avg. bwd time: 38.5594 / Avg. batch time: 456.3183 (ms) / GPU bubble ratio: 13.19%
[rank1]:2025-11-02 01:30:57,876 - INFO - Avg. fwd time: 10.0088 / Avg. bwd time: 16.3729 / Avg. batch time: 509.4833 (ms) / GPU bubble ratio: 58.57%
[rank3]:2025-11-02 01:30:58,405 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251102_0130_rank3_trend_line.svg
[rank1]:2025-11-02 01:30:58,469 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251102_0130_rank1_trend_line.svg
[rank1]:2025-11-02 01:30:58,477 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-11-02 01:30:58,480 - INFO -  step: 1600  loss: -2.0000  grad_norm:  0.0000  memory: 15.73GiB(33.12%)  tps: 7,521  tflops: 57.28  mfu: 18.36%
[rank1]:2025-11-02 01:30:58,480 - INFO - ðŸ”Ž  Running validation at step 1600
[rank0]:2025-11-02 01:30:58,468 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251102_0130_rank0_trend_line.svg
[rank0]:2025-11-02 01:30:58,476 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-11-02 01:30:58,479 - INFO -  step: 1600  loss: -2.0000  grad_norm:  0.0000  memory: 16.79GiB(35.34%)  tps: 7,521  tflops: 57.28  mfu: 18.36%
[rank0]:2025-11-02 01:30:58,480 - INFO - ðŸ”Ž  Running validation at step 1600
[rank2]:2025-11-02 01:30:58,460 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251102_0130_rank2_trend_line.svg
[rank2]:2025-11-02 01:30:58,477 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-02 01:30:58,479 - INFO -  step: 1600  loss: -2.0000  grad_norm:  0.0000  memory: 12.14GiB(25.55%)  tps: 7,521  tflops: 57.28  mfu: 18.36%
[rank2]:2025-11-02 01:30:58,480 - INFO - ðŸ”Ž  Running validation at step 1600
[rank3]:2025-11-02 01:30:58,663 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/pipeline_schedule/251102_0130_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 434.83 ms, GPU Bubble Ratio: 70.25%, 56.26%, 72.17%, 11.05%
[rank3]:2025-11-02 01:30:58,664 - INFO - 	> Batch Time: 434.83 ms (Average Freeze Ratio: 0.29)
[rank3]:2025-11-02 01:30:58,664 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 0.40/0.40, [MB7] 0.00/0.00
[rank3]:2025-11-02 01:30:58,673 - INFO -  step: 1600  loss:  0.2058  grad_norm:  0.1329  memory: 31.90GiB(67.15%)  tps: 7,499  tflops: 57.12  mfu: 18.31%
[rank3]:2025-11-02 01:30:58,673 - INFO - ðŸ”Ž  Running validation at step 1600
[rank1]:2025-11-02 01:31:18,005 - INFO - validate step: 1600  loss: -1.0000  memory: 15.73GiB(33.12%)  tps: 20,978
[rank0]:2025-11-02 01:31:17,987 - INFO - validate step: 1600  loss: -1.0000  memory: 16.79GiB(35.34%)  tps: 20,997
[rank2]:2025-11-02 01:31:18,024 - INFO - validate step: 1600  loss: -1.0000  memory: 12.14GiB(25.55%)  tps: 20,957
[rank3]:2025-11-02 01:31:18,017 - INFO - validate step: 1600  loss:  0.9404  memory: 31.90GiB(67.15%)  tps: 21,176
[rank1]:2025-11-02 01:31:18,104 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251102_0131_stage1_step1600.svg
[rank0]:2025-11-02 01:31:18,105 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251102_0131_stage0_step1600.svg
[rank2]:2025-11-02 01:31:18,106 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251102_0131_stage2_step1600.svg
[rank3]:2025-11-02 01:31:18,204 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/pipeline_schedule/251102_0131_real_step1600_rank3.svg
[rank3]:> Batch Time: 458.56 ms, GPU Bubble Ratio: 84.07%, 62.93%, 71.28%, 10.37%
[rank3]:2025-11-02 01:31:18,278 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251102_0131_stage3_step1600.svg
[rank3]:2025-11-02 01:31:41,257 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-11-02 01:31:41,472 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-11-02 01:31:41,486 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-11-02 01:31:41,483 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-11-02 01:32:11,162 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-11-02 01:32:12,253 - INFO -  step: 1650  loss: -2.0000  grad_norm:  0.0000  memory: 15.73GiB(33.12%)  tps: 7,551  tflops: 57.51  mfu: 18.43%
[rank0]:2025-11-02 01:32:12,254 - INFO -  step: 1650  loss: -2.0000  grad_norm:  0.0000  memory: 16.79GiB(35.34%)  tps: 7,548  tflops: 57.49  mfu: 18.43%
[rank2]:2025-11-02 01:32:12,253 - INFO -  step: 1650  loss: -2.0000  grad_norm:  0.0000  memory: 12.14GiB(25.55%)  tps: 7,553  tflops: 57.53  mfu: 18.44%
[rank3]:2025-11-02 01:32:12,285 - INFO -  step: 1650  loss:  0.2774  grad_norm:  0.1092  memory: 31.90GiB(67.15%)  tps: 7,548  tflops: 57.49  mfu: 18.43%
[rank0]:2025-11-02 01:33:05,203 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-02 01:33:05,782 - INFO - Avg. fwd time: 8.7070 / Avg. bwd time: 10.2008 / Avg. batch time: 532.7344 (ms) / GPU bubble ratio: 71.61%
[rank2]:2025-11-02 01:33:06,007 - INFO - Avg. fwd time: 8.1360 / Avg. bwd time: 9.9201 / Avg. batch time: 479.5893 (ms) / GPU bubble ratio: 69.88%
[rank3]:2025-11-02 01:33:06,032 - INFO - Avg. fwd time: 10.9406 / Avg. bwd time: 38.6884 / Avg. batch time: 457.2030 (ms) / GPU bubble ratio: 13.16%
[rank1]:2025-11-02 01:33:06,093 - INFO - Avg. fwd time: 10.0605 / Avg. bwd time: 16.0040 / Avg. batch time: 509.8667 (ms) / GPU bubble ratio: 59.10%
[rank1]:2025-11-02 01:33:06,272 - INFO -  step: 1700  loss: -2.0000  grad_norm:  0.0000  memory: 15.73GiB(33.12%)  tps: 7,583  tflops: 57.75  mfu: 18.51%
[rank0]:2025-11-02 01:33:06,272 - INFO -  step: 1700  loss: -2.0000  grad_norm:  0.0000  memory: 16.79GiB(35.34%)  tps: 7,583  tflops: 57.75  mfu: 18.51%
[rank2]:2025-11-02 01:33:06,271 - INFO -  step: 1700  loss: -2.0000  grad_norm:  0.0000  memory: 12.14GiB(25.55%)  tps: 7,583  tflops: 57.75  mfu: 18.51%
[rank3]:2025-11-02 01:33:06,305 - INFO -  step: 1700  loss:  0.2480  grad_norm:  0.1055  memory: 31.90GiB(67.15%)  tps: 7,583  tflops: 57.75  mfu: 18.51%
[rank1]:2025-11-02 01:33:06,381 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251102_0133_stage1_step1700.svg
[rank0]:2025-11-02 01:33:06,381 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251102_0133_stage0_step1700.svg
[rank2]:2025-11-02 01:33:06,384 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251102_0133_stage2_step1700.svg
[rank3]:2025-11-02 01:33:06,482 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/pipeline_schedule/251102_0133_real_step1700_rank3.svg
[rank3]:> Batch Time: 459.27 ms, GPU Bubble Ratio: 84.10%, 62.97%, 71.28%, 10.34%
[rank3]:2025-11-02 01:33:06,553 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251102_0133_stage3_step1700.svg
[rank0]:2025-11-02 01:33:59,530 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-02 01:34:00,617 - INFO -  step: 1750  loss: -2.0000  grad_norm:  0.0000  memory: 15.73GiB(33.12%)  tps: 7,537  tflops: 57.40  mfu: 18.40%
[rank0]:2025-11-02 01:34:00,618 - INFO -  step: 1750  loss: -2.0000  grad_norm:  0.0000  memory: 16.79GiB(35.34%)  tps: 7,537  tflops: 57.40  mfu: 18.40%
[rank2]:2025-11-02 01:34:00,616 - INFO -  step: 1750  loss: -2.0000  grad_norm:  0.0000  memory: 12.14GiB(25.55%)  tps: 7,537  tflops: 57.40  mfu: 18.40%
[rank3]:2025-11-02 01:34:00,651 - INFO -  step: 1750  loss:  0.2057  grad_norm:  0.0876  memory: 31.90GiB(67.15%)  tps: 7,537  tflops: 57.40  mfu: 18.40%
[rank0]:2025-11-02 01:34:53,600 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 01:34:54,676 - INFO - Avg. fwd time: 10.9292 / Avg. bwd time: 38.8063 / Avg. batch time: 458.0273 (ms) / GPU bubble ratio: 13.13%
[rank1]:2025-11-02 01:34:54,713 - INFO - Avg. fwd time: 10.1064 / Avg. bwd time: 15.6781 / Avg. batch time: 510.2507 (ms) / GPU bubble ratio: 59.57%
[rank0]:2025-11-02 01:34:54,721 - INFO - Avg. fwd time: 8.7316 / Avg. bwd time: 9.6059 / Avg. batch time: 532.4987 (ms) / GPU bubble ratio: 72.45%
[rank0]:2025-11-02 01:34:54,724 - INFO -  step: 1800  loss: -2.0000  grad_norm:  0.0000  memory: 16.79GiB(35.34%)  tps: 7,570  tflops: 57.66  mfu: 18.48%
[rank0]:2025-11-02 01:34:54,724 - INFO - ðŸ”Ž  Running validation at step 1800
[rank2]:2025-11-02 01:34:54,694 - INFO - Avg. fwd time: 8.1529 / Avg. bwd time: 9.8116 / Avg. batch time: 480.3083 (ms) / GPU bubble ratio: 70.08%
[rank2]:2025-11-02 01:34:54,722 - INFO -  step: 1800  loss: -2.0000  grad_norm:  0.0000  memory: 12.14GiB(25.55%)  tps: 7,570  tflops: 57.66  mfu: 18.48%
[rank2]:2025-11-02 01:34:54,722 - INFO - ðŸ”Ž  Running validation at step 1800
[rank3]:2025-11-02 01:34:54,754 - INFO -  step: 1800  loss:  0.1809  grad_norm:  0.1043  memory: 31.90GiB(67.15%)  tps: 7,571  tflops: 57.66  mfu: 18.48%
[rank3]:2025-11-02 01:34:54,755 - INFO - ðŸ”Ž  Running validation at step 1800
[rank1]:2025-11-02 01:34:54,722 - INFO -  step: 1800  loss: -2.0000  grad_norm:  0.0000  memory: 15.73GiB(33.12%)  tps: 7,571  tflops: 57.66  mfu: 18.48%
[rank1]:2025-11-02 01:34:54,722 - INFO - ðŸ”Ž  Running validation at step 1800
[rank1]:2025-11-02 01:35:14,519 - INFO - validate step: 1800  loss: -1.0000  memory: 15.73GiB(33.12%)  tps: 20,691
[rank0]:2025-11-02 01:35:14,502 - INFO - validate step: 1800  loss: -1.0000  memory: 16.79GiB(35.34%)  tps: 20,710
[rank2]:2025-11-02 01:35:14,538 - INFO - validate step: 1800  loss: -1.0000  memory: 12.14GiB(25.55%)  tps: 20,671
[rank3]:2025-11-02 01:35:14,529 - INFO - validate step: 1800  loss:  0.9466  memory: 31.90GiB(67.15%)  tps: 20,715
[rank1]:2025-11-02 01:35:14,616 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251102_0135_stage1_step1800.svg
[rank0]:2025-11-02 01:35:14,617 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251102_0135_stage0_step1800.svg
[rank2]:2025-11-02 01:35:14,621 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251102_0135_stage2_step1800.svg
[rank3]:2025-11-02 01:35:14,724 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/pipeline_schedule/251102_0135_real_step1800_rank3.svg
[rank3]:> Batch Time: 460.73 ms, GPU Bubble Ratio: 84.15%, 63.08%, 71.38%, 10.24%
[rank3]:2025-11-02 01:35:14,797 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251102_0135_stage3_step1800.svg
[rank0]:2025-11-02 01:36:07,808 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-11-02 01:36:08,892 - INFO -  step: 1850  loss: -2.0000  grad_norm:  0.0000  memory: 15.73GiB(33.12%)  tps: 7,533  tflops: 57.37  mfu: 18.39%
[rank0]:2025-11-02 01:36:08,893 - INFO -  step: 1850  loss: -2.0000  grad_norm:  0.0000  memory: 16.79GiB(35.34%)  tps: 7,531  tflops: 57.36  mfu: 18.38%
[rank2]:2025-11-02 01:36:08,891 - INFO -  step: 1850  loss: -2.0000  grad_norm:  0.0000  memory: 12.14GiB(25.55%)  tps: 7,536  tflops: 57.40  mfu: 18.40%
[rank3]:2025-11-02 01:36:08,925 - INFO -  step: 1850  loss:  0.2863  grad_norm:  0.0977  memory: 31.90GiB(67.15%)  tps: 7,530  tflops: 57.35  mfu: 18.38%
[rank0]:2025-11-02 01:37:01,956 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-02 01:37:02,545 - INFO - Avg. fwd time: 8.7507 / Avg. bwd time: 9.1485 / Avg. batch time: 532.3489 (ms) / GPU bubble ratio: 73.10%
[rank2]:2025-11-02 01:37:02,772 - INFO - Avg. fwd time: 8.1661 / Avg. bwd time: 9.7284 / Avg. batch time: 480.8931 (ms) / GPU bubble ratio: 70.23%
[rank3]:2025-11-02 01:37:02,797 - INFO - Avg. fwd time: 10.9207 / Avg. bwd time: 38.8997 / Avg. batch time: 458.6848 (ms) / GPU bubble ratio: 13.11%
[rank1]:2025-11-02 01:37:02,857 - INFO - Avg. fwd time: 10.1422 / Avg. bwd time: 15.4279 / Avg. batch time: 510.5769 (ms) / GPU bubble ratio: 59.94%
[rank2]:2025-11-02 01:37:03,026 - INFO -  step: 1900  loss: -2.0000  grad_norm:  0.0000  memory: 12.14GiB(25.55%)  tps: 7,566  tflops: 57.63  mfu: 18.47%
[rank1]:2025-11-02 01:37:03,027 - INFO -  step: 1900  loss: -2.0000  grad_norm:  0.0000  memory: 15.73GiB(33.12%)  tps: 7,566  tflops: 57.63  mfu: 18.47%
[rank0]:2025-11-02 01:37:03,027 - INFO -  step: 1900  loss: -2.0000  grad_norm:  0.0000  memory: 16.79GiB(35.34%)  tps: 7,566  tflops: 57.63  mfu: 18.47%
[rank2]:2025-11-02 01:37:03,141 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251102_0137_stage2_step1900.svg
[rank3]:2025-11-02 01:37:03,062 - INFO -  step: 1900  loss:  0.1797  grad_norm:  0.0656  memory: 31.90GiB(67.15%)  tps: 7,566  tflops: 57.63  mfu: 18.47%
[rank1]:2025-11-02 01:37:03,141 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251102_0137_stage1_step1900.svg
[rank0]:2025-11-02 01:37:03,146 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251102_0137_stage0_step1900.svg
[rank3]:2025-11-02 01:37:03,253 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/pipeline_schedule/251102_0137_real_step1900_rank3.svg
[rank3]:> Batch Time: 460.50 ms, GPU Bubble Ratio: 84.15%, 63.04%, 71.35%, 10.30%
[rank3]:2025-11-02 01:37:03,329 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251102_0137_stage3_step1900.svg
[rank0]:2025-11-02 01:37:56,406 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 01:37:57,491 - INFO -  step: 1950  loss: -2.0000  grad_norm:  0.0000  memory: 12.14GiB(25.55%)  tps: 7,520  tflops: 57.28  mfu: 18.36%
[rank3]:2025-11-02 01:37:57,522 - INFO -  step: 1950  loss:  0.1744  grad_norm:  0.0745  memory: 31.90GiB(67.15%)  tps: 7,521  tflops: 57.28  mfu: 18.36%
[rank1]:2025-11-02 01:37:57,491 - INFO -  step: 1950  loss: -2.0000  grad_norm:  0.0000  memory: 15.73GiB(33.12%)  tps: 7,521  tflops: 57.28  mfu: 18.36%
[rank0]:2025-11-02 01:37:57,492 - INFO -  step: 1950  loss: -2.0000  grad_norm:  0.0000  memory: 16.79GiB(35.34%)  tps: 7,520  tflops: 57.28  mfu: 18.36%
[rank0]:2025-11-02 01:38:50,627 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-02 01:38:51,231 - INFO - Avg. fwd time: 8.7704 / Avg. bwd time: 8.6671 / Avg. batch time: 532.1965 (ms) / GPU bubble ratio: 73.79%
[rank2]:2025-11-02 01:38:51,463 - INFO - Avg. fwd time: 8.1798 / Avg. bwd time: 9.6407 / Avg. batch time: 481.5151 (ms) / GPU bubble ratio: 70.39%
[rank3]:2025-11-02 01:38:51,489 - INFO - Avg. fwd time: 10.9119 / Avg. bwd time: 38.9992 / Avg. batch time: 459.3886 (ms) / GPU bubble ratio: 13.08%
[rank1]:2025-11-02 01:38:51,550 - INFO - Avg. fwd time: 10.1794 / Avg. bwd time: 15.1642 / Avg. batch time: 510.9263 (ms) / GPU bubble ratio: 60.32%
[rank0]:2025-11-02 01:38:51,729 - INFO -  step: 2000  loss: -2.0000  grad_norm:  0.0000  memory: 16.79GiB(35.34%)  tps: 7,552  tflops: 57.52  mfu: 18.44%
[rank0]:2025-11-02 01:38:51,729 - INFO - ðŸ”Ž  Running validation at step 2000
[rank2]:2025-11-02 01:38:51,727 - INFO -  step: 2000  loss: -2.0000  grad_norm:  0.0000  memory: 12.14GiB(25.55%)  tps: 7,552  tflops: 57.52  mfu: 18.44%
[rank2]:2025-11-02 01:38:51,727 - INFO - ðŸ”Ž  Running validation at step 2000
[rank3]:2025-11-02 01:38:51,763 - INFO -  step: 2000  loss:  0.2262  grad_norm:  0.1108  memory: 31.90GiB(67.15%)  tps: 7,552  tflops: 57.52  mfu: 18.43%
[rank3]:2025-11-02 01:38:51,763 - INFO - ðŸ”Ž  Running validation at step 2000
[rank1]:2025-11-02 01:38:51,729 - INFO -  step: 2000  loss: -2.0000  grad_norm:  0.0000  memory: 15.73GiB(33.12%)  tps: 7,552  tflops: 57.52  mfu: 18.44%
[rank1]:2025-11-02 01:38:51,729 - INFO - ðŸ”Ž  Running validation at step 2000
[rank0]:2025-11-02 01:39:11,337 - INFO - validate step: 2000  loss: -1.0000  memory: 16.79GiB(35.34%)  tps: 20,890
[rank2]:2025-11-02 01:39:11,373 - INFO - validate step: 2000  loss: -1.0000  memory: 12.14GiB(25.55%)  tps: 20,849
[rank3]:2025-11-02 01:39:11,365 - INFO - validate step: 2000  loss:  0.9475  memory: 31.90GiB(67.15%)  tps: 20,897
[rank1]:2025-11-02 01:39:11,355 - INFO - validate step: 2000  loss: -1.0000  memory: 15.73GiB(33.12%)  tps: 20,870
[rank0]:2025-11-02 01:39:11,455 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251102_0139_stage0_step2000.svg
[rank2]:2025-11-02 01:39:11,461 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251102_0139_stage2_step2000.svg
[rank1]:2025-11-02 01:39:11,457 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251102_0139_stage1_step2000.svg
[rank3]:2025-11-02 01:39:11,551 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/pipeline_schedule/251102_0139_real_step2000_rank3.svg
[rank3]:> Batch Time: 462.49 ms, GPU Bubble Ratio: 84.22%, 63.24%, 71.50%, 10.28%
[rank3]:2025-11-02 01:39:11,624 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251102_0139_stage3_step2000.svg
[rank0]:2025-11-02 01:40:04,610 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-11-02 01:40:05,675 - INFO -  step: 2050  loss: -2.0000  grad_norm:  0.0000  memory: 12.14GiB(25.55%)  tps: 7,543  tflops: 57.45  mfu: 18.41%
[rank1]:2025-11-02 01:40:05,677 - INFO -  step: 2050  loss: -2.0000  grad_norm:  0.0000  memory: 15.73GiB(33.12%)  tps: 7,540  tflops: 57.43  mfu: 18.41%
[rank0]:2025-11-02 01:40:05,677 - INFO -  step: 2050  loss: -2.0000  grad_norm:  0.0000  memory: 16.79GiB(35.34%)  tps: 7,538  tflops: 57.41  mfu: 18.40%
[rank3]:2025-11-02 01:40:05,710 - INFO -  step: 2050  loss:  0.2135  grad_norm:  0.0711  memory: 31.90GiB(67.15%)  tps: 7,537  tflops: 57.41  mfu: 18.40%
[rank0]:2025-11-02 01:40:58,765 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 01:40:59,846 - INFO - Avg. fwd time: 8.1923 / Avg. bwd time: 9.5621 / Avg. batch time: 482.0417 (ms) / GPU bubble ratio: 70.53%
[rank3]:2025-11-02 01:40:59,828 - INFO - Avg. fwd time: 10.9043 / Avg. bwd time: 39.0843 / Avg. batch time: 459.9894 (ms) / GPU bubble ratio: 13.06%
[rank1]:2025-11-02 01:40:59,866 - INFO - Avg. fwd time: 10.2134 / Avg. bwd time: 14.9272 / Avg. batch time: 511.2098 (ms) / GPU bubble ratio: 60.66%
[rank1]:2025-11-02 01:40:59,877 - INFO -  step: 2100  loss: -2.0000  grad_norm:  0.0000  memory: 15.73GiB(33.12%)  tps: 7,557  tflops: 57.56  mfu: 18.45%
[rank0]:2025-11-02 01:40:59,876 - INFO - Avg. fwd time: 8.7885 / Avg. bwd time: 8.2339 / Avg. batch time: 532.0306 (ms) / GPU bubble ratio: 74.40%
[rank0]:2025-11-02 01:40:59,878 - INFO -  step: 2100  loss: -2.0000  grad_norm:  0.0000  memory: 16.79GiB(35.34%)  tps: 7,557  tflops: 57.56  mfu: 18.45%
[rank2]:2025-11-02 01:40:59,877 - INFO -  step: 2100  loss: -2.0000  grad_norm:  0.0000  memory: 12.14GiB(25.55%)  tps: 7,557  tflops: 57.56  mfu: 18.45%
[rank3]:2025-11-02 01:40:59,908 - INFO -  step: 2100  loss:  0.2595  grad_norm:  0.1085  memory: 31.90GiB(67.15%)  tps: 7,558  tflops: 57.56  mfu: 18.45%
[rank0]:2025-11-02 01:40:59,981 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251102_0140_stage0_step2100.svg
[rank2]:2025-11-02 01:40:59,989 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251102_0140_stage2_step2100.svg
[rank1]:2025-11-02 01:40:59,980 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251102_0140_stage1_step2100.svg
[rank3]:2025-11-02 01:41:00,096 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/pipeline_schedule/251102_0140_real_step2100_rank3.svg
[rank3]:> Batch Time: 459.69 ms, GPU Bubble Ratio: 84.11%, 62.98%, 71.29%, 10.24%
[rank3]:2025-11-02 01:41:00,165 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251102_0140_stage3_step2100.svg
[rank0]:2025-11-02 01:41:53,068 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-02 01:41:54,149 - INFO -  step: 2150  loss: -2.0000  grad_norm:  0.0000  memory: 16.79GiB(35.34%)  tps: 7,547  tflops: 57.48  mfu: 18.42%
[rank2]:2025-11-02 01:41:54,148 - INFO -  step: 2150  loss: -2.0000  grad_norm:  0.0000  memory: 12.14GiB(25.55%)  tps: 7,547  tflops: 57.48  mfu: 18.42%
[rank3]:2025-11-02 01:41:54,182 - INFO -  step: 2150  loss:  0.2318  grad_norm:  0.0864  memory: 31.90GiB(67.15%)  tps: 7,547  tflops: 57.48  mfu: 18.42%
[rank1]:2025-11-02 01:41:54,149 - INFO -  step: 2150  loss: -2.0000  grad_norm:  0.0000  memory: 15.73GiB(33.12%)  tps: 7,547  tflops: 57.48  mfu: 18.42%
[rank0]:2025-11-02 01:42:47,155 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-02 01:42:47,763 - INFO - Avg. fwd time: 8.8024 / Avg. bwd time: 7.8956 / Avg. batch time: 531.8815 (ms) / GPU bubble ratio: 74.88%
[rank2]:2025-11-02 01:42:47,993 - INFO - Avg. fwd time: 8.2020 / Avg. bwd time: 9.5006 / Avg. batch time: 482.4365 (ms) / GPU bubble ratio: 70.64%
[rank3]:2025-11-02 01:42:48,019 - INFO - Avg. fwd time: 10.8989 / Avg. bwd time: 39.1476 / Avg. batch time: 460.4361 (ms) / GPU bubble ratio: 13.05%
[rank1]:2025-11-02 01:42:48,080 - INFO - Avg. fwd time: 10.2396 / Avg. bwd time: 14.7421 / Avg. batch time: 511.4136 (ms) / GPU bubble ratio: 60.92%
[rank0]:2025-11-02 01:42:48,257 - INFO -  step: 2200  loss: -2.0000  grad_norm:  0.0000  memory: 16.79GiB(35.34%)  tps: 7,570  tflops: 57.66  mfu: 18.48%
[rank0]:2025-11-02 01:42:48,257 - INFO - ðŸ”Ž  Running validation at step 2200
[rank3]:2025-11-02 01:42:48,291 - INFO -  step: 2200  loss:  0.2505  grad_norm:  0.1041  memory: 31.90GiB(67.15%)  tps: 7,570  tflops: 57.66  mfu: 18.48%
[rank3]:2025-11-02 01:42:48,292 - INFO - ðŸ”Ž  Running validation at step 2200
[rank2]:2025-11-02 01:42:48,255 - INFO -  step: 2200  loss: -2.0000  grad_norm:  0.0000  memory: 12.14GiB(25.55%)  tps: 7,570  tflops: 57.66  mfu: 18.48%
[rank2]:2025-11-02 01:42:48,256 - INFO - ðŸ”Ž  Running validation at step 2200
[rank1]:2025-11-02 01:42:48,257 - INFO -  step: 2200  loss: -2.0000  grad_norm:  0.0000  memory: 15.73GiB(33.12%)  tps: 7,570  tflops: 57.66  mfu: 18.48%
[rank1]:2025-11-02 01:42:48,257 - INFO - ðŸ”Ž  Running validation at step 2200
[rank0]:2025-11-02 01:43:07,809 - INFO - validate step: 2200  loss: -1.0000  memory: 16.79GiB(35.34%)  tps: 20,950
[rank1]:2025-11-02 01:43:07,826 - INFO - validate step: 2200  loss: -1.0000  memory: 15.73GiB(33.12%)  tps: 20,931
[rank2]:2025-11-02 01:43:07,844 - INFO - validate step: 2200  loss: -1.0000  memory: 12.14GiB(25.55%)  tps: 20,911
[rank2]:2025-11-02 01:43:07,916 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251102_0143_stage2_step2200.svg
[rank3]:2025-11-02 01:43:07,836 - INFO - validate step: 2200  loss:  0.9445  memory: 31.90GiB(67.15%)  tps: 20,958
[rank1]:2025-11-02 01:43:07,916 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251102_0143_stage1_step2200.svg
[rank0]:2025-11-02 01:43:07,917 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251102_0143_stage0_step2200.svg
[rank3]:2025-11-02 01:43:08,022 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/pipeline_schedule/251102_0143_real_step2200_rank3.svg
[rank3]:> Batch Time: 458.37 ms, GPU Bubble Ratio: 84.08%, 62.88%, 71.20%, 10.29%
[rank3]:2025-11-02 01:43:08,087 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251102_0143_stage3_step2200.svg
[rank0]:2025-11-02 01:44:01,085 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-11-02 01:44:02,161 - INFO -  step: 2250  loss: -2.0000  grad_norm:  0.0000  memory: 16.79GiB(35.34%)  tps: 7,536  tflops: 57.40  mfu: 18.40%
[rank3]:2025-11-02 01:44:02,192 - INFO -  step: 2250  loss:  0.2355  grad_norm:  0.1032  memory: 31.90GiB(67.15%)  tps: 7,536  tflops: 57.39  mfu: 18.40%
[rank2]:2025-11-02 01:44:02,160 - INFO -  step: 2250  loss: -2.0000  grad_norm:  0.0000  memory: 12.14GiB(25.55%)  tps: 7,541  tflops: 57.43  mfu: 18.41%
[rank1]:2025-11-02 01:44:02,160 - INFO -  step: 2250  loss: -2.0000  grad_norm:  0.0000  memory: 15.73GiB(33.12%)  tps: 7,539  tflops: 57.42  mfu: 18.40%
[rank0]:2025-11-02 01:44:55,230 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-02 01:44:55,823 - INFO - Avg. fwd time: 8.8173 / Avg. bwd time: 7.5344 / Avg. batch time: 531.7454 (ms) / GPU bubble ratio: 75.40%
[rank2]:2025-11-02 01:44:56,049 - INFO - Avg. fwd time: 8.2124 / Avg. bwd time: 9.4352 / Avg. batch time: 482.8801 (ms) / GPU bubble ratio: 70.76%
[rank3]:2025-11-02 01:44:56,075 - INFO - Avg. fwd time: 10.8940 / Avg. bwd time: 39.2178 / Avg. batch time: 460.9435 (ms) / GPU bubble ratio: 13.03%
[rank1]:2025-11-02 01:44:56,135 - INFO - Avg. fwd time: 10.2680 / Avg. bwd time: 14.5447 / Avg. batch time: 511.6533 (ms) / GPU bubble ratio: 61.20%
[rank0]:2025-11-02 01:44:56,307 - INFO -  step: 2300  loss: -2.0000  grad_norm:  0.0000  memory: 16.79GiB(35.34%)  tps: 7,565  tflops: 57.62  mfu: 18.47%
[rank3]:2025-11-02 01:44:56,340 - INFO -  step: 2300  loss:  0.2296  grad_norm:  0.0907  memory: 31.90GiB(67.15%)  tps: 7,565  tflops: 57.61  mfu: 18.47%
[rank2]:2025-11-02 01:44:56,305 - INFO -  step: 2300  loss: -2.0000  grad_norm:  0.0000  memory: 12.14GiB(25.55%)  tps: 7,565  tflops: 57.62  mfu: 18.47%
[rank1]:2025-11-02 01:44:56,307 - INFO -  step: 2300  loss: -2.0000  grad_norm:  0.0000  memory: 15.73GiB(33.12%)  tps: 7,565  tflops: 57.61  mfu: 18.47%
[rank0]:2025-11-02 01:44:56,415 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251102_0144_stage0_step2300.svg
[rank2]:2025-11-02 01:44:56,413 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251102_0144_stage2_step2300.svg
[rank1]:2025-11-02 01:44:56,413 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251102_0144_stage1_step2300.svg
[rank3]:2025-11-02 01:44:56,519 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/pipeline_schedule/251102_0144_real_step2300_rank3.svg
[rank3]:> Batch Time: 459.24 ms, GPU Bubble Ratio: 84.08%, 62.93%, 71.27%, 10.31%
[rank3]:2025-11-02 01:44:56,586 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251102_0144_stage3_step2300.svg
[rank0]:2025-11-02 01:45:49,297 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 01:45:50,410 - INFO -  step: 2350  loss:  0.2315  grad_norm:  0.0711  memory: 31.90GiB(67.15%)  tps: 7,576  tflops: 57.70  mfu: 18.49%
[rank0]:2025-11-02 01:45:50,377 - INFO -  step: 2350  loss: -2.0000  grad_norm:  0.0000  memory: 16.79GiB(35.34%)  tps: 7,575  tflops: 57.70  mfu: 18.49%
[rank2]:2025-11-02 01:45:50,375 - INFO -  step: 2350  loss: -2.0000  grad_norm:  0.0000  memory: 12.14GiB(25.55%)  tps: 7,575  tflops: 57.70  mfu: 18.49%
[rank1]:2025-11-02 01:45:50,377 - INFO -  step: 2350  loss: -2.0000  grad_norm:  0.0000  memory: 15.73GiB(33.12%)  tps: 7,575  tflops: 57.70  mfu: 18.49%
[rank0]:2025-11-02 01:46:43,219 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 01:46:44,282 - INFO - Avg. fwd time: 10.8883 / Avg. bwd time: 39.2709 / Avg. batch time: 461.3063 (ms) / GPU bubble ratio: 13.01%
[rank2]:2025-11-02 01:46:44,301 - INFO - Avg. fwd time: 8.2218 / Avg. bwd time: 9.3752 / Avg. batch time: 483.1852 (ms) / GPU bubble ratio: 70.86%
[rank1]:2025-11-02 01:46:44,321 - INFO - Avg. fwd time: 10.2937 / Avg. bwd time: 14.3642 / Avg. batch time: 511.7727 (ms) / GPU bubble ratio: 61.45%
[rank3]:2025-11-02 01:46:44,363 - INFO -  step: 2400  loss:  0.2338  grad_norm:  0.1013  memory: 31.90GiB(67.15%)  tps: 7,592  tflops: 57.82  mfu: 18.53%
[rank3]:2025-11-02 01:46:44,364 - INFO -  final step: 2400  loss:  0.2338  grad_norm:  0.1013  tps: 7,559  tflops: 57.57  mfu: 17.94%
[rank3]:2025-11-02 01:46:44,364 - INFO - ðŸ”Ž  Running validation at step 2400
[rank0]:2025-11-02 01:46:44,331 - INFO - Avg. fwd time: 8.8308 / Avg. bwd time: 7.2049 / Avg. batch time: 531.5224 (ms) / GPU bubble ratio: 75.86%
[rank0]:2025-11-02 01:46:44,334 - INFO -  step: 2400  loss: -2.0000  grad_norm:  0.0000  memory: 16.79GiB(35.34%)  tps: 7,591  tflops: 57.82  mfu: 18.53%
[rank0]:2025-11-02 01:46:44,334 - INFO -  final step: 2400  loss: -2.0000  grad_norm:  0.0000  tps: 7,555  tflops: 57.54  mfu: 17.94%
[rank0]:2025-11-02 01:46:44,334 - INFO - ðŸ”Ž  Running validation at step 2400
[rank2]:2025-11-02 01:46:44,332 - INFO -  step: 2400  loss: -2.0000  grad_norm:  0.0000  memory: 12.14GiB(25.55%)  tps: 7,591  tflops: 57.82  mfu: 18.53%
[rank2]:2025-11-02 01:46:44,333 - INFO -  final step: 2400  loss: -2.0000  grad_norm:  0.0000  tps: 7,556  tflops: 57.55  mfu: 17.94%
[rank2]:2025-11-02 01:46:44,333 - INFO - ðŸ”Ž  Running validation at step 2400
[rank1]:2025-11-02 01:46:44,332 - INFO -  step: 2400  loss: -2.0000  grad_norm:  0.0000  memory: 15.73GiB(33.12%)  tps: 7,591  tflops: 57.82  mfu: 18.53%
[rank1]:2025-11-02 01:46:44,333 - INFO -  final step: 2400  loss: -2.0000  grad_norm:  0.0000  tps: 7,557  tflops: 57.55  mfu: 17.94%
[rank1]:2025-11-02 01:46:44,333 - INFO - ðŸ”Ž  Running validation at step 2400
[rank3]:2025-11-02 01:47:03,866 - INFO - validate step: 2400  loss:  0.9442  memory: 31.90GiB(67.15%)  tps: 21,004
[rank3]:2025-11-02 01:47:03,867 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-11-02 01:47:03,869 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank0]:2025-11-02 01:47:03,838 - INFO - validate step: 2400  loss: -1.0000  memory: 16.79GiB(35.34%)  tps: 21,002
[rank0]:2025-11-02 01:47:03,839 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-02 01:47:03,841 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank2]:2025-11-02 01:47:03,874 - INFO - validate step: 2400  loss: -1.0000  memory: 12.14GiB(25.55%)  tps: 20,961
[rank2]:2025-11-02 01:47:03,875 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-02 01:47:03,876 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank1]:2025-11-02 01:47:03,855 - INFO - validate step: 2400  loss: -1.0000  memory: 15.73GiB(33.12%)  tps: 20,982
[rank1]:2025-11-02 01:47:03,855 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-11-02 01:47:03,857 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank0]:2025-11-02 01:47:06,357 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank2]:2025-11-02 01:47:06,440 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251102_0147_stage2_final2400.svg
[rank1]:2025-11-02 01:47:06,440 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251102_0147_stage1_final2400.svg
[rank0]:2025-11-02 01:47:06,441 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251102_0147_stage0_final2400.svg
[rank3]:2025-11-02 01:47:06,541 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/pipeline_schedule/251102_0147_real_final2400_rank3.svg
[rank3]:> Batch Time: 456.13 ms, GPU Bubble Ratio: 84.09%, 62.80%, 71.13%, 10.30%
[rank1]:2025-11-02 01:47:06,642 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/frozen_params_histogram/251102_0147_rank1_stage1.svg
[rank1]:	> Counts Sum: 1330720, Total Sum: 1526400 (87.18%), Ratio(%) per element: [86.85, 86.91, 86.55, 86.43, 86.73, 86.37, 86.91, 86.55, 86.85, 87.14, 86.79, 87.26, 86.91, 86.96, 86.61, 87.02, 86.96, 87.26, 86.91, 87.61, 87.38, 87.02, 87.26, 87.38, 87.32, 87.32, 87.14, 87.5, 87.32, 87.44, 87.38, 87.26, 87.26, 87.32, 87.5, 86.96, 87.14, 87.79, 87.38, 87.55, 87.73, 87.26, 87.97, 87.85, 87.91]
[rank1]:2025-11-02 01:47:06,642 - INFO - Destroying the purge thread.
[rank3]:2025-11-02 01:47:06,725 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/pipeline_schedule/251102_0147_thry_final2400_rank3.svg
[rank3]:> Batch Time: 321.37 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank0]:2025-11-02 01:47:06,661 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/frozen_params_histogram/251102_0147_rank0_stage0.svg
[rank0]:	> Counts Sum: 1099160, Total Sum: 1255040 (87.58%), Ratio(%) per element: [88.2, 87.02, 87.32, 87.2, 86.91, 87.2, 87.14, 87.32, 86.96, 87.14, 87.14, 87.44, 87.38, 87.61, 87.32, 87.02, 87.32, 87.26, 87.38, 87.73, 87.61, 87.61, 87.38, 87.79, 87.38, 87.79, 87.91, 87.73, 88.44, 88.2, 88.03, 87.91, 88.2, 88.2, 88.08, 88.08, 87.91]
[rank0]:2025-11-02 01:47:06,661 - INFO - Sleeping 2 seconds for other ranks to complete
[rank2]:2025-11-02 01:47:06,656 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/frozen_params_histogram/251102_0147_rank2_stage2.svg
[rank2]:	> Counts Sum: 1060560, Total Sum: 1221120 (86.85%), Ratio(%) per element: [86.73, 86.79, 86.85, 86.73, 86.85, 86.79, 86.73, 86.73, 86.91, 86.91, 86.91, 86.79, 86.85, 86.91, 86.85, 86.73, 86.85, 86.79, 86.85, 86.79, 86.73, 86.91, 86.79, 86.79, 86.79, 86.85, 86.79, 86.91, 87.14, 86.91, 86.91, 86.96, 87.02, 86.91, 86.91, 86.91]
[rank2]:2025-11-02 01:47:06,657 - INFO - Destroying the purge thread.
[rank3]:2025-11-02 01:47:06,792 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251102_0147_stage3_final2400.svg
[rank2]:2025-11-02 01:47:06,839 - INFO - Process group destroyed
[rank1]:2025-11-02 01:47:06,850 - INFO - Process group destroyed
[rank3]:2025-11-02 01:47:06,981 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1/frozen_params_histogram/251102_0147_rank3_stage3.svg
[rank3]:	> Counts Sum: 204840, Total Sum: 983680 (20.82%), Ratio(%) per element: [17.86, 18.21, 17.33, 18.45, 18.21, 18.1, 17.74, 18.63, 18.51, 20.45, 20.22, 20.28, 20.75, 20.63, 20.57, 19.22, 20.81, 20.69, 23.87, 23.7, 22.75, 23.76, 23.34, 22.34, 23.52, 23.23, 23.29, 23.64, 23.64]
[rank3]:2025-11-02 01:47:06,982 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading data
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–…â–„â–…â–„â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–‡â–ˆâ–‡â–…â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–‡â–ˆâ–‡â–…â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 1.08372
[rank3]:wandb:               final/avg_loss 0.23384
[rank3]:wandb:             final/avg_mfu(%) 17.942
[rank3]:wandb:             final/avg_tflops 57.5721
[rank3]:wandb:    final/avg_throughput(tps) 7559.14984
[rank3]:wandb:              final/grad_norm 0.10133
[rank3]:wandb:               final/max_loss 0.23384
[rank3]:wandb:                    grad_norm 0.10133
[rank3]:wandb: loss_metrics/global_avg_loss 0.23384
[rank3]:wandb: loss_metrics/global_max_loss 0.23384
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1031_GPipe_timelyauto_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/h6jpsja6
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1031_GPipe_timelyauto_dm1/20251102-0058/wandb/run-20251102_005851-h6jpsja6/logs
[rank3]:2025-11-02 01:47:08,558 - INFO - Process group destroyed
[rank0]:2025-11-02 01:47:08,661 - INFO - Training completed
[rank0]:2025-11-02 01:47:08,662 - INFO - Destroying the purge thread.
[rank0]:2025-11-02 01:47:08,906 - INFO - Process group destroyed
[rank2]:Stage 2: Modules to keep: {'layers.10', 'layers.11', 'layers.12', 'layers.9'}
[rank0]:Stage 0: Modules to keep: {'layers.0', 'layers.3', 'layers.1', 'layers.2', 'tok_embeddings'}
[rank1]:Stage 1: Modules to keep: {'layers.5', 'layers.7', 'layers.8', 'layers.4', 'layers.6'}
[rank3]:Stage 3: Modules to keep: {'layers.15', 'layers.13', 'layers.14', 'output', 'norm'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1029_llama1b/config_1031.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16 autocast
[rank3]:+ more freezing in autofreeze mode. 
[rank3]:+ lr_scheduler min_lr = 0 -> 1e-6, cosine decay.
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1031_GPipe_timelyauto_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1031_GPipe_timelyauto_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1031_GPipe_timelyauto_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1031_GPipe_timelyauto_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1031_GPipe_timelyauto_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1031_GPipe_timelyauto_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B-Instruct
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 1e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 300
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: alpaca
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 512
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 2400
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: GPipe
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 4
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1031_GPipe_timelyauto_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B-Instruct/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1031_GPipe_timelyauto_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: True
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: timelyauto
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- threshold: 0.05
[rank3]:		- percentile: 70
[rank3]:
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
