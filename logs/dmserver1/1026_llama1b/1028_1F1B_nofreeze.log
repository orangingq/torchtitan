
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 10. 28. (í™”) 11:52:52 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 3,4,5,6
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1026_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1026_llama1b/1028_1F1B_nofreeze.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs
âœ”ï¸Running with nofreeze x 1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1026_llama1b/config.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs" --parallelism.pipeline_parallel_degree=4  --freezing.no-freeze
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank2]:2025-10-28 11:52:58,984 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs"
[rank3]:2025-10-28 11:52:59,007 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs"
[rank0]:2025-10-28 11:52:59,126 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs"
[rank1]:2025-10-28 11:52:59,054 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs"
[rank2]:2025-10-28 11:52:59,736 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-10-28 11:52:59,738 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-10-28 11:52:59,729 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-10-28 11:52:59,733 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-28 11:52:59,753 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-10-28 11:52:59,758 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-28 11:52:59,763 - INFO - [GC] Initial GC collection 0.00 seconds
[rank2]:2025-10-28 11:52:59,742 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-10-28 11:52:59,743 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-28 11:53:00,096 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-10-28 11:53:00,482 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank0]:2025-10-28 11:53:03,383 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=512, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank1]:2025-10-28 11:53:03,491 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-10-28 11:53:03,530 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-10-28 11:53:03,545 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-10-28 11:53:03,570 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-10-28 11:53:03,572 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-10-28 11:53:03,598 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-10-28 11:53:03,598 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2025-10-28 11:53:03,557 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-10-28 11:53:03,557 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank2]:2025-10-28 11:53:03,742 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-10-28 11:53:03,739 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-10-28 11:53:03,739 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-10-28 11:53:03,740 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank2]:2025-10-28 11:53:03,785 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-10-28 11:53:03,810 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-10-28 11:53:03,810 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2025-10-28 11:53:03,779 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-10-28 11:53:03,779 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-10-28 11:53:03,780 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank2]:2025-10-28 11:53:03,991 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-10-28 11:53:03,991 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-10-28 11:53:03,992 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run 24d49jfr
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data3/shcho/torchtitan/tb/1028_1F1B_nofreeze_dm1/20251028-1153/wandb/run-20251028_115304-24d49jfr
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1028_1F1B_nofreeze_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/24d49jfr
[rank3]:2025-10-28 11:53:05,569 - INFO - WandB logging enabled
[rank3]:2025-10-28 11:53:05,570 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-10-28 11:53:05,608 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-10-28 11:53:05,637 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-10-28 11:53:05,637 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2025-10-28 11:53:05,835 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data3/shcho/torchtitan/checkpoint/1028_1F1B_nofreeze_dm1
[rank0]:2025-10-28 11:53:05,835 - WARNING - Mixed precision training with TP or PP is only supported when FSDP/HSDP/CP is enabled.
[rank0]:2025-10-28 11:53:05,835 - INFO - Mixed precision training is disabled
[rank0]:2025-10-28 11:53:05,836 - INFO - Preparing c4_validation dataset from allenai/c4
[rank3]:2025-10-28 11:53:05,818 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-10-28 11:53:05,819 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-10-28 11:53:05,820 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank0]:2025-10-28 11:53:11,457 - INFO - Trainer is initialized with local batch size 32, global batch size 64, gradient accumulation steps 2, sequence length 512, total steps 1600 (warmup 100)
[rank0]:2025-10-28 11:53:11,457 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B-Instruct/original_dcp.
[rank0]:2025-10-28 11:53:14,390 - INFO - [GC] GC collection for checkpoint loading. 0.01 seconds
[rank0]:2025-10-28 11:53:14,390 - INFO - Finished loading the checkpoint in 2.93 seconds.
[rank0]:2025-10-28 11:53:14,390 - INFO - Training starts at step 1
[rank0]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/autograd/graph.py:849: UserWarning: Attempting to run cuBLAS, but there was no current CUDA context! Attempting to set the primary context... (Triggered internally at /pytorch/aten/src/ATen/cuda/CublasHandlePool.cpp:270.)
[rank0]:  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
[rank2]:2025-10-28 11:53:23,943 - INFO -  step:  1  loss: -2.0000  grad_norm: 95.1855  memory:  5.39GiB(11.36%)  tps: 406  tflops: 3.10  mfu: 0.99%
[rank2]:2025-10-28 11:53:23,943 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-28 11:53:23,952 - INFO -  step:  1  loss:  9.0107  grad_norm: 95.1855  memory: 20.74GiB(43.67%)  tps: 447  tflops: 3.40  mfu: 1.09%
[rank3]:2025-10-28 11:53:23,952 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-10-28 11:53:23,946 - INFO -  step:  1  loss: -2.0000  grad_norm: 95.1855  memory:  8.46GiB(17.81%)  tps: 401  tflops: 3.06  mfu: 0.98%
[rank1]:2025-10-28 11:53:23,946 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-10-28 11:53:23,981 - INFO -  step:  1  loss: -2.0000  grad_norm: 95.1855  memory: 11.08GiB(23.32%)  tps: 401  tflops: 3.06  mfu: 0.98%
[rank0]:2025-10-28 11:53:23,982 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-28 11:53:40,888 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 11:53:40,889 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 11:53:40,890 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 11:53:40,890 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 11:53:40,890 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 11:53:40,890 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 11:53:40,891 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 11:53:40,891 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 11:53:40,891 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 11:53:40,891 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 11:53:40,892 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 11:53:40,892 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 11:53:40,892 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 11:53:40,893 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 11:53:40,893 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 11:53:40,893 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 11:53:40,946 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 11:53:40,946 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 11:53:40,946 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 11:53:40,946 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 11:53:40,947 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 11:53:40,947 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 11:53:40,947 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 11:53:40,947 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 11:53:40,947 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 11:53:40,947 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 11:53:40,947 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 11:53:40,947 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 11:53:40,948 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 11:53:40,948 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 11:53:40,948 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 11:53:40,948 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 11:53:41,084 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 11:53:41,084 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 11:53:41,084 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 11:53:41,084 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 11:53:41,084 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 11:53:41,084 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 11:53:41,084 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 11:53:41,084 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 11:53:41,084 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 11:53:41,084 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 11:53:41,084 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 11:53:41,084 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 11:53:41,084 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 11:53:41,084 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 11:53:41,084 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 11:53:41,084 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 11:53:41,022 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 11:53:41,022 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 11:53:41,022 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 11:53:41,022 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 11:53:41,022 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 11:53:41,022 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 11:53:41,022 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 11:53:41,022 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 11:53:41,022 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 11:53:41,022 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 11:53:41,022 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 11:53:41,022 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 11:53:41,022 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 11:53:41,022 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 11:53:41,023 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 11:53:41,023 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 11:54:38,117 - INFO -  step: 20  loss: 10.8312  grad_norm: 62.6723  memory: 24.67GiB(51.93%)  tps: 2,099  tflops: 15.98  mfu: 5.12%
[rank2]:2025-10-28 11:54:38,104 - INFO -  step: 20  loss: -2.0000  grad_norm: 62.6723  memory:  7.21GiB(15.18%)  tps: 2,099  tflops: 15.98  mfu: 5.12%
[rank0]:2025-10-28 11:54:38,124 - INFO -  step: 20  loss: -2.0000  grad_norm: 62.6723  memory: 14.87GiB(31.30%)  tps: 2,099  tflops: 15.99  mfu: 5.12%
[rank1]:2025-10-28 11:54:38,107 - INFO -  step: 20  loss: -2.0000  grad_norm: 62.6723  memory: 10.73GiB(22.58%)  tps: 2,099  tflops: 15.98  mfu: 5.12%
[rank3]:2025-10-28 11:55:57,858 - INFO -  step: 40  loss:  5.6632  grad_norm: 41.4404  memory: 24.67GiB(51.93%)  tps: 2,055  tflops: 15.65  mfu: 5.02%
[rank2]:2025-10-28 11:55:57,845 - INFO -  step: 40  loss: -2.0000  grad_norm: 41.4404  memory:  7.21GiB(15.18%)  tps: 2,055  tflops: 15.65  mfu: 5.02%
[rank0]:2025-10-28 11:55:57,869 - INFO -  step: 40  loss: -2.0000  grad_norm: 41.4404  memory: 14.87GiB(31.30%)  tps: 2,055  tflops: 15.65  mfu: 5.02%
[rank1]:2025-10-28 11:55:57,850 - INFO -  step: 40  loss: -2.0000  grad_norm: 41.4404  memory: 10.73GiB(22.58%)  tps: 2,055  tflops: 15.65  mfu: 5.02%
[rank3]:2025-10-28 11:55:59,716 - INFO - Avg. fwd time: 64.9552 / Avg. bwd time: 131.2441 / Avg. batch time: 1645.6970 (ms) / GPU bubble ratio: 4.62%
[rank2]:2025-10-28 11:55:59,771 - INFO - Avg. fwd time: 33.1491 / Avg. bwd time: 51.4472 / Avg. batch time: 1732.3894 (ms) / GPU bubble ratio: 60.93%
[rank1]:2025-10-28 11:55:59,847 - INFO - Avg. fwd time: 46.8048 / Avg. bwd time: 67.5584 / Avg. batch time: 1845.6853 (ms) / GPU bubble ratio: 50.43%
[rank0]:2025-10-28 11:55:59,913 - INFO - Avg. fwd time: 38.1436 / Avg. bwd time: 57.6257 / Avg. batch time: 1941.7704 (ms) / GPU bubble ratio: 60.54%
[rank0]:2025-10-28 11:56:34,016 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-28 11:57:17,778 - INFO -  step: 60  loss: -2.0000  grad_norm: 31.8438  memory: 14.87GiB(31.30%)  tps: 2,050  tflops: 15.62  mfu: 5.01%
[rank1]:2025-10-28 11:57:17,764 - INFO -  step: 60  loss: -2.0000  grad_norm: 31.8438  memory: 10.73GiB(22.58%)  tps: 2,050  tflops: 15.62  mfu: 5.00%
[rank2]:2025-10-28 11:57:17,758 - INFO -  step: 60  loss: -2.0000  grad_norm: 31.8438  memory:  7.21GiB(15.18%)  tps: 2,050  tflops: 15.62  mfu: 5.00%
[rank3]:2025-10-28 11:57:17,770 - INFO -  step: 60  loss:  8.4777  grad_norm: 31.8438  memory: 24.67GiB(51.93%)  tps: 2,050  tflops: 15.62  mfu: 5.00%
[rank2]:2025-10-28 11:58:37,814 - INFO -  step: 80  loss: -2.0000  grad_norm: 43.2200  memory:  7.21GiB(15.18%)  tps: 2,047  tflops: 15.59  mfu: 5.00%
[rank3]:2025-10-28 11:58:37,826 - INFO -  step: 80  loss:  4.0070  grad_norm: 43.2200  memory: 24.67GiB(51.93%)  tps: 2,047  tflops: 15.59  mfu: 5.00%
[rank0]:2025-10-28 11:58:37,835 - INFO -  step: 80  loss: -2.0000  grad_norm: 43.2200  memory: 14.87GiB(31.30%)  tps: 2,047  tflops: 15.59  mfu: 5.00%
[rank1]:2025-10-28 11:58:37,819 - INFO -  step: 80  loss: -2.0000  grad_norm: 43.2200  memory: 10.73GiB(22.58%)  tps: 2,047  tflops: 15.59  mfu: 5.00%
[rank3]:2025-10-28 11:58:39,736 - INFO - Avg. fwd time: 66.1248 / Avg. bwd time: 132.7392 / Avg. batch time: 1657.3956 (ms) / GPU bubble ratio: 4.01%
[rank2]:2025-10-28 11:58:39,794 - INFO - Avg. fwd time: 33.4676 / Avg. bwd time: 51.8599 / Avg. batch time: 1744.0682 (ms) / GPU bubble ratio: 60.86%
[rank1]:2025-10-28 11:58:39,870 - INFO - Avg. fwd time: 47.4293 / Avg. bwd time: 68.3044 / Avg. batch time: 1858.0560 (ms) / GPU bubble ratio: 50.17%
[rank0]:2025-10-28 11:58:39,930 - INFO - Avg. fwd time: 39.3314 / Avg. bwd time: 58.8300 / Avg. batch time: 1954.7026 (ms) / GPU bubble ratio: 59.83%
[rank0]:2025-10-28 11:59:54,082 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-28 11:59:58,089 - INFO -  step: 100  loss: -2.0000  grad_norm: 61.5395  memory: 10.73GiB(22.58%)  tps: 2,041  tflops: 15.55  mfu: 4.98%
[rank1]:2025-10-28 11:59:58,089 - INFO - ðŸ”Ž  Running validation at step 100
[rank2]:2025-10-28 11:59:58,084 - INFO -  step: 100  loss: -2.0000  grad_norm: 61.5395  memory:  7.21GiB(15.18%)  tps: 2,041  tflops: 15.55  mfu: 4.98%
[rank2]:2025-10-28 11:59:58,084 - INFO - ðŸ”Ž  Running validation at step 100
[rank3]:2025-10-28 11:59:58,096 - INFO -  step: 100  loss:  5.7008  grad_norm: 61.5395  memory: 24.67GiB(51.93%)  tps: 2,041  tflops: 15.55  mfu: 4.98%
[rank3]:2025-10-28 11:59:58,097 - INFO - ðŸ”Ž  Running validation at step 100
[rank0]:2025-10-28 11:59:58,106 - INFO -  step: 100  loss: -2.0000  grad_norm: 61.5395  memory: 14.87GiB(31.30%)  tps: 2,041  tflops: 15.55  mfu: 4.98%
[rank0]:2025-10-28 11:59:58,106 - INFO - ðŸ”Ž  Running validation at step 100
[rank0]:2025-10-28 12:01:09,965 - INFO - validate step: 100  loss: -1.0000  memory: 14.87GiB(31.30%)  tps: 5,700
[rank1]:2025-10-28 12:01:10,047 - INFO - validate step: 100  loss: -1.0000  memory: 10.73GiB(22.58%)  tps: 5,692
[rank2]:2025-10-28 12:01:10,129 - INFO - validate step: 100  loss: -1.0000  memory:  7.21GiB(15.18%)  tps: 5,685
[rank3]:2025-10-28 12:01:10,195 - INFO - validate step: 100  loss:  2.0258  memory: 24.67GiB(51.93%)  tps: 5,681
[rank3]:2025-10-28 12:01:10,421 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_1F1B_nofreeze_dm1/pipeline_schedule/251028_1201_real_step100_rank3.svg
[rank3]:> Batch Time: 1899.23 ms, GPU Bubble Ratio: 57.89%, 50.95%, 63.90%, 15.23%
[rank3]:2025-10-28 12:02:30,376 - INFO -  step: 120  loss:  1.7892  grad_norm: 40.0209  memory: 24.67GiB(51.93%)  tps: 2,043  tflops: 15.56  mfu: 4.99%
[rank1]:2025-10-28 12:02:30,368 - INFO -  step: 120  loss: -2.0000  grad_norm: 40.0209  memory: 10.73GiB(22.58%)  tps: 2,040  tflops: 15.54  mfu: 4.98%
[rank2]:2025-10-28 12:02:30,364 - INFO -  step: 120  loss: -2.0000  grad_norm: 40.0209  memory:  7.21GiB(15.18%)  tps: 2,042  tflops: 15.55  mfu: 4.98%
[rank0]:2025-10-28 12:02:30,386 - INFO -  step: 120  loss: -2.0000  grad_norm: 40.0209  memory: 14.87GiB(31.30%)  tps: 2,037  tflops: 15.52  mfu: 4.97%
[rank3]:2025-10-28 12:02:32,206 - INFO - Avg. fwd time: 66.5271 / Avg. bwd time: 133.3786 / Avg. batch time: 1662.4512 (ms) / GPU bubble ratio: 3.80%
[rank2]:2025-10-28 12:02:32,266 - INFO - Avg. fwd time: 33.5679 / Avg. bwd time: 52.0549 / Avg. batch time: 1749.9202 (ms) / GPU bubble ratio: 60.86%
[rank1]:2025-10-28 12:02:32,341 - INFO - Avg. fwd time: 47.6130 / Avg. bwd time: 68.5820 / Avg. batch time: 1864.2369 (ms) / GPU bubble ratio: 50.14%
[rank0]:2025-10-28 12:02:32,405 - INFO - Avg. fwd time: 39.5062 / Avg. bwd time: 59.1017 / Avg. batch time: 1960.7169 (ms) / GPU bubble ratio: 59.77%
[rank1]:2025-10-28 12:03:50,176 - INFO -  step: 140  loss: -2.0000  grad_norm: 105.9167  memory: 10.73GiB(22.58%)  tps: 2,053  tflops: 15.64  mfu: 5.01%
[rank2]:2025-10-28 12:03:50,172 - INFO -  step: 140  loss: -2.0000  grad_norm: 105.9167  memory:  7.21GiB(15.18%)  tps: 2,053  tflops: 15.64  mfu: 5.01%
[rank3]:2025-10-28 12:03:50,185 - INFO -  step: 140  loss:  2.5169  grad_norm: 105.9167  memory: 24.67GiB(51.93%)  tps: 2,053  tflops: 15.64  mfu: 5.01%
[rank0]:2025-10-28 12:03:50,192 - INFO -  step: 140  loss: -2.0000  grad_norm: 105.9167  memory: 14.87GiB(31.30%)  tps: 2,053  tflops: 15.64  mfu: 5.01%
[rank0]:2025-10-28 12:04:25,997 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-28 12:05:09,858 - INFO -  step: 160  loss:  0.4886  grad_norm: 10.7918  memory: 24.67GiB(51.93%)  tps: 2,056  tflops: 15.66  mfu: 5.02%
[rank0]:2025-10-28 12:05:09,863 - INFO -  step: 160  loss: -2.0000  grad_norm: 10.7918  memory: 14.87GiB(31.30%)  tps: 2,056  tflops: 15.66  mfu: 5.02%
[rank1]:2025-10-28 12:05:09,851 - INFO -  step: 160  loss: -2.0000  grad_norm: 10.7918  memory: 10.73GiB(22.58%)  tps: 2,056  tflops: 15.66  mfu: 5.02%
[rank2]:2025-10-28 12:05:09,846 - INFO -  step: 160  loss: -2.0000  grad_norm: 10.7918  memory:  7.21GiB(15.18%)  tps: 2,056  tflops: 15.66  mfu: 5.02%
[rank3]:2025-10-28 12:05:11,649 - INFO - Avg. fwd time: 66.5888 / Avg. bwd time: 133.5287 / Avg. batch time: 1662.4734 (ms) / GPU bubble ratio: 3.70%
[rank2]:2025-10-28 12:05:11,704 - INFO - Avg. fwd time: 33.5731 / Avg. bwd time: 52.1359 / Avg. batch time: 1749.9461 (ms) / GPU bubble ratio: 60.82%
[rank1]:2025-10-28 12:05:11,773 - INFO - Avg. fwd time: 47.7417 / Avg. bwd time: 68.8147 / Avg. batch time: 1864.3298 (ms) / GPU bubble ratio: 49.98%
[rank0]:2025-10-28 12:05:11,837 - INFO - Avg. fwd time: 39.4135 / Avg. bwd time: 58.9896 / Avg. batch time: 1960.9046 (ms) / GPU bubble ratio: 59.85%
[rank2]:2025-10-28 12:06:29,397 - INFO -  step: 180  loss: -2.0000  grad_norm: 11.8956  memory:  7.21GiB(15.18%)  tps: 2,060  tflops: 15.69  mfu: 5.03%
[rank3]:2025-10-28 12:06:29,409 - INFO -  step: 180  loss:  0.4867  grad_norm: 11.8956  memory: 24.67GiB(51.93%)  tps: 2,060  tflops: 15.69  mfu: 5.03%
[rank0]:2025-10-28 12:06:29,422 - INFO -  step: 180  loss: -2.0000  grad_norm: 11.8956  memory: 14.87GiB(31.30%)  tps: 2,059  tflops: 15.68  mfu: 5.03%
[rank1]:2025-10-28 12:06:29,401 - INFO -  step: 180  loss: -2.0000  grad_norm: 11.8956  memory: 10.73GiB(22.58%)  tps: 2,060  tflops: 15.69  mfu: 5.03%
[rank0]:2025-10-28 12:07:45,030 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-28 12:07:49,069 - INFO -  step: 200  loss:  0.3006  grad_norm:  1.2653  memory: 24.67GiB(51.93%)  tps: 2,057  tflops: 15.66  mfu: 5.02%
[rank3]:2025-10-28 12:07:49,070 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-10-28 12:07:49,076 - INFO -  step: 200  loss: -2.0000  grad_norm:  1.2653  memory: 14.87GiB(31.30%)  tps: 2,057  tflops: 15.67  mfu: 5.02%
[rank0]:2025-10-28 12:07:49,076 - INFO - ðŸ”Ž  Running validation at step 200
[rank1]:2025-10-28 12:07:49,060 - INFO -  step: 200  loss: -2.0000  grad_norm:  1.2653  memory: 10.73GiB(22.58%)  tps: 2,057  tflops: 15.66  mfu: 5.02%
[rank1]:2025-10-28 12:07:49,060 - INFO - ðŸ”Ž  Running validation at step 200
[rank2]:2025-10-28 12:07:49,057 - INFO -  step: 200  loss: -2.0000  grad_norm:  1.2653  memory:  7.21GiB(15.18%)  tps: 2,057  tflops: 15.66  mfu: 5.02%
[rank2]:2025-10-28 12:07:49,057 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-10-28 12:08:58,544 - INFO - validate step: 200  loss: -1.0000  memory: 14.87GiB(31.30%)  tps: 5,896
[rank1]:2025-10-28 12:08:58,624 - INFO - validate step: 200  loss: -1.0000  memory: 10.73GiB(22.58%)  tps: 5,888
[rank2]:2025-10-28 12:08:58,705 - INFO - validate step: 200  loss: -1.0000  memory:  7.21GiB(15.18%)  tps: 5,881
[rank3]:2025-10-28 12:08:58,770 - INFO - validate step: 200  loss:  0.9458  memory: 24.67GiB(51.93%)  tps: 5,877
[rank3]:2025-10-28 12:08:58,981 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_1F1B_nofreeze_dm1/pipeline_schedule/251028_1208_real_step200_rank3.svg
[rank3]:> Batch Time: 1902.72 ms, GPU Bubble Ratio: 58.18%, 50.72%, 63.92%, 15.26%
[rank3]:2025-10-28 12:09:00,686 - INFO - Avg. fwd time: 66.6149 / Avg. bwd time: 133.5818 / Avg. batch time: 1662.1116 (ms) / GPU bubble ratio: 3.64%
[rank2]:2025-10-28 12:09:00,747 - INFO - Avg. fwd time: 33.5570 / Avg. bwd time: 52.1705 / Avg. batch time: 1749.8369 (ms) / GPU bubble ratio: 60.81%
[rank0]:2025-10-28 12:09:00,880 - INFO - Avg. fwd time: 39.2933 / Avg. bwd time: 58.9755 / Avg. batch time: 1960.7867 (ms) / GPU bubble ratio: 59.91%
[rank1]:2025-10-28 12:09:00,815 - INFO - Avg. fwd time: 47.8109 / Avg. bwd time: 68.9132 / Avg. batch time: 1864.2560 (ms) / GPU bubble ratio: 49.91%
[rank0]:2025-10-28 12:10:18,781 - INFO -  step: 220  loss: -2.0000  grad_norm:  1.8825  memory: 14.87GiB(31.30%)  tps: 2,042  tflops: 15.55  mfu: 4.98%
[rank1]:2025-10-28 12:10:18,764 - INFO -  step: 220  loss: -2.0000  grad_norm:  1.8825  memory: 10.73GiB(22.58%)  tps: 2,044  tflops: 15.57  mfu: 4.99%
[rank2]:2025-10-28 12:10:18,761 - INFO -  step: 220  loss: -2.0000  grad_norm:  1.8825  memory:  7.21GiB(15.18%)  tps: 2,047  tflops: 15.59  mfu: 5.00%
[rank3]:2025-10-28 12:10:18,773 - INFO -  step: 220  loss:  0.2921  grad_norm:  1.8825  memory: 24.67GiB(51.93%)  tps: 2,048  tflops: 15.60  mfu: 5.00%
[rank3]:2025-10-28 12:11:38,841 - INFO -  step: 240  loss:  0.3182  grad_norm:  0.8144  memory: 24.67GiB(51.93%)  tps: 2,046  tflops: 15.59  mfu: 5.00%
[rank0]:2025-10-28 12:11:38,849 - INFO -  step: 240  loss: -2.0000  grad_norm:  0.8144  memory: 14.87GiB(31.30%)  tps: 2,046  tflops: 15.58  mfu: 5.00%
[rank1]:2025-10-28 12:11:38,833 - INFO -  step: 240  loss: -2.0000  grad_norm:  0.8144  memory: 10.73GiB(22.58%)  tps: 2,046  tflops: 15.58  mfu: 5.00%
[rank2]:2025-10-28 12:11:38,829 - INFO -  step: 240  loss: -2.0000  grad_norm:  0.8144  memory:  7.21GiB(15.18%)  tps: 2,046  tflops: 15.58  mfu: 5.00%
[rank3]:2025-10-28 12:11:40,645 - INFO - Avg. fwd time: 66.6772 / Avg. bwd time: 133.7276 / Avg. batch time: 1663.1091 (ms) / GPU bubble ratio: 3.60%
[rank2]:2025-10-28 12:11:40,701 - INFO - Avg. fwd time: 33.5467 / Avg. bwd time: 52.2054 / Avg. batch time: 1750.8297 (ms) / GPU bubble ratio: 60.82%
[rank1]:2025-10-28 12:11:40,770 - INFO - Avg. fwd time: 47.8775 / Avg. bwd time: 69.0970 / Avg. batch time: 1865.4475 (ms) / GPU bubble ratio: 49.84%
[rank0]:2025-10-28 12:11:40,834 - INFO - Avg. fwd time: 39.2202 / Avg. bwd time: 58.9933 / Avg. batch time: 1962.0069 (ms) / GPU bubble ratio: 59.95%
[rank0]:2025-10-28 12:12:14,955 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-28 12:12:59,012 - INFO -  step: 260  loss: -2.0000  grad_norm:  0.7113  memory: 10.73GiB(22.58%)  tps: 2,043  tflops: 15.56  mfu: 4.99%
[rank2]:2025-10-28 12:12:59,009 - INFO -  step: 260  loss: -2.0000  grad_norm:  0.7113  memory:  7.21GiB(15.18%)  tps: 2,043  tflops: 15.56  mfu: 4.99%
[rank3]:2025-10-28 12:12:59,022 - INFO -  step: 260  loss:  0.2917  grad_norm:  0.7113  memory: 24.67GiB(51.93%)  tps: 2,043  tflops: 15.56  mfu: 4.99%
[rank0]:2025-10-28 12:12:59,029 - INFO -  step: 260  loss: -2.0000  grad_norm:  0.7113  memory: 14.87GiB(31.30%)  tps: 2,043  tflops: 15.56  mfu: 4.99%
[rank2]:2025-10-28 12:14:19,313 - INFO -  step: 280  loss: -2.0000  grad_norm:  0.8233  memory:  7.21GiB(15.18%)  tps: 2,040  tflops: 15.54  mfu: 4.98%
[rank3]:2025-10-28 12:14:19,325 - INFO -  step: 280  loss:  0.2677  grad_norm:  0.8233  memory: 24.67GiB(51.93%)  tps: 2,040  tflops: 15.54  mfu: 4.98%
[rank0]:2025-10-28 12:14:19,337 - INFO -  step: 280  loss: -2.0000  grad_norm:  0.8233  memory: 14.87GiB(31.30%)  tps: 2,040  tflops: 15.54  mfu: 4.98%
[rank1]:2025-10-28 12:14:19,320 - INFO -  step: 280  loss: -2.0000  grad_norm:  0.8233  memory: 10.73GiB(22.58%)  tps: 2,040  tflops: 15.54  mfu: 4.98%
[rank3]:2025-10-28 12:14:21,164 - INFO - Avg. fwd time: 66.7625 / Avg. bwd time: 133.9015 / Avg. batch time: 1664.7120 (ms) / GPU bubble ratio: 3.57%
[rank2]:2025-10-28 12:14:21,224 - INFO - Avg. fwd time: 33.5645 / Avg. bwd time: 52.2643 / Avg. batch time: 1752.4580 (ms) / GPU bubble ratio: 60.82%
[rank1]:2025-10-28 12:14:21,300 - INFO - Avg. fwd time: 47.9512 / Avg. bwd time: 69.2107 / Avg. batch time: 1867.2896 (ms) / GPU bubble ratio: 49.80%
[rank0]:2025-10-28 12:14:21,365 - INFO - Avg. fwd time: 39.2229 / Avg. bwd time: 59.0259 / Avg. batch time: 1963.8743 (ms) / GPU bubble ratio: 59.98%
[rank0]:2025-10-28 12:15:35,908 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-28 12:15:39,899 - INFO -  step: 300  loss: -2.0000  grad_norm:  0.4773  memory: 10.73GiB(22.58%)  tps: 2,033  tflops: 15.49  mfu: 4.96%
[rank1]:2025-10-28 12:15:39,899 - INFO - ðŸ”Ž  Running validation at step 300
[rank2]:2025-10-28 12:15:39,895 - INFO -  step: 300  loss: -2.0000  grad_norm:  0.4773  memory:  7.21GiB(15.18%)  tps: 2,033  tflops: 15.49  mfu: 4.96%
[rank2]:2025-10-28 12:15:39,895 - INFO - ðŸ”Ž  Running validation at step 300
[rank3]:2025-10-28 12:15:39,907 - INFO -  step: 300  loss:  0.2256  grad_norm:  0.4773  memory: 24.67GiB(51.93%)  tps: 2,033  tflops: 15.49  mfu: 4.96%
[rank3]:2025-10-28 12:15:39,907 - INFO - ðŸ”Ž  Running validation at step 300
[rank0]:2025-10-28 12:15:39,916 - INFO -  step: 300  loss: -2.0000  grad_norm:  0.4773  memory: 14.87GiB(31.30%)  tps: 2,033  tflops: 15.49  mfu: 4.96%
[rank0]:2025-10-28 12:15:39,916 - INFO - ðŸ”Ž  Running validation at step 300
[rank0]:2025-10-28 12:16:49,343 - INFO - validate step: 300  loss: -1.0000  memory: 14.87GiB(31.30%)  tps: 5,900
[rank1]:2025-10-28 12:16:49,428 - INFO - validate step: 300  loss: -1.0000  memory: 10.73GiB(22.58%)  tps: 5,891
[rank2]:2025-10-28 12:16:49,505 - INFO - validate step: 300  loss: -1.0000  memory:  7.21GiB(15.18%)  tps: 5,884
[rank3]:2025-10-28 12:16:49,571 - INFO - validate step: 300  loss:  0.9357  memory: 24.67GiB(51.93%)  tps: 5,880
[rank3]:2025-10-28 12:16:49,776 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_1F1B_nofreeze_dm1/pipeline_schedule/251028_1216_real_step300_rank3.svg
[rank3]:> Batch Time: 1906.67 ms, GPU Bubble Ratio: 58.27%, 50.61%, 64.15%, 15.27%
[rank3]:2025-10-28 12:18:09,959 - INFO -  step: 320  loss:  0.2951  grad_norm:  0.7788  memory: 24.67GiB(51.93%)  tps: 2,038  tflops: 15.52  mfu: 4.98%
[rank0]:2025-10-28 12:18:09,971 - INFO -  step: 320  loss: -2.0000  grad_norm:  0.7788  memory: 14.87GiB(31.30%)  tps: 2,032  tflops: 15.48  mfu: 4.96%
[rank1]:2025-10-28 12:18:09,952 - INFO -  step: 320  loss: -2.0000  grad_norm:  0.7788  memory: 10.73GiB(22.58%)  tps: 2,035  tflops: 15.50  mfu: 4.97%
[rank2]:2025-10-28 12:18:09,947 - INFO -  step: 320  loss: -2.0000  grad_norm:  0.7788  memory:  7.21GiB(15.18%)  tps: 2,037  tflops: 15.51  mfu: 4.97%
[rank3]:2025-10-28 12:18:11,784 - INFO - Avg. fwd time: 66.8397 / Avg. bwd time: 134.0852 / Avg. batch time: 1666.4436 (ms) / GPU bubble ratio: 3.54%
[rank1]:2025-10-28 12:18:11,911 - INFO - Avg. fwd time: 47.9821 / Avg. bwd time: 69.3351 / Avg. batch time: 1869.2483 (ms) / GPU bubble ratio: 49.79%
[rank2]:2025-10-28 12:18:11,842 - INFO - Avg. fwd time: 33.5619 / Avg. bwd time: 52.2792 / Avg. batch time: 1754.3109 (ms) / GPU bubble ratio: 60.85%
[rank0]:2025-10-28 12:18:11,971 - INFO - Avg. fwd time: 39.1956 / Avg. bwd time: 59.0649 / Avg. batch time: 1965.7591 (ms) / GPU bubble ratio: 60.01%
[rank1]:2025-10-28 12:19:29,909 - INFO -  step: 340  loss: -2.0000  grad_norm:  0.5801  memory: 10.73GiB(22.58%)  tps: 2,049  tflops: 15.61  mfu: 5.00%
[rank2]:2025-10-28 12:19:29,906 - INFO -  step: 340  loss: -2.0000  grad_norm:  0.5801  memory:  7.21GiB(15.18%)  tps: 2,049  tflops: 15.61  mfu: 5.00%
[rank3]:2025-10-28 12:19:29,918 - INFO -  step: 340  loss:  0.2662  grad_norm:  0.5801  memory: 24.67GiB(51.93%)  tps: 2,049  tflops: 15.61  mfu: 5.00%
[rank0]:2025-10-28 12:19:29,925 - INFO -  step: 340  loss: -2.0000  grad_norm:  0.5801  memory: 14.87GiB(31.30%)  tps: 2,049  tflops: 15.61  mfu: 5.00%
[rank0]:2025-10-28 12:20:05,955 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-28 12:20:49,974 - INFO -  step: 360  loss: -2.0000  grad_norm:  0.7518  memory: 14.87GiB(31.30%)  tps: 2,047  tflops: 15.59  mfu: 5.00%
[rank1]:2025-10-28 12:20:49,959 - INFO -  step: 360  loss: -2.0000  grad_norm:  0.7518  memory: 10.73GiB(22.58%)  tps: 2,047  tflops: 15.59  mfu: 5.00%
[rank2]:2025-10-28 12:20:49,956 - INFO -  step: 360  loss: -2.0000  grad_norm:  0.7518  memory:  7.21GiB(15.18%)  tps: 2,047  tflops: 15.59  mfu: 5.00%
[rank3]:2025-10-28 12:20:49,968 - INFO -  step: 360  loss:  0.2039  grad_norm:  0.7518  memory: 24.67GiB(51.93%)  tps: 2,047  tflops: 15.59  mfu: 5.00%
[rank3]:2025-10-28 12:20:51,807 - INFO - Avg. fwd time: 66.8372 / Avg. bwd time: 134.1455 / Avg. batch time: 1666.6271 (ms) / GPU bubble ratio: 3.53%
[rank2]:2025-10-28 12:20:51,862 - INFO - Avg. fwd time: 33.5521 / Avg. bwd time: 52.2827 / Avg. batch time: 1754.4032 (ms) / GPU bubble ratio: 60.86%
[rank1]:2025-10-28 12:20:51,939 - INFO - Avg. fwd time: 48.0202 / Avg. bwd time: 69.3692 / Avg. batch time: 1869.4665 (ms) / GPU bubble ratio: 49.77%
[rank0]:2025-10-28 12:20:52,003 - INFO - Avg. fwd time: 39.1853 / Avg. bwd time: 59.0728 / Avg. batch time: 1966.0137 (ms) / GPU bubble ratio: 60.02%
[rank1]:2025-10-28 12:22:09,610 - INFO -  step: 380  loss: -2.0000  grad_norm:  0.5381  memory: 10.73GiB(22.58%)  tps: 2,057  tflops: 15.67  mfu: 5.02%
[rank2]:2025-10-28 12:22:09,607 - INFO -  step: 380  loss: -2.0000  grad_norm:  0.5381  memory:  7.21GiB(15.18%)  tps: 2,057  tflops: 15.67  mfu: 5.02%
[rank3]:2025-10-28 12:22:09,619 - INFO -  step: 380  loss:  0.2588  grad_norm:  0.5381  memory: 24.67GiB(51.93%)  tps: 2,057  tflops: 15.67  mfu: 5.02%
[rank0]:2025-10-28 12:22:09,626 - INFO -  step: 380  loss: -2.0000  grad_norm:  0.5381  memory: 14.87GiB(31.30%)  tps: 2,057  tflops: 15.67  mfu: 5.02%
[rank0]:2025-10-28 12:23:25,527 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-28 12:23:29,581 - INFO -  step: 400  loss:  0.2196  grad_norm:  0.7664  memory: 24.67GiB(51.93%)  tps: 2,049  tflops: 15.61  mfu: 5.00%
[rank3]:2025-10-28 12:23:29,581 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-10-28 12:23:29,589 - INFO -  step: 400  loss: -2.0000  grad_norm:  0.7664  memory: 14.87GiB(31.30%)  tps: 2,049  tflops: 15.61  mfu: 5.00%
[rank0]:2025-10-28 12:23:29,589 - INFO - ðŸ”Ž  Running validation at step 400
[rank1]:2025-10-28 12:23:29,572 - INFO -  step: 400  loss: -2.0000  grad_norm:  0.7664  memory: 10.73GiB(22.58%)  tps: 2,049  tflops: 15.61  mfu: 5.00%
[rank1]:2025-10-28 12:23:29,572 - INFO - ðŸ”Ž  Running validation at step 400
[rank2]:2025-10-28 12:23:29,569 - INFO -  step: 400  loss: -2.0000  grad_norm:  0.7664  memory:  7.21GiB(15.18%)  tps: 2,049  tflops: 15.61  mfu: 5.00%
[rank2]:2025-10-28 12:23:29,569 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-10-28 12:24:39,271 - INFO - validate step: 400  loss: -1.0000  memory: 14.87GiB(31.30%)  tps: 5,878
[rank1]:2025-10-28 12:24:39,352 - INFO - validate step: 400  loss: -1.0000  memory: 10.73GiB(22.58%)  tps: 5,870
[rank2]:2025-10-28 12:24:39,434 - INFO - validate step: 400  loss: -1.0000  memory:  7.21GiB(15.18%)  tps: 5,863
[rank3]:2025-10-28 12:24:39,498 - INFO - validate step: 400  loss:  0.9292  memory: 24.67GiB(51.93%)  tps: 5,858
[rank3]:2025-10-28 12:24:39,709 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_1F1B_nofreeze_dm1/pipeline_schedule/251028_1224_real_step400_rank3.svg
[rank3]:> Batch Time: 1907.17 ms, GPU Bubble Ratio: 58.33%, 50.56%, 64.15%, 15.25%
[rank3]:2025-10-28 12:24:41,443 - INFO - Avg. fwd time: 66.8344 / Avg. bwd time: 134.1565 / Avg. batch time: 1666.4674 (ms) / GPU bubble ratio: 3.51%
[rank2]:2025-10-28 12:24:41,503 - INFO - Avg. fwd time: 33.5646 / Avg. bwd time: 52.3230 / Avg. batch time: 1754.3602 (ms) / GPU bubble ratio: 60.83%
[rank1]:2025-10-28 12:24:41,583 - INFO - Avg. fwd time: 48.0267 / Avg. bwd time: 69.3633 / Avg. batch time: 1869.3794 (ms) / GPU bubble ratio: 49.76%
[rank0]:2025-10-28 12:24:41,650 - INFO - Avg. fwd time: 39.1612 / Avg. bwd time: 59.0411 / Avg. batch time: 1965.8796 (ms) / GPU bubble ratio: 60.04%
[rank0]:2025-10-28 12:25:59,755 - INFO -  step: 420  loss: -2.0000  grad_norm:  0.5300  memory: 14.87GiB(31.30%)  tps: 2,036  tflops: 15.50  mfu: 4.97%
[rank2]:2025-10-28 12:25:59,732 - INFO -  step: 420  loss: -2.0000  grad_norm:  0.5300  memory:  7.21GiB(15.18%)  tps: 2,040  tflops: 15.54  mfu: 4.98%
[rank1]:2025-10-28 12:25:59,738 - INFO -  step: 420  loss: -2.0000  grad_norm:  0.5300  memory: 10.73GiB(22.58%)  tps: 2,038  tflops: 15.52  mfu: 4.98%
[rank3]:2025-10-28 12:25:59,744 - INFO -  step: 420  loss:  0.2872  grad_norm:  0.5300  memory: 24.67GiB(51.93%)  tps: 2,042  tflops: 15.55  mfu: 4.98%
[rank0]:2025-10-28 12:27:20,159 - INFO -  step: 440  loss: -2.0000  grad_norm:  0.7669  memory: 14.87GiB(31.30%)  tps: 2,038  tflops: 15.52  mfu: 4.97%
[rank1]:2025-10-28 12:27:20,142 - INFO -  step: 440  loss: -2.0000  grad_norm:  0.7669  memory: 10.73GiB(22.58%)  tps: 2,038  tflops: 15.52  mfu: 4.97%
[rank2]:2025-10-28 12:27:20,138 - INFO -  step: 440  loss: -2.0000  grad_norm:  0.7669  memory:  7.21GiB(15.18%)  tps: 2,038  tflops: 15.52  mfu: 4.97%
[rank3]:2025-10-28 12:27:20,151 - INFO -  step: 440  loss:  0.2724  grad_norm:  0.7669  memory: 24.67GiB(51.93%)  tps: 2,038  tflops: 15.52  mfu: 4.97%
[rank3]:2025-10-28 12:27:21,996 - INFO - Avg. fwd time: 66.8733 / Avg. bwd time: 134.2411 / Avg. batch time: 1667.2718 (ms) / GPU bubble ratio: 3.50%
[rank2]:2025-10-28 12:27:22,052 - INFO - Avg. fwd time: 33.5714 / Avg. bwd time: 52.3085 / Avg. batch time: 1755.0886 (ms) / GPU bubble ratio: 60.85%
[rank0]:2025-10-28 12:27:22,197 - INFO - Avg. fwd time: 39.1230 / Avg. bwd time: 59.0527 / Avg. batch time: 1966.6296 (ms) / GPU bubble ratio: 60.06%
[rank1]:2025-10-28 12:27:22,131 - INFO - Avg. fwd time: 48.0813 / Avg. bwd time: 69.3501 / Avg. batch time: 1870.1049 (ms) / GPU bubble ratio: 49.76%
[rank0]:2025-10-28 12:27:56,505 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-28 12:28:40,775 - INFO -  step: 460  loss: -2.0000  grad_norm:  0.7122  memory: 14.87GiB(31.30%)  tps: 2,032  tflops: 15.48  mfu: 4.96%
[rank1]:2025-10-28 12:28:40,755 - INFO -  step: 460  loss: -2.0000  grad_norm:  0.7122  memory: 10.73GiB(22.58%)  tps: 2,032  tflops: 15.48  mfu: 4.96%
[rank3]:2025-10-28 12:28:40,763 - INFO -  step: 460  loss:  0.2450  grad_norm:  0.7122  memory: 24.67GiB(51.93%)  tps: 2,033  tflops: 15.48  mfu: 4.96%
[rank2]:2025-10-28 12:28:40,751 - INFO -  step: 460  loss: -2.0000  grad_norm:  0.7122  memory:  7.21GiB(15.18%)  tps: 2,032  tflops: 15.48  mfu: 4.96%
[rank2]:2025-10-28 12:30:01,029 - INFO -  step: 480  loss: -2.0000  grad_norm:  0.7786  memory:  7.21GiB(15.18%)  tps: 2,041  tflops: 15.54  mfu: 4.98%
[rank0]:2025-10-28 12:30:01,048 - INFO -  step: 480  loss: -2.0000  grad_norm:  0.7786  memory: 14.87GiB(31.30%)  tps: 2,041  tflops: 15.55  mfu: 4.98%
[rank1]:2025-10-28 12:30:01,032 - INFO -  step: 480  loss: -2.0000  grad_norm:  0.7786  memory: 10.73GiB(22.58%)  tps: 2,041  tflops: 15.54  mfu: 4.98%
[rank3]:2025-10-28 12:30:01,041 - INFO -  step: 480  loss:  0.2384  grad_norm:  0.7786  memory: 24.67GiB(51.93%)  tps: 2,041  tflops: 15.54  mfu: 4.98%
[rank3]:2025-10-28 12:30:02,857 - INFO - Avg. fwd time: 66.9122 / Avg. bwd time: 134.3164 / Avg. batch time: 1668.0325 (ms) / GPU bubble ratio: 3.49%
[rank2]:2025-10-28 12:30:02,918 - INFO - Avg. fwd time: 33.5533 / Avg. bwd time: 52.2833 / Avg. batch time: 1755.7737 (ms) / GPU bubble ratio: 60.89%
[rank1]:2025-10-28 12:30:02,993 - INFO - Avg. fwd time: 48.1374 / Avg. bwd time: 69.4054 / Avg. batch time: 1870.9670 (ms) / GPU bubble ratio: 49.74%
[rank0]:2025-10-28 12:30:03,054 - INFO - Avg. fwd time: 39.1466 / Avg. bwd time: 59.0803 / Avg. batch time: 1967.5948 (ms) / GPU bubble ratio: 60.06%
[rank0]:2025-10-28 12:31:16,914 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-28 12:31:20,909 - INFO -  step: 500  loss: -2.0000  grad_norm:  0.4709  memory: 10.73GiB(22.58%)  tps: 2,051  tflops: 15.62  mfu: 5.01%
[rank1]:2025-10-28 12:31:20,909 - INFO - ðŸ”Ž  Running validation at step 500
[rank3]:2025-10-28 12:31:20,918 - INFO -  step: 500  loss:  0.2543  grad_norm:  0.4709  memory: 24.67GiB(51.93%)  tps: 2,051  tflops: 15.62  mfu: 5.01%
[rank3]:2025-10-28 12:31:20,918 - INFO - ðŸ”Ž  Running validation at step 500
[rank2]:2025-10-28 12:31:20,905 - INFO -  step: 500  loss: -2.0000  grad_norm:  0.4709  memory:  7.21GiB(15.18%)  tps: 2,051  tflops: 15.62  mfu: 5.01%
[rank2]:2025-10-28 12:31:20,905 - INFO - ðŸ”Ž  Running validation at step 500
[rank0]:2025-10-28 12:31:20,925 - INFO -  step: 500  loss: -2.0000  grad_norm:  0.4709  memory: 14.87GiB(31.30%)  tps: 2,051  tflops: 15.62  mfu: 5.01%
[rank0]:2025-10-28 12:31:20,926 - INFO - ðŸ”Ž  Running validation at step 500
[rank0]:2025-10-28 12:32:30,341 - INFO - validate step: 500  loss: -1.0000  memory: 14.87GiB(31.30%)  tps: 5,901
[rank1]:2025-10-28 12:32:30,421 - INFO - validate step: 500  loss: -1.0000  memory: 10.73GiB(22.58%)  tps: 5,893
[rank2]:2025-10-28 12:32:30,502 - INFO - validate step: 500  loss: -1.0000  memory:  7.21GiB(15.18%)  tps: 5,885
[rank3]:2025-10-28 12:32:30,568 - INFO - validate step: 500  loss:  0.9283  memory: 24.67GiB(51.93%)  tps: 5,881
[rank3]:2025-10-28 12:32:30,771 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_1F1B_nofreeze_dm1/pipeline_schedule/251028_1232_real_step500_rank3.svg
[rank3]:> Batch Time: 1908.52 ms, GPU Bubble Ratio: 58.34%, 50.52%, 64.23%, 15.25%
[rank2]:2025-10-28 12:33:51,096 - INFO -  step: 520  loss: -2.0000  grad_norm:  0.7429  memory:  7.21GiB(15.18%)  tps: 2,033  tflops: 15.48  mfu: 4.96%
[rank1]:2025-10-28 12:33:51,099 - INFO -  step: 520  loss: -2.0000  grad_norm:  0.7429  memory: 10.73GiB(22.58%)  tps: 2,031  tflops: 15.47  mfu: 4.96%
[rank3]:2025-10-28 12:33:51,108 - INFO -  step: 520  loss:  0.2430  grad_norm:  0.7429  memory: 24.67GiB(51.93%)  tps: 2,034  tflops: 15.49  mfu: 4.97%
[rank0]:2025-10-28 12:33:51,122 - INFO -  step: 520  loss: -2.0000  grad_norm:  0.7429  memory: 14.87GiB(31.30%)  tps: 2,028  tflops: 15.45  mfu: 4.95%
[rank2]:2025-10-28 12:33:52,993 - INFO - Avg. fwd time: 33.5603 / Avg. bwd time: 52.2879 / Avg. batch time: 1756.1467 (ms) / GPU bubble ratio: 60.89%
[rank3]:2025-10-28 12:33:52,931 - INFO - Avg. fwd time: 66.9190 / Avg. bwd time: 134.3636 / Avg. batch time: 1668.3364 (ms) / GPU bubble ratio: 3.48%
[rank1]:2025-10-28 12:33:53,064 - INFO - Avg. fwd time: 48.1590 / Avg. bwd time: 69.4577 / Avg. batch time: 1871.4195 (ms) / GPU bubble ratio: 49.72%
[rank0]:2025-10-28 12:33:53,124 - INFO - Avg. fwd time: 39.1420 / Avg. bwd time: 59.0831 / Avg. batch time: 1968.0243 (ms) / GPU bubble ratio: 60.07%
[rank2]:2025-10-28 12:35:11,355 - INFO -  step: 540  loss: -2.0000  grad_norm:  0.5145  memory:  7.21GiB(15.18%)  tps: 2,041  tflops: 15.55  mfu: 4.98%
[rank1]:2025-10-28 12:35:11,367 - INFO -  step: 540  loss: -2.0000  grad_norm:  0.5145  memory: 10.73GiB(22.58%)  tps: 2,041  tflops: 15.55  mfu: 4.98%
[rank3]:2025-10-28 12:35:11,367 - INFO -  step: 540  loss:  0.2511  grad_norm:  0.5145  memory: 24.67GiB(51.93%)  tps: 2,041  tflops: 15.55  mfu: 4.98%
[rank0]:2025-10-28 12:35:11,379 - INFO -  step: 540  loss: -2.0000  grad_norm:  0.5145  memory: 14.87GiB(31.30%)  tps: 2,041  tflops: 15.55  mfu: 4.98%
[rank0]:2025-10-28 12:35:47,440 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-28 12:36:31,771 - INFO -  step: 560  loss: -2.0000  grad_norm:  0.7997  memory:  7.21GiB(15.18%)  tps: 2,037  tflops: 15.52  mfu: 4.97%
[rank1]:2025-10-28 12:36:31,775 - INFO -  step: 560  loss: -2.0000  grad_norm:  0.7997  memory: 10.73GiB(22.58%)  tps: 2,038  tflops: 15.52  mfu: 4.97%
[rank3]:2025-10-28 12:36:31,783 - INFO -  step: 560  loss:  0.2965  grad_norm:  0.7997  memory: 24.67GiB(51.93%)  tps: 2,037  tflops: 15.52  mfu: 4.97%
[rank0]:2025-10-28 12:36:31,796 - INFO -  step: 560  loss: -2.0000  grad_norm:  0.7997  memory: 14.87GiB(31.30%)  tps: 2,037  tflops: 15.52  mfu: 4.97%
[rank3]:2025-10-28 12:36:33,624 - INFO - Avg. fwd time: 66.9513 / Avg. bwd time: 134.4242 / Avg. batch time: 1668.9669 (ms) / GPU bubble ratio: 3.47%
[rank2]:2025-10-28 12:36:33,683 - INFO - Avg. fwd time: 33.5651 / Avg. bwd time: 52.2970 / Avg. batch time: 1756.8018 (ms) / GPU bubble ratio: 60.90%
[rank1]:2025-10-28 12:36:33,764 - INFO - Avg. fwd time: 48.1523 / Avg. bwd time: 69.5253 / Avg. batch time: 1872.0379 (ms) / GPU bubble ratio: 49.71%
[rank0]:2025-10-28 12:36:33,831 - INFO - Avg. fwd time: 39.1305 / Avg. bwd time: 59.1052 / Avg. batch time: 1968.6077 (ms) / GPU bubble ratio: 60.08%
[rank2]:2025-10-28 12:37:52,307 - INFO -  step: 580  loss: -2.0000  grad_norm:  0.3913  memory:  7.21GiB(15.18%)  tps: 2,034  tflops: 15.49  mfu: 4.97%
[rank1]:2025-10-28 12:37:52,312 - INFO -  step: 580  loss: -2.0000  grad_norm:  0.3913  memory: 10.73GiB(22.58%)  tps: 2,034  tflops: 15.49  mfu: 4.97%
[rank3]:2025-10-28 12:37:52,319 - INFO -  step: 580  loss:  0.2246  grad_norm:  0.3913  memory: 24.67GiB(51.93%)  tps: 2,034  tflops: 15.49  mfu: 4.97%
[rank0]:2025-10-28 12:37:52,326 - INFO -  step: 580  loss: -2.0000  grad_norm:  0.3913  memory: 14.87GiB(31.30%)  tps: 2,035  tflops: 15.50  mfu: 4.97%
[rank0]:2025-10-28 12:39:08,530 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-28 12:39:12,560 - INFO -  step: 600  loss: -2.0000  grad_norm:  0.7518  memory:  7.21GiB(15.18%)  tps: 2,042  tflops: 15.55  mfu: 4.98%
[rank2]:2025-10-28 12:39:12,560 - INFO - ðŸ”Ž  Running validation at step 600
[rank1]:2025-10-28 12:39:12,564 - INFO -  step: 600  loss: -2.0000  grad_norm:  0.7518  memory: 10.73GiB(22.58%)  tps: 2,042  tflops: 15.55  mfu: 4.98%
[rank1]:2025-10-28 12:39:12,564 - INFO - ðŸ”Ž  Running validation at step 600
[rank3]:2025-10-28 12:39:12,572 - INFO -  step: 600  loss:  0.2164  grad_norm:  0.7518  memory: 24.67GiB(51.93%)  tps: 2,042  tflops: 15.55  mfu: 4.98%
[rank3]:2025-10-28 12:39:12,573 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-10-28 12:39:12,580 - INFO -  step: 600  loss: -2.0000  grad_norm:  0.7518  memory: 14.87GiB(31.30%)  tps: 2,042  tflops: 15.55  mfu: 4.98%
[rank0]:2025-10-28 12:39:12,580 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-10-28 12:40:22,240 - INFO - validate step: 600  loss: -1.0000  memory: 14.87GiB(31.30%)  tps: 5,880
[rank1]:2025-10-28 12:40:22,320 - INFO - validate step: 600  loss: -1.0000  memory: 10.73GiB(22.58%)  tps: 5,872
[rank2]:2025-10-28 12:40:22,404 - INFO - validate step: 600  loss: -1.0000  memory:  7.21GiB(15.18%)  tps: 5,865
[rank3]:2025-10-28 12:40:22,467 - INFO - validate step: 600  loss:  0.9276  memory: 24.67GiB(51.93%)  tps: 5,860
[rank3]:2025-10-28 12:40:22,673 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_1F1B_nofreeze_dm1/pipeline_schedule/251028_1240_real_step600_rank3.svg
[rank3]:> Batch Time: 1910.09 ms, GPU Bubble Ratio: 58.35%, 50.45%, 64.32%, 15.24%
[rank3]:2025-10-28 12:40:24,384 - INFO - Avg. fwd time: 66.9715 / Avg. bwd time: 134.4758 / Avg. batch time: 1669.4422 (ms) / GPU bubble ratio: 3.47%
[rank2]:2025-10-28 12:40:24,445 - INFO - Avg. fwd time: 33.5550 / Avg. bwd time: 52.2953 / Avg. batch time: 1757.3152 (ms) / GPU bubble ratio: 60.92%
[rank1]:2025-10-28 12:40:24,514 - INFO - Avg. fwd time: 48.1764 / Avg. bwd time: 69.5562 / Avg. batch time: 1872.5799 (ms) / GPU bubble ratio: 49.70%
[rank0]:2025-10-28 12:40:24,578 - INFO - Avg. fwd time: 39.1643 / Avg. bwd time: 59.1306 / Avg. batch time: 1969.2379 (ms) / GPU bubble ratio: 60.07%
[rank1]:2025-10-28 12:41:42,836 - INFO -  step: 620  loss: -2.0000  grad_norm:  0.4847  memory: 10.73GiB(22.58%)  tps: 2,035  tflops: 15.50  mfu: 4.97%
[rank3]:2025-10-28 12:41:42,845 - INFO -  step: 620  loss:  0.2525  grad_norm:  0.4847  memory: 24.67GiB(51.93%)  tps: 2,038  tflops: 15.53  mfu: 4.98%
[rank0]:2025-10-28 12:41:42,857 - INFO -  step: 620  loss: -2.0000  grad_norm:  0.4847  memory: 14.87GiB(31.30%)  tps: 2,032  tflops: 15.48  mfu: 4.96%
[rank2]:2025-10-28 12:41:42,833 - INFO -  step: 620  loss: -2.0000  grad_norm:  0.4847  memory:  7.21GiB(15.18%)  tps: 2,037  tflops: 15.51  mfu: 4.97%
[rank2]:2025-10-28 12:43:03,009 - INFO -  step: 640  loss: -2.0000  grad_norm:  0.7369  memory:  7.21GiB(15.18%)  tps: 2,044  tflops: 15.56  mfu: 4.99%
[rank1]:2025-10-28 12:43:03,013 - INFO -  step: 640  loss: -2.0000  grad_norm:  0.7369  memory: 10.73GiB(22.58%)  tps: 2,044  tflops: 15.56  mfu: 4.99%
[rank3]:2025-10-28 12:43:03,020 - INFO -  step: 640  loss:  0.2180  grad_norm:  0.7369  memory: 24.67GiB(51.93%)  tps: 2,044  tflops: 15.56  mfu: 4.99%
[rank0]:2025-10-28 12:43:03,029 - INFO -  step: 640  loss: -2.0000  grad_norm:  0.7369  memory: 14.87GiB(31.30%)  tps: 2,044  tflops: 15.56  mfu: 4.99%
[rank3]:2025-10-28 12:43:04,836 - INFO - Avg. fwd time: 66.9709 / Avg. bwd time: 134.5063 / Avg. batch time: 1669.5982 (ms) / GPU bubble ratio: 3.46%
[rank2]:2025-10-28 12:43:04,897 - INFO - Avg. fwd time: 33.5483 / Avg. bwd time: 52.3038 / Avg. batch time: 1757.4399 (ms) / GPU bubble ratio: 60.92%
[rank1]:2025-10-28 12:43:04,966 - INFO - Avg. fwd time: 48.2001 / Avg. bwd time: 69.5816 / Avg. batch time: 1872.7894 (ms) / GPU bubble ratio: 49.69%
[rank0]:2025-10-28 12:43:05,031 - INFO - Avg. fwd time: 39.1521 / Avg. bwd time: 59.1394 / Avg. batch time: 1969.4973 (ms) / GPU bubble ratio: 60.07%
[rank0]:2025-10-28 12:43:39,037 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-28 12:44:22,807 - INFO -  step: 660  loss: -2.0000  grad_norm:  0.6475  memory:  7.21GiB(15.18%)  tps: 2,053  tflops: 15.64  mfu: 5.01%
[rank1]:2025-10-28 12:44:22,811 - INFO -  step: 660  loss: -2.0000  grad_norm:  0.6475  memory: 10.73GiB(22.58%)  tps: 2,053  tflops: 15.64  mfu: 5.01%
[rank3]:2025-10-28 12:44:22,820 - INFO -  step: 660  loss:  0.2587  grad_norm:  0.6475  memory: 24.67GiB(51.93%)  tps: 2,053  tflops: 15.64  mfu: 5.01%
[rank0]:2025-10-28 12:44:22,826 - INFO -  step: 660  loss: -2.0000  grad_norm:  0.6475  memory: 14.87GiB(31.30%)  tps: 2,053  tflops: 15.64  mfu: 5.01%
[rank2]:2025-10-28 12:45:42,819 - INFO -  step: 680  loss: -2.0000  grad_norm:  0.7476  memory:  7.21GiB(15.18%)  tps: 2,048  tflops: 15.60  mfu: 5.00%
[rank1]:2025-10-28 12:45:42,822 - INFO -  step: 680  loss: -2.0000  grad_norm:  0.7476  memory: 10.73GiB(22.58%)  tps: 2,048  tflops: 15.60  mfu: 5.00%
[rank3]:2025-10-28 12:45:42,831 - INFO -  step: 680  loss:  0.2157  grad_norm:  0.7476  memory: 24.67GiB(51.93%)  tps: 2,048  tflops: 15.60  mfu: 5.00%
[rank0]:2025-10-28 12:45:42,839 - INFO -  step: 680  loss: -2.0000  grad_norm:  0.7476  memory: 14.87GiB(31.30%)  tps: 2,048  tflops: 15.60  mfu: 5.00%
[rank2]:2025-10-28 12:45:44,732 - INFO - Avg. fwd time: 33.5543 / Avg. bwd time: 52.3201 / Avg. batch time: 1757.2400 (ms) / GPU bubble ratio: 60.90%
[rank3]:2025-10-28 12:45:44,667 - INFO - Avg. fwd time: 66.9601 / Avg. bwd time: 134.5030 / Avg. batch time: 1669.4103 (ms) / GPU bubble ratio: 3.46%
[rank1]:2025-10-28 12:45:44,801 - INFO - Avg. fwd time: 48.1963 / Avg. bwd time: 69.6224 / Avg. batch time: 1872.6017 (ms) / GPU bubble ratio: 49.67%
[rank0]:2025-10-28 12:45:44,866 - INFO - Avg. fwd time: 39.1265 / Avg. bwd time: 59.1270 / Avg. batch time: 1969.2870 (ms) / GPU bubble ratio: 60.09%
[rank0]:2025-10-28 12:46:58,772 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-28 12:47:02,733 - INFO -  step: 700  loss: -2.0000  grad_norm:  0.5025  memory:  7.21GiB(15.18%)  tps: 2,050  tflops: 15.61  mfu: 5.00%
[rank2]:2025-10-28 12:47:02,733 - INFO - ðŸ”Ž  Running validation at step 700
[rank3]:2025-10-28 12:47:02,745 - INFO -  step: 700  loss:  0.2291  grad_norm:  0.5025  memory: 24.67GiB(51.93%)  tps: 2,050  tflops: 15.62  mfu: 5.00%
[rank3]:2025-10-28 12:47:02,746 - INFO - ðŸ”Ž  Running validation at step 700
[rank1]:2025-10-28 12:47:02,744 - INFO -  step: 700  loss: -2.0000  grad_norm:  0.5025  memory: 10.73GiB(22.58%)  tps: 2,050  tflops: 15.61  mfu: 5.00%
[rank1]:2025-10-28 12:47:02,744 - INFO - ðŸ”Ž  Running validation at step 700
[rank0]:2025-10-28 12:47:02,753 - INFO -  step: 700  loss: -2.0000  grad_norm:  0.5025  memory: 14.87GiB(31.30%)  tps: 2,050  tflops: 15.61  mfu: 5.00%
[rank0]:2025-10-28 12:47:02,753 - INFO - ðŸ”Ž  Running validation at step 700
[rank0]:2025-10-28 12:48:13,582 - INFO - validate step: 700  loss: -1.0000  memory: 14.87GiB(31.30%)  tps: 5,783
[rank2]:2025-10-28 12:48:13,745 - INFO - validate step: 700  loss: -1.0000  memory:  7.21GiB(15.18%)  tps: 5,768
[rank1]:2025-10-28 12:48:13,662 - INFO - validate step: 700  loss: -1.0000  memory: 10.73GiB(22.58%)  tps: 5,776
[rank3]:2025-10-28 12:48:13,812 - INFO - validate step: 700  loss:  0.9272  memory: 24.67GiB(51.93%)  tps: 5,764
[rank3]:2025-10-28 12:48:14,014 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_1F1B_nofreeze_dm1/pipeline_schedule/251028_1248_real_step700_rank3.svg
[rank3]:> Batch Time: 1909.77 ms, GPU Bubble Ratio: 58.36%, 50.42%, 64.31%, 15.25%
[rank2]:2025-10-28 12:49:34,545 - INFO -  step: 720  loss: -2.0000  grad_norm:  0.7042  memory:  7.21GiB(15.18%)  tps: 2,028  tflops: 15.44  mfu: 4.95%
[rank1]:2025-10-28 12:49:34,551 - INFO -  step: 720  loss: -2.0000  grad_norm:  0.7042  memory: 10.73GiB(22.58%)  tps: 2,026  tflops: 15.43  mfu: 4.94%
[rank0]:2025-10-28 12:49:34,570 - INFO -  step: 720  loss: -2.0000  grad_norm:  0.7042  memory: 14.87GiB(31.30%)  tps: 2,023  tflops: 15.41  mfu: 4.94%
[rank3]:2025-10-28 12:49:34,557 - INFO -  step: 720  loss:  0.2631  grad_norm:  0.7042  memory: 24.67GiB(51.93%)  tps: 2,029  tflops: 15.45  mfu: 4.95%
[rank3]:2025-10-28 12:49:36,396 - INFO - Avg. fwd time: 66.9696 / Avg. bwd time: 134.5347 / Avg. batch time: 1669.6755 (ms) / GPU bubble ratio: 3.45%
[rank2]:2025-10-28 12:49:36,457 - INFO - Avg. fwd time: 33.5506 / Avg. bwd time: 52.3218 / Avg. batch time: 1757.5516 (ms) / GPU bubble ratio: 60.91%
[rank1]:2025-10-28 12:49:36,538 - INFO - Avg. fwd time: 48.2187 / Avg. bwd time: 69.6348 / Avg. batch time: 1872.9143 (ms) / GPU bubble ratio: 49.66%
[rank0]:2025-10-28 12:49:36,606 - INFO - Avg. fwd time: 39.1476 / Avg. bwd time: 59.1421 / Avg. batch time: 1969.6413 (ms) / GPU bubble ratio: 60.08%
[rank2]:2025-10-28 12:50:55,201 - INFO -  step: 740  loss: -2.0000  grad_norm:  0.5124  memory:  7.21GiB(15.18%)  tps: 2,031  tflops: 15.47  mfu: 4.96%
[rank3]:2025-10-28 12:50:55,213 - INFO -  step: 740  loss:  0.2280  grad_norm:  0.5124  memory: 24.67GiB(51.93%)  tps: 2,031  tflops: 15.47  mfu: 4.96%
[rank1]:2025-10-28 12:50:55,205 - INFO -  step: 740  loss: -2.0000  grad_norm:  0.5124  memory: 10.73GiB(22.58%)  tps: 2,031  tflops: 15.47  mfu: 4.96%
[rank0]:2025-10-28 12:50:55,221 - INFO -  step: 740  loss: -2.0000  grad_norm:  0.5124  memory: 14.87GiB(31.30%)  tps: 2,031  tflops: 15.47  mfu: 4.96%
[rank0]:2025-10-28 12:51:31,424 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-28 12:52:15,488 - INFO -  step: 760  loss: -2.0000  grad_norm:  0.7540  memory:  7.21GiB(15.18%)  tps: 2,041  tflops: 15.54  mfu: 4.98%
[rank3]:2025-10-28 12:52:15,500 - INFO -  step: 760  loss:  0.2716  grad_norm:  0.7540  memory: 24.67GiB(51.93%)  tps: 2,041  tflops: 15.54  mfu: 4.98%
[rank1]:2025-10-28 12:52:15,492 - INFO -  step: 760  loss: -2.0000  grad_norm:  0.7540  memory: 10.73GiB(22.58%)  tps: 2,041  tflops: 15.54  mfu: 4.98%
[rank0]:2025-10-28 12:52:15,513 - INFO -  step: 760  loss: -2.0000  grad_norm:  0.7540  memory: 14.87GiB(31.30%)  tps: 2,041  tflops: 15.54  mfu: 4.98%
[rank3]:2025-10-28 12:52:17,332 - INFO - Avg. fwd time: 66.9967 / Avg. bwd time: 134.5716 / Avg. batch time: 1670.1294 (ms) / GPU bubble ratio: 3.45%
[rank2]:2025-10-28 12:52:17,391 - INFO - Avg. fwd time: 33.5460 / Avg. bwd time: 52.3147 / Avg. batch time: 1757.9758 (ms) / GPU bubble ratio: 60.93%
[rank1]:2025-10-28 12:52:17,474 - INFO - Avg. fwd time: 48.2683 / Avg. bwd time: 69.6500 / Avg. batch time: 1873.3762 (ms) / GPU bubble ratio: 49.64%
[rank0]:2025-10-28 12:52:17,535 - INFO - Avg. fwd time: 39.1607 / Avg. bwd time: 59.1590 / Avg. batch time: 1970.1340 (ms) / GPU bubble ratio: 60.08%
[rank2]:2025-10-28 12:53:35,810 - INFO -  step: 780  loss: -2.0000  grad_norm:  0.5496  memory:  7.21GiB(15.18%)  tps: 2,040  tflops: 15.54  mfu: 4.98%
[rank3]:2025-10-28 12:53:35,823 - INFO -  step: 780  loss:  0.2867  grad_norm:  0.5496  memory: 24.67GiB(51.93%)  tps: 2,040  tflops: 15.54  mfu: 4.98%
[rank1]:2025-10-28 12:53:35,814 - INFO -  step: 780  loss: -2.0000  grad_norm:  0.5496  memory: 10.73GiB(22.58%)  tps: 2,040  tflops: 15.54  mfu: 4.98%
[rank0]:2025-10-28 12:53:35,830 - INFO -  step: 780  loss: -2.0000  grad_norm:  0.5496  memory: 14.87GiB(31.30%)  tps: 2,040  tflops: 15.54  mfu: 4.98%
[rank0]:2025-10-28 12:54:51,877 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-28 12:54:55,945 - INFO -  step: 800  loss: -2.0000  grad_norm:  0.7230  memory:  7.21GiB(15.18%)  tps: 2,045  tflops: 15.57  mfu: 4.99%
[rank2]:2025-10-28 12:54:55,945 - INFO - ðŸ”Ž  Running validation at step 800
[rank3]:2025-10-28 12:54:55,957 - INFO -  step: 800  loss:  0.2591  grad_norm:  0.7230  memory: 24.67GiB(51.93%)  tps: 2,045  tflops: 15.57  mfu: 4.99%
[rank3]:2025-10-28 12:54:55,958 - INFO - ðŸ”Ž  Running validation at step 800
[rank1]:2025-10-28 12:54:55,948 - INFO -  step: 800  loss: -2.0000  grad_norm:  0.7230  memory: 10.73GiB(22.58%)  tps: 2,045  tflops: 15.57  mfu: 4.99%
[rank1]:2025-10-28 12:54:55,949 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-10-28 12:54:55,965 - INFO -  step: 800  loss: -2.0000  grad_norm:  0.7230  memory: 14.87GiB(31.30%)  tps: 2,045  tflops: 15.57  mfu: 4.99%
[rank0]:2025-10-28 12:54:55,966 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-10-28 12:56:04,967 - INFO - validate step: 800  loss: -1.0000  memory: 14.87GiB(31.30%)  tps: 5,936
[rank0]:2025-10-28 12:56:04,968 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-28 12:56:04,975 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank1]:2025-10-28 12:56:05,058 - INFO - validate step: 800  loss: -1.0000  memory: 10.73GiB(22.58%)  tps: 5,927
[rank1]:2025-10-28 12:56:05,059 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-28 12:56:05,130 - INFO - validate step: 800  loss: -1.0000  memory:  7.21GiB(15.18%)  tps: 5,920
[rank2]:2025-10-28 12:56:05,131 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-28 12:56:05,194 - INFO - validate step: 800  loss:  0.9267  memory: 24.67GiB(51.93%)  tps: 5,916
[rank3]:2025-10-28 12:56:05,195 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-28 12:56:06,988 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 1.86 seconds.
[rank1]:2025-10-28 12:56:07,448 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 2.39 seconds.
[rank3]:2025-10-28 12:56:08,675 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.48 seconds.
[rank0]:2025-10-28 12:56:08,814 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-28 12:56:08,823 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.86 seconds.
[rank3]:2025-10-28 12:56:09,150 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_1F1B_nofreeze_dm1/pipeline_schedule/251028_1256_real_step800_rank3.svg
[rank3]:> Batch Time: 1910.72 ms, GPU Bubble Ratio: 58.36%, 50.37%, 64.35%, 15.25%
[rank3]:2025-10-28 12:56:11,324 - INFO - Avg. fwd time: 66.9899 / Avg. bwd time: 134.6256 / Avg. batch time: 1670.4536 (ms) / GPU bubble ratio: 3.44%
[rank2]:2025-10-28 12:56:11,383 - INFO - Avg. fwd time: 33.5519 / Avg. bwd time: 52.3185 / Avg. batch time: 1758.4009 (ms) / GPU bubble ratio: 60.93%
[rank1]:2025-10-28 12:56:11,454 - INFO - Avg. fwd time: 48.2894 / Avg. bwd time: 69.7044 / Avg. batch time: 1873.8771 (ms) / GPU bubble ratio: 49.63%
[rank0]:2025-10-28 12:56:11,522 - INFO - Avg. fwd time: 39.1373 / Avg. bwd time: 59.1793 / Avg. batch time: 1970.6743 (ms) / GPU bubble ratio: 60.09%
[rank2]:2025-10-28 12:56:51,304 - WARNING - Dataset alpaca is being re-looped
[rank3]:2025-10-28 12:56:51,245 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-28 12:56:51,372 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-28 12:56:51,435 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-28 12:57:34,344 - INFO -  step: 820  loss: -2.0000  grad_norm:  0.5362  memory:  7.21GiB(15.18%)  tps: 1,836  tflops: 13.99  mfu: 4.48%
[rank1]:2025-10-28 12:57:34,347 - INFO -  step: 820  loss: -2.0000  grad_norm:  0.5362  memory: 10.73GiB(22.58%)  tps: 1,835  tflops: 13.98  mfu: 4.48%
[rank3]:2025-10-28 12:57:34,357 - INFO -  step: 820  loss:  0.2359  grad_norm:  0.5362  memory: 24.67GiB(51.93%)  tps: 1,838  tflops: 14.00  mfu: 4.49%
[rank0]:2025-10-28 12:57:34,362 - INFO -  step: 820  loss: -2.0000  grad_norm:  0.5362  memory: 14.87GiB(31.30%)  tps: 1,833  tflops: 13.96  mfu: 4.47%
[rank2]:2025-10-28 12:58:54,260 - INFO -  step: 840  loss: -2.0000  grad_norm:  0.7246  memory:  7.21GiB(15.18%)  tps: 2,050  tflops: 15.61  mfu: 5.00%
[rank3]:2025-10-28 12:58:54,272 - INFO -  step: 840  loss:  0.2229  grad_norm:  0.7246  memory: 24.67GiB(51.93%)  tps: 2,050  tflops: 15.61  mfu: 5.00%
[rank1]:2025-10-28 12:58:54,264 - INFO -  step: 840  loss: -2.0000  grad_norm:  0.7246  memory: 10.73GiB(22.58%)  tps: 2,050  tflops: 15.61  mfu: 5.00%
[rank0]:2025-10-28 12:58:54,278 - INFO -  step: 840  loss: -2.0000  grad_norm:  0.7246  memory: 14.87GiB(31.30%)  tps: 2,050  tflops: 15.61  mfu: 5.00%
[rank2]:2025-10-28 12:58:56,164 - INFO - Avg. fwd time: 33.5519 / Avg. bwd time: 52.3283 / Avg. batch time: 1758.0763 (ms) / GPU bubble ratio: 60.92%
[rank3]:2025-10-28 12:58:56,108 - INFO - Avg. fwd time: 66.9735 / Avg. bwd time: 134.6097 / Avg. batch time: 1670.1475 (ms) / GPU bubble ratio: 3.44%
[rank1]:2025-10-28 12:58:56,237 - INFO - Avg. fwd time: 48.2970 / Avg. bwd time: 69.7241 / Avg. batch time: 1873.5626 (ms) / GPU bubble ratio: 49.61%
[rank0]:2025-10-28 12:58:56,304 - INFO - Avg. fwd time: 39.1401 / Avg. bwd time: 59.1629 / Avg. batch time: 1970.3311 (ms) / GPU bubble ratio: 60.09%
[rank0]:2025-10-28 12:59:30,423 - INFO - [GC] Peforming periodical GC collection 0.25 seconds
[rank2]:2025-10-28 13:00:14,197 - INFO -  step: 860  loss: -2.0000  grad_norm:  0.4834  memory:  7.21GiB(15.18%)  tps: 2,050  tflops: 15.61  mfu: 5.00%
[rank1]:2025-10-28 13:00:14,201 - INFO -  step: 860  loss: -2.0000  grad_norm:  0.4834  memory: 10.73GiB(22.58%)  tps: 2,050  tflops: 15.61  mfu: 5.00%
[rank3]:2025-10-28 13:00:14,212 - INFO -  step: 860  loss:  0.2245  grad_norm:  0.4834  memory: 24.67GiB(51.93%)  tps: 2,050  tflops: 15.61  mfu: 5.00%
[rank0]:2025-10-28 13:00:14,217 - INFO -  step: 860  loss: -2.0000  grad_norm:  0.4834  memory: 14.87GiB(31.30%)  tps: 2,050  tflops: 15.61  mfu: 5.00%
[rank2]:2025-10-28 13:01:34,622 - INFO -  step: 880  loss: -2.0000  grad_norm:  0.7422  memory:  7.21GiB(15.18%)  tps: 2,037  tflops: 15.52  mfu: 4.97%
[rank1]:2025-10-28 13:01:34,626 - INFO -  step: 880  loss: -2.0000  grad_norm:  0.7422  memory: 10.73GiB(22.58%)  tps: 2,037  tflops: 15.52  mfu: 4.97%
[rank3]:2025-10-28 13:01:34,635 - INFO -  step: 880  loss:  0.2727  grad_norm:  0.7422  memory: 24.67GiB(51.93%)  tps: 2,037  tflops: 15.52  mfu: 4.97%
[rank0]:2025-10-28 13:01:34,648 - INFO -  step: 880  loss: -2.0000  grad_norm:  0.7422  memory: 14.87GiB(31.30%)  tps: 2,037  tflops: 15.51  mfu: 4.97%
[rank3]:2025-10-28 13:01:36,488 - INFO - Avg. fwd time: 66.9779 / Avg. bwd time: 134.6155 / Avg. batch time: 1670.1852 (ms) / GPU bubble ratio: 3.44%
[rank2]:2025-10-28 13:01:36,544 - INFO - Avg. fwd time: 33.5555 / Avg. bwd time: 52.3244 / Avg. batch time: 1758.0873 (ms) / GPU bubble ratio: 60.92%
[rank1]:2025-10-28 13:01:36,622 - INFO - Avg. fwd time: 48.2629 / Avg. bwd time: 69.7242 / Avg. batch time: 1873.5620 (ms) / GPU bubble ratio: 49.62%
[rank0]:2025-10-28 13:01:36,688 - INFO - Avg. fwd time: 39.1260 / Avg. bwd time: 59.1648 / Avg. batch time: 1970.3042 (ms) / GPU bubble ratio: 60.09%
[rank0]:2025-10-28 13:02:51,047 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-28 13:02:55,036 - INFO -  step: 900  loss: -2.0000  grad_norm:  0.4302  memory:  7.21GiB(15.18%)  tps: 2,037  tflops: 15.52  mfu: 4.97%
[rank2]:2025-10-28 13:02:55,036 - INFO - ðŸ”Ž  Running validation at step 900
[rank1]:2025-10-28 13:02:55,039 - INFO -  step: 900  loss: -2.0000  grad_norm:  0.4302  memory: 10.73GiB(22.58%)  tps: 2,037  tflops: 15.52  mfu: 4.97%
[rank1]:2025-10-28 13:02:55,040 - INFO - ðŸ”Ž  Running validation at step 900
[rank3]:2025-10-28 13:02:55,048 - INFO -  step: 900  loss:  0.2152  grad_norm:  0.4302  memory: 24.67GiB(51.93%)  tps: 2,038  tflops: 15.52  mfu: 4.97%
[rank3]:2025-10-28 13:02:55,049 - INFO - ðŸ”Ž  Running validation at step 900
[rank0]:2025-10-28 13:02:55,053 - INFO -  step: 900  loss: -2.0000  grad_norm:  0.4302  memory: 14.87GiB(31.30%)  tps: 2,038  tflops: 15.52  mfu: 4.97%
[rank0]:2025-10-28 13:02:55,053 - INFO - ðŸ”Ž  Running validation at step 900
[rank0]:2025-10-28 13:04:04,577 - INFO - validate step: 900  loss: -1.0000  memory: 14.87GiB(31.30%)  tps: 5,892
[rank1]:2025-10-28 13:04:04,656 - INFO - validate step: 900  loss: -1.0000  memory: 10.73GiB(22.58%)  tps: 5,884
[rank2]:2025-10-28 13:04:04,739 - INFO - validate step: 900  loss: -1.0000  memory:  7.21GiB(15.18%)  tps: 5,876
[rank3]:2025-10-28 13:04:04,806 - INFO - validate step: 900  loss:  0.9311  memory: 24.67GiB(51.93%)  tps: 5,872
[rank3]:2025-10-28 13:04:05,008 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_1F1B_nofreeze_dm1/pipeline_schedule/251028_1304_real_step900_rank3.svg
[rank3]:> Batch Time: 1910.55 ms, GPU Bubble Ratio: 58.36%, 50.35%, 64.36%, 15.25%
[rank2]:2025-10-28 13:05:25,195 - INFO -  step: 920  loss: -2.0000  grad_norm:  0.8024  memory:  7.21GiB(15.18%)  tps: 2,036  tflops: 15.51  mfu: 4.97%
[rank1]:2025-10-28 13:05:25,203 - INFO -  step: 920  loss: -2.0000  grad_norm:  0.8024  memory: 10.73GiB(22.58%)  tps: 2,034  tflops: 15.49  mfu: 4.97%
[rank3]:2025-10-28 13:05:25,208 - INFO -  step: 920  loss:  0.3085  grad_norm:  0.8024  memory: 24.67GiB(51.93%)  tps: 2,038  tflops: 15.52  mfu: 4.97%
[rank0]:2025-10-28 13:05:25,220 - INFO -  step: 920  loss: -2.0000  grad_norm:  0.8024  memory: 14.87GiB(31.30%)  tps: 2,032  tflops: 15.47  mfu: 4.96%
[rank2]:2025-10-28 13:05:27,085 - INFO - Avg. fwd time: 33.5562 / Avg. bwd time: 52.3255 / Avg. batch time: 1758.3506 (ms) / GPU bubble ratio: 60.93%
[rank3]:2025-10-28 13:05:27,022 - INFO - Avg. fwd time: 66.9894 / Avg. bwd time: 134.6384 / Avg. batch time: 1670.4210 (ms) / GPU bubble ratio: 3.44%
[rank1]:2025-10-28 13:05:27,155 - INFO - Avg. fwd time: 48.2624 / Avg. bwd time: 69.7364 / Avg. batch time: 1873.8433 (ms) / GPU bubble ratio: 49.62%
[rank0]:2025-10-28 13:05:27,217 - INFO - Avg. fwd time: 39.1252 / Avg. bwd time: 59.1721 / Avg. batch time: 1970.6003 (ms) / GPU bubble ratio: 60.09%
[rank3]:2025-10-28 13:06:45,343 - INFO -  step: 940  loss:  0.2594  grad_norm:  0.5311  memory: 24.67GiB(51.93%)  tps: 2,045  tflops: 15.57  mfu: 4.99%
[rank2]:2025-10-28 13:06:45,330 - INFO -  step: 940  loss: -2.0000  grad_norm:  0.5311  memory:  7.21GiB(15.18%)  tps: 2,045  tflops: 15.57  mfu: 4.99%
[rank1]:2025-10-28 13:06:45,333 - INFO -  step: 940  loss: -2.0000  grad_norm:  0.5311  memory: 10.73GiB(22.58%)  tps: 2,045  tflops: 15.57  mfu: 4.99%
[rank0]:2025-10-28 13:06:45,344 - INFO -  step: 940  loss: -2.0000  grad_norm:  0.5311  memory: 14.87GiB(31.30%)  tps: 2,045  tflops: 15.57  mfu: 4.99%
[rank0]:2025-10-28 13:07:21,330 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-28 13:08:05,249 - INFO -  step: 960  loss:  0.2958  grad_norm:  0.7782  memory: 24.67GiB(51.93%)  tps: 2,050  tflops: 15.62  mfu: 5.01%
[rank2]:2025-10-28 13:08:05,237 - INFO -  step: 960  loss: -2.0000  grad_norm:  0.7782  memory:  7.21GiB(15.18%)  tps: 2,050  tflops: 15.62  mfu: 5.01%
[rank1]:2025-10-28 13:08:05,248 - INFO -  step: 960  loss: -2.0000  grad_norm:  0.7782  memory: 10.73GiB(22.58%)  tps: 2,050  tflops: 15.61  mfu: 5.00%
[rank0]:2025-10-28 13:08:05,263 - INFO -  step: 960  loss: -2.0000  grad_norm:  0.7782  memory: 14.87GiB(31.30%)  tps: 2,050  tflops: 15.61  mfu: 5.00%
[rank3]:2025-10-28 13:08:07,110 - INFO - Avg. fwd time: 66.9986 / Avg. bwd time: 134.6386 / Avg. batch time: 1670.4589 (ms) / GPU bubble ratio: 3.43%
[rank2]:2025-10-28 13:08:07,166 - INFO - Avg. fwd time: 33.5669 / Avg. bwd time: 52.3247 / Avg. batch time: 1758.3729 (ms) / GPU bubble ratio: 60.92%
[rank1]:2025-10-28 13:08:07,236 - INFO - Avg. fwd time: 48.2221 / Avg. bwd time: 69.7276 / Avg. batch time: 1873.8357 (ms) / GPU bubble ratio: 49.64%
[rank0]:2025-10-28 13:08:07,303 - INFO - Avg. fwd time: 39.0961 / Avg. bwd time: 59.1654 / Avg. batch time: 1970.5215 (ms) / GPU bubble ratio: 60.11%
[rank3]:2025-10-28 13:09:25,566 - INFO -  step: 980  loss:  0.2429  grad_norm:  0.4612  memory: 24.67GiB(51.93%)  tps: 2,040  tflops: 15.54  mfu: 4.98%
[rank2]:2025-10-28 13:09:25,553 - INFO -  step: 980  loss: -2.0000  grad_norm:  0.4612  memory:  7.21GiB(15.18%)  tps: 2,040  tflops: 15.54  mfu: 4.98%
[rank1]:2025-10-28 13:09:25,557 - INFO -  step: 980  loss: -2.0000  grad_norm:  0.4612  memory: 10.73GiB(22.58%)  tps: 2,040  tflops: 15.54  mfu: 4.98%
[rank0]:2025-10-28 13:09:25,578 - INFO -  step: 980  loss: -2.0000  grad_norm:  0.4612  memory: 14.87GiB(31.30%)  tps: 2,040  tflops: 15.54  mfu: 4.98%
[rank0]:2025-10-28 13:10:41,604 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-28 13:10:45,703 - INFO -  step: 1000  loss: -2.0000  grad_norm:  0.7521  memory:  7.21GiB(15.18%)  tps: 2,044  tflops: 15.57  mfu: 4.99%
[rank2]:2025-10-28 13:10:45,703 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-10-28 13:10:45,727 - INFO -  step: 1000  loss: -2.0000  grad_norm:  0.7521  memory: 14.87GiB(31.30%)  tps: 2,044  tflops: 15.57  mfu: 4.99%
[rank0]:2025-10-28 13:10:45,727 - INFO - ðŸ”Ž  Running validation at step 1000
[rank1]:2025-10-28 13:10:45,714 - INFO -  step: 1000  loss: -2.0000  grad_norm:  0.7521  memory: 10.73GiB(22.58%)  tps: 2,044  tflops: 15.57  mfu: 4.99%
[rank1]:2025-10-28 13:10:45,714 - INFO - ðŸ”Ž  Running validation at step 1000
[rank3]:2025-10-28 13:10:45,716 - INFO -  step: 1000  loss:  0.2834  grad_norm:  0.7521  memory: 24.67GiB(51.93%)  tps: 2,044  tflops: 15.57  mfu: 4.99%
[rank3]:2025-10-28 13:10:45,716 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-10-28 13:11:55,637 - INFO - validate step: 1000  loss: -1.0000  memory: 14.87GiB(31.30%)  tps: 5,859
[rank1]:2025-10-28 13:11:55,724 - INFO - validate step: 1000  loss: -1.0000  memory: 10.73GiB(22.58%)  tps: 5,851
[rank2]:2025-10-28 13:11:55,802 - INFO - validate step: 1000  loss: -1.0000  memory:  7.21GiB(15.18%)  tps: 5,843
[rank3]:2025-10-28 13:11:55,889 - INFO - validate step: 1000  loss:  0.9375  memory: 24.67GiB(51.93%)  tps: 5,839
[rank3]:2025-10-28 13:11:56,096 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_1F1B_nofreeze_dm1/pipeline_schedule/251028_1311_real_step1000_rank3.svg
[rank3]:> Batch Time: 1910.70 ms, GPU Bubble Ratio: 58.38%, 50.40%, 64.35%, 15.24%
[rank3]:2025-10-28 13:11:57,805 - INFO - Avg. fwd time: 67.0129 / Avg. bwd time: 134.6520 / Avg. batch time: 1670.6461 (ms) / GPU bubble ratio: 3.43%
[rank2]:2025-10-28 13:11:57,865 - INFO - Avg. fwd time: 33.5745 / Avg. bwd time: 52.3229 / Avg. batch time: 1758.5873 (ms) / GPU bubble ratio: 60.92%
[rank0]:2025-10-28 13:11:58,003 - INFO - Avg. fwd time: 39.0963 / Avg. bwd time: 59.1641 / Avg. batch time: 1970.6788 (ms) / GPU bubble ratio: 60.11%
[rank1]:2025-10-28 13:11:57,936 - INFO - Avg. fwd time: 48.2059 / Avg. bwd time: 69.7387 / Avg. batch time: 1874.0241 (ms) / GPU bubble ratio: 49.65%
[rank2]:2025-10-28 13:13:16,240 - INFO -  step: 1020  loss: -2.0000  grad_norm:  0.5099  memory:  7.21GiB(15.18%)  tps: 2,037  tflops: 15.51  mfu: 4.97%
[rank3]:2025-10-28 13:13:16,252 - INFO -  step: 1020  loss:  0.2009  grad_norm:  0.5099  memory: 24.67GiB(51.93%)  tps: 2,039  tflops: 15.53  mfu: 4.98%
[rank0]:2025-10-28 13:13:16,254 - INFO -  step: 1020  loss: -2.0000  grad_norm:  0.5099  memory: 14.87GiB(31.30%)  tps: 2,032  tflops: 15.48  mfu: 4.96%
[rank1]:2025-10-28 13:13:16,243 - INFO -  step: 1020  loss: -2.0000  grad_norm:  0.5099  memory: 10.73GiB(22.58%)  tps: 2,035  tflops: 15.50  mfu: 4.97%
[rank2]:2025-10-28 13:14:36,054 - INFO -  step: 1040  loss: -2.0000  grad_norm:  0.7029  memory:  7.21GiB(15.18%)  tps: 2,053  tflops: 15.63  mfu: 5.01%
[rank3]:2025-10-28 13:14:36,066 - INFO -  step: 1040  loss:  0.2218  grad_norm:  0.7029  memory: 24.67GiB(51.93%)  tps: 2,053  tflops: 15.63  mfu: 5.01%
[rank0]:2025-10-28 13:14:36,077 - INFO -  step: 1040  loss: -2.0000  grad_norm:  0.7029  memory: 14.87GiB(31.30%)  tps: 2,053  tflops: 15.63  mfu: 5.01%
[rank1]:2025-10-28 13:14:36,058 - INFO -  step: 1040  loss: -2.0000  grad_norm:  0.7029  memory: 10.73GiB(22.58%)  tps: 2,053  tflops: 15.63  mfu: 5.01%
[rank3]:2025-10-28 13:14:37,914 - INFO - Avg. fwd time: 67.0205 / Avg. bwd time: 134.6529 / Avg. batch time: 1670.6825 (ms) / GPU bubble ratio: 3.43%
[rank2]:2025-10-28 13:14:37,976 - INFO - Avg. fwd time: 33.5806 / Avg. bwd time: 52.3200 / Avg. batch time: 1758.5933 (ms) / GPU bubble ratio: 60.92%
[rank0]:2025-10-28 13:14:38,118 - INFO - Avg. fwd time: 39.1004 / Avg. bwd time: 59.1659 / Avg. batch time: 1970.6170 (ms) / GPU bubble ratio: 60.11%
[rank1]:2025-10-28 13:14:38,056 - INFO - Avg. fwd time: 48.2033 / Avg. bwd time: 69.6994 / Avg. batch time: 1873.9597 (ms) / GPU bubble ratio: 49.67%
[rank0]:2025-10-28 13:15:12,304 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-28 13:15:56,374 - INFO -  step: 1060  loss: -2.0000  grad_norm:  0.4629  memory: 14.87GiB(31.30%)  tps: 2,040  tflops: 15.54  mfu: 4.98%
[rank2]:2025-10-28 13:15:56,353 - INFO -  step: 1060  loss: -2.0000  grad_norm:  0.4629  memory:  7.21GiB(15.18%)  tps: 2,040  tflops: 15.54  mfu: 4.98%
[rank3]:2025-10-28 13:15:56,366 - INFO -  step: 1060  loss:  0.1832  grad_norm:  0.4629  memory: 24.67GiB(51.93%)  tps: 2,040  tflops: 15.54  mfu: 4.98%
[rank1]:2025-10-28 13:15:56,357 - INFO -  step: 1060  loss: -2.0000  grad_norm:  0.4629  memory: 10.73GiB(22.58%)  tps: 2,040  tflops: 15.54  mfu: 4.98%
[rank0]:2025-10-28 13:17:16,597 - INFO -  step: 1080  loss: -2.0000  grad_norm:  0.6993  memory: 14.87GiB(31.30%)  tps: 2,042  tflops: 15.55  mfu: 4.99%
[rank2]:2025-10-28 13:17:16,578 - INFO -  step: 1080  loss: -2.0000  grad_norm:  0.6993  memory:  7.21GiB(15.18%)  tps: 2,042  tflops: 15.55  mfu: 4.99%
[rank3]:2025-10-28 13:17:16,590 - INFO -  step: 1080  loss:  0.1595  grad_norm:  0.6993  memory: 24.67GiB(51.93%)  tps: 2,042  tflops: 15.55  mfu: 4.99%
[rank1]:2025-10-28 13:17:16,582 - INFO -  step: 1080  loss: -2.0000  grad_norm:  0.6993  memory: 10.73GiB(22.58%)  tps: 2,042  tflops: 15.56  mfu: 4.99%
[rank3]:2025-10-28 13:17:18,427 - INFO - Avg. fwd time: 67.0213 / Avg. bwd time: 134.6695 / Avg. batch time: 1670.7917 (ms) / GPU bubble ratio: 3.43%
[rank2]:2025-10-28 13:17:18,487 - INFO - Avg. fwd time: 33.5746 / Avg. bwd time: 52.3145 / Avg. batch time: 1758.6690 (ms) / GPU bubble ratio: 60.93%
[rank1]:2025-10-28 13:17:18,557 - INFO - Avg. fwd time: 48.1933 / Avg. bwd time: 69.7062 / Avg. batch time: 1874.0814 (ms) / GPU bubble ratio: 49.67%
[rank0]:2025-10-28 13:17:18,625 - INFO - Avg. fwd time: 39.0775 / Avg. bwd time: 59.1605 / Avg. batch time: 1970.7499 (ms) / GPU bubble ratio: 60.12%
[rank0]:2025-10-28 13:18:32,874 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-28 13:18:36,911 - INFO -  step: 1100  loss: -2.0000  grad_norm:  0.5329  memory: 14.87GiB(31.30%)  tps: 2,040  tflops: 15.54  mfu: 4.98%
[rank0]:2025-10-28 13:18:36,911 - INFO - ðŸ”Ž  Running validation at step 1100
[rank2]:2025-10-28 13:18:36,894 - INFO -  step: 1100  loss: -2.0000  grad_norm:  0.5329  memory:  7.21GiB(15.18%)  tps: 2,040  tflops: 15.54  mfu: 4.98%
[rank2]:2025-10-28 13:18:36,894 - INFO - ðŸ”Ž  Running validation at step 1100
[rank3]:2025-10-28 13:18:36,906 - INFO -  step: 1100  loss:  0.2859  grad_norm:  0.5329  memory: 24.67GiB(51.93%)  tps: 2,040  tflops: 15.54  mfu: 4.98%
[rank3]:2025-10-28 13:18:36,907 - INFO - ðŸ”Ž  Running validation at step 1100
[rank1]:2025-10-28 13:18:36,898 - INFO -  step: 1100  loss: -2.0000  grad_norm:  0.5329  memory: 10.73GiB(22.58%)  tps: 2,040  tflops: 15.54  mfu: 4.98%
[rank1]:2025-10-28 13:18:36,898 - INFO - ðŸ”Ž  Running validation at step 1100
[rank0]:2025-10-28 13:19:46,368 - INFO - validate step: 1100  loss: -1.0000  memory: 14.87GiB(31.30%)  tps: 5,897
[rank1]:2025-10-28 13:19:46,446 - INFO - validate step: 1100  loss: -1.0000  memory: 10.73GiB(22.58%)  tps: 5,889
[rank2]:2025-10-28 13:19:46,529 - INFO - validate step: 1100  loss: -1.0000  memory:  7.21GiB(15.18%)  tps: 5,882
[rank3]:2025-10-28 13:19:46,595 - INFO - validate step: 1100  loss:  0.9456  memory: 24.67GiB(51.93%)  tps: 5,878
[rank3]:2025-10-28 13:19:46,802 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_1F1B_nofreeze_dm1/pipeline_schedule/251028_1319_real_step1100_rank3.svg
[rank3]:> Batch Time: 1911.06 ms, GPU Bubble Ratio: 58.40%, 50.41%, 64.35%, 15.24%
[rank0]:2025-10-28 13:21:07,612 - INFO -  step: 1120  loss: -2.0000  grad_norm:  0.7020  memory: 14.87GiB(31.30%)  tps: 2,017  tflops: 15.36  mfu: 4.92%
[rank2]:2025-10-28 13:21:07,592 - INFO -  step: 1120  loss: -2.0000  grad_norm:  0.7020  memory:  7.21GiB(15.18%)  tps: 2,021  tflops: 15.39  mfu: 4.93%
[rank3]:2025-10-28 13:21:07,604 - INFO -  step: 1120  loss:  0.1963  grad_norm:  0.7020  memory: 24.67GiB(51.93%)  tps: 2,023  tflops: 15.40  mfu: 4.94%
[rank1]:2025-10-28 13:21:07,596 - INFO -  step: 1120  loss: -2.0000  grad_norm:  0.7020  memory: 10.73GiB(22.58%)  tps: 2,019  tflops: 15.38  mfu: 4.93%
[rank3]:2025-10-28 13:21:09,414 - INFO - Avg. fwd time: 67.0366 / Avg. bwd time: 134.7070 / Avg. batch time: 1671.1878 (ms) / GPU bubble ratio: 3.43%
[rank2]:2025-10-28 13:21:09,476 - INFO - Avg. fwd time: 33.5703 / Avg. bwd time: 52.3195 / Avg. batch time: 1759.1022 (ms) / GPU bubble ratio: 60.94%
[rank1]:2025-10-28 13:21:09,547 - INFO - Avg. fwd time: 48.2105 / Avg. bwd time: 69.7396 / Avg. batch time: 1874.5307 (ms) / GPU bubble ratio: 49.66%
[rank0]:2025-10-28 13:21:09,615 - INFO - Avg. fwd time: 39.0907 / Avg. bwd time: 59.1665 / Avg. batch time: 1971.2209 (ms) / GPU bubble ratio: 60.12%
[rank2]:2025-10-28 13:22:28,100 - INFO -  step: 1140  loss: -2.0000  grad_norm:  0.4076  memory:  7.21GiB(15.18%)  tps: 2,035  tflops: 15.50  mfu: 4.97%
[rank3]:2025-10-28 13:22:28,111 - INFO -  step: 1140  loss:  0.1669  grad_norm:  0.4076  memory: 24.67GiB(51.93%)  tps: 2,035  tflops: 15.50  mfu: 4.97%
[rank1]:2025-10-28 13:22:28,103 - INFO -  step: 1140  loss: -2.0000  grad_norm:  0.4076  memory: 10.73GiB(22.58%)  tps: 2,035  tflops: 15.50  mfu: 4.97%
[rank0]:2025-10-28 13:22:28,117 - INFO -  step: 1140  loss: -2.0000  grad_norm:  0.4076  memory: 14.87GiB(31.30%)  tps: 2,035  tflops: 15.50  mfu: 4.97%
[rank0]:2025-10-28 13:23:04,352 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-28 13:23:48,564 - INFO -  step: 1160  loss:  0.2270  grad_norm:  0.7281  memory: 24.67GiB(51.93%)  tps: 2,037  tflops: 15.51  mfu: 4.97%
[rank1]:2025-10-28 13:23:48,556 - INFO -  step: 1160  loss: -2.0000  grad_norm:  0.7281  memory: 10.73GiB(22.58%)  tps: 2,036  tflops: 15.51  mfu: 4.97%
[rank0]:2025-10-28 13:23:48,576 - INFO -  step: 1160  loss: -2.0000  grad_norm:  0.7281  memory: 14.87GiB(31.30%)  tps: 2,036  tflops: 15.51  mfu: 4.97%
[rank2]:2025-10-28 13:23:48,552 - INFO -  step: 1160  loss: -2.0000  grad_norm:  0.7281  memory:  7.21GiB(15.18%)  tps: 2,037  tflops: 15.51  mfu: 4.97%
[rank3]:2025-10-28 13:23:50,406 - INFO - Avg. fwd time: 67.0469 / Avg. bwd time: 134.7329 / Avg. batch time: 1671.4522 (ms) / GPU bubble ratio: 3.42%
[rank2]:2025-10-28 13:23:50,465 - INFO - Avg. fwd time: 33.5758 / Avg. bwd time: 52.3279 / Avg. batch time: 1759.3408 (ms) / GPU bubble ratio: 60.94%
[rank1]:2025-10-28 13:23:50,545 - INFO - Avg. fwd time: 48.2599 / Avg. bwd time: 69.7764 / Avg. batch time: 1874.8132 (ms) / GPU bubble ratio: 49.63%
[rank0]:2025-10-28 13:23:50,613 - INFO - Avg. fwd time: 39.1217 / Avg. bwd time: 59.1828 / Avg. batch time: 1971.5321 (ms) / GPU bubble ratio: 60.11%
[rank2]:2025-10-28 13:25:08,915 - INFO -  step: 1180  loss: -2.0000  grad_norm:  0.6185  memory:  7.21GiB(15.18%)  tps: 2,039  tflops: 15.53  mfu: 4.98%
[rank3]:2025-10-28 13:25:08,928 - INFO -  step: 1180  loss:  0.2236  grad_norm:  0.6185  memory: 24.67GiB(51.93%)  tps: 2,039  tflops: 15.53  mfu: 4.98%
[rank1]:2025-10-28 13:25:08,919 - INFO -  step: 1180  loss: -2.0000  grad_norm:  0.6185  memory: 10.73GiB(22.58%)  tps: 2,039  tflops: 15.53  mfu: 4.98%
[rank0]:2025-10-28 13:25:08,931 - INFO -  step: 1180  loss: -2.0000  grad_norm:  0.6185  memory: 14.87GiB(31.30%)  tps: 2,039  tflops: 15.53  mfu: 4.98%
[rank0]:2025-10-28 13:26:24,902 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-28 13:26:28,939 - INFO -  step: 1200  loss:  0.1682  grad_norm:  0.6898  memory: 24.67GiB(51.93%)  tps: 2,048  tflops: 15.60  mfu: 5.00%
[rank3]:2025-10-28 13:26:28,940 - INFO - ðŸ”Ž  Running validation at step 1200
[rank2]:2025-10-28 13:26:28,927 - INFO -  step: 1200  loss: -2.0000  grad_norm:  0.6898  memory:  7.21GiB(15.18%)  tps: 2,048  tflops: 15.60  mfu: 5.00%
[rank2]:2025-10-28 13:26:28,927 - INFO - ðŸ”Ž  Running validation at step 1200
[rank1]:2025-10-28 13:26:28,932 - INFO -  step: 1200  loss: -2.0000  grad_norm:  0.6898  memory: 10.73GiB(22.58%)  tps: 2,048  tflops: 15.60  mfu: 5.00%
[rank1]:2025-10-28 13:26:28,932 - INFO - ðŸ”Ž  Running validation at step 1200
[rank0]:2025-10-28 13:26:28,946 - INFO -  step: 1200  loss: -2.0000  grad_norm:  0.6898  memory: 14.87GiB(31.30%)  tps: 2,048  tflops: 15.60  mfu: 5.00%
[rank0]:2025-10-28 13:26:28,946 - INFO - ðŸ”Ž  Running validation at step 1200
[rank0]:2025-10-28 13:27:38,349 - INFO - validate step: 1200  loss: -1.0000  memory: 14.87GiB(31.30%)  tps: 5,902
[rank1]:2025-10-28 13:27:38,432 - INFO - validate step: 1200  loss: -1.0000  memory: 10.73GiB(22.58%)  tps: 5,894
[rank2]:2025-10-28 13:27:38,511 - INFO - validate step: 1200  loss: -1.0000  memory:  7.21GiB(15.18%)  tps: 5,886
[rank3]:2025-10-28 13:27:38,575 - INFO - validate step: 1200  loss:  0.9471  memory: 24.67GiB(51.93%)  tps: 5,882
[rank3]:2025-10-28 13:27:38,787 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_1F1B_nofreeze_dm1/pipeline_schedule/251028_1327_real_step1200_rank3.svg
[rank3]:> Batch Time: 1911.88 ms, GPU Bubble Ratio: 58.40%, 50.36%, 64.36%, 15.24%
[rank3]:2025-10-28 13:27:40,536 - INFO - Avg. fwd time: 67.0531 / Avg. bwd time: 134.7400 / Avg. batch time: 1671.5353 (ms) / GPU bubble ratio: 3.42%
[rank2]:2025-10-28 13:27:40,597 - INFO - Avg. fwd time: 33.5815 / Avg. bwd time: 52.3337 / Avg. batch time: 1759.4371 (ms) / GPU bubble ratio: 60.94%
[rank1]:2025-10-28 13:27:40,667 - INFO - Avg. fwd time: 48.2645 / Avg. bwd time: 69.7639 / Avg. batch time: 1874.8905 (ms) / GPU bubble ratio: 49.64%
[rank0]:2025-10-28 13:27:40,734 - INFO - Avg. fwd time: 39.1299 / Avg. bwd time: 59.1713 / Avg. batch time: 1971.6048 (ms) / GPU bubble ratio: 60.11%
[rank1]:2025-10-28 13:28:58,878 - INFO -  step: 1220  loss: -2.0000  grad_norm:  0.4732  memory: 10.73GiB(22.58%)  tps: 2,037  tflops: 15.51  mfu: 4.97%
[rank0]:2025-10-28 13:28:58,891 - INFO -  step: 1220  loss: -2.0000  grad_norm:  0.4732  memory: 14.87GiB(31.30%)  tps: 2,034  tflops: 15.49  mfu: 4.97%
[rank3]:2025-10-28 13:28:58,882 - INFO -  step: 1220  loss:  0.1874  grad_norm:  0.4732  memory: 24.67GiB(51.93%)  tps: 2,040  tflops: 15.54  mfu: 4.98%
[rank2]:2025-10-28 13:28:58,870 - INFO -  step: 1220  loss: -2.0000  grad_norm:  0.4732  memory:  7.21GiB(15.18%)  tps: 2,039  tflops: 15.53  mfu: 4.98%
[rank1]:2025-10-28 13:30:18,905 - INFO -  step: 1240  loss: -2.0000  grad_norm:  0.6760  memory: 10.73GiB(22.58%)  tps: 2,047  tflops: 15.59  mfu: 5.00%
[rank0]:2025-10-28 13:30:18,909 - INFO -  step: 1240  loss: -2.0000  grad_norm:  0.6760  memory: 14.87GiB(31.30%)  tps: 2,048  tflops: 15.59  mfu: 5.00%
[rank3]:2025-10-28 13:30:18,907 - INFO -  step: 1240  loss:  0.2116  grad_norm:  0.6760  memory: 24.67GiB(51.93%)  tps: 2,047  tflops: 15.59  mfu: 5.00%
[rank2]:2025-10-28 13:30:18,895 - INFO -  step: 1240  loss: -2.0000  grad_norm:  0.6760  memory:  7.21GiB(15.18%)  tps: 2,047  tflops: 15.59  mfu: 5.00%
[rank3]:2025-10-28 13:30:20,743 - INFO - Avg. fwd time: 67.0628 / Avg. bwd time: 134.7382 / Avg. batch time: 1671.5772 (ms) / GPU bubble ratio: 3.42%
[rank2]:2025-10-28 13:30:20,806 - INFO - Avg. fwd time: 33.5890 / Avg. bwd time: 52.3385 / Avg. batch time: 1759.4634 (ms) / GPU bubble ratio: 60.93%
[rank1]:2025-10-28 13:30:20,886 - INFO - Avg. fwd time: 48.2669 / Avg. bwd time: 69.7627 / Avg. batch time: 1874.8669 (ms) / GPU bubble ratio: 49.64%
[rank0]:2025-10-28 13:30:20,949 - INFO - Avg. fwd time: 39.1412 / Avg. bwd time: 59.1643 / Avg. batch time: 1971.5685 (ms) / GPU bubble ratio: 60.11%
[rank0]:2025-10-28 13:30:55,347 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-28 13:31:39,617 - INFO -  step: 1260  loss: -2.0000  grad_norm:  0.4639  memory: 10.73GiB(22.58%)  tps: 2,030  tflops: 15.46  mfu: 4.96%
[rank0]:2025-10-28 13:31:39,632 - INFO -  step: 1260  loss: -2.0000  grad_norm:  0.4639  memory: 14.87GiB(31.30%)  tps: 2,030  tflops: 15.46  mfu: 4.95%
[rank2]:2025-10-28 13:31:39,613 - INFO -  step: 1260  loss: -2.0000  grad_norm:  0.4639  memory:  7.21GiB(15.18%)  tps: 2,030  tflops: 15.46  mfu: 4.95%
[rank3]:2025-10-28 13:31:39,625 - INFO -  step: 1260  loss:  0.2026  grad_norm:  0.4639  memory: 24.67GiB(51.93%)  tps: 2,030  tflops: 15.46  mfu: 4.96%
[rank2]:2025-10-28 13:33:00,120 - INFO -  step: 1280  loss: -2.0000  grad_norm:  0.7033  memory:  7.21GiB(15.18%)  tps: 2,035  tflops: 15.50  mfu: 4.97%
[rank3]:2025-10-28 13:33:00,132 - INFO -  step: 1280  loss:  0.1793  grad_norm:  0.7033  memory: 24.67GiB(51.93%)  tps: 2,035  tflops: 15.50  mfu: 4.97%
[rank1]:2025-10-28 13:33:00,125 - INFO -  step: 1280  loss: -2.0000  grad_norm:  0.7033  memory: 10.73GiB(22.58%)  tps: 2,035  tflops: 15.50  mfu: 4.97%
[rank0]:2025-10-28 13:33:00,145 - INFO -  step: 1280  loss: -2.0000  grad_norm:  0.7033  memory: 14.87GiB(31.30%)  tps: 2,035  tflops: 15.50  mfu: 4.97%
[rank2]:2025-10-28 13:33:02,037 - INFO - Avg. fwd time: 33.5950 / Avg. bwd time: 52.3406 / Avg. batch time: 1759.8132 (ms) / GPU bubble ratio: 60.93%
[rank3]:2025-10-28 13:33:01,980 - INFO - Avg. fwd time: 67.0854 / Avg. bwd time: 134.7648 / Avg. batch time: 1671.9503 (ms) / GPU bubble ratio: 3.42%
[rank1]:2025-10-28 13:33:02,116 - INFO - Avg. fwd time: 48.2773 / Avg. bwd time: 69.7515 / Avg. batch time: 1875.2033 (ms) / GPU bubble ratio: 49.65%
[rank0]:2025-10-28 13:33:02,183 - INFO - Avg. fwd time: 39.1585 / Avg. bwd time: 59.1672 / Avg. batch time: 1971.9214 (ms) / GPU bubble ratio: 60.11%
[rank0]:2025-10-28 13:34:16,076 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-28 13:34:20,032 - INFO -  step: 1300  loss: -2.0000  grad_norm:  0.5481  memory:  7.21GiB(15.18%)  tps: 2,050  tflops: 15.62  mfu: 5.00%
[rank2]:2025-10-28 13:34:20,032 - INFO - ðŸ”Ž  Running validation at step 1300
[rank3]:2025-10-28 13:34:20,045 - INFO -  step: 1300  loss:  0.2402  grad_norm:  0.5481  memory: 24.67GiB(51.93%)  tps: 2,050  tflops: 15.62  mfu: 5.00%
[rank3]:2025-10-28 13:34:20,045 - INFO - ðŸ”Ž  Running validation at step 1300
[rank1]:2025-10-28 13:34:20,036 - INFO -  step: 1300  loss: -2.0000  grad_norm:  0.5481  memory: 10.73GiB(22.58%)  tps: 2,050  tflops: 15.62  mfu: 5.00%
[rank1]:2025-10-28 13:34:20,037 - INFO - ðŸ”Ž  Running validation at step 1300
[rank0]:2025-10-28 13:34:20,054 - INFO -  step: 1300  loss: -2.0000  grad_norm:  0.5481  memory: 14.87GiB(31.30%)  tps: 2,050  tflops: 15.62  mfu: 5.01%
[rank0]:2025-10-28 13:34:20,054 - INFO - ðŸ”Ž  Running validation at step 1300
[rank0]:2025-10-28 13:35:29,906 - INFO - validate step: 1300  loss: -1.0000  memory: 14.87GiB(31.30%)  tps: 5,864
[rank1]:2025-10-28 13:35:29,989 - INFO - validate step: 1300  loss: -1.0000  memory: 10.73GiB(22.58%)  tps: 5,855
[rank2]:2025-10-28 13:35:30,073 - INFO - validate step: 1300  loss: -1.0000  memory:  7.21GiB(15.18%)  tps: 5,848
[rank3]:2025-10-28 13:35:30,135 - INFO - validate step: 1300  loss:  0.9458  memory: 24.67GiB(51.93%)  tps: 5,844
[rank3]:2025-10-28 13:35:30,343 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_1F1B_nofreeze_dm1/pipeline_schedule/251028_1335_real_step1300_rank3.svg
[rank3]:> Batch Time: 1912.39 ms, GPU Bubble Ratio: 58.40%, 50.38%, 64.35%, 15.23%
[rank0]:2025-10-28 13:36:50,124 - INFO -  step: 1320  loss: -2.0000  grad_norm:  0.7191  memory: 14.87GiB(31.30%)  tps: 2,042  tflops: 15.56  mfu: 4.99%
[rank2]:2025-10-28 13:36:50,110 - INFO -  step: 1320  loss: -2.0000  grad_norm:  0.7191  memory:  7.21GiB(15.18%)  tps: 2,047  tflops: 15.59  mfu: 5.00%
[rank3]:2025-10-28 13:36:50,122 - INFO -  step: 1320  loss:  0.1951  grad_norm:  0.7191  memory: 24.67GiB(51.93%)  tps: 2,048  tflops: 15.60  mfu: 5.00%
[rank1]:2025-10-28 13:36:50,113 - INFO -  step: 1320  loss: -2.0000  grad_norm:  0.7191  memory: 10.73GiB(22.58%)  tps: 2,045  tflops: 15.57  mfu: 4.99%
[rank3]:2025-10-28 13:36:51,960 - INFO - Avg. fwd time: 67.0903 / Avg. bwd time: 134.7540 / Avg. batch time: 1671.8838 (ms) / GPU bubble ratio: 3.42%
[rank2]:2025-10-28 13:36:52,024 - INFO - Avg. fwd time: 33.6025 / Avg. bwd time: 52.3392 / Avg. batch time: 1759.7558 (ms) / GPU bubble ratio: 60.93%
[rank1]:2025-10-28 13:36:52,104 - INFO - Avg. fwd time: 48.2642 / Avg. bwd time: 69.7387 / Avg. batch time: 1875.0931 (ms) / GPU bubble ratio: 49.65%
[rank0]:2025-10-28 13:36:52,166 - INFO - Avg. fwd time: 39.1680 / Avg. bwd time: 59.1575 / Avg. batch time: 1971.7587 (ms) / GPU bubble ratio: 60.11%
[rank3]:2025-10-28 13:38:10,057 - INFO -  step: 1340  loss:  0.2555  grad_norm:  0.5365  memory: 24.67GiB(51.93%)  tps: 2,050  tflops: 15.61  mfu: 5.00%
[rank1]:2025-10-28 13:38:10,050 - INFO -  step: 1340  loss: -2.0000  grad_norm:  0.5365  memory: 10.73GiB(22.58%)  tps: 2,050  tflops: 15.61  mfu: 5.00%
[rank0]:2025-10-28 13:38:10,065 - INFO -  step: 1340  loss: -2.0000  grad_norm:  0.5365  memory: 14.87GiB(31.30%)  tps: 2,050  tflops: 15.61  mfu: 5.00%
[rank2]:2025-10-28 13:38:10,045 - INFO -  step: 1340  loss: -2.0000  grad_norm:  0.5365  memory:  7.21GiB(15.18%)  tps: 2,050  tflops: 15.61  mfu: 5.00%
[rank0]:2025-10-28 13:38:46,231 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-28 13:39:30,421 - INFO -  step: 1360  loss: -2.0000  grad_norm:  0.7059  memory:  7.21GiB(15.18%)  tps: 2,038  tflops: 15.53  mfu: 4.98%
[rank3]:2025-10-28 13:39:30,433 - INFO -  step: 1360  loss:  0.2083  grad_norm:  0.7059  memory: 24.67GiB(51.93%)  tps: 2,038  tflops: 15.53  mfu: 4.98%
[rank1]:2025-10-28 13:39:30,433 - INFO -  step: 1360  loss: -2.0000  grad_norm:  0.7059  memory: 10.73GiB(22.58%)  tps: 2,038  tflops: 15.52  mfu: 4.98%
[rank0]:2025-10-28 13:39:30,435 - INFO -  step: 1360  loss: -2.0000  grad_norm:  0.7059  memory: 14.87GiB(31.30%)  tps: 2,039  tflops: 15.53  mfu: 4.98%
[rank3]:2025-10-28 13:39:32,274 - INFO - Avg. fwd time: 67.0841 / Avg. bwd time: 134.7607 / Avg. batch time: 1671.8706 (ms) / GPU bubble ratio: 3.42%
[rank2]:2025-10-28 13:39:32,337 - INFO - Avg. fwd time: 33.6014 / Avg. bwd time: 52.3361 / Avg. batch time: 1759.7334 (ms) / GPU bubble ratio: 60.93%
[rank1]:2025-10-28 13:39:32,409 - INFO - Avg. fwd time: 48.2652 / Avg. bwd time: 69.7552 / Avg. batch time: 1875.0992 (ms) / GPU bubble ratio: 49.65%
[rank0]:2025-10-28 13:39:32,472 - INFO - Avg. fwd time: 39.1311 / Avg. bwd time: 59.1491 / Avg. batch time: 1971.7466 (ms) / GPU bubble ratio: 60.12%
[rank2]:2025-10-28 13:40:50,642 - INFO -  step: 1380  loss: -2.0000  grad_norm:  0.5179  memory:  7.21GiB(15.18%)  tps: 2,042  tflops: 15.56  mfu: 4.99%
[rank3]:2025-10-28 13:40:50,655 - INFO -  step: 1380  loss:  0.2337  grad_norm:  0.5179  memory: 24.67GiB(51.93%)  tps: 2,042  tflops: 15.56  mfu: 4.99%
[rank1]:2025-10-28 13:40:50,647 - INFO -  step: 1380  loss: -2.0000  grad_norm:  0.5179  memory: 10.73GiB(22.58%)  tps: 2,043  tflops: 15.56  mfu: 4.99%
[rank0]:2025-10-28 13:40:50,668 - INFO -  step: 1380  loss: -2.0000  grad_norm:  0.5179  memory: 14.87GiB(31.30%)  tps: 2,042  tflops: 15.55  mfu: 4.98%
[rank0]:2025-10-28 13:42:06,969 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-28 13:42:11,085 - INFO -  step: 1400  loss:  0.2058  grad_norm:  0.7112  memory: 24.67GiB(51.93%)  tps: 2,037  tflops: 15.51  mfu: 4.97%
[rank3]:2025-10-28 13:42:11,086 - INFO - ðŸ”Ž  Running validation at step 1400
[rank1]:2025-10-28 13:42:11,083 - INFO -  step: 1400  loss: -2.0000  grad_norm:  0.7112  memory: 10.73GiB(22.58%)  tps: 2,037  tflops: 15.51  mfu: 4.97%
[rank1]:2025-10-28 13:42:11,084 - INFO - ðŸ”Ž  Running validation at step 1400
[rank0]:2025-10-28 13:42:11,089 - INFO -  step: 1400  loss: -2.0000  grad_norm:  0.7112  memory: 14.87GiB(31.30%)  tps: 2,037  tflops: 15.52  mfu: 4.97%
[rank0]:2025-10-28 13:42:11,089 - INFO - ðŸ”Ž  Running validation at step 1400
[rank2]:2025-10-28 13:42:11,073 - INFO -  step: 1400  loss: -2.0000  grad_norm:  0.7112  memory:  7.21GiB(15.18%)  tps: 2,037  tflops: 15.51  mfu: 4.97%
[rank2]:2025-10-28 13:42:11,073 - INFO - ðŸ”Ž  Running validation at step 1400
[rank0]:2025-10-28 13:43:20,791 - INFO - validate step: 1400  loss: -1.0000  memory: 14.87GiB(31.30%)  tps: 5,876
[rank1]:2025-10-28 13:43:20,874 - INFO - validate step: 1400  loss: -1.0000  memory: 10.73GiB(22.58%)  tps: 5,869
[rank2]:2025-10-28 13:43:20,954 - INFO - validate step: 1400  loss: -1.0000  memory:  7.21GiB(15.18%)  tps: 5,861
[rank3]:2025-10-28 13:43:21,020 - INFO - validate step: 1400  loss:  0.9470  memory: 24.67GiB(51.93%)  tps: 5,857
[rank3]:2025-10-28 13:43:21,229 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_1F1B_nofreeze_dm1/pipeline_schedule/251028_1343_real_step1400_rank3.svg
[rank3]:> Batch Time: 1912.14 ms, GPU Bubble Ratio: 58.42%, 50.39%, 64.35%, 15.22%
[rank3]:2025-10-28 13:43:22,947 - INFO - Avg. fwd time: 67.0895 / Avg. bwd time: 134.7815 / Avg. batch time: 1672.0620 (ms) / GPU bubble ratio: 3.41%
[rank2]:2025-10-28 13:43:23,008 - INFO - Avg. fwd time: 33.6047 / Avg. bwd time: 52.3327 / Avg. batch time: 1759.9594 (ms) / GPU bubble ratio: 60.94%
[rank1]:2025-10-28 13:43:23,088 - INFO - Avg. fwd time: 48.2199 / Avg. bwd time: 69.7480 / Avg. batch time: 1875.2994 (ms) / GPU bubble ratio: 49.68%
[rank0]:2025-10-28 13:43:23,151 - INFO - Avg. fwd time: 39.0979 / Avg. bwd time: 59.1422 / Avg. batch time: 1971.8890 (ms) / GPU bubble ratio: 60.14%
[rank3]:2025-10-28 13:44:41,293 - INFO -  step: 1420  loss:  0.2279  grad_norm:  0.5080  memory: 24.67GiB(51.93%)  tps: 2,041  tflops: 15.55  mfu: 4.98%
[rank1]:2025-10-28 13:44:41,291 - INFO -  step: 1420  loss: -2.0000  grad_norm:  0.5080  memory: 10.73GiB(22.58%)  tps: 2,037  tflops: 15.52  mfu: 4.97%
[rank0]:2025-10-28 13:44:41,301 - INFO -  step: 1420  loss: -2.0000  grad_norm:  0.5080  memory: 14.87GiB(31.30%)  tps: 2,035  tflops: 15.50  mfu: 4.97%
[rank2]:2025-10-28 13:44:41,281 - INFO -  step: 1420  loss: -2.0000  grad_norm:  0.5080  memory:  7.21GiB(15.18%)  tps: 2,040  tflops: 15.53  mfu: 4.98%
[rank1]:2025-10-28 13:46:01,222 - INFO -  step: 1440  loss: -2.0000  grad_norm:  0.7533  memory: 10.73GiB(22.58%)  tps: 2,050  tflops: 15.61  mfu: 5.00%
[rank2]:2025-10-28 13:46:01,219 - INFO -  step: 1440  loss: -2.0000  grad_norm:  0.7533  memory:  7.21GiB(15.18%)  tps: 2,050  tflops: 15.61  mfu: 5.00%
[rank0]:2025-10-28 13:46:01,234 - INFO -  step: 1440  loss: -2.0000  grad_norm:  0.7533  memory: 14.87GiB(31.30%)  tps: 2,050  tflops: 15.61  mfu: 5.00%
[rank3]:2025-10-28 13:46:01,231 - INFO -  step: 1440  loss:  0.2487  grad_norm:  0.7533  memory: 24.67GiB(51.93%)  tps: 2,050  tflops: 15.61  mfu: 5.00%
[rank3]:2025-10-28 13:46:03,049 - INFO - Avg. fwd time: 67.0870 / Avg. bwd time: 134.7860 / Avg. batch time: 1672.0612 (ms) / GPU bubble ratio: 3.41%
[rank2]:2025-10-28 13:46:03,113 - INFO - Avg. fwd time: 33.6136 / Avg. bwd time: 52.3380 / Avg. batch time: 1759.9561 (ms) / GPU bubble ratio: 60.93%
[rank1]:2025-10-28 13:46:03,193 - INFO - Avg. fwd time: 48.1986 / Avg. bwd time: 69.7591 / Avg. batch time: 1875.2917 (ms) / GPU bubble ratio: 49.68%
[rank0]:2025-10-28 13:46:03,256 - INFO - Avg. fwd time: 39.0810 / Avg. bwd time: 59.1284 / Avg. batch time: 1971.8263 (ms) / GPU bubble ratio: 60.15%
[rank0]:2025-10-28 13:46:37,354 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-28 13:47:21,318 - INFO -  step: 1460  loss: -2.0000  grad_norm:  0.5604  memory:  7.21GiB(15.18%)  tps: 2,045  tflops: 15.58  mfu: 4.99%
[rank1]:2025-10-28 13:47:21,322 - INFO -  step: 1460  loss: -2.0000  grad_norm:  0.5604  memory: 10.73GiB(22.58%)  tps: 2,045  tflops: 15.58  mfu: 4.99%
[rank0]:2025-10-28 13:47:21,339 - INFO -  step: 1460  loss: -2.0000  grad_norm:  0.5604  memory: 14.87GiB(31.30%)  tps: 2,045  tflops: 15.58  mfu: 4.99%
[rank3]:2025-10-28 13:47:21,330 - INFO -  step: 1460  loss:  0.2472  grad_norm:  0.5604  memory: 24.67GiB(51.93%)  tps: 2,046  tflops: 15.58  mfu: 4.99%
[rank3]:2025-10-28 13:48:41,557 - INFO -  step: 1480  loss:  0.2111  grad_norm:  0.6918  memory: 24.67GiB(51.93%)  tps: 2,042  tflops: 15.55  mfu: 4.99%
[rank2]:2025-10-28 13:48:41,545 - INFO -  step: 1480  loss: -2.0000  grad_norm:  0.6918  memory:  7.21GiB(15.18%)  tps: 2,042  tflops: 15.55  mfu: 4.99%
[rank1]:2025-10-28 13:48:41,556 - INFO -  step: 1480  loss: -2.0000  grad_norm:  0.6918  memory: 10.73GiB(22.58%)  tps: 2,042  tflops: 15.55  mfu: 4.98%
[rank0]:2025-10-28 13:48:41,560 - INFO -  step: 1480  loss: -2.0000  grad_norm:  0.6918  memory: 14.87GiB(31.30%)  tps: 2,042  tflops: 15.56  mfu: 4.99%
[rank3]:2025-10-28 13:48:43,387 - INFO - Avg. fwd time: 67.0884 / Avg. bwd time: 134.7939 / Avg. batch time: 1672.1204 (ms) / GPU bubble ratio: 3.41%
[rank2]:2025-10-28 13:48:43,448 - INFO - Avg. fwd time: 33.6222 / Avg. bwd time: 52.3443 / Avg. batch time: 1760.0245 (ms) / GPU bubble ratio: 60.92%
[rank1]:2025-10-28 13:48:43,523 - INFO - Avg. fwd time: 48.1662 / Avg. bwd time: 69.7531 / Avg. batch time: 1875.3575 (ms) / GPU bubble ratio: 49.70%
[rank0]:2025-10-28 13:48:43,588 - INFO - Avg. fwd time: 39.0580 / Avg. bwd time: 59.1212 / Avg. batch time: 1971.8417 (ms) / GPU bubble ratio: 60.17%
[rank0]:2025-10-28 13:49:57,834 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-28 13:50:01,825 - INFO -  step: 1500  loss: -2.0000  grad_norm:  0.5171  memory: 10.73GiB(22.58%)  tps: 2,041  tflops: 15.55  mfu: 4.98%
[rank1]:2025-10-28 13:50:01,825 - INFO - ðŸ”Ž  Running validation at step 1500
[rank0]:2025-10-28 13:50:01,847 - INFO -  step: 1500  loss: -2.0000  grad_norm:  0.5171  memory: 14.87GiB(31.30%)  tps: 2,041  tflops: 15.54  mfu: 4.98%
[rank0]:2025-10-28 13:50:01,847 - INFO - ðŸ”Ž  Running validation at step 1500
[rank2]:2025-10-28 13:50:01,821 - INFO -  step: 1500  loss: -2.0000  grad_norm:  0.5171  memory:  7.21GiB(15.18%)  tps: 2,041  tflops: 15.54  mfu: 4.98%
[rank2]:2025-10-28 13:50:01,821 - INFO - ðŸ”Ž  Running validation at step 1500
[rank3]:2025-10-28 13:50:01,833 - INFO -  step: 1500  loss:  0.2516  grad_norm:  0.5171  memory: 24.67GiB(51.93%)  tps: 2,041  tflops: 15.54  mfu: 4.98%
[rank3]:2025-10-28 13:50:01,834 - INFO - ðŸ”Ž  Running validation at step 1500
[rank0]:2025-10-28 13:51:11,832 - INFO - validate step: 1500  loss: -1.0000  memory: 14.87GiB(31.30%)  tps: 5,853
[rank1]:2025-10-28 13:51:11,914 - INFO - validate step: 1500  loss: -1.0000  memory: 10.73GiB(22.58%)  tps: 5,844
[rank2]:2025-10-28 13:51:11,995 - INFO - validate step: 1500  loss: -1.0000  memory:  7.21GiB(15.18%)  tps: 5,837
[rank3]:2025-10-28 13:51:12,060 - INFO - validate step: 1500  loss:  0.9468  memory: 24.67GiB(51.93%)  tps: 5,833
[rank3]:2025-10-28 13:51:12,276 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_1F1B_nofreeze_dm1/pipeline_schedule/251028_1351_real_step1500_rank3.svg
[rank3]:> Batch Time: 1912.23 ms, GPU Bubble Ratio: 58.44%, 50.42%, 64.32%, 15.22%
[rank2]:2025-10-28 13:52:32,185 - INFO -  step: 1520  loss: -2.0000  grad_norm:  0.6929  memory:  7.21GiB(15.18%)  tps: 2,043  tflops: 15.56  mfu: 4.99%
[rank3]:2025-10-28 13:52:32,198 - INFO -  step: 1520  loss:  0.2097  grad_norm:  0.6929  memory: 24.67GiB(51.93%)  tps: 2,045  tflops: 15.57  mfu: 4.99%
[rank1]:2025-10-28 13:52:32,195 - INFO -  step: 1520  loss: -2.0000  grad_norm:  0.6929  memory: 10.73GiB(22.58%)  tps: 2,041  tflops: 15.54  mfu: 4.98%
[rank0]:2025-10-28 13:52:32,209 - INFO -  step: 1520  loss: -2.0000  grad_norm:  0.6929  memory: 14.87GiB(31.30%)  tps: 2,038  tflops: 15.52  mfu: 4.98%
[rank3]:2025-10-28 13:52:34,060 - INFO - Avg. fwd time: 67.0925 / Avg. bwd time: 134.8035 / Avg. batch time: 1672.2156 (ms) / GPU bubble ratio: 3.41%
[rank2]:2025-10-28 13:52:34,119 - INFO - Avg. fwd time: 33.6306 / Avg. bwd time: 52.3513 / Avg. batch time: 1760.1519 (ms) / GPU bubble ratio: 60.92%
[rank1]:2025-10-28 13:52:34,192 - INFO - Avg. fwd time: 48.1487 / Avg. bwd time: 69.7357 / Avg. batch time: 1875.4354 (ms) / GPU bubble ratio: 49.71%
[rank0]:2025-10-28 13:52:34,262 - INFO - Avg. fwd time: 39.0615 / Avg. bwd time: 59.1148 / Avg. batch time: 1971.8927 (ms) / GPU bubble ratio: 60.17%
[rank2]:2025-10-28 13:53:52,280 - INFO -  step: 1540  loss: -2.0000  grad_norm:  0.5123  memory:  7.21GiB(15.18%)  tps: 2,046  tflops: 15.58  mfu: 4.99%
[rank3]:2025-10-28 13:53:52,292 - INFO -  step: 1540  loss:  0.2318  grad_norm:  0.5123  memory: 24.67GiB(51.93%)  tps: 2,046  tflops: 15.58  mfu: 4.99%
[rank1]:2025-10-28 13:53:52,283 - INFO -  step: 1540  loss: -2.0000  grad_norm:  0.5123  memory: 10.73GiB(22.58%)  tps: 2,046  tflops: 15.58  mfu: 4.99%
[rank0]:2025-10-28 13:53:52,294 - INFO -  step: 1540  loss: -2.0000  grad_norm:  0.5123  memory: 14.87GiB(31.30%)  tps: 2,046  tflops: 15.58  mfu: 4.99%
[rank0]:2025-10-28 13:54:28,209 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-28 13:55:12,278 - INFO -  step: 1560  loss: -2.0000  grad_norm:  0.7086  memory:  7.21GiB(15.18%)  tps: 2,048  tflops: 15.60  mfu: 5.00%
[rank3]:2025-10-28 13:55:12,290 - INFO -  step: 1560  loss:  0.1771  grad_norm:  0.7086  memory: 24.67GiB(51.93%)  tps: 2,048  tflops: 15.60  mfu: 5.00%
[rank1]:2025-10-28 13:55:12,283 - INFO -  step: 1560  loss: -2.0000  grad_norm:  0.7086  memory: 10.73GiB(22.58%)  tps: 2,048  tflops: 15.60  mfu: 5.00%
[rank0]:2025-10-28 13:55:12,298 - INFO -  step: 1560  loss: -2.0000  grad_norm:  0.7086  memory: 14.87GiB(31.30%)  tps: 2,048  tflops: 15.60  mfu: 5.00%
[rank3]:2025-10-28 13:55:14,123 - INFO - Avg. fwd time: 67.0921 / Avg. bwd time: 134.8063 / Avg. batch time: 1672.2215 (ms) / GPU bubble ratio: 3.41%
[rank2]:2025-10-28 13:55:14,186 - INFO - Avg. fwd time: 33.6307 / Avg. bwd time: 52.3500 / Avg. batch time: 1760.1481 (ms) / GPU bubble ratio: 60.92%
[rank1]:2025-10-28 13:55:14,257 - INFO - Avg. fwd time: 48.1261 / Avg. bwd time: 69.7302 / Avg. batch time: 1875.4151 (ms) / GPU bubble ratio: 49.73%
[rank0]:2025-10-28 13:55:14,326 - INFO - Avg. fwd time: 39.0451 / Avg. bwd time: 59.1095 / Avg. batch time: 1971.8279 (ms) / GPU bubble ratio: 60.18%
[rank2]:2025-10-28 13:56:32,286 - INFO -  step: 1580  loss: -2.0000  grad_norm:  0.5080  memory:  7.21GiB(15.18%)  tps: 2,048  tflops: 15.60  mfu: 5.00%
[rank3]:2025-10-28 13:56:32,298 - INFO -  step: 1580  loss:  0.2121  grad_norm:  0.5080  memory: 24.67GiB(51.93%)  tps: 2,048  tflops: 15.60  mfu: 5.00%
[rank1]:2025-10-28 13:56:32,289 - INFO -  step: 1580  loss: -2.0000  grad_norm:  0.5080  memory: 10.73GiB(22.58%)  tps: 2,048  tflops: 15.60  mfu: 5.00%
[rank0]:2025-10-28 13:56:32,310 - INFO -  step: 1580  loss: -2.0000  grad_norm:  0.5080  memory: 14.87GiB(31.30%)  tps: 2,048  tflops: 15.60  mfu: 5.00%
[rank0]:2025-10-28 13:57:48,373 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-28 13:57:52,417 - INFO -  step: 1600  loss:  0.1762  grad_norm:  0.7272  memory: 24.67GiB(51.93%)  tps: 2,045  tflops: 15.58  mfu: 4.99%
[rank3]:2025-10-28 13:57:52,418 - INFO -  final step: 1600  loss:  0.1762  grad_norm:  0.7272  tps: 2,062  tflops: 15.70  mfu: 4.94%
[rank3]:2025-10-28 13:57:52,419 - INFO - ðŸ”Ž  Running validation at step 1600
[rank1]:2025-10-28 13:57:52,411 - INFO -  step: 1600  loss: -2.0000  grad_norm:  0.7272  memory: 10.73GiB(22.58%)  tps: 2,045  tflops: 15.57  mfu: 4.99%
[rank1]:2025-10-28 13:57:52,411 - INFO -  final step: 1600  loss: -2.0000  grad_norm:  0.7272  tps: 2,061  tflops: 15.69  mfu: 4.93%
[rank1]:2025-10-28 13:57:52,411 - INFO - ðŸ”Ž  Running validation at step 1600
[rank0]:2025-10-28 13:57:52,429 - INFO -  step: 1600  loss: -2.0000  grad_norm:  0.7272  memory: 14.87GiB(31.30%)  tps: 2,045  tflops: 15.57  mfu: 4.99%
[rank0]:2025-10-28 13:57:52,430 - INFO -  final step: 1600  loss: -2.0000  grad_norm:  0.7272  tps: 2,060  tflops: 15.69  mfu: 4.93%
[rank0]:2025-10-28 13:57:52,430 - INFO - ðŸ”Ž  Running validation at step 1600
[rank2]:2025-10-28 13:57:52,405 - INFO -  step: 1600  loss: -2.0000  grad_norm:  0.7272  memory:  7.21GiB(15.18%)  tps: 2,045  tflops: 15.57  mfu: 4.99%
[rank2]:2025-10-28 13:57:52,405 - INFO -  final step: 1600  loss: -2.0000  grad_norm:  0.7272  tps: 2,061  tflops: 15.70  mfu: 4.93%
[rank2]:2025-10-28 13:57:52,406 - INFO - ðŸ”Ž  Running validation at step 1600
[rank0]:2025-10-28 13:59:02,418 - INFO - validate step: 1600  loss: -1.0000  memory: 14.87GiB(31.30%)  tps: 5,852
[rank0]:2025-10-28 13:59:02,419 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-28 13:59:02,422 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1600.
[rank1]:2025-10-28 13:59:02,499 - INFO - validate step: 1600  loss: -1.0000  memory: 10.73GiB(22.58%)  tps: 5,844
[rank1]:2025-10-28 13:59:02,500 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-28 13:59:02,502 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1600.
[rank2]:2025-10-28 13:59:02,583 - INFO - validate step: 1600  loss: -1.0000  memory:  7.21GiB(15.18%)  tps: 5,837
[rank2]:2025-10-28 13:59:02,583 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-28 13:59:02,585 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1600.
[rank3]:2025-10-28 13:59:02,649 - INFO - validate step: 1600  loss:  0.9450  memory: 24.67GiB(51.93%)  tps: 5,832
[rank3]:2025-10-28 13:59:02,650 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-28 13:59:02,652 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1600.
[rank2]:2025-10-28 13:59:05,294 - INFO - Destroying the purge thread.
[rank1]:2025-10-28 13:59:05,294 - INFO - Destroying the purge thread.
[rank0]:2025-10-28 13:59:05,284 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank0]:2025-10-28 13:59:05,294 - INFO - Sleeping 2 seconds for other ranks to complete
[rank3]:2025-10-28 13:59:05,488 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_1F1B_nofreeze_dm1/pipeline_schedule/251028_1359_real_final1600_rank3.svg
[rank3]:> Batch Time: 1912.14 ms, GPU Bubble Ratio: 58.44%, 50.42%, 64.30%, 15.21%
[rank1]:2025-10-28 13:59:05,643 - INFO - Process group destroyed
[rank2]:2025-10-28 13:59:05,644 - INFO - Process group destroyed
[rank3]:2025-10-28 13:59:05,680 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_1F1B_nofreeze_dm1/pipeline_schedule/251028_1359_thry_final1600_rank3.svg
[rank3]:> Batch Time: 1563.62 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:2025-10-28 13:59:05,681 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading data
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–„â–ƒâ–„â–†â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–…â–…â–ƒâ–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–‡â–ˆâ–…â–„â–…â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 3.97277
[rank3]:wandb:               final/avg_loss 0.17625
[rank3]:wandb:             final/avg_mfu(%) 4.93539
[rank3]:wandb:             final/avg_tflops 15.70491
[rank3]:wandb:    final/avg_throughput(tps) 2062.03647
[rank3]:wandb:              final/grad_norm 0.72723
[rank3]:wandb:               final/max_loss 0.17625
[rank3]:wandb:                    grad_norm 0.72723
[rank3]:wandb: loss_metrics/global_avg_loss 0.17625
[rank3]:wandb: loss_metrics/global_max_loss 0.17625
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1028_1F1B_nofreeze_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/24d49jfr
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data3/shcho/torchtitan/tb/1028_1F1B_nofreeze_dm1/20251028-1153/wandb/run-20251028_115304-24d49jfr/logs
[rank0]:2025-10-28 13:59:07,294 - INFO - Training completed
[rank0]:2025-10-28 13:59:07,295 - INFO - Destroying the purge thread.
[rank3]:2025-10-28 13:59:07,444 - INFO - Process group destroyed
[rank0]:2025-10-28 13:59:07,786 - INFO - Process group destroyed
[rank0]:Stage 0: Modules to keep: {'layers.1', 'layers.0', 'tok_embeddings', 'layers.3', 'layers.2'}
[rank1]:Stage 1: Modules to keep: {'layers.5', 'layers.4', 'layers.6', 'layers.8', 'layers.7'}
[rank2]:Stage 2: Modules to keep: {'layers.10', 'layers.12', 'layers.11', 'layers.9'}
[rank3]:Stage 3: Modules to keep: {'layers.15', 'layers.13', 'output', 'layers.14', 'norm'}
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1026_llama1b/config.toml
[rank3]:		- dump_folder: /data3/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1028_1F1B_nofreeze_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data3/shcho/torchtitan/profile_trace/1028_1F1B_nofreeze_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data3/shcho/torchtitan/memory_snapshot/1028_1F1B_nofreeze_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 20
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data3/shcho/torchtitan/tb/1028_1F1B_nofreeze_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data3/shcho/torchtitan/images/1028_1F1B_nofreeze_dm1
[rank3]:		- pplog_freq: 80
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1028_1F1B_nofreeze_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B-Instruct
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 1e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: alpaca
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 512
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 1600
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: 1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 4
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data3/shcho/torchtitan/checkpoint/1028_1F1B_nofreeze_dm1
[rank3]:		- interval: 800
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B-Instruct/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data3/shcho/torchtitan/comm_traces/1028_1F1B_nofreeze_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: True
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 100
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: False
[rank3]:		- metric_type: apf
[rank3]:		- phase_unit: 10
[rank3]:		- stability_check_freq: 5
[rank3]:		- aggressiveness: 0
[rank3]:
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
