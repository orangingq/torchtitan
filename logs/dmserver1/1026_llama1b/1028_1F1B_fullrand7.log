
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 10. 28. (í™”) 17:44:09 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 3,4,5,6
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1026_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1026_llama1b/1028_1F1B_fullrand7.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs
âœ”ï¸Running with fullrand7 x 1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1026_llama1b/config.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=fullrand7
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank3]:2025-10-28 17:44:15,052 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs"
[rank2]:2025-10-28 17:44:15,087 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs"
[rank0]:2025-10-28 17:44:15,168 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs"
[rank1]:2025-10-28 17:44:15,231 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs"
[rank0]:2025-10-28 17:44:15,710 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-10-28 17:44:15,712 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-28 17:44:15,716 - INFO - [GC] Initial GC collection 0.00 seconds
[rank1]:2025-10-28 17:44:15,727 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-10-28 17:44:15,730 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-10-28 17:44:15,756 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-10-28 17:44:15,758 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-10-28 17:44:15,742 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-10-28 17:44:15,744 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-28 17:44:16,258 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-10-28 17:44:16,681 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank2]:2025-10-28 17:44:19,981 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-10-28 17:44:20,022 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-10-28 17:44:20,003 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-10-28 17:44:20,051 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-10-28 17:44:20,051 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2025-10-28 17:44:20,042 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-10-28 17:44:20,068 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-10-28 17:44:20,068 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank1]:2025-10-28 17:44:20,247 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-10-28 17:44:20,247 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-10-28 17:44:20,248 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank2]:2025-10-28 17:44:20,228 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-10-28 17:44:20,228 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-10-28 17:44:20,229 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank0]:2025-10-28 17:44:20,563 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=512, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank0]:2025-10-28 17:44:20,755 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-10-28 17:44:20,794 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-10-28 17:44:20,795 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-10-28 17:44:20,821 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-10-28 17:44:20,821 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2025-10-28 17:44:21,024 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-10-28 17:44:21,024 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-10-28 17:44:21,025 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run px8xu5d2
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data3/shcho/torchtitan/tb/1028_1F1B_fullrand7_dm1/20251028-1744/wandb/run-20251028_174421-px8xu5d2
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1028_1F1B_fullrand7_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/px8xu5d2
[rank3]:2025-10-28 17:44:22,081 - INFO - WandB logging enabled
[rank3]:2025-10-28 17:44:22,192 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-10-28 17:44:22,230 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-10-28 17:44:22,257 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-10-28 17:44:22,257 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2025-10-28 17:44:22,809 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data3/shcho/torchtitan/checkpoint/1028_1F1B_fullrand7_dm1
[rank0]:2025-10-28 17:44:22,809 - WARNING - Mixed precision training with TP or PP is only supported when FSDP/HSDP/CP is enabled.
[rank0]:2025-10-28 17:44:22,809 - INFO - Mixed precision training is disabled
[rank0]:2025-10-28 17:44:22,809 - INFO - Preparing c4_validation dataset from allenai/c4
[rank3]:2025-10-28 17:44:22,793 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-10-28 17:44:22,794 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-10-28 17:44:22,795 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank0]:2025-10-28 17:44:27,802 - INFO - Trainer is initialized with local batch size 32, global batch size 64, gradient accumulation steps 2, sequence length 512, total steps 1600 (warmup 100)
[rank0]:2025-10-28 17:44:27,803 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B-Instruct/original_dcp.
[rank0]:2025-10-28 17:44:30,350 - INFO - [GC] GC collection for checkpoint loading. 0.01 seconds
[rank0]:2025-10-28 17:44:30,350 - INFO - Finished loading the checkpoint in 2.55 seconds.
[rank0]:2025-10-28 17:44:30,350 - INFO - Training starts at step 1
[rank0]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/autograd/graph.py:849: UserWarning: Attempting to run cuBLAS, but there was no current CUDA context! Attempting to set the primary context... (Triggered internally at /pytorch/aten/src/ATen/cuda/CublasHandlePool.cpp:270.)
[rank0]:  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
[rank0]:2025-10-28 17:44:39,748 - INFO -  step:  1  loss: -2.0000  grad_norm: 95.1855  memory: 11.08GiB(23.32%)  tps: 432  tflops: 3.29  mfu: 1.06%
[rank0]:2025-10-28 17:44:39,749 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-10-28 17:44:39,710 - INFO -  step:  1  loss: -2.0000  grad_norm: 95.1855  memory:  5.39GiB(11.36%)  tps: 416  tflops: 3.17  mfu: 1.02%
[rank2]:2025-10-28 17:44:39,711 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-28 17:44:39,721 - INFO -  step:  1  loss:  9.0107  grad_norm: 95.1855  memory: 20.74GiB(43.67%)  tps: 468  tflops: 3.57  mfu: 1.14%
[rank1]:2025-10-28 17:44:39,714 - INFO -  step:  1  loss: -2.0000  grad_norm: 95.1855  memory:  8.46GiB(17.81%)  tps: 416  tflops: 3.17  mfu: 1.02%
[rank1]:2025-10-28 17:44:39,714 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-28 17:44:39,721 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-28 17:44:57,062 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 17:44:57,063 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 17:44:57,064 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 17:44:57,064 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 17:44:57,064 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 17:44:57,064 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 17:44:57,065 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 17:44:57,065 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 17:44:57,065 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 17:44:57,066 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 17:44:57,066 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 17:44:57,066 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 17:44:57,066 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 17:44:57,067 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 17:44:57,067 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 17:44:57,067 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 17:44:57,123 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 17:44:57,123 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 17:44:57,123 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 17:44:57,123 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 17:44:57,123 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 17:44:57,123 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 17:44:57,123 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 17:44:57,123 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 17:44:57,123 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 17:44:57,124 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 17:44:57,124 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 17:44:57,124 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 17:44:57,124 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 17:44:57,124 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 17:44:57,124 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 17:44:57,124 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 17:44:57,262 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 17:44:57,263 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 17:44:57,263 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 17:44:57,263 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 17:44:57,263 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 17:44:57,263 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 17:44:57,263 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 17:44:57,263 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 17:44:57,263 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 17:44:57,263 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 17:44:57,263 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 17:44:57,263 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 17:44:57,263 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 17:44:57,263 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 17:44:57,263 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 17:44:57,263 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 17:44:57,201 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 17:44:57,201 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 17:44:57,201 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 17:44:57,201 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 17:44:57,201 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 17:44:57,201 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 17:44:57,201 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 17:44:57,201 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 17:44:57,202 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 17:44:57,202 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 17:44:57,202 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 17:44:57,202 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 17:44:57,202 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 17:44:57,202 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 17:44:57,202 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 17:44:57,202 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 17:45:54,753 - INFO -  step: 20  loss: -2.0000  grad_norm: 61.0399  memory:  7.21GiB(15.18%)  tps: 2,074  tflops: 15.80  mfu: 5.06%
[rank0]:2025-10-28 17:45:54,773 - INFO -  step: 20  loss: -2.0000  grad_norm: 61.0399  memory: 14.87GiB(31.30%)  tps: 2,075  tflops: 15.80  mfu: 5.06%
[rank1]:2025-10-28 17:45:54,758 - INFO -  step: 20  loss: -2.0000  grad_norm: 61.0399  memory: 10.73GiB(22.58%)  tps: 2,074  tflops: 15.80  mfu: 5.06%
[rank3]:2025-10-28 17:45:54,765 - INFO -  step: 20  loss: 10.8312  grad_norm: 61.0399  memory: 24.67GiB(51.93%)  tps: 2,074  tflops: 15.80  mfu: 5.06%
[rank1]:2025-10-28 17:47:14,864 - INFO -  step: 40  loss: -2.0000  grad_norm: 41.4008  memory: 10.73GiB(22.58%)  tps: 2,045  tflops: 15.58  mfu: 4.99%
[rank2]:2025-10-28 17:47:14,859 - INFO -  step: 40  loss: -2.0000  grad_norm: 41.4008  memory:  7.21GiB(15.18%)  tps: 2,045  tflops: 15.58  mfu: 4.99%
[rank3]:2025-10-28 17:47:14,871 - INFO -  step: 40  loss:  5.6551  grad_norm: 41.4008  memory: 24.67GiB(51.93%)  tps: 2,045  tflops: 15.58  mfu: 4.99%
[rank0]:2025-10-28 17:47:14,878 - INFO -  step: 40  loss: -2.0000  grad_norm: 41.4008  memory: 14.87GiB(31.30%)  tps: 2,045  tflops: 15.58  mfu: 4.99%
[rank3]:2025-10-28 17:47:16,697 - INFO - Avg. fwd time: 65.6977 / Avg. bwd time: 132.3966 / Avg. batch time: 1661.0555 (ms) / GPU bubble ratio: 4.59%
[rank2]:2025-10-28 17:47:16,757 - INFO - Avg. fwd time: 32.8785 / Avg. bwd time: 51.3437 / Avg. batch time: 1748.2804 (ms) / GPU bubble ratio: 61.46%
[rank1]:2025-10-28 17:47:16,825 - INFO - Avg. fwd time: 46.5341 / Avg. bwd time: 67.0528 / Avg. batch time: 1861.3008 (ms) / GPU bubble ratio: 51.18%
[rank0]:2025-10-28 17:47:16,891 - INFO - Avg. fwd time: 38.3765 / Avg. bwd time: 57.8866 / Avg. batch time: 1957.0100 (ms) / GPU bubble ratio: 60.65%
[rank0]:2025-10-28 17:47:50,767 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-28 17:48:34,542 - INFO -  step: 60  loss: -2.0000  grad_norm: 31.8155  memory:  7.21GiB(15.18%)  tps: 2,056  tflops: 15.66  mfu: 5.02%
[rank3]:2025-10-28 17:48:34,554 - INFO -  step: 60  loss:  8.4635  grad_norm: 31.8155  memory: 24.67GiB(51.93%)  tps: 2,056  tflops: 15.66  mfu: 5.02%
[rank0]:2025-10-28 17:48:34,566 - INFO -  step: 60  loss: -2.0000  grad_norm: 31.8155  memory: 14.87GiB(31.30%)  tps: 2,056  tflops: 15.66  mfu: 5.02%
[rank1]:2025-10-28 17:48:34,546 - INFO -  step: 60  loss: -2.0000  grad_norm: 31.8155  memory: 10.73GiB(22.58%)  tps: 2,056  tflops: 15.66  mfu: 5.02%
[rank2]:2025-10-28 17:49:54,322 - INFO -  step: 80  loss: -2.0000  grad_norm: 43.1348  memory:  7.21GiB(15.18%)  tps: 2,054  tflops: 15.64  mfu: 5.01%
[rank0]:2025-10-28 17:49:54,345 - INFO -  step: 80  loss: -2.0000  grad_norm: 43.1348  memory: 14.87GiB(31.30%)  tps: 2,054  tflops: 15.64  mfu: 5.01%
[rank1]:2025-10-28 17:49:54,325 - INFO -  step: 80  loss: -2.0000  grad_norm: 43.1348  memory: 10.73GiB(22.58%)  tps: 2,054  tflops: 15.64  mfu: 5.01%
[rank3]:2025-10-28 17:49:54,333 - INFO -  step: 80  loss:  3.9951  grad_norm: 43.1348  memory: 24.67GiB(51.93%)  tps: 2,054  tflops: 15.64  mfu: 5.01%
[rank3]:2025-10-28 17:49:56,141 - INFO - Avg. fwd time: 66.3047 / Avg. bwd time: 133.2516 / Avg. batch time: 1662.9424 (ms) / GPU bubble ratio: 4.00%
[rank2]:2025-10-28 17:49:56,195 - INFO - Avg. fwd time: 33.1308 / Avg. bwd time: 51.6412 / Avg. batch time: 1749.9670 (ms) / GPU bubble ratio: 61.25%
[rank1]:2025-10-28 17:49:56,273 - INFO - Avg. fwd time: 47.0920 / Avg. bwd time: 67.2373 / Avg. batch time: 1863.6580 (ms) / GPU bubble ratio: 50.92%
[rank0]:2025-10-28 17:49:56,337 - INFO - Avg. fwd time: 38.8847 / Avg. bwd time: 58.4797 / Avg. batch time: 1959.5810 (ms) / GPU bubble ratio: 60.25%
[rank3]:2025-10-28 17:50:53,167 - INFO - [Step 95] ã€°ï¸ Monitoring Upperbound
[rank0]:2025-10-28 17:51:09,993 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-28 17:51:13,056 - WARNING - [Step 100] â³ Monitoring Upperbound... (200/200)
[rank2]:2025-10-28 17:51:13,777 - WARNING - [Step 100] â³ Monitoring Upperbound... (200/200)
[rank1]:2025-10-28 17:51:13,843 - WARNING - [Step 100] â³ Monitoring Upperbound... (200/200)
[rank2]:2025-10-28 17:51:13,916 - INFO -  step: 100  loss: -2.0000  grad_norm: 51.9030  memory:  7.21GiB(15.18%)  tps: 2,058  tflops: 15.68  mfu: 5.02%
[rank2]:2025-10-28 17:51:13,916 - INFO - ðŸ”Ž  Running validation at step 100
[rank0]:2025-10-28 17:51:13,901 - WARNING - [Step 100] â³ Monitoring Upperbound... (200/200)
[rank0]:2025-10-28 17:51:13,933 - INFO -  step: 100  loss: -2.0000  grad_norm: 51.9030  memory: 14.87GiB(31.30%)  tps: 2,059  tflops: 15.68  mfu: 5.03%
[rank0]:2025-10-28 17:51:13,933 - INFO - ðŸ”Ž  Running validation at step 100
[rank3]:2025-10-28 17:51:13,928 - INFO -  step: 100  loss:  5.4196  grad_norm: 51.9030  memory: 24.67GiB(51.93%)  tps: 2,058  tflops: 15.68  mfu: 5.02%
[rank3]:2025-10-28 17:51:13,928 - INFO - ðŸ”Ž  Running validation at step 100
[rank1]:2025-10-28 17:51:13,920 - INFO -  step: 100  loss: -2.0000  grad_norm: 51.9030  memory: 10.73GiB(22.58%)  tps: 2,058  tflops: 15.68  mfu: 5.02%
[rank1]:2025-10-28 17:51:13,920 - INFO - ðŸ”Ž  Running validation at step 100
[rank0]:2025-10-28 17:52:27,225 - INFO - validate step: 100  loss: -1.0000  memory: 14.87GiB(31.30%)  tps: 5,589
[rank1]:2025-10-28 17:52:27,307 - INFO - validate step: 100  loss: -1.0000  memory: 10.73GiB(22.58%)  tps: 5,581
[rank2]:2025-10-28 17:52:27,390 - INFO - validate step: 100  loss: -1.0000  memory:  7.21GiB(15.18%)  tps: 5,575
[rank3]:2025-10-28 17:52:27,455 - INFO - validate step: 100  loss:  2.0007  memory: 24.67GiB(51.93%)  tps: 5,571
[rank0]:2025-10-28 17:52:27,534 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251028_1752_stage0_step100.svg
[rank2]:2025-10-28 17:52:27,533 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251028_1752_stage2_step100.svg
[rank1]:2025-10-28 17:52:27,534 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251028_1752_stage1_step100.svg
[rank3]:2025-10-28 17:52:27,673 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/pipeline_schedule/251028_1752_real_step100_rank3.svg
[rank3]:> Batch Time: 1899.36 ms, GPU Bubble Ratio: 58.26%, 52.12%, 64.52%, 15.10%
[rank3]:2025-10-28 17:52:27,734 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251028_1752_stage3_step100.svg
[rank3]:2025-10-28 17:52:46,846 - INFO - [Step 105] âœ”ï¸  Setting Upperbound
[rank0]:2025-10-28 17:52:47,789 - WARNING - Batch index 211 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-28 17:52:47,781 - WARNING - Batch index 211 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-28 17:52:47,755 - INFO - [Step 105] ã€°ï¸ Monitoring Lowerbound
[rank3]:2025-10-28 17:52:47,777 - WARNING - Batch index 211 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-28 17:52:47,795 - WARNING - Batch index 211 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-28 17:52:47,788 - WARNING - Batch index 211 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-28 17:52:47,812 - WARNING - Batch index 211 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-28 17:52:47,835 - WARNING - Batch index 211 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-28 17:52:47,861 - WARNING - Batch index 211 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-28 17:52:47,806 - WARNING - Batch index 211 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-28 17:52:47,829 - WARNING - Batch index 211 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-28 17:52:47,848 - WARNING - Batch index 211 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-28 17:52:47,810 - WARNING - Batch index 211 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-28 17:52:47,830 - WARNING - Batch index 211 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-28 17:52:47,851 - WARNING - Batch index 211 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-28 17:52:47,898 - WARNING - Batch index 211 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-28 17:52:47,817 - WARNING - Batch index 211 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-28 17:52:47,848 - WARNING - Batch index 211 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-28 17:52:48,068 - WARNING - Batch index 211 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-28 17:52:48,060 - WARNING - Batch index 211 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-28 17:52:48,141 - WARNING - Batch index 211 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-28 17:52:48,132 - WARNING - Batch index 211 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-28 17:52:48,214 - WARNING - Batch index 211 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-28 17:52:48,215 - WARNING - Batch index 211 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-28 17:52:48,215 - WARNING - Batch index 211 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-28 17:52:48,216 - WARNING - Batch index 211 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-28 17:52:48,265 - WARNING - Batch index 211 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-28 17:52:48,213 - WARNING - Batch index 211 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-28 17:52:48,218 - WARNING - Batch index 211 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-28 17:52:48,374 - WARNING - Batch index 211 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-28 17:52:48,353 - WARNING - Batch index 211 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-28 17:52:48,441 - WARNING - Batch index 211 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-28 17:52:48,506 - WARNING - Batch index 211 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-28 17:53:15,470 - INFO - [Step 115] âœ”ï¸  Setting Lowerbound
[rank3]:2025-10-28 17:53:15,728 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/pipeline_schedule/251028_1753_max_batch_time.svg
[rank3]:> Batch Time: 1884.11 ms, GPU Bubble Ratio: 57.94%, 51.77%, 64.06%, 15.01%
[rank3]:2025-10-28 17:53:15,916 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/pipeline_schedule/251028_1753_min_batch_time.svg
[rank3]:> Batch Time: 1283.52 ms, GPU Bubble Ratio: 75.18%, 48.16%, 62.64%, 13.02%
[rank3]:2025-10-28 17:53:16,164 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/pipeline_schedule/251028_1753_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 1283.52 ms, GPU Bubble Ratio: 42.93%, 31.60%, 49.18%, 13.02%
[rank3]:2025-10-28 17:53:16,165 - INFO - 	> Batch Time: 1283.52 ms (Average Freeze Ratio: 0.34, Time Reduction Rate: 0.32)
[rank2]:2025-10-28 17:53:30,794 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank3]:2025-10-28 17:53:30,763 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-28 17:53:30,858 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-28 17:53:30,923 - INFO -  step: 120  loss: -2.0000  grad_norm:  0.8736  memory:  7.21GiB(15.18%)  tps: 2,579  tflops: 19.64  mfu: 6.30%
[rank0]:2025-10-28 17:53:30,909 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-28 17:53:30,942 - INFO -  step: 120  loss: -2.0000  grad_norm:  0.8736  memory: 14.89GiB(31.34%)  tps: 2,571  tflops: 19.58  mfu: 6.28%
[rank3]:2025-10-28 17:53:30,911 - INFO -  step: 120  loss:  2.4821  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,582  tflops: 19.67  mfu: 6.30%
[rank1]:2025-10-28 17:53:30,928 - INFO -  step: 120  loss: -2.0000  grad_norm:  0.8736  memory: 10.75GiB(22.62%)  tps: 2,575  tflops: 19.61  mfu: 6.29%
[rank3]:2025-10-28 17:53:32,262 - INFO - Avg. fwd time: 66.4668 / Avg. bwd time: 125.9936 / Avg. batch time: 1602.6369 (ms) / GPU bubble ratio: 3.93%
[rank2]:2025-10-28 17:53:32,321 - INFO - Avg. fwd time: 33.1243 / Avg. bwd time: 49.4277 / Avg. batch time: 1689.9283 (ms) / GPU bubble ratio: 60.92%
[rank0]:2025-10-28 17:53:32,439 - INFO - Avg. fwd time: 38.7681 / Avg. bwd time: 52.4053 / Avg. batch time: 1890.8687 (ms) / GPU bubble ratio: 61.43%
[rank1]:2025-10-28 17:53:32,387 - INFO - Avg. fwd time: 47.0752 / Avg. bwd time: 64.4458 / Avg. batch time: 1800.2242 (ms) / GPU bubble ratio: 50.44%
[rank3]:2025-10-28 17:54:30,225 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/pipeline_schedule_adjustment/251028_1754_rank3_trend_line.svg
[rank1]:2025-10-28 17:54:30,240 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/pipeline_schedule_adjustment/251028_1754_rank1_trend_line.svg
[rank0]:2025-10-28 17:54:30,257 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/pipeline_schedule_adjustment/251028_1754_rank0_trend_line.svg
[rank0]:2025-10-28 17:54:30,263 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank0]:2025-10-28 17:54:30,264 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank0]:2025-10-28 17:54:30,264 - INFO -  step: 140  loss: -2.0000  grad_norm: 10.4143  memory: 14.89GiB(31.34%)  tps: 2,762  tflops: 21.04  mfu: 6.74%
[rank2]:2025-10-28 17:54:30,238 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/pipeline_schedule_adjustment/251028_1754_rank2_trend_line.svg
[rank2]:2025-10-28 17:54:30,263 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank2]:2025-10-28 17:54:30,263 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank2]:2025-10-28 17:54:30,264 - INFO -  step: 140  loss: -2.0000  grad_norm: 10.4143  memory:  7.21GiB(15.18%)  tps: 2,761  tflops: 21.03  mfu: 6.74%
[rank1]:2025-10-28 17:54:30,263 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank1]:2025-10-28 17:54:30,263 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank1]:2025-10-28 17:54:30,263 - INFO -  step: 140  loss: -2.0000  grad_norm: 10.4143  memory: 10.75GiB(22.62%)  tps: 2,761  tflops: 21.03  mfu: 6.74%
[rank3]:2025-10-28 17:54:30,461 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/pipeline_schedule/251028_1754_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 1262.22 ms, GPU Bubble Ratio: 59.00%, 31.38%, 49.51%, 18.81%
[rank3]:2025-10-28 17:54:30,461 - INFO - 	> Batch Time: 1262.22 ms (Average Freeze Ratio: 0.00)
[rank3]:2025-10-28 17:54:30,461 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank3]:2025-10-28 17:54:30,462 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank3]:2025-10-28 17:54:30,464 - INFO -  step: 140  loss:  4.2682  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,751  tflops: 20.95  mfu: 6.72%
[rank0]:2025-10-28 17:55:06,122 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-28 17:55:50,117 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/pipeline_schedule_adjustment/251028_1755_rank2_trend_line.svg
[rank3]:2025-10-28 17:55:50,129 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/pipeline_schedule_adjustment/251028_1755_rank3_trend_line.svg
[rank1]:2025-10-28 17:55:50,117 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/pipeline_schedule_adjustment/251028_1755_rank1_trend_line.svg
[rank1]:2025-10-28 17:55:50,137 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank1]:2025-10-28 17:55:50,138 - INFO -  step: 160  loss: -2.0000  grad_norm: 33.1211  memory: 10.75GiB(22.62%)  tps: 2,051  tflops: 15.62  mfu: 5.01%
[rank2]:2025-10-28 17:55:50,137 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-28 17:55:50,139 - INFO -  step: 160  loss: -2.0000  grad_norm: 33.1211  memory:  7.21GiB(15.18%)  tps: 2,051  tflops: 15.62  mfu: 5.01%
[rank0]:2025-10-28 17:55:50,126 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/pipeline_schedule_adjustment/251028_1755_rank0_trend_line.svg
[rank0]:2025-10-28 17:55:50,137 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank0]:2025-10-28 17:55:50,137 - INFO -  step: 160  loss: -2.0000  grad_norm: 33.1211  memory: 14.89GiB(31.34%)  tps: 2,051  tflops: 15.62  mfu: 5.01%
[rank3]:2025-10-28 17:55:50,361 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/pipeline_schedule/251028_1755_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 1376.01 ms, GPU Bubble Ratio: 54.40%, 35.10%, 52.39%, 18.61%
[rank3]:2025-10-28 17:55:50,362 - INFO - 	> Batch Time: 1376.01 ms (Average Freeze Ratio: 0.28)
[rank3]:2025-10-28 17:55:50,362 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-28 17:55:50,365 - INFO -  step: 160  loss:  1.3488  grad_norm: 33.1211  memory: 24.67GiB(51.93%)  tps: 2,051  tflops: 15.62  mfu: 5.01%
[rank3]:2025-10-28 17:55:51,611 - INFO - Avg. fwd time: 66.5001 / Avg. bwd time: 120.3606 / Avg. batch time: 1556.1485 (ms) / GPU bubble ratio: 3.94%
[rank2]:2025-10-28 17:55:51,663 - INFO - Avg. fwd time: 33.2859 / Avg. bwd time: 49.4451 / Avg. batch time: 1643.4861 (ms) / GPU bubble ratio: 59.73%
[rank1]:2025-10-28 17:55:51,731 - INFO - Avg. fwd time: 47.2180 / Avg. bwd time: 64.4673 / Avg. batch time: 1754.2467 (ms) / GPU bubble ratio: 49.07%
[rank0]:2025-10-28 17:55:51,798 - INFO - Avg. fwd time: 38.6637 / Avg. bwd time: 50.1764 / Avg. batch time: 1845.2291 (ms) / GPU bubble ratio: 61.48%
[rank2]:2025-10-28 17:56:49,963 - INFO -  step: 180  loss: -2.0000  grad_norm: 32.5207  memory:  7.21GiB(15.18%)  tps: 2,739  tflops: 20.86  mfu: 6.69%
[rank0]:2025-10-28 17:56:49,988 - INFO -  step: 180  loss: -2.0000  grad_norm: 32.5207  memory: 14.89GiB(31.34%)  tps: 2,738  tflops: 20.85  mfu: 6.68%
[rank3]:2025-10-28 17:56:49,950 - INFO -  step: 180  loss:  2.1311  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,750  tflops: 20.94  mfu: 6.71%
[rank1]:2025-10-28 17:56:49,967 - INFO -  step: 180  loss: -2.0000  grad_norm: 32.5207  memory: 10.75GiB(22.62%)  tps: 2,738  tflops: 20.86  mfu: 6.68%
[rank0]:2025-10-28 17:57:46,336 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-28 17:57:49,420 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/pipeline_schedule_adjustment/251028_1757_rank3_trend_line.svg
[rank2]:2025-10-28 17:57:49,432 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/pipeline_schedule_adjustment/251028_1757_rank2_trend_line.svg
[rank2]:2025-10-28 17:57:49,454 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank2]:2025-10-28 17:57:49,455 - INFO -  step: 200  loss: -2.0000  grad_norm:  2.1061  memory:  7.21GiB(15.18%)  tps: 2,754  tflops: 20.97  mfu: 6.72%
[rank2]:2025-10-28 17:57:49,455 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-10-28 17:57:49,447 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/pipeline_schedule_adjustment/251028_1757_rank0_trend_line.svg
[rank0]:2025-10-28 17:57:49,454 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-28 17:57:49,455 - INFO -  step: 200  loss: -2.0000  grad_norm:  2.1061  memory: 14.89GiB(31.34%)  tps: 2,755  tflops: 20.98  mfu: 6.73%
[rank0]:2025-10-28 17:57:49,455 - INFO - ðŸ”Ž  Running validation at step 200
[rank1]:2025-10-28 17:57:49,436 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/pipeline_schedule_adjustment/251028_1757_rank1_trend_line.svg
[rank1]:2025-10-28 17:57:49,454 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-10-28 17:57:49,455 - INFO -  step: 200  loss: -2.0000  grad_norm:  2.1061  memory: 10.75GiB(22.62%)  tps: 2,754  tflops: 20.98  mfu: 6.72%
[rank1]:2025-10-28 17:57:49,455 - INFO - ðŸ”Ž  Running validation at step 200
[rank3]:2025-10-28 17:57:49,648 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/pipeline_schedule/251028_1757_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 1380.00 ms, GPU Bubble Ratio: 48.26%, 30.62%, 52.77%, 19.36%
[rank3]:2025-10-28 17:57:49,649 - INFO - 	> Batch Time: 1380.00 ms (Average Freeze Ratio: 0.31)
[rank3]:2025-10-28 17:57:49,649 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-28 17:57:49,652 - INFO -  step: 200  loss:  1.2545  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,744  tflops: 20.90  mfu: 6.70%
[rank3]:2025-10-28 17:57:49,652 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-10-28 17:58:58,414 - INFO - validate step: 200  loss: -1.0000  memory: 14.89GiB(31.34%)  tps: 5,940
[rank1]:2025-10-28 17:58:58,495 - INFO - validate step: 200  loss: -1.0000  memory: 10.75GiB(22.62%)  tps: 5,933
[rank2]:2025-10-28 17:58:58,576 - INFO - validate step: 200  loss: -1.0000  memory:  7.21GiB(15.18%)  tps: 5,926
[rank3]:2025-10-28 17:58:58,636 - INFO - validate step: 200  loss:  1.3143  memory: 24.67GiB(51.93%)  tps: 5,938
[rank1]:2025-10-28 17:58:58,714 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251028_1758_stage1_step200.svg
[rank2]:2025-10-28 17:58:58,720 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251028_1758_stage2_step200.svg
[rank0]:2025-10-28 17:58:58,714 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251028_1758_stage0_step200.svg
[rank3]:2025-10-28 17:58:58,842 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/pipeline_schedule/251028_1758_real_step200_rank3.svg
[rank3]:> Batch Time: 1869.39 ms, GPU Bubble Ratio: 58.14%, 50.61%, 63.67%, 14.99%
[rank3]:2025-10-28 17:58:58,914 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251028_1758_stage3_step200.svg
[rank3]:2025-10-28 17:59:00,134 - INFO - Avg. fwd time: 66.3787 / Avg. bwd time: 110.7361 / Avg. batch time: 1477.1172 (ms) / GPU bubble ratio: 4.08%
[rank2]:2025-10-28 17:59:00,189 - INFO - Avg. fwd time: 33.4137 / Avg. bwd time: 49.0054 / Avg. batch time: 1563.9025 (ms) / GPU bubble ratio: 57.84%
[rank1]:2025-10-28 17:59:00,254 - INFO - Avg. fwd time: 47.9020 / Avg. bwd time: 68.0905 / Avg. batch time: 1675.5742 (ms) / GPU bubble ratio: 44.62%
[rank0]:2025-10-28 17:59:00,307 - INFO - Avg. fwd time: 38.9513 / Avg. bwd time: 52.1390 / Avg. batch time: 1767.7986 (ms) / GPU bubble ratio: 58.78%
[rank2]:2025-10-28 17:59:58,036 - INFO -  step: 220  loss: -2.0000  grad_norm: 11.1306  memory:  7.21GiB(15.18%)  tps: 2,756  tflops: 20.99  mfu: 6.73%
[rank3]:2025-10-28 17:59:58,024 - INFO -  step: 220  loss:  1.6839  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,759  tflops: 21.01  mfu: 6.73%
[rank1]:2025-10-28 17:59:58,040 - INFO -  step: 220  loss: -2.0000  grad_norm: 11.1306  memory: 10.75GiB(22.62%)  tps: 2,752  tflops: 20.96  mfu: 6.72%
[rank0]:2025-10-28 17:59:58,055 - INFO -  step: 220  loss: -2.0000  grad_norm: 11.1306  memory: 14.89GiB(31.34%)  tps: 2,747  tflops: 20.92  mfu: 6.71%
[rank3]:2025-10-28 18:00:57,262 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/pipeline_schedule_adjustment/251028_1800_rank3_trend_line.svg
[rank2]:2025-10-28 18:00:57,274 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/pipeline_schedule_adjustment/251028_1800_rank2_trend_line.svg
[rank2]:2025-10-28 18:00:57,300 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-28 18:00:57,301 - INFO -  step: 240  loss: -2.0000  grad_norm:  0.6471  memory:  7.21GiB(15.18%)  tps: 2,765  tflops: 21.06  mfu: 6.75%
[rank0]:2025-10-28 18:00:57,293 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/pipeline_schedule_adjustment/251028_1800_rank0_trend_line.svg
[rank0]:2025-10-28 18:00:57,300 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank0]:2025-10-28 18:00:57,301 - INFO -  step: 240  loss: -2.0000  grad_norm:  0.6471  memory: 14.89GiB(31.34%)  tps: 2,765  tflops: 21.06  mfu: 6.75%
[rank1]:2025-10-28 18:00:57,277 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/pipeline_schedule_adjustment/251028_1800_rank1_trend_line.svg
[rank1]:2025-10-28 18:00:57,300 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-10-28 18:00:57,301 - INFO -  step: 240  loss: -2.0000  grad_norm:  0.6471  memory: 10.75GiB(22.62%)  tps: 2,765  tflops: 21.06  mfu: 6.75%
[rank3]:2025-10-28 18:00:57,499 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/pipeline_schedule/251028_1800_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 1374.28 ms, GPU Bubble Ratio: 51.55%, 31.72%, 51.56%, 19.15%
[rank3]:2025-10-28 18:00:57,499 - INFO - 	> Batch Time: 1374.28 ms (Average Freeze Ratio: 0.31)
[rank3]:2025-10-28 18:00:57,500 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-28 18:00:57,503 - INFO -  step: 240  loss:  1.2202  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,755  tflops: 20.98  mfu: 6.72%
[rank3]:2025-10-28 18:00:58,668 - INFO - Avg. fwd time: 66.2885 / Avg. bwd time: 104.3113 / Avg. batch time: 1424.3570 (ms) / GPU bubble ratio: 4.18%
[rank2]:2025-10-28 18:00:58,720 - INFO - Avg. fwd time: 33.6770 / Avg. bwd time: 49.9715 / Avg. batch time: 1511.5417 (ms) / GPU bubble ratio: 55.73%
[rank1]:2025-10-28 18:00:58,784 - INFO - Avg. fwd time: 47.8613 / Avg. bwd time: 66.9784 / Avg. batch time: 1622.9988 (ms) / GPU bubble ratio: 43.39%
[rank0]:2025-10-28 18:00:58,844 - INFO - Avg. fwd time: 38.7338 / Avg. bwd time: 48.1463 / Avg. batch time: 1714.6384 (ms) / GPU bubble ratio: 59.46%
[rank0]:2025-10-28 18:01:23,916 - INFO - [GC] Peforming periodical GC collection 0.02 seconds
[rank3]:2025-10-28 18:01:56,297 - INFO -  step: 260  loss:  1.5027  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,787  tflops: 21.22  mfu: 6.80%
[rank1]:2025-10-28 18:01:56,313 - INFO -  step: 260  loss: -2.0000  grad_norm: 63.3895  memory: 10.75GiB(22.62%)  tps: 2,776  tflops: 21.15  mfu: 6.78%
[rank0]:2025-10-28 18:01:56,328 - INFO -  step: 260  loss: -2.0000  grad_norm: 63.3895  memory: 14.89GiB(31.34%)  tps: 2,776  tflops: 21.14  mfu: 6.78%
[rank2]:2025-10-28 18:01:56,309 - INFO -  step: 260  loss: -2.0000  grad_norm: 63.3895  memory:  7.21GiB(15.18%)  tps: 2,777  tflops: 21.15  mfu: 6.78%
[rank3]:2025-10-28 18:02:55,579 - INFO -  step: 280  loss:  1.1700  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,764  tflops: 21.05  mfu: 6.75%
[rank1]:2025-10-28 18:02:55,596 - INFO -  step: 280  loss: -2.0000  grad_norm:  1.0570  memory: 10.75GiB(22.62%)  tps: 2,764  tflops: 21.05  mfu: 6.75%
[rank0]:2025-10-28 18:02:55,611 - INFO -  step: 280  loss: -2.0000  grad_norm:  1.0570  memory: 14.89GiB(31.34%)  tps: 2,764  tflops: 21.05  mfu: 6.75%
[rank2]:2025-10-28 18:02:55,591 - INFO -  step: 280  loss: -2.0000  grad_norm:  1.0570  memory:  7.21GiB(15.18%)  tps: 2,764  tflops: 21.05  mfu: 6.75%
[rank3]:2025-10-28 18:02:56,927 - INFO - Avg. fwd time: 66.1948 / Avg. bwd time: 99.6926 / Avg. batch time: 1386.2151 (ms) / GPU bubble ratio: 4.26%
[rank2]:2025-10-28 18:02:56,985 - INFO - Avg. fwd time: 33.7394 / Avg. bwd time: 49.5791 / Avg. batch time: 1472.9258 (ms) / GPU bubble ratio: 54.75%
[rank1]:2025-10-28 18:02:57,050 - INFO - Avg. fwd time: 47.8483 / Avg. bwd time: 66.1371 / Avg. batch time: 1584.2469 (ms) / GPU bubble ratio: 42.44%
[rank0]:2025-10-28 18:02:57,110 - INFO - Avg. fwd time: 38.8534 / Avg. bwd time: 49.8332 / Avg. batch time: 1676.4257 (ms) / GPU bubble ratio: 57.68%
[rank0]:2025-10-28 18:03:51,832 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-28 18:03:54,756 - INFO -  step: 300  loss: -2.0000  grad_norm: 78.0620  memory:  7.21GiB(15.18%)  tps: 2,769  tflops: 21.09  mfu: 6.76%
[rank2]:2025-10-28 18:03:54,756 - INFO - ðŸ”Ž  Running validation at step 300
[rank3]:2025-10-28 18:03:54,744 - INFO -  step: 300  loss:  1.3868  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,769  tflops: 21.09  mfu: 6.76%
[rank3]:2025-10-28 18:03:54,745 - INFO - ðŸ”Ž  Running validation at step 300
[rank1]:2025-10-28 18:03:54,760 - INFO -  step: 300  loss: -2.0000  grad_norm: 78.0620  memory: 10.75GiB(22.62%)  tps: 2,769  tflops: 21.09  mfu: 6.76%
[rank1]:2025-10-28 18:03:54,760 - INFO - ðŸ”Ž  Running validation at step 300
[rank0]:2025-10-28 18:03:54,771 - INFO -  step: 300  loss: -2.0000  grad_norm: 78.0620  memory: 14.89GiB(31.34%)  tps: 2,769  tflops: 21.09  mfu: 6.76%
[rank0]:2025-10-28 18:03:54,771 - INFO - ðŸ”Ž  Running validation at step 300
[rank0]:2025-10-28 18:05:03,790 - INFO - validate step: 300  loss: -1.0000  memory: 14.89GiB(31.34%)  tps: 5,935
[rank1]:2025-10-28 18:05:03,873 - INFO - validate step: 300  loss: -1.0000  memory: 10.75GiB(22.62%)  tps: 5,927
[rank2]:2025-10-28 18:05:03,953 - INFO - validate step: 300  loss: -1.0000  memory:  7.21GiB(15.18%)  tps: 5,919
[rank3]:2025-10-28 18:05:04,015 - INFO - validate step: 300  loss:  1.2420  memory: 24.67GiB(51.93%)  tps: 5,913
[rank1]:2025-10-28 18:05:04,091 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251028_1805_stage1_step300.svg
[rank2]:2025-10-28 18:05:04,090 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251028_1805_stage2_step300.svg
[rank0]:2025-10-28 18:05:04,091 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251028_1805_stage0_step300.svg
[rank3]:2025-10-28 18:05:04,213 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/pipeline_schedule/251028_1805_real_step300_rank3.svg
[rank3]:> Batch Time: 1406.17 ms, GPU Bubble Ratio: 44.69%, 32.90%, 51.27%, 19.80%
[rank3]:2025-10-28 18:05:04,280 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251028_1805_stage3_step300.svg
[rank1]:2025-10-28 18:06:03,735 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/pipeline_schedule_adjustment/251028_1806_rank1_trend_line.svg
[rank1]:2025-10-28 18:06:03,755 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-10-28 18:06:03,756 - INFO -  step: 320  loss: -2.0000  grad_norm:  4.7587  memory: 10.75GiB(22.62%)  tps: 2,736  tflops: 20.84  mfu: 6.68%
[rank3]:2025-10-28 18:06:03,723 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/pipeline_schedule_adjustment/251028_1806_rank3_trend_line.svg
[rank2]:2025-10-28 18:06:03,735 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/pipeline_schedule_adjustment/251028_1806_rank2_trend_line.svg
[rank2]:2025-10-28 18:06:03,755 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-28 18:06:03,756 - INFO -  step: 320  loss: -2.0000  grad_norm:  4.7587  memory:  7.21GiB(15.18%)  tps: 2,740  tflops: 20.87  mfu: 6.69%
[rank0]:2025-10-28 18:06:03,748 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/pipeline_schedule_adjustment/251028_1806_rank0_trend_line.svg
[rank0]:2025-10-28 18:06:03,755 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank0]:2025-10-28 18:06:03,756 - INFO -  step: 320  loss: -2.0000  grad_norm:  4.7587  memory: 14.89GiB(31.34%)  tps: 2,732  tflops: 20.81  mfu: 6.67%
[rank3]:2025-10-28 18:06:03,954 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/pipeline_schedule/251028_1806_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 1379.18 ms, GPU Bubble Ratio: 48.22%, 33.72%, 52.25%, 19.57%
[rank3]:2025-10-28 18:06:03,955 - INFO - 	> Batch Time: 1379.18 ms (Average Freeze Ratio: 0.31)
[rank3]:2025-10-28 18:06:03,955 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-28 18:06:03,958 - INFO -  step: 320  loss:  1.1889  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,733  tflops: 20.82  mfu: 6.67%
[rank3]:2025-10-28 18:06:05,177 - INFO - Avg. fwd time: 66.1447 / Avg. bwd time: 96.2644 / Avg. batch time: 1358.0731 (ms) / GPU bubble ratio: 4.33%
[rank2]:2025-10-28 18:06:05,234 - INFO - Avg. fwd time: 33.7781 / Avg. bwd time: 49.2763 / Avg. batch time: 1444.6849 (ms) / GPU bubble ratio: 54.01%
[rank1]:2025-10-28 18:06:05,298 - INFO - Avg. fwd time: 47.8711 / Avg. bwd time: 65.5475 / Avg. batch time: 1555.9881 (ms) / GPU bubble ratio: 41.69%
[rank0]:2025-10-28 18:06:05,364 - INFO - Avg. fwd time: 38.9573 / Avg. bwd time: 51.0972 / Avg. batch time: 1648.6231 (ms) / GPU bubble ratio: 56.30%
[rank3]:2025-10-28 18:07:03,152 - INFO -  step: 340  loss:  1.3233  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,768  tflops: 21.08  mfu: 6.76%
[rank2]:2025-10-28 18:07:03,164 - INFO -  step: 340  loss: -2.0000  grad_norm: 64.3677  memory:  7.21GiB(15.18%)  tps: 2,758  tflops: 21.00  mfu: 6.73%
[rank0]:2025-10-28 18:07:03,178 - INFO -  step: 340  loss: -2.0000  grad_norm: 64.3677  memory: 14.89GiB(31.34%)  tps: 2,757  tflops: 21.00  mfu: 6.73%
[rank1]:2025-10-28 18:07:03,168 - INFO -  step: 340  loss: -2.0000  grad_norm: 64.3677  memory: 10.75GiB(22.62%)  tps: 2,758  tflops: 21.00  mfu: 6.73%
[rank0]:2025-10-28 18:07:29,845 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-28 18:08:02,606 - INFO -  step: 360  loss: -2.0000  grad_norm:  0.9307  memory: 10.75GiB(22.62%)  tps: 2,756  tflops: 20.99  mfu: 6.73%
[rank3]:2025-10-28 18:08:02,585 - INFO -  step: 360  loss:  1.1327  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,757  tflops: 21.00  mfu: 6.73%
[rank2]:2025-10-28 18:08:02,597 - INFO -  step: 360  loss: -2.0000  grad_norm:  0.9307  memory:  7.21GiB(15.18%)  tps: 2,757  tflops: 21.00  mfu: 6.73%
[rank0]:2025-10-28 18:08:02,618 - INFO -  step: 360  loss: -2.0000  grad_norm:  0.9307  memory: 14.89GiB(31.34%)  tps: 2,756  tflops: 20.99  mfu: 6.73%
[rank3]:2025-10-28 18:08:03,950 - INFO - Avg. fwd time: 66.1172 / Avg. bwd time: 93.5968 / Avg. batch time: 1336.2653 (ms) / GPU bubble ratio: 4.38%
[rank2]:2025-10-28 18:08:04,002 - INFO - Avg. fwd time: 33.8236 / Avg. bwd time: 49.0534 / Avg. batch time: 1422.5493 (ms) / GPU bubble ratio: 53.39%
[rank1]:2025-10-28 18:08:04,078 - INFO - Avg. fwd time: 47.8636 / Avg. bwd time: 65.1201 / Avg. batch time: 1533.8395 (ms) / GPU bubble ratio: 41.07%
[rank0]:2025-10-28 18:08:04,143 - INFO - Avg. fwd time: 39.0674 / Avg. bwd time: 52.1187 / Avg. batch time: 1626.8899 (ms) / GPU bubble ratio: 55.16%
[rank3]:2025-10-28 18:09:01,944 - INFO -  step: 380  loss:  1.2531  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,760  tflops: 21.02  mfu: 6.74%
[rank1]:2025-10-28 18:09:01,959 - INFO -  step: 380  loss: -2.0000  grad_norm:  4.0956  memory: 10.75GiB(22.62%)  tps: 2,760  tflops: 21.02  mfu: 6.74%
[rank2]:2025-10-28 18:09:01,955 - INFO -  step: 380  loss: -2.0000  grad_norm:  4.0956  memory:  7.21GiB(15.18%)  tps: 2,760  tflops: 21.02  mfu: 6.74%
[rank0]:2025-10-28 18:09:01,976 - INFO -  step: 380  loss: -2.0000  grad_norm:  4.0956  memory: 14.89GiB(31.34%)  tps: 2,760  tflops: 21.02  mfu: 6.74%
[rank0]:2025-10-28 18:09:58,330 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-28 18:10:01,353 - INFO -  step: 400  loss:  1.1347  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,758  tflops: 21.00  mfu: 6.73%
[rank3]:2025-10-28 18:10:01,353 - INFO - ðŸ”Ž  Running validation at step 400
[rank1]:2025-10-28 18:10:01,368 - INFO -  step: 400  loss: -2.0000  grad_norm:  2.4074  memory: 10.75GiB(22.62%)  tps: 2,758  tflops: 21.00  mfu: 6.73%
[rank1]:2025-10-28 18:10:01,368 - INFO - ðŸ”Ž  Running validation at step 400
[rank2]:2025-10-28 18:10:01,365 - INFO -  step: 400  loss: -2.0000  grad_norm:  2.4074  memory:  7.21GiB(15.18%)  tps: 2,758  tflops: 21.00  mfu: 6.73%
[rank2]:2025-10-28 18:10:01,365 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-10-28 18:10:01,384 - INFO -  step: 400  loss: -2.0000  grad_norm:  2.4074  memory: 14.89GiB(31.34%)  tps: 2,758  tflops: 21.00  mfu: 6.73%
[rank0]:2025-10-28 18:10:01,384 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-10-28 18:11:10,383 - INFO - validate step: 400  loss: -1.0000  memory: 14.89GiB(31.34%)  tps: 5,936
[rank1]:2025-10-28 18:11:10,465 - INFO - validate step: 400  loss: -1.0000  memory: 10.75GiB(22.62%)  tps: 5,928
[rank2]:2025-10-28 18:11:10,549 - INFO - validate step: 400  loss: -1.0000  memory:  7.21GiB(15.18%)  tps: 5,920
[rank3]:2025-10-28 18:11:10,609 - INFO - validate step: 400  loss:  1.2261  memory: 24.67GiB(51.93%)  tps: 5,914
[rank2]:2025-10-28 18:11:10,690 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251028_1811_stage2_step400.svg
[rank0]:2025-10-28 18:11:10,691 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251028_1811_stage0_step400.svg
[rank1]:2025-10-28 18:11:10,691 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251028_1811_stage1_step400.svg
[rank3]:2025-10-28 18:11:10,804 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/pipeline_schedule/251028_1811_real_step400_rank3.svg
[rank3]:> Batch Time: 1398.08 ms, GPU Bubble Ratio: 43.78%, 37.75%, 53.81%, 19.91%
[rank3]:2025-10-28 18:11:10,877 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251028_1811_stage3_step400.svg
[rank3]:2025-10-28 18:11:12,101 - INFO - Avg. fwd time: 66.0952 / Avg. bwd time: 91.4574 / Avg. batch time: 1318.8036 (ms) / GPU bubble ratio: 4.43%
[rank2]:2025-10-28 18:11:12,154 - INFO - Avg. fwd time: 33.8610 / Avg. bwd time: 48.8732 / Avg. batch time: 1404.9328 (ms) / GPU bubble ratio: 52.89%
[rank1]:2025-10-28 18:11:12,219 - INFO - Avg. fwd time: 47.9126 / Avg. bwd time: 64.7504 / Avg. batch time: 1516.1976 (ms) / GPU bubble ratio: 40.55%
[rank0]:2025-10-28 18:11:12,279 - INFO - Avg. fwd time: 39.1442 / Avg. bwd time: 52.9431 / Avg. batch time: 1609.5607 (ms) / GPU bubble ratio: 54.23%
[rank3]:2025-10-28 18:12:10,006 - INFO -  step: 420  loss:  1.2274  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,758  tflops: 21.01  mfu: 6.73%
[rank1]:2025-10-28 18:12:10,025 - INFO -  step: 420  loss: -2.0000  grad_norm: 46.1386  memory: 10.75GiB(22.62%)  tps: 2,751  tflops: 20.95  mfu: 6.72%
[rank2]:2025-10-28 18:12:10,018 - INFO -  step: 420  loss: -2.0000  grad_norm: 46.1386  memory:  7.21GiB(15.18%)  tps: 2,755  tflops: 20.98  mfu: 6.73%
[rank0]:2025-10-28 18:12:10,039 - INFO -  step: 420  loss: -2.0000  grad_norm: 46.1386  memory: 14.89GiB(31.34%)  tps: 2,746  tflops: 20.92  mfu: 6.70%
[rank2]:2025-10-28 18:13:09,160 - INFO -  step: 440  loss: -2.0000  grad_norm:  1.1519  memory:  7.21GiB(15.18%)  tps: 2,770  tflops: 21.10  mfu: 6.76%
[rank0]:2025-10-28 18:13:09,181 - INFO -  step: 440  loss: -2.0000  grad_norm:  1.1519  memory: 14.89GiB(31.34%)  tps: 2,770  tflops: 21.10  mfu: 6.76%
[rank3]:2025-10-28 18:13:09,149 - INFO -  step: 440  loss:  1.1370  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,770  tflops: 21.10  mfu: 6.76%
[rank1]:2025-10-28 18:13:09,165 - INFO -  step: 440  loss: -2.0000  grad_norm:  1.1519  memory: 10.75GiB(22.62%)  tps: 2,770  tflops: 21.10  mfu: 6.76%
[rank3]:2025-10-28 18:13:10,508 - INFO - Avg. fwd time: 66.0654 / Avg. bwd time: 89.6872 / Avg. batch time: 1304.2586 (ms) / GPU bubble ratio: 4.47%
[rank2]:2025-10-28 18:13:10,569 - INFO - Avg. fwd time: 33.8864 / Avg. bwd time: 48.7332 / Avg. batch time: 1390.1647 (ms) / GPU bubble ratio: 52.45%
[rank1]:2025-10-28 18:13:10,667 - INFO - Avg. fwd time: 47.8892 / Avg. bwd time: 64.4590 / Avg. batch time: 1501.4399 (ms) / GPU bubble ratio: 40.14%
[rank0]:2025-10-28 18:13:10,730 - INFO - Avg. fwd time: 39.1870 / Avg. bwd time: 53.5856 / Avg. batch time: 1595.0093 (ms) / GPU bubble ratio: 53.47%
[rank0]:2025-10-28 18:13:36,026 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-28 18:14:08,495 - INFO -  step: 460  loss:  1.1867  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,761  tflops: 21.03  mfu: 6.74%
[rank1]:2025-10-28 18:14:08,512 - INFO -  step: 460  loss: -2.0000  grad_norm: 17.8560  memory: 10.75GiB(22.62%)  tps: 2,761  tflops: 21.03  mfu: 6.74%
[rank2]:2025-10-28 18:14:08,506 - INFO -  step: 460  loss: -2.0000  grad_norm: 17.8560  memory:  7.21GiB(15.18%)  tps: 2,761  tflops: 21.03  mfu: 6.74%
[rank0]:2025-10-28 18:14:08,526 - INFO -  step: 460  loss: -2.0000  grad_norm: 17.8560  memory: 14.89GiB(31.34%)  tps: 2,761  tflops: 21.03  mfu: 6.74%
[rank2]:2025-10-28 18:15:07,813 - INFO -  step: 480  loss: -2.0000  grad_norm:  2.0116  memory:  7.21GiB(15.18%)  tps: 2,763  tflops: 21.04  mfu: 6.74%
[rank0]:2025-10-28 18:15:07,839 - INFO -  step: 480  loss: -2.0000  grad_norm:  2.0116  memory: 14.89GiB(31.34%)  tps: 2,762  tflops: 21.04  mfu: 6.74%
[rank3]:2025-10-28 18:15:07,801 - INFO -  step: 480  loss:  1.1372  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,763  tflops: 21.04  mfu: 6.74%
[rank1]:2025-10-28 18:15:07,826 - INFO -  step: 480  loss: -2.0000  grad_norm:  2.0116  memory: 10.75GiB(22.62%)  tps: 2,762  tflops: 21.04  mfu: 6.74%
[rank3]:2025-10-28 18:15:09,106 - INFO - Avg. fwd time: 66.0525 / Avg. bwd time: 88.2202 / Avg. batch time: 1292.2963 (ms) / GPU bubble ratio: 4.50%
[rank2]:2025-10-28 18:15:09,164 - INFO - Avg. fwd time: 33.9111 / Avg. bwd time: 48.6067 / Avg. batch time: 1378.0054 (ms) / GPU bubble ratio: 52.09%
[rank1]:2025-10-28 18:15:09,230 - INFO - Avg. fwd time: 47.8918 / Avg. bwd time: 64.2035 / Avg. batch time: 1489.1776 (ms) / GPU bubble ratio: 39.78%
[rank0]:2025-10-28 18:15:09,297 - INFO - Avg. fwd time: 39.2502 / Avg. bwd time: 54.1330 / Avg. batch time: 1582.9434 (ms) / GPU bubble ratio: 52.81%
[rank0]:2025-10-28 18:16:04,225 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-28 18:16:07,166 - INFO -  step: 500  loss:  1.1738  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,760  tflops: 21.02  mfu: 6.74%
[rank3]:2025-10-28 18:16:07,167 - INFO - ðŸ”Ž  Running validation at step 500
[rank2]:2025-10-28 18:16:07,178 - INFO -  step: 500  loss: -2.0000  grad_norm: 22.1192  memory:  7.21GiB(15.18%)  tps: 2,760  tflops: 21.02  mfu: 6.74%
[rank2]:2025-10-28 18:16:07,178 - INFO - ðŸ”Ž  Running validation at step 500
[rank0]:2025-10-28 18:16:07,200 - INFO -  step: 500  loss: -2.0000  grad_norm: 22.1192  memory: 14.89GiB(31.34%)  tps: 2,760  tflops: 21.02  mfu: 6.74%
[rank0]:2025-10-28 18:16:07,200 - INFO - ðŸ”Ž  Running validation at step 500
[rank1]:2025-10-28 18:16:07,183 - INFO -  step: 500  loss: -2.0000  grad_norm: 22.1192  memory: 10.75GiB(22.62%)  tps: 2,760  tflops: 21.02  mfu: 6.74%
[rank1]:2025-10-28 18:16:07,183 - INFO - ðŸ”Ž  Running validation at step 500
[rank0]:2025-10-28 18:17:16,143 - INFO - validate step: 500  loss: -1.0000  memory: 14.89GiB(31.34%)  tps: 5,941
[rank1]:2025-10-28 18:17:16,224 - INFO - validate step: 500  loss: -1.0000  memory: 10.75GiB(22.62%)  tps: 5,933
[rank3]:2025-10-28 18:17:16,364 - INFO - validate step: 500  loss:  1.2093  memory: 24.67GiB(51.93%)  tps: 5,919
[rank2]:2025-10-28 18:17:16,304 - INFO - validate step: 500  loss: -1.0000  memory:  7.21GiB(15.18%)  tps: 5,925
[rank1]:2025-10-28 18:17:16,438 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251028_1817_stage1_step500.svg
[rank2]:2025-10-28 18:17:16,438 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251028_1817_stage2_step500.svg
[rank0]:2025-10-28 18:17:16,438 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251028_1817_stage0_step500.svg
[rank3]:2025-10-28 18:17:16,559 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/pipeline_schedule/251028_1817_real_step500_rank3.svg
[rank3]:> Batch Time: 1394.66 ms, GPU Bubble Ratio: 43.30%, 37.67%, 53.66%, 19.94%
[rank3]:2025-10-28 18:17:16,625 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251028_1817_stage3_step500.svg
[rank2]:2025-10-28 18:18:15,940 - INFO -  step: 520  loss: -2.0000  grad_norm:  1.5348  memory:  7.21GiB(15.18%)  tps: 2,747  tflops: 20.92  mfu: 6.71%
[rank1]:2025-10-28 18:18:15,946 - INFO -  step: 520  loss: -2.0000  grad_norm:  1.5348  memory: 10.75GiB(22.62%)  tps: 2,743  tflops: 20.89  mfu: 6.70%
[rank3]:2025-10-28 18:18:15,929 - INFO -  step: 520  loss:  1.1060  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,751  tflops: 20.95  mfu: 6.71%
[rank0]:2025-10-28 18:18:15,962 - INFO -  step: 520  loss: -2.0000  grad_norm:  1.5348  memory: 14.89GiB(31.34%)  tps: 2,739  tflops: 20.86  mfu: 6.69%
[rank2]:2025-10-28 18:18:17,344 - INFO - Avg. fwd time: 33.9316 / Avg. bwd time: 48.5256 / Avg. batch time: 1368.0171 (ms) / GPU bubble ratio: 51.78%
[rank3]:2025-10-28 18:18:17,285 - INFO - Avg. fwd time: 66.0526 / Avg. bwd time: 86.9913 / Avg. batch time: 1282.3607 (ms) / GPU bubble ratio: 4.52%
[rank1]:2025-10-28 18:18:17,409 - INFO - Avg. fwd time: 47.9030 / Avg. bwd time: 63.9807 / Avg. batch time: 1479.1339 (ms) / GPU bubble ratio: 39.49%
[rank0]:2025-10-28 18:18:17,474 - INFO - Avg. fwd time: 39.2945 / Avg. bwd time: 54.6118 / Avg. batch time: 1573.1168 (ms) / GPU bubble ratio: 52.24%
[rank0]:2025-10-28 18:19:15,268 - INFO -  step: 540  loss: -2.0000  grad_norm:  9.0356  memory: 14.89GiB(31.34%)  tps: 2,763  tflops: 21.04  mfu: 6.74%
[rank3]:2025-10-28 18:19:15,241 - INFO -  step: 540  loss:  1.1616  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,762  tflops: 21.04  mfu: 6.74%
[rank2]:2025-10-28 18:19:15,253 - INFO -  step: 540  loss: -2.0000  grad_norm:  9.0356  memory:  7.21GiB(15.18%)  tps: 2,762  tflops: 21.04  mfu: 6.74%
[rank1]:2025-10-28 18:19:15,257 - INFO -  step: 540  loss: -2.0000  grad_norm:  9.0356  memory: 10.75GiB(22.62%)  tps: 2,762  tflops: 21.04  mfu: 6.74%
[rank0]:2025-10-28 18:19:42,008 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-28 18:20:14,560 - INFO -  step: 560  loss:  1.1714  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,762  tflops: 21.04  mfu: 6.74%
[rank2]:2025-10-28 18:20:14,572 - INFO -  step: 560  loss: -2.0000  grad_norm:  3.6414  memory:  7.21GiB(15.18%)  tps: 2,762  tflops: 21.04  mfu: 6.74%
[rank1]:2025-10-28 18:20:14,576 - INFO -  step: 560  loss: -2.0000  grad_norm:  3.6414  memory: 10.75GiB(22.62%)  tps: 2,762  tflops: 21.04  mfu: 6.74%
[rank0]:2025-10-28 18:20:14,592 - INFO -  step: 560  loss: -2.0000  grad_norm:  3.6414  memory: 14.89GiB(31.34%)  tps: 2,762  tflops: 21.03  mfu: 6.74%
[rank3]:2025-10-28 18:20:15,915 - INFO - Avg. fwd time: 66.0281 / Avg. bwd time: 85.9341 / Avg. batch time: 1273.6133 (ms) / GPU bubble ratio: 4.55%
[rank2]:2025-10-28 18:20:15,967 - INFO - Avg. fwd time: 33.9404 / Avg. bwd time: 48.4273 / Avg. batch time: 1359.1373 (ms) / GPU bubble ratio: 51.52%
[rank1]:2025-10-28 18:20:16,045 - INFO - Avg. fwd time: 47.9466 / Avg. bwd time: 63.7754 / Avg. batch time: 1470.2479 (ms) / GPU bubble ratio: 39.21%
[rank0]:2025-10-28 18:20:16,109 - INFO - Avg. fwd time: 39.3353 / Avg. bwd time: 55.0266 / Avg. batch time: 1564.4416 (ms) / GPU bubble ratio: 51.75%
[rank3]:2025-10-28 18:21:13,665 - INFO -  step: 580  loss:  1.1457  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,772  tflops: 21.11  mfu: 6.77%
[rank2]:2025-10-28 18:21:13,676 - INFO -  step: 580  loss: -2.0000  grad_norm:  9.7784  memory:  7.21GiB(15.18%)  tps: 2,772  tflops: 21.11  mfu: 6.77%
[rank1]:2025-10-28 18:21:13,680 - INFO -  step: 580  loss: -2.0000  grad_norm:  9.7784  memory: 10.75GiB(22.62%)  tps: 2,772  tflops: 21.11  mfu: 6.77%
[rank0]:2025-10-28 18:21:13,694 - INFO -  step: 580  loss: -2.0000  grad_norm:  9.7784  memory: 14.89GiB(31.34%)  tps: 2,772  tflops: 21.11  mfu: 6.77%
[rank0]:2025-10-28 18:22:09,725 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-28 18:22:12,718 - INFO -  step: 600  loss: -2.0000  grad_norm:  1.7069  memory:  7.21GiB(15.18%)  tps: 2,775  tflops: 21.14  mfu: 6.77%
[rank2]:2025-10-28 18:22:12,718 - INFO - ðŸ”Ž  Running validation at step 600
[rank3]:2025-10-28 18:22:12,707 - INFO -  step: 600  loss:  1.1292  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,775  tflops: 21.14  mfu: 6.77%
[rank3]:2025-10-28 18:22:12,707 - INFO - ðŸ”Ž  Running validation at step 600
[rank1]:2025-10-28 18:22:12,722 - INFO -  step: 600  loss: -2.0000  grad_norm:  1.7069  memory: 10.75GiB(22.62%)  tps: 2,775  tflops: 21.14  mfu: 6.77%
[rank1]:2025-10-28 18:22:12,722 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-10-28 18:22:12,745 - INFO -  step: 600  loss: -2.0000  grad_norm:  1.7069  memory: 14.89GiB(31.34%)  tps: 2,775  tflops: 21.13  mfu: 6.77%
[rank0]:2025-10-28 18:22:12,745 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-10-28 18:23:21,638 - INFO - validate step: 600  loss: -1.0000  memory: 14.89GiB(31.34%)  tps: 5,946
[rank1]:2025-10-28 18:23:21,718 - INFO - validate step: 600  loss: -1.0000  memory: 10.75GiB(22.62%)  tps: 5,937
[rank2]:2025-10-28 18:23:21,801 - INFO - validate step: 600  loss: -1.0000  memory:  7.21GiB(15.18%)  tps: 5,929
[rank3]:2025-10-28 18:23:21,861 - INFO - validate step: 600  loss:  1.1990  memory: 24.67GiB(51.93%)  tps: 5,923
[rank1]:2025-10-28 18:23:21,938 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251028_1823_stage1_step600.svg
[rank0]:2025-10-28 18:23:21,937 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251028_1823_stage0_step600.svg
[rank2]:2025-10-28 18:23:21,938 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251028_1823_stage2_step600.svg
[rank3]:2025-10-28 18:23:22,056 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/pipeline_schedule/251028_1823_real_step600_rank3.svg
[rank3]:> Batch Time: 1392.00 ms, GPU Bubble Ratio: 43.02%, 37.57%, 53.57%, 19.94%
[rank3]:2025-10-28 18:23:22,129 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251028_1823_stage3_step600.svg
[rank2]:2025-10-28 18:23:23,411 - INFO - Avg. fwd time: 33.9497 / Avg. bwd time: 48.3508 / Avg. batch time: 1351.2220 (ms) / GPU bubble ratio: 51.27%
[rank3]:2025-10-28 18:23:23,351 - INFO - Avg. fwd time: 65.9925 / Avg. bwd time: 84.9948 / Avg. batch time: 1265.7415 (ms) / GPU bubble ratio: 4.57%
[rank1]:2025-10-28 18:23:23,481 - INFO - Avg. fwd time: 47.9585 / Avg. bwd time: 63.5817 / Avg. batch time: 1462.2849 (ms) / GPU bubble ratio: 38.98%
[rank0]:2025-10-28 18:23:23,542 - INFO - Avg. fwd time: 39.3609 / Avg. bwd time: 55.3795 / Avg. batch time: 1556.5902 (ms) / GPU bubble ratio: 51.31%
[rank3]:2025-10-28 18:24:21,379 - INFO -  step: 620  loss:  1.1684  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,753  tflops: 20.97  mfu: 6.72%
[rank2]:2025-10-28 18:24:21,390 - INFO -  step: 620  loss: -2.0000  grad_norm: 28.6222  memory:  7.21GiB(15.18%)  tps: 2,749  tflops: 20.94  mfu: 6.71%
[rank1]:2025-10-28 18:24:21,394 - INFO -  step: 620  loss: -2.0000  grad_norm: 28.6222  memory: 10.75GiB(22.62%)  tps: 2,746  tflops: 20.91  mfu: 6.70%
[rank0]:2025-10-28 18:24:21,411 - INFO -  step: 620  loss: -2.0000  grad_norm: 28.6222  memory: 14.89GiB(31.34%)  tps: 2,741  tflops: 20.88  mfu: 6.69%
[rank2]:2025-10-28 18:25:20,826 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/pipeline_schedule_adjustment/251028_1825_rank2_trend_line.svg
[rank2]:2025-10-28 18:25:20,860 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank2]:2025-10-28 18:25:20,861 - INFO -  step: 640  loss: -2.0000  grad_norm:  2.2193  memory:  7.21GiB(15.18%)  tps: 2,755  tflops: 20.98  mfu: 6.73%
[rank3]:2025-10-28 18:25:20,813 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/pipeline_schedule_adjustment/251028_1825_rank3_trend_line.svg
[rank1]:2025-10-28 18:25:20,831 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/pipeline_schedule_adjustment/251028_1825_rank1_trend_line.svg
[rank1]:2025-10-28 18:25:20,860 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank1]:2025-10-28 18:25:20,861 - INFO -  step: 640  loss: -2.0000  grad_norm:  2.2193  memory: 10.75GiB(22.62%)  tps: 2,755  tflops: 20.98  mfu: 6.73%
[rank0]:2025-10-28 18:25:20,853 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/pipeline_schedule_adjustment/251028_1825_rank0_trend_line.svg
[rank0]:2025-10-28 18:25:20,860 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-28 18:25:20,861 - INFO -  step: 640  loss: -2.0000  grad_norm:  2.2193  memory: 14.89GiB(31.34%)  tps: 2,756  tflops: 20.99  mfu: 6.73%
[rank3]:2025-10-28 18:25:21,067 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/pipeline_schedule/251028_1825_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 1374.49 ms, GPU Bubble Ratio: 44.59%, 35.41%, 52.84%, 19.37%
[rank3]:2025-10-28 18:25:21,068 - INFO - 	> Batch Time: 1374.49 ms (Average Freeze Ratio: 0.28)
[rank3]:2025-10-28 18:25:21,068 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-28 18:25:21,072 - INFO -  step: 640  loss:  1.1136  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,745  tflops: 20.90  mfu: 6.70%
[rank2]:2025-10-28 18:25:22,361 - INFO - Avg. fwd time: 33.9581 / Avg. bwd time: 48.2780 / Avg. batch time: 1344.6743 (ms) / GPU bubble ratio: 51.07%
[rank3]:2025-10-28 18:25:22,301 - INFO - Avg. fwd time: 65.9862 / Avg. bwd time: 84.1879 / Avg. batch time: 1259.1763 (ms) / GPU bubble ratio: 4.59%
[rank1]:2025-10-28 18:25:22,436 - INFO - Avg. fwd time: 47.9296 / Avg. bwd time: 63.4396 / Avg. batch time: 1455.6897 (ms) / GPU bubble ratio: 38.80%
[rank0]:2025-10-28 18:25:22,490 - INFO - Avg. fwd time: 39.3872 / Avg. bwd time: 55.6769 / Avg. batch time: 1550.1194 (ms) / GPU bubble ratio: 50.94%
[rank0]:2025-10-28 18:25:47,835 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-28 18:26:20,553 - INFO -  step: 660  loss: -2.0000  grad_norm:  5.3529  memory:  7.21GiB(15.18%)  tps: 2,745  tflops: 20.91  mfu: 6.70%
[rank3]:2025-10-28 18:26:20,541 - INFO -  step: 660  loss:  1.1416  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,755  tflops: 20.98  mfu: 6.73%
[rank1]:2025-10-28 18:26:20,558 - INFO -  step: 660  loss: -2.0000  grad_norm:  5.3529  memory: 10.75GiB(22.62%)  tps: 2,745  tflops: 20.90  mfu: 6.70%
[rank0]:2025-10-28 18:26:20,575 - INFO -  step: 660  loss: -2.0000  grad_norm:  5.3529  memory: 14.89GiB(31.34%)  tps: 2,744  tflops: 20.90  mfu: 6.70%
[rank3]:2025-10-28 18:27:20,179 - INFO -  step: 680  loss:  1.1053  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,747  tflops: 20.92  mfu: 6.71%
[rank2]:2025-10-28 18:27:20,191 - INFO -  step: 680  loss: -2.0000  grad_norm:  0.3679  memory:  7.21GiB(15.18%)  tps: 2,747  tflops: 20.92  mfu: 6.71%
[rank1]:2025-10-28 18:27:20,195 - INFO -  step: 680  loss: -2.0000  grad_norm:  0.3679  memory: 10.75GiB(22.62%)  tps: 2,747  tflops: 20.92  mfu: 6.71%
[rank0]:2025-10-28 18:27:20,213 - INFO -  step: 680  loss: -2.0000  grad_norm:  0.3679  memory: 14.89GiB(31.34%)  tps: 2,747  tflops: 20.92  mfu: 6.71%
[rank3]:2025-10-28 18:27:21,537 - INFO - Avg. fwd time: 65.9933 / Avg. bwd time: 83.4921 / Avg. batch time: 1253.6029 (ms) / GPU bubble ratio: 4.60%
[rank2]:2025-10-28 18:27:21,599 - INFO - Avg. fwd time: 33.9905 / Avg. bwd time: 48.7088 / Avg. batch time: 1339.2425 (ms) / GPU bubble ratio: 50.60%
[rank1]:2025-10-28 18:27:21,682 - INFO - Avg. fwd time: 48.1377 / Avg. bwd time: 64.7924 / Avg. batch time: 1450.5886 (ms) / GPU bubble ratio: 37.72%
[rank0]:2025-10-28 18:27:21,736 - INFO - Avg. fwd time: 39.2903 / Avg. bwd time: 54.0762 / Avg. batch time: 1544.7298 (ms) / GPU bubble ratio: 51.65%
[rank0]:2025-10-28 18:28:17,014 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-28 18:28:19,983 - INFO -  step: 700  loss:  1.1363  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,740  tflops: 20.87  mfu: 6.69%
[rank3]:2025-10-28 18:28:19,983 - INFO - ðŸ”Ž  Running validation at step 700
[rank2]:2025-10-28 18:28:19,995 - INFO -  step: 700  loss: -2.0000  grad_norm:  2.0624  memory:  7.21GiB(15.18%)  tps: 2,740  tflops: 20.87  mfu: 6.69%
[rank2]:2025-10-28 18:28:19,995 - INFO - ðŸ”Ž  Running validation at step 700
[rank1]:2025-10-28 18:28:19,998 - INFO -  step: 700  loss: -2.0000  grad_norm:  2.0624  memory: 10.75GiB(22.62%)  tps: 2,740  tflops: 20.87  mfu: 6.69%
[rank1]:2025-10-28 18:28:19,998 - INFO - ðŸ”Ž  Running validation at step 700
[rank0]:2025-10-28 18:28:20,016 - INFO -  step: 700  loss: -2.0000  grad_norm:  2.0624  memory: 14.89GiB(31.34%)  tps: 2,740  tflops: 20.87  mfu: 6.69%
[rank0]:2025-10-28 18:28:20,017 - INFO - ðŸ”Ž  Running validation at step 700
[rank0]:2025-10-28 18:29:29,093 - INFO - validate step: 700  loss: -1.0000  memory: 14.89GiB(31.34%)  tps: 5,930
[rank1]:2025-10-28 18:29:29,175 - INFO - validate step: 700  loss: -1.0000  memory: 10.75GiB(22.62%)  tps: 5,921
[rank2]:2025-10-28 18:29:29,257 - INFO - validate step: 700  loss: -1.0000  memory:  7.21GiB(15.18%)  tps: 5,914
[rank3]:2025-10-28 18:29:29,318 - INFO - validate step: 700  loss:  1.1950  memory: 24.67GiB(51.93%)  tps: 5,908
[rank2]:2025-10-28 18:29:29,399 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251028_1829_stage2_step700.svg
[rank1]:2025-10-28 18:29:29,398 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251028_1829_stage1_step700.svg
[rank0]:2025-10-28 18:29:29,398 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251028_1829_stage0_step700.svg
[rank3]:2025-10-28 18:29:29,516 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/pipeline_schedule/251028_1829_real_step700_rank3.svg
[rank3]:> Batch Time: 1392.14 ms, GPU Bubble Ratio: 43.24%, 37.02%, 53.43%, 20.02%
[rank3]:2025-10-28 18:29:29,588 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251028_1829_stage3_step700.svg
[rank0]:2025-10-28 18:30:28,919 - INFO -  step: 720  loss: -2.0000  grad_norm:  0.4226  memory: 14.89GiB(31.34%)  tps: 2,739  tflops: 20.86  mfu: 6.69%
[rank1]:2025-10-28 18:30:28,907 - INFO -  step: 720  loss: -2.0000  grad_norm:  0.4226  memory: 10.75GiB(22.62%)  tps: 2,743  tflops: 20.89  mfu: 6.70%
[rank3]:2025-10-28 18:30:28,885 - INFO -  step: 720  loss:  1.1359  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,751  tflops: 20.95  mfu: 6.71%
[rank2]:2025-10-28 18:30:28,897 - INFO -  step: 720  loss: -2.0000  grad_norm:  0.4226  memory:  7.21GiB(15.18%)  tps: 2,747  tflops: 20.92  mfu: 6.71%
[rank3]:2025-10-28 18:30:30,233 - INFO - Avg. fwd time: 65.9900 / Avg. bwd time: 82.8771 / Avg. batch time: 1248.6394 (ms) / GPU bubble ratio: 4.62%
[rank2]:2025-10-28 18:30:30,293 - INFO - Avg. fwd time: 34.0132 / Avg. bwd time: 49.0951 / Avg. batch time: 1334.4410 (ms) / GPU bubble ratio: 50.18%
[rank0]:2025-10-28 18:30:30,417 - INFO - Avg. fwd time: 39.1933 / Avg. bwd time: 52.6414 / Avg. batch time: 1539.9961 (ms) / GPU bubble ratio: 52.29%
[rank1]:2025-10-28 18:30:30,363 - INFO - Avg. fwd time: 48.3450 / Avg. bwd time: 65.9849 / Avg. batch time: 1446.1358 (ms) / GPU bubble ratio: 36.75%
[rank1]:2025-10-28 18:31:28,221 - INFO -  step: 740  loss: -2.0000  grad_norm:  9.5342  memory: 10.75GiB(22.62%)  tps: 2,762  tflops: 21.04  mfu: 6.74%
[rank3]:2025-10-28 18:31:28,205 - INFO -  step: 740  loss:  1.1177  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,762  tflops: 21.04  mfu: 6.74%
[rank2]:2025-10-28 18:31:28,217 - INFO -  step: 740  loss: -2.0000  grad_norm:  9.5342  memory:  7.21GiB(15.18%)  tps: 2,762  tflops: 21.04  mfu: 6.74%
[rank0]:2025-10-28 18:31:28,232 - INFO -  step: 740  loss: -2.0000  grad_norm:  9.5342  memory: 14.89GiB(31.34%)  tps: 2,762  tflops: 21.04  mfu: 6.74%
[rank0]:2025-10-28 18:31:54,888 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-28 18:32:27,598 - INFO -  step: 760  loss: -2.0000  grad_norm:  1.0682  memory: 10.75GiB(22.62%)  tps: 2,759  tflops: 21.02  mfu: 6.74%
[rank3]:2025-10-28 18:32:27,582 - INFO -  step: 760  loss:  1.1399  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,759  tflops: 21.02  mfu: 6.74%
[rank2]:2025-10-28 18:32:27,594 - INFO -  step: 760  loss: -2.0000  grad_norm:  1.0682  memory:  7.21GiB(15.18%)  tps: 2,759  tflops: 21.02  mfu: 6.74%
[rank0]:2025-10-28 18:32:27,615 - INFO -  step: 760  loss: -2.0000  grad_norm:  1.0682  memory: 14.89GiB(31.34%)  tps: 2,759  tflops: 21.01  mfu: 6.74%
[rank3]:2025-10-28 18:32:28,940 - INFO - Avg. fwd time: 65.9770 / Avg. bwd time: 82.3043 / Avg. batch time: 1243.9190 (ms) / GPU bubble ratio: 4.64%
[rank2]:2025-10-28 18:32:28,997 - INFO - Avg. fwd time: 34.0313 / Avg. bwd time: 49.4345 / Avg. batch time: 1329.8261 (ms) / GPU bubble ratio: 49.79%
[rank1]:2025-10-28 18:32:29,076 - INFO - Avg. fwd time: 48.4975 / Avg. bwd time: 67.0236 / Avg. batch time: 1441.7712 (ms) / GPU bubble ratio: 35.90%
[rank0]:2025-10-28 18:32:29,139 - INFO - Avg. fwd time: 39.1029 / Avg. bwd time: 51.3637 / Avg. batch time: 1535.3671 (ms) / GPU bubble ratio: 52.86%
[rank3]:2025-10-28 18:33:26,767 - INFO -  step: 780  loss:  1.1580  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,768  tflops: 21.08  mfu: 6.76%
[rank2]:2025-10-28 18:33:26,779 - INFO -  step: 780  loss: -2.0000  grad_norm: 13.9716  memory:  7.21GiB(15.18%)  tps: 2,768  tflops: 21.08  mfu: 6.76%
[rank0]:2025-10-28 18:33:26,795 - INFO -  step: 780  loss: -2.0000  grad_norm: 13.9716  memory: 14.89GiB(31.34%)  tps: 2,769  tflops: 21.09  mfu: 6.76%
[rank1]:2025-10-28 18:33:26,782 - INFO -  step: 780  loss: -2.0000  grad_norm: 13.9716  memory: 10.75GiB(22.62%)  tps: 2,768  tflops: 21.08  mfu: 6.76%
[rank0]:2025-10-28 18:34:23,311 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-28 18:34:26,324 - INFO -  step: 800  loss: -2.0000  grad_norm:  0.3507  memory: 10.75GiB(22.62%)  tps: 2,752  tflops: 20.96  mfu: 6.72%
[rank1]:2025-10-28 18:34:26,324 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-10-28 18:34:26,341 - INFO -  step: 800  loss: -2.0000  grad_norm:  0.3507  memory: 14.89GiB(31.34%)  tps: 2,751  tflops: 20.96  mfu: 6.72%
[rank0]:2025-10-28 18:34:26,342 - INFO - ðŸ”Ž  Running validation at step 800
[rank3]:2025-10-28 18:34:26,308 - INFO -  step: 800  loss:  1.1369  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,752  tflops: 20.96  mfu: 6.72%
[rank3]:2025-10-28 18:34:26,308 - INFO - ðŸ”Ž  Running validation at step 800
[rank2]:2025-10-28 18:34:26,320 - INFO -  step: 800  loss: -2.0000  grad_norm:  0.3507  memory:  7.21GiB(15.18%)  tps: 2,752  tflops: 20.96  mfu: 6.72%
[rank2]:2025-10-28 18:34:26,320 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-10-28 18:35:35,617 - INFO - validate step: 800  loss: -1.0000  memory: 14.89GiB(31.34%)  tps: 5,913
[rank0]:2025-10-28 18:35:35,618 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-28 18:35:35,625 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank1]:2025-10-28 18:35:35,698 - INFO - validate step: 800  loss: -1.0000  memory: 10.75GiB(22.62%)  tps: 5,904
[rank1]:2025-10-28 18:35:35,698 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-28 18:35:35,777 - INFO - validate step: 800  loss: -1.0000  memory:  7.21GiB(15.18%)  tps: 5,897
[rank2]:2025-10-28 18:35:35,778 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-28 18:35:35,834 - INFO - validate step: 800  loss:  1.1911  memory: 24.67GiB(51.93%)  tps: 5,891
[rank3]:2025-10-28 18:35:35,836 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-28 18:35:37,563 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 1.79 seconds.
[rank1]:2025-10-28 18:35:38,011 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 2.31 seconds.
[rank0]:2025-10-28 18:35:39,358 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-28 18:35:39,366 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.75 seconds.
[rank3]:2025-10-28 18:35:39,576 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.74 seconds.
[rank2]:2025-10-28 18:35:39,737 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251028_1835_stage2_step800.svg
[rank1]:2025-10-28 18:35:39,731 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251028_1835_stage1_step800.svg
[rank0]:2025-10-28 18:35:39,796 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251028_1835_stage0_step800.svg
[rank3]:2025-10-28 18:35:39,974 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/pipeline_schedule/251028_1835_real_step800_rank3.svg
[rank3]:> Batch Time: 1392.27 ms, GPU Bubble Ratio: 43.86%, 36.03%, 53.20%, 20.10%
[rank3]:2025-10-28 18:35:40,049 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251028_1835_stage3_step800.svg
[rank3]:2025-10-28 18:35:41,246 - INFO - Avg. fwd time: 65.9606 / Avg. bwd time: 81.7875 / Avg. batch time: 1239.6174 (ms) / GPU bubble ratio: 4.65%
[rank2]:2025-10-28 18:35:41,303 - INFO - Avg. fwd time: 34.0454 / Avg. bwd time: 49.7536 / Avg. batch time: 1325.6730 (ms) / GPU bubble ratio: 49.43%
[rank1]:2025-10-28 18:35:41,377 - INFO - Avg. fwd time: 48.6534 / Avg. bwd time: 68.0003 / Avg. batch time: 1437.8894 (ms) / GPU bubble ratio: 35.10%
[rank0]:2025-10-28 18:35:41,440 - INFO - Avg. fwd time: 39.0273 / Avg. bwd time: 50.2081 / Avg. batch time: 1531.2389 (ms) / GPU bubble ratio: 53.38%
[rank3]:2025-10-28 18:36:10,939 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-28 18:36:10,995 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-28 18:36:11,075 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-28 18:36:11,132 - WARNING - Dataset alpaca is being re-looped
[rank3]:2025-10-28 18:36:44,242 - INFO -  step: 820  loss:  1.1350  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,395  tflops: 18.24  mfu: 5.85%
[rank2]:2025-10-28 18:36:44,255 - INFO -  step: 820  loss: -2.0000  grad_norm:  1.0832  memory:  7.21GiB(15.18%)  tps: 2,393  tflops: 18.22  mfu: 5.84%
[rank1]:2025-10-28 18:36:44,259 - INFO -  step: 820  loss: -2.0000  grad_norm:  1.0832  memory: 10.75GiB(22.62%)  tps: 2,390  tflops: 18.20  mfu: 5.83%
[rank0]:2025-10-28 18:36:44,274 - INFO -  step: 820  loss: -2.0000  grad_norm:  1.0832  memory: 14.89GiB(31.34%)  tps: 2,386  tflops: 18.18  mfu: 5.83%
[rank3]:2025-10-28 18:37:43,754 - INFO -  step: 840  loss:  1.1084  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,753  tflops: 20.97  mfu: 6.72%
[rank2]:2025-10-28 18:37:43,766 - INFO -  step: 840  loss: -2.0000  grad_norm:  0.3403  memory:  7.21GiB(15.18%)  tps: 2,753  tflops: 20.97  mfu: 6.72%
[rank1]:2025-10-28 18:37:43,769 - INFO -  step: 840  loss: -2.0000  grad_norm:  0.3403  memory: 10.75GiB(22.62%)  tps: 2,753  tflops: 20.97  mfu: 6.72%
[rank0]:2025-10-28 18:37:43,786 - INFO -  step: 840  loss: -2.0000  grad_norm:  0.3403  memory: 14.89GiB(31.34%)  tps: 2,753  tflops: 20.97  mfu: 6.72%
[rank3]:2025-10-28 18:37:45,105 - INFO - Avg. fwd time: 65.9542 / Avg. bwd time: 81.3244 / Avg. batch time: 1235.8302 (ms) / GPU bubble ratio: 4.66%
[rank2]:2025-10-28 18:37:45,163 - INFO - Avg. fwd time: 34.0614 / Avg. bwd time: 50.0289 / Avg. batch time: 1321.9480 (ms) / GPU bubble ratio: 49.11%
[rank1]:2025-10-28 18:37:45,245 - INFO - Avg. fwd time: 48.7629 / Avg. bwd time: 68.8669 / Avg. batch time: 1434.3623 (ms) / GPU bubble ratio: 34.39%
[rank0]:2025-10-28 18:37:45,303 - INFO - Avg. fwd time: 38.9625 / Avg. bwd time: 49.1699 / Avg. batch time: 1527.6903 (ms) / GPU bubble ratio: 53.85%
[rank0]:2025-10-28 18:38:10,679 - INFO - [GC] Peforming periodical GC collection 0.26 seconds
[rank3]:2025-10-28 18:38:43,132 - INFO -  step: 860  loss:  1.1251  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,759  tflops: 21.02  mfu: 6.74%
[rank2]:2025-10-28 18:38:43,144 - INFO -  step: 860  loss: -2.0000  grad_norm:  0.4909  memory:  7.21GiB(15.18%)  tps: 2,759  tflops: 21.02  mfu: 6.74%
[rank1]:2025-10-28 18:38:43,148 - INFO -  step: 860  loss: -2.0000  grad_norm:  0.4909  memory: 10.75GiB(22.62%)  tps: 2,759  tflops: 21.02  mfu: 6.74%
[rank0]:2025-10-28 18:38:43,162 - INFO -  step: 860  loss: -2.0000  grad_norm:  0.4909  memory: 14.89GiB(31.34%)  tps: 2,759  tflops: 21.02  mfu: 6.74%
[rank3]:2025-10-28 18:39:42,591 - INFO -  step: 880  loss:  1.1156  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,756  tflops: 20.99  mfu: 6.73%
[rank2]:2025-10-28 18:39:42,603 - INFO -  step: 880  loss: -2.0000  grad_norm:  0.3576  memory:  7.21GiB(15.18%)  tps: 2,756  tflops: 20.99  mfu: 6.73%
[rank1]:2025-10-28 18:39:42,606 - INFO -  step: 880  loss: -2.0000  grad_norm:  0.3576  memory: 10.75GiB(22.62%)  tps: 2,756  tflops: 20.99  mfu: 6.73%
[rank0]:2025-10-28 18:39:42,630 - INFO -  step: 880  loss: -2.0000  grad_norm:  0.3576  memory: 14.89GiB(31.34%)  tps: 2,755  tflops: 20.98  mfu: 6.73%
[rank3]:2025-10-28 18:39:43,921 - INFO - Avg. fwd time: 65.9430 / Avg. bwd time: 80.8967 / Avg. batch time: 1232.2907 (ms) / GPU bubble ratio: 4.67%
[rank2]:2025-10-28 18:39:43,977 - INFO - Avg. fwd time: 34.0808 / Avg. bwd time: 50.2900 / Avg. batch time: 1318.4669 (ms) / GPU bubble ratio: 48.81%
[rank1]:2025-10-28 18:39:44,056 - INFO - Avg. fwd time: 48.8732 / Avg. bwd time: 69.6346 / Avg. batch time: 1431.0538 (ms) / GPU bubble ratio: 33.75%
[rank0]:2025-10-28 18:39:44,112 - INFO - Avg. fwd time: 38.8928 / Avg. bwd time: 48.2245 / Avg. batch time: 1524.1892 (ms) / GPU bubble ratio: 54.27%
[rank0]:2025-10-28 18:40:38,867 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-28 18:40:41,845 - INFO -  step: 900  loss: -2.0000  grad_norm:  4.8826  memory: 14.89GiB(31.34%)  tps: 2,767  tflops: 21.07  mfu: 6.75%
[rank0]:2025-10-28 18:40:41,845 - INFO - ðŸ”Ž  Running validation at step 900
[rank3]:2025-10-28 18:40:41,815 - INFO -  step: 900  loss:  1.1060  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,767  tflops: 21.07  mfu: 6.75%
[rank3]:2025-10-28 18:40:41,815 - INFO - ðŸ”Ž  Running validation at step 900
[rank2]:2025-10-28 18:40:41,827 - INFO -  step: 900  loss: -2.0000  grad_norm:  4.8826  memory:  7.21GiB(15.18%)  tps: 2,766  tflops: 21.07  mfu: 6.75%
[rank2]:2025-10-28 18:40:41,827 - INFO - ðŸ”Ž  Running validation at step 900
[rank1]:2025-10-28 18:40:41,831 - INFO -  step: 900  loss: -2.0000  grad_norm:  4.8826  memory: 10.75GiB(22.62%)  tps: 2,766  tflops: 21.07  mfu: 6.75%
[rank1]:2025-10-28 18:40:41,831 - INFO - ðŸ”Ž  Running validation at step 900
[rank0]:2025-10-28 18:41:50,809 - INFO - validate step: 900  loss: -1.0000  memory: 14.89GiB(31.34%)  tps: 5,939
[rank1]:2025-10-28 18:41:50,891 - INFO - validate step: 900  loss: -1.0000  memory: 10.75GiB(22.62%)  tps: 5,931
[rank2]:2025-10-28 18:41:50,974 - INFO - validate step: 900  loss: -1.0000  memory:  7.21GiB(15.18%)  tps: 5,924
[rank3]:2025-10-28 18:41:51,032 - INFO - validate step: 900  loss:  1.1930  memory: 24.67GiB(51.93%)  tps: 5,918
[rank0]:2025-10-28 18:41:51,105 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251028_1841_stage0_step900.svg
[rank2]:2025-10-28 18:41:51,109 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251028_1841_stage2_step900.svg
[rank1]:2025-10-28 18:41:51,108 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251028_1841_stage1_step900.svg
[rank3]:2025-10-28 18:41:51,258 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/pipeline_schedule/251028_1841_real_step900_rank3.svg
[rank3]:> Batch Time: 1392.30 ms, GPU Bubble Ratio: 44.34%, 34.36%, 52.99%, 20.17%
[rank3]:2025-10-28 18:41:51,325 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251028_1841_stage3_step900.svg
[rank0]:2025-10-28 18:42:50,709 - INFO -  step: 920  loss: -2.0000  grad_norm:  0.6377  memory: 14.89GiB(31.34%)  tps: 2,735  tflops: 20.83  mfu: 6.68%
[rank3]:2025-10-28 18:42:50,675 - INFO -  step: 920  loss:  1.1467  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,747  tflops: 20.92  mfu: 6.71%
[rank2]:2025-10-28 18:42:50,687 - INFO -  step: 920  loss: -2.0000  grad_norm:  0.6377  memory:  7.21GiB(15.18%)  tps: 2,744  tflops: 20.90  mfu: 6.70%
[rank1]:2025-10-28 18:42:50,692 - INFO -  step: 920  loss: -2.0000  grad_norm:  0.6377  memory: 10.75GiB(22.62%)  tps: 2,740  tflops: 20.87  mfu: 6.69%
[rank3]:2025-10-28 18:42:52,027 - INFO - Avg. fwd time: 65.9383 / Avg. bwd time: 80.5115 / Avg. batch time: 1229.1427 (ms) / GPU bubble ratio: 4.68%
[rank2]:2025-10-28 18:42:52,084 - INFO - Avg. fwd time: 34.0934 / Avg. bwd time: 50.5063 / Avg. batch time: 1315.4318 (ms) / GPU bubble ratio: 48.55%
[rank1]:2025-10-28 18:42:52,165 - INFO - Avg. fwd time: 48.9694 / Avg. bwd time: 70.3420 / Avg. batch time: 1428.2188 (ms) / GPU bubble ratio: 33.17%
[rank0]:2025-10-28 18:42:52,228 - INFO - Avg. fwd time: 38.8313 / Avg. bwd time: 47.3534 / Avg. batch time: 1521.1467 (ms) / GPU bubble ratio: 54.67%
[rank3]:2025-10-28 18:43:49,985 - INFO -  step: 940  loss:  1.1294  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,763  tflops: 21.04  mfu: 6.74%
[rank2]:2025-10-28 18:43:49,996 - INFO -  step: 940  loss: -2.0000  grad_norm:  0.6730  memory:  7.21GiB(15.18%)  tps: 2,762  tflops: 21.04  mfu: 6.74%
[rank1]:2025-10-28 18:43:50,001 - INFO -  step: 940  loss: -2.0000  grad_norm:  0.6730  memory: 10.75GiB(22.62%)  tps: 2,762  tflops: 21.04  mfu: 6.74%
[rank0]:2025-10-28 18:43:50,017 - INFO -  step: 940  loss: -2.0000  grad_norm:  0.6730  memory: 14.89GiB(31.34%)  tps: 2,763  tflops: 21.04  mfu: 6.74%
[rank0]:2025-10-28 18:44:16,635 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-28 18:44:49,172 - INFO -  step: 960  loss:  1.1350  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,768  tflops: 21.08  mfu: 6.76%
[rank2]:2025-10-28 18:44:49,183 - INFO -  step: 960  loss: -2.0000  grad_norm:  0.4047  memory:  7.21GiB(15.18%)  tps: 2,768  tflops: 21.08  mfu: 6.76%
[rank1]:2025-10-28 18:44:49,188 - INFO -  step: 960  loss: -2.0000  grad_norm:  0.4047  memory: 10.75GiB(22.62%)  tps: 2,768  tflops: 21.08  mfu: 6.76%
[rank0]:2025-10-28 18:44:49,208 - INFO -  step: 960  loss: -2.0000  grad_norm:  0.4047  memory: 14.89GiB(31.34%)  tps: 2,768  tflops: 21.08  mfu: 6.76%
[rank3]:2025-10-28 18:44:50,478 - INFO - Avg. fwd time: 65.9255 / Avg. bwd time: 80.1469 / Avg. batch time: 1226.0903 (ms) / GPU bubble ratio: 4.69%
[rank2]:2025-10-28 18:44:50,538 - INFO - Avg. fwd time: 34.1071 / Avg. bwd time: 50.7198 / Avg. batch time: 1312.4125 (ms) / GPU bubble ratio: 48.29%
[rank1]:2025-10-28 18:44:50,621 - INFO - Avg. fwd time: 49.0500 / Avg. bwd time: 71.0036 / Avg. batch time: 1425.3606 (ms) / GPU bubble ratio: 32.62%
[rank0]:2025-10-28 18:44:50,676 - INFO - Avg. fwd time: 38.7781 / Avg. bwd time: 46.5541 / Avg. batch time: 1518.1293 (ms) / GPU bubble ratio: 55.03%
[rank2]:2025-10-28 18:45:48,612 - INFO -  step: 980  loss: -2.0000  grad_norm:  1.3752  memory:  7.21GiB(15.18%)  tps: 2,757  tflops: 21.00  mfu: 6.73%
[rank1]:2025-10-28 18:45:48,616 - INFO -  step: 980  loss: -2.0000  grad_norm:  1.3752  memory: 10.75GiB(22.62%)  tps: 2,757  tflops: 21.00  mfu: 6.73%
[rank0]:2025-10-28 18:45:48,631 - INFO -  step: 980  loss: -2.0000  grad_norm:  1.3752  memory: 14.89GiB(31.34%)  tps: 2,757  tflops: 21.00  mfu: 6.73%
[rank3]:2025-10-28 18:45:48,601 - INFO -  step: 980  loss:  1.1311  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,757  tflops: 21.00  mfu: 6.73%
[rank0]:2025-10-28 18:46:45,220 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-28 18:46:48,189 - INFO -  step: 1000  loss: -2.0000  grad_norm:  0.3477  memory:  7.21GiB(15.18%)  tps: 2,750  tflops: 20.95  mfu: 6.71%
[rank2]:2025-10-28 18:46:48,189 - INFO - ðŸ”Ž  Running validation at step 1000
[rank1]:2025-10-28 18:46:48,193 - INFO -  step: 1000  loss: -2.0000  grad_norm:  0.3477  memory: 10.75GiB(22.62%)  tps: 2,750  tflops: 20.95  mfu: 6.71%
[rank1]:2025-10-28 18:46:48,193 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-10-28 18:46:48,210 - INFO -  step: 1000  loss: -2.0000  grad_norm:  0.3477  memory: 14.89GiB(31.34%)  tps: 2,750  tflops: 20.94  mfu: 6.71%
[rank0]:2025-10-28 18:46:48,210 - INFO - ðŸ”Ž  Running validation at step 1000
[rank3]:2025-10-28 18:46:48,177 - INFO -  step: 1000  loss:  1.1281  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,750  tflops: 20.95  mfu: 6.71%
[rank3]:2025-10-28 18:46:48,177 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-10-28 18:47:58,288 - INFO - validate step: 1000  loss: -1.0000  memory: 14.89GiB(31.34%)  tps: 5,845
[rank1]:2025-10-28 18:47:58,370 - INFO - validate step: 1000  loss: -1.0000  memory: 10.75GiB(22.62%)  tps: 5,837
[rank2]:2025-10-28 18:47:58,453 - INFO - validate step: 1000  loss: -1.0000  memory:  7.21GiB(15.18%)  tps: 5,829
[rank3]:2025-10-28 18:47:58,514 - INFO - validate step: 1000  loss:  1.1903  memory: 24.67GiB(51.93%)  tps: 5,824
[rank2]:2025-10-28 18:47:58,592 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251028_1847_stage2_step1000.svg
[rank1]:2025-10-28 18:47:58,590 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251028_1847_stage1_step1000.svg
[rank0]:2025-10-28 18:47:58,590 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251028_1847_stage0_step1000.svg
[rank3]:2025-10-28 18:47:58,710 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/pipeline_schedule/251028_1847_real_step1000_rank3.svg
[rank3]:> Batch Time: 1392.33 ms, GPU Bubble Ratio: 45.01%, 28.86%, 49.93%, 20.20%
[rank3]:2025-10-28 18:47:58,778 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251028_1847_stage3_step1000.svg
[rank3]:2025-10-28 18:48:00,007 - INFO - Avg. fwd time: 65.9266 / Avg. bwd time: 79.8342 / Avg. batch time: 1223.5677 (ms) / GPU bubble ratio: 4.70%
[rank2]:2025-10-28 18:48:00,064 - INFO - Avg. fwd time: 34.1215 / Avg. bwd time: 50.9209 / Avg. batch time: 1309.9915 (ms) / GPU bubble ratio: 48.07%
[rank1]:2025-10-28 18:48:00,144 - INFO - Avg. fwd time: 49.1300 / Avg. bwd time: 71.6232 / Avg. batch time: 1423.0718 (ms) / GPU bubble ratio: 32.12%
[rank0]:2025-10-28 18:48:00,205 - INFO - Avg. fwd time: 38.7236 / Avg. bwd time: 45.8294 / Avg. batch time: 1515.6747 (ms) / GPU bubble ratio: 55.37%
[rank3]:2025-10-28 18:48:58,225 - INFO -  step: 1020  loss:  1.1084  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,744  tflops: 20.90  mfu: 6.70%
[rank2]:2025-10-28 18:48:58,237 - INFO -  step: 1020  loss: -2.0000  grad_norm:  3.1911  memory:  7.21GiB(15.18%)  tps: 2,741  tflops: 20.87  mfu: 6.69%
[rank1]:2025-10-28 18:48:58,241 - INFO -  step: 1020  loss: -2.0000  grad_norm:  3.1911  memory: 10.75GiB(22.62%)  tps: 2,737  tflops: 20.84  mfu: 6.68%
[rank0]:2025-10-28 18:48:58,259 - INFO -  step: 1020  loss: -2.0000  grad_norm:  3.1911  memory: 14.89GiB(31.34%)  tps: 2,732  tflops: 20.81  mfu: 6.67%
[rank3]:2025-10-28 18:49:57,856 - INFO -  step: 1040  loss:  1.1266  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,748  tflops: 20.93  mfu: 6.71%
[rank2]:2025-10-28 18:49:57,868 - INFO -  step: 1040  loss: -2.0000  grad_norm:  0.3759  memory:  7.21GiB(15.18%)  tps: 2,748  tflops: 20.93  mfu: 6.71%
[rank1]:2025-10-28 18:49:57,873 - INFO -  step: 1040  loss: -2.0000  grad_norm:  0.3759  memory: 10.75GiB(22.62%)  tps: 2,748  tflops: 20.93  mfu: 6.71%
[rank0]:2025-10-28 18:49:57,883 - INFO -  step: 1040  loss: -2.0000  grad_norm:  0.3759  memory: 14.89GiB(31.34%)  tps: 2,748  tflops: 20.93  mfu: 6.71%
[rank3]:2025-10-28 18:49:59,182 - INFO - Avg. fwd time: 65.9308 / Avg. bwd time: 79.5403 / Avg. batch time: 1221.2301 (ms) / GPU bubble ratio: 4.71%
[rank2]:2025-10-28 18:49:59,239 - INFO - Avg. fwd time: 34.1371 / Avg. bwd time: 51.0925 / Avg. batch time: 1307.6865 (ms) / GPU bubble ratio: 47.86%
[rank1]:2025-10-28 18:49:59,310 - INFO - Avg. fwd time: 49.2177 / Avg. bwd time: 72.1575 / Avg. batch time: 1420.9496 (ms) / GPU bubble ratio: 31.67%
[rank0]:2025-10-28 18:49:59,372 - INFO - Avg. fwd time: 38.6872 / Avg. bwd time: 45.1589 / Avg. batch time: 1513.4412 (ms) / GPU bubble ratio: 55.68%
[rank0]:2025-10-28 18:50:24,788 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-28 18:50:57,396 - INFO -  step: 1060  loss:  1.1067  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,752  tflops: 20.96  mfu: 6.72%
[rank2]:2025-10-28 18:50:57,408 - INFO -  step: 1060  loss: -2.0000  grad_norm:  4.1872  memory:  7.21GiB(15.18%)  tps: 2,752  tflops: 20.96  mfu: 6.72%
[rank0]:2025-10-28 18:50:57,426 - INFO -  step: 1060  loss: -2.0000  grad_norm:  4.1872  memory: 14.89GiB(31.34%)  tps: 2,752  tflops: 20.96  mfu: 6.72%
[rank1]:2025-10-28 18:50:57,412 - INFO -  step: 1060  loss: -2.0000  grad_norm:  4.1872  memory: 10.75GiB(22.62%)  tps: 2,752  tflops: 20.96  mfu: 6.72%
[rank3]:2025-10-28 18:51:56,655 - INFO -  step: 1080  loss:  1.0731  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,765  tflops: 21.06  mfu: 6.75%
[rank2]:2025-10-28 18:51:56,667 - INFO -  step: 1080  loss: -2.0000  grad_norm:  0.3207  memory:  7.21GiB(15.18%)  tps: 2,765  tflops: 21.06  mfu: 6.75%
[rank1]:2025-10-28 18:51:56,670 - INFO -  step: 1080  loss: -2.0000  grad_norm:  0.3207  memory: 10.75GiB(22.62%)  tps: 2,765  tflops: 21.06  mfu: 6.75%
[rank0]:2025-10-28 18:51:56,689 - INFO -  step: 1080  loss: -2.0000  grad_norm:  0.3207  memory: 14.89GiB(31.34%)  tps: 2,765  tflops: 21.06  mfu: 6.75%
[rank3]:2025-10-28 18:51:58,013 - INFO - Avg. fwd time: 65.9229 / Avg. bwd time: 79.2605 / Avg. batch time: 1218.9127 (ms) / GPU bubble ratio: 4.71%
[rank2]:2025-10-28 18:51:58,071 - INFO - Avg. fwd time: 34.1531 / Avg. bwd time: 51.2617 / Avg. batch time: 1305.4060 (ms) / GPU bubble ratio: 47.65%
[rank1]:2025-10-28 18:51:58,143 - INFO - Avg. fwd time: 49.2807 / Avg. bwd time: 72.6595 / Avg. batch time: 1418.8026 (ms) / GPU bubble ratio: 31.24%
[rank0]:2025-10-28 18:51:58,201 - INFO - Avg. fwd time: 38.6505 / Avg. bwd time: 44.5463 / Avg. batch time: 1511.2024 (ms) / GPU bubble ratio: 55.96%
[rank0]:2025-10-28 18:52:52,969 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-28 18:52:55,906 - INFO -  step: 1100  loss:  1.1122  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,765  tflops: 21.06  mfu: 6.75%
[rank3]:2025-10-28 18:52:55,907 - INFO - ðŸ”Ž  Running validation at step 1100
[rank2]:2025-10-28 18:52:55,918 - INFO -  step: 1100  loss: -2.0000  grad_norm:  4.3494  memory:  7.21GiB(15.18%)  tps: 2,765  tflops: 21.06  mfu: 6.75%
[rank2]:2025-10-28 18:52:55,919 - INFO - ðŸ”Ž  Running validation at step 1100
[rank1]:2025-10-28 18:52:55,925 - INFO -  step: 1100  loss: -2.0000  grad_norm:  4.3494  memory: 10.75GiB(22.62%)  tps: 2,765  tflops: 21.06  mfu: 6.75%
[rank1]:2025-10-28 18:52:55,925 - INFO - ðŸ”Ž  Running validation at step 1100
[rank0]:2025-10-28 18:52:55,940 - INFO -  step: 1100  loss: -2.0000  grad_norm:  4.3494  memory: 14.89GiB(31.34%)  tps: 2,765  tflops: 21.06  mfu: 6.75%
[rank0]:2025-10-28 18:52:55,940 - INFO - ðŸ”Ž  Running validation at step 1100
[rank0]:2025-10-28 18:54:05,284 - INFO - validate step: 1100  loss: -1.0000  memory: 14.89GiB(31.34%)  tps: 5,907
[rank1]:2025-10-28 18:54:05,362 - INFO - validate step: 1100  loss: -1.0000  memory: 10.75GiB(22.62%)  tps: 5,899
[rank2]:2025-10-28 18:54:05,444 - INFO - validate step: 1100  loss: -1.0000  memory:  7.21GiB(15.18%)  tps: 5,891
[rank3]:2025-10-28 18:54:05,502 - INFO - validate step: 1100  loss:  1.1882  memory: 24.67GiB(51.93%)  tps: 5,886
[rank0]:2025-10-28 18:54:05,580 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251028_1854_stage0_step1100.svg
[rank1]:2025-10-28 18:54:05,580 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251028_1854_stage1_step1100.svg
[rank2]:2025-10-28 18:54:05,581 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251028_1854_stage2_step1100.svg
[rank3]:2025-10-28 18:54:05,699 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/pipeline_schedule/251028_1854_real_step1100_rank3.svg
[rank3]:> Batch Time: 1392.19 ms, GPU Bubble Ratio: 45.38%, 28.04%, 49.76%, 20.24%
[rank3]:2025-10-28 18:54:05,767 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251028_1854_stage3_step1100.svg
[rank2]:2025-10-28 18:55:05,332 - INFO -  step: 1120  loss: -2.0000  grad_norm:  0.4729  memory:  7.21GiB(15.18%)  tps: 2,736  tflops: 20.84  mfu: 6.68%
[rank0]:2025-10-28 18:55:05,354 - INFO -  step: 1120  loss: -2.0000  grad_norm:  0.4729  memory: 14.89GiB(31.34%)  tps: 2,727  tflops: 20.77  mfu: 6.66%
[rank3]:2025-10-28 18:55:05,320 - INFO -  step: 1120  loss:  1.1019  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,739  tflops: 20.86  mfu: 6.69%
[rank1]:2025-10-28 18:55:05,336 - INFO -  step: 1120  loss: -2.0000  grad_norm:  0.4729  memory: 10.75GiB(22.62%)  tps: 2,732  tflops: 20.81  mfu: 6.67%
[rank3]:2025-10-28 18:55:06,671 - INFO - Avg. fwd time: 65.9211 / Avg. bwd time: 79.0023 / Avg. batch time: 1216.8155 (ms) / GPU bubble ratio: 4.72%
[rank2]:2025-10-28 18:55:06,728 - INFO - Avg. fwd time: 34.1635 / Avg. bwd time: 51.4353 / Avg. batch time: 1303.3794 (ms) / GPU bubble ratio: 47.46%
[rank1]:2025-10-28 18:55:06,810 - INFO - Avg. fwd time: 49.3721 / Avg. bwd time: 73.1603 / Avg. batch time: 1416.9042 (ms) / GPU bubble ratio: 30.82%
[rank0]:2025-10-28 18:55:06,870 - INFO - Avg. fwd time: 38.6133 / Avg. bwd time: 43.9703 / Avg. batch time: 1509.2115 (ms) / GPU bubble ratio: 56.22%
[rank3]:2025-10-28 18:56:04,744 - INFO -  step: 1140  loss:  1.1014  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,757  tflops: 21.00  mfu: 6.73%
[rank1]:2025-10-28 18:56:04,759 - INFO -  step: 1140  loss: -2.0000  grad_norm:  6.2486  memory: 10.75GiB(22.62%)  tps: 2,757  tflops: 21.00  mfu: 6.73%
[rank2]:2025-10-28 18:56:04,756 - INFO -  step: 1140  loss: -2.0000  grad_norm:  6.2486  memory:  7.21GiB(15.18%)  tps: 2,757  tflops: 21.00  mfu: 6.73%
[rank0]:2025-10-28 18:56:04,771 - INFO -  step: 1140  loss: -2.0000  grad_norm:  6.2486  memory: 14.89GiB(31.34%)  tps: 2,757  tflops: 21.00  mfu: 6.73%
[rank0]:2025-10-28 18:56:31,575 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-28 18:57:04,291 - INFO -  step: 1160  loss:  1.1159  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,752  tflops: 20.96  mfu: 6.72%
[rank1]:2025-10-28 18:57:04,306 - INFO -  step: 1160  loss: -2.0000  grad_norm:  0.3852  memory: 10.75GiB(22.62%)  tps: 2,751  tflops: 20.96  mfu: 6.72%
[rank2]:2025-10-28 18:57:04,303 - INFO -  step: 1160  loss: -2.0000  grad_norm:  0.3852  memory:  7.21GiB(15.18%)  tps: 2,751  tflops: 20.96  mfu: 6.72%
[rank0]:2025-10-28 18:57:04,330 - INFO -  step: 1160  loss: -2.0000  grad_norm:  0.3852  memory: 14.89GiB(31.34%)  tps: 2,751  tflops: 20.95  mfu: 6.72%
[rank3]:2025-10-28 18:57:05,596 - INFO - Avg. fwd time: 65.9173 / Avg. bwd time: 78.7646 / Avg. batch time: 1214.8632 (ms) / GPU bubble ratio: 4.73%
[rank2]:2025-10-28 18:57:05,657 - INFO - Avg. fwd time: 34.1743 / Avg. bwd time: 51.5954 / Avg. batch time: 1301.4857 (ms) / GPU bubble ratio: 47.28%
[rank1]:2025-10-28 18:57:05,729 - INFO - Avg. fwd time: 49.4418 / Avg. bwd time: 73.6153 / Avg. batch time: 1415.1244 (ms) / GPU bubble ratio: 30.43%
[rank0]:2025-10-28 18:57:05,785 - INFO - Avg. fwd time: 38.5725 / Avg. bwd time: 43.4319 / Avg. batch time: 1507.3189 (ms) / GPU bubble ratio: 56.48%
[rank3]:2025-10-28 18:58:03,582 - INFO -  step: 1180  loss:  1.1418  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,763  tflops: 21.05  mfu: 6.75%
[rank1]:2025-10-28 18:58:03,598 - INFO -  step: 1180  loss: -2.0000  grad_norm:  1.7706  memory: 10.75GiB(22.62%)  tps: 2,763  tflops: 21.05  mfu: 6.75%
[rank2]:2025-10-28 18:58:03,593 - INFO -  step: 1180  loss: -2.0000  grad_norm:  1.7706  memory:  7.21GiB(15.18%)  tps: 2,763  tflops: 21.05  mfu: 6.75%
[rank0]:2025-10-28 18:58:03,608 - INFO -  step: 1180  loss: -2.0000  grad_norm:  1.7706  memory: 14.89GiB(31.34%)  tps: 2,764  tflops: 21.05  mfu: 6.75%
[rank0]:2025-10-28 18:59:00,056 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-28 18:59:03,032 - INFO -  step: 1200  loss:  1.0939  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,756  tflops: 20.99  mfu: 6.73%
[rank3]:2025-10-28 18:59:03,032 - INFO - ðŸ”Ž  Running validation at step 1200
[rank1]:2025-10-28 18:59:03,047 - INFO -  step: 1200  loss: -2.0000  grad_norm:  0.3307  memory: 10.75GiB(22.62%)  tps: 2,756  tflops: 20.99  mfu: 6.73%
[rank1]:2025-10-28 18:59:03,047 - INFO - ðŸ”Ž  Running validation at step 1200
[rank2]:2025-10-28 18:59:03,044 - INFO -  step: 1200  loss: -2.0000  grad_norm:  0.3307  memory:  7.21GiB(15.18%)  tps: 2,756  tflops: 20.99  mfu: 6.73%
[rank2]:2025-10-28 18:59:03,044 - INFO - ðŸ”Ž  Running validation at step 1200
[rank0]:2025-10-28 18:59:03,064 - INFO -  step: 1200  loss: -2.0000  grad_norm:  0.3307  memory: 14.89GiB(31.34%)  tps: 2,756  tflops: 20.99  mfu: 6.73%
[rank0]:2025-10-28 18:59:03,064 - INFO - ðŸ”Ž  Running validation at step 1200
[rank0]:2025-10-28 19:00:11,848 - INFO - validate step: 1200  loss: -1.0000  memory: 14.89GiB(31.34%)  tps: 5,955
[rank1]:2025-10-28 19:00:11,929 - INFO - validate step: 1200  loss: -1.0000  memory: 10.75GiB(22.62%)  tps: 5,946
[rank2]:2025-10-28 19:00:12,011 - INFO - validate step: 1200  loss: -1.0000  memory:  7.21GiB(15.18%)  tps: 5,939
[rank3]:2025-10-28 19:00:12,071 - INFO - validate step: 1200  loss:  1.1895  memory: 24.67GiB(51.93%)  tps: 5,933
[rank0]:2025-10-28 19:00:12,151 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251028_1900_stage0_step1200.svg
[rank1]:2025-10-28 19:00:12,152 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251028_1900_stage1_step1200.svg
[rank2]:2025-10-28 19:00:12,153 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251028_1900_stage2_step1200.svg
[rank3]:2025-10-28 19:00:12,270 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/pipeline_schedule/251028_1900_real_step1200_rank3.svg
[rank3]:> Batch Time: 1392.19 ms, GPU Bubble Ratio: 61.19%, 26.06%, 49.58%, 20.26%
[rank3]:2025-10-28 19:00:12,340 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251028_1900_stage3_step1200.svg
[rank3]:2025-10-28 19:00:13,548 - INFO - Avg. fwd time: 65.9105 / Avg. bwd time: 78.5414 / Avg. batch time: 1213.0093 (ms) / GPU bubble ratio: 4.73%
[rank2]:2025-10-28 19:00:13,606 - INFO - Avg. fwd time: 34.1847 / Avg. bwd time: 51.7491 / Avg. batch time: 1299.7068 (ms) / GPU bubble ratio: 47.11%
[rank1]:2025-10-28 19:00:13,683 - INFO - Avg. fwd time: 49.5117 / Avg. bwd time: 74.0485 / Avg. batch time: 1413.4729 (ms) / GPU bubble ratio: 30.07%
[rank0]:2025-10-28 19:00:13,738 - INFO - Avg. fwd time: 38.5292 / Avg. bwd time: 42.9260 / Avg. batch time: 1505.5456 (ms) / GPU bubble ratio: 56.72%
[rank1]:2025-10-28 19:01:11,590 - INFO -  step: 1220  loss: -2.0000  grad_norm:  2.1030  memory: 10.75GiB(22.62%)  tps: 2,746  tflops: 20.92  mfu: 6.70%
[rank2]:2025-10-28 19:01:11,586 - INFO -  step: 1220  loss: -2.0000  grad_norm:  2.1030  memory:  7.21GiB(15.18%)  tps: 2,750  tflops: 20.95  mfu: 6.71%
[rank0]:2025-10-28 19:01:11,606 - INFO -  step: 1220  loss: -2.0000  grad_norm:  2.1030  memory: 14.89GiB(31.34%)  tps: 2,742  tflops: 20.88  mfu: 6.69%
[rank3]:2025-10-28 19:01:11,574 - INFO -  step: 1220  loss:  1.1005  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,754  tflops: 20.97  mfu: 6.72%
[rank1]:2025-10-28 19:02:10,957 - INFO -  step: 1240  loss: -2.0000  grad_norm:  0.4829  memory: 10.75GiB(22.62%)  tps: 2,760  tflops: 21.02  mfu: 6.74%
[rank2]:2025-10-28 19:02:10,953 - INFO -  step: 1240  loss: -2.0000  grad_norm:  0.4829  memory:  7.21GiB(15.18%)  tps: 2,760  tflops: 21.02  mfu: 6.74%
[rank0]:2025-10-28 19:02:10,974 - INFO -  step: 1240  loss: -2.0000  grad_norm:  0.4829  memory: 14.89GiB(31.34%)  tps: 2,760  tflops: 21.02  mfu: 6.74%
[rank3]:2025-10-28 19:02:10,941 - INFO -  step: 1240  loss:  1.1099  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,760  tflops: 21.02  mfu: 6.74%
[rank3]:2025-10-28 19:02:12,282 - INFO - Avg. fwd time: 65.9082 / Avg. bwd time: 78.3301 / Avg. batch time: 1211.2863 (ms) / GPU bubble ratio: 4.74%
[rank2]:2025-10-28 19:02:12,340 - INFO - Avg. fwd time: 34.1904 / Avg. bwd time: 51.8761 / Avg. batch time: 1298.0055 (ms) / GPU bubble ratio: 46.95%
[rank1]:2025-10-28 19:02:12,413 - INFO - Avg. fwd time: 49.5491 / Avg. bwd time: 74.4207 / Avg. batch time: 1411.8641 (ms) / GPU bubble ratio: 29.76%
[rank0]:2025-10-28 19:02:12,472 - INFO - Avg. fwd time: 38.4981 / Avg. bwd time: 42.4571 / Avg. batch time: 1503.8340 (ms) / GPU bubble ratio: 56.93%
[rank0]:2025-10-28 19:02:37,823 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-28 19:03:10,496 - INFO -  step: 1260  loss:  1.0908  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,751  tflops: 20.95  mfu: 6.72%
[rank1]:2025-10-28 19:03:10,512 - INFO -  step: 1260  loss: -2.0000  grad_norm:  0.9676  memory: 10.75GiB(22.62%)  tps: 2,751  tflops: 20.95  mfu: 6.72%
[rank2]:2025-10-28 19:03:10,508 - INFO -  step: 1260  loss: -2.0000  grad_norm:  0.9676  memory:  7.21GiB(15.18%)  tps: 2,751  tflops: 20.95  mfu: 6.72%
[rank0]:2025-10-28 19:03:10,523 - INFO -  step: 1260  loss: -2.0000  grad_norm:  0.9676  memory: 14.89GiB(31.34%)  tps: 2,751  tflops: 20.95  mfu: 6.72%
[rank3]:2025-10-28 19:04:10,186 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/pipeline_schedule_adjustment/251028_1904_rank3_trend_line.svg
[rank1]:2025-10-28 19:04:10,210 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/pipeline_schedule_adjustment/251028_1904_rank1_trend_line.svg
[rank2]:2025-10-28 19:04:10,200 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/pipeline_schedule_adjustment/251028_1904_rank2_trend_line.svg
[rank2]:2025-10-28 19:04:10,259 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-28 19:04:10,261 - INFO -  step: 1280  loss: -2.0000  grad_norm:  0.3391  memory:  7.21GiB(15.18%)  tps: 2,742  tflops: 20.88  mfu: 6.69%
[rank0]:2025-10-28 19:04:10,251 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/pipeline_schedule_adjustment/251028_1904_rank0_trend_line.svg
[rank0]:2025-10-28 19:04:10,258 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank0]:2025-10-28 19:04:10,260 - INFO -  step: 1280  loss: -2.0000  grad_norm:  0.3391  memory: 14.89GiB(31.34%)  tps: 2,743  tflops: 20.89  mfu: 6.70%
[rank1]:2025-10-28 19:04:10,259 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-10-28 19:04:10,261 - INFO -  step: 1280  loss: -2.0000  grad_norm:  0.3391  memory: 10.75GiB(22.62%)  tps: 2,742  tflops: 20.88  mfu: 6.69%
[rank3]:2025-10-28 19:04:10,458 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/pipeline_schedule/251028_1904_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 1368.55 ms, GPU Bubble Ratio: 53.29%, 28.07%, 50.24%, 19.05%
[rank3]:2025-10-28 19:04:10,459 - INFO - 	> Batch Time: 1368.55 ms (Average Freeze Ratio: 0.31)
[rank3]:2025-10-28 19:04:10,459 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-28 19:04:10,464 - INFO -  step: 1280  loss:  1.0905  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,732  tflops: 20.81  mfu: 6.67%
[rank3]:2025-10-28 19:04:11,653 - INFO - Avg. fwd time: 65.9082 / Avg. bwd time: 78.1340 / Avg. batch time: 1209.7109 (ms) / GPU bubble ratio: 4.74%
[rank2]:2025-10-28 19:04:11,708 - INFO - Avg. fwd time: 34.1987 / Avg. bwd time: 52.0032 / Avg. batch time: 1296.5142 (ms) / GPU bubble ratio: 46.81%
[rank1]:2025-10-28 19:04:11,776 - INFO - Avg. fwd time: 49.5904 / Avg. bwd time: 74.7961 / Avg. batch time: 1410.4751 (ms) / GPU bubble ratio: 29.45%
[rank0]:2025-10-28 19:04:11,843 - INFO - Avg. fwd time: 38.4610 / Avg. bwd time: 42.0149 / Avg. batch time: 1502.3475 (ms) / GPU bubble ratio: 57.15%
[rank0]:2025-10-28 19:05:06,890 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-28 19:05:09,838 - INFO -  step: 1300  loss: -2.0000  grad_norm:  2.1196  memory:  7.21GiB(15.18%)  tps: 2,750  tflops: 20.95  mfu: 6.71%
[rank2]:2025-10-28 19:05:09,838 - INFO - ðŸ”Ž  Running validation at step 1300
[rank3]:2025-10-28 19:05:09,826 - INFO -  step: 1300  loss:  1.1062  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,760  tflops: 21.02  mfu: 6.74%
[rank3]:2025-10-28 19:05:09,827 - INFO - ðŸ”Ž  Running validation at step 1300
[rank1]:2025-10-28 19:05:09,842 - INFO -  step: 1300  loss: -2.0000  grad_norm:  2.1196  memory: 10.75GiB(22.62%)  tps: 2,750  tflops: 20.94  mfu: 6.71%
[rank1]:2025-10-28 19:05:09,843 - INFO - ðŸ”Ž  Running validation at step 1300
[rank0]:2025-10-28 19:05:09,856 - INFO -  step: 1300  loss: -2.0000  grad_norm:  2.1196  memory: 14.89GiB(31.34%)  tps: 2,749  tflops: 20.94  mfu: 6.71%
[rank0]:2025-10-28 19:05:09,856 - INFO - ðŸ”Ž  Running validation at step 1300
[rank0]:2025-10-28 19:06:18,865 - INFO - validate step: 1300  loss: -1.0000  memory: 14.89GiB(31.34%)  tps: 5,936
[rank1]:2025-10-28 19:06:18,946 - INFO - validate step: 1300  loss: -1.0000  memory: 10.75GiB(22.62%)  tps: 5,927
[rank2]:2025-10-28 19:06:19,032 - INFO - validate step: 1300  loss: -1.0000  memory:  7.21GiB(15.18%)  tps: 5,920
[rank3]:2025-10-28 19:06:19,090 - INFO - validate step: 1300  loss:  1.1856  memory: 24.67GiB(51.93%)  tps: 5,914
[rank1]:2025-10-28 19:06:19,171 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251028_1906_stage1_step1300.svg
[rank0]:2025-10-28 19:06:19,170 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251028_1906_stage0_step1300.svg
[rank2]:2025-10-28 19:06:19,171 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251028_1906_stage2_step1300.svg
[rank3]:2025-10-28 19:06:19,282 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/pipeline_schedule/251028_1906_real_step1300_rank3.svg
[rank3]:> Batch Time: 1391.66 ms, GPU Bubble Ratio: 61.28%, 24.72%, 49.44%, 20.24%
[rank3]:2025-10-28 19:06:19,352 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251028_1906_stage3_step1300.svg
[rank1]:2025-10-28 19:07:18,862 - INFO -  step: 1320  loss: -2.0000  grad_norm:  0.6189  memory: 10.75GiB(22.62%)  tps: 2,735  tflops: 20.83  mfu: 6.68%
[rank0]:2025-10-28 19:07:18,885 - INFO -  step: 1320  loss: -2.0000  grad_norm:  0.6189  memory: 14.89GiB(31.34%)  tps: 2,730  tflops: 20.79  mfu: 6.66%
[rank3]:2025-10-28 19:07:18,847 - INFO -  step: 1320  loss:  1.1084  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,742  tflops: 20.88  mfu: 6.69%
[rank2]:2025-10-28 19:07:18,858 - INFO -  step: 1320  loss: -2.0000  grad_norm:  0.6189  memory:  7.21GiB(15.18%)  tps: 2,739  tflops: 20.86  mfu: 6.69%
[rank3]:2025-10-28 19:07:20,191 - INFO - Avg. fwd time: 65.9197 / Avg. bwd time: 77.9570 / Avg. batch time: 1208.3751 (ms) / GPU bubble ratio: 4.75%
[rank2]:2025-10-28 19:07:20,246 - INFO - Avg. fwd time: 34.2047 / Avg. bwd time: 51.8631 / Avg. batch time: 1295.1141 (ms) / GPU bubble ratio: 46.84%
[rank1]:2025-10-28 19:07:20,315 - INFO - Avg. fwd time: 49.5793 / Avg. bwd time: 74.3979 / Avg. batch time: 1409.0412 (ms) / GPU bubble ratio: 29.61%
[rank0]:2025-10-28 19:07:20,379 - INFO - Avg. fwd time: 38.4987 / Avg. bwd time: 42.5546 / Avg. batch time: 1501.0300 (ms) / GPU bubble ratio: 56.80%
[rank1]:2025-10-28 19:08:18,348 - INFO -  step: 1340  loss: -2.0000  grad_norm:  1.2802  memory: 10.75GiB(22.62%)  tps: 2,754  tflops: 20.98  mfu: 6.72%
[rank3]:2025-10-28 19:08:18,333 - INFO -  step: 1340  loss:  1.1264  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,754  tflops: 20.98  mfu: 6.72%
[rank0]:2025-10-28 19:08:18,367 - INFO -  step: 1340  loss: -2.0000  grad_norm:  1.2802  memory: 14.89GiB(31.34%)  tps: 2,754  tflops: 20.98  mfu: 6.72%
[rank2]:2025-10-28 19:08:18,344 - INFO -  step: 1340  loss: -2.0000  grad_norm:  1.2802  memory:  7.21GiB(15.18%)  tps: 2,754  tflops: 20.98  mfu: 6.72%
[rank0]:2025-10-28 19:08:45,102 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-28 19:09:17,742 - INFO -  step: 1360  loss:  1.1080  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,758  tflops: 21.00  mfu: 6.73%
[rank0]:2025-10-28 19:09:17,769 - INFO -  step: 1360  loss: -2.0000  grad_norm:  0.6243  memory: 14.89GiB(31.34%)  tps: 2,758  tflops: 21.01  mfu: 6.73%
[rank2]:2025-10-28 19:09:17,754 - INFO -  step: 1360  loss: -2.0000  grad_norm:  0.6243  memory:  7.21GiB(15.18%)  tps: 2,758  tflops: 21.00  mfu: 6.73%
[rank1]:2025-10-28 19:09:17,762 - INFO -  step: 1360  loss: -2.0000  grad_norm:  0.6243  memory: 10.75GiB(22.62%)  tps: 2,758  tflops: 21.00  mfu: 6.73%
[rank3]:2025-10-28 19:09:19,094 - INFO - Avg. fwd time: 65.9197 / Avg. bwd time: 77.7888 / Avg. batch time: 1207.0162 (ms) / GPU bubble ratio: 4.75%
[rank2]:2025-10-28 19:09:19,153 - INFO - Avg. fwd time: 34.2086 / Avg. bwd time: 51.7376 / Avg. batch time: 1293.6879 (ms) / GPU bubble ratio: 46.85%
[rank1]:2025-10-28 19:09:19,231 - INFO - Avg. fwd time: 49.5402 / Avg. bwd time: 74.0203 / Avg. batch time: 1407.5411 (ms) / GPU bubble ratio: 29.77%
[rank0]:2025-10-28 19:09:19,296 - INFO - Avg. fwd time: 38.5360 / Avg. bwd time: 43.0706 / Avg. batch time: 1499.6729 (ms) / GPU bubble ratio: 56.47%
[rank2]:2025-10-28 19:10:16,971 - INFO -  step: 1380  loss: -2.0000  grad_norm:  1.2106  memory:  7.21GiB(15.18%)  tps: 2,767  tflops: 21.07  mfu: 6.75%
[rank1]:2025-10-28 19:10:16,976 - INFO -  step: 1380  loss: -2.0000  grad_norm:  1.2106  memory: 10.75GiB(22.62%)  tps: 2,767  tflops: 21.07  mfu: 6.75%
[rank3]:2025-10-28 19:10:16,960 - INFO -  step: 1380  loss:  1.0968  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,767  tflops: 21.07  mfu: 6.75%
[rank0]:2025-10-28 19:10:16,993 - INFO -  step: 1380  loss: -2.0000  grad_norm:  1.2106  memory: 14.89GiB(31.34%)  tps: 2,766  tflops: 21.07  mfu: 6.75%
[rank0]:2025-10-28 19:11:13,120 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-28 19:11:16,132 - INFO -  step: 1400  loss: -2.0000  grad_norm:  0.6151  memory: 10.75GiB(22.62%)  tps: 2,770  tflops: 21.09  mfu: 6.76%
[rank1]:2025-10-28 19:11:16,132 - INFO - ðŸ”Ž  Running validation at step 1400
[rank3]:2025-10-28 19:11:16,117 - INFO -  step: 1400  loss:  1.1138  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,770  tflops: 21.09  mfu: 6.76%
[rank3]:2025-10-28 19:11:16,117 - INFO - ðŸ”Ž  Running validation at step 1400
[rank2]:2025-10-28 19:11:16,128 - INFO -  step: 1400  loss: -2.0000  grad_norm:  0.6151  memory:  7.21GiB(15.18%)  tps: 2,770  tflops: 21.09  mfu: 6.76%
[rank2]:2025-10-28 19:11:16,129 - INFO - ðŸ”Ž  Running validation at step 1400
[rank0]:2025-10-28 19:11:16,149 - INFO -  step: 1400  loss: -2.0000  grad_norm:  0.6151  memory: 14.89GiB(31.34%)  tps: 2,770  tflops: 21.09  mfu: 6.76%
[rank0]:2025-10-28 19:11:16,149 - INFO - ðŸ”Ž  Running validation at step 1400
[rank0]:2025-10-28 19:12:25,168 - INFO - validate step: 1400  loss: -1.0000  memory: 14.89GiB(31.34%)  tps: 5,935
[rank1]:2025-10-28 19:12:25,249 - INFO - validate step: 1400  loss: -1.0000  memory: 10.75GiB(22.62%)  tps: 5,926
[rank2]:2025-10-28 19:12:25,331 - INFO - validate step: 1400  loss: -1.0000  memory:  7.21GiB(15.18%)  tps: 5,919
[rank1]:2025-10-28 19:12:25,473 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251028_1912_stage1_step1400.svg
[rank3]:2025-10-28 19:12:25,390 - INFO - validate step: 1400  loss:  1.1873  memory: 24.67GiB(51.93%)  tps: 5,913
[rank2]:2025-10-28 19:12:25,478 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251028_1912_stage2_step1400.svg
[rank0]:2025-10-28 19:12:25,473 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251028_1912_stage0_step1400.svg
[rank3]:2025-10-28 19:12:25,583 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/pipeline_schedule/251028_1912_real_step1400_rank3.svg
[rank3]:> Batch Time: 1392.11 ms, GPU Bubble Ratio: 61.13%, 26.73%, 49.59%, 20.27%
[rank3]:2025-10-28 19:12:25,655 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251028_1912_stage3_step1400.svg
[rank3]:2025-10-28 19:12:26,854 - INFO - Avg. fwd time: 65.9113 / Avg. bwd time: 77.6164 / Avg. batch time: 1205.5582 (ms) / GPU bubble ratio: 4.76%
[rank2]:2025-10-28 19:12:26,912 - INFO - Avg. fwd time: 34.2107 / Avg. bwd time: 51.6139 / Avg. batch time: 1292.1853 (ms) / GPU bubble ratio: 46.87%
[rank1]:2025-10-28 19:12:26,986 - INFO - Avg. fwd time: 49.4916 / Avg. bwd time: 73.6525 / Avg. batch time: 1405.9452 (ms) / GPU bubble ratio: 29.93%
[rank0]:2025-10-28 19:12:27,049 - INFO - Avg. fwd time: 38.5720 / Avg. bwd time: 43.5574 / Avg. batch time: 1498.2126 (ms) / GPU bubble ratio: 56.15%
[rank1]:2025-10-28 19:13:25,084 - INFO -  step: 1420  loss: -2.0000  grad_norm:  0.5141  memory: 10.75GiB(22.62%)  tps: 2,738  tflops: 20.85  mfu: 6.68%
[rank3]:2025-10-28 19:13:25,067 - INFO -  step: 1420  loss:  1.1146  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,746  tflops: 20.91  mfu: 6.70%
[rank0]:2025-10-28 19:13:25,100 - INFO -  step: 1420  loss: -2.0000  grad_norm:  0.5141  memory: 14.89GiB(31.34%)  tps: 2,734  tflops: 20.82  mfu: 6.67%
[rank2]:2025-10-28 19:13:25,079 - INFO -  step: 1420  loss: -2.0000  grad_norm:  0.5141  memory:  7.21GiB(15.18%)  tps: 2,742  tflops: 20.89  mfu: 6.69%
[rank3]:2025-10-28 19:14:24,670 - INFO -  step: 1440  loss:  1.1168  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,749  tflops: 20.94  mfu: 6.71%
[rank1]:2025-10-28 19:14:24,685 - INFO -  step: 1440  loss: -2.0000  grad_norm:  0.6463  memory: 10.75GiB(22.62%)  tps: 2,749  tflops: 20.94  mfu: 6.71%
[rank0]:2025-10-28 19:14:24,705 - INFO -  step: 1440  loss: -2.0000  grad_norm:  0.6463  memory: 14.89GiB(31.34%)  tps: 2,749  tflops: 20.94  mfu: 6.71%
[rank2]:2025-10-28 19:14:24,682 - INFO -  step: 1440  loss: -2.0000  grad_norm:  0.6463  memory:  7.21GiB(15.18%)  tps: 2,749  tflops: 20.94  mfu: 6.71%
[rank3]:2025-10-28 19:14:26,015 - INFO - Avg. fwd time: 65.9208 / Avg. bwd time: 77.4676 / Avg. batch time: 1204.4325 (ms) / GPU bubble ratio: 4.76%
[rank2]:2025-10-28 19:14:26,075 - INFO - Avg. fwd time: 34.2135 / Avg. bwd time: 51.5073 / Avg. batch time: 1291.0035 (ms) / GPU bubble ratio: 46.88%
[rank1]:2025-10-28 19:14:26,152 - INFO - Avg. fwd time: 49.4514 / Avg. bwd time: 73.3163 / Avg. batch time: 1404.6939 (ms) / GPU bubble ratio: 30.08%
[rank0]:2025-10-28 19:14:26,216 - INFO - Avg. fwd time: 38.6131 / Avg. bwd time: 44.0269 / Avg. batch time: 1497.0907 (ms) / GPU bubble ratio: 55.84%
[rank0]:2025-10-28 19:14:51,511 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-28 19:15:24,212 - INFO -  step: 1460  loss: -2.0000  grad_norm:  0.5142  memory:  7.21GiB(15.18%)  tps: 2,752  tflops: 20.96  mfu: 6.72%
[rank3]:2025-10-28 19:15:24,200 - INFO -  step: 1460  loss:  1.1056  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,752  tflops: 20.96  mfu: 6.72%
[rank1]:2025-10-28 19:15:24,215 - INFO -  step: 1460  loss: -2.0000  grad_norm:  0.5142  memory: 10.75GiB(22.62%)  tps: 2,752  tflops: 20.96  mfu: 6.72%
[rank0]:2025-10-28 19:15:24,233 - INFO -  step: 1460  loss: -2.0000  grad_norm:  0.5142  memory: 14.89GiB(31.34%)  tps: 2,752  tflops: 20.96  mfu: 6.72%
[rank2]:2025-10-28 19:16:23,531 - INFO -  step: 1480  loss: -2.0000  grad_norm:  0.6181  memory:  7.21GiB(15.18%)  tps: 2,762  tflops: 21.04  mfu: 6.74%
[rank3]:2025-10-28 19:16:23,519 - INFO -  step: 1480  loss:  1.1007  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,762  tflops: 21.04  mfu: 6.74%
[rank1]:2025-10-28 19:16:23,536 - INFO -  step: 1480  loss: -2.0000  grad_norm:  0.6181  memory: 10.75GiB(22.62%)  tps: 2,762  tflops: 21.04  mfu: 6.74%
[rank0]:2025-10-28 19:16:23,551 - INFO -  step: 1480  loss: -2.0000  grad_norm:  0.6181  memory: 14.89GiB(31.34%)  tps: 2,762  tflops: 21.04  mfu: 6.74%
[rank2]:2025-10-28 19:16:24,931 - INFO - Avg. fwd time: 34.2203 / Avg. bwd time: 51.4026 / Avg. batch time: 1289.7852 (ms) / GPU bubble ratio: 46.89%
[rank3]:2025-10-28 19:16:24,875 - INFO - Avg. fwd time: 65.9217 / Avg. bwd time: 77.3224 / Avg. batch time: 1203.2692 (ms) / GPU bubble ratio: 4.76%
[rank1]:2025-10-28 19:16:24,999 - INFO - Avg. fwd time: 49.4267 / Avg. bwd time: 72.9964 / Avg. batch time: 1403.4170 (ms) / GPU bubble ratio: 30.21%
[rank0]:2025-10-28 19:16:25,067 - INFO - Avg. fwd time: 38.6507 / Avg. bwd time: 44.4620 / Avg. batch time: 1495.9283 (ms) / GPU bubble ratio: 55.55%
[rank0]:2025-10-28 19:17:19,951 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-28 19:17:22,919 - INFO -  step: 1500  loss:  1.1090  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,758  tflops: 21.01  mfu: 6.73%
[rank3]:2025-10-28 19:17:22,919 - INFO - ðŸ”Ž  Running validation at step 1500
[rank1]:2025-10-28 19:17:22,935 - INFO -  step: 1500  loss: -2.0000  grad_norm:  0.4846  memory: 10.75GiB(22.62%)  tps: 2,758  tflops: 21.01  mfu: 6.73%
[rank1]:2025-10-28 19:17:22,935 - INFO - ðŸ”Ž  Running validation at step 1500
[rank0]:2025-10-28 19:17:22,949 - INFO -  step: 1500  loss: -2.0000  grad_norm:  0.4846  memory: 14.89GiB(31.34%)  tps: 2,758  tflops: 21.01  mfu: 6.73%
[rank0]:2025-10-28 19:17:22,949 - INFO - ðŸ”Ž  Running validation at step 1500
[rank2]:2025-10-28 19:17:22,931 - INFO -  step: 1500  loss: -2.0000  grad_norm:  0.4846  memory:  7.21GiB(15.18%)  tps: 2,758  tflops: 21.01  mfu: 6.73%
[rank2]:2025-10-28 19:17:22,931 - INFO - ðŸ”Ž  Running validation at step 1500
[rank1]:2025-10-28 19:18:32,564 - INFO - validate step: 1500  loss: -1.0000  memory: 10.75GiB(22.62%)  tps: 5,883
[rank0]:2025-10-28 19:18:32,483 - INFO - validate step: 1500  loss: -1.0000  memory: 14.89GiB(31.34%)  tps: 5,891
[rank2]:2025-10-28 19:18:32,644 - INFO - validate step: 1500  loss: -1.0000  memory:  7.21GiB(15.18%)  tps: 5,875
[rank3]:2025-10-28 19:18:32,705 - INFO - validate step: 1500  loss:  1.1894  memory: 24.67GiB(51.93%)  tps: 5,869
[rank2]:2025-10-28 19:18:32,790 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251028_1918_stage2_step1500.svg
[rank1]:2025-10-28 19:18:32,789 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251028_1918_stage1_step1500.svg
[rank0]:2025-10-28 19:18:32,789 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251028_1918_stage0_step1500.svg
[rank3]:2025-10-28 19:18:32,900 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/pipeline_schedule/251028_1918_real_step1500_rank3.svg
[rank3]:> Batch Time: 1391.86 ms, GPU Bubble Ratio: 45.26%, 27.98%, 49.68%, 20.27%
[rank3]:2025-10-28 19:18:32,974 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251028_1918_stage3_step1500.svg
[rank2]:2025-10-28 19:19:32,251 - INFO -  step: 1520  loss: -2.0000  grad_norm:  0.6137  memory:  7.21GiB(15.18%)  tps: 2,749  tflops: 20.93  mfu: 6.71%
[rank3]:2025-10-28 19:19:32,239 - INFO -  step: 1520  loss:  1.1101  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,752  tflops: 20.96  mfu: 6.72%
[rank1]:2025-10-28 19:19:32,255 - INFO -  step: 1520  loss: -2.0000  grad_norm:  0.6137  memory: 10.75GiB(22.62%)  tps: 2,745  tflops: 20.90  mfu: 6.70%
[rank0]:2025-10-28 19:19:32,265 - INFO -  step: 1520  loss: -2.0000  grad_norm:  0.6137  memory: 14.89GiB(31.34%)  tps: 2,741  tflops: 20.87  mfu: 6.69%
[rank3]:2025-10-28 19:19:33,576 - INFO - Avg. fwd time: 65.9228 / Avg. bwd time: 77.1842 / Avg. batch time: 1202.1629 (ms) / GPU bubble ratio: 4.77%
[rank2]:2025-10-28 19:19:33,637 - INFO - Avg. fwd time: 34.2221 / Avg. bwd time: 51.3012 / Avg. batch time: 1288.6604 (ms) / GPU bubble ratio: 46.91%
[rank1]:2025-10-28 19:19:33,713 - INFO - Avg. fwd time: 49.3874 / Avg. bwd time: 72.6894 / Avg. batch time: 1402.2385 (ms) / GPU bubble ratio: 30.35%
[rank0]:2025-10-28 19:19:33,777 - INFO - Avg. fwd time: 38.6808 / Avg. bwd time: 44.8700 / Avg. batch time: 1494.8381 (ms) / GPU bubble ratio: 55.29%
[rank2]:2025-10-28 19:20:31,522 - INFO -  step: 1540  loss: -2.0000  grad_norm:  0.4780  memory:  7.21GiB(15.18%)  tps: 2,764  tflops: 21.05  mfu: 6.75%
[rank3]:2025-10-28 19:20:31,511 - INFO -  step: 1540  loss:  1.1051  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,764  tflops: 21.05  mfu: 6.75%
[rank1]:2025-10-28 19:20:31,527 - INFO -  step: 1540  loss: -2.0000  grad_norm:  0.4780  memory: 10.75GiB(22.62%)  tps: 2,764  tflops: 21.05  mfu: 6.75%
[rank0]:2025-10-28 19:20:31,543 - INFO -  step: 1540  loss: -2.0000  grad_norm:  0.4780  memory: 14.89GiB(31.34%)  tps: 2,764  tflops: 21.05  mfu: 6.75%
[rank0]:2025-10-28 19:20:58,187 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-28 19:21:30,903 - INFO -  step: 1560  loss: -2.0000  grad_norm:  0.6067  memory:  7.21GiB(15.18%)  tps: 2,759  tflops: 21.01  mfu: 6.74%
[rank3]:2025-10-28 19:21:30,892 - INFO -  step: 1560  loss:  1.0840  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,759  tflops: 21.01  mfu: 6.74%
[rank1]:2025-10-28 19:21:30,907 - INFO -  step: 1560  loss: -2.0000  grad_norm:  0.6067  memory: 10.75GiB(22.62%)  tps: 2,759  tflops: 21.01  mfu: 6.74%
[rank0]:2025-10-28 19:21:30,929 - INFO -  step: 1560  loss: -2.0000  grad_norm:  0.6067  memory: 14.89GiB(31.34%)  tps: 2,759  tflops: 21.01  mfu: 6.73%
[rank3]:2025-10-28 19:21:32,262 - INFO - Avg. fwd time: 65.9206 / Avg. bwd time: 77.0492 / Avg. batch time: 1201.0529 (ms) / GPU bubble ratio: 4.77%
[rank2]:2025-10-28 19:21:32,325 - INFO - Avg. fwd time: 34.2254 / Avg. bwd time: 51.2051 / Avg. batch time: 1287.5038 (ms) / GPU bubble ratio: 46.92%
[rank1]:2025-10-28 19:21:32,399 - INFO - Avg. fwd time: 49.3507 / Avg. bwd time: 72.4059 / Avg. batch time: 1401.0422 (ms) / GPU bubble ratio: 30.48%
[rank0]:2025-10-28 19:21:32,463 - INFO - Avg. fwd time: 38.7081 / Avg. bwd time: 45.2614 / Avg. batch time: 1493.7364 (ms) / GPU bubble ratio: 55.03%
[rank2]:2025-10-28 19:22:30,348 - INFO -  step: 1580  loss: -2.0000  grad_norm:  0.4777  memory:  7.21GiB(15.18%)  tps: 2,756  tflops: 20.99  mfu: 6.73%
[rank3]:2025-10-28 19:22:30,337 - INFO -  step: 1580  loss:  1.1177  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,756  tflops: 20.99  mfu: 6.73%
[rank1]:2025-10-28 19:22:30,353 - INFO -  step: 1580  loss: -2.0000  grad_norm:  0.4777  memory: 10.75GiB(22.62%)  tps: 2,756  tflops: 20.99  mfu: 6.73%
[rank0]:2025-10-28 19:22:30,369 - INFO -  step: 1580  loss: -2.0000  grad_norm:  0.4777  memory: 14.89GiB(31.34%)  tps: 2,756  tflops: 20.99  mfu: 6.73%
[rank0]:2025-10-28 19:23:26,656 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-28 19:23:29,672 - INFO -  step: 1600  loss:  1.0868  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,761  tflops: 21.03  mfu: 6.74%
[rank3]:2025-10-28 19:23:29,673 - INFO -  final step: 1600  loss:  1.0868  grad_norm:  0.0000  tps: 2,707  tflops: 20.62  mfu: 6.52%
[rank3]:2025-10-28 19:23:29,673 - INFO - ðŸ”Ž  Running validation at step 1600
[rank2]:2025-10-28 19:23:29,684 - INFO -  step: 1600  loss: -2.0000  grad_norm:  0.6327  memory:  7.21GiB(15.18%)  tps: 2,761  tflops: 21.03  mfu: 6.74%
[rank2]:2025-10-28 19:23:29,684 - INFO -  final step: 1600  loss: -2.0000  grad_norm:  0.6327  tps: 2,705  tflops: 20.60  mfu: 6.51%
[rank2]:2025-10-28 19:23:29,684 - INFO - ðŸ”Ž  Running validation at step 1600
[rank1]:2025-10-28 19:23:29,696 - INFO -  step: 1600  loss: -2.0000  grad_norm:  0.6327  memory: 10.75GiB(22.62%)  tps: 2,761  tflops: 21.03  mfu: 6.74%
[rank1]:2025-10-28 19:23:29,696 - INFO -  final step: 1600  loss: -2.0000  grad_norm:  0.6327  tps: 2,705  tflops: 20.60  mfu: 6.51%
[rank1]:2025-10-28 19:23:29,696 - INFO - ðŸ”Ž  Running validation at step 1600
[rank0]:2025-10-28 19:23:29,700 - INFO -  step: 1600  loss: -2.0000  grad_norm:  0.6327  memory: 14.89GiB(31.34%)  tps: 2,761  tflops: 21.03  mfu: 6.74%
[rank0]:2025-10-28 19:23:29,700 - INFO -  final step: 1600  loss: -2.0000  grad_norm:  0.6327  tps: 2,704  tflops: 20.60  mfu: 6.51%
[rank0]:2025-10-28 19:23:29,700 - INFO - ðŸ”Ž  Running validation at step 1600
[rank0]:2025-10-28 19:24:39,030 - INFO - validate step: 1600  loss: -1.0000  memory: 14.89GiB(31.34%)  tps: 5,908
[rank0]:2025-10-28 19:24:39,030 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-28 19:24:39,033 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1600.
[rank1]:2025-10-28 19:24:39,115 - INFO - validate step: 1600  loss: -1.0000  memory: 10.75GiB(22.62%)  tps: 5,900
[rank1]:2025-10-28 19:24:39,116 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-28 19:24:39,118 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1600.
[rank2]:2025-10-28 19:24:39,195 - INFO - validate step: 1600  loss: -1.0000  memory:  7.21GiB(15.18%)  tps: 5,893
[rank2]:2025-10-28 19:24:39,196 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-28 19:24:39,197 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1600.
[rank3]:2025-10-28 19:24:39,256 - INFO - validate step: 1600  loss:  1.1879  memory: 24.67GiB(51.93%)  tps: 5,887
[rank3]:2025-10-28 19:24:39,257 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-28 19:24:39,259 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1600.
[rank0]:2025-10-28 19:24:41,935 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank1]:2025-10-28 19:24:42,024 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251028_1924_stage1_final1600.svg
[rank2]:2025-10-28 19:24:42,028 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251028_1924_stage2_final1600.svg
[rank0]:2025-10-28 19:24:42,024 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251028_1924_stage0_final1600.svg
[rank3]:2025-10-28 19:24:42,141 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/pipeline_schedule/251028_1924_real_final1600_rank3.svg
[rank3]:> Batch Time: 1391.58 ms, GPU Bubble Ratio: 44.99%, 28.44%, 49.75%, 20.26%
[rank1]:2025-10-28 19:24:42,227 - INFO - Elementwise Histogram is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/frozen_params_histogram/251028_1924_rank1_stage1.svg
[rank1]:	> Counts Sum: 998550, Total Sum: 1076400 (92.77%), Ratio(%) per element: [92.76, 92.76, 92.76, 92.76, 92.76, 92.76, 92.76, 92.76, 92.76, 92.76, 92.76, 92.76, 92.76, 92.76, 92.76, 92.76, 92.76, 92.76, 92.76, 92.76, 92.76, 92.76, 92.76, 92.76, 92.76, 92.76, 92.76, 92.76, 92.76, 92.76, 92.76, 92.76, 92.76, 92.76, 92.76, 92.76, 92.76, 92.76, 92.76, 92.76, 92.76, 92.76, 92.76, 92.76, 92.76]
[rank1]:2025-10-28 19:24:42,228 - INFO - Destroying the purge thread.
[rank2]:2025-10-28 19:24:42,253 - INFO - Elementwise Histogram is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/frozen_params_histogram/251028_1924_rank2_stage2.svg
[rank2]:	> Counts Sum: 798840, Total Sum: 861120 (92.77%), Ratio(%) per element: [92.76, 92.76, 92.76, 92.76, 92.76, 92.76, 92.76, 92.76, 92.76, 92.76, 92.76, 92.76, 92.76, 92.76, 92.76, 92.76, 92.76, 92.76, 92.76, 92.76, 92.76, 92.76, 92.76, 92.76, 92.76, 92.76, 92.76, 92.76, 92.76, 92.76, 92.76, 92.76, 92.76, 92.76, 92.76, 92.76]
[rank2]:2025-10-28 19:24:42,253 - INFO - Destroying the purge thread.
[rank0]:2025-10-28 19:24:42,242 - INFO - Elementwise Histogram is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/frozen_params_histogram/251028_1924_rank0_stage0.svg
[rank0]:	> Counts Sum: 826950, Total Sum: 885040 (93.44%), Ratio(%) per element: [93.43, 93.43, 93.43, 93.43, 93.43, 93.43, 93.43, 93.43, 93.43, 93.43, 93.43, 93.43, 93.43, 93.43, 93.43, 93.43, 93.43, 93.43, 93.43, 93.43, 93.43, 93.43, 93.43, 93.43, 93.43, 93.43, 93.43, 93.43, 93.43, 93.43, 93.43, 93.43, 93.43, 93.43, 93.43, 93.43, 93.43]
[rank0]:2025-10-28 19:24:42,242 - INFO - Sleeping 2 seconds for other ranks to complete
[rank3]:2025-10-28 19:24:42,355 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/pipeline_schedule/251028_1924_thry_final1600_rank3.svg
[rank3]:> Batch Time: 1562.33 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:2025-10-28 19:24:42,437 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251028_1924_stage3_final1600.svg
[rank3]:2025-10-28 19:24:42,619 - INFO - Elementwise Histogram is saved as: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1/frozen_params_histogram/251028_1924_rank3_stage3.svg
[rank3]:	> Counts Sum: 9440, Total Sum: 693680 (1.36%), Ratio(%) per element: [1.33, 1.33, 1.46, 1.37, 1.33, 1.33, 1.33, 1.37, 1.33, 1.37, 1.33, 1.33, 1.42, 1.46, 1.33, 1.33, 1.33, 1.33, 1.37, 1.33, 1.37, 1.33, 1.33, 1.33, 1.37, 1.37, 1.33, 1.33, 1.37]
[rank3]:2025-10-28 19:24:42,620 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank1]:2025-10-28 19:24:42,682 - INFO - Process group destroyed
[rank2]:2025-10-28 19:24:42,686 - INFO - Process group destroyed
[rank3]:wandb: uploading history steps 80-80, summary, console lines 446-456
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–†â–‡â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–…â–„â–â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–…â–ˆâ–…â–‚â–â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 3.02624
[rank3]:wandb:               final/avg_loss 1.08683
[rank3]:wandb:             final/avg_mfu(%) 6.51787
[rank3]:wandb:             final/avg_tflops 20.61698
[rank3]:wandb:    final/avg_throughput(tps) 2706.98531
[rank3]:wandb:              final/grad_norm 0
[rank3]:wandb:               final/max_loss 1.08683
[rank3]:wandb:                    grad_norm 0
[rank3]:wandb: loss_metrics/global_avg_loss 1.08683
[rank3]:wandb: loss_metrics/global_max_loss 1.08683
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1028_1F1B_fullrand7_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/px8xu5d2
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data3/shcho/torchtitan/tb/1028_1F1B_fullrand7_dm1/20251028-1744/wandb/run-20251028_174421-px8xu5d2/logs
[rank0]:2025-10-28 19:24:44,242 - INFO - Training completed
[rank0]:2025-10-28 19:24:44,243 - INFO - Destroying the purge thread.
[rank3]:2025-10-28 19:24:44,296 - INFO - Process group destroyed
[rank0]:2025-10-28 19:24:44,609 - INFO - Process group destroyed
[rank2]:Stage 2: Modules to keep: {'layers.12', 'layers.9', 'layers.11', 'layers.10'}
[rank1]:Stage 1: Modules to keep: {'layers.5', 'layers.7', 'layers.6', 'layers.4', 'layers.8'}
[rank0]:Stage 0: Modules to keep: {'layers.0', 'layers.2', 'layers.1', 'layers.3', 'tok_embeddings'}
[rank3]:Stage 3: Modules to keep: {'output', 'layers.13', 'norm', 'layers.15', 'layers.14'}
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1026_llama1b/config.toml
[rank3]:		- dump_folder: /data3/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1028_1F1B_fullrand7_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data3/shcho/torchtitan/profile_trace/1028_1F1B_fullrand7_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data3/shcho/torchtitan/memory_snapshot/1028_1F1B_fullrand7_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 20
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data3/shcho/torchtitan/tb/1028_1F1B_fullrand7_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data3/shcho/torchtitan/images/1028_1F1B_fullrand7_dm1
[rank3]:		- pplog_freq: 80
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1028_1F1B_fullrand7_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B-Instruct
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 1e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: alpaca
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 512
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 1600
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: 1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 4
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data3/shcho/torchtitan/checkpoint/1028_1F1B_fullrand7_dm1
[rank3]:		- interval: 800
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B-Instruct/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data3/shcho/torchtitan/comm_traces/1028_1F1B_fullrand7_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: True
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 100
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: fullrand7
[rank3]:		- phase_unit: 10
[rank3]:		- stability_check_freq: 5
[rank3]:		- aggressiveness: 0
[rank3]:
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
