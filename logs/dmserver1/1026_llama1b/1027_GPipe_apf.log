
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 10. 27. (ì›”) 18:28:53 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 3,4,5,6
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1026_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1026_llama1b/1027_GPipe_apf.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation
âœ”ï¸Running with apf x GPipe ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1026_llama1b/config.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=apf
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank1]:2025-10-27 18:28:59,946 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation"
[rank2]:2025-10-27 18:28:59,947 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation"
[rank0]:2025-10-27 18:29:00,032 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation"
[rank3]:2025-10-27 18:29:00,167 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation"
[rank0]:2025-10-27 18:29:00,483 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-10-27 18:29:00,486 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-27 18:29:00,490 - INFO - [GC] Initial GC collection 0.00 seconds
[rank1]:2025-10-27 18:29:00,488 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-10-27 18:29:00,490 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-10-27 18:29:00,495 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-10-27 18:29:00,497 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-10-27 18:29:00,523 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-10-27 18:29:00,526 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-27 18:29:00,828 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-10-27 18:29:01,220 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank2]:2025-10-27 18:29:04,291 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-10-27 18:29:04,334 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-10-27 18:29:04,369 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-10-27 18:29:04,369 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-10-27 18:29:04,513 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank2]:2025-10-27 18:29:04,547 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-10-27 18:29:04,547 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-10-27 18:29:04,548 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank1]:2025-10-27 18:29:04,578 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-10-27 18:29:04,615 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-10-27 18:29:04,640 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-10-27 18:29:04,640 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-10-27 18:29:04,659 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-10-27 18:29:04,697 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-10-27 18:29:04,698 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-10-27 18:29:04,724 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-10-27 18:29:04,724 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2025-10-27 18:29:04,818 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-10-27 18:29:04,819 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-10-27 18:29:04,819 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank0]:2025-10-27 18:29:04,908 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-10-27 18:29:04,909 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-10-27 18:29:04,909 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run prk3zpya
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data3/shcho/torchtitan/tb/1027_GPipe_apf_dm1/20251027-1829/wandb/run-20251027_182906-prk3zpya
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1027_GPipe_apf_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/prk3zpya
[rank3]:2025-10-27 18:29:07,282 - INFO - WandB logging enabled
[rank3]:2025-10-27 18:29:07,416 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-10-27 18:29:07,454 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-10-27 18:29:07,483 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-10-27 18:29:07,483 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-10-27 18:29:07,680 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data3/shcho/torchtitan/checkpoint/1027_GPipe_apf_dm1
[rank0]:2025-10-27 18:29:07,680 - WARNING - Mixed precision training with TP or PP is only supported when FSDP/HSDP/CP is enabled.
[rank0]:2025-10-27 18:29:07,680 - INFO - Mixed precision training is disabled
[rank0]:2025-10-27 18:29:07,681 - INFO - Preparing c4_validation dataset from allenai/c4
[rank3]:2025-10-27 18:29:07,665 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-10-27 18:29:07,666 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-10-27 18:29:07,667 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank0]:2025-10-27 18:29:11,917 - INFO - Trainer is initialized with local batch size 16, global batch size 64, gradient accumulation steps 4, sequence length 1024, total steps 1000 (warmup 100)
[rank0]:2025-10-27 18:29:11,917 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B-Instruct/original_dcp.
[rank0]:2025-10-27 18:29:16,776 - INFO - [GC] GC collection for checkpoint loading. 0.01 seconds
[rank0]:2025-10-27 18:29:16,777 - INFO - Finished loading the checkpoint in 4.86 seconds.
[rank0]:2025-10-27 18:29:16,777 - INFO - Training starts at step 1
[rank0]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/autograd/graph.py:849: UserWarning: Attempting to run cuBLAS, but there was no current CUDA context! Attempting to set the primary context... (Triggered internally at /pytorch/aten/src/ATen/cuda/CublasHandlePool.cpp:270.)
[rank0]:  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
[rank2]:2025-10-27 18:29:30,566 - INFO -  step:  1  loss: -4.0000  grad_norm: 53.2563  memory: 14.29GiB(30.07%)  tps: 625  tflops: 4.88  mfu: 1.56%
[rank2]:2025-10-27 18:29:30,567 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-10-27 18:29:30,567 - INFO -  step:  1  loss: -4.0000  grad_norm: 53.2563  memory: 17.77GiB(37.40%)  tps: 631  tflops: 4.94  mfu: 1.58%
[rank1]:2025-10-27 18:29:30,567 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-27 18:29:30,575 - INFO -  step:  1  loss:  9.8281  grad_norm: 53.2563  memory: 35.59GiB(74.92%)  tps: 709  tflops: 5.54  mfu: 1.78%
[rank3]:2025-10-27 18:29:30,576 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-10-27 18:29:30,603 - INFO -  step:  1  loss: -4.0000  grad_norm: 53.2563  memory: 17.10GiB(35.99%)  tps: 632  tflops: 4.94  mfu: 1.58%
[rank0]:2025-10-27 18:29:30,603 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-27 18:29:43,910 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 18:29:43,911 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 18:29:43,912 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 18:29:43,912 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 18:29:43,912 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 18:29:43,913 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 18:29:43,913 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 18:29:43,913 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 18:29:43,913 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 18:29:43,914 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 18:29:43,914 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 18:29:43,914 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 18:29:43,914 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 18:29:43,915 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 18:29:43,915 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 18:29:43,915 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 18:29:43,970 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 18:29:43,970 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 18:29:43,970 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 18:29:43,970 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 18:29:43,970 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 18:29:43,970 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 18:29:43,970 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 18:29:43,970 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 18:29:43,970 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 18:29:43,970 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 18:29:43,970 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 18:29:43,970 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 18:29:43,970 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 18:29:43,970 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 18:29:43,970 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 18:29:43,970 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 18:29:44,046 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 18:29:44,046 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 18:29:44,046 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 18:29:44,047 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 18:29:44,047 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 18:29:44,047 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 18:29:44,047 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 18:29:44,047 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 18:29:44,047 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 18:29:44,047 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 18:29:44,047 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 18:29:44,047 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 18:29:44,047 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 18:29:44,047 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 18:29:44,047 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 18:29:44,047 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 18:29:44,110 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 18:29:44,110 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 18:29:44,110 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 18:29:44,110 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 18:29:44,111 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 18:29:44,111 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 18:29:44,111 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 18:29:44,111 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 18:29:44,111 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 18:29:44,111 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 18:29:44,111 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 18:29:44,111 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 18:29:44,111 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 18:29:44,111 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 18:29:44,111 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 18:29:44,111 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 18:32:01,148 - INFO -  step: 20  loss: -4.0000  grad_norm: 26.1659  memory: 16.10GiB(33.90%)  tps: 2,067  tflops: 16.16  mfu: 5.18%
[rank1]:2025-10-27 18:32:01,151 - INFO -  step: 20  loss: -4.0000  grad_norm: 26.1659  memory: 20.03GiB(42.17%)  tps: 2,067  tflops: 16.16  mfu: 5.18%
[rank3]:2025-10-27 18:32:01,160 - INFO -  step: 20  loss: 12.1439  grad_norm: 26.1659  memory: 38.93GiB(81.95%)  tps: 2,067  tflops: 16.16  mfu: 5.18%
[rank0]:2025-10-27 18:32:01,167 - INFO -  step: 20  loss: -4.0000  grad_norm: 26.1659  memory: 20.89GiB(43.97%)  tps: 2,068  tflops: 16.16  mfu: 5.18%
[rank3]:2025-10-27 18:32:02,932 - INFO - Avg. fwd time: 70.9407 / Avg. bwd time: 127.2277 / Avg. batch time: 1651.2655 (ms) / GPU bubble ratio: 3.99%
[rank2]:2025-10-27 18:32:02,992 - INFO - Avg. fwd time: 32.7727 / Avg. bwd time: 52.8366 / Avg. batch time: 1740.1229 (ms) / GPU bubble ratio: 60.64%
[rank1]:2025-10-27 18:32:03,068 - INFO - Avg. fwd time: 50.6027 / Avg. bwd time: 72.6818 / Avg. batch time: 1859.6289 (ms) / GPU bubble ratio: 46.96%
[rank0]:2025-10-27 18:32:03,129 - INFO - Avg. fwd time: 45.0877 / Avg. bwd time: 59.1369 / Avg. batch time: 1957.4611 (ms) / GPU bubble ratio: 57.40%
[rank3]:2025-10-27 18:34:40,640 - INFO -  step: 40  loss:  9.0203  grad_norm: 16.4194  memory: 38.93GiB(81.95%)  tps: 2,055  tflops: 16.06  mfu: 5.15%
[rank2]:2025-10-27 18:34:40,628 - INFO -  step: 40  loss: -4.0000  grad_norm: 16.4194  memory: 16.10GiB(33.90%)  tps: 2,055  tflops: 16.06  mfu: 5.15%
[rank0]:2025-10-27 18:34:40,646 - INFO -  step: 40  loss: -4.0000  grad_norm: 16.4194  memory: 20.89GiB(43.97%)  tps: 2,055  tflops: 16.06  mfu: 5.15%
[rank1]:2025-10-27 18:34:40,631 - INFO -  step: 40  loss: -4.0000  grad_norm: 16.4194  memory: 20.03GiB(42.17%)  tps: 2,055  tflops: 16.06  mfu: 5.15%
[rank3]:2025-10-27 18:34:42,431 - INFO - Avg. fwd time: 71.4710 / Avg. bwd time: 128.7407 / Avg. batch time: 1658.3233 (ms) / GPU bubble ratio: 3.41%
[rank2]:2025-10-27 18:34:42,487 - INFO - Avg. fwd time: 32.9320 / Avg. bwd time: 53.4094 / Avg. batch time: 1747.3164 (ms) / GPU bubble ratio: 60.47%
[rank1]:2025-10-27 18:34:42,559 - INFO - Avg. fwd time: 51.3664 / Avg. bwd time: 73.3351 / Avg. batch time: 1867.0982 (ms) / GPU bubble ratio: 46.57%
[rank0]:2025-10-27 18:34:42,620 - INFO - Avg. fwd time: 45.6237 / Avg. bwd time: 59.7523 / Avg. batch time: 1965.1333 (ms) / GPU bubble ratio: 57.10%
[rank0]:2025-10-27 18:35:53,269 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-27 18:37:20,925 - INFO -  step: 60  loss: -4.0000  grad_norm: 21.6554  memory: 16.10GiB(33.90%)  tps: 2,044  tflops: 15.98  mfu: 5.12%
[rank3]:2025-10-27 18:37:20,938 - INFO -  step: 60  loss:  5.6820  grad_norm: 21.6554  memory: 38.93GiB(81.95%)  tps: 2,044  tflops: 15.98  mfu: 5.12%
[rank0]:2025-10-27 18:37:20,946 - INFO -  step: 60  loss: -4.0000  grad_norm: 21.6554  memory: 20.89GiB(43.97%)  tps: 2,044  tflops: 15.98  mfu: 5.12%
[rank1]:2025-10-27 18:37:20,929 - INFO -  step: 60  loss: -4.0000  grad_norm: 21.6554  memory: 20.03GiB(42.17%)  tps: 2,044  tflops: 15.98  mfu: 5.12%
[rank3]:2025-10-27 18:37:22,757 - INFO - Avg. fwd time: 71.9437 / Avg. bwd time: 129.3658 / Avg. batch time: 1663.5375 (ms) / GPU bubble ratio: 3.19%
[rank2]:2025-10-27 18:37:22,817 - INFO - Avg. fwd time: 33.0912 / Avg. bwd time: 53.5922 / Avg. batch time: 1752.6951 (ms) / GPU bubble ratio: 60.43%
[rank0]:2025-10-27 18:37:22,964 - INFO - Avg. fwd time: 45.8171 / Avg. bwd time: 59.9558 / Avg. batch time: 1971.0999 (ms) / GPU bubble ratio: 57.07%
[rank1]:2025-10-27 18:37:22,897 - INFO - Avg. fwd time: 51.6865 / Avg. bwd time: 73.6146 / Avg. batch time: 1872.8283 (ms) / GPU bubble ratio: 46.48%
[rank2]:2025-10-27 18:40:01,527 - INFO -  step: 80  loss: -4.0000  grad_norm: 23.6227  memory: 16.10GiB(33.90%)  tps: 2,040  tflops: 15.95  mfu: 5.11%
[rank0]:2025-10-27 18:40:01,543 - INFO -  step: 80  loss: -4.0000  grad_norm: 23.6227  memory: 20.89GiB(43.97%)  tps: 2,040  tflops: 15.95  mfu: 5.11%
[rank3]:2025-10-27 18:40:01,540 - INFO -  step: 80  loss:  2.1310  grad_norm: 23.6227  memory: 38.93GiB(81.95%)  tps: 2,040  tflops: 15.95  mfu: 5.11%
[rank1]:2025-10-27 18:40:01,532 - INFO -  step: 80  loss: -4.0000  grad_norm: 23.6227  memory: 20.03GiB(42.17%)  tps: 2,040  tflops: 15.95  mfu: 5.11%
[rank3]:2025-10-27 18:40:03,350 - INFO - Avg. fwd time: 72.1666 / Avg. bwd time: 129.7805 / Avg. batch time: 1666.8474 (ms) / GPU bubble ratio: 3.08%
[rank2]:2025-10-27 18:40:03,407 - INFO - Avg. fwd time: 33.2856 / Avg. bwd time: 53.7501 / Avg. batch time: 1756.1989 (ms) / GPU bubble ratio: 60.35%
[rank1]:2025-10-27 18:40:03,479 - INFO - Avg. fwd time: 51.5951 / Avg. bwd time: 73.8653 / Avg. batch time: 1876.5565 (ms) / GPU bubble ratio: 46.51%
[rank0]:2025-10-27 18:40:03,542 - INFO - Avg. fwd time: 45.8042 / Avg. bwd time: 60.0906 / Avg. batch time: 1974.8810 (ms) / GPU bubble ratio: 57.10%
[rank0]:2025-10-27 18:42:01,321 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-27 18:42:01,310 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-27 18:42:01,307 - INFO - Freezing Ratio: [Stage2] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-27 18:42:01,951 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-27 18:42:23,798 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-27 18:42:29,164 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-27 18:42:29,173 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,219  tflops: 17.35  mfu: 5.56%
[rank1]:2025-10-27 18:42:29,173 - INFO - ðŸ”Ž  Running validation at step 100
[rank2]:2025-10-27 18:42:29,164 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-27 18:42:29,165 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,219  tflops: 17.35  mfu: 5.56%
[rank2]:2025-10-27 18:42:29,172 - INFO - ðŸ”Ž  Running validation at step 100
[rank0]:2025-10-27 18:42:29,165 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-27 18:42:29,173 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,220  tflops: 17.35  mfu: 5.56%
[rank0]:2025-10-27 18:42:29,173 - INFO - ðŸ”Ž  Running validation at step 100
[rank3]:2025-10-27 18:42:31,554 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-27 18:42:31,559 - INFO -  step: 100  loss:  1.9045  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,184  tflops: 17.08  mfu: 5.47%
[rank3]:2025-10-27 18:42:31,559 - INFO - ðŸ”Ž  Running validation at step 100
[rank0]:2025-10-27 18:43:41,597 - INFO - validate step: 100  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,656
[rank1]:2025-10-27 18:43:41,680 - INFO - validate step: 100  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,649
[rank2]:2025-10-27 18:43:41,761 - INFO - validate step: 100  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,643
[rank3]:2025-10-27 18:43:41,844 - INFO - validate step: 100  loss:  0.5391  memory: 38.93GiB(81.95%)  tps: 5,828
[rank0]:2025-10-27 18:43:41,926 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1027_GPipe_apf_dm1/freeze_ratio_history/rank0/251027_1843_stage0_step100.svg
[rank1]:2025-10-27 18:43:41,925 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1027_GPipe_apf_dm1/freeze_ratio_history/rank1/251027_1843_stage1_step100.svg
[rank2]:2025-10-27 18:43:41,925 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1027_GPipe_apf_dm1/freeze_ratio_history/rank2/251027_1843_stage2_step100.svg
[rank3]:2025-10-27 18:43:42,061 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1027_GPipe_apf_dm1/pipeline_schedule/251027_1843_real_step100_rank3.svg
[rank3]:> Batch Time: 1925.97 ms, GPU Bubble Ratio: 55.99%, 47.16%, 64.15%, 15.54%
[rank3]:2025-10-27 18:43:42,124 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1027_GPipe_apf_dm1/freeze_ratio_history/rank3/251027_1843_stage3_step100.svg
[rank3]:2025-10-27 18:43:43,810 - INFO - Avg. fwd time: 72.1845 / Avg. bwd time: 126.7262 / Avg. batch time: 1641.6658 (ms) / GPU bubble ratio: 3.07%
[rank2]:2025-10-27 18:43:43,867 - INFO - Avg. fwd time: 33.3205 / Avg. bwd time: 52.5635 / Avg. batch time: 1731.3677 (ms) / GPU bubble ratio: 60.32%
[rank1]:2025-10-27 18:43:43,949 - INFO - Avg. fwd time: 51.8199 / Avg. bwd time: 72.1607 / Avg. batch time: 1850.0820 (ms) / GPU bubble ratio: 46.39%
[rank0]:2025-10-27 18:43:44,014 - INFO - Avg. fwd time: 45.7384 / Avg. bwd time: 57.1278 / Avg. batch time: 1945.4207 (ms) / GPU bubble ratio: 57.70%
[rank2]:2025-10-27 18:44:21,946 - INFO - Freezing Ratio: [Stage2] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-27 18:44:21,965 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-27 18:44:21,950 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-27 18:44:24,545 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-27 18:44:51,901 - INFO - Freezing Ratio: [Stage2] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-27 18:44:51,902 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-27 18:44:51,901 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-27 18:44:54,311 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-27 18:45:21,590 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-27 18:45:21,590 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-27 18:45:21,590 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-27 18:45:24,060 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-27 18:46:03,506 - INFO - Freezing Ratio: [Stage2] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-27 18:46:03,507 - INFO -  step: 120  loss: -4.0000  grad_norm:  5.6440  memory: 16.10GiB(33.90%)  tps: 2,312  tflops: 18.07  mfu: 5.79%
[rank0]:2025-10-27 18:46:03,530 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-27 18:46:03,531 - INFO -  step: 120  loss: -4.0000  grad_norm:  5.6440  memory: 20.89GiB(43.97%)  tps: 2,309  tflops: 18.05  mfu: 5.78%
[rank1]:2025-10-27 18:46:03,509 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-27 18:46:03,510 - INFO -  step: 120  loss: -4.0000  grad_norm:  5.6440  memory: 20.03GiB(42.17%)  tps: 2,310  tflops: 18.06  mfu: 5.79%
[rank3]:2025-10-27 18:46:05,904 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-27 18:46:05,907 - INFO -  step: 120  loss:  0.3453  grad_norm:  5.6440  memory: 38.93GiB(81.95%)  tps: 2,275  tflops: 17.78  mfu: 5.70%
[rank2]:2025-10-27 18:46:07,112 - INFO - Avg. fwd time: 33.3184 / Avg. bwd time: 50.6817 / Avg. batch time: 1710.0233 (ms) / GPU bubble ratio: 60.70%
[rank3]:2025-10-27 18:46:07,079 - INFO - Avg. fwd time: 72.1659 / Avg. bwd time: 121.9501 / Avg. batch time: 1602.9044 (ms) / GPU bubble ratio: 3.12%
[rank0]:2025-10-27 18:46:07,159 - INFO - Avg. fwd time: 45.7293 / Avg. bwd time: 52.5104 / Avg. batch time: 1916.7755 (ms) / GPU bubble ratio: 59.00%
[rank1]:2025-10-27 18:46:07,156 - INFO - Avg. fwd time: 51.9523 / Avg. bwd time: 69.5373 / Avg. batch time: 1826.2433 (ms) / GPU bubble ratio: 46.78%
[rank0]:2025-10-27 18:46:33,061 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-27 18:46:33,061 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-27 18:46:33,060 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-27 18:46:35,474 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-27 18:47:02,967 - INFO - Freezing Ratio: [Stage2] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-27 18:47:02,968 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-27 18:47:02,967 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-27 18:47:05,509 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-27 18:47:32,070 - INFO - Freezing Ratio: [Stage2] 0.03, Threshold: 5.0000e-02
[rank0]:2025-10-27 18:47:32,071 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-27 18:47:32,071 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-27 18:47:34,604 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-27 18:48:14,313 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-27 18:48:14,313 - INFO -  step: 140  loss: -4.0000  grad_norm:  2.7316  memory: 20.89GiB(43.97%)  tps: 2,506  tflops: 19.59  mfu: 6.28%
[rank1]:2025-10-27 18:48:14,292 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-27 18:48:14,293 - INFO -  step: 140  loss: -4.0000  grad_norm:  2.7316  memory: 20.03GiB(42.17%)  tps: 2,506  tflops: 19.59  mfu: 6.28%
[rank2]:2025-10-27 18:48:14,289 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-27 18:48:14,290 - INFO -  step: 140  loss: -4.0000  grad_norm:  2.7316  memory: 16.10GiB(33.90%)  tps: 2,506  tflops: 19.59  mfu: 6.28%
[rank3]:2025-10-27 18:48:16,709 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-27 18:48:16,713 - INFO -  step: 140  loss:  0.2353  grad_norm:  2.7316  memory: 38.93GiB(81.95%)  tps: 2,505  tflops: 19.58  mfu: 6.28%
[rank2]:2025-10-27 18:48:17,933 - INFO - Avg. fwd time: 33.3018 / Avg. bwd time: 48.5001 / Avg. batch time: 1676.6113 (ms) / GPU bubble ratio: 60.97%
[rank3]:2025-10-27 18:48:17,899 - INFO - Avg. fwd time: 72.1201 / Avg. bwd time: 116.3975 / Avg. batch time: 1557.7844 (ms) / GPU bubble ratio: 3.19%
[rank0]:2025-10-27 18:48:17,979 - INFO - Avg. fwd time: 45.6869 / Avg. bwd time: 47.1636 / Avg. batch time: 1874.7527 (ms) / GPU bubble ratio: 60.38%
[rank1]:2025-10-27 18:48:17,976 - INFO - Avg. fwd time: 52.1340 / Avg. bwd time: 66.4264 / Avg. batch time: 1789.8197 (ms) / GPU bubble ratio: 47.01%
[rank0]:2025-10-27 18:48:44,156 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-27 18:48:44,156 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-27 18:48:44,155 - INFO - Freezing Ratio: [Stage2] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-27 18:48:46,610 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-27 18:49:07,911 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-27 18:49:13,285 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-27 18:49:13,285 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-27 18:49:13,285 - INFO - Freezing Ratio: [Stage2] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-27 18:49:15,778 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-27 18:49:42,818 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-27 18:49:42,817 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-27 18:49:42,817 - INFO - Freezing Ratio: [Stage2] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-27 18:49:45,317 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-27 18:50:12,669 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-27 18:50:12,670 - INFO -  step: 160  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,768  tflops: 21.64  mfu: 6.94%
[rank0]:2025-10-27 18:50:12,670 - INFO - Freezing Ratio: [Stage0] 0.03, Threshold: 5.0000e-02
[rank0]:2025-10-27 18:50:12,671 - INFO -  step: 160  loss: -4.0000  grad_norm:  0.0008  memory: 20.89GiB(43.97%)  tps: 2,769  tflops: 21.64  mfu: 6.94%
[rank1]:2025-10-27 18:50:12,669 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-27 18:50:12,670 - INFO -  step: 160  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,768  tflops: 21.64  mfu: 6.94%
[rank3]:2025-10-27 18:50:15,044 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-27 18:50:15,047 - INFO -  step: 160  loss:  0.1968  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,769  tflops: 21.65  mfu: 6.94%
[rank3]:2025-10-27 18:50:16,755 - INFO - Avg. fwd time: 72.0599 / Avg. bwd time: 110.3884 / Avg. batch time: 1509.1169 (ms) / GPU bubble ratio: 3.28%
[rank2]:2025-10-27 18:50:16,814 - INFO - Avg. fwd time: 33.3027 / Avg. bwd time: 46.1180 / Avg. batch time: 1635.8510 (ms) / GPU bubble ratio: 61.16%
[rank0]:2025-10-27 18:50:16,955 - INFO - Avg. fwd time: 45.6434 / Avg. bwd time: 41.6833 / Avg. batch time: 1825.0236 (ms) / GPU bubble ratio: 61.72%
[rank1]:2025-10-27 18:50:16,893 - INFO - Avg. fwd time: 52.3112 / Avg. bwd time: 63.0863 / Avg. batch time: 1745.8233 (ms) / GPU bubble ratio: 47.12%
[rank0]:2025-10-27 18:50:54,509 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-27 18:50:54,500 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-27 18:50:54,495 - INFO - Freezing Ratio: [Stage2] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-27 18:50:56,889 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-27 18:51:23,907 - INFO - Freezing Ratio: [Stage2] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-27 18:51:23,908 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-27 18:51:23,907 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-27 18:51:26,414 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-27 18:51:53,754 - INFO - Freezing Ratio: [Stage2] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-27 18:51:53,754 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-27 18:51:53,754 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-27 18:51:56,305 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-27 18:52:23,323 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-27 18:52:23,323 - INFO -  step: 180  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,508  tflops: 19.61  mfu: 6.28%
[rank2]:2025-10-27 18:52:23,322 - INFO - Freezing Ratio: [Stage2] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-27 18:52:23,323 - INFO -  step: 180  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,508  tflops: 19.61  mfu: 6.28%
[rank0]:2025-10-27 18:52:23,323 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-27 18:52:23,323 - INFO -  step: 180  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,508  tflops: 19.61  mfu: 6.28%
[rank3]:2025-10-27 18:52:25,704 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-27 18:52:25,708 - INFO -  step: 180  loss:  0.1684  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,508  tflops: 19.61  mfu: 6.28%
[rank3]:2025-10-27 18:52:26,883 - INFO - Avg. fwd time: 71.9855 / Avg. bwd time: 107.2631 / Avg. batch time: 1483.4458 (ms) / GPU bubble ratio: 3.33%
[rank2]:2025-10-27 18:52:26,916 - INFO - Avg. fwd time: 33.2868 / Avg. bwd time: 44.8937 / Avg. batch time: 1616.9638 (ms) / GPU bubble ratio: 61.32%
[rank0]:2025-10-27 18:52:26,968 - INFO - Avg. fwd time: 45.5849 / Avg. bwd time: 38.7969 / Avg. batch time: 1801.3802 (ms) / GPU bubble ratio: 62.53%
[rank1]:2025-10-27 18:52:26,960 - INFO - Avg. fwd time: 52.3812 / Avg. bwd time: 61.3298 / Avg. batch time: 1725.2003 (ms) / GPU bubble ratio: 47.27%
[rank2]:2025-10-27 18:52:52,734 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-27 18:52:52,734 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-27 18:52:52,734 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-27 18:52:55,117 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-27 18:53:22,402 - INFO - Freezing Ratio: [Stage0] 0.03, Threshold: 5.0000e-02
[rank1]:2025-10-27 18:53:22,402 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-27 18:53:22,402 - INFO - Freezing Ratio: [Stage2] 0.03, Threshold: 5.0000e-02
[rank3]:2025-10-27 18:53:24,869 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-27 18:54:04,986 - INFO - Freezing Ratio: [Stage2] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-27 18:54:05,006 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-27 18:54:04,991 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-27 18:54:07,554 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-27 18:54:28,875 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-27 18:54:34,260 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-27 18:54:34,260 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,503  tflops: 19.56  mfu: 6.27%
[rank2]:2025-10-27 18:54:34,261 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-10-27 18:54:34,260 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-27 18:54:34,261 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,503  tflops: 19.56  mfu: 6.27%
[rank0]:2025-10-27 18:54:34,261 - INFO - ðŸ”Ž  Running validation at step 200
[rank1]:2025-10-27 18:54:34,260 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-27 18:54:34,261 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,503  tflops: 19.56  mfu: 6.27%
[rank1]:2025-10-27 18:54:34,261 - INFO - ðŸ”Ž  Running validation at step 200
[rank3]:2025-10-27 18:54:36,650 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-27 18:54:36,653 - INFO -  step: 200  loss:  0.1516  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,502  tflops: 19.56  mfu: 6.27%
[rank3]:2025-10-27 18:54:36,654 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-10-27 18:55:44,996 - INFO - validate step: 200  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,791
[rank1]:2025-10-27 18:55:45,078 - INFO - validate step: 200  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,784
[rank2]:2025-10-27 18:55:45,160 - INFO - validate step: 200  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,777
[rank3]:2025-10-27 18:55:45,241 - INFO - validate step: 200  loss:  0.3697  memory: 38.93GiB(81.95%)  tps: 5,972
[rank2]:2025-10-27 18:55:45,320 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1027_GPipe_apf_dm1/freeze_ratio_history/rank2/251027_1855_stage2_step200.svg
[rank0]:2025-10-27 18:55:45,322 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1027_GPipe_apf_dm1/freeze_ratio_history/rank0/251027_1855_stage0_step200.svg
[rank1]:2025-10-27 18:55:45,321 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1027_GPipe_apf_dm1/freeze_ratio_history/rank1/251027_1855_stage1_step200.svg
[rank3]:2025-10-27 18:55:45,444 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1027_GPipe_apf_dm1/pipeline_schedule/251027_1855_real_step200_rank3.svg
[rank3]:> Batch Time: 1900.41 ms, GPU Bubble Ratio: 56.29%, 48.26%, 64.29%, 15.52%
[rank3]:2025-10-27 18:55:45,515 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1027_GPipe_apf_dm1/freeze_ratio_history/rank3/251027_1855_stage3_step200.svg
[rank3]:2025-10-27 18:55:46,699 - INFO - Avg. fwd time: 71.9355 / Avg. bwd time: 104.8766 / Avg. batch time: 1463.9367 (ms) / GPU bubble ratio: 3.38%
[rank2]:2025-10-27 18:55:46,733 - INFO - Avg. fwd time: 33.2769 / Avg. bwd time: 43.9592 / Avg. batch time: 1600.1789 (ms) / GPU bubble ratio: 61.39%
[rank0]:2025-10-27 18:55:46,785 - INFO - Avg. fwd time: 45.5524 / Avg. bwd time: 36.5548 / Avg. batch time: 1780.8795 (ms) / GPU bubble ratio: 63.12%
[rank1]:2025-10-27 18:55:46,776 - INFO - Avg. fwd time: 52.5015 / Avg. bwd time: 60.0118 / Avg. batch time: 1707.0563 (ms) / GPU bubble ratio: 47.27%
[rank1]:2025-10-27 18:56:12,935 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-27 18:56:12,935 - INFO - Freezing Ratio: [Stage2] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-27 18:56:12,936 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-27 18:56:15,504 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-27 18:56:42,943 - INFO - Freezing Ratio: [Stage2] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-27 18:56:42,944 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-27 18:56:42,944 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-27 18:56:45,348 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-27 18:57:11,970 - INFO - Freezing Ratio: [Stage2] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-27 18:57:11,970 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-27 18:57:11,970 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-27 18:57:14,502 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-27 18:57:41,449 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-27 18:57:41,450 - INFO -  step: 220  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,816  tflops: 22.01  mfu: 7.06%
[rank2]:2025-10-27 18:57:41,449 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-27 18:57:41,450 - INFO -  step: 220  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,818  tflops: 22.03  mfu: 7.06%
[rank0]:2025-10-27 18:57:41,450 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-27 18:57:41,450 - INFO -  step: 220  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,814  tflops: 22.00  mfu: 7.05%
[rank3]:2025-10-27 18:57:43,853 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-27 18:57:43,856 - INFO -  step: 220  loss:  0.1879  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,763  tflops: 21.60  mfu: 6.92%
[rank3]:2025-10-27 18:57:45,022 - INFO - Avg. fwd time: 71.8892 / Avg. bwd time: 101.4928 / Avg. batch time: 1436.5122 (ms) / GPU bubble ratio: 3.44%
[rank2]:2025-10-27 18:57:45,056 - INFO - Avg. fwd time: 33.2755 / Avg. bwd time: 42.6068 / Avg. batch time: 1576.9953 (ms) / GPU bubble ratio: 61.51%
[rank0]:2025-10-27 18:57:45,103 - INFO - Avg. fwd time: 45.5305 / Avg. bwd time: 33.3440 / Avg. batch time: 1752.5339 (ms) / GPU bubble ratio: 64.00%
[rank1]:2025-10-27 18:57:45,099 - INFO - Avg. fwd time: 52.5959 / Avg. bwd time: 58.1221 / Avg. batch time: 1682.0698 (ms) / GPU bubble ratio: 47.34%
[rank2]:2025-10-27 18:58:11,355 - INFO - Freezing Ratio: [Stage2] 0.03, Threshold: 5.0000e-02
[rank0]:2025-10-27 18:58:11,355 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-27 18:58:11,355 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-27 18:58:13,762 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-27 18:58:53,043 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-27 18:58:53,039 - INFO - Freezing Ratio: [Stage2] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-27 18:58:53,058 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-27 18:58:55,597 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-27 18:59:22,519 - INFO - Freezing Ratio: [Stage2] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-27 18:59:22,519 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-27 18:59:22,519 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-27 18:59:25,045 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-27 18:59:52,540 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-27 18:59:52,541 - INFO -  step: 240  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,500  tflops: 19.54  mfu: 6.26%
[rank0]:2025-10-27 18:59:52,541 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-27 18:59:52,541 - INFO -  step: 240  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,500  tflops: 19.54  mfu: 6.26%
[rank2]:2025-10-27 18:59:52,540 - INFO - Freezing Ratio: [Stage2] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-27 18:59:52,541 - INFO -  step: 240  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,500  tflops: 19.54  mfu: 6.26%
[rank3]:2025-10-27 18:59:54,942 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-27 18:59:54,945 - INFO -  step: 240  loss:  3.2561  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,500  tflops: 19.54  mfu: 6.26%
[rank3]:2025-10-27 18:59:56,145 - INFO - Avg. fwd time: 71.8965 / Avg. bwd time: 99.9797 / Avg. batch time: 1424.4225 (ms) / GPU bubble ratio: 3.47%
[rank2]:2025-10-27 18:59:56,179 - INFO - Avg. fwd time: 33.2746 / Avg. bwd time: 41.9998 / Avg. batch time: 1568.9060 (ms) / GPU bubble ratio: 61.62%
[rank1]:2025-10-27 18:59:56,222 - INFO - Avg. fwd time: 52.6750 / Avg. bwd time: 57.2527 / Avg. batch time: 1673.1083 (ms) / GPU bubble ratio: 47.44%
[rank0]:2025-10-27 18:59:56,226 - INFO - Avg. fwd time: 45.5124 / Avg. bwd time: 31.8164 / Avg. batch time: 1741.9836 (ms) / GPU bubble ratio: 64.49%
[rank0]:2025-10-27 19:00:21,896 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:00:21,896 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:00:21,896 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:00:24,297 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:00:45,706 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-27 19:00:51,130 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:00:51,129 - INFO - Freezing Ratio: [Stage2] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:00:51,130 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:00:53,695 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:01:21,196 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:01:21,196 - INFO - Freezing Ratio: [Stage2] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:01:21,196 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:01:23,711 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:01:50,871 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:01:50,871 - INFO -  step: 260  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,769  tflops: 21.65  mfu: 6.94%
[rank0]:2025-10-27 19:01:50,872 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:01:50,879 - INFO -  step: 260  loss: -4.0000  grad_norm:  0.0009  memory: 20.89GiB(43.97%)  tps: 2,769  tflops: 21.65  mfu: 6.94%
[rank2]:2025-10-27 19:01:50,871 - INFO - Freezing Ratio: [Stage2] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:01:50,871 - INFO -  step: 260  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,769  tflops: 21.65  mfu: 6.94%
[rank3]:2025-10-27 19:01:53,265 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:01:53,268 - INFO -  step: 260  loss:  0.1411  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,769  tflops: 21.65  mfu: 6.94%
[rank3]:2025-10-27 19:01:54,374 - INFO - Avg. fwd time: 71.8589 / Avg. bwd time: 97.4919 / Avg. batch time: 1404.1978 (ms) / GPU bubble ratio: 3.52%
[rank0]:2025-10-27 19:01:54,454 - INFO - Avg. fwd time: 45.4654 / Avg. bwd time: 29.4680 / Avg. batch time: 1720.8671 (ms) / GPU bubble ratio: 65.16%
[rank2]:2025-10-27 19:01:54,408 - INFO - Avg. fwd time: 33.2686 / Avg. bwd time: 41.0060 / Avg. batch time: 1551.5981 (ms) / GPU bubble ratio: 61.70%
[rank1]:2025-10-27 19:01:54,450 - INFO - Avg. fwd time: 52.7744 / Avg. bwd time: 55.8572 / Avg. batch time: 1654.4533 (ms) / GPU bubble ratio: 47.47%
[rank0]:2025-10-27 19:02:20,083 - INFO - Freezing Ratio: [Stage0] 0.03, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:02:20,083 - INFO - Freezing Ratio: [Stage2] 0.03, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:02:20,083 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:02:22,481 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:03:02,426 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:03:02,412 - INFO - Freezing Ratio: [Stage2] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:03:02,416 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:03:04,978 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:03:32,113 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:03:32,113 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:03:32,112 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:03:34,507 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:04:01,143 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:04:01,144 - INFO -  step: 280  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,515  tflops: 19.66  mfu: 6.30%
[rank0]:2025-10-27 19:04:01,144 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:04:01,144 - INFO -  step: 280  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,515  tflops: 19.67  mfu: 6.30%
[rank2]:2025-10-27 19:04:01,143 - INFO - Freezing Ratio: [Stage2] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:04:01,144 - INFO -  step: 280  loss: -4.0000  grad_norm:  0.0006  memory: 16.10GiB(33.90%)  tps: 2,515  tflops: 19.67  mfu: 6.30%
[rank3]:2025-10-27 19:04:03,537 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:04:03,542 - INFO -  step: 280  loss:  0.1664  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,515  tflops: 19.66  mfu: 6.30%
[rank3]:2025-10-27 19:04:04,716 - INFO - Avg. fwd time: 71.8196 / Avg. bwd time: 96.4462 / Avg. batch time: 1395.5086 (ms) / GPU bubble ratio: 3.54%
[rank0]:2025-10-27 19:04:04,798 - INFO - Avg. fwd time: 45.4626 / Avg. bwd time: 28.4369 / Avg. batch time: 1713.3974 (ms) / GPU bubble ratio: 65.50%
[rank2]:2025-10-27 19:04:04,750 - INFO - Avg. fwd time: 33.2534 / Avg. bwd time: 40.6122 / Avg. batch time: 1545.7485 (ms) / GPU bubble ratio: 61.77%
[rank1]:2025-10-27 19:04:04,793 - INFO - Avg. fwd time: 52.7692 / Avg. bwd time: 55.2993 / Avg. batch time: 1648.0400 (ms) / GPU bubble ratio: 47.54%
[rank0]:2025-10-27 19:04:30,519 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:04:30,518 - INFO - Freezing Ratio: [Stage2] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:04:30,519 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:04:33,035 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:05:00,260 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:05:00,260 - INFO - Freezing Ratio: [Stage2] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:05:00,260 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:05:02,649 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:05:29,321 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:05:29,320 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:05:29,320 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:05:31,707 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:05:53,158 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-27 19:05:58,631 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:05:58,639 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,789  tflops: 21.80  mfu: 6.99%
[rank0]:2025-10-27 19:05:58,639 - INFO - ðŸ”Ž  Running validation at step 300
[rank2]:2025-10-27 19:05:58,631 - INFO - Freezing Ratio: [Stage2] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:05:58,631 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.0005  memory: 16.10GiB(33.90%)  tps: 2,789  tflops: 21.80  mfu: 6.99%
[rank2]:2025-10-27 19:05:58,639 - INFO - ðŸ”Ž  Running validation at step 300
[rank1]:2025-10-27 19:05:58,631 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:05:58,640 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,789  tflops: 21.80  mfu: 6.99%
[rank1]:2025-10-27 19:05:58,640 - INFO - ðŸ”Ž  Running validation at step 300
[rank3]:2025-10-27 19:06:01,100 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:06:01,103 - INFO -  step: 300  loss:  0.1181  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,787  tflops: 21.79  mfu: 6.98%
[rank3]:2025-10-27 19:06:01,103 - INFO - ðŸ”Ž  Running validation at step 300
[rank0]:2025-10-27 19:07:09,148 - INFO - validate step: 300  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,809
[rank1]:2025-10-27 19:07:09,230 - INFO - validate step: 300  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,803
[rank2]:2025-10-27 19:07:09,309 - INFO - validate step: 300  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,796
[rank3]:2025-10-27 19:07:09,389 - INFO - validate step: 300  loss:  0.2955  memory: 38.93GiB(81.95%)  tps: 5,999
[rank2]:2025-10-27 19:07:09,468 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1027_GPipe_apf_dm1/freeze_ratio_history/rank2/251027_1907_stage2_step300.svg
[rank1]:2025-10-27 19:07:09,484 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1027_GPipe_apf_dm1/freeze_ratio_history/rank1/251027_1907_stage1_step300.svg
[rank0]:2025-10-27 19:07:09,464 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1027_GPipe_apf_dm1/freeze_ratio_history/rank0/251027_1907_stage0_step300.svg
[rank3]:2025-10-27 19:07:09,577 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1027_GPipe_apf_dm1/pipeline_schedule/251027_1907_real_step300_rank3.svg
[rank3]:> Batch Time: 1323.51 ms, GPU Bubble Ratio: 69.27%, 42.99%, 62.29%, 14.42%
[rank3]:2025-10-27 19:07:09,644 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1027_GPipe_apf_dm1/freeze_ratio_history/rank3/251027_1907_stage3_step300.svg
[rank2]:2025-10-27 19:07:10,882 - INFO - Avg. fwd time: 33.2487 / Avg. bwd time: 39.8433 / Avg. batch time: 1529.8905 (ms) / GPU bubble ratio: 61.78%
[rank3]:2025-10-27 19:07:10,848 - INFO - Avg. fwd time: 71.7779 / Avg. bwd time: 94.4867 / Avg. batch time: 1379.5127 (ms) / GPU bubble ratio: 3.58%
[rank0]:2025-10-27 19:07:10,929 - INFO - Avg. fwd time: 45.4220 / Avg. bwd time: 26.6264 / Avg. batch time: 1694.5647 (ms) / GPU bubble ratio: 65.99%
[rank1]:2025-10-27 19:07:10,925 - INFO - Avg. fwd time: 52.8118 / Avg. bwd time: 54.2199 / Avg. batch time: 1631.0990 (ms) / GPU bubble ratio: 47.50%
[rank0]:2025-10-27 19:07:37,355 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:07:37,354 - INFO - Freezing Ratio: [Stage2] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:07:37,354 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:07:39,917 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:08:06,816 - INFO - Freezing Ratio: [Stage0] 0.03, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:08:06,815 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:08:06,816 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:08:09,223 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:08:48,917 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:08:48,938 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:08:48,913 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:08:51,374 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:09:18,735 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:09:18,736 - INFO -  step: 320  loss: -4.0000  grad_norm:  0.0007  memory: 16.10GiB(33.90%)  tps: 2,532  tflops: 19.79  mfu: 6.34%
[rank1]:2025-10-27 19:09:18,735 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:09:18,736 - INFO -  step: 320  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,530  tflops: 19.78  mfu: 6.34%
[rank0]:2025-10-27 19:09:18,735 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:09:18,736 - INFO -  step: 320  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,529  tflops: 19.77  mfu: 6.34%
[rank3]:2025-10-27 19:09:21,138 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:09:21,142 - INFO -  step: 320  loss:  0.1555  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,487  tflops: 19.44  mfu: 6.23%
[rank3]:2025-10-27 19:09:22,348 - INFO - Avg. fwd time: 71.8083 / Avg. bwd time: 93.7991 / Avg. batch time: 1374.2327 (ms) / GPU bubble ratio: 3.59%
[rank2]:2025-10-27 19:09:22,382 - INFO - Avg. fwd time: 33.2572 / Avg. bwd time: 39.5707 / Avg. batch time: 1526.9815 (ms) / GPU bubble ratio: 61.84%
[rank1]:2025-10-27 19:09:22,425 - INFO - Avg. fwd time: 52.8638 / Avg. bwd time: 53.8514 / Avg. batch time: 1627.8448 (ms) / GPU bubble ratio: 47.56%
[rank0]:2025-10-27 19:09:22,429 - INFO - Avg. fwd time: 45.4624 / Avg. bwd time: 25.9089 / Avg. batch time: 1690.5870 (ms) / GPU bubble ratio: 66.23%
[rank2]:2025-10-27 19:09:47,967 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:09:47,968 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:09:47,968 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:09:50,378 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:10:17,228 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:10:17,228 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:10:17,228 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:10:19,760 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:10:47,118 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:10:47,118 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:10:47,117 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:10:49,656 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:11:16,623 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:11:16,624 - INFO -  step: 340  loss: -4.0000  grad_norm:  0.0012  memory: 20.03GiB(42.17%)  tps: 2,780  tflops: 21.73  mfu: 6.96%
[rank0]:2025-10-27 19:11:16,623 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:11:16,623 - INFO -  step: 340  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,780  tflops: 21.73  mfu: 6.96%
[rank2]:2025-10-27 19:11:16,622 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:11:16,623 - INFO -  step: 340  loss: -4.0000  grad_norm:  0.0012  memory: 16.10GiB(33.90%)  tps: 2,780  tflops: 21.73  mfu: 6.96%
[rank3]:2025-10-27 19:11:19,033 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:11:19,036 - INFO -  step: 340  loss:  0.1593  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,779  tflops: 21.73  mfu: 6.96%
[rank3]:2025-10-27 19:11:20,188 - INFO - Avg. fwd time: 71.7860 / Avg. bwd time: 92.2186 / Avg. batch time: 1361.4232 (ms) / GPU bubble ratio: 3.63%
[rank0]:2025-10-27 19:11:20,272 - INFO - Avg. fwd time: 45.4383 / Avg. bwd time: 24.4595 / Avg. batch time: 1677.2094 (ms) / GPU bubble ratio: 66.66%
[rank2]:2025-10-27 19:11:20,223 - INFO - Avg. fwd time: 33.2524 / Avg. bwd time: 38.9575 / Avg. batch time: 1515.9495 (ms) / GPU bubble ratio: 61.89%
[rank1]:2025-10-27 19:11:20,267 - INFO - Avg. fwd time: 52.8757 / Avg. bwd time: 52.9889 / Avg. batch time: 1615.9814 (ms) / GPU bubble ratio: 47.59%
[rank0]:2025-10-27 19:11:45,677 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:11:45,676 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:11:45,677 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:11:48,089 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:12:09,668 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-27 19:12:15,119 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:12:15,119 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:12:15,119 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:12:17,666 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:12:44,855 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:12:44,854 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:12:44,855 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:12:47,356 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:13:13,988 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:13:13,988 - INFO - Freezing Ratio: [Stage0] 0.03, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:13:13,989 - INFO -  step: 360  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,792  tflops: 21.83  mfu: 7.00%
[rank2]:2025-10-27 19:13:13,988 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:13:13,988 - INFO -  step: 360  loss: -4.0000  grad_norm:  0.0005  memory: 16.10GiB(33.90%)  tps: 2,792  tflops: 21.83  mfu: 7.00%
[rank1]:2025-10-27 19:13:13,989 - INFO -  step: 360  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,792  tflops: 21.83  mfu: 7.00%
[rank3]:2025-10-27 19:13:16,410 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:13:16,413 - INFO -  step: 360  loss:  0.1191  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,792  tflops: 21.82  mfu: 7.00%
[rank3]:2025-10-27 19:13:18,084 - INFO - Avg. fwd time: 71.7383 / Avg. bwd time: 90.8523 / Avg. batch time: 1350.1725 (ms) / GPU bubble ratio: 3.66%
[rank2]:2025-10-27 19:13:18,142 - INFO - Avg. fwd time: 33.2440 / Avg. bwd time: 38.4278 / Avg. batch time: 1506.2817 (ms) / GPU bubble ratio: 61.93%
[rank1]:2025-10-27 19:13:18,214 - INFO - Avg. fwd time: 52.9129 / Avg. bwd time: 52.2375 / Avg. batch time: 1605.5561 (ms) / GPU bubble ratio: 47.61%
[rank0]:2025-10-27 19:13:18,277 - INFO - Avg. fwd time: 45.4074 / Avg. bwd time: 23.1427 / Avg. batch time: 1665.4051 (ms) / GPU bubble ratio: 67.07%
[rank1]:2025-10-27 19:13:56,128 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:13:56,140 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:13:56,124 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:13:58,550 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:14:25,926 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:14:25,926 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:14:25,926 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:14:28,380 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:14:54,891 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:14:54,892 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:14:54,892 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:14:57,416 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:15:24,568 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:15:24,568 - INFO -  step: 380  loss: -4.0000  grad_norm:  0.0010  memory: 20.89GiB(43.97%)  tps: 2,509  tflops: 19.62  mfu: 6.29%
[rank2]:2025-10-27 19:15:24,567 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:15:24,568 - INFO -  step: 380  loss: -4.0000  grad_norm:  0.0010  memory: 16.10GiB(33.90%)  tps: 2,509  tflops: 19.62  mfu: 6.29%
[rank1]:2025-10-27 19:15:24,567 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:15:24,568 - INFO -  step: 380  loss: -4.0000  grad_norm:  0.0010  memory: 20.03GiB(42.17%)  tps: 2,509  tflops: 19.62  mfu: 6.29%
[rank3]:2025-10-27 19:15:26,969 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:15:26,973 - INFO -  step: 380  loss:  0.1186  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,510  tflops: 19.62  mfu: 6.29%
[rank2]:2025-10-27 19:15:28,211 - INFO - Avg. fwd time: 33.2410 / Avg. bwd time: 38.2457 / Avg. batch time: 1504.1422 (ms) / GPU bubble ratio: 61.98%
[rank3]:2025-10-27 19:15:28,177 - INFO - Avg. fwd time: 71.7275 / Avg. bwd time: 90.3904 / Avg. batch time: 1346.3772 (ms) / GPU bubble ratio: 3.67%
[rank1]:2025-10-27 19:15:28,253 - INFO - Avg. fwd time: 52.9243 / Avg. bwd time: 51.9783 / Avg. batch time: 1603.1348 (ms) / GPU bubble ratio: 47.65%
[rank0]:2025-10-27 19:15:28,259 - INFO - Avg. fwd time: 45.4233 / Avg. bwd time: 22.7405 / Avg. batch time: 1662.5797 (ms) / GPU bubble ratio: 67.20%
[rank0]:2025-10-27 19:15:54,527 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:15:54,526 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:15:54,527 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:15:56,908 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:16:23,687 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:16:23,688 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:16:23,687 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:16:26,151 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:16:53,091 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:16:53,091 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:16:53,091 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:16:55,556 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:17:17,471 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-27 19:17:23,004 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:17:23,005 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.0009  memory: 20.03GiB(42.17%)  tps: 2,767  tflops: 21.63  mfu: 6.93%
[rank1]:2025-10-27 19:17:23,005 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-10-27 19:17:23,004 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:17:23,004 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,767  tflops: 21.63  mfu: 6.93%
[rank0]:2025-10-27 19:17:23,004 - INFO - ðŸ”Ž  Running validation at step 400
[rank2]:2025-10-27 19:17:23,003 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:17:23,004 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.0009  memory: 16.10GiB(33.90%)  tps: 2,767  tflops: 21.63  mfu: 6.93%
[rank2]:2025-10-27 19:17:23,004 - INFO - ðŸ”Ž  Running validation at step 400
[rank3]:2025-10-27 19:17:25,408 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:17:25,412 - INFO -  step: 400  loss:  0.1132  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,767  tflops: 21.63  mfu: 6.93%
[rank3]:2025-10-27 19:17:25,412 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-10-27 19:18:33,827 - INFO - validate step: 400  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,784
[rank1]:2025-10-27 19:18:33,908 - INFO - validate step: 400  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,777
[rank2]:2025-10-27 19:18:33,989 - INFO - validate step: 400  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,770
[rank3]:2025-10-27 19:18:34,068 - INFO - validate step: 400  loss:  0.2938  memory: 38.93GiB(81.95%)  tps: 5,966
[rank2]:2025-10-27 19:18:34,156 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1027_GPipe_apf_dm1/freeze_ratio_history/rank2/251027_1918_stage2_step400.svg
[rank1]:2025-10-27 19:18:34,151 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1027_GPipe_apf_dm1/freeze_ratio_history/rank1/251027_1918_stage1_step400.svg
[rank0]:2025-10-27 19:18:34,150 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1027_GPipe_apf_dm1/freeze_ratio_history/rank0/251027_1918_stage0_step400.svg
[rank3]:2025-10-27 19:18:34,256 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1027_GPipe_apf_dm1/pipeline_schedule/251027_1918_real_step400_rank3.svg
[rank3]:> Batch Time: 1311.81 ms, GPU Bubble Ratio: 72.09%, 42.92%, 62.10%, 14.10%
[rank3]:2025-10-27 19:18:34,328 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1027_GPipe_apf_dm1/freeze_ratio_history/rank3/251027_1918_stage3_step400.svg
[rank2]:2025-10-27 19:18:35,583 - INFO - Avg. fwd time: 33.2427 / Avg. bwd time: 37.7860 / Avg. batch time: 1494.9401 (ms) / GPU bubble ratio: 61.99%
[rank3]:2025-10-27 19:18:35,548 - INFO - Avg. fwd time: 71.7614 / Avg. bwd time: 89.2423 / Avg. batch time: 1337.4280 (ms) / GPU bubble ratio: 3.69%
[rank0]:2025-10-27 19:18:35,635 - INFO - Avg. fwd time: 45.4158 / Avg. bwd time: 21.6075 / Avg. batch time: 1651.5880 (ms) / GPU bubble ratio: 67.54%
[rank1]:2025-10-27 19:18:35,626 - INFO - Avg. fwd time: 52.9617 / Avg. bwd time: 51.3297 / Avg. batch time: 1593.3154 (ms) / GPU bubble ratio: 47.64%
[rank0]:2025-10-27 19:19:01,552 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:19:01,552 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:19:01,552 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:19:04,158 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:19:31,017 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:19:31,016 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:19:31,017 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:19:33,543 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:20:00,758 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:20:00,758 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:20:00,758 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:20:03,325 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:20:43,028 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:20:43,029 - INFO -  step: 420  loss: -4.0000  grad_norm:  0.1790  memory: 16.10GiB(33.90%)  tps: 2,539  tflops: 19.85  mfu: 6.36%
[rank1]:2025-10-27 19:20:43,032 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:20:43,032 - INFO -  step: 420  loss: -4.0000  grad_norm:  0.1790  memory: 20.03GiB(42.17%)  tps: 2,538  tflops: 19.84  mfu: 6.36%
[rank0]:2025-10-27 19:20:43,053 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:20:43,053 - INFO -  step: 420  loss: -4.0000  grad_norm:  0.1790  memory: 20.89GiB(43.97%)  tps: 2,536  tflops: 19.82  mfu: 6.35%
[rank3]:2025-10-27 19:20:45,450 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:20:45,455 - INFO -  step: 420  loss:  0.1374  grad_norm:  0.1790  memory: 38.93GiB(81.95%)  tps: 2,494  tflops: 19.50  mfu: 6.25%
[rank2]:2025-10-27 19:20:46,660 - INFO - Avg. fwd time: 33.2389 / Avg. bwd time: 37.6722 / Avg. batch time: 1494.1362 (ms) / GPU bubble ratio: 62.03%
[rank3]:2025-10-27 19:20:46,625 - INFO - Avg. fwd time: 71.7669 / Avg. bwd time: 88.9403 / Avg. batch time: 1334.9877 (ms) / GPU bubble ratio: 3.70%
[rank0]:2025-10-27 19:20:46,709 - INFO - Avg. fwd time: 45.4181 / Avg. bwd time: 21.3535 / Avg. batch time: 1650.3436 (ms) / GPU bubble ratio: 67.63%
[rank1]:2025-10-27 19:20:46,704 - INFO - Avg. fwd time: 52.9539 / Avg. bwd time: 51.1678 / Avg. batch time: 1592.3421 (ms) / GPU bubble ratio: 47.69%
[rank1]:2025-10-27 19:21:12,300 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:21:12,300 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:21:12,300 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:21:14,711 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:21:42,025 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:21:42,025 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:21:42,025 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:21:44,560 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:22:11,928 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:22:11,927 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:22:11,927 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:22:14,507 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:22:41,214 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:22:41,214 - INFO -  step: 440  loss: -4.0000  grad_norm:  0.0014  memory: 16.10GiB(33.90%)  tps: 2,773  tflops: 21.67  mfu: 6.95%
[rank1]:2025-10-27 19:22:41,214 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:22:41,215 - INFO -  step: 440  loss: -4.0000  grad_norm:  0.0014  memory: 20.03GiB(42.17%)  tps: 2,773  tflops: 21.68  mfu: 6.95%
[rank0]:2025-10-27 19:22:41,215 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:22:41,215 - INFO -  step: 440  loss: -4.0000  grad_norm:  0.0014  memory: 20.89GiB(43.97%)  tps: 2,773  tflops: 21.68  mfu: 6.95%
[rank3]:2025-10-27 19:22:43,626 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:22:43,630 - INFO -  step: 440  loss:  0.1347  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,773  tflops: 21.68  mfu: 6.95%
[rank2]:2025-10-27 19:22:44,821 - INFO - Avg. fwd time: 33.2398 / Avg. bwd time: 37.2863 / Avg. batch time: 1487.1878 (ms) / GPU bubble ratio: 62.06%
[rank3]:2025-10-27 19:22:44,785 - INFO - Avg. fwd time: 71.7572 / Avg. bwd time: 87.9447 / Avg. batch time: 1326.9303 (ms) / GPU bubble ratio: 3.72%
[rank1]:2025-10-27 19:22:44,865 - INFO - Avg. fwd time: 52.9550 / Avg. bwd time: 50.6151 / Avg. batch time: 1584.8474 (ms) / GPU bubble ratio: 47.72%
[rank0]:2025-10-27 19:22:44,875 - INFO - Avg. fwd time: 45.4315 / Avg. bwd time: 20.5574 / Avg. batch time: 1642.0104 (ms) / GPU bubble ratio: 67.85%
[rank2]:2025-10-27 19:23:10,901 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:23:10,901 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:23:10,901 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:23:13,311 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:23:35,406 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-27 19:23:40,817 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:23:40,816 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:23:40,816 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:23:43,348 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:24:10,186 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:24:10,186 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:24:10,187 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:24:12,768 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:24:39,894 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:24:39,894 - INFO -  step: 460  loss: -4.0000  grad_norm:  0.0010  memory: 20.89GiB(43.97%)  tps: 2,761  tflops: 21.58  mfu: 6.92%
[rank2]:2025-10-27 19:24:39,893 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:24:39,894 - INFO -  step: 460  loss: -4.0000  grad_norm:  0.0010  memory: 16.10GiB(33.90%)  tps: 2,761  tflops: 21.58  mfu: 6.92%
[rank1]:2025-10-27 19:24:39,893 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:24:39,894 - INFO -  step: 460  loss: -4.0000  grad_norm:  0.0010  memory: 20.03GiB(42.17%)  tps: 2,761  tflops: 21.58  mfu: 6.92%
[rank3]:2025-10-27 19:24:42,303 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:24:42,307 - INFO -  step: 460  loss:  0.1124  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,761  tflops: 21.59  mfu: 6.92%
[rank3]:2025-10-27 19:24:43,472 - INFO - Avg. fwd time: 71.7601 / Avg. bwd time: 87.0476 / Avg. batch time: 1319.7887 (ms) / GPU bubble ratio: 3.74%
[rank2]:2025-10-27 19:24:43,507 - INFO - Avg. fwd time: 33.2418 / Avg. bwd time: 36.9336 / Avg. batch time: 1481.0539 (ms) / GPU bubble ratio: 62.09%
[rank1]:2025-10-27 19:24:43,552 - INFO - Avg. fwd time: 52.9701 / Avg. bwd time: 50.1112 / Avg. batch time: 1578.2313 (ms) / GPU bubble ratio: 47.75%
[rank0]:2025-10-27 19:24:43,563 - INFO - Avg. fwd time: 45.4171 / Avg. bwd time: 19.8825 / Avg. batch time: 1634.6822 (ms) / GPU bubble ratio: 68.04%
[rank2]:2025-10-27 19:25:09,853 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:25:09,853 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:25:09,853 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:25:12,262 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:25:38,977 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:25:38,976 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:25:38,976 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:25:41,514 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:26:08,449 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:26:08,449 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:26:08,450 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:26:11,036 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:26:50,789 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:26:50,789 - INFO -  step: 480  loss: -4.0000  grad_norm:  0.1417  memory: 16.10GiB(33.90%)  tps: 2,503  tflops: 19.57  mfu: 6.27%
[rank1]:2025-10-27 19:26:50,793 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:26:50,793 - INFO -  step: 480  loss: -4.0000  grad_norm:  0.1417  memory: 20.03GiB(42.17%)  tps: 2,503  tflops: 19.57  mfu: 6.27%
[rank0]:2025-10-27 19:26:50,807 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:26:50,808 - INFO -  step: 480  loss: -4.0000  grad_norm:  0.1417  memory: 20.89GiB(43.97%)  tps: 2,503  tflops: 19.57  mfu: 6.27%
[rank3]:2025-10-27 19:26:53,218 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:26:53,222 - INFO -  step: 480  loss:  0.1234  grad_norm:  0.1417  memory: 38.93GiB(81.95%)  tps: 2,503  tflops: 19.57  mfu: 6.27%
[rank2]:2025-10-27 19:26:54,453 - INFO - Avg. fwd time: 33.2397 / Avg. bwd time: 36.8669 / Avg. batch time: 1480.7386 (ms) / GPU bubble ratio: 62.12%
[rank3]:2025-10-27 19:26:54,419 - INFO - Avg. fwd time: 71.7408 / Avg. bwd time: 86.8750 / Avg. batch time: 1318.2958 (ms) / GPU bubble ratio: 3.74%
[rank1]:2025-10-27 19:26:54,498 - INFO - Avg. fwd time: 52.9886 / Avg. bwd time: 50.0122 / Avg. batch time: 1577.8211 (ms) / GPU bubble ratio: 47.78%
[rank0]:2025-10-27 19:26:54,508 - INFO - Avg. fwd time: 45.4107 / Avg. bwd time: 19.8358 / Avg. batch time: 1634.2318 (ms) / GPU bubble ratio: 68.06%
[rank2]:2025-10-27 19:27:20,064 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:27:20,064 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:27:20,064 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:27:22,567 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:27:49,412 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:27:49,412 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:27:49,412 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:27:51,830 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:28:19,143 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:28:19,143 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:28:19,144 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:28:21,558 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:28:43,212 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-27 19:28:48,570 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:28:48,571 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.0009  memory: 16.10GiB(33.90%)  tps: 2,782  tflops: 21.75  mfu: 6.97%
[rank2]:2025-10-27 19:28:48,578 - INFO - ðŸ”Ž  Running validation at step 500
[rank1]:2025-10-27 19:28:48,570 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:28:48,579 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.0009  memory: 20.03GiB(42.17%)  tps: 2,782  tflops: 21.75  mfu: 6.97%
[rank1]:2025-10-27 19:28:48,579 - INFO - ðŸ”Ž  Running validation at step 500
[rank0]:2025-10-27 19:28:48,571 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:28:48,579 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.0009  memory: 20.89GiB(43.97%)  tps: 2,782  tflops: 21.75  mfu: 6.97%
[rank0]:2025-10-27 19:28:48,579 - INFO - ðŸ”Ž  Running validation at step 500
[rank3]:2025-10-27 19:28:51,098 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:28:51,101 - INFO -  step: 500  loss:  0.1031  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,780  tflops: 21.73  mfu: 6.97%
[rank3]:2025-10-27 19:28:51,101 - INFO - ðŸ”Ž  Running validation at step 500
[rank0]:2025-10-27 19:29:59,363 - INFO - validate step: 500  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,787
[rank0]:2025-10-27 19:29:59,364 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-27 19:29:59,368 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank1]:2025-10-27 19:29:59,448 - INFO - validate step: 500  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,780
[rank1]:2025-10-27 19:29:59,449 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-27 19:29:59,530 - INFO - validate step: 500  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,773
[rank2]:2025-10-27 19:29:59,530 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-27 19:29:59,611 - INFO - validate step: 500  loss:  0.2912  memory: 38.93GiB(81.95%)  tps: 5,979
[rank3]:2025-10-27 19:29:59,612 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-27 19:30:01,590 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 2.06 seconds.
[rank1]:2025-10-27 19:30:01,991 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 2.54 seconds.
[rank3]:2025-10-27 19:30:02,966 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.35 seconds.
[rank0]:2025-10-27 19:30:03,096 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-27 19:30:03,104 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.74 seconds.
[rank2]:2025-10-27 19:30:03,183 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1027_GPipe_apf_dm1/freeze_ratio_history/rank2/251027_1930_stage2_step500.svg
[rank1]:2025-10-27 19:30:03,184 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1027_GPipe_apf_dm1/freeze_ratio_history/rank1/251027_1930_stage1_step500.svg
[rank0]:2025-10-27 19:30:03,293 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1027_GPipe_apf_dm1/freeze_ratio_history/rank0/251027_1930_stage0_step500.svg
[rank3]:2025-10-27 19:30:03,419 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1027_GPipe_apf_dm1/pipeline_schedule/251027_1930_real_step500_rank3.svg
[rank3]:> Batch Time: 1312.84 ms, GPU Bubble Ratio: 69.08%, 43.20%, 62.18%, 14.40%
[rank3]:2025-10-27 19:30:03,486 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1027_GPipe_apf_dm1/freeze_ratio_history/rank3/251027_1930_stage3_step500.svg
[rank3]:2025-10-27 19:30:04,669 - INFO - Avg. fwd time: 71.7087 / Avg. bwd time: 86.0784 / Avg. batch time: 1311.7118 (ms) / GPU bubble ratio: 3.77%
[rank2]:2025-10-27 19:30:04,705 - INFO - Avg. fwd time: 33.2341 / Avg. bwd time: 36.5584 / Avg. batch time: 1473.7661 (ms) / GPU bubble ratio: 62.11%
[rank1]:2025-10-27 19:30:04,748 - INFO - Avg. fwd time: 53.0026 / Avg. bwd time: 49.5716 / Avg. batch time: 1570.4187 (ms) / GPU bubble ratio: 47.75%
[rank0]:2025-10-27 19:30:04,759 - INFO - Avg. fwd time: 45.4157 / Avg. bwd time: 19.2437 / Avg. batch time: 1626.2074 (ms) / GPU bubble ratio: 68.19%
[rank0]:2025-10-27 19:30:30,577 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:30:30,576 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:30:30,576 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:30:33,513 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:31:00,875 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:31:00,876 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:31:00,875 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:31:03,741 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:31:31,177 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:31:31,177 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:31:31,178 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:31:33,977 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:32:00,817 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:32:00,818 - INFO -  step: 520  loss: -4.0000  grad_norm:  0.0010  memory: 20.03GiB(42.17%)  tps: 2,700  tflops: 21.11  mfu: 6.76%
[rank0]:2025-10-27 19:32:00,818 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:32:00,819 - INFO -  step: 520  loss: -4.0000  grad_norm:  0.0010  memory: 20.89GiB(43.97%)  tps: 2,698  tflops: 21.09  mfu: 6.76%
[rank2]:2025-10-27 19:32:00,817 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:32:00,818 - INFO -  step: 520  loss: -4.0000  grad_norm:  0.0010  memory: 16.10GiB(33.90%)  tps: 2,702  tflops: 21.12  mfu: 6.77%
[rank3]:2025-10-27 19:32:03,276 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:32:03,281 - INFO -  step: 520  loss:  0.1414  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,650  tflops: 20.71  mfu: 6.64%
[rank2]:2025-10-27 19:32:04,496 - INFO - Avg. fwd time: 33.2302 / Avg. bwd time: 36.2763 / Avg. batch time: 1469.3572 (ms) / GPU bubble ratio: 62.16%
[rank3]:2025-10-27 19:32:04,461 - INFO - Avg. fwd time: 71.7044 / Avg. bwd time: 85.3594 / Avg. batch time: 1305.9439 (ms) / GPU bubble ratio: 3.79%
[rank1]:2025-10-27 19:32:04,539 - INFO - Avg. fwd time: 53.0259 / Avg. bwd time: 49.1694 / Avg. batch time: 1565.6267 (ms) / GPU bubble ratio: 47.78%
[rank0]:2025-10-27 19:32:04,549 - INFO - Avg. fwd time: 45.4090 / Avg. bwd time: 18.6975 / Avg. batch time: 1620.8390 (ms) / GPU bubble ratio: 68.36%
[rank1]:2025-10-27 19:32:30,588 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:32:30,589 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:32:30,588 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:32:33,146 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:33:00,517 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:33:00,517 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:33:00,517 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:33:03,057 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:33:29,708 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:33:29,708 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:33:29,709 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:33:32,346 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:33:59,367 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:33:59,368 - INFO -  step: 540  loss: -4.0000  grad_norm:  0.0012  memory: 20.03GiB(42.17%)  tps: 2,764  tflops: 21.61  mfu: 6.93%
[rank0]:2025-10-27 19:33:59,368 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:33:59,369 - INFO -  step: 540  loss: -4.0000  grad_norm:  0.0012  memory: 20.89GiB(43.97%)  tps: 2,764  tflops: 21.61  mfu: 6.93%
[rank2]:2025-10-27 19:33:59,367 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:33:59,368 - INFO -  step: 540  loss: -4.0000  grad_norm:  0.0012  memory: 16.10GiB(33.90%)  tps: 2,764  tflops: 21.61  mfu: 6.93%
[rank3]:2025-10-27 19:34:01,958 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:34:01,962 - INFO -  step: 540  loss:  0.1413  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,761  tflops: 21.58  mfu: 6.92%
[rank3]:2025-10-27 19:34:03,639 - INFO - Avg. fwd time: 71.7012 / Avg. bwd time: 84.7095 / Avg. batch time: 1300.6953 (ms) / GPU bubble ratio: 3.80%
[rank2]:2025-10-27 19:34:03,699 - INFO - Avg. fwd time: 33.2315 / Avg. bwd time: 36.0237 / Avg. batch time: 1465.0356 (ms) / GPU bubble ratio: 62.18%
[rank1]:2025-10-27 19:34:03,784 - INFO - Avg. fwd time: 53.0281 / Avg. bwd time: 48.8058 / Avg. batch time: 1560.9611 (ms) / GPU bubble ratio: 47.81%
[rank0]:2025-10-27 19:34:03,851 - INFO - Avg. fwd time: 45.3840 / Avg. bwd time: 18.2160 / Avg. batch time: 1615.6620 (ms) / GPU bubble ratio: 68.51%
[rank1]:2025-10-27 19:34:41,953 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:34:41,967 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:34:41,953 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:34:44,606 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:35:06,118 - INFO - [GC] Peforming periodical GC collection 0.28 seconds
[rank1]:2025-10-27 19:35:11,493 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:35:11,494 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:35:11,493 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:35:14,149 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:35:40,984 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:35:40,984 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:35:40,985 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:35:43,537 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:36:10,910 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:36:10,910 - INFO -  step: 560  loss: -4.0000  grad_norm:  0.0012  memory: 20.89GiB(43.97%)  tps: 2,491  tflops: 19.47  mfu: 6.24%
[rank2]:2025-10-27 19:36:10,909 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:36:10,909 - INFO -  step: 560  loss: -4.0000  grad_norm:  0.0012  memory: 16.10GiB(33.90%)  tps: 2,491  tflops: 19.47  mfu: 6.24%
[rank1]:2025-10-27 19:36:10,909 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:36:10,909 - INFO -  step: 560  loss: -4.0000  grad_norm:  0.0012  memory: 20.03GiB(42.17%)  tps: 2,491  tflops: 19.47  mfu: 6.24%
[rank3]:2025-10-27 19:36:13,387 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:36:13,391 - INFO -  step: 560  loss:  0.1399  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,493  tflops: 19.49  mfu: 6.25%
[rank2]:2025-10-27 19:36:14,617 - INFO - Avg. fwd time: 33.2290 / Avg. bwd time: 35.9872 / Avg. batch time: 1465.1971 (ms) / GPU bubble ratio: 62.21%
[rank3]:2025-10-27 19:36:14,582 - INFO - Avg. fwd time: 71.6940 / Avg. bwd time: 84.6082 / Avg. batch time: 1299.8045 (ms) / GPU bubble ratio: 3.80%
[rank1]:2025-10-27 19:36:14,662 - INFO - Avg. fwd time: 53.0325 / Avg. bwd time: 48.7576 / Avg. batch time: 1561.0803 (ms) / GPU bubble ratio: 47.84%
[rank0]:2025-10-27 19:36:14,672 - INFO - Avg. fwd time: 45.3785 / Avg. bwd time: 18.2125 / Avg. batch time: 1615.7710 (ms) / GPU bubble ratio: 68.51%
[rank2]:2025-10-27 19:36:40,462 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:36:40,462 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:36:40,462 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:36:43,063 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:37:09,918 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:37:09,919 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:37:09,918 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:37:12,392 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:37:39,648 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:37:39,648 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:37:39,649 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:37:42,199 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:38:09,262 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:38:09,263 - INFO -  step: 580  loss: -4.0000  grad_norm:  0.0012  memory: 20.89GiB(43.97%)  tps: 2,769  tflops: 21.64  mfu: 6.94%
[rank2]:2025-10-27 19:38:09,261 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:38:09,262 - INFO -  step: 580  loss: -4.0000  grad_norm:  0.0012  memory: 16.10GiB(33.90%)  tps: 2,769  tflops: 21.64  mfu: 6.94%
[rank1]:2025-10-27 19:38:09,261 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:38:09,262 - INFO -  step: 580  loss: -4.0000  grad_norm:  0.0012  memory: 20.03GiB(42.17%)  tps: 2,769  tflops: 21.64  mfu: 6.94%
[rank3]:2025-10-27 19:38:11,726 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:38:11,729 - INFO -  step: 580  loss:  0.1211  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,769  tflops: 21.65  mfu: 6.94%
[rank3]:2025-10-27 19:38:12,881 - INFO - Avg. fwd time: 71.6823 / Avg. bwd time: 83.9987 / Avg. batch time: 1294.8523 (ms) / GPU bubble ratio: 3.82%
[rank0]:2025-10-27 19:38:12,974 - INFO - Avg. fwd time: 45.3604 / Avg. bwd time: 17.7578 / Avg. batch time: 1610.7035 (ms) / GPU bubble ratio: 68.65%
[rank2]:2025-10-27 19:38:12,919 - INFO - Avg. fwd time: 33.2254 / Avg. bwd time: 35.7493 / Avg. batch time: 1460.9280 (ms) / GPU bubble ratio: 62.23%
[rank1]:2025-10-27 19:38:12,963 - INFO - Avg. fwd time: 53.0489 / Avg. bwd time: 48.4168 / Avg. batch time: 1556.4930 (ms) / GPU bubble ratio: 47.85%
[rank1]:2025-10-27 19:38:38,548 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:38:38,549 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:38:38,548 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:38:41,012 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:39:08,220 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:39:08,221 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:39:08,220 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:39:10,853 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:39:38,056 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:39:38,057 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:39:38,056 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:39:40,691 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:40:02,055 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-27 19:40:07,470 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:40:07,470 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0011  memory: 20.03GiB(42.17%)  tps: 2,772  tflops: 21.67  mfu: 6.95%
[rank1]:2025-10-27 19:40:07,470 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-10-27 19:40:07,470 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:40:07,471 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0011  memory: 20.89GiB(43.97%)  tps: 2,772  tflops: 21.67  mfu: 6.95%
[rank0]:2025-10-27 19:40:07,471 - INFO - ðŸ”Ž  Running validation at step 600
[rank2]:2025-10-27 19:40:07,470 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:40:07,470 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0011  memory: 16.10GiB(33.90%)  tps: 2,772  tflops: 21.67  mfu: 6.95%
[rank2]:2025-10-27 19:40:07,470 - INFO - ðŸ”Ž  Running validation at step 600
[rank3]:2025-10-27 19:40:09,947 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:40:09,951 - INFO -  step: 600  loss:  0.1272  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,772  tflops: 21.67  mfu: 6.95%
[rank3]:2025-10-27 19:40:09,951 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-10-27 19:41:18,215 - INFO - validate step: 600  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,790
[rank1]:2025-10-27 19:41:18,293 - INFO - validate step: 600  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,783
[rank2]:2025-10-27 19:41:18,374 - INFO - validate step: 600  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,777
[rank3]:2025-10-27 19:41:18,457 - INFO - validate step: 600  loss:  0.2926  memory: 38.93GiB(81.95%)  tps: 5,979
[rank1]:2025-10-27 19:41:18,554 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1027_GPipe_apf_dm1/freeze_ratio_history/rank1/251027_1941_stage1_step600.svg
[rank0]:2025-10-27 19:41:18,549 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1027_GPipe_apf_dm1/freeze_ratio_history/rank0/251027_1941_stage0_step600.svg
[rank2]:2025-10-27 19:41:18,554 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1027_GPipe_apf_dm1/freeze_ratio_history/rank2/251027_1941_stage2_step600.svg
[rank3]:2025-10-27 19:41:18,652 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1027_GPipe_apf_dm1/pipeline_schedule/251027_1941_real_step600_rank3.svg
[rank3]:> Batch Time: 1310.07 ms, GPU Bubble Ratio: 69.05%, 43.22%, 62.13%, 14.37%
[rank3]:2025-10-27 19:41:18,737 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1027_GPipe_apf_dm1/freeze_ratio_history/rank3/251027_1941_stage3_step600.svg
[rank3]:2025-10-27 19:41:19,865 - INFO - Avg. fwd time: 71.6634 / Avg. bwd time: 83.4277 / Avg. batch time: 1290.1651 (ms) / GPU bubble ratio: 3.83%
[rank2]:2025-10-27 19:41:19,900 - INFO - Avg. fwd time: 33.2274 / Avg. bwd time: 35.5291 / Avg. batch time: 1455.9809 (ms) / GPU bubble ratio: 62.22%
[rank1]:2025-10-27 19:41:19,944 - INFO - Avg. fwd time: 53.0591 / Avg. bwd time: 48.0999 / Avg. batch time: 1551.2167 (ms) / GPU bubble ratio: 47.83%
[rank0]:2025-10-27 19:41:19,955 - INFO - Avg. fwd time: 45.3502 / Avg. bwd time: 17.3333 / Avg. batch time: 1604.9775 (ms) / GPU bubble ratio: 68.76%
[rank1]:2025-10-27 19:41:46,138 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:41:46,139 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:41:46,138 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:41:48,770 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:42:16,264 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:42:16,265 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:42:16,264 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:42:18,853 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:42:58,020 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:42:58,039 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:42:58,016 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:43:00,656 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:43:27,703 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:43:27,704 - INFO -  step: 620  loss: -4.0000  grad_norm:  0.0013  memory: 16.10GiB(33.90%)  tps: 2,534  tflops: 19.81  mfu: 6.35%
[rank1]:2025-10-27 19:43:27,703 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:43:27,704 - INFO -  step: 620  loss: -4.0000  grad_norm:  0.0013  memory: 20.03GiB(42.17%)  tps: 2,532  tflops: 19.79  mfu: 6.34%
[rank0]:2025-10-27 19:43:27,704 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:43:27,704 - INFO -  step: 620  loss: -4.0000  grad_norm:  0.0013  memory: 20.89GiB(43.97%)  tps: 2,531  tflops: 19.78  mfu: 6.34%
[rank3]:2025-10-27 19:43:30,185 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:43:30,189 - INFO -  step: 620  loss:  0.1569  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,488  tflops: 19.45  mfu: 6.23%
[rank3]:2025-10-27 19:43:31,361 - INFO - Avg. fwd time: 71.6724 / Avg. bwd time: 83.4062 / Avg. batch time: 1290.0390 (ms) / GPU bubble ratio: 3.83%
[rank2]:2025-10-27 19:43:31,397 - INFO - Avg. fwd time: 33.2247 / Avg. bwd time: 35.5243 / Avg. batch time: 1456.7660 (ms) / GPU bubble ratio: 62.25%
[rank1]:2025-10-27 19:43:31,440 - INFO - Avg. fwd time: 53.0448 / Avg. bwd time: 48.0933 / Avg. batch time: 1551.9882 (ms) / GPU bubble ratio: 47.87%
[rank0]:2025-10-27 19:43:31,451 - INFO - Avg. fwd time: 45.3552 / Avg. bwd time: 17.3817 / Avg. batch time: 1605.8011 (ms) / GPU bubble ratio: 68.74%
[rank1]:2025-10-27 19:43:57,614 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:43:57,615 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:43:57,614 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:44:00,128 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:44:26,927 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:44:26,927 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:44:26,927 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:44:29,407 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:44:56,356 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:44:56,357 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:44:56,356 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:44:58,835 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:45:26,145 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:45:26,146 - INFO -  step: 640  loss: -4.0000  grad_norm:  0.0010  memory: 20.89GiB(43.97%)  tps: 2,767  tflops: 21.63  mfu: 6.93%
[rank2]:2025-10-27 19:45:26,145 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:45:26,145 - INFO -  step: 640  loss: -4.0000  grad_norm:  0.0010  memory: 16.10GiB(33.90%)  tps: 2,767  tflops: 21.63  mfu: 6.93%
[rank1]:2025-10-27 19:45:26,145 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:45:26,145 - INFO -  step: 640  loss: -4.0000  grad_norm:  0.0010  memory: 20.03GiB(42.17%)  tps: 2,767  tflops: 21.63  mfu: 6.93%
[rank3]:2025-10-27 19:45:28,789 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:45:28,792 - INFO -  step: 640  loss:  0.1154  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,763  tflops: 21.60  mfu: 6.92%
[rank3]:2025-10-27 19:45:29,992 - INFO - Avg. fwd time: 71.6698 / Avg. bwd time: 82.8990 / Avg. batch time: 1285.9847 (ms) / GPU bubble ratio: 3.84%
[rank2]:2025-10-27 19:45:30,028 - INFO - Avg. fwd time: 33.2214 / Avg. bwd time: 35.3215 / Avg. batch time: 1453.3008 (ms) / GPU bubble ratio: 62.27%
[rank1]:2025-10-27 19:45:30,073 - INFO - Avg. fwd time: 53.0570 / Avg. bwd time: 47.8047 / Avg. batch time: 1548.2419 (ms) / GPU bubble ratio: 47.88%
[rank0]:2025-10-27 19:45:30,085 - INFO - Avg. fwd time: 45.3394 / Avg. bwd time: 16.9953 / Avg. batch time: 1601.6496 (ms) / GPU bubble ratio: 68.86%
[rank2]:2025-10-27 19:45:55,814 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:45:55,814 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:45:55,814 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:45:58,418 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:46:19,967 - INFO - [GC] Peforming periodical GC collection 0.02 seconds
[rank0]:2025-10-27 19:46:25,430 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:46:25,429 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:46:25,429 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:46:27,906 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:46:55,300 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:46:55,301 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:46:55,300 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:46:57,808 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:47:25,014 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:47:25,014 - INFO -  step: 660  loss: -4.0000  grad_norm:  0.0014  memory: 20.89GiB(43.97%)  tps: 2,757  tflops: 21.55  mfu: 6.91%
[rank2]:2025-10-27 19:47:25,013 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:47:25,013 - INFO -  step: 660  loss: -4.0000  grad_norm:  0.0014  memory: 16.10GiB(33.90%)  tps: 2,757  tflops: 21.55  mfu: 6.91%
[rank1]:2025-10-27 19:47:25,013 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:47:25,014 - INFO -  step: 660  loss: -4.0000  grad_norm:  0.0014  memory: 20.03GiB(42.17%)  tps: 2,757  tflops: 21.55  mfu: 6.91%
[rank3]:2025-10-27 19:47:27,618 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:47:27,621 - INFO -  step: 660  loss:  0.1211  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,758  tflops: 21.56  mfu: 6.91%
[rank2]:2025-10-27 19:47:28,833 - INFO - Avg. fwd time: 33.2191 / Avg. bwd time: 35.1347 / Avg. batch time: 1450.0886 (ms) / GPU bubble ratio: 62.29%
[rank1]:2025-10-27 19:47:28,884 - INFO - Avg. fwd time: 53.0634 / Avg. bwd time: 47.5395 / Avg. batch time: 1544.7847 (ms) / GPU bubble ratio: 47.90%
[rank3]:2025-10-27 19:47:28,797 - INFO - Avg. fwd time: 71.6751 / Avg. bwd time: 82.4209 / Avg. batch time: 1282.1882 (ms) / GPU bubble ratio: 3.85%
[rank0]:2025-10-27 19:47:28,896 - INFO - Avg. fwd time: 45.3244 / Avg. bwd time: 16.6327 / Avg. batch time: 1597.8070 (ms) / GPU bubble ratio: 68.98%
[rank2]:2025-10-27 19:47:54,564 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:47:54,564 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:47:54,564 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:47:57,161 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:48:24,475 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:48:24,475 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:48:24,475 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:48:26,943 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:48:54,189 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:48:54,190 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:48:54,189 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:48:56,662 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:49:23,364 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:49:23,364 - INFO -  step: 680  loss: -4.0000  grad_norm:  0.0010  memory: 20.89GiB(43.97%)  tps: 2,769  tflops: 21.64  mfu: 6.94%
[rank2]:2025-10-27 19:49:23,363 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:49:23,364 - INFO -  step: 680  loss: -4.0000  grad_norm:  0.0010  memory: 16.10GiB(33.90%)  tps: 2,769  tflops: 21.64  mfu: 6.94%
[rank1]:2025-10-27 19:49:23,363 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:49:23,364 - INFO -  step: 680  loss: -4.0000  grad_norm:  0.0010  memory: 20.03GiB(42.17%)  tps: 2,769  tflops: 21.64  mfu: 6.94%
[rank3]:2025-10-27 19:49:25,927 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:49:25,930 - INFO -  step: 680  loss:  0.1320  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,770  tflops: 21.65  mfu: 6.94%
[rank3]:2025-10-27 19:49:27,083 - INFO - Avg. fwd time: 71.6637 / Avg. bwd time: 81.9649 / Avg. batch time: 1278.4685 (ms) / GPU bubble ratio: 3.87%
[rank2]:2025-10-27 19:49:27,119 - INFO - Avg. fwd time: 33.2169 / Avg. bwd time: 34.9599 / Avg. batch time: 1446.8913 (ms) / GPU bubble ratio: 62.30%
[rank1]:2025-10-27 19:49:27,166 - INFO - Avg. fwd time: 53.0809 / Avg. bwd time: 47.2878 / Avg. batch time: 1541.3424 (ms) / GPU bubble ratio: 47.91%
[rank0]:2025-10-27 19:49:27,178 - INFO - Avg. fwd time: 45.3089 / Avg. bwd time: 16.2914 / Avg. batch time: 1594.0009 (ms) / GPU bubble ratio: 69.08%
[rank2]:2025-10-27 19:49:53,024 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:49:53,024 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:49:53,025 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:49:55,604 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:50:35,556 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:50:35,532 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:50:35,535 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:50:37,990 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:51:04,614 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:51:04,614 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:51:04,615 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:51:07,180 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:51:28,757 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-27 19:51:34,196 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:51:34,196 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0011  memory: 20.89GiB(43.97%)  tps: 2,505  tflops: 19.58  mfu: 6.28%
[rank0]:2025-10-27 19:51:34,197 - INFO - ðŸ”Ž  Running validation at step 700
[rank2]:2025-10-27 19:51:34,195 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:51:34,196 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0011  memory: 16.10GiB(33.90%)  tps: 2,505  tflops: 19.58  mfu: 6.28%
[rank2]:2025-10-27 19:51:34,196 - INFO - ðŸ”Ž  Running validation at step 700
[rank1]:2025-10-27 19:51:34,195 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:51:34,196 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0011  memory: 20.03GiB(42.17%)  tps: 2,505  tflops: 19.58  mfu: 6.28%
[rank1]:2025-10-27 19:51:34,196 - INFO - ðŸ”Ž  Running validation at step 700
[rank3]:2025-10-27 19:51:36,632 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:51:36,635 - INFO -  step: 700  loss:  0.1204  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,507  tflops: 19.60  mfu: 6.28%
[rank3]:2025-10-27 19:51:36,636 - INFO - ðŸ”Ž  Running validation at step 700
[rank0]:2025-10-27 19:52:44,826 - INFO - validate step: 700  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,799
[rank1]:2025-10-27 19:52:44,908 - INFO - validate step: 700  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,793
[rank2]:2025-10-27 19:52:44,991 - INFO - validate step: 700  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,786
[rank3]:2025-10-27 19:52:45,073 - INFO - validate step: 700  loss:  0.2902  memory: 38.93GiB(81.95%)  tps: 5,985
[rank2]:2025-10-27 19:52:45,156 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1027_GPipe_apf_dm1/freeze_ratio_history/rank2/251027_1952_stage2_step700.svg
[rank1]:2025-10-27 19:52:45,156 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1027_GPipe_apf_dm1/freeze_ratio_history/rank1/251027_1952_stage1_step700.svg
[rank0]:2025-10-27 19:52:45,156 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1027_GPipe_apf_dm1/freeze_ratio_history/rank0/251027_1952_stage0_step700.svg
[rank3]:2025-10-27 19:52:45,268 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1027_GPipe_apf_dm1/pipeline_schedule/251027_1952_real_step700_rank3.svg
[rank3]:> Batch Time: 1308.74 ms, GPU Bubble Ratio: 69.05%, 43.22%, 62.12%, 14.36%
[rank3]:2025-10-27 19:52:45,338 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1027_GPipe_apf_dm1/freeze_ratio_history/rank3/251027_1952_stage3_step700.svg
[rank3]:2025-10-27 19:52:46,537 - INFO - Avg. fwd time: 71.6548 / Avg. bwd time: 81.9845 / Avg. batch time: 1278.5377 (ms) / GPU bubble ratio: 3.87%
[rank0]:2025-10-27 19:52:46,629 - INFO - Avg. fwd time: 45.2923 / Avg. bwd time: 16.3611 / Avg. batch time: 1593.9790 (ms) / GPU bubble ratio: 69.06%
[rank2]:2025-10-27 19:52:46,573 - INFO - Avg. fwd time: 33.2178 / Avg. bwd time: 34.9747 / Avg. batch time: 1446.7849 (ms) / GPU bubble ratio: 62.29%
[rank1]:2025-10-27 19:52:46,618 - INFO - Avg. fwd time: 53.0813 / Avg. bwd time: 47.3050 / Avg. batch time: 1541.2486 (ms) / GPU bubble ratio: 47.89%
[rank0]:2025-10-27 19:53:13,130 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:53:13,129 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:53:13,129 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:53:15,746 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:53:42,516 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:53:42,516 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:53:42,517 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:53:45,100 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:54:12,184 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:54:12,183 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:54:12,183 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:54:14,776 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:54:42,235 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:54:42,236 - INFO -  step: 720  loss: -4.0000  grad_norm:  0.0016  memory: 20.89GiB(43.97%)  tps: 2,791  tflops: 21.82  mfu: 6.99%
[rank2]:2025-10-27 19:54:42,234 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:54:42,235 - INFO -  step: 720  loss: -4.0000  grad_norm:  0.0016  memory: 16.10GiB(33.90%)  tps: 2,795  tflops: 21.85  mfu: 7.00%
[rank1]:2025-10-27 19:54:42,234 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:54:42,235 - INFO -  step: 720  loss: -4.0000  grad_norm:  0.0016  memory: 20.03GiB(42.17%)  tps: 2,793  tflops: 21.83  mfu: 7.00%
[rank3]:2025-10-27 19:54:44,694 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:54:44,698 - INFO -  step: 720  loss:  0.2059  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,739  tflops: 21.41  mfu: 6.86%
[rank3]:2025-10-27 19:54:45,830 - INFO - Avg. fwd time: 71.6677 / Avg. bwd time: 81.5816 / Avg. batch time: 1275.4159 (ms) / GPU bubble ratio: 3.87%
[rank2]:2025-10-27 19:54:45,867 - INFO - Avg. fwd time: 33.2180 / Avg. bwd time: 34.8125 / Avg. batch time: 1444.1937 (ms) / GPU bubble ratio: 62.32%
[rank1]:2025-10-27 19:54:45,911 - INFO - Avg. fwd time: 53.1021 / Avg. bwd time: 47.0783 / Avg. batch time: 1538.4378 (ms) / GPU bubble ratio: 47.91%
[rank0]:2025-10-27 19:54:45,923 - INFO - Avg. fwd time: 45.2974 / Avg. bwd time: 16.0466 / Avg. batch time: 1590.8427 (ms) / GPU bubble ratio: 69.15%
[rank0]:2025-10-27 19:55:11,511 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:55:11,510 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:55:11,510 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:55:13,972 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:55:40,845 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:55:40,844 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:55:40,844 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:55:43,376 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:56:10,591 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:56:10,591 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:56:10,592 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:56:13,175 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:56:40,221 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:56:40,222 - INFO -  step: 740  loss: -4.0000  grad_norm:  0.0011  memory: 20.89GiB(43.97%)  tps: 2,777  tflops: 21.71  mfu: 6.96%
[rank2]:2025-10-27 19:56:40,221 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:56:40,222 - INFO -  step: 740  loss: -4.0000  grad_norm:  0.0011  memory: 16.10GiB(33.90%)  tps: 2,777  tflops: 21.71  mfu: 6.96%
[rank1]:2025-10-27 19:56:40,221 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:56:40,222 - INFO -  step: 740  loss: -4.0000  grad_norm:  0.0011  memory: 20.03GiB(42.17%)  tps: 2,777  tflops: 21.71  mfu: 6.96%
[rank3]:2025-10-27 19:56:42,677 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:56:42,680 - INFO -  step: 740  loss:  0.1408  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,777  tflops: 21.71  mfu: 6.96%
[rank3]:2025-10-27 19:56:43,837 - INFO - Avg. fwd time: 71.6540 / Avg. bwd time: 81.1817 / Avg. batch time: 1272.1181 (ms) / GPU bubble ratio: 3.89%
[rank0]:2025-10-27 19:56:43,932 - INFO - Avg. fwd time: 45.2875 / Avg. bwd time: 15.7489 / Avg. batch time: 1587.4476 (ms) / GPU bubble ratio: 69.24%
[rank2]:2025-10-27 19:56:43,874 - INFO - Avg. fwd time: 33.2147 / Avg. bwd time: 34.6604 / Avg. batch time: 1441.3188 (ms) / GPU bubble ratio: 62.33%
[rank1]:2025-10-27 19:56:43,921 - INFO - Avg. fwd time: 53.1114 / Avg. bwd time: 46.8574 / Avg. batch time: 1535.3559 (ms) / GPU bubble ratio: 47.91%
[rank0]:2025-10-27 19:57:09,540 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:57:09,540 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:57:09,540 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:57:12,001 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:57:33,727 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-27 19:57:39,241 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:57:39,240 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:57:39,240 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:57:41,820 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:58:09,154 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:58:09,154 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:58:09,155 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:58:11,779 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:58:38,561 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:58:38,562 - INFO -  step: 760  loss: -4.0000  grad_norm:  0.0011  memory: 20.89GiB(43.97%)  tps: 2,769  tflops: 21.65  mfu: 6.94%
[rank2]:2025-10-27 19:58:38,560 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:58:38,561 - INFO -  step: 760  loss: -4.0000  grad_norm:  0.0011  memory: 16.10GiB(33.90%)  tps: 2,769  tflops: 21.65  mfu: 6.94%
[rank1]:2025-10-27 19:58:38,560 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:58:38,561 - INFO -  step: 760  loss: -4.0000  grad_norm:  0.0011  memory: 20.03GiB(42.17%)  tps: 2,769  tflops: 21.65  mfu: 6.94%
[rank3]:2025-10-27 19:58:41,019 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:58:41,023 - INFO -  step: 760  loss:  0.1298  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,769  tflops: 21.65  mfu: 6.94%
[rank3]:2025-10-27 19:58:42,205 - INFO - Avg. fwd time: 71.6518 / Avg. bwd time: 80.8039 / Avg. batch time: 1269.0726 (ms) / GPU bubble ratio: 3.89%
[rank2]:2025-10-27 19:58:42,241 - INFO - Avg. fwd time: 33.2142 / Avg. bwd time: 34.5153 / Avg. batch time: 1438.7027 (ms) / GPU bubble ratio: 62.34%
[rank1]:2025-10-27 19:58:42,286 - INFO - Avg. fwd time: 53.1124 / Avg. bwd time: 46.6470 / Avg. batch time: 1532.5417 (ms) / GPU bubble ratio: 47.92%
[rank0]:2025-10-27 19:58:42,297 - INFO - Avg. fwd time: 45.2708 / Avg. bwd time: 15.4667 / Avg. batch time: 1584.3344 (ms) / GPU bubble ratio: 69.33%
[rank0]:2025-10-27 19:59:08,272 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:59:08,271 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:59:08,271 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:59:10,735 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-27 19:59:50,778 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-27 19:59:50,758 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-27 19:59:50,763 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank3]:2025-10-27 19:59:53,398 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-27 20:00:20,204 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-27 20:00:20,203 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-27 20:00:20,203 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank3]:2025-10-27 20:00:22,672 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-27 20:00:49,811 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-27 20:00:49,811 - INFO -  step: 780  loss: -4.0000  grad_norm:  0.0012  memory: 20.89GiB(43.97%)  tps: 2,497  tflops: 19.52  mfu: 6.26%
[rank2]:2025-10-27 20:00:49,810 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-27 20:00:49,811 - INFO -  step: 780  loss: -4.0000  grad_norm:  0.0012  memory: 16.10GiB(33.90%)  tps: 2,497  tflops: 19.52  mfu: 6.26%
[rank1]:2025-10-27 20:00:49,810 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank1]:2025-10-27 20:00:49,811 - INFO -  step: 780  loss: -4.0000  grad_norm:  0.0012  memory: 20.03GiB(42.17%)  tps: 2,497  tflops: 19.52  mfu: 6.26%
[rank3]:2025-10-27 20:00:52,300 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-27 20:00:52,303 - INFO -  step: 780  loss:  0.1418  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,496  tflops: 19.51  mfu: 6.25%
[rank3]:2025-10-27 20:00:53,499 - INFO - Avg. fwd time: 71.6560 / Avg. bwd time: 80.8594 / Avg. batch time: 1269.5407 (ms) / GPU bubble ratio: 3.89%
[rank2]:2025-10-27 20:00:53,537 - INFO - Avg. fwd time: 33.2165 / Avg. bwd time: 34.5408 / Avg. batch time: 1439.7273 (ms) / GPU bubble ratio: 62.35%
[rank1]:2025-10-27 20:00:53,580 - INFO - Avg. fwd time: 53.1045 / Avg. bwd time: 46.6860 / Avg. batch time: 1533.5845 (ms) / GPU bubble ratio: 47.94%
[rank0]:2025-10-27 20:00:53,592 - INFO - Avg. fwd time: 45.2608 / Avg. bwd time: 15.5529 / Avg. batch time: 1585.4593 (ms) / GPU bubble ratio: 69.31%
[rank1]:2025-10-27 20:01:19,830 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank0]:2025-10-27 20:01:19,831 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-27 20:01:19,830 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-27 20:01:22,452 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-27 20:01:49,334 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-27 20:01:49,333 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-27 20:01:49,333 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank3]:2025-10-27 20:01:51,782 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-27 20:02:18,841 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-27 20:02:18,841 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-27 20:02:18,841 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank3]:2025-10-27 20:02:21,321 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-27 20:02:43,224 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-27 20:02:48,724 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-27 20:02:48,725 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0011  memory: 16.10GiB(33.90%)  tps: 2,756  tflops: 21.54  mfu: 6.90%
[rank2]:2025-10-27 20:02:48,733 - INFO - ðŸ”Ž  Running validation at step 800
[rank1]:2025-10-27 20:02:48,724 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank1]:2025-10-27 20:02:48,733 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0011  memory: 20.03GiB(42.17%)  tps: 2,755  tflops: 21.54  mfu: 6.90%
[rank1]:2025-10-27 20:02:48,733 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-10-27 20:02:48,725 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-27 20:02:48,733 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0011  memory: 20.89GiB(43.97%)  tps: 2,755  tflops: 21.54  mfu: 6.90%
[rank0]:2025-10-27 20:02:48,733 - INFO - ðŸ”Ž  Running validation at step 800
[rank3]:2025-10-27 20:02:51,283 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-27 20:02:51,286 - INFO -  step: 800  loss:  0.1165  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,754  tflops: 21.53  mfu: 6.90%
[rank3]:2025-10-27 20:02:51,287 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-10-27 20:03:58,902 - INFO - validate step: 800  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,837
[rank1]:2025-10-27 20:03:58,982 - INFO - validate step: 800  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,831
[rank2]:2025-10-27 20:03:59,062 - INFO - validate step: 800  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,824
[rank3]:2025-10-27 20:03:59,142 - INFO - validate step: 800  loss:  0.2924  memory: 38.93GiB(81.95%)  tps: 6,037
[rank2]:2025-10-27 20:03:59,228 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1027_GPipe_apf_dm1/freeze_ratio_history/rank2/251027_2003_stage2_step800.svg
[rank1]:2025-10-27 20:03:59,229 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1027_GPipe_apf_dm1/freeze_ratio_history/rank1/251027_2003_stage1_step800.svg
[rank0]:2025-10-27 20:03:59,229 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1027_GPipe_apf_dm1/freeze_ratio_history/rank0/251027_2003_stage0_step800.svg
[rank3]:2025-10-27 20:03:59,337 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1027_GPipe_apf_dm1/pipeline_schedule/251027_2003_real_step800_rank3.svg
[rank3]:> Batch Time: 1307.48 ms, GPU Bubble Ratio: 69.03%, 43.20%, 62.08%, 14.35%
[rank3]:2025-10-27 20:03:59,411 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1027_GPipe_apf_dm1/freeze_ratio_history/rank3/251027_2003_stage3_step800.svg
[rank3]:2025-10-27 20:04:00,619 - INFO - Avg. fwd time: 71.6613 / Avg. bwd time: 80.5185 / Avg. batch time: 1266.8926 (ms) / GPU bubble ratio: 3.90%
[rank0]:2025-10-27 20:04:00,711 - INFO - Avg. fwd time: 45.2567 / Avg. bwd time: 15.2898 / Avg. batch time: 1582.0099 (ms) / GPU bubble ratio: 69.38%
[rank2]:2025-10-27 20:04:00,655 - INFO - Avg. fwd time: 33.2196 / Avg. bwd time: 34.4056 / Avg. batch time: 1436.7219 (ms) / GPU bubble ratio: 62.34%
[rank1]:2025-10-27 20:04:00,699 - INFO - Avg. fwd time: 53.1307 / Avg. bwd time: 46.4946 / Avg. batch time: 1530.4078 (ms) / GPU bubble ratio: 47.92%
[rank0]:2025-10-27 20:04:26,329 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-27 20:04:26,328 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-27 20:04:26,328 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank3]:2025-10-27 20:04:28,939 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-27 20:04:55,836 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-27 20:04:55,835 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-27 20:04:55,835 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank3]:2025-10-27 20:04:58,356 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-27 20:05:05,660 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-27 20:05:06,404 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-27 20:05:06,356 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-27 20:05:06,398 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-27 20:05:27,834 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-27 20:05:27,833 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-27 20:05:27,833 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank3]:2025-10-27 20:05:30,477 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-27 20:05:57,568 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-27 20:05:57,569 - INFO -  step: 820  loss: -4.0000  grad_norm:  0.0010  memory: 20.89GiB(43.97%)  tps: 2,761  tflops: 21.59  mfu: 6.92%
[rank2]:2025-10-27 20:05:57,568 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-27 20:05:57,568 - INFO -  step: 820  loss: -4.0000  grad_norm:  0.0010  memory: 16.10GiB(33.90%)  tps: 2,765  tflops: 21.62  mfu: 6.93%
[rank1]:2025-10-27 20:05:57,568 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank1]:2025-10-27 20:05:57,568 - INFO -  step: 820  loss: -4.0000  grad_norm:  0.0010  memory: 20.03GiB(42.17%)  tps: 2,763  tflops: 21.60  mfu: 6.92%
[rank3]:2025-10-27 20:06:00,206 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-27 20:06:00,211 - INFO -  step: 820  loss:  0.1409  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,707  tflops: 21.16  mfu: 6.78%
[rank3]:2025-10-27 20:06:01,361 - INFO - Avg. fwd time: 71.6514 / Avg. bwd time: 80.1857 / Avg. batch time: 1264.1624 (ms) / GPU bubble ratio: 3.91%
[rank0]:2025-10-27 20:06:01,456 - INFO - Avg. fwd time: 45.2557 / Avg. bwd time: 15.0396 / Avg. batch time: 1579.4570 (ms) / GPU bubble ratio: 69.46%
[rank2]:2025-10-27 20:06:01,398 - INFO - Avg. fwd time: 33.2131 / Avg. bwd time: 34.2762 / Avg. batch time: 1434.4629 (ms) / GPU bubble ratio: 62.36%
[rank1]:2025-10-27 20:06:01,443 - INFO - Avg. fwd time: 53.1284 / Avg. bwd time: 46.3125 / Avg. batch time: 1528.0048 (ms) / GPU bubble ratio: 47.94%
[rank0]:2025-10-27 20:06:27,000 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-27 20:06:27,000 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-27 20:06:26,999 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank3]:2025-10-27 20:06:29,646 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-27 20:06:56,828 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-27 20:06:56,827 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-27 20:06:56,827 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank3]:2025-10-27 20:06:59,413 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-27 20:07:26,567 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-27 20:07:26,566 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-27 20:07:26,566 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank3]:2025-10-27 20:07:29,205 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-27 20:07:56,034 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-27 20:07:56,035 - INFO -  step: 840  loss: -4.0000  grad_norm:  0.0013  memory: 16.10GiB(33.90%)  tps: 2,766  tflops: 21.62  mfu: 6.93%
[rank1]:2025-10-27 20:07:56,035 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank1]:2025-10-27 20:07:56,035 - INFO -  step: 840  loss: -4.0000  grad_norm:  0.0013  memory: 20.03GiB(42.17%)  tps: 2,766  tflops: 21.62  mfu: 6.93%
[rank0]:2025-10-27 20:07:56,035 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-27 20:07:56,036 - INFO -  step: 840  loss: -4.0000  grad_norm:  0.0013  memory: 20.89GiB(43.97%)  tps: 2,766  tflops: 21.62  mfu: 6.93%
[rank3]:2025-10-27 20:07:58,512 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-27 20:07:58,517 - INFO -  step: 840  loss:  0.1413  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,770  tflops: 21.65  mfu: 6.94%
[rank3]:2025-10-27 20:07:59,692 - INFO - Avg. fwd time: 71.6401 / Avg. bwd time: 79.8682 / Avg. batch time: 1261.5277 (ms) / GPU bubble ratio: 3.92%
[rank2]:2025-10-27 20:07:59,729 - INFO - Avg. fwd time: 33.2132 / Avg. bwd time: 34.1549 / Avg. batch time: 1432.2650 (ms) / GPU bubble ratio: 62.37%
[rank0]:2025-10-27 20:07:59,791 - INFO - Avg. fwd time: 45.2436 / Avg. bwd time: 14.8011 / Avg. batch time: 1576.8385 (ms) / GPU bubble ratio: 69.54%
[rank1]:2025-10-27 20:07:59,779 - INFO - Avg. fwd time: 53.1211 / Avg. bwd time: 46.1392 / Avg. batch time: 1525.6408 (ms) / GPU bubble ratio: 47.95%
[rank1]:2025-10-27 20:08:25,785 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank0]:2025-10-27 20:08:25,786 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-27 20:08:25,785 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-27 20:08:28,374 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-27 20:08:50,399 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-27 20:08:55,863 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-27 20:08:55,862 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-27 20:08:55,862 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-27 20:08:58,332 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-27 20:09:37,782 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank0]:2025-10-27 20:09:37,803 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-27 20:09:37,778 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-27 20:09:40,332 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-27 20:10:07,521 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank1]:2025-10-27 20:10:07,522 - INFO -  step: 860  loss: -4.0000  grad_norm:  0.0012  memory: 20.03GiB(42.17%)  tps: 2,492  tflops: 19.48  mfu: 6.24%
[rank0]:2025-10-27 20:10:07,522 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-27 20:10:07,523 - INFO -  step: 860  loss: -4.0000  grad_norm:  0.0012  memory: 20.89GiB(43.97%)  tps: 2,492  tflops: 19.48  mfu: 6.24%
[rank2]:2025-10-27 20:10:07,521 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-27 20:10:07,522 - INFO -  step: 860  loss: -4.0000  grad_norm:  0.0012  memory: 16.10GiB(33.90%)  tps: 2,492  tflops: 19.48  mfu: 6.24%
[rank3]:2025-10-27 20:10:09,989 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-27 20:10:09,993 - INFO -  step: 860  loss:  0.1332  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,492  tflops: 19.48  mfu: 6.24%
[rank3]:2025-10-27 20:10:11,185 - INFO - Avg. fwd time: 71.6451 / Avg. bwd time: 79.9441 / Avg. batch time: 1262.1790 (ms) / GPU bubble ratio: 3.92%
[rank0]:2025-10-27 20:10:11,280 - INFO - Avg. fwd time: 45.2491 / Avg. bwd time: 14.8971 / Avg. batch time: 1578.0898 (ms) / GPU bubble ratio: 69.51%
[rank2]:2025-10-27 20:10:11,223 - INFO - Avg. fwd time: 33.2140 / Avg. bwd time: 34.1826 / Avg. batch time: 1433.3803 (ms) / GPU bubble ratio: 62.38%
[rank1]:2025-10-27 20:10:11,267 - INFO - Avg. fwd time: 53.1222 / Avg. bwd time: 46.1849 / Avg. batch time: 1526.7978 (ms) / GPU bubble ratio: 47.97%
[rank1]:2025-10-27 20:10:37,559 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank0]:2025-10-27 20:10:37,560 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-27 20:10:37,559 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-27 20:10:40,097 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-27 20:11:06,935 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-27 20:11:06,935 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-27 20:11:06,935 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank3]:2025-10-27 20:11:09,405 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-27 20:11:36,308 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-27 20:11:36,309 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-27 20:11:36,308 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank3]:2025-10-27 20:11:38,784 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-27 20:12:06,073 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank1]:2025-10-27 20:12:06,074 - INFO -  step: 880  loss: -4.0000  grad_norm:  0.0009  memory: 20.03GiB(42.17%)  tps: 2,764  tflops: 21.61  mfu: 6.93%
[rank2]:2025-10-27 20:12:06,073 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-27 20:12:06,074 - INFO -  step: 880  loss: -4.0000  grad_norm:  0.0009  memory: 16.10GiB(33.90%)  tps: 2,764  tflops: 21.61  mfu: 6.93%
[rank0]:2025-10-27 20:12:06,074 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-27 20:12:06,074 - INFO -  step: 880  loss: -4.0000  grad_norm:  0.0009  memory: 20.89GiB(43.97%)  tps: 2,764  tflops: 21.61  mfu: 6.93%
[rank3]:2025-10-27 20:12:08,703 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-27 20:12:08,707 - INFO -  step: 880  loss:  0.1056  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,760  tflops: 21.58  mfu: 6.92%
[rank3]:2025-10-27 20:12:09,912 - INFO - Avg. fwd time: 71.6464 / Avg. bwd time: 79.6530 / Avg. batch time: 1259.8774 (ms) / GPU bubble ratio: 3.93%
[rank2]:2025-10-27 20:12:09,951 - INFO - Avg. fwd time: 33.2141 / Avg. bwd time: 34.0654 / Avg. batch time: 1431.4091 (ms) / GPU bubble ratio: 62.40%
[rank0]:2025-10-27 20:12:10,009 - INFO - Avg. fwd time: 45.2517 / Avg. bwd time: 14.6725 / Avg. batch time: 1575.7259 (ms) / GPU bubble ratio: 69.58%
[rank1]:2025-10-27 20:12:09,996 - INFO - Avg. fwd time: 53.1319 / Avg. bwd time: 46.0197 / Avg. batch time: 1524.6678 (ms) / GPU bubble ratio: 47.97%
[rank2]:2025-10-27 20:12:35,555 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-27 20:12:35,555 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-27 20:12:35,555 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank3]:2025-10-27 20:12:38,191 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-27 20:13:04,938 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank2]:2025-10-27 20:13:04,938 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-27 20:13:04,938 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-27 20:13:07,416 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-27 20:13:34,595 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-27 20:13:34,596 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-27 20:13:34,595 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank3]:2025-10-27 20:13:37,106 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-27 20:13:58,628 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-27 20:14:03,989 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-27 20:14:03,990 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0012  memory: 16.10GiB(33.90%)  tps: 2,779  tflops: 21.72  mfu: 6.96%
[rank2]:2025-10-27 20:14:03,990 - INFO - ðŸ”Ž  Running validation at step 900
[rank0]:2025-10-27 20:14:03,990 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-27 20:14:03,990 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0012  memory: 20.89GiB(43.97%)  tps: 2,779  tflops: 21.72  mfu: 6.96%
[rank0]:2025-10-27 20:14:03,990 - INFO - ðŸ”Ž  Running validation at step 900
[rank1]:2025-10-27 20:14:03,989 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank1]:2025-10-27 20:14:03,990 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0012  memory: 20.03GiB(42.17%)  tps: 2,779  tflops: 21.72  mfu: 6.96%
[rank1]:2025-10-27 20:14:03,990 - INFO - ðŸ”Ž  Running validation at step 900
[rank3]:2025-10-27 20:14:06,588 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-27 20:14:06,592 - INFO -  step: 900  loss:  0.1349  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,780  tflops: 21.73  mfu: 6.96%
[rank3]:2025-10-27 20:14:06,592 - INFO - ðŸ”Ž  Running validation at step 900
[rank0]:2025-10-27 20:15:14,986 - INFO - validate step: 900  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,769
[rank1]:2025-10-27 20:15:15,065 - INFO - validate step: 900  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,763
[rank2]:2025-10-27 20:15:15,146 - INFO - validate step: 900  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,756
[rank3]:2025-10-27 20:15:15,228 - INFO - validate step: 900  loss:  0.2905  memory: 38.93GiB(81.95%)  tps: 5,968
[rank1]:2025-10-27 20:15:15,314 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1027_GPipe_apf_dm1/freeze_ratio_history/rank1/251027_2015_stage1_step900.svg
[rank2]:2025-10-27 20:15:15,314 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1027_GPipe_apf_dm1/freeze_ratio_history/rank2/251027_2015_stage2_step900.svg
[rank0]:2025-10-27 20:15:15,315 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1027_GPipe_apf_dm1/freeze_ratio_history/rank0/251027_2015_stage0_step900.svg
[rank3]:2025-10-27 20:15:15,439 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1027_GPipe_apf_dm1/pipeline_schedule/251027_2015_real_step900_rank3.svg
[rank3]:> Batch Time: 1306.75 ms, GPU Bubble Ratio: 69.01%, 43.20%, 62.07%, 14.36%
[rank3]:2025-10-27 20:15:15,504 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1027_GPipe_apf_dm1/freeze_ratio_history/rank3/251027_2015_stage3_step900.svg
[rank3]:2025-10-27 20:15:16,684 - INFO - Avg. fwd time: 71.6222 / Avg. bwd time: 79.3661 / Avg. batch time: 1257.4215 (ms) / GPU bubble ratio: 3.94%
[rank2]:2025-10-27 20:15:16,721 - INFO - Avg. fwd time: 33.2123 / Avg. bwd time: 33.9548 / Avg. batch time: 1428.6208 (ms) / GPU bubble ratio: 62.39%
[rank0]:2025-10-27 20:15:16,780 - INFO - Avg. fwd time: 45.2418 / Avg. bwd time: 14.4581 / Avg. batch time: 1572.5561 (ms) / GPU bubble ratio: 69.63%
[rank1]:2025-10-27 20:15:16,768 - INFO - Avg. fwd time: 53.1321 / Avg. bwd time: 45.8631 / Avg. batch time: 1521.7287 (ms) / GPU bubble ratio: 47.96%
[rank2]:2025-10-27 20:15:42,603 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-27 20:15:42,604 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-27 20:15:42,603 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank3]:2025-10-27 20:15:45,219 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-27 20:16:12,563 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-27 20:16:12,564 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-27 20:16:12,563 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank3]:2025-10-27 20:16:15,016 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-27 20:16:42,259 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-27 20:16:42,260 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-27 20:16:42,259 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank3]:2025-10-27 20:16:44,761 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-27 20:17:11,693 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-27 20:17:11,694 - INFO -  step: 920  loss: -4.0000  grad_norm:  0.0012  memory: 16.10GiB(33.90%)  tps: 2,812  tflops: 21.98  mfu: 7.04%
[rank0]:2025-10-27 20:17:11,694 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-27 20:17:11,694 - INFO -  step: 920  loss: -4.0000  grad_norm:  0.0012  memory: 20.89GiB(43.97%)  tps: 2,808  tflops: 21.95  mfu: 7.04%
[rank1]:2025-10-27 20:17:11,693 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank1]:2025-10-27 20:17:11,694 - INFO -  step: 920  loss: -4.0000  grad_norm:  0.0012  memory: 20.03GiB(42.17%)  tps: 2,810  tflops: 21.96  mfu: 7.04%
[rank3]:2025-10-27 20:17:14,128 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-27 20:17:14,132 - INFO -  step: 920  loss:  0.1467  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,756  tflops: 21.54  mfu: 6.91%
[rank3]:2025-10-27 20:17:15,295 - INFO - Avg. fwd time: 71.6180 / Avg. bwd time: 79.1037 / Avg. batch time: 1255.3200 (ms) / GPU bubble ratio: 3.95%
[rank2]:2025-10-27 20:17:15,332 - INFO - Avg. fwd time: 33.2113 / Avg. bwd time: 33.8509 / Avg. batch time: 1426.8028 (ms) / GPU bubble ratio: 62.40%
[rank1]:2025-10-27 20:17:15,377 - INFO - Avg. fwd time: 53.1450 / Avg. bwd time: 45.7187 / Avg. batch time: 1519.7714 (ms) / GPU bubble ratio: 47.96%
[rank0]:2025-10-27 20:17:15,390 - INFO - Avg. fwd time: 45.2397 / Avg. bwd time: 14.2533 / Avg. batch time: 1570.3821 (ms) / GPU bubble ratio: 69.69%
[rank2]:2025-10-27 20:17:41,446 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-27 20:17:41,447 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-27 20:17:41,446 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank3]:2025-10-27 20:17:43,911 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-27 20:18:11,479 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-27 20:18:11,479 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-27 20:18:11,479 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank3]:2025-10-27 20:18:13,912 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-27 20:18:40,738 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-27 20:18:40,739 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-27 20:18:40,738 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank3]:2025-10-27 20:18:43,172 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-27 20:19:10,364 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-27 20:19:10,364 - INFO -  step: 940  loss: -4.0000  grad_norm:  0.0014  memory: 16.10GiB(33.90%)  tps: 2,761  tflops: 21.59  mfu: 6.92%
[rank0]:2025-10-27 20:19:10,364 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-27 20:19:10,365 - INFO -  step: 940  loss: -4.0000  grad_norm:  0.0014  memory: 20.89GiB(43.97%)  tps: 2,761  tflops: 21.59  mfu: 6.92%
[rank1]:2025-10-27 20:19:10,364 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-27 20:19:10,364 - INFO -  step: 940  loss: -4.0000  grad_norm:  0.0014  memory: 20.03GiB(42.17%)  tps: 2,761  tflops: 21.59  mfu: 6.92%
[rank3]:2025-10-27 20:19:12,957 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-27 20:19:12,961 - INFO -  step: 940  loss:  0.1224  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,758  tflops: 21.56  mfu: 6.91%
[rank3]:2025-10-27 20:19:14,634 - INFO - Avg. fwd time: 71.6258 / Avg. bwd time: 78.8708 / Avg. batch time: 1253.5176 (ms) / GPU bubble ratio: 3.95%
[rank2]:2025-10-27 20:19:14,699 - INFO - Avg. fwd time: 33.2124 / Avg. bwd time: 33.7573 / Avg. batch time: 1425.2557 (ms) / GPU bubble ratio: 62.41%
[rank1]:2025-10-27 20:19:14,778 - INFO - Avg. fwd time: 53.1527 / Avg. bwd time: 45.5871 / Avg. batch time: 1518.1040 (ms) / GPU bubble ratio: 47.97%
[rank0]:2025-10-27 20:19:14,844 - INFO - Avg. fwd time: 45.2372 / Avg. bwd time: 14.0717 / Avg. batch time: 1568.5239 (ms) / GPU bubble ratio: 69.75%
[rank2]:2025-10-27 20:19:53,105 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-27 20:19:53,130 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-27 20:19:53,109 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank3]:2025-10-27 20:19:55,721 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-27 20:20:16,977 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-27 20:20:22,341 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-27 20:20:22,342 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-27 20:20:22,341 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank3]:2025-10-27 20:20:24,778 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-27 20:20:51,610 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-27 20:20:51,611 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-27 20:20:51,610 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank3]:2025-10-27 20:20:54,156 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-27 20:21:21,463 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-27 20:21:21,463 - INFO -  step: 960  loss: -4.0000  grad_norm:  0.0011  memory: 16.10GiB(33.90%)  tps: 2,499  tflops: 19.54  mfu: 6.26%
[rank0]:2025-10-27 20:21:21,463 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-27 20:21:21,464 - INFO -  step: 960  loss: -4.0000  grad_norm:  0.0011  memory: 20.89GiB(43.97%)  tps: 2,499  tflops: 19.54  mfu: 6.26%
[rank1]:2025-10-27 20:21:21,463 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank1]:2025-10-27 20:21:21,463 - INFO -  step: 960  loss: -4.0000  grad_norm:  0.0011  memory: 20.03GiB(42.17%)  tps: 2,499  tflops: 19.54  mfu: 6.26%
[rank3]:2025-10-27 20:21:23,896 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-27 20:21:23,900 - INFO -  step: 960  loss:  0.1004  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,503  tflops: 19.56  mfu: 6.27%
[rank3]:2025-10-27 20:21:25,103 - INFO - Avg. fwd time: 71.6211 / Avg. bwd time: 78.9362 / Avg. batch time: 1254.0096 (ms) / GPU bubble ratio: 3.95%
[rank2]:2025-10-27 20:21:25,142 - INFO - Avg. fwd time: 33.2128 / Avg. bwd time: 33.7839 / Avg. batch time: 1426.1310 (ms) / GPU bubble ratio: 62.42%
[rank1]:2025-10-27 20:21:25,188 - INFO - Avg. fwd time: 53.1506 / Avg. bwd time: 45.6278 / Avg. batch time: 1519.0160 (ms) / GPU bubble ratio: 47.98%
[rank0]:2025-10-27 20:21:25,201 - INFO - Avg. fwd time: 45.2531 / Avg. bwd time: 14.1560 / Avg. batch time: 1569.5210 (ms) / GPU bubble ratio: 69.72%
[rank2]:2025-10-27 20:21:50,763 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-27 20:21:50,763 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-27 20:21:50,763 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank3]:2025-10-27 20:21:53,224 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-27 20:22:20,116 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-27 20:22:20,116 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank0]:2025-10-27 20:22:20,117 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-27 20:22:22,555 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-27 20:22:49,854 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-27 20:22:49,854 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank0]:2025-10-27 20:22:49,854 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-27 20:22:52,381 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-27 20:23:19,516 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-27 20:23:19,517 - INFO -  step: 980  loss: -4.0000  grad_norm:  0.0010  memory: 16.10GiB(33.90%)  tps: 2,776  tflops: 21.70  mfu: 6.95%
[rank1]:2025-10-27 20:23:19,516 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank1]:2025-10-27 20:23:19,517 - INFO -  step: 980  loss: -4.0000  grad_norm:  0.0010  memory: 20.03GiB(42.17%)  tps: 2,776  tflops: 21.70  mfu: 6.95%
[rank0]:2025-10-27 20:23:19,517 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-27 20:23:19,518 - INFO -  step: 980  loss: -4.0000  grad_norm:  0.0010  memory: 20.89GiB(43.97%)  tps: 2,776  tflops: 21.70  mfu: 6.95%
[rank3]:2025-10-27 20:23:21,970 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-27 20:23:21,974 - INFO -  step: 980  loss:  0.1147  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,775  tflops: 21.70  mfu: 6.95%
[rank3]:2025-10-27 20:23:23,136 - INFO - Avg. fwd time: 71.6166 / Avg. bwd time: 78.6892 / Avg. batch time: 1251.9976 (ms) / GPU bubble ratio: 3.96%
[rank2]:2025-10-27 20:23:23,173 - INFO - Avg. fwd time: 33.2112 / Avg. bwd time: 33.6888 / Avg. batch time: 1424.3312 (ms) / GPU bubble ratio: 62.42%
[rank1]:2025-10-27 20:23:23,220 - INFO - Avg. fwd time: 53.1512 / Avg. bwd time: 45.4927 / Avg. batch time: 1517.0831 (ms) / GPU bubble ratio: 47.98%
[rank0]:2025-10-27 20:23:23,233 - INFO - Avg. fwd time: 45.2449 / Avg. bwd time: 13.9697 / Avg. batch time: 1567.3897 (ms) / GPU bubble ratio: 69.78%
[rank2]:2025-10-27 20:23:48,845 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-27 20:23:48,845 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank0]:2025-10-27 20:23:48,846 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-27 20:23:51,325 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-27 20:24:18,564 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-27 20:24:18,564 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank0]:2025-10-27 20:24:18,565 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-27 20:24:21,186 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-27 20:24:48,466 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-27 20:24:48,466 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank0]:2025-10-27 20:24:48,467 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-27 20:24:51,048 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-27 20:25:12,477 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-27 20:25:17,894 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-27 20:25:17,902 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0010  memory: 20.89GiB(43.97%)  tps: 2,768  tflops: 21.64  mfu: 6.94%
[rank0]:2025-10-27 20:25:17,902 - INFO -  final step: 1000  loss: -4.0000  grad_norm:  0.0010  tps: 2,638  tflops: 20.62  mfu: 6.45%
[rank0]:2025-10-27 20:25:17,902 - INFO - ðŸ”Ž  Running validation at step 1000
[rank2]:2025-10-27 20:25:17,893 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-27 20:25:17,894 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0010  memory: 16.10GiB(33.90%)  tps: 2,768  tflops: 21.64  mfu: 6.94%
[rank2]:2025-10-27 20:25:17,902 - INFO -  final step: 1000  loss: -4.0000  grad_norm:  0.0010  tps: 2,638  tflops: 20.63  mfu: 6.45%
[rank2]:2025-10-27 20:25:17,902 - INFO - ðŸ”Ž  Running validation at step 1000
[rank1]:2025-10-27 20:25:17,893 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank1]:2025-10-27 20:25:17,894 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0010  memory: 20.03GiB(42.17%)  tps: 2,768  tflops: 21.64  mfu: 6.94%
[rank1]:2025-10-27 20:25:17,902 - INFO -  final step: 1000  loss: -4.0000  grad_norm:  0.0010  tps: 2,638  tflops: 20.62  mfu: 6.45%
[rank1]:2025-10-27 20:25:17,902 - INFO - ðŸ”Ž  Running validation at step 1000
[rank3]:2025-10-27 20:25:20,339 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-27 20:25:20,343 - INFO -  step: 1000  loss:  0.1238  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,768  tflops: 21.64  mfu: 6.94%
[rank3]:2025-10-27 20:25:20,343 - INFO -  final step: 1000  loss:  0.1238  grad_norm:  0.0000  tps: 2,630  tflops: 20.56  mfu: 6.43%
[rank3]:2025-10-27 20:25:20,344 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-10-27 20:26:28,337 - INFO - validate step: 1000  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,815
[rank0]:2025-10-27 20:26:28,338 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-27 20:26:28,340 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1000.
[rank1]:2025-10-27 20:26:28,419 - INFO - validate step: 1000  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,809
[rank1]:2025-10-27 20:26:28,420 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-27 20:26:28,422 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1000.
[rank2]:2025-10-27 20:26:28,499 - INFO - validate step: 1000  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,802
[rank2]:2025-10-27 20:26:28,500 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-27 20:26:28,502 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1000.
[rank3]:2025-10-27 20:26:28,579 - INFO - validate step: 1000  loss:  0.2911  memory: 38.93GiB(81.95%)  tps: 6,003
[rank3]:2025-10-27 20:26:28,580 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-27 20:26:28,582 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1000.
[rank0]:2025-10-27 20:26:31,166 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank2]:2025-10-27 20:26:31,246 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1027_GPipe_apf_dm1/freeze_ratio_history/rank2/251027_2026_stage2_final1000.svg
[rank1]:2025-10-27 20:26:31,247 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1027_GPipe_apf_dm1/freeze_ratio_history/rank1/251027_2026_stage1_final1000.svg
[rank0]:2025-10-27 20:26:31,248 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1027_GPipe_apf_dm1/freeze_ratio_history/rank0/251027_2026_stage0_final1000.svg
[rank3]:2025-10-27 20:26:31,361 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1027_GPipe_apf_dm1/pipeline_schedule/251027_2026_real_final1000_rank3.svg
[rank3]:> Batch Time: 1306.04 ms, GPU Bubble Ratio: 68.99%, 43.16%, 62.05%, 14.37%
[rank2]:2025-10-27 20:26:31,463 - INFO - Elementwise Histogram is saved as: /data3/shcho/torchtitan/images/1027_GPipe_apf_dm1/frozen_params_histogram/251027_2026_rank2_stage2.svg
[rank2]:	> Counts Sum: 5807, Total Sum: 6552 (88.63%), Ratio(%) per element: [90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 17.58]
[rank2]:2025-10-27 20:26:31,464 - INFO - Destroying the purge thread.
[rank1]:2025-10-27 20:26:31,456 - INFO - Elementwise Histogram is saved as: /data3/shcho/torchtitan/images/1027_GPipe_apf_dm1/frozen_params_histogram/251027_2026_rank1_stage1.svg
[rank1]:	> Counts Sum: 7303, Total Sum: 8190 (89.17%), Ratio(%) per element: [90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 23.62]
[rank1]:2025-10-27 20:26:31,457 - INFO - Destroying the purge thread.
[rank0]:2025-10-27 20:26:31,469 - INFO - Elementwise Histogram is saved as: /data3/shcho/torchtitan/images/1027_GPipe_apf_dm1/frozen_params_histogram/251027_2026_rank0_stage0.svg
[rank0]:	> Counts Sum: 5991, Total Sum: 6734 (88.97%), Ratio(%) per element: [90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 28.02]
[rank0]:2025-10-27 20:26:31,469 - INFO - Sleeping 2 seconds for other ranks to complete
[rank3]:2025-10-27 20:26:31,551 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1027_GPipe_apf_dm1/pipeline_schedule/251027_2026_thry_final1000_rank3.svg
[rank3]:> Batch Time: 1687.06 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:2025-10-27 20:26:31,617 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1027_GPipe_apf_dm1/freeze_ratio_history/rank3/251027_2026_stage3_final1000.svg
[rank2]:2025-10-27 20:26:31,762 - INFO - Process group destroyed
[rank3]:2025-10-27 20:26:31,803 - INFO - Elementwise Histogram is saved as: /data3/shcho/torchtitan/images/1027_GPipe_apf_dm1/frozen_params_histogram/251027_2026_rank3_stage3.svg
[rank3]:	> Counts Sum: 4785, Total Sum: 5278 (90.66%), Ratio(%) per element: [90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65, 90.65]
[rank3]:2025-10-27 20:26:31,804 - INFO - Destroying the purge thread.
[rank1]:2025-10-27 20:26:31,808 - INFO - Process group destroyed
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading history steps 50-50, summary, console lines 521-531
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–„â–ƒâ–„â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–‡â–ˆâ–†â–„â–‚â–â–â–â–â–â–ƒâ–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–‡â–ˆâ–†â–„â–‚â–â–â–â–â–â–ƒâ–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 6.23042
[rank3]:wandb:               final/avg_loss 0.12378
[rank3]:wandb:             final/avg_mfu(%) 6.43467
[rank3]:wandb:             final/avg_tflops 20.55761
[rank3]:wandb:    final/avg_throughput(tps) 2629.67777
[rank3]:wandb:              final/grad_norm 0
[rank3]:wandb:               final/max_loss 0.12378
[rank3]:wandb:                    grad_norm 0
[rank3]:wandb: loss_metrics/global_avg_loss 0.12378
[rank3]:wandb: loss_metrics/global_max_loss 0.12378
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1027_GPipe_apf_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/prk3zpya
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data3/shcho/torchtitan/tb/1027_GPipe_apf_dm1/20251027-1829/wandb/run-20251027_182906-prk3zpya/logs
[rank0]:2025-10-27 20:26:33,469 - INFO - Training completed
[rank0]:2025-10-27 20:26:33,470 - INFO - Destroying the purge thread.
[rank3]:2025-10-27 20:26:33,624 - INFO - Process group destroyed
[rank0]:2025-10-27 20:26:33,613 - INFO - Process group destroyed
[rank2]:Stage 2: Modules to keep: {'layers.12', 'layers.10', 'layers.11', 'layers.9'}
[rank1]:Stage 1: Modules to keep: {'layers.6', 'layers.8', 'layers.5', 'layers.7', 'layers.4'}
[rank0]:Stage 0: Modules to keep: {'layers.0', 'layers.1', 'layers.2', 'layers.3', 'tok_embeddings'}
[rank3]:Stage 3: Modules to keep: {'output', 'layers.15', 'layers.14', 'norm', 'layers.13'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1026_llama1b/config.toml
[rank3]:		- dump_folder: /data3/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1027_GPipe_apf_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data3/shcho/torchtitan/profile_trace/1027_GPipe_apf_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data3/shcho/torchtitan/memory_snapshot/1027_GPipe_apf_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 20
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data3/shcho/torchtitan/tb/1027_GPipe_apf_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data3/shcho/torchtitan/images/1027_GPipe_apf_dm1
[rank3]:		- pplog_freq: 80
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1027_GPipe_apf_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B-Instruct
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 2e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: alpaca
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 1000
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: GPipe
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data3/shcho/torchtitan/checkpoint/1027_GPipe_apf_dm1
[rank3]:		- interval: 500
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B-Instruct/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data3/shcho/torchtitan/comm_traces/1027_GPipe_apf_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: True
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- seq_len: 1024
[rank3]:		- freq: 100
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: apf
[rank3]:		- phase_unit: 10
[rank3]:		- stability_check_freq: 5
[rank3]:		- aggressiveness: 0
[rank3]:
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
