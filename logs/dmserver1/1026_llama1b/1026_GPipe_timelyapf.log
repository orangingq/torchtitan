
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 10. 27. (ì›”) 09:24:19 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 3,4,5,6
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1026_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1026_llama1b/1026_GPipe_timelyapf.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation
âœ”ï¸Running with timelyapf x GPipe ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1026_llama1b/config.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=timelyapf
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank2]:2025-10-27 09:24:25,570 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation"
[rank3]:2025-10-27 09:24:25,570 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation"
[rank0]:2025-10-27 09:24:25,752 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation"
[rank1]:2025-10-27 09:24:25,783 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation"
[rank0]:2025-10-27 09:24:26,210 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-10-27 09:24:26,213 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-27 09:24:26,222 - INFO - [GC] Initial GC collection 0.00 seconds
[rank2]:2025-10-27 09:24:26,256 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-10-27 09:24:26,258 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-10-27 09:24:26,225 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-10-27 09:24:26,245 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-10-27 09:24:26,247 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-10-27 09:24:26,227 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-27 09:24:26,778 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-10-27 09:24:27,182 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank0]:2025-10-27 09:24:29,894 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank0]:2025-10-27 09:24:30,061 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-10-27 09:24:30,105 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-10-27 09:24:30,106 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-10-27 09:24:30,132 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-10-27 09:24:30,132 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-10-27 09:24:30,319 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-10-27 09:24:30,319 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-10-27 09:24:30,319 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank2]:2025-10-27 09:24:30,267 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-10-27 09:24:30,312 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-10-27 09:24:30,338 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-10-27 09:24:30,338 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank2]:2025-10-27 09:24:30,512 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-10-27 09:24:30,512 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-10-27 09:24:30,512 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank1]:2025-10-27 09:24:30,555 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-10-27 09:24:30,596 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-10-27 09:24:30,624 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-10-27 09:24:30,624 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2025-10-27 09:24:30,818 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-10-27 09:24:30,819 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-10-27 09:24:30,819 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run dzux10pe
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data3/shcho/torchtitan/tb/1026_GPipe_timelyapf_dm1/20251027-0924/wandb/run-20251027_092431-dzux10pe
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1026_GPipe_timelyapf_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/dzux10pe
[rank3]:2025-10-27 09:24:32,757 - INFO - WandB logging enabled
[rank3]:2025-10-27 09:24:32,901 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-10-27 09:24:32,940 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-10-27 09:24:32,970 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-10-27 09:24:32,970 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank3]:2025-10-27 09:24:33,471 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-10-27 09:24:33,472 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-10-27 09:24:33,473 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank0]:2025-10-27 09:24:33,487 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data3/shcho/torchtitan/checkpoint/1026_GPipe_timelyapf_dm1
[rank0]:2025-10-27 09:24:33,488 - WARNING - Mixed precision training with TP or PP is only supported when FSDP/HSDP/CP is enabled.
[rank0]:2025-10-27 09:24:33,488 - INFO - Mixed precision training is disabled
[rank0]:2025-10-27 09:24:33,488 - INFO - Preparing c4_validation dataset from allenai/c4
[rank0]:2025-10-27 09:24:39,107 - INFO - Trainer is initialized with local batch size 16, global batch size 64, gradient accumulation steps 4, sequence length 1024, total steps 1000 (warmup 100)
[rank0]:2025-10-27 09:24:39,107 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B-Instruct/original_dcp.
[rank0]:2025-10-27 09:24:41,083 - INFO - [GC] GC collection for checkpoint loading. 0.01 seconds
[rank0]:2025-10-27 09:24:41,083 - INFO - Finished loading the checkpoint in 1.98 seconds.
[rank0]:2025-10-27 09:24:41,083 - INFO - Training starts at step 1
[rank0]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/autograd/graph.py:849: UserWarning: Attempting to run cuBLAS, but there was no current CUDA context! Attempting to set the primary context... (Triggered internally at /pytorch/aten/src/ATen/cuda/CublasHandlePool.cpp:270.)
[rank0]:  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
[rank3]:2025-10-27 09:24:55,652 - INFO -  step:  1  loss:  1.2134  grad_norm: 43.3594  memory: 35.59GiB(74.92%)  tps: 721  tflops: 5.64  mfu: 1.81%
[rank3]:2025-10-27 09:24:55,652 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-10-27 09:24:55,646 - INFO -  step:  1  loss: -4.0000  grad_norm: 43.3594  memory: 17.77GiB(37.40%)  tps: 654  tflops: 5.11  mfu: 1.64%
[rank1]:2025-10-27 09:24:55,646 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-10-27 09:24:55,642 - INFO -  step:  1  loss: -4.0000  grad_norm: 43.3594  memory: 14.29GiB(30.07%)  tps: 647  tflops: 5.06  mfu: 1.62%
[rank2]:2025-10-27 09:24:55,642 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-10-27 09:24:55,678 - INFO -  step:  1  loss: -4.0000  grad_norm: 43.3594  memory: 17.10GiB(35.99%)  tps: 641  tflops: 5.01  mfu: 1.61%
[rank0]:2025-10-27 09:24:55,678 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-27 09:25:08,903 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 09:25:08,904 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 09:25:08,904 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 09:25:08,905 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 09:25:08,905 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 09:25:08,905 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 09:25:08,905 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 09:25:08,906 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 09:25:08,906 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 09:25:08,906 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 09:25:08,906 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 09:25:08,907 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 09:25:08,907 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 09:25:08,907 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 09:25:08,907 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 09:25:08,907 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 09:25:08,962 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 09:25:08,962 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 09:25:08,962 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 09:25:08,962 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 09:25:08,962 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 09:25:08,962 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 09:25:08,962 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 09:25:08,962 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 09:25:08,962 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 09:25:08,962 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 09:25:08,962 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 09:25:08,962 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 09:25:08,962 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 09:25:08,962 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 09:25:08,962 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 09:25:08,962 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 09:25:09,037 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 09:25:09,038 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 09:25:09,038 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 09:25:09,038 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 09:25:09,038 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 09:25:09,038 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 09:25:09,038 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 09:25:09,038 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 09:25:09,038 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 09:25:09,038 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 09:25:09,038 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 09:25:09,038 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 09:25:09,038 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 09:25:09,038 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 09:25:09,038 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 09:25:09,038 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 09:25:09,102 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 09:25:09,103 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 09:25:09,103 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 09:25:09,103 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 09:25:09,103 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 09:25:09,103 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 09:25:09,103 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 09:25:09,103 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 09:25:09,103 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 09:25:09,103 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 09:25:09,103 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 09:25:09,103 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 09:25:09,103 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 09:25:09,103 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 09:25:09,103 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 09:25:09,103 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 09:27:26,050 - INFO -  step: 20  loss: -4.0000  grad_norm: 132.7749  memory: 16.10GiB(33.90%)  tps: 2,070  tflops: 16.18  mfu: 5.19%
[rank1]:2025-10-27 09:27:26,054 - INFO -  step: 20  loss: -4.0000  grad_norm: 132.7749  memory: 20.03GiB(42.17%)  tps: 2,070  tflops: 16.18  mfu: 5.19%
[rank3]:2025-10-27 09:27:26,063 - INFO -  step: 20  loss:  3.8421  grad_norm: 132.7749  memory: 38.93GiB(81.95%)  tps: 2,070  tflops: 16.18  mfu: 5.19%
[rank0]:2025-10-27 09:27:26,069 - INFO -  step: 20  loss: -4.0000  grad_norm: 132.7749  memory: 20.89GiB(43.97%)  tps: 2,070  tflops: 16.18  mfu: 5.19%
[rank3]:2025-10-27 09:27:27,840 - INFO - Avg. fwd time: 70.6071 / Avg. bwd time: 127.3082 / Avg. batch time: 1649.5353 (ms) / GPU bubble ratio: 4.01%
[rank2]:2025-10-27 09:27:27,895 - INFO - Avg. fwd time: 32.7825 / Avg. bwd time: 53.4636 / Avg. batch time: 1739.1194 (ms) / GPU bubble ratio: 60.33%
[rank0]:2025-10-27 09:27:28,039 - INFO - Avg. fwd time: 45.2581 / Avg. bwd time: 59.7603 / Avg. batch time: 1954.9998 (ms) / GPU bubble ratio: 57.03%
[rank1]:2025-10-27 09:27:27,973 - INFO - Avg. fwd time: 48.7817 / Avg. bwd time: 72.6089 / Avg. batch time: 1857.4988 (ms) / GPU bubble ratio: 47.72%
[rank0]:2025-10-27 09:30:06,713 - INFO -  step: 40  loss: -4.0000  grad_norm:  0.6224  memory: 20.89GiB(43.97%)  tps: 2,040  tflops: 15.95  mfu: 5.11%
[rank1]:2025-10-27 09:30:06,692 - INFO -  step: 40  loss: -4.0000  grad_norm:  0.6224  memory: 20.03GiB(42.17%)  tps: 2,040  tflops: 15.95  mfu: 5.11%
[rank2]:2025-10-27 09:30:06,688 - INFO -  step: 40  loss: -4.0000  grad_norm:  0.6224  memory: 16.10GiB(33.90%)  tps: 2,040  tflops: 15.95  mfu: 5.11%
[rank3]:2025-10-27 09:30:06,700 - INFO -  step: 40  loss:  0.1930  grad_norm:  0.6224  memory: 38.93GiB(81.95%)  tps: 2,040  tflops: 15.95  mfu: 5.11%
[rank3]:2025-10-27 09:30:08,518 - INFO - Avg. fwd time: 71.6216 / Avg. bwd time: 129.2260 / Avg. batch time: 1663.6724 (ms) / GPU bubble ratio: 3.42%
[rank1]:2025-10-27 09:30:08,653 - INFO - Avg. fwd time: 50.0510 / Avg. bwd time: 73.3160 / Avg. batch time: 1872.7274 (ms) / GPU bubble ratio: 47.30%
[rank2]:2025-10-27 09:30:08,579 - INFO - Avg. fwd time: 33.0830 / Avg. bwd time: 53.8815 / Avg. batch time: 1753.5453 (ms) / GPU bubble ratio: 60.33%
[rank0]:2025-10-27 09:30:08,716 - INFO - Avg. fwd time: 45.5684 / Avg. bwd time: 60.4087 / Avg. batch time: 1971.0825 (ms) / GPU bubble ratio: 56.99%
[rank0]:2025-10-27 09:31:19,671 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-27 09:32:47,515 - INFO -  step: 60  loss: -4.0000  grad_norm:  0.6553  memory: 20.89GiB(43.97%)  tps: 2,038  tflops: 15.93  mfu: 5.11%
[rank1]:2025-10-27 09:32:47,504 - INFO -  step: 60  loss: -4.0000  grad_norm:  0.6553  memory: 20.03GiB(42.17%)  tps: 2,038  tflops: 15.93  mfu: 5.11%
[rank3]:2025-10-27 09:32:47,512 - INFO -  step: 60  loss:  0.1770  grad_norm:  0.6553  memory: 38.93GiB(81.95%)  tps: 2,038  tflops: 15.93  mfu: 5.11%
[rank2]:2025-10-27 09:32:47,500 - INFO -  step: 60  loss: -4.0000  grad_norm:  0.6553  memory: 16.10GiB(33.90%)  tps: 2,038  tflops: 15.93  mfu: 5.11%
[rank3]:2025-10-27 09:32:49,331 - INFO - Avg. fwd time: 72.1185 / Avg. bwd time: 129.9375 / Avg. batch time: 1669.5607 (ms) / GPU bubble ratio: 3.18%
[rank1]:2025-10-27 09:32:49,466 - INFO - Avg. fwd time: 50.1065 / Avg. bwd time: 73.5447 / Avg. batch time: 1878.4337 (ms) / GPU bubble ratio: 47.34%
[rank2]:2025-10-27 09:32:49,394 - INFO - Avg. fwd time: 33.2484 / Avg. bwd time: 53.9861 / Avg. batch time: 1759.3514 (ms) / GPU bubble ratio: 60.33%
[rank0]:2025-10-27 09:32:49,528 - INFO - Avg. fwd time: 45.4179 / Avg. bwd time: 60.6583 / Avg. batch time: 1977.1431 (ms) / GPU bubble ratio: 57.08%
[rank0]:2025-10-27 09:35:28,157 - INFO -  step: 80  loss: -4.0000  grad_norm:  3.1148  memory: 20.89GiB(43.97%)  tps: 2,040  tflops: 15.95  mfu: 5.11%
[rank1]:2025-10-27 09:35:28,146 - INFO -  step: 80  loss: -4.0000  grad_norm:  3.1148  memory: 20.03GiB(42.17%)  tps: 2,040  tflops: 15.95  mfu: 5.11%
[rank3]:2025-10-27 09:35:28,155 - INFO -  step: 80  loss:  0.1456  grad_norm:  3.1148  memory: 38.93GiB(81.95%)  tps: 2,040  tflops: 15.95  mfu: 5.11%
[rank2]:2025-10-27 09:35:28,143 - INFO -  step: 80  loss: -4.0000  grad_norm:  3.1148  memory: 16.10GiB(33.90%)  tps: 2,040  tflops: 15.95  mfu: 5.11%
[rank3]:2025-10-27 09:35:29,986 - INFO - Avg. fwd time: 72.2610 / Avg. bwd time: 130.2783 / Avg. batch time: 1671.6996 (ms) / GPU bubble ratio: 3.07%
[rank2]:2025-10-27 09:35:30,043 - INFO - Avg. fwd time: 33.3120 / Avg. bwd time: 53.9963 / Avg. batch time: 1761.6328 (ms) / GPU bubble ratio: 60.35%
[rank1]:2025-10-27 09:35:30,120 - INFO - Avg. fwd time: 50.4025 / Avg. bwd time: 73.6974 / Avg. batch time: 1880.7264 (ms) / GPU bubble ratio: 47.21%
[rank0]:2025-10-27 09:35:30,185 - INFO - Avg. fwd time: 45.6318 / Avg. bwd time: 60.7632 / Avg. batch time: 1979.6785 (ms) / GPU bubble ratio: 57.01%
[rank3]:2025-10-27 09:37:27,937 - INFO - [Step 95] ã€°ï¸ Monitoring Upperbound
[rank0]:2025-10-27 09:38:01,466 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-27 09:38:08,610 - INFO - [Step 100] âœ”ï¸  Setting Upperbound
[rank0]:2025-10-27 09:38:09,420 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.5477  memory: 20.89GiB(43.97%)  tps: 2,032  tflops: 15.88  mfu: 5.09%
[rank0]:2025-10-27 09:38:09,420 - INFO - ðŸ”Ž  Running validation at step 100
[rank1]:2025-10-27 09:38:09,420 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.5477  memory: 20.03GiB(42.17%)  tps: 2,032  tflops: 15.88  mfu: 5.09%
[rank1]:2025-10-27 09:38:09,421 - INFO - ðŸ”Ž  Running validation at step 100
[rank3]:2025-10-27 09:38:09,417 - INFO - [Step 100] ã€°ï¸ Monitoring Lowerbound
[rank2]:2025-10-27 09:38:09,420 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.5477  memory: 16.10GiB(33.90%)  tps: 2,032  tflops: 15.88  mfu: 5.09%
[rank2]:2025-10-27 09:38:09,420 - INFO - ðŸ”Ž  Running validation at step 100
[rank3]:2025-10-27 09:38:12,250 - INFO -  step: 100  loss:  0.1413  grad_norm:  0.5477  memory: 38.93GiB(81.95%)  tps: 1,997  tflops: 15.61  mfu: 5.00%
[rank3]:2025-10-27 09:38:12,250 - INFO - ðŸ”Ž  Running validation at step 100
[rank0]:2025-10-27 09:39:23,237 - INFO - validate step: 100  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,549
[rank1]:2025-10-27 09:39:23,317 - INFO - validate step: 100  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,543
[rank2]:2025-10-27 09:39:23,397 - INFO - validate step: 100  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,537
[rank0]:2025-10-27 09:39:23,560 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251027_0939_stage0_step100.svg
[rank3]:2025-10-27 09:39:23,480 - INFO - validate step: 100  loss:  0.2977  memory: 38.93GiB(81.95%)  tps: 5,750
[rank1]:2025-10-27 09:39:23,560 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251027_0939_stage1_step100.svg
[rank2]:2025-10-27 09:39:23,561 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251027_0939_stage2_step100.svg
[rank2]:2025-10-27 09:39:23,606 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-27 09:39:23,605 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-27 09:39:23,623 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-27 09:39:23,634 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-27 09:39:23,614 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-27 09:39:23,662 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-27 09:39:23,624 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-27 09:39:23,708 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-27 09:39:23,699 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1026_GPipe_timelyapf_dm1/pipeline_schedule/251027_0939_real_step100_rank3.svg
[rank3]:> Batch Time: 1932.27 ms, GPU Bubble Ratio: 55.61%, 47.90%, 64.02%, 15.38%
[rank3]:2025-10-27 09:39:23,762 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251027_0939_stage3_step100.svg
[rank2]:2025-10-27 09:39:23,785 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-27 09:39:23,812 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-27 09:39:23,801 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-27 09:39:23,817 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-27 09:39:23,829 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-27 09:39:23,839 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-27 09:39:23,859 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-27 09:39:23,909 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-27 09:39:23,941 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-27 09:39:23,929 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-27 09:39:24,019 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-27 09:39:24,089 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-27 09:39:24,103 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-27 09:39:24,180 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-27 09:39:24,268 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-27 09:39:24,252 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-27 09:39:24,504 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-27 09:39:24,573 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-27 09:39:24,640 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-27 09:39:24,698 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-27 09:39:24,703 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-27 09:39:24,765 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-27 09:39:24,826 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-27 09:39:24,896 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-27 09:39:25,417 - INFO - Avg. fwd time: 72.3078 / Avg. bwd time: 130.5296 / Avg. batch time: 1673.1915 (ms) / GPU bubble ratio: 3.02%
[rank2]:2025-10-27 09:39:25,470 - INFO - Avg. fwd time: 33.3194 / Avg. bwd time: 54.0448 / Avg. batch time: 1764.5440 (ms) / GPU bubble ratio: 60.39%
[rank1]:2025-10-27 09:39:25,538 - INFO - Avg. fwd time: 50.5328 / Avg. bwd time: 73.8257 / Avg. batch time: 1883.6425 (ms) / GPU bubble ratio: 47.18%
[rank0]:2025-10-27 09:39:25,596 - INFO - Avg. fwd time: 45.7799 / Avg. bwd time: 60.8239 / Avg. batch time: 1982.6735 (ms) / GPU bubble ratio: 56.99%
[rank3]:2025-10-27 09:39:50,849 - INFO - [Step 105] âœ”ï¸  Setting Lowerbound
[rank3]:2025-10-27 09:39:51,772 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1026_GPipe_timelyapf_dm1/pipeline_schedule/251027_0939_max_batch_time.svg
[rank3]:> Batch Time: 1958.38 ms, GPU Bubble Ratio: 55.48%, 48.10%, 64.09%, 15.56%
[rank3]:2025-10-27 09:39:51,957 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1026_GPipe_timelyapf_dm1/pipeline_schedule/251027_0939_min_batch_time.svg
[rank3]:> Batch Time: 1308.96 ms, GPU Bubble Ratio: 70.91%, 44.56%, 61.53%, 14.01%
[rank3]:2025-10-27 09:39:52,158 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1026_GPipe_timelyapf_dm1/pipeline_schedule/251027_0939_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 1308.96 ms, GPU Bubble Ratio: 41.05%, 31.28%, 48.24%, 14.01%
[rank3]:2025-10-27 09:39:52,158 - INFO - 	> Batch Time: 1308.96 ms (Average Freeze Ratio: 0.43, Time Reduction Rate: 0.33)
[rank1]:2025-10-27 09:41:26,672 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.64/0.64, [MB3] 0.18/0.18, [MB4] 0.02/0.02, [MB5] 0.37/0.37, [MB6] 0.98/0.98, [MB7] 1.00/1.00
[rank1]:2025-10-27 09:41:26,673 - INFO -  step: 120  loss: -4.0000  grad_norm:  0.0353  memory: 20.03GiB(42.17%)  tps: 2,656  tflops: 20.77  mfu: 6.66%
[rank2]:2025-10-27 09:41:26,672 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-27 09:41:26,672 - INFO -  step: 120  loss: -4.0000  grad_norm:  0.0353  memory: 16.10GiB(33.90%)  tps: 2,658  tflops: 20.78  mfu: 6.66%
[rank0]:2025-10-27 09:41:26,671 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.35/0.35, [MB6] 0.33/0.33, [MB7] 1.00/1.00
[rank0]:2025-10-27 09:41:26,672 - INFO -  step: 120  loss: -4.0000  grad_norm:  0.0353  memory: 20.89GiB(43.97%)  tps: 2,655  tflops: 20.75  mfu: 6.65%
[rank3]:2025-10-27 09:41:29,485 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-27 09:41:29,488 - INFO -  step: 120  loss:  0.1349  grad_norm:  0.0353  memory: 38.93GiB(81.95%)  tps: 2,600  tflops: 20.33  mfu: 6.52%
[rank3]:2025-10-27 09:41:30,707 - INFO - Avg. fwd time: 72.3326 / Avg. bwd time: 120.6940 / Avg. batch time: 1594.0126 (ms) / GPU bubble ratio: 3.12%
[rank2]:2025-10-27 09:41:30,746 - INFO - Avg. fwd time: 33.3164 / Avg. bwd time: 50.4602 / Avg. batch time: 1705.4914 (ms) / GPU bubble ratio: 60.70%
[rank0]:2025-10-27 09:41:30,831 - INFO - Avg. fwd time: 45.7774 / Avg. bwd time: 53.7117 / Avg. batch time: 1911.4009 (ms) / GPU bubble ratio: 58.36%
[rank1]:2025-10-27 09:41:30,794 - INFO - Avg. fwd time: 50.7946 / Avg. bwd time: 68.7429 / Avg. batch time: 1819.6656 (ms) / GPU bubble ratio: 47.45%
[rank3]:2025-10-27 09:43:26,981 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1026_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251027_0943_rank3_trend_line.svg
[rank1]:2025-10-27 09:43:27,002 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1026_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251027_0943_rank1_trend_line.svg
[rank1]:2025-10-27 09:43:27,008 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-10-27 09:43:27,010 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-10-27 09:43:27,010 - INFO -  step: 140  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,723  tflops: 21.29  mfu: 6.82%
[rank2]:2025-10-27 09:43:26,980 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1026_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251027_0943_rank2_trend_line.svg
[rank2]:2025-10-27 09:43:27,008 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-27 09:43:27,010 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-27 09:43:27,010 - INFO -  step: 140  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,723  tflops: 21.29  mfu: 6.82%
[rank0]:2025-10-27 09:43:27,001 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1026_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251027_0943_rank0_trend_line.svg
[rank0]:2025-10-27 09:43:27,008 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-27 09:43:27,010 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-27 09:43:27,010 - INFO -  step: 140  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,723  tflops: 21.29  mfu: 6.82%
[rank3]:2025-10-27 09:43:27,203 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1026_GPipe_timelyapf_dm1/pipeline_schedule/251027_0943_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 1321.47 ms, GPU Bubble Ratio: 64.30%, 43.47%, 60.62%, 14.65%
[rank3]:2025-10-27 09:43:27,204 - INFO - 	> Batch Time: 1321.47 ms (Average Freeze Ratio: 0.34)
[rank3]:2025-10-27 09:43:27,204 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-27 09:43:30,069 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-27 09:43:30,072 - INFO -  step: 140  loss:  0.1434  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,717  tflops: 21.24  mfu: 6.81%
[rank3]:2025-10-27 09:43:31,274 - INFO - Avg. fwd time: 72.3033 / Avg. bwd time: 113.1484 / Avg. batch time: 1533.1802 (ms) / GPU bubble ratio: 3.23%
[rank2]:2025-10-27 09:43:31,307 - INFO - Avg. fwd time: 33.3048 / Avg. bwd time: 47.3912 / Avg. batch time: 1658.1394 (ms) / GPU bubble ratio: 61.07%
[rank0]:2025-10-27 09:43:31,352 - INFO - Avg. fwd time: 45.7118 / Avg. bwd time: 46.0526 / Avg. batch time: 1851.9693 (ms) / GPU bubble ratio: 60.36%
[rank1]:2025-10-27 09:43:31,348 - INFO - Avg. fwd time: 51.0588 / Avg. bwd time: 64.4587 / Avg. batch time: 1768.2443 (ms) / GPU bubble ratio: 47.74%
[rank0]:2025-10-27 09:44:21,801 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-27 09:45:27,647 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1026_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251027_0945_rank0_trend_line.svg
[rank3]:2025-10-27 09:45:27,628 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1026_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251027_0945_rank3_trend_line.svg
[rank1]:2025-10-27 09:45:27,649 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1026_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251027_0945_rank1_trend_line.svg
[rank1]:2025-10-27 09:45:27,656 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank1]:2025-10-27 09:45:27,657 - INFO -  step: 160  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,716  tflops: 21.23  mfu: 6.81%
[rank2]:2025-10-27 09:45:27,627 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1026_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251027_0945_rank2_trend_line.svg
[rank2]:2025-10-27 09:45:27,655 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-27 09:45:27,657 - INFO -  step: 160  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,716  tflops: 21.23  mfu: 6.81%
[rank0]:2025-10-27 09:45:27,656 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-27 09:45:27,657 - INFO -  step: 160  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,716  tflops: 21.23  mfu: 6.81%
[rank3]:2025-10-27 09:45:27,852 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1026_GPipe_timelyapf_dm1/pipeline_schedule/251027_0945_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 1317.74 ms, GPU Bubble Ratio: 66.91%, 44.20%, 61.00%, 14.44%
[rank3]:2025-10-27 09:45:27,853 - INFO - 	> Batch Time: 1317.74 ms (Average Freeze Ratio: 0.31)
[rank3]:2025-10-27 09:45:27,853 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-27 09:45:30,835 - INFO -  step: 160  loss:  0.1143  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,714  tflops: 21.21  mfu: 6.80%
[rank3]:2025-10-27 09:45:32,056 - INFO - Avg. fwd time: 72.3379 / Avg. bwd time: 107.5128 / Avg. batch time: 1488.1591 (ms) / GPU bubble ratio: 3.32%
[rank2]:2025-10-27 09:45:32,089 - INFO - Avg. fwd time: 33.3098 / Avg. bwd time: 45.0909 / Avg. batch time: 1623.0613 (ms) / GPU bubble ratio: 61.36%
[rank0]:2025-10-27 09:45:32,135 - INFO - Avg. fwd time: 45.6402 / Avg. bwd time: 40.3053 / Avg. batch time: 1807.7852 (ms) / GPU bubble ratio: 61.97%
[rank1]:2025-10-27 09:45:32,132 - INFO - Avg. fwd time: 51.2957 / Avg. bwd time: 61.2259 / Avg. batch time: 1730.0784 (ms) / GPU bubble ratio: 47.97%
[rank0]:2025-10-27 09:47:45,222 - INFO -  step: 180  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,382  tflops: 18.62  mfu: 5.97%
[rank1]:2025-10-27 09:47:45,245 - INFO -  step: 180  loss: -4.0000  grad_norm:  0.0618  memory: 20.03GiB(42.17%)  tps: 2,382  tflops: 18.62  mfu: 5.97%
[rank2]:2025-10-27 09:47:45,222 - INFO -  step: 180  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,382  tflops: 18.62  mfu: 5.97%
[rank3]:2025-10-27 09:47:48,001 - INFO -  step: 180  loss:  0.1370  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,389  tflops: 18.68  mfu: 5.99%
[rank3]:2025-10-27 09:47:49,176 - INFO - Avg. fwd time: 72.3076 / Avg. bwd time: 103.0830 / Avg. batch time: 1452.3630 (ms) / GPU bubble ratio: 3.39%
[rank2]:2025-10-27 09:47:49,324 - INFO - Avg. fwd time: 33.2856 / Avg. bwd time: 43.2690 / Avg. batch time: 1606.4567 (ms) / GPU bubble ratio: 61.88%
[rank1]:2025-10-27 09:47:49,476 - INFO - Avg. fwd time: 51.5060 / Avg. bwd time: 64.1363 / Avg. batch time: 1723.5355 (ms) / GPU bubble ratio: 46.32%
[rank0]:2025-10-27 09:47:49,480 - INFO - Avg. fwd time: 45.5276 / Avg. bwd time: 35.8333 / Avg. batch time: 1796.5463 (ms) / GPU bubble ratio: 63.77%
[rank0]:2025-10-27 09:49:55,484 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-27 09:50:01,849 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1026_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251027_0950_rank2_trend_line.svg
[rank1]:2025-10-27 09:50:01,873 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1026_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251027_0950_rank1_trend_line.svg
[rank1]:2025-10-27 09:50:01,880 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-10-27 09:50:01,881 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.0614  memory: 20.03GiB(42.17%)  tps: 2,398  tflops: 18.75  mfu: 6.01%
[rank1]:2025-10-27 09:50:01,882 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-10-27 09:50:01,868 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1026_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251027_0950_rank0_trend_line.svg
[rank0]:2025-10-27 09:50:01,880 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank0]:2025-10-27 09:50:01,881 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,398  tflops: 18.74  mfu: 6.01%
[rank0]:2025-10-27 09:50:01,881 - INFO - ðŸ”Ž  Running validation at step 200
[rank3]:2025-10-27 09:50:01,850 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1026_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251027_0950_rank3_trend_line.svg
[rank2]:2025-10-27 09:50:01,880 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-27 09:50:01,882 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,398  tflops: 18.74  mfu: 6.01%
[rank2]:2025-10-27 09:50:01,882 - INFO - ðŸ”Ž  Running validation at step 200
[rank3]:2025-10-27 09:50:02,077 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1026_GPipe_timelyapf_dm1/pipeline_schedule/251027_0950_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 1308.11 ms, GPU Bubble Ratio: 68.52%, 31.24%, 61.15%, 13.93%
[rank3]:2025-10-27 09:50:02,077 - INFO - 	> Batch Time: 1308.11 ms (Average Freeze Ratio: 0.31)
[rank3]:2025-10-27 09:50:02,078 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-27 09:50:04,927 - INFO -  step: 200  loss:  0.1431  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,393  tflops: 18.71  mfu: 6.00%
[rank3]:2025-10-27 09:50:04,927 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-10-27 09:51:13,497 - INFO - validate step: 200  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,719
[rank1]:2025-10-27 09:51:13,582 - INFO - validate step: 200  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,713
[rank2]:2025-10-27 09:51:13,660 - INFO - validate step: 200  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,707
[rank3]:2025-10-27 09:51:13,741 - INFO - validate step: 200  loss:  0.2934  memory: 38.93GiB(81.95%)  tps: 5,952
[rank2]:2025-10-27 09:51:13,820 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251027_0951_stage2_step200.svg
[rank1]:2025-10-27 09:51:13,820 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251027_0951_stage1_step200.svg
[rank0]:2025-10-27 09:51:13,819 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251027_0951_stage0_step200.svg
[rank3]:2025-10-27 09:51:13,946 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1026_GPipe_timelyapf_dm1/pipeline_schedule/251027_0951_real_step200_rank3.svg
[rank3]:> Batch Time: 1851.94 ms, GPU Bubble Ratio: 55.77%, 46.00%, 63.86%, 15.79%
[rank3]:2025-10-27 09:51:14,017 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251027_0951_stage3_step200.svg
[rank3]:2025-10-27 09:51:15,196 - INFO - Avg. fwd time: 72.2179 / Avg. bwd time: 99.4992 / Avg. batch time: 1422.8329 (ms) / GPU bubble ratio: 3.45%
[rank2]:2025-10-27 09:51:15,332 - INFO - Avg. fwd time: 33.2707 / Avg. bwd time: 41.8023 / Avg. batch time: 1588.8697 (ms) / GPU bubble ratio: 62.20%
[rank1]:2025-10-27 09:51:15,482 - INFO - Avg. fwd time: 51.6629 / Avg. bwd time: 66.4176 / Avg. batch time: 1714.0057 (ms) / GPU bubble ratio: 44.89%
[rank0]:2025-10-27 09:51:15,486 - INFO - Avg. fwd time: 45.4429 / Avg. bwd time: 32.2547 / Avg. batch time: 1783.2615 (ms) / GPU bubble ratio: 65.14%
[rank2]:2025-10-27 09:53:23,014 - INFO -  step: 220  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,533  tflops: 19.80  mfu: 6.35%
[rank1]:2025-10-27 09:53:23,014 - INFO -  step: 220  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,532  tflops: 19.79  mfu: 6.34%
[rank0]:2025-10-27 09:53:23,048 - INFO -  step: 220  loss: -4.0000  grad_norm:  0.1486  memory: 20.89GiB(43.97%)  tps: 2,529  tflops: 19.77  mfu: 6.34%
[rank3]:2025-10-27 09:53:25,841 - INFO -  step: 220  loss:  0.1480  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,481  tflops: 19.39  mfu: 6.22%
[rank3]:2025-10-27 09:53:27,035 - INFO - Avg. fwd time: 72.2665 / Avg. bwd time: 96.6301 / Avg. batch time: 1400.0491 (ms) / GPU bubble ratio: 3.49%
[rank2]:2025-10-27 09:53:27,069 - INFO - Avg. fwd time: 33.2738 / Avg. bwd time: 40.6394 / Avg. batch time: 1569.3873 (ms) / GPU bubble ratio: 62.32%
[rank1]:2025-10-27 09:53:27,128 - INFO - Avg. fwd time: 51.6737 / Avg. bwd time: 63.8889 / Avg. batch time: 1692.4490 (ms) / GPU bubble ratio: 45.37%
[rank0]:2025-10-27 09:53:27,241 - INFO - Avg. fwd time: 45.5698 / Avg. bwd time: 35.8798 / Avg. batch time: 1768.9107 (ms) / GPU bubble ratio: 63.16%
[rank3]:2025-10-27 09:55:35,140 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1026_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251027_0955_rank3_trend_line.svg
[rank1]:2025-10-27 09:55:35,139 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1026_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251027_0955_rank1_trend_line.svg
[rank1]:2025-10-27 09:55:35,183 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-10-27 09:55:35,184 - INFO -  step: 240  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,479  tflops: 19.38  mfu: 6.21%
[rank2]:2025-10-27 09:55:35,138 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1026_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251027_0955_rank2_trend_line.svg
[rank2]:2025-10-27 09:55:35,183 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank2]:2025-10-27 09:55:35,184 - INFO -  step: 240  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,479  tflops: 19.38  mfu: 6.21%
[rank0]:2025-10-27 09:55:35,176 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1026_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251027_0955_rank0_trend_line.svg
[rank0]:2025-10-27 09:55:35,183 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-27 09:55:35,184 - INFO -  step: 240  loss: -4.0000  grad_norm:  0.3403  memory: 20.89GiB(43.97%)  tps: 2,480  tflops: 19.39  mfu: 6.21%
[rank3]:2025-10-27 09:55:35,380 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1026_GPipe_timelyapf_dm1/pipeline_schedule/251027_0955_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 1306.68 ms, GPU Bubble Ratio: 56.89%, 34.90%, 61.22%, 13.84%
[rank3]:2025-10-27 09:55:35,381 - INFO - 	> Batch Time: 1306.68 ms (Average Freeze Ratio: 0.31)
[rank3]:2025-10-27 09:55:35,381 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-27 09:55:38,217 - INFO -  step: 240  loss:  0.1638  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,475  tflops: 19.35  mfu: 6.20%
[rank3]:2025-10-27 09:55:39,422 - INFO - Avg. fwd time: 72.2896 / Avg. bwd time: 94.2299 / Avg. batch time: 1380.8598 (ms) / GPU bubble ratio: 3.53%
[rank1]:2025-10-27 09:55:39,515 - INFO - Avg. fwd time: 51.6772 / Avg. bwd time: 61.7583 / Avg. batch time: 1674.8575 (ms) / GPU bubble ratio: 45.82%
[rank2]:2025-10-27 09:55:39,456 - INFO - Avg. fwd time: 33.2927 / Avg. bwd time: 39.6663 / Avg. batch time: 1553.2175 (ms) / GPU bubble ratio: 62.42%
[rank0]:2025-10-27 09:55:39,621 - INFO - Avg. fwd time: 45.7111 / Avg. bwd time: 38.9566 / Avg. batch time: 1757.4187 (ms) / GPU bubble ratio: 61.46%
[rank0]:2025-10-27 09:56:31,683 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-27 09:57:40,023 - INFO -  step: 260  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,625  tflops: 20.52  mfu: 6.58%
[rank2]:2025-10-27 09:57:40,036 - INFO -  step: 260  loss: -4.0000  grad_norm:  0.0585  memory: 16.10GiB(33.90%)  tps: 2,625  tflops: 20.52  mfu: 6.58%
[rank1]:2025-10-27 09:57:40,023 - INFO -  step: 260  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,625  tflops: 20.52  mfu: 6.58%
[rank3]:2025-10-27 09:57:42,853 - INFO -  step: 260  loss:  0.1388  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,629  tflops: 20.55  mfu: 6.59%
[rank3]:2025-10-27 09:57:44,012 - INFO - Avg. fwd time: 72.1918 / Avg. bwd time: 92.1686 / Avg. batch time: 1363.5419 (ms) / GPU bubble ratio: 3.57%
[rank2]:2025-10-27 09:57:44,122 - INFO - Avg. fwd time: 33.2761 / Avg. bwd time: 41.6241 / Avg. batch time: 1543.4300 (ms) / GPU bubble ratio: 61.18%
[rank1]:2025-10-27 09:57:44,163 - INFO - Avg. fwd time: 51.7578 / Avg. bwd time: 59.9559 / Avg. batch time: 1662.1867 (ms) / GPU bubble ratio: 46.23%
[rank0]:2025-10-27 09:57:44,167 - INFO - Avg. fwd time: 45.6999 / Avg. bwd time: 35.9630 / Avg. batch time: 1741.1409 (ms) / GPU bubble ratio: 62.48%
[rank0]:2025-10-27 09:59:44,384 - INFO -  step: 280  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,635  tflops: 20.60  mfu: 6.60%
[rank2]:2025-10-27 09:59:44,397 - INFO -  step: 280  loss: -4.0000  grad_norm:  0.0578  memory: 16.10GiB(33.90%)  tps: 2,635  tflops: 20.60  mfu: 6.60%
[rank1]:2025-10-27 09:59:44,384 - INFO -  step: 280  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,635  tflops: 20.60  mfu: 6.60%
[rank3]:2025-10-27 09:59:47,251 - INFO -  step: 280  loss:  0.1648  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,634  tflops: 20.59  mfu: 6.60%
[rank3]:2025-10-27 09:59:48,419 - INFO - Avg. fwd time: 72.1009 / Avg. bwd time: 90.3944 / Avg. batch time: 1348.5097 (ms) / GPU bubble ratio: 3.60%
[rank2]:2025-10-27 09:59:48,531 - INFO - Avg. fwd time: 33.2827 / Avg. bwd time: 43.3252 / Avg. batch time: 1535.0494 (ms) / GPU bubble ratio: 60.08%
[rank1]:2025-10-27 09:59:48,573 - INFO - Avg. fwd time: 51.7756 / Avg. bwd time: 58.4041 / Avg. batch time: 1651.2836 (ms) / GPU bubble ratio: 46.62%
[rank0]:2025-10-27 09:59:48,578 - INFO - Avg. fwd time: 45.6502 / Avg. bwd time: 33.3966 / Avg. batch time: 1727.1235 (ms) / GPU bubble ratio: 63.39%
[rank0]:2025-10-27 10:01:43,361 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-27 10:01:49,093 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.0362  memory: 16.10GiB(33.90%)  tps: 2,628  tflops: 20.54  mfu: 6.58%
[rank2]:2025-10-27 10:01:49,093 - INFO - ðŸ”Ž  Running validation at step 300
[rank1]:2025-10-27 10:01:49,079 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,628  tflops: 20.54  mfu: 6.58%
[rank1]:2025-10-27 10:01:49,079 - INFO - ðŸ”Ž  Running validation at step 300
[rank0]:2025-10-27 10:01:49,080 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,628  tflops: 20.54  mfu: 6.58%
[rank0]:2025-10-27 10:01:49,088 - INFO - ðŸ”Ž  Running validation at step 300
[rank3]:2025-10-27 10:01:51,952 - INFO -  step: 300  loss:  0.1132  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,628  tflops: 20.54  mfu: 6.58%
[rank3]:2025-10-27 10:01:51,952 - INFO - ðŸ”Ž  Running validation at step 300
[rank0]:2025-10-27 10:02:59,877 - INFO - validate step: 300  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,786
[rank1]:2025-10-27 10:02:59,955 - INFO - validate step: 300  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,779
[rank2]:2025-10-27 10:03:00,041 - INFO - validate step: 300  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,773
[rank3]:2025-10-27 10:03:00,116 - INFO - validate step: 300  loss:  0.2960  memory: 38.93GiB(81.95%)  tps: 6,009
[rank2]:2025-10-27 10:03:00,192 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251027_1003_stage2_step300.svg
[rank0]:2025-10-27 10:03:00,192 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251027_1002_stage0_step300.svg
[rank1]:2025-10-27 10:03:00,192 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251027_1002_stage1_step300.svg
[rank3]:2025-10-27 10:03:00,308 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1026_GPipe_timelyapf_dm1/pipeline_schedule/251027_1003_real_step300_rank3.svg
[rank3]:> Batch Time: 1376.22 ms, GPU Bubble Ratio: 53.59%, 43.15%, 51.02%, 17.70%
[rank3]:2025-10-27 10:03:00,377 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251027_1003_stage3_step300.svg
[rank3]:2025-10-27 10:03:01,584 - INFO - Avg. fwd time: 72.0283 / Avg. bwd time: 88.8570 / Avg. batch time: 1335.5980 (ms) / GPU bubble ratio: 3.63%
[rank2]:2025-10-27 10:03:01,679 - INFO - Avg. fwd time: 33.2905 / Avg. bwd time: 44.8026 / Avg. batch time: 1525.7689 (ms) / GPU bubble ratio: 59.05%
[rank0]:2025-10-27 10:03:01,726 - INFO - Avg. fwd time: 45.6124 / Avg. bwd time: 31.1722 / Avg. batch time: 1712.9906 (ms) / GPU bubble ratio: 64.14%
[rank1]:2025-10-27 10:03:01,721 - INFO - Avg. fwd time: 51.8001 / Avg. bwd time: 57.0605 / Avg. batch time: 1639.8380 (ms) / GPU bubble ratio: 46.89%
[rank2]:2025-10-27 10:05:03,337 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1026_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251027_1005_rank2_trend_line.svg
[rank2]:2025-10-27 10:05:03,371 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-27 10:05:03,373 - INFO -  step: 320  loss: -4.0000  grad_norm:  0.0633  memory: 16.10GiB(33.90%)  tps: 2,657  tflops: 20.77  mfu: 6.66%
[rank3]:2025-10-27 10:05:03,327 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1026_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251027_1005_rank3_trend_line.svg
[rank0]:2025-10-27 10:05:03,365 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1026_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251027_1005_rank0_trend_line.svg
[rank0]:2025-10-27 10:05:03,371 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-27 10:05:03,373 - INFO -  step: 320  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,653  tflops: 20.74  mfu: 6.65%
[rank1]:2025-10-27 10:05:03,365 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1026_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251027_1005_rank1_trend_line.svg
[rank1]:2025-10-27 10:05:03,371 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-10-27 10:05:03,373 - INFO -  step: 320  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,655  tflops: 20.76  mfu: 6.65%
[rank3]:2025-10-27 10:05:03,568 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1026_GPipe_timelyapf_dm1/pipeline_schedule/251027_1005_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 1307.86 ms, GPU Bubble Ratio: 61.62%, 38.78%, 53.65%, 13.97%
[rank3]:2025-10-27 10:05:03,569 - INFO - 	> Batch Time: 1307.86 ms (Average Freeze Ratio: 0.34)
[rank3]:2025-10-27 10:05:03,569 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-27 10:05:06,445 - INFO -  step: 320  loss:  0.1490  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,594  tflops: 20.28  mfu: 6.50%
[rank3]:2025-10-27 10:05:07,650 - INFO - Avg. fwd time: 72.0285 / Avg. bwd time: 87.5549 / Avg. batch time: 1325.2179 (ms) / GPU bubble ratio: 3.66%
[rank2]:2025-10-27 10:05:07,746 - INFO - Avg. fwd time: 33.2989 / Avg. bwd time: 46.0821 / Avg. batch time: 1520.5592 (ms) / GPU bubble ratio: 58.24%
[rank0]:2025-10-27 10:05:07,793 - INFO - Avg. fwd time: 45.6082 / Avg. bwd time: 29.2256 / Avg. batch time: 1703.6261 (ms) / GPU bubble ratio: 64.86%
[rank1]:2025-10-27 10:05:07,788 - INFO - Avg. fwd time: 51.9199 / Avg. bwd time: 55.8939 / Avg. batch time: 1632.8076 (ms) / GPU bubble ratio: 47.18%
[rank0]:2025-10-27 10:07:03,359 - INFO -  step: 340  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,731  tflops: 21.35  mfu: 6.84%
[rank1]:2025-10-27 10:07:03,359 - INFO -  step: 340  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,731  tflops: 21.35  mfu: 6.84%
[rank2]:2025-10-27 10:07:03,358 - INFO -  step: 340  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,731  tflops: 21.35  mfu: 6.84%
[rank3]:2025-10-27 10:07:06,206 - INFO -  step: 340  loss:  0.1565  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,736  tflops: 21.39  mfu: 6.86%
[rank3]:2025-10-27 10:07:07,351 - INFO - Avg. fwd time: 71.9848 / Avg. bwd time: 86.3605 / Avg. batch time: 1315.3821 (ms) / GPU bubble ratio: 3.70%
[rank2]:2025-10-27 10:07:07,385 - INFO - Avg. fwd time: 33.2931 / Avg. bwd time: 45.0810 / Avg. batch time: 1511.3834 (ms) / GPU bubble ratio: 58.52%
[rank0]:2025-10-27 10:07:07,432 - INFO - Avg. fwd time: 45.5702 / Avg. bwd time: 27.5078 / Avg. batch time: 1690.8045 (ms) / GPU bubble ratio: 65.42%
[rank1]:2025-10-27 10:07:07,427 - INFO - Avg. fwd time: 51.9867 / Avg. bwd time: 54.8876 / Avg. batch time: 1622.0635 (ms) / GPU bubble ratio: 47.29%
[rank0]:2025-10-27 10:07:57,417 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-27 10:09:02,712 - INFO -  step: 360  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,745  tflops: 21.46  mfu: 6.88%
[rank1]:2025-10-27 10:09:02,712 - INFO -  step: 360  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,745  tflops: 21.46  mfu: 6.88%
[rank2]:2025-10-27 10:09:02,711 - INFO -  step: 360  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,745  tflops: 21.46  mfu: 6.88%
[rank3]:2025-10-27 10:09:05,578 - INFO -  step: 360  loss:  0.1155  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,745  tflops: 21.46  mfu: 6.88%
[rank3]:2025-10-27 10:09:06,756 - INFO - Avg. fwd time: 71.9250 / Avg. bwd time: 85.2980 / Avg. batch time: 1306.5078 (ms) / GPU bubble ratio: 3.73%
[rank1]:2025-10-27 10:09:06,832 - INFO - Avg. fwd time: 52.0746 / Avg. bwd time: 53.9892 / Avg. batch time: 1612.3269 (ms) / GPU bubble ratio: 47.37%
[rank2]:2025-10-27 10:09:06,790 - INFO - Avg. fwd time: 33.2799 / Avg. bwd time: 44.1862 / Avg. batch time: 1503.0404 (ms) / GPU bubble ratio: 58.77%
[rank0]:2025-10-27 10:09:06,932 - INFO - Avg. fwd time: 45.5208 / Avg. bwd time: 25.9808 / Avg. batch time: 1679.2178 (ms) / GPU bubble ratio: 65.94%
[rank0]:2025-10-27 10:11:02,940 - INFO -  step: 380  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,725  tflops: 21.31  mfu: 6.83%
[rank2]:2025-10-27 10:11:02,940 - INFO -  step: 380  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,725  tflops: 21.31  mfu: 6.83%
[rank1]:2025-10-27 10:11:02,940 - INFO -  step: 380  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,725  tflops: 21.31  mfu: 6.83%
[rank3]:2025-10-27 10:11:05,778 - INFO -  step: 380  loss:  0.1179  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,726  tflops: 21.31  mfu: 6.83%
[rank3]:2025-10-27 10:11:06,976 - INFO - Avg. fwd time: 71.9215 / Avg. bwd time: 84.3579 / Avg. batch time: 1298.9797 (ms) / GPU bubble ratio: 3.75%
[rank2]:2025-10-27 10:11:07,010 - INFO - Avg. fwd time: 33.2734 / Avg. bwd time: 43.3850 / Avg. batch time: 1496.0857 (ms) / GPU bubble ratio: 59.01%
[rank0]:2025-10-27 10:11:07,057 - INFO - Avg. fwd time: 45.4927 / Avg. bwd time: 24.6144 / Avg. batch time: 1669.3430 (ms) / GPU bubble ratio: 66.40%
[rank1]:2025-10-27 10:11:07,052 - INFO - Avg. fwd time: 52.1124 / Avg. bwd time: 53.1874 / Avg. batch time: 1604.1026 (ms) / GPU bubble ratio: 47.48%
[rank0]:2025-10-27 10:12:57,774 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-27 10:13:03,356 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,721  tflops: 21.27  mfu: 6.82%
[rank0]:2025-10-27 10:13:03,364 - INFO - ðŸ”Ž  Running validation at step 400
[rank2]:2025-10-27 10:13:03,356 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,721  tflops: 21.27  mfu: 6.82%
[rank2]:2025-10-27 10:13:03,356 - INFO - ðŸ”Ž  Running validation at step 400
[rank1]:2025-10-27 10:13:03,356 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,721  tflops: 21.27  mfu: 6.82%
[rank1]:2025-10-27 10:13:03,364 - INFO - ðŸ”Ž  Running validation at step 400
[rank3]:2025-10-27 10:13:06,193 - INFO -  step: 400  loss:  0.1088  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,721  tflops: 21.27  mfu: 6.82%
[rank3]:2025-10-27 10:13:06,194 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-10-27 10:14:15,060 - INFO - validate step: 400  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,713
[rank1]:2025-10-27 10:14:15,140 - INFO - validate step: 400  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,707
[rank2]:2025-10-27 10:14:15,222 - INFO - validate step: 400  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,700
[rank3]:2025-10-27 10:14:15,303 - INFO - validate step: 400  loss:  0.2947  memory: 38.93GiB(81.95%)  tps: 5,927
[rank2]:2025-10-27 10:14:15,383 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251027_1014_stage2_step400.svg
[rank0]:2025-10-27 10:14:15,382 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251027_1014_stage0_step400.svg
[rank1]:2025-10-27 10:14:15,382 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251027_1014_stage1_step400.svg
[rank3]:2025-10-27 10:14:15,491 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1026_GPipe_timelyapf_dm1/pipeline_schedule/251027_1014_real_step400_rank3.svg
[rank3]:> Batch Time: 1310.02 ms, GPU Bubble Ratio: 72.09%, 43.66%, 61.75%, 13.90%
[rank3]:2025-10-27 10:14:15,563 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251027_1014_stage3_step400.svg
[rank3]:2025-10-27 10:14:16,798 - INFO - Avg. fwd time: 71.9398 / Avg. bwd time: 83.5315 / Avg. batch time: 1292.5272 (ms) / GPU bubble ratio: 3.77%
[rank2]:2025-10-27 10:14:16,833 - INFO - Avg. fwd time: 33.2750 / Avg. bwd time: 42.6649 / Avg. batch time: 1488.3259 (ms) / GPU bubble ratio: 59.18%
[rank0]:2025-10-27 10:14:16,880 - INFO - Avg. fwd time: 45.4833 / Avg. bwd time: 23.3845 / Avg. batch time: 1658.9972 (ms) / GPU bubble ratio: 66.79%
[rank1]:2025-10-27 10:14:16,876 - INFO - Avg. fwd time: 52.1853 / Avg. bwd time: 52.4678 / Avg. batch time: 1595.2404 (ms) / GPU bubble ratio: 47.52%
[rank2]:2025-10-27 10:16:12,902 - INFO -  step: 420  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,784  tflops: 21.77  mfu: 6.98%
[rank0]:2025-10-27 10:16:12,903 - INFO -  step: 420  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,781  tflops: 21.74  mfu: 6.97%
[rank1]:2025-10-27 10:16:12,903 - INFO -  step: 420  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,783  tflops: 21.75  mfu: 6.97%
[rank3]:2025-10-27 10:16:15,750 - INFO -  step: 420  loss:  0.1374  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,721  tflops: 21.27  mfu: 6.82%
[rank3]:2025-10-27 10:16:16,908 - INFO - Avg. fwd time: 71.9390 / Avg. bwd time: 82.7739 / Avg. batch time: 1286.4670 (ms) / GPU bubble ratio: 3.79%
[rank2]:2025-10-27 10:16:16,948 - INFO - Avg. fwd time: 33.2736 / Avg. bwd time: 42.0114 / Avg. batch time: 1482.6974 (ms) / GPU bubble ratio: 59.38%
[rank1]:2025-10-27 10:16:16,995 - INFO - Avg. fwd time: 52.2376 / Avg. bwd time: 51.8195 / Avg. batch time: 1588.6128 (ms) / GPU bubble ratio: 47.60%
[rank0]:2025-10-27 10:16:17,000 - INFO - Avg. fwd time: 45.4863 / Avg. bwd time: 22.2717 / Avg. batch time: 1651.0283 (ms) / GPU bubble ratio: 67.17%
[rank1]:2025-10-27 10:18:12,543 - INFO -  step: 440  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,739  tflops: 21.41  mfu: 6.86%
[rank2]:2025-10-27 10:18:12,543 - INFO -  step: 440  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,739  tflops: 21.41  mfu: 6.86%
[rank0]:2025-10-27 10:18:12,544 - INFO -  step: 440  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,739  tflops: 21.41  mfu: 6.86%
[rank3]:2025-10-27 10:18:15,380 - INFO -  step: 440  loss:  0.1349  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,739  tflops: 21.41  mfu: 6.86%
[rank3]:2025-10-27 10:18:16,556 - INFO - Avg. fwd time: 71.9222 / Avg. bwd time: 82.0686 / Avg. batch time: 1280.7250 (ms) / GPU bubble ratio: 3.81%
[rank2]:2025-10-27 10:18:16,591 - INFO - Avg. fwd time: 33.2709 / Avg. bwd time: 41.4184 / Avg. batch time: 1477.3258 (ms) / GPU bubble ratio: 59.55%
[rank1]:2025-10-27 10:18:16,636 - INFO - Avg. fwd time: 52.2686 / Avg. bwd time: 51.2237 / Avg. batch time: 1582.3190 (ms) / GPU bubble ratio: 47.68%
[rank0]:2025-10-27 10:18:16,641 - INFO - Avg. fwd time: 45.4509 / Avg. bwd time: 21.2601 / Avg. batch time: 1643.5060 (ms) / GPU bubble ratio: 67.53%
[rank0]:2025-10-27 10:19:07,314 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-27 10:20:12,124 - INFO -  step: 460  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,740  tflops: 21.42  mfu: 6.87%
[rank0]:2025-10-27 10:20:12,125 - INFO -  step: 460  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,740  tflops: 21.42  mfu: 6.87%
[rank1]:2025-10-27 10:20:12,125 - INFO -  step: 460  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,740  tflops: 21.42  mfu: 6.87%
[rank3]:2025-10-27 10:20:14,972 - INFO -  step: 460  loss:  0.1066  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,740  tflops: 21.42  mfu: 6.87%
[rank3]:2025-10-27 10:20:16,177 - INFO - Avg. fwd time: 71.9026 / Avg. bwd time: 81.4271 / Avg. batch time: 1275.4641 (ms) / GPU bubble ratio: 3.83%
[rank2]:2025-10-27 10:20:16,212 - INFO - Avg. fwd time: 33.2668 / Avg. bwd time: 40.8765 / Avg. batch time: 1472.4283 (ms) / GPU bubble ratio: 59.72%
[rank0]:2025-10-27 10:20:16,262 - INFO - Avg. fwd time: 45.4246 / Avg. bwd time: 20.3363 / Avg. batch time: 1636.6212 (ms) / GPU bubble ratio: 67.86%
[rank1]:2025-10-27 10:20:16,257 - INFO - Avg. fwd time: 52.3084 / Avg. bwd time: 50.6758 / Avg. batch time: 1576.5559 (ms) / GPU bubble ratio: 47.74%
[rank2]:2025-10-27 10:22:12,314 - INFO -  step: 480  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,726  tflops: 21.31  mfu: 6.83%
[rank0]:2025-10-27 10:22:12,315 - INFO -  step: 480  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,726  tflops: 21.31  mfu: 6.83%
[rank1]:2025-10-27 10:22:12,315 - INFO -  step: 480  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,726  tflops: 21.31  mfu: 6.83%
[rank3]:2025-10-27 10:22:15,125 - INFO -  step: 480  loss:  0.1159  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,727  tflops: 21.32  mfu: 6.83%
[rank3]:2025-10-27 10:22:16,334 - INFO - Avg. fwd time: 71.8985 / Avg. bwd time: 80.8560 / Avg. batch time: 1270.9168 (ms) / GPU bubble ratio: 3.85%
[rank2]:2025-10-27 10:22:16,369 - INFO - Avg. fwd time: 33.2660 / Avg. bwd time: 40.3779 / Avg. batch time: 1468.1892 (ms) / GPU bubble ratio: 59.87%
[rank0]:2025-10-27 10:22:16,419 - INFO - Avg. fwd time: 45.4023 / Avg. bwd time: 19.4895 / Avg. batch time: 1630.5900 (ms) / GPU bubble ratio: 68.16%
[rank1]:2025-10-27 10:22:16,413 - INFO - Avg. fwd time: 52.3580 / Avg. bwd time: 50.1760 / Avg. batch time: 1571.5502 (ms) / GPU bubble ratio: 47.80%
[rank0]:2025-10-27 10:24:07,141 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-27 10:24:12,463 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,727  tflops: 21.32  mfu: 6.83%
[rank2]:2025-10-27 10:24:12,463 - INFO - ðŸ”Ž  Running validation at step 500
[rank0]:2025-10-27 10:24:12,464 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,727  tflops: 21.32  mfu: 6.83%
[rank0]:2025-10-27 10:24:12,464 - INFO - ðŸ”Ž  Running validation at step 500
[rank1]:2025-10-27 10:24:12,464 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,727  tflops: 21.32  mfu: 6.83%
[rank1]:2025-10-27 10:24:12,464 - INFO - ðŸ”Ž  Running validation at step 500
[rank3]:2025-10-27 10:24:15,292 - INFO -  step: 500  loss:  0.1024  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,727  tflops: 21.32  mfu: 6.83%
[rank3]:2025-10-27 10:24:15,292 - INFO - ðŸ”Ž  Running validation at step 500
[rank0]:2025-10-27 10:25:23,420 - INFO - validate step: 500  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,773
[rank0]:2025-10-27 10:25:23,420 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-27 10:25:23,425 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank1]:2025-10-27 10:25:23,501 - INFO - validate step: 500  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,766
[rank1]:2025-10-27 10:25:23,502 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-27 10:25:23,582 - INFO - validate step: 500  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,759
[rank2]:2025-10-27 10:25:23,582 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-27 10:25:23,663 - INFO - validate step: 500  loss:  0.2949  memory: 38.93GiB(81.95%)  tps: 5,991
[rank3]:2025-10-27 10:25:23,664 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-27 10:25:25,916 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 2.41 seconds.
[rank2]:2025-10-27 10:25:26,134 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 2.55 seconds.
[rank0]:2025-10-27 10:25:27,243 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-27 10:25:27,250 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.83 seconds.
[rank3]:2025-10-27 10:25:27,809 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 4.14 seconds.
[rank0]:2025-10-27 10:25:27,895 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251027_1025_stage0_step500.svg
[rank1]:2025-10-27 10:25:27,896 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251027_1025_stage1_step500.svg
[rank2]:2025-10-27 10:25:27,898 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251027_1025_stage2_step500.svg
[rank3]:2025-10-27 10:25:28,174 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1026_GPipe_timelyapf_dm1/pipeline_schedule/251027_1025_real_step500_rank3.svg
[rank3]:> Batch Time: 1307.10 ms, GPU Bubble Ratio: 72.10%, 43.65%, 61.97%, 13.85%
[rank3]:2025-10-27 10:25:28,241 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251027_1025_stage3_step500.svg
[rank3]:2025-10-27 10:25:29,402 - INFO - Avg. fwd time: 71.8964 / Avg. bwd time: 80.3191 / Avg. batch time: 1266.6259 (ms) / GPU bubble ratio: 3.86%
[rank2]:2025-10-27 10:25:29,436 - INFO - Avg. fwd time: 33.2665 / Avg. bwd time: 39.9220 / Avg. batch time: 1462.9912 (ms) / GPU bubble ratio: 59.98%
[rank0]:2025-10-27 10:25:29,488 - INFO - Avg. fwd time: 45.3828 / Avg. bwd time: 18.7104 / Avg. batch time: 1623.7862 (ms) / GPU bubble ratio: 68.42%
[rank1]:2025-10-27 10:25:29,482 - INFO - Avg. fwd time: 52.3920 / Avg. bwd time: 49.7233 / Avg. batch time: 1565.6719 (ms) / GPU bubble ratio: 47.82%
[rank2]:2025-10-27 10:27:24,085 - INFO -  step: 520  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,719  tflops: 21.26  mfu: 6.81%
[rank0]:2025-10-27 10:27:24,085 - INFO -  step: 520  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,716  tflops: 21.23  mfu: 6.80%
[rank1]:2025-10-27 10:27:24,085 - INFO -  step: 520  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,717  tflops: 21.24  mfu: 6.81%
[rank3]:2025-10-27 10:27:26,668 - INFO -  step: 520  loss:  0.1387  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,664  tflops: 20.83  mfu: 6.67%
[rank3]:2025-10-27 10:27:27,843 - INFO - Avg. fwd time: 71.8783 / Avg. bwd time: 79.8175 / Avg. batch time: 1262.5067 (ms) / GPU bubble ratio: 3.88%
[rank2]:2025-10-27 10:27:27,878 - INFO - Avg. fwd time: 33.2632 / Avg. bwd time: 39.4974 / Avg. batch time: 1458.5505 (ms) / GPU bubble ratio: 60.09%
[rank0]:2025-10-27 10:27:27,929 - INFO - Avg. fwd time: 45.3668 / Avg. bwd time: 17.9912 / Avg. batch time: 1617.8151 (ms) / GPU bubble ratio: 68.67%
[rank1]:2025-10-27 10:27:27,923 - INFO - Avg. fwd time: 52.4046 / Avg. bwd time: 49.2989 / Avg. batch time: 1560.5720 (ms) / GPU bubble ratio: 47.86%
[rank2]:2025-10-27 10:29:22,182 - INFO -  step: 540  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,775  tflops: 21.69  mfu: 6.95%
[rank0]:2025-10-27 10:29:22,183 - INFO -  step: 540  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,775  tflops: 21.69  mfu: 6.95%
[rank1]:2025-10-27 10:29:22,183 - INFO -  step: 540  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,775  tflops: 21.69  mfu: 6.95%
[rank3]:2025-10-27 10:29:24,829 - INFO -  step: 540  loss:  0.1386  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,773  tflops: 21.68  mfu: 6.95%
[rank3]:2025-10-27 10:29:26,015 - INFO - Avg. fwd time: 71.8578 / Avg. bwd time: 79.3539 / Avg. batch time: 1258.6628 (ms) / GPU bubble ratio: 3.89%
[rank2]:2025-10-27 10:29:26,050 - INFO - Avg. fwd time: 33.2561 / Avg. bwd time: 39.1042 / Avg. batch time: 1454.3898 (ms) / GPU bubble ratio: 60.20%
[rank0]:2025-10-27 10:29:26,100 - INFO - Avg. fwd time: 45.3487 / Avg. bwd time: 17.3252 / Avg. batch time: 1612.2289 (ms) / GPU bubble ratio: 68.90%
[rank1]:2025-10-27 10:29:26,093 - INFO - Avg. fwd time: 52.4299 / Avg. bwd time: 48.9044 / Avg. batch time: 1555.7909 (ms) / GPU bubble ratio: 47.89%
[rank0]:2025-10-27 10:30:16,560 - INFO - [GC] Peforming periodical GC collection 0.36 seconds
[rank0]:2025-10-27 10:31:21,445 - INFO -  step: 560  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,748  tflops: 21.48  mfu: 6.88%
[rank2]:2025-10-27 10:31:21,445 - INFO -  step: 560  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,748  tflops: 21.48  mfu: 6.88%
[rank1]:2025-10-27 10:31:21,445 - INFO -  step: 560  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,748  tflops: 21.48  mfu: 6.88%
[rank3]:2025-10-27 10:31:24,104 - INFO -  step: 560  loss:  0.1369  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,747  tflops: 21.48  mfu: 6.88%
[rank2]:2025-10-27 10:31:25,350 - INFO - Avg. fwd time: 33.2521 / Avg. bwd time: 38.7426 / Avg. batch time: 1450.8400 (ms) / GPU bubble ratio: 60.30%
[rank3]:2025-10-27 10:31:25,314 - INFO - Avg. fwd time: 71.8633 / Avg. bwd time: 78.9348 / Avg. batch time: 1255.3809 (ms) / GPU bubble ratio: 3.90%
[rank0]:2025-10-27 10:31:25,400 - INFO - Avg. fwd time: 45.3432 / Avg. bwd time: 16.7068 / Avg. batch time: 1607.3868 (ms) / GPU bubble ratio: 69.12%
[rank1]:2025-10-27 10:31:25,394 - INFO - Avg. fwd time: 52.4642 / Avg. bwd time: 48.5405 / Avg. batch time: 1551.6931 (ms) / GPU bubble ratio: 47.93%
[rank1]:2025-10-27 10:33:20,405 - INFO -  step: 580  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,755  tflops: 21.53  mfu: 6.90%
[rank2]:2025-10-27 10:33:20,404 - INFO -  step: 580  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,755  tflops: 21.53  mfu: 6.90%
[rank0]:2025-10-27 10:33:20,405 - INFO -  step: 580  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,755  tflops: 21.53  mfu: 6.90%
[rank3]:2025-10-27 10:33:22,845 - INFO -  step: 580  loss:  0.1216  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,760  tflops: 21.57  mfu: 6.91%
[rank3]:2025-10-27 10:33:24,009 - INFO - Avg. fwd time: 71.8693 / Avg. bwd time: 78.5452 / Avg. batch time: 1252.3212 (ms) / GPU bubble ratio: 3.91%
[rank0]:2025-10-27 10:33:24,095 - INFO - Avg. fwd time: 45.3429 / Avg. bwd time: 16.1310 / Avg. batch time: 1602.7754 (ms) / GPU bubble ratio: 69.32%
[rank1]:2025-10-27 10:33:24,089 - INFO - Avg. fwd time: 52.4917 / Avg. bwd time: 48.2083 / Avg. batch time: 1547.7732 (ms) / GPU bubble ratio: 47.95%
[rank2]:2025-10-27 10:33:24,045 - INFO - Avg. fwd time: 33.2499 / Avg. bwd time: 38.4082 / Avg. batch time: 1447.4306 (ms) / GPU bubble ratio: 60.39%
[rank0]:2025-10-27 10:35:13,061 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-27 10:35:18,446 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,776  tflops: 21.70  mfu: 6.96%
[rank0]:2025-10-27 10:35:18,446 - INFO - ðŸ”Ž  Running validation at step 600
[rank1]:2025-10-27 10:35:18,445 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,776  tflops: 21.70  mfu: 6.96%
[rank1]:2025-10-27 10:35:18,445 - INFO - ðŸ”Ž  Running validation at step 600
[rank2]:2025-10-27 10:35:18,445 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,776  tflops: 21.70  mfu: 6.96%
[rank2]:2025-10-27 10:35:18,445 - INFO - ðŸ”Ž  Running validation at step 600
[rank3]:2025-10-27 10:35:21,047 - INFO -  step: 600  loss:  0.1279  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,772  tflops: 21.67  mfu: 6.95%
[rank3]:2025-10-27 10:35:21,047 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-10-27 10:36:29,181 - INFO - validate step: 600  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,791
[rank1]:2025-10-27 10:36:29,262 - INFO - validate step: 600  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,784
[rank2]:2025-10-27 10:36:29,343 - INFO - validate step: 600  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,777
[rank3]:2025-10-27 10:36:29,423 - INFO - validate step: 600  loss:  0.2950  memory: 38.93GiB(81.95%)  tps: 5,991
[rank0]:2025-10-27 10:36:29,503 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251027_1036_stage0_step600.svg
[rank1]:2025-10-27 10:36:29,503 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251027_1036_stage1_step600.svg
[rank2]:2025-10-27 10:36:29,504 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251027_1036_stage2_step600.svg
[rank3]:2025-10-27 10:36:29,613 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1026_GPipe_timelyapf_dm1/pipeline_schedule/251027_1036_real_step600_rank3.svg
[rank3]:> Batch Time: 1305.50 ms, GPU Bubble Ratio: 72.09%, 43.61%, 62.01%, 13.87%
[rank3]:2025-10-27 10:36:29,681 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251027_1036_stage3_step600.svg
[rank3]:2025-10-27 10:36:30,868 - INFO - Avg. fwd time: 71.8720 / Avg. bwd time: 78.1709 / Avg. batch time: 1249.3471 (ms) / GPU bubble ratio: 3.92%
[rank0]:2025-10-27 10:36:30,953 - INFO - Avg. fwd time: 45.3181 / Avg. bwd time: 15.5936 / Avg. batch time: 1597.2693 (ms) / GPU bubble ratio: 69.49%
[rank1]:2025-10-27 10:36:30,946 - INFO - Avg. fwd time: 52.5178 / Avg. bwd time: 47.8973 / Avg. batch time: 1542.9188 (ms) / GPU bubble ratio: 47.93%
[rank2]:2025-10-27 10:36:30,903 - INFO - Avg. fwd time: 33.2476 / Avg. bwd time: 38.0934 / Avg. batch time: 1443.0577 (ms) / GPU bubble ratio: 60.45%
[rank2]:2025-10-27 10:38:25,744 - INFO -  step: 620  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,815  tflops: 22.01  mfu: 7.05%
[rank1]:2025-10-27 10:38:25,744 - INFO -  step: 620  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,813  tflops: 21.99  mfu: 7.05%
[rank0]:2025-10-27 10:38:25,745 - INFO -  step: 620  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,811  tflops: 21.98  mfu: 7.04%
[rank3]:2025-10-27 10:38:28,211 - INFO -  step: 620  loss:  0.1554  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,759  tflops: 21.57  mfu: 6.91%
[rank2]:2025-10-27 10:38:29,440 - INFO - Avg. fwd time: 33.2455 / Avg. bwd time: 37.7975 / Avg. batch time: 1440.0661 (ms) / GPU bubble ratio: 60.53%
[rank3]:2025-10-27 10:38:29,404 - INFO - Avg. fwd time: 71.8676 / Avg. bwd time: 77.8282 / Avg. batch time: 1246.5965 (ms) / GPU bubble ratio: 3.93%
[rank1]:2025-10-27 10:38:29,484 - INFO - Avg. fwd time: 52.5414 / Avg. bwd time: 47.6060 / Avg. batch time: 1539.4711 (ms) / GPU bubble ratio: 47.96%
[rank0]:2025-10-27 10:38:29,490 - INFO - Avg. fwd time: 45.3176 / Avg. bwd time: 15.0909 / Avg. batch time: 1593.2211 (ms) / GPU bubble ratio: 69.67%
[rank2]:2025-10-27 10:40:24,049 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1026_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251027_1040_rank2_trend_line.svg
[rank3]:2025-10-27 10:40:24,048 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1026_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251027_1040_rank3_trend_line.svg
[rank1]:2025-10-27 10:40:24,098 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1026_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251027_1040_rank1_trend_line.svg
[rank1]:2025-10-27 10:40:24,104 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-10-27 10:40:24,107 - INFO -  step: 640  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,768  tflops: 21.64  mfu: 6.94%
[rank0]:2025-10-27 10:40:24,094 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1026_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251027_1040_rank0_trend_line.svg
[rank0]:2025-10-27 10:40:24,104 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-27 10:40:24,107 - INFO -  step: 640  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,768  tflops: 21.64  mfu: 6.94%
[rank2]:2025-10-27 10:40:24,104 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-27 10:40:24,107 - INFO -  step: 640  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,768  tflops: 21.64  mfu: 6.94%
[rank3]:2025-10-27 10:40:24,303 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1026_GPipe_timelyapf_dm1/pipeline_schedule/251027_1040_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 1307.56 ms, GPU Bubble Ratio: 67.15%, 42.28%, 58.17%, 14.03%
[rank3]:2025-10-27 10:40:24,304 - INFO - 	> Batch Time: 1307.56 ms (Average Freeze Ratio: 0.34)
[rank3]:2025-10-27 10:40:24,305 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-27 10:40:26,942 - INFO -  step: 640  loss:  0.1121  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,760  tflops: 21.58  mfu: 6.92%
[rank2]:2025-10-27 10:40:28,188 - INFO - Avg. fwd time: 33.2400 / Avg. bwd time: 37.5207 / Avg. batch time: 1437.2035 (ms) / GPU bubble ratio: 60.61%
[rank3]:2025-10-27 10:40:28,152 - INFO - Avg. fwd time: 71.8581 / Avg. bwd time: 77.5025 / Avg. batch time: 1243.9491 (ms) / GPU bubble ratio: 3.94%
[rank1]:2025-10-27 10:40:28,231 - INFO - Avg. fwd time: 52.5742 / Avg. bwd time: 47.3306 / Avg. batch time: 1536.1806 (ms) / GPU bubble ratio: 47.97%
[rank0]:2025-10-27 10:40:28,237 - INFO - Avg. fwd time: 45.3127 / Avg. bwd time: 14.6195 / Avg. batch time: 1589.3658 (ms) / GPU bubble ratio: 69.83%
[rank0]:2025-10-27 10:41:17,845 - INFO - [GC] Peforming periodical GC collection 0.03 seconds
[rank1]:2025-10-27 10:42:22,593 - INFO -  step: 660  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,766  tflops: 21.62  mfu: 6.93%
[rank0]:2025-10-27 10:42:22,594 - INFO -  step: 660  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,766  tflops: 21.62  mfu: 6.93%
[rank2]:2025-10-27 10:42:22,593 - INFO -  step: 660  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,766  tflops: 21.62  mfu: 6.93%
[rank3]:2025-10-27 10:42:25,220 - INFO -  step: 660  loss:  0.1241  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,770  tflops: 21.66  mfu: 6.94%
[rank2]:2025-10-27 10:42:26,422 - INFO - Avg. fwd time: 33.2335 / Avg. bwd time: 37.2609 / Avg. batch time: 1434.4423 (ms) / GPU bubble ratio: 60.68%
[rank3]:2025-10-27 10:42:26,386 - INFO - Avg. fwd time: 71.8466 / Avg. bwd time: 77.1956 / Avg. batch time: 1241.4255 (ms) / GPU bubble ratio: 3.95%
[rank1]:2025-10-27 10:42:26,466 - INFO - Avg. fwd time: 52.5961 / Avg. bwd time: 47.0779 / Avg. batch time: 1533.0174 (ms) / GPU bubble ratio: 47.99%
[rank0]:2025-10-27 10:42:26,473 - INFO - Avg. fwd time: 45.2962 / Avg. bwd time: 14.1767 / Avg. batch time: 1585.6692 (ms) / GPU bubble ratio: 69.99%
[rank1]:2025-10-27 10:44:21,143 - INFO -  step: 680  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,764  tflops: 21.61  mfu: 6.93%
[rank0]:2025-10-27 10:44:21,143 - INFO -  step: 680  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,764  tflops: 21.61  mfu: 6.93%
[rank2]:2025-10-27 10:44:21,142 - INFO -  step: 680  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,764  tflops: 21.61  mfu: 6.93%
[rank3]:2025-10-27 10:44:23,737 - INFO -  step: 680  loss:  0.1354  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,765  tflops: 21.62  mfu: 6.93%
[rank2]:2025-10-27 10:44:24,892 - INFO - Avg. fwd time: 33.2312 / Avg. bwd time: 37.0173 / Avg. batch time: 1431.9378 (ms) / GPU bubble ratio: 60.75%
[rank3]:2025-10-27 10:44:24,855 - INFO - Avg. fwd time: 71.8413 / Avg. bwd time: 76.9134 / Avg. batch time: 1239.1545 (ms) / GPU bubble ratio: 3.96%
[rank1]:2025-10-27 10:44:24,935 - INFO - Avg. fwd time: 52.6100 / Avg. bwd time: 46.8384 / Avg. batch time: 1530.1362 (ms) / GPU bubble ratio: 48.01%
[rank0]:2025-10-27 10:44:24,942 - INFO - Avg. fwd time: 45.2910 / Avg. bwd time: 13.7600 / Avg. batch time: 1582.2867 (ms) / GPU bubble ratio: 70.14%
[rank0]:2025-10-27 10:46:14,219 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-27 10:46:19,675 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,764  tflops: 21.61  mfu: 6.93%
[rank1]:2025-10-27 10:46:19,683 - INFO - ðŸ”Ž  Running validation at step 700
[rank0]:2025-10-27 10:46:19,675 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,764  tflops: 21.61  mfu: 6.93%
[rank0]:2025-10-27 10:46:19,683 - INFO - ðŸ”Ž  Running validation at step 700
[rank2]:2025-10-27 10:46:19,675 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,764  tflops: 21.61  mfu: 6.93%
[rank2]:2025-10-27 10:46:19,675 - INFO - ðŸ”Ž  Running validation at step 700
[rank3]:2025-10-27 10:46:22,299 - INFO -  step: 700  loss:  0.1188  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,764  tflops: 21.61  mfu: 6.93%
[rank3]:2025-10-27 10:46:22,299 - INFO - ðŸ”Ž  Running validation at step 700
[rank0]:2025-10-27 10:47:30,651 - INFO - validate step: 700  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,772
[rank1]:2025-10-27 10:47:30,733 - INFO - validate step: 700  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,765
[rank2]:2025-10-27 10:47:30,817 - INFO - validate step: 700  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,758
[rank3]:2025-10-27 10:47:30,896 - INFO - validate step: 700  loss:  0.2939  memory: 38.93GiB(81.95%)  tps: 5,971
[rank1]:2025-10-27 10:47:30,978 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251027_1047_stage1_step700.svg
[rank0]:2025-10-27 10:47:30,978 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251027_1047_stage0_step700.svg
[rank2]:2025-10-27 10:47:30,980 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251027_1047_stage2_step700.svg
[rank3]:2025-10-27 10:47:31,088 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1026_GPipe_timelyapf_dm1/pipeline_schedule/251027_1047_real_step700_rank3.svg
[rank3]:> Batch Time: 1304.75 ms, GPU Bubble Ratio: 72.09%, 43.57%, 62.04%, 13.88%
[rank3]:2025-10-27 10:47:31,159 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251027_1047_stage3_step700.svg
[rank2]:2025-10-27 10:47:32,367 - INFO - Avg. fwd time: 33.2276 / Avg. bwd time: 36.7875 / Avg. batch time: 1428.7551 (ms) / GPU bubble ratio: 60.80%
[rank3]:2025-10-27 10:47:32,332 - INFO - Avg. fwd time: 71.8417 / Avg. bwd time: 76.6484 / Avg. batch time: 1237.0535 (ms) / GPU bubble ratio: 3.97%
[rank1]:2025-10-27 10:47:32,412 - INFO - Avg. fwd time: 52.6314 / Avg. bwd time: 46.6106 / Avg. batch time: 1526.6030 (ms) / GPU bubble ratio: 47.99%
[rank0]:2025-10-27 10:47:32,419 - INFO - Avg. fwd time: 45.2874 / Avg. bwd time: 13.3671 / Avg. batch time: 1578.2820 (ms) / GPU bubble ratio: 70.27%
[rank0]:2025-10-27 10:49:27,605 - INFO -  step: 720  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,802  tflops: 21.90  mfu: 7.02%
[rank2]:2025-10-27 10:49:27,605 - INFO -  step: 720  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,806  tflops: 21.93  mfu: 7.03%
[rank1]:2025-10-27 10:49:27,605 - INFO -  step: 720  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,804  tflops: 21.92  mfu: 7.03%
[rank3]:2025-10-27 10:49:30,061 - INFO -  step: 720  loss:  0.2018  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,750  tflops: 21.50  mfu: 6.89%
[rank2]:2025-10-27 10:49:31,298 - INFO - Avg. fwd time: 33.2256 / Avg. bwd time: 36.5689 / Avg. batch time: 1426.6885 (ms) / GPU bubble ratio: 60.86%
[rank3]:2025-10-27 10:49:31,260 - INFO - Avg. fwd time: 71.8512 / Avg. bwd time: 76.4003 / Avg. batch time: 1235.1438 (ms) / GPU bubble ratio: 3.98%
[rank1]:2025-10-27 10:49:31,343 - INFO - Avg. fwd time: 52.6619 / Avg. bwd time: 46.3959 / Avg. batch time: 1524.2227 (ms) / GPU bubble ratio: 48.01%
[rank0]:2025-10-27 10:49:31,349 - INFO - Avg. fwd time: 45.2824 / Avg. bwd time: 12.9959 / Avg. batch time: 1575.4578 (ms) / GPU bubble ratio: 70.41%
[rank1]:2025-10-27 10:51:25,411 - INFO -  step: 740  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,782  tflops: 21.74  mfu: 6.97%
[rank0]:2025-10-27 10:51:25,411 - INFO -  step: 740  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,782  tflops: 21.74  mfu: 6.97%
[rank2]:2025-10-27 10:51:25,410 - INFO -  step: 740  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,782  tflops: 21.74  mfu: 6.97%
[rank3]:2025-10-27 10:51:27,986 - INFO -  step: 740  loss:  0.1447  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,779  tflops: 21.72  mfu: 6.96%
[rank2]:2025-10-27 10:51:29,175 - INFO - Avg. fwd time: 33.2181 / Avg. bwd time: 36.3621 / Avg. batch time: 1424.4223 (ms) / GPU bubble ratio: 60.92%
[rank3]:2025-10-27 10:51:29,137 - INFO - Avg. fwd time: 71.8476 / Avg. bwd time: 76.1513 / Avg. batch time: 1233.1019 (ms) / GPU bubble ratio: 3.98%
[rank1]:2025-10-27 10:51:29,222 - INFO - Avg. fwd time: 52.6577 / Avg. bwd time: 46.1921 / Avg. batch time: 1521.6259 (ms) / GPU bubble ratio: 48.03%
[rank0]:2025-10-27 10:51:29,230 - INFO - Avg. fwd time: 45.2627 / Avg. bwd time: 12.6449 / Avg. batch time: 1572.4346 (ms) / GPU bubble ratio: 70.54%
[rank0]:2025-10-27 10:52:19,056 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-27 10:53:23,553 - INFO -  step: 760  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,774  tflops: 21.68  mfu: 6.95%
[rank0]:2025-10-27 10:53:23,553 - INFO -  step: 760  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,774  tflops: 21.68  mfu: 6.95%
[rank2]:2025-10-27 10:53:23,553 - INFO -  step: 760  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,774  tflops: 21.68  mfu: 6.95%
[rank3]:2025-10-27 10:53:26,126 - INFO -  step: 760  loss:  0.1306  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,774  tflops: 21.68  mfu: 6.95%
[rank3]:2025-10-27 10:53:27,311 - INFO - Avg. fwd time: 71.8366 / Avg. bwd time: 75.9210 / Avg. batch time: 1231.1973 (ms) / GPU bubble ratio: 3.99%
[rank2]:2025-10-27 10:53:27,348 - INFO - Avg. fwd time: 33.2159 / Avg. bwd time: 36.1673 / Avg. batch time: 1422.3454 (ms) / GPU bubble ratio: 60.98%
[rank1]:2025-10-27 10:53:27,392 - INFO - Avg. fwd time: 52.6747 / Avg. bwd time: 45.9995 / Avg. batch time: 1519.2508 (ms) / GPU bubble ratio: 48.04%
[rank0]:2025-10-27 10:53:27,399 - INFO - Avg. fwd time: 45.2515 / Avg. bwd time: 12.3123 / Avg. batch time: 1569.6583 (ms) / GPU bubble ratio: 70.66%
[rank0]:2025-10-27 10:55:22,363 - INFO -  step: 780  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,758  tflops: 21.56  mfu: 6.91%
[rank2]:2025-10-27 10:55:22,363 - INFO -  step: 780  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,758  tflops: 21.56  mfu: 6.91%
[rank1]:2025-10-27 10:55:22,363 - INFO -  step: 780  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,758  tflops: 21.56  mfu: 6.91%
[rank3]:2025-10-27 10:55:24,806 - INFO -  step: 780  loss:  0.1416  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,761  tflops: 21.58  mfu: 6.92%
[rank3]:2025-10-27 10:55:26,007 - INFO - Avg. fwd time: 71.8437 / Avg. bwd time: 75.7113 / Avg. batch time: 1229.6036 (ms) / GPU bubble ratio: 4.00%
[rank2]:2025-10-27 10:55:26,044 - INFO - Avg. fwd time: 33.2147 / Avg. bwd time: 35.9827 / Avg. batch time: 1420.5439 (ms) / GPU bubble ratio: 61.03%
[rank1]:2025-10-27 10:55:26,090 - INFO - Avg. fwd time: 52.6975 / Avg. bwd time: 45.8182 / Avg. batch time: 1517.1699 (ms) / GPU bubble ratio: 48.05%
[rank0]:2025-10-27 10:55:26,097 - INFO - Avg. fwd time: 45.2393 / Avg. bwd time: 11.9967 / Avg. batch time: 1567.1975 (ms) / GPU bubble ratio: 70.78%
[rank0]:2025-10-27 10:57:15,488 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-27 10:57:21,030 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,761  tflops: 21.59  mfu: 6.92%
[rank2]:2025-10-27 10:57:21,030 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-10-27 10:57:21,031 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,761  tflops: 21.59  mfu: 6.92%
[rank0]:2025-10-27 10:57:21,031 - INFO - ðŸ”Ž  Running validation at step 800
[rank1]:2025-10-27 10:57:21,030 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,761  tflops: 21.59  mfu: 6.92%
[rank1]:2025-10-27 10:57:21,031 - INFO - ðŸ”Ž  Running validation at step 800
[rank3]:2025-10-27 10:57:23,500 - INFO -  step: 800  loss:  0.1131  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,761  tflops: 21.58  mfu: 6.92%
[rank3]:2025-10-27 10:57:23,501 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-10-27 10:58:31,436 - INFO - validate step: 800  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,818
[rank1]:2025-10-27 10:58:31,516 - INFO - validate step: 800  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,811
[rank2]:2025-10-27 10:58:31,598 - INFO - validate step: 800  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,804
[rank3]:2025-10-27 10:58:31,677 - INFO - validate step: 800  loss:  0.2957  memory: 38.93GiB(81.95%)  tps: 6,008
[rank1]:2025-10-27 10:58:31,760 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251027_1058_stage1_step800.svg
[rank0]:2025-10-27 10:58:31,760 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251027_1058_stage0_step800.svg
[rank2]:2025-10-27 10:58:31,768 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251027_1058_stage2_step800.svg
[rank3]:2025-10-27 10:58:31,870 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1026_GPipe_timelyapf_dm1/pipeline_schedule/251027_1058_real_step800_rank3.svg
[rank3]:> Batch Time: 1304.33 ms, GPU Bubble Ratio: 72.11%, 43.53%, 62.06%, 13.88%
[rank3]:2025-10-27 10:58:31,944 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251027_1058_stage3_step800.svg
[rank3]:2025-10-27 10:58:33,164 - INFO - Avg. fwd time: 71.8457 / Avg. bwd time: 75.5122 / Avg. batch time: 1228.0450 (ms) / GPU bubble ratio: 4.00%
[rank2]:2025-10-27 10:58:33,201 - INFO - Avg. fwd time: 33.2173 / Avg. bwd time: 35.8062 / Avg. batch time: 1418.1097 (ms) / GPU bubble ratio: 61.06%
[rank1]:2025-10-27 10:58:33,246 - INFO - Avg. fwd time: 52.7144 / Avg. bwd time: 45.6447 / Avg. batch time: 1514.4805 (ms) / GPU bubble ratio: 48.04%
[rank0]:2025-10-27 10:58:33,253 - INFO - Avg. fwd time: 45.2380 / Avg. bwd time: 11.6970 / Avg. batch time: 1564.1497 (ms) / GPU bubble ratio: 70.88%
[rank3]:2025-10-27 10:59:38,205 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-27 10:59:38,902 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-27 10:59:38,948 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-27 10:59:38,949 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-27 11:00:32,631 - INFO -  step: 820  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,706  tflops: 21.15  mfu: 6.78%
[rank0]:2025-10-27 11:00:32,632 - INFO -  step: 820  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,704  tflops: 21.14  mfu: 6.77%
[rank2]:2025-10-27 11:00:32,631 - INFO -  step: 820  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,707  tflops: 21.17  mfu: 6.78%
[rank3]:2025-10-27 11:00:35,057 - INFO -  step: 820  loss:  0.1441  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,656  tflops: 20.76  mfu: 6.65%
[rank3]:2025-10-27 11:00:36,186 - INFO - Avg. fwd time: 71.8386 / Avg. bwd time: 75.3127 / Avg. batch time: 1226.4141 (ms) / GPU bubble ratio: 4.01%
[rank1]:2025-10-27 11:00:36,269 - INFO - Avg. fwd time: 52.7210 / Avg. bwd time: 45.4809 / Avg. batch time: 1512.4636 (ms) / GPU bubble ratio: 48.06%
[rank0]:2025-10-27 11:00:36,277 - INFO - Avg. fwd time: 45.2278 / Avg. bwd time: 11.4118 / Avg. batch time: 1561.7917 (ms) / GPU bubble ratio: 70.99%
[rank2]:2025-10-27 11:00:36,223 - INFO - Avg. fwd time: 33.2120 / Avg. bwd time: 35.6380 / Avg. batch time: 1416.3456 (ms) / GPU bubble ratio: 61.11%
[rank1]:2025-10-27 11:02:30,475 - INFO -  step: 840  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,781  tflops: 21.74  mfu: 6.97%
[rank0]:2025-10-27 11:02:30,475 - INFO -  step: 840  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,781  tflops: 21.74  mfu: 6.97%
[rank2]:2025-10-27 11:02:30,474 - INFO -  step: 840  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,781  tflops: 21.74  mfu: 6.97%
[rank3]:2025-10-27 11:02:33,071 - INFO -  step: 840  loss:  0.1421  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,777  tflops: 21.71  mfu: 6.96%
[rank3]:2025-10-27 11:02:34,254 - INFO - Avg. fwd time: 71.8307 / Avg. bwd time: 75.1248 / Avg. batch time: 1224.8695 (ms) / GPU bubble ratio: 4.02%
[rank0]:2025-10-27 11:02:34,345 - INFO - Avg. fwd time: 45.2167 / Avg. bwd time: 11.1402 / Avg. batch time: 1559.5065 (ms) / GPU bubble ratio: 71.09%
[rank2]:2025-10-27 11:02:34,290 - INFO - Avg. fwd time: 33.2097 / Avg. bwd time: 35.4778 / Avg. batch time: 1414.6308 (ms) / GPU bubble ratio: 61.16%
[rank1]:2025-10-27 11:02:34,337 - INFO - Avg. fwd time: 52.7260 / Avg. bwd time: 45.3231 / Avg. batch time: 1510.5065 (ms) / GPU bubble ratio: 48.07%
[rank0]:2025-10-27 11:03:25,068 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-27 11:04:29,403 - INFO -  step: 860  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,755  tflops: 21.54  mfu: 6.90%
[rank2]:2025-10-27 11:04:29,403 - INFO -  step: 860  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,755  tflops: 21.54  mfu: 6.90%
[rank0]:2025-10-27 11:04:29,403 - INFO -  step: 860  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,755  tflops: 21.54  mfu: 6.90%
[rank3]:2025-10-27 11:04:31,999 - INFO -  step: 860  loss:  0.1225  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,755  tflops: 21.54  mfu: 6.90%
[rank3]:2025-10-27 11:04:33,198 - INFO - Avg. fwd time: 71.8347 / Avg. bwd time: 74.9579 / Avg. batch time: 1223.6022 (ms) / GPU bubble ratio: 4.03%
[rank2]:2025-10-27 11:04:33,235 - INFO - Avg. fwd time: 33.2088 / Avg. bwd time: 35.3259 / Avg. batch time: 1413.2384 (ms) / GPU bubble ratio: 61.20%
[rank0]:2025-10-27 11:04:33,290 - INFO - Avg. fwd time: 45.2127 / Avg. bwd time: 10.8813 / Avg. batch time: 1557.5839 (ms) / GPU bubble ratio: 71.19%
[rank1]:2025-10-27 11:04:33,282 - INFO - Avg. fwd time: 52.7563 / Avg. bwd time: 45.1729 / Avg. batch time: 1508.8963 (ms) / GPU bubble ratio: 48.08%
[rank2]:2025-10-27 11:06:28,328 - INFO -  step: 880  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,755  tflops: 21.54  mfu: 6.90%
[rank0]:2025-10-27 11:06:28,329 - INFO -  step: 880  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,755  tflops: 21.54  mfu: 6.90%
[rank1]:2025-10-27 11:06:28,329 - INFO -  step: 880  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,755  tflops: 21.54  mfu: 6.90%
[rank3]:2025-10-27 11:06:30,800 - INFO -  step: 880  loss:  0.1068  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,758  tflops: 21.56  mfu: 6.91%
[rank3]:2025-10-27 11:06:32,017 - INFO - Avg. fwd time: 71.8435 / Avg. bwd time: 74.7932 / Avg. batch time: 1222.3605 (ms) / GPU bubble ratio: 4.03%
[rank1]:2025-10-27 11:06:32,101 - INFO - Avg. fwd time: 52.7691 / Avg. bwd time: 45.0300 / Avg. batch time: 1507.3169 (ms) / GPU bubble ratio: 48.09%
[rank2]:2025-10-27 11:06:32,054 - INFO - Avg. fwd time: 33.2084 / Avg. bwd time: 35.1798 / Avg. batch time: 1411.8731 (ms) / GPU bubble ratio: 61.25%
[rank0]:2025-10-27 11:06:32,109 - INFO - Avg. fwd time: 45.2094 / Avg. bwd time: 10.6341 / Avg. batch time: 1555.7101 (ms) / GPU bubble ratio: 71.28%
[rank0]:2025-10-27 11:08:21,088 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-27 11:08:26,402 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,775  tflops: 21.70  mfu: 6.95%
[rank0]:2025-10-27 11:08:26,402 - INFO - ðŸ”Ž  Running validation at step 900
[rank2]:2025-10-27 11:08:26,401 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,775  tflops: 21.70  mfu: 6.95%
[rank2]:2025-10-27 11:08:26,402 - INFO - ðŸ”Ž  Running validation at step 900
[rank1]:2025-10-27 11:08:26,402 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,775  tflops: 21.70  mfu: 6.95%
[rank1]:2025-10-27 11:08:26,402 - INFO - ðŸ”Ž  Running validation at step 900
[rank3]:2025-10-27 11:08:28,850 - INFO -  step: 900  loss:  0.1261  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,776  tflops: 21.70  mfu: 6.96%
[rank3]:2025-10-27 11:08:28,851 - INFO - ðŸ”Ž  Running validation at step 900
[rank0]:2025-10-27 11:09:37,282 - INFO - validate step: 900  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,779
[rank1]:2025-10-27 11:09:37,363 - INFO - validate step: 900  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,772
[rank2]:2025-10-27 11:09:37,445 - INFO - validate step: 900  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,766
[rank3]:2025-10-27 11:09:37,526 - INFO - validate step: 900  loss:  0.2938  memory: 38.93GiB(81.95%)  tps: 5,964
[rank0]:2025-10-27 11:09:37,604 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251027_1109_stage0_step900.svg
[rank2]:2025-10-27 11:09:37,605 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251027_1109_stage2_step900.svg
[rank1]:2025-10-27 11:09:37,604 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251027_1109_stage1_step900.svg
[rank3]:2025-10-27 11:09:37,720 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1026_GPipe_timelyapf_dm1/pipeline_schedule/251027_1109_real_step900_rank3.svg
[rank3]:> Batch Time: 1304.17 ms, GPU Bubble Ratio: 72.11%, 43.52%, 62.09%, 13.90%
[rank3]:2025-10-27 11:09:37,787 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251027_1109_stage3_step900.svg
[rank3]:2025-10-27 11:09:38,966 - INFO - Avg. fwd time: 71.8341 / Avg. bwd time: 74.6252 / Avg. batch time: 1220.9545 (ms) / GPU bubble ratio: 4.04%
[rank2]:2025-10-27 11:09:39,003 - INFO - Avg. fwd time: 33.2015 / Avg. bwd time: 35.0407 / Avg. batch time: 1409.7291 (ms) / GPU bubble ratio: 61.27%
[rank1]:2025-10-27 11:09:39,049 - INFO - Avg. fwd time: 52.7757 / Avg. bwd time: 44.8928 / Avg. batch time: 1504.9591 (ms) / GPU bubble ratio: 48.08%
[rank0]:2025-10-27 11:09:39,056 - INFO - Avg. fwd time: 45.2003 / Avg. bwd time: 10.3979 / Avg. batch time: 1553.0657 (ms) / GPU bubble ratio: 71.36%
[rank0]:2025-10-27 11:11:34,276 - INFO -  step: 920  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,801  tflops: 21.90  mfu: 7.02%
[rank2]:2025-10-27 11:11:34,275 - INFO -  step: 920  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,805  tflops: 21.93  mfu: 7.03%
[rank1]:2025-10-27 11:11:34,275 - INFO -  step: 920  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,803  tflops: 21.91  mfu: 7.02%
[rank3]:2025-10-27 11:11:36,721 - INFO -  step: 920  loss:  0.1517  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,749  tflops: 21.49  mfu: 6.89%
[rank3]:2025-10-27 11:11:37,896 - INFO - Avg. fwd time: 71.8398 / Avg. bwd time: 74.4756 / Avg. batch time: 1219.8188 (ms) / GPU bubble ratio: 4.04%
[rank2]:2025-10-27 11:11:37,934 - INFO - Avg. fwd time: 33.2006 / Avg. bwd time: 34.9102 / Avg. batch time: 1408.5292 (ms) / GPU bubble ratio: 61.32%
[rank1]:2025-10-27 11:11:37,978 - INFO - Avg. fwd time: 52.7962 / Avg. bwd time: 44.7669 / Avg. batch time: 1503.5657 (ms) / GPU bubble ratio: 48.09%
[rank0]:2025-10-27 11:11:37,986 - INFO - Avg. fwd time: 45.2049 / Avg. bwd time: 10.1719 / Avg. batch time: 1551.4042 (ms) / GPU bubble ratio: 71.44%
[rank0]:2025-10-27 11:13:32,228 - INFO -  step: 940  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,778  tflops: 21.72  mfu: 6.96%
[rank2]:2025-10-27 11:13:32,228 - INFO -  step: 940  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,778  tflops: 21.72  mfu: 6.96%
[rank1]:2025-10-27 11:13:32,228 - INFO -  step: 940  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,778  tflops: 21.72  mfu: 6.96%
[rank3]:2025-10-27 11:13:34,813 - INFO -  step: 940  loss:  0.1246  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,775  tflops: 21.69  mfu: 6.95%
[rank3]:2025-10-27 11:13:36,003 - INFO - Avg. fwd time: 71.8317 / Avg. bwd time: 74.3270 / Avg. batch time: 1218.5908 (ms) / GPU bubble ratio: 4.05%
[rank2]:2025-10-27 11:13:36,040 - INFO - Avg. fwd time: 33.1990 / Avg. bwd time: 34.7832 / Avg. batch time: 1407.1677 (ms) / GPU bubble ratio: 61.35%
[rank1]:2025-10-27 11:13:36,086 - INFO - Avg. fwd time: 52.8181 / Avg. bwd time: 44.6410 / Avg. batch time: 1502.0121 (ms) / GPU bubble ratio: 48.09%
[rank0]:2025-10-27 11:13:36,095 - INFO - Avg. fwd time: 45.2006 / Avg. bwd time: 9.9556 / Avg. batch time: 1549.5913 (ms) / GPU bubble ratio: 71.52%
[rank0]:2025-10-27 11:14:26,105 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-27 11:15:30,572 - INFO -  step: 960  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,769  tflops: 21.65  mfu: 6.94%
[rank2]:2025-10-27 11:15:30,571 - INFO -  step: 960  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,769  tflops: 21.65  mfu: 6.94%
[rank1]:2025-10-27 11:15:30,572 - INFO -  step: 960  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,769  tflops: 21.65  mfu: 6.94%
[rank3]:2025-10-27 11:15:33,129 - INFO -  step: 960  loss:  0.0989  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,770  tflops: 21.65  mfu: 6.94%
[rank3]:2025-10-27 11:15:34,345 - INFO - Avg. fwd time: 71.8289 / Avg. bwd time: 74.1843 / Avg. batch time: 1217.4461 (ms) / GPU bubble ratio: 4.05%
[rank2]:2025-10-27 11:15:34,383 - INFO - Avg. fwd time: 33.1969 / Avg. bwd time: 34.6605 / Avg. batch time: 1405.9274 (ms) / GPU bubble ratio: 61.39%
[rank1]:2025-10-27 11:15:34,430 - INFO - Avg. fwd time: 52.8349 / Avg. bwd time: 44.5192 / Avg. batch time: 1500.5843 (ms) / GPU bubble ratio: 48.10%
[rank0]:2025-10-27 11:15:34,439 - INFO - Avg. fwd time: 45.1941 / Avg. bwd time: 9.7483 / Avg. batch time: 1547.9150 (ms) / GPU bubble ratio: 71.60%
[rank1]:2025-10-27 11:17:28,860 - INFO -  step: 980  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,770  tflops: 21.66  mfu: 6.94%
[rank2]:2025-10-27 11:17:28,860 - INFO -  step: 980  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,770  tflops: 21.66  mfu: 6.94%
[rank0]:2025-10-27 11:17:28,861 - INFO -  step: 980  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,770  tflops: 21.66  mfu: 6.94%
[rank3]:2025-10-27 11:17:31,463 - INFO -  step: 980  loss:  0.1129  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,769  tflops: 21.65  mfu: 6.94%
[rank3]:2025-10-27 11:17:32,640 - INFO - Avg. fwd time: 71.8195 / Avg. bwd time: 74.0507 / Avg. batch time: 1216.3259 (ms) / GPU bubble ratio: 4.06%
[rank2]:2025-10-27 11:17:32,677 - INFO - Avg. fwd time: 33.1949 / Avg. bwd time: 34.5439 / Avg. batch time: 1404.7321 (ms) / GPU bubble ratio: 61.42%
[rank0]:2025-10-27 11:17:32,732 - INFO - Avg. fwd time: 45.1895 / Avg. bwd time: 9.5495 / Avg. batch time: 1546.2946 (ms) / GPU bubble ratio: 71.68%
[rank1]:2025-10-27 11:17:32,724 - INFO - Avg. fwd time: 52.8429 / Avg. bwd time: 44.4052 / Avg. batch time: 1499.2011 (ms) / GPU bubble ratio: 48.11%
[rank0]:2025-10-27 11:19:21,841 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-27 11:19:27,208 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,769  tflops: 21.65  mfu: 6.94%
[rank0]:2025-10-27 11:19:27,208 - INFO -  final step: 1000  loss: -4.0000  grad_norm:  0.0000  tps: 2,672  tflops: 20.89  mfu: 6.54%
[rank0]:2025-10-27 11:19:27,208 - INFO - ðŸ”Ž  Running validation at step 1000
[rank1]:2025-10-27 11:19:27,208 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,769  tflops: 21.65  mfu: 6.94%
[rank1]:2025-10-27 11:19:27,208 - INFO -  final step: 1000  loss: -4.0000  grad_norm:  0.0000  tps: 2,672  tflops: 20.89  mfu: 6.54%
[rank1]:2025-10-27 11:19:27,208 - INFO - ðŸ”Ž  Running validation at step 1000
[rank2]:2025-10-27 11:19:27,208 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,769  tflops: 21.65  mfu: 6.94%
[rank2]:2025-10-27 11:19:27,208 - INFO -  final step: 1000  loss: -4.0000  grad_norm:  0.0000  tps: 2,672  tflops: 20.89  mfu: 6.54%
[rank2]:2025-10-27 11:19:27,208 - INFO - ðŸ”Ž  Running validation at step 1000
[rank3]:2025-10-27 11:19:29,837 - INFO -  step: 1000  loss:  0.1214  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,768  tflops: 21.64  mfu: 6.94%
[rank3]:2025-10-27 11:19:29,838 - INFO -  final step: 1000  loss:  0.1214  grad_norm:  0.0000  tps: 2,662  tflops: 20.81  mfu: 6.52%
[rank3]:2025-10-27 11:19:29,838 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-10-27 11:20:38,137 - INFO - validate step: 1000  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,775
[rank0]:2025-10-27 11:20:38,138 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-27 11:20:38,141 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1000.
[rank1]:2025-10-27 11:20:38,218 - INFO - validate step: 1000  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,768
[rank1]:2025-10-27 11:20:38,219 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-27 11:20:38,221 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1000.
[rank2]:2025-10-27 11:20:38,301 - INFO - validate step: 1000  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,762
[rank2]:2025-10-27 11:20:38,302 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-27 11:20:38,303 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1000.
[rank3]:2025-10-27 11:20:38,381 - INFO - validate step: 1000  loss:  0.2959  memory: 38.93GiB(81.95%)  tps: 5,976
[rank3]:2025-10-27 11:20:38,383 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-27 11:20:38,392 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1000.
[rank0]:2025-10-27 11:20:40,798 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank0]:2025-10-27 11:20:40,878 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251027_1120_stage0_final1000.svg
[rank1]:2025-10-27 11:20:40,878 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251027_1120_stage1_final1000.svg
[rank2]:2025-10-27 11:20:40,879 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251027_1120_stage2_final1000.svg
[rank3]:2025-10-27 11:20:40,987 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1026_GPipe_timelyapf_dm1/pipeline_schedule/251027_1120_real_final1000_rank3.svg
[rank3]:> Batch Time: 1303.97 ms, GPU Bubble Ratio: 72.11%, 43.48%, 62.09%, 13.91%
[rank0]:2025-10-27 11:20:41,098 - INFO - Elementwise Histogram is saved as: /data3/shcho/torchtitan/images/1026_GPipe_timelyapf_dm1/frozen_params_histogram/251027_1120_rank0_stage0.svg
[rank0]:	> Counts Sum: 930240, Total Sum: 1065600 (87.30%), Ratio(%) per element: [87.29, 87.5, 87.36, 87.15, 87.36, 87.15, 87.56, 87.22, 87.36, 87.43, 87.43, 87.29, 87.43, 87.43, 87.36, 87.29, 87.15, 87.15, 87.15, 87.43, 87.43, 87.08, 87.15, 87.29, 87.22, 87.01, 87.22, 87.15, 87.29, 87.36, 87.43, 87.22, 87.29, 87.36, 87.29, 87.36, 87.29]
[rank0]:2025-10-27 11:20:41,098 - INFO - Sleeping 2 seconds for other ranks to complete
[rank1]:2025-10-27 11:20:41,077 - INFO - Elementwise Histogram is saved as: /data3/shcho/torchtitan/images/1026_GPipe_timelyapf_dm1/frozen_params_histogram/251027_1120_rank1_stage1.svg
[rank1]:	> Counts Sum: 1122480, Total Sum: 1296000 (86.61%), Ratio(%) per element: [86.66, 86.73, 86.52, 86.87, 86.38, 86.45, 86.45, 86.18, 86.52, 86.73, 86.45, 86.73, 86.8, 86.45, 86.66, 86.59, 86.73, 86.52, 86.59, 86.66, 86.59, 86.52, 86.45, 86.25, 86.45, 86.45, 86.8, 86.59, 86.8, 86.8, 86.8, 86.59, 86.59, 86.52, 86.66, 86.38, 87.01, 86.73, 86.52, 86.73, 86.45, 86.66, 86.8, 86.66, 86.73]
[rank1]:2025-10-27 11:20:41,078 - INFO - Destroying the purge thread.
[rank2]:2025-10-27 11:20:41,099 - INFO - Elementwise Histogram is saved as: /data3/shcho/torchtitan/images/1026_GPipe_timelyapf_dm1/frozen_params_histogram/251027_1120_rank2_stage2.svg
[rank2]:	> Counts Sum: 914040, Total Sum: 1036800 (88.16%), Ratio(%) per element: [88.19, 88.19, 88.12, 88.12, 88.12, 88.12, 88.19, 88.12, 88.19, 88.19, 88.19, 88.12, 88.12, 88.19, 88.12, 88.19, 88.12, 88.12, 88.19, 88.12, 88.19, 88.12, 88.12, 88.26, 88.12, 88.12, 88.19, 88.26, 88.19, 88.19, 88.12, 88.19, 88.12, 88.12, 88.12, 88.12]
[rank2]:2025-10-27 11:20:41,099 - INFO - Destroying the purge thread.
[rank3]:2025-10-27 11:20:41,182 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1026_GPipe_timelyapf_dm1/pipeline_schedule/251027_1120_thry_final1000_rank3.svg
[rank3]:> Batch Time: 1684.87 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:2025-10-27 11:20:41,247 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251027_1120_stage3_final1000.svg
[rank2]:2025-10-27 11:20:41,251 - INFO - Process group destroyed
[rank1]:2025-10-27 11:20:41,295 - INFO - Process group destroyed
[rank3]:2025-10-27 11:20:41,437 - INFO - Elementwise Histogram is saved as: /data3/shcho/torchtitan/images/1026_GPipe_timelyapf_dm1/frozen_params_histogram/251027_1120_rank3_stage3.svg
[rank3]:	> Counts Sum: 2560, Total Sum: 835200 (0.31%), Ratio(%) per element: [0.13, 0.2, 0.2, 0.27, 0.06, 0.13, 0.2, 0.55, 0.27, 0.13, 0.27, 0.62, 0.2, 0.34, 0.41, 0.55, 0.2, 0.34, 0.34, 0.2, 0.48, 0.2, 0.34, 0.41, 0.34, 0.34, 0.55, 0.41, 0.0]
[rank3]:2025-10-27 11:20:41,438 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading history steps 50-50, summary, console lines 390-400
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ƒâ–ˆâ–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ƒâ–ˆâ–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 6.15418
[rank3]:wandb:               final/avg_loss 0.12143
[rank3]:wandb:             final/avg_mfu(%) 6.51727
[rank3]:wandb:             final/avg_tflops 20.81228
[rank3]:wandb:    final/avg_throughput(tps) 2662.25413
[rank3]:wandb:              final/grad_norm 0
[rank3]:wandb:               final/max_loss 0.12143
[rank3]:wandb:                    grad_norm 0
[rank3]:wandb: loss_metrics/global_avg_loss 0.12143
[rank3]:wandb: loss_metrics/global_max_loss 0.12143
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1026_GPipe_timelyapf_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/dzux10pe
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data3/shcho/torchtitan/tb/1026_GPipe_timelyapf_dm1/20251027-0924/wandb/run-20251027_092431-dzux10pe/logs
[rank3]:2025-10-27 11:20:42,759 - INFO - Process group destroyed
[rank0]:2025-10-27 11:20:43,098 - INFO - Training completed
[rank0]:2025-10-27 11:20:43,099 - INFO - Destroying the purge thread.
[rank0]:2025-10-27 11:20:43,553 - INFO - Process group destroyed
[rank0]:Stage 0: Modules to keep: {'layers.0', 'layers.3', 'tok_embeddings', 'layers.2', 'layers.1'}
[rank2]:Stage 2: Modules to keep: {'layers.9', 'layers.10', 'layers.12', 'layers.11'}
[rank1]:Stage 1: Modules to keep: {'layers.5', 'layers.7', 'layers.8', 'layers.6', 'layers.4'}
[rank3]:Stage 3: Modules to keep: {'layers.15', 'layers.13', 'norm', 'layers.14', 'output'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1026_llama1b/config.toml
[rank3]:		- dump_folder: /data3/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1026_GPipe_timelyapf_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data3/shcho/torchtitan/profile_trace/1026_GPipe_timelyapf_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data3/shcho/torchtitan/memory_snapshot/1026_GPipe_timelyapf_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 20
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data3/shcho/torchtitan/tb/1026_GPipe_timelyapf_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data3/shcho/torchtitan/images/1026_GPipe_timelyapf_dm1
[rank3]:		- pplog_freq: 80
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1026_GPipe_timelyapf_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B-Instruct
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 2e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: alpaca
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 1000
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: GPipe
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data3/shcho/torchtitan/checkpoint/1026_GPipe_timelyapf_dm1
[rank3]:		- interval: 500
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B-Instruct/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data3/shcho/torchtitan/comm_traces/1026_GPipe_timelyapf_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: True
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- seq_len: 1024
[rank3]:		- freq: 100
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: timelyapf
[rank3]:		- phase_unit: 10
[rank3]:		- stability_check_freq: 5
[rank3]:		- aggressiveness: 0
[rank3]:
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
