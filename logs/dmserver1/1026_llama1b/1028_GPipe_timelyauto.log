
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 10. 28. (í™”) 08:42:05 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 3,4,5,6
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1026_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1026_llama1b/1028_GPipe_timelyauto.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs
âœ”ï¸Running with timelyauto x GPipe ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1026_llama1b/config.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=timelyauto
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank2]:2025-10-28 08:42:11,242 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs"
[rank3]:2025-10-28 08:42:11,242 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs"
[rank1]:2025-10-28 08:42:11,319 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs"
[rank0]:2025-10-28 08:42:11,441 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs"
[rank3]:2025-10-28 08:42:11,963 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-10-28 08:42:11,980 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-10-28 08:42:11,982 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-28 08:42:11,986 - INFO - [GC] Initial GC collection 0.00 seconds
[rank1]:2025-10-28 08:42:12,001 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-10-28 08:42:12,003 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-10-28 08:42:11,987 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-10-28 08:42:11,989 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-10-28 08:42:11,966 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-28 08:42:12,414 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-10-28 08:42:12,872 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank0]:2025-10-28 08:42:15,797 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=512, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank2]:2025-10-28 08:42:15,780 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-10-28 08:42:15,823 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-10-28 08:42:15,850 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-10-28 08:42:15,851 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2025-10-28 08:42:15,801 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-10-28 08:42:15,839 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-10-28 08:42:15,865 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-10-28 08:42:15,865 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-10-28 08:42:15,960 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-10-28 08:42:15,998 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-10-28 08:42:15,999 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-10-28 08:42:16,028 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-10-28 08:42:16,028 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank2]:2025-10-28 08:42:16,029 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-10-28 08:42:16,029 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-10-28 08:42:16,030 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank1]:2025-10-28 08:42:16,040 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-10-28 08:42:16,040 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-10-28 08:42:16,040 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank0]:2025-10-28 08:42:16,227 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-10-28 08:42:16,228 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-10-28 08:42:16,229 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run dractsat
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data3/shcho/torchtitan/tb/1028_GPipe_timelyauto_dm1/20251028-0842/wandb/run-20251028_084218-dractsat
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1028_GPipe_timelyauto_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/dractsat
[rank3]:2025-10-28 08:42:19,735 - INFO - WandB logging enabled
[rank3]:2025-10-28 08:42:19,736 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-10-28 08:42:19,776 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-10-28 08:42:19,805 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-10-28 08:42:19,805 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-10-28 08:42:20,027 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data3/shcho/torchtitan/checkpoint/1028_GPipe_timelyauto_dm1
[rank0]:2025-10-28 08:42:20,027 - WARNING - Mixed precision training with TP or PP is only supported when FSDP/HSDP/CP is enabled.
[rank0]:2025-10-28 08:42:20,027 - INFO - Mixed precision training is disabled
[rank0]:2025-10-28 08:42:20,027 - INFO - Preparing c4_validation dataset from allenai/c4
[rank3]:2025-10-28 08:42:20,011 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-10-28 08:42:20,012 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-10-28 08:42:20,013 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank0]:2025-10-28 08:42:25,494 - INFO - Trainer is initialized with local batch size 32, global batch size 64, gradient accumulation steps 2, sequence length 512, total steps 1600 (warmup 100)
[rank0]:2025-10-28 08:42:25,494 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B-Instruct/original_dcp.
[rank0]:2025-10-28 08:42:28,523 - INFO - [GC] GC collection for checkpoint loading. 0.01 seconds
[rank0]:2025-10-28 08:42:28,523 - INFO - Finished loading the checkpoint in 3.03 seconds.
[rank0]:2025-10-28 08:42:28,523 - INFO - Training starts at step 1
[rank0]:'(ReadTimeoutError("HTTPSConnectionPool(host='huggingface.co', port=443): Read timed out. (read timeout=10)"), '(Request ID: 45601f95-0c8e-4d70-abc6-682f59a3da7a)')' thrown while requesting GET https://huggingface.co/datasets/tatsu-lab/alpaca/resolve/dce01c9b08f87459cf36a430d809084718273017/data/train-00000-of-00001-a09b74b3ef9c3b56.parquet
[rank0]:2025-10-28 08:42:38,542 - WARNING - '(ReadTimeoutError("HTTPSConnectionPool(host='huggingface.co', port=443): Read timed out. (read timeout=10)"), '(Request ID: 45601f95-0c8e-4d70-abc6-682f59a3da7a)')' thrown while requesting GET https://huggingface.co/datasets/tatsu-lab/alpaca/resolve/dce01c9b08f87459cf36a430d809084718273017/data/train-00000-of-00001-a09b74b3ef9c3b56.parquet
[rank0]:Retrying in 1s [Retry 1/5].
[rank0]:2025-10-28 08:42:38,543 - WARNING - Retrying in 1s [Retry 1/5].
[rank1]:'(ReadTimeoutError("HTTPSConnectionPool(host='huggingface.co', port=443): Read timed out. (read timeout=10)"), '(Request ID: 06923865-0567-4f3f-9179-2224695758c0)')' thrown while requesting GET https://huggingface.co/datasets/tatsu-lab/alpaca/resolve/dce01c9b08f87459cf36a430d809084718273017/data/train-00000-of-00001-a09b74b3ef9c3b56.parquet
[rank1]:2025-10-28 08:42:38,535 - WARNING - '(ReadTimeoutError("HTTPSConnectionPool(host='huggingface.co', port=443): Read timed out. (read timeout=10)"), '(Request ID: 06923865-0567-4f3f-9179-2224695758c0)')' thrown while requesting GET https://huggingface.co/datasets/tatsu-lab/alpaca/resolve/dce01c9b08f87459cf36a430d809084718273017/data/train-00000-of-00001-a09b74b3ef9c3b56.parquet
[rank1]:Retrying in 1s [Retry 1/5].
[rank1]:2025-10-28 08:42:38,543 - WARNING - Retrying in 1s [Retry 1/5].
[rank0]:'(ReadTimeoutError("HTTPSConnectionPool(host='huggingface.co', port=443): Read timed out. (read timeout=10)"), '(Request ID: 8b6e9af2-7c9a-4d4a-8740-d723ab4a4f38)')' thrown while requesting GET https://huggingface.co/datasets/tatsu-lab/alpaca/resolve/dce01c9b08f87459cf36a430d809084718273017/data/train-00000-of-00001-a09b74b3ef9c3b56.parquet
[rank0]:2025-10-28 08:42:49,603 - WARNING - '(ReadTimeoutError("HTTPSConnectionPool(host='huggingface.co', port=443): Read timed out. (read timeout=10)"), '(Request ID: 8b6e9af2-7c9a-4d4a-8740-d723ab4a4f38)')' thrown while requesting GET https://huggingface.co/datasets/tatsu-lab/alpaca/resolve/dce01c9b08f87459cf36a430d809084718273017/data/train-00000-of-00001-a09b74b3ef9c3b56.parquet
[rank0]:Retrying in 2s [Retry 2/5].
[rank0]:2025-10-28 08:42:49,603 - WARNING - Retrying in 2s [Retry 2/5].
[rank0]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/autograd/graph.py:849: UserWarning: Attempting to run cuBLAS, but there was no current CUDA context! Attempting to set the primary context... (Triggered internally at /pytorch/aten/src/ATen/cuda/CublasHandlePool.cpp:270.)
[rank0]:  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
[rank1]:2025-10-28 08:42:58,531 - INFO -  step:  1  loss: -2.0000  grad_norm: 95.1855  memory: 17.77GiB(37.40%)  tps: 192  tflops: 1.46  mfu: 0.47%
[rank1]:2025-10-28 08:42:58,531 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-28 08:42:58,541 - INFO -  step:  1  loss:  9.0107  grad_norm: 95.1855  memory: 35.59GiB(74.92%)  tps: 211  tflops: 1.61  mfu: 0.52%
[rank3]:2025-10-28 08:42:58,541 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-10-28 08:42:58,567 - INFO -  step:  1  loss: -2.0000  grad_norm: 95.1855  memory: 17.10GiB(35.99%)  tps: 192  tflops: 1.47  mfu: 0.47%
[rank0]:2025-10-28 08:42:58,567 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-10-28 08:42:58,527 - INFO -  step:  1  loss: -2.0000  grad_norm: 95.1855  memory: 14.29GiB(30.07%)  tps: 192  tflops: 1.46  mfu: 0.47%
[rank2]:2025-10-28 08:42:58,528 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-28 08:43:15,725 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 08:43:15,726 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 08:43:15,727 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 08:43:15,727 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 08:43:15,727 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 08:43:15,728 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 08:43:15,728 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 08:43:15,728 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 08:43:15,729 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 08:43:15,729 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 08:43:15,729 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 08:43:15,729 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 08:43:15,730 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 08:43:15,730 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 08:43:15,730 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 08:43:15,730 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 08:43:15,784 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 08:43:15,784 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 08:43:15,784 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 08:43:15,784 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 08:43:15,784 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 08:43:15,784 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 08:43:15,784 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 08:43:15,784 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 08:43:15,784 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 08:43:15,784 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 08:43:15,785 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 08:43:15,785 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 08:43:15,785 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 08:43:15,785 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 08:43:15,785 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 08:43:15,785 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 08:43:15,859 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 08:43:15,859 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 08:43:15,859 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 08:43:15,859 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 08:43:15,859 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 08:43:15,859 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 08:43:15,859 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 08:43:15,859 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 08:43:15,859 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 08:43:15,860 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 08:43:15,860 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 08:43:15,860 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 08:43:15,860 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 08:43:15,860 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 08:43:15,860 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 08:43:15,860 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 08:43:15,918 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 08:43:15,918 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 08:43:15,919 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 08:43:15,919 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 08:43:15,919 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 08:43:15,919 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 08:43:15,919 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 08:43:15,919 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 08:43:15,919 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 08:43:15,919 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 08:43:15,919 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 08:43:15,919 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 08:43:15,919 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 08:43:15,919 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 08:43:15,919 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 08:43:15,919 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 08:44:13,105 - INFO -  step: 20  loss: -2.0000  grad_norm: 62.5808  memory: 20.03GiB(42.17%)  tps: 2,087  tflops: 15.90  mfu: 5.09%
[rank3]:2025-10-28 08:44:13,114 - INFO -  step: 20  loss: 10.8312  grad_norm: 62.5808  memory: 38.93GiB(81.95%)  tps: 2,087  tflops: 15.90  mfu: 5.10%
[rank0]:2025-10-28 08:44:13,119 - INFO -  step: 20  loss: -2.0000  grad_norm: 62.5808  memory: 20.89GiB(43.97%)  tps: 2,088  tflops: 15.90  mfu: 5.10%
[rank2]:2025-10-28 08:44:13,102 - INFO -  step: 20  loss: -2.0000  grad_norm: 62.5808  memory: 16.10GiB(33.90%)  tps: 2,087  tflops: 15.90  mfu: 5.09%
[rank1]:2025-10-28 08:45:32,732 - INFO -  step: 40  loss: -2.0000  grad_norm: 41.4136  memory: 20.03GiB(42.17%)  tps: 2,058  tflops: 15.67  mfu: 5.02%
[rank0]:2025-10-28 08:45:32,747 - INFO -  step: 40  loss: -2.0000  grad_norm: 41.4136  memory: 20.89GiB(43.97%)  tps: 2,058  tflops: 15.67  mfu: 5.02%
[rank2]:2025-10-28 08:45:32,728 - INFO -  step: 40  loss: -2.0000  grad_norm: 41.4136  memory: 16.10GiB(33.90%)  tps: 2,058  tflops: 15.67  mfu: 5.02%
[rank3]:2025-10-28 08:45:32,741 - INFO -  step: 40  loss:  5.6583  grad_norm: 41.4136  memory: 38.93GiB(81.95%)  tps: 2,058  tflops: 15.67  mfu: 5.02%
[rank2]:2025-10-28 08:45:34,604 - INFO - Avg. fwd time: 32.0633 / Avg. bwd time: 51.3145 / Avg. batch time: 1734.4601 (ms) / GPU bubble ratio: 61.54%
[rank3]:2025-10-28 08:45:34,550 - INFO - Avg. fwd time: 70.5005 / Avg. bwd time: 126.8798 / Avg. batch time: 1647.1575 (ms) / GPU bubble ratio: 4.14%
[rank1]:2025-10-28 08:45:34,678 - INFO - Avg. fwd time: 50.2421 / Avg. bwd time: 69.3414 / Avg. batch time: 1850.1580 (ms) / GPU bubble ratio: 48.29%
[rank0]:2025-10-28 08:45:34,742 - INFO - Avg. fwd time: 44.3873 / Avg. bwd time: 56.7878 / Avg. batch time: 1944.5096 (ms) / GPU bubble ratio: 58.38%
[rank0]:2025-10-28 08:46:08,613 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-28 08:46:52,375 - INFO -  step: 60  loss: -2.0000  grad_norm: 32.2086  memory: 16.10GiB(33.90%)  tps: 2,057  tflops: 15.67  mfu: 5.02%
[rank0]:2025-10-28 08:46:52,394 - INFO -  step: 60  loss: -2.0000  grad_norm: 32.2086  memory: 20.89GiB(43.97%)  tps: 2,057  tflops: 15.67  mfu: 5.02%
[rank3]:2025-10-28 08:46:52,387 - INFO -  step: 60  loss:  8.4913  grad_norm: 32.2086  memory: 38.93GiB(81.95%)  tps: 2,057  tflops: 15.67  mfu: 5.02%
[rank1]:2025-10-28 08:46:52,380 - INFO -  step: 60  loss: -2.0000  grad_norm: 32.2086  memory: 20.03GiB(42.17%)  tps: 2,057  tflops: 15.67  mfu: 5.02%
[rank0]:2025-10-28 08:48:12,088 - INFO -  step: 80  loss: -2.0000  grad_norm: 43.1303  memory: 20.89GiB(43.97%)  tps: 2,056  tflops: 15.66  mfu: 5.02%
[rank2]:2025-10-28 08:48:12,069 - INFO -  step: 80  loss: -2.0000  grad_norm: 43.1303  memory: 16.10GiB(33.90%)  tps: 2,056  tflops: 15.66  mfu: 5.02%
[rank3]:2025-10-28 08:48:12,082 - INFO -  step: 80  loss:  4.0008  grad_norm: 43.1303  memory: 38.93GiB(81.95%)  tps: 2,056  tflops: 15.66  mfu: 5.02%
[rank1]:2025-10-28 08:48:12,073 - INFO -  step: 80  loss: -2.0000  grad_norm: 43.1303  memory: 20.03GiB(42.17%)  tps: 2,056  tflops: 15.66  mfu: 5.02%
[rank3]:2025-10-28 08:48:13,919 - INFO - Avg. fwd time: 71.2413 / Avg. bwd time: 128.2129 / Avg. batch time: 1654.1603 (ms) / GPU bubble ratio: 3.54%
[rank2]:2025-10-28 08:48:13,974 - INFO - Avg. fwd time: 32.3057 / Avg. bwd time: 51.7408 / Avg. batch time: 1741.6154 (ms) / GPU bubble ratio: 61.39%
[rank0]:2025-10-28 08:48:14,102 - INFO - Avg. fwd time: 45.0255 / Avg. bwd time: 57.4468 / Avg. batch time: 1952.2946 (ms) / GPU bubble ratio: 58.01%
[rank1]:2025-10-28 08:48:14,042 - INFO - Avg. fwd time: 50.9563 / Avg. bwd time: 69.8822 / Avg. batch time: 1857.6010 (ms) / GPU bubble ratio: 47.96%
[rank3]:2025-10-28 08:49:11,208 - INFO - [Step 95] ã€°ï¸ Monitoring Upperbound
[rank0]:2025-10-28 08:49:27,985 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-28 08:49:31,156 - WARNING - [Step 100] â³ Monitoring Upperbound... (200/200)
[rank2]:2025-10-28 08:49:31,788 - WARNING - [Step 100] â³ Monitoring Upperbound... (200/200)
[rank0]:2025-10-28 08:49:31,916 - WARNING - [Step 100] â³ Monitoring Upperbound... (200/200)
[rank1]:2025-10-28 08:49:31,858 - WARNING - [Step 100] â³ Monitoring Upperbound... (200/200)
[rank2]:2025-10-28 08:49:31,934 - INFO -  step: 100  loss: -2.0000  grad_norm: 50.8866  memory: 16.10GiB(33.90%)  tps: 2,051  tflops: 15.62  mfu: 5.01%
[rank2]:2025-10-28 08:49:31,934 - INFO - ðŸ”Ž  Running validation at step 100
[rank0]:2025-10-28 08:49:31,955 - INFO -  step: 100  loss: -2.0000  grad_norm: 50.8866  memory: 20.89GiB(43.97%)  tps: 2,051  tflops: 15.62  mfu: 5.01%
[rank0]:2025-10-28 08:49:31,956 - INFO - ðŸ”Ž  Running validation at step 100
[rank1]:2025-10-28 08:49:31,940 - INFO -  step: 100  loss: -2.0000  grad_norm: 50.8866  memory: 20.03GiB(42.17%)  tps: 2,051  tflops: 15.62  mfu: 5.01%
[rank1]:2025-10-28 08:49:31,940 - INFO - ðŸ”Ž  Running validation at step 100
[rank3]:2025-10-28 08:49:31,948 - INFO -  step: 100  loss:  5.4801  grad_norm: 50.8866  memory: 38.93GiB(81.95%)  tps: 2,051  tflops: 15.62  mfu: 5.01%
[rank3]:2025-10-28 08:49:31,948 - INFO - ðŸ”Ž  Running validation at step 100
[rank0]:2025-10-28 08:50:44,362 - INFO - validate step: 100  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,657
[rank1]:2025-10-28 08:50:44,442 - INFO - validate step: 100  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,650
[rank2]:2025-10-28 08:50:44,523 - INFO - validate step: 100  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,643
[rank3]:2025-10-28 08:50:44,588 - INFO - validate step: 100  loss:  2.0088  memory: 38.93GiB(81.95%)  tps: 5,639
[rank1]:2025-10-28 08:50:44,683 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251028_0850_stage1_step100.svg
[rank0]:2025-10-28 08:50:44,684 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251028_0850_stage0_step100.svg
[rank2]:2025-10-28 08:50:44,682 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251028_0850_stage2_step100.svg
[rank3]:2025-10-28 08:50:44,825 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251028_0850_real_step100_rank3.svg
[rank3]:> Batch Time: 1904.75 ms, GPU Bubble Ratio: 56.78%, 48.76%, 64.85%, 15.37%
[rank3]:2025-10-28 08:50:44,888 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251028_0850_stage3_step100.svg
[rank3]:2025-10-28 08:51:04,064 - INFO - [Step 105] âœ”ï¸  Setting Upperbound
[rank1]:2025-10-28 08:51:04,935 - WARNING - Batch index 211 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-28 08:51:04,926 - WARNING - Batch index 211 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-28 08:51:04,944 - WARNING - Batch index 211 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-28 08:51:04,868 - INFO - [Step 105] ã€°ï¸ Monitoring Lowerbound
[rank3]:2025-10-28 08:51:04,919 - WARNING - Batch index 211 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-28 08:51:04,933 - WARNING - Batch index 211 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-28 08:51:04,944 - WARNING - Batch index 211 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-28 08:51:04,925 - WARNING - Batch index 211 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-28 08:51:04,944 - WARNING - Batch index 211 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-28 08:51:04,988 - WARNING - Batch index 211 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-28 08:51:04,956 - WARNING - Batch index 211 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-28 08:51:05,025 - WARNING - Batch index 211 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-28 08:51:05,020 - WARNING - Batch index 211 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-28 08:51:05,044 - WARNING - Batch index 211 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-28 08:51:05,124 - WARNING - Batch index 211 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-28 08:51:05,132 - WARNING - Batch index 211 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-28 08:51:05,170 - WARNING - Batch index 211 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-28 08:51:05,230 - WARNING - Batch index 211 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-28 08:51:05,175 - WARNING - Batch index 211 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-28 08:51:05,262 - WARNING - Batch index 211 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-28 08:51:05,340 - WARNING - Batch index 211 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-28 08:51:05,327 - WARNING - Batch index 211 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-28 08:51:05,418 - WARNING - Batch index 211 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-28 08:51:05,510 - WARNING - Batch index 211 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-28 08:51:05,493 - WARNING - Batch index 211 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-28 08:51:05,750 - WARNING - Batch index 211 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-28 08:51:05,814 - WARNING - Batch index 211 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-28 08:51:05,886 - WARNING - Batch index 211 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-28 08:51:05,947 - WARNING - Batch index 211 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-28 08:51:05,943 - WARNING - Batch index 211 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-28 08:51:06,009 - WARNING - Batch index 211 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-28 08:51:06,137 - WARNING - Batch index 211 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-28 08:51:06,070 - WARNING - Batch index 211 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-28 08:51:32,028 - INFO - [Step 115] âœ”ï¸  Setting Lowerbound
[rank3]:2025-10-28 08:51:32,933 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251028_0851_max_batch_time.svg
[rank3]:> Batch Time: 1906.81 ms, GPU Bubble Ratio: 56.68%, 49.05%, 64.90%, 15.46%
[rank3]:2025-10-28 08:51:33,121 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251028_0851_min_batch_time.svg
[rank3]:> Batch Time: 1287.74 ms, GPU Bubble Ratio: 71.62%, 46.12%, 63.41%, 13.78%
[rank3]:2025-10-28 08:51:33,327 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251028_0851_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 1287.74 ms, GPU Bubble Ratio: 43.08%, 31.54%, 49.95%, 13.78%
[rank3]:2025-10-28 08:51:33,328 - INFO - 	> Batch Time: 1287.74 ms (Average Freeze Ratio: 0.41, Time Reduction Rate: 0.32)
[rank0]:2025-10-28 08:51:46,798 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.29/0.29, [MB6] 0.33/0.33, [MB7] 1.00/1.00
[rank0]:2025-10-28 08:51:46,799 - INFO -  step: 120  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,624  tflops: 19.99  mfu: 6.41%
[rank1]:2025-10-28 08:51:46,798 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.34/0.34, [MB4] 0.16/0.16, [MB5] 0.11/0.11, [MB6] 0.86/0.86, [MB7] 1.00/1.00
[rank1]:2025-10-28 08:51:46,799 - INFO -  step: 120  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,627  tflops: 20.01  mfu: 6.41%
[rank3]:2025-10-28 08:51:46,750 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-28 08:51:46,798 - INFO -  step: 120  loss:  2.4987  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,634  tflops: 20.06  mfu: 6.43%
[rank2]:2025-10-28 08:51:46,757 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-28 08:51:46,797 - INFO -  step: 120  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,631  tflops: 20.04  mfu: 6.42%
[rank3]:2025-10-28 08:51:48,109 - INFO - Avg. fwd time: 71.5836 / Avg. bwd time: 121.0284 / Avg. batch time: 1595.7776 (ms) / GPU bubble ratio: 3.44%
[rank0]:2025-10-28 08:51:48,182 - INFO - Avg. fwd time: 45.2574 / Avg. bwd time: 50.4140 / Avg. batch time: 1881.5417 (ms) / GPU bubble ratio: 59.32%
[rank1]:2025-10-28 08:51:48,179 - INFO - Avg. fwd time: 51.2109 / Avg. bwd time: 65.7207 / Avg. batch time: 1794.1406 (ms) / GPU bubble ratio: 47.86%
[rank2]:2025-10-28 08:51:48,140 - INFO - Avg. fwd time: 32.4072 / Avg. bwd time: 48.6711 / Avg. batch time: 1682.3279 (ms) / GPU bubble ratio: 61.44%
[rank1]:2025-10-28 08:52:40,872 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251028_0852_rank1_trend_line.svg
[rank1]:2025-10-28 08:52:40,880 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank1]:2025-10-28 08:52:40,881 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank1]:2025-10-28 08:52:40,881 - INFO -  step: 140  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 3,029  tflops: 23.07  mfu: 7.40%
[rank3]:2025-10-28 08:52:40,856 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251028_0852_rank3_trend_line.svg
[rank2]:2025-10-28 08:52:40,856 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251028_0852_rank2_trend_line.svg
[rank2]:2025-10-28 08:52:40,879 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank2]:2025-10-28 08:52:40,880 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank2]:2025-10-28 08:52:40,881 - INFO -  step: 140  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 3,029  tflops: 23.07  mfu: 7.39%
[rank0]:2025-10-28 08:52:40,873 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251028_0852_rank0_trend_line.svg
[rank0]:2025-10-28 08:52:40,880 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank0]:2025-10-28 08:52:40,881 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank0]:2025-10-28 08:52:40,881 - INFO -  step: 140  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 3,029  tflops: 23.07  mfu: 7.40%
[rank3]:2025-10-28 08:52:41,069 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251028_0852_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 1280.05 ms, GPU Bubble Ratio: 71.45%, 45.90%, 63.10%, 13.65%
[rank3]:2025-10-28 08:52:41,069 - INFO - 	> Batch Time: 1280.05 ms (Average Freeze Ratio: 0.25)
[rank3]:2025-10-28 08:52:41,070 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-28 08:52:41,071 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-28 08:52:41,074 - INFO -  step: 140  loss:  4.9548  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 3,019  tflops: 22.99  mfu: 7.37%
[rank0]:2025-10-28 08:53:10,690 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-28 08:53:47,640 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251028_0853_rank1_trend_line.svg
[rank1]:2025-10-28 08:53:47,661 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.20/0.20, [MB7] 1.00/1.00
[rank1]:2025-10-28 08:53:47,666 - INFO -  step: 160  loss: -2.0000  grad_norm:  3.2596  memory: 20.03GiB(42.17%)  tps: 2,453  tflops: 18.68  mfu: 5.99%
[rank3]:2025-10-28 08:53:47,627 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251028_0853_rank3_trend_line.svg
[rank2]:2025-10-28 08:53:47,639 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251028_0853_rank2_trend_line.svg
[rank2]:2025-10-28 08:53:47,661 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-28 08:53:47,665 - INFO -  step: 160  loss: -2.0000  grad_norm:  3.2596  memory: 16.10GiB(33.90%)  tps: 2,453  tflops: 18.68  mfu: 5.99%
[rank0]:2025-10-28 08:53:47,655 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251028_0853_rank0_trend_line.svg
[rank0]:2025-10-28 08:53:47,661 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-28 08:53:47,666 - INFO -  step: 160  loss: -2.0000  grad_norm:  3.2596  memory: 20.89GiB(43.97%)  tps: 2,453  tflops: 18.68  mfu: 5.99%
[rank3]:2025-10-28 08:53:47,858 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251028_0853_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 1273.96 ms, GPU Bubble Ratio: 55.80%, 33.05%, 56.10%, 13.31%
[rank3]:2025-10-28 08:53:47,859 - INFO - 	> Batch Time: 1273.96 ms (Average Freeze Ratio: 0.35)
[rank3]:2025-10-28 08:53:47,859 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-28 08:53:47,863 - INFO -  step: 160  loss:  2.5068  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,453  tflops: 18.68  mfu: 5.99%
[rank3]:2025-10-28 08:53:49,032 - INFO - Avg. fwd time: 71.6461 / Avg. bwd time: 107.3845 / Avg. batch time: 1485.2177 (ms) / GPU bubble ratio: 3.57%
[rank2]:2025-10-28 08:53:49,205 - INFO - Avg. fwd time: 32.4667 / Avg. bwd time: 47.0191 / Avg. batch time: 1585.9887 (ms) / GPU bubble ratio: 59.91%
[rank1]:2025-10-28 08:53:49,332 - INFO - Avg. fwd time: 51.3141 / Avg. bwd time: 64.4740 / Avg. batch time: 1700.5454 (ms) / GPU bubble ratio: 45.53%
[rank0]:2025-10-28 08:53:49,399 - INFO - Avg. fwd time: 45.2263 / Avg. bwd time: 45.6595 / Avg. batch time: 1783.1150 (ms) / GPU bubble ratio: 59.22%
[rank2]:2025-10-28 08:54:42,006 - INFO -  step: 180  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 3,015  tflops: 22.96  mfu: 7.36%
[rank3]:2025-10-28 08:54:42,007 - INFO -  step: 180  loss:  4.2307  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 3,026  tflops: 23.05  mfu: 7.39%
[rank1]:2025-10-28 08:54:42,008 - INFO -  step: 180  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 3,015  tflops: 22.96  mfu: 7.36%
[rank0]:2025-10-28 08:54:42,008 - INFO -  step: 180  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 3,015  tflops: 22.96  mfu: 7.36%
[rank0]:2025-10-28 08:55:33,472 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-28 08:55:36,335 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251028_0855_rank2_trend_line.svg
[rank2]:2025-10-28 08:55:36,359 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-28 08:55:36,361 - INFO -  step: 200  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 3,014  tflops: 22.96  mfu: 7.36%
[rank2]:2025-10-28 08:55:36,361 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-10-28 08:55:36,353 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251028_0855_rank0_trend_line.svg
[rank0]:2025-10-28 08:55:36,359 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-28 08:55:36,360 - INFO -  step: 200  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 3,014  tflops: 22.96  mfu: 7.36%
[rank0]:2025-10-28 08:55:36,361 - INFO - ðŸ”Ž  Running validation at step 200
[rank3]:2025-10-28 08:55:36,336 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251028_0855_rank3_trend_line.svg
[rank1]:2025-10-28 08:55:36,352 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251028_0855_rank1_trend_line.svg
[rank1]:2025-10-28 08:55:36,359 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-10-28 08:55:36,360 - INFO -  step: 200  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 3,014  tflops: 22.96  mfu: 7.36%
[rank1]:2025-10-28 08:55:36,361 - INFO - ðŸ”Ž  Running validation at step 200
[rank3]:2025-10-28 08:55:36,552 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251028_0855_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 1277.39 ms, GPU Bubble Ratio: 61.44%, 37.45%, 58.40%, 13.52%
[rank3]:2025-10-28 08:55:36,552 - INFO - 	> Batch Time: 1277.39 ms (Average Freeze Ratio: 0.34)
[rank3]:2025-10-28 08:55:36,553 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-28 08:55:36,557 - INFO -  step: 200  loss:  2.4713  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 3,004  tflops: 22.88  mfu: 7.33%
[rank3]:2025-10-28 08:55:36,557 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-10-28 08:56:45,875 - INFO - validate step: 200  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,892
[rank1]:2025-10-28 08:56:45,958 - INFO - validate step: 200  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,885
[rank2]:2025-10-28 08:56:46,042 - INFO - validate step: 200  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,878
[rank3]:2025-10-28 08:56:46,104 - INFO - validate step: 200  loss:  1.8261  memory: 38.93GiB(81.95%)  tps: 5,890
[rank1]:2025-10-28 08:56:46,183 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251028_0856_stage1_step200.svg
[rank2]:2025-10-28 08:56:46,183 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251028_0856_stage2_step200.svg
[rank0]:2025-10-28 08:56:46,183 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251028_0856_stage0_step200.svg
[rank3]:2025-10-28 08:56:46,310 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251028_0856_real_step200_rank3.svg
[rank3]:> Batch Time: 1872.38 ms, GPU Bubble Ratio: 56.73%, 49.13%, 64.80%, 15.37%
[rank3]:2025-10-28 08:56:46,382 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251028_0856_stage3_step200.svg
[rank2]:2025-10-28 08:56:47,636 - INFO - Avg. fwd time: 32.5135 / Avg. bwd time: 43.0251 / Avg. batch time: 1512.8318 (ms) / GPU bubble ratio: 60.05%
[rank3]:2025-10-28 08:56:47,605 - INFO - Avg. fwd time: 71.7205 / Avg. bwd time: 99.2253 / Avg. batch time: 1419.6006 (ms) / GPU bubble ratio: 3.67%
[rank1]:2025-10-28 08:56:47,676 - INFO - Avg. fwd time: 51.6162 / Avg. bwd time: 58.8257 / Avg. batch time: 1620.8489 (ms) / GPU bubble ratio: 45.49%
[rank0]:2025-10-28 08:56:47,679 - INFO - Avg. fwd time: 45.2225 / Avg. bwd time: 36.5508 / Avg. batch time: 1693.9466 (ms) / GPU bubble ratio: 61.38%
[rank2]:2025-10-28 08:57:40,694 - INFO -  step: 220  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,998  tflops: 22.83  mfu: 7.32%
[rank0]:2025-10-28 08:57:40,696 - INFO -  step: 220  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,989  tflops: 22.76  mfu: 7.30%
[rank3]:2025-10-28 08:57:40,695 - INFO -  step: 220  loss:  4.3612  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 3,001  tflops: 22.86  mfu: 7.33%
[rank1]:2025-10-28 08:57:40,696 - INFO -  step: 220  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,993  tflops: 22.80  mfu: 7.31%
[rank3]:2025-10-28 08:58:35,014 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251028_0858_rank3_trend_line.svg
[rank1]:2025-10-28 08:58:35,033 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251028_0858_rank1_trend_line.svg
[rank1]:2025-10-28 08:58:35,041 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-10-28 08:58:35,043 - INFO -  step: 240  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 3,015  tflops: 22.96  mfu: 7.36%
[rank2]:2025-10-28 08:58:35,013 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251028_0858_rank2_trend_line.svg
[rank2]:2025-10-28 08:58:35,041 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-28 08:58:35,043 - INFO -  step: 240  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 3,015  tflops: 22.96  mfu: 7.36%
[rank0]:2025-10-28 08:58:35,035 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251028_0858_rank0_trend_line.svg
[rank0]:2025-10-28 08:58:35,041 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-28 08:58:35,043 - INFO -  step: 240  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 3,015  tflops: 22.96  mfu: 7.36%
[rank3]:2025-10-28 08:58:35,241 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251028_0858_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 1280.05 ms, GPU Bubble Ratio: 64.86%, 40.39%, 59.97%, 13.63%
[rank3]:2025-10-28 08:58:35,242 - INFO - 	> Batch Time: 1280.05 ms (Average Freeze Ratio: 0.34)
[rank3]:2025-10-28 08:58:35,242 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-28 08:58:35,246 - INFO -  step: 240  loss:  2.4469  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 3,004  tflops: 22.88  mfu: 7.33%
[rank3]:2025-10-28 08:58:36,416 - INFO - Avg. fwd time: 71.8440 / Avg. bwd time: 93.8073 / Avg. batch time: 1376.6442 (ms) / GPU bubble ratio: 3.74%
[rank2]:2025-10-28 08:58:36,449 - INFO - Avg. fwd time: 32.5698 / Avg. bwd time: 40.3520 / Avg. batch time: 1464.8349 (ms) / GPU bubble ratio: 60.17%
[rank0]:2025-10-28 08:58:36,493 - INFO - Avg. fwd time: 45.1725 / Avg. bwd time: 30.4720 / Avg. batch time: 1635.3598 (ms) / GPU bubble ratio: 63.00%
[rank1]:2025-10-28 08:58:36,490 - INFO - Avg. fwd time: 51.8265 / Avg. bwd time: 55.0398 / Avg. batch time: 1568.5759 (ms) / GPU bubble ratio: 45.50%
[rank0]:2025-10-28 08:58:59,607 - INFO - [GC] Peforming periodical GC collection 0.02 seconds
[rank2]:2025-10-28 08:59:29,324 - INFO -  step: 260  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 3,018  tflops: 22.99  mfu: 7.37%
[rank0]:2025-10-28 08:59:29,326 - INFO -  step: 260  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 3,018  tflops: 22.99  mfu: 7.37%
[rank3]:2025-10-28 08:59:29,325 - INFO -  step: 260  loss:  4.3604  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 3,030  tflops: 23.07  mfu: 7.40%
[rank1]:2025-10-28 08:59:29,325 - INFO -  step: 260  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 3,018  tflops: 22.99  mfu: 7.37%
[rank3]:2025-10-28 09:00:23,457 - INFO -  step: 280  loss:  2.4558  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 3,027  tflops: 23.05  mfu: 7.39%
[rank1]:2025-10-28 09:00:23,457 - INFO -  step: 280  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 3,027  tflops: 23.05  mfu: 7.39%
[rank2]:2025-10-28 09:00:23,456 - INFO -  step: 280  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 3,027  tflops: 23.05  mfu: 7.39%
[rank0]:2025-10-28 09:00:23,457 - INFO -  step: 280  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 3,027  tflops: 23.05  mfu: 7.39%
[rank2]:2025-10-28 09:00:24,816 - INFO - Avg. fwd time: 32.5668 / Avg. bwd time: 38.4296 / Avg. batch time: 1429.9292 (ms) / GPU bubble ratio: 60.28%
[rank3]:2025-10-28 09:00:24,785 - INFO - Avg. fwd time: 71.8926 / Avg. bwd time: 89.9166 / Avg. batch time: 1345.5432 (ms) / GPU bubble ratio: 3.80%
[rank1]:2025-10-28 09:00:24,856 - INFO - Avg. fwd time: 51.9569 / Avg. bwd time: 52.3150 / Avg. batch time: 1530.6412 (ms) / GPU bubble ratio: 45.50%
[rank0]:2025-10-28 09:00:24,859 - INFO - Avg. fwd time: 45.1398 / Avg. bwd time: 26.1269 / Avg. batch time: 1592.9001 (ms) / GPU bubble ratio: 64.21%
[rank0]:2025-10-28 09:01:14,896 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-28 09:01:17,573 - INFO -  step: 300  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 3,028  tflops: 23.06  mfu: 7.39%
[rank0]:2025-10-28 09:01:17,573 - INFO - ðŸ”Ž  Running validation at step 300
[rank2]:2025-10-28 09:01:17,571 - INFO -  step: 300  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 3,028  tflops: 23.06  mfu: 7.39%
[rank2]:2025-10-28 09:01:17,571 - INFO - ðŸ”Ž  Running validation at step 300
[rank3]:2025-10-28 09:01:17,572 - INFO -  step: 300  loss:  4.4257  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 3,028  tflops: 23.06  mfu: 7.39%
[rank3]:2025-10-28 09:01:17,573 - INFO - ðŸ”Ž  Running validation at step 300
[rank1]:2025-10-28 09:01:17,573 - INFO -  step: 300  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 3,028  tflops: 23.06  mfu: 7.39%
[rank1]:2025-10-28 09:01:17,573 - INFO - ðŸ”Ž  Running validation at step 300
[rank0]:2025-10-28 09:02:27,122 - INFO - validate step: 300  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,889
[rank1]:2025-10-28 09:02:27,206 - INFO - validate step: 300  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,882
[rank2]:2025-10-28 09:02:27,292 - INFO - validate step: 300  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,875
[rank3]:2025-10-28 09:02:27,356 - INFO - validate step: 300  loss:  1.8199  memory: 38.93GiB(81.95%)  tps: 5,870
[rank1]:2025-10-28 09:02:27,429 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251028_0902_stage1_step300.svg
[rank0]:2025-10-28 09:02:27,430 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251028_0902_stage0_step300.svg
[rank2]:2025-10-28 09:02:27,431 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251028_0902_stage2_step300.svg
[rank3]:2025-10-28 09:02:27,542 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251028_0902_real_step300_rank3.svg
[rank3]:> Batch Time: 1299.64 ms, GPU Bubble Ratio: 72.02%, 44.63%, 63.39%, 13.75%
[rank3]:2025-10-28 09:02:27,610 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251028_0902_stage3_step300.svg
[rank0]:2025-10-28 09:03:22,244 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251028_0903_rank0_trend_line.svg
[rank0]:2025-10-28 09:03:22,251 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-28 09:03:22,253 - INFO -  step: 320  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,972  tflops: 22.63  mfu: 7.25%
[rank2]:2025-10-28 09:03:22,226 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251028_0903_rank2_trend_line.svg
[rank2]:2025-10-28 09:03:22,251 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-28 09:03:22,253 - INFO -  step: 320  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,981  tflops: 22.70  mfu: 7.28%
[rank3]:2025-10-28 09:03:22,222 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251028_0903_rank3_trend_line.svg
[rank1]:2025-10-28 09:03:22,241 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251028_0903_rank1_trend_line.svg
[rank1]:2025-10-28 09:03:22,251 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-10-28 09:03:22,253 - INFO -  step: 320  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,976  tflops: 22.67  mfu: 7.27%
[rank3]:2025-10-28 09:03:22,453 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251028_0903_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 1281.33 ms, GPU Bubble Ratio: 67.54%, 42.64%, 61.24%, 13.70%
[rank3]:2025-10-28 09:03:22,453 - INFO - 	> Batch Time: 1281.33 ms (Average Freeze Ratio: 0.34)
[rank3]:2025-10-28 09:03:22,454 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-28 09:03:22,458 - INFO -  step: 320  loss:  2.4835  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,973  tflops: 22.65  mfu: 7.26%
[rank3]:2025-10-28 09:03:23,684 - INFO - Avg. fwd time: 71.9848 / Avg. bwd time: 87.0093 / Avg. batch time: 1322.6909 (ms) / GPU bubble ratio: 3.84%
[rank0]:2025-10-28 09:03:23,758 - INFO - Avg. fwd time: 45.1254 / Avg. bwd time: 22.8664 / Avg. batch time: 1561.8433 (ms) / GPU bubble ratio: 65.17%
[rank2]:2025-10-28 09:03:23,715 - INFO - Avg. fwd time: 32.5651 / Avg. bwd time: 36.9911 / Avg. batch time: 1404.5227 (ms) / GPU bubble ratio: 60.38%
[rank1]:2025-10-28 09:03:23,755 - INFO - Avg. fwd time: 51.9590 / Avg. bwd time: 50.2985 / Avg. batch time: 1502.9525 (ms) / GPU bubble ratio: 45.57%
[rank0]:2025-10-28 09:04:16,643 - INFO -  step: 340  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 3,012  tflops: 22.94  mfu: 7.35%
[rank2]:2025-10-28 09:04:16,641 - INFO -  step: 340  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 3,012  tflops: 22.94  mfu: 7.35%
[rank3]:2025-10-28 09:04:16,643 - INFO -  step: 340  loss:  4.3638  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 3,024  tflops: 23.03  mfu: 7.38%
[rank1]:2025-10-28 09:04:16,643 - INFO -  step: 340  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 3,012  tflops: 22.94  mfu: 7.35%
[rank0]:2025-10-28 09:04:41,129 - INFO - [GC] Peforming periodical GC collection 0.02 seconds
[rank2]:2025-10-28 09:05:11,137 - INFO -  step: 360  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 3,006  tflops: 22.90  mfu: 7.34%
[rank3]:2025-10-28 09:05:11,139 - INFO -  step: 360  loss:  2.5027  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 3,007  tflops: 22.90  mfu: 7.34%
[rank1]:2025-10-28 09:05:11,139 - INFO -  step: 360  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 3,006  tflops: 22.90  mfu: 7.34%
[rank0]:2025-10-28 09:05:11,139 - INFO -  step: 360  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 3,006  tflops: 22.90  mfu: 7.34%
[rank2]:2025-10-28 09:05:12,492 - INFO - Avg. fwd time: 32.5768 / Avg. bwd time: 35.8745 / Avg. batch time: 1384.5867 (ms) / GPU bubble ratio: 60.45%
[rank3]:2025-10-28 09:05:12,459 - INFO - Avg. fwd time: 72.0309 / Avg. bwd time: 84.7688 / Avg. batch time: 1304.9772 (ms) / GPU bubble ratio: 3.88%
[rank1]:2025-10-28 09:05:12,536 - INFO - Avg. fwd time: 52.0717 / Avg. bwd time: 48.7365 / Avg. batch time: 1481.2865 (ms) / GPU bubble ratio: 45.56%
[rank0]:2025-10-28 09:05:12,540 - INFO - Avg. fwd time: 45.0954 / Avg. bwd time: 20.3294 / Avg. batch time: 1537.5471 (ms) / GPU bubble ratio: 65.96%
[rank0]:2025-10-28 09:06:05,634 - INFO -  step: 380  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 3,007  tflops: 22.90  mfu: 7.34%
[rank2]:2025-10-28 09:06:05,632 - INFO -  step: 380  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 3,007  tflops: 22.90  mfu: 7.34%
[rank3]:2025-10-28 09:06:05,634 - INFO -  step: 380  loss:  4.3798  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 3,007  tflops: 22.90  mfu: 7.34%
[rank1]:2025-10-28 09:06:05,634 - INFO -  step: 380  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 3,007  tflops: 22.90  mfu: 7.34%
[rank0]:2025-10-28 09:06:57,422 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-28 09:07:00,165 - INFO -  step: 400  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 3,004  tflops: 22.88  mfu: 7.33%
[rank2]:2025-10-28 09:07:00,165 - INFO - ðŸ”Ž  Running validation at step 400
[rank3]:2025-10-28 09:07:00,166 - INFO -  step: 400  loss:  2.5079  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 3,005  tflops: 22.88  mfu: 7.33%
[rank3]:2025-10-28 09:07:00,167 - INFO - ðŸ”Ž  Running validation at step 400
[rank1]:2025-10-28 09:07:00,166 - INFO -  step: 400  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 3,004  tflops: 22.88  mfu: 7.33%
[rank1]:2025-10-28 09:07:00,167 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-10-28 09:07:00,166 - INFO -  step: 400  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 3,004  tflops: 22.88  mfu: 7.33%
[rank0]:2025-10-28 09:07:00,167 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-10-28 09:08:09,906 - INFO - validate step: 400  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,873
[rank1]:2025-10-28 09:08:09,993 - INFO - validate step: 400  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,866
[rank2]:2025-10-28 09:08:10,073 - INFO - validate step: 400  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,859
[rank3]:2025-10-28 09:08:10,135 - INFO - validate step: 400  loss:  1.8030  memory: 38.93GiB(81.95%)  tps: 5,854
[rank0]:2025-10-28 09:08:10,213 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251028_0908_stage0_step400.svg
[rank2]:2025-10-28 09:08:10,215 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251028_0908_stage2_step400.svg
[rank1]:2025-10-28 09:08:10,213 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251028_0908_stage1_step400.svg
[rank3]:2025-10-28 09:08:10,323 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251028_0908_real_step400_rank3.svg
[rank3]:> Batch Time: 1297.60 ms, GPU Bubble Ratio: 72.02%, 44.93%, 63.44%, 13.66%
[rank3]:2025-10-28 09:08:10,394 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251028_0908_stage3_step400.svg
[rank3]:2025-10-28 09:08:11,615 - INFO - Avg. fwd time: 72.1205 / Avg. bwd time: 82.9785 / Avg. batch time: 1291.0967 (ms) / GPU bubble ratio: 3.90%
[rank2]:2025-10-28 09:08:11,648 - INFO - Avg. fwd time: 32.5888 / Avg. bwd time: 34.9784 / Avg. batch time: 1369.0173 (ms) / GPU bubble ratio: 60.52%
[rank1]:2025-10-28 09:08:11,688 - INFO - Avg. fwd time: 52.0579 / Avg. bwd time: 47.4874 / Avg. batch time: 1464.3477 (ms) / GPU bubble ratio: 45.62%
[rank0]:2025-10-28 09:08:11,692 - INFO - Avg. fwd time: 45.0979 / Avg. bwd time: 18.2992 / Avg. batch time: 1518.5044 (ms) / GPU bubble ratio: 66.60%
[rank2]:2025-10-28 09:09:04,630 - INFO -  step: 420  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 3,003  tflops: 22.87  mfu: 7.33%
[rank1]:2025-10-28 09:09:04,631 - INFO -  step: 420  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,999  tflops: 22.84  mfu: 7.32%
[rank3]:2025-10-28 09:09:04,631 - INFO -  step: 420  loss:  4.2915  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 3,007  tflops: 22.90  mfu: 7.34%
[rank0]:2025-10-28 09:09:04,632 - INFO -  step: 420  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,994  tflops: 22.80  mfu: 7.31%
[rank2]:2025-10-28 09:09:58,900 - INFO -  step: 440  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 3,019  tflops: 22.99  mfu: 7.37%
[rank1]:2025-10-28 09:09:58,901 - INFO -  step: 440  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 3,019  tflops: 22.99  mfu: 7.37%
[rank3]:2025-10-28 09:09:58,901 - INFO -  step: 440  loss:  2.4465  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 3,019  tflops: 22.99  mfu: 7.37%
[rank0]:2025-10-28 09:09:58,901 - INFO -  step: 440  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 3,019  tflops: 22.99  mfu: 7.37%
[rank3]:2025-10-28 09:10:00,222 - INFO - Avg. fwd time: 72.1662 / Avg. bwd time: 81.4850 / Avg. batch time: 1279.3366 (ms) / GPU bubble ratio: 3.92%
[rank2]:2025-10-28 09:10:00,254 - INFO - Avg. fwd time: 32.5947 / Avg. bwd time: 34.2453 / Avg. batch time: 1355.7937 (ms) / GPU bubble ratio: 60.56%
[rank1]:2025-10-28 09:10:00,296 - INFO - Avg. fwd time: 52.0894 / Avg. bwd time: 46.4582 / Avg. batch time: 1449.9473 (ms) / GPU bubble ratio: 45.63%
[rank0]:2025-10-28 09:10:00,300 - INFO - Avg. fwd time: 45.0761 / Avg. bwd time: 16.6377 / Avg. batch time: 1502.3800 (ms) / GPU bubble ratio: 67.14%
[rank0]:2025-10-28 09:10:23,355 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-28 09:10:53,104 - INFO -  step: 460  loss:  4.4159  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 3,023  tflops: 23.02  mfu: 7.38%
[rank0]:2025-10-28 09:10:53,104 - INFO -  step: 460  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 3,023  tflops: 23.02  mfu: 7.38%
[rank2]:2025-10-28 09:10:53,103 - INFO -  step: 460  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 3,023  tflops: 23.02  mfu: 7.38%
[rank1]:2025-10-28 09:10:53,104 - INFO -  step: 460  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 3,023  tflops: 23.02  mfu: 7.38%
[rank2]:2025-10-28 09:11:47,429 - INFO -  step: 480  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 3,016  tflops: 22.97  mfu: 7.36%
[rank1]:2025-10-28 09:11:47,430 - INFO -  step: 480  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 3,016  tflops: 22.97  mfu: 7.36%
[rank3]:2025-10-28 09:11:47,430 - INFO -  step: 480  loss:  2.4982  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 3,016  tflops: 22.97  mfu: 7.36%
[rank0]:2025-10-28 09:11:47,430 - INFO -  step: 480  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 3,016  tflops: 22.97  mfu: 7.36%
[rank3]:2025-10-28 09:11:48,752 - INFO - Avg. fwd time: 72.2062 / Avg. bwd time: 80.2283 / Avg. batch time: 1269.4202 (ms) / GPU bubble ratio: 3.93%
[rank0]:2025-10-28 09:11:48,828 - INFO - Avg. fwd time: 44.9981 / Avg. bwd time: 15.2528 / Avg. batch time: 1488.8388 (ms) / GPU bubble ratio: 67.63%
[rank2]:2025-10-28 09:11:48,784 - INFO - Avg. fwd time: 32.5987 / Avg. bwd time: 33.6309 / Avg. batch time: 1344.6495 (ms) / GPU bubble ratio: 60.60%
[rank1]:2025-10-28 09:11:48,824 - INFO - Avg. fwd time: 52.0873 / Avg. bwd time: 45.5884 / Avg. batch time: 1437.8535 (ms) / GPU bubble ratio: 45.65%
[rank0]:2025-10-28 09:12:38,907 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-28 09:12:41,570 - INFO -  step: 500  loss:  4.3983  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 3,026  tflops: 23.05  mfu: 7.39%
[rank3]:2025-10-28 09:12:41,571 - INFO - ðŸ”Ž  Running validation at step 500
[rank0]:2025-10-28 09:12:41,571 - INFO -  step: 500  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 3,026  tflops: 23.05  mfu: 7.39%
[rank0]:2025-10-28 09:12:41,571 - INFO - ðŸ”Ž  Running validation at step 500
[rank2]:2025-10-28 09:12:41,569 - INFO -  step: 500  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 3,026  tflops: 23.05  mfu: 7.39%
[rank2]:2025-10-28 09:12:41,569 - INFO - ðŸ”Ž  Running validation at step 500
[rank1]:2025-10-28 09:12:41,570 - INFO -  step: 500  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 3,026  tflops: 23.05  mfu: 7.39%
[rank1]:2025-10-28 09:12:41,571 - INFO - ðŸ”Ž  Running validation at step 500
[rank0]:2025-10-28 09:13:51,104 - INFO - validate step: 500  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,891
[rank1]:2025-10-28 09:13:51,189 - INFO - validate step: 500  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,883
[rank2]:2025-10-28 09:13:51,272 - INFO - validate step: 500  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,876
[rank3]:2025-10-28 09:13:51,336 - INFO - validate step: 500  loss:  1.8249  memory: 38.93GiB(81.95%)  tps: 5,871
[rank2]:2025-10-28 09:13:51,411 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251028_0913_stage2_step500.svg
[rank1]:2025-10-28 09:13:51,409 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251028_0913_stage1_step500.svg
[rank0]:2025-10-28 09:13:51,409 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251028_0913_stage0_step500.svg
[rank3]:2025-10-28 09:13:51,529 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251028_0913_real_step500_rank3.svg
[rank3]:> Batch Time: 1296.21 ms, GPU Bubble Ratio: 72.04%, 45.05%, 63.44%, 13.62%
[rank3]:2025-10-28 09:13:51,599 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251028_0913_stage3_step500.svg
[rank0]:2025-10-28 09:14:46,138 - INFO -  step: 520  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,977  tflops: 22.67  mfu: 7.27%
[rank2]:2025-10-28 09:14:46,137 - INFO -  step: 520  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,986  tflops: 22.74  mfu: 7.29%
[rank1]:2025-10-28 09:14:46,138 - INFO -  step: 520  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,982  tflops: 22.71  mfu: 7.28%
[rank3]:2025-10-28 09:14:46,138 - INFO -  step: 520  loss:  2.4347  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,990  tflops: 22.77  mfu: 7.30%
[rank2]:2025-10-28 09:14:47,490 - INFO - Avg. fwd time: 32.5934 / Avg. bwd time: 33.1178 / Avg. batch time: 1335.5803 (ms) / GPU bubble ratio: 60.64%
[rank3]:2025-10-28 09:14:47,458 - INFO - Avg. fwd time: 72.2453 / Avg. bwd time: 79.1857 / Avg. batch time: 1261.2884 (ms) / GPU bubble ratio: 3.95%
[rank0]:2025-10-28 09:14:47,535 - INFO - Avg. fwd time: 44.9743 / Avg. bwd time: 14.0808 / Avg. batch time: 1477.7211 (ms) / GPU bubble ratio: 68.03%
[rank1]:2025-10-28 09:14:47,531 - INFO - Avg. fwd time: 52.1344 / Avg. bwd time: 44.8656 / Avg. batch time: 1427.9464 (ms) / GPU bubble ratio: 45.66%
[rank3]:2025-10-28 09:15:40,582 - INFO -  step: 540  loss:  4.4147  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 3,009  tflops: 22.92  mfu: 7.35%
[rank0]:2025-10-28 09:15:40,583 - INFO -  step: 540  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 3,009  tflops: 22.92  mfu: 7.35%
[rank2]:2025-10-28 09:15:40,581 - INFO -  step: 540  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 3,009  tflops: 22.92  mfu: 7.35%
[rank1]:2025-10-28 09:15:40,583 - INFO -  step: 540  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 3,009  tflops: 22.92  mfu: 7.35%
[rank0]:2025-10-28 09:16:05,057 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-28 09:16:35,011 - INFO -  step: 560  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 3,010  tflops: 22.93  mfu: 7.35%
[rank2]:2025-10-28 09:16:35,009 - INFO -  step: 560  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 3,010  tflops: 22.93  mfu: 7.35%
[rank3]:2025-10-28 09:16:35,010 - INFO -  step: 560  loss:  2.4749  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 3,010  tflops: 22.93  mfu: 7.35%
[rank0]:2025-10-28 09:16:35,011 - INFO -  step: 560  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 3,010  tflops: 22.93  mfu: 7.35%
[rank3]:2025-10-28 09:16:36,325 - INFO - Avg. fwd time: 72.2742 / Avg. bwd time: 78.2975 / Avg. batch time: 1254.3674 (ms) / GPU bubble ratio: 3.97%
[rank1]:2025-10-28 09:16:36,398 - INFO - Avg. fwd time: 52.1859 / Avg. bwd time: 44.2438 / Avg. batch time: 1419.4421 (ms) / GPU bubble ratio: 45.65%
[rank2]:2025-10-28 09:16:36,358 - INFO - Avg. fwd time: 32.5912 / Avg. bwd time: 32.6767 / Avg. batch time: 1327.7669 (ms) / GPU bubble ratio: 60.68%
[rank0]:2025-10-28 09:16:36,402 - INFO - Avg. fwd time: 44.9608 / Avg. bwd time: 13.0761 / Avg. batch time: 1468.1823 (ms) / GPU bubble ratio: 68.38%
[rank1]:2025-10-28 09:17:29,004 - INFO -  step: 580  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 3,035  tflops: 23.11  mfu: 7.41%
[rank2]:2025-10-28 09:17:29,002 - INFO -  step: 580  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 3,035  tflops: 23.11  mfu: 7.41%
[rank3]:2025-10-28 09:17:29,003 - INFO -  step: 580  loss:  4.4430  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 3,035  tflops: 23.11  mfu: 7.41%
[rank0]:2025-10-28 09:17:29,003 - INFO -  step: 580  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 3,035  tflops: 23.11  mfu: 7.41%
[rank0]:2025-10-28 09:18:20,330 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-28 09:18:23,056 - INFO -  step: 600  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 3,031  tflops: 23.09  mfu: 7.40%
[rank2]:2025-10-28 09:18:23,056 - INFO - ðŸ”Ž  Running validation at step 600
[rank1]:2025-10-28 09:18:23,057 - INFO -  step: 600  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 3,031  tflops: 23.09  mfu: 7.40%
[rank1]:2025-10-28 09:18:23,058 - INFO - ðŸ”Ž  Running validation at step 600
[rank3]:2025-10-28 09:18:23,057 - INFO -  step: 600  loss:  2.5227  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 3,031  tflops: 23.09  mfu: 7.40%
[rank3]:2025-10-28 09:18:23,058 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-10-28 09:18:23,058 - INFO -  step: 600  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 3,031  tflops: 23.09  mfu: 7.40%
[rank0]:2025-10-28 09:18:23,058 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-10-28 09:19:32,374 - INFO - validate step: 600  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,909
[rank1]:2025-10-28 09:19:32,457 - INFO - validate step: 600  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,902
[rank2]:2025-10-28 09:19:32,542 - INFO - validate step: 600  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,895
[rank3]:2025-10-28 09:19:32,604 - INFO - validate step: 600  loss:  1.8163  memory: 38.93GiB(81.95%)  tps: 5,890
[rank0]:2025-10-28 09:19:32,682 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251028_0919_stage0_step600.svg
[rank1]:2025-10-28 09:19:32,682 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251028_0919_stage1_step600.svg
[rank2]:2025-10-28 09:19:32,681 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251028_0919_stage2_step600.svg
[rank3]:2025-10-28 09:19:32,792 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251028_0919_real_step600_rank3.svg
[rank3]:> Batch Time: 1295.78 ms, GPU Bubble Ratio: 72.06%, 45.06%, 63.45%, 13.61%
[rank3]:2025-10-28 09:19:32,862 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251028_0919_stage3_step600.svg
[rank3]:2025-10-28 09:19:34,051 - INFO - Avg. fwd time: 72.2371 / Avg. bwd time: 77.5061 / Avg. batch time: 1247.7208 (ms) / GPU bubble ratio: 3.99%
[rank0]:2025-10-28 09:19:34,128 - INFO - Avg. fwd time: 44.9403 / Avg. bwd time: 12.2052 / Avg. batch time: 1459.2746 (ms) / GPU bubble ratio: 68.67%
[rank1]:2025-10-28 09:19:34,123 - INFO - Avg. fwd time: 52.2216 / Avg. bwd time: 43.7142 / Avg. batch time: 1411.4457 (ms) / GPU bubble ratio: 45.62%
[rank2]:2025-10-28 09:19:34,083 - INFO - Avg. fwd time: 32.5948 / Avg. bwd time: 32.2914 / Avg. batch time: 1320.3992 (ms) / GPU bubble ratio: 60.69%
[rank3]:2025-10-28 09:20:27,150 - INFO -  step: 620  loss:  4.4238  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 3,004  tflops: 22.88  mfu: 7.33%
[rank0]:2025-10-28 09:20:27,150 - INFO -  step: 620  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,991  tflops: 22.78  mfu: 7.30%
[rank2]:2025-10-28 09:20:27,149 - INFO -  step: 620  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 3,000  tflops: 22.85  mfu: 7.32%
[rank1]:2025-10-28 09:20:27,150 - INFO -  step: 620  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,996  tflops: 22.82  mfu: 7.31%
[rank0]:2025-10-28 09:21:21,666 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251028_0921_rank0_trend_line.svg
[rank2]:2025-10-28 09:21:21,632 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251028_0921_rank2_trend_line.svg
[rank2]:2025-10-28 09:21:21,672 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-28 09:21:21,674 - INFO -  step: 640  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 3,005  tflops: 22.89  mfu: 7.34%
[rank1]:2025-10-28 09:21:21,662 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251028_0921_rank1_trend_line.svg
[rank1]:2025-10-28 09:21:21,672 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-10-28 09:21:21,674 - INFO -  step: 640  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 3,005  tflops: 22.89  mfu: 7.34%
[rank3]:2025-10-28 09:21:21,650 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251028_0921_rank3_trend_line.svg
[rank0]:2025-10-28 09:21:21,672 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-28 09:21:21,674 - INFO -  step: 640  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 3,005  tflops: 22.89  mfu: 7.34%
[rank3]:2025-10-28 09:21:21,883 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251028_0921_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 1282.73 ms, GPU Bubble Ratio: 70.00%, 44.61%, 62.43%, 13.74%
[rank3]:2025-10-28 09:21:21,884 - INFO - 	> Batch Time: 1282.73 ms (Average Freeze Ratio: 0.34)
[rank3]:2025-10-28 09:21:21,885 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-28 09:21:21,890 - INFO -  step: 640  loss:  2.4920  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,993  tflops: 22.80  mfu: 7.31%
[rank2]:2025-10-28 09:21:23,104 - INFO - Avg. fwd time: 32.5932 / Avg. bwd time: 31.9549 / Avg. batch time: 1314.4633 (ms) / GPU bubble ratio: 60.72%
[rank3]:2025-10-28 09:21:23,072 - INFO - Avg. fwd time: 72.2541 / Avg. bwd time: 76.8289 / Avg. batch time: 1242.3776 (ms) / GPU bubble ratio: 4.00%
[rank0]:2025-10-28 09:21:23,150 - INFO - Avg. fwd time: 44.9483 / Avg. bwd time: 11.4431 / Avg. batch time: 1452.0510 (ms) / GPU bubble ratio: 68.93%
[rank1]:2025-10-28 09:21:23,145 - INFO - Avg. fwd time: 52.2551 / Avg. bwd time: 43.2502 / Avg. batch time: 1405.0114 (ms) / GPU bubble ratio: 45.62%
[rank0]:2025-10-28 09:21:46,220 - INFO - [GC] Peforming periodical GC collection 0.02 seconds
[rank2]:2025-10-28 09:22:15,957 - INFO -  step: 660  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 3,018  tflops: 22.99  mfu: 7.37%
[rank1]:2025-10-28 09:22:15,958 - INFO -  step: 660  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 3,018  tflops: 22.99  mfu: 7.37%
[rank3]:2025-10-28 09:22:15,958 - INFO -  step: 660  loss:  4.4129  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 3,030  tflops: 23.08  mfu: 7.40%
[rank0]:2025-10-28 09:22:15,959 - INFO -  step: 660  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 3,018  tflops: 22.99  mfu: 7.37%
[rank3]:2025-10-28 09:23:10,362 - INFO -  step: 680  loss:  2.4743  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 3,012  tflops: 22.94  mfu: 7.35%
[rank0]:2025-10-28 09:23:10,362 - INFO -  step: 680  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 3,012  tflops: 22.94  mfu: 7.35%
[rank2]:2025-10-28 09:23:10,360 - INFO -  step: 680  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 3,012  tflops: 22.94  mfu: 7.35%
[rank1]:2025-10-28 09:23:10,362 - INFO -  step: 680  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 3,012  tflops: 22.94  mfu: 7.35%
[rank3]:2025-10-28 09:23:11,685 - INFO - Avg. fwd time: 72.2582 / Avg. bwd time: 76.2287 / Avg. batch time: 1237.5770 (ms) / GPU bubble ratio: 4.01%
[rank2]:2025-10-28 09:23:11,718 - INFO - Avg. fwd time: 32.5975 / Avg. bwd time: 31.6607 / Avg. batch time: 1309.0510 (ms) / GPU bubble ratio: 60.73%
[rank1]:2025-10-28 09:23:11,758 - INFO - Avg. fwd time: 52.2950 / Avg. bwd time: 42.8440 / Avg. batch time: 1399.1666 (ms) / GPU bubble ratio: 45.60%
[rank0]:2025-10-28 09:23:11,763 - INFO - Avg. fwd time: 44.9561 / Avg. bwd time: 10.7706 / Avg. batch time: 1445.5037 (ms) / GPU bubble ratio: 69.16%
[rank0]:2025-10-28 09:24:02,039 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-28 09:24:04,698 - INFO -  step: 700  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 3,015  tflops: 22.96  mfu: 7.36%
[rank2]:2025-10-28 09:24:04,699 - INFO - ðŸ”Ž  Running validation at step 700
[rank1]:2025-10-28 09:24:04,700 - INFO -  step: 700  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 3,015  tflops: 22.96  mfu: 7.36%
[rank1]:2025-10-28 09:24:04,700 - INFO - ðŸ”Ž  Running validation at step 700
[rank3]:2025-10-28 09:24:04,700 - INFO -  step: 700  loss:  4.4447  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 3,015  tflops: 22.97  mfu: 7.36%
[rank3]:2025-10-28 09:24:04,700 - INFO - ðŸ”Ž  Running validation at step 700
[rank0]:2025-10-28 09:24:04,700 - INFO -  step: 700  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 3,015  tflops: 22.96  mfu: 7.36%
[rank0]:2025-10-28 09:24:04,700 - INFO - ðŸ”Ž  Running validation at step 700
[rank0]:2025-10-28 09:25:14,873 - INFO - validate step: 700  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,837
[rank1]:2025-10-28 09:25:14,958 - INFO - validate step: 700  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,830
[rank2]:2025-10-28 09:25:15,040 - INFO - validate step: 700  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,823
[rank3]:2025-10-28 09:25:15,105 - INFO - validate step: 700  loss:  1.8021  memory: 38.93GiB(81.95%)  tps: 5,818
[rank2]:2025-10-28 09:25:15,186 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251028_0925_stage2_step700.svg
[rank1]:2025-10-28 09:25:15,185 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251028_0925_stage1_step700.svg
[rank0]:2025-10-28 09:25:15,185 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251028_0925_stage0_step700.svg
[rank3]:2025-10-28 09:25:15,294 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251028_0925_real_step700_rank3.svg
[rank3]:> Batch Time: 1295.55 ms, GPU Bubble Ratio: 72.06%, 45.05%, 63.45%, 13.61%
[rank3]:2025-10-28 09:25:15,366 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251028_0925_stage3_step700.svg
[rank0]:2025-10-28 09:26:09,632 - INFO -  step: 720  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,992  tflops: 22.79  mfu: 7.30%
[rank2]:2025-10-28 09:26:09,631 - INFO -  step: 720  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 3,001  tflops: 22.86  mfu: 7.33%
[rank1]:2025-10-28 09:26:09,632 - INFO -  step: 720  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,997  tflops: 22.82  mfu: 7.32%
[rank3]:2025-10-28 09:26:09,632 - INFO -  step: 720  loss:  2.4858  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 3,005  tflops: 22.89  mfu: 7.34%
[rank3]:2025-10-28 09:26:10,954 - INFO - Avg. fwd time: 72.2828 / Avg. bwd time: 75.6940 / Avg. batch time: 1233.4425 (ms) / GPU bubble ratio: 4.02%
[rank0]:2025-10-28 09:26:11,032 - INFO - Avg. fwd time: 44.9524 / Avg. bwd time: 10.1727 / Avg. batch time: 1439.8320 (ms) / GPU bubble ratio: 69.37%
[rank2]:2025-10-28 09:26:10,987 - INFO - Avg. fwd time: 32.6043 / Avg. bwd time: 31.3999 / Avg. batch time: 1304.4497 (ms) / GPU bubble ratio: 60.75%
[rank1]:2025-10-28 09:26:11,027 - INFO - Avg. fwd time: 52.3123 / Avg. bwd time: 42.4767 / Avg. batch time: 1394.1166 (ms) / GPU bubble ratio: 45.61%
[rank0]:2025-10-28 09:27:03,693 - INFO -  step: 740  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 3,031  tflops: 23.08  mfu: 7.40%
[rank2]:2025-10-28 09:27:03,692 - INFO -  step: 740  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 3,031  tflops: 23.08  mfu: 7.40%
[rank1]:2025-10-28 09:27:03,693 - INFO -  step: 740  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 3,031  tflops: 23.08  mfu: 7.40%
[rank3]:2025-10-28 09:27:03,693 - INFO -  step: 740  loss:  4.3224  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 3,031  tflops: 23.08  mfu: 7.40%
[rank0]:2025-10-28 09:27:28,144 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-28 09:27:58,111 - INFO -  step: 760  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 3,011  tflops: 22.93  mfu: 7.35%
[rank3]:2025-10-28 09:27:58,110 - INFO -  step: 760  loss:  2.4808  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 3,011  tflops: 22.93  mfu: 7.35%
[rank0]:2025-10-28 09:27:58,111 - INFO -  step: 760  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 3,011  tflops: 22.93  mfu: 7.35%
[rank2]:2025-10-28 09:27:58,109 - INFO -  step: 760  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 3,011  tflops: 22.93  mfu: 7.35%
[rank3]:2025-10-28 09:27:59,439 - INFO - Avg. fwd time: 72.2862 / Avg. bwd time: 75.2133 / Avg. batch time: 1229.5870 (ms) / GPU bubble ratio: 4.03%
[rank2]:2025-10-28 09:27:59,471 - INFO - Avg. fwd time: 32.6090 / Avg. bwd time: 31.1650 / Avg. batch time: 1300.1164 (ms) / GPU bubble ratio: 60.76%
[rank1]:2025-10-28 09:27:59,511 - INFO - Avg. fwd time: 52.3130 / Avg. bwd time: 42.1495 / Avg. batch time: 1389.4053 (ms) / GPU bubble ratio: 45.61%
[rank0]:2025-10-28 09:27:59,516 - INFO - Avg. fwd time: 44.9639 / Avg. bwd time: 9.6378 / Avg. batch time: 1434.5599 (ms) / GPU bubble ratio: 69.55%
[rank1]:2025-10-28 09:28:52,388 - INFO -  step: 780  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 3,019  tflops: 22.99  mfu: 7.37%
[rank3]:2025-10-28 09:28:52,387 - INFO -  step: 780  loss:  4.3672  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 3,019  tflops: 22.99  mfu: 7.37%
[rank0]:2025-10-28 09:28:52,388 - INFO -  step: 780  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 3,019  tflops: 22.99  mfu: 7.37%
[rank2]:2025-10-28 09:28:52,386 - INFO -  step: 780  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 3,019  tflops: 22.99  mfu: 7.37%
[rank0]:2025-10-28 09:29:44,057 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-28 09:29:46,833 - INFO -  step: 800  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 3,009  tflops: 22.92  mfu: 7.35%
[rank2]:2025-10-28 09:29:46,834 - INFO - ðŸ”Ž  Running validation at step 800
[rank1]:2025-10-28 09:29:46,835 - INFO -  step: 800  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 3,009  tflops: 22.92  mfu: 7.35%
[rank1]:2025-10-28 09:29:46,835 - INFO - ðŸ”Ž  Running validation at step 800
[rank3]:2025-10-28 09:29:46,835 - INFO -  step: 800  loss:  2.5015  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 3,009  tflops: 22.92  mfu: 7.35%
[rank3]:2025-10-28 09:29:46,835 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-10-28 09:29:46,835 - INFO -  step: 800  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 3,009  tflops: 22.92  mfu: 7.35%
[rank0]:2025-10-28 09:29:46,835 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-10-28 09:30:56,128 - INFO - validate step: 800  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,911
[rank0]:2025-10-28 09:30:56,129 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-28 09:30:56,136 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank1]:2025-10-28 09:30:56,213 - INFO - validate step: 800  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,904
[rank1]:2025-10-28 09:30:56,214 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-28 09:30:56,292 - INFO - validate step: 800  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,897
[rank2]:2025-10-28 09:30:56,293 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-28 09:30:56,354 - INFO - validate step: 800  loss:  1.8227  memory: 38.93GiB(81.95%)  tps: 5,892
[rank3]:2025-10-28 09:30:56,355 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-28 09:30:58,513 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 2.22 seconds.
[rank1]:2025-10-28 09:30:58,553 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 2.34 seconds.
[rank0]:2025-10-28 09:30:59,869 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-28 09:30:59,876 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.75 seconds.
[rank3]:2025-10-28 09:31:00,884 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 4.53 seconds.
[rank0]:2025-10-28 09:31:00,981 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251028_0930_stage0_step800.svg
[rank2]:2025-10-28 09:31:00,983 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251028_0930_stage2_step800.svg
[rank1]:2025-10-28 09:31:00,982 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251028_0930_stage1_step800.svg
[rank3]:2025-10-28 09:31:01,281 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251028_0931_real_step800_rank3.svg
[rank3]:> Batch Time: 1295.30 ms, GPU Bubble Ratio: 72.06%, 45.07%, 63.45%, 13.61%
[rank3]:2025-10-28 09:31:01,361 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251028_0931_stage3_step800.svg
[rank3]:2025-10-28 09:31:02,720 - INFO - Avg. fwd time: 72.3128 / Avg. bwd time: 74.7969 / Avg. batch time: 1226.3551 (ms) / GPU bubble ratio: 4.03%
[rank0]:2025-10-28 09:31:02,799 - INFO - Avg. fwd time: 44.9548 / Avg. bwd time: 9.1563 / Avg. batch time: 1430.1910 (ms) / GPU bubble ratio: 69.73%
[rank2]:2025-10-28 09:31:02,753 - INFO - Avg. fwd time: 32.6116 / Avg. bwd time: 30.9525 / Avg. batch time: 1296.5816 (ms) / GPU bubble ratio: 60.78%
[rank1]:2025-10-28 09:31:02,793 - INFO - Avg. fwd time: 52.3036 / Avg. bwd time: 41.8474 / Avg. batch time: 1385.5247 (ms) / GPU bubble ratio: 45.64%
[rank3]:2025-10-28 09:31:29,758 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-28 09:31:29,834 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-28 09:31:29,790 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-28 09:31:29,832 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-28 09:32:00,601 - INFO -  step: 820  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,548  tflops: 19.40  mfu: 6.22%
[rank1]:2025-10-28 09:32:00,603 - INFO -  step: 820  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,545  tflops: 19.38  mfu: 6.21%
[rank3]:2025-10-28 09:32:00,602 - INFO -  step: 820  loss:  4.4086  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,550  tflops: 19.42  mfu: 6.23%
[rank0]:2025-10-28 09:32:00,621 - INFO -  step: 820  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,540  tflops: 19.35  mfu: 6.20%
[rank3]:2025-10-28 09:32:54,614 - INFO -  step: 840  loss:  2.4788  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 3,034  tflops: 23.10  mfu: 7.41%
[rank1]:2025-10-28 09:32:54,614 - INFO -  step: 840  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 3,033  tflops: 23.10  mfu: 7.40%
[rank0]:2025-10-28 09:32:54,614 - INFO -  step: 840  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 3,034  tflops: 23.11  mfu: 7.41%
[rank2]:2025-10-28 09:32:54,613 - INFO -  step: 840  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 3,033  tflops: 23.10  mfu: 7.40%
[rank3]:2025-10-28 09:32:55,921 - INFO - Avg. fwd time: 72.2961 / Avg. bwd time: 74.3842 / Avg. batch time: 1222.8655 (ms) / GPU bubble ratio: 4.04%
[rank2]:2025-10-28 09:32:55,955 - INFO - Avg. fwd time: 32.6081 / Avg. bwd time: 30.7607 / Avg. batch time: 1292.6936 (ms) / GPU bubble ratio: 60.78%
[rank1]:2025-10-28 09:32:55,995 - INFO - Avg. fwd time: 52.2648 / Avg. bwd time: 41.5739 / Avg. batch time: 1381.3005 (ms) / GPU bubble ratio: 45.65%
[rank0]:2025-10-28 09:32:56,000 - INFO - Avg. fwd time: 44.9606 / Avg. bwd time: 8.7206 / Avg. batch time: 1425.5164 (ms) / GPU bubble ratio: 69.87%
[rank0]:2025-10-28 09:33:19,341 - INFO - [GC] Peforming periodical GC collection 0.35 seconds
[rank3]:2025-10-28 09:33:48,862 - INFO -  step: 860  loss:  4.4056  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 3,020  tflops: 23.00  mfu: 7.37%
[rank1]:2025-10-28 09:33:48,862 - INFO -  step: 860  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 3,020  tflops: 23.00  mfu: 7.37%
[rank0]:2025-10-28 09:33:48,863 - INFO -  step: 860  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 3,020  tflops: 23.00  mfu: 7.37%
[rank2]:2025-10-28 09:33:48,861 - INFO -  step: 860  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 3,020  tflops: 23.00  mfu: 7.37%
[rank1]:2025-10-28 09:34:42,963 - INFO -  step: 880  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 3,028  tflops: 23.07  mfu: 7.39%
[rank0]:2025-10-28 09:34:42,963 - INFO -  step: 880  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 3,028  tflops: 23.07  mfu: 7.39%
[rank2]:2025-10-28 09:34:42,962 - INFO -  step: 880  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 3,028  tflops: 23.07  mfu: 7.39%
[rank3]:2025-10-28 09:34:42,963 - INFO -  step: 880  loss:  2.4343  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 3,029  tflops: 23.07  mfu: 7.39%
[rank2]:2025-10-28 09:34:44,297 - INFO - Avg. fwd time: 32.6078 / Avg. bwd time: 30.5836 / Avg. batch time: 1289.2349 (ms) / GPU bubble ratio: 60.79%
[rank3]:2025-10-28 09:34:44,263 - INFO - Avg. fwd time: 72.2869 / Avg. bwd time: 74.0135 / Avg. batch time: 1219.7835 (ms) / GPU bubble ratio: 4.05%
[rank1]:2025-10-28 09:34:44,339 - INFO - Avg. fwd time: 52.2524 / Avg. bwd time: 41.3209 / Avg. batch time: 1377.5387 (ms) / GPU bubble ratio: 45.66%
[rank0]:2025-10-28 09:34:44,344 - INFO - Avg. fwd time: 44.9575 / Avg. bwd time: 8.3246 / Avg. batch time: 1421.3362 (ms) / GPU bubble ratio: 70.01%
[rank0]:2025-10-28 09:35:34,241 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-28 09:35:36,937 - INFO -  step: 900  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 3,036  tflops: 23.12  mfu: 7.41%
[rank1]:2025-10-28 09:35:36,937 - INFO - ðŸ”Ž  Running validation at step 900
[rank0]:2025-10-28 09:35:36,937 - INFO -  step: 900  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 3,036  tflops: 23.12  mfu: 7.41%
[rank0]:2025-10-28 09:35:36,937 - INFO - ðŸ”Ž  Running validation at step 900
[rank2]:2025-10-28 09:35:36,936 - INFO -  step: 900  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 3,036  tflops: 23.12  mfu: 7.41%
[rank2]:2025-10-28 09:35:36,936 - INFO - ðŸ”Ž  Running validation at step 900
[rank3]:2025-10-28 09:35:36,937 - INFO -  step: 900  loss:  4.3395  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 3,036  tflops: 23.12  mfu: 7.41%
[rank3]:2025-10-28 09:35:36,937 - INFO - ðŸ”Ž  Running validation at step 900
[rank0]:2025-10-28 09:36:46,297 - INFO - validate step: 900  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,906
[rank1]:2025-10-28 09:36:46,380 - INFO - validate step: 900  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,898
[rank2]:2025-10-28 09:36:46,462 - INFO - validate step: 900  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,891
[rank3]:2025-10-28 09:36:46,526 - INFO - validate step: 900  loss:  1.8157  memory: 38.93GiB(81.95%)  tps: 5,886
[rank1]:2025-10-28 09:36:46,601 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251028_0936_stage1_step900.svg
[rank0]:2025-10-28 09:36:46,601 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251028_0936_stage0_step900.svg
[rank2]:2025-10-28 09:36:46,602 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251028_0936_stage2_step900.svg
[rank3]:2025-10-28 09:36:46,715 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251028_0936_real_step900_rank3.svg
[rank3]:> Batch Time: 1294.00 ms, GPU Bubble Ratio: 72.05%, 45.09%, 63.43%, 13.60%
[rank3]:2025-10-28 09:36:46,780 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251028_0936_stage3_step900.svg
[rank1]:2025-10-28 09:37:41,301 - INFO -  step: 920  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,983  tflops: 22.72  mfu: 7.28%
[rank0]:2025-10-28 09:37:41,301 - INFO -  step: 920  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,979  tflops: 22.69  mfu: 7.27%
[rank2]:2025-10-28 09:37:41,299 - INFO -  step: 920  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,988  tflops: 22.76  mfu: 7.29%
[rank3]:2025-10-28 09:37:41,300 - INFO -  step: 920  loss:  2.4415  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,991  tflops: 22.78  mfu: 7.30%
[rank3]:2025-10-28 09:37:42,624 - INFO - Avg. fwd time: 72.2989 / Avg. bwd time: 73.6940 / Avg. batch time: 1217.2625 (ms) / GPU bubble ratio: 4.05%
[rank1]:2025-10-28 09:37:42,699 - INFO - Avg. fwd time: 52.2342 / Avg. bwd time: 41.0963 / Avg. batch time: 1374.4714 (ms) / GPU bubble ratio: 45.68%
[rank0]:2025-10-28 09:37:42,705 - INFO - Avg. fwd time: 44.9511 / Avg. bwd time: 7.9629 / Avg. batch time: 1417.8886 (ms) / GPU bubble ratio: 70.14%
[rank2]:2025-10-28 09:37:42,657 - INFO - Avg. fwd time: 32.6086 / Avg. bwd time: 30.4236 / Avg. batch time: 1286.4243 (ms) / GPU bubble ratio: 60.80%
[rank0]:2025-10-28 09:38:35,687 - INFO -  step: 940  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 3,013  tflops: 22.94  mfu: 7.35%
[rank2]:2025-10-28 09:38:35,685 - INFO -  step: 940  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 3,013  tflops: 22.94  mfu: 7.35%
[rank3]:2025-10-28 09:38:35,687 - INFO -  step: 940  loss:  4.3164  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 3,013  tflops: 22.94  mfu: 7.35%
[rank1]:2025-10-28 09:38:35,687 - INFO -  step: 940  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 3,013  tflops: 22.94  mfu: 7.35%
[rank0]:2025-10-28 09:39:00,051 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-28 09:39:30,040 - INFO -  step: 960  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 3,014  tflops: 22.96  mfu: 7.36%
[rank0]:2025-10-28 09:39:30,040 - INFO -  step: 960  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 3,014  tflops: 22.96  mfu: 7.36%
[rank2]:2025-10-28 09:39:30,038 - INFO -  step: 960  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 3,014  tflops: 22.96  mfu: 7.36%
[rank3]:2025-10-28 09:39:30,039 - INFO -  step: 960  loss:  2.4511  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 3,015  tflops: 22.96  mfu: 7.36%
[rank3]:2025-10-28 09:39:31,375 - INFO - Avg. fwd time: 72.3098 / Avg. bwd time: 73.4077 / Avg. batch time: 1215.0257 (ms) / GPU bubble ratio: 4.06%
[rank1]:2025-10-28 09:39:31,450 - INFO - Avg. fwd time: 52.2437 / Avg. bwd time: 40.8842 / Avg. batch time: 1371.6821 (ms) / GPU bubble ratio: 45.69%
[rank0]:2025-10-28 09:39:31,456 - INFO - Avg. fwd time: 44.9432 / Avg. bwd time: 7.6314 / Avg. batch time: 1414.7533 (ms) / GPU bubble ratio: 70.27%
[rank2]:2025-10-28 09:39:31,408 - INFO - Avg. fwd time: 32.6068 / Avg. bwd time: 30.2760 / Avg. batch time: 1283.8828 (ms) / GPU bubble ratio: 60.82%
[rank0]:2025-10-28 09:40:24,331 - INFO -  step: 980  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 3,018  tflops: 22.98  mfu: 7.37%
[rank2]:2025-10-28 09:40:24,329 - INFO -  step: 980  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 3,018  tflops: 22.98  mfu: 7.37%
[rank3]:2025-10-28 09:40:24,330 - INFO -  step: 980  loss:  4.3711  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 3,018  tflops: 22.99  mfu: 7.37%
[rank1]:2025-10-28 09:40:24,330 - INFO -  step: 980  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 3,018  tflops: 22.98  mfu: 7.37%
[rank0]:2025-10-28 09:41:15,989 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-28 09:41:18,742 - INFO -  step: 1000  loss:  2.4542  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 3,011  tflops: 22.93  mfu: 7.35%
[rank3]:2025-10-28 09:41:18,743 - INFO - ðŸ”Ž  Running validation at step 1000
[rank1]:2025-10-28 09:41:18,743 - INFO -  step: 1000  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 3,011  tflops: 22.93  mfu: 7.35%
[rank1]:2025-10-28 09:41:18,743 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-10-28 09:41:18,743 - INFO -  step: 1000  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 3,011  tflops: 22.93  mfu: 7.35%
[rank0]:2025-10-28 09:41:18,743 - INFO - ðŸ”Ž  Running validation at step 1000
[rank2]:2025-10-28 09:41:18,741 - INFO -  step: 1000  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 3,011  tflops: 22.93  mfu: 7.35%
[rank2]:2025-10-28 09:41:18,741 - INFO - ðŸ”Ž  Running validation at step 1000
[rank1]:2025-10-28 09:42:28,690 - INFO - validate step: 1000  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,856
[rank0]:2025-10-28 09:42:28,605 - INFO - validate step: 1000  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,863
[rank2]:2025-10-28 09:42:28,772 - INFO - validate step: 1000  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,849
[rank3]:2025-10-28 09:42:28,837 - INFO - validate step: 1000  loss:  1.8012  memory: 38.93GiB(81.95%)  tps: 5,844
[rank2]:2025-10-28 09:42:28,916 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251028_0942_stage2_step1000.svg
[rank1]:2025-10-28 09:42:28,916 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251028_0942_stage1_step1000.svg
[rank0]:2025-10-28 09:42:28,915 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251028_0942_stage0_step1000.svg
[rank3]:2025-10-28 09:42:29,032 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251028_0942_real_step1000_rank3.svg
[rank3]:> Batch Time: 1294.17 ms, GPU Bubble Ratio: 72.06%, 45.14%, 63.43%, 13.58%
[rank3]:2025-10-28 09:42:29,101 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251028_0942_stage3_step1000.svg
[rank3]:2025-10-28 09:42:30,320 - INFO - Avg. fwd time: 72.3266 / Avg. bwd time: 73.1365 / Avg. batch time: 1212.9250 (ms) / GPU bubble ratio: 4.06%
[rank0]:2025-10-28 09:42:30,401 - INFO - Avg. fwd time: 44.9340 / Avg. bwd time: 7.3264 / Avg. batch time: 1411.8709 (ms) / GPU bubble ratio: 70.39%
[rank2]:2025-10-28 09:42:30,353 - INFO - Avg. fwd time: 32.6024 / Avg. bwd time: 30.1423 / Avg. batch time: 1281.5461 (ms) / GPU bubble ratio: 60.83%
[rank1]:2025-10-28 09:42:30,395 - INFO - Avg. fwd time: 52.2407 / Avg. bwd time: 40.6886 / Avg. batch time: 1369.1192 (ms) / GPU bubble ratio: 45.70%
[rank3]:2025-10-28 09:43:23,407 - INFO -  step: 1020  loss:  4.4273  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 3,002  tflops: 22.87  mfu: 7.33%
[rank1]:2025-10-28 09:43:23,408 - INFO -  step: 1020  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,994  tflops: 22.81  mfu: 7.31%
[rank0]:2025-10-28 09:43:23,408 - INFO -  step: 1020  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,990  tflops: 22.77  mfu: 7.30%
[rank2]:2025-10-28 09:43:23,406 - INFO -  step: 1020  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,999  tflops: 22.84  mfu: 7.32%
[rank2]:2025-10-28 09:44:17,841 - INFO -  step: 1040  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 3,010  tflops: 22.92  mfu: 7.35%
[rank3]:2025-10-28 09:44:17,842 - INFO -  step: 1040  loss:  2.5079  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 3,010  tflops: 22.92  mfu: 7.35%
[rank0]:2025-10-28 09:44:17,842 - INFO -  step: 1040  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 3,010  tflops: 22.92  mfu: 7.35%
[rank1]:2025-10-28 09:44:17,842 - INFO -  step: 1040  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 3,010  tflops: 22.92  mfu: 7.35%
[rank3]:2025-10-28 09:44:19,144 - INFO - Avg. fwd time: 72.3487 / Avg. bwd time: 72.8907 / Avg. batch time: 1211.0760 (ms) / GPU bubble ratio: 4.06%
[rank0]:2025-10-28 09:44:19,223 - INFO - Avg. fwd time: 44.9356 / Avg. bwd time: 7.0448 / Avg. batch time: 1409.2597 (ms) / GPU bubble ratio: 70.49%
[rank1]:2025-10-28 09:44:19,217 - INFO - Avg. fwd time: 52.2447 / Avg. bwd time: 40.5095 / Avg. batch time: 1366.8015 (ms) / GPU bubble ratio: 45.71%
[rank2]:2025-10-28 09:44:19,177 - INFO - Avg. fwd time: 32.6048 / Avg. bwd time: 30.0183 / Avg. batch time: 1279.4339 (ms) / GPU bubble ratio: 60.84%
[rank0]:2025-10-28 09:44:42,408 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-28 09:45:12,207 - INFO -  step: 1060  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 3,014  tflops: 22.95  mfu: 7.36%
[rank2]:2025-10-28 09:45:12,206 - INFO -  step: 1060  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 3,014  tflops: 22.95  mfu: 7.36%
[rank3]:2025-10-28 09:45:12,207 - INFO -  step: 1060  loss:  4.3713  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 3,014  tflops: 22.95  mfu: 7.36%
[rank0]:2025-10-28 09:45:12,208 - INFO -  step: 1060  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 3,014  tflops: 22.95  mfu: 7.36%
[rank0]:2025-10-28 09:46:06,629 - INFO -  step: 1080  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 3,011  tflops: 22.93  mfu: 7.35%
[rank1]:2025-10-28 09:46:06,628 - INFO -  step: 1080  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 3,011  tflops: 22.93  mfu: 7.35%
[rank2]:2025-10-28 09:46:06,627 - INFO -  step: 1080  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 3,011  tflops: 22.93  mfu: 7.35%
[rank3]:2025-10-28 09:46:06,628 - INFO -  step: 1080  loss:  2.4575  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 3,011  tflops: 22.93  mfu: 7.35%
[rank2]:2025-10-28 09:46:07,981 - INFO - Avg. fwd time: 32.6111 / Avg. bwd time: 29.9046 / Avg. batch time: 1277.4392 (ms) / GPU bubble ratio: 60.85%
[rank3]:2025-10-28 09:46:07,947 - INFO - Avg. fwd time: 72.3626 / Avg. bwd time: 72.6609 / Avg. batch time: 1209.3247 (ms) / GPU bubble ratio: 4.06%
[rank0]:2025-10-28 09:46:08,029 - INFO - Avg. fwd time: 44.9331 / Avg. bwd time: 6.7841 / Avg. batch time: 1406.8157 (ms) / GPU bubble ratio: 70.59%
[rank1]:2025-10-28 09:46:08,023 - INFO - Avg. fwd time: 52.2693 / Avg. bwd time: 40.3443 / Avg. batch time: 1364.6306 (ms) / GPU bubble ratio: 45.71%
[rank0]:2025-10-28 09:46:58,251 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-28 09:47:00,960 - INFO -  step: 1100  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 3,016  tflops: 22.97  mfu: 7.36%
[rank2]:2025-10-28 09:47:00,960 - INFO - ðŸ”Ž  Running validation at step 1100
[rank3]:2025-10-28 09:47:00,961 - INFO -  step: 1100  loss:  4.2434  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 3,016  tflops: 22.97  mfu: 7.36%
[rank3]:2025-10-28 09:47:00,961 - INFO - ðŸ”Ž  Running validation at step 1100
[rank0]:2025-10-28 09:47:00,962 - INFO -  step: 1100  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 3,016  tflops: 22.97  mfu: 7.36%
[rank0]:2025-10-28 09:47:00,962 - INFO - ðŸ”Ž  Running validation at step 1100
[rank1]:2025-10-28 09:47:00,961 - INFO -  step: 1100  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 3,016  tflops: 22.97  mfu: 7.36%
[rank1]:2025-10-28 09:47:00,962 - INFO - ðŸ”Ž  Running validation at step 1100
[rank0]:2025-10-28 09:48:10,133 - INFO - validate step: 1100  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,922
[rank1]:2025-10-28 09:48:10,215 - INFO - validate step: 1100  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,915
[rank2]:2025-10-28 09:48:10,295 - INFO - validate step: 1100  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,908
[rank3]:2025-10-28 09:48:10,357 - INFO - validate step: 1100  loss:  1.8181  memory: 38.93GiB(81.95%)  tps: 5,903
[rank0]:2025-10-28 09:48:10,436 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251028_0948_stage0_step1100.svg
[rank1]:2025-10-28 09:48:10,437 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251028_0948_stage1_step1100.svg
[rank2]:2025-10-28 09:48:10,438 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251028_0948_stage2_step1100.svg
[rank3]:2025-10-28 09:48:10,556 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251028_0948_real_step1100_rank3.svg
[rank3]:> Batch Time: 1294.41 ms, GPU Bubble Ratio: 72.07%, 45.17%, 63.44%, 13.57%
[rank3]:2025-10-28 09:48:10,626 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251028_0948_stage3_step1100.svg
[rank2]:2025-10-28 09:49:04,625 - INFO -  step: 1120  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 3,016  tflops: 22.97  mfu: 7.36%
[rank3]:2025-10-28 09:49:04,627 - INFO -  step: 1120  loss:  2.4673  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 3,019  tflops: 22.99  mfu: 7.37%
[rank1]:2025-10-28 09:49:04,627 - INFO -  step: 1120  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 3,011  tflops: 22.93  mfu: 7.35%
[rank0]:2025-10-28 09:49:04,627 - INFO -  step: 1120  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 3,007  tflops: 22.90  mfu: 7.34%
[rank3]:2025-10-28 09:49:05,942 - INFO - Avg. fwd time: 72.3628 / Avg. bwd time: 72.4412 / Avg. batch time: 1207.5129 (ms) / GPU bubble ratio: 4.06%
[rank2]:2025-10-28 09:49:05,976 - INFO - Avg. fwd time: 32.6113 / Avg. bwd time: 29.7973 / Avg. batch time: 1275.4430 (ms) / GPU bubble ratio: 60.86%
[rank1]:2025-10-28 09:49:06,018 - INFO - Avg. fwd time: 52.2620 / Avg. bwd time: 40.1979 / Avg. batch time: 1362.4772 (ms) / GPU bubble ratio: 45.71%
[rank0]:2025-10-28 09:49:06,024 - INFO - Avg. fwd time: 44.9291 / Avg. bwd time: 6.5420 / Avg. batch time: 1404.4118 (ms) / GPU bubble ratio: 70.68%
[rank1]:2025-10-28 09:49:58,538 - INFO -  step: 1140  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 3,039  tflops: 23.15  mfu: 7.42%
[rank0]:2025-10-28 09:49:58,538 - INFO -  step: 1140  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 3,039  tflops: 23.15  mfu: 7.42%
[rank2]:2025-10-28 09:49:58,536 - INFO -  step: 1140  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 3,039  tflops: 23.15  mfu: 7.42%
[rank3]:2025-10-28 09:49:58,538 - INFO -  step: 1140  loss:  4.4195  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 3,039  tflops: 23.15  mfu: 7.42%
[rank0]:2025-10-28 09:50:22,866 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-28 09:50:52,686 - INFO -  step: 1160  loss:  2.4603  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 3,026  tflops: 23.05  mfu: 7.39%
[rank1]:2025-10-28 09:50:52,687 - INFO -  step: 1160  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 3,026  tflops: 23.04  mfu: 7.39%
[rank0]:2025-10-28 09:50:52,687 - INFO -  step: 1160  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 3,026  tflops: 23.04  mfu: 7.39%
[rank2]:2025-10-28 09:50:52,685 - INFO -  step: 1160  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 3,026  tflops: 23.04  mfu: 7.39%
[rank2]:2025-10-28 09:50:54,040 - INFO - Avg. fwd time: 32.6123 / Avg. bwd time: 29.6970 / Avg. batch time: 1273.4223 (ms) / GPU bubble ratio: 60.86%
[rank3]:2025-10-28 09:50:54,006 - INFO - Avg. fwd time: 72.3437 / Avg. bwd time: 72.2323 / Avg. batch time: 1205.7015 (ms) / GPU bubble ratio: 4.07%
[rank1]:2025-10-28 09:50:54,081 - INFO - Avg. fwd time: 52.2621 / Avg. bwd time: 40.0537 / Avg. batch time: 1360.2931 (ms) / GPU bubble ratio: 45.71%
[rank0]:2025-10-28 09:50:54,088 - INFO - Avg. fwd time: 44.9232 / Avg. bwd time: 6.3165 / Avg. batch time: 1401.9897 (ms) / GPU bubble ratio: 70.76%
[rank2]:2025-10-28 09:51:46,931 - INFO -  step: 1180  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 3,020  tflops: 23.00  mfu: 7.37%
[rank3]:2025-10-28 09:51:46,933 - INFO -  step: 1180  loss:  4.4052  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 3,020  tflops: 23.00  mfu: 7.37%
[rank1]:2025-10-28 09:51:46,933 - INFO -  step: 1180  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 3,020  tflops: 23.00  mfu: 7.37%
[rank0]:2025-10-28 09:51:46,933 - INFO -  step: 1180  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 3,020  tflops: 23.00  mfu: 7.37%
[rank0]:2025-10-28 09:52:38,598 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-28 09:52:41,359 - INFO -  step: 1200  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 3,010  tflops: 22.93  mfu: 7.35%
[rank1]:2025-10-28 09:52:41,359 - INFO - ðŸ”Ž  Running validation at step 1200
[rank0]:2025-10-28 09:52:41,360 - INFO -  step: 1200  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 3,010  tflops: 22.93  mfu: 7.35%
[rank0]:2025-10-28 09:52:41,360 - INFO - ðŸ”Ž  Running validation at step 1200
[rank2]:2025-10-28 09:52:41,358 - INFO -  step: 1200  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 3,010  tflops: 22.93  mfu: 7.35%
[rank2]:2025-10-28 09:52:41,358 - INFO - ðŸ”Ž  Running validation at step 1200
[rank3]:2025-10-28 09:52:41,377 - INFO -  step: 1200  loss:  2.4936  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 3,010  tflops: 22.93  mfu: 7.35%
[rank3]:2025-10-28 09:52:41,378 - INFO - ðŸ”Ž  Running validation at step 1200
[rank0]:2025-10-28 09:53:51,216 - INFO - validate step: 1200  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,864
[rank1]:2025-10-28 09:53:51,299 - INFO - validate step: 1200  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,857
[rank2]:2025-10-28 09:53:51,380 - INFO - validate step: 1200  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,850
[rank3]:2025-10-28 09:53:51,443 - INFO - validate step: 1200  loss:  1.8183  memory: 38.93GiB(81.95%)  tps: 5,846
[rank1]:2025-10-28 09:53:51,522 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251028_0953_stage1_step1200.svg
[rank0]:2025-10-28 09:53:51,522 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251028_0953_stage0_step1200.svg
[rank2]:2025-10-28 09:53:51,525 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251028_0953_stage2_step1200.svg
[rank3]:2025-10-28 09:53:51,637 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251028_0953_real_step1200_rank3.svg
[rank3]:> Batch Time: 1293.92 ms, GPU Bubble Ratio: 72.07%, 45.19%, 63.43%, 13.57%
[rank3]:2025-10-28 09:53:51,709 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251028_0953_stage3_step1200.svg
[rank2]:2025-10-28 09:53:52,966 - INFO - Avg. fwd time: 32.6142 / Avg. bwd time: 29.6041 / Avg. batch time: 1271.8268 (ms) / GPU bubble ratio: 60.86%
[rank3]:2025-10-28 09:53:52,931 - INFO - Avg. fwd time: 72.3566 / Avg. bwd time: 72.0458 / Avg. batch time: 1204.2753 (ms) / GPU bubble ratio: 4.07%
[rank1]:2025-10-28 09:53:53,006 - INFO - Avg. fwd time: 52.2647 / Avg. bwd time: 39.9165 / Avg. batch time: 1358.5378 (ms) / GPU bubble ratio: 45.72%
[rank0]:2025-10-28 09:53:53,012 - INFO - Avg. fwd time: 44.9084 / Avg. bwd time: 6.1061 / Avg. batch time: 1400.0141 (ms) / GPU bubble ratio: 70.85%
[rank0]:2025-10-28 09:54:46,039 - INFO -  step: 1220  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,989  tflops: 22.76  mfu: 7.30%
[rank2]:2025-10-28 09:54:46,038 - INFO -  step: 1220  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,998  tflops: 22.83  mfu: 7.32%
[rank3]:2025-10-28 09:54:46,039 - INFO -  step: 1220  loss:  4.3969  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 3,001  tflops: 22.86  mfu: 7.33%
[rank1]:2025-10-28 09:54:46,039 - INFO -  step: 1220  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,993  tflops: 22.80  mfu: 7.31%
[rank1]:2025-10-28 09:55:40,290 - INFO -  step: 1240  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 3,020  tflops: 23.00  mfu: 7.37%
[rank0]:2025-10-28 09:55:40,290 - INFO -  step: 1240  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 3,020  tflops: 23.00  mfu: 7.37%
[rank2]:2025-10-28 09:55:40,288 - INFO -  step: 1240  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 3,020  tflops: 23.00  mfu: 7.37%
[rank3]:2025-10-28 09:55:40,289 - INFO -  step: 1240  loss:  2.4900  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 3,020  tflops: 23.00  mfu: 7.37%
[rank2]:2025-10-28 09:55:41,647 - INFO - Avg. fwd time: 32.6152 / Avg. bwd time: 29.5184 / Avg. batch time: 1270.3040 (ms) / GPU bubble ratio: 60.87%
[rank3]:2025-10-28 09:55:41,613 - INFO - Avg. fwd time: 72.3660 / Avg. bwd time: 71.8725 / Avg. batch time: 1202.9341 (ms) / GPU bubble ratio: 4.08%
[rank1]:2025-10-28 09:55:41,689 - INFO - Avg. fwd time: 52.2726 / Avg. bwd time: 39.7909 / Avg. batch time: 1356.8663 (ms) / GPU bubble ratio: 45.72%
[rank0]:2025-10-28 09:55:41,696 - INFO - Avg. fwd time: 44.9141 / Avg. bwd time: 5.9093 / Avg. batch time: 1398.1420 (ms) / GPU bubble ratio: 70.92%
[rank0]:2025-10-28 09:56:04,861 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-28 09:56:34,628 - INFO -  step: 1260  loss:  4.3966  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 3,015  tflops: 22.96  mfu: 7.36%
[rank2]:2025-10-28 09:56:34,627 - INFO -  step: 1260  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 3,015  tflops: 22.96  mfu: 7.36%
[rank1]:2025-10-28 09:56:34,628 - INFO -  step: 1260  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 3,015  tflops: 22.96  mfu: 7.36%
[rank0]:2025-10-28 09:56:34,629 - INFO -  step: 1260  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 3,015  tflops: 22.96  mfu: 7.36%
[rank3]:2025-10-28 09:57:29,151 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251028_0957_rank3_trend_line.svg
[rank2]:2025-10-28 09:57:29,155 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251028_0957_rank2_trend_line.svg
[rank1]:2025-10-28 09:57:29,193 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251028_0957_rank1_trend_line.svg
[rank1]:2025-10-28 09:57:29,209 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank1]:2025-10-28 09:57:29,211 - INFO -  step: 1280  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 3,002  tflops: 22.86  mfu: 7.33%
[rank0]:2025-10-28 09:57:29,202 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251028_0957_rank0_trend_line.svg
[rank0]:2025-10-28 09:57:29,209 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-28 09:57:29,212 - INFO -  step: 1280  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 3,002  tflops: 22.86  mfu: 7.33%
[rank2]:2025-10-28 09:57:29,209 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-28 09:57:29,212 - INFO -  step: 1280  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 3,002  tflops: 22.86  mfu: 7.33%
[rank3]:2025-10-28 09:57:29,417 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251028_0957_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 1282.64 ms, GPU Bubble Ratio: 70.83%, 45.28%, 62.82%, 13.74%
[rank3]:2025-10-28 09:57:29,417 - INFO - 	> Batch Time: 1282.64 ms (Average Freeze Ratio: 0.31)
[rank3]:2025-10-28 09:57:29,418 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-28 09:57:29,424 - INFO -  step: 1280  loss:  2.4714  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,990  tflops: 22.77  mfu: 7.30%
[rank2]:2025-10-28 09:57:30,658 - INFO - Avg. fwd time: 32.6133 / Avg. bwd time: 29.4382 / Avg. batch time: 1268.8379 (ms) / GPU bubble ratio: 60.88%
[rank3]:2025-10-28 09:57:30,624 - INFO - Avg. fwd time: 72.3757 / Avg. bwd time: 71.7005 / Avg. batch time: 1201.5927 (ms) / GPU bubble ratio: 4.08%
[rank1]:2025-10-28 09:57:30,699 - INFO - Avg. fwd time: 52.2581 / Avg. bwd time: 39.6707 / Avg. batch time: 1355.2607 (ms) / GPU bubble ratio: 45.74%
[rank0]:2025-10-28 09:57:30,705 - INFO - Avg. fwd time: 44.8994 / Avg. bwd time: 5.7248 / Avg. batch time: 1396.3437 (ms) / GPU bubble ratio: 71.00%
[rank0]:2025-10-28 09:58:28,426 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-28 09:58:31,556 - INFO -  step: 1300  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,628  tflops: 20.02  mfu: 6.42%
[rank2]:2025-10-28 09:58:31,557 - INFO - ðŸ”Ž  Running validation at step 1300
[rank3]:2025-10-28 09:58:31,558 - INFO -  step: 1300  loss:  4.3155  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,637  tflops: 20.08  mfu: 6.44%
[rank3]:2025-10-28 09:58:31,558 - INFO - ðŸ”Ž  Running validation at step 1300
[rank1]:2025-10-28 09:58:31,585 - INFO -  step: 1300  loss: -2.0000  grad_norm:  0.4643  memory: 20.03GiB(42.17%)  tps: 2,627  tflops: 20.01  mfu: 6.41%
[rank1]:2025-10-28 09:58:31,585 - INFO - ðŸ”Ž  Running validation at step 1300
[rank0]:2025-10-28 09:58:31,556 - INFO -  step: 1300  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,628  tflops: 20.02  mfu: 6.42%
[rank0]:2025-10-28 09:58:31,557 - INFO - ðŸ”Ž  Running validation at step 1300
[rank0]:2025-10-28 09:59:40,993 - INFO - validate step: 1300  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,899
[rank1]:2025-10-28 09:59:41,080 - INFO - validate step: 1300  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,894
[rank2]:2025-10-28 09:59:41,159 - INFO - validate step: 1300  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,885
[rank3]:2025-10-28 09:59:41,223 - INFO - validate step: 1300  loss:  1.8007  memory: 38.93GiB(81.95%)  tps: 5,880
[rank1]:2025-10-28 09:59:41,303 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251028_0959_stage1_step1300.svg
[rank0]:2025-10-28 09:59:41,304 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251028_0959_stage0_step1300.svg
[rank2]:2025-10-28 09:59:41,305 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251028_0959_stage2_step1300.svg
[rank3]:2025-10-28 09:59:41,413 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251028_0959_real_step1300_rank3.svg
[rank3]:> Batch Time: 1293.61 ms, GPU Bubble Ratio: 72.07%, 45.19%, 63.42%, 13.56%
[rank3]:2025-10-28 09:59:41,484 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251028_0959_stage3_step1300.svg
[rank0]:2025-10-28 10:00:43,916 - INFO -  step: 1320  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,604  tflops: 19.83  mfu: 6.36%
[rank3]:2025-10-28 10:00:43,917 - INFO -  step: 1320  loss:  2.4366  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,613  tflops: 19.90  mfu: 6.38%
[rank2]:2025-10-28 10:00:43,916 - INFO -  step: 1320  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,611  tflops: 19.88  mfu: 6.37%
[rank1]:2025-10-28 10:00:43,944 - INFO -  step: 1320  loss: -2.0000  grad_norm:  0.2512  memory: 20.03GiB(42.17%)  tps: 2,606  tflops: 19.85  mfu: 6.36%
[rank3]:2025-10-28 10:00:45,235 - INFO - Avg. fwd time: 72.3632 / Avg. bwd time: 71.5392 / Avg. batch time: 1200.1828 (ms) / GPU bubble ratio: 4.08%
[rank2]:2025-10-28 10:00:45,352 - INFO - Avg. fwd time: 32.6171 / Avg. bwd time: 29.3570 / Avg. batch time: 1270.2501 (ms) / GPU bubble ratio: 60.97%
[rank0]:2025-10-28 10:00:45,513 - INFO - Avg. fwd time: 44.8943 / Avg. bwd time: 5.5514 / Avg. batch time: 1400.8946 (ms) / GPU bubble ratio: 71.19%
[rank1]:2025-10-28 10:00:45,507 - INFO - Avg. fwd time: 52.2759 / Avg. bwd time: 41.0433 / Avg. batch time: 1359.9897 (ms) / GPU bubble ratio: 45.11%
[rank3]:2025-10-28 10:01:46,530 - INFO -  step: 1340  loss:  4.2239  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,617  tflops: 19.93  mfu: 6.39%
[rank2]:2025-10-28 10:01:46,529 - INFO -  step: 1340  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,617  tflops: 19.93  mfu: 6.39%
[rank1]:2025-10-28 10:01:46,556 - INFO -  step: 1340  loss: -2.0000  grad_norm:  0.4408  memory: 20.03GiB(42.17%)  tps: 2,617  tflops: 19.93  mfu: 6.39%
[rank0]:2025-10-28 10:01:46,529 - INFO -  step: 1340  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,617  tflops: 19.93  mfu: 6.39%
[rank0]:2025-10-28 10:02:14,663 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-28 10:02:49,158 - INFO -  step: 1360  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,616  tflops: 19.92  mfu: 6.39%
[rank3]:2025-10-28 10:02:49,159 - INFO -  step: 1360  loss:  2.4098  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,616  tflops: 19.92  mfu: 6.39%
[rank2]:2025-10-28 10:02:49,158 - INFO -  step: 1360  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,616  tflops: 19.92  mfu: 6.39%
[rank1]:2025-10-28 10:02:49,187 - INFO -  step: 1360  loss: -2.0000  grad_norm:  0.2123  memory: 20.03GiB(42.17%)  tps: 2,616  tflops: 19.92  mfu: 6.39%
[rank3]:2025-10-28 10:02:50,458 - INFO - Avg. fwd time: 72.3437 / Avg. bwd time: 71.3878 / Avg. batch time: 1198.8051 (ms) / GPU bubble ratio: 4.08%
[rank2]:2025-10-28 10:02:50,588 - INFO - Avg. fwd time: 32.6184 / Avg. bwd time: 29.2815 / Avg. batch time: 1271.5788 (ms) / GPU bubble ratio: 61.06%
[rank1]:2025-10-28 10:02:50,742 - INFO - Avg. fwd time: 52.2986 / Avg. bwd time: 42.3507 / Avg. batch time: 1364.4964 (ms) / GPU bubble ratio: 44.51%
[rank0]:2025-10-28 10:02:50,749 - INFO - Avg. fwd time: 44.8865 / Avg. bwd time: 5.3883 / Avg. batch time: 1405.2341 (ms) / GPU bubble ratio: 71.38%
[rank0]:2025-10-28 10:03:51,809 - INFO -  step: 1380  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,615  tflops: 19.92  mfu: 6.38%
[rank3]:2025-10-28 10:03:51,810 - INFO -  step: 1380  loss:  4.1886  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,615  tflops: 19.92  mfu: 6.38%
[rank2]:2025-10-28 10:03:51,809 - INFO -  step: 1380  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,615  tflops: 19.92  mfu: 6.38%
[rank1]:2025-10-28 10:03:51,836 - INFO -  step: 1380  loss: -2.0000  grad_norm:  0.4611  memory: 20.03GiB(42.17%)  tps: 2,615  tflops: 19.92  mfu: 6.38%
[rank0]:2025-10-28 10:04:50,865 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-28 10:04:54,052 - INFO -  step: 1400  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,632  tflops: 20.05  mfu: 6.43%
[rank0]:2025-10-28 10:04:54,052 - INFO - ðŸ”Ž  Running validation at step 1400
[rank3]:2025-10-28 10:04:54,053 - INFO -  step: 1400  loss:  2.4194  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,632  tflops: 20.05  mfu: 6.43%
[rank3]:2025-10-28 10:04:54,054 - INFO - ðŸ”Ž  Running validation at step 1400
[rank2]:2025-10-28 10:04:54,052 - INFO -  step: 1400  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,632  tflops: 20.05  mfu: 6.43%
[rank2]:2025-10-28 10:04:54,052 - INFO - ðŸ”Ž  Running validation at step 1400
[rank1]:2025-10-28 10:04:54,080 - INFO -  step: 1400  loss: -2.0000  grad_norm:  0.2176  memory: 20.03GiB(42.17%)  tps: 2,632  tflops: 20.05  mfu: 6.43%
[rank1]:2025-10-28 10:04:54,080 - INFO - ðŸ”Ž  Running validation at step 1400
[rank0]:2025-10-28 10:06:03,293 - INFO - validate step: 1400  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,916
[rank1]:2025-10-28 10:06:03,377 - INFO - validate step: 1400  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,911
[rank2]:2025-10-28 10:06:03,457 - INFO - validate step: 1400  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,902
[rank3]:2025-10-28 10:06:03,520 - INFO - validate step: 1400  loss:  1.7886  memory: 38.93GiB(81.95%)  tps: 5,896
[rank0]:2025-10-28 10:06:03,605 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251028_1006_stage0_step1400.svg
[rank2]:2025-10-28 10:06:03,607 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251028_1006_stage2_step1400.svg
[rank1]:2025-10-28 10:06:03,605 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251028_1006_stage1_step1400.svg
[rank3]:2025-10-28 10:06:03,717 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251028_1006_real_step1400_rank3.svg
[rank3]:> Batch Time: 1293.31 ms, GPU Bubble Ratio: 72.07%, 45.04%, 63.42%, 13.57%
[rank3]:2025-10-28 10:06:03,792 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251028_1006_stage3_step1400.svg
[rank3]:2025-10-28 10:06:05,002 - INFO - Avg. fwd time: 72.3244 / Avg. bwd time: 71.2356 / Avg. batch time: 1197.4416 (ms) / GPU bubble ratio: 4.09%
[rank2]:2025-10-28 10:06:05,134 - INFO - Avg. fwd time: 32.6188 / Avg. bwd time: 29.2090 / Avg. batch time: 1272.8001 (ms) / GPU bubble ratio: 61.14%
[rank1]:2025-10-28 10:06:05,286 - INFO - Avg. fwd time: 52.3194 / Avg. bwd time: 43.5721 / Avg. batch time: 1368.6674 (ms) / GPU bubble ratio: 43.95%
[rank0]:2025-10-28 10:06:05,293 - INFO - Avg. fwd time: 44.8667 / Avg. bwd time: 5.2344 / Avg. batch time: 1409.2436 (ms) / GPU bubble ratio: 71.56%
[rank0]:2025-10-28 10:07:06,183 - INFO -  step: 1420  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,605  tflops: 19.84  mfu: 6.36%
[rank3]:2025-10-28 10:07:06,184 - INFO -  step: 1420  loss:  4.1287  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,615  tflops: 19.91  mfu: 6.38%
[rank2]:2025-10-28 10:07:06,183 - INFO -  step: 1420  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,612  tflops: 19.89  mfu: 6.38%
[rank1]:2025-10-28 10:07:06,212 - INFO -  step: 1420  loss: -2.0000  grad_norm:  0.4506  memory: 20.03GiB(42.17%)  tps: 2,607  tflops: 19.86  mfu: 6.37%
[rank0]:2025-10-28 10:08:08,765 - INFO -  step: 1440  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,618  tflops: 19.94  mfu: 6.39%
[rank3]:2025-10-28 10:08:08,766 - INFO -  step: 1440  loss:  2.3652  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,618  tflops: 19.94  mfu: 6.39%
[rank2]:2025-10-28 10:08:08,765 - INFO -  step: 1440  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,618  tflops: 19.94  mfu: 6.39%
[rank1]:2025-10-28 10:08:08,795 - INFO -  step: 1440  loss: -2.0000  grad_norm:  0.2663  memory: 20.03GiB(42.17%)  tps: 2,618  tflops: 19.94  mfu: 6.39%
[rank3]:2025-10-28 10:08:10,088 - INFO - Avg. fwd time: 72.3116 / Avg. bwd time: 71.1032 / Avg. batch time: 1196.2844 (ms) / GPU bubble ratio: 4.09%
[rank2]:2025-10-28 10:08:10,224 - INFO - Avg. fwd time: 32.6200 / Avg. bwd time: 29.1415 / Avg. batch time: 1273.9921 (ms) / GPU bubble ratio: 61.22%
[rank0]:2025-10-28 10:08:10,386 - INFO - Avg. fwd time: 44.8655 / Avg. bwd time: 5.0891 / Avg. batch time: 1413.0687 (ms) / GPU bubble ratio: 71.72%
[rank1]:2025-10-28 10:08:10,379 - INFO - Avg. fwd time: 52.3460 / Avg. bwd time: 44.7296 / Avg. batch time: 1372.6406 (ms) / GPU bubble ratio: 43.42%
[rank0]:2025-10-28 10:08:37,082 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-28 10:09:11,532 - INFO -  step: 1460  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,610  tflops: 19.88  mfu: 6.37%
[rank3]:2025-10-28 10:09:11,533 - INFO -  step: 1460  loss:  4.2262  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,610  tflops: 19.88  mfu: 6.37%
[rank2]:2025-10-28 10:09:11,532 - INFO -  step: 1460  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,610  tflops: 19.88  mfu: 6.37%
[rank1]:2025-10-28 10:09:11,560 - INFO -  step: 1460  loss: -2.0000  grad_norm:  0.4789  memory: 20.03GiB(42.17%)  tps: 2,610  tflops: 19.88  mfu: 6.37%
[rank3]:2025-10-28 10:10:14,135 - INFO -  step: 1480  loss:  2.3874  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,617  tflops: 19.93  mfu: 6.39%
[rank0]:2025-10-28 10:10:14,133 - INFO -  step: 1480  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,617  tflops: 19.93  mfu: 6.39%
[rank2]:2025-10-28 10:10:14,133 - INFO -  step: 1480  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,617  tflops: 19.93  mfu: 6.39%
[rank1]:2025-10-28 10:10:14,161 - INFO -  step: 1480  loss: -2.0000  grad_norm:  0.2112  memory: 20.03GiB(42.17%)  tps: 2,617  tflops: 19.93  mfu: 6.39%
[rank3]:2025-10-28 10:10:15,440 - INFO - Avg. fwd time: 72.3002 / Avg. bwd time: 70.9753 / Avg. batch time: 1195.1581 (ms) / GPU bubble ratio: 4.10%
[rank2]:2025-10-28 10:10:15,561 - INFO - Avg. fwd time: 32.6233 / Avg. bwd time: 29.0774 / Avg. batch time: 1275.1522 (ms) / GPU bubble ratio: 61.29%
[rank1]:2025-10-28 10:10:15,715 - INFO - Avg. fwd time: 52.3731 / Avg. bwd time: 45.8318 / Avg. batch time: 1376.4600 (ms) / GPU bubble ratio: 42.92%
[rank0]:2025-10-28 10:10:15,722 - INFO - Avg. fwd time: 44.8616 / Avg. bwd time: 4.9517 / Avg. batch time: 1416.7481 (ms) / GPU bubble ratio: 71.87%
[rank0]:2025-10-28 10:11:13,347 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-28 10:11:16,428 - INFO -  step: 1500  loss:  4.1168  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,630  tflops: 20.03  mfu: 6.42%
[rank3]:2025-10-28 10:11:16,428 - INFO - ðŸ”Ž  Running validation at step 1500
[rank0]:2025-10-28 10:11:16,426 - INFO -  step: 1500  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,630  tflops: 20.03  mfu: 6.42%
[rank0]:2025-10-28 10:11:16,427 - INFO - ðŸ”Ž  Running validation at step 1500
[rank2]:2025-10-28 10:11:16,426 - INFO -  step: 1500  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,630  tflops: 20.03  mfu: 6.42%
[rank2]:2025-10-28 10:11:16,427 - INFO - ðŸ”Ž  Running validation at step 1500
[rank1]:2025-10-28 10:11:16,454 - INFO -  step: 1500  loss: -2.0000  grad_norm:  0.4566  memory: 20.03GiB(42.17%)  tps: 2,630  tflops: 20.03  mfu: 6.42%
[rank1]:2025-10-28 10:11:16,454 - INFO - ðŸ”Ž  Running validation at step 1500
[rank0]:2025-10-28 10:12:25,648 - INFO - validate step: 1500  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,917
[rank1]:2025-10-28 10:12:25,732 - INFO - validate step: 1500  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,912
[rank2]:2025-10-28 10:12:25,813 - INFO - validate step: 1500  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,903
[rank3]:2025-10-28 10:12:25,876 - INFO - validate step: 1500  loss:  1.7887  memory: 38.93GiB(81.95%)  tps: 5,898
[rank2]:2025-10-28 10:12:25,962 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251028_1012_stage2_step1500.svg
[rank1]:2025-10-28 10:12:25,963 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251028_1012_stage1_step1500.svg
[rank0]:2025-10-28 10:12:25,963 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251028_1012_stage0_step1500.svg
[rank3]:2025-10-28 10:12:26,071 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251028_1012_real_step1500_rank3.svg
[rank3]:> Batch Time: 1293.08 ms, GPU Bubble Ratio: 72.07%, 44.91%, 63.42%, 13.59%
[rank3]:2025-10-28 10:12:26,146 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251028_1012_stage3_step1500.svg
[rank2]:2025-10-28 10:13:28,368 - INFO -  step: 1520  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,619  tflops: 19.95  mfu: 6.39%
[rank3]:2025-10-28 10:13:28,369 - INFO -  step: 1520  loss:  2.4096  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,622  tflops: 19.97  mfu: 6.40%
[rank0]:2025-10-28 10:13:28,368 - INFO -  step: 1520  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,612  tflops: 19.90  mfu: 6.38%
[rank1]:2025-10-28 10:13:28,398 - INFO -  step: 1520  loss: -2.0000  grad_norm:  0.1995  memory: 20.03GiB(42.17%)  tps: 2,615  tflops: 19.91  mfu: 6.38%
[rank3]:2025-10-28 10:13:29,687 - INFO - Avg. fwd time: 72.2852 / Avg. bwd time: 70.8498 / Avg. batch time: 1194.0024 (ms) / GPU bubble ratio: 4.10%
[rank2]:2025-10-28 10:13:29,801 - INFO - Avg. fwd time: 32.6236 / Avg. bwd time: 29.0159 / Avg. batch time: 1276.1118 (ms) / GPU bubble ratio: 61.36%
[rank1]:2025-10-28 10:13:29,953 - INFO - Avg. fwd time: 52.3675 / Avg. bwd time: 46.8577 / Avg. batch time: 1379.8869 (ms) / GPU bubble ratio: 42.47%
[rank0]:2025-10-28 10:13:29,961 - INFO - Avg. fwd time: 44.8571 / Avg. bwd time: 4.8215 / Avg. batch time: 1420.0383 (ms) / GPU bubble ratio: 72.01%
[rank3]:2025-10-28 10:14:30,548 - INFO -  step: 1540  loss:  4.1973  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,635  tflops: 20.07  mfu: 6.43%
[rank0]:2025-10-28 10:14:30,547 - INFO -  step: 1540  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,635  tflops: 20.07  mfu: 6.43%
[rank2]:2025-10-28 10:14:30,547 - INFO -  step: 1540  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,635  tflops: 20.07  mfu: 6.43%
[rank1]:2025-10-28 10:14:30,574 - INFO -  step: 1540  loss: -2.0000  grad_norm:  0.4590  memory: 20.03GiB(42.17%)  tps: 2,635  tflops: 20.07  mfu: 6.43%
[rank0]:2025-10-28 10:14:58,553 - INFO - [GC] Peforming periodical GC collection 0.02 seconds
[rank3]:2025-10-28 10:15:33,043 - INFO -  step: 1560  loss:  2.4143  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,622  tflops: 19.97  mfu: 6.40%
[rank0]:2025-10-28 10:15:33,041 - INFO -  step: 1560  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,622  tflops: 19.97  mfu: 6.40%
[rank2]:2025-10-28 10:15:33,041 - INFO -  step: 1560  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,622  tflops: 19.97  mfu: 6.40%
[rank1]:2025-10-28 10:15:33,070 - INFO -  step: 1560  loss: -2.0000  grad_norm:  0.2128  memory: 20.03GiB(42.17%)  tps: 2,622  tflops: 19.97  mfu: 6.40%
[rank3]:2025-10-28 10:15:34,347 - INFO - Avg. fwd time: 72.2592 / Avg. bwd time: 70.7343 / Avg. batch time: 1192.8910 (ms) / GPU bubble ratio: 4.10%
[rank2]:2025-10-28 10:15:34,483 - INFO - Avg. fwd time: 32.6237 / Avg. bwd time: 28.9575 / Avg. batch time: 1276.9833 (ms) / GPU bubble ratio: 61.42%
[rank1]:2025-10-28 10:15:34,637 - INFO - Avg. fwd time: 52.3754 / Avg. bwd time: 47.8375 / Avg. batch time: 1383.1263 (ms) / GPU bubble ratio: 42.04%
[rank0]:2025-10-28 10:15:34,644 - INFO - Avg. fwd time: 44.8539 / Avg. bwd time: 4.6979 / Avg. batch time: 1423.1485 (ms) / GPU bubble ratio: 72.15%
[rank3]:2025-10-28 10:16:35,813 - INFO -  step: 1580  loss:  4.1680  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,611  tflops: 19.88  mfu: 6.37%
[rank0]:2025-10-28 10:16:35,812 - INFO -  step: 1580  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,610  tflops: 19.88  mfu: 6.37%
[rank2]:2025-10-28 10:16:35,812 - INFO -  step: 1580  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,610  tflops: 19.88  mfu: 6.37%
[rank1]:2025-10-28 10:16:35,840 - INFO -  step: 1580  loss: -2.0000  grad_norm:  0.4420  memory: 20.03GiB(42.17%)  tps: 2,610  tflops: 19.88  mfu: 6.37%
[rank0]:2025-10-28 10:17:35,530 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-28 10:17:38,716 - INFO -  step: 1600  loss:  2.4065  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,605  tflops: 19.84  mfu: 6.36%
[rank3]:2025-10-28 10:17:38,717 - INFO -  final step: 1600  loss:  2.4065  grad_norm:  0.0000  tps: 2,842  tflops: 21.64  mfu: 6.90%
[rank3]:2025-10-28 10:17:38,717 - INFO - ðŸ”Ž  Running validation at step 1600
[rank0]:2025-10-28 10:17:38,715 - INFO -  step: 1600  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,605  tflops: 19.84  mfu: 6.36%
[rank0]:2025-10-28 10:17:38,715 - INFO -  final step: 1600  loss: -2.0000  grad_norm:  0.0000  tps: 2,838  tflops: 21.61  mfu: 6.89%
[rank0]:2025-10-28 10:17:38,715 - INFO - ðŸ”Ž  Running validation at step 1600
[rank2]:2025-10-28 10:17:38,715 - INFO -  step: 1600  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,605  tflops: 19.84  mfu: 6.36%
[rank2]:2025-10-28 10:17:38,715 - INFO -  final step: 1600  loss: -2.0000  grad_norm:  0.0000  tps: 2,839  tflops: 21.62  mfu: 6.90%
[rank2]:2025-10-28 10:17:38,715 - INFO - ðŸ”Ž  Running validation at step 1600
[rank1]:2025-10-28 10:17:38,743 - INFO -  step: 1600  loss: -2.0000  grad_norm:  0.2405  memory: 20.03GiB(42.17%)  tps: 2,605  tflops: 19.84  mfu: 6.36%
[rank1]:2025-10-28 10:17:38,743 - INFO -  final step: 1600  loss: -2.0000  grad_norm:  0.2405  tps: 2,838  tflops: 21.62  mfu: 6.89%
[rank1]:2025-10-28 10:17:38,743 - INFO - ðŸ”Ž  Running validation at step 1600
[rank0]:2025-10-28 10:18:48,281 - INFO - validate step: 1600  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,888
[rank0]:2025-10-28 10:18:48,282 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-28 10:18:48,284 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1600.
[rank1]:2025-10-28 10:18:48,368 - INFO - validate step: 1600  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,883
[rank1]:2025-10-28 10:18:48,369 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-28 10:18:48,371 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1600.
[rank2]:2025-10-28 10:18:48,448 - INFO - validate step: 1600  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,874
[rank2]:2025-10-28 10:18:48,449 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-28 10:18:48,451 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1600.
[rank3]:2025-10-28 10:18:48,512 - INFO - validate step: 1600  loss:  1.7816  memory: 38.93GiB(81.95%)  tps: 5,869
[rank3]:2025-10-28 10:18:48,513 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-28 10:18:48,515 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1600.
[rank3]:Traceback (most recent call last):
[rank3]:  File "<frozen runpy>", line 198, in _run_module_as_main
[rank0]:[rank0]: Traceback (most recent call last):
[rank3]:  File "<frozen runpy>", line 88, in _run_code
[rank0]:[rank0]:   File "<frozen runpy>", line 198, in _run_module_as_main
[rank0]:[rank0]:   File "<frozen runpy>", line 88, in _run_code
[rank0]:[rank0]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 725, in <module>
[rank0]:[rank0]:     trainer.train()
[rank3]:  File "/home/shcho/torchtitan/timelyfreeze/train.py", line 725, in <module>
[rank3]:    trainer.train()
[rank3]:  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
[rank0]:[rank0]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
[rank0]:[rank0]:     return f(*args, **kwargs)
[rank3]:    return f(*args, **kwargs)
[rank0]:[rank0]:            ^^^^^^^^^^^^^^^^^^
[rank3]:           ^^^^^^^^^^^^^^^^^^
[rank3]:  File "/home/shcho/torchtitan/timelyfreeze/train.py", line 597, in train
[rank3]:    self.checkpointer.save(
[rank3]:  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 122, in decorate_context
[rank3]:    return func(*args, **kwargs)
[rank3]:           ^^^^^^^^^^^^^^^^^^^^^
[rank3]:  File "/home/shcho/torchtitan/torchtitan/components/checkpoint.py", line 479, in save
[rank3]:    self._save_last_step(curr_step)
[rank3]:  File "/home/shcho/torchtitan/torchtitan/components/checkpoint.py", line 733, in _save_last_step
[rank3]:    self.dcp_save(
[rank3]:  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 122, in decorate_context
[rank0]:[rank0]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 597, in train
[rank3]:    return func(*args, **kwargs)
[rank3]:           ^^^^^^^^^^^^^^^^^^^^^
[rank0]:[rank0]:     self.checkpointer.save(
[rank0]:[rank0]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 122, in decorate_context
[rank0]:[rank0]:     return func(*args, **kwargs)
[rank0]:[rank0]:            ^^^^^^^^^^^^^^^^^^^^^
[rank0]:[rank0]:   File "/home/shcho/torchtitan/torchtitan/components/checkpoint.py", line 479, in save
[rank0]:[rank0]:     self._save_last_step(curr_step)
[rank0]:[rank0]:   File "/home/shcho/torchtitan/torchtitan/components/checkpoint.py", line 733, in _save_last_step
[rank0]:[rank0]:     self.dcp_save(
[rank0]:[rank0]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 122, in decorate_context
[rank0]:[rank0]:     return func(*args, **kwargs)
[rank0]:[rank0]:            ^^^^^^^^^^^^^^^^^^^^^
[rank0]:[rank0]:   File "/home/shcho/torchtitan/torchtitan/components/checkpoint.py", line 401, in dcp_save
[rank0]:[rank0]:     ret = dcp.save(
[rank0]:[rank0]:           ^^^^^^^^^
[rank0]:[rank0]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/logger.py", line 91, in wrapper
[rank0]:[rank0]:     result = func(*args, **kwargs)
[rank0]:[rank0]:              ^^^^^^^^^^^^^^^^^^^^^
[rank0]:[rank0]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/utils.py", line 482, in inner_func
[rank0]:[rank0]:     return func(*args, **kwargs)
[rank0]:[rank0]:            ^^^^^^^^^^^^^^^^^^^^^
[rank0]:[rank0]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/state_dict_saver.py", line 193, in save
[rank0]:[rank0]:     return _save_state_dict(
[rank0]:[rank0]:            ^^^^^^^^^^^^^^^^^
[rank0]:[rank0]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/state_dict_saver.py", line 481, in _save_state_dict
[rank0]:[rank0]:     metadata = distW.all_reduce("write", write_data, finish_checkpoint)
[rank0]:[rank0]:                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:[rank0]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/utils.py", line 263, in all_reduce
[rank0]:[rank0]:     raise final_result
[rank0]:[rank0]: torch.distributed.checkpoint.api.CheckpointException: CheckpointException ranks:dict_keys([0, 1, 2, 3])
[rank0]:[rank0]: Traceback (most recent call last): (RANK 0)
[rank0]:[rank0]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/utils.py", line 241, in all_reduce
[rank0]:[rank0]:     local_data = map_fun()
[rank0]:[rank0]:                  ^^^^^^^^^
[rank0]:[rank0]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/logger.py", line 91, in wrapper
[rank0]:[rank0]:     result = func(*args, **kwargs)
[rank0]:[rank0]:              ^^^^^^^^^^^^^^^^^^^^^
[rank0]:[rank0]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/state_dict_saver.py", line 468, in write_data
[rank0]:[rank0]:     all_writes = storage_writer.write_data(final_local_plan, planner)
[rank0]:[rank0]:                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:[rank0]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py", line 710, in write_data
[rank0]:[rank0]:     return self._write_data(planner, file_queue)
[rank0]:[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:[rank0]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py", line 738, in _write_data
[rank0]:[rank0]:     _write_files_from_queue(
[rank0]:[rank0]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py", line 441, in _write_files_from_queue
[rank0]:[rank0]:     _write_item(
[rank0]:[rank0]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py", line 345, in _write_item
[rank0]:[rank0]:     torch.save(data, transform_to)
[rank0]:[rank0]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/serialization.py", line 976, in save
[rank0]:[rank0]:     with _open_zipfile_writer(f) as opened_zipfile:
[rank0]:[rank0]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/serialization.py", line 828, in __exit__
[rank0]:[rank0]:     self.file_like.write_end_of_file()
[rank0]:[rank0]: RuntimeError: [enforce fail at inline_container.cc:668] . unexpected pos 704 vs 598
[rank0]:[rank0]: Traceback (most recent call last): (RANK 1)
[rank0]:[rank0]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/utils.py", line 241, in all_reduce
[rank0]:[rank0]:     local_data = map_fun()
[rank0]:[rank0]:                  ^^^^^^^^^
[rank0]:[rank0]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/logger.py", line 91, in wrapper
[rank0]:[rank0]:     result = func(*args, **kwargs)
[rank0]:[rank0]:              ^^^^^^^^^^^^^^^^^^^^^
[rank0]:[rank0]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/state_dict_saver.py", line 468, in write_data
[rank0]:[rank0]:     all_writes = storage_writer.write_data(final_local_plan, planner)
[rank0]:[rank0]:                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:[rank0]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py", line 710, in write_data
[rank0]:[rank0]:     return self._write_data(planner, file_queue)
[rank0]:[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:[rank0]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py", line 738, in _write_data
[rank0]:[rank0]:     _write_files_from_queue(
[rank0]:[rank0]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py", line 441, in _write_files_from_queue
[rank0]:[rank0]:     _write_item(
[rank0]:[rank0]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py", line 345, in _write_item
[rank0]:[rank0]:     torch.save(data, transform_to)
[rank0]:[rank0]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/serialization.py", line 976, in save
[rank0]:[rank0]:     with _open_zipfile_writer(f) as opened_zipfile:
[rank0]:[rank0]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/serialization.py", line 828, in __exit__
[rank0]:[rank0]:     self.file_like.write_end_of_file()
[rank0]:[rank0]: RuntimeError: [enforce fail at inline_container.cc:668] . unexpected pos 704 vs 598
[rank0]:[rank0]: Traceback (most recent call last): (RANK 2)
[rank0]:[rank0]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/utils.py", line 241, in all_reduce
[rank0]:[rank0]:     local_data = map_fun()
[rank0]:[rank0]:                  ^^^^^^^^^
[rank0]:[rank0]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/logger.py", line 91, in wrapper
[rank0]:[rank0]:     result = func(*args, **kwargs)
[rank0]:[rank0]:              ^^^^^^^^^^^^^^^^^^^^^
[rank0]:[rank0]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/state_dict_saver.py", line 468, in write_data
[rank0]:[rank0]:     all_writes = storage_writer.write_data(final_local_plan, planner)
[rank0]:[rank0]:                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:[rank0]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py", line 710, in write_data
[rank0]:[rank0]:     return self._write_data(planner, file_queue)
[rank0]:[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:[rank0]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py", line 738, in _write_data
[rank0]:[rank0]:     _write_files_from_queue(
[rank0]:[rank0]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py", line 441, in _write_files_from_queue
[rank0]:[rank0]:     _write_item(
[rank0]:[rank0]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py", line 345, in _write_item
[rank0]:[rank0]:     torch.save(data, transform_to)
[rank0]:[rank0]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/serialization.py", line 976, in save
[rank0]:[rank0]:     with _open_zipfile_writer(f) as opened_zipfile:
[rank0]:[rank0]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/serialization.py", line 828, in __exit__
[rank0]:[rank0]:     self.file_like.write_end_of_file()
[rank0]:[rank0]: RuntimeError: [enforce fail at inline_container.cc:668] . unexpected pos 704 vs 598
[rank0]:[rank0]: Traceback (most recent call last): (RANK 3)
[rank0]:[rank0]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/utils.py", line 241, in all_reduce
[rank0]:[rank0]:     local_data = map_fun()
[rank0]:[rank0]:                  ^^^^^^^^^
[rank0]:[rank0]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/logger.py", line 91, in wrapper
[rank0]:[rank0]:     result = func(*args, **kwargs)
[rank0]:[rank0]:              ^^^^^^^^^^^^^^^^^^^^^
[rank0]:[rank0]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/state_dict_saver.py", line 468, in write_data
[rank0]:[rank0]:     all_writes = storage_writer.write_data(final_local_plan, planner)
[rank0]:[rank0]:                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:[rank0]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py", line 710, in write_data
[rank0]:[rank0]:     return self._write_data(planner, file_queue)
[rank0]:[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:[rank0]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py", line 738, in _write_data
[rank0]:[rank0]:     _write_files_from_queue(
[rank0]:[rank0]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py", line 441, in _write_files_from_queue
[rank0]:[rank0]:     _write_item(
[rank0]:[rank0]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py", line 345, in _write_item
[rank0]:[rank0]:     torch.save(data, transform_to)
[rank0]:[rank0]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/serialization.py", line 976, in save
[rank0]:[rank0]:     with _open_zipfile_writer(f) as opened_zipfile:
[rank0]:[rank0]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/serialization.py", line 828, in __exit__
[rank0]:[rank0]:     self.file_like.write_end_of_file()
[rank0]:[rank0]: RuntimeError: [enforce fail at inline_container.cc:668] . unexpected pos 704 vs 598
[rank0]:
[rank2]:[rank2]: Traceback (most recent call last):
[rank2]:[rank2]:   File "<frozen runpy>", line 198, in _run_module_as_main
[rank2]:[rank2]:   File "<frozen runpy>", line 88, in _run_code
[rank2]:[rank2]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 725, in <module>
[rank2]:[rank2]:     trainer.train()
[rank2]:[rank2]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
[rank2]:[rank2]:     return f(*args, **kwargs)
[rank2]:[rank2]:            ^^^^^^^^^^^^^^^^^^
[rank2]:[rank2]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 597, in train
[rank2]:[rank2]:     self.checkpointer.save(
[rank2]:[rank2]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 122, in decorate_context
[rank2]:[rank2]:     return func(*args, **kwargs)
[rank2]:[rank2]:            ^^^^^^^^^^^^^^^^^^^^^
[rank2]:[rank2]:   File "/home/shcho/torchtitan/torchtitan/components/checkpoint.py", line 479, in save
[rank2]:[rank2]:     self._save_last_step(curr_step)
[rank2]:[rank2]:   File "/home/shcho/torchtitan/torchtitan/components/checkpoint.py", line 733, in _save_last_step
[rank2]:[rank2]:     self.dcp_save(
[rank2]:[rank2]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 122, in decorate_context
[rank2]:[rank2]:     return func(*args, **kwargs)
[rank2]:[rank2]:            ^^^^^^^^^^^^^^^^^^^^^
[rank2]:[rank2]:   File "/home/shcho/torchtitan/torchtitan/components/checkpoint.py", line 401, in dcp_save
[rank2]:[rank2]:     ret = dcp.save(
[rank2]:[rank2]:           ^^^^^^^^^
[rank2]:[rank2]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/logger.py", line 91, in wrapper
[rank2]:[rank2]:     result = func(*args, **kwargs)
[rank2]:[rank2]:              ^^^^^^^^^^^^^^^^^^^^^
[rank2]:[rank2]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/utils.py", line 482, in inner_func
[rank2]:[rank2]:     return func(*args, **kwargs)
[rank2]:[rank2]:            ^^^^^^^^^^^^^^^^^^^^^
[rank2]:[rank2]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/state_dict_saver.py", line 193, in save
[rank2]:[rank2]:     return _save_state_dict(
[rank2]:[rank2]:            ^^^^^^^^^^^^^^^^^
[rank2]:[rank2]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/state_dict_saver.py", line 481, in _save_state_dict
[rank2]:[rank2]:     metadata = distW.all_reduce("write", write_data, finish_checkpoint)
[rank2]:[rank2]:                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:[rank2]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/utils.py", line 263, in all_reduce
[rank2]:[rank2]:     raise final_result
[rank2]:[rank2]: torch.distributed.checkpoint.api.CheckpointException: CheckpointException ranks:dict_keys([0, 1, 2, 3])
[rank2]:[rank2]: Traceback (most recent call last): (RANK 0)
[rank2]:[rank2]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/utils.py", line 241, in all_reduce
[rank2]:[rank2]:     local_data = map_fun()
[rank2]:[rank2]:                  ^^^^^^^^^
[rank2]:[rank2]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/logger.py", line 91, in wrapper
[rank2]:[rank2]:     result = func(*args, **kwargs)
[rank2]:[rank2]:              ^^^^^^^^^^^^^^^^^^^^^
[rank2]:[rank2]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/state_dict_saver.py", line 468, in write_data
[rank2]:[rank2]:     all_writes = storage_writer.write_data(final_local_plan, planner)
[rank2]:[rank2]:                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:[rank2]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py", line 710, in write_data
[rank2]:[rank2]:     return self._write_data(planner, file_queue)
[rank2]:[rank2]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:[rank2]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py", line 738, in _write_data
[rank2]:[rank2]:     _write_files_from_queue(
[rank2]:[rank2]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py", line 441, in _write_files_from_queue
[rank2]:[rank2]:     _write_item(
[rank2]:[rank2]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py", line 345, in _write_item
[rank2]:[rank2]:     torch.save(data, transform_to)
[rank2]:[rank2]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/serialization.py", line 976, in save
[rank2]:[rank2]:     with _open_zipfile_writer(f) as opened_zipfile:
[rank2]:[rank2]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/serialization.py", line 828, in __exit__
[rank2]:[rank2]:     self.file_like.write_end_of_file()
[rank2]:[rank2]: RuntimeError: [enforce fail at inline_container.cc:668] . unexpected pos 704 vs 598
[rank2]:[rank2]: Traceback (most recent call last): (RANK 1)
[rank2]:[rank2]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/utils.py", line 241, in all_reduce
[rank2]:[rank2]:     local_data = map_fun()
[rank2]:[rank2]:                  ^^^^^^^^^
[rank2]:[rank2]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/logger.py", line 91, in wrapper
[rank2]:[rank2]:     result = func(*args, **kwargs)
[rank2]:[rank2]:              ^^^^^^^^^^^^^^^^^^^^^
[rank2]:[rank2]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/state_dict_saver.py", line 468, in write_data
[rank2]:[rank2]:     all_writes = storage_writer.write_data(final_local_plan, planner)
[rank2]:[rank2]:                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:[rank2]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py", line 710, in write_data
[rank2]:[rank2]:     return self._write_data(planner, file_queue)
[rank2]:[rank2]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:[rank2]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py", line 738, in _write_data
[rank2]:[rank2]:     _write_files_from_queue(
[rank2]:[rank2]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py", line 441, in _write_files_from_queue
[rank2]:[rank2]:     _write_item(
[rank2]:[rank2]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py", line 345, in _write_item
[rank2]:[rank2]:     torch.save(data, transform_to)
[rank2]:[rank2]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/serialization.py", line 976, in save
[rank2]:[rank2]:     with _open_zipfile_writer(f) as opened_zipfile:
[rank2]:[rank2]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/serialization.py", line 828, in __exit__
[rank2]:[rank2]:     self.file_like.write_end_of_file()
[rank2]:[rank2]: RuntimeError: [enforce fail at inline_container.cc:668] . unexpected pos 704 vs 598
[rank2]:[rank2]: Traceback (most recent call last): (RANK 2)
[rank2]:[rank2]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/utils.py", line 241, in all_reduce
[rank2]:[rank2]:     local_data = map_fun()
[rank2]:[rank2]:                  ^^^^^^^^^
[rank2]:[rank2]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/logger.py", line 91, in wrapper
[rank2]:[rank2]:     result = func(*args, **kwargs)
[rank2]:[rank2]:              ^^^^^^^^^^^^^^^^^^^^^
[rank2]:[rank2]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/state_dict_saver.py", line 468, in write_data
[rank2]:[rank2]:     all_writes = storage_writer.write_data(final_local_plan, planner)
[rank2]:[rank2]:                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:[rank2]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py", line 710, in write_data
[rank2]:[rank2]:     return self._write_data(planner, file_queue)
[rank2]:[rank2]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:[rank2]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py", line 738, in _write_data
[rank2]:[rank2]:     _write_files_from_queue(
[rank2]:[rank2]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py", line 441, in _write_files_from_queue
[rank2]:[rank2]:     _write_item(
[rank2]:[rank2]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py", line 345, in _write_item
[rank2]:[rank2]:     torch.save(data, transform_to)
[rank2]:[rank2]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/serialization.py", line 976, in save
[rank2]:[rank2]:     with _open_zipfile_writer(f) as opened_zipfile:
[rank2]:[rank2]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/serialization.py", line 828, in __exit__
[rank2]:[rank2]:     self.file_like.write_end_of_file()
[rank2]:[rank2]: RuntimeError: [enforce fail at inline_container.cc:668] . unexpected pos 704 vs 598
[rank2]:[rank2]: Traceback (most recent call last): (RANK 3)
[rank2]:[rank2]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/utils.py", line 241, in all_reduce
[rank2]:[rank2]:     local_data = map_fun()
[rank2]:[rank2]:                  ^^^^^^^^^
[rank2]:[rank2]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/logger.py", line 91, in wrapper
[rank2]:[rank2]:     result = func(*args, **kwargs)
[rank2]:[rank2]:              ^^^^^^^^^^^^^^^^^^^^^
[rank2]:[rank2]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/state_dict_saver.py", line 468, in write_data
[rank2]:[rank2]:     all_writes = storage_writer.write_data(final_local_plan, planner)
[rank2]:[rank2]:                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:[rank2]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py", line 710, in write_data
[rank2]:[rank2]:     return self._write_data(planner, file_queue)
[rank2]:[rank2]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:[rank2]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py", line 738, in _write_data
[rank2]:[rank2]:     _write_files_from_queue(
[rank2]:[rank2]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py", line 441, in _write_files_from_queue
[rank2]:[rank2]:     _write_item(
[rank2]:[rank2]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py", line 345, in _write_item
[rank2]:[rank2]:     torch.save(data, transform_to)
[rank2]:[rank2]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/serialization.py", line 976, in save
[rank2]:[rank2]:     with _open_zipfile_writer(f) as opened_zipfile:
[rank2]:[rank2]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/serialization.py", line 828, in __exit__
[rank2]:[rank2]:     self.file_like.write_end_of_file()
[rank2]:[rank2]: RuntimeError: [enforce fail at inline_container.cc:668] . unexpected pos 704 vs 598
[rank2]:
[rank1]:[rank1]: Traceback (most recent call last):
[rank1]:[rank1]:   File "<frozen runpy>", line 198, in _run_module_as_main
[rank1]:[rank1]:   File "<frozen runpy>", line 88, in _run_code
[rank1]:[rank1]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 725, in <module>
[rank1]:[rank1]:     trainer.train()
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
[rank1]:[rank1]:     return f(*args, **kwargs)
[rank1]:[rank1]:            ^^^^^^^^^^^^^^^^^^
[rank1]:[rank1]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 597, in train
[rank1]:[rank1]:     self.checkpointer.save(
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 122, in decorate_context
[rank1]:[rank1]:     return func(*args, **kwargs)
[rank1]:[rank1]:            ^^^^^^^^^^^^^^^^^^^^^
[rank1]:[rank1]:   File "/home/shcho/torchtitan/torchtitan/components/checkpoint.py", line 479, in save
[rank1]:[rank1]:     self._save_last_step(curr_step)
[rank1]:[rank1]:   File "/home/shcho/torchtitan/torchtitan/components/checkpoint.py", line 733, in _save_last_step
[rank1]:[rank1]:     self.dcp_save(
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 122, in decorate_context
[rank1]:[rank1]:     return func(*args, **kwargs)
[rank1]:[rank1]:            ^^^^^^^^^^^^^^^^^^^^^
[rank1]:[rank1]:   File "/home/shcho/torchtitan/torchtitan/components/checkpoint.py", line 401, in dcp_save
[rank1]:[rank1]:     ret = dcp.save(
[rank1]:[rank1]:           ^^^^^^^^^
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/logger.py", line 91, in wrapper
[rank1]:[rank1]:     result = func(*args, **kwargs)
[rank1]:[rank1]:              ^^^^^^^^^^^^^^^^^^^^^
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/utils.py", line 482, in inner_func
[rank1]:[rank1]:     return func(*args, **kwargs)
[rank1]:[rank1]:            ^^^^^^^^^^^^^^^^^^^^^
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/state_dict_saver.py", line 193, in save
[rank1]:[rank1]:     return _save_state_dict(
[rank1]:[rank1]:            ^^^^^^^^^^^^^^^^^
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/state_dict_saver.py", line 481, in _save_state_dict
[rank1]:[rank1]:     metadata = distW.all_reduce("write", write_data, finish_checkpoint)
[rank1]:[rank1]:                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/utils.py", line 263, in all_reduce
[rank1]:[rank1]:     raise final_result
[rank1]:[rank1]: torch.distributed.checkpoint.api.CheckpointException: CheckpointException ranks:dict_keys([0, 1, 2, 3])
[rank1]:[rank1]: Traceback (most recent call last): (RANK 0)
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/utils.py", line 241, in all_reduce
[rank1]:[rank1]:     local_data = map_fun()
[rank1]:[rank1]:                  ^^^^^^^^^
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/logger.py", line 91, in wrapper
[rank1]:[rank1]:     result = func(*args, **kwargs)
[rank1]:[rank1]:              ^^^^^^^^^^^^^^^^^^^^^
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/state_dict_saver.py", line 468, in write_data
[rank1]:[rank1]:     all_writes = storage_writer.write_data(final_local_plan, planner)
[rank1]:[rank1]:                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py", line 710, in write_data
[rank1]:[rank1]:     return self._write_data(planner, file_queue)
[rank1]:[rank1]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py", line 738, in _write_data
[rank1]:[rank1]:     _write_files_from_queue(
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py", line 441, in _write_files_from_queue
[rank1]:[rank1]:     _write_item(
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py", line 345, in _write_item
[rank1]:[rank1]:     torch.save(data, transform_to)
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/serialization.py", line 976, in save
[rank1]:[rank1]:     with _open_zipfile_writer(f) as opened_zipfile:
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/serialization.py", line 828, in __exit__
[rank1]:[rank1]:     self.file_like.write_end_of_file()
[rank1]:[rank1]: RuntimeError: [enforce fail at inline_container.cc:668] . unexpected pos 704 vs 598
[rank1]:[rank1]: Traceback (most recent call last): (RANK 1)
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/utils.py", line 241, in all_reduce
[rank1]:[rank1]:     local_data = map_fun()
[rank1]:[rank1]:                  ^^^^^^^^^
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/logger.py", line 91, in wrapper
[rank1]:[rank1]:     result = func(*args, **kwargs)
[rank1]:[rank1]:              ^^^^^^^^^^^^^^^^^^^^^
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/state_dict_saver.py", line 468, in write_data
[rank1]:[rank1]:     all_writes = storage_writer.write_data(final_local_plan, planner)
[rank1]:[rank1]:                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py", line 710, in write_data
[rank1]:[rank1]:     return self._write_data(planner, file_queue)
[rank1]:[rank1]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py", line 738, in _write_data
[rank1]:[rank1]:     _write_files_from_queue(
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py", line 441, in _write_files_from_queue
[rank1]:[rank1]:     _write_item(
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py", line 345, in _write_item
[rank1]:[rank1]:     torch.save(data, transform_to)
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/serialization.py", line 976, in save
[rank1]:[rank1]:     with _open_zipfile_writer(f) as opened_zipfile:
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/serialization.py", line 828, in __exit__
[rank1]:[rank1]:     self.file_like.write_end_of_file()
[rank1]:[rank1]: RuntimeError: [enforce fail at inline_container.cc:668] . unexpected pos 704 vs 598
[rank1]:[rank1]: Traceback (most recent call last): (RANK 2)
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/utils.py", line 241, in all_reduce
[rank1]:[rank1]:     local_data = map_fun()
[rank1]:[rank1]:                  ^^^^^^^^^
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/logger.py", line 91, in wrapper
[rank1]:[rank1]:     result = func(*args, **kwargs)
[rank1]:[rank1]:              ^^^^^^^^^^^^^^^^^^^^^
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/state_dict_saver.py", line 468, in write_data
[rank1]:[rank1]:     all_writes = storage_writer.write_data(final_local_plan, planner)
[rank1]:[rank1]:                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py", line 710, in write_data
[rank1]:[rank1]:     return self._write_data(planner, file_queue)
[rank1]:[rank1]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py", line 738, in _write_data
[rank1]:[rank1]:     _write_files_from_queue(
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py", line 441, in _write_files_from_queue
[rank1]:[rank1]:     _write_item(
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py", line 345, in _write_item
[rank1]:[rank1]:     torch.save(data, transform_to)
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/serialization.py", line 976, in save
[rank1]:[rank1]:     with _open_zipfile_writer(f) as opened_zipfile:
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/serialization.py", line 828, in __exit__
[rank1]:[rank1]:     self.file_like.write_end_of_file()
[rank1]:[rank1]: RuntimeError: [enforce fail at inline_container.cc:668] . unexpected pos 704 vs 598
[rank1]:[rank1]: Traceback (most recent call last): (RANK 3)
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/utils.py", line 241, in all_reduce
[rank1]:[rank1]:     local_data = map_fun()
[rank1]:[rank1]:                  ^^^^^^^^^
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/logger.py", line 91, in wrapper
[rank1]:[rank1]:     result = func(*args, **kwargs)
[rank1]:[rank1]:              ^^^^^^^^^^^^^^^^^^^^^
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/state_dict_saver.py", line 468, in write_data
[rank1]:[rank1]:     all_writes = storage_writer.write_data(final_local_plan, planner)
[rank1]:[rank1]:                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py", line 710, in write_data
[rank1]:[rank1]:     return self._write_data(planner, file_queue)
[rank1]:[rank1]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py", line 738, in _write_data
[rank1]:[rank1]:     _write_files_from_queue(
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py", line 441, in _write_files_from_queue
[rank1]:[rank1]:     _write_item(
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py", line 345, in _write_item
[rank1]:[rank1]:     torch.save(data, transform_to)
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/serialization.py", line 976, in save
[rank1]:[rank1]:     with _open_zipfile_writer(f) as opened_zipfile:
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/serialization.py", line 828, in __exit__
[rank1]:[rank1]:     self.file_like.write_end_of_file()
[rank1]:[rank1]: RuntimeError: [enforce fail at inline_container.cc:668] . unexpected pos 704 vs 598
[rank1]:
[rank3]:  File "/home/shcho/torchtitan/torchtitan/components/checkpoint.py", line 401, in dcp_save
[rank3]:    ret = dcp.save(
[rank3]:          ^^^^^^^^^
[rank3]:  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/logger.py", line 91, in wrapper
[rank3]:    result = func(*args, **kwargs)
[rank3]:             ^^^^^^^^^^^^^^^^^^^^^
[rank3]:  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/utils.py", line 482, in inner_func
[rank3]:    return func(*args, **kwargs)
[rank3]:           ^^^^^^^^^^^^^^^^^^^^^
[rank3]:  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/state_dict_saver.py", line 193, in save
[rank3]:    return _save_state_dict(
[rank3]:           ^^^^^^^^^^^^^^^^^
[rank3]:  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/state_dict_saver.py", line 481, in _save_state_dict
[rank3]:    metadata = distW.all_reduce("write", write_data, finish_checkpoint)
[rank3]:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/utils.py", line 263, in all_reduce
[rank3]:    raise final_result
[rank3]:torch.distributed.checkpoint.api.CheckpointException: CheckpointException ranks:dict_keys([0, 1, 2, 3])
[rank3]:Traceback (most recent call last): (RANK 0)
[rank3]:  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/utils.py", line 241, in all_reduce
[rank3]:    local_data = map_fun()
[rank3]:                 ^^^^^^^^^
[rank3]:  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/logger.py", line 91, in wrapper
[rank3]:    result = func(*args, **kwargs)
[rank3]:             ^^^^^^^^^^^^^^^^^^^^^
[rank3]:  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/state_dict_saver.py", line 468, in write_data
[rank3]:    all_writes = storage_writer.write_data(final_local_plan, planner)
[rank3]:                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py", line 710, in write_data
[rank3]:    return self._write_data(planner, file_queue)
[rank3]:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py", line 738, in _write_data
[rank3]:    _write_files_from_queue(
[rank3]:  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py", line 441, in _write_files_from_queue
[rank3]:    _write_item(
[rank3]:  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py", line 345, in _write_item
[rank3]:    torch.save(data, transform_to)
[rank3]:  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/serialization.py", line 976, in save
[rank3]:    with _open_zipfile_writer(f) as opened_zipfile:
[rank3]:  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/serialization.py", line 828, in __exit__
[rank3]:    self.file_like.write_end_of_file()
[rank3]:RuntimeError: [enforce fail at inline_container.cc:668] . unexpected pos 704 vs 598
[rank3]:Traceback (most recent call last): (RANK 1)
[rank3]:  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/utils.py", line 241, in all_reduce
[rank3]:    local_data = map_fun()
[rank3]:                 ^^^^^^^^^
[rank3]:  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/logger.py", line 91, in wrapper
[rank3]:    result = func(*args, **kwargs)
[rank3]:             ^^^^^^^^^^^^^^^^^^^^^
[rank3]:  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/state_dict_saver.py", line 468, in write_data
[rank3]:    all_writes = storage_writer.write_data(final_local_plan, planner)
[rank3]:                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py", line 710, in write_data
[rank3]:    return self._write_data(planner, file_queue)
[rank3]:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py", line 738, in _write_data
[rank3]:    _write_files_from_queue(
[rank3]:  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py", line 441, in _write_files_from_queue
[rank3]:    _write_item(
[rank3]:  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py", line 345, in _write_item
[rank3]:    torch.save(data, transform_to)
[rank3]:  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/serialization.py", line 976, in save
[rank3]:    with _open_zipfile_writer(f) as opened_zipfile:
[rank3]:  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/serialization.py", line 828, in __exit__
[rank3]:    self.file_like.write_end_of_file()
[rank3]:RuntimeError: [enforce fail at inline_container.cc:668] . unexpected pos 704 vs 598
[rank3]:Traceback (most recent call last): (RANK 2)
[rank3]:  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/utils.py", line 241, in all_reduce
[rank3]:    local_data = map_fun()
[rank3]:                 ^^^^^^^^^
[rank3]:  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/logger.py", line 91, in wrapper
[rank3]:    result = func(*args, **kwargs)
[rank3]:             ^^^^^^^^^^^^^^^^^^^^^
[rank3]:  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/state_dict_saver.py", line 468, in write_data
[rank3]:    all_writes = storage_writer.write_data(final_local_plan, planner)
[rank3]:                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py", line 710, in write_data
[rank3]:    return self._write_data(planner, file_queue)
[rank3]:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py", line 738, in _write_data
[rank3]:    _write_files_from_queue(
[rank3]:  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py", line 441, in _write_files_from_queue
[rank3]:    _write_item(
[rank3]:  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py", line 345, in _write_item
[rank3]:    torch.save(data, transform_to)
[rank3]:  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/serialization.py", line 976, in save
[rank3]:    with _open_zipfile_writer(f) as opened_zipfile:
[rank3]:  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/serialization.py", line 828, in __exit__
[rank3]:    self.file_like.write_end_of_file()
[rank3]:RuntimeError: [enforce fail at inline_container.cc:668] . unexpected pos 704 vs 598
[rank3]:Traceback (most recent call last): (RANK 3)
[rank3]:  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/utils.py", line 241, in all_reduce
[rank3]:    local_data = map_fun()
[rank3]:                 ^^^^^^^^^
[rank3]:  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/logger.py", line 91, in wrapper
[rank3]:    result = func(*args, **kwargs)
[rank3]:             ^^^^^^^^^^^^^^^^^^^^^
[rank3]:  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/state_dict_saver.py", line 468, in write_data
[rank3]:    all_writes = storage_writer.write_data(final_local_plan, planner)
[rank3]:                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py", line 710, in write_data
[rank3]:    return self._write_data(planner, file_queue)
[rank3]:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py", line 738, in _write_data
[rank3]:    _write_files_from_queue(
[rank3]:  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py", line 441, in _write_files_from_queue
[rank3]:    _write_item(
[rank3]:  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py", line 345, in _write_item
[rank3]:    torch.save(data, transform_to)
[rank3]:  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/serialization.py", line 976, in save
[rank3]:    with _open_zipfile_writer(f) as opened_zipfile:
[rank3]:  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/serialization.py", line 828, in __exit__
[rank3]:    self.file_like.write_end_of_file()
[rank3]:RuntimeError: [enforce fail at inline_container.cc:668] . unexpected pos 704 vs 598
[rank3]:
[rank3]:[rank3]: Traceback (most recent call last):
[rank3]:[rank3]:   File "<frozen runpy>", line 198, in _run_module_as_main
[rank3]:[rank3]:   File "<frozen runpy>", line 88, in _run_code
[rank3]:[rank3]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 725, in <module>
[rank3]:[rank3]:     trainer.train()
[rank3]:[rank3]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
[rank3]:[rank3]:     return f(*args, **kwargs)
[rank3]:[rank3]:            ^^^^^^^^^^^^^^^^^^
[rank3]:[rank3]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 597, in train
[rank3]:[rank3]:     self.checkpointer.save(
[rank3]:[rank3]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 122, in decorate_context
[rank3]:[rank3]:     return func(*args, **kwargs)
[rank3]:[rank3]:            ^^^^^^^^^^^^^^^^^^^^^
[rank3]:[rank3]:   File "/home/shcho/torchtitan/torchtitan/components/checkpoint.py", line 479, in save
[rank3]:[rank3]:     self._save_last_step(curr_step)
[rank3]:[rank3]:   File "/home/shcho/torchtitan/torchtitan/components/checkpoint.py", line 733, in _save_last_step
[rank3]:[rank3]:     self.dcp_save(
[rank3]:[rank3]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 122, in decorate_context
[rank3]:[rank3]:     return func(*args, **kwargs)
[rank3]:[rank3]:            ^^^^^^^^^^^^^^^^^^^^^
[rank3]:[rank3]:   File "/home/shcho/torchtitan/torchtitan/components/checkpoint.py", line 401, in dcp_save
[rank3]:[rank3]:     ret = dcp.save(
[rank3]:[rank3]:           ^^^^^^^^^
[rank3]:[rank3]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/logger.py", line 91, in wrapper
[rank3]:[rank3]:     result = func(*args, **kwargs)
[rank3]:[rank3]:              ^^^^^^^^^^^^^^^^^^^^^
[rank3]:[rank3]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/utils.py", line 482, in inner_func
[rank3]:[rank3]:     return func(*args, **kwargs)
[rank3]:[rank3]:            ^^^^^^^^^^^^^^^^^^^^^
[rank3]:[rank3]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/state_dict_saver.py", line 193, in save
[rank3]:[rank3]:     return _save_state_dict(
[rank3]:[rank3]:            ^^^^^^^^^^^^^^^^^
[rank3]:[rank3]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/state_dict_saver.py", line 481, in _save_state_dict
[rank3]:[rank3]:     metadata = distW.all_reduce("write", write_data, finish_checkpoint)
[rank3]:[rank3]:                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:[rank3]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/utils.py", line 263, in all_reduce
[rank3]:[rank3]:     raise final_result
[rank3]:[rank3]: torch.distributed.checkpoint.api.CheckpointException: CheckpointException ranks:dict_keys([0, 1, 2, 3])
[rank3]:[rank3]: Traceback (most recent call last): (RANK 0)
[rank3]:[rank3]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/utils.py", line 241, in all_reduce
[rank3]:[rank3]:     local_data = map_fun()
[rank3]:[rank3]:                  ^^^^^^^^^
[rank3]:[rank3]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/logger.py", line 91, in wrapper
[rank3]:[rank3]:     result = func(*args, **kwargs)
[rank3]:[rank3]:              ^^^^^^^^^^^^^^^^^^^^^
[rank3]:[rank3]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/state_dict_saver.py", line 468, in write_data
[rank3]:[rank3]:     all_writes = storage_writer.write_data(final_local_plan, planner)
[rank3]:[rank3]:                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:[rank3]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py", line 710, in write_data
[rank3]:[rank3]:     return self._write_data(planner, file_queue)
[rank3]:[rank3]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:[rank3]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py", line 738, in _write_data
[rank3]:[rank3]:     _write_files_from_queue(
[rank3]:[rank3]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py", line 441, in _write_files_from_queue
[rank3]:[rank3]:     _write_item(
[rank3]:[rank3]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py", line 345, in _write_item
[rank3]:[rank3]:     torch.save(data, transform_to)
[rank3]:[rank3]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/serialization.py", line 976, in save
[rank3]:[rank3]:     with _open_zipfile_writer(f) as opened_zipfile:
[rank3]:[rank3]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/serialization.py", line 828, in __exit__
[rank3]:[rank3]:     self.file_like.write_end_of_file()
[rank3]:[rank3]: RuntimeError: [enforce fail at inline_container.cc:668] . unexpected pos 704 vs 598
[rank3]:[rank3]: Traceback (most recent call last): (RANK 1)
[rank3]:[rank3]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/utils.py", line 241, in all_reduce
[rank3]:[rank3]:     local_data = map_fun()
[rank3]:[rank3]:                  ^^^^^^^^^
[rank3]:[rank3]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/logger.py", line 91, in wrapper
[rank3]:[rank3]:     result = func(*args, **kwargs)
[rank3]:[rank3]:              ^^^^^^^^^^^^^^^^^^^^^
[rank3]:[rank3]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/state_dict_saver.py", line 468, in write_data
[rank3]:[rank3]:     all_writes = storage_writer.write_data(final_local_plan, planner)
[rank3]:[rank3]:                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:[rank3]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py", line 710, in write_data
[rank3]:[rank3]:     return self._write_data(planner, file_queue)
[rank3]:[rank3]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:[rank3]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py", line 738, in _write_data
[rank3]:[rank3]:     _write_files_from_queue(
[rank3]:[rank3]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py", line 441, in _write_files_from_queue
[rank3]:[rank3]:     _write_item(
[rank3]:[rank3]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py", line 345, in _write_item
[rank3]:[rank3]:     torch.save(data, transform_to)
[rank3]:[rank3]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/serialization.py", line 976, in save
[rank3]:[rank3]:     with _open_zipfile_writer(f) as opened_zipfile:
[rank3]:[rank3]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/serialization.py", line 828, in __exit__
[rank3]:[rank3]:     self.file_like.write_end_of_file()
[rank3]:[rank3]: RuntimeError: [enforce fail at inline_container.cc:668] . unexpected pos 704 vs 598
[rank3]:[rank3]: Traceback (most recent call last): (RANK 2)
[rank3]:[rank3]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/utils.py", line 241, in all_reduce
[rank3]:[rank3]:     local_data = map_fun()
[rank3]:[rank3]:                  ^^^^^^^^^
[rank3]:[rank3]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/logger.py", line 91, in wrapper
[rank3]:[rank3]:     result = func(*args, **kwargs)
[rank3]:[rank3]:              ^^^^^^^^^^^^^^^^^^^^^
[rank3]:[rank3]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/state_dict_saver.py", line 468, in write_data
[rank3]:[rank3]:     all_writes = storage_writer.write_data(final_local_plan, planner)
[rank3]:[rank3]:                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:[rank3]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py", line 710, in write_data
[rank3]:[rank3]:     return self._write_data(planner, file_queue)
[rank3]:[rank3]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:[rank3]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py", line 738, in _write_data
[rank3]:[rank3]:     _write_files_from_queue(
[rank3]:[rank3]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py", line 441, in _write_files_from_queue
[rank3]:[rank3]:     _write_item(
[rank3]:[rank3]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py", line 345, in _write_item
[rank3]:[rank3]:     torch.save(data, transform_to)
[rank3]:[rank3]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/serialization.py", line 976, in save
[rank3]:[rank3]:     with _open_zipfile_writer(f) as opened_zipfile:
[rank3]:[rank3]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/serialization.py", line 828, in __exit__
[rank3]:[rank3]:     self.file_like.write_end_of_file()
[rank3]:[rank3]: RuntimeError: [enforce fail at inline_container.cc:668] . unexpected pos 704 vs 598
[rank3]:[rank3]: Traceback (most recent call last): (RANK 3)
[rank3]:[rank3]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/utils.py", line 241, in all_reduce
[rank3]:[rank3]:     local_data = map_fun()
[rank3]:[rank3]:                  ^^^^^^^^^
[rank3]:[rank3]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/logger.py", line 91, in wrapper
[rank3]:[rank3]:     result = func(*args, **kwargs)
[rank3]:[rank3]:              ^^^^^^^^^^^^^^^^^^^^^
[rank3]:[rank3]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/state_dict_saver.py", line 468, in write_data
[rank3]:[rank3]:     all_writes = storage_writer.write_data(final_local_plan, planner)
[rank3]:[rank3]:                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:[rank3]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py", line 710, in write_data
[rank3]:[rank3]:     return self._write_data(planner, file_queue)
[rank3]:[rank3]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:[rank3]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py", line 738, in _write_data
[rank3]:[rank3]:     _write_files_from_queue(
[rank3]:[rank3]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py", line 441, in _write_files_from_queue
[rank3]:[rank3]:     _write_item(
[rank3]:[rank3]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py", line 345, in _write_item
[rank3]:[rank3]:     torch.save(data, transform_to)
[rank3]:[rank3]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/serialization.py", line 976, in save
[rank3]:[rank3]:     with _open_zipfile_writer(f) as opened_zipfile:
[rank3]:[rank3]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/serialization.py", line 828, in __exit__
[rank3]:[rank3]:     self.file_like.write_end_of_file()
[rank3]:[rank3]: RuntimeError: [enforce fail at inline_container.cc:668] . unexpected pos 704 vs 598
[rank3]:
[rank0]:[rank0]:[W1028 10:18:50.736432971 ProcessGroupNCCL.cpp:1552] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
W1028 10:18:51.795000 2402893 site-packages/torch/distributed/elastic/multiprocessing/api.py:940] Sending process 2402913 closing signal SIGTERM
W1028 10:18:51.796000 2402893 site-packages/torch/distributed/elastic/multiprocessing/api.py:940] Sending process 2402914 closing signal SIGTERM
W1028 10:18:51.797000 2402893 site-packages/torch/distributed/elastic/multiprocessing/api.py:940] Sending process 2402916 closing signal SIGTERM
E1028 10:18:52.607000 2402893 site-packages/torch/distributed/elastic/multiprocessing/api.py:914] failed (exitcode: 1) local_rank: 2 (pid: 2402915) of binary: /data2/shcho/miniforge3/envs/llm_eval/bin/python3.11
[rank2]:Stage 2: Modules to keep: {'layers.12', 'layers.11', 'layers.10', 'layers.9'}
[rank1]:Stage 1: Modules to keep: {'layers.6', 'layers.7', 'layers.8', 'layers.4', 'layers.5'}
[rank0]:Stage 0: Modules to keep: {'layers.1', 'layers.0', 'layers.2', 'tok_embeddings', 'layers.3'}
[rank3]:Stage 3: Modules to keep: {'layers.13', 'layers.14', 'layers.15', 'output', 'norm'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1026_llama1b/config.toml
[rank3]:		- dump_folder: /data3/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1028_GPipe_timelyauto_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data3/shcho/torchtitan/profile_trace/1028_GPipe_timelyauto_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data3/shcho/torchtitan/memory_snapshot/1028_GPipe_timelyauto_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 20
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data3/shcho/torchtitan/tb/1028_GPipe_timelyauto_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data3/shcho/torchtitan/images/1028_GPipe_timelyauto_dm1
[rank3]:		- pplog_freq: 80
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1028_GPipe_timelyauto_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B-Instruct
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 1e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: alpaca
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 512
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 1600
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: GPipe
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 4
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data3/shcho/torchtitan/checkpoint/1028_GPipe_timelyauto_dm1
[rank3]:		- interval: 800
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B-Instruct/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data3/shcho/torchtitan/comm_traces/1028_GPipe_timelyauto_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: True
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 100
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: timelyauto
[rank3]:		- phase_unit: 10
[rank3]:		- stability_check_freq: 5
[rank3]:		- aggressiveness: 0
[rank3]:
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[1;34mwandb[0m: 
[rank3]:[1;34mwandb[0m: ðŸš€ View run [33m1028_GPipe_timelyauto_dm1[0m at: [34m[0m
[rank3]:[1;34mwandb[0m: Find logs at: [1;35m../../../data3/shcho/torchtitan/tb/1028_GPipe_timelyauto_dm1/20251028-0842/wandb/run-20251028_084218-dractsat/logs[0m
Traceback (most recent call last):
  File "/data2/shcho/miniforge3/envs/llm_eval/bin/torchrun", line 7, in <module>
    sys.exit(main())
             ^^^^^^
  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/run.py", line 946, in main
    run(args)
  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/run.py", line 937, in run
    elastic_launch(
  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 159, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 300, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
timelyfreeze.train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2025-10-28_10:18:52
  host      : elga.kaist.ac.kr
  rank      : 0 (local_rank: 0)
  exitcode  : 1 (pid: 2402913)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2025-10-28_10:18:52
  host      : elga.kaist.ac.kr
  rank      : 1 (local_rank: 1)
  exitcode  : 1 (pid: 2402914)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2025-10-28_10:18:52
  host      : elga.kaist.ac.kr
  rank      : 3 (local_rank: 3)
  exitcode  : 1 (pid: 2402916)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2025-10-28_10:18:51
  host      : elga.kaist.ac.kr
  rank      : 2 (local_rank: 2)
  exitcode  : 1 (pid: 2402915)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
