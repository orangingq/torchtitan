
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 10. 28. (í™”) 06:56:31 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 3,4,5,6
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1026_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1026_llama1b/1028_GPipe_timelyapf.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs
âœ”ï¸Running with timelyapf x GPipe ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1026_llama1b/config.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=timelyapf
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank1]:2025-10-28 06:56:38,177 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs"
[rank3]:2025-10-28 06:56:38,339 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs"
[rank1]:2025-10-28 06:56:38,343 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-10-28 06:56:38,345 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-10-28 06:56:38,275 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs"
[rank0]:2025-10-28 06:56:38,381 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs"
[rank2]:2025-10-28 06:56:38,523 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-10-28 06:56:38,526 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-28 06:56:38,648 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-10-28 06:56:38,650 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-28 06:56:38,656 - INFO - [GC] Initial GC collection 0.00 seconds
[rank3]:2025-10-28 06:56:38,625 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-10-28 06:56:38,628 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-28 06:56:39,084 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-10-28 06:56:39,544 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank1]:2025-10-28 06:56:42,502 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-10-28 06:56:42,543 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-10-28 06:56:42,571 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-10-28 06:56:42,571 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank2]:2025-10-28 06:56:42,616 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-10-28 06:56:42,652 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-10-28 06:56:42,680 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-10-28 06:56:42,680 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2025-10-28 06:56:42,776 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-10-28 06:56:42,776 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-10-28 06:56:42,777 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank2]:2025-10-28 06:56:42,877 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-10-28 06:56:42,878 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-10-28 06:56:42,878 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank0]:2025-10-28 06:56:43,371 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=512, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank0]:2025-10-28 06:56:43,636 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-10-28 06:56:43,674 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-10-28 06:56:43,675 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-10-28 06:56:43,701 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-10-28 06:56:43,701 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-10-28 06:56:43,915 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-10-28 06:56:43,915 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-10-28 06:56:43,916 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank3]:wandb: setting up run 7tlses22
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data3/shcho/torchtitan/tb/1028_GPipe_timelyapf_dm1/20251028-0656/wandb/run-20251028_065643-7tlses22
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1028_GPipe_timelyapf_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/7tlses22
[rank3]:2025-10-28 06:56:44,871 - INFO - WandB logging enabled
[rank3]:2025-10-28 06:56:45,052 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-10-28 06:56:45,091 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-10-28 06:56:45,118 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-10-28 06:56:45,118 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank3]:2025-10-28 06:56:45,724 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-10-28 06:56:45,724 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-10-28 06:56:45,725 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank0]:2025-10-28 06:56:45,742 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data3/shcho/torchtitan/checkpoint/1028_GPipe_timelyapf_dm1
[rank0]:2025-10-28 06:56:45,742 - WARNING - Mixed precision training with TP or PP is only supported when FSDP/HSDP/CP is enabled.
[rank0]:2025-10-28 06:56:45,742 - INFO - Mixed precision training is disabled
[rank0]:2025-10-28 06:56:45,743 - INFO - Preparing c4_validation dataset from allenai/c4
[rank0]:2025-10-28 06:56:50,311 - INFO - Trainer is initialized with local batch size 32, global batch size 64, gradient accumulation steps 2, sequence length 512, total steps 1600 (warmup 100)
[rank0]:2025-10-28 06:56:50,311 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B-Instruct/original_dcp.
[rank0]:2025-10-28 06:56:53,434 - INFO - [GC] GC collection for checkpoint loading. 0.01 seconds
[rank0]:2025-10-28 06:56:53,434 - INFO - Finished loading the checkpoint in 3.12 seconds.
[rank0]:2025-10-28 06:56:53,434 - INFO - Training starts at step 1
[rank0]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/autograd/graph.py:849: UserWarning: Attempting to run cuBLAS, but there was no current CUDA context! Attempting to set the primary context... (Triggered internally at /pytorch/aten/src/ATen/cuda/CublasHandlePool.cpp:270.)
[rank0]:  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
[rank1]:2025-10-28 06:57:01,532 - INFO -  step:  1  loss: -2.0000  grad_norm: 95.1855  memory: 17.77GiB(37.40%)  tps: 431  tflops: 3.29  mfu: 1.05%
[rank1]:2025-10-28 06:57:01,532 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-28 06:57:01,537 - INFO -  step:  1  loss:  9.0107  grad_norm: 95.1855  memory: 35.59GiB(74.92%)  tps: 498  tflops: 3.79  mfu: 1.22%
[rank3]:2025-10-28 06:57:01,537 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-10-28 06:57:01,529 - INFO -  step:  1  loss: -2.0000  grad_norm: 95.1855  memory: 14.29GiB(30.07%)  tps: 434  tflops: 3.31  mfu: 1.06%
[rank2]:2025-10-28 06:57:01,529 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-10-28 06:57:01,551 - INFO -  step:  1  loss: -2.0000  grad_norm: 95.1855  memory: 17.10GiB(35.99%)  tps: 458  tflops: 3.49  mfu: 1.12%
[rank0]:2025-10-28 06:57:01,551 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-28 06:57:18,835 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 06:57:18,836 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 06:57:18,837 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 06:57:18,838 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 06:57:18,838 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 06:57:18,839 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 06:57:18,839 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 06:57:18,840 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 06:57:18,840 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 06:57:18,840 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 06:57:18,841 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 06:57:18,841 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 06:57:18,842 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 06:57:18,842 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 06:57:18,843 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 06:57:18,843 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 06:57:18,899 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 06:57:18,899 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 06:57:18,900 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 06:57:18,900 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 06:57:18,900 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 06:57:18,900 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 06:57:18,900 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 06:57:18,900 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 06:57:18,900 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 06:57:18,900 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 06:57:18,900 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 06:57:18,900 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 06:57:18,900 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 06:57:18,900 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 06:57:18,900 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 06:57:18,900 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 06:57:18,968 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 06:57:18,968 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 06:57:18,968 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 06:57:18,968 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 06:57:18,968 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 06:57:18,968 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 06:57:18,968 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 06:57:18,968 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 06:57:18,968 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 06:57:18,968 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 06:57:18,968 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 06:57:18,968 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 06:57:18,968 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 06:57:18,968 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 06:57:18,968 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 06:57:18,968 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 06:57:19,029 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 06:57:19,029 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 06:57:19,029 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 06:57:19,029 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 06:57:19,029 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 06:57:19,029 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 06:57:19,029 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 06:57:19,029 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 06:57:19,029 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 06:57:19,029 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 06:57:19,030 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 06:57:19,030 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 06:57:19,030 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 06:57:19,030 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 06:57:19,030 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 06:57:19,030 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 06:58:16,697 - INFO -  step: 20  loss: -2.0000  grad_norm: 61.7965  memory: 16.10GiB(33.90%)  tps: 2,071  tflops: 15.77  mfu: 5.05%
[rank3]:2025-10-28 06:58:16,709 - INFO -  step: 20  loss: 10.8312  grad_norm: 61.7965  memory: 38.93GiB(81.95%)  tps: 2,071  tflops: 15.77  mfu: 5.05%
[rank1]:2025-10-28 06:58:16,701 - INFO -  step: 20  loss: -2.0000  grad_norm: 61.7965  memory: 20.03GiB(42.17%)  tps: 2,071  tflops: 15.77  mfu: 5.05%
[rank0]:2025-10-28 06:58:16,715 - INFO -  step: 20  loss: -2.0000  grad_norm: 61.7965  memory: 20.89GiB(43.97%)  tps: 2,071  tflops: 15.77  mfu: 5.05%
[rank2]:2025-10-28 06:59:36,924 - INFO -  step: 40  loss: -2.0000  grad_norm: 41.4055  memory: 16.10GiB(33.90%)  tps: 2,042  tflops: 15.55  mfu: 4.99%
[rank0]:2025-10-28 06:59:36,944 - INFO -  step: 40  loss: -2.0000  grad_norm: 41.4055  memory: 20.89GiB(43.97%)  tps: 2,042  tflops: 15.55  mfu: 4.99%
[rank1]:2025-10-28 06:59:36,928 - INFO -  step: 40  loss: -2.0000  grad_norm: 41.4055  memory: 20.03GiB(42.17%)  tps: 2,042  tflops: 15.55  mfu: 4.99%
[rank3]:2025-10-28 06:59:36,937 - INFO -  step: 40  loss:  5.6595  grad_norm: 41.4055  memory: 38.93GiB(81.95%)  tps: 2,042  tflops: 15.55  mfu: 4.99%
[rank3]:2025-10-28 06:59:38,757 - INFO - Avg. fwd time: 71.2011 / Avg. bwd time: 127.7882 / Avg. batch time: 1660.6866 (ms) / GPU bubble ratio: 4.14%
[rank2]:2025-10-28 06:59:38,812 - INFO - Avg. fwd time: 32.4677 / Avg. bwd time: 51.2134 / Avg. batch time: 1747.6986 (ms) / GPU bubble ratio: 61.70%
[rank1]:2025-10-28 06:59:38,884 - INFO - Avg. fwd time: 50.0692 / Avg. bwd time: 69.6576 / Avg. batch time: 1863.4186 (ms) / GPU bubble ratio: 48.60%
[rank0]:2025-10-28 06:59:38,947 - INFO - Avg. fwd time: 45.0847 / Avg. bwd time: 57.6927 / Avg. batch time: 1959.4502 (ms) / GPU bubble ratio: 58.04%
[rank0]:2025-10-28 07:00:12,882 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-28 07:00:56,581 - INFO -  step: 60  loss: -2.0000  grad_norm: 31.9911  memory: 16.10GiB(33.90%)  tps: 2,057  tflops: 15.67  mfu: 5.02%
[rank0]:2025-10-28 07:00:56,596 - INFO -  step: 60  loss: -2.0000  grad_norm: 31.9911  memory: 20.89GiB(43.97%)  tps: 2,057  tflops: 15.67  mfu: 5.02%
[rank1]:2025-10-28 07:00:56,585 - INFO -  step: 60  loss: -2.0000  grad_norm: 31.9911  memory: 20.03GiB(42.17%)  tps: 2,057  tflops: 15.67  mfu: 5.02%
[rank3]:2025-10-28 07:00:56,593 - INFO -  step: 60  loss:  8.4863  grad_norm: 31.9911  memory: 38.93GiB(81.95%)  tps: 2,057  tflops: 15.67  mfu: 5.02%
[rank0]:2025-10-28 07:02:16,281 - INFO -  step: 80  loss: -2.0000  grad_norm: 43.2633  memory: 20.89GiB(43.97%)  tps: 2,056  tflops: 15.66  mfu: 5.02%
[rank2]:2025-10-28 07:02:16,261 - INFO -  step: 80  loss: -2.0000  grad_norm: 43.2633  memory: 16.10GiB(33.90%)  tps: 2,056  tflops: 15.66  mfu: 5.02%
[rank1]:2025-10-28 07:02:16,268 - INFO -  step: 80  loss: -2.0000  grad_norm: 43.2633  memory: 20.03GiB(42.17%)  tps: 2,056  tflops: 15.66  mfu: 5.02%
[rank3]:2025-10-28 07:02:16,273 - INFO -  step: 80  loss:  4.0061  grad_norm: 43.2633  memory: 38.93GiB(81.95%)  tps: 2,056  tflops: 15.66  mfu: 5.02%
[rank3]:2025-10-28 07:02:18,085 - INFO - Avg. fwd time: 71.6574 / Avg. bwd time: 128.6091 / Avg. batch time: 1661.0677 (ms) / GPU bubble ratio: 3.55%
[rank2]:2025-10-28 07:02:18,139 - INFO - Avg. fwd time: 32.6051 / Avg. bwd time: 51.5881 / Avg. batch time: 1748.0076 (ms) / GPU bubble ratio: 61.47%
[rank0]:2025-10-28 07:02:18,278 - INFO - Avg. fwd time: 45.3421 / Avg. bwd time: 57.9518 / Avg. batch time: 1959.6391 (ms) / GPU bubble ratio: 57.83%
[rank1]:2025-10-28 07:02:18,216 - INFO - Avg. fwd time: 50.6579 / Avg. bwd time: 70.1790 / Avg. batch time: 1863.7047 (ms) / GPU bubble ratio: 48.13%
[rank3]:2025-10-28 07:03:15,360 - INFO - [Step 95] ã€°ï¸ Monitoring Upperbound
[rank0]:2025-10-28 07:03:32,678 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-28 07:03:35,862 - WARNING - [Step 100] â³ Monitoring Upperbound... (200/200)
[rank2]:2025-10-28 07:03:36,489 - WARNING - [Step 100] â³ Monitoring Upperbound... (200/200)
[rank1]:2025-10-28 07:03:36,566 - WARNING - [Step 100] â³ Monitoring Upperbound... (200/200)
[rank2]:2025-10-28 07:03:36,643 - INFO -  step: 100  loss: -2.0000  grad_norm: 50.3909  memory: 16.10GiB(33.90%)  tps: 2,038  tflops: 15.52  mfu: 4.98%
[rank2]:2025-10-28 07:03:36,643 - INFO - ðŸ”Ž  Running validation at step 100
[rank0]:2025-10-28 07:03:36,628 - WARNING - [Step 100] â³ Monitoring Upperbound... (200/200)
[rank0]:2025-10-28 07:03:36,662 - INFO -  step: 100  loss: -2.0000  grad_norm: 50.3909  memory: 20.89GiB(43.97%)  tps: 2,038  tflops: 15.52  mfu: 4.98%
[rank0]:2025-10-28 07:03:36,663 - INFO - ðŸ”Ž  Running validation at step 100
[rank1]:2025-10-28 07:03:36,653 - INFO -  step: 100  loss: -2.0000  grad_norm: 50.3909  memory: 20.03GiB(42.17%)  tps: 2,038  tflops: 15.52  mfu: 4.98%
[rank1]:2025-10-28 07:03:36,653 - INFO - ðŸ”Ž  Running validation at step 100
[rank3]:2025-10-28 07:03:39,031 - INFO -  step: 100  loss:  5.4724  grad_norm: 50.3909  memory: 38.93GiB(81.95%)  tps: 1,980  tflops: 15.08  mfu: 4.83%
[rank3]:2025-10-28 07:03:39,031 - INFO - ðŸ”Ž  Running validation at step 100
[rank0]:2025-10-28 07:04:50,814 - INFO - validate step: 100  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,524
[rank1]:2025-10-28 07:04:50,896 - INFO - validate step: 100  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,517
[rank2]:2025-10-28 07:04:50,976 - INFO - validate step: 100  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,510
[rank3]:2025-10-28 07:04:51,042 - INFO - validate step: 100  loss:  2.0147  memory: 38.93GiB(81.95%)  tps: 5,688
[rank2]:2025-10-28 07:04:51,123 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251028_0704_stage2_step100.svg
[rank0]:2025-10-28 07:04:51,126 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251028_0704_stage0_step100.svg
[rank1]:2025-10-28 07:04:51,124 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251028_0704_stage1_step100.svg
[rank3]:2025-10-28 07:04:51,273 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251028_0704_real_step100_rank3.svg
[rank3]:> Batch Time: 1912.16 ms, GPU Bubble Ratio: 56.66%, 48.92%, 64.95%, 15.25%
[rank3]:2025-10-28 07:04:51,337 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251028_0704_stage3_step100.svg
[rank3]:2025-10-28 07:05:10,647 - INFO - [Step 105] âœ”ï¸  Setting Upperbound
[rank3]:2025-10-28 07:05:11,466 - INFO - [Step 105] ã€°ï¸ Monitoring Lowerbound
[rank2]:2025-10-28 07:05:11,536 - WARNING - Batch index 211 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-28 07:05:11,553 - WARNING - Batch index 211 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-28 07:05:11,535 - WARNING - Batch index 211 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-28 07:05:11,551 - WARNING - Batch index 211 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-28 07:05:11,563 - WARNING - Batch index 211 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-28 07:05:11,614 - WARNING - Batch index 211 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-28 07:05:11,546 - WARNING - Batch index 211 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-28 07:05:11,587 - WARNING - Batch index 211 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-28 07:05:11,718 - WARNING - Batch index 211 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-28 07:05:11,817 - WARNING - Batch index 211 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-28 07:05:14,075 - WARNING - Batch index 211 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-28 07:05:14,090 - WARNING - Batch index 211 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-28 07:05:14,106 - WARNING - Batch index 211 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-28 07:05:14,118 - WARNING - Batch index 211 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-28 07:05:14,127 - WARNING - Batch index 211 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-28 07:05:14,153 - WARNING - Batch index 211 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-28 07:05:14,239 - WARNING - Batch index 211 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-28 07:05:14,226 - WARNING - Batch index 211 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-28 07:05:14,318 - WARNING - Batch index 211 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-28 07:05:14,391 - WARNING - Batch index 211 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-28 07:05:14,404 - WARNING - Batch index 211 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-28 07:05:14,484 - WARNING - Batch index 211 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-28 07:05:14,559 - WARNING - Batch index 211 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-28 07:05:14,574 - WARNING - Batch index 211 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-28 07:05:14,814 - WARNING - Batch index 211 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-28 07:05:14,877 - WARNING - Batch index 211 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-28 07:05:14,939 - WARNING - Batch index 211 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-28 07:05:15,004 - WARNING - Batch index 211 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-28 07:05:14,995 - WARNING - Batch index 211 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-28 07:05:15,072 - WARNING - Batch index 211 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-28 07:05:15,133 - WARNING - Batch index 211 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-28 07:05:15,194 - WARNING - Batch index 211 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-28 07:05:43,466 - INFO - [Step 115] âœ”ï¸  Setting Lowerbound
[rank3]:2025-10-28 07:05:44,370 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251028_0705_max_batch_time.svg
[rank3]:> Batch Time: 1911.28 ms, GPU Bubble Ratio: 56.55%, 48.55%, 64.98%, 15.34%
[rank3]:2025-10-28 07:05:44,567 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251028_0705_min_batch_time.svg
[rank3]:> Batch Time: 1284.16 ms, GPU Bubble Ratio: 71.43%, 45.59%, 63.22%, 13.39%
[rank3]:2025-10-28 07:05:44,770 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251028_0705_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 1284.16 ms, GPU Bubble Ratio: 43.07%, 31.24%, 49.85%, 13.39%
[rank3]:2025-10-28 07:05:44,771 - INFO - 	> Batch Time: 1284.16 ms (Average Freeze Ratio: 0.42, Time Reduction Rate: 0.33)
[rank2]:2025-10-28 07:06:00,619 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-28 07:06:00,619 - INFO -  step: 120  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,353  tflops: 17.92  mfu: 5.74%
[rank0]:2025-10-28 07:06:00,619 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.69/0.69, [MB7] 1.00/1.00
[rank0]:2025-10-28 07:06:00,620 - INFO -  step: 120  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,347  tflops: 17.88  mfu: 5.73%
[rank1]:2025-10-28 07:06:00,620 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.12/0.12, [MB1] 0.15/0.15, [MB2] 0.20/0.20, [MB3] 0.01/0.01, [MB4] 0.00/0.00, [MB5] 0.40/0.40, [MB6] 0.92/0.92, [MB7] 1.00/1.00
[rank1]:2025-10-28 07:06:00,621 - INFO -  step: 120  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,350  tflops: 17.90  mfu: 5.74%
[rank3]:2025-10-28 07:06:03,045 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-28 07:06:03,048 - INFO -  step: 120  loss:  2.5047  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,275  tflops: 17.33  mfu: 5.55%
[rank3]:2025-10-28 07:06:04,255 - INFO - Avg. fwd time: 71.9570 / Avg. bwd time: 121.2762 / Avg. batch time: 1601.0197 (ms) / GPU bubble ratio: 3.44%
[rank2]:2025-10-28 07:06:04,287 - INFO - Avg. fwd time: 32.6861 / Avg. bwd time: 48.5942 / Avg. batch time: 1729.1560 (ms) / GPU bubble ratio: 62.40%
[rank0]:2025-10-28 07:06:04,331 - INFO - Avg. fwd time: 45.3776 / Avg. bwd time: 50.8548 / Avg. batch time: 1929.0228 (ms) / GPU bubble ratio: 60.09%
[rank1]:2025-10-28 07:06:04,327 - INFO - Avg. fwd time: 50.8344 / Avg. bwd time: 65.9299 / Avg. batch time: 1840.6471 (ms) / GPU bubble ratio: 49.25%
[rank2]:2025-10-28 07:07:03,991 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251028_0707_rank2_trend_line.svg
[rank2]:2025-10-28 07:07:04,014 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank2]:2025-10-28 07:07:04,015 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank2]:2025-10-28 07:07:04,016 - INFO -  step: 140  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,584  tflops: 19.68  mfu: 6.31%
[rank0]:2025-10-28 07:07:04,007 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251028_0707_rank0_trend_line.svg
[rank0]:2025-10-28 07:07:04,015 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank0]:2025-10-28 07:07:04,016 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank0]:2025-10-28 07:07:04,016 - INFO -  step: 140  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,584  tflops: 19.68  mfu: 6.31%
[rank1]:2025-10-28 07:07:04,008 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251028_0707_rank1_trend_line.svg
[rank1]:2025-10-28 07:07:04,014 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank1]:2025-10-28 07:07:04,016 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank1]:2025-10-28 07:07:04,016 - INFO -  step: 140  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,584  tflops: 19.68  mfu: 6.31%
[rank3]:2025-10-28 07:07:03,990 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251028_0707_rank3_trend_line.svg
[rank3]:2025-10-28 07:07:04,202 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251028_0707_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 1283.51 ms, GPU Bubble Ratio: 71.41%, 45.53%, 63.15%, 13.39%
[rank3]:2025-10-28 07:07:04,203 - INFO - 	> Batch Time: 1283.51 ms (Average Freeze Ratio: 0.25)
[rank3]:2025-10-28 07:07:04,203 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-28 07:07:06,588 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-28 07:07:06,591 - INFO -  step: 140  loss:  4.9506  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,578  tflops: 19.64  mfu: 6.29%
[rank0]:2025-10-28 07:07:38,413 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-28 07:08:19,732 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251028_0708_rank2_trend_line.svg
[rank0]:2025-10-28 07:08:19,761 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251028_0708_rank0_trend_line.svg
[rank0]:2025-10-28 07:08:19,768 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-28 07:08:19,769 - INFO -  step: 160  loss: -2.0000  grad_norm:  2.9517  memory: 20.89GiB(43.97%)  tps: 2,163  tflops: 16.47  mfu: 5.28%
[rank1]:2025-10-28 07:08:19,737 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251028_0708_rank1_trend_line.svg
[rank1]:2025-10-28 07:08:19,767 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.23/0.23, [MB7] 1.00/1.00
[rank1]:2025-10-28 07:08:19,769 - INFO -  step: 160  loss: -2.0000  grad_norm:  2.9517  memory: 20.03GiB(42.17%)  tps: 2,163  tflops: 16.47  mfu: 5.28%
[rank3]:2025-10-28 07:08:19,721 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251028_0708_rank3_trend_line.svg
[rank2]:2025-10-28 07:08:19,767 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-28 07:08:19,769 - INFO -  step: 160  loss: -2.0000  grad_norm:  2.9517  memory: 16.10GiB(33.90%)  tps: 2,163  tflops: 16.47  mfu: 5.28%
[rank3]:2025-10-28 07:08:19,968 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251028_0708_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 1274.10 ms, GPU Bubble Ratio: 55.98%, 32.21%, 56.03%, 12.85%
[rank3]:2025-10-28 07:08:19,969 - INFO - 	> Batch Time: 1274.10 ms (Average Freeze Ratio: 0.35)
[rank3]:2025-10-28 07:08:19,969 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-28 07:08:22,461 - INFO -  step: 160  loss:  2.5144  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,160  tflops: 16.45  mfu: 5.27%
[rank3]:2025-10-28 07:08:23,656 - INFO - Avg. fwd time: 72.0187 / Avg. bwd time: 107.5359 / Avg. batch time: 1489.3520 (ms) / GPU bubble ratio: 3.55%
[rank2]:2025-10-28 07:08:23,844 - INFO - Avg. fwd time: 32.6894 / Avg. bwd time: 46.9971 / Avg. batch time: 1679.1017 (ms) / GPU bubble ratio: 62.03%
[rank1]:2025-10-28 07:08:23,965 - INFO - Avg. fwd time: 50.8474 / Avg. bwd time: 64.5455 / Avg. batch time: 1793.1927 (ms) / GPU bubble ratio: 48.52%
[rank0]:2025-10-28 07:08:24,021 - INFO - Avg. fwd time: 45.3294 / Avg. bwd time: 45.9939 / Avg. batch time: 1876.3817 (ms) / GPU bubble ratio: 61.06%
[rank0]:2025-10-28 07:09:23,351 - INFO -  step: 180  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,577  tflops: 19.63  mfu: 6.29%
[rank1]:2025-10-28 07:09:23,351 - INFO -  step: 180  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,577  tflops: 19.63  mfu: 6.29%
[rank2]:2025-10-28 07:09:23,350 - INFO -  step: 180  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,577  tflops: 19.63  mfu: 6.29%
[rank3]:2025-10-28 07:09:25,757 - INFO -  step: 180  loss:  4.2109  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,589  tflops: 19.72  mfu: 6.32%
[rank0]:2025-10-28 07:10:23,715 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-28 07:10:26,506 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251028_0710_rank2_trend_line.svg
[rank0]:2025-10-28 07:10:26,525 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251028_0710_rank0_trend_line.svg
[rank0]:2025-10-28 07:10:26,533 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-28 07:10:26,535 - INFO -  step: 200  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,593  tflops: 19.75  mfu: 6.33%
[rank0]:2025-10-28 07:10:26,535 - INFO - ðŸ”Ž  Running validation at step 200
[rank1]:2025-10-28 07:10:26,526 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251028_0710_rank1_trend_line.svg
[rank1]:2025-10-28 07:10:26,533 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-10-28 07:10:26,535 - INFO -  step: 200  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,593  tflops: 19.75  mfu: 6.33%
[rank1]:2025-10-28 07:10:26,535 - INFO - ðŸ”Ž  Running validation at step 200
[rank3]:2025-10-28 07:10:26,505 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251028_0710_rank3_trend_line.svg
[rank2]:2025-10-28 07:10:26,533 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-28 07:10:26,535 - INFO -  step: 200  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,593  tflops: 19.75  mfu: 6.33%
[rank2]:2025-10-28 07:10:26,535 - INFO - ðŸ”Ž  Running validation at step 200
[rank3]:2025-10-28 07:10:26,726 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251028_0710_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 1276.58 ms, GPU Bubble Ratio: 61.38%, 36.97%, 58.36%, 13.17%
[rank3]:2025-10-28 07:10:26,727 - INFO - 	> Batch Time: 1276.58 ms (Average Freeze Ratio: 0.34)
[rank3]:2025-10-28 07:10:26,727 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-28 07:10:29,141 - INFO -  step: 200  loss:  2.4702  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,585  tflops: 19.69  mfu: 6.31%
[rank3]:2025-10-28 07:10:29,142 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-10-28 07:11:37,757 - INFO - validate step: 200  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,751
[rank1]:2025-10-28 07:11:37,841 - INFO - validate step: 200  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,744
[rank2]:2025-10-28 07:11:37,924 - INFO - validate step: 200  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,738
[rank3]:2025-10-28 07:11:37,985 - INFO - validate step: 200  loss:  1.8256  memory: 38.93GiB(81.95%)  tps: 5,950
[rank2]:2025-10-28 07:11:38,066 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251028_0711_stage2_step200.svg
[rank0]:2025-10-28 07:11:38,064 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251028_0711_stage0_step200.svg
[rank1]:2025-10-28 07:11:38,067 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251028_0711_stage1_step200.svg
[rank3]:2025-10-28 07:11:38,191 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251028_0711_real_step200_rank3.svg
[rank3]:> Batch Time: 1876.44 ms, GPU Bubble Ratio: 56.80%, 49.19%, 64.81%, 15.28%
[rank3]:2025-10-28 07:11:38,261 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251028_0711_stage3_step200.svg
[rank3]:2025-10-28 07:11:39,452 - INFO - Avg. fwd time: 71.9297 / Avg. bwd time: 99.2142 / Avg. batch time: 1421.0581 (ms) / GPU bubble ratio: 3.65%
[rank2]:2025-10-28 07:11:39,483 - INFO - Avg. fwd time: 32.6673 / Avg. bwd time: 42.9941 / Avg. batch time: 1626.0767 (ms) / GPU bubble ratio: 62.78%
[rank0]:2025-10-28 07:11:39,527 - INFO - Avg. fwd time: 45.1540 / Avg. bwd time: 36.8185 / Avg. batch time: 1807.3098 (ms) / GPU bubble ratio: 63.72%
[rank1]:2025-10-28 07:11:39,523 - INFO - Avg. fwd time: 51.1226 / Avg. bwd time: 58.8479 / Avg. batch time: 1733.7203 (ms) / GPU bubble ratio: 49.26%
[rank2]:2025-10-28 07:12:39,223 - INFO -  step: 220  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,673  tflops: 20.36  mfu: 6.52%
[rank0]:2025-10-28 07:12:39,223 - INFO -  step: 220  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,666  tflops: 20.30  mfu: 6.51%
[rank1]:2025-10-28 07:12:39,223 - INFO -  step: 220  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,669  tflops: 20.33  mfu: 6.52%
[rank3]:2025-10-28 07:12:41,666 - INFO -  step: 220  loss:  4.3395  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,573  tflops: 19.60  mfu: 6.28%
[rank2]:2025-10-28 07:13:42,533 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251028_0713_rank2_trend_line.svg
[rank2]:2025-10-28 07:13:42,562 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-28 07:13:42,564 - INFO -  step: 240  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,587  tflops: 19.70  mfu: 6.31%
[rank3]:2025-10-28 07:13:42,532 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251028_0713_rank3_trend_line.svg
[rank1]:2025-10-28 07:13:42,556 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251028_0713_rank1_trend_line.svg
[rank1]:2025-10-28 07:13:42,562 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-10-28 07:13:42,564 - INFO -  step: 240  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,587  tflops: 19.70  mfu: 6.31%
[rank0]:2025-10-28 07:13:42,554 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251028_0713_rank0_trend_line.svg
[rank0]:2025-10-28 07:13:42,562 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-28 07:13:42,564 - INFO -  step: 240  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,587  tflops: 19.70  mfu: 6.31%
[rank3]:2025-10-28 07:13:42,757 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251028_0713_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 1279.63 ms, GPU Bubble Ratio: 64.77%, 40.06%, 59.96%, 13.32%
[rank3]:2025-10-28 07:13:42,758 - INFO - 	> Batch Time: 1279.63 ms (Average Freeze Ratio: 0.34)
[rank3]:2025-10-28 07:13:42,758 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-28 07:13:45,153 - INFO -  step: 240  loss:  2.4443  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,581  tflops: 19.66  mfu: 6.30%
[rank2]:2025-10-28 07:13:46,383 - INFO - Avg. fwd time: 32.6690 / Avg. bwd time: 40.3278 / Avg. batch time: 1596.9274 (ms) / GPU bubble ratio: 63.43%
[rank3]:2025-10-28 07:13:46,351 - INFO - Avg. fwd time: 71.9162 / Avg. bwd time: 93.7460 / Avg. batch time: 1376.6453 (ms) / GPU bubble ratio: 3.73%
[rank1]:2025-10-28 07:13:46,424 - INFO - Avg. fwd time: 51.2626 / Avg. bwd time: 55.0207 / Avg. batch time: 1700.2684 (ms) / GPU bubble ratio: 49.99%
[rank0]:2025-10-28 07:13:46,428 - INFO - Avg. fwd time: 45.0932 / Avg. bwd time: 30.6951 / Avg. batch time: 1767.4706 (ms) / GPU bubble ratio: 65.70%
[rank0]:2025-10-28 07:14:11,631 - INFO - [GC] Peforming periodical GC collection 0.02 seconds
[rank2]:2025-10-28 07:14:45,828 - INFO -  step: 260  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,590  tflops: 19.72  mfu: 6.32%
[rank1]:2025-10-28 07:14:45,828 - INFO -  step: 260  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,590  tflops: 19.72  mfu: 6.32%
[rank0]:2025-10-28 07:14:45,828 - INFO -  step: 260  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,590  tflops: 19.72  mfu: 6.32%
[rank3]:2025-10-28 07:14:48,221 - INFO -  step: 260  loss:  4.3389  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,598  tflops: 19.79  mfu: 6.34%
[rank1]:2025-10-28 07:15:49,196 - INFO -  step: 280  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,586  tflops: 19.69  mfu: 6.31%
[rank2]:2025-10-28 07:15:49,196 - INFO -  step: 280  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,586  tflops: 19.69  mfu: 6.31%
[rank0]:2025-10-28 07:15:49,196 - INFO -  step: 280  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,586  tflops: 19.69  mfu: 6.31%
[rank3]:2025-10-28 07:15:51,593 - INFO -  step: 280  loss:  2.4549  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,585  tflops: 19.69  mfu: 6.31%
[rank3]:2025-10-28 07:15:52,794 - INFO - Avg. fwd time: 71.9287 / Avg. bwd time: 89.8179 / Avg. batch time: 1344.8259 (ms) / GPU bubble ratio: 3.78%
[rank2]:2025-10-28 07:15:52,826 - INFO - Avg. fwd time: 32.6697 / Avg. bwd time: 38.4148 / Avg. batch time: 1575.5166 (ms) / GPU bubble ratio: 63.91%
[rank1]:2025-10-28 07:15:52,867 - INFO - Avg. fwd time: 51.3038 / Avg. bwd time: 52.2941 / Avg. batch time: 1675.7487 (ms) / GPU bubble ratio: 50.54%
[rank0]:2025-10-28 07:15:52,871 - INFO - Avg. fwd time: 44.9937 / Avg. bwd time: 26.3182 / Avg. batch time: 1738.3868 (ms) / GPU bubble ratio: 67.18%
[rank0]:2025-10-28 07:16:49,626 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-28 07:16:52,285 - INFO -  step: 300  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,597  tflops: 19.78  mfu: 6.34%
[rank2]:2025-10-28 07:16:52,285 - INFO - ðŸ”Ž  Running validation at step 300
[rank1]:2025-10-28 07:16:52,285 - INFO -  step: 300  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,597  tflops: 19.78  mfu: 6.34%
[rank1]:2025-10-28 07:16:52,286 - INFO - ðŸ”Ž  Running validation at step 300
[rank0]:2025-10-28 07:16:52,286 - INFO -  step: 300  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,597  tflops: 19.78  mfu: 6.34%
[rank0]:2025-10-28 07:16:52,286 - INFO - ðŸ”Ž  Running validation at step 300
[rank3]:2025-10-28 07:16:54,762 - INFO -  step: 300  loss:  4.4052  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,594  tflops: 19.75  mfu: 6.33%
[rank3]:2025-10-28 07:16:54,762 - INFO - ðŸ”Ž  Running validation at step 300
[rank0]:2025-10-28 07:18:03,565 - INFO - validate step: 300  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,746
[rank1]:2025-10-28 07:18:03,650 - INFO - validate step: 300  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,740
[rank3]:2025-10-28 07:18:03,796 - INFO - validate step: 300  loss:  1.8194  memory: 38.93GiB(81.95%)  tps: 5,934
[rank2]:2025-10-28 07:18:03,735 - INFO - validate step: 300  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,733
[rank1]:2025-10-28 07:18:03,876 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251028_0718_stage1_step300.svg
[rank2]:2025-10-28 07:18:03,876 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251028_0718_stage2_step300.svg
[rank0]:2025-10-28 07:18:03,877 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251028_0718_stage0_step300.svg
[rank3]:2025-10-28 07:18:03,995 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251028_0718_real_step300_rank3.svg
[rank3]:> Batch Time: 1297.06 ms, GPU Bubble Ratio: 71.97%, 44.97%, 63.24%, 13.63%
[rank3]:2025-10-28 07:18:04,062 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251028_0718_stage3_step300.svg
[rank3]:2025-10-28 07:19:05,136 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251028_0719_rank3_trend_line.svg
[rank2]:2025-10-28 07:19:05,152 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251028_0719_rank2_trend_line.svg
[rank2]:2025-10-28 07:19:05,173 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-28 07:19:05,175 - INFO -  step: 320  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,667  tflops: 20.31  mfu: 6.51%
[rank1]:2025-10-28 07:19:05,165 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251028_0719_rank1_trend_line.svg
[rank1]:2025-10-28 07:19:05,172 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-10-28 07:19:05,174 - INFO -  step: 320  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,663  tflops: 20.28  mfu: 6.50%
[rank0]:2025-10-28 07:19:05,166 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251028_0719_rank0_trend_line.svg
[rank0]:2025-10-28 07:19:05,172 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-28 07:19:05,174 - INFO -  step: 320  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,659  tflops: 20.25  mfu: 6.49%
[rank3]:2025-10-28 07:19:05,369 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251028_0719_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 1281.57 ms, GPU Bubble Ratio: 67.45%, 42.37%, 61.24%, 13.40%
[rank3]:2025-10-28 07:19:05,370 - INFO - 	> Batch Time: 1281.57 ms (Average Freeze Ratio: 0.34)
[rank3]:2025-10-28 07:19:05,370 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-28 07:19:07,800 - INFO -  step: 320  loss:  2.4817  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,560  tflops: 19.50  mfu: 6.25%
[rank3]:2025-10-28 07:19:08,993 - INFO - Avg. fwd time: 71.9152 / Avg. bwd time: 86.8841 / Avg. batch time: 1320.8650 (ms) / GPU bubble ratio: 3.82%
[rank2]:2025-10-28 07:19:09,025 - INFO - Avg. fwd time: 32.6602 / Avg. bwd time: 36.9909 / Avg. batch time: 1556.2364 (ms) / GPU bubble ratio: 64.20%
[rank1]:2025-10-28 07:19:09,065 - INFO - Avg. fwd time: 51.3584 / Avg. bwd time: 50.2524 / Avg. batch time: 1654.2076 (ms) / GPU bubble ratio: 50.86%
[rank0]:2025-10-28 07:19:09,069 - INFO - Avg. fwd time: 44.9651 / Avg. bwd time: 23.0338 / Avg. batch time: 1713.4359 (ms) / GPU bubble ratio: 68.25%
[rank0]:2025-10-28 07:20:08,411 - INFO -  step: 340  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,591  tflops: 19.73  mfu: 6.32%
[rank1]:2025-10-28 07:20:08,410 - INFO -  step: 340  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,591  tflops: 19.73  mfu: 6.32%
[rank2]:2025-10-28 07:20:08,410 - INFO -  step: 340  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,591  tflops: 19.73  mfu: 6.32%
[rank3]:2025-10-28 07:20:10,796 - INFO -  step: 340  loss:  4.3426  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,601  tflops: 19.81  mfu: 6.35%
[rank0]:2025-10-28 07:20:37,196 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-28 07:21:11,559 - INFO -  step: 360  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,595  tflops: 19.76  mfu: 6.33%
[rank1]:2025-10-28 07:21:11,559 - INFO -  step: 360  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,595  tflops: 19.76  mfu: 6.33%
[rank0]:2025-10-28 07:21:11,560 - INFO -  step: 360  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,595  tflops: 19.76  mfu: 6.33%
[rank3]:2025-10-28 07:21:13,953 - INFO -  step: 360  loss:  2.5000  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,594  tflops: 19.76  mfu: 6.33%
[rank3]:2025-10-28 07:21:15,144 - INFO - Avg. fwd time: 71.9113 / Avg. bwd time: 84.5550 / Avg. batch time: 1301.9018 (ms) / GPU bubble ratio: 3.85%
[rank2]:2025-10-28 07:21:15,175 - INFO - Avg. fwd time: 32.6433 / Avg. bwd time: 35.8742 / Avg. batch time: 1543.5946 (ms) / GPU bubble ratio: 64.49%
[rank1]:2025-10-28 07:21:15,214 - INFO - Avg. fwd time: 51.3540 / Avg. bwd time: 48.6581 / Avg. batch time: 1639.8318 (ms) / GPU bubble ratio: 51.21%
[rank0]:2025-10-28 07:21:15,218 - INFO - Avg. fwd time: 44.8947 / Avg. bwd time: 20.4783 / Avg. batch time: 1696.3903 (ms) / GPU bubble ratio: 69.17%
[rank2]:2025-10-28 07:22:14,446 - INFO -  step: 380  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,605  tflops: 19.84  mfu: 6.36%
[rank1]:2025-10-28 07:22:14,447 - INFO -  step: 380  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,605  tflops: 19.84  mfu: 6.36%
[rank0]:2025-10-28 07:22:14,447 - INFO -  step: 380  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,605  tflops: 19.84  mfu: 6.36%
[rank3]:2025-10-28 07:22:16,918 - INFO -  step: 380  loss:  4.3578  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,602  tflops: 19.82  mfu: 6.35%
[rank0]:2025-10-28 07:23:14,995 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-28 07:23:17,720 - INFO -  step: 400  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,589  tflops: 19.72  mfu: 6.32%
[rank2]:2025-10-28 07:23:17,720 - INFO - ðŸ”Ž  Running validation at step 400
[rank1]:2025-10-28 07:23:17,720 - INFO -  step: 400  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,589  tflops: 19.72  mfu: 6.32%
[rank1]:2025-10-28 07:23:17,720 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-10-28 07:23:17,720 - INFO -  step: 400  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,589  tflops: 19.72  mfu: 6.32%
[rank0]:2025-10-28 07:23:17,721 - INFO - ðŸ”Ž  Running validation at step 400
[rank3]:2025-10-28 07:23:20,094 - INFO -  step: 400  loss:  2.5052  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,593  tflops: 19.75  mfu: 6.33%
[rank3]:2025-10-28 07:23:20,094 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-10-28 07:24:29,034 - INFO - validate step: 400  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,744
[rank1]:2025-10-28 07:24:29,120 - INFO - validate step: 400  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,737
[rank2]:2025-10-28 07:24:29,203 - INFO - validate step: 400  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,730
[rank3]:2025-10-28 07:24:29,265 - INFO - validate step: 400  loss:  1.8030  memory: 38.93GiB(81.95%)  tps: 5,922
[rank0]:2025-10-28 07:24:29,347 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251028_0724_stage0_step400.svg
[rank2]:2025-10-28 07:24:29,348 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251028_0724_stage2_step400.svg
[rank1]:2025-10-28 07:24:29,348 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251028_0724_stage1_step400.svg
[rank3]:2025-10-28 07:24:29,454 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251028_0724_real_step400_rank3.svg
[rank3]:> Batch Time: 1291.83 ms, GPU Bubble Ratio: 71.95%, 45.17%, 63.25%, 13.58%
[rank3]:2025-10-28 07:24:29,526 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251028_0724_stage3_step400.svg
[rank3]:2025-10-28 07:24:30,758 - INFO - Avg. fwd time: 71.8989 / Avg. bwd time: 82.7135 / Avg. batch time: 1286.9242 (ms) / GPU bubble ratio: 3.89%
[rank2]:2025-10-28 07:24:30,791 - INFO - Avg. fwd time: 32.6277 / Avg. bwd time: 34.9801 / Avg. batch time: 1530.8468 (ms) / GPU bubble ratio: 64.67%
[rank1]:2025-10-28 07:24:30,830 - INFO - Avg. fwd time: 51.3758 / Avg. bwd time: 47.3863 / Avg. batch time: 1625.6230 (ms) / GPU bubble ratio: 51.40%
[rank0]:2025-10-28 07:24:30,834 - INFO - Avg. fwd time: 44.8589 / Avg. bwd time: 18.4332 / Avg. batch time: 1680.0364 (ms) / GPU bubble ratio: 69.86%
[rank2]:2025-10-28 07:25:30,972 - INFO -  step: 420  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,652  tflops: 20.20  mfu: 6.47%
[rank1]:2025-10-28 07:25:30,973 - INFO -  step: 420  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,649  tflops: 20.17  mfu: 6.47%
[rank0]:2025-10-28 07:25:30,972 - INFO -  step: 420  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,645  tflops: 20.15  mfu: 6.46%
[rank3]:2025-10-28 07:25:33,420 - INFO -  step: 420  loss:  4.2713  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,554  tflops: 19.45  mfu: 6.23%
[rank1]:2025-10-28 07:26:34,536 - INFO -  step: 440  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,578  tflops: 19.63  mfu: 6.29%
[rank2]:2025-10-28 07:26:34,536 - INFO -  step: 440  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,578  tflops: 19.63  mfu: 6.29%
[rank0]:2025-10-28 07:26:34,536 - INFO -  step: 440  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,578  tflops: 19.63  mfu: 6.29%
[rank3]:2025-10-28 07:26:36,949 - INFO -  step: 440  loss:  2.4447  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,579  tflops: 19.64  mfu: 6.30%
[rank3]:2025-10-28 07:26:38,160 - INFO - Avg. fwd time: 71.9700 / Avg. bwd time: 81.2447 / Avg. batch time: 1275.5995 (ms) / GPU bubble ratio: 3.91%
[rank2]:2025-10-28 07:26:38,193 - INFO - Avg. fwd time: 32.6284 / Avg. bwd time: 34.2492 / Avg. batch time: 1524.2381 (ms) / GPU bubble ratio: 64.90%
[rank1]:2025-10-28 07:26:38,232 - INFO - Avg. fwd time: 51.4540 / Avg. bwd time: 46.3590 / Avg. batch time: 1617.8778 (ms) / GPU bubble ratio: 51.63%
[rank0]:2025-10-28 07:26:38,236 - INFO - Avg. fwd time: 44.8578 / Avg. bwd time: 16.7596 / Avg. batch time: 1670.5617 (ms) / GPU bubble ratio: 70.49%
[rank0]:2025-10-28 07:27:03,551 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-28 07:27:37,834 - INFO -  step: 460  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,588  tflops: 19.71  mfu: 6.32%
[rank2]:2025-10-28 07:27:37,833 - INFO -  step: 460  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,588  tflops: 19.71  mfu: 6.32%
[rank0]:2025-10-28 07:27:37,834 - INFO -  step: 460  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,588  tflops: 19.71  mfu: 6.32%
[rank3]:2025-10-28 07:27:40,241 - INFO -  step: 460  loss:  4.3944  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,589  tflops: 19.72  mfu: 6.32%
[rank0]:2025-10-28 07:28:40,873 - INFO -  step: 480  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,599  tflops: 19.79  mfu: 6.34%
[rank2]:2025-10-28 07:28:40,872 - INFO -  step: 480  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,599  tflops: 19.79  mfu: 6.34%
[rank1]:2025-10-28 07:28:40,872 - INFO -  step: 480  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,599  tflops: 19.79  mfu: 6.34%
[rank3]:2025-10-28 07:28:43,280 - INFO -  step: 480  loss:  2.4949  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,599  tflops: 19.80  mfu: 6.34%
[rank3]:2025-10-28 07:28:44,476 - INFO - Avg. fwd time: 71.9390 / Avg. bwd time: 79.9871 / Avg. batch time: 1265.2026 (ms) / GPU bubble ratio: 3.94%
[rank2]:2025-10-28 07:28:44,507 - INFO - Avg. fwd time: 32.6261 / Avg. bwd time: 33.6402 / Avg. batch time: 1517.6702 (ms) / GPU bubble ratio: 65.07%
[rank1]:2025-10-28 07:28:44,547 - INFO - Avg. fwd time: 51.4838 / Avg. bwd time: 45.4902 / Avg. batch time: 1610.2971 (ms) / GPU bubble ratio: 51.82%
[rank0]:2025-10-28 07:28:44,551 - INFO - Avg. fwd time: 44.8262 / Avg. bwd time: 15.3646 / Avg. batch time: 1661.5169 (ms) / GPU bubble ratio: 71.02%
[rank0]:2025-10-28 07:29:41,250 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-28 07:29:43,927 - INFO -  step: 500  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,598  tflops: 19.79  mfu: 6.34%
[rank1]:2025-10-28 07:29:43,927 - INFO - ðŸ”Ž  Running validation at step 500
[rank2]:2025-10-28 07:29:43,927 - INFO -  step: 500  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,598  tflops: 19.79  mfu: 6.34%
[rank2]:2025-10-28 07:29:43,927 - INFO - ðŸ”Ž  Running validation at step 500
[rank0]:2025-10-28 07:29:43,927 - INFO -  step: 500  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,598  tflops: 19.79  mfu: 6.34%
[rank0]:2025-10-28 07:29:43,928 - INFO - ðŸ”Ž  Running validation at step 500
[rank3]:2025-10-28 07:29:46,417 - INFO -  step: 500  loss:  4.3771  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,595  tflops: 19.76  mfu: 6.33%
[rank3]:2025-10-28 07:29:46,417 - INFO - ðŸ”Ž  Running validation at step 500
[rank0]:2025-10-28 07:30:55,104 - INFO - validate step: 500  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,755
[rank1]:2025-10-28 07:30:55,186 - INFO - validate step: 500  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,748
[rank2]:2025-10-28 07:30:55,267 - INFO - validate step: 500  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,742
[rank3]:2025-10-28 07:30:55,330 - INFO - validate step: 500  loss:  1.8244  memory: 38.93GiB(81.95%)  tps: 5,944
[rank1]:2025-10-28 07:30:55,406 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251028_0730_stage1_step500.svg
[rank0]:2025-10-28 07:30:55,405 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251028_0730_stage0_step500.svg
[rank2]:2025-10-28 07:30:55,406 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251028_0730_stage2_step500.svg
[rank3]:2025-10-28 07:30:55,514 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251028_0730_real_step500_rank3.svg
[rank3]:> Batch Time: 1290.10 ms, GPU Bubble Ratio: 71.95%, 45.22%, 63.24%, 13.57%
[rank3]:2025-10-28 07:30:55,579 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251028_0730_stage3_step500.svg
[rank2]:2025-10-28 07:31:56,861 - INFO -  step: 520  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,660  tflops: 20.26  mfu: 6.49%
[rank1]:2025-10-28 07:31:56,861 - INFO -  step: 520  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,657  tflops: 20.23  mfu: 6.48%
[rank0]:2025-10-28 07:31:56,862 - INFO -  step: 520  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,653  tflops: 20.21  mfu: 6.48%
[rank3]:2025-10-28 07:31:59,279 - INFO -  step: 520  loss:  2.4327  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,562  tflops: 19.51  mfu: 6.25%
[rank3]:2025-10-28 07:32:00,472 - INFO - Avg. fwd time: 71.9627 / Avg. bwd time: 78.9247 / Avg. batch time: 1256.7929 (ms) / GPU bubble ratio: 3.95%
[rank2]:2025-10-28 07:32:00,503 - INFO - Avg. fwd time: 32.6245 / Avg. bwd time: 33.1253 / Avg. batch time: 1510.3254 (ms) / GPU bubble ratio: 65.17%
[rank1]:2025-10-28 07:32:00,544 - INFO - Avg. fwd time: 51.5054 / Avg. bwd time: 44.7575 / Avg. batch time: 1602.1389 (ms) / GPU bubble ratio: 51.93%
[rank0]:2025-10-28 07:32:00,548 - INFO - Avg. fwd time: 44.8223 / Avg. bwd time: 14.1839 / Avg. batch time: 1652.1240 (ms) / GPU bubble ratio: 71.43%
[rank1]:2025-10-28 07:33:00,072 - INFO -  step: 540  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,592  tflops: 19.74  mfu: 6.33%
[rank0]:2025-10-28 07:33:00,072 - INFO -  step: 540  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,592  tflops: 19.74  mfu: 6.33%
[rank2]:2025-10-28 07:33:00,071 - INFO -  step: 540  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,592  tflops: 19.74  mfu: 6.33%
[rank3]:2025-10-28 07:33:02,493 - INFO -  step: 540  loss:  4.3925  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,592  tflops: 19.74  mfu: 6.33%
[rank0]:2025-10-28 07:33:28,994 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-28 07:34:03,288 - INFO -  step: 560  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,592  tflops: 19.74  mfu: 6.33%
[rank2]:2025-10-28 07:34:03,287 - INFO -  step: 560  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,592  tflops: 19.74  mfu: 6.33%
[rank1]:2025-10-28 07:34:03,288 - INFO -  step: 560  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,592  tflops: 19.74  mfu: 6.33%
[rank3]:2025-10-28 07:34:05,674 - INFO -  step: 560  loss:  2.4713  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,593  tflops: 19.75  mfu: 6.33%
[rank3]:2025-10-28 07:34:06,876 - INFO - Avg. fwd time: 71.9549 / Avg. bwd time: 78.0144 / Avg. batch time: 1249.3785 (ms) / GPU bubble ratio: 3.97%
[rank2]:2025-10-28 07:34:06,909 - INFO - Avg. fwd time: 32.6260 / Avg. bwd time: 32.6837 / Avg. batch time: 1505.7467 (ms) / GPU bubble ratio: 65.30%
[rank1]:2025-10-28 07:34:06,958 - INFO - Avg. fwd time: 51.5357 / Avg. bwd time: 44.1274 / Avg. batch time: 1596.8752 (ms) / GPU bubble ratio: 52.07%
[rank0]:2025-10-28 07:34:06,962 - INFO - Avg. fwd time: 44.8292 / Avg. bwd time: 13.1719 / Avg. batch time: 1645.8083 (ms) / GPU bubble ratio: 71.81%
[rank2]:2025-10-28 07:35:06,391 - INFO -  step: 580  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,596  tflops: 19.77  mfu: 6.34%
[rank1]:2025-10-28 07:35:06,391 - INFO -  step: 580  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,596  tflops: 19.77  mfu: 6.34%
[rank0]:2025-10-28 07:35:06,391 - INFO -  step: 580  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,596  tflops: 19.77  mfu: 6.34%
[rank3]:2025-10-28 07:35:08,798 - INFO -  step: 580  loss:  4.4209  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,596  tflops: 19.77  mfu: 6.34%
[rank0]:2025-10-28 07:36:06,901 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-28 07:36:09,617 - INFO -  step: 600  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,591  tflops: 19.74  mfu: 6.33%
[rank2]:2025-10-28 07:36:09,617 - INFO - ðŸ”Ž  Running validation at step 600
[rank1]:2025-10-28 07:36:09,618 - INFO -  step: 600  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,591  tflops: 19.74  mfu: 6.33%
[rank1]:2025-10-28 07:36:09,618 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-10-28 07:36:09,618 - INFO -  step: 600  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,591  tflops: 19.74  mfu: 6.33%
[rank0]:2025-10-28 07:36:09,618 - INFO - ðŸ”Ž  Running validation at step 600
[rank3]:2025-10-28 07:36:12,000 - INFO -  step: 600  loss:  2.5200  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,592  tflops: 19.74  mfu: 6.33%
[rank3]:2025-10-28 07:36:12,009 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-10-28 07:37:20,472 - INFO - validate step: 600  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,781
[rank1]:2025-10-28 07:37:20,557 - INFO - validate step: 600  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,774
[rank3]:2025-10-28 07:37:20,700 - INFO - validate step: 600  loss:  1.8158  memory: 38.93GiB(81.95%)  tps: 5,963
[rank2]:2025-10-28 07:37:20,639 - INFO - validate step: 600  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,767
[rank2]:2025-10-28 07:37:20,776 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251028_0737_stage2_step600.svg
[rank1]:2025-10-28 07:37:20,777 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251028_0737_stage1_step600.svg
[rank0]:2025-10-28 07:37:20,779 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251028_0737_stage0_step600.svg
[rank3]:2025-10-28 07:37:20,889 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251028_0737_real_step600_rank3.svg
[rank3]:> Batch Time: 1289.35 ms, GPU Bubble Ratio: 71.94%, 45.23%, 63.24%, 13.58%
[rank3]:2025-10-28 07:37:20,958 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251028_0737_stage3_step600.svg
[rank3]:2025-10-28 07:37:22,162 - INFO - Avg. fwd time: 71.9500 / Avg. bwd time: 77.2235 / Avg. batch time: 1242.9624 (ms) / GPU bubble ratio: 3.99%
[rank2]:2025-10-28 07:37:22,194 - INFO - Avg. fwd time: 32.6227 / Avg. bwd time: 32.3008 / Avg. batch time: 1499.8375 (ms) / GPU bubble ratio: 65.37%
[rank0]:2025-10-28 07:37:22,240 - INFO - Avg. fwd time: 44.8206 / Avg. bwd time: 12.2946 / Avg. batch time: 1638.3798 (ms) / GPU bubble ratio: 72.11%
[rank1]:2025-10-28 07:37:22,235 - INFO - Avg. fwd time: 51.5525 / Avg. bwd time: 43.5842 / Avg. batch time: 1590.3616 (ms) / GPU bubble ratio: 52.14%
[rank0]:2025-10-28 07:38:21,932 - INFO -  step: 620  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,666  tflops: 20.30  mfu: 6.51%
[rank2]:2025-10-28 07:38:21,931 - INFO -  step: 620  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,673  tflops: 20.36  mfu: 6.53%
[rank1]:2025-10-28 07:38:21,932 - INFO -  step: 620  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,670  tflops: 20.33  mfu: 6.52%
[rank3]:2025-10-28 07:38:24,356 - INFO -  step: 620  loss:  4.4020  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,574  tflops: 19.60  mfu: 6.28%
[rank3]:2025-10-28 07:39:25,236 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251028_0739_rank3_trend_line.svg
[rank2]:2025-10-28 07:39:25,258 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251028_0739_rank2_trend_line.svg
[rank1]:2025-10-28 07:39:25,279 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251028_0739_rank1_trend_line.svg
[rank1]:2025-10-28 07:39:25,285 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-28 07:39:25,278 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251028_0739_rank0_trend_line.svg
[rank0]:2025-10-28 07:39:25,285 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-28 07:39:25,287 - INFO -  step: 640  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,586  tflops: 19.70  mfu: 6.31%
[rank2]:2025-10-28 07:39:25,285 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-28 07:39:25,287 - INFO -  step: 640  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,586  tflops: 19.70  mfu: 6.31%
[rank1]:2025-10-28 07:39:25,287 - INFO -  step: 640  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,586  tflops: 19.70  mfu: 6.31%
[rank3]:2025-10-28 07:39:25,482 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251028_0739_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 1282.21 ms, GPU Bubble Ratio: 69.88%, 44.34%, 62.41%, 13.45%
[rank3]:2025-10-28 07:39:25,482 - INFO - 	> Batch Time: 1282.21 ms (Average Freeze Ratio: 0.34)
[rank3]:2025-10-28 07:39:25,483 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-28 07:39:27,866 - INFO -  step: 640  loss:  2.4897  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,580  tflops: 19.65  mfu: 6.30%
[rank3]:2025-10-28 07:39:29,034 - INFO - Avg. fwd time: 71.9382 / Avg. bwd time: 76.5301 / Avg. batch time: 1237.2473 (ms) / GPU bubble ratio: 4.00%
[rank2]:2025-10-28 07:39:29,066 - INFO - Avg. fwd time: 32.6143 / Avg. bwd time: 31.9673 / Avg. batch time: 1496.6940 (ms) / GPU bubble ratio: 65.48%
[rank0]:2025-10-28 07:39:29,112 - INFO - Avg. fwd time: 44.8398 / Avg. bwd time: 11.5269 / Avg. batch time: 1633.8733 (ms) / GPU bubble ratio: 72.40%
[rank1]:2025-10-28 07:39:29,108 - INFO - Avg. fwd time: 51.5585 / Avg. bwd time: 43.1032 / Avg. batch time: 1586.6426 (ms) / GPU bubble ratio: 52.27%
[rank0]:2025-10-28 07:39:54,289 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-28 07:40:28,530 - INFO -  step: 660  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,591  tflops: 19.73  mfu: 6.32%
[rank1]:2025-10-28 07:40:28,530 - INFO -  step: 660  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,591  tflops: 19.73  mfu: 6.32%
[rank0]:2025-10-28 07:40:28,530 - INFO -  step: 660  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,591  tflops: 19.73  mfu: 6.32%
[rank3]:2025-10-28 07:40:30,911 - INFO -  step: 660  loss:  4.3928  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,599  tflops: 19.79  mfu: 6.34%
[rank0]:2025-10-28 07:41:31,652 - INFO -  step: 680  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,596  tflops: 19.77  mfu: 6.34%
[rank2]:2025-10-28 07:41:31,652 - INFO -  step: 680  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,596  tflops: 19.77  mfu: 6.34%
[rank1]:2025-10-28 07:41:31,652 - INFO -  step: 680  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,596  tflops: 19.77  mfu: 6.34%
[rank3]:2025-10-28 07:41:34,109 - INFO -  step: 680  loss:  2.4711  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,593  tflops: 19.75  mfu: 6.33%
[rank3]:2025-10-28 07:41:35,278 - INFO - Avg. fwd time: 71.9143 / Avg. bwd time: 75.9180 / Avg. batch time: 1232.1861 (ms) / GPU bubble ratio: 4.02%
[rank2]:2025-10-28 07:41:35,311 - INFO - Avg. fwd time: 32.6100 / Avg. bwd time: 31.6725 / Avg. batch time: 1493.5747 (ms) / GPU bubble ratio: 65.57%
[rank1]:2025-10-28 07:41:35,352 - INFO - Avg. fwd time: 51.5931 / Avg. bwd time: 42.6803 / Avg. batch time: 1583.0610 (ms) / GPU bubble ratio: 52.36%
[rank0]:2025-10-28 07:41:35,356 - INFO - Avg. fwd time: 44.8367 / Avg. bwd time: 10.8495 / Avg. batch time: 1629.5853 (ms) / GPU bubble ratio: 72.66%
[rank0]:2025-10-28 07:42:32,157 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-28 07:42:34,816 - INFO -  step: 700  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,594  tflops: 19.76  mfu: 6.33%
[rank2]:2025-10-28 07:42:34,817 - INFO - ðŸ”Ž  Running validation at step 700
[rank1]:2025-10-28 07:42:34,817 - INFO -  step: 700  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,594  tflops: 19.76  mfu: 6.33%
[rank1]:2025-10-28 07:42:34,817 - INFO - ðŸ”Ž  Running validation at step 700
[rank0]:2025-10-28 07:42:34,817 - INFO -  step: 700  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,594  tflops: 19.76  mfu: 6.33%
[rank0]:2025-10-28 07:42:34,817 - INFO - ðŸ”Ž  Running validation at step 700
[rank3]:2025-10-28 07:42:37,193 - INFO -  step: 700  loss:  4.4219  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,597  tflops: 19.78  mfu: 6.34%
[rank3]:2025-10-28 07:42:37,193 - INFO - ðŸ”Ž  Running validation at step 700
[rank0]:2025-10-28 07:43:46,173 - INFO - validate step: 700  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,740
[rank1]:2025-10-28 07:43:46,260 - INFO - validate step: 700  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,733
[rank2]:2025-10-28 07:43:46,339 - INFO - validate step: 700  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,727
[rank3]:2025-10-28 07:43:46,405 - INFO - validate step: 700  loss:  1.8022  memory: 38.93GiB(81.95%)  tps: 5,918
[rank2]:2025-10-28 07:43:46,492 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251028_0743_stage2_step700.svg
[rank1]:2025-10-28 07:43:46,493 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251028_0743_stage1_step700.svg
[rank0]:2025-10-28 07:43:46,492 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251028_0743_stage0_step700.svg
[rank3]:2025-10-28 07:43:46,608 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251028_0743_real_step700_rank3.svg
[rank3]:> Batch Time: 1288.39 ms, GPU Bubble Ratio: 71.92%, 45.23%, 63.25%, 13.60%
[rank3]:2025-10-28 07:43:46,678 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251028_0743_stage3_step700.svg
[rank1]:2025-10-28 07:44:47,961 - INFO -  step: 720  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,655  tflops: 20.22  mfu: 6.48%
[rank2]:2025-10-28 07:44:47,961 - INFO -  step: 720  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,659  tflops: 20.25  mfu: 6.49%
[rank0]:2025-10-28 07:44:47,961 - INFO -  step: 720  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,652  tflops: 20.20  mfu: 6.47%
[rank3]:2025-10-28 07:44:50,333 - INFO -  step: 720  loss:  2.4841  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,563  tflops: 19.52  mfu: 6.26%
[rank3]:2025-10-28 07:44:51,504 - INFO - Avg. fwd time: 71.9337 / Avg. bwd time: 75.3843 / Avg. batch time: 1227.9823 (ms) / GPU bubble ratio: 4.03%
[rank1]:2025-10-28 07:44:51,577 - INFO - Avg. fwd time: 51.5980 / Avg. bwd time: 42.3047 / Avg. batch time: 1578.7112 (ms) / GPU bubble ratio: 52.42%
[rank2]:2025-10-28 07:44:51,537 - INFO - Avg. fwd time: 32.6118 / Avg. bwd time: 31.4083 / Avg. batch time: 1489.6241 (ms) / GPU bubble ratio: 65.62%
[rank0]:2025-10-28 07:44:51,582 - INFO - Avg. fwd time: 44.8384 / Avg. bwd time: 10.2473 / Avg. batch time: 1624.6145 (ms) / GPU bubble ratio: 72.87%
[rank1]:2025-10-28 07:45:50,664 - INFO -  step: 740  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,613  tflops: 19.90  mfu: 6.38%
[rank2]:2025-10-28 07:45:50,664 - INFO -  step: 740  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,613  tflops: 19.90  mfu: 6.38%
[rank0]:2025-10-28 07:45:50,665 - INFO -  step: 740  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,613  tflops: 19.90  mfu: 6.38%
[rank3]:2025-10-28 07:45:53,053 - INFO -  step: 740  loss:  4.3029  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,612  tflops: 19.90  mfu: 6.38%
[rank0]:2025-10-28 07:46:19,400 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-28 07:46:53,548 - INFO -  step: 760  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,605  tflops: 19.84  mfu: 6.36%
[rank2]:2025-10-28 07:46:53,548 - INFO -  step: 760  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,605  tflops: 19.84  mfu: 6.36%
[rank0]:2025-10-28 07:46:53,549 - INFO -  step: 760  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,605  tflops: 19.84  mfu: 6.36%
[rank3]:2025-10-28 07:46:55,941 - INFO -  step: 760  loss:  2.4775  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,605  tflops: 19.84  mfu: 6.36%
[rank3]:2025-10-28 07:46:57,132 - INFO - Avg. fwd time: 71.9002 / Avg. bwd time: 74.8812 / Avg. batch time: 1223.6722 (ms) / GPU bubble ratio: 4.04%
[rank2]:2025-10-28 07:46:57,165 - INFO - Avg. fwd time: 32.6111 / Avg. bwd time: 31.1703 / Avg. batch time: 1486.8181 (ms) / GPU bubble ratio: 65.68%
[rank1]:2025-10-28 07:46:57,206 - INFO - Avg. fwd time: 51.6026 / Avg. bwd time: 41.9626 / Avg. batch time: 1575.5289 (ms) / GPU bubble ratio: 52.49%
[rank0]:2025-10-28 07:46:57,211 - INFO - Avg. fwd time: 44.8307 / Avg. bwd time: 9.7084 / Avg. batch time: 1620.8656 (ms) / GPU bubble ratio: 73.08%
[rank1]:2025-10-28 07:47:56,518 - INFO -  step: 780  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,602  tflops: 19.82  mfu: 6.35%
[rank2]:2025-10-28 07:47:56,517 - INFO -  step: 780  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,602  tflops: 19.82  mfu: 6.35%
[rank0]:2025-10-28 07:47:56,518 - INFO -  step: 780  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,602  tflops: 19.82  mfu: 6.35%
[rank3]:2025-10-28 07:47:58,978 - INFO -  step: 780  loss:  4.3441  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,599  tflops: 19.80  mfu: 6.34%
[rank0]:2025-10-28 07:48:56,906 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-28 07:48:59,640 - INFO -  step: 800  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,596  tflops: 19.77  mfu: 6.34%
[rank0]:2025-10-28 07:48:59,640 - INFO - ðŸ”Ž  Running validation at step 800
[rank1]:2025-10-28 07:48:59,640 - INFO -  step: 800  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,596  tflops: 19.77  mfu: 6.34%
[rank1]:2025-10-28 07:48:59,640 - INFO - ðŸ”Ž  Running validation at step 800
[rank2]:2025-10-28 07:48:59,639 - INFO -  step: 800  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,596  tflops: 19.77  mfu: 6.34%
[rank2]:2025-10-28 07:48:59,639 - INFO - ðŸ”Ž  Running validation at step 800
[rank3]:2025-10-28 07:49:02,052 - INFO -  step: 800  loss:  2.4991  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,598  tflops: 19.78  mfu: 6.34%
[rank3]:2025-10-28 07:49:02,052 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-10-28 07:50:10,604 - INFO - validate step: 800  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,772
[rank0]:2025-10-28 07:50:10,605 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-28 07:50:10,612 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank1]:2025-10-28 07:50:10,686 - INFO - validate step: 800  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,765
[rank1]:2025-10-28 07:50:10,687 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-28 07:50:10,767 - INFO - validate step: 800  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,759
[rank2]:2025-10-28 07:50:10,768 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-28 07:50:10,829 - INFO - validate step: 800  loss:  1.8223  memory: 38.93GiB(81.95%)  tps: 5,956
[rank3]:2025-10-28 07:50:10,831 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-28 07:50:13,020 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 2.25 seconds.
[rank1]:2025-10-28 07:50:13,406 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 2.72 seconds.
[rank3]:2025-10-28 07:50:14,269 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.44 seconds.
[rank0]:2025-10-28 07:50:14,383 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-28 07:50:14,391 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.79 seconds.
[rank1]:2025-10-28 07:50:14,502 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251028_0750_stage1_step800.svg
[rank2]:2025-10-28 07:50:14,502 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251028_0750_stage2_step800.svg
[rank0]:2025-10-28 07:50:14,658 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251028_0750_stage0_step800.svg
[rank3]:2025-10-28 07:50:14,755 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251028_0750_real_step800_rank3.svg
[rank3]:> Batch Time: 1287.41 ms, GPU Bubble Ratio: 71.91%, 45.25%, 63.23%, 13.58%
[rank3]:2025-10-28 07:50:14,831 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251028_0750_stage3_step800.svg
[rank3]:2025-10-28 07:50:16,336 - INFO - Avg. fwd time: 71.9008 / Avg. bwd time: 74.4295 / Avg. batch time: 1220.1731 (ms) / GPU bubble ratio: 4.06%
[rank2]:2025-10-28 07:50:16,368 - INFO - Avg. fwd time: 32.6090 / Avg. bwd time: 30.9613 / Avg. batch time: 1483.3881 (ms) / GPU bubble ratio: 65.72%
[rank0]:2025-10-28 07:50:16,416 - INFO - Avg. fwd time: 44.8235 / Avg. bwd time: 9.2234 / Avg. batch time: 1616.5523 (ms) / GPU bubble ratio: 73.25%
[rank1]:2025-10-28 07:50:16,410 - INFO - Avg. fwd time: 51.5918 / Avg. bwd time: 41.6554 / Avg. batch time: 1571.7218 (ms) / GPU bubble ratio: 52.54%
[rank3]:2025-10-28 07:50:48,594 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-28 07:50:48,624 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-28 07:50:48,665 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-28 07:50:48,662 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-28 07:51:19,230 - INFO -  step: 820  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,387  tflops: 18.18  mfu: 5.83%
[rank1]:2025-10-28 07:51:19,230 - INFO -  step: 820  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,390  tflops: 18.21  mfu: 5.83%
[rank2]:2025-10-28 07:51:19,229 - INFO -  step: 820  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,393  tflops: 18.23  mfu: 5.84%
[rank3]:2025-10-28 07:51:21,907 - INFO -  step: 820  loss:  4.3873  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,305  tflops: 17.56  mfu: 5.63%
[rank1]:2025-10-28 07:52:22,823 - INFO -  step: 840  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,576  tflops: 19.62  mfu: 6.29%
[rank2]:2025-10-28 07:52:22,823 - INFO -  step: 840  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,576  tflops: 19.62  mfu: 6.29%
[rank0]:2025-10-28 07:52:22,824 - INFO -  step: 840  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,576  tflops: 19.62  mfu: 6.29%
[rank3]:2025-10-28 07:52:25,277 - INFO -  step: 840  loss:  2.4762  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,586  tflops: 19.69  mfu: 6.31%
[rank3]:2025-10-28 07:52:26,482 - INFO - Avg. fwd time: 71.8933 / Avg. bwd time: 74.0358 / Avg. batch time: 1216.9383 (ms) / GPU bubble ratio: 4.07%
[rank2]:2025-10-28 07:52:26,514 - INFO - Avg. fwd time: 32.6051 / Avg. bwd time: 30.7681 / Avg. batch time: 1482.3635 (ms) / GPU bubble ratio: 65.80%
[rank0]:2025-10-28 07:52:26,566 - INFO - Avg. fwd time: 44.8360 / Avg. bwd time: 8.7845 / Avg. batch time: 1615.1635 (ms) / GPU bubble ratio: 73.44%
[rank1]:2025-10-28 07:52:26,560 - INFO - Avg. fwd time: 51.6007 / Avg. bwd time: 41.3858 / Avg. batch time: 1570.5923 (ms) / GPU bubble ratio: 52.64%
[rank0]:2025-10-28 07:52:52,100 - INFO - [GC] Peforming periodical GC collection 0.32 seconds
[rank2]:2025-10-28 07:53:26,455 - INFO -  step: 860  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,575  tflops: 19.61  mfu: 6.29%
[rank0]:2025-10-28 07:53:26,456 - INFO -  step: 860  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,575  tflops: 19.61  mfu: 6.29%
[rank1]:2025-10-28 07:53:26,455 - INFO -  step: 860  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,575  tflops: 19.61  mfu: 6.29%
[rank3]:2025-10-28 07:53:28,971 - INFO -  step: 860  loss:  4.3843  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,572  tflops: 19.59  mfu: 6.28%
[rank1]:2025-10-28 07:54:30,098 - INFO -  step: 880  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,574  tflops: 19.61  mfu: 6.28%
[rank2]:2025-10-28 07:54:30,097 - INFO -  step: 880  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,574  tflops: 19.61  mfu: 6.28%
[rank0]:2025-10-28 07:54:30,098 - INFO -  step: 880  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,574  tflops: 19.61  mfu: 6.28%
[rank3]:2025-10-28 07:54:32,658 - INFO -  step: 880  loss:  2.4314  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,573  tflops: 19.59  mfu: 6.28%
[rank3]:2025-10-28 07:54:33,865 - INFO - Avg. fwd time: 71.8946 / Avg. bwd time: 73.6761 / Avg. batch time: 1214.0259 (ms) / GPU bubble ratio: 4.07%
[rank2]:2025-10-28 07:54:33,898 - INFO - Avg. fwd time: 32.6075 / Avg. bwd time: 30.5939 / Avg. batch time: 1481.1215 (ms) / GPU bubble ratio: 65.86%
[rank0]:2025-10-28 07:54:33,944 - INFO - Avg. fwd time: 44.8349 / Avg. bwd time: 8.3855 / Avg. batch time: 1613.1884 (ms) / GPU bubble ratio: 73.61%
[rank1]:2025-10-28 07:54:33,938 - INFO - Avg. fwd time: 51.5914 / Avg. bwd time: 41.1313 / Avg. batch time: 1569.0387 (ms) / GPU bubble ratio: 52.72%
[rank0]:2025-10-28 07:55:31,014 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-28 07:55:33,636 - INFO -  step: 900  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,579  tflops: 19.64  mfu: 6.29%
[rank2]:2025-10-28 07:55:33,637 - INFO - ðŸ”Ž  Running validation at step 900
[rank0]:2025-10-28 07:55:33,637 - INFO -  step: 900  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,579  tflops: 19.64  mfu: 6.29%
[rank0]:2025-10-28 07:55:33,637 - INFO - ðŸ”Ž  Running validation at step 900
[rank1]:2025-10-28 07:55:33,637 - INFO -  step: 900  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,579  tflops: 19.64  mfu: 6.29%
[rank1]:2025-10-28 07:55:33,637 - INFO - ðŸ”Ž  Running validation at step 900
[rank3]:2025-10-28 07:55:36,145 - INFO -  step: 900  loss:  4.3183  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,581  tflops: 19.66  mfu: 6.30%
[rank3]:2025-10-28 07:55:36,146 - INFO - ðŸ”Ž  Running validation at step 900
[rank0]:2025-10-28 07:56:44,730 - INFO - validate step: 900  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,762
[rank1]:2025-10-28 07:56:44,813 - INFO - validate step: 900  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,755
[rank2]:2025-10-28 07:56:44,895 - INFO - validate step: 900  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,748
[rank3]:2025-10-28 07:56:44,958 - INFO - validate step: 900  loss:  1.8153  memory: 38.93GiB(81.95%)  tps: 5,953
[rank2]:2025-10-28 07:56:45,032 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251028_0756_stage2_step900.svg
[rank0]:2025-10-28 07:56:45,034 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251028_0756_stage0_step900.svg
[rank1]:2025-10-28 07:56:45,033 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251028_0756_stage1_step900.svg
[rank3]:2025-10-28 07:56:45,149 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251028_0756_real_step900_rank3.svg
[rank3]:> Batch Time: 1286.88 ms, GPU Bubble Ratio: 71.89%, 45.26%, 63.23%, 13.59%
[rank3]:2025-10-28 07:56:45,215 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251028_0756_stage3_step900.svg
[rank1]:2025-10-28 07:57:46,759 - INFO -  step: 920  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,645  tflops: 20.14  mfu: 6.46%
[rank2]:2025-10-28 07:57:46,759 - INFO -  step: 920  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,648  tflops: 20.17  mfu: 6.47%
[rank0]:2025-10-28 07:57:46,759 - INFO -  step: 920  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,641  tflops: 20.12  mfu: 6.45%
[rank3]:2025-10-28 07:57:49,241 - INFO -  step: 920  loss:  2.4378  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,549  tflops: 19.41  mfu: 6.22%
[rank2]:2025-10-28 07:57:50,482 - INFO - Avg. fwd time: 32.6052 / Avg. bwd time: 30.4350 / Avg. batch time: 1478.9326 (ms) / GPU bubble ratio: 65.90%
[rank3]:2025-10-28 07:57:50,448 - INFO - Avg. fwd time: 71.8907 / Avg. bwd time: 73.3552 / Avg. batch time: 1211.4307 (ms) / GPU bubble ratio: 4.08%
[rank0]:2025-10-28 07:57:50,529 - INFO - Avg. fwd time: 44.8444 / Avg. bwd time: 8.0212 / Avg. batch time: 1610.3614 (ms) / GPU bubble ratio: 73.74%
[rank1]:2025-10-28 07:57:50,523 - INFO - Avg. fwd time: 51.6204 / Avg. bwd time: 40.9055 / Avg. batch time: 1566.5952 (ms) / GPU bubble ratio: 52.75%
[rank2]:2025-10-28 07:58:50,179 - INFO -  step: 940  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,583  tflops: 19.68  mfu: 6.31%
[rank0]:2025-10-28 07:58:50,182 - INFO -  step: 940  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,583  tflops: 19.68  mfu: 6.31%
[rank1]:2025-10-28 07:58:50,179 - INFO -  step: 940  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,583  tflops: 19.68  mfu: 6.31%
[rank3]:2025-10-28 07:58:52,659 - INFO -  step: 940  loss:  4.2944  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,584  tflops: 19.68  mfu: 6.31%
[rank0]:2025-10-28 07:59:19,164 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-28 07:59:53,708 - INFO -  step: 960  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,579  tflops: 19.64  mfu: 6.30%
[rank1]:2025-10-28 07:59:53,707 - INFO -  step: 960  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,579  tflops: 19.64  mfu: 6.30%
[rank2]:2025-10-28 07:59:53,707 - INFO -  step: 960  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,579  tflops: 19.64  mfu: 6.30%
[rank3]:2025-10-28 07:59:56,189 - INFO -  step: 960  loss:  2.4473  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,579  tflops: 19.64  mfu: 6.30%
[rank3]:2025-10-28 07:59:57,395 - INFO - Avg. fwd time: 71.8958 / Avg. bwd time: 73.0515 / Avg. batch time: 1209.0054 (ms) / GPU bubble ratio: 4.09%
[rank2]:2025-10-28 07:59:57,428 - INFO - Avg. fwd time: 32.6042 / Avg. bwd time: 30.2886 / Avg. batch time: 1477.8403 (ms) / GPU bubble ratio: 65.95%
[rank0]:2025-10-28 07:59:57,477 - INFO - Avg. fwd time: 44.8302 / Avg. bwd time: 7.6873 / Avg. batch time: 1608.6737 (ms) / GPU bubble ratio: 73.88%
[rank1]:2025-10-28 07:59:57,471 - INFO - Avg. fwd time: 51.6253 / Avg. bwd time: 40.6951 / Avg. batch time: 1565.2670 (ms) / GPU bubble ratio: 52.82%
[rank0]:2025-10-28 08:00:57,396 - INFO -  step: 980  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,573  tflops: 19.59  mfu: 6.28%
[rank1]:2025-10-28 08:00:57,396 - INFO -  step: 980  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,573  tflops: 19.59  mfu: 6.28%
[rank2]:2025-10-28 08:00:57,396 - INFO -  step: 980  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,573  tflops: 19.59  mfu: 6.28%
[rank3]:2025-10-28 08:00:59,877 - INFO -  step: 980  loss:  4.3493  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,573  tflops: 19.59  mfu: 6.28%
[rank0]:2025-10-28 08:01:58,452 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-28 08:02:01,181 - INFO -  step: 1000  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,569  tflops: 19.56  mfu: 6.27%
[rank0]:2025-10-28 08:02:01,181 - INFO - ðŸ”Ž  Running validation at step 1000
[rank1]:2025-10-28 08:02:01,181 - INFO -  step: 1000  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,569  tflops: 19.56  mfu: 6.27%
[rank1]:2025-10-28 08:02:01,182 - INFO - ðŸ”Ž  Running validation at step 1000
[rank2]:2025-10-28 08:02:01,181 - INFO -  step: 1000  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,569  tflops: 19.56  mfu: 6.27%
[rank2]:2025-10-28 08:02:01,181 - INFO - ðŸ”Ž  Running validation at step 1000
[rank3]:2025-10-28 08:02:03,670 - INFO -  step: 1000  loss:  2.4510  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,568  tflops: 19.56  mfu: 6.27%
[rank3]:2025-10-28 08:02:03,671 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-10-28 08:03:12,613 - INFO - validate step: 1000  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,734
[rank1]:2025-10-28 08:03:12,699 - INFO - validate step: 1000  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,727
[rank2]:2025-10-28 08:03:12,779 - INFO - validate step: 1000  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,721
[rank3]:2025-10-28 08:03:12,839 - INFO - validate step: 1000  loss:  1.8012  memory: 38.93GiB(81.95%)  tps: 5,922
[rank2]:2025-10-28 08:03:12,917 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251028_0803_stage2_step1000.svg
[rank0]:2025-10-28 08:03:12,920 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251028_0803_stage0_step1000.svg
[rank1]:2025-10-28 08:03:12,919 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251028_0803_stage1_step1000.svg
[rank3]:2025-10-28 08:03:13,028 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251028_0803_real_step1000_rank3.svg
[rank3]:> Batch Time: 1286.53 ms, GPU Bubble Ratio: 71.90%, 45.26%, 63.22%, 13.59%
[rank3]:2025-10-28 08:03:13,113 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251028_0803_stage3_step1000.svg
[rank3]:2025-10-28 08:03:14,315 - INFO - Avg. fwd time: 71.8958 / Avg. bwd time: 72.7786 / Avg. batch time: 1206.8066 (ms) / GPU bubble ratio: 4.09%
[rank2]:2025-10-28 08:03:14,348 - INFO - Avg. fwd time: 32.6025 / Avg. bwd time: 30.1543 / Avg. batch time: 1475.9415 (ms) / GPU bubble ratio: 65.98%
[rank0]:2025-10-28 08:03:14,396 - INFO - Avg. fwd time: 44.8216 / Avg. bwd time: 7.3800 / Avg. batch time: 1606.2392 (ms) / GPU bubble ratio: 74.00%
[rank1]:2025-10-28 08:03:14,391 - INFO - Avg. fwd time: 51.6378 / Avg. bwd time: 40.5026 / Avg. batch time: 1563.1575 (ms) / GPU bubble ratio: 52.84%
[rank0]:2025-10-28 08:04:14,535 - INFO -  step: 1020  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,646  tflops: 20.15  mfu: 6.46%
[rank1]:2025-10-28 08:04:14,535 - INFO -  step: 1020  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,650  tflops: 20.18  mfu: 6.47%
[rank2]:2025-10-28 08:04:14,534 - INFO -  step: 1020  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,653  tflops: 20.21  mfu: 6.48%
[rank3]:2025-10-28 08:04:17,075 - INFO -  step: 1020  loss:  4.4043  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,551  tflops: 19.43  mfu: 6.23%
[rank0]:2025-10-28 08:05:18,193 - INFO -  step: 1040  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,574  tflops: 19.60  mfu: 6.28%
[rank1]:2025-10-28 08:05:18,192 - INFO -  step: 1040  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,574  tflops: 19.60  mfu: 6.28%
[rank2]:2025-10-28 08:05:18,192 - INFO -  step: 1040  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,574  tflops: 19.60  mfu: 6.28%
[rank3]:2025-10-28 08:05:20,712 - INFO -  step: 1040  loss:  2.5063  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,575  tflops: 19.61  mfu: 6.29%
[rank3]:2025-10-28 08:05:21,916 - INFO - Avg. fwd time: 71.9044 / Avg. bwd time: 72.5235 / Avg. batch time: 1204.8045 (ms) / GPU bubble ratio: 4.10%
[rank2]:2025-10-28 08:05:21,949 - INFO - Avg. fwd time: 32.5979 / Avg. bwd time: 30.0280 / Avg. batch time: 1475.3454 (ms) / GPU bubble ratio: 66.04%
[rank0]:2025-10-28 08:05:21,999 - INFO - Avg. fwd time: 44.8181 / Avg. bwd time: 7.0964 / Avg. batch time: 1605.1565 (ms) / GPU bubble ratio: 74.13%
[rank1]:2025-10-28 08:05:21,993 - INFO - Avg. fwd time: 51.6444 / Avg. bwd time: 40.3266 / Avg. batch time: 1562.3789 (ms) / GPU bubble ratio: 52.91%
[rank0]:2025-10-28 08:05:47,367 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-28 08:06:21,797 - INFO -  step: 1060  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,576  tflops: 19.62  mfu: 6.29%
[rank1]:2025-10-28 08:06:21,797 - INFO -  step: 1060  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,576  tflops: 19.62  mfu: 6.29%
[rank2]:2025-10-28 08:06:21,796 - INFO -  step: 1060  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,576  tflops: 19.62  mfu: 6.29%
[rank3]:2025-10-28 08:06:24,306 - INFO -  step: 1060  loss:  4.3511  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,576  tflops: 19.62  mfu: 6.29%
[rank0]:2025-10-28 08:07:25,449 - INFO -  step: 1080  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,574  tflops: 19.60  mfu: 6.28%
[rank1]:2025-10-28 08:07:25,449 - INFO -  step: 1080  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,574  tflops: 19.60  mfu: 6.28%
[rank2]:2025-10-28 08:07:25,449 - INFO -  step: 1080  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,574  tflops: 19.60  mfu: 6.28%
[rank3]:2025-10-28 08:07:27,958 - INFO -  step: 1080  loss:  2.4555  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,574  tflops: 19.60  mfu: 6.28%
[rank3]:2025-10-28 08:07:29,164 - INFO - Avg. fwd time: 71.9049 / Avg. bwd time: 72.2876 / Avg. batch time: 1202.9019 (ms) / GPU bubble ratio: 4.10%
[rank2]:2025-10-28 08:07:29,197 - INFO - Avg. fwd time: 32.5962 / Avg. bwd time: 29.9156 / Avg. batch time: 1474.6490 (ms) / GPU bubble ratio: 66.09%
[rank0]:2025-10-28 08:07:29,244 - INFO - Avg. fwd time: 44.8241 / Avg. bwd time: 6.8338 / Avg. batch time: 1603.9811 (ms) / GPU bubble ratio: 74.24%
[rank1]:2025-10-28 08:07:29,238 - INFO - Avg. fwd time: 51.6519 / Avg. bwd time: 40.1576 / Avg. batch time: 1561.4823 (ms) / GPU bubble ratio: 52.96%
[rank0]:2025-10-28 08:08:26,400 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-28 08:08:29,088 - INFO -  step: 1100  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,575  tflops: 19.61  mfu: 6.28%
[rank1]:2025-10-28 08:08:29,088 - INFO - ðŸ”Ž  Running validation at step 1100
[rank2]:2025-10-28 08:08:29,087 - INFO -  step: 1100  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,575  tflops: 19.61  mfu: 6.28%
[rank2]:2025-10-28 08:08:29,088 - INFO - ðŸ”Ž  Running validation at step 1100
[rank0]:2025-10-28 08:08:29,088 - INFO -  step: 1100  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,575  tflops: 19.61  mfu: 6.28%
[rank0]:2025-10-28 08:08:29,088 - INFO - ðŸ”Ž  Running validation at step 1100
[rank3]:2025-10-28 08:08:31,622 - INFO -  step: 1100  loss:  4.2218  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,574  tflops: 19.60  mfu: 6.28%
[rank3]:2025-10-28 08:08:31,623 - INFO - ðŸ”Ž  Running validation at step 1100
[rank0]:2025-10-28 08:09:40,815 - INFO - validate step: 1100  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,711
[rank1]:2025-10-28 08:09:40,900 - INFO - validate step: 1100  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,704
[rank2]:2025-10-28 08:09:40,981 - INFO - validate step: 1100  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,697
[rank3]:2025-10-28 08:09:41,045 - INFO - validate step: 1100  loss:  1.8178  memory: 38.93GiB(81.95%)  tps: 5,900
[rank1]:2025-10-28 08:09:41,123 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251028_0809_stage1_step1100.svg
[rank0]:2025-10-28 08:09:41,123 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251028_0809_stage0_step1100.svg
[rank2]:2025-10-28 08:09:41,123 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251028_0809_stage2_step1100.svg
[rank3]:2025-10-28 08:09:41,232 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251028_0809_real_step1100_rank3.svg
[rank3]:> Batch Time: 1286.67 ms, GPU Bubble Ratio: 71.90%, 45.27%, 63.23%, 13.58%
[rank3]:2025-10-28 08:09:41,300 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251028_0809_stage3_step1100.svg
[rank1]:2025-10-28 08:10:43,235 - INFO -  step: 1120  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,628  tflops: 20.02  mfu: 6.42%
[rank0]:2025-10-28 08:10:43,235 - INFO -  step: 1120  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,625  tflops: 19.99  mfu: 6.41%
[rank2]:2025-10-28 08:10:43,235 - INFO -  step: 1120  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,632  tflops: 20.04  mfu: 6.42%
[rank3]:2025-10-28 08:10:45,753 - INFO -  step: 1120  loss:  2.4647  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,532  tflops: 19.28  mfu: 6.18%
[rank1]:2025-10-28 08:10:47,041 - INFO - Avg. fwd time: 51.6695 / Avg. bwd time: 40.0067 / Avg. batch time: 1559.9803 (ms) / GPU bubble ratio: 52.99%
[rank3]:2025-10-28 08:10:46,964 - INFO - Avg. fwd time: 71.9220 / Avg. bwd time: 72.0765 / Avg. batch time: 1201.3317 (ms) / GPU bubble ratio: 4.11%
[rank0]:2025-10-28 08:10:47,047 - INFO - Avg. fwd time: 44.8262 / Avg. bwd time: 6.5899 / Avg. batch time: 1602.2242 (ms) / GPU bubble ratio: 74.33%
[rank2]:2025-10-28 08:10:46,999 - INFO - Avg. fwd time: 32.5964 / Avg. bwd time: 29.8094 / Avg. batch time: 1473.3085 (ms) / GPU bubble ratio: 66.11%
[rank2]:2025-10-28 08:11:46,848 - INFO -  step: 1140  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,576  tflops: 19.62  mfu: 6.29%
[rank1]:2025-10-28 08:11:46,849 - INFO -  step: 1140  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,576  tflops: 19.62  mfu: 6.29%
[rank0]:2025-10-28 08:11:46,849 - INFO -  step: 1140  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,576  tflops: 19.62  mfu: 6.29%
[rank3]:2025-10-28 08:11:49,361 - INFO -  step: 1140  loss:  4.3972  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,576  tflops: 19.62  mfu: 6.29%
[rank0]:2025-10-28 08:12:15,861 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-28 08:12:50,299 - INFO -  step: 1160  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,582  tflops: 19.67  mfu: 6.30%
[rank2]:2025-10-28 08:12:50,299 - INFO -  step: 1160  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,582  tflops: 19.67  mfu: 6.30%
[rank1]:2025-10-28 08:12:50,299 - INFO -  step: 1160  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,582  tflops: 19.67  mfu: 6.30%
[rank3]:2025-10-28 08:12:52,782 - INFO -  step: 1160  loss:  2.4579  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,583  tflops: 19.68  mfu: 6.31%
[rank3]:2025-10-28 08:12:53,971 - INFO - Avg. fwd time: 71.9252 / Avg. bwd time: 71.8617 / Avg. batch time: 1199.5910 (ms) / GPU bubble ratio: 4.11%
[rank2]:2025-10-28 08:12:54,006 - INFO - Avg. fwd time: 32.5976 / Avg. bwd time: 29.7106 / Avg. batch time: 1472.6355 (ms) / GPU bubble ratio: 66.15%
[rank1]:2025-10-28 08:12:54,048 - INFO - Avg. fwd time: 51.6615 / Avg. bwd time: 39.8586 / Avg. batch time: 1559.1376 (ms) / GPU bubble ratio: 53.04%
[rank0]:2025-10-28 08:12:54,054 - INFO - Avg. fwd time: 44.8148 / Avg. bwd time: 6.3628 / Avg. batch time: 1601.1365 (ms) / GPU bubble ratio: 74.43%
[rank0]:2025-10-28 08:13:53,490 - INFO -  step: 1180  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,593  tflops: 19.75  mfu: 6.33%
[rank2]:2025-10-28 08:13:53,489 - INFO -  step: 1180  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,593  tflops: 19.75  mfu: 6.33%
[rank1]:2025-10-28 08:13:53,490 - INFO -  step: 1180  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,593  tflops: 19.75  mfu: 6.33%
[rank3]:2025-10-28 08:13:55,971 - INFO -  step: 1180  loss:  4.3847  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,593  tflops: 19.75  mfu: 6.33%
[rank0]:2025-10-28 08:14:54,236 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-28 08:14:56,972 - INFO -  step: 1200  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,581  tflops: 19.66  mfu: 6.30%
[rank2]:2025-10-28 08:14:56,972 - INFO - ðŸ”Ž  Running validation at step 1200
[rank0]:2025-10-28 08:14:56,972 - INFO -  step: 1200  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,581  tflops: 19.66  mfu: 6.30%
[rank0]:2025-10-28 08:14:56,972 - INFO - ðŸ”Ž  Running validation at step 1200
[rank1]:2025-10-28 08:14:56,972 - INFO -  step: 1200  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,581  tflops: 19.66  mfu: 6.30%
[rank1]:2025-10-28 08:14:56,972 - INFO - ðŸ”Ž  Running validation at step 1200
[rank3]:2025-10-28 08:14:59,446 - INFO -  step: 1200  loss:  2.4912  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,581  tflops: 19.66  mfu: 6.30%
[rank3]:2025-10-28 08:14:59,447 - INFO - ðŸ”Ž  Running validation at step 1200
[rank0]:2025-10-28 08:16:08,307 - INFO - validate step: 1200  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,742
[rank1]:2025-10-28 08:16:08,392 - INFO - validate step: 1200  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,735
[rank2]:2025-10-28 08:16:08,473 - INFO - validate step: 1200  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,729
[rank3]:2025-10-28 08:16:08,537 - INFO - validate step: 1200  loss:  1.8178  memory: 38.93GiB(81.95%)  tps: 5,929
[rank1]:2025-10-28 08:16:08,618 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251028_0816_stage1_step1200.svg
[rank2]:2025-10-28 08:16:08,618 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251028_0816_stage2_step1200.svg
[rank0]:2025-10-28 08:16:08,621 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251028_0816_stage0_step1200.svg
[rank3]:2025-10-28 08:16:08,730 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251028_0816_real_step1200_rank3.svg
[rank3]:> Batch Time: 1286.25 ms, GPU Bubble Ratio: 71.90%, 45.28%, 63.23%, 13.57%
[rank3]:2025-10-28 08:16:08,802 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251028_0816_stage3_step1200.svg
[rank3]:2025-10-28 08:16:10,019 - INFO - Avg. fwd time: 71.9127 / Avg. bwd time: 71.6619 / Avg. batch time: 1197.8944 (ms) / GPU bubble ratio: 4.12%
[rank2]:2025-10-28 08:16:10,053 - INFO - Avg. fwd time: 32.5972 / Avg. bwd time: 29.6163 / Avg. batch time: 1470.8916 (ms) / GPU bubble ratio: 66.16%
[rank1]:2025-10-28 08:16:10,094 - INFO - Avg. fwd time: 51.6639 / Avg. bwd time: 39.7209 / Avg. batch time: 1557.2536 (ms) / GPU bubble ratio: 53.05%
[rank0]:2025-10-28 08:16:10,100 - INFO - Avg. fwd time: 44.8093 / Avg. bwd time: 6.1509 / Avg. batch time: 1599.0276 (ms) / GPU bubble ratio: 74.50%
[rank2]:2025-10-28 08:17:10,369 - INFO -  step: 1220  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,647  tflops: 20.16  mfu: 6.46%
[rank0]:2025-10-28 08:17:10,369 - INFO -  step: 1220  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,640  tflops: 20.11  mfu: 6.44%
[rank1]:2025-10-28 08:17:10,369 - INFO -  step: 1220  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,644  tflops: 20.13  mfu: 6.45%
[rank3]:2025-10-28 08:17:12,998 - INFO -  step: 1220  loss:  4.3751  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,542  tflops: 19.36  mfu: 6.20%
[rank1]:2025-10-28 08:18:14,377 - INFO -  step: 1240  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,560  tflops: 19.50  mfu: 6.25%
[rank2]:2025-10-28 08:18:14,377 - INFO -  step: 1240  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,560  tflops: 19.50  mfu: 6.25%
[rank0]:2025-10-28 08:18:14,377 - INFO -  step: 1240  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,560  tflops: 19.50  mfu: 6.25%
[rank3]:2025-10-28 08:18:16,885 - INFO -  step: 1240  loss:  2.4878  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,565  tflops: 19.53  mfu: 6.26%
[rank3]:2025-10-28 08:18:18,070 - INFO - Avg. fwd time: 71.9346 / Avg. bwd time: 71.4882 / Avg. batch time: 1196.6575 (ms) / GPU bubble ratio: 4.12%
[rank2]:2025-10-28 08:18:18,104 - INFO - Avg. fwd time: 32.6072 / Avg. bwd time: 29.5300 / Avg. batch time: 1470.7409 (ms) / GPU bubble ratio: 66.20%
[rank0]:2025-10-28 08:18:18,153 - INFO - Avg. fwd time: 44.8130 / Avg. bwd time: 5.9526 / Avg. batch time: 1598.5413 (ms) / GPU bubble ratio: 74.59%
[rank1]:2025-10-28 08:18:18,147 - INFO - Avg. fwd time: 51.6658 / Avg. bwd time: 39.5988 / Avg. batch time: 1556.9763 (ms) / GPU bubble ratio: 53.11%
[rank0]:2025-10-28 08:18:43,656 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-28 08:19:18,145 - INFO -  step: 1260  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,569  tflops: 19.57  mfu: 6.27%
[rank2]:2025-10-28 08:19:18,145 - INFO -  step: 1260  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,569  tflops: 19.57  mfu: 6.27%
[rank0]:2025-10-28 08:19:18,145 - INFO -  step: 1260  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,569  tflops: 19.57  mfu: 6.27%
[rank3]:2025-10-28 08:19:20,629 - INFO -  step: 1260  loss:  4.3760  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,570  tflops: 19.58  mfu: 6.27%
[rank3]:2025-10-28 08:20:21,948 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251028_0820_rank3_trend_line.svg
[rank2]:2025-10-28 08:20:21,943 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251028_0820_rank2_trend_line.svg
[rank2]:2025-10-28 08:20:21,990 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-28 08:20:21,993 - INFO -  step: 1280  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,566  tflops: 19.54  mfu: 6.26%
[rank0]:2025-10-28 08:20:21,978 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251028_0820_rank0_trend_line.svg
[rank0]:2025-10-28 08:20:21,989 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-28 08:20:21,992 - INFO -  step: 1280  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,566  tflops: 19.54  mfu: 6.26%
[rank1]:2025-10-28 08:20:21,983 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251028_0820_rank1_trend_line.svg
[rank1]:2025-10-28 08:20:21,990 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-10-28 08:20:21,993 - INFO -  step: 1280  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,566  tflops: 19.54  mfu: 6.26%
[rank3]:2025-10-28 08:20:22,183 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251028_0820_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 1282.00 ms, GPU Bubble Ratio: 70.70%, 45.01%, 62.81%, 13.46%
[rank3]:2025-10-28 08:20:22,184 - INFO - 	> Batch Time: 1282.00 ms (Average Freeze Ratio: 0.34)
[rank3]:2025-10-28 08:20:22,185 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-28 08:20:24,780 - INFO -  step: 1280  loss:  2.4705  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,554  tflops: 19.45  mfu: 6.23%
[rank3]:2025-10-28 08:20:25,971 - INFO - Avg. fwd time: 71.9356 / Avg. bwd time: 71.3176 / Avg. batch time: 1195.3153 (ms) / GPU bubble ratio: 4.12%
[rank2]:2025-10-28 08:20:26,006 - INFO - Avg. fwd time: 32.6055 / Avg. bwd time: 29.4489 / Avg. batch time: 1470.3760 (ms) / GPU bubble ratio: 66.24%
[rank1]:2025-10-28 08:20:26,047 - INFO - Avg. fwd time: 51.6673 / Avg. bwd time: 39.4878 / Avg. batch time: 1556.4949 (ms) / GPU bubble ratio: 53.15%
[rank0]:2025-10-28 08:20:26,053 - INFO - Avg. fwd time: 44.8141 / Avg. bwd time: 5.7667 / Avg. batch time: 1597.8651 (ms) / GPU bubble ratio: 74.68%
[rank0]:2025-10-28 08:21:23,034 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-28 08:21:25,709 - INFO -  step: 1300  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,571  tflops: 19.58  mfu: 6.28%
[rank0]:2025-10-28 08:21:25,709 - INFO - ðŸ”Ž  Running validation at step 1300
[rank1]:2025-10-28 08:21:25,709 - INFO -  step: 1300  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,571  tflops: 19.58  mfu: 6.28%
[rank1]:2025-10-28 08:21:25,709 - INFO - ðŸ”Ž  Running validation at step 1300
[rank2]:2025-10-28 08:21:25,709 - INFO -  step: 1300  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,571  tflops: 19.58  mfu: 6.28%
[rank2]:2025-10-28 08:21:25,709 - INFO - ðŸ”Ž  Running validation at step 1300
[rank3]:2025-10-28 08:21:28,252 - INFO -  step: 1300  loss:  4.3329  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,581  tflops: 19.66  mfu: 6.30%
[rank3]:2025-10-28 08:21:28,253 - INFO - ðŸ”Ž  Running validation at step 1300
[rank0]:2025-10-28 08:22:36,831 - INFO - validate step: 1300  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,759
[rank1]:2025-10-28 08:22:36,913 - INFO - validate step: 1300  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,752
[rank2]:2025-10-28 08:22:36,999 - INFO - validate step: 1300  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,746
[rank3]:2025-10-28 08:22:37,058 - INFO - validate step: 1300  loss:  1.8101  memory: 38.93GiB(81.95%)  tps: 5,953
[rank1]:2025-10-28 08:22:37,142 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251028_0822_stage1_step1300.svg
[rank2]:2025-10-28 08:22:37,142 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251028_0822_stage2_step1300.svg
[rank0]:2025-10-28 08:22:37,140 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251028_0822_stage0_step1300.svg
[rank3]:2025-10-28 08:22:37,248 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251028_0822_real_step1300_rank3.svg
[rank3]:> Batch Time: 1286.28 ms, GPU Bubble Ratio: 71.90%, 45.28%, 63.23%, 13.58%
[rank3]:2025-10-28 08:22:37,319 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251028_0822_stage3_step1300.svg
[rank0]:2025-10-28 08:23:39,074 - INFO -  step: 1320  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,632  tflops: 20.05  mfu: 6.43%
[rank1]:2025-10-28 08:23:39,074 - INFO -  step: 1320  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,636  tflops: 20.07  mfu: 6.43%
[rank2]:2025-10-28 08:23:39,074 - INFO -  step: 1320  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,639  tflops: 20.10  mfu: 6.44%
[rank3]:2025-10-28 08:23:41,597 - INFO -  step: 1320  loss:  2.4835  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,539  tflops: 19.34  mfu: 6.20%
[rank3]:2025-10-28 08:23:42,802 - INFO - Avg. fwd time: 71.9382 / Avg. bwd time: 71.1600 / Avg. batch time: 1194.0767 (ms) / GPU bubble ratio: 4.13%
[rank0]:2025-10-28 08:23:42,886 - INFO - Avg. fwd time: 44.8101 / Avg. bwd time: 5.5921 / Avg. batch time: 1596.4381 (ms) / GPU bubble ratio: 74.74%
[rank1]:2025-10-28 08:23:42,879 - INFO - Avg. fwd time: 51.6673 / Avg. bwd time: 39.3747 / Avg. batch time: 1555.2565 (ms) / GPU bubble ratio: 53.17%
[rank2]:2025-10-28 08:23:42,837 - INFO - Avg. fwd time: 32.6067 / Avg. bwd time: 29.3725 / Avg. batch time: 1469.2643 (ms) / GPU bubble ratio: 66.25%
[rank2]:2025-10-28 08:24:42,710 - INFO -  step: 1340  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,575  tflops: 19.61  mfu: 6.28%
[rank0]:2025-10-28 08:24:42,711 - INFO -  step: 1340  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,575  tflops: 19.61  mfu: 6.28%
[rank1]:2025-10-28 08:24:42,710 - INFO -  step: 1340  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,575  tflops: 19.61  mfu: 6.28%
[rank3]:2025-10-28 08:24:45,240 - INFO -  step: 1340  loss:  4.2886  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,574  tflops: 19.61  mfu: 6.28%
[rank0]:2025-10-28 08:25:11,790 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-28 08:25:46,335 - INFO -  step: 1360  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,575  tflops: 19.61  mfu: 6.29%
[rank1]:2025-10-28 08:25:46,335 - INFO -  step: 1360  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,575  tflops: 19.61  mfu: 6.29%
[rank2]:2025-10-28 08:25:46,334 - INFO -  step: 1360  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,575  tflops: 19.61  mfu: 6.29%
[rank3]:2025-10-28 08:25:48,819 - INFO -  step: 1360  loss:  2.4693  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,577  tflops: 19.63  mfu: 6.29%
[rank3]:2025-10-28 08:25:50,016 - INFO - Avg. fwd time: 71.9385 / Avg. bwd time: 71.0127 / Avg. batch time: 1192.8890 (ms) / GPU bubble ratio: 4.13%
[rank1]:2025-10-28 08:25:50,092 - INFO - Avg. fwd time: 51.6707 / Avg. bwd time: 39.2734 / Avg. batch time: 1554.7393 (ms) / GPU bubble ratio: 53.20%
[rank2]:2025-10-28 08:25:50,051 - INFO - Avg. fwd time: 32.6097 / Avg. bwd time: 29.3010 / Avg. batch time: 1468.8725 (ms) / GPU bubble ratio: 66.28%
[rank0]:2025-10-28 08:25:50,099 - INFO - Avg. fwd time: 44.8155 / Avg. bwd time: 5.4277 / Avg. batch time: 1595.7488 (ms) / GPU bubble ratio: 74.81%
[rank1]:2025-10-28 08:26:49,946 - INFO -  step: 1380  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,576  tflops: 19.62  mfu: 6.29%
[rank2]:2025-10-28 08:26:49,945 - INFO -  step: 1380  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,576  tflops: 19.62  mfu: 6.29%
[rank0]:2025-10-28 08:26:49,946 - INFO -  step: 1380  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,576  tflops: 19.62  mfu: 6.29%
[rank3]:2025-10-28 08:26:52,455 - INFO -  step: 1380  loss:  4.2887  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,575  tflops: 19.61  mfu: 6.29%
[rank0]:2025-10-28 08:27:50,709 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-28 08:27:53,446 - INFO -  step: 1400  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,580  tflops: 19.65  mfu: 6.30%
[rank1]:2025-10-28 08:27:53,446 - INFO - ðŸ”Ž  Running validation at step 1400
[rank2]:2025-10-28 08:27:53,446 - INFO -  step: 1400  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,580  tflops: 19.65  mfu: 6.30%
[rank2]:2025-10-28 08:27:53,446 - INFO - ðŸ”Ž  Running validation at step 1400
[rank0]:2025-10-28 08:27:53,447 - INFO -  step: 1400  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,580  tflops: 19.65  mfu: 6.30%
[rank0]:2025-10-28 08:27:53,447 - INFO - ðŸ”Ž  Running validation at step 1400
[rank3]:2025-10-28 08:27:55,937 - INFO -  step: 1400  loss:  2.4853  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,581  tflops: 19.66  mfu: 6.30%
[rank3]:2025-10-28 08:27:55,937 - INFO - ðŸ”Ž  Running validation at step 1400
[rank0]:2025-10-28 08:29:04,315 - INFO - validate step: 1400  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,780
[rank1]:2025-10-28 08:29:04,399 - INFO - validate step: 1400  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,773
[rank2]:2025-10-28 08:29:04,481 - INFO - validate step: 1400  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,766
[rank3]:2025-10-28 08:29:04,542 - INFO - validate step: 1400  loss:  1.8162  memory: 38.93GiB(81.95%)  tps: 5,971
[rank1]:2025-10-28 08:29:04,629 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251028_0829_stage1_step1400.svg
[rank2]:2025-10-28 08:29:04,628 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251028_0829_stage2_step1400.svg
[rank0]:2025-10-28 08:29:04,626 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251028_0829_stage0_step1400.svg
[rank3]:2025-10-28 08:29:04,732 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251028_0829_real_step1400_rank3.svg
[rank3]:> Batch Time: 1286.36 ms, GPU Bubble Ratio: 71.89%, 45.27%, 63.24%, 13.59%
[rank3]:2025-10-28 08:29:04,807 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251028_0829_stage3_step1400.svg
[rank2]:2025-10-28 08:29:06,048 - INFO - Avg. fwd time: 32.6094 / Avg. bwd time: 29.2338 / Avg. batch time: 1467.6364 (ms) / GPU bubble ratio: 66.29%
[rank3]:2025-10-28 08:29:06,014 - INFO - Avg. fwd time: 71.9349 / Avg. bwd time: 70.8720 / Avg. batch time: 1191.7370 (ms) / GPU bubble ratio: 4.14%
[rank0]:2025-10-28 08:29:06,096 - INFO - Avg. fwd time: 44.8157 / Avg. bwd time: 5.2728 / Avg. batch time: 1594.2407 (ms) / GPU bubble ratio: 74.87%
[rank1]:2025-10-28 08:29:06,089 - INFO - Avg. fwd time: 51.6665 / Avg. bwd time: 39.1787 / Avg. batch time: 1553.3957 (ms) / GPU bubble ratio: 53.21%
[rank1]:2025-10-28 08:30:06,009 - INFO -  step: 1420  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,659  tflops: 20.25  mfu: 6.49%
[rank2]:2025-10-28 08:30:06,008 - INFO -  step: 1420  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,663  tflops: 20.28  mfu: 6.50%
[rank0]:2025-10-28 08:30:06,009 - INFO -  step: 1420  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,656  tflops: 20.23  mfu: 6.48%
[rank3]:2025-10-28 08:30:08,514 - INFO -  step: 1420  loss:  4.2482  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,561  tflops: 19.51  mfu: 6.25%
[rank0]:2025-10-28 08:31:09,434 - INFO -  step: 1440  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,583  tflops: 19.67  mfu: 6.31%
[rank1]:2025-10-28 08:31:09,434 - INFO -  step: 1440  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,583  tflops: 19.67  mfu: 6.31%
[rank2]:2025-10-28 08:31:09,433 - INFO -  step: 1440  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,583  tflops: 19.67  mfu: 6.31%
[rank3]:2025-10-28 08:31:11,975 - INFO -  step: 1440  loss:  2.4327  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,582  tflops: 19.66  mfu: 6.30%
[rank2]:2025-10-28 08:31:13,209 - INFO - Avg. fwd time: 32.6052 / Avg. bwd time: 29.1686 / Avg. batch time: 1467.3184 (ms) / GPU bubble ratio: 66.32%
[rank3]:2025-10-28 08:31:13,175 - INFO - Avg. fwd time: 71.9260 / Avg. bwd time: 70.7382 / Avg. batch time: 1190.6070 (ms) / GPU bubble ratio: 4.14%
[rank0]:2025-10-28 08:31:13,258 - INFO - Avg. fwd time: 44.8166 / Avg. bwd time: 5.1264 / Avg. batch time: 1593.6495 (ms) / GPU bubble ratio: 74.93%
[rank1]:2025-10-28 08:31:13,251 - INFO - Avg. fwd time: 51.6752 / Avg. bwd time: 39.0854 / Avg. batch time: 1552.9603 (ms) / GPU bubble ratio: 53.25%
[rank0]:2025-10-28 08:31:38,557 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-28 08:32:12,787 - INFO -  step: 1460  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,586  tflops: 19.70  mfu: 6.31%
[rank0]:2025-10-28 08:32:12,788 - INFO -  step: 1460  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,586  tflops: 19.70  mfu: 6.31%
[rank1]:2025-10-28 08:32:12,788 - INFO -  step: 1460  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,586  tflops: 19.70  mfu: 6.31%
[rank3]:2025-10-28 08:32:15,309 - INFO -  step: 1460  loss:  4.3620  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,587  tflops: 19.70  mfu: 6.32%
[rank0]:2025-10-28 08:33:16,019 - INFO -  step: 1480  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,591  tflops: 19.73  mfu: 6.33%
[rank1]:2025-10-28 08:33:16,019 - INFO -  step: 1480  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,591  tflops: 19.73  mfu: 6.33%
[rank2]:2025-10-28 08:33:16,019 - INFO -  step: 1480  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,591  tflops: 19.73  mfu: 6.33%
[rank3]:2025-10-28 08:33:18,514 - INFO -  step: 1480  loss:  2.4587  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,592  tflops: 19.74  mfu: 6.33%
[rank3]:2025-10-28 08:33:19,712 - INFO - Avg. fwd time: 71.9178 / Avg. bwd time: 70.6032 / Avg. batch time: 1189.4435 (ms) / GPU bubble ratio: 4.14%
[rank2]:2025-10-28 08:33:19,746 - INFO - Avg. fwd time: 32.6006 / Avg. bwd time: 29.1063 / Avg. batch time: 1466.8181 (ms) / GPU bubble ratio: 66.35%
[rank0]:2025-10-28 08:33:19,796 - INFO - Avg. fwd time: 44.8063 / Avg. bwd time: 4.9880 / Avg. batch time: 1592.8717 (ms) / GPU bubble ratio: 74.99%
[rank1]:2025-10-28 08:33:19,788 - INFO - Avg. fwd time: 51.6665 / Avg. bwd time: 38.9916 / Avg. batch time: 1552.3345 (ms) / GPU bubble ratio: 53.28%
[rank0]:2025-10-28 08:34:16,512 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-28 08:34:19,185 - INFO -  step: 1500  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,594  tflops: 19.76  mfu: 6.33%
[rank0]:2025-10-28 08:34:19,185 - INFO - ðŸ”Ž  Running validation at step 1500
[rank1]:2025-10-28 08:34:19,185 - INFO -  step: 1500  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,594  tflops: 19.75  mfu: 6.33%
[rank1]:2025-10-28 08:34:19,185 - INFO - ðŸ”Ž  Running validation at step 1500
[rank2]:2025-10-28 08:34:19,185 - INFO -  step: 1500  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,594  tflops: 19.76  mfu: 6.33%
[rank2]:2025-10-28 08:34:19,185 - INFO - ðŸ”Ž  Running validation at step 1500
[rank3]:2025-10-28 08:34:21,669 - INFO -  step: 1500  loss:  4.2560  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,594  tflops: 19.76  mfu: 6.33%
[rank3]:2025-10-28 08:34:21,670 - INFO - ðŸ”Ž  Running validation at step 1500
[rank0]:2025-10-28 08:35:30,081 - INFO - validate step: 1500  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,778
[rank1]:2025-10-28 08:35:30,163 - INFO - validate step: 1500  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,771
[rank2]:2025-10-28 08:35:30,244 - INFO - validate step: 1500  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,764
[rank3]:2025-10-28 08:35:30,307 - INFO - validate step: 1500  loss:  1.8212  memory: 38.93GiB(81.95%)  tps: 5,968
[rank0]:2025-10-28 08:35:30,393 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251028_0835_stage0_step1500.svg
[rank2]:2025-10-28 08:35:30,394 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251028_0835_stage2_step1500.svg
[rank1]:2025-10-28 08:35:30,394 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251028_0835_stage1_step1500.svg
[rank3]:2025-10-28 08:35:30,498 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251028_0835_real_step1500_rank3.svg
[rank3]:> Batch Time: 1285.85 ms, GPU Bubble Ratio: 71.90%, 45.27%, 63.23%, 13.58%
[rank3]:2025-10-28 08:35:30,570 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251028_0835_stage3_step1500.svg
[rank2]:2025-10-28 08:36:31,883 - INFO -  step: 1520  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,658  tflops: 20.24  mfu: 6.49%
[rank1]:2025-10-28 08:36:31,884 - INFO -  step: 1520  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,655  tflops: 20.22  mfu: 6.48%
[rank0]:2025-10-28 08:36:31,884 - INFO -  step: 1520  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,651  tflops: 20.19  mfu: 6.47%
[rank3]:2025-10-28 08:36:34,392 - INFO -  step: 1520  loss:  2.4813  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,557  tflops: 19.47  mfu: 6.24%
[rank3]:2025-10-28 08:36:35,608 - INFO - Avg. fwd time: 71.9211 / Avg. bwd time: 70.4800 / Avg. batch time: 1188.4539 (ms) / GPU bubble ratio: 4.14%
[rank2]:2025-10-28 08:36:35,643 - INFO - Avg. fwd time: 32.5988 / Avg. bwd time: 29.0482 / Avg. batch time: 1465.7134 (ms) / GPU bubble ratio: 66.35%
[rank1]:2025-10-28 08:36:35,685 - INFO - Avg. fwd time: 51.6647 / Avg. bwd time: 38.9047 / Avg. batch time: 1551.1281 (ms) / GPU bubble ratio: 53.29%
[rank0]:2025-10-28 08:36:35,693 - INFO - Avg. fwd time: 44.7933 / Avg. bwd time: 4.8568 / Avg. batch time: 1591.5237 (ms) / GPU bubble ratio: 75.04%
[rank0]:2025-10-28 08:37:35,411 - INFO -  step: 1540  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,579  tflops: 19.64  mfu: 6.30%
[rank2]:2025-10-28 08:37:35,410 - INFO -  step: 1540  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,579  tflops: 19.64  mfu: 6.30%
[rank1]:2025-10-28 08:37:35,410 - INFO -  step: 1540  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,579  tflops: 19.64  mfu: 6.30%
[rank3]:2025-10-28 08:37:37,888 - INFO -  step: 1540  loss:  4.3461  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,580  tflops: 19.65  mfu: 6.30%
[rank0]:2025-10-28 08:38:04,419 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-28 08:38:38,851 - INFO -  step: 1560  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,583  tflops: 19.67  mfu: 6.30%
[rank1]:2025-10-28 08:38:38,851 - INFO -  step: 1560  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,583  tflops: 19.67  mfu: 6.30%
[rank0]:2025-10-28 08:38:38,852 - INFO -  step: 1560  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,583  tflops: 19.67  mfu: 6.30%
[rank3]:2025-10-28 08:38:41,346 - INFO -  step: 1560  loss:  2.4882  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,582  tflops: 19.66  mfu: 6.30%
[rank3]:2025-10-28 08:38:42,559 - INFO - Avg. fwd time: 71.9211 / Avg. bwd time: 70.3664 / Avg. batch time: 1187.5289 (ms) / GPU bubble ratio: 4.15%
[rank2]:2025-10-28 08:38:42,594 - INFO - Avg. fwd time: 32.5977 / Avg. bwd time: 28.9935 / Avg. batch time: 1465.3718 (ms) / GPU bubble ratio: 66.38%
[rank1]:2025-10-28 08:38:42,637 - INFO - Avg. fwd time: 51.6681 / Avg. bwd time: 38.8274 / Avg. batch time: 1550.7057 (ms) / GPU bubble ratio: 53.31%
[rank0]:2025-10-28 08:38:42,644 - INFO - Avg. fwd time: 44.7926 / Avg. bwd time: 4.7324 / Avg. batch time: 1590.9676 (ms) / GPU bubble ratio: 75.10%
[rank0]:2025-10-28 08:39:42,280 - INFO -  step: 1580  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,583  tflops: 19.67  mfu: 6.31%
[rank2]:2025-10-28 08:39:42,279 - INFO -  step: 1580  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,583  tflops: 19.67  mfu: 6.31%
[rank1]:2025-10-28 08:39:42,280 - INFO -  step: 1580  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,583  tflops: 19.67  mfu: 6.31%
[rank3]:2025-10-28 08:39:44,884 - INFO -  step: 1580  loss:  4.3160  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,579  tflops: 19.64  mfu: 6.29%
[rank0]:2025-10-28 08:40:43,109 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-28 08:40:45,825 - INFO -  step: 1600  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,578  tflops: 19.64  mfu: 6.29%
[rank1]:2025-10-28 08:40:45,826 - INFO -  final step: 1600  loss: -2.0000  grad_norm:  0.0000  tps: 2,566  tflops: 19.55  mfu: 6.17%
[rank1]:2025-10-28 08:40:45,826 - INFO - ðŸ”Ž  Running validation at step 1600
[rank0]:2025-10-28 08:40:45,825 - INFO -  step: 1600  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,578  tflops: 19.64  mfu: 6.29%
[rank0]:2025-10-28 08:40:45,825 - INFO -  final step: 1600  loss: -2.0000  grad_norm:  0.0000  tps: 2,566  tflops: 19.55  mfu: 6.16%
[rank0]:2025-10-28 08:40:45,825 - INFO - ðŸ”Ž  Running validation at step 1600
[rank2]:2025-10-28 08:40:45,825 - INFO -  step: 1600  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,578  tflops: 19.64  mfu: 6.29%
[rank2]:2025-10-28 08:40:45,825 - INFO -  final step: 1600  loss: -2.0000  grad_norm:  0.0000  tps: 2,567  tflops: 19.55  mfu: 6.17%
[rank2]:2025-10-28 08:40:45,825 - INFO - ðŸ”Ž  Running validation at step 1600
[rank3]:2025-10-28 08:40:48,325 - INFO -  step: 1600  loss:  2.4799  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,583  tflops: 19.67  mfu: 6.30%
[rank3]:2025-10-28 08:40:48,326 - INFO -  final step: 1600  loss:  2.4799  grad_norm:  0.0000  tps: 2,549  tflops: 19.42  mfu: 6.12%
[rank3]:2025-10-28 08:40:48,334 - INFO - ðŸ”Ž  Running validation at step 1600
[rank0]:2025-10-28 08:41:57,035 - INFO - validate step: 1600  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,752
[rank0]:2025-10-28 08:41:57,036 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-28 08:41:57,038 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1600.
[rank1]:2025-10-28 08:41:57,120 - INFO - validate step: 1600  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,745
[rank1]:2025-10-28 08:41:57,120 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-28 08:41:57,122 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1600.
[rank2]:2025-10-28 08:41:57,202 - INFO - validate step: 1600  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,739
[rank2]:2025-10-28 08:41:57,203 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-28 08:41:57,205 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1600.
[rank3]:2025-10-28 08:41:57,265 - INFO - validate step: 1600  loss:  1.8152  memory: 38.93GiB(81.95%)  tps: 5,942
[rank3]:2025-10-28 08:41:57,266 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-28 08:41:57,268 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1600.
[rank0]:2025-10-28 08:41:59,744 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank1]:2025-10-28 08:41:59,833 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251028_0841_stage1_final1600.svg
[rank0]:2025-10-28 08:41:59,836 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251028_0841_stage0_final1600.svg
[rank2]:2025-10-28 08:41:59,834 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251028_0841_stage2_final1600.svg
[rank3]:2025-10-28 08:41:59,937 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251028_0841_real_final1600_rank3.svg
[rank3]:> Batch Time: 1285.58 ms, GPU Bubble Ratio: 71.89%, 45.27%, 63.23%, 13.59%
[rank1]:2025-10-28 08:42:00,040 - INFO - Elementwise Histogram is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/frozen_params_histogram/251028_0841_rank1_stage1.svg
[rank1]:	> Counts Sum: 932500, Total Sum: 1076400 (86.63%), Ratio(%) per element: [86.58, 86.87, 86.49, 86.62, 86.62, 86.58, 86.49, 86.49, 86.74, 86.66, 86.74, 86.37, 86.7, 86.62, 86.62, 86.62, 86.74, 86.78, 86.49, 86.7, 86.66, 86.62, 86.74, 86.58, 86.66, 86.58, 86.66, 86.7, 86.58, 86.66, 86.58, 86.7, 86.7, 86.45, 86.74, 86.53, 86.62, 86.62, 86.7, 86.7, 86.58, 86.53, 86.58, 86.62, 86.62]
[rank1]:2025-10-28 08:42:00,040 - INFO - Destroying the purge thread.
[rank0]:2025-10-28 08:42:00,071 - INFO - Elementwise Histogram is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/frozen_params_histogram/251028_0841_rank0_stage0.svg
[rank0]:	> Counts Sum: 769410, Total Sum: 885040 (86.94%), Ratio(%) per element: [86.87, 86.95, 86.87, 86.95, 86.95, 86.99, 86.91, 86.87, 86.91, 86.87, 86.95, 86.91, 86.91, 86.99, 86.87, 86.87, 86.95, 86.91, 86.91, 86.91, 86.95, 86.99, 86.91, 86.95, 86.91, 86.95, 86.99, 86.91, 86.99, 86.95, 86.95, 86.87, 86.91, 86.91, 87.04, 86.95, 86.95]
[rank0]:2025-10-28 08:42:00,071 - INFO - Sleeping 2 seconds for other ranks to complete
[rank2]:2025-10-28 08:42:00,065 - INFO - Elementwise Histogram is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/frozen_params_histogram/251028_0841_rank2_stage2.svg
[rank2]:	> Counts Sum: 749880, Total Sum: 861120 (87.08%), Ratio(%) per element: [87.08, 87.08, 87.08, 87.08, 87.08, 87.08, 87.08, 87.08, 87.08, 87.08, 87.08, 87.08, 87.08, 87.08, 87.08, 87.08, 87.08, 87.08, 87.08, 87.08, 87.08, 87.08, 87.08, 87.08, 87.08, 87.08, 87.08, 87.08, 87.08, 87.08, 87.08, 87.08, 87.08, 87.08, 87.08, 87.08]
[rank2]:2025-10-28 08:42:00,065 - INFO - Destroying the purge thread.
[rank3]:2025-10-28 08:42:00,134 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251028_0841_thry_final1600_rank3.svg
[rank3]:> Batch Time: 1669.75 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:2025-10-28 08:42:00,208 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251028_0841_stage3_final1600.svg
[rank3]:2025-10-28 08:42:00,394 - INFO - Elementwise Histogram is saved as: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1/frozen_params_histogram/251028_0841_rank3_stage3.svg
[rank3]:	> Counts Sum: 160, Total Sum: 693680 (0.02%), Ratio(%) per element: [0.04, 0.04, 0.04, 0.08, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.08, 0.0, 0.08, 0.04, 0.04, 0.04, 0.0, 0.04, 0.0, 0.0, 0.0, 0.0, 0.04, 0.04, 0.04, 0.0, 0.0, 0.0]
[rank3]:2025-10-28 08:42:00,395 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank2]:2025-10-28 08:42:00,621 - INFO - Process group destroyed
[rank1]:2025-10-28 08:42:00,619 - INFO - Process group destroyed
[rank3]:wandb: uploading history steps 80-80, summary, console lines 446-456
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–…â–‡â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–„â–â–ƒâ–â–â–ƒâ–â–ƒâ–â–â–ƒâ–â–ƒâ–ƒâ–â–ƒâ–â–â–ƒâ–â–ƒâ–ƒâ–â–â–‚â–â–ƒâ–ƒâ–â–â–ƒâ–â–ƒâ–ƒâ–ƒâ–â–ƒâ–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–‡â–„â–â–â–â–ƒâ–â–ƒâ–ƒâ–ƒâ–â–ƒâ–ƒâ–ƒâ–ƒâ–â–â–â–â–â–ƒâ–ƒâ–ƒâ–â–â–â–ƒâ–ƒâ–â–â–â–â–ƒâ–â–â–ƒâ–â–â–
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 3.21349
[rank3]:wandb:               final/avg_loss 2.4799
[rank3]:wandb:             final/avg_mfu(%) 6.12331
[rank3]:wandb:             final/avg_tflops 19.41564
[rank3]:wandb:    final/avg_throughput(tps) 2549.25184
[rank3]:wandb:              final/grad_norm 0
[rank3]:wandb:               final/max_loss 2.4799
[rank3]:wandb:                    grad_norm 0
[rank3]:wandb: loss_metrics/global_avg_loss 2.4799
[rank3]:wandb: loss_metrics/global_max_loss 2.4799
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1028_GPipe_timelyapf_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/7tlses22
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data3/shcho/torchtitan/tb/1028_GPipe_timelyapf_dm1/20251028-0656/wandb/run-20251028_065643-7tlses22/logs
[rank0]:2025-10-28 08:42:02,071 - INFO - Training completed
[rank0]:2025-10-28 08:42:02,072 - INFO - Destroying the purge thread.
[rank0]:2025-10-28 08:42:02,491 - INFO - Process group destroyed
[rank3]:2025-10-28 08:42:02,467 - INFO - Process group destroyed
[rank1]:Stage 1: Modules to keep: {'layers.5', 'layers.4', 'layers.6', 'layers.8', 'layers.7'}
[rank2]:Stage 2: Modules to keep: {'layers.11', 'layers.12', 'layers.10', 'layers.9'}
[rank0]:Stage 0: Modules to keep: {'layers.0', 'layers.1', 'layers.3', 'layers.2', 'tok_embeddings'}
[rank3]:Stage 3: Modules to keep: {'layers.13', 'layers.14', 'norm', 'layers.15', 'output'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1026_llama1b/config.toml
[rank3]:		- dump_folder: /data3/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1028_GPipe_timelyapf_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data3/shcho/torchtitan/profile_trace/1028_GPipe_timelyapf_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data3/shcho/torchtitan/memory_snapshot/1028_GPipe_timelyapf_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 20
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data3/shcho/torchtitan/tb/1028_GPipe_timelyapf_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data3/shcho/torchtitan/images/1028_GPipe_timelyapf_dm1
[rank3]:		- pplog_freq: 80
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1028_GPipe_timelyapf_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B-Instruct
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 1e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: alpaca
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 512
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 1600
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: GPipe
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 4
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data3/shcho/torchtitan/checkpoint/1028_GPipe_timelyapf_dm1
[rank3]:		- interval: 800
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B-Instruct/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data3/shcho/torchtitan/comm_traces/1028_GPipe_timelyapf_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: True
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 100
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: timelyapf
[rank3]:		- phase_unit: 10
[rank3]:		- stability_check_freq: 5
[rank3]:		- aggressiveness: 0
[rank3]:
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
