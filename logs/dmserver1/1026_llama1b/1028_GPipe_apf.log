
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 10. 28. (í™”) 01:36:12 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 3,4,5,6
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1026_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1026_llama1b/1028_GPipe_apf.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs
âœ”ï¸Running with apf x GPipe ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1026_llama1b/config.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=apf
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank1]:2025-10-28 01:36:18,331 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs"
[rank3]:2025-10-28 01:36:18,330 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs"
[rank2]:2025-10-28 01:36:18,418 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs"
[rank0]:2025-10-28 01:36:18,588 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs"
[rank0]:2025-10-28 01:36:19,041 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-10-28 01:36:19,045 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-28 01:36:19,051 - INFO - [GC] Initial GC collection 0.00 seconds
[rank1]:2025-10-28 01:36:19,024 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-10-28 01:36:19,027 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-10-28 01:36:19,008 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-10-28 01:36:19,010 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-10-28 01:36:19,025 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-10-28 01:36:19,027 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-28 01:36:19,570 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-10-28 01:36:20,011 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank0]:2025-10-28 01:36:22,790 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=512, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank2]:2025-10-28 01:36:22,988 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-10-28 01:36:22,939 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-10-28 01:36:22,980 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-10-28 01:36:22,981 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank2]:2025-10-28 01:36:23,026 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-10-28 01:36:23,054 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-10-28 01:36:23,054 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-10-28 01:36:23,007 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-10-28 01:36:23,007 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank2]:2025-10-28 01:36:23,226 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-10-28 01:36:23,226 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-10-28 01:36:23,227 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank0]:2025-10-28 01:36:23,209 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-10-28 01:36:23,210 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-10-28 01:36:23,210 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank1]:2025-10-28 01:36:23,251 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-10-28 01:36:23,291 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-10-28 01:36:23,319 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-10-28 01:36:23,319 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank1]:2025-10-28 01:36:23,526 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-10-28 01:36:23,526 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-10-28 01:36:23,527 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run m35e1mnx
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data3/shcho/torchtitan/tb/1028_GPipe_apf_dm1/20251028-0136/wandb/run-20251028_013624-m35e1mnx
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1028_GPipe_apf_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/m35e1mnx
[rank3]:2025-10-28 01:36:25,286 - INFO - WandB logging enabled
[rank3]:2025-10-28 01:36:25,287 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-10-28 01:36:25,325 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-10-28 01:36:25,354 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-10-28 01:36:25,355 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-10-28 01:36:25,595 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data3/shcho/torchtitan/checkpoint/1028_GPipe_apf_dm1
[rank0]:2025-10-28 01:36:25,595 - WARNING - Mixed precision training with TP or PP is only supported when FSDP/HSDP/CP is enabled.
[rank0]:2025-10-28 01:36:25,595 - INFO - Mixed precision training is disabled
[rank0]:2025-10-28 01:36:25,595 - INFO - Preparing c4_validation dataset from allenai/c4
[rank3]:2025-10-28 01:36:25,580 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-10-28 01:36:25,580 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-10-28 01:36:25,581 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank0]:2025-10-28 01:36:30,064 - INFO - Trainer is initialized with local batch size 32, global batch size 64, gradient accumulation steps 2, sequence length 512, total steps 1600 (warmup 100)
[rank0]:2025-10-28 01:36:30,064 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B-Instruct/original_dcp.
[rank0]:2025-10-28 01:36:33,821 - INFO - [GC] GC collection for checkpoint loading. 0.01 seconds
[rank0]:2025-10-28 01:36:33,821 - INFO - Finished loading the checkpoint in 3.76 seconds.
[rank0]:2025-10-28 01:36:33,821 - INFO - Training starts at step 1
[rank0]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/autograd/graph.py:849: UserWarning: Attempting to run cuBLAS, but there was no current CUDA context! Attempting to set the primary context... (Triggered internally at /pytorch/aten/src/ATen/cuda/CublasHandlePool.cpp:270.)
[rank0]:  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
[rank2]:2025-10-28 01:36:42,113 - INFO -  step:  1  loss: -2.0000  grad_norm: 95.1855  memory: 14.29GiB(30.07%)  tps: 429  tflops: 3.27  mfu: 1.05%
[rank2]:2025-10-28 01:36:42,113 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-10-28 01:36:42,115 - INFO -  step:  1  loss: -2.0000  grad_norm: 95.1855  memory: 17.77GiB(37.40%)  tps: 435  tflops: 3.31  mfu: 1.06%
[rank1]:2025-10-28 01:36:42,116 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-10-28 01:36:42,152 - INFO -  step:  1  loss: -2.0000  grad_norm: 95.1855  memory: 17.10GiB(35.99%)  tps: 427  tflops: 3.25  mfu: 1.04%
[rank0]:2025-10-28 01:36:42,152 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-28 01:36:42,123 - INFO -  step:  1  loss:  9.0107  grad_norm: 95.1855  memory: 35.59GiB(74.92%)  tps: 488  tflops: 3.71  mfu: 1.19%
[rank3]:2025-10-28 01:36:42,124 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-10-28 01:36:59,529 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 01:36:59,529 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 01:36:59,529 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 01:36:59,529 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 01:36:59,529 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 01:36:59,529 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 01:36:59,529 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 01:36:59,529 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 01:36:59,529 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 01:36:59,529 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 01:36:59,529 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 01:36:59,529 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 01:36:59,529 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 01:36:59,529 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 01:36:59,529 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 01:36:59,529 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 01:36:59,467 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 01:36:59,468 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 01:36:59,469 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 01:36:59,469 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 01:36:59,469 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 01:36:59,470 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 01:36:59,470 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 01:36:59,470 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 01:36:59,470 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 01:36:59,471 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 01:36:59,471 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 01:36:59,471 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 01:36:59,471 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 01:36:59,472 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 01:36:59,472 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 01:36:59,472 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 01:36:59,604 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 01:36:59,604 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 01:36:59,604 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 01:36:59,604 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 01:36:59,604 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 01:36:59,604 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 01:36:59,604 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 01:36:59,604 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 01:36:59,604 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 01:36:59,604 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 01:36:59,604 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 01:36:59,604 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 01:36:59,604 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 01:36:59,604 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 01:36:59,605 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 01:36:59,605 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 01:36:59,663 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 01:36:59,664 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 01:36:59,664 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 01:36:59,664 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 01:36:59,664 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 01:36:59,664 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 01:36:59,664 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 01:36:59,664 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 01:36:59,664 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 01:36:59,664 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 01:36:59,664 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 01:36:59,664 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 01:36:59,664 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 01:36:59,664 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 01:36:59,664 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 01:36:59,664 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 01:37:57,318 - INFO -  step: 20  loss: -2.0000  grad_norm: 62.3338  memory: 16.10GiB(33.90%)  tps: 2,070  tflops: 15.76  mfu: 5.05%
[rank0]:2025-10-28 01:37:57,338 - INFO -  step: 20  loss: -2.0000  grad_norm: 62.3338  memory: 20.89GiB(43.97%)  tps: 2,070  tflops: 15.77  mfu: 5.05%
[rank1]:2025-10-28 01:37:57,322 - INFO -  step: 20  loss: -2.0000  grad_norm: 62.3338  memory: 20.03GiB(42.17%)  tps: 2,070  tflops: 15.76  mfu: 5.05%
[rank3]:2025-10-28 01:37:57,330 - INFO -  step: 20  loss: 10.8312  grad_norm: 62.3338  memory: 38.93GiB(81.95%)  tps: 2,070  tflops: 15.76  mfu: 5.05%
[rank3]:2025-10-28 01:39:17,288 - INFO -  step: 40  loss:  5.6560  grad_norm: 41.3947  memory: 38.93GiB(81.95%)  tps: 2,049  tflops: 15.61  mfu: 5.00%
[rank0]:2025-10-28 01:39:17,297 - INFO -  step: 40  loss: -2.0000  grad_norm: 41.3947  memory: 20.89GiB(43.97%)  tps: 2,049  tflops: 15.61  mfu: 5.00%
[rank2]:2025-10-28 01:39:17,275 - INFO -  step: 40  loss: -2.0000  grad_norm: 41.3947  memory: 16.10GiB(33.90%)  tps: 2,049  tflops: 15.61  mfu: 5.00%
[rank1]:2025-10-28 01:39:17,279 - INFO -  step: 40  loss: -2.0000  grad_norm: 41.3947  memory: 20.03GiB(42.17%)  tps: 2,049  tflops: 15.61  mfu: 5.00%
[rank3]:2025-10-28 01:39:19,108 - INFO - Avg. fwd time: 71.6338 / Avg. bwd time: 127.5059 / Avg. batch time: 1659.7189 (ms) / GPU bubble ratio: 4.01%
[rank2]:2025-10-28 01:39:19,167 - INFO - Avg. fwd time: 32.2106 / Avg. bwd time: 51.2409 / Avg. batch time: 1746.3624 (ms) / GPU bubble ratio: 61.77%
[rank0]:2025-10-28 01:39:19,308 - INFO - Avg. fwd time: 45.0034 / Avg. bwd time: 57.4152 / Avg. batch time: 1957.1153 (ms) / GPU bubble ratio: 58.13%
[rank1]:2025-10-28 01:39:19,244 - INFO - Avg. fwd time: 49.8679 / Avg. bwd time: 69.5264 / Avg. batch time: 1861.9960 (ms) / GPU bubble ratio: 48.70%
[rank0]:2025-10-28 01:39:53,127 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-28 01:40:36,668 - INFO -  step: 60  loss: -2.0000  grad_norm: 32.0741  memory: 16.10GiB(33.90%)  tps: 2,064  tflops: 15.72  mfu: 5.04%
[rank0]:2025-10-28 01:40:36,688 - INFO -  step: 60  loss: -2.0000  grad_norm: 32.0741  memory: 20.89GiB(43.97%)  tps: 2,064  tflops: 15.72  mfu: 5.04%
[rank3]:2025-10-28 01:40:36,680 - INFO -  step: 60  loss:  8.4675  grad_norm: 32.0741  memory: 38.93GiB(81.95%)  tps: 2,064  tflops: 15.72  mfu: 5.04%
[rank1]:2025-10-28 01:40:36,673 - INFO -  step: 60  loss: -2.0000  grad_norm: 32.0741  memory: 20.03GiB(42.17%)  tps: 2,064  tflops: 15.72  mfu: 5.04%
[rank2]:2025-10-28 01:41:56,186 - INFO -  step: 80  loss: -2.0000  grad_norm: 43.2033  memory: 16.10GiB(33.90%)  tps: 2,060  tflops: 15.69  mfu: 5.03%
[rank0]:2025-10-28 01:41:56,204 - INFO -  step: 80  loss: -2.0000  grad_norm: 43.2033  memory: 20.89GiB(43.97%)  tps: 2,060  tflops: 15.69  mfu: 5.03%
[rank3]:2025-10-28 01:41:56,198 - INFO -  step: 80  loss:  4.0019  grad_norm: 43.2033  memory: 38.93GiB(81.95%)  tps: 2,060  tflops: 15.69  mfu: 5.03%
[rank1]:2025-10-28 01:41:56,189 - INFO -  step: 80  loss: -2.0000  grad_norm: 43.2033  memory: 20.03GiB(42.17%)  tps: 2,060  tflops: 15.69  mfu: 5.03%
[rank2]:2025-10-28 01:41:58,087 - INFO - Avg. fwd time: 32.2935 / Avg. bwd time: 51.5620 / Avg. batch time: 1744.7389 (ms) / GPU bubble ratio: 61.55%
[rank3]:2025-10-28 01:41:58,030 - INFO - Avg. fwd time: 71.7269 / Avg. bwd time: 128.3100 / Avg. batch time: 1658.0522 (ms) / GPU bubble ratio: 3.48%
[rank1]:2025-10-28 01:41:58,160 - INFO - Avg. fwd time: 50.8837 / Avg. bwd time: 70.1529 / Avg. batch time: 1861.0476 (ms) / GPU bubble ratio: 47.97%
[rank0]:2025-10-28 01:41:58,225 - INFO - Avg. fwd time: 45.2447 / Avg. bwd time: 57.9365 / Avg. batch time: 1956.2877 (ms) / GPU bubble ratio: 57.81%
[rank2]:2025-10-28 01:42:55,867 - INFO - Freezing Ratio: [Stage2] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 01:42:55,889 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 01:42:55,871 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 01:42:56,510 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 01:43:07,334 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-28 01:43:09,996 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 01:43:09,997 - INFO -  step: 100  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,220  tflops: 16.91  mfu: 5.42%
[rank2]:2025-10-28 01:43:09,997 - INFO - ðŸ”Ž  Running validation at step 100
[rank0]:2025-10-28 01:43:09,996 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 01:43:09,997 - INFO -  step: 100  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,220  tflops: 16.91  mfu: 5.42%
[rank0]:2025-10-28 01:43:09,997 - INFO - ðŸ”Ž  Running validation at step 100
[rank1]:2025-10-28 01:43:09,996 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 01:43:09,997 - INFO -  step: 100  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,220  tflops: 16.91  mfu: 5.42%
[rank1]:2025-10-28 01:43:09,997 - INFO - ðŸ”Ž  Running validation at step 100
[rank3]:2025-10-28 01:43:12,471 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 01:43:12,474 - INFO -  step: 100  loss:  5.8624  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,148  tflops: 16.36  mfu: 5.24%
[rank3]:2025-10-28 01:43:12,479 - INFO - ðŸ”Ž  Running validation at step 100
[rank0]:2025-10-28 01:44:23,513 - INFO - validate step: 100  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,572
[rank1]:2025-10-28 01:44:23,599 - INFO - validate step: 100  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,565
[rank2]:2025-10-28 01:44:23,679 - INFO - validate step: 100  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,559
[rank3]:2025-10-28 01:44:23,745 - INFO - validate step: 100  loss:  2.1201  memory: 38.93GiB(81.95%)  tps: 5,748
[rank1]:2025-10-28 01:44:23,826 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251028_0144_stage1_step100.svg
[rank2]:2025-10-28 01:44:23,826 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251028_0144_stage2_step100.svg
[rank0]:2025-10-28 01:44:23,828 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251028_0144_stage0_step100.svg
[rank3]:2025-10-28 01:44:23,968 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_GPipe_apf_dm1/pipeline_schedule/251028_0144_real_step100_rank3.svg
[rank3]:> Batch Time: 1907.31 ms, GPU Bubble Ratio: 56.62%, 48.69%, 64.98%, 15.32%
[rank3]:2025-10-28 01:44:24,033 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251028_0144_stage3_step100.svg
[rank1]:2025-10-28 01:44:44,145 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank2]:2025-10-28 01:44:44,142 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 01:44:44,160 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-28 01:44:46,817 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 01:45:00,226 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 01:45:00,226 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-28 01:45:00,226 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 01:45:02,709 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 01:45:16,229 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 01:45:16,229 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 01:45:16,229 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 01:45:18,806 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 01:45:38,648 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-28 01:45:38,648 - INFO -  step: 120  loss: -2.0000  grad_norm: 45.2103  memory: 16.10GiB(33.90%)  tps: 2,185  tflops: 16.64  mfu: 5.33%
[rank0]:2025-10-28 01:45:38,667 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 01:45:38,668 - INFO -  step: 120  loss: -2.0000  grad_norm: 45.2103  memory: 20.89GiB(43.97%)  tps: 2,180  tflops: 16.60  mfu: 5.32%
[rank1]:2025-10-28 01:45:38,659 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank1]:2025-10-28 01:45:38,659 - INFO -  step: 120  loss: -2.0000  grad_norm: 45.2103  memory: 20.03GiB(42.17%)  tps: 2,183  tflops: 16.62  mfu: 5.33%
[rank3]:2025-10-28 01:45:41,118 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 01:45:41,121 - INFO -  step: 120  loss:  2.5406  grad_norm: 45.2103  memory: 38.93GiB(81.95%)  tps: 2,117  tflops: 16.13  mfu: 5.17%
[rank2]:2025-10-28 01:45:42,359 - INFO - Avg. fwd time: 32.4657 / Avg. bwd time: 48.5219 / Avg. batch time: 1721.7007 (ms) / GPU bubble ratio: 62.37%
[rank0]:2025-10-28 01:45:42,402 - INFO - Avg. fwd time: 45.2668 / Avg. bwd time: 51.0410 / Avg. batch time: 1921.7073 (ms) / GPU bubble ratio: 59.91%
[rank3]:2025-10-28 01:45:42,328 - INFO - Avg. fwd time: 71.9015 / Avg. bwd time: 120.6639 / Avg. batch time: 1594.8493 (ms) / GPU bubble ratio: 3.41%
[rank1]:2025-10-28 01:45:42,399 - INFO - Avg. fwd time: 50.9311 / Avg. bwd time: 65.8358 / Avg. batch time: 1833.6985 (ms) / GPU bubble ratio: 49.06%
[rank1]:2025-10-28 01:45:54,536 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank2]:2025-10-28 01:45:54,535 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 01:45:54,536 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-28 01:45:57,003 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 01:46:10,622 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 01:46:10,623 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 01:46:10,622 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank3]:2025-10-28 01:46:13,087 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 01:46:26,377 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 01:46:26,376 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 01:46:26,376 - INFO - Freezing Ratio: [Stage0] 0.03, Threshold: 5.0000e-02
[rank3]:2025-10-28 01:46:28,937 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 01:46:48,600 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank1]:2025-10-28 01:46:48,601 - INFO -  step: 140  loss: -2.0000  grad_norm: 54.6417  memory: 20.03GiB(42.17%)  tps: 2,343  tflops: 17.84  mfu: 5.72%
[rank2]:2025-10-28 01:46:48,596 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-28 01:46:48,596 - INFO -  step: 140  loss: -2.0000  grad_norm: 54.6417  memory: 16.10GiB(33.90%)  tps: 2,342  tflops: 17.84  mfu: 5.72%
[rank0]:2025-10-28 01:46:48,615 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 01:46:48,616 - INFO -  step: 140  loss: -2.0000  grad_norm: 54.6417  memory: 20.89GiB(43.97%)  tps: 2,342  tflops: 17.84  mfu: 5.72%
[rank3]:2025-10-28 01:46:51,058 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 01:46:51,061 - INFO -  step: 140  loss:  4.5642  grad_norm: 54.6417  memory: 38.93GiB(81.95%)  tps: 2,343  tflops: 17.84  mfu: 5.72%
[rank2]:2025-10-28 01:47:04,608 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 01:47:04,608 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 01:47:04,608 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank3]:2025-10-28 01:47:07,096 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 01:47:17,602 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-28 01:47:20,320 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 01:47:20,321 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 01:47:20,321 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank3]:2025-10-28 01:47:22,871 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 01:47:36,256 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 01:47:36,256 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 01:47:36,256 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-28 01:47:38,854 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 01:47:52,217 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 01:47:52,218 - INFO -  step: 160  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,575  tflops: 19.61  mfu: 6.29%
[rank2]:2025-10-28 01:47:52,216 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 01:47:52,217 - INFO -  step: 160  loss: -2.0000  grad_norm:  0.0133  memory: 16.10GiB(33.90%)  tps: 2,575  tflops: 19.61  mfu: 6.29%
[rank0]:2025-10-28 01:47:52,217 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 01:47:52,217 - INFO -  step: 160  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,576  tflops: 19.62  mfu: 6.29%
[rank3]:2025-10-28 01:47:54,685 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 01:47:54,689 - INFO -  step: 160  loss:  2.1840  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,575  tflops: 19.61  mfu: 6.29%
[rank3]:2025-10-28 01:47:56,362 - INFO - Avg. fwd time: 71.8983 / Avg. bwd time: 109.2274 / Avg. batch time: 1501.4265 (ms) / GPU bubble ratio: 3.49%
[rank2]:2025-10-28 01:47:56,420 - INFO - Avg. fwd time: 32.5034 / Avg. bwd time: 44.0074 / Avg. batch time: 1672.8744 (ms) / GPU bubble ratio: 63.41%
[rank1]:2025-10-28 01:47:56,500 - INFO - Avg. fwd time: 51.0040 / Avg. bwd time: 59.5795 / Avg. batch time: 1778.5939 (ms) / GPU bubble ratio: 50.26%
[rank0]:2025-10-28 01:47:56,560 - INFO - Avg. fwd time: 45.0872 / Avg. bwd time: 40.6122 / Avg. batch time: 1855.7562 (ms) / GPU bubble ratio: 63.06%
[rank1]:2025-10-28 01:48:14,326 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 01:48:14,321 - INFO - Freezing Ratio: [Stage2] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 01:48:14,340 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 01:48:16,805 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 01:48:30,201 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 01:48:30,201 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 01:48:30,201 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 01:48:32,852 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 01:48:46,086 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank2]:2025-10-28 01:48:46,086 - INFO - Freezing Ratio: [Stage2] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 01:48:46,086 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 01:48:48,582 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 01:49:01,893 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 01:49:01,893 - INFO -  step: 180  loss: -2.0000  grad_norm:  0.0556  memory: 20.03GiB(42.17%)  tps: 2,351  tflops: 17.91  mfu: 5.74%
[rank2]:2025-10-28 01:49:01,892 - INFO - Freezing Ratio: [Stage2] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 01:49:01,892 - INFO -  step: 180  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,351  tflops: 17.91  mfu: 5.74%
[rank0]:2025-10-28 01:49:01,892 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 01:49:01,893 - INFO -  step: 180  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,351  tflops: 17.91  mfu: 5.74%
[rank3]:2025-10-28 01:49:04,404 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 01:49:04,407 - INFO -  step: 180  loss:  3.8233  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,350  tflops: 17.90  mfu: 5.74%
[rank0]:2025-10-28 01:49:17,854 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-28 01:49:17,854 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-28 01:49:17,855 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 01:49:20,455 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 01:49:33,733 - INFO - Freezing Ratio: [Stage1] 0.02, Threshold: 5.0000e-02
[rank0]:2025-10-28 01:49:33,734 - INFO - Freezing Ratio: [Stage0] 0.03, Threshold: 5.0000e-02
[rank2]:2025-10-28 01:49:33,733 - INFO - Freezing Ratio: [Stage2] 0.03, Threshold: 5.0000e-02
[rank3]:2025-10-28 01:49:36,348 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 01:49:56,071 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank2]:2025-10-28 01:49:56,066 - INFO - Freezing Ratio: [Stage2] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 01:49:56,086 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 01:49:58,620 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 01:50:09,247 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-28 01:50:11,970 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 01:50:11,971 - INFO -  step: 200  loss: -2.0000  grad_norm:  0.0105  memory: 20.03GiB(42.17%)  tps: 2,338  tflops: 17.81  mfu: 5.71%
[rank1]:2025-10-28 01:50:11,971 - INFO - ðŸ”Ž  Running validation at step 200
[rank2]:2025-10-28 01:50:11,969 - INFO - Freezing Ratio: [Stage2] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 01:50:11,969 - INFO -  step: 200  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,338  tflops: 17.81  mfu: 5.71%
[rank2]:2025-10-28 01:50:11,969 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-10-28 01:50:11,969 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 01:50:11,970 - INFO -  step: 200  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,338  tflops: 17.81  mfu: 5.71%
[rank0]:2025-10-28 01:50:11,970 - INFO - ðŸ”Ž  Running validation at step 200
[rank3]:2025-10-28 01:50:14,480 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 01:50:14,484 - INFO -  step: 200  loss:  1.6684  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,338  tflops: 17.81  mfu: 5.71%
[rank3]:2025-10-28 01:50:14,484 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-10-28 01:51:22,799 - INFO - validate step: 200  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,783
[rank1]:2025-10-28 01:51:22,887 - INFO - validate step: 200  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,776
[rank3]:2025-10-28 01:51:23,025 - INFO - validate step: 200  loss:  1.5876  memory: 38.93GiB(81.95%)  tps: 5,976
[rank2]:2025-10-28 01:51:22,962 - INFO - validate step: 200  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,770
[rank0]:2025-10-28 01:51:23,104 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251028_0151_stage0_step200.svg
[rank2]:2025-10-28 01:51:23,104 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251028_0151_stage2_step200.svg
[rank1]:2025-10-28 01:51:23,106 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251028_0151_stage1_step200.svg
[rank3]:2025-10-28 01:51:23,238 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_GPipe_apf_dm1/pipeline_schedule/251028_0151_real_step200_rank3.svg
[rank3]:> Batch Time: 1885.25 ms, GPU Bubble Ratio: 56.95%, 49.88%, 65.13%, 15.16%
[rank3]:2025-10-28 01:51:23,312 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251028_0151_stage3_step200.svg
[rank3]:2025-10-28 01:51:24,502 - INFO - Avg. fwd time: 71.8431 / Avg. bwd time: 103.5413 / Avg. batch time: 1454.5048 (ms) / GPU bubble ratio: 3.54%
[rank2]:2025-10-28 01:51:24,533 - INFO - Avg. fwd time: 32.4943 / Avg. bwd time: 41.7827 / Avg. batch time: 1648.2633 (ms) / GPU bubble ratio: 63.95%
[rank1]:2025-10-28 01:51:24,572 - INFO - Avg. fwd time: 51.0956 / Avg. bwd time: 56.5006 / Avg. batch time: 1750.8838 (ms) / GPU bubble ratio: 50.84%
[rank0]:2025-10-28 01:51:24,580 - INFO - Avg. fwd time: 44.9398 / Avg. bwd time: 35.3764 / Avg. batch time: 1822.5796 (ms) / GPU bubble ratio: 64.75%
[rank2]:2025-10-28 01:51:36,758 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-28 01:51:36,758 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 01:51:36,759 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 01:51:39,395 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 01:51:52,920 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-28 01:51:52,920 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 01:51:52,920 - INFO - Freezing Ratio: [Stage2] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 01:51:55,421 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 01:52:08,795 - INFO - Freezing Ratio: [Stage2] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 01:52:08,795 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-28 01:52:08,795 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 01:52:11,284 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 01:52:24,780 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 01:52:24,780 - INFO -  step: 220  loss: -2.0000  grad_norm:  0.0191  memory: 20.89GiB(43.97%)  tps: 2,643  tflops: 20.13  mfu: 6.45%
[rank1]:2025-10-28 01:52:24,779 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank1]:2025-10-28 01:52:24,779 - INFO -  step: 220  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,647  tflops: 20.16  mfu: 6.46%
[rank2]:2025-10-28 01:52:24,779 - INFO - Freezing Ratio: [Stage2] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 01:52:24,779 - INFO -  step: 220  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,650  tflops: 20.19  mfu: 6.47%
[rank3]:2025-10-28 01:52:27,662 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 01:52:27,667 - INFO -  step: 220  loss:  3.5277  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,535  tflops: 19.30  mfu: 6.19%
[rank0]:2025-10-28 01:52:41,089 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 01:52:41,088 - INFO - Freezing Ratio: [Stage1] 0.02, Threshold: 5.0000e-02
[rank2]:2025-10-28 01:52:41,088 - INFO - Freezing Ratio: [Stage2] 0.03, Threshold: 5.0000e-02
[rank3]:2025-10-28 01:52:43,796 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 01:53:03,440 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 01:53:03,461 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-28 01:53:03,444 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 01:53:06,060 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 01:53:19,562 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 01:53:19,562 - INFO - Freezing Ratio: [Stage2] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 01:53:19,563 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-28 01:53:22,178 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 01:53:35,646 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 01:53:35,646 - INFO -  step: 240  loss: -2.0000  grad_norm:  0.0061  memory: 20.89GiB(43.97%)  tps: 2,312  tflops: 17.61  mfu: 5.64%
[rank1]:2025-10-28 01:53:35,645 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 01:53:35,645 - INFO -  step: 240  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,312  tflops: 17.61  mfu: 5.64%
[rank2]:2025-10-28 01:53:35,645 - INFO - Freezing Ratio: [Stage2] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 01:53:35,645 - INFO -  step: 240  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,312  tflops: 17.61  mfu: 5.64%
[rank3]:2025-10-28 01:53:38,097 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 01:53:38,099 - INFO -  step: 240  loss:  1.4486  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,326  tflops: 17.72  mfu: 5.68%
[rank2]:2025-10-28 01:53:39,328 - INFO - Avg. fwd time: 32.5316 / Avg. bwd time: 39.8401 / Avg. batch time: 1629.0794 (ms) / GPU bubble ratio: 64.46%
[rank0]:2025-10-28 01:53:39,375 - INFO - Avg. fwd time: 44.9264 / Avg. bwd time: 31.3270 / Avg. batch time: 1796.5229 (ms) / GPU bubble ratio: 66.04%
[rank1]:2025-10-28 01:53:39,366 - INFO - Avg. fwd time: 51.0848 / Avg. bwd time: 53.7961 / Avg. batch time: 1729.0216 (ms) / GPU bubble ratio: 51.47%
[rank3]:2025-10-28 01:53:39,296 - INFO - Avg. fwd time: 71.8938 / Avg. bwd time: 98.6376 / Avg. batch time: 1414.9815 (ms) / GPU bubble ratio: 3.59%
[rank2]:2025-10-28 01:53:51,534 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 01:53:51,535 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-28 01:53:51,534 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 01:53:54,026 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 01:54:04,875 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-28 01:54:07,568 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-28 01:54:07,568 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank2]:2025-10-28 01:54:07,568 - INFO - Freezing Ratio: [Stage2] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 01:54:10,059 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 01:54:23,428 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-28 01:54:23,427 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 01:54:23,427 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-28 01:54:25,909 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 01:54:39,347 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 01:54:39,347 - INFO -  step: 260  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,572  tflops: 19.59  mfu: 6.28%
[rank0]:2025-10-28 01:54:39,347 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 01:54:39,348 - INFO -  step: 260  loss: -2.0000  grad_norm:  0.1955  memory: 20.89GiB(43.97%)  tps: 2,572  tflops: 19.59  mfu: 6.28%
[rank2]:2025-10-28 01:54:39,347 - INFO - Freezing Ratio: [Stage2] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 01:54:39,347 - INFO -  step: 260  loss: -2.0000  grad_norm:  0.1955  memory: 16.10GiB(33.90%)  tps: 2,572  tflops: 19.59  mfu: 6.28%
[rank3]:2025-10-28 01:54:41,843 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 01:54:41,847 - INFO -  step: 260  loss:  3.0616  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,570  tflops: 19.58  mfu: 6.27%
[rank2]:2025-10-28 01:54:55,388 - INFO - Freezing Ratio: [Stage2] 0.03, Threshold: 5.0000e-02
[rank1]:2025-10-28 01:54:55,388 - INFO - Freezing Ratio: [Stage1] 0.02, Threshold: 5.0000e-02
[rank0]:2025-10-28 01:54:55,389 - INFO - Freezing Ratio: [Stage0] 0.03, Threshold: 5.0000e-02
[rank3]:2025-10-28 01:54:57,964 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 01:55:17,589 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-28 01:55:17,571 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 01:55:17,568 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-28 01:55:20,057 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 01:55:33,522 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 01:55:33,522 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 01:55:33,522 - INFO - Freezing Ratio: [Stage2] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 01:55:35,996 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 01:55:49,391 - INFO - Freezing Ratio: [Stage2] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 01:55:49,391 - INFO -  step: 280  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,339  tflops: 17.82  mfu: 5.71%
[rank1]:2025-10-28 01:55:49,391 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 01:55:49,392 - INFO -  step: 280  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,339  tflops: 17.82  mfu: 5.71%
[rank0]:2025-10-28 01:55:49,392 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 01:55:49,392 - INFO -  step: 280  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,339  tflops: 17.82  mfu: 5.71%
[rank3]:2025-10-28 01:55:51,863 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 01:55:51,866 - INFO -  step: 280  loss:  1.2116  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,340  tflops: 17.82  mfu: 5.71%
[rank3]:2025-10-28 01:55:53,060 - INFO - Avg. fwd time: 71.9508 / Avg. bwd time: 95.1068 / Avg. batch time: 1386.5946 (ms) / GPU bubble ratio: 3.62%
[rank2]:2025-10-28 01:55:53,091 - INFO - Avg. fwd time: 32.5697 / Avg. bwd time: 38.4584 / Avg. batch time: 1613.5051 (ms) / GPU bubble ratio: 64.78%
[rank1]:2025-10-28 01:55:53,132 - INFO - Avg. fwd time: 51.1215 / Avg. bwd time: 51.8739 / Avg. batch time: 1711.5551 (ms) / GPU bubble ratio: 51.86%
[rank0]:2025-10-28 01:55:53,136 - INFO - Avg. fwd time: 44.9021 / Avg. bwd time: 28.4215 / Avg. batch time: 1776.0336 (ms) / GPU bubble ratio: 66.97%
[rank0]:2025-10-28 01:56:05,153 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-28 01:56:05,152 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank2]:2025-10-28 01:56:05,152 - INFO - Freezing Ratio: [Stage2] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 01:56:07,695 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 01:56:21,214 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 01:56:21,214 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 01:56:21,214 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 01:56:23,707 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 01:56:36,983 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 01:56:36,983 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 01:56:36,982 - INFO - Freezing Ratio: [Stage2] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 01:56:39,448 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 01:56:50,131 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-28 01:56:52,796 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 01:56:52,796 - INFO -  step: 300  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,584  tflops: 19.68  mfu: 6.31%
[rank0]:2025-10-28 01:56:52,797 - INFO - ðŸ”Ž  Running validation at step 300
[rank1]:2025-10-28 01:56:52,796 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 01:56:52,796 - INFO -  step: 300  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,584  tflops: 19.68  mfu: 6.31%
[rank1]:2025-10-28 01:56:52,796 - INFO - ðŸ”Ž  Running validation at step 300
[rank2]:2025-10-28 01:56:52,795 - INFO - Freezing Ratio: [Stage2] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 01:56:52,796 - INFO -  step: 300  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,584  tflops: 19.68  mfu: 6.31%
[rank2]:2025-10-28 01:56:52,796 - INFO - ðŸ”Ž  Running validation at step 300
[rank3]:2025-10-28 01:56:55,279 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 01:56:55,282 - INFO -  step: 300  loss:  2.5852  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,584  tflops: 19.68  mfu: 6.31%
[rank3]:2025-10-28 01:56:55,282 - INFO - ðŸ”Ž  Running validation at step 300
[rank0]:2025-10-28 01:58:03,747 - INFO - validate step: 300  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,773
[rank1]:2025-10-28 01:58:03,830 - INFO - validate step: 300  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,766
[rank2]:2025-10-28 01:58:03,911 - INFO - validate step: 300  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,760
[rank3]:2025-10-28 01:58:03,974 - INFO - validate step: 300  loss:  1.3817  memory: 38.93GiB(81.95%)  tps: 5,963
[rank2]:2025-10-28 01:58:04,051 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251028_0158_stage2_step300.svg
[rank0]:2025-10-28 01:58:04,051 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251028_0158_stage0_step300.svg
[rank1]:2025-10-28 01:58:04,049 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251028_0158_stage1_step300.svg
[rank3]:2025-10-28 01:58:04,167 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_GPipe_apf_dm1/pipeline_schedule/251028_0158_real_step300_rank3.svg
[rank3]:> Batch Time: 1305.73 ms, GPU Bubble Ratio: 69.12%, 45.07%, 63.54%, 13.94%
[rank3]:2025-10-28 01:58:04,234 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251028_0158_stage3_step300.svg
[rank2]:2025-10-28 01:58:17,779 - INFO - Freezing Ratio: [Stage2] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 01:58:17,779 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-28 01:58:17,779 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 01:58:20,464 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 01:58:33,772 - INFO - Freezing Ratio: [Stage1] 0.02, Threshold: 5.0000e-02
[rank2]:2025-10-28 01:58:33,772 - INFO - Freezing Ratio: [Stage2] 0.03, Threshold: 5.0000e-02
[rank0]:2025-10-28 01:58:33,773 - INFO - Freezing Ratio: [Stage0] 0.03, Threshold: 5.0000e-02
[rank3]:2025-10-28 01:58:36,243 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 01:58:56,005 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 01:58:56,001 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 01:58:56,016 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 01:58:58,796 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 01:59:12,138 - INFO - Freezing Ratio: [Stage2] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 01:59:12,139 - INFO -  step: 320  loss: -2.0000  grad_norm:  0.0034  memory: 16.10GiB(33.90%)  tps: 2,401  tflops: 18.29  mfu: 5.86%
[rank0]:2025-10-28 01:59:12,139 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 01:59:12,139 - INFO -  step: 320  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,396  tflops: 18.25  mfu: 5.85%
[rank1]:2025-10-28 01:59:12,138 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 01:59:12,139 - INFO -  step: 320  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,399  tflops: 18.27  mfu: 5.86%
[rank3]:2025-10-28 01:59:14,808 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 01:59:14,812 - INFO -  step: 320  loss:  1.0399  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,313  tflops: 17.62  mfu: 5.65%
[rank3]:2025-10-28 01:59:15,997 - INFO - Avg. fwd time: 71.9398 / Avg. bwd time: 92.4474 / Avg. batch time: 1364.9156 (ms) / GPU bubble ratio: 3.65%
[rank2]:2025-10-28 01:59:16,029 - INFO - Avg. fwd time: 32.5785 / Avg. bwd time: 37.4178 / Avg. batch time: 1598.8686 (ms) / GPU bubble ratio: 64.98%
[rank0]:2025-10-28 01:59:16,073 - INFO - Avg. fwd time: 44.9042 / Avg. bwd time: 25.9393 / Avg. batch time: 1757.3503 (ms) / GPU bubble ratio: 67.75%
[rank1]:2025-10-28 01:59:16,069 - INFO - Avg. fwd time: 51.1087 / Avg. bwd time: 50.4253 / Avg. batch time: 1695.4359 (ms) / GPU bubble ratio: 52.09%
[rank2]:2025-10-28 01:59:28,085 - INFO - Freezing Ratio: [Stage2] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 01:59:28,085 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 01:59:28,085 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank3]:2025-10-28 01:59:30,615 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 01:59:43,886 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 01:59:43,886 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-28 01:59:43,886 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 01:59:46,360 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 01:59:59,651 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 01:59:59,651 - INFO - Freezing Ratio: [Stage2] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 01:59:59,651 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:00:02,139 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:00:15,417 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:00:15,417 - INFO -  step: 340  loss: -2.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,589  tflops: 19.72  mfu: 6.32%
[rank0]:2025-10-28 02:00:15,417 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:00:15,418 - INFO -  step: 340  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,589  tflops: 19.72  mfu: 6.32%
[rank1]:2025-10-28 02:00:15,417 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:00:15,418 - INFO -  step: 340  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,589  tflops: 19.72  mfu: 6.32%
[rank3]:2025-10-28 02:00:17,992 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:00:17,995 - INFO -  step: 340  loss:  2.1095  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,593  tflops: 19.75  mfu: 6.33%
[rank2]:2025-10-28 02:00:31,364 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:00:31,364 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:00:31,364 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:00:34,013 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:00:44,571 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-28 02:00:47,235 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:00:47,235 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:00:47,236 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:00:49,744 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:01:03,076 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:01:03,076 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:01:03,076 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:01:05,572 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:01:18,948 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:01:18,948 - INFO -  step: 360  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,579  tflops: 19.64  mfu: 6.30%
[rank1]:2025-10-28 02:01:18,948 - INFO - Freezing Ratio: [Stage1] 0.02, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:01:18,948 - INFO -  step: 360  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,579  tflops: 19.64  mfu: 6.30%
[rank2]:2025-10-28 02:01:18,947 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:01:18,948 - INFO -  step: 360  loss: -2.0000  grad_norm:  0.0032  memory: 16.10GiB(33.90%)  tps: 2,579  tflops: 19.64  mfu: 6.30%
[rank3]:2025-10-28 02:01:21,477 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:01:21,480 - INFO -  step: 360  loss:  0.9830  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,581  tflops: 19.66  mfu: 6.30%
[rank3]:2025-10-28 02:01:23,171 - INFO - Avg. fwd time: 71.8902 / Avg. bwd time: 89.5564 / Avg. batch time: 1341.1132 (ms) / GPU bubble ratio: 3.69%
[rank2]:2025-10-28 02:01:23,225 - INFO - Avg. fwd time: 32.5886 / Avg. bwd time: 36.2978 / Avg. batch time: 1582.9572 (ms) / GPU bubble ratio: 65.19%
[rank1]:2025-10-28 02:01:23,301 - INFO - Avg. fwd time: 51.0731 / Avg. bwd time: 48.8756 / Avg. batch time: 1677.9221 (ms) / GPU bubble ratio: 52.35%
[rank0]:2025-10-28 02:01:23,368 - INFO - Avg. fwd time: 44.8143 / Avg. bwd time: 23.2109 / Avg. batch time: 1737.0045 (ms) / GPU bubble ratio: 68.67%
[rank1]:2025-10-28 02:01:41,105 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:01:41,101 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:01:41,121 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:01:43,782 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:01:57,212 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:01:57,212 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:01:57,213 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:01:59,800 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:02:13,077 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:02:13,077 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:02:13,077 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:02:15,638 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:02:28,942 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:02:28,943 - INFO -  step: 380  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,341  tflops: 17.83  mfu: 5.71%
[rank1]:2025-10-28 02:02:28,942 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:02:28,943 - INFO -  step: 380  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,341  tflops: 17.83  mfu: 5.71%
[rank2]:2025-10-28 02:02:28,942 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:02:28,942 - INFO -  step: 380  loss: -2.0000  grad_norm:  0.1268  memory: 16.10GiB(33.90%)  tps: 2,341  tflops: 17.83  mfu: 5.71%
[rank3]:2025-10-28 02:02:31,977 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:02:31,980 - INFO -  step: 380  loss:  1.6671  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,324  tflops: 17.70  mfu: 5.67%
[rank1]:2025-10-28 02:02:45,389 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:02:45,389 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:02:45,389 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:02:48,392 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:03:01,572 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:03:01,572 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:03:01,572 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:03:03,998 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:03:17,368 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:03:17,369 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:03:17,368 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:03:19,835 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:03:30,506 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-28 02:03:33,236 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:03:33,237 - INFO -  step: 400  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,548  tflops: 19.41  mfu: 6.22%
[rank1]:2025-10-28 02:03:33,237 - INFO - ðŸ”Ž  Running validation at step 400
[rank2]:2025-10-28 02:03:33,236 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:03:33,237 - INFO -  step: 400  loss: -2.0000  grad_norm:  0.0075  memory: 16.10GiB(33.90%)  tps: 2,548  tflops: 19.41  mfu: 6.22%
[rank2]:2025-10-28 02:03:33,237 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-10-28 02:03:33,237 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:03:33,238 - INFO -  step: 400  loss: -2.0000  grad_norm:  0.0075  memory: 20.89GiB(43.97%)  tps: 2,548  tflops: 19.41  mfu: 6.22%
[rank0]:2025-10-28 02:03:33,238 - INFO - ðŸ”Ž  Running validation at step 400
[rank3]:2025-10-28 02:03:35,691 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:03:35,694 - INFO -  step: 400  loss:  0.8053  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,572  tflops: 19.59  mfu: 6.28%
[rank3]:2025-10-28 02:03:35,695 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-10-28 02:04:44,236 - INFO - validate step: 400  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,769
[rank1]:2025-10-28 02:04:44,324 - INFO - validate step: 400  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,762
[rank2]:2025-10-28 02:04:44,402 - INFO - validate step: 400  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,756
[rank3]:2025-10-28 02:04:44,465 - INFO - validate step: 400  loss:  1.1976  memory: 38.93GiB(81.95%)  tps: 5,956
[rank1]:2025-10-28 02:04:44,547 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251028_0204_stage1_step400.svg
[rank2]:2025-10-28 02:04:44,544 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251028_0204_stage2_step400.svg
[rank0]:2025-10-28 02:04:44,543 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251028_0204_stage0_step400.svg
[rank3]:2025-10-28 02:04:44,661 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_GPipe_apf_dm1/pipeline_schedule/251028_0204_real_step400_rank3.svg
[rank3]:> Batch Time: 1296.39 ms, GPU Bubble Ratio: 69.00%, 45.30%, 63.40%, 13.84%
[rank3]:2025-10-28 02:04:44,734 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251028_0204_stage3_step400.svg
[rank3]:2025-10-28 02:04:45,954 - INFO - Avg. fwd time: 71.8943 / Avg. bwd time: 87.8727 / Avg. batch time: 1327.4105 (ms) / GPU bubble ratio: 3.71%
[rank2]:2025-10-28 02:04:45,986 - INFO - Avg. fwd time: 32.5786 / Avg. bwd time: 35.6439 / Avg. batch time: 1574.1465 (ms) / GPU bubble ratio: 65.33%
[rank0]:2025-10-28 02:04:46,030 - INFO - Avg. fwd time: 44.7832 / Avg. bwd time: 21.6000 / Avg. batch time: 1725.5886 (ms) / GPU bubble ratio: 69.22%
[rank1]:2025-10-28 02:04:46,026 - INFO - Avg. fwd time: 51.0378 / Avg. bwd time: 47.9663 / Avg. batch time: 1668.1590 (ms) / GPU bubble ratio: 52.52%
[rank1]:2025-10-28 02:04:58,253 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:04:58,253 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:04:58,253 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:05:00,885 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:05:14,370 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:05:14,369 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:05:14,370 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:05:16,992 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:05:30,361 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:05:30,362 - INFO - Freezing Ratio: [Stage0] 0.03, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:05:30,362 - INFO - Freezing Ratio: [Stage1] 0.02, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:05:33,019 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:05:52,848 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:05:52,848 - INFO -  step: 420  loss: -2.0000  grad_norm: 39.9699  memory: 20.03GiB(42.17%)  tps: 2,391  tflops: 18.21  mfu: 5.84%
[rank2]:2025-10-28 02:05:52,844 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:05:52,845 - INFO -  step: 420  loss: -2.0000  grad_norm: 39.9699  memory: 16.10GiB(33.90%)  tps: 2,394  tflops: 18.23  mfu: 5.84%
[rank0]:2025-10-28 02:05:52,860 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:05:52,860 - INFO -  step: 420  loss: -2.0000  grad_norm: 39.9699  memory: 20.89GiB(43.97%)  tps: 2,388  tflops: 18.18  mfu: 5.83%
[rank3]:2025-10-28 02:05:55,500 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:05:55,505 - INFO -  step: 420  loss:  1.3733  grad_norm: 39.9699  memory: 38.93GiB(81.95%)  tps: 2,306  tflops: 17.57  mfu: 5.63%
[rank2]:2025-10-28 02:06:08,986 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:06:08,987 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:06:08,987 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:06:11,611 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:06:24,920 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:06:24,921 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:06:24,921 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:06:27,561 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:06:41,016 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:06:41,015 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:06:41,015 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:06:43,649 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:06:57,140 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:06:57,141 - INFO -  step: 440  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,548  tflops: 19.41  mfu: 6.22%
[rank2]:2025-10-28 02:06:57,140 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:06:57,140 - INFO -  step: 440  loss: -2.0000  grad_norm:  0.0137  memory: 16.10GiB(33.90%)  tps: 2,548  tflops: 19.41  mfu: 6.22%
[rank0]:2025-10-28 02:06:57,141 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:06:57,141 - INFO -  step: 440  loss: -2.0000  grad_norm:  0.0137  memory: 20.89GiB(43.97%)  tps: 2,549  tflops: 19.41  mfu: 6.22%
[rank3]:2025-10-28 02:06:59,783 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:06:59,786 - INFO -  step: 440  loss:  0.7012  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,549  tflops: 19.41  mfu: 6.22%
[rank3]:2025-10-28 02:07:00,983 - INFO - Avg. fwd time: 71.9552 / Avg. bwd time: 86.6268 / Avg. batch time: 1317.7260 (ms) / GPU bubble ratio: 3.72%
[rank2]:2025-10-28 02:07:01,015 - INFO - Avg. fwd time: 32.5846 / Avg. bwd time: 35.1441 / Avg. batch time: 1570.9957 (ms) / GPU bubble ratio: 65.51%
[rank0]:2025-10-28 02:07:01,059 - INFO - Avg. fwd time: 44.8002 / Avg. bwd time: 20.3563 / Avg. batch time: 1720.4384 (ms) / GPU bubble ratio: 69.70%
[rank1]:2025-10-28 02:07:01,055 - INFO - Avg. fwd time: 51.0300 / Avg. bwd time: 47.2764 / Avg. batch time: 1664.2935 (ms) / GPU bubble ratio: 52.75%
[rank1]:2025-10-28 02:07:13,162 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:07:13,161 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:07:13,161 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:07:15,799 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:07:26,554 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-28 02:07:29,247 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:07:29,246 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:07:29,246 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:07:31,872 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:07:45,220 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:07:45,220 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:07:45,220 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:07:47,865 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:08:01,219 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:08:01,220 - INFO -  step: 460  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,557  tflops: 19.47  mfu: 6.24%
[rank2]:2025-10-28 02:08:01,219 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:08:01,219 - INFO -  step: 460  loss: -2.0000  grad_norm:  0.2098  memory: 16.10GiB(33.90%)  tps: 2,557  tflops: 19.47  mfu: 6.24%
[rank0]:2025-10-28 02:08:01,219 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:08:01,220 - INFO -  step: 460  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,557  tflops: 19.47  mfu: 6.24%
[rank3]:2025-10-28 02:08:03,784 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:08:03,787 - INFO -  step: 460  loss:  1.3081  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,560  tflops: 19.50  mfu: 6.25%
[rank1]:2025-10-28 02:08:17,208 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:08:17,207 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:08:17,208 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:08:19,791 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:08:33,011 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:08:33,010 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:08:33,010 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:08:36,230 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:08:49,572 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:08:49,572 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:08:49,572 - INFO - Freezing Ratio: [Stage0] 0.03, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:08:52,314 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:09:12,006 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:09:12,007 - INFO -  step: 480  loss: -2.0000  grad_norm: 13.7654  memory: 20.03GiB(42.17%)  tps: 2,315  tflops: 17.63  mfu: 5.65%
[rank2]:2025-10-28 02:09:12,003 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:09:12,003 - INFO -  step: 480  loss: -2.0000  grad_norm: 13.7654  memory: 16.10GiB(33.90%)  tps: 2,315  tflops: 17.63  mfu: 5.65%
[rank0]:2025-10-28 02:09:12,019 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:09:12,020 - INFO -  step: 480  loss: -2.0000  grad_norm: 13.7654  memory: 20.89GiB(43.97%)  tps: 2,314  tflops: 17.62  mfu: 5.65%
[rank3]:2025-10-28 02:09:14,762 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:09:14,766 - INFO -  step: 480  loss:  0.5778  grad_norm: 13.7654  memory: 38.93GiB(81.95%)  tps: 2,308  tflops: 17.58  mfu: 5.63%
[rank3]:2025-10-28 02:09:15,958 - INFO - Avg. fwd time: 71.9522 / Avg. bwd time: 85.5488 / Avg. batch time: 1308.9781 (ms) / GPU bubble ratio: 3.74%
[rank2]:2025-10-28 02:09:15,991 - INFO - Avg. fwd time: 32.5884 / Avg. bwd time: 34.7264 / Avg. batch time: 1568.3586 (ms) / GPU bubble ratio: 65.66%
[rank0]:2025-10-28 02:09:16,039 - INFO - Avg. fwd time: 44.7834 / Avg. bwd time: 19.2697 / Avg. batch time: 1716.1111 (ms) / GPU bubble ratio: 70.14%
[rank1]:2025-10-28 02:09:16,030 - INFO - Avg. fwd time: 51.0756 / Avg. bwd time: 46.6918 / Avg. batch time: 1661.0979 (ms) / GPU bubble ratio: 52.91%
[rank2]:2025-10-28 02:09:28,048 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:09:28,048 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:09:28,048 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:09:30,698 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:09:44,110 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:09:44,110 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:09:44,109 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:09:46,705 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:09:59,934 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:09:59,934 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:09:59,933 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:10:02,681 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:10:13,326 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-28 02:10:15,996 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:10:15,997 - INFO -  step: 500  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,560  tflops: 19.50  mfu: 6.25%
[rank1]:2025-10-28 02:10:15,997 - INFO - ðŸ”Ž  Running validation at step 500
[rank2]:2025-10-28 02:10:15,996 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:10:15,996 - INFO -  step: 500  loss: -2.0000  grad_norm:  0.2441  memory: 16.10GiB(33.90%)  tps: 2,560  tflops: 19.50  mfu: 6.25%
[rank2]:2025-10-28 02:10:15,996 - INFO - ðŸ”Ž  Running validation at step 500
[rank0]:2025-10-28 02:10:15,996 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:10:15,997 - INFO -  step: 500  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,561  tflops: 19.50  mfu: 6.25%
[rank0]:2025-10-28 02:10:15,997 - INFO - ðŸ”Ž  Running validation at step 500
[rank3]:2025-10-28 02:10:18,650 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:10:18,654 - INFO -  step: 500  loss:  1.0009  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,565  tflops: 19.53  mfu: 6.26%
[rank3]:2025-10-28 02:10:18,659 - INFO - ðŸ”Ž  Running validation at step 500
[rank0]:2025-10-28 02:11:27,095 - INFO - validate step: 500  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,761
[rank0]:2025-10-28 02:11:27,096 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-28 02:11:27,103 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank1]:2025-10-28 02:11:27,181 - INFO - validate step: 500  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,754
[rank1]:2025-10-28 02:11:27,182 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-28 02:11:27,260 - INFO - validate step: 500  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,748
[rank2]:2025-10-28 02:11:27,261 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-28 02:11:27,320 - INFO - validate step: 500  loss:  1.0796  memory: 38.93GiB(81.95%)  tps: 5,966
[rank3]:2025-10-28 02:11:27,321 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-28 02:11:29,175 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 1.91 seconds.
[rank1]:2025-10-28 02:11:29,756 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 2.57 seconds.
[rank0]:2025-10-28 02:11:30,818 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-28 02:11:30,826 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.73 seconds.
[rank3]:2025-10-28 02:11:30,889 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.57 seconds.
[rank1]:2025-10-28 02:11:30,976 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251028_0211_stage1_step500.svg
[rank2]:2025-10-28 02:11:30,976 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251028_0211_stage2_step500.svg
[rank0]:2025-10-28 02:11:30,975 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251028_0211_stage0_step500.svg
[rank3]:2025-10-28 02:11:31,271 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_GPipe_apf_dm1/pipeline_schedule/251028_0211_real_step500_rank3.svg
[rank3]:> Batch Time: 1294.23 ms, GPU Bubble Ratio: 68.97%, 45.35%, 63.37%, 13.82%
[rank3]:2025-10-28 02:11:31,338 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251028_0211_stage3_step500.svg
[rank0]:2025-10-28 02:11:44,756 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:11:44,756 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:11:44,756 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:11:47,500 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:12:00,777 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:12:00,776 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:12:00,776 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:12:03,201 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:12:16,550 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:12:16,550 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:12:16,550 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:12:18,962 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:12:32,339 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:12:32,338 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:12:32,339 - INFO -  step: 520  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,515  tflops: 19.15  mfu: 6.14%
[rank2]:2025-10-28 02:12:32,338 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:12:32,339 - INFO -  step: 520  loss: -2.0000  grad_norm:  0.0197  memory: 16.10GiB(33.90%)  tps: 2,518  tflops: 19.17  mfu: 6.15%
[rank0]:2025-10-28 02:12:32,339 - INFO -  step: 520  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,511  tflops: 19.13  mfu: 6.13%
[rank3]:2025-10-28 02:12:34,763 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:12:34,767 - INFO -  step: 520  loss:  0.5573  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,429  tflops: 18.50  mfu: 5.93%
[rank3]:2025-10-28 02:12:35,961 - INFO - Avg. fwd time: 71.9169 / Avg. bwd time: 84.0347 / Avg. batch time: 1296.5230 (ms) / GPU bubble ratio: 3.77%
[rank2]:2025-10-28 02:12:35,993 - INFO - Avg. fwd time: 32.5895 / Avg. bwd time: 34.1328 / Avg. batch time: 1557.5276 (ms) / GPU bubble ratio: 65.73%
[rank0]:2025-10-28 02:12:36,039 - INFO - Avg. fwd time: 44.7942 / Avg. bwd time: 17.8322 / Avg. batch time: 1702.9813 (ms) / GPU bubble ratio: 70.58%
[rank1]:2025-10-28 02:12:36,034 - INFO - Avg. fwd time: 51.0995 / Avg. bwd time: 45.8780 / Avg. batch time: 1649.4453 (ms) / GPU bubble ratio: 52.96%
[rank1]:2025-10-28 02:12:48,072 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:12:48,071 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:12:48,072 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:12:50,925 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:13:04,430 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:13:04,431 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:13:04,431 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:13:07,566 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:13:20,957 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:13:20,957 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:13:20,956 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:13:24,295 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:13:37,677 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:13:37,678 - INFO -  step: 540  loss: -2.0000  grad_norm:  0.2975  memory: 16.10GiB(33.90%)  tps: 2,508  tflops: 19.10  mfu: 6.12%
[rank0]:2025-10-28 02:13:37,678 - INFO - Freezing Ratio: [Stage0] 0.03, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:13:37,678 - INFO -  step: 540  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,508  tflops: 19.10  mfu: 6.12%
[rank1]:2025-10-28 02:13:37,678 - INFO - Freezing Ratio: [Stage1] 0.02, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:13:37,678 - INFO -  step: 540  loss: -2.0000  grad_norm:  0.2975  memory: 20.03GiB(42.17%)  tps: 2,508  tflops: 19.10  mfu: 6.12%
[rank3]:2025-10-28 02:13:40,552 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:13:40,556 - INFO -  step: 540  loss:  1.0013  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,490  tflops: 18.97  mfu: 6.08%
[rank1]:2025-10-28 02:14:00,353 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:14:00,348 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:14:00,363 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:14:03,610 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:14:14,485 - INFO - [GC] Peforming periodical GC collection 0.26 seconds
[rank1]:2025-10-28 02:14:17,210 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:14:17,210 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:14:17,210 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:14:19,839 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:14:33,253 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:14:33,254 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:14:33,254 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:14:35,899 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:14:49,350 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:14:49,350 - INFO -  step: 560  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,286  tflops: 17.41  mfu: 5.58%
[rank2]:2025-10-28 02:14:49,349 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:14:49,350 - INFO -  step: 560  loss: -2.0000  grad_norm:  0.0258  memory: 16.10GiB(33.90%)  tps: 2,286  tflops: 17.41  mfu: 5.58%
[rank0]:2025-10-28 02:14:49,350 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:14:49,350 - INFO -  step: 560  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,286  tflops: 17.41  mfu: 5.58%
[rank3]:2025-10-28 02:14:51,868 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:14:51,871 - INFO -  step: 560  loss:  0.5293  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,297  tflops: 17.50  mfu: 5.61%
[rank3]:2025-10-28 02:14:53,066 - INFO - Avg. fwd time: 71.9229 / Avg. bwd time: 83.3075 / Avg. batch time: 1290.7560 (ms) / GPU bubble ratio: 3.79%
[rank1]:2025-10-28 02:14:53,139 - INFO - Avg. fwd time: 51.1507 / Avg. bwd time: 45.4991 / Avg. batch time: 1649.3467 (ms) / GPU bubble ratio: 53.12%
[rank2]:2025-10-28 02:14:53,100 - INFO - Avg. fwd time: 32.5965 / Avg. bwd time: 33.8572 / Avg. batch time: 1557.8078 (ms) / GPU bubble ratio: 65.87%
[rank0]:2025-10-28 02:14:53,143 - INFO - Avg. fwd time: 44.7702 / Avg. bwd time: 17.1216 / Avg. batch time: 1702.1543 (ms) / GPU bubble ratio: 70.91%
[rank1]:2025-10-28 02:15:05,268 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:15:05,268 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:15:05,268 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:15:07,934 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:15:21,418 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:15:21,418 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:15:21,418 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:15:23,909 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:15:37,286 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:15:37,286 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:15:37,286 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:15:39,816 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:15:53,145 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:15:53,146 - INFO -  step: 580  loss: -2.0000  grad_norm:  0.3231  memory: 16.10GiB(33.90%)  tps: 2,568  tflops: 19.56  mfu: 6.27%
[rank0]:2025-10-28 02:15:53,146 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:15:53,146 - INFO -  step: 580  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,568  tflops: 19.56  mfu: 6.27%
[rank1]:2025-10-28 02:15:53,145 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:15:53,146 - INFO -  step: 580  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,568  tflops: 19.56  mfu: 6.27%
[rank3]:2025-10-28 02:15:55,766 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:15:55,770 - INFO -  step: 580  loss:  0.7631  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,564  tflops: 19.53  mfu: 6.26%
[rank2]:2025-10-28 02:16:09,186 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:16:09,186 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:16:09,186 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:16:11,767 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:16:25,047 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:16:25,046 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:16:25,046 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:16:27,531 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:16:40,942 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:16:40,941 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:16:40,941 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:16:43,464 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:16:54,143 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-28 02:16:56,861 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:16:56,862 - INFO -  step: 600  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,571  tflops: 19.58  mfu: 6.28%
[rank0]:2025-10-28 02:16:56,862 - INFO - ðŸ”Ž  Running validation at step 600
[rank1]:2025-10-28 02:16:56,861 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:16:56,862 - INFO -  step: 600  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,571  tflops: 19.58  mfu: 6.28%
[rank1]:2025-10-28 02:16:56,862 - INFO - ðŸ”Ž  Running validation at step 600
[rank2]:2025-10-28 02:16:56,861 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:16:56,861 - INFO -  step: 600  loss: -2.0000  grad_norm:  0.0249  memory: 16.10GiB(33.90%)  tps: 2,571  tflops: 19.58  mfu: 6.28%
[rank2]:2025-10-28 02:16:56,861 - INFO - ðŸ”Ž  Running validation at step 600
[rank3]:2025-10-28 02:16:59,409 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:16:59,412 - INFO -  step: 600  loss:  0.4544  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,574  tflops: 19.61  mfu: 6.28%
[rank3]:2025-10-28 02:16:59,412 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-10-28 02:18:07,881 - INFO - validate step: 600  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,767
[rank1]:2025-10-28 02:18:07,964 - INFO - validate step: 600  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,761
[rank2]:2025-10-28 02:18:08,045 - INFO - validate step: 600  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,754
[rank3]:2025-10-28 02:18:08,108 - INFO - validate step: 600  loss:  1.0377  memory: 38.93GiB(81.95%)  tps: 5,963
[rank1]:2025-10-28 02:18:08,188 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251028_0218_stage1_step600.svg
[rank2]:2025-10-28 02:18:08,186 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251028_0218_stage2_step600.svg
[rank0]:2025-10-28 02:18:08,187 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251028_0218_stage0_step600.svg
[rank3]:2025-10-28 02:18:08,332 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_GPipe_apf_dm1/pipeline_schedule/251028_0218_real_step600_rank3.svg
[rank3]:> Batch Time: 1287.50 ms, GPU Bubble Ratio: 71.91%, 45.14%, 63.18%, 13.48%
[rank3]:2025-10-28 02:18:08,407 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251028_0218_stage3_step600.svg
[rank2]:2025-10-28 02:18:09,648 - INFO - Avg. fwd time: 32.6049 / Avg. bwd time: 33.4103 / Avg. batch time: 1549.2817 (ms) / GPU bubble ratio: 65.91%
[rank3]:2025-10-28 02:18:09,614 - INFO - Avg. fwd time: 71.9227 / Avg. bwd time: 82.1571 / Avg. batch time: 1281.4827 (ms) / GPU bubble ratio: 3.81%
[rank1]:2025-10-28 02:18:09,689 - INFO - Avg. fwd time: 51.1737 / Avg. bwd time: 44.8812 / Avg. batch time: 1640.2321 (ms) / GPU bubble ratio: 53.15%
[rank0]:2025-10-28 02:18:09,694 - INFO - Avg. fwd time: 44.7574 / Avg. bwd time: 16.0230 / Avg. batch time: 1691.9098 (ms) / GPU bubble ratio: 71.26%
[rank2]:2025-10-28 02:18:21,861 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:18:21,861 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:18:21,862 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:18:24,521 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:18:38,016 - INFO - Freezing Ratio: [Stage0] 0.03, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:18:38,017 - INFO - Freezing Ratio: [Stage1] 0.02, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:18:38,016 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:18:40,491 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:19:00,178 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:19:00,175 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:19:00,196 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:19:02,793 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:19:16,223 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:19:16,224 - INFO -  step: 620  loss: -2.0000  grad_norm:  0.0034  memory: 16.10GiB(33.90%)  tps: 2,403  tflops: 18.30  mfu: 5.87%
[rank0]:2025-10-28 02:19:16,223 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:19:16,224 - INFO -  step: 620  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,397  tflops: 18.26  mfu: 5.85%
[rank1]:2025-10-28 02:19:16,223 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:19:16,224 - INFO -  step: 620  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,400  tflops: 18.28  mfu: 5.86%
[rank3]:2025-10-28 02:19:18,700 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:19:18,704 - INFO -  step: 620  loss:  0.6172  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,321  tflops: 17.68  mfu: 5.67%
[rank2]:2025-10-28 02:19:32,134 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:19:32,134 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:19:32,134 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:19:34,610 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:19:47,856 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:19:47,857 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:19:47,857 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:19:50,422 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:20:03,756 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:20:03,756 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:20:03,756 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:20:06,344 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:20:19,696 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:20:19,696 - INFO -  step: 640  loss: -2.0000  grad_norm:  0.0049  memory: 16.10GiB(33.90%)  tps: 2,581  tflops: 19.66  mfu: 6.30%
[rank0]:2025-10-28 02:20:19,696 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:20:19,697 - INFO -  step: 640  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,581  tflops: 19.66  mfu: 6.30%
[rank1]:2025-10-28 02:20:19,696 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:20:19,697 - INFO -  step: 640  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,581  tflops: 19.66  mfu: 6.30%
[rank3]:2025-10-28 02:20:22,185 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:20:22,189 - INFO -  step: 640  loss:  0.3966  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,581  tflops: 19.66  mfu: 6.30%
[rank3]:2025-10-28 02:20:23,355 - INFO - Avg. fwd time: 71.9258 / Avg. bwd time: 81.6326 / Avg. batch time: 1277.2425 (ms) / GPU bubble ratio: 3.82%
[rank2]:2025-10-28 02:20:23,389 - INFO - Avg. fwd time: 32.6108 / Avg. bwd time: 33.2229 / Avg. batch time: 1547.6226 (ms) / GPU bubble ratio: 65.97%
[rank0]:2025-10-28 02:20:23,435 - INFO - Avg. fwd time: 44.7574 / Avg. bwd time: 15.4765 / Avg. batch time: 1689.4738 (ms) / GPU bubble ratio: 71.48%
[rank1]:2025-10-28 02:20:23,431 - INFO - Avg. fwd time: 51.2119 / Avg. bwd time: 44.6275 / Avg. batch time: 1638.3451 (ms) / GPU bubble ratio: 53.20%
[rank0]:2025-10-28 02:20:35,451 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:20:35,451 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:20:35,450 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:20:37,945 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:20:48,726 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-28 02:20:51,416 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:20:51,416 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:20:51,417 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:20:53,998 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:21:07,298 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:21:07,298 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:21:07,297 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:21:09,922 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:21:23,210 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:21:23,211 - INFO -  step: 660  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,580  tflops: 19.65  mfu: 6.30%
[rank1]:2025-10-28 02:21:23,210 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:21:23,210 - INFO -  step: 660  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,580  tflops: 19.65  mfu: 6.30%
[rank2]:2025-10-28 02:21:23,210 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:21:23,210 - INFO -  step: 660  loss: -2.0000  grad_norm:  0.0028  memory: 16.10GiB(33.90%)  tps: 2,580  tflops: 19.65  mfu: 6.30%
[rank3]:2025-10-28 02:21:25,699 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:21:25,703 - INFO -  step: 660  loss:  0.6240  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,580  tflops: 19.65  mfu: 6.30%
[rank1]:2025-10-28 02:21:39,091 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:21:39,090 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:21:39,091 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:21:41,586 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:21:54,815 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:21:54,815 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:21:54,815 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:21:57,389 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:22:10,751 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:22:10,751 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:22:10,750 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:22:13,365 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:22:26,657 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:22:26,657 - INFO -  step: 680  loss: -2.0000  grad_norm:  0.0049  memory: 16.10GiB(33.90%)  tps: 2,582  tflops: 19.67  mfu: 6.30%
[rank0]:2025-10-28 02:22:26,657 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:22:26,658 - INFO -  step: 680  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,582  tflops: 19.67  mfu: 6.30%
[rank1]:2025-10-28 02:22:26,657 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:22:26,658 - INFO -  step: 680  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,582  tflops: 19.67  mfu: 6.30%
[rank3]:2025-10-28 02:22:29,148 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:22:29,152 - INFO -  step: 680  loss:  0.3918  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,582  tflops: 19.67  mfu: 6.30%
[rank3]:2025-10-28 02:22:30,348 - INFO - Avg. fwd time: 71.8978 / Avg. bwd time: 80.6942 / Avg. batch time: 1269.4883 (ms) / GPU bubble ratio: 3.84%
[rank1]:2025-10-28 02:22:30,429 - INFO - Avg. fwd time: 51.2414 / Avg. bwd time: 44.1375 / Avg. batch time: 1632.2282 (ms) / GPU bubble ratio: 53.25%
[rank2]:2025-10-28 02:22:30,381 - INFO - Avg. fwd time: 32.6166 / Avg. bwd time: 32.8684 / Avg. batch time: 1541.9742 (ms) / GPU bubble ratio: 66.03%
[rank0]:2025-10-28 02:22:30,440 - INFO - Avg. fwd time: 44.7331 / Avg. bwd time: 14.6076 / Avg. batch time: 1682.4607 (ms) / GPU bubble ratio: 71.78%
[rank0]:2025-10-28 02:22:42,531 - INFO - Freezing Ratio: [Stage0] 0.03, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:22:42,530 - INFO - Freezing Ratio: [Stage1] 0.02, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:22:42,530 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:22:45,021 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:23:04,726 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:23:04,712 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:23:04,707 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:23:07,339 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:23:20,575 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:23:20,574 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:23:20,574 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:23:23,199 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:23:33,884 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-28 02:23:36,525 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:23:36,526 - INFO -  step: 700  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,345  tflops: 17.86  mfu: 5.72%
[rank1]:2025-10-28 02:23:36,526 - INFO - ðŸ”Ž  Running validation at step 700
[rank2]:2025-10-28 02:23:36,525 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:23:36,525 - INFO -  step: 700  loss: -2.0000  grad_norm:  0.4363  memory: 16.10GiB(33.90%)  tps: 2,345  tflops: 17.86  mfu: 5.72%
[rank2]:2025-10-28 02:23:36,526 - INFO - ðŸ”Ž  Running validation at step 700
[rank0]:2025-10-28 02:23:36,525 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:23:36,526 - INFO -  step: 700  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,345  tflops: 17.86  mfu: 5.72%
[rank0]:2025-10-28 02:23:36,526 - INFO - ðŸ”Ž  Running validation at step 700
[rank3]:2025-10-28 02:23:38,999 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:23:39,003 - INFO -  step: 700  loss:  0.5252  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,346  tflops: 17.86  mfu: 5.73%
[rank3]:2025-10-28 02:23:39,003 - INFO - ðŸ”Ž  Running validation at step 700
[rank0]:2025-10-28 02:24:47,509 - INFO - validate step: 700  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,770
[rank1]:2025-10-28 02:24:47,594 - INFO - validate step: 700  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,764
[rank2]:2025-10-28 02:24:47,675 - INFO - validate step: 700  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,757
[rank3]:2025-10-28 02:24:47,739 - INFO - validate step: 700  loss:  0.9935  memory: 38.93GiB(81.95%)  tps: 5,959
[rank2]:2025-10-28 02:24:47,825 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251028_0224_stage2_step700.svg
[rank0]:2025-10-28 02:24:47,825 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251028_0224_stage0_step700.svg
[rank1]:2025-10-28 02:24:47,830 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251028_0224_stage1_step700.svg
[rank3]:2025-10-28 02:24:47,949 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_GPipe_apf_dm1/pipeline_schedule/251028_0224_real_step700_rank3.svg
[rank3]:> Batch Time: 1286.72 ms, GPU Bubble Ratio: 71.91%, 45.07%, 63.16%, 13.51%
[rank3]:2025-10-28 02:24:48,023 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251028_0224_stage3_step700.svg
[rank0]:2025-10-28 02:25:01,693 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:25:01,692 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:25:01,692 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:25:04,376 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:25:17,703 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:25:17,703 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:25:17,702 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:25:20,253 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:25:33,750 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:25:33,750 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:25:33,749 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:25:36,302 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:25:49,767 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:25:49,768 - INFO -  step: 720  loss: -2.0000  grad_norm:  0.0223  memory: 20.89GiB(43.97%)  tps: 2,632  tflops: 20.04  mfu: 6.42%
[rank1]:2025-10-28 02:25:49,767 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:25:49,767 - INFO -  step: 720  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,635  tflops: 20.07  mfu: 6.43%
[rank2]:2025-10-28 02:25:49,767 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:25:49,767 - INFO -  step: 720  loss: -2.0000  grad_norm:  0.0223  memory: 16.10GiB(33.90%)  tps: 2,639  tflops: 20.10  mfu: 6.44%
[rank3]:2025-10-28 02:25:52,233 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:25:52,236 - INFO -  step: 720  loss:  0.3990  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,540  tflops: 19.35  mfu: 6.20%
[rank3]:2025-10-28 02:25:53,442 - INFO - Avg. fwd time: 71.9072 / Avg. bwd time: 80.3141 / Avg. batch time: 1266.4572 (ms) / GPU bubble ratio: 3.84%
[rank2]:2025-10-28 02:25:53,475 - INFO - Avg. fwd time: 32.6243 / Avg. bwd time: 32.7197 / Avg. batch time: 1539.4569 (ms) / GPU bubble ratio: 66.04%
[rank0]:2025-10-28 02:25:53,525 - INFO - Avg. fwd time: 44.7390 / Avg. bwd time: 14.3054 / Avg. batch time: 1679.4529 (ms) / GPU bubble ratio: 71.87%
[rank1]:2025-10-28 02:25:53,515 - INFO - Avg. fwd time: 51.2477 / Avg. bwd time: 43.9424 / Avg. batch time: 1629.5215 (ms) / GPU bubble ratio: 53.27%
[rank0]:2025-10-28 02:26:05,597 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:26:05,596 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:26:05,596 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:26:08,052 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:26:21,588 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:26:21,587 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:26:21,587 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:26:24,043 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:26:37,337 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:26:37,337 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:26:37,337 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:26:39,833 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:26:53,271 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:26:53,272 - INFO -  step: 740  loss: -2.0000  grad_norm:  0.4203  memory: 20.89GiB(43.97%)  tps: 2,580  tflops: 19.65  mfu: 6.30%
[rank1]:2025-10-28 02:26:53,270 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:26:53,271 - INFO -  step: 740  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,580  tflops: 19.65  mfu: 6.30%
[rank2]:2025-10-28 02:26:53,270 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:26:53,271 - INFO -  step: 740  loss: -2.0000  grad_norm:  0.4203  memory: 16.10GiB(33.90%)  tps: 2,580  tflops: 19.65  mfu: 6.30%
[rank3]:2025-10-28 02:26:55,816 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:26:55,819 - INFO -  step: 740  loss:  0.5175  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,577  tflops: 19.63  mfu: 6.29%
[rank0]:2025-10-28 02:27:09,290 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:27:09,290 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:27:09,290 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:27:11,836 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:27:22,477 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-28 02:27:25,195 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:27:25,195 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:27:25,195 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:27:27,657 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:27:41,133 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:27:41,132 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:27:41,132 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:27:43,592 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:27:56,921 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:27:56,921 - INFO -  step: 760  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,574  tflops: 19.60  mfu: 6.28%
[rank1]:2025-10-28 02:27:56,921 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:27:56,921 - INFO -  step: 760  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,574  tflops: 19.60  mfu: 6.28%
[rank2]:2025-10-28 02:27:56,920 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:27:56,921 - INFO -  step: 760  loss: -2.0000  grad_norm:  0.0215  memory: 16.10GiB(33.90%)  tps: 2,574  tflops: 19.60  mfu: 6.28%
[rank3]:2025-10-28 02:27:59,464 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:27:59,467 - INFO -  step: 760  loss:  0.4079  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,574  tflops: 19.61  mfu: 6.28%
[rank3]:2025-10-28 02:28:00,668 - INFO - Avg. fwd time: 71.9025 / Avg. bwd time: 79.5678 / Avg. batch time: 1260.4006 (ms) / GPU bubble ratio: 3.86%
[rank0]:2025-10-28 02:28:00,747 - INFO - Avg. fwd time: 44.7323 / Avg. bwd time: 13.6820 / Avg. batch time: 1673.8484 (ms) / GPU bubble ratio: 72.08%
[rank1]:2025-10-28 02:28:00,742 - INFO - Avg. fwd time: 51.2741 / Avg. bwd time: 43.5475 / Avg. batch time: 1624.5567 (ms) / GPU bubble ratio: 53.31%
[rank2]:2025-10-28 02:28:00,702 - INFO - Avg. fwd time: 32.6236 / Avg. bwd time: 32.4203 / Avg. batch time: 1534.8703 (ms) / GPU bubble ratio: 66.10%
[rank0]:2025-10-28 02:28:12,768 - INFO - Freezing Ratio: [Stage0] 0.03, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:28:12,768 - INFO - Freezing Ratio: [Stage1] 0.02, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:28:12,767 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:28:15,405 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:28:35,250 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:28:35,238 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:28:35,235 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:28:37,733 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:28:51,171 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:28:51,170 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:28:51,171 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:28:53,645 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:29:06,982 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:29:06,982 - INFO -  step: 780  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,339  tflops: 17.81  mfu: 5.71%
[rank2]:2025-10-28 02:29:06,981 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:29:06,982 - INFO -  step: 780  loss: -2.0000  grad_norm:  0.2232  memory: 16.10GiB(33.90%)  tps: 2,339  tflops: 17.81  mfu: 5.71%
[rank0]:2025-10-28 02:29:06,981 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:29:06,982 - INFO -  step: 780  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,339  tflops: 17.81  mfu: 5.71%
[rank3]:2025-10-28 02:29:09,461 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:29:09,464 - INFO -  step: 780  loss:  0.5015  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,341  tflops: 17.83  mfu: 5.71%
[rank1]:2025-10-28 02:29:22,851 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:29:22,850 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:29:22,851 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:29:25,415 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:29:38,626 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:29:38,626 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:29:38,626 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:29:41,080 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:29:54,432 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:29:54,432 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:29:54,433 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:29:56,884 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:30:07,545 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-28 02:30:10,282 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:30:10,283 - INFO -  step: 800  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,588  tflops: 19.71  mfu: 6.32%
[rank1]:2025-10-28 02:30:10,283 - INFO - ðŸ”Ž  Running validation at step 800
[rank2]:2025-10-28 02:30:10,282 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:30:10,283 - INFO -  step: 800  loss: -2.0000  grad_norm:  0.0082  memory: 16.10GiB(33.90%)  tps: 2,588  tflops: 19.71  mfu: 6.32%
[rank2]:2025-10-28 02:30:10,283 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-10-28 02:30:10,283 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:30:10,284 - INFO -  step: 800  loss: -2.0000  grad_norm:  0.0082  memory: 20.89GiB(43.97%)  tps: 2,588  tflops: 19.71  mfu: 6.32%
[rank0]:2025-10-28 02:30:10,284 - INFO - ðŸ”Ž  Running validation at step 800
[rank3]:2025-10-28 02:30:12,892 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:30:12,896 - INFO -  step: 800  loss:  0.3656  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,583  tflops: 19.67  mfu: 6.31%
[rank3]:2025-10-28 02:30:12,896 - INFO - ðŸ”Ž  Running validation at step 800
[rank1]:2025-10-28 02:31:21,641 - INFO - validate step: 800  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,740
[rank0]:2025-10-28 02:31:21,559 - INFO - validate step: 800  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,747
[rank2]:2025-10-28 02:31:21,724 - INFO - validate step: 800  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,733
[rank3]:2025-10-28 02:31:21,785 - INFO - validate step: 800  loss:  0.9782  memory: 38.93GiB(81.95%)  tps: 5,946
[rank1]:2025-10-28 02:31:21,869 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251028_0231_stage1_step800.svg
[rank2]:2025-10-28 02:31:21,870 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251028_0231_stage2_step800.svg
[rank0]:2025-10-28 02:31:21,870 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251028_0231_stage0_step800.svg
[rank3]:2025-10-28 02:31:21,978 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_GPipe_apf_dm1/pipeline_schedule/251028_0231_real_step800_rank3.svg
[rank3]:> Batch Time: 1286.28 ms, GPU Bubble Ratio: 71.90%, 45.03%, 63.14%, 13.51%
[rank3]:2025-10-28 02:31:22,052 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251028_0231_stage3_step800.svg
[rank2]:2025-10-28 02:31:23,306 - INFO - Avg. fwd time: 32.6260 / Avg. bwd time: 32.3081 / Avg. batch time: 1532.4975 (ms) / GPU bubble ratio: 66.10%
[rank3]:2025-10-28 02:31:23,273 - INFO - Avg. fwd time: 71.8860 / Avg. bwd time: 79.2789 / Avg. batch time: 1257.9355 (ms) / GPU bubble ratio: 3.86%
[rank1]:2025-10-28 02:31:23,348 - INFO - Avg. fwd time: 51.3060 / Avg. bwd time: 43.4046 / Avg. batch time: 1622.0629 (ms) / GPU bubble ratio: 53.29%
[rank0]:2025-10-28 02:31:23,353 - INFO - Avg. fwd time: 44.7217 / Avg. bwd time: 13.4219 / Avg. batch time: 1671.0892 (ms) / GPU bubble ratio: 72.16%
[rank2]:2025-10-28 02:31:35,508 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:31:35,509 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:31:35,509 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:31:38,169 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:31:51,737 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:31:51,737 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:31:51,737 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:31:54,191 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:31:55,385 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-28 02:31:55,413 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-28 02:31:55,455 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-28 02:31:55,459 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-28 02:32:09,927 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:32:09,927 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:32:09,928 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:32:12,590 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:32:25,968 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:32:25,969 - INFO -  step: 820  loss: -2.0000  grad_norm:  0.2273  memory: 16.10GiB(33.90%)  tps: 2,550  tflops: 19.42  mfu: 6.23%
[rank1]:2025-10-28 02:32:25,969 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:32:25,969 - INFO -  step: 820  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,547  tflops: 19.40  mfu: 6.22%
[rank0]:2025-10-28 02:32:25,969 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:32:25,970 - INFO -  step: 820  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,544  tflops: 19.37  mfu: 6.21%
[rank3]:2025-10-28 02:32:28,686 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:32:28,690 - INFO -  step: 820  loss:  0.4477  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,449  tflops: 18.65  mfu: 5.98%
[rank2]:2025-10-28 02:32:42,211 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:32:42,211 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:32:42,212 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:32:44,789 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:32:58,126 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:32:58,126 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:32:58,127 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:33:00,705 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:33:14,154 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:33:14,154 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:33:14,154 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:33:16,773 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:33:30,199 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:33:30,200 - INFO -  step: 840  loss: -2.0000  grad_norm:  0.0077  memory: 16.10GiB(33.90%)  tps: 2,551  tflops: 19.43  mfu: 6.23%
[rank1]:2025-10-28 02:33:30,199 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:33:30,200 - INFO -  step: 840  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,551  tflops: 19.43  mfu: 6.23%
[rank0]:2025-10-28 02:33:30,199 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:33:30,200 - INFO -  step: 840  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,551  tflops: 19.43  mfu: 6.23%
[rank3]:2025-10-28 02:33:32,655 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:33:32,659 - INFO -  step: 840  loss:  0.3310  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,562  tflops: 19.51  mfu: 6.25%
[rank2]:2025-10-28 02:33:33,871 - INFO - Avg. fwd time: 32.6304 / Avg. bwd time: 32.0595 / Avg. batch time: 1529.3958 (ms) / GPU bubble ratio: 66.16%
[rank1]:2025-10-28 02:33:33,911 - INFO - Avg. fwd time: 51.3402 / Avg. bwd time: 43.0627 / Avg. batch time: 1618.6338 (ms) / GPU bubble ratio: 53.34%
[rank3]:2025-10-28 02:33:33,838 - INFO - Avg. fwd time: 71.8959 / Avg. bwd time: 78.6651 / Avg. batch time: 1253.0911 (ms) / GPU bubble ratio: 3.88%
[rank0]:2025-10-28 02:33:33,916 - INFO - Avg. fwd time: 44.7384 / Avg. bwd time: 12.8130 / Avg. batch time: 1667.0976 (ms) / GPU bubble ratio: 72.38%
[rank2]:2025-10-28 02:33:45,965 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:33:45,966 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:33:45,966 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:33:48,408 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:33:59,200 - INFO - [GC] Peforming periodical GC collection 0.02 seconds
[rank0]:2025-10-28 02:34:01,860 - INFO - Freezing Ratio: [Stage0] 0.03, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:34:01,860 - INFO - Freezing Ratio: [Stage1] 0.02, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:34:01,860 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:34:04,439 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:34:24,030 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:34:24,026 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:34:24,042 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:34:26,653 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:34:40,085 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:34:40,085 - INFO -  step: 860  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,344  tflops: 17.86  mfu: 5.72%
[rank2]:2025-10-28 02:34:40,084 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:34:40,085 - INFO -  step: 860  loss: -2.0000  grad_norm:  0.1385  memory: 16.10GiB(33.90%)  tps: 2,344  tflops: 17.86  mfu: 5.72%
[rank0]:2025-10-28 02:34:40,085 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:34:40,085 - INFO -  step: 860  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,344  tflops: 17.86  mfu: 5.72%
[rank3]:2025-10-28 02:34:42,543 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:34:42,547 - INFO -  step: 860  loss:  0.3906  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,344  tflops: 17.86  mfu: 5.72%
[rank1]:2025-10-28 02:34:56,066 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:34:56,066 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:34:56,066 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:34:58,544 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:35:11,842 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:35:11,841 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:35:11,842 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:35:14,413 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:35:27,788 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:35:27,787 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:35:27,788 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:35:30,396 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:35:43,783 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:35:43,783 - INFO -  step: 880  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,572  tflops: 19.59  mfu: 6.28%
[rank2]:2025-10-28 02:35:43,782 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:35:43,783 - INFO -  step: 880  loss: -2.0000  grad_norm:  0.0144  memory: 16.10GiB(33.90%)  tps: 2,572  tflops: 19.59  mfu: 6.28%
[rank0]:2025-10-28 02:35:43,783 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:35:43,783 - INFO -  step: 880  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,572  tflops: 19.59  mfu: 6.28%
[rank3]:2025-10-28 02:35:46,272 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:35:46,275 - INFO -  step: 880  loss:  0.3589  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,571  tflops: 19.58  mfu: 6.28%
[rank3]:2025-10-28 02:35:47,471 - INFO - Avg. fwd time: 71.8924 / Avg. bwd time: 78.4485 / Avg. batch time: 1251.2994 (ms) / GPU bubble ratio: 3.88%
[rank1]:2025-10-28 02:35:47,546 - INFO - Avg. fwd time: 51.3459 / Avg. bwd time: 42.9578 / Avg. batch time: 1618.1656 (ms) / GPU bubble ratio: 53.38%
[rank2]:2025-10-28 02:35:47,504 - INFO - Avg. fwd time: 32.6287 / Avg. bwd time: 31.9751 / Avg. batch time: 1529.0207 (ms) / GPU bubble ratio: 66.20%
[rank0]:2025-10-28 02:35:47,551 - INFO - Avg. fwd time: 44.7472 / Avg. bwd time: 12.5912 / Avg. batch time: 1666.4004 (ms) / GPU bubble ratio: 72.47%
[rank2]:2025-10-28 02:35:59,523 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:35:59,523 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:35:59,523 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:36:02,012 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:36:15,390 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:36:15,391 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:36:15,391 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:36:17,903 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:36:31,267 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:36:31,267 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:36:31,267 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:36:33,816 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:36:44,487 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-28 02:36:47,166 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:36:47,167 - INFO -  step: 900  loss: -2.0000  grad_norm:  0.1341  memory: 16.10GiB(33.90%)  tps: 2,585  tflops: 19.69  mfu: 6.31%
[rank2]:2025-10-28 02:36:47,167 - INFO - ðŸ”Ž  Running validation at step 900
[rank1]:2025-10-28 02:36:47,167 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:36:47,167 - INFO -  step: 900  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,585  tflops: 19.69  mfu: 6.31%
[rank1]:2025-10-28 02:36:47,167 - INFO - ðŸ”Ž  Running validation at step 900
[rank0]:2025-10-28 02:36:47,167 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:36:47,167 - INFO -  step: 900  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,585  tflops: 19.69  mfu: 6.31%
[rank0]:2025-10-28 02:36:47,167 - INFO - ðŸ”Ž  Running validation at step 900
[rank3]:2025-10-28 02:36:49,663 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:36:49,667 - INFO -  step: 900  loss:  0.3790  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,585  tflops: 19.69  mfu: 6.31%
[rank3]:2025-10-28 02:36:49,672 - INFO - ðŸ”Ž  Running validation at step 900
[rank1]:2025-10-28 02:37:58,059 - INFO - validate step: 900  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,778
[rank0]:2025-10-28 02:37:57,978 - INFO - validate step: 900  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,784
[rank2]:2025-10-28 02:37:58,140 - INFO - validate step: 900  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,771
[rank3]:2025-10-28 02:37:58,203 - INFO - validate step: 900  loss:  0.9693  memory: 38.93GiB(81.95%)  tps: 5,977
[rank2]:2025-10-28 02:37:58,284 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251028_0237_stage2_step900.svg
[rank1]:2025-10-28 02:37:58,284 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251028_0237_stage1_step900.svg
[rank0]:2025-10-28 02:37:58,285 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251028_0237_stage0_step900.svg
[rank3]:2025-10-28 02:37:58,404 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_GPipe_apf_dm1/pipeline_schedule/251028_0237_real_step900_rank3.svg
[rank3]:> Batch Time: 1286.03 ms, GPU Bubble Ratio: 71.89%, 45.02%, 63.14%, 13.53%
[rank3]:2025-10-28 02:37:58,469 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251028_0237_stage3_step900.svg
[rank1]:2025-10-28 02:38:12,083 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:38:12,084 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:38:12,083 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:38:14,707 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:38:27,967 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:38:27,967 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:38:27,968 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:38:30,566 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:38:44,029 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:38:44,029 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:38:44,029 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:38:46,568 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:38:59,998 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:38:59,998 - INFO -  step: 920  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,645  tflops: 20.15  mfu: 6.46%
[rank2]:2025-10-28 02:38:59,998 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:38:59,998 - INFO -  step: 920  loss: -2.0000  grad_norm:  0.0142  memory: 16.10GiB(33.90%)  tps: 2,649  tflops: 20.17  mfu: 6.47%
[rank0]:2025-10-28 02:38:59,999 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:38:59,999 - INFO -  step: 920  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,642  tflops: 20.12  mfu: 6.45%
[rank3]:2025-10-28 02:39:02,470 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:39:02,474 - INFO -  step: 920  loss:  0.4166  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,549  tflops: 19.42  mfu: 6.22%
[rank3]:2025-10-28 02:39:03,673 - INFO - Avg. fwd time: 71.8875 / Avg. bwd time: 77.9131 / Avg. batch time: 1246.9781 (ms) / GPU bubble ratio: 3.90%
[rank2]:2025-10-28 02:39:03,706 - INFO - Avg. fwd time: 32.6276 / Avg. bwd time: 31.7641 / Avg. batch time: 1524.6392 (ms) / GPU bubble ratio: 66.21%
[rank0]:2025-10-28 02:39:03,754 - INFO - Avg. fwd time: 44.7471 / Avg. bwd time: 12.0716 / Avg. batch time: 1661.2012 (ms) / GPU bubble ratio: 72.64%
[rank1]:2025-10-28 02:39:03,749 - INFO - Avg. fwd time: 51.3653 / Avg. bwd time: 42.6681 / Avg. batch time: 1613.4982 (ms) / GPU bubble ratio: 53.38%
[rank1]:2025-10-28 02:39:15,805 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:39:15,805 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:39:15,805 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:39:18,252 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:39:31,668 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:39:31,667 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:39:31,668 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:39:34,115 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:39:47,383 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:39:47,383 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:39:47,383 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:39:49,871 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:40:03,190 - INFO - Freezing Ratio: [Stage1] 0.02, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:40:03,191 - INFO -  step: 940  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,593  tflops: 19.75  mfu: 6.33%
[rank2]:2025-10-28 02:40:03,190 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:40:03,190 - INFO -  step: 940  loss: -2.0000  grad_norm:  0.1283  memory: 16.10GiB(33.90%)  tps: 2,593  tflops: 19.75  mfu: 6.33%
[rank0]:2025-10-28 02:40:03,190 - INFO - Freezing Ratio: [Stage0] 0.03, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:40:03,191 - INFO -  step: 940  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,593  tflops: 19.75  mfu: 6.33%
[rank3]:2025-10-28 02:40:05,659 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:40:05,663 - INFO -  step: 940  loss:  0.4488  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,593  tflops: 19.75  mfu: 6.33%
[rank1]:2025-10-28 02:40:25,324 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:40:25,320 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:40:25,338 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:40:27,799 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:40:38,389 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-28 02:40:41,085 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:40:41,085 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:40:41,086 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:40:43,721 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:40:57,026 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:40:57,025 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:40:57,026 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:40:59,663 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:41:12,973 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:41:12,973 - INFO -  step: 960  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,348  tflops: 17.88  mfu: 5.73%
[rank2]:2025-10-28 02:41:12,972 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:41:12,973 - INFO -  step: 960  loss: -2.0000  grad_norm:  0.0026  memory: 16.10GiB(33.90%)  tps: 2,348  tflops: 17.88  mfu: 5.73%
[rank0]:2025-10-28 02:41:12,973 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:41:12,973 - INFO -  step: 960  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,348  tflops: 17.88  mfu: 5.73%
[rank3]:2025-10-28 02:41:15,435 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:41:15,438 - INFO -  step: 960  loss:  0.3821  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,348  tflops: 17.88  mfu: 5.73%
[rank3]:2025-10-28 02:41:16,635 - INFO - Avg. fwd time: 71.8676 / Avg. bwd time: 77.7341 / Avg. batch time: 1245.3624 (ms) / GPU bubble ratio: 3.90%
[rank2]:2025-10-28 02:41:16,669 - INFO - Avg. fwd time: 32.6293 / Avg. bwd time: 31.6963 / Avg. batch time: 1524.1535 (ms) / GPU bubble ratio: 66.24%
[rank0]:2025-10-28 02:41:16,715 - INFO - Avg. fwd time: 44.7441 / Avg. bwd time: 11.8977 / Avg. batch time: 1660.4432 (ms) / GPU bubble ratio: 72.71%
[rank1]:2025-10-28 02:41:16,709 - INFO - Avg. fwd time: 51.3554 / Avg. bwd time: 42.5813 / Avg. batch time: 1612.9167 (ms) / GPU bubble ratio: 53.41%
[rank1]:2025-10-28 02:41:28,702 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:41:28,702 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:41:28,702 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:41:31,169 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:41:44,500 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:41:44,500 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:41:44,500 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:41:47,010 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:42:00,272 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:42:00,272 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:42:00,272 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:42:02,787 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:42:16,110 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:42:16,111 - INFO -  step: 980  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,595  tflops: 19.76  mfu: 6.33%
[rank1]:2025-10-28 02:42:16,110 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:42:16,111 - INFO -  step: 980  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,595  tflops: 19.76  mfu: 6.33%
[rank2]:2025-10-28 02:42:16,110 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:42:16,110 - INFO -  step: 980  loss: -2.0000  grad_norm:  0.0961  memory: 16.10GiB(33.90%)  tps: 2,595  tflops: 19.76  mfu: 6.33%
[rank3]:2025-10-28 02:42:18,601 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:42:18,605 - INFO -  step: 980  loss:  0.3954  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,594  tflops: 19.76  mfu: 6.33%
[rank1]:2025-10-28 02:42:31,979 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:42:31,979 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:42:31,979 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:42:34,476 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:42:47,718 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:42:47,717 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:42:47,718 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:42:50,221 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:43:03,645 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:43:03,645 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:43:03,645 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:43:06,188 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:43:16,881 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-28 02:43:19,626 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:43:19,626 - INFO -  step: 1000  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,580  tflops: 19.65  mfu: 6.30%
[rank1]:2025-10-28 02:43:19,626 - INFO - ðŸ”Ž  Running validation at step 1000
[rank2]:2025-10-28 02:43:19,626 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:43:19,626 - INFO -  step: 1000  loss: -2.0000  grad_norm:  0.0030  memory: 16.10GiB(33.90%)  tps: 2,580  tflops: 19.65  mfu: 6.30%
[rank2]:2025-10-28 02:43:19,626 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-10-28 02:43:19,626 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:43:19,627 - INFO -  step: 1000  loss: -2.0000  grad_norm:  0.0030  memory: 20.89GiB(43.97%)  tps: 2,580  tflops: 19.65  mfu: 6.30%
[rank0]:2025-10-28 02:43:19,627 - INFO - ðŸ”Ž  Running validation at step 1000
[rank3]:2025-10-28 02:43:22,163 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:43:22,166 - INFO -  step: 1000  loss:  0.3628  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,578  tflops: 19.63  mfu: 6.29%
[rank3]:2025-10-28 02:43:22,171 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-10-28 02:44:30,857 - INFO - validate step: 1000  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,750
[rank0]:2025-10-28 02:44:30,858 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-28 02:44:30,867 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank1]:2025-10-28 02:44:30,941 - INFO - validate step: 1000  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,744
[rank1]:2025-10-28 02:44:30,942 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-28 02:44:31,024 - INFO - validate step: 1000  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,737
[rank2]:2025-10-28 02:44:31,025 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-28 02:44:31,087 - INFO - validate step: 1000  loss:  0.9635  memory: 38.93GiB(81.95%)  tps: 5,944
[rank3]:2025-10-28 02:44:31,089 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-28 02:44:32,863 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 1.84 seconds.
[rank1]:2025-10-28 02:44:33,264 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 2.32 seconds.
[rank3]:2025-10-28 02:44:35,061 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.97 seconds.
[rank0]:2025-10-28 02:44:35,180 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-28 02:44:35,187 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 4.33 seconds.
[rank2]:2025-10-28 02:44:35,267 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251028_0244_stage2_step1000.svg
[rank1]:2025-10-28 02:44:35,271 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251028_0244_stage1_step1000.svg
[rank0]:2025-10-28 02:44:35,383 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251028_0244_stage0_step1000.svg
[rank3]:2025-10-28 02:44:35,557 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_GPipe_apf_dm1/pipeline_schedule/251028_0244_real_step1000_rank3.svg
[rank3]:> Batch Time: 1285.55 ms, GPU Bubble Ratio: 71.88%, 45.02%, 63.13%, 13.54%
[rank3]:2025-10-28 02:44:35,633 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251028_0244_stage3_step1000.svg
[rank3]:2025-10-28 02:44:36,814 - INFO - Avg. fwd time: 71.8356 / Avg. bwd time: 77.2669 / Avg. batch time: 1241.3727 (ms) / GPU bubble ratio: 3.91%
[rank2]:2025-10-28 02:44:36,848 - INFO - Avg. fwd time: 32.6350 / Avg. bwd time: 31.5165 / Avg. batch time: 1519.9512 (ms) / GPU bubble ratio: 66.23%
[rank1]:2025-10-28 02:44:36,890 - INFO - Avg. fwd time: 51.3812 / Avg. bwd time: 42.3261 / Avg. batch time: 1608.4627 (ms) / GPU bubble ratio: 53.39%
[rank0]:2025-10-28 02:44:36,896 - INFO - Avg. fwd time: 44.7585 / Avg. bwd time: 11.4472 / Avg. batch time: 1655.5327 (ms) / GPU bubble ratio: 72.84%
[rank2]:2025-10-28 02:44:49,060 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:44:49,060 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:44:49,061 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:44:52,023 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:45:05,548 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:45:05,548 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:45:05,549 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:45:08,130 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:45:21,469 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:45:21,470 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:45:21,470 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:45:24,321 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:45:37,685 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:45:37,686 - INFO -  step: 1020  loss: -2.0000  grad_norm:  0.0958  memory: 16.10GiB(33.90%)  tps: 2,458  tflops: 18.72  mfu: 6.00%
[rank1]:2025-10-28 02:45:37,685 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:45:37,686 - INFO -  step: 1020  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,455  tflops: 18.70  mfu: 5.99%
[rank0]:2025-10-28 02:45:37,686 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:45:37,687 - INFO -  step: 1020  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,452  tflops: 18.67  mfu: 5.98%
[rank3]:2025-10-28 02:45:40,655 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:45:40,659 - INFO -  step: 1020  loss:  0.3710  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,355  tflops: 17.94  mfu: 5.75%
[rank2]:2025-10-28 02:45:54,141 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:45:54,141 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:45:54,142 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:45:57,212 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:46:10,451 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:46:10,451 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:46:10,451 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:46:13,582 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:46:27,006 - INFO - Freezing Ratio: [Stage1] 0.02, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:46:27,006 - INFO - Freezing Ratio: [Stage0] 0.03, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:46:27,006 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:46:30,155 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:46:49,917 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:46:49,918 - INFO -  step: 1040  loss: -2.0000  grad_norm:  2.8860  memory: 16.10GiB(33.90%)  tps: 2,268  tflops: 17.28  mfu: 5.54%
[rank1]:2025-10-28 02:46:49,920 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:46:49,926 - INFO -  step: 1040  loss: -2.0000  grad_norm:  2.8860  memory: 20.03GiB(42.17%)  tps: 2,268  tflops: 17.27  mfu: 5.54%
[rank0]:2025-10-28 02:46:49,936 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:46:49,937 - INFO -  step: 1040  loss: -2.0000  grad_norm:  2.8860  memory: 20.89GiB(43.97%)  tps: 2,268  tflops: 17.27  mfu: 5.54%
[rank3]:2025-10-28 02:46:53,311 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:46:53,314 - INFO -  step: 1040  loss:  0.3018  grad_norm:  2.8860  memory: 38.93GiB(81.95%)  tps: 2,255  tflops: 17.18  mfu: 5.50%
[rank3]:2025-10-28 02:46:54,518 - INFO - Avg. fwd time: 71.8310 / Avg. bwd time: 77.1449 / Avg. batch time: 1240.3774 (ms) / GPU bubble ratio: 3.92%
[rank2]:2025-10-28 02:46:54,552 - INFO - Avg. fwd time: 32.6326 / Avg. bwd time: 31.4656 / Avg. batch time: 1521.9231 (ms) / GPU bubble ratio: 66.31%
[rank1]:2025-10-28 02:46:54,593 - INFO - Avg. fwd time: 51.4127 / Avg. bwd time: 42.2563 / Avg. batch time: 1610.3913 (ms) / GPU bubble ratio: 53.47%
[rank0]:2025-10-28 02:46:54,599 - INFO - Avg. fwd time: 44.7776 / Avg. bwd time: 11.2857 / Avg. batch time: 1657.3042 (ms) / GPU bubble ratio: 72.94%
[rank2]:2025-10-28 02:47:06,628 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:47:06,628 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:47:06,629 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:47:09,982 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:47:21,022 - INFO - [GC] Peforming periodical GC collection 0.28 seconds
[rank2]:2025-10-28 02:47:23,734 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:47:23,735 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:47:23,735 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:47:26,261 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:47:39,598 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:47:39,599 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:47:39,598 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:47:42,261 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:47:55,596 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:47:55,596 - INFO -  step: 1060  loss: -2.0000  grad_norm:  0.0434  memory: 16.10GiB(33.90%)  tps: 2,495  tflops: 19.00  mfu: 6.09%
[rank1]:2025-10-28 02:47:55,596 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:47:55,597 - INFO -  step: 1060  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,495  tflops: 19.00  mfu: 6.09%
[rank0]:2025-10-28 02:47:55,596 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:47:55,597 - INFO -  step: 1060  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,495  tflops: 19.00  mfu: 6.09%
[rank3]:2025-10-28 02:47:58,084 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:47:58,087 - INFO -  step: 1060  loss:  0.3109  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,530  tflops: 19.27  mfu: 6.17%
[rank2]:2025-10-28 02:48:11,437 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:48:11,437 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:48:11,437 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:48:13,961 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:48:27,173 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:48:27,173 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:48:27,173 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:48:29,679 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:48:43,045 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:48:43,045 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:48:43,045 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:48:45,548 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:48:58,926 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:48:58,926 - INFO -  step: 1080  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,587  tflops: 19.70  mfu: 6.32%
[rank0]:2025-10-28 02:48:58,926 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:48:58,927 - INFO -  step: 1080  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,587  tflops: 19.70  mfu: 6.32%
[rank2]:2025-10-28 02:48:58,926 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:48:58,926 - INFO -  step: 1080  loss: -2.0000  grad_norm:  0.0041  memory: 16.10GiB(33.90%)  tps: 2,587  tflops: 19.70  mfu: 6.32%
[rank3]:2025-10-28 02:49:01,463 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:49:01,466 - INFO -  step: 1080  loss:  0.2317  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,585  tflops: 19.69  mfu: 6.31%
[rank3]:2025-10-28 02:49:02,662 - INFO - Avg. fwd time: 71.8141 / Avg. bwd time: 76.7286 / Avg. batch time: 1236.9254 (ms) / GPU bubble ratio: 3.93%
[rank2]:2025-10-28 02:49:02,696 - INFO - Avg. fwd time: 32.6349 / Avg. bwd time: 31.3027 / Avg. batch time: 1519.7221 (ms) / GPU bubble ratio: 66.34%
[rank1]:2025-10-28 02:49:02,739 - INFO - Avg. fwd time: 51.4377 / Avg. bwd time: 42.0390 / Avg. batch time: 1607.9723 (ms) / GPU bubble ratio: 53.49%
[rank0]:2025-10-28 02:49:02,745 - INFO - Avg. fwd time: 44.7695 / Avg. bwd time: 10.8911 / Avg. batch time: 1654.4810 (ms) / GPU bubble ratio: 73.09%
[rank2]:2025-10-28 02:49:14,758 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:49:14,759 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:49:14,758 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:49:17,339 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:49:30,778 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:49:30,779 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:49:30,778 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:49:33,274 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:49:46,558 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:49:46,559 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:49:46,559 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:49:49,047 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:49:59,823 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-28 02:50:02,462 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:50:02,462 - INFO -  step: 1100  loss: -2.0000  grad_norm:  0.0525  memory: 16.10GiB(33.90%)  tps: 2,579  tflops: 19.64  mfu: 6.29%
[rank2]:2025-10-28 02:50:02,463 - INFO - ðŸ”Ž  Running validation at step 1100
[rank1]:2025-10-28 02:50:02,463 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:50:02,463 - INFO -  step: 1100  loss: -2.0000  grad_norm:  0.0525  memory: 20.03GiB(42.17%)  tps: 2,579  tflops: 19.64  mfu: 6.29%
[rank1]:2025-10-28 02:50:02,463 - INFO - ðŸ”Ž  Running validation at step 1100
[rank0]:2025-10-28 02:50:02,462 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:50:02,463 - INFO -  step: 1100  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,579  tflops: 19.64  mfu: 6.29%
[rank0]:2025-10-28 02:50:02,463 - INFO - ðŸ”Ž  Running validation at step 1100
[rank3]:2025-10-28 02:50:04,958 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:50:04,962 - INFO -  step: 1100  loss:  0.4352  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,580  tflops: 19.65  mfu: 6.30%
[rank3]:2025-10-28 02:50:04,967 - INFO - ðŸ”Ž  Running validation at step 1100
[rank0]:2025-10-28 02:51:13,680 - INFO - validate step: 1100  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,751
[rank1]:2025-10-28 02:51:13,758 - INFO - validate step: 1100  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,745
[rank2]:2025-10-28 02:51:13,839 - INFO - validate step: 1100  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,739
[rank3]:2025-10-28 02:51:13,902 - INFO - validate step: 1100  loss:  0.9633  memory: 38.93GiB(81.95%)  tps: 5,942
[rank0]:2025-10-28 02:51:13,991 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251028_0251_stage0_step1100.svg
[rank1]:2025-10-28 02:51:13,991 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251028_0251_stage1_step1100.svg
[rank2]:2025-10-28 02:51:13,990 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251028_0251_stage2_step1100.svg
[rank3]:2025-10-28 02:51:14,113 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_GPipe_apf_dm1/pipeline_schedule/251028_0251_real_step1100_rank3.svg
[rank3]:> Batch Time: 1285.30 ms, GPU Bubble Ratio: 71.88%, 45.00%, 63.12%, 13.55%
[rank3]:2025-10-28 02:51:14,183 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251028_0251_stage3_step1100.svg
[rank0]:2025-10-28 02:51:27,798 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:51:27,797 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:51:27,797 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:51:30,497 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:51:43,831 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:51:43,831 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:51:43,830 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:51:46,365 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:51:59,953 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:51:59,953 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:51:59,953 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:52:02,435 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:52:15,883 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:52:15,884 - INFO -  step: 1120  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,637  tflops: 20.09  mfu: 6.44%
[rank2]:2025-10-28 02:52:15,883 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:52:15,883 - INFO -  step: 1120  loss: -2.0000  grad_norm:  0.0049  memory: 16.10GiB(33.90%)  tps: 2,641  tflops: 20.11  mfu: 6.45%
[rank0]:2025-10-28 02:52:15,884 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:52:15,884 - INFO -  step: 1120  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,634  tflops: 20.06  mfu: 6.43%
[rank3]:2025-10-28 02:52:18,446 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:52:18,449 - INFO -  step: 1120  loss:  0.2916  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,538  tflops: 19.33  mfu: 6.20%
[rank3]:2025-10-28 02:52:19,649 - INFO - Avg. fwd time: 71.8206 / Avg. bwd time: 76.3569 / Avg. batch time: 1233.9869 (ms) / GPU bubble ratio: 3.94%
[rank2]:2025-10-28 02:52:19,683 - INFO - Avg. fwd time: 32.6350 / Avg. bwd time: 31.1547 / Avg. batch time: 1516.5808 (ms) / GPU bubble ratio: 66.35%
[rank0]:2025-10-28 02:52:19,730 - INFO - Avg. fwd time: 44.7710 / Avg. bwd time: 10.5250 / Avg. batch time: 1650.7883 (ms) / GPU bubble ratio: 73.20%
[rank1]:2025-10-28 02:52:19,724 - INFO - Avg. fwd time: 51.4617 / Avg. bwd time: 41.8350 / Avg. batch time: 1604.6477 (ms) / GPU bubble ratio: 53.49%
[rank2]:2025-10-28 02:52:31,820 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:52:31,821 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:52:31,821 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:52:34,432 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:52:47,898 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:52:47,897 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:52:47,897 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:52:50,425 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:53:03,733 - INFO - Freezing Ratio: [Stage0] 0.03, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:53:03,733 - INFO - Freezing Ratio: [Stage1] 0.02, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:53:03,732 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:53:06,251 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:53:25,981 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:53:25,981 - INFO -  step: 1140  loss: -2.0000  grad_norm:  5.4102  memory: 16.10GiB(33.90%)  tps: 2,337  tflops: 17.80  mfu: 5.71%
[rank0]:2025-10-28 02:53:26,005 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:53:26,006 - INFO -  step: 1140  loss: -2.0000  grad_norm:  5.4102  memory: 20.89GiB(43.97%)  tps: 2,337  tflops: 17.80  mfu: 5.70%
[rank1]:2025-10-28 02:53:25,984 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:53:25,985 - INFO -  step: 1140  loss: -2.0000  grad_norm:  5.4102  memory: 20.03GiB(42.17%)  tps: 2,337  tflops: 17.80  mfu: 5.71%
[rank3]:2025-10-28 02:53:28,479 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:53:28,482 - INFO -  step: 1140  loss:  0.2912  grad_norm:  5.4102  memory: 38.93GiB(81.95%)  tps: 2,340  tflops: 17.82  mfu: 5.71%
[rank0]:2025-10-28 02:53:41,972 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:53:41,972 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:53:41,972 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:53:44,491 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:53:55,105 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-28 02:53:57,815 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:53:57,815 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:53:57,815 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:54:00,319 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:54:13,779 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:54:13,779 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:54:13,779 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:54:16,300 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:54:29,682 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:54:29,682 - INFO -  step: 1160  loss: -2.0000  grad_norm:  0.0094  memory: 16.10GiB(33.90%)  tps: 2,572  tflops: 19.59  mfu: 6.28%
[rank0]:2025-10-28 02:54:29,682 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:54:29,691 - INFO -  step: 1160  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,573  tflops: 19.59  mfu: 6.28%
[rank1]:2025-10-28 02:54:29,682 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:54:29,690 - INFO -  step: 1160  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,572  tflops: 19.59  mfu: 6.28%
[rank3]:2025-10-28 02:54:32,327 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:54:32,332 - INFO -  step: 1160  loss:  0.3224  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,566  tflops: 19.54  mfu: 6.26%
[rank3]:2025-10-28 02:54:33,538 - INFO - Avg. fwd time: 71.8239 / Avg. bwd time: 76.2754 / Avg. batch time: 1233.3430 (ms) / GPU bubble ratio: 3.94%
[rank2]:2025-10-28 02:54:33,572 - INFO - Avg. fwd time: 32.6358 / Avg. bwd time: 31.1254 / Avg. batch time: 1516.8363 (ms) / GPU bubble ratio: 66.37%
[rank0]:2025-10-28 02:54:33,621 - INFO - Avg. fwd time: 44.7810 / Avg. bwd time: 10.4126 / Avg. batch time: 1650.9094 (ms) / GPU bubble ratio: 73.25%
[rank1]:2025-10-28 02:54:33,615 - INFO - Avg. fwd time: 51.4741 / Avg. bwd time: 41.7958 / Avg. batch time: 1604.8769 (ms) / GPU bubble ratio: 53.51%
[rank2]:2025-10-28 02:54:45,706 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:54:45,707 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:54:45,707 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:54:48,359 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:55:01,785 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:55:01,785 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:55:01,785 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:55:04,271 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:55:17,471 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:55:17,471 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:55:17,471 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:55:19,953 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:55:33,382 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:55:33,383 - INFO -  step: 1180  loss: -2.0000  grad_norm:  0.0379  memory: 16.10GiB(33.90%)  tps: 2,572  tflops: 19.59  mfu: 6.28%
[rank0]:2025-10-28 02:55:33,383 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:55:33,384 - INFO -  step: 1180  loss: -2.0000  grad_norm:  0.0379  memory: 20.89GiB(43.97%)  tps: 2,572  tflops: 19.59  mfu: 6.28%
[rank1]:2025-10-28 02:55:33,382 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:55:33,383 - INFO -  step: 1180  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,572  tflops: 19.59  mfu: 6.28%
[rank3]:2025-10-28 02:55:35,867 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:55:35,871 - INFO -  step: 1180  loss:  0.3601  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,579  tflops: 19.64  mfu: 6.29%
[rank2]:2025-10-28 02:55:49,288 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:55:49,289 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:55:49,289 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:55:51,852 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:56:05,141 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:56:05,141 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:56:05,141 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:56:07,628 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:56:21,044 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:56:21,045 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:56:21,044 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:56:23,526 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:56:34,148 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-28 02:56:36,836 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:56:36,836 - INFO -  step: 1200  loss: -2.0000  grad_norm:  0.0118  memory: 16.10GiB(33.90%)  tps: 2,582  tflops: 19.67  mfu: 6.30%
[rank2]:2025-10-28 02:56:36,836 - INFO - ðŸ”Ž  Running validation at step 1200
[rank0]:2025-10-28 02:56:36,836 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:56:36,837 - INFO -  step: 1200  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,582  tflops: 19.67  mfu: 6.30%
[rank0]:2025-10-28 02:56:36,837 - INFO - ðŸ”Ž  Running validation at step 1200
[rank1]:2025-10-28 02:56:36,837 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:56:36,837 - INFO -  step: 1200  loss: -2.0000  grad_norm:  0.0118  memory: 20.03GiB(42.17%)  tps: 2,582  tflops: 19.67  mfu: 6.30%
[rank1]:2025-10-28 02:56:36,837 - INFO - ðŸ”Ž  Running validation at step 1200
[rank3]:2025-10-28 02:56:39,317 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:56:39,321 - INFO -  step: 1200  loss:  0.2543  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,582  tflops: 19.67  mfu: 6.30%
[rank3]:2025-10-28 02:56:39,326 - INFO - ðŸ”Ž  Running validation at step 1200
[rank0]:2025-10-28 02:57:47,758 - INFO - validate step: 1200  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,776
[rank1]:2025-10-28 02:57:47,840 - INFO - validate step: 1200  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,769
[rank2]:2025-10-28 02:57:47,921 - INFO - validate step: 1200  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,762
[rank3]:2025-10-28 02:57:47,983 - INFO - validate step: 1200  loss:  0.9602  memory: 38.93GiB(81.95%)  tps: 5,966
[rank2]:2025-10-28 02:57:48,066 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251028_0257_stage2_step1200.svg
[rank0]:2025-10-28 02:57:48,065 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251028_0257_stage0_step1200.svg
[rank1]:2025-10-28 02:57:48,065 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251028_0257_stage1_step1200.svg
[rank3]:2025-10-28 02:57:48,173 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_GPipe_apf_dm1/pipeline_schedule/251028_0257_real_step1200_rank3.svg
[rank3]:> Batch Time: 1285.38 ms, GPU Bubble Ratio: 71.87%, 44.98%, 63.11%, 13.55%
[rank3]:2025-10-28 02:57:48,244 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251028_0257_stage3_step1200.svg
[rank3]:2025-10-28 02:57:49,456 - INFO - Avg. fwd time: 71.8166 / Avg. bwd time: 75.9299 / Avg. batch time: 1230.5032 (ms) / GPU bubble ratio: 3.94%
[rank2]:2025-10-28 02:57:49,491 - INFO - Avg. fwd time: 32.6389 / Avg. bwd time: 30.9930 / Avg. batch time: 1513.6962 (ms) / GPU bubble ratio: 66.37%
[rank0]:2025-10-28 02:57:49,539 - INFO - Avg. fwd time: 44.7650 / Avg. bwd time: 10.0867 / Avg. batch time: 1647.2634 (ms) / GPU bubble ratio: 73.36%
[rank1]:2025-10-28 02:57:49,533 - INFO - Avg. fwd time: 51.4772 / Avg. bwd time: 41.6094 / Avg. batch time: 1601.5661 (ms) / GPU bubble ratio: 53.50%
[rank2]:2025-10-28 02:58:01,639 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:58:01,639 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:58:01,639 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:58:04,330 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:58:17,808 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:58:17,808 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:58:17,809 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:58:20,328 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:58:33,562 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:58:33,562 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:58:33,562 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:58:36,060 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:58:49,399 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:58:49,400 - INFO -  step: 1220  loss: -2.0000  grad_norm:  0.0377  memory: 16.10GiB(33.90%)  tps: 2,665  tflops: 20.30  mfu: 6.51%
[rank0]:2025-10-28 02:58:49,400 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:58:49,400 - INFO -  step: 1220  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,658  tflops: 20.24  mfu: 6.49%
[rank1]:2025-10-28 02:58:49,400 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:58:49,400 - INFO -  step: 1220  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,661  tflops: 20.27  mfu: 6.50%
[rank3]:2025-10-28 02:58:51,910 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:58:51,915 - INFO -  step: 1220  loss:  0.3118  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,563  tflops: 19.52  mfu: 6.26%
[rank2]:2025-10-28 02:59:05,372 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:59:05,372 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:59:05,372 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:59:07,951 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:59:21,225 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:59:21,224 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:59:21,225 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:59:23,723 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:59:37,036 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:59:37,036 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:59:37,036 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:59:39,535 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:59:52,775 - INFO - Freezing Ratio: [Stage1] 0.02, Threshold: 5.0000e-02
[rank1]:2025-10-28 02:59:52,775 - INFO -  step: 1240  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,585  tflops: 19.69  mfu: 6.31%
[rank2]:2025-10-28 02:59:52,774 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 02:59:52,775 - INFO -  step: 1240  loss: -2.0000  grad_norm:  0.0093  memory: 16.10GiB(33.90%)  tps: 2,585  tflops: 19.69  mfu: 6.31%
[rank0]:2025-10-28 02:59:52,775 - INFO - Freezing Ratio: [Stage0] 0.03, Threshold: 5.0000e-02
[rank0]:2025-10-28 02:59:52,775 - INFO -  step: 1240  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,585  tflops: 19.69  mfu: 6.31%
[rank3]:2025-10-28 02:59:55,269 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 02:59:55,273 - INFO -  step: 1240  loss:  0.2899  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,586  tflops: 19.70  mfu: 6.31%
[rank3]:2025-10-28 02:59:56,962 - INFO - Avg. fwd time: 71.8019 / Avg. bwd time: 75.6341 / Avg. batch time: 1228.0076 (ms) / GPU bubble ratio: 3.95%
[rank2]:2025-10-28 02:59:57,022 - INFO - Avg. fwd time: 32.6379 / Avg. bwd time: 30.8779 / Avg. batch time: 1511.9141 (ms) / GPU bubble ratio: 66.39%
[rank0]:2025-10-28 02:59:57,164 - INFO - Avg. fwd time: 44.7673 / Avg. bwd time: 9.7842 / Avg. batch time: 1645.0383 (ms) / GPU bubble ratio: 73.47%
[rank1]:2025-10-28 02:59:57,101 - INFO - Avg. fwd time: 51.4795 / Avg. bwd time: 41.4487 / Avg. batch time: 1599.6503 (ms) / GPU bubble ratio: 53.53%
[rank1]:2025-10-28 03:00:14,890 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 03:00:14,887 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 03:00:14,907 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-28 03:00:17,469 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 03:00:28,273 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-28 03:00:30,992 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 03:00:30,993 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 03:00:30,992 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 03:00:33,494 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 03:00:46,785 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 03:00:46,786 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 03:00:46,785 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 03:00:49,302 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 03:01:02,657 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 03:01:02,657 - INFO -  step: 1260  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,345  tflops: 17.86  mfu: 5.72%
[rank1]:2025-10-28 03:01:02,657 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 03:01:02,657 - INFO -  step: 1260  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,345  tflops: 17.86  mfu: 5.72%
[rank2]:2025-10-28 03:01:02,656 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-28 03:01:02,657 - INFO -  step: 1260  loss: -2.0000  grad_norm:  0.0495  memory: 16.10GiB(33.90%)  tps: 2,345  tflops: 17.86  mfu: 5.72%
[rank3]:2025-10-28 03:01:05,176 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 03:01:05,179 - INFO -  step: 1260  loss:  0.3214  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,344  tflops: 17.85  mfu: 5.72%
[rank2]:2025-10-28 03:01:18,553 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 03:01:18,553 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 03:01:18,553 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 03:01:21,152 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 03:01:34,354 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 03:01:34,354 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 03:01:34,354 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 03:01:36,872 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 03:01:50,242 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 03:01:50,243 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 03:01:50,243 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 03:01:52,755 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 03:02:06,094 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-28 03:02:06,094 - INFO -  step: 1280  loss: -2.0000  grad_norm:  0.0050  memory: 16.10GiB(33.90%)  tps: 2,583  tflops: 19.67  mfu: 6.30%
[rank0]:2025-10-28 03:02:06,095 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 03:02:06,095 - INFO -  step: 1280  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,583  tflops: 19.67  mfu: 6.30%
[rank1]:2025-10-28 03:02:06,094 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 03:02:06,094 - INFO -  step: 1280  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,583  tflops: 19.67  mfu: 6.30%
[rank3]:2025-10-28 03:02:08,607 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 03:02:08,610 - INFO -  step: 1280  loss:  0.2687  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,583  tflops: 19.67  mfu: 6.31%
[rank3]:2025-10-28 03:02:09,802 - INFO - Avg. fwd time: 71.7857 / Avg. bwd time: 75.5494 / Avg. batch time: 1227.2050 (ms) / GPU bubble ratio: 3.95%
[rank2]:2025-10-28 03:02:09,837 - INFO - Avg. fwd time: 32.6346 / Avg. bwd time: 30.8489 / Avg. batch time: 1511.8479 (ms) / GPU bubble ratio: 66.41%
[rank0]:2025-10-28 03:02:09,885 - INFO - Avg. fwd time: 44.7618 / Avg. bwd time: 9.7029 / Avg. batch time: 1644.8646 (ms) / GPU bubble ratio: 73.51%
[rank1]:2025-10-28 03:02:09,878 - INFO - Avg. fwd time: 51.4862 / Avg. bwd time: 41.4079 / Avg. batch time: 1599.5602 (ms) / GPU bubble ratio: 53.54%
[rank2]:2025-10-28 03:02:21,940 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 03:02:21,941 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 03:02:21,941 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 03:02:24,534 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 03:02:38,028 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 03:02:38,028 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 03:02:38,028 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 03:02:40,543 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 03:02:53,840 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 03:02:53,840 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 03:02:53,840 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 03:02:56,359 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 03:03:07,124 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-28 03:03:09,806 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-28 03:03:09,807 - INFO -  step: 1300  loss: -2.0000  grad_norm:  0.0465  memory: 16.10GiB(33.90%)  tps: 2,572  tflops: 19.59  mfu: 6.28%
[rank2]:2025-10-28 03:03:09,807 - INFO - ðŸ”Ž  Running validation at step 1300
[rank0]:2025-10-28 03:03:09,807 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 03:03:09,807 - INFO -  step: 1300  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,572  tflops: 19.59  mfu: 6.28%
[rank0]:2025-10-28 03:03:09,807 - INFO - ðŸ”Ž  Running validation at step 1300
[rank1]:2025-10-28 03:03:09,807 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank1]:2025-10-28 03:03:09,807 - INFO -  step: 1300  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,572  tflops: 19.59  mfu: 6.28%
[rank1]:2025-10-28 03:03:09,807 - INFO - ðŸ”Ž  Running validation at step 1300
[rank3]:2025-10-28 03:03:12,452 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 03:03:12,455 - INFO -  step: 1300  loss:  0.3687  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,566  tflops: 19.55  mfu: 6.26%
[rank3]:2025-10-28 03:03:12,460 - INFO - ðŸ”Ž  Running validation at step 1300
[rank0]:2025-10-28 03:04:21,191 - INFO - validate step: 1300  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,738
[rank1]:2025-10-28 03:04:21,276 - INFO - validate step: 1300  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,731
[rank2]:2025-10-28 03:04:21,359 - INFO - validate step: 1300  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,725
[rank3]:2025-10-28 03:04:21,423 - INFO - validate step: 1300  loss:  0.9537  memory: 38.93GiB(81.95%)  tps: 5,940
[rank2]:2025-10-28 03:04:21,505 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251028_0304_stage2_step1300.svg
[rank0]:2025-10-28 03:04:21,504 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251028_0304_stage0_step1300.svg
[rank1]:2025-10-28 03:04:21,505 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251028_0304_stage1_step1300.svg
[rank3]:2025-10-28 03:04:21,613 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_GPipe_apf_dm1/pipeline_schedule/251028_0304_real_step1300_rank3.svg
[rank3]:> Batch Time: 1284.78 ms, GPU Bubble Ratio: 71.87%, 44.95%, 63.09%, 13.57%
[rank3]:2025-10-28 03:04:21,701 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251028_0304_stage3_step1300.svg
[rank1]:2025-10-28 03:04:35,346 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 03:04:35,345 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 03:04:35,346 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 03:04:38,033 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 03:04:51,374 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 03:04:51,373 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 03:04:51,374 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 03:04:53,977 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 03:05:07,524 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 03:05:07,524 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 03:05:07,524 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 03:05:10,086 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 03:05:23,557 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-28 03:05:23,557 - INFO -  step: 1320  loss: -2.0000  grad_norm:  0.0048  memory: 16.10GiB(33.90%)  tps: 2,634  tflops: 20.06  mfu: 6.43%
[rank0]:2025-10-28 03:05:23,557 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 03:05:23,558 - INFO -  step: 1320  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,627  tflops: 20.01  mfu: 6.41%
[rank1]:2025-10-28 03:05:23,557 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 03:05:23,558 - INFO -  step: 1320  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,631  tflops: 20.04  mfu: 6.42%
[rank3]:2025-10-28 03:05:26,089 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 03:05:26,093 - INFO -  step: 1320  loss:  0.2866  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,534  tflops: 19.30  mfu: 6.18%
[rank3]:2025-10-28 03:05:27,298 - INFO - Avg. fwd time: 71.7980 / Avg. bwd time: 75.2741 / Avg. batch time: 1225.1089 (ms) / GPU bubble ratio: 3.96%
[rank2]:2025-10-28 03:05:27,332 - INFO - Avg. fwd time: 32.6337 / Avg. bwd time: 30.7359 / Avg. batch time: 1509.5734 (ms) / GPU bubble ratio: 66.42%
[rank0]:2025-10-28 03:05:27,388 - INFO - Avg. fwd time: 44.7671 / Avg. bwd time: 9.4110 / Avg. batch time: 1642.1631 (ms) / GPU bubble ratio: 73.61%
[rank1]:2025-10-28 03:05:27,376 - INFO - Avg. fwd time: 51.5080 / Avg. bwd time: 41.2530 / Avg. batch time: 1597.1535 (ms) / GPU bubble ratio: 53.54%
[rank2]:2025-10-28 03:05:39,499 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 03:05:39,500 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 03:05:39,499 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 03:05:42,025 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 03:05:55,530 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 03:05:55,530 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 03:05:55,530 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 03:05:58,142 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 03:06:11,432 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 03:06:11,433 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 03:06:11,432 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 03:06:14,057 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 03:06:27,405 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 03:06:27,405 - INFO -  step: 1340  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,566  tflops: 19.54  mfu: 6.26%
[rank2]:2025-10-28 03:06:27,404 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-28 03:06:27,405 - INFO -  step: 1340  loss: -2.0000  grad_norm:  0.0462  memory: 16.10GiB(33.90%)  tps: 2,566  tflops: 19.54  mfu: 6.26%
[rank0]:2025-10-28 03:06:27,405 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 03:06:27,405 - INFO -  step: 1340  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,566  tflops: 19.54  mfu: 6.26%
[rank3]:2025-10-28 03:06:29,940 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 03:06:29,943 - INFO -  step: 1340  loss:  0.3820  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,566  tflops: 19.54  mfu: 6.26%
[rank2]:2025-10-28 03:06:43,450 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 03:06:43,450 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 03:06:43,451 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 03:06:45,967 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 03:06:56,566 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-28 03:06:59,275 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 03:06:59,275 - INFO - Freezing Ratio: [Stage0] 0.03, Threshold: 5.0000e-02
[rank1]:2025-10-28 03:06:59,275 - INFO - Freezing Ratio: [Stage1] 0.02, Threshold: 5.0000e-02
[rank3]:2025-10-28 03:07:01,981 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 03:07:21,711 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 03:07:21,731 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 03:07:21,716 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 03:07:24,400 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 03:07:37,782 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 03:07:37,783 - INFO -  step: 1360  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,328  tflops: 17.73  mfu: 5.68%
[rank1]:2025-10-28 03:07:37,782 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 03:07:37,782 - INFO -  step: 1360  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,328  tflops: 17.73  mfu: 5.68%
[rank2]:2025-10-28 03:07:37,782 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-28 03:07:37,782 - INFO -  step: 1360  loss: -2.0000  grad_norm:  0.0073  memory: 16.10GiB(33.90%)  tps: 2,328  tflops: 17.73  mfu: 5.68%
[rank3]:2025-10-28 03:07:40,454 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 03:07:40,457 - INFO -  step: 1360  loss:  0.2951  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,324  tflops: 17.70  mfu: 5.67%
[rank3]:2025-10-28 03:07:41,657 - INFO - Avg. fwd time: 71.7922 / Avg. bwd time: 75.2384 / Avg. batch time: 1224.8046 (ms) / GPU bubble ratio: 3.96%
[rank2]:2025-10-28 03:07:41,692 - INFO - Avg. fwd time: 32.6356 / Avg. bwd time: 30.7239 / Avg. batch time: 1510.1790 (ms) / GPU bubble ratio: 66.44%
[rank0]:2025-10-28 03:07:41,742 - INFO - Avg. fwd time: 44.7764 / Avg. bwd time: 9.3656 / Avg. batch time: 1642.7041 (ms) / GPU bubble ratio: 73.63%
[rank1]:2025-10-28 03:07:41,735 - INFO - Avg. fwd time: 51.5256 / Avg. bwd time: 41.2342 / Avg. batch time: 1597.7375 (ms) / GPU bubble ratio: 53.55%
[rank2]:2025-10-28 03:07:53,783 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 03:07:53,783 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 03:07:53,783 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 03:07:56,309 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 03:08:09,741 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 03:08:09,741 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 03:08:09,741 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 03:08:12,434 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 03:08:25,724 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 03:08:25,724 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 03:08:25,724 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 03:08:28,281 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 03:08:41,636 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-28 03:08:41,636 - INFO -  step: 1380  loss: -2.0000  grad_norm:  0.0020  memory: 16.10GiB(33.90%)  tps: 2,566  tflops: 19.54  mfu: 6.26%
[rank0]:2025-10-28 03:08:41,636 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 03:08:41,637 - INFO -  step: 1380  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,566  tflops: 19.54  mfu: 6.26%
[rank1]:2025-10-28 03:08:41,636 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 03:08:41,636 - INFO -  step: 1380  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,566  tflops: 19.54  mfu: 6.26%
[rank3]:2025-10-28 03:08:44,243 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 03:08:44,247 - INFO -  step: 1380  loss:  0.3560  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,569  tflops: 19.56  mfu: 6.27%
[rank2]:2025-10-28 03:08:57,665 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 03:08:57,666 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 03:08:57,665 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 03:09:00,318 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 03:09:13,527 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 03:09:13,528 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 03:09:13,528 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 03:09:16,053 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 03:09:29,437 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 03:09:29,437 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 03:09:29,437 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 03:09:31,955 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 03:09:42,570 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-28 03:09:45,289 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-28 03:09:45,290 - INFO -  step: 1400  loss: -2.0000  grad_norm:  0.0074  memory: 16.10GiB(33.90%)  tps: 2,574  tflops: 19.60  mfu: 6.28%
[rank2]:2025-10-28 03:09:45,290 - INFO - ðŸ”Ž  Running validation at step 1400
[rank0]:2025-10-28 03:09:45,290 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 03:09:45,290 - INFO -  step: 1400  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,574  tflops: 19.60  mfu: 6.28%
[rank0]:2025-10-28 03:09:45,290 - INFO - ðŸ”Ž  Running validation at step 1400
[rank1]:2025-10-28 03:09:45,290 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 03:09:45,290 - INFO -  step: 1400  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,574  tflops: 19.60  mfu: 6.28%
[rank1]:2025-10-28 03:09:45,290 - INFO - ðŸ”Ž  Running validation at step 1400
[rank3]:2025-10-28 03:09:47,810 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 03:09:47,813 - INFO -  step: 1400  loss:  0.2974  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,578  tflops: 19.63  mfu: 6.29%
[rank3]:2025-10-28 03:09:47,813 - INFO - ðŸ”Ž  Running validation at step 1400
[rank0]:2025-10-28 03:10:56,125 - INFO - validate step: 1400  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,782
[rank1]:2025-10-28 03:10:56,207 - INFO - validate step: 1400  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,776
[rank2]:2025-10-28 03:10:56,291 - INFO - validate step: 1400  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,769
[rank3]:2025-10-28 03:10:56,352 - INFO - validate step: 1400  loss:  0.9539  memory: 38.93GiB(81.95%)  tps: 5,976
[rank0]:2025-10-28 03:10:56,445 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251028_0310_stage0_step1400.svg
[rank1]:2025-10-28 03:10:56,446 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251028_0310_stage1_step1400.svg
[rank2]:2025-10-28 03:10:56,457 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251028_0310_stage2_step1400.svg
[rank3]:2025-10-28 03:10:56,557 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_GPipe_apf_dm1/pipeline_schedule/251028_0310_real_step1400_rank3.svg
[rank3]:> Batch Time: 1284.97 ms, GPU Bubble Ratio: 71.87%, 44.96%, 63.10%, 13.58%
[rank3]:2025-10-28 03:10:56,630 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251028_0310_stage3_step1400.svg
[rank3]:2025-10-28 03:10:57,834 - INFO - Avg. fwd time: 71.7795 / Avg. bwd time: 74.9735 / Avg. batch time: 1222.5971 (ms) / GPU bubble ratio: 3.97%
[rank2]:2025-10-28 03:10:57,868 - INFO - Avg. fwd time: 32.6334 / Avg. bwd time: 30.6206 / Avg. batch time: 1507.8191 (ms) / GPU bubble ratio: 66.44%
[rank0]:2025-10-28 03:10:57,921 - INFO - Avg. fwd time: 44.7744 / Avg. bwd time: 9.1000 / Avg. batch time: 1639.9333 (ms) / GPU bubble ratio: 73.72%
[rank1]:2025-10-28 03:10:57,909 - INFO - Avg. fwd time: 51.5340 / Avg. bwd time: 41.0933 / Avg. batch time: 1595.2351 (ms) / GPU bubble ratio: 53.55%
[rank2]:2025-10-28 03:11:10,078 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 03:11:10,079 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 03:11:10,078 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 03:11:12,749 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 03:11:26,220 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 03:11:26,220 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 03:11:26,220 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank3]:2025-10-28 03:11:28,770 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 03:11:42,062 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 03:11:42,063 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 03:11:42,063 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 03:11:44,663 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 03:11:57,996 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-28 03:11:57,997 - INFO -  step: 1420  loss: -2.0000  grad_norm:  0.0021  memory: 16.10GiB(33.90%)  tps: 2,655  tflops: 20.22  mfu: 6.48%
[rank0]:2025-10-28 03:11:57,997 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 03:11:57,997 - INFO -  step: 1420  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,648  tflops: 20.17  mfu: 6.46%
[rank1]:2025-10-28 03:11:57,997 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 03:11:57,997 - INFO -  step: 1420  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,652  tflops: 20.19  mfu: 6.47%
[rank3]:2025-10-28 03:12:00,511 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 03:12:00,517 - INFO -  step: 1420  loss:  0.3510  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,554  tflops: 19.45  mfu: 6.23%
[rank2]:2025-10-28 03:12:13,921 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 03:12:13,921 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 03:12:13,921 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 03:12:16,405 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 03:12:29,662 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 03:12:29,661 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 03:12:29,661 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-28 03:12:32,150 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 03:12:45,499 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 03:12:45,499 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 03:12:45,499 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 03:12:48,015 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 03:13:01,354 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-28 03:13:01,355 - INFO -  step: 1440  loss: -2.0000  grad_norm:  0.0071  memory: 16.10GiB(33.90%)  tps: 2,586  tflops: 19.70  mfu: 6.31%
[rank0]:2025-10-28 03:13:01,355 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 03:13:01,355 - INFO -  step: 1440  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,586  tflops: 19.70  mfu: 6.31%
[rank1]:2025-10-28 03:13:01,355 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 03:13:01,355 - INFO -  step: 1440  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,586  tflops: 19.70  mfu: 6.31%
[rank3]:2025-10-28 03:13:03,842 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 03:13:03,845 - INFO -  step: 1440  loss:  0.3520  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,587  tflops: 19.70  mfu: 6.32%
[rank3]:2025-10-28 03:13:05,047 - INFO - Avg. fwd time: 71.7709 / Avg. bwd time: 74.7263 / Avg. batch time: 1220.5595 (ms) / GPU bubble ratio: 3.98%
[rank2]:2025-10-28 03:13:05,082 - INFO - Avg. fwd time: 32.6311 / Avg. bwd time: 30.5225 / Avg. batch time: 1506.3370 (ms) / GPU bubble ratio: 66.46%
[rank1]:2025-10-28 03:13:05,128 - INFO - Avg. fwd time: 51.5363 / Avg. bwd time: 40.9564 / Avg. batch time: 1593.6193 (ms) / GPU bubble ratio: 53.57%
[rank0]:2025-10-28 03:13:05,134 - INFO - Avg. fwd time: 44.7723 / Avg. bwd time: 8.8631 / Avg. batch time: 1638.0779 (ms) / GPU bubble ratio: 73.81%
[rank2]:2025-10-28 03:13:17,194 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 03:13:17,194 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 03:13:17,194 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 03:13:19,680 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 03:13:30,460 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-28 03:13:33,142 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 03:13:33,143 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 03:13:33,143 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 03:13:35,748 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 03:13:49,080 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 03:13:49,080 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 03:13:49,080 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 03:13:51,719 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 03:14:05,095 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 03:14:05,096 - INFO -  step: 1460  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,570  tflops: 19.58  mfu: 6.27%
[rank1]:2025-10-28 03:14:05,095 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 03:14:05,096 - INFO -  step: 1460  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,570  tflops: 19.58  mfu: 6.27%
[rank2]:2025-10-28 03:14:05,095 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-28 03:14:05,095 - INFO -  step: 1460  loss: -2.0000  grad_norm:  0.0021  memory: 16.10GiB(33.90%)  tps: 2,570  tflops: 19.58  mfu: 6.27%
[rank3]:2025-10-28 03:14:07,620 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 03:14:07,624 - INFO -  step: 1460  loss:  0.3736  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,569  tflops: 19.57  mfu: 6.27%
[rank2]:2025-10-28 03:14:21,030 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 03:14:21,031 - INFO - Freezing Ratio: [Stage0] 0.03, Threshold: 5.0000e-02
[rank1]:2025-10-28 03:14:21,031 - INFO - Freezing Ratio: [Stage1] 0.02, Threshold: 5.0000e-02
[rank3]:2025-10-28 03:14:23,547 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 03:14:43,107 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 03:14:43,126 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 03:14:43,111 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 03:14:45,636 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 03:14:59,039 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 03:14:59,040 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 03:14:59,040 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 03:15:01,608 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 03:15:15,024 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-28 03:15:15,025 - INFO -  step: 1480  loss: -2.0000  grad_norm:  0.0077  memory: 16.10GiB(33.90%)  tps: 2,343  tflops: 17.84  mfu: 5.72%
[rank0]:2025-10-28 03:15:15,025 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 03:15:15,025 - INFO -  step: 1480  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,343  tflops: 17.84  mfu: 5.72%
[rank1]:2025-10-28 03:15:15,025 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 03:15:15,025 - INFO -  step: 1480  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,343  tflops: 17.84  mfu: 5.72%
[rank3]:2025-10-28 03:15:17,508 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 03:15:17,511 - INFO -  step: 1480  loss:  0.2945  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,344  tflops: 17.86  mfu: 5.72%
[rank3]:2025-10-28 03:15:18,713 - INFO - Avg. fwd time: 71.7751 / Avg. bwd time: 74.7015 / Avg. batch time: 1220.3578 (ms) / GPU bubble ratio: 3.98%
[rank2]:2025-10-28 03:15:18,755 - INFO - Avg. fwd time: 32.6305 / Avg. bwd time: 30.5157 / Avg. batch time: 1506.7644 (ms) / GPU bubble ratio: 66.47%
[rank1]:2025-10-28 03:15:18,796 - INFO - Avg. fwd time: 51.5331 / Avg. bwd time: 40.9424 / Avg. batch time: 1594.0314 (ms) / GPU bubble ratio: 53.59%
[rank0]:2025-10-28 03:15:18,803 - INFO - Avg. fwd time: 44.7775 / Avg. bwd time: 8.8188 / Avg. batch time: 1638.4437 (ms) / GPU bubble ratio: 73.83%
[rank2]:2025-10-28 03:15:30,873 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 03:15:30,873 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-28 03:15:30,873 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 03:15:33,350 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 03:15:46,897 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 03:15:46,898 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 03:15:46,897 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 03:15:49,376 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 03:16:02,717 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 03:16:02,718 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 03:16:02,717 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 03:16:05,275 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 03:16:16,022 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-28 03:16:18,678 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 03:16:18,679 - INFO -  step: 1500  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,574  tflops: 19.60  mfu: 6.28%
[rank1]:2025-10-28 03:16:18,679 - INFO - ðŸ”Ž  Running validation at step 1500
[rank2]:2025-10-28 03:16:18,677 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-28 03:16:18,678 - INFO -  step: 1500  loss: -2.0000  grad_norm:  0.0083  memory: 16.10GiB(33.90%)  tps: 2,574  tflops: 19.60  mfu: 6.28%
[rank2]:2025-10-28 03:16:18,678 - INFO - ðŸ”Ž  Running validation at step 1500
[rank0]:2025-10-28 03:16:18,678 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 03:16:18,678 - INFO -  step: 1500  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,574  tflops: 19.60  mfu: 6.28%
[rank0]:2025-10-28 03:16:18,678 - INFO - ðŸ”Ž  Running validation at step 1500
[rank3]:2025-10-28 03:16:21,169 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 03:16:21,172 - INFO -  step: 1500  loss:  0.3372  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,574  tflops: 19.60  mfu: 6.28%
[rank3]:2025-10-28 03:16:21,173 - INFO - ðŸ”Ž  Running validation at step 1500
[rank0]:2025-10-28 03:17:30,437 - INFO - validate step: 1500  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,708
[rank0]:2025-10-28 03:17:30,438 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-28 03:17:30,448 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank1]:2025-10-28 03:17:30,523 - INFO - validate step: 1500  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,701
[rank1]:2025-10-28 03:17:30,524 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-28 03:17:30,605 - INFO - validate step: 1500  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,695
[rank2]:2025-10-28 03:17:30,606 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-28 03:17:30,664 - INFO - validate step: 1500  loss:  0.9541  memory: 38.93GiB(81.95%)  tps: 5,894
[rank3]:2025-10-28 03:17:30,666 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-28 03:17:32,450 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 1.84 seconds.
[rank1]:2025-10-28 03:17:32,677 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 2.15 seconds.
[rank3]:2025-10-28 03:17:34,129 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.46 seconds.
[rank0]:2025-10-28 03:17:34,259 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-28 03:17:34,267 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.83 seconds.
[rank0]:2025-10-28 03:17:34,267 - INFO - Checkpointer is deleting /data3/shcho/torchtitan/checkpoint/1028_GPipe_apf_dm1/step-500.
[rank1]:2025-10-28 03:17:34,359 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251028_0317_stage1_step1500.svg
[rank2]:2025-10-28 03:17:34,359 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251028_0317_stage2_step1500.svg
[rank0]:2025-10-28 03:17:34,512 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251028_0317_stage0_step1500.svg
[rank3]:2025-10-28 03:17:34,654 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_GPipe_apf_dm1/pipeline_schedule/251028_0317_real_step1500_rank3.svg
[rank3]:> Batch Time: 1284.75 ms, GPU Bubble Ratio: 71.86%, 44.95%, 63.09%, 13.59%
[rank3]:2025-10-28 03:17:34,753 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251028_0317_stage3_step1500.svg
[rank0]:2025-10-28 03:17:36,457 - INFO - Checkpointer deleted /data3/shcho/torchtitan/checkpoint/1028_GPipe_apf_dm1/step-500 in 2.19 seconds.
[rank1]:2025-10-28 03:17:48,283 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 03:17:48,283 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 03:17:48,284 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 03:17:51,153 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 03:18:04,498 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 03:18:04,497 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 03:18:04,497 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-28 03:18:07,537 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 03:18:21,003 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 03:18:21,003 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 03:18:21,003 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 03:18:24,284 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 03:18:37,596 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-28 03:18:37,597 - INFO -  step: 1520  loss: -2.0000  grad_norm:  0.0078  memory: 16.10GiB(33.90%)  tps: 2,446  tflops: 18.63  mfu: 5.97%
[rank0]:2025-10-28 03:18:37,597 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 03:18:37,598 - INFO -  step: 1520  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,440  tflops: 18.58  mfu: 5.96%
[rank1]:2025-10-28 03:18:37,596 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 03:18:37,597 - INFO -  step: 1520  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,443  tflops: 18.60  mfu: 5.96%
[rank3]:2025-10-28 03:18:40,958 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 03:18:40,961 - INFO -  step: 1520  loss:  0.2958  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,331  tflops: 17.75  mfu: 5.69%
[rank3]:2025-10-28 03:18:42,158 - INFO - Avg. fwd time: 71.7715 / Avg. bwd time: 74.4786 / Avg. batch time: 1218.5696 (ms) / GPU bubble ratio: 3.99%
[rank2]:2025-10-28 03:18:42,197 - INFO - Avg. fwd time: 32.6358 / Avg. bwd time: 30.4281 / Avg. batch time: 1505.4598 (ms) / GPU bubble ratio: 66.49%
[rank0]:2025-10-28 03:18:42,246 - INFO - Avg. fwd time: 44.7864 / Avg. bwd time: 8.6035 / Avg. batch time: 1636.8050 (ms) / GPU bubble ratio: 73.91%
[rank1]:2025-10-28 03:18:42,238 - INFO - Avg. fwd time: 51.5493 / Avg. bwd time: 40.8137 / Avg. batch time: 1592.6054 (ms) / GPU bubble ratio: 53.60%
[rank2]:2025-10-28 03:18:54,313 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 03:18:54,313 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 03:18:54,313 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank3]:2025-10-28 03:18:57,847 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 03:19:11,303 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 03:19:11,302 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 03:19:11,302 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 03:19:14,740 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 03:19:28,039 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 03:19:28,040 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 03:19:28,040 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 03:19:31,610 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 03:19:44,971 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-28 03:19:44,971 - INFO -  step: 1540  loss: -2.0000  grad_norm:  0.0080  memory: 16.10GiB(33.90%)  tps: 2,432  tflops: 18.52  mfu: 5.94%
[rank0]:2025-10-28 03:19:44,971 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 03:19:44,979 - INFO -  step: 1540  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,432  tflops: 18.52  mfu: 5.94%
[rank1]:2025-10-28 03:19:44,971 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 03:19:44,979 - INFO -  step: 1540  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,432  tflops: 18.52  mfu: 5.94%
[rank3]:2025-10-28 03:19:48,426 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 03:19:48,431 - INFO -  step: 1540  loss:  0.3569  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,428  tflops: 18.50  mfu: 5.93%
[rank2]:2025-10-28 03:20:01,785 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 03:20:01,785 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 03:20:01,785 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 03:20:05,508 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 03:20:16,342 - INFO - [GC] Peforming periodical GC collection 0.26 seconds
[rank2]:2025-10-28 03:20:19,028 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 03:20:19,028 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 03:20:19,028 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 03:20:21,611 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 03:20:34,994 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 03:20:34,994 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 03:20:34,994 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-28 03:20:37,602 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 03:20:50,953 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-28 03:20:50,953 - INFO -  step: 1560  loss: -2.0000  grad_norm:  0.0079  memory: 16.10GiB(33.90%)  tps: 2,483  tflops: 18.91  mfu: 6.06%
[rank0]:2025-10-28 03:20:50,953 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 03:20:50,954 - INFO -  step: 1560  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,483  tflops: 18.91  mfu: 6.06%
[rank1]:2025-10-28 03:20:50,953 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 03:20:50,954 - INFO -  step: 1560  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,483  tflops: 18.91  mfu: 6.06%
[rank3]:2025-10-28 03:20:53,429 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 03:20:53,433 - INFO -  step: 1560  loss:  0.2684  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,521  tflops: 19.20  mfu: 6.15%
[rank3]:2025-10-28 03:20:54,625 - INFO - Avg. fwd time: 71.7778 / Avg. bwd time: 74.2543 / Avg. batch time: 1216.7919 (ms) / GPU bubble ratio: 3.99%
[rank2]:2025-10-28 03:20:54,660 - INFO - Avg. fwd time: 32.6288 / Avg. bwd time: 30.3431 / Avg. batch time: 1505.7760 (ms) / GPU bubble ratio: 66.54%
[rank0]:2025-10-28 03:20:54,711 - INFO - Avg. fwd time: 44.7825 / Avg. bwd time: 8.3830 / Avg. batch time: 1636.7616 (ms) / GPU bubble ratio: 74.01%
[rank1]:2025-10-28 03:20:54,703 - INFO - Avg. fwd time: 51.5389 / Avg. bwd time: 40.6923 / Avg. batch time: 1592.7887 (ms) / GPU bubble ratio: 53.68%
[rank2]:2025-10-28 03:21:06,706 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 03:21:06,706 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 03:21:06,706 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 03:21:09,177 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 03:21:22,523 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 03:21:22,523 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 03:21:22,523 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 03:21:25,053 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 03:21:38,343 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 03:21:38,343 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank1]:2025-10-28 03:21:38,343 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 03:21:40,888 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 03:21:54,212 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 03:21:54,212 - INFO -  step: 1580  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,590  tflops: 19.73  mfu: 6.32%
[rank2]:2025-10-28 03:21:54,212 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-28 03:21:54,212 - INFO -  step: 1580  loss: -2.0000  grad_norm:  0.0081  memory: 16.10GiB(33.90%)  tps: 2,590  tflops: 19.73  mfu: 6.32%
[rank0]:2025-10-28 03:21:54,212 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 03:21:54,213 - INFO -  step: 1580  loss: -2.0000  grad_norm:  0.0081  memory: 20.89GiB(43.97%)  tps: 2,590  tflops: 19.73  mfu: 6.32%
[rank3]:2025-10-28 03:21:56,673 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 03:21:56,676 - INFO -  step: 1580  loss:  0.3131  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,591  tflops: 19.73  mfu: 6.32%
[rank2]:2025-10-28 03:22:10,075 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 03:22:10,075 - INFO - Freezing Ratio: [Stage0] 0.03, Threshold: 5.0000e-02
[rank1]:2025-10-28 03:22:10,076 - INFO - Freezing Ratio: [Stage1] 0.02, Threshold: 5.0000e-02
[rank3]:2025-10-28 03:22:12,526 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 03:22:31,947 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 03:22:31,944 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 03:22:31,966 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 03:22:34,441 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 03:22:47,797 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-28 03:22:47,797 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-28 03:22:47,797 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 03:22:50,336 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 03:23:00,938 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-28 03:23:03,652 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-28 03:23:03,653 - INFO -  step: 1600  loss: -2.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,359  tflops: 17.97  mfu: 5.76%
[rank0]:2025-10-28 03:23:03,653 - INFO -  final step: 1600  loss: -2.0000  grad_norm:  0.0000  tps: 2,489  tflops: 18.96  mfu: 5.98%
[rank0]:2025-10-28 03:23:03,653 - INFO - ðŸ”Ž  Running validation at step 1600
[rank2]:2025-10-28 03:23:03,652 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank2]:2025-10-28 03:23:03,652 - INFO -  step: 1600  loss: -2.0000  grad_norm:  0.0076  memory: 16.10GiB(33.90%)  tps: 2,359  tflops: 17.97  mfu: 5.76%
[rank2]:2025-10-28 03:23:03,652 - INFO -  final step: 1600  loss: -2.0000  grad_norm:  0.0076  tps: 2,490  tflops: 18.97  mfu: 5.98%
[rank2]:2025-10-28 03:23:03,652 - INFO - ðŸ”Ž  Running validation at step 1600
[rank1]:2025-10-28 03:23:03,652 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-28 03:23:03,652 - INFO -  step: 1600  loss: -2.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,359  tflops: 17.97  mfu: 5.76%
[rank1]:2025-10-28 03:23:03,653 - INFO -  final step: 1600  loss: -2.0000  grad_norm:  0.0000  tps: 2,490  tflops: 18.96  mfu: 5.98%
[rank1]:2025-10-28 03:23:03,653 - INFO - ðŸ”Ž  Running validation at step 1600
[rank3]:2025-10-28 03:23:06,109 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-28 03:23:06,113 - INFO -  step: 1600  loss:  0.2600  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,360  tflops: 17.97  mfu: 5.76%
[rank3]:2025-10-28 03:23:06,118 - INFO -  final step: 1600  loss:  0.2600  grad_norm:  0.0000  tps: 2,473  tflops: 18.84  mfu: 5.94%
[rank3]:2025-10-28 03:23:06,119 - INFO - ðŸ”Ž  Running validation at step 1600
[rank0]:2025-10-28 03:24:14,494 - INFO - validate step: 1600  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,782
[rank0]:2025-10-28 03:24:14,495 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-28 03:24:14,497 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1600.
[rank1]:2025-10-28 03:24:14,579 - INFO - validate step: 1600  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,775
[rank1]:2025-10-28 03:24:14,580 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-28 03:24:14,581 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1600.
[rank2]:2025-10-28 03:24:14,659 - INFO - validate step: 1600  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,768
[rank2]:2025-10-28 03:24:14,660 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-28 03:24:14,662 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1600.
[rank3]:2025-10-28 03:24:14,721 - INFO - validate step: 1600  loss:  0.9533  memory: 38.93GiB(81.95%)  tps: 5,971
[rank3]:2025-10-28 03:24:14,723 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-28 03:24:14,725 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1600.
[rank0]:2025-10-28 03:24:17,266 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank0]:2025-10-28 03:24:17,355 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251028_0324_stage0_final1600.svg
[rank2]:2025-10-28 03:24:17,355 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251028_0324_stage2_final1600.svg
[rank1]:2025-10-28 03:24:17,358 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251028_0324_stage1_final1600.svg
[rank3]:2025-10-28 03:24:17,458 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_GPipe_apf_dm1/pipeline_schedule/251028_0324_real_final1600_rank3.svg
[rank3]:> Batch Time: 1284.50 ms, GPU Bubble Ratio: 71.86%, 44.96%, 63.08%, 13.59%
[rank2]:2025-10-28 03:24:17,575 - INFO - Elementwise Histogram is saved as: /data3/shcho/torchtitan/images/1028_GPipe_apf_dm1/frozen_params_histogram/251028_0324_rank2_stage2.svg
[rank2]:	> Counts Sum: 9791, Total Sum: 10872 (90.06%), Ratio(%) per element: [92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 8.6]
[rank2]:2025-10-28 03:24:17,575 - INFO - Destroying the purge thread.
[rank1]:2025-10-28 03:24:17,572 - INFO - Elementwise Histogram is saved as: /data3/shcho/torchtitan/images/1028_GPipe_apf_dm1/frozen_params_histogram/251028_0324_rank1_stage1.svg
[rank1]:	> Counts Sum: 12546, Total Sum: 13590 (92.32%), Ratio(%) per element: [92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 89.4]
[rank1]:2025-10-28 03:24:17,572 - INFO - Destroying the purge thread.
[rank0]:2025-10-28 03:24:17,579 - INFO - Elementwise Histogram is saved as: /data3/shcho/torchtitan/images/1028_GPipe_apf_dm1/frozen_params_histogram/251028_0324_rank0_stage0.svg
[rank0]:	> Counts Sum: 10293, Total Sum: 11174 (92.12%), Ratio(%) per element: [92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 82.45]
[rank0]:2025-10-28 03:24:17,579 - INFO - Sleeping 2 seconds for other ranks to complete
[rank3]:2025-10-28 03:24:17,655 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_GPipe_apf_dm1/pipeline_schedule/251028_0324_thry_final1600_rank3.svg
[rank3]:> Batch Time: 1668.74 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:2025-10-28 03:24:17,730 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251028_0324_stage3_final1600.svg
[rank3]:2025-10-28 03:24:17,923 - INFO - Elementwise Histogram is saved as: /data3/shcho/torchtitan/images/1028_GPipe_apf_dm1/frozen_params_histogram/251028_0324_rank3_stage3.svg
[rank3]:	> Counts Sum: 8091, Total Sum: 8758 (92.38%), Ratio(%) per element: [92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38, 92.38]
[rank3]:2025-10-28 03:24:17,924 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank2]:2025-10-28 03:24:18,436 - INFO - Process group destroyed
[rank1]:2025-10-28 03:24:18,436 - INFO - Process group destroyed
[rank3]:wandb: uploading history steps 80-80, summary, console lines 695-705
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–…â–â–†â–â–â–â–â–â–â–â–…â–â–ƒâ–â–â–â–â–â–â–â–â–â–â–â–â–â–â–‚â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–†â–ˆâ–„â–…â–ƒâ–„â–‚â–ƒâ–‚â–‚â–‚â–â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–„â–‡â–†â–…â–„â–‚â–ƒâ–‚â–‚â–‚â–â–‚â–‚â–â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 3.31253
[rank3]:wandb:               final/avg_loss 0.25998
[rank3]:wandb:             final/avg_mfu(%) 5.94181
[rank3]:wandb:             final/avg_tflops 18.83516
[rank3]:wandb:    final/avg_throughput(tps) 2473.03542
[rank3]:wandb:              final/grad_norm 0
[rank3]:wandb:               final/max_loss 0.25998
[rank3]:wandb:                    grad_norm 0
[rank3]:wandb: loss_metrics/global_avg_loss 0.25998
[rank3]:wandb: loss_metrics/global_max_loss 0.25998
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1028_GPipe_apf_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/m35e1mnx
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data3/shcho/torchtitan/tb/1028_GPipe_apf_dm1/20251028-0136/wandb/run-20251028_013624-m35e1mnx/logs
[rank3]:2025-10-28 03:24:19,381 - INFO - Process group destroyed
[rank0]:2025-10-28 03:24:19,579 - INFO - Training completed
[rank0]:2025-10-28 03:24:19,580 - INFO - Destroying the purge thread.
[rank0]:2025-10-28 03:24:20,392 - INFO - Process group destroyed
[rank0]:Stage 0: Modules to keep: {'tok_embeddings', 'layers.3', 'layers.0', 'layers.2', 'layers.1'}
[rank2]:Stage 2: Modules to keep: {'layers.9', 'layers.12', 'layers.11', 'layers.10'}
[rank1]:Stage 1: Modules to keep: {'layers.8', 'layers.6', 'layers.4', 'layers.7', 'layers.5'}
[rank3]:Stage 3: Modules to keep: {'output', 'layers.15', 'norm', 'layers.13', 'layers.14'}
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1026_llama1b/config.toml
[rank3]:		- dump_folder: /data3/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1028_GPipe_apf_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data3/shcho/torchtitan/profile_trace/1028_GPipe_apf_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data3/shcho/torchtitan/memory_snapshot/1028_GPipe_apf_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 20
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data3/shcho/torchtitan/tb/1028_GPipe_apf_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data3/shcho/torchtitan/images/1028_GPipe_apf_dm1
[rank3]:		- pplog_freq: 80
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1028_GPipe_apf_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B-Instruct
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 1e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: alpaca
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 512
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 1600
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: GPipe
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 4
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data3/shcho/torchtitan/checkpoint/1028_GPipe_apf_dm1
[rank3]:		- interval: 500
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B-Instruct/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data3/shcho/torchtitan/comm_traces/1028_GPipe_apf_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: True
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 100
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: apf
[rank3]:		- phase_unit: 10
[rank3]:		- stability_check_freq: 5
[rank3]:		- aggressiveness: 0
[rank3]:
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
