
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 10. 27. (ì›”) 15:37:37 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 3,4,5,6
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1026_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1026_llama1b/1026_1F1B_apf.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation
âœ”ï¸Running with apf x 1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1026_llama1b/config.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=apf
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank1]:2025-10-27 15:37:43,543 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation"
[rank2]:2025-10-27 15:37:43,485 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation"
[rank0]:2025-10-27 15:37:43,591 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation"
[rank3]:2025-10-27 15:37:43,673 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation"
[rank0]:2025-10-27 15:37:44,063 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-10-27 15:37:44,066 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-10-27 15:37:44,046 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-10-27 15:37:44,049 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-27 15:37:44,069 - INFO - [GC] Initial GC collection 0.00 seconds
[rank3]:2025-10-27 15:37:44,096 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-10-27 15:37:44,099 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-10-27 15:37:44,083 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-10-27 15:37:44,086 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-27 15:37:44,470 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-10-27 15:37:44,879 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank0]:2025-10-27 15:37:48,607 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank0]:2025-10-27 15:37:49,098 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-10-27 15:37:49,146 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-10-27 15:37:49,147 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-10-27 15:37:49,173 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-10-27 15:37:49,174 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2025-10-27 15:37:49,177 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-10-27 15:37:49,216 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-10-27 15:37:49,244 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-10-27 15:37:49,244 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2025-10-27 15:37:49,469 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-10-27 15:37:49,469 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-10-27 15:37:49,470 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank1]:2025-10-27 15:37:49,488 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-10-27 15:37:49,488 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-10-27 15:37:49,488 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank2]:2025-10-27 15:37:49,817 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-10-27 15:37:49,855 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-10-27 15:37:49,881 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-10-27 15:37:49,881 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank2]:2025-10-27 15:37:50,052 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-10-27 15:37:50,053 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-10-27 15:37:50,053 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run vf3r4v70
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data3/shcho/torchtitan/tb/1026_1F1B_apf_dm1/20251027-1537/wandb/run-20251027_153750-vf3r4v70
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1026_1F1B_apf_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/vf3r4v70
[rank3]:2025-10-27 15:37:51,798 - INFO - WandB logging enabled
[rank3]:2025-10-27 15:37:51,799 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-10-27 15:37:51,838 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-10-27 15:37:51,873 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-10-27 15:37:51,873 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank3]:2025-10-27 15:37:52,059 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-10-27 15:37:52,060 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-10-27 15:37:52,061 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank0]:2025-10-27 15:37:52,077 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data3/shcho/torchtitan/checkpoint/1026_1F1B_apf_dm1
[rank0]:2025-10-27 15:37:52,077 - WARNING - Mixed precision training with TP or PP is only supported when FSDP/HSDP/CP is enabled.
[rank0]:2025-10-27 15:37:52,077 - INFO - Mixed precision training is disabled
[rank0]:2025-10-27 15:37:52,077 - INFO - Preparing c4_validation dataset from allenai/c4
[rank0]:2025-10-27 15:37:57,365 - INFO - Trainer is initialized with local batch size 16, global batch size 64, gradient accumulation steps 4, sequence length 1024, total steps 1000 (warmup 100)
[rank0]:2025-10-27 15:37:57,365 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B-Instruct/original_dcp.
[rank0]:2025-10-27 15:38:00,597 - INFO - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-10-27 15:38:00,597 - INFO - Finished loading the checkpoint in 3.23 seconds.
[rank0]:2025-10-27 15:38:00,597 - INFO - Training starts at step 1
[rank0]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/autograd/graph.py:849: UserWarning: Attempting to run cuBLAS, but there was no current CUDA context! Attempting to set the primary context... (Triggered internally at /pytorch/aten/src/ATen/cuda/CublasHandlePool.cpp:270.)
[rank0]:  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
[rank2]:2025-10-27 15:38:14,908 - INFO -  step:  1  loss: -4.0000  grad_norm: 43.3594  memory:  5.39GiB(11.36%)  tps: 654  tflops: 5.11  mfu: 1.64%
[rank2]:2025-10-27 15:38:14,909 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-27 15:38:14,919 - INFO -  step:  1  loss:  1.2134  grad_norm: 43.3594  memory: 20.75GiB(43.67%)  tps: 710  tflops: 5.55  mfu: 1.78%
[rank3]:2025-10-27 15:38:14,919 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-10-27 15:38:14,911 - INFO -  step:  1  loss: -4.0000  grad_norm: 43.3594  memory:  8.46GiB(17.81%)  tps: 638  tflops: 4.98  mfu: 1.60%
[rank1]:2025-10-27 15:38:14,911 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-10-27 15:38:14,951 - INFO -  step:  1  loss: -4.0000  grad_norm: 43.3594  memory: 11.08GiB(23.32%)  tps: 635  tflops: 4.96  mfu: 1.59%
[rank0]:2025-10-27 15:38:14,951 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-27 15:38:28,565 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 15:38:28,566 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 15:38:28,566 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 15:38:28,567 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 15:38:28,567 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 15:38:28,568 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 15:38:28,568 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 15:38:28,569 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 15:38:28,569 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 15:38:28,570 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 15:38:28,570 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 15:38:28,570 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 15:38:28,571 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 15:38:28,571 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 15:38:28,572 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 15:38:28,572 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 15:38:28,630 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 15:38:28,630 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 15:38:28,630 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 15:38:28,630 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 15:38:28,630 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 15:38:28,630 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 15:38:28,630 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 15:38:28,630 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 15:38:28,631 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 15:38:28,631 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 15:38:28,631 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 15:38:28,631 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 15:38:28,631 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 15:38:28,631 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 15:38:28,631 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 15:38:28,631 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 15:38:28,698 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 15:38:28,699 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 15:38:28,699 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 15:38:28,699 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 15:38:28,699 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 15:38:28,699 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 15:38:28,699 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 15:38:28,699 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 15:38:28,699 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 15:38:28,699 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 15:38:28,699 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 15:38:28,699 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 15:38:28,699 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 15:38:28,699 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 15:38:28,699 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 15:38:28,699 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 15:38:28,763 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 15:38:28,763 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 15:38:28,763 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 15:38:28,763 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 15:38:28,763 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 15:38:28,763 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 15:38:28,763 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 15:38:28,763 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 15:38:28,763 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 15:38:28,763 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 15:38:28,763 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 15:38:28,763 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 15:38:28,763 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 15:38:28,763 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 15:38:28,764 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 15:38:28,764 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 15:40:45,941 - INFO -  step: 20  loss:  3.8421  grad_norm: 132.7755  memory: 24.67GiB(51.93%)  tps: 2,061  tflops: 16.11  mfu: 5.16%
[rank2]:2025-10-27 15:40:45,929 - INFO -  step: 20  loss: -4.0000  grad_norm: 132.7755  memory:  7.21GiB(15.18%)  tps: 2,061  tflops: 16.11  mfu: 5.16%
[rank0]:2025-10-27 15:40:45,947 - INFO -  step: 20  loss: -4.0000  grad_norm: 132.7755  memory: 14.87GiB(31.30%)  tps: 2,062  tflops: 16.12  mfu: 5.17%
[rank1]:2025-10-27 15:40:45,933 - INFO -  step: 20  loss: -4.0000  grad_norm: 132.7755  memory: 10.73GiB(22.58%)  tps: 2,061  tflops: 16.11  mfu: 5.16%
[rank3]:2025-10-27 15:40:47,712 - INFO - Avg. fwd time: 64.6762 / Avg. bwd time: 132.7141 / Avg. batch time: 1659.8440 (ms) / GPU bubble ratio: 4.86%
[rank2]:2025-10-27 15:40:47,770 - INFO - Avg. fwd time: 34.3397 / Avg. bwd time: 53.3027 / Avg. batch time: 1748.8675 (ms) / GPU bubble ratio: 59.91%
[rank1]:2025-10-27 15:40:47,859 - INFO - Avg. fwd time: 47.5852 / Avg. bwd time: 69.3338 / Avg. batch time: 1864.4334 (ms) / GPU bubble ratio: 49.83%
[rank0]:2025-10-27 15:40:47,920 - INFO - Avg. fwd time: 39.5689 / Avg. bwd time: 59.7363 / Avg. batch time: 1962.5128 (ms) / GPU bubble ratio: 59.52%
[rank1]:2025-10-27 15:43:26,516 - INFO -  step: 40  loss: -4.0000  grad_norm:  0.6223  memory: 10.73GiB(22.58%)  tps: 2,041  tflops: 15.95  mfu: 5.11%
[rank2]:2025-10-27 15:43:26,512 - INFO -  step: 40  loss: -4.0000  grad_norm:  0.6223  memory:  7.21GiB(15.18%)  tps: 2,041  tflops: 15.95  mfu: 5.11%
[rank3]:2025-10-27 15:43:26,524 - INFO -  step: 40  loss:  0.1930  grad_norm:  0.6223  memory: 24.67GiB(51.93%)  tps: 2,041  tflops: 15.95  mfu: 5.11%
[rank0]:2025-10-27 15:43:26,531 - INFO -  step: 40  loss: -4.0000  grad_norm:  0.6223  memory: 14.87GiB(31.30%)  tps: 2,041  tflops: 15.95  mfu: 5.11%
[rank2]:2025-10-27 15:43:28,384 - INFO - Avg. fwd time: 34.3981 / Avg. bwd time: 53.8815 / Avg. batch time: 1760.2175 (ms) / GPU bubble ratio: 59.88%
[rank3]:2025-10-27 15:43:28,329 - INFO - Avg. fwd time: 65.6462 / Avg. bwd time: 134.5948 / Avg. batch time: 1670.7034 (ms) / GPU bubble ratio: 4.12%
[rank1]:2025-10-27 15:43:28,464 - INFO - Avg. fwd time: 47.9991 / Avg. bwd time: 69.8720 / Avg. batch time: 1876.2770 (ms) / GPU bubble ratio: 49.74%
[rank0]:2025-10-27 15:43:28,525 - INFO - Avg. fwd time: 39.7896 / Avg. bwd time: 60.5015 / Avg. batch time: 1974.4991 (ms) / GPU bubble ratio: 59.37%
[rank0]:2025-10-27 15:44:39,542 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-27 15:46:07,388 - INFO -  step: 60  loss: -4.0000  grad_norm:  0.6554  memory: 10.73GiB(22.58%)  tps: 2,037  tflops: 15.92  mfu: 5.10%
[rank2]:2025-10-27 15:46:07,384 - INFO -  step: 60  loss: -4.0000  grad_norm:  0.6554  memory:  7.21GiB(15.18%)  tps: 2,037  tflops: 15.92  mfu: 5.10%
[rank3]:2025-10-27 15:46:07,396 - INFO -  step: 60  loss:  0.1770  grad_norm:  0.6554  memory: 24.67GiB(51.93%)  tps: 2,037  tflops: 15.92  mfu: 5.10%
[rank0]:2025-10-27 15:46:07,399 - INFO -  step: 60  loss: -4.0000  grad_norm:  0.6554  memory: 14.87GiB(31.30%)  tps: 2,037  tflops: 15.92  mfu: 5.10%
[rank2]:2025-10-27 15:46:09,264 - INFO - Avg. fwd time: 34.4344 / Avg. bwd time: 54.0563 / Avg. batch time: 1764.3754 (ms) / GPU bubble ratio: 59.88%
[rank3]:2025-10-27 15:46:09,204 - INFO - Avg. fwd time: 66.0208 / Avg. bwd time: 135.2601 / Avg. batch time: 1674.9795 (ms) / GPU bubble ratio: 3.86%
[rank1]:2025-10-27 15:46:09,344 - INFO - Avg. fwd time: 48.1484 / Avg. bwd time: 69.9688 / Avg. batch time: 1881.0713 (ms) / GPU bubble ratio: 49.77%
[rank0]:2025-10-27 15:46:09,405 - INFO - Avg. fwd time: 39.8833 / Avg. bwd time: 60.8343 / Avg. batch time: 1979.6486 (ms) / GPU bubble ratio: 59.30%
[rank1]:2025-10-27 15:48:48,284 - INFO -  step: 80  loss: -4.0000  grad_norm:  3.1147  memory: 10.73GiB(22.58%)  tps: 2,037  tflops: 15.92  mfu: 5.10%
[rank3]:2025-10-27 15:48:48,292 - INFO -  step: 80  loss:  0.1456  grad_norm:  3.1147  memory: 24.67GiB(51.93%)  tps: 2,037  tflops: 15.92  mfu: 5.10%
[rank2]:2025-10-27 15:48:48,281 - INFO -  step: 80  loss: -4.0000  grad_norm:  3.1147  memory:  7.21GiB(15.18%)  tps: 2,037  tflops: 15.92  mfu: 5.10%
[rank0]:2025-10-27 15:48:48,298 - INFO -  step: 80  loss: -4.0000  grad_norm:  3.1147  memory: 14.87GiB(31.30%)  tps: 2,037  tflops: 15.92  mfu: 5.10%
[rank3]:2025-10-27 15:48:50,111 - INFO - Avg. fwd time: 66.2248 / Avg. bwd time: 135.6200 / Avg. batch time: 1677.4639 (ms) / GPU bubble ratio: 3.74%
[rank2]:2025-10-27 15:48:50,166 - INFO - Avg. fwd time: 34.3860 / Avg. bwd time: 54.0554 / Avg. batch time: 1766.8624 (ms) / GPU bubble ratio: 59.96%
[rank1]:2025-10-27 15:48:50,240 - INFO - Avg. fwd time: 48.2236 / Avg. bwd time: 70.1506 / Avg. batch time: 1883.6375 (ms) / GPU bubble ratio: 49.73%
[rank0]:2025-10-27 15:48:50,306 - INFO - Avg. fwd time: 39.7146 / Avg. bwd time: 60.8396 / Avg. batch time: 1982.2938 (ms) / GPU bubble ratio: 59.42%
[rank1]:2025-10-27 15:50:48,640 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-27 15:50:48,637 - INFO - Freezing Ratio: [Stage2] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-27 15:50:48,657 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-27 15:50:49,295 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-27 15:51:11,263 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-27 15:51:16,600 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-27 15:51:16,601 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-27 15:51:16,609 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.0000  memory: 14.87GiB(31.30%)  tps: 2,209  tflops: 17.27  mfu: 5.54%
[rank0]:2025-10-27 15:51:16,609 - INFO - ðŸ”Ž  Running validation at step 100
[rank1]:2025-10-27 15:51:16,601 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-27 15:51:16,609 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.0000  memory: 10.73GiB(22.58%)  tps: 2,209  tflops: 17.27  mfu: 5.54%
[rank1]:2025-10-27 15:51:16,609 - INFO - ðŸ”Ž  Running validation at step 100
[rank2]:2025-10-27 15:51:16,601 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.0000  memory:  7.21GiB(15.18%)  tps: 2,209  tflops: 17.27  mfu: 5.54%
[rank2]:2025-10-27 15:51:16,608 - INFO - ðŸ”Ž  Running validation at step 100
[rank3]:2025-10-27 15:51:18,976 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-27 15:51:18,979 - INFO -  step: 100  loss:  0.1498  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,175  tflops: 17.00  mfu: 5.45%
[rank3]:2025-10-27 15:51:18,980 - INFO - ðŸ”Ž  Running validation at step 100
[rank0]:2025-10-27 15:52:29,923 - INFO - validate step: 100  loss: -1.0000  memory: 14.87GiB(31.30%)  tps: 5,587
[rank1]:2025-10-27 15:52:30,008 - INFO - validate step: 100  loss: -1.0000  memory: 10.73GiB(22.58%)  tps: 5,580
[rank2]:2025-10-27 15:52:30,087 - INFO - validate step: 100  loss: -1.0000  memory:  7.21GiB(15.18%)  tps: 5,574
[rank3]:2025-10-27 15:52:30,170 - INFO - validate step: 100  loss:  0.2978  memory: 24.67GiB(51.93%)  tps: 5,754
[rank1]:2025-10-27 15:52:30,266 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1026_1F1B_apf_dm1/freeze_ratio_history/rank1/251027_1552_stage1_step100.svg
[rank2]:2025-10-27 15:52:30,257 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1026_1F1B_apf_dm1/freeze_ratio_history/rank2/251027_1552_stage2_step100.svg
[rank0]:2025-10-27 15:52:30,258 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1026_1F1B_apf_dm1/freeze_ratio_history/rank0/251027_1552_stage0_step100.svg
[rank3]:2025-10-27 15:52:30,406 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1026_1F1B_apf_dm1/pipeline_schedule/251027_1552_real_step100_rank3.svg
[rank3]:> Batch Time: 1920.00 ms, GPU Bubble Ratio: 57.70%, 51.22%, 63.16%, 15.32%
[rank3]:2025-10-27 15:52:30,469 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1026_1F1B_apf_dm1/freeze_ratio_history/rank3/251027_1552_stage3_step100.svg
[rank3]:2025-10-27 15:52:32,168 - INFO - Avg. fwd time: 66.2492 / Avg. bwd time: 132.6919 / Avg. batch time: 1652.9452 (ms) / GPU bubble ratio: 3.72%
[rank2]:2025-10-27 15:52:32,227 - INFO - Avg. fwd time: 34.2718 / Avg. bwd time: 52.7591 / Avg. batch time: 1742.5553 (ms) / GPU bubble ratio: 60.04%
[rank1]:2025-10-27 15:52:32,298 - INFO - Avg. fwd time: 48.1606 / Avg. bwd time: 68.6431 / Avg. batch time: 1857.5575 (ms) / GPU bubble ratio: 49.70%
[rank0]:2025-10-27 15:52:32,365 - INFO - Avg. fwd time: 39.5573 / Avg. bwd time: 57.8108 / Avg. batch time: 1953.1619 (ms) / GPU bubble ratio: 60.12%
[rank1]:2025-10-27 15:53:10,489 - INFO - Freezing Ratio: [Stage1] 0.98, Threshold: 5.0000e-02
[rank2]:2025-10-27 15:53:10,485 - INFO - Freezing Ratio: [Stage2] 0.97, Threshold: 5.0000e-02
[rank0]:2025-10-27 15:53:10,506 - INFO - Freezing Ratio: [Stage0] 0.97, Threshold: 5.0000e-02
[rank3]:2025-10-27 15:53:13,052 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
