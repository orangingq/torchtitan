
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 10. 27. (ì›”) 05:17:58 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 3,4,5,6
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1026_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1026_llama1b/1026_GPipe_auto.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation
âœ”ï¸Running with auto x GPipe ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1026_llama1b/config.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=auto
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank2]:2025-10-27 05:18:04,201 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation"
[rank3]:2025-10-27 05:18:04,202 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation"
[rank0]:2025-10-27 05:18:04,388 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation"
[rank1]:2025-10-27 05:18:04,430 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation"
[rank3]:2025-10-27 05:18:04,922 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-10-27 05:18:04,924 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-27 05:18:04,962 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-10-27 05:18:04,964 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-27 05:18:04,969 - INFO - [GC] Initial GC collection 0.00 seconds
[rank2]:2025-10-27 05:18:04,952 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-10-27 05:18:04,954 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-10-27 05:18:04,960 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-10-27 05:18:04,963 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-27 05:18:05,378 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-10-27 05:18:05,786 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank2]:2025-10-27 05:18:08,892 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-10-27 05:18:08,933 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-10-27 05:18:08,942 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-10-27 05:18:08,967 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-10-27 05:18:08,967 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2025-10-27 05:18:08,983 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-10-27 05:18:09,011 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-10-27 05:18:09,011 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank2]:2025-10-27 05:18:09,165 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-10-27 05:18:09,165 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-10-27 05:18:09,166 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank1]:2025-10-27 05:18:09,199 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-10-27 05:18:09,200 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-10-27 05:18:09,200 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank0]:2025-10-27 05:18:09,278 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank0]:2025-10-27 05:18:09,735 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-10-27 05:18:09,772 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-10-27 05:18:09,773 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-10-27 05:18:09,799 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-10-27 05:18:09,800 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank0]:2025-10-27 05:18:10,360 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-10-27 05:18:10,360 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-10-27 05:18:10,360 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank3]:wandb: setting up run st9uunkz
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data3/shcho/torchtitan/tb/1026_GPipe_auto_dm1/20251027-0518/wandb/run-20251027_051809-st9uunkz
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1026_GPipe_auto_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/st9uunkz
[rank3]:2025-10-27 05:18:10,945 - INFO - WandB logging enabled
[rank3]:2025-10-27 05:18:10,946 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-10-27 05:18:10,983 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-10-27 05:18:11,012 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-10-27 05:18:11,012 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank3]:2025-10-27 05:18:11,209 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-10-27 05:18:11,210 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-10-27 05:18:11,211 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank0]:2025-10-27 05:18:11,226 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data3/shcho/torchtitan/checkpoint/1026_GPipe_auto_dm1
[rank0]:2025-10-27 05:18:11,226 - WARNING - Mixed precision training with TP or PP is only supported when FSDP/HSDP/CP is enabled.
[rank0]:2025-10-27 05:18:11,226 - INFO - Mixed precision training is disabled
[rank0]:2025-10-27 05:18:11,226 - INFO - Preparing c4_validation dataset from allenai/c4
[rank0]:2025-10-27 05:18:16,553 - INFO - Trainer is initialized with local batch size 16, global batch size 64, gradient accumulation steps 4, sequence length 1024, total steps 1000 (warmup 100)
[rank0]:2025-10-27 05:18:16,553 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B-Instruct/original_dcp.
[rank0]:2025-10-27 05:18:18,804 - INFO - [GC] GC collection for checkpoint loading. 0.01 seconds
[rank0]:2025-10-27 05:18:18,804 - INFO - Finished loading the checkpoint in 2.25 seconds.
[rank0]:2025-10-27 05:18:18,804 - INFO - Training starts at step 1
[rank0]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/autograd/graph.py:849: UserWarning: Attempting to run cuBLAS, but there was no current CUDA context! Attempting to set the primary context... (Triggered internally at /pytorch/aten/src/ATen/cuda/CublasHandlePool.cpp:270.)
[rank0]:  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
[rank3]:2025-10-27 05:18:30,022 - INFO -  step:  1  loss:  1.2134  grad_norm: 43.3594  memory: 35.59GiB(74.92%)  tps: 861  tflops: 6.73  mfu: 2.16%
[rank3]:2025-10-27 05:18:30,023 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-10-27 05:18:30,014 - INFO -  step:  1  loss: -4.0000  grad_norm: 43.3594  memory: 17.77GiB(37.40%)  tps: 779  tflops: 6.09  mfu: 1.95%
[rank1]:2025-10-27 05:18:30,014 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-10-27 05:18:30,010 - INFO -  step:  1  loss: -4.0000  grad_norm: 43.3594  memory: 14.29GiB(30.07%)  tps: 777  tflops: 6.08  mfu: 1.95%
[rank2]:2025-10-27 05:18:30,010 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-10-27 05:18:30,046 - INFO -  step:  1  loss: -4.0000  grad_norm: 43.3594  memory: 17.10GiB(35.99%)  tps: 808  tflops: 6.32  mfu: 2.02%
[rank0]:2025-10-27 05:18:30,047 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-27 05:18:43,859 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 05:18:43,860 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 05:18:43,860 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 05:18:43,861 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 05:18:43,861 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 05:18:43,861 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 05:18:43,861 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 05:18:43,862 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 05:18:43,862 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 05:18:43,862 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 05:18:43,862 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 05:18:43,863 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 05:18:43,863 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 05:18:43,863 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 05:18:43,863 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 05:18:43,864 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 05:18:43,919 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 05:18:43,919 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 05:18:43,919 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 05:18:43,919 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 05:18:43,919 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 05:18:43,919 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 05:18:43,919 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 05:18:43,919 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 05:18:43,920 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 05:18:43,920 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 05:18:43,920 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 05:18:43,920 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 05:18:43,920 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 05:18:43,920 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 05:18:43,920 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 05:18:43,920 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 05:18:44,056 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 05:18:44,056 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 05:18:44,056 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 05:18:44,056 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 05:18:44,056 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 05:18:44,056 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 05:18:44,056 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 05:18:44,056 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 05:18:44,056 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 05:18:44,056 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 05:18:44,056 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 05:18:44,056 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 05:18:44,056 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 05:18:44,056 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 05:18:44,056 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 05:18:44,057 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 05:18:43,995 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 05:18:43,995 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 05:18:43,995 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 05:18:43,996 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 05:18:43,996 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 05:18:43,996 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 05:18:43,996 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 05:18:43,996 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 05:18:43,996 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 05:18:43,996 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 05:18:43,996 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 05:18:43,996 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 05:18:43,996 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 05:18:43,996 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 05:18:43,996 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 05:18:43,996 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 05:21:01,232 - INFO -  step: 20  loss: -4.0000  grad_norm: 132.7753  memory: 16.10GiB(33.90%)  tps: 2,059  tflops: 16.09  mfu: 5.16%
[rank1]:2025-10-27 05:21:01,236 - INFO -  step: 20  loss: -4.0000  grad_norm: 132.7753  memory: 20.03GiB(42.17%)  tps: 2,059  tflops: 16.09  mfu: 5.16%
[rank3]:2025-10-27 05:21:01,245 - INFO -  step: 20  loss:  3.8421  grad_norm: 132.7753  memory: 38.93GiB(81.95%)  tps: 2,059  tflops: 16.09  mfu: 5.16%
[rank0]:2025-10-27 05:21:01,251 - INFO -  step: 20  loss: -4.0000  grad_norm: 132.7753  memory: 20.89GiB(43.97%)  tps: 2,059  tflops: 16.09  mfu: 5.16%
[rank3]:2025-10-27 05:21:03,033 - INFO - Avg. fwd time: 70.3996 / Avg. bwd time: 127.6145 / Avg. batch time: 1659.0252 (ms) / GPU bubble ratio: 4.52%
[rank2]:2025-10-27 05:21:03,088 - INFO - Avg. fwd time: 32.7947 / Avg. bwd time: 53.1716 / Avg. batch time: 1748.4844 (ms) / GPU bubble ratio: 60.67%
[rank1]:2025-10-27 05:21:03,165 - INFO - Avg. fwd time: 51.2619 / Avg. bwd time: 72.5780 / Avg. batch time: 1867.7612 (ms) / GPU bubble ratio: 46.96%
[rank0]:2025-10-27 05:21:03,229 - INFO - Avg. fwd time: 45.7364 / Avg. bwd time: 59.3210 / Avg. batch time: 1965.6684 (ms) / GPU bubble ratio: 57.24%
[rank1]:2025-10-27 05:23:41,168 - INFO -  step: 40  loss: -4.0000  grad_norm:  0.6224  memory: 20.03GiB(42.17%)  tps: 2,049  tflops: 16.02  mfu: 5.13%
[rank0]:2025-10-27 05:23:41,184 - INFO -  step: 40  loss: -4.0000  grad_norm:  0.6224  memory: 20.89GiB(43.97%)  tps: 2,049  tflops: 16.02  mfu: 5.13%
[rank2]:2025-10-27 05:23:41,165 - INFO -  step: 40  loss: -4.0000  grad_norm:  0.6224  memory: 16.10GiB(33.90%)  tps: 2,049  tflops: 16.02  mfu: 5.13%
[rank3]:2025-10-27 05:23:41,177 - INFO -  step: 40  loss:  0.1930  grad_norm:  0.6224  memory: 38.93GiB(81.95%)  tps: 2,049  tflops: 16.02  mfu: 5.13%
[rank3]:2025-10-27 05:23:42,970 - INFO - Avg. fwd time: 71.0747 / Avg. bwd time: 129.2776 / Avg. batch time: 1664.7542 (ms) / GPU bubble ratio: 3.72%
[rank2]:2025-10-27 05:23:43,028 - INFO - Avg. fwd time: 33.0502 / Avg. bwd time: 53.6847 / Avg. batch time: 1754.2573 (ms) / GPU bubble ratio: 60.45%
[rank1]:2025-10-27 05:23:43,107 - INFO - Avg. fwd time: 51.8635 / Avg. bwd time: 73.2954 / Avg. batch time: 1873.7339 (ms) / GPU bubble ratio: 46.56%
[rank0]:2025-10-27 05:23:43,175 - INFO - Avg. fwd time: 46.0190 / Avg. bwd time: 59.8406 / Avg. batch time: 1971.9161 (ms) / GPU bubble ratio: 57.05%
[rank0]:2025-10-27 05:24:54,120 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-27 05:26:21,770 - INFO -  step: 60  loss: -4.0000  grad_norm:  0.6556  memory: 20.03GiB(42.17%)  tps: 2,040  tflops: 15.95  mfu: 5.11%
[rank0]:2025-10-27 05:26:21,787 - INFO -  step: 60  loss: -4.0000  grad_norm:  0.6556  memory: 20.89GiB(43.97%)  tps: 2,040  tflops: 15.95  mfu: 5.11%
[rank2]:2025-10-27 05:26:21,767 - INFO -  step: 60  loss: -4.0000  grad_norm:  0.6556  memory: 16.10GiB(33.90%)  tps: 2,040  tflops: 15.95  mfu: 5.11%
[rank3]:2025-10-27 05:26:21,779 - INFO -  step: 60  loss:  0.1770  grad_norm:  0.6556  memory: 38.93GiB(81.95%)  tps: 2,040  tflops: 15.95  mfu: 5.11%
[rank3]:2025-10-27 05:26:23,597 - INFO - Avg. fwd time: 71.5152 / Avg. bwd time: 129.9833 / Avg. batch time: 1669.2579 (ms) / GPU bubble ratio: 3.43%
[rank2]:2025-10-27 05:26:23,653 - INFO - Avg. fwd time: 33.2550 / Avg. bwd time: 53.8687 / Avg. batch time: 1758.8635 (ms) / GPU bubble ratio: 60.37%
[rank1]:2025-10-27 05:26:23,736 - INFO - Avg. fwd time: 51.6219 / Avg. bwd time: 73.4805 / Avg. batch time: 1878.3888 (ms) / GPU bubble ratio: 46.72%
[rank0]:2025-10-27 05:26:23,800 - INFO - Avg. fwd time: 46.0766 / Avg. bwd time: 60.0340 / Avg. batch time: 1976.8264 (ms) / GPU bubble ratio: 57.06%
[rank1]:2025-10-27 05:29:02,268 - INFO -  step: 80  loss: -4.0000  grad_norm:  3.1403  memory: 20.03GiB(42.17%)  tps: 2,042  tflops: 15.96  mfu: 5.12%
[rank3]:2025-10-27 05:29:02,276 - INFO -  step: 80  loss:  0.1456  grad_norm:  3.1403  memory: 38.93GiB(81.95%)  tps: 2,042  tflops: 15.96  mfu: 5.12%
[rank0]:2025-10-27 05:29:02,284 - INFO -  step: 80  loss: -4.0000  grad_norm:  3.1403  memory: 20.89GiB(43.97%)  tps: 2,042  tflops: 15.96  mfu: 5.12%
[rank2]:2025-10-27 05:29:02,264 - INFO -  step: 80  loss: -4.0000  grad_norm:  3.1403  memory: 16.10GiB(33.90%)  tps: 2,042  tflops: 15.96  mfu: 5.12%
[rank3]:2025-10-27 05:29:04,121 - INFO - Avg. fwd time: 71.7700 / Avg. bwd time: 130.2828 / Avg. batch time: 1671.3292 (ms) / GPU bubble ratio: 3.29%
[rank2]:2025-10-27 05:29:04,178 - INFO - Avg. fwd time: 33.2731 / Avg. bwd time: 53.9147 / Avg. batch time: 1760.9223 (ms) / GPU bubble ratio: 60.39%
[rank1]:2025-10-27 05:29:04,259 - INFO - Avg. fwd time: 51.5828 / Avg. bwd time: 73.4372 / Avg. batch time: 1880.3500 (ms) / GPU bubble ratio: 46.81%
[rank0]:2025-10-27 05:29:04,326 - INFO - Avg. fwd time: 45.9934 / Avg. bwd time: 60.1074 / Avg. batch time: 1978.9785 (ms) / GPU bubble ratio: 57.11%
[rank3]:2025-10-27 05:31:02,927 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 0.0000e+00
[rank1]:2025-10-27 05:31:02,921 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 0.0000e+00
[rank0]:2025-10-27 05:31:02,931 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 0.0000e+00
[rank2]:2025-10-27 05:31:02,915 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 0.0000e+00
[rank0]:2025-10-27 05:31:35,227 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-27 05:31:43,208 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 4.3792e-01
[rank2]:2025-10-27 05:31:43,209 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.4795  memory: 16.10GiB(33.90%)  tps: 2,036  tflops: 15.92  mfu: 5.10%
[rank2]:2025-10-27 05:31:43,209 - INFO - ðŸ”Ž  Running validation at step 100
[rank1]:2025-10-27 05:31:43,213 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 9.1953e-01
[rank1]:2025-10-27 05:31:43,214 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.4795  memory: 20.03GiB(42.17%)  tps: 2,036  tflops: 15.92  mfu: 5.10%
[rank1]:2025-10-27 05:31:43,214 - INFO - ðŸ”Ž  Running validation at step 100
[rank3]:2025-10-27 05:31:43,220 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 9.0341e-01
[rank3]:2025-10-27 05:31:43,223 - INFO -  step: 100  loss:  0.1413  grad_norm:  0.4795  memory: 38.93GiB(81.95%)  tps: 2,036  tflops: 15.92  mfu: 5.10%
[rank3]:2025-10-27 05:31:43,224 - INFO - ðŸ”Ž  Running validation at step 100
[rank0]:2025-10-27 05:31:43,225 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 1.5232e+00
[rank0]:2025-10-27 05:31:43,225 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.4795  memory: 20.89GiB(43.97%)  tps: 2,036  tflops: 15.92  mfu: 5.10%
[rank0]:2025-10-27 05:31:43,225 - INFO - ðŸ”Ž  Running validation at step 100
[rank0]:2025-10-27 05:32:54,369 - INFO - validate step: 100  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,757
[rank1]:2025-10-27 05:32:54,449 - INFO - validate step: 100  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,750
[rank2]:2025-10-27 05:32:54,531 - INFO - validate step: 100  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,743
[rank1]:2025-10-27 05:32:54,693 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_auto_dm1/freeze_ratio_history/rank1/251027_0532_stage1_step100.svg
[rank3]:2025-10-27 05:32:54,615 - INFO - validate step: 100  loss:  0.2965  memory: 38.93GiB(81.95%)  tps: 5,738
[rank0]:2025-10-27 05:32:54,694 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_auto_dm1/freeze_ratio_history/rank0/251027_0532_stage0_step100.svg
[rank2]:2025-10-27 05:32:54,695 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_auto_dm1/freeze_ratio_history/rank2/251027_0532_stage2_step100.svg
[rank3]:2025-10-27 05:32:54,832 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1026_GPipe_auto_dm1/pipeline_schedule/251027_0532_real_step100_rank3.svg
[rank3]:> Batch Time: 1933.50 ms, GPU Bubble Ratio: 56.06%, 47.68%, 64.14%, 15.54%
[rank3]:2025-10-27 05:32:54,893 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_auto_dm1/freeze_ratio_history/rank3/251027_0532_stage3_step100.svg
[rank3]:2025-10-27 05:32:56,582 - INFO - Avg. fwd time: 71.9169 / Avg. bwd time: 130.5231 / Avg. batch time: 1673.0438 (ms) / GPU bubble ratio: 3.20%
[rank2]:2025-10-27 05:32:56,639 - INFO - Avg. fwd time: 33.2860 / Avg. bwd time: 54.0145 / Avg. batch time: 1763.0172 (ms) / GPU bubble ratio: 60.39%
[rank1]:2025-10-27 05:32:56,719 - INFO - Avg. fwd time: 51.4427 / Avg. bwd time: 73.5268 / Avg. batch time: 1882.7400 (ms) / GPU bubble ratio: 46.90%
[rank0]:2025-10-27 05:32:56,782 - INFO - Avg. fwd time: 45.8597 / Avg. bwd time: 60.1804 / Avg. batch time: 1981.3939 (ms) / GPU bubble ratio: 57.19%
[rank1]:2025-10-27 05:33:34,740 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.3228e+00
[rank3]:2025-10-27 05:33:34,747 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 7.9998e-01
[rank0]:2025-10-27 05:33:34,756 - INFO - Freezing Ratio: [Stage0] 0.24, Threshold: 1.7014e+00
[rank2]:2025-10-27 05:33:34,736 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.3093e+00
[rank1]:2025-10-27 05:34:14,982 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.6390e+00
[rank3]:2025-10-27 05:34:14,990 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 9.1248e-01
[rank0]:2025-10-27 05:34:14,995 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 9.9041e-01
[rank2]:2025-10-27 05:34:14,978 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 6.6986e-01
[rank2]:2025-10-27 05:34:55,004 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 3.6605e+00
[rank1]:2025-10-27 05:34:55,015 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 4.9339e+00
[rank3]:2025-10-27 05:34:55,023 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 5.5302e+00
[rank0]:2025-10-27 05:34:55,032 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 3.9390e+00
[rank2]:2025-10-27 05:35:33,123 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 4.0982e+00
[rank2]:2025-10-27 05:35:33,123 - INFO -  step: 120  loss: -4.0000  grad_norm:  0.1432  memory: 16.10GiB(33.90%)  tps: 2,066  tflops: 16.15  mfu: 5.18%
[rank1]:2025-10-27 05:35:33,127 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 7.6986e+00
[rank1]:2025-10-27 05:35:33,127 - INFO -  step: 120  loss: -4.0000  grad_norm:  0.1432  memory: 20.03GiB(42.17%)  tps: 2,065  tflops: 16.14  mfu: 5.17%
[rank3]:2025-10-27 05:35:33,130 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 7.1052e+00
[rank3]:2025-10-27 05:35:33,133 - INFO -  step: 120  loss:  0.1343  grad_norm:  0.1432  memory: 38.93GiB(81.95%)  tps: 2,067  tflops: 16.16  mfu: 5.18%
[rank0]:2025-10-27 05:35:33,138 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 8.2095e+00
[rank0]:2025-10-27 05:35:33,138 - INFO -  step: 120  loss: -4.0000  grad_norm:  0.1432  memory: 20.89GiB(43.97%)  tps: 2,064  tflops: 16.13  mfu: 5.17%
[rank3]:2025-10-27 05:35:34,928 - INFO - Avg. fwd time: 71.9538 / Avg. bwd time: 130.2690 / Avg. batch time: 1670.3537 (ms) / GPU bubble ratio: 3.15%
[rank2]:2025-10-27 05:35:34,972 - INFO - Avg. fwd time: 33.2883 / Avg. bwd time: 53.4994 / Avg. batch time: 1759.6963 (ms) / GPU bubble ratio: 60.54%
[rank1]:2025-10-27 05:35:35,052 - INFO - Avg. fwd time: 51.4103 / Avg. bwd time: 73.6946 / Avg. batch time: 1879.5236 (ms) / GPU bubble ratio: 46.75%
[rank0]:2025-10-27 05:35:35,114 - INFO - Avg. fwd time: 45.9588 / Avg. bwd time: 59.6205 / Avg. batch time: 1977.5963 (ms) / GPU bubble ratio: 57.29%
[rank2]:2025-10-27 05:36:12,869 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 3.3971e+00
[rank1]:2025-10-27 05:36:12,882 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 4.4133e+00
[rank3]:2025-10-27 05:36:12,889 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 3.7334e+00
[rank0]:2025-10-27 05:36:12,896 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.9594e+00
[rank3]:2025-10-27 05:36:51,177 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.3494e+00
[rank1]:2025-10-27 05:36:51,166 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 7.0965e-01
[rank0]:2025-10-27 05:36:51,181 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 2.3300e+00
[rank2]:2025-10-27 05:36:51,170 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 3.7316e-01
[rank2]:2025-10-27 05:37:30,460 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.9907e+00
[rank1]:2025-10-27 05:37:30,476 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 2.5112e+00
[rank3]:2025-10-27 05:37:30,480 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 3.1532e+00
[rank0]:2025-10-27 05:37:30,489 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 2.1208e+00
[rank2]:2025-10-27 05:38:08,448 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.7987e-01
[rank2]:2025-10-27 05:38:08,448 - INFO -  step: 140  loss: -4.0000  grad_norm:  0.1746  memory: 16.10GiB(33.90%)  tps: 2,110  tflops: 16.49  mfu: 5.29%
[rank3]:2025-10-27 05:38:08,455 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.0242e+00
[rank3]:2025-10-27 05:38:08,458 - INFO -  step: 140  loss:  0.1359  grad_norm:  0.1746  memory: 38.93GiB(81.95%)  tps: 2,110  tflops: 16.49  mfu: 5.29%
[rank1]:2025-10-27 05:38:08,444 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 7.5103e-01
[rank1]:2025-10-27 05:38:08,445 - INFO -  step: 140  loss: -4.0000  grad_norm:  0.1746  memory: 20.03GiB(42.17%)  tps: 2,110  tflops: 16.49  mfu: 5.29%
[rank0]:2025-10-27 05:38:08,455 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 1.6431e+00
[rank0]:2025-10-27 05:38:08,456 - INFO -  step: 140  loss: -4.0000  grad_norm:  0.1746  memory: 20.89GiB(43.97%)  tps: 2,110  tflops: 16.49  mfu: 5.29%
[rank3]:2025-10-27 05:38:10,269 - INFO - Avg. fwd time: 71.9685 / Avg. bwd time: 129.7541 / Avg. batch time: 1665.7259 (ms) / GPU bubble ratio: 3.12%
[rank2]:2025-10-27 05:38:10,314 - INFO - Avg. fwd time: 33.2516 / Avg. bwd time: 52.6422 / Avg. batch time: 1754.0788 (ms) / GPU bubble ratio: 60.83%
[rank1]:2025-10-27 05:38:10,391 - INFO - Avg. fwd time: 51.4559 / Avg. bwd time: 72.5594 / Avg. batch time: 1872.5815 (ms) / GPU bubble ratio: 47.02%
[rank0]:2025-10-27 05:38:10,453 - INFO - Avg. fwd time: 45.9508 / Avg. bwd time: 58.7182 / Avg. batch time: 1969.6605 (ms) / GPU bubble ratio: 57.49%
[rank2]:2025-10-27 05:38:48,506 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 8.0024e+00
[rank3]:2025-10-27 05:38:48,525 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 8.2168e+00
[rank1]:2025-10-27 05:38:48,518 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 4.0429e+00
[rank0]:2025-10-27 05:38:48,534 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 4.1492e+00
[rank0]:2025-10-27 05:39:18,441 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-27 05:39:25,977 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.6299e+00
[rank1]:2025-10-27 05:39:25,965 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.4157e+00
[rank0]:2025-10-27 05:39:25,984 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 3.8388e+00
[rank2]:2025-10-27 05:39:25,969 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 9.7547e-01
[rank2]:2025-10-27 05:40:05,481 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 9.9916e-01
[rank3]:2025-10-27 05:40:05,500 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 9.3960e-01
[rank1]:2025-10-27 05:40:05,492 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 3.8645e-01
[rank0]:2025-10-27 05:40:05,508 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 3.9300e-01
[rank1]:2025-10-27 05:40:43,811 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.9324e+00
[rank1]:2025-10-27 05:40:43,812 - INFO -  step: 160  loss: -4.0000  grad_norm:  0.2433  memory: 20.03GiB(42.17%)  tps: 2,109  tflops: 16.49  mfu: 5.28%
[rank0]:2025-10-27 05:40:43,830 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 4.5238e+00
[rank0]:2025-10-27 05:40:43,830 - INFO -  step: 160  loss: -4.0000  grad_norm:  0.2433  memory: 20.89GiB(43.97%)  tps: 2,109  tflops: 16.49  mfu: 5.28%
[rank2]:2025-10-27 05:40:43,816 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.2893e+00
[rank2]:2025-10-27 05:40:43,816 - INFO -  step: 160  loss: -4.0000  grad_norm:  0.2433  memory: 16.10GiB(33.90%)  tps: 2,109  tflops: 16.49  mfu: 5.28%
[rank3]:2025-10-27 05:40:43,823 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.2832e+01
[rank3]:2025-10-27 05:40:43,826 - INFO -  step: 160  loss:  0.1089  grad_norm:  0.2433  memory: 38.93GiB(81.95%)  tps: 2,109  tflops: 16.49  mfu: 5.28%
[rank3]:2025-10-27 05:40:45,533 - INFO - Avg. fwd time: 71.9571 / Avg. bwd time: 129.3732 / Avg. batch time: 1662.1045 (ms) / GPU bubble ratio: 3.10%
[rank2]:2025-10-27 05:40:45,577 - INFO - Avg. fwd time: 33.2445 / Avg. bwd time: 52.0111 / Avg. batch time: 1749.7301 (ms) / GPU bubble ratio: 61.02%
[rank1]:2025-10-27 05:40:45,660 - INFO - Avg. fwd time: 51.4973 / Avg. bwd time: 71.6869 / Avg. batch time: 1867.2063 (ms) / GPU bubble ratio: 47.22%
[rank0]:2025-10-27 05:40:45,727 - INFO - Avg. fwd time: 45.9565 / Avg. bwd time: 58.0647 / Avg. batch time: 1963.5783 (ms) / GPU bubble ratio: 57.62%
[rank3]:2025-10-27 05:41:20,831 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 5.3406e+00
[rank1]:2025-10-27 05:41:20,833 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.5779e+00
[rank0]:2025-10-27 05:41:20,849 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 8.2587e-01
[rank2]:2025-10-27 05:41:20,819 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.9109e+00
[rank3]:2025-10-27 05:41:58,606 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.4017e+00
[rank1]:2025-10-27 05:41:58,594 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.2215e+00
[rank0]:2025-10-27 05:41:58,605 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 7.9575e-01
[rank2]:2025-10-27 05:41:58,598 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.3718e-01
[rank2]:2025-10-27 05:42:35,872 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.7327e+00
[rank3]:2025-10-27 05:42:35,884 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 1.7947e+00
[rank1]:2025-10-27 05:42:35,884 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 6.3047e-01
[rank0]:2025-10-27 05:42:35,900 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 3.5616e-01
[rank2]:2025-10-27 05:43:13,755 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.3058e+00
[rank2]:2025-10-27 05:43:13,756 - INFO -  step: 180  loss: -4.0000  grad_norm:  0.4240  memory: 16.10GiB(33.90%)  tps: 2,185  tflops: 17.08  mfu: 5.48%
[rank3]:2025-10-27 05:43:13,763 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.6524e+00
[rank3]:2025-10-27 05:43:13,766 - INFO -  step: 180  loss:  0.1320  grad_norm:  0.4240  memory: 38.93GiB(81.95%)  tps: 2,185  tflops: 17.08  mfu: 5.48%
[rank1]:2025-10-27 05:43:13,752 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.8952e+00
[rank1]:2025-10-27 05:43:13,752 - INFO -  step: 180  loss: -4.0000  grad_norm:  0.4240  memory: 20.03GiB(42.17%)  tps: 2,185  tflops: 17.08  mfu: 5.48%
[rank0]:2025-10-27 05:43:13,763 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 3.0925e+00
[rank0]:2025-10-27 05:43:13,763 - INFO -  step: 180  loss: -4.0000  grad_norm:  0.4240  memory: 20.89GiB(43.97%)  tps: 2,186  tflops: 17.09  mfu: 5.48%
[rank3]:2025-10-27 05:43:15,400 - INFO - Avg. fwd time: 71.9456 / Avg. bwd time: 128.0975 / Avg. batch time: 1651.3982 (ms) / GPU bubble ratio: 3.09%
[rank2]:2025-10-27 05:43:15,446 - INFO - Avg. fwd time: 33.2289 / Avg. bwd time: 51.5072 / Avg. batch time: 1738.5015 (ms) / GPU bubble ratio: 61.01%
[rank1]:2025-10-27 05:43:15,522 - INFO - Avg. fwd time: 51.4453 / Avg. bwd time: 71.2044 / Avg. batch time: 1855.4544 (ms) / GPU bubble ratio: 47.12%
[rank0]:2025-10-27 05:43:15,589 - INFO - Avg. fwd time: 45.9527 / Avg. bwd time: 57.6128 / Avg. batch time: 1951.3170 (ms) / GPU bubble ratio: 57.54%
[rank0]:2025-10-27 05:43:50,693 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 8.8483e-01
[rank2]:2025-10-27 05:43:50,663 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.1382e+00
[rank3]:2025-10-27 05:43:50,675 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 1.9528e+00
[rank1]:2025-10-27 05:43:50,675 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 2.1306e+00
[rank2]:2025-10-27 05:44:28,743 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.0003e+00
[rank3]:2025-10-27 05:44:28,751 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.1487e+00
[rank1]:2025-10-27 05:44:28,739 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.5025e+00
[rank0]:2025-10-27 05:44:28,754 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 1.4698e+00
[rank1]:2025-10-27 05:45:06,059 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 7.7639e-01
[rank0]:2025-10-27 05:45:06,075 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.5439e+00
[rank2]:2025-10-27 05:45:06,047 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.1837e+00
[rank3]:2025-10-27 05:45:06,058 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 3.2238e+00
[rank0]:2025-10-27 05:45:35,997 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-27 05:45:43,570 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 6.0464e-01
[rank3]:2025-10-27 05:45:43,573 - INFO -  step: 200  loss:  0.1372  grad_norm:  0.0986  memory: 38.93GiB(81.95%)  tps: 2,187  tflops: 17.10  mfu: 5.48%
[rank3]:2025-10-27 05:45:43,574 - INFO - ðŸ”Ž  Running validation at step 200
[rank1]:2025-10-27 05:45:43,560 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 3.4578e-01
[rank1]:2025-10-27 05:45:43,560 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.0986  memory: 20.03GiB(42.17%)  tps: 2,187  tflops: 17.10  mfu: 5.48%
[rank1]:2025-10-27 05:45:43,560 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-10-27 05:45:43,574 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 1.8424e+00
[rank0]:2025-10-27 05:45:43,575 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.0986  memory: 20.89GiB(43.97%)  tps: 2,187  tflops: 17.10  mfu: 5.48%
[rank0]:2025-10-27 05:45:43,575 - INFO - ðŸ”Ž  Running validation at step 200
[rank2]:2025-10-27 05:45:43,562 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 3.6852e-01
[rank2]:2025-10-27 05:45:43,563 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.0986  memory: 16.10GiB(33.90%)  tps: 2,187  tflops: 17.10  mfu: 5.48%
[rank2]:2025-10-27 05:45:43,563 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-10-27 05:46:52,344 - INFO - validate step: 200  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,956
[rank1]:2025-10-27 05:46:52,424 - INFO - validate step: 200  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,948
[rank2]:2025-10-27 05:46:52,505 - INFO - validate step: 200  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,941
[rank3]:2025-10-27 05:46:52,586 - INFO - validate step: 200  loss:  0.2962  memory: 38.93GiB(81.95%)  tps: 5,935
[rank0]:2025-10-27 05:46:52,666 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_auto_dm1/freeze_ratio_history/rank0/251027_0546_stage0_step200.svg
[rank1]:2025-10-27 05:46:52,673 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_auto_dm1/freeze_ratio_history/rank1/251027_0546_stage1_step200.svg
[rank2]:2025-10-27 05:46:52,667 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_auto_dm1/freeze_ratio_history/rank2/251027_0546_stage2_step200.svg
[rank3]:2025-10-27 05:46:52,809 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1026_GPipe_auto_dm1/pipeline_schedule/251027_0546_real_step200_rank3.svg
[rank3]:> Batch Time: 1917.94 ms, GPU Bubble Ratio: 56.22%, 47.80%, 64.31%, 15.51%
[rank3]:2025-10-27 05:46:52,886 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_auto_dm1/freeze_ratio_history/rank3/251027_0546_stage3_step200.svg
[rank3]:2025-10-27 05:46:54,432 - INFO - Avg. fwd time: 71.9051 / Avg. bwd time: 127.0981 / Avg. batch time: 1642.7706 (ms) / GPU bubble ratio: 3.09%
[rank2]:2025-10-27 05:46:54,478 - INFO - Avg. fwd time: 33.2050 / Avg. bwd time: 51.1066 / Avg. batch time: 1729.5773 (ms) / GPU bubble ratio: 61.00%
[rank1]:2025-10-27 05:46:54,560 - INFO - Avg. fwd time: 51.4444 / Avg. bwd time: 70.8359 / Avg. batch time: 1846.0628 (ms) / GPU bubble ratio: 47.01%
[rank0]:2025-10-27 05:46:54,629 - INFO - Avg. fwd time: 45.9369 / Avg. bwd time: 57.2687 / Avg. batch time: 1941.5809 (ms) / GPU bubble ratio: 57.48%
[rank1]:2025-10-27 05:47:30,143 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 2.7239e-01
[rank2]:2025-10-27 05:47:30,131 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 4.5885e-01
[rank0]:2025-10-27 05:47:30,159 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 4.3126e-01
[rank3]:2025-10-27 05:47:30,142 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 7.8810e-01
[rank2]:2025-10-27 05:48:08,423 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 6.9168e-01
[rank3]:2025-10-27 05:48:08,431 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.5057e+00
[rank0]:2025-10-27 05:48:08,433 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 1.2878e+00
[rank1]:2025-10-27 05:48:08,419 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 3.5730e-01
[rank2]:2025-10-27 05:48:45,150 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.5491e+00
[rank3]:2025-10-27 05:48:45,162 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 2.0953e+00
[rank0]:2025-10-27 05:48:45,178 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 4.9323e-01
[rank1]:2025-10-27 05:48:45,162 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 3.6411e-01
[rank0]:2025-10-27 05:49:23,078 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 1.8647e+00
[rank0]:2025-10-27 05:49:23,078 - INFO -  step: 220  loss: -4.0000  grad_norm:  0.1261  memory: 20.89GiB(43.97%)  tps: 2,174  tflops: 16.99  mfu: 5.45%
[rank1]:2025-10-27 05:49:23,062 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.2609e+00
[rank1]:2025-10-27 05:49:23,063 - INFO -  step: 220  loss: -4.0000  grad_norm:  0.1261  memory: 20.03GiB(42.17%)  tps: 2,175  tflops: 17.01  mfu: 5.45%
[rank2]:2025-10-27 05:49:23,066 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 9.8545e-01
[rank2]:2025-10-27 05:49:23,067 - INFO -  step: 220  loss: -4.0000  grad_norm:  0.1261  memory: 16.10GiB(33.90%)  tps: 2,176  tflops: 17.01  mfu: 5.45%
[rank3]:2025-10-27 05:49:23,074 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.3425e+00
[rank3]:2025-10-27 05:49:23,077 - INFO -  step: 220  loss:  0.1478  grad_norm:  0.1261  memory: 38.93GiB(81.95%)  tps: 2,177  tflops: 17.02  mfu: 5.46%
[rank2]:2025-10-27 05:49:24,797 - INFO - Avg. fwd time: 33.1980 / Avg. bwd time: 50.7792 / Avg. batch time: 1722.6308 (ms) / GPU bubble ratio: 61.00%
[rank3]:2025-10-27 05:49:24,750 - INFO - Avg. fwd time: 71.8888 / Avg. bwd time: 126.3168 / Avg. batch time: 1636.1960 (ms) / GPU bubble ratio: 3.09%
[rank1]:2025-10-27 05:49:24,879 - INFO - Avg. fwd time: 51.5133 / Avg. bwd time: 70.5572 / Avg. batch time: 1838.8282 (ms) / GPU bubble ratio: 46.89%
[rank0]:2025-10-27 05:49:24,944 - INFO - Avg. fwd time: 45.9500 / Avg. bwd time: 56.9933 / Avg. batch time: 1934.0667 (ms) / GPU bubble ratio: 57.42%
[rank3]:2025-10-27 05:50:00,658 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 5.1126e+00
[rank2]:2025-10-27 05:50:00,646 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.5644e+00
[rank0]:2025-10-27 05:50:00,675 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 9.5560e-01
[rank1]:2025-10-27 05:50:00,659 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 7.1144e-01
[rank0]:2025-10-27 05:50:38,254 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 2.3727e+00
[rank1]:2025-10-27 05:50:38,240 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.0991e+00
[rank3]:2025-10-27 05:50:38,252 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.7027e+00
[rank2]:2025-10-27 05:50:38,244 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 9.3744e-01
[rank1]:2025-10-27 05:51:15,337 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 3.4913e-01
[rank2]:2025-10-27 05:51:15,318 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 6.4242e-01
[rank3]:2025-10-27 05:51:15,329 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 5.5520e-01
[rank0]:2025-10-27 05:51:15,347 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 6.2361e-01
[rank3]:2025-10-27 05:51:53,704 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.4670e+00
[rank3]:2025-10-27 05:51:53,706 - INFO -  step: 240  loss:  0.1623  grad_norm:  0.1850  memory: 38.93GiB(81.95%)  tps: 2,175  tflops: 17.01  mfu: 5.45%
[rank2]:2025-10-27 05:51:53,696 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 5.1763e-01
[rank2]:2025-10-27 05:51:53,696 - INFO -  step: 240  loss: -4.0000  grad_norm:  0.1850  memory: 16.10GiB(33.90%)  tps: 2,175  tflops: 17.01  mfu: 5.45%
[rank1]:2025-10-27 05:51:53,693 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 6.5601e-01
[rank1]:2025-10-27 05:51:53,693 - INFO -  step: 240  loss: -4.0000  grad_norm:  0.1850  memory: 20.03GiB(42.17%)  tps: 2,175  tflops: 17.01  mfu: 5.45%
[rank0]:2025-10-27 05:51:53,703 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 1.7784e+00
[rank0]:2025-10-27 05:51:53,704 - INFO -  step: 240  loss: -4.0000  grad_norm:  0.1850  memory: 20.89GiB(43.97%)  tps: 2,175  tflops: 17.01  mfu: 5.45%
[rank3]:2025-10-27 05:51:55,392 - INFO - Avg. fwd time: 71.9349 / Avg. bwd time: 125.6525 / Avg. batch time: 1631.0093 (ms) / GPU bubble ratio: 3.08%
[rank2]:2025-10-27 05:51:55,438 - INFO - Avg. fwd time: 33.2010 / Avg. bwd time: 50.5170 / Avg. batch time: 1717.1568 (ms) / GPU bubble ratio: 61.00%
[rank1]:2025-10-27 05:51:55,525 - INFO - Avg. fwd time: 51.5116 / Avg. bwd time: 70.3061 / Avg. batch time: 1833.0826 (ms) / GPU bubble ratio: 46.84%
[rank0]:2025-10-27 05:51:55,595 - INFO - Avg. fwd time: 45.9787 / Avg. bwd time: 56.7693 / Avg. batch time: 1928.1207 (ms) / GPU bubble ratio: 57.37%
[rank1]:2025-10-27 05:52:30,807 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 3.4409e+00
[rank0]:2025-10-27 05:52:30,822 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.1525e+00
[rank2]:2025-10-27 05:52:30,794 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.5267e+00
[rank3]:2025-10-27 05:52:30,805 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 9.9942e-01
[rank0]:2025-10-27 05:53:01,099 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-27 05:53:08,717 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 3.5444e+00
[rank0]:2025-10-27 05:53:08,729 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 3.0533e+00
[rank2]:2025-10-27 05:53:08,720 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.7221e+00
[rank3]:2025-10-27 05:53:08,728 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.5797e+00
[rank3]:2025-10-27 05:53:46,351 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 6.5727e-01
[rank2]:2025-10-27 05:53:46,340 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.3651e+00
[rank1]:2025-10-27 05:53:46,352 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.4572e+00
[rank0]:2025-10-27 05:53:46,368 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 9.4981e-01
[rank1]:2025-10-27 05:54:24,455 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.9149e+00
[rank1]:2025-10-27 05:54:24,455 - INFO -  step: 260  loss: -4.0000  grad_norm:  0.3839  memory: 20.03GiB(42.17%)  tps: 2,173  tflops: 16.99  mfu: 5.45%
[rank0]:2025-10-27 05:54:24,470 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 2.7290e+00
[rank0]:2025-10-27 05:54:24,471 - INFO -  step: 260  loss: -4.0000  grad_norm:  0.3839  memory: 20.89GiB(43.97%)  tps: 2,173  tflops: 16.99  mfu: 5.45%
[rank3]:2025-10-27 05:54:24,467 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.1786e+00
[rank3]:2025-10-27 05:54:24,470 - INFO -  step: 260  loss:  0.1369  grad_norm:  0.3839  memory: 38.93GiB(81.95%)  tps: 2,173  tflops: 16.99  mfu: 5.45%
[rank2]:2025-10-27 05:54:24,459 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 8.5077e-01
[rank2]:2025-10-27 05:54:24,460 - INFO -  step: 260  loss: -4.0000  grad_norm:  0.3839  memory: 16.10GiB(33.90%)  tps: 2,173  tflops: 16.99  mfu: 5.45%
[rank3]:2025-10-27 05:54:26,122 - INFO - Avg. fwd time: 71.9678 / Avg. bwd time: 125.1065 / Avg. batch time: 1626.6623 (ms) / GPU bubble ratio: 3.08%
[rank2]:2025-10-27 05:54:26,168 - INFO - Avg. fwd time: 33.2024 / Avg. bwd time: 50.3047 / Avg. batch time: 1712.5485 (ms) / GPU bubble ratio: 60.99%
[rank1]:2025-10-27 05:54:26,250 - INFO - Avg. fwd time: 51.4994 / Avg. bwd time: 70.1422 / Avg. batch time: 1828.3323 (ms) / GPU bubble ratio: 46.77%
[rank0]:2025-10-27 05:54:26,313 - INFO - Avg. fwd time: 45.9975 / Avg. bwd time: 56.5758 / Avg. batch time: 1923.1612 (ms) / GPU bubble ratio: 57.33%
[rank3]:2025-10-27 05:55:01,555 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 1.0138e+00
[rank2]:2025-10-27 05:55:01,543 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 8.6408e-01
[rank1]:2025-10-27 05:55:01,555 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 5.1211e-01
[rank0]:2025-10-27 05:55:01,573 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 2.9580e-01
[rank2]:2025-10-27 05:55:39,913 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 4.9435e-01
[rank1]:2025-10-27 05:55:39,909 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.4878e+00
[rank0]:2025-10-27 05:55:39,921 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 2.6701e+00
[rank3]:2025-10-27 05:55:39,921 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 7.1343e-01
[rank2]:2025-10-27 05:56:17,413 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.1042e+00
[rank3]:2025-10-27 05:56:17,425 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 4.3751e-01
[rank1]:2025-10-27 05:56:17,426 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 4.4327e-01
[rank0]:2025-10-27 05:56:17,442 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 3.4319e-01
[rank1]:2025-10-27 05:56:55,010 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.6635e+00
[rank1]:2025-10-27 05:56:55,010 - INFO -  step: 280  loss: -4.0000  grad_norm:  0.1132  memory: 20.03GiB(42.17%)  tps: 2,176  tflops: 17.01  mfu: 5.45%
[rank0]:2025-10-27 05:56:55,022 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 1.6217e+00
[rank0]:2025-10-27 05:56:55,023 - INFO -  step: 280  loss: -4.0000  grad_norm:  0.1132  memory: 20.89GiB(43.97%)  tps: 2,177  tflops: 17.02  mfu: 5.45%
[rank2]:2025-10-27 05:56:55,014 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 9.6226e-01
[rank2]:2025-10-27 05:56:55,014 - INFO -  step: 280  loss: -4.0000  grad_norm:  0.1132  memory: 16.10GiB(33.90%)  tps: 2,176  tflops: 17.01  mfu: 5.45%
[rank3]:2025-10-27 05:56:55,021 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 6.9429e-01
[rank3]:2025-10-27 05:56:55,026 - INFO -  step: 280  loss:  0.1627  grad_norm:  0.1132  memory: 38.93GiB(81.95%)  tps: 2,176  tflops: 17.01  mfu: 5.45%
[rank3]:2025-10-27 05:56:56,687 - INFO - Avg. fwd time: 71.9553 / Avg. bwd time: 124.6374 / Avg. batch time: 1622.7009 (ms) / GPU bubble ratio: 3.08%
[rank2]:2025-10-27 05:56:56,732 - INFO - Avg. fwd time: 33.1960 / Avg. bwd time: 50.1115 / Avg. batch time: 1708.3625 (ms) / GPU bubble ratio: 60.99%
[rank1]:2025-10-27 05:56:56,812 - INFO - Avg. fwd time: 51.5080 / Avg. bwd time: 70.0045 / Avg. batch time: 1824.0485 (ms) / GPU bubble ratio: 46.71%
[rank0]:2025-10-27 05:56:56,880 - INFO - Avg. fwd time: 45.9971 / Avg. bwd time: 56.4254 / Avg. batch time: 1918.7676 (ms) / GPU bubble ratio: 57.30%
[rank0]:2025-10-27 05:57:32,425 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 3.3581e-01
[rank2]:2025-10-27 05:57:32,402 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 7.7522e-01
[rank3]:2025-10-27 05:57:32,413 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 3.3703e-01
[rank1]:2025-10-27 05:57:32,415 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 2.6300e-01
[rank2]:2025-10-27 05:58:10,703 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 5.1543e-01
[rank3]:2025-10-27 05:58:10,711 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.8872e+00
[rank1]:2025-10-27 05:58:10,700 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.2008e-01
[rank0]:2025-10-27 05:58:10,715 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 1.2340e+00
[rank2]:2025-10-27 05:58:47,538 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 8.6781e-01
[rank3]:2025-10-27 05:58:47,549 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 2.3197e+00
[rank1]:2025-10-27 05:58:47,550 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 4.5728e-01
[rank0]:2025-10-27 05:58:47,570 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 2.7779e-01
[rank0]:2025-10-27 05:59:17,849 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-27 05:59:25,504 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.5654e+00
[rank2]:2025-10-27 05:59:25,504 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.1388  memory: 16.10GiB(33.90%)  tps: 2,177  tflops: 17.02  mfu: 5.46%
[rank2]:2025-10-27 05:59:25,504 - INFO - ðŸ”Ž  Running validation at step 300
[rank3]:2025-10-27 05:59:25,511 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.3261e+00
[rank3]:2025-10-27 05:59:25,515 - INFO -  step: 300  loss:  0.1140  grad_norm:  0.1388  memory: 38.93GiB(81.95%)  tps: 2,177  tflops: 17.02  mfu: 5.46%
[rank1]:2025-10-27 05:59:25,500 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 3.3073e+00
[rank1]:2025-10-27 05:59:25,500 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.1388  memory: 20.03GiB(42.17%)  tps: 2,177  tflops: 17.02  mfu: 5.46%
[rank1]:2025-10-27 05:59:25,501 - INFO - ðŸ”Ž  Running validation at step 300
[rank0]:2025-10-27 05:59:25,516 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 2.8346e+00
[rank0]:2025-10-27 05:59:25,516 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.1388  memory: 20.89GiB(43.97%)  tps: 2,177  tflops: 17.02  mfu: 5.46%
[rank0]:2025-10-27 05:59:25,516 - INFO - ðŸ”Ž  Running validation at step 300
[rank3]:2025-10-27 05:59:25,515 - INFO - ðŸ”Ž  Running validation at step 300
[rank0]:2025-10-27 06:00:34,098 - INFO - validate step: 300  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,972
[rank1]:2025-10-27 06:00:34,178 - INFO - validate step: 300  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,964
[rank2]:2025-10-27 06:00:34,259 - INFO - validate step: 300  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,957
[rank3]:2025-10-27 06:00:34,341 - INFO - validate step: 300  loss:  0.3019  memory: 38.93GiB(81.95%)  tps: 5,951
[rank1]:2025-10-27 06:00:34,425 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_auto_dm1/freeze_ratio_history/rank1/251027_0600_stage1_step300.svg
[rank0]:2025-10-27 06:00:34,417 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_auto_dm1/freeze_ratio_history/rank0/251027_0600_stage0_step300.svg
[rank2]:2025-10-27 06:00:34,417 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_auto_dm1/freeze_ratio_history/rank2/251027_0600_stage2_step300.svg
[rank3]:2025-10-27 06:00:34,550 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1026_GPipe_auto_dm1/pipeline_schedule/251027_0600_real_step300_rank3.svg
[rank3]:> Batch Time: 1871.47 ms, GPU Bubble Ratio: 55.23%, 46.76%, 63.60%, 15.81%
[rank3]:2025-10-27 06:00:34,621 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_auto_dm1/freeze_ratio_history/rank3/251027_0600_stage3_step300.svg
[rank3]:2025-10-27 06:00:36,194 - INFO - Avg. fwd time: 71.9757 / Avg. bwd time: 124.2034 / Avg. batch time: 1619.2872 (ms) / GPU bubble ratio: 3.08%
[rank2]:2025-10-27 06:00:36,239 - INFO - Avg. fwd time: 33.1908 / Avg. bwd time: 49.9371 / Avg. batch time: 1704.8463 (ms) / GPU bubble ratio: 60.99%
[rank1]:2025-10-27 06:00:36,323 - INFO - Avg. fwd time: 51.5254 / Avg. bwd time: 69.8696 / Avg. batch time: 1820.4212 (ms) / GPU bubble ratio: 46.65%
[rank0]:2025-10-27 06:00:36,387 - INFO - Avg. fwd time: 46.0192 / Avg. bwd time: 56.2864 / Avg. batch time: 1914.9888 (ms) / GPU bubble ratio: 57.26%
[rank2]:2025-10-27 06:01:12,240 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 7.3177e+00
[rank1]:2025-10-27 06:01:12,252 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 6.0989e+00
[rank0]:2025-10-27 06:01:12,269 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 4.4414e+00
[rank3]:2025-10-27 06:01:12,251 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 8.2321e+00
[rank3]:2025-10-27 06:01:49,880 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.0036e+00
[rank2]:2025-10-27 06:01:49,873 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.4216e+00
[rank1]:2025-10-27 06:01:49,869 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.6459e+00
[rank0]:2025-10-27 06:01:49,884 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 2.8245e+00
[rank1]:2025-10-27 06:02:26,971 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.7429e+00
[rank0]:2025-10-27 06:02:26,987 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.5254e+00
[rank3]:2025-10-27 06:02:26,971 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 2.1304e+00
[rank2]:2025-10-27 06:02:26,959 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.4755e+00
[rank2]:2025-10-27 06:03:05,278 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 9.8151e-01
[rank2]:2025-10-27 06:03:05,278 - INFO -  step: 320  loss: -4.0000  grad_norm:  0.1868  memory: 16.10GiB(33.90%)  tps: 2,170  tflops: 16.96  mfu: 5.44%
[rank1]:2025-10-27 06:03:05,274 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.6067e+00
[rank1]:2025-10-27 06:03:05,275 - INFO -  step: 320  loss: -4.0000  grad_norm:  0.1868  memory: 20.03GiB(42.17%)  tps: 2,169  tflops: 16.95  mfu: 5.43%
[rank0]:2025-10-27 06:03:05,286 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 1.9453e+00
[rank0]:2025-10-27 06:03:05,286 - INFO -  step: 320  loss: -4.0000  grad_norm:  0.1868  memory: 20.89GiB(43.97%)  tps: 2,167  tflops: 16.94  mfu: 5.43%
[rank3]:2025-10-27 06:03:05,285 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.8567e+00
[rank3]:2025-10-27 06:03:05,289 - INFO -  step: 320  loss:  0.1532  grad_norm:  0.1868  memory: 38.93GiB(81.95%)  tps: 2,171  tflops: 16.97  mfu: 5.44%
[rank3]:2025-10-27 06:03:06,984 - INFO - Avg. fwd time: 72.0017 / Avg. bwd time: 123.8549 / Avg. batch time: 1616.5742 (ms) / GPU bubble ratio: 3.08%
[rank2]:2025-10-27 06:03:07,030 - INFO - Avg. fwd time: 33.1906 / Avg. bwd time: 49.7857 / Avg. batch time: 1701.9681 (ms) / GPU bubble ratio: 61.00%
[rank1]:2025-10-27 06:03:07,116 - INFO - Avg. fwd time: 51.5265 / Avg. bwd time: 69.7350 / Avg. batch time: 1817.4096 (ms) / GPU bubble ratio: 46.62%
[rank0]:2025-10-27 06:03:07,185 - INFO - Avg. fwd time: 46.0256 / Avg. bwd time: 56.1536 / Avg. batch time: 1911.8606 (ms) / GPU bubble ratio: 57.24%
[rank3]:2025-10-27 06:03:42,310 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 4.0481e+00
[rank2]:2025-10-27 06:03:42,299 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 3.2291e+00
[rank0]:2025-10-27 06:03:42,329 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 8.3827e-01
[rank1]:2025-10-27 06:03:42,312 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 2.9593e+00
[rank2]:2025-10-27 06:04:20,093 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.3562e+00
[rank0]:2025-10-27 06:04:20,104 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 2.8152e+00
[rank1]:2025-10-27 06:04:20,092 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 3.9314e+00
[rank3]:2025-10-27 06:04:20,100 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.0919e+00
[rank3]:2025-10-27 06:04:57,727 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 1.7645e+00
[rank2]:2025-10-27 06:04:57,716 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.1851e+00
[rank0]:2025-10-27 06:04:57,744 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 9.6515e-01
[rank1]:2025-10-27 06:04:57,728 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 2.0828e+00
[rank3]:2025-10-27 06:05:35,856 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 3.0615e+00
[rank3]:2025-10-27 06:05:35,859 - INFO -  step: 340  loss:  0.1588  grad_norm:  0.5131  memory: 38.93GiB(81.95%)  tps: 2,176  tflops: 17.01  mfu: 5.45%
[rank2]:2025-10-27 06:05:35,849 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.7288e+00
[rank2]:2025-10-27 06:05:35,849 - INFO -  step: 340  loss: -4.0000  grad_norm:  0.5131  memory: 16.10GiB(33.90%)  tps: 2,176  tflops: 17.01  mfu: 5.45%
[rank0]:2025-10-27 06:05:35,860 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.2528e+00
[rank0]:2025-10-27 06:05:35,860 - INFO -  step: 340  loss: -4.0000  grad_norm:  0.5131  memory: 20.89GiB(43.97%)  tps: 2,176  tflops: 17.01  mfu: 5.45%
[rank1]:2025-10-27 06:05:35,845 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 4.0471e+00
[rank1]:2025-10-27 06:05:35,846 - INFO -  step: 340  loss: -4.0000  grad_norm:  0.5131  memory: 20.03GiB(42.17%)  tps: 2,176  tflops: 17.01  mfu: 5.45%
[rank3]:2025-10-27 06:05:37,509 - INFO - Avg. fwd time: 72.0103 / Avg. bwd time: 123.5383 / Avg. batch time: 1613.9620 (ms) / GPU bubble ratio: 3.07%
[rank2]:2025-10-27 06:05:37,555 - INFO - Avg. fwd time: 33.1805 / Avg. bwd time: 49.6667 / Avg. batch time: 1699.2174 (ms) / GPU bubble ratio: 61.00%
[rank1]:2025-10-27 06:05:37,637 - INFO - Avg. fwd time: 51.4875 / Avg. bwd time: 69.6545 / Avg. batch time: 1814.5316 (ms) / GPU bubble ratio: 46.59%
[rank0]:2025-10-27 06:05:37,704 - INFO - Avg. fwd time: 46.0315 / Avg. bwd time: 56.0456 / Avg. batch time: 1908.8903 (ms) / GPU bubble ratio: 57.22%
[rank1]:2025-10-27 06:06:12,688 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 2.8114e+00
[rank3]:2025-10-27 06:06:12,688 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 4.0080e+00
[rank2]:2025-10-27 06:06:12,676 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 3.2760e+00
[rank0]:2025-10-27 06:06:12,705 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.4364e+00
[rank0]:2025-10-27 06:06:43,197 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-27 06:06:50,873 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 6.1273e-01
[rank2]:2025-10-27 06:06:50,865 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.8617e-01
[rank0]:2025-10-27 06:06:50,876 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 1.6590e+00
[rank1]:2025-10-27 06:06:50,861 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.1664e+00
[rank2]:2025-10-27 06:07:28,328 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 7.3769e-01
[rank0]:2025-10-27 06:07:28,357 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 8.2308e-01
[rank1]:2025-10-27 06:07:28,341 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.1114e+00
[rank3]:2025-10-27 06:07:28,339 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 9.3282e-01
[rank3]:2025-10-27 06:08:06,057 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.5770e-01
[rank3]:2025-10-27 06:08:06,060 - INFO -  step: 360  loss:  0.1155  grad_norm:  0.0935  memory: 38.93GiB(81.95%)  tps: 2,182  tflops: 17.06  mfu: 5.47%
[rank2]:2025-10-27 06:08:06,049 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.2260e-01
[rank2]:2025-10-27 06:08:06,050 - INFO -  step: 360  loss: -4.0000  grad_norm:  0.0935  memory: 16.10GiB(33.90%)  tps: 2,182  tflops: 17.05  mfu: 5.47%
[rank0]:2025-10-27 06:08:06,061 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.9178e-01
[rank0]:2025-10-27 06:08:06,062 - INFO -  step: 360  loss: -4.0000  grad_norm:  0.0935  memory: 20.89GiB(43.97%)  tps: 2,182  tflops: 17.05  mfu: 5.47%
[rank1]:2025-10-27 06:08:06,046 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 9.1345e-01
[rank1]:2025-10-27 06:08:06,046 - INFO -  step: 360  loss: -4.0000  grad_norm:  0.0935  memory: 20.03GiB(42.17%)  tps: 2,182  tflops: 17.05  mfu: 5.47%
[rank3]:2025-10-27 06:08:07,711 - INFO - Avg. fwd time: 72.0049 / Avg. bwd time: 123.2469 / Avg. batch time: 1611.4691 (ms) / GPU bubble ratio: 3.07%
[rank2]:2025-10-27 06:08:07,757 - INFO - Avg. fwd time: 33.1767 / Avg. bwd time: 49.5528 / Avg. batch time: 1696.6025 (ms) / GPU bubble ratio: 60.99%
[rank1]:2025-10-27 06:08:07,841 - INFO - Avg. fwd time: 51.4413 / Avg. bwd time: 69.5557 / Avg. batch time: 1811.7338 (ms) / GPU bubble ratio: 46.57%
[rank0]:2025-10-27 06:08:07,909 - INFO - Avg. fwd time: 46.0501 / Avg. bwd time: 55.9697 / Avg. batch time: 1906.0133 (ms) / GPU bubble ratio: 57.18%
[rank2]:2025-10-27 06:08:43,221 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 3.4881e-01
[rank0]:2025-10-27 06:08:43,249 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 5.9176e-01
[rank1]:2025-10-27 06:08:43,238 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.1802e+00
[rank3]:2025-10-27 06:08:43,233 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 7.6672e-01
[rank1]:2025-10-27 06:09:21,613 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 9.6333e-01
[rank3]:2025-10-27 06:09:21,624 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.4529e+00
[rank2]:2025-10-27 06:09:21,617 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 4.3207e-01
[rank0]:2025-10-27 06:09:21,627 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 9.1019e-01
[rank3]:2025-10-27 06:09:58,308 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 1.6764e+00
[rank2]:2025-10-27 06:09:58,296 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.0711e+00
[rank0]:2025-10-27 06:09:58,325 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 3.6515e-01
[rank1]:2025-10-27 06:09:58,309 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.6224e+00
[rank3]:2025-10-27 06:10:36,080 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 7.2310e-01
[rank2]:2025-10-27 06:10:36,073 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 5.4258e-01
[rank2]:2025-10-27 06:10:36,073 - INFO -  step: 380  loss: -4.0000  grad_norm:  0.1450  memory: 16.10GiB(33.90%)  tps: 2,184  tflops: 17.08  mfu: 5.47%
[rank0]:2025-10-27 06:10:36,087 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 9.1267e-01
[rank0]:2025-10-27 06:10:36,088 - INFO -  step: 380  loss: -4.0000  grad_norm:  0.1450  memory: 20.89GiB(43.97%)  tps: 2,184  tflops: 17.07  mfu: 5.47%
[rank1]:2025-10-27 06:10:36,069 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.6480e+00
[rank1]:2025-10-27 06:10:36,069 - INFO -  step: 380  loss: -4.0000  grad_norm:  0.1450  memory: 20.03GiB(42.17%)  tps: 2,184  tflops: 17.08  mfu: 5.47%
[rank3]:2025-10-27 06:10:36,083 - INFO -  step: 380  loss:  0.1174  grad_norm:  0.1450  memory: 38.93GiB(81.95%)  tps: 2,184  tflops: 17.08  mfu: 5.47%
[rank3]:2025-10-27 06:10:37,718 - INFO - Avg. fwd time: 71.9824 / Avg. bwd time: 122.9814 / Avg. batch time: 1609.1089 (ms) / GPU bubble ratio: 3.07%
[rank2]:2025-10-27 06:10:37,765 - INFO - Avg. fwd time: 33.1733 / Avg. bwd time: 49.4461 / Avg. batch time: 1694.1193 (ms) / GPU bubble ratio: 60.99%
[rank1]:2025-10-27 06:10:37,836 - INFO - Avg. fwd time: 51.4456 / Avg. bwd time: 69.4535 / Avg. batch time: 1809.1136 (ms) / GPU bubble ratio: 46.54%
[rank0]:2025-10-27 06:10:37,914 - INFO - Avg. fwd time: 46.0653 / Avg. bwd time: 55.8767 / Avg. batch time: 1903.3053 (ms) / GPU bubble ratio: 57.15%
[rank3]:2025-10-27 06:11:13,425 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 4.5735e+00
[rank2]:2025-10-27 06:11:13,413 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.9551e+00
[rank0]:2025-10-27 06:11:13,441 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 3.3898e+00
[rank1]:2025-10-27 06:11:13,425 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.3059e+00
[rank1]:2025-10-27 06:11:50,906 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.3017e+00
[rank3]:2025-10-27 06:11:50,916 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.1955e+00
[rank2]:2025-10-27 06:11:50,909 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 6.5652e-01
[rank0]:2025-10-27 06:11:50,921 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 3.9881e+00
[rank3]:2025-10-27 06:12:27,924 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 6.4693e-01
[rank2]:2025-10-27 06:12:27,912 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 8.8298e-01
[rank0]:2025-10-27 06:12:27,939 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 3.0295e-01
[rank1]:2025-10-27 06:12:27,924 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 8.1324e-01
[rank0]:2025-10-27 06:12:58,397 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-27 06:13:05,997 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.6653e-01
[rank2]:2025-10-27 06:13:05,998 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.1589  memory: 16.10GiB(33.90%)  tps: 2,186  tflops: 17.09  mfu: 5.48%
[rank2]:2025-10-27 06:13:05,998 - INFO - ðŸ”Ž  Running validation at step 400
[rank1]:2025-10-27 06:13:05,994 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 8.3316e-01
[rank1]:2025-10-27 06:13:05,994 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.1589  memory: 20.03GiB(42.17%)  tps: 2,186  tflops: 17.09  mfu: 5.48%
[rank1]:2025-10-27 06:13:05,994 - INFO - ðŸ”Ž  Running validation at step 400
[rank3]:2025-10-27 06:13:06,005 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 6.4666e-01
[rank3]:2025-10-27 06:13:06,008 - INFO -  step: 400  loss:  0.1098  grad_norm:  0.1589  memory: 38.93GiB(81.95%)  tps: 2,186  tflops: 17.09  mfu: 5.48%
[rank3]:2025-10-27 06:13:06,009 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-10-27 06:13:06,011 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 2.3744e+00
[rank0]:2025-10-27 06:13:06,011 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.1589  memory: 20.89GiB(43.97%)  tps: 2,186  tflops: 17.09  mfu: 5.48%
[rank0]:2025-10-27 06:13:06,011 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-10-27 06:14:14,998 - INFO - validate step: 400  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,937
[rank1]:2025-10-27 06:14:15,077 - INFO - validate step: 400  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,929
[rank2]:2025-10-27 06:14:15,160 - INFO - validate step: 400  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,922
[rank3]:2025-10-27 06:14:15,244 - INFO - validate step: 400  loss:  0.3009  memory: 38.93GiB(81.95%)  tps: 5,916
[rank1]:2025-10-27 06:14:15,331 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_auto_dm1/freeze_ratio_history/rank1/251027_0614_stage1_step400.svg
[rank0]:2025-10-27 06:14:15,324 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_auto_dm1/freeze_ratio_history/rank0/251027_0614_stage0_step400.svg
[rank2]:2025-10-27 06:14:15,325 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_auto_dm1/freeze_ratio_history/rank2/251027_0614_stage2_step400.svg
[rank3]:2025-10-27 06:14:15,452 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1026_GPipe_auto_dm1/pipeline_schedule/251027_0614_real_step400_rank3.svg
[rank3]:> Batch Time: 1855.97 ms, GPU Bubble Ratio: 54.91%, 46.63%, 63.40%, 15.85%
[rank3]:2025-10-27 06:14:15,527 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_auto_dm1/freeze_ratio_history/rank3/251027_0614_stage3_step400.svg
[rank3]:2025-10-27 06:14:17,132 - INFO - Avg. fwd time: 71.9841 / Avg. bwd time: 122.7297 / Avg. batch time: 1607.0293 (ms) / GPU bubble ratio: 3.07%
[rank2]:2025-10-27 06:14:17,179 - INFO - Avg. fwd time: 33.1675 / Avg. bwd time: 49.3493 / Avg. batch time: 1691.9943 (ms) / GPU bubble ratio: 60.98%
[rank1]:2025-10-27 06:14:17,265 - INFO - Avg. fwd time: 51.4420 / Avg. bwd time: 69.3463 / Avg. batch time: 1806.8588 (ms) / GPU bubble ratio: 46.52%
[rank0]:2025-10-27 06:14:17,330 - INFO - Avg. fwd time: 46.0688 / Avg. bwd time: 55.7840 / Avg. batch time: 1900.9489 (ms) / GPU bubble ratio: 57.14%
[rank3]:2025-10-27 06:14:52,708 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 2.1276e+00
[rank2]:2025-10-27 06:14:52,696 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.2703e+00
[rank1]:2025-10-27 06:14:52,708 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 7.7342e-01
[rank0]:2025-10-27 06:14:52,726 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.1310e+00
[rank2]:2025-10-27 06:15:30,585 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 9.9987e-01
[rank1]:2025-10-27 06:15:30,582 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.6386e+00
[rank0]:2025-10-27 06:15:30,597 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 3.4703e+00
[rank3]:2025-10-27 06:15:30,593 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.4285e+00
[rank2]:2025-10-27 06:16:08,119 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.1637e+00
[rank1]:2025-10-27 06:16:08,132 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 8.4430e-01
[rank0]:2025-10-27 06:16:08,147 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 7.2114e-01
[rank3]:2025-10-27 06:16:08,131 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 1.4455e+00
[rank2]:2025-10-27 06:16:46,191 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.1757e+00
[rank2]:2025-10-27 06:16:46,192 - INFO -  step: 420  loss: -4.0000  grad_norm:  0.4672  memory: 16.10GiB(33.90%)  tps: 2,170  tflops: 16.96  mfu: 5.44%
[rank1]:2025-10-27 06:16:46,188 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.9964e+00
[rank1]:2025-10-27 06:16:46,189 - INFO -  step: 420  loss: -4.0000  grad_norm:  0.4672  memory: 20.03GiB(42.17%)  tps: 2,168  tflops: 16.95  mfu: 5.43%
[rank0]:2025-10-27 06:16:46,198 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 4.5212e+00
[rank0]:2025-10-27 06:16:46,199 - INFO -  step: 420  loss: -4.0000  grad_norm:  0.4672  memory: 20.89GiB(43.97%)  tps: 2,167  tflops: 16.94  mfu: 5.43%
[rank3]:2025-10-27 06:16:46,199 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 4.9227e+00
[rank3]:2025-10-27 06:16:46,202 - INFO -  step: 420  loss:  0.1373  grad_norm:  0.4672  memory: 38.93GiB(81.95%)  tps: 2,171  tflops: 16.97  mfu: 5.44%
[rank3]:2025-10-27 06:16:47,843 - INFO - Avg. fwd time: 71.9906 / Avg. bwd time: 122.5404 / Avg. batch time: 1605.4959 (ms) / GPU bubble ratio: 3.07%
[rank2]:2025-10-27 06:16:47,889 - INFO - Avg. fwd time: 33.1652 / Avg. bwd time: 49.2851 / Avg. batch time: 1690.3797 (ms) / GPU bubble ratio: 60.98%
[rank1]:2025-10-27 06:16:47,970 - INFO - Avg. fwd time: 51.4654 / Avg. bwd time: 69.2885 / Avg. batch time: 1805.1491 (ms) / GPU bubble ratio: 46.48%
[rank0]:2025-10-27 06:16:48,034 - INFO - Avg. fwd time: 46.0778 / Avg. bwd time: 55.7020 / Avg. batch time: 1899.1682 (ms) / GPU bubble ratio: 57.13%
[rank1]:2025-10-27 06:17:23,089 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 3.4160e+00
[rank3]:2025-10-27 06:17:23,087 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 3.6405e+00
[rank2]:2025-10-27 06:17:23,076 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 3.3830e+00
[rank0]:2025-10-27 06:17:23,104 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.8770e+00
[rank1]:2025-10-27 06:18:01,113 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 7.4617e+00
[rank0]:2025-10-27 06:18:01,129 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 6.4742e+00
[rank3]:2025-10-27 06:18:01,125 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.3900e+00
[rank2]:2025-10-27 06:18:01,117 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.8309e+00
[rank1]:2025-10-27 06:18:38,677 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 2.6215e+00
[rank3]:2025-10-27 06:18:38,677 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 3.3714e+00
[rank2]:2025-10-27 06:18:38,665 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.8851e+00
[rank0]:2025-10-27 06:18:38,694 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 9.1653e-01
[rank2]:2025-10-27 06:19:16,385 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.3797e+00
[rank2]:2025-10-27 06:19:16,386 - INFO -  step: 440  loss: -4.0000  grad_norm:  0.1101  memory: 16.10GiB(33.90%)  tps: 2,182  tflops: 17.06  mfu: 5.47%
[rank0]:2025-10-27 06:19:16,398 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 1.5924e+00
[rank0]:2025-10-27 06:19:16,398 - INFO -  step: 440  loss: -4.0000  grad_norm:  0.1101  memory: 20.89GiB(43.97%)  tps: 2,182  tflops: 17.06  mfu: 5.47%
[rank1]:2025-10-27 06:19:16,381 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 3.1523e+00
[rank1]:2025-10-27 06:19:16,382 - INFO -  step: 440  loss: -4.0000  grad_norm:  0.1101  memory: 20.03GiB(42.17%)  tps: 2,182  tflops: 17.06  mfu: 5.47%
[rank3]:2025-10-27 06:19:16,393 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.4894e+00
[rank3]:2025-10-27 06:19:16,396 - INFO -  step: 440  loss:  0.1333  grad_norm:  0.1101  memory: 38.93GiB(81.95%)  tps: 2,182  tflops: 17.06  mfu: 5.47%
[rank3]:2025-10-27 06:19:18,053 - INFO - Avg. fwd time: 71.9806 / Avg. bwd time: 122.3481 / Avg. batch time: 1603.8069 (ms) / GPU bubble ratio: 3.07%
[rank2]:2025-10-27 06:19:18,099 - INFO - Avg. fwd time: 33.1590 / Avg. bwd time: 49.2140 / Avg. batch time: 1688.5937 (ms) / GPU bubble ratio: 60.97%
[rank1]:2025-10-27 06:19:18,189 - INFO - Avg. fwd time: 51.4587 / Avg. bwd time: 69.2194 / Avg. batch time: 1803.3052 (ms) / GPU bubble ratio: 46.46%
[rank0]:2025-10-27 06:19:18,252 - INFO - Avg. fwd time: 46.0839 / Avg. bwd time: 55.6511 / Avg. batch time: 1897.2672 (ms) / GPU bubble ratio: 57.10%
[rank2]:2025-10-27 06:19:53,612 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.0026e+00
[rank0]:2025-10-27 06:19:53,640 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.1440e+00
[rank1]:2025-10-27 06:19:53,624 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.6410e+00
[rank3]:2025-10-27 06:19:53,624 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 1.8496e+00
[rank0]:2025-10-27 06:20:24,388 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-27 06:20:31,921 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.4893e-01
[rank3]:2025-10-27 06:20:31,933 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.3422e+00
[rank2]:2025-10-27 06:20:31,925 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.7317e-01
[rank0]:2025-10-27 06:20:31,933 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 6.2802e-01
[rank2]:2025-10-27 06:21:08,706 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.5397e+00
[rank0]:2025-10-27 06:21:08,735 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.5479e+00
[rank1]:2025-10-27 06:21:08,718 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 2.8566e+00
[rank3]:2025-10-27 06:21:08,718 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 1.7600e+00
[rank1]:2025-10-27 06:21:46,519 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 3.1908e+00
[rank1]:2025-10-27 06:21:46,520 - INFO -  step: 460  loss: -4.0000  grad_norm:  0.1357  memory: 20.03GiB(42.17%)  tps: 2,183  tflops: 17.06  mfu: 5.47%
[rank3]:2025-10-27 06:21:46,531 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.0742e+00
[rank3]:2025-10-27 06:21:46,534 - INFO -  step: 460  loss:  0.1065  grad_norm:  0.1357  memory: 38.93GiB(81.95%)  tps: 2,183  tflops: 17.06  mfu: 5.47%
[rank2]:2025-10-27 06:21:46,528 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.4586e+00
[rank2]:2025-10-27 06:21:46,528 - INFO -  step: 460  loss: -4.0000  grad_norm:  0.1357  memory: 16.10GiB(33.90%)  tps: 2,182  tflops: 17.06  mfu: 5.47%
[rank0]:2025-10-27 06:21:46,531 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 3.0272e+00
[rank0]:2025-10-27 06:21:46,532 - INFO -  step: 460  loss: -4.0000  grad_norm:  0.1357  memory: 20.89GiB(43.97%)  tps: 2,183  tflops: 17.06  mfu: 5.47%
[rank3]:2025-10-27 06:21:48,201 - INFO - Avg. fwd time: 71.9716 / Avg. bwd time: 122.1687 / Avg. batch time: 1602.2742 (ms) / GPU bubble ratio: 3.07%
[rank2]:2025-10-27 06:21:48,247 - INFO - Avg. fwd time: 33.1574 / Avg. bwd time: 49.1437 / Avg. batch time: 1686.9738 (ms) / GPU bubble ratio: 60.97%
[rank0]:2025-10-27 06:21:48,400 - INFO - Avg. fwd time: 46.0827 / Avg. bwd time: 55.5783 / Avg. batch time: 1895.4999 (ms) / GPU bubble ratio: 57.09%
[rank1]:2025-10-27 06:21:48,330 - INFO - Avg. fwd time: 51.4942 / Avg. bwd time: 69.1513 / Avg. batch time: 1801.6163 (ms) / GPU bubble ratio: 46.43%
[rank3]:2025-10-27 06:22:24,202 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 7.7087e+00
[rank2]:2025-10-27 06:22:24,191 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 8.0555e+00
[rank1]:2025-10-27 06:22:24,204 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 8.2166e+00
[rank0]:2025-10-27 06:22:24,219 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 4.0727e+00
[rank2]:2025-10-27 06:23:01,687 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 5.9474e+01
[rank1]:2025-10-27 06:23:01,684 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.4825e+02
[rank0]:2025-10-27 06:23:01,695 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.3805e+02
[rank3]:2025-10-27 06:23:01,695 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.9372e+01
[rank3]:2025-10-27 06:23:37,783 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 2.7249e+00
[rank2]:2025-10-27 06:23:37,771 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 3.1574e+00
[rank1]:2025-10-27 06:23:37,775 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 4.2732e+00
[rank0]:2025-10-27 06:23:37,787 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 3.5859e+00
[rank1]:2025-10-27 06:24:16,003 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 2.0249e+00
[rank1]:2025-10-27 06:24:16,003 - INFO -  step: 480  loss: -4.0000  grad_norm:  0.2024  memory: 20.03GiB(42.17%)  tps: 2,192  tflops: 17.14  mfu: 5.49%
[rank3]:2025-10-27 06:24:16,014 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 4.8160e-01
[rank3]:2025-10-27 06:24:16,017 - INFO -  step: 480  loss:  0.1203  grad_norm:  0.2024  memory: 38.93GiB(81.95%)  tps: 2,192  tflops: 17.14  mfu: 5.49%
[rank2]:2025-10-27 06:24:16,006 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 4.6522e-01
[rank2]:2025-10-27 06:24:16,007 - INFO -  step: 480  loss: -4.0000  grad_norm:  0.2024  memory: 16.10GiB(33.90%)  tps: 2,192  tflops: 17.14  mfu: 5.49%
[rank0]:2025-10-27 06:24:16,014 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 7.4179e-01
[rank0]:2025-10-27 06:24:16,014 - INFO -  step: 480  loss: -4.0000  grad_norm:  0.2024  memory: 20.89GiB(43.97%)  tps: 2,192  tflops: 17.14  mfu: 5.49%
[rank3]:2025-10-27 06:24:17,699 - INFO - Avg. fwd time: 71.9788 / Avg. bwd time: 122.0056 / Avg. batch time: 1600.9987 (ms) / GPU bubble ratio: 3.07%
[rank2]:2025-10-27 06:24:17,746 - INFO - Avg. fwd time: 33.1609 / Avg. bwd time: 49.0699 / Avg. batch time: 1685.6033 (ms) / GPU bubble ratio: 60.97%
[rank1]:2025-10-27 06:24:17,805 - INFO - Avg. fwd time: 51.4974 / Avg. bwd time: 68.8809 / Avg. batch time: 1800.0020 (ms) / GPU bubble ratio: 46.50%
[rank0]:2025-10-27 06:24:17,852 - INFO - Avg. fwd time: 46.0709 / Avg. bwd time: 55.2820 / Avg. batch time: 1893.5644 (ms) / GPU bubble ratio: 57.18%
[rank2]:2025-10-27 06:24:51,933 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 8.7525e-01
[rank1]:2025-10-27 06:24:51,934 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 5.9457e-01
[rank0]:2025-10-27 06:24:51,949 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 9.7641e-01
[rank3]:2025-10-27 06:24:51,945 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 9.6387e-01
[rank3]:2025-10-27 06:25:29,624 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.1843e-01
[rank2]:2025-10-27 06:25:29,616 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 4.0055e-01
[rank1]:2025-10-27 06:25:29,612 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 4.8497e-01
[rank0]:2025-10-27 06:25:29,624 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 5.7300e-01
[rank3]:2025-10-27 06:26:05,870 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 8.6603e-01
[rank2]:2025-10-27 06:26:05,858 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.3239e+00
[rank0]:2025-10-27 06:26:05,870 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 3.2487e+00
[rank1]:2025-10-27 06:26:05,858 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 2.2832e+00
[rank0]:2025-10-27 06:26:36,284 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-27 06:26:43,800 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 4.7625e-01
[rank0]:2025-10-27 06:26:43,801 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.2265  memory: 20.89GiB(43.97%)  tps: 2,217  tflops: 17.33  mfu: 5.56%
[rank0]:2025-10-27 06:26:43,801 - INFO - ðŸ”Ž  Running validation at step 500
[rank1]:2025-10-27 06:26:43,789 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 4.5297e-01
[rank1]:2025-10-27 06:26:43,789 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.2265  memory: 20.03GiB(42.17%)  tps: 2,217  tflops: 17.33  mfu: 5.56%
[rank1]:2025-10-27 06:26:43,789 - INFO - ðŸ”Ž  Running validation at step 500
[rank3]:2025-10-27 06:26:43,800 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 5.6326e-01
[rank3]:2025-10-27 06:26:43,803 - INFO -  step: 500  loss:  0.1000  grad_norm:  0.2265  memory: 38.93GiB(81.95%)  tps: 2,217  tflops: 17.33  mfu: 5.56%
[rank3]:2025-10-27 06:26:43,804 - INFO - ðŸ”Ž  Running validation at step 500
[rank2]:2025-10-27 06:26:43,793 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 6.3724e-01
[rank2]:2025-10-27 06:26:43,793 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.2265  memory: 16.10GiB(33.90%)  tps: 2,217  tflops: 17.33  mfu: 5.56%
[rank2]:2025-10-27 06:26:43,793 - INFO - ðŸ”Ž  Running validation at step 500
[rank0]:2025-10-27 06:27:52,654 - INFO - validate step: 500  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,949
[rank0]:2025-10-27 06:27:52,655 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-27 06:27:52,660 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank1]:2025-10-27 06:27:52,737 - INFO - validate step: 500  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,941
[rank1]:2025-10-27 06:27:52,738 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-27 06:27:52,817 - INFO - validate step: 500  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,934
[rank2]:2025-10-27 06:27:52,818 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-27 06:27:52,899 - INFO - validate step: 500  loss:  0.2975  memory: 38.93GiB(81.95%)  tps: 5,928
[rank3]:2025-10-27 06:27:52,900 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-27 06:27:55,025 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 2.21 seconds.
[rank1]:2025-10-27 06:27:55,116 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 2.38 seconds.
[rank0]:2025-10-27 06:27:56,438 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-27 06:27:56,448 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.79 seconds.
[rank3]:2025-10-27 06:27:57,385 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 4.49 seconds.
[rank2]:2025-10-27 06:27:57,472 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_auto_dm1/freeze_ratio_history/rank2/251027_0627_stage2_step500.svg
[rank1]:2025-10-27 06:27:57,476 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_auto_dm1/freeze_ratio_history/rank1/251027_0627_stage1_step500.svg
[rank0]:2025-10-27 06:27:57,476 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_auto_dm1/freeze_ratio_history/rank0/251027_0627_stage0_step500.svg
[rank3]:2025-10-27 06:27:57,763 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1026_GPipe_auto_dm1/pipeline_schedule/251027_0627_real_step500_rank3.svg
[rank3]:> Batch Time: 1848.75 ms, GPU Bubble Ratio: 54.95%, 47.00%, 63.32%, 15.81%
[rank3]:2025-10-27 06:27:57,870 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_auto_dm1/freeze_ratio_history/rank3/251027_0627_stage3_step500.svg
[rank3]:2025-10-27 06:27:59,400 - INFO - Avg. fwd time: 71.9658 / Avg. bwd time: 121.8541 / Avg. batch time: 1599.6412 (ms) / GPU bubble ratio: 3.07%
[rank2]:2025-10-27 06:27:59,446 - INFO - Avg. fwd time: 33.1533 / Avg. bwd time: 49.0110 / Avg. batch time: 1684.3139 (ms) / GPU bubble ratio: 60.97%
[rank1]:2025-10-27 06:27:59,501 - INFO - Avg. fwd time: 51.4877 / Avg. bwd time: 68.2851 / Avg. batch time: 1798.0773 (ms) / GPU bubble ratio: 46.71%
[rank0]:2025-10-27 06:27:59,547 - INFO - Avg. fwd time: 46.0533 / Avg. bwd time: 54.8113 / Avg. batch time: 1891.1397 (ms) / GPU bubble ratio: 57.33%
[rank2]:2025-10-27 06:28:33,502 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 4.0664e+00
[rank1]:2025-10-27 06:28:33,502 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 4.0197e+00
[rank0]:2025-10-27 06:28:33,517 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 4.2144e+00
[rank3]:2025-10-27 06:28:33,513 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 3.3650e+00
[rank1]:2025-10-27 06:29:11,502 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.8442e+00
[rank3]:2025-10-27 06:29:11,513 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 6.1011e-01
[rank2]:2025-10-27 06:29:11,505 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 8.3636e-01
[rank0]:2025-10-27 06:29:11,517 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.6710e-01
[rank3]:2025-10-27 06:29:47,692 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 1.1610e+00
[rank2]:2025-10-27 06:29:47,680 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 9.3932e-01
[rank0]:2025-10-27 06:29:47,695 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 9.9147e-01
[rank1]:2025-10-27 06:29:47,680 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.3957e+00
[rank1]:2025-10-27 06:30:25,201 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.9013e+00
[rank1]:2025-10-27 06:30:25,201 - INFO -  step: 520  loss: -4.0000  grad_norm:  0.0808  memory: 20.03GiB(42.17%)  tps: 2,149  tflops: 16.80  mfu: 5.39%
[rank3]:2025-10-27 06:30:25,212 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.0636e+00
[rank3]:2025-10-27 06:30:25,216 - INFO -  step: 520  loss:  0.1352  grad_norm:  0.0808  memory: 38.93GiB(81.95%)  tps: 2,151  tflops: 16.82  mfu: 5.39%
[rank2]:2025-10-27 06:30:25,205 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 8.3129e-01
[rank2]:2025-10-27 06:30:25,205 - INFO -  step: 520  loss: -4.0000  grad_norm:  0.0808  memory: 16.10GiB(33.90%)  tps: 2,150  tflops: 16.81  mfu: 5.39%
[rank0]:2025-10-27 06:30:25,213 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 7.1086e-01
[rank0]:2025-10-27 06:30:25,213 - INFO -  step: 520  loss: -4.0000  grad_norm:  0.0808  memory: 20.89GiB(43.97%)  tps: 2,148  tflops: 16.79  mfu: 5.38%
[rank3]:2025-10-27 06:30:26,848 - INFO - Avg. fwd time: 71.9419 / Avg. bwd time: 121.7037 / Avg. batch time: 1598.2247 (ms) / GPU bubble ratio: 3.07%
[rank2]:2025-10-27 06:30:26,894 - INFO - Avg. fwd time: 33.1493 / Avg. bwd time: 48.9597 / Avg. batch time: 1682.8213 (ms) / GPU bubble ratio: 60.97%
[rank1]:2025-10-27 06:30:26,949 - INFO - Avg. fwd time: 51.4711 / Avg. bwd time: 67.7398 / Avg. batch time: 1796.0176 (ms) / GPU bubble ratio: 46.90%
[rank0]:2025-10-27 06:30:26,995 - INFO - Avg. fwd time: 46.0286 / Avg. bwd time: 54.3764 / Avg. batch time: 1888.6045 (ms) / GPU bubble ratio: 57.47%
[rank3]:2025-10-27 06:31:01,277 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 2.4694e+00
[rank2]:2025-10-27 06:31:01,266 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 8.3963e-01
[rank1]:2025-10-27 06:31:01,266 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 5.8234e-01
[rank0]:2025-10-27 06:31:01,278 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 9.1161e-01
[rank2]:2025-10-27 06:31:39,449 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.4540e+00
[rank1]:2025-10-27 06:31:39,445 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 2.3963e+00
[rank0]:2025-10-27 06:31:39,460 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.4063e+00
[rank3]:2025-10-27 06:31:39,457 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.2063e+00
[rank2]:2025-10-27 06:32:15,194 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.1287e+00
[rank1]:2025-10-27 06:32:15,194 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.7118e+00
[rank0]:2025-10-27 06:32:15,210 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 2.9254e+00
[rank3]:2025-10-27 06:32:15,205 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 2.5359e+00
[rank3]:2025-10-27 06:32:53,119 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 7.0821e-01
[rank3]:2025-10-27 06:32:53,123 - INFO -  step: 540  loss:  0.1351  grad_norm:  0.1298  memory: 38.93GiB(81.95%)  tps: 2,215  tflops: 17.32  mfu: 5.55%
[rank2]:2025-10-27 06:32:53,112 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 5.1521e-01
[rank2]:2025-10-27 06:32:53,112 - INFO -  step: 540  loss: -4.0000  grad_norm:  0.1298  memory: 16.10GiB(33.90%)  tps: 2,215  tflops: 17.32  mfu: 5.55%
[rank1]:2025-10-27 06:32:53,108 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.1278e+00
[rank1]:2025-10-27 06:32:53,108 - INFO -  step: 540  loss: -4.0000  grad_norm:  0.1298  memory: 20.03GiB(42.17%)  tps: 2,215  tflops: 17.32  mfu: 5.55%
[rank0]:2025-10-27 06:32:53,123 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.4471e+00
[rank0]:2025-10-27 06:32:53,124 - INFO -  step: 540  loss: -4.0000  grad_norm:  0.1298  memory: 20.89GiB(43.97%)  tps: 2,215  tflops: 17.32  mfu: 5.55%
[rank3]:2025-10-27 06:32:54,801 - INFO - Avg. fwd time: 71.9476 / Avg. bwd time: 121.5711 / Avg. batch time: 1597.1632 (ms) / GPU bubble ratio: 3.07%
[rank2]:2025-10-27 06:32:54,851 - INFO - Avg. fwd time: 33.1479 / Avg. bwd time: 48.9086 / Avg. batch time: 1681.6850 (ms) / GPU bubble ratio: 60.96%
[rank1]:2025-10-27 06:32:54,907 - INFO - Avg. fwd time: 51.4634 / Avg. bwd time: 67.2262 / Avg. batch time: 1794.3493 (ms) / GPU bubble ratio: 47.08%
[rank0]:2025-10-27 06:32:54,952 - INFO - Avg. fwd time: 46.0203 / Avg. bwd time: 53.9738 / Avg. batch time: 1886.5010 (ms) / GPU bubble ratio: 57.60%
[rank2]:2025-10-27 06:33:29,599 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.3128e+00
[rank1]:2025-10-27 06:33:29,601 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 5.6094e-01
[rank0]:2025-10-27 06:33:29,610 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 8.4779e-01
[rank3]:2025-10-27 06:33:29,610 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 2.0905e+00
[rank0]:2025-10-27 06:34:00,060 - INFO - [GC] Peforming periodical GC collection 0.30 seconds
[rank1]:2025-10-27 06:34:07,595 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.2342e+00
[rank3]:2025-10-27 06:34:07,606 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.0585e+00
[rank2]:2025-10-27 06:34:07,603 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 9.1594e-01
[rank0]:2025-10-27 06:34:07,606 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.4539e+00
[rank3]:2025-10-27 06:34:43,780 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 3.6682e-01
[rank2]:2025-10-27 06:34:43,761 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 6.0890e-01
[rank1]:2025-10-27 06:34:43,762 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 2.9586e-01
[rank0]:2025-10-27 06:34:43,773 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 2.5813e-01
[rank3]:2025-10-27 06:35:22,214 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.3532e+00
[rank3]:2025-10-27 06:35:22,217 - INFO -  step: 560  loss:  0.1364  grad_norm:  0.1639  memory: 38.93GiB(81.95%)  tps: 2,198  tflops: 17.18  mfu: 5.51%
[rank2]:2025-10-27 06:35:22,206 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 7.6199e-01
[rank2]:2025-10-27 06:35:22,206 - INFO -  step: 560  loss: -4.0000  grad_norm:  0.1639  memory: 16.10GiB(33.90%)  tps: 2,198  tflops: 17.18  mfu: 5.51%
[rank1]:2025-10-27 06:35:22,203 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.2770e+00
[rank1]:2025-10-27 06:35:22,204 - INFO -  step: 560  loss: -4.0000  grad_norm:  0.1639  memory: 20.03GiB(42.17%)  tps: 2,198  tflops: 17.18  mfu: 5.51%
[rank0]:2025-10-27 06:35:22,214 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 7.4212e-01
[rank0]:2025-10-27 06:35:22,214 - INFO -  step: 560  loss: -4.0000  grad_norm:  0.1639  memory: 20.89GiB(43.97%)  tps: 2,198  tflops: 17.18  mfu: 5.51%
[rank3]:2025-10-27 06:35:23,927 - INFO - Avg. fwd time: 71.9688 / Avg. bwd time: 121.4782 / Avg. batch time: 1596.5453 (ms) / GPU bubble ratio: 3.07%
[rank2]:2025-10-27 06:35:23,974 - INFO - Avg. fwd time: 33.1544 / Avg. bwd time: 48.8665 / Avg. batch time: 1681.0130 (ms) / GPU bubble ratio: 60.97%
[rank1]:2025-10-27 06:35:24,028 - INFO - Avg. fwd time: 51.4754 / Avg. bwd time: 66.7588 / Avg. batch time: 1793.1839 (ms) / GPU bubble ratio: 47.25%
[rank0]:2025-10-27 06:35:24,074 - INFO - Avg. fwd time: 46.0171 / Avg. bwd time: 53.6029 / Avg. batch time: 1884.9392 (ms) / GPU bubble ratio: 57.72%
[rank3]:2025-10-27 06:35:58,476 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 1.4460e+00
[rank2]:2025-10-27 06:35:58,465 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.3973e+00
[rank1]:2025-10-27 06:35:58,465 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.7302e+00
[rank0]:2025-10-27 06:35:58,481 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 2.9306e+00
[rank1]:2025-10-27 06:36:36,395 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 9.1348e-01
[rank3]:2025-10-27 06:36:36,407 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 8.4543e-01
[rank2]:2025-10-27 06:36:36,399 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 4.5068e-01
[rank0]:2025-10-27 06:36:36,411 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 4.2585e-01
[rank3]:2025-10-27 06:37:12,776 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 1.1961e+00
[rank2]:2025-10-27 06:37:12,764 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.4322e+00
[rank1]:2025-10-27 06:37:12,766 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.7654e+00
[rank0]:2025-10-27 06:37:12,776 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 2.1529e+00
[rank3]:2025-10-27 06:37:50,754 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 6.6263e-01
[rank2]:2025-10-27 06:37:50,746 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 7.1336e-01
[rank2]:2025-10-27 06:37:50,747 - INFO -  step: 580  loss: -4.0000  grad_norm:  0.1875  memory: 16.10GiB(33.90%)  tps: 2,206  tflops: 17.25  mfu: 5.53%
[rank1]:2025-10-27 06:37:50,743 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.9545e+00
[rank1]:2025-10-27 06:37:50,743 - INFO -  step: 580  loss: -4.0000  grad_norm:  0.1875  memory: 20.03GiB(42.17%)  tps: 2,206  tflops: 17.25  mfu: 5.53%
[rank0]:2025-10-27 06:37:50,758 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.2959e+00
[rank0]:2025-10-27 06:37:50,758 - INFO -  step: 580  loss: -4.0000  grad_norm:  0.1875  memory: 20.89GiB(43.97%)  tps: 2,206  tflops: 17.25  mfu: 5.53%
[rank3]:2025-10-27 06:37:50,757 - INFO -  step: 580  loss:  0.1164  grad_norm:  0.1875  memory: 38.93GiB(81.95%)  tps: 2,206  tflops: 17.25  mfu: 5.53%
[rank3]:2025-10-27 06:37:52,394 - INFO - Avg. fwd time: 71.9884 / Avg. bwd time: 121.3747 / Avg. batch time: 1595.8043 (ms) / GPU bubble ratio: 3.06%
[rank2]:2025-10-27 06:37:52,441 - INFO - Avg. fwd time: 33.1495 / Avg. bwd time: 48.8219 / Avg. batch time: 1680.2165 (ms) / GPU bubble ratio: 60.97%
[rank1]:2025-10-27 06:37:52,496 - INFO - Avg. fwd time: 51.4540 / Avg. bwd time: 66.3312 / Avg. batch time: 1791.9381 (ms) / GPU bubble ratio: 47.42%
[rank0]:2025-10-27 06:37:52,542 - INFO - Avg. fwd time: 46.0052 / Avg. bwd time: 53.2575 / Avg. batch time: 1883.3235 (ms) / GPU bubble ratio: 57.84%
[rank1]:2025-10-27 06:38:26,621 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 2.4063e-01
[rank0]:2025-10-27 06:38:26,636 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 6.1677e-01
[rank3]:2025-10-27 06:38:26,632 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 9.0061e-01
[rank2]:2025-10-27 06:38:26,620 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 9.0408e-01
[rank1]:2025-10-27 06:39:04,688 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.9097e+00
[rank3]:2025-10-27 06:39:04,699 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 9.4709e-01
[rank2]:2025-10-27 06:39:04,691 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 3.5179e-01
[rank0]:2025-10-27 06:39:04,703 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 8.3914e-01
[rank1]:2025-10-27 06:39:40,939 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.8335e+00
[rank3]:2025-10-27 06:39:40,951 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 2.5994e+00
[rank2]:2025-10-27 06:39:40,939 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.2644e+00
[rank0]:2025-10-27 06:39:40,954 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 2.9625e+00
[rank0]:2025-10-27 06:40:10,952 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-27 06:40:18,453 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 4.7326e-01
[rank2]:2025-10-27 06:40:18,453 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0928  memory: 16.10GiB(33.90%)  tps: 2,218  tflops: 17.34  mfu: 5.56%
[rank2]:2025-10-27 06:40:18,453 - INFO - ðŸ”Ž  Running validation at step 600
[rank1]:2025-10-27 06:40:18,449 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 5.2238e-01
[rank1]:2025-10-27 06:40:18,450 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0928  memory: 20.03GiB(42.17%)  tps: 2,218  tflops: 17.34  mfu: 5.56%
[rank1]:2025-10-27 06:40:18,450 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-10-27 06:40:18,460 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.9232e-01
[rank0]:2025-10-27 06:40:18,461 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0928  memory: 20.89GiB(43.97%)  tps: 2,219  tflops: 17.34  mfu: 5.56%
[rank0]:2025-10-27 06:40:18,461 - INFO - ðŸ”Ž  Running validation at step 600
[rank3]:2025-10-27 06:40:18,461 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 9.7507e-01
[rank3]:2025-10-27 06:40:18,464 - INFO -  step: 600  loss:  0.1222  grad_norm:  0.0928  memory: 38.93GiB(81.95%)  tps: 2,218  tflops: 17.34  mfu: 5.56%
[rank3]:2025-10-27 06:40:18,464 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-10-27 06:41:27,225 - INFO - validate step: 600  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,957
[rank1]:2025-10-27 06:41:27,303 - INFO - validate step: 600  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,949
[rank2]:2025-10-27 06:41:27,384 - INFO - validate step: 600  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,942
[rank3]:2025-10-27 06:41:27,466 - INFO - validate step: 600  loss:  0.2969  memory: 38.93GiB(81.95%)  tps: 5,936
[rank2]:2025-10-27 06:41:27,545 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_auto_dm1/freeze_ratio_history/rank2/251027_0641_stage2_step600.svg
[rank1]:2025-10-27 06:41:27,545 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_auto_dm1/freeze_ratio_history/rank1/251027_0641_stage1_step600.svg
[rank0]:2025-10-27 06:41:27,548 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_auto_dm1/freeze_ratio_history/rank0/251027_0641_stage0_step600.svg
[rank3]:2025-10-27 06:41:27,671 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1026_GPipe_auto_dm1/pipeline_schedule/251027_0641_real_step600_rank3.svg
[rank3]:> Batch Time: 1829.44 ms, GPU Bubble Ratio: 57.92%, 49.29%, 62.98%, 15.13%
[rank3]:2025-10-27 06:41:27,741 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_auto_dm1/freeze_ratio_history/rank3/251027_0641_stage3_step600.svg
[rank3]:2025-10-27 06:41:29,285 - INFO - Avg. fwd time: 71.9810 / Avg. bwd time: 121.2596 / Avg. batch time: 1594.7889 (ms) / GPU bubble ratio: 3.06%
[rank2]:2025-10-27 06:41:29,334 - INFO - Avg. fwd time: 33.1452 / Avg. bwd time: 48.7809 / Avg. batch time: 1679.1799 (ms) / GPU bubble ratio: 60.97%
[rank1]:2025-10-27 06:41:29,387 - INFO - Avg. fwd time: 51.4480 / Avg. bwd time: 65.9230 / Avg. batch time: 1790.4940 (ms) / GPU bubble ratio: 47.56%
[rank0]:2025-10-27 06:41:29,433 - INFO - Avg. fwd time: 45.9928 / Avg. bwd time: 52.9363 / Avg. batch time: 1881.5360 (ms) / GPU bubble ratio: 57.94%
[rank2]:2025-10-27 06:42:03,793 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.8572e+00
[rank0]:2025-10-27 06:42:03,806 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 8.0671e-01
[rank1]:2025-10-27 06:42:03,793 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 6.1715e-01
[rank3]:2025-10-27 06:42:03,804 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 3.5976e+00
[rank3]:2025-10-27 06:42:42,005 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 8.6419e-01
[rank2]:2025-10-27 06:42:41,997 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 5.7163e-01
[rank0]:2025-10-27 06:42:42,008 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 5.4104e-01
[rank1]:2025-10-27 06:42:41,998 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.4469e+00
[rank3]:2025-10-27 06:43:17,656 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 7.8957e-01
[rank2]:2025-10-27 06:43:17,644 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.5447e-01
[rank0]:2025-10-27 06:43:17,659 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 3.3451e-01
[rank1]:2025-10-27 06:43:17,644 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 6.0421e-01
[rank2]:2025-10-27 06:43:55,440 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.7060e-01
[rank2]:2025-10-27 06:43:55,440 - INFO -  step: 620  loss: -4.0000  grad_norm:  0.1221  memory: 16.10GiB(33.90%)  tps: 2,213  tflops: 17.30  mfu: 5.55%
[rank0]:2025-10-27 06:43:55,451 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.2616e-01
[rank0]:2025-10-27 06:43:55,452 - INFO -  step: 620  loss: -4.0000  grad_norm:  0.1221  memory: 20.89GiB(43.97%)  tps: 2,211  tflops: 17.28  mfu: 5.54%
[rank1]:2025-10-27 06:43:55,436 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 6.8002e-01
[rank1]:2025-10-27 06:43:55,437 - INFO -  step: 620  loss: -4.0000  grad_norm:  0.1221  memory: 20.03GiB(42.17%)  tps: 2,212  tflops: 17.29  mfu: 5.54%
[rank3]:2025-10-27 06:43:55,448 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.6677e-01
[rank3]:2025-10-27 06:43:55,451 - INFO -  step: 620  loss:  0.1523  grad_norm:  0.1221  memory: 38.93GiB(81.95%)  tps: 2,214  tflops: 17.31  mfu: 5.55%
[rank3]:2025-10-27 06:43:57,122 - INFO - Avg. fwd time: 71.9835 / Avg. bwd time: 121.1548 / Avg. batch time: 1593.9268 (ms) / GPU bubble ratio: 3.06%
[rank2]:2025-10-27 06:43:57,169 - INFO - Avg. fwd time: 33.1445 / Avg. bwd time: 48.7382 / Avg. batch time: 1678.2555 (ms) / GPU bubble ratio: 60.97%
[rank0]:2025-10-27 06:43:57,270 - INFO - Avg. fwd time: 45.9844 / Avg. bwd time: 52.6338 / Avg. batch time: 1879.8911 (ms) / GPU bubble ratio: 58.03%
[rank1]:2025-10-27 06:43:57,224 - INFO - Avg. fwd time: 51.4285 / Avg. bwd time: 65.5394 / Avg. batch time: 1789.1704 (ms) / GPU bubble ratio: 47.70%
[rank1]:2025-10-27 06:44:31,823 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 8.5796e-01
[rank3]:2025-10-27 06:44:31,834 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 7.1937e+00
[rank2]:2025-10-27 06:44:31,823 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.5722e+00
[rank0]:2025-10-27 06:44:31,839 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.1293e+00
[rank2]:2025-10-27 06:45:09,429 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 3.4981e-01
[rank1]:2025-10-27 06:45:09,425 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 5.4444e-01
[rank0]:2025-10-27 06:45:09,440 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.6991e-01
[rank3]:2025-10-27 06:45:09,437 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.2627e+00
[rank2]:2025-10-27 06:45:45,286 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.6028e+00
[rank1]:2025-10-27 06:45:45,288 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 2.1031e+00
[rank0]:2025-10-27 06:45:45,298 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.5754e+00
[rank3]:2025-10-27 06:45:45,298 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 7.4869e-01
[rank3]:2025-10-27 06:46:23,395 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.0692e+00
[rank3]:2025-10-27 06:46:23,398 - INFO -  step: 640  loss:  0.1095  grad_norm:  0.1545  memory: 38.93GiB(81.95%)  tps: 2,215  tflops: 17.31  mfu: 5.55%
[rank2]:2025-10-27 06:46:23,388 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.5356e+00
[rank2]:2025-10-27 06:46:23,388 - INFO -  step: 640  loss: -4.0000  grad_norm:  0.1545  memory: 16.10GiB(33.90%)  tps: 2,215  tflops: 17.31  mfu: 5.55%
[rank1]:2025-10-27 06:46:23,386 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 3.4982e+00
[rank1]:2025-10-27 06:46:23,387 - INFO -  step: 640  loss: -4.0000  grad_norm:  0.1545  memory: 20.03GiB(42.17%)  tps: 2,215  tflops: 17.31  mfu: 5.55%
[rank0]:2025-10-27 06:46:23,400 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.8511e+00
[rank0]:2025-10-27 06:46:23,400 - INFO -  step: 640  loss: -4.0000  grad_norm:  0.1545  memory: 20.89GiB(43.97%)  tps: 2,215  tflops: 17.31  mfu: 5.55%
[rank3]:2025-10-27 06:46:25,109 - INFO - Avg. fwd time: 71.9854 / Avg. bwd time: 121.0611 / Avg. batch time: 1593.1690 (ms) / GPU bubble ratio: 3.06%
[rank2]:2025-10-27 06:46:25,159 - INFO - Avg. fwd time: 33.1475 / Avg. bwd time: 48.7028 / Avg. batch time: 1677.4578 (ms) / GPU bubble ratio: 60.96%
[rank1]:2025-10-27 06:46:25,216 - INFO - Avg. fwd time: 51.4235 / Avg. bwd time: 65.1749 / Avg. batch time: 1787.9964 (ms) / GPU bubble ratio: 47.83%
[rank0]:2025-10-27 06:46:25,263 - INFO - Avg. fwd time: 45.9711 / Avg. bwd time: 52.3467 / Avg. batch time: 1878.4053 (ms) / GPU bubble ratio: 58.13%
[rank2]:2025-10-27 06:46:59,382 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.7668e+00
[rank1]:2025-10-27 06:46:59,383 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 4.0285e+00
[rank0]:2025-10-27 06:46:59,394 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 5.1726e+00
[rank3]:2025-10-27 06:46:59,394 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 1.7301e+00
[rank0]:2025-10-27 06:47:29,420 - INFO - [GC] Peforming periodical GC collection 0.02 seconds
[rank3]:2025-10-27 06:47:36,999 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.0771e+00
[rank1]:2025-10-27 06:47:36,988 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.3079e+00
[rank2]:2025-10-27 06:47:36,991 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 4.3855e-01
[rank0]:2025-10-27 06:47:37,004 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.4829e-01
[rank1]:2025-10-27 06:48:13,362 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 3.0938e-01
[rank2]:2025-10-27 06:48:13,360 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 6.4526e-01
[rank0]:2025-10-27 06:48:13,372 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 7.5165e-01
[rank3]:2025-10-27 06:48:13,372 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 8.3876e-01
[rank3]:2025-10-27 06:48:51,287 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 6.5503e-01
[rank3]:2025-10-27 06:48:51,290 - INFO -  step: 660  loss:  0.1172  grad_norm:  0.2047  memory: 38.93GiB(81.95%)  tps: 2,216  tflops: 17.32  mfu: 5.55%
[rank1]:2025-10-27 06:48:51,275 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 9.9534e-01
[rank1]:2025-10-27 06:48:51,276 - INFO -  step: 660  loss: -4.0000  grad_norm:  0.2047  memory: 20.03GiB(42.17%)  tps: 2,216  tflops: 17.32  mfu: 5.55%
[rank2]:2025-10-27 06:48:51,279 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 6.2353e-01
[rank2]:2025-10-27 06:48:51,280 - INFO -  step: 660  loss: -4.0000  grad_norm:  0.2047  memory: 16.10GiB(33.90%)  tps: 2,216  tflops: 17.32  mfu: 5.55%
[rank0]:2025-10-27 06:48:51,288 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 4.0638e-01
[rank0]:2025-10-27 06:48:51,288 - INFO -  step: 660  loss: -4.0000  grad_norm:  0.2047  memory: 20.89GiB(43.97%)  tps: 2,216  tflops: 17.32  mfu: 5.55%
[rank3]:2025-10-27 06:48:52,918 - INFO - Avg. fwd time: 71.9914 / Avg. bwd time: 120.9678 / Avg. batch time: 1592.3975 (ms) / GPU bubble ratio: 3.06%
[rank1]:2025-10-27 06:48:53,022 - INFO - Avg. fwd time: 51.4089 / Avg. bwd time: 64.8284 / Avg. batch time: 1786.8236 (ms) / GPU bubble ratio: 47.96%
[rank2]:2025-10-27 06:48:52,966 - INFO - Avg. fwd time: 33.1450 / Avg. bwd time: 48.6780 / Avg. batch time: 1676.6498 (ms) / GPU bubble ratio: 60.96%
[rank0]:2025-10-27 06:48:53,068 - INFO - Avg. fwd time: 45.9586 / Avg. bwd time: 52.0786 / Avg. batch time: 1876.9320 (ms) / GPU bubble ratio: 58.21%
[rank0]:2025-10-27 06:49:26,991 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 3.2249e+00
[rank2]:2025-10-27 06:49:26,979 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.0947e+00
[rank3]:2025-10-27 06:49:26,991 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 2.8972e+00
[rank1]:2025-10-27 06:49:26,979 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 2.2969e+00
[rank0]:2025-10-27 06:50:05,033 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.7444e+00
[rank2]:2025-10-27 06:50:05,022 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.1983e+00
[rank3]:2025-10-27 06:50:05,030 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.0782e+00
[rank1]:2025-10-27 06:50:05,018 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 2.8516e+00
[rank3]:2025-10-27 06:50:41,321 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 9.0278e-01
[rank1]:2025-10-27 06:50:41,310 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 4.0269e-01
[rank0]:2025-10-27 06:50:41,326 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 4.7081e-01
[rank2]:2025-10-27 06:50:41,309 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.0076e+00
[rank3]:2025-10-27 06:51:18,865 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.6755e+00
[rank3]:2025-10-27 06:51:18,869 - INFO -  step: 680  loss:  0.1277  grad_norm:  0.0836  memory: 38.93GiB(81.95%)  tps: 2,220  tflops: 17.36  mfu: 5.56%
[rank1]:2025-10-27 06:51:18,854 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.4151e+00
[rank1]:2025-10-27 06:51:18,854 - INFO -  step: 680  loss: -4.0000  grad_norm:  0.0836  memory: 20.03GiB(42.17%)  tps: 2,220  tflops: 17.36  mfu: 5.56%
[rank2]:2025-10-27 06:51:18,857 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.1127e+00
[rank2]:2025-10-27 06:51:18,858 - INFO -  step: 680  loss: -4.0000  grad_norm:  0.0836  memory: 16.10GiB(33.90%)  tps: 2,220  tflops: 17.36  mfu: 5.56%
[rank0]:2025-10-27 06:51:18,868 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.6667e-01
[rank0]:2025-10-27 06:51:18,869 - INFO -  step: 680  loss: -4.0000  grad_norm:  0.0836  memory: 20.89GiB(43.97%)  tps: 2,220  tflops: 17.36  mfu: 5.56%
[rank3]:2025-10-27 06:51:20,527 - INFO - Avg. fwd time: 71.9917 / Avg. bwd time: 120.8753 / Avg. batch time: 1591.6042 (ms) / GPU bubble ratio: 3.06%
[rank2]:2025-10-27 06:51:20,575 - INFO - Avg. fwd time: 33.1372 / Avg. bwd time: 48.6470 / Avg. batch time: 1675.8057 (ms) / GPU bubble ratio: 60.96%
[rank1]:2025-10-27 06:51:20,629 - INFO - Avg. fwd time: 51.3823 / Avg. bwd time: 64.5033 / Avg. batch time: 1785.6366 (ms) / GPU bubble ratio: 48.08%
[rank0]:2025-10-27 06:51:20,675 - INFO - Avg. fwd time: 45.9435 / Avg. bwd time: 51.8241 / Avg. batch time: 1875.4644 (ms) / GPU bubble ratio: 58.30%
[rank1]:2025-10-27 06:51:54,943 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 9.0881e-01
[rank2]:2025-10-27 06:51:54,943 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 9.8366e-01
[rank0]:2025-10-27 06:51:54,955 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 3.2765e-01
[rank3]:2025-10-27 06:51:54,954 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 3.3503e+00
[rank2]:2025-10-27 06:52:33,223 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.4987e+00
[rank0]:2025-10-27 06:52:33,235 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.8281e+00
[rank3]:2025-10-27 06:52:33,230 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.0567e+00
[rank1]:2025-10-27 06:52:33,219 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 2.1707e+00
[rank2]:2025-10-27 06:53:08,856 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.5073e+00
[rank0]:2025-10-27 06:53:08,872 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 2.4660e+00
[rank3]:2025-10-27 06:53:08,873 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 1.2505e+00
[rank1]:2025-10-27 06:53:08,856 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.6696e+00
[rank0]:2025-10-27 06:53:39,110 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-27 06:53:46,677 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 7.4770e-01
[rank3]:2025-10-27 06:53:46,681 - INFO -  step: 700  loss:  0.1146  grad_norm:  0.1098  memory: 38.93GiB(81.95%)  tps: 2,217  tflops: 17.33  mfu: 5.55%
[rank3]:2025-10-27 06:53:46,681 - INFO - ðŸ”Ž  Running validation at step 700
[rank1]:2025-10-27 06:53:46,666 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 7.6704e-01
[rank1]:2025-10-27 06:53:46,666 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.1098  memory: 20.03GiB(42.17%)  tps: 2,217  tflops: 17.33  mfu: 5.55%
[rank1]:2025-10-27 06:53:46,667 - INFO - ðŸ”Ž  Running validation at step 700
[rank2]:2025-10-27 06:53:46,670 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 5.7589e-01
[rank2]:2025-10-27 06:53:46,670 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.1098  memory: 16.10GiB(33.90%)  tps: 2,217  tflops: 17.33  mfu: 5.55%
[rank2]:2025-10-27 06:53:46,670 - INFO - ðŸ”Ž  Running validation at step 700
[rank0]:2025-10-27 06:53:46,679 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 4.9833e-01
[rank0]:2025-10-27 06:53:46,680 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.1098  memory: 20.89GiB(43.97%)  tps: 2,217  tflops: 17.33  mfu: 5.55%
[rank0]:2025-10-27 06:53:46,680 - INFO - ðŸ”Ž  Running validation at step 700
[rank0]:2025-10-27 06:54:55,373 - INFO - validate step: 700  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,963
[rank1]:2025-10-27 06:54:55,454 - INFO - validate step: 700  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,955
[rank2]:2025-10-27 06:54:55,537 - INFO - validate step: 700  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,948
[rank3]:2025-10-27 06:54:55,621 - INFO - validate step: 700  loss:  0.2947  memory: 38.93GiB(81.95%)  tps: 5,942
[rank2]:2025-10-27 06:54:55,702 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_auto_dm1/freeze_ratio_history/rank2/251027_0654_stage2_step700.svg
[rank0]:2025-10-27 06:54:55,706 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_auto_dm1/freeze_ratio_history/rank0/251027_0654_stage0_step700.svg
[rank1]:2025-10-27 06:54:55,703 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_auto_dm1/freeze_ratio_history/rank1/251027_0654_stage1_step700.svg
[rank3]:2025-10-27 06:54:55,823 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1026_GPipe_auto_dm1/pipeline_schedule/251027_0654_real_step700_rank3.svg
[rank3]:> Batch Time: 1819.62 ms, GPU Bubble Ratio: 58.67%, 50.63%, 62.80%, 14.81%
[rank3]:2025-10-27 06:54:55,897 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_auto_dm1/freeze_ratio_history/rank3/251027_0654_stage3_step700.svg
[rank3]:2025-10-27 06:54:57,474 - INFO - Avg. fwd time: 71.9900 / Avg. bwd time: 120.7937 / Avg. batch time: 1590.9190 (ms) / GPU bubble ratio: 3.06%
[rank2]:2025-10-27 06:54:57,521 - INFO - Avg. fwd time: 33.1348 / Avg. bwd time: 48.6244 / Avg. batch time: 1675.1248 (ms) / GPU bubble ratio: 60.95%
[rank0]:2025-10-27 06:54:57,626 - INFO - Avg. fwd time: 45.9304 / Avg. bwd time: 51.5869 / Avg. batch time: 1874.2044 (ms) / GPU bubble ratio: 58.37%
[rank1]:2025-10-27 06:54:57,580 - INFO - Avg. fwd time: 51.3817 / Avg. bwd time: 64.1932 / Avg. batch time: 1784.6419 (ms) / GPU bubble ratio: 48.19%
[rank3]:2025-10-27 06:55:32,443 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 2.6600e+00
[rank2]:2025-10-27 06:55:32,431 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.2752e+00
[rank0]:2025-10-27 06:55:32,446 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 4.3577e+00
[rank1]:2025-10-27 06:55:32,431 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.6870e+00
[rank3]:2025-10-27 06:56:10,067 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 7.5313e-01
[rank2]:2025-10-27 06:56:10,059 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 5.1839e-01
[rank0]:2025-10-27 06:56:10,067 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 9.4464e-01
[rank1]:2025-10-27 06:56:10,057 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 9.7098e-01
[rank2]:2025-10-27 06:56:46,140 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 3.3508e-01
[rank0]:2025-10-27 06:56:46,156 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 3.5832e-01
[rank1]:2025-10-27 06:56:46,140 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 3.4832e-01
[rank3]:2025-10-27 06:56:46,152 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 4.9786e-01
[rank2]:2025-10-27 06:57:24,594 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.7769e+00
[rank2]:2025-10-27 06:57:24,594 - INFO -  step: 720  loss: -4.0000  grad_norm:  0.1825  memory: 16.10GiB(33.90%)  tps: 2,198  tflops: 17.19  mfu: 5.51%
[rank0]:2025-10-27 06:57:24,604 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.7999e+00
[rank0]:2025-10-27 06:57:24,604 - INFO -  step: 720  loss: -4.0000  grad_norm:  0.1825  memory: 20.89GiB(43.97%)  tps: 2,196  tflops: 17.17  mfu: 5.50%
[rank1]:2025-10-27 06:57:24,592 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 3.6913e+00
[rank1]:2025-10-27 06:57:24,593 - INFO -  step: 720  loss: -4.0000  grad_norm:  0.1825  memory: 20.03GiB(42.17%)  tps: 2,197  tflops: 17.18  mfu: 5.51%
[rank3]:2025-10-27 06:57:24,601 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.8668e+00
[rank3]:2025-10-27 06:57:24,604 - INFO -  step: 720  loss:  0.1979  grad_norm:  0.1825  memory: 38.93GiB(81.95%)  tps: 2,199  tflops: 17.19  mfu: 5.51%
[rank3]:2025-10-27 06:57:26,322 - INFO - Avg. fwd time: 72.0043 / Avg. bwd time: 120.7392 / Avg. batch time: 1590.5930 (ms) / GPU bubble ratio: 3.06%
[rank2]:2025-10-27 06:57:26,369 - INFO - Avg. fwd time: 33.1308 / Avg. bwd time: 48.5961 / Avg. batch time: 1674.7696 (ms) / GPU bubble ratio: 60.96%
[rank1]:2025-10-27 06:57:26,431 - INFO - Avg. fwd time: 51.4026 / Avg. bwd time: 63.9144 / Avg. batch time: 1784.0223 (ms) / GPU bubble ratio: 48.29%
[rank0]:2025-10-27 06:57:26,479 - INFO - Avg. fwd time: 45.9263 / Avg. bwd time: 51.3648 / Avg. batch time: 1873.3412 (ms) / GPU bubble ratio: 58.45%
[rank3]:2025-10-27 06:58:00,840 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 3.6585e+00
[rank2]:2025-10-27 06:58:00,829 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 3.3454e+00
[rank0]:2025-10-27 06:58:00,840 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 2.6489e+00
[rank1]:2025-10-27 06:58:00,830 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 3.0764e+00
[rank1]:2025-10-27 06:58:38,716 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.6893e-01
[rank3]:2025-10-27 06:58:38,727 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 6.4922e-01
[rank2]:2025-10-27 06:58:38,719 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.3796e-01
[rank0]:2025-10-27 06:58:38,730 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 9.0732e-01
[rank1]:2025-10-27 06:59:15,154 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 2.5332e-01
[rank2]:2025-10-27 06:59:15,152 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 4.5814e-01
[rank3]:2025-10-27 06:59:15,163 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 1.5545e+00
[rank0]:2025-10-27 06:59:15,168 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 6.3118e-01
[rank1]:2025-10-27 06:59:53,340 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 9.8636e-01
[rank1]:2025-10-27 06:59:53,340 - INFO -  step: 740  loss: -4.0000  grad_norm:  0.1405  memory: 20.03GiB(42.17%)  tps: 2,203  tflops: 17.22  mfu: 5.52%
[rank2]:2025-10-27 06:59:53,343 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.7625e-01
[rank2]:2025-10-27 06:59:53,348 - INFO -  step: 740  loss: -4.0000  grad_norm:  0.1405  memory: 16.10GiB(33.90%)  tps: 2,203  tflops: 17.22  mfu: 5.52%
[rank3]:2025-10-27 06:59:53,351 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 5.4938e-01
[rank3]:2025-10-27 06:59:53,354 - INFO -  step: 740  loss:  0.1369  grad_norm:  0.1405  memory: 38.93GiB(81.95%)  tps: 2,203  tflops: 17.22  mfu: 5.52%
[rank0]:2025-10-27 06:59:53,355 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 5.9157e-01
[rank0]:2025-10-27 06:59:53,355 - INFO -  step: 740  loss: -4.0000  grad_norm:  0.1405  memory: 20.89GiB(43.97%)  tps: 2,203  tflops: 17.22  mfu: 5.52%
[rank3]:2025-10-27 06:59:54,998 - INFO - Avg. fwd time: 72.0066 / Avg. bwd time: 120.6866 / Avg. batch time: 1590.2044 (ms) / GPU bubble ratio: 3.06%
[rank2]:2025-10-27 06:59:55,047 - INFO - Avg. fwd time: 33.1290 / Avg. bwd time: 48.5733 / Avg. batch time: 1674.3451 (ms) / GPU bubble ratio: 60.96%
[rank1]:2025-10-27 06:59:55,102 - INFO - Avg. fwd time: 51.4369 / Avg. bwd time: 63.6623 / Avg. batch time: 1783.3650 (ms) / GPU bubble ratio: 48.37%
[rank0]:2025-10-27 06:59:55,150 - INFO - Avg. fwd time: 45.9210 / Avg. bwd time: 51.1567 / Avg. batch time: 1872.4603 (ms) / GPU bubble ratio: 58.52%
[rank2]:2025-10-27 07:00:29,226 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 9.5215e-01
[rank0]:2025-10-27 07:00:29,240 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 7.4946e-01
[rank1]:2025-10-27 07:00:29,227 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 6.0083e-01
[rank3]:2025-10-27 07:00:29,238 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 1.1985e+00
[rank0]:2025-10-27 07:00:59,602 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-27 07:01:07,261 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 4.6164e-01
[rank2]:2025-10-27 07:01:07,254 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 4.2303e-01
[rank0]:2025-10-27 07:01:07,268 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 4.8861e-01
[rank1]:2025-10-27 07:01:07,250 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 6.4485e-01
[rank2]:2025-10-27 07:01:43,521 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 6.7597e-01
[rank0]:2025-10-27 07:01:43,536 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 3.9145e-01
[rank1]:2025-10-27 07:01:43,521 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 4.8292e-01
[rank3]:2025-10-27 07:01:43,532 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 6.1638e-01
[rank2]:2025-10-27 07:02:20,978 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.5449e-01
[rank2]:2025-10-27 07:02:20,979 - INFO -  step: 760  loss: -4.0000  grad_norm:  0.0882  memory: 16.10GiB(33.90%)  tps: 2,220  tflops: 17.35  mfu: 5.56%
[rank0]:2025-10-27 07:02:20,986 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 4.6508e-01
[rank0]:2025-10-27 07:02:20,987 - INFO -  step: 760  loss: -4.0000  grad_norm:  0.0882  memory: 20.89GiB(43.97%)  tps: 2,220  tflops: 17.35  mfu: 5.56%
[rank1]:2025-10-27 07:02:20,976 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.9757e-01
[rank1]:2025-10-27 07:02:20,976 - INFO -  step: 760  loss: -4.0000  grad_norm:  0.0882  memory: 20.03GiB(42.17%)  tps: 2,220  tflops: 17.35  mfu: 5.56%
[rank3]:2025-10-27 07:02:20,986 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 4.3355e-01
[rank3]:2025-10-27 07:02:20,989 - INFO -  step: 760  loss:  0.1235  grad_norm:  0.0882  memory: 38.93GiB(81.95%)  tps: 2,220  tflops: 17.35  mfu: 5.56%
[rank3]:2025-10-27 07:02:22,620 - INFO - Avg. fwd time: 71.9962 / Avg. bwd time: 120.6151 / Avg. batch time: 1589.5444 (ms) / GPU bubble ratio: 3.06%
[rank2]:2025-10-27 07:02:22,668 - INFO - Avg. fwd time: 33.1275 / Avg. bwd time: 48.5471 / Avg. batch time: 1673.6489 (ms) / GPU bubble ratio: 60.96%
[rank1]:2025-10-27 07:02:22,726 - INFO - Avg. fwd time: 51.4376 / Avg. bwd time: 63.3980 / Avg. batch time: 1782.3998 (ms) / GPU bubble ratio: 48.46%
[rank0]:2025-10-27 07:02:22,773 - INFO - Avg. fwd time: 45.9130 / Avg. bwd time: 50.9557 / Avg. batch time: 1871.2781 (ms) / GPU bubble ratio: 58.59%
[rank3]:2025-10-27 07:02:57,117 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 1.9398e+00
[rank2]:2025-10-27 07:02:57,106 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.8326e+00
[rank0]:2025-10-27 07:02:57,118 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 2.6708e+00
[rank1]:2025-10-27 07:02:57,106 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 2.6651e+00
[rank1]:2025-10-27 07:03:35,344 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 6.1869e-01
[rank3]:2025-10-27 07:03:35,356 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 5.8284e-01
[rank2]:2025-10-27 07:03:35,348 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.7667e-01
[rank0]:2025-10-27 07:03:35,360 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.4311e-01
[rank3]:2025-10-27 07:04:10,916 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 1.8666e+00
[rank2]:2025-10-27 07:04:10,905 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.1198e+00
[rank0]:2025-10-27 07:04:10,920 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 2.1815e+00
[rank1]:2025-10-27 07:04:10,905 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.4231e+00
[rank3]:2025-10-27 07:04:48,864 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 5.2446e-01
[rank3]:2025-10-27 07:04:48,867 - INFO -  step: 780  loss:  0.1343  grad_norm:  0.1174  memory: 38.93GiB(81.95%)  tps: 2,216  tflops: 17.32  mfu: 5.55%
[rank2]:2025-10-27 07:04:48,856 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.0919e+00
[rank2]:2025-10-27 07:04:48,857 - INFO -  step: 780  loss: -4.0000  grad_norm:  0.1174  memory: 16.10GiB(33.90%)  tps: 2,216  tflops: 17.32  mfu: 5.55%
[rank0]:2025-10-27 07:04:48,868 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.7181e+00
[rank0]:2025-10-27 07:04:48,869 - INFO -  step: 780  loss: -4.0000  grad_norm:  0.1174  memory: 20.89GiB(43.97%)  tps: 2,216  tflops: 17.32  mfu: 5.55%
[rank1]:2025-10-27 07:04:48,853 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.0890e+00
[rank1]:2025-10-27 07:04:48,853 - INFO -  step: 780  loss: -4.0000  grad_norm:  0.1174  memory: 20.03GiB(42.17%)  tps: 2,216  tflops: 17.32  mfu: 5.55%
[rank3]:2025-10-27 07:04:50,524 - INFO - Avg. fwd time: 71.9913 / Avg. bwd time: 120.5530 / Avg. batch time: 1588.9989 (ms) / GPU bubble ratio: 3.06%
[rank2]:2025-10-27 07:04:50,572 - INFO - Avg. fwd time: 33.1239 / Avg. bwd time: 48.5242 / Avg. batch time: 1673.0741 (ms) / GPU bubble ratio: 60.96%
[rank1]:2025-10-27 07:04:50,627 - INFO - Avg. fwd time: 51.4342 / Avg. bwd time: 63.1533 / Avg. batch time: 1781.5673 (ms) / GPU bubble ratio: 48.55%
[rank0]:2025-10-27 07:04:50,674 - INFO - Avg. fwd time: 45.9099 / Avg. bwd time: 50.7662 / Avg. batch time: 1870.2422 (ms) / GPU bubble ratio: 58.65%
[rank1]:2025-10-27 07:05:25,344 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 5.6678e-01
[rank3]:2025-10-27 07:05:25,355 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 2.3419e+00
[rank2]:2025-10-27 07:05:25,344 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.0571e+00
[rank0]:2025-10-27 07:05:25,359 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.3573e+00
[rank2]:2025-10-27 07:06:02,962 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 8.8616e-01
[rank0]:2025-10-27 07:06:02,974 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 7.0962e-01
[rank1]:2025-10-27 07:06:02,958 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 2.7945e+00
[rank3]:2025-10-27 07:06:02,969 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 7.9695e-01
[rank2]:2025-10-27 07:06:38,807 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 9.3578e-01
[rank0]:2025-10-27 07:06:38,819 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 7.5346e-01
[rank1]:2025-10-27 07:06:38,808 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.5543e+00
[rank3]:2025-10-27 07:06:38,819 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 8.8068e-01
[rank0]:2025-10-27 07:07:09,262 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-27 07:07:17,002 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.7568e+00
[rank1]:2025-10-27 07:07:17,002 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1572  memory: 20.03GiB(42.17%)  tps: 2,212  tflops: 17.29  mfu: 5.54%
[rank1]:2025-10-27 07:07:17,002 - INFO - ðŸ”Ž  Running validation at step 800
[rank3]:2025-10-27 07:07:17,013 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 8.9052e-01
[rank3]:2025-10-27 07:07:17,016 - INFO -  step: 800  loss:  0.1077  grad_norm:  0.1572  memory: 38.93GiB(81.95%)  tps: 2,212  tflops: 17.29  mfu: 5.54%
[rank3]:2025-10-27 07:07:17,017 - INFO - ðŸ”Ž  Running validation at step 800
[rank2]:2025-10-27 07:07:17,005 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 9.4674e-01
[rank2]:2025-10-27 07:07:17,006 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1572  memory: 16.10GiB(33.90%)  tps: 2,212  tflops: 17.29  mfu: 5.54%
[rank2]:2025-10-27 07:07:17,006 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-10-27 07:07:17,017 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.9780e+00
[rank0]:2025-10-27 07:07:17,018 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1572  memory: 20.89GiB(43.97%)  tps: 2,212  tflops: 17.29  mfu: 5.54%
[rank0]:2025-10-27 07:07:17,018 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-10-27 07:08:25,816 - INFO - validate step: 800  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,954
[rank1]:2025-10-27 07:08:25,895 - INFO - validate step: 800  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,945
[rank2]:2025-10-27 07:08:25,980 - INFO - validate step: 800  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,939
[rank3]:2025-10-27 07:08:26,057 - INFO - validate step: 800  loss:  0.2961  memory: 38.93GiB(81.95%)  tps: 5,933
[rank1]:2025-10-27 07:08:26,146 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_auto_dm1/freeze_ratio_history/rank1/251027_0708_stage1_step800.svg
[rank2]:2025-10-27 07:08:26,143 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_auto_dm1/freeze_ratio_history/rank2/251027_0708_stage2_step800.svg
[rank0]:2025-10-27 07:08:26,147 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_auto_dm1/freeze_ratio_history/rank0/251027_0708_stage0_step800.svg
[rank3]:2025-10-27 07:08:26,265 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1026_GPipe_auto_dm1/pipeline_schedule/251027_0708_real_step800_rank3.svg
[rank3]:> Batch Time: 1816.47 ms, GPU Bubble Ratio: 58.83%, 51.11%, 62.77%, 14.75%
[rank3]:2025-10-27 07:08:26,343 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_auto_dm1/freeze_ratio_history/rank3/251027_0708_stage3_step800.svg
[rank3]:2025-10-27 07:08:27,940 - INFO - Avg. fwd time: 72.0018 / Avg. bwd time: 120.4921 / Avg. batch time: 1588.5582 (ms) / GPU bubble ratio: 3.06%
[rank2]:2025-10-27 07:08:27,989 - INFO - Avg. fwd time: 33.1247 / Avg. bwd time: 48.4978 / Avg. batch time: 1672.6341 (ms) / GPU bubble ratio: 60.96%
[rank1]:2025-10-27 07:08:28,057 - INFO - Avg. fwd time: 51.4343 / Avg. bwd time: 62.9263 / Avg. batch time: 1780.9051 (ms) / GPU bubble ratio: 48.63%
[rank0]:2025-10-27 07:08:28,103 - INFO - Avg. fwd time: 45.9065 / Avg. bwd time: 50.5842 / Avg. batch time: 1869.3854 (ms) / GPU bubble ratio: 58.71%
[rank2]:2025-10-27 07:09:02,410 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.1171e+00
[rank0]:2025-10-27 07:09:02,426 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.7744e+00
[rank3]:2025-10-27 07:09:02,421 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 1.1794e+00
[rank1]:2025-10-27 07:09:02,410 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 4.6253e-01
[rank3]:2025-10-27 07:09:40,331 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.0212e-01
[rank1]:2025-10-27 07:09:40,320 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.2690e+00
[rank2]:2025-10-27 07:09:40,323 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 5.3588e-01
[rank0]:2025-10-27 07:09:40,338 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 5.7654e-01
[rank3]:2025-10-27 07:09:50,292 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-27 07:09:51,134 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-27 07:09:51,186 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-27 07:09:51,227 - WARNING - Dataset alpaca is being re-looped
[rank3]:2025-10-27 07:10:18,693 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 8.3439e-01
[rank1]:2025-10-27 07:10:18,683 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 9.0102e-01
[rank2]:2025-10-27 07:10:18,682 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 8.9725e-01
[rank0]:2025-10-27 07:10:18,693 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.2273e+00
[rank3]:2025-10-27 07:10:56,784 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 3.4825e-01
[rank3]:2025-10-27 07:10:56,787 - INFO -  step: 820  loss:  0.1348  grad_norm:  0.1431  memory: 38.93GiB(81.95%)  tps: 2,174  tflops: 17.00  mfu: 5.45%
[rank1]:2025-10-27 07:10:56,773 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 5.2111e-01
[rank1]:2025-10-27 07:10:56,774 - INFO -  step: 820  loss: -4.0000  grad_norm:  0.1431  memory: 20.03GiB(42.17%)  tps: 2,172  tflops: 16.98  mfu: 5.44%
[rank2]:2025-10-27 07:10:56,776 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 4.5263e-01
[rank2]:2025-10-27 07:10:56,777 - INFO -  step: 820  loss: -4.0000  grad_norm:  0.1431  memory: 16.10GiB(33.90%)  tps: 2,173  tflops: 16.99  mfu: 5.44%
[rank0]:2025-10-27 07:10:56,788 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.1771e-01
[rank0]:2025-10-27 07:10:56,789 - INFO -  step: 820  loss: -4.0000  grad_norm:  0.1431  memory: 20.89GiB(43.97%)  tps: 2,170  tflops: 16.97  mfu: 5.44%
[rank3]:2025-10-27 07:10:58,439 - INFO - Avg. fwd time: 71.9995 / Avg. bwd time: 120.4554 / Avg. batch time: 1588.2545 (ms) / GPU bubble ratio: 3.06%
[rank1]:2025-10-27 07:10:58,548 - INFO - Avg. fwd time: 51.4434 / Avg. bwd time: 62.7089 / Avg. batch time: 1780.3594 (ms) / GPU bubble ratio: 48.71%
[rank2]:2025-10-27 07:10:58,489 - INFO - Avg. fwd time: 33.1240 / Avg. bwd time: 48.4747 / Avg. batch time: 1672.3025 (ms) / GPU bubble ratio: 60.96%
[rank0]:2025-10-27 07:10:58,595 - INFO - Avg. fwd time: 45.9094 / Avg. bwd time: 50.4180 / Avg. batch time: 1868.7940 (ms) / GPU bubble ratio: 58.76%
[rank2]:2025-10-27 07:11:32,812 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.4437e+00
[rank3]:2025-10-27 07:11:32,824 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 1.1270e+00
[rank1]:2025-10-27 07:11:32,815 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 8.7857e-01
[rank0]:2025-10-27 07:11:32,824 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.5618e+00
[rank1]:2025-10-27 07:12:11,040 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.5517e+00
[rank0]:2025-10-27 07:12:11,056 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1745e+00
[rank2]:2025-10-27 07:12:11,044 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 6.9966e-01
[rank3]:2025-10-27 07:12:11,052 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 7.6038e-01
[rank1]:2025-10-27 07:12:47,389 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 3.3930e-01
[rank0]:2025-10-27 07:12:47,401 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.1717e+00
[rank2]:2025-10-27 07:12:47,389 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.2885e-01
[rank3]:2025-10-27 07:12:47,400 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 8.4354e-01
[rank2]:2025-10-27 07:13:24,952 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.4405e+00
[rank2]:2025-10-27 07:13:24,953 - INFO -  step: 840  loss: -4.0000  grad_norm:  0.1052  memory: 16.10GiB(33.90%)  tps: 2,211  tflops: 17.29  mfu: 5.54%
[rank1]:2025-10-27 07:13:24,949 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 3.7382e+00
[rank1]:2025-10-27 07:13:24,949 - INFO -  step: 840  loss: -4.0000  grad_norm:  0.1052  memory: 20.03GiB(42.17%)  tps: 2,211  tflops: 17.29  mfu: 5.54%
[rank3]:2025-10-27 07:13:24,960 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 9.4916e-01
[rank3]:2025-10-27 07:13:24,964 - INFO -  step: 840  loss:  0.1345  grad_norm:  0.1052  memory: 38.93GiB(81.95%)  tps: 2,211  tflops: 17.29  mfu: 5.54%
[rank0]:2025-10-27 07:13:24,963 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.0611e+00
[rank0]:2025-10-27 07:13:24,963 - INFO -  step: 840  loss: -4.0000  grad_norm:  0.1052  memory: 20.89GiB(43.97%)  tps: 2,211  tflops: 17.29  mfu: 5.54%
[rank3]:2025-10-27 07:13:26,630 - INFO - Avg. fwd time: 72.0077 / Avg. bwd time: 120.4018 / Avg. batch time: 1587.8596 (ms) / GPU bubble ratio: 3.06%
[rank1]:2025-10-27 07:13:26,737 - INFO - Avg. fwd time: 51.4428 / Avg. bwd time: 62.5032 / Avg. batch time: 1779.7263 (ms) / GPU bubble ratio: 48.78%
[rank2]:2025-10-27 07:13:26,680 - INFO - Avg. fwd time: 33.1246 / Avg. bwd time: 48.4536 / Avg. batch time: 1671.8832 (ms) / GPU bubble ratio: 60.96%
[rank0]:2025-10-27 07:13:26,784 - INFO - Avg. fwd time: 45.9078 / Avg. bwd time: 50.2573 / Avg. batch time: 1867.9862 (ms) / GPU bubble ratio: 58.82%
[rank3]:2025-10-27 07:14:01,090 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 3.1346e+00
[rank1]:2025-10-27 07:14:01,079 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 4.2849e+00
[rank0]:2025-10-27 07:14:01,095 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 3.1701e+00
[rank2]:2025-10-27 07:14:01,079 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 3.2490e+00
[rank0]:2025-10-27 07:14:31,790 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-27 07:14:39,391 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.7200e+00
[rank1]:2025-10-27 07:14:39,380 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 6.1151e+00
[rank0]:2025-10-27 07:14:39,395 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.9390e+00
[rank2]:2025-10-27 07:14:39,384 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.0604e+00
[rank1]:2025-10-27 07:15:14,995 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 6.2695e-01
[rank2]:2025-10-27 07:15:14,995 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 9.1690e-01
[rank3]:2025-10-27 07:15:15,006 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 1.6289e+00
[rank0]:2025-10-27 07:15:15,011 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.3525e+00
[rank1]:2025-10-27 07:15:52,812 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 7.4285e-01
[rank1]:2025-10-27 07:15:52,813 - INFO -  step: 860  loss: -4.0000  grad_norm:  0.1157  memory: 20.03GiB(42.17%)  tps: 2,216  tflops: 17.32  mfu: 5.55%
[rank0]:2025-10-27 07:15:52,824 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.0560e+00
[rank0]:2025-10-27 07:15:52,825 - INFO -  step: 860  loss: -4.0000  grad_norm:  0.1157  memory: 20.89GiB(43.97%)  tps: 2,216  tflops: 17.32  mfu: 5.55%
[rank2]:2025-10-27 07:15:52,816 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.3846e-01
[rank2]:2025-10-27 07:15:52,817 - INFO -  step: 860  loss: -4.0000  grad_norm:  0.1157  memory: 16.10GiB(33.90%)  tps: 2,216  tflops: 17.32  mfu: 5.55%
[rank3]:2025-10-27 07:15:52,824 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 4.2335e-01
[rank3]:2025-10-27 07:15:52,827 - INFO -  step: 860  loss:  0.1197  grad_norm:  0.1157  memory: 38.93GiB(81.95%)  tps: 2,216  tflops: 17.32  mfu: 5.55%
[rank3]:2025-10-27 07:15:54,475 - INFO - Avg. fwd time: 72.0068 / Avg. bwd time: 120.3491 / Avg. batch time: 1587.3961 (ms) / GPU bubble ratio: 3.06%
[rank2]:2025-10-27 07:15:54,523 - INFO - Avg. fwd time: 33.1251 / Avg. bwd time: 48.4317 / Avg. batch time: 1671.3973 (ms) / GPU bubble ratio: 60.96%
[rank1]:2025-10-27 07:15:54,580 - INFO - Avg. fwd time: 51.4348 / Avg. bwd time: 62.2981 / Avg. batch time: 1779.0291 (ms) / GPU bubble ratio: 48.86%
[rank0]:2025-10-27 07:15:54,628 - INFO - Avg. fwd time: 45.9028 / Avg. bwd time: 50.1031 / Avg. batch time: 1867.1198 (ms) / GPU bubble ratio: 58.86%
[rank3]:2025-10-27 07:16:29,229 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 1.1864e+00
[rank1]:2025-10-27 07:16:29,217 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.7977e+00
[rank0]:2025-10-27 07:16:29,229 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 2.2003e+00
[rank2]:2025-10-27 07:16:29,217 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.0097e+00
[rank2]:2025-10-27 07:17:06,758 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.9387e-01
[rank3]:2025-10-27 07:17:06,766 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 5.4419e-01
[rank0]:2025-10-27 07:17:06,771 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 4.7467e-01
[rank1]:2025-10-27 07:17:06,755 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 4.7267e-01
[rank3]:2025-10-27 07:17:42,630 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 7.2505e-01
[rank0]:2025-10-27 07:17:42,631 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.5674e+00
[rank1]:2025-10-27 07:17:42,619 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 5.0847e-01
[rank2]:2025-10-27 07:17:42,619 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 4.7008e-01
[rank1]:2025-10-27 07:18:20,731 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 2.6533e+00
[rank1]:2025-10-27 07:18:20,731 - INFO -  step: 880  loss: -4.0000  grad_norm:  0.1479  memory: 20.03GiB(42.17%)  tps: 2,215  tflops: 17.32  mfu: 5.55%
[rank2]:2025-10-27 07:18:20,734 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 9.5840e-01
[rank2]:2025-10-27 07:18:20,735 - INFO -  step: 880  loss: -4.0000  grad_norm:  0.1479  memory: 16.10GiB(33.90%)  tps: 2,215  tflops: 17.32  mfu: 5.55%
[rank3]:2025-10-27 07:18:20,742 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 8.5503e-01
[rank3]:2025-10-27 07:18:20,745 - INFO -  step: 880  loss:  0.1022  grad_norm:  0.1479  memory: 38.93GiB(81.95%)  tps: 2,215  tflops: 17.32  mfu: 5.55%
[rank0]:2025-10-27 07:18:20,746 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.3608e+00
[rank0]:2025-10-27 07:18:20,746 - INFO -  step: 880  loss: -4.0000  grad_norm:  0.1479  memory: 20.89GiB(43.97%)  tps: 2,215  tflops: 17.32  mfu: 5.55%
[rank3]:2025-10-27 07:18:22,454 - INFO - Avg. fwd time: 72.0076 / Avg. bwd time: 120.2991 / Avg. batch time: 1586.9868 (ms) / GPU bubble ratio: 3.06%
[rank2]:2025-10-27 07:18:22,502 - INFO - Avg. fwd time: 33.1276 / Avg. bwd time: 48.4118 / Avg. batch time: 1670.9618 (ms) / GPU bubble ratio: 60.96%
[rank0]:2025-10-27 07:18:22,607 - INFO - Avg. fwd time: 45.8986 / Avg. bwd time: 49.9526 / Avg. batch time: 1866.3217 (ms) / GPU bubble ratio: 58.91%
[rank1]:2025-10-27 07:18:22,560 - INFO - Avg. fwd time: 51.4414 / Avg. bwd time: 62.1002 / Avg. batch time: 1778.3900 (ms) / GPU bubble ratio: 48.92%
[rank3]:2025-10-27 07:18:56,759 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 7.0167e-01
[rank0]:2025-10-27 07:18:56,764 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 3.1596e+00
[rank1]:2025-10-27 07:18:56,748 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 2.6901e+00
[rank2]:2025-10-27 07:18:56,748 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.1998e+00
[rank1]:2025-10-27 07:19:34,521 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 6.3909e+00
[rank2]:2025-10-27 07:19:34,523 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 3.1352e+00
[rank3]:2025-10-27 07:19:34,531 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 3.3871e+00
[rank0]:2025-10-27 07:19:34,531 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.9655e+00
[rank2]:2025-10-27 07:20:10,913 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 9.6753e-01
[rank3]:2025-10-27 07:20:10,924 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 1.0122e+00
[rank0]:2025-10-27 07:20:10,924 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 7.6609e-01
[rank1]:2025-10-27 07:20:10,913 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 9.5183e-01
[rank0]:2025-10-27 07:20:41,502 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-27 07:20:49,014 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.8323e+00
[rank1]:2025-10-27 07:20:49,015 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.1378  memory: 20.03GiB(42.17%)  tps: 2,210  tflops: 17.28  mfu: 5.54%
[rank1]:2025-10-27 07:20:49,015 - INFO - ðŸ”Ž  Running validation at step 900
[rank2]:2025-10-27 07:20:49,016 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 5.6181e-01
[rank2]:2025-10-27 07:20:49,016 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.1378  memory: 16.10GiB(33.90%)  tps: 2,210  tflops: 17.28  mfu: 5.54%
[rank2]:2025-10-27 07:20:49,016 - INFO - ðŸ”Ž  Running validation at step 900
[rank3]:2025-10-27 07:20:49,023 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 7.4900e-01
[rank3]:2025-10-27 07:20:49,026 - INFO -  step: 900  loss:  0.1214  grad_norm:  0.1378  memory: 38.93GiB(81.95%)  tps: 2,210  tflops: 17.28  mfu: 5.54%
[rank3]:2025-10-27 07:20:49,026 - INFO - ðŸ”Ž  Running validation at step 900
[rank0]:2025-10-27 07:20:49,025 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 5.3145e-01
[rank0]:2025-10-27 07:20:49,025 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.1378  memory: 20.89GiB(43.97%)  tps: 2,210  tflops: 17.28  mfu: 5.54%
[rank0]:2025-10-27 07:20:49,025 - INFO - ðŸ”Ž  Running validation at step 900
[rank0]:2025-10-27 07:21:58,447 - INFO - validate step: 900  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,900
[rank1]:2025-10-27 07:21:58,527 - INFO - validate step: 900  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,893
[rank2]:2025-10-27 07:21:58,611 - INFO - validate step: 900  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,886
[rank3]:2025-10-27 07:21:58,695 - INFO - validate step: 900  loss:  0.2945  memory: 38.93GiB(81.95%)  tps: 5,879
[rank0]:2025-10-27 07:21:58,777 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_auto_dm1/freeze_ratio_history/rank0/251027_0721_stage0_step900.svg
[rank1]:2025-10-27 07:21:58,774 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_auto_dm1/freeze_ratio_history/rank1/251027_0721_stage1_step900.svg
[rank2]:2025-10-27 07:21:58,777 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_auto_dm1/freeze_ratio_history/rank2/251027_0721_stage2_step900.svg
[rank3]:2025-10-27 07:21:58,903 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1026_GPipe_auto_dm1/pipeline_schedule/251027_0721_real_step900_rank3.svg
[rank3]:> Batch Time: 1814.16 ms, GPU Bubble Ratio: 58.91%, 51.60%, 62.73%, 14.69%
[rank3]:2025-10-27 07:21:58,972 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_auto_dm1/freeze_ratio_history/rank3/251027_0721_stage3_step900.svg
[rank3]:2025-10-27 07:22:00,540 - INFO - Avg. fwd time: 72.0125 / Avg. bwd time: 120.2573 / Avg. batch time: 1586.6710 (ms) / GPU bubble ratio: 3.06%
[rank2]:2025-10-27 07:22:00,588 - INFO - Avg. fwd time: 33.1276 / Avg. bwd time: 48.3934 / Avg. batch time: 1670.6415 (ms) / GPU bubble ratio: 60.96%
[rank0]:2025-10-27 07:22:00,691 - INFO - Avg. fwd time: 45.8919 / Avg. bwd time: 49.8120 / Avg. batch time: 1865.6654 (ms) / GPU bubble ratio: 58.96%
[rank1]:2025-10-27 07:22:00,644 - INFO - Avg. fwd time: 51.4379 / Avg. bwd time: 61.9153 / Avg. batch time: 1777.8917 (ms) / GPU bubble ratio: 48.99%
[rank1]:2025-10-27 07:22:35,057 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.6012e+00
[rank2]:2025-10-27 07:22:35,057 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 7.7527e-01
[rank3]:2025-10-27 07:22:35,069 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 1.2750e+00
[rank0]:2025-10-27 07:22:35,069 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.1824e+00
[rank3]:2025-10-27 07:23:13,278 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 2.1553e+00
[rank0]:2025-10-27 07:23:13,277 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.5197e+00
[rank1]:2025-10-27 07:23:13,267 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 2.8733e+00
[rank2]:2025-10-27 07:23:13,270 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.2900e+00
[rank3]:2025-10-27 07:23:49,743 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 3.6360e+00
[rank0]:2025-10-27 07:23:49,743 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 4.5124e+00
[rank1]:2025-10-27 07:23:49,731 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 4.0865e+00
[rank2]:2025-10-27 07:23:49,731 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 4.2591e+00
[rank3]:2025-10-27 07:24:27,275 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 4.1161e-01
[rank3]:2025-10-27 07:24:27,278 - INFO -  step: 920  loss:  0.1252  grad_norm:  0.1005  memory: 38.93GiB(81.95%)  tps: 2,205  tflops: 17.24  mfu: 5.53%
[rank0]:2025-10-27 07:24:27,278 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 8.2725e-01
[rank0]:2025-10-27 07:24:27,279 - INFO -  step: 920  loss: -4.0000  grad_norm:  0.1005  memory: 20.89GiB(43.97%)  tps: 2,202  tflops: 17.21  mfu: 5.52%
[rank1]:2025-10-27 07:24:27,263 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.7110e+00
[rank1]:2025-10-27 07:24:27,264 - INFO -  step: 920  loss: -4.0000  grad_norm:  0.1005  memory: 20.03GiB(42.17%)  tps: 2,203  tflops: 17.22  mfu: 5.52%
[rank2]:2025-10-27 07:24:27,267 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 3.2463e-01
[rank2]:2025-10-27 07:24:27,268 - INFO -  step: 920  loss: -4.0000  grad_norm:  0.1005  memory: 16.10GiB(33.90%)  tps: 2,204  tflops: 17.23  mfu: 5.52%
[rank3]:2025-10-27 07:24:28,936 - INFO - Avg. fwd time: 72.0196 / Avg. bwd time: 120.2185 / Avg. batch time: 1586.3929 (ms) / GPU bubble ratio: 3.06%
[rank2]:2025-10-27 07:24:28,984 - INFO - Avg. fwd time: 33.1268 / Avg. bwd time: 48.3783 / Avg. batch time: 1670.3496 (ms) / GPU bubble ratio: 60.96%
[rank0]:2025-10-27 07:24:29,089 - INFO - Avg. fwd time: 45.8898 / Avg. bwd time: 49.6777 / Avg. batch time: 1865.0535 (ms) / GPU bubble ratio: 59.01%
[rank1]:2025-10-27 07:24:29,041 - INFO - Avg. fwd time: 51.4345 / Avg. bwd time: 61.7390 / Avg. batch time: 1777.4251 (ms) / GPU bubble ratio: 49.06%
[rank3]:2025-10-27 07:25:03,424 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 5.2591e-01
[rank0]:2025-10-27 07:25:03,424 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 4.3596e-01
[rank1]:2025-10-27 07:25:03,415 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.0350e+00
[rank2]:2025-10-27 07:25:03,413 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.3714e+00
[rank3]:2025-10-27 07:25:41,685 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 3.4961e-01
[rank0]:2025-10-27 07:25:41,689 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 3.4188e-01
[rank1]:2025-10-27 07:25:41,674 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 5.5836e-01
[rank2]:2025-10-27 07:25:41,677 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 5.6120e-01
[rank3]:2025-10-27 07:26:17,353 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 1.1560e+00
[rank0]:2025-10-27 07:26:17,353 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 3.3851e-01
[rank1]:2025-10-27 07:26:17,343 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.3618e+00
[rank2]:2025-10-27 07:26:17,341 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 8.8473e-01
[rank3]:2025-10-27 07:26:55,171 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.2209e-01
[rank3]:2025-10-27 07:26:55,174 - INFO -  step: 940  loss:  0.1066  grad_norm:  0.1201  memory: 38.93GiB(81.95%)  tps: 2,216  tflops: 17.32  mfu: 5.55%
[rank0]:2025-10-27 07:26:55,175 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 2.7493e-01
[rank0]:2025-10-27 07:26:55,175 - INFO -  step: 940  loss: -4.0000  grad_norm:  0.1201  memory: 20.89GiB(43.97%)  tps: 2,216  tflops: 17.32  mfu: 5.55%
[rank1]:2025-10-27 07:26:55,160 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 2.4733e-01
[rank1]:2025-10-27 07:26:55,161 - INFO -  step: 940  loss: -4.0000  grad_norm:  0.1201  memory: 20.03GiB(42.17%)  tps: 2,216  tflops: 17.32  mfu: 5.55%
[rank2]:2025-10-27 07:26:55,164 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.4936e-01
[rank2]:2025-10-27 07:26:55,164 - INFO -  step: 940  loss: -4.0000  grad_norm:  0.1201  memory: 16.10GiB(33.90%)  tps: 2,216  tflops: 17.32  mfu: 5.55%
[rank3]:2025-10-27 07:26:56,854 - INFO - Avg. fwd time: 72.0277 / Avg. bwd time: 120.1675 / Avg. batch time: 1586.0157 (ms) / GPU bubble ratio: 3.06%
[rank2]:2025-10-27 07:26:56,902 - INFO - Avg. fwd time: 33.1251 / Avg. bwd time: 48.3637 / Avg. batch time: 1669.9507 (ms) / GPU bubble ratio: 60.96%
[rank0]:2025-10-27 07:26:57,005 - INFO - Avg. fwd time: 45.8825 / Avg. bwd time: 49.5471 / Avg. batch time: 1864.3374 (ms) / GPU bubble ratio: 59.05%
[rank1]:2025-10-27 07:26:56,958 - INFO - Avg. fwd time: 51.4293 / Avg. bwd time: 61.5667 / Avg. batch time: 1776.8580 (ms) / GPU bubble ratio: 49.13%
[rank1]:2025-10-27 07:27:31,662 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 8.1249e-01
[rank2]:2025-10-27 07:27:31,660 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 8.4649e-01
[rank3]:2025-10-27 07:27:31,672 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 1.6375e+00
[rank0]:2025-10-27 07:27:31,672 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.6736e+00
[rank0]:2025-10-27 07:28:01,606 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-27 07:28:09,112 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 2.5283e+00
[rank2]:2025-10-27 07:28:09,116 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.1625e+00
[rank0]:2025-10-27 07:28:09,127 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.7322e+00
[rank3]:2025-10-27 07:28:09,123 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.5917e+00
[rank1]:2025-10-27 07:28:45,154 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 3.5976e+00
[rank2]:2025-10-27 07:28:45,154 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 3.0986e+00
[rank0]:2025-10-27 07:28:45,167 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 2.4269e+00
[rank3]:2025-10-27 07:28:45,166 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 3.7365e+00
[rank1]:2025-10-27 07:29:23,506 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.1051e+00
[rank1]:2025-10-27 07:29:23,507 - INFO -  step: 960  loss: -4.0000  grad_norm:  0.1588  memory: 20.03GiB(42.17%)  tps: 2,209  tflops: 17.27  mfu: 5.53%
[rank2]:2025-10-27 07:29:23,510 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 4.5058e-01
[rank2]:2025-10-27 07:29:23,510 - INFO -  step: 960  loss: -4.0000  grad_norm:  0.1588  memory: 16.10GiB(33.90%)  tps: 2,209  tflops: 17.27  mfu: 5.53%
[rank0]:2025-10-27 07:29:23,521 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 9.1476e-01
[rank0]:2025-10-27 07:29:23,522 - INFO -  step: 960  loss: -4.0000  grad_norm:  0.1588  memory: 20.89GiB(43.97%)  tps: 2,209  tflops: 17.27  mfu: 5.53%
[rank3]:2025-10-27 07:29:23,518 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 4.8488e-01
[rank3]:2025-10-27 07:29:23,521 - INFO -  step: 960  loss:  0.0878  grad_norm:  0.1588  memory: 38.93GiB(81.95%)  tps: 2,209  tflops: 17.27  mfu: 5.53%
[rank3]:2025-10-27 07:29:25,228 - INFO - Avg. fwd time: 72.0350 / Avg. bwd time: 120.1301 / Avg. batch time: 1585.7600 (ms) / GPU bubble ratio: 3.05%
[rank2]:2025-10-27 07:29:25,277 - INFO - Avg. fwd time: 33.1269 / Avg. bwd time: 48.3489 / Avg. batch time: 1669.6795 (ms) / GPU bubble ratio: 60.96%
[rank0]:2025-10-27 07:29:25,382 - INFO - Avg. fwd time: 45.8821 / Avg. bwd time: 49.4219 / Avg. batch time: 1863.7689 (ms) / GPU bubble ratio: 59.09%
[rank1]:2025-10-27 07:29:25,334 - INFO - Avg. fwd time: 51.4250 / Avg. bwd time: 61.4067 / Avg. batch time: 1776.4191 (ms) / GPU bubble ratio: 49.19%
[rank2]:2025-10-27 07:29:59,682 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.0626e+00
[rank0]:2025-10-27 07:29:59,699 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 3.4074e+00
[rank3]:2025-10-27 07:29:59,694 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 1.2166e+00
[rank1]:2025-10-27 07:29:59,682 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 3.7583e-01
[rank2]:2025-10-27 07:30:37,449 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.5168e+00
[rank0]:2025-10-27 07:30:37,461 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.7268e+00
[rank3]:2025-10-27 07:30:37,457 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.6142e+00
[rank1]:2025-10-27 07:30:37,446 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 2.0291e+00
[rank1]:2025-10-27 07:31:13,747 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 2.1958e+00
[rank2]:2025-10-27 07:31:13,746 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 4.6877e+00
[rank0]:2025-10-27 07:31:13,758 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 4.6860e+00
[rank3]:2025-10-27 07:31:13,758 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 3.3253e+00
[rank1]:2025-10-27 07:31:51,804 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 5.7779e-01
[rank1]:2025-10-27 07:31:51,804 - INFO -  step: 980  loss: -4.0000  grad_norm:  0.1270  memory: 20.03GiB(42.17%)  tps: 2,210  tflops: 17.27  mfu: 5.54%
[rank2]:2025-10-27 07:31:51,807 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 5.2218e-01
[rank2]:2025-10-27 07:31:51,808 - INFO -  step: 980  loss: -4.0000  grad_norm:  0.1270  memory: 16.10GiB(33.90%)  tps: 2,210  tflops: 17.27  mfu: 5.54%
[rank0]:2025-10-27 07:31:51,815 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.1213e+00
[rank0]:2025-10-27 07:31:51,816 - INFO -  step: 980  loss: -4.0000  grad_norm:  0.1270  memory: 20.89GiB(43.97%)  tps: 2,210  tflops: 17.27  mfu: 5.54%
[rank3]:2025-10-27 07:31:51,815 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 3.6935e-01
[rank3]:2025-10-27 07:31:51,818 - INFO -  step: 980  loss:  0.0993  grad_norm:  0.1270  memory: 38.93GiB(81.95%)  tps: 2,210  tflops: 17.27  mfu: 5.54%
[rank3]:2025-10-27 07:31:53,455 - INFO - Avg. fwd time: 72.0319 / Avg. bwd time: 120.0975 / Avg. batch time: 1585.4808 (ms) / GPU bubble ratio: 3.06%
[rank2]:2025-10-27 07:31:53,503 - INFO - Avg. fwd time: 33.1231 / Avg. bwd time: 48.3350 / Avg. batch time: 1669.3852 (ms) / GPU bubble ratio: 60.96%
[rank1]:2025-10-27 07:31:53,559 - INFO - Avg. fwd time: 51.4241 / Avg. bwd time: 61.2525 / Avg. batch time: 1775.9684 (ms) / GPU bubble ratio: 49.24%
[rank0]:2025-10-27 07:31:53,607 - INFO - Avg. fwd time: 45.8807 / Avg. bwd time: 49.3037 / Avg. batch time: 1863.1831 (ms) / GPU bubble ratio: 59.13%
[rank2]:2025-10-27 07:32:27,597 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.7709e+00
[rank0]:2025-10-27 07:32:27,613 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 4.2897e+00
[rank3]:2025-10-27 07:32:27,609 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 4.2586e+00
[rank1]:2025-10-27 07:32:27,597 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 2.7257e+00
[rank3]:2025-10-27 07:33:05,657 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.3841e+00
[rank1]:2025-10-27 07:33:05,647 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 2.7337e+00
[rank0]:2025-10-27 07:33:05,660 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.3467e+00
[rank2]:2025-10-27 07:33:05,654 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.2769e+00
[rank3]:2025-10-27 07:33:41,939 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 5.1422e+00
[rank1]:2025-10-27 07:33:41,927 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 4.6195e+00
[rank0]:2025-10-27 07:33:41,942 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 4.7574e+00
[rank2]:2025-10-27 07:33:41,927 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 6.1415e+00
[rank0]:2025-10-27 07:34:11,995 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-27 07:34:19,541 - INFO - Freezing Ratio: [Stage0] 0.73, Threshold: 1.0196e+00
[rank0]:2025-10-27 07:34:19,542 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0869  memory: 20.89GiB(43.97%)  tps: 2,218  tflops: 17.34  mfu: 5.56%
[rank0]:2025-10-27 07:34:19,542 - INFO -  final step: 1000  loss: -4.0000  grad_norm:  0.0869  tps: 2,214  tflops: 17.31  mfu: 5.38%
[rank0]:2025-10-27 07:34:19,542 - INFO - ðŸ”Ž  Running validation at step 1000
[rank2]:2025-10-27 07:34:19,529 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.4738e+00
[rank2]:2025-10-27 07:34:19,530 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0869  memory: 16.10GiB(33.90%)  tps: 2,218  tflops: 17.34  mfu: 5.56%
[rank2]:2025-10-27 07:34:19,530 - INFO -  final step: 1000  loss: -4.0000  grad_norm:  0.0869  tps: 2,214  tflops: 17.31  mfu: 5.38%
[rank2]:2025-10-27 07:34:19,530 - INFO - ðŸ”Ž  Running validation at step 1000
[rank3]:2025-10-27 07:34:19,537 - INFO - Freezing Ratio: [Stage3] 0.62, Threshold: 1.2508e+00
[rank3]:2025-10-27 07:34:19,540 - INFO -  step: 1000  loss:  0.1070  grad_norm:  0.0869  memory: 38.93GiB(81.95%)  tps: 2,218  tflops: 17.34  mfu: 5.56%
[rank3]:2025-10-27 07:34:19,541 - INFO -  final step: 1000  loss:  0.1070  grad_norm:  0.0869  tps: 2,215  tflops: 17.32  mfu: 5.39%
[rank3]:2025-10-27 07:34:19,541 - INFO - ðŸ”Ž  Running validation at step 1000
[rank1]:2025-10-27 07:34:19,526 - INFO - Freezing Ratio: [Stage1] 0.60, Threshold: 1.9470e+00
[rank1]:2025-10-27 07:34:19,527 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0869  memory: 20.03GiB(42.17%)  tps: 2,218  tflops: 17.34  mfu: 5.56%
[rank1]:2025-10-27 07:34:19,527 - INFO -  final step: 1000  loss: -4.0000  grad_norm:  0.0869  tps: 2,214  tflops: 17.31  mfu: 5.38%
[rank1]:2025-10-27 07:34:19,527 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-10-27 07:35:28,547 - INFO - validate step: 1000  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,936
[rank0]:2025-10-27 07:35:28,548 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-27 07:35:28,551 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1000.
[rank1]:2025-10-27 07:35:28,629 - INFO - validate step: 1000  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,927
[rank1]:2025-10-27 07:35:28,630 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-27 07:35:28,632 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1000.
[rank2]:2025-10-27 07:35:28,710 - INFO - validate step: 1000  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,921
[rank2]:2025-10-27 07:35:28,711 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-27 07:35:28,713 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1000.
[rank3]:2025-10-27 07:35:28,792 - INFO - validate step: 1000  loss:  0.2951  memory: 38.93GiB(81.95%)  tps: 5,915
[rank3]:2025-10-27 07:35:28,793 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-27 07:35:28,795 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1000.
[rank0]:2025-10-27 07:35:31,652 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank0]:2025-10-27 07:35:31,742 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_auto_dm1/freeze_ratio_history/rank0/251027_0735_stage0_final1000.svg
[rank2]:2025-10-27 07:35:31,738 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_auto_dm1/freeze_ratio_history/rank2/251027_0735_stage2_final1000.svg
[rank1]:2025-10-27 07:35:31,741 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_auto_dm1/freeze_ratio_history/rank1/251027_0735_stage1_final1000.svg
[rank3]:2025-10-27 07:35:31,862 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1026_GPipe_auto_dm1/pipeline_schedule/251027_0735_real_final1000_rank3.svg
[rank3]:> Batch Time: 1811.72 ms, GPU Bubble Ratio: 58.96%, 51.91%, 62.70%, 14.62%
[rank1]:2025-10-27 07:35:31,945 - INFO - Elementwise Histogram is saved as: /data3/shcho/torchtitan/images/1026_GPipe_auto_dm1/frozen_params_histogram/251027_0735_rank1_stage1.svg
[rank1]:	> Counts Sum: 3033, Total Sum: 8190 (37.03%), Ratio(%) per element: [78.02, 78.02, 78.02, 78.02, 78.02, 78.02, 78.02, 78.02, 78.02, 78.02, 78.02, 78.02, 78.02, 78.02, 78.02, 78.02, 78.02, 78.02, 29.12, 29.12, 29.12, 29.12, 29.12, 29.12, 29.12, 29.12, 29.12, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-10-27 07:35:31,945 - INFO - Destroying the purge thread.
[rank0]:2025-10-27 07:35:31,960 - INFO - Elementwise Histogram is saved as: /data3/shcho/torchtitan/images/1026_GPipe_auto_dm1/frozen_params_histogram/251027_0735_rank0_stage0.svg
[rank0]:	> Counts Sum: 3069, Total Sum: 6734 (45.57%), Ratio(%) per element: [0.0, 79.12, 79.12, 79.12, 79.12, 79.12, 79.12, 79.12, 79.12, 79.12, 78.57, 78.57, 78.57, 78.57, 78.57, 78.57, 78.57, 78.57, 78.57, 29.67, 29.67, 29.67, 29.67, 29.67, 29.67, 29.67, 29.67, 29.67, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-10-27 07:35:31,960 - INFO - Sleeping 2 seconds for other ranks to complete
[rank2]:2025-10-27 07:35:31,954 - INFO - Elementwise Histogram is saved as: /data3/shcho/torchtitan/images/1026_GPipe_auto_dm1/frozen_params_histogram/251027_0735_rank2_stage2.svg
[rank2]:	> Counts Sum: 1620, Total Sum: 6552 (24.73%), Ratio(%) per element: [49.45, 49.45, 49.45, 49.45, 49.45, 49.45, 49.45, 49.45, 49.45, 49.45, 49.45, 49.45, 49.45, 49.45, 49.45, 49.45, 49.45, 49.45, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-10-27 07:35:31,954 - INFO - Destroying the purge thread.
[rank3]:2025-10-27 07:35:32,056 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1026_GPipe_auto_dm1/pipeline_schedule/251027_0735_thry_final1000_rank3.svg
[rank3]:> Batch Time: 1677.38 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:2025-10-27 07:35:32,125 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_auto_dm1/freeze_ratio_history/rank3/251027_0735_stage3_final1000.svg
[rank1]:2025-10-27 07:35:32,218 - INFO - Process group destroyed
[rank2]:2025-10-27 07:35:32,189 - INFO - Process group destroyed
[rank3]:2025-10-27 07:35:32,314 - INFO - Elementwise Histogram is saved as: /data3/shcho/torchtitan/images/1026_GPipe_auto_dm1/frozen_params_histogram/251027_0735_rank3_stage3.svg
[rank3]:	> Counts Sum: 2331, Total Sum: 5278 (44.16%), Ratio(%) per element: [95.6, 95.6, 95.6, 95.6, 95.6, 95.6, 95.6, 95.6, 95.6, 46.7, 46.7, 46.7, 46.7, 46.7, 46.7, 46.7, 46.7, 46.7, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-10-27 07:35:32,315 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading history steps 50-50, summary, console lines 524-531
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ƒâ–ˆâ–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ƒâ–ˆâ–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–‚â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 7.39633
[rank3]:wandb:               final/avg_loss 0.10696
[rank3]:wandb:             final/avg_mfu(%) 5.38825
[rank3]:wandb:             final/avg_tflops 17.31705
[rank3]:wandb:    final/avg_throughput(tps) 2215.154
[rank3]:wandb:              final/grad_norm 0.0869
[rank3]:wandb:               final/max_loss 0.10696
[rank3]:wandb:                    grad_norm 0.0869
[rank3]:wandb: loss_metrics/global_avg_loss 0.10696
[rank3]:wandb: loss_metrics/global_max_loss 0.10696
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1026_GPipe_auto_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/st9uunkz
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data3/shcho/torchtitan/tb/1026_GPipe_auto_dm1/20251027-0518/wandb/run-20251027_051809-st9uunkz/logs
[rank3]:2025-10-27 07:35:33,703 - INFO - Process group destroyed
[rank0]:2025-10-27 07:35:33,960 - INFO - Training completed
[rank0]:2025-10-27 07:35:33,961 - INFO - Destroying the purge thread.
[rank0]:2025-10-27 07:35:34,484 - INFO - Process group destroyed
[rank2]:Stage 2: Modules to keep: {'layers.11', 'layers.10', 'layers.9', 'layers.12'}
[rank1]:Stage 1: Modules to keep: {'layers.7', 'layers.6', 'layers.4', 'layers.5', 'layers.8'}
[rank0]:Stage 0: Modules to keep: {'layers.3', 'tok_embeddings', 'layers.0', 'layers.2', 'layers.1'}
[rank3]:Stage 3: Modules to keep: {'layers.13', 'layers.15', 'layers.14', 'norm', 'output'}
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1026_llama1b/config.toml
[rank3]:		- dump_folder: /data3/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1026_GPipe_auto_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data3/shcho/torchtitan/profile_trace/1026_GPipe_auto_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data3/shcho/torchtitan/memory_snapshot/1026_GPipe_auto_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 20
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data3/shcho/torchtitan/tb/1026_GPipe_auto_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data3/shcho/torchtitan/images/1026_GPipe_auto_dm1
[rank3]:		- pplog_freq: 80
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1026_GPipe_auto_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B-Instruct
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 2e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: alpaca
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 1000
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: GPipe
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data3/shcho/torchtitan/checkpoint/1026_GPipe_auto_dm1
[rank3]:		- interval: 500
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B-Instruct/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data3/shcho/torchtitan/comm_traces/1026_GPipe_auto_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: True
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- seq_len: 1024
[rank3]:		- freq: 100
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: auto
[rank3]:		- phase_unit: 10
[rank3]:		- stability_check_freq: 5
[rank3]:		- aggressiveness: 0
[rank3]:
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
