
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 10. 27. (ì›”) 07:35:36 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 3,4,5,6
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1026_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1026_llama1b/1026_GPipe_fullrand7.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation
âœ”ï¸Running with fullrand7 x GPipe ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1026_llama1b/config.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=fullrand7
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank0]:2025-10-27 07:35:42,843 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation"
[rank3]:2025-10-27 07:35:42,843 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation"
[rank1]:2025-10-27 07:35:42,983 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation"
[rank2]:2025-10-27 07:35:43,079 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation"
[rank0]:2025-10-27 07:35:43,069 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-10-27 07:35:43,071 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-27 07:35:43,073 - INFO - [GC] Initial GC collection 0.00 seconds
[rank3]:2025-10-27 07:35:43,060 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-10-27 07:35:43,062 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-10-27 07:35:43,227 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-10-27 07:35:43,230 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-10-27 07:35:43,294 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-10-27 07:35:43,297 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-27 07:35:43,590 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-10-27 07:35:43,976 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank0]:2025-10-27 07:35:46,855 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank2]:2025-10-27 07:35:47,033 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-10-27 07:35:46,999 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-10-27 07:35:47,039 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-10-27 07:35:47,040 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank1]:2025-10-27 07:35:47,041 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-10-27 07:35:47,078 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-10-27 07:35:47,104 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-10-27 07:35:47,105 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-10-27 07:35:47,066 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-10-27 07:35:47,066 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2025-10-27 07:35:47,081 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-10-27 07:35:47,106 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-10-27 07:35:47,106 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank2]:2025-10-27 07:35:47,282 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-10-27 07:35:47,283 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-10-27 07:35:47,283 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank0]:2025-10-27 07:35:47,264 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-10-27 07:35:47,264 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-10-27 07:35:47,265 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank1]:2025-10-27 07:35:47,291 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-10-27 07:35:47,291 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-10-27 07:35:47,292 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run otlayoet
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data3/shcho/torchtitan/tb/1026_GPipe_fullrand7_dm1/20251027-0735/wandb/run-20251027_073548-otlayoet
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1026_GPipe_fullrand7_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/otlayoet
[rank3]:2025-10-27 07:35:49,380 - INFO - WandB logging enabled
[rank3]:2025-10-27 07:35:49,381 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-10-27 07:35:49,421 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-10-27 07:35:49,452 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-10-27 07:35:49,452 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank3]:2025-10-27 07:35:50,281 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-10-27 07:35:50,282 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-10-27 07:35:50,283 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank0]:2025-10-27 07:35:50,296 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data3/shcho/torchtitan/checkpoint/1026_GPipe_fullrand7_dm1
[rank0]:2025-10-27 07:35:50,296 - WARNING - Mixed precision training with TP or PP is only supported when FSDP/HSDP/CP is enabled.
[rank0]:2025-10-27 07:35:50,296 - INFO - Mixed precision training is disabled
[rank0]:2025-10-27 07:35:50,297 - INFO - Preparing c4_validation dataset from allenai/c4
[rank0]:2025-10-27 07:35:55,847 - INFO - Trainer is initialized with local batch size 16, global batch size 64, gradient accumulation steps 4, sequence length 1024, total steps 1000 (warmup 100)
[rank0]:2025-10-27 07:35:55,847 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B-Instruct/original_dcp.
[rank0]:2025-10-27 07:35:58,039 - INFO - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-10-27 07:35:58,039 - INFO - Finished loading the checkpoint in 2.19 seconds.
[rank0]:2025-10-27 07:35:58,039 - INFO - Training starts at step 1
[rank0]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/autograd/graph.py:849: UserWarning: Attempting to run cuBLAS, but there was no current CUDA context! Attempting to set the primary context... (Triggered internally at /pytorch/aten/src/ATen/cuda/CublasHandlePool.cpp:270.)
[rank0]:  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
[rank2]:2025-10-27 07:36:09,687 - INFO -  step:  1  loss: -4.0000  grad_norm: 43.3594  memory: 14.29GiB(30.07%)  tps: 725  tflops: 5.67  mfu: 1.82%
[rank2]:2025-10-27 07:36:09,687 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-27 07:36:09,696 - INFO -  step:  1  loss:  1.2134  grad_norm: 43.3594  memory: 35.59GiB(74.92%)  tps: 808  tflops: 6.32  mfu: 2.03%
[rank3]:2025-10-27 07:36:09,697 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-10-27 07:36:09,690 - INFO -  step:  1  loss: -4.0000  grad_norm: 43.3594  memory: 17.77GiB(37.40%)  tps: 725  tflops: 5.67  mfu: 1.82%
[rank1]:2025-10-27 07:36:09,690 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-10-27 07:36:09,728 - INFO -  step:  1  loss: -4.0000  grad_norm: 43.3594  memory: 17.10GiB(35.99%)  tps: 722  tflops: 5.65  mfu: 1.81%
[rank0]:2025-10-27 07:36:09,729 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-27 07:36:23,026 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 07:36:23,027 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 07:36:23,027 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 07:36:23,027 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 07:36:23,027 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 07:36:23,028 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 07:36:23,028 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 07:36:23,028 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 07:36:23,028 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 07:36:23,029 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 07:36:23,029 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 07:36:23,029 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 07:36:23,029 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 07:36:23,030 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 07:36:23,030 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 07:36:23,030 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 07:36:23,085 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 07:36:23,085 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 07:36:23,085 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 07:36:23,086 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 07:36:23,086 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 07:36:23,086 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 07:36:23,086 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 07:36:23,086 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 07:36:23,086 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 07:36:23,086 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 07:36:23,086 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 07:36:23,086 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 07:36:23,086 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 07:36:23,086 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 07:36:23,086 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 07:36:23,086 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 07:36:23,164 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 07:36:23,164 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 07:36:23,165 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 07:36:23,165 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 07:36:23,165 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 07:36:23,165 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 07:36:23,165 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 07:36:23,165 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 07:36:23,165 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 07:36:23,165 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 07:36:23,165 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 07:36:23,165 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 07:36:23,165 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 07:36:23,165 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 07:36:23,165 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 07:36:23,165 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 07:36:23,225 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 07:36:23,226 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 07:36:23,226 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 07:36:23,226 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 07:36:23,226 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 07:36:23,226 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 07:36:23,226 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 07:36:23,226 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 07:36:23,226 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 07:36:23,226 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 07:36:23,226 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 07:36:23,226 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 07:36:23,226 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 07:36:23,226 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 07:36:23,226 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 07:36:23,226 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 07:38:40,351 - INFO -  step: 20  loss: -4.0000  grad_norm: 132.7754  memory: 20.03GiB(42.17%)  tps: 2,066  tflops: 16.15  mfu: 5.18%
[rank2]:2025-10-27 07:38:40,347 - INFO -  step: 20  loss: -4.0000  grad_norm: 132.7754  memory: 16.10GiB(33.90%)  tps: 2,066  tflops: 16.15  mfu: 5.18%
[rank3]:2025-10-27 07:38:40,359 - INFO -  step: 20  loss:  3.8421  grad_norm: 132.7754  memory: 38.93GiB(81.95%)  tps: 2,066  tflops: 16.15  mfu: 5.18%
[rank0]:2025-10-27 07:38:40,369 - INFO -  step: 20  loss: -4.0000  grad_norm: 132.7754  memory: 20.89GiB(43.97%)  tps: 2,066  tflops: 16.15  mfu: 5.18%
[rank3]:2025-10-27 07:38:42,146 - INFO - Avg. fwd time: 70.4606 / Avg. bwd time: 127.4422 / Avg. batch time: 1651.3024 (ms) / GPU bubble ratio: 4.12%
[rank2]:2025-10-27 07:38:42,208 - INFO - Avg. fwd time: 32.6434 / Avg. bwd time: 53.0067 / Avg. batch time: 1740.6483 (ms) / GPU bubble ratio: 60.64%
[rank1]:2025-10-27 07:38:42,285 - INFO - Avg. fwd time: 50.9684 / Avg. bwd time: 72.5352 / Avg. batch time: 1859.6528 (ms) / GPU bubble ratio: 46.87%
[rank0]:2025-10-27 07:38:42,348 - INFO - Avg. fwd time: 45.1389 / Avg. bwd time: 59.5570 / Avg. batch time: 1957.1597 (ms) / GPU bubble ratio: 57.20%
[rank1]:2025-10-27 07:41:21,220 - INFO -  step: 40  loss: -4.0000  grad_norm:  0.6223  memory: 20.03GiB(42.17%)  tps: 2,037  tflops: 15.92  mfu: 5.10%
[rank3]:2025-10-27 07:41:21,228 - INFO -  step: 40  loss:  0.1930  grad_norm:  0.6223  memory: 38.93GiB(81.95%)  tps: 2,037  tflops: 15.92  mfu: 5.10%
[rank0]:2025-10-27 07:41:21,241 - INFO -  step: 40  loss: -4.0000  grad_norm:  0.6223  memory: 20.89GiB(43.97%)  tps: 2,037  tflops: 15.92  mfu: 5.10%
[rank2]:2025-10-27 07:41:21,216 - INFO -  step: 40  loss: -4.0000  grad_norm:  0.6223  memory: 16.10GiB(33.90%)  tps: 2,037  tflops: 15.92  mfu: 5.10%
[rank3]:2025-10-27 07:41:23,037 - INFO - Avg. fwd time: 71.5562 / Avg. bwd time: 129.3355 / Avg. batch time: 1665.3291 (ms) / GPU bubble ratio: 3.49%
[rank2]:2025-10-27 07:41:23,097 - INFO - Avg. fwd time: 33.0343 / Avg. bwd time: 53.7456 / Avg. batch time: 1755.1808 (ms) / GPU bubble ratio: 60.45%
[rank1]:2025-10-27 07:41:23,177 - INFO - Avg. fwd time: 50.9110 / Avg. bwd time: 73.3268 / Avg. batch time: 1874.9911 (ms) / GPU bubble ratio: 46.99%
[rank0]:2025-10-27 07:41:23,240 - INFO - Avg. fwd time: 45.4054 / Avg. bwd time: 60.1692 / Avg. batch time: 1973.4158 (ms) / GPU bubble ratio: 57.20%
[rank0]:2025-10-27 07:42:34,217 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-27 07:44:01,949 - INFO -  step: 60  loss: -4.0000  grad_norm:  0.6547  memory: 20.03GiB(42.17%)  tps: 2,039  tflops: 15.94  mfu: 5.11%
[rank3]:2025-10-27 07:44:01,958 - INFO -  step: 60  loss:  0.1770  grad_norm:  0.6547  memory: 38.93GiB(81.95%)  tps: 2,039  tflops: 15.94  mfu: 5.11%
[rank0]:2025-10-27 07:44:01,965 - INFO -  step: 60  loss: -4.0000  grad_norm:  0.6547  memory: 20.89GiB(43.97%)  tps: 2,039  tflops: 15.94  mfu: 5.11%
[rank2]:2025-10-27 07:44:01,945 - INFO -  step: 60  loss: -4.0000  grad_norm:  0.6547  memory: 16.10GiB(33.90%)  tps: 2,039  tflops: 15.94  mfu: 5.11%
[rank3]:2025-10-27 07:44:03,772 - INFO - Avg. fwd time: 71.8210 / Avg. bwd time: 130.0187 / Avg. batch time: 1669.7514 (ms) / GPU bubble ratio: 3.30%
[rank2]:2025-10-27 07:44:03,830 - INFO - Avg. fwd time: 33.1975 / Avg. bwd time: 53.9994 / Avg. batch time: 1759.6846 (ms) / GPU bubble ratio: 60.36%
[rank1]:2025-10-27 07:44:03,912 - INFO - Avg. fwd time: 51.2922 / Avg. bwd time: 73.5053 / Avg. batch time: 1879.5180 (ms) / GPU bubble ratio: 46.88%
[rank0]:2025-10-27 07:44:03,975 - INFO - Avg. fwd time: 45.5647 / Avg. bwd time: 60.3539 / Avg. batch time: 1978.1875 (ms) / GPU bubble ratio: 57.17%
[rank1]:2025-10-27 07:46:42,762 - INFO -  step: 80  loss: -4.0000  grad_norm:  3.0593  memory: 20.03GiB(42.17%)  tps: 2,038  tflops: 15.93  mfu: 5.11%
[rank3]:2025-10-27 07:46:42,771 - INFO -  step: 80  loss:  0.1455  grad_norm:  3.0593  memory: 38.93GiB(81.95%)  tps: 2,038  tflops: 15.93  mfu: 5.11%
[rank0]:2025-10-27 07:46:42,778 - INFO -  step: 80  loss: -4.0000  grad_norm:  3.0593  memory: 20.89GiB(43.97%)  tps: 2,038  tflops: 15.93  mfu: 5.11%
[rank2]:2025-10-27 07:46:42,759 - INFO -  step: 80  loss: -4.0000  grad_norm:  3.0593  memory: 16.10GiB(33.90%)  tps: 2,038  tflops: 15.93  mfu: 5.11%
[rank3]:2025-10-27 07:46:44,586 - INFO - Avg. fwd time: 71.9630 / Avg. bwd time: 130.3793 / Avg. batch time: 1672.2087 (ms) / GPU bubble ratio: 3.20%
[rank2]:2025-10-27 07:46:44,646 - INFO - Avg. fwd time: 33.2986 / Avg. bwd time: 54.0519 / Avg. batch time: 1762.1948 (ms) / GPU bubble ratio: 60.34%
[rank1]:2025-10-27 07:46:44,730 - INFO - Avg. fwd time: 51.5782 / Avg. bwd time: 73.7552 / Avg. batch time: 1882.1092 (ms) / GPU bubble ratio: 46.73%
[rank0]:2025-10-27 07:46:44,798 - INFO - Avg. fwd time: 45.5039 / Avg. bwd time: 60.5219 / Avg. batch time: 1980.8965 (ms) / GPU bubble ratio: 57.18%
[rank3]:2025-10-27 07:48:42,106 - INFO - [Step 95] ã€°ï¸ Monitoring Upperbound
[rank0]:2025-10-27 07:49:14,898 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-27 07:49:21,975 - INFO - [Step 100] âœ”ï¸  Setting Upperbound
[rank1]:2025-10-27 07:49:22,784 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.6348  memory: 20.03GiB(42.17%)  tps: 2,048  tflops: 16.01  mfu: 5.13%
[rank1]:2025-10-27 07:49:22,784 - INFO - ðŸ”Ž  Running validation at step 100
[rank0]:2025-10-27 07:49:22,784 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.6348  memory: 20.89GiB(43.97%)  tps: 2,048  tflops: 16.01  mfu: 5.13%
[rank0]:2025-10-27 07:49:22,785 - INFO - ðŸ”Ž  Running validation at step 100
[rank3]:2025-10-27 07:49:22,782 - INFO - [Step 100] ã€°ï¸ Monitoring Lowerbound
[rank3]:2025-10-27 07:49:22,785 - INFO -  step: 100  loss:  0.1419  grad_norm:  0.6348  memory: 38.93GiB(81.95%)  tps: 2,048  tflops: 16.01  mfu: 5.13%
[rank3]:2025-10-27 07:49:22,790 - INFO - ðŸ”Ž  Running validation at step 100
[rank2]:2025-10-27 07:49:22,784 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.6348  memory: 16.10GiB(33.90%)  tps: 2,048  tflops: 16.01  mfu: 5.13%
[rank2]:2025-10-27 07:49:22,790 - INFO - ðŸ”Ž  Running validation at step 100
[rank0]:2025-10-27 07:50:33,462 - INFO - validate step: 100  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,795
[rank1]:2025-10-27 07:50:33,544 - INFO - validate step: 100  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,789
[rank2]:2025-10-27 07:50:33,623 - INFO - validate step: 100  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,783
[rank3]:2025-10-27 07:50:33,706 - INFO - validate step: 100  loss:  0.2970  memory: 38.93GiB(81.95%)  tps: 5,776
[rank1]:2025-10-27 07:50:33,798 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251027_0750_stage1_step100.svg
[rank0]:2025-10-27 07:50:33,790 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251027_0750_stage0_step100.svg
[rank0]:2025-10-27 07:50:33,834 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-27 07:50:33,788 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251027_0750_stage2_step100.svg
[rank2]:2025-10-27 07:50:33,833 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-27 07:50:33,852 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-27 07:50:33,894 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-27 07:50:33,853 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-27 07:50:33,865 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-27 07:50:33,851 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-27 07:50:33,939 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-27 07:50:33,940 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1026_GPipe_fullrand7_dm1/pipeline_schedule/251027_0750_real_step100_rank3.svg
[rank3]:> Batch Time: 1933.53 ms, GPU Bubble Ratio: 55.92%, 47.35%, 64.03%, 15.57%
[rank3]:2025-10-27 07:50:34,009 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251027_0750_stage3_step100.svg
[rank2]:2025-10-27 07:50:34,032 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-27 07:50:34,104 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-27 07:50:34,043 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-27 07:50:34,053 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-27 07:50:34,070 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-27 07:50:34,083 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-27 07:50:34,093 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-27 07:50:34,139 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-27 07:50:34,185 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-27 07:50:34,172 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-27 07:50:34,263 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-27 07:50:34,332 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-27 07:50:34,347 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-27 07:50:34,432 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-27 07:50:34,513 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-27 07:50:34,496 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-27 07:50:34,747 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-27 07:50:34,813 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-27 07:50:34,883 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-27 07:50:35,012 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-27 07:50:34,939 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-27 07:50:34,942 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-27 07:50:35,071 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-27 07:50:35,133 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-27 07:50:35,649 - INFO - Avg. fwd time: 71.8969 / Avg. bwd time: 130.4837 / Avg. batch time: 1671.5179 (ms) / GPU bubble ratio: 3.14%
[rank2]:2025-10-27 07:50:35,703 - INFO - Avg. fwd time: 33.2952 / Avg. bwd time: 54.1014 / Avg. batch time: 1761.7820 (ms) / GPU bubble ratio: 60.31%
[rank1]:2025-10-27 07:50:35,778 - INFO - Avg. fwd time: 51.5657 / Avg. bwd time: 73.7303 / Avg. batch time: 1881.6419 (ms) / GPU bubble ratio: 46.73%
[rank0]:2025-10-27 07:50:35,832 - INFO - Avg. fwd time: 45.5342 / Avg. bwd time: 60.4961 / Avg. batch time: 1980.4451 (ms) / GPU bubble ratio: 57.17%
[rank3]:2025-10-27 07:51:01,305 - INFO - [Step 105] âœ”ï¸  Setting Lowerbound
[rank3]:2025-10-27 07:51:02,236 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1026_GPipe_fullrand7_dm1/pipeline_schedule/251027_0751_max_batch_time.svg
[rank3]:> Batch Time: 1945.53 ms, GPU Bubble Ratio: 56.11%, 47.53%, 64.01%, 15.66%
[rank3]:2025-10-27 07:51:02,430 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1026_GPipe_fullrand7_dm1/pipeline_schedule/251027_0751_min_batch_time.svg
[rank3]:> Batch Time: 1321.17 ms, GPU Bubble Ratio: 71.45%, 44.18%, 62.41%, 13.78%
[rank3]:2025-10-27 07:51:02,639 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1026_GPipe_fullrand7_dm1/pipeline_schedule/251027_0751_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 1321.17 ms, GPU Bubble Ratio: 42.67%, 30.25%, 48.95%, 13.78%
[rank3]:2025-10-27 07:51:02,639 - INFO - 	> Batch Time: 1321.17 ms (Average Freeze Ratio: 0.42, Time Reduction Rate: 0.32)
[rank3]:2025-10-27 07:52:27,465 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank2]:2025-10-27 07:52:28,069 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-27 07:52:28,147 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.62/0.62, [MB7] 1.00/1.00
[rank0]:2025-10-27 07:52:28,150 - INFO -  step: 120  loss: -4.0000  grad_norm:  0.0498  memory: 20.89GiB(43.97%)  tps: 2,857  tflops: 22.34  mfu: 7.16%
[rank1]:2025-10-27 07:52:28,111 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.55/0.55, [MB4] 0.00/0.00, [MB5] 0.30/0.30, [MB6] 0.88/0.88, [MB7] 1.00/1.00
[rank1]:2025-10-27 07:52:28,146 - INFO -  step: 120  loss: -4.0000  grad_norm:  0.0498  memory: 20.03GiB(42.17%)  tps: 2,859  tflops: 22.35  mfu: 7.16%
[rank2]:2025-10-27 07:52:28,148 - INFO -  step: 120  loss: -4.0000  grad_norm:  0.0498  memory: 16.10GiB(33.90%)  tps: 2,861  tflops: 22.37  mfu: 7.17%
[rank3]:2025-10-27 07:52:28,149 - INFO -  step: 120  loss:  0.1358  grad_norm:  0.0498  memory: 38.93GiB(81.95%)  tps: 2,863  tflops: 22.38  mfu: 7.17%
[rank3]:2025-10-27 07:52:29,467 - INFO - Avg. fwd time: 71.9660 / Avg. bwd time: 120.6717 / Avg. batch time: 1592.6744 (ms) / GPU bubble ratio: 3.24%
[rank1]:2025-10-27 07:52:29,547 - INFO - Avg. fwd time: 51.6592 / Avg. bwd time: 68.2327 / Avg. batch time: 1794.5070 (ms) / GPU bubble ratio: 46.55%
[rank2]:2025-10-27 07:52:29,504 - INFO - Avg. fwd time: 33.2905 / Avg. bwd time: 50.4268 / Avg. batch time: 1680.1695 (ms) / GPU bubble ratio: 60.14%
[rank0]:2025-10-27 07:52:29,585 - INFO - Avg. fwd time: 45.5405 / Avg. bwd time: 53.0442 / Avg. batch time: 1885.6189 (ms) / GPU bubble ratio: 58.17%
[rank0]:2025-10-27 07:54:18,087 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1026_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251027_0754_rank0_trend_line.svg
[rank0]:2025-10-27 07:54:18,095 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-27 07:54:18,096 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-27 07:54:18,096 - INFO -  step: 140  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,980  tflops: 23.30  mfu: 7.47%
[rank1]:2025-10-27 07:54:18,082 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1026_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251027_0754_rank1_trend_line.svg
[rank1]:2025-10-27 07:54:18,094 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank1]:2025-10-27 07:54:18,094 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank1]:2025-10-27 07:54:18,095 - INFO -  step: 140  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,980  tflops: 23.30  mfu: 7.47%
[rank3]:2025-10-27 07:54:18,058 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1026_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251027_0754_rank3_trend_line.svg
[rank2]:2025-10-27 07:54:18,058 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1026_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251027_0754_rank2_trend_line.svg
[rank2]:2025-10-27 07:54:18,093 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-27 07:54:18,094 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-27 07:54:18,094 - INFO -  step: 140  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,980  tflops: 23.30  mfu: 7.47%
[rank3]:2025-10-27 07:54:18,291 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1026_GPipe_fullrand7_dm1/pipeline_schedule/251027_0754_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 1317.62 ms, GPU Bubble Ratio: 65.43%, 43.34%, 61.11%, 14.60%
[rank3]:2025-10-27 07:54:18,292 - INFO - 	> Batch Time: 1317.62 ms (Average Freeze Ratio: 0.31)
[rank3]:2025-10-27 07:54:18,292 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-27 07:54:18,293 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-27 07:54:18,295 - INFO -  step: 140  loss:  0.1444  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,975  tflops: 23.26  mfu: 7.45%
[rank2]:2025-10-27 07:54:19,537 - INFO - Avg. fwd time: 33.2795 / Avg. bwd time: 47.3619 / Avg. batch time: 1617.5400 (ms) / GPU bubble ratio: 60.12%
[rank3]:2025-10-27 07:54:19,503 - INFO - Avg. fwd time: 72.0812 / Avg. bwd time: 113.1840 / Avg. batch time: 1533.2139 (ms) / GPU bubble ratio: 3.33%
[rank0]:2025-10-27 07:54:19,583 - INFO - Avg. fwd time: 45.5219 / Avg. bwd time: 45.4803 / Avg. batch time: 1811.0554 (ms) / GPU bubble ratio: 59.80%
[rank1]:2025-10-27 07:54:19,580 - INFO - Avg. fwd time: 51.8881 / Avg. bwd time: 64.0256 / Avg. batch time: 1727.8550 (ms) / GPU bubble ratio: 46.33%
[rank0]:2025-10-27 07:55:15,061 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-27 07:56:25,373 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1026_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251027_0756_rank3_trend_line.svg
[rank2]:2025-10-27 07:56:25,371 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1026_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251027_0756_rank2_trend_line.svg
[rank2]:2025-10-27 07:56:25,397 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-27 07:56:25,398 - INFO -  step: 160  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,574  tflops: 20.12  mfu: 6.45%
[rank0]:2025-10-27 07:56:25,384 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1026_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251027_0756_rank0_trend_line.svg
[rank0]:2025-10-27 07:56:25,397 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-27 07:56:25,398 - INFO -  step: 160  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,574  tflops: 20.12  mfu: 6.45%
[rank1]:2025-10-27 07:56:25,391 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1026_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251027_0756_rank1_trend_line.svg
[rank1]:2025-10-27 07:56:25,398 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-10-27 07:56:25,399 - INFO -  step: 160  loss: -4.0000  grad_norm:  0.0657  memory: 20.03GiB(42.17%)  tps: 2,574  tflops: 20.12  mfu: 6.45%
[rank3]:2025-10-27 07:56:25,592 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1026_GPipe_fullrand7_dm1/pipeline_schedule/251027_0756_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 1309.52 ms, GPU Bubble Ratio: 67.54%, 31.65%, 61.35%, 13.99%
[rank3]:2025-10-27 07:56:25,593 - INFO - 	> Batch Time: 1309.52 ms (Average Freeze Ratio: 0.34)
[rank3]:2025-10-27 07:56:25,593 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-27 07:56:25,597 - INFO -  step: 160  loss:  0.1141  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,574  tflops: 20.12  mfu: 6.45%
[rank3]:2025-10-27 07:56:26,805 - INFO - Avg. fwd time: 72.1536 / Avg. bwd time: 107.5961 / Avg. batch time: 1488.7987 (ms) / GPU bubble ratio: 3.41%
[rank2]:2025-10-27 07:56:26,951 - INFO - Avg. fwd time: 33.2961 / Avg. bwd time: 45.0327 / Avg. batch time: 1583.6558 (ms) / GPU bubble ratio: 60.43%
[rank0]:2025-10-27 07:56:27,108 - INFO - Avg. fwd time: 45.4983 / Avg. bwd time: 39.8044 / Avg. batch time: 1782.4928 (ms) / GPU bubble ratio: 61.72%
[rank1]:2025-10-27 07:56:27,105 - INFO - Avg. fwd time: 52.1926 / Avg. bwd time: 66.9904 / Avg. batch time: 1705.2092 (ms) / GPU bubble ratio: 44.09%
[rank1]:2025-10-27 07:58:15,187 - INFO -  step: 180  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,985  tflops: 23.33  mfu: 7.48%
[rank0]:2025-10-27 07:58:15,188 - INFO -  step: 180  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,985  tflops: 23.33  mfu: 7.48%
[rank3]:2025-10-27 07:58:15,188 - INFO -  step: 180  loss:  0.1380  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,990  tflops: 23.37  mfu: 7.49%
[rank2]:2025-10-27 07:58:15,186 - INFO -  step: 180  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,985  tflops: 23.33  mfu: 7.48%
[rank3]:2025-10-27 07:58:16,489 - INFO - Avg. fwd time: 72.1524 / Avg. bwd time: 103.2153 / Avg. batch time: 1453.6039 (ms) / GPU bubble ratio: 3.49%
[rank2]:2025-10-27 07:58:16,522 - INFO - Avg. fwd time: 33.2895 / Avg. bwd time: 43.2578 / Avg. batch time: 1545.0818 (ms) / GPU bubble ratio: 60.37%
[rank1]:2025-10-27 07:58:16,565 - INFO - Avg. fwd time: 52.4199 / Avg. bwd time: 63.8857 / Avg. batch time: 1662.7370 (ms) / GPU bubble ratio: 44.04%
[rank0]:2025-10-27 07:58:16,569 - INFO - Avg. fwd time: 45.4794 / Avg. bwd time: 35.3880 / Avg. batch time: 1735.3820 (ms) / GPU bubble ratio: 62.72%
[rank0]:2025-10-27 07:59:59,275 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-27 08:00:04,840 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1026_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251027_0800_rank3_trend_line.svg
[rank2]:2025-10-27 08:00:04,836 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1026_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251027_0800_rank2_trend_line.svg
[rank2]:2025-10-27 08:00:04,873 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank2]:2025-10-27 08:00:04,874 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,987  tflops: 23.35  mfu: 7.49%
[rank2]:2025-10-27 08:00:04,874 - INFO - ðŸ”Ž  Running validation at step 200
[rank1]:2025-10-27 08:00:04,867 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1026_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251027_0800_rank1_trend_line.svg
[rank1]:2025-10-27 08:00:04,873 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-10-27 08:00:04,874 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,987  tflops: 23.35  mfu: 7.49%
[rank1]:2025-10-27 08:00:04,874 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-10-27 08:00:04,863 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1026_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251027_0800_rank0_trend_line.svg
[rank0]:2025-10-27 08:00:04,873 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank0]:2025-10-27 08:00:04,874 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,987  tflops: 23.35  mfu: 7.49%
[rank0]:2025-10-27 08:00:04,874 - INFO - ðŸ”Ž  Running validation at step 200
[rank3]:2025-10-27 08:00:05,068 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1026_GPipe_fullrand7_dm1/pipeline_schedule/251027_0800_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 1311.97 ms, GPU Bubble Ratio: 69.20%, 36.52%, 61.70%, 14.14%
[rank3]:2025-10-27 08:00:05,068 - INFO - 	> Batch Time: 1311.97 ms (Average Freeze Ratio: 0.28)
[rank3]:2025-10-27 08:00:05,069 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-27 08:00:05,072 - INFO -  step: 200  loss:  0.1461  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,982  tflops: 23.31  mfu: 7.47%
[rank3]:2025-10-27 08:00:05,073 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-10-27 08:01:13,693 - INFO - validate step: 200  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,952
[rank1]:2025-10-27 08:01:13,779 - INFO - validate step: 200  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,945
[rank2]:2025-10-27 08:01:13,859 - INFO - validate step: 200  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,938
[rank3]:2025-10-27 08:01:13,942 - INFO - validate step: 200  loss:  0.2953  memory: 38.93GiB(81.95%)  tps: 5,948
[rank0]:2025-10-27 08:01:14,018 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251027_0801_stage0_step200.svg
[rank2]:2025-10-27 08:01:14,018 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251027_0801_stage2_step200.svg
[rank1]:2025-10-27 08:01:14,021 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251027_0801_stage1_step200.svg
[rank3]:2025-10-27 08:01:14,144 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1026_GPipe_fullrand7_dm1/pipeline_schedule/251027_0801_real_step200_rank3.svg
[rank3]:> Batch Time: 1856.69 ms, GPU Bubble Ratio: 55.86%, 47.11%, 63.99%, 15.76%
[rank3]:2025-10-27 08:01:14,216 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251027_0801_stage3_step200.svg
[rank2]:2025-10-27 08:01:15,447 - INFO - Avg. fwd time: 33.2578 / Avg. bwd time: 41.8293 / Avg. batch time: 1514.4805 (ms) / GPU bubble ratio: 60.34%
[rank3]:2025-10-27 08:01:15,411 - INFO - Avg. fwd time: 72.1859 / Avg. bwd time: 99.7117 / Avg. batch time: 1425.6240 (ms) / GPU bubble ratio: 3.54%
[rank1]:2025-10-27 08:01:15,489 - INFO - Avg. fwd time: 52.5105 / Avg. bwd time: 61.3941 / Avg. batch time: 1628.9732 (ms) / GPU bubble ratio: 44.06%
[rank0]:2025-10-27 08:01:15,493 - INFO - Avg. fwd time: 45.4161 / Avg. bwd time: 31.8539 / Avg. batch time: 1697.8964 (ms) / GPU bubble ratio: 63.59%
[rank3]:2025-10-27 08:03:17,153 - INFO -  step: 220  loss:  0.1522  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,660  tflops: 20.79  mfu: 6.66%
[rank2]:2025-10-27 08:03:17,165 - INFO -  step: 220  loss: -4.0000  grad_norm:  0.3783  memory: 16.10GiB(33.90%)  tps: 2,657  tflops: 20.77  mfu: 6.66%
[rank1]:2025-10-27 08:03:17,152 - INFO -  step: 220  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,656  tflops: 20.76  mfu: 6.65%
[rank0]:2025-10-27 08:03:17,189 - INFO -  step: 220  loss: -4.0000  grad_norm:  0.3783  memory: 20.89GiB(43.97%)  tps: 2,653  tflops: 20.74  mfu: 6.65%
[rank3]:2025-10-27 08:03:18,498 - INFO - Avg. fwd time: 72.2227 / Avg. bwd time: 96.8407 / Avg. batch time: 1402.7041 (ms) / GPU bubble ratio: 3.58%
[rank2]:2025-10-27 08:03:18,587 - INFO - Avg. fwd time: 33.2640 / Avg. bwd time: 43.9714 / Avg. batch time: 1495.0981 (ms) / GPU bubble ratio: 58.67%
[rank1]:2025-10-27 08:03:18,630 - INFO - Avg. fwd time: 52.3765 / Avg. bwd time: 59.2988 / Avg. batch time: 1606.7426 (ms) / GPU bubble ratio: 44.40%
[rank0]:2025-10-27 08:03:18,725 - INFO - Avg. fwd time: 45.5452 / Avg. bwd time: 35.4363 / Avg. batch time: 1681.6324 (ms) / GPU bubble ratio: 61.47%
[rank3]:2025-10-27 08:05:20,860 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1026_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251027_0805_rank3_trend_line.svg
[rank2]:2025-10-27 08:05:20,872 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1026_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251027_0805_rank2_trend_line.svg
[rank2]:2025-10-27 08:05:20,904 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-27 08:05:20,906 - INFO -  step: 240  loss: -4.0000  grad_norm:  0.4016  memory: 16.10GiB(33.90%)  tps: 2,648  tflops: 20.70  mfu: 6.64%
[rank1]:2025-10-27 08:05:20,860 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1026_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251027_0805_rank1_trend_line.svg
[rank1]:2025-10-27 08:05:20,905 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-10-27 08:05:20,906 - INFO -  step: 240  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,648  tflops: 20.70  mfu: 6.63%
[rank0]:2025-10-27 08:05:20,898 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1026_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251027_0805_rank0_trend_line.svg
[rank0]:2025-10-27 08:05:20,904 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-27 08:05:20,906 - INFO -  step: 240  loss: -4.0000  grad_norm:  0.4016  memory: 20.89GiB(43.97%)  tps: 2,649  tflops: 20.71  mfu: 6.64%
[rank3]:2025-10-27 08:05:21,101 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1026_GPipe_fullrand7_dm1/pipeline_schedule/251027_0805_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 1309.87 ms, GPU Bubble Ratio: 57.66%, 38.79%, 55.69%, 14.05%
[rank3]:2025-10-27 08:05:21,102 - INFO - 	> Batch Time: 1309.87 ms (Average Freeze Ratio: 0.34)
[rank3]:2025-10-27 08:05:21,102 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-27 08:05:21,106 - INFO -  step: 240  loss:  0.1615  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,644  tflops: 20.67  mfu: 6.62%
[rank3]:2025-10-27 08:05:22,320 - INFO - Avg. fwd time: 72.2515 / Avg. bwd time: 94.4368 / Avg. batch time: 1383.5235 (ms) / GPU bubble ratio: 3.62%
[rank2]:2025-10-27 08:05:22,413 - INFO - Avg. fwd time: 33.2914 / Avg. bwd time: 45.7766 / Avg. batch time: 1479.2392 (ms) / GPU bubble ratio: 57.24%
[rank1]:2025-10-27 08:05:22,455 - INFO - Avg. fwd time: 52.3099 / Avg. bwd time: 57.5421 / Avg. batch time: 1588.4877 (ms) / GPU bubble ratio: 44.68%
[rank0]:2025-10-27 08:05:22,550 - INFO - Avg. fwd time: 45.6790 / Avg. bwd time: 38.4787 / Avg. batch time: 1668.5566 (ms) / GPU bubble ratio: 59.65%
[rank0]:2025-10-27 08:06:10,071 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-27 08:07:10,701 - INFO -  step: 260  loss:  0.1439  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,990  tflops: 23.37  mfu: 7.49%
[rank2]:2025-10-27 08:07:10,700 - INFO -  step: 260  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,984  tflops: 23.33  mfu: 7.48%
[rank1]:2025-10-27 08:07:10,701 - INFO -  step: 260  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,984  tflops: 23.33  mfu: 7.48%
[rank0]:2025-10-27 08:07:10,701 - INFO -  step: 260  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,984  tflops: 23.33  mfu: 7.48%
[rank3]:2025-10-27 08:07:11,947 - INFO - Avg. fwd time: 72.2467 / Avg. bwd time: 92.4065 / Avg. batch time: 1367.2364 (ms) / GPU bubble ratio: 3.66%
[rank2]:2025-10-27 08:07:11,980 - INFO - Avg. fwd time: 33.2843 / Avg. bwd time: 44.4831 / Avg. batch time: 1460.5279 (ms) / GPU bubble ratio: 57.40%
[rank1]:2025-10-27 08:07:12,022 - INFO - Avg. fwd time: 52.4085 / Avg. bwd time: 56.0965 / Avg. batch time: 1567.9875 (ms) / GPU bubble ratio: 44.64%
[rank0]:2025-10-27 08:07:12,026 - INFO - Avg. fwd time: 45.6678 / Avg. bwd time: 35.5218 / Avg. batch time: 1644.6415 (ms) / GPU bubble ratio: 60.51%
[rank2]:2025-10-27 08:09:00,011 - INFO -  step: 280  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,998  tflops: 23.43  mfu: 7.51%
[rank1]:2025-10-27 08:09:00,012 - INFO -  step: 280  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,998  tflops: 23.43  mfu: 7.51%
[rank0]:2025-10-27 08:09:00,012 - INFO -  step: 280  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,998  tflops: 23.43  mfu: 7.51%
[rank3]:2025-10-27 08:09:00,013 - INFO -  step: 280  loss:  0.1688  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,998  tflops: 23.43  mfu: 7.51%
[rank3]:2025-10-27 08:09:01,323 - INFO - Avg. fwd time: 72.2335 / Avg. bwd time: 90.6745 / Avg. batch time: 1353.2684 (ms) / GPU bubble ratio: 3.70%
[rank2]:2025-10-27 08:09:01,357 - INFO - Avg. fwd time: 33.2771 / Avg. bwd time: 43.3683 / Avg. batch time: 1444.4784 (ms) / GPU bubble ratio: 57.55%
[rank1]:2025-10-27 08:09:01,402 - INFO - Avg. fwd time: 52.5207 / Avg. bwd time: 54.8522 / Avg. batch time: 1550.3895 (ms) / GPU bubble ratio: 44.60%
[rank0]:2025-10-27 08:09:01,406 - INFO - Avg. fwd time: 45.6327 / Avg. bwd time: 32.9870 / Avg. batch time: 1624.1074 (ms) / GPU bubble ratio: 61.27%
[rank0]:2025-10-27 08:10:44,145 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-27 08:10:49,659 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,988  tflops: 23.36  mfu: 7.49%
[rank2]:2025-10-27 08:10:49,659 - INFO - ðŸ”Ž  Running validation at step 300
[rank1]:2025-10-27 08:10:49,660 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,988  tflops: 23.36  mfu: 7.49%
[rank1]:2025-10-27 08:10:49,667 - INFO - ðŸ”Ž  Running validation at step 300
[rank0]:2025-10-27 08:10:49,660 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,988  tflops: 23.36  mfu: 7.49%
[rank0]:2025-10-27 08:10:49,668 - INFO - ðŸ”Ž  Running validation at step 300
[rank3]:2025-10-27 08:10:49,661 - INFO -  step: 300  loss:  0.1158  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,989  tflops: 23.36  mfu: 7.49%
[rank3]:2025-10-27 08:10:49,668 - INFO - ðŸ”Ž  Running validation at step 300
[rank0]:2025-10-27 08:11:58,573 - INFO - validate step: 300  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,944
[rank1]:2025-10-27 08:11:58,658 - INFO - validate step: 300  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,937
[rank2]:2025-10-27 08:11:58,739 - INFO - validate step: 300  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,929
[rank3]:2025-10-27 08:11:58,819 - INFO - validate step: 300  loss:  0.2952  memory: 38.93GiB(81.95%)  tps: 5,923
[rank2]:2025-10-27 08:11:58,893 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251027_0811_stage2_step300.svg
[rank1]:2025-10-27 08:11:58,896 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251027_0811_stage1_step300.svg
[rank0]:2025-10-27 08:11:58,893 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251027_0811_stage0_step300.svg
[rank3]:2025-10-27 08:11:59,011 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1026_GPipe_fullrand7_dm1/pipeline_schedule/251027_0811_real_step300_rank3.svg
[rank3]:> Batch Time: 1354.11 ms, GPU Bubble Ratio: 56.51%, 44.94%, 61.70%, 15.87%
[rank3]:2025-10-27 08:11:59,078 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251027_0811_stage3_step300.svg
[rank3]:2025-10-27 08:12:00,276 - INFO - Avg. fwd time: 72.2522 / Avg. bwd time: 89.1704 / Avg. batch time: 1341.3307 (ms) / GPU bubble ratio: 3.72%
[rank2]:2025-10-27 08:12:00,310 - INFO - Avg. fwd time: 33.2652 / Avg. bwd time: 42.4011 / Avg. batch time: 1430.8090 (ms) / GPU bubble ratio: 57.69%
[rank1]:2025-10-27 08:12:00,352 - INFO - Avg. fwd time: 52.5803 / Avg. bwd time: 53.7713 / Avg. batch time: 1535.4022 (ms) / GPU bubble ratio: 44.59%
[rank0]:2025-10-27 08:12:00,356 - INFO - Avg. fwd time: 45.5849 / Avg. bwd time: 30.7898 / Avg. batch time: 1606.5856 (ms) / GPU bubble ratio: 61.97%
[rank2]:2025-10-27 08:13:48,781 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1026_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251027_0813_rank2_trend_line.svg
[rank0]:2025-10-27 08:13:48,824 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1026_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251027_0813_rank0_trend_line.svg
[rank3]:2025-10-27 08:13:48,784 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1026_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251027_0813_rank3_trend_line.svg
[rank2]:2025-10-27 08:13:48,833 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-27 08:13:48,835 - INFO -  step: 320  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,976  tflops: 23.27  mfu: 7.46%
[rank1]:2025-10-27 08:13:48,827 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1026_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251027_0813_rank1_trend_line.svg
[rank1]:2025-10-27 08:13:48,834 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-10-27 08:13:48,835 - INFO -  step: 320  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,974  tflops: 23.25  mfu: 7.45%
[rank0]:2025-10-27 08:13:48,833 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-27 08:13:48,835 - INFO -  step: 320  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,972  tflops: 23.23  mfu: 7.45%
[rank3]:2025-10-27 08:13:49,029 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1026_GPipe_fullrand7_dm1/pipeline_schedule/251027_0813_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 1310.41 ms, GPU Bubble Ratio: 62.21%, 40.72%, 57.79%, 14.09%
[rank3]:2025-10-27 08:13:49,030 - INFO - 	> Batch Time: 1310.41 ms (Average Freeze Ratio: 0.34)
[rank3]:2025-10-27 08:13:49,030 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-27 08:13:49,034 - INFO -  step: 320  loss:  0.1497  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,973  tflops: 23.24  mfu: 7.45%
[rank3]:2025-10-27 08:13:50,242 - INFO - Avg. fwd time: 72.2832 / Avg. bwd time: 87.8573 / Avg. batch time: 1330.9576 (ms) / GPU bubble ratio: 3.74%
[rank2]:2025-10-27 08:13:50,276 - INFO - Avg. fwd time: 33.2610 / Avg. bwd time: 41.5556 / Avg. batch time: 1418.9295 (ms) / GPU bubble ratio: 57.82%
[rank1]:2025-10-27 08:13:50,319 - INFO - Avg. fwd time: 52.5992 / Avg. bwd time: 52.8174 / Avg. batch time: 1522.3402 (ms) / GPU bubble ratio: 44.60%
[rank0]:2025-10-27 08:13:50,323 - INFO - Avg. fwd time: 45.5837 / Avg. bwd time: 28.8671 / Avg. batch time: 1591.3082 (ms) / GPU bubble ratio: 62.57%
[rank2]:2025-10-27 08:15:37,902 - INFO -  step: 340  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 3,004  tflops: 23.49  mfu: 7.53%
[rank1]:2025-10-27 08:15:37,903 - INFO -  step: 340  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 3,004  tflops: 23.49  mfu: 7.53%
[rank0]:2025-10-27 08:15:37,904 - INFO -  step: 340  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 3,004  tflops: 23.49  mfu: 7.53%
[rank3]:2025-10-27 08:15:37,904 - INFO -  step: 340  loss:  0.1643  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 3,010  tflops: 23.53  mfu: 7.54%
[rank3]:2025-10-27 08:15:39,177 - INFO - Avg. fwd time: 72.2597 / Avg. bwd time: 86.6718 / Avg. batch time: 1321.2577 (ms) / GPU bubble ratio: 3.77%
[rank2]:2025-10-27 08:15:39,212 - INFO - Avg. fwd time: 33.2548 / Avg. bwd time: 40.8052 / Avg. batch time: 1407.8230 (ms) / GPU bubble ratio: 57.92%
[rank1]:2025-10-27 08:15:39,255 - INFO - Avg. fwd time: 52.6435 / Avg. bwd time: 51.9967 / Avg. batch time: 1510.2250 (ms) / GPU bubble ratio: 44.57%
[rank0]:2025-10-27 08:15:39,259 - INFO - Avg. fwd time: 45.5496 / Avg. bwd time: 27.1704 / Avg. batch time: 1577.2278 (ms) / GPU bubble ratio: 63.12%
[rank0]:2025-10-27 08:16:27,061 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-27 08:17:27,455 - INFO -  step: 360  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,991  tflops: 23.38  mfu: 7.49%
[rank1]:2025-10-27 08:17:27,456 - INFO -  step: 360  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,991  tflops: 23.38  mfu: 7.49%
[rank0]:2025-10-27 08:17:27,456 - INFO -  step: 360  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,991  tflops: 23.38  mfu: 7.49%
[rank3]:2025-10-27 08:17:27,456 - INFO -  step: 360  loss:  0.1208  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,991  tflops: 23.38  mfu: 7.49%
[rank2]:2025-10-27 08:17:28,797 - INFO - Avg. fwd time: 33.2493 / Avg. bwd time: 40.1428 / Avg. batch time: 1398.4015 (ms) / GPU bubble ratio: 58.01%
[rank3]:2025-10-27 08:17:28,760 - INFO - Avg. fwd time: 72.2794 / Avg. bwd time: 85.6365 / Avg. batch time: 1313.0787 (ms) / GPU bubble ratio: 3.79%
[rank1]:2025-10-27 08:17:28,840 - INFO - Avg. fwd time: 52.6802 / Avg. bwd time: 51.2579 / Avg. batch time: 1499.8810 (ms) / GPU bubble ratio: 44.56%
[rank0]:2025-10-27 08:17:28,845 - INFO - Avg. fwd time: 45.5157 / Avg. bwd time: 25.6621 / Avg. batch time: 1565.1326 (ms) / GPU bubble ratio: 63.62%
[rank2]:2025-10-27 08:19:17,097 - INFO -  step: 380  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,989  tflops: 23.36  mfu: 7.49%
[rank0]:2025-10-27 08:19:17,098 - INFO -  step: 380  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,989  tflops: 23.36  mfu: 7.49%
[rank1]:2025-10-27 08:19:17,098 - INFO -  step: 380  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,989  tflops: 23.36  mfu: 7.49%
[rank3]:2025-10-27 08:19:17,098 - INFO -  step: 380  loss:  0.1203  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,989  tflops: 23.36  mfu: 7.49%
[rank3]:2025-10-27 08:19:18,419 - INFO - Avg. fwd time: 72.2874 / Avg. bwd time: 84.7248 / Avg. batch time: 1305.8285 (ms) / GPU bubble ratio: 3.81%
[rank2]:2025-10-27 08:19:18,453 - INFO - Avg. fwd time: 33.2495 / Avg. bwd time: 39.5511 / Avg. batch time: 1390.0396 (ms) / GPU bubble ratio: 58.10%
[rank0]:2025-10-27 08:19:18,501 - INFO - Avg. fwd time: 45.4949 / Avg. bwd time: 24.3124 / Avg. batch time: 1554.3774 (ms) / GPU bubble ratio: 64.07%
[rank1]:2025-10-27 08:19:18,496 - INFO - Avg. fwd time: 52.7397 / Avg. bwd time: 50.5999 / Avg. batch time: 1490.6895 (ms) / GPU bubble ratio: 44.54%
[rank0]:2025-10-27 08:21:01,380 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-27 08:21:06,969 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,982  tflops: 23.32  mfu: 7.47%
[rank0]:2025-10-27 08:21:06,970 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,982  tflops: 23.31  mfu: 7.47%
[rank0]:2025-10-27 08:21:06,977 - INFO - ðŸ”Ž  Running validation at step 400
[rank1]:2025-10-27 08:21:06,970 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,982  tflops: 23.32  mfu: 7.47%
[rank1]:2025-10-27 08:21:06,977 - INFO - ðŸ”Ž  Running validation at step 400
[rank3]:2025-10-27 08:21:06,970 - INFO -  step: 400  loss:  0.1089  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,982  tflops: 23.32  mfu: 7.47%
[rank3]:2025-10-27 08:21:06,978 - INFO - ðŸ”Ž  Running validation at step 400
[rank2]:2025-10-27 08:21:06,969 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-10-27 08:22:16,429 - INFO - validate step: 400  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,898
[rank1]:2025-10-27 08:22:16,509 - INFO - validate step: 400  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,891
[rank2]:2025-10-27 08:22:16,591 - INFO - validate step: 400  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,883
[rank3]:2025-10-27 08:22:16,675 - INFO - validate step: 400  loss:  0.2934  memory: 38.93GiB(81.95%)  tps: 5,877
[rank2]:2025-10-27 08:22:16,756 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251027_0822_stage2_step400.svg
[rank0]:2025-10-27 08:22:16,757 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251027_0822_stage0_step400.svg
[rank1]:2025-10-27 08:22:16,757 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251027_0822_stage1_step400.svg
[rank3]:2025-10-27 08:22:16,863 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1026_GPipe_fullrand7_dm1/pipeline_schedule/251027_0822_real_step400_rank3.svg
[rank3]:> Batch Time: 1318.46 ms, GPU Bubble Ratio: 72.19%, 43.85%, 62.35%, 13.89%
[rank3]:2025-10-27 08:22:16,938 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251027_0822_stage3_step400.svg
[rank3]:2025-10-27 08:22:18,136 - INFO - Avg. fwd time: 72.3167 / Avg. bwd time: 83.8976 / Avg. batch time: 1299.3945 (ms) / GPU bubble ratio: 3.82%
[rank2]:2025-10-27 08:22:18,171 - INFO - Avg. fwd time: 33.2526 / Avg. bwd time: 39.0174 / Avg. batch time: 1382.6595 (ms) / GPU bubble ratio: 58.18%
[rank0]:2025-10-27 08:22:18,221 - INFO - Avg. fwd time: 45.4714 / Avg. bwd time: 23.0977 / Avg. batch time: 1544.8641 (ms) / GPU bubble ratio: 64.49%
[rank1]:2025-10-27 08:22:18,216 - INFO - Avg. fwd time: 52.7710 / Avg. bwd time: 50.0048 / Avg. batch time: 1482.5810 (ms) / GPU bubble ratio: 44.54%
[rank2]:2025-10-27 08:24:06,302 - INFO -  step: 420  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,987  tflops: 23.35  mfu: 7.48%
[rank0]:2025-10-27 08:24:06,303 - INFO -  step: 420  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,982  tflops: 23.31  mfu: 7.47%
[rank1]:2025-10-27 08:24:06,303 - INFO -  step: 420  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,984  tflops: 23.33  mfu: 7.48%
[rank3]:2025-10-27 08:24:06,304 - INFO -  step: 420  loss:  0.1449  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,989  tflops: 23.37  mfu: 7.49%
[rank3]:2025-10-27 08:24:07,561 - INFO - Avg. fwd time: 72.3248 / Avg. bwd time: 83.1399 / Avg. batch time: 1293.3398 (ms) / GPU bubble ratio: 3.84%
[rank2]:2025-10-27 08:24:07,596 - INFO - Avg. fwd time: 33.2482 / Avg. bwd time: 38.5337 / Avg. batch time: 1375.7026 (ms) / GPU bubble ratio: 58.26%
[rank0]:2025-10-27 08:24:07,646 - INFO - Avg. fwd time: 45.4592 / Avg. bwd time: 21.9986 / Avg. batch time: 1535.9614 (ms) / GPU bubble ratio: 64.86%
[rank1]:2025-10-27 08:24:07,641 - INFO - Avg. fwd time: 52.7849 / Avg. bwd time: 49.4678 / Avg. batch time: 1474.9472 (ms) / GPU bubble ratio: 44.54%
[rank1]:2025-10-27 08:25:55,673 - INFO -  step: 440  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,996  tflops: 23.42  mfu: 7.51%
[rank0]:2025-10-27 08:25:55,673 - INFO -  step: 440  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,996  tflops: 23.42  mfu: 7.51%
[rank3]:2025-10-27 08:25:55,673 - INFO -  step: 440  loss:  0.1397  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,996  tflops: 23.42  mfu: 7.51%
[rank2]:2025-10-27 08:25:55,672 - INFO -  step: 440  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,996  tflops: 23.42  mfu: 7.51%
[rank3]:2025-10-27 08:25:56,952 - INFO - Avg. fwd time: 72.3269 / Avg. bwd time: 82.4535 / Avg. batch time: 1287.8319 (ms) / GPU bubble ratio: 3.85%
[rank2]:2025-10-27 08:25:56,987 - INFO - Avg. fwd time: 33.2408 / Avg. bwd time: 38.0941 / Avg. batch time: 1369.3721 (ms) / GPU bubble ratio: 58.33%
[rank1]:2025-10-27 08:25:57,030 - INFO - Avg. fwd time: 52.8088 / Avg. bwd time: 48.9776 / Avg. batch time: 1467.9965 (ms) / GPU bubble ratio: 44.53%
[rank0]:2025-10-27 08:25:57,035 - INFO - Avg. fwd time: 45.4384 / Avg. bwd time: 20.9993 / Avg. batch time: 1527.8473 (ms) / GPU bubble ratio: 65.21%
[rank0]:2025-10-27 08:26:45,546 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-27 08:27:45,496 - INFO -  step: 460  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,984  tflops: 23.33  mfu: 7.48%
[rank0]:2025-10-27 08:27:45,497 - INFO -  step: 460  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,984  tflops: 23.33  mfu: 7.48%
[rank3]:2025-10-27 08:27:45,497 - INFO -  step: 460  loss:  0.1095  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,984  tflops: 23.33  mfu: 7.48%
[rank2]:2025-10-27 08:27:45,496 - INFO -  step: 460  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,984  tflops: 23.33  mfu: 7.48%
[rank3]:2025-10-27 08:27:46,822 - INFO - Avg. fwd time: 72.3378 / Avg. bwd time: 81.8362 / Avg. batch time: 1283.0095 (ms) / GPU bubble ratio: 3.87%
[rank2]:2025-10-27 08:27:46,857 - INFO - Avg. fwd time: 33.2432 / Avg. bwd time: 37.6945 / Avg. batch time: 1363.8137 (ms) / GPU bubble ratio: 58.39%
[rank1]:2025-10-27 08:27:46,900 - INFO - Avg. fwd time: 52.8588 / Avg. bwd time: 48.5307 / Avg. batch time: 1461.8965 (ms) / GPU bubble ratio: 44.52%
[rank0]:2025-10-27 08:27:46,905 - INFO - Avg. fwd time: 45.4225 / Avg. bwd time: 20.0869 / Avg. batch time: 1520.6912 (ms) / GPU bubble ratio: 65.54%
[rank3]:2025-10-27 08:29:35,585 - INFO -  step: 480  loss:  0.1167  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,977  tflops: 23.27  mfu: 7.46%
[rank2]:2025-10-27 08:29:35,583 - INFO -  step: 480  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,977  tflops: 23.27  mfu: 7.46%
[rank1]:2025-10-27 08:29:35,584 - INFO -  step: 480  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,977  tflops: 23.27  mfu: 7.46%
[rank0]:2025-10-27 08:29:35,585 - INFO -  step: 480  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,977  tflops: 23.27  mfu: 7.46%
[rank3]:2025-10-27 08:29:36,911 - INFO - Avg. fwd time: 72.3607 / Avg. bwd time: 81.2794 / Avg. batch time: 1278.7178 (ms) / GPU bubble ratio: 3.88%
[rank2]:2025-10-27 08:29:36,946 - INFO - Avg. fwd time: 33.2464 / Avg. bwd time: 37.3279 / Avg. batch time: 1358.8441 (ms) / GPU bubble ratio: 58.45%
[rank1]:2025-10-27 08:29:36,990 - INFO - Avg. fwd time: 52.8918 / Avg. bwd time: 48.1265 / Avg. batch time: 1456.4212 (ms) / GPU bubble ratio: 44.51%
[rank0]:2025-10-27 08:29:36,996 - INFO - Avg. fwd time: 45.4047 / Avg. bwd time: 19.2504 / Avg. batch time: 1514.2475 (ms) / GPU bubble ratio: 65.84%
[rank0]:2025-10-27 08:31:19,678 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-27 08:31:24,992 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,995  tflops: 23.41  mfu: 7.50%
[rank1]:2025-10-27 08:31:24,992 - INFO - ðŸ”Ž  Running validation at step 500
[rank0]:2025-10-27 08:31:24,992 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,995  tflops: 23.41  mfu: 7.50%
[rank0]:2025-10-27 08:31:24,992 - INFO - ðŸ”Ž  Running validation at step 500
[rank3]:2025-10-27 08:31:24,992 - INFO -  step: 500  loss:  0.1095  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,995  tflops: 23.41  mfu: 7.50%
[rank3]:2025-10-27 08:31:24,993 - INFO - ðŸ”Ž  Running validation at step 500
[rank2]:2025-10-27 08:31:24,991 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,995  tflops: 23.41  mfu: 7.50%
[rank2]:2025-10-27 08:31:24,991 - INFO - ðŸ”Ž  Running validation at step 500
[rank0]:2025-10-27 08:32:34,006 - INFO - validate step: 500  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,935
[rank0]:2025-10-27 08:32:34,007 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-27 08:32:34,012 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank1]:2025-10-27 08:32:34,086 - INFO - validate step: 500  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,928
[rank1]:2025-10-27 08:32:34,087 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-27 08:32:34,170 - INFO - validate step: 500  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,921
[rank2]:2025-10-27 08:32:34,171 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-27 08:32:34,249 - INFO - validate step: 500  loss:  0.2942  memory: 38.93GiB(81.95%)  tps: 5,914
[rank3]:2025-10-27 08:32:34,250 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-27 08:32:36,082 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 1.91 seconds.
[rank1]:2025-10-27 08:32:37,250 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.16 seconds.
[rank0]:2025-10-27 08:32:37,853 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-27 08:32:37,861 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.85 seconds.
[rank3]:2025-10-27 08:32:38,420 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 4.17 seconds.
[rank1]:2025-10-27 08:32:38,508 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251027_0832_stage1_step500.svg
[rank2]:2025-10-27 08:32:38,506 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251027_0832_stage2_step500.svg
[rank0]:2025-10-27 08:32:38,563 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251027_0832_stage0_step500.svg
[rank3]:2025-10-27 08:32:38,799 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1026_GPipe_fullrand7_dm1/pipeline_schedule/251027_0832_real_step500_rank3.svg
[rank3]:> Batch Time: 1316.99 ms, GPU Bubble Ratio: 72.20%, 43.91%, 62.39%, 13.86%
[rank3]:2025-10-27 08:32:38,872 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251027_0832_stage3_step500.svg
[rank3]:2025-10-27 08:32:40,025 - INFO - Avg. fwd time: 72.3519 / Avg. bwd time: 80.7465 / Avg. batch time: 1274.3861 (ms) / GPU bubble ratio: 3.89%
[rank0]:2025-10-27 08:32:40,111 - INFO - Avg. fwd time: 45.3982 / Avg. bwd time: 18.4809 / Avg. batch time: 1508.0321 (ms) / GPU bubble ratio: 66.11%
[rank1]:2025-10-27 08:32:40,104 - INFO - Avg. fwd time: 52.9146 / Avg. bwd time: 47.7535 / Avg. batch time: 1451.0916 (ms) / GPU bubble ratio: 44.50%
[rank2]:2025-10-27 08:32:40,061 - INFO - Avg. fwd time: 33.2405 / Avg. bwd time: 36.9892 / Avg. batch time: 1353.9609 (ms) / GPU bubble ratio: 58.50%
[rank0]:2025-10-27 08:34:27,835 - INFO -  step: 520  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,879  tflops: 22.50  mfu: 7.21%
[rank1]:2025-10-27 08:34:27,835 - INFO -  step: 520  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,881  tflops: 22.52  mfu: 7.22%
[rank3]:2025-10-27 08:34:27,835 - INFO -  step: 520  loss:  0.1450  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,885  tflops: 22.55  mfu: 7.23%
[rank2]:2025-10-27 08:34:27,834 - INFO -  step: 520  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,883  tflops: 22.54  mfu: 7.22%
[rank3]:2025-10-27 08:34:29,130 - INFO - Avg. fwd time: 72.3356 / Avg. bwd time: 80.2502 / Avg. batch time: 1270.2811 (ms) / GPU bubble ratio: 3.90%
[rank2]:2025-10-27 08:34:29,165 - INFO - Avg. fwd time: 33.2367 / Avg. bwd time: 36.6747 / Avg. batch time: 1349.2587 (ms) / GPU bubble ratio: 58.55%
[rank0]:2025-10-27 08:34:29,216 - INFO - Avg. fwd time: 45.3900 / Avg. bwd time: 17.7705 / Avg. batch time: 1502.0893 (ms) / GPU bubble ratio: 66.36%
[rank1]:2025-10-27 08:34:29,210 - INFO - Avg. fwd time: 52.9295 / Avg. bwd time: 47.4045 / Avg. batch time: 1445.9694 (ms) / GPU bubble ratio: 44.49%
[rank0]:2025-10-27 08:36:17,658 - INFO -  step: 540  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,984  tflops: 23.33  mfu: 7.48%
[rank1]:2025-10-27 08:36:17,657 - INFO -  step: 540  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,984  tflops: 23.33  mfu: 7.48%
[rank3]:2025-10-27 08:36:17,658 - INFO -  step: 540  loss:  0.1425  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,984  tflops: 23.33  mfu: 7.48%
[rank2]:2025-10-27 08:36:17,656 - INFO -  step: 540  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,984  tflops: 23.33  mfu: 7.48%
[rank3]:2025-10-27 08:36:18,983 - INFO - Avg. fwd time: 72.3529 / Avg. bwd time: 79.8054 / Avg. batch time: 1266.8341 (ms) / GPU bubble ratio: 3.91%
[rank2]:2025-10-27 08:36:19,018 - INFO - Avg. fwd time: 33.2339 / Avg. bwd time: 36.3865 / Avg. batch time: 1345.2742 (ms) / GPU bubble ratio: 58.60%
[rank0]:2025-10-27 08:36:19,067 - INFO - Avg. fwd time: 45.3827 / Avg. bwd time: 17.1127 / Avg. batch time: 1496.9337 (ms) / GPU bubble ratio: 66.60%
[rank1]:2025-10-27 08:36:19,061 - INFO - Avg. fwd time: 52.9508 / Avg. bwd time: 47.0813 / Avg. batch time: 1441.5752 (ms) / GPU bubble ratio: 44.49%
[rank0]:2025-10-27 08:37:07,615 - INFO - [GC] Peforming periodical GC collection 0.36 seconds
[rank0]:2025-10-27 08:38:08,228 - INFO -  step: 560  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,964  tflops: 23.17  mfu: 7.43%
[rank3]:2025-10-27 08:38:08,228 - INFO -  step: 560  loss:  0.1373  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,964  tflops: 23.17  mfu: 7.43%
[rank2]:2025-10-27 08:38:08,227 - INFO -  step: 560  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,964  tflops: 23.17  mfu: 7.43%
[rank1]:2025-10-27 08:38:08,228 - INFO -  step: 560  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,964  tflops: 23.17  mfu: 7.43%
[rank3]:2025-10-27 08:38:09,568 - INFO - Avg. fwd time: 72.3836 / Avg. bwd time: 79.3969 / Avg. batch time: 1263.7830 (ms) / GPU bubble ratio: 3.92%
[rank2]:2025-10-27 08:38:09,603 - INFO - Avg. fwd time: 33.2407 / Avg. bwd time: 36.1187 / Avg. batch time: 1341.7278 (ms) / GPU bubble ratio: 58.64%
[rank1]:2025-10-27 08:38:09,647 - INFO - Avg. fwd time: 52.9698 / Avg. bwd time: 46.7794 / Avg. batch time: 1437.6561 (ms) / GPU bubble ratio: 44.49%
[rank0]:2025-10-27 08:38:09,652 - INFO - Avg. fwd time: 45.3732 / Avg. bwd time: 16.5019 / Avg. batch time: 1492.3087 (ms) / GPU bubble ratio: 66.83%
[rank3]:2025-10-27 08:39:57,612 - INFO -  step: 580  loss:  0.1291  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,996  tflops: 23.42  mfu: 7.51%
[rank2]:2025-10-27 08:39:57,610 - INFO -  step: 580  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,996  tflops: 23.42  mfu: 7.51%
[rank1]:2025-10-27 08:39:57,611 - INFO -  step: 580  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,996  tflops: 23.42  mfu: 7.51%
[rank0]:2025-10-27 08:39:57,611 - INFO -  step: 580  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,996  tflops: 23.42  mfu: 7.51%
[rank3]:2025-10-27 08:39:58,880 - INFO - Avg. fwd time: 72.3776 / Avg. bwd time: 79.0006 / Avg. batch time: 1260.5675 (ms) / GPU bubble ratio: 3.93%
[rank2]:2025-10-27 08:39:58,914 - INFO - Avg. fwd time: 33.2389 / Avg. bwd time: 35.8690 / Avg. batch time: 1338.0434 (ms) / GPU bubble ratio: 58.68%
[rank0]:2025-10-27 08:39:58,964 - INFO - Avg. fwd time: 45.3672 / Avg. bwd time: 15.9332 / Avg. batch time: 1487.6155 (ms) / GPU bubble ratio: 67.03%
[rank1]:2025-10-27 08:39:58,958 - INFO - Avg. fwd time: 52.9934 / Avg. bwd time: 46.4980 / Avg. batch time: 1433.6219 (ms) / GPU bubble ratio: 44.48%
[rank0]:2025-10-27 08:41:41,346 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-27 08:41:46,755 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 3,002  tflops: 23.47  mfu: 7.52%
[rank2]:2025-10-27 08:41:46,755 - INFO - ðŸ”Ž  Running validation at step 600
[rank1]:2025-10-27 08:41:46,756 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 3,002  tflops: 23.47  mfu: 7.52%
[rank1]:2025-10-27 08:41:46,756 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-10-27 08:41:46,756 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 3,002  tflops: 23.47  mfu: 7.52%
[rank0]:2025-10-27 08:41:46,756 - INFO - ðŸ”Ž  Running validation at step 600
[rank3]:2025-10-27 08:41:46,756 - INFO -  step: 600  loss:  0.1334  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 3,002  tflops: 23.47  mfu: 7.52%
[rank3]:2025-10-27 08:41:46,757 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-10-27 08:42:56,041 - INFO - validate step: 600  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,912
[rank1]:2025-10-27 08:42:56,123 - INFO - validate step: 600  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,905
[rank2]:2025-10-27 08:42:56,202 - INFO - validate step: 600  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,898
[rank3]:2025-10-27 08:42:56,286 - INFO - validate step: 600  loss:  0.2940  memory: 38.93GiB(81.95%)  tps: 5,891
[rank2]:2025-10-27 08:42:56,362 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251027_0842_stage2_step600.svg
[rank1]:2025-10-27 08:42:56,364 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251027_0842_stage1_step600.svg
[rank0]:2025-10-27 08:42:56,363 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251027_0842_stage0_step600.svg
[rank3]:2025-10-27 08:42:56,475 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1026_GPipe_fullrand7_dm1/pipeline_schedule/251027_0842_real_step600_rank3.svg
[rank3]:> Batch Time: 1315.46 ms, GPU Bubble Ratio: 72.20%, 43.92%, 62.39%, 13.86%
[rank3]:2025-10-27 08:42:56,544 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251027_0842_stage3_step600.svg
[rank3]:2025-10-27 08:42:57,718 - INFO - Avg. fwd time: 72.3645 / Avg. bwd time: 78.6312 / Avg. batch time: 1257.5297 (ms) / GPU bubble ratio: 3.94%
[rank2]:2025-10-27 08:42:57,753 - INFO - Avg. fwd time: 33.2328 / Avg. bwd time: 35.6353 / Avg. batch time: 1334.6016 (ms) / GPU bubble ratio: 58.72%
[rank1]:2025-10-27 08:42:57,796 - INFO - Avg. fwd time: 53.0042 / Avg. bwd time: 46.2317 / Avg. batch time: 1429.8304 (ms) / GPU bubble ratio: 44.48%
[rank0]:2025-10-27 08:42:57,802 - INFO - Avg. fwd time: 45.3508 / Avg. bwd time: 15.4024 / Avg. batch time: 1483.2039 (ms) / GPU bubble ratio: 67.23%
[rank3]:2025-10-27 08:44:46,459 - INFO -  step: 620  loss:  0.1588  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,974  tflops: 23.25  mfu: 7.45%
[rank2]:2025-10-27 08:44:46,458 - INFO -  step: 620  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,972  tflops: 23.23  mfu: 7.45%
[rank1]:2025-10-27 08:44:46,459 - INFO -  step: 620  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,970  tflops: 23.22  mfu: 7.44%
[rank0]:2025-10-27 08:44:46,459 - INFO -  step: 620  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,968  tflops: 23.20  mfu: 7.44%
[rank3]:2025-10-27 08:44:47,767 - INFO - Avg. fwd time: 72.3744 / Avg. bwd time: 78.3049 / Avg. batch time: 1255.0099 (ms) / GPU bubble ratio: 3.95%
[rank2]:2025-10-27 08:44:47,802 - INFO - Avg. fwd time: 33.2338 / Avg. bwd time: 35.4181 / Avg. batch time: 1331.6680 (ms) / GPU bubble ratio: 58.76%
[rank1]:2025-10-27 08:44:47,845 - INFO - Avg. fwd time: 53.0366 / Avg. bwd time: 45.9928 / Avg. batch time: 1426.6074 (ms) / GPU bubble ratio: 44.47%
[rank0]:2025-10-27 08:44:47,851 - INFO - Avg. fwd time: 45.3538 / Avg. bwd time: 14.9058 / Avg. batch time: 1479.4137 (ms) / GPU bubble ratio: 67.41%
[rank3]:2025-10-27 08:46:36,997 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1026_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251027_0846_rank3_trend_line.svg
[rank2]:2025-10-27 08:46:36,996 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1026_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251027_0846_rank2_trend_line.svg
[rank2]:2025-10-27 08:46:37,050 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-27 08:46:37,052 - INFO -  step: 640  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,963  tflops: 23.16  mfu: 7.42%
[rank1]:2025-10-27 08:46:37,043 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1026_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251027_0846_rank1_trend_line.svg
[rank1]:2025-10-27 08:46:37,050 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-10-27 08:46:37,052 - INFO -  step: 640  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,963  tflops: 23.16  mfu: 7.42%
[rank0]:2025-10-27 08:46:37,036 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1026_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251027_0846_rank0_trend_line.svg
[rank0]:2025-10-27 08:46:37,050 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-27 08:46:37,052 - INFO -  step: 640  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,963  tflops: 23.16  mfu: 7.42%
[rank3]:2025-10-27 08:46:37,242 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1026_GPipe_fullrand7_dm1/pipeline_schedule/251027_0846_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 1310.23 ms, GPU Bubble Ratio: 67.59%, 42.51%, 60.33%, 14.07%
[rank3]:2025-10-27 08:46:37,243 - INFO - 	> Batch Time: 1310.23 ms (Average Freeze Ratio: 0.34)
[rank3]:2025-10-27 08:46:37,243 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-27 08:46:37,248 - INFO -  step: 640  loss:  0.1124  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,958  tflops: 23.12  mfu: 7.41%
[rank3]:2025-10-27 08:46:38,454 - INFO - Avg. fwd time: 72.3965 / Avg. bwd time: 77.9995 / Avg. batch time: 1252.7220 (ms) / GPU bubble ratio: 3.96%
[rank2]:2025-10-27 08:46:38,489 - INFO - Avg. fwd time: 33.2382 / Avg. bwd time: 35.2143 / Avg. batch time: 1329.0260 (ms) / GPU bubble ratio: 58.80%
[rank1]:2025-10-27 08:46:38,534 - INFO - Avg. fwd time: 53.0605 / Avg. bwd time: 45.7634 / Avg. batch time: 1423.6970 (ms) / GPU bubble ratio: 44.47%
[rank0]:2025-10-27 08:46:38,540 - INFO - Avg. fwd time: 45.3550 / Avg. bwd time: 14.4402 / Avg. batch time: 1475.9705 (ms) / GPU bubble ratio: 67.59%
[rank0]:2025-10-27 08:47:26,057 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-27 08:48:26,509 - INFO -  step: 660  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,994  tflops: 23.40  mfu: 7.50%
[rank0]:2025-10-27 08:48:26,510 - INFO -  step: 660  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,994  tflops: 23.40  mfu: 7.50%
[rank3]:2025-10-27 08:48:26,510 - INFO -  step: 660  loss:  0.1319  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,999  tflops: 23.45  mfu: 7.51%
[rank2]:2025-10-27 08:48:26,508 - INFO -  step: 660  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,994  tflops: 23.40  mfu: 7.50%
[rank3]:2025-10-27 08:48:27,786 - INFO - Avg. fwd time: 72.3954 / Avg. bwd time: 77.6915 / Avg. batch time: 1250.2402 (ms) / GPU bubble ratio: 3.96%
[rank2]:2025-10-27 08:48:27,821 - INFO - Avg. fwd time: 33.2328 / Avg. bwd time: 35.0218 / Avg. batch time: 1326.1819 (ms) / GPU bubble ratio: 58.83%
[rank1]:2025-10-27 08:48:27,875 - INFO - Avg. fwd time: 53.0688 / Avg. bwd time: 45.5493 / Avg. batch time: 1420.5852 (ms) / GPU bubble ratio: 44.46%
[rank0]:2025-10-27 08:48:27,881 - INFO - Avg. fwd time: 45.3409 / Avg. bwd time: 14.0029 / Avg. batch time: 1472.3514 (ms) / GPU bubble ratio: 67.76%
[rank0]:2025-10-27 08:50:15,648 - INFO -  step: 680  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 3,002  tflops: 23.47  mfu: 7.52%
[rank1]:2025-10-27 08:50:15,648 - INFO -  step: 680  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 3,002  tflops: 23.47  mfu: 7.52%
[rank3]:2025-10-27 08:50:15,649 - INFO -  step: 680  loss:  0.1399  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 3,002  tflops: 23.47  mfu: 7.52%
[rank2]:2025-10-27 08:50:15,647 - INFO -  step: 680  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 3,002  tflops: 23.47  mfu: 7.52%
[rank3]:2025-10-27 08:50:16,955 - INFO - Avg. fwd time: 72.3867 / Avg. bwd time: 77.4018 / Avg. batch time: 1247.8592 (ms) / GPU bubble ratio: 3.97%
[rank2]:2025-10-27 08:50:16,990 - INFO - Avg. fwd time: 33.2278 / Avg. bwd time: 34.8402 / Avg. batch time: 1323.4602 (ms) / GPU bubble ratio: 58.85%
[rank0]:2025-10-27 08:50:17,043 - INFO - Avg. fwd time: 45.3286 / Avg. bwd time: 13.5912 / Avg. batch time: 1468.8801 (ms) / GPU bubble ratio: 67.91%
[rank1]:2025-10-27 08:50:17,036 - INFO - Avg. fwd time: 53.0807 / Avg. bwd time: 45.3449 / Avg. batch time: 1417.5952 (ms) / GPU bubble ratio: 44.45%
[rank0]:2025-10-27 08:51:59,710 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-27 08:52:05,244 - INFO -  step: 700  loss:  0.1224  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,990  tflops: 23.37  mfu: 7.49%
[rank3]:2025-10-27 08:52:05,245 - INFO - ðŸ”Ž  Running validation at step 700
[rank2]:2025-10-27 08:52:05,243 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,990  tflops: 23.37  mfu: 7.49%
[rank2]:2025-10-27 08:52:05,243 - INFO - ðŸ”Ž  Running validation at step 700
[rank0]:2025-10-27 08:52:05,244 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,990  tflops: 23.37  mfu: 7.49%
[rank0]:2025-10-27 08:52:05,244 - INFO - ðŸ”Ž  Running validation at step 700
[rank1]:2025-10-27 08:52:05,244 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,990  tflops: 23.37  mfu: 7.49%
[rank1]:2025-10-27 08:52:05,244 - INFO - ðŸ”Ž  Running validation at step 700
[rank0]:2025-10-27 08:53:14,665 - INFO - validate step: 700  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,900
[rank1]:2025-10-27 08:53:14,751 - INFO - validate step: 700  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,893
[rank2]:2025-10-27 08:53:14,834 - INFO - validate step: 700  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,886
[rank3]:2025-10-27 08:53:14,915 - INFO - validate step: 700  loss:  0.2932  memory: 38.93GiB(81.95%)  tps: 5,879
[rank2]:2025-10-27 08:53:14,997 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251027_0853_stage2_step700.svg
[rank0]:2025-10-27 08:53:14,997 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251027_0853_stage0_step700.svg
[rank1]:2025-10-27 08:53:15,002 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251027_0853_stage1_step700.svg
[rank3]:2025-10-27 08:53:15,116 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1026_GPipe_fullrand7_dm1/pipeline_schedule/251027_0853_real_step700_rank3.svg
[rank3]:> Batch Time: 1315.00 ms, GPU Bubble Ratio: 72.22%, 43.94%, 62.41%, 13.85%
[rank3]:2025-10-27 08:53:15,189 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251027_0853_stage3_step700.svg
[rank2]:2025-10-27 08:53:16,443 - INFO - Avg. fwd time: 33.2257 / Avg. bwd time: 34.6700 / Avg. batch time: 1321.0892 (ms) / GPU bubble ratio: 58.89%
[rank3]:2025-10-27 08:53:16,406 - INFO - Avg. fwd time: 72.3938 / Avg. bwd time: 77.1374 / Avg. batch time: 1245.7786 (ms) / GPU bubble ratio: 3.98%
[rank1]:2025-10-27 08:53:16,487 - INFO - Avg. fwd time: 53.0866 / Avg. bwd time: 45.1510 / Avg. batch time: 1414.9708 (ms) / GPU bubble ratio: 44.46%
[rank0]:2025-10-27 08:53:16,493 - INFO - Avg. fwd time: 45.3210 / Avg. bwd time: 13.2031 / Avg. batch time: 1465.8024 (ms) / GPU bubble ratio: 68.06%
[rank0]:2025-10-27 08:55:05,291 - INFO -  step: 720  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,962  tflops: 23.16  mfu: 7.42%
[rank3]:2025-10-27 08:55:05,291 - INFO -  step: 720  loss:  0.2023  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,969  tflops: 23.21  mfu: 7.44%
[rank1]:2025-10-27 08:55:05,291 - INFO -  step: 720  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,964  tflops: 23.17  mfu: 7.43%
[rank2]:2025-10-27 08:55:05,290 - INFO -  step: 720  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,967  tflops: 23.19  mfu: 7.43%
[rank2]:2025-10-27 08:55:06,664 - INFO - Avg. fwd time: 33.2325 / Avg. bwd time: 34.5092 / Avg. batch time: 1319.0072 (ms) / GPU bubble ratio: 58.91%
[rank3]:2025-10-27 08:55:06,628 - INFO - Avg. fwd time: 72.4112 / Avg. bwd time: 76.8989 / Avg. batch time: 1243.9977 (ms) / GPU bubble ratio: 3.98%
[rank1]:2025-10-27 08:55:06,709 - INFO - Avg. fwd time: 53.0987 / Avg. bwd time: 44.9716 / Avg. batch time: 1412.6702 (ms) / GPU bubble ratio: 44.46%
[rank0]:2025-10-27 08:55:06,715 - INFO - Avg. fwd time: 45.3291 / Avg. bwd time: 12.8365 / Avg. batch time: 1463.0824 (ms) / GPU bubble ratio: 68.20%
[rank3]:2025-10-27 08:56:54,445 - INFO -  step: 740  loss:  0.1518  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 3,002  tflops: 23.47  mfu: 7.52%
[rank1]:2025-10-27 08:56:54,445 - INFO -  step: 740  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 3,002  tflops: 23.47  mfu: 7.52%
[rank2]:2025-10-27 08:56:54,444 - INFO -  step: 740  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 3,002  tflops: 23.47  mfu: 7.52%
[rank0]:2025-10-27 08:56:54,445 - INFO -  step: 740  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 3,002  tflops: 23.47  mfu: 7.52%
[rank3]:2025-10-27 08:56:55,719 - INFO - Avg. fwd time: 72.3993 / Avg. bwd time: 76.6548 / Avg. batch time: 1241.9515 (ms) / GPU bubble ratio: 3.99%
[rank2]:2025-10-27 08:56:55,755 - INFO - Avg. fwd time: 33.2312 / Avg. bwd time: 34.3565 / Avg. batch time: 1316.6695 (ms) / GPU bubble ratio: 58.93%
[rank0]:2025-10-27 08:56:55,806 - INFO - Avg. fwd time: 45.3193 / Avg. bwd time: 12.4898 / Avg. batch time: 1460.1273 (ms) / GPU bubble ratio: 68.33%
[rank1]:2025-10-27 08:56:55,799 - INFO - Avg. fwd time: 53.1105 / Avg. bwd time: 44.8004 / Avg. batch time: 1410.1199 (ms) / GPU bubble ratio: 44.45%
[rank0]:2025-10-27 08:57:43,451 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-27 08:58:43,753 - INFO -  step: 760  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,998  tflops: 23.44  mfu: 7.51%
[rank0]:2025-10-27 08:58:43,754 - INFO -  step: 760  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,998  tflops: 23.44  mfu: 7.51%
[rank3]:2025-10-27 08:58:43,755 - INFO -  step: 760  loss:  0.1367  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,998  tflops: 23.44  mfu: 7.51%
[rank1]:2025-10-27 08:58:43,754 - INFO -  step: 760  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,998  tflops: 23.43  mfu: 7.51%
[rank2]:2025-10-27 08:58:45,052 - INFO - Avg. fwd time: 33.2289 / Avg. bwd time: 34.2129 / Avg. batch time: 1314.5115 (ms) / GPU bubble ratio: 58.96%
[rank3]:2025-10-27 08:58:45,016 - INFO - Avg. fwd time: 72.3952 / Avg. bwd time: 76.4241 / Avg. batch time: 1240.0664 (ms) / GPU bubble ratio: 3.99%
[rank1]:2025-10-27 08:58:45,099 - INFO - Avg. fwd time: 53.1119 / Avg. bwd time: 44.6351 / Avg. batch time: 1407.7611 (ms) / GPU bubble ratio: 44.45%
[rank0]:2025-10-27 08:58:45,106 - INFO - Avg. fwd time: 45.3123 / Avg. bwd time: 12.1613 / Avg. batch time: 1457.3867 (ms) / GPU bubble ratio: 68.45%
[rank2]:2025-10-27 09:00:33,693 - INFO -  step: 780  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,981  tflops: 23.30  mfu: 7.47%
[rank0]:2025-10-27 09:00:33,694 - INFO -  step: 780  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,981  tflops: 23.30  mfu: 7.47%
[rank3]:2025-10-27 09:00:33,694 - INFO -  step: 780  loss:  0.1451  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,981  tflops: 23.30  mfu: 7.47%
[rank1]:2025-10-27 09:00:33,694 - INFO -  step: 780  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,981  tflops: 23.30  mfu: 7.47%
[rank3]:2025-10-27 09:00:35,033 - INFO - Avg. fwd time: 72.4009 / Avg. bwd time: 76.2209 / Avg. batch time: 1238.4945 (ms) / GPU bubble ratio: 4.00%
[rank2]:2025-10-27 09:00:35,070 - INFO - Avg. fwd time: 33.2297 / Avg. bwd time: 34.0763 / Avg. batch time: 1312.6840 (ms) / GPU bubble ratio: 58.98%
[rank0]:2025-10-27 09:00:35,122 - INFO - Avg. fwd time: 45.3064 / Avg. bwd time: 11.8496 / Avg. batch time: 1455.0229 (ms) / GPU bubble ratio: 68.57%
[rank1]:2025-10-27 09:00:35,115 - INFO - Avg. fwd time: 53.1372 / Avg. bwd time: 44.4829 / Avg. batch time: 1405.7579 (ms) / GPU bubble ratio: 44.45%
[rank0]:2025-10-27 09:02:18,709 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-27 09:02:24,304 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,962  tflops: 23.16  mfu: 7.42%
[rank2]:2025-10-27 09:02:24,304 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-10-27 09:02:24,305 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,962  tflops: 23.16  mfu: 7.42%
[rank0]:2025-10-27 09:02:24,305 - INFO - ðŸ”Ž  Running validation at step 800
[rank1]:2025-10-27 09:02:24,305 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,962  tflops: 23.16  mfu: 7.42%
[rank1]:2025-10-27 09:02:24,305 - INFO - ðŸ”Ž  Running validation at step 800
[rank3]:2025-10-27 09:02:24,305 - INFO -  step: 800  loss:  0.1129  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,963  tflops: 23.16  mfu: 7.42%
[rank3]:2025-10-27 09:02:24,306 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-10-27 09:03:33,841 - INFO - validate step: 800  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,891
[rank1]:2025-10-27 09:03:33,924 - INFO - validate step: 800  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,884
[rank2]:2025-10-27 09:03:34,004 - INFO - validate step: 800  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,877
[rank3]:2025-10-27 09:03:34,085 - INFO - validate step: 800  loss:  0.2951  memory: 38.93GiB(81.95%)  tps: 5,870
[rank0]:2025-10-27 09:03:34,167 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251027_0903_stage0_step800.svg
[rank1]:2025-10-27 09:03:34,169 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251027_0903_stage1_step800.svg
[rank2]:2025-10-27 09:03:34,168 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251027_0903_stage2_step800.svg
[rank3]:2025-10-27 09:03:34,273 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1026_GPipe_fullrand7_dm1/pipeline_schedule/251027_0903_real_step800_rank3.svg
[rank3]:> Batch Time: 1314.91 ms, GPU Bubble Ratio: 72.24%, 43.96%, 62.42%, 13.84%
[rank3]:2025-10-27 09:03:34,346 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251027_0903_stage3_step800.svg
[rank3]:2025-10-27 09:03:35,576 - INFO - Avg. fwd time: 72.4279 / Avg. bwd time: 76.0353 / Avg. batch time: 1237.1932 (ms) / GPU bubble ratio: 4.00%
[rank2]:2025-10-27 09:03:35,614 - INFO - Avg. fwd time: 33.2329 / Avg. bwd time: 33.9482 / Avg. batch time: 1311.1646 (ms) / GPU bubble ratio: 59.01%
[rank0]:2025-10-27 09:03:35,665 - INFO - Avg. fwd time: 45.3048 / Avg. bwd time: 11.5535 / Avg. batch time: 1452.9858 (ms) / GPU bubble ratio: 68.69%
[rank1]:2025-10-27 09:03:35,658 - INFO - Avg. fwd time: 53.1510 / Avg. bwd time: 44.3393 / Avg. batch time: 1404.0601 (ms) / GPU bubble ratio: 44.45%
[rank3]:2025-10-27 09:04:36,223 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-27 09:04:36,966 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-27 09:04:36,925 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-27 09:04:36,966 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-27 09:05:28,222 - INFO -  step: 820  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,867  tflops: 22.41  mfu: 7.18%
[rank3]:2025-10-27 09:05:28,223 - INFO -  step: 820  loss:  0.1508  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,871  tflops: 22.44  mfu: 7.19%
[rank2]:2025-10-27 09:05:28,221 - INFO -  step: 820  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,869  tflops: 22.43  mfu: 7.19%
[rank0]:2025-10-27 09:05:28,222 - INFO -  step: 820  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,865  tflops: 22.40  mfu: 7.18%
[rank3]:2025-10-27 09:05:29,473 - INFO - Avg. fwd time: 72.4171 / Avg. bwd time: 75.8364 / Avg. batch time: 1235.5259 (ms) / GPU bubble ratio: 4.01%
[rank2]:2025-10-27 09:05:29,509 - INFO - Avg. fwd time: 33.2307 / Avg. bwd time: 33.8231 / Avg. batch time: 1309.2621 (ms) / GPU bubble ratio: 59.03%
[rank0]:2025-10-27 09:05:29,563 - INFO - Avg. fwd time: 45.3029 / Avg. bwd time: 11.2718 / Avg. batch time: 1450.5790 (ms) / GPU bubble ratio: 68.80%
[rank1]:2025-10-27 09:05:29,555 - INFO - Avg. fwd time: 53.1581 / Avg. bwd time: 44.1995 / Avg. batch time: 1401.9777 (ms) / GPU bubble ratio: 44.45%
[rank1]:2025-10-27 09:07:17,262 - INFO -  step: 840  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 3,005  tflops: 23.49  mfu: 7.53%
[rank2]:2025-10-27 09:07:17,261 - INFO -  step: 840  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 3,005  tflops: 23.49  mfu: 7.53%
[rank0]:2025-10-27 09:07:17,262 - INFO -  step: 840  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 3,005  tflops: 23.49  mfu: 7.53%
[rank3]:2025-10-27 09:07:17,262 - INFO -  step: 840  loss:  0.1479  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 3,005  tflops: 23.49  mfu: 7.53%
[rank3]:2025-10-27 09:07:18,530 - INFO - Avg. fwd time: 72.4068 / Avg. bwd time: 75.6471 / Avg. batch time: 1233.9271 (ms) / GPU bubble ratio: 4.01%
[rank2]:2025-10-27 09:07:18,567 - INFO - Avg. fwd time: 33.2288 / Avg. bwd time: 33.7036 / Avg. batch time: 1307.4338 (ms) / GPU bubble ratio: 59.05%
[rank0]:2025-10-27 09:07:18,620 - INFO - Avg. fwd time: 45.2957 / Avg. bwd time: 11.0036 / Avg. batch time: 1448.2653 (ms) / GPU bubble ratio: 68.90%
[rank1]:2025-10-27 09:07:18,613 - INFO - Avg. fwd time: 53.1569 / Avg. bwd time: 44.0667 / Avg. batch time: 1399.9770 (ms) / GPU bubble ratio: 44.44%
[rank0]:2025-10-27 09:08:07,204 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-27 09:09:07,082 - INFO -  step: 860  loss:  0.1245  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,984  tflops: 23.33  mfu: 7.48%
[rank1]:2025-10-27 09:09:07,081 - INFO -  step: 860  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,984  tflops: 23.33  mfu: 7.48%
[rank0]:2025-10-27 09:09:07,081 - INFO -  step: 860  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,984  tflops: 23.33  mfu: 7.48%
[rank2]:2025-10-27 09:09:07,080 - INFO -  step: 860  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,984  tflops: 23.33  mfu: 7.48%
[rank2]:2025-10-27 09:09:08,445 - INFO - Avg. fwd time: 33.2304 / Avg. bwd time: 33.5918 / Avg. batch time: 1305.9097 (ms) / GPU bubble ratio: 59.06%
[rank3]:2025-10-27 09:09:08,408 - INFO - Avg. fwd time: 72.4195 / Avg. bwd time: 75.4743 / Avg. batch time: 1232.6167 (ms) / GPU bubble ratio: 4.01%
[rank1]:2025-10-27 09:09:08,490 - INFO - Avg. fwd time: 53.1638 / Avg. bwd time: 43.9395 / Avg. batch time: 1398.3026 (ms) / GPU bubble ratio: 44.45%
[rank0]:2025-10-27 09:09:08,497 - INFO - Avg. fwd time: 45.2869 / Avg. bwd time: 10.7478 / Avg. batch time: 1446.2971 (ms) / GPU bubble ratio: 69.01%
[rank2]:2025-10-27 09:10:57,291 - INFO -  step: 880  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,973  tflops: 23.24  mfu: 7.45%
[rank0]:2025-10-27 09:10:57,293 - INFO -  step: 880  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,973  tflops: 23.24  mfu: 7.45%
[rank3]:2025-10-27 09:10:57,292 - INFO -  step: 880  loss:  0.1071  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,973  tflops: 23.24  mfu: 7.45%
[rank1]:2025-10-27 09:10:57,292 - INFO -  step: 880  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,973  tflops: 23.24  mfu: 7.45%
[rank2]:2025-10-27 09:10:58,667 - INFO - Avg. fwd time: 33.2333 / Avg. bwd time: 33.4854 / Avg. batch time: 1304.5567 (ms) / GPU bubble ratio: 59.09%
[rank0]:2025-10-27 09:10:58,721 - INFO - Avg. fwd time: 45.2912 / Avg. bwd time: 10.5037 / Avg. batch time: 1444.5147 (ms) / GPU bubble ratio: 69.10%
[rank3]:2025-10-27 09:10:58,629 - INFO - Avg. fwd time: 72.4345 / Avg. bwd time: 75.3165 / Avg. batch time: 1231.4620 (ms) / GPU bubble ratio: 4.02%
[rank1]:2025-10-27 09:10:58,713 - INFO - Avg. fwd time: 53.1735 / Avg. bwd time: 43.8188 / Avg. batch time: 1396.7996 (ms) / GPU bubble ratio: 44.45%
[rank0]:2025-10-27 09:12:41,045 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-27 09:12:46,364 - INFO -  step: 900  loss:  0.1324  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 3,005  tflops: 23.49  mfu: 7.53%
[rank3]:2025-10-27 09:12:46,364 - INFO - ðŸ”Ž  Running validation at step 900
[rank2]:2025-10-27 09:12:46,362 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 3,004  tflops: 23.49  mfu: 7.53%
[rank2]:2025-10-27 09:12:46,362 - INFO - ðŸ”Ž  Running validation at step 900
[rank1]:2025-10-27 09:12:46,363 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 3,004  tflops: 23.49  mfu: 7.53%
[rank1]:2025-10-27 09:12:46,364 - INFO - ðŸ”Ž  Running validation at step 900
[rank0]:2025-10-27 09:12:46,364 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 3,004  tflops: 23.49  mfu: 7.53%
[rank0]:2025-10-27 09:12:46,364 - INFO - ðŸ”Ž  Running validation at step 900
[rank0]:2025-10-27 09:13:55,629 - INFO - validate step: 900  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,914
[rank1]:2025-10-27 09:13:55,712 - INFO - validate step: 900  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,906
[rank2]:2025-10-27 09:13:55,789 - INFO - validate step: 900  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,900
[rank0]:2025-10-27 09:13:55,948 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251027_0913_stage0_step900.svg
[rank3]:2025-10-27 09:13:55,872 - INFO - validate step: 900  loss:  0.2929  memory: 38.93GiB(81.95%)  tps: 5,893
[rank2]:2025-10-27 09:13:55,947 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251027_0913_stage2_step900.svg
[rank1]:2025-10-27 09:13:55,948 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251027_0913_stage1_step900.svg
[rank3]:2025-10-27 09:13:56,059 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1026_GPipe_fullrand7_dm1/pipeline_schedule/251027_0913_real_step900_rank3.svg
[rank3]:> Batch Time: 1314.60 ms, GPU Bubble Ratio: 72.23%, 43.98%, 62.41%, 13.84%
[rank3]:2025-10-27 09:13:56,127 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251027_0913_stage3_step900.svg
[rank3]:2025-10-27 09:13:57,295 - INFO - Avg. fwd time: 72.4254 / Avg. bwd time: 75.1482 / Avg. batch time: 1230.0301 (ms) / GPU bubble ratio: 4.02%
[rank2]:2025-10-27 09:13:57,332 - INFO - Avg. fwd time: 33.2317 / Avg. bwd time: 33.3829 / Avg. batch time: 1302.9443 (ms) / GPU bubble ratio: 59.10%
[rank1]:2025-10-27 09:13:57,377 - INFO - Avg. fwd time: 53.1689 / Avg. bwd time: 43.7043 / Avg. batch time: 1395.0482 (ms) / GPU bubble ratio: 44.45%
[rank0]:2025-10-27 09:13:57,385 - INFO - Avg. fwd time: 45.2804 / Avg. bwd time: 10.2703 / Avg. batch time: 1442.4924 (ms) / GPU bubble ratio: 69.19%
[rank1]:2025-10-27 09:15:45,220 - INFO -  step: 920  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,992  tflops: 23.39  mfu: 7.50%
[rank2]:2025-10-27 09:15:45,219 - INFO -  step: 920  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,994  tflops: 23.41  mfu: 7.50%
[rank3]:2025-10-27 09:15:45,220 - INFO -  step: 920  loss:  0.1567  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,997  tflops: 23.43  mfu: 7.51%
[rank0]:2025-10-27 09:15:45,220 - INFO -  step: 920  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,990  tflops: 23.37  mfu: 7.49%
[rank2]:2025-10-27 09:15:46,545 - INFO - Avg. fwd time: 33.2313 / Avg. bwd time: 33.2831 / Avg. batch time: 1301.4610 (ms) / GPU bubble ratio: 59.11%
[rank3]:2025-10-27 09:15:46,508 - INFO - Avg. fwd time: 72.4237 / Avg. bwd time: 74.9895 / Avg. batch time: 1228.7369 (ms) / GPU bubble ratio: 4.02%
[rank0]:2025-10-27 09:15:46,598 - INFO - Avg. fwd time: 45.2734 / Avg. bwd time: 10.0472 / Avg. batch time: 1440.5946 (ms) / GPU bubble ratio: 69.28%
[rank1]:2025-10-27 09:15:46,590 - INFO - Avg. fwd time: 53.1602 / Avg. bwd time: 43.5903 / Avg. batch time: 1393.4106 (ms) / GPU bubble ratio: 44.45%
[rank1]:2025-10-27 09:17:34,707 - INFO -  step: 940  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,993  tflops: 23.40  mfu: 7.50%
[rank3]:2025-10-27 09:17:34,707 - INFO -  step: 940  loss:  0.1280  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,993  tflops: 23.40  mfu: 7.50%
[rank2]:2025-10-27 09:17:34,706 - INFO -  step: 940  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,993  tflops: 23.40  mfu: 7.50%
[rank0]:2025-10-27 09:17:34,707 - INFO -  step: 940  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,993  tflops: 23.40  mfu: 7.50%
[rank3]:2025-10-27 09:17:35,992 - INFO - Avg. fwd time: 72.4257 / Avg. bwd time: 74.8431 / Avg. batch time: 1227.5557 (ms) / GPU bubble ratio: 4.02%
[rank2]:2025-10-27 09:17:36,030 - INFO - Avg. fwd time: 33.2291 / Avg. bwd time: 33.1887 / Avg. batch time: 1300.0987 (ms) / GPU bubble ratio: 59.13%
[rank1]:2025-10-27 09:17:36,075 - INFO - Avg. fwd time: 53.1576 / Avg. bwd time: 43.4828 / Avg. batch time: 1391.9123 (ms) / GPU bubble ratio: 44.46%
[rank0]:2025-10-27 09:17:36,083 - INFO - Avg. fwd time: 45.2661 / Avg. bwd time: 9.8335 / Avg. batch time: 1438.8489 (ms) / GPU bubble ratio: 69.36%
[rank0]:2025-10-27 09:18:24,185 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-27 09:19:24,788 - INFO -  step: 960  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,977  tflops: 23.27  mfu: 7.46%
[rank1]:2025-10-27 09:19:24,788 - INFO -  step: 960  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,977  tflops: 23.27  mfu: 7.46%
[rank3]:2025-10-27 09:19:24,788 - INFO -  step: 960  loss:  0.0984  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,977  tflops: 23.27  mfu: 7.46%
[rank2]:2025-10-27 09:19:24,787 - INFO -  step: 960  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,977  tflops: 23.27  mfu: 7.46%
[rank3]:2025-10-27 09:19:26,132 - INFO - Avg. fwd time: 72.4417 / Avg. bwd time: 74.7088 / Avg. batch time: 1226.5938 (ms) / GPU bubble ratio: 4.03%
[rank2]:2025-10-27 09:19:26,170 - INFO - Avg. fwd time: 33.2307 / Avg. bwd time: 33.0994 / Avg. batch time: 1298.9643 (ms) / GPU bubble ratio: 59.15%
[rank1]:2025-10-27 09:19:26,217 - INFO - Avg. fwd time: 53.1596 / Avg. bwd time: 43.3800 / Avg. batch time: 1390.6467 (ms) / GPU bubble ratio: 44.46%
[rank0]:2025-10-27 09:19:26,225 - INFO - Avg. fwd time: 45.2631 / Avg. bwd time: 9.6287 / Avg. batch time: 1437.3474 (ms) / GPU bubble ratio: 69.45%
[rank1]:2025-10-27 09:21:14,545 - INFO -  step: 980  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,986  tflops: 23.34  mfu: 7.48%
[rank3]:2025-10-27 09:21:14,545 - INFO -  step: 980  loss:  0.1256  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,986  tflops: 23.34  mfu: 7.48%
[rank2]:2025-10-27 09:21:14,544 - INFO -  step: 980  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,986  tflops: 23.34  mfu: 7.48%
[rank0]:2025-10-27 09:21:14,545 - INFO -  step: 980  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,986  tflops: 23.34  mfu: 7.48%
[rank3]:2025-10-27 09:21:15,818 - INFO - Avg. fwd time: 72.4449 / Avg. bwd time: 74.5756 / Avg. batch time: 1225.5497 (ms) / GPU bubble ratio: 4.03%
[rank2]:2025-10-27 09:21:15,855 - INFO - Avg. fwd time: 33.2308 / Avg. bwd time: 33.0140 / Avg. batch time: 1297.7556 (ms) / GPU bubble ratio: 59.16%
[rank0]:2025-10-27 09:21:15,910 - INFO - Avg. fwd time: 45.2628 / Avg. bwd time: 9.4323 / Avg. batch time: 1435.7895 (ms) / GPU bubble ratio: 69.52%
[rank1]:2025-10-27 09:21:15,902 - INFO - Avg. fwd time: 53.1701 / Avg. bwd time: 43.2815 / Avg. batch time: 1389.3168 (ms) / GPU bubble ratio: 44.46%
[rank0]:2025-10-27 09:22:58,377 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-27 09:23:03,800 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,999  tflops: 23.45  mfu: 7.51%
[rank1]:2025-10-27 09:23:03,807 - INFO -  final step: 1000  loss: -4.0000  grad_norm:  0.0000  tps: 2,876  tflops: 22.48  mfu: 7.07%
[rank1]:2025-10-27 09:23:03,807 - INFO - ðŸ”Ž  Running validation at step 1000
[rank3]:2025-10-27 09:23:03,800 - INFO -  step: 1000  loss:  0.1322  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,999  tflops: 23.45  mfu: 7.52%
[rank3]:2025-10-27 09:23:03,808 - INFO -  final step: 1000  loss:  0.1322  grad_norm:  0.0000  tps: 2,877  tflops: 22.49  mfu: 7.08%
[rank3]:2025-10-27 09:23:03,809 - INFO - ðŸ”Ž  Running validation at step 1000
[rank2]:2025-10-27 09:23:03,799 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,999  tflops: 23.45  mfu: 7.51%
[rank2]:2025-10-27 09:23:03,799 - INFO -  final step: 1000  loss: -4.0000  grad_norm:  0.0000  tps: 2,876  tflops: 22.48  mfu: 7.07%
[rank2]:2025-10-27 09:23:03,807 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-10-27 09:23:03,800 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,999  tflops: 23.45  mfu: 7.51%
[rank0]:2025-10-27 09:23:03,807 - INFO -  final step: 1000  loss: -4.0000  grad_norm:  0.0000  tps: 2,875  tflops: 22.48  mfu: 7.07%
[rank0]:2025-10-27 09:23:03,807 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-10-27 09:24:12,451 - INFO - validate step: 1000  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,967
[rank0]:2025-10-27 09:24:12,452 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-27 09:24:12,454 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1000.
[rank1]:2025-10-27 09:24:12,532 - INFO - validate step: 1000  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,960
[rank1]:2025-10-27 09:24:12,533 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-27 09:24:12,535 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1000.
[rank2]:2025-10-27 09:24:12,614 - INFO - validate step: 1000  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,953
[rank2]:2025-10-27 09:24:12,615 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-27 09:24:12,617 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1000.
[rank3]:2025-10-27 09:24:12,694 - INFO - validate step: 1000  loss:  0.2949  memory: 38.93GiB(81.95%)  tps: 5,946
[rank3]:2025-10-27 09:24:12,695 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-27 09:24:12,697 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1000.
[rank0]:2025-10-27 09:24:14,911 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank0]:2025-10-27 09:24:14,992 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251027_0924_stage0_final1000.svg
[rank2]:2025-10-27 09:24:14,992 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251027_0924_stage2_final1000.svg
[rank1]:2025-10-27 09:24:14,995 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251027_0924_stage1_final1000.svg
[rank3]:2025-10-27 09:24:15,104 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1026_GPipe_fullrand7_dm1/pipeline_schedule/251027_0924_real_final1000_rank3.svg
[rank3]:> Batch Time: 1314.11 ms, GPU Bubble Ratio: 72.24%, 43.99%, 62.41%, 13.83%
[rank0]:2025-10-27 09:24:15,205 - INFO - Elementwise Histogram is saved as: /data3/shcho/torchtitan/images/1026_GPipe_fullrand7_dm1/frozen_params_histogram/251027_0924_rank0_stage0.svg
[rank0]:	> Counts Sum: 930520, Total Sum: 1065600 (87.32%), Ratio(%) per element: [87.36, 87.22, 87.15, 87.15, 87.29, 87.22, 87.22, 87.08, 87.22, 87.08, 87.22, 87.29, 87.15, 87.22, 87.29, 87.15, 87.43, 87.36, 87.29, 87.29, 87.36, 87.36, 87.5, 87.22, 87.29, 87.43, 87.36, 87.63, 87.43, 87.36, 87.5, 87.36, 87.29, 87.63, 87.5, 87.56, 87.43]
[rank0]:2025-10-27 09:24:15,205 - INFO - Sleeping 2 seconds for other ranks to complete
[rank2]:2025-10-27 09:24:15,200 - INFO - Elementwise Histogram is saved as: /data3/shcho/torchtitan/images/1026_GPipe_fullrand7_dm1/frozen_params_histogram/251027_0924_rank2_stage2.svg
[rank2]:	> Counts Sum: 908280, Total Sum: 1036800 (87.60%), Ratio(%) per element: [87.63, 87.63, 87.56, 87.56, 87.56, 87.56, 87.7, 87.56, 87.63, 87.63, 87.56, 87.56, 87.63, 87.63, 87.56, 87.56, 87.56, 87.56, 87.63, 87.56, 87.56, 87.56, 87.63, 87.56, 87.56, 87.56, 87.7, 87.63, 87.7, 87.56, 87.63, 87.56, 87.63, 87.56, 87.63, 87.56]
[rank2]:2025-10-27 09:24:15,200 - INFO - Destroying the purge thread.
[rank1]:2025-10-27 09:24:15,199 - INFO - Elementwise Histogram is saved as: /data3/shcho/torchtitan/images/1026_GPipe_fullrand7_dm1/frozen_params_histogram/251027_0924_rank1_stage1.svg
[rank1]:	> Counts Sum: 1121520, Total Sum: 1296000 (86.54%), Ratio(%) per element: [86.8, 86.73, 86.66, 86.52, 86.52, 86.31, 86.59, 86.45, 86.38, 86.66, 86.45, 86.52, 86.38, 86.45, 86.59, 86.8, 86.66, 86.66, 86.45, 86.45, 86.25, 86.52, 86.52, 86.11, 86.73, 86.45, 86.59, 86.94, 86.45, 86.66, 86.25, 86.52, 86.52, 86.38, 86.45, 86.94, 86.38, 86.52, 86.66, 86.59, 86.45, 86.18, 86.52, 86.66, 86.59]
[rank1]:2025-10-27 09:24:15,199 - INFO - Destroying the purge thread.
[rank3]:2025-10-27 09:24:15,294 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1026_GPipe_fullrand7_dm1/pipeline_schedule/251027_0924_thry_final1000_rank3.svg
[rank3]:> Batch Time: 1691.75 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:2025-10-27 09:24:15,359 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1026_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251027_0924_stage3_final1000.svg
[rank2]:2025-10-27 09:24:15,558 - INFO - Process group destroyed
[rank1]:2025-10-27 09:24:15,532 - INFO - Process group destroyed
[rank3]:2025-10-27 09:24:15,544 - INFO - Elementwise Histogram is saved as: /data3/shcho/torchtitan/images/1026_GPipe_fullrand7_dm1/frozen_params_histogram/251027_0924_rank3_stage3.svg
[rank3]:	> Counts Sum: 2560, Total Sum: 835200 (0.31%), Ratio(%) per element: [0.34, 0.2, 0.2, 0.27, 0.34, 0.34, 0.34, 0.34, 0.34, 0.2, 0.27, 0.27, 0.34, 0.2, 0.41, 0.41, 0.41, 0.34, 0.27, 0.34, 0.34, 0.27, 0.41, 0.2, 0.48, 0.2, 0.2, 0.34, 0.06]
[rank3]:2025-10-27 09:24:15,545 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading history steps 50-50, summary, console lines 390-400
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ƒâ–ˆâ–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ƒâ–ˆâ–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ƒâ–ˆâ–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 5.69399
[rank3]:wandb:               final/avg_loss 0.1322
[rank3]:wandb:             final/avg_mfu(%) 7.07668
[rank3]:wandb:             final/avg_tflops 22.49436
[rank3]:wandb:    final/avg_throughput(tps) 2877.42201
[rank3]:wandb:              final/grad_norm 0
[rank3]:wandb:               final/max_loss 0.1322
[rank3]:wandb:                    grad_norm 0
[rank3]:wandb: loss_metrics/global_avg_loss 0.1322
[rank3]:wandb: loss_metrics/global_max_loss 0.1322
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1026_GPipe_fullrand7_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/otlayoet
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data3/shcho/torchtitan/tb/1026_GPipe_fullrand7_dm1/20251027-0735/wandb/run-20251027_073548-otlayoet/logs
[rank3]:2025-10-27 09:24:17,017 - INFO - Process group destroyed
[rank0]:2025-10-27 09:24:17,205 - INFO - Training completed
[rank0]:2025-10-27 09:24:17,206 - INFO - Destroying the purge thread.
[rank0]:2025-10-27 09:24:17,254 - INFO - Process group destroyed
[rank2]:Stage 2: Modules to keep: {'layers.9', 'layers.12', 'layers.10', 'layers.11'}
[rank1]:Stage 1: Modules to keep: {'layers.6', 'layers.7', 'layers.5', 'layers.8', 'layers.4'}
[rank0]:Stage 0: Modules to keep: {'layers.0', 'layers.1', 'layers.3', 'tok_embeddings', 'layers.2'}
[rank3]:Stage 3: Modules to keep: {'norm', 'layers.15', 'output', 'layers.13', 'layers.14'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1026_llama1b/config.toml
[rank3]:		- dump_folder: /data3/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1026_GPipe_fullrand7_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data3/shcho/torchtitan/profile_trace/1026_GPipe_fullrand7_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data3/shcho/torchtitan/memory_snapshot/1026_GPipe_fullrand7_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 20
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data3/shcho/torchtitan/tb/1026_GPipe_fullrand7_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data3/shcho/torchtitan/images/1026_GPipe_fullrand7_dm1
[rank3]:		- pplog_freq: 80
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1026_GPipe_fullrand7_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B-Instruct
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 2e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: alpaca
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 1000
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: GPipe
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data3/shcho/torchtitan/checkpoint/1026_GPipe_fullrand7_dm1
[rank3]:		- interval: 500
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B-Instruct/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data3/shcho/torchtitan/comm_traces/1026_GPipe_fullrand7_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: True
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- seq_len: 1024
[rank3]:		- freq: 100
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: fullrand7
[rank3]:		- phase_unit: 10
[rank3]:		- stability_check_freq: 5
[rank3]:		- aggressiveness: 0
[rank3]:
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
