
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 10. 27. (ì›”) 22:44:01 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 3,4,5,6
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1026_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1026_llama1b/1027_GPipe_fullrand7.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation
âœ”ï¸Running with fullrand7 x GPipe ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1026_llama1b/config.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=fullrand7
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank2]:2025-10-27 22:44:07,487 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation"
[rank1]:2025-10-27 22:44:07,478 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation"
[rank3]:2025-10-27 22:44:07,589 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation"
[rank0]:2025-10-27 22:44:07,664 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation"
[rank3]:2025-10-27 22:44:08,163 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-10-27 22:44:08,166 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-27 22:44:08,195 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-10-27 22:44:08,198 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-27 22:44:08,201 - INFO - [GC] Initial GC collection 0.00 seconds
[rank1]:2025-10-27 22:44:08,175 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-10-27 22:44:08,206 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-10-27 22:44:08,177 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-10-27 22:44:08,208 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-27 22:44:08,710 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-10-27 22:44:09,122 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank1]:2025-10-27 22:44:12,185 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-10-27 22:44:12,228 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-10-27 22:44:12,256 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-10-27 22:44:12,256 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-10-27 22:44:12,264 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank2]:2025-10-27 22:44:12,448 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-10-27 22:44:12,436 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-10-27 22:44:12,436 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-10-27 22:44:12,490 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-10-27 22:44:12,437 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank2]:2025-10-27 22:44:12,519 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank0]:2025-10-27 22:44:12,432 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-10-27 22:44:12,477 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-10-27 22:44:12,478 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-10-27 22:44:12,503 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-10-27 22:44:12,504 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank2]:2025-10-27 22:44:12,519 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank2]:2025-10-27 22:44:12,697 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-10-27 22:44:12,697 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-10-27 22:44:12,698 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank0]:2025-10-27 22:44:12,707 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-10-27 22:44:12,707 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-10-27 22:44:12,708 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run 625k997w
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data3/shcho/torchtitan/tb/1027_GPipe_fullrand7_dm1/20251027-2244/wandb/run-20251027_224413-625k997w
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1027_GPipe_fullrand7_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/625k997w
[rank3]:2025-10-27 22:44:14,303 - INFO - WandB logging enabled
[rank3]:2025-10-27 22:44:14,304 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-10-27 22:44:14,343 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-10-27 22:44:14,369 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-10-27 22:44:14,370 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank3]:2025-10-27 22:44:14,552 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-10-27 22:44:14,553 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-10-27 22:44:14,554 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank0]:2025-10-27 22:44:14,568 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data3/shcho/torchtitan/checkpoint/1027_GPipe_fullrand7_dm1
[rank0]:2025-10-27 22:44:14,569 - WARNING - Mixed precision training with TP or PP is only supported when FSDP/HSDP/CP is enabled.
[rank0]:2025-10-27 22:44:14,569 - INFO - Mixed precision training is disabled
[rank0]:2025-10-27 22:44:14,569 - INFO - Preparing c4_validation dataset from allenai/c4
[rank0]:2025-10-27 22:44:18,298 - INFO - Trainer is initialized with local batch size 16, global batch size 64, gradient accumulation steps 4, sequence length 1024, total steps 1000 (warmup 100)
[rank0]:2025-10-27 22:44:18,298 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B-Instruct/original_dcp.
[rank0]:2025-10-27 22:44:22,994 - INFO - [GC] GC collection for checkpoint loading. 0.01 seconds
[rank0]:2025-10-27 22:44:22,994 - INFO - Finished loading the checkpoint in 4.70 seconds.
[rank0]:2025-10-27 22:44:22,994 - INFO - Training starts at step 1
[rank0]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/autograd/graph.py:849: UserWarning: Attempting to run cuBLAS, but there was no current CUDA context! Attempting to set the primary context... (Triggered internally at /pytorch/aten/src/ATen/cuda/CublasHandlePool.cpp:270.)
[rank0]:  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
[rank3]:2025-10-27 22:44:34,950 - INFO -  step:  1  loss:  9.8281  grad_norm: 53.2563  memory: 35.59GiB(74.92%)  tps: 795  tflops: 6.22  mfu: 1.99%
[rank1]:2025-10-27 22:44:34,943 - INFO -  step:  1  loss: -4.0000  grad_norm: 53.2563  memory: 17.77GiB(37.40%)  tps: 721  tflops: 5.64  mfu: 1.81%
[rank1]:2025-10-27 22:44:34,943 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-10-27 22:44:34,939 - INFO -  step:  1  loss: -4.0000  grad_norm: 53.2563  memory: 14.29GiB(30.07%)  tps: 730  tflops: 5.71  mfu: 1.83%
[rank2]:2025-10-27 22:44:34,940 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-27 22:44:34,951 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-10-27 22:44:34,966 - INFO -  step:  1  loss: -4.0000  grad_norm: 53.2563  memory: 17.10GiB(35.99%)  tps: 729  tflops: 5.70  mfu: 1.83%
[rank0]:2025-10-27 22:44:34,966 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-27 22:44:48,196 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 22:44:48,197 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 22:44:48,198 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 22:44:48,198 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 22:44:48,198 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 22:44:48,198 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 22:44:48,199 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 22:44:48,199 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 22:44:48,199 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 22:44:48,199 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 22:44:48,200 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 22:44:48,200 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 22:44:48,200 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 22:44:48,200 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 22:44:48,201 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 22:44:48,201 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 22:44:48,257 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 22:44:48,257 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 22:44:48,257 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 22:44:48,257 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 22:44:48,257 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 22:44:48,257 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 22:44:48,257 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 22:44:48,257 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 22:44:48,257 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 22:44:48,257 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 22:44:48,258 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 22:44:48,258 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 22:44:48,258 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 22:44:48,258 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 22:44:48,258 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 22:44:48,258 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 22:44:48,333 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 22:44:48,333 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 22:44:48,333 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 22:44:48,333 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 22:44:48,333 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 22:44:48,334 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 22:44:48,334 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 22:44:48,334 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 22:44:48,334 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 22:44:48,334 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 22:44:48,334 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 22:44:48,334 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 22:44:48,334 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 22:44:48,334 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 22:44:48,334 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 22:44:48,334 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 22:44:48,398 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 22:44:48,398 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 22:44:48,398 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 22:44:48,398 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 22:44:48,398 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 22:44:48,398 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 22:44:48,398 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 22:44:48,398 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 22:44:48,398 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 22:44:48,398 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 22:44:48,398 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 22:44:48,398 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 22:44:48,398 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 22:44:48,399 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 22:44:48,399 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 22:44:48,399 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 22:47:05,746 - INFO -  step: 20  loss: 12.1439  grad_norm: 26.1656  memory: 38.93GiB(81.95%)  tps: 2,064  tflops: 16.14  mfu: 5.17%
[rank1]:2025-10-27 22:47:05,738 - INFO -  step: 20  loss: -4.0000  grad_norm: 26.1656  memory: 20.03GiB(42.17%)  tps: 2,064  tflops: 16.14  mfu: 5.17%
[rank2]:2025-10-27 22:47:05,734 - INFO -  step: 20  loss: -4.0000  grad_norm: 26.1656  memory: 16.10GiB(33.90%)  tps: 2,064  tflops: 16.14  mfu: 5.17%
[rank0]:2025-10-27 22:47:05,750 - INFO -  step: 20  loss: -4.0000  grad_norm: 26.1656  memory: 20.89GiB(43.97%)  tps: 2,065  tflops: 16.14  mfu: 5.17%
[rank3]:2025-10-27 22:47:07,525 - INFO - Avg. fwd time: 70.6014 / Avg. bwd time: 127.5505 / Avg. batch time: 1653.7944 (ms) / GPU bubble ratio: 4.15%
[rank2]:2025-10-27 22:47:07,584 - INFO - Avg. fwd time: 32.6775 / Avg. bwd time: 53.0831 / Avg. batch time: 1743.0490 (ms) / GPU bubble ratio: 60.64%
[rank1]:2025-10-27 22:47:07,661 - INFO - Avg. fwd time: 50.3320 / Avg. bwd time: 72.3491 / Avg. batch time: 1862.2535 (ms) / GPU bubble ratio: 47.30%
[rank0]:2025-10-27 22:47:07,726 - INFO - Avg. fwd time: 45.1964 / Avg. bwd time: 59.7728 / Avg. batch time: 1960.5907 (ms) / GPU bubble ratio: 57.17%
[rank1]:2025-10-27 22:49:45,709 - INFO -  step: 40  loss: -4.0000  grad_norm: 16.4181  memory: 20.03GiB(42.17%)  tps: 2,048  tflops: 16.01  mfu: 5.13%
[rank3]:2025-10-27 22:49:45,717 - INFO -  step: 40  loss:  9.0251  grad_norm: 16.4181  memory: 38.93GiB(81.95%)  tps: 2,048  tflops: 16.01  mfu: 5.13%
[rank2]:2025-10-27 22:49:45,705 - INFO -  step: 40  loss: -4.0000  grad_norm: 16.4181  memory: 16.10GiB(33.90%)  tps: 2,048  tflops: 16.01  mfu: 5.13%
[rank0]:2025-10-27 22:49:45,721 - INFO -  step: 40  loss: -4.0000  grad_norm: 16.4181  memory: 20.89GiB(43.97%)  tps: 2,048  tflops: 16.01  mfu: 5.13%
[rank3]:2025-10-27 22:49:47,505 - INFO - Avg. fwd time: 71.4596 / Avg. bwd time: 129.0595 / Avg. batch time: 1662.5195 (ms) / GPU bubble ratio: 3.51%
[rank2]:2025-10-27 22:49:47,565 - INFO - Avg. fwd time: 32.9279 / Avg. bwd time: 53.6272 / Avg. batch time: 1751.9054 (ms) / GPU bubble ratio: 60.47%
[rank1]:2025-10-27 22:49:47,636 - INFO - Avg. fwd time: 51.0121 / Avg. bwd time: 72.9032 / Avg. batch time: 1871.0633 (ms) / GPU bubble ratio: 47.02%
[rank0]:2025-10-27 22:49:47,699 - INFO - Avg. fwd time: 45.8179 / Avg. bwd time: 60.2181 / Avg. batch time: 1969.7239 (ms) / GPU bubble ratio: 56.93%
[rank0]:2025-10-27 22:50:58,146 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-27 22:52:25,088 - INFO -  step: 60  loss: -4.0000  grad_norm: 21.7794  memory: 20.03GiB(42.17%)  tps: 2,056  tflops: 16.07  mfu: 5.15%
[rank3]:2025-10-27 22:52:25,096 - INFO -  step: 60  loss:  5.6970  grad_norm: 21.7794  memory: 38.93GiB(81.95%)  tps: 2,056  tflops: 16.07  mfu: 5.15%
[rank0]:2025-10-27 22:52:25,108 - INFO -  step: 60  loss: -4.0000  grad_norm: 21.7794  memory: 20.89GiB(43.97%)  tps: 2,056  tflops: 16.07  mfu: 5.15%
[rank2]:2025-10-27 22:52:25,084 - INFO -  step: 60  loss: -4.0000  grad_norm: 21.7794  memory: 16.10GiB(33.90%)  tps: 2,056  tflops: 16.07  mfu: 5.15%
[rank3]:2025-10-27 22:52:26,905 - INFO - Avg. fwd time: 71.5930 / Avg. bwd time: 129.3536 / Avg. batch time: 1662.7229 (ms) / GPU bubble ratio: 3.32%
[rank2]:2025-10-27 22:52:26,962 - INFO - Avg. fwd time: 32.9868 / Avg. bwd time: 53.7787 / Avg. batch time: 1752.1081 (ms) / GPU bubble ratio: 60.38%
[rank1]:2025-10-27 22:52:27,041 - INFO - Avg. fwd time: 51.3553 / Avg. bwd time: 73.2650 / Avg. batch time: 1871.3750 (ms) / GPU bubble ratio: 46.73%
[rank0]:2025-10-27 22:52:27,108 - INFO - Avg. fwd time: 45.9977 / Avg. bwd time: 60.4052 / Avg. batch time: 1970.1586 (ms) / GPU bubble ratio: 56.79%
[rank1]:2025-10-27 22:55:04,893 - INFO -  step: 80  loss: -4.0000  grad_norm: 23.6129  memory: 20.03GiB(42.17%)  tps: 2,051  tflops: 16.03  mfu: 5.14%
[rank2]:2025-10-27 22:55:04,889 - INFO -  step: 80  loss: -4.0000  grad_norm: 23.6129  memory: 16.10GiB(33.90%)  tps: 2,051  tflops: 16.03  mfu: 5.14%
[rank3]:2025-10-27 22:55:04,901 - INFO -  step: 80  loss:  2.1462  grad_norm: 23.6129  memory: 38.93GiB(81.95%)  tps: 2,051  tflops: 16.03  mfu: 5.14%
[rank0]:2025-10-27 22:55:04,908 - INFO -  step: 80  loss: -4.0000  grad_norm: 23.6129  memory: 20.89GiB(43.97%)  tps: 2,051  tflops: 16.03  mfu: 5.14%
[rank3]:2025-10-27 22:55:06,721 - INFO - Avg. fwd time: 71.6877 / Avg. bwd time: 129.5966 / Avg. batch time: 1663.8638 (ms) / GPU bubble ratio: 3.22%
[rank1]:2025-10-27 22:55:06,859 - INFO - Avg. fwd time: 51.4827 / Avg. bwd time: 73.3023 / Avg. batch time: 1872.8168 (ms) / GPU bubble ratio: 46.70%
[rank2]:2025-10-27 22:55:06,781 - INFO - Avg. fwd time: 33.0935 / Avg. bwd time: 53.8409 / Avg. batch time: 1753.2033 (ms) / GPU bubble ratio: 60.33%
[rank0]:2025-10-27 22:55:06,926 - INFO - Avg. fwd time: 45.9800 / Avg. bwd time: 60.4465 / Avg. batch time: 1971.6725 (ms) / GPU bubble ratio: 56.82%
[rank3]:2025-10-27 22:57:04,178 - INFO - [Step 95] ã€°ï¸ Monitoring Upperbound
[rank0]:2025-10-27 22:57:37,198 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-27 22:57:44,326 - INFO - [Step 100] âœ”ï¸  Setting Upperbound
[rank1]:2025-10-27 22:57:45,145 - INFO -  step: 100  loss: -4.0000  grad_norm: 14.6025  memory: 20.03GiB(42.17%)  tps: 2,045  tflops: 15.99  mfu: 5.12%
[rank1]:2025-10-27 22:57:45,145 - INFO - ðŸ”Ž  Running validation at step 100
[rank2]:2025-10-27 22:57:45,145 - INFO -  step: 100  loss: -4.0000  grad_norm: 14.6025  memory: 16.10GiB(33.90%)  tps: 2,045  tflops: 15.98  mfu: 5.12%
[rank2]:2025-10-27 22:57:45,145 - INFO - ðŸ”Ž  Running validation at step 100
[rank0]:2025-10-27 22:57:45,146 - INFO -  step: 100  loss: -4.0000  grad_norm: 14.6025  memory: 20.89GiB(43.97%)  tps: 2,045  tflops: 15.99  mfu: 5.12%
[rank0]:2025-10-27 22:57:45,146 - INFO - ðŸ”Ž  Running validation at step 100
[rank3]:2025-10-27 22:57:45,143 - INFO - [Step 100] ã€°ï¸ Monitoring Lowerbound
[rank3]:2025-10-27 22:57:45,147 - INFO -  step: 100  loss:  0.8602  grad_norm: 14.6025  memory: 38.93GiB(81.95%)  tps: 2,045  tflops: 15.99  mfu: 5.12%
[rank3]:2025-10-27 22:57:45,147 - INFO - ðŸ”Ž  Running validation at step 100
[rank0]:2025-10-27 22:58:56,410 - INFO - validate step: 100  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,748
[rank1]:2025-10-27 22:58:56,489 - INFO - validate step: 100  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,741
[rank2]:2025-10-27 22:58:56,569 - INFO - validate step: 100  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,735
[rank3]:2025-10-27 22:58:56,653 - INFO - validate step: 100  loss:  0.3863  memory: 38.93GiB(81.95%)  tps: 5,728
[rank1]:2025-10-27 22:58:56,738 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1027_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251027_2258_stage1_step100.svg
[rank2]:2025-10-27 22:58:56,738 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1027_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251027_2258_stage2_step100.svg
[rank0]:2025-10-27 22:58:56,736 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1027_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251027_2258_stage0_step100.svg
[rank0]:2025-10-27 22:58:56,783 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-27 22:58:56,793 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-27 22:58:56,844 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-27 22:58:56,784 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-27 22:58:56,803 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-27 22:58:56,800 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-27 22:58:56,811 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-27 22:58:56,875 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1027_GPipe_fullrand7_dm1/pipeline_schedule/251027_2258_real_step100_rank3.svg
[rank3]:> Batch Time: 1927.19 ms, GPU Bubble Ratio: 55.66%, 47.54%, 64.13%, 15.70%
[rank0]:2025-10-27 22:58:56,890 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-27 22:58:56,940 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1027_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251027_2258_stage3_step100.svg
[rank3]:2025-10-27 22:58:56,978 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-27 22:58:56,994 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-27 22:58:57,032 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-27 22:58:56,963 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-27 22:58:56,994 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-27 22:58:57,007 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-27 22:58:57,017 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-27 22:58:57,084 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-27 22:58:57,074 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-27 22:58:57,091 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-27 22:58:57,166 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-27 22:58:57,230 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-27 22:58:57,244 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-27 22:58:57,322 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-27 22:58:57,394 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-27 22:58:57,409 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-27 22:58:57,646 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-27 22:58:57,711 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-27 22:58:57,785 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-27 22:58:57,836 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-27 22:58:57,852 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-27 22:58:57,904 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-27 22:58:57,967 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-27 22:58:58,033 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-27 22:58:58,547 - INFO - Avg. fwd time: 71.7635 / Avg. bwd time: 129.8097 / Avg. batch time: 1665.2073 (ms) / GPU bubble ratio: 3.16%
[rank2]:2025-10-27 22:58:58,599 - INFO - Avg. fwd time: 33.1116 / Avg. bwd time: 53.9232 / Avg. batch time: 1754.9207 (ms) / GPU bubble ratio: 60.32%
[rank1]:2025-10-27 22:58:58,668 - INFO - Avg. fwd time: 51.7216 / Avg. bwd time: 73.4271 / Avg. batch time: 1874.7637 (ms) / GPU bubble ratio: 46.60%
[rank0]:2025-10-27 22:58:58,722 - INFO - Avg. fwd time: 46.0912 / Avg. bwd time: 60.5122 / Avg. batch time: 1973.6150 (ms) / GPU bubble ratio: 56.79%
[rank3]:2025-10-27 22:59:23,721 - INFO - [Step 105] âœ”ï¸  Setting Lowerbound
[rank3]:2025-10-27 22:59:24,632 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1027_GPipe_fullrand7_dm1/pipeline_schedule/251027_2259_max_batch_time.svg
[rank3]:> Batch Time: 1953.47 ms, GPU Bubble Ratio: 55.53%, 46.83%, 63.82%, 16.11%
[rank3]:2025-10-27 22:59:24,821 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1027_GPipe_fullrand7_dm1/pipeline_schedule/251027_2259_min_batch_time.svg
[rank3]:> Batch Time: 1311.69 ms, GPU Bubble Ratio: 70.95%, 43.65%, 61.57%, 14.64%
[rank3]:2025-10-27 22:59:25,024 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1027_GPipe_fullrand7_dm1/pipeline_schedule/251027_2259_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 1311.69 ms, GPU Bubble Ratio: 41.52%, 30.71%, 48.08%, 14.64%
[rank3]:2025-10-27 22:59:25,025 - INFO - 	> Batch Time: 1311.69 ms (Average Freeze Ratio: 0.44, Time Reduction Rate: 0.33)
[rank3]:2025-10-27 23:00:49,999 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-27 23:00:50,666 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.31/0.31, [MB3] 0.73/0.73, [MB4] 0.24/0.24, [MB5] 0.24/0.24, [MB6] 0.97/0.97, [MB7] 1.00/1.00
[rank1]:2025-10-27 23:00:50,690 - INFO -  step: 120  loss: -4.0000  grad_norm:  0.0779  memory: 20.03GiB(42.17%)  tps: 2,869  tflops: 22.43  mfu: 7.19%
[rank2]:2025-10-27 23:00:50,621 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-27 23:00:50,692 - INFO -  step: 120  loss: -4.0000  grad_norm:  0.0779  memory: 16.10GiB(33.90%)  tps: 2,871  tflops: 22.45  mfu: 7.19%
[rank0]:2025-10-27 23:00:50,690 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.67/0.67, [MB7] 1.00/1.00
[rank0]:2025-10-27 23:00:50,691 - INFO -  step: 120  loss: -4.0000  grad_norm:  0.0779  memory: 20.89GiB(43.97%)  tps: 2,867  tflops: 22.42  mfu: 7.18%
[rank3]:2025-10-27 23:00:50,692 - INFO -  step: 120  loss:  0.5042  grad_norm:  0.0779  memory: 38.93GiB(81.95%)  tps: 2,873  tflops: 22.46  mfu: 7.20%
[rank3]:2025-10-27 23:00:52,015 - INFO - Avg. fwd time: 71.7787 / Avg. bwd time: 120.0624 / Avg. batch time: 1586.6693 (ms) / GPU bubble ratio: 3.27%
[rank1]:2025-10-27 23:00:52,102 - INFO - Avg. fwd time: 51.9646 / Avg. bwd time: 68.0752 / Avg. batch time: 1788.2001 (ms) / GPU bubble ratio: 46.30%
[rank2]:2025-10-27 23:00:52,055 - INFO - Avg. fwd time: 33.1150 / Avg. bwd time: 50.2936 / Avg. batch time: 1673.6937 (ms) / GPU bubble ratio: 60.13%
[rank0]:2025-10-27 23:00:52,128 - INFO - Avg. fwd time: 45.9848 / Avg. bwd time: 52.9031 / Avg. batch time: 1879.1933 (ms) / GPU bubble ratio: 57.90%
[rank3]:2025-10-27 23:02:39,369 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1027_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251027_2302_rank3_trend_line.svg
[rank1]:2025-10-27 23:02:39,404 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1027_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251027_2302_rank1_trend_line.svg
[rank1]:2025-10-27 23:02:39,411 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank1]:2025-10-27 23:02:39,411 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank1]:2025-10-27 23:02:39,412 - INFO -  step: 140  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 3,014  tflops: 23.56  mfu: 7.55%
[rank2]:2025-10-27 23:02:39,372 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1027_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251027_2302_rank2_trend_line.svg
[rank2]:2025-10-27 23:02:39,411 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-27 23:02:39,411 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-27 23:02:39,412 - INFO -  step: 140  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 3,014  tflops: 23.56  mfu: 7.55%
[rank0]:2025-10-27 23:02:39,390 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1027_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251027_2302_rank0_trend_line.svg
[rank0]:2025-10-27 23:02:39,411 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-27 23:02:39,412 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-27 23:02:39,412 - INFO -  step: 140  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 3,014  tflops: 23.56  mfu: 7.55%
[rank3]:2025-10-27 23:02:39,608 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1027_GPipe_fullrand7_dm1/pipeline_schedule/251027_2302_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 1321.27 ms, GPU Bubble Ratio: 65.55%, 43.08%, 60.62%, 15.19%
[rank3]:2025-10-27 23:02:39,608 - INFO - 	> Batch Time: 1321.27 ms (Average Freeze Ratio: 0.31)
[rank3]:2025-10-27 23:02:39,609 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-27 23:02:39,610 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-27 23:02:39,612 - INFO -  step: 140  loss:  0.5085  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 3,008  tflops: 23.52  mfu: 7.54%
[rank2]:2025-10-27 23:02:40,829 - INFO - Avg. fwd time: 33.1479 / Avg. bwd time: 47.2565 / Avg. batch time: 1609.6465 (ms) / GPU bubble ratio: 60.04%
[rank3]:2025-10-27 23:02:40,796 - INFO - Avg. fwd time: 71.7003 / Avg. bwd time: 112.5392 / Avg. batch time: 1525.7114 (ms) / GPU bubble ratio: 3.39%
[rank1]:2025-10-27 23:02:40,871 - INFO - Avg. fwd time: 52.3489 / Avg. bwd time: 63.9558 / Avg. batch time: 1720.1643 (ms) / GPU bubble ratio: 45.91%
[rank0]:2025-10-27 23:02:40,874 - INFO - Avg. fwd time: 45.8730 / Avg. bwd time: 45.3593 / Avg. batch time: 1803.2787 (ms) / GPU bubble ratio: 59.53%
[rank0]:2025-10-27 23:03:36,705 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-27 23:04:47,279 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1027_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251027_2304_rank2_trend_line.svg
[rank2]:2025-10-27 23:04:47,308 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-27 23:04:47,309 - INFO -  step: 160  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,562  tflops: 20.03  mfu: 6.42%
[rank0]:2025-10-27 23:04:47,293 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1027_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251027_2304_rank0_trend_line.svg
[rank0]:2025-10-27 23:04:47,308 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-27 23:04:47,309 - INFO -  step: 160  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,562  tflops: 20.03  mfu: 6.42%
[rank3]:2025-10-27 23:04:47,275 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1027_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251027_2304_rank3_trend_line.svg
[rank1]:2025-10-27 23:04:47,301 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1027_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251027_2304_rank1_trend_line.svg
[rank1]:2025-10-27 23:04:47,308 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-10-27 23:04:47,309 - INFO -  step: 160  loss: -4.0000  grad_norm:  0.0699  memory: 20.03GiB(42.17%)  tps: 2,562  tflops: 20.03  mfu: 6.42%
[rank3]:2025-10-27 23:04:47,504 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1027_GPipe_fullrand7_dm1/pipeline_schedule/251027_2304_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 1309.86 ms, GPU Bubble Ratio: 67.46%, 29.64%, 60.78%, 14.42%
[rank3]:2025-10-27 23:04:47,504 - INFO - 	> Batch Time: 1309.86 ms (Average Freeze Ratio: 0.34)
[rank3]:2025-10-27 23:04:47,505 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-27 23:04:47,508 - INFO -  step: 160  loss:  0.4765  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,562  tflops: 20.03  mfu: 6.42%
[rank3]:2025-10-27 23:04:48,706 - INFO - Avg. fwd time: 71.8661 / Avg. bwd time: 106.9004 / Avg. batch time: 1481.4042 (ms) / GPU bubble ratio: 3.46%
[rank2]:2025-10-27 23:04:48,853 - INFO - Avg. fwd time: 33.1703 / Avg. bwd time: 44.9433 / Avg. batch time: 1577.4551 (ms) / GPU bubble ratio: 60.39%
[rank0]:2025-10-27 23:04:49,011 - INFO - Avg. fwd time: 45.8297 / Avg. bwd time: 39.6985 / Avg. batch time: 1776.6139 (ms) / GPU bubble ratio: 61.49%
[rank1]:2025-10-27 23:04:49,008 - INFO - Avg. fwd time: 52.6143 / Avg. bwd time: 67.0324 / Avg. batch time: 1699.3886 (ms) / GPU bubble ratio: 43.68%
[rank1]:2025-10-27 23:06:36,511 - INFO -  step: 180  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 3,001  tflops: 23.46  mfu: 7.52%
[rank0]:2025-10-27 23:06:36,511 - INFO -  step: 180  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 3,001  tflops: 23.46  mfu: 7.52%
[rank2]:2025-10-27 23:06:36,510 - INFO -  step: 180  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 3,001  tflops: 23.46  mfu: 7.52%
[rank3]:2025-10-27 23:06:36,511 - INFO -  step: 180  loss:  0.5000  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 3,006  tflops: 23.50  mfu: 7.53%
[rank2]:2025-10-27 23:06:37,819 - INFO - Avg. fwd time: 33.1734 / Avg. bwd time: 43.1820 / Avg. batch time: 1538.6090 (ms) / GPU bubble ratio: 60.30%
[rank3]:2025-10-27 23:06:37,785 - INFO - Avg. fwd time: 71.8536 / Avg. bwd time: 102.5058 / Avg. batch time: 1446.0571 (ms) / GPU bubble ratio: 3.54%
[rank1]:2025-10-27 23:06:37,864 - INFO - Avg. fwd time: 52.8619 / Avg. bwd time: 63.9655 / Avg. batch time: 1656.6789 (ms) / GPU bubble ratio: 43.58%
[rank0]:2025-10-27 23:06:37,868 - INFO - Avg. fwd time: 45.7295 / Avg. bwd time: 35.2939 / Avg. batch time: 1729.2851 (ms) / GPU bubble ratio: 62.52%
[rank0]:2025-10-27 23:08:19,183 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-27 23:08:24,695 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1027_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251027_2308_rank2_trend_line.svg
[rank3]:2025-10-27 23:08:24,686 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1027_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251027_2308_rank3_trend_line.svg
[rank1]:2025-10-27 23:08:24,720 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1027_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251027_2308_rank1_trend_line.svg
[rank1]:2025-10-27 23:08:24,727 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-10-27 23:08:24,728 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 3,028  tflops: 23.67  mfu: 7.59%
[rank1]:2025-10-27 23:08:24,728 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-10-27 23:08:24,711 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1027_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251027_2308_rank0_trend_line.svg
[rank0]:2025-10-27 23:08:24,727 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank0]:2025-10-27 23:08:24,728 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 3,028  tflops: 23.67  mfu: 7.59%
[rank0]:2025-10-27 23:08:24,728 - INFO - ðŸ”Ž  Running validation at step 200
[rank2]:2025-10-27 23:08:24,728 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank2]:2025-10-27 23:08:24,729 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 3,028  tflops: 23.67  mfu: 7.59%
[rank2]:2025-10-27 23:08:24,729 - INFO - ðŸ”Ž  Running validation at step 200
[rank3]:2025-10-27 23:08:24,917 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1027_GPipe_fullrand7_dm1/pipeline_schedule/251027_2308_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 1313.90 ms, GPU Bubble Ratio: 69.06%, 35.85%, 61.19%, 14.68%
[rank3]:2025-10-27 23:08:24,918 - INFO - 	> Batch Time: 1313.90 ms (Average Freeze Ratio: 0.28)
[rank3]:2025-10-27 23:08:24,918 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-27 23:08:24,922 - INFO -  step: 200  loss:  0.5054  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 3,023  tflops: 23.63  mfu: 7.57%
[rank3]:2025-10-27 23:08:24,922 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-10-27 23:09:33,180 - INFO - validate step: 200  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,984
[rank1]:2025-10-27 23:09:33,263 - INFO - validate step: 200  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,977
[rank2]:2025-10-27 23:09:33,340 - INFO - validate step: 200  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,970
[rank3]:2025-10-27 23:09:33,421 - INFO - validate step: 200  loss:  0.3720  memory: 38.93GiB(81.95%)  tps: 5,980
[rank1]:2025-10-27 23:09:33,502 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data3/shcho/torchtitan/images/1027_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251027_2309_stage1_step200.svg
[rank0]:2025-10-27 23:09:33,500 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data3/shcho/torchtitan/images/1027_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251027_2309_stage0_step200.svg
[rank2]:2025-10-27 23:09:33,502 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data3/shcho/torchtitan/images/1027_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251027_2309_stage2_step200.svg
[rank3]:2025-10-27 23:09:33,625 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1027_GPipe_fullrand7_dm1/pipeline_schedule/251027_2309_real_step200_rank3.svg
[rank3]:> Batch Time: 1855.19 ms, GPU Bubble Ratio: 55.72%, 46.78%, 63.94%, 15.88%
[rank3]:2025-10-27 23:09:33,697 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data3/shcho/torchtitan/images/1027_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251027_2309_stage3_step200.svg
[rank1]:2025-10-27 23:09:34,958 - INFO - Avg. fwd time: 52.9979 / Avg. bwd time: 61.4852 / Avg. batch time: 1621.6803 (ms) / GPU bubble ratio: 43.52%
[rank3]:2025-10-27 23:09:34,883 - INFO - Avg. fwd time: 71.7555 / Avg. bwd time: 98.9656 / Avg. batch time: 1416.9260 (ms) / GPU bubble ratio: 3.61%
[rank0]:2025-10-27 23:09:34,962 - INFO - Avg. fwd time: 45.6442 / Avg. bwd time: 31.7691 / Avg. batch time: 1690.5782 (ms) / GPU bubble ratio: 63.37%
[rank2]:2025-10-27 23:09:34,916 - INFO - Avg. fwd time: 33.1676 / Avg. bwd time: 41.7630 / Avg. batch time: 1506.7728 (ms) / GPU bubble ratio: 60.22%
[rank2]:2025-10-27 23:11:36,347 - INFO -  step: 220  loss: -4.0000  grad_norm:  0.1545  memory: 16.10GiB(33.90%)  tps: 2,664  tflops: 20.83  mfu: 6.67%
[rank1]:2025-10-27 23:11:36,334 - INFO -  step: 220  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,663  tflops: 20.81  mfu: 6.67%
[rank3]:2025-10-27 23:11:36,336 - INFO -  step: 220  loss:  0.4770  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,666  tflops: 20.84  mfu: 6.68%
[rank0]:2025-10-27 23:11:36,368 - INFO -  step: 220  loss: -4.0000  grad_norm:  0.1545  memory: 20.89GiB(43.97%)  tps: 2,660  tflops: 20.79  mfu: 6.66%
[rank3]:2025-10-27 23:11:37,662 - INFO - Avg. fwd time: 71.7463 / Avg. bwd time: 96.0770 / Avg. batch time: 1393.5584 (ms) / GPU bubble ratio: 3.66%
[rank1]:2025-10-27 23:11:37,801 - INFO - Avg. fwd time: 52.9654 / Avg. bwd time: 59.3973 / Avg. batch time: 1599.6409 (ms) / GPU bubble ratio: 43.81%
[rank2]:2025-10-27 23:11:37,757 - INFO - Avg. fwd time: 33.1685 / Avg. bwd time: 43.9342 / Avg. batch time: 1487.5184 (ms) / GPU bubble ratio: 58.53%
[rank0]:2025-10-27 23:11:37,900 - INFO - Avg. fwd time: 45.7457 / Avg. bwd time: 35.4220 / Avg. batch time: 1674.6306 (ms) / GPU bubble ratio: 61.22%
[rank3]:2025-10-27 23:13:39,698 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1027_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251027_2313_rank3_trend_line.svg
[rank1]:2025-10-27 23:13:39,704 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1027_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251027_2313_rank1_trend_line.svg
[rank1]:2025-10-27 23:13:39,745 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-10-27 23:13:39,747 - INFO -  step: 240  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,655  tflops: 20.76  mfu: 6.65%
[rank0]:2025-10-27 23:13:39,738 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1027_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251027_2313_rank0_trend_line.svg
[rank0]:2025-10-27 23:13:39,745 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-27 23:13:39,746 - INFO -  step: 240  loss: -4.0000  grad_norm:  0.8728  memory: 20.89GiB(43.97%)  tps: 2,656  tflops: 20.76  mfu: 6.65%
[rank2]:2025-10-27 23:13:39,716 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data3/shcho/torchtitan/images/1027_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251027_2313_rank2_trend_line.svg
[rank2]:2025-10-27 23:13:39,745 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-27 23:13:39,747 - INFO -  step: 240  loss: -4.0000  grad_norm:  0.8728  memory: 16.10GiB(33.90%)  tps: 2,655  tflops: 20.76  mfu: 6.65%
[rank3]:2025-10-27 23:13:39,948 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1027_GPipe_fullrand7_dm1/pipeline_schedule/251027_2313_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 1312.54 ms, GPU Bubble Ratio: 57.42%, 38.43%, 55.18%, 14.64%
[rank3]:2025-10-27 23:13:39,949 - INFO - 	> Batch Time: 1312.54 ms (Average Freeze Ratio: 0.34)
[rank3]:2025-10-27 23:13:39,950 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-27 23:13:39,953 - INFO -  step: 240  loss:  0.4797  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,651  tflops: 20.72  mfu: 6.64%
[rank3]:2025-10-27 23:13:41,149 - INFO - Avg. fwd time: 71.7647 / Avg. bwd time: 93.6642 / Avg. batch time: 1374.1606 (ms) / GPU bubble ratio: 3.69%
[rank1]:2025-10-27 23:13:41,284 - INFO - Avg. fwd time: 52.9026 / Avg. bwd time: 57.6552 / Avg. batch time: 1581.5827 (ms) / GPU bubble ratio: 44.08%
[rank2]:2025-10-27 23:13:41,242 - INFO - Avg. fwd time: 33.1760 / Avg. bwd time: 45.7563 / Avg. batch time: 1471.7800 (ms) / GPU bubble ratio: 57.10%
[rank0]:2025-10-27 23:13:41,378 - INFO - Avg. fwd time: 45.8540 / Avg. bwd time: 38.4751 / Avg. batch time: 1661.7143 (ms) / GPU bubble ratio: 59.40%
[rank0]:2025-10-27 23:14:28,461 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-27 23:15:28,595 - INFO -  step: 260  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 3,010  tflops: 23.53  mfu: 7.54%
[rank0]:2025-10-27 23:15:28,594 - INFO -  step: 260  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 3,010  tflops: 23.53  mfu: 7.54%
[rank2]:2025-10-27 23:15:28,594 - INFO -  step: 260  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 3,010  tflops: 23.53  mfu: 7.54%
[rank3]:2025-10-27 23:15:28,595 - INFO -  step: 260  loss:  0.4640  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 3,016  tflops: 23.58  mfu: 7.56%
[rank2]:2025-10-27 23:15:29,910 - INFO - Avg. fwd time: 33.1872 / Avg. bwd time: 44.4737 / Avg. batch time: 1452.7043 (ms) / GPU bubble ratio: 57.23%
[rank3]:2025-10-27 23:15:29,877 - INFO - Avg. fwd time: 71.7425 / Avg. bwd time: 91.6299 / Avg. batch time: 1357.6242 (ms) / GPU bubble ratio: 3.73%
[rank1]:2025-10-27 23:15:29,952 - INFO - Avg. fwd time: 52.9547 / Avg. bwd time: 56.2252 / Avg. batch time: 1560.6899 (ms) / GPU bubble ratio: 44.04%
[rank0]:2025-10-27 23:15:29,956 - INFO - Avg. fwd time: 45.8114 / Avg. bwd time: 35.5185 / Avg. batch time: 1637.4204 (ms) / GPU bubble ratio: 60.26%
