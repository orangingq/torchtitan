
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 10. 27. (ì›”) 23:30:10 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 3,4,5,6
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1026_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1026_llama1b/1028_GPipe_nofreeze.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs
âœ”ï¸Running with nofreeze x GPipe ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1026_llama1b/config.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs" --parallelism.pipeline_parallel_degree=4  --freezing.no-freeze
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank1]:2025-10-27 23:30:17,173 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs"
[rank3]:2025-10-27 23:30:17,198 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs"
[rank2]:2025-10-27 23:30:17,257 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs"
[rank0]:2025-10-27 23:30:17,407 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs"
[rank1]:2025-10-27 23:30:17,979 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-10-27 23:30:17,982 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-27 23:30:17,992 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-10-27 23:30:17,997 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-27 23:30:18,001 - INFO - [GC] Initial GC collection 0.00 seconds
[rank3]:2025-10-27 23:30:18,000 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-10-27 23:30:18,002 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-10-27 23:30:17,996 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-10-27 23:30:17,998 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-27 23:30:18,549 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-10-27 23:30:18,957 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank0]:2025-10-27 23:30:21,739 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=512, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank1]:2025-10-27 23:30:21,880 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-10-27 23:30:21,919 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-10-27 23:30:21,948 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-10-27 23:30:21,948 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-10-27 23:30:21,905 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-10-27 23:30:21,943 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-10-27 23:30:21,944 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-10-27 23:30:21,970 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-10-27 23:30:21,971 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2025-10-27 23:30:22,159 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-10-27 23:30:22,159 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-10-27 23:30:22,160 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank0]:2025-10-27 23:30:22,158 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-10-27 23:30:22,158 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-10-27 23:30:22,159 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank2]:2025-10-27 23:30:22,770 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-10-27 23:30:22,810 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-10-27 23:30:22,838 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-10-27 23:30:22,839 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank2]:2025-10-27 23:30:23,408 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-10-27 23:30:23,408 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-10-27 23:30:23,408 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank3]:wandb: setting up run 8gb3lxi8
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data3/shcho/torchtitan/tb/1028_GPipe_nofreeze_dm1/20251027-2330/wandb/run-20251027_233023-8gb3lxi8
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1028_GPipe_nofreeze_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/8gb3lxi8
[rank3]:2025-10-27 23:30:24,231 - INFO - WandB logging enabled
[rank3]:2025-10-27 23:30:24,232 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-10-27 23:30:24,272 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-10-27 23:30:24,301 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-10-27 23:30:24,302 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank3]:2025-10-27 23:30:24,484 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-10-27 23:30:24,485 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-10-27 23:30:24,486 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank0]:2025-10-27 23:30:24,501 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data3/shcho/torchtitan/checkpoint/1028_GPipe_nofreeze_dm1
[rank0]:2025-10-27 23:30:24,501 - WARNING - Mixed precision training with TP or PP is only supported when FSDP/HSDP/CP is enabled.
[rank0]:2025-10-27 23:30:24,501 - INFO - Mixed precision training is disabled
[rank0]:2025-10-27 23:30:24,501 - INFO - Preparing c4_validation dataset from allenai/c4
[rank0]:2025-10-27 23:30:30,209 - INFO - Trainer is initialized with local batch size 32, global batch size 64, gradient accumulation steps 2, sequence length 512, total steps 1600 (warmup 100)
[rank0]:2025-10-27 23:30:30,209 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B-Instruct/original_dcp.
[rank0]:2025-10-27 23:30:32,651 - INFO - [GC] GC collection for checkpoint loading. 0.01 seconds
[rank0]:2025-10-27 23:30:32,651 - INFO - Finished loading the checkpoint in 2.44 seconds.
[rank0]:2025-10-27 23:30:32,651 - INFO - Training starts at step 1
[rank0]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/autograd/graph.py:849: UserWarning: Attempting to run cuBLAS, but there was no current CUDA context! Attempting to set the primary context... (Triggered internally at /pytorch/aten/src/ATen/cuda/CublasHandlePool.cpp:270.)
[rank0]:  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
[rank3]:2025-10-27 23:30:40,950 - INFO -  step:  1  loss:  9.0107  grad_norm: 95.1855  memory: 35.59GiB(74.92%)  tps: 491  tflops: 3.74  mfu: 1.20%
[rank3]:2025-10-27 23:30:40,951 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-10-27 23:30:40,943 - INFO -  step:  1  loss: -2.0000  grad_norm: 95.1855  memory: 17.77GiB(37.40%)  tps: 431  tflops: 3.28  mfu: 1.05%
[rank1]:2025-10-27 23:30:40,943 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-10-27 23:30:40,940 - INFO -  step:  1  loss: -2.0000  grad_norm: 95.1855  memory: 14.29GiB(30.07%)  tps: 452  tflops: 3.44  mfu: 1.10%
[rank2]:2025-10-27 23:30:40,941 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-10-27 23:30:40,980 - INFO -  step:  1  loss: -2.0000  grad_norm: 95.1855  memory: 17.10GiB(35.99%)  tps: 430  tflops: 3.28  mfu: 1.05%
[rank0]:2025-10-27 23:30:40,980 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-27 23:30:58,205 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 23:30:58,206 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 23:30:58,206 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 23:30:58,206 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 23:30:58,207 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 23:30:58,207 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 23:30:58,207 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 23:30:58,207 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 23:30:58,208 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 23:30:58,208 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 23:30:58,208 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 23:30:58,208 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 23:30:58,208 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 23:30:58,209 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 23:30:58,209 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 23:30:58,209 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 23:30:58,262 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 23:30:58,262 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 23:30:58,262 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 23:30:58,262 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 23:30:58,262 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 23:30:58,262 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 23:30:58,262 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 23:30:58,262 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 23:30:58,262 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 23:30:58,262 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 23:30:58,262 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 23:30:58,262 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 23:30:58,262 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 23:30:58,263 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 23:30:58,263 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 23:30:58,263 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 23:30:58,331 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 23:30:58,331 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 23:30:58,331 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 23:30:58,331 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 23:30:58,331 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 23:30:58,331 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 23:30:58,331 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 23:30:58,331 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 23:30:58,331 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 23:30:58,331 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 23:30:58,331 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 23:30:58,331 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 23:30:58,331 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 23:30:58,331 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 23:30:58,332 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 23:30:58,332 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 23:30:58,395 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 23:30:58,396 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 23:30:58,396 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 23:30:58,396 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 23:30:58,396 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 23:30:58,396 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 23:30:58,396 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 23:30:58,396 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 23:30:58,396 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 23:30:58,396 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 23:30:58,396 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 23:30:58,396 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 23:30:58,396 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 23:30:58,396 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 23:30:58,396 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 23:30:58,396 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 23:31:55,808 - INFO -  step: 20  loss: -2.0000  grad_norm: 62.9902  memory: 20.03GiB(42.17%)  tps: 2,079  tflops: 15.83  mfu: 5.08%
[rank3]:2025-10-27 23:31:55,817 - INFO -  step: 20  loss: 10.8311  grad_norm: 62.9902  memory: 38.93GiB(81.95%)  tps: 2,079  tflops: 15.83  mfu: 5.08%
[rank2]:2025-10-27 23:31:55,804 - INFO -  step: 20  loss: -2.0000  grad_norm: 62.9902  memory: 16.10GiB(33.90%)  tps: 2,079  tflops: 15.83  mfu: 5.08%
[rank0]:2025-10-27 23:31:55,824 - INFO -  step: 20  loss: -2.0000  grad_norm: 62.9902  memory: 20.89GiB(43.97%)  tps: 2,080  tflops: 15.84  mfu: 5.08%
[rank1]:2025-10-27 23:33:15,324 - INFO -  step: 40  loss: -2.0000  grad_norm: 41.4712  memory: 20.03GiB(42.17%)  tps: 2,060  tflops: 15.69  mfu: 5.03%
[rank3]:2025-10-27 23:33:15,331 - INFO -  step: 40  loss:  5.6652  grad_norm: 41.4712  memory: 38.93GiB(81.95%)  tps: 2,061  tflops: 15.69  mfu: 5.03%
[rank2]:2025-10-27 23:33:15,319 - INFO -  step: 40  loss: -2.0000  grad_norm: 41.4712  memory: 16.10GiB(33.90%)  tps: 2,061  tflops: 15.69  mfu: 5.03%
[rank0]:2025-10-27 23:33:15,344 - INFO -  step: 40  loss: -2.0000  grad_norm: 41.4712  memory: 20.89GiB(43.97%)  tps: 2,060  tflops: 15.69  mfu: 5.03%
[rank3]:2025-10-27 23:33:17,165 - INFO - Avg. fwd time: 70.9395 / Avg. bwd time: 126.6571 / Avg. batch time: 1648.6125 (ms) / GPU bubble ratio: 4.11%
[rank2]:2025-10-27 23:33:17,220 - INFO - Avg. fwd time: 32.1054 / Avg. bwd time: 50.9583 / Avg. batch time: 1735.2824 (ms) / GPU bubble ratio: 61.71%
[rank1]:2025-10-27 23:33:17,288 - INFO - Avg. fwd time: 50.1237 / Avg. bwd time: 69.4675 / Avg. batch time: 1851.7418 (ms) / GPU bubble ratio: 48.33%
[rank0]:2025-10-27 23:33:17,348 - INFO - Avg. fwd time: 44.5925 / Avg. bwd time: 57.5057 / Avg. batch time: 1947.3500 (ms) / GPU bubble ratio: 58.06%
[rank0]:2025-10-27 23:33:51,218 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-27 23:34:34,954 - INFO -  step: 60  loss: -2.0000  grad_norm: 31.9388  memory: 20.03GiB(42.17%)  tps: 2,058  tflops: 15.67  mfu: 5.02%
[rank3]:2025-10-27 23:34:34,962 - INFO -  step: 60  loss:  8.4741  grad_norm: 31.9388  memory: 38.93GiB(81.95%)  tps: 2,058  tflops: 15.67  mfu: 5.02%
[rank2]:2025-10-27 23:34:34,950 - INFO -  step: 60  loss: -2.0000  grad_norm: 31.9388  memory: 16.10GiB(33.90%)  tps: 2,058  tflops: 15.67  mfu: 5.02%
[rank0]:2025-10-27 23:34:34,976 - INFO -  step: 60  loss: -2.0000  grad_norm: 31.9388  memory: 20.89GiB(43.97%)  tps: 2,057  tflops: 15.67  mfu: 5.02%
[rank1]:2025-10-27 23:35:54,856 - INFO -  step: 80  loss: -2.0000  grad_norm: 43.2360  memory: 20.03GiB(42.17%)  tps: 2,051  tflops: 15.62  mfu: 5.01%
[rank3]:2025-10-27 23:35:54,864 - INFO -  step: 80  loss:  4.0073  grad_norm: 43.2360  memory: 38.93GiB(81.95%)  tps: 2,051  tflops: 15.62  mfu: 5.01%
[rank2]:2025-10-27 23:35:54,852 - INFO -  step: 80  loss: -2.0000  grad_norm: 43.2360  memory: 16.10GiB(33.90%)  tps: 2,051  tflops: 15.62  mfu: 5.01%
[rank0]:2025-10-27 23:35:54,872 - INFO -  step: 80  loss: -2.0000  grad_norm: 43.2360  memory: 20.89GiB(43.97%)  tps: 2,051  tflops: 15.62  mfu: 5.01%
[rank3]:2025-10-27 23:35:56,688 - INFO - Avg. fwd time: 71.7142 / Avg. bwd time: 128.0732 / Avg. batch time: 1656.0565 (ms) / GPU bubble ratio: 3.49%
[rank2]:2025-10-27 23:35:56,746 - INFO - Avg. fwd time: 32.2345 / Avg. bwd time: 51.3867 / Avg. batch time: 1742.9734 (ms) / GPU bubble ratio: 61.62%
[rank1]:2025-10-27 23:35:56,815 - INFO - Avg. fwd time: 50.3049 / Avg. bwd time: 69.9395 / Avg. batch time: 1859.1665 (ms) / GPU bubble ratio: 48.26%
[rank0]:2025-10-27 23:35:56,879 - INFO - Avg. fwd time: 45.2316 / Avg. bwd time: 58.1674 / Avg. batch time: 1954.9398 (ms) / GPU bubble ratio: 57.69%
[rank0]:2025-10-27 23:37:10,923 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-27 23:37:14,912 - INFO -  step: 100  loss: -2.0000  grad_norm: 55.2428  memory: 16.10GiB(33.90%)  tps: 2,046  tflops: 15.59  mfu: 5.00%
[rank2]:2025-10-27 23:37:14,912 - INFO - ðŸ”Ž  Running validation at step 100
[rank0]:2025-10-27 23:37:14,933 - INFO -  step: 100  loss: -2.0000  grad_norm: 55.2428  memory: 20.89GiB(43.97%)  tps: 2,046  tflops: 15.59  mfu: 5.00%
[rank0]:2025-10-27 23:37:14,933 - INFO - ðŸ”Ž  Running validation at step 100
[rank1]:2025-10-27 23:37:14,916 - INFO -  step: 100  loss: -2.0000  grad_norm: 55.2428  memory: 20.03GiB(42.17%)  tps: 2,046  tflops: 15.59  mfu: 5.00%
[rank1]:2025-10-27 23:37:14,916 - INFO - ðŸ”Ž  Running validation at step 100
[rank3]:2025-10-27 23:37:14,924 - INFO -  step: 100  loss:  5.5661  grad_norm: 55.2428  memory: 38.93GiB(81.95%)  tps: 2,047  tflops: 15.59  mfu: 5.00%
[rank3]:2025-10-27 23:37:14,925 - INFO - ðŸ”Ž  Running validation at step 100
[rank0]:2025-10-27 23:38:26,510 - INFO - validate step: 100  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,723
[rank1]:2025-10-27 23:38:26,589 - INFO - validate step: 100  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,715
[rank2]:2025-10-27 23:38:26,671 - INFO - validate step: 100  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,708
[rank3]:2025-10-27 23:38:26,737 - INFO - validate step: 100  loss:  2.0121  memory: 38.93GiB(81.95%)  tps: 5,704
[rank3]:2025-10-27 23:38:26,956 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251027_2338_real_step100_rank3.svg
[rank3]:> Batch Time: 1905.81 ms, GPU Bubble Ratio: 56.30%, 49.10%, 65.05%, 15.16%
[rank1]:2025-10-27 23:39:46,782 - INFO -  step: 120  loss: -2.0000  grad_norm: 39.1030  memory: 20.03GiB(42.17%)  tps: 2,043  tflops: 15.56  mfu: 4.99%
[rank2]:2025-10-27 23:39:46,777 - INFO -  step: 120  loss: -2.0000  grad_norm: 39.1030  memory: 16.10GiB(33.90%)  tps: 2,045  tflops: 15.58  mfu: 4.99%
[rank3]:2025-10-27 23:39:46,789 - INFO -  step: 120  loss:  1.7310  grad_norm: 39.1030  memory: 38.93GiB(81.95%)  tps: 2,047  tflops: 15.59  mfu: 5.00%
[rank0]:2025-10-27 23:39:46,802 - INFO -  step: 120  loss: -2.0000  grad_norm: 39.1030  memory: 20.89GiB(43.97%)  tps: 2,041  tflops: 15.54  mfu: 4.98%
[rank2]:2025-10-27 23:39:48,675 - INFO - Avg. fwd time: 32.3535 / Avg. bwd time: 51.6766 / Avg. batch time: 1747.7356 (ms) / GPU bubble ratio: 61.54%
[rank3]:2025-10-27 23:39:48,617 - INFO - Avg. fwd time: 72.0383 / Avg. bwd time: 128.6964 / Avg. batch time: 1660.2271 (ms) / GPU bubble ratio: 3.27%
[rank1]:2025-10-27 23:39:48,751 - INFO - Avg. fwd time: 50.4318 / Avg. bwd time: 70.2962 / Avg. batch time: 1864.0507 (ms) / GPU bubble ratio: 48.19%
[rank0]:2025-10-27 23:39:48,811 - INFO - Avg. fwd time: 45.3857 / Avg. bwd time: 58.4283 / Avg. batch time: 1959.9555 (ms) / GPU bubble ratio: 57.63%
[rank0]:2025-10-27 23:41:06,552 - INFO -  step: 140  loss: -2.0000  grad_norm: 64.1788  memory: 20.89GiB(43.97%)  tps: 2,054  tflops: 15.65  mfu: 5.02%
[rank1]:2025-10-27 23:41:06,536 - INFO -  step: 140  loss: -2.0000  grad_norm: 64.1788  memory: 20.03GiB(42.17%)  tps: 2,054  tflops: 15.65  mfu: 5.01%
[rank3]:2025-10-27 23:41:06,545 - INFO -  step: 140  loss:  1.9512  grad_norm: 64.1788  memory: 38.93GiB(81.95%)  tps: 2,054  tflops: 15.65  mfu: 5.01%
[rank2]:2025-10-27 23:41:06,532 - INFO -  step: 140  loss: -2.0000  grad_norm: 64.1788  memory: 16.10GiB(33.90%)  tps: 2,054  tflops: 15.65  mfu: 5.01%
[rank0]:2025-10-27 23:41:42,238 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-27 23:42:25,998 - INFO -  step: 160  loss: -2.0000  grad_norm:  8.3415  memory: 20.03GiB(42.17%)  tps: 2,062  tflops: 15.70  mfu: 5.03%
[rank3]:2025-10-27 23:42:26,006 - INFO -  step: 160  loss:  0.4131  grad_norm:  8.3415  memory: 38.93GiB(81.95%)  tps: 2,062  tflops: 15.70  mfu: 5.03%
[rank2]:2025-10-27 23:42:25,994 - INFO -  step: 160  loss: -2.0000  grad_norm:  8.3415  memory: 16.10GiB(33.90%)  tps: 2,062  tflops: 15.70  mfu: 5.03%
[rank0]:2025-10-27 23:42:26,014 - INFO -  step: 160  loss: -2.0000  grad_norm:  8.3415  memory: 20.89GiB(43.97%)  tps: 2,062  tflops: 15.70  mfu: 5.03%
[rank3]:2025-10-27 23:42:27,824 - INFO - Avg. fwd time: 72.1212 / Avg. bwd time: 128.7738 / Avg. batch time: 1659.8837 (ms) / GPU bubble ratio: 3.18%
[rank2]:2025-10-27 23:42:27,881 - INFO - Avg. fwd time: 32.3553 / Avg. bwd time: 51.7778 / Avg. batch time: 1747.2108 (ms) / GPU bubble ratio: 61.48%
[rank1]:2025-10-27 23:42:27,959 - INFO - Avg. fwd time: 50.6201 / Avg. bwd time: 70.4710 / Avg. batch time: 1863.7340 (ms) / GPU bubble ratio: 48.02%
[rank0]:2025-10-27 23:42:28,019 - INFO - Avg. fwd time: 45.4071 / Avg. bwd time: 58.4439 / Avg. batch time: 1959.6000 (ms) / GPU bubble ratio: 57.60%
[rank0]:2025-10-27 23:43:45,699 - INFO -  step: 180  loss: -2.0000  grad_norm:  4.5841  memory: 20.89GiB(43.97%)  tps: 2,056  tflops: 15.66  mfu: 5.02%
[rank1]:2025-10-27 23:43:45,676 - INFO -  step: 180  loss: -2.0000  grad_norm:  4.5841  memory: 20.03GiB(42.17%)  tps: 2,056  tflops: 15.66  mfu: 5.02%
[rank2]:2025-10-27 23:43:45,673 - INFO -  step: 180  loss: -2.0000  grad_norm:  4.5841  memory: 16.10GiB(33.90%)  tps: 2,056  tflops: 15.66  mfu: 5.02%
[rank3]:2025-10-27 23:43:45,685 - INFO -  step: 180  loss:  0.4193  grad_norm:  4.5841  memory: 38.93GiB(81.95%)  tps: 2,056  tflops: 15.66  mfu: 5.02%
[rank0]:2025-10-27 23:45:01,535 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-27 23:45:05,552 - INFO -  step: 200  loss: -2.0000  grad_norm:  0.9201  memory: 20.03GiB(42.17%)  tps: 2,051  tflops: 15.62  mfu: 5.01%
[rank1]:2025-10-27 23:45:05,553 - INFO - ðŸ”Ž  Running validation at step 200
[rank2]:2025-10-27 23:45:05,549 - INFO -  step: 200  loss: -2.0000  grad_norm:  0.9201  memory: 16.10GiB(33.90%)  tps: 2,051  tflops: 15.62  mfu: 5.01%
[rank2]:2025-10-27 23:45:05,549 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-10-27 23:45:05,570 - INFO -  step: 200  loss: -2.0000  grad_norm:  0.9201  memory: 20.89GiB(43.97%)  tps: 2,051  tflops: 15.62  mfu: 5.01%
[rank0]:2025-10-27 23:45:05,570 - INFO - ðŸ”Ž  Running validation at step 200
[rank3]:2025-10-27 23:45:05,561 - INFO -  step: 200  loss:  0.2861  grad_norm:  0.9201  memory: 38.93GiB(81.95%)  tps: 2,051  tflops: 15.62  mfu: 5.01%
[rank3]:2025-10-27 23:45:05,562 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-10-27 23:46:15,281 - INFO - validate step: 200  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,876
[rank1]:2025-10-27 23:46:15,363 - INFO - validate step: 200  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,867
[rank2]:2025-10-27 23:46:15,441 - INFO - validate step: 200  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,861
[rank3]:2025-10-27 23:46:15,507 - INFO - validate step: 200  loss:  0.9463  memory: 38.93GiB(81.95%)  tps: 5,856
[rank3]:2025-10-27 23:46:15,715 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251027_2346_real_step200_rank3.svg
[rank3]:> Batch Time: 1910.25 ms, GPU Bubble Ratio: 56.38%, 48.71%, 65.09%, 15.25%
[rank2]:2025-10-27 23:46:17,492 - INFO - Avg. fwd time: 32.3585 / Avg. bwd time: 51.8336 / Avg. batch time: 1747.9562 (ms) / GPU bubble ratio: 61.47%
[rank3]:2025-10-27 23:46:17,437 - INFO - Avg. fwd time: 72.2127 / Avg. bwd time: 128.8799 / Avg. batch time: 1660.4675 (ms) / GPU bubble ratio: 3.12%
[rank1]:2025-10-27 23:46:17,564 - INFO - Avg. fwd time: 50.7566 / Avg. bwd time: 70.5832 / Avg. batch time: 1864.5917 (ms) / GPU bubble ratio: 47.94%
[rank0]:2025-10-27 23:46:17,631 - INFO - Avg. fwd time: 45.4922 / Avg. bwd time: 58.4901 / Avg. batch time: 1960.5334 (ms) / GPU bubble ratio: 57.57%
[rank1]:2025-10-27 23:47:35,784 - INFO -  step: 220  loss: -2.0000  grad_norm:  1.1049  memory: 20.03GiB(42.17%)  tps: 2,037  tflops: 15.52  mfu: 4.97%
[rank3]:2025-10-27 23:47:35,793 - INFO -  step: 220  loss:  0.2857  grad_norm:  1.1049  memory: 38.93GiB(81.95%)  tps: 2,041  tflops: 15.54  mfu: 4.98%
[rank0]:2025-10-27 23:47:35,799 - INFO -  step: 220  loss: -2.0000  grad_norm:  1.1049  memory: 20.89GiB(43.97%)  tps: 2,035  tflops: 15.50  mfu: 4.97%
[rank2]:2025-10-27 23:47:35,781 - INFO -  step: 220  loss: -2.0000  grad_norm:  1.1049  memory: 16.10GiB(33.90%)  tps: 2,039  tflops: 15.53  mfu: 4.98%
[rank1]:2025-10-27 23:48:55,662 - INFO -  step: 240  loss: -2.0000  grad_norm:  0.8191  memory: 20.03GiB(42.17%)  tps: 2,051  tflops: 15.62  mfu: 5.01%
[rank3]:2025-10-27 23:48:55,670 - INFO -  step: 240  loss:  0.3163  grad_norm:  0.8191  memory: 38.93GiB(81.95%)  tps: 2,051  tflops: 15.62  mfu: 5.01%
[rank2]:2025-10-27 23:48:55,659 - INFO -  step: 240  loss: -2.0000  grad_norm:  0.8191  memory: 16.10GiB(33.90%)  tps: 2,051  tflops: 15.62  mfu: 5.01%
[rank0]:2025-10-27 23:48:55,679 - INFO -  step: 240  loss: -2.0000  grad_norm:  0.8191  memory: 20.89GiB(43.97%)  tps: 2,051  tflops: 15.62  mfu: 5.01%
[rank3]:2025-10-27 23:48:57,498 - INFO - Avg. fwd time: 72.2945 / Avg. bwd time: 129.0674 / Avg. batch time: 1661.9890 (ms) / GPU bubble ratio: 3.07%
[rank2]:2025-10-27 23:48:57,554 - INFO - Avg. fwd time: 32.3951 / Avg. bwd time: 51.9033 / Avg. batch time: 1749.4484 (ms) / GPU bubble ratio: 61.45%
[rank1]:2025-10-27 23:48:57,626 - INFO - Avg. fwd time: 50.7593 / Avg. bwd time: 70.6228 / Avg. batch time: 1865.9770 (ms) / GPU bubble ratio: 47.96%
[rank0]:2025-10-27 23:48:57,692 - INFO - Avg. fwd time: 45.5401 / Avg. bwd time: 58.5502 / Avg. batch time: 1961.9495 (ms) / GPU bubble ratio: 57.56%
[rank0]:2025-10-27 23:49:31,517 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-27 23:50:15,246 - INFO -  step: 260  loss: -2.0000  grad_norm:  0.5881  memory: 20.03GiB(42.17%)  tps: 2,059  tflops: 15.68  mfu: 5.03%
[rank3]:2025-10-27 23:50:15,254 - INFO -  step: 260  loss:  0.2907  grad_norm:  0.5881  memory: 38.93GiB(81.95%)  tps: 2,059  tflops: 15.68  mfu: 5.03%
[rank2]:2025-10-27 23:50:15,242 - INFO -  step: 260  loss: -2.0000  grad_norm:  0.5881  memory: 16.10GiB(33.90%)  tps: 2,059  tflops: 15.68  mfu: 5.03%
[rank0]:2025-10-27 23:50:15,262 - INFO -  step: 260  loss: -2.0000  grad_norm:  0.5881  memory: 20.89GiB(43.97%)  tps: 2,059  tflops: 15.68  mfu: 5.03%
[rank1]:2025-10-27 23:51:34,778 - INFO -  step: 280  loss: -2.0000  grad_norm:  0.8465  memory: 20.03GiB(42.17%)  tps: 2,060  tflops: 15.69  mfu: 5.03%
[rank3]:2025-10-27 23:51:34,787 - INFO -  step: 280  loss:  0.2673  grad_norm:  0.8465  memory: 38.93GiB(81.95%)  tps: 2,060  tflops: 15.69  mfu: 5.03%
[rank2]:2025-10-27 23:51:34,775 - INFO -  step: 280  loss: -2.0000  grad_norm:  0.8465  memory: 16.10GiB(33.90%)  tps: 2,060  tflops: 15.69  mfu: 5.03%
[rank0]:2025-10-27 23:51:34,800 - INFO -  step: 280  loss: -2.0000  grad_norm:  0.8465  memory: 20.89GiB(43.97%)  tps: 2,060  tflops: 15.69  mfu: 5.03%
[rank3]:2025-10-27 23:51:36,592 - INFO - Avg. fwd time: 72.2572 / Avg. bwd time: 129.0999 / Avg. batch time: 1661.4838 (ms) / GPU bubble ratio: 3.05%
[rank2]:2025-10-27 23:51:36,647 - INFO - Avg. fwd time: 32.3940 / Avg. bwd time: 51.9268 / Avg. batch time: 1748.8242 (ms) / GPU bubble ratio: 61.43%
[rank1]:2025-10-27 23:51:36,725 - INFO - Avg. fwd time: 50.6701 / Avg. bwd time: 70.6771 / Avg. batch time: 1865.2428 (ms) / GPU bubble ratio: 47.95%
[rank0]:2025-10-27 23:51:36,785 - INFO - Avg. fwd time: 45.5596 / Avg. bwd time: 58.5838 / Avg. batch time: 1961.2121 (ms) / GPU bubble ratio: 57.52%
[rank0]:2025-10-27 23:52:50,418 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-27 23:52:54,385 - INFO -  step: 300  loss: -2.0000  grad_norm:  1.4391  memory: 20.03GiB(42.17%)  tps: 2,058  tflops: 15.68  mfu: 5.02%
[rank1]:2025-10-27 23:52:54,385 - INFO - ðŸ”Ž  Running validation at step 300
[rank3]:2025-10-27 23:52:54,394 - INFO -  step: 300  loss:  0.2282  grad_norm:  1.4391  memory: 38.93GiB(81.95%)  tps: 2,058  tflops: 15.68  mfu: 5.02%
[rank3]:2025-10-27 23:52:54,394 - INFO - ðŸ”Ž  Running validation at step 300
[rank2]:2025-10-27 23:52:54,382 - INFO -  step: 300  loss: -2.0000  grad_norm:  1.4391  memory: 16.10GiB(33.90%)  tps: 2,058  tflops: 15.68  mfu: 5.02%
[rank2]:2025-10-27 23:52:54,382 - INFO - ðŸ”Ž  Running validation at step 300
[rank0]:2025-10-27 23:52:54,402 - INFO -  step: 300  loss: -2.0000  grad_norm:  1.4391  memory: 20.89GiB(43.97%)  tps: 2,058  tflops: 15.68  mfu: 5.02%
[rank0]:2025-10-27 23:52:54,402 - INFO - ðŸ”Ž  Running validation at step 300
[rank0]:2025-10-27 23:54:03,782 - INFO - validate step: 300  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,904
[rank1]:2025-10-27 23:54:03,861 - INFO - validate step: 300  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,896
[rank2]:2025-10-27 23:54:03,943 - INFO - validate step: 300  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,888
[rank3]:2025-10-27 23:54:04,008 - INFO - validate step: 300  loss:  0.9438  memory: 38.93GiB(81.95%)  tps: 5,884
[rank3]:2025-10-27 23:54:04,216 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251027_2354_real_step300_rank3.svg
[rank3]:> Batch Time: 1910.50 ms, GPU Bubble Ratio: 56.35%, 48.74%, 65.08%, 15.21%
[rank3]:2025-10-27 23:55:24,194 - INFO -  step: 320  loss:  0.2945  grad_norm:  0.7560  memory: 38.93GiB(81.95%)  tps: 2,043  tflops: 15.56  mfu: 4.99%
[rank1]:2025-10-27 23:55:24,186 - INFO -  step: 320  loss: -2.0000  grad_norm:  0.7560  memory: 20.03GiB(42.17%)  tps: 2,040  tflops: 15.54  mfu: 4.98%
[rank2]:2025-10-27 23:55:24,182 - INFO -  step: 320  loss: -2.0000  grad_norm:  0.7560  memory: 16.10GiB(33.90%)  tps: 2,042  tflops: 15.55  mfu: 4.98%
[rank0]:2025-10-27 23:55:24,202 - INFO -  step: 320  loss: -2.0000  grad_norm:  0.7560  memory: 20.89GiB(43.97%)  tps: 2,037  tflops: 15.52  mfu: 4.97%
[rank3]:2025-10-27 23:55:26,043 - INFO - Avg. fwd time: 72.2565 / Avg. bwd time: 129.1868 / Avg. batch time: 1661.7925 (ms) / GPU bubble ratio: 3.02%
[rank2]:2025-10-27 23:55:26,098 - INFO - Avg. fwd time: 32.4073 / Avg. bwd time: 51.9368 / Avg. batch time: 1749.2349 (ms) / GPU bubble ratio: 61.43%
[rank1]:2025-10-27 23:55:26,175 - INFO - Avg. fwd time: 50.6235 / Avg. bwd time: 70.7184 / Avg. batch time: 1865.7264 (ms) / GPU bubble ratio: 47.97%
[rank0]:2025-10-27 23:55:26,236 - INFO - Avg. fwd time: 45.5400 / Avg. bwd time: 58.5987 / Avg. batch time: 1961.7958 (ms) / GPU bubble ratio: 57.53%
[rank3]:2025-10-27 23:56:44,209 - INFO -  step: 340  loss:  0.2661  grad_norm:  0.5076  memory: 38.93GiB(81.95%)  tps: 2,048  tflops: 15.60  mfu: 5.00%
[rank1]:2025-10-27 23:56:44,201 - INFO -  step: 340  loss: -2.0000  grad_norm:  0.5076  memory: 20.03GiB(42.17%)  tps: 2,048  tflops: 15.60  mfu: 5.00%
[rank2]:2025-10-27 23:56:44,197 - INFO -  step: 340  loss: -2.0000  grad_norm:  0.5076  memory: 16.10GiB(33.90%)  tps: 2,048  tflops: 15.60  mfu: 5.00%
[rank0]:2025-10-27 23:56:44,217 - INFO -  step: 340  loss: -2.0000  grad_norm:  0.5076  memory: 20.89GiB(43.97%)  tps: 2,048  tflops: 15.60  mfu: 5.00%
[rank0]:2025-10-27 23:57:20,242 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-27 23:58:04,274 - INFO -  step: 360  loss:  0.2035  grad_norm:  0.7578  memory: 38.93GiB(81.95%)  tps: 2,046  tflops: 15.59  mfu: 5.00%
[rank0]:2025-10-27 23:58:04,283 - INFO -  step: 360  loss: -2.0000  grad_norm:  0.7578  memory: 20.89GiB(43.97%)  tps: 2,046  tflops: 15.59  mfu: 5.00%
[rank1]:2025-10-27 23:58:04,266 - INFO -  step: 360  loss: -2.0000  grad_norm:  0.7578  memory: 20.03GiB(42.17%)  tps: 2,046  tflops: 15.59  mfu: 5.00%
[rank2]:2025-10-27 23:58:04,262 - INFO -  step: 360  loss: -2.0000  grad_norm:  0.7578  memory: 16.10GiB(33.90%)  tps: 2,046  tflops: 15.59  mfu: 5.00%
[rank3]:2025-10-27 23:58:06,088 - INFO - Avg. fwd time: 72.2840 / Avg. bwd time: 129.2868 / Avg. batch time: 1662.5306 (ms) / GPU bubble ratio: 3.01%
[rank1]:2025-10-27 23:58:06,225 - INFO - Avg. fwd time: 50.6437 / Avg. bwd time: 70.7042 / Avg. batch time: 1866.5035 (ms) / GPU bubble ratio: 47.99%
[rank2]:2025-10-27 23:58:06,147 - INFO - Avg. fwd time: 32.3971 / Avg. bwd time: 51.9712 / Avg. batch time: 1749.9740 (ms) / GPU bubble ratio: 61.43%
[rank0]:2025-10-27 23:58:06,292 - INFO - Avg. fwd time: 45.5637 / Avg. bwd time: 58.6165 / Avg. batch time: 1962.5852 (ms) / GPU bubble ratio: 57.53%
[rank3]:2025-10-27 23:59:24,317 - INFO -  step: 380  loss:  0.2590  grad_norm:  0.6308  memory: 38.93GiB(81.95%)  tps: 2,047  tflops: 15.59  mfu: 5.00%
[rank1]:2025-10-27 23:59:24,309 - INFO -  step: 380  loss: -2.0000  grad_norm:  0.6308  memory: 20.03GiB(42.17%)  tps: 2,047  tflops: 15.59  mfu: 5.00%
[rank0]:2025-10-27 23:59:24,325 - INFO -  step: 380  loss: -2.0000  grad_norm:  0.6308  memory: 20.89GiB(43.97%)  tps: 2,047  tflops: 15.59  mfu: 5.00%
[rank2]:2025-10-27 23:59:24,305 - INFO -  step: 380  loss: -2.0000  grad_norm:  0.6308  memory: 16.10GiB(33.90%)  tps: 2,047  tflops: 15.59  mfu: 5.00%
[rank0]:2025-10-28 00:00:40,102 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-28 00:00:44,132 - INFO -  step: 400  loss: -2.0000  grad_norm:  0.7670  memory: 16.10GiB(33.90%)  tps: 2,052  tflops: 15.63  mfu: 5.01%
[rank2]:2025-10-28 00:00:44,132 - INFO - ðŸ”Ž  Running validation at step 400
[rank3]:2025-10-28 00:00:44,145 - INFO -  step: 400  loss:  0.2192  grad_norm:  0.7670  memory: 38.93GiB(81.95%)  tps: 2,052  tflops: 15.63  mfu: 5.01%
[rank3]:2025-10-28 00:00:44,145 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-10-28 00:00:44,152 - INFO -  step: 400  loss: -2.0000  grad_norm:  0.7670  memory: 20.89GiB(43.97%)  tps: 2,052  tflops: 15.63  mfu: 5.01%
[rank0]:2025-10-28 00:00:44,152 - INFO - ðŸ”Ž  Running validation at step 400
[rank1]:2025-10-28 00:00:44,137 - INFO -  step: 400  loss: -2.0000  grad_norm:  0.7670  memory: 20.03GiB(42.17%)  tps: 2,052  tflops: 15.63  mfu: 5.01%
[rank1]:2025-10-28 00:00:44,137 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-10-28 00:01:53,208 - INFO - validate step: 400  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,931
[rank1]:2025-10-28 00:01:53,290 - INFO - validate step: 400  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,923
[rank2]:2025-10-28 00:01:53,371 - INFO - validate step: 400  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,916
[rank3]:2025-10-28 00:01:53,436 - INFO - validate step: 400  loss:  0.9357  memory: 38.93GiB(81.95%)  tps: 5,911
[rank3]:2025-10-28 00:01:53,644 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251028_0001_real_step400_rank3.svg
[rank3]:> Batch Time: 1912.50 ms, GPU Bubble Ratio: 56.38%, 48.79%, 65.10%, 15.21%
[rank3]:2025-10-28 00:01:55,340 - INFO - Avg. fwd time: 72.3195 / Avg. bwd time: 129.3486 / Avg. batch time: 1663.0483 (ms) / GPU bubble ratio: 2.99%
[rank2]:2025-10-28 00:01:55,399 - INFO - Avg. fwd time: 32.3966 / Avg. bwd time: 51.9793 / Avg. batch time: 1750.5558 (ms) / GPU bubble ratio: 61.44%
[rank1]:2025-10-28 00:01:55,471 - INFO - Avg. fwd time: 50.6232 / Avg. bwd time: 70.7089 / Avg. batch time: 1867.0469 (ms) / GPU bubble ratio: 48.01%
[rank0]:2025-10-28 00:01:55,531 - INFO - Avg. fwd time: 45.5891 / Avg. bwd time: 58.6219 / Avg. batch time: 1963.1034 (ms) / GPU bubble ratio: 57.53%
[rank3]:2025-10-28 00:03:13,278 - INFO -  step: 420  loss:  0.2873  grad_norm:  0.5967  memory: 38.93GiB(81.95%)  tps: 2,052  tflops: 15.63  mfu: 5.01%
[rank2]:2025-10-28 00:03:13,265 - INFO -  step: 420  loss: -2.0000  grad_norm:  0.5967  memory: 16.10GiB(33.90%)  tps: 2,051  tflops: 15.62  mfu: 5.01%
[rank1]:2025-10-28 00:03:13,270 - INFO -  step: 420  loss: -2.0000  grad_norm:  0.5967  memory: 20.03GiB(42.17%)  tps: 2,049  tflops: 15.60  mfu: 5.00%
[rank0]:2025-10-28 00:03:13,288 - INFO -  step: 420  loss: -2.0000  grad_norm:  0.5967  memory: 20.89GiB(43.97%)  tps: 2,046  tflops: 15.58  mfu: 4.99%
[rank3]:2025-10-28 00:04:32,798 - INFO -  step: 440  loss:  0.2725  grad_norm:  0.7696  memory: 38.93GiB(81.95%)  tps: 2,060  tflops: 15.69  mfu: 5.03%
[rank1]:2025-10-28 00:04:32,789 - INFO -  step: 440  loss: -2.0000  grad_norm:  0.7696  memory: 20.03GiB(42.17%)  tps: 2,060  tflops: 15.69  mfu: 5.03%
[rank2]:2025-10-28 00:04:32,785 - INFO -  step: 440  loss: -2.0000  grad_norm:  0.7696  memory: 16.10GiB(33.90%)  tps: 2,060  tflops: 15.69  mfu: 5.03%
[rank0]:2025-10-28 00:04:32,801 - INFO -  step: 440  loss: -2.0000  grad_norm:  0.7696  memory: 20.89GiB(43.97%)  tps: 2,061  tflops: 15.69  mfu: 5.03%
[rank3]:2025-10-28 00:04:34,598 - INFO - Avg. fwd time: 72.2718 / Avg. bwd time: 129.3719 / Avg. batch time: 1662.7268 (ms) / GPU bubble ratio: 2.98%
[rank1]:2025-10-28 00:04:34,733 - INFO - Avg. fwd time: 50.6454 / Avg. bwd time: 70.6800 / Avg. batch time: 1866.6472 (ms) / GPU bubble ratio: 48.00%
[rank2]:2025-10-28 00:04:34,654 - INFO - Avg. fwd time: 32.4006 / Avg. bwd time: 51.9891 / Avg. batch time: 1750.1785 (ms) / GPU bubble ratio: 61.43%
[rank0]:2025-10-28 00:04:34,794 - INFO - Avg. fwd time: 45.5953 / Avg. bwd time: 58.5998 / Avg. batch time: 1962.7353 (ms) / GPU bubble ratio: 57.53%
[rank0]:2025-10-28 00:05:08,756 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-28 00:05:52,518 - INFO -  step: 460  loss:  0.2451  grad_norm:  0.6711  memory: 38.93GiB(81.95%)  tps: 2,055  tflops: 15.65  mfu: 5.02%
[rank1]:2025-10-28 00:05:52,509 - INFO -  step: 460  loss: -2.0000  grad_norm:  0.6711  memory: 20.03GiB(42.17%)  tps: 2,055  tflops: 15.65  mfu: 5.02%
[rank2]:2025-10-28 00:05:52,505 - INFO -  step: 460  loss: -2.0000  grad_norm:  0.6711  memory: 16.10GiB(33.90%)  tps: 2,055  tflops: 15.65  mfu: 5.02%
[rank0]:2025-10-28 00:05:52,526 - INFO -  step: 460  loss: -2.0000  grad_norm:  0.6711  memory: 20.89GiB(43.97%)  tps: 2,055  tflops: 15.65  mfu: 5.02%
[rank1]:2025-10-28 00:07:12,437 - INFO -  step: 480  loss: -2.0000  grad_norm:  0.7812  memory: 20.03GiB(42.17%)  tps: 2,050  tflops: 15.61  mfu: 5.00%
[rank2]:2025-10-28 00:07:12,433 - INFO -  step: 480  loss: -2.0000  grad_norm:  0.7812  memory: 16.10GiB(33.90%)  tps: 2,050  tflops: 15.61  mfu: 5.00%
[rank0]:2025-10-28 00:07:12,452 - INFO -  step: 480  loss: -2.0000  grad_norm:  0.7812  memory: 20.89GiB(43.97%)  tps: 2,050  tflops: 15.61  mfu: 5.00%
[rank3]:2025-10-28 00:07:12,445 - INFO -  step: 480  loss:  0.2380  grad_norm:  0.7812  memory: 38.93GiB(81.95%)  tps: 2,050  tflops: 15.61  mfu: 5.00%
[rank3]:2025-10-28 00:07:14,279 - INFO - Avg. fwd time: 72.2724 / Avg. bwd time: 129.4040 / Avg. batch time: 1662.8579 (ms) / GPU bubble ratio: 2.97%
[rank2]:2025-10-28 00:07:14,338 - INFO - Avg. fwd time: 32.4074 / Avg. bwd time: 51.9978 / Avg. batch time: 1750.2849 (ms) / GPU bubble ratio: 61.42%
[rank1]:2025-10-28 00:07:14,409 - INFO - Avg. fwd time: 50.6841 / Avg. bwd time: 70.6681 / Avg. batch time: 1866.6988 (ms) / GPU bubble ratio: 47.99%
[rank0]:2025-10-28 00:07:14,471 - INFO - Avg. fwd time: 45.5846 / Avg. bwd time: 58.6077 / Avg. batch time: 1962.8204 (ms) / GPU bubble ratio: 57.53%
[rank0]:2025-10-28 00:08:28,243 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-28 00:08:32,267 - INFO -  step: 500  loss: -2.0000  grad_norm:  0.5581  memory: 20.89GiB(43.97%)  tps: 2,053  tflops: 15.63  mfu: 5.01%
[rank0]:2025-10-28 00:08:32,267 - INFO - ðŸ”Ž  Running validation at step 500
[rank3]:2025-10-28 00:08:32,258 - INFO -  step: 500  loss:  0.2547  grad_norm:  0.5581  memory: 38.93GiB(81.95%)  tps: 2,053  tflops: 15.64  mfu: 5.01%
[rank3]:2025-10-28 00:08:32,259 - INFO - ðŸ”Ž  Running validation at step 500
[rank2]:2025-10-28 00:08:32,246 - INFO -  step: 500  loss: -2.0000  grad_norm:  0.5581  memory: 16.10GiB(33.90%)  tps: 2,053  tflops: 15.63  mfu: 5.01%
[rank2]:2025-10-28 00:08:32,246 - INFO - ðŸ”Ž  Running validation at step 500
[rank1]:2025-10-28 00:08:32,250 - INFO -  step: 500  loss: -2.0000  grad_norm:  0.5581  memory: 20.03GiB(42.17%)  tps: 2,053  tflops: 15.63  mfu: 5.01%
[rank1]:2025-10-28 00:08:32,250 - INFO - ðŸ”Ž  Running validation at step 500
[rank0]:2025-10-28 00:09:41,732 - INFO - validate step: 500  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,896
[rank0]:2025-10-28 00:09:41,733 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-28 00:09:41,739 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank1]:2025-10-28 00:09:41,816 - INFO - validate step: 500  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,888
[rank1]:2025-10-28 00:09:41,817 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-28 00:09:41,896 - INFO - validate step: 500  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,881
[rank2]:2025-10-28 00:09:41,897 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-28 00:09:41,958 - INFO - validate step: 500  loss:  0.9331  memory: 38.93GiB(81.95%)  tps: 5,877
[rank3]:2025-10-28 00:09:41,960 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-28 00:09:43,817 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 1.92 seconds.
[rank1]:2025-10-28 00:09:44,111 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 2.29 seconds.
[rank3]:2025-10-28 00:09:45,232 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.27 seconds.
[rank0]:2025-10-28 00:09:45,627 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-28 00:09:45,634 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.90 seconds.
[rank3]:2025-10-28 00:09:46,003 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251028_0009_real_step500_rank3.svg
[rank3]:> Batch Time: 1912.28 ms, GPU Bubble Ratio: 56.40%, 48.86%, 65.08%, 15.21%
[rank0]:2025-10-28 00:11:05,822 - INFO -  step: 520  loss: -2.0000  grad_norm:  0.7743  memory: 20.89GiB(43.97%)  tps: 1,948  tflops: 14.84  mfu: 4.76%
[rank2]:2025-10-28 00:11:05,813 - INFO -  step: 520  loss: -2.0000  grad_norm:  0.7743  memory: 16.10GiB(33.90%)  tps: 1,953  tflops: 14.87  mfu: 4.77%
[rank1]:2025-10-28 00:11:05,813 - INFO -  step: 520  loss: -2.0000  grad_norm:  0.7743  memory: 20.03GiB(42.17%)  tps: 1,951  tflops: 14.86  mfu: 4.76%
[rank3]:2025-10-28 00:11:05,814 - INFO -  step: 520  loss:  0.2434  grad_norm:  0.7743  memory: 38.93GiB(81.95%)  tps: 1,954  tflops: 14.88  mfu: 4.77%
[rank3]:2025-10-28 00:11:07,634 - INFO - Avg. fwd time: 72.2424 / Avg. bwd time: 129.4591 / Avg. batch time: 1662.9964 (ms) / GPU bubble ratio: 2.97%
[rank2]:2025-10-28 00:11:07,690 - INFO - Avg. fwd time: 32.4226 / Avg. bwd time: 52.0228 / Avg. batch time: 1750.5995 (ms) / GPU bubble ratio: 61.41%
[rank1]:2025-10-28 00:11:07,769 - INFO - Avg. fwd time: 50.7057 / Avg. bwd time: 70.7032 / Avg. batch time: 1866.9943 (ms) / GPU bubble ratio: 47.98%
[rank0]:2025-10-28 00:11:07,834 - INFO - Avg. fwd time: 45.5782 / Avg. bwd time: 58.6239 / Avg. batch time: 1963.1240 (ms) / GPU bubble ratio: 57.54%
[rank3]:2025-10-28 00:12:25,756 - INFO -  step: 540  loss:  0.2513  grad_norm:  0.6453  memory: 38.93GiB(81.95%)  tps: 2,050  tflops: 15.61  mfu: 5.00%
[rank2]:2025-10-28 00:12:25,744 - INFO -  step: 540  loss: -2.0000  grad_norm:  0.6453  memory: 16.10GiB(33.90%)  tps: 2,050  tflops: 15.61  mfu: 5.00%
[rank0]:2025-10-28 00:12:25,770 - INFO -  step: 540  loss: -2.0000  grad_norm:  0.6453  memory: 20.89GiB(43.97%)  tps: 2,049  tflops: 15.61  mfu: 5.00%
[rank1]:2025-10-28 00:12:25,750 - INFO -  step: 540  loss: -2.0000  grad_norm:  0.6453  memory: 20.03GiB(42.17%)  tps: 2,050  tflops: 15.61  mfu: 5.00%
[rank0]:2025-10-28 00:13:01,950 - INFO - [GC] Peforming periodical GC collection 0.25 seconds
[rank2]:2025-10-28 00:13:45,722 - INFO -  step: 560  loss: -2.0000  grad_norm:  0.7832  memory: 16.10GiB(33.90%)  tps: 2,049  tflops: 15.60  mfu: 5.00%
[rank1]:2025-10-28 00:13:45,725 - INFO -  step: 560  loss: -2.0000  grad_norm:  0.7832  memory: 20.03GiB(42.17%)  tps: 2,049  tflops: 15.60  mfu: 5.00%
[rank0]:2025-10-28 00:13:45,742 - INFO -  step: 560  loss: -2.0000  grad_norm:  0.7832  memory: 20.89GiB(43.97%)  tps: 2,049  tflops: 15.60  mfu: 5.00%
[rank3]:2025-10-28 00:13:45,735 - INFO -  step: 560  loss:  0.2959  grad_norm:  0.7832  memory: 38.93GiB(81.95%)  tps: 2,049  tflops: 15.60  mfu: 5.00%
[rank3]:2025-10-28 00:13:47,555 - INFO - Avg. fwd time: 72.2383 / Avg. bwd time: 129.4822 / Avg. batch time: 1663.0685 (ms) / GPU bubble ratio: 2.96%
[rank2]:2025-10-28 00:13:47,615 - INFO - Avg. fwd time: 32.4173 / Avg. bwd time: 52.0360 / Avg. batch time: 1750.6716 (ms) / GPU bubble ratio: 61.41%
[rank1]:2025-10-28 00:13:47,692 - INFO - Avg. fwd time: 50.7426 / Avg. bwd time: 70.7187 / Avg. batch time: 1867.0818 (ms) / GPU bubble ratio: 47.96%
[rank0]:2025-10-28 00:13:47,755 - INFO - Avg. fwd time: 45.5718 / Avg. bwd time: 58.6157 / Avg. batch time: 1963.1668 (ms) / GPU bubble ratio: 57.54%
[rank3]:2025-10-28 00:15:05,478 - INFO -  step: 580  loss:  0.2247  grad_norm:  0.4457  memory: 38.93GiB(81.95%)  tps: 2,055  tflops: 15.65  mfu: 5.02%
[rank1]:2025-10-28 00:15:05,469 - INFO -  step: 580  loss: -2.0000  grad_norm:  0.4457  memory: 20.03GiB(42.17%)  tps: 2,055  tflops: 15.65  mfu: 5.02%
[rank2]:2025-10-28 00:15:05,466 - INFO -  step: 580  loss: -2.0000  grad_norm:  0.4457  memory: 16.10GiB(33.90%)  tps: 2,055  tflops: 15.65  mfu: 5.02%
[rank0]:2025-10-28 00:15:05,484 - INFO -  step: 580  loss: -2.0000  grad_norm:  0.4457  memory: 20.89GiB(43.97%)  tps: 2,055  tflops: 15.65  mfu: 5.02%
[rank0]:2025-10-28 00:16:21,102 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-28 00:16:25,168 - INFO -  step: 600  loss: -2.0000  grad_norm:  0.7568  memory: 20.89GiB(43.97%)  tps: 2,056  tflops: 15.66  mfu: 5.02%
[rank0]:2025-10-28 00:16:25,168 - INFO - ðŸ”Ž  Running validation at step 600
[rank3]:2025-10-28 00:16:25,161 - INFO -  step: 600  loss:  0.2164  grad_norm:  0.7568  memory: 38.93GiB(81.95%)  tps: 2,056  tflops: 15.66  mfu: 5.02%
[rank3]:2025-10-28 00:16:25,161 - INFO - ðŸ”Ž  Running validation at step 600
[rank2]:2025-10-28 00:16:25,148 - INFO -  step: 600  loss: -2.0000  grad_norm:  0.7568  memory: 16.10GiB(33.90%)  tps: 2,056  tflops: 15.66  mfu: 5.02%
[rank2]:2025-10-28 00:16:25,148 - INFO - ðŸ”Ž  Running validation at step 600
[rank1]:2025-10-28 00:16:25,152 - INFO -  step: 600  loss: -2.0000  grad_norm:  0.7568  memory: 20.03GiB(42.17%)  tps: 2,056  tflops: 15.66  mfu: 5.02%
[rank1]:2025-10-28 00:16:25,152 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-10-28 00:17:34,626 - INFO - validate step: 600  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,897
[rank1]:2025-10-28 00:17:34,710 - INFO - validate step: 600  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,889
[rank2]:2025-10-28 00:17:34,790 - INFO - validate step: 600  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,882
[rank3]:2025-10-28 00:17:34,854 - INFO - validate step: 600  loss:  0.9337  memory: 38.93GiB(81.95%)  tps: 5,877
[rank3]:2025-10-28 00:17:35,076 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251028_0017_real_step600_rank3.svg
[rank3]:> Batch Time: 1913.31 ms, GPU Bubble Ratio: 56.45%, 48.77%, 65.09%, 15.24%
[rank3]:2025-10-28 00:17:36,779 - INFO - Avg. fwd time: 72.2187 / Avg. bwd time: 129.4952 / Avg. batch time: 1662.9595 (ms) / GPU bubble ratio: 2.96%
[rank2]:2025-10-28 00:17:36,840 - INFO - Avg. fwd time: 32.4240 / Avg. bwd time: 52.0382 / Avg. batch time: 1750.5914 (ms) / GPU bubble ratio: 61.40%
[rank1]:2025-10-28 00:17:36,910 - INFO - Avg. fwd time: 50.7687 / Avg. bwd time: 70.7831 / Avg. batch time: 1867.0690 (ms) / GPU bubble ratio: 47.92%
[rank0]:2025-10-28 00:17:36,971 - INFO - Avg. fwd time: 45.5687 / Avg. bwd time: 58.5898 / Avg. batch time: 1963.1110 (ms) / GPU bubble ratio: 57.55%
[rank1]:2025-10-28 00:18:55,126 - INFO -  step: 620  loss: -2.0000  grad_norm:  0.4250  memory: 20.03GiB(42.17%)  tps: 2,037  tflops: 15.52  mfu: 4.97%
[rank3]:2025-10-28 00:18:55,135 - INFO -  step: 620  loss:  0.2523  grad_norm:  0.4250  memory: 38.93GiB(81.95%)  tps: 2,041  tflops: 15.54  mfu: 4.98%
[rank0]:2025-10-28 00:18:55,143 - INFO -  step: 620  loss: -2.0000  grad_norm:  0.4250  memory: 20.89GiB(43.97%)  tps: 2,035  tflops: 15.50  mfu: 4.97%
[rank2]:2025-10-28 00:18:55,123 - INFO -  step: 620  loss: -2.0000  grad_norm:  0.4250  memory: 16.10GiB(33.90%)  tps: 2,040  tflops: 15.53  mfu: 4.98%
[rank3]:2025-10-28 00:20:15,284 - INFO -  step: 640  loss:  0.2185  grad_norm:  0.7290  memory: 38.93GiB(81.95%)  tps: 2,044  tflops: 15.57  mfu: 4.99%
[rank0]:2025-10-28 00:20:15,292 - INFO -  step: 640  loss: -2.0000  grad_norm:  0.7290  memory: 20.89GiB(43.97%)  tps: 2,044  tflops: 15.57  mfu: 4.99%
[rank2]:2025-10-28 00:20:15,271 - INFO -  step: 640  loss: -2.0000  grad_norm:  0.7290  memory: 16.10GiB(33.90%)  tps: 2,044  tflops: 15.57  mfu: 4.99%
[rank1]:2025-10-28 00:20:15,275 - INFO -  step: 640  loss: -2.0000  grad_norm:  0.7290  memory: 20.03GiB(42.17%)  tps: 2,044  tflops: 15.57  mfu: 4.99%
[rank3]:2025-10-28 00:20:17,106 - INFO - Avg. fwd time: 72.2334 / Avg. bwd time: 129.5609 / Avg. batch time: 1663.5261 (ms) / GPU bubble ratio: 2.96%
[rank2]:2025-10-28 00:20:17,162 - INFO - Avg. fwd time: 32.4234 / Avg. bwd time: 52.0627 / Avg. batch time: 1751.1769 (ms) / GPU bubble ratio: 61.40%
[rank1]:2025-10-28 00:20:17,242 - INFO - Avg. fwd time: 50.7801 / Avg. bwd time: 70.7914 / Avg. batch time: 1867.6205 (ms) / GPU bubble ratio: 47.92%
[rank0]:2025-10-28 00:20:17,308 - INFO - Avg. fwd time: 45.5802 / Avg. bwd time: 58.5998 / Avg. batch time: 1963.7011 (ms) / GPU bubble ratio: 57.56%
[rank0]:2025-10-28 00:20:51,432 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-28 00:21:35,432 - INFO -  step: 660  loss: -2.0000  grad_norm:  0.6206  memory: 20.03GiB(42.17%)  tps: 2,044  tflops: 15.57  mfu: 4.99%
[rank3]:2025-10-28 00:21:35,441 - INFO -  step: 660  loss:  0.2586  grad_norm:  0.6206  memory: 38.93GiB(81.95%)  tps: 2,044  tflops: 15.57  mfu: 4.99%
[rank2]:2025-10-28 00:21:35,428 - INFO -  step: 660  loss: -2.0000  grad_norm:  0.6206  memory: 16.10GiB(33.90%)  tps: 2,044  tflops: 15.57  mfu: 4.99%
[rank0]:2025-10-28 00:21:35,450 - INFO -  step: 660  loss: -2.0000  grad_norm:  0.6206  memory: 20.89GiB(43.97%)  tps: 2,044  tflops: 15.57  mfu: 4.99%
[rank3]:2025-10-28 00:22:55,479 - INFO -  step: 680  loss:  0.2154  grad_norm:  0.7468  memory: 38.93GiB(81.95%)  tps: 2,047  tflops: 15.59  mfu: 5.00%
[rank2]:2025-10-28 00:22:55,467 - INFO -  step: 680  loss: -2.0000  grad_norm:  0.7468  memory: 16.10GiB(33.90%)  tps: 2,047  tflops: 15.59  mfu: 5.00%
[rank0]:2025-10-28 00:22:55,487 - INFO -  step: 680  loss: -2.0000  grad_norm:  0.7468  memory: 20.89GiB(43.97%)  tps: 2,047  tflops: 15.59  mfu: 5.00%
[rank1]:2025-10-28 00:22:55,471 - INFO -  step: 680  loss: -2.0000  grad_norm:  0.7468  memory: 20.03GiB(42.17%)  tps: 2,047  tflops: 15.59  mfu: 5.00%
[rank3]:2025-10-28 00:22:57,316 - INFO - Avg. fwd time: 72.2503 / Avg. bwd time: 129.6065 / Avg. batch time: 1663.9544 (ms) / GPU bubble ratio: 2.95%
[rank2]:2025-10-28 00:22:57,377 - INFO - Avg. fwd time: 32.4274 / Avg. bwd time: 52.0842 / Avg. batch time: 1751.6170 (ms) / GPU bubble ratio: 61.40%
[rank0]:2025-10-28 00:22:57,512 - INFO - Avg. fwd time: 45.6052 / Avg. bwd time: 58.5978 / Avg. batch time: 1964.0996 (ms) / GPU bubble ratio: 57.56%
[rank1]:2025-10-28 00:22:57,446 - INFO - Avg. fwd time: 50.7957 / Avg. bwd time: 70.7797 / Avg. batch time: 1868.0029 (ms) / GPU bubble ratio: 47.93%
[rank0]:2025-10-28 00:24:11,147 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-28 00:24:15,106 - INFO -  step: 700  loss: -2.0000  grad_norm:  0.5254  memory: 16.10GiB(33.90%)  tps: 2,057  tflops: 15.67  mfu: 5.02%
[rank2]:2025-10-28 00:24:15,106 - INFO - ðŸ”Ž  Running validation at step 700
[rank1]:2025-10-28 00:24:15,110 - INFO -  step: 700  loss: -2.0000  grad_norm:  0.5254  memory: 20.03GiB(42.17%)  tps: 2,057  tflops: 15.67  mfu: 5.02%
[rank0]:2025-10-28 00:24:15,126 - INFO -  step: 700  loss: -2.0000  grad_norm:  0.5254  memory: 20.89GiB(43.97%)  tps: 2,057  tflops: 15.67  mfu: 5.02%
[rank1]:2025-10-28 00:24:15,110 - INFO - ðŸ”Ž  Running validation at step 700
[rank0]:2025-10-28 00:24:15,126 - INFO - ðŸ”Ž  Running validation at step 700
[rank3]:2025-10-28 00:24:15,118 - INFO -  step: 700  loss:  0.2294  grad_norm:  0.5254  memory: 38.93GiB(81.95%)  tps: 2,057  tflops: 15.67  mfu: 5.02%
[rank3]:2025-10-28 00:24:15,119 - INFO - ðŸ”Ž  Running validation at step 700
[rank0]:2025-10-28 00:25:24,519 - INFO - validate step: 700  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,903
[rank1]:2025-10-28 00:25:24,603 - INFO - validate step: 700  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,894
[rank2]:2025-10-28 00:25:24,682 - INFO - validate step: 700  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,887
[rank3]:2025-10-28 00:25:24,749 - INFO - validate step: 700  loss:  0.9307  memory: 38.93GiB(81.95%)  tps: 5,883
[rank3]:2025-10-28 00:25:24,964 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251028_0025_real_step700_rank3.svg
[rank3]:> Batch Time: 1914.41 ms, GPU Bubble Ratio: 56.47%, 48.82%, 65.09%, 15.23%
[rank3]:2025-10-28 00:26:44,464 - INFO -  step: 720  loss:  0.2629  grad_norm:  0.7046  memory: 38.93GiB(81.95%)  tps: 2,055  tflops: 15.65  mfu: 5.02%
[rank2]:2025-10-28 00:26:44,452 - INFO -  step: 720  loss: -2.0000  grad_norm:  0.7046  memory: 16.10GiB(33.90%)  tps: 2,054  tflops: 15.64  mfu: 5.01%
[rank1]:2025-10-28 00:26:44,456 - INFO -  step: 720  loss: -2.0000  grad_norm:  0.7046  memory: 20.03GiB(42.17%)  tps: 2,052  tflops: 15.63  mfu: 5.01%
[rank0]:2025-10-28 00:26:44,472 - INFO -  step: 720  loss: -2.0000  grad_norm:  0.7046  memory: 20.89GiB(43.97%)  tps: 2,049  tflops: 15.61  mfu: 5.00%
[rank3]:2025-10-28 00:26:46,289 - INFO - Avg. fwd time: 72.2277 / Avg. bwd time: 129.6116 / Avg. batch time: 1663.8021 (ms) / GPU bubble ratio: 2.95%
[rank2]:2025-10-28 00:26:46,346 - INFO - Avg. fwd time: 32.4276 / Avg. bwd time: 52.0924 / Avg. batch time: 1751.4998 (ms) / GPU bubble ratio: 61.40%
[rank1]:2025-10-28 00:26:46,426 - INFO - Avg. fwd time: 50.7872 / Avg. bwd time: 70.7703 / Avg. batch time: 1867.8195 (ms) / GPU bubble ratio: 47.94%
[rank0]:2025-10-28 00:26:46,488 - INFO - Avg. fwd time: 45.6040 / Avg. bwd time: 58.5859 / Avg. batch time: 1963.8843 (ms) / GPU bubble ratio: 57.56%
[rank3]:2025-10-28 00:28:04,177 - INFO -  step: 740  loss:  0.2278  grad_norm:  0.5243  memory: 38.93GiB(81.95%)  tps: 2,055  tflops: 15.65  mfu: 5.02%
[rank2]:2025-10-28 00:28:04,165 - INFO -  step: 740  loss: -2.0000  grad_norm:  0.5243  memory: 16.10GiB(33.90%)  tps: 2,055  tflops: 15.65  mfu: 5.02%
[rank1]:2025-10-28 00:28:04,169 - INFO -  step: 740  loss: -2.0000  grad_norm:  0.5243  memory: 20.03GiB(42.17%)  tps: 2,055  tflops: 15.65  mfu: 5.02%
[rank0]:2025-10-28 00:28:04,184 - INFO -  step: 740  loss: -2.0000  grad_norm:  0.5243  memory: 20.89GiB(43.97%)  tps: 2,055  tflops: 15.65  mfu: 5.02%
[rank0]:2025-10-28 00:28:40,197 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-28 00:29:24,292 - INFO -  step: 760  loss: -2.0000  grad_norm:  0.7557  memory: 16.10GiB(33.90%)  tps: 2,045  tflops: 15.57  mfu: 4.99%
[rank1]:2025-10-28 00:29:24,296 - INFO -  step: 760  loss: -2.0000  grad_norm:  0.7557  memory: 20.03GiB(42.17%)  tps: 2,045  tflops: 15.57  mfu: 4.99%
[rank0]:2025-10-28 00:29:24,312 - INFO -  step: 760  loss: -2.0000  grad_norm:  0.7557  memory: 20.89GiB(43.97%)  tps: 2,045  tflops: 15.57  mfu: 4.99%
[rank3]:2025-10-28 00:29:24,305 - INFO -  step: 760  loss:  0.2715  grad_norm:  0.7557  memory: 38.93GiB(81.95%)  tps: 2,045  tflops: 15.57  mfu: 4.99%
[rank3]:2025-10-28 00:29:26,138 - INFO - Avg. fwd time: 72.2333 / Avg. bwd time: 129.6329 / Avg. batch time: 1663.9700 (ms) / GPU bubble ratio: 2.95%
[rank2]:2025-10-28 00:29:26,200 - INFO - Avg. fwd time: 32.4405 / Avg. bwd time: 52.0982 / Avg. batch time: 1751.6678 (ms) / GPU bubble ratio: 61.39%
[rank1]:2025-10-28 00:29:26,276 - INFO - Avg. fwd time: 50.7950 / Avg. bwd time: 70.7565 / Avg. batch time: 1867.9586 (ms) / GPU bubble ratio: 47.94%
[rank0]:2025-10-28 00:29:26,343 - INFO - Avg. fwd time: 45.6045 / Avg. bwd time: 58.5793 / Avg. batch time: 1964.0155 (ms) / GPU bubble ratio: 57.56%
[rank1]:2025-10-28 00:30:44,656 - INFO -  step: 780  loss: -2.0000  grad_norm:  0.5731  memory: 20.03GiB(42.17%)  tps: 2,039  tflops: 15.53  mfu: 4.98%
[rank0]:2025-10-28 00:30:44,671 - INFO -  step: 780  loss: -2.0000  grad_norm:  0.5731  memory: 20.89GiB(43.97%)  tps: 2,039  tflops: 15.53  mfu: 4.98%
[rank3]:2025-10-28 00:30:44,664 - INFO -  step: 780  loss:  0.2868  grad_norm:  0.5731  memory: 38.93GiB(81.95%)  tps: 2,039  tflops: 15.53  mfu: 4.98%
[rank2]:2025-10-28 00:30:44,652 - INFO -  step: 780  loss: -2.0000  grad_norm:  0.5731  memory: 16.10GiB(33.90%)  tps: 2,039  tflops: 15.53  mfu: 4.98%
[rank0]:2025-10-28 00:32:00,839 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-28 00:32:04,921 - INFO -  step: 800  loss: -2.0000  grad_norm:  0.7304  memory: 16.10GiB(33.90%)  tps: 2,041  tflops: 15.55  mfu: 4.98%
[rank2]:2025-10-28 00:32:04,921 - INFO - ðŸ”Ž  Running validation at step 800
[rank1]:2025-10-28 00:32:04,925 - INFO -  step: 800  loss: -2.0000  grad_norm:  0.7304  memory: 20.03GiB(42.17%)  tps: 2,041  tflops: 15.55  mfu: 4.98%
[rank1]:2025-10-28 00:32:04,925 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-10-28 00:32:04,942 - INFO -  step: 800  loss: -2.0000  grad_norm:  0.7304  memory: 20.89GiB(43.97%)  tps: 2,041  tflops: 15.55  mfu: 4.98%
[rank0]:2025-10-28 00:32:04,942 - INFO - ðŸ”Ž  Running validation at step 800
[rank3]:2025-10-28 00:32:04,933 - INFO -  step: 800  loss:  0.2592  grad_norm:  0.7304  memory: 38.93GiB(81.95%)  tps: 2,041  tflops: 15.55  mfu: 4.98%
[rank3]:2025-10-28 00:32:04,934 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-10-28 00:33:14,677 - INFO - validate step: 800  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,874
[rank1]:2025-10-28 00:33:14,759 - INFO - validate step: 800  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,865
[rank3]:2025-10-28 00:33:14,903 - INFO - validate step: 800  loss:  0.9262  memory: 38.93GiB(81.95%)  tps: 5,854
[rank2]:2025-10-28 00:33:14,839 - INFO - validate step: 800  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,858
[rank3]:2025-10-28 00:33:15,108 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251028_0033_real_step800_rank3.svg
[rank3]:> Batch Time: 1914.62 ms, GPU Bubble Ratio: 56.48%, 48.85%, 65.07%, 15.23%
[rank3]:2025-10-28 00:33:16,819 - INFO - Avg. fwd time: 72.2626 / Avg. bwd time: 129.6853 / Avg. batch time: 1664.5365 (ms) / GPU bubble ratio: 2.94%
[rank2]:2025-10-28 00:33:16,878 - INFO - Avg. fwd time: 32.4486 / Avg. bwd time: 52.1108 / Avg. batch time: 1752.2763 (ms) / GPU bubble ratio: 61.39%
[rank1]:2025-10-28 00:33:16,950 - INFO - Avg. fwd time: 50.8015 / Avg. bwd time: 70.7501 / Avg. batch time: 1868.5980 (ms) / GPU bubble ratio: 47.96%
[rank0]:2025-10-28 00:33:17,014 - INFO - Avg. fwd time: 45.6122 / Avg. bwd time: 58.5827 / Avg. batch time: 1964.6485 (ms) / GPU bubble ratio: 57.57%
[rank3]:2025-10-28 00:33:56,913 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-28 00:33:56,976 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-28 00:33:57,047 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-28 00:33:57,106 - WARNING - Dataset alpaca is being re-looped
[rank3]:2025-10-28 00:34:36,700 - INFO -  step: 820  loss:  0.2358  grad_norm:  0.5036  memory: 38.93GiB(81.95%)  tps: 2,003  tflops: 15.26  mfu: 4.89%
[rank1]:2025-10-28 00:34:36,691 - INFO -  step: 820  loss: -2.0000  grad_norm:  0.5036  memory: 20.03GiB(42.17%)  tps: 2,000  tflops: 15.23  mfu: 4.88%
[rank0]:2025-10-28 00:34:36,709 - INFO -  step: 820  loss: -2.0000  grad_norm:  0.5036  memory: 20.89GiB(43.97%)  tps: 1,997  tflops: 15.21  mfu: 4.88%
[rank2]:2025-10-28 00:34:36,688 - INFO -  step: 820  loss: -2.0000  grad_norm:  0.5036  memory: 16.10GiB(33.90%)  tps: 2,002  tflops: 15.25  mfu: 4.89%
[rank1]:2025-10-28 00:35:56,304 - INFO -  step: 840  loss: -2.0000  grad_norm:  0.7268  memory: 20.03GiB(42.17%)  tps: 2,058  tflops: 15.67  mfu: 5.02%
[rank3]:2025-10-28 00:35:56,311 - INFO -  step: 840  loss:  0.2230  grad_norm:  0.7268  memory: 38.93GiB(81.95%)  tps: 2,058  tflops: 15.67  mfu: 5.02%
[rank2]:2025-10-28 00:35:56,299 - INFO -  step: 840  loss: -2.0000  grad_norm:  0.7268  memory: 16.10GiB(33.90%)  tps: 2,058  tflops: 15.67  mfu: 5.02%
[rank0]:2025-10-28 00:35:56,318 - INFO -  step: 840  loss: -2.0000  grad_norm:  0.7268  memory: 20.89GiB(43.97%)  tps: 2,058  tflops: 15.67  mfu: 5.02%
[rank3]:2025-10-28 00:35:58,140 - INFO - Avg. fwd time: 72.2536 / Avg. bwd time: 129.6954 / Avg. batch time: 1664.5021 (ms) / GPU bubble ratio: 2.94%
[rank2]:2025-10-28 00:35:58,203 - INFO - Avg. fwd time: 32.4514 / Avg. bwd time: 52.1160 / Avg. batch time: 1752.2366 (ms) / GPU bubble ratio: 61.39%
[rank1]:2025-10-28 00:35:58,281 - INFO - Avg. fwd time: 50.7908 / Avg. bwd time: 70.7439 / Avg. batch time: 1868.7589 (ms) / GPU bubble ratio: 47.97%
[rank0]:2025-10-28 00:35:58,351 - INFO - Avg. fwd time: 45.6207 / Avg. bwd time: 58.5925 / Avg. batch time: 1964.8018 (ms) / GPU bubble ratio: 57.57%
[rank0]:2025-10-28 00:36:32,230 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-28 00:37:15,907 - INFO -  step: 860  loss: -2.0000  grad_norm:  0.4441  memory: 20.03GiB(42.17%)  tps: 2,058  tflops: 15.68  mfu: 5.02%
[rank3]:2025-10-28 00:37:15,916 - INFO -  step: 860  loss:  0.2243  grad_norm:  0.4441  memory: 38.93GiB(81.95%)  tps: 2,058  tflops: 15.68  mfu: 5.02%
[rank2]:2025-10-28 00:37:15,904 - INFO -  step: 860  loss: -2.0000  grad_norm:  0.4441  memory: 16.10GiB(33.90%)  tps: 2,058  tflops: 15.68  mfu: 5.02%
[rank0]:2025-10-28 00:37:15,924 - INFO -  step: 860  loss: -2.0000  grad_norm:  0.4441  memory: 20.89GiB(43.97%)  tps: 2,058  tflops: 15.68  mfu: 5.02%
[rank1]:2025-10-28 00:38:35,895 - INFO -  step: 880  loss: -2.0000  grad_norm:  0.7497  memory: 20.03GiB(42.17%)  tps: 2,048  tflops: 15.60  mfu: 5.00%
[rank3]:2025-10-28 00:38:35,904 - INFO -  step: 880  loss:  0.2729  grad_norm:  0.7497  memory: 38.93GiB(81.95%)  tps: 2,048  tflops: 15.60  mfu: 5.00%
[rank2]:2025-10-28 00:38:35,892 - INFO -  step: 880  loss: -2.0000  grad_norm:  0.7497  memory: 16.10GiB(33.90%)  tps: 2,048  tflops: 15.60  mfu: 5.00%
[rank0]:2025-10-28 00:38:35,911 - INFO -  step: 880  loss: -2.0000  grad_norm:  0.7497  memory: 20.89GiB(43.97%)  tps: 2,048  tflops: 15.60  mfu: 5.00%
[rank3]:2025-10-28 00:38:37,730 - INFO - Avg. fwd time: 72.2464 / Avg. bwd time: 129.7029 / Avg. batch time: 1664.4858 (ms) / GPU bubble ratio: 2.94%
[rank2]:2025-10-28 00:38:37,786 - INFO - Avg. fwd time: 32.4570 / Avg. bwd time: 52.1180 / Avg. batch time: 1752.1907 (ms) / GPU bubble ratio: 61.39%
[rank1]:2025-10-28 00:38:37,859 - INFO - Avg. fwd time: 50.7776 / Avg. bwd time: 70.7221 / Avg. batch time: 1868.6630 (ms) / GPU bubble ratio: 47.98%
[rank0]:2025-10-28 00:38:37,925 - INFO - Avg. fwd time: 45.6039 / Avg. bwd time: 58.5956 / Avg. batch time: 1964.7073 (ms) / GPU bubble ratio: 57.57%
[rank0]:2025-10-28 00:39:51,978 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-28 00:39:55,959 - INFO -  step: 900  loss: -2.0000  grad_norm:  0.4398  memory: 20.89GiB(43.97%)  tps: 2,047  tflops: 15.59  mfu: 5.00%
[rank0]:2025-10-28 00:39:55,959 - INFO - ðŸ”Ž  Running validation at step 900
[rank1]:2025-10-28 00:39:55,943 - INFO -  step: 900  loss: -2.0000  grad_norm:  0.4398  memory: 20.03GiB(42.17%)  tps: 2,047  tflops: 15.59  mfu: 5.00%
[rank1]:2025-10-28 00:39:55,943 - INFO - ðŸ”Ž  Running validation at step 900
[rank3]:2025-10-28 00:39:55,951 - INFO -  step: 900  loss:  0.2149  grad_norm:  0.4398  memory: 38.93GiB(81.95%)  tps: 2,047  tflops: 15.59  mfu: 5.00%
[rank3]:2025-10-28 00:39:55,952 - INFO - ðŸ”Ž  Running validation at step 900
[rank2]:2025-10-28 00:39:55,939 - INFO -  step: 900  loss: -2.0000  grad_norm:  0.4398  memory: 16.10GiB(33.90%)  tps: 2,047  tflops: 15.59  mfu: 5.00%
[rank2]:2025-10-28 00:39:55,939 - INFO - ðŸ”Ž  Running validation at step 900
[rank0]:2025-10-28 00:41:05,386 - INFO - validate step: 900  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,900
[rank1]:2025-10-28 00:41:05,469 - INFO - validate step: 900  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,891
[rank2]:2025-10-28 00:41:05,548 - INFO - validate step: 900  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,884
[rank3]:2025-10-28 00:41:05,614 - INFO - validate step: 900  loss:  0.9332  memory: 38.93GiB(81.95%)  tps: 5,880
[rank3]:2025-10-28 00:41:05,847 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251028_0041_real_step900_rank3.svg
[rank3]:> Batch Time: 1914.59 ms, GPU Bubble Ratio: 56.47%, 48.89%, 65.07%, 15.22%
[rank1]:2025-10-28 00:42:26,193 - INFO -  step: 920  loss: -2.0000  grad_norm:  0.8133  memory: 20.03GiB(42.17%)  tps: 2,030  tflops: 15.46  mfu: 4.95%
[rank3]:2025-10-28 00:42:26,202 - INFO -  step: 920  loss:  0.3127  grad_norm:  0.8133  memory: 38.93GiB(81.95%)  tps: 2,033  tflops: 15.48  mfu: 4.96%
[rank2]:2025-10-28 00:42:26,190 - INFO -  step: 920  loss: -2.0000  grad_norm:  0.8133  memory: 16.10GiB(33.90%)  tps: 2,032  tflops: 15.47  mfu: 4.96%
[rank0]:2025-10-28 00:42:26,210 - INFO -  step: 920  loss: -2.0000  grad_norm:  0.8133  memory: 20.89GiB(43.97%)  tps: 2,027  tflops: 15.44  mfu: 4.95%
[rank3]:2025-10-28 00:42:28,038 - INFO - Avg. fwd time: 72.2603 / Avg. bwd time: 129.7456 / Avg. batch time: 1664.9294 (ms) / GPU bubble ratio: 2.94%
[rank2]:2025-10-28 00:42:28,096 - INFO - Avg. fwd time: 32.4646 / Avg. bwd time: 52.1216 / Avg. batch time: 1752.6866 (ms) / GPU bubble ratio: 61.39%
[rank1]:2025-10-28 00:42:28,168 - INFO - Avg. fwd time: 50.8062 / Avg. bwd time: 70.7303 / Avg. batch time: 1869.1813 (ms) / GPU bubble ratio: 47.98%
[rank0]:2025-10-28 00:42:28,234 - INFO - Avg. fwd time: 45.6054 / Avg. bwd time: 58.6044 / Avg. batch time: 1965.2044 (ms) / GPU bubble ratio: 57.58%
[rank1]:2025-10-28 00:43:46,199 - INFO -  step: 940  loss: -2.0000  grad_norm:  0.5514  memory: 20.03GiB(42.17%)  tps: 2,048  tflops: 15.60  mfu: 5.00%
[rank3]:2025-10-28 00:43:46,206 - INFO -  step: 940  loss:  0.2591  grad_norm:  0.5514  memory: 38.93GiB(81.95%)  tps: 2,048  tflops: 15.60  mfu: 5.00%
[rank2]:2025-10-28 00:43:46,194 - INFO -  step: 940  loss: -2.0000  grad_norm:  0.5514  memory: 16.10GiB(33.90%)  tps: 2,048  tflops: 15.60  mfu: 5.00%
[rank0]:2025-10-28 00:43:46,213 - INFO -  step: 940  loss: -2.0000  grad_norm:  0.5514  memory: 20.89GiB(43.97%)  tps: 2,048  tflops: 15.60  mfu: 5.00%
[rank0]:2025-10-28 00:44:22,110 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-28 00:45:06,100 - INFO -  step: 960  loss: -2.0000  grad_norm:  0.7716  memory: 20.03GiB(42.17%)  tps: 2,051  tflops: 15.62  mfu: 5.01%
[rank0]:2025-10-28 00:45:06,116 - INFO -  step: 960  loss: -2.0000  grad_norm:  0.7716  memory: 20.89GiB(43.97%)  tps: 2,051  tflops: 15.62  mfu: 5.01%
[rank2]:2025-10-28 00:45:06,096 - INFO -  step: 960  loss: -2.0000  grad_norm:  0.7716  memory: 16.10GiB(33.90%)  tps: 2,051  tflops: 15.62  mfu: 5.01%
[rank3]:2025-10-28 00:45:06,108 - INFO -  step: 960  loss:  0.2856  grad_norm:  0.7716  memory: 38.93GiB(81.95%)  tps: 2,051  tflops: 15.62  mfu: 5.01%
[rank3]:2025-10-28 00:45:07,935 - INFO - Avg. fwd time: 72.2679 / Avg. bwd time: 129.7591 / Avg. batch time: 1665.0549 (ms) / GPU bubble ratio: 2.93%
[rank2]:2025-10-28 00:45:07,992 - INFO - Avg. fwd time: 32.4743 / Avg. bwd time: 52.1229 / Avg. batch time: 1752.7706 (ms) / GPU bubble ratio: 61.39%
[rank1]:2025-10-28 00:45:08,063 - INFO - Avg. fwd time: 50.7951 / Avg. bwd time: 70.7188 / Avg. batch time: 1869.2481 (ms) / GPU bubble ratio: 47.99%
[rank0]:2025-10-28 00:45:08,130 - INFO - Avg. fwd time: 45.6045 / Avg. bwd time: 58.5956 / Avg. batch time: 1965.2672 (ms) / GPU bubble ratio: 57.58%
[rank3]:2025-10-28 00:46:25,764 - INFO -  step: 980  loss:  0.2478  grad_norm:  0.4505  memory: 38.93GiB(81.95%)  tps: 2,057  tflops: 15.67  mfu: 5.02%
[rank1]:2025-10-28 00:46:25,757 - INFO -  step: 980  loss: -2.0000  grad_norm:  0.4505  memory: 20.03GiB(42.17%)  tps: 2,057  tflops: 15.67  mfu: 5.02%
[rank2]:2025-10-28 00:46:25,752 - INFO -  step: 980  loss: -2.0000  grad_norm:  0.4505  memory: 16.10GiB(33.90%)  tps: 2,057  tflops: 15.67  mfu: 5.02%
[rank0]:2025-10-28 00:46:25,777 - INFO -  step: 980  loss: -2.0000  grad_norm:  0.4505  memory: 20.89GiB(43.97%)  tps: 2,057  tflops: 15.66  mfu: 5.02%
[rank0]:2025-10-28 00:47:41,560 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-28 00:47:45,612 - INFO -  step: 1000  loss: -2.0000  grad_norm:  0.7428  memory: 16.10GiB(33.90%)  tps: 2,052  tflops: 15.63  mfu: 5.01%
[rank2]:2025-10-28 00:47:45,613 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-10-28 00:47:45,630 - INFO -  step: 1000  loss: -2.0000  grad_norm:  0.7428  memory: 20.89GiB(43.97%)  tps: 2,052  tflops: 15.63  mfu: 5.01%
[rank0]:2025-10-28 00:47:45,630 - INFO - ðŸ”Ž  Running validation at step 1000
[rank3]:2025-10-28 00:47:45,625 - INFO -  step: 1000  loss:  0.2765  grad_norm:  0.7428  memory: 38.93GiB(81.95%)  tps: 2,052  tflops: 15.63  mfu: 5.01%
[rank3]:2025-10-28 00:47:45,626 - INFO - ðŸ”Ž  Running validation at step 1000
[rank1]:2025-10-28 00:47:45,616 - INFO -  step: 1000  loss: -2.0000  grad_norm:  0.7428  memory: 20.03GiB(42.17%)  tps: 2,052  tflops: 15.63  mfu: 5.01%
[rank1]:2025-10-28 00:47:45,616 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-10-28 00:48:55,124 - INFO - validate step: 1000  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,894
[rank0]:2025-10-28 00:48:55,125 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-28 00:48:55,134 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank1]:2025-10-28 00:48:55,205 - INFO - validate step: 1000  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,886
[rank1]:2025-10-28 00:48:55,205 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-28 00:48:55,288 - INFO - validate step: 1000  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,879
[rank2]:2025-10-28 00:48:55,289 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-28 00:48:55,352 - INFO - validate step: 1000  loss:  0.9411  memory: 38.93GiB(81.95%)  tps: 5,875
[rank3]:2025-10-28 00:48:55,353 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-28 00:48:57,159 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 1.87 seconds.
[rank1]:2025-10-28 00:48:57,450 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 2.24 seconds.
[rank3]:2025-10-28 00:48:58,609 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.26 seconds.
[rank0]:2025-10-28 00:48:58,824 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-28 00:48:58,831 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.71 seconds.
[rank3]:2025-10-28 00:48:59,232 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251028_0048_real_step1000_rank3.svg
[rank3]:> Batch Time: 1914.84 ms, GPU Bubble Ratio: 56.49%, 48.91%, 65.07%, 15.22%
[rank3]:2025-10-28 00:49:00,930 - INFO - Avg. fwd time: 72.2571 / Avg. bwd time: 129.7643 / Avg. batch time: 1665.0006 (ms) / GPU bubble ratio: 2.93%
[rank2]:2025-10-28 00:49:00,987 - INFO - Avg. fwd time: 32.4772 / Avg. bwd time: 52.1237 / Avg. batch time: 1752.8332 (ms) / GPU bubble ratio: 61.39%
[rank1]:2025-10-28 00:49:01,061 - INFO - Avg. fwd time: 50.7874 / Avg. bwd time: 70.7061 / Avg. batch time: 1869.2715 (ms) / GPU bubble ratio: 48.00%
[rank0]:2025-10-28 00:49:01,134 - INFO - Avg. fwd time: 45.6026 / Avg. bwd time: 58.5876 / Avg. batch time: 1965.2690 (ms) / GPU bubble ratio: 57.59%
[rank3]:2025-10-28 00:50:19,372 - INFO -  step: 1020  loss:  0.2001  grad_norm:  0.5070  memory: 38.93GiB(81.95%)  tps: 1,950  tflops: 14.85  mfu: 4.76%
[rank1]:2025-10-28 00:50:19,364 - INFO -  step: 1020  loss: -2.0000  grad_norm:  0.5070  memory: 20.03GiB(42.17%)  tps: 1,947  tflops: 14.83  mfu: 4.75%
[rank2]:2025-10-28 00:50:19,360 - INFO -  step: 1020  loss: -2.0000  grad_norm:  0.5070  memory: 16.10GiB(33.90%)  tps: 1,949  tflops: 14.84  mfu: 4.76%
[rank0]:2025-10-28 00:50:19,377 - INFO -  step: 1020  loss: -2.0000  grad_norm:  0.5070  memory: 20.89GiB(43.97%)  tps: 1,945  tflops: 14.81  mfu: 4.75%
[rank0]:2025-10-28 00:51:39,649 - INFO -  step: 1040  loss: -2.0000  grad_norm:  0.7045  memory: 20.89GiB(43.97%)  tps: 2,041  tflops: 15.55  mfu: 4.98%
[rank3]:2025-10-28 00:51:39,641 - INFO -  step: 1040  loss:  0.2205  grad_norm:  0.7045  memory: 38.93GiB(81.95%)  tps: 2,041  tflops: 15.55  mfu: 4.98%
[rank1]:2025-10-28 00:51:39,632 - INFO -  step: 1040  loss: -2.0000  grad_norm:  0.7045  memory: 20.03GiB(42.17%)  tps: 2,041  tflops: 15.55  mfu: 4.98%
[rank2]:2025-10-28 00:51:39,629 - INFO -  step: 1040  loss: -2.0000  grad_norm:  0.7045  memory: 16.10GiB(33.90%)  tps: 2,041  tflops: 15.55  mfu: 4.98%
[rank3]:2025-10-28 00:51:41,480 - INFO - Avg. fwd time: 72.2745 / Avg. bwd time: 129.7928 / Avg. batch time: 1665.3253 (ms) / GPU bubble ratio: 2.93%
[rank1]:2025-10-28 00:51:41,617 - INFO - Avg. fwd time: 50.8055 / Avg. bwd time: 70.7087 / Avg. batch time: 1869.6089 (ms) / GPU bubble ratio: 48.00%
[rank2]:2025-10-28 00:51:41,540 - INFO - Avg. fwd time: 32.4793 / Avg. bwd time: 52.1301 / Avg. batch time: 1753.1503 (ms) / GPU bubble ratio: 61.39%
[rank0]:2025-10-28 00:51:41,683 - INFO - Avg. fwd time: 45.6113 / Avg. bwd time: 58.5875 / Avg. batch time: 1965.6239 (ms) / GPU bubble ratio: 57.59%
[rank0]:2025-10-28 00:52:15,932 - INFO - [GC] Peforming periodical GC collection 0.25 seconds
[rank3]:2025-10-28 00:52:59,786 - INFO -  step: 1060  loss:  0.1811  grad_norm:  0.4511  memory: 38.93GiB(81.95%)  tps: 2,044  tflops: 15.57  mfu: 4.99%
[rank1]:2025-10-28 00:52:59,778 - INFO -  step: 1060  loss: -2.0000  grad_norm:  0.4511  memory: 20.03GiB(42.17%)  tps: 2,044  tflops: 15.57  mfu: 4.99%
[rank2]:2025-10-28 00:52:59,774 - INFO -  step: 1060  loss: -2.0000  grad_norm:  0.4511  memory: 16.10GiB(33.90%)  tps: 2,044  tflops: 15.57  mfu: 4.99%
[rank0]:2025-10-28 00:52:59,795 - INFO -  step: 1060  loss: -2.0000  grad_norm:  0.4511  memory: 20.89GiB(43.97%)  tps: 2,044  tflops: 15.57  mfu: 4.99%
[rank1]:2025-10-28 00:54:19,611 - INFO -  step: 1080  loss: -2.0000  grad_norm:  0.6975  memory: 20.03GiB(42.17%)  tps: 2,052  tflops: 15.63  mfu: 5.01%
[rank2]:2025-10-28 00:54:19,607 - INFO -  step: 1080  loss: -2.0000  grad_norm:  0.6975  memory: 16.10GiB(33.90%)  tps: 2,052  tflops: 15.63  mfu: 5.01%
[rank3]:2025-10-28 00:54:19,620 - INFO -  step: 1080  loss:  0.1584  grad_norm:  0.6975  memory: 38.93GiB(81.95%)  tps: 2,052  tflops: 15.63  mfu: 5.01%
[rank0]:2025-10-28 00:54:19,627 - INFO -  step: 1080  loss: -2.0000  grad_norm:  0.6975  memory: 20.89GiB(43.97%)  tps: 2,052  tflops: 15.63  mfu: 5.01%
[rank3]:2025-10-28 00:54:21,446 - INFO - Avg. fwd time: 72.2660 / Avg. bwd time: 129.8002 / Avg. batch time: 1665.3094 (ms) / GPU bubble ratio: 2.93%
[rank2]:2025-10-28 00:54:21,506 - INFO - Avg. fwd time: 32.4882 / Avg. bwd time: 52.1353 / Avg. batch time: 1753.1371 (ms) / GPU bubble ratio: 61.38%
[rank1]:2025-10-28 00:54:21,580 - INFO - Avg. fwd time: 50.8096 / Avg. bwd time: 70.7067 / Avg. batch time: 1869.6004 (ms) / GPU bubble ratio: 48.00%
[rank0]:2025-10-28 00:54:21,648 - INFO - Avg. fwd time: 45.6171 / Avg. bwd time: 58.5837 / Avg. batch time: 1965.5895 (ms) / GPU bubble ratio: 57.59%
[rank0]:2025-10-28 00:55:35,357 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-28 00:55:39,355 - INFO -  step: 1100  loss:  0.2835  grad_norm:  0.5360  memory: 38.93GiB(81.95%)  tps: 2,055  tflops: 15.65  mfu: 5.02%
[rank3]:2025-10-28 00:55:39,356 - INFO - ðŸ”Ž  Running validation at step 1100
[rank1]:2025-10-28 00:55:39,347 - INFO -  step: 1100  loss: -2.0000  grad_norm:  0.5360  memory: 20.03GiB(42.17%)  tps: 2,055  tflops: 15.65  mfu: 5.02%
[rank1]:2025-10-28 00:55:39,348 - INFO - ðŸ”Ž  Running validation at step 1100
[rank0]:2025-10-28 00:55:39,363 - INFO -  step: 1100  loss: -2.0000  grad_norm:  0.5360  memory: 20.89GiB(43.97%)  tps: 2,055  tflops: 15.65  mfu: 5.02%
[rank0]:2025-10-28 00:55:39,363 - INFO - ðŸ”Ž  Running validation at step 1100
[rank2]:2025-10-28 00:55:39,343 - INFO -  step: 1100  loss: -2.0000  grad_norm:  0.5360  memory: 16.10GiB(33.90%)  tps: 2,055  tflops: 15.65  mfu: 5.02%
[rank2]:2025-10-28 00:55:39,343 - INFO - ðŸ”Ž  Running validation at step 1100
[rank0]:2025-10-28 00:56:48,563 - INFO - validate step: 1100  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,919
[rank1]:2025-10-28 00:56:48,644 - INFO - validate step: 1100  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,911
[rank2]:2025-10-28 00:56:48,726 - INFO - validate step: 1100  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,904
[rank3]:2025-10-28 00:56:48,790 - INFO - validate step: 1100  loss:  0.9455  memory: 38.93GiB(81.95%)  tps: 5,899
[rank3]:2025-10-28 00:56:48,996 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251028_0056_real_step1100_rank3.svg
[rank3]:> Batch Time: 1915.50 ms, GPU Bubble Ratio: 56.51%, 48.93%, 65.07%, 15.22%
[rank1]:2025-10-28 00:58:09,069 - INFO -  step: 1120  loss: -2.0000  grad_norm:  0.7070  memory: 20.03GiB(42.17%)  tps: 2,037  tflops: 15.52  mfu: 4.97%
[rank0]:2025-10-28 00:58:09,083 - INFO -  step: 1120  loss: -2.0000  grad_norm:  0.7070  memory: 20.89GiB(43.97%)  tps: 2,035  tflops: 15.50  mfu: 4.97%
[rank2]:2025-10-28 00:58:09,065 - INFO -  step: 1120  loss: -2.0000  grad_norm:  0.7070  memory: 16.10GiB(33.90%)  tps: 2,039  tflops: 15.53  mfu: 4.98%
[rank3]:2025-10-28 00:58:09,077 - INFO -  step: 1120  loss:  0.1935  grad_norm:  0.7070  memory: 38.93GiB(81.95%)  tps: 2,041  tflops: 15.54  mfu: 4.98%
[rank3]:2025-10-28 00:58:10,922 - INFO - Avg. fwd time: 72.2737 / Avg. bwd time: 129.8120 / Avg. batch time: 1665.4314 (ms) / GPU bubble ratio: 2.93%
[rank2]:2025-10-28 00:58:10,980 - INFO - Avg. fwd time: 32.4916 / Avg. bwd time: 52.1352 / Avg. batch time: 1753.2787 (ms) / GPU bubble ratio: 61.39%
[rank1]:2025-10-28 00:58:11,053 - INFO - Avg. fwd time: 50.8214 / Avg. bwd time: 70.6932 / Avg. batch time: 1869.7332 (ms) / GPU bubble ratio: 48.01%
[rank0]:2025-10-28 00:58:11,118 - INFO - Avg. fwd time: 45.6216 / Avg. bwd time: 58.5767 / Avg. batch time: 1965.6943 (ms) / GPU bubble ratio: 57.59%
[rank3]:2025-10-28 00:59:29,262 - INFO -  step: 1140  loss:  0.1661  grad_norm:  0.3995  memory: 38.93GiB(81.95%)  tps: 2,043  tflops: 15.56  mfu: 4.99%
[rank1]:2025-10-28 00:59:29,253 - INFO -  step: 1140  loss: -2.0000  grad_norm:  0.3995  memory: 20.03GiB(42.17%)  tps: 2,043  tflops: 15.56  mfu: 4.99%
[rank2]:2025-10-28 00:59:29,251 - INFO -  step: 1140  loss: -2.0000  grad_norm:  0.3995  memory: 16.10GiB(33.90%)  tps: 2,043  tflops: 15.56  mfu: 4.99%
[rank0]:2025-10-28 00:59:29,270 - INFO -  step: 1140  loss: -2.0000  grad_norm:  0.3995  memory: 20.89GiB(43.97%)  tps: 2,043  tflops: 15.56  mfu: 4.99%
[rank0]:2025-10-28 01:00:05,423 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-28 01:00:49,577 - INFO -  step: 1160  loss: -2.0000  grad_norm:  0.7298  memory: 20.03GiB(42.17%)  tps: 2,040  tflops: 15.54  mfu: 4.98%
[rank2]:2025-10-28 01:00:49,572 - INFO -  step: 1160  loss: -2.0000  grad_norm:  0.7298  memory: 16.10GiB(33.90%)  tps: 2,040  tflops: 15.54  mfu: 4.98%
[rank0]:2025-10-28 01:00:49,595 - INFO -  step: 1160  loss: -2.0000  grad_norm:  0.7298  memory: 20.89GiB(43.97%)  tps: 2,040  tflops: 15.53  mfu: 4.98%
[rank3]:2025-10-28 01:00:49,585 - INFO -  step: 1160  loss:  0.2268  grad_norm:  0.7298  memory: 38.93GiB(81.95%)  tps: 2,040  tflops: 15.54  mfu: 4.98%
[rank3]:2025-10-28 01:00:51,425 - INFO - Avg. fwd time: 72.2851 / Avg. bwd time: 129.8375 / Avg. batch time: 1665.7025 (ms) / GPU bubble ratio: 2.93%
[rank2]:2025-10-28 01:00:51,486 - INFO - Avg. fwd time: 32.4928 / Avg. bwd time: 52.1433 / Avg. batch time: 1753.5390 (ms) / GPU bubble ratio: 61.39%
[rank1]:2025-10-28 01:00:51,557 - INFO - Avg. fwd time: 50.8207 / Avg. bwd time: 70.6993 / Avg. batch time: 1870.0316 (ms) / GPU bubble ratio: 48.01%
[rank0]:2025-10-28 01:00:51,626 - INFO - Avg. fwd time: 45.6225 / Avg. bwd time: 58.5808 / Avg. batch time: 1966.0048 (ms) / GPU bubble ratio: 57.60%
[rank1]:2025-10-28 01:02:09,505 - INFO -  step: 1180  loss: -2.0000  grad_norm:  0.6273  memory: 20.03GiB(42.17%)  tps: 2,050  tflops: 15.61  mfu: 5.00%
[rank2]:2025-10-28 01:02:09,498 - INFO -  step: 1180  loss: -2.0000  grad_norm:  0.6273  memory: 16.10GiB(33.90%)  tps: 2,050  tflops: 15.61  mfu: 5.00%
[rank3]:2025-10-28 01:02:09,510 - INFO -  step: 1180  loss:  0.2235  grad_norm:  0.6273  memory: 38.93GiB(81.95%)  tps: 2,050  tflops: 15.61  mfu: 5.00%
[rank0]:2025-10-28 01:02:09,516 - INFO -  step: 1180  loss: -2.0000  grad_norm:  0.6273  memory: 20.89GiB(43.97%)  tps: 2,050  tflops: 15.61  mfu: 5.00%
[rank0]:2025-10-28 01:03:25,433 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-28 01:03:29,477 - INFO -  step: 1200  loss: -2.0000  grad_norm:  0.6939  memory: 20.03GiB(42.17%)  tps: 2,049  tflops: 15.60  mfu: 5.00%
[rank1]:2025-10-28 01:03:29,477 - INFO - ðŸ”Ž  Running validation at step 1200
[rank2]:2025-10-28 01:03:29,472 - INFO -  step: 1200  loss: -2.0000  grad_norm:  0.6939  memory: 16.10GiB(33.90%)  tps: 2,049  tflops: 15.60  mfu: 5.00%
[rank2]:2025-10-28 01:03:29,472 - INFO - ðŸ”Ž  Running validation at step 1200
[rank3]:2025-10-28 01:03:29,485 - INFO -  step: 1200  loss:  0.1682  grad_norm:  0.6939  memory: 38.93GiB(81.95%)  tps: 2,049  tflops: 15.60  mfu: 5.00%
[rank3]:2025-10-28 01:03:29,486 - INFO - ðŸ”Ž  Running validation at step 1200
[rank0]:2025-10-28 01:03:29,497 - INFO -  step: 1200  loss: -2.0000  grad_norm:  0.6939  memory: 20.89GiB(43.97%)  tps: 2,048  tflops: 15.60  mfu: 5.00%
[rank0]:2025-10-28 01:03:29,497 - INFO - ðŸ”Ž  Running validation at step 1200
[rank0]:2025-10-28 01:04:38,644 - INFO - validate step: 1200  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,924
[rank1]:2025-10-28 01:04:38,725 - INFO - validate step: 1200  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,915
[rank2]:2025-10-28 01:04:38,806 - INFO - validate step: 1200  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,908
[rank3]:2025-10-28 01:04:38,871 - INFO - validate step: 1200  loss:  0.9478  memory: 38.93GiB(81.95%)  tps: 5,903
[rank3]:2025-10-28 01:04:39,083 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251028_0104_real_step1200_rank3.svg
[rank3]:> Batch Time: 1916.03 ms, GPU Bubble Ratio: 56.53%, 48.99%, 65.08%, 15.22%
[rank3]:2025-10-28 01:04:40,811 - INFO - Avg. fwd time: 72.2918 / Avg. bwd time: 129.8465 / Avg. batch time: 1665.7838 (ms) / GPU bubble ratio: 2.92%
[rank2]:2025-10-28 01:04:40,874 - INFO - Avg. fwd time: 32.4919 / Avg. bwd time: 52.1375 / Avg. batch time: 1753.6346 (ms) / GPU bubble ratio: 61.39%
[rank1]:2025-10-28 01:04:40,947 - INFO - Avg. fwd time: 50.8173 / Avg. bwd time: 70.6843 / Avg. batch time: 1870.0942 (ms) / GPU bubble ratio: 48.02%
[rank0]:2025-10-28 01:04:41,016 - INFO - Avg. fwd time: 45.6283 / Avg. bwd time: 58.5743 / Avg. batch time: 1966.0742 (ms) / GPU bubble ratio: 57.60%
[rank0]:2025-10-28 01:05:58,894 - INFO -  step: 1220  loss: -2.0000  grad_norm:  0.4594  memory: 20.89GiB(43.97%)  tps: 2,042  tflops: 15.55  mfu: 4.98%
[rank1]:2025-10-28 01:05:58,878 - INFO -  step: 1220  loss: -2.0000  grad_norm:  0.4594  memory: 20.03GiB(42.17%)  tps: 2,044  tflops: 15.57  mfu: 4.99%
[rank2]:2025-10-28 01:05:58,874 - INFO -  step: 1220  loss: -2.0000  grad_norm:  0.4594  memory: 16.10GiB(33.90%)  tps: 2,046  tflops: 15.58  mfu: 5.00%
[rank3]:2025-10-28 01:05:58,886 - INFO -  step: 1220  loss:  0.1873  grad_norm:  0.4594  memory: 38.93GiB(81.95%)  tps: 2,048  tflops: 15.60  mfu: 5.00%
[rank2]:2025-10-28 01:07:18,936 - INFO -  step: 1240  loss: -2.0000  grad_norm:  0.6796  memory: 16.10GiB(33.90%)  tps: 2,046  tflops: 15.59  mfu: 5.00%
[rank3]:2025-10-28 01:07:18,949 - INFO -  step: 1240  loss:  0.2116  grad_norm:  0.6796  memory: 38.93GiB(81.95%)  tps: 2,046  tflops: 15.59  mfu: 5.00%
[rank1]:2025-10-28 01:07:18,941 - INFO -  step: 1240  loss: -2.0000  grad_norm:  0.6796  memory: 20.03GiB(42.17%)  tps: 2,046  tflops: 15.59  mfu: 5.00%
[rank0]:2025-10-28 01:07:18,956 - INFO -  step: 1240  loss: -2.0000  grad_norm:  0.6796  memory: 20.89GiB(43.97%)  tps: 2,046  tflops: 15.59  mfu: 5.00%
[rank3]:2025-10-28 01:07:20,797 - INFO - Avg. fwd time: 72.2944 / Avg. bwd time: 129.8601 / Avg. batch time: 1665.9113 (ms) / GPU bubble ratio: 2.92%
[rank2]:2025-10-28 01:07:20,855 - INFO - Avg. fwd time: 32.4980 / Avg. bwd time: 52.1364 / Avg. batch time: 1753.7353 (ms) / GPU bubble ratio: 61.39%
[rank1]:2025-10-28 01:07:20,935 - INFO - Avg. fwd time: 50.8288 / Avg. bwd time: 70.6743 / Avg. batch time: 1870.1758 (ms) / GPU bubble ratio: 48.02%
[rank0]:2025-10-28 01:07:21,003 - INFO - Avg. fwd time: 45.6255 / Avg. bwd time: 58.5715 / Avg. batch time: 1966.1400 (ms) / GPU bubble ratio: 57.60%
[rank0]:2025-10-28 01:07:55,228 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-28 01:08:39,309 - INFO -  step: 1260  loss: -2.0000  grad_norm:  0.4681  memory: 20.03GiB(42.17%)  tps: 2,039  tflops: 15.53  mfu: 4.98%
[rank0]:2025-10-28 01:08:39,325 - INFO -  step: 1260  loss: -2.0000  grad_norm:  0.4681  memory: 20.89GiB(43.97%)  tps: 2,039  tflops: 15.53  mfu: 4.98%
[rank2]:2025-10-28 01:08:39,306 - INFO -  step: 1260  loss: -2.0000  grad_norm:  0.4681  memory: 16.10GiB(33.90%)  tps: 2,039  tflops: 15.53  mfu: 4.98%
[rank3]:2025-10-28 01:08:39,318 - INFO -  step: 1260  loss:  0.2029  grad_norm:  0.4681  memory: 38.93GiB(81.95%)  tps: 2,039  tflops: 15.53  mfu: 4.98%
[rank1]:2025-10-28 01:09:59,484 - INFO -  step: 1280  loss: -2.0000  grad_norm:  0.7072  memory: 20.03GiB(42.17%)  tps: 2,044  tflops: 15.56  mfu: 4.99%
[rank2]:2025-10-28 01:09:59,480 - INFO -  step: 1280  loss: -2.0000  grad_norm:  0.7072  memory: 16.10GiB(33.90%)  tps: 2,044  tflops: 15.56  mfu: 4.99%
[rank0]:2025-10-28 01:09:59,496 - INFO -  step: 1280  loss: -2.0000  grad_norm:  0.7072  memory: 20.89GiB(43.97%)  tps: 2,044  tflops: 15.56  mfu: 4.99%
[rank3]:2025-10-28 01:09:59,493 - INFO -  step: 1280  loss:  0.1796  grad_norm:  0.7072  memory: 38.93GiB(81.95%)  tps: 2,044  tflops: 15.56  mfu: 4.99%
[rank3]:2025-10-28 01:10:01,326 - INFO - Avg. fwd time: 72.3076 / Avg. bwd time: 129.8870 / Avg. batch time: 1666.2115 (ms) / GPU bubble ratio: 2.92%
[rank2]:2025-10-28 01:10:01,389 - INFO - Avg. fwd time: 32.5018 / Avg. bwd time: 52.1352 / Avg. batch time: 1754.0122 (ms) / GPU bubble ratio: 61.40%
[rank1]:2025-10-28 01:10:01,464 - INFO - Avg. fwd time: 50.8489 / Avg. bwd time: 70.6739 / Avg. batch time: 1870.4519 (ms) / GPU bubble ratio: 48.02%
[rank0]:2025-10-28 01:10:01,532 - INFO - Avg. fwd time: 45.6335 / Avg. bwd time: 58.5678 / Avg. batch time: 1966.4034 (ms) / GPU bubble ratio: 57.61%
[rank0]:2025-10-28 01:11:15,457 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-28 01:11:19,433 - INFO -  step: 1300  loss: -2.0000  grad_norm:  0.5388  memory: 20.03GiB(42.17%)  tps: 2,049  tflops: 15.61  mfu: 5.00%
[rank1]:2025-10-28 01:11:19,433 - INFO - ðŸ”Ž  Running validation at step 1300
[rank2]:2025-10-28 01:11:19,429 - INFO -  step: 1300  loss: -2.0000  grad_norm:  0.5388  memory: 16.10GiB(33.90%)  tps: 2,049  tflops: 15.61  mfu: 5.00%
[rank2]:2025-10-28 01:11:19,429 - INFO - ðŸ”Ž  Running validation at step 1300
[rank3]:2025-10-28 01:11:19,441 - INFO -  step: 1300  loss:  0.2404  grad_norm:  0.5388  memory: 38.93GiB(81.95%)  tps: 2,049  tflops: 15.61  mfu: 5.00%
[rank3]:2025-10-28 01:11:19,442 - INFO - ðŸ”Ž  Running validation at step 1300
[rank0]:2025-10-28 01:11:19,449 - INFO -  step: 1300  loss: -2.0000  grad_norm:  0.5388  memory: 20.89GiB(43.97%)  tps: 2,049  tflops: 15.61  mfu: 5.00%
[rank0]:2025-10-28 01:11:19,449 - INFO - ðŸ”Ž  Running validation at step 1300
[rank0]:2025-10-28 01:12:28,896 - INFO - validate step: 1300  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,898
[rank1]:2025-10-28 01:12:28,979 - INFO - validate step: 1300  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,890
[rank2]:2025-10-28 01:12:29,060 - INFO - validate step: 1300  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,883
[rank3]:2025-10-28 01:12:29,124 - INFO - validate step: 1300  loss:  0.9457  memory: 38.93GiB(81.95%)  tps: 5,878
[rank3]:2025-10-28 01:12:29,338 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251028_0112_real_step1300_rank3.svg
[rank3]:> Batch Time: 1916.44 ms, GPU Bubble Ratio: 56.54%, 49.00%, 65.08%, 15.22%
[rank3]:2025-10-28 01:13:49,056 - INFO -  step: 1320  loss:  0.1960  grad_norm:  0.7225  memory: 38.93GiB(81.95%)  tps: 2,050  tflops: 15.61  mfu: 5.00%
[rank1]:2025-10-28 01:13:49,048 - INFO -  step: 1320  loss: -2.0000  grad_norm:  0.7225  memory: 20.03GiB(42.17%)  tps: 2,046  tflops: 15.58  mfu: 5.00%
[rank2]:2025-10-28 01:13:49,044 - INFO -  step: 1320  loss: -2.0000  grad_norm:  0.7225  memory: 16.10GiB(33.90%)  tps: 2,048  tflops: 15.60  mfu: 5.00%
[rank0]:2025-10-28 01:13:49,064 - INFO -  step: 1320  loss: -2.0000  grad_norm:  0.7225  memory: 20.89GiB(43.97%)  tps: 2,044  tflops: 15.57  mfu: 4.99%
[rank3]:2025-10-28 01:13:50,887 - INFO - Avg. fwd time: 72.3054 / Avg. bwd time: 129.8939 / Avg. batch time: 1666.2237 (ms) / GPU bubble ratio: 2.92%
[rank2]:2025-10-28 01:13:50,948 - INFO - Avg. fwd time: 32.5040 / Avg. bwd time: 52.1368 / Avg. batch time: 1754.0585 (ms) / GPU bubble ratio: 61.40%
[rank1]:2025-10-28 01:13:51,031 - INFO - Avg. fwd time: 50.8510 / Avg. bwd time: 70.6649 / Avg. batch time: 1870.4902 (ms) / GPU bubble ratio: 48.03%
[rank0]:2025-10-28 01:13:51,094 - INFO - Avg. fwd time: 45.6284 / Avg. bwd time: 58.5660 / Avg. batch time: 1966.4091 (ms) / GPU bubble ratio: 57.61%
[rank3]:2025-10-28 01:15:09,070 - INFO -  step: 1340  loss:  0.2563  grad_norm:  0.5446  memory: 38.93GiB(81.95%)  tps: 2,048  tflops: 15.60  mfu: 5.00%
[rank1]:2025-10-28 01:15:09,061 - INFO -  step: 1340  loss: -2.0000  grad_norm:  0.5446  memory: 20.03GiB(42.17%)  tps: 2,048  tflops: 15.60  mfu: 5.00%
[rank2]:2025-10-28 01:15:09,058 - INFO -  step: 1340  loss: -2.0000  grad_norm:  0.5446  memory: 16.10GiB(33.90%)  tps: 2,048  tflops: 15.60  mfu: 5.00%
[rank0]:2025-10-28 01:15:09,075 - INFO -  step: 1340  loss: -2.0000  grad_norm:  0.5446  memory: 20.89GiB(43.97%)  tps: 2,048  tflops: 15.60  mfu: 5.00%
[rank0]:2025-10-28 01:15:45,168 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-28 01:16:29,411 - INFO -  step: 1360  loss: -2.0000  grad_norm:  0.7079  memory: 20.03GiB(42.17%)  tps: 2,039  tflops: 15.53  mfu: 4.98%
[rank2]:2025-10-28 01:16:29,407 - INFO -  step: 1360  loss: -2.0000  grad_norm:  0.7079  memory: 16.10GiB(33.90%)  tps: 2,039  tflops: 15.53  mfu: 4.98%
[rank0]:2025-10-28 01:16:29,426 - INFO -  step: 1360  loss: -2.0000  grad_norm:  0.7079  memory: 20.89GiB(43.97%)  tps: 2,039  tflops: 15.53  mfu: 4.98%
[rank3]:2025-10-28 01:16:29,420 - INFO -  step: 1360  loss:  0.2086  grad_norm:  0.7079  memory: 38.93GiB(81.95%)  tps: 2,039  tflops: 15.53  mfu: 4.98%
[rank3]:2025-10-28 01:16:31,264 - INFO - Avg. fwd time: 72.3128 / Avg. bwd time: 129.9119 / Avg. batch time: 1666.4050 (ms) / GPU bubble ratio: 2.92%
[rank2]:2025-10-28 01:16:31,322 - INFO - Avg. fwd time: 32.5052 / Avg. bwd time: 52.1359 / Avg. batch time: 1754.2266 (ms) / GPU bubble ratio: 61.40%
[rank1]:2025-10-28 01:16:31,395 - INFO - Avg. fwd time: 50.8710 / Avg. bwd time: 70.6632 / Avg. batch time: 1870.6743 (ms) / GPU bubble ratio: 48.03%
[rank0]:2025-10-28 01:16:31,461 - INFO - Avg. fwd time: 45.6326 / Avg. bwd time: 58.5590 / Avg. batch time: 1966.5841 (ms) / GPU bubble ratio: 57.62%
[rank1]:2025-10-28 01:17:49,772 - INFO -  step: 1380  loss: -2.0000  grad_norm:  0.5174  memory: 20.03GiB(42.17%)  tps: 2,039  tflops: 15.53  mfu: 4.98%
[rank3]:2025-10-28 01:17:49,780 - INFO -  step: 1380  loss:  0.2336  grad_norm:  0.5174  memory: 38.93GiB(81.95%)  tps: 2,039  tflops: 15.53  mfu: 4.98%
[rank2]:2025-10-28 01:17:49,767 - INFO -  step: 1380  loss: -2.0000  grad_norm:  0.5174  memory: 16.10GiB(33.90%)  tps: 2,039  tflops: 15.53  mfu: 4.98%
[rank0]:2025-10-28 01:17:49,787 - INFO -  step: 1380  loss: -2.0000  grad_norm:  0.5174  memory: 20.89GiB(43.97%)  tps: 2,039  tflops: 15.53  mfu: 4.98%
[rank0]:2025-10-28 01:19:05,804 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-28 01:19:09,875 - INFO -  step: 1400  loss: -2.0000  grad_norm:  0.7146  memory: 20.89GiB(43.97%)  tps: 2,046  tflops: 15.58  mfu: 4.99%
[rank0]:2025-10-28 01:19:09,875 - INFO - ðŸ”Ž  Running validation at step 1400
[rank1]:2025-10-28 01:19:09,859 - INFO -  step: 1400  loss: -2.0000  grad_norm:  0.7146  memory: 20.03GiB(42.17%)  tps: 2,046  tflops: 15.58  mfu: 4.99%
[rank1]:2025-10-28 01:19:09,860 - INFO - ðŸ”Ž  Running validation at step 1400
[rank3]:2025-10-28 01:19:09,868 - INFO -  step: 1400  loss:  0.2059  grad_norm:  0.7146  memory: 38.93GiB(81.95%)  tps: 2,046  tflops: 15.58  mfu: 4.99%
[rank3]:2025-10-28 01:19:09,869 - INFO - ðŸ”Ž  Running validation at step 1400
[rank2]:2025-10-28 01:19:09,856 - INFO -  step: 1400  loss: -2.0000  grad_norm:  0.7146  memory: 16.10GiB(33.90%)  tps: 2,046  tflops: 15.58  mfu: 4.99%
[rank2]:2025-10-28 01:19:09,856 - INFO - ðŸ”Ž  Running validation at step 1400
[rank0]:2025-10-28 01:20:19,056 - INFO - validate step: 1400  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,921
[rank1]:2025-10-28 01:20:19,134 - INFO - validate step: 1400  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,913
[rank2]:2025-10-28 01:20:19,215 - INFO - validate step: 1400  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,906
[rank3]:2025-10-28 01:20:19,277 - INFO - validate step: 1400  loss:  0.9471  memory: 38.93GiB(81.95%)  tps: 5,901
[rank3]:2025-10-28 01:20:19,490 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251028_0120_real_step1400_rank3.svg
[rank3]:> Batch Time: 1916.88 ms, GPU Bubble Ratio: 56.56%, 49.00%, 65.08%, 15.22%
[rank3]:2025-10-28 01:20:21,195 - INFO - Avg. fwd time: 72.3252 / Avg. bwd time: 129.9271 / Avg. batch time: 1666.5865 (ms) / GPU bubble ratio: 2.91%
[rank2]:2025-10-28 01:20:21,253 - INFO - Avg. fwd time: 32.5096 / Avg. bwd time: 52.1452 / Avg. batch time: 1754.4446 (ms) / GPU bubble ratio: 61.40%
[rank1]:2025-10-28 01:20:21,334 - INFO - Avg. fwd time: 50.8633 / Avg. bwd time: 70.6743 / Avg. batch time: 1870.9099 (ms) / GPU bubble ratio: 48.03%
[rank0]:2025-10-28 01:20:21,399 - INFO - Avg. fwd time: 45.6389 / Avg. bwd time: 58.5542 / Avg. batch time: 1966.8086 (ms) / GPU bubble ratio: 57.62%
[rank1]:2025-10-28 01:21:39,303 - INFO -  step: 1420  loss: -2.0000  grad_norm:  0.5143  memory: 20.03GiB(42.17%)  tps: 2,044  tflops: 15.57  mfu: 4.99%
[rank3]:2025-10-28 01:21:39,311 - INFO -  step: 1420  loss:  0.2283  grad_norm:  0.5143  memory: 38.93GiB(81.95%)  tps: 2,047  tflops: 15.59  mfu: 5.00%
[rank0]:2025-10-28 01:21:39,319 - INFO -  step: 1420  loss: -2.0000  grad_norm:  0.5143  memory: 20.89GiB(43.97%)  tps: 2,041  tflops: 15.55  mfu: 4.98%
[rank2]:2025-10-28 01:21:39,299 - INFO -  step: 1420  loss: -2.0000  grad_norm:  0.5143  memory: 16.10GiB(33.90%)  tps: 2,046  tflops: 15.58  mfu: 4.99%
[rank1]:2025-10-28 01:22:59,197 - INFO -  step: 1440  loss: -2.0000  grad_norm:  0.7561  memory: 20.03GiB(42.17%)  tps: 2,051  tflops: 15.62  mfu: 5.01%
[rank3]:2025-10-28 01:22:59,206 - INFO -  step: 1440  loss:  0.2488  grad_norm:  0.7561  memory: 38.93GiB(81.95%)  tps: 2,051  tflops: 15.62  mfu: 5.01%
[rank0]:2025-10-28 01:22:59,211 - INFO -  step: 1440  loss: -2.0000  grad_norm:  0.7561  memory: 20.89GiB(43.97%)  tps: 2,051  tflops: 15.62  mfu: 5.01%
[rank2]:2025-10-28 01:22:59,193 - INFO -  step: 1440  loss: -2.0000  grad_norm:  0.7561  memory: 16.10GiB(33.90%)  tps: 2,051  tflops: 15.62  mfu: 5.01%
[rank3]:2025-10-28 01:23:01,045 - INFO - Avg. fwd time: 72.3280 / Avg. bwd time: 129.9288 / Avg. batch time: 1666.5999 (ms) / GPU bubble ratio: 2.91%
[rank2]:2025-10-28 01:23:01,104 - INFO - Avg. fwd time: 32.5124 / Avg. bwd time: 52.1439 / Avg. batch time: 1754.4457 (ms) / GPU bubble ratio: 61.40%
[rank1]:2025-10-28 01:23:01,177 - INFO - Avg. fwd time: 50.8642 / Avg. bwd time: 70.6759 / Avg. batch time: 1870.9148 (ms) / GPU bubble ratio: 48.03%
[rank0]:2025-10-28 01:23:01,244 - INFO - Avg. fwd time: 45.6369 / Avg. bwd time: 58.5495 / Avg. batch time: 1966.7909 (ms) / GPU bubble ratio: 57.62%
[rank0]:2025-10-28 01:23:35,251 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-28 01:24:19,133 - INFO -  step: 1460  loss: -2.0000  grad_norm:  0.5576  memory: 20.03GiB(42.17%)  tps: 2,050  tflops: 15.61  mfu: 5.00%
[rank0]:2025-10-28 01:24:19,149 - INFO -  step: 1460  loss: -2.0000  grad_norm:  0.5576  memory: 20.89GiB(43.97%)  tps: 2,050  tflops: 15.61  mfu: 5.00%
[rank2]:2025-10-28 01:24:19,129 - INFO -  step: 1460  loss: -2.0000  grad_norm:  0.5576  memory: 16.10GiB(33.90%)  tps: 2,050  tflops: 15.61  mfu: 5.00%
[rank3]:2025-10-28 01:24:19,142 - INFO -  step: 1460  loss:  0.2471  grad_norm:  0.5576  memory: 38.93GiB(81.95%)  tps: 2,050  tflops: 15.61  mfu: 5.00%
[rank3]:2025-10-28 01:25:39,195 - INFO -  step: 1480  loss:  0.2110  grad_norm:  0.6969  memory: 38.93GiB(81.95%)  tps: 2,047  tflops: 15.59  mfu: 5.00%
[rank1]:2025-10-28 01:25:39,187 - INFO -  step: 1480  loss: -2.0000  grad_norm:  0.6969  memory: 20.03GiB(42.17%)  tps: 2,047  tflops: 15.59  mfu: 5.00%
[rank2]:2025-10-28 01:25:39,183 - INFO -  step: 1480  loss: -2.0000  grad_norm:  0.6969  memory: 16.10GiB(33.90%)  tps: 2,047  tflops: 15.59  mfu: 5.00%
[rank0]:2025-10-28 01:25:39,202 - INFO -  step: 1480  loss: -2.0000  grad_norm:  0.6969  memory: 20.89GiB(43.97%)  tps: 2,047  tflops: 15.59  mfu: 5.00%
[rank3]:2025-10-28 01:25:41,043 - INFO - Avg. fwd time: 72.3293 / Avg. bwd time: 129.9401 / Avg. batch time: 1666.6814 (ms) / GPU bubble ratio: 2.91%
[rank2]:2025-10-28 01:25:41,108 - INFO - Avg. fwd time: 32.5110 / Avg. bwd time: 52.1422 / Avg. batch time: 1754.5085 (ms) / GPU bubble ratio: 61.40%
[rank1]:2025-10-28 01:25:41,181 - INFO - Avg. fwd time: 50.8704 / Avg. bwd time: 70.6740 / Avg. batch time: 1870.9722 (ms) / GPU bubble ratio: 48.03%
[rank0]:2025-10-28 01:25:41,252 - INFO - Avg. fwd time: 45.6391 / Avg. bwd time: 58.5433 / Avg. batch time: 1966.8341 (ms) / GPU bubble ratio: 57.62%
[rank0]:2025-10-28 01:26:55,596 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-28 01:26:59,561 - INFO -  step: 1500  loss: -2.0000  grad_norm:  0.5211  memory: 16.10GiB(33.90%)  tps: 2,038  tflops: 15.52  mfu: 4.98%
[rank2]:2025-10-28 01:26:59,562 - INFO - ðŸ”Ž  Running validation at step 1500
[rank0]:2025-10-28 01:26:59,581 - INFO -  step: 1500  loss: -2.0000  grad_norm:  0.5211  memory: 20.89GiB(43.97%)  tps: 2,038  tflops: 15.52  mfu: 4.98%
[rank0]:2025-10-28 01:26:59,581 - INFO - ðŸ”Ž  Running validation at step 1500
[rank3]:2025-10-28 01:26:59,574 - INFO -  step: 1500  loss:  0.2512  grad_norm:  0.5211  memory: 38.93GiB(81.95%)  tps: 2,038  tflops: 15.52  mfu: 4.98%
[rank3]:2025-10-28 01:26:59,574 - INFO - ðŸ”Ž  Running validation at step 1500
[rank1]:2025-10-28 01:26:59,565 - INFO -  step: 1500  loss: -2.0000  grad_norm:  0.5211  memory: 20.03GiB(42.17%)  tps: 2,038  tflops: 15.52  mfu: 4.98%
[rank1]:2025-10-28 01:26:59,565 - INFO - ðŸ”Ž  Running validation at step 1500
[rank0]:2025-10-28 01:28:09,565 - INFO - validate step: 1500  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,853
[rank0]:2025-10-28 01:28:09,565 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-28 01:28:09,574 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank1]:2025-10-28 01:28:09,648 - INFO - validate step: 1500  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,845
[rank1]:2025-10-28 01:28:09,649 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-28 01:28:09,730 - INFO - validate step: 1500  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,837
[rank2]:2025-10-28 01:28:09,730 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-28 01:28:09,793 - INFO - validate step: 1500  loss:  0.9469  memory: 38.93GiB(81.95%)  tps: 5,833
[rank3]:2025-10-28 01:28:09,795 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-28 01:28:11,591 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 1.86 seconds.
[rank1]:2025-10-28 01:28:11,910 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 2.26 seconds.
[rank3]:2025-10-28 01:28:13,038 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.24 seconds.
[rank0]:2025-10-28 01:28:13,202 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-28 01:28:13,209 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.64 seconds.
[rank0]:2025-10-28 01:28:13,210 - INFO - Checkpointer is deleting /data3/shcho/torchtitan/checkpoint/1028_GPipe_nofreeze_dm1/step-500.
[rank3]:2025-10-28 01:28:13,615 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251028_0128_real_step1500_rank3.svg
[rank3]:> Batch Time: 1916.84 ms, GPU Bubble Ratio: 56.57%, 49.01%, 65.08%, 15.23%
[rank0]:2025-10-28 01:28:15,384 - INFO - Checkpointer deleted /data3/shcho/torchtitan/checkpoint/1028_GPipe_nofreeze_dm1/step-500 in 2.17 seconds.
[rank2]:2025-10-28 01:29:33,942 - INFO -  step: 1520  loss: -2.0000  grad_norm:  0.6953  memory: 16.10GiB(33.90%)  tps: 1,946  tflops: 14.82  mfu: 4.75%
[rank0]:2025-10-28 01:29:33,961 - INFO -  step: 1520  loss: -2.0000  grad_norm:  0.6953  memory: 20.89GiB(43.97%)  tps: 1,941  tflops: 14.79  mfu: 4.74%
[rank3]:2025-10-28 01:29:33,955 - INFO -  step: 1520  loss:  0.2096  grad_norm:  0.6953  memory: 38.93GiB(81.95%)  tps: 1,947  tflops: 14.83  mfu: 4.75%
[rank1]:2025-10-28 01:29:33,946 - INFO -  step: 1520  loss: -2.0000  grad_norm:  0.6953  memory: 20.03GiB(42.17%)  tps: 1,944  tflops: 14.80  mfu: 4.74%
[rank3]:2025-10-28 01:29:35,795 - INFO - Avg. fwd time: 72.3473 / Avg. bwd time: 129.9674 / Avg. batch time: 1666.9963 (ms) / GPU bubble ratio: 2.91%
[rank2]:2025-10-28 01:29:35,854 - INFO - Avg. fwd time: 32.5107 / Avg. bwd time: 52.1436 / Avg. batch time: 1754.8980 (ms) / GPU bubble ratio: 61.41%
[rank1]:2025-10-28 01:29:35,926 - INFO - Avg. fwd time: 50.8749 / Avg. bwd time: 70.6681 / Avg. batch time: 1871.3668 (ms) / GPU bubble ratio: 48.04%
[rank0]:2025-10-28 01:29:35,995 - INFO - Avg. fwd time: 45.6477 / Avg. bwd time: 58.5409 / Avg. batch time: 1967.2155 (ms) / GPU bubble ratio: 57.63%
[rank2]:2025-10-28 01:30:54,161 - INFO -  step: 1540  loss: -2.0000  grad_norm:  0.5126  memory: 16.10GiB(33.90%)  tps: 2,042  tflops: 15.56  mfu: 4.99%
[rank1]:2025-10-28 01:30:54,167 - INFO -  step: 1540  loss: -2.0000  grad_norm:  0.5126  memory: 20.03GiB(42.17%)  tps: 2,042  tflops: 15.56  mfu: 4.99%
[rank0]:2025-10-28 01:30:54,181 - INFO -  step: 1540  loss: -2.0000  grad_norm:  0.5126  memory: 20.89GiB(43.97%)  tps: 2,042  tflops: 15.56  mfu: 4.99%
[rank3]:2025-10-28 01:30:54,174 - INFO -  step: 1540  loss:  0.2319  grad_norm:  0.5126  memory: 38.93GiB(81.95%)  tps: 2,042  tflops: 15.56  mfu: 4.99%
[rank0]:2025-10-28 01:31:30,327 - INFO - [GC] Peforming periodical GC collection 0.25 seconds
[rank2]:2025-10-28 01:32:14,169 - INFO -  step: 1560  loss: -2.0000  grad_norm:  0.7117  memory: 16.10GiB(33.90%)  tps: 2,048  tflops: 15.60  mfu: 5.00%
[rank1]:2025-10-28 01:32:14,182 - INFO -  step: 1560  loss: -2.0000  grad_norm:  0.7117  memory: 20.03GiB(42.17%)  tps: 2,048  tflops: 15.60  mfu: 5.00%
[rank3]:2025-10-28 01:32:14,182 - INFO -  step: 1560  loss:  0.1770  grad_norm:  0.7117  memory: 38.93GiB(81.95%)  tps: 2,048  tflops: 15.60  mfu: 5.00%
[rank0]:2025-10-28 01:32:14,188 - INFO -  step: 1560  loss: -2.0000  grad_norm:  0.7117  memory: 20.89GiB(43.97%)  tps: 2,048  tflops: 15.60  mfu: 5.00%
[rank3]:2025-10-28 01:32:16,011 - INFO - Avg. fwd time: 72.3483 / Avg. bwd time: 129.9769 / Avg. batch time: 1667.0445 (ms) / GPU bubble ratio: 2.91%
[rank2]:2025-10-28 01:32:16,072 - INFO - Avg. fwd time: 32.5151 / Avg. bwd time: 52.1476 / Avg. batch time: 1754.9379 (ms) / GPU bubble ratio: 61.41%
[rank1]:2025-10-28 01:32:16,153 - INFO - Avg. fwd time: 50.8746 / Avg. bwd time: 70.6652 / Avg. batch time: 1871.3806 (ms) / GPU bubble ratio: 48.04%
[rank0]:2025-10-28 01:32:16,221 - INFO - Avg. fwd time: 45.6519 / Avg. bwd time: 58.5411 / Avg. batch time: 1967.2294 (ms) / GPU bubble ratio: 57.63%
[rank2]:2025-10-28 01:33:34,073 - INFO -  step: 1580  loss: -2.0000  grad_norm:  0.5049  memory: 16.10GiB(33.90%)  tps: 2,050  tflops: 15.62  mfu: 5.01%
[rank1]:2025-10-28 01:33:34,077 - INFO -  step: 1580  loss: -2.0000  grad_norm:  0.5049  memory: 20.03GiB(42.17%)  tps: 2,051  tflops: 15.62  mfu: 5.01%
[rank3]:2025-10-28 01:33:34,085 - INFO -  step: 1580  loss:  0.2120  grad_norm:  0.5049  memory: 38.93GiB(81.95%)  tps: 2,051  tflops: 15.62  mfu: 5.01%
[rank0]:2025-10-28 01:33:34,098 - INFO -  step: 1580  loss: -2.0000  grad_norm:  0.5049  memory: 20.89GiB(43.97%)  tps: 2,050  tflops: 15.62  mfu: 5.01%
[rank0]:2025-10-28 01:34:49,992 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-28 01:34:54,053 - INFO -  step: 1600  loss: -2.0000  grad_norm:  0.7294  memory: 20.89GiB(43.97%)  tps: 2,049  tflops: 15.61  mfu: 5.00%
[rank0]:2025-10-28 01:34:54,053 - INFO -  final step: 1600  loss: -2.0000  grad_norm:  0.7294  tps: 2,064  tflops: 15.72  mfu: 4.94%
[rank0]:2025-10-28 01:34:54,054 - INFO - ðŸ”Ž  Running validation at step 1600
[rank2]:2025-10-28 01:34:54,034 - INFO -  step: 1600  loss: -2.0000  grad_norm:  0.7294  memory: 16.10GiB(33.90%)  tps: 2,049  tflops: 15.61  mfu: 5.00%
[rank2]:2025-10-28 01:34:54,034 - INFO -  final step: 1600  loss: -2.0000  grad_norm:  0.7294  tps: 2,066  tflops: 15.73  mfu: 4.94%
[rank2]:2025-10-28 01:34:54,034 - INFO - ðŸ”Ž  Running validation at step 1600
[rank1]:2025-10-28 01:34:54,037 - INFO -  step: 1600  loss: -2.0000  grad_norm:  0.7294  memory: 20.03GiB(42.17%)  tps: 2,049  tflops: 15.61  mfu: 5.00%
[rank1]:2025-10-28 01:34:54,038 - INFO -  final step: 1600  loss: -2.0000  grad_norm:  0.7294  tps: 2,065  tflops: 15.73  mfu: 4.94%
[rank1]:2025-10-28 01:34:54,038 - INFO - ðŸ”Ž  Running validation at step 1600
[rank3]:2025-10-28 01:34:54,046 - INFO -  step: 1600  loss:  0.1761  grad_norm:  0.7294  memory: 38.93GiB(81.95%)  tps: 2,049  tflops: 15.61  mfu: 5.00%
[rank3]:2025-10-28 01:34:54,047 - INFO -  final step: 1600  loss:  0.1761  grad_norm:  0.7294  tps: 2,066  tflops: 15.74  mfu: 4.95%
[rank3]:2025-10-28 01:34:54,047 - INFO - ðŸ”Ž  Running validation at step 1600
[rank0]:2025-10-28 01:36:03,769 - INFO - validate step: 1600  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,875
[rank0]:2025-10-28 01:36:03,769 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-28 01:36:03,772 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1600.
[rank1]:2025-10-28 01:36:03,849 - INFO - validate step: 1600  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,867
[rank1]:2025-10-28 01:36:03,850 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-28 01:36:03,852 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1600.
[rank2]:2025-10-28 01:36:03,933 - INFO - validate step: 1600  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,860
[rank2]:2025-10-28 01:36:03,933 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-28 01:36:03,935 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1600.
[rank3]:2025-10-28 01:36:03,995 - INFO - validate step: 1600  loss:  0.9451  memory: 38.93GiB(81.95%)  tps: 5,856
[rank3]:2025-10-28 01:36:03,996 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-28 01:36:03,998 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1600.
[rank0]:2025-10-28 01:36:06,499 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank0]:2025-10-28 01:36:06,509 - INFO - Sleeping 2 seconds for other ranks to complete
[rank1]:2025-10-28 01:36:06,509 - INFO - Destroying the purge thread.
[rank2]:2025-10-28 01:36:06,509 - INFO - Destroying the purge thread.
[rank3]:2025-10-28 01:36:06,701 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251028_0136_real_final1600_rank3.svg
[rank3]:> Batch Time: 1917.06 ms, GPU Bubble Ratio: 56.58%, 49.05%, 65.08%, 15.22%
[rank3]:2025-10-28 01:36:06,891 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251028_0136_thry_final1600_rank3.svg
[rank3]:> Batch Time: 1670.00 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:2025-10-28 01:36:06,892 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank1]:2025-10-28 01:36:07,627 - INFO - Process group destroyed
[rank2]:2025-10-28 01:36:07,628 - INFO - Process group destroyed
[rank3]:wandb: uploading history steps 80-80, summary, console lines 378-385
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–„â–†â–‡â–ˆâ–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–…â–†â–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–‡â–ˆâ–‚â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 3.96445
[rank3]:wandb:               final/avg_loss 0.17611
[rank3]:wandb:             final/avg_mfu(%) 4.94551
[rank3]:wandb:             final/avg_tflops 15.73786
[rank3]:wandb:    final/avg_throughput(tps) 2066.36229
[rank3]:wandb:              final/grad_norm 0.72937
[rank3]:wandb:               final/max_loss 0.17611
[rank3]:wandb:                    grad_norm 0.72937
[rank3]:wandb: loss_metrics/global_avg_loss 0.17611
[rank3]:wandb: loss_metrics/global_max_loss 0.17611
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1028_GPipe_nofreeze_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/8gb3lxi8
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data3/shcho/torchtitan/tb/1028_GPipe_nofreeze_dm1/20251027-2330/wandb/run-20251027_233023-8gb3lxi8/logs
[rank0]:2025-10-28 01:36:08,509 - INFO - Training completed
[rank0]:2025-10-28 01:36:08,510 - INFO - Destroying the purge thread.
[rank3]:2025-10-28 01:36:08,540 - INFO - Process group destroyed
[rank0]:2025-10-28 01:36:09,467 - INFO - Process group destroyed
[rank1]:Stage 1: Modules to keep: {'layers.4', 'layers.8', 'layers.6', 'layers.5', 'layers.7'}
[rank0]:Stage 0: Modules to keep: {'layers.1', 'layers.0', 'layers.2', 'tok_embeddings', 'layers.3'}
[rank2]:Stage 2: Modules to keep: {'layers.9', 'layers.11', 'layers.12', 'layers.10'}
[rank3]:Stage 3: Modules to keep: {'layers.13', 'norm', 'layers.15', 'layers.14', 'output'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1026_llama1b/config.toml
[rank3]:		- dump_folder: /data3/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1028_GPipe_nofreeze_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data3/shcho/torchtitan/profile_trace/1028_GPipe_nofreeze_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data3/shcho/torchtitan/memory_snapshot/1028_GPipe_nofreeze_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 20
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data3/shcho/torchtitan/tb/1028_GPipe_nofreeze_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data3/shcho/torchtitan/images/1028_GPipe_nofreeze_dm1
[rank3]:		- pplog_freq: 80
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1028_GPipe_nofreeze_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B-Instruct
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 1e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: alpaca
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 512
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 1600
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: GPipe
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 4
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data3/shcho/torchtitan/checkpoint/1028_GPipe_nofreeze_dm1
[rank3]:		- interval: 500
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B-Instruct/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data3/shcho/torchtitan/comm_traces/1028_GPipe_nofreeze_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: True
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 32
[rank3]:		- seq_len: 512
[rank3]:		- freq: 100
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: False
[rank3]:		- metric_type: apf
[rank3]:		- phase_unit: 10
[rank3]:		- stability_check_freq: 5
[rank3]:		- aggressiveness: 0
[rank3]:
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
