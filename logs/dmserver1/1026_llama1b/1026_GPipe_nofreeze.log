
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 10. 27. (ì›”) 01:01:51 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 3,4,5,6
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1026_llama1b/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1026_llama1b/1026_GPipe_nofreeze.log
âœ”ï¸Main Table Experiment, without streaming mode, sample-level with truncation
âœ”ï¸Running with nofreeze x GPipe ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1026_llama1b/config.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation" --parallelism.pipeline_parallel_degree=4  --freezing.no-freeze
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank1]:2025-10-27 01:01:57,097 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation"
[rank0]:2025-10-27 01:01:57,256 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation"
[rank3]:2025-10-27 01:01:57,210 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation"
[rank1]:2025-10-27 01:01:57,270 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-10-27 01:01:57,273 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-10-27 01:01:57,328 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation"
[rank0]:2025-10-27 01:01:57,480 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-10-27 01:01:57,483 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-27 01:01:57,488 - INFO - [GC] Initial GC collection 0.00 seconds
[rank3]:2025-10-27 01:01:57,417 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-10-27 01:01:57,419 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-10-27 01:01:57,540 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-10-27 01:01:57,543 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-27 01:01:57,938 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-10-27 01:01:58,359 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank0]:2025-10-27 01:02:01,135 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank2]:2025-10-27 01:02:01,289 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-10-27 01:02:01,255 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-10-27 01:02:01,292 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-10-27 01:02:01,309 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-10-27 01:02:01,349 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-10-27 01:02:01,351 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-10-27 01:02:01,378 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-10-27 01:02:01,378 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank2]:2025-10-27 01:02:01,330 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-10-27 01:02:01,358 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-10-27 01:02:01,359 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2025-10-27 01:02:01,318 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-10-27 01:02:01,318 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2025-10-27 01:02:01,499 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-10-27 01:02:01,499 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-10-27 01:02:01,499 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank0]:2025-10-27 01:02:01,561 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-10-27 01:02:01,561 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-10-27 01:02:01,562 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank2]:2025-10-27 01:02:01,535 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-10-27 01:02:01,535 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-10-27 01:02:01,536 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run 3gf4m5a2
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data3/shcho/torchtitan/tb/1026_GPipe_nofreeze_dm1/20251027-0102/wandb/run-20251027_010202-3gf4m5a2
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1026_GPipe_nofreeze_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/3gf4m5a2
[rank3]:2025-10-27 01:02:03,926 - INFO - WandB logging enabled
[rank3]:2025-10-27 01:02:04,140 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-10-27 01:02:04,178 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-10-27 01:02:04,208 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-10-27 01:02:04,209 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-10-27 01:02:04,701 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data3/shcho/torchtitan/checkpoint/1026_GPipe_nofreeze_dm1
[rank0]:2025-10-27 01:02:04,701 - WARNING - Mixed precision training with TP or PP is only supported when FSDP/HSDP/CP is enabled.
[rank0]:2025-10-27 01:02:04,701 - INFO - Mixed precision training is disabled
[rank0]:2025-10-27 01:02:04,701 - INFO - Preparing c4_validation dataset from allenai/c4
[rank3]:2025-10-27 01:02:04,691 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-10-27 01:02:04,691 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-10-27 01:02:04,692 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank0]:2025-10-27 01:02:09,818 - INFO - Trainer is initialized with local batch size 16, global batch size 64, gradient accumulation steps 4, sequence length 1024, total steps 1000 (warmup 100)
[rank0]:2025-10-27 01:02:09,818 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B-Instruct/original_dcp.
[rank0]:2025-10-27 01:02:12,549 - INFO - [GC] GC collection for checkpoint loading. 0.01 seconds
[rank0]:2025-10-27 01:02:12,549 - INFO - Finished loading the checkpoint in 2.73 seconds.
[rank0]:2025-10-27 01:02:12,549 - INFO - Training starts at step 1
[rank0]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/autograd/graph.py:849: UserWarning: Attempting to run cuBLAS, but there was no current CUDA context! Attempting to set the primary context... (Triggered internally at /pytorch/aten/src/ATen/cuda/CublasHandlePool.cpp:270.)
[rank0]:  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
[rank0]:2025-10-27 01:02:24,306 - INFO -  step:  1  loss: -4.0000  grad_norm: 43.3594  memory: 17.10GiB(35.99%)  tps: 714  tflops: 5.58  mfu: 1.79%
[rank0]:2025-10-27 01:02:24,306 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-10-27 01:02:24,269 - INFO -  step:  1  loss: -4.0000  grad_norm: 43.3594  memory: 14.29GiB(30.07%)  tps: 714  tflops: 5.58  mfu: 1.79%
[rank2]:2025-10-27 01:02:24,269 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-27 01:02:24,279 - INFO -  step:  1  loss:  1.2134  grad_norm: 43.3594  memory: 35.59GiB(74.92%)  tps: 815  tflops: 6.37  mfu: 2.04%
[rank3]:2025-10-27 01:02:24,279 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-10-27 01:02:24,272 - INFO -  step:  1  loss: -4.0000  grad_norm: 43.3594  memory: 17.77GiB(37.40%)  tps: 713  tflops: 5.57  mfu: 1.79%
[rank1]:2025-10-27 01:02:24,272 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-27 01:02:37,434 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 01:02:37,436 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 01:02:37,436 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 01:02:37,436 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 01:02:37,437 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 01:02:37,437 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 01:02:37,437 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 01:02:37,437 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 01:02:37,438 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 01:02:37,438 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 01:02:37,438 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 01:02:37,438 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 01:02:37,439 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 01:02:37,439 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 01:02:37,439 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 01:02:37,439 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 01:02:37,494 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 01:02:37,495 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 01:02:37,495 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 01:02:37,495 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 01:02:37,495 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 01:02:37,495 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 01:02:37,495 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 01:02:37,495 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 01:02:37,495 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 01:02:37,495 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 01:02:37,495 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 01:02:37,495 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 01:02:37,495 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 01:02:37,495 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 01:02:37,495 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 01:02:37,495 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 01:02:37,633 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 01:02:37,633 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 01:02:37,633 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 01:02:37,633 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 01:02:37,633 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 01:02:37,633 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 01:02:37,633 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 01:02:37,633 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 01:02:37,633 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 01:02:37,634 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 01:02:37,634 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 01:02:37,634 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 01:02:37,634 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 01:02:37,634 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 01:02:37,634 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 01:02:37,634 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 01:02:37,572 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 01:02:37,573 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 01:02:37,573 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 01:02:37,573 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 01:02:37,573 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 01:02:37,573 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 01:02:37,573 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 01:02:37,573 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 01:02:37,573 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 01:02:37,573 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 01:02:37,573 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 01:02:37,573 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 01:02:37,573 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 01:02:37,573 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 01:02:37,573 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 01:02:37,573 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 01:04:54,058 - INFO -  step: 20  loss: -4.0000  grad_norm: 132.7749  memory: 20.89GiB(43.97%)  tps: 2,079  tflops: 16.25  mfu: 5.21%
[rank2]:2025-10-27 01:04:54,041 - INFO -  step: 20  loss: -4.0000  grad_norm: 132.7749  memory: 16.10GiB(33.90%)  tps: 2,078  tflops: 16.25  mfu: 5.21%
[rank3]:2025-10-27 01:04:54,053 - INFO -  step: 20  loss:  3.8421  grad_norm: 132.7749  memory: 38.93GiB(81.95%)  tps: 2,078  tflops: 16.25  mfu: 5.21%
[rank1]:2025-10-27 01:04:54,044 - INFO -  step: 20  loss: -4.0000  grad_norm: 132.7749  memory: 20.03GiB(42.17%)  tps: 2,078  tflops: 16.25  mfu: 5.21%
[rank3]:2025-10-27 01:04:55,825 - INFO - Avg. fwd time: 70.2565 / Avg. bwd time: 126.7560 / Avg. batch time: 1642.3726 (ms) / GPU bubble ratio: 4.04%
[rank2]:2025-10-27 01:04:55,885 - INFO - Avg. fwd time: 32.4476 / Avg. bwd time: 52.7663 / Avg. batch time: 1730.7030 (ms) / GPU bubble ratio: 60.61%
[rank1]:2025-10-27 01:04:55,955 - INFO - Avg. fwd time: 50.1638 / Avg. bwd time: 72.4500 / Avg. batch time: 1849.2796 (ms) / GPU bubble ratio: 46.96%
[rank0]:2025-10-27 01:04:56,021 - INFO - Avg. fwd time: 44.6822 / Avg. bwd time: 59.2131 / Avg. batch time: 1946.8606 (ms) / GPU bubble ratio: 57.31%
[rank1]:2025-10-27 01:07:34,317 - INFO -  step: 40  loss: -4.0000  grad_norm:  0.6224  memory: 20.03GiB(42.17%)  tps: 2,045  tflops: 15.98  mfu: 5.12%
[rank2]:2025-10-27 01:07:34,313 - INFO -  step: 40  loss: -4.0000  grad_norm:  0.6224  memory: 16.10GiB(33.90%)  tps: 2,045  tflops: 15.98  mfu: 5.12%
[rank3]:2025-10-27 01:07:34,325 - INFO -  step: 40  loss:  0.1930  grad_norm:  0.6224  memory: 38.93GiB(81.95%)  tps: 2,045  tflops: 15.98  mfu: 5.12%
[rank0]:2025-10-27 01:07:34,331 - INFO -  step: 40  loss: -4.0000  grad_norm:  0.6224  memory: 20.89GiB(43.97%)  tps: 2,045  tflops: 15.98  mfu: 5.12%
[rank3]:2025-10-27 01:07:36,118 - INFO - Avg. fwd time: 71.2330 / Avg. bwd time: 128.9760 / Avg. batch time: 1658.6632 (ms) / GPU bubble ratio: 3.44%
[rank2]:2025-10-27 01:07:36,174 - INFO - Avg. fwd time: 32.8965 / Avg. bwd time: 53.4195 / Avg. batch time: 1747.6002 (ms) / GPU bubble ratio: 60.49%
[rank1]:2025-10-27 01:07:36,249 - INFO - Avg. fwd time: 51.0247 / Avg. bwd time: 73.3729 / Avg. batch time: 1866.5407 (ms) / GPU bubble ratio: 46.68%
[rank0]:2025-10-27 01:07:36,311 - INFO - Avg. fwd time: 45.4658 / Avg. bwd time: 59.8803 / Avg. batch time: 1964.8312 (ms) / GPU bubble ratio: 57.11%
[rank0]:2025-10-27 01:08:47,207 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-27 01:10:14,730 - INFO -  step: 60  loss: -4.0000  grad_norm:  0.6553  memory: 20.03GiB(42.17%)  tps: 2,043  tflops: 15.97  mfu: 5.12%
[rank2]:2025-10-27 01:10:14,726 - INFO -  step: 60  loss: -4.0000  grad_norm:  0.6553  memory: 16.10GiB(33.90%)  tps: 2,043  tflops: 15.97  mfu: 5.12%
[rank3]:2025-10-27 01:10:14,738 - INFO -  step: 60  loss:  0.1770  grad_norm:  0.6553  memory: 38.93GiB(81.95%)  tps: 2,043  tflops: 15.97  mfu: 5.12%
[rank0]:2025-10-27 01:10:14,745 - INFO -  step: 60  loss: -4.0000  grad_norm:  0.6553  memory: 20.89GiB(43.97%)  tps: 2,043  tflops: 15.97  mfu: 5.12%
[rank3]:2025-10-27 01:10:16,557 - INFO - Avg. fwd time: 71.6284 / Avg. bwd time: 129.7573 / Avg. batch time: 1664.7335 (ms) / GPU bubble ratio: 3.22%
[rank2]:2025-10-27 01:10:16,612 - INFO - Avg. fwd time: 33.1200 / Avg. bwd time: 53.6986 / Avg. batch time: 1753.9565 (ms) / GPU bubble ratio: 60.40%
[rank1]:2025-10-27 01:10:16,694 - INFO - Avg. fwd time: 50.8222 / Avg. bwd time: 73.6521 / Avg. batch time: 1873.0853 (ms) / GPU bubble ratio: 46.84%
[rank0]:2025-10-27 01:10:16,757 - INFO - Avg. fwd time: 45.6000 / Avg. bwd time: 60.1825 / Avg. batch time: 1971.5517 (ms) / GPU bubble ratio: 57.08%
[rank1]:2025-10-27 01:12:55,749 - INFO -  step: 80  loss: -4.0000  grad_norm:  3.1143  memory: 20.03GiB(42.17%)  tps: 2,035  tflops: 15.91  mfu: 5.10%
[rank2]:2025-10-27 01:12:55,745 - INFO -  step: 80  loss: -4.0000  grad_norm:  3.1143  memory: 16.10GiB(33.90%)  tps: 2,035  tflops: 15.91  mfu: 5.10%
[rank0]:2025-10-27 01:12:55,763 - INFO -  step: 80  loss: -4.0000  grad_norm:  3.1143  memory: 20.89GiB(43.97%)  tps: 2,035  tflops: 15.91  mfu: 5.10%
[rank3]:2025-10-27 01:12:55,757 - INFO -  step: 80  loss:  0.1456  grad_norm:  3.1143  memory: 38.93GiB(81.95%)  tps: 2,035  tflops: 15.91  mfu: 5.10%
[rank3]:2025-10-27 01:12:57,600 - INFO - Avg. fwd time: 71.9286 / Avg. bwd time: 130.2577 / Avg. batch time: 1669.6195 (ms) / GPU bubble ratio: 3.12%
[rank2]:2025-10-27 01:12:57,657 - INFO - Avg. fwd time: 33.2652 / Avg. bwd time: 53.8176 / Avg. batch time: 1758.9735 (ms) / GPU bubble ratio: 60.39%
[rank1]:2025-10-27 01:12:57,738 - INFO - Avg. fwd time: 51.1395 / Avg. bwd time: 73.8025 / Avg. batch time: 1878.2662 (ms) / GPU bubble ratio: 46.78%
[rank0]:2025-10-27 01:12:57,799 - INFO - Avg. fwd time: 45.5925 / Avg. bwd time: 60.3243 / Avg. batch time: 1976.8292 (ms) / GPU bubble ratio: 57.14%
[rank0]:2025-10-27 01:15:28,455 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-27 01:15:36,338 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.5486  memory: 16.10GiB(33.90%)  tps: 2,040  tflops: 15.95  mfu: 5.11%
[rank2]:2025-10-27 01:15:36,338 - INFO - ðŸ”Ž  Running validation at step 100
[rank3]:2025-10-27 01:15:36,351 - INFO -  step: 100  loss:  0.1412  grad_norm:  0.5486  memory: 38.93GiB(81.95%)  tps: 2,040  tflops: 15.95  mfu: 5.11%
[rank3]:2025-10-27 01:15:36,351 - INFO - ðŸ”Ž  Running validation at step 100
[rank1]:2025-10-27 01:15:36,344 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.5486  memory: 20.03GiB(42.17%)  tps: 2,040  tflops: 15.95  mfu: 5.11%
[rank1]:2025-10-27 01:15:36,344 - INFO - ðŸ”Ž  Running validation at step 100
[rank0]:2025-10-27 01:15:36,357 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.5486  memory: 20.89GiB(43.97%)  tps: 2,040  tflops: 15.95  mfu: 5.11%
[rank0]:2025-10-27 01:15:36,357 - INFO - ðŸ”Ž  Running validation at step 100
[rank0]:2025-10-27 01:15:59,651 - INFO - validate step: 100  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,275
[rank1]:2025-10-27 01:15:59,732 - INFO - validate step: 100  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,254
[rank2]:2025-10-27 01:15:59,812 - INFO - validate step: 100  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,235
[rank3]:2025-10-27 01:15:59,900 - INFO - validate step: 100  loss:  0.3048  memory: 38.93GiB(81.95%)  tps: 5,218
[rank3]:2025-10-27 01:16:00,119 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1026_GPipe_nofreeze_dm1/pipeline_schedule/251027_0115_real_step100_rank3.svg
[rank3]:> Batch Time: 1932.22 ms, GPU Bubble Ratio: 55.94%, 47.49%, 64.17%, 15.51%
[rank3]:2025-10-27 01:16:01,761 - INFO - Avg. fwd time: 72.0169 / Avg. bwd time: 130.5034 / Avg. batch time: 1671.3205 (ms) / GPU bubble ratio: 3.06%
[rank2]:2025-10-27 01:16:01,822 - INFO - Avg. fwd time: 33.2827 / Avg. bwd time: 53.9236 / Avg. batch time: 1761.0529 (ms) / GPU bubble ratio: 60.38%
[rank1]:2025-10-27 01:16:01,901 - INFO - Avg. fwd time: 51.0627 / Avg. bwd time: 73.8966 / Avg. batch time: 1880.2509 (ms) / GPU bubble ratio: 46.83%
[rank0]:2025-10-27 01:16:01,963 - INFO - Avg. fwd time: 45.5587 / Avg. bwd time: 60.3870 / Avg. batch time: 1978.9017 (ms) / GPU bubble ratio: 57.17%
[rank3]:2025-10-27 01:18:39,873 - INFO -  step: 120  loss:  0.1290  grad_norm:  0.3635  memory: 38.93GiB(81.95%)  tps: 2,048  tflops: 16.01  mfu: 5.13%
[rank2]:2025-10-27 01:18:39,861 - INFO -  step: 120  loss: -4.0000  grad_norm:  0.3635  memory: 16.10GiB(33.90%)  tps: 2,047  tflops: 16.01  mfu: 5.13%
[rank1]:2025-10-27 01:18:39,865 - INFO -  step: 120  loss: -4.0000  grad_norm:  0.3635  memory: 20.03GiB(42.17%)  tps: 2,046  tflops: 16.00  mfu: 5.13%
[rank0]:2025-10-27 01:18:39,880 - INFO -  step: 120  loss: -4.0000  grad_norm:  0.3635  memory: 20.89GiB(43.97%)  tps: 2,045  tflops: 15.99  mfu: 5.12%
[rank3]:2025-10-27 01:18:41,681 - INFO - Avg. fwd time: 72.0628 / Avg. bwd time: 130.5709 / Avg. batch time: 1671.3974 (ms) / GPU bubble ratio: 3.01%
[rank2]:2025-10-27 01:18:41,740 - INFO - Avg. fwd time: 33.2821 / Avg. bwd time: 53.9807 / Avg. batch time: 1761.0790 (ms) / GPU bubble ratio: 60.36%
[rank1]:2025-10-27 01:18:41,819 - INFO - Avg. fwd time: 51.0792 / Avg. bwd time: 73.9790 / Avg. batch time: 1880.2876 (ms) / GPU bubble ratio: 46.79%
[rank0]:2025-10-27 01:18:41,880 - INFO - Avg. fwd time: 45.5456 / Avg. bwd time: 60.4229 / Avg. batch time: 1978.7889 (ms) / GPU bubble ratio: 57.16%
[rank0]:2025-10-27 01:21:20,643 - INFO -  step: 140  loss: -4.0000  grad_norm:  0.2614  memory: 20.89GiB(43.97%)  tps: 2,038  tflops: 15.93  mfu: 5.11%
[rank3]:2025-10-27 01:21:20,635 - INFO -  step: 140  loss:  0.1357  grad_norm:  0.2614  memory: 38.93GiB(81.95%)  tps: 2,038  tflops: 15.93  mfu: 5.11%
[rank2]:2025-10-27 01:21:20,623 - INFO -  step: 140  loss: -4.0000  grad_norm:  0.2614  memory: 16.10GiB(33.90%)  tps: 2,038  tflops: 15.93  mfu: 5.11%
[rank1]:2025-10-27 01:21:20,627 - INFO -  step: 140  loss: -4.0000  grad_norm:  0.2614  memory: 20.03GiB(42.17%)  tps: 2,038  tflops: 15.93  mfu: 5.11%
[rank3]:2025-10-27 01:21:22,451 - INFO - Avg. fwd time: 72.1245 / Avg. bwd time: 130.7328 / Avg. batch time: 1672.6681 (ms) / GPU bubble ratio: 2.98%
[rank2]:2025-10-27 01:21:22,507 - INFO - Avg. fwd time: 33.3320 / Avg. bwd time: 54.0629 / Avg. batch time: 1762.3844 (ms) / GPU bubble ratio: 60.33%
[rank1]:2025-10-27 01:21:22,583 - INFO - Avg. fwd time: 50.9986 / Avg. bwd time: 74.0776 / Avg. batch time: 1881.6534 (ms) / GPU bubble ratio: 46.82%
[rank0]:2025-10-27 01:21:22,646 - INFO - Avg. fwd time: 45.5394 / Avg. bwd time: 60.4891 / Avg. batch time: 1980.2367 (ms) / GPU bubble ratio: 57.17%
[rank0]:2025-10-27 01:22:32,588 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-27 01:24:00,722 - INFO -  step: 160  loss: -4.0000  grad_norm:  0.4079  memory: 20.03GiB(42.17%)  tps: 2,047  tflops: 16.00  mfu: 5.13%
[rank0]:2025-10-27 01:24:00,736 - INFO -  step: 160  loss: -4.0000  grad_norm:  0.4079  memory: 20.89GiB(43.97%)  tps: 2,047  tflops: 16.00  mfu: 5.13%
[rank3]:2025-10-27 01:24:00,731 - INFO -  step: 160  loss:  0.1088  grad_norm:  0.4079  memory: 38.93GiB(81.95%)  tps: 2,047  tflops: 16.00  mfu: 5.13%
[rank2]:2025-10-27 01:24:00,718 - INFO -  step: 160  loss: -4.0000  grad_norm:  0.4079  memory: 16.10GiB(33.90%)  tps: 2,047  tflops: 16.00  mfu: 5.13%
[rank3]:2025-10-27 01:24:02,556 - INFO - Avg. fwd time: 72.1561 / Avg. bwd time: 130.7620 / Avg. batch time: 1672.7004 (ms) / GPU bubble ratio: 2.95%
[rank2]:2025-10-27 01:24:02,614 - INFO - Avg. fwd time: 33.3312 / Avg. bwd time: 54.0708 / Avg. batch time: 1762.4145 (ms) / GPU bubble ratio: 60.33%
[rank1]:2025-10-27 01:24:02,689 - INFO - Avg. fwd time: 51.0785 / Avg. bwd time: 74.0994 / Avg. batch time: 1881.6820 (ms) / GPU bubble ratio: 46.78%
[rank0]:2025-10-27 01:24:02,755 - INFO - Avg. fwd time: 45.6110 / Avg. bwd time: 60.4862 / Avg. batch time: 1980.2877 (ms) / GPU bubble ratio: 57.14%
[rank0]:2025-10-27 01:26:40,983 - INFO -  step: 180  loss: -4.0000  grad_norm:  0.1957  memory: 20.89GiB(43.97%)  tps: 2,045  tflops: 15.99  mfu: 5.12%
[rank3]:2025-10-27 01:26:40,976 - INFO -  step: 180  loss:  0.1328  grad_norm:  0.1957  memory: 38.93GiB(81.95%)  tps: 2,045  tflops: 15.99  mfu: 5.12%
[rank2]:2025-10-27 01:26:40,963 - INFO -  step: 180  loss: -4.0000  grad_norm:  0.1957  memory: 16.10GiB(33.90%)  tps: 2,045  tflops: 15.99  mfu: 5.12%
[rank1]:2025-10-27 01:26:40,967 - INFO -  step: 180  loss: -4.0000  grad_norm:  0.1957  memory: 20.03GiB(42.17%)  tps: 2,045  tflops: 15.99  mfu: 5.12%
[rank3]:2025-10-27 01:26:42,791 - INFO - Avg. fwd time: 72.1574 / Avg. bwd time: 130.8146 / Avg. batch time: 1672.8093 (ms) / GPU bubble ratio: 2.93%
[rank2]:2025-10-27 01:26:42,852 - INFO - Avg. fwd time: 33.3419 / Avg. bwd time: 54.0962 / Avg. batch time: 1762.5337 (ms) / GPU bubble ratio: 60.31%
[rank1]:2025-10-27 01:26:42,930 - INFO - Avg. fwd time: 51.0609 / Avg. bwd time: 74.1439 / Avg. batch time: 1881.8408 (ms) / GPU bubble ratio: 46.77%
[rank0]:2025-10-27 01:26:42,997 - INFO - Avg. fwd time: 45.6046 / Avg. bwd time: 60.5075 / Avg. batch time: 1980.4834 (ms) / GPU bubble ratio: 57.14%
[rank0]:2025-10-27 01:29:13,302 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-27 01:29:21,301 - INFO -  step: 200  loss:  0.1403  grad_norm:  0.3285  memory: 38.93GiB(81.95%)  tps: 2,044  tflops: 15.98  mfu: 5.12%
[rank3]:2025-10-27 01:29:21,302 - INFO - ðŸ”Ž  Running validation at step 200
[rank2]:2025-10-27 01:29:21,289 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.3285  memory: 16.10GiB(33.90%)  tps: 2,044  tflops: 15.98  mfu: 5.12%
[rank2]:2025-10-27 01:29:21,289 - INFO - ðŸ”Ž  Running validation at step 200
[rank1]:2025-10-27 01:29:21,293 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.3285  memory: 20.03GiB(42.17%)  tps: 2,044  tflops: 15.98  mfu: 5.12%
[rank1]:2025-10-27 01:29:21,293 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-10-27 01:29:21,309 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.3285  memory: 20.89GiB(43.97%)  tps: 2,044  tflops: 15.98  mfu: 5.12%
[rank0]:2025-10-27 01:29:21,309 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-10-27 01:29:42,334 - INFO - validate step: 200  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,845
[rank1]:2025-10-27 01:29:42,415 - INFO - validate step: 200  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,818
[rank2]:2025-10-27 01:29:42,498 - INFO - validate step: 200  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,794
[rank3]:2025-10-27 01:29:42,584 - INFO - validate step: 200  loss:  0.3051  memory: 38.93GiB(81.95%)  tps: 5,774
[rank3]:2025-10-27 01:29:42,786 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1026_GPipe_nofreeze_dm1/pipeline_schedule/251027_0129_real_step200_rank3.svg
[rank3]:> Batch Time: 1930.91 ms, GPU Bubble Ratio: 55.90%, 47.50%, 64.05%, 15.42%
[rank3]:2025-10-27 01:29:44,454 - INFO - Avg. fwd time: 72.1805 / Avg. bwd time: 130.8652 / Avg. batch time: 1673.0925 (ms) / GPU bubble ratio: 2.91%
[rank2]:2025-10-27 01:29:44,515 - INFO - Avg. fwd time: 33.3431 / Avg. bwd time: 54.1242 / Avg. batch time: 1762.9312 (ms) / GPU bubble ratio: 60.31%
[rank1]:2025-10-27 01:29:44,600 - INFO - Avg. fwd time: 50.9896 / Avg. bwd time: 74.1702 / Avg. batch time: 1882.2729 (ms) / GPU bubble ratio: 46.80%
[rank0]:2025-10-27 01:29:44,669 - INFO - Avg. fwd time: 45.6346 / Avg. bwd time: 60.5258 / Avg. batch time: 1980.8545 (ms) / GPU bubble ratio: 57.13%
[rank2]:2025-10-27 01:32:23,247 - INFO -  step: 220  loss: -4.0000  grad_norm:  0.4163  memory: 16.10GiB(33.90%)  tps: 2,038  tflops: 15.94  mfu: 5.11%
[rank1]:2025-10-27 01:32:23,252 - INFO -  step: 220  loss: -4.0000  grad_norm:  0.4163  memory: 20.03GiB(42.17%)  tps: 2,037  tflops: 15.93  mfu: 5.10%
[rank0]:2025-10-27 01:32:23,262 - INFO -  step: 220  loss: -4.0000  grad_norm:  0.4163  memory: 20.89GiB(43.97%)  tps: 2,036  tflops: 15.92  mfu: 5.10%
[rank3]:2025-10-27 01:32:23,260 - INFO -  step: 220  loss:  0.1514  grad_norm:  0.4163  memory: 38.93GiB(81.95%)  tps: 2,039  tflops: 15.94  mfu: 5.11%
[rank3]:2025-10-27 01:32:25,077 - INFO - Avg. fwd time: 72.2278 / Avg. bwd time: 130.9241 / Avg. batch time: 1673.6687 (ms) / GPU bubble ratio: 2.90%
[rank2]:2025-10-27 01:32:25,134 - INFO - Avg. fwd time: 33.3476 / Avg. bwd time: 54.1369 / Avg. batch time: 1763.4813 (ms) / GPU bubble ratio: 60.31%
[rank1]:2025-10-27 01:32:25,205 - INFO - Avg. fwd time: 50.9853 / Avg. bwd time: 74.1923 / Avg. batch time: 1882.8238 (ms) / GPU bubble ratio: 46.81%
[rank0]:2025-10-27 01:32:25,267 - INFO - Avg. fwd time: 45.6138 / Avg. bwd time: 60.5448 / Avg. batch time: 1981.4083 (ms) / GPU bubble ratio: 57.14%
[rank1]:2025-10-27 01:35:03,414 - INFO -  step: 240  loss: -4.0000  grad_norm:  0.3034  memory: 20.03GiB(42.17%)  tps: 2,046  tflops: 15.99  mfu: 5.13%
[rank2]:2025-10-27 01:35:03,410 - INFO -  step: 240  loss: -4.0000  grad_norm:  0.3034  memory: 16.10GiB(33.90%)  tps: 2,046  tflops: 15.99  mfu: 5.13%
[rank3]:2025-10-27 01:35:03,423 - INFO -  step: 240  loss:  0.1665  grad_norm:  0.3034  memory: 38.93GiB(81.95%)  tps: 2,046  tflops: 15.99  mfu: 5.13%
[rank0]:2025-10-27 01:35:03,430 - INFO -  step: 240  loss: -4.0000  grad_norm:  0.3034  memory: 20.89GiB(43.97%)  tps: 2,046  tflops: 15.99  mfu: 5.13%
[rank3]:2025-10-27 01:35:05,264 - INFO - Avg. fwd time: 72.2192 / Avg. bwd time: 130.9406 / Avg. batch time: 1673.6746 (ms) / GPU bubble ratio: 2.89%
[rank2]:2025-10-27 01:35:05,325 - INFO - Avg. fwd time: 33.3645 / Avg. bwd time: 54.1484 / Avg. batch time: 1763.4701 (ms) / GPU bubble ratio: 60.30%
[rank1]:2025-10-27 01:35:05,408 - INFO - Avg. fwd time: 50.9953 / Avg. bwd time: 74.2285 / Avg. batch time: 1882.8096 (ms) / GPU bubble ratio: 46.79%
[rank0]:2025-10-27 01:35:05,473 - INFO - Avg. fwd time: 45.5926 / Avg. bwd time: 60.5595 / Avg. batch time: 1981.4143 (ms) / GPU bubble ratio: 57.14%
[rank0]:2025-10-27 01:36:14,844 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-27 01:37:42,966 - INFO -  step: 260  loss: -4.0000  grad_norm:  0.2186  memory: 16.10GiB(33.90%)  tps: 2,054  tflops: 16.05  mfu: 5.15%
[rank0]:2025-10-27 01:37:42,983 - INFO -  step: 260  loss: -4.0000  grad_norm:  0.2186  memory: 20.89GiB(43.97%)  tps: 2,054  tflops: 16.06  mfu: 5.15%
[rank1]:2025-10-27 01:37:42,977 - INFO -  step: 260  loss: -4.0000  grad_norm:  0.2186  memory: 20.03GiB(42.17%)  tps: 2,054  tflops: 16.05  mfu: 5.15%
[rank3]:2025-10-27 01:37:42,979 - INFO -  step: 260  loss:  0.1380  grad_norm:  0.2186  memory: 38.93GiB(81.95%)  tps: 2,054  tflops: 16.06  mfu: 5.15%
[rank3]:2025-10-27 01:37:44,773 - INFO - Avg. fwd time: 72.1666 / Avg. bwd time: 130.9291 / Avg. batch time: 1673.0948 (ms) / GPU bubble ratio: 2.89%
[rank2]:2025-10-27 01:37:44,832 - INFO - Avg. fwd time: 33.3572 / Avg. bwd time: 54.1551 / Avg. batch time: 1762.8466 (ms) / GPU bubble ratio: 60.29%
[rank1]:2025-10-27 01:37:44,908 - INFO - Avg. fwd time: 51.0354 / Avg. bwd time: 74.2563 / Avg. batch time: 1882.2118 (ms) / GPU bubble ratio: 46.75%
[rank0]:2025-10-27 01:37:44,970 - INFO - Avg. fwd time: 45.5378 / Avg. bwd time: 60.5467 / Avg. batch time: 1980.7960 (ms) / GPU bubble ratio: 57.15%
[rank2]:2025-10-27 01:40:22,662 - INFO -  step: 280  loss: -4.0000  grad_norm:  0.2414  memory: 16.10GiB(33.90%)  tps: 2,052  tflops: 16.04  mfu: 5.14%
[rank3]:2025-10-27 01:40:22,674 - INFO -  step: 280  loss:  0.1649  grad_norm:  0.2414  memory: 38.93GiB(81.95%)  tps: 2,052  tflops: 16.04  mfu: 5.14%
[rank1]:2025-10-27 01:40:22,666 - INFO -  step: 280  loss: -4.0000  grad_norm:  0.2414  memory: 20.03GiB(42.17%)  tps: 2,052  tflops: 16.04  mfu: 5.14%
[rank0]:2025-10-27 01:40:22,680 - INFO -  step: 280  loss: -4.0000  grad_norm:  0.2414  memory: 20.89GiB(43.97%)  tps: 2,052  tflops: 16.04  mfu: 5.14%
[rank3]:2025-10-27 01:40:24,479 - INFO - Avg. fwd time: 72.1661 / Avg. bwd time: 130.9154 / Avg. batch time: 1672.7855 (ms) / GPU bubble ratio: 2.88%
[rank2]:2025-10-27 01:40:24,540 - INFO - Avg. fwd time: 33.3619 / Avg. bwd time: 54.1549 / Avg. batch time: 1762.4975 (ms) / GPU bubble ratio: 60.28%
[rank1]:2025-10-27 01:40:24,620 - INFO - Avg. fwd time: 50.9461 / Avg. bwd time: 74.2533 / Avg. batch time: 1881.9027 (ms) / GPU bubble ratio: 46.78%
[rank0]:2025-10-27 01:40:24,682 - INFO - Avg. fwd time: 45.4948 / Avg. bwd time: 60.5537 / Avg. batch time: 1980.4242 (ms) / GPU bubble ratio: 57.16%
[rank0]:2025-10-27 01:42:54,316 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-27 01:43:02,360 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.1822  memory: 16.10GiB(33.90%)  tps: 2,052  tflops: 16.04  mfu: 5.14%
[rank2]:2025-10-27 01:43:02,360 - INFO - ðŸ”Ž  Running validation at step 300
[rank3]:2025-10-27 01:43:02,372 - INFO -  step: 300  loss:  0.1171  grad_norm:  0.1822  memory: 38.93GiB(81.95%)  tps: 2,052  tflops: 16.04  mfu: 5.14%
[rank3]:2025-10-27 01:43:02,373 - INFO - ðŸ”Ž  Running validation at step 300
[rank1]:2025-10-27 01:43:02,364 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.1822  memory: 20.03GiB(42.17%)  tps: 2,052  tflops: 16.04  mfu: 5.14%
[rank1]:2025-10-27 01:43:02,364 - INFO - ðŸ”Ž  Running validation at step 300
[rank0]:2025-10-27 01:43:02,374 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.1822  memory: 20.89GiB(43.97%)  tps: 2,052  tflops: 16.04  mfu: 5.14%
[rank0]:2025-10-27 01:43:02,374 - INFO - ðŸ”Ž  Running validation at step 300
[rank0]:2025-10-27 01:43:23,396 - INFO - validate step: 300  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,845
[rank1]:2025-10-27 01:43:23,476 - INFO - validate step: 300  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,820
[rank2]:2025-10-27 01:43:23,557 - INFO - validate step: 300  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,797
[rank3]:2025-10-27 01:43:23,646 - INFO - validate step: 300  loss:  0.3147  memory: 38.93GiB(81.95%)  tps: 5,777
[rank3]:2025-10-27 01:43:23,852 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1026_GPipe_nofreeze_dm1/pipeline_schedule/251027_0143_real_step300_rank3.svg
[rank3]:> Batch Time: 1928.28 ms, GPU Bubble Ratio: 55.89%, 47.44%, 64.00%, 15.37%
[rank3]:2025-10-27 01:43:25,539 - INFO - Avg. fwd time: 72.1725 / Avg. bwd time: 130.9031 / Avg. batch time: 1672.5520 (ms) / GPU bubble ratio: 2.87%
[rank1]:2025-10-27 01:43:25,674 - INFO - Avg. fwd time: 50.8619 / Avg. bwd time: 74.2394 / Avg. batch time: 1881.6768 (ms) / GPU bubble ratio: 46.81%
[rank2]:2025-10-27 01:43:25,603 - INFO - Avg. fwd time: 33.3766 / Avg. bwd time: 54.1596 / Avg. batch time: 1762.3235 (ms) / GPU bubble ratio: 60.26%
[rank0]:2025-10-27 01:43:25,740 - INFO - Avg. fwd time: 45.4528 / Avg. bwd time: 60.5496 / Avg. batch time: 1980.1599 (ms) / GPU bubble ratio: 57.17%
[rank1]:2025-10-27 01:46:04,556 - INFO -  step: 320  loss: -4.0000  grad_norm:  0.3147  memory: 20.03GiB(42.17%)  tps: 2,034  tflops: 15.90  mfu: 5.10%
[rank0]:2025-10-27 01:46:04,569 - INFO -  step: 320  loss: -4.0000  grad_norm:  0.3147  memory: 20.89GiB(43.97%)  tps: 2,033  tflops: 15.89  mfu: 5.09%
[rank2]:2025-10-27 01:46:04,545 - INFO -  step: 320  loss: -4.0000  grad_norm:  0.3147  memory: 16.10GiB(33.90%)  tps: 2,035  tflops: 15.91  mfu: 5.10%
[rank3]:2025-10-27 01:46:04,557 - INFO -  step: 320  loss:  0.1543  grad_norm:  0.3147  memory: 38.93GiB(81.95%)  tps: 2,036  tflops: 15.92  mfu: 5.10%
[rank3]:2025-10-27 01:46:06,419 - INFO - Avg. fwd time: 72.2095 / Avg. bwd time: 130.9541 / Avg. batch time: 1673.1576 (ms) / GPU bubble ratio: 2.86%
[rank2]:2025-10-27 01:46:06,480 - INFO - Avg. fwd time: 33.4123 / Avg. bwd time: 54.1765 / Avg. batch time: 1762.9334 (ms) / GPU bubble ratio: 60.25%
[rank1]:2025-10-27 01:46:06,571 - INFO - Avg. fwd time: 50.8396 / Avg. bwd time: 74.2495 / Avg. batch time: 1882.2569 (ms) / GPU bubble ratio: 46.83%
[rank0]:2025-10-27 01:46:06,635 - INFO - Avg. fwd time: 45.4142 / Avg. bwd time: 60.5654 / Avg. batch time: 1980.7863 (ms) / GPU bubble ratio: 57.20%
[rank2]:2025-10-27 01:48:44,310 - INFO -  step: 340  loss: -4.0000  grad_norm:  0.1931  memory: 16.10GiB(33.90%)  tps: 2,051  tflops: 16.03  mfu: 5.14%
[rank3]:2025-10-27 01:48:44,323 - INFO -  step: 340  loss:  0.1598  grad_norm:  0.1931  memory: 38.93GiB(81.95%)  tps: 2,051  tflops: 16.03  mfu: 5.14%
[rank1]:2025-10-27 01:48:44,314 - INFO -  step: 340  loss: -4.0000  grad_norm:  0.1931  memory: 20.03GiB(42.17%)  tps: 2,051  tflops: 16.03  mfu: 5.14%
[rank0]:2025-10-27 01:48:44,332 - INFO -  step: 340  loss: -4.0000  grad_norm:  0.1931  memory: 20.89GiB(43.97%)  tps: 2,051  tflops: 16.03  mfu: 5.14%
[rank3]:2025-10-27 01:48:46,094 - INFO - Avg. fwd time: 72.1928 / Avg. bwd time: 130.9503 / Avg. batch time: 1672.8812 (ms) / GPU bubble ratio: 2.85%
[rank2]:2025-10-27 01:48:46,155 - INFO - Avg. fwd time: 33.4232 / Avg. bwd time: 54.1823 / Avg. batch time: 1762.6382 (ms) / GPU bubble ratio: 60.24%
[rank1]:2025-10-27 01:48:46,234 - INFO - Avg. fwd time: 50.7384 / Avg. bwd time: 74.2459 / Avg. batch time: 1881.9282 (ms) / GPU bubble ratio: 46.87%
[rank0]:2025-10-27 01:48:46,301 - INFO - Avg. fwd time: 45.3881 / Avg. bwd time: 60.5712 / Avg. batch time: 1980.4522 (ms) / GPU bubble ratio: 57.20%
[rank0]:2025-10-27 01:49:55,902 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-27 01:51:23,612 - INFO -  step: 360  loss: -4.0000  grad_norm:  0.2889  memory: 20.89GiB(43.97%)  tps: 2,057  tflops: 16.08  mfu: 5.15%
[rank2]:2025-10-27 01:51:23,592 - INFO -  step: 360  loss: -4.0000  grad_norm:  0.2889  memory: 16.10GiB(33.90%)  tps: 2,057  tflops: 16.08  mfu: 5.15%
[rank3]:2025-10-27 01:51:23,605 - INFO -  step: 360  loss:  0.1182  grad_norm:  0.2889  memory: 38.93GiB(81.95%)  tps: 2,057  tflops: 16.08  mfu: 5.15%
[rank1]:2025-10-27 01:51:23,596 - INFO -  step: 360  loss: -4.0000  grad_norm:  0.2889  memory: 20.03GiB(42.17%)  tps: 2,057  tflops: 16.08  mfu: 5.15%
[rank3]:2025-10-27 01:51:25,411 - INFO - Avg. fwd time: 72.1563 / Avg. bwd time: 130.9329 / Avg. batch time: 1672.4031 (ms) / GPU bubble ratio: 2.85%
[rank2]:2025-10-27 01:51:25,470 - INFO - Avg. fwd time: 33.4229 / Avg. bwd time: 54.1758 / Avg. batch time: 1762.1240 (ms) / GPU bubble ratio: 60.23%
[rank1]:2025-10-27 01:51:25,553 - INFO - Avg. fwd time: 50.7694 / Avg. bwd time: 74.2334 / Avg. batch time: 1881.4230 (ms) / GPU bubble ratio: 46.85%
[rank0]:2025-10-27 01:51:25,620 - INFO - Avg. fwd time: 45.3595 / Avg. bwd time: 60.5732 / Avg. batch time: 1979.9144 (ms) / GPU bubble ratio: 57.20%
[rank1]:2025-10-27 01:54:03,960 - INFO -  step: 380  loss: -4.0000  grad_norm:  0.2636  memory: 20.03GiB(42.17%)  tps: 2,043  tflops: 15.97  mfu: 5.12%
[rank2]:2025-10-27 01:54:03,956 - INFO -  step: 380  loss: -4.0000  grad_norm:  0.2636  memory: 16.10GiB(33.90%)  tps: 2,043  tflops: 15.97  mfu: 5.12%
[rank3]:2025-10-27 01:54:03,971 - INFO -  step: 380  loss:  0.1209  grad_norm:  0.2636  memory: 38.93GiB(81.95%)  tps: 2,043  tflops: 15.97  mfu: 5.12%
[rank0]:2025-10-27 01:54:03,979 - INFO -  step: 380  loss: -4.0000  grad_norm:  0.2636  memory: 20.89GiB(43.97%)  tps: 2,043  tflops: 15.97  mfu: 5.12%
[rank3]:2025-10-27 01:54:05,777 - INFO - Avg. fwd time: 72.1698 / Avg. bwd time: 130.9570 / Avg. batch time: 1672.6267 (ms) / GPU bubble ratio: 2.85%
[rank2]:2025-10-27 01:54:05,834 - INFO - Avg. fwd time: 33.4235 / Avg. bwd time: 54.1749 / Avg. batch time: 1762.3227 (ms) / GPU bubble ratio: 60.23%
[rank1]:2025-10-27 01:54:05,906 - INFO - Avg. fwd time: 50.7194 / Avg. bwd time: 74.2257 / Avg. batch time: 1881.5938 (ms) / GPU bubble ratio: 46.88%
[rank0]:2025-10-27 01:54:05,971 - INFO - Avg. fwd time: 45.3542 / Avg. bwd time: 60.5806 / Avg. batch time: 1980.1012 (ms) / GPU bubble ratio: 57.20%
[rank0]:2025-10-27 01:56:36,000 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-27 01:56:44,066 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.2621  memory: 20.03GiB(42.17%)  tps: 2,047  tflops: 16.00  mfu: 5.13%
[rank1]:2025-10-27 01:56:44,066 - INFO - ðŸ”Ž  Running validation at step 400
[rank2]:2025-10-27 01:56:44,061 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.2621  memory: 16.10GiB(33.90%)  tps: 2,047  tflops: 16.00  mfu: 5.13%
[rank2]:2025-10-27 01:56:44,061 - INFO - ðŸ”Ž  Running validation at step 400
[rank3]:2025-10-27 01:56:44,074 - INFO -  step: 400  loss:  0.1102  grad_norm:  0.2621  memory: 38.93GiB(81.95%)  tps: 2,047  tflops: 16.00  mfu: 5.13%
[rank3]:2025-10-27 01:56:44,074 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-10-27 01:56:44,079 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.2621  memory: 20.89GiB(43.97%)  tps: 2,047  tflops: 16.00  mfu: 5.13%
[rank0]:2025-10-27 01:56:44,079 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-10-27 01:57:04,945 - INFO - validate step: 400  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,889
[rank1]:2025-10-27 01:57:05,027 - INFO - validate step: 400  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,862
[rank2]:2025-10-27 01:57:05,106 - INFO - validate step: 400  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,839
[rank3]:2025-10-27 01:57:05,195 - INFO - validate step: 400  loss:  0.3040  memory: 38.93GiB(81.95%)  tps: 5,818
[rank3]:2025-10-27 01:57:05,398 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1026_GPipe_nofreeze_dm1/pipeline_schedule/251027_0157_real_step400_rank3.svg
[rank3]:> Batch Time: 1928.08 ms, GPU Bubble Ratio: 55.89%, 47.53%, 63.99%, 15.33%
[rank3]:2025-10-27 01:57:07,125 - INFO - Avg. fwd time: 72.1781 / Avg. bwd time: 130.9615 / Avg. batch time: 1672.6836 (ms) / GPU bubble ratio: 2.84%
[rank2]:2025-10-27 01:57:07,184 - INFO - Avg. fwd time: 33.4223 / Avg. bwd time: 54.1820 / Avg. batch time: 1762.4352 (ms) / GPU bubble ratio: 60.23%
[rank1]:2025-10-27 01:57:07,267 - INFO - Avg. fwd time: 50.6885 / Avg. bwd time: 74.2007 / Avg. batch time: 1881.6654 (ms) / GPU bubble ratio: 46.90%
[rank0]:2025-10-27 01:57:07,330 - INFO - Avg. fwd time: 45.3640 / Avg. bwd time: 60.5912 / Avg. batch time: 1980.1604 (ms) / GPU bubble ratio: 57.19%
[rank3]:2025-10-27 01:59:45,279 - INFO -  step: 420  loss:  0.1380  grad_norm:  0.5280  memory: 38.93GiB(81.95%)  tps: 2,047  tflops: 16.00  mfu: 5.13%
[rank1]:2025-10-27 01:59:45,270 - INFO -  step: 420  loss: -4.0000  grad_norm:  0.5280  memory: 20.03GiB(42.17%)  tps: 2,045  tflops: 15.99  mfu: 5.12%
[rank2]:2025-10-27 01:59:45,266 - INFO -  step: 420  loss: -4.0000  grad_norm:  0.5280  memory: 16.10GiB(33.90%)  tps: 2,046  tflops: 15.99  mfu: 5.13%
[rank0]:2025-10-27 01:59:45,283 - INFO -  step: 420  loss: -4.0000  grad_norm:  0.5280  memory: 20.89GiB(43.97%)  tps: 2,044  tflops: 15.98  mfu: 5.12%
[rank3]:2025-10-27 01:59:47,059 - INFO - Avg. fwd time: 72.1795 / Avg. bwd time: 130.9559 / Avg. batch time: 1672.5916 (ms) / GPU bubble ratio: 2.84%
[rank2]:2025-10-27 01:59:47,117 - INFO - Avg. fwd time: 33.4112 / Avg. bwd time: 54.1873 / Avg. batch time: 1762.3443 (ms) / GPU bubble ratio: 60.24%
[rank1]:2025-10-27 01:59:47,188 - INFO - Avg. fwd time: 50.6527 / Avg. bwd time: 74.2005 / Avg. batch time: 1881.5185 (ms) / GPU bubble ratio: 46.91%
[rank0]:2025-10-27 01:59:47,255 - INFO - Avg. fwd time: 45.3646 / Avg. bwd time: 60.5884 / Avg. batch time: 1980.0059 (ms) / GPU bubble ratio: 57.19%
[rank0]:2025-10-27 02:02:25,662 - INFO -  step: 440  loss: -4.0000  grad_norm:  0.1625  memory: 20.89GiB(43.97%)  tps: 2,043  tflops: 15.97  mfu: 5.12%
[rank2]:2025-10-27 02:02:25,639 - INFO -  step: 440  loss: -4.0000  grad_norm:  0.1625  memory: 16.10GiB(33.90%)  tps: 2,043  tflops: 15.97  mfu: 5.12%
[rank3]:2025-10-27 02:02:25,651 - INFO -  step: 440  loss:  0.1348  grad_norm:  0.1625  memory: 38.93GiB(81.95%)  tps: 2,043  tflops: 15.97  mfu: 5.12%
[rank1]:2025-10-27 02:02:25,642 - INFO -  step: 440  loss: -4.0000  grad_norm:  0.1625  memory: 20.03GiB(42.17%)  tps: 2,043  tflops: 15.97  mfu: 5.12%
[rank3]:2025-10-27 02:02:27,448 - INFO - Avg. fwd time: 72.1843 / Avg. bwd time: 130.9667 / Avg. batch time: 1672.6645 (ms) / GPU bubble ratio: 2.84%
[rank2]:2025-10-27 02:02:27,511 - INFO - Avg. fwd time: 33.4080 / Avg. bwd time: 54.2072 / Avg. batch time: 1762.4446 (ms) / GPU bubble ratio: 60.23%
[rank1]:2025-10-27 02:02:27,583 - INFO - Avg. fwd time: 50.6314 / Avg. bwd time: 74.2288 / Avg. batch time: 1881.6479 (ms) / GPU bubble ratio: 46.91%
[rank0]:2025-10-27 02:02:27,647 - INFO - Avg. fwd time: 45.3659 / Avg. bwd time: 60.5992 / Avg. batch time: 1980.1419 (ms) / GPU bubble ratio: 57.19%
[rank0]:2025-10-27 02:03:38,179 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-27 02:05:05,611 - INFO -  step: 460  loss:  0.1076  grad_norm:  0.1907  memory: 38.93GiB(81.95%)  tps: 2,049  tflops: 16.01  mfu: 5.13%
[rank1]:2025-10-27 02:05:05,603 - INFO -  step: 460  loss: -4.0000  grad_norm:  0.1907  memory: 20.03GiB(42.17%)  tps: 2,049  tflops: 16.01  mfu: 5.13%
[rank0]:2025-10-27 02:05:05,624 - INFO -  step: 460  loss: -4.0000  grad_norm:  0.1907  memory: 20.89GiB(43.97%)  tps: 2,048  tflops: 16.01  mfu: 5.13%
[rank2]:2025-10-27 02:05:05,598 - INFO -  step: 460  loss: -4.0000  grad_norm:  0.1907  memory: 16.10GiB(33.90%)  tps: 2,049  tflops: 16.01  mfu: 5.13%
[rank3]:2025-10-27 02:05:07,439 - INFO - Avg. fwd time: 72.1907 / Avg. bwd time: 130.9664 / Avg. batch time: 1672.6306 (ms) / GPU bubble ratio: 2.83%
[rank2]:2025-10-27 02:05:07,503 - INFO - Avg. fwd time: 33.4083 / Avg. bwd time: 54.2072 / Avg. batch time: 1762.4077 (ms) / GPU bubble ratio: 60.23%
[rank1]:2025-10-27 02:05:07,586 - INFO - Avg. fwd time: 50.5646 / Avg. bwd time: 74.2020 / Avg. batch time: 1881.5823 (ms) / GPU bubble ratio: 46.95%
[rank0]:2025-10-27 02:05:07,651 - INFO - Avg. fwd time: 45.3500 / Avg. bwd time: 60.5950 / Avg. batch time: 1980.0570 (ms) / GPU bubble ratio: 57.20%
[rank2]:2025-10-27 02:07:45,979 - INFO -  step: 480  loss: -4.0000  grad_norm:  0.2298  memory: 16.10GiB(33.90%)  tps: 2,043  tflops: 15.97  mfu: 5.12%
[rank3]:2025-10-27 02:07:45,992 - INFO -  step: 480  loss:  0.1167  grad_norm:  0.2298  memory: 38.93GiB(81.95%)  tps: 2,043  tflops: 15.97  mfu: 5.12%
[rank1]:2025-10-27 02:07:45,984 - INFO -  step: 480  loss: -4.0000  grad_norm:  0.2298  memory: 20.03GiB(42.17%)  tps: 2,043  tflops: 15.97  mfu: 5.12%
[rank0]:2025-10-27 02:07:45,999 - INFO -  step: 480  loss: -4.0000  grad_norm:  0.2298  memory: 20.89GiB(43.97%)  tps: 2,043  tflops: 15.97  mfu: 5.12%
[rank3]:2025-10-27 02:07:47,817 - INFO - Avg. fwd time: 72.2077 / Avg. bwd time: 130.9832 / Avg. batch time: 1672.8269 (ms) / GPU bubble ratio: 2.83%
[rank2]:2025-10-27 02:07:47,877 - INFO - Avg. fwd time: 33.4281 / Avg. bwd time: 54.2130 / Avg. batch time: 1762.5973 (ms) / GPU bubble ratio: 60.22%
[rank1]:2025-10-27 02:07:47,973 - INFO - Avg. fwd time: 50.4854 / Avg. bwd time: 74.2039 / Avg. batch time: 1881.7607 (ms) / GPU bubble ratio: 46.99%
[rank0]:2025-10-27 02:07:48,039 - INFO - Avg. fwd time: 45.3288 / Avg. bwd time: 60.5900 / Avg. batch time: 1980.1959 (ms) / GPU bubble ratio: 57.21%
[rank0]:2025-10-27 02:10:18,014 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-27 02:10:25,927 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.1159  memory: 16.10GiB(33.90%)  tps: 2,049  tflops: 16.02  mfu: 5.13%
[rank2]:2025-10-27 02:10:25,927 - INFO - ðŸ”Ž  Running validation at step 500
[rank1]:2025-10-27 02:10:25,930 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.1159  memory: 20.03GiB(42.17%)  tps: 2,049  tflops: 16.02  mfu: 5.13%
[rank1]:2025-10-27 02:10:25,931 - INFO - ðŸ”Ž  Running validation at step 500
[rank3]:2025-10-27 02:10:25,939 - INFO -  step: 500  loss:  0.1001  grad_norm:  0.1159  memory: 38.93GiB(81.95%)  tps: 2,049  tflops: 16.02  mfu: 5.13%
[rank3]:2025-10-27 02:10:25,940 - INFO - ðŸ”Ž  Running validation at step 500
[rank0]:2025-10-27 02:10:25,947 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.1159  memory: 20.89GiB(43.97%)  tps: 2,049  tflops: 16.02  mfu: 5.13%
[rank0]:2025-10-27 02:10:25,947 - INFO - ðŸ”Ž  Running validation at step 500
[rank0]:2025-10-27 02:10:46,926 - INFO - validate step: 500  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,857
[rank0]:2025-10-27 02:10:46,927 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-27 02:10:46,928 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank1]:2025-10-27 02:10:47,007 - INFO - validate step: 500  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,830
[rank1]:2025-10-27 02:10:47,008 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-27 02:10:47,088 - INFO - validate step: 500  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,807
[rank2]:2025-10-27 02:10:47,089 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-27 02:10:47,173 - INFO - validate step: 500  loss:  0.3113  memory: 38.93GiB(81.95%)  tps: 5,787
[rank3]:2025-10-27 02:10:47,174 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-27 02:10:48,990 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 1.90 seconds.
[rank1]:2025-10-27 02:10:49,310 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 2.30 seconds.
[rank3]:2025-10-27 02:10:50,435 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.26 seconds.
[rank0]:2025-10-27 02:10:50,686 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-27 02:10:50,694 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.77 seconds.
[rank3]:2025-10-27 02:10:51,048 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1026_GPipe_nofreeze_dm1/pipeline_schedule/251027_0210_real_step500_rank3.svg
[rank3]:> Batch Time: 1927.98 ms, GPU Bubble Ratio: 55.92%, 47.65%, 63.97%, 15.32%
[rank3]:2025-10-27 02:10:52,715 - INFO - Avg. fwd time: 72.1967 / Avg. bwd time: 130.9842 / Avg. batch time: 1672.7244 (ms) / GPU bubble ratio: 2.83%
[rank2]:2025-10-27 02:10:52,779 - INFO - Avg. fwd time: 33.4285 / Avg. bwd time: 54.2160 / Avg. batch time: 1762.5891 (ms) / GPU bubble ratio: 60.22%
[rank1]:2025-10-27 02:10:52,855 - INFO - Avg. fwd time: 50.4542 / Avg. bwd time: 74.2057 / Avg. batch time: 1881.7417 (ms) / GPU bubble ratio: 47.00%
[rank0]:2025-10-27 02:10:52,919 - INFO - Avg. fwd time: 45.3204 / Avg. bwd time: 60.5985 / Avg. batch time: 1980.1749 (ms) / GPU bubble ratio: 57.21%
[rank1]:2025-10-27 02:13:30,213 - INFO -  step: 520  loss: -4.0000  grad_norm:  0.1928  memory: 20.03GiB(42.17%)  tps: 2,008  tflops: 15.70  mfu: 5.03%
[rank3]:2025-10-27 02:13:30,222 - INFO -  step: 520  loss:  0.1381  grad_norm:  0.1928  memory: 38.93GiB(81.95%)  tps: 2,010  tflops: 15.71  mfu: 5.04%
[rank0]:2025-10-27 02:13:30,229 - INFO -  step: 520  loss: -4.0000  grad_norm:  0.1928  memory: 20.89GiB(43.97%)  tps: 2,007  tflops: 15.69  mfu: 5.03%
[rank2]:2025-10-27 02:13:30,209 - INFO -  step: 520  loss: -4.0000  grad_norm:  0.1928  memory: 16.10GiB(33.90%)  tps: 2,009  tflops: 15.70  mfu: 5.03%
[rank3]:2025-10-27 02:13:32,012 - INFO - Avg. fwd time: 72.1786 / Avg. bwd time: 130.9587 / Avg. batch time: 1672.3409 (ms) / GPU bubble ratio: 2.82%
[rank2]:2025-10-27 02:13:32,073 - INFO - Avg. fwd time: 33.4063 / Avg. bwd time: 54.2135 / Avg. batch time: 1762.1993 (ms) / GPU bubble ratio: 60.22%
[rank1]:2025-10-27 02:13:32,155 - INFO - Avg. fwd time: 50.4853 / Avg. bwd time: 74.1908 / Avg. batch time: 1881.3365 (ms) / GPU bubble ratio: 46.98%
[rank0]:2025-10-27 02:13:32,226 - INFO - Avg. fwd time: 45.3353 / Avg. bwd time: 60.5913 / Avg. batch time: 1979.7750 (ms) / GPU bubble ratio: 57.20%
[rank2]:2025-10-27 02:16:10,575 - INFO -  step: 540  loss: -4.0000  grad_norm:  0.1542  memory: 16.10GiB(33.90%)  tps: 2,043  tflops: 15.97  mfu: 5.12%
[rank1]:2025-10-27 02:16:10,579 - INFO -  step: 540  loss: -4.0000  grad_norm:  0.1542  memory: 20.03GiB(42.17%)  tps: 2,043  tflops: 15.97  mfu: 5.12%
[rank3]:2025-10-27 02:16:10,588 - INFO -  step: 540  loss:  0.1368  grad_norm:  0.1542  memory: 38.93GiB(81.95%)  tps: 2,043  tflops: 15.97  mfu: 5.12%
[rank0]:2025-10-27 02:16:10,590 - INFO -  step: 540  loss: -4.0000  grad_norm:  0.1542  memory: 20.89GiB(43.97%)  tps: 2,043  tflops: 15.97  mfu: 5.12%
[rank3]:2025-10-27 02:16:12,420 - INFO - Avg. fwd time: 72.1805 / Avg. bwd time: 130.9693 / Avg. batch time: 1672.4163 (ms) / GPU bubble ratio: 2.82%
[rank2]:2025-10-27 02:16:12,484 - INFO - Avg. fwd time: 33.4119 / Avg. bwd time: 54.2196 / Avg. batch time: 1762.2677 (ms) / GPU bubble ratio: 60.22%
[rank1]:2025-10-27 02:16:12,557 - INFO - Avg. fwd time: 50.4571 / Avg. bwd time: 74.2112 / Avg. batch time: 1881.4416 (ms) / GPU bubble ratio: 46.99%
[rank0]:2025-10-27 02:16:12,623 - INFO - Avg. fwd time: 45.3362 / Avg. bwd time: 60.5927 / Avg. batch time: 1979.9073 (ms) / GPU bubble ratio: 57.20%
[rank0]:2025-10-27 02:17:22,783 - INFO - [GC] Peforming periodical GC collection 0.30 seconds
[rank3]:2025-10-27 02:18:50,660 - INFO -  step: 560  loss:  0.1395  grad_norm:  0.2268  memory: 38.93GiB(81.95%)  tps: 2,047  tflops: 16.00  mfu: 5.13%
[rank0]:2025-10-27 02:18:50,666 - INFO -  step: 560  loss: -4.0000  grad_norm:  0.2268  memory: 20.89GiB(43.97%)  tps: 2,047  tflops: 16.00  mfu: 5.13%
[rank2]:2025-10-27 02:18:50,647 - INFO -  step: 560  loss: -4.0000  grad_norm:  0.2268  memory: 16.10GiB(33.90%)  tps: 2,047  tflops: 16.00  mfu: 5.13%
[rank1]:2025-10-27 02:18:50,652 - INFO -  step: 560  loss: -4.0000  grad_norm:  0.2268  memory: 20.03GiB(42.17%)  tps: 2,047  tflops: 16.00  mfu: 5.13%
[rank3]:2025-10-27 02:18:52,471 - INFO - Avg. fwd time: 72.1661 / Avg. bwd time: 130.9723 / Avg. batch time: 1672.2997 (ms) / GPU bubble ratio: 2.82%
[rank2]:2025-10-27 02:18:52,535 - INFO - Avg. fwd time: 33.4220 / Avg. bwd time: 54.2208 / Avg. batch time: 1762.1449 (ms) / GPU bubble ratio: 60.21%
[rank1]:2025-10-27 02:18:52,618 - INFO - Avg. fwd time: 50.4589 / Avg. bwd time: 74.2030 / Avg. batch time: 1881.2894 (ms) / GPU bubble ratio: 46.99%
[rank0]:2025-10-27 02:18:52,683 - INFO - Avg. fwd time: 45.3281 / Avg. bwd time: 60.5948 / Avg. batch time: 1979.7442 (ms) / GPU bubble ratio: 57.20%
[rank2]:2025-10-27 02:21:30,506 - INFO -  step: 580  loss: -4.0000  grad_norm:  0.4076  memory: 16.10GiB(33.90%)  tps: 2,050  tflops: 16.02  mfu: 5.14%
[rank3]:2025-10-27 02:21:30,519 - INFO -  step: 580  loss:  0.1185  grad_norm:  0.4076  memory: 38.93GiB(81.95%)  tps: 2,050  tflops: 16.02  mfu: 5.14%
[rank0]:2025-10-27 02:21:30,522 - INFO -  step: 580  loss: -4.0000  grad_norm:  0.4076  memory: 20.89GiB(43.97%)  tps: 2,050  tflops: 16.02  mfu: 5.14%
[rank1]:2025-10-27 02:21:30,510 - INFO -  step: 580  loss: -4.0000  grad_norm:  0.4076  memory: 20.03GiB(42.17%)  tps: 2,050  tflops: 16.02  mfu: 5.14%
[rank3]:2025-10-27 02:21:32,284 - INFO - Avg. fwd time: 72.1677 / Avg. bwd time: 130.9633 / Avg. batch time: 1672.1957 (ms) / GPU bubble ratio: 2.82%
[rank2]:2025-10-27 02:21:32,344 - INFO - Avg. fwd time: 33.4194 / Avg. bwd time: 54.2210 / Avg. batch time: 1762.0340 (ms) / GPU bubble ratio: 60.21%
[rank0]:2025-10-27 02:21:32,485 - INFO - Avg. fwd time: 45.3140 / Avg. bwd time: 60.5915 / Avg. batch time: 1979.6112 (ms) / GPU bubble ratio: 57.20%
[rank1]:2025-10-27 02:21:32,418 - INFO - Avg. fwd time: 50.4670 / Avg. bwd time: 74.1951 / Avg. batch time: 1881.1707 (ms) / GPU bubble ratio: 46.99%
[rank0]:2025-10-27 02:24:02,568 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-27 02:24:10,575 - INFO -  step: 600  loss:  0.1237  grad_norm:  0.1317  memory: 38.93GiB(81.95%)  tps: 2,047  tflops: 16.00  mfu: 5.13%
[rank3]:2025-10-27 02:24:10,576 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-10-27 02:24:10,583 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.1317  memory: 20.89GiB(43.97%)  tps: 2,047  tflops: 16.00  mfu: 5.13%
[rank0]:2025-10-27 02:24:10,583 - INFO - ðŸ”Ž  Running validation at step 600
[rank1]:2025-10-27 02:24:10,567 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.1317  memory: 20.03GiB(42.17%)  tps: 2,047  tflops: 16.00  mfu: 5.13%
[rank1]:2025-10-27 02:24:10,567 - INFO - ðŸ”Ž  Running validation at step 600
[rank2]:2025-10-27 02:24:10,563 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.1317  memory: 16.10GiB(33.90%)  tps: 2,047  tflops: 16.00  mfu: 5.13%
[rank2]:2025-10-27 02:24:10,563 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-10-27 02:24:31,575 - INFO - validate step: 600  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,854
[rank1]:2025-10-27 02:24:31,654 - INFO - validate step: 600  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,827
[rank2]:2025-10-27 02:24:31,737 - INFO - validate step: 600  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,803
[rank3]:2025-10-27 02:24:31,824 - INFO - validate step: 600  loss:  0.3019  memory: 38.93GiB(81.95%)  tps: 5,784
[rank3]:2025-10-27 02:24:32,036 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1026_GPipe_nofreeze_dm1/pipeline_schedule/251027_0224_real_step600_rank3.svg
[rank3]:> Batch Time: 1927.41 ms, GPU Bubble Ratio: 55.94%, 47.64%, 63.96%, 15.32%
[rank3]:2025-10-27 02:24:33,740 - INFO - Avg. fwd time: 72.1690 / Avg. bwd time: 130.9658 / Avg. batch time: 1672.1753 (ms) / GPU bubble ratio: 2.82%
[rank2]:2025-10-27 02:24:33,800 - INFO - Avg. fwd time: 33.4234 / Avg. bwd time: 54.2237 / Avg. batch time: 1762.0446 (ms) / GPU bubble ratio: 60.21%
[rank1]:2025-10-27 02:24:33,875 - INFO - Avg. fwd time: 50.4404 / Avg. bwd time: 74.1917 / Avg. batch time: 1881.1757 (ms) / GPU bubble ratio: 47.00%
[rank0]:2025-10-27 02:24:33,944 - INFO - Avg. fwd time: 45.3182 / Avg. bwd time: 60.6005 / Avg. batch time: 1979.6380 (ms) / GPU bubble ratio: 57.20%
[rank0]:2025-10-27 02:27:11,818 - INFO -  step: 620  loss: -4.0000  grad_norm:  0.2002  memory: 20.89GiB(43.97%)  tps: 2,045  tflops: 15.99  mfu: 5.12%
[rank2]:2025-10-27 02:27:11,798 - INFO -  step: 620  loss: -4.0000  grad_norm:  0.2002  memory: 16.10GiB(33.90%)  tps: 2,047  tflops: 16.00  mfu: 5.13%
[rank1]:2025-10-27 02:27:11,803 - INFO -  step: 620  loss: -4.0000  grad_norm:  0.2002  memory: 20.03GiB(42.17%)  tps: 2,046  tflops: 16.00  mfu: 5.13%
[rank3]:2025-10-27 02:27:11,811 - INFO -  step: 620  loss:  0.1546  grad_norm:  0.2002  memory: 38.93GiB(81.95%)  tps: 2,048  tflops: 16.01  mfu: 5.13%
[rank3]:2025-10-27 02:27:13,638 - INFO - Avg. fwd time: 72.1684 / Avg. bwd time: 130.9601 / Avg. batch time: 1672.0913 (ms) / GPU bubble ratio: 2.81%
[rank2]:2025-10-27 02:27:13,699 - INFO - Avg. fwd time: 33.4200 / Avg. bwd time: 54.2272 / Avg. batch time: 1761.9539 (ms) / GPU bubble ratio: 60.20%
[rank1]:2025-10-27 02:27:13,780 - INFO - Avg. fwd time: 50.4415 / Avg. bwd time: 74.1799 / Avg. batch time: 1881.0598 (ms) / GPU bubble ratio: 47.00%
[rank0]:2025-10-27 02:27:13,844 - INFO - Avg. fwd time: 45.3332 / Avg. bwd time: 60.6098 / Avg. batch time: 1979.5472 (ms) / GPU bubble ratio: 57.18%
[rank2]:2025-10-27 02:29:52,134 - INFO -  step: 640  loss: -4.0000  grad_norm:  0.1996  memory: 16.10GiB(33.90%)  tps: 2,044  tflops: 15.98  mfu: 5.12%
[rank1]:2025-10-27 02:29:52,140 - INFO -  step: 640  loss: -4.0000  grad_norm:  0.1996  memory: 20.03GiB(42.17%)  tps: 2,044  tflops: 15.98  mfu: 5.12%
[rank0]:2025-10-27 02:29:52,152 - INFO -  step: 640  loss: -4.0000  grad_norm:  0.1996  memory: 20.89GiB(43.97%)  tps: 2,044  tflops: 15.98  mfu: 5.12%
[rank3]:2025-10-27 02:29:52,147 - INFO -  step: 640  loss:  0.1103  grad_norm:  0.1996  memory: 38.93GiB(81.95%)  tps: 2,044  tflops: 15.98  mfu: 5.12%
[rank3]:2025-10-27 02:29:53,980 - INFO - Avg. fwd time: 72.1771 / Avg. bwd time: 130.9685 / Avg. batch time: 1672.2032 (ms) / GPU bubble ratio: 2.81%
[rank2]:2025-10-27 02:29:54,046 - INFO - Avg. fwd time: 33.4268 / Avg. bwd time: 54.2373 / Avg. batch time: 1762.0835 (ms) / GPU bubble ratio: 60.20%
[rank1]:2025-10-27 02:29:54,142 - INFO - Avg. fwd time: 50.4208 / Avg. bwd time: 74.1738 / Avg. batch time: 1881.1731 (ms) / GPU bubble ratio: 47.01%
[rank0]:2025-10-27 02:29:54,207 - INFO - Avg. fwd time: 45.3386 / Avg. bwd time: 60.6078 / Avg. batch time: 1979.6607 (ms) / GPU bubble ratio: 57.19%
[rank0]:2025-10-27 02:31:03,990 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-27 02:32:32,079 - INFO -  step: 660  loss: -4.0000  grad_norm:  0.1423  memory: 20.03GiB(42.17%)  tps: 2,049  tflops: 16.02  mfu: 5.13%
[rank0]:2025-10-27 02:32:32,098 - INFO -  step: 660  loss: -4.0000  grad_norm:  0.1423  memory: 20.89GiB(43.97%)  tps: 2,049  tflops: 16.02  mfu: 5.13%
[rank3]:2025-10-27 02:32:32,088 - INFO -  step: 660  loss:  0.1181  grad_norm:  0.1423  memory: 38.93GiB(81.95%)  tps: 2,049  tflops: 16.02  mfu: 5.13%
[rank2]:2025-10-27 02:32:32,075 - INFO -  step: 660  loss: -4.0000  grad_norm:  0.1423  memory: 16.10GiB(33.90%)  tps: 2,049  tflops: 16.02  mfu: 5.13%
[rank3]:2025-10-27 02:32:33,872 - INFO - Avg. fwd time: 72.1653 / Avg. bwd time: 130.9635 / Avg. batch time: 1672.0871 (ms) / GPU bubble ratio: 2.81%
[rank2]:2025-10-27 02:32:33,936 - INFO - Avg. fwd time: 33.4214 / Avg. bwd time: 54.2436 / Avg. batch time: 1761.9589 (ms) / GPU bubble ratio: 60.20%
[rank1]:2025-10-27 02:32:34,009 - INFO - Avg. fwd time: 50.4324 / Avg. bwd time: 74.1569 / Avg. batch time: 1881.0573 (ms) / GPU bubble ratio: 47.01%
[rank0]:2025-10-27 02:32:34,075 - INFO - Avg. fwd time: 45.3324 / Avg. bwd time: 60.6110 / Avg. batch time: 1979.5565 (ms) / GPU bubble ratio: 57.19%
[rank2]:2025-10-27 02:35:11,643 - INFO -  step: 680  loss: -4.0000  grad_norm:  0.1191  memory: 16.10GiB(33.90%)  tps: 2,054  tflops: 16.05  mfu: 5.15%
[rank1]:2025-10-27 02:35:11,647 - INFO -  step: 680  loss: -4.0000  grad_norm:  0.1191  memory: 20.03GiB(42.17%)  tps: 2,054  tflops: 16.05  mfu: 5.15%
[rank0]:2025-10-27 02:35:11,661 - INFO -  step: 680  loss: -4.0000  grad_norm:  0.1191  memory: 20.89GiB(43.97%)  tps: 2,054  tflops: 16.05  mfu: 5.15%
[rank3]:2025-10-27 02:35:11,656 - INFO -  step: 680  loss:  0.1281  grad_norm:  0.1191  memory: 38.93GiB(81.95%)  tps: 2,054  tflops: 16.05  mfu: 5.15%
[rank3]:2025-10-27 02:35:13,462 - INFO - Avg. fwd time: 72.1562 / Avg. bwd time: 130.9536 / Avg. batch time: 1671.9059 (ms) / GPU bubble ratio: 2.81%
[rank2]:2025-10-27 02:35:13,522 - INFO - Avg. fwd time: 33.4153 / Avg. bwd time: 54.2409 / Avg. batch time: 1761.7509 (ms) / GPU bubble ratio: 60.20%
[rank1]:2025-10-27 02:35:13,603 - INFO - Avg. fwd time: 50.4347 / Avg. bwd time: 74.1390 / Avg. batch time: 1880.8378 (ms) / GPU bubble ratio: 47.01%
[rank0]:2025-10-27 02:35:13,671 - INFO - Avg. fwd time: 45.3374 / Avg. bwd time: 60.6141 / Avg. batch time: 1979.3554 (ms) / GPU bubble ratio: 57.18%
[rank0]:2025-10-27 02:37:44,286 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-27 02:37:52,405 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.1381  memory: 20.03GiB(42.17%)  tps: 2,038  tflops: 15.93  mfu: 5.11%
[rank1]:2025-10-27 02:37:52,405 - INFO - ðŸ”Ž  Running validation at step 700
[rank0]:2025-10-27 02:37:52,417 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.1381  memory: 20.89GiB(43.97%)  tps: 2,038  tflops: 15.94  mfu: 5.11%
[rank0]:2025-10-27 02:37:52,417 - INFO - ðŸ”Ž  Running validation at step 700
[rank3]:2025-10-27 02:37:52,414 - INFO -  step: 700  loss:  0.1152  grad_norm:  0.1381  memory: 38.93GiB(81.95%)  tps: 2,038  tflops: 15.94  mfu: 5.11%
[rank3]:2025-10-27 02:37:52,414 - INFO - ðŸ”Ž  Running validation at step 700
[rank2]:2025-10-27 02:37:52,401 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.1381  memory: 16.10GiB(33.90%)  tps: 2,038  tflops: 15.93  mfu: 5.11%
[rank2]:2025-10-27 02:37:52,401 - INFO - ðŸ”Ž  Running validation at step 700
[rank0]:2025-10-27 02:38:13,490 - INFO - validate step: 700  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,831
[rank1]:2025-10-27 02:38:13,569 - INFO - validate step: 700  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,806
[rank2]:2025-10-27 02:38:13,652 - INFO - validate step: 700  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,783
[rank3]:2025-10-27 02:38:13,738 - INFO - validate step: 700  loss:  0.3067  memory: 38.93GiB(81.95%)  tps: 5,763
[rank3]:2025-10-27 02:38:13,949 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1026_GPipe_nofreeze_dm1/pipeline_schedule/251027_0238_real_step700_rank3.svg
[rank3]:> Batch Time: 1927.44 ms, GPU Bubble Ratio: 55.92%, 47.70%, 63.95%, 15.32%
[rank3]:2025-10-27 02:38:15,648 - INFO - Avg. fwd time: 72.1705 / Avg. bwd time: 130.9676 / Avg. batch time: 1672.0956 (ms) / GPU bubble ratio: 2.81%
[rank2]:2025-10-27 02:38:15,713 - INFO - Avg. fwd time: 33.4149 / Avg. bwd time: 54.2477 / Avg. batch time: 1761.9841 (ms) / GPU bubble ratio: 60.20%
[rank1]:2025-10-27 02:38:15,795 - INFO - Avg. fwd time: 50.4236 / Avg. bwd time: 74.1449 / Avg. batch time: 1881.1009 (ms) / GPU bubble ratio: 47.02%
[rank0]:2025-10-27 02:38:15,864 - INFO - Avg. fwd time: 45.3397 / Avg. bwd time: 60.6205 / Avg. batch time: 1979.6404 (ms) / GPU bubble ratio: 57.18%
[rank2]:2025-10-27 02:40:54,007 - INFO -  step: 720  loss: -4.0000  grad_norm:  0.2424  memory: 16.10GiB(33.90%)  tps: 2,043  tflops: 15.97  mfu: 5.12%
[rank1]:2025-10-27 02:40:54,017 - INFO -  step: 720  loss: -4.0000  grad_norm:  0.2424  memory: 20.03GiB(42.17%)  tps: 2,042  tflops: 15.97  mfu: 5.12%
[rank0]:2025-10-27 02:40:54,027 - INFO -  step: 720  loss: -4.0000  grad_norm:  0.2424  memory: 20.89GiB(43.97%)  tps: 2,041  tflops: 15.96  mfu: 5.11%
[rank3]:2025-10-27 02:40:54,020 - INFO -  step: 720  loss:  0.1983  grad_norm:  0.2424  memory: 38.93GiB(81.95%)  tps: 2,044  tflops: 15.98  mfu: 5.12%
[rank3]:2025-10-27 02:40:55,817 - INFO - Avg. fwd time: 72.1714 / Avg. bwd time: 130.9736 / Avg. batch time: 1672.1392 (ms) / GPU bubble ratio: 2.81%
[rank2]:2025-10-27 02:40:55,877 - INFO - Avg. fwd time: 33.4170 / Avg. bwd time: 54.2496 / Avg. batch time: 1762.0341 (ms) / GPU bubble ratio: 60.20%
[rank1]:2025-10-27 02:40:55,951 - INFO - Avg. fwd time: 50.4263 / Avg. bwd time: 74.1299 / Avg. batch time: 1881.1124 (ms) / GPU bubble ratio: 47.03%
[rank0]:2025-10-27 02:40:56,018 - INFO - Avg. fwd time: 45.3442 / Avg. bwd time: 60.6199 / Avg. batch time: 1979.6587 (ms) / GPU bubble ratio: 57.18%
[rank2]:2025-10-27 02:43:33,795 - INFO -  step: 740  loss: -4.0000  grad_norm:  0.4570  memory: 16.10GiB(33.90%)  tps: 2,051  tflops: 16.03  mfu: 5.14%
[rank0]:2025-10-27 02:43:33,811 - INFO -  step: 740  loss: -4.0000  grad_norm:  0.4570  memory: 20.89GiB(43.97%)  tps: 2,051  tflops: 16.03  mfu: 5.14%
[rank1]:2025-10-27 02:43:33,798 - INFO -  step: 740  loss: -4.0000  grad_norm:  0.4570  memory: 20.03GiB(42.17%)  tps: 2,051  tflops: 16.03  mfu: 5.14%
[rank3]:2025-10-27 02:43:33,807 - INFO -  step: 740  loss:  0.1384  grad_norm:  0.4570  memory: 38.93GiB(81.95%)  tps: 2,051  tflops: 16.03  mfu: 5.14%
[rank3]:2025-10-27 02:43:35,570 - INFO - Avg. fwd time: 72.1621 / Avg. bwd time: 130.9711 / Avg. batch time: 1672.0288 (ms) / GPU bubble ratio: 2.81%
[rank2]:2025-10-27 02:43:35,631 - INFO - Avg. fwd time: 33.4140 / Avg. bwd time: 54.2521 / Avg. batch time: 1761.9152 (ms) / GPU bubble ratio: 60.20%
[rank1]:2025-10-27 02:43:35,706 - INFO - Avg. fwd time: 50.4221 / Avg. bwd time: 74.1192 / Avg. batch time: 1880.9944 (ms) / GPU bubble ratio: 47.03%
[rank0]:2025-10-27 02:43:35,775 - INFO - Avg. fwd time: 45.3382 / Avg. bwd time: 60.6237 / Avg. batch time: 1979.5501 (ms) / GPU bubble ratio: 57.18%
[rank0]:2025-10-27 02:44:45,827 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-27 02:46:13,847 - INFO -  step: 760  loss: -4.0000  grad_norm:  0.1248  memory: 20.03GiB(42.17%)  tps: 2,047  tflops: 16.01  mfu: 5.13%
[rank0]:2025-10-27 02:46:13,861 - INFO -  step: 760  loss: -4.0000  grad_norm:  0.1248  memory: 20.89GiB(43.97%)  tps: 2,047  tflops: 16.01  mfu: 5.13%
[rank3]:2025-10-27 02:46:13,855 - INFO -  step: 760  loss:  0.1241  grad_norm:  0.1248  memory: 38.93GiB(81.95%)  tps: 2,047  tflops: 16.01  mfu: 5.13%
[rank2]:2025-10-27 02:46:13,843 - INFO -  step: 760  loss: -4.0000  grad_norm:  0.1248  memory: 16.10GiB(33.90%)  tps: 2,047  tflops: 16.01  mfu: 5.13%
[rank3]:2025-10-27 02:46:15,659 - INFO - Avg. fwd time: 72.1561 / Avg. bwd time: 130.9740 / Avg. batch time: 1671.9979 (ms) / GPU bubble ratio: 2.81%
[rank2]:2025-10-27 02:46:15,720 - INFO - Avg. fwd time: 33.4096 / Avg. bwd time: 54.2509 / Avg. batch time: 1761.8766 (ms) / GPU bubble ratio: 60.20%
[rank1]:2025-10-27 02:46:15,802 - INFO - Avg. fwd time: 50.4269 / Avg. bwd time: 74.1138 / Avg. batch time: 1880.9749 (ms) / GPU bubble ratio: 47.03%
[rank0]:2025-10-27 02:46:15,867 - INFO - Avg. fwd time: 45.3396 / Avg. bwd time: 60.6311 / Avg. batch time: 1979.5395 (ms) / GPU bubble ratio: 57.17%
[rank1]:2025-10-27 02:48:53,778 - INFO -  step: 780  loss: -4.0000  grad_norm:  0.1685  memory: 20.03GiB(42.17%)  tps: 2,049  tflops: 16.02  mfu: 5.13%
[rank3]:2025-10-27 02:48:53,785 - INFO -  step: 780  loss:  0.1349  grad_norm:  0.1685  memory: 38.93GiB(81.95%)  tps: 2,049  tflops: 16.02  mfu: 5.13%
[rank2]:2025-10-27 02:48:53,773 - INFO -  step: 780  loss: -4.0000  grad_norm:  0.1685  memory: 16.10GiB(33.90%)  tps: 2,049  tflops: 16.02  mfu: 5.13%
[rank0]:2025-10-27 02:48:53,796 - INFO -  step: 780  loss: -4.0000  grad_norm:  0.1685  memory: 20.89GiB(43.97%)  tps: 2,049  tflops: 16.02  mfu: 5.13%
[rank3]:2025-10-27 02:48:55,590 - INFO - Avg. fwd time: 72.1511 / Avg. bwd time: 130.9699 / Avg. batch time: 1671.9157 (ms) / GPU bubble ratio: 2.81%
[rank2]:2025-10-27 02:48:55,656 - INFO - Avg. fwd time: 33.4095 / Avg. bwd time: 54.2512 / Avg. batch time: 1761.7855 (ms) / GPU bubble ratio: 60.19%
[rank1]:2025-10-27 02:48:55,734 - INFO - Avg. fwd time: 50.4364 / Avg. bwd time: 74.0989 / Avg. batch time: 1880.8972 (ms) / GPU bubble ratio: 47.03%
[rank0]:2025-10-27 02:48:55,812 - INFO - Avg. fwd time: 45.3269 / Avg. bwd time: 60.6310 / Avg. batch time: 1979.4781 (ms) / GPU bubble ratio: 57.18%
[rank0]:2025-10-27 02:51:26,530 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-27 02:51:34,682 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.2009  memory: 20.03GiB(42.17%)  tps: 2,037  tflops: 15.92  mfu: 5.10%
[rank1]:2025-10-27 02:51:34,682 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-10-27 02:51:34,697 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.2009  memory: 20.89GiB(43.97%)  tps: 2,037  tflops: 15.92  mfu: 5.10%
[rank0]:2025-10-27 02:51:34,697 - INFO - ðŸ”Ž  Running validation at step 800
[rank3]:2025-10-27 02:51:34,691 - INFO -  step: 800  loss:  0.1080  grad_norm:  0.2009  memory: 38.93GiB(81.95%)  tps: 2,036  tflops: 15.92  mfu: 5.10%
[rank3]:2025-10-27 02:51:34,692 - INFO - ðŸ”Ž  Running validation at step 800
[rank2]:2025-10-27 02:51:34,679 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.2009  memory: 16.10GiB(33.90%)  tps: 2,036  tflops: 15.92  mfu: 5.10%
[rank2]:2025-10-27 02:51:34,679 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-10-27 02:51:55,717 - INFO - validate step: 800  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,846
[rank1]:2025-10-27 02:51:55,799 - INFO - validate step: 800  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,819
[rank2]:2025-10-27 02:51:55,881 - INFO - validate step: 800  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,796
[rank3]:2025-10-27 02:51:55,968 - INFO - validate step: 800  loss:  0.2995  memory: 38.93GiB(81.95%)  tps: 5,776
[rank3]:2025-10-27 02:51:56,174 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1026_GPipe_nofreeze_dm1/pipeline_schedule/251027_0251_real_step800_rank3.svg
[rank3]:> Batch Time: 1927.70 ms, GPU Bubble Ratio: 55.93%, 47.74%, 63.96%, 15.33%
[rank3]:2025-10-27 02:51:57,907 - INFO - Avg. fwd time: 72.1675 / Avg. bwd time: 130.9856 / Avg. batch time: 1672.1428 (ms) / GPU bubble ratio: 2.81%
[rank2]:2025-10-27 02:51:57,967 - INFO - Avg. fwd time: 33.4142 / Avg. bwd time: 54.2544 / Avg. batch time: 1762.0548 (ms) / GPU bubble ratio: 60.20%
[rank1]:2025-10-27 02:51:58,053 - INFO - Avg. fwd time: 50.4306 / Avg. bwd time: 74.0878 / Avg. batch time: 1881.1682 (ms) / GPU bubble ratio: 47.05%
[rank0]:2025-10-27 02:51:58,120 - INFO - Avg. fwd time: 45.3351 / Avg. bwd time: 60.6346 / Avg. batch time: 1979.7698 (ms) / GPU bubble ratio: 57.18%
[rank3]:2025-10-27 02:53:27,075 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-27 02:53:27,798 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-27 02:53:27,870 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-27 02:53:27,928 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-27 02:54:38,033 - INFO -  step: 820  loss: -4.0000  grad_norm:  0.1806  memory: 20.03GiB(42.17%)  tps: 2,020  tflops: 15.79  mfu: 5.06%
[rank3]:2025-10-27 02:54:38,042 - INFO -  step: 820  loss:  0.1347  grad_norm:  0.1806  memory: 38.93GiB(81.95%)  tps: 2,022  tflops: 15.81  mfu: 5.07%
[rank2]:2025-10-27 02:54:38,030 - INFO -  step: 820  loss: -4.0000  grad_norm:  0.1806  memory: 16.10GiB(33.90%)  tps: 2,021  tflops: 15.80  mfu: 5.06%
[rank0]:2025-10-27 02:54:38,047 - INFO -  step: 820  loss: -4.0000  grad_norm:  0.1806  memory: 20.89GiB(43.97%)  tps: 2,019  tflops: 15.78  mfu: 5.06%
[rank3]:2025-10-27 02:54:39,805 - INFO - Avg. fwd time: 72.1609 / Avg. bwd time: 130.9895 / Avg. batch time: 1672.1167 (ms) / GPU bubble ratio: 2.81%
[rank2]:2025-10-27 02:54:39,866 - INFO - Avg. fwd time: 33.4141 / Avg. bwd time: 54.2537 / Avg. batch time: 1762.0234 (ms) / GPU bubble ratio: 60.20%
[rank1]:2025-10-27 02:54:39,942 - INFO - Avg. fwd time: 50.4547 / Avg. bwd time: 74.0806 / Avg. batch time: 1881.1043 (ms) / GPU bubble ratio: 47.04%
[rank0]:2025-10-27 02:54:40,011 - INFO - Avg. fwd time: 45.3506 / Avg. bwd time: 60.6386 / Avg. batch time: 1979.7271 (ms) / GPU bubble ratio: 57.17%
[rank1]:2025-10-27 02:57:17,642 - INFO -  step: 840  loss: -4.0000  grad_norm:  0.1436  memory: 20.03GiB(42.17%)  tps: 2,053  tflops: 16.05  mfu: 5.14%
[rank3]:2025-10-27 02:57:17,650 - INFO -  step: 840  loss:  0.1349  grad_norm:  0.1436  memory: 38.93GiB(81.95%)  tps: 2,053  tflops: 16.05  mfu: 5.14%
[rank2]:2025-10-27 02:57:17,638 - INFO -  step: 840  loss: -4.0000  grad_norm:  0.1436  memory: 16.10GiB(33.90%)  tps: 2,053  tflops: 16.05  mfu: 5.14%
[rank0]:2025-10-27 02:57:17,657 - INFO -  step: 840  loss: -4.0000  grad_norm:  0.1436  memory: 20.89GiB(43.97%)  tps: 2,053  tflops: 16.05  mfu: 5.14%
[rank3]:2025-10-27 02:57:19,454 - INFO - Avg. fwd time: 72.1542 / Avg. bwd time: 130.9815 / Avg. batch time: 1672.0009 (ms) / GPU bubble ratio: 2.81%
[rank2]:2025-10-27 02:57:19,514 - INFO - Avg. fwd time: 33.4097 / Avg. bwd time: 54.2506 / Avg. batch time: 1761.8874 (ms) / GPU bubble ratio: 60.20%
[rank1]:2025-10-27 02:57:19,597 - INFO - Avg. fwd time: 50.4770 / Avg. bwd time: 74.0779 / Avg. batch time: 1880.9829 (ms) / GPU bubble ratio: 47.03%
[rank0]:2025-10-27 02:57:19,664 - INFO - Avg. fwd time: 45.3551 / Avg. bwd time: 60.6335 / Avg. batch time: 1979.5958 (ms) / GPU bubble ratio: 57.17%
[rank0]:2025-10-27 02:58:30,217 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-27 02:59:58,185 - INFO -  step: 860  loss: -4.0000  grad_norm:  0.1657  memory: 16.10GiB(33.90%)  tps: 2,041  tflops: 15.96  mfu: 5.11%
[rank0]:2025-10-27 02:59:58,204 - INFO -  step: 860  loss: -4.0000  grad_norm:  0.1657  memory: 20.89GiB(43.97%)  tps: 2,041  tflops: 15.96  mfu: 5.11%
[rank1]:2025-10-27 02:59:58,188 - INFO -  step: 860  loss: -4.0000  grad_norm:  0.1657  memory: 20.03GiB(42.17%)  tps: 2,041  tflops: 15.96  mfu: 5.11%
[rank3]:2025-10-27 02:59:58,197 - INFO -  step: 860  loss:  0.1209  grad_norm:  0.1657  memory: 38.93GiB(81.95%)  tps: 2,041  tflops: 15.96  mfu: 5.11%
[rank3]:2025-10-27 03:00:00,031 - INFO - Avg. fwd time: 72.1635 / Avg. bwd time: 130.9928 / Avg. batch time: 1672.1628 (ms) / GPU bubble ratio: 2.81%
[rank2]:2025-10-27 03:00:00,092 - INFO - Avg. fwd time: 33.4118 / Avg. bwd time: 54.2507 / Avg. batch time: 1762.0460 (ms) / GPU bubble ratio: 60.20%
[rank1]:2025-10-27 03:00:00,167 - INFO - Avg. fwd time: 50.4842 / Avg. bwd time: 74.0693 / Avg. batch time: 1881.1454 (ms) / GPU bubble ratio: 47.03%
[rank0]:2025-10-27 03:00:00,235 - INFO - Avg. fwd time: 45.3434 / Avg. bwd time: 60.6377 / Avg. batch time: 1979.7398 (ms) / GPU bubble ratio: 57.17%
[rank0]:2025-10-27 03:02:39,437 - INFO -  step: 880  loss: -4.0000  grad_norm:  0.1912  memory: 20.89GiB(43.97%)  tps: 2,032  tflops: 15.89  mfu: 5.09%
[rank1]:2025-10-27 03:02:39,426 - INFO -  step: 880  loss: -4.0000  grad_norm:  0.1912  memory: 20.03GiB(42.17%)  tps: 2,032  tflops: 15.89  mfu: 5.09%
[rank3]:2025-10-27 03:02:39,434 - INFO -  step: 880  loss:  0.1022  grad_norm:  0.1912  memory: 38.93GiB(81.95%)  tps: 2,032  tflops: 15.89  mfu: 5.09%
[rank2]:2025-10-27 03:02:39,422 - INFO -  step: 880  loss: -4.0000  grad_norm:  0.1912  memory: 16.10GiB(33.90%)  tps: 2,032  tflops: 15.89  mfu: 5.09%
[rank3]:2025-10-27 03:02:41,289 - INFO - Avg. fwd time: 72.1818 / Avg. bwd time: 131.0109 / Avg. batch time: 1672.4555 (ms) / GPU bubble ratio: 2.81%
[rank2]:2025-10-27 03:02:41,354 - INFO - Avg. fwd time: 33.4192 / Avg. bwd time: 54.2556 / Avg. batch time: 1762.3425 (ms) / GPU bubble ratio: 60.20%
[rank1]:2025-10-27 03:02:41,430 - INFO - Avg. fwd time: 50.4828 / Avg. bwd time: 74.0598 / Avg. batch time: 1881.4505 (ms) / GPU bubble ratio: 47.04%
[rank0]:2025-10-27 03:02:41,496 - INFO - Avg. fwd time: 45.3515 / Avg. bwd time: 60.6435 / Avg. batch time: 1980.0691 (ms) / GPU bubble ratio: 57.18%
[rank0]:2025-10-27 03:05:11,599 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-27 03:05:19,514 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.1812  memory: 16.10GiB(33.90%)  tps: 2,047  tflops: 16.00  mfu: 5.13%
[rank2]:2025-10-27 03:05:19,515 - INFO - ðŸ”Ž  Running validation at step 900
[rank0]:2025-10-27 03:05:19,536 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.1812  memory: 20.89GiB(43.97%)  tps: 2,047  tflops: 16.00  mfu: 5.13%
[rank0]:2025-10-27 03:05:19,537 - INFO - ðŸ”Ž  Running validation at step 900
[rank3]:2025-10-27 03:05:19,527 - INFO -  step: 900  loss:  0.1221  grad_norm:  0.1812  memory: 38.93GiB(81.95%)  tps: 2,047  tflops: 16.00  mfu: 5.13%
[rank3]:2025-10-27 03:05:19,527 - INFO - ðŸ”Ž  Running validation at step 900
[rank1]:2025-10-27 03:05:19,518 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.1812  memory: 20.03GiB(42.17%)  tps: 2,047  tflops: 16.00  mfu: 5.13%
[rank1]:2025-10-27 03:05:19,518 - INFO - ðŸ”Ž  Running validation at step 900
[rank0]:2025-10-27 03:05:40,594 - INFO - validate step: 900  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,836
[rank1]:2025-10-27 03:05:40,673 - INFO - validate step: 900  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,809
[rank2]:2025-10-27 03:05:40,755 - INFO - validate step: 900  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,785
[rank3]:2025-10-27 03:05:40,841 - INFO - validate step: 900  loss:  0.3037  memory: 38.93GiB(81.95%)  tps: 5,765
[rank3]:2025-10-27 03:05:41,052 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1026_GPipe_nofreeze_dm1/pipeline_schedule/251027_0305_real_step900_rank3.svg
[rank3]:> Batch Time: 1927.80 ms, GPU Bubble Ratio: 55.91%, 47.75%, 63.96%, 15.32%
[rank3]:2025-10-27 03:05:42,728 - INFO - Avg. fwd time: 72.1758 / Avg. bwd time: 131.0112 / Avg. batch time: 1672.4116 (ms) / GPU bubble ratio: 2.81%
[rank2]:2025-10-27 03:05:42,790 - INFO - Avg. fwd time: 33.4144 / Avg. bwd time: 54.2605 / Avg. batch time: 1762.3298 (ms) / GPU bubble ratio: 60.20%
[rank1]:2025-10-27 03:05:42,875 - INFO - Avg. fwd time: 50.4946 / Avg. bwd time: 74.0572 / Avg. batch time: 1881.4340 (ms) / GPU bubble ratio: 47.04%
[rank0]:2025-10-27 03:05:42,943 - INFO - Avg. fwd time: 45.3596 / Avg. bwd time: 60.6444 / Avg. batch time: 1980.0642 (ms) / GPU bubble ratio: 57.17%
[rank2]:2025-10-27 03:08:20,937 - INFO -  step: 920  loss: -4.0000  grad_norm:  0.1364  memory: 16.10GiB(33.90%)  tps: 2,046  tflops: 15.99  mfu: 5.13%
[rank0]:2025-10-27 03:08:20,957 - INFO -  step: 920  loss: -4.0000  grad_norm:  0.1364  memory: 20.89GiB(43.97%)  tps: 2,043  tflops: 15.97  mfu: 5.12%
[rank1]:2025-10-27 03:08:20,942 - INFO -  step: 920  loss: -4.0000  grad_norm:  0.1364  memory: 20.03GiB(42.17%)  tps: 2,045  tflops: 15.98  mfu: 5.12%
[rank3]:2025-10-27 03:08:20,949 - INFO -  step: 920  loss:  0.1264  grad_norm:  0.1364  memory: 38.93GiB(81.95%)  tps: 2,047  tflops: 16.00  mfu: 5.13%
[rank3]:2025-10-27 03:08:22,756 - INFO - Avg. fwd time: 72.1604 / Avg. bwd time: 131.0167 / Avg. batch time: 1672.3608 (ms) / GPU bubble ratio: 2.81%
[rank2]:2025-10-27 03:08:22,817 - INFO - Avg. fwd time: 33.4119 / Avg. bwd time: 54.2656 / Avg. batch time: 1762.2744 (ms) / GPU bubble ratio: 60.20%
[rank1]:2025-10-27 03:08:22,893 - INFO - Avg. fwd time: 50.5186 / Avg. bwd time: 74.0631 / Avg. batch time: 1881.3966 (ms) / GPU bubble ratio: 47.03%
[rank0]:2025-10-27 03:08:22,959 - INFO - Avg. fwd time: 45.3684 / Avg. bwd time: 60.6496 / Avg. batch time: 1980.0279 (ms) / GPU bubble ratio: 57.17%
[rank1]:2025-10-27 03:11:01,618 - INFO -  step: 940  loss: -4.0000  grad_norm:  0.1660  memory: 20.03GiB(42.17%)  tps: 2,039  tflops: 15.94  mfu: 5.11%
[rank3]:2025-10-27 03:11:01,622 - INFO -  step: 940  loss:  0.1050  grad_norm:  0.1660  memory: 38.93GiB(81.95%)  tps: 2,039  tflops: 15.94  mfu: 5.11%
[rank2]:2025-10-27 03:11:01,609 - INFO -  step: 940  loss: -4.0000  grad_norm:  0.1660  memory: 16.10GiB(33.90%)  tps: 2,039  tflops: 15.94  mfu: 5.11%
[rank0]:2025-10-27 03:11:01,633 - INFO -  step: 940  loss: -4.0000  grad_norm:  0.1660  memory: 20.89GiB(43.97%)  tps: 2,039  tflops: 15.94  mfu: 5.11%
[rank3]:2025-10-27 03:11:03,458 - INFO - Avg. fwd time: 72.1688 / Avg. bwd time: 131.0250 / Avg. batch time: 1672.4818 (ms) / GPU bubble ratio: 2.81%
[rank2]:2025-10-27 03:11:03,525 - INFO - Avg. fwd time: 33.4120 / Avg. bwd time: 54.2682 / Avg. batch time: 1762.3981 (ms) / GPU bubble ratio: 60.20%
[rank1]:2025-10-27 03:11:03,600 - INFO - Avg. fwd time: 50.5265 / Avg. bwd time: 74.0588 / Avg. batch time: 1881.5244 (ms) / GPU bubble ratio: 47.03%
[rank0]:2025-10-27 03:11:03,668 - INFO - Avg. fwd time: 45.3775 / Avg. bwd time: 60.6548 / Avg. batch time: 1980.1795 (ms) / GPU bubble ratio: 57.16%
[rank0]:2025-10-27 03:12:14,003 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-27 03:13:42,649 - INFO -  step: 960  loss: -4.0000  grad_norm:  0.2039  memory: 16.10GiB(33.90%)  tps: 2,035  tflops: 15.91  mfu: 5.10%
[rank0]:2025-10-27 03:13:42,674 - INFO -  step: 960  loss: -4.0000  grad_norm:  0.2039  memory: 20.89GiB(43.97%)  tps: 2,035  tflops: 15.91  mfu: 5.10%
[rank1]:2025-10-27 03:13:42,653 - INFO -  step: 960  loss: -4.0000  grad_norm:  0.2039  memory: 20.03GiB(42.17%)  tps: 2,035  tflops: 15.91  mfu: 5.10%
[rank3]:2025-10-27 03:13:42,662 - INFO -  step: 960  loss:  0.0907  grad_norm:  0.2039  memory: 38.93GiB(81.95%)  tps: 2,035  tflops: 15.91  mfu: 5.10%
[rank3]:2025-10-27 03:13:44,517 - INFO - Avg. fwd time: 72.1785 / Avg. bwd time: 131.0380 / Avg. batch time: 1672.6693 (ms) / GPU bubble ratio: 2.81%
[rank2]:2025-10-27 03:13:44,582 - INFO - Avg. fwd time: 33.4200 / Avg. bwd time: 54.2841 / Avg. batch time: 1762.5943 (ms) / GPU bubble ratio: 60.19%
[rank0]:2025-10-27 03:13:44,727 - INFO - Avg. fwd time: 45.3910 / Avg. bwd time: 60.6590 / Avg. batch time: 1980.4139 (ms) / GPU bubble ratio: 57.16%
[rank1]:2025-10-27 03:13:44,658 - INFO - Avg. fwd time: 50.5272 / Avg. bwd time: 74.0586 / Avg. batch time: 1881.7380 (ms) / GPU bubble ratio: 47.03%
[rank2]:2025-10-27 03:16:22,769 - INFO -  step: 980  loss: -4.0000  grad_norm:  0.1672  memory: 16.10GiB(33.90%)  tps: 2,046  tflops: 16.00  mfu: 5.13%
[rank0]:2025-10-27 03:16:22,787 - INFO -  step: 980  loss: -4.0000  grad_norm:  0.1672  memory: 20.89GiB(43.97%)  tps: 2,047  tflops: 16.00  mfu: 5.13%
[rank1]:2025-10-27 03:16:22,772 - INFO -  step: 980  loss: -4.0000  grad_norm:  0.1672  memory: 20.03GiB(42.17%)  tps: 2,046  tflops: 16.00  mfu: 5.13%
[rank3]:2025-10-27 03:16:22,781 - INFO -  step: 980  loss:  0.0983  grad_norm:  0.1672  memory: 38.93GiB(81.95%)  tps: 2,047  tflops: 16.00  mfu: 5.13%
[rank3]:2025-10-27 03:16:24,572 - INFO - Avg. fwd time: 72.1731 / Avg. bwd time: 131.0359 / Avg. batch time: 1672.6183 (ms) / GPU bubble ratio: 2.81%
[rank2]:2025-10-27 03:16:24,638 - INFO - Avg. fwd time: 33.4217 / Avg. bwd time: 54.2871 / Avg. batch time: 1762.5424 (ms) / GPU bubble ratio: 60.19%
[rank1]:2025-10-27 03:16:24,722 - INFO - Avg. fwd time: 50.5270 / Avg. bwd time: 74.0575 / Avg. batch time: 1881.6964 (ms) / GPU bubble ratio: 47.03%
[rank0]:2025-10-27 03:16:24,789 - INFO - Avg. fwd time: 45.3902 / Avg. bwd time: 60.6668 / Avg. batch time: 1980.3833 (ms) / GPU bubble ratio: 57.16%
[rank0]:2025-10-27 03:18:54,881 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-27 03:19:02,879 - INFO -  step: 1000  loss:  0.1069  grad_norm:  0.1169  memory: 38.93GiB(81.95%)  tps: 2,047  tflops: 16.00  mfu: 5.13%
[rank3]:2025-10-27 03:19:02,880 - INFO -  final step: 1000  loss:  0.1069  grad_norm:  0.1169  tps: 2,082  tflops: 16.28  mfu: 5.06%
[rank3]:2025-10-27 03:19:02,880 - INFO - ðŸ”Ž  Running validation at step 1000
[rank2]:2025-10-27 03:19:02,866 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.1169  memory: 16.10GiB(33.90%)  tps: 2,047  tflops: 16.00  mfu: 5.13%
[rank2]:2025-10-27 03:19:02,867 - INFO -  final step: 1000  loss: -4.0000  grad_norm:  0.1169  tps: 2,082  tflops: 16.27  mfu: 5.06%
[rank2]:2025-10-27 03:19:02,867 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-10-27 03:19:02,886 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.1169  memory: 20.89GiB(43.97%)  tps: 2,047  tflops: 16.00  mfu: 5.13%
[rank0]:2025-10-27 03:19:02,886 - INFO -  final step: 1000  loss: -4.0000  grad_norm:  0.1169  tps: 2,081  tflops: 16.27  mfu: 5.06%
[rank0]:2025-10-27 03:19:02,886 - INFO - ðŸ”Ž  Running validation at step 1000
[rank1]:2025-10-27 03:19:02,870 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.1169  memory: 20.03GiB(42.17%)  tps: 2,047  tflops: 16.00  mfu: 5.13%
[rank1]:2025-10-27 03:19:02,870 - INFO -  final step: 1000  loss: -4.0000  grad_norm:  0.1169  tps: 2,081  tflops: 16.27  mfu: 5.06%
[rank1]:2025-10-27 03:19:02,870 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-10-27 03:19:24,224 - INFO - validate step: 1000  loss: -1.0000  memory: 20.89GiB(43.97%)  tps: 5,759
[rank0]:2025-10-27 03:19:24,224 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-27 03:19:24,226 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1000.
[rank1]:2025-10-27 03:19:24,304 - INFO - validate step: 1000  loss: -1.0000  memory: 20.03GiB(42.17%)  tps: 5,733
[rank1]:2025-10-27 03:19:24,305 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-27 03:19:24,306 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1000.
[rank2]:2025-10-27 03:19:24,386 - INFO - validate step: 1000  loss: -1.0000  memory: 16.10GiB(33.90%)  tps: 5,710
[rank2]:2025-10-27 03:19:24,387 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-27 03:19:24,389 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1000.
[rank3]:2025-10-27 03:19:24,473 - INFO - validate step: 1000  loss:  0.2997  memory: 38.93GiB(81.95%)  tps: 5,691
[rank3]:2025-10-27 03:19:24,474 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-27 03:19:24,476 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1000.
[rank2]:2025-10-27 03:19:26,926 - INFO - Destroying the purge thread.
[rank0]:2025-10-27 03:19:26,912 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-27 03:19:26,927 - INFO - Sleeping 2 seconds for other ranks to complete
[rank1]:2025-10-27 03:19:26,926 - INFO - Destroying the purge thread.
[rank3]:2025-10-27 03:19:27,124 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1026_GPipe_nofreeze_dm1/pipeline_schedule/251027_0319_real_final1000_rank3.svg
[rank3]:> Batch Time: 1928.05 ms, GPU Bubble Ratio: 55.88%, 47.75%, 63.95%, 15.33%
[rank3]:2025-10-27 03:19:27,323 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1026_GPipe_nofreeze_dm1/pipeline_schedule/251027_0319_thry_final1000_rank3.svg
[rank3]:> Batch Time: 1671.16 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:2025-10-27 03:19:27,324 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank2]:2025-10-27 03:19:27,751 - INFO - Process group destroyed
[rank1]:2025-10-27 03:19:27,747 - INFO - Process group destroyed
[rank3]:wandb: uploading history steps 50-50, summary, console lines 330-337
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ƒâ–ˆâ–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ƒâ–ˆâ–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 7.8676
[rank3]:wandb:               final/avg_loss 0.10689
[rank3]:wandb:             final/avg_mfu(%) 5.06305
[rank3]:wandb:             final/avg_tflops 16.27975
[rank3]:wandb:    final/avg_throughput(tps) 2082.4646
[rank3]:wandb:              final/grad_norm 0.11694
[rank3]:wandb:               final/max_loss 0.10689
[rank3]:wandb:                    grad_norm 0.11694
[rank3]:wandb: loss_metrics/global_avg_loss 0.10689
[rank3]:wandb: loss_metrics/global_max_loss 0.10689
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1026_GPipe_nofreeze_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/3gf4m5a2
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data3/shcho/torchtitan/tb/1026_GPipe_nofreeze_dm1/20251027-0102/wandb/run-20251027_010202-3gf4m5a2/logs
[rank3]:2025-10-27 03:19:28,790 - INFO - Process group destroyed
[rank0]:2025-10-27 03:19:28,927 - INFO - Training completed
[rank0]:2025-10-27 03:19:28,928 - INFO - Destroying the purge thread.
[rank0]:2025-10-27 03:19:29,580 - INFO - Process group destroyed
[rank1]:Stage 1: Modules to keep: {'layers.4', 'layers.5', 'layers.8', 'layers.7', 'layers.6'}
[rank2]:Stage 2: Modules to keep: {'layers.12', 'layers.9', 'layers.10', 'layers.11'}
[rank0]:Stage 0: Modules to keep: {'layers.0', 'layers.3', 'layers.2', 'tok_embeddings', 'layers.1'}
[rank3]:Stage 3: Modules to keep: {'layers.13', 'layers.15', 'layers.14', 'norm', 'output'}
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1026_llama1b/config.toml
[rank3]:		- dump_folder: /data3/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment, without streaming mode, sample-level with truncation"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1026_GPipe_nofreeze_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data3/shcho/torchtitan/profile_trace/1026_GPipe_nofreeze_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data3/shcho/torchtitan/memory_snapshot/1026_GPipe_nofreeze_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 20
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data3/shcho/torchtitan/tb/1026_GPipe_nofreeze_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data3/shcho/torchtitan/images/1026_GPipe_nofreeze_dm1
[rank3]:		- pplog_freq: 80
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1026_GPipe_nofreeze_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B-Instruct
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 2e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: alpaca
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 1000
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: GPipe
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data3/shcho/torchtitan/checkpoint/1026_GPipe_nofreeze_dm1
[rank3]:		- interval: 500
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B-Instruct/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data3/shcho/torchtitan/comm_traces/1026_GPipe_nofreeze_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: True
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- seq_len: 1024
[rank3]:		- freq: 100
[rank3]:		- steps: 30
[rank3]:	- freezing:
[rank3]:		- freeze: False
[rank3]:		- metric_type: apf
[rank3]:		- phase_unit: 10
[rank3]:		- stability_check_freq: 5
[rank3]:		- aggressiveness: 0
[rank3]:
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
