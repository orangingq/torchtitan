
üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•
‚úîÔ∏èCurrent Timestamp: 2025. 10. 28. (Ìôî) 22:56:47 KST
‚úîÔ∏èSERVER: dmserver1 (143.248.135.95),  GPUs: 3,4,5,6
‚úîÔ∏èSCRIPT: /home/shcho/torchtitan/logs/dmserver1/1026_llama1b/run.sh
‚úîÔ∏èOUTPUT: /home/shcho/torchtitan/logs/dmserver1/1026_llama1b/1028_Interleaved1F1B_nofreeze.log
‚úîÔ∏èMain Table Experiment, without streaming mode, sample-level with truncation, 2 epochs
‚úîÔ∏èRunning with nofreeze x Interleaved1F1B ... 
‚òëÔ∏è> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1026_llama1b/config.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs" --parallelism.pipeline_parallel_degree=4  --freezing.no-freeze
üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•
[rank0]:2025-10-28 22:56:53,818 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs"
[rank1]:2025-10-28 22:56:53,897 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs"
[rank3]:2025-10-28 22:56:53,834 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs"
[rank2]:2025-10-28 22:56:54,072 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs"
[rank0]:2025-10-28 22:56:54,499 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-10-28 22:56:54,501 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-28 22:56:54,505 - INFO - [GC] Initial GC collection 0.00 seconds
[rank1]:2025-10-28 22:56:54,461 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-10-28 22:56:54,464 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-10-28 22:56:54,476 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-10-28 22:56:54,478 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-10-28 22:56:54,487 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-10-28 22:56:54,489 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-28 22:56:54,907 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-10-28 22:56:55,302 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank0]:2025-10-28 22:56:58,064 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=512, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank0]:2025-10-28 22:56:58,212 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-10-28 22:56:58,252 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-10-28 22:56:58,254 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-10-28 22:56:58,277 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1']
[rank0]:2025-10-28 22:56:58,290 - INFO - PP rank 0 is building stage_idx 4 with modules ['layers.9', 'layers.10']
[rank0]:2025-10-28 22:56:58,291 - INFO - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank1]:2025-10-28 22:56:58,413 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-10-28 22:56:58,366 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-10-28 22:56:58,406 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-10-28 22:56:58,439 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-10-28 22:56:58,464 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.2', 'layers.3', 'layers.4']
[rank1]:2025-10-28 22:56:58,477 - INFO - PP rank 1 is building stage_idx 5 with modules ['layers.11', 'layers.12']
[rank1]:2025-10-28 22:56:58,478 - INFO - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank0]:2025-10-28 22:56:58,469 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-10-28 22:56:58,469 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-10-28 22:56:58,470 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank2]:2025-10-28 22:56:58,435 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.5', 'layers.6']
[rank2]:2025-10-28 22:56:58,448 - INFO - PP rank 2 is building stage_idx 6 with modules ['layers.13', 'layers.14']
[rank2]:2025-10-28 22:56:58,449 - INFO - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank1]:2025-10-28 22:56:58,668 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-10-28 22:56:58,669 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-10-28 22:56:58,669 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank2]:2025-10-28 22:56:58,640 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-10-28 22:56:58,640 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-10-28 22:56:58,641 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run 41xczmfh
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data3/shcho/torchtitan/tb/1028_Interleaved1F1B_nofreeze_dm1/20251028-2256/wandb/run-20251028_225659-41xczmfh
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1028_Interleaved1F1B_nofreeze_dm1
[rank3]:wandb: ‚≠êÔ∏è View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: üöÄ View run at https://wandb.ai/orangingq/torchtitan/runs/41xczmfh
[rank3]:2025-10-28 22:57:00,405 - INFO - WandB logging enabled
[rank3]:2025-10-28 22:57:00,406 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-10-28 22:57:00,446 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-10-28 22:57:00,476 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.7', 'layers.8']
[rank3]:2025-10-28 22:57:00,490 - INFO - PP rank 3 is building stage_idx 7 with modules ['layers.15', 'norm', 'output']
[rank3]:2025-10-28 22:57:00,492 - INFO - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank0]:2025-10-28 22:57:00,692 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data3/shcho/torchtitan/checkpoint/1028_Interleaved1F1B_nofreeze_dm1
[rank0]:2025-10-28 22:57:00,692 - WARNING - Mixed precision training with TP or PP is only supported when FSDP/HSDP/CP is enabled.
[rank0]:2025-10-28 22:57:00,692 - INFO - Mixed precision training is disabled
[rank0]:2025-10-28 22:57:00,692 - INFO - Preparing c4_validation dataset from allenai/c4
[rank3]:2025-10-28 22:57:00,676 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-10-28 22:57:00,677 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-10-28 22:57:00,678 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank0]:2025-10-28 22:57:05,591 - INFO - Trainer is initialized with local batch size 32, global batch size 64, gradient accumulation steps 2, sequence length 512, total steps 1600 (warmup 100)
[rank0]:2025-10-28 22:57:05,591 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B-Instruct/original_dcp.
[rank0]:2025-10-28 22:57:08,939 - INFO - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-10-28 22:57:08,939 - INFO - Finished loading the checkpoint in 3.35 seconds.
[rank0]:2025-10-28 22:57:08,939 - INFO - Training starts at step 1
[rank0]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/autograd/graph.py:849: UserWarning: Attempting to run cuBLAS, but there was no current CUDA context! Attempting to set the primary context... (Triggered internally at /pytorch/aten/src/ATen/cuda/CublasHandlePool.cpp:270.)
[rank0]:  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
[rank2]:2025-10-28 22:57:17,273 - INFO -  step:  1  loss: -2.0000  grad_norm: 95.1855  memory:  7.99GiB(16.83%)  tps: 434  tflops: 3.31  mfu: 1.06%
[rank2]:2025-10-28 22:57:17,274 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-10-28 22:57:17,306 - INFO -  step:  1  loss: -2.0000  grad_norm: 95.1855  memory: 13.74GiB(28.92%)  tps: 430  tflops: 3.27  mfu: 1.05%
[rank0]:2025-10-28 22:57:17,307 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-28 22:57:17,284 - INFO -  step:  1  loss:  9.0107  grad_norm: 95.1855  memory: 23.89GiB(50.29%)  tps: 487  tflops: 3.71  mfu: 1.19%
[rank3]:2025-10-28 22:57:17,285 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-10-28 22:57:17,276 - INFO -  step:  1  loss: -2.0000  grad_norm: 95.1855  memory: 12.88GiB(27.11%)  tps: 435  tflops: 3.31  mfu: 1.06%
[rank1]:2025-10-28 22:57:17,277 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-28 22:57:35,265 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 22:57:35,266 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 22:57:35,266 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 22:57:35,267 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 22:57:35,267 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 22:57:35,267 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 22:57:35,267 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 22:57:35,268 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 22:57:35,268 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 22:57:35,268 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 22:57:35,268 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 22:57:35,269 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 22:57:35,269 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 22:57:35,269 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 22:57:35,269 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 22:57:35,269 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 22:57:35,270 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 22:57:35,270 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 22:57:35,270 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 22:57:35,270 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 22:57:35,271 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 22:57:35,271 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 22:57:35,271 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 22:57:35,271 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 22:57:35,272 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 22:57:35,272 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 22:57:35,272 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 22:57:35,272 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 22:57:35,273 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 22:57:35,273 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 22:57:35,273 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 22:57:35,273 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 22:57:35,317 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 22:57:35,318 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 22:57:35,318 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 22:57:35,318 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 22:57:35,318 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 22:57:35,318 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 22:57:35,318 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 22:57:35,318 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 22:57:35,318 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 22:57:35,318 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 22:57:35,318 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 22:57:35,318 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 22:57:35,318 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 22:57:35,318 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 22:57:35,318 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 22:57:35,318 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 22:57:35,318 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 22:57:35,318 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 22:57:35,318 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 22:57:35,318 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 22:57:35,318 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 22:57:35,318 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 22:57:35,319 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 22:57:35,319 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 22:57:35,319 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 22:57:35,319 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 22:57:35,319 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 22:57:35,319 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 22:57:35,319 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 22:57:35,319 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 22:57:35,319 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 22:57:35,319 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 22:57:35,383 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 22:57:35,383 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 22:57:35,383 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 22:57:35,383 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 22:57:35,383 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 22:57:35,383 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 22:57:35,383 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 22:57:35,383 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 22:57:35,383 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 22:57:35,383 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 22:57:35,383 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 22:57:35,383 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 22:57:35,383 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 22:57:35,383 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 22:57:35,384 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 22:57:35,384 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 22:57:35,384 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 22:57:35,384 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 22:57:35,384 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 22:57:35,384 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 22:57:35,384 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 22:57:35,384 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 22:57:35,384 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 22:57:35,384 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 22:57:35,384 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 22:57:35,384 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 22:57:35,384 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 22:57:35,384 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 22:57:35,384 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 22:57:35,384 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 22:57:35,384 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 22:57:35,384 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 22:57:35,419 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 22:57:35,419 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 22:57:35,419 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 22:57:35,419 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 22:57:35,419 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 22:57:35,419 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 22:57:35,419 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 22:57:35,419 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 22:57:35,419 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 22:57:35,419 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 22:57:35,419 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 22:57:35,419 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 22:57:35,419 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 22:57:35,419 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 22:57:35,419 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 22:57:35,419 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 22:57:35,420 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 22:57:35,420 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 22:57:35,420 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 22:57:35,420 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 22:57:35,420 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 22:57:35,420 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 22:57:35,420 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 22:57:35,420 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 22:57:35,420 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 22:57:35,420 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 22:57:35,420 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 22:57:35,420 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 22:57:35,420 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 22:57:35,420 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 22:57:35,420 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 22:57:35,420 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 22:58:34,787 - INFO -  step: 20  loss: 10.8312  grad_norm: 60.8071  memory: 26.71GiB(56.21%)  tps: 2,008  tflops: 15.30  mfu: 4.90%
[rank2]:2025-10-28 22:58:34,775 - INFO -  step: 20  loss: -2.0000  grad_norm: 60.8071  memory:  9.81GiB(20.65%)  tps: 2,008  tflops: 15.30  mfu: 4.90%
[rank1]:2025-10-28 22:58:34,779 - INFO -  step: 20  loss: -2.0000  grad_norm: 60.8071  memory: 15.15GiB(31.88%)  tps: 2,008  tflops: 15.30  mfu: 4.90%
[rank0]:2025-10-28 22:58:34,791 - INFO -  step: 20  loss: -2.0000  grad_norm: 60.8071  memory: 17.51GiB(36.85%)  tps: 2,009  tflops: 15.30  mfu: 4.90%
[rank3]:2025-10-28 22:59:57,213 - INFO -  step: 40  loss:  5.6632  grad_norm: 41.4154  memory: 26.71GiB(56.21%)  tps: 1,988  tflops: 15.14  mfu: 4.85%
[rank2]:2025-10-28 22:59:57,201 - INFO -  step: 40  loss: -2.0000  grad_norm: 41.4154  memory:  9.81GiB(20.65%)  tps: 1,988  tflops: 15.14  mfu: 4.85%
[rank1]:2025-10-28 22:59:57,204 - INFO -  step: 40  loss: -2.0000  grad_norm: 41.4154  memory: 15.15GiB(31.88%)  tps: 1,988  tflops: 15.14  mfu: 4.85%
[rank0]:2025-10-28 22:59:57,219 - INFO -  step: 40  loss: -2.0000  grad_norm: 41.4154  memory: 17.51GiB(36.85%)  tps: 1,988  tflops: 15.14  mfu: 4.85%
[rank3]:2025-10-28 22:59:59,120 - INFO - Avg. fwd time: 31.4977 / Avg. bwd time: 66.5746 / Avg. batch time: 1798.6466 (ms) / GPU bubble ratio: 12.76%
[rank2]:2025-10-28 22:59:59,173 - INFO - Avg. fwd time: 16.1711 / Avg. bwd time: 26.6522 / Avg. batch time: 1867.8563 (ms) / GPU bubble ratio: 63.32%
[rank1]:2025-10-28 22:59:59,248 - INFO - Avg. fwd time: 21.2422 / Avg. bwd time: 38.4632 / Avg. batch time: 1967.2941 (ms) / GPU bubble ratio: 51.44%
[rank0]:2025-10-28 22:59:59,284 - INFO - Avg. fwd time: 18.0596 / Avg. bwd time: 29.5433 / Avg. batch time: 2019.5166 (ms) / GPU bubble ratio: 62.29%
[rank0]:2025-10-28 23:00:34,337 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-28 23:01:19,436 - INFO -  step: 60  loss: -2.0000  grad_norm: 31.8143  memory:  9.81GiB(20.65%)  tps: 1,992  tflops: 15.17  mfu: 4.86%
[rank0]:2025-10-28 23:01:19,454 - INFO -  step: 60  loss: -2.0000  grad_norm: 31.8143  memory: 17.51GiB(36.85%)  tps: 1,992  tflops: 15.17  mfu: 4.86%
[rank1]:2025-10-28 23:01:19,441 - INFO -  step: 60  loss: -2.0000  grad_norm: 31.8143  memory: 15.15GiB(31.88%)  tps: 1,992  tflops: 15.17  mfu: 4.86%
[rank3]:2025-10-28 23:01:19,448 - INFO -  step: 60  loss:  8.4741  grad_norm: 31.8143  memory: 26.71GiB(56.21%)  tps: 1,992  tflops: 15.17  mfu: 4.86%
[rank2]:2025-10-28 23:02:41,834 - INFO -  step: 80  loss: -2.0000  grad_norm: 43.1191  memory:  9.81GiB(20.65%)  tps: 1,988  tflops: 15.14  mfu: 4.85%
[rank3]:2025-10-28 23:02:41,846 - INFO -  step: 80  loss:  4.0029  grad_norm: 43.1191  memory: 26.71GiB(56.21%)  tps: 1,988  tflops: 15.14  mfu: 4.85%
[rank0]:2025-10-28 23:02:41,853 - INFO -  step: 80  loss: -2.0000  grad_norm: 43.1191  memory: 17.51GiB(36.85%)  tps: 1,988  tflops: 15.14  mfu: 4.85%
[rank1]:2025-10-28 23:02:41,838 - INFO -  step: 80  loss: -2.0000  grad_norm: 43.1191  memory: 15.15GiB(31.88%)  tps: 1,988  tflops: 15.14  mfu: 4.85%
[rank2]:2025-10-28 23:02:43,826 - INFO - Avg. fwd time: 16.2925 / Avg. bwd time: 26.8370 / Avg. batch time: 1871.5820 (ms) / GPU bubble ratio: 63.13%
[rank3]:2025-10-28 23:02:43,779 - INFO - Avg. fwd time: 31.7914 / Avg. bwd time: 67.1170 / Avg. batch time: 1802.4942 (ms) / GPU bubble ratio: 12.20%
[rank1]:2025-10-28 23:02:43,906 - INFO - Avg. fwd time: 21.4082 / Avg. bwd time: 38.7890 / Avg. batch time: 1971.8350 (ms) / GPU bubble ratio: 51.15%
[rank0]:2025-10-28 23:02:43,942 - INFO - Avg. fwd time: 18.2718 / Avg. bwd time: 29.8385 / Avg. batch time: 2023.9914 (ms) / GPU bubble ratio: 61.97%
[rank0]:2025-10-28 23:04:00,097 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-28 23:04:04,190 - INFO -  step: 100  loss: -2.0000  grad_norm: 56.9073  memory: 15.15GiB(31.88%)  tps: 1,990  tflops: 15.15  mfu: 4.86%
[rank1]:2025-10-28 23:04:04,190 - INFO - üîé  Running validation at step 100
[rank2]:2025-10-28 23:04:04,180 - INFO -  step: 100  loss: -2.0000  grad_norm: 56.9073  memory:  9.81GiB(20.65%)  tps: 1,990  tflops: 15.15  mfu: 4.86%
[rank2]:2025-10-28 23:04:04,180 - INFO - üîé  Running validation at step 100
[rank3]:2025-10-28 23:04:04,192 - INFO -  step: 100  loss:  5.5095  grad_norm: 56.9073  memory: 26.71GiB(56.21%)  tps: 1,990  tflops: 15.15  mfu: 4.86%
[rank3]:2025-10-28 23:04:04,193 - INFO - üîé  Running validation at step 100
[rank0]:2025-10-28 23:04:04,195 - INFO -  step: 100  loss: -2.0000  grad_norm: 56.9073  memory: 17.51GiB(36.85%)  tps: 1,990  tflops: 15.15  mfu: 4.86%
[rank0]:2025-10-28 23:04:04,195 - INFO - üîé  Running validation at step 100
[rank1]:2025-10-28 23:05:28,191 - INFO - validate step: 100  loss: -1.0000  memory: 15.15GiB(31.88%)  tps: 4,876
[rank0]:2025-10-28 23:05:28,176 - INFO - validate step: 100  loss: -1.0000  memory: 17.51GiB(36.85%)  tps: 4,877
[rank2]:2025-10-28 23:05:28,272 - INFO - validate step: 100  loss: -1.0000  memory:  9.81GiB(20.65%)  tps: 4,871
[rank3]:2025-10-28 23:05:28,367 - INFO - validate step: 100  loss:  2.0099  memory: 26.71GiB(56.21%)  tps: 4,866
[rank3]:2025-10-28 23:05:28,713 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_Interleaved1F1B_nofreeze_dm1/pipeline_schedule/251028_2305_real_step100_rank3.svg
[rank3]:> Batch Time: 1816.65 ms, GPU Bubble Ratio: 57.44%, 46.55%, 62.10%, 12.15%

üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•
‚úîÔ∏èCurrent Timestamp: 2025. 10. 28. (Ìôî) 23:33:31 KST
‚úîÔ∏èSERVER: dmserver1 (143.248.135.95),  GPUs: 3,4,5,6
‚úîÔ∏èSCRIPT: /home/shcho/torchtitan/logs/dmserver1/1026_llama1b/run.sh
‚úîÔ∏èOUTPUT: /home/shcho/torchtitan/logs/dmserver1/1026_llama1b/1028_Interleaved1F1B_nofreeze.log
‚úîÔ∏èMain Table Experiment, without streaming mode, sample-level with truncation, 2 epochs
‚úîÔ∏èRunning with nofreeze x Interleaved1F1B ... 
‚òëÔ∏è> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1026_llama1b/config.toml --job.description="Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs" --parallelism.pipeline_parallel_degree=4  --freezing.no-freeze
üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•
[rank1]:2025-10-28 23:33:37,881 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs"
[rank3]:2025-10-28 23:33:37,881 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs"
[rank0]:2025-10-28 23:33:38,016 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs"
[rank1]:2025-10-28 23:33:38,178 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-10-28 23:33:38,180 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-10-28 23:33:38,123 - INFO - Starting job: "Main Table Experiment, without streaming mode, sample-level with truncation, 2 epochs"
[rank3]:2025-10-28 23:33:38,180 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-10-28 23:33:38,182 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-28 23:33:38,240 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-10-28 23:33:38,243 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-28 23:33:38,248 - INFO - [GC] Initial GC collection 0.00 seconds
[rank2]:2025-10-28 23:33:38,337 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-10-28 23:33:38,340 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-28 23:33:39,433 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-10-28 23:33:39,845 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank1]:2025-10-28 23:33:42,777 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-10-28 23:33:42,777 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-10-28 23:33:42,826 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-10-28 23:33:42,828 - INFO - Compiling the loss function with torch.compile
[rank1]:2025-10-28 23:33:42,873 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.2', 'layers.3', 'layers.4']
[rank1]:2025-10-28 23:33:42,892 - INFO - PP rank 1 is building stage_idx 5 with modules ['layers.11', 'layers.12']
[rank1]:2025-10-28 23:33:42,893 - INFO - Compiling each TransformerBlock with torch.compile
[rank1]:2025-10-28 23:33:42,893 - INFO - Compiling each TransformerBlock with torch.compile
[rank1]:2025-10-28 23:33:42,895 - INFO - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank2]:2025-10-28 23:33:42,826 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-10-28 23:33:42,827 - INFO - Compiling the loss function with torch.compile
[rank2]:2025-10-28 23:33:42,873 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.5', 'layers.6']
[rank2]:2025-10-28 23:33:42,884 - INFO - PP rank 2 is building stage_idx 6 with modules ['layers.13', 'layers.14']
[rank2]:2025-10-28 23:33:42,894 - INFO - Compiling each TransformerBlock with torch.compile
[rank2]:2025-10-28 23:33:42,895 - INFO - Compiling each TransformerBlock with torch.compile
[rank2]:2025-10-28 23:33:42,899 - INFO - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank0]:2025-10-28 23:33:42,933 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=512, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank1]:2025-10-28 23:33:43,096 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-10-28 23:33:43,096 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-10-28 23:33:43,096 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank2]:2025-10-28 23:33:43,086 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-10-28 23:33:43,086 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-10-28 23:33:43,087 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank0]:2025-10-28 23:33:43,085 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-10-28 23:33:43,125 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-10-28 23:33:43,126 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-10-28 23:33:43,126 - INFO - Compiling the loss function with torch.compile
[rank0]:2025-10-28 23:33:43,176 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1']
[rank0]:2025-10-28 23:33:43,187 - INFO - PP rank 0 is building stage_idx 4 with modules ['layers.9', 'layers.10']
[rank0]:2025-10-28 23:33:43,188 - INFO - Compiling each TransformerBlock with torch.compile
[rank0]:2025-10-28 23:33:43,189 - INFO - Compiling each TransformerBlock with torch.compile
[rank0]:2025-10-28 23:33:43,190 - INFO - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank0]:2025-10-28 23:33:43,384 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-10-28 23:33:43,385 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-10-28 23:33:43,385 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run 1kcontfv
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data3/shcho/torchtitan/tb/1028_Interleaved1F1B_nofreeze_dm1/20251028-2333/wandb/run-20251028_233343-1kcontfv
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1028_Interleaved1F1B_nofreeze_dm1
[rank3]:wandb: ‚≠êÔ∏è View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: üöÄ View run at https://wandb.ai/orangingq/torchtitan/runs/1kcontfv
[rank3]:2025-10-28 23:33:45,388 - INFO - WandB logging enabled
[rank3]:2025-10-28 23:33:45,389 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-10-28 23:33:45,426 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-10-28 23:33:45,428 - INFO - Compiling the loss function with torch.compile
[rank3]:2025-10-28 23:33:45,485 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.7', 'layers.8']
[rank3]:2025-10-28 23:33:45,498 - INFO - PP rank 3 is building stage_idx 7 with modules ['layers.15', 'norm', 'output']
[rank3]:2025-10-28 23:33:45,500 - INFO - Compiling each TransformerBlock with torch.compile
[rank3]:2025-10-28 23:33:45,501 - INFO - Compiling each TransformerBlock with torch.compile
[rank3]:2025-10-28 23:33:45,502 - INFO - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank3]:2025-10-28 23:33:45,709 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-10-28 23:33:45,709 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-10-28 23:33:45,710 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank1]:2025-10-28 23:33:45,725 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank1]:2025-10-28 23:33:45,725 - INFO - Compiling the loss function with torch.compile
[rank0]:2025-10-28 23:33:45,726 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data3/shcho/torchtitan/checkpoint/1028_Interleaved1F1B_nofreeze_dm1
[rank0]:2025-10-28 23:33:45,726 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-10-28 23:33:45,726 - INFO - Compiling the loss function with torch.compile
[rank0]:2025-10-28 23:33:45,730 - INFO - Preparing c4_validation dataset from allenai/c4
[rank2]:2025-10-28 23:33:45,725 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank2]:2025-10-28 23:33:45,726 - INFO - Compiling the loss function with torch.compile
[rank3]:2025-10-28 23:33:45,725 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-10-28 23:33:45,726 - INFO - Compiling the loss function with torch.compile
[rank0]:2025-10-28 23:33:50,953 - INFO - Trainer is initialized with local batch size 32, global batch size 64, gradient accumulation steps 2, sequence length 512, total steps 1600 (warmup 100)
[rank0]:2025-10-28 23:33:50,953 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B-Instruct/original_dcp.
[rank0]:2025-10-28 23:33:53,852 - INFO - [GC] GC collection for checkpoint loading. 0.01 seconds
[rank0]:2025-10-28 23:33:53,852 - INFO - Finished loading the checkpoint in 2.90 seconds.
[rank0]:2025-10-28 23:33:53,852 - INFO - Training starts at step 1
[rank0]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/_inductor/lowering.py:2132: UserWarning: Torchinductor does not support code generation for complex operators. Performance may be worse than eager.
[rank0]:  warnings.warn(
[rank1]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/_inductor/lowering.py:2132: UserWarning: Torchinductor does not support code generation for complex operators. Performance may be worse than eager.
[rank1]:  warnings.warn(
[rank2]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/_inductor/lowering.py:2132: UserWarning: Torchinductor does not support code generation for complex operators. Performance may be worse than eager.
[rank2]:  warnings.warn(
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/_inductor/lowering.py:2132: UserWarning: Torchinductor does not support code generation for complex operators. Performance may be worse than eager.
[rank3]:  warnings.warn(
[rank1]:2025-10-28 23:34:13,581 - INFO -  step:  1  loss: -2.0000  grad_norm: 93.8559  memory: 10.32GiB(21.72%)  tps: 266  tflops: 2.03  mfu: 0.65%
[rank1]:2025-10-28 23:34:13,582 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-10-28 23:34:13,606 - INFO -  step:  1  loss: -2.0000  grad_norm: 93.8559  memory: 11.57GiB(24.35%)  tps: 269  tflops: 2.05  mfu: 0.66%
[rank0]:2025-10-28 23:34:13,606 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-10-28 23:34:13,571 - INFO -  step:  1  loss: -2.0000  grad_norm: 93.8559  memory:  6.65GiB(13.99%)  tps: 266  tflops: 2.03  mfu: 0.65%
[rank2]:2025-10-28 23:34:13,571 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-28 23:34:13,585 - INFO -  step:  1  loss:  9.0137  grad_norm: 93.8559  memory: 15.08GiB(31.75%)  tps: 291  tflops: 2.22  mfu: 0.71%
[rank3]:2025-10-28 23:34:13,585 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-10-28 23:34:19,456 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 23:34:19,457 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 23:34:19,457 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 23:34:19,457 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 23:34:19,457 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 23:34:19,457 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 23:34:19,457 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 23:34:19,457 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 23:34:19,457 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 23:34:19,457 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 23:34:19,457 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 23:34:19,457 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 23:34:19,457 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 23:34:19,457 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 23:34:19,457 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 23:34:19,457 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 23:34:19,457 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 23:34:19,457 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 23:34:19,457 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 23:34:19,457 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 23:34:19,457 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 23:34:19,457 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 23:34:19,457 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 23:34:19,457 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 23:34:19,458 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 23:34:19,458 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 23:34:19,458 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 23:34:19,458 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 23:34:19,458 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 23:34:19,458 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 23:34:19,458 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 23:34:19,458 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 23:34:19,410 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 23:34:19,411 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 23:34:19,436 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 23:34:19,436 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 23:34:19,436 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 23:34:19,436 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 23:34:19,436 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 23:34:19,436 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 23:34:19,436 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 23:34:19,436 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 23:34:19,436 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 23:34:19,436 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 23:34:19,436 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 23:34:19,436 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 23:34:19,436 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 23:34:19,436 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 23:34:19,436 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 23:34:19,436 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 23:34:19,436 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 23:34:19,436 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 23:34:19,436 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 23:34:19,436 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 23:34:19,437 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 23:34:19,437 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 23:34:19,437 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 23:34:19,437 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 23:34:19,437 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 23:34:19,437 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 23:34:19,437 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 23:34:19,437 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 23:34:19,437 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 23:34:19,437 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 23:34:19,437 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 23:34:19,437 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 23:34:19,411 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 23:34:19,411 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 23:34:19,412 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 23:34:19,412 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 23:34:19,412 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 23:34:19,413 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 23:34:19,413 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 23:34:19,413 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 23:34:19,413 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 23:34:19,414 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 23:34:19,414 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 23:34:19,414 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 23:34:19,415 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 23:34:19,415 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 23:34:19,415 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 23:34:19,416 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 23:34:19,416 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 23:34:19,416 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 23:34:19,416 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 23:34:19,417 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 23:34:19,417 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 23:34:19,417 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 23:34:19,417 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 23:34:19,418 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 23:34:19,418 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 23:34:19,418 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 23:34:19,418 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 23:34:19,419 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 23:34:19,419 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 23:34:19,419 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 23:34:19,475 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 23:34:19,475 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 23:34:19,475 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 23:34:19,475 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 23:34:19,475 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 23:34:19,475 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 23:34:19,475 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 23:34:19,475 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 23:34:19,475 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 23:34:19,475 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 23:34:19,475 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 23:34:19,475 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 23:34:19,475 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 23:34:19,475 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 23:34:19,475 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 23:34:19,476 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 23:34:19,476 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 23:34:19,476 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 23:34:19,476 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 23:34:19,476 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 23:34:19,476 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 23:34:19,476 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 23:34:19,476 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 23:34:19,476 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 23:34:19,476 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 23:34:19,476 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 23:34:19,476 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 23:34:19,476 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 23:34:19,476 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 23:34:19,476 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 23:34:19,476 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 23:34:19,476 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 23:34:36,741 - INFO -  step: 20  loss: -2.0000  grad_norm: 98.8027  memory: 12.59GiB(26.50%)  tps: 6,721  tflops: 51.19  mfu: 16.41%
[rank0]:2025-10-28 23:34:36,752 - INFO -  step: 20  loss: -2.0000  grad_norm: 98.8027  memory: 15.36GiB(32.33%)  tps: 6,725  tflops: 51.22  mfu: 16.42%
[rank2]:2025-10-28 23:34:36,737 - INFO -  step: 20  loss: -2.0000  grad_norm: 98.8027  memory:  8.44GiB(17.77%)  tps: 6,719  tflops: 51.17  mfu: 16.40%
[rank3]:2025-10-28 23:34:36,749 - INFO -  step: 20  loss: 11.5580  grad_norm: 98.8027  memory: 18.50GiB(38.94%)  tps: 6,720  tflops: 51.18  mfu: 16.40%
[rank1]:2025-10-28 23:35:00,607 - INFO -  step: 40  loss: -2.0000  grad_norm: 40.8941  memory: 12.59GiB(26.50%)  tps: 6,865  tflops: 52.29  mfu: 16.76%
[rank0]:2025-10-28 23:35:00,617 - INFO -  step: 40  loss: -2.0000  grad_norm: 40.8941  memory: 15.36GiB(32.33%)  tps: 6,865  tflops: 52.29  mfu: 16.76%
[rank2]:2025-10-28 23:35:00,603 - INFO -  step: 40  loss: -2.0000  grad_norm: 40.8941  memory:  8.44GiB(17.77%)  tps: 6,865  tflops: 52.29  mfu: 16.76%
[rank3]:2025-10-28 23:35:00,615 - INFO -  step: 40  loss:  6.0097  grad_norm: 40.8941  memory: 18.50GiB(38.94%)  tps: 6,866  tflops: 52.29  mfu: 16.76%
[rank1]:2025-10-28 23:35:01,198 - INFO - Avg. fwd time: 5.1464 / Avg. bwd time: 11.9171 / Avg. batch time: 552.2118 (ms) / GPU bubble ratio: 50.56%
[rank0]:2025-10-28 23:35:01,217 - INFO - Avg. fwd time: 4.4255 / Avg. bwd time: 12.2912 / Avg. batch time: 574.6226 (ms) / GPU bubble ratio: 53.45%
[rank2]:2025-10-28 23:35:01,177 - INFO - Avg. fwd time: 4.2058 / Avg. bwd time: 9.6152 / Avg. batch time: 523.8827 (ms) / GPU bubble ratio: 57.79%
[rank3]:2025-10-28 23:35:01,155 - INFO - Avg. fwd time: 7.1406 / Avg. bwd time: 19.2113 / Avg. batch time: 494.3414 (ms) / GPU bubble ratio: 14.71%
[rank0]:2025-10-28 23:35:11,420 - INFO - [GC] Peforming periodical GC collection 0.03 seconds
[rank0]:2025-10-28 23:35:24,527 - INFO -  step: 60  loss: -2.0000  grad_norm: 32.7738  memory: 15.36GiB(32.33%)  tps: 6,853  tflops: 52.19  mfu: 16.73%
[rank1]:2025-10-28 23:35:24,516 - INFO -  step: 60  loss: -2.0000  grad_norm: 32.7738  memory: 12.59GiB(26.50%)  tps: 6,854  tflops: 52.20  mfu: 16.73%
[rank2]:2025-10-28 23:35:24,512 - INFO -  step: 60  loss: -2.0000  grad_norm: 32.7738  memory:  8.44GiB(17.77%)  tps: 6,853  tflops: 52.19  mfu: 16.73%
[rank3]:2025-10-28 23:35:24,528 - INFO -  step: 60  loss:  8.5538  grad_norm: 32.7738  memory: 18.50GiB(38.94%)  tps: 6,852  tflops: 52.19  mfu: 16.73%
[rank0]:2025-10-28 23:35:48,272 - INFO -  step: 80  loss: -2.0000  grad_norm: 42.9004  memory: 15.36GiB(32.33%)  tps: 6,900  tflops: 52.55  mfu: 16.84%
[rank1]:2025-10-28 23:35:48,261 - INFO -  step: 80  loss: -2.0000  grad_norm: 42.9004  memory: 12.59GiB(26.50%)  tps: 6,900  tflops: 52.55  mfu: 16.84%
[rank2]:2025-10-28 23:35:48,257 - INFO -  step: 80  loss: -2.0000  grad_norm: 42.9004  memory:  8.44GiB(17.77%)  tps: 6,900  tflops: 52.55  mfu: 16.84%
[rank3]:2025-10-28 23:35:48,269 - INFO -  step: 80  loss:  4.1076  grad_norm: 42.9004  memory: 18.50GiB(38.94%)  tps: 6,902  tflops: 52.56  mfu: 16.85%
[rank3]:2025-10-28 23:35:48,784 - INFO - Avg. fwd time: 7.1689 / Avg. bwd time: 19.1057 / Avg. batch time: 490.4109 (ms) / GPU bubble ratio: 14.28%
[rank0]:2025-10-28 23:35:48,846 - INFO - Avg. fwd time: 4.4582 / Avg. bwd time: 12.1479 / Avg. batch time: 570.7977 (ms) / GPU bubble ratio: 53.45%
[rank1]:2025-10-28 23:35:48,828 - INFO - Avg. fwd time: 5.1881 / Avg. bwd time: 12.0315 / Avg. batch time: 548.3573 (ms) / GPU bubble ratio: 49.76%
[rank2]:2025-10-28 23:35:48,807 - INFO - Avg. fwd time: 4.2381 / Avg. bwd time: 9.6966 / Avg. batch time: 519.9813 (ms) / GPU bubble ratio: 57.12%
[rank0]:2025-10-28 23:36:11,078 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-28 23:36:12,286 - INFO -  step: 100  loss: -2.0000  grad_norm: 64.8846  memory: 15.36GiB(32.33%)  tps: 6,823  tflops: 51.96  mfu: 16.65%
[rank0]:2025-10-28 23:36:12,286 - INFO - üîé  Running validation at step 100
[rank1]:2025-10-28 23:36:12,275 - INFO -  step: 100  loss: -2.0000  grad_norm: 64.8846  memory: 12.59GiB(26.50%)  tps: 6,823  tflops: 51.96  mfu: 16.66%
[rank1]:2025-10-28 23:36:12,275 - INFO - üîé  Running validation at step 100
[rank2]:2025-10-28 23:36:12,271 - INFO -  step: 100  loss: -2.0000  grad_norm: 64.8846  memory:  8.44GiB(17.77%)  tps: 6,823  tflops: 51.96  mfu: 16.65%
[rank2]:2025-10-28 23:36:12,272 - INFO - üîé  Running validation at step 100
[rank3]:2025-10-28 23:36:12,283 - INFO -  step: 100  loss:  5.9756  grad_norm: 64.8846  memory: 18.50GiB(38.94%)  tps: 6,823  tflops: 51.97  mfu: 16.66%
[rank3]:2025-10-28 23:36:12,284 - INFO - üîé  Running validation at step 100
[rank0]:2025-10-28 23:36:38,899 - INFO - validate step: 100  loss: -1.0000  memory: 15.36GiB(32.33%)  tps: 15,391
[rank1]:2025-10-28 23:36:38,905 - INFO - validate step: 100  loss: -1.0000  memory: 12.59GiB(26.50%)  tps: 15,381
[rank2]:2025-10-28 23:36:38,910 - INFO - validate step: 100  loss: -1.0000  memory:  8.44GiB(17.77%)  tps: 15,377
[rank3]:2025-10-28 23:36:38,899 - INFO - validate step: 100  loss:  2.0769  memory: 18.50GiB(38.94%)  tps: 15,390
[rank3]:2025-10-28 23:36:39,230 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_Interleaved1F1B_nofreeze_dm1/pipeline_schedule/251028_2336_real_step100_rank3.svg
[rank3]:> Batch Time: 481.88 ms, GPU Bubble Ratio: 46.03%, 42.89%, 53.69%, 13.15%
[rank0]:2025-10-28 23:37:03,236 - INFO -  step: 120  loss: -2.0000  grad_norm: 40.0382  memory: 15.36GiB(32.33%)  tps: 6,732  tflops: 51.27  mfu: 16.43%
[rank1]:2025-10-28 23:37:03,225 - INFO -  step: 120  loss: -2.0000  grad_norm: 40.0382  memory: 12.59GiB(26.50%)  tps: 6,737  tflops: 51.31  mfu: 16.45%
[rank2]:2025-10-28 23:37:03,221 - INFO -  step: 120  loss: -2.0000  grad_norm: 40.0382  memory:  8.44GiB(17.77%)  tps: 6,739  tflops: 51.33  mfu: 16.45%
[rank3]:2025-10-28 23:37:03,234 - INFO -  step: 120  loss:  1.8367  grad_norm: 40.0382  memory: 18.50GiB(38.94%)  tps: 6,733  tflops: 51.28  mfu: 16.44%
[rank3]:2025-10-28 23:37:03,774 - INFO - Avg. fwd time: 7.2139 / Avg. bwd time: 19.1422 / Avg. batch time: 490.8568 (ms) / GPU bubble ratio: 14.09%
[rank0]:2025-10-28 23:37:03,838 - INFO - Avg. fwd time: 4.4720 / Avg. bwd time: 12.1000 / Avg. batch time: 572.4997 (ms) / GPU bubble ratio: 53.69%
[rank1]:2025-10-28 23:37:03,819 - INFO - Avg. fwd time: 5.2028 / Avg. bwd time: 12.0710 / Avg. batch time: 550.0293 (ms) / GPU bubble ratio: 49.75%
[rank2]:2025-10-28 23:37:03,798 - INFO - Avg. fwd time: 4.2501 / Avg. bwd time: 9.7254 / Avg. batch time: 521.6156 (ms) / GPU bubble ratio: 57.13%
[rank0]:2025-10-28 23:37:27,466 - INFO -  step: 140  loss: -2.0000  grad_norm: 38.6438  memory: 15.36GiB(32.33%)  tps: 6,762  tflops: 51.50  mfu: 16.51%
[rank1]:2025-10-28 23:37:27,455 - INFO -  step: 140  loss: -2.0000  grad_norm: 38.6438  memory: 12.59GiB(26.50%)  tps: 6,762  tflops: 51.50  mfu: 16.51%
[rank2]:2025-10-28 23:37:27,451 - INFO -  step: 140  loss: -2.0000  grad_norm: 38.6438  memory:  8.44GiB(17.77%)  tps: 6,762  tflops: 51.50  mfu: 16.51%
[rank3]:2025-10-28 23:37:27,463 - INFO -  step: 140  loss:  2.1222  grad_norm: 38.6438  memory: 18.50GiB(38.94%)  tps: 6,762  tflops: 51.50  mfu: 16.51%
[rank0]:2025-10-28 23:37:38,353 - INFO - [GC] Peforming periodical GC collection 0.02 seconds
[rank1]:2025-10-28 23:37:51,672 - INFO -  step: 160  loss: -2.0000  grad_norm: 10.6386  memory: 12.59GiB(26.50%)  tps: 6,766  tflops: 51.53  mfu: 16.52%
[rank0]:2025-10-28 23:37:51,683 - INFO -  step: 160  loss: -2.0000  grad_norm: 10.6386  memory: 15.36GiB(32.33%)  tps: 6,766  tflops: 51.53  mfu: 16.52%
[rank2]:2025-10-28 23:37:51,669 - INFO -  step: 160  loss: -2.0000  grad_norm: 10.6386  memory:  8.44GiB(17.77%)  tps: 6,766  tflops: 51.53  mfu: 16.52%
[rank3]:2025-10-28 23:37:51,681 - INFO -  step: 160  loss:  0.4466  grad_norm: 10.6386  memory: 18.50GiB(38.94%)  tps: 6,766  tflops: 51.53  mfu: 16.52%
[rank2]:2025-10-28 23:37:52,240 - INFO - Avg. fwd time: 4.2538 / Avg. bwd time: 9.7412 / Avg. batch time: 522.6323 (ms) / GPU bubble ratio: 57.16%
[rank3]:2025-10-28 23:37:52,216 - INFO - Avg. fwd time: 7.2636 / Avg. bwd time: 19.2000 / Avg. batch time: 492.1416 (ms) / GPU bubble ratio: 13.96%
[rank1]:2025-10-28 23:37:52,261 - INFO - Avg. fwd time: 5.2084 / Avg. bwd time: 12.0950 / Avg. batch time: 551.0630 (ms) / GPU bubble ratio: 49.76%
[rank0]:2025-10-28 23:37:52,281 - INFO - Avg. fwd time: 4.4793 / Avg. bwd time: 12.0786 / Avg. batch time: 573.5574 (ms) / GPU bubble ratio: 53.81%
[rank1]:2025-10-28 23:38:15,861 - INFO -  step: 180  loss: -2.0000  grad_norm: 24.3207  memory: 12.59GiB(26.50%)  tps: 6,773  tflops: 51.59  mfu: 16.53%
[rank0]:2025-10-28 23:38:15,872 - INFO -  step: 180  loss: -2.0000  grad_norm: 24.3207  memory: 15.36GiB(32.33%)  tps: 6,773  tflops: 51.59  mfu: 16.53%
[rank2]:2025-10-28 23:38:15,858 - INFO -  step: 180  loss: -2.0000  grad_norm: 24.3207  memory:  8.44GiB(17.77%)  tps: 6,773  tflops: 51.59  mfu: 16.53%
[rank3]:2025-10-28 23:38:15,870 - INFO -  step: 180  loss:  0.4316  grad_norm: 24.3207  memory: 18.50GiB(38.94%)  tps: 6,774  tflops: 51.59  mfu: 16.54%
[rank0]:2025-10-28 23:38:38,851 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-28 23:38:40,084 - INFO -  step: 200  loss: -2.0000  grad_norm:  0.9432  memory: 12.59GiB(26.50%)  tps: 6,764  tflops: 51.52  mfu: 16.51%
[rank1]:2025-10-28 23:38:40,085 - INFO - üîé  Running validation at step 200
[rank0]:2025-10-28 23:38:40,095 - INFO -  step: 200  loss: -2.0000  grad_norm:  0.9432  memory: 15.36GiB(32.33%)  tps: 6,764  tflops: 51.52  mfu: 16.51%
[rank0]:2025-10-28 23:38:40,095 - INFO - üîé  Running validation at step 200
[rank2]:2025-10-28 23:38:40,081 - INFO -  step: 200  loss: -2.0000  grad_norm:  0.9432  memory:  8.44GiB(17.77%)  tps: 6,764  tflops: 51.52  mfu: 16.51%
[rank2]:2025-10-28 23:38:40,081 - INFO - üîé  Running validation at step 200
[rank3]:2025-10-28 23:38:40,093 - INFO -  step: 200  loss:  0.2875  grad_norm:  0.9432  memory: 18.50GiB(38.94%)  tps: 6,764  tflops: 51.52  mfu: 16.51%
[rank3]:2025-10-28 23:38:40,094 - INFO - üîé  Running validation at step 200
[rank1]:2025-10-28 23:39:03,918 - INFO - validate step: 200  loss: -1.0000  memory: 12.59GiB(26.50%)  tps: 17,186
[rank2]:2025-10-28 23:39:03,923 - INFO - validate step: 200  loss: -1.0000  memory:  8.44GiB(17.77%)  tps: 17,180
[rank0]:2025-10-28 23:39:03,913 - INFO - validate step: 200  loss: -1.0000  memory: 15.36GiB(32.33%)  tps: 17,198
[rank3]:2025-10-28 23:39:03,911 - INFO - validate step: 200  loss:  0.9515  memory: 18.50GiB(38.94%)  tps: 17,198
[rank3]:2025-10-28 23:39:04,231 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_Interleaved1F1B_nofreeze_dm1/pipeline_schedule/251028_2339_real_step200_rank3.svg
[rank3]:> Batch Time: 486.82 ms, GPU Bubble Ratio: 46.47%, 43.32%, 54.13%, 13.04%
[rank3]:2025-10-28 23:39:04,744 - INFO - Avg. fwd time: 7.2904 / Avg. bwd time: 19.2334 / Avg. batch time: 492.8431 (ms) / GPU bubble ratio: 13.89%
[rank1]:2025-10-28 23:39:04,790 - INFO - Avg. fwd time: 5.2127 / Avg. bwd time: 12.1147 / Avg. batch time: 552.3533 (ms) / GPU bubble ratio: 49.81%
[rank2]:2025-10-28 23:39:04,769 - INFO - Avg. fwd time: 4.2554 / Avg. bwd time: 9.7533 / Avg. batch time: 523.8945 (ms) / GPU bubble ratio: 57.22%
[rank0]:2025-10-28 23:39:04,810 - INFO - Avg. fwd time: 4.4830 / Avg. bwd time: 12.0693 / Avg. batch time: 574.8623 (ms) / GPU bubble ratio: 53.93%
[rank1]:2025-10-28 23:39:28,156 - INFO -  step: 220  loss: -2.0000  grad_norm:  1.0667  memory: 12.59GiB(26.50%)  tps: 6,760  tflops: 51.48  mfu: 16.50%
[rank0]:2025-10-28 23:39:28,167 - INFO -  step: 220  loss: -2.0000  grad_norm:  1.0667  memory: 15.36GiB(32.33%)  tps: 6,755  tflops: 51.45  mfu: 16.49%
[rank2]:2025-10-28 23:39:28,152 - INFO -  step: 220  loss: -2.0000  grad_norm:  1.0667  memory:  8.44GiB(17.77%)  tps: 6,762  tflops: 51.50  mfu: 16.51%
[rank3]:2025-10-28 23:39:28,165 - INFO -  step: 220  loss:  0.2877  grad_norm:  1.0667  memory: 18.50GiB(38.94%)  tps: 6,756  tflops: 51.45  mfu: 16.49%
[rank2]:2025-10-28 23:39:52,097 - INFO -  step: 240  loss: -2.0000  grad_norm:  0.8107  memory:  8.44GiB(17.77%)  tps: 6,843  tflops: 52.12  mfu: 16.70%
[rank3]:2025-10-28 23:39:52,109 - INFO -  step: 240  loss:  0.3168  grad_norm:  0.8107  memory: 18.50GiB(38.94%)  tps: 6,843  tflops: 52.12  mfu: 16.70%
[rank1]:2025-10-28 23:39:52,100 - INFO -  step: 240  loss: -2.0000  grad_norm:  0.8107  memory: 12.59GiB(26.50%)  tps: 6,843  tflops: 52.12  mfu: 16.70%
[rank0]:2025-10-28 23:39:52,111 - INFO -  step: 240  loss: -2.0000  grad_norm:  0.8107  memory: 15.36GiB(32.33%)  tps: 6,843  tflops: 52.12  mfu: 16.70%
[rank1]:2025-10-28 23:39:52,685 - INFO - Avg. fwd time: 5.2157 / Avg. bwd time: 12.1300 / Avg. batch time: 551.5118 (ms) / GPU bubble ratio: 49.68%
[rank2]:2025-10-28 23:39:52,663 - INFO - Avg. fwd time: 4.2566 / Avg. bwd time: 9.7621 / Avg. batch time: 523.0376 (ms) / GPU bubble ratio: 57.12%
[rank3]:2025-10-28 23:39:52,639 - INFO - Avg. fwd time: 7.2820 / Avg. bwd time: 19.2149 / Avg. batch time: 492.2188 (ms) / GPU bubble ratio: 13.87%
[rank0]:2025-10-28 23:39:52,705 - INFO - Avg. fwd time: 4.4856 / Avg. bwd time: 12.0641 / Avg. batch time: 574.0316 (ms) / GPU bubble ratio: 53.87%
[rank0]:2025-10-28 23:40:02,870 - INFO - [GC] Peforming periodical GC collection 0.02 seconds
[rank1]:2025-10-28 23:40:15,984 - INFO -  step: 260  loss: -2.0000  grad_norm:  0.9446  memory: 12.59GiB(26.50%)  tps: 6,860  tflops: 52.25  mfu: 16.75%
[rank0]:2025-10-28 23:40:15,995 - INFO -  step: 260  loss: -2.0000  grad_norm:  0.9446  memory: 15.36GiB(32.33%)  tps: 6,860  tflops: 52.25  mfu: 16.75%
[rank2]:2025-10-28 23:40:15,980 - INFO -  step: 260  loss: -2.0000  grad_norm:  0.9446  memory:  8.44GiB(17.77%)  tps: 6,860  tflops: 52.25  mfu: 16.75%
[rank3]:2025-10-28 23:40:15,996 - INFO -  step: 260  loss:  0.2922  grad_norm:  0.9446  memory: 18.50GiB(38.94%)  tps: 6,859  tflops: 52.24  mfu: 16.74%
[rank1]:2025-10-28 23:40:39,917 - INFO -  step: 280  loss: -2.0000  grad_norm:  0.8945  memory: 12.59GiB(26.50%)  tps: 6,846  tflops: 52.14  mfu: 16.71%
[rank0]:2025-10-28 23:40:39,928 - INFO -  step: 280  loss: -2.0000  grad_norm:  0.8945  memory: 15.36GiB(32.33%)  tps: 6,846  tflops: 52.14  mfu: 16.71%
[rank2]:2025-10-28 23:40:39,913 - INFO -  step: 280  loss: -2.0000  grad_norm:  0.8945  memory:  8.44GiB(17.77%)  tps: 6,846  tflops: 52.14  mfu: 16.71%
[rank3]:2025-10-28 23:40:39,926 - INFO -  step: 280  loss:  0.2732  grad_norm:  0.8945  memory: 18.50GiB(38.94%)  tps: 6,847  tflops: 52.15  mfu: 16.71%
[rank3]:2025-10-28 23:40:40,448 - INFO - Avg. fwd time: 7.2730 / Avg. bwd time: 19.1950 / Avg. batch time: 491.6177 (ms) / GPU bubble ratio: 13.86%
[rank1]:2025-10-28 23:40:40,493 - INFO - Avg. fwd time: 5.2185 / Avg. bwd time: 12.1419 / Avg. batch time: 550.7877 (ms) / GPU bubble ratio: 49.57%
[rank0]:2025-10-28 23:40:40,513 - INFO - Avg. fwd time: 4.4869 / Avg. bwd time: 12.0600 / Avg. batch time: 573.3102 (ms) / GPU bubble ratio: 53.82%
[rank2]:2025-10-28 23:40:40,472 - INFO - Avg. fwd time: 4.2576 / Avg. bwd time: 9.7689 / Avg. batch time: 522.3000 (ms) / GPU bubble ratio: 57.03%
[rank0]:2025-10-28 23:41:02,651 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-28 23:41:03,849 - INFO -  step: 300  loss: -2.0000  grad_norm:  1.6972  memory: 12.59GiB(26.50%)  tps: 6,846  tflops: 52.14  mfu: 16.71%
[rank1]:2025-10-28 23:41:03,854 - INFO - üîé  Running validation at step 300
[rank0]:2025-10-28 23:41:03,860 - INFO -  step: 300  loss: -2.0000  grad_norm:  1.6972  memory: 15.36GiB(32.33%)  tps: 6,846  tflops: 52.14  mfu: 16.71%
[rank0]:2025-10-28 23:41:03,860 - INFO - üîé  Running validation at step 300
[rank2]:2025-10-28 23:41:03,846 - INFO -  step: 300  loss: -2.0000  grad_norm:  1.6972  memory:  8.44GiB(17.77%)  tps: 6,846  tflops: 52.14  mfu: 16.71%
[rank2]:2025-10-28 23:41:03,846 - INFO - üîé  Running validation at step 300
[rank3]:2025-10-28 23:41:03,858 - INFO -  step: 300  loss:  0.2301  grad_norm:  1.6972  memory: 18.50GiB(38.94%)  tps: 6,847  tflops: 52.14  mfu: 16.71%
[rank3]:2025-10-28 23:41:03,858 - INFO - üîé  Running validation at step 300
[rank1]:2025-10-28 23:41:27,692 - INFO - validate step: 300  loss: -1.0000  memory: 12.59GiB(26.50%)  tps: 17,183
[rank0]:2025-10-28 23:41:27,684 - INFO - validate step: 300  loss: -1.0000  memory: 15.36GiB(32.33%)  tps: 17,193
[rank2]:2025-10-28 23:41:27,696 - INFO - validate step: 300  loss: -1.0000  memory:  8.44GiB(17.77%)  tps: 17,174
[rank3]:2025-10-28 23:41:27,684 - INFO - validate step: 300  loss:  0.9459  memory: 18.50GiB(38.94%)  tps: 17,192
[rank3]:2025-10-28 23:41:28,012 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_Interleaved1F1B_nofreeze_dm1/pipeline_schedule/251028_2341_real_step300_rank3.svg
[rank3]:> Batch Time: 485.81 ms, GPU Bubble Ratio: 46.30%, 43.12%, 53.97%, 13.07%
[rank1]:2025-10-28 23:41:51,795 - INFO -  step: 320  loss: -2.0000  grad_norm:  0.9380  memory: 12.59GiB(26.50%)  tps: 6,797  tflops: 51.77  mfu: 16.59%
[rank0]:2025-10-28 23:41:51,806 - INFO -  step: 320  loss: -2.0000  grad_norm:  0.9380  memory: 15.36GiB(32.33%)  tps: 6,792  tflops: 51.73  mfu: 16.58%
[rank2]:2025-10-28 23:41:51,792 - INFO -  step: 320  loss: -2.0000  grad_norm:  0.9380  memory:  8.44GiB(17.77%)  tps: 6,800  tflops: 51.79  mfu: 16.60%
[rank3]:2025-10-28 23:41:51,803 - INFO -  step: 320  loss:  0.2954  grad_norm:  0.9380  memory: 18.50GiB(38.94%)  tps: 6,793  tflops: 51.74  mfu: 16.58%
[rank2]:2025-10-28 23:41:52,359 - INFO - Avg. fwd time: 4.2580 / Avg. bwd time: 9.7721 / Avg. batch time: 522.0969 (ms) / GPU bubble ratio: 57.00%
[rank3]:2025-10-28 23:41:52,334 - INFO - Avg. fwd time: 7.2624 / Avg. bwd time: 19.1780 / Avg. batch time: 491.0645 (ms) / GPU bubble ratio: 13.85%
[rank1]:2025-10-28 23:41:52,380 - INFO - Avg. fwd time: 5.2188 / Avg. bwd time: 12.1476 / Avg. batch time: 550.5872 (ms) / GPU bubble ratio: 49.53%
[rank0]:2025-10-28 23:41:52,400 - INFO - Avg. fwd time: 4.4878 / Avg. bwd time: 12.0548 / Avg. batch time: 573.1139 (ms) / GPU bubble ratio: 53.82%
[rank3]:2025-10-28 23:42:15,614 - INFO -  step: 340  loss:  0.2681  grad_norm:  1.1043  memory: 18.50GiB(38.94%)  tps: 6,881  tflops: 52.41  mfu: 16.80%
[rank1]:2025-10-28 23:42:15,606 - INFO -  step: 340  loss: -2.0000  grad_norm:  1.1043  memory: 12.59GiB(26.50%)  tps: 6,881  tflops: 52.41  mfu: 16.80%
[rank2]:2025-10-28 23:42:15,602 - INFO -  step: 340  loss: -2.0000  grad_norm:  1.1043  memory:  8.44GiB(17.77%)  tps: 6,881  tflops: 52.41  mfu: 16.80%
[rank0]:2025-10-28 23:42:15,617 - INFO -  step: 340  loss: -2.0000  grad_norm:  1.1043  memory: 15.36GiB(32.33%)  tps: 6,881  tflops: 52.41  mfu: 16.80%
[rank0]:2025-10-28 23:42:26,425 - INFO - [GC] Peforming periodical GC collection 0.02 seconds
[rank1]:2025-10-28 23:42:39,750 - INFO -  step: 360  loss: -2.0000  grad_norm:  0.7585  memory: 12.59GiB(26.50%)  tps: 6,786  tflops: 51.68  mfu: 16.57%
[rank0]:2025-10-28 23:42:39,761 - INFO -  step: 360  loss: -2.0000  grad_norm:  0.7585  memory: 15.36GiB(32.33%)  tps: 6,786  tflops: 51.68  mfu: 16.57%
[rank2]:2025-10-28 23:42:39,746 - INFO -  step: 360  loss: -2.0000  grad_norm:  0.7585  memory:  8.44GiB(17.77%)  tps: 6,786  tflops: 51.68  mfu: 16.57%
[rank3]:2025-10-28 23:42:39,758 - INFO -  step: 360  loss:  0.2036  grad_norm:  0.7585  memory: 18.50GiB(38.94%)  tps: 6,786  tflops: 51.69  mfu: 16.57%
[rank2]:2025-10-28 23:42:40,325 - INFO - Avg. fwd time: 4.2579 / Avg. bwd time: 9.7752 / Avg. batch time: 521.8427 (ms) / GPU bubble ratio: 56.97%
[rank3]:2025-10-28 23:42:40,300 - INFO - Avg. fwd time: 7.2629 / Avg. bwd time: 19.1755 / Avg. batch time: 490.9531 (ms) / GPU bubble ratio: 13.84%
[rank1]:2025-10-28 23:42:40,346 - INFO - Avg. fwd time: 5.2192 / Avg. bwd time: 12.1535 / Avg. batch time: 550.3365 (ms) / GPU bubble ratio: 49.49%
[rank0]:2025-10-28 23:42:40,366 - INFO - Avg. fwd time: 4.4882 / Avg. bwd time: 12.0515 / Avg. batch time: 572.8665 (ms) / GPU bubble ratio: 53.81%
[rank1]:2025-10-28 23:43:03,888 - INFO -  step: 380  loss: -2.0000  grad_norm:  0.5138  memory: 12.59GiB(26.50%)  tps: 6,788  tflops: 51.70  mfu: 16.57%
[rank2]:2025-10-28 23:43:03,884 - INFO -  step: 380  loss: -2.0000  grad_norm:  0.5138  memory:  8.44GiB(17.77%)  tps: 6,788  tflops: 51.70  mfu: 16.57%
[rank0]:2025-10-28 23:43:03,898 - INFO -  step: 380  loss: -2.0000  grad_norm:  0.5138  memory: 15.36GiB(32.33%)  tps: 6,788  tflops: 51.70  mfu: 16.57%
[rank3]:2025-10-28 23:43:03,896 - INFO -  step: 380  loss:  0.2599  grad_norm:  0.5138  memory: 18.50GiB(38.94%)  tps: 6,788  tflops: 51.70  mfu: 16.57%
[rank0]:2025-10-28 23:43:26,800 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-28 23:43:28,042 - INFO -  step: 400  loss: -2.0000  grad_norm:  0.7800  memory: 12.59GiB(26.50%)  tps: 6,783  tflops: 51.66  mfu: 16.56%
[rank1]:2025-10-28 23:43:28,042 - INFO - üîé  Running validation at step 400
[rank2]:2025-10-28 23:43:28,038 - INFO -  step: 400  loss: -2.0000  grad_norm:  0.7800  memory:  8.44GiB(17.77%)  tps: 6,783  tflops: 51.66  mfu: 16.56%
[rank2]:2025-10-28 23:43:28,038 - INFO - üîé  Running validation at step 400
[rank0]:2025-10-28 23:43:28,053 - INFO -  step: 400  loss: -2.0000  grad_norm:  0.7800  memory: 15.36GiB(32.33%)  tps: 6,783  tflops: 51.66  mfu: 16.56%
[rank0]:2025-10-28 23:43:28,053 - INFO - üîé  Running validation at step 400
[rank3]:2025-10-28 23:43:28,050 - INFO -  step: 400  loss:  0.2194  grad_norm:  0.7800  memory: 18.50GiB(38.94%)  tps: 6,783  tflops: 51.66  mfu: 16.56%
[rank3]:2025-10-28 23:43:28,051 - INFO - üîé  Running validation at step 400
[rank0]:2025-10-28 23:43:51,917 - INFO - validate step: 400  loss: -1.0000  memory: 15.36GiB(32.33%)  tps: 17,164
[rank3]:2025-10-28 23:43:51,915 - INFO - validate step: 400  loss:  0.9322  memory: 18.50GiB(38.94%)  tps: 17,164
[rank1]:2025-10-28 23:43:51,922 - INFO - validate step: 400  loss: -1.0000  memory: 12.59GiB(26.50%)  tps: 17,153
[rank2]:2025-10-28 23:43:51,927 - INFO - validate step: 400  loss: -1.0000  memory:  8.44GiB(17.77%)  tps: 17,147
[rank3]:2025-10-28 23:43:52,236 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_Interleaved1F1B_nofreeze_dm1/pipeline_schedule/251028_2343_real_step400_rank3.svg
[rank3]:> Batch Time: 485.69 ms, GPU Bubble Ratio: 46.27%, 43.09%, 53.96%, 13.09%
[rank1]:2025-10-28 23:43:52,802 - INFO - Avg. fwd time: 5.2193 / Avg. bwd time: 12.1575 / Avg. batch time: 550.9118 (ms) / GPU bubble ratio: 49.53%
[rank2]:2025-10-28 23:43:52,781 - INFO - Avg. fwd time: 4.2576 / Avg. bwd time: 9.7783 / Avg. batch time: 522.4134 (ms) / GPU bubble ratio: 57.01%
[rank0]:2025-10-28 23:43:52,824 - INFO - Avg. fwd time: 4.4885 / Avg. bwd time: 12.0494 / Avg. batch time: 573.4405 (ms) / GPU bubble ratio: 53.86%
[rank3]:2025-10-28 23:43:52,757 - INFO - Avg. fwd time: 7.2722 / Avg. bwd time: 19.1892 / Avg. batch time: 491.2598 (ms) / GPU bubble ratio: 13.82%
[rank2]:2025-10-28 23:44:16,247 - INFO -  step: 420  loss: -2.0000  grad_norm:  0.7002  memory:  8.44GiB(17.77%)  tps: 6,737  tflops: 51.31  mfu: 16.45%
[rank3]:2025-10-28 23:44:16,259 - INFO -  step: 420  loss:  0.2884  grad_norm:  0.7002  memory: 18.50GiB(38.94%)  tps: 6,731  tflops: 51.26  mfu: 16.43%
[rank1]:2025-10-28 23:44:16,251 - INFO -  step: 420  loss: -2.0000  grad_norm:  0.7002  memory: 12.59GiB(26.50%)  tps: 6,734  tflops: 51.29  mfu: 16.44%
[rank0]:2025-10-28 23:44:16,262 - INFO -  step: 420  loss: -2.0000  grad_norm:  0.7002  memory: 15.36GiB(32.33%)  tps: 6,730  tflops: 51.26  mfu: 16.43%
[rank1]:2025-10-28 23:44:40,364 - INFO -  step: 440  loss: -2.0000  grad_norm:  0.7847  memory: 12.59GiB(26.50%)  tps: 6,795  tflops: 51.75  mfu: 16.59%
[rank2]:2025-10-28 23:44:40,361 - INFO -  step: 440  loss: -2.0000  grad_norm:  0.7847  memory:  8.44GiB(17.77%)  tps: 6,795  tflops: 51.75  mfu: 16.59%
[rank0]:2025-10-28 23:44:40,375 - INFO -  step: 440  loss: -2.0000  grad_norm:  0.7847  memory: 15.36GiB(32.33%)  tps: 6,795  tflops: 51.75  mfu: 16.59%
[rank3]:2025-10-28 23:44:40,373 - INFO -  step: 440  loss:  0.2728  grad_norm:  0.7847  memory: 18.50GiB(38.94%)  tps: 6,795  tflops: 51.75  mfu: 16.59%
[rank3]:2025-10-28 23:44:40,912 - INFO - Avg. fwd time: 7.2755 / Avg. bwd time: 19.1923 / Avg. batch time: 491.3141 (ms) / GPU bubble ratio: 13.81%
[rank1]:2025-10-28 23:44:40,957 - INFO - Avg. fwd time: 5.2198 / Avg. bwd time: 12.1614 / Avg. batch time: 550.8648 (ms) / GPU bubble ratio: 49.52%
[rank2]:2025-10-28 23:44:40,936 - INFO - Avg. fwd time: 4.2582 / Avg. bwd time: 9.7812 / Avg. batch time: 522.3606 (ms) / GPU bubble ratio: 57.00%
[rank0]:2025-10-28 23:44:40,978 - INFO - Avg. fwd time: 4.4894 / Avg. bwd time: 12.0476 / Avg. batch time: 573.4014 (ms) / GPU bubble ratio: 53.86%
[rank0]:2025-10-28 23:44:51,262 - INFO - [GC] Peforming periodical GC collection 0.02 seconds
[rank1]:2025-10-28 23:45:04,464 - INFO -  step: 460  loss: -2.0000  grad_norm:  0.5611  memory: 12.59GiB(26.50%)  tps: 6,799  tflops: 51.78  mfu: 16.60%
[rank0]:2025-10-28 23:45:04,474 - INFO -  step: 460  loss: -2.0000  grad_norm:  0.5611  memory: 15.36GiB(32.33%)  tps: 6,799  tflops: 51.78  mfu: 16.60%
[rank2]:2025-10-28 23:45:04,460 - INFO -  step: 460  loss: -2.0000  grad_norm:  0.5611  memory:  8.44GiB(17.77%)  tps: 6,799  tflops: 51.78  mfu: 16.60%
[rank3]:2025-10-28 23:45:04,472 - INFO -  step: 460  loss:  0.2449  grad_norm:  0.5611  memory: 18.50GiB(38.94%)  tps: 6,799  tflops: 51.78  mfu: 16.60%
[rank2]:2025-10-28 23:45:28,641 - INFO -  step: 480  loss: -2.0000  grad_norm:  0.7820  memory:  8.44GiB(17.77%)  tps: 6,776  tflops: 51.60  mfu: 16.54%
[rank0]:2025-10-28 23:45:28,656 - INFO -  step: 480  loss: -2.0000  grad_norm:  0.7820  memory: 15.36GiB(32.33%)  tps: 6,776  tflops: 51.60  mfu: 16.54%
[rank3]:2025-10-28 23:45:28,653 - INFO -  step: 480  loss:  0.2383  grad_norm:  0.7820  memory: 18.50GiB(38.94%)  tps: 6,776  tflops: 51.61  mfu: 16.54%
[rank1]:2025-10-28 23:45:28,645 - INFO -  step: 480  loss: -2.0000  grad_norm:  0.7820  memory: 12.59GiB(26.50%)  tps: 6,776  tflops: 51.60  mfu: 16.54%
[rank2]:2025-10-28 23:45:29,226 - INFO - Avg. fwd time: 4.2582 / Avg. bwd time: 9.7838 / Avg. batch time: 522.4503 (ms) / GPU bubble ratio: 57.00%
[rank3]:2025-10-28 23:45:29,202 - INFO - Avg. fwd time: 7.2810 / Avg. bwd time: 19.2012 / Avg. batch time: 491.5051 (ms) / GPU bubble ratio: 13.79%
[rank1]:2025-10-28 23:45:29,247 - INFO - Avg. fwd time: 5.2203 / Avg. bwd time: 12.1660 / Avg. batch time: 550.9625 (ms) / GPU bubble ratio: 49.51%
[rank0]:2025-10-28 23:45:29,268 - INFO - Avg. fwd time: 4.4902 / Avg. bwd time: 12.0472 / Avg. batch time: 573.5046 (ms) / GPU bubble ratio: 53.86%
[rank0]:2025-10-28 23:45:51,670 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-28 23:45:52,877 - INFO -  step: 500  loss: -2.0000  grad_norm:  0.5596  memory:  8.44GiB(17.77%)  tps: 6,760  tflops: 51.49  mfu: 16.50%
[rank2]:2025-10-28 23:45:52,877 - INFO - üîé  Running validation at step 500
[rank3]:2025-10-28 23:45:52,889 - INFO -  step: 500  loss:  0.2546  grad_norm:  0.5596  memory: 18.50GiB(38.94%)  tps: 6,761  tflops: 51.49  mfu: 16.50%
[rank3]:2025-10-28 23:45:52,890 - INFO - üîé  Running validation at step 500
[rank1]:2025-10-28 23:45:52,881 - INFO -  step: 500  loss: -2.0000  grad_norm:  0.5596  memory: 12.59GiB(26.50%)  tps: 6,760  tflops: 51.49  mfu: 16.50%
[rank1]:2025-10-28 23:45:52,881 - INFO - üîé  Running validation at step 500
[rank0]:2025-10-28 23:45:52,892 - INFO -  step: 500  loss: -2.0000  grad_norm:  0.5596  memory: 15.36GiB(32.33%)  tps: 6,760  tflops: 51.49  mfu: 16.50%
[rank0]:2025-10-28 23:45:52,892 - INFO - üîé  Running validation at step 500
[rank3]:2025-10-28 23:46:17,117 - INFO - validate step: 500  loss:  0.9322  memory: 18.50GiB(38.94%)  tps: 16,907
[rank1]:2025-10-28 23:46:17,128 - INFO - validate step: 500  loss: -1.0000  memory: 12.59GiB(26.50%)  tps: 16,893
[rank0]:2025-10-28 23:46:17,121 - INFO - validate step: 500  loss: -1.0000  memory: 15.36GiB(32.33%)  tps: 16,905
[rank2]:2025-10-28 23:46:17,129 - INFO - validate step: 500  loss: -1.0000  memory:  8.44GiB(17.77%)  tps: 16,890
[rank3]:2025-10-28 23:46:17,444 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_Interleaved1F1B_nofreeze_dm1/pipeline_schedule/251028_2346_real_step500_rank3.svg
[rank3]:> Batch Time: 486.28 ms, GPU Bubble Ratio: 46.29%, 43.13%, 54.00%, 13.08%
[rank3]:2025-10-28 23:46:41,376 - INFO -  step: 520  loss:  0.2432  grad_norm:  0.7801  memory: 18.50GiB(38.94%)  tps: 6,754  tflops: 51.44  mfu: 16.49%
[rank1]:2025-10-28 23:46:41,367 - INFO -  step: 520  loss: -2.0000  grad_norm:  0.7801  memory: 12.59GiB(26.50%)  tps: 6,759  tflops: 51.48  mfu: 16.50%
[rank0]:2025-10-28 23:46:41,378 - INFO -  step: 520  loss: -2.0000  grad_norm:  0.7801  memory: 15.36GiB(32.33%)  tps: 6,754  tflops: 51.44  mfu: 16.49%
[rank2]:2025-10-28 23:46:41,364 - INFO -  step: 520  loss: -2.0000  grad_norm:  0.7801  memory:  8.44GiB(17.77%)  tps: 6,761  tflops: 51.49  mfu: 16.50%
[rank2]:2025-10-28 23:46:41,928 - INFO - Avg. fwd time: 4.2586 / Avg. bwd time: 9.7857 / Avg. batch time: 522.7081 (ms) / GPU bubble ratio: 57.01%
[rank3]:2025-10-28 23:46:41,904 - INFO - Avg. fwd time: 7.2823 / Avg. bwd time: 19.2064 / Avg. batch time: 491.5709 (ms) / GPU bubble ratio: 13.78%
[rank1]:2025-10-28 23:46:41,949 - INFO - Avg. fwd time: 5.2204 / Avg. bwd time: 12.1687 / Avg. batch time: 551.2245 (ms) / GPU bubble ratio: 49.53%
[rank0]:2025-10-28 23:46:41,970 - INFO - Avg. fwd time: 4.4906 / Avg. bwd time: 12.0463 / Avg. batch time: 573.7720 (ms) / GPU bubble ratio: 53.89%
[rank1]:2025-10-28 23:47:05,217 - INFO -  step: 540  loss: -2.0000  grad_norm:  0.4832  memory: 12.59GiB(26.50%)  tps: 6,870  tflops: 52.32  mfu: 16.77%
[rank0]:2025-10-28 23:47:05,229 - INFO -  step: 540  loss: -2.0000  grad_norm:  0.4832  memory: 15.36GiB(32.33%)  tps: 6,870  tflops: 52.32  mfu: 16.77%
[rank2]:2025-10-28 23:47:05,214 - INFO -  step: 540  loss: -2.0000  grad_norm:  0.4832  memory:  8.44GiB(17.77%)  tps: 6,870  tflops: 52.32  mfu: 16.77%
[rank3]:2025-10-28 23:47:05,226 - INFO -  step: 540  loss:  0.2515  grad_norm:  0.4832  memory: 18.50GiB(38.94%)  tps: 6,870  tflops: 52.32  mfu: 16.77%
[rank0]:2025-10-28 23:47:16,012 - INFO - [GC] Peforming periodical GC collection 0.02 seconds
[rank1]:2025-10-28 23:47:29,136 - INFO -  step: 560  loss: -2.0000  grad_norm:  0.7996  memory: 12.59GiB(26.50%)  tps: 6,850  tflops: 52.17  mfu: 16.72%
[rank0]:2025-10-28 23:47:29,146 - INFO -  step: 560  loss: -2.0000  grad_norm:  0.7996  memory: 15.36GiB(32.33%)  tps: 6,850  tflops: 52.17  mfu: 16.72%
[rank2]:2025-10-28 23:47:29,132 - INFO -  step: 560  loss: -2.0000  grad_norm:  0.7996  memory:  8.44GiB(17.77%)  tps: 6,850  tflops: 52.17  mfu: 16.72%
[rank3]:2025-10-28 23:47:29,145 - INFO -  step: 560  loss:  0.2963  grad_norm:  0.7996  memory: 18.50GiB(38.94%)  tps: 6,850  tflops: 52.17  mfu: 16.72%
[rank2]:2025-10-28 23:47:29,701 - INFO - Avg. fwd time: 4.2591 / Avg. bwd time: 9.7872 / Avg. batch time: 522.3076 (ms) / GPU bubble ratio: 56.97%
[rank3]:2025-10-28 23:47:29,676 - INFO - Avg. fwd time: 7.2775 / Avg. bwd time: 19.1947 / Avg. batch time: 491.2727 (ms) / GPU bubble ratio: 13.78%
[rank1]:2025-10-28 23:47:29,723 - INFO - Avg. fwd time: 5.2209 / Avg. bwd time: 12.1713 / Avg. batch time: 550.8239 (ms) / GPU bubble ratio: 49.48%
[rank0]:2025-10-28 23:47:29,744 - INFO - Avg. fwd time: 4.4909 / Avg. bwd time: 12.0457 / Avg. batch time: 573.3742 (ms) / GPU bubble ratio: 53.85%
[rank1]:2025-10-28 23:47:53,007 - INFO -  step: 580  loss: -2.0000  grad_norm:  0.4064  memory: 12.59GiB(26.50%)  tps: 6,863  tflops: 52.27  mfu: 16.75%
[rank0]:2025-10-28 23:47:53,018 - INFO -  step: 580  loss: -2.0000  grad_norm:  0.4064  memory: 15.36GiB(32.33%)  tps: 6,863  tflops: 52.27  mfu: 16.75%
[rank2]:2025-10-28 23:47:53,004 - INFO -  step: 580  loss: -2.0000  grad_norm:  0.4064  memory:  8.44GiB(17.77%)  tps: 6,863  tflops: 52.27  mfu: 16.75%
[rank3]:2025-10-28 23:47:53,016 - INFO -  step: 580  loss:  0.2249  grad_norm:  0.4064  memory: 18.50GiB(38.94%)  tps: 6,864  tflops: 52.28  mfu: 16.76%
[rank0]:2025-10-28 23:48:15,607 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-28 23:48:16,812 - INFO -  step: 600  loss: -2.0000  grad_norm:  0.7710  memory: 12.59GiB(26.50%)  tps: 6,883  tflops: 52.42  mfu: 16.80%
[rank1]:2025-10-28 23:48:16,812 - INFO - üîé  Running validation at step 600
[rank0]:2025-10-28 23:48:16,823 - INFO -  step: 600  loss: -2.0000  grad_norm:  0.7710  memory: 15.36GiB(32.33%)  tps: 6,883  tflops: 52.42  mfu: 16.80%
[rank0]:2025-10-28 23:48:16,823 - INFO - üîé  Running validation at step 600
[rank2]:2025-10-28 23:48:16,808 - INFO -  step: 600  loss: -2.0000  grad_norm:  0.7710  memory:  8.44GiB(17.77%)  tps: 6,883  tflops: 52.42  mfu: 16.80%
[rank2]:2025-10-28 23:48:16,809 - INFO - üîé  Running validation at step 600
[rank3]:2025-10-28 23:48:16,820 - INFO -  step: 600  loss:  0.2164  grad_norm:  0.7710  memory: 18.50GiB(38.94%)  tps: 6,883  tflops: 52.42  mfu: 16.80%
[rank3]:2025-10-28 23:48:16,821 - INFO - üîé  Running validation at step 600
[rank3]:2025-10-28 23:48:40,715 - INFO - validate step: 600  loss:  0.9310  memory: 18.50GiB(38.94%)  tps: 17,143
[rank1]:2025-10-28 23:48:40,723 - INFO - validate step: 600  loss: -1.0000  memory: 12.59GiB(26.50%)  tps: 17,131
[rank2]:2025-10-28 23:48:40,729 - INFO - validate step: 600  loss: -1.0000  memory:  8.44GiB(17.77%)  tps: 17,124
[rank0]:2025-10-28 23:48:40,719 - INFO - validate step: 600  loss: -1.0000  memory: 15.36GiB(32.33%)  tps: 17,142
[rank3]:2025-10-28 23:48:41,040 - INFO - Pipeline schedule is saved as: /data3/shcho/torchtitan/images/1028_Interleaved1F1B_nofreeze_dm1/pipeline_schedule/251028_2348_real_step600_rank3.svg
[rank3]:> Batch Time: 485.61 ms, GPU Bubble Ratio: 46.21%, 43.05%, 53.92%, 13.09%
[rank1]:2025-10-28 23:48:41,593 - INFO - Avg. fwd time: 5.2214 / Avg. bwd time: 12.1737 / Avg. batch time: 550.6463 (ms) / GPU bubble ratio: 49.46%
[rank2]:2025-10-28 23:48:41,571 - INFO - Avg. fwd time: 4.2596 / Avg. bwd time: 9.7881 / Avg. batch time: 522.1299 (ms) / GPU bubble ratio: 56.95%
[rank3]:2025-10-28 23:48:41,546 - INFO - Avg. fwd time: 7.2699 / Avg. bwd time: 19.1832 / Avg. batch time: 490.9367 (ms) / GPU bubble ratio: 13.79%
[rank0]:2025-10-28 23:48:41,614 - INFO - Avg. fwd time: 4.4910 / Avg. bwd time: 12.0450 / Avg. batch time: 573.1979 (ms) / GPU bubble ratio: 53.84%
[rank1]:2025-10-28 23:49:04,917 - INFO -  step: 620  loss: -2.0000  grad_norm:  0.5254  memory: 12.59GiB(26.50%)  tps: 6,772  tflops: 51.58  mfu: 16.53%
[rank2]:2025-10-28 23:49:04,914 - INFO -  step: 620  loss: -2.0000  grad_norm:  0.5254  memory:  8.44GiB(17.77%)  tps: 6,775  tflops: 51.60  mfu: 16.54%
[rank0]:2025-10-28 23:49:04,928 - INFO -  step: 620  loss: -2.0000  grad_norm:  0.5254  memory: 15.36GiB(32.33%)  tps: 6,768  tflops: 51.54  mfu: 16.52%
[rank3]:2025-10-28 23:49:04,926 - INFO -  step: 620  loss:  0.2527  grad_norm:  0.5254  memory: 18.50GiB(38.94%)  tps: 6,768  tflops: 51.54  mfu: 16.52%
