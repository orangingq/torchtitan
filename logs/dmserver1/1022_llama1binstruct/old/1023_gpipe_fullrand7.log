
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 10. 23. (ëª©) 00:48:03 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 3,4,5,6
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1022_llama1binstruct/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1022_llama1binstruct/1023_gpipe_fullrand7.log
âœ”ï¸Main Table Experiment
âœ”ï¸Running with fullrand7 x gpipe ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1022_llama1binstruct/config.toml --job.description="Main Table Experiment" --training.steps=1000 --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=fullrand7
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank1]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/tyro/_parsers.py:379: UserWarning: The field `parallelism.pipeline-parallel-schedule` is annotated with type `typing.Literal['GPipe', '1FB', 'Interleaved1F1B', 'InterleavedZeroBubble', 'ZBVZeroBubble']`, but the default value `gpipe` has type `<class 'str'>`. We'll try to handle this gracefully, but it may cause unexpected behavior.
[rank1]:  warnings.warn(message)
[rank1]:2025-10-23 00:48:09,928 - INFO - Starting job: "Main Table Experiment"
[rank2]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/tyro/_parsers.py:379: UserWarning: The field `parallelism.pipeline-parallel-schedule` is annotated with type `typing.Literal['GPipe', '1FB', 'Interleaved1F1B', 'InterleavedZeroBubble', 'ZBVZeroBubble']`, but the default value `gpipe` has type `<class 'str'>`. We'll try to handle this gracefully, but it may cause unexpected behavior.
[rank2]:  warnings.warn(message)
[rank2]:2025-10-23 00:48:09,902 - INFO - Starting job: "Main Table Experiment"
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/tyro/_parsers.py:379: UserWarning: The field `parallelism.pipeline-parallel-schedule` is annotated with type `typing.Literal['GPipe', '1FB', 'Interleaved1F1B', 'InterleavedZeroBubble', 'ZBVZeroBubble']`, but the default value `gpipe` has type `<class 'str'>`. We'll try to handle this gracefully, but it may cause unexpected behavior.
[rank3]:  warnings.warn(message)
[rank3]:2025-10-23 00:48:10,050 - INFO - Starting job: "Main Table Experiment"
[rank0]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/tyro/_parsers.py:379: UserWarning: The field `parallelism.pipeline-parallel-schedule` is annotated with type `typing.Literal['GPipe', '1FB', 'Interleaved1F1B', 'InterleavedZeroBubble', 'ZBVZeroBubble']`, but the default value `gpipe` has type `<class 'str'>`. We'll try to handle this gracefully, but it may cause unexpected behavior.
[rank0]:  warnings.warn(message)
[rank0]:2025-10-23 00:48:10,123 - INFO - Starting job: "Main Table Experiment"
[rank1]:2025-10-23 00:48:10,340 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-10-23 00:48:10,342 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-10-23 00:48:10,301 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-10-23 00:48:10,303 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-10-23 00:48:10,371 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-10-23 00:48:10,374 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-23 00:48:10,409 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-10-23 00:48:10,411 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-23 00:48:10,416 - INFO - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-10-23 00:48:10,897 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-10-23 00:48:11,294 - INFO - Preparing slimorca dataset from Open-Orca/SlimOrca
[rank0]:2025-10-23 00:48:14,189 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank2]:2025-10-23 00:48:14,277 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-10-23 00:48:14,315 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-10-23 00:48:14,343 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-10-23 00:48:14,343 - INFO - Using pipeline schedule gpipe with 8 microbatches and 4 stages.
[rank0]:2025-10-23 00:48:14,340 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-10-23 00:48:14,377 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-10-23 00:48:14,378 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-10-23 00:48:14,404 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-10-23 00:48:14,405 - INFO - Using pipeline schedule gpipe with 8 microbatches and 4 stages.
[rank1]:2025-10-23 00:48:14,491 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-10-23 00:48:14,528 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-10-23 00:48:14,519 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-10-23 00:48:14,520 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-10-23 00:48:14,520 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank1]:2025-10-23 00:48:14,555 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-10-23 00:48:14,555 - INFO - Using pipeline schedule gpipe with 8 microbatches and 4 stages.
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank0]:2025-10-23 00:48:14,578 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-10-23 00:48:14,578 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-10-23 00:48:14,578 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank1]:2025-10-23 00:48:14,752 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-10-23 00:48:14,752 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-10-23 00:48:14,753 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run g789q5x7
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1023_gpipe_fullrand7_dm1/20251023-0048/wandb/run-20251023_004815-g789q5x7
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1023_gpipe_fullrand7_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/g789q5x7
[rank3]:2025-10-23 00:48:16,412 - INFO - WandB logging enabled
[rank3]:2025-10-23 00:48:16,413 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-10-23 00:48:16,452 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-10-23 00:48:16,478 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-10-23 00:48:16,479 - INFO - Using pipeline schedule gpipe with 8 microbatches and 4 stages.
[rank3]:2025-10-23 00:48:16,659 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-10-23 00:48:16,660 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-10-23 00:48:16,661 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank0]:2025-10-23 00:48:16,676 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1023_gpipe_fullrand7_dm1
[rank0]:2025-10-23 00:48:16,676 - WARNING - Mixed precision training with TP or PP is only supported when FSDP/HSDP/CP is enabled.
[rank0]:2025-10-23 00:48:16,676 - INFO - Mixed precision training is disabled
[rank0]:2025-10-23 00:48:16,676 - INFO - Trainer is initialized with local batch size 16, global batch size 128, gradient accumulation steps 8, sequence length 1024, total steps 1000 (warmup 50)
[rank0]:2025-10-23 00:48:16,677 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B-Instruct/original_dcp.
[rank0]:2025-10-23 00:48:18,773 - INFO - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-10-23 00:48:18,773 - INFO - Finished loading the checkpoint in 2.10 seconds.
[rank0]:2025-10-23 00:48:18,773 - INFO - Training starts at step 1
[rank0]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/autograd/graph.py:849: UserWarning: Attempting to run cuBLAS, but there was no current CUDA context! Attempting to set the primary context... (Triggered internally at /pytorch/aten/src/ATen/cuda/CublasHandlePool.cpp:270.)
[rank0]:  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
[rank3]:2025-10-23 00:48:36,535 - INFO -  step:  1  loss:  2.4984  grad_norm:  1.7131  memory: 35.59GiB(74.92%)  tps: 1,632  tflops: 12.76  mfu: 4.09%
[rank3]:2025-10-23 00:48:36,536 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-10-23 00:48:36,563 - INFO -  step:  1  loss: -8.0000  grad_norm:  1.7131  memory: 17.10GiB(35.99%)  tps: 1,477  tflops: 11.55  mfu: 3.70%
[rank0]:2025-10-23 00:48:36,563 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-10-23 00:48:36,526 - INFO -  step:  1  loss: -8.0000  grad_norm:  1.7131  memory: 17.77GiB(37.40%)  tps: 1,490  tflops: 11.64  mfu: 3.73%
[rank1]:2025-10-23 00:48:36,527 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-10-23 00:48:36,524 - INFO -  step:  1  loss: -8.0000  grad_norm:  1.7131  memory: 14.29GiB(30.07%)  tps: 1,475  tflops: 11.53  mfu: 3.70%
[rank2]:2025-10-23 00:48:36,524 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-23 00:51:08,814 - INFO - Avg. fwd time: 75.9660 / Avg. bwd time: 133.3669 / Avg. batch time: 1722.4421 (ms) / GPU bubble ratio: 2.77%
[rank2]:2025-10-23 00:51:08,871 - INFO - Avg. fwd time: 34.6874 / Avg. bwd time: 54.5461 / Avg. batch time: 1813.9492 (ms) / GPU bubble ratio: 60.65%
[rank1]:2025-10-23 00:51:08,946 - INFO - Avg. fwd time: 53.6469 / Avg. bwd time: 74.6017 / Avg. batch time: 1935.5864 (ms) / GPU bubble ratio: 46.99%
[rank0]:2025-10-23 00:51:09,009 - INFO - Avg. fwd time: 47.5756 / Avg. bwd time: 61.1848 / Avg. batch time: 2034.9923 (ms) / GPU bubble ratio: 57.24%
[rank1]:2025-10-23 00:53:55,516 - INFO -  step: 20  loss: -8.0000  grad_norm:  0.4666  memory: 20.03GiB(42.17%)  tps: 1,952  tflops: 15.26  mfu: 4.89%
[rank0]:2025-10-23 00:53:55,538 - INFO -  step: 20  loss: -8.0000  grad_norm:  0.4666  memory: 20.89GiB(43.97%)  tps: 1,952  tflops: 15.26  mfu: 4.89%
[rank2]:2025-10-23 00:53:55,512 - INFO -  step: 20  loss: -8.0000  grad_norm:  0.4666  memory: 16.10GiB(33.90%)  tps: 1,952  tflops: 15.26  mfu: 4.89%
[rank3]:2025-10-23 00:53:55,525 - INFO -  step: 20  loss:  2.0790  grad_norm:  0.4666  memory: 38.93GiB(81.95%)  tps: 1,952  tflops: 15.26  mfu: 4.89%
[rank3]:2025-10-23 00:53:57,450 - INFO - Avg. fwd time: 76.3543 / Avg. bwd time: 134.5347 / Avg. batch time: 1735.4583 (ms) / GPU bubble ratio: 2.79%
[rank2]:2025-10-23 00:53:57,509 - INFO - Avg. fwd time: 34.8304 / Avg. bwd time: 54.8690 / Avg. batch time: 1827.5525 (ms) / GPU bubble ratio: 60.73%
[rank1]:2025-10-23 00:53:57,590 - INFO - Avg. fwd time: 54.1509 / Avg. bwd time: 74.5621 / Avg. batch time: 1950.2291 (ms) / GPU bubble ratio: 47.20%
[rank0]:2025-10-23 00:53:57,656 - INFO - Avg. fwd time: 47.7988 / Avg. bwd time: 61.7650 / Avg. batch time: 2049.9912 (ms) / GPU bubble ratio: 57.24%
[rank2]:2025-10-23 00:56:45,790 - INFO - Avg. fwd time: 34.8753 / Avg. bwd time: 55.0634 / Avg. batch time: 1830.7222 (ms) / GPU bubble ratio: 60.70%
[rank3]:2025-10-23 00:56:45,731 - INFO - Avg. fwd time: 76.3505 / Avg. bwd time: 134.8385 / Avg. batch time: 1738.2715 (ms) / GPU bubble ratio: 2.81%
[rank1]:2025-10-23 00:56:45,870 - INFO - Avg. fwd time: 54.6353 / Avg. bwd time: 74.3889 / Avg. batch time: 1953.6152 (ms) / GPU bubble ratio: 47.16%
[rank0]:2025-10-23 00:56:45,940 - INFO - Avg. fwd time: 47.9910 / Avg. bwd time: 62.1109 / Avg. batch time: 2053.8972 (ms) / GPU bubble ratio: 57.11%
[rank2]:2025-10-23 00:59:32,288 - INFO -  step: 40  loss: -8.0000  grad_norm:  1.0066  memory: 16.10GiB(33.90%)  tps: 1,946  tflops: 15.21  mfu: 4.88%
[rank0]:2025-10-23 00:59:32,308 - INFO -  step: 40  loss: -8.0000  grad_norm:  1.0066  memory: 20.89GiB(43.97%)  tps: 1,946  tflops: 15.21  mfu: 4.88%
[rank3]:2025-10-23 00:59:32,300 - INFO -  step: 40  loss:  2.3446  grad_norm:  1.0066  memory: 38.93GiB(81.95%)  tps: 1,946  tflops: 15.21  mfu: 4.88%
[rank1]:2025-10-23 00:59:32,292 - INFO -  step: 40  loss: -8.0000  grad_norm:  1.0066  memory: 20.03GiB(42.17%)  tps: 1,946  tflops: 15.21  mfu: 4.88%
[rank3]:2025-10-23 00:59:34,214 - INFO - Avg. fwd time: 76.4678 / Avg. bwd time: 135.0143 / Avg. batch time: 1740.2313 (ms) / GPU bubble ratio: 2.78%
[rank2]:2025-10-23 00:59:34,272 - INFO - Avg. fwd time: 34.9483 / Avg. bwd time: 55.2621 / Avg. batch time: 1832.8849 (ms) / GPU bubble ratio: 60.63%
[rank1]:2025-10-23 00:59:34,355 - INFO - Avg. fwd time: 54.6274 / Avg. bwd time: 74.4783 / Avg. batch time: 1955.8922 (ms) / GPU bubble ratio: 47.19%
[rank0]:2025-10-23 00:59:34,418 - INFO - Avg. fwd time: 47.9694 / Avg. bwd time: 62.1535 / Avg. batch time: 2056.2142 (ms) / GPU bubble ratio: 57.16%
[rank3]:2025-10-23 01:00:56,112 - INFO - [Step 45] ã€°ï¸ Monitoring Upperbound
[rank0]:2025-10-23 01:02:04,443 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-23 01:02:20,541 - INFO - [Step 50] âœ”ï¸  Setting Upperbound
[rank3]:2025-10-23 01:02:21,373 - INFO - [Step 50] ã€°ï¸ Monitoring Lowerbound
[rank3]:2025-10-23 01:02:23,260 - INFO - Avg. fwd time: 76.6308 / Avg. bwd time: 135.1425 / Avg. batch time: 1742.4830 (ms) / GPU bubble ratio: 2.77%
[rank2]:2025-10-23 01:02:23,318 - INFO - Avg. fwd time: 34.9850 / Avg. bwd time: 55.3663 / Avg. batch time: 1835.2752 (ms) / GPU bubble ratio: 60.62%
[rank1]:2025-10-23 01:02:23,390 - INFO - Avg. fwd time: 54.6744 / Avg. bwd time: 74.5721 / Avg. batch time: 1958.4480 (ms) / GPU bubble ratio: 47.20%
[rank0]:2025-10-23 01:02:23,450 - INFO - Avg. fwd time: 48.0326 / Avg. bwd time: 62.1549 / Avg. batch time: 2058.7810 (ms) / GPU bubble ratio: 57.18%
[rank3]:2025-10-23 01:03:20,703 - INFO - [Step 55] âœ”ï¸  Setting Lowerbound
[rank3]:2025-10-23 01:03:21,041 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_gpipe_fullrand7_dm1/pipeline_schedule/251023_0103_max_batch_time.svg
[rank3]:> Batch Time: 2028.62 ms, GPU Bubble Ratio: 55.91%, 48.41%, 64.03%, 15.51%
[rank3]:2025-10-23 01:03:21,269 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_gpipe_fullrand7_dm1/pipeline_schedule/251023_0103_min_batch_time.svg
[rank3]:> Batch Time: 1396.80 ms, GPU Bubble Ratio: 67.75%, 45.45%, 63.32%, 13.79%
[rank3]:2025-10-23 01:03:21,505 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_gpipe_fullrand7_dm1/pipeline_schedule/251023_0103_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 1396.80 ms, GPU Bubble Ratio: 42.99%, 31.29%, 49.63%, 13.79%
[rank3]:2025-10-23 01:03:21,505 - INFO - 	> Batch Time: 1396.80 ms (Average Freeze Ratio: 0.41, Time Reduction Rate: 0.31)
[rank3]:2025-10-23 01:04:20,113 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.67/1.00, [MB1] 0.67/1.00, [MB2] 0.67/1.00, [MB3] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank2]:2025-10-23 01:04:20,124 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.67/1.00
[rank2]:2025-10-23 01:04:20,164 - INFO -  step: 60  loss: -8.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,277  tflops: 17.80  mfu: 5.70%
[rank0]:2025-10-23 01:04:20,165 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.25/0.37, [MB6] 0.26/0.39, [MB7] 0.67/1.00
[rank0]:2025-10-23 01:04:20,166 - INFO -  step: 60  loss: -8.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,277  tflops: 17.80  mfu: 5.70%
[rank3]:2025-10-23 01:04:20,165 - INFO -  step: 60  loss:  2.4332  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,277  tflops: 17.80  mfu: 5.70%
[rank1]:2025-10-23 01:04:20,165 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.18/0.27, [MB5] 0.07/0.11, [MB6] 0.61/0.91, [MB7] 0.67/1.00
[rank1]:2025-10-23 01:04:20,166 - INFO -  step: 60  loss: -8.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,277  tflops: 17.80  mfu: 5.70%
[rank2]:2025-10-23 01:04:21,569 - INFO - Avg. fwd time: 35.0278 / Avg. bwd time: 51.0499 / Avg. batch time: 1747.8361 (ms) / GPU bubble ratio: 60.60%
[rank3]:2025-10-23 01:04:21,535 - INFO - Avg. fwd time: 76.6171 / Avg. bwd time: 124.6031 / Avg. batch time: 1658.1134 (ms) / GPU bubble ratio: 2.92%
[rank1]:2025-10-23 01:04:21,614 - INFO - Avg. fwd time: 54.8030 / Avg. bwd time: 68.7012 / Avg. batch time: 1864.8613 (ms) / GPU bubble ratio: 47.02%
[rank0]:2025-10-23 01:04:21,617 - INFO - Avg. fwd time: 48.0483 / Avg. bwd time: 52.4034 / Avg. batch time: 1955.3445 (ms) / GPU bubble ratio: 58.90%
[rank3]:2025-10-23 01:06:39,482 - INFO - Avg. fwd time: 76.7110 / Avg. bwd time: 120.4322 / Avg. batch time: 1625.3792 (ms) / GPU bubble ratio: 2.97%
[rank2]:2025-10-23 01:06:39,521 - INFO - Avg. fwd time: 35.0431 / Avg. bwd time: 48.8996 / Avg. batch time: 1712.7502 (ms) / GPU bubble ratio: 60.79%
[rank1]:2025-10-23 01:06:39,575 - INFO - Avg. fwd time: 54.8914 / Avg. bwd time: 66.2605 / Avg. batch time: 1827.3148 (ms) / GPU bubble ratio: 46.96%
[rank0]:2025-10-23 01:06:39,614 - INFO - Avg. fwd time: 48.0574 / Avg. bwd time: 50.9417 / Avg. batch time: 1916.4560 (ms) / GPU bubble ratio: 58.67%
[rank2]:2025-10-23 01:08:35,678 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-23 01:08:35,719 - INFO -  step: 80  loss: -8.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,564  tflops: 20.05  mfu: 6.43%
[rank0]:2025-10-23 01:08:35,720 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.37/0.37, [MB6] 0.39/0.39, [MB7] 1.00/1.00
[rank0]:2025-10-23 01:08:35,720 - INFO -  step: 80  loss: -8.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,564  tflops: 20.05  mfu: 6.43%
[rank3]:2025-10-23 01:08:35,667 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-23 01:08:35,720 - INFO -  step: 80  loss:  2.2723  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,564  tflops: 20.05  mfu: 6.43%
[rank1]:2025-10-23 01:08:35,720 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.27/0.27, [MB5] 0.11/0.11, [MB6] 0.91/0.91, [MB7] 1.00/1.00
[rank1]:2025-10-23 01:08:35,720 - INFO -  step: 80  loss: -8.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,564  tflops: 20.05  mfu: 6.43%
[rank3]:2025-10-23 01:08:37,127 - INFO - Avg. fwd time: 76.6933 / Avg. bwd time: 114.3954 / Avg. batch time: 1577.2029 (ms) / GPU bubble ratio: 3.07%
[rank2]:2025-10-23 01:08:37,161 - INFO - Avg. fwd time: 35.0567 / Avg. bwd time: 46.4716 / Avg. batch time: 1661.9981 (ms) / GPU bubble ratio: 60.76%
[rank0]:2025-10-23 01:08:37,207 - INFO - Avg. fwd time: 48.0499 / Avg. bwd time: 44.5742 / Avg. batch time: 1855.7682 (ms) / GPU bubble ratio: 60.07%
[rank1]:2025-10-23 01:08:37,203 - INFO - Avg. fwd time: 55.0429 / Avg. bwd time: 62.9004 / Avg. batch time: 1773.0930 (ms) / GPU bubble ratio: 46.79%
[rank3]:2025-10-23 01:10:33,394 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_gpipe_fullrand7_dm1/pipeline_schedule_adjustment/251023_0110_rank3_trend_line.svg
[rank1]:2025-10-23 01:10:33,436 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_gpipe_fullrand7_dm1/pipeline_schedule_adjustment/251023_0110_rank1_trend_line.svg
[rank2]:2025-10-23 01:10:33,398 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_gpipe_fullrand7_dm1/pipeline_schedule_adjustment/251023_0110_rank2_trend_line.svg
[rank2]:2025-10-23 01:10:33,441 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-23 01:10:33,428 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_gpipe_fullrand7_dm1/pipeline_schedule_adjustment/251023_0110_rank0_trend_line.svg
[rank0]:2025-10-23 01:10:33,441 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-10-23 01:10:33,442 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank3]:2025-10-23 01:10:33,665 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_gpipe_fullrand7_dm1/pipeline_schedule/251023_0110_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 1292.85 ms, GPU Bubble Ratio: 60.72%, 38.30%, 59.04%, 14.97%
[rank3]:2025-10-23 01:10:33,665 - INFO - 	> Batch Time: 1292.85 ms (Average Freeze Ratio: 0.09)
[rank3]:2025-10-23 01:10:33,666 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank2]:2025-10-23 01:10:34,992 - INFO - Avg. fwd time: 35.0816 / Avg. bwd time: 44.5844 / Avg. batch time: 1622.7391 (ms) / GPU bubble ratio: 60.73%
[rank3]:2025-10-23 01:10:34,958 - INFO - Avg. fwd time: 76.6955 / Avg. bwd time: 109.7003 / Avg. batch time: 1539.8047 (ms) / GPU bubble ratio: 3.16%
[rank1]:2025-10-23 01:10:35,037 - INFO - Avg. fwd time: 55.1858 / Avg. bwd time: 60.2913 / Avg. batch time: 1731.0877 (ms) / GPU bubble ratio: 46.63%
[rank0]:2025-10-23 01:10:35,041 - INFO - Avg. fwd time: 48.0532 / Avg. bwd time: 39.6217 / Avg. batch time: 1808.7219 (ms) / GPU bubble ratio: 61.22%
[rank0]:2025-10-23 01:12:54,950 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-23 01:13:10,904 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_gpipe_fullrand7_dm1/pipeline_schedule_adjustment/251023_0113_rank2_trend_line.svg
[rank1]:2025-10-23 01:13:10,933 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_gpipe_fullrand7_dm1/pipeline_schedule_adjustment/251023_0113_rank1_trend_line.svg
[rank1]:2025-10-23 01:13:10,939 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-10-23 01:13:10,940 - INFO -  step: 100  loss: -8.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,381  tflops: 18.62  mfu: 5.97%
[rank3]:2025-10-23 01:13:10,929 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_gpipe_fullrand7_dm1/pipeline_schedule_adjustment/251023_0113_rank3_trend_line.svg
[rank2]:2025-10-23 01:13:10,939 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-23 01:13:10,940 - INFO -  step: 100  loss: -8.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,381  tflops: 18.62  mfu: 5.97%
[rank0]:2025-10-23 01:13:10,930 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_gpipe_fullrand7_dm1/pipeline_schedule_adjustment/251023_0113_rank0_trend_line.svg
[rank0]:2025-10-23 01:13:10,939 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-23 01:13:10,940 - INFO -  step: 100  loss: -8.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,381  tflops: 18.62  mfu: 5.97%
[rank3]:2025-10-23 01:13:11,168 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_gpipe_fullrand7_dm1/pipeline_schedule/251023_0113_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 1497.35 ms, GPU Bubble Ratio: 68.11%, 47.53%, 64.99%, 12.86%
[rank3]:2025-10-23 01:13:11,168 - INFO - 	> Batch Time: 1497.35 ms (Average Freeze Ratio: 0.34)
[rank3]:2025-10-23 01:13:11,169 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-23 01:13:11,173 - INFO -  step: 100  loss:  2.3017  grad_norm:  0.1129  memory: 38.93GiB(81.95%)  tps: 2,379  tflops: 18.60  mfu: 5.96%
[rank3]:2025-10-23 01:13:11,416 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_gpipe_fullrand7_dm1/pipeline_schedule/251023_0113_real_step100_rank3.svg
[rank3]:> Batch Time: 1986.25 ms, GPU Bubble Ratio: 57.42%, 50.69%, 65.32%, 14.84%
[rank3]:2025-10-23 01:13:11,475 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1023_gpipe_fullrand7_dm1/freeze_ratio_history/rank3/251023_0113_stage3_step100.svg
[rank2]:2025-10-23 01:13:13,284 - INFO - Avg. fwd time: 35.0934 / Avg. bwd time: 43.0058 / Avg. batch time: 1641.8074 (ms) / GPU bubble ratio: 61.94%
[rank1]:2025-10-23 01:13:13,327 - INFO - Avg. fwd time: 55.1396 / Avg. bwd time: 58.0193 / Avg. batch time: 1747.7044 (ms) / GPU bubble ratio: 48.20%
[rank3]:2025-10-23 01:13:13,251 - INFO - Avg. fwd time: 76.6568 / Avg. bwd time: 112.3029 / Avg. batch time: 1560.3739 (ms) / GPU bubble ratio: 3.12%
[rank0]:2025-10-23 01:13:13,333 - INFO - Avg. fwd time: 47.9582 / Avg. bwd time: 35.6598 / Avg. batch time: 1821.2928 (ms) / GPU bubble ratio: 63.27%
[rank3]:2025-10-23 01:15:10,833 - INFO - Avg. fwd time: 76.6574 / Avg. bwd time: 108.6479 / Avg. batch time: 1531.2488 (ms) / GPU bubble ratio: 3.19%
[rank0]:2025-10-23 01:15:10,917 - INFO - Avg. fwd time: 47.9453 / Avg. bwd time: 32.4181 / Avg. batch time: 1785.6910 (ms) / GPU bubble ratio: 64.00%
[rank2]:2025-10-23 01:15:10,867 - INFO - Avg. fwd time: 35.0927 / Avg. bwd time: 41.7704 / Avg. batch time: 1611.3081 (ms) / GPU bubble ratio: 61.84%
[rank1]:2025-10-23 01:15:10,913 - INFO - Avg. fwd time: 55.1986 / Avg. bwd time: 56.3182 / Avg. batch time: 1715.4036 (ms) / GPU bubble ratio: 47.99%
[rank0]:2025-10-23 01:17:07,182 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_gpipe_fullrand7_dm1/pipeline_schedule_adjustment/251023_0117_rank0_trend_line.svg
[rank0]:2025-10-23 01:17:07,188 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-23 01:17:07,189 - INFO -  step: 120  loss: -8.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,774  tflops: 21.69  mfu: 6.95%
[rank2]:2025-10-23 01:17:07,150 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_gpipe_fullrand7_dm1/pipeline_schedule_adjustment/251023_0117_rank2_trend_line.svg
[rank2]:2025-10-23 01:17:07,188 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-23 01:17:07,189 - INFO -  step: 120  loss: -8.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,774  tflops: 21.69  mfu: 6.95%
[rank3]:2025-10-23 01:17:07,152 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_gpipe_fullrand7_dm1/pipeline_schedule_adjustment/251023_0117_rank3_trend_line.svg
[rank1]:2025-10-23 01:17:07,181 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_gpipe_fullrand7_dm1/pipeline_schedule_adjustment/251023_0117_rank1_trend_line.svg
[rank1]:2025-10-23 01:17:07,188 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank1]:2025-10-23 01:17:07,189 - INFO -  step: 120  loss: -8.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,774  tflops: 21.69  mfu: 6.95%
[rank3]:2025-10-23 01:17:07,418 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_gpipe_fullrand7_dm1/pipeline_schedule/251023_0117_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 1474.45 ms, GPU Bubble Ratio: 69.68%, 47.28%, 64.71%, 13.03%
[rank3]:2025-10-23 01:17:07,419 - INFO - 	> Batch Time: 1474.45 ms (Average Freeze Ratio: 0.31)
[rank3]:2025-10-23 01:17:07,419 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-23 01:17:07,423 - INFO -  step: 120  loss:  2.3035  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,774  tflops: 21.69  mfu: 6.95%
[rank3]:2025-10-23 01:17:08,718 - INFO - Avg. fwd time: 76.6658 / Avg. bwd time: 105.5865 / Avg. batch time: 1506.8923 (ms) / GPU bubble ratio: 3.24%
[rank0]:2025-10-23 01:17:08,802 - INFO - Avg. fwd time: 47.9518 / Avg. bwd time: 29.7168 / Avg. batch time: 1756.1369 (ms) / GPU bubble ratio: 64.62%
[rank2]:2025-10-23 01:17:08,752 - INFO - Avg. fwd time: 35.1046 / Avg. bwd time: 40.7482 / Avg. batch time: 1585.9803 (ms) / GPU bubble ratio: 61.74%
[rank1]:2025-10-23 01:17:08,797 - INFO - Avg. fwd time: 55.2627 / Avg. bwd time: 54.9138 / Avg. batch time: 1688.5896 (ms) / GPU bubble ratio: 47.80%
[rank3]:2025-10-23 01:19:22,725 - INFO - Avg. fwd time: 76.7183 / Avg. bwd time: 102.9622 / Avg. batch time: 1486.2160 (ms) / GPU bubble ratio: 3.28%
[rank2]:2025-10-23 01:19:22,852 - INFO - Avg. fwd time: 35.0732 / Avg. bwd time: 39.8598 / Avg. batch time: 1571.3808 (ms) / GPU bubble ratio: 61.85%
[rank1]:2025-10-23 01:19:23,009 - INFO - Avg. fwd time: 55.2850 / Avg. bwd time: 57.5635 / Avg. batch time: 1681.5913 (ms) / GPU bubble ratio: 46.31%
[rank0]:2025-10-23 01:19:23,013 - INFO - Avg. fwd time: 47.9391 / Avg. bwd time: 27.4311 / Avg. batch time: 1746.8096 (ms) / GPU bubble ratio: 65.48%
[rank3]:2025-10-23 01:21:35,705 - INFO -  step: 140  loss:  2.3430  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,443  tflops: 19.10  mfu: 6.12%
[rank1]:2025-10-23 01:21:35,727 - INFO -  step: 140  loss: -8.0000  grad_norm:  0.1338  memory: 20.03GiB(42.17%)  tps: 2,440  tflops: 19.08  mfu: 6.11%
[rank0]:2025-10-23 01:21:35,704 - INFO -  step: 140  loss: -8.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,441  tflops: 19.08  mfu: 6.12%
[rank2]:2025-10-23 01:21:35,704 - INFO -  step: 140  loss: -8.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,441  tflops: 19.08  mfu: 6.12%
[rank3]:2025-10-23 01:21:37,095 - INFO - Avg. fwd time: 76.7598 / Avg. bwd time: 100.6979 / Avg. batch time: 1468.3946 (ms) / GPU bubble ratio: 3.32%
[rank2]:2025-10-23 01:21:37,212 - INFO - Avg. fwd time: 35.0479 / Avg. bwd time: 39.0961 / Avg. batch time: 1559.0618 (ms) / GPU bubble ratio: 61.95%
[rank0]:2025-10-23 01:21:37,375 - INFO - Avg. fwd time: 47.9271 / Avg. bwd time: 25.4718 / Avg. batch time: 1739.0246 (ms) / GPU bubble ratio: 66.23%
[rank1]:2025-10-23 01:21:37,370 - INFO - Avg. fwd time: 55.3395 / Avg. bwd time: 59.8626 / Avg. batch time: 1675.8048 (ms) / GPU bubble ratio: 45.00%
[rank0]:2025-10-23 01:23:36,625 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-23 01:23:51,433 - INFO - Avg. fwd time: 76.8034 / Avg. bwd time: 98.7414 / Avg. batch time: 1453.0431 (ms) / GPU bubble ratio: 3.35%
[rank2]:2025-10-23 01:23:51,567 - INFO - Avg. fwd time: 35.0325 / Avg. bwd time: 38.4361 / Avg. batch time: 1548.3630 (ms) / GPU bubble ratio: 62.04%
[rank0]:2025-10-23 01:23:51,728 - INFO - Avg. fwd time: 47.9243 / Avg. bwd time: 23.7739 / Avg. batch time: 1732.2831 (ms) / GPU bubble ratio: 66.89%
[rank1]:2025-10-23 01:23:51,723 - INFO - Avg. fwd time: 55.3906 / Avg. bwd time: 61.8519 / Avg. batch time: 1670.7992 (ms) / GPU bubble ratio: 43.86%
[rank3]:2025-10-23 01:26:04,558 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_gpipe_fullrand7_dm1/pipeline_schedule_adjustment/251023_0126_rank3_trend_line.svg
[rank0]:2025-10-23 01:26:04,601 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_gpipe_fullrand7_dm1/pipeline_schedule_adjustment/251023_0126_rank0_trend_line.svg
[rank0]:2025-10-23 01:26:04,607 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-23 01:26:04,608 - INFO -  step: 160  loss: -8.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,437  tflops: 19.05  mfu: 6.11%
[rank2]:2025-10-23 01:26:04,561 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_gpipe_fullrand7_dm1/pipeline_schedule_adjustment/251023_0126_rank2_trend_line.svg
[rank2]:2025-10-23 01:26:04,606 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-23 01:26:04,608 - INFO -  step: 160  loss: -8.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,437  tflops: 19.05  mfu: 6.11%
[rank1]:2025-10-23 01:26:04,596 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_gpipe_fullrand7_dm1/pipeline_schedule_adjustment/251023_0126_rank1_trend_line.svg
[rank1]:2025-10-23 01:26:04,606 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-10-23 01:26:04,607 - INFO -  step: 160  loss: -8.0000  grad_norm:  0.1001  memory: 20.03GiB(42.17%)  tps: 2,437  tflops: 19.05  mfu: 6.11%
[rank3]:2025-10-23 01:26:04,835 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_gpipe_fullrand7_dm1/pipeline_schedule/251023_0126_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 1434.30 ms, GPU Bubble Ratio: 70.38%, 35.07%, 63.99%, 13.26%
[rank3]:2025-10-23 01:26:04,836 - INFO - 	> Batch Time: 1434.30 ms (Average Freeze Ratio: 0.34)
[rank3]:2025-10-23 01:26:04,836 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-23 01:26:04,840 - INFO -  step: 160  loss:  2.2356  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,435  tflops: 19.04  mfu: 6.10%
[rank3]:2025-10-23 01:26:06,131 - INFO - Avg. fwd time: 76.8461 / Avg. bwd time: 97.0356 / Avg. batch time: 1439.7409 (ms) / GPU bubble ratio: 3.38%
[rank2]:2025-10-23 01:26:06,261 - INFO - Avg. fwd time: 35.0121 / Avg. bwd time: 37.8609 / Avg. batch time: 1539.1066 (ms) / GPU bubble ratio: 62.12%
[rank0]:2025-10-23 01:26:06,419 - INFO - Avg. fwd time: 47.9237 / Avg. bwd time: 22.2881 / Avg. batch time: 1726.4881 (ms) / GPU bubble ratio: 67.47%
[rank1]:2025-10-23 01:26:06,415 - INFO - Avg. fwd time: 55.4331 / Avg. bwd time: 63.5819 / Avg. batch time: 1666.5124 (ms) / GPU bubble ratio: 42.87%
[rank3]:2025-10-23 01:28:03,996 - INFO - Avg. fwd time: 76.8646 / Avg. bwd time: 95.5399 / Avg. batch time: 1427.9075 (ms) / GPU bubble ratio: 3.41%
[rank2]:2025-10-23 01:28:04,031 - INFO - Avg. fwd time: 35.0125 / Avg. bwd time: 37.3613 / Avg. batch time: 1525.3299 (ms) / GPU bubble ratio: 62.04%
[rank1]:2025-10-23 01:28:04,075 - INFO - Avg. fwd time: 55.4378 / Avg. bwd time: 62.1634 / Avg. batch time: 1650.3389 (ms) / GPU bubble ratio: 42.99%
[rank0]:2025-10-23 01:28:04,080 - INFO - Avg. fwd time: 47.9175 / Avg. bwd time: 20.9772 / Avg. batch time: 1708.9788 (ms) / GPU bubble ratio: 67.75%
[rank2]:2025-10-23 01:30:00,248 - INFO -  step: 180  loss: -8.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,781  tflops: 21.74  mfu: 6.97%
[rank3]:2025-10-23 01:30:00,249 - INFO -  step: 180  loss:  2.3363  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,784  tflops: 21.76  mfu: 6.98%
[rank1]:2025-10-23 01:30:00,249 - INFO -  step: 180  loss: -8.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,781  tflops: 21.74  mfu: 6.97%
[rank0]:2025-10-23 01:30:00,249 - INFO -  step: 180  loss: -8.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,781  tflops: 21.74  mfu: 6.97%
[rank2]:2025-10-23 01:30:01,650 - INFO - Avg. fwd time: 35.0166 / Avg. bwd time: 36.9198 / Avg. batch time: 1513.0944 (ms) / GPU bubble ratio: 61.97%
[rank3]:2025-10-23 01:30:01,615 - INFO - Avg. fwd time: 76.8550 / Avg. bwd time: 94.2313 / Avg. batch time: 1417.3930 (ms) / GPU bubble ratio: 3.44%
[rank1]:2025-10-23 01:30:01,695 - INFO - Avg. fwd time: 55.4421 / Avg. bwd time: 60.9016 / Avg. batch time: 1635.9375 (ms) / GPU bubble ratio: 43.11%
[rank0]:2025-10-23 01:30:01,700 - INFO - Avg. fwd time: 47.9144 / Avg. bwd time: 19.8119 / Avg. batch time: 1693.3979 (ms) / GPU bubble ratio: 68.00%
[rank3]:2025-10-23 01:31:59,422 - INFO - Avg. fwd time: 76.8540 / Avg. bwd time: 93.0674 / Avg. batch time: 1408.0690 (ms) / GPU bubble ratio: 3.46%
[rank2]:2025-10-23 01:31:59,458 - INFO - Avg. fwd time: 35.0295 / Avg. bwd time: 36.5267 / Avg. batch time: 1502.2275 (ms) / GPU bubble ratio: 61.89%
[rank1]:2025-10-23 01:31:59,503 - INFO - Avg. fwd time: 55.4391 / Avg. bwd time: 59.7705 / Avg. batch time: 1623.1523 (ms) / GPU bubble ratio: 43.22%
[rank0]:2025-10-23 01:31:59,508 - INFO - Avg. fwd time: 47.8959 / Avg. bwd time: 18.7693 / Avg. batch time: 1679.5538 (ms) / GPU bubble ratio: 68.25%
[rank0]:2025-10-23 01:33:43,912 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-23 01:33:55,638 - INFO -  step: 200  loss: -8.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,784  tflops: 21.77  mfu: 6.98%
[rank3]:2025-10-23 01:33:55,640 - INFO -  step: 200  loss:  2.2138  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,784  tflops: 21.77  mfu: 6.98%
[rank1]:2025-10-23 01:33:55,639 - INFO -  step: 200  loss: -8.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,784  tflops: 21.77  mfu: 6.98%
[rank0]:2025-10-23 01:33:55,639 - INFO -  step: 200  loss: -8.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,784  tflops: 21.77  mfu: 6.98%
[rank3]:2025-10-23 01:33:55,850 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_gpipe_fullrand7_dm1/pipeline_schedule/251023_0133_real_step200_rank3.svg
[rank3]:> Batch Time: 1398.00 ms, GPU Bubble Ratio: 72.39%, 40.48%, 63.39%, 14.04%
[rank3]:2025-10-23 01:33:55,914 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1023_gpipe_fullrand7_dm1/freeze_ratio_history/rank3/251023_0133_stage3_step200.svg
[rank3]:2025-10-23 01:33:57,209 - INFO - Avg. fwd time: 76.8390 / Avg. bwd time: 92.0190 / Avg. batch time: 1399.5841 (ms) / GPU bubble ratio: 3.48%
[rank2]:2025-10-23 01:33:57,245 - INFO - Avg. fwd time: 35.0388 / Avg. bwd time: 36.1741 / Avg. batch time: 1492.4531 (ms) / GPU bubble ratio: 61.83%
[rank1]:2025-10-23 01:33:57,288 - INFO - Avg. fwd time: 55.4383 / Avg. bwd time: 58.7507 / Avg. batch time: 1611.6623 (ms) / GPU bubble ratio: 43.32%
[rank0]:2025-10-23 01:33:57,293 - INFO - Avg. fwd time: 47.8836 / Avg. bwd time: 17.8310 / Avg. batch time: 1667.1077 (ms) / GPU bubble ratio: 68.47%
[rank3]:2025-10-23 01:35:54,831 - INFO - Avg. fwd time: 76.8533 / Avg. bwd time: 91.0573 / Avg. batch time: 1391.9592 (ms) / GPU bubble ratio: 3.50%
[rank2]:2025-10-23 01:35:54,867 - INFO - Avg. fwd time: 35.0360 / Avg. bwd time: 35.8524 / Avg. batch time: 1483.5577 (ms) / GPU bubble ratio: 61.77%
[rank1]:2025-10-23 01:35:54,911 - INFO - Avg. fwd time: 55.4230 / Avg. bwd time: 57.8324 / Avg. batch time: 1601.1869 (ms) / GPU bubble ratio: 43.41%
[rank0]:2025-10-23 01:35:54,916 - INFO - Avg. fwd time: 47.8897 / Avg. bwd time: 16.9820 / Avg. batch time: 1655.7785 (ms) / GPU bubble ratio: 68.66%
[rank1]:2025-10-23 01:37:50,919 - INFO -  step: 220  loss: -8.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,785  tflops: 21.78  mfu: 6.98%
[rank3]:2025-10-23 01:37:50,919 - INFO -  step: 220  loss:  2.3394  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,785  tflops: 21.78  mfu: 6.98%
[rank0]:2025-10-23 01:37:50,919 - INFO -  step: 220  loss: -8.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,785  tflops: 21.78  mfu: 6.98%
[rank2]:2025-10-23 01:37:50,918 - INFO -  step: 220  loss: -8.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,785  tflops: 21.78  mfu: 6.98%
[rank3]:2025-10-23 01:37:52,324 - INFO - Avg. fwd time: 76.8639 / Avg. bwd time: 90.1768 / Avg. batch time: 1384.9581 (ms) / GPU bubble ratio: 3.51%
[rank2]:2025-10-23 01:37:52,359 - INFO - Avg. fwd time: 35.0250 / Avg. bwd time: 35.5600 / Avg. batch time: 1475.3955 (ms) / GPU bubble ratio: 61.73%
[rank1]:2025-10-23 01:37:52,402 - INFO - Avg. fwd time: 55.4061 / Avg. bwd time: 57.0039 / Avg. batch time: 1591.5973 (ms) / GPU bubble ratio: 43.50%
[rank0]:2025-10-23 01:37:52,408 - INFO - Avg. fwd time: 47.8786 / Avg. bwd time: 16.2102 / Avg. batch time: 1645.4087 (ms) / GPU bubble ratio: 68.84%
[rank2]:2025-10-23 01:39:49,926 - INFO - Avg. fwd time: 35.0269 / Avg. bwd time: 35.2938 / Avg. batch time: 1467.9690 (ms) / GPU bubble ratio: 61.68%
[rank1]:2025-10-23 01:39:49,971 - INFO - Avg. fwd time: 55.4255 / Avg. bwd time: 56.2426 / Avg. batch time: 1582.8683 (ms) / GPU bubble ratio: 43.56%
[rank3]:2025-10-23 01:39:49,891 - INFO - Avg. fwd time: 76.8611 / Avg. bwd time: 89.3795 / Avg. batch time: 1378.5782 (ms) / GPU bubble ratio: 3.53%
[rank0]:2025-10-23 01:39:49,977 - INFO - Avg. fwd time: 47.8736 / Avg. bwd time: 15.5055 / Avg. batch time: 1635.9662 (ms) / GPU bubble ratio: 69.01%
[rank0]:2025-10-23 01:41:46,061 - INFO -  step: 240  loss: -8.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,787  tflops: 21.79  mfu: 6.98%
[rank2]:2025-10-23 01:41:46,060 - INFO -  step: 240  loss: -8.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,787  tflops: 21.79  mfu: 6.98%
[rank1]:2025-10-23 01:41:46,061 - INFO -  step: 240  loss: -8.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,787  tflops: 21.79  mfu: 6.98%
[rank3]:2025-10-23 01:41:46,062 - INFO -  step: 240  loss:  2.2725  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,787  tflops: 21.79  mfu: 6.98%
[rank2]:2025-10-23 01:41:47,490 - INFO - Avg. fwd time: 35.0313 / Avg. bwd time: 35.0512 / Avg. batch time: 1461.1653 (ms) / GPU bubble ratio: 61.63%
[rank3]:2025-10-23 01:41:47,454 - INFO - Avg. fwd time: 76.8472 / Avg. bwd time: 88.6617 / Avg. batch time: 1372.7338 (ms) / GPU bubble ratio: 3.54%
[rank0]:2025-10-23 01:41:47,541 - INFO - Avg. fwd time: 47.8670 / Avg. bwd time: 14.8595 / Avg. batch time: 1627.3221 (ms) / GPU bubble ratio: 69.16%
[rank1]:2025-10-23 01:41:47,535 - INFO - Avg. fwd time: 55.4442 / Avg. bwd time: 55.5446 / Avg. batch time: 1574.8814 (ms) / GPU bubble ratio: 43.62%
[rank0]:2025-10-23 01:43:31,796 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-23 01:43:44,938 - INFO - Avg. fwd time: 76.8381 / Avg. bwd time: 87.9916 / Avg. batch time: 1367.3044 (ms) / GPU bubble ratio: 3.56%
[rank2]:2025-10-23 01:43:44,975 - INFO - Avg. fwd time: 35.0313 / Avg. bwd time: 34.8260 / Avg. batch time: 1454.8496 (ms) / GPU bubble ratio: 61.59%
[rank1]:2025-10-23 01:43:45,021 - INFO - Avg. fwd time: 55.4647 / Avg. bwd time: 54.9063 / Avg. batch time: 1567.4892 (ms) / GPU bubble ratio: 43.67%
[rank0]:2025-10-23 01:43:45,027 - INFO - Avg. fwd time: 47.8584 / Avg. bwd time: 14.2652 / Avg. batch time: 1619.3284 (ms) / GPU bubble ratio: 69.31%
[rank3]:2025-10-23 01:45:41,044 - INFO -  step: 260  loss:  2.2107  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,789  tflops: 21.80  mfu: 6.99%
[rank0]:2025-10-23 01:45:41,044 - INFO -  step: 260  loss: -8.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,789  tflops: 21.80  mfu: 6.99%
[rank2]:2025-10-23 01:45:41,042 - INFO -  step: 260  loss: -8.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,789  tflops: 21.80  mfu: 6.99%
[rank1]:2025-10-23 01:45:41,043 - INFO -  step: 260  loss: -8.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,789  tflops: 21.80  mfu: 6.99%
[rank3]:2025-10-23 01:45:42,446 - INFO - Avg. fwd time: 76.8427 / Avg. bwd time: 87.3665 / Avg. batch time: 1362.3417 (ms) / GPU bubble ratio: 3.57%
[rank2]:2025-10-23 01:45:42,481 - INFO - Avg. fwd time: 35.0256 / Avg. bwd time: 34.6174 / Avg. batch time: 1449.0656 (ms) / GPU bubble ratio: 61.55%
[rank1]:2025-10-23 01:45:42,529 - INFO - Avg. fwd time: 55.4678 / Avg. bwd time: 54.3111 / Avg. batch time: 1560.6840 (ms) / GPU bubble ratio: 43.73%
[rank0]:2025-10-23 01:45:42,535 - INFO - Avg. fwd time: 47.8479 / Avg. bwd time: 13.7167 / Avg. batch time: 1611.9696 (ms) / GPU bubble ratio: 69.45%
[rank3]:2025-10-23 01:47:40,006 - INFO - Avg. fwd time: 76.8451 / Avg. bwd time: 86.7950 / Avg. batch time: 1357.7584 (ms) / GPU bubble ratio: 3.58%
[rank2]:2025-10-23 01:47:40,042 - INFO - Avg. fwd time: 35.0262 / Avg. bwd time: 34.4257 / Avg. batch time: 1443.7286 (ms) / GPU bubble ratio: 61.52%
[rank1]:2025-10-23 01:47:40,087 - INFO - Avg. fwd time: 55.4530 / Avg. bwd time: 53.7615 / Avg. batch time: 1554.4128 (ms) / GPU bubble ratio: 43.79%
[rank0]:2025-10-23 01:47:40,093 - INFO - Avg. fwd time: 47.8398 / Avg. bwd time: 13.2087 / Avg. batch time: 1605.1838 (ms) / GPU bubble ratio: 69.57%
[rank0]:2025-10-23 01:49:36,164 - INFO -  step: 280  loss: -8.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,787  tflops: 21.79  mfu: 6.98%
[rank2]:2025-10-23 01:49:36,163 - INFO -  step: 280  loss: -8.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,787  tflops: 21.79  mfu: 6.98%
[rank1]:2025-10-23 01:49:36,164 - INFO -  step: 280  loss: -8.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,787  tflops: 21.79  mfu: 6.98%
[rank3]:2025-10-23 01:49:36,165 - INFO -  step: 280  loss:  2.3289  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,787  tflops: 21.79  mfu: 6.98%
[rank2]:2025-10-23 01:49:37,613 - INFO - Avg. fwd time: 35.0379 / Avg. bwd time: 34.2487 / Avg. batch time: 1438.7669 (ms) / GPU bubble ratio: 61.47%
[rank1]:2025-10-23 01:49:37,658 - INFO - Avg. fwd time: 55.4700 / Avg. bwd time: 53.2496 / Avg. batch time: 1548.5829 (ms) / GPU bubble ratio: 43.84%
[rank3]:2025-10-23 01:49:37,578 - INFO - Avg. fwd time: 76.8381 / Avg. bwd time: 86.2677 / Avg. batch time: 1353.4836 (ms) / GPU bubble ratio: 3.59%
[rank0]:2025-10-23 01:49:37,664 - INFO - Avg. fwd time: 47.8355 / Avg. bwd time: 12.7371 / Avg. batch time: 1598.8752 (ms) / GPU bubble ratio: 69.69%
[rank3]:2025-10-23 01:51:35,194 - INFO - Avg. fwd time: 76.8335 / Avg. bwd time: 85.7741 / Avg. batch time: 1349.5206 (ms) / GPU bubble ratio: 3.61%
[rank2]:2025-10-23 01:51:35,231 - INFO - Avg. fwd time: 35.0376 / Avg. bwd time: 34.0835 / Avg. batch time: 1434.1473 (ms) / GPU bubble ratio: 61.44%
[rank1]:2025-10-23 01:51:35,278 - INFO - Avg. fwd time: 55.4726 / Avg. bwd time: 52.7754 / Avg. batch time: 1543.1688 (ms) / GPU bubble ratio: 43.88%
[rank0]:2025-10-23 01:51:35,284 - INFO - Avg. fwd time: 47.8314 / Avg. bwd time: 12.2979 / Avg. batch time: 1593.0138 (ms) / GPU bubble ratio: 69.80%
[rank0]:2025-10-23 01:53:19,618 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-23 01:53:31,371 - INFO -  step: 300  loss:  2.3151  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,786  tflops: 21.78  mfu: 6.98%
[rank0]:2025-10-23 01:53:31,370 - INFO -  step: 300  loss: -8.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,786  tflops: 21.78  mfu: 6.98%
[rank2]:2025-10-23 01:53:31,369 - INFO -  step: 300  loss: -8.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,786  tflops: 21.78  mfu: 6.98%
[rank1]:2025-10-23 01:53:31,371 - INFO -  step: 300  loss: -8.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,786  tflops: 21.78  mfu: 6.98%
[rank3]:2025-10-23 01:53:31,589 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_gpipe_fullrand7_dm1/pipeline_schedule/251023_0153_real_step300_rank3.svg
[rank3]:> Batch Time: 1387.28 ms, GPU Bubble Ratio: 72.23%, 44.52%, 63.15%, 13.54%
[rank3]:2025-10-23 01:53:31,656 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1023_gpipe_fullrand7_dm1/freeze_ratio_history/rank3/251023_0153_stage3_step300.svg
[rank3]:2025-10-23 01:53:32,948 - INFO - Avg. fwd time: 76.8344 / Avg. bwd time: 85.3101 / Avg. batch time: 1345.8065 (ms) / GPU bubble ratio: 3.61%
[rank2]:2025-10-23 01:53:32,984 - INFO - Avg. fwd time: 35.0399 / Avg. bwd time: 33.9283 / Avg. batch time: 1429.8938 (ms) / GPU bubble ratio: 61.41%
[rank1]:2025-10-23 01:53:33,028 - INFO - Avg. fwd time: 55.4727 / Avg. bwd time: 52.3308 / Avg. batch time: 1538.1523 (ms) / GPU bubble ratio: 43.93%
[rank0]:2025-10-23 01:53:33,034 - INFO - Avg. fwd time: 47.8221 / Avg. bwd time: 11.8881 / Avg. batch time: 1587.5839 (ms) / GPU bubble ratio: 69.91%
[rank3]:2025-10-23 01:55:30,533 - INFO - Avg. fwd time: 76.8308 / Avg. bwd time: 84.8806 / Avg. batch time: 1342.3414 (ms) / GPU bubble ratio: 3.62%
[rank2]:2025-10-23 01:55:30,572 - INFO - Avg. fwd time: 35.0425 / Avg. bwd time: 33.7841 / Avg. batch time: 1425.8591 (ms) / GPU bubble ratio: 61.38%
[rank0]:2025-10-23 01:55:30,624 - INFO - Avg. fwd time: 47.8092 / Avg. bwd time: 11.5047 / Avg. batch time: 1582.4554 (ms) / GPU bubble ratio: 70.01%
[rank1]:2025-10-23 01:55:30,617 - INFO - Avg. fwd time: 55.4870 / Avg. bwd time: 51.9162 / Avg. batch time: 1533.4184 (ms) / GPU bubble ratio: 43.97%
[rank2]:2025-10-23 01:57:27,010 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_gpipe_fullrand7_dm1/pipeline_schedule_adjustment/251023_0157_rank2_trend_line.svg
[rank1]:2025-10-23 01:57:27,045 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_gpipe_fullrand7_dm1/pipeline_schedule_adjustment/251023_0157_rank1_trend_line.svg
[rank1]:2025-10-23 01:57:27,065 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-10-23 01:57:27,068 - INFO -  step: 320  loss: -8.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,781  tflops: 21.74  mfu: 6.97%
[rank3]:2025-10-23 01:57:27,003 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_gpipe_fullrand7_dm1/pipeline_schedule_adjustment/251023_0157_rank3_trend_line.svg
[rank0]:2025-10-23 01:57:27,060 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_gpipe_fullrand7_dm1/pipeline_schedule_adjustment/251023_0157_rank0_trend_line.svg
[rank0]:2025-10-23 01:57:27,068 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank0]:2025-10-23 01:57:27,070 - INFO -  step: 320  loss: -8.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,780  tflops: 21.74  mfu: 6.97%
[rank2]:2025-10-23 01:57:27,066 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank2]:2025-10-23 01:57:27,068 - INFO -  step: 320  loss: -8.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,781  tflops: 21.74  mfu: 6.97%
[rank3]:2025-10-23 01:57:27,286 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_gpipe_fullrand7_dm1/pipeline_schedule/251023_0157_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 1404.97 ms, GPU Bubble Ratio: 71.22%, 40.94%, 63.42%, 13.40%
[rank3]:2025-10-23 01:57:27,287 - INFO - 	> Batch Time: 1404.97 ms (Average Freeze Ratio: 0.28)
[rank3]:2025-10-23 01:57:27,288 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-23 01:57:27,292 - INFO -  step: 320  loss:  2.3638  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,778  tflops: 21.72  mfu: 6.96%
[rank3]:2025-10-23 01:57:28,575 - INFO - Avg. fwd time: 76.8278 / Avg. bwd time: 84.4779 / Avg. batch time: 1339.0615 (ms) / GPU bubble ratio: 3.63%
[rank2]:2025-10-23 01:57:28,612 - INFO - Avg. fwd time: 35.0472 / Avg. bwd time: 33.6488 / Avg. batch time: 1422.0942 (ms) / GPU bubble ratio: 61.36%
[rank1]:2025-10-23 01:57:28,660 - INFO - Avg. fwd time: 55.4911 / Avg. bwd time: 51.5264 / Avg. batch time: 1528.9940 (ms) / GPU bubble ratio: 44.01%
[rank0]:2025-10-23 01:57:28,667 - INFO - Avg. fwd time: 47.7978 / Avg. bwd time: 11.1452 / Avg. batch time: 1577.6619 (ms) / GPU bubble ratio: 70.11%
[rank3]:2025-10-23 01:59:37,825 - INFO - Avg. fwd time: 76.8059 / Avg. bwd time: 84.0885 / Avg. batch time: 1335.7781 (ms) / GPU bubble ratio: 3.64%
[rank2]:2025-10-23 01:59:37,921 - INFO - Avg. fwd time: 35.0517 / Avg. bwd time: 34.6606 / Avg. batch time: 1419.9631 (ms) / GPU bubble ratio: 60.72%
[rank1]:2025-10-23 01:59:37,971 - INFO - Avg. fwd time: 55.4691 / Avg. bwd time: 51.1520 / Avg. batch time: 1526.2613 (ms) / GPU bubble ratio: 44.11%
[rank0]:2025-10-23 01:59:38,055 - INFO - Avg. fwd time: 47.8162 / Avg. bwd time: 13.0040 / Avg. batch time: 1577.4437 (ms) / GPU bubble ratio: 69.16%
[rank2]:2025-10-23 02:01:46,286 - INFO -  step: 340  loss: -8.0000  grad_norm:  0.6890  memory: 16.10GiB(33.90%)  tps: 2,528  tflops: 19.76  mfu: 6.33%
[rank1]:2025-10-23 02:01:46,273 - INFO -  step: 340  loss: -8.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,528  tflops: 19.77  mfu: 6.34%
[rank3]:2025-10-23 02:01:46,275 - INFO -  step: 340  loss:  2.3717  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,531  tflops: 19.78  mfu: 6.34%
[rank0]:2025-10-23 02:01:46,307 - INFO -  step: 340  loss: -8.0000  grad_norm:  0.6890  memory: 20.89GiB(43.97%)  tps: 2,528  tflops: 19.76  mfu: 6.33%
[rank3]:2025-10-23 02:01:47,716 - INFO - Avg. fwd time: 76.7911 / Avg. bwd time: 83.7216 / Avg. batch time: 1332.7454 (ms) / GPU bubble ratio: 3.65%
[rank2]:2025-10-23 02:01:47,806 - INFO - Avg. fwd time: 35.0515 / Avg. bwd time: 35.6146 / Avg. batch time: 1418.0738 (ms) / GPU bubble ratio: 60.13%
[rank1]:2025-10-23 02:01:47,851 - INFO - Avg. fwd time: 55.4561 / Avg. bwd time: 50.7974 / Avg. batch time: 1523.8010 (ms) / GPU bubble ratio: 44.22%
[rank0]:2025-10-23 02:01:47,946 - INFO - Avg. fwd time: 47.8430 / Avg. bwd time: 14.7746 / Avg. batch time: 1577.4575 (ms) / GPU bubble ratio: 68.24%
[rank0]:2025-10-23 02:03:43,087 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-23 02:03:57,515 - INFO - Avg. fwd time: 76.7782 / Avg. bwd time: 83.3771 / Avg. batch time: 1329.8689 (ms) / GPU bubble ratio: 3.66%
[rank2]:2025-10-23 02:03:57,614 - INFO - Avg. fwd time: 35.0544 / Avg. bwd time: 36.5173 / Avg. batch time: 1416.2785 (ms) / GPU bubble ratio: 59.57%
[rank1]:2025-10-23 02:03:57,660 - INFO - Avg. fwd time: 55.4371 / Avg. bwd time: 50.4681 / Avg. batch time: 1521.4579 (ms) / GPU bubble ratio: 44.31%
[rank0]:2025-10-23 02:03:57,754 - INFO - Avg. fwd time: 47.8758 / Avg. bwd time: 16.4467 / Avg. batch time: 1577.4419 (ms) / GPU bubble ratio: 67.38%
[rank1]:2025-10-23 02:06:06,042 - INFO -  step: 360  loss: -8.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,523  tflops: 19.72  mfu: 6.32%
[rank3]:2025-10-23 02:06:06,043 - INFO -  step: 360  loss:  2.4022  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,523  tflops: 19.72  mfu: 6.32%
[rank0]:2025-10-23 02:06:06,075 - INFO -  step: 360  loss: -8.0000  grad_norm:  0.3843  memory: 20.89GiB(43.97%)  tps: 2,523  tflops: 19.72  mfu: 6.32%
[rank2]:2025-10-23 02:06:06,055 - INFO -  step: 360  loss: -8.0000  grad_norm:  0.3843  memory: 16.10GiB(33.90%)  tps: 2,523  tflops: 19.72  mfu: 6.32%
[rank3]:2025-10-23 02:06:07,476 - INFO - Avg. fwd time: 76.7687 / Avg. bwd time: 83.0519 / Avg. batch time: 1327.1725 (ms) / GPU bubble ratio: 3.66%
[rank2]:2025-10-23 02:06:07,566 - INFO - Avg. fwd time: 35.0587 / Avg. bwd time: 37.3714 / Avg. batch time: 1414.6138 (ms) / GPU bubble ratio: 59.04%
[rank1]:2025-10-23 02:06:07,611 - INFO - Avg. fwd time: 55.4181 / Avg. bwd time: 50.1548 / Avg. batch time: 1519.2751 (ms) / GPU bubble ratio: 44.41%
[rank0]:2025-10-23 02:06:07,701 - INFO - Avg. fwd time: 47.9074 / Avg. bwd time: 18.0310 / Avg. batch time: 1577.4781 (ms) / GPU bubble ratio: 66.56%
[rank3]:2025-10-23 02:08:17,115 - INFO - Avg. fwd time: 76.7476 / Avg. bwd time: 82.7455 / Avg. batch time: 1324.5330 (ms) / GPU bubble ratio: 3.67%
[rank2]:2025-10-23 02:08:17,201 - INFO - Avg. fwd time: 35.0637 / Avg. bwd time: 38.1827 / Avg. batch time: 1412.9348 (ms) / GPU bubble ratio: 58.53%
[rank1]:2025-10-23 02:08:17,248 - INFO - Avg. fwd time: 55.4047 / Avg. bwd time: 49.8581 / Avg. batch time: 1517.0967 (ms) / GPU bubble ratio: 44.49%
[rank0]:2025-10-23 02:08:17,341 - INFO - Avg. fwd time: 47.9317 / Avg. bwd time: 19.5310 / Avg. batch time: 1577.4100 (ms) / GPU bubble ratio: 65.79%
[rank2]:2025-10-23 02:10:24,931 - INFO -  step: 380  loss: -8.0000  grad_norm:  0.3471  memory: 16.10GiB(33.90%)  tps: 2,532  tflops: 19.79  mfu: 6.34%
[rank0]:2025-10-23 02:10:24,951 - INFO -  step: 380  loss: -8.0000  grad_norm:  0.3471  memory: 20.89GiB(43.97%)  tps: 2,532  tflops: 19.79  mfu: 6.34%
[rank1]:2025-10-23 02:10:24,918 - INFO -  step: 380  loss: -8.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,532  tflops: 19.79  mfu: 6.34%
[rank3]:2025-10-23 02:10:24,919 - INFO -  step: 380  loss:  2.3082  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,532  tflops: 19.79  mfu: 6.34%
[rank3]:2025-10-23 02:10:26,335 - INFO - Avg. fwd time: 76.7110 / Avg. bwd time: 82.4505 / Avg. batch time: 1321.8856 (ms) / GPU bubble ratio: 3.68%
[rank2]:2025-10-23 02:10:26,426 - INFO - Avg. fwd time: 35.0693 / Avg. bwd time: 38.9526 / Avg. batch time: 1411.2024 (ms) / GPU bubble ratio: 58.04%
[rank1]:2025-10-23 02:10:26,472 - INFO - Avg. fwd time: 55.3963 / Avg. bwd time: 49.5739 / Avg. batch time: 1514.9030 (ms) / GPU bubble ratio: 44.57%
[rank0]:2025-10-23 02:10:26,563 - INFO - Avg. fwd time: 47.9494 / Avg. bwd time: 20.9465 / Avg. batch time: 1577.1962 (ms) / GPU bubble ratio: 65.05%
[rank3]:2025-10-23 02:12:35,447 - INFO - Avg. fwd time: 76.6796 / Avg. bwd time: 82.1707 / Avg. batch time: 1319.4094 (ms) / GPU bubble ratio: 3.68%
[rank2]:2025-10-23 02:12:35,533 - INFO - Avg. fwd time: 35.0712 / Avg. bwd time: 39.6741 / Avg. batch time: 1409.5652 (ms) / GPU bubble ratio: 57.58%
[rank1]:2025-10-23 02:12:35,581 - INFO - Avg. fwd time: 55.3807 / Avg. bwd time: 49.3037 / Avg. batch time: 1512.8258 (ms) / GPU bubble ratio: 44.64%
[rank0]:2025-10-23 02:12:35,673 - INFO - Avg. fwd time: 47.9678 / Avg. bwd time: 22.2842 / Avg. batch time: 1576.9991 (ms) / GPU bubble ratio: 64.36%
[rank0]:2025-10-23 02:14:30,579 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-23 02:14:43,511 - INFO -  step: 400  loss: -8.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,534  tflops: 19.81  mfu: 6.35%
[rank3]:2025-10-23 02:14:43,512 - INFO -  step: 400  loss:  2.3689  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,534  tflops: 19.81  mfu: 6.35%
[rank0]:2025-10-23 02:14:43,545 - INFO -  step: 400  loss: -8.0000  grad_norm:  0.3313  memory: 20.89GiB(43.97%)  tps: 2,534  tflops: 19.81  mfu: 6.35%
[rank2]:2025-10-23 02:14:43,524 - INFO -  step: 400  loss: -8.0000  grad_norm:  0.3313  memory: 16.10GiB(33.90%)  tps: 2,534  tflops: 19.81  mfu: 6.35%
[rank3]:2025-10-23 02:14:43,755 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_gpipe_fullrand7_dm1/pipeline_schedule/251023_0214_real_step400_rank3.svg
[rank3]:> Batch Time: 1384.94 ms, GPU Bubble Ratio: 72.11%, 44.79%, 62.99%, 13.60%
[rank3]:2025-10-23 02:14:43,820 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1023_gpipe_fullrand7_dm1/freeze_ratio_history/rank3/251023_0214_stage3_step400.svg
[rank3]:2025-10-23 02:14:45,104 - INFO - Avg. fwd time: 76.6606 / Avg. bwd time: 81.9076 / Avg. batch time: 1317.1647 (ms) / GPU bubble ratio: 3.69%
[rank2]:2025-10-23 02:14:45,193 - INFO - Avg. fwd time: 35.0724 / Avg. bwd time: 40.3615 / Avg. batch time: 1408.1607 (ms) / GPU bubble ratio: 57.14%
[rank1]:2025-10-23 02:14:45,239 - INFO - Avg. fwd time: 55.3689 / Avg. bwd time: 49.0483 / Avg. batch time: 1511.0038 (ms) / GPU bubble ratio: 44.72%
[rank0]:2025-10-23 02:14:45,331 - INFO - Avg. fwd time: 47.9911 / Avg. bwd time: 23.5580 / Avg. batch time: 1576.9564 (ms) / GPU bubble ratio: 63.70%
[rank3]:2025-10-23 02:16:54,537 - INFO - Avg. fwd time: 76.6373 / Avg. bwd time: 81.6574 / Avg. batch time: 1314.9634 (ms) / GPU bubble ratio: 3.70%
[rank2]:2025-10-23 02:16:54,621 - INFO - Avg. fwd time: 35.0768 / Avg. bwd time: 41.0201 / Avg. batch time: 1406.7405 (ms) / GPU bubble ratio: 56.72%
[rank1]:2025-10-23 02:16:54,668 - INFO - Avg. fwd time: 55.3629 / Avg. bwd time: 48.8063 / Avg. batch time: 1509.1741 (ms) / GPU bubble ratio: 44.78%
[rank0]:2025-10-23 02:16:54,767 - INFO - Avg. fwd time: 48.0130 / Avg. bwd time: 24.7784 / Avg. batch time: 1576.8472 (ms) / GPU bubble ratio: 63.07%
[rank3]:2025-10-23 02:19:02,596 - INFO -  step: 420  loss:  2.1984  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,530  tflops: 19.77  mfu: 6.34%
[rank0]:2025-10-23 02:19:02,628 - INFO -  step: 420  loss: -8.0000  grad_norm:  0.2867  memory: 20.89GiB(43.97%)  tps: 2,530  tflops: 19.77  mfu: 6.34%
[rank1]:2025-10-23 02:19:02,595 - INFO -  step: 420  loss: -8.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,530  tflops: 19.77  mfu: 6.34%
[rank2]:2025-10-23 02:19:02,608 - INFO -  step: 420  loss: -8.0000  grad_norm:  0.2867  memory: 16.10GiB(33.90%)  tps: 2,530  tflops: 19.77  mfu: 6.34%
[rank3]:2025-10-23 02:19:04,018 - INFO - Avg. fwd time: 76.6211 / Avg. bwd time: 81.4188 / Avg. batch time: 1312.9046 (ms) / GPU bubble ratio: 3.70%
[rank1]:2025-10-23 02:19:04,152 - INFO - Avg. fwd time: 55.3515 / Avg. bwd time: 48.5764 / Avg. batch time: 1507.4637 (ms) / GPU bubble ratio: 44.85%
[rank2]:2025-10-23 02:19:04,107 - INFO - Avg. fwd time: 35.0755 / Avg. bwd time: 41.6422 / Avg. batch time: 1405.4158 (ms) / GPU bubble ratio: 56.33%
[rank0]:2025-10-23 02:19:04,246 - INFO - Avg. fwd time: 48.0355 / Avg. bwd time: 25.9351 / Avg. batch time: 1576.7656 (ms) / GPU bubble ratio: 62.47%
[rank3]:2025-10-23 02:21:13,488 - INFO - Avg. fwd time: 76.6084 / Avg. bwd time: 81.1898 / Avg. batch time: 1310.9520 (ms) / GPU bubble ratio: 3.70%
[rank1]:2025-10-23 02:21:13,628 - INFO - Avg. fwd time: 55.3423 / Avg. bwd time: 48.3547 / Avg. batch time: 1505.8457 (ms) / GPU bubble ratio: 44.91%
[rank2]:2025-10-23 02:21:13,581 - INFO - Avg. fwd time: 35.0780 / Avg. bwd time: 42.2365 / Avg. batch time: 1404.1659 (ms) / GPU bubble ratio: 55.95%
[rank0]:2025-10-23 02:21:13,721 - INFO - Avg. fwd time: 48.0549 / Avg. bwd time: 27.0333 / Avg. batch time: 1576.6839 (ms) / GPU bubble ratio: 61.90%
[rank1]:2025-10-23 02:23:21,852 - INFO -  step: 440  loss: -8.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,528  tflops: 19.76  mfu: 6.33%
[rank0]:2025-10-23 02:23:21,886 - INFO -  step: 440  loss: -8.0000  grad_norm:  0.2809  memory: 20.89GiB(43.97%)  tps: 2,528  tflops: 19.76  mfu: 6.33%
[rank2]:2025-10-23 02:23:21,866 - INFO -  step: 440  loss: -8.0000  grad_norm:  0.2809  memory: 16.10GiB(33.90%)  tps: 2,528  tflops: 19.76  mfu: 6.33%
[rank3]:2025-10-23 02:23:21,854 - INFO -  step: 440  loss:  2.1689  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,528  tflops: 19.76  mfu: 6.33%
[rank3]:2025-10-23 02:23:23,297 - INFO - Avg. fwd time: 76.5965 / Avg. bwd time: 80.9748 / Avg. batch time: 1309.1297 (ms) / GPU bubble ratio: 3.71%
[rank2]:2025-10-23 02:23:23,387 - INFO - Avg. fwd time: 35.0830 / Avg. bwd time: 42.8091 / Avg. batch time: 1403.0205 (ms) / GPU bubble ratio: 55.59%
[rank1]:2025-10-23 02:23:23,433 - INFO - Avg. fwd time: 55.3348 / Avg. bwd time: 48.1474 / Avg. batch time: 1504.3525 (ms) / GPU bubble ratio: 44.97%
[rank0]:2025-10-23 02:23:23,521 - INFO - Avg. fwd time: 48.0779 / Avg. bwd time: 28.0898 / Avg. batch time: 1576.6920 (ms) / GPU bubble ratio: 61.35%
[rank0]:2025-10-23 02:25:18,514 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-23 02:25:32,937 - INFO - Avg. fwd time: 76.5907 / Avg. bwd time: 80.7678 / Avg. batch time: 1307.4054 (ms) / GPU bubble ratio: 3.71%
[rank2]:2025-10-23 02:25:33,022 - INFO - Avg. fwd time: 35.0852 / Avg. bwd time: 43.3519 / Avg. batch time: 1401.9348 (ms) / GPU bubble ratio: 55.24%
[rank1]:2025-10-23 02:25:33,070 - INFO - Avg. fwd time: 55.3222 / Avg. bwd time: 47.9467 / Avg. batch time: 1502.9261 (ms) / GPU bubble ratio: 45.03%
[rank0]:2025-10-23 02:25:33,161 - INFO - Avg. fwd time: 48.0960 / Avg. bwd time: 29.0936 / Avg. batch time: 1576.6783 (ms) / GPU bubble ratio: 60.83%
[rank3]:2025-10-23 02:27:40,775 - INFO -  step: 460  loss:  2.2008  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,531  tflops: 19.79  mfu: 6.34%
[rank0]:2025-10-23 02:27:40,807 - INFO -  step: 460  loss: -8.0000  grad_norm:  0.4503  memory: 20.89GiB(43.97%)  tps: 2,531  tflops: 19.79  mfu: 6.34%
[rank2]:2025-10-23 02:27:40,787 - INFO -  step: 460  loss: -8.0000  grad_norm:  0.4503  memory: 16.10GiB(33.90%)  tps: 2,531  tflops: 19.79  mfu: 6.34%
[rank1]:2025-10-23 02:27:40,774 - INFO -  step: 460  loss: -8.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,531  tflops: 19.79  mfu: 6.34%
[rank3]:2025-10-23 02:27:42,197 - INFO - Avg. fwd time: 76.5740 / Avg. bwd time: 80.5691 / Avg. batch time: 1305.6496 (ms) / GPU bubble ratio: 3.71%
[rank2]:2025-10-23 02:27:42,281 - INFO - Avg. fwd time: 35.0888 / Avg. bwd time: 43.8723 / Avg. batch time: 1400.7784 (ms) / GPU bubble ratio: 54.90%
[rank1]:2025-10-23 02:27:42,328 - INFO - Avg. fwd time: 55.3043 / Avg. bwd time: 47.7564 / Avg. batch time: 1501.4482 (ms) / GPU bubble ratio: 45.09%
[rank0]:2025-10-23 02:27:42,422 - INFO - Avg. fwd time: 48.1119 / Avg. bwd time: 30.0580 / Avg. batch time: 1576.5546 (ms) / GPU bubble ratio: 60.33%
[rank3]:2025-10-23 02:29:51,220 - INFO - Avg. fwd time: 76.5527 / Avg. bwd time: 80.3773 / Avg. batch time: 1303.9237 (ms) / GPU bubble ratio: 3.72%
[rank2]:2025-10-23 02:29:51,302 - INFO - Avg. fwd time: 35.0902 / Avg. bwd time: 44.3676 / Avg. batch time: 1399.6224 (ms) / GPU bubble ratio: 54.58%
[rank1]:2025-10-23 02:29:51,348 - INFO - Avg. fwd time: 55.2933 / Avg. bwd time: 47.5714 / Avg. batch time: 1499.9760 (ms) / GPU bubble ratio: 45.14%
[rank0]:2025-10-23 02:29:51,444 - INFO - Avg. fwd time: 48.1292 / Avg. bwd time: 30.9803 / Avg. batch time: 1576.3918 (ms) / GPU bubble ratio: 59.85%
[rank3]:2025-10-23 02:31:58,710 - INFO -  step: 480  loss:  2.1823  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,541  tflops: 19.86  mfu: 6.37%
[rank0]:2025-10-23 02:31:58,742 - INFO -  step: 480  loss: -8.0000  grad_norm:  0.2551  memory: 20.89GiB(43.97%)  tps: 2,541  tflops: 19.86  mfu: 6.37%
[rank1]:2025-10-23 02:31:58,709 - INFO -  step: 480  loss: -8.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,541  tflops: 19.86  mfu: 6.37%
[rank2]:2025-10-23 02:31:58,722 - INFO -  step: 480  loss: -8.0000  grad_norm:  0.2551  memory: 16.10GiB(33.90%)  tps: 2,541  tflops: 19.86  mfu: 6.37%
[rank3]:2025-10-23 02:32:00,157 - INFO - Avg. fwd time: 76.5245 / Avg. bwd time: 80.1930 / Avg. batch time: 1302.2170 (ms) / GPU bubble ratio: 3.72%
[rank2]:2025-10-23 02:32:00,238 - INFO - Avg. fwd time: 35.0899 / Avg. bwd time: 44.8422 / Avg. batch time: 1398.4613 (ms) / GPU bubble ratio: 54.27%
[rank1]:2025-10-23 02:32:00,286 - INFO - Avg. fwd time: 55.2895 / Avg. bwd time: 47.3949 / Avg. batch time: 1498.5248 (ms) / GPU bubble ratio: 45.18%
[rank0]:2025-10-23 02:32:00,377 - INFO - Avg. fwd time: 48.1384 / Avg. bwd time: 31.8629 / Avg. batch time: 1576.1902 (ms) / GPU bubble ratio: 59.40%
[rank3]:2025-10-23 02:34:08,907 - INFO - Avg. fwd time: 76.4935 / Avg. bwd time: 80.0171 / Avg. batch time: 1300.5642 (ms) / GPU bubble ratio: 3.73%
[rank1]:2025-10-23 02:34:09,038 - INFO - Avg. fwd time: 55.2847 / Avg. bwd time: 47.2252 / Avg. batch time: 1497.0945 (ms) / GPU bubble ratio: 45.22%
[rank2]:2025-10-23 02:34:08,990 - INFO - Avg. fwd time: 35.0958 / Avg. bwd time: 45.2978 / Avg. batch time: 1397.3214 (ms) / GPU bubble ratio: 53.97%
[rank0]:2025-10-23 02:34:09,131 - INFO - Avg. fwd time: 48.1483 / Avg. bwd time: 32.7075 / Avg. batch time: 1575.9627 (ms) / GPU bubble ratio: 58.96%
[rank0]:2025-10-23 02:36:03,778 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-23 02:36:16,677 - INFO -  step: 500  loss: -8.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,540  tflops: 19.86  mfu: 6.37%
[rank1]:2025-10-23 02:36:16,677 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-23 02:36:16,710 - INFO -  step: 500  loss: -8.0000  grad_norm:  0.3505  memory: 20.89GiB(43.97%)  tps: 2,540  tflops: 19.86  mfu: 6.37%
[rank0]:2025-10-23 02:36:16,711 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-23 02:36:16,711 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank2]:2025-10-23 02:36:16,690 - INFO -  step: 500  loss: -8.0000  grad_norm:  0.3505  memory: 16.10GiB(33.90%)  tps: 2,540  tflops: 19.86  mfu: 6.37%
[rank2]:2025-10-23 02:36:16,690 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-23 02:36:16,678 - INFO -  step: 500  loss:  2.1909  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,540  tflops: 19.86  mfu: 6.37%
[rank3]:2025-10-23 02:36:16,679 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-23 02:36:18,504 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 1.81 seconds.
[rank1]:2025-10-23 02:36:19,011 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 2.33 seconds.
[rank3]:2025-10-23 02:36:20,029 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.35 seconds.
[rank0]:2025-10-23 02:36:20,458 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-23 02:36:20,468 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.76 seconds.
[rank3]:2025-10-23 02:36:20,826 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_gpipe_fullrand7_dm1/pipeline_schedule/251023_0236_real_step500_rank3.svg
[rank3]:> Batch Time: 1382.07 ms, GPU Bubble Ratio: 71.95%, 44.91%, 62.50%, 13.67%
[rank3]:2025-10-23 02:36:20,888 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1023_gpipe_fullrand7_dm1/freeze_ratio_history/rank3/251023_0236_stage3_step500.svg
[rank3]:2025-10-23 02:36:22,154 - INFO - Avg. fwd time: 76.4775 / Avg. bwd time: 79.8497 / Avg. batch time: 1299.0773 (ms) / GPU bubble ratio: 3.73%
[rank1]:2025-10-23 02:36:22,289 - INFO - Avg. fwd time: 55.2703 / Avg. bwd time: 47.0636 / Avg. batch time: 1495.9049 (ms) / GPU bubble ratio: 45.27%
[rank2]:2025-10-23 02:36:22,243 - INFO - Avg. fwd time: 35.0995 / Avg. bwd time: 45.7370 / Avg. batch time: 1396.4133 (ms) / GPU bubble ratio: 53.69%
[rank0]:2025-10-23 02:36:22,385 - INFO - Avg. fwd time: 48.1635 / Avg. bwd time: 33.5208 / Avg. batch time: 1575.9190 (ms) / GPU bubble ratio: 58.53%
[rank3]:2025-10-23 02:38:31,377 - INFO - Avg. fwd time: 76.4651 / Avg. bwd time: 79.6902 / Avg. batch time: 1297.6809 (ms) / GPU bubble ratio: 3.73%
[rank2]:2025-10-23 02:38:31,460 - INFO - Avg. fwd time: 35.1006 / Avg. bwd time: 46.1558 / Avg. batch time: 1395.4896 (ms) / GPU bubble ratio: 53.42%
[rank1]:2025-10-23 02:38:31,508 - INFO - Avg. fwd time: 55.2556 / Avg. bwd time: 46.9075 / Avg. batch time: 1494.7166 (ms) / GPU bubble ratio: 45.32%
[rank0]:2025-10-23 02:38:31,596 - INFO - Avg. fwd time: 48.1719 / Avg. bwd time: 34.2964 / Avg. batch time: 1575.8087 (ms) / GPU bubble ratio: 58.13%
[rank3]:2025-10-23 02:40:39,373 - INFO -  step: 520  loss:  2.2943  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,495  tflops: 19.50  mfu: 6.25%
[rank1]:2025-10-23 02:40:39,372 - INFO -  step: 520  loss: -8.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,495  tflops: 19.50  mfu: 6.25%
[rank0]:2025-10-23 02:40:39,406 - INFO -  step: 520  loss: -8.0000  grad_norm:  0.2334  memory: 20.89GiB(43.97%)  tps: 2,495  tflops: 19.50  mfu: 6.25%
[rank2]:2025-10-23 02:40:39,385 - INFO -  step: 520  loss: -8.0000  grad_norm:  0.2334  memory: 16.10GiB(33.90%)  tps: 2,495  tflops: 19.50  mfu: 6.25%
[rank3]:2025-10-23 02:40:40,808 - INFO - Avg. fwd time: 76.4568 / Avg. bwd time: 79.5357 / Avg. batch time: 1296.3512 (ms) / GPU bubble ratio: 3.73%
[rank2]:2025-10-23 02:40:40,895 - INFO - Avg. fwd time: 35.1022 / Avg. bwd time: 46.5616 / Avg. batch time: 1394.6266 (ms) / GPU bubble ratio: 53.16%
[rank1]:2025-10-23 02:40:40,944 - INFO - Avg. fwd time: 55.2416 / Avg. bwd time: 46.7593 / Avg. batch time: 1493.6061 (ms) / GPU bubble ratio: 45.37%
[rank0]:2025-10-23 02:40:41,030 - INFO - Avg. fwd time: 48.1803 / Avg. bwd time: 35.0453 / Avg. batch time: 1575.7427 (ms) / GPU bubble ratio: 57.75%
[rank3]:2025-10-23 02:42:49,988 - INFO - Avg. fwd time: 76.4428 / Avg. bwd time: 79.3850 / Avg. batch time: 1295.0258 (ms) / GPU bubble ratio: 3.74%
[rank2]:2025-10-23 02:42:50,082 - INFO - Avg. fwd time: 35.1031 / Avg. bwd time: 46.9475 / Avg. batch time: 1393.7486 (ms) / GPU bubble ratio: 52.90%
[rank1]:2025-10-23 02:42:50,129 - INFO - Avg. fwd time: 55.2329 / Avg. bwd time: 46.6142 / Avg. batch time: 1492.4855 (ms) / GPU bubble ratio: 45.41%
[rank0]:2025-10-23 02:42:50,226 - INFO - Avg. fwd time: 48.1915 / Avg. bwd time: 35.7662 / Avg. batch time: 1575.6290 (ms) / GPU bubble ratio: 57.37%
[rank2]:2025-10-23 02:44:57,863 - INFO -  step: 540  loss: -8.0000  grad_norm:  0.2452  memory: 16.10GiB(33.90%)  tps: 2,535  tflops: 19.82  mfu: 6.35%
[rank3]:2025-10-23 02:44:57,851 - INFO -  step: 540  loss:  2.0583  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,535  tflops: 19.82  mfu: 6.35%
[rank1]:2025-10-23 02:44:57,850 - INFO -  step: 540  loss: -8.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,535  tflops: 19.82  mfu: 6.35%
[rank0]:2025-10-23 02:44:57,891 - INFO -  step: 540  loss: -8.0000  grad_norm:  0.2452  memory: 20.89GiB(43.97%)  tps: 2,535  tflops: 19.82  mfu: 6.35%
[rank3]:2025-10-23 02:44:59,297 - INFO - Avg. fwd time: 76.4289 / Avg. bwd time: 79.2427 / Avg. batch time: 1293.7620 (ms) / GPU bubble ratio: 3.74%
[rank2]:2025-10-23 02:44:59,386 - INFO - Avg. fwd time: 35.1060 / Avg. bwd time: 47.3254 / Avg. batch time: 1392.9286 (ms) / GPU bubble ratio: 52.66%
[rank1]:2025-10-23 02:44:59,433 - INFO - Avg. fwd time: 55.2249 / Avg. bwd time: 46.4786 / Avg. batch time: 1491.4314 (ms) / GPU bubble ratio: 45.45%
[rank0]:2025-10-23 02:44:59,528 - INFO - Avg. fwd time: 48.2035 / Avg. bwd time: 36.4599 / Avg. batch time: 1575.5391 (ms) / GPU bubble ratio: 57.01%
[rank0]:2025-10-23 02:46:54,834 - INFO - [GC] Peforming periodical GC collection 0.23 seconds
[rank3]:2025-10-23 02:47:09,207 - INFO - Avg. fwd time: 76.4243 / Avg. bwd time: 79.1083 / Avg. batch time: 1292.6364 (ms) / GPU bubble ratio: 3.74%
[rank2]:2025-10-23 02:47:09,297 - INFO - Avg. fwd time: 35.1113 / Avg. bwd time: 47.6884 / Avg. batch time: 1392.2239 (ms) / GPU bubble ratio: 52.42%
[rank1]:2025-10-23 02:47:09,346 - INFO - Avg. fwd time: 55.2083 / Avg. bwd time: 46.3459 / Avg. batch time: 1490.4952 (ms) / GPU bubble ratio: 45.49%
[rank0]:2025-10-23 02:47:09,437 - INFO - Avg. fwd time: 48.2208 / Avg. bwd time: 37.1320 / Avg. batch time: 1575.5419 (ms) / GPU bubble ratio: 56.66%
[rank3]:2025-10-23 02:49:17,459 - INFO -  step: 560  loss:  2.1898  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,524  tflops: 19.73  mfu: 6.33%
[rank1]:2025-10-23 02:49:17,457 - INFO -  step: 560  loss: -8.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,524  tflops: 19.73  mfu: 6.33%
[rank0]:2025-10-23 02:49:17,491 - INFO -  step: 560  loss: -8.0000  grad_norm:  0.2452  memory: 20.89GiB(43.97%)  tps: 2,525  tflops: 19.74  mfu: 6.33%
[rank2]:2025-10-23 02:49:17,470 - INFO -  step: 560  loss: -8.0000  grad_norm:  0.2452  memory: 16.10GiB(33.90%)  tps: 2,524  tflops: 19.73  mfu: 6.33%
[rank3]:2025-10-23 02:49:18,895 - INFO - Avg. fwd time: 76.4235 / Avg. bwd time: 78.9736 / Avg. batch time: 1291.5313 (ms) / GPU bubble ratio: 3.74%
[rank2]:2025-10-23 02:49:18,976 - INFO - Avg. fwd time: 35.1123 / Avg. bwd time: 48.0348 / Avg. batch time: 1391.5359 (ms) / GPU bubble ratio: 52.20%
[rank1]:2025-10-23 02:49:19,025 - INFO - Avg. fwd time: 55.1931 / Avg. bwd time: 46.2173 / Avg. batch time: 1489.5910 (ms) / GPU bubble ratio: 45.54%
[rank0]:2025-10-23 02:49:19,112 - INFO - Avg. fwd time: 48.2411 / Avg. bwd time: 37.7798 / Avg. batch time: 1575.5381 (ms) / GPU bubble ratio: 56.32%
[rank3]:2025-10-23 02:51:28,235 - INFO - Avg. fwd time: 76.4177 / Avg. bwd time: 78.8435 / Avg. batch time: 1290.4289 (ms) / GPU bubble ratio: 3.75%
[rank2]:2025-10-23 02:51:28,325 - INFO - Avg. fwd time: 35.1162 / Avg. bwd time: 48.3714 / Avg. batch time: 1390.8325 (ms) / GPU bubble ratio: 51.98%
[rank1]:2025-10-23 02:51:28,375 - INFO - Avg. fwd time: 55.1824 / Avg. bwd time: 46.0927 / Avg. batch time: 1488.6777 (ms) / GPU bubble ratio: 45.58%
[rank0]:2025-10-23 02:51:28,463 - INFO - Avg. fwd time: 48.2565 / Avg. bwd time: 38.4013 / Avg. batch time: 1575.4765 (ms) / GPU bubble ratio: 56.00%
[rank3]:2025-10-23 02:53:35,892 - INFO -  step: 580  loss:  2.1395  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,536  tflops: 19.82  mfu: 6.35%
[rank1]:2025-10-23 02:53:35,891 - INFO -  step: 580  loss: -8.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,536  tflops: 19.82  mfu: 6.35%
[rank0]:2025-10-23 02:53:35,927 - INFO -  step: 580  loss: -8.0000  grad_norm:  0.4074  memory: 20.89GiB(43.97%)  tps: 2,536  tflops: 19.82  mfu: 6.35%
[rank2]:2025-10-23 02:53:35,904 - INFO -  step: 580  loss: -8.0000  grad_norm:  0.4074  memory: 16.10GiB(33.90%)  tps: 2,536  tflops: 19.82  mfu: 6.35%
[rank3]:2025-10-23 02:53:37,329 - INFO - Avg. fwd time: 76.4077 / Avg. bwd time: 78.7174 / Avg. batch time: 1289.3245 (ms) / GPU bubble ratio: 3.75%
[rank2]:2025-10-23 02:53:37,419 - INFO - Avg. fwd time: 35.1173 / Avg. bwd time: 48.6982 / Avg. batch time: 1390.1133 (ms) / GPU bubble ratio: 51.76%
[rank1]:2025-10-23 02:53:37,466 - INFO - Avg. fwd time: 55.1697 / Avg. bwd time: 45.9718 / Avg. batch time: 1487.7522 (ms) / GPU bubble ratio: 45.61%
[rank0]:2025-10-23 02:53:37,557 - INFO - Avg. fwd time: 48.2623 / Avg. bwd time: 38.9961 / Avg. batch time: 1575.3535 (ms) / GPU bubble ratio: 55.69%
[rank3]:2025-10-23 02:55:46,535 - INFO - Avg. fwd time: 76.3953 / Avg. bwd time: 78.5987 / Avg. batch time: 1288.2659 (ms) / GPU bubble ratio: 3.75%
[rank2]:2025-10-23 02:55:46,626 - INFO - Avg. fwd time: 35.1219 / Avg. bwd time: 49.0119 / Avg. batch time: 1389.4074 (ms) / GPU bubble ratio: 51.56%
[rank1]:2025-10-23 02:55:46,676 - INFO - Avg. fwd time: 55.1576 / Avg. bwd time: 45.8567 / Avg. batch time: 1486.8470 (ms) / GPU bubble ratio: 45.65%
[rank0]:2025-10-23 02:55:46,766 - INFO - Avg. fwd time: 48.2720 / Avg. bwd time: 39.5753 / Avg. batch time: 1575.2594 (ms) / GPU bubble ratio: 55.39%
[rank0]:2025-10-23 02:57:41,536 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-23 02:57:54,468 - INFO -  step: 600  loss: -8.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,534  tflops: 19.81  mfu: 6.35%
[rank2]:2025-10-23 02:57:54,481 - INFO -  step: 600  loss: -8.0000  grad_norm:  0.2423  memory: 16.10GiB(33.90%)  tps: 2,534  tflops: 19.81  mfu: 6.35%
[rank3]:2025-10-23 02:57:54,470 - INFO -  step: 600  loss:  2.0812  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,535  tflops: 19.81  mfu: 6.35%
[rank0]:2025-10-23 02:57:54,510 - INFO -  step: 600  loss: -8.0000  grad_norm:  0.2423  memory: 20.89GiB(43.97%)  tps: 2,534  tflops: 19.81  mfu: 6.35%
[rank3]:2025-10-23 02:57:54,736 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_gpipe_fullrand7_dm1/pipeline_schedule/251023_0257_real_step600_rank3.svg
[rank3]:> Batch Time: 1467.41 ms, GPU Bubble Ratio: 39.37%, 48.36%, 50.97%, 18.90%
[rank3]:2025-10-23 02:57:54,797 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1023_gpipe_fullrand7_dm1/freeze_ratio_history/rank3/251023_0257_stage3_step600.svg
[rank3]:2025-10-23 02:57:56,069 - INFO - Avg. fwd time: 76.3833 / Avg. bwd time: 78.4835 / Avg. batch time: 1287.2429 (ms) / GPU bubble ratio: 3.75%
[rank2]:2025-10-23 02:57:56,159 - INFO - Avg. fwd time: 35.1253 / Avg. bwd time: 49.3191 / Avg. batch time: 1388.7912 (ms) / GPU bubble ratio: 51.36%
[rank1]:2025-10-23 02:57:56,206 - INFO - Avg. fwd time: 55.1507 / Avg. bwd time: 45.7456 / Avg. batch time: 1486.0403 (ms) / GPU bubble ratio: 45.68%
[rank0]:2025-10-23 02:57:56,303 - INFO - Avg. fwd time: 48.2803 / Avg. bwd time: 40.1341 / Avg. batch time: 1575.2158 (ms) / GPU bubble ratio: 55.10%
[rank3]:2025-10-23 03:00:05,578 - INFO - Avg. fwd time: 76.3792 / Avg. bwd time: 78.3695 / Avg. batch time: 1286.3000 (ms) / GPU bubble ratio: 3.76%
[rank2]:2025-10-23 03:00:05,671 - INFO - Avg. fwd time: 35.1271 / Avg. bwd time: 49.6110 / Avg. batch time: 1388.2001 (ms) / GPU bubble ratio: 51.17%
[rank1]:2025-10-23 03:00:05,721 - INFO - Avg. fwd time: 55.1428 / Avg. bwd time: 45.6370 / Avg. batch time: 1485.2672 (ms) / GPU bubble ratio: 45.72%
[rank0]:2025-10-23 03:00:05,807 - INFO - Avg. fwd time: 48.2873 / Avg. bwd time: 40.6736 / Avg. batch time: 1575.1899 (ms) / GPU bubble ratio: 54.82%
[rank1]:2025-10-23 03:02:12,982 - INFO -  step: 620  loss: -8.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,535  tflops: 19.82  mfu: 6.35%
[rank0]:2025-10-23 03:02:13,015 - INFO -  step: 620  loss: -8.0000  grad_norm:  0.2364  memory: 20.89GiB(43.97%)  tps: 2,535  tflops: 19.82  mfu: 6.35%
[rank2]:2025-10-23 03:02:12,995 - INFO -  step: 620  loss: -8.0000  grad_norm:  0.2364  memory: 16.10GiB(33.90%)  tps: 2,535  tflops: 19.82  mfu: 6.35%
[rank3]:2025-10-23 03:02:12,983 - INFO -  step: 620  loss:  2.1170  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,535  tflops: 19.82  mfu: 6.35%
[rank3]:2025-10-23 03:02:14,418 - INFO - Avg. fwd time: 76.3602 / Avg. bwd time: 78.2589 / Avg. batch time: 1285.2519 (ms) / GPU bubble ratio: 3.76%
[rank2]:2025-10-23 03:02:14,504 - INFO - Avg. fwd time: 35.1311 / Avg. bwd time: 49.8965 / Avg. batch time: 1387.4829 (ms) / GPU bubble ratio: 50.97%
[rank1]:2025-10-23 03:02:14,552 - INFO - Avg. fwd time: 55.1380 / Avg. bwd time: 45.5328 / Avg. batch time: 1484.3689 (ms) / GPU bubble ratio: 45.74%
[rank0]:2025-10-23 03:02:14,639 - INFO - Avg. fwd time: 48.2932 / Avg. bwd time: 41.1985 / Avg. batch time: 1575.0241 (ms) / GPU bubble ratio: 54.54%
[rank3]:2025-10-23 03:04:23,451 - INFO - Avg. fwd time: 76.3473 / Avg. bwd time: 78.1526 / Avg. batch time: 1284.2858 (ms) / GPU bubble ratio: 3.76%
[rank2]:2025-10-23 03:04:23,541 - INFO - Avg. fwd time: 35.1350 / Avg. bwd time: 50.1710 / Avg. batch time: 1386.8397 (ms) / GPU bubble ratio: 50.79%
[rank1]:2025-10-23 03:04:23,589 - INFO - Avg. fwd time: 55.1339 / Avg. bwd time: 45.4312 / Avg. batch time: 1483.5551 (ms) / GPU bubble ratio: 45.77%
[rank0]:2025-10-23 03:04:23,678 - INFO - Avg. fwd time: 48.2957 / Avg. bwd time: 41.7044 / Avg. batch time: 1574.9141 (ms) / GPU bubble ratio: 54.28%
[rank3]:2025-10-23 03:06:31,857 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_gpipe_fullrand7_dm1/pipeline_schedule_adjustment/251023_0306_rank3_trend_line.svg
[rank2]:2025-10-23 03:06:31,889 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_gpipe_fullrand7_dm1/pipeline_schedule_adjustment/251023_0306_rank2_trend_line.svg
[rank1]:2025-10-23 03:06:31,924 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_gpipe_fullrand7_dm1/pipeline_schedule_adjustment/251023_0306_rank1_trend_line.svg
[rank1]:2025-10-23 03:06:32,034 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-23 03:06:32,028 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_gpipe_fullrand7_dm1/pipeline_schedule_adjustment/251023_0306_rank0_trend_line.svg
[rank0]:2025-10-23 03:06:32,035 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-23 03:06:32,038 - INFO -  step: 640  loss: -8.0000  grad_norm:  0.1954  memory: 20.89GiB(43.97%)  tps: 2,530  tflops: 19.78  mfu: 6.34%
[rank2]:2025-10-23 03:06:32,034 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-23 03:06:32,038 - INFO -  step: 640  loss: -8.0000  grad_norm:  0.1954  memory: 16.10GiB(33.90%)  tps: 2,530  tflops: 19.78  mfu: 6.34%
[rank1]:2025-10-23 03:06:32,037 - INFO -  step: 640  loss: -8.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,530  tflops: 19.78  mfu: 6.34%
[rank3]:2025-10-23 03:06:32,253 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_gpipe_fullrand7_dm1/pipeline_schedule/251023_0306_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 1394.16 ms, GPU Bubble Ratio: 49.87%, 43.15%, 52.08%, 13.44%
[rank3]:2025-10-23 03:06:32,254 - INFO - 	> Batch Time: 1394.16 ms (Average Freeze Ratio: 0.34)
[rank3]:2025-10-23 03:06:32,255 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-23 03:06:32,260 - INFO -  step: 640  loss:  2.0349  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,528  tflops: 19.76  mfu: 6.33%
[rank3]:2025-10-23 03:06:33,550 - INFO - Avg. fwd time: 76.3403 / Avg. bwd time: 78.0503 / Avg. batch time: 1283.3993 (ms) / GPU bubble ratio: 3.76%
[rank2]:2025-10-23 03:06:33,640 - INFO - Avg. fwd time: 35.1376 / Avg. bwd time: 50.4380 / Avg. batch time: 1386.3004 (ms) / GPU bubble ratio: 50.62%
[rank1]:2025-10-23 03:06:33,688 - INFO - Avg. fwd time: 55.1228 / Avg. bwd time: 45.3333 / Avg. batch time: 1482.8448 (ms) / GPU bubble ratio: 45.80%
[rank0]:2025-10-23 03:06:33,776 - INFO - Avg. fwd time: 48.3044 / Avg. bwd time: 42.1974 / Avg. batch time: 1574.8803 (ms) / GPU bubble ratio: 54.03%
[rank0]:2025-10-23 03:08:18,117 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-23 03:08:31,244 - INFO - Avg. fwd time: 76.3536 / Avg. bwd time: 77.9533 / Avg. batch time: 1282.7092 (ms) / GPU bubble ratio: 3.76%
[rank0]:2025-10-23 03:08:31,343 - INFO - Avg. fwd time: 48.3071 / Avg. bwd time: 41.5482 / Avg. batch time: 1572.6328 (ms) / GPU bubble ratio: 54.29%
[rank2]:2025-10-23 03:08:31,284 - INFO - Avg. fwd time: 35.1383 / Avg. bwd time: 50.1154 / Avg. batch time: 1385.0539 (ms) / GPU bubble ratio: 50.76%
[rank1]:2025-10-23 03:08:31,332 - INFO - Avg. fwd time: 55.1223 / Avg. bwd time: 45.2367 / Avg. batch time: 1481.4315 (ms) / GPU bubble ratio: 45.80%
[rank1]:2025-10-23 03:10:27,430 - INFO -  step: 660  loss: -8.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,784  tflops: 21.76  mfu: 6.98%
[rank3]:2025-10-23 03:10:27,431 - INFO -  step: 660  loss:  2.1182  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,787  tflops: 21.79  mfu: 6.98%
[rank0]:2025-10-23 03:10:27,431 - INFO -  step: 660  loss: -8.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,784  tflops: 21.76  mfu: 6.98%
[rank2]:2025-10-23 03:10:27,429 - INFO -  step: 660  loss: -8.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,784  tflops: 21.77  mfu: 6.98%
[rank3]:2025-10-23 03:10:28,816 - INFO - Avg. fwd time: 76.3686 / Avg. bwd time: 77.8591 / Avg. batch time: 1282.0513 (ms) / GPU bubble ratio: 3.76%
[rank2]:2025-10-23 03:10:28,857 - INFO - Avg. fwd time: 35.1366 / Avg. bwd time: 49.8018 / Avg. batch time: 1383.8524 (ms) / GPU bubble ratio: 50.90%
[rank1]:2025-10-23 03:10:28,907 - INFO - Avg. fwd time: 55.1193 / Avg. bwd time: 45.1427 / Avg. batch time: 1480.0698 (ms) / GPU bubble ratio: 45.81%
[rank0]:2025-10-23 03:10:28,917 - INFO - Avg. fwd time: 48.3030 / Avg. bwd time: 40.9187 / Avg. batch time: 1570.4560 (ms) / GPU bubble ratio: 54.55%
[rank3]:2025-10-23 03:12:26,390 - INFO - Avg. fwd time: 76.3826 / Avg. bwd time: 77.7687 / Avg. batch time: 1281.4179 (ms) / GPU bubble ratio: 3.76%
[rank2]:2025-10-23 03:12:26,431 - INFO - Avg. fwd time: 35.1335 / Avg. bwd time: 49.4970 / Avg. batch time: 1382.6892 (ms) / GPU bubble ratio: 51.03%
[rank1]:2025-10-23 03:12:26,480 - INFO - Avg. fwd time: 55.1173 / Avg. bwd time: 45.0528 / Avg. batch time: 1478.7543 (ms) / GPU bubble ratio: 45.81%
[rank0]:2025-10-23 03:12:26,492 - INFO - Avg. fwd time: 48.2950 / Avg. bwd time: 40.3080 / Avg. batch time: 1568.3488 (ms) / GPU bubble ratio: 54.80%
[rank0]:2025-10-23 03:14:22,515 - INFO -  step: 680  loss: -8.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,788  tflops: 21.79  mfu: 6.99%
[rank1]:2025-10-23 03:14:22,514 - INFO -  step: 680  loss: -8.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,788  tflops: 21.79  mfu: 6.99%
[rank3]:2025-10-23 03:14:22,515 - INFO -  step: 680  loss:  1.9641  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,788  tflops: 21.79  mfu: 6.99%
[rank2]:2025-10-23 03:14:22,514 - INFO -  step: 680  loss: -8.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,788  tflops: 21.79  mfu: 6.99%
[rank3]:2025-10-23 03:14:23,936 - INFO - Avg. fwd time: 76.3972 / Avg. bwd time: 77.6794 / Avg. batch time: 1280.8005 (ms) / GPU bubble ratio: 3.76%
[rank2]:2025-10-23 03:14:23,977 - INFO - Avg. fwd time: 35.1285 / Avg. bwd time: 49.2014 / Avg. batch time: 1381.5575 (ms) / GPU bubble ratio: 51.17%
[rank1]:2025-10-23 03:14:24,025 - INFO - Avg. fwd time: 55.1145 / Avg. bwd time: 44.9633 / Avg. batch time: 1477.4717 (ms) / GPU bubble ratio: 45.81%
[rank0]:2025-10-23 03:14:24,036 - INFO - Avg. fwd time: 48.2884 / Avg. bwd time: 39.7153 / Avg. batch time: 1566.2969 (ms) / GPU bubble ratio: 55.05%
[rank3]:2025-10-23 03:16:21,430 - INFO - Avg. fwd time: 76.4105 / Avg. bwd time: 77.5902 / Avg. batch time: 1280.1777 (ms) / GPU bubble ratio: 3.76%
[rank2]:2025-10-23 03:16:21,471 - INFO - Avg. fwd time: 35.1233 / Avg. bwd time: 48.9138 / Avg. batch time: 1380.4345 (ms) / GPU bubble ratio: 51.30%
[rank1]:2025-10-23 03:16:21,521 - INFO - Avg. fwd time: 55.1111 / Avg. bwd time: 44.8760 / Avg. batch time: 1476.2029 (ms) / GPU bubble ratio: 45.81%
[rank0]:2025-10-23 03:16:21,532 - INFO - Avg. fwd time: 48.2811 / Avg. bwd time: 39.1397 / Avg. batch time: 1564.2805 (ms) / GPU bubble ratio: 55.29%
[rank0]:2025-10-23 03:18:05,809 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-23 03:18:17,602 - INFO -  step: 700  loss: -8.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,788  tflops: 21.79  mfu: 6.98%
[rank1]:2025-10-23 03:18:17,602 - INFO -  step: 700  loss: -8.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,788  tflops: 21.79  mfu: 6.98%
[rank3]:2025-10-23 03:18:17,603 - INFO -  step: 700  loss:  2.0818  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,788  tflops: 21.79  mfu: 6.99%
[rank0]:2025-10-23 03:18:17,603 - INFO -  step: 700  loss: -8.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,788  tflops: 21.79  mfu: 6.98%
[rank3]:2025-10-23 03:18:17,833 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_gpipe_fullrand7_dm1/pipeline_schedule/251023_0318_real_step700_rank3.svg
[rank3]:> Batch Time: 1462.28 ms, GPU Bubble Ratio: 40.35%, 48.31%, 51.58%, 18.55%
[rank3]:2025-10-23 03:18:17,897 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1023_gpipe_fullrand7_dm1/freeze_ratio_history/rank3/251023_0318_stage3_step700.svg
[rank3]:2025-10-23 03:18:19,199 - INFO - Avg. fwd time: 76.4248 / Avg. bwd time: 77.5057 / Avg. batch time: 1279.5911 (ms) / GPU bubble ratio: 3.76%
[rank2]:2025-10-23 03:18:19,240 - INFO - Avg. fwd time: 35.1189 / Avg. bwd time: 48.6352 / Avg. batch time: 1379.3951 (ms) / GPU bubble ratio: 51.43%
[rank1]:2025-10-23 03:18:19,288 - INFO - Avg. fwd time: 55.1028 / Avg. bwd time: 44.7923 / Avg. batch time: 1475.0191 (ms) / GPU bubble ratio: 45.82%
[rank0]:2025-10-23 03:18:19,298 - INFO - Avg. fwd time: 48.2726 / Avg. bwd time: 38.5806 / Avg. batch time: 1562.3729 (ms) / GPU bubble ratio: 55.53%
[rank3]:2025-10-23 03:20:16,855 - INFO - Avg. fwd time: 76.4355 / Avg. bwd time: 77.4269 / Avg. batch time: 1279.0249 (ms) / GPU bubble ratio: 3.76%
[rank2]:2025-10-23 03:20:16,896 - INFO - Avg. fwd time: 35.1204 / Avg. bwd time: 48.3644 / Avg. batch time: 1378.3605 (ms) / GPU bubble ratio: 51.55%
[rank1]:2025-10-23 03:20:16,945 - INFO - Avg. fwd time: 55.0940 / Avg. bwd time: 44.7120 / Avg. batch time: 1473.8492 (ms) / GPU bubble ratio: 45.83%
[rank0]:2025-10-23 03:20:16,957 - INFO - Avg. fwd time: 48.2652 / Avg. bwd time: 38.0373 / Avg. batch time: 1560.5020 (ms) / GPU bubble ratio: 55.76%
[rank2]:2025-10-23 03:22:13,100 - INFO -  step: 720  loss: -8.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,783  tflops: 21.76  mfu: 6.97%
[rank3]:2025-10-23 03:22:13,101 - INFO -  step: 720  loss:  2.1125  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,783  tflops: 21.76  mfu: 6.97%
[rank1]:2025-10-23 03:22:13,100 - INFO -  step: 720  loss: -8.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,783  tflops: 21.76  mfu: 6.97%
[rank0]:2025-10-23 03:22:13,101 - INFO -  step: 720  loss: -8.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,783  tflops: 21.76  mfu: 6.97%
[rank2]:2025-10-23 03:22:14,501 - INFO - Avg. fwd time: 35.1198 / Avg. bwd time: 48.1009 / Avg. batch time: 1377.3475 (ms) / GPU bubble ratio: 51.66%
[rank3]:2025-10-23 03:22:14,460 - INFO - Avg. fwd time: 76.4450 / Avg. bwd time: 77.3511 / Avg. batch time: 1278.4687 (ms) / GPU bubble ratio: 3.76%
[rank0]:2025-10-23 03:22:14,565 - INFO - Avg. fwd time: 48.2594 / Avg. bwd time: 37.5090 / Avg. batch time: 1558.6758 (ms) / GPU bubble ratio: 55.98%
[rank1]:2025-10-23 03:22:14,554 - INFO - Avg. fwd time: 55.0877 / Avg. bwd time: 44.6343 / Avg. batch time: 1472.7045 (ms) / GPU bubble ratio: 45.83%
[rank3]:2025-10-23 03:24:12,055 - INFO - Avg. fwd time: 76.4548 / Avg. bwd time: 77.2759 / Avg. batch time: 1277.9281 (ms) / GPU bubble ratio: 3.76%
[rank2]:2025-10-23 03:24:12,097 - INFO - Avg. fwd time: 35.1189 / Avg. bwd time: 47.8445 / Avg. batch time: 1376.3629 (ms) / GPU bubble ratio: 51.78%
[rank1]:2025-10-23 03:24:12,147 - INFO - Avg. fwd time: 55.0828 / Avg. bwd time: 44.5586 / Avg. batch time: 1471.5976 (ms) / GPU bubble ratio: 45.83%
[rank0]:2025-10-23 03:24:12,159 - INFO - Avg. fwd time: 48.2512 / Avg. bwd time: 36.9952 / Avg. batch time: 1556.9034 (ms) / GPU bubble ratio: 56.20%
[rank0]:2025-10-23 03:26:08,267 - INFO -  step: 740  loss: -8.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,787  tflops: 21.79  mfu: 6.98%
[rank2]:2025-10-23 03:26:08,266 - INFO -  step: 740  loss: -8.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,787  tflops: 21.79  mfu: 6.98%
[rank3]:2025-10-23 03:26:08,267 - INFO -  step: 740  loss:  2.0518  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,787  tflops: 21.79  mfu: 6.98%
[rank1]:2025-10-23 03:26:08,266 - INFO -  step: 740  loss: -8.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,787  tflops: 21.79  mfu: 6.98%
[rank2]:2025-10-23 03:26:09,723 - INFO - Avg. fwd time: 35.1162 / Avg. bwd time: 47.5955 / Avg. batch time: 1375.4208 (ms) / GPU bubble ratio: 51.89%
[rank3]:2025-10-23 03:26:09,681 - INFO - Avg. fwd time: 76.4685 / Avg. bwd time: 77.2010 / Avg. batch time: 1277.4204 (ms) / GPU bubble ratio: 3.76%
[rank1]:2025-10-23 03:26:09,772 - INFO - Avg. fwd time: 55.0728 / Avg. bwd time: 44.4846 / Avg. batch time: 1470.5300 (ms) / GPU bubble ratio: 45.84%
[rank0]:2025-10-23 03:26:09,783 - INFO - Avg. fwd time: 48.2456 / Avg. bwd time: 36.4953 / Avg. batch time: 1555.1887 (ms) / GPU bubble ratio: 56.41%
[rank0]:2025-10-23 03:27:54,157 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-23 03:28:07,282 - INFO - Avg. fwd time: 76.4789 / Avg. bwd time: 77.1298 / Avg. batch time: 1276.9173 (ms) / GPU bubble ratio: 3.76%
[rank2]:2025-10-23 03:28:07,325 - INFO - Avg. fwd time: 35.1154 / Avg. bwd time: 47.3529 / Avg. batch time: 1374.4959 (ms) / GPU bubble ratio: 52.00%
[rank1]:2025-10-23 03:28:07,374 - INFO - Avg. fwd time: 55.0657 / Avg. bwd time: 44.4130 / Avg. batch time: 1469.4881 (ms) / GPU bubble ratio: 45.84%
[rank0]:2025-10-23 03:28:07,386 - INFO - Avg. fwd time: 48.2410 / Avg. bwd time: 36.0087 / Avg. batch time: 1553.5195 (ms) / GPU bubble ratio: 56.61%
[rank3]:2025-10-23 03:30:03,406 - INFO -  step: 760  loss:  2.0646  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,787  tflops: 21.79  mfu: 6.98%
[rank2]:2025-10-23 03:30:03,404 - INFO -  step: 760  loss: -8.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,787  tflops: 21.79  mfu: 6.98%
[rank1]:2025-10-23 03:30:03,406 - INFO -  step: 760  loss: -8.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,787  tflops: 21.79  mfu: 6.98%
[rank0]:2025-10-23 03:30:03,405 - INFO -  step: 760  loss: -8.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,787  tflops: 21.79  mfu: 6.98%
[rank3]:2025-10-23 03:30:04,809 - INFO - Avg. fwd time: 76.4885 / Avg. bwd time: 77.0613 / Avg. batch time: 1276.4214 (ms) / GPU bubble ratio: 3.76%
[rank2]:2025-10-23 03:30:04,851 - INFO - Avg. fwd time: 35.1166 / Avg. bwd time: 47.1165 / Avg. batch time: 1373.5907 (ms) / GPU bubble ratio: 52.11%
[rank1]:2025-10-23 03:30:04,900 - INFO - Avg. fwd time: 55.0540 / Avg. bwd time: 44.3442 / Avg. batch time: 1468.4638 (ms) / GPU bubble ratio: 45.85%
[rank0]:2025-10-23 03:30:04,912 - INFO - Avg. fwd time: 48.2361 / Avg. bwd time: 35.5350 / Avg. batch time: 1551.8852 (ms) / GPU bubble ratio: 56.82%
[rank3]:2025-10-23 03:32:02,379 - INFO - Avg. fwd time: 76.4992 / Avg. bwd time: 76.9924 / Avg. batch time: 1275.9440 (ms) / GPU bubble ratio: 3.76%
[rank2]:2025-10-23 03:32:02,420 - INFO - Avg. fwd time: 35.1152 / Avg. bwd time: 46.8868 / Avg. batch time: 1372.7145 (ms) / GPU bubble ratio: 52.21%
[rank1]:2025-10-23 03:32:02,472 - INFO - Avg. fwd time: 55.0440 / Avg. bwd time: 44.2756 / Avg. batch time: 1467.4746 (ms) / GPU bubble ratio: 45.86%
[rank0]:2025-10-23 03:32:02,484 - INFO - Avg. fwd time: 48.2306 / Avg. bwd time: 35.0735 / Avg. batch time: 1550.2991 (ms) / GPU bubble ratio: 57.01%
[rank3]:2025-10-23 03:33:58,533 - INFO -  step: 780  loss:  1.9731  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,787  tflops: 21.79  mfu: 6.98%
[rank2]:2025-10-23 03:33:58,532 - INFO -  step: 780  loss: -8.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,787  tflops: 21.79  mfu: 6.98%
[rank1]:2025-10-23 03:33:58,533 - INFO -  step: 780  loss: -8.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,787  tflops: 21.79  mfu: 6.98%
[rank0]:2025-10-23 03:33:58,533 - INFO -  step: 780  loss: -8.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,787  tflops: 21.79  mfu: 6.98%
[rank3]:2025-10-23 03:33:59,934 - INFO - Avg. fwd time: 76.5122 / Avg. bwd time: 76.9230 / Avg. batch time: 1275.4822 (ms) / GPU bubble ratio: 3.76%
[rank2]:2025-10-23 03:33:59,977 - INFO - Avg. fwd time: 35.1125 / Avg. bwd time: 46.6625 / Avg. batch time: 1371.8613 (ms) / GPU bubble ratio: 52.31%
[rank1]:2025-10-23 03:34:00,026 - INFO - Avg. fwd time: 55.0331 / Avg. bwd time: 44.2093 / Avg. batch time: 1466.5070 (ms) / GPU bubble ratio: 45.86%
[rank0]:2025-10-23 03:34:00,039 - INFO - Avg. fwd time: 48.2249 / Avg. bwd time: 34.6239 / Avg. batch time: 1548.7506 (ms) / GPU bubble ratio: 57.20%
[rank3]:2025-10-23 03:35:57,571 - INFO - Avg. fwd time: 76.5251 / Avg. bwd time: 76.8565 / Avg. batch time: 1275.0330 (ms) / GPU bubble ratio: 3.76%
[rank2]:2025-10-23 03:35:57,613 - INFO - Avg. fwd time: 35.1101 / Avg. bwd time: 46.4438 / Avg. batch time: 1371.0319 (ms) / GPU bubble ratio: 52.41%
[rank0]:2025-10-23 03:35:57,676 - INFO - Avg. fwd time: 48.2186 / Avg. bwd time: 34.1856 / Avg. batch time: 1547.2466 (ms) / GPU bubble ratio: 57.39%
[rank1]:2025-10-23 03:35:57,663 - INFO - Avg. fwd time: 55.0225 / Avg. bwd time: 44.1440 / Avg. batch time: 1465.5668 (ms) / GPU bubble ratio: 45.87%
[rank0]:2025-10-23 03:37:42,038 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-23 03:37:53,794 - INFO -  step: 800  loss: -8.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,786  tflops: 21.78  mfu: 6.98%
[rank3]:2025-10-23 03:37:53,794 - INFO -  step: 800  loss:  2.0700  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,786  tflops: 21.78  mfu: 6.98%
[rank2]:2025-10-23 03:37:53,793 - INFO -  step: 800  loss: -8.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,786  tflops: 21.78  mfu: 6.98%
[rank1]:2025-10-23 03:37:53,794 - INFO -  step: 800  loss: -8.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,786  tflops: 21.78  mfu: 6.98%
[rank3]:2025-10-23 03:37:54,018 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_gpipe_fullrand7_dm1/pipeline_schedule/251023_0337_real_step800_rank3.svg
[rank3]:> Batch Time: 1377.17 ms, GPU Bubble Ratio: 71.82%, 45.28%, 62.35%, 13.34%
[rank3]:2025-10-23 03:37:54,085 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1023_gpipe_fullrand7_dm1/freeze_ratio_history/rank3/251023_0337_stage3_step800.svg
[rank3]:2025-10-23 03:37:55,344 - INFO - Avg. fwd time: 76.5332 / Avg. bwd time: 76.7939 / Avg. batch time: 1274.5877 (ms) / GPU bubble ratio: 3.76%
[rank2]:2025-10-23 03:37:55,386 - INFO - Avg. fwd time: 35.1097 / Avg. bwd time: 46.2313 / Avg. batch time: 1370.2432 (ms) / GPU bubble ratio: 52.51%
[rank1]:2025-10-23 03:37:55,435 - INFO - Avg. fwd time: 55.0142 / Avg. bwd time: 44.0815 / Avg. batch time: 1464.6748 (ms) / GPU bubble ratio: 45.87%
[rank0]:2025-10-23 03:37:55,446 - INFO - Avg. fwd time: 48.2085 / Avg. bwd time: 33.7583 / Avg. batch time: 1545.8008 (ms) / GPU bubble ratio: 57.58%
[rank3]:2025-10-23 03:39:52,927 - INFO - Avg. fwd time: 76.5413 / Avg. bwd time: 76.7333 / Avg. batch time: 1274.1471 (ms) / GPU bubble ratio: 3.76%
[rank2]:2025-10-23 03:39:52,970 - INFO - Avg. fwd time: 35.1109 / Avg. bwd time: 46.0238 / Avg. batch time: 1369.4427 (ms) / GPU bubble ratio: 52.60%
[rank1]:2025-10-23 03:39:53,023 - INFO - Avg. fwd time: 55.0117 / Avg. bwd time: 44.0211 / Avg. batch time: 1463.7787 (ms) / GPU bubble ratio: 45.88%
[rank0]:2025-10-23 03:39:53,035 - INFO - Avg. fwd time: 48.1987 / Avg. bwd time: 33.3416 / Avg. batch time: 1544.3669 (ms) / GPU bubble ratio: 57.76%
[rank1]:2025-10-23 03:41:49,166 - INFO -  step: 820  loss: -8.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,784  tflops: 21.77  mfu: 6.98%
[rank2]:2025-10-23 03:41:49,165 - INFO -  step: 820  loss: -8.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,784  tflops: 21.77  mfu: 6.98%
[rank3]:2025-10-23 03:41:49,166 - INFO -  step: 820  loss:  2.0360  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,784  tflops: 21.77  mfu: 6.98%
[rank0]:2025-10-23 03:41:49,166 - INFO -  step: 820  loss: -8.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,784  tflops: 21.77  mfu: 6.98%
[rank3]:2025-10-23 03:41:50,554 - INFO - Avg. fwd time: 76.5513 / Avg. bwd time: 76.6734 / Avg. batch time: 1273.7309 (ms) / GPU bubble ratio: 3.76%
[rank2]:2025-10-23 03:41:50,597 - INFO - Avg. fwd time: 35.1110 / Avg. bwd time: 45.8212 / Avg. batch time: 1368.6744 (ms) / GPU bubble ratio: 52.69%
[rank1]:2025-10-23 03:41:50,653 - INFO - Avg. fwd time: 55.0019 / Avg. bwd time: 43.9611 / Avg. batch time: 1462.9122 (ms) / GPU bubble ratio: 45.88%
[rank0]:2025-10-23 03:41:50,666 - INFO - Avg. fwd time: 48.1930 / Avg. bwd time: 32.9350 / Avg. batch time: 1542.9785 (ms) / GPU bubble ratio: 57.94%
[rank3]:2025-10-23 03:43:48,174 - INFO - Avg. fwd time: 76.5617 / Avg. bwd time: 76.6142 / Avg. batch time: 1273.3300 (ms) / GPU bubble ratio: 3.76%
[rank2]:2025-10-23 03:43:48,217 - INFO - Avg. fwd time: 35.1104 / Avg. bwd time: 45.6235 / Avg. batch time: 1367.9306 (ms) / GPU bubble ratio: 52.78%
[rank0]:2025-10-23 03:43:48,283 - INFO - Avg. fwd time: 48.1875 / Avg. bwd time: 32.5382 / Avg. batch time: 1541.6241 (ms) / GPU bubble ratio: 58.11%
[rank1]:2025-10-23 03:43:48,270 - INFO - Avg. fwd time: 54.9976 / Avg. bwd time: 43.9026 / Avg. batch time: 1462.0684 (ms) / GPU bubble ratio: 45.88%
[rank3]:2025-10-23 03:45:44,326 - INFO -  step: 840  loss:  1.9830  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,787  tflops: 21.79  mfu: 6.98%
[rank0]:2025-10-23 03:45:44,326 - INFO -  step: 840  loss: -8.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,787  tflops: 21.79  mfu: 6.98%
[rank2]:2025-10-23 03:45:44,325 - INFO -  step: 840  loss: -8.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,787  tflops: 21.79  mfu: 6.98%
[rank1]:2025-10-23 03:45:44,325 - INFO -  step: 840  loss: -8.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,787  tflops: 21.79  mfu: 6.98%
[rank3]:2025-10-23 03:45:45,748 - INFO - Avg. fwd time: 76.5680 / Avg. bwd time: 76.5607 / Avg. batch time: 1272.9318 (ms) / GPU bubble ratio: 3.76%
[rank2]:2025-10-23 03:45:45,790 - INFO - Avg. fwd time: 35.1099 / Avg. bwd time: 45.4306 / Avg. batch time: 1367.1961 (ms) / GPU bubble ratio: 52.87%
[rank0]:2025-10-23 03:45:45,854 - INFO - Avg. fwd time: 48.1775 / Avg. bwd time: 32.1509 / Avg. batch time: 1540.2925 (ms) / GPU bubble ratio: 58.28%
[rank1]:2025-10-23 03:45:45,841 - INFO - Avg. fwd time: 54.9957 / Avg. bwd time: 43.8474 / Avg. batch time: 1461.2399 (ms) / GPU bubble ratio: 45.89%
[rank0]:2025-10-23 03:47:30,226 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-23 03:47:43,363 - INFO - Avg. fwd time: 76.5754 / Avg. bwd time: 76.5071 / Avg. batch time: 1272.5479 (ms) / GPU bubble ratio: 3.76%
[rank2]:2025-10-23 03:47:43,406 - INFO - Avg. fwd time: 35.1105 / Avg. bwd time: 45.2421 / Avg. batch time: 1366.4859 (ms) / GPU bubble ratio: 52.96%
[rank1]:2025-10-23 03:47:43,459 - INFO - Avg. fwd time: 54.9903 / Avg. bwd time: 43.7931 / Avg. batch time: 1460.4395 (ms) / GPU bubble ratio: 45.89%
[rank0]:2025-10-23 03:47:43,473 - INFO - Avg. fwd time: 48.1714 / Avg. bwd time: 31.7727 / Avg. batch time: 1539.0016 (ms) / GPU bubble ratio: 58.44%
[rank1]:2025-10-23 03:49:39,613 - INFO -  step: 860  loss: -8.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,785  tflops: 21.77  mfu: 6.98%
[rank0]:2025-10-23 03:49:39,613 - INFO -  step: 860  loss: -8.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,785  tflops: 21.77  mfu: 6.98%
[rank3]:2025-10-23 03:49:39,613 - INFO -  step: 860  loss:  2.0593  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,785  tflops: 21.77  mfu: 6.98%
[rank2]:2025-10-23 03:49:39,612 - INFO -  step: 860  loss: -8.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,785  tflops: 21.77  mfu: 6.98%
[rank3]:2025-10-23 03:49:41,008 - INFO - Avg. fwd time: 76.5833 / Avg. bwd time: 76.4523 / Avg. batch time: 1272.1670 (ms) / GPU bubble ratio: 3.76%
[rank2]:2025-10-23 03:49:41,052 - INFO - Avg. fwd time: 35.1096 / Avg. bwd time: 45.0577 / Avg. batch time: 1365.7851 (ms) / GPU bubble ratio: 53.04%
[rank1]:2025-10-23 03:49:41,102 - INFO - Avg. fwd time: 54.9846 / Avg. bwd time: 43.7403 / Avg. batch time: 1459.6589 (ms) / GPU bubble ratio: 45.89%
[rank0]:2025-10-23 03:49:41,115 - INFO - Avg. fwd time: 48.1640 / Avg. bwd time: 31.4033 / Avg. batch time: 1537.7430 (ms) / GPU bubble ratio: 58.61%
[rank3]:2025-10-23 03:51:38,553 - INFO - Avg. fwd time: 76.5925 / Avg. bwd time: 76.3988 / Avg. batch time: 1271.7902 (ms) / GPU bubble ratio: 3.76%
[rank2]:2025-10-23 03:51:38,596 - INFO - Avg. fwd time: 35.1090 / Avg. bwd time: 44.8775 / Avg. batch time: 1365.0950 (ms) / GPU bubble ratio: 53.12%
[rank1]:2025-10-23 03:51:38,649 - INFO - Avg. fwd time: 54.9728 / Avg. bwd time: 43.6869 / Avg. batch time: 1458.8785 (ms) / GPU bubble ratio: 45.90%
[rank0]:2025-10-23 03:51:38,662 - INFO - Avg. fwd time: 48.1552 / Avg. bwd time: 31.0423 / Avg. batch time: 1536.4980 (ms) / GPU bubble ratio: 58.76%
[rank0]:2025-10-23 03:53:34,639 - INFO -  step: 880  loss: -8.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,789  tflops: 21.80  mfu: 6.99%
[rank2]:2025-10-23 03:53:34,637 - INFO -  step: 880  loss: -8.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,788  tflops: 21.80  mfu: 6.99%
[rank3]:2025-10-23 03:53:34,639 - INFO -  step: 880  loss:  1.9876  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,789  tflops: 21.80  mfu: 6.99%
[rank1]:2025-10-23 03:53:34,638 - INFO -  step: 880  loss: -8.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,789  tflops: 21.80  mfu: 6.99%
[rank2]:2025-10-23 03:53:36,094 - INFO - Avg. fwd time: 35.1069 / Avg. bwd time: 44.7017 / Avg. batch time: 1364.4148 (ms) / GPU bubble ratio: 53.21%
[rank3]:2025-10-23 03:53:36,051 - INFO - Avg. fwd time: 76.6010 / Avg. bwd time: 76.3457 / Avg. batch time: 1271.4154 (ms) / GPU bubble ratio: 3.76%
[rank0]:2025-10-23 03:53:36,160 - INFO - Avg. fwd time: 48.1508 / Avg. bwd time: 30.6896 / Avg. batch time: 1535.2764 (ms) / GPU bubble ratio: 58.92%
[rank1]:2025-10-23 03:53:36,147 - INFO - Avg. fwd time: 54.9600 / Avg. bwd time: 43.6349 / Avg. batch time: 1458.1113 (ms) / GPU bubble ratio: 45.91%
[rank3]:2025-10-23 03:55:33,557 - INFO - Avg. fwd time: 76.6110 / Avg. bwd time: 76.2909 / Avg. batch time: 1271.0508 (ms) / GPU bubble ratio: 3.76%
[rank2]:2025-10-23 03:55:33,601 - INFO - Avg. fwd time: 35.1038 / Avg. bwd time: 44.5294 / Avg. batch time: 1363.7504 (ms) / GPU bubble ratio: 53.29%
[rank1]:2025-10-23 03:55:33,652 - INFO - Avg. fwd time: 54.9562 / Avg. bwd time: 43.5856 / Avg. batch time: 1457.3622 (ms) / GPU bubble ratio: 45.91%
[rank0]:2025-10-23 03:55:33,666 - INFO - Avg. fwd time: 48.1459 / Avg. bwd time: 30.3448 / Avg. batch time: 1534.0812 (ms) / GPU bubble ratio: 59.07%
[rank0]:2025-10-23 03:57:17,825 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-23 03:57:29,570 - INFO -  step: 900  loss: -8.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,790  tflops: 21.81  mfu: 6.99%
[rank2]:2025-10-23 03:57:29,569 - INFO -  step: 900  loss: -8.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,790  tflops: 21.81  mfu: 6.99%
[rank3]:2025-10-23 03:57:29,570 - INFO -  step: 900  loss:  2.0076  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,790  tflops: 21.81  mfu: 6.99%
[rank1]:2025-10-23 03:57:29,570 - INFO -  step: 900  loss: -8.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,790  tflops: 21.81  mfu: 6.99%
[rank3]:2025-10-23 03:57:29,793 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_gpipe_fullrand7_dm1/pipeline_schedule/251023_0357_real_step900_rank3.svg
[rank3]:> Batch Time: 1376.60 ms, GPU Bubble Ratio: 71.86%, 45.35%, 62.54%, 13.23%
[rank3]:2025-10-23 03:57:29,850 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1023_gpipe_fullrand7_dm1/freeze_ratio_history/rank3/251023_0357_stage3_step900.svg
[rank3]:2025-10-23 03:57:31,120 - INFO - Avg. fwd time: 76.6171 / Avg. bwd time: 76.2384 / Avg. batch time: 1270.6802 (ms) / GPU bubble ratio: 3.76%
[rank2]:2025-10-23 03:57:31,162 - INFO - Avg. fwd time: 35.1016 / Avg. bwd time: 44.3608 / Avg. batch time: 1363.1080 (ms) / GPU bubble ratio: 53.36%
[rank1]:2025-10-23 03:57:31,215 - INFO - Avg. fwd time: 54.9528 / Avg. bwd time: 43.5387 / Avg. batch time: 1456.6442 (ms) / GPU bubble ratio: 45.91%
[rank0]:2025-10-23 03:57:31,227 - INFO - Avg. fwd time: 48.1419 / Avg. bwd time: 30.0077 / Avg. batch time: 1532.9273 (ms) / GPU bubble ratio: 59.22%
[rank2]:2025-10-23 03:59:28,729 - INFO - Avg. fwd time: 35.0997 / Avg. bwd time: 44.1962 / Avg. batch time: 1362.4870 (ms) / GPU bubble ratio: 53.44%
[rank3]:2025-10-23 03:59:28,686 - INFO - Avg. fwd time: 76.6274 / Avg. bwd time: 76.1884 / Avg. batch time: 1270.3451 (ms) / GPU bubble ratio: 3.76%
[rank1]:2025-10-23 03:59:28,781 - INFO - Avg. fwd time: 54.9424 / Avg. bwd time: 43.4921 / Avg. batch time: 1455.9442 (ms) / GPU bubble ratio: 45.91%
[rank0]:2025-10-23 03:59:28,795 - INFO - Avg. fwd time: 48.1379 / Avg. bwd time: 29.6779 / Avg. batch time: 1531.8021 (ms) / GPU bubble ratio: 59.36%
[rank0]:2025-10-23 04:01:24,976 - INFO -  step: 920  loss: -8.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,784  tflops: 21.76  mfu: 6.98%
[rank2]:2025-10-23 04:01:24,975 - INFO -  step: 920  loss: -8.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,784  tflops: 21.76  mfu: 6.98%
[rank3]:2025-10-23 04:01:24,976 - INFO -  step: 920  loss:  2.1089  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,784  tflops: 21.76  mfu: 6.98%
[rank1]:2025-10-23 04:01:24,976 - INFO -  step: 920  loss: -8.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,784  tflops: 21.76  mfu: 6.98%
[rank3]:2025-10-23 04:01:26,394 - INFO - Avg. fwd time: 76.6370 / Avg. bwd time: 76.1418 / Avg. batch time: 1270.0355 (ms) / GPU bubble ratio: 3.76%
[rank0]:2025-10-23 04:01:26,504 - INFO - Avg. fwd time: 48.1325 / Avg. bwd time: 29.3554 / Avg. batch time: 1530.7222 (ms) / GPU bubble ratio: 59.50%
[rank2]:2025-10-23 04:01:26,439 - INFO - Avg. fwd time: 35.0986 / Avg. bwd time: 44.0352 / Avg. batch time: 1361.8970 (ms) / GPU bubble ratio: 53.52%
[rank1]:2025-10-23 04:01:26,490 - INFO - Avg. fwd time: 54.9389 / Avg. bwd time: 43.4487 / Avg. batch time: 1455.2811 (ms) / GPU bubble ratio: 45.91%
[rank3]:2025-10-23 04:03:23,951 - INFO - Avg. fwd time: 76.6465 / Avg. bwd time: 76.0939 / Avg. batch time: 1269.7160 (ms) / GPU bubble ratio: 3.76%
[rank0]:2025-10-23 04:03:24,061 - INFO - Avg. fwd time: 48.1268 / Avg. bwd time: 29.0397 / Avg. batch time: 1529.6451 (ms) / GPU bubble ratio: 59.64%
[rank2]:2025-10-23 04:03:23,995 - INFO - Avg. fwd time: 35.0981 / Avg. bwd time: 43.8775 / Avg. batch time: 1361.3048 (ms) / GPU bubble ratio: 53.59%
[rank1]:2025-10-23 04:03:24,047 - INFO - Avg. fwd time: 54.9300 / Avg. bwd time: 43.4062 / Avg. batch time: 1454.6119 (ms) / GPU bubble ratio: 45.92%
[rank2]:2025-10-23 04:05:20,139 - INFO -  step: 940  loss: -8.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,787  tflops: 21.79  mfu: 6.98%
[rank3]:2025-10-23 04:05:20,141 - INFO -  step: 940  loss:  2.1562  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,787  tflops: 21.79  mfu: 6.98%
[rank1]:2025-10-23 04:05:20,141 - INFO -  step: 940  loss: -8.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,787  tflops: 21.79  mfu: 6.98%
[rank0]:2025-10-23 04:05:20,141 - INFO -  step: 940  loss: -8.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,787  tflops: 21.79  mfu: 6.98%
[rank2]:2025-10-23 04:05:21,603 - INFO - Avg. fwd time: 35.0984 / Avg. bwd time: 43.7232 / Avg. batch time: 1360.7283 (ms) / GPU bubble ratio: 53.66%
[rank3]:2025-10-23 04:05:21,559 - INFO - Avg. fwd time: 76.6573 / Avg. bwd time: 76.0462 / Avg. batch time: 1269.4086 (ms) / GPU bubble ratio: 3.76%
[rank1]:2025-10-23 04:05:21,655 - INFO - Avg. fwd time: 54.9218 / Avg. bwd time: 43.3632 / Avg. batch time: 1453.9626 (ms) / GPU bubble ratio: 45.92%
[rank0]:2025-10-23 04:05:21,669 - INFO - Avg. fwd time: 48.1242 / Avg. bwd time: 28.7308 / Avg. batch time: 1528.5972 (ms) / GPU bubble ratio: 59.78%
[rank0]:2025-10-23 04:07:05,924 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-23 04:07:19,101 - INFO - Avg. fwd time: 76.6634 / Avg. bwd time: 76.0028 / Avg. batch time: 1269.0956 (ms) / GPU bubble ratio: 3.76%
[rank2]:2025-10-23 04:07:19,145 - INFO - Avg. fwd time: 35.1002 / Avg. bwd time: 43.5723 / Avg. batch time: 1360.1539 (ms) / GPU bubble ratio: 53.73%
[rank1]:2025-10-23 04:07:19,198 - INFO - Avg. fwd time: 54.9148 / Avg. bwd time: 43.3226 / Avg. batch time: 1453.3197 (ms) / GPU bubble ratio: 45.92%
[rank0]:2025-10-23 04:07:19,212 - INFO - Avg. fwd time: 48.1130 / Avg. bwd time: 28.4284 / Avg. batch time: 1527.5613 (ms) / GPU bubble ratio: 59.91%
[rank0]:2025-10-23 04:09:15,308 - INFO -  step: 960  loss: -8.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,787  tflops: 21.79  mfu: 6.98%
[rank2]:2025-10-23 04:09:15,306 - INFO -  step: 960  loss: -8.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,787  tflops: 21.79  mfu: 6.98%
[rank3]:2025-10-23 04:09:15,308 - INFO -  step: 960  loss:  2.0955  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,787  tflops: 21.79  mfu: 6.98%
[rank1]:2025-10-23 04:09:15,307 - INFO -  step: 960  loss: -8.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,787  tflops: 21.79  mfu: 6.98%
[rank3]:2025-10-23 04:09:16,722 - INFO - Avg. fwd time: 76.6711 / Avg. bwd time: 75.9597 / Avg. batch time: 1268.7969 (ms) / GPU bubble ratio: 3.76%
[rank0]:2025-10-23 04:09:16,835 - INFO - Avg. fwd time: 48.1036 / Avg. bwd time: 28.1323 / Avg. batch time: 1526.5531 (ms) / GPU bubble ratio: 60.05%
[rank2]:2025-10-23 04:09:16,767 - INFO - Avg. fwd time: 35.1000 / Avg. bwd time: 43.4245 / Avg. batch time: 1359.5969 (ms) / GPU bubble ratio: 53.80%
[rank1]:2025-10-23 04:09:16,821 - INFO - Avg. fwd time: 54.9075 / Avg. bwd time: 43.2840 / Avg. batch time: 1452.6971 (ms) / GPU bubble ratio: 45.93%
[rank2]:2025-10-23 04:11:14,312 - INFO - Avg. fwd time: 35.0995 / Avg. bwd time: 43.2797 / Avg. batch time: 1359.0481 (ms) / GPU bubble ratio: 53.86%
[rank3]:2025-10-23 04:11:14,268 - INFO - Avg. fwd time: 76.6774 / Avg. bwd time: 75.9178 / Avg. batch time: 1268.4980 (ms) / GPU bubble ratio: 3.76%
[rank0]:2025-10-23 04:11:14,379 - INFO - Avg. fwd time: 48.0974 / Avg. bwd time: 27.8423 / Avg. batch time: 1525.5591 (ms) / GPU bubble ratio: 60.18%
[rank1]:2025-10-23 04:11:14,365 - INFO - Avg. fwd time: 54.8986 / Avg. bwd time: 43.2448 / Avg. batch time: 1452.0786 (ms) / GPU bubble ratio: 45.93%
[rank0]:2025-10-23 04:13:10,433 - INFO -  step: 980  loss: -8.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,787  tflops: 21.79  mfu: 6.98%
[rank3]:2025-10-23 04:13:10,433 - INFO -  step: 980  loss:  2.0222  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,787  tflops: 21.79  mfu: 6.98%
[rank2]:2025-10-23 04:13:10,432 - INFO -  step: 980  loss: -8.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,787  tflops: 21.79  mfu: 6.98%
[rank1]:2025-10-23 04:13:10,433 - INFO -  step: 980  loss: -8.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,787  tflops: 21.79  mfu: 6.98%
[rank3]:2025-10-23 04:13:11,840 - INFO - Avg. fwd time: 76.6850 / Avg. bwd time: 75.8754 / Avg. batch time: 1268.2100 (ms) / GPU bubble ratio: 3.76%
[rank2]:2025-10-23 04:13:11,885 - INFO - Avg. fwd time: 35.0971 / Avg. bwd time: 43.1381 / Avg. batch time: 1358.5124 (ms) / GPU bubble ratio: 53.93%
[rank1]:2025-10-23 04:13:11,938 - INFO - Avg. fwd time: 54.8965 / Avg. bwd time: 43.2070 / Avg. batch time: 1451.4777 (ms) / GPU bubble ratio: 45.93%
[rank0]:2025-10-23 04:13:11,952 - INFO - Avg. fwd time: 48.0931 / Avg. bwd time: 27.5582 / Avg. batch time: 1524.5896 (ms) / GPU bubble ratio: 60.30%
[rank3]:2025-10-23 04:15:09,352 - INFO - Avg. fwd time: 76.6946 / Avg. bwd time: 75.8319 / Avg. batch time: 1267.9219 (ms) / GPU bubble ratio: 3.76%
[rank2]:2025-10-23 04:15:09,397 - INFO - Avg. fwd time: 35.0955 / Avg. bwd time: 42.9990 / Avg. batch time: 1357.9838 (ms) / GPU bubble ratio: 53.99%
[rank1]:2025-10-23 04:15:09,450 - INFO - Avg. fwd time: 54.8887 / Avg. bwd time: 43.1696 / Avg. batch time: 1450.8824 (ms) / GPU bubble ratio: 45.93%
[rank0]:2025-10-23 04:15:09,465 - INFO - Avg. fwd time: 48.0866 / Avg. bwd time: 27.2799 / Avg. batch time: 1523.6333 (ms) / GPU bubble ratio: 60.43%
[rank0]:2025-10-23 04:16:53,590 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-23 04:17:05,314 - INFO -  step: 1000  loss: -8.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,790  tflops: 21.81  mfu: 6.99%
[rank0]:2025-10-23 04:17:05,314 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-23 04:17:05,317 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1000.
[rank3]:2025-10-23 04:17:05,314 - INFO -  step: 1000  loss:  2.1587  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,790  tflops: 21.81  mfu: 6.99%
[rank3]:2025-10-23 04:17:05,314 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-23 04:17:05,316 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1000.
[rank2]:2025-10-23 04:17:05,312 - INFO -  step: 1000  loss: -8.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,790  tflops: 21.81  mfu: 6.99%
[rank2]:2025-10-23 04:17:05,312 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-23 04:17:05,315 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1000.
[rank1]:2025-10-23 04:17:05,313 - INFO -  step: 1000  loss: -8.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,790  tflops: 21.81  mfu: 6.99%
[rank1]:2025-10-23 04:17:05,313 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-23 04:17:05,315 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1000.
[rank0]:2025-10-23 04:17:07,954 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank2]:2025-10-23 04:17:07,974 - INFO - Destroying the purge thread.
[rank1]:2025-10-23 04:17:07,974 - INFO - Destroying the purge thread.
[rank0]:2025-10-23 04:17:07,974 - INFO - Sleeping 2 seconds for other ranks to complete
[rank3]:2025-10-23 04:17:08,176 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_gpipe_fullrand7_dm1/pipeline_schedule/251023_0417_real_final1000_rank3.svg
[rank3]:> Batch Time: 1376.02 ms, GPU Bubble Ratio: 71.89%, 45.39%, 62.62%, 13.14%
[rank3]:2025-10-23 04:17:08,177 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank2]:2025-10-23 04:17:08,361 - INFO - Process group destroyed
[rank1]:2025-10-23 04:17:08,365 - INFO - Process group destroyed
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:                    grad_norm â–ˆâ–ƒâ–…â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–ƒâ–†â–‡â–…â–…â–†â–…â–†â–„â–…â–„â–†â–†â–†â–†â–†â–„â–„â–„â–„â–…â–‚â–„â–ƒâ–ƒâ–ƒâ–â–ƒâ–ƒâ–‚â–â–‚â–‚â–â–â–‚â–ƒâ–„â–„
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–ƒâ–†â–‡â–…â–…â–†â–…â–†â–„â–„â–†â–†â–†â–†â–†â–„â–„â–„â–„â–…â–‚â–„â–ƒâ–ƒâ–‚â–ƒâ–â–ƒâ–‚â–â–‚â–‚â–â–‚â–‚â–ƒâ–„â–ƒâ–„
[rank3]:wandb:                           lr â–â–„â–‡â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‡â–‡â–‡â–‡â–†â–†â–†â–…â–…â–…â–„â–„â–„â–ƒâ–ƒâ–ƒâ–‚â–‚â–‚â–‚â–‚â–â–â–â–
[rank3]:wandb:         memory/max_active(%) â–‚â–ˆâ–ˆâ–ˆâ–…â–…â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:       memory/max_active(GiB) â–‚â–ˆâ–ˆâ–ˆâ–ˆâ–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:       memory/max_reserved(%) â–â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
[rank3]:wandb:     memory/max_reserved(GiB) â–â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
[rank3]:wandb:     memory/num_alloc_retries â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:              memory/num_ooms â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                           +7 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:                    grad_norm 0
[rank3]:wandb: loss_metrics/global_avg_loss 2.15873
[rank3]:wandb: loss_metrics/global_max_loss 2.15873
[rank3]:wandb:                           lr 0.0
[rank3]:wandb:         memory/max_active(%) 62.16426
[rank3]:wandb:       memory/max_active(GiB) 29.53235
[rank3]:wandb:       memory/max_reserved(%) 81.95346
[rank3]:wandb:     memory/max_reserved(GiB) 38.93359
[rank3]:wandb:     memory/num_alloc_retries 0
[rank3]:wandb:              memory/num_ooms 0
[rank3]:wandb:                           +7 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1023_gpipe_fullrand7_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/g789q5x7
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1023_gpipe_fullrand7_dm1/20251023-0048/wandb/run-20251023_004815-g789q5x7/logs
[rank3]:Traceback (most recent call last):
[rank3]:  File "<frozen runpy>", line 198, in _run_module_as_main
[rank3]:  File "<frozen runpy>", line 88, in _run_code
[rank3]:  File "/home/shcho/torchtitan/timelyfreeze/train.py", line 711, in <module>
[rank3]:    trainer.train()
[rank3]:  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
[rank3]:    return f(*args, **kwargs)
[rank3]:           ^^^^^^^^^^^^^^^^^^
[rank3]:  File "/home/shcho/torchtitan/timelyfreeze/train.py", line 612, in train
[rank3]:    draw_charts(self.freezer, self.step, job_config)
[rank3]:  File "/home/shcho/torchtitan/timelyfreeze/train.py", line 657, in draw_charts
[rank3]:    pipeline_schedule = schedule_pipeline(pipeline_schedule,
[rank3]:                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:  File "/home/shcho/torchtitan/timelyfreeze/core/schedule.py", line 186, in schedule_pipeline
[rank3]:    assert fwd_time is None or len(fwd_time) == num_stages, f"fwd_time should have the same length as num_stages. fwd_time: {len(fwd_time)}, num_stages: {num_stages}"
[rank3]:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:AssertionError: fwd_time should have the same length as num_stages. fwd_time: 1, num_stages: 4
[rank3]:[rank3]: Traceback (most recent call last):
[rank3]:[rank3]:   File "<frozen runpy>", line 198, in _run_module_as_main
[rank3]:[rank3]:   File "<frozen runpy>", line 88, in _run_code
[rank3]:[rank3]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 711, in <module>
[rank3]:[rank3]:     trainer.train()
[rank3]:[rank3]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
[rank3]:[rank3]:     return f(*args, **kwargs)
[rank3]:[rank3]:            ^^^^^^^^^^^^^^^^^^
[rank3]:[rank3]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 612, in train
[rank3]:[rank3]:     draw_charts(self.freezer, self.step, job_config)
[rank3]:[rank3]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 657, in draw_charts
[rank3]:[rank3]:     pipeline_schedule = schedule_pipeline(pipeline_schedule, 
[rank3]:[rank3]:                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:[rank3]:   File "/home/shcho/torchtitan/timelyfreeze/core/schedule.py", line 186, in schedule_pipeline
[rank3]:[rank3]:     assert fwd_time is None or len(fwd_time) == num_stages, f"fwd_time should have the same length as num_stages. fwd_time: {len(fwd_time)}, num_stages: {num_stages}"
[rank3]:[rank3]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:[rank3]: AssertionError: fwd_time should have the same length as num_stages. fwd_time: 1, num_stages: 4
[rank0]:2025-10-23 04:17:09,974 - INFO - Training completed
[rank0]:2025-10-23 04:17:09,975 - INFO - Destroying the purge thread.
[rank0]:2025-10-23 04:17:10,271 - INFO - Process group destroyed
W1023 04:17:11.990000 995094 site-packages/torch/distributed/elastic/multiprocessing/api.py:940] Sending process 995126 closing signal SIGTERM
E1023 04:17:12.373000 995094 site-packages/torch/distributed/elastic/multiprocessing/api.py:914] failed (exitcode: 1) local_rank: 3 (pid: 995129) of binary: /data2/shcho/miniforge3/envs/llm_eval/bin/python3.11
E1023 04:17:12.388000 995094 site-packages/torch/distributed/elastic/multiprocessing/errors/error_handler.py:141] no error file defined for parent, to copy child error file (/tmp/torchelastic_evi_mtys/2a28cfbe-6fd7-4755-b954-86f23e4ed3a6_3u__xvhq/attempt_0/3/error.json)
[rank2]:Stage 2: Modules to keep: {'layers.11', 'layers.10', 'layers.12', 'layers.9'}
[rank0]:Stage 0: Modules to keep: {'layers.1', 'layers.2', 'layers.3', 'tok_embeddings', 'layers.0'}
[rank1]:Stage 1: Modules to keep: {'layers.7', 'layers.6', 'layers.8', 'layers.5', 'layers.4'}
[rank3]:Stage 3: Modules to keep: {'output', 'layers.14', 'layers.15', 'norm', 'layers.13'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1022_llama1binstruct/config.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1023_gpipe_fullrand7_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: profile_trace/1023_gpipe_fullrand7_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: memory_snapshot/1023_gpipe_fullrand7_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 20
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: tb/1023_gpipe_fullrand7_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- pplog_freq: 80
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1023_gpipe_fullrand7_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B-Instruct
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 0.0003
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 50
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: slimorca
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 1000
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: gpipe
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 1
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- folder: checkpoint/1023_gpipe_fullrand7_dm1
[rank3]:		- interval: 500
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B-Instruct/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: comm_traces/1023_gpipe_fullrand7_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 8
[rank3]:		- seq_len: 2048
[rank3]:		- freq: 10
[rank3]:		- steps: -1
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: fullrand7
[rank3]:		- phase_unit: 10
[rank3]:		- stability_check_freq: 5
[rank3]:		- aggressiveness: 0
[rank3]:
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
Traceback (most recent call last):
  File "/data2/shcho/miniforge3/envs/llm_eval/bin/torchrun", line 7, in <module>
    sys.exit(main())
             ^^^^^^
  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/run.py", line 946, in main
    run(args)
  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/run.py", line 937, in run
    elastic_launch(
  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 159, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 300, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
timelyfreeze.train FAILED
------------------------------------------------------------
Failures:
  <NO_OTHER_FAILURES>
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2025-10-23_04:17:08
  host      : elga.kaist.ac.kr
  rank      : 3 (local_rank: 3)
  exitcode  : 1 (pid: 995129)
  error_file: /tmp/torchelastic_evi_mtys/2a28cfbe-6fd7-4755-b954-86f23e4ed3a6_3u__xvhq/attempt_0/3/error.json
  traceback : Traceback (most recent call last):
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
      return f(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^
    File "/home/shcho/torchtitan/timelyfreeze/train.py", line 612, in train
      draw_charts(self.freezer, self.step, job_config)
    File "/home/shcho/torchtitan/timelyfreeze/train.py", line 657, in draw_charts
      pipeline_schedule = schedule_pipeline(pipeline_schedule,
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    File "/home/shcho/torchtitan/timelyfreeze/core/schedule.py", line 186, in schedule_pipeline
      assert fwd_time is None or len(fwd_time) == num_stages, f"fwd_time should have the same length as num_stages. fwd_time: {len(fwd_time)}, num_stages: {num_stages}"
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  AssertionError: fwd_time should have the same length as num_stages. fwd_time: 1, num_stages: 4
  
============================================================
