
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 10. 23. (ëª©) 17:07:09 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 3,4,5,6
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1022_llama1binstruct/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1022_llama1binstruct/1023_gpipe_nofreeze.log
âœ”ï¸Main Table Experiment
âœ”ï¸Running with nofreeze x gpipe ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1022_llama1binstruct/config.toml --job.description="Main Table Experiment" --parallelism.pipeline_parallel_degree=4  --freezing.no-freeze
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank1]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/tyro/_parsers.py:379: UserWarning: The field `parallelism.pipeline-parallel-schedule` is annotated with type `typing.Literal['GPipe', '1FB', 'Interleaved1F1B', 'InterleavedZeroBubble', 'ZBVZeroBubble']`, but the default value `gpipe` has type `<class 'str'>`. We'll try to handle this gracefully, but it may cause unexpected behavior.
[rank1]:  warnings.warn(message)
[rank1]:2025-10-23 17:07:15,303 - INFO - Starting job: "Main Table Experiment"
[rank2]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/tyro/_parsers.py:379: UserWarning: The field `parallelism.pipeline-parallel-schedule` is annotated with type `typing.Literal['GPipe', '1FB', 'Interleaved1F1B', 'InterleavedZeroBubble', 'ZBVZeroBubble']`, but the default value `gpipe` has type `<class 'str'>`. We'll try to handle this gracefully, but it may cause unexpected behavior.
[rank2]:  warnings.warn(message)
[rank2]:2025-10-23 17:07:15,415 - INFO - Starting job: "Main Table Experiment"
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/tyro/_parsers.py:379: UserWarning: The field `parallelism.pipeline-parallel-schedule` is annotated with type `typing.Literal['GPipe', '1FB', 'Interleaved1F1B', 'InterleavedZeroBubble', 'ZBVZeroBubble']`, but the default value `gpipe` has type `<class 'str'>`. We'll try to handle this gracefully, but it may cause unexpected behavior.
[rank3]:  warnings.warn(message)
[rank0]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/tyro/_parsers.py:379: UserWarning: The field `parallelism.pipeline-parallel-schedule` is annotated with type `typing.Literal['GPipe', '1FB', 'Interleaved1F1B', 'InterleavedZeroBubble', 'ZBVZeroBubble']`, but the default value `gpipe` has type `<class 'str'>`. We'll try to handle this gracefully, but it may cause unexpected behavior.
[rank0]:  warnings.warn(message)
[rank3]:2025-10-23 17:07:15,466 - INFO - Starting job: "Main Table Experiment"
[rank0]:2025-10-23 17:07:15,548 - INFO - Starting job: "Main Table Experiment"
[rank0]:2025-10-23 17:07:15,994 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-10-23 17:07:15,996 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-23 17:07:16,000 - INFO - [GC] Initial GC collection 0.00 seconds
[rank2]:2025-10-23 17:07:15,977 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-10-23 17:07:15,980 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-10-23 17:07:16,011 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-10-23 17:07:16,013 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-10-23 17:07:16,007 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-10-23 17:07:16,009 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-23 17:07:16,395 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-10-23 17:07:16,792 - INFO - Preparing slimorca dataset from Open-Orca/SlimOrca
[rank2]:2025-10-23 17:07:19,881 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-10-23 17:07:19,921 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-10-23 17:07:19,946 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-10-23 17:07:19,946 - INFO - Using pipeline schedule gpipe with 8 microbatches and 4 stages.
[rank0]:2025-10-23 17:07:20,077 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank2]:2025-10-23 17:07:20,114 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-10-23 17:07:20,115 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-10-23 17:07:20,115 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank0]:2025-10-23 17:07:20,226 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank0]:2025-10-23 17:07:20,264 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-10-23 17:07:20,265 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-10-23 17:07:20,289 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-10-23 17:07:20,289 - INFO - Using pipeline schedule gpipe with 8 microbatches and 4 stages.
[rank0]:2025-10-23 17:07:20,476 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-10-23 17:07:20,476 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-10-23 17:07:20,476 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank1]:2025-10-23 17:07:21,294 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-10-23 17:07:21,333 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-10-23 17:07:21,362 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-10-23 17:07:21,362 - INFO - Using pipeline schedule gpipe with 8 microbatches and 4 stages.
[rank1]:2025-10-23 17:07:21,553 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-10-23 17:07:21,553 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-10-23 17:07:21,554 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank3]:wandb: setting up run mpfq2x3v
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1023_gpipe_nofreeze_dm1/20251023-1707/wandb/run-20251023_170720-mpfq2x3v
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1023_gpipe_nofreeze_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/mpfq2x3v
[rank3]:2025-10-23 17:07:21,895 - INFO - WandB logging enabled
[rank3]:2025-10-23 17:07:21,896 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-10-23 17:07:21,933 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-10-23 17:07:21,961 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-10-23 17:07:21,961 - INFO - Using pipeline schedule gpipe with 8 microbatches and 4 stages.
[rank3]:2025-10-23 17:07:22,134 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-10-23 17:07:22,135 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-10-23 17:07:22,150 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1023_gpipe_nofreeze_dm1
[rank0]:2025-10-23 17:07:22,150 - WARNING - Mixed precision training with TP or PP is only supported when FSDP/HSDP/CP is enabled.
[rank0]:2025-10-23 17:07:22,150 - INFO - Mixed precision training is disabled
[rank0]:2025-10-23 17:07:22,150 - INFO - Trainer is initialized with local batch size 16, global batch size 128, gradient accumulation steps 8, sequence length 1024, total steps 1000 (warmup 100)
[rank0]:2025-10-23 17:07:22,151 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B-Instruct/original_dcp.
[rank3]:2025-10-23 17:07:22,136 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank0]:2025-10-23 17:07:25,137 - INFO - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-10-23 17:07:25,137 - INFO - Finished loading the checkpoint in 2.99 seconds.
[rank0]:2025-10-23 17:07:25,137 - INFO - Training starts at step 1
[rank0]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/autograd/graph.py:849: UserWarning: Attempting to run cuBLAS, but there was no current CUDA context! Attempting to set the primary context... (Triggered internally at /pytorch/aten/src/ATen/cuda/CublasHandlePool.cpp:270.)
[rank0]:  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
[rank0]:2025-10-23 17:07:42,125 - INFO -  step:  1  loss: -8.0000  grad_norm:  1.7131  memory: 17.10GiB(35.99%)  tps: 1,499  tflops: 11.72  mfu: 3.76%
[rank0]:2025-10-23 17:07:42,125 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-23 17:07:42,095 - INFO -  step:  1  loss:  2.4984  grad_norm:  1.7131  memory: 35.59GiB(74.92%)  tps: 1,625  tflops: 12.71  mfu: 4.07%
[rank3]:2025-10-23 17:07:42,095 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-10-23 17:07:42,088 - INFO -  step:  1  loss: -8.0000  grad_norm:  1.7131  memory: 17.77GiB(37.40%)  tps: 1,579  tflops: 12.34  mfu: 3.96%
[rank1]:2025-10-23 17:07:42,089 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-10-23 17:07:42,085 - INFO -  step:  1  loss: -8.0000  grad_norm:  1.7131  memory: 14.29GiB(30.07%)  tps: 1,478  tflops: 11.56  mfu: 3.70%
[rank2]:2025-10-23 17:07:42,085 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-23 17:10:13,709 - INFO - Avg. fwd time: 75.3032 / Avg. bwd time: 132.9076 / Avg. batch time: 1719.9588 (ms) / GPU bubble ratio: 3.16%
[rank2]:2025-10-23 17:10:13,774 - INFO - Avg. fwd time: 34.5820 / Avg. bwd time: 54.5048 / Avg. batch time: 1810.3709 (ms) / GPU bubble ratio: 60.63%
[rank1]:2025-10-23 17:10:13,855 - INFO - Avg. fwd time: 53.3242 / Avg. bwd time: 73.8854 / Avg. batch time: 1931.9174 (ms) / GPU bubble ratio: 47.32%
[rank0]:2025-10-23 17:10:13,922 - INFO - Avg. fwd time: 48.6761 / Avg. bwd time: 60.9024 / Avg. batch time: 2031.1383 (ms) / GPU bubble ratio: 56.84%
[rank0]:2025-10-23 17:13:00,526 - INFO -  step: 20  loss: -8.0000  grad_norm:  0.4711  memory: 20.89GiB(43.97%)  tps: 1,955  tflops: 15.29  mfu: 4.90%
[rank1]:2025-10-23 17:13:00,515 - INFO -  step: 20  loss: -8.0000  grad_norm:  0.4711  memory: 20.03GiB(42.17%)  tps: 1,955  tflops: 15.29  mfu: 4.90%
[rank2]:2025-10-23 17:13:00,511 - INFO -  step: 20  loss: -8.0000  grad_norm:  0.4711  memory: 16.10GiB(33.90%)  tps: 1,955  tflops: 15.29  mfu: 4.90%
[rank3]:2025-10-23 17:13:00,523 - INFO -  step: 20  loss:  2.0449  grad_norm:  0.4711  memory: 38.93GiB(81.95%)  tps: 1,955  tflops: 15.28  mfu: 4.90%
[rank3]:2025-10-23 17:13:02,427 - INFO - Avg. fwd time: 76.1476 / Avg. bwd time: 134.3908 / Avg. batch time: 1736.0353 (ms) / GPU bubble ratio: 2.98%
[rank1]:2025-10-23 17:13:02,571 - INFO - Avg. fwd time: 54.0612 / Avg. bwd time: 74.3519 / Avg. batch time: 1949.2024 (ms) / GPU bubble ratio: 47.30%
[rank2]:2025-10-23 17:13:02,487 - INFO - Avg. fwd time: 34.6934 / Avg. bwd time: 54.8892 / Avg. batch time: 1827.3062 (ms) / GPU bubble ratio: 60.78%
[rank0]:2025-10-23 17:13:02,634 - INFO - Avg. fwd time: 48.3177 / Avg. bwd time: 61.2059 / Avg. batch time: 2048.7564 (ms) / GPU bubble ratio: 57.23%
[rank3]:2025-10-23 17:15:50,746 - INFO - Avg. fwd time: 76.2001 / Avg. bwd time: 134.7919 / Avg. batch time: 1738.9726 (ms) / GPU bubble ratio: 2.93%
[rank2]:2025-10-23 17:15:50,804 - INFO - Avg. fwd time: 34.8083 / Avg. bwd time: 55.0328 / Avg. batch time: 1830.7191 (ms) / GPU bubble ratio: 60.74%
[rank0]:2025-10-23 17:15:50,953 - INFO - Avg. fwd time: 48.3003 / Avg. bwd time: 61.1598 / Avg. batch time: 2053.0609 (ms) / GPU bubble ratio: 57.35%
[rank1]:2025-10-23 17:15:50,885 - INFO - Avg. fwd time: 54.2619 / Avg. bwd time: 74.4511 / Avg. batch time: 1952.8501 (ms) / GPU bubble ratio: 47.27%
[rank2]:2025-10-23 17:18:36,892 - INFO -  step: 40  loss: -8.0000  grad_norm:  0.3442  memory: 16.10GiB(33.90%)  tps: 1,948  tflops: 15.23  mfu: 4.88%
[rank3]:2025-10-23 17:18:36,904 - INFO -  step: 40  loss:  2.0147  grad_norm:  0.3442  memory: 38.93GiB(81.95%)  tps: 1,948  tflops: 15.23  mfu: 4.88%
[rank0]:2025-10-23 17:18:36,912 - INFO -  step: 40  loss: -8.0000  grad_norm:  0.3442  memory: 20.89GiB(43.97%)  tps: 1,948  tflops: 15.23  mfu: 4.88%
[rank1]:2025-10-23 17:18:36,895 - INFO -  step: 40  loss: -8.0000  grad_norm:  0.3442  memory: 20.03GiB(42.17%)  tps: 1,948  tflops: 15.23  mfu: 4.88%
[rank3]:2025-10-23 17:18:38,811 - INFO - Avg. fwd time: 76.1410 / Avg. bwd time: 134.9539 / Avg. batch time: 1739.7489 (ms) / GPU bubble ratio: 2.93%
[rank2]:2025-10-23 17:18:38,869 - INFO - Avg. fwd time: 34.8035 / Avg. bwd time: 55.0483 / Avg. batch time: 1831.7214 (ms) / GPU bubble ratio: 60.76%
[rank1]:2025-10-23 17:18:38,945 - INFO - Avg. fwd time: 54.4294 / Avg. bwd time: 74.5977 / Avg. batch time: 1954.0516 (ms) / GPU bubble ratio: 47.18%
[rank0]:2025-10-23 17:18:39,011 - INFO - Avg. fwd time: 48.2890 / Avg. bwd time: 61.1983 / Avg. batch time: 2054.3849 (ms) / GPU bubble ratio: 57.36%
[rank0]:2025-10-23 17:21:08,100 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-23 17:21:26,827 - INFO - Avg. fwd time: 34.8391 / Avg. bwd time: 55.0074 / Avg. batch time: 1831.4341 (ms) / GPU bubble ratio: 60.75%
[rank3]:2025-10-23 17:21:26,767 - INFO - Avg. fwd time: 76.0128 / Avg. bwd time: 135.0446 / Avg. batch time: 1739.5204 (ms) / GPU bubble ratio: 2.94%
[rank1]:2025-10-23 17:21:26,909 - INFO - Avg. fwd time: 54.5599 / Avg. bwd time: 74.8066 / Avg. batch time: 1954.2569 (ms) / GPU bubble ratio: 47.04%
[rank0]:2025-10-23 17:21:26,976 - INFO - Avg. fwd time: 48.2898 / Avg. bwd time: 61.1290 / Avg. batch time: 2054.8339 (ms) / GPU bubble ratio: 57.40%
[rank1]:2025-10-23 17:24:12,829 - INFO -  step: 60  loss: -8.0000  grad_norm:  0.3382  memory: 20.03GiB(42.17%)  tps: 1,951  tflops: 15.25  mfu: 4.89%
[rank2]:2025-10-23 17:24:12,825 - INFO -  step: 60  loss: -8.0000  grad_norm:  0.3382  memory: 16.10GiB(33.90%)  tps: 1,951  tflops: 15.25  mfu: 4.89%
[rank3]:2025-10-23 17:24:12,837 - INFO -  step: 60  loss:  1.9362  grad_norm:  0.3382  memory: 38.93GiB(81.95%)  tps: 1,951  tflops: 15.25  mfu: 4.89%
[rank0]:2025-10-23 17:24:12,852 - INFO -  step: 60  loss: -8.0000  grad_norm:  0.3382  memory: 20.89GiB(43.97%)  tps: 1,951  tflops: 15.25  mfu: 4.89%
[rank3]:2025-10-23 17:24:14,735 - INFO - Avg. fwd time: 76.0781 / Avg. bwd time: 135.0689 / Avg. batch time: 1739.9111 (ms) / GPU bubble ratio: 2.92%
[rank2]:2025-10-23 17:24:14,793 - INFO - Avg. fwd time: 34.8237 / Avg. bwd time: 54.9378 / Avg. batch time: 1831.6902 (ms) / GPU bubble ratio: 60.80%
[rank1]:2025-10-23 17:24:14,868 - INFO - Avg. fwd time: 54.3871 / Avg. bwd time: 74.9197 / Avg. batch time: 1954.3821 (ms) / GPU bubble ratio: 47.07%
[rank0]:2025-10-23 17:24:14,933 - INFO - Avg. fwd time: 48.2661 / Avg. bwd time: 61.1267 / Avg. batch time: 2055.0245 (ms) / GPU bubble ratio: 57.41%
[rank3]:2025-10-23 17:27:02,618 - INFO - Avg. fwd time: 76.0533 / Avg. bwd time: 135.0976 / Avg. batch time: 1739.9708 (ms) / GPU bubble ratio: 2.92%
[rank1]:2025-10-23 17:27:02,758 - INFO - Avg. fwd time: 54.4098 / Avg. bwd time: 74.9753 / Avg. batch time: 1954.5272 (ms) / GPU bubble ratio: 47.04%
[rank2]:2025-10-23 17:27:02,681 - INFO - Avg. fwd time: 34.8276 / Avg. bwd time: 54.9194 / Avg. batch time: 1831.6917 (ms) / GPU bubble ratio: 60.80%
[rank0]:2025-10-23 17:27:02,821 - INFO - Avg. fwd time: 48.2238 / Avg. bwd time: 61.1064 / Avg. batch time: 2055.1499 (ms) / GPU bubble ratio: 57.44%
[rank2]:2025-10-23 17:29:49,342 - INFO -  step: 80  loss: -8.0000  grad_norm:  0.3566  memory: 16.10GiB(33.90%)  tps: 1,947  tflops: 15.22  mfu: 4.88%
[rank0]:2025-10-23 17:29:49,362 - INFO -  step: 80  loss: -8.0000  grad_norm:  0.3566  memory: 20.89GiB(43.97%)  tps: 1,948  tflops: 15.22  mfu: 4.88%
[rank1]:2025-10-23 17:29:49,346 - INFO -  step: 80  loss: -8.0000  grad_norm:  0.3566  memory: 20.03GiB(42.17%)  tps: 1,947  tflops: 15.22  mfu: 4.88%
[rank3]:2025-10-23 17:29:49,354 - INFO -  step: 80  loss:  1.8492  grad_norm:  0.3566  memory: 38.93GiB(81.95%)  tps: 1,947  tflops: 15.22  mfu: 4.88%
[rank3]:2025-10-23 17:29:51,275 - INFO - Avg. fwd time: 76.0907 / Avg. bwd time: 135.1970 / Avg. batch time: 1741.0042 (ms) / GPU bubble ratio: 2.91%
[rank2]:2025-10-23 17:29:51,336 - INFO - Avg. fwd time: 34.8372 / Avg. bwd time: 54.9571 / Avg. batch time: 1832.7844 (ms) / GPU bubble ratio: 60.81%
[rank0]:2025-10-23 17:29:51,480 - INFO - Avg. fwd time: 48.2368 / Avg. bwd time: 61.1379 / Avg. batch time: 2056.3292 (ms) / GPU bubble ratio: 57.45%
[rank1]:2025-10-23 17:29:51,418 - INFO - Avg. fwd time: 54.5327 / Avg. bwd time: 74.9458 / Avg. batch time: 1955.7059 (ms) / GPU bubble ratio: 47.04%
[rank3]:2025-10-23 17:32:38,942 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_gpipe_nofreeze_dm1/pipeline_schedule/251023_1732_real_warmupend90_rank3.svg
[rank3]:> Batch Time: 2009.88 ms, GPU Bubble Ratio: 56.50%, 47.76%, 64.68%, 15.71%
[rank3]:2025-10-23 17:32:40,747 - INFO - Avg. fwd time: 76.2153 / Avg. bwd time: 135.3037 / Avg. batch time: 1742.7138 (ms) / GPU bubble ratio: 2.90%
[rank2]:2025-10-23 17:32:40,808 - INFO - Avg. fwd time: 34.8418 / Avg. bwd time: 54.9716 / Avg. batch time: 1834.7082 (ms) / GPU bubble ratio: 60.84%
[rank1]:2025-10-23 17:32:40,885 - INFO - Avg. fwd time: 54.5817 / Avg. bwd time: 74.9531 / Avg. batch time: 1957.7105 (ms) / GPU bubble ratio: 47.07%
[rank0]:2025-10-23 17:32:40,949 - INFO - Avg. fwd time: 48.2426 / Avg. bwd time: 61.1853 / Avg. batch time: 2058.2756 (ms) / GPU bubble ratio: 57.47%
[rank0]:2025-10-23 17:35:10,468 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-23 17:35:27,346 - INFO -  step: 100  loss:  1.9025  grad_norm:  0.3639  memory: 38.93GiB(81.95%)  tps: 1,939  tflops: 15.16  mfu: 4.86%
[rank0]:2025-10-23 17:35:27,353 - INFO -  step: 100  loss: -8.0000  grad_norm:  0.3639  memory: 20.89GiB(43.97%)  tps: 1,939  tflops: 15.16  mfu: 4.86%
[rank2]:2025-10-23 17:35:27,333 - INFO -  step: 100  loss: -8.0000  grad_norm:  0.3639  memory: 16.10GiB(33.90%)  tps: 1,939  tflops: 15.16  mfu: 4.86%
[rank1]:2025-10-23 17:35:27,337 - INFO -  step: 100  loss: -8.0000  grad_norm:  0.3639  memory: 20.03GiB(42.17%)  tps: 1,939  tflops: 15.16  mfu: 4.86%
[rank3]:2025-10-23 17:35:27,597 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_gpipe_nofreeze_dm1/pipeline_schedule/251023_1735_real_step100_rank3.svg
[rank3]:> Batch Time: 2011.03 ms, GPU Bubble Ratio: 56.51%, 47.76%, 64.69%, 15.73%
[rank3]:2025-10-23 17:35:29,393 - INFO - Avg. fwd time: 76.2078 / Avg. bwd time: 135.3494 / Avg. batch time: 1743.0793 (ms) / GPU bubble ratio: 2.90%
[rank2]:2025-10-23 17:35:29,451 - INFO - Avg. fwd time: 34.8446 / Avg. bwd time: 55.0070 / Avg. batch time: 1835.2084 (ms) / GPU bubble ratio: 60.83%
[rank1]:2025-10-23 17:35:29,528 - INFO - Avg. fwd time: 54.6638 / Avg. bwd time: 74.9344 / Avg. batch time: 1958.2239 (ms) / GPU bubble ratio: 47.05%
[rank0]:2025-10-23 17:35:29,595 - INFO - Avg. fwd time: 48.2397 / Avg. bwd time: 61.2148 / Avg. batch time: 2058.7501 (ms) / GPU bubble ratio: 57.47%
[rank3]:2025-10-23 17:38:18,164 - INFO - Avg. fwd time: 76.2353 / Avg. bwd time: 135.3931 / Avg. batch time: 1743.6374 (ms) / GPU bubble ratio: 2.90%
[rank2]:2025-10-23 17:38:18,227 - INFO - Avg. fwd time: 34.8547 / Avg. bwd time: 55.0718 / Avg. batch time: 1835.8035 (ms) / GPU bubble ratio: 60.81%
[rank1]:2025-10-23 17:38:18,309 - INFO - Avg. fwd time: 54.7049 / Avg. bwd time: 74.8875 / Avg. batch time: 1958.8619 (ms) / GPU bubble ratio: 47.07%
[rank0]:2025-10-23 17:38:18,375 - INFO - Avg. fwd time: 48.2370 / Avg. bwd time: 61.2553 / Avg. batch time: 2059.3272 (ms) / GPU bubble ratio: 57.46%
[rank3]:2025-10-23 17:41:05,521 - INFO -  step: 120  loss:  1.8947  grad_norm:  0.2963  memory: 38.93GiB(81.95%)  tps: 1,938  tflops: 15.15  mfu: 4.86%
[rank0]:2025-10-23 17:41:05,532 - INFO -  step: 120  loss: -8.0000  grad_norm:  0.2963  memory: 20.89GiB(43.97%)  tps: 1,938  tflops: 15.15  mfu: 4.86%
[rank2]:2025-10-23 17:41:05,509 - INFO -  step: 120  loss: -8.0000  grad_norm:  0.2963  memory: 16.10GiB(33.90%)  tps: 1,938  tflops: 15.15  mfu: 4.86%
[rank1]:2025-10-23 17:41:05,513 - INFO -  step: 120  loss: -8.0000  grad_norm:  0.2963  memory: 20.03GiB(42.17%)  tps: 1,938  tflops: 15.15  mfu: 4.86%
[rank3]:2025-10-23 17:41:07,450 - INFO - Avg. fwd time: 76.3211 / Avg. bwd time: 135.4496 / Avg. batch time: 1744.6164 (ms) / GPU bubble ratio: 2.89%
[rank2]:2025-10-23 17:41:07,510 - INFO - Avg. fwd time: 34.8655 / Avg. bwd time: 55.0748 / Avg. batch time: 1836.7555 (ms) / GPU bubble ratio: 60.83%
[rank1]:2025-10-23 17:41:07,592 - INFO - Avg. fwd time: 54.7137 / Avg. bwd time: 74.9026 / Avg. batch time: 1959.8298 (ms) / GPU bubble ratio: 47.09%
[rank0]:2025-10-23 17:41:07,660 - INFO - Avg. fwd time: 48.2453 / Avg. bwd time: 61.2777 / Avg. batch time: 2060.2862 (ms) / GPU bubble ratio: 57.47%
[rank3]:2025-10-23 17:43:55,961 - INFO - Avg. fwd time: 76.3132 / Avg. bwd time: 135.4663 / Avg. batch time: 1744.7024 (ms) / GPU bubble ratio: 2.89%
[rank2]:2025-10-23 17:43:56,020 - INFO - Avg. fwd time: 34.8855 / Avg. bwd time: 55.0851 / Avg. batch time: 1836.8358 (ms) / GPU bubble ratio: 60.81%
[rank1]:2025-10-23 17:43:56,102 - INFO - Avg. fwd time: 54.7579 / Avg. bwd time: 74.9037 / Avg. batch time: 1959.9632 (ms) / GPU bubble ratio: 47.08%
[rank0]:2025-10-23 17:43:56,168 - INFO - Avg. fwd time: 48.2394 / Avg. bwd time: 61.2890 / Avg. batch time: 2060.4191 (ms) / GPU bubble ratio: 57.47%
[rank2]:2025-10-23 17:46:42,288 - INFO -  step: 140  loss: -8.0000  grad_norm:  0.3831  memory: 16.10GiB(33.90%)  tps: 1,946  tflops: 15.21  mfu: 4.88%
[rank1]:2025-10-23 17:46:42,292 - INFO -  step: 140  loss: -8.0000  grad_norm:  0.3831  memory: 20.03GiB(42.17%)  tps: 1,946  tflops: 15.21  mfu: 4.88%
[rank3]:2025-10-23 17:46:42,301 - INFO -  step: 140  loss:  1.9193  grad_norm:  0.3831  memory: 38.93GiB(81.95%)  tps: 1,946  tflops: 15.21  mfu: 4.88%
[rank0]:2025-10-23 17:46:42,307 - INFO -  step: 140  loss: -8.0000  grad_norm:  0.3831  memory: 20.89GiB(43.97%)  tps: 1,946  tflops: 15.21  mfu: 4.88%
[rank3]:2025-10-23 17:46:44,191 - INFO - Avg. fwd time: 76.2745 / Avg. bwd time: 135.4713 / Avg. batch time: 1744.5457 (ms) / GPU bubble ratio: 2.90%
[rank2]:2025-10-23 17:46:44,249 - INFO - Avg. fwd time: 34.8885 / Avg. bwd time: 55.1108 / Avg. batch time: 1836.6871 (ms) / GPU bubble ratio: 60.80%
[rank1]:2025-10-23 17:46:44,330 - INFO - Avg. fwd time: 54.8242 / Avg. bwd time: 74.8571 / Avg. batch time: 1959.8303 (ms) / GPU bubble ratio: 47.06%
[rank0]:2025-10-23 17:46:44,397 - INFO - Avg. fwd time: 48.2281 / Avg. bwd time: 61.2647 / Avg. batch time: 2060.2596 (ms) / GPU bubble ratio: 57.48%
[rank0]:2025-10-23 17:49:13,453 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-23 17:49:32,145 - INFO - Avg. fwd time: 76.2333 / Avg. bwd time: 135.4535 / Avg. batch time: 1744.1019 (ms) / GPU bubble ratio: 2.90%
[rank2]:2025-10-23 17:49:32,204 - INFO - Avg. fwd time: 34.8849 / Avg. bwd time: 55.1155 / Avg. batch time: 1836.2269 (ms) / GPU bubble ratio: 60.79%
[rank1]:2025-10-23 17:49:32,280 - INFO - Avg. fwd time: 54.8723 / Avg. bwd time: 74.8357 / Avg. batch time: 1959.4279 (ms) / GPU bubble ratio: 47.04%
[rank0]:2025-10-23 17:49:32,346 - INFO - Avg. fwd time: 48.2279 / Avg. bwd time: 61.2384 / Avg. batch time: 2059.9405 (ms) / GPU bubble ratio: 57.49%
[rank2]:2025-10-23 17:52:18,361 - INFO -  step: 160  loss: -8.0000  grad_norm:  0.3254  memory: 16.10GiB(33.90%)  tps: 1,950  tflops: 15.24  mfu: 4.89%
[rank1]:2025-10-23 17:52:18,365 - INFO -  step: 160  loss: -8.0000  grad_norm:  0.3254  memory: 20.03GiB(42.17%)  tps: 1,950  tflops: 15.24  mfu: 4.89%
[rank0]:2025-10-23 17:52:18,380 - INFO -  step: 160  loss: -8.0000  grad_norm:  0.3254  memory: 20.89GiB(43.97%)  tps: 1,950  tflops: 15.24  mfu: 4.89%
[rank3]:2025-10-23 17:52:18,373 - INFO -  step: 160  loss:  1.8616  grad_norm:  0.3254  memory: 38.93GiB(81.95%)  tps: 1,950  tflops: 15.24  mfu: 4.89%
[rank3]:2025-10-23 17:52:20,290 - INFO - Avg. fwd time: 76.1946 / Avg. bwd time: 135.4399 / Avg. batch time: 1743.7468 (ms) / GPU bubble ratio: 2.91%
[rank2]:2025-10-23 17:52:20,351 - INFO - Avg. fwd time: 34.8847 / Avg. bwd time: 55.1217 / Avg. batch time: 1835.8970 (ms) / GPU bubble ratio: 60.78%
[rank1]:2025-10-23 17:52:20,435 - INFO - Avg. fwd time: 54.9177 / Avg. bwd time: 74.8280 / Avg. batch time: 1959.2032 (ms) / GPU bubble ratio: 47.02%
[rank0]:2025-10-23 17:52:20,502 - INFO - Avg. fwd time: 48.2202 / Avg. bwd time: 61.2146 / Avg. batch time: 2059.7984 (ms) / GPU bubble ratio: 57.50%
[rank3]:2025-10-23 17:55:09,307 - INFO - Avg. fwd time: 76.2382 / Avg. bwd time: 135.4689 / Avg. batch time: 1744.2402 (ms) / GPU bubble ratio: 2.90%
[rank2]:2025-10-23 17:55:09,369 - INFO - Avg. fwd time: 34.8753 / Avg. bwd time: 55.1359 / Avg. batch time: 1836.4006 (ms) / GPU bubble ratio: 60.79%
[rank1]:2025-10-23 17:55:09,452 - INFO - Avg. fwd time: 54.9463 / Avg. bwd time: 74.8763 / Avg. batch time: 1959.7676 (ms) / GPU bubble ratio: 47.00%
[rank0]:2025-10-23 17:55:09,515 - INFO - Avg. fwd time: 48.2128 / Avg. bwd time: 61.2411 / Avg. batch time: 2060.3085 (ms) / GPU bubble ratio: 57.50%
[rank3]:2025-10-23 17:57:56,665 - INFO -  step: 180  loss:  1.9105  grad_norm:  0.3712  memory: 38.93GiB(81.95%)  tps: 1,937  tflops: 15.14  mfu: 4.85%
[rank2]:2025-10-23 17:57:56,653 - INFO -  step: 180  loss: -8.0000  grad_norm:  0.3712  memory: 16.10GiB(33.90%)  tps: 1,937  tflops: 15.14  mfu: 4.85%
[rank1]:2025-10-23 17:57:56,657 - INFO -  step: 180  loss: -8.0000  grad_norm:  0.3712  memory: 20.03GiB(42.17%)  tps: 1,937  tflops: 15.14  mfu: 4.85%
[rank0]:2025-10-23 17:57:56,673 - INFO -  step: 180  loss: -8.0000  grad_norm:  0.3712  memory: 20.89GiB(43.97%)  tps: 1,937  tflops: 15.14  mfu: 4.85%
[rank3]:2025-10-23 17:57:58,583 - INFO - Avg. fwd time: 76.2744 / Avg. bwd time: 135.5158 / Avg. batch time: 1744.9108 (ms) / GPU bubble ratio: 2.90%
[rank2]:2025-10-23 17:57:58,642 - INFO - Avg. fwd time: 34.8715 / Avg. bwd time: 55.1455 / Avg. batch time: 1837.0656 (ms) / GPU bubble ratio: 60.80%
[rank1]:2025-10-23 17:57:58,719 - INFO - Avg. fwd time: 55.0013 / Avg. bwd time: 74.8827 / Avg. batch time: 1960.4503 (ms) / GPU bubble ratio: 47.00%
[rank0]:2025-10-23 17:57:58,784 - INFO - Avg. fwd time: 48.2042 / Avg. bwd time: 61.2571 / Avg. batch time: 2060.9292 (ms) / GPU bubble ratio: 57.51%
[rank3]:2025-10-23 18:00:47,393 - INFO - Avg. fwd time: 76.2956 / Avg. bwd time: 135.5364 / Avg. batch time: 1745.2062 (ms) / GPU bubble ratio: 2.90%
[rank2]:2025-10-23 18:00:47,451 - INFO - Avg. fwd time: 34.8726 / Avg. bwd time: 55.1502 / Avg. batch time: 1837.3524 (ms) / GPU bubble ratio: 60.80%
[rank1]:2025-10-23 18:00:47,528 - INFO - Avg. fwd time: 55.0400 / Avg. bwd time: 74.8866 / Avg. batch time: 1960.7953 (ms) / GPU bubble ratio: 46.99%
[rank0]:2025-10-23 18:00:47,593 - INFO - Avg. fwd time: 48.1845 / Avg. bwd time: 61.2632 / Avg. batch time: 2061.2146 (ms) / GPU bubble ratio: 57.52%
[rank0]:2025-10-23 18:03:16,991 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-23 18:03:33,820 - INFO -  step: 200  loss:  1.8104  grad_norm:  0.3320  memory: 38.93GiB(81.95%)  tps: 1,944  tflops: 15.20  mfu: 4.87%
[rank1]:2025-10-23 18:03:33,813 - INFO -  step: 200  loss: -8.0000  grad_norm:  0.3320  memory: 20.03GiB(42.17%)  tps: 1,944  tflops: 15.20  mfu: 4.87%
[rank2]:2025-10-23 18:03:33,808 - INFO -  step: 200  loss: -8.0000  grad_norm:  0.3320  memory: 16.10GiB(33.90%)  tps: 1,944  tflops: 15.20  mfu: 4.87%
[rank0]:2025-10-23 18:03:33,828 - INFO -  step: 200  loss: -8.0000  grad_norm:  0.3320  memory: 20.89GiB(43.97%)  tps: 1,944  tflops: 15.20  mfu: 4.87%
[rank3]:2025-10-23 18:03:34,072 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_gpipe_nofreeze_dm1/pipeline_schedule/251023_1803_real_step200_rank3.svg
[rank3]:> Batch Time: 2011.62 ms, GPU Bubble Ratio: 56.53%, 47.80%, 64.61%, 15.74%
[rank3]:2025-10-23 18:03:35,868 - INFO - Avg. fwd time: 76.2996 / Avg. bwd time: 135.5322 / Avg. batch time: 1745.1933 (ms) / GPU bubble ratio: 2.90%
[rank2]:2025-10-23 18:03:35,928 - INFO - Avg. fwd time: 34.8758 / Avg. bwd time: 55.1470 / Avg. batch time: 1837.4131 (ms) / GPU bubble ratio: 60.80%
[rank1]:2025-10-23 18:03:36,013 - INFO - Avg. fwd time: 55.0398 / Avg. bwd time: 74.8568 / Avg. batch time: 1960.8417 (ms) / GPU bubble ratio: 47.00%
[rank0]:2025-10-23 18:03:36,078 - INFO - Avg. fwd time: 48.1798 / Avg. bwd time: 61.2476 / Avg. batch time: 2061.2464 (ms) / GPU bubble ratio: 57.53%
[rank3]:2025-10-23 18:06:23,981 - INFO - Avg. fwd time: 76.2831 / Avg. bwd time: 135.5263 / Avg. batch time: 1745.0034 (ms) / GPU bubble ratio: 2.90%
[rank2]:2025-10-23 18:06:24,043 - INFO - Avg. fwd time: 34.8737 / Avg. bwd time: 55.1534 / Avg. batch time: 1837.2263 (ms) / GPU bubble ratio: 60.80%
[rank1]:2025-10-23 18:06:24,122 - INFO - Avg. fwd time: 55.0596 / Avg. bwd time: 74.8010 / Avg. batch time: 1960.6913 (ms) / GPU bubble ratio: 47.01%
[rank0]:2025-10-23 18:06:24,186 - INFO - Avg. fwd time: 48.1629 / Avg. bwd time: 61.2164 / Avg. batch time: 2061.0607 (ms) / GPU bubble ratio: 57.54%
[rank1]:2025-10-23 18:09:10,573 - INFO -  step: 220  loss: -8.0000  grad_norm:  0.3230  memory: 20.03GiB(42.17%)  tps: 1,946  tflops: 15.21  mfu: 4.88%
[rank2]:2025-10-23 18:09:10,569 - INFO -  step: 220  loss: -8.0000  grad_norm:  0.3230  memory: 16.10GiB(33.90%)  tps: 1,946  tflops: 15.21  mfu: 4.88%
[rank0]:2025-10-23 18:09:10,589 - INFO -  step: 220  loss: -8.0000  grad_norm:  0.3230  memory: 20.89GiB(43.97%)  tps: 1,946  tflops: 15.21  mfu: 4.88%
[rank3]:2025-10-23 18:09:10,582 - INFO -  step: 220  loss:  1.9214  grad_norm:  0.3230  memory: 38.93GiB(81.95%)  tps: 1,946  tflops: 15.21  mfu: 4.88%
[rank3]:2025-10-23 18:09:12,477 - INFO - Avg. fwd time: 76.3005 / Avg. bwd time: 135.5191 / Avg. batch time: 1745.0561 (ms) / GPU bubble ratio: 2.89%
[rank2]:2025-10-23 18:09:12,540 - INFO - Avg. fwd time: 34.8776 / Avg. bwd time: 55.1481 / Avg. batch time: 1837.2781 (ms) / GPU bubble ratio: 60.80%
[rank1]:2025-10-23 18:09:12,621 - INFO - Avg. fwd time: 55.0566 / Avg. bwd time: 74.7836 / Avg. batch time: 1960.7362 (ms) / GPU bubble ratio: 47.02%
[rank0]:2025-10-23 18:09:12,685 - INFO - Avg. fwd time: 48.1513 / Avg. bwd time: 61.2187 / Avg. batch time: 2061.0956 (ms) / GPU bubble ratio: 57.55%
[rank3]:2025-10-23 18:12:01,268 - INFO - Avg. fwd time: 76.3162 / Avg. bwd time: 135.5434 / Avg. batch time: 1745.3266 (ms) / GPU bubble ratio: 2.89%
[rank2]:2025-10-23 18:12:01,327 - INFO - Avg. fwd time: 34.8849 / Avg. bwd time: 55.1564 / Avg. batch time: 1837.5491 (ms) / GPU bubble ratio: 60.80%
[rank1]:2025-10-23 18:12:01,406 - INFO - Avg. fwd time: 55.0540 / Avg. bwd time: 74.7431 / Avg. batch time: 1960.9755 (ms) / GPU bubble ratio: 47.05%
[rank0]:2025-10-23 18:12:01,471 - INFO - Avg. fwd time: 48.1455 / Avg. bwd time: 61.2365 / Avg. batch time: 2061.3015 (ms) / GPU bubble ratio: 57.55%
[rank2]:2025-10-23 18:14:48,113 - INFO -  step: 240  loss: -8.0000  grad_norm:  0.3195  memory: 16.10GiB(33.90%)  tps: 1,942  tflops: 15.18  mfu: 4.86%
[rank1]:2025-10-23 18:14:48,117 - INFO -  step: 240  loss: -8.0000  grad_norm:  0.3195  memory: 20.03GiB(42.17%)  tps: 1,942  tflops: 15.18  mfu: 4.86%
[rank0]:2025-10-23 18:14:48,136 - INFO -  step: 240  loss: -8.0000  grad_norm:  0.3195  memory: 20.89GiB(43.97%)  tps: 1,942  tflops: 15.18  mfu: 4.86%
[rank3]:2025-10-23 18:14:48,128 - INFO -  step: 240  loss:  1.8667  grad_norm:  0.3195  memory: 38.93GiB(81.95%)  tps: 1,942  tflops: 15.18  mfu: 4.86%
[rank3]:2025-10-23 18:14:50,043 - INFO - Avg. fwd time: 76.3423 / Avg. bwd time: 135.5521 / Avg. batch time: 1745.5488 (ms) / GPU bubble ratio: 2.89%
[rank2]:2025-10-23 18:14:50,102 - INFO - Avg. fwd time: 34.8898 / Avg. bwd time: 55.1762 / Avg. batch time: 1837.7827 (ms) / GPU bubble ratio: 60.79%
[rank1]:2025-10-23 18:14:50,178 - INFO - Avg. fwd time: 55.0542 / Avg. bwd time: 74.7070 / Avg. batch time: 1961.1788 (ms) / GPU bubble ratio: 47.07%
[rank0]:2025-10-23 18:14:50,248 - INFO - Avg. fwd time: 48.1403 / Avg. bwd time: 61.2394 / Avg. batch time: 2061.4761 (ms) / GPU bubble ratio: 57.55%
[rank0]:2025-10-23 18:17:19,669 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-23 18:17:38,384 - INFO - Avg. fwd time: 76.3491 / Avg. bwd time: 135.5490 / Avg. batch time: 1745.5329 (ms) / GPU bubble ratio: 2.88%
[rank2]:2025-10-23 18:17:38,444 - INFO - Avg. fwd time: 34.8880 / Avg. bwd time: 55.1801 / Avg. batch time: 1837.7466 (ms) / GPU bubble ratio: 60.79%
[rank1]:2025-10-23 18:17:38,517 - INFO - Avg. fwd time: 55.0467 / Avg. bwd time: 74.6920 / Avg. batch time: 1961.1455 (ms) / GPU bubble ratio: 47.08%
[rank0]:2025-10-23 18:17:38,581 - INFO - Avg. fwd time: 48.1347 / Avg. bwd time: 61.2395 / Avg. batch time: 2061.4137 (ms) / GPU bubble ratio: 57.55%
[rank1]:2025-10-23 18:20:24,995 - INFO -  step: 260  loss: -8.0000  grad_norm:  0.3007  memory: 20.03GiB(42.17%)  tps: 1,945  tflops: 15.21  mfu: 4.87%
[rank0]:2025-10-23 18:20:25,011 - INFO -  step: 260  loss: -8.0000  grad_norm:  0.3007  memory: 20.89GiB(43.97%)  tps: 1,945  tflops: 15.21  mfu: 4.87%
[rank3]:2025-10-23 18:20:25,003 - INFO -  step: 260  loss:  1.7912  grad_norm:  0.3007  memory: 38.93GiB(81.95%)  tps: 1,945  tflops: 15.21  mfu: 4.87%
[rank2]:2025-10-23 18:20:24,990 - INFO -  step: 260  loss: -8.0000  grad_norm:  0.3007  memory: 16.10GiB(33.90%)  tps: 1,945  tflops: 15.21  mfu: 4.87%
[rank3]:2025-10-23 18:20:26,932 - INFO - Avg. fwd time: 76.3493 / Avg. bwd time: 135.5624 / Avg. batch time: 1745.6258 (ms) / GPU bubble ratio: 2.88%
[rank2]:2025-10-23 18:20:26,991 - INFO - Avg. fwd time: 34.8932 / Avg. bwd time: 55.1828 / Avg. batch time: 1837.8348 (ms) / GPU bubble ratio: 60.79%
[rank1]:2025-10-23 18:20:27,071 - INFO - Avg. fwd time: 55.0510 / Avg. bwd time: 74.6698 / Avg. batch time: 1961.2321 (ms) / GPU bubble ratio: 47.09%
[rank0]:2025-10-23 18:20:27,136 - INFO - Avg. fwd time: 48.1242 / Avg. bwd time: 61.2394 / Avg. batch time: 2061.4500 (ms) / GPU bubble ratio: 57.56%
[rank3]:2025-10-23 18:23:15,933 - INFO - Avg. fwd time: 76.3796 / Avg. bwd time: 135.5781 / Avg. batch time: 1745.9307 (ms) / GPU bubble ratio: 2.88%
[rank2]:2025-10-23 18:23:15,997 - INFO - Avg. fwd time: 34.8999 / Avg. bwd time: 55.1883 / Avg. batch time: 1838.1456 (ms) / GPU bubble ratio: 60.79%
[rank1]:2025-10-23 18:23:16,077 - INFO - Avg. fwd time: 55.0326 / Avg. bwd time: 74.6790 / Avg. batch time: 1961.5306 (ms) / GPU bubble ratio: 47.10%
[rank0]:2025-10-23 18:23:16,141 - INFO - Avg. fwd time: 48.1231 / Avg. bwd time: 61.2548 / Avg. batch time: 2061.7294 (ms) / GPU bubble ratio: 57.56%
[rank1]:2025-10-23 18:26:02,921 - INFO -  step: 280  loss: -8.0000  grad_norm:  0.3226  memory: 20.03GiB(42.17%)  tps: 1,939  tflops: 15.16  mfu: 4.86%
[rank0]:2025-10-23 18:26:02,935 - INFO -  step: 280  loss: -8.0000  grad_norm:  0.3226  memory: 20.89GiB(43.97%)  tps: 1,939  tflops: 15.16  mfu: 4.86%
[rank2]:2025-10-23 18:26:02,916 - INFO -  step: 280  loss: -8.0000  grad_norm:  0.3226  memory: 16.10GiB(33.90%)  tps: 1,939  tflops: 15.16  mfu: 4.86%
[rank3]:2025-10-23 18:26:02,928 - INFO -  step: 280  loss:  1.8643  grad_norm:  0.3226  memory: 38.93GiB(81.95%)  tps: 1,939  tflops: 15.16  mfu: 4.86%
[rank3]:2025-10-23 18:26:04,852 - INFO - Avg. fwd time: 76.3947 / Avg. bwd time: 135.5945 / Avg. batch time: 1746.1438 (ms) / GPU bubble ratio: 2.88%
[rank2]:2025-10-23 18:26:04,912 - INFO - Avg. fwd time: 34.8973 / Avg. bwd time: 55.1903 / Avg. batch time: 1838.3565 (ms) / GPU bubble ratio: 60.80%
[rank1]:2025-10-23 18:26:04,993 - INFO - Avg. fwd time: 55.0375 / Avg. bwd time: 74.6637 / Avg. batch time: 1961.7267 (ms) / GPU bubble ratio: 47.11%
[rank0]:2025-10-23 18:26:05,058 - INFO - Avg. fwd time: 48.1215 / Avg. bwd time: 61.2578 / Avg. batch time: 2061.8941 (ms) / GPU bubble ratio: 57.56%
[rank3]:2025-10-23 18:28:53,108 - INFO - Avg. fwd time: 76.3929 / Avg. bwd time: 135.5964 / Avg. batch time: 1746.1048 (ms) / GPU bubble ratio: 2.87%
[rank2]:2025-10-23 18:28:53,171 - INFO - Avg. fwd time: 34.9031 / Avg. bwd time: 55.1923 / Avg. batch time: 1838.3233 (ms) / GPU bubble ratio: 60.79%
[rank1]:2025-10-23 18:28:53,246 - INFO - Avg. fwd time: 55.0309 / Avg. bwd time: 74.6483 / Avg. batch time: 1961.6550 (ms) / GPU bubble ratio: 47.11%
[rank0]:2025-10-23 18:28:53,316 - INFO - Avg. fwd time: 48.1053 / Avg. bwd time: 61.2571 / Avg. batch time: 2061.7728 (ms) / GPU bubble ratio: 57.57%
[rank0]:2025-10-23 18:31:22,668 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-23 18:31:39,505 - INFO -  step: 300  loss: -8.0000  grad_norm:  0.2884  memory: 16.10GiB(33.90%)  tps: 1,947  tflops: 15.22  mfu: 4.88%
[rank3]:2025-10-23 18:31:39,518 - INFO -  step: 300  loss:  1.8620  grad_norm:  0.2884  memory: 38.93GiB(81.95%)  tps: 1,947  tflops: 15.22  mfu: 4.88%
[rank1]:2025-10-23 18:31:39,510 - INFO -  step: 300  loss: -8.0000  grad_norm:  0.2884  memory: 20.03GiB(42.17%)  tps: 1,947  tflops: 15.22  mfu: 4.88%
[rank0]:2025-10-23 18:31:39,523 - INFO -  step: 300  loss: -8.0000  grad_norm:  0.2884  memory: 20.89GiB(43.97%)  tps: 1,947  tflops: 15.22  mfu: 4.88%
[rank3]:2025-10-23 18:31:39,770 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_gpipe_nofreeze_dm1/pipeline_schedule/251023_1831_real_step300_rank3.svg
[rank3]:> Batch Time: 2009.50 ms, GPU Bubble Ratio: 56.60%, 47.98%, 64.52%, 15.62%
[rank2]:2025-10-23 18:31:41,626 - INFO - Avg. fwd time: 34.9035 / Avg. bwd time: 55.1943 / Avg. batch time: 1838.2660 (ms) / GPU bubble ratio: 60.79%
[rank3]:2025-10-23 18:31:41,565 - INFO - Avg. fwd time: 76.3806 / Avg. bwd time: 135.5936 / Avg. batch time: 1746.0118 (ms) / GPU bubble ratio: 2.88%
[rank1]:2025-10-23 18:31:41,710 - INFO - Avg. fwd time: 55.0495 / Avg. bwd time: 74.6185 / Avg. batch time: 1961.6044 (ms) / GPU bubble ratio: 47.12%
[rank0]:2025-10-23 18:31:41,779 - INFO - Avg. fwd time: 48.0928 / Avg. bwd time: 61.2465 / Avg. batch time: 2061.7194 (ms) / GPU bubble ratio: 57.57%
[rank3]:2025-10-23 18:34:29,674 - INFO - Avg. fwd time: 76.3656 / Avg. bwd time: 135.5916 / Avg. batch time: 1745.8769 (ms) / GPU bubble ratio: 2.88%
[rank2]:2025-10-23 18:34:29,734 - INFO - Avg. fwd time: 34.9050 / Avg. bwd time: 55.1989 / Avg. batch time: 1838.1133 (ms) / GPU bubble ratio: 60.78%
[rank1]:2025-10-23 18:34:29,816 - INFO - Avg. fwd time: 55.0718 / Avg. bwd time: 74.5779 / Avg. batch time: 1961.4510 (ms) / GPU bubble ratio: 47.12%
[rank0]:2025-10-23 18:34:29,882 - INFO - Avg. fwd time: 48.0891 / Avg. bwd time: 61.2318 / Avg. batch time: 2061.5725 (ms) / GPU bubble ratio: 57.58%
[rank3]:2025-10-23 18:37:16,179 - INFO -  step: 320  loss:  1.9289  grad_norm:  0.3345  memory: 38.93GiB(81.95%)  tps: 1,947  tflops: 15.22  mfu: 4.88%
[rank0]:2025-10-23 18:37:16,184 - INFO -  step: 320  loss: -8.0000  grad_norm:  0.3345  memory: 20.89GiB(43.97%)  tps: 1,947  tflops: 15.22  mfu: 4.88%
[rank1]:2025-10-23 18:37:16,171 - INFO -  step: 320  loss: -8.0000  grad_norm:  0.3345  memory: 20.03GiB(42.17%)  tps: 1,947  tflops: 15.22  mfu: 4.88%
[rank2]:2025-10-23 18:37:16,167 - INFO -  step: 320  loss: -8.0000  grad_norm:  0.3345  memory: 16.10GiB(33.90%)  tps: 1,947  tflops: 15.22  mfu: 4.88%
[rank3]:2025-10-23 18:37:18,092 - INFO - Avg. fwd time: 76.3681 / Avg. bwd time: 135.5959 / Avg. batch time: 1745.9138 (ms) / GPU bubble ratio: 2.88%
[rank2]:2025-10-23 18:37:18,156 - INFO - Avg. fwd time: 34.9047 / Avg. bwd time: 55.1961 / Avg. batch time: 1838.1371 (ms) / GPU bubble ratio: 60.79%
[rank1]:2025-10-23 18:37:18,242 - INFO - Avg. fwd time: 55.0704 / Avg. bwd time: 74.5659 / Avg. batch time: 1961.4670 (ms) / GPU bubble ratio: 47.13%
[rank0]:2025-10-23 18:37:18,310 - INFO - Avg. fwd time: 48.0758 / Avg. bwd time: 61.2246 / Avg. batch time: 2061.5452 (ms) / GPU bubble ratio: 57.59%
[rank3]:2025-10-23 18:40:07,080 - INFO - Avg. fwd time: 76.3909 / Avg. bwd time: 135.6086 / Avg. batch time: 1746.1502 (ms) / GPU bubble ratio: 2.87%
[rank2]:2025-10-23 18:40:07,141 - INFO - Avg. fwd time: 34.9054 / Avg. bwd time: 55.1983 / Avg. batch time: 1838.3590 (ms) / GPU bubble ratio: 60.79%
[rank1]:2025-10-23 18:40:07,215 - INFO - Avg. fwd time: 55.0664 / Avg. bwd time: 74.5643 / Avg. batch time: 1961.6819 (ms) / GPU bubble ratio: 47.13%
[rank0]:2025-10-23 18:40:07,285 - INFO - Avg. fwd time: 48.0701 / Avg. bwd time: 61.2353 / Avg. batch time: 2061.7347 (ms) / GPU bubble ratio: 57.59%
[rank1]:2025-10-23 18:42:53,756 - INFO -  step: 340  loss: -8.0000  grad_norm:  0.3851  memory: 20.03GiB(42.17%)  tps: 1,941  tflops: 15.18  mfu: 4.86%
[rank0]:2025-10-23 18:42:53,771 - INFO -  step: 340  loss: -8.0000  grad_norm:  0.3851  memory: 20.89GiB(43.97%)  tps: 1,941  tflops: 15.18  mfu: 4.86%
[rank2]:2025-10-23 18:42:53,751 - INFO -  step: 340  loss: -8.0000  grad_norm:  0.3851  memory: 16.10GiB(33.90%)  tps: 1,941  tflops: 15.18  mfu: 4.86%
[rank3]:2025-10-23 18:42:53,763 - INFO -  step: 340  loss:  1.8507  grad_norm:  0.3851  memory: 38.93GiB(81.95%)  tps: 1,941  tflops: 15.18  mfu: 4.86%
[rank3]:2025-10-23 18:42:55,693 - INFO - Avg. fwd time: 76.3912 / Avg. bwd time: 135.6237 / Avg. batch time: 1746.2624 (ms) / GPU bubble ratio: 2.87%
[rank2]:2025-10-23 18:42:55,753 - INFO - Avg. fwd time: 34.9096 / Avg. bwd time: 55.2053 / Avg. batch time: 1838.4551 (ms) / GPU bubble ratio: 60.79%
[rank1]:2025-10-23 18:42:55,834 - INFO - Avg. fwd time: 55.0658 / Avg. bwd time: 74.5364 / Avg. batch time: 1961.7581 (ms) / GPU bubble ratio: 47.15%
[rank0]:2025-10-23 18:42:55,900 - INFO - Avg. fwd time: 48.0663 / Avg. bwd time: 61.2333 / Avg. batch time: 2061.7766 (ms) / GPU bubble ratio: 57.59%
[rank0]:2025-10-23 18:45:25,020 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-23 18:45:43,708 - INFO - Avg. fwd time: 76.3638 / Avg. bwd time: 135.6272 / Avg. batch time: 1746.1042 (ms) / GPU bubble ratio: 2.87%
[rank2]:2025-10-23 18:45:43,769 - INFO - Avg. fwd time: 34.9127 / Avg. bwd time: 55.2141 / Avg. batch time: 1838.3021 (ms) / GPU bubble ratio: 60.78%
[rank1]:2025-10-23 18:45:43,851 - INFO - Avg. fwd time: 55.0778 / Avg. bwd time: 74.5039 / Avg. batch time: 1961.5946 (ms) / GPU bubble ratio: 47.15%
[rank0]:2025-10-23 18:45:43,917 - INFO - Avg. fwd time: 48.0596 / Avg. bwd time: 61.2193 / Avg. batch time: 2061.5994 (ms) / GPU bubble ratio: 57.59%
[rank2]:2025-10-23 18:48:30,052 - INFO -  step: 360  loss: -8.0000  grad_norm:  0.3235  memory: 16.10GiB(33.90%)  tps: 1,949  tflops: 15.23  mfu: 4.88%
[rank3]:2025-10-23 18:48:30,064 - INFO -  step: 360  loss:  1.8828  grad_norm:  0.3235  memory: 38.93GiB(81.95%)  tps: 1,949  tflops: 15.23  mfu: 4.88%
[rank1]:2025-10-23 18:48:30,055 - INFO -  step: 360  loss: -8.0000  grad_norm:  0.3235  memory: 20.03GiB(42.17%)  tps: 1,949  tflops: 15.23  mfu: 4.88%
[rank0]:2025-10-23 18:48:30,076 - INFO -  step: 360  loss: -8.0000  grad_norm:  0.3235  memory: 20.89GiB(43.97%)  tps: 1,949  tflops: 15.23  mfu: 4.88%
[rank2]:2025-10-23 18:48:32,049 - INFO - Avg. fwd time: 34.9136 / Avg. bwd time: 55.2176 / Avg. batch time: 1838.2189 (ms) / GPU bubble ratio: 60.77%
[rank3]:2025-10-23 18:48:31,985 - INFO - Avg. fwd time: 76.3471 / Avg. bwd time: 135.6283 / Avg. batch time: 1746.0104 (ms) / GPU bubble ratio: 2.88%
[rank1]:2025-10-23 18:48:32,135 - INFO - Avg. fwd time: 55.0947 / Avg. bwd time: 74.4742 / Avg. batch time: 1961.5068 (ms) / GPU bubble ratio: 47.16%
[rank0]:2025-10-23 18:48:32,204 - INFO - Avg. fwd time: 48.0557 / Avg. bwd time: 61.2121 / Avg. batch time: 2061.5135 (ms) / GPU bubble ratio: 57.60%
[rank3]:2025-10-23 18:51:20,023 - INFO - Avg. fwd time: 76.3337 / Avg. bwd time: 135.6220 / Avg. batch time: 1745.8656 (ms) / GPU bubble ratio: 2.88%
[rank2]:2025-10-23 18:51:20,084 - INFO - Avg. fwd time: 34.9100 / Avg. bwd time: 55.2188 / Avg. batch time: 1838.0726 (ms) / GPU bubble ratio: 60.77%
[rank1]:2025-10-23 18:51:20,167 - INFO - Avg. fwd time: 55.1245 / Avg. bwd time: 74.4428 / Avg. batch time: 1961.3584 (ms) / GPU bubble ratio: 47.15%
[rank0]:2025-10-23 18:51:20,232 - INFO - Avg. fwd time: 48.0517 / Avg. bwd time: 61.2010 / Avg. batch time: 2061.3658 (ms) / GPU bubble ratio: 57.60%
[rank2]:2025-10-23 18:54:06,102 - INFO -  step: 380  loss: -8.0000  grad_norm:  0.3000  memory: 16.10GiB(33.90%)  tps: 1,950  tflops: 15.25  mfu: 4.89%
[rank1]:2025-10-23 18:54:06,106 - INFO -  step: 380  loss: -8.0000  grad_norm:  0.3000  memory: 20.03GiB(42.17%)  tps: 1,950  tflops: 15.25  mfu: 4.89%
[rank3]:2025-10-23 18:54:06,114 - INFO -  step: 380  loss:  1.7896  grad_norm:  0.3000  memory: 38.93GiB(81.95%)  tps: 1,950  tflops: 15.25  mfu: 4.89%
[rank0]:2025-10-23 18:54:06,121 - INFO -  step: 380  loss: -8.0000  grad_norm:  0.3000  memory: 20.89GiB(43.97%)  tps: 1,950  tflops: 15.25  mfu: 4.89%
[rank3]:2025-10-23 18:54:08,029 - INFO - Avg. fwd time: 76.3287 / Avg. bwd time: 135.6097 / Avg. batch time: 1745.7189 (ms) / GPU bubble ratio: 2.88%
[rank2]:2025-10-23 18:54:08,096 - INFO - Avg. fwd time: 34.9097 / Avg. bwd time: 55.2242 / Avg. batch time: 1837.9376 (ms) / GPU bubble ratio: 60.77%
[rank1]:2025-10-23 18:54:08,174 - INFO - Avg. fwd time: 55.1395 / Avg. bwd time: 74.4082 / Avg. batch time: 1961.2074 (ms) / GPU bubble ratio: 47.16%
[rank0]:2025-10-23 18:54:08,243 - INFO - Avg. fwd time: 48.0422 / Avg. bwd time: 61.1818 / Avg. batch time: 2061.2098 (ms) / GPU bubble ratio: 57.61%
[rank3]:2025-10-23 18:56:56,045 - INFO - Avg. fwd time: 76.3310 / Avg. bwd time: 135.5973 / Avg. batch time: 1745.6008 (ms) / GPU bubble ratio: 2.87%
[rank2]:2025-10-23 18:56:56,107 - INFO - Avg. fwd time: 34.9092 / Avg. bwd time: 55.2410 / Avg. batch time: 1837.8427 (ms) / GPU bubble ratio: 60.76%
[rank1]:2025-10-23 18:56:56,187 - INFO - Avg. fwd time: 55.1505 / Avg. bwd time: 74.3883 / Avg. batch time: 1961.0957 (ms) / GPU bubble ratio: 47.16%
[rank0]:2025-10-23 18:56:56,257 - INFO - Avg. fwd time: 48.0407 / Avg. bwd time: 61.1812 / Avg. batch time: 2061.0837 (ms) / GPU bubble ratio: 57.61%
[rank0]:2025-10-23 18:59:25,471 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-23 18:59:42,290 - INFO -  step: 400  loss:  1.8071  grad_norm:  0.3036  memory: 38.93GiB(81.95%)  tps: 1,949  tflops: 15.24  mfu: 4.88%
[rank0]:2025-10-23 18:59:42,297 - INFO -  step: 400  loss: -8.0000  grad_norm:  0.3036  memory: 20.89GiB(43.97%)  tps: 1,949  tflops: 15.24  mfu: 4.88%
[rank2]:2025-10-23 18:59:42,277 - INFO -  step: 400  loss: -8.0000  grad_norm:  0.3036  memory: 16.10GiB(33.90%)  tps: 1,949  tflops: 15.24  mfu: 4.88%
[rank1]:2025-10-23 18:59:42,283 - INFO -  step: 400  loss: -8.0000  grad_norm:  0.3036  memory: 20.03GiB(42.17%)  tps: 1,949  tflops: 15.24  mfu: 4.88%
[rank3]:2025-10-23 18:59:42,553 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_gpipe_nofreeze_dm1/pipeline_schedule/251023_1859_real_step400_rank3.svg
[rank3]:> Batch Time: 2007.72 ms, GPU Bubble Ratio: 56.69%, 48.11%, 64.47%, 15.65%
[rank3]:2025-10-23 18:59:44,350 - INFO - Avg. fwd time: 76.3140 / Avg. bwd time: 135.6024 / Avg. batch time: 1745.5092 (ms) / GPU bubble ratio: 2.87%
[rank2]:2025-10-23 18:59:44,411 - INFO - Avg. fwd time: 34.9116 / Avg. bwd time: 55.2516 / Avg. batch time: 1837.8068 (ms) / GPU bubble ratio: 60.75%
[rank1]:2025-10-23 18:59:44,507 - INFO - Avg. fwd time: 55.1604 / Avg. bwd time: 74.3580 / Avg. batch time: 1961.0535 (ms) / GPU bubble ratio: 47.16%
[rank0]:2025-10-23 18:59:44,572 - INFO - Avg. fwd time: 48.0330 / Avg. bwd time: 61.1726 / Avg. batch time: 2061.0322 (ms) / GPU bubble ratio: 57.61%
[rank3]:2025-10-23 19:02:32,373 - INFO - Avg. fwd time: 76.3008 / Avg. bwd time: 135.6026 / Avg. batch time: 1745.4238 (ms) / GPU bubble ratio: 2.88%
[rank2]:2025-10-23 19:02:32,434 - INFO - Avg. fwd time: 34.9108 / Avg. bwd time: 55.2573 / Avg. batch time: 1837.7271 (ms) / GPU bubble ratio: 60.75%
[rank1]:2025-10-23 19:02:32,517 - INFO - Avg. fwd time: 55.1734 / Avg. bwd time: 74.3283 / Avg. batch time: 1960.9564 (ms) / GPU bubble ratio: 47.17%
[rank0]:2025-10-23 19:02:32,584 - INFO - Avg. fwd time: 48.0280 / Avg. bwd time: 61.1670 / Avg. batch time: 2060.9199 (ms) / GPU bubble ratio: 57.61%
[rank2]:2025-10-23 19:05:18,449 - INFO -  step: 420  loss: -8.0000  grad_norm:  0.2994  memory: 16.10GiB(33.90%)  tps: 1,949  tflops: 15.24  mfu: 4.88%
[rank0]:2025-10-23 19:05:18,463 - INFO -  step: 420  loss: -8.0000  grad_norm:  0.2994  memory: 20.89GiB(43.97%)  tps: 1,950  tflops: 15.24  mfu: 4.88%
[rank1]:2025-10-23 19:05:18,456 - INFO -  step: 420  loss: -8.0000  grad_norm:  0.2994  memory: 20.03GiB(42.17%)  tps: 1,949  tflops: 15.24  mfu: 4.88%
[rank3]:2025-10-23 19:05:18,461 - INFO -  step: 420  loss:  1.7293  grad_norm:  0.2994  memory: 38.93GiB(81.95%)  tps: 1,949  tflops: 15.24  mfu: 4.88%
[rank3]:2025-10-23 19:05:20,366 - INFO - Avg. fwd time: 76.2835 / Avg. bwd time: 135.5986 / Avg. batch time: 1745.2875 (ms) / GPU bubble ratio: 2.88%
[rank2]:2025-10-23 19:05:20,429 - INFO - Avg. fwd time: 34.9128 / Avg. bwd time: 55.2627 / Avg. batch time: 1837.6113 (ms) / GPU bubble ratio: 60.74%
[rank1]:2025-10-23 19:05:20,503 - INFO - Avg. fwd time: 55.1828 / Avg. bwd time: 74.2896 / Avg. batch time: 1960.8120 (ms) / GPU bubble ratio: 47.18%
[rank0]:2025-10-23 19:05:20,574 - INFO - Avg. fwd time: 48.0294 / Avg. bwd time: 61.1499 / Avg. batch time: 2060.8020 (ms) / GPU bubble ratio: 57.62%
[rank3]:2025-10-23 19:08:08,423 - INFO - Avg. fwd time: 76.2810 / Avg. bwd time: 135.5895 / Avg. batch time: 1745.1891 (ms) / GPU bubble ratio: 2.88%
[rank2]:2025-10-23 19:08:08,487 - INFO - Avg. fwd time: 34.9119 / Avg. bwd time: 55.2685 / Avg. batch time: 1837.5212 (ms) / GPU bubble ratio: 60.74%
[rank1]:2025-10-23 19:08:08,564 - INFO - Avg. fwd time: 55.1922 / Avg. bwd time: 74.2526 / Avg. batch time: 1960.7091 (ms) / GPU bubble ratio: 47.18%
[rank0]:2025-10-23 19:08:08,630 - INFO - Avg. fwd time: 48.0295 / Avg. bwd time: 61.1387 / Avg. batch time: 2060.7108 (ms) / GPU bubble ratio: 57.62%
[rank2]:2025-10-23 19:10:54,629 - INFO -  step: 440  loss: -8.0000  grad_norm:  0.2909  memory: 16.10GiB(33.90%)  tps: 1,949  tflops: 15.24  mfu: 4.88%
[rank1]:2025-10-23 19:10:54,633 - INFO -  step: 440  loss: -8.0000  grad_norm:  0.2909  memory: 20.03GiB(42.17%)  tps: 1,949  tflops: 15.24  mfu: 4.88%
[rank3]:2025-10-23 19:10:54,641 - INFO -  step: 440  loss:  1.7002  grad_norm:  0.2909  memory: 38.93GiB(81.95%)  tps: 1,949  tflops: 15.24  mfu: 4.88%
[rank0]:2025-10-23 19:10:54,648 - INFO -  step: 440  loss: -8.0000  grad_norm:  0.2909  memory: 20.89GiB(43.97%)  tps: 1,949  tflops: 15.24  mfu: 4.88%
[rank3]:2025-10-23 19:10:56,562 - INFO - Avg. fwd time: 76.2794 / Avg. bwd time: 135.5815 / Avg. batch time: 1745.1076 (ms) / GPU bubble ratio: 2.88%
[rank2]:2025-10-23 19:10:56,624 - INFO - Avg. fwd time: 34.9117 / Avg. bwd time: 55.2708 / Avg. batch time: 1837.4414 (ms) / GPU bubble ratio: 60.74%
[rank1]:2025-10-23 19:10:56,703 - INFO - Avg. fwd time: 55.2056 / Avg. bwd time: 74.2325 / Avg. batch time: 1960.6324 (ms) / GPU bubble ratio: 47.19%
[rank0]:2025-10-23 19:10:56,769 - INFO - Avg. fwd time: 48.0251 / Avg. bwd time: 61.1307 / Avg. batch time: 2060.6371 (ms) / GPU bubble ratio: 57.62%
[rank0]:2025-10-23 19:13:26,052 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-23 19:13:44,803 - INFO - Avg. fwd time: 76.2814 / Avg. bwd time: 135.5894 / Avg. batch time: 1745.1267 (ms) / GPU bubble ratio: 2.87%
[rank2]:2025-10-23 19:13:44,864 - INFO - Avg. fwd time: 34.9183 / Avg. bwd time: 55.2753 / Avg. batch time: 1837.4607 (ms) / GPU bubble ratio: 60.73%
[rank1]:2025-10-23 19:13:44,948 - INFO - Avg. fwd time: 55.1926 / Avg. bwd time: 74.2264 / Avg. batch time: 1960.6145 (ms) / GPU bubble ratio: 47.19%
[rank0]:2025-10-23 19:13:45,015 - INFO - Avg. fwd time: 48.0187 / Avg. bwd time: 61.1417 / Avg. batch time: 2060.6002 (ms) / GPU bubble ratio: 57.62%
[rank0]:2025-10-23 19:16:31,093 - INFO -  step: 460  loss: -8.0000  grad_norm:  0.2689  memory: 20.89GiB(43.97%)  tps: 1,948  tflops: 15.23  mfu: 4.88%
[rank1]:2025-10-23 19:16:31,072 - INFO -  step: 460  loss: -8.0000  grad_norm:  0.2689  memory: 20.03GiB(42.17%)  tps: 1,948  tflops: 15.23  mfu: 4.88%
[rank3]:2025-10-23 19:16:31,081 - INFO -  step: 460  loss:  1.7277  grad_norm:  0.2689  memory: 38.93GiB(81.95%)  tps: 1,948  tflops: 15.23  mfu: 4.88%
[rank2]:2025-10-23 19:16:31,068 - INFO -  step: 460  loss: -8.0000  grad_norm:  0.2689  memory: 16.10GiB(33.90%)  tps: 1,948  tflops: 15.23  mfu: 4.88%
[rank3]:2025-10-23 19:16:32,998 - INFO - Avg. fwd time: 76.2688 / Avg. bwd time: 135.5978 / Avg. batch time: 1745.0970 (ms) / GPU bubble ratio: 2.87%
[rank2]:2025-10-23 19:16:33,059 - INFO - Avg. fwd time: 34.9237 / Avg. bwd time: 55.2787 / Avg. batch time: 1837.4302 (ms) / GPU bubble ratio: 60.73%
[rank1]:2025-10-23 19:16:33,144 - INFO - Avg. fwd time: 55.1971 / Avg. bwd time: 74.2109 / Avg. batch time: 1960.5608 (ms) / GPU bubble ratio: 47.20%
[rank0]:2025-10-23 19:16:33,210 - INFO - Avg. fwd time: 48.0135 / Avg. bwd time: 61.1453 / Avg. batch time: 2060.5391 (ms) / GPU bubble ratio: 57.62%
[rank3]:2025-10-23 19:19:20,909 - INFO - Avg. fwd time: 76.2550 / Avg. bwd time: 135.5952 / Avg. batch time: 1744.9688 (ms) / GPU bubble ratio: 2.87%
[rank2]:2025-10-23 19:19:20,970 - INFO - Avg. fwd time: 34.9276 / Avg. bwd time: 55.2819 / Avg. batch time: 1837.3151 (ms) / GPU bubble ratio: 60.72%
[rank1]:2025-10-23 19:19:21,057 - INFO - Avg. fwd time: 55.2082 / Avg. bwd time: 74.1875 / Avg. batch time: 1960.4541 (ms) / GPU bubble ratio: 47.20%
[rank0]:2025-10-23 19:19:21,124 - INFO - Avg. fwd time: 48.0115 / Avg. bwd time: 61.1380 / Avg. batch time: 2060.4238 (ms) / GPU bubble ratio: 57.62%
[rank1]:2025-10-23 19:22:07,251 - INFO -  step: 480  loss: -8.0000  grad_norm:  0.3315  memory: 20.03GiB(42.17%)  tps: 1,949  tflops: 15.24  mfu: 4.88%
[rank3]:2025-10-23 19:22:07,260 - INFO -  step: 480  loss:  1.7640  grad_norm:  0.3315  memory: 38.93GiB(81.95%)  tps: 1,949  tflops: 15.24  mfu: 4.88%
[rank2]:2025-10-23 19:22:07,248 - INFO -  step: 480  loss: -8.0000  grad_norm:  0.3315  memory: 16.10GiB(33.90%)  tps: 1,949  tflops: 15.24  mfu: 4.88%
[rank0]:2025-10-23 19:22:07,271 - INFO -  step: 480  loss: -8.0000  grad_norm:  0.3315  memory: 20.89GiB(43.97%)  tps: 1,949  tflops: 15.24  mfu: 4.88%
[rank3]:2025-10-23 19:22:09,194 - INFO - Avg. fwd time: 76.2474 / Avg. bwd time: 135.5993 / Avg. batch time: 1744.9256 (ms) / GPU bubble ratio: 2.87%
[rank2]:2025-10-23 19:22:09,256 - INFO - Avg. fwd time: 34.9314 / Avg. bwd time: 55.2836 / Avg. batch time: 1837.2866 (ms) / GPU bubble ratio: 60.72%
[rank1]:2025-10-23 19:22:09,336 - INFO - Avg. fwd time: 55.2011 / Avg. bwd time: 74.1833 / Avg. batch time: 1960.4215 (ms) / GPU bubble ratio: 47.20%
[rank0]:2025-10-23 19:22:09,406 - INFO - Avg. fwd time: 48.0073 / Avg. bwd time: 61.1415 / Avg. batch time: 2060.4010 (ms) / GPU bubble ratio: 57.62%
[rank3]:2025-10-23 19:24:57,445 - INFO - Avg. fwd time: 76.2438 / Avg. bwd time: 135.6098 / Avg. batch time: 1744.9466 (ms) / GPU bubble ratio: 2.87%
[rank2]:2025-10-23 19:24:57,511 - INFO - Avg. fwd time: 34.9390 / Avg. bwd time: 55.2875 / Avg. batch time: 1837.3160 (ms) / GPU bubble ratio: 60.71%
[rank0]:2025-10-23 19:24:57,657 - INFO - Avg. fwd time: 48.0034 / Avg. bwd time: 61.1575 / Avg. batch time: 2060.3765 (ms) / GPU bubble ratio: 57.62%
[rank1]:2025-10-23 19:24:57,588 - INFO - Avg. fwd time: 55.1791 / Avg. bwd time: 74.1906 / Avg. batch time: 1960.4154 (ms) / GPU bubble ratio: 47.21%
[rank0]:2025-10-23 19:27:26,766 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-23 19:27:43,578 - INFO -  step: 500  loss: -8.0000  grad_norm:  0.3037  memory: 20.03GiB(42.17%)  tps: 1,949  tflops: 15.23  mfu: 4.88%
[rank1]:2025-10-23 19:27:43,578 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-23 19:27:43,586 - INFO -  step: 500  loss:  1.7668  grad_norm:  0.3037  memory: 38.93GiB(81.95%)  tps: 1,949  tflops: 15.23  mfu: 4.88%
[rank3]:2025-10-23 19:27:43,587 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-23 19:27:43,574 - INFO -  step: 500  loss: -8.0000  grad_norm:  0.3037  memory: 16.10GiB(33.90%)  tps: 1,949  tflops: 15.23  mfu: 4.88%
[rank2]:2025-10-23 19:27:43,574 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-23 19:27:43,591 - INFO -  step: 500  loss: -8.0000  grad_norm:  0.3037  memory: 20.89GiB(43.97%)  tps: 1,949  tflops: 15.23  mfu: 4.88%
[rank0]:2025-10-23 19:27:43,592 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-23 19:27:43,592 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank2]:2025-10-23 19:27:45,496 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 1.92 seconds.
[rank1]:2025-10-23 19:27:46,370 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 2.79 seconds.
[rank0]:2025-10-23 19:27:47,427 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-23 19:27:47,435 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.84 seconds.
[rank3]:2025-10-23 19:27:47,988 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 4.40 seconds.
[rank3]:2025-10-23 19:27:48,400 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_gpipe_nofreeze_dm1/pipeline_schedule/251023_1927_real_step500_rank3.svg
[rank3]:> Batch Time: 2006.97 ms, GPU Bubble Ratio: 56.74%, 48.22%, 64.43%, 15.64%
[rank3]:2025-10-23 19:27:50,392 - INFO - Avg. fwd time: 76.2226 / Avg. bwd time: 135.6201 / Avg. batch time: 1744.9063 (ms) / GPU bubble ratio: 2.87%
[rank2]:2025-10-23 19:27:50,456 - INFO - Avg. fwd time: 34.9430 / Avg. bwd time: 55.2908 / Avg. batch time: 1837.3383 (ms) / GPU bubble ratio: 60.71%
[rank1]:2025-10-23 19:27:50,544 - INFO - Avg. fwd time: 55.1996 / Avg. bwd time: 74.1723 / Avg. batch time: 1960.4434 (ms) / GPU bubble ratio: 47.21%
[rank0]:2025-10-23 19:27:50,618 - INFO - Avg. fwd time: 48.0061 / Avg. bwd time: 61.1520 / Avg. batch time: 2060.4096 (ms) / GPU bubble ratio: 57.62%
[rank3]:2025-10-23 19:30:38,295 - INFO - Avg. fwd time: 76.2179 / Avg. bwd time: 135.6123 / Avg. batch time: 1744.7973 (ms) / GPU bubble ratio: 2.87%
[rank2]:2025-10-23 19:30:38,374 - INFO - Avg. fwd time: 34.9439 / Avg. bwd time: 55.2947 / Avg. batch time: 1837.2363 (ms) / GPU bubble ratio: 60.71%
[rank1]:2025-10-23 19:30:38,471 - INFO - Avg. fwd time: 55.2000 / Avg. bwd time: 74.1495 / Avg. batch time: 1960.3284 (ms) / GPU bubble ratio: 47.21%
[rank0]:2025-10-23 19:30:38,545 - INFO - Avg. fwd time: 47.9978 / Avg. bwd time: 61.1439 / Avg. batch time: 2060.2867 (ms) / GPU bubble ratio: 57.62%
[rank1]:2025-10-23 19:33:24,654 - INFO -  step: 520  loss: -8.0000  grad_norm:  0.2958  memory: 20.03GiB(42.17%)  tps: 1,921  tflops: 15.02  mfu: 4.81%
[rank3]:2025-10-23 19:33:24,661 - INFO -  step: 520  loss:  1.9043  grad_norm:  0.2958  memory: 38.93GiB(81.95%)  tps: 1,921  tflops: 15.02  mfu: 4.81%
[rank2]:2025-10-23 19:33:24,649 - INFO -  step: 520  loss: -8.0000  grad_norm:  0.2958  memory: 16.10GiB(33.90%)  tps: 1,921  tflops: 15.02  mfu: 4.81%
[rank0]:2025-10-23 19:33:24,667 - INFO -  step: 520  loss: -8.0000  grad_norm:  0.2958  memory: 20.89GiB(43.97%)  tps: 1,921  tflops: 15.02  mfu: 4.81%
[rank3]:2025-10-23 19:33:26,569 - INFO - Avg. fwd time: 76.2140 / Avg. bwd time: 135.6075 / Avg. batch time: 1744.7285 (ms) / GPU bubble ratio: 2.87%
[rank2]:2025-10-23 19:33:26,633 - INFO - Avg. fwd time: 34.9451 / Avg. bwd time: 55.2956 / Avg. batch time: 1837.1746 (ms) / GPU bubble ratio: 60.70%
[rank1]:2025-10-23 19:33:26,722 - INFO - Avg. fwd time: 55.2004 / Avg. bwd time: 74.1390 / Avg. batch time: 1960.2727 (ms) / GPU bubble ratio: 47.22%
[rank0]:2025-10-23 19:33:26,789 - INFO - Avg. fwd time: 47.9957 / Avg. bwd time: 61.1398 / Avg. batch time: 2060.2376 (ms) / GPU bubble ratio: 57.62%
[rank3]:2025-10-23 19:36:14,640 - INFO - Avg. fwd time: 76.2079 / Avg. bwd time: 135.6051 / Avg. batch time: 1744.6629 (ms) / GPU bubble ratio: 2.87%
[rank2]:2025-10-23 19:36:14,706 - INFO - Avg. fwd time: 34.9457 / Avg. bwd time: 55.2943 / Avg. batch time: 1837.1004 (ms) / GPU bubble ratio: 60.70%
[rank1]:2025-10-23 19:36:14,792 - INFO - Avg. fwd time: 55.2009 / Avg. bwd time: 74.1308 / Avg. batch time: 1960.1957 (ms) / GPU bubble ratio: 47.22%
[rank0]:2025-10-23 19:36:14,859 - INFO - Avg. fwd time: 47.9922 / Avg. bwd time: 61.1356 / Avg. batch time: 2060.1618 (ms) / GPU bubble ratio: 57.62%
[rank3]:2025-10-23 19:39:01,251 - INFO -  step: 540  loss:  1.6804  grad_norm:  0.2991  memory: 38.93GiB(81.95%)  tps: 1,947  tflops: 15.22  mfu: 4.88%
[rank2]:2025-10-23 19:39:01,238 - INFO -  step: 540  loss: -8.0000  grad_norm:  0.2991  memory: 16.10GiB(33.90%)  tps: 1,947  tflops: 15.22  mfu: 4.88%
[rank0]:2025-10-23 19:39:01,261 - INFO -  step: 540  loss: -8.0000  grad_norm:  0.2991  memory: 20.89GiB(43.97%)  tps: 1,947  tflops: 15.22  mfu: 4.88%
[rank1]:2025-10-23 19:39:01,242 - INFO -  step: 540  loss: -8.0000  grad_norm:  0.2991  memory: 20.03GiB(42.17%)  tps: 1,947  tflops: 15.22  mfu: 4.88%
[rank3]:2025-10-23 19:39:03,180 - INFO - Avg. fwd time: 76.2084 / Avg. bwd time: 135.6131 / Avg. batch time: 1744.7118 (ms) / GPU bubble ratio: 2.87%
[rank2]:2025-10-23 19:39:03,249 - INFO - Avg. fwd time: 34.9497 / Avg. bwd time: 55.2989 / Avg. batch time: 1837.1532 (ms) / GPU bubble ratio: 60.70%
[rank1]:2025-10-23 19:39:03,330 - INFO - Avg. fwd time: 55.1900 / Avg. bwd time: 74.1357 / Avg. batch time: 1960.2254 (ms) / GPU bubble ratio: 47.22%
[rank0]:2025-10-23 19:39:03,398 - INFO - Avg. fwd time: 47.9897 / Avg. bwd time: 61.1438 / Avg. batch time: 2060.1915 (ms) / GPU bubble ratio: 57.62%
[rank0]:2025-10-23 19:41:32,734 - INFO - [GC] Peforming periodical GC collection 0.30 seconds
[rank3]:2025-10-23 19:41:51,502 - INFO - Avg. fwd time: 76.1989 / Avg. bwd time: 135.6174 / Avg. batch time: 1744.6586 (ms) / GPU bubble ratio: 2.87%
[rank2]:2025-10-23 19:41:51,569 - INFO - Avg. fwd time: 34.9551 / Avg. bwd time: 55.3001 / Avg. batch time: 1837.0961 (ms) / GPU bubble ratio: 60.70%
[rank1]:2025-10-23 19:41:51,645 - INFO - Avg. fwd time: 55.1910 / Avg. bwd time: 74.1262 / Avg. batch time: 1960.1572 (ms) / GPU bubble ratio: 47.22%
[rank0]:2025-10-23 19:41:51,712 - INFO - Avg. fwd time: 47.9822 / Avg. bwd time: 61.1440 / Avg. batch time: 2060.1021 (ms) / GPU bubble ratio: 57.62%
[rank3]:2025-10-23 19:44:37,565 - INFO -  step: 560  loss:  1.7959  grad_norm:  0.2918  memory: 38.93GiB(81.95%)  tps: 1,949  tflops: 15.23  mfu: 4.88%
[rank0]:2025-10-23 19:44:37,575 - INFO -  step: 560  loss: -8.0000  grad_norm:  0.2918  memory: 20.89GiB(43.97%)  tps: 1,949  tflops: 15.23  mfu: 4.88%
[rank2]:2025-10-23 19:44:37,552 - INFO -  step: 560  loss: -8.0000  grad_norm:  0.2918  memory: 16.10GiB(33.90%)  tps: 1,949  tflops: 15.23  mfu: 4.88%
[rank1]:2025-10-23 19:44:37,556 - INFO -  step: 560  loss: -8.0000  grad_norm:  0.2918  memory: 20.03GiB(42.17%)  tps: 1,949  tflops: 15.23  mfu: 4.88%
[rank3]:2025-10-23 19:44:39,495 - INFO - Avg. fwd time: 76.1822 / Avg. bwd time: 135.6146 / Avg. batch time: 1744.5536 (ms) / GPU bubble ratio: 2.88%
[rank2]:2025-10-23 19:44:39,559 - INFO - Avg. fwd time: 34.9534 / Avg. bwd time: 55.3022 / Avg. batch time: 1836.9879 (ms) / GPU bubble ratio: 60.69%
[rank0]:2025-10-23 19:44:39,710 - INFO - Avg. fwd time: 47.9824 / Avg. bwd time: 61.1288 / Avg. batch time: 2060.0187 (ms) / GPU bubble ratio: 57.63%
[rank1]:2025-10-23 19:44:39,640 - INFO - Avg. fwd time: 55.2194 / Avg. bwd time: 74.1091 / Avg. batch time: 1960.0633 (ms) / GPU bubble ratio: 47.21%
[rank3]:2025-10-23 19:47:27,453 - INFO - Avg. fwd time: 76.1868 / Avg. bwd time: 135.6098 / Avg. batch time: 1744.5063 (ms) / GPU bubble ratio: 2.87%
[rank2]:2025-10-23 19:47:27,516 - INFO - Avg. fwd time: 34.9581 / Avg. bwd time: 55.3059 / Avg. batch time: 1836.9286 (ms) / GPU bubble ratio: 60.69%
[rank1]:2025-10-23 19:47:27,595 - INFO - Avg. fwd time: 55.1918 / Avg. bwd time: 74.1102 / Avg. batch time: 1959.9811 (ms) / GPU bubble ratio: 47.22%
[rank0]:2025-10-23 19:47:27,668 - INFO - Avg. fwd time: 47.9838 / Avg. bwd time: 61.1400 / Avg. batch time: 2059.9326 (ms) / GPU bubble ratio: 57.62%
[rank2]:2025-10-23 19:50:13,453 - INFO -  step: 580  loss: -8.0000  grad_norm:  0.3135  memory: 16.10GiB(33.90%)  tps: 1,951  tflops: 15.25  mfu: 4.89%
[rank1]:2025-10-23 19:50:13,457 - INFO -  step: 580  loss: -8.0000  grad_norm:  0.3135  memory: 20.03GiB(42.17%)  tps: 1,951  tflops: 15.25  mfu: 4.89%
[rank3]:2025-10-23 19:50:13,465 - INFO -  step: 580  loss:  1.7488  grad_norm:  0.3135  memory: 38.93GiB(81.95%)  tps: 1,951  tflops: 15.25  mfu: 4.89%
[rank0]:2025-10-23 19:50:13,469 - INFO -  step: 580  loss: -8.0000  grad_norm:  0.3135  memory: 20.89GiB(43.97%)  tps: 1,951  tflops: 15.25  mfu: 4.89%
[rank3]:2025-10-23 19:50:15,378 - INFO - Avg. fwd time: 76.1731 / Avg. bwd time: 135.6056 / Avg. batch time: 1744.3969 (ms) / GPU bubble ratio: 2.88%
[rank2]:2025-10-23 19:50:15,444 - INFO - Avg. fwd time: 34.9600 / Avg. bwd time: 55.3082 / Avg. batch time: 1836.8141 (ms) / GPU bubble ratio: 60.68%
[rank1]:2025-10-23 19:50:15,523 - INFO - Avg. fwd time: 55.2079 / Avg. bwd time: 74.0970 / Avg. batch time: 1959.8772 (ms) / GPU bubble ratio: 47.22%
[rank0]:2025-10-23 19:50:15,592 - INFO - Avg. fwd time: 47.9849 / Avg. bwd time: 61.1433 / Avg. batch time: 2059.8306 (ms) / GPU bubble ratio: 57.62%
[rank3]:2025-10-23 19:53:03,280 - INFO - Avg. fwd time: 76.1720 / Avg. bwd time: 135.6001 / Avg. batch time: 1744.3242 (ms) / GPU bubble ratio: 2.87%
[rank2]:2025-10-23 19:53:03,343 - INFO - Avg. fwd time: 34.9605 / Avg. bwd time: 55.3071 / Avg. batch time: 1836.7318 (ms) / GPU bubble ratio: 60.68%
[rank1]:2025-10-23 19:53:03,427 - INFO - Avg. fwd time: 55.2032 / Avg. bwd time: 74.0953 / Avg. batch time: 1959.7899 (ms) / GPU bubble ratio: 47.22%
[rank0]:2025-10-23 19:53:03,500 - INFO - Avg. fwd time: 47.9846 / Avg. bwd time: 61.1461 / Avg. batch time: 2059.7458 (ms) / GPU bubble ratio: 57.61%
[rank0]:2025-10-23 19:55:32,466 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-23 19:55:49,212 - INFO -  step: 600  loss: -8.0000  grad_norm:  0.3004  memory: 16.10GiB(33.90%)  tps: 1,952  tflops: 15.26  mfu: 4.89%
[rank1]:2025-10-23 19:55:49,217 - INFO -  step: 600  loss: -8.0000  grad_norm:  0.3004  memory: 20.03GiB(42.17%)  tps: 1,952  tflops: 15.26  mfu: 4.89%
[rank3]:2025-10-23 19:55:49,225 - INFO -  step: 600  loss:  1.6702  grad_norm:  0.3004  memory: 38.93GiB(81.95%)  tps: 1,952  tflops: 15.26  mfu: 4.89%
[rank0]:2025-10-23 19:55:49,230 - INFO -  step: 600  loss: -8.0000  grad_norm:  0.3004  memory: 20.89GiB(43.97%)  tps: 1,952  tflops: 15.26  mfu: 4.89%
[rank3]:2025-10-23 19:55:49,487 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_gpipe_nofreeze_dm1/pipeline_schedule/251023_1955_real_step600_rank3.svg
[rank3]:> Batch Time: 2006.47 ms, GPU Bubble Ratio: 56.73%, 48.27%, 64.41%, 15.65%
[rank3]:2025-10-23 19:55:51,292 - INFO - Avg. fwd time: 76.1708 / Avg. bwd time: 135.5936 / Avg. batch time: 1744.2397 (ms) / GPU bubble ratio: 2.87%
[rank2]:2025-10-23 19:55:51,355 - INFO - Avg. fwd time: 34.9606 / Avg. bwd time: 55.3037 / Avg. batch time: 1836.6697 (ms) / GPU bubble ratio: 60.68%
[rank1]:2025-10-23 19:55:51,438 - INFO - Avg. fwd time: 55.2035 / Avg. bwd time: 74.0908 / Avg. batch time: 1959.7076 (ms) / GPU bubble ratio: 47.22%
[rank0]:2025-10-23 19:55:51,506 - INFO - Avg. fwd time: 47.9841 / Avg. bwd time: 61.1406 / Avg. batch time: 2059.6722 (ms) / GPU bubble ratio: 57.61%
[rank3]:2025-10-23 19:58:39,245 - INFO - Avg. fwd time: 76.1579 / Avg. bwd time: 135.5969 / Avg. batch time: 1744.1686 (ms) / GPU bubble ratio: 2.87%
[rank2]:2025-10-23 19:58:39,308 - INFO - Avg. fwd time: 34.9644 / Avg. bwd time: 55.3054 / Avg. batch time: 1836.6004 (ms) / GPU bubble ratio: 60.68%
[rank1]:2025-10-23 19:58:39,394 - INFO - Avg. fwd time: 55.2081 / Avg. bwd time: 74.0857 / Avg. batch time: 1959.6405 (ms) / GPU bubble ratio: 47.22%
[rank0]:2025-10-23 19:58:39,462 - INFO - Avg. fwd time: 47.9842 / Avg. bwd time: 61.1384 / Avg. batch time: 2059.5991 (ms) / GPU bubble ratio: 57.61%
[rank1]:2025-10-23 20:01:25,529 - INFO -  step: 620  loss: -8.0000  grad_norm:  0.3043  memory: 20.03GiB(42.17%)  tps: 1,949  tflops: 15.23  mfu: 4.88%
[rank2]:2025-10-23 20:01:25,524 - INFO -  step: 620  loss: -8.0000  grad_norm:  0.3043  memory: 16.10GiB(33.90%)  tps: 1,949  tflops: 15.23  mfu: 4.88%
[rank3]:2025-10-23 20:01:25,536 - INFO -  step: 620  loss:  1.7775  grad_norm:  0.3043  memory: 38.93GiB(81.95%)  tps: 1,949  tflops: 15.23  mfu: 4.88%
[rank0]:2025-10-23 20:01:25,539 - INFO -  step: 620  loss: -8.0000  grad_norm:  0.3043  memory: 20.89GiB(43.97%)  tps: 1,949  tflops: 15.23  mfu: 4.88%
[rank3]:2025-10-23 20:01:27,461 - INFO - Avg. fwd time: 76.1501 / Avg. bwd time: 135.6018 / Avg. batch time: 1744.1417 (ms) / GPU bubble ratio: 2.87%
[rank2]:2025-10-23 20:01:27,525 - INFO - Avg. fwd time: 34.9679 / Avg. bwd time: 55.3061 / Avg. batch time: 1836.5718 (ms) / GPU bubble ratio: 60.68%
[rank1]:2025-10-23 20:01:27,608 - INFO - Avg. fwd time: 55.2196 / Avg. bwd time: 74.0871 / Avg. batch time: 1959.6128 (ms) / GPU bubble ratio: 47.21%
[rank0]:2025-10-23 20:01:27,678 - INFO - Avg. fwd time: 47.9876 / Avg. bwd time: 61.1396 / Avg. batch time: 2059.5742 (ms) / GPU bubble ratio: 57.61%
[rank3]:2025-10-23 20:04:15,354 - INFO - Avg. fwd time: 76.1338 / Avg. bwd time: 135.6056 / Avg. batch time: 1744.0578 (ms) / GPU bubble ratio: 2.88%
[rank2]:2025-10-23 20:04:15,418 - INFO - Avg. fwd time: 34.9710 / Avg. bwd time: 55.3066 / Avg. batch time: 1836.4854 (ms) / GPU bubble ratio: 60.67%
[rank1]:2025-10-23 20:04:15,497 - INFO - Avg. fwd time: 55.2332 / Avg. bwd time: 74.0804 / Avg. batch time: 1959.5270 (ms) / GPU bubble ratio: 47.21%
[rank0]:2025-10-23 20:04:15,565 - INFO - Avg. fwd time: 47.9867 / Avg. bwd time: 61.1333 / Avg. batch time: 2059.4823 (ms) / GPU bubble ratio: 57.61%
[rank1]:2025-10-23 20:07:01,274 - INFO -  step: 640  loss: -8.0000  grad_norm:  0.2797  memory: 20.03GiB(42.17%)  tps: 1,952  tflops: 15.26  mfu: 4.89%
[rank2]:2025-10-23 20:07:01,270 - INFO -  step: 640  loss: -8.0000  grad_norm:  0.2797  memory: 16.10GiB(33.90%)  tps: 1,952  tflops: 15.26  mfu: 4.89%
[rank3]:2025-10-23 20:07:01,282 - INFO -  step: 640  loss:  1.6888  grad_norm:  0.2797  memory: 38.93GiB(81.95%)  tps: 1,952  tflops: 15.26  mfu: 4.89%
[rank0]:2025-10-23 20:07:01,294 - INFO -  step: 640  loss: -8.0000  grad_norm:  0.2797  memory: 20.89GiB(43.97%)  tps: 1,952  tflops: 15.26  mfu: 4.89%
[rank3]:2025-10-23 20:07:03,210 - INFO - Avg. fwd time: 76.1182 / Avg. bwd time: 135.6064 / Avg. batch time: 1743.9558 (ms) / GPU bubble ratio: 2.88%
[rank2]:2025-10-23 20:07:03,278 - INFO - Avg. fwd time: 34.9717 / Avg. bwd time: 55.3044 / Avg. batch time: 1836.3818 (ms) / GPU bubble ratio: 60.67%
[rank1]:2025-10-23 20:07:03,360 - INFO - Avg. fwd time: 55.2508 / Avg. bwd time: 74.0677 / Avg. batch time: 1959.4234 (ms) / GPU bubble ratio: 47.20%
[rank0]:2025-10-23 20:07:03,433 - INFO - Avg. fwd time: 47.9899 / Avg. bwd time: 61.1233 / Avg. batch time: 2059.3860 (ms) / GPU bubble ratio: 57.61%
[rank0]:2025-10-23 20:09:32,420 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-23 20:09:51,100 - INFO - Avg. fwd time: 76.1054 / Avg. bwd time: 135.6062 / Avg. batch time: 1743.8624 (ms) / GPU bubble ratio: 2.88%
[rank2]:2025-10-23 20:09:51,165 - INFO - Avg. fwd time: 34.9721 / Avg. bwd time: 55.3047 / Avg. batch time: 1836.2874 (ms) / GPU bubble ratio: 60.67%
[rank1]:2025-10-23 20:09:51,246 - INFO - Avg. fwd time: 55.2606 / Avg. bwd time: 74.0578 / Avg. batch time: 1959.3365 (ms) / GPU bubble ratio: 47.20%
[rank0]:2025-10-23 20:09:51,315 - INFO - Avg. fwd time: 47.9907 / Avg. bwd time: 61.1176 / Avg. batch time: 2059.3009 (ms) / GPU bubble ratio: 57.61%
[rank2]:2025-10-23 20:12:37,172 - INFO -  step: 660  loss: -8.0000  grad_norm:  0.3060  memory: 16.10GiB(33.90%)  tps: 1,951  tflops: 15.25  mfu: 4.89%
[rank0]:2025-10-23 20:12:37,188 - INFO -  step: 660  loss: -8.0000  grad_norm:  0.3060  memory: 20.89GiB(43.97%)  tps: 1,951  tflops: 15.25  mfu: 4.89%
[rank1]:2025-10-23 20:12:37,176 - INFO -  step: 660  loss: -8.0000  grad_norm:  0.3060  memory: 20.03GiB(42.17%)  tps: 1,951  tflops: 15.25  mfu: 4.89%
[rank3]:2025-10-23 20:12:37,185 - INFO -  step: 660  loss:  1.7532  grad_norm:  0.3060  memory: 38.93GiB(81.95%)  tps: 1,951  tflops: 15.25  mfu: 4.89%
[rank3]:2025-10-23 20:12:39,100 - INFO - Avg. fwd time: 76.0930 / Avg. bwd time: 135.6054 / Avg. batch time: 1743.7717 (ms) / GPU bubble ratio: 2.88%
[rank2]:2025-10-23 20:12:39,168 - INFO - Avg. fwd time: 34.9717 / Avg. bwd time: 55.3005 / Avg. batch time: 1836.1951 (ms) / GPU bubble ratio: 60.67%
[rank1]:2025-10-23 20:12:39,249 - INFO - Avg. fwd time: 55.2749 / Avg. bwd time: 74.0506 / Avg. batch time: 1959.2632 (ms) / GPU bubble ratio: 47.19%
[rank0]:2025-10-23 20:12:39,322 - INFO - Avg. fwd time: 47.9927 / Avg. bwd time: 61.1086 / Avg. batch time: 2059.2394 (ms) / GPU bubble ratio: 57.61%
[rank2]:2025-10-23 20:15:27,063 - INFO - Avg. fwd time: 34.9719 / Avg. bwd time: 55.2983 / Avg. batch time: 1836.1356 (ms) / GPU bubble ratio: 60.67%
[rank3]:2025-10-23 20:15:26,999 - INFO - Avg. fwd time: 76.0954 / Avg. bwd time: 135.6004 / Avg. batch time: 1743.7232 (ms) / GPU bubble ratio: 2.88%
[rank1]:2025-10-23 20:15:27,144 - INFO - Avg. fwd time: 55.2595 / Avg. bwd time: 74.0556 / Avg. batch time: 1959.1938 (ms) / GPU bubble ratio: 47.20%
[rank0]:2025-10-23 20:15:27,212 - INFO - Avg. fwd time: 47.9882 / Avg. bwd time: 61.1116 / Avg. batch time: 2059.1671 (ms) / GPU bubble ratio: 57.61%
[rank2]:2025-10-23 20:18:13,065 - INFO -  step: 680  loss: -8.0000  grad_norm:  0.2780  memory: 16.10GiB(33.90%)  tps: 1,951  tflops: 15.25  mfu: 4.89%
[rank1]:2025-10-23 20:18:13,069 - INFO -  step: 680  loss: -8.0000  grad_norm:  0.2780  memory: 20.03GiB(42.17%)  tps: 1,951  tflops: 15.25  mfu: 4.89%
[rank3]:2025-10-23 20:18:13,077 - INFO -  step: 680  loss:  1.6248  grad_norm:  0.2780  memory: 38.93GiB(81.95%)  tps: 1,951  tflops: 15.25  mfu: 4.89%
[rank0]:2025-10-23 20:18:13,080 - INFO -  step: 680  loss: -8.0000  grad_norm:  0.2780  memory: 20.89GiB(43.97%)  tps: 1,951  tflops: 15.25  mfu: 4.89%
[rank3]:2025-10-23 20:18:14,994 - INFO - Avg. fwd time: 76.0811 / Avg. bwd time: 135.6072 / Avg. batch time: 1743.6700 (ms) / GPU bubble ratio: 2.88%
[rank2]:2025-10-23 20:18:15,058 - INFO - Avg. fwd time: 34.9753 / Avg. bwd time: 55.3012 / Avg. batch time: 1836.0864 (ms) / GPU bubble ratio: 60.67%
[rank1]:2025-10-23 20:18:15,158 - INFO - Avg. fwd time: 55.2622 / Avg. bwd time: 74.0514 / Avg. batch time: 1959.1408 (ms) / GPU bubble ratio: 47.20%
[rank0]:2025-10-23 20:18:15,226 - INFO - Avg. fwd time: 47.9892 / Avg. bwd time: 61.1081 / Avg. batch time: 2059.1128 (ms) / GPU bubble ratio: 57.61%
[rank3]:2025-10-23 20:21:03,203 - INFO - Avg. fwd time: 76.0774 / Avg. bwd time: 135.6127 / Avg. batch time: 1743.6692 (ms) / GPU bubble ratio: 2.88%
[rank2]:2025-10-23 20:21:03,270 - INFO - Avg. fwd time: 34.9790 / Avg. bwd time: 55.3051 / Avg. batch time: 1836.0908 (ms) / GPU bubble ratio: 60.66%
[rank1]:2025-10-23 20:21:03,348 - INFO - Avg. fwd time: 55.2625 / Avg. bwd time: 74.0615 / Avg. batch time: 1959.1296 (ms) / GPU bubble ratio: 47.19%
[rank0]:2025-10-23 20:21:03,424 - INFO - Avg. fwd time: 47.9886 / Avg. bwd time: 61.1134 / Avg. batch time: 2059.0945 (ms) / GPU bubble ratio: 57.61%
[rank0]:2025-10-23 20:23:32,575 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-23 20:23:49,387 - INFO -  step: 700  loss: -8.0000  grad_norm:  0.3067  memory: 20.89GiB(43.97%)  tps: 1,949  tflops: 15.23  mfu: 4.88%
[rank1]:2025-10-23 20:23:49,373 - INFO -  step: 700  loss: -8.0000  grad_norm:  0.3067  memory: 20.03GiB(42.17%)  tps: 1,949  tflops: 15.23  mfu: 4.88%
[rank2]:2025-10-23 20:23:49,367 - INFO -  step: 700  loss: -8.0000  grad_norm:  0.3067  memory: 16.10GiB(33.90%)  tps: 1,949  tflops: 15.23  mfu: 4.88%
[rank3]:2025-10-23 20:23:49,380 - INFO -  step: 700  loss:  1.7186  grad_norm:  0.3067  memory: 38.93GiB(81.95%)  tps: 1,949  tflops: 15.23  mfu: 4.88%
[rank3]:2025-10-23 20:23:49,644 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_gpipe_nofreeze_dm1/pipeline_schedule/251023_2023_real_step700_rank3.svg
[rank3]:> Batch Time: 2005.97 ms, GPU Bubble Ratio: 56.72%, 48.21%, 64.39%, 15.67%
[rank3]:2025-10-23 20:23:51,439 - INFO - Avg. fwd time: 76.0672 / Avg. bwd time: 135.6135 / Avg. batch time: 1743.6208 (ms) / GPU bubble ratio: 2.88%
[rank2]:2025-10-23 20:23:51,505 - INFO - Avg. fwd time: 34.9780 / Avg. bwd time: 55.3052 / Avg. batch time: 1836.0655 (ms) / GPU bubble ratio: 60.66%
[rank1]:2025-10-23 20:23:51,594 - INFO - Avg. fwd time: 55.2785 / Avg. bwd time: 74.0798 / Avg. batch time: 1959.1177 (ms) / GPU bubble ratio: 47.18%
[rank0]:2025-10-23 20:23:51,669 - INFO - Avg. fwd time: 47.9890 / Avg. bwd time: 61.1171 / Avg. batch time: 2059.0838 (ms) / GPU bubble ratio: 57.61%
[rank2]:2025-10-23 20:26:39,579 - INFO - Avg. fwd time: 34.9759 / Avg. bwd time: 55.3047 / Avg. batch time: 1835.9956 (ms) / GPU bubble ratio: 60.66%
[rank3]:2025-10-23 20:26:39,510 - INFO - Avg. fwd time: 76.0548 / Avg. bwd time: 135.6137 / Avg. batch time: 1743.5547 (ms) / GPU bubble ratio: 2.88%
[rank0]:2025-10-23 20:26:39,731 - INFO - Avg. fwd time: 47.9920 / Avg. bwd time: 61.1159 / Avg. batch time: 2059.0498 (ms) / GPU bubble ratio: 57.61%
[rank1]:2025-10-23 20:26:39,657 - INFO - Avg. fwd time: 55.3003 / Avg. bwd time: 74.0875 / Avg. batch time: 1959.0778 (ms) / GPU bubble ratio: 47.16%
[rank1]:2025-10-23 20:29:25,846 - INFO -  step: 720  loss: -8.0000  grad_norm:  0.2728  memory: 20.03GiB(42.17%)  tps: 1,948  tflops: 15.23  mfu: 4.88%
[rank0]:2025-10-23 20:29:25,862 - INFO -  step: 720  loss: -8.0000  grad_norm:  0.2728  memory: 20.89GiB(43.97%)  tps: 1,948  tflops: 15.23  mfu: 4.88%
[rank2]:2025-10-23 20:29:25,842 - INFO -  step: 720  loss: -8.0000  grad_norm:  0.2728  memory: 16.10GiB(33.90%)  tps: 1,948  tflops: 15.23  mfu: 4.88%
[rank3]:2025-10-23 20:29:25,855 - INFO -  step: 720  loss:  1.7351  grad_norm:  0.2728  memory: 38.93GiB(81.95%)  tps: 1,948  tflops: 15.23  mfu: 4.88%
[rank3]:2025-10-23 20:29:27,789 - INFO - Avg. fwd time: 76.0541 / Avg. bwd time: 135.6141 / Avg. batch time: 1743.5613 (ms) / GPU bubble ratio: 2.88%
[rank2]:2025-10-23 20:29:27,852 - INFO - Avg. fwd time: 34.9727 / Avg. bwd time: 55.3046 / Avg. batch time: 1835.9964 (ms) / GPU bubble ratio: 60.66%
[rank1]:2025-10-23 20:29:27,933 - INFO - Avg. fwd time: 55.3101 / Avg. bwd time: 74.1023 / Avg. batch time: 1959.0782 (ms) / GPU bubble ratio: 47.15%
[rank0]:2025-10-23 20:29:28,003 - INFO - Avg. fwd time: 47.9909 / Avg. bwd time: 61.1185 / Avg. batch time: 2059.0478 (ms) / GPU bubble ratio: 57.61%
[rank3]:2025-10-23 20:32:15,809 - INFO - Avg. fwd time: 76.0429 / Avg. bwd time: 135.6129 / Avg. batch time: 1743.4971 (ms) / GPU bubble ratio: 2.88%
[rank2]:2025-10-23 20:32:15,877 - INFO - Avg. fwd time: 34.9715 / Avg. bwd time: 55.3034 / Avg. batch time: 1835.9398 (ms) / GPU bubble ratio: 60.66%
[rank1]:2025-10-23 20:32:15,954 - INFO - Avg. fwd time: 55.3236 / Avg. bwd time: 74.1116 / Avg. batch time: 1959.0339 (ms) / GPU bubble ratio: 47.14%
[rank0]:2025-10-23 20:32:16,023 - INFO - Avg. fwd time: 47.9957 / Avg. bwd time: 61.1176 / Avg. batch time: 2059.0085 (ms) / GPU bubble ratio: 57.61%
[rank1]:2025-10-23 20:35:01,873 - INFO -  step: 740  loss: -8.0000  grad_norm:  0.2615  memory: 20.03GiB(42.17%)  tps: 1,950  tflops: 15.25  mfu: 4.89%
[rank0]:2025-10-23 20:35:01,891 - INFO -  step: 740  loss: -8.0000  grad_norm:  0.2615  memory: 20.89GiB(43.97%)  tps: 1,950  tflops: 15.25  mfu: 4.89%
[rank2]:2025-10-23 20:35:01,869 - INFO -  step: 740  loss: -8.0000  grad_norm:  0.2615  memory: 16.10GiB(33.90%)  tps: 1,950  tflops: 15.25  mfu: 4.89%
[rank3]:2025-10-23 20:35:01,881 - INFO -  step: 740  loss:  1.6523  grad_norm:  0.2615  memory: 38.93GiB(81.95%)  tps: 1,950  tflops: 15.25  mfu: 4.89%
[rank2]:2025-10-23 20:35:03,864 - INFO - Avg. fwd time: 34.9675 / Avg. bwd time: 55.3032 / Avg. batch time: 1835.8643 (ms) / GPU bubble ratio: 60.66%
[rank3]:2025-10-23 20:35:03,798 - INFO - Avg. fwd time: 76.0338 / Avg. bwd time: 135.6091 / Avg. batch time: 1743.4201 (ms) / GPU bubble ratio: 2.88%
[rank1]:2025-10-23 20:35:03,952 - INFO - Avg. fwd time: 55.3369 / Avg. bwd time: 74.1177 / Avg. batch time: 1958.9742 (ms) / GPU bubble ratio: 47.13%
[rank0]:2025-10-23 20:35:04,026 - INFO - Avg. fwd time: 47.9996 / Avg. bwd time: 61.1155 / Avg. batch time: 2058.9582 (ms) / GPU bubble ratio: 57.60%
[rank0]:2025-10-23 20:37:33,013 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-23 20:37:51,770 - INFO - Avg. fwd time: 34.9645 / Avg. bwd time: 55.3052 / Avg. batch time: 1835.7803 (ms) / GPU bubble ratio: 60.66%
[rank3]:2025-10-23 20:37:51,706 - INFO - Avg. fwd time: 76.0244 / Avg. bwd time: 135.6046 / Avg. batch time: 1743.3364 (ms) / GPU bubble ratio: 2.89%
[rank1]:2025-10-23 20:37:51,852 - INFO - Avg. fwd time: 55.3529 / Avg. bwd time: 74.1279 / Avg. batch time: 1958.9060 (ms) / GPU bubble ratio: 47.12%
[rank0]:2025-10-23 20:37:51,921 - INFO - Avg. fwd time: 48.0018 / Avg. bwd time: 61.1160 / Avg. batch time: 2058.8942 (ms) / GPU bubble ratio: 57.60%
[rank2]:2025-10-23 20:40:37,767 - INFO -  step: 760  loss: -8.0000  grad_norm:  0.2883  memory: 16.10GiB(33.90%)  tps: 1,951  tflops: 15.25  mfu: 4.89%
[rank3]:2025-10-23 20:40:37,780 - INFO -  step: 760  loss:  1.6705  grad_norm:  0.2883  memory: 38.93GiB(81.95%)  tps: 1,951  tflops: 15.25  mfu: 4.89%
[rank1]:2025-10-23 20:40:37,772 - INFO -  step: 760  loss: -8.0000  grad_norm:  0.2883  memory: 20.03GiB(42.17%)  tps: 1,951  tflops: 15.25  mfu: 4.89%
[rank0]:2025-10-23 20:40:37,783 - INFO -  step: 760  loss: -8.0000  grad_norm:  0.2883  memory: 20.89GiB(43.97%)  tps: 1,951  tflops: 15.25  mfu: 4.89%
[rank3]:2025-10-23 20:40:39,699 - INFO - Avg. fwd time: 76.0220 / Avg. bwd time: 135.6009 / Avg. batch time: 1743.2721 (ms) / GPU bubble ratio: 2.88%
[rank2]:2025-10-23 20:40:39,763 - INFO - Avg. fwd time: 34.9644 / Avg. bwd time: 55.3009 / Avg. batch time: 1835.7100 (ms) / GPU bubble ratio: 60.66%
[rank1]:2025-10-23 20:40:39,846 - INFO - Avg. fwd time: 55.3563 / Avg. bwd time: 74.1228 / Avg. batch time: 1958.8452 (ms) / GPU bubble ratio: 47.12%
[rank0]:2025-10-23 20:40:39,920 - INFO - Avg. fwd time: 48.0033 / Avg. bwd time: 61.1116 / Avg. batch time: 2058.8446 (ms) / GPU bubble ratio: 57.60%
[rank3]:2025-10-23 20:43:28,020 - INFO - Avg. fwd time: 76.0230 / Avg. bwd time: 135.6033 / Avg. batch time: 1743.2781 (ms) / GPU bubble ratio: 2.88%
[rank2]:2025-10-23 20:43:28,084 - INFO - Avg. fwd time: 34.9657 / Avg. bwd time: 55.3016 / Avg. batch time: 1835.7193 (ms) / GPU bubble ratio: 60.66%
[rank1]:2025-10-23 20:43:28,163 - INFO - Avg. fwd time: 55.3508 / Avg. bwd time: 74.1263 / Avg. batch time: 1958.8536 (ms) / GPU bubble ratio: 47.12%
[rank0]:2025-10-23 20:43:28,233 - INFO - Avg. fwd time: 48.0052 / Avg. bwd time: 61.1113 / Avg. batch time: 2058.8511 (ms) / GPU bubble ratio: 57.60%
[rank2]:2025-10-23 20:46:14,354 - INFO -  step: 780  loss: -8.0000  grad_norm:  0.2968  memory: 16.10GiB(33.90%)  tps: 1,947  tflops: 15.22  mfu: 4.88%
[rank3]:2025-10-23 20:46:14,366 - INFO -  step: 780  loss:  1.5806  grad_norm:  0.2968  memory: 38.93GiB(81.95%)  tps: 1,947  tflops: 15.22  mfu: 4.88%
[rank0]:2025-10-23 20:46:14,380 - INFO -  step: 780  loss: -8.0000  grad_norm:  0.2968  memory: 20.89GiB(43.97%)  tps: 1,947  tflops: 15.22  mfu: 4.88%
[rank1]:2025-10-23 20:46:14,358 - INFO -  step: 780  loss: -8.0000  grad_norm:  0.2968  memory: 20.03GiB(42.17%)  tps: 1,947  tflops: 15.22  mfu: 4.88%
[rank3]:2025-10-23 20:46:16,300 - INFO - Avg. fwd time: 76.0196 / Avg. bwd time: 135.6101 / Avg. batch time: 1743.2883 (ms) / GPU bubble ratio: 2.88%
[rank2]:2025-10-23 20:46:16,375 - INFO - Avg. fwd time: 34.9726 / Avg. bwd time: 55.3026 / Avg. batch time: 1835.7272 (ms) / GPU bubble ratio: 60.66%
[rank1]:2025-10-23 20:46:16,456 - INFO - Avg. fwd time: 55.3563 / Avg. bwd time: 74.1323 / Avg. batch time: 1958.8501 (ms) / GPU bubble ratio: 47.12%
[rank0]:2025-10-23 20:46:16,526 - INFO - Avg. fwd time: 48.0117 / Avg. bwd time: 61.1164 / Avg. batch time: 2058.8543 (ms) / GPU bubble ratio: 57.60%
[rank3]:2025-10-23 20:49:04,465 - INFO - Avg. fwd time: 76.0210 / Avg. bwd time: 135.6138 / Avg. batch time: 1743.2943 (ms) / GPU bubble ratio: 2.88%
[rank2]:2025-10-23 20:49:04,530 - INFO - Avg. fwd time: 34.9761 / Avg. bwd time: 55.3044 / Avg. batch time: 1835.7334 (ms) / GPU bubble ratio: 60.66%
[rank1]:2025-10-23 20:49:04,612 - INFO - Avg. fwd time: 55.3462 / Avg. bwd time: 74.1440 / Avg. batch time: 1958.8379 (ms) / GPU bubble ratio: 47.12%
[rank0]:2025-10-23 20:49:04,682 - INFO - Avg. fwd time: 48.0151 / Avg. bwd time: 61.1225 / Avg. batch time: 2058.8401 (ms) / GPU bubble ratio: 57.59%
[rank0]:2025-10-23 20:51:33,863 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-23 20:51:50,688 - INFO -  step: 800  loss:  1.6869  grad_norm:  0.2746  memory: 38.93GiB(81.95%)  tps: 1,949  tflops: 15.23  mfu: 4.88%
[rank2]:2025-10-23 20:51:50,676 - INFO -  step: 800  loss: -8.0000  grad_norm:  0.2746  memory: 16.10GiB(33.90%)  tps: 1,949  tflops: 15.23  mfu: 4.88%
[rank1]:2025-10-23 20:51:50,680 - INFO -  step: 800  loss: -8.0000  grad_norm:  0.2746  memory: 20.03GiB(42.17%)  tps: 1,949  tflops: 15.23  mfu: 4.88%
[rank0]:2025-10-23 20:51:50,695 - INFO -  step: 800  loss: -8.0000  grad_norm:  0.2746  memory: 20.89GiB(43.97%)  tps: 1,949  tflops: 15.23  mfu: 4.88%
[rank3]:2025-10-23 20:51:50,947 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_gpipe_nofreeze_dm1/pipeline_schedule/251023_2051_real_step800_rank3.svg
[rank3]:> Batch Time: 2005.66 ms, GPU Bubble Ratio: 56.66%, 48.06%, 64.39%, 15.69%
[rank3]:2025-10-23 20:51:52,759 - INFO - Avg. fwd time: 76.0213 / Avg. bwd time: 135.6146 / Avg. batch time: 1743.2772 (ms) / GPU bubble ratio: 2.88%
[rank2]:2025-10-23 20:51:52,824 - INFO - Avg. fwd time: 34.9777 / Avg. bwd time: 55.3035 / Avg. batch time: 1835.7340 (ms) / GPU bubble ratio: 60.66%
[rank1]:2025-10-23 20:51:52,909 - INFO - Avg. fwd time: 55.3420 / Avg. bwd time: 74.1527 / Avg. batch time: 1958.8266 (ms) / GPU bubble ratio: 47.11%
[rank0]:2025-10-23 20:51:52,979 - INFO - Avg. fwd time: 48.0181 / Avg. bwd time: 61.1281 / Avg. batch time: 2058.8348 (ms) / GPU bubble ratio: 57.59%
[rank3]:2025-10-23 20:54:40,753 - INFO - Avg. fwd time: 76.0208 / Avg. bwd time: 135.6142 / Avg. batch time: 1743.2422 (ms) / GPU bubble ratio: 2.88%
[rank2]:2025-10-23 20:54:40,821 - INFO - Avg. fwd time: 34.9813 / Avg. bwd time: 55.3020 / Avg. batch time: 1835.6996 (ms) / GPU bubble ratio: 60.65%
[rank1]:2025-10-23 20:54:40,904 - INFO - Avg. fwd time: 55.3377 / Avg. bwd time: 74.1524 / Avg. batch time: 1958.7832 (ms) / GPU bubble ratio: 47.11%
[rank0]:2025-10-23 20:54:40,979 - INFO - Avg. fwd time: 48.0206 / Avg. bwd time: 61.1294 / Avg. batch time: 2058.7967 (ms) / GPU bubble ratio: 57.59%
[rank2]:2025-10-23 20:57:26,833 - INFO -  step: 820  loss: -8.0000  grad_norm:  0.3040  memory: 16.10GiB(33.90%)  tps: 1,950  tflops: 15.24  mfu: 4.88%
[rank1]:2025-10-23 20:57:26,837 - INFO -  step: 820  loss: -8.0000  grad_norm:  0.3040  memory: 20.03GiB(42.17%)  tps: 1,950  tflops: 15.24  mfu: 4.88%
[rank0]:2025-10-23 20:57:26,853 - INFO -  step: 820  loss: -8.0000  grad_norm:  0.3040  memory: 20.89GiB(43.97%)  tps: 1,950  tflops: 15.24  mfu: 4.88%
[rank3]:2025-10-23 20:57:26,846 - INFO -  step: 820  loss:  1.6401  grad_norm:  0.3040  memory: 38.93GiB(81.95%)  tps: 1,950  tflops: 15.24  mfu: 4.88%
[rank3]:2025-10-23 20:57:28,744 - INFO - Avg. fwd time: 76.0144 / Avg. bwd time: 135.6127 / Avg. batch time: 1743.1786 (ms) / GPU bubble ratio: 2.88%
[rank2]:2025-10-23 20:57:28,813 - INFO - Avg. fwd time: 34.9824 / Avg. bwd time: 55.2991 / Avg. batch time: 1835.6372 (ms) / GPU bubble ratio: 60.65%
[rank1]:2025-10-23 20:57:28,892 - INFO - Avg. fwd time: 55.3417 / Avg. bwd time: 74.1478 / Avg. batch time: 1958.7213 (ms) / GPU bubble ratio: 47.11%
[rank0]:2025-10-23 20:57:28,961 - INFO - Avg. fwd time: 48.0252 / Avg. bwd time: 61.1286 / Avg. batch time: 2058.7534 (ms) / GPU bubble ratio: 57.58%
[rank3]:2025-10-23 21:00:16,801 - INFO - Avg. fwd time: 76.0139 / Avg. bwd time: 135.6090 / Avg. batch time: 1743.1371 (ms) / GPU bubble ratio: 2.88%
[rank2]:2025-10-23 21:00:16,869 - INFO - Avg. fwd time: 34.9837 / Avg. bwd time: 55.2977 / Avg. batch time: 1835.5995 (ms) / GPU bubble ratio: 60.65%
[rank1]:2025-10-23 21:00:16,951 - INFO - Avg. fwd time: 55.3427 / Avg. bwd time: 74.1444 / Avg. batch time: 1958.6852 (ms) / GPU bubble ratio: 47.11%
[rank0]:2025-10-23 21:00:17,028 - INFO - Avg. fwd time: 48.0277 / Avg. bwd time: 61.1308 / Avg. batch time: 2058.7295 (ms) / GPU bubble ratio: 57.58%
[rank2]:2025-10-23 21:03:02,821 - INFO -  step: 840  loss: -8.0000  grad_norm:  0.2665  memory: 16.10GiB(33.90%)  tps: 1,951  tflops: 15.25  mfu: 4.89%
[rank3]:2025-10-23 21:03:02,833 - INFO -  step: 840  loss:  1.5963  grad_norm:  0.2665  memory: 38.93GiB(81.95%)  tps: 1,951  tflops: 15.25  mfu: 4.89%
[rank0]:2025-10-23 21:03:02,840 - INFO -  step: 840  loss: -8.0000  grad_norm:  0.2665  memory: 20.89GiB(43.97%)  tps: 1,951  tflops: 15.25  mfu: 4.89%
[rank1]:2025-10-23 21:03:02,826 - INFO -  step: 840  loss: -8.0000  grad_norm:  0.2665  memory: 20.03GiB(42.17%)  tps: 1,951  tflops: 15.25  mfu: 4.89%
[rank3]:2025-10-23 21:03:04,749 - INFO - Avg. fwd time: 76.0141 / Avg. bwd time: 135.6058 / Avg. batch time: 1743.0918 (ms) / GPU bubble ratio: 2.88%
[rank2]:2025-10-23 21:03:04,816 - INFO - Avg. fwd time: 34.9842 / Avg. bwd time: 55.2961 / Avg. batch time: 1835.5541 (ms) / GPU bubble ratio: 60.65%
[rank1]:2025-10-23 21:03:04,904 - INFO - Avg. fwd time: 55.3408 / Avg. bwd time: 74.1511 / Avg. batch time: 1958.6312 (ms) / GPU bubble ratio: 47.11%
[rank0]:2025-10-23 21:03:04,979 - INFO - Avg. fwd time: 48.0292 / Avg. bwd time: 61.1332 / Avg. batch time: 2058.6757 (ms) / GPU bubble ratio: 57.58%
[rank0]:2025-10-23 21:05:34,018 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-23 21:05:52,783 - INFO - Avg. fwd time: 34.9848 / Avg. bwd time: 55.2921 / Avg. batch time: 1835.4877 (ms) / GPU bubble ratio: 60.65%
[rank3]:2025-10-23 21:05:52,718 - INFO - Avg. fwd time: 76.0149 / Avg. bwd time: 135.5987 / Avg. batch time: 1743.0271 (ms) / GPU bubble ratio: 2.88%
[rank0]:2025-10-23 21:05:52,933 - INFO - Avg. fwd time: 48.0305 / Avg. bwd time: 61.1322 / Avg. batch time: 2058.6361 (ms) / GPU bubble ratio: 57.58%
[rank1]:2025-10-23 21:05:52,863 - INFO - Avg. fwd time: 55.3427 / Avg. bwd time: 74.1416 / Avg. batch time: 1958.5774 (ms) / GPU bubble ratio: 47.11%
[rank1]:2025-10-23 21:08:38,649 - INFO -  step: 860  loss: -8.0000  grad_norm:  0.2761  memory: 20.03GiB(42.17%)  tps: 1,952  tflops: 15.26  mfu: 4.89%
[rank2]:2025-10-23 21:08:38,645 - INFO -  step: 860  loss: -8.0000  grad_norm:  0.2761  memory: 16.10GiB(33.90%)  tps: 1,952  tflops: 15.26  mfu: 4.89%
[rank3]:2025-10-23 21:08:38,657 - INFO -  step: 860  loss:  1.6274  grad_norm:  0.2761  memory: 38.93GiB(81.95%)  tps: 1,952  tflops: 15.26  mfu: 4.89%
[rank0]:2025-10-23 21:08:38,669 - INFO -  step: 860  loss: -8.0000  grad_norm:  0.2761  memory: 20.89GiB(43.97%)  tps: 1,951  tflops: 15.26  mfu: 4.89%
[rank3]:2025-10-23 21:08:40,579 - INFO - Avg. fwd time: 76.0109 / Avg. bwd time: 135.5923 / Avg. batch time: 1742.9351 (ms) / GPU bubble ratio: 2.87%
[rank2]:2025-10-23 21:08:40,648 - INFO - Avg. fwd time: 34.9852 / Avg. bwd time: 55.2927 / Avg. batch time: 1835.3952 (ms) / GPU bubble ratio: 60.65%
[rank1]:2025-10-23 21:08:40,733 - INFO - Avg. fwd time: 55.3487 / Avg. bwd time: 74.1438 / Avg. batch time: 1958.5074 (ms) / GPU bubble ratio: 47.11%
[rank0]:2025-10-23 21:08:40,805 - INFO - Avg. fwd time: 48.0306 / Avg. bwd time: 61.1324 / Avg. batch time: 2058.5776 (ms) / GPU bubble ratio: 57.58%
[rank3]:2025-10-23 21:11:28,619 - INFO - Avg. fwd time: 76.0173 / Avg. bwd time: 135.5855 / Avg. batch time: 1742.9026 (ms) / GPU bubble ratio: 2.87%
[rank2]:2025-10-23 21:11:28,689 - INFO - Avg. fwd time: 34.9859 / Avg. bwd time: 55.2883 / Avg. batch time: 1835.3629 (ms) / GPU bubble ratio: 60.65%
[rank1]:2025-10-23 21:11:28,773 - INFO - Avg. fwd time: 55.3438 / Avg. bwd time: 74.1421 / Avg. batch time: 1958.4695 (ms) / GPU bubble ratio: 47.11%
[rank0]:2025-10-23 21:11:28,843 - INFO - Avg. fwd time: 48.0296 / Avg. bwd time: 61.1351 / Avg. batch time: 2058.5497 (ms) / GPU bubble ratio: 57.58%
[rank3]:2025-10-23 21:14:14,636 - INFO -  step: 880  loss:  1.5747  grad_norm:  0.2581  memory: 38.93GiB(81.95%)  tps: 1,951  tflops: 15.25  mfu: 4.89%
[rank2]:2025-10-23 21:14:14,623 - INFO -  step: 880  loss: -8.0000  grad_norm:  0.2581  memory: 16.10GiB(33.90%)  tps: 1,951  tflops: 15.25  mfu: 4.89%
[rank0]:2025-10-23 21:14:14,640 - INFO -  step: 880  loss: -8.0000  grad_norm:  0.2581  memory: 20.89GiB(43.97%)  tps: 1,951  tflops: 15.25  mfu: 4.89%
[rank1]:2025-10-23 21:14:14,632 - INFO -  step: 880  loss: -8.0000  grad_norm:  0.2581  memory: 20.03GiB(42.17%)  tps: 1,951  tflops: 15.25  mfu: 4.89%
[rank3]:2025-10-23 21:14:16,540 - INFO - Avg. fwd time: 76.0202 / Avg. bwd time: 135.5791 / Avg. batch time: 1742.8560 (ms) / GPU bubble ratio: 2.87%
[rank2]:2025-10-23 21:14:16,605 - INFO - Avg. fwd time: 34.9854 / Avg. bwd time: 55.2838 / Avg. batch time: 1835.3162 (ms) / GPU bubble ratio: 60.65%
[rank1]:2025-10-23 21:14:16,690 - INFO - Avg. fwd time: 55.3402 / Avg. bwd time: 74.1407 / Avg. batch time: 1958.4235 (ms) / GPU bubble ratio: 47.11%
[rank0]:2025-10-23 21:14:16,765 - INFO - Avg. fwd time: 48.0283 / Avg. bwd time: 61.1375 / Avg. batch time: 2058.5041 (ms) / GPU bubble ratio: 57.57%
[rank3]:2025-10-23 21:17:04,523 - INFO - Avg. fwd time: 76.0232 / Avg. bwd time: 135.5729 / Avg. batch time: 1742.8107 (ms) / GPU bubble ratio: 2.87%
[rank2]:2025-10-23 21:17:04,589 - INFO - Avg. fwd time: 34.9861 / Avg. bwd time: 55.2840 / Avg. batch time: 1835.2712 (ms) / GPU bubble ratio: 60.65%
[rank1]:2025-10-23 21:17:04,668 - INFO - Avg. fwd time: 55.3374 / Avg. bwd time: 74.1384 / Avg. batch time: 1958.3820 (ms) / GPU bubble ratio: 47.11%
[rank0]:2025-10-23 21:17:04,739 - INFO - Avg. fwd time: 48.0274 / Avg. bwd time: 61.1372 / Avg. batch time: 2058.4666 (ms) / GPU bubble ratio: 57.57%
[rank0]:2025-10-23 21:19:33,771 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-23 21:19:50,581 - INFO -  step: 900  loss: -8.0000  grad_norm:  0.2621  memory: 16.10GiB(33.90%)  tps: 1,951  tflops: 15.25  mfu: 4.89%
[rank0]:2025-10-23 21:19:50,605 - INFO -  step: 900  loss: -8.0000  grad_norm:  0.2621  memory: 20.89GiB(43.97%)  tps: 1,951  tflops: 15.25  mfu: 4.89%
[rank1]:2025-10-23 21:19:50,585 - INFO -  step: 900  loss: -8.0000  grad_norm:  0.2621  memory: 20.03GiB(42.17%)  tps: 1,951  tflops: 15.25  mfu: 4.89%
[rank3]:2025-10-23 21:19:50,593 - INFO -  step: 900  loss:  1.6089  grad_norm:  0.2621  memory: 38.93GiB(81.95%)  tps: 1,951  tflops: 15.25  mfu: 4.89%
[rank3]:2025-10-23 21:19:50,865 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_gpipe_nofreeze_dm1/pipeline_schedule/251023_2119_real_step900_rank3.svg
[rank3]:> Batch Time: 2005.78 ms, GPU Bubble Ratio: 56.63%, 48.05%, 64.40%, 15.72%
[rank3]:2025-10-23 21:19:52,665 - INFO - Avg. fwd time: 76.0236 / Avg. bwd time: 135.5717 / Avg. batch time: 1742.7870 (ms) / GPU bubble ratio: 2.87%
[rank2]:2025-10-23 21:19:52,732 - INFO - Avg. fwd time: 34.9871 / Avg. bwd time: 55.2828 / Avg. batch time: 1835.2608 (ms) / GPU bubble ratio: 60.65%
[rank1]:2025-10-23 21:19:52,816 - INFO - Avg. fwd time: 55.3320 / Avg. bwd time: 74.1426 / Avg. batch time: 1958.3563 (ms) / GPU bubble ratio: 47.11%
[rank0]:2025-10-23 21:19:52,887 - INFO - Avg. fwd time: 48.0264 / Avg. bwd time: 61.1414 / Avg. batch time: 2058.4389 (ms) / GPU bubble ratio: 57.57%
[rank3]:2025-10-23 21:22:40,848 - INFO - Avg. fwd time: 76.0200 / Avg. bwd time: 135.5749 / Avg. batch time: 1742.7674 (ms) / GPU bubble ratio: 2.87%
[rank2]:2025-10-23 21:22:40,918 - INFO - Avg. fwd time: 34.9913 / Avg. bwd time: 55.2845 / Avg. batch time: 1835.2443 (ms) / GPU bubble ratio: 60.65%
[rank0]:2025-10-23 21:22:41,068 - INFO - Avg. fwd time: 48.0286 / Avg. bwd time: 61.1475 / Avg. batch time: 2058.4236 (ms) / GPU bubble ratio: 57.57%
[rank1]:2025-10-23 21:22:40,998 - INFO - Avg. fwd time: 55.3332 / Avg. bwd time: 74.1480 / Avg. batch time: 1958.3285 (ms) / GPU bubble ratio: 47.11%
[rank2]:2025-10-23 21:25:27,059 - INFO -  step: 920  loss: -8.0000  grad_norm:  0.2682  memory: 16.10GiB(33.90%)  tps: 1,948  tflops: 15.23  mfu: 4.88%
[rank1]:2025-10-23 21:25:27,063 - INFO -  step: 920  loss: -8.0000  grad_norm:  0.2682  memory: 20.03GiB(42.17%)  tps: 1,948  tflops: 15.23  mfu: 4.88%
[rank3]:2025-10-23 21:25:27,072 - INFO -  step: 920  loss:  1.6999  grad_norm:  0.2682  memory: 38.93GiB(81.95%)  tps: 1,948  tflops: 15.23  mfu: 4.88%
[rank0]:2025-10-23 21:25:27,079 - INFO -  step: 920  loss: -8.0000  grad_norm:  0.2682  memory: 20.89GiB(43.97%)  tps: 1,948  tflops: 15.23  mfu: 4.88%
[rank3]:2025-10-23 21:25:28,997 - INFO - Avg. fwd time: 76.0169 / Avg. bwd time: 135.5769 / Avg. batch time: 1742.7479 (ms) / GPU bubble ratio: 2.87%
[rank2]:2025-10-23 21:25:29,064 - INFO - Avg. fwd time: 34.9924 / Avg. bwd time: 55.2839 / Avg. batch time: 1835.2253 (ms) / GPU bubble ratio: 60.65%
[rank1]:2025-10-23 21:25:29,150 - INFO - Avg. fwd time: 55.3387 / Avg. bwd time: 74.1451 / Avg. batch time: 1958.2931 (ms) / GPU bubble ratio: 47.10%
[rank0]:2025-10-23 21:25:29,221 - INFO - Avg. fwd time: 48.0301 / Avg. bwd time: 61.1488 / Avg. batch time: 2058.4026 (ms) / GPU bubble ratio: 57.57%
[rank3]:2025-10-23 21:28:17,016 - INFO - Avg. fwd time: 76.0157 / Avg. bwd time: 135.5752 / Avg. batch time: 1742.7135 (ms) / GPU bubble ratio: 2.87%
[rank2]:2025-10-23 21:28:17,081 - INFO - Avg. fwd time: 34.9934 / Avg. bwd time: 55.2819 / Avg. batch time: 1835.1869 (ms) / GPU bubble ratio: 60.65%
[rank1]:2025-10-23 21:28:17,162 - INFO - Avg. fwd time: 55.3357 / Avg. bwd time: 74.1461 / Avg. batch time: 1958.2500 (ms) / GPU bubble ratio: 47.10%
[rank0]:2025-10-23 21:28:17,232 - INFO - Avg. fwd time: 48.0312 / Avg. bwd time: 61.1499 / Avg. batch time: 2058.3743 (ms) / GPU bubble ratio: 57.57%
[rank0]:2025-10-23 21:31:03,100 - INFO -  step: 940  loss: -8.0000  grad_norm:  0.2808  memory: 20.89GiB(43.97%)  tps: 1,950  tflops: 15.25  mfu: 4.89%
[rank1]:2025-10-23 21:31:03,087 - INFO -  step: 940  loss: -8.0000  grad_norm:  0.2808  memory: 20.03GiB(42.17%)  tps: 1,950  tflops: 15.25  mfu: 4.89%
[rank2]:2025-10-23 21:31:03,083 - INFO -  step: 940  loss: -8.0000  grad_norm:  0.2808  memory: 16.10GiB(33.90%)  tps: 1,950  tflops: 15.25  mfu: 4.89%
[rank3]:2025-10-23 21:31:03,096 - INFO -  step: 940  loss:  1.7511  grad_norm:  0.2808  memory: 38.93GiB(81.95%)  tps: 1,950  tflops: 15.25  mfu: 4.89%
[rank3]:2025-10-23 21:31:05,016 - INFO - Avg. fwd time: 76.0169 / Avg. bwd time: 135.5737 / Avg. batch time: 1742.6880 (ms) / GPU bubble ratio: 2.87%
[rank2]:2025-10-23 21:31:05,087 - INFO - Avg. fwd time: 34.9957 / Avg. bwd time: 55.2799 / Avg. batch time: 1835.1604 (ms) / GPU bubble ratio: 60.65%
[rank1]:2025-10-23 21:31:05,172 - INFO - Avg. fwd time: 55.3326 / Avg. bwd time: 74.1495 / Avg. batch time: 1958.2170 (ms) / GPU bubble ratio: 47.10%
[rank0]:2025-10-23 21:31:05,248 - INFO - Avg. fwd time: 48.0332 / Avg. bwd time: 61.1488 / Avg. batch time: 2058.3484 (ms) / GPU bubble ratio: 57.57%
[rank0]:2025-10-23 21:33:34,346 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-23 21:33:53,053 - INFO - Avg. fwd time: 76.0176 / Avg. bwd time: 135.5727 / Avg. batch time: 1742.6680 (ms) / GPU bubble ratio: 2.87%
[rank2]:2025-10-23 21:33:53,119 - INFO - Avg. fwd time: 34.9960 / Avg. bwd time: 55.2766 / Avg. batch time: 1835.1363 (ms) / GPU bubble ratio: 60.65%
[rank1]:2025-10-23 21:33:53,199 - INFO - Avg. fwd time: 55.3292 / Avg. bwd time: 74.1529 / Avg. batch time: 1958.1844 (ms) / GPU bubble ratio: 47.10%
[rank0]:2025-10-23 21:33:53,270 - INFO - Avg. fwd time: 48.0334 / Avg. bwd time: 61.1503 / Avg. batch time: 2058.3266 (ms) / GPU bubble ratio: 57.56%
[rank2]:2025-10-23 21:36:39,117 - INFO -  step: 960  loss: -8.0000  grad_norm:  0.2850  memory: 16.10GiB(33.90%)  tps: 1,950  tflops: 15.25  mfu: 4.89%
[rank1]:2025-10-23 21:36:39,121 - INFO -  step: 960  loss: -8.0000  grad_norm:  0.2850  memory: 20.03GiB(42.17%)  tps: 1,950  tflops: 15.25  mfu: 4.89%
[rank3]:2025-10-23 21:36:39,129 - INFO -  step: 960  loss:  1.6725  grad_norm:  0.2850  memory: 38.93GiB(81.95%)  tps: 1,950  tflops: 15.25  mfu: 4.89%
[rank0]:2025-10-23 21:36:39,141 - INFO -  step: 960  loss: -8.0000  grad_norm:  0.2850  memory: 20.89GiB(43.97%)  tps: 1,950  tflops: 15.25  mfu: 4.89%
[rank3]:2025-10-23 21:36:41,056 - INFO - Avg. fwd time: 76.0225 / Avg. bwd time: 135.5700 / Avg. batch time: 1742.6607 (ms) / GPU bubble ratio: 2.86%
[rank2]:2025-10-23 21:36:41,122 - INFO - Avg. fwd time: 34.9965 / Avg. bwd time: 55.2741 / Avg. batch time: 1835.1285 (ms) / GPU bubble ratio: 60.65%
[rank1]:2025-10-23 21:36:41,209 - INFO - Avg. fwd time: 55.3152 / Avg. bwd time: 74.1578 / Avg. batch time: 1958.1485 (ms) / GPU bubble ratio: 47.10%
[rank0]:2025-10-23 21:36:41,285 - INFO - Avg. fwd time: 48.0326 / Avg. bwd time: 61.1572 / Avg. batch time: 2058.2976 (ms) / GPU bubble ratio: 57.56%
[rank3]:2025-10-23 21:39:29,106 - INFO - Avg. fwd time: 76.0191 / Avg. bwd time: 135.5740 / Avg. batch time: 1742.6516 (ms) / GPU bubble ratio: 2.86%
[rank2]:2025-10-23 21:39:29,178 - INFO - Avg. fwd time: 35.0008 / Avg. bwd time: 55.2749 / Avg. batch time: 1835.1246 (ms) / GPU bubble ratio: 60.65%
[rank1]:2025-10-23 21:39:29,269 - INFO - Avg. fwd time: 55.3187 / Avg. bwd time: 74.1631 / Avg. batch time: 1958.1179 (ms) / GPU bubble ratio: 47.10%
[rank0]:2025-10-23 21:39:29,343 - INFO - Avg. fwd time: 48.0365 / Avg. bwd time: 61.1605 / Avg. batch time: 2058.2821 (ms) / GPU bubble ratio: 57.56%
[rank1]:2025-10-23 21:42:15,513 - INFO -  step: 980  loss: -8.0000  grad_norm:  0.2638  memory: 20.03GiB(42.17%)  tps: 1,948  tflops: 15.23  mfu: 4.88%
[rank0]:2025-10-23 21:42:15,529 - INFO -  step: 980  loss: -8.0000  grad_norm:  0.2638  memory: 20.89GiB(43.97%)  tps: 1,948  tflops: 15.23  mfu: 4.88%
[rank2]:2025-10-23 21:42:15,508 - INFO -  step: 980  loss: -8.0000  grad_norm:  0.2638  memory: 16.10GiB(33.90%)  tps: 1,948  tflops: 15.23  mfu: 4.88%
[rank3]:2025-10-23 21:42:15,520 - INFO -  step: 980  loss:  1.6160  grad_norm:  0.2638  memory: 38.93GiB(81.95%)  tps: 1,948  tflops: 15.23  mfu: 4.88%
[rank3]:2025-10-23 21:42:17,444 - INFO - Avg. fwd time: 76.0194 / Avg. bwd time: 135.5792 / Avg. batch time: 1742.6723 (ms) / GPU bubble ratio: 2.86%
[rank2]:2025-10-23 21:42:17,513 - INFO - Avg. fwd time: 35.0031 / Avg. bwd time: 55.2755 / Avg. batch time: 1835.1466 (ms) / GPU bubble ratio: 60.64%
[rank1]:2025-10-23 21:42:17,596 - INFO - Avg. fwd time: 55.3219 / Avg. bwd time: 74.1732 / Avg. batch time: 1958.1196 (ms) / GPU bubble ratio: 47.09%
[rank0]:2025-10-23 21:42:17,668 - INFO - Avg. fwd time: 48.0397 / Avg. bwd time: 61.1690 / Avg. batch time: 2058.2973 (ms) / GPU bubble ratio: 57.55%
[rank3]:2025-10-23 21:45:05,474 - INFO - Avg. fwd time: 76.0137 / Avg. bwd time: 135.5803 / Avg. batch time: 1742.6420 (ms) / GPU bubble ratio: 2.86%
[rank2]:2025-10-23 21:45:05,541 - INFO - Avg. fwd time: 35.0025 / Avg. bwd time: 55.2757 / Avg. batch time: 1835.1187 (ms) / GPU bubble ratio: 60.64%
[rank1]:2025-10-23 21:45:05,632 - INFO - Avg. fwd time: 55.3326 / Avg. bwd time: 74.1854 / Avg. batch time: 1958.0897 (ms) / GPU bubble ratio: 47.08%
[rank0]:2025-10-23 21:45:05,704 - INFO - Avg. fwd time: 48.0441 / Avg. bwd time: 61.1724 / Avg. batch time: 2058.2789 (ms) / GPU bubble ratio: 57.55%
[rank0]:2025-10-23 21:47:34,847 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-23 21:47:51,720 - INFO -  step: 1000  loss: -8.0000  grad_norm:  0.2657  memory: 16.10GiB(33.90%)  tps: 1,949  tflops: 15.24  mfu: 4.88%
[rank2]:2025-10-23 21:47:51,720 - INFO -  final step: 1000  loss: -8.0000  grad_norm:  0.2657  tps: 1,986  tflops: 15.52  mfu: 4.86%
[rank2]:2025-10-23 21:47:51,720 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-23 21:47:51,722 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1000.
[rank3]:2025-10-23 21:47:51,733 - INFO -  step: 1000  loss:  1.7249  grad_norm:  0.2657  memory: 38.93GiB(81.95%)  tps: 1,949  tflops: 15.24  mfu: 4.88%
[rank3]:2025-10-23 21:47:51,733 - INFO -  final step: 1000  loss:  1.7249  grad_norm:  0.2657  tps: 1,986  tflops: 15.53  mfu: 4.86%
[rank3]:2025-10-23 21:47:51,734 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-23 21:47:51,736 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1000.
[rank1]:2025-10-23 21:47:51,724 - INFO -  step: 1000  loss: -8.0000  grad_norm:  0.2657  memory: 20.03GiB(42.17%)  tps: 1,949  tflops: 15.24  mfu: 4.88%
[rank1]:2025-10-23 21:47:51,724 - INFO -  final step: 1000  loss: -8.0000  grad_norm:  0.2657  tps: 1,986  tflops: 15.52  mfu: 4.86%
[rank1]:2025-10-23 21:47:51,724 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-23 21:47:51,726 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1000.
[rank0]:2025-10-23 21:47:51,739 - INFO -  step: 1000  loss: -8.0000  grad_norm:  0.2657  memory: 20.89GiB(43.97%)  tps: 1,949  tflops: 15.24  mfu: 4.88%
[rank0]:2025-10-23 21:47:51,740 - INFO -  final step: 1000  loss: -8.0000  grad_norm:  0.2657  tps: 1,986  tflops: 15.52  mfu: 4.86%
[rank0]:2025-10-23 21:47:51,740 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-23 21:47:51,742 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1000.
[rank1]:2025-10-23 21:47:54,542 - INFO - Destroying the purge thread.
[rank0]:2025-10-23 21:47:54,521 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-23 21:47:54,542 - INFO - Sleeping 2 seconds for other ranks to complete
[rank2]:2025-10-23 21:47:54,542 - INFO - Destroying the purge thread.
[rank3]:2025-10-23 21:47:54,811 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_gpipe_nofreeze_dm1/pipeline_schedule/251023_2147_real_final1000_rank3.svg
[rank3]:> Batch Time: 2005.91 ms, GPU Bubble Ratio: 56.57%, 47.92%, 64.39%, 15.74%
[rank3]:2025-10-23 21:47:55,077 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_gpipe_nofreeze_dm1/pipeline_schedule/251023_2147_thry_final1000_rank3.svg
[rank3]:> Batch Time: 1769.98 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:2025-10-23 21:47:55,078 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank1]:2025-10-23 21:47:55,363 - INFO - Process group destroyed
[rank2]:2025-10-23 21:47:55,364 - INFO - Process group destroyed
[rank3]:wandb: uploading history steps 50-50, summary, console lines 347-351
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–â–â–â–â–‚â–â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–…â–„â–ƒâ–ƒâ–„â–ƒâ–„â–ƒâ–„â–ƒâ–ƒâ–ƒâ–„â–ƒâ–ƒâ–ƒâ–‚â–‚â–‚â–‚â–‚â–ƒâ–‚â–‚â–‚â–â–‚â–‚â–‚â–â–‚â–â–â–â–â–‚â–‚â–‚â–‚
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–…â–„â–„â–ƒâ–„â–ƒâ–„â–ƒâ–„â–ƒâ–ƒâ–ƒâ–„â–ƒâ–ƒâ–ƒâ–‚â–‚â–‚â–ƒâ–‚â–‚â–‚â–ƒâ–‚â–â–‚â–‚â–‚â–â–‚â–â–â–â–â–‚â–‚â–‚â–‚
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 16.49968
[rank3]:wandb:               final/avg_loss 1.72489
[rank3]:wandb:             final/avg_mfu(%) 4.86374
[rank3]:wandb:             final/avg_tflops 15.52546
[rank3]:wandb:    final/avg_throughput(tps) 1985.97815
[rank3]:wandb:              final/grad_norm 0.26574
[rank3]:wandb:               final/max_loss 1.72489
[rank3]:wandb:                    grad_norm 0.26574
[rank3]:wandb: loss_metrics/global_avg_loss 1.72489
[rank3]:wandb: loss_metrics/global_max_loss 1.72489
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1023_gpipe_nofreeze_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/mpfq2x3v
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1023_gpipe_nofreeze_dm1/20251023-1707/wandb/run-20251023_170720-mpfq2x3v/logs
[rank3]:2025-10-23 21:47:56,425 - INFO - Process group destroyed
[rank0]:2025-10-23 21:47:56,543 - INFO - Training completed
[rank0]:2025-10-23 21:47:56,543 - INFO - Destroying the purge thread.
[rank0]:2025-10-23 21:47:57,274 - INFO - Process group destroyed
[rank2]:Stage 2: Modules to keep: {'layers.11', 'layers.12', 'layers.10', 'layers.9'}
[rank0]:Stage 0: Modules to keep: {'layers.3', 'tok_embeddings', 'layers.2', 'layers.1', 'layers.0'}
[rank1]:Stage 1: Modules to keep: {'layers.8', 'layers.5', 'layers.4', 'layers.6', 'layers.7'}
[rank3]:Stage 3: Modules to keep: {'layers.13', 'norm', 'layers.15', 'output', 'layers.14'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1022_llama1binstruct/config.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1023_gpipe_nofreeze_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: profile_trace/1023_gpipe_nofreeze_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: memory_snapshot/1023_gpipe_nofreeze_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 20
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: tb/1023_gpipe_nofreeze_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- pplog_freq: 80
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1023_gpipe_nofreeze_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B-Instruct
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 5e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: slimorca
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 128
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 1000
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: gpipe
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- folder: checkpoint/1023_gpipe_nofreeze_dm1
[rank3]:		- interval: 500
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B-Instruct/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: comm_traces/1023_gpipe_nofreeze_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 8
[rank3]:		- seq_len: 2048
[rank3]:		- freq: 10
[rank3]:		- steps: -1
[rank3]:	- freezing:
[rank3]:		- freeze: False
[rank3]:		- metric_type: apf
[rank3]:		- phase_unit: 10
[rank3]:		- stability_check_freq: 5
[rank3]:		- aggressiveness: 0
[rank3]:
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
