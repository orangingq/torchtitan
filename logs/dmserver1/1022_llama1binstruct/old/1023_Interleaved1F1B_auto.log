
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 10. 25. (í† ) 10:54:57 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 3,4,5,6
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1022_llama1binstruct/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1022_llama1binstruct/1023_Interleaved1F1B_auto.log
âœ”ï¸Main Table Experiment
âœ”ï¸Running with auto x Interleaved1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1022_llama1binstruct/config.toml --job.description="Main Table Experiment" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=auto
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank3]:2025-10-25 10:55:03,974 - INFO - Starting job: "Main Table Experiment"
[rank1]:2025-10-25 10:55:04,003 - INFO - Starting job: "Main Table Experiment"
[rank0]:2025-10-25 10:55:04,128 - INFO - Starting job: "Main Table Experiment"
[rank2]:2025-10-25 10:55:04,184 - INFO - Starting job: "Main Table Experiment"
[rank3]:2025-10-25 10:55:04,220 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-10-25 10:55:04,223 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-10-25 10:55:04,230 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-10-25 10:55:04,232 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-25 10:55:04,358 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-10-25 10:55:04,361 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-25 10:55:04,365 - INFO - [GC] Initial GC collection 0.00 seconds
[rank2]:2025-10-25 10:55:04,401 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-10-25 10:55:04,404 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-25 10:55:04,737 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-10-25 10:55:05,183 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank0]:2025-10-25 10:55:08,000 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank0]:2025-10-25 10:55:08,167 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-10-25 10:55:08,232 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-10-25 10:55:08,265 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-10-25 10:55:08,289 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.5', 'layers.6']
[rank2]:2025-10-25 10:55:08,301 - INFO - PP rank 2 is building stage_idx 6 with modules ['layers.13', 'layers.14']
[rank0]:2025-10-25 10:55:08,208 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-10-25 10:55:08,209 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-10-25 10:55:08,235 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1']
[rank0]:2025-10-25 10:55:08,248 - INFO - PP rank 0 is building stage_idx 4 with modules ['layers.9', 'layers.10']
[rank0]:2025-10-25 10:55:08,249 - INFO - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank2]:2025-10-25 10:55:08,302 - INFO - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank1]:2025-10-25 10:55:08,363 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-10-25 10:55:08,400 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-10-25 10:55:08,477 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-10-25 10:55:08,478 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-10-25 10:55:08,478 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank0]:2025-10-25 10:55:08,428 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-10-25 10:55:08,429 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-10-25 10:55:08,429 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank1]:2025-10-25 10:55:08,426 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.2', 'layers.3', 'layers.4']
[rank1]:2025-10-25 10:55:08,439 - INFO - PP rank 1 is building stage_idx 5 with modules ['layers.11', 'layers.12']
[rank1]:2025-10-25 10:55:08,440 - INFO - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank1]:2025-10-25 10:55:09,275 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-10-25 10:55:09,275 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-10-25 10:55:09,283 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank3]:wandb: setting up run n5mjqg9n
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1023_Interleaved1F1B_auto_dm1/20251025-1055/wandb/run-20251025_105509-n5mjqg9n
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1023_Interleaved1F1B_auto_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/n5mjqg9n
[rank3]:2025-10-25 10:55:10,345 - INFO - WandB logging enabled
[rank3]:2025-10-25 10:55:10,346 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-10-25 10:55:10,386 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-10-25 10:55:10,416 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.7', 'layers.8']
[rank3]:2025-10-25 10:55:10,429 - INFO - PP rank 3 is building stage_idx 7 with modules ['layers.15', 'norm', 'output']
[rank3]:2025-10-25 10:55:10,431 - INFO - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank0]:2025-10-25 10:55:11,241 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1023_Interleaved1F1B_auto_dm1
[rank0]:2025-10-25 10:55:11,242 - WARNING - Mixed precision training with TP or PP is only supported when FSDP/HSDP/CP is enabled.
[rank0]:2025-10-25 10:55:11,242 - INFO - Mixed precision training is disabled
[rank0]:2025-10-25 10:55:11,242 - INFO - Trainer is initialized with local batch size 16, global batch size 64, gradient accumulation steps 4, sequence length 1024, total steps 2000 (warmup 100)
[rank0]:2025-10-25 10:55:11,242 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B-Instruct/original_dcp.
[rank3]:2025-10-25 10:55:11,224 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-10-25 10:55:11,225 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-10-25 10:55:11,226 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank0]:2025-10-25 10:55:13,355 - INFO - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-10-25 10:55:13,355 - INFO - Finished loading the checkpoint in 2.11 seconds.
[rank0]:2025-10-25 10:55:13,355 - INFO - Training starts at step 1
[rank0]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/autograd/graph.py:849: UserWarning: Attempting to run cuBLAS, but there was no current CUDA context! Attempting to set the primary context... (Triggered internally at /pytorch/aten/src/ATen/cuda/CublasHandlePool.cpp:270.)
[rank0]:  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
[rank2]:2025-10-25 10:55:22,865 - INFO -  step:  1  loss: -4.0000  grad_norm:  3.4827  memory:  7.99GiB(16.83%)  tps: 1,122  tflops: 8.77  mfu: 2.81%
[rank2]:2025-10-25 10:55:22,865 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-25 10:55:22,878 - INFO -  step:  1  loss:  1.7854  grad_norm:  3.4827  memory: 23.89GiB(50.29%)  tps: 1,312  tflops: 10.26  mfu: 3.29%
[rank3]:2025-10-25 10:55:22,878 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-10-25 10:55:22,868 - INFO -  step:  1  loss: -4.0000  grad_norm:  3.4827  memory: 12.88GiB(27.11%)  tps: 1,132  tflops: 8.85  mfu: 2.84%
[rank1]:2025-10-25 10:55:22,868 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-10-25 10:55:22,901 - INFO -  step:  1  loss: -4.0000  grad_norm:  3.4827  memory: 13.74GiB(28.92%)  tps: 1,115  tflops: 8.72  mfu: 2.79%
[rank0]:2025-10-25 10:55:22,901 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-25 10:55:37,657 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-25 10:55:37,658 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-25 10:55:37,659 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-25 10:55:37,659 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-25 10:55:37,659 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-25 10:55:37,659 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-25 10:55:37,660 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-25 10:55:37,660 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-25 10:55:37,660 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 10:55:37,717 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 10:55:37,717 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 10:55:37,717 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 10:55:37,717 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-25 10:55:37,660 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-25 10:55:37,660 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 10:55:37,717 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-25 10:55:37,661 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-25 10:55:37,661 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-25 10:55:37,661 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-25 10:55:37,661 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-25 10:55:37,662 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-25 10:55:37,662 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-25 10:55:37,662 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-25 10:55:37,662 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-25 10:55:37,663 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-25 10:55:37,663 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-25 10:55:37,663 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-25 10:55:37,663 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-25 10:55:37,663 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-25 10:55:37,664 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-25 10:55:37,664 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-25 10:55:37,664 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-25 10:55:37,664 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-25 10:55:37,665 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-25 10:55:37,665 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-25 10:55:37,665 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-25 10:55:37,665 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 10:55:37,717 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 10:55:37,717 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 10:55:37,717 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 10:55:37,717 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 10:55:37,717 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 10:55:37,717 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 10:55:37,718 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 10:55:37,718 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 10:55:37,718 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 10:55:37,718 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 10:55:37,718 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 10:55:37,718 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 10:55:37,718 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 10:55:37,718 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 10:55:37,718 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 10:55:37,718 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 10:55:37,718 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 10:55:37,718 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 10:55:37,718 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 10:55:37,718 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 10:55:37,718 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 10:55:37,718 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 10:55:37,718 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 10:55:37,718 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 10:55:37,718 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 10:55:37,718 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 10:55:37,718 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 10:55:37,833 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 10:55:37,833 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 10:55:37,833 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 10:55:37,833 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 10:55:37,833 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 10:55:37,833 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 10:55:37,834 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 10:55:37,834 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 10:55:37,834 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 10:55:37,834 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 10:55:37,834 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 10:55:37,834 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 10:55:37,834 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 10:55:37,834 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 10:55:37,834 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 10:55:37,834 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 10:55:37,834 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 10:55:37,834 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 10:55:37,834 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 10:55:37,834 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 10:55:37,834 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 10:55:37,834 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 10:55:37,834 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 10:55:37,834 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 10:55:37,835 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 10:55:37,835 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 10:55:37,835 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 10:55:37,835 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 10:55:37,835 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 10:55:37,835 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 10:55:37,835 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 10:55:37,835 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-25 10:55:37,796 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-25 10:55:37,796 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-25 10:55:37,796 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-25 10:55:37,796 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-25 10:55:37,796 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-25 10:55:37,796 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-25 10:55:37,796 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-25 10:55:37,796 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-25 10:55:37,796 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-25 10:55:37,796 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-25 10:55:37,796 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-25 10:55:37,796 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-25 10:55:37,796 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-25 10:55:37,797 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-25 10:55:37,797 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-25 10:55:37,797 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-25 10:55:37,797 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-25 10:55:37,797 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-25 10:55:37,797 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-25 10:55:37,797 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-25 10:55:37,797 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-25 10:55:37,797 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-25 10:55:37,797 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-25 10:55:37,797 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-25 10:55:37,797 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-25 10:55:37,797 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-25 10:55:37,797 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-25 10:55:37,797 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-25 10:55:37,797 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-25 10:55:37,797 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-25 10:55:37,797 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-25 10:55:37,797 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 10:58:07,083 - INFO -  step: 20  loss: -4.0000  grad_norm:  1.4899  memory: 17.51GiB(36.85%)  tps: 1,896  tflops: 14.82  mfu: 4.75%
[rank3]:2025-10-25 10:58:07,080 - INFO -  step: 20  loss:  1.3862  grad_norm:  1.4899  memory: 26.71GiB(56.21%)  tps: 1,896  tflops: 14.82  mfu: 4.75%
[rank2]:2025-10-25 10:58:07,068 - INFO -  step: 20  loss: -4.0000  grad_norm:  1.4899  memory:  9.81GiB(20.65%)  tps: 1,896  tflops: 14.82  mfu: 4.75%
[rank1]:2025-10-25 10:58:07,071 - INFO -  step: 20  loss: -4.0000  grad_norm:  1.4899  memory: 15.15GiB(31.88%)  tps: 1,896  tflops: 14.82  mfu: 4.75%
[rank3]:2025-10-25 10:58:09,041 - INFO - Avg. fwd time: 32.8701 / Avg. bwd time: 69.6233 / Avg. batch time: 1878.8608 (ms) / GPU bubble ratio: 12.72%
[rank2]:2025-10-25 10:58:09,098 - INFO - Avg. fwd time: 17.1317 / Avg. bwd time: 28.1130 / Avg. batch time: 1949.6990 (ms) / GPU bubble ratio: 62.87%
[rank0]:2025-10-25 10:58:09,215 - INFO - Avg. fwd time: 19.1449 / Avg. bwd time: 31.2760 / Avg. batch time: 2108.2709 (ms) / GPU bubble ratio: 61.73%
[rank1]:2025-10-25 10:58:09,178 - INFO - Avg. fwd time: 22.4219 / Avg. bwd time: 40.4930 / Avg. batch time: 2054.4477 (ms) / GPU bubble ratio: 51.00%
[rank2]:2025-10-25 11:01:01,032 - INFO -  step: 40  loss: -4.0000  grad_norm:  2.1309  memory:  9.81GiB(20.65%)  tps: 1,884  tflops: 14.73  mfu: 4.72%
[rank0]:2025-10-25 11:01:01,047 - INFO -  step: 40  loss: -4.0000  grad_norm:  2.1309  memory: 17.51GiB(36.85%)  tps: 1,884  tflops: 14.73  mfu: 4.72%
[rank3]:2025-10-25 11:01:01,044 - INFO -  step: 40  loss:  1.2757  grad_norm:  2.1309  memory: 26.71GiB(56.21%)  tps: 1,884  tflops: 14.73  mfu: 4.72%
[rank1]:2025-10-25 11:01:01,036 - INFO -  step: 40  loss: -4.0000  grad_norm:  2.1309  memory: 15.15GiB(31.88%)  tps: 1,884  tflops: 14.73  mfu: 4.72%
[rank3]:2025-10-25 11:01:03,063 - INFO - Avg. fwd time: 33.3185 / Avg. bwd time: 70.3794 / Avg. batch time: 1888.4656 (ms) / GPU bubble ratio: 12.14%
[rank2]:2025-10-25 11:01:03,123 - INFO - Avg. fwd time: 17.2819 / Avg. bwd time: 28.3668 / Avg. batch time: 1958.9423 (ms) / GPU bubble ratio: 62.72%
[rank0]:2025-10-25 11:01:03,245 - INFO - Avg. fwd time: 19.3528 / Avg. bwd time: 31.6151 / Avg. batch time: 2117.9478 (ms) / GPU bubble ratio: 61.50%
[rank1]:2025-10-25 11:01:03,206 - INFO - Avg. fwd time: 22.6711 / Avg. bwd time: 40.8538 / Avg. batch time: 2064.0968 (ms) / GPU bubble ratio: 50.76%
[rank0]:2025-10-25 11:02:19,386 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-25 11:03:55,153 - INFO -  step: 60  loss: -4.0000  grad_norm:  0.5366  memory: 17.51GiB(36.85%)  tps: 1,882  tflops: 14.71  mfu: 4.72%
[rank2]:2025-10-25 11:03:55,138 - INFO -  step: 60  loss: -4.0000  grad_norm:  0.5366  memory:  9.81GiB(20.65%)  tps: 1,882  tflops: 14.71  mfu: 4.72%
[rank1]:2025-10-25 11:03:55,141 - INFO -  step: 60  loss: -4.0000  grad_norm:  0.5366  memory: 15.15GiB(31.88%)  tps: 1,882  tflops: 14.71  mfu: 4.72%
[rank3]:2025-10-25 11:03:55,149 - INFO -  step: 60  loss:  1.2100  grad_norm:  0.5366  memory: 26.71GiB(56.21%)  tps: 1,882  tflops: 14.71  mfu: 4.72%
[rank3]:2025-10-25 11:03:57,150 - INFO - Avg. fwd time: 33.4495 / Avg. bwd time: 70.6245 / Avg. batch time: 1891.1322 (ms) / GPU bubble ratio: 11.95%
[rank2]:2025-10-25 11:03:57,206 - INFO - Avg. fwd time: 17.3268 / Avg. bwd time: 28.3976 / Avg. batch time: 1961.7437 (ms) / GPU bubble ratio: 62.71%
[rank1]:2025-10-25 11:03:57,280 - INFO - Avg. fwd time: 22.7400 / Avg. bwd time: 40.9465 / Avg. batch time: 2067.2678 (ms) / GPU bubble ratio: 50.71%
[rank0]:2025-10-25 11:03:57,317 - INFO - Avg. fwd time: 19.4260 / Avg. bwd time: 31.6792 / Avg. batch time: 2121.1061 (ms) / GPU bubble ratio: 61.45%
[rank1]:2025-10-25 11:06:48,829 - INFO -  step: 80  loss: -4.0000  grad_norm:  0.5012  memory: 15.15GiB(31.88%)  tps: 1,887  tflops: 14.75  mfu: 4.73%
[rank0]:2025-10-25 11:06:48,839 - INFO -  step: 80  loss: -4.0000  grad_norm:  0.5012  memory: 17.51GiB(36.85%)  tps: 1,887  tflops: 14.75  mfu: 4.73%
[rank2]:2025-10-25 11:06:48,824 - INFO -  step: 80  loss: -4.0000  grad_norm:  0.5012  memory:  9.81GiB(20.65%)  tps: 1,887  tflops: 14.75  mfu: 4.73%
[rank3]:2025-10-25 11:06:48,836 - INFO -  step: 80  loss:  1.1799  grad_norm:  0.5012  memory: 26.71GiB(56.21%)  tps: 1,887  tflops: 14.75  mfu: 4.73%
[rank2]:2025-10-25 11:06:50,909 - INFO - Avg. fwd time: 17.3497 / Avg. bwd time: 28.4184 / Avg. batch time: 1961.8804 (ms) / GPU bubble ratio: 62.67%
[rank3]:2025-10-25 11:06:50,853 - INFO - Avg. fwd time: 33.4876 / Avg. bwd time: 70.7089 / Avg. batch time: 1891.3369 (ms) / GPU bubble ratio: 11.85%
[rank1]:2025-10-25 11:06:50,992 - INFO - Avg. fwd time: 22.7636 / Avg. bwd time: 41.0104 / Avg. batch time: 2067.4945 (ms) / GPU bubble ratio: 50.65%
[rank0]:2025-10-25 11:06:51,033 - INFO - Avg. fwd time: 19.4468 / Avg. bwd time: 31.7380 / Avg. batch time: 2121.3772 (ms) / GPU bubble ratio: 61.40%
[rank3]:2025-10-25 11:07:07,411 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 11:07:08,315 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 11:07:08,409 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 11:07:08,371 - WARNING - Dataset alpaca is being re-looped
[rank3]:2025-10-25 11:08:16,269 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_auto_dm1/pipeline_schedule/251025_1108_real_warmupend90_rank3.svg
[rank3]:> Batch Time: 1907.98 ms, GPU Bubble Ratio: 56.75%, 46.66%, 61.75%, 12.17%
[rank1]:2025-10-25 11:08:59,793 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 0.0000e+00
[rank3]:2025-10-25 11:08:59,795 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 0.0000e+00
[rank0]:2025-10-25 11:08:59,804 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 0.0000e+00
[rank2]:2025-10-25 11:08:59,784 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 0.0000e+00
[rank0]:2025-10-25 11:09:34,672 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-25 11:09:43,380 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 3.6054e-01
[rank0]:2025-10-25 11:09:43,380 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.4903  memory: 17.51GiB(36.85%)  tps: 1,877  tflops: 14.68  mfu: 4.70%
[rank2]:2025-10-25 11:09:43,364 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 5.3748e-01
[rank2]:2025-10-25 11:09:43,364 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.4903  memory:  9.81GiB(20.65%)  tps: 1,877  tflops: 14.68  mfu: 4.70%
[rank1]:2025-10-25 11:09:43,369 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 5.1958e-01
[rank1]:2025-10-25 11:09:43,369 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.4903  memory: 15.15GiB(31.88%)  tps: 1,877  tflops: 14.68  mfu: 4.70%
[rank3]:2025-10-25 11:09:43,375 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 4.9353e-01
[rank3]:2025-10-25 11:09:43,377 - INFO -  step: 100  loss:  1.1786  grad_norm:  0.4903  memory: 26.71GiB(56.21%)  tps: 1,877  tflops: 14.68  mfu: 4.70%
[rank0]:2025-10-25 11:09:43,454 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_auto_dm1/freeze_ratio_history/rank0/251025_1109_stage0_step100.svg
[rank0]:2025-10-25 11:09:43,505 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_auto_dm1/freeze_ratio_history/rank0/251025_1109_stage4_step100.svg
[rank2]:2025-10-25 11:09:43,455 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_auto_dm1/freeze_ratio_history/rank2/251025_1109_stage2_step100.svg
[rank2]:2025-10-25 11:09:43,506 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_auto_dm1/freeze_ratio_history/rank2/251025_1109_stage6_step100.svg
[rank1]:2025-10-25 11:09:43,455 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_auto_dm1/freeze_ratio_history/rank1/251025_1109_stage1_step100.svg
[rank1]:2025-10-25 11:09:43,508 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_auto_dm1/freeze_ratio_history/rank1/251025_1109_stage5_step100.svg
[rank3]:2025-10-25 11:09:43,737 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_auto_dm1/pipeline_schedule/251025_1109_real_step100_rank3.svg
[rank3]:> Batch Time: 1908.16 ms, GPU Bubble Ratio: 56.75%, 46.56%, 61.74%, 12.19%
[rank3]:2025-10-25 11:09:43,792 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_auto_dm1/freeze_ratio_history/rank3/251025_1109_stage3_step100.svg
[rank3]:2025-10-25 11:09:43,844 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_auto_dm1/freeze_ratio_history/rank3/251025_1109_stage7_step100.svg
[rank3]:2025-10-25 11:09:45,798 - INFO - Avg. fwd time: 33.5376 / Avg. bwd time: 70.7994 / Avg. batch time: 1892.6022 (ms) / GPU bubble ratio: 11.79%
[rank2]:2025-10-25 11:09:45,858 - INFO - Avg. fwd time: 17.3717 / Avg. bwd time: 28.4451 / Avg. batch time: 1964.6311 (ms) / GPU bubble ratio: 62.69%
[rank1]:2025-10-25 11:09:45,940 - INFO - Avg. fwd time: 22.7858 / Avg. bwd time: 41.1226 / Avg. batch time: 2070.4183 (ms) / GPU bubble ratio: 50.61%
[rank0]:2025-10-25 11:09:45,979 - INFO - Avg. fwd time: 19.4768 / Avg. bwd time: 31.7547 / Avg. batch time: 2124.2538 (ms) / GPU bubble ratio: 61.41%
[rank2]:2025-10-25 11:10:27,381 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 8.5722e-01
[rank1]:2025-10-25 11:10:27,391 - INFO - Freezing Ratio: [Stage1] 0.33, [Stage5] 0.00, Threshold: 7.9297e-01
[rank3]:2025-10-25 11:10:27,392 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 4.5852e-01
[rank0]:2025-10-25 11:10:27,397 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 7.2631e-01
[rank3]:2025-10-25 11:11:09,581 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 4.7456e-01
[rank0]:2025-10-25 11:11:09,591 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 2.8001e-01
[rank2]:2025-10-25 11:11:09,566 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 5.4125e-01
[rank1]:2025-10-25 11:11:09,574 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 5.2209e-01
[rank3]:2025-10-25 11:11:53,030 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 2.5938e-01
[rank0]:2025-10-25 11:11:53,027 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 2.0399e-01
[rank2]:2025-10-25 11:11:53,019 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 1.9580e-01
[rank1]:2025-10-25 11:11:53,029 - INFO - Freezing Ratio: [Stage1] 0.33, [Stage5] 0.00, Threshold: 4.5400e-01
[rank2]:2025-10-25 11:12:35,032 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 4.5764e-01
[rank2]:2025-10-25 11:12:35,033 - INFO -  step: 120  loss: -4.0000  grad_norm:  0.4351  memory:  9.81GiB(20.65%)  tps: 1,909  tflops: 14.92  mfu: 4.78%
[rank1]:2025-10-25 11:12:35,046 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 5.1969e-01
[rank1]:2025-10-25 11:12:35,046 - INFO -  step: 120  loss: -4.0000  grad_norm:  0.4351  memory: 15.15GiB(31.88%)  tps: 1,909  tflops: 14.92  mfu: 4.78%
[rank3]:2025-10-25 11:12:35,084 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 3.2987e-01
[rank3]:2025-10-25 11:12:35,086 - INFO -  step: 120  loss:  1.1278  grad_norm:  0.4351  memory: 26.78GiB(56.38%)  tps: 1,908  tflops: 14.92  mfu: 4.78%
[rank0]:2025-10-25 11:12:35,056 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 1.1216e-01
[rank0]:2025-10-25 11:12:35,056 - INFO -  step: 120  loss: -4.0000  grad_norm:  0.4351  memory: 17.51GiB(36.85%)  tps: 1,909  tflops: 14.92  mfu: 4.78%
[rank3]:2025-10-25 11:12:37,025 - INFO - Avg. fwd time: 33.5751 / Avg. bwd time: 70.4952 / Avg. batch time: 1887.8080 (ms) / GPU bubble ratio: 11.80%
[rank2]:2025-10-25 11:12:37,083 - INFO - Avg. fwd time: 17.3629 / Avg. bwd time: 27.8673 / Avg. batch time: 1959.6634 (ms) / GPU bubble ratio: 63.07%
[rank1]:2025-10-25 11:12:37,162 - INFO - Avg. fwd time: 22.8239 / Avg. bwd time: 40.9050 / Avg. batch time: 2065.2836 (ms) / GPU bubble ratio: 50.63%
[rank0]:2025-10-25 11:12:37,187 - INFO - Avg. fwd time: 19.4840 / Avg. bwd time: 31.5253 / Avg. batch time: 2118.6363 (ms) / GPU bubble ratio: 61.48%
[rank0]:2025-10-25 11:13:18,390 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 3.9337e-01
[rank2]:2025-10-25 11:13:18,382 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 2.0536e-01
[rank1]:2025-10-25 11:13:18,387 - INFO - Freezing Ratio: [Stage1] 0.33, [Stage5] 0.00, Threshold: 4.7868e-01
[rank3]:2025-10-25 11:13:18,393 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 2.2241e-01
[rank2]:2025-10-25 11:14:00,444 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 4.8896e-01
[rank1]:2025-10-25 11:14:00,452 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 2.9882e-01
[rank3]:2025-10-25 11:14:00,459 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 2.0342e-01
[rank0]:2025-10-25 11:14:00,468 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 7.3508e-02
[rank0]:2025-10-25 11:14:43,901 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 2.1411e-01
[rank2]:2025-10-25 11:14:43,893 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 1.2980e-01
[rank1]:2025-10-25 11:14:43,898 - INFO - Freezing Ratio: [Stage1] 0.33, [Stage5] 0.00, Threshold: 1.9784e-01
[rank3]:2025-10-25 11:14:43,905 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 1.1890e-01
[rank2]:2025-10-25 11:15:25,947 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 2.9315e-01
[rank2]:2025-10-25 11:15:25,947 - INFO -  step: 140  loss: -4.0000  grad_norm:  0.4123  memory:  9.81GiB(20.65%)  tps: 1,917  tflops: 14.99  mfu: 4.80%
[rank1]:2025-10-25 11:15:25,955 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 5.0646e-01
[rank1]:2025-10-25 11:15:25,955 - INFO -  step: 140  loss: -4.0000  grad_norm:  0.4123  memory: 15.15GiB(31.88%)  tps: 1,917  tflops: 14.99  mfu: 4.80%
[rank3]:2025-10-25 11:15:25,962 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 2.6865e-01
[rank3]:2025-10-25 11:15:25,965 - INFO -  step: 140  loss:  1.1513  grad_norm:  0.4123  memory: 26.78GiB(56.38%)  tps: 1,918  tflops: 14.99  mfu: 4.80%
[rank0]:2025-10-25 11:15:25,974 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 4.1898e-02
[rank0]:2025-10-25 11:15:25,974 - INFO -  step: 140  loss: -4.0000  grad_norm:  0.4123  memory: 17.51GiB(36.85%)  tps: 1,917  tflops: 14.99  mfu: 4.80%
[rank3]:2025-10-25 11:15:27,994 - INFO - Avg. fwd time: 33.5982 / Avg. bwd time: 70.2942 / Avg. batch time: 1884.4893 (ms) / GPU bubble ratio: 11.79%
[rank2]:2025-10-25 11:15:28,053 - INFO - Avg. fwd time: 17.3504 / Avg. bwd time: 27.4427 / Avg. batch time: 1956.1350 (ms) / GPU bubble ratio: 63.36%
[rank0]:2025-10-25 11:15:28,160 - INFO - Avg. fwd time: 19.5185 / Avg. bwd time: 31.1309 / Avg. batch time: 2114.2343 (ms) / GPU bubble ratio: 61.67%
[rank1]:2025-10-25 11:15:28,136 - INFO - Avg. fwd time: 22.8576 / Avg. bwd time: 40.7276 / Avg. batch time: 2061.6742 (ms) / GPU bubble ratio: 50.65%
[rank2]:2025-10-25 11:16:09,418 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 1.6449e-01
[rank1]:2025-10-25 11:16:09,428 - INFO - Freezing Ratio: [Stage1] 0.33, [Stage5] 0.00, Threshold: 2.8737e-01
[rank3]:2025-10-25 11:16:09,430 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 2.6741e-01
[rank0]:2025-10-25 11:16:09,426 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 2.9746e-01
[rank0]:2025-10-25 11:16:43,151 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-25 11:16:51,612 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 2.9088e-01
[rank3]:2025-10-25 11:16:51,619 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 2.6592e-01
[rank0]:2025-10-25 11:16:51,629 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 1.0267e-01
[rank2]:2025-10-25 11:16:51,603 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 3.0240e-01
[rank2]:2025-10-25 11:17:35,053 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 2.5016e-01
[rank1]:2025-10-25 11:17:35,059 - INFO - Freezing Ratio: [Stage1] 0.33, [Stage5] 0.00, Threshold: 3.4531e-01
[rank3]:2025-10-25 11:17:35,065 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 2.2690e-01
[rank0]:2025-10-25 11:17:35,061 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 2.1877e-01
[rank0]:2025-10-25 11:18:17,365 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 9.6470e-02
[rank0]:2025-10-25 11:18:17,365 - INFO -  step: 160  loss: -4.0000  grad_norm:  0.4343  memory: 17.51GiB(36.85%)  tps: 1,912  tflops: 14.95  mfu: 4.79%
[rank2]:2025-10-25 11:18:17,338 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 5.6197e-01
[rank2]:2025-10-25 11:18:17,338 - INFO -  step: 160  loss: -4.0000  grad_norm:  0.4343  memory:  9.81GiB(20.65%)  tps: 1,912  tflops: 14.95  mfu: 4.79%
[rank1]:2025-10-25 11:18:17,346 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 4.9265e-01
[rank1]:2025-10-25 11:18:17,347 - INFO -  step: 160  loss: -4.0000  grad_norm:  0.4343  memory: 15.15GiB(31.88%)  tps: 1,912  tflops: 14.95  mfu: 4.79%
[rank3]:2025-10-25 11:18:17,354 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 2.9585e-01
[rank3]:2025-10-25 11:18:17,357 - INFO -  step: 160  loss:  1.1156  grad_norm:  0.4343  memory: 26.78GiB(56.38%)  tps: 1,912  tflops: 14.95  mfu: 4.79%
[rank3]:2025-10-25 11:18:19,393 - INFO - Avg. fwd time: 33.6347 / Avg. bwd time: 70.1766 / Avg. batch time: 1882.8316 (ms) / GPU bubble ratio: 11.78%
[rank2]:2025-10-25 11:18:19,439 - INFO - Avg. fwd time: 17.3505 / Avg. bwd time: 27.1515 / Avg. batch time: 1954.2479 (ms) / GPU bubble ratio: 63.56%
[rank1]:2025-10-25 11:18:19,515 - INFO - Avg. fwd time: 22.8507 / Avg. bwd time: 40.5530 / Avg. batch time: 2059.5730 (ms) / GPU bubble ratio: 50.74%
[rank0]:2025-10-25 11:18:19,540 - INFO - Avg. fwd time: 19.5257 / Avg. bwd time: 30.8279 / Avg. batch time: 2111.5282 (ms) / GPU bubble ratio: 61.84%
[rank3]:2025-10-25 11:18:55,469 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 11:18:56,372 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 11:18:56,429 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 11:18:56,449 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 11:19:00,810 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 3.5742e-01
[rank2]:2025-10-25 11:19:00,802 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 1.3175e-01
[rank1]:2025-10-25 11:19:00,809 - INFO - Freezing Ratio: [Stage1] 0.33, [Stage5] 0.00, Threshold: 2.4446e-01
[rank3]:2025-10-25 11:19:00,813 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 5.3481e-01
[rank2]:2025-10-25 11:19:43,006 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 2.2616e-01
[rank1]:2025-10-25 11:19:43,019 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 4.5680e-01
[rank3]:2025-10-25 11:19:43,021 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 2.9488e-01
[rank0]:2025-10-25 11:19:43,030 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 6.3818e-02
[rank0]:2025-10-25 11:20:26,428 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 1.0858e-01
[rank2]:2025-10-25 11:20:26,420 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 1.2735e-01
[rank1]:2025-10-25 11:20:26,429 - INFO - Freezing Ratio: [Stage1] 0.33, [Stage5] 0.00, Threshold: 2.1652e-01
[rank3]:2025-10-25 11:20:26,432 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 1.8015e-01
[rank2]:2025-10-25 11:21:08,660 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 4.9229e-01
[rank2]:2025-10-25 11:21:08,661 - INFO -  step: 180  loss: -4.0000  grad_norm:  0.4279  memory:  9.81GiB(20.65%)  tps: 1,913  tflops: 14.95  mfu: 4.79%
[rank1]:2025-10-25 11:21:08,675 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 7.6751e-01
[rank1]:2025-10-25 11:21:08,675 - INFO -  step: 180  loss: -4.0000  grad_norm:  0.4279  memory: 15.15GiB(31.88%)  tps: 1,913  tflops: 14.95  mfu: 4.79%
[rank0]:2025-10-25 11:21:08,684 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 2.1629e-01
[rank0]:2025-10-25 11:21:08,684 - INFO -  step: 180  loss: -4.0000  grad_norm:  0.4279  memory: 17.51GiB(36.85%)  tps: 1,913  tflops: 14.95  mfu: 4.79%
[rank3]:2025-10-25 11:21:08,683 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 5.3156e-01
[rank3]:2025-10-25 11:21:08,686 - INFO -  step: 180  loss:  1.0956  grad_norm:  0.4279  memory: 26.78GiB(56.38%)  tps: 1,913  tflops: 14.95  mfu: 4.79%
[rank3]:2025-10-25 11:21:10,712 - INFO - Avg. fwd time: 33.6664 / Avg. bwd time: 70.0806 / Avg. batch time: 1881.5690 (ms) / GPU bubble ratio: 11.78%
[rank2]:2025-10-25 11:21:10,768 - INFO - Avg. fwd time: 17.3508 / Avg. bwd time: 26.9282 / Avg. batch time: 1952.7385 (ms) / GPU bubble ratio: 63.72%
[rank1]:2025-10-25 11:21:10,850 - INFO - Avg. fwd time: 22.8606 / Avg. bwd time: 40.4299 / Avg. batch time: 2057.9141 (ms) / GPU bubble ratio: 50.79%
[rank0]:2025-10-25 11:21:10,875 - INFO - Avg. fwd time: 19.5289 / Avg. bwd time: 30.6140 / Avg. batch time: 2109.4130 (ms) / GPU bubble ratio: 61.97%
[rank1]:2025-10-25 11:21:52,093 - INFO - Freezing Ratio: [Stage1] 0.33, [Stage5] 0.00, Threshold: 4.6269e-01
[rank0]:2025-10-25 11:21:52,096 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 4.4228e-01
[rank3]:2025-10-25 11:21:52,099 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 1.8011e-01
[rank2]:2025-10-25 11:21:52,088 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 1.1672e-01
[rank2]:2025-10-25 11:22:34,232 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 4.0133e-01
[rank1]:2025-10-25 11:22:34,240 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 2.5811e-01
[rank0]:2025-10-25 11:22:34,257 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 1.1200e-01
[rank3]:2025-10-25 11:22:34,248 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 2.7658e-01
[rank2]:2025-10-25 11:23:17,550 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 1.5079e-01
[rank0]:2025-10-25 11:23:17,558 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 2.2672e-01
[rank1]:2025-10-25 11:23:17,560 - INFO - Freezing Ratio: [Stage1] 0.33, [Stage5] 0.00, Threshold: 4.4051e-01
[rank3]:2025-10-25 11:23:17,561 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 1.0398e-01
[rank0]:2025-10-25 11:23:51,140 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-25 11:23:59,571 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 1.5060e-01
[rank0]:2025-10-25 11:23:59,571 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.4106  memory: 17.51GiB(36.85%)  tps: 1,918  tflops: 14.99  mfu: 4.80%
[rank1]:2025-10-25 11:23:59,560 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 3.8209e-01
[rank1]:2025-10-25 11:23:59,560 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.4106  memory: 15.15GiB(31.88%)  tps: 1,918  tflops: 14.99  mfu: 4.80%
[rank3]:2025-10-25 11:23:59,563 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 3.9810e-01
[rank3]:2025-10-25 11:23:59,565 - INFO -  step: 200  loss:  1.1007  grad_norm:  0.4106  memory: 26.78GiB(56.38%)  tps: 1,918  tflops: 14.99  mfu: 4.80%
[rank2]:2025-10-25 11:23:59,547 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 6.8517e-01
[rank2]:2025-10-25 11:23:59,548 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.4106  memory:  9.81GiB(20.65%)  tps: 1,918  tflops: 14.99  mfu: 4.80%
[rank0]:2025-10-25 11:23:59,643 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_auto_dm1/freeze_ratio_history/rank0/251025_1123_stage0_step200.svg
[rank1]:2025-10-25 11:23:59,651 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_auto_dm1/freeze_ratio_history/rank1/251025_1123_stage1_step200.svg
[rank2]:2025-10-25 11:23:59,646 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_auto_dm1/freeze_ratio_history/rank2/251025_1123_stage2_step200.svg
[rank2]:2025-10-25 11:23:59,706 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_auto_dm1/freeze_ratio_history/rank2/251025_1123_stage6_step200.svg
[rank0]:2025-10-25 11:23:59,703 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_auto_dm1/freeze_ratio_history/rank0/251025_1123_stage4_step200.svg
[rank1]:2025-10-25 11:23:59,714 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_auto_dm1/freeze_ratio_history/rank1/251025_1123_stage5_step200.svg
[rank3]:2025-10-25 11:23:59,928 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_auto_dm1/pipeline_schedule/251025_1123_real_step200_rank3.svg
[rank3]:> Batch Time: 1906.58 ms, GPU Bubble Ratio: 56.70%, 46.80%, 61.97%, 12.01%
[rank3]:2025-10-25 11:23:59,994 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_auto_dm1/freeze_ratio_history/rank3/251025_1123_stage3_step200.svg
[rank3]:2025-10-25 11:24:00,055 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_auto_dm1/freeze_ratio_history/rank3/251025_1123_stage7_step200.svg
[rank3]:2025-10-25 11:24:02,007 - INFO - Avg. fwd time: 33.6771 / Avg. bwd time: 69.9835 / Avg. batch time: 1880.0288 (ms) / GPU bubble ratio: 11.78%
[rank2]:2025-10-25 11:24:02,057 - INFO - Avg. fwd time: 17.3422 / Avg. bwd time: 26.7348 / Avg. batch time: 1951.3834 (ms) / GPU bubble ratio: 63.86%
[rank0]:2025-10-25 11:24:02,158 - INFO - Avg. fwd time: 19.5480 / Avg. bwd time: 30.4439 / Avg. batch time: 2107.4758 (ms) / GPU bubble ratio: 62.05%
[rank1]:2025-10-25 11:24:02,133 - INFO - Avg. fwd time: 22.8629 / Avg. bwd time: 40.3248 / Avg. batch time: 2056.3730 (ms) / GPU bubble ratio: 50.84%
[rank2]:2025-10-25 11:24:43,389 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 1.1712e-01
[rank1]:2025-10-25 11:24:43,394 - INFO - Freezing Ratio: [Stage1] 0.33, [Stage5] 0.00, Threshold: 2.3152e-01
[rank0]:2025-10-25 11:24:43,398 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 2.8690e-01
[rank3]:2025-10-25 11:24:43,401 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 3.2758e-01
[rank1]:2025-10-25 11:25:25,369 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 2.7505e-01
[rank0]:2025-10-25 11:25:25,388 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 1.5192e-01
[rank3]:2025-10-25 11:25:25,377 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 3.3585e-01
[rank2]:2025-10-25 11:25:25,361 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 2.2079e-01
[rank0]:2025-10-25 11:26:08,630 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 2.5109e-01
[rank1]:2025-10-25 11:26:08,626 - INFO - Freezing Ratio: [Stage1] 0.33, [Stage5] 0.00, Threshold: 2.1351e-01
[rank3]:2025-10-25 11:26:08,633 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 2.1372e-01
[rank2]:2025-10-25 11:26:08,622 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 1.0997e-01
[rank3]:2025-10-25 11:26:50,723 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 2.5019e-01
[rank3]:2025-10-25 11:26:50,726 - INFO -  step: 220  loss:  1.0764  grad_norm:  0.4253  memory: 26.78GiB(56.38%)  tps: 1,914  tflops: 14.97  mfu: 4.80%
[rank2]:2025-10-25 11:26:50,708 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 3.3032e-01
[rank2]:2025-10-25 11:26:50,708 - INFO -  step: 220  loss: -4.0000  grad_norm:  0.4253  memory:  9.81GiB(20.65%)  tps: 1,914  tflops: 14.97  mfu: 4.80%
[rank1]:2025-10-25 11:26:50,718 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 3.6196e-01
[rank1]:2025-10-25 11:26:50,718 - INFO -  step: 220  loss: -4.0000  grad_norm:  0.4253  memory: 15.15GiB(31.88%)  tps: 1,914  tflops: 14.97  mfu: 4.80%
[rank0]:2025-10-25 11:26:50,732 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 5.4151e-02
[rank0]:2025-10-25 11:26:50,733 - INFO -  step: 220  loss: -4.0000  grad_norm:  0.4253  memory: 17.51GiB(36.85%)  tps: 1,914  tflops: 14.97  mfu: 4.80%
[rank3]:2025-10-25 11:26:52,744 - INFO - Avg. fwd time: 33.6851 / Avg. bwd time: 69.8961 / Avg. batch time: 1878.5562 (ms) / GPU bubble ratio: 11.78%
[rank2]:2025-10-25 11:26:52,791 - INFO - Avg. fwd time: 17.3335 / Avg. bwd time: 26.5720 / Avg. batch time: 1949.7172 (ms) / GPU bubble ratio: 63.97%
[rank1]:2025-10-25 11:26:52,870 - INFO - Avg. fwd time: 22.8627 / Avg. bwd time: 40.2285 / Avg. batch time: 2054.6498 (ms) / GPU bubble ratio: 50.87%
[rank0]:2025-10-25 11:26:52,896 - INFO - Avg. fwd time: 19.5505 / Avg. bwd time: 30.2946 / Avg. batch time: 2105.4604 (ms) / GPU bubble ratio: 62.12%
[rank3]:2025-10-25 11:27:34,077 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 2.3598e-01
[rank2]:2025-10-25 11:27:34,066 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 2.0213e-01
[rank0]:2025-10-25 11:27:34,073 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 2.3600e-01
[rank1]:2025-10-25 11:27:34,071 - INFO - Freezing Ratio: [Stage1] 0.33, [Stage5] 0.00, Threshold: 4.5790e-01
[rank2]:2025-10-25 11:28:16,151 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 3.2511e-01
[rank0]:2025-10-25 11:28:16,177 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 5.7850e-02
[rank1]:2025-10-25 11:28:16,159 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 6.6508e-01
[rank3]:2025-10-25 11:28:16,167 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 1.8051e-01
[rank0]:2025-10-25 11:28:59,627 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 1.8305e-01
[rank1]:2025-10-25 11:28:59,625 - INFO - Freezing Ratio: [Stage1] 0.33, [Stage5] 0.00, Threshold: 2.0148e-01
[rank2]:2025-10-25 11:28:59,619 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 8.8285e-02
[rank3]:2025-10-25 11:28:59,631 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 2.2449e-01
[rank1]:2025-10-25 11:29:41,815 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 1.9310e-01
[rank1]:2025-10-25 11:29:41,815 - INFO -  step: 240  loss: -4.0000  grad_norm:  0.4283  memory: 15.15GiB(31.88%)  tps: 1,915  tflops: 14.97  mfu: 4.80%
[rank2]:2025-10-25 11:29:41,807 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 1.7252e-01
[rank2]:2025-10-25 11:29:41,807 - INFO -  step: 240  loss: -4.0000  grad_norm:  0.4283  memory:  9.81GiB(20.65%)  tps: 1,915  tflops: 14.97  mfu: 4.80%
[rank3]:2025-10-25 11:29:41,822 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 1.8066e-01
[rank3]:2025-10-25 11:29:41,825 - INFO -  step: 240  loss:  1.0320  grad_norm:  0.4283  memory: 26.78GiB(56.38%)  tps: 1,915  tflops: 14.97  mfu: 4.80%
[rank0]:2025-10-25 11:29:41,837 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 7.0562e-02
[rank0]:2025-10-25 11:29:41,837 - INFO -  step: 240  loss: -4.0000  grad_norm:  0.4283  memory: 17.51GiB(36.85%)  tps: 1,915  tflops: 14.97  mfu: 4.80%
[rank3]:2025-10-25 11:29:43,861 - INFO - Avg. fwd time: 33.7000 / Avg. bwd time: 69.8483 / Avg. batch time: 1877.9572 (ms) / GPU bubble ratio: 11.78%
[rank2]:2025-10-25 11:29:43,907 - INFO - Avg. fwd time: 17.3310 / Avg. bwd time: 26.4507 / Avg. batch time: 1948.8438 (ms) / GPU bubble ratio: 64.06%
[rank0]:2025-10-25 11:29:44,011 - INFO - Avg. fwd time: 19.5602 / Avg. bwd time: 30.1740 / Avg. batch time: 2104.1618 (ms) / GPU bubble ratio: 62.18%
[rank1]:2025-10-25 11:29:43,985 - INFO - Avg. fwd time: 22.8679 / Avg. bwd time: 40.1470 / Avg. batch time: 2053.6144 (ms) / GPU bubble ratio: 50.90%
[rank1]:2025-10-25 11:30:25,183 - INFO - Freezing Ratio: [Stage1] 0.33, [Stage5] 0.00, Threshold: 2.0318e-01
[rank2]:2025-10-25 11:30:25,177 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 1.3840e-01
[rank3]:2025-10-25 11:30:25,189 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 2.2665e-01
[rank0]:2025-10-25 11:30:25,185 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 1.5453e-01
[rank3]:2025-10-25 11:30:38,996 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 11:30:39,898 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 11:30:39,983 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 11:30:39,947 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 11:30:58,867 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-25 11:31:07,331 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 3.1211e-01
[rank2]:2025-10-25 11:31:07,318 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 4.3389e-01
[rank3]:2025-10-25 11:31:07,334 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 2.6764e-01
[rank0]:2025-10-25 11:31:07,351 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 1.5777e-01
[rank2]:2025-10-25 11:31:50,609 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 2.4216e-01
[rank3]:2025-10-25 11:31:50,621 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 4.8466e-01
[rank0]:2025-10-25 11:31:50,617 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 4.4180e-01
[rank1]:2025-10-25 11:31:50,617 - INFO - Freezing Ratio: [Stage1] 0.33, [Stage5] 0.00, Threshold: 3.2141e-01
[rank2]:2025-10-25 11:32:32,689 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 4.4166e-01
[rank2]:2025-10-25 11:32:32,689 - INFO -  step: 260  loss: -4.0000  grad_norm:  0.4176  memory:  9.81GiB(20.65%)  tps: 1,918  tflops: 14.99  mfu: 4.80%
[rank0]:2025-10-25 11:32:32,713 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 8.8213e-02
[rank0]:2025-10-25 11:32:32,713 - INFO -  step: 260  loss: -4.0000  grad_norm:  0.4176  memory: 17.51GiB(36.85%)  tps: 1,918  tflops: 14.99  mfu: 4.80%
[rank1]:2025-10-25 11:32:32,700 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 2.6701e-01
[rank1]:2025-10-25 11:32:32,701 - INFO -  step: 260  loss: -4.0000  grad_norm:  0.4176  memory: 15.15GiB(31.88%)  tps: 1,918  tflops: 14.99  mfu: 4.80%
[rank3]:2025-10-25 11:32:32,814 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 2.4532e-01
[rank3]:2025-10-25 11:32:32,816 - INFO -  step: 260  loss:  1.0462  grad_norm:  0.4176  memory: 26.78GiB(56.38%)  tps: 1,916  tflops: 14.98  mfu: 4.80%
[rank2]:2025-10-25 11:32:34,795 - INFO - Avg. fwd time: 17.3287 / Avg. bwd time: 26.3465 / Avg. batch time: 1947.8202 (ms) / GPU bubble ratio: 64.12%
[rank3]:2025-10-25 11:32:34,748 - INFO - Avg. fwd time: 33.7047 / Avg. bwd time: 69.7908 / Avg. batch time: 1876.9984 (ms) / GPU bubble ratio: 11.78%
[rank0]:2025-10-25 11:32:34,899 - INFO - Avg. fwd time: 19.5742 / Avg. bwd time: 30.0792 / Avg. batch time: 2102.8139 (ms) / GPU bubble ratio: 62.22%
[rank1]:2025-10-25 11:32:34,873 - INFO - Avg. fwd time: 22.8610 / Avg. bwd time: 40.1022 / Avg. batch time: 2052.4756 (ms) / GPU bubble ratio: 50.92%
[rank2]:2025-10-25 11:33:16,058 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 1.5124e-01
[rank0]:2025-10-25 11:33:16,065 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 2.6948e-01
[rank1]:2025-10-25 11:33:16,064 - INFO - Freezing Ratio: [Stage1] 0.33, [Stage5] 0.00, Threshold: 3.4308e-01
[rank3]:2025-10-25 11:33:16,069 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 2.3501e-01
[rank2]:2025-10-25 11:33:58,068 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 7.7254e-01
[rank3]:2025-10-25 11:33:58,083 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 5.5476e-01
[rank0]:2025-10-25 11:33:58,099 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 2.8513e-01
[rank1]:2025-10-25 11:33:58,076 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 8.1110e-01
[rank1]:2025-10-25 11:34:41,509 - INFO - Freezing Ratio: [Stage1] 0.33, [Stage5] 0.00, Threshold: 1.8923e-01
[rank2]:2025-10-25 11:34:41,504 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 1.2094e-01
[rank3]:2025-10-25 11:34:41,516 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 1.3304e-01
[rank0]:2025-10-25 11:34:41,513 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 2.6848e-01
[rank2]:2025-10-25 11:35:23,512 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 1.6335e-01
[rank2]:2025-10-25 11:35:23,513 - INFO -  step: 280  loss: -4.0000  grad_norm:  0.4345  memory:  9.81GiB(20.65%)  tps: 1,918  tflops: 15.00  mfu: 4.81%
[rank3]:2025-10-25 11:35:23,528 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 2.5940e-01
[rank3]:2025-10-25 11:35:23,530 - INFO -  step: 280  loss:  1.0450  grad_norm:  0.4345  memory: 26.78GiB(56.38%)  tps: 1,919  tflops: 15.01  mfu: 4.81%
[rank0]:2025-10-25 11:35:23,540 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 8.8213e-02
[rank0]:2025-10-25 11:35:23,541 - INFO -  step: 280  loss: -4.0000  grad_norm:  0.4345  memory: 17.51GiB(36.85%)  tps: 1,918  tflops: 15.00  mfu: 4.81%
[rank1]:2025-10-25 11:35:23,524 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 2.6363e-01
[rank1]:2025-10-25 11:35:23,524 - INFO -  step: 280  loss: -4.0000  grad_norm:  0.4345  memory: 15.15GiB(31.88%)  tps: 1,918  tflops: 15.00  mfu: 4.81%
[rank2]:2025-10-25 11:35:25,608 - INFO - Avg. fwd time: 17.3239 / Avg. bwd time: 26.2492 / Avg. batch time: 1946.8475 (ms) / GPU bubble ratio: 64.19%
[rank3]:2025-10-25 11:35:25,559 - INFO - Avg. fwd time: 33.7113 / Avg. bwd time: 69.7390 / Avg. batch time: 1876.1703 (ms) / GPU bubble ratio: 11.78%
[rank0]:2025-10-25 11:35:25,712 - INFO - Avg. fwd time: 19.5857 / Avg. bwd time: 29.9960 / Avg. batch time: 2101.5737 (ms) / GPU bubble ratio: 62.25%
[rank1]:2025-10-25 11:35:25,685 - INFO - Avg. fwd time: 22.8620 / Avg. bwd time: 40.0501 / Avg. batch time: 2051.4243 (ms) / GPU bubble ratio: 50.93%
[rank3]:2025-10-25 11:36:06,964 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 5.4524e-01
[rank2]:2025-10-25 11:36:06,953 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 1.1014e-01
[rank0]:2025-10-25 11:36:06,961 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 3.5224e-01
[rank1]:2025-10-25 11:36:06,958 - INFO - Freezing Ratio: [Stage1] 0.33, [Stage5] 0.00, Threshold: 3.3810e-01
[rank2]:2025-10-25 11:36:49,094 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 2.9145e-01
[rank0]:2025-10-25 11:36:49,119 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 1.0849e-01
[rank1]:2025-10-25 11:36:49,102 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 5.4299e-01
[rank3]:2025-10-25 11:36:49,162 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 4.5662e-01
[rank0]:2025-10-25 11:37:32,519 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 3.6655e-01
[rank1]:2025-10-25 11:37:32,515 - INFO - Freezing Ratio: [Stage1] 0.33, [Stage5] 0.00, Threshold: 3.3466e-01
[rank3]:2025-10-25 11:37:32,522 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 3.7599e-01
[rank2]:2025-10-25 11:37:32,511 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 1.7158e-01
[rank0]:2025-10-25 11:38:06,251 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-25 11:38:14,696 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 3.1254e-01
[rank3]:2025-10-25 11:38:14,698 - INFO -  step: 300  loss:  1.0160  grad_norm:  0.4300  memory: 26.78GiB(56.38%)  tps: 1,914  tflops: 14.97  mfu: 4.80%
[rank2]:2025-10-25 11:38:14,680 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 3.3001e-01
[rank2]:2025-10-25 11:38:14,681 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.4300  memory:  9.81GiB(20.65%)  tps: 1,914  tflops: 14.97  mfu: 4.80%
[rank1]:2025-10-25 11:38:14,692 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 3.3499e-01
[rank1]:2025-10-25 11:38:14,692 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.4300  memory: 15.15GiB(31.88%)  tps: 1,914  tflops: 14.97  mfu: 4.80%
[rank0]:2025-10-25 11:38:14,709 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 1.6751e-01
[rank0]:2025-10-25 11:38:14,710 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.4300  memory: 17.51GiB(36.85%)  tps: 1,914  tflops: 14.97  mfu: 4.80%
[rank0]:2025-10-25 11:38:14,780 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_auto_dm1/freeze_ratio_history/rank0/251025_1138_stage0_step300.svg
[rank2]:2025-10-25 11:38:14,782 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_auto_dm1/freeze_ratio_history/rank2/251025_1138_stage2_step300.svg
[rank2]:2025-10-25 11:38:14,838 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_auto_dm1/freeze_ratio_history/rank2/251025_1138_stage6_step300.svg
[rank1]:2025-10-25 11:38:14,790 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_auto_dm1/freeze_ratio_history/rank1/251025_1138_stage1_step300.svg
[rank1]:2025-10-25 11:38:14,849 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_auto_dm1/freeze_ratio_history/rank1/251025_1138_stage5_step300.svg
[rank0]:2025-10-25 11:38:14,836 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_auto_dm1/freeze_ratio_history/rank0/251025_1138_stage4_step300.svg
[rank3]:2025-10-25 11:38:15,078 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_auto_dm1/pipeline_schedule/251025_1138_real_step300_rank3.svg
[rank3]:> Batch Time: 1903.64 ms, GPU Bubble Ratio: 56.65%, 46.97%, 62.07%, 11.89%
[rank3]:2025-10-25 11:38:15,140 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_auto_dm1/freeze_ratio_history/rank3/251025_1138_stage3_step300.svg
[rank3]:2025-10-25 11:38:15,198 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_auto_dm1/freeze_ratio_history/rank3/251025_1138_stage7_step300.svg
[rank3]:2025-10-25 11:38:17,157 - INFO - Avg. fwd time: 33.7229 / Avg. bwd time: 69.7056 / Avg. batch time: 1875.7292 (ms) / GPU bubble ratio: 11.78%
[rank2]:2025-10-25 11:38:17,219 - INFO - Avg. fwd time: 17.3242 / Avg. bwd time: 26.1753 / Avg. batch time: 1946.5343 (ms) / GPU bubble ratio: 64.24%
[rank1]:2025-10-25 11:38:17,300 - INFO - Avg. fwd time: 22.8576 / Avg. bwd time: 40.0059 / Avg. batch time: 2051.0654 (ms) / GPU bubble ratio: 50.96%
[rank0]:2025-10-25 11:38:17,327 - INFO - Avg. fwd time: 19.5807 / Avg. bwd time: 29.9226 / Avg. batch time: 2101.0529 (ms) / GPU bubble ratio: 62.30%
[rank3]:2025-10-25 11:38:58,475 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 3.0415e-01
[rank2]:2025-10-25 11:38:58,463 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 1.5745e-01
[rank1]:2025-10-25 11:38:58,474 - INFO - Freezing Ratio: [Stage1] 0.33, [Stage5] 0.00, Threshold: 3.0080e-01
[rank0]:2025-10-25 11:38:58,472 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 1.3762e-01
[rank3]:2025-10-25 11:39:40,518 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 3.7352e-01
[rank2]:2025-10-25 11:39:40,502 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 5.7211e-01
[rank1]:2025-10-25 11:39:40,511 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 5.4748e-01
[rank0]:2025-10-25 11:39:40,529 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 8.9808e-02
[rank2]:2025-10-25 11:40:23,900 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 1.2635e-01
[rank1]:2025-10-25 11:40:23,904 - INFO - Freezing Ratio: [Stage1] 0.33, [Stage5] 0.00, Threshold: 3.0425e-01
[rank0]:2025-10-25 11:40:23,908 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 1.4804e-01
[rank3]:2025-10-25 11:40:23,911 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 1.3303e-01
[rank1]:2025-10-25 11:41:05,903 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 1.2106e+00
[rank1]:2025-10-25 11:41:05,904 - INFO -  step: 320  loss: -4.0000  grad_norm:  0.4785  memory: 15.15GiB(31.88%)  tps: 1,914  tflops: 14.96  mfu: 4.80%
[rank3]:2025-10-25 11:41:05,911 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 6.7214e-01
[rank3]:2025-10-25 11:41:05,913 - INFO -  step: 320  loss:  1.0388  grad_norm:  0.4785  memory: 26.78GiB(56.38%)  tps: 1,914  tflops: 14.96  mfu: 4.80%
[rank2]:2025-10-25 11:41:05,895 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 1.3795e+00
[rank2]:2025-10-25 11:41:05,896 - INFO -  step: 320  loss: -4.0000  grad_norm:  0.4785  memory:  9.81GiB(20.65%)  tps: 1,914  tflops: 14.96  mfu: 4.80%
[rank0]:2025-10-25 11:41:05,926 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 3.4558e-01
[rank0]:2025-10-25 11:41:05,926 - INFO -  step: 320  loss: -4.0000  grad_norm:  0.4785  memory: 17.51GiB(36.85%)  tps: 1,914  tflops: 14.96  mfu: 4.80%
[rank3]:2025-10-25 11:41:07,944 - INFO - Avg. fwd time: 33.7266 / Avg. bwd time: 69.6635 / Avg. batch time: 1875.0199 (ms) / GPU bubble ratio: 11.77%
[rank2]:2025-10-25 11:41:08,004 - INFO - Avg. fwd time: 17.3219 / Avg. bwd time: 26.1054 / Avg. batch time: 1945.7295 (ms) / GPU bubble ratio: 64.29%
[rank1]:2025-10-25 11:41:08,087 - INFO - Avg. fwd time: 22.8635 / Avg. bwd time: 39.9765 / Avg. batch time: 2050.2107 (ms) / GPU bubble ratio: 50.96%
[rank0]:2025-10-25 11:41:08,114 - INFO - Avg. fwd time: 19.5823 / Avg. bwd time: 29.8520 / Avg. batch time: 2100.0666 (ms) / GPU bubble ratio: 62.34%
[rank1]:2025-10-25 11:41:49,357 - INFO - Freezing Ratio: [Stage1] 0.67, [Stage5] 0.00, Threshold: 9.4883e-01
[rank0]:2025-10-25 11:41:49,361 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 1.1088e+00
[rank3]:2025-10-25 11:41:49,364 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 7.7618e-01
[rank2]:2025-10-25 11:41:49,353 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 6.0686e-01
[rank3]:2025-10-25 11:42:23,991 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 11:42:24,877 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 11:42:24,916 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 11:42:24,956 - WARNING - Dataset alpaca is being re-looped
[rank3]:2025-10-25 11:42:31,280 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 3.7920e-01
[rank2]:2025-10-25 11:42:31,264 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 3.7851e-01
[rank1]:2025-10-25 11:42:31,271 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 4.2872e-01
[rank0]:2025-10-25 11:42:31,294 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 1.4628e-01
[rank1]:2025-10-25 11:43:14,660 - INFO - Freezing Ratio: [Stage1] 0.67, [Stage5] 0.00, Threshold: 3.5302e-01
[rank0]:2025-10-25 11:43:14,663 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 4.3701e-01
[rank3]:2025-10-25 11:43:14,667 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 1.7463e-01
[rank2]:2025-10-25 11:43:14,655 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 2.1137e-01
[rank1]:2025-10-25 11:43:56,624 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 2.8994e-01
[rank1]:2025-10-25 11:43:56,628 - INFO -  step: 340  loss: -4.0000  grad_norm:  0.4370  memory: 15.15GiB(31.88%)  tps: 1,919  tflops: 15.00  mfu: 4.81%
[rank3]:2025-10-25 11:43:56,635 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 2.6819e-01
[rank3]:2025-10-25 11:43:56,637 - INFO -  step: 340  loss:  0.9887  grad_norm:  0.4370  memory: 26.78GiB(56.38%)  tps: 1,919  tflops: 15.00  mfu: 4.81%
[rank2]:2025-10-25 11:43:56,619 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 3.1189e-01
[rank2]:2025-10-25 11:43:56,620 - INFO -  step: 340  loss: -4.0000  grad_norm:  0.4370  memory:  9.81GiB(20.65%)  tps: 1,919  tflops: 15.00  mfu: 4.81%
[rank0]:2025-10-25 11:43:56,649 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 6.9340e-02
[rank0]:2025-10-25 11:43:56,649 - INFO -  step: 340  loss: -4.0000  grad_norm:  0.4370  memory: 17.51GiB(36.85%)  tps: 1,919  tflops: 15.00  mfu: 4.81%
[rank3]:2025-10-25 11:43:58,644 - INFO - Avg. fwd time: 33.7373 / Avg. bwd time: 69.6588 / Avg. batch time: 1875.0493 (ms) / GPU bubble ratio: 11.77%
[rank2]:2025-10-25 11:43:58,693 - INFO - Avg. fwd time: 17.3204 / Avg. bwd time: 26.0437 / Avg. batch time: 1945.4453 (ms) / GPU bubble ratio: 64.34%
[rank0]:2025-10-25 11:43:58,800 - INFO - Avg. fwd time: 19.5807 / Avg. bwd time: 29.8052 / Avg. batch time: 2099.1572 (ms) / GPU bubble ratio: 62.36%
[rank1]:2025-10-25 11:43:58,772 - INFO - Avg. fwd time: 22.8705 / Avg. bwd time: 39.8150 / Avg. batch time: 2049.3073 (ms) / GPU bubble ratio: 51.06%
[rank2]:2025-10-25 11:44:40,044 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 1.6709e-01
[rank0]:2025-10-25 11:44:40,052 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 3.0550e-01
[rank1]:2025-10-25 11:44:40,049 - INFO - Freezing Ratio: [Stage1] 0.67, [Stage5] 0.00, Threshold: 3.4981e-01
[rank3]:2025-10-25 11:44:40,055 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 3.0505e-01
[rank0]:2025-10-25 11:45:13,554 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-25 11:45:21,942 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 3.3408e-01
[rank3]:2025-10-25 11:45:21,953 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 2.1635e-01
[rank2]:2025-10-25 11:45:21,938 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 2.8358e-01
[rank0]:2025-10-25 11:45:21,968 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 7.5389e-02
[rank3]:2025-10-25 11:46:05,240 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 2.0892e-01
[rank2]:2025-10-25 11:46:05,229 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 1.2462e-01
[rank0]:2025-10-25 11:46:05,237 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 1.6769e-01
[rank1]:2025-10-25 11:46:05,234 - INFO - Freezing Ratio: [Stage1] 0.67, [Stage5] 0.00, Threshold: 2.9084e-01
[rank2]:2025-10-25 11:46:47,221 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 7.4884e-01
[rank2]:2025-10-25 11:46:47,221 - INFO -  step: 360  loss: -4.0000  grad_norm:  0.4430  memory:  9.81GiB(20.65%)  tps: 1,921  tflops: 15.02  mfu: 4.81%
[rank0]:2025-10-25 11:46:47,249 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 1.8255e-01
[rank0]:2025-10-25 11:46:47,249 - INFO -  step: 360  loss: -4.0000  grad_norm:  0.4430  memory: 17.51GiB(36.85%)  tps: 1,921  tflops: 15.02  mfu: 4.81%
[rank1]:2025-10-25 11:46:47,229 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 3.9187e-01
[rank1]:2025-10-25 11:46:47,230 - INFO -  step: 360  loss: -4.0000  grad_norm:  0.4430  memory: 15.15GiB(31.88%)  tps: 1,921  tflops: 15.02  mfu: 4.81%
[rank3]:2025-10-25 11:46:47,236 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 4.7392e-01
[rank3]:2025-10-25 11:46:47,238 - INFO -  step: 360  loss:  1.0193  grad_norm:  0.4430  memory: 26.78GiB(56.38%)  tps: 1,921  tflops: 15.02  mfu: 4.81%
[rank3]:2025-10-25 11:46:49,249 - INFO - Avg. fwd time: 33.7497 / Avg. bwd time: 69.6485 / Avg. batch time: 1875.0613 (ms) / GPU bubble ratio: 11.77%
[rank2]:2025-10-25 11:46:49,303 - INFO - Avg. fwd time: 17.3211 / Avg. bwd time: 25.9918 / Avg. batch time: 1945.0985 (ms) / GPU bubble ratio: 64.37%
[rank0]:2025-10-25 11:46:49,402 - INFO - Avg. fwd time: 19.5813 / Avg. bwd time: 29.7670 / Avg. batch time: 2098.2388 (ms) / GPU bubble ratio: 62.37%
[rank1]:2025-10-25 11:46:49,375 - INFO - Avg. fwd time: 22.8748 / Avg. bwd time: 39.6607 / Avg. batch time: 2048.3987 (ms) / GPU bubble ratio: 51.15%
[rank2]:2025-10-25 11:47:30,561 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 1.3004e-01
[rank0]:2025-10-25 11:47:30,569 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 2.9303e-01
[rank1]:2025-10-25 11:47:30,566 - INFO - Freezing Ratio: [Stage1] 0.67, [Stage5] 0.00, Threshold: 1.5013e-01
[rank3]:2025-10-25 11:47:30,573 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 2.7410e-01
[rank1]:2025-10-25 11:48:12,270 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 3.6049e-01
[rank3]:2025-10-25 11:48:12,281 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 2.3068e-01
[rank2]:2025-10-25 11:48:12,266 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 2.7866e-01
[rank0]:2025-10-25 11:48:12,294 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 7.0781e-02
[rank2]:2025-10-25 11:48:55,674 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 1.2248e-01
[rank0]:2025-10-25 11:48:55,682 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 2.5996e-01
[rank1]:2025-10-25 11:48:55,685 - INFO - Freezing Ratio: [Stage1] 0.67, [Stage5] 0.00, Threshold: 1.5872e-01
[rank3]:2025-10-25 11:48:55,686 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 1.1191e-01
[rank3]:2025-10-25 11:49:37,524 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 1.3827e-01
[rank3]:2025-10-25 11:49:37,526 - INFO -  step: 380  loss:  0.9535  grad_norm:  0.4073  memory: 26.78GiB(56.38%)  tps: 1,924  tflops: 15.04  mfu: 4.82%
[rank2]:2025-10-25 11:49:37,508 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 3.0308e-01
[rank2]:2025-10-25 11:49:37,509 - INFO -  step: 380  loss: -4.0000  grad_norm:  0.4073  memory:  9.81GiB(20.65%)  tps: 1,924  tflops: 15.04  mfu: 4.82%
[rank0]:2025-10-25 11:49:37,536 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 8.0520e-02
[rank0]:2025-10-25 11:49:37,537 - INFO -  step: 380  loss: -4.0000  grad_norm:  0.4073  memory: 17.51GiB(36.85%)  tps: 1,924  tflops: 15.04  mfu: 4.82%
[rank1]:2025-10-25 11:49:37,512 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 2.2572e-01
[rank1]:2025-10-25 11:49:37,513 - INFO -  step: 380  loss: -4.0000  grad_norm:  0.4073  memory: 15.15GiB(31.88%)  tps: 1,924  tflops: 15.04  mfu: 4.82%
[rank3]:2025-10-25 11:49:39,559 - INFO - Avg. fwd time: 33.7513 / Avg. bwd time: 69.6362 / Avg. batch time: 1874.8199 (ms) / GPU bubble ratio: 11.77%
[rank2]:2025-10-25 11:49:39,613 - INFO - Avg. fwd time: 17.3195 / Avg. bwd time: 25.9420 / Avg. batch time: 1944.5820 (ms) / GPU bubble ratio: 64.40%
[rank1]:2025-10-25 11:49:39,693 - INFO - Avg. fwd time: 22.8676 / Avg. bwd time: 39.5139 / Avg. batch time: 2047.4123 (ms) / GPU bubble ratio: 51.25%
[rank0]:2025-10-25 11:49:39,720 - INFO - Avg. fwd time: 19.5790 / Avg. bwd time: 29.7252 / Avg. batch time: 2097.2184 (ms) / GPU bubble ratio: 62.39%
[rank2]:2025-10-25 11:50:20,982 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 9.6856e-02
[rank0]:2025-10-25 11:50:20,990 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 5.2881e-01
[rank1]:2025-10-25 11:50:20,989 - INFO - Freezing Ratio: [Stage1] 0.67, [Stage5] 0.00, Threshold: 2.8659e-01
[rank3]:2025-10-25 11:50:20,994 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 1.9849e-01
[rank2]:2025-10-25 11:51:02,853 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 2.3411e-01
[rank0]:2025-10-25 11:51:02,880 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 1.4017e-01
[rank1]:2025-10-25 11:51:02,860 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 3.3589e-01
[rank3]:2025-10-25 11:51:02,869 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 2.5421e-01
[rank3]:2025-10-25 11:51:46,292 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 1.5227e-01
[rank2]:2025-10-25 11:51:46,280 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 1.7956e-01
[rank0]:2025-10-25 11:51:46,288 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 3.5203e-01
[rank1]:2025-10-25 11:51:46,290 - INFO - Freezing Ratio: [Stage1] 0.67, [Stage5] 0.00, Threshold: 2.6305e-01
[rank0]:2025-10-25 11:52:19,857 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-25 11:52:28,256 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 2.2597e-01
[rank3]:2025-10-25 11:52:28,258 - INFO -  step: 400  loss:  0.9426  grad_norm:  0.4255  memory: 26.78GiB(56.38%)  tps: 1,919  tflops: 15.00  mfu: 4.81%
[rank2]:2025-10-25 11:52:28,240 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 1.5820e-01
[rank2]:2025-10-25 11:52:28,240 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.4255  memory:  9.81GiB(20.65%)  tps: 1,919  tflops: 15.00  mfu: 4.81%
[rank0]:2025-10-25 11:52:28,268 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 6.3580e-02
[rank0]:2025-10-25 11:52:28,269 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.4255  memory: 17.51GiB(36.85%)  tps: 1,919  tflops: 15.00  mfu: 4.81%
[rank1]:2025-10-25 11:52:28,244 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 1.9859e-01
[rank1]:2025-10-25 11:52:28,245 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.4255  memory: 15.15GiB(31.88%)  tps: 1,919  tflops: 15.00  mfu: 4.81%
[rank2]:2025-10-25 11:52:28,348 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_auto_dm1/freeze_ratio_history/rank2/251025_1152_stage2_step400.svg
[rank0]:2025-10-25 11:52:28,346 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_auto_dm1/freeze_ratio_history/rank0/251025_1152_stage0_step400.svg
[rank0]:2025-10-25 11:52:28,408 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_auto_dm1/freeze_ratio_history/rank0/251025_1152_stage4_step400.svg
[rank1]:2025-10-25 11:52:28,353 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_auto_dm1/freeze_ratio_history/rank1/251025_1152_stage1_step400.svg
[rank1]:2025-10-25 11:52:28,416 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_auto_dm1/freeze_ratio_history/rank1/251025_1152_stage5_step400.svg
[rank2]:2025-10-25 11:52:28,410 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_auto_dm1/freeze_ratio_history/rank2/251025_1152_stage6_step400.svg
[rank3]:2025-10-25 11:52:28,629 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_auto_dm1/pipeline_schedule/251025_1152_real_step400_rank3.svg
[rank3]:> Batch Time: 1905.89 ms, GPU Bubble Ratio: 56.78%, 47.16%, 62.21%, 11.77%
[rank3]:2025-10-25 11:52:28,698 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_auto_dm1/freeze_ratio_history/rank3/251025_1152_stage3_step400.svg
[rank3]:2025-10-25 11:52:28,764 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_auto_dm1/freeze_ratio_history/rank3/251025_1152_stage7_step400.svg
[rank3]:2025-10-25 11:52:30,717 - INFO - Avg. fwd time: 33.7587 / Avg. bwd time: 69.6345 / Avg. batch time: 1874.8761 (ms) / GPU bubble ratio: 11.77%
[rank2]:2025-10-25 11:52:30,772 - INFO - Avg. fwd time: 17.3223 / Avg. bwd time: 25.9021 / Avg. batch time: 1944.5622 (ms) / GPU bubble ratio: 64.43%
[rank0]:2025-10-25 11:52:30,877 - INFO - Avg. fwd time: 19.5727 / Avg. bwd time: 29.6964 / Avg. batch time: 2096.7229 (ms) / GPU bubble ratio: 62.40%
[rank1]:2025-10-25 11:52:30,850 - INFO - Avg. fwd time: 22.8607 / Avg. bwd time: 39.3865 / Avg. batch time: 2046.9318 (ms) / GPU bubble ratio: 51.34%
[rank2]:2025-10-25 11:53:12,125 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 1.9928e-01
[rank0]:2025-10-25 11:53:12,133 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 3.6329e-01
[rank1]:2025-10-25 11:53:12,130 - INFO - Freezing Ratio: [Stage1] 0.67, [Stage5] 0.00, Threshold: 4.0527e-01
[rank3]:2025-10-25 11:53:12,136 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 4.5219e-01
[rank2]:2025-10-25 11:53:54,004 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 4.1808e-01
[rank0]:2025-10-25 11:53:54,031 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 1.2358e-01
[rank1]:2025-10-25 11:53:54,012 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 4.3495e-01
[rank3]:2025-10-25 11:53:54,019 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 2.8864e-01
[rank3]:2025-10-25 11:54:06,016 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 11:54:06,911 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 11:54:06,987 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 11:54:06,968 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 11:54:37,354 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 1.1024e-01
[rank0]:2025-10-25 11:54:37,362 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 3.0899e-01
[rank1]:2025-10-25 11:54:37,359 - INFO - Freezing Ratio: [Stage1] 0.67, [Stage5] 0.00, Threshold: 1.8609e-01
[rank3]:2025-10-25 11:54:37,365 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 1.2791e-01
[rank1]:2025-10-25 11:55:19,046 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 5.4568e-01
[rank1]:2025-10-25 11:55:19,046 - INFO -  step: 420  loss: -4.0000  grad_norm:  0.4034  memory: 15.15GiB(31.88%)  tps: 1,918  tflops: 15.00  mfu: 4.81%
[rank3]:2025-10-25 11:55:19,053 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 4.9392e-01
[rank3]:2025-10-25 11:55:19,056 - INFO -  step: 420  loss:  0.9124  grad_norm:  0.4034  memory: 26.78GiB(56.38%)  tps: 1,919  tflops: 15.00  mfu: 4.81%
[rank2]:2025-10-25 11:55:19,037 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 7.6168e-01
[rank2]:2025-10-25 11:55:19,038 - INFO -  step: 420  loss: -4.0000  grad_norm:  0.4034  memory:  9.81GiB(20.65%)  tps: 1,919  tflops: 15.00  mfu: 4.81%
[rank0]:2025-10-25 11:55:19,065 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 1.5041e-01
[rank0]:2025-10-25 11:55:19,065 - INFO -  step: 420  loss: -4.0000  grad_norm:  0.4034  memory: 17.51GiB(36.85%)  tps: 1,919  tflops: 15.00  mfu: 4.81%
[rank3]:2025-10-25 11:55:21,076 - INFO - Avg. fwd time: 33.7627 / Avg. bwd time: 69.6265 / Avg. batch time: 1874.7717 (ms) / GPU bubble ratio: 11.76%
[rank2]:2025-10-25 11:55:21,122 - INFO - Avg. fwd time: 17.3206 / Avg. bwd time: 25.8615 / Avg. batch time: 1944.2070 (ms) / GPU bubble ratio: 64.46%
[rank0]:2025-10-25 11:55:21,230 - INFO - Avg. fwd time: 19.5836 / Avg. bwd time: 29.6638 / Avg. batch time: 2095.9457 (ms) / GPU bubble ratio: 62.41%
[rank1]:2025-10-25 11:55:21,202 - INFO - Avg. fwd time: 22.8602 / Avg. bwd time: 39.2727 / Avg. batch time: 2046.1583 (ms) / GPU bubble ratio: 51.42%
[rank2]:2025-10-25 11:56:02,451 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 8.8841e-02
[rank0]:2025-10-25 11:56:02,459 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 2.7120e-01
[rank1]:2025-10-25 11:56:02,460 - INFO - Freezing Ratio: [Stage1] 0.67, [Stage5] 0.00, Threshold: 2.0152e-01
[rank3]:2025-10-25 11:56:02,463 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 3.8380e-01
[rank1]:2025-10-25 11:56:44,244 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 4.6137e-01
[rank3]:2025-10-25 11:56:44,255 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 2.6230e-01
[rank2]:2025-10-25 11:56:44,239 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 5.1374e-01
[rank0]:2025-10-25 11:56:44,268 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 1.7934e-01
[rank2]:2025-10-25 11:57:27,636 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 1.2286e-01
[rank0]:2025-10-25 11:57:27,644 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 1.2966e-01
[rank1]:2025-10-25 11:57:27,647 - INFO - Freezing Ratio: [Stage1] 0.67, [Stage5] 0.00, Threshold: 1.3486e-01
[rank3]:2025-10-25 11:57:27,647 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 1.2855e-01
[rank1]:2025-10-25 11:58:09,569 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 2.6330e-01
[rank1]:2025-10-25 11:58:09,570 - INFO -  step: 440  loss: -4.0000  grad_norm:  0.4212  memory: 15.15GiB(31.88%)  tps: 1,922  tflops: 15.02  mfu: 4.81%
[rank3]:2025-10-25 11:58:09,580 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 2.4601e-01
[rank3]:2025-10-25 11:58:09,583 - INFO -  step: 440  loss:  0.9369  grad_norm:  0.4212  memory: 26.78GiB(56.38%)  tps: 1,922  tflops: 15.02  mfu: 4.81%
[rank2]:2025-10-25 11:58:09,565 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 1.5963e-01
[rank2]:2025-10-25 11:58:09,565 - INFO -  step: 440  loss: -4.0000  grad_norm:  0.4212  memory:  9.81GiB(20.65%)  tps: 1,922  tflops: 15.02  mfu: 4.81%
[rank0]:2025-10-25 11:58:09,593 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 1.4669e-01
[rank0]:2025-10-25 11:58:09,594 - INFO -  step: 440  loss: -4.0000  grad_norm:  0.4212  memory: 17.51GiB(36.85%)  tps: 1,922  tflops: 15.02  mfu: 4.81%
[rank3]:2025-10-25 11:58:11,611 - INFO - Avg. fwd time: 33.7652 / Avg. bwd time: 69.6248 / Avg. batch time: 1874.7630 (ms) / GPU bubble ratio: 11.76%
[rank2]:2025-10-25 11:58:11,659 - INFO - Avg. fwd time: 17.3217 / Avg. bwd time: 25.8270 / Avg. batch time: 1943.9590 (ms) / GPU bubble ratio: 64.49%
[rank0]:2025-10-25 11:58:11,766 - INFO - Avg. fwd time: 19.5838 / Avg. bwd time: 29.6370 / Avg. batch time: 2095.3169 (ms) / GPU bubble ratio: 62.41%
[rank1]:2025-10-25 11:58:11,737 - INFO - Avg. fwd time: 22.8590 / Avg. bwd time: 39.1633 / Avg. batch time: 2045.5225 (ms) / GPU bubble ratio: 51.49%
[rank3]:2025-10-25 11:58:52,949 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 1.5292e-01
[rank2]:2025-10-25 11:58:52,937 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 3.9428e-02
[rank0]:2025-10-25 11:58:52,945 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 2.0765e-01
[rank1]:2025-10-25 11:58:52,943 - INFO - Freezing Ratio: [Stage1] 0.67, [Stage5] 0.00, Threshold: 2.4148e-01
[rank0]:2025-10-25 11:59:26,504 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-25 11:59:34,913 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 2.1311e-01
[rank2]:2025-10-25 11:59:34,897 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 1.4757e-01
[rank1]:2025-10-25 11:59:34,904 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 1.6311e-01
[rank0]:2025-10-25 11:59:34,925 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 8.2271e-02
[rank2]:2025-10-25 12:00:18,305 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 6.5515e-02
[rank0]:2025-10-25 12:00:18,314 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 2.7673e-01
[rank1]:2025-10-25 12:00:18,310 - INFO - Freezing Ratio: [Stage1] 0.67, [Stage5] 0.00, Threshold: 2.5635e-01
[rank3]:2025-10-25 12:00:18,317 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 1.1022e-01
[rank2]:2025-10-25 12:01:00,130 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 7.6993e-01
[rank2]:2025-10-25 12:01:00,131 - INFO -  step: 460  loss: -4.0000  grad_norm:  0.4612  memory:  9.81GiB(20.65%)  tps: 1,921  tflops: 15.02  mfu: 4.81%
[rank1]:2025-10-25 12:01:00,134 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 3.8705e-01
[rank1]:2025-10-25 12:01:00,135 - INFO -  step: 460  loss: -4.0000  grad_norm:  0.4612  memory: 15.15GiB(31.88%)  tps: 1,921  tflops: 15.02  mfu: 4.81%
[rank0]:2025-10-25 12:01:00,158 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 8.4656e-02
[rank0]:2025-10-25 12:01:00,159 - INFO -  step: 460  loss: -4.0000  grad_norm:  0.4612  memory: 17.51GiB(36.85%)  tps: 1,921  tflops: 15.02  mfu: 4.81%
[rank3]:2025-10-25 12:01:00,146 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 3.8458e-01
[rank3]:2025-10-25 12:01:00,148 - INFO -  step: 460  loss:  0.9956  grad_norm:  0.4612  memory: 26.78GiB(56.38%)  tps: 1,921  tflops: 15.02  mfu: 4.81%
[rank3]:2025-10-25 12:01:02,161 - INFO - Avg. fwd time: 33.7704 / Avg. bwd time: 69.6192 / Avg. batch time: 1874.7155 (ms) / GPU bubble ratio: 11.76%
[rank2]:2025-10-25 12:01:02,208 - INFO - Avg. fwd time: 17.3219 / Avg. bwd time: 25.7934 / Avg. batch time: 1943.7025 (ms) / GPU bubble ratio: 64.51%
[rank1]:2025-10-25 12:01:02,286 - INFO - Avg. fwd time: 22.8611 / Avg. bwd time: 39.0704 / Avg. batch time: 2044.9363 (ms) / GPU bubble ratio: 51.54%
[rank0]:2025-10-25 12:01:02,315 - INFO - Avg. fwd time: 19.5809 / Avg. bwd time: 29.6098 / Avg. batch time: 2094.7206 (ms) / GPU bubble ratio: 62.43%
[rank2]:2025-10-25 12:01:43,534 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 3.6822e-01
[rank0]:2025-10-25 12:01:43,541 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 3.3404e-01
[rank1]:2025-10-25 12:01:43,541 - INFO - Freezing Ratio: [Stage1] 0.67, [Stage5] 0.00, Threshold: 6.2804e-01
[rank3]:2025-10-25 12:01:43,545 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 2.8895e-01
[rank2]:2025-10-25 12:02:25,076 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 2.5117e-01
[rank0]:2025-10-25 12:02:25,105 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 1.4174e-01
[rank1]:2025-10-25 12:02:25,080 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 1.5716e-01
[rank3]:2025-10-25 12:02:25,091 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 3.3401e-01
[rank1]:2025-10-25 12:03:08,477 - INFO - Freezing Ratio: [Stage1] 0.67, [Stage5] 0.00, Threshold: 3.3336e-01
[rank3]:2025-10-25 12:03:08,484 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 4.8169e-01
[rank2]:2025-10-25 12:03:08,472 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 9.3434e-02
[rank0]:2025-10-25 12:03:08,481 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 5.1126e-01
[rank2]:2025-10-25 12:03:50,250 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 3.7369e-01
[rank2]:2025-10-25 12:03:50,251 - INFO -  step: 480  loss: -4.0000  grad_norm:  0.4440  memory:  9.81GiB(20.65%)  tps: 1,926  tflops: 15.06  mfu: 4.83%
[rank0]:2025-10-25 12:03:50,280 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 1.2728e-01
[rank0]:2025-10-25 12:03:50,281 - INFO -  step: 480  loss: -4.0000  grad_norm:  0.4440  memory: 17.51GiB(36.85%)  tps: 1,926  tflops: 15.06  mfu: 4.83%
[rank1]:2025-10-25 12:03:50,254 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 2.6019e-01
[rank1]:2025-10-25 12:03:50,255 - INFO -  step: 480  loss: -4.0000  grad_norm:  0.4440  memory: 15.15GiB(31.88%)  tps: 1,926  tflops: 15.06  mfu: 4.83%
[rank3]:2025-10-25 12:03:50,266 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 2.4273e-01
[rank3]:2025-10-25 12:03:50,268 - INFO -  step: 480  loss:  0.9578  grad_norm:  0.4440  memory: 26.78GiB(56.38%)  tps: 1,926  tflops: 15.06  mfu: 4.83%
[rank3]:2025-10-25 12:03:52,295 - INFO - Avg. fwd time: 33.7709 / Avg. bwd time: 69.6048 / Avg. batch time: 1874.4484 (ms) / GPU bubble ratio: 11.76%
[rank2]:2025-10-25 12:03:52,357 - INFO - Avg. fwd time: 17.3207 / Avg. bwd time: 25.7623 / Avg. batch time: 1943.2681 (ms) / GPU bubble ratio: 64.53%
[rank1]:2025-10-25 12:03:52,437 - INFO - Avg. fwd time: 22.8574 / Avg. bwd time: 38.9819 / Avg. batch time: 2044.2121 (ms) / GPU bubble ratio: 51.60%
[rank0]:2025-10-25 12:03:52,466 - INFO - Avg. fwd time: 19.5828 / Avg. bwd time: 29.5778 / Avg. batch time: 2093.9710 (ms) / GPU bubble ratio: 62.44%
[rank2]:2025-10-25 12:04:33,744 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 1.3939e-01
[rank0]:2025-10-25 12:04:33,752 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 3.9245e-01
[rank1]:2025-10-25 12:04:33,749 - INFO - Freezing Ratio: [Stage1] 0.67, [Stage5] 0.00, Threshold: 1.7399e-01
[rank3]:2025-10-25 12:04:33,756 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 3.1263e-01
[rank1]:2025-10-25 12:05:15,641 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 2.7098e-01
[rank3]:2025-10-25 12:05:15,653 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 2.4000e-01
[rank2]:2025-10-25 12:05:15,637 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 1.6786e-01
[rank0]:2025-10-25 12:05:15,666 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 1.5146e-01
[rank3]:2025-10-25 12:05:47,286 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 12:05:48,185 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 12:05:48,263 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 12:05:48,244 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 12:05:59,066 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 1.7563e-01
[rank0]:2025-10-25 12:05:59,074 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 2.2730e-01
[rank1]:2025-10-25 12:05:59,072 - INFO - Freezing Ratio: [Stage1] 0.67, [Stage5] 0.00, Threshold: 1.5979e-01
[rank3]:2025-10-25 12:05:59,078 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 2.3834e-01
[rank0]:2025-10-25 12:06:32,646 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-25 12:06:41,032 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 3.7829e-01
[rank2]:2025-10-25 12:06:41,032 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.4133  memory:  9.81GiB(20.65%)  tps: 1,919  tflops: 15.00  mfu: 4.81%
[rank2]:2025-10-25 12:06:41,032 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-25 12:06:41,037 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 2.4949e-01
[rank1]:2025-10-25 12:06:41,038 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.4133  memory: 15.15GiB(31.88%)  tps: 1,919  tflops: 15.00  mfu: 4.81%
[rank1]:2025-10-25 12:06:41,038 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-25 12:06:41,056 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 3.6041e-01
[rank3]:2025-10-25 12:06:41,058 - INFO -  step: 500  loss:  0.8941  grad_norm:  0.4133  memory: 26.78GiB(56.38%)  tps: 1,919  tflops: 15.00  mfu: 4.81%
[rank3]:2025-10-25 12:06:41,059 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-25 12:06:41,057 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 1.4713e-01
[rank0]:2025-10-25 12:06:41,058 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.4133  memory: 17.51GiB(36.85%)  tps: 1,919  tflops: 15.00  mfu: 4.81%
[rank0]:2025-10-25 12:06:41,058 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-25 12:06:41,058 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank2]:2025-10-25 12:06:42,834 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 1.80 seconds.
[rank1]:2025-10-25 12:06:43,299 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 2.26 seconds.
[rank3]:2025-10-25 12:06:44,301 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.24 seconds.
[rank0]:2025-10-25 12:06:44,672 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-25 12:06:44,680 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.62 seconds.
[rank2]:2025-10-25 12:06:44,774 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_auto_dm1/freeze_ratio_history/rank2/251025_1206_stage2_step500.svg
[rank2]:2025-10-25 12:06:44,831 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_auto_dm1/freeze_ratio_history/rank2/251025_1206_stage6_step500.svg
[rank0]:2025-10-25 12:06:44,780 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_auto_dm1/freeze_ratio_history/rank0/251025_1206_stage0_step500.svg
[rank1]:2025-10-25 12:06:44,778 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_auto_dm1/freeze_ratio_history/rank1/251025_1206_stage1_step500.svg
[rank1]:2025-10-25 12:06:44,836 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_auto_dm1/freeze_ratio_history/rank1/251025_1206_stage5_step500.svg
[rank0]:2025-10-25 12:06:44,895 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_auto_dm1/freeze_ratio_history/rank0/251025_1206_stage4_step500.svg
[rank3]:2025-10-25 12:06:45,207 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_auto_dm1/pipeline_schedule/251025_1206_real_step500_rank3.svg
[rank3]:> Batch Time: 1905.55 ms, GPU Bubble Ratio: 56.84%, 47.29%, 62.28%, 11.70%
[rank3]:2025-10-25 12:06:45,269 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_auto_dm1/freeze_ratio_history/rank3/251025_1206_stage3_step500.svg
[rank3]:2025-10-25 12:06:45,325 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_auto_dm1/freeze_ratio_history/rank3/251025_1206_stage7_step500.svg
[rank3]:2025-10-25 12:06:47,297 - INFO - Avg. fwd time: 33.7772 / Avg. bwd time: 69.6059 / Avg. batch time: 1874.5502 (ms) / GPU bubble ratio: 11.76%
[rank2]:2025-10-25 12:06:47,350 - INFO - Avg. fwd time: 17.3215 / Avg. bwd time: 25.7382 / Avg. batch time: 1943.3707 (ms) / GPU bubble ratio: 64.55%
[rank0]:2025-10-25 12:06:47,462 - INFO - Avg. fwd time: 19.5806 / Avg. bwd time: 29.5566 / Avg. batch time: 2093.7932 (ms) / GPU bubble ratio: 62.45%
[rank1]:2025-10-25 12:06:47,433 - INFO - Avg. fwd time: 22.8562 / Avg. bwd time: 38.9005 / Avg. batch time: 2044.0340 (ms) / GPU bubble ratio: 51.66%
[rank2]:2025-10-25 12:07:28,759 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 3.3911e-01
[rank0]:2025-10-25 12:07:28,767 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 6.8705e-01
[rank1]:2025-10-25 12:07:28,765 - INFO - Freezing Ratio: [Stage1] 0.67, [Stage5] 0.00, Threshold: 6.4961e-01
[rank3]:2025-10-25 12:07:28,771 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 6.2508e-01
[rank2]:2025-10-25 12:08:10,638 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 5.6726e-01
[rank0]:2025-10-25 12:08:10,666 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 1.5188e-01
[rank1]:2025-10-25 12:08:10,642 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 4.8630e-01
[rank3]:2025-10-25 12:08:10,654 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 3.8187e-01
[rank2]:2025-10-25 12:08:53,891 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 3.0097e-01
[rank0]:2025-10-25 12:08:53,899 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 3.2767e-01
[rank1]:2025-10-25 12:08:53,896 - INFO - Freezing Ratio: [Stage1] 0.67, [Stage5] 0.00, Threshold: 2.9341e-01
[rank3]:2025-10-25 12:08:53,902 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 4.7305e-01
[rank2]:2025-10-25 12:09:35,644 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 2.8546e-01
[rank2]:2025-10-25 12:09:35,645 - INFO -  step: 520  loss: -4.0000  grad_norm:  0.4431  memory:  9.81GiB(20.65%)  tps: 1,877  tflops: 14.67  mfu: 4.70%
[rank1]:2025-10-25 12:09:35,648 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 2.8090e-01
[rank1]:2025-10-25 12:09:35,649 - INFO -  step: 520  loss: -4.0000  grad_norm:  0.4431  memory: 15.15GiB(31.88%)  tps: 1,877  tflops: 14.67  mfu: 4.70%
[rank3]:2025-10-25 12:09:35,660 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 2.2831e-01
[rank3]:2025-10-25 12:09:35,662 - INFO -  step: 520  loss:  0.9212  grad_norm:  0.4431  memory: 26.78GiB(56.38%)  tps: 1,877  tflops: 14.67  mfu: 4.70%
[rank0]:2025-10-25 12:09:35,677 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 3.2773e-02
[rank0]:2025-10-25 12:09:35,677 - INFO -  step: 520  loss: -4.0000  grad_norm:  0.4431  memory: 17.51GiB(36.85%)  tps: 1,877  tflops: 14.67  mfu: 4.70%
[rank3]:2025-10-25 12:09:37,682 - INFO - Avg. fwd time: 33.7787 / Avg. bwd time: 69.5977 / Avg. batch time: 1874.4214 (ms) / GPU bubble ratio: 11.76%
[rank2]:2025-10-25 12:09:37,728 - INFO - Avg. fwd time: 17.3211 / Avg. bwd time: 25.7101 / Avg. batch time: 1943.0950 (ms) / GPU bubble ratio: 64.57%
[rank1]:2025-10-25 12:09:37,790 - INFO - Avg. fwd time: 22.8549 / Avg. bwd time: 38.8303 / Avg. batch time: 2043.4994 (ms) / GPU bubble ratio: 51.70%
[rank0]:2025-10-25 12:09:37,819 - INFO - Avg. fwd time: 19.5812 / Avg. bwd time: 29.5327 / Avg. batch time: 2093.2521 (ms) / GPU bubble ratio: 62.46%
[rank3]:2025-10-25 12:10:19,066 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 3.5801e-01
[rank2]:2025-10-25 12:10:19,054 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 1.7927e-01
[rank0]:2025-10-25 12:10:19,062 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 4.0298e-01
[rank1]:2025-10-25 12:10:19,059 - INFO - Freezing Ratio: [Stage1] 0.67, [Stage5] 0.00, Threshold: 2.8409e-01
[rank1]:2025-10-25 12:11:00,882 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 4.0757e-01
[rank3]:2025-10-25 12:11:00,893 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 1.7042e-01
[rank2]:2025-10-25 12:11:00,878 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 6.6945e-01
[rank0]:2025-10-25 12:11:00,905 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 4.4771e-02
[rank2]:2025-10-25 12:11:44,291 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 1.6825e-01
[rank1]:2025-10-25 12:11:44,302 - INFO - Freezing Ratio: [Stage1] 0.67, [Stage5] 0.00, Threshold: 1.7779e-01
[rank0]:2025-10-25 12:11:44,299 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 1.9281e-01
[rank3]:2025-10-25 12:11:44,302 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 2.5098e-01
[rank1]:2025-10-25 12:12:26,167 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 3.4470e-01
[rank1]:2025-10-25 12:12:26,167 - INFO -  step: 540  loss: -4.0000  grad_norm:  0.4499  memory: 15.15GiB(31.88%)  tps: 1,922  tflops: 15.02  mfu: 4.81%
[rank0]:2025-10-25 12:12:26,193 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 1.9480e-01
[rank0]:2025-10-25 12:12:26,194 - INFO -  step: 540  loss: -4.0000  grad_norm:  0.4499  memory: 17.51GiB(36.85%)  tps: 1,922  tflops: 15.02  mfu: 4.82%
[rank2]:2025-10-25 12:12:26,162 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 4.1226e-01
[rank2]:2025-10-25 12:12:26,163 - INFO -  step: 540  loss: -4.0000  grad_norm:  0.4499  memory:  9.81GiB(20.65%)  tps: 1,922  tflops: 15.02  mfu: 4.81%
[rank3]:2025-10-25 12:12:26,178 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 3.4902e-01
[rank3]:2025-10-25 12:12:26,180 - INFO -  step: 540  loss:  0.9128  grad_norm:  0.4499  memory: 26.78GiB(56.38%)  tps: 1,922  tflops: 15.02  mfu: 4.82%
[rank3]:2025-10-25 12:12:28,212 - INFO - Avg. fwd time: 33.7817 / Avg. bwd time: 69.5953 / Avg. batch time: 1874.3816 (ms) / GPU bubble ratio: 11.76%
[rank2]:2025-10-25 12:12:28,262 - INFO - Avg. fwd time: 17.3199 / Avg. bwd time: 25.6850 / Avg. batch time: 1942.9165 (ms) / GPU bubble ratio: 64.59%
[rank1]:2025-10-25 12:12:28,324 - INFO - Avg. fwd time: 22.8509 / Avg. bwd time: 38.7546 / Avg. batch time: 2043.0701 (ms) / GPU bubble ratio: 51.75%
[rank0]:2025-10-25 12:12:28,353 - INFO - Avg. fwd time: 19.5788 / Avg. bwd time: 29.5168 / Avg. batch time: 2092.8243 (ms) / GPU bubble ratio: 62.47%
[rank2]:2025-10-25 12:13:09,586 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 1.2321e-01
[rank3]:2025-10-25 12:13:09,598 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 1.6640e-01
[rank1]:2025-10-25 12:13:09,591 - INFO - Freezing Ratio: [Stage1] 0.67, [Stage5] 0.00, Threshold: 2.9637e-01
[rank0]:2025-10-25 12:13:09,595 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 2.5577e-01
[rank0]:2025-10-25 12:13:43,374 - INFO - [GC] Peforming periodical GC collection 0.21 seconds
[rank1]:2025-10-25 12:13:51,787 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 3.4421e-01
[rank0]:2025-10-25 12:13:51,813 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 1.6466e-01
[rank2]:2025-10-25 12:13:51,783 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 3.7092e-01
[rank3]:2025-10-25 12:13:51,799 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 4.1296e-01
[rank1]:2025-10-25 12:14:35,134 - INFO - Freezing Ratio: [Stage1] 0.67, [Stage5] 0.00, Threshold: 2.4003e-01
[rank0]:2025-10-25 12:14:35,134 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 2.8285e-01
[rank2]:2025-10-25 12:14:35,126 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 1.7236e-01
[rank3]:2025-10-25 12:14:35,138 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 3.0194e-01
[rank1]:2025-10-25 12:15:17,168 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 2.6437e-01
[rank1]:2025-10-25 12:15:17,169 - INFO -  step: 560  loss: -4.0000  grad_norm:  0.4851  memory: 15.15GiB(31.88%)  tps: 1,916  tflops: 14.98  mfu: 4.80%
[rank0]:2025-10-25 12:15:17,191 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 5.7236e-02
[rank0]:2025-10-25 12:15:17,192 - INFO -  step: 560  loss: -4.0000  grad_norm:  0.4851  memory: 17.51GiB(36.85%)  tps: 1,916  tflops: 14.98  mfu: 4.80%
[rank2]:2025-10-25 12:15:17,164 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 1.9395e-01
[rank2]:2025-10-25 12:15:17,164 - INFO -  step: 560  loss: -4.0000  grad_norm:  0.4851  memory:  9.81GiB(20.65%)  tps: 1,916  tflops: 14.98  mfu: 4.80%
[rank3]:2025-10-25 12:15:17,179 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 3.5223e-01
[rank3]:2025-10-25 12:15:17,182 - INFO -  step: 560  loss:  0.9193  grad_norm:  0.4851  memory: 26.78GiB(56.38%)  tps: 1,916  tflops: 14.98  mfu: 4.80%
[rank3]:2025-10-25 12:15:19,215 - INFO - Avg. fwd time: 33.7872 / Avg. bwd time: 69.5974 / Avg. batch time: 1874.4781 (ms) / GPU bubble ratio: 11.75%
[rank2]:2025-10-25 12:15:19,269 - INFO - Avg. fwd time: 17.3209 / Avg. bwd time: 25.6623 / Avg. batch time: 1942.8642 (ms) / GPU bubble ratio: 64.60%
[rank1]:2025-10-25 12:15:19,348 - INFO - Avg. fwd time: 22.8469 / Avg. bwd time: 38.6850 / Avg. batch time: 2042.7920 (ms) / GPU bubble ratio: 51.81%
[rank0]:2025-10-25 12:15:19,377 - INFO - Avg. fwd time: 19.5846 / Avg. bwd time: 29.4989 / Avg. batch time: 2092.5241 (ms) / GPU bubble ratio: 62.47%
[rank1]:2025-10-25 12:16:00,634 - INFO - Freezing Ratio: [Stage1] 0.67, [Stage5] 0.00, Threshold: 1.4322e-01
[rank0]:2025-10-25 12:16:00,637 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 2.0102e-01
[rank2]:2025-10-25 12:16:00,629 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 1.2140e-01
[rank3]:2025-10-25 12:16:00,641 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 9.4405e-02
[rank2]:2025-10-25 12:16:42,465 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 4.5877e-01
[rank1]:2025-10-25 12:16:42,469 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 4.7492e-01
[rank0]:2025-10-25 12:16:42,495 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 1.6418e-01
[rank3]:2025-10-25 12:16:42,480 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 3.4475e-01
[rank3]:2025-10-25 12:17:25,808 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 2.6896e-01
[rank2]:2025-10-25 12:17:25,796 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 6.3401e-02
[rank1]:2025-10-25 12:17:25,806 - INFO - Freezing Ratio: [Stage1] 0.67, [Stage5] 0.00, Threshold: 1.3268e-01
[rank0]:2025-10-25 12:17:25,804 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 1.5495e-01
[rank3]:2025-10-25 12:17:33,268 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 12:17:34,136 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 12:17:34,177 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 12:17:34,217 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 12:18:07,685 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 3.0360e-01
[rank2]:2025-10-25 12:18:07,686 - INFO -  step: 580  loss: -4.0000  grad_norm:  0.4760  memory:  9.81GiB(20.65%)  tps: 1,922  tflops: 15.02  mfu: 4.81%
[rank1]:2025-10-25 12:18:07,693 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 3.0438e-01
[rank1]:2025-10-25 12:18:07,693 - INFO -  step: 580  loss: -4.0000  grad_norm:  0.4760  memory: 15.15GiB(31.88%)  tps: 1,922  tflops: 15.02  mfu: 4.81%
[rank0]:2025-10-25 12:18:07,712 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 1.1784e-01
[rank0]:2025-10-25 12:18:07,712 - INFO -  step: 580  loss: -4.0000  grad_norm:  0.4760  memory: 17.51GiB(36.85%)  tps: 1,922  tflops: 15.02  mfu: 4.81%
[rank3]:2025-10-25 12:18:07,701 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 2.1236e-01
[rank3]:2025-10-25 12:18:07,703 - INFO -  step: 580  loss:  0.8558  grad_norm:  0.4760  memory: 26.78GiB(56.38%)  tps: 1,922  tflops: 15.02  mfu: 4.81%
[rank3]:2025-10-25 12:18:09,721 - INFO - Avg. fwd time: 33.7910 / Avg. bwd time: 69.5943 / Avg. batch time: 1874.4640 (ms) / GPU bubble ratio: 11.75%
[rank2]:2025-10-25 12:18:09,764 - INFO - Avg. fwd time: 17.3208 / Avg. bwd time: 25.6400 / Avg. batch time: 1942.6960 (ms) / GPU bubble ratio: 64.62%
[rank1]:2025-10-25 12:18:09,845 - INFO - Avg. fwd time: 22.8424 / Avg. bwd time: 38.6229 / Avg. batch time: 2042.3998 (ms) / GPU bubble ratio: 51.85%
[rank0]:2025-10-25 12:18:09,875 - INFO - Avg. fwd time: 19.5799 / Avg. bwd time: 29.4819 / Avg. batch time: 2092.1247 (ms) / GPU bubble ratio: 62.48%
[rank1]:2025-10-25 12:18:50,956 - INFO - Freezing Ratio: [Stage1] 0.67, [Stage5] 0.00, Threshold: 5.7349e-01
[rank0]:2025-10-25 12:18:50,959 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 6.0592e-01
[rank3]:2025-10-25 12:18:50,963 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 4.5466e-01
[rank2]:2025-10-25 12:18:50,951 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 3.0998e-01
[rank2]:2025-10-25 12:19:32,779 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 5.9304e-01
[rank1]:2025-10-25 12:19:32,783 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 6.4181e-01
[rank0]:2025-10-25 12:19:32,806 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 2.5384e-01
[rank3]:2025-10-25 12:19:32,794 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 3.5521e-01
[rank0]:2025-10-25 12:20:16,126 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 4.4268e-01
[rank3]:2025-10-25 12:20:16,129 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 3.2132e-01
[rank2]:2025-10-25 12:20:16,118 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 2.0292e-01
[rank1]:2025-10-25 12:20:16,123 - INFO - Freezing Ratio: [Stage1] 0.67, [Stage5] 0.00, Threshold: 4.8192e-01
[rank0]:2025-10-25 12:20:49,489 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-25 12:20:57,889 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 2.1351e-01
[rank2]:2025-10-25 12:20:57,890 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.4875  memory:  9.81GiB(20.65%)  tps: 1,925  tflops: 15.05  mfu: 4.82%
[rank1]:2025-10-25 12:20:57,894 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 1.9330e-01
[rank1]:2025-10-25 12:20:57,894 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.4875  memory: 15.15GiB(31.88%)  tps: 1,925  tflops: 15.05  mfu: 4.82%
[rank0]:2025-10-25 12:20:57,921 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 8.4210e-02
[rank0]:2025-10-25 12:20:57,921 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.4875  memory: 17.51GiB(36.85%)  tps: 1,925  tflops: 15.05  mfu: 4.82%
[rank3]:2025-10-25 12:20:57,905 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 2.0041e-01
[rank3]:2025-10-25 12:20:57,908 - INFO -  step: 600  loss:  0.8824  grad_norm:  0.4875  memory: 26.78GiB(56.38%)  tps: 1,925  tflops: 15.05  mfu: 4.82%
[rank2]:2025-10-25 12:20:58,001 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_auto_dm1/freeze_ratio_history/rank2/251025_1220_stage2_step600.svg
[rank1]:2025-10-25 12:20:58,006 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_auto_dm1/freeze_ratio_history/rank1/251025_1220_stage1_step600.svg
[rank0]:2025-10-25 12:20:57,999 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_auto_dm1/freeze_ratio_history/rank0/251025_1220_stage0_step600.svg
[rank0]:2025-10-25 12:20:58,057 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_auto_dm1/freeze_ratio_history/rank0/251025_1220_stage4_step600.svg
[rank2]:2025-10-25 12:20:58,058 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_auto_dm1/freeze_ratio_history/rank2/251025_1220_stage6_step600.svg
[rank1]:2025-10-25 12:20:58,065 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_auto_dm1/freeze_ratio_history/rank1/251025_1220_stage5_step600.svg
[rank3]:2025-10-25 12:20:58,285 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_auto_dm1/pipeline_schedule/251025_1220_real_step600_rank3.svg
[rank3]:> Batch Time: 1904.94 ms, GPU Bubble Ratio: 56.87%, 47.40%, 62.33%, 11.64%
[rank3]:2025-10-25 12:20:58,350 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_auto_dm1/freeze_ratio_history/rank3/251025_1220_stage3_step600.svg
[rank3]:2025-10-25 12:20:58,408 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_auto_dm1/freeze_ratio_history/rank3/251025_1220_stage7_step600.svg
[rank3]:2025-10-25 12:21:00,362 - INFO - Avg. fwd time: 33.7922 / Avg. bwd time: 69.5888 / Avg. batch time: 1874.3699 (ms) / GPU bubble ratio: 11.75%
[rank2]:2025-10-25 12:21:00,416 - INFO - Avg. fwd time: 17.3193 / Avg. bwd time: 25.6192 / Avg. batch time: 1942.5719 (ms) / GPU bubble ratio: 64.63%
[rank1]:2025-10-25 12:21:00,495 - INFO - Avg. fwd time: 22.8380 / Avg. bwd time: 38.5612 / Avg. batch time: 2042.0512 (ms) / GPU bubble ratio: 51.89%
[rank0]:2025-10-25 12:21:00,525 - INFO - Avg. fwd time: 19.5792 / Avg. bwd time: 29.4658 / Avg. batch time: 2091.7672 (ms) / GPU bubble ratio: 62.49%
[rank1]:2025-10-25 12:21:41,690 - INFO - Freezing Ratio: [Stage1] 0.67, [Stage5] 0.00, Threshold: 2.0854e-01
[rank0]:2025-10-25 12:21:41,694 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 2.1459e-01
[rank3]:2025-10-25 12:21:41,697 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 2.4340e-01
[rank2]:2025-10-25 12:21:41,686 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 7.3773e-02
[rank2]:2025-10-25 12:22:23,620 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 4.5486e-01
[rank1]:2025-10-25 12:22:23,625 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 3.8967e-01
[rank0]:2025-10-25 12:22:23,649 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 8.2891e-02
[rank3]:2025-10-25 12:22:23,636 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 2.9933e-01
[rank2]:2025-10-25 12:23:07,160 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 1.6932e-01
[rank1]:2025-10-25 12:23:07,172 - INFO - Freezing Ratio: [Stage1] 0.67, [Stage5] 0.00, Threshold: 1.9000e-01
[rank0]:2025-10-25 12:23:07,168 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 2.3138e-01
[rank3]:2025-10-25 12:23:07,171 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 1.5553e-01
[rank1]:2025-10-25 12:23:48,965 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 1.6556e-01
[rank1]:2025-10-25 12:23:48,966 - INFO -  step: 620  loss: -4.0000  grad_norm:  0.4544  memory: 15.15GiB(31.88%)  tps: 1,915  tflops: 14.97  mfu: 4.80%
[rank0]:2025-10-25 12:23:48,988 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 4.6120e-02
[rank0]:2025-10-25 12:23:48,989 - INFO -  step: 620  loss: -4.0000  grad_norm:  0.4544  memory: 17.51GiB(36.85%)  tps: 1,916  tflops: 14.97  mfu: 4.80%
[rank3]:2025-10-25 12:23:48,977 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 2.6274e-01
[rank3]:2025-10-25 12:23:48,981 - INFO -  step: 620  loss:  0.8892  grad_norm:  0.4544  memory: 26.78GiB(56.38%)  tps: 1,915  tflops: 14.97  mfu: 4.80%
[rank2]:2025-10-25 12:23:48,961 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 3.6301e-01
[rank2]:2025-10-25 12:23:48,962 - INFO -  step: 620  loss: -4.0000  grad_norm:  0.4544  memory:  9.81GiB(20.65%)  tps: 1,915  tflops: 14.97  mfu: 4.80%
[rank3]:2025-10-25 12:23:51,018 - INFO - Avg. fwd time: 33.7945 / Avg. bwd time: 69.5897 / Avg. batch time: 1874.4075 (ms) / GPU bubble ratio: 11.75%
[rank2]:2025-10-25 12:23:51,068 - INFO - Avg. fwd time: 17.3193 / Avg. bwd time: 25.5989 / Avg. batch time: 1942.4681 (ms) / GPU bubble ratio: 64.65%
[rank1]:2025-10-25 12:23:51,148 - INFO - Avg. fwd time: 22.8350 / Avg. bwd time: 38.5041 / Avg. batch time: 2041.7698 (ms) / GPU bubble ratio: 51.93%
[rank0]:2025-10-25 12:23:51,178 - INFO - Avg. fwd time: 19.5789 / Avg. bwd time: 29.4530 / Avg. batch time: 2091.4947 (ms) / GPU bubble ratio: 62.49%
[rank2]:2025-10-25 12:24:32,475 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 1.1050e-01
[rank1]:2025-10-25 12:24:32,487 - INFO - Freezing Ratio: [Stage1] 0.67, [Stage5] 0.00, Threshold: 1.4866e-01
[rank0]:2025-10-25 12:24:32,484 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 1.5071e-01
[rank3]:2025-10-25 12:24:32,487 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 3.0268e-01
[rank3]:2025-10-25 12:25:14,408 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 9.3023e-01
[rank2]:2025-10-25 12:25:14,392 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 6.7043e-01
[rank1]:2025-10-25 12:25:14,399 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 1.2498e+00
[rank0]:2025-10-25 12:25:14,420 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 5.6989e-01
[rank0]:2025-10-25 12:25:57,775 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 1.1363e+00
[rank2]:2025-10-25 12:25:57,766 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 3.7702e-01
[rank3]:2025-10-25 12:25:57,778 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 8.3372e-01
[rank1]:2025-10-25 12:25:57,778 - INFO - Freezing Ratio: [Stage1] 0.67, [Stage5] 0.00, Threshold: 9.9620e-01
[rank3]:2025-10-25 12:26:39,744 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 4.1485e-01
[rank3]:2025-10-25 12:26:39,746 - INFO -  step: 640  loss:  0.8549  grad_norm:  0.4644  memory: 26.78GiB(56.38%)  tps: 1,919  tflops: 15.00  mfu: 4.81%
[rank2]:2025-10-25 12:26:39,728 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 5.7206e-01
[rank2]:2025-10-25 12:26:39,729 - INFO -  step: 640  loss: -4.0000  grad_norm:  0.4644  memory:  9.81GiB(20.65%)  tps: 1,919  tflops: 15.00  mfu: 4.81%
[rank1]:2025-10-25 12:26:39,732 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 4.3828e-01
[rank1]:2025-10-25 12:26:39,733 - INFO -  step: 640  loss: -4.0000  grad_norm:  0.4644  memory: 15.15GiB(31.88%)  tps: 1,919  tflops: 15.00  mfu: 4.81%
[rank0]:2025-10-25 12:26:39,759 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 2.3822e-01
[rank0]:2025-10-25 12:26:39,759 - INFO -  step: 640  loss: -4.0000  grad_norm:  0.4644  memory: 17.51GiB(36.85%)  tps: 1,919  tflops: 15.00  mfu: 4.81%
[rank3]:2025-10-25 12:26:41,753 - INFO - Avg. fwd time: 33.7976 / Avg. bwd time: 69.5924 / Avg. batch time: 1874.4690 (ms) / GPU bubble ratio: 11.75%
[rank2]:2025-10-25 12:26:41,806 - INFO - Avg. fwd time: 17.3198 / Avg. bwd time: 25.5820 / Avg. batch time: 1942.4226 (ms) / GPU bubble ratio: 64.66%
[rank1]:2025-10-25 12:26:41,881 - INFO - Avg. fwd time: 22.8315 / Avg. bwd time: 38.4555 / Avg. batch time: 2041.5692 (ms) / GPU bubble ratio: 51.97%
[rank0]:2025-10-25 12:26:41,911 - INFO - Avg. fwd time: 19.5784 / Avg. bwd time: 29.4362 / Avg. batch time: 2091.2808 (ms) / GPU bubble ratio: 62.50%
[rank1]:2025-10-25 12:27:23,058 - INFO - Freezing Ratio: [Stage1] 0.67, [Stage5] 0.00, Threshold: 2.5636e-01
[rank0]:2025-10-25 12:27:23,054 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 2.0851e-01
[rank2]:2025-10-25 12:27:23,047 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 8.4030e-02
[rank3]:2025-10-25 12:27:23,058 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 2.4764e-01
[rank0]:2025-10-25 12:27:56,559 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-25 12:28:04,968 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 2.5178e-01
[rank2]:2025-10-25 12:28:04,964 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 2.2765e-01
[rank0]:2025-10-25 12:28:04,993 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 1.5035e-01
[rank3]:2025-10-25 12:28:04,979 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 2.8852e-01
[rank1]:2025-10-25 12:28:48,242 - INFO - Freezing Ratio: [Stage1] 0.67, [Stage5] 0.00, Threshold: 2.8664e-01
[rank2]:2025-10-25 12:28:48,231 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 9.9515e-02
[rank0]:2025-10-25 12:28:48,239 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 5.0542e-01
[rank3]:2025-10-25 12:28:48,242 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 2.6227e-01
[rank3]:2025-10-25 12:29:16,609 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 12:29:17,497 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 12:29:17,536 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 12:29:17,578 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 12:29:30,197 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 5.0935e-01
[rank1]:2025-10-25 12:29:30,198 - INFO -  step: 660  loss: -4.0000  grad_norm:  0.4673  memory: 15.15GiB(31.88%)  tps: 1,922  tflops: 15.03  mfu: 4.82%
[rank2]:2025-10-25 12:29:30,193 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 1.8331e-01
[rank2]:2025-10-25 12:29:30,193 - INFO -  step: 660  loss: -4.0000  grad_norm:  0.4673  memory:  9.81GiB(20.65%)  tps: 1,922  tflops: 15.03  mfu: 4.82%
[rank0]:2025-10-25 12:29:30,221 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 2.0395e-01
[rank0]:2025-10-25 12:29:30,221 - INFO -  step: 660  loss: -4.0000  grad_norm:  0.4673  memory: 17.51GiB(36.85%)  tps: 1,922  tflops: 15.03  mfu: 4.82%
[rank3]:2025-10-25 12:29:30,209 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 3.6920e-01
[rank3]:2025-10-25 12:29:30,211 - INFO -  step: 660  loss:  0.8329  grad_norm:  0.4673  memory: 26.78GiB(56.38%)  tps: 1,922  tflops: 15.03  mfu: 4.82%
[rank3]:2025-10-25 12:29:32,228 - INFO - Avg. fwd time: 33.8013 / Avg. bwd time: 69.5860 / Avg. batch time: 1874.4198 (ms) / GPU bubble ratio: 11.75%
[rank2]:2025-10-25 12:29:32,274 - INFO - Avg. fwd time: 17.3201 / Avg. bwd time: 25.5665 / Avg. batch time: 1942.2788 (ms) / GPU bubble ratio: 64.67%
[rank1]:2025-10-25 12:29:32,350 - INFO - Avg. fwd time: 22.8293 / Avg. bwd time: 38.4133 / Avg. batch time: 2041.2721 (ms) / GPU bubble ratio: 52.00%
[rank0]:2025-10-25 12:29:32,380 - INFO - Avg. fwd time: 19.5759 / Avg. bwd time: 29.4189 / Avg. batch time: 2090.9773 (ms) / GPU bubble ratio: 62.51%
[rank1]:2025-10-25 12:30:13,669 - INFO - Freezing Ratio: [Stage1] 0.67, [Stage5] 0.00, Threshold: 1.3044e-01
[rank2]:2025-10-25 12:30:13,664 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 5.5989e-02
[rank0]:2025-10-25 12:30:13,672 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 4.2442e-01
[rank3]:2025-10-25 12:30:13,676 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 2.7369e-01
[rank2]:2025-10-25 12:30:55,453 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 3.0948e-01
[rank0]:2025-10-25 12:30:55,481 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 1.3310e-01
[rank3]:2025-10-25 12:30:55,469 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 3.1281e-01
[rank1]:2025-10-25 12:30:55,459 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 2.3739e-01
[rank0]:2025-10-25 12:31:38,900 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 2.0569e-01
[rank2]:2025-10-25 12:31:38,892 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 1.2591e-01
[rank3]:2025-10-25 12:31:38,904 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 7.6391e-02
[rank1]:2025-10-25 12:31:38,898 - INFO - Freezing Ratio: [Stage1] 0.67, [Stage5] 0.00, Threshold: 1.1625e-01
[rank0]:2025-10-25 12:32:20,670 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 2.4730e-01
[rank0]:2025-10-25 12:32:20,671 - INFO -  step: 680  loss: -4.0000  grad_norm:  0.5207  memory: 17.51GiB(36.85%)  tps: 1,922  tflops: 15.03  mfu: 4.82%
[rank2]:2025-10-25 12:32:20,643 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 3.1688e-01
[rank2]:2025-10-25 12:32:20,643 - INFO -  step: 680  loss: -4.0000  grad_norm:  0.5207  memory:  9.81GiB(20.65%)  tps: 1,922  tflops: 15.03  mfu: 4.82%
[rank3]:2025-10-25 12:32:20,658 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 4.2051e-01
[rank3]:2025-10-25 12:32:20,661 - INFO -  step: 680  loss:  0.8357  grad_norm:  0.5207  memory: 26.78GiB(56.38%)  tps: 1,922  tflops: 15.03  mfu: 4.82%
[rank1]:2025-10-25 12:32:20,648 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 2.1429e-01
[rank1]:2025-10-25 12:32:20,648 - INFO -  step: 680  loss: -4.0000  grad_norm:  0.5207  memory: 15.15GiB(31.88%)  tps: 1,922  tflops: 15.03  mfu: 4.82%
[rank3]:2025-10-25 12:32:22,700 - INFO - Avg. fwd time: 33.8031 / Avg. bwd time: 69.5817 / Avg. batch time: 1874.3541 (ms) / GPU bubble ratio: 11.75%
[rank2]:2025-10-25 12:32:22,751 - INFO - Avg. fwd time: 17.3211 / Avg. bwd time: 25.5533 / Avg. batch time: 1942.1419 (ms) / GPU bubble ratio: 64.68%
[rank1]:2025-10-25 12:32:22,828 - INFO - Avg. fwd time: 22.8259 / Avg. bwd time: 38.3736 / Avg. batch time: 2041.0062 (ms) / GPU bubble ratio: 52.02%
[rank0]:2025-10-25 12:32:22,859 - INFO - Avg. fwd time: 19.5693 / Avg. bwd time: 29.4031 / Avg. batch time: 2090.7007 (ms) / GPU bubble ratio: 62.52%
[rank1]:2025-10-25 12:33:04,074 - INFO - Freezing Ratio: [Stage1] 0.67, [Stage5] 0.00, Threshold: 2.2571e-01
[rank0]:2025-10-25 12:33:04,073 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 3.9147e-01
[rank2]:2025-10-25 12:33:04,065 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 8.8538e-02
[rank3]:2025-10-25 12:33:04,076 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 2.7646e-01
[rank1]:2025-10-25 12:33:46,041 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 3.6186e-01
[rank0]:2025-10-25 12:33:46,068 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 1.6120e-01
[rank2]:2025-10-25 12:33:46,037 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 2.9809e-01
[rank3]:2025-10-25 12:33:46,053 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 4.4976e-01
[rank0]:2025-10-25 12:34:29,435 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 2.8249e-01
[rank2]:2025-10-25 12:34:29,426 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 1.3776e-01
[rank3]:2025-10-25 12:34:29,438 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 2.1178e-01
[rank1]:2025-10-25 12:34:29,438 - INFO - Freezing Ratio: [Stage1] 0.67, [Stage5] 0.00, Threshold: 2.4028e-01
[rank0]:2025-10-25 12:35:03,016 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-25 12:35:11,357 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 5.1909e-01
[rank1]:2025-10-25 12:35:11,357 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.5982  memory: 15.15GiB(31.88%)  tps: 1,920  tflops: 15.01  mfu: 4.81%
[rank0]:2025-10-25 12:35:11,382 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 3.0034e-01
[rank0]:2025-10-25 12:35:11,383 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.5982  memory: 17.51GiB(36.85%)  tps: 1,919  tflops: 15.01  mfu: 4.81%
[rank2]:2025-10-25 12:35:11,353 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 2.4786e-01
[rank2]:2025-10-25 12:35:11,353 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.5982  memory:  9.81GiB(20.65%)  tps: 1,920  tflops: 15.01  mfu: 4.81%
[rank3]:2025-10-25 12:35:11,368 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 7.1341e-01
[rank3]:2025-10-25 12:35:11,371 - INFO -  step: 700  loss:  0.8418  grad_norm:  0.5982  memory: 26.78GiB(56.38%)  tps: 1,920  tflops: 15.01  mfu: 4.81%
[rank1]:2025-10-25 12:35:11,472 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_auto_dm1/freeze_ratio_history/rank1/251025_1235_stage1_step700.svg
[rank0]:2025-10-25 12:35:11,465 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_auto_dm1/freeze_ratio_history/rank0/251025_1235_stage0_step700.svg
[rank2]:2025-10-25 12:35:11,468 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_auto_dm1/freeze_ratio_history/rank2/251025_1235_stage2_step700.svg
[rank1]:2025-10-25 12:35:11,534 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_auto_dm1/freeze_ratio_history/rank1/251025_1235_stage5_step700.svg
[rank0]:2025-10-25 12:35:11,525 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_auto_dm1/freeze_ratio_history/rank0/251025_1235_stage4_step700.svg
[rank2]:2025-10-25 12:35:11,528 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_auto_dm1/freeze_ratio_history/rank2/251025_1235_stage6_step700.svg
[rank3]:2025-10-25 12:35:11,752 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_auto_dm1/pipeline_schedule/251025_1235_real_step700_rank3.svg
[rank3]:> Batch Time: 1904.58 ms, GPU Bubble Ratio: 56.92%, 47.45%, 62.36%, 11.61%
[rank3]:2025-10-25 12:35:11,821 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_auto_dm1/freeze_ratio_history/rank3/251025_1235_stage3_step700.svg
[rank3]:2025-10-25 12:35:11,882 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_auto_dm1/freeze_ratio_history/rank3/251025_1235_stage7_step700.svg
[rank2]:2025-10-25 12:35:13,891 - INFO - Avg. fwd time: 17.3209 / Avg. bwd time: 25.5407 / Avg. batch time: 1942.1676 (ms) / GPU bubble ratio: 64.69%
[rank3]:2025-10-25 12:35:13,846 - INFO - Avg. fwd time: 33.8059 / Avg. bwd time: 69.5808 / Avg. batch time: 1874.3678 (ms) / GPU bubble ratio: 11.75%
[rank1]:2025-10-25 12:35:13,966 - INFO - Avg. fwd time: 22.8198 / Avg. bwd time: 38.3295 / Avg. batch time: 2040.8984 (ms) / GPU bubble ratio: 52.06%
[rank0]:2025-10-25 12:35:13,996 - INFO - Avg. fwd time: 19.5684 / Avg. bwd time: 29.3954 / Avg. batch time: 2090.5981 (ms) / GPU bubble ratio: 62.53%
[rank2]:2025-10-25 12:35:55,233 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 1.3085e-01
[rank0]:2025-10-25 12:35:55,241 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 6.2914e-01
[rank3]:2025-10-25 12:35:55,245 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 3.8249e-01
[rank1]:2025-10-25 12:35:55,244 - INFO - Freezing Ratio: [Stage1] 0.67, [Stage5] 0.00, Threshold: 2.7278e-01
[rank1]:2025-10-25 12:36:37,068 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 4.8059e-01
[rank0]:2025-10-25 12:36:37,091 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 1.6105e-01
[rank2]:2025-10-25 12:36:37,064 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 2.7860e-01
[rank3]:2025-10-25 12:36:37,080 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 4.1161e-01
[rank3]:2025-10-25 12:37:20,413 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 1.0194e-01
[rank1]:2025-10-25 12:37:20,408 - INFO - Freezing Ratio: [Stage1] 0.67, [Stage5] 0.00, Threshold: 2.8213e-01
[rank0]:2025-10-25 12:37:20,409 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 2.3638e-01
[rank2]:2025-10-25 12:37:20,401 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 6.9679e-02
[rank0]:2025-10-25 12:38:02,327 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 1.3322e-01
[rank0]:2025-10-25 12:38:02,327 - INFO -  step: 720  loss: -4.0000  grad_norm:  0.4843  memory: 17.51GiB(36.85%)  tps: 1,917  tflops: 14.99  mfu: 4.80%
[rank2]:2025-10-25 12:38:02,292 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 2.3172e-01
[rank2]:2025-10-25 12:38:02,293 - INFO -  step: 720  loss: -4.0000  grad_norm:  0.4843  memory:  9.81GiB(20.65%)  tps: 1,917  tflops: 14.99  mfu: 4.80%
[rank3]:2025-10-25 12:38:02,308 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 3.4170e-01
[rank3]:2025-10-25 12:38:02,310 - INFO -  step: 720  loss:  0.8224  grad_norm:  0.4843  memory: 26.78GiB(56.38%)  tps: 1,917  tflops: 14.99  mfu: 4.80%
[rank1]:2025-10-25 12:38:02,300 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 3.3765e-01
[rank1]:2025-10-25 12:38:02,300 - INFO -  step: 720  loss: -4.0000  grad_norm:  0.4843  memory: 15.15GiB(31.88%)  tps: 1,917  tflops: 14.99  mfu: 4.80%
[rank3]:2025-10-25 12:38:04,328 - INFO - Avg. fwd time: 33.8083 / Avg. bwd time: 69.5763 / Avg. batch time: 1874.3063 (ms) / GPU bubble ratio: 11.75%
[rank2]:2025-10-25 12:38:04,377 - INFO - Avg. fwd time: 17.3203 / Avg. bwd time: 25.5269 / Avg. batch time: 1942.0252 (ms) / GPU bubble ratio: 64.70%
[rank1]:2025-10-25 12:38:04,454 - INFO - Avg. fwd time: 22.8131 / Avg. bwd time: 38.2817 / Avg. batch time: 2040.6522 (ms) / GPU bubble ratio: 52.10%
[rank0]:2025-10-25 12:38:04,485 - INFO - Avg. fwd time: 19.5685 / Avg. bwd time: 29.3886 / Avg. batch time: 2090.3547 (ms) / GPU bubble ratio: 62.53%
[rank2]:2025-10-25 12:38:45,772 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 1.4263e-01
[rank0]:2025-10-25 12:38:45,781 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 2.2631e-01
[rank3]:2025-10-25 12:38:45,784 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 2.1046e-01
[rank1]:2025-10-25 12:38:45,779 - INFO - Freezing Ratio: [Stage1] 0.67, [Stage5] 0.00, Threshold: 1.9648e-01
[rank3]:2025-10-25 12:39:27,683 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 5.3512e-01
[rank1]:2025-10-25 12:39:27,672 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 7.9205e-01
[rank0]:2025-10-25 12:39:27,698 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 3.1851e-01
[rank2]:2025-10-25 12:39:27,668 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 8.2295e-01
[rank2]:2025-10-25 12:40:11,017 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 3.2666e-01
[rank3]:2025-10-25 12:40:11,029 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 3.1352e-01
[rank1]:2025-10-25 12:40:11,022 - INFO - Freezing Ratio: [Stage1] 0.67, [Stage5] 0.00, Threshold: 8.4250e-01
[rank0]:2025-10-25 12:40:11,025 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 8.1329e-01
[rank2]:2025-10-25 12:40:52,975 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 3.4516e-01
[rank2]:2025-10-25 12:40:52,976 - INFO -  step: 740  loss: -4.0000  grad_norm:  0.4836  memory:  9.81GiB(20.65%)  tps: 1,920  tflops: 15.01  mfu: 4.81%
[rank3]:2025-10-25 12:40:52,991 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 1.8183e-01
[rank3]:2025-10-25 12:40:52,993 - INFO -  step: 740  loss:  0.8181  grad_norm:  0.4836  memory: 26.78GiB(56.38%)  tps: 1,920  tflops: 15.01  mfu: 4.81%
[rank1]:2025-10-25 12:40:52,980 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 3.3978e-01
[rank1]:2025-10-25 12:40:52,980 - INFO -  step: 740  loss: -4.0000  grad_norm:  0.4836  memory: 15.15GiB(31.88%)  tps: 1,920  tflops: 15.01  mfu: 4.81%
[rank0]:2025-10-25 12:40:53,005 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 5.6118e-02
[rank0]:2025-10-25 12:40:53,005 - INFO -  step: 740  loss: -4.0000  grad_norm:  0.4836  memory: 17.51GiB(36.85%)  tps: 1,920  tflops: 15.01  mfu: 4.81%
[rank2]:2025-10-25 12:40:55,062 - INFO - Avg. fwd time: 17.3212 / Avg. bwd time: 25.5160 / Avg. batch time: 1942.0086 (ms) / GPU bubble ratio: 64.71%
[rank3]:2025-10-25 12:40:55,019 - INFO - Avg. fwd time: 33.8126 / Avg. bwd time: 69.5769 / Avg. batch time: 1874.3609 (ms) / GPU bubble ratio: 11.74%
[rank0]:2025-10-25 12:40:55,167 - INFO - Avg. fwd time: 19.5662 / Avg. bwd time: 29.3752 / Avg. batch time: 2090.1865 (ms) / GPU bubble ratio: 62.54%
[rank1]:2025-10-25 12:40:55,136 - INFO - Avg. fwd time: 22.8119 / Avg. bwd time: 38.2464 / Avg. batch time: 2040.4978 (ms) / GPU bubble ratio: 52.12%
[rank3]:2025-10-25 12:40:58,548 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 12:40:59,445 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 12:40:59,501 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 12:40:59,521 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 12:41:36,420 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 1.6096e-01
[rank2]:2025-10-25 12:41:36,413 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 1.0303e-01
[rank3]:2025-10-25 12:41:36,424 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 1.7078e-01
[rank1]:2025-10-25 12:41:36,417 - INFO - Freezing Ratio: [Stage1] 0.67, [Stage5] 0.00, Threshold: 1.1811e-01
[rank0]:2025-10-25 12:42:09,936 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-25 12:42:18,365 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 4.3018e-01
[rank2]:2025-10-25 12:42:18,337 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 6.5567e-01
[rank3]:2025-10-25 12:42:18,353 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 6.8617e-01
[rank1]:2025-10-25 12:42:18,341 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 8.5026e-01
[rank0]:2025-10-25 12:43:01,788 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 4.4637e-01
[rank2]:2025-10-25 12:43:01,780 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 1.7724e-01
[rank3]:2025-10-25 12:43:01,792 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 3.1927e-01
[rank1]:2025-10-25 12:43:01,785 - INFO - Freezing Ratio: [Stage1] 0.67, [Stage5] 0.00, Threshold: 3.4522e-01
[rank2]:2025-10-25 12:43:43,790 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 4.6885e-01
[rank2]:2025-10-25 12:43:43,790 - INFO -  step: 760  loss: -4.0000  grad_norm:  0.5012  memory:  9.81GiB(20.65%)  tps: 1,918  tflops: 15.00  mfu: 4.81%
[rank3]:2025-10-25 12:43:43,806 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 2.2123e-01
[rank3]:2025-10-25 12:43:43,808 - INFO -  step: 760  loss:  0.8030  grad_norm:  0.5012  memory: 26.78GiB(56.38%)  tps: 1,918  tflops: 15.00  mfu: 4.81%
[rank1]:2025-10-25 12:43:43,794 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 3.9235e-01
[rank1]:2025-10-25 12:43:43,794 - INFO -  step: 760  loss: -4.0000  grad_norm:  0.5012  memory: 15.15GiB(31.88%)  tps: 1,918  tflops: 15.00  mfu: 4.81%
[rank0]:2025-10-25 12:43:43,818 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 1.3652e-01
[rank0]:2025-10-25 12:43:43,818 - INFO -  step: 760  loss: -4.0000  grad_norm:  0.5012  memory: 17.51GiB(36.85%)  tps: 1,918  tflops: 15.00  mfu: 4.81%
[rank2]:2025-10-25 12:43:45,878 - INFO - Avg. fwd time: 17.3205 / Avg. bwd time: 25.5008 / Avg. batch time: 1941.9991 (ms) / GPU bubble ratio: 64.72%
[rank3]:2025-10-25 12:43:45,827 - INFO - Avg. fwd time: 33.8147 / Avg. bwd time: 69.5787 / Avg. batch time: 1874.4205 (ms) / GPU bubble ratio: 11.74%
[rank0]:2025-10-25 12:43:45,989 - INFO - Avg. fwd time: 19.5717 / Avg. bwd time: 29.3708 / Avg. batch time: 2090.0773 (ms) / GPU bubble ratio: 62.53%
[rank1]:2025-10-25 12:43:45,957 - INFO - Avg. fwd time: 22.8078 / Avg. bwd time: 38.2117 / Avg. batch time: 2040.3811 (ms) / GPU bubble ratio: 52.15%
[rank2]:2025-10-25 12:44:27,245 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 8.3890e-02
[rank0]:2025-10-25 12:44:27,254 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 3.7434e-01
[rank3]:2025-10-25 12:44:27,257 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 2.5996e-01
[rank1]:2025-10-25 12:44:27,251 - INFO - Freezing Ratio: [Stage1] 0.67, [Stage5] 0.00, Threshold: 3.0479e-01
[rank0]:2025-10-25 12:45:09,271 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 2.7752e-01
[rank2]:2025-10-25 12:45:09,240 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 3.0640e-01
[rank1]:2025-10-25 12:45:09,244 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 6.8574e-01
[rank3]:2025-10-25 12:45:09,256 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 6.0656e-01
[rank1]:2025-10-25 12:45:52,649 - INFO - Freezing Ratio: [Stage1] 0.67, [Stage5] 0.00, Threshold: 8.1696e-01
[rank0]:2025-10-25 12:45:52,649 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 7.9233e-01
[rank2]:2025-10-25 12:45:52,642 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 1.3641e-01
[rank3]:2025-10-25 12:45:52,654 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 3.1129e-01
[rank2]:2025-10-25 12:46:34,530 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 7.4091e-01
[rank2]:2025-10-25 12:46:34,531 - INFO -  step: 780  loss: -4.0000  grad_norm:  0.6357  memory:  9.81GiB(20.65%)  tps: 1,919  tflops: 15.00  mfu: 4.81%
[rank3]:2025-10-25 12:46:34,545 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 8.7529e-01
[rank3]:2025-10-25 12:46:34,548 - INFO -  step: 780  loss:  0.8030  grad_norm:  0.6357  memory: 26.78GiB(56.38%)  tps: 1,919  tflops: 15.00  mfu: 4.81%
[rank1]:2025-10-25 12:46:34,534 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 1.1489e+00
[rank1]:2025-10-25 12:46:34,535 - INFO -  step: 780  loss: -4.0000  grad_norm:  0.6357  memory: 15.15GiB(31.88%)  tps: 1,919  tflops: 15.00  mfu: 4.81%
[rank0]:2025-10-25 12:46:34,558 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 5.1006e-01
[rank0]:2025-10-25 12:46:34,559 - INFO -  step: 780  loss: -4.0000  grad_norm:  0.6357  memory: 17.51GiB(36.85%)  tps: 1,919  tflops: 15.00  mfu: 4.81%
[rank2]:2025-10-25 12:46:36,621 - INFO - Avg. fwd time: 17.3204 / Avg. bwd time: 25.4895 / Avg. batch time: 1941.9508 (ms) / GPU bubble ratio: 64.73%
[rank3]:2025-10-25 12:46:36,570 - INFO - Avg. fwd time: 33.8183 / Avg. bwd time: 69.5781 / Avg. batch time: 1874.4503 (ms) / GPU bubble ratio: 11.74%
[rank1]:2025-10-25 12:46:36,698 - INFO - Avg. fwd time: 22.8073 / Avg. bwd time: 38.1791 / Avg. batch time: 2040.2193 (ms) / GPU bubble ratio: 52.17%
[rank0]:2025-10-25 12:46:36,730 - INFO - Avg. fwd time: 19.5669 / Avg. bwd time: 29.3621 / Avg. batch time: 2089.9133 (ms) / GPU bubble ratio: 62.54%
[rank0]:2025-10-25 12:47:18,081 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 7.5126e-01
[rank2]:2025-10-25 12:47:18,072 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 1.4772e-01
[rank3]:2025-10-25 12:47:18,084 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 3.0376e-01
[rank1]:2025-10-25 12:47:18,078 - INFO - Freezing Ratio: [Stage1] 0.67, [Stage5] 0.00, Threshold: 5.2384e-01
[rank1]:2025-10-25 12:47:59,992 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 4.3417e-01
[rank0]:2025-10-25 12:48:00,024 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 1.1662e-01
[rank2]:2025-10-25 12:47:59,988 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 4.0226e-01
[rank3]:2025-10-25 12:48:00,003 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 1.9266e-01
[rank1]:2025-10-25 12:48:43,433 - INFO - Freezing Ratio: [Stage1] 0.67, [Stage5] 0.00, Threshold: 1.1872e-01
[rank0]:2025-10-25 12:48:43,436 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 8.7271e-02
[rank2]:2025-10-25 12:48:43,427 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 1.0502e-01
[rank3]:2025-10-25 12:48:43,439 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 1.1165e-01
[rank0]:2025-10-25 12:49:17,021 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-25 12:49:25,351 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 1.2486e+00
[rank2]:2025-10-25 12:49:25,351 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.6178  memory:  9.81GiB(20.65%)  tps: 1,918  tflops: 15.00  mfu: 4.81%
[rank3]:2025-10-25 12:49:25,366 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 1.0593e+00
[rank3]:2025-10-25 12:49:25,369 - INFO -  step: 800  loss:  0.7725  grad_norm:  0.6178  memory: 26.78GiB(56.38%)  tps: 1,918  tflops: 15.00  mfu: 4.81%
[rank1]:2025-10-25 12:49:25,355 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 1.2277e+00
[rank1]:2025-10-25 12:49:25,355 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.6178  memory: 15.15GiB(31.88%)  tps: 1,918  tflops: 15.00  mfu: 4.81%
[rank0]:2025-10-25 12:49:25,379 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 5.6676e-01
[rank0]:2025-10-25 12:49:25,379 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.6178  memory: 17.51GiB(36.85%)  tps: 1,918  tflops: 15.00  mfu: 4.81%
[rank2]:2025-10-25 12:49:25,469 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_auto_dm1/freeze_ratio_history/rank2/251025_1249_stage2_step800.svg
[rank1]:2025-10-25 12:49:25,473 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_auto_dm1/freeze_ratio_history/rank1/251025_1249_stage1_step800.svg
[rank1]:2025-10-25 12:49:25,539 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_auto_dm1/freeze_ratio_history/rank1/251025_1249_stage5_step800.svg
[rank0]:2025-10-25 12:49:25,466 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_auto_dm1/freeze_ratio_history/rank0/251025_1249_stage0_step800.svg
[rank0]:2025-10-25 12:49:25,530 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_auto_dm1/freeze_ratio_history/rank0/251025_1249_stage4_step800.svg
[rank2]:2025-10-25 12:49:25,533 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_auto_dm1/freeze_ratio_history/rank2/251025_1249_stage6_step800.svg
[rank3]:2025-10-25 12:49:25,753 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_auto_dm1/pipeline_schedule/251025_1249_real_step800_rank3.svg
[rank3]:> Batch Time: 1904.42 ms, GPU Bubble Ratio: 56.94%, 47.53%, 62.40%, 11.58%
[rank3]:2025-10-25 12:49:25,824 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_auto_dm1/freeze_ratio_history/rank3/251025_1249_stage3_step800.svg
[rank3]:2025-10-25 12:49:25,888 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_auto_dm1/freeze_ratio_history/rank3/251025_1249_stage7_step800.svg
[rank3]:2025-10-25 12:49:27,840 - INFO - Avg. fwd time: 33.8215 / Avg. bwd time: 69.5789 / Avg. batch time: 1874.4968 (ms) / GPU bubble ratio: 11.74%
[rank2]:2025-10-25 12:49:27,890 - INFO - Avg. fwd time: 17.3203 / Avg. bwd time: 25.4793 / Avg. batch time: 1942.0198 (ms) / GPU bubble ratio: 64.74%
[rank1]:2025-10-25 12:49:27,972 - INFO - Avg. fwd time: 22.8026 / Avg. bwd time: 38.1420 / Avg. batch time: 2040.1807 (ms) / GPU bubble ratio: 52.20%
[rank0]:2025-10-25 12:49:28,003 - INFO - Avg. fwd time: 19.5675 / Avg. bwd time: 29.3527 / Avg. batch time: 2089.8791 (ms) / GPU bubble ratio: 62.55%
[rank2]:2025-10-25 12:50:09,221 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 3.9959e-01
[rank1]:2025-10-25 12:50:09,230 - INFO - Freezing Ratio: [Stage1] 0.67, [Stage5] 0.00, Threshold: 8.2886e-01
[rank0]:2025-10-25 12:50:09,230 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 1.0263e+00
[rank3]:2025-10-25 12:50:09,233 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 3.4613e-01
[rank1]:2025-10-25 12:50:51,162 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 2.0873e-01
[rank2]:2025-10-25 12:50:51,158 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 2.0366e-01
[rank3]:2025-10-25 12:50:51,174 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 1.6240e-01
[rank0]:2025-10-25 12:50:51,188 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 3.9067e-02
[rank1]:2025-10-25 12:51:34,557 - INFO - Freezing Ratio: [Stage1] 0.67, [Stage5] 0.00, Threshold: 3.3257e-01
[rank0]:2025-10-25 12:51:34,560 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 4.1999e-01
[rank3]:2025-10-25 12:51:34,563 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 2.4563e-01
[rank2]:2025-10-25 12:51:34,551 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 1.3854e-01
[rank3]:2025-10-25 12:52:16,390 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 4.9871e-01
[rank3]:2025-10-25 12:52:16,393 - INFO -  step: 820  loss:  0.8031  grad_norm:  0.5986  memory: 26.78GiB(56.38%)  tps: 1,916  tflops: 14.98  mfu: 4.80%
[rank2]:2025-10-25 12:52:16,374 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 2.3672e-01
[rank2]:2025-10-25 12:52:16,375 - INFO -  step: 820  loss: -4.0000  grad_norm:  0.5986  memory:  9.81GiB(20.65%)  tps: 1,916  tflops: 14.98  mfu: 4.80%
[rank1]:2025-10-25 12:52:16,378 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 2.1858e-01
[rank1]:2025-10-25 12:52:16,379 - INFO -  step: 820  loss: -4.0000  grad_norm:  0.5986  memory: 15.15GiB(31.88%)  tps: 1,916  tflops: 14.98  mfu: 4.80%
[rank0]:2025-10-25 12:52:16,402 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 2.3630e-01
[rank0]:2025-10-25 12:52:16,402 - INFO -  step: 820  loss: -4.0000  grad_norm:  0.5986  memory: 17.51GiB(36.85%)  tps: 1,916  tflops: 14.98  mfu: 4.80%
[rank3]:2025-10-25 12:52:18,413 - INFO - Avg. fwd time: 33.8219 / Avg. bwd time: 69.5795 / Avg. batch time: 1874.4982 (ms) / GPU bubble ratio: 11.74%
[rank2]:2025-10-25 12:52:18,472 - INFO - Avg. fwd time: 17.3204 / Avg. bwd time: 25.4695 / Avg. batch time: 1941.9411 (ms) / GPU bubble ratio: 64.74%
[rank1]:2025-10-25 12:52:18,541 - INFO - Avg. fwd time: 22.7972 / Avg. bwd time: 38.1063 / Avg. batch time: 2039.9938 (ms) / GPU bubble ratio: 52.23%
[rank0]:2025-10-25 12:52:18,574 - INFO - Avg. fwd time: 19.5668 / Avg. bwd time: 29.3448 / Avg. batch time: 2089.6940 (ms) / GPU bubble ratio: 62.55%
[rank3]:2025-10-25 12:52:41,512 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 12:52:42,373 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 12:52:42,431 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 12:52:42,449 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 12:52:59,774 - INFO - Freezing Ratio: [Stage1] 0.67, [Stage5] 0.00, Threshold: 8.1609e-01
[rank0]:2025-10-25 12:52:59,771 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 9.9876e-01
[rank3]:2025-10-25 12:52:59,774 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 5.3729e-01
[rank2]:2025-10-25 12:52:59,763 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 3.7272e-01
[rank1]:2025-10-25 12:53:41,753 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 5.1557e-01
[rank0]:2025-10-25 12:53:41,776 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 2.0716e-01
[rank3]:2025-10-25 12:53:41,761 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 3.4558e-01
[rank2]:2025-10-25 12:53:41,745 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 5.8561e-01
[rank0]:2025-10-25 12:54:25,242 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 3.6715e-01
[rank3]:2025-10-25 12:54:25,245 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 4.9694e-01
[rank2]:2025-10-25 12:54:25,234 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 2.3303e-01
[rank1]:2025-10-25 12:54:25,245 - INFO - Freezing Ratio: [Stage1] 0.67, [Stage5] 0.00, Threshold: 3.8611e-01
[rank1]:2025-10-25 12:55:07,140 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 2.5967e-01
[rank1]:2025-10-25 12:55:07,141 - INFO -  step: 840  loss: -4.0000  grad_norm:  0.5601  memory: 15.15GiB(31.88%)  tps: 1,919  tflops: 15.00  mfu: 4.81%
[rank0]:2025-10-25 12:55:07,167 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 1.0142e-01
[rank0]:2025-10-25 12:55:07,167 - INFO -  step: 840  loss: -4.0000  grad_norm:  0.5601  memory: 17.51GiB(36.85%)  tps: 1,919  tflops: 15.00  mfu: 4.81%
[rank3]:2025-10-25 12:55:07,152 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 5.0979e-01
[rank3]:2025-10-25 12:55:07,154 - INFO -  step: 840  loss:  0.7595  grad_norm:  0.5601  memory: 26.78GiB(56.38%)  tps: 1,919  tflops: 15.00  mfu: 4.81%
[rank2]:2025-10-25 12:55:07,136 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 3.5779e-01
[rank2]:2025-10-25 12:55:07,137 - INFO -  step: 840  loss: -4.0000  grad_norm:  0.5601  memory:  9.81GiB(20.65%)  tps: 1,919  tflops: 15.00  mfu: 4.81%
[rank3]:2025-10-25 12:55:09,210 - INFO - Avg. fwd time: 33.8244 / Avg. bwd time: 69.5804 / Avg. batch time: 1874.5448 (ms) / GPU bubble ratio: 11.74%
[rank2]:2025-10-25 12:55:09,258 - INFO - Avg. fwd time: 17.3216 / Avg. bwd time: 25.4620 / Avg. batch time: 1941.9216 (ms) / GPU bubble ratio: 64.75%
[rank1]:2025-10-25 12:55:09,336 - INFO - Avg. fwd time: 22.7949 / Avg. bwd time: 38.0769 / Avg. batch time: 2039.9015 (ms) / GPU bubble ratio: 52.26%
[rank0]:2025-10-25 12:55:09,368 - INFO - Avg. fwd time: 19.5654 / Avg. bwd time: 29.3357 / Avg. batch time: 2089.5968 (ms) / GPU bubble ratio: 62.56%
[rank0]:2025-10-25 12:55:50,665 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 2.9254e-01
[rank3]:2025-10-25 12:55:50,669 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 2.0850e-01
[rank2]:2025-10-25 12:55:50,658 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 1.5892e-01
[rank1]:2025-10-25 12:55:50,663 - INFO - Freezing Ratio: [Stage1] 0.67, [Stage5] 0.00, Threshold: 3.0577e-01
[rank0]:2025-10-25 12:56:24,248 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-25 12:56:32,666 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 2.9400e-01
[rank0]:2025-10-25 12:56:32,690 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 1.2590e-01
[rank3]:2025-10-25 12:56:32,677 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 2.6082e-01
[rank2]:2025-10-25 12:56:32,661 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 1.9543e-01
[rank1]:2025-10-25 12:57:16,254 - INFO - Freezing Ratio: [Stage1] 0.67, [Stage5] 0.00, Threshold: 4.6431e-01
[rank0]:2025-10-25 12:57:16,256 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 6.4890e-01
[rank3]:2025-10-25 12:57:16,260 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 3.9286e-01
[rank2]:2025-10-25 12:57:16,248 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 1.5572e-01
[rank1]:2025-10-25 12:57:58,092 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 1.1900e+00
[rank1]:2025-10-25 12:57:58,092 - INFO -  step: 860  loss: -4.0000  grad_norm:  0.5287  memory: 15.15GiB(31.88%)  tps: 1,917  tflops: 14.98  mfu: 4.80%
[rank0]:2025-10-25 12:57:58,118 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 4.6208e-01
[rank0]:2025-10-25 12:57:58,119 - INFO -  step: 860  loss: -4.0000  grad_norm:  0.5287  memory: 17.51GiB(36.85%)  tps: 1,917  tflops: 14.98  mfu: 4.80%
[rank3]:2025-10-25 12:57:58,103 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 5.9879e-01
[rank3]:2025-10-25 12:57:58,105 - INFO -  step: 860  loss:  0.7644  grad_norm:  0.5287  memory: 26.78GiB(56.38%)  tps: 1,917  tflops: 14.98  mfu: 4.80%
[rank2]:2025-10-25 12:57:58,088 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 2.9849e-01
[rank2]:2025-10-25 12:57:58,088 - INFO -  step: 860  loss: -4.0000  grad_norm:  0.5287  memory:  9.81GiB(20.65%)  tps: 1,917  tflops: 14.98  mfu: 4.80%
[rank3]:2025-10-25 12:58:00,112 - INFO - Avg. fwd time: 33.8257 / Avg. bwd time: 69.5807 / Avg. batch time: 1874.5579 (ms) / GPU bubble ratio: 11.74%
[rank2]:2025-10-25 12:58:00,163 - INFO - Avg. fwd time: 17.3225 / Avg. bwd time: 25.4539 / Avg. batch time: 1941.9048 (ms) / GPU bubble ratio: 64.76%
[rank1]:2025-10-25 12:58:00,243 - INFO - Avg. fwd time: 22.7931 / Avg. bwd time: 38.0590 / Avg. batch time: 2039.8231 (ms) / GPU bubble ratio: 52.27%
[rank0]:2025-10-25 12:58:00,275 - INFO - Avg. fwd time: 19.5634 / Avg. bwd time: 29.3297 / Avg. batch time: 2089.5195 (ms) / GPU bubble ratio: 62.56%
[rank1]:2025-10-25 12:58:41,461 - INFO - Freezing Ratio: [Stage1] 0.67, [Stage5] 0.00, Threshold: 3.3703e-01
[rank0]:2025-10-25 12:58:41,464 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 3.6905e-01
[rank3]:2025-10-25 12:58:41,468 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 4.9193e-01
[rank2]:2025-10-25 12:58:41,457 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 1.7932e-01
[rank1]:2025-10-25 12:59:23,482 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 2.9417e-01
[rank0]:2025-10-25 12:59:23,512 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 1.4984e-01
[rank2]:2025-10-25 12:59:23,477 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 3.9106e-01
[rank3]:2025-10-25 12:59:23,493 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 4.1111e-01
[rank0]:2025-10-25 13:00:06,868 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 5.7664e-01
[rank3]:2025-10-25 13:00:06,871 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 6.5968e-01
[rank2]:2025-10-25 13:00:06,859 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 1.0816e-01
[rank1]:2025-10-25 13:00:06,869 - INFO - Freezing Ratio: [Stage1] 0.67, [Stage5] 0.00, Threshold: 5.0618e-01
[rank1]:2025-10-25 13:00:48,710 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 1.3187e+00
[rank1]:2025-10-25 13:00:48,711 - INFO -  step: 880  loss: -4.0000  grad_norm:  0.5890  memory: 15.15GiB(31.88%)  tps: 1,921  tflops: 15.01  mfu: 4.81%
[rank0]:2025-10-25 13:00:48,734 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 5.3183e-01
[rank0]:2025-10-25 13:00:48,735 - INFO -  step: 880  loss: -4.0000  grad_norm:  0.5890  memory: 17.51GiB(36.85%)  tps: 1,921  tflops: 15.01  mfu: 4.81%
[rank3]:2025-10-25 13:00:48,722 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 8.3882e-01
[rank3]:2025-10-25 13:00:48,724 - INFO -  step: 880  loss:  0.7805  grad_norm:  0.5890  memory: 26.78GiB(56.38%)  tps: 1,921  tflops: 15.01  mfu: 4.81%
[rank2]:2025-10-25 13:00:48,706 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 9.4304e-01
[rank2]:2025-10-25 13:00:48,707 - INFO -  step: 880  loss: -4.0000  grad_norm:  0.5890  memory:  9.81GiB(20.65%)  tps: 1,921  tflops: 15.01  mfu: 4.81%
[rank3]:2025-10-25 13:00:50,761 - INFO - Avg. fwd time: 33.8273 / Avg. bwd time: 69.5802 / Avg. batch time: 1874.5607 (ms) / GPU bubble ratio: 11.74%
[rank2]:2025-10-25 13:00:50,813 - INFO - Avg. fwd time: 17.3228 / Avg. bwd time: 25.4442 / Avg. batch time: 1941.8461 (ms) / GPU bubble ratio: 64.76%
[rank1]:2025-10-25 13:00:50,895 - INFO - Avg. fwd time: 22.7873 / Avg. bwd time: 38.0309 / Avg. batch time: 2039.6756 (ms) / GPU bubble ratio: 52.29%
[rank0]:2025-10-25 13:00:50,928 - INFO - Avg. fwd time: 19.5649 / Avg. bwd time: 29.3232 / Avg. batch time: 2089.3655 (ms) / GPU bubble ratio: 62.56%
[rank1]:2025-10-25 13:01:32,163 - INFO - Freezing Ratio: [Stage1] 0.67, [Stage5] 0.00, Threshold: 1.2247e+00
[rank0]:2025-10-25 13:01:32,166 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 1.3372e+00
[rank3]:2025-10-25 13:01:32,170 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 1.0174e+00
[rank2]:2025-10-25 13:01:32,158 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 5.8032e-01
[rank0]:2025-10-25 13:02:14,164 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 3.5827e-01
[rank3]:2025-10-25 13:02:14,151 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 5.1027e-01
[rank2]:2025-10-25 13:02:14,136 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 5.7412e-01
[rank1]:2025-10-25 13:02:14,140 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 7.8223e-01
[rank3]:2025-10-25 13:02:57,624 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 1.8006e-01
[rank2]:2025-10-25 13:02:57,613 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 1.2383e-01
[rank1]:2025-10-25 13:02:57,624 - INFO - Freezing Ratio: [Stage1] 0.67, [Stage5] 0.00, Threshold: 2.0521e-01
[rank0]:2025-10-25 13:02:57,621 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 1.6748e-01
[rank0]:2025-10-25 13:03:31,241 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-25 13:03:39,650 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 1.0105e+00
[rank1]:2025-10-25 13:03:39,650 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.6907  memory: 15.15GiB(31.88%)  tps: 1,917  tflops: 14.99  mfu: 4.80%
[rank3]:2025-10-25 13:03:39,660 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 7.7701e-01
[rank3]:2025-10-25 13:03:39,663 - INFO -  step: 900  loss:  0.7274  grad_norm:  0.6907  memory: 26.78GiB(56.38%)  tps: 1,917  tflops: 14.99  mfu: 4.80%
[rank2]:2025-10-25 13:03:39,645 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 8.3544e-01
[rank2]:2025-10-25 13:03:39,646 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.6907  memory:  9.81GiB(20.65%)  tps: 1,917  tflops: 14.99  mfu: 4.80%
[rank0]:2025-10-25 13:03:39,673 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 3.6423e-01
[rank0]:2025-10-25 13:03:39,673 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.6907  memory: 17.51GiB(36.85%)  tps: 1,917  tflops: 14.99  mfu: 4.80%
[rank0]:2025-10-25 13:03:39,752 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_auto_dm1/freeze_ratio_history/rank0/251025_1303_stage0_step900.svg
[rank2]:2025-10-25 13:03:39,754 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_auto_dm1/freeze_ratio_history/rank2/251025_1303_stage2_step900.svg
[rank2]:2025-10-25 13:03:39,808 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_auto_dm1/freeze_ratio_history/rank2/251025_1303_stage6_step900.svg
[rank0]:2025-10-25 13:03:39,806 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_auto_dm1/freeze_ratio_history/rank0/251025_1303_stage4_step900.svg
[rank1]:2025-10-25 13:03:39,760 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_auto_dm1/freeze_ratio_history/rank1/251025_1303_stage1_step900.svg
[rank1]:2025-10-25 13:03:39,815 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_auto_dm1/freeze_ratio_history/rank1/251025_1303_stage5_step900.svg
[rank3]:2025-10-25 13:03:40,045 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_auto_dm1/pipeline_schedule/251025_1303_real_step900_rank3.svg
[rank3]:> Batch Time: 1904.17 ms, GPU Bubble Ratio: 56.95%, 47.56%, 62.42%, 11.54%
[rank3]:2025-10-25 13:03:40,110 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_auto_dm1/freeze_ratio_history/rank3/251025_1303_stage3_step900.svg
[rank3]:2025-10-25 13:03:40,166 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_auto_dm1/freeze_ratio_history/rank3/251025_1303_stage7_step900.svg
[rank3]:2025-10-25 13:03:42,120 - INFO - Avg. fwd time: 33.8303 / Avg. bwd time: 69.5820 / Avg. batch time: 1874.6245 (ms) / GPU bubble ratio: 11.74%
[rank2]:2025-10-25 13:03:42,185 - INFO - Avg. fwd time: 17.3230 / Avg. bwd time: 25.4360 / Avg. batch time: 1941.9330 (ms) / GPU bubble ratio: 64.77%
[rank0]:2025-10-25 13:03:42,296 - INFO - Avg. fwd time: 19.5615 / Avg. bwd time: 29.3197 / Avg. batch time: 2089.3855 (ms) / GPU bubble ratio: 62.57%
[rank1]:2025-10-25 13:03:42,264 - INFO - Avg. fwd time: 22.7843 / Avg. bwd time: 38.0074 / Avg. batch time: 2039.6933 (ms) / GPU bubble ratio: 52.31%
[rank1]:2025-10-25 13:04:23,612 - INFO - Freezing Ratio: [Stage1] 0.67, [Stage5] 0.00, Threshold: 1.1623e+00
[rank3]:2025-10-25 13:04:23,619 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 6.9495e-01
[rank2]:2025-10-25 13:04:23,607 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 4.7471e-01
[rank0]:2025-10-25 13:04:23,615 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 1.2319e+00
[rank3]:2025-10-25 13:04:25,589 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 13:04:25,642 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 13:04:25,684 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 13:04:25,726 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 13:05:05,506 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 4.6974e-01
[rank0]:2025-10-25 13:05:05,534 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 2.3119e-01
[rank1]:2025-10-25 13:05:05,510 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 5.4713e-01
[rank3]:2025-10-25 13:05:05,521 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 5.0007e-01
[rank1]:2025-10-25 13:05:48,920 - INFO - Freezing Ratio: [Stage1] 0.67, [Stage5] 0.00, Threshold: 2.3770e-01
[rank3]:2025-10-25 13:05:48,923 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 2.2642e-01
[rank2]:2025-10-25 13:05:48,911 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 8.4543e-02
[rank0]:2025-10-25 13:05:48,919 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 2.8638e-01
[rank2]:2025-10-25 13:06:30,705 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 2.0292e-01
[rank2]:2025-10-25 13:06:30,705 - INFO -  step: 920  loss: -4.0000  grad_norm:  0.6829  memory:  9.81GiB(20.65%)  tps: 1,916  tflops: 14.98  mfu: 4.80%
[rank0]:2025-10-25 13:06:30,733 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 1.3374e-01
[rank0]:2025-10-25 13:06:30,733 - INFO -  step: 920  loss: -4.0000  grad_norm:  0.6829  memory: 17.51GiB(36.85%)  tps: 1,916  tflops: 14.98  mfu: 4.80%
[rank1]:2025-10-25 13:06:30,709 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 3.7056e-01
[rank1]:2025-10-25 13:06:30,709 - INFO -  step: 920  loss: -4.0000  grad_norm:  0.6829  memory: 15.15GiB(31.88%)  tps: 1,916  tflops: 14.98  mfu: 4.80%
[rank3]:2025-10-25 13:06:30,720 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 3.7503e-01
[rank3]:2025-10-25 13:06:30,722 - INFO -  step: 920  loss:  0.7119  grad_norm:  0.6829  memory: 26.78GiB(56.38%)  tps: 1,916  tflops: 14.98  mfu: 4.80%
[rank3]:2025-10-25 13:06:32,767 - INFO - Avg. fwd time: 33.8304 / Avg. bwd time: 69.5829 / Avg. batch time: 1874.6384 (ms) / GPU bubble ratio: 11.74%
[rank2]:2025-10-25 13:06:32,825 - INFO - Avg. fwd time: 17.3220 / Avg. bwd time: 25.4267 / Avg. batch time: 1941.8838 (ms) / GPU bubble ratio: 64.78%
[rank0]:2025-10-25 13:06:32,939 - INFO - Avg. fwd time: 19.5631 / Avg. bwd time: 29.3154 / Avg. batch time: 2089.2613 (ms) / GPU bubble ratio: 62.57%
[rank1]:2025-10-25 13:06:32,906 - INFO - Avg. fwd time: 22.7816 / Avg. bwd time: 37.9829 / Avg. batch time: 2039.5720 (ms) / GPU bubble ratio: 52.33%
[rank0]:2025-10-25 13:07:14,170 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 3.3191e-01
[rank2]:2025-10-25 13:07:14,162 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 6.5316e-02
[rank1]:2025-10-25 13:07:14,168 - INFO - Freezing Ratio: [Stage1] 0.67, [Stage5] 0.00, Threshold: 2.2227e-01
[rank3]:2025-10-25 13:07:14,173 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 3.4238e-01
[rank2]:2025-10-25 13:07:56,047 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 1.5409e+00
[rank1]:2025-10-25 13:07:56,051 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 1.4622e+00
[rank3]:2025-10-25 13:07:56,062 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 1.3305e+00
[rank0]:2025-10-25 13:07:56,075 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 7.7220e-01
[rank2]:2025-10-25 13:08:39,483 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 6.9472e-01
[rank1]:2025-10-25 13:08:39,489 - INFO - Freezing Ratio: [Stage1] 0.67, [Stage5] 0.00, Threshold: 1.3300e+00
[rank3]:2025-10-25 13:08:39,494 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 9.0448e-01
[rank0]:2025-10-25 13:08:39,490 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 1.4333e+00
[rank1]:2025-10-25 13:09:21,294 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 4.4444e-01
[rank1]:2025-10-25 13:09:21,294 - INFO -  step: 940  loss: -4.0000  grad_norm:  0.6012  memory: 15.15GiB(31.88%)  tps: 1,921  tflops: 15.02  mfu: 4.81%
[rank3]:2025-10-25 13:09:21,305 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 4.4975e-01
[rank3]:2025-10-25 13:09:21,307 - INFO -  step: 940  loss:  0.7292  grad_norm:  0.6012  memory: 26.78GiB(56.38%)  tps: 1,921  tflops: 15.02  mfu: 4.81%
[rank0]:2025-10-25 13:09:21,319 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 1.3700e-01
[rank0]:2025-10-25 13:09:21,319 - INFO -  step: 940  loss: -4.0000  grad_norm:  0.6012  memory: 17.51GiB(36.85%)  tps: 1,921  tflops: 15.02  mfu: 4.81%
[rank2]:2025-10-25 13:09:21,289 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 4.6818e-01
[rank2]:2025-10-25 13:09:21,290 - INFO -  step: 940  loss: -4.0000  grad_norm:  0.6012  memory:  9.81GiB(20.65%)  tps: 1,921  tflops: 15.02  mfu: 4.81%
[rank3]:2025-10-25 13:09:23,351 - INFO - Avg. fwd time: 33.8317 / Avg. bwd time: 69.5817 / Avg. batch time: 1874.6274 (ms) / GPU bubble ratio: 11.74%
[rank2]:2025-10-25 13:09:23,401 - INFO - Avg. fwd time: 17.3226 / Avg. bwd time: 25.4193 / Avg. batch time: 1941.8317 (ms) / GPU bubble ratio: 64.78%
[rank1]:2025-10-25 13:09:23,484 - INFO - Avg. fwd time: 22.7790 / Avg. bwd time: 37.9615 / Avg. batch time: 2039.4215 (ms) / GPU bubble ratio: 52.35%
[rank0]:2025-10-25 13:09:23,517 - INFO - Avg. fwd time: 19.5628 / Avg. bwd time: 29.3094 / Avg. batch time: 2089.1159 (ms) / GPU bubble ratio: 62.57%
[rank1]:2025-10-25 13:10:04,859 - INFO - Freezing Ratio: [Stage1] 0.67, [Stage5] 0.00, Threshold: 1.5649e-01
[rank3]:2025-10-25 13:10:04,862 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 1.7231e-01
[rank0]:2025-10-25 13:10:04,859 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 2.9882e-01
[rank2]:2025-10-25 13:10:04,850 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 1.1785e-01
[rank0]:2025-10-25 13:10:38,449 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-25 13:10:46,869 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 5.5975e-01
[rank1]:2025-10-25 13:10:46,873 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 5.9671e-01
[rank0]:2025-10-25 13:10:46,897 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 3.9022e-01
[rank3]:2025-10-25 13:10:46,884 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 4.9962e-01
[rank2]:2025-10-25 13:11:30,333 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 2.0797e-01
[rank1]:2025-10-25 13:11:30,337 - INFO - Freezing Ratio: [Stage1] 0.67, [Stage5] 0.00, Threshold: 6.6374e-01
[rank0]:2025-10-25 13:11:30,341 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 1.0076e+00
[rank3]:2025-10-25 13:11:30,344 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 3.2572e-01
[rank3]:2025-10-25 13:12:12,257 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 5.2237e-01
[rank3]:2025-10-25 13:12:12,259 - INFO -  step: 960  loss:  0.7198  grad_norm:  0.5327  memory: 26.78GiB(56.38%)  tps: 1,917  tflops: 14.98  mfu: 4.80%
[rank2]:2025-10-25 13:12:12,242 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 6.3115e-01
[rank2]:2025-10-25 13:12:12,243 - INFO -  step: 960  loss: -4.0000  grad_norm:  0.5327  memory:  9.81GiB(20.65%)  tps: 1,917  tflops: 14.98  mfu: 4.80%
[rank1]:2025-10-25 13:12:12,246 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 5.9835e-01
[rank1]:2025-10-25 13:12:12,246 - INFO -  step: 960  loss: -4.0000  grad_norm:  0.5327  memory: 15.15GiB(31.88%)  tps: 1,917  tflops: 14.98  mfu: 4.80%
[rank0]:2025-10-25 13:12:12,271 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 2.5937e-01
[rank0]:2025-10-25 13:12:12,271 - INFO -  step: 960  loss: -4.0000  grad_norm:  0.5327  memory: 17.51GiB(36.85%)  tps: 1,917  tflops: 14.98  mfu: 4.80%
[rank3]:2025-10-25 13:12:14,280 - INFO - Avg. fwd time: 33.8344 / Avg. bwd time: 69.5839 / Avg. batch time: 1874.6955 (ms) / GPU bubble ratio: 11.74%
[rank2]:2025-10-25 13:12:14,340 - INFO - Avg. fwd time: 17.3229 / Avg. bwd time: 25.4110 / Avg. batch time: 1941.8489 (ms) / GPU bubble ratio: 64.79%
[rank1]:2025-10-25 13:12:14,423 - INFO - Avg. fwd time: 22.7756 / Avg. bwd time: 37.9403 / Avg. batch time: 2039.3744 (ms) / GPU bubble ratio: 52.37%
[rank0]:2025-10-25 13:12:14,456 - INFO - Avg. fwd time: 19.5643 / Avg. bwd time: 29.3052 / Avg. batch time: 2089.0670 (ms) / GPU bubble ratio: 62.57%
[rank1]:2025-10-25 13:12:55,657 - INFO - Freezing Ratio: [Stage1] 0.67, [Stage5] 0.00, Threshold: 1.8241e-01
[rank0]:2025-10-25 13:12:55,659 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 1.6805e-01
[rank3]:2025-10-25 13:12:55,663 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 2.4650e-01
[rank2]:2025-10-25 13:12:55,651 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 1.4091e-01
[rank0]:2025-10-25 13:13:37,475 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 1.9703e-01
[rank3]:2025-10-25 13:13:37,461 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 6.1308e-01
[rank2]:2025-10-25 13:13:37,446 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 4.7824e-01
[rank1]:2025-10-25 13:13:37,453 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 5.2549e-01
[rank0]:2025-10-25 13:14:20,799 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 1.0128e+00
[rank3]:2025-10-25 13:14:20,802 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 5.3315e-01
[rank2]:2025-10-25 13:14:20,791 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 4.0588e-01
[rank1]:2025-10-25 13:14:20,796 - INFO - Freezing Ratio: [Stage1] 0.67, [Stage5] 0.00, Threshold: 8.5936e-01
[rank2]:2025-10-25 13:15:02,679 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 9.8089e-01
[rank2]:2025-10-25 13:15:02,680 - INFO -  step: 980  loss: -4.0000  grad_norm:  0.5499  memory:  9.81GiB(20.65%)  tps: 1,923  tflops: 15.03  mfu: 4.82%
[rank1]:2025-10-25 13:15:02,686 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 9.7745e-01
[rank1]:2025-10-25 13:15:02,687 - INFO -  step: 980  loss: -4.0000  grad_norm:  0.5499  memory: 15.15GiB(31.88%)  tps: 1,923  tflops: 15.03  mfu: 4.82%
[rank3]:2025-10-25 13:15:02,695 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 9.0154e-01
[rank3]:2025-10-25 13:15:02,697 - INFO -  step: 980  loss:  0.7072  grad_norm:  0.5499  memory: 26.78GiB(56.38%)  tps: 1,923  tflops: 15.03  mfu: 4.82%
[rank0]:2025-10-25 13:15:02,708 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 5.7223e-01
[rank0]:2025-10-25 13:15:02,709 - INFO -  step: 980  loss: -4.0000  grad_norm:  0.5499  memory: 17.51GiB(36.85%)  tps: 1,923  tflops: 15.03  mfu: 4.82%
[rank3]:2025-10-25 13:15:04,735 - INFO - Avg. fwd time: 33.8334 / Avg. bwd time: 69.5816 / Avg. batch time: 1874.6244 (ms) / GPU bubble ratio: 11.73%
[rank2]:2025-10-25 13:15:04,779 - INFO - Avg. fwd time: 17.3215 / Avg. bwd time: 25.4006 / Avg. batch time: 1941.7295 (ms) / GPU bubble ratio: 64.80%
[rank0]:2025-10-25 13:15:04,889 - INFO - Avg. fwd time: 19.5624 / Avg. bwd time: 29.2993 / Avg. batch time: 2088.8891 (ms) / GPU bubble ratio: 62.57%
[rank1]:2025-10-25 13:15:04,855 - INFO - Avg. fwd time: 22.7729 / Avg. bwd time: 37.9210 / Avg. batch time: 2039.1990 (ms) / GPU bubble ratio: 52.38%
[rank2]:2025-10-25 13:15:46,163 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 2.7012e-01
[rank1]:2025-10-25 13:15:46,169 - INFO - Freezing Ratio: [Stage1] 0.67, [Stage5] 0.00, Threshold: 4.2744e-01
[rank3]:2025-10-25 13:15:46,175 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 3.7970e-01
[rank0]:2025-10-25 13:15:46,172 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 4.5599e-01
[rank3]:2025-10-25 13:16:08,944 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 13:16:09,008 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 13:16:09,048 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 13:16:09,090 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 13:16:27,966 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 2.0611e-01
[rank3]:2025-10-25 13:16:27,977 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 3.9618e-01
[rank0]:2025-10-25 13:16:27,989 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 7.6057e-02
[rank2]:2025-10-25 13:16:27,961 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 2.9965e-01
[rank1]:2025-10-25 13:17:11,501 - INFO - Freezing Ratio: [Stage1] 0.67, [Stage5] 0.00, Threshold: 2.4969e-01
[rank3]:2025-10-25 13:17:11,507 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 3.3057e-01
[rank0]:2025-10-25 13:17:11,504 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 2.7855e-01
[rank2]:2025-10-25 13:17:11,495 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 1.5845e-01
[rank0]:2025-10-25 13:17:45,070 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-25 13:17:53,407 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 5.1701e-01
[rank2]:2025-10-25 13:17:53,407 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.5834  memory:  9.81GiB(20.65%)  tps: 1,919  tflops: 15.00  mfu: 4.81%
[rank2]:2025-10-25 13:17:53,407 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-25 13:17:53,412 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 4.8402e-01
[rank1]:2025-10-25 13:17:53,412 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.5834  memory: 15.15GiB(31.88%)  tps: 1,919  tflops: 15.00  mfu: 4.81%
[rank1]:2025-10-25 13:17:53,413 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-25 13:17:53,434 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 2.9769e-01
[rank0]:2025-10-25 13:17:53,435 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.5834  memory: 17.51GiB(36.85%)  tps: 1,919  tflops: 15.00  mfu: 4.81%
[rank0]:2025-10-25 13:17:53,435 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-25 13:17:53,437 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank3]:2025-10-25 13:17:53,422 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 5.3151e-01
[rank3]:2025-10-25 13:17:53,424 - INFO -  step: 1000  loss:  0.7107  grad_norm:  0.5834  memory: 26.78GiB(56.38%)  tps: 1,919  tflops: 15.00  mfu: 4.81%
[rank3]:2025-10-25 13:17:53,425 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-25 13:17:55,134 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 1.73 seconds.
[rank1]:2025-10-25 13:17:55,676 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 2.26 seconds.
[rank3]:2025-10-25 13:17:56,689 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.26 seconds.
[rank0]:2025-10-25 13:17:57,032 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-25 13:17:57,039 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.60 seconds.
[rank2]:2025-10-25 13:17:57,142 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_auto_dm1/freeze_ratio_history/rank2/251025_1317_stage2_step1000.svg
[rank1]:2025-10-25 13:17:57,145 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_auto_dm1/freeze_ratio_history/rank1/251025_1317_stage1_step1000.svg
[rank0]:2025-10-25 13:17:57,142 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_auto_dm1/freeze_ratio_history/rank0/251025_1317_stage0_step1000.svg
[rank2]:2025-10-25 13:17:57,200 - INFO - Frozen Ratio History of Rank 2 (Stage 6)  is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_auto_dm1/freeze_ratio_history/rank2/251025_1317_stage6_step1000.svg
[rank1]:2025-10-25 13:17:57,204 - INFO - Frozen Ratio History of Rank 1 (Stage 5)  is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_auto_dm1/freeze_ratio_history/rank1/251025_1317_stage5_step1000.svg
[rank0]:2025-10-25 13:17:57,248 - INFO - Frozen Ratio History of Rank 0 (Stage 4)  is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_auto_dm1/freeze_ratio_history/rank0/251025_1317_stage4_step1000.svg
[rank3]:2025-10-25 13:17:57,620 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_auto_dm1/pipeline_schedule/251025_1317_real_step1000_rank3.svg
[rank3]:> Batch Time: 1904.30 ms, GPU Bubble Ratio: 56.97%, 47.60%, 62.44%, 11.52%
[rank3]:2025-10-25 13:17:57,694 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_auto_dm1/freeze_ratio_history/rank3/251025_1317_stage3_step1000.svg
[rank3]:2025-10-25 13:17:57,757 - INFO - Frozen Ratio History of Rank 3 (Stage 7)  is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_auto_dm1/freeze_ratio_history/rank3/251025_1317_stage7_step1000.svg
[rank3]:2025-10-25 13:17:59,709 - INFO - Avg. fwd time: 33.8350 / Avg. bwd time: 69.5807 / Avg. batch time: 1874.6245 (ms) / GPU bubble ratio: 11.73%
[rank2]:2025-10-25 13:17:59,760 - INFO - Avg. fwd time: 17.3224 / Avg. bwd time: 25.3959 / Avg. batch time: 1941.8046 (ms) / GPU bubble ratio: 64.80%
[rank1]:2025-10-25 13:17:59,840 - INFO - Avg. fwd time: 22.7721 / Avg. bwd time: 37.9031 / Avg. batch time: 2039.2209 (ms) / GPU bubble ratio: 52.39%
[rank0]:2025-10-25 13:17:59,874 - INFO - Avg. fwd time: 19.5616 / Avg. bwd time: 29.2903 / Avg. batch time: 2088.9062 (ms) / GPU bubble ratio: 62.58%
[rank2]:2025-10-25 13:18:41,174 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 1.1647e-01
[rank1]:2025-10-25 13:18:41,179 - INFO - Freezing Ratio: [Stage1] 0.67, [Stage5] 0.00, Threshold: 2.3897e-01
[rank3]:2025-10-25 13:18:41,186 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 4.0747e-01
[rank0]:2025-10-25 13:18:41,183 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 3.8936e-01
[rank1]:2025-10-25 13:19:23,197 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 4.5318e-01
[rank3]:2025-10-25 13:19:23,206 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 6.5891e-01
[rank2]:2025-10-25 13:19:23,191 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 4.0472e-01
[rank0]:2025-10-25 13:19:23,220 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 1.7556e-01
[rank3]:2025-10-25 13:20:06,715 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 8.1647e-01
[rank0]:2025-10-25 13:20:06,711 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 8.3806e-01
[rank1]:2025-10-25 13:20:06,711 - INFO - Freezing Ratio: [Stage1] 0.67, [Stage5] 0.00, Threshold: 6.9592e-01
[rank2]:2025-10-25 13:20:06,703 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 3.6977e-01
[rank3]:2025-10-25 13:20:48,777 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 6.8002e-01
[rank3]:2025-10-25 13:20:48,780 - INFO -  step: 1020  loss:  0.6804  grad_norm:  0.5724  memory: 26.78GiB(56.38%)  tps: 1,869  tflops: 14.61  mfu: 4.68%
[rank0]:2025-10-25 13:20:48,790 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 1.1107e-01
[rank0]:2025-10-25 13:20:48,790 - INFO -  step: 1020  loss: -4.0000  grad_norm:  0.5724  memory: 17.51GiB(36.85%)  tps: 1,869  tflops: 14.61  mfu: 4.68%
[rank1]:2025-10-25 13:20:48,770 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 3.2400e-01
[rank1]:2025-10-25 13:20:48,771 - INFO -  step: 1020  loss: -4.0000  grad_norm:  0.5724  memory: 15.15GiB(31.88%)  tps: 1,869  tflops: 14.61  mfu: 4.68%
[rank2]:2025-10-25 13:20:48,761 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 6.7032e-01
[rank2]:2025-10-25 13:20:48,762 - INFO -  step: 1020  loss: -4.0000  grad_norm:  0.5724  memory:  9.81GiB(20.65%)  tps: 1,869  tflops: 14.61  mfu: 4.68%
[rank3]:2025-10-25 13:20:50,805 - INFO - Avg. fwd time: 33.8369 / Avg. bwd time: 69.5840 / Avg. batch time: 1874.7089 (ms) / GPU bubble ratio: 11.73%
[rank2]:2025-10-25 13:20:50,868 - INFO - Avg. fwd time: 17.3230 / Avg. bwd time: 25.3904 / Avg. batch time: 1941.8586 (ms) / GPU bubble ratio: 64.81%
[rank1]:2025-10-25 13:20:50,950 - INFO - Avg. fwd time: 22.7673 / Avg. bwd time: 37.8801 / Avg. batch time: 2039.2241 (ms) / GPU bubble ratio: 52.42%
[rank0]:2025-10-25 13:20:51,106 - INFO - Avg. fwd time: 19.5648 / Avg. bwd time: 29.2878 / Avg. batch time: 2088.8970 (ms) / GPU bubble ratio: 62.58%
[rank0]:2025-10-25 13:21:32,368 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 5.6573e-01
[rank1]:2025-10-25 13:21:32,370 - INFO - Freezing Ratio: [Stage1] 0.67, [Stage5] 0.00, Threshold: 3.8953e-01
[rank2]:2025-10-25 13:21:32,360 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 1.0617e-01
[rank3]:2025-10-25 13:21:32,371 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 4.6219e-01
[rank2]:2025-10-25 13:22:14,334 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 6.4169e-01
[rank3]:2025-10-25 13:22:14,350 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 6.6468e-01
[rank0]:2025-10-25 13:22:14,362 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 5.5631e-01
[rank1]:2025-10-25 13:22:14,338 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 1.2633e+00
[rank2]:2025-10-25 13:22:57,809 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 6.8543e-02
[rank3]:2025-10-25 13:22:57,821 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 2.5396e-01
[rank0]:2025-10-25 13:22:57,818 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 3.1657e-01
[rank1]:2025-10-25 13:22:57,817 - INFO - Freezing Ratio: [Stage1] 0.67, [Stage5] 0.00, Threshold: 1.6954e-01
[rank3]:2025-10-25 13:23:39,803 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 3.4096e-01
[rank3]:2025-10-25 13:23:39,806 - INFO -  step: 1040  loss:  0.6766  grad_norm:  0.5674  memory: 26.78GiB(56.38%)  tps: 1,916  tflops: 14.98  mfu: 4.80%
[rank0]:2025-10-25 13:23:39,816 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 1.5651e-01
[rank0]:2025-10-25 13:23:39,816 - INFO -  step: 1040  loss: -4.0000  grad_norm:  0.5674  memory: 17.51GiB(36.85%)  tps: 1,916  tflops: 14.98  mfu: 4.80%
[rank1]:2025-10-25 13:23:39,791 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 5.1288e-01
[rank1]:2025-10-25 13:23:39,792 - INFO -  step: 1040  loss: -4.0000  grad_norm:  0.5674  memory: 15.15GiB(31.88%)  tps: 1,916  tflops: 14.98  mfu: 4.80%
[rank2]:2025-10-25 13:23:39,787 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 3.3123e-01
[rank2]:2025-10-25 13:23:39,788 - INFO -  step: 1040  loss: -4.0000  grad_norm:  0.5674  memory:  9.81GiB(20.65%)  tps: 1,916  tflops: 14.98  mfu: 4.80%
[rank3]:2025-10-25 13:23:41,855 - INFO - Avg. fwd time: 33.8398 / Avg. bwd time: 69.5851 / Avg. batch time: 1874.7648 (ms) / GPU bubble ratio: 11.73%
[rank2]:2025-10-25 13:23:41,901 - INFO - Avg. fwd time: 17.3228 / Avg. bwd time: 25.3852 / Avg. batch time: 1941.8627 (ms) / GPU bubble ratio: 64.81%
[rank0]:2025-10-25 13:23:42,013 - INFO - Avg. fwd time: 19.5705 / Avg. bwd time: 29.2857 / Avg. batch time: 2088.8400 (ms) / GPU bubble ratio: 62.58%
[rank1]:2025-10-25 13:23:41,979 - INFO - Avg. fwd time: 22.7644 / Avg. bwd time: 37.8559 / Avg. batch time: 2039.1697 (ms) / GPU bubble ratio: 52.44%
[rank2]:2025-10-25 13:24:23,301 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 2.8896e-01
[rank3]:2025-10-25 13:24:23,313 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 3.1346e-01
[rank1]:2025-10-25 13:24:23,307 - INFO - Freezing Ratio: [Stage1] 0.67, [Stage5] 0.00, Threshold: 7.6650e-01
[rank0]:2025-10-25 13:24:23,310 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 7.9417e-01
[rank0]:2025-10-25 13:24:56,913 - INFO - [GC] Peforming periodical GC collection 0.02 seconds
[rank3]:2025-10-25 13:25:05,312 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 1.8004e+00
[rank0]:2025-10-25 13:25:05,329 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 1.1543e+00
[rank1]:2025-10-25 13:25:05,301 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 2.1328e+00
[rank2]:2025-10-25 13:25:05,296 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 1.9318e+00
[rank0]:2025-10-25 13:25:48,891 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 1.2023e+00
[rank3]:2025-10-25 13:25:48,894 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 2.4516e-01
[rank1]:2025-10-25 13:25:48,888 - INFO - Freezing Ratio: [Stage1] 0.67, [Stage5] 0.00, Threshold: 3.7233e-01
[rank2]:2025-10-25 13:25:48,883 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 3.0971e-01
[rank2]:2025-10-25 13:26:30,872 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 1.0690e+00
[rank2]:2025-10-25 13:26:30,873 - INFO -  step: 1060  loss: -4.0000  grad_norm:  0.5475  memory:  9.81GiB(20.65%)  tps: 1,915  tflops: 14.97  mfu: 4.80%
[rank0]:2025-10-25 13:26:30,902 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 4.5991e-01
[rank0]:2025-10-25 13:26:30,902 - INFO -  step: 1060  loss: -4.0000  grad_norm:  0.5475  memory: 17.51GiB(36.85%)  tps: 1,915  tflops: 14.97  mfu: 4.80%
[rank3]:2025-10-25 13:26:30,888 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 9.0288e-01
[rank3]:2025-10-25 13:26:30,892 - INFO -  step: 1060  loss:  0.6624  grad_norm:  0.5475  memory: 26.78GiB(56.38%)  tps: 1,915  tflops: 14.97  mfu: 4.80%
[rank1]:2025-10-25 13:26:30,877 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 1.2525e+00
[rank1]:2025-10-25 13:26:30,877 - INFO -  step: 1060  loss: -4.0000  grad_norm:  0.5475  memory: 15.15GiB(31.88%)  tps: 1,915  tflops: 14.97  mfu: 4.80%
[rank3]:2025-10-25 13:26:32,917 - INFO - Avg. fwd time: 33.8429 / Avg. bwd time: 69.5874 / Avg. batch time: 1874.8422 (ms) / GPU bubble ratio: 11.73%
[rank2]:2025-10-25 13:26:32,980 - INFO - Avg. fwd time: 17.3233 / Avg. bwd time: 25.3797 / Avg. batch time: 1941.8986 (ms) / GPU bubble ratio: 64.82%
[rank1]:2025-10-25 13:26:33,063 - INFO - Avg. fwd time: 22.7632 / Avg. bwd time: 37.8375 / Avg. batch time: 2039.1505 (ms) / GPU bubble ratio: 52.45%
[rank0]:2025-10-25 13:26:33,098 - INFO - Avg. fwd time: 19.5684 / Avg. bwd time: 29.2779 / Avg. batch time: 2088.8147 (ms) / GPU bubble ratio: 62.58%
[rank0]:2025-10-25 13:27:14,388 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 1.0508e+00
[rank3]:2025-10-25 13:27:14,391 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 5.3949e-01
[rank1]:2025-10-25 13:27:14,384 - INFO - Freezing Ratio: [Stage1] 0.67, [Stage5] 0.00, Threshold: 8.9016e-01
[rank2]:2025-10-25 13:27:14,380 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 3.6683e-01
[rank0]:2025-10-25 13:27:56,351 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 1.7864e-01
[rank3]:2025-10-25 13:27:56,335 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 4.1934e-01
[rank3]:2025-10-25 13:27:56,359 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 13:27:56,324 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 4.1854e-01
[rank1]:2025-10-25 13:27:56,349 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 13:27:56,319 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 2.3146e-01
[rank2]:2025-10-25 13:27:56,342 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 13:27:56,374 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 13:28:39,768 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 3.6845e-01
[rank0]:2025-10-25 13:28:39,776 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 8.7863e-01
[rank3]:2025-10-25 13:28:39,780 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 4.5337e-01
[rank1]:2025-10-25 13:28:39,773 - INFO - Freezing Ratio: [Stage1] 0.67, [Stage5] 0.00, Threshold: 8.1915e-01
[rank1]:2025-10-25 13:29:21,766 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 8.6336e-02
[rank1]:2025-10-25 13:29:21,767 - INFO -  step: 1080  loss: -4.0000  grad_norm:  0.5748  memory: 15.15GiB(31.88%)  tps: 1,917  tflops: 14.99  mfu: 4.80%
[rank3]:2025-10-25 13:29:21,777 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 3.2148e-01
[rank3]:2025-10-25 13:29:21,780 - INFO -  step: 1080  loss:  0.6547  grad_norm:  0.5748  memory: 26.78GiB(56.38%)  tps: 1,918  tflops: 14.99  mfu: 4.80%
[rank2]:2025-10-25 13:29:21,762 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 2.9267e-01
[rank2]:2025-10-25 13:29:21,763 - INFO -  step: 1080  loss: -4.0000  grad_norm:  0.5748  memory:  9.81GiB(20.65%)  tps: 1,917  tflops: 14.99  mfu: 4.80%
[rank0]:2025-10-25 13:29:21,792 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 3.6773e-02
[rank0]:2025-10-25 13:29:21,792 - INFO -  step: 1080  loss: -4.0000  grad_norm:  0.5748  memory: 17.51GiB(36.85%)  tps: 1,917  tflops: 14.99  mfu: 4.80%
[rank3]:2025-10-25 13:29:23,787 - INFO - Avg. fwd time: 33.8436 / Avg. bwd time: 69.5876 / Avg. batch time: 1874.8553 (ms) / GPU bubble ratio: 11.73%
[rank2]:2025-10-25 13:29:23,840 - INFO - Avg. fwd time: 17.3239 / Avg. bwd time: 25.3740 / Avg. batch time: 1941.8793 (ms) / GPU bubble ratio: 64.82%
[rank0]:2025-10-25 13:29:23,953 - INFO - Avg. fwd time: 19.5715 / Avg. bwd time: 29.2734 / Avg. batch time: 2088.7451 (ms) / GPU bubble ratio: 62.58%
[rank1]:2025-10-25 13:29:23,918 - INFO - Avg. fwd time: 22.7607 / Avg. bwd time: 37.8232 / Avg. batch time: 2039.0789 (ms) / GPU bubble ratio: 52.46%
[rank2]:2025-10-25 13:30:05,162 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 3.0001e-01
[rank0]:2025-10-25 13:30:05,170 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 2.3584e-01
[rank1]:2025-10-25 13:30:05,173 - INFO - Freezing Ratio: [Stage1] 0.67, [Stage5] 0.00, Threshold: 2.8642e-01
[rank3]:2025-10-25 13:30:05,174 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 2.6933e-01
[rank0]:2025-10-25 13:30:47,078 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 2.2270e-01
[rank1]:2025-10-25 13:30:47,056 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 3.3456e-01
[rank3]:2025-10-25 13:30:47,065 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 5.6086e-01
[rank2]:2025-10-25 13:30:47,049 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 2.3438e-01
[rank0]:2025-10-25 13:31:30,451 - INFO - Freezing Ratio: [Stage0] 0.00, [Stage4] 0.00, Threshold: 1.5611e-01
[rank3]:2025-10-25 13:31:30,455 - INFO - Freezing Ratio: [Stage3] 0.50, [Stage7] 0.00, Threshold: 1.6592e-01
[rank2]:2025-10-25 13:31:30,443 - INFO - Freezing Ratio: [Stage2] 1.00, [Stage6] 0.00, Threshold: 8.7675e-02
[rank1]:2025-10-25 13:31:30,454 - INFO - Freezing Ratio: [Stage1] 0.67, [Stage5] 0.00, Threshold: 1.8986e-01
[rank0]:2025-10-25 13:32:03,822 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-25 13:32:12,223 - INFO - Freezing Ratio: [Stage3] 0.00, [Stage7] 0.00, Threshold: 2.6778e-01
[rank3]:2025-10-25 13:32:12,226 - INFO -  step: 1100  loss:  0.6665  grad_norm:  0.6150  memory: 26.78GiB(56.38%)  tps: 1,923  tflops: 15.03  mfu: 4.82%
[rank2]:2025-10-25 13:32:12,208 - INFO - Freezing Ratio: [Stage2] 0.00, [Stage6] 0.00, Threshold: 7.4431e-01
[rank2]:2025-10-25 13:32:12,208 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.6150  memory:  9.81GiB(20.65%)  tps: 1,922  tflops: 15.03  mfu: 4.82%
[rank1]:2025-10-25 13:32:12,212 - INFO - Freezing Ratio: [Stage1] 0.00, [Stage5] 0.00, Threshold: 2.8288e-01
[rank1]:2025-10-25 13:32:12,212 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.6150  memory: 15.15GiB(31.88%)  tps: 1,922  tflops: 15.03  mfu: 4.82%
[rank0]:2025-10-25 13:32:12,235 - INFO - Freezing Ratio: [Stage0] 0.95, [Stage4] 0.00, Threshold: 6.1238e-02
[rank0]:2025-10-25 13:32:12,236 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.6150  memory: 17.51GiB(36.85%)  tps: 1,923  tflops: 15.03  mfu: 4.82%
[rank0]:2025-10-25 13:32:12,290 - INFO - Destroying the purge thread.
[rank0]:[rank0]: Traceback (most recent call last):
[rank0]:[rank0]:   File "<frozen runpy>", line 198, in _run_module_as_main
[rank0]:[rank0]:   File "<frozen runpy>", line 88, in _run_code
[rank0]:[rank0]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 720, in <module>
[rank0]:[rank0]:     trainer.train()
[rank0]:[rank0]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
[rank0]:[rank0]:     return f(*args, **kwargs)
[rank0]:[rank0]:            ^^^^^^^^^^^^^^^^^^
[rank0]:[rank0]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 619, in train
[rank0]:[rank0]:     draw_charts(self.freezer, self.step, job_config)
[rank0]:[rank0]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 681, in draw_charts
[rank0]:[rank0]:     draw_line_chart([freezer.stability_check_freq * k for k in range(len(freezer.freeze_ratio_history[s]))], 
[rank0]:[rank0]:     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:[rank0]:   File "/home/shcho/torchtitan/timelyfreeze/core/util.py", line 66, in draw_line_chart
[rank0]:[rank0]:     plt.savefig(save_file)
[rank0]:[rank0]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/pyplot.py", line 1250, in savefig
[rank0]:[rank0]:     res = fig.savefig(*args, **kwargs)  # type: ignore[func-returns-value]
[rank0]:[rank0]:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:[rank0]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/figure.py", line 3490, in savefig
[rank0]:[rank0]:     self.canvas.print_figure(fname, **kwargs)
[rank0]:[rank0]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backend_bases.py", line 2186, in print_figure
[rank0]:[rank0]:     result = print_method(
[rank0]:[rank0]:              ^^^^^^^^^^^^^
[rank0]:[rank0]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backend_bases.py", line 2042, in <lambda>
[rank0]:[rank0]:     print_method = functools.wraps(meth)(lambda *args, **kwargs: meth(
[rank0]:[rank0]:                                                                  ^^^^^
[rank0]:[rank0]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backends/backend_svg.py", line 1351, in print_svg
[rank0]:[rank0]:     self.figure.draw(renderer)
[rank0]:[rank0]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/artist.py", line 94, in draw_wrapper
[rank0]:[rank0]:     result = draw(artist, renderer, *args, **kwargs)
[rank0]:[rank0]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:[rank0]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/artist.py", line 71, in draw_wrapper
[rank0]:[rank0]:     return draw(artist, renderer)
[rank0]:[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^
[rank0]:[rank0]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/figure.py", line 3257, in draw
[rank0]:[rank0]:     mimage._draw_list_compositing_images(
[rank0]:[rank0]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/image.py", line 134, in _draw_list_compositing_images
[rank0]:[rank0]:     a.draw(renderer)
[rank0]:[rank0]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/artist.py", line 71, in draw_wrapper
[rank0]:[rank0]:     return draw(artist, renderer)
[rank0]:[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^
[rank0]:[rank0]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/axes/_base.py", line 3226, in draw
[rank0]:[rank0]:     mimage._draw_list_compositing_images(
[rank0]:[rank0]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/image.py", line 134, in _draw_list_compositing_images
[rank0]:[rank0]:     a.draw(renderer)
[rank0]:[rank0]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/artist.py", line 71, in draw_wrapper
[rank0]:[rank0]:     return draw(artist, renderer)
[rank0]:[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^
[rank0]:[rank0]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/axis.py", line 1412, in draw
[rank0]:[rank0]:     self.label.draw(renderer)
[rank0]:[rank0]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/artist.py", line 71, in draw_wrapper
[rank0]:[rank0]:     return draw(artist, renderer)
[rank0]:[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^
[rank0]:[rank0]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/text.py", line 808, in draw
[rank0]:[rank0]:     textrenderer.draw_text(gc, x, y, clean_line,
[rank0]:[rank0]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backends/backend_svg.py", line 1279, in draw_text
[rank0]:[rank0]:     self._draw_text_as_path(gc, x, y, s, prop, angle, ismath, mtext)
[rank0]:[rank0]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backends/backend_svg.py", line 1071, in _draw_text_as_path
[rank0]:[rank0]:     self._update_glyph_map_defs(glyph_map_new)
[rank0]:[rank0]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backends/backend_svg.py", line 1029, in _update_glyph_map_defs
[rank0]:[rank0]:     writer.element(
[rank0]:[rank0]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backends/backend_svg.py", line 241, in element
[rank0]:[rank0]:     self.start(tag, attrib, **extra)
[rank0]:[rank0]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backends/backend_svg.py", line 165, in start
[rank0]:[rank0]:     self.__write(f' {k}={v}')
[rank0]:[rank0]: OSError: [Errno 28] No space left on device
[rank2]:2025-10-25 13:32:12,290 - INFO - Destroying the purge thread.
[rank2]:[rank2]: Traceback (most recent call last):
[rank2]:[rank2]:   File "<frozen runpy>", line 198, in _run_module_as_main
[rank2]:[rank2]:   File "<frozen runpy>", line 88, in _run_code
[rank2]:[rank2]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 720, in <module>
[rank2]:[rank2]:     trainer.train()
[rank2]:[rank2]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
[rank2]:[rank2]:     return f(*args, **kwargs)
[rank2]:[rank2]:            ^^^^^^^^^^^^^^^^^^
[rank2]:[rank2]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 619, in train
[rank2]:[rank2]:     draw_charts(self.freezer, self.step, job_config)
[rank2]:[rank2]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 681, in draw_charts
[rank2]:[rank2]:     draw_line_chart([freezer.stability_check_freq * k for k in range(len(freezer.freeze_ratio_history[s]))], 
[rank2]:[rank2]:     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:[rank2]:   File "/home/shcho/torchtitan/timelyfreeze/core/util.py", line 66, in draw_line_chart
[rank2]:[rank2]:     plt.savefig(save_file)
[rank2]:[rank2]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/pyplot.py", line 1250, in savefig
[rank2]:[rank2]:     res = fig.savefig(*args, **kwargs)  # type: ignore[func-returns-value]
[rank2]:[rank2]:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:[rank2]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/figure.py", line 3490, in savefig
[rank2]:[rank2]:     self.canvas.print_figure(fname, **kwargs)
[rank2]:[rank2]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backend_bases.py", line 2186, in print_figure
[rank2]:[rank2]:     result = print_method(
[rank2]:[rank2]:              ^^^^^^^^^^^^^
[rank2]:[rank2]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backend_bases.py", line 2042, in <lambda>
[rank2]:[rank2]:     print_method = functools.wraps(meth)(lambda *args, **kwargs: meth(
[rank2]:[rank2]:                                                                  ^^^^^
[rank2]:[rank2]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backends/backend_svg.py", line 1351, in print_svg
[rank2]:[rank2]:     self.figure.draw(renderer)
[rank2]:[rank2]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/artist.py", line 94, in draw_wrapper
[rank2]:[rank2]:     result = draw(artist, renderer, *args, **kwargs)
[rank2]:[rank2]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:[rank2]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/artist.py", line 71, in draw_wrapper
[rank2]:[rank2]:     return draw(artist, renderer)
[rank2]:[rank2]:            ^^^^^^^^^^^^^^^^^^^^^^
[rank2]:[rank2]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/figure.py", line 3257, in draw
[rank2]:[rank2]:     mimage._draw_list_compositing_images(
[rank2]:[rank2]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/image.py", line 134, in _draw_list_compositing_images
[rank2]:[rank2]:     a.draw(renderer)
[rank2]:[rank2]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/artist.py", line 71, in draw_wrapper
[rank2]:[rank2]:     return draw(artist, renderer)
[rank2]:[rank2]:            ^^^^^^^^^^^^^^^^^^^^^^
[rank2]:[rank2]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/axes/_base.py", line 3226, in draw
[rank2]:[rank2]:     mimage._draw_list_compositing_images(
[rank2]:[rank2]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/image.py", line 134, in _draw_list_compositing_images
[rank2]:[rank2]:     a.draw(renderer)
[rank2]:[rank2]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/artist.py", line 71, in draw_wrapper
[rank2]:[rank2]:     return draw(artist, renderer)
[rank2]:[rank2]:            ^^^^^^^^^^^^^^^^^^^^^^
[rank2]:[rank2]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/axis.py", line 1412, in draw
[rank2]:[rank2]:     self.label.draw(renderer)
[rank2]:[rank2]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/artist.py", line 71, in draw_wrapper
[rank2]:[rank2]:     return draw(artist, renderer)
[rank2]:[rank2]:            ^^^^^^^^^^^^^^^^^^^^^^
[rank2]:[rank2]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/text.py", line 808, in draw
[rank2]:[rank2]:     textrenderer.draw_text(gc, x, y, clean_line,
[rank2]:[rank2]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backends/backend_svg.py", line 1279, in draw_text
[rank2]:[rank2]:     self._draw_text_as_path(gc, x, y, s, prop, angle, ismath, mtext)
[rank2]:[rank2]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backends/backend_svg.py", line 1071, in _draw_text_as_path
[rank2]:[rank2]:     self._update_glyph_map_defs(glyph_map_new)
[rank2]:[rank2]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backends/backend_svg.py", line 1029, in _update_glyph_map_defs
[rank2]:[rank2]:     writer.element(
[rank2]:[rank2]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backends/backend_svg.py", line 241, in element
[rank2]:[rank2]:     self.start(tag, attrib, **extra)
[rank2]:[rank2]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backends/backend_svg.py", line 165, in start
[rank2]:[rank2]:     self.__write(f' {k}={v}')
[rank2]:[rank2]: OSError: [Errno 28] No space left on device
[rank1]:2025-10-25 13:32:12,291 - INFO - Destroying the purge thread.
[rank1]:[rank1]: Traceback (most recent call last):
[rank1]:[rank1]:   File "<frozen runpy>", line 198, in _run_module_as_main
[rank1]:[rank1]:   File "<frozen runpy>", line 88, in _run_code
[rank1]:[rank1]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 720, in <module>
[rank1]:[rank1]:     trainer.train()
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
[rank1]:[rank1]:     return f(*args, **kwargs)
[rank1]:[rank1]:            ^^^^^^^^^^^^^^^^^^
[rank1]:[rank1]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 619, in train
[rank1]:[rank1]:     draw_charts(self.freezer, self.step, job_config)
[rank1]:[rank1]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 681, in draw_charts
[rank1]:[rank1]:     draw_line_chart([freezer.stability_check_freq * k for k in range(len(freezer.freeze_ratio_history[s]))], 
[rank1]:[rank1]:     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:[rank1]:   File "/home/shcho/torchtitan/timelyfreeze/core/util.py", line 66, in draw_line_chart
[rank1]:[rank1]:     plt.savefig(save_file)
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/pyplot.py", line 1250, in savefig
[rank1]:[rank1]:     res = fig.savefig(*args, **kwargs)  # type: ignore[func-returns-value]
[rank1]:[rank1]:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/figure.py", line 3490, in savefig
[rank1]:[rank1]:     self.canvas.print_figure(fname, **kwargs)
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backend_bases.py", line 2186, in print_figure
[rank1]:[rank1]:     result = print_method(
[rank1]:[rank1]:              ^^^^^^^^^^^^^
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backend_bases.py", line 2042, in <lambda>
[rank1]:[rank1]:     print_method = functools.wraps(meth)(lambda *args, **kwargs: meth(
[rank1]:[rank1]:                                                                  ^^^^^
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backends/backend_svg.py", line 1351, in print_svg
[rank1]:[rank1]:     self.figure.draw(renderer)
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/artist.py", line 94, in draw_wrapper
[rank1]:[rank1]:     result = draw(artist, renderer, *args, **kwargs)
[rank1]:[rank1]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/artist.py", line 71, in draw_wrapper
[rank1]:[rank1]:     return draw(artist, renderer)
[rank1]:[rank1]:            ^^^^^^^^^^^^^^^^^^^^^^
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/figure.py", line 3257, in draw
[rank1]:[rank1]:     mimage._draw_list_compositing_images(
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/image.py", line 134, in _draw_list_compositing_images
[rank1]:[rank1]:     a.draw(renderer)
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/artist.py", line 71, in draw_wrapper
[rank1]:[rank1]:     return draw(artist, renderer)
[rank1]:[rank1]:            ^^^^^^^^^^^^^^^^^^^^^^
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/axes/_base.py", line 3226, in draw
[rank1]:[rank1]:     mimage._draw_list_compositing_images(
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/image.py", line 134, in _draw_list_compositing_images
[rank1]:[rank1]:     a.draw(renderer)
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/artist.py", line 71, in draw_wrapper
[rank1]:[rank1]:     return draw(artist, renderer)
[rank1]:[rank1]:            ^^^^^^^^^^^^^^^^^^^^^^
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/axis.py", line 1412, in draw
[rank1]:[rank1]:     self.label.draw(renderer)
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/artist.py", line 71, in draw_wrapper
[rank1]:[rank1]:     return draw(artist, renderer)
[rank1]:[rank1]:            ^^^^^^^^^^^^^^^^^^^^^^
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/text.py", line 808, in draw
[rank1]:[rank1]:     textrenderer.draw_text(gc, x, y, clean_line,
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backends/backend_svg.py", line 1279, in draw_text
[rank1]:[rank1]:     self._draw_text_as_path(gc, x, y, s, prop, angle, ismath, mtext)
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backends/backend_svg.py", line 1071, in _draw_text_as_path
[rank1]:[rank1]:     self._update_glyph_map_defs(glyph_map_new)
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backends/backend_svg.py", line 1029, in _update_glyph_map_defs
[rank1]:[rank1]:     writer.element(
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backends/backend_svg.py", line 241, in element
[rank1]:[rank1]:     self.start(tag, attrib, **extra)
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backends/backend_svg.py", line 165, in start
[rank1]:[rank1]:     self.__write(f' {k}={v}')
[rank1]:[rank1]: OSError: [Errno 28] No space left on device
[rank3]:2025-10-25 13:32:12,469 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank0]:[rank0]:[W1025 13:32:13.624591644 ProcessGroupNCCL.cpp:1552] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[rank3]:wandb: uploading history steps 54-55, summary, console lines 575-577
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:                    grad_norm â–ˆâ–…â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–‚â–â–â–â–‚â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–†â–…â–„â–„â–„â–„â–„â–„â–„â–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–‚â–ƒâ–ƒâ–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–†â–…â–„â–„â–„â–„â–„â–„â–„â–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–‚â–ƒâ–ƒâ–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–â–â–â–â–â–
[rank3]:wandb:                           lr â–â–„â–…â–‡â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–†â–†â–†â–…â–…
[rank3]:wandb:         memory/max_active(%) â–â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
[rank3]:wandb:       memory/max_active(GiB) â–â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
[rank3]:wandb:       memory/max_reserved(%) â–â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
[rank3]:wandb:     memory/max_reserved(GiB) â–â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
[rank3]:wandb:     memory/num_alloc_retries â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:              memory/num_ooms â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                           +7 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:                    grad_norm 0.61496
[rank3]:wandb: loss_metrics/global_avg_loss 0.66652
[rank3]:wandb: loss_metrics/global_max_loss 0.66652
[rank3]:wandb:                           lr 1e-05
[rank3]:wandb:         memory/max_active(%) 48.30088
[rank3]:wandb:       memory/max_active(GiB) 22.94628
[rank3]:wandb:       memory/max_reserved(%) 56.37743
[rank3]:wandb:     memory/max_reserved(GiB) 26.7832
[rank3]:wandb:     memory/num_alloc_retries 0
[rank3]:wandb:              memory/num_ooms 0
[rank3]:wandb:                           +7 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1023_Interleaved1F1B_auto_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/n5mjqg9n
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 3 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1023_Interleaved1F1B_auto_dm1/20251025-1055/wandb/run-20251025_105509-n5mjqg9n/logs
[rank3]:Traceback (most recent call last):
[rank3]:  File "<frozen runpy>", line 198, in _run_module_as_main
[rank3]:  File "<frozen runpy>", line 88, in _run_code
[rank3]:  File "/home/shcho/torchtitan/timelyfreeze/train.py", line 720, in <module>
[rank3]:    trainer.train()
[rank3]:  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
[rank3]:    return f(*args, **kwargs)
[rank3]:           ^^^^^^^^^^^^^^^^^^
[rank3]:  File "/home/shcho/torchtitan/timelyfreeze/train.py", line 619, in train
[rank3]:    draw_charts(self.freezer, self.step, job_config)
[rank3]:  File "/home/shcho/torchtitan/timelyfreeze/train.py", line 654, in draw_charts
[rank3]:    draw_pipeline_schedule(save_file=f'{config.job.basename}/pipeline_schedule/{timestamp}_real_{filename_suffix}_rank{config.comm.global_rank}.svg',
[rank3]:  File "/home/shcho/torchtitan/timelyfreeze/core/util.py", line 227, in draw_pipeline_schedule
[rank3]:    plt.savefig(save_file, bbox_inches='tight', pad_inches=0)
[rank3]:  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/pyplot.py", line 1250, in savefig
[rank3]:    res = fig.savefig(*args, **kwargs)  # type: ignore[func-returns-value]
[rank3]:          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/figure.py", line 3490, in savefig
[rank3]:    self.canvas.print_figure(fname, **kwargs)
[rank3]:  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backend_bases.py", line 2186, in print_figure
[rank3]:    result = print_method(
[rank3]:             ^^^^^^^^^^^^^
[rank3]:  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backend_bases.py", line 2042, in <lambda>
[rank3]:    print_method = functools.wraps(meth)(lambda *args, **kwargs: meth(
[rank3]:                                                                 ^^^^^
[rank3]:  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backends/backend_svg.py", line 1351, in print_svg
[rank3]:    self.figure.draw(renderer)
[rank3]:  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/artist.py", line 94, in draw_wrapper
[rank3]:    result = draw(artist, renderer, *args, **kwargs)
[rank3]:             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/artist.py", line 71, in draw_wrapper
[rank3]:    return draw(artist, renderer)
[rank3]:           ^^^^^^^^^^^^^^^^^^^^^^
[rank3]:  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/figure.py", line 3257, in draw
[rank3]:    mimage._draw_list_compositing_images(
[rank3]:  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/image.py", line 134, in _draw_list_compositing_images
[rank3]:    a.draw(renderer)
[rank3]:  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/artist.py", line 71, in draw_wrapper
[rank3]:    return draw(artist, renderer)
[rank3]:           ^^^^^^^^^^^^^^^^^^^^^^
[rank3]:  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/axes/_base.py", line 3226, in draw
[rank3]:    mimage._draw_list_compositing_images(
[rank3]:  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/image.py", line 134, in _draw_list_compositing_images
[rank3]:    a.draw(renderer)
[rank3]:  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/artist.py", line 71, in draw_wrapper
[rank3]:    return draw(artist, renderer)
[rank3]:           ^^^^^^^^^^^^^^^^^^^^^^
[rank3]:  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/patches.py", line 642, in draw
[rank3]:    self._draw_paths_with_artist_properties(
[rank3]:  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/patches.py", line 627, in _draw_paths_with_artist_properties
[rank3]:    renderer.draw_path(gc, *draw_path_args)
[rank3]:  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backends/backend_svg.py", line 688, in draw_path
[rank3]:    self.writer.element('path', d=path_data, **self._get_clip_attrs(gc),
[rank3]:  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backends/backend_svg.py", line 241, in element
[rank3]:    self.start(tag, attrib, **extra)
[rank3]:  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backends/backend_svg.py", line 165, in start
[rank3]:    self.__write(f' {k}={v}')
[rank3]:OSError: [Errno 28] No space left on device
[rank3]:[rank3]: Traceback (most recent call last):
[rank3]:[rank3]:   File "<frozen runpy>", line 198, in _run_module_as_main
[rank3]:[rank3]:   File "<frozen runpy>", line 88, in _run_code
[rank3]:[rank3]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 720, in <module>
[rank3]:[rank3]:     trainer.train()
[rank3]:[rank3]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
[rank3]:[rank3]:     return f(*args, **kwargs)
[rank3]:[rank3]:            ^^^^^^^^^^^^^^^^^^
[rank3]:[rank3]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 619, in train
[rank3]:[rank3]:     draw_charts(self.freezer, self.step, job_config)
[rank3]:[rank3]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 654, in draw_charts
[rank3]:[rank3]:     draw_pipeline_schedule(save_file=f'{config.job.basename}/pipeline_schedule/{timestamp}_real_{filename_suffix}_rank{config.comm.global_rank}.svg',
[rank3]:[rank3]:   File "/home/shcho/torchtitan/timelyfreeze/core/util.py", line 227, in draw_pipeline_schedule
[rank3]:[rank3]:     plt.savefig(save_file, bbox_inches='tight', pad_inches=0)
[rank3]:[rank3]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/pyplot.py", line 1250, in savefig
[rank3]:[rank3]:     res = fig.savefig(*args, **kwargs)  # type: ignore[func-returns-value]
[rank3]:[rank3]:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:[rank3]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/figure.py", line 3490, in savefig
[rank3]:[rank3]:     self.canvas.print_figure(fname, **kwargs)
[rank3]:[rank3]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backend_bases.py", line 2186, in print_figure
[rank3]:[rank3]:     result = print_method(
[rank3]:[rank3]:              ^^^^^^^^^^^^^
[rank3]:[rank3]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backend_bases.py", line 2042, in <lambda>
[rank3]:[rank3]:     print_method = functools.wraps(meth)(lambda *args, **kwargs: meth(
[rank3]:[rank3]:                                                                  ^^^^^
[rank3]:[rank3]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backends/backend_svg.py", line 1351, in print_svg
[rank3]:[rank3]:     self.figure.draw(renderer)
[rank3]:[rank3]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/artist.py", line 94, in draw_wrapper
[rank3]:[rank3]:     result = draw(artist, renderer, *args, **kwargs)
[rank3]:[rank3]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:[rank3]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/artist.py", line 71, in draw_wrapper
[rank3]:[rank3]:     return draw(artist, renderer)
[rank3]:[rank3]:            ^^^^^^^^^^^^^^^^^^^^^^
[rank3]:[rank3]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/figure.py", line 3257, in draw
[rank3]:[rank3]:     mimage._draw_list_compositing_images(
[rank3]:[rank3]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/image.py", line 134, in _draw_list_compositing_images
[rank3]:[rank3]:     a.draw(renderer)
[rank3]:[rank3]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/artist.py", line 71, in draw_wrapper
[rank3]:[rank3]:     return draw(artist, renderer)
[rank3]:[rank3]:            ^^^^^^^^^^^^^^^^^^^^^^
[rank3]:[rank3]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/axes/_base.py", line 3226, in draw
[rank3]:[rank3]:     mimage._draw_list_compositing_images(
[rank3]:[rank3]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/image.py", line 134, in _draw_list_compositing_images
[rank3]:[rank3]:     a.draw(renderer)
[rank3]:[rank3]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/artist.py", line 71, in draw_wrapper
[rank3]:[rank3]:     return draw(artist, renderer)
[rank3]:[rank3]:            ^^^^^^^^^^^^^^^^^^^^^^
[rank3]:[rank3]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/patches.py", line 642, in draw
[rank3]:[rank3]:     self._draw_paths_with_artist_properties(
[rank3]:[rank3]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/patches.py", line 627, in _draw_paths_with_artist_properties
[rank3]:[rank3]:     renderer.draw_path(gc, *draw_path_args)
[rank3]:[rank3]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backends/backend_svg.py", line 688, in draw_path
[rank3]:[rank3]:     self.writer.element('path', d=path_data, **self._get_clip_attrs(gc),
[rank3]:[rank3]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backends/backend_svg.py", line 241, in element
[rank3]:[rank3]:     self.start(tag, attrib, **extra)
[rank3]:[rank3]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backends/backend_svg.py", line 165, in start
[rank3]:[rank3]:     self.__write(f' {k}={v}')
[rank3]:[rank3]: OSError: [Errno 28] No space left on device
W1025 13:32:14.647000 3085995 site-packages/torch/distributed/elastic/multiprocessing/api.py:940] Sending process 3086027 closing signal SIGTERM
W1025 13:32:14.648000 3085995 site-packages/torch/distributed/elastic/multiprocessing/api.py:940] Sending process 3086028 closing signal SIGTERM
W1025 13:32:14.649000 3085995 site-packages/torch/distributed/elastic/multiprocessing/api.py:940] Sending process 3086030 closing signal SIGTERM
E1025 13:32:16.124000 3085995 site-packages/torch/distributed/elastic/multiprocessing/api.py:914] failed (exitcode: 1) local_rank: 2 (pid: 3086029) of binary: /data2/shcho/miniforge3/envs/llm_eval/bin/python3.11
E1025 13:32:16.142000 3085995 site-packages/torch/distributed/elastic/multiprocessing/errors/error_handler.py:141] no error file defined for parent, to copy child error file (/tmp/torchelastic_tmua5exp/f5854253-6c71-4f5e-9025-beecfa7205c4_p3l5px8i/attempt_0/2/error.json)
[rank0]:Stage 0: Modules to keep: {'tok_embeddings', 'layers.1', 'layers.0'}
[rank0]:Stage 4: Modules to keep: {'layers.9', 'layers.10'}
[rank2]:Stage 2: Modules to keep: {'layers.5', 'layers.6'}
[rank2]:Stage 6: Modules to keep: {'layers.14', 'layers.13'}
[rank1]:Stage 1: Modules to keep: {'layers.2', 'layers.4', 'layers.3'}
[rank1]:Stage 5: Modules to keep: {'layers.11', 'layers.12'}
[rank3]:Stage 3: Modules to keep: {'layers.8', 'layers.7'}
[rank3]:Stage 7: Modules to keep: {'output', 'norm', 'layers.15'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1022_llama1binstruct/config.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1023_Interleaved1F1B_auto_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: profile_trace/1023_Interleaved1F1B_auto_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: memory_snapshot/1023_Interleaved1F1B_auto_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 20
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: tb/1023_Interleaved1F1B_auto_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- pplog_freq: 80
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1023_Interleaved1F1B_auto_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B-Instruct
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 1e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: alpaca
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 2000
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: Interleaved1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 2
[rank3]:		- stages_list: [3, 7]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- folder: checkpoint/1023_Interleaved1F1B_auto_dm1
[rank3]:		- interval: 500
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B-Instruct/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: comm_traces/1023_Interleaved1F1B_auto_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 8
[rank3]:		- seq_len: 2048
[rank3]:		- freq: 10
[rank3]:		- steps: -1
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: auto
[rank3]:		- phase_unit: 10
[rank3]:		- stability_check_freq: 5
[rank3]:		- aggressiveness: 0
[rank3]:
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
Traceback (most recent call last):
  File "/data2/shcho/miniforge3/envs/llm_eval/bin/torchrun", line 7, in <module>
    sys.exit(main())
             ^^^^^^
  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/run.py", line 946, in main
    run(args)
  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/run.py", line 937, in run
    elastic_launch(
  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 159, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 300, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
timelyfreeze.train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2025-10-25_13:32:12
  host      : elga.kaist.ac.kr
  rank      : 0 (local_rank: 0)
  exitcode  : 1 (pid: 3086027)
  error_file: /tmp/torchelastic_tmua5exp/f5854253-6c71-4f5e-9025-beecfa7205c4_p3l5px8i/attempt_0/0/error.json
  traceback : Traceback (most recent call last):
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
      return f(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^
    File "/home/shcho/torchtitan/timelyfreeze/train.py", line 619, in train
      draw_charts(self.freezer, self.step, job_config)
    File "/home/shcho/torchtitan/timelyfreeze/train.py", line 681, in draw_charts
      draw_line_chart([freezer.stability_check_freq * k for k in range(len(freezer.freeze_ratio_history[s]))],
    File "/home/shcho/torchtitan/timelyfreeze/core/util.py", line 66, in draw_line_chart
      plt.savefig(save_file)
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/pyplot.py", line 1250, in savefig
      res = fig.savefig(*args, **kwargs)  # type: ignore[func-returns-value]
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/figure.py", line 3490, in savefig
      self.canvas.print_figure(fname, **kwargs)
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backend_bases.py", line 2186, in print_figure
      result = print_method(
               ^^^^^^^^^^^^^
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backend_bases.py", line 2042, in <lambda>
      print_method = functools.wraps(meth)(lambda *args, **kwargs: meth(
                                                                   ^^^^^
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backends/backend_svg.py", line 1351, in print_svg
      self.figure.draw(renderer)
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/artist.py", line 94, in draw_wrapper
      result = draw(artist, renderer, *args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/artist.py", line 71, in draw_wrapper
      return draw(artist, renderer)
             ^^^^^^^^^^^^^^^^^^^^^^
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/figure.py", line 3257, in draw
      mimage._draw_list_compositing_images(
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/image.py", line 134, in _draw_list_compositing_images
      a.draw(renderer)
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/artist.py", line 71, in draw_wrapper
      return draw(artist, renderer)
             ^^^^^^^^^^^^^^^^^^^^^^
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/axes/_base.py", line 3226, in draw
      mimage._draw_list_compositing_images(
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/image.py", line 134, in _draw_list_compositing_images
      a.draw(renderer)
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/artist.py", line 71, in draw_wrapper
      return draw(artist, renderer)
             ^^^^^^^^^^^^^^^^^^^^^^
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/axis.py", line 1412, in draw
      self.label.draw(renderer)
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/artist.py", line 71, in draw_wrapper
      return draw(artist, renderer)
             ^^^^^^^^^^^^^^^^^^^^^^
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/text.py", line 808, in draw
      textrenderer.draw_text(gc, x, y, clean_line,
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backends/backend_svg.py", line 1279, in draw_text
      self._draw_text_as_path(gc, x, y, s, prop, angle, ismath, mtext)
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backends/backend_svg.py", line 1071, in _draw_text_as_path
      self._update_glyph_map_defs(glyph_map_new)
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backends/backend_svg.py", line 1029, in _update_glyph_map_defs
      writer.element(
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backends/backend_svg.py", line 241, in element
      self.start(tag, attrib, **extra)
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backends/backend_svg.py", line 165, in start
      self.__write(f' {k}={v}')
  OSError: [Errno 28] No space left on device
  
[2]:
  time      : 2025-10-25_13:32:12
  host      : elga.kaist.ac.kr
  rank      : 1 (local_rank: 1)
  exitcode  : 1 (pid: 3086028)
  error_file: /tmp/torchelastic_tmua5exp/f5854253-6c71-4f5e-9025-beecfa7205c4_p3l5px8i/attempt_0/1/error.json
  traceback : Traceback (most recent call last):
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
      return f(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^
    File "/home/shcho/torchtitan/timelyfreeze/train.py", line 619, in train
      draw_charts(self.freezer, self.step, job_config)
    File "/home/shcho/torchtitan/timelyfreeze/train.py", line 681, in draw_charts
      draw_line_chart([freezer.stability_check_freq * k for k in range(len(freezer.freeze_ratio_history[s]))],
    File "/home/shcho/torchtitan/timelyfreeze/core/util.py", line 66, in draw_line_chart
      plt.savefig(save_file)
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/pyplot.py", line 1250, in savefig
      res = fig.savefig(*args, **kwargs)  # type: ignore[func-returns-value]
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/figure.py", line 3490, in savefig
      self.canvas.print_figure(fname, **kwargs)
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backend_bases.py", line 2186, in print_figure
      result = print_method(
               ^^^^^^^^^^^^^
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backend_bases.py", line 2042, in <lambda>
      print_method = functools.wraps(meth)(lambda *args, **kwargs: meth(
                                                                   ^^^^^
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backends/backend_svg.py", line 1351, in print_svg
      self.figure.draw(renderer)
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/artist.py", line 94, in draw_wrapper
      result = draw(artist, renderer, *args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/artist.py", line 71, in draw_wrapper
      return draw(artist, renderer)
             ^^^^^^^^^^^^^^^^^^^^^^
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/figure.py", line 3257, in draw
      mimage._draw_list_compositing_images(
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/image.py", line 134, in _draw_list_compositing_images
      a.draw(renderer)
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/artist.py", line 71, in draw_wrapper
      return draw(artist, renderer)
             ^^^^^^^^^^^^^^^^^^^^^^
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/axes/_base.py", line 3226, in draw
      mimage._draw_list_compositing_images(
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/image.py", line 134, in _draw_list_compositing_images
      a.draw(renderer)
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/artist.py", line 71, in draw_wrapper
      return draw(artist, renderer)
             ^^^^^^^^^^^^^^^^^^^^^^
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/axis.py", line 1412, in draw
      self.label.draw(renderer)
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/artist.py", line 71, in draw_wrapper
      return draw(artist, renderer)
             ^^^^^^^^^^^^^^^^^^^^^^
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/text.py", line 808, in draw
      textrenderer.draw_text(gc, x, y, clean_line,
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backends/backend_svg.py", line 1279, in draw_text
      self._draw_text_as_path(gc, x, y, s, prop, angle, ismath, mtext)
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backends/backend_svg.py", line 1071, in _draw_text_as_path
      self._update_glyph_map_defs(glyph_map_new)
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backends/backend_svg.py", line 1029, in _update_glyph_map_defs
      writer.element(
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backends/backend_svg.py", line 241, in element
      self.start(tag, attrib, **extra)
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backends/backend_svg.py", line 165, in start
      self.__write(f' {k}={v}')
  OSError: [Errno 28] No space left on device
  
[3]:
  time      : 2025-10-25_13:32:12
  host      : elga.kaist.ac.kr
  rank      : 3 (local_rank: 3)
  exitcode  : -15 (pid: 3086030)
  error_file: /tmp/torchelastic_tmua5exp/f5854253-6c71-4f5e-9025-beecfa7205c4_p3l5px8i/attempt_0/3/error.json
  traceback : Traceback (most recent call last):
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
      return f(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^
    File "/home/shcho/torchtitan/timelyfreeze/train.py", line 619, in train
      draw_charts(self.freezer, self.step, job_config)
    File "/home/shcho/torchtitan/timelyfreeze/train.py", line 654, in draw_charts
      draw_pipeline_schedule(save_file=f'{config.job.basename}/pipeline_schedule/{timestamp}_real_{filename_suffix}_rank{config.comm.global_rank}.svg',
    File "/home/shcho/torchtitan/timelyfreeze/core/util.py", line 227, in draw_pipeline_schedule
      plt.savefig(save_file, bbox_inches='tight', pad_inches=0)
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/pyplot.py", line 1250, in savefig
      res = fig.savefig(*args, **kwargs)  # type: ignore[func-returns-value]
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/figure.py", line 3490, in savefig
      self.canvas.print_figure(fname, **kwargs)
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backend_bases.py", line 2186, in print_figure
      result = print_method(
               ^^^^^^^^^^^^^
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backend_bases.py", line 2042, in <lambda>
      print_method = functools.wraps(meth)(lambda *args, **kwargs: meth(
                                                                   ^^^^^
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backends/backend_svg.py", line 1351, in print_svg
      self.figure.draw(renderer)
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/artist.py", line 94, in draw_wrapper
      result = draw(artist, renderer, *args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/artist.py", line 71, in draw_wrapper
      return draw(artist, renderer)
             ^^^^^^^^^^^^^^^^^^^^^^
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/figure.py", line 3257, in draw
      mimage._draw_list_compositing_images(
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/image.py", line 134, in _draw_list_compositing_images
      a.draw(renderer)
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/artist.py", line 71, in draw_wrapper
      return draw(artist, renderer)
             ^^^^^^^^^^^^^^^^^^^^^^
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/axes/_base.py", line 3226, in draw
      mimage._draw_list_compositing_images(
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/image.py", line 134, in _draw_list_compositing_images
      a.draw(renderer)
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/artist.py", line 71, in draw_wrapper
      return draw(artist, renderer)
             ^^^^^^^^^^^^^^^^^^^^^^
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/patches.py", line 642, in draw
      self._draw_paths_with_artist_properties(
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/patches.py", line 627, in _draw_paths_with_artist_properties
      renderer.draw_path(gc, *draw_path_args)
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backends/backend_svg.py", line 688, in draw_path
      self.writer.element('path', d=path_data, **self._get_clip_attrs(gc),
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backends/backend_svg.py", line 241, in element
      self.start(tag, attrib, **extra)
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backends/backend_svg.py", line 165, in start
      self.__write(f' {k}={v}')
  OSError: [Errno 28] No space left on device
  
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2025-10-25_13:32:12
  host      : elga.kaist.ac.kr
  rank      : 2 (local_rank: 2)
  exitcode  : 1 (pid: 3086029)
  error_file: /tmp/torchelastic_tmua5exp/f5854253-6c71-4f5e-9025-beecfa7205c4_p3l5px8i/attempt_0/2/error.json
  traceback : Traceback (most recent call last):
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
      return f(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^
    File "/home/shcho/torchtitan/timelyfreeze/train.py", line 619, in train
      draw_charts(self.freezer, self.step, job_config)
    File "/home/shcho/torchtitan/timelyfreeze/train.py", line 681, in draw_charts
      draw_line_chart([freezer.stability_check_freq * k for k in range(len(freezer.freeze_ratio_history[s]))],
    File "/home/shcho/torchtitan/timelyfreeze/core/util.py", line 66, in draw_line_chart
      plt.savefig(save_file)
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/pyplot.py", line 1250, in savefig
      res = fig.savefig(*args, **kwargs)  # type: ignore[func-returns-value]
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/figure.py", line 3490, in savefig
      self.canvas.print_figure(fname, **kwargs)
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backend_bases.py", line 2186, in print_figure
      result = print_method(
               ^^^^^^^^^^^^^
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backend_bases.py", line 2042, in <lambda>
      print_method = functools.wraps(meth)(lambda *args, **kwargs: meth(
                                                                   ^^^^^
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backends/backend_svg.py", line 1351, in print_svg
      self.figure.draw(renderer)
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/artist.py", line 94, in draw_wrapper
      result = draw(artist, renderer, *args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/artist.py", line 71, in draw_wrapper
      return draw(artist, renderer)
             ^^^^^^^^^^^^^^^^^^^^^^
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/figure.py", line 3257, in draw
      mimage._draw_list_compositing_images(
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/image.py", line 134, in _draw_list_compositing_images
      a.draw(renderer)
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/artist.py", line 71, in draw_wrapper
      return draw(artist, renderer)
             ^^^^^^^^^^^^^^^^^^^^^^
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/axes/_base.py", line 3226, in draw
      mimage._draw_list_compositing_images(
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/image.py", line 134, in _draw_list_compositing_images
      a.draw(renderer)
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/artist.py", line 71, in draw_wrapper
      return draw(artist, renderer)
             ^^^^^^^^^^^^^^^^^^^^^^
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/axis.py", line 1412, in draw
      self.label.draw(renderer)
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/artist.py", line 71, in draw_wrapper
      return draw(artist, renderer)
             ^^^^^^^^^^^^^^^^^^^^^^
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/text.py", line 808, in draw
      textrenderer.draw_text(gc, x, y, clean_line,
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backends/backend_svg.py", line 1279, in draw_text
      self._draw_text_as_path(gc, x, y, s, prop, angle, ismath, mtext)
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backends/backend_svg.py", line 1071, in _draw_text_as_path
      self._update_glyph_map_defs(glyph_map_new)
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backends/backend_svg.py", line 1029, in _update_glyph_map_defs
      writer.element(
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backends/backend_svg.py", line 241, in element
      self.start(tag, attrib, **extra)
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backends/backend_svg.py", line 165, in start
      self.__write(f' {k}={v}')
  OSError: [Errno 28] No space left on device
  
============================================================
