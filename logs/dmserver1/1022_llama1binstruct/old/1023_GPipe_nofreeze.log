
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 10. 23. (ëª©) 22:36:48 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 3,4,5,6
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1022_llama1binstruct/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1022_llama1binstruct/1023_GPipe_nofreeze.log
âœ”ï¸Main Table Experiment
âœ”ï¸Running with nofreeze x GPipe ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1022_llama1binstruct/config.toml --job.description="Main Table Experiment" --parallelism.pipeline_parallel_degree=4  --freezing.no-freeze
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank3]:2025-10-23 22:36:54,848 - INFO - Starting job: "Main Table Experiment"
[rank1]:2025-10-23 22:36:54,842 - INFO - Starting job: "Main Table Experiment"
[rank0]:2025-10-23 22:36:55,051 - INFO - Starting job: "Main Table Experiment"
[rank2]:2025-10-23 22:36:55,055 - INFO - Starting job: "Main Table Experiment"
[rank0]:2025-10-23 22:36:55,519 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-10-23 22:36:55,523 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-23 22:36:55,528 - INFO - [GC] Initial GC collection 0.00 seconds
[rank1]:2025-10-23 22:36:55,492 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-10-23 22:36:55,494 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-10-23 22:36:55,496 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-10-23 22:36:55,499 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-10-23 22:36:55,509 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-10-23 22:36:55,512 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-23 22:36:55,985 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-10-23 22:36:56,405 - INFO - Preparing slimorca dataset from Open-Orca/SlimOrca
[rank0]:2025-10-23 22:36:59,538 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank0]:2025-10-23 22:36:59,706 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-10-23 22:36:59,747 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-10-23 22:36:59,748 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank1]:2025-10-23 22:36:59,684 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-10-23 22:36:59,726 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-10-23 22:36:59,754 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-10-23 22:36:59,755 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-10-23 22:36:59,775 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-10-23 22:36:59,775 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-10-23 22:36:59,956 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-10-23 22:36:59,957 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-10-23 22:36:59,957 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank1]:2025-10-23 22:36:59,929 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-10-23 22:36:59,929 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-10-23 22:36:59,930 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank2]:2025-10-23 22:37:00,243 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank2]:2025-10-23 22:37:00,282 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-10-23 22:37:00,310 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-10-23 22:37:00,310 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank2]:2025-10-23 22:37:00,958 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-10-23 22:37:00,958 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-10-23 22:37:00,959 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run z7jb7rdw
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1023_GPipe_nofreeze_dm1/20251023-2237/wandb/run-20251023_223701-z7jb7rdw
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1023_GPipe_nofreeze_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/z7jb7rdw
[rank3]:2025-10-23 22:37:02,193 - INFO - WandB logging enabled
[rank3]:2025-10-23 22:37:02,281 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-10-23 22:37:02,321 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-10-23 22:37:02,351 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-10-23 22:37:02,352 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-10-23 22:37:02,800 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1023_GPipe_nofreeze_dm1
[rank0]:2025-10-23 22:37:02,800 - WARNING - Mixed precision training with TP or PP is only supported when FSDP/HSDP/CP is enabled.
[rank0]:2025-10-23 22:37:02,800 - INFO - Mixed precision training is disabled
[rank0]:2025-10-23 22:37:02,800 - INFO - Trainer is initialized with local batch size 16, global batch size 128, gradient accumulation steps 8, sequence length 1024, total steps 1000 (warmup 100)
[rank0]:2025-10-23 22:37:02,801 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B-Instruct/original_dcp.
[rank3]:2025-10-23 22:37:02,784 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-10-23 22:37:02,785 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-10-23 22:37:02,786 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank0]:2025-10-23 22:37:05,060 - INFO - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-10-23 22:37:05,060 - INFO - Finished loading the checkpoint in 2.26 seconds.
[rank0]:2025-10-23 22:37:05,060 - INFO - Training starts at step 1
[rank0]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/autograd/graph.py:849: UserWarning: Attempting to run cuBLAS, but there was no current CUDA context! Attempting to set the primary context... (Triggered internally at /pytorch/aten/src/ATen/cuda/CublasHandlePool.cpp:270.)
[rank0]:  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
[rank0]:2025-10-23 22:37:22,163 - INFO -  step:  1  loss: -8.0000  grad_norm:  1.7131  memory: 17.10GiB(35.99%)  tps: 1,462  tflops: 11.43  mfu: 3.66%
[rank0]:2025-10-23 22:37:22,163 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-10-23 22:37:22,126 - INFO -  step:  1  loss: -8.0000  grad_norm:  1.7131  memory: 17.77GiB(37.40%)  tps: 1,463  tflops: 11.44  mfu: 3.67%
[rank1]:2025-10-23 22:37:22,126 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-10-23 22:37:22,122 - INFO -  step:  1  loss: -8.0000  grad_norm:  1.7131  memory: 14.29GiB(30.07%)  tps: 1,500  tflops: 11.73  mfu: 3.76%
[rank2]:2025-10-23 22:37:22,123 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-23 22:37:22,133 - INFO -  step:  1  loss:  2.4984  grad_norm:  1.7131  memory: 35.59GiB(74.92%)  tps: 1,654  tflops: 12.93  mfu: 4.14%
[rank3]:2025-10-23 22:37:22,134 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-10-23 22:39:52,993 - INFO - Avg. fwd time: 34.8205 / Avg. bwd time: 54.0193 / Avg. batch time: 1797.1560 (ms) / GPU bubble ratio: 60.45%
[rank3]:2025-10-23 22:39:52,937 - INFO - Avg. fwd time: 74.8802 / Avg. bwd time: 132.3304 / Avg. batch time: 1706.5495 (ms) / GPU bubble ratio: 2.86%
[rank1]:2025-10-23 22:39:53,065 - INFO - Avg. fwd time: 53.6250 / Avg. bwd time: 73.4870 / Avg. batch time: 1918.0121 (ms) / GPU bubble ratio: 46.98%
[rank0]:2025-10-23 22:39:53,132 - INFO - Avg. fwd time: 47.5833 / Avg. bwd time: 60.8767 / Avg. batch time: 2016.9337 (ms) / GPU bubble ratio: 56.98%
[rank2]:2025-10-23 22:42:38,753 - INFO -  step: 20  loss: -8.0000  grad_norm:  0.7614  memory: 16.10GiB(33.90%)  tps: 1,966  tflops: 15.37  mfu: 4.93%
[rank3]:2025-10-23 22:42:38,765 - INFO -  step: 20  loss:  2.2833  grad_norm:  0.7614  memory: 38.93GiB(81.95%)  tps: 1,966  tflops: 15.37  mfu: 4.93%
[rank0]:2025-10-23 22:42:38,772 - INFO -  step: 20  loss: -8.0000  grad_norm:  0.7614  memory: 20.89GiB(43.97%)  tps: 1,966  tflops: 15.37  mfu: 4.93%
[rank1]:2025-10-23 22:42:38,757 - INFO -  step: 20  loss: -8.0000  grad_norm:  0.7614  memory: 20.03GiB(42.17%)  tps: 1,966  tflops: 15.37  mfu: 4.93%
[rank2]:2025-10-23 22:42:40,702 - INFO - Avg. fwd time: 34.7117 / Avg. bwd time: 54.3652 / Avg. batch time: 1814.0465 (ms) / GPU bubble ratio: 60.72%
[rank3]:2025-10-23 22:42:40,644 - INFO - Avg. fwd time: 76.0032 / Avg. bwd time: 133.3800 / Avg. batch time: 1723.0062 (ms) / GPU bubble ratio: 2.78%
[rank1]:2025-10-23 22:42:40,783 - INFO - Avg. fwd time: 54.1904 / Avg. bwd time: 73.9207 / Avg. batch time: 1935.7853 (ms) / GPU bubble ratio: 47.06%
[rank0]:2025-10-23 22:42:40,847 - INFO - Avg. fwd time: 47.7528 / Avg. bwd time: 61.0650 / Avg. batch time: 2035.4958 (ms) / GPU bubble ratio: 57.23%
[rank3]:2025-10-23 22:45:28,738 - INFO - Avg. fwd time: 76.3508 / Avg. bwd time: 133.9473 / Avg. batch time: 1730.2375 (ms) / GPU bubble ratio: 2.77%
[rank2]:2025-10-23 22:45:28,796 - INFO - Avg. fwd time: 34.7941 / Avg. bwd time: 54.6296 / Avg. batch time: 1821.5059 (ms) / GPU bubble ratio: 60.73%
[rank0]:2025-10-23 22:45:28,935 - INFO - Avg. fwd time: 47.9192 / Avg. bwd time: 61.2770 / Avg. batch time: 2043.3954 (ms) / GPU bubble ratio: 57.25%
[rank1]:2025-10-23 22:45:28,868 - INFO - Avg. fwd time: 54.0885 / Avg. bwd time: 74.4113 / Avg. batch time: 1943.2722 (ms) / GPU bubble ratio: 47.10%
[rank0]:2025-10-23 22:48:15,246 - INFO -  step: 40  loss: -8.0000  grad_norm:  0.5014  memory: 20.89GiB(43.97%)  tps: 1,948  tflops: 15.23  mfu: 4.88%
[rank2]:2025-10-23 22:48:15,224 - INFO -  step: 40  loss: -8.0000  grad_norm:  0.5014  memory: 16.10GiB(33.90%)  tps: 1,948  tflops: 15.23  mfu: 4.88%
[rank3]:2025-10-23 22:48:15,236 - INFO -  step: 40  loss:  2.1924  grad_norm:  0.5014  memory: 38.93GiB(81.95%)  tps: 1,948  tflops: 15.23  mfu: 4.88%
[rank1]:2025-10-23 22:48:15,227 - INFO -  step: 40  loss: -8.0000  grad_norm:  0.5014  memory: 20.03GiB(42.17%)  tps: 1,948  tflops: 15.23  mfu: 4.88%
[rank3]:2025-10-23 22:48:17,140 - INFO - Avg. fwd time: 76.4379 / Avg. bwd time: 134.3566 / Avg. batch time: 1734.3785 (ms) / GPU bubble ratio: 2.77%
[rank2]:2025-10-23 22:48:17,196 - INFO - Avg. fwd time: 34.8259 / Avg. bwd time: 54.7731 / Avg. batch time: 1825.9124 (ms) / GPU bubble ratio: 60.74%
[rank1]:2025-10-23 22:48:17,271 - INFO - Avg. fwd time: 54.2357 / Avg. bwd time: 74.6500 / Avg. batch time: 1947.6999 (ms) / GPU bubble ratio: 47.06%
[rank0]:2025-10-23 22:48:17,333 - INFO - Avg. fwd time: 48.0194 / Avg. bwd time: 61.4514 / Avg. batch time: 2048.1583 (ms) / GPU bubble ratio: 57.24%
[rank0]:2025-10-23 22:50:46,575 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-23 22:51:05,267 - INFO - Avg. fwd time: 76.5485 / Avg. bwd time: 134.5566 / Avg. batch time: 1736.7493 (ms) / GPU bubble ratio: 2.76%
[rank2]:2025-10-23 22:51:05,329 - INFO - Avg. fwd time: 34.8220 / Avg. bwd time: 54.8467 / Avg. batch time: 1828.3971 (ms) / GPU bubble ratio: 60.77%
[rank1]:2025-10-23 22:51:05,411 - INFO - Avg. fwd time: 54.1412 / Avg. bwd time: 74.6921 / Avg. batch time: 1949.9784 (ms) / GPU bubble ratio: 47.14%
[rank0]:2025-10-23 22:51:05,474 - INFO - Avg. fwd time: 48.0474 / Avg. bwd time: 61.5187 / Avg. batch time: 2050.2753 (ms) / GPU bubble ratio: 57.25%
[rank2]:2025-10-23 22:53:51,256 - INFO -  step: 60  loss: -8.0000  grad_norm:  0.4291  memory: 16.10GiB(33.90%)  tps: 1,950  tflops: 15.25  mfu: 4.89%
[rank0]:2025-10-23 22:53:51,278 - INFO -  step: 60  loss: -8.0000  grad_norm:  0.4291  memory: 20.89GiB(43.97%)  tps: 1,950  tflops: 15.25  mfu: 4.89%
[rank3]:2025-10-23 22:53:51,269 - INFO -  step: 60  loss:  2.0720  grad_norm:  0.4291  memory: 38.93GiB(81.95%)  tps: 1,950  tflops: 15.25  mfu: 4.89%
[rank1]:2025-10-23 22:53:51,261 - INFO -  step: 60  loss: -8.0000  grad_norm:  0.4291  memory: 20.03GiB(42.17%)  tps: 1,950  tflops: 15.25  mfu: 4.89%
[rank3]:2025-10-23 22:53:53,175 - INFO - Avg. fwd time: 76.5805 / Avg. bwd time: 134.6409 / Avg. batch time: 1737.7207 (ms) / GPU bubble ratio: 2.76%
[rank2]:2025-10-23 22:53:53,237 - INFO - Avg. fwd time: 34.8416 / Avg. bwd time: 54.9075 / Avg. batch time: 1829.4398 (ms) / GPU bubble ratio: 60.75%
[rank1]:2025-10-23 22:53:53,315 - INFO - Avg. fwd time: 54.1182 / Avg. bwd time: 74.7487 / Avg. batch time: 1950.8467 (ms) / GPU bubble ratio: 47.15%
[rank0]:2025-10-23 22:53:53,384 - INFO - Avg. fwd time: 48.0362 / Avg. bwd time: 61.5147 / Avg. batch time: 2051.1112 (ms) / GPU bubble ratio: 57.27%
[rank3]:2025-10-23 22:56:41,148 - INFO - Avg. fwd time: 76.7080 / Avg. bwd time: 134.6669 / Avg. batch time: 1738.7118 (ms) / GPU bubble ratio: 2.74%
[rank2]:2025-10-23 22:56:41,208 - INFO - Avg. fwd time: 34.8393 / Avg. bwd time: 54.9248 / Avg. batch time: 1830.3603 (ms) / GPU bubble ratio: 60.77%
[rank1]:2025-10-23 22:56:41,291 - INFO - Avg. fwd time: 53.9565 / Avg. bwd time: 74.8830 / Avg. batch time: 1951.6997 (ms) / GPU bubble ratio: 47.19%
[rank0]:2025-10-23 22:56:41,355 - INFO - Avg. fwd time: 48.0525 / Avg. bwd time: 61.4969 / Avg. batch time: 2051.9179 (ms) / GPU bubble ratio: 57.29%
[rank2]:2025-10-23 22:59:27,453 - INFO -  step: 80  loss: -8.0000  grad_norm:  0.4027  memory: 16.10GiB(33.90%)  tps: 1,949  tflops: 15.24  mfu: 4.88%
[rank3]:2025-10-23 22:59:27,466 - INFO -  step: 80  loss:  1.9461  grad_norm:  0.4027  memory: 38.93GiB(81.95%)  tps: 1,949  tflops: 15.24  mfu: 4.88%
[rank1]:2025-10-23 22:59:27,457 - INFO -  step: 80  loss: -8.0000  grad_norm:  0.4027  memory: 20.03GiB(42.17%)  tps: 1,949  tflops: 15.24  mfu: 4.88%
[rank0]:2025-10-23 22:59:27,474 - INFO -  step: 80  loss: -8.0000  grad_norm:  0.4027  memory: 20.89GiB(43.97%)  tps: 1,949  tflops: 15.24  mfu: 4.88%
[rank2]:2025-10-23 22:59:29,441 - INFO - Avg. fwd time: 34.8415 / Avg. bwd time: 54.9459 / Avg. batch time: 1831.2518 (ms) / GPU bubble ratio: 60.78%
[rank3]:2025-10-23 22:59:29,382 - INFO - Avg. fwd time: 76.7299 / Avg. bwd time: 134.7462 / Avg. batch time: 1739.6393 (ms) / GPU bubble ratio: 2.75%
[rank1]:2025-10-23 22:59:29,522 - INFO - Avg. fwd time: 54.0014 / Avg. bwd time: 74.9391 / Avg. batch time: 1952.7181 (ms) / GPU bubble ratio: 47.17%
[rank0]:2025-10-23 22:59:29,586 - INFO - Avg. fwd time: 48.0738 / Avg. bwd time: 61.5136 / Avg. batch time: 2052.8854 (ms) / GPU bubble ratio: 57.29%
[rank3]:2025-10-23 23:02:16,365 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_nofreeze_dm1/pipeline_schedule/251023_2302_real_warmupend90_rank3.svg
[rank3]:> Batch Time: 2002.12 ms, GPU Bubble Ratio: 56.21%, 48.05%, 64.45%, 15.08%
[rank3]:2025-10-23 23:02:18,151 - INFO - Avg. fwd time: 76.7293 / Avg. bwd time: 134.8422 / Avg. batch time: 1740.5172 (ms) / GPU bubble ratio: 2.75%
[rank2]:2025-10-23 23:02:18,214 - INFO - Avg. fwd time: 34.8517 / Avg. bwd time: 54.9973 / Avg. batch time: 1832.3793 (ms) / GPU bubble ratio: 60.77%
[rank1]:2025-10-23 23:02:18,292 - INFO - Avg. fwd time: 54.1102 / Avg. bwd time: 75.0329 / Avg. batch time: 1954.1447 (ms) / GPU bubble ratio: 47.13%
[rank0]:2025-10-23 23:02:18,356 - INFO - Avg. fwd time: 48.0809 / Avg. bwd time: 61.5512 / Avg. batch time: 2054.3226 (ms) / GPU bubble ratio: 57.31%
[rank0]:2025-10-23 23:04:47,922 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-23 23:05:04,775 - INFO -  step: 100  loss: -8.0000  grad_norm:  0.3787  memory: 20.89GiB(43.97%)  tps: 1,943  tflops: 15.19  mfu: 4.87%
[rank3]:2025-10-23 23:05:04,768 - INFO -  step: 100  loss:  1.9547  grad_norm:  0.3787  memory: 38.93GiB(81.95%)  tps: 1,943  tflops: 15.19  mfu: 4.87%
[rank2]:2025-10-23 23:05:04,755 - INFO -  step: 100  loss: -8.0000  grad_norm:  0.3787  memory: 16.10GiB(33.90%)  tps: 1,943  tflops: 15.19  mfu: 4.87%
[rank1]:2025-10-23 23:05:04,759 - INFO -  step: 100  loss: -8.0000  grad_norm:  0.3787  memory: 20.03GiB(42.17%)  tps: 1,943  tflops: 15.19  mfu: 4.87%
[rank3]:2025-10-23 23:05:05,020 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_nofreeze_dm1/pipeline_schedule/251023_2305_real_step100_rank3.svg
[rank3]:> Batch Time: 2002.75 ms, GPU Bubble Ratio: 56.26%, 48.03%, 64.44%, 15.08%
[rank3]:2025-10-23 23:05:06,809 - INFO - Avg. fwd time: 76.7547 / Avg. bwd time: 134.9083 / Avg. batch time: 1741.2570 (ms) / GPU bubble ratio: 2.75%
[rank2]:2025-10-23 23:05:06,868 - INFO - Avg. fwd time: 34.8579 / Avg. bwd time: 55.0224 / Avg. batch time: 1833.3198 (ms) / GPU bubble ratio: 60.78%
[rank1]:2025-10-23 23:05:06,942 - INFO - Avg. fwd time: 54.1104 / Avg. bwd time: 75.0754 / Avg. batch time: 1955.1426 (ms) / GPU bubble ratio: 47.14%
[rank0]:2025-10-23 23:05:07,008 - INFO - Avg. fwd time: 48.0621 / Avg. bwd time: 61.5482 / Avg. batch time: 2055.2907 (ms) / GPU bubble ratio: 57.34%
[rank3]:2025-10-23 23:07:54,984 - INFO - Avg. fwd time: 76.7488 / Avg. bwd time: 134.9505 / Avg. batch time: 1741.6194 (ms) / GPU bubble ratio: 2.76%
[rank2]:2025-10-23 23:07:55,045 - INFO - Avg. fwd time: 34.8574 / Avg. bwd time: 55.0249 / Avg. batch time: 1833.6518 (ms) / GPU bubble ratio: 60.79%
[rank1]:2025-10-23 23:07:55,127 - INFO - Avg. fwd time: 54.1595 / Avg. bwd time: 75.1148 / Avg. batch time: 1955.5033 (ms) / GPU bubble ratio: 47.11%
[rank0]:2025-10-23 23:07:55,189 - INFO - Avg. fwd time: 48.0543 / Avg. bwd time: 61.5621 / Avg. batch time: 2055.6227 (ms) / GPU bubble ratio: 57.34%
[rank3]:2025-10-23 23:10:41,044 - INFO -  step: 120  loss:  1.9341  grad_norm:  0.3361  memory: 38.93GiB(81.95%)  tps: 1,949  tflops: 15.24  mfu: 4.88%
[rank2]:2025-10-23 23:10:41,031 - INFO -  step: 120  loss: -8.0000  grad_norm:  0.3361  memory: 16.10GiB(33.90%)  tps: 1,949  tflops: 15.24  mfu: 4.88%
[rank1]:2025-10-23 23:10:41,036 - INFO -  step: 120  loss: -8.0000  grad_norm:  0.3361  memory: 20.03GiB(42.17%)  tps: 1,949  tflops: 15.24  mfu: 4.88%
[rank0]:2025-10-23 23:10:41,057 - INFO -  step: 120  loss: -8.0000  grad_norm:  0.3361  memory: 20.89GiB(43.97%)  tps: 1,949  tflops: 15.24  mfu: 4.88%
[rank3]:2025-10-23 23:10:42,964 - INFO - Avg. fwd time: 76.7447 / Avg. bwd time: 134.9584 / Avg. batch time: 1741.6822 (ms) / GPU bubble ratio: 2.76%
[rank2]:2025-10-23 23:10:43,024 - INFO - Avg. fwd time: 34.8466 / Avg. bwd time: 55.0367 / Avg. batch time: 1833.7327 (ms) / GPU bubble ratio: 60.79%
[rank1]:2025-10-23 23:10:43,103 - INFO - Avg. fwd time: 54.2193 / Avg. bwd time: 75.1287 / Avg. batch time: 1955.5603 (ms) / GPU bubble ratio: 47.09%
[rank0]:2025-10-23 23:10:43,169 - INFO - Avg. fwd time: 48.0120 / Avg. bwd time: 61.5411 / Avg. batch time: 2055.6643 (ms) / GPU bubble ratio: 57.37%
[rank3]:2025-10-23 23:13:30,865 - INFO - Avg. fwd time: 76.7780 / Avg. bwd time: 134.9433 / Avg. batch time: 1741.7606 (ms) / GPU bubble ratio: 2.76%
[rank2]:2025-10-23 23:13:30,925 - INFO - Avg. fwd time: 34.8474 / Avg. bwd time: 55.0425 / Avg. batch time: 1833.8478 (ms) / GPU bubble ratio: 60.79%
[rank1]:2025-10-23 23:13:30,998 - INFO - Avg. fwd time: 54.1844 / Avg. bwd time: 75.1453 / Avg. batch time: 1955.5780 (ms) / GPU bubble ratio: 47.09%
[rank0]:2025-10-23 23:13:31,062 - INFO - Avg. fwd time: 47.9969 / Avg. bwd time: 61.5086 / Avg. batch time: 2055.6359 (ms) / GPU bubble ratio: 57.38%
[rank3]:2025-10-23 23:16:17,078 - INFO -  step: 140  loss:  1.9340  grad_norm:  0.3672  memory: 38.93GiB(81.95%)  tps: 1,950  tflops: 15.25  mfu: 4.89%
[rank2]:2025-10-23 23:16:17,065 - INFO -  step: 140  loss: -8.0000  grad_norm:  0.3672  memory: 16.10GiB(33.90%)  tps: 1,950  tflops: 15.25  mfu: 4.89%
[rank1]:2025-10-23 23:16:17,070 - INFO -  step: 140  loss: -8.0000  grad_norm:  0.3672  memory: 20.03GiB(42.17%)  tps: 1,950  tflops: 15.25  mfu: 4.89%
[rank0]:2025-10-23 23:16:17,091 - INFO -  step: 140  loss: -8.0000  grad_norm:  0.3672  memory: 20.89GiB(43.97%)  tps: 1,950  tflops: 15.25  mfu: 4.89%
[rank3]:2025-10-23 23:16:18,983 - INFO - Avg. fwd time: 76.7687 / Avg. bwd time: 134.9608 / Avg. batch time: 1741.9072 (ms) / GPU bubble ratio: 2.76%
[rank2]:2025-10-23 23:16:19,040 - INFO - Avg. fwd time: 34.8537 / Avg. bwd time: 55.0526 / Avg. batch time: 1833.9571 (ms) / GPU bubble ratio: 60.78%
[rank1]:2025-10-23 23:16:19,125 - INFO - Avg. fwd time: 54.2050 / Avg. bwd time: 75.1561 / Avg. batch time: 1955.7184 (ms) / GPU bubble ratio: 47.08%
[rank0]:2025-10-23 23:16:19,193 - INFO - Avg. fwd time: 48.0061 / Avg. bwd time: 61.5133 / Avg. batch time: 2055.7828 (ms) / GPU bubble ratio: 57.38%
[rank0]:2025-10-23 23:18:48,455 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-23 23:19:07,193 - INFO - Avg. fwd time: 76.7592 / Avg. bwd time: 134.9871 / Avg. batch time: 1742.0735 (ms) / GPU bubble ratio: 2.76%
[rank2]:2025-10-23 23:19:07,252 - INFO - Avg. fwd time: 34.8673 / Avg. bwd time: 55.0737 / Avg. batch time: 1834.1698 (ms) / GPU bubble ratio: 60.77%
[rank1]:2025-10-23 23:19:07,335 - INFO - Avg. fwd time: 54.2219 / Avg. bwd time: 75.1811 / Avg. batch time: 1955.9487 (ms) / GPU bubble ratio: 47.07%
[rank0]:2025-10-23 23:19:07,398 - INFO - Avg. fwd time: 48.0155 / Avg. bwd time: 61.5092 / Avg. batch time: 2056.0044 (ms) / GPU bubble ratio: 57.38%
[rank2]:2025-10-23 23:21:53,389 - INFO -  step: 160  loss: -8.0000  grad_norm:  0.3478  memory: 16.10GiB(33.90%)  tps: 1,949  tflops: 15.23  mfu: 4.88%
[rank3]:2025-10-23 23:21:53,401 - INFO -  step: 160  loss:  1.8740  grad_norm:  0.3478  memory: 38.93GiB(81.95%)  tps: 1,949  tflops: 15.23  mfu: 4.88%
[rank1]:2025-10-23 23:21:53,392 - INFO -  step: 160  loss: -8.0000  grad_norm:  0.3478  memory: 20.03GiB(42.17%)  tps: 1,949  tflops: 15.23  mfu: 4.88%
[rank0]:2025-10-23 23:21:53,413 - INFO -  step: 160  loss: -8.0000  grad_norm:  0.3478  memory: 20.89GiB(43.97%)  tps: 1,949  tflops: 15.23  mfu: 4.88%
[rank3]:2025-10-23 23:21:55,312 - INFO - Avg. fwd time: 76.7655 / Avg. bwd time: 135.0016 / Avg. batch time: 1742.2183 (ms) / GPU bubble ratio: 2.76%
[rank2]:2025-10-23 23:21:55,370 - INFO - Avg. fwd time: 34.8660 / Avg. bwd time: 55.0931 / Avg. batch time: 1834.3020 (ms) / GPU bubble ratio: 60.77%
[rank1]:2025-10-23 23:21:55,447 - INFO - Avg. fwd time: 54.2019 / Avg. bwd time: 75.1832 / Avg. batch time: 1955.9928 (ms) / GPU bubble ratio: 47.08%
[rank0]:2025-10-23 23:21:55,517 - INFO - Avg. fwd time: 48.0087 / Avg. bwd time: 61.5145 / Avg. batch time: 2056.1009 (ms) / GPU bubble ratio: 57.39%
[rank3]:2025-10-23 23:24:43,213 - INFO - Avg. fwd time: 76.7533 / Avg. bwd time: 135.0094 / Avg. batch time: 1742.1943 (ms) / GPU bubble ratio: 2.76%
[rank2]:2025-10-23 23:24:43,271 - INFO - Avg. fwd time: 34.8667 / Avg. bwd time: 55.0960 / Avg. batch time: 1834.2962 (ms) / GPU bubble ratio: 60.76%
[rank1]:2025-10-23 23:24:43,347 - INFO - Avg. fwd time: 54.1920 / Avg. bwd time: 75.1994 / Avg. batch time: 1955.9366 (ms) / GPU bubble ratio: 47.08%
[rank0]:2025-10-23 23:24:43,416 - INFO - Avg. fwd time: 47.9987 / Avg. bwd time: 61.5001 / Avg. batch time: 2056.0551 (ms) / GPU bubble ratio: 57.39%
[rank2]:2025-10-23 23:27:29,303 - INFO -  step: 180  loss: -8.0000  grad_norm:  0.3634  memory: 16.10GiB(33.90%)  tps: 1,951  tflops: 15.25  mfu: 4.89%
[rank1]:2025-10-23 23:27:29,307 - INFO -  step: 180  loss: -8.0000  grad_norm:  0.3634  memory: 20.03GiB(42.17%)  tps: 1,951  tflops: 15.25  mfu: 4.89%
[rank3]:2025-10-23 23:27:29,316 - INFO -  step: 180  loss:  1.9055  grad_norm:  0.3634  memory: 38.93GiB(81.95%)  tps: 1,951  tflops: 15.25  mfu: 4.89%
[rank0]:2025-10-23 23:27:29,322 - INFO -  step: 180  loss: -8.0000  grad_norm:  0.3634  memory: 20.89GiB(43.97%)  tps: 1,951  tflops: 15.25  mfu: 4.89%
[rank3]:2025-10-23 23:27:31,217 - INFO - Avg. fwd time: 76.7662 / Avg. bwd time: 135.0053 / Avg. batch time: 1742.2295 (ms) / GPU bubble ratio: 2.76%
[rank2]:2025-10-23 23:27:31,278 - INFO - Avg. fwd time: 34.8712 / Avg. bwd time: 55.0978 / Avg. batch time: 1834.3355 (ms) / GPU bubble ratio: 60.76%
[rank1]:2025-10-23 23:27:31,359 - INFO - Avg. fwd time: 54.2032 / Avg. bwd time: 75.1797 / Avg. batch time: 1955.8886 (ms) / GPU bubble ratio: 47.08%
[rank0]:2025-10-23 23:27:31,423 - INFO - Avg. fwd time: 47.9733 / Avg. bwd time: 61.4691 / Avg. batch time: 2056.0615 (ms) / GPU bubble ratio: 57.42%
[rank3]:2025-10-23 23:30:19,489 - INFO - Avg. fwd time: 76.7628 / Avg. bwd time: 135.0327 / Avg. batch time: 1742.4723 (ms) / GPU bubble ratio: 2.76%
[rank2]:2025-10-23 23:30:19,552 - INFO - Avg. fwd time: 34.8716 / Avg. bwd time: 55.0964 / Avg. batch time: 1834.5664 (ms) / GPU bubble ratio: 60.77%
[rank1]:2025-10-23 23:30:19,626 - INFO - Avg. fwd time: 54.2013 / Avg. bwd time: 75.1863 / Avg. batch time: 1956.1083 (ms) / GPU bubble ratio: 47.08%
[rank0]:2025-10-23 23:30:19,690 - INFO - Avg. fwd time: 47.9805 / Avg. bwd time: 61.4799 / Avg. batch time: 2056.2523 (ms) / GPU bubble ratio: 57.41%
[rank0]:2025-10-23 23:32:49,268 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-23 23:33:06,134 - INFO -  step: 200  loss: -8.0000  grad_norm:  0.3450  memory: 20.89GiB(43.97%)  tps: 1,946  tflops: 15.21  mfu: 4.88%
[rank2]:2025-10-23 23:33:06,114 - INFO -  step: 200  loss: -8.0000  grad_norm:  0.3450  memory: 16.10GiB(33.90%)  tps: 1,946  tflops: 15.21  mfu: 4.88%
[rank1]:2025-10-23 23:33:06,126 - INFO -  step: 200  loss: -8.0000  grad_norm:  0.3450  memory: 20.03GiB(42.17%)  tps: 1,946  tflops: 15.21  mfu: 4.88%
[rank3]:2025-10-23 23:33:06,126 - INFO -  step: 200  loss:  1.8248  grad_norm:  0.3450  memory: 38.93GiB(81.95%)  tps: 1,946  tflops: 15.21  mfu: 4.88%
[rank3]:2025-10-23 23:33:06,380 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_nofreeze_dm1/pipeline_schedule/251023_2333_real_step200_rank3.svg
[rank3]:> Batch Time: 2002.62 ms, GPU Bubble Ratio: 56.36%, 47.89%, 64.39%, 15.03%
[rank3]:2025-10-23 23:33:08,174 - INFO - Avg. fwd time: 76.7670 / Avg. bwd time: 135.0731 / Avg. batch time: 1742.8438 (ms) / GPU bubble ratio: 2.76%
[rank2]:2025-10-23 23:33:08,233 - INFO - Avg. fwd time: 34.8733 / Avg. bwd time: 55.1031 / Avg. batch time: 1835.0072 (ms) / GPU bubble ratio: 60.77%
[rank1]:2025-10-23 23:33:08,307 - INFO - Avg. fwd time: 54.1992 / Avg. bwd time: 75.1799 / Avg. batch time: 1956.5475 (ms) / GPU bubble ratio: 47.10%
[rank0]:2025-10-23 23:33:08,373 - INFO - Avg. fwd time: 47.9820 / Avg. bwd time: 61.4881 / Avg. batch time: 2056.6730 (ms) / GPU bubble ratio: 57.42%
[rank3]:2025-10-23 23:35:56,072 - INFO - Avg. fwd time: 76.7682 / Avg. bwd time: 135.0810 / Avg. batch time: 1742.8792 (ms) / GPU bubble ratio: 2.76%
[rank2]:2025-10-23 23:35:56,130 - INFO - Avg. fwd time: 34.8752 / Avg. bwd time: 55.1029 / Avg. batch time: 1835.0453 (ms) / GPU bubble ratio: 60.77%
[rank1]:2025-10-23 23:35:56,203 - INFO - Avg. fwd time: 54.1676 / Avg. bwd time: 75.1919 / Avg. batch time: 1956.4779 (ms) / GPU bubble ratio: 47.11%
[rank0]:2025-10-23 23:35:56,270 - INFO - Avg. fwd time: 47.9804 / Avg. bwd time: 61.4732 / Avg. batch time: 2056.6115 (ms) / GPU bubble ratio: 57.42%
[rank1]:2025-10-23 23:38:42,200 - INFO -  step: 220  loss: -8.0000  grad_norm:  0.3444  memory: 20.03GiB(42.17%)  tps: 1,950  tflops: 15.24  mfu: 4.89%
[rank2]:2025-10-23 23:38:42,196 - INFO -  step: 220  loss: -8.0000  grad_norm:  0.3444  memory: 16.10GiB(33.90%)  tps: 1,950  tflops: 15.24  mfu: 4.89%
[rank3]:2025-10-23 23:38:42,208 - INFO -  step: 220  loss:  1.9109  grad_norm:  0.3444  memory: 38.93GiB(81.95%)  tps: 1,950  tflops: 15.24  mfu: 4.89%
[rank0]:2025-10-23 23:38:42,220 - INFO -  step: 220  loss: -8.0000  grad_norm:  0.3444  memory: 20.89GiB(43.97%)  tps: 1,950  tflops: 15.24  mfu: 4.89%
[rank3]:2025-10-23 23:38:44,097 - INFO - Avg. fwd time: 76.7774 / Avg. bwd time: 135.0771 / Avg. batch time: 1742.9010 (ms) / GPU bubble ratio: 2.76%
[rank2]:2025-10-23 23:38:44,160 - INFO - Avg. fwd time: 34.8712 / Avg. bwd time: 55.0975 / Avg. batch time: 1835.0721 (ms) / GPU bubble ratio: 60.78%
[rank1]:2025-10-23 23:38:44,243 - INFO - Avg. fwd time: 54.1689 / Avg. bwd time: 75.1869 / Avg. batch time: 1956.4640 (ms) / GPU bubble ratio: 47.11%
[rank0]:2025-10-23 23:38:44,306 - INFO - Avg. fwd time: 47.9763 / Avg. bwd time: 61.4651 / Avg. batch time: 2056.6157 (ms) / GPU bubble ratio: 57.43%
[rank2]:2025-10-23 23:41:32,040 - INFO - Avg. fwd time: 34.8654 / Avg. bwd time: 55.0958 / Avg. batch time: 1835.0373 (ms) / GPU bubble ratio: 60.78%
[rank3]:2025-10-23 23:41:31,980 - INFO - Avg. fwd time: 76.7795 / Avg. bwd time: 135.0717 / Avg. batch time: 1742.8756 (ms) / GPU bubble ratio: 2.76%
[rank1]:2025-10-23 23:41:32,124 - INFO - Avg. fwd time: 54.1992 / Avg. bwd time: 75.1951 / Avg. batch time: 1956.4164 (ms) / GPU bubble ratio: 47.09%
[rank0]:2025-10-23 23:41:32,188 - INFO - Avg. fwd time: 47.9740 / Avg. bwd time: 61.4418 / Avg. batch time: 2056.5567 (ms) / GPU bubble ratio: 57.44%
[rank2]:2025-10-23 23:44:18,053 - INFO -  step: 240  loss: -8.0000  grad_norm:  0.3310  memory: 16.10GiB(33.90%)  tps: 1,951  tflops: 15.25  mfu: 4.89%
[rank1]:2025-10-23 23:44:18,056 - INFO -  step: 240  loss: -8.0000  grad_norm:  0.3310  memory: 20.03GiB(42.17%)  tps: 1,951  tflops: 15.25  mfu: 4.89%
[rank0]:2025-10-23 23:44:18,071 - INFO -  step: 240  loss: -8.0000  grad_norm:  0.3310  memory: 20.89GiB(43.97%)  tps: 1,951  tflops: 15.25  mfu: 4.89%
[rank3]:2025-10-23 23:44:18,065 - INFO -  step: 240  loss:  1.8567  grad_norm:  0.3310  memory: 38.93GiB(81.95%)  tps: 1,951  tflops: 15.25  mfu: 4.89%
[rank3]:2025-10-23 23:44:19,976 - INFO - Avg. fwd time: 76.7755 / Avg. bwd time: 135.0634 / Avg. batch time: 1742.7975 (ms) / GPU bubble ratio: 2.76%
[rank2]:2025-10-23 23:44:20,036 - INFO - Avg. fwd time: 34.8593 / Avg. bwd time: 55.0979 / Avg. batch time: 1834.9678 (ms) / GPU bubble ratio: 60.78%
[rank1]:2025-10-23 23:44:20,109 - INFO - Avg. fwd time: 54.2174 / Avg. bwd time: 75.2138 / Avg. batch time: 1956.4262 (ms) / GPU bubble ratio: 47.07%
[rank0]:2025-10-23 23:44:20,179 - INFO - Avg. fwd time: 47.9601 / Avg. bwd time: 61.4385 / Avg. batch time: 2056.5338 (ms) / GPU bubble ratio: 57.44%
[rank0]:2025-10-23 23:46:49,223 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-23 23:47:07,922 - INFO - Avg. fwd time: 76.7875 / Avg. bwd time: 135.0513 / Avg. batch time: 1742.7804 (ms) / GPU bubble ratio: 2.76%
[rank2]:2025-10-23 23:47:07,983 - INFO - Avg. fwd time: 34.8582 / Avg. bwd time: 55.0901 / Avg. batch time: 1834.9463 (ms) / GPU bubble ratio: 60.78%
[rank1]:2025-10-23 23:47:08,057 - INFO - Avg. fwd time: 54.2356 / Avg. bwd time: 75.1934 / Avg. batch time: 1956.3780 (ms) / GPU bubble ratio: 47.07%
[rank0]:2025-10-23 23:47:08,125 - INFO - Avg. fwd time: 47.9337 / Avg. bwd time: 61.4238 / Avg. batch time: 2056.4966 (ms) / GPU bubble ratio: 57.46%
[rank1]:2025-10-23 23:49:53,987 - INFO -  step: 260  loss: -8.0000  grad_norm:  0.3304  memory: 20.03GiB(42.17%)  tps: 1,951  tflops: 15.25  mfu: 4.89%
[rank0]:2025-10-23 23:49:54,003 - INFO -  step: 260  loss: -8.0000  grad_norm:  0.3304  memory: 20.89GiB(43.97%)  tps: 1,951  tflops: 15.25  mfu: 4.89%
[rank2]:2025-10-23 23:49:53,983 - INFO -  step: 260  loss: -8.0000  grad_norm:  0.3304  memory: 16.10GiB(33.90%)  tps: 1,951  tflops: 15.25  mfu: 4.89%
[rank3]:2025-10-23 23:49:53,995 - INFO -  step: 260  loss:  1.7960  grad_norm:  0.3304  memory: 38.93GiB(81.95%)  tps: 1,951  tflops: 15.25  mfu: 4.89%
[rank3]:2025-10-23 23:49:55,878 - INFO - Avg. fwd time: 76.8072 / Avg. bwd time: 135.0328 / Avg. batch time: 1742.7487 (ms) / GPU bubble ratio: 2.76%
[rank2]:2025-10-23 23:49:55,937 - INFO - Avg. fwd time: 34.8549 / Avg. bwd time: 55.0736 / Avg. batch time: 1834.9030 (ms) / GPU bubble ratio: 60.79%
[rank1]:2025-10-23 23:49:56,010 - INFO - Avg. fwd time: 54.2490 / Avg. bwd time: 75.1725 / Avg. batch time: 1956.3239 (ms) / GPU bubble ratio: 47.08%
[rank0]:2025-10-23 23:49:56,078 - INFO - Avg. fwd time: 47.9052 / Avg. bwd time: 61.4096 / Avg. batch time: 2056.4666 (ms) / GPU bubble ratio: 57.47%
[rank3]:2025-10-23 23:52:43,688 - INFO - Avg. fwd time: 76.8147 / Avg. bwd time: 135.0148 / Avg. batch time: 1742.6339 (ms) / GPU bubble ratio: 2.75%
[rank2]:2025-10-23 23:52:43,748 - INFO - Avg. fwd time: 34.8500 / Avg. bwd time: 55.0566 / Avg. batch time: 1834.7779 (ms) / GPU bubble ratio: 60.80%
[rank1]:2025-10-23 23:52:43,821 - INFO - Avg. fwd time: 54.2693 / Avg. bwd time: 75.1590 / Avg. batch time: 1956.2119 (ms) / GPU bubble ratio: 47.07%
[rank0]:2025-10-23 23:52:43,889 - INFO - Avg. fwd time: 47.8793 / Avg. bwd time: 61.3944 / Avg. batch time: 2056.3962 (ms) / GPU bubble ratio: 57.49%
[rank2]:2025-10-23 23:55:29,603 - INFO -  step: 280  loss: -8.0000  grad_norm:  0.3509  memory: 16.10GiB(33.90%)  tps: 1,953  tflops: 15.27  mfu: 4.89%
[rank0]:2025-10-23 23:55:29,630 - INFO -  step: 280  loss: -8.0000  grad_norm:  0.3509  memory: 20.89GiB(43.97%)  tps: 1,953  tflops: 15.26  mfu: 4.89%
[rank3]:2025-10-23 23:55:29,616 - INFO -  step: 280  loss:  1.8554  grad_norm:  0.3509  memory: 38.93GiB(81.95%)  tps: 1,953  tflops: 15.27  mfu: 4.89%
[rank1]:2025-10-23 23:55:29,608 - INFO -  step: 280  loss: -8.0000  grad_norm:  0.3509  memory: 20.03GiB(42.17%)  tps: 1,953  tflops: 15.27  mfu: 4.89%
[rank3]:2025-10-23 23:55:31,525 - INFO - Avg. fwd time: 76.8206 / Avg. bwd time: 135.0100 / Avg. batch time: 1742.6091 (ms) / GPU bubble ratio: 2.75%
[rank2]:2025-10-23 23:55:31,588 - INFO - Avg. fwd time: 34.8486 / Avg. bwd time: 55.0415 / Avg. batch time: 1834.7418 (ms) / GPU bubble ratio: 60.81%
[rank1]:2025-10-23 23:55:31,666 - INFO - Avg. fwd time: 54.2605 / Avg. bwd time: 75.1543 / Avg. batch time: 1956.1107 (ms) / GPU bubble ratio: 47.07%
[rank0]:2025-10-23 23:55:31,736 - INFO - Avg. fwd time: 47.8641 / Avg. bwd time: 61.3730 / Avg. batch time: 2056.3177 (ms) / GPU bubble ratio: 57.50%
[rank3]:2025-10-23 23:58:19,583 - INFO - Avg. fwd time: 76.7992 / Avg. bwd time: 135.0221 / Avg. batch time: 1742.6077 (ms) / GPU bubble ratio: 2.76%
[rank2]:2025-10-23 23:58:19,643 - INFO - Avg. fwd time: 34.8505 / Avg. bwd time: 55.0477 / Avg. batch time: 1834.7629 (ms) / GPU bubble ratio: 60.80%
[rank1]:2025-10-23 23:58:19,716 - INFO - Avg. fwd time: 54.2855 / Avg. bwd time: 75.1634 / Avg. batch time: 1956.1889 (ms) / GPU bubble ratio: 47.06%
[rank0]:2025-10-23 23:58:19,785 - INFO - Avg. fwd time: 47.8678 / Avg. bwd time: 61.3779 / Avg. batch time: 2056.3589 (ms) / GPU bubble ratio: 57.50%
[rank0]:2025-10-24 00:00:48,822 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-24 00:01:05,638 - INFO -  step: 300  loss: -8.0000  grad_norm:  0.3268  memory: 16.10GiB(33.90%)  tps: 1,950  tflops: 15.25  mfu: 4.89%
[rank0]:2025-10-24 00:01:05,665 - INFO -  step: 300  loss: -8.0000  grad_norm:  0.3268  memory: 20.89GiB(43.97%)  tps: 1,950  tflops: 15.25  mfu: 4.89%
[rank1]:2025-10-24 00:01:05,642 - INFO -  step: 300  loss: -8.0000  grad_norm:  0.3268  memory: 20.03GiB(42.17%)  tps: 1,950  tflops: 15.25  mfu: 4.89%
[rank3]:2025-10-24 00:01:05,650 - INFO -  step: 300  loss:  1.8505  grad_norm:  0.3268  memory: 38.93GiB(81.95%)  tps: 1,950  tflops: 15.25  mfu: 4.89%
[rank3]:2025-10-24 00:01:05,910 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_nofreeze_dm1/pipeline_schedule/251024_0001_real_step300_rank3.svg
[rank3]:> Batch Time: 2002.50 ms, GPU Bubble Ratio: 56.49%, 47.72%, 64.46%, 15.06%
[rank3]:2025-10-24 00:01:07,682 - INFO - Avg. fwd time: 76.7652 / Avg. bwd time: 135.0435 / Avg. batch time: 1742.5794 (ms) / GPU bubble ratio: 2.76%
[rank2]:2025-10-24 00:01:07,741 - INFO - Avg. fwd time: 34.8554 / Avg. bwd time: 55.0628 / Avg. batch time: 1834.7747 (ms) / GPU bubble ratio: 60.79%
[rank0]:2025-10-24 00:01:07,889 - INFO - Avg. fwd time: 47.8791 / Avg. bwd time: 61.3869 / Avg. batch time: 2056.4108 (ms) / GPU bubble ratio: 57.49%
[rank1]:2025-10-24 00:01:07,824 - INFO - Avg. fwd time: 54.3217 / Avg. bwd time: 75.1810 / Avg. batch time: 1956.2444 (ms) / GPU bubble ratio: 47.04%
[rank3]:2025-10-24 00:03:55,619 - INFO - Avg. fwd time: 76.7704 / Avg. bwd time: 135.0465 / Avg. batch time: 1742.6199 (ms) / GPU bubble ratio: 2.76%
[rank2]:2025-10-24 00:03:55,680 - INFO - Avg. fwd time: 34.8571 / Avg. bwd time: 55.0687 / Avg. batch time: 1834.8195 (ms) / GPU bubble ratio: 60.79%
[rank0]:2025-10-24 00:03:55,822 - INFO - Avg. fwd time: 47.8757 / Avg. bwd time: 61.3774 / Avg. batch time: 2056.4175 (ms) / GPU bubble ratio: 57.50%
[rank1]:2025-10-24 00:03:55,754 - INFO - Avg. fwd time: 54.3073 / Avg. bwd time: 75.1768 / Avg. batch time: 1956.2470 (ms) / GPU bubble ratio: 47.05%
[rank3]:2025-10-24 00:06:41,685 - INFO -  step: 320  loss:  1.8732  grad_norm:  0.3595  memory: 38.93GiB(81.95%)  tps: 1,950  tflops: 15.25  mfu: 4.89%
[rank0]:2025-10-24 00:06:41,692 - INFO -  step: 320  loss: -8.0000  grad_norm:  0.3595  memory: 20.89GiB(43.97%)  tps: 1,950  tflops: 15.25  mfu: 4.89%
[rank2]:2025-10-24 00:06:41,673 - INFO -  step: 320  loss: -8.0000  grad_norm:  0.3595  memory: 16.10GiB(33.90%)  tps: 1,950  tflops: 15.25  mfu: 4.89%
[rank1]:2025-10-24 00:06:41,677 - INFO -  step: 320  loss: -8.0000  grad_norm:  0.3595  memory: 20.03GiB(42.17%)  tps: 1,950  tflops: 15.25  mfu: 4.89%
[rank3]:2025-10-24 00:06:43,589 - INFO - Avg. fwd time: 76.7804 / Avg. bwd time: 135.0489 / Avg. batch time: 1742.6817 (ms) / GPU bubble ratio: 2.76%
[rank2]:2025-10-24 00:06:43,649 - INFO - Avg. fwd time: 34.8550 / Avg. bwd time: 55.0592 / Avg. batch time: 1834.8625 (ms) / GPU bubble ratio: 60.80%
[rank1]:2025-10-24 00:06:43,736 - INFO - Avg. fwd time: 54.2910 / Avg. bwd time: 75.1744 / Avg. batch time: 1956.2371 (ms) / GPU bubble ratio: 47.06%
[rank0]:2025-10-24 00:06:43,805 - INFO - Avg. fwd time: 47.8785 / Avg. bwd time: 61.3651 / Avg. batch time: 2056.4201 (ms) / GPU bubble ratio: 57.50%
[rank3]:2025-10-24 00:09:31,657 - INFO - Avg. fwd time: 76.7741 / Avg. bwd time: 135.0559 / Avg. batch time: 1742.7085 (ms) / GPU bubble ratio: 2.76%
[rank2]:2025-10-24 00:09:31,719 - INFO - Avg. fwd time: 34.8512 / Avg. bwd time: 55.0598 / Avg. batch time: 1834.8896 (ms) / GPU bubble ratio: 60.80%
[rank1]:2025-10-24 00:09:31,792 - INFO - Avg. fwd time: 54.2917 / Avg. bwd time: 75.1827 / Avg. batch time: 1956.2789 (ms) / GPU bubble ratio: 47.05%
[rank0]:2025-10-24 00:09:31,862 - INFO - Avg. fwd time: 47.8741 / Avg. bwd time: 61.3622 / Avg. batch time: 2056.4447 (ms) / GPU bubble ratio: 57.50%
[rank0]:2025-10-24 00:12:17,746 - INFO -  step: 340  loss: -8.0000  grad_norm:  0.3643  memory: 20.89GiB(43.97%)  tps: 1,950  tflops: 15.25  mfu: 4.89%
[rank3]:2025-10-24 00:12:17,741 - INFO -  step: 340  loss:  1.8189  grad_norm:  0.3643  memory: 38.93GiB(81.95%)  tps: 1,950  tflops: 15.25  mfu: 4.89%
[rank2]:2025-10-24 00:12:17,729 - INFO -  step: 340  loss: -8.0000  grad_norm:  0.3643  memory: 16.10GiB(33.90%)  tps: 1,950  tflops: 15.25  mfu: 4.89%
[rank1]:2025-10-24 00:12:17,732 - INFO -  step: 340  loss: -8.0000  grad_norm:  0.3643  memory: 20.03GiB(42.17%)  tps: 1,950  tflops: 15.25  mfu: 4.89%
[rank3]:2025-10-24 00:12:19,642 - INFO - Avg. fwd time: 76.7770 / Avg. bwd time: 135.0603 / Avg. batch time: 1742.7473 (ms) / GPU bubble ratio: 2.76%
[rank2]:2025-10-24 00:12:19,706 - INFO - Avg. fwd time: 34.8498 / Avg. bwd time: 55.0589 / Avg. batch time: 1834.9340 (ms) / GPU bubble ratio: 60.80%
[rank1]:2025-10-24 00:12:19,787 - INFO - Avg. fwd time: 54.2841 / Avg. bwd time: 75.1876 / Avg. batch time: 1956.2564 (ms) / GPU bubble ratio: 47.05%
[rank0]:2025-10-24 00:12:19,857 - INFO - Avg. fwd time: 47.8724 / Avg. bwd time: 61.3441 / Avg. batch time: 2056.4346 (ms) / GPU bubble ratio: 57.51%
[rank0]:2025-10-24 00:14:48,873 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-24 00:15:07,560 - INFO - Avg. fwd time: 76.7770 / Avg. bwd time: 135.0647 / Avg. batch time: 1742.7658 (ms) / GPU bubble ratio: 2.76%
[rank2]:2025-10-24 00:15:07,621 - INFO - Avg. fwd time: 34.8482 / Avg. bwd time: 55.0569 / Avg. batch time: 1834.9436 (ms) / GPU bubble ratio: 60.80%
[rank1]:2025-10-24 00:15:07,703 - INFO - Avg. fwd time: 54.2662 / Avg. bwd time: 75.1896 / Avg. batch time: 1956.2309 (ms) / GPU bubble ratio: 47.06%
[rank0]:2025-10-24 00:15:07,770 - INFO - Avg. fwd time: 47.8707 / Avg. bwd time: 61.3312 / Avg. batch time: 2056.4091 (ms) / GPU bubble ratio: 57.52%
[rank1]:2025-10-24 00:17:53,536 - INFO -  step: 360  loss: -8.0000  grad_norm:  0.3588  memory: 20.03GiB(42.17%)  tps: 1,952  tflops: 15.26  mfu: 4.89%
[rank0]:2025-10-24 00:17:53,552 - INFO -  step: 360  loss: -8.0000  grad_norm:  0.3588  memory: 20.89GiB(43.97%)  tps: 1,952  tflops: 15.26  mfu: 4.89%
[rank2]:2025-10-24 00:17:53,532 - INFO -  step: 360  loss: -8.0000  grad_norm:  0.3588  memory: 16.10GiB(33.90%)  tps: 1,952  tflops: 15.26  mfu: 4.89%
[rank3]:2025-10-24 00:17:53,544 - INFO -  step: 360  loss:  1.8727  grad_norm:  0.3588  memory: 38.93GiB(81.95%)  tps: 1,952  tflops: 15.26  mfu: 4.89%
[rank3]:2025-10-24 00:17:55,443 - INFO - Avg. fwd time: 76.7786 / Avg. bwd time: 135.0604 / Avg. batch time: 1742.7230 (ms) / GPU bubble ratio: 2.75%
[rank2]:2025-10-24 00:17:55,503 - INFO - Avg. fwd time: 34.8461 / Avg. bwd time: 55.0560 / Avg. batch time: 1834.8937 (ms) / GPU bubble ratio: 60.80%
[rank1]:2025-10-24 00:17:55,586 - INFO - Avg. fwd time: 54.2694 / Avg. bwd time: 75.1870 / Avg. batch time: 1956.1634 (ms) / GPU bubble ratio: 47.06%
[rank0]:2025-10-24 00:17:55,651 - INFO - Avg. fwd time: 47.8590 / Avg. bwd time: 61.3268 / Avg. batch time: 2056.3481 (ms) / GPU bubble ratio: 57.52%
[rank3]:2025-10-24 00:20:43,166 - INFO - Avg. fwd time: 76.7810 / Avg. bwd time: 135.0544 / Avg. batch time: 1742.6720 (ms) / GPU bubble ratio: 2.75%
[rank2]:2025-10-24 00:20:43,230 - INFO - Avg. fwd time: 34.8424 / Avg. bwd time: 55.0510 / Avg. batch time: 1834.8430 (ms) / GPU bubble ratio: 60.81%
[rank1]:2025-10-24 00:20:43,303 - INFO - Avg. fwd time: 54.2615 / Avg. bwd time: 75.1830 / Avg. batch time: 1956.0812 (ms) / GPU bubble ratio: 47.06%
[rank0]:2025-10-24 00:20:43,374 - INFO - Avg. fwd time: 47.8462 / Avg. bwd time: 61.3173 / Avg. batch time: 2056.2511 (ms) / GPU bubble ratio: 57.53%
[rank1]:2025-10-24 00:23:29,473 - INFO -  step: 380  loss: -8.0000  grad_norm:  0.3577  memory: 20.03GiB(42.17%)  tps: 1,951  tflops: 15.25  mfu: 4.89%
[rank2]:2025-10-24 00:23:29,470 - INFO -  step: 380  loss: -8.0000  grad_norm:  0.3577  memory: 16.10GiB(33.90%)  tps: 1,951  tflops: 15.25  mfu: 4.89%
[rank0]:2025-10-24 00:23:29,489 - INFO -  step: 380  loss: -8.0000  grad_norm:  0.3577  memory: 20.89GiB(43.97%)  tps: 1,951  tflops: 15.25  mfu: 4.89%
[rank3]:2025-10-24 00:23:29,482 - INFO -  step: 380  loss:  1.8042  grad_norm:  0.3577  memory: 38.93GiB(81.95%)  tps: 1,951  tflops: 15.25  mfu: 4.89%
[rank2]:2025-10-24 00:23:31,461 - INFO - Avg. fwd time: 34.8408 / Avg. bwd time: 55.0517 / Avg. batch time: 1834.9131 (ms) / GPU bubble ratio: 60.81%
[rank3]:2025-10-24 00:23:31,399 - INFO - Avg. fwd time: 76.7668 / Avg. bwd time: 135.0685 / Avg. batch time: 1742.7220 (ms) / GPU bubble ratio: 2.76%
[rank1]:2025-10-24 00:23:31,535 - INFO - Avg. fwd time: 54.2902 / Avg. bwd time: 75.1735 / Avg. batch time: 1956.1937 (ms) / GPU bubble ratio: 47.05%
[rank0]:2025-10-24 00:23:31,604 - INFO - Avg. fwd time: 47.8468 / Avg. bwd time: 61.3314 / Avg. batch time: 2056.3337 (ms) / GPU bubble ratio: 57.53%
[rank3]:2025-10-24 00:26:19,341 - INFO - Avg. fwd time: 76.7495 / Avg. bwd time: 135.0811 / Avg. batch time: 1742.7187 (ms) / GPU bubble ratio: 2.76%
[rank2]:2025-10-24 00:26:19,404 - INFO - Avg. fwd time: 34.8394 / Avg. bwd time: 55.0592 / Avg. batch time: 1834.9105 (ms) / GPU bubble ratio: 60.81%
[rank1]:2025-10-24 00:26:19,479 - INFO - Avg. fwd time: 54.3071 / Avg. bwd time: 75.1760 / Avg. batch time: 1956.1849 (ms) / GPU bubble ratio: 47.05%
[rank0]:2025-10-24 00:26:19,550 - INFO - Avg. fwd time: 47.8499 / Avg. bwd time: 61.3257 / Avg. batch time: 2056.3183 (ms) / GPU bubble ratio: 57.53%
[rank0]:2025-10-24 00:28:48,605 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-24 00:29:05,472 - INFO -  step: 400  loss: -8.0000  grad_norm:  0.3449  memory: 20.03GiB(42.17%)  tps: 1,950  tflops: 15.25  mfu: 4.89%
[rank2]:2025-10-24 00:29:05,467 - INFO -  step: 400  loss: -8.0000  grad_norm:  0.3449  memory: 16.10GiB(33.90%)  tps: 1,950  tflops: 15.25  mfu: 4.89%
[rank0]:2025-10-24 00:29:05,486 - INFO -  step: 400  loss: -8.0000  grad_norm:  0.3449  memory: 20.89GiB(43.97%)  tps: 1,950  tflops: 15.25  mfu: 4.89%
[rank3]:2025-10-24 00:29:05,480 - INFO -  step: 400  loss:  1.7861  grad_norm:  0.3449  memory: 38.93GiB(81.95%)  tps: 1,951  tflops: 15.25  mfu: 4.89%
[rank3]:2025-10-24 00:29:05,733 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_nofreeze_dm1/pipeline_schedule/251024_0029_real_step400_rank3.svg
[rank3]:> Batch Time: 2001.50 ms, GPU Bubble Ratio: 56.55%, 47.73%, 64.44%, 15.03%
[rank2]:2025-10-24 00:29:07,598 - INFO - Avg. fwd time: 34.8405 / Avg. bwd time: 55.0752 / Avg. batch time: 1834.9552 (ms) / GPU bubble ratio: 60.80%
[rank3]:2025-10-24 00:29:07,534 - INFO - Avg. fwd time: 76.7296 / Avg. bwd time: 135.0965 / Avg. batch time: 1742.7051 (ms) / GPU bubble ratio: 2.76%
[rank1]:2025-10-24 00:29:07,680 - INFO - Avg. fwd time: 54.3226 / Avg. bwd time: 75.1756 / Avg. batch time: 1956.2454 (ms) / GPU bubble ratio: 47.04%
[rank0]:2025-10-24 00:29:07,761 - INFO - Avg. fwd time: 47.8503 / Avg. bwd time: 61.3259 / Avg. batch time: 2056.3723 (ms) / GPU bubble ratio: 57.53%
[rank3]:2025-10-24 00:31:55,659 - INFO - Avg. fwd time: 76.7164 / Avg. bwd time: 135.1100 / Avg. batch time: 1742.7301 (ms) / GPU bubble ratio: 2.76%
[rank2]:2025-10-24 00:31:55,720 - INFO - Avg. fwd time: 34.8395 / Avg. bwd time: 55.0805 / Avg. batch time: 1834.9829 (ms) / GPU bubble ratio: 60.80%
[rank1]:2025-10-24 00:31:55,818 - INFO - Avg. fwd time: 54.3386 / Avg. bwd time: 75.1799 / Avg. batch time: 1956.2971 (ms) / GPU bubble ratio: 47.04%
[rank0]:2025-10-24 00:31:55,883 - INFO - Avg. fwd time: 47.8545 / Avg. bwd time: 61.3247 / Avg. batch time: 2056.4157 (ms) / GPU bubble ratio: 57.53%
[rank1]:2025-10-24 00:34:41,735 - INFO -  step: 420  loss: -8.0000  grad_norm:  0.3417  memory: 20.03GiB(42.17%)  tps: 1,949  tflops: 15.24  mfu: 4.88%
[rank3]:2025-10-24 00:34:41,744 - INFO -  step: 420  loss:  1.7309  grad_norm:  0.3417  memory: 38.93GiB(81.95%)  tps: 1,949  tflops: 15.24  mfu: 4.88%
[rank2]:2025-10-24 00:34:41,732 - INFO -  step: 420  loss: -8.0000  grad_norm:  0.3417  memory: 16.10GiB(33.90%)  tps: 1,949  tflops: 15.24  mfu: 4.88%
[rank0]:2025-10-24 00:34:41,754 - INFO -  step: 420  loss: -8.0000  grad_norm:  0.3417  memory: 20.89GiB(43.97%)  tps: 1,949  tflops: 15.24  mfu: 4.88%
[rank3]:2025-10-24 00:34:43,632 - INFO - Avg. fwd time: 76.7117 / Avg. bwd time: 135.1147 / Avg. batch time: 1742.7257 (ms) / GPU bubble ratio: 2.76%
[rank2]:2025-10-24 00:34:43,693 - INFO - Avg. fwd time: 34.8386 / Avg. bwd time: 55.0792 / Avg. batch time: 1834.9871 (ms) / GPU bubble ratio: 60.80%
[rank1]:2025-10-24 00:34:43,767 - INFO - Avg. fwd time: 54.3410 / Avg. bwd time: 75.1847 / Avg. batch time: 1956.2702 (ms) / GPU bubble ratio: 47.03%
[rank0]:2025-10-24 00:34:43,833 - INFO - Avg. fwd time: 47.8531 / Avg. bwd time: 61.3155 / Avg. batch time: 2056.3915 (ms) / GPU bubble ratio: 57.53%
[rank3]:2025-10-24 00:37:31,662 - INFO - Avg. fwd time: 76.6920 / Avg. bwd time: 135.1287 / Avg. batch time: 1742.7365 (ms) / GPU bubble ratio: 2.76%
[rank2]:2025-10-24 00:37:31,725 - INFO - Avg. fwd time: 34.8364 / Avg. bwd time: 55.0874 / Avg. batch time: 1835.0005 (ms) / GPU bubble ratio: 60.80%
[rank1]:2025-10-24 00:37:31,809 - INFO - Avg. fwd time: 54.3660 / Avg. bwd time: 75.1890 / Avg. batch time: 1956.3312 (ms) / GPU bubble ratio: 47.02%
[rank0]:2025-10-24 00:37:31,881 - INFO - Avg. fwd time: 47.8534 / Avg. bwd time: 61.3160 / Avg. batch time: 2056.4155 (ms) / GPU bubble ratio: 57.53%
[rank2]:2025-10-24 00:40:18,052 - INFO -  step: 440  loss: -8.0000  grad_norm:  0.3430  memory: 16.10GiB(33.90%)  tps: 1,949  tflops: 15.23  mfu: 4.88%
[rank1]:2025-10-24 00:40:18,055 - INFO -  step: 440  loss: -8.0000  grad_norm:  0.3430  memory: 20.03GiB(42.17%)  tps: 1,949  tflops: 15.23  mfu: 4.88%
[rank3]:2025-10-24 00:40:18,064 - INFO -  step: 440  loss:  1.6961  grad_norm:  0.3430  memory: 38.93GiB(81.95%)  tps: 1,949  tflops: 15.23  mfu: 4.88%
[rank0]:2025-10-24 00:40:18,070 - INFO -  step: 440  loss: -8.0000  grad_norm:  0.3430  memory: 20.89GiB(43.97%)  tps: 1,949  tflops: 15.23  mfu: 4.88%
[rank3]:2025-10-24 00:40:19,984 - INFO - Avg. fwd time: 76.6847 / Avg. bwd time: 135.1415 / Avg. batch time: 1742.8104 (ms) / GPU bubble ratio: 2.77%
[rank2]:2025-10-24 00:40:20,050 - INFO - Avg. fwd time: 34.8354 / Avg. bwd time: 55.0910 / Avg. batch time: 1835.0728 (ms) / GPU bubble ratio: 60.80%
[rank1]:2025-10-24 00:40:20,125 - INFO - Avg. fwd time: 54.3838 / Avg. bwd time: 75.1852 / Avg. batch time: 1956.4503 (ms) / GPU bubble ratio: 47.02%
[rank0]:2025-10-24 00:40:20,194 - INFO - Avg. fwd time: 47.8567 / Avg. bwd time: 61.3281 / Avg. batch time: 2056.5104 (ms) / GPU bubble ratio: 57.53%
[rank0]:2025-10-24 00:42:49,333 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-24 00:43:08,055 - INFO - Avg. fwd time: 76.6819 / Avg. bwd time: 135.1480 / Avg. batch time: 1742.8390 (ms) / GPU bubble ratio: 2.77%
[rank2]:2025-10-24 00:43:08,123 - INFO - Avg. fwd time: 34.8346 / Avg. bwd time: 55.0912 / Avg. batch time: 1835.0978 (ms) / GPU bubble ratio: 60.80%
[rank1]:2025-10-24 00:43:08,201 - INFO - Avg. fwd time: 54.3887 / Avg. bwd time: 75.1901 / Avg. batch time: 1956.5028 (ms) / GPU bubble ratio: 47.02%
[rank0]:2025-10-24 00:43:08,272 - INFO - Avg. fwd time: 47.8606 / Avg. bwd time: 61.3243 / Avg. batch time: 2056.5423 (ms) / GPU bubble ratio: 57.53%
[rank3]:2025-10-24 00:45:54,684 - INFO -  step: 460  loss:  1.7365  grad_norm:  0.3193  memory: 38.93GiB(81.95%)  tps: 1,947  tflops: 15.22  mfu: 4.88%
[rank2]:2025-10-24 00:45:54,672 - INFO -  step: 460  loss: -8.0000  grad_norm:  0.3193  memory: 16.10GiB(33.90%)  tps: 1,947  tflops: 15.22  mfu: 4.88%
[rank1]:2025-10-24 00:45:54,683 - INFO -  step: 460  loss: -8.0000  grad_norm:  0.3193  memory: 20.03GiB(42.17%)  tps: 1,947  tflops: 15.22  mfu: 4.88%
[rank0]:2025-10-24 00:45:54,696 - INFO -  step: 460  loss: -8.0000  grad_norm:  0.3193  memory: 20.89GiB(43.97%)  tps: 1,947  tflops: 15.22  mfu: 4.88%
[rank3]:2025-10-24 00:45:56,602 - INFO - Avg. fwd time: 76.6791 / Avg. bwd time: 135.1622 / Avg. batch time: 1742.9759 (ms) / GPU bubble ratio: 2.77%
[rank2]:2025-10-24 00:45:56,663 - INFO - Avg. fwd time: 34.8330 / Avg. bwd time: 55.0982 / Avg. batch time: 1835.2408 (ms) / GPU bubble ratio: 60.80%
[rank1]:2025-10-24 00:45:56,747 - INFO - Avg. fwd time: 54.4099 / Avg. bwd time: 75.1883 / Avg. batch time: 1956.6669 (ms) / GPU bubble ratio: 47.01%
[rank0]:2025-10-24 00:45:56,815 - INFO - Avg. fwd time: 47.8603 / Avg. bwd time: 61.3320 / Avg. batch time: 2056.6854 (ms) / GPU bubble ratio: 57.53%
[rank3]:2025-10-24 00:48:44,780 - INFO - Avg. fwd time: 76.6616 / Avg. bwd time: 135.1710 / Avg. batch time: 1742.9738 (ms) / GPU bubble ratio: 2.77%
[rank2]:2025-10-24 00:48:44,845 - INFO - Avg. fwd time: 34.8326 / Avg. bwd time: 55.1031 / Avg. batch time: 1835.2390 (ms) / GPU bubble ratio: 60.80%
[rank1]:2025-10-24 00:48:44,928 - INFO - Avg. fwd time: 54.4457 / Avg. bwd time: 75.1949 / Avg. batch time: 1956.7475 (ms) / GPU bubble ratio: 47.00%
[rank0]:2025-10-24 00:48:44,996 - INFO - Avg. fwd time: 47.8596 / Avg. bwd time: 61.3371 / Avg. batch time: 2056.7375 (ms) / GPU bubble ratio: 57.53%
[rank3]:2025-10-24 00:51:31,199 - INFO -  step: 480  loss:  1.7654  grad_norm:  0.3384  memory: 38.93GiB(81.95%)  tps: 1,948  tflops: 15.22  mfu: 4.88%
[rank2]:2025-10-24 00:51:31,186 - INFO -  step: 480  loss: -8.0000  grad_norm:  0.3384  memory: 16.10GiB(33.90%)  tps: 1,947  tflops: 15.22  mfu: 4.88%
[rank1]:2025-10-24 00:51:31,190 - INFO -  step: 480  loss: -8.0000  grad_norm:  0.3384  memory: 20.03GiB(42.17%)  tps: 1,948  tflops: 15.22  mfu: 4.88%
[rank0]:2025-10-24 00:51:31,205 - INFO -  step: 480  loss: -8.0000  grad_norm:  0.3384  memory: 20.89GiB(43.97%)  tps: 1,948  tflops: 15.22  mfu: 4.88%
[rank2]:2025-10-24 00:51:33,190 - INFO - Avg. fwd time: 34.8308 / Avg. bwd time: 55.1094 / Avg. batch time: 1835.3221 (ms) / GPU bubble ratio: 60.80%
[rank3]:2025-10-24 00:51:33,129 - INFO - Avg. fwd time: 76.6560 / Avg. bwd time: 135.1830 / Avg. batch time: 1743.0473 (ms) / GPU bubble ratio: 2.77%
[rank1]:2025-10-24 00:51:33,278 - INFO - Avg. fwd time: 54.4684 / Avg. bwd time: 75.2024 / Avg. batch time: 1956.8599 (ms) / GPU bubble ratio: 46.99%
[rank0]:2025-10-24 00:51:33,351 - INFO - Avg. fwd time: 47.8576 / Avg. bwd time: 61.3453 / Avg. batch time: 2056.8219 (ms) / GPU bubble ratio: 57.53%
[rank3]:2025-10-24 00:54:21,797 - INFO - Avg. fwd time: 76.6511 / Avg. bwd time: 135.1977 / Avg. batch time: 1743.1620 (ms) / GPU bubble ratio: 2.77%
[rank2]:2025-10-24 00:54:21,862 - INFO - Avg. fwd time: 34.8330 / Avg. bwd time: 55.1193 / Avg. batch time: 1835.4579 (ms) / GPU bubble ratio: 60.79%
[rank1]:2025-10-24 00:54:21,947 - INFO - Avg. fwd time: 54.4850 / Avg. bwd time: 75.1906 / Avg. batch time: 1957.0406 (ms) / GPU bubble ratio: 46.99%
[rank0]:2025-10-24 00:54:22,018 - INFO - Avg. fwd time: 47.8661 / Avg. bwd time: 61.3557 / Avg. batch time: 2056.9837 (ms) / GPU bubble ratio: 57.52%
[rank0]:2025-10-24 00:56:51,313 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-24 00:57:08,152 - INFO -  step: 500  loss:  1.7785  grad_norm:  0.3471  memory: 38.93GiB(81.95%)  tps: 1,945  tflops: 15.21  mfu: 4.87%
[rank3]:2025-10-24 00:57:08,153 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-24 00:57:08,141 - INFO -  step: 500  loss: -8.0000  grad_norm:  0.3471  memory: 20.03GiB(42.17%)  tps: 1,945  tflops: 15.20  mfu: 4.87%
[rank1]:2025-10-24 00:57:08,141 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-24 00:57:08,137 - INFO -  step: 500  loss: -8.0000  grad_norm:  0.3471  memory: 16.10GiB(33.90%)  tps: 1,945  tflops: 15.20  mfu: 4.87%
[rank2]:2025-10-24 00:57:08,137 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-24 00:57:08,156 - INFO -  step: 500  loss: -8.0000  grad_norm:  0.3471  memory: 20.89GiB(43.97%)  tps: 1,945  tflops: 15.20  mfu: 4.87%
[rank0]:2025-10-24 00:57:08,157 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-24 00:57:08,157 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank2]:2025-10-24 00:57:09,995 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 1.86 seconds.
[rank1]:2025-10-24 00:57:10,695 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 2.55 seconds.
[rank0]:2025-10-24 00:57:11,886 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-24 00:57:11,896 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.74 seconds.
[rank3]:2025-10-24 00:57:12,104 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.95 seconds.
[rank3]:2025-10-24 00:57:12,523 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_nofreeze_dm1/pipeline_schedule/251024_0057_real_step500_rank3.svg
[rank3]:> Batch Time: 2004.31 ms, GPU Bubble Ratio: 56.60%, 47.64%, 64.47%, 15.13%
[rank3]:2025-10-24 00:57:14,582 - INFO - Avg. fwd time: 76.6520 / Avg. bwd time: 135.2025 / Avg. batch time: 1743.2883 (ms) / GPU bubble ratio: 2.78%
[rank2]:2025-10-24 00:57:14,653 - INFO - Avg. fwd time: 34.8316 / Avg. bwd time: 55.1155 / Avg. batch time: 1835.6371 (ms) / GPU bubble ratio: 60.80%
[rank1]:2025-10-24 00:57:14,729 - INFO - Avg. fwd time: 54.4850 / Avg. bwd time: 75.1781 / Avg. batch time: 1957.2238 (ms) / GPU bubble ratio: 47.00%
[rank0]:2025-10-24 00:57:14,801 - INFO - Avg. fwd time: 47.8670 / Avg. bwd time: 61.3624 / Avg. batch time: 2057.1653 (ms) / GPU bubble ratio: 57.52%
[rank3]:2025-10-24 01:00:02,872 - INFO - Avg. fwd time: 76.6411 / Avg. bwd time: 135.2104 / Avg. batch time: 1743.3212 (ms) / GPU bubble ratio: 2.78%
[rank2]:2025-10-24 01:00:02,938 - INFO - Avg. fwd time: 34.8338 / Avg. bwd time: 55.1195 / Avg. batch time: 1835.6538 (ms) / GPU bubble ratio: 60.80%
[rank0]:2025-10-24 01:00:03,093 - INFO - Avg. fwd time: 47.8676 / Avg. bwd time: 61.3705 / Avg. batch time: 2057.2034 (ms) / GPU bubble ratio: 57.52%
[rank1]:2025-10-24 01:00:03,022 - INFO - Avg. fwd time: 54.5029 / Avg. bwd time: 75.1631 / Avg. batch time: 1957.2760 (ms) / GPU bubble ratio: 47.00%
[rank1]:2025-10-24 01:02:49,625 - INFO -  step: 520  loss: -8.0000  grad_norm:  0.3580  memory: 20.03GiB(42.17%)  tps: 1,919  tflops: 15.00  mfu: 4.81%
[rank3]:2025-10-24 01:02:49,634 - INFO -  step: 520  loss:  1.8864  grad_norm:  0.3580  memory: 38.93GiB(81.95%)  tps: 1,919  tflops: 15.00  mfu: 4.81%
[rank2]:2025-10-24 01:02:49,621 - INFO -  step: 520  loss: -8.0000  grad_norm:  0.3580  memory: 16.10GiB(33.90%)  tps: 1,919  tflops: 15.00  mfu: 4.81%
[rank0]:2025-10-24 01:02:49,642 - INFO -  step: 520  loss: -8.0000  grad_norm:  0.3580  memory: 20.89GiB(43.97%)  tps: 1,919  tflops: 15.00  mfu: 4.81%
[rank3]:2025-10-24 01:02:51,539 - INFO - Avg. fwd time: 76.6478 / Avg. bwd time: 135.2146 / Avg. batch time: 1743.4251 (ms) / GPU bubble ratio: 2.78%
[rank2]:2025-10-24 01:02:51,605 - INFO - Avg. fwd time: 34.8313 / Avg. bwd time: 55.1189 / Avg. batch time: 1835.7450 (ms) / GPU bubble ratio: 60.80%
[rank1]:2025-10-24 01:02:51,690 - INFO - Avg. fwd time: 54.5038 / Avg. bwd time: 75.1590 / Avg. batch time: 1957.4171 (ms) / GPU bubble ratio: 47.01%
[rank0]:2025-10-24 01:02:51,760 - INFO - Avg. fwd time: 47.8699 / Avg. bwd time: 61.3785 / Avg. batch time: 2057.3342 (ms) / GPU bubble ratio: 57.52%
[rank3]:2025-10-24 01:05:39,595 - INFO - Avg. fwd time: 76.6375 / Avg. bwd time: 135.2178 / Avg. batch time: 1743.4022 (ms) / GPU bubble ratio: 2.79%
[rank2]:2025-10-24 01:05:39,664 - INFO - Avg. fwd time: 34.8321 / Avg. bwd time: 55.1224 / Avg. batch time: 1835.7174 (ms) / GPU bubble ratio: 60.80%
[rank1]:2025-10-24 01:05:39,747 - INFO - Avg. fwd time: 54.5133 / Avg. bwd time: 75.1487 / Avg. batch time: 1957.4072 (ms) / GPU bubble ratio: 47.01%
[rank0]:2025-10-24 01:05:39,821 - INFO - Avg. fwd time: 47.8690 / Avg. bwd time: 61.3894 / Avg. batch time: 2057.3111 (ms) / GPU bubble ratio: 57.51%
[rank2]:2025-10-24 01:08:26,327 - INFO -  step: 540  loss: -8.0000  grad_norm:  0.3188  memory: 16.10GiB(33.90%)  tps: 1,946  tflops: 15.22  mfu: 4.88%
[rank1]:2025-10-24 01:08:26,331 - INFO -  step: 540  loss: -8.0000  grad_norm:  0.3188  memory: 20.03GiB(42.17%)  tps: 1,946  tflops: 15.22  mfu: 4.88%
[rank0]:2025-10-24 01:08:26,347 - INFO -  step: 540  loss: -8.0000  grad_norm:  0.3188  memory: 20.89GiB(43.97%)  tps: 1,946  tflops: 15.22  mfu: 4.88%
[rank3]:2025-10-24 01:08:26,340 - INFO -  step: 540  loss:  1.7054  grad_norm:  0.3188  memory: 38.93GiB(81.95%)  tps: 1,946  tflops: 15.22  mfu: 4.88%
[rank3]:2025-10-24 01:08:28,238 - INFO - Avg. fwd time: 76.6338 / Avg. bwd time: 135.2272 / Avg. batch time: 1743.4771 (ms) / GPU bubble ratio: 2.79%
[rank2]:2025-10-24 01:08:28,304 - INFO - Avg. fwd time: 34.8329 / Avg. bwd time: 55.1300 / Avg. batch time: 1835.8093 (ms) / GPU bubble ratio: 60.80%
[rank1]:2025-10-24 01:08:28,383 - INFO - Avg. fwd time: 54.5253 / Avg. bwd time: 75.1369 / Avg. batch time: 1957.5228 (ms) / GPU bubble ratio: 47.01%
[rank0]:2025-10-24 01:08:28,450 - INFO - Avg. fwd time: 47.8658 / Avg. bwd time: 61.3961 / Avg. batch time: 2057.4153 (ms) / GPU bubble ratio: 57.51%
[rank0]:2025-10-24 01:10:57,859 - INFO - [GC] Peforming periodical GC collection 0.23 seconds
[rank3]:2025-10-24 01:11:16,466 - INFO - Avg. fwd time: 76.6163 / Avg. bwd time: 135.2305 / Avg. batch time: 1743.4273 (ms) / GPU bubble ratio: 2.79%
[rank2]:2025-10-24 01:11:16,532 - INFO - Avg. fwd time: 34.8337 / Avg. bwd time: 55.1330 / Avg. batch time: 1835.7473 (ms) / GPU bubble ratio: 60.79%
[rank1]:2025-10-24 01:11:16,611 - INFO - Avg. fwd time: 54.5530 / Avg. bwd time: 75.1293 / Avg. batch time: 1957.5057 (ms) / GPU bubble ratio: 47.00%
[rank0]:2025-10-24 01:11:16,679 - INFO - Avg. fwd time: 47.8680 / Avg. bwd time: 61.4023 / Avg. batch time: 2057.3762 (ms) / GPU bubble ratio: 57.51%
[rank2]:2025-10-24 01:14:03,002 - INFO -  step: 560  loss: -8.0000  grad_norm:  0.3364  memory: 16.10GiB(33.90%)  tps: 1,947  tflops: 15.22  mfu: 4.88%
[rank1]:2025-10-24 01:14:03,006 - INFO -  step: 560  loss: -8.0000  grad_norm:  0.3364  memory: 20.03GiB(42.17%)  tps: 1,947  tflops: 15.22  mfu: 4.88%
[rank3]:2025-10-24 01:14:03,015 - INFO -  step: 560  loss:  1.8128  grad_norm:  0.3364  memory: 38.93GiB(81.95%)  tps: 1,947  tflops: 15.22  mfu: 4.88%
[rank0]:2025-10-24 01:14:03,028 - INFO -  step: 560  loss: -8.0000  grad_norm:  0.3364  memory: 20.89GiB(43.97%)  tps: 1,947  tflops: 15.22  mfu: 4.88%
[rank3]:2025-10-24 01:14:04,912 - INFO - Avg. fwd time: 76.6136 / Avg. bwd time: 135.2379 / Avg. batch time: 1743.4956 (ms) / GPU bubble ratio: 2.79%
[rank2]:2025-10-24 01:14:04,978 - INFO - Avg. fwd time: 34.8328 / Avg. bwd time: 55.1365 / Avg. batch time: 1835.8151 (ms) / GPU bubble ratio: 60.79%
[rank1]:2025-10-24 01:14:05,063 - INFO - Avg. fwd time: 54.5657 / Avg. bwd time: 75.1201 / Avg. batch time: 1957.5825 (ms) / GPU bubble ratio: 47.00%
[rank0]:2025-10-24 01:14:05,135 - INFO - Avg. fwd time: 47.8717 / Avg. bwd time: 61.4114 / Avg. batch time: 2057.4492 (ms) / GPU bubble ratio: 57.51%
[rank3]:2025-10-24 01:16:52,908 - INFO - Avg. fwd time: 76.5941 / Avg. bwd time: 135.2429 / Avg. batch time: 1743.4587 (ms) / GPU bubble ratio: 2.80%
[rank2]:2025-10-24 01:16:52,971 - INFO - Avg. fwd time: 34.8359 / Avg. bwd time: 55.1432 / Avg. batch time: 1835.7669 (ms) / GPU bubble ratio: 60.79%
[rank1]:2025-10-24 01:16:53,058 - INFO - Avg. fwd time: 54.5925 / Avg. bwd time: 75.1139 / Avg. batch time: 1957.5855 (ms) / GPU bubble ratio: 46.99%
[rank0]:2025-10-24 01:16:53,125 - INFO - Avg. fwd time: 47.8715 / Avg. bwd time: 61.4200 / Avg. batch time: 2057.4243 (ms) / GPU bubble ratio: 57.50%
[rank2]:2025-10-24 01:19:39,088 - INFO -  step: 580  loss: -8.0000  grad_norm:  0.3486  memory: 16.10GiB(33.90%)  tps: 1,950  tflops: 15.24  mfu: 4.89%
[rank1]:2025-10-24 01:19:39,092 - INFO -  step: 580  loss: -8.0000  grad_norm:  0.3486  memory: 20.03GiB(42.17%)  tps: 1,950  tflops: 15.24  mfu: 4.89%
[rank3]:2025-10-24 01:19:39,100 - INFO -  step: 580  loss:  1.7667  grad_norm:  0.3486  memory: 38.93GiB(81.95%)  tps: 1,950  tflops: 15.24  mfu: 4.89%
[rank0]:2025-10-24 01:19:39,108 - INFO -  step: 580  loss: -8.0000  grad_norm:  0.3486  memory: 20.89GiB(43.97%)  tps: 1,950  tflops: 15.24  mfu: 4.89%
[rank3]:2025-10-24 01:19:41,007 - INFO - Avg. fwd time: 76.5855 / Avg. bwd time: 135.2464 / Avg. batch time: 1743.4587 (ms) / GPU bubble ratio: 2.80%
[rank2]:2025-10-24 01:19:41,074 - INFO - Avg. fwd time: 34.8362 / Avg. bwd time: 55.1453 / Avg. batch time: 1835.7581 (ms) / GPU bubble ratio: 60.79%
[rank1]:2025-10-24 01:19:41,151 - INFO - Avg. fwd time: 54.6029 / Avg. bwd time: 75.1124 / Avg. batch time: 1957.5895 (ms) / GPU bubble ratio: 46.99%
[rank0]:2025-10-24 01:19:41,219 - INFO - Avg. fwd time: 47.8727 / Avg. bwd time: 61.4269 / Avg. batch time: 2057.4093 (ms) / GPU bubble ratio: 57.50%
[rank3]:2025-10-24 01:22:29,377 - INFO - Avg. fwd time: 76.5786 / Avg. bwd time: 135.2546 / Avg. batch time: 1743.5133 (ms) / GPU bubble ratio: 2.80%
[rank2]:2025-10-24 01:22:29,439 - INFO - Avg. fwd time: 34.8365 / Avg. bwd time: 55.1520 / Avg. batch time: 1835.8036 (ms) / GPU bubble ratio: 60.79%
[rank1]:2025-10-24 01:22:29,519 - INFO - Avg. fwd time: 54.6238 / Avg. bwd time: 75.1006 / Avg. batch time: 1957.6537 (ms) / GPU bubble ratio: 46.99%
[rank0]:2025-10-24 01:22:29,586 - INFO - Avg. fwd time: 47.8719 / Avg. bwd time: 61.4348 / Avg. batch time: 2057.4609 (ms) / GPU bubble ratio: 57.50%
[rank0]:2025-10-24 01:24:58,912 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-24 01:25:15,726 - INFO -  step: 600  loss: -8.0000  grad_norm:  0.3310  memory: 16.10GiB(33.90%)  tps: 1,947  tflops: 15.22  mfu: 4.88%
[rank1]:2025-10-24 01:25:15,730 - INFO -  step: 600  loss: -8.0000  grad_norm:  0.3310  memory: 20.03GiB(42.17%)  tps: 1,947  tflops: 15.22  mfu: 4.88%
[rank0]:2025-10-24 01:25:15,742 - INFO -  step: 600  loss: -8.0000  grad_norm:  0.3310  memory: 20.89GiB(43.97%)  tps: 1,947  tflops: 15.22  mfu: 4.88%
[rank3]:2025-10-24 01:25:15,739 - INFO -  step: 600  loss:  1.7353  grad_norm:  0.3310  memory: 38.93GiB(81.95%)  tps: 1,947  tflops: 15.22  mfu: 4.88%
[rank3]:2025-10-24 01:25:15,994 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_nofreeze_dm1/pipeline_schedule/251024_0125_real_step600_rank3.svg
[rank3]:> Batch Time: 2005.16 ms, GPU Bubble Ratio: 56.58%, 47.65%, 64.45%, 15.16%
[rank3]:2025-10-24 01:25:17,798 - INFO - Avg. fwd time: 76.5777 / Avg. bwd time: 135.2576 / Avg. batch time: 1743.5485 (ms) / GPU bubble ratio: 2.80%
[rank2]:2025-10-24 01:25:17,861 - INFO - Avg. fwd time: 34.8364 / Avg. bwd time: 55.1495 / Avg. batch time: 1835.8546 (ms) / GPU bubble ratio: 60.79%
[rank1]:2025-10-24 01:25:17,949 - INFO - Avg. fwd time: 54.6326 / Avg. bwd time: 75.0909 / Avg. batch time: 1957.7216 (ms) / GPU bubble ratio: 46.99%
[rank0]:2025-10-24 01:25:18,020 - INFO - Avg. fwd time: 47.8681 / Avg. bwd time: 61.4387 / Avg. batch time: 2057.5184 (ms) / GPU bubble ratio: 57.50%
[rank3]:2025-10-24 01:28:06,423 - INFO - Avg. fwd time: 76.5789 / Avg. bwd time: 135.2656 / Avg. batch time: 1743.6471 (ms) / GPU bubble ratio: 2.80%
[rank2]:2025-10-24 01:28:06,487 - INFO - Avg. fwd time: 34.8338 / Avg. bwd time: 55.1509 / Avg. batch time: 1835.9432 (ms) / GPU bubble ratio: 60.79%
[rank1]:2025-10-24 01:28:06,565 - INFO - Avg. fwd time: 54.6439 / Avg. bwd time: 75.0795 / Avg. batch time: 1957.8208 (ms) / GPU bubble ratio: 46.99%
[rank0]:2025-10-24 01:28:06,637 - INFO - Avg. fwd time: 47.8705 / Avg. bwd time: 61.4458 / Avg. batch time: 2057.6190 (ms) / GPU bubble ratio: 57.50%
[rank2]:2025-10-24 01:30:53,377 - INFO -  step: 620  loss: -8.0000  grad_norm:  0.3233  memory: 16.10GiB(33.90%)  tps: 1,941  tflops: 15.17  mfu: 4.86%
[rank0]:2025-10-24 01:30:53,395 - INFO -  step: 620  loss: -8.0000  grad_norm:  0.3233  memory: 20.89GiB(43.97%)  tps: 1,941  tflops: 15.17  mfu: 4.86%
[rank1]:2025-10-24 01:30:53,381 - INFO -  step: 620  loss: -8.0000  grad_norm:  0.3233  memory: 20.03GiB(42.17%)  tps: 1,941  tflops: 15.17  mfu: 4.86%
[rank3]:2025-10-24 01:30:53,389 - INFO -  step: 620  loss:  1.8173  grad_norm:  0.3233  memory: 38.93GiB(81.95%)  tps: 1,941  tflops: 15.17  mfu: 4.86%
[rank3]:2025-10-24 01:30:55,307 - INFO - Avg. fwd time: 76.5820 / Avg. bwd time: 135.2772 / Avg. batch time: 1743.7865 (ms) / GPU bubble ratio: 2.80%
[rank2]:2025-10-24 01:30:55,371 - INFO - Avg. fwd time: 34.8331 / Avg. bwd time: 55.1545 / Avg. batch time: 1836.0783 (ms) / GPU bubble ratio: 60.79%
[rank0]:2025-10-24 01:30:55,526 - INFO - Avg. fwd time: 47.8707 / Avg. bwd time: 61.4560 / Avg. batch time: 2057.7602 (ms) / GPU bubble ratio: 57.50%
[rank1]:2025-10-24 01:30:55,458 - INFO - Avg. fwd time: 54.6572 / Avg. bwd time: 75.0749 / Avg. batch time: 1957.9773 (ms) / GPU bubble ratio: 46.99%
[rank3]:2025-10-24 01:33:43,693 - INFO - Avg. fwd time: 76.5750 / Avg. bwd time: 135.2836 / Avg. batch time: 1743.8325 (ms) / GPU bubble ratio: 2.81%
[rank2]:2025-10-24 01:33:43,757 - INFO - Avg. fwd time: 34.8324 / Avg. bwd time: 55.1589 / Avg. batch time: 1836.1249 (ms) / GPU bubble ratio: 60.79%
[rank1]:2025-10-24 01:33:43,838 - INFO - Avg. fwd time: 54.6798 / Avg. bwd time: 75.0668 / Avg. batch time: 1958.0436 (ms) / GPU bubble ratio: 46.99%
[rank0]:2025-10-24 01:33:43,907 - INFO - Avg. fwd time: 47.8691 / Avg. bwd time: 61.4646 / Avg. batch time: 2057.8105 (ms) / GPU bubble ratio: 57.50%
[rank1]:2025-10-24 01:36:30,607 - INFO -  step: 640  loss: -8.0000  grad_norm:  0.3226  memory: 20.03GiB(42.17%)  tps: 1,943  tflops: 15.19  mfu: 4.87%
[rank3]:2025-10-24 01:36:30,615 - INFO -  step: 640  loss:  1.7515  grad_norm:  0.3226  memory: 38.93GiB(81.95%)  tps: 1,943  tflops: 15.19  mfu: 4.87%
[rank2]:2025-10-24 01:36:30,603 - INFO -  step: 640  loss: -8.0000  grad_norm:  0.3226  memory: 16.10GiB(33.90%)  tps: 1,943  tflops: 15.19  mfu: 4.87%
[rank0]:2025-10-24 01:36:30,624 - INFO -  step: 640  loss: -8.0000  grad_norm:  0.3226  memory: 20.89GiB(43.97%)  tps: 1,943  tflops: 15.19  mfu: 4.87%
[rank3]:2025-10-24 01:36:32,555 - INFO - Avg. fwd time: 76.5739 / Avg. bwd time: 135.2937 / Avg. batch time: 1743.9342 (ms) / GPU bubble ratio: 2.81%
[rank2]:2025-10-24 01:36:32,623 - INFO - Avg. fwd time: 34.8348 / Avg. bwd time: 55.1626 / Avg. batch time: 1836.2257 (ms) / GPU bubble ratio: 60.79%
[rank1]:2025-10-24 01:36:32,706 - INFO - Avg. fwd time: 54.6944 / Avg. bwd time: 75.0593 / Avg. batch time: 1958.1798 (ms) / GPU bubble ratio: 46.99%
[rank0]:2025-10-24 01:36:32,779 - INFO - Avg. fwd time: 47.8744 / Avg. bwd time: 61.4746 / Avg. batch time: 2057.9441 (ms) / GPU bubble ratio: 57.49%
[rank0]:2025-10-24 01:39:02,488 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-24 01:39:21,261 - INFO - Avg. fwd time: 76.5726 / Avg. bwd time: 135.3012 / Avg. batch time: 1744.0144 (ms) / GPU bubble ratio: 2.81%
[rank2]:2025-10-24 01:39:21,324 - INFO - Avg. fwd time: 34.8343 / Avg. bwd time: 55.1640 / Avg. batch time: 1836.2999 (ms) / GPU bubble ratio: 60.79%
[rank1]:2025-10-24 01:39:21,404 - INFO - Avg. fwd time: 54.7042 / Avg. bwd time: 75.0583 / Avg. batch time: 1958.2742 (ms) / GPU bubble ratio: 46.99%
[rank0]:2025-10-24 01:39:21,473 - INFO - Avg. fwd time: 47.8744 / Avg. bwd time: 61.4824 / Avg. batch time: 2058.0354 (ms) / GPU bubble ratio: 57.49%
[rank3]:2025-10-24 01:42:08,181 - INFO -  step: 660  loss:  1.8031  grad_norm:  0.3554  memory: 38.93GiB(81.95%)  tps: 1,941  tflops: 15.18  mfu: 4.86%
[rank2]:2025-10-24 01:42:08,168 - INFO -  step: 660  loss: -8.0000  grad_norm:  0.3554  memory: 16.10GiB(33.90%)  tps: 1,941  tflops: 15.18  mfu: 4.86%
[rank0]:2025-10-24 01:42:08,186 - INFO -  step: 660  loss: -8.0000  grad_norm:  0.3554  memory: 20.89GiB(43.97%)  tps: 1,941  tflops: 15.18  mfu: 4.86%
[rank1]:2025-10-24 01:42:08,172 - INFO -  step: 660  loss: -8.0000  grad_norm:  0.3554  memory: 20.03GiB(42.17%)  tps: 1,941  tflops: 15.18  mfu: 4.86%
[rank3]:2025-10-24 01:42:10,105 - INFO - Avg. fwd time: 76.5758 / Avg. bwd time: 135.3091 / Avg. batch time: 1744.1172 (ms) / GPU bubble ratio: 2.81%
[rank2]:2025-10-24 01:42:10,169 - INFO - Avg. fwd time: 34.8368 / Avg. bwd time: 55.1672 / Avg. batch time: 1836.4031 (ms) / GPU bubble ratio: 60.79%
[rank1]:2025-10-24 01:42:10,246 - INFO - Avg. fwd time: 54.7100 / Avg. bwd time: 75.0497 / Avg. batch time: 1958.3904 (ms) / GPU bubble ratio: 46.99%
[rank0]:2025-10-24 01:42:10,316 - INFO - Avg. fwd time: 47.8739 / Avg. bwd time: 61.4890 / Avg. batch time: 2058.1534 (ms) / GPU bubble ratio: 57.49%
[rank3]:2025-10-24 01:44:59,214 - INFO - Avg. fwd time: 76.5827 / Avg. bwd time: 135.3193 / Avg. batch time: 1744.2652 (ms) / GPU bubble ratio: 2.81%
[rank2]:2025-10-24 01:44:59,282 - INFO - Avg. fwd time: 34.8362 / Avg. bwd time: 55.1728 / Avg. batch time: 1836.5585 (ms) / GPU bubble ratio: 60.79%
[rank1]:2025-10-24 01:44:59,360 - INFO - Avg. fwd time: 54.7188 / Avg. bwd time: 75.0468 / Avg. batch time: 1958.5648 (ms) / GPU bubble ratio: 47.00%
[rank0]:2025-10-24 01:44:59,437 - INFO - Avg. fwd time: 47.8758 / Avg. bwd time: 61.4950 / Avg. batch time: 2058.3280 (ms) / GPU bubble ratio: 57.49%
[rank1]:2025-10-24 01:47:45,933 - INFO -  step: 680  loss: -8.0000  grad_norm:  0.3351  memory: 20.03GiB(42.17%)  tps: 1,940  tflops: 15.17  mfu: 4.86%
[rank2]:2025-10-24 01:47:45,931 - INFO -  step: 680  loss: -8.0000  grad_norm:  0.3351  memory: 16.10GiB(33.90%)  tps: 1,940  tflops: 15.17  mfu: 4.86%
[rank0]:2025-10-24 01:47:45,954 - INFO -  step: 680  loss: -8.0000  grad_norm:  0.3351  memory: 20.89GiB(43.97%)  tps: 1,940  tflops: 15.17  mfu: 4.86%
[rank3]:2025-10-24 01:47:45,942 - INFO -  step: 680  loss:  1.7091  grad_norm:  0.3351  memory: 38.93GiB(81.95%)  tps: 1,940  tflops: 15.17  mfu: 4.86%
[rank3]:2025-10-24 01:47:47,840 - INFO - Avg. fwd time: 76.5804 / Avg. bwd time: 135.3238 / Avg. batch time: 1744.3165 (ms) / GPU bubble ratio: 2.81%
[rank2]:2025-10-24 01:47:47,903 - INFO - Avg. fwd time: 34.8374 / Avg. bwd time: 55.1746 / Avg. batch time: 1836.6091 (ms) / GPU bubble ratio: 60.79%
[rank1]:2025-10-24 01:47:47,989 - INFO - Avg. fwd time: 54.7323 / Avg. bwd time: 75.0385 / Avg. batch time: 1958.6286 (ms) / GPU bubble ratio: 47.00%
[rank0]:2025-10-24 01:47:48,063 - INFO - Avg. fwd time: 47.8762 / Avg. bwd time: 61.5019 / Avg. batch time: 2058.3911 (ms) / GPU bubble ratio: 57.49%
[rank3]:2025-10-24 01:50:36,652 - INFO - Avg. fwd time: 76.5839 / Avg. bwd time: 135.3323 / Avg. batch time: 1744.4323 (ms) / GPU bubble ratio: 2.81%
[rank2]:2025-10-24 01:50:36,716 - INFO - Avg. fwd time: 34.8377 / Avg. bwd time: 55.1779 / Avg. batch time: 1836.7266 (ms) / GPU bubble ratio: 60.79%
[rank1]:2025-10-24 01:50:36,794 - INFO - Avg. fwd time: 54.7423 / Avg. bwd time: 75.0255 / Avg. batch time: 1958.7439 (ms) / GPU bubble ratio: 47.00%
[rank0]:2025-10-24 01:50:36,875 - INFO - Avg. fwd time: 47.8775 / Avg. bwd time: 61.5091 / Avg. batch time: 2058.4977 (ms) / GPU bubble ratio: 57.49%
[rank0]:2025-10-24 01:53:06,827 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-24 01:53:23,779 - INFO -  step: 700  loss: -8.0000  grad_norm:  0.3625  memory: 20.03GiB(42.17%)  tps: 1,940  tflops: 15.16  mfu: 4.86%
[rank2]:2025-10-24 01:53:23,768 - INFO -  step: 700  loss: -8.0000  grad_norm:  0.3625  memory: 16.10GiB(33.90%)  tps: 1,940  tflops: 15.17  mfu: 4.86%
[rank3]:2025-10-24 01:53:23,781 - INFO -  step: 700  loss:  1.7793  grad_norm:  0.3625  memory: 38.93GiB(81.95%)  tps: 1,940  tflops: 15.17  mfu: 4.86%
[rank0]:2025-10-24 01:53:23,788 - INFO -  step: 700  loss: -8.0000  grad_norm:  0.3625  memory: 20.89GiB(43.97%)  tps: 1,940  tflops: 15.17  mfu: 4.86%
[rank3]:2025-10-24 01:53:24,038 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_nofreeze_dm1/pipeline_schedule/251024_0153_real_step700_rank3.svg
[rank3]:> Batch Time: 2006.69 ms, GPU Bubble Ratio: 56.55%, 47.71%, 64.45%, 15.17%
[rank3]:2025-10-24 01:53:25,846 - INFO - Avg. fwd time: 76.5873 / Avg. bwd time: 135.3431 / Avg. batch time: 1744.5577 (ms) / GPU bubble ratio: 2.82%
[rank2]:2025-10-24 01:53:25,909 - INFO - Avg. fwd time: 34.8403 / Avg. bwd time: 55.1856 / Avg. batch time: 1836.8736 (ms) / GPU bubble ratio: 60.79%
[rank1]:2025-10-24 01:53:25,993 - INFO - Avg. fwd time: 54.7464 / Avg. bwd time: 75.0121 / Avg. batch time: 1958.9119 (ms) / GPU bubble ratio: 47.01%
[rank0]:2025-10-24 01:53:26,067 - INFO - Avg. fwd time: 47.8810 / Avg. bwd time: 61.5185 / Avg. batch time: 2058.6634 (ms) / GPU bubble ratio: 57.49%
[rank3]:2025-10-24 01:56:14,691 - INFO - Avg. fwd time: 76.5859 / Avg. bwd time: 135.3529 / Avg. batch time: 1744.6579 (ms) / GPU bubble ratio: 2.82%
[rank2]:2025-10-24 01:56:14,760 - INFO - Avg. fwd time: 34.8414 / Avg. bwd time: 55.1896 / Avg. batch time: 1836.9664 (ms) / GPU bubble ratio: 60.79%
[rank1]:2025-10-24 01:56:14,845 - INFO - Avg. fwd time: 54.7642 / Avg. bwd time: 75.0051 / Avg. batch time: 1959.0280 (ms) / GPU bubble ratio: 47.01%
[rank0]:2025-10-24 01:56:14,920 - INFO - Avg. fwd time: 47.8834 / Avg. bwd time: 61.5257 / Avg. batch time: 2058.7754 (ms) / GPU bubble ratio: 57.49%
[rank2]:2025-10-24 01:59:01,158 - INFO -  step: 720  loss: -8.0000  grad_norm:  0.3296  memory: 16.10GiB(33.90%)  tps: 1,942  tflops: 15.19  mfu: 4.87%
[rank0]:2025-10-24 01:59:01,180 - INFO -  step: 720  loss: -8.0000  grad_norm:  0.3296  memory: 20.89GiB(43.97%)  tps: 1,942  tflops: 15.19  mfu: 4.87%
[rank3]:2025-10-24 01:59:01,171 - INFO -  step: 720  loss:  1.8025  grad_norm:  0.3296  memory: 38.93GiB(81.95%)  tps: 1,942  tflops: 15.19  mfu: 4.87%
[rank1]:2025-10-24 01:59:01,162 - INFO -  step: 720  loss: -8.0000  grad_norm:  0.3296  memory: 20.03GiB(42.17%)  tps: 1,942  tflops: 15.19  mfu: 4.87%
[rank3]:2025-10-24 01:59:03,067 - INFO - Avg. fwd time: 76.5813 / Avg. bwd time: 135.3560 / Avg. batch time: 1744.6699 (ms) / GPU bubble ratio: 2.82%
[rank2]:2025-10-24 01:59:03,131 - INFO - Avg. fwd time: 34.8425 / Avg. bwd time: 55.1908 / Avg. batch time: 1836.9692 (ms) / GPU bubble ratio: 60.79%
[rank1]:2025-10-24 01:59:03,218 - INFO - Avg. fwd time: 54.7779 / Avg. bwd time: 75.0014 / Avg. batch time: 1959.0662 (ms) / GPU bubble ratio: 47.00%
[rank0]:2025-10-24 01:59:03,292 - INFO - Avg. fwd time: 47.8822 / Avg. bwd time: 61.5298 / Avg. batch time: 2058.7994 (ms) / GPU bubble ratio: 57.49%
[rank3]:2025-10-24 02:01:51,991 - INFO - Avg. fwd time: 76.5844 / Avg. bwd time: 135.3661 / Avg. batch time: 1744.7872 (ms) / GPU bubble ratio: 2.82%
[rank2]:2025-10-24 02:01:52,062 - INFO - Avg. fwd time: 34.8442 / Avg. bwd time: 55.1926 / Avg. batch time: 1837.0824 (ms) / GPU bubble ratio: 60.79%
[rank1]:2025-10-24 02:01:52,145 - INFO - Avg. fwd time: 54.7841 / Avg. bwd time: 74.9884 / Avg. batch time: 1959.1909 (ms) / GPU bubble ratio: 47.01%
[rank0]:2025-10-24 02:01:52,221 - INFO - Avg. fwd time: 47.8865 / Avg. bwd time: 61.5375 / Avg. batch time: 2058.9276 (ms) / GPU bubble ratio: 57.48%
[rank3]:2025-10-24 02:04:38,756 - INFO -  step: 740  loss:  1.7298  grad_norm:  0.3273  memory: 38.93GiB(81.95%)  tps: 1,941  tflops: 15.18  mfu: 4.86%
[rank1]:2025-10-24 02:04:38,747 - INFO -  step: 740  loss: -8.0000  grad_norm:  0.3273  memory: 20.03GiB(42.17%)  tps: 1,941  tflops: 15.18  mfu: 4.86%
[rank2]:2025-10-24 02:04:38,743 - INFO -  step: 740  loss: -8.0000  grad_norm:  0.3273  memory: 16.10GiB(33.90%)  tps: 1,941  tflops: 15.18  mfu: 4.86%
[rank0]:2025-10-24 02:04:38,763 - INFO -  step: 740  loss: -8.0000  grad_norm:  0.3273  memory: 20.89GiB(43.97%)  tps: 1,941  tflops: 15.18  mfu: 4.86%
[rank3]:2025-10-24 02:04:40,678 - INFO - Avg. fwd time: 76.5845 / Avg. bwd time: 135.3726 / Avg. batch time: 1744.8607 (ms) / GPU bubble ratio: 2.82%
[rank2]:2025-10-24 02:04:40,743 - INFO - Avg. fwd time: 34.8446 / Avg. bwd time: 55.1947 / Avg. batch time: 1837.1514 (ms) / GPU bubble ratio: 60.79%
[rank1]:2025-10-24 02:04:40,832 - INFO - Avg. fwd time: 54.7912 / Avg. bwd time: 74.9695 / Avg. batch time: 1959.2653 (ms) / GPU bubble ratio: 47.02%
[rank0]:2025-10-24 02:04:40,903 - INFO - Avg. fwd time: 47.8898 / Avg. bwd time: 61.5453 / Avg. batch time: 2059.0004 (ms) / GPU bubble ratio: 57.48%
[rank0]:2025-10-24 02:07:10,306 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-24 02:07:29,141 - INFO - Avg. fwd time: 76.5772 / Avg. bwd time: 135.3788 / Avg. batch time: 1744.8917 (ms) / GPU bubble ratio: 2.82%
[rank2]:2025-10-24 02:07:29,222 - INFO - Avg. fwd time: 34.8480 / Avg. bwd time: 55.2010 / Avg. batch time: 1837.1896 (ms) / GPU bubble ratio: 60.79%
[rank1]:2025-10-24 02:07:29,302 - INFO - Avg. fwd time: 54.8050 / Avg. bwd time: 74.9522 / Avg. batch time: 1959.3113 (ms) / GPU bubble ratio: 47.02%
[rank0]:2025-10-24 02:07:29,376 - INFO - Avg. fwd time: 47.8898 / Avg. bwd time: 61.5529 / Avg. batch time: 2059.0414 (ms) / GPU bubble ratio: 57.48%
[rank3]:2025-10-24 02:10:16,148 - INFO -  step: 760  loss:  1.7499  grad_norm:  0.3419  memory: 38.93GiB(81.95%)  tps: 1,942  tflops: 15.19  mfu: 4.87%
[rank2]:2025-10-24 02:10:16,135 - INFO -  step: 760  loss: -8.0000  grad_norm:  0.3419  memory: 16.10GiB(33.90%)  tps: 1,942  tflops: 15.19  mfu: 4.87%
[rank0]:2025-10-24 02:10:16,155 - INFO -  step: 760  loss: -8.0000  grad_norm:  0.3419  memory: 20.89GiB(43.97%)  tps: 1,942  tflops: 15.19  mfu: 4.87%
[rank1]:2025-10-24 02:10:16,140 - INFO -  step: 760  loss: -8.0000  grad_norm:  0.3419  memory: 20.03GiB(42.17%)  tps: 1,942  tflops: 15.18  mfu: 4.87%
[rank3]:2025-10-24 02:10:18,078 - INFO - Avg. fwd time: 76.5742 / Avg. bwd time: 135.3879 / Avg. batch time: 1744.9835 (ms) / GPU bubble ratio: 2.82%
[rank2]:2025-10-24 02:10:18,146 - INFO - Avg. fwd time: 34.8481 / Avg. bwd time: 55.2051 / Avg. batch time: 1837.2841 (ms) / GPU bubble ratio: 60.79%
[rank1]:2025-10-24 02:10:18,228 - INFO - Avg. fwd time: 54.8216 / Avg. bwd time: 74.9428 / Avg. batch time: 1959.4242 (ms) / GPU bubble ratio: 47.02%
[rank0]:2025-10-24 02:10:18,303 - INFO - Avg. fwd time: 47.8915 / Avg. bwd time: 61.5584 / Avg. batch time: 2059.1509 (ms) / GPU bubble ratio: 57.48%

ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 10. 24. (ê¸ˆ) 02:13:27 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 3,4,5,6
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1022_llama1binstruct/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1022_llama1binstruct/1023_GPipe_nofreeze.log
âœ”ï¸Main Table Experiment
âœ”ï¸Running with nofreeze x GPipe ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1022_llama1binstruct/config.toml --job.description="Main Table Experiment" --parallelism.pipeline_parallel_degree=4  --freezing.no-freeze
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank0]:2025-10-24 02:13:33,769 - INFO - Starting job: "Main Table Experiment"
[rank3]:2025-10-24 02:13:33,769 - INFO - Starting job: "Main Table Experiment"
[rank2]:2025-10-24 02:13:33,945 - INFO - Starting job: "Main Table Experiment"
[rank1]:2025-10-24 02:13:34,028 - INFO - Starting job: "Main Table Experiment"
[rank0]:2025-10-24 02:13:34,512 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-10-24 02:13:34,515 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-24 02:13:34,520 - INFO - [GC] Initial GC collection 0.00 seconds
[rank1]:2025-10-24 02:13:34,549 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-10-24 02:13:34,552 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-10-24 02:13:34,528 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-10-24 02:13:34,531 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-10-24 02:13:34,519 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-10-24 02:13:34,521 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-24 02:13:34,878 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-10-24 02:13:35,299 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank3]:
[rank3]:Generating train split:   0%|          | 0/52002 [00:00<?, ? examples/s][rank3]:
[rank3]:Generating train split:   8%|â–Š         | 4000/52002 [00:00<00:01, 34031.83 examples/s][rank3]:
[rank3]:Generating train split:  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 49000/52002 [00:00<00:00, 258732.51 examples/s][rank0]:2025-10-24 02:13:40,527 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank3]:
[rank3]:Generating train split: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 52002/52002 [00:00<00:00, 229742.69 examples/s]
[rank0]:2025-10-24 02:13:40,686 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-10-24 02:13:40,674 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-10-24 02:13:40,732 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-10-24 02:13:40,734 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-10-24 02:13:40,759 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-10-24 02:13:40,759 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank2]:2025-10-24 02:13:40,731 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-10-24 02:13:40,759 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-10-24 02:13:40,760 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2025-10-24 02:13:40,981 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-10-24 02:13:41,023 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-10-24 02:13:41,051 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-10-24 02:13:41,051 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank0]:2025-10-24 02:13:41,625 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-10-24 02:13:41,626 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-10-24 02:13:41,626 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank2]:2025-10-24 02:13:41,626 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-10-24 02:13:41,626 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-10-24 02:13:41,627 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank1]:2025-10-24 02:13:41,624 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-10-24 02:13:41,624 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-10-24 02:13:41,625 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run c0k5np4h
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1023_GPipe_nofreeze_dm1/20251024-0213/wandb/run-20251024_021341-c0k5np4h
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1023_GPipe_nofreeze_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/c0k5np4h
[rank3]:2025-10-24 02:13:42,763 - INFO - WandB logging enabled
[rank3]:2025-10-24 02:13:42,914 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-10-24 02:13:42,953 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-10-24 02:13:42,982 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-10-24 02:13:42,982 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-10-24 02:13:43,407 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1023_GPipe_nofreeze_dm1
[rank0]:2025-10-24 02:13:43,407 - WARNING - Mixed precision training with TP or PP is only supported when FSDP/HSDP/CP is enabled.
[rank0]:2025-10-24 02:13:43,407 - INFO - Mixed precision training is disabled
[rank0]:2025-10-24 02:13:43,407 - INFO - Trainer is initialized with local batch size 16, global batch size 64, gradient accumulation steps 4, sequence length 1024, total steps 2000 (warmup 100)
[rank0]:2025-10-24 02:13:43,407 - WARNING - checkpoint.initial_load_path is provided but the checkpoint.folder exists. Checkpointer will use the checkpoints from the checkpoint.folder /data2/shcho/torchtitan/checkpoint/1023_GPipe_nofreeze_dm1.
[rank0]:2025-10-24 02:13:43,408 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/checkpoint/1023_GPipe_nofreeze_dm1/step-500.
[rank2]:2025-10-24 02:13:43,407 - WARNING - checkpoint.initial_load_path is provided but the checkpoint.folder exists. Checkpointer will use the checkpoints from the checkpoint.folder /data2/shcho/torchtitan/checkpoint/1023_GPipe_nofreeze_dm1.
[rank1]:2025-10-24 02:13:43,407 - WARNING - checkpoint.initial_load_path is provided but the checkpoint.folder exists. Checkpointer will use the checkpoints from the checkpoint.folder /data2/shcho/torchtitan/checkpoint/1023_GPipe_nofreeze_dm1.
[rank3]:2025-10-24 02:13:43,392 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-10-24 02:13:43,393 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-10-24 02:13:43,393 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank3]:2025-10-24 02:13:43,407 - WARNING - checkpoint.initial_load_path is provided but the checkpoint.folder exists. Checkpointer will use the checkpoints from the checkpoint.folder /data2/shcho/torchtitan/checkpoint/1023_GPipe_nofreeze_dm1.
[rank0]:2025-10-24 02:13:45,388 - INFO - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-10-24 02:13:45,388 - INFO - Finished loading the checkpoint in 1.98 seconds.
[rank0]:2025-10-24 02:13:45,388 - INFO - Training starts at step 1
[rank0]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/autograd/graph.py:849: UserWarning: Attempting to run cuBLAS, but there was no current CUDA context! Attempting to set the primary context... (Triggered internally at /pytorch/aten/src/ATen/cuda/CublasHandlePool.cpp:270.)
[rank0]:  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
[rank2]:2025-10-24 02:13:54,620 - INFO -  step:  1  loss: -4.0000  grad_norm:  8.5365  memory: 14.29GiB(30.07%)  tps: 1,180  tflops: 9.22  mfu: 2.96%
[rank2]:2025-10-24 02:13:54,620 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-24 02:13:54,628 - INFO -  step:  1  loss:  1.6852  grad_norm:  8.5365  memory: 35.59GiB(74.92%)  tps: 1,404  tflops: 10.97  mfu: 3.52%
[rank3]:2025-10-24 02:13:54,629 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-10-24 02:13:54,622 - INFO -  step:  1  loss: -4.0000  grad_norm:  8.5365  memory: 17.77GiB(37.40%)  tps: 1,205  tflops: 9.42  mfu: 3.02%
[rank1]:2025-10-24 02:13:54,623 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-10-24 02:13:54,656 - INFO -  step:  1  loss: -4.0000  grad_norm:  8.5365  memory: 17.10GiB(35.99%)  tps: 1,177  tflops: 9.20  mfu: 2.95%
[rank0]:2025-10-24 02:13:54,656 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-24 02:16:33,792 - INFO -  step: 20  loss:  1.3500  grad_norm:  1.2755  memory: 38.93GiB(81.95%)  tps: 1,956  tflops: 15.29  mfu: 4.90%
[rank2]:2025-10-24 02:16:33,780 - INFO -  step: 20  loss: -4.0000  grad_norm:  1.2755  memory: 16.10GiB(33.90%)  tps: 1,956  tflops: 15.29  mfu: 4.90%
[rank0]:2025-10-24 02:16:33,799 - INFO -  step: 20  loss: -4.0000  grad_norm:  1.2755  memory: 20.89GiB(43.97%)  tps: 1,956  tflops: 15.29  mfu: 4.90%
[rank1]:2025-10-24 02:16:33,784 - INFO -  step: 20  loss: -4.0000  grad_norm:  1.2755  memory: 20.03GiB(42.17%)  tps: 1,956  tflops: 15.29  mfu: 4.90%
[rank3]:2025-10-24 02:16:35,710 - INFO - Avg. fwd time: 75.5031 / Avg. bwd time: 134.4768 / Avg. batch time: 1733.8839 (ms) / GPU bubble ratio: 3.12%
[rank2]:2025-10-24 02:16:35,772 - INFO - Avg. fwd time: 34.7844 / Avg. bwd time: 54.9208 / Avg. batch time: 1825.8226 (ms) / GPU bubble ratio: 60.69%
[rank0]:2025-10-24 02:16:35,919 - INFO - Avg. fwd time: 48.6381 / Avg. bwd time: 61.4705 / Avg. batch time: 2047.5269 (ms) / GPU bubble ratio: 56.98%
[rank1]:2025-10-24 02:16:35,854 - INFO - Avg. fwd time: 55.1749 / Avg. bwd time: 73.9966 / Avg. batch time: 1948.1372 (ms) / GPU bubble ratio: 46.96%
[rank3]:2025-10-24 02:19:22,022 - INFO -  step: 40  loss:  1.2768  grad_norm:  1.2663  memory: 38.93GiB(81.95%)  tps: 1,948  tflops: 15.23  mfu: 4.88%
[rank2]:2025-10-24 02:19:22,010 - INFO -  step: 40  loss: -4.0000  grad_norm:  1.2663  memory: 16.10GiB(33.90%)  tps: 1,948  tflops: 15.23  mfu: 4.88%
[rank0]:2025-10-24 02:19:22,029 - INFO -  step: 40  loss: -4.0000  grad_norm:  1.2663  memory: 20.89GiB(43.97%)  tps: 1,948  tflops: 15.23  mfu: 4.88%
[rank1]:2025-10-24 02:19:22,014 - INFO -  step: 40  loss: -4.0000  grad_norm:  1.2663  memory: 20.03GiB(42.17%)  tps: 1,948  tflops: 15.23  mfu: 4.88%
[rank3]:2025-10-24 02:19:23,946 - INFO - Avg. fwd time: 75.5974 / Avg. bwd time: 134.9518 / Avg. batch time: 1737.8982 (ms) / GPU bubble ratio: 3.08%
[rank2]:2025-10-24 02:19:24,004 - INFO - Avg. fwd time: 34.9167 / Avg. bwd time: 55.1248 / Avg. batch time: 1829.8354 (ms) / GPU bubble ratio: 60.63%
[rank1]:2025-10-24 02:19:24,087 - INFO - Avg. fwd time: 55.7669 / Avg. bwd time: 74.2534 / Avg. batch time: 1952.7162 (ms) / GPU bubble ratio: 46.73%
[rank0]:2025-10-24 02:19:24,151 - INFO - Avg. fwd time: 48.1932 / Avg. bwd time: 61.5742 / Avg. batch time: 2051.7405 (ms) / GPU bubble ratio: 57.20%
[rank0]:2025-10-24 02:20:37,932 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-24 02:22:10,701 - INFO -  step: 60  loss: -4.0000  grad_norm:  0.6922  memory: 16.10GiB(33.90%)  tps: 1,942  tflops: 15.19  mfu: 4.87%
[rank1]:2025-10-24 02:22:10,705 - INFO -  step: 60  loss: -4.0000  grad_norm:  0.6922  memory: 20.03GiB(42.17%)  tps: 1,942  tflops: 15.19  mfu: 4.87%
[rank3]:2025-10-24 02:22:10,713 - INFO -  step: 60  loss:  1.2024  grad_norm:  0.6922  memory: 38.93GiB(81.95%)  tps: 1,943  tflops: 15.19  mfu: 4.87%
[rank0]:2025-10-24 02:22:10,729 - INFO -  step: 60  loss: -4.0000  grad_norm:  0.6922  memory: 20.89GiB(43.97%)  tps: 1,942  tflops: 15.18  mfu: 4.87%
[rank3]:2025-10-24 02:22:12,596 - INFO - Avg. fwd time: 75.8517 / Avg. bwd time: 135.1651 / Avg. batch time: 1740.8024 (ms) / GPU bubble ratio: 3.03%
[rank2]:2025-10-24 02:22:12,653 - INFO - Avg. fwd time: 34.9566 / Avg. bwd time: 55.2066 / Avg. batch time: 1832.7875 (ms) / GPU bubble ratio: 60.64%
[rank1]:2025-10-24 02:22:12,728 - INFO - Avg. fwd time: 55.7343 / Avg. bwd time: 74.2591 / Avg. batch time: 1955.5374 (ms) / GPU bubble ratio: 46.82%
[rank0]:2025-10-24 02:22:12,798 - INFO - Avg. fwd time: 48.0532 / Avg. bwd time: 61.5974 / Avg. batch time: 2054.6491 (ms) / GPU bubble ratio: 57.31%
[rank3]:2025-10-24 02:24:59,604 - INFO -  step: 80  loss:  1.1720  grad_norm:  0.4851  memory: 38.93GiB(81.95%)  tps: 1,940  tflops: 15.17  mfu: 4.86%
[rank0]:2025-10-24 02:24:59,611 - INFO -  step: 80  loss: -4.0000  grad_norm:  0.4851  memory: 20.89GiB(43.97%)  tps: 1,940  tflops: 15.17  mfu: 4.86%
[rank1]:2025-10-24 02:24:59,595 - INFO -  step: 80  loss: -4.0000  grad_norm:  0.4851  memory: 20.03GiB(42.17%)  tps: 1,940  tflops: 15.17  mfu: 4.86%
[rank2]:2025-10-24 02:24:59,591 - INFO -  step: 80  loss: -4.0000  grad_norm:  0.4851  memory: 16.10GiB(33.90%)  tps: 1,940  tflops: 15.17  mfu: 4.86%
[rank3]:2025-10-24 02:25:01,529 - INFO - Avg. fwd time: 76.0035 / Avg. bwd time: 135.3282 / Avg. batch time: 1742.7020 (ms) / GPU bubble ratio: 2.99%
[rank2]:2025-10-24 02:25:01,587 - INFO - Avg. fwd time: 34.9502 / Avg. bwd time: 55.2261 / Avg. batch time: 1834.6358 (ms) / GPU bubble ratio: 60.68%
[rank1]:2025-10-24 02:25:01,670 - INFO - Avg. fwd time: 55.6152 / Avg. bwd time: 74.2837 / Avg. batch time: 1957.6208 (ms) / GPU bubble ratio: 46.92%
[rank0]:2025-10-24 02:25:01,734 - INFO - Avg. fwd time: 48.0478 / Avg. bwd time: 61.7204 / Avg. batch time: 2056.9433 (ms) / GPU bubble ratio: 57.31%
[rank3]:2025-10-24 02:25:17,754 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-24 02:25:18,502 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 02:25:18,643 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-24 02:25:18,583 - WARNING - Dataset alpaca is being re-looped
[rank3]:2025-10-24 02:26:24,389 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_nofreeze_dm1/pipeline_schedule/251024_0226_real_warmupend90_rank3.svg
[rank3]:> Batch Time: 2004.81 ms, GPU Bubble Ratio: 56.27%, 47.84%, 64.32%, 15.63%
[rank0]:2025-10-24 02:27:40,389 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-24 02:27:48,890 - INFO -  step: 100  loss:  1.1746  grad_norm:  0.4880  memory: 38.93GiB(81.95%)  tps: 1,936  tflops: 15.13  mfu: 4.85%
[rank0]:2025-10-24 02:27:48,892 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.4880  memory: 20.89GiB(43.97%)  tps: 1,936  tflops: 15.13  mfu: 4.85%
[rank1]:2025-10-24 02:27:48,881 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.4880  memory: 20.03GiB(42.17%)  tps: 1,936  tflops: 15.13  mfu: 4.85%
[rank2]:2025-10-24 02:27:48,878 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.4880  memory: 16.10GiB(33.90%)  tps: 1,936  tflops: 15.13  mfu: 4.85%
[rank3]:2025-10-24 02:27:49,135 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_nofreeze_dm1/pipeline_schedule/251024_0227_real_step100_rank3.svg
[rank3]:> Batch Time: 2006.44 ms, GPU Bubble Ratio: 56.24%, 47.89%, 64.34%, 15.63%
[rank3]:2025-10-24 02:27:50,934 - INFO - Avg. fwd time: 76.1157 / Avg. bwd time: 135.4321 / Avg. batch time: 1744.0648 (ms) / GPU bubble ratio: 2.96%
[rank2]:2025-10-24 02:27:50,992 - INFO - Avg. fwd time: 34.9396 / Avg. bwd time: 55.2713 / Avg. batch time: 1836.7311 (ms) / GPU bubble ratio: 60.71%
[rank0]:2025-10-24 02:27:51,136 - INFO - Avg. fwd time: 48.0705 / Avg. bwd time: 61.7932 / Avg. batch time: 2059.2843 (ms) / GPU bubble ratio: 57.32%
[rank1]:2025-10-24 02:27:51,069 - INFO - Avg. fwd time: 55.5235 / Avg. bwd time: 74.2266 / Avg. batch time: 1959.7983 (ms) / GPU bubble ratio: 47.04%
[rank2]:2025-10-24 02:30:37,163 - INFO -  step: 120  loss: -4.0000  grad_norm:  0.4786  memory: 16.10GiB(33.90%)  tps: 1,947  tflops: 15.22  mfu: 4.88%
[rank1]:2025-10-24 02:30:37,167 - INFO -  step: 120  loss: -4.0000  grad_norm:  0.4786  memory: 20.03GiB(42.17%)  tps: 1,947  tflops: 15.22  mfu: 4.88%
[rank0]:2025-10-24 02:30:37,186 - INFO -  step: 120  loss: -4.0000  grad_norm:  0.4786  memory: 20.89GiB(43.97%)  tps: 1,947  tflops: 15.22  mfu: 4.88%
[rank3]:2025-10-24 02:30:37,175 - INFO -  step: 120  loss:  1.1159  grad_norm:  0.4786  memory: 38.93GiB(81.95%)  tps: 1,947  tflops: 15.22  mfu: 4.88%
[rank3]:2025-10-24 02:30:39,051 - INFO - Avg. fwd time: 75.9205 / Avg. bwd time: 135.4728 / Avg. batch time: 1743.2614 (ms) / GPU bubble ratio: 2.99%
[rank2]:2025-10-24 02:30:39,113 - INFO - Avg. fwd time: 34.9304 / Avg. bwd time: 55.3167 / Avg. batch time: 1835.8933 (ms) / GPU bubble ratio: 60.67%
[rank1]:2025-10-24 02:30:39,199 - INFO - Avg. fwd time: 55.7282 / Avg. bwd time: 74.2550 / Avg. batch time: 1958.9737 (ms) / GPU bubble ratio: 46.92%
[rank0]:2025-10-24 02:30:39,261 - INFO - Avg. fwd time: 47.9603 / Avg. bwd time: 61.7630 / Avg. batch time: 2058.2864 (ms) / GPU bubble ratio: 57.35%
[rank1]:2025-10-24 02:33:26,203 - INFO -  step: 140  loss: -4.0000  grad_norm:  0.4482  memory: 20.03GiB(42.17%)  tps: 1,939  tflops: 15.15  mfu: 4.86%
[rank2]:2025-10-24 02:33:26,199 - INFO -  step: 140  loss: -4.0000  grad_norm:  0.4482  memory: 16.10GiB(33.90%)  tps: 1,939  tflops: 15.15  mfu: 4.86%
[rank0]:2025-10-24 02:33:26,219 - INFO -  step: 140  loss: -4.0000  grad_norm:  0.4482  memory: 20.89GiB(43.97%)  tps: 1,939  tflops: 15.15  mfu: 4.86%
[rank3]:2025-10-24 02:33:26,212 - INFO -  step: 140  loss:  1.1477  grad_norm:  0.4482  memory: 38.93GiB(81.95%)  tps: 1,939  tflops: 15.15  mfu: 4.86%
[rank3]:2025-10-24 02:33:28,125 - INFO - Avg. fwd time: 76.0307 / Avg. bwd time: 135.5423 / Avg. batch time: 1744.2838 (ms) / GPU bubble ratio: 2.96%
[rank2]:2025-10-24 02:33:28,187 - INFO - Avg. fwd time: 34.9568 / Avg. bwd time: 55.3007 / Avg. batch time: 1836.8493 (ms) / GPU bubble ratio: 60.69%
[rank1]:2025-10-24 02:33:28,265 - INFO - Avg. fwd time: 55.6026 / Avg. bwd time: 74.2354 / Avg. batch time: 1959.9438 (ms) / GPU bubble ratio: 47.00%
[rank0]:2025-10-24 02:33:28,327 - INFO - Avg. fwd time: 47.9955 / Avg. bwd time: 61.7770 / Avg. batch time: 2059.2789 (ms) / GPU bubble ratio: 57.35%
[rank0]:2025-10-24 02:34:42,082 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-24 02:36:14,716 - INFO -  step: 160  loss: -4.0000  grad_norm:  0.4606  memory: 16.10GiB(33.90%)  tps: 1,945  tflops: 15.20  mfu: 4.87%
[rank3]:2025-10-24 02:36:14,728 - INFO -  step: 160  loss:  1.1131  grad_norm:  0.4606  memory: 38.93GiB(81.95%)  tps: 1,945  tflops: 15.20  mfu: 4.87%
[rank0]:2025-10-24 02:36:14,740 - INFO -  step: 160  loss: -4.0000  grad_norm:  0.4606  memory: 20.89GiB(43.97%)  tps: 1,944  tflops: 15.20  mfu: 4.87%
[rank1]:2025-10-24 02:36:14,720 - INFO -  step: 160  loss: -4.0000  grad_norm:  0.4606  memory: 20.03GiB(42.17%)  tps: 1,945  tflops: 15.20  mfu: 4.87%
[rank3]:2025-10-24 02:36:16,628 - INFO - Avg. fwd time: 76.0072 / Avg. bwd time: 135.5535 / Avg. batch time: 1744.2312 (ms) / GPU bubble ratio: 2.97%
[rank2]:2025-10-24 02:36:16,689 - INFO - Avg. fwd time: 34.9401 / Avg. bwd time: 55.2950 / Avg. batch time: 1836.6992 (ms) / GPU bubble ratio: 60.70%
[rank0]:2025-10-24 02:36:16,836 - INFO - Avg. fwd time: 47.9740 / Avg. bwd time: 61.7770 / Avg. batch time: 2059.1114 (ms) / GPU bubble ratio: 57.36%
[rank1]:2025-10-24 02:36:16,766 - INFO - Avg. fwd time: 55.6702 / Avg. bwd time: 74.2114 / Avg. batch time: 1959.8200 (ms) / GPU bubble ratio: 46.98%
[rank3]:2025-10-24 02:36:51,677 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-24 02:36:52,418 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-24 02:36:52,497 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 02:36:52,557 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-24 02:39:03,250 - INFO -  step: 180  loss: -4.0000  grad_norm:  0.4780  memory: 16.10GiB(33.90%)  tps: 1,944  tflops: 15.20  mfu: 4.87%
[rank1]:2025-10-24 02:39:03,254 - INFO -  step: 180  loss: -4.0000  grad_norm:  0.4780  memory: 20.03GiB(42.17%)  tps: 1,944  tflops: 15.20  mfu: 4.87%
[rank0]:2025-10-24 02:39:03,268 - INFO -  step: 180  loss: -4.0000  grad_norm:  0.4780  memory: 20.89GiB(43.97%)  tps: 1,944  tflops: 15.20  mfu: 4.87%
[rank3]:2025-10-24 02:39:03,262 - INFO -  step: 180  loss:  1.0987  grad_norm:  0.4780  memory: 38.93GiB(81.95%)  tps: 1,944  tflops: 15.20  mfu: 4.87%
[rank3]:2025-10-24 02:39:05,187 - INFO - Avg. fwd time: 75.9970 / Avg. bwd time: 135.5661 / Avg. batch time: 1744.1075 (ms) / GPU bubble ratio: 2.96%
[rank2]:2025-10-24 02:39:05,251 - INFO - Avg. fwd time: 34.9584 / Avg. bwd time: 55.2972 / Avg. batch time: 1836.5450 (ms) / GPU bubble ratio: 60.68%
[rank1]:2025-10-24 02:39:05,332 - INFO - Avg. fwd time: 55.6331 / Avg. bwd time: 74.1611 / Avg. batch time: 1959.6871 (ms) / GPU bubble ratio: 47.01%
[rank0]:2025-10-24 02:39:05,396 - INFO - Avg. fwd time: 47.9505 / Avg. bwd time: 61.7865 / Avg. batch time: 2058.9857 (ms) / GPU bubble ratio: 57.36%
[rank0]:2025-10-24 02:41:43,993 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-24 02:41:52,520 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.4340  memory: 20.89GiB(43.97%)  tps: 1,936  tflops: 15.14  mfu: 4.85%
[rank1]:2025-10-24 02:41:52,508 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.4340  memory: 20.03GiB(42.17%)  tps: 1,936  tflops: 15.13  mfu: 4.85%
[rank2]:2025-10-24 02:41:52,501 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.4340  memory: 16.10GiB(33.90%)  tps: 1,936  tflops: 15.14  mfu: 4.85%
[rank3]:2025-10-24 02:41:52,513 - INFO -  step: 200  loss:  1.0814  grad_norm:  0.4340  memory: 38.93GiB(81.95%)  tps: 1,936  tflops: 15.14  mfu: 4.85%
[rank3]:2025-10-24 02:41:52,764 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_nofreeze_dm1/pipeline_schedule/251024_0241_real_step200_rank3.svg
[rank3]:> Batch Time: 2005.84 ms, GPU Bubble Ratio: 56.22%, 47.90%, 64.32%, 15.62%
[rank3]:2025-10-24 02:41:54,567 - INFO - Avg. fwd time: 76.0734 / Avg. bwd time: 135.6074 / Avg. batch time: 1744.8187 (ms) / GPU bubble ratio: 2.94%
[rank2]:2025-10-24 02:41:54,625 - INFO - Avg. fwd time: 34.9599 / Avg. bwd time: 55.3120 / Avg. batch time: 1837.3945 (ms) / GPU bubble ratio: 60.70%
[rank1]:2025-10-24 02:41:54,708 - INFO - Avg. fwd time: 55.5970 / Avg. bwd time: 74.1437 / Avg. batch time: 1960.5218 (ms) / GPU bubble ratio: 47.06%
[rank0]:2025-10-24 02:41:54,786 - INFO - Avg. fwd time: 47.9711 / Avg. bwd time: 61.8132 / Avg. batch time: 2059.8483 (ms) / GPU bubble ratio: 57.36%
[rank1]:2025-10-24 02:44:42,129 - INFO -  step: 220  loss: -4.0000  grad_norm:  0.4710  memory: 20.03GiB(42.17%)  tps: 1,932  tflops: 15.10  mfu: 4.84%
[rank0]:2025-10-24 02:44:42,145 - INFO -  step: 220  loss: -4.0000  grad_norm:  0.4710  memory: 20.89GiB(43.97%)  tps: 1,932  tflops: 15.10  mfu: 4.84%
[rank2]:2025-10-24 02:44:42,125 - INFO -  step: 220  loss: -4.0000  grad_norm:  0.4710  memory: 16.10GiB(33.90%)  tps: 1,932  tflops: 15.10  mfu: 4.84%
[rank3]:2025-10-24 02:44:42,137 - INFO -  step: 220  loss:  1.0671  grad_norm:  0.4710  memory: 38.93GiB(81.95%)  tps: 1,932  tflops: 15.10  mfu: 4.84%
[rank3]:2025-10-24 02:44:44,072 - INFO - Avg. fwd time: 76.1318 / Avg. bwd time: 135.6660 / Avg. batch time: 1745.6128 (ms) / GPU bubble ratio: 2.93%
[rank2]:2025-10-24 02:44:44,129 - INFO - Avg. fwd time: 34.9581 / Avg. bwd time: 55.3483 / Avg. batch time: 1838.1852 (ms) / GPU bubble ratio: 60.70%
[rank1]:2025-10-24 02:44:44,210 - INFO - Avg. fwd time: 55.5671 / Avg. bwd time: 74.1656 / Avg. batch time: 1961.3372 (ms) / GPU bubble ratio: 47.08%
[rank0]:2025-10-24 02:44:44,280 - INFO - Avg. fwd time: 47.9815 / Avg. bwd time: 61.8405 / Avg. batch time: 2060.7035 (ms) / GPU bubble ratio: 57.37%
[rank2]:2025-10-24 02:47:30,930 - INFO -  step: 240  loss: -4.0000  grad_norm:  0.4572  memory: 16.10GiB(33.90%)  tps: 1,941  tflops: 15.18  mfu: 4.86%
[rank3]:2025-10-24 02:47:30,942 - INFO -  step: 240  loss:  1.0204  grad_norm:  0.4572  memory: 38.93GiB(81.95%)  tps: 1,941  tflops: 15.18  mfu: 4.86%
[rank1]:2025-10-24 02:47:30,941 - INFO -  step: 240  loss: -4.0000  grad_norm:  0.4572  memory: 20.03GiB(42.17%)  tps: 1,941  tflops: 15.17  mfu: 4.86%
[rank0]:2025-10-24 02:47:30,954 - INFO -  step: 240  loss: -4.0000  grad_norm:  0.4572  memory: 20.89GiB(43.97%)  tps: 1,941  tflops: 15.17  mfu: 4.86%
[rank3]:2025-10-24 02:47:32,857 - INFO - Avg. fwd time: 76.1335 / Avg. bwd time: 135.6882 / Avg. batch time: 1745.6658 (ms) / GPU bubble ratio: 2.93%
[rank2]:2025-10-24 02:47:32,914 - INFO - Avg. fwd time: 34.9671 / Avg. bwd time: 55.3551 / Avg. batch time: 1838.1706 (ms) / GPU bubble ratio: 60.69%
[rank1]:2025-10-24 02:47:32,989 - INFO - Avg. fwd time: 55.5429 / Avg. bwd time: 74.1774 / Avg. batch time: 1961.2724 (ms) / GPU bubble ratio: 47.09%
[rank0]:2025-10-24 02:47:33,056 - INFO - Avg. fwd time: 48.0026 / Avg. bwd time: 61.8286 / Avg. batch time: 2060.6812 (ms) / GPU bubble ratio: 57.36%
[rank3]:2025-10-24 02:48:27,360 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-24 02:48:28,102 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-24 02:48:28,182 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 02:48:28,244 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 02:48:47,170 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-24 02:50:20,286 - INFO -  step: 260  loss: -4.0000  grad_norm:  0.4556  memory: 16.10GiB(33.90%)  tps: 1,935  tflops: 15.13  mfu: 4.85%
[rank1]:2025-10-24 02:50:20,289 - INFO -  step: 260  loss: -4.0000  grad_norm:  0.4556  memory: 20.03GiB(42.17%)  tps: 1,935  tflops: 15.13  mfu: 4.85%
[rank0]:2025-10-24 02:50:20,306 - INFO -  step: 260  loss: -4.0000  grad_norm:  0.4556  memory: 20.89GiB(43.97%)  tps: 1,935  tflops: 15.13  mfu: 4.85%
[rank3]:2025-10-24 02:50:20,298 - INFO -  step: 260  loss:  1.0371  grad_norm:  0.4556  memory: 38.93GiB(81.95%)  tps: 1,935  tflops: 15.13  mfu: 4.85%
[rank3]:2025-10-24 02:50:22,222 - INFO - Avg. fwd time: 76.1779 / Avg. bwd time: 135.7285 / Avg. batch time: 1746.2107 (ms) / GPU bubble ratio: 2.92%
[rank2]:2025-10-24 02:50:22,283 - INFO - Avg. fwd time: 34.9804 / Avg. bwd time: 55.3662 / Avg. batch time: 1838.6718 (ms) / GPU bubble ratio: 60.69%
[rank1]:2025-10-24 02:50:22,365 - INFO - Avg. fwd time: 55.5066 / Avg. bwd time: 74.1824 / Avg. batch time: 1961.7810 (ms) / GPU bubble ratio: 47.11%
[rank0]:2025-10-24 02:50:22,429 - INFO - Avg. fwd time: 48.0236 / Avg. bwd time: 61.8518 / Avg. batch time: 2061.2377 (ms) / GPU bubble ratio: 57.36%
[rank2]:2025-10-24 02:53:09,801 - INFO -  step: 280  loss: -4.0000  grad_norm:  0.4589  memory: 16.10GiB(33.90%)  tps: 1,933  tflops: 15.11  mfu: 4.84%
[rank0]:2025-10-24 02:53:09,820 - INFO -  step: 280  loss: -4.0000  grad_norm:  0.4589  memory: 20.89GiB(43.97%)  tps: 1,933  tflops: 15.11  mfu: 4.84%
[rank1]:2025-10-24 02:53:09,806 - INFO -  step: 280  loss: -4.0000  grad_norm:  0.4589  memory: 20.03GiB(42.17%)  tps: 1,933  tflops: 15.11  mfu: 4.84%
[rank3]:2025-10-24 02:53:09,814 - INFO -  step: 280  loss:  1.0232  grad_norm:  0.4589  memory: 38.93GiB(81.95%)  tps: 1,933  tflops: 15.11  mfu: 4.84%
[rank3]:2025-10-24 02:53:11,742 - INFO - Avg. fwd time: 76.2259 / Avg. bwd time: 135.7590 / Avg. batch time: 1746.6755 (ms) / GPU bubble ratio: 2.91%
[rank2]:2025-10-24 02:53:11,806 - INFO - Avg. fwd time: 34.9831 / Avg. bwd time: 55.3742 / Avg. batch time: 1839.1280 (ms) / GPU bubble ratio: 60.70%
[rank1]:2025-10-24 02:53:11,887 - INFO - Avg. fwd time: 55.4535 / Avg. bwd time: 74.2006 / Avg. batch time: 1962.2721 (ms) / GPU bubble ratio: 47.14%
[rank0]:2025-10-24 02:53:11,955 - INFO - Avg. fwd time: 48.0514 / Avg. bwd time: 61.8743 / Avg. batch time: 2061.8092 (ms) / GPU bubble ratio: 57.35%
[rank0]:2025-10-24 02:55:50,146 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-24 02:55:58,572 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.4609  memory: 20.03GiB(42.17%)  tps: 1,942  tflops: 15.18  mfu: 4.86%
[rank3]:2025-10-24 02:55:58,581 - INFO -  step: 300  loss:  1.0100  grad_norm:  0.4609  memory: 38.93GiB(81.95%)  tps: 1,942  tflops: 15.18  mfu: 4.86%
[rank2]:2025-10-24 02:55:58,569 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.4609  memory: 16.10GiB(33.90%)  tps: 1,942  tflops: 15.18  mfu: 4.86%
[rank0]:2025-10-24 02:55:58,591 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.4609  memory: 20.89GiB(43.97%)  tps: 1,942  tflops: 15.18  mfu: 4.86%
[rank3]:2025-10-24 02:55:58,833 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_nofreeze_dm1/pipeline_schedule/251024_0255_real_step300_rank3.svg
[rank3]:> Batch Time: 2008.47 ms, GPU Bubble Ratio: 56.17%, 48.03%, 64.32%, 15.59%
[rank3]:2025-10-24 02:56:00,637 - INFO - Avg. fwd time: 76.2111 / Avg. bwd time: 135.7627 / Avg. batch time: 1746.5637 (ms) / GPU bubble ratio: 2.91%
[rank2]:2025-10-24 02:56:00,698 - INFO - Avg. fwd time: 34.9897 / Avg. bwd time: 55.3804 / Avg. batch time: 1839.0749 (ms) / GPU bubble ratio: 60.69%
[rank1]:2025-10-24 02:56:00,770 - INFO - Avg. fwd time: 55.4716 / Avg. bwd time: 74.1754 / Avg. batch time: 1962.2464 (ms) / GPU bubble ratio: 47.14%
[rank0]:2025-10-24 02:56:00,837 - INFO - Avg. fwd time: 48.0392 / Avg. bwd time: 61.8926 / Avg. batch time: 2061.7606 (ms) / GPU bubble ratio: 57.34%
[rank2]:2025-10-24 02:58:47,876 - INFO -  step: 320  loss: -4.0000  grad_norm:  0.5084  memory: 16.10GiB(33.90%)  tps: 1,935  tflops: 15.13  mfu: 4.85%
[rank3]:2025-10-24 02:58:47,889 - INFO -  step: 320  loss:  1.0243  grad_norm:  0.5084  memory: 38.93GiB(81.95%)  tps: 1,935  tflops: 15.13  mfu: 4.85%
[rank0]:2025-10-24 02:58:47,891 - INFO -  step: 320  loss: -4.0000  grad_norm:  0.5084  memory: 20.89GiB(43.97%)  tps: 1,936  tflops: 15.13  mfu: 4.85%
[rank1]:2025-10-24 02:58:47,881 - INFO -  step: 320  loss: -4.0000  grad_norm:  0.5084  memory: 20.03GiB(42.17%)  tps: 1,935  tflops: 15.13  mfu: 4.85%
[rank2]:2025-10-24 02:58:49,869 - INFO - Avg. fwd time: 34.9978 / Avg. bwd time: 55.3820 / Avg. batch time: 1839.3273 (ms) / GPU bubble ratio: 60.69%
[rank3]:2025-10-24 02:58:49,807 - INFO - Avg. fwd time: 76.2381 / Avg. bwd time: 135.7853 / Avg. batch time: 1746.8317 (ms) / GPU bubble ratio: 2.90%
[rank1]:2025-10-24 02:58:49,952 - INFO - Avg. fwd time: 55.4441 / Avg. bwd time: 74.1661 / Avg. batch time: 1962.5028 (ms) / GPU bubble ratio: 47.17%
[rank0]:2025-10-24 02:58:50,015 - INFO - Avg. fwd time: 48.0509 / Avg. bwd time: 61.8963 / Avg. batch time: 2061.9863 (ms) / GPU bubble ratio: 57.34%
[rank3]:2025-10-24 03:00:05,242 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-24 03:00:05,992 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-24 03:00:06,065 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 03:00:06,131 - WARNING - Dataset alpaca is being re-looped
[rank3]:2025-10-24 03:01:36,856 - INFO -  step: 340  loss:  0.9765  grad_norm:  0.4927  memory: 38.93GiB(81.95%)  tps: 1,939  tflops: 15.16  mfu: 4.86%
[rank2]:2025-10-24 03:01:36,844 - INFO -  step: 340  loss: -4.0000  grad_norm:  0.4927  memory: 16.10GiB(33.90%)  tps: 1,939  tflops: 15.16  mfu: 4.86%
[rank0]:2025-10-24 03:01:36,863 - INFO -  step: 340  loss: -4.0000  grad_norm:  0.4927  memory: 20.89GiB(43.97%)  tps: 1,939  tflops: 15.16  mfu: 4.86%
[rank1]:2025-10-24 03:01:36,848 - INFO -  step: 340  loss: -4.0000  grad_norm:  0.4927  memory: 20.03GiB(42.17%)  tps: 1,939  tflops: 15.16  mfu: 4.86%
[rank3]:2025-10-24 03:01:38,771 - INFO - Avg. fwd time: 76.2610 / Avg. bwd time: 135.7838 / Avg. batch time: 1746.9236 (ms) / GPU bubble ratio: 2.89%
[rank2]:2025-10-24 03:01:38,832 - INFO - Avg. fwd time: 34.9993 / Avg. bwd time: 55.3719 / Avg. batch time: 1839.3940 (ms) / GPU bubble ratio: 60.70%
[rank1]:2025-10-24 03:01:38,914 - INFO - Avg. fwd time: 55.4251 / Avg. bwd time: 74.1449 / Avg. batch time: 1962.5417 (ms) / GPU bubble ratio: 47.18%
[rank0]:2025-10-24 03:01:38,981 - INFO - Avg. fwd time: 48.0570 / Avg. bwd time: 61.8996 / Avg. batch time: 2062.0531 (ms) / GPU bubble ratio: 57.34%
[rank0]:2025-10-24 03:02:52,987 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-24 03:04:25,978 - INFO -  step: 360  loss: -4.0000  grad_norm:  0.4887  memory: 16.10GiB(33.90%)  tps: 1,937  tflops: 15.15  mfu: 4.85%
[rank0]:2025-10-24 03:04:26,002 - INFO -  step: 360  loss: -4.0000  grad_norm:  0.4887  memory: 20.89GiB(43.97%)  tps: 1,937  tflops: 15.15  mfu: 4.85%
[rank1]:2025-10-24 03:04:25,986 - INFO -  step: 360  loss: -4.0000  grad_norm:  0.4887  memory: 20.03GiB(42.17%)  tps: 1,937  tflops: 15.15  mfu: 4.85%
[rank3]:2025-10-24 03:04:25,990 - INFO -  step: 360  loss:  0.9970  grad_norm:  0.4887  memory: 38.93GiB(81.95%)  tps: 1,937  tflops: 15.15  mfu: 4.85%
[rank3]:2025-10-24 03:04:27,893 - INFO - Avg. fwd time: 76.2804 / Avg. bwd time: 135.7972 / Avg. batch time: 1747.0870 (ms) / GPU bubble ratio: 2.89%
[rank2]:2025-10-24 03:04:27,956 - INFO - Avg. fwd time: 35.0019 / Avg. bwd time: 55.3618 / Avg. batch time: 1839.5103 (ms) / GPU bubble ratio: 60.70%
[rank1]:2025-10-24 03:04:28,046 - INFO - Avg. fwd time: 55.4065 / Avg. bwd time: 74.1610 / Avg. batch time: 1962.6549 (ms) / GPU bubble ratio: 47.19%
[rank0]:2025-10-24 03:04:28,117 - INFO - Avg. fwd time: 48.0597 / Avg. bwd time: 61.8973 / Avg. batch time: 2062.1867 (ms) / GPU bubble ratio: 57.34%
[rank2]:2025-10-24 03:07:15,728 - INFO -  step: 380  loss: -4.0000  grad_norm:  0.4629  memory: 16.10GiB(33.90%)  tps: 1,930  tflops: 15.09  mfu: 4.84%
[rank0]:2025-10-24 03:07:15,755 - INFO -  step: 380  loss: -4.0000  grad_norm:  0.4629  memory: 20.89GiB(43.97%)  tps: 1,930  tflops: 15.09  mfu: 4.84%
[rank1]:2025-10-24 03:07:15,732 - INFO -  step: 380  loss: -4.0000  grad_norm:  0.4629  memory: 20.03GiB(42.17%)  tps: 1,930  tflops: 15.09  mfu: 4.84%
[rank3]:2025-10-24 03:07:15,741 - INFO -  step: 380  loss:  0.9454  grad_norm:  0.4629  memory: 38.93GiB(81.95%)  tps: 1,930  tflops: 15.09  mfu: 4.84%
[rank3]:2025-10-24 03:07:17,662 - INFO - Avg. fwd time: 76.3347 / Avg. bwd time: 135.8231 / Avg. batch time: 1747.5565 (ms) / GPU bubble ratio: 2.88%
[rank2]:2025-10-24 03:07:17,726 - INFO - Avg. fwd time: 34.9965 / Avg. bwd time: 55.3564 / Avg. batch time: 1839.9319 (ms) / GPU bubble ratio: 60.71%
[rank1]:2025-10-24 03:07:17,802 - INFO - Avg. fwd time: 55.3628 / Avg. bwd time: 74.1987 / Avg. batch time: 1963.0896 (ms) / GPU bubble ratio: 47.20%
[rank0]:2025-10-24 03:07:17,870 - INFO - Avg. fwd time: 48.0477 / Avg. bwd time: 61.8963 / Avg. batch time: 2062.6562 (ms) / GPU bubble ratio: 57.36%
[rank0]:2025-10-24 03:09:57,146 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-24 03:10:05,690 - INFO -  step: 400  loss:  0.9264  grad_norm:  0.4746  memory: 38.93GiB(81.95%)  tps: 1,928  tflops: 15.07  mfu: 4.83%
[rank2]:2025-10-24 03:10:05,677 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.4746  memory: 16.10GiB(33.90%)  tps: 1,928  tflops: 15.07  mfu: 4.83%
[rank0]:2025-10-24 03:10:05,697 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.4746  memory: 20.89GiB(43.97%)  tps: 1,928  tflops: 15.07  mfu: 4.83%
[rank1]:2025-10-24 03:10:05,683 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.4746  memory: 20.03GiB(42.17%)  tps: 1,928  tflops: 15.07  mfu: 4.83%
[rank3]:2025-10-24 03:10:05,938 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_nofreeze_dm1/pipeline_schedule/251024_0310_real_step400_rank3.svg
[rank3]:> Batch Time: 2010.31 ms, GPU Bubble Ratio: 56.17%, 48.15%, 64.37%, 15.57%
[rank3]:2025-10-24 03:10:07,744 - INFO - Avg. fwd time: 76.3925 / Avg. bwd time: 135.8484 / Avg. batch time: 1748.0557 (ms) / GPU bubble ratio: 2.87%
[rank2]:2025-10-24 03:10:07,802 - INFO - Avg. fwd time: 34.9986 / Avg. bwd time: 55.3614 / Avg. batch time: 1840.4925 (ms) / GPU bubble ratio: 60.72%
[rank1]:2025-10-24 03:10:07,879 - INFO - Avg. fwd time: 55.3214 / Avg. bwd time: 74.2552 / Avg. batch time: 1963.6914 (ms) / GPU bubble ratio: 47.21%
[rank0]:2025-10-24 03:10:07,944 - INFO - Avg. fwd time: 48.0374 / Avg. bwd time: 61.8961 / Avg. batch time: 2063.2906 (ms) / GPU bubble ratio: 57.38%
[rank3]:2025-10-24 03:11:42,471 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-24 03:11:43,211 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-24 03:11:43,289 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 03:11:43,350 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-24 03:12:55,468 - INFO -  step: 420  loss: -4.0000  grad_norm:  0.4408  memory: 20.03GiB(42.17%)  tps: 1,930  tflops: 15.09  mfu: 4.84%
[rank2]:2025-10-24 03:12:55,464 - INFO -  step: 420  loss: -4.0000  grad_norm:  0.4408  memory: 16.10GiB(33.90%)  tps: 1,930  tflops: 15.09  mfu: 4.84%
[rank3]:2025-10-24 03:12:55,477 - INFO -  step: 420  loss:  0.8951  grad_norm:  0.4408  memory: 38.93GiB(81.95%)  tps: 1,930  tflops: 15.09  mfu: 4.84%
[rank0]:2025-10-24 03:12:55,484 - INFO -  step: 420  loss: -4.0000  grad_norm:  0.4408  memory: 20.89GiB(43.97%)  tps: 1,930  tflops: 15.09  mfu: 4.84%
[rank3]:2025-10-24 03:12:57,407 - INFO - Avg. fwd time: 76.4234 / Avg. bwd time: 135.8781 / Avg. batch time: 1748.4363 (ms) / GPU bubble ratio: 2.86%
[rank2]:2025-10-24 03:12:57,467 - INFO - Avg. fwd time: 35.0026 / Avg. bwd time: 55.3640 / Avg. batch time: 1840.8238 (ms) / GPU bubble ratio: 60.73%
[rank1]:2025-10-24 03:12:57,540 - INFO - Avg. fwd time: 55.3022 / Avg. bwd time: 74.2737 / Avg. batch time: 1964.0450 (ms) / GPU bubble ratio: 47.22%
[rank0]:2025-10-24 03:12:57,608 - INFO - Avg. fwd time: 48.0465 / Avg. bwd time: 61.9099 / Avg. batch time: 2063.6678 (ms) / GPU bubble ratio: 57.37%
[rank3]:2025-10-24 03:15:44,386 - INFO -  step: 440  loss:  0.9080  grad_norm:  0.4686  memory: 38.93GiB(81.95%)  tps: 1,940  tflops: 15.17  mfu: 4.86%
[rank1]:2025-10-24 03:15:44,378 - INFO -  step: 440  loss: -4.0000  grad_norm:  0.4686  memory: 20.03GiB(42.17%)  tps: 1,940  tflops: 15.17  mfu: 4.86%
[rank0]:2025-10-24 03:15:44,393 - INFO -  step: 440  loss: -4.0000  grad_norm:  0.4686  memory: 20.89GiB(43.97%)  tps: 1,940  tflops: 15.17  mfu: 4.86%
[rank2]:2025-10-24 03:15:44,373 - INFO -  step: 440  loss: -4.0000  grad_norm:  0.4686  memory: 16.10GiB(33.90%)  tps: 1,940  tflops: 15.17  mfu: 4.86%
[rank3]:2025-10-24 03:15:46,317 - INFO - Avg. fwd time: 76.4256 / Avg. bwd time: 135.8880 / Avg. batch time: 1748.4383 (ms) / GPU bubble ratio: 2.86%
[rank2]:2025-10-24 03:15:46,376 - INFO - Avg. fwd time: 35.0049 / Avg. bwd time: 55.3714 / Avg. batch time: 1840.8082 (ms) / GPU bubble ratio: 60.72%
[rank1]:2025-10-24 03:15:46,460 - INFO - Avg. fwd time: 55.2701 / Avg. bwd time: 74.2970 / Avg. batch time: 1963.9964 (ms) / GPU bubble ratio: 47.22%
[rank0]:2025-10-24 03:15:46,531 - INFO - Avg. fwd time: 48.0449 / Avg. bwd time: 61.9067 / Avg. batch time: 2063.6016 (ms) / GPU bubble ratio: 57.37%
[rank0]:2025-10-24 03:17:00,570 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-24 03:18:33,711 - INFO -  step: 460  loss:  0.9716  grad_norm:  0.5340  memory: 38.93GiB(81.95%)  tps: 1,935  tflops: 15.13  mfu: 4.85%
[rank1]:2025-10-24 03:18:33,703 - INFO -  step: 460  loss: -4.0000  grad_norm:  0.5340  memory: 20.03GiB(42.17%)  tps: 1,935  tflops: 15.13  mfu: 4.85%
[rank0]:2025-10-24 03:18:33,719 - INFO -  step: 460  loss: -4.0000  grad_norm:  0.5340  memory: 20.89GiB(43.97%)  tps: 1,935  tflops: 15.13  mfu: 4.85%
[rank2]:2025-10-24 03:18:33,699 - INFO -  step: 460  loss: -4.0000  grad_norm:  0.5340  memory: 16.10GiB(33.90%)  tps: 1,935  tflops: 15.13  mfu: 4.85%
[rank3]:2025-10-24 03:18:35,637 - INFO - Avg. fwd time: 76.4536 / Avg. bwd time: 135.8962 / Avg. batch time: 1748.6000 (ms) / GPU bubble ratio: 2.85%
[rank2]:2025-10-24 03:18:35,702 - INFO - Avg. fwd time: 35.0016 / Avg. bwd time: 55.3765 / Avg. batch time: 1840.9419 (ms) / GPU bubble ratio: 60.73%
[rank1]:2025-10-24 03:18:35,778 - INFO - Avg. fwd time: 55.2258 / Avg. bwd time: 74.3535 / Avg. batch time: 1964.1176 (ms) / GPU bubble ratio: 47.22%
[rank0]:2025-10-24 03:18:35,845 - INFO - Avg. fwd time: 48.0413 / Avg. bwd time: 61.9038 / Avg. batch time: 2063.7321 (ms) / GPU bubble ratio: 57.38%
[rank1]:2025-10-24 03:21:23,778 - INFO -  step: 480  loss: -4.0000  grad_norm:  0.5022  memory: 20.03GiB(42.17%)  tps: 1,927  tflops: 15.06  mfu: 4.83%
[rank0]:2025-10-24 03:21:23,792 - INFO -  step: 480  loss: -4.0000  grad_norm:  0.5022  memory: 20.89GiB(43.97%)  tps: 1,927  tflops: 15.06  mfu: 4.83%
[rank2]:2025-10-24 03:21:23,773 - INFO -  step: 480  loss: -4.0000  grad_norm:  0.5022  memory: 16.10GiB(33.90%)  tps: 1,927  tflops: 15.06  mfu: 4.83%
[rank3]:2025-10-24 03:21:23,786 - INFO -  step: 480  loss:  0.9295  grad_norm:  0.5022  memory: 38.93GiB(81.95%)  tps: 1,927  tflops: 15.06  mfu: 4.83%
[rank3]:2025-10-24 03:21:25,717 - INFO - Avg. fwd time: 76.5080 / Avg. bwd time: 135.9181 / Avg. batch time: 1749.0829 (ms) / GPU bubble ratio: 2.84%
[rank2]:2025-10-24 03:21:25,781 - INFO - Avg. fwd time: 35.0022 / Avg. bwd time: 55.3728 / Avg. batch time: 1841.4184 (ms) / GPU bubble ratio: 60.74%
[rank1]:2025-10-24 03:21:25,855 - INFO - Avg. fwd time: 55.2019 / Avg. bwd time: 74.4092 / Avg. batch time: 1964.6073 (ms) / GPU bubble ratio: 47.22%
[rank0]:2025-10-24 03:21:25,927 - INFO - Avg. fwd time: 48.0410 / Avg. bwd time: 61.9050 / Avg. batch time: 2064.2556 (ms) / GPU bubble ratio: 57.39%
[rank3]:2025-10-24 03:23:19,982 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-24 03:23:20,728 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-24 03:23:20,800 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 03:23:20,866 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 03:24:05,544 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-24 03:24:14,109 - INFO -  step: 500  loss:  0.8696  grad_norm:  0.4622  memory: 38.93GiB(81.95%)  tps: 1,924  tflops: 15.04  mfu: 4.82%
[rank3]:2025-10-24 03:24:14,110 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-24 03:24:14,116 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.4622  memory: 20.89GiB(43.97%)  tps: 1,924  tflops: 15.04  mfu: 4.82%
[rank0]:2025-10-24 03:24:14,117 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-24 03:24:14,117 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank2]:2025-10-24 03:24:14,097 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.4622  memory: 16.10GiB(33.90%)  tps: 1,924  tflops: 15.04  mfu: 4.82%
[rank2]:2025-10-24 03:24:14,097 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-24 03:24:14,102 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.4622  memory: 20.03GiB(42.17%)  tps: 1,924  tflops: 15.04  mfu: 4.82%
[rank1]:2025-10-24 03:24:14,102 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-24 03:24:15,988 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 1.89 seconds.
[rank2]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /data2/shcho/torchtitan/checkpoint/1023_GPipe_nofreeze_dm1/step-500, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank2]:  warnings.warn(
[rank1]:2025-10-24 03:24:16,466 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 2.36 seconds.
[rank1]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /data2/shcho/torchtitan/checkpoint/1023_GPipe_nofreeze_dm1/step-500, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank1]:  warnings.warn(
[rank3]:2025-10-24 03:24:17,876 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.77 seconds.
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /data2/shcho/torchtitan/checkpoint/1023_GPipe_nofreeze_dm1/step-500, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank3]:  warnings.warn(
[rank0]:2025-10-24 03:24:18,378 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-24 03:24:18,385 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 4.27 seconds.
[rank0]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /data2/shcho/torchtitan/checkpoint/1023_GPipe_nofreeze_dm1/step-500, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank0]:  warnings.warn(
[rank3]:2025-10-24 03:24:18,655 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_nofreeze_dm1/pipeline_schedule/251024_0324_real_step500_rank3.svg
[rank3]:> Batch Time: 2012.56 ms, GPU Bubble Ratio: 56.20%, 48.09%, 64.41%, 15.47%
[rank3]:2025-10-24 03:24:20,434 - INFO - Avg. fwd time: 76.5615 / Avg. bwd time: 135.9392 / Avg. batch time: 1749.5657 (ms) / GPU bubble ratio: 2.83%
[rank2]:2025-10-24 03:24:20,493 - INFO - Avg. fwd time: 34.9981 / Avg. bwd time: 55.3711 / Avg. batch time: 1841.9745 (ms) / GPU bubble ratio: 60.75%
[rank1]:2025-10-24 03:24:20,571 - INFO - Avg. fwd time: 55.1631 / Avg. bwd time: 74.4395 / Avg. batch time: 1965.1999 (ms) / GPU bubble ratio: 47.24%
[rank0]:2025-10-24 03:24:20,636 - INFO - Avg. fwd time: 48.0468 / Avg. bwd time: 61.9105 / Avg. batch time: 2064.9032 (ms) / GPU bubble ratio: 57.40%
[rank2]:2025-10-24 03:27:08,199 - INFO -  step: 520  loss: -4.0000  grad_norm:  0.4937  memory: 16.10GiB(33.90%)  tps: 1,882  tflops: 14.71  mfu: 4.72%
[rank1]:2025-10-24 03:27:08,203 - INFO -  step: 520  loss: -4.0000  grad_norm:  0.4937  memory: 20.03GiB(42.17%)  tps: 1,882  tflops: 14.71  mfu: 4.72%
[rank3]:2025-10-24 03:27:08,211 - INFO -  step: 520  loss:  0.8856  grad_norm:  0.4937  memory: 38.93GiB(81.95%)  tps: 1,882  tflops: 14.71  mfu: 4.72%
[rank0]:2025-10-24 03:27:08,220 - INFO -  step: 520  loss: -4.0000  grad_norm:  0.4937  memory: 20.89GiB(43.97%)  tps: 1,882  tflops: 14.71  mfu: 4.72%
[rank3]:2025-10-24 03:27:10,132 - INFO - Avg. fwd time: 76.5838 / Avg. bwd time: 135.9429 / Avg. batch time: 1749.7207 (ms) / GPU bubble ratio: 2.83%
[rank2]:2025-10-24 03:27:10,191 - INFO - Avg. fwd time: 34.9989 / Avg. bwd time: 55.3686 / Avg. batch time: 1842.1264 (ms) / GPU bubble ratio: 60.76%
[rank1]:2025-10-24 03:27:10,272 - INFO - Avg. fwd time: 55.1413 / Avg. bwd time: 74.4590 / Avg. batch time: 1965.3450 (ms) / GPU bubble ratio: 47.25%
[rank0]:2025-10-24 03:27:10,337 - INFO - Avg. fwd time: 48.0421 / Avg. bwd time: 61.9050 / Avg. batch time: 2065.0643 (ms) / GPU bubble ratio: 57.41%
[rank2]:2025-10-24 03:29:57,026 - INFO -  step: 540  loss: -4.0000  grad_norm:  0.5277  memory: 16.10GiB(33.90%)  tps: 1,941  tflops: 15.17  mfu: 4.86%
[rank3]:2025-10-24 03:29:57,038 - INFO -  step: 540  loss:  0.8720  grad_norm:  0.5277  memory: 38.93GiB(81.95%)  tps: 1,941  tflops: 15.17  mfu: 4.86%
[rank1]:2025-10-24 03:29:57,037 - INFO -  step: 540  loss: -4.0000  grad_norm:  0.5277  memory: 20.03GiB(42.17%)  tps: 1,941  tflops: 15.17  mfu: 4.86%
[rank0]:2025-10-24 03:29:57,050 - INFO -  step: 540  loss: -4.0000  grad_norm:  0.5277  memory: 20.89GiB(43.97%)  tps: 1,941  tflops: 15.17  mfu: 4.86%
[rank3]:2025-10-24 03:29:58,946 - INFO - Avg. fwd time: 76.5799 / Avg. bwd time: 135.9404 / Avg. batch time: 1749.5682 (ms) / GPU bubble ratio: 2.82%
[rank2]:2025-10-24 03:29:59,007 - INFO - Avg. fwd time: 35.0009 / Avg. bwd time: 55.3768 / Avg. batch time: 1841.9580 (ms) / GPU bubble ratio: 60.75%
[rank1]:2025-10-24 03:29:59,081 - INFO - Avg. fwd time: 55.1101 / Avg. bwd time: 74.4820 / Avg. batch time: 1965.1677 (ms) / GPU bubble ratio: 47.24%
[rank0]:2025-10-24 03:29:59,150 - INFO - Avg. fwd time: 48.0324 / Avg. bwd time: 61.8998 / Avg. batch time: 2064.8584 (ms) / GPU bubble ratio: 57.41%
[rank0]:2025-10-24 03:31:13,494 - INFO - [GC] Peforming periodical GC collection 0.25 seconds
[rank0]:2025-10-24 03:32:46,634 - INFO -  step: 560  loss: -4.0000  grad_norm:  0.5368  memory: 20.89GiB(43.97%)  tps: 1,932  tflops: 15.11  mfu: 4.84%
[rank2]:2025-10-24 03:32:46,613 - INFO -  step: 560  loss: -4.0000  grad_norm:  0.5368  memory: 16.10GiB(33.90%)  tps: 1,932  tflops: 15.11  mfu: 4.84%
[rank3]:2025-10-24 03:32:46,625 - INFO -  step: 560  loss:  0.8819  grad_norm:  0.5368  memory: 38.93GiB(81.95%)  tps: 1,932  tflops: 15.11  mfu: 4.84%
[rank1]:2025-10-24 03:32:46,618 - INFO -  step: 560  loss: -4.0000  grad_norm:  0.5368  memory: 20.03GiB(42.17%)  tps: 1,932  tflops: 15.11  mfu: 4.84%
[rank3]:2025-10-24 03:32:48,558 - INFO - Avg. fwd time: 76.5903 / Avg. bwd time: 135.9509 / Avg. batch time: 1749.6467 (ms) / GPU bubble ratio: 2.82%
[rank2]:2025-10-24 03:32:48,622 - INFO - Avg. fwd time: 35.0085 / Avg. bwd time: 55.3828 / Avg. batch time: 1842.0242 (ms) / GPU bubble ratio: 60.74%
[rank1]:2025-10-24 03:32:48,703 - INFO - Avg. fwd time: 55.0760 / Avg. bwd time: 74.5023 / Avg. batch time: 1965.2280 (ms) / GPU bubble ratio: 47.25%
[rank0]:2025-10-24 03:32:48,768 - INFO - Avg. fwd time: 48.0254 / Avg. bwd time: 61.9017 / Avg. batch time: 2064.9020 (ms) / GPU bubble ratio: 57.41%
[rank3]:2025-10-24 03:35:01,500 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-24 03:35:02,156 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-24 03:35:02,238 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 03:35:02,302 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 03:35:36,155 - INFO -  step: 580  loss: -4.0000  grad_norm:  0.5301  memory: 20.89GiB(43.97%)  tps: 1,933  tflops: 15.11  mfu: 4.84%
[rank3]:2025-10-24 03:35:36,142 - INFO -  step: 580  loss:  0.8233  grad_norm:  0.5301  memory: 38.93GiB(81.95%)  tps: 1,933  tflops: 15.11  mfu: 4.84%
[rank2]:2025-10-24 03:35:36,129 - INFO -  step: 580  loss: -4.0000  grad_norm:  0.5301  memory: 16.10GiB(33.90%)  tps: 1,933  tflops: 15.11  mfu: 4.84%
[rank1]:2025-10-24 03:35:36,133 - INFO -  step: 580  loss: -4.0000  grad_norm:  0.5301  memory: 20.03GiB(42.17%)  tps: 1,933  tflops: 15.11  mfu: 4.84%
[rank3]:2025-10-24 03:35:38,058 - INFO - Avg. fwd time: 76.6125 / Avg. bwd time: 135.9570 / Avg. batch time: 1749.7888 (ms) / GPU bubble ratio: 2.81%
[rank2]:2025-10-24 03:35:38,124 - INFO - Avg. fwd time: 35.0069 / Avg. bwd time: 55.3780 / Avg. batch time: 1842.1460 (ms) / GPU bubble ratio: 60.75%
[rank1]:2025-10-24 03:35:38,199 - INFO - Avg. fwd time: 55.0501 / Avg. bwd time: 74.5245 / Avg. batch time: 1965.3408 (ms) / GPU bubble ratio: 47.26%
[rank0]:2025-10-24 03:35:38,268 - INFO - Avg. fwd time: 48.0300 / Avg. bwd time: 61.9069 / Avg. batch time: 2065.0380 (ms) / GPU bubble ratio: 57.41%
[rank0]:2025-10-24 03:38:16,578 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-24 03:38:25,069 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.5372  memory: 20.89GiB(43.97%)  tps: 1,940  tflops: 15.17  mfu: 4.86%
[rank2]:2025-10-24 03:38:25,049 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.5372  memory: 16.10GiB(33.90%)  tps: 1,940  tflops: 15.16  mfu: 4.86%
[rank3]:2025-10-24 03:38:25,062 - INFO -  step: 600  loss:  0.8350  grad_norm:  0.5372  memory: 38.93GiB(81.95%)  tps: 1,940  tflops: 15.17  mfu: 4.86%
[rank1]:2025-10-24 03:38:25,053 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.5372  memory: 20.03GiB(42.17%)  tps: 1,940  tflops: 15.16  mfu: 4.86%
[rank3]:2025-10-24 03:38:25,321 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_nofreeze_dm1/pipeline_schedule/251024_0338_real_step600_rank3.svg
[rank3]:> Batch Time: 2012.38 ms, GPU Bubble Ratio: 56.19%, 48.09%, 64.39%, 15.43%
[rank3]:2025-10-24 03:38:27,128 - INFO - Avg. fwd time: 76.6062 / Avg. bwd time: 135.9605 / Avg. batch time: 1749.7210 (ms) / GPU bubble ratio: 2.81%
[rank2]:2025-10-24 03:38:27,194 - INFO - Avg. fwd time: 35.0125 / Avg. bwd time: 55.3859 / Avg. batch time: 1842.1292 (ms) / GPU bubble ratio: 60.74%
[rank1]:2025-10-24 03:38:27,267 - INFO - Avg. fwd time: 55.0264 / Avg. bwd time: 74.5448 / Avg. batch time: 1965.3046 (ms) / GPU bubble ratio: 47.26%
[rank0]:2025-10-24 03:38:27,335 - INFO - Avg. fwd time: 48.0346 / Avg. bwd time: 61.9037 / Avg. batch time: 2064.9987 (ms) / GPU bubble ratio: 57.41%
[rank3]:2025-10-24 03:41:14,533 - INFO -  step: 620  loss:  0.8361  grad_norm:  0.5300  memory: 38.93GiB(81.95%)  tps: 1,934  tflops: 15.12  mfu: 4.84%
[rank2]:2025-10-24 03:41:14,521 - INFO -  step: 620  loss: -4.0000  grad_norm:  0.5300  memory: 16.10GiB(33.90%)  tps: 1,934  tflops: 15.12  mfu: 4.84%
[rank1]:2025-10-24 03:41:14,527 - INFO -  step: 620  loss: -4.0000  grad_norm:  0.5300  memory: 20.03GiB(42.17%)  tps: 1,934  tflops: 15.12  mfu: 4.84%
[rank0]:2025-10-24 03:41:14,540 - INFO -  step: 620  loss: -4.0000  grad_norm:  0.5300  memory: 20.89GiB(43.97%)  tps: 1,934  tflops: 15.12  mfu: 4.84%
[rank3]:2025-10-24 03:41:16,458 - INFO - Avg. fwd time: 76.6150 / Avg. bwd time: 135.9687 / Avg. batch time: 1749.7842 (ms) / GPU bubble ratio: 2.81%
[rank2]:2025-10-24 03:41:16,518 - INFO - Avg. fwd time: 35.0172 / Avg. bwd time: 55.3877 / Avg. batch time: 1842.1772 (ms) / GPU bubble ratio: 60.74%
[rank1]:2025-10-24 03:41:16,601 - INFO - Avg. fwd time: 55.0087 / Avg. bwd time: 74.5584 / Avg. batch time: 1965.3549 (ms) / GPU bubble ratio: 47.26%
[rank0]:2025-10-24 03:41:16,672 - INFO - Avg. fwd time: 48.0356 / Avg. bwd time: 61.9032 / Avg. batch time: 2065.0553 (ms) / GPU bubble ratio: 57.41%
[rank3]:2025-10-24 03:44:03,848 - INFO -  step: 640  loss:  0.8081  grad_norm:  0.5454  memory: 38.93GiB(81.95%)  tps: 1,935  tflops: 15.13  mfu: 4.85%
[rank1]:2025-10-24 03:44:03,840 - INFO -  step: 640  loss: -4.0000  grad_norm:  0.5454  memory: 20.03GiB(42.17%)  tps: 1,935  tflops: 15.13  mfu: 4.85%
[rank2]:2025-10-24 03:44:03,836 - INFO -  step: 640  loss: -4.0000  grad_norm:  0.5454  memory: 16.10GiB(33.90%)  tps: 1,935  tflops: 15.13  mfu: 4.85%
[rank0]:2025-10-24 03:44:03,860 - INFO -  step: 640  loss: -4.0000  grad_norm:  0.5454  memory: 20.89GiB(43.97%)  tps: 1,935  tflops: 15.13  mfu: 4.85%
[rank3]:2025-10-24 03:44:05,741 - INFO - Avg. fwd time: 76.6179 / Avg. bwd time: 135.9833 / Avg. batch time: 1749.8719 (ms) / GPU bubble ratio: 2.80%
[rank2]:2025-10-24 03:44:05,801 - INFO - Avg. fwd time: 35.0248 / Avg. bwd time: 55.3923 / Avg. batch time: 1842.2608 (ms) / GPU bubble ratio: 60.74%
[rank1]:2025-10-24 03:44:05,879 - INFO - Avg. fwd time: 54.9950 / Avg. bwd time: 74.5638 / Avg. batch time: 1965.3935 (ms) / GPU bubble ratio: 47.26%
[rank0]:2025-10-24 03:44:05,945 - INFO - Avg. fwd time: 48.0333 / Avg. bwd time: 61.9081 / Avg. batch time: 2065.0972 (ms) / GPU bubble ratio: 57.41%
[rank0]:2025-10-24 03:45:20,100 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-24 03:46:39,686 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-24 03:46:40,436 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-24 03:46:40,518 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 03:46:40,581 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-24 03:46:53,298 - INFO -  step: 660  loss: -4.0000  grad_norm:  0.5381  memory: 20.03GiB(42.17%)  tps: 1,934  tflops: 15.12  mfu: 4.85%
[rank2]:2025-10-24 03:46:53,294 - INFO -  step: 660  loss: -4.0000  grad_norm:  0.5381  memory: 16.10GiB(33.90%)  tps: 1,934  tflops: 15.12  mfu: 4.85%
[rank0]:2025-10-24 03:46:53,314 - INFO -  step: 660  loss: -4.0000  grad_norm:  0.5381  memory: 20.89GiB(43.97%)  tps: 1,934  tflops: 15.12  mfu: 4.85%
[rank3]:2025-10-24 03:46:53,306 - INFO -  step: 660  loss:  0.7857  grad_norm:  0.5381  memory: 38.93GiB(81.95%)  tps: 1,934  tflops: 15.12  mfu: 4.85%
[rank3]:2025-10-24 03:46:55,242 - INFO - Avg. fwd time: 76.6349 / Avg. bwd time: 135.9972 / Avg. batch time: 1750.0497 (ms) / GPU bubble ratio: 2.80%
[rank2]:2025-10-24 03:46:55,307 - INFO - Avg. fwd time: 35.0287 / Avg. bwd time: 55.4003 / Avg. batch time: 1842.4324 (ms) / GPU bubble ratio: 60.73%
[rank1]:2025-10-24 03:46:55,382 - INFO - Avg. fwd time: 54.9761 / Avg. bwd time: 74.5780 / Avg. batch time: 1965.5069 (ms) / GPU bubble ratio: 47.27%
[rank0]:2025-10-24 03:46:55,455 - INFO - Avg. fwd time: 48.0374 / Avg. bwd time: 61.9094 / Avg. batch time: 2065.2175 (ms) / GPU bubble ratio: 57.41%
[rank1]:2025-10-24 03:49:42,947 - INFO -  step: 680  loss: -4.0000  grad_norm:  0.5879  memory: 20.03GiB(42.17%)  tps: 1,932  tflops: 15.10  mfu: 4.84%
[rank2]:2025-10-24 03:49:42,944 - INFO -  step: 680  loss: -4.0000  grad_norm:  0.5879  memory: 16.10GiB(33.90%)  tps: 1,932  tflops: 15.10  mfu: 4.84%
[rank0]:2025-10-24 03:49:42,969 - INFO -  step: 680  loss: -4.0000  grad_norm:  0.5879  memory: 20.89GiB(43.97%)  tps: 1,931  tflops: 15.10  mfu: 4.84%
[rank3]:2025-10-24 03:49:42,956 - INFO -  step: 680  loss:  0.7831  grad_norm:  0.5879  memory: 38.93GiB(81.95%)  tps: 1,932  tflops: 15.10  mfu: 4.84%
[rank3]:2025-10-24 03:49:44,871 - INFO - Avg. fwd time: 76.6423 / Avg. bwd time: 136.0107 / Avg. batch time: 1750.1969 (ms) / GPU bubble ratio: 2.80%
[rank2]:2025-10-24 03:49:44,937 - INFO - Avg. fwd time: 35.0364 / Avg. bwd time: 55.4069 / Avg. batch time: 1842.5827 (ms) / GPU bubble ratio: 60.73%
[rank1]:2025-10-24 03:49:45,020 - INFO - Avg. fwd time: 54.9714 / Avg. bwd time: 74.5890 / Avg. batch time: 1965.6490 (ms) / GPU bubble ratio: 47.27%
[rank0]:2025-10-24 03:49:45,090 - INFO - Avg. fwd time: 48.0309 / Avg. bwd time: 61.9122 / Avg. batch time: 2065.3654 (ms) / GPU bubble ratio: 57.41%
[rank0]:2025-10-24 03:52:23,137 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-24 03:52:31,591 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.5582  memory: 16.10GiB(33.90%)  tps: 1,943  tflops: 15.19  mfu: 4.87%
[rank0]:2025-10-24 03:52:31,616 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.5582  memory: 20.89GiB(43.97%)  tps: 1,943  tflops: 15.19  mfu: 4.87%
[rank3]:2025-10-24 03:52:31,604 - INFO -  step: 700  loss:  0.7843  grad_norm:  0.5582  memory: 38.93GiB(81.95%)  tps: 1,943  tflops: 15.19  mfu: 4.87%
[rank1]:2025-10-24 03:52:31,595 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.5582  memory: 20.03GiB(42.17%)  tps: 1,943  tflops: 15.19  mfu: 4.87%
[rank3]:2025-10-24 03:52:31,863 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_nofreeze_dm1/pipeline_schedule/251024_0352_real_step700_rank3.svg
[rank3]:> Batch Time: 2011.50 ms, GPU Bubble Ratio: 56.16%, 48.09%, 64.35%, 15.41%
[rank3]:2025-10-24 03:52:33,643 - INFO - Avg. fwd time: 76.6336 / Avg. bwd time: 136.0069 / Avg. batch time: 1750.0454 (ms) / GPU bubble ratio: 2.80%
[rank2]:2025-10-24 03:52:33,709 - INFO - Avg. fwd time: 35.0429 / Avg. bwd time: 55.4090 / Avg. batch time: 1842.4646 (ms) / GPU bubble ratio: 60.73%
[rank1]:2025-10-24 03:52:33,786 - INFO - Avg. fwd time: 54.9395 / Avg. bwd time: 74.5928 / Avg. batch time: 1965.4907 (ms) / GPU bubble ratio: 47.28%
[rank0]:2025-10-24 03:52:33,851 - INFO - Avg. fwd time: 48.0322 / Avg. bwd time: 61.9059 / Avg. batch time: 2065.1839 (ms) / GPU bubble ratio: 57.41%
[rank3]:2025-10-24 03:55:20,771 - INFO -  step: 720  loss:  0.7699  grad_norm:  0.5709  memory: 38.93GiB(81.95%)  tps: 1,937  tflops: 15.14  mfu: 4.85%
[rank1]:2025-10-24 03:55:20,763 - INFO -  step: 720  loss: -4.0000  grad_norm:  0.5709  memory: 20.03GiB(42.17%)  tps: 1,937  tflops: 15.14  mfu: 4.85%
[rank2]:2025-10-24 03:55:20,758 - INFO -  step: 720  loss: -4.0000  grad_norm:  0.5709  memory: 16.10GiB(33.90%)  tps: 1,937  tflops: 15.14  mfu: 4.85%
[rank0]:2025-10-24 03:55:20,777 - INFO -  step: 720  loss: -4.0000  grad_norm:  0.5709  memory: 20.89GiB(43.97%)  tps: 1,937  tflops: 15.14  mfu: 4.85%
[rank3]:2025-10-24 03:55:22,696 - INFO - Avg. fwd time: 76.6368 / Avg. bwd time: 136.0060 / Avg. batch time: 1750.0150 (ms) / GPU bubble ratio: 2.79%
[rank2]:2025-10-24 03:55:22,758 - INFO - Avg. fwd time: 35.0457 / Avg. bwd time: 55.4092 / Avg. batch time: 1842.4106 (ms) / GPU bubble ratio: 60.72%
[rank1]:2025-10-24 03:55:22,838 - INFO - Avg. fwd time: 54.9194 / Avg. bwd time: 74.6029 / Avg. batch time: 1965.4359 (ms) / GPU bubble ratio: 47.28%
[rank0]:2025-10-24 03:55:22,903 - INFO - Avg. fwd time: 48.0371 / Avg. bwd time: 61.9111 / Avg. batch time: 2065.1417 (ms) / GPU bubble ratio: 57.41%
[rank1]:2025-10-24 03:58:09,740 - INFO -  step: 740  loss: -4.0000  grad_norm:  0.5939  memory: 20.03GiB(42.17%)  tps: 1,939  tflops: 15.16  mfu: 4.86%
[rank2]:2025-10-24 03:58:09,736 - INFO -  step: 740  loss: -4.0000  grad_norm:  0.5939  memory: 16.10GiB(33.90%)  tps: 1,939  tflops: 15.16  mfu: 4.86%
[rank0]:2025-10-24 03:58:09,756 - INFO -  step: 740  loss: -4.0000  grad_norm:  0.5939  memory: 20.89GiB(43.97%)  tps: 1,939  tflops: 15.16  mfu: 4.86%
[rank3]:2025-10-24 03:58:09,749 - INFO -  step: 740  loss:  0.7596  grad_norm:  0.5939  memory: 38.93GiB(81.95%)  tps: 1,939  tflops: 15.16  mfu: 4.86%
[rank3]:2025-10-24 03:58:11,657 - INFO - Avg. fwd time: 76.6326 / Avg. bwd time: 136.0119 / Avg. batch time: 1749.9839 (ms) / GPU bubble ratio: 2.79%
[rank2]:2025-10-24 03:58:11,722 - INFO - Avg. fwd time: 35.0567 / Avg. bwd time: 55.4140 / Avg. batch time: 1842.3702 (ms) / GPU bubble ratio: 60.72%
[rank1]:2025-10-24 03:58:11,796 - INFO - Avg. fwd time: 54.9154 / Avg. bwd time: 74.6060 / Avg. batch time: 1965.3670 (ms) / GPU bubble ratio: 47.28%
[rank0]:2025-10-24 03:58:11,867 - INFO - Avg. fwd time: 48.0377 / Avg. bwd time: 61.9092 / Avg. batch time: 2065.0603 (ms) / GPU bubble ratio: 57.41%
[rank3]:2025-10-24 03:58:15,261 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-24 03:58:16,007 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-24 03:58:16,078 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 03:58:16,139 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 03:59:25,749 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-24 04:00:58,268 - INFO -  step: 760  loss: -4.0000  grad_norm:  0.6630  memory: 20.03GiB(42.17%)  tps: 1,944  tflops: 15.20  mfu: 4.87%
[rank2]:2025-10-24 04:00:58,263 - INFO -  step: 760  loss: -4.0000  grad_norm:  0.6630  memory: 16.10GiB(33.90%)  tps: 1,944  tflops: 15.20  mfu: 4.87%
[rank0]:2025-10-24 04:00:58,277 - INFO -  step: 760  loss: -4.0000  grad_norm:  0.6630  memory: 20.89GiB(43.97%)  tps: 1,944  tflops: 15.20  mfu: 4.87%
[rank3]:2025-10-24 04:00:58,275 - INFO -  step: 760  loss:  0.7427  grad_norm:  0.6630  memory: 38.93GiB(81.95%)  tps: 1,944  tflops: 15.20  mfu: 4.87%
[rank3]:2025-10-24 04:01:00,192 - INFO - Avg. fwd time: 76.6203 / Avg. bwd time: 136.0091 / Avg. batch time: 1749.8291 (ms) / GPU bubble ratio: 2.79%
[rank2]:2025-10-24 04:01:00,254 - INFO - Avg. fwd time: 35.0604 / Avg. bwd time: 55.4157 / Avg. batch time: 1842.2087 (ms) / GPU bubble ratio: 60.71%
[rank1]:2025-10-24 04:01:00,333 - INFO - Avg. fwd time: 54.9102 / Avg. bwd time: 74.6139 / Avg. batch time: 1965.1794 (ms) / GPU bubble ratio: 47.27%
[rank0]:2025-10-24 04:01:00,407 - INFO - Avg. fwd time: 48.0406 / Avg. bwd time: 61.9104 / Avg. batch time: 2064.8654 (ms) / GPU bubble ratio: 57.40%
[rank3]:2025-10-24 04:03:47,153 - INFO -  step: 780  loss:  0.7347  grad_norm:  0.6286  memory: 38.93GiB(81.95%)  tps: 1,940  tflops: 15.17  mfu: 4.86%
[rank1]:2025-10-24 04:03:47,144 - INFO -  step: 780  loss: -4.0000  grad_norm:  0.6286  memory: 20.03GiB(42.17%)  tps: 1,940  tflops: 15.17  mfu: 4.86%
[rank2]:2025-10-24 04:03:47,141 - INFO -  step: 780  loss: -4.0000  grad_norm:  0.6286  memory: 16.10GiB(33.90%)  tps: 1,940  tflops: 15.17  mfu: 4.86%
[rank0]:2025-10-24 04:03:47,161 - INFO -  step: 780  loss: -4.0000  grad_norm:  0.6286  memory: 20.89GiB(43.97%)  tps: 1,940  tflops: 15.17  mfu: 4.86%
[rank3]:2025-10-24 04:03:49,087 - INFO - Avg. fwd time: 76.6147 / Avg. bwd time: 136.0117 / Avg. batch time: 1749.7851 (ms) / GPU bubble ratio: 2.79%
[rank2]:2025-10-24 04:03:49,151 - INFO - Avg. fwd time: 35.0638 / Avg. bwd time: 55.4200 / Avg. batch time: 1842.1676 (ms) / GPU bubble ratio: 60.71%
[rank1]:2025-10-24 04:03:49,226 - INFO - Avg. fwd time: 54.9014 / Avg. bwd time: 74.6203 / Avg. batch time: 1965.0914 (ms) / GPU bubble ratio: 47.27%
[rank0]:2025-10-24 04:03:49,299 - INFO - Avg. fwd time: 48.0416 / Avg. bwd time: 61.9118 / Avg. batch time: 2064.7694 (ms) / GPU bubble ratio: 57.40%
[rank0]:2025-10-24 04:06:27,839 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-24 04:06:36,268 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.5744  memory: 20.03GiB(42.17%)  tps: 1,938  tflops: 15.15  mfu: 4.85%
[rank3]:2025-10-24 04:06:36,275 - INFO -  step: 800  loss:  0.7158  grad_norm:  0.5744  memory: 38.93GiB(81.95%)  tps: 1,938  tflops: 15.15  mfu: 4.85%
[rank0]:2025-10-24 04:06:36,283 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.5744  memory: 20.89GiB(43.97%)  tps: 1,938  tflops: 15.15  mfu: 4.85%
[rank2]:2025-10-24 04:06:36,262 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.5744  memory: 16.10GiB(33.90%)  tps: 1,938  tflops: 15.15  mfu: 4.85%
[rank3]:2025-10-24 04:06:36,529 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_nofreeze_dm1/pipeline_schedule/251024_0406_real_step800_rank3.svg
[rank3]:> Batch Time: 2009.25 ms, GPU Bubble Ratio: 56.11%, 48.06%, 64.31%, 15.38%
[rank3]:2025-10-24 04:06:38,329 - INFO - Avg. fwd time: 76.6178 / Avg. bwd time: 136.0164 / Avg. batch time: 1749.8129 (ms) / GPU bubble ratio: 2.79%
[rank2]:2025-10-24 04:06:38,390 - INFO - Avg. fwd time: 35.0670 / Avg. bwd time: 55.4219 / Avg. batch time: 1842.2246 (ms) / GPU bubble ratio: 60.70%
[rank1]:2025-10-24 04:06:38,467 - INFO - Avg. fwd time: 54.8968 / Avg. bwd time: 74.6454 / Avg. batch time: 1965.1305 (ms) / GPU bubble ratio: 47.26%
[rank0]:2025-10-24 04:06:38,540 - INFO - Avg. fwd time: 48.0437 / Avg. bwd time: 61.9139 / Avg. batch time: 2064.7896 (ms) / GPU bubble ratio: 57.40%
[rank1]:2025-10-24 04:09:25,195 - INFO -  step: 820  loss: -4.0000  grad_norm:  0.6431  memory: 20.03GiB(42.17%)  tps: 1,940  tflops: 15.16  mfu: 4.86%
[rank3]:2025-10-24 04:09:25,202 - INFO -  step: 820  loss:  0.7319  grad_norm:  0.6431  memory: 38.93GiB(81.95%)  tps: 1,940  tflops: 15.16  mfu: 4.86%
[rank2]:2025-10-24 04:09:25,190 - INFO -  step: 820  loss: -4.0000  grad_norm:  0.6431  memory: 16.10GiB(33.90%)  tps: 1,940  tflops: 15.16  mfu: 4.86%
[rank0]:2025-10-24 04:09:25,211 - INFO -  step: 820  loss: -4.0000  grad_norm:  0.6431  memory: 20.89GiB(43.97%)  tps: 1,940  tflops: 15.16  mfu: 4.86%
[rank3]:2025-10-24 04:09:27,138 - INFO - Avg. fwd time: 76.6125 / Avg. bwd time: 136.0150 / Avg. batch time: 1749.7150 (ms) / GPU bubble ratio: 2.78%
[rank2]:2025-10-24 04:09:27,203 - INFO - Avg. fwd time: 35.0706 / Avg. bwd time: 55.4231 / Avg. batch time: 1842.1253 (ms) / GPU bubble ratio: 60.70%
[rank1]:2025-10-24 04:09:27,282 - INFO - Avg. fwd time: 54.8935 / Avg. bwd time: 74.6488 / Avg. batch time: 1965.0078 (ms) / GPU bubble ratio: 47.26%
[rank0]:2025-10-24 04:09:27,348 - INFO - Avg. fwd time: 48.0418 / Avg. bwd time: 61.9134 / Avg. batch time: 2064.6481 (ms) / GPU bubble ratio: 57.40%
[rank3]:2025-10-24 04:09:49,762 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-24 04:09:50,418 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-24 04:09:50,498 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 04:09:50,561 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-24 04:12:14,323 - INFO -  step: 840  loss: -4.0000  grad_norm:  0.6891  memory: 20.03GiB(42.17%)  tps: 1,937  tflops: 15.15  mfu: 4.85%
[rank2]:2025-10-24 04:12:14,319 - INFO -  step: 840  loss: -4.0000  grad_norm:  0.6891  memory: 16.10GiB(33.90%)  tps: 1,937  tflops: 15.15  mfu: 4.85%
[rank3]:2025-10-24 04:12:14,331 - INFO -  step: 840  loss:  0.6925  grad_norm:  0.6891  memory: 38.93GiB(81.95%)  tps: 1,937  tflops: 15.15  mfu: 4.85%
[rank0]:2025-10-24 04:12:14,337 - INFO -  step: 840  loss: -4.0000  grad_norm:  0.6891  memory: 20.89GiB(43.97%)  tps: 1,938  tflops: 15.15  mfu: 4.85%
[rank3]:2025-10-24 04:12:16,268 - INFO - Avg. fwd time: 76.6139 / Avg. bwd time: 136.0214 / Avg. batch time: 1749.7493 (ms) / GPU bubble ratio: 2.78%
[rank2]:2025-10-24 04:12:16,329 - INFO - Avg. fwd time: 35.0741 / Avg. bwd time: 55.4266 / Avg. batch time: 1842.1495 (ms) / GPU bubble ratio: 60.70%
[rank1]:2025-10-24 04:12:16,411 - INFO - Avg. fwd time: 54.8954 / Avg. bwd time: 74.6561 / Avg. batch time: 1965.0026 (ms) / GPU bubble ratio: 47.26%
[rank0]:2025-10-24 04:12:16,477 - INFO - Avg. fwd time: 48.0355 / Avg. bwd time: 61.9132 / Avg. batch time: 2064.6317 (ms) / GPU bubble ratio: 57.40%
[rank0]:2025-10-24 04:13:30,665 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-24 04:15:03,443 - INFO -  step: 860  loss: -4.0000  grad_norm:  0.6669  memory: 16.10GiB(33.90%)  tps: 1,938  tflops: 15.15  mfu: 4.85%
[rank0]:2025-10-24 04:15:03,466 - INFO -  step: 860  loss: -4.0000  grad_norm:  0.6669  memory: 20.89GiB(43.97%)  tps: 1,937  tflops: 15.15  mfu: 4.85%
[rank1]:2025-10-24 04:15:03,447 - INFO -  step: 860  loss: -4.0000  grad_norm:  0.6669  memory: 20.03GiB(42.17%)  tps: 1,938  tflops: 15.15  mfu: 4.85%
[rank3]:2025-10-24 04:15:03,455 - INFO -  step: 860  loss:  0.6821  grad_norm:  0.6669  memory: 38.93GiB(81.95%)  tps: 1,938  tflops: 15.15  mfu: 4.85%
[rank3]:2025-10-24 04:15:05,346 - INFO - Avg. fwd time: 76.6104 / Avg. bwd time: 136.0267 / Avg. batch time: 1749.7244 (ms) / GPU bubble ratio: 2.78%
[rank2]:2025-10-24 04:15:05,412 - INFO - Avg. fwd time: 35.0771 / Avg. bwd time: 55.4268 / Avg. batch time: 1842.1171 (ms) / GPU bubble ratio: 60.70%
[rank1]:2025-10-24 04:15:05,490 - INFO - Avg. fwd time: 54.8874 / Avg. bwd time: 74.6513 / Avg. batch time: 1964.9414 (ms) / GPU bubble ratio: 47.26%
[rank0]:2025-10-24 04:15:05,555 - INFO - Avg. fwd time: 48.0363 / Avg. bwd time: 61.9133 / Avg. batch time: 2064.5696 (ms) / GPU bubble ratio: 57.40%
[rank0]:2025-10-24 04:17:52,067 - INFO -  step: 880  loss: -4.0000  grad_norm:  0.6692  memory: 20.89GiB(43.97%)  tps: 1,944  tflops: 15.19  mfu: 4.87%
[rank2]:2025-10-24 04:17:52,047 - INFO -  step: 880  loss: -4.0000  grad_norm:  0.6692  memory: 16.10GiB(33.90%)  tps: 1,943  tflops: 15.19  mfu: 4.87%
[rank1]:2025-10-24 04:17:52,052 - INFO -  step: 880  loss: -4.0000  grad_norm:  0.6692  memory: 20.03GiB(42.17%)  tps: 1,943  tflops: 15.19  mfu: 4.87%
[rank3]:2025-10-24 04:17:52,060 - INFO -  step: 880  loss:  0.7106  grad_norm:  0.6692  memory: 38.93GiB(81.95%)  tps: 1,944  tflops: 15.19  mfu: 4.87%
[rank3]:2025-10-24 04:17:53,997 - INFO - Avg. fwd time: 76.6020 / Avg. bwd time: 136.0263 / Avg. batch time: 1749.6230 (ms) / GPU bubble ratio: 2.78%
[rank2]:2025-10-24 04:17:54,064 - INFO - Avg. fwd time: 35.0825 / Avg. bwd time: 55.4362 / Avg. batch time: 1842.0101 (ms) / GPU bubble ratio: 60.69%
[rank0]:2025-10-24 04:17:54,211 - INFO - Avg. fwd time: 48.0433 / Avg. bwd time: 61.9251 / Avg. batch time: 2064.4338 (ms) / GPU bubble ratio: 57.39%
[rank1]:2025-10-24 04:17:54,140 - INFO - Avg. fwd time: 54.8779 / Avg. bwd time: 74.6620 / Avg. batch time: 1964.7994 (ms) / GPU bubble ratio: 47.26%
[rank0]:2025-10-24 04:20:32,935 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-24 04:20:41,451 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.6350  memory: 20.03GiB(42.17%)  tps: 1,934  tflops: 15.12  mfu: 4.85%
[rank3]:2025-10-24 04:20:41,459 - INFO -  step: 900  loss:  0.6519  grad_norm:  0.6350  memory: 38.93GiB(81.95%)  tps: 1,934  tflops: 15.12  mfu: 4.85%
[rank0]:2025-10-24 04:20:41,465 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.6350  memory: 20.89GiB(43.97%)  tps: 1,934  tflops: 15.12  mfu: 4.85%
[rank2]:2025-10-24 04:20:41,447 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.6350  memory: 16.10GiB(33.90%)  tps: 1,934  tflops: 15.12  mfu: 4.85%
[rank3]:2025-10-24 04:20:41,718 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_nofreeze_dm1/pipeline_schedule/251024_0420_real_step900_rank3.svg
[rank3]:> Batch Time: 2007.59 ms, GPU Bubble Ratio: 56.07%, 48.06%, 64.26%, 15.32%
[rank3]:2025-10-24 04:20:43,528 - INFO - Avg. fwd time: 76.6040 / Avg. bwd time: 136.0367 / Avg. batch time: 1749.6794 (ms) / GPU bubble ratio: 2.78%
[rank2]:2025-10-24 04:20:43,596 - INFO - Avg. fwd time: 35.0856 / Avg. bwd time: 55.4551 / Avg. batch time: 1842.1254 (ms) / GPU bubble ratio: 60.68%
[rank1]:2025-10-24 04:20:43,677 - INFO - Avg. fwd time: 54.8737 / Avg. bwd time: 74.6659 / Avg. batch time: 1964.8960 (ms) / GPU bubble ratio: 47.26%
[rank0]:2025-10-24 04:20:43,744 - INFO - Avg. fwd time: 48.0436 / Avg. bwd time: 61.9285 / Avg. batch time: 2064.5426 (ms) / GPU bubble ratio: 57.39%
[rank3]:2025-10-24 04:21:25,857 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-24 04:21:25,917 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-24 04:21:26,002 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 04:21:26,063 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-24 04:23:30,682 - INFO -  step: 920  loss: -4.0000  grad_norm:  0.6713  memory: 16.10GiB(33.90%)  tps: 1,936  tflops: 15.14  mfu: 4.85%
[rank1]:2025-10-24 04:23:30,691 - INFO -  step: 920  loss: -4.0000  grad_norm:  0.6713  memory: 20.03GiB(42.17%)  tps: 1,936  tflops: 15.14  mfu: 4.85%
[rank3]:2025-10-24 04:23:30,695 - INFO -  step: 920  loss:  0.6354  grad_norm:  0.6713  memory: 38.93GiB(81.95%)  tps: 1,936  tflops: 15.14  mfu: 4.85%
[rank0]:2025-10-24 04:23:30,697 - INFO -  step: 920  loss: -4.0000  grad_norm:  0.6713  memory: 20.89GiB(43.97%)  tps: 1,936  tflops: 15.14  mfu: 4.85%
[rank3]:2025-10-24 04:23:32,625 - INFO - Avg. fwd time: 76.6021 / Avg. bwd time: 136.0404 / Avg. batch time: 1749.6740 (ms) / GPU bubble ratio: 2.77%
[rank2]:2025-10-24 04:23:32,690 - INFO - Avg. fwd time: 35.0893 / Avg. bwd time: 55.4573 / Avg. batch time: 1842.1065 (ms) / GPU bubble ratio: 60.68%
[rank1]:2025-10-24 04:23:32,765 - INFO - Avg. fwd time: 54.8744 / Avg. bwd time: 74.6773 / Avg. batch time: 1964.8795 (ms) / GPU bubble ratio: 47.25%
[rank0]:2025-10-24 04:23:32,839 - INFO - Avg. fwd time: 48.0453 / Avg. bwd time: 61.9355 / Avg. batch time: 2064.5254 (ms) / GPU bubble ratio: 57.38%
[rank0]:2025-10-24 04:26:19,771 - INFO -  step: 940  loss: -4.0000  grad_norm:  0.6886  memory: 20.89GiB(43.97%)  tps: 1,938  tflops: 15.15  mfu: 4.86%
[rank2]:2025-10-24 04:26:19,751 - INFO -  step: 940  loss: -4.0000  grad_norm:  0.6886  memory: 16.10GiB(33.90%)  tps: 1,938  tflops: 15.15  mfu: 4.86%
[rank1]:2025-10-24 04:26:19,755 - INFO -  step: 940  loss: -4.0000  grad_norm:  0.6886  memory: 20.03GiB(42.17%)  tps: 1,938  tflops: 15.15  mfu: 4.86%
[rank3]:2025-10-24 04:26:19,763 - INFO -  step: 940  loss:  0.6314  grad_norm:  0.6886  memory: 38.93GiB(81.95%)  tps: 1,938  tflops: 15.15  mfu: 4.86%
[rank3]:2025-10-24 04:26:21,706 - INFO - Avg. fwd time: 76.6033 / Avg. bwd time: 136.0455 / Avg. batch time: 1749.6788 (ms) / GPU bubble ratio: 2.77%
[rank2]:2025-10-24 04:26:21,773 - INFO - Avg. fwd time: 35.0925 / Avg. bwd time: 55.4621 / Avg. batch time: 1842.1044 (ms) / GPU bubble ratio: 60.67%
[rank1]:2025-10-24 04:26:21,860 - INFO - Avg. fwd time: 54.8701 / Avg. bwd time: 74.7008 / Avg. batch time: 1964.8666 (ms) / GPU bubble ratio: 47.24%
[rank0]:2025-10-24 04:26:21,931 - INFO - Avg. fwd time: 48.0459 / Avg. bwd time: 61.9366 / Avg. batch time: 2064.5085 (ms) / GPU bubble ratio: 57.38%
[rank0]:2025-10-24 04:27:36,031 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-24 04:29:09,092 - INFO -  step: 960  loss: -4.0000  grad_norm:  0.8823  memory: 20.89GiB(43.97%)  tps: 1,935  tflops: 15.13  mfu: 4.85%
[rank2]:2025-10-24 04:29:09,073 - INFO -  step: 960  loss: -4.0000  grad_norm:  0.8823  memory: 16.10GiB(33.90%)  tps: 1,935  tflops: 15.13  mfu: 4.85%
[rank1]:2025-10-24 04:29:09,077 - INFO -  step: 960  loss: -4.0000  grad_norm:  0.8823  memory: 20.03GiB(42.17%)  tps: 1,935  tflops: 15.13  mfu: 4.85%
[rank3]:2025-10-24 04:29:09,086 - INFO -  step: 960  loss:  0.6348  grad_norm:  0.8823  memory: 38.93GiB(81.95%)  tps: 1,935  tflops: 15.13  mfu: 4.85%
[rank3]:2025-10-24 04:29:11,013 - INFO - Avg. fwd time: 76.6050 / Avg. bwd time: 136.0573 / Avg. batch time: 1749.7599 (ms) / GPU bubble ratio: 2.77%
[rank2]:2025-10-24 04:29:11,080 - INFO - Avg. fwd time: 35.0965 / Avg. bwd time: 55.4665 / Avg. batch time: 1842.1814 (ms) / GPU bubble ratio: 60.67%
[rank1]:2025-10-24 04:29:11,163 - INFO - Avg. fwd time: 54.8632 / Avg. bwd time: 74.7090 / Avg. batch time: 1964.9159 (ms) / GPU bubble ratio: 47.25%
[rank0]:2025-10-24 04:29:11,230 - INFO - Avg. fwd time: 48.0475 / Avg. bwd time: 61.9353 / Avg. batch time: 2064.5519 (ms) / GPU bubble ratio: 57.38%
[rank2]:2025-10-24 04:31:57,458 - INFO -  step: 980  loss: -4.0000  grad_norm:  0.7251  memory: 16.10GiB(33.90%)  tps: 1,946  tflops: 15.21  mfu: 4.88%
[rank1]:2025-10-24 04:31:57,464 - INFO -  step: 980  loss: -4.0000  grad_norm:  0.7251  memory: 20.03GiB(42.17%)  tps: 1,946  tflops: 15.21  mfu: 4.88%
[rank3]:2025-10-24 04:31:57,471 - INFO -  step: 980  loss:  0.6289  grad_norm:  0.7251  memory: 38.93GiB(81.95%)  tps: 1,946  tflops: 15.21  mfu: 4.88%
[rank0]:2025-10-24 04:31:57,479 - INFO -  step: 980  loss: -4.0000  grad_norm:  0.7251  memory: 20.89GiB(43.97%)  tps: 1,946  tflops: 15.21  mfu: 4.88%
[rank3]:2025-10-24 04:31:59,408 - INFO - Avg. fwd time: 76.5898 / Avg. bwd time: 136.0546 / Avg. batch time: 1749.5955 (ms) / GPU bubble ratio: 2.77%
[rank2]:2025-10-24 04:31:59,473 - INFO - Avg. fwd time: 35.1011 / Avg. bwd time: 55.4670 / Avg. batch time: 1842.0021 (ms) / GPU bubble ratio: 60.67%
[rank1]:2025-10-24 04:31:59,550 - INFO - Avg. fwd time: 54.8582 / Avg. bwd time: 74.6986 / Avg. batch time: 1964.7152 (ms) / GPU bubble ratio: 47.25%
[rank0]:2025-10-24 04:31:59,616 - INFO - Avg. fwd time: 48.0514 / Avg. bwd time: 61.9348 / Avg. batch time: 2064.3468 (ms) / GPU bubble ratio: 57.38%
[rank3]:2025-10-24 04:33:02,771 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-24 04:33:02,829 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-24 04:33:02,905 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 04:33:02,967 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 04:34:38,108 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-24 04:34:46,538 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.7240  memory: 20.89GiB(43.97%)  tps: 1,938  tflops: 15.15  mfu: 4.86%
[rank0]:2025-10-24 04:34:46,538 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-24 04:34:46,540 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank1]:2025-10-24 04:34:46,524 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.7240  memory: 20.03GiB(42.17%)  tps: 1,938  tflops: 15.15  mfu: 4.86%
[rank1]:2025-10-24 04:34:46,524 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-24 04:34:46,518 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.7240  memory: 16.10GiB(33.90%)  tps: 1,938  tflops: 15.15  mfu: 4.86%
[rank2]:2025-10-24 04:34:46,519 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-24 04:34:46,531 - INFO -  step: 1000  loss:  0.6266  grad_norm:  0.7240  memory: 38.93GiB(81.95%)  tps: 1,938  tflops: 15.15  mfu: 4.86%
[rank3]:2025-10-24 04:34:46,532 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-24 04:34:48,382 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 1.86 seconds.
[rank1]:2025-10-24 04:34:48,847 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 2.32 seconds.
[rank3]:2025-10-24 04:34:49,846 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.31 seconds.
[rank0]:2025-10-24 04:34:50,658 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-24 04:34:50,665 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 4.13 seconds.
[rank3]:2025-10-24 04:34:51,101 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_nofreeze_dm1/pipeline_schedule/251024_0434_real_step1000_rank3.svg
[rank3]:> Batch Time: 2006.38 ms, GPU Bubble Ratio: 56.05%, 48.01%, 64.23%, 15.26%
[rank3]:2025-10-24 04:34:52,880 - INFO - Avg. fwd time: 76.5908 / Avg. bwd time: 136.0588 / Avg. batch time: 1749.5966 (ms) / GPU bubble ratio: 2.77%
[rank2]:2025-10-24 04:34:52,947 - INFO - Avg. fwd time: 35.1033 / Avg. bwd time: 55.4689 / Avg. batch time: 1842.0712 (ms) / GPU bubble ratio: 60.67%
[rank1]:2025-10-24 04:34:53,028 - INFO - Avg. fwd time: 54.8438 / Avg. bwd time: 74.7068 / Avg. batch time: 1964.7699 (ms) / GPU bubble ratio: 47.25%
[rank0]:2025-10-24 04:34:53,099 - INFO - Avg. fwd time: 48.0553 / Avg. bwd time: 61.9399 / Avg. batch time: 2064.3998 (ms) / GPU bubble ratio: 57.37%
[rank2]:2025-10-24 04:37:39,796 - INFO -  step: 1020  loss: -4.0000  grad_norm:  0.7214  memory: 16.10GiB(33.90%)  tps: 1,891  tflops: 14.78  mfu: 4.74%
[rank3]:2025-10-24 04:37:39,809 - INFO -  step: 1020  loss:  0.5947  grad_norm:  0.7214  memory: 38.93GiB(81.95%)  tps: 1,891  tflops: 14.78  mfu: 4.74%
[rank0]:2025-10-24 04:37:39,816 - INFO -  step: 1020  loss: -4.0000  grad_norm:  0.7214  memory: 20.89GiB(43.97%)  tps: 1,891  tflops: 14.78  mfu: 4.74%
[rank1]:2025-10-24 04:37:39,801 - INFO -  step: 1020  loss: -4.0000  grad_norm:  0.7214  memory: 20.03GiB(42.17%)  tps: 1,891  tflops: 14.78  mfu: 4.74%
[rank3]:2025-10-24 04:37:41,753 - INFO - Avg. fwd time: 76.5830 / Avg. bwd time: 136.0613 / Avg. batch time: 1749.5285 (ms) / GPU bubble ratio: 2.76%
[rank2]:2025-10-24 04:37:41,822 - INFO - Avg. fwd time: 35.1094 / Avg. bwd time: 55.4729 / Avg. batch time: 1842.0012 (ms) / GPU bubble ratio: 60.66%
[rank0]:2025-10-24 04:37:41,980 - INFO - Avg. fwd time: 48.0607 / Avg. bwd time: 61.9388 / Avg. batch time: 2064.3223 (ms) / GPU bubble ratio: 57.37%
[rank1]:2025-10-24 04:37:41,908 - INFO - Avg. fwd time: 54.8314 / Avg. bwd time: 74.7006 / Avg. batch time: 1964.7016 (ms) / GPU bubble ratio: 47.26%
[rank1]:2025-10-24 04:40:29,301 - INFO -  step: 1040  loss: -4.0000  grad_norm:  0.8135  memory: 20.03GiB(42.17%)  tps: 1,933  tflops: 15.11  mfu: 4.84%
[rank2]:2025-10-24 04:40:29,297 - INFO -  step: 1040  loss: -4.0000  grad_norm:  0.8135  memory: 16.10GiB(33.90%)  tps: 1,933  tflops: 15.11  mfu: 4.84%
[rank3]:2025-10-24 04:40:29,310 - INFO -  step: 1040  loss:  0.5842  grad_norm:  0.8135  memory: 38.93GiB(81.95%)  tps: 1,933  tflops: 15.11  mfu: 4.84%
[rank0]:2025-10-24 04:40:29,318 - INFO -  step: 1040  loss: -4.0000  grad_norm:  0.8135  memory: 20.89GiB(43.97%)  tps: 1,933  tflops: 15.11  mfu: 4.84%
[rank3]:2025-10-24 04:40:31,251 - INFO - Avg. fwd time: 76.5856 / Avg. bwd time: 136.0681 / Avg. batch time: 1749.6026 (ms) / GPU bubble ratio: 2.76%
[rank2]:2025-10-24 04:40:31,318 - INFO - Avg. fwd time: 35.1097 / Avg. bwd time: 55.4795 / Avg. batch time: 1842.0781 (ms) / GPU bubble ratio: 60.66%
[rank1]:2025-10-24 04:40:31,404 - INFO - Avg. fwd time: 54.8387 / Avg. bwd time: 74.6977 / Avg. batch time: 1964.7760 (ms) / GPU bubble ratio: 47.26%
[rank0]:2025-10-24 04:40:31,476 - INFO - Avg. fwd time: 48.0583 / Avg. bwd time: 61.9382 / Avg. batch time: 2064.3950 (ms) / GPU bubble ratio: 57.37%
[rank0]:2025-10-24 04:41:45,524 - INFO - [GC] Peforming periodical GC collection 0.25 seconds
[rank2]:2025-10-24 04:43:18,170 - INFO -  step: 1060  loss: -4.0000  grad_norm:  0.7287  memory: 16.10GiB(33.90%)  tps: 1,940  tflops: 15.17  mfu: 4.86%
[rank3]:2025-10-24 04:43:18,182 - INFO -  step: 1060  loss:  0.5767  grad_norm:  0.7287  memory: 38.93GiB(81.95%)  tps: 1,940  tflops: 15.17  mfu: 4.86%
[rank1]:2025-10-24 04:43:18,173 - INFO -  step: 1060  loss: -4.0000  grad_norm:  0.7287  memory: 20.03GiB(42.17%)  tps: 1,940  tflops: 15.17  mfu: 4.86%
[rank0]:2025-10-24 04:43:18,196 - INFO -  step: 1060  loss: -4.0000  grad_norm:  0.7287  memory: 20.89GiB(43.97%)  tps: 1,940  tflops: 15.17  mfu: 4.86%
[rank3]:2025-10-24 04:43:20,094 - INFO - Avg. fwd time: 76.5768 / Avg. bwd time: 136.0662 / Avg. batch time: 1749.4867 (ms) / GPU bubble ratio: 2.76%
[rank2]:2025-10-24 04:43:20,160 - INFO - Avg. fwd time: 35.1124 / Avg. bwd time: 55.4840 / Avg. batch time: 1841.9485 (ms) / GPU bubble ratio: 60.65%
[rank1]:2025-10-24 04:43:20,237 - INFO - Avg. fwd time: 54.8283 / Avg. bwd time: 74.6966 / Avg. batch time: 1964.6361 (ms) / GPU bubble ratio: 47.26%
[rank0]:2025-10-24 04:43:20,311 - INFO - Avg. fwd time: 48.0654 / Avg. bwd time: 61.9381 / Avg. batch time: 2064.2432 (ms) / GPU bubble ratio: 57.37%
[rank3]:2025-10-24 04:44:41,817 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-24 04:44:42,480 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-24 04:44:42,551 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 04:44:42,617 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-24 04:46:07,115 - INFO -  step: 1080  loss: -4.0000  grad_norm:  0.6867  memory: 16.10GiB(33.90%)  tps: 1,940  tflops: 15.16  mfu: 4.86%
[rank3]:2025-10-24 04:46:07,128 - INFO -  step: 1080  loss:  0.5665  grad_norm:  0.6867  memory: 38.93GiB(81.95%)  tps: 1,940  tflops: 15.16  mfu: 4.86%
[rank0]:2025-10-24 04:46:07,134 - INFO -  step: 1080  loss: -4.0000  grad_norm:  0.6867  memory: 20.89GiB(43.97%)  tps: 1,940  tflops: 15.16  mfu: 4.86%
[rank1]:2025-10-24 04:46:07,119 - INFO -  step: 1080  loss: -4.0000  grad_norm:  0.6867  memory: 20.03GiB(42.17%)  tps: 1,940  tflops: 15.16  mfu: 4.86%
[rank3]:2025-10-24 04:46:09,018 - INFO - Avg. fwd time: 76.5719 / Avg. bwd time: 136.0692 / Avg. batch time: 1749.4593 (ms) / GPU bubble ratio: 2.76%
[rank2]:2025-10-24 04:46:09,085 - INFO - Avg. fwd time: 35.1140 / Avg. bwd time: 55.4835 / Avg. batch time: 1841.9060 (ms) / GPU bubble ratio: 60.65%
[rank1]:2025-10-24 04:46:09,175 - INFO - Avg. fwd time: 54.8242 / Avg. bwd time: 74.7028 / Avg. batch time: 1964.5743 (ms) / GPU bubble ratio: 47.25%
[rank0]:2025-10-24 04:46:09,242 - INFO - Avg. fwd time: 48.0661 / Avg. bwd time: 61.9396 / Avg. batch time: 2064.1864 (ms) / GPU bubble ratio: 57.37%
[rank0]:2025-10-24 04:48:47,265 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-24 04:48:55,727 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.7177  memory: 16.10GiB(33.90%)  tps: 1,943  tflops: 15.19  mfu: 4.87%
[rank3]:2025-10-24 04:48:55,740 - INFO -  step: 1100  loss:  0.5684  grad_norm:  0.7177  memory: 38.93GiB(81.95%)  tps: 1,943  tflops: 15.19  mfu: 4.87%
[rank0]:2025-10-24 04:48:55,747 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.7177  memory: 20.89GiB(43.97%)  tps: 1,943  tflops: 15.19  mfu: 4.87%
[rank1]:2025-10-24 04:48:55,731 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.7177  memory: 20.03GiB(42.17%)  tps: 1,943  tflops: 15.19  mfu: 4.87%
[rank3]:2025-10-24 04:48:55,996 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_nofreeze_dm1/pipeline_schedule/251024_0448_real_step1100_rank3.svg
[rank3]:> Batch Time: 2004.94 ms, GPU Bubble Ratio: 56.02%, 48.03%, 64.19%, 15.22%
[rank3]:2025-10-24 04:48:57,808 - INFO - Avg. fwd time: 76.5623 / Avg. bwd time: 136.0711 / Avg. batch time: 1749.3732 (ms) / GPU bubble ratio: 2.76%
[rank2]:2025-10-24 04:48:57,873 - INFO - Avg. fwd time: 35.1148 / Avg. bwd time: 55.4848 / Avg. batch time: 1841.8455 (ms) / GPU bubble ratio: 60.65%
[rank1]:2025-10-24 04:48:57,949 - INFO - Avg. fwd time: 54.8119 / Avg. bwd time: 74.6906 / Avg. batch time: 1964.4859 (ms) / GPU bubble ratio: 47.26%
[rank0]:2025-10-24 04:48:58,022 - INFO - Avg. fwd time: 48.0676 / Avg. bwd time: 61.9408 / Avg. batch time: 2064.0901 (ms) / GPU bubble ratio: 57.36%
[rank1]:2025-10-24 04:51:45,055 - INFO -  step: 1120  loss: -4.0000  grad_norm:  0.7771  memory: 20.03GiB(42.17%)  tps: 1,935  tflops: 15.13  mfu: 4.85%
[rank2]:2025-10-24 04:51:45,050 - INFO -  step: 1120  loss: -4.0000  grad_norm:  0.7771  memory: 16.10GiB(33.90%)  tps: 1,935  tflops: 15.13  mfu: 4.85%
[rank0]:2025-10-24 04:51:45,071 - INFO -  step: 1120  loss: -4.0000  grad_norm:  0.7771  memory: 20.89GiB(43.97%)  tps: 1,935  tflops: 15.13  mfu: 4.85%
[rank3]:2025-10-24 04:51:45,063 - INFO -  step: 1120  loss:  0.5491  grad_norm:  0.7771  memory: 38.93GiB(81.95%)  tps: 1,935  tflops: 15.13  mfu: 4.85%
[rank2]:2025-10-24 04:51:47,069 - INFO - Avg. fwd time: 35.1173 / Avg. bwd time: 55.4848 / Avg. batch time: 1841.8702 (ms) / GPU bubble ratio: 60.65%
[rank3]:2025-10-24 04:51:47,007 - INFO - Avg. fwd time: 76.5656 / Avg. bwd time: 136.0754 / Avg. batch time: 1749.4050 (ms) / GPU bubble ratio: 2.76%
[rank1]:2025-10-24 04:51:47,148 - INFO - Avg. fwd time: 54.8042 / Avg. bwd time: 74.6890 / Avg. batch time: 1964.4970 (ms) / GPU bubble ratio: 47.27%
[rank0]:2025-10-24 04:51:47,221 - INFO - Avg. fwd time: 48.0668 / Avg. bwd time: 61.9444 / Avg. batch time: 2064.0998 (ms) / GPU bubble ratio: 57.36%
[rank2]:2025-10-24 04:54:33,909 - INFO -  step: 1140  loss: -4.0000  grad_norm:  0.7420  memory: 16.10GiB(33.90%)  tps: 1,941  tflops: 15.17  mfu: 4.86%
[rank1]:2025-10-24 04:54:33,914 - INFO -  step: 1140  loss: -4.0000  grad_norm:  0.7420  memory: 20.03GiB(42.17%)  tps: 1,941  tflops: 15.17  mfu: 4.86%
[rank0]:2025-10-24 04:54:33,929 - INFO -  step: 1140  loss: -4.0000  grad_norm:  0.7420  memory: 20.89GiB(43.97%)  tps: 1,941  tflops: 15.17  mfu: 4.86%
[rank3]:2025-10-24 04:54:33,921 - INFO -  step: 1140  loss:  0.5367  grad_norm:  0.7420  memory: 38.93GiB(81.95%)  tps: 1,941  tflops: 15.17  mfu: 4.86%
[rank3]:2025-10-24 04:54:35,856 - INFO - Avg. fwd time: 76.5611 / Avg. bwd time: 136.0802 / Avg. batch time: 1749.3696 (ms) / GPU bubble ratio: 2.76%
[rank2]:2025-10-24 04:54:35,918 - INFO - Avg. fwd time: 35.1170 / Avg. bwd time: 55.4886 / Avg. batch time: 1841.8341 (ms) / GPU bubble ratio: 60.65%
[rank1]:2025-10-24 04:54:36,000 - INFO - Avg. fwd time: 54.7863 / Avg. bwd time: 74.6869 / Avg. batch time: 1964.4501 (ms) / GPU bubble ratio: 47.27%
[rank0]:2025-10-24 04:54:36,067 - INFO - Avg. fwd time: 48.0690 / Avg. bwd time: 61.9442 / Avg. batch time: 2064.0426 (ms) / GPU bubble ratio: 57.36%
[rank0]:2025-10-24 04:55:50,038 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-24 04:56:16,664 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-24 04:56:17,408 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-24 04:56:17,487 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 04:56:17,550 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 04:57:23,000 - INFO -  step: 1160  loss: -4.0000  grad_norm:  0.7646  memory: 20.89GiB(43.97%)  tps: 1,938  tflops: 15.15  mfu: 4.86%
[rank1]:2025-10-24 04:57:22,986 - INFO -  step: 1160  loss: -4.0000  grad_norm:  0.7646  memory: 20.03GiB(42.17%)  tps: 1,938  tflops: 15.15  mfu: 4.86%
[rank3]:2025-10-24 04:57:22,991 - INFO -  step: 1160  loss:  0.5244  grad_norm:  0.7646  memory: 38.93GiB(81.95%)  tps: 1,938  tflops: 15.15  mfu: 4.86%
[rank2]:2025-10-24 04:57:22,979 - INFO -  step: 1160  loss: -4.0000  grad_norm:  0.7646  memory: 16.10GiB(33.90%)  tps: 1,938  tflops: 15.15  mfu: 4.86%
[rank3]:2025-10-24 04:57:24,922 - INFO - Avg. fwd time: 76.5581 / Avg. bwd time: 136.0873 / Avg. batch time: 1749.3777 (ms) / GPU bubble ratio: 2.76%
[rank2]:2025-10-24 04:57:24,991 - INFO - Avg. fwd time: 35.1181 / Avg. bwd time: 55.4902 / Avg. batch time: 1841.8383 (ms) / GPU bubble ratio: 60.64%
[rank1]:2025-10-24 04:57:25,069 - INFO - Avg. fwd time: 54.7775 / Avg. bwd time: 74.6855 / Avg. batch time: 1964.4510 (ms) / GPU bubble ratio: 47.28%
[rank0]:2025-10-24 04:57:25,137 - INFO - Avg. fwd time: 48.0712 / Avg. bwd time: 61.9459 / Avg. batch time: 2064.0353 (ms) / GPU bubble ratio: 57.36%
[rank1]:2025-10-24 05:00:12,195 - INFO -  step: 1180  loss: -4.0000  grad_norm:  0.8596  memory: 20.03GiB(42.17%)  tps: 1,937  tflops: 15.14  mfu: 4.85%
[rank0]:2025-10-24 05:00:12,210 - INFO -  step: 1180  loss: -4.0000  grad_norm:  0.8596  memory: 20.89GiB(43.97%)  tps: 1,937  tflops: 15.14  mfu: 4.85%
[rank3]:2025-10-24 05:00:12,202 - INFO -  step: 1180  loss:  0.5157  grad_norm:  0.8596  memory: 38.93GiB(81.95%)  tps: 1,937  tflops: 15.14  mfu: 4.85%
[rank2]:2025-10-24 05:00:12,189 - INFO -  step: 1180  loss: -4.0000  grad_norm:  0.8596  memory: 16.10GiB(33.90%)  tps: 1,937  tflops: 15.14  mfu: 4.85%
[rank3]:2025-10-24 05:00:14,149 - INFO - Avg. fwd time: 76.5545 / Avg. bwd time: 136.0983 / Avg. batch time: 1749.4293 (ms) / GPU bubble ratio: 2.76%
[rank2]:2025-10-24 05:00:14,218 - INFO - Avg. fwd time: 35.1241 / Avg. bwd time: 55.4935 / Avg. batch time: 1841.8834 (ms) / GPU bubble ratio: 60.64%
[rank1]:2025-10-24 05:00:14,294 - INFO - Avg. fwd time: 54.7699 / Avg. bwd time: 74.6933 / Avg. batch time: 1964.4935 (ms) / GPU bubble ratio: 47.28%
[rank0]:2025-10-24 05:00:14,367 - INFO - Avg. fwd time: 48.0724 / Avg. bwd time: 61.9489 / Avg. batch time: 2064.0649 (ms) / GPU bubble ratio: 57.36%
[rank0]:2025-10-24 05:02:52,717 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-24 05:03:01,177 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.8392  memory: 16.10GiB(33.90%)  tps: 1,939  tflops: 15.16  mfu: 4.86%
[rank3]:2025-10-24 05:03:01,190 - INFO -  step: 1200  loss:  0.5380  grad_norm:  0.8392  memory: 38.93GiB(81.95%)  tps: 1,939  tflops: 15.16  mfu: 4.86%
[rank0]:2025-10-24 05:03:01,195 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.8392  memory: 20.89GiB(43.97%)  tps: 1,939  tflops: 15.16  mfu: 4.86%
[rank1]:2025-10-24 05:03:01,182 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.8392  memory: 20.03GiB(42.17%)  tps: 1,939  tflops: 15.16  mfu: 4.86%
[rank3]:2025-10-24 05:03:01,450 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_nofreeze_dm1/pipeline_schedule/251024_0503_real_step1200_rank3.svg
[rank3]:> Batch Time: 2004.44 ms, GPU Bubble Ratio: 56.01%, 48.05%, 64.17%, 15.20%
[rank3]:2025-10-24 05:03:03,257 - INFO - Avg. fwd time: 76.5528 / Avg. bwd time: 136.1016 / Avg. batch time: 1749.4162 (ms) / GPU bubble ratio: 2.75%
[rank2]:2025-10-24 05:03:03,320 - INFO - Avg. fwd time: 35.1279 / Avg. bwd time: 55.4955 / Avg. batch time: 1841.8942 (ms) / GPU bubble ratio: 60.64%
[rank0]:2025-10-24 05:03:03,468 - INFO - Avg. fwd time: 48.0753 / Avg. bwd time: 61.9468 / Avg. batch time: 2064.0526 (ms) / GPU bubble ratio: 57.36%
[rank1]:2025-10-24 05:03:03,401 - INFO - Avg. fwd time: 54.7582 / Avg. bwd time: 74.6919 / Avg. batch time: 1964.4960 (ms) / GPU bubble ratio: 47.28%
[rank2]:2025-10-24 05:05:50,114 - INFO -  step: 1220  loss: -4.0000  grad_norm:  0.7921  memory: 16.10GiB(33.90%)  tps: 1,940  tflops: 15.16  mfu: 4.86%
[rank3]:2025-10-24 05:05:50,127 - INFO -  step: 1220  loss:  0.5107  grad_norm:  0.7921  memory: 38.93GiB(81.95%)  tps: 1,940  tflops: 15.16  mfu: 4.86%
[rank0]:2025-10-24 05:05:50,133 - INFO -  step: 1220  loss: -4.0000  grad_norm:  0.7921  memory: 20.89GiB(43.97%)  tps: 1,940  tflops: 15.16  mfu: 4.86%
[rank1]:2025-10-24 05:05:50,118 - INFO -  step: 1220  loss: -4.0000  grad_norm:  0.7921  memory: 20.03GiB(42.17%)  tps: 1,940  tflops: 15.16  mfu: 4.86%
[rank3]:2025-10-24 05:05:52,068 - INFO - Avg. fwd time: 76.5466 / Avg. bwd time: 136.1071 / Avg. batch time: 1749.3795 (ms) / GPU bubble ratio: 2.75%
[rank2]:2025-10-24 05:05:52,138 - INFO - Avg. fwd time: 35.1311 / Avg. bwd time: 55.5008 / Avg. batch time: 1841.8552 (ms) / GPU bubble ratio: 60.63%
[rank0]:2025-10-24 05:05:52,289 - INFO - Avg. fwd time: 48.0738 / Avg. bwd time: 61.9427 / Avg. batch time: 2063.9877 (ms) / GPU bubble ratio: 57.36%
[rank1]:2025-10-24 05:05:52,215 - INFO - Avg. fwd time: 54.7486 / Avg. bwd time: 74.6900 / Avg. batch time: 1964.4431 (ms) / GPU bubble ratio: 47.29%
[rank3]:2025-10-24 05:07:54,278 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-24 05:07:55,031 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-24 05:07:55,112 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 05:07:55,180 - WARNING - Dataset alpaca is being re-looped
[rank3]:2025-10-24 05:08:39,782 - INFO -  step: 1240  loss:  0.4986  grad_norm:  0.7758  memory: 38.93GiB(81.95%)  tps: 1,931  tflops: 15.10  mfu: 4.84%
[rank1]:2025-10-24 05:08:39,773 - INFO -  step: 1240  loss: -4.0000  grad_norm:  0.7758  memory: 20.03GiB(42.17%)  tps: 1,931  tflops: 15.10  mfu: 4.84%
[rank0]:2025-10-24 05:08:39,789 - INFO -  step: 1240  loss: -4.0000  grad_norm:  0.7758  memory: 20.89GiB(43.97%)  tps: 1,931  tflops: 15.10  mfu: 4.84%
[rank2]:2025-10-24 05:08:39,769 - INFO -  step: 1240  loss: -4.0000  grad_norm:  0.7758  memory: 16.10GiB(33.90%)  tps: 1,931  tflops: 15.10  mfu: 4.84%
[rank3]:2025-10-24 05:08:41,691 - INFO - Avg. fwd time: 76.5527 / Avg. bwd time: 136.1150 / Avg. batch time: 1749.4626 (ms) / GPU bubble ratio: 2.75%
[rank2]:2025-10-24 05:08:41,760 - INFO - Avg. fwd time: 35.1305 / Avg. bwd time: 55.5083 / Avg. batch time: 1841.9532 (ms) / GPU bubble ratio: 60.63%
[rank1]:2025-10-24 05:08:41,838 - INFO - Avg. fwd time: 54.7444 / Avg. bwd time: 74.6881 / Avg. batch time: 1964.5378 (ms) / GPU bubble ratio: 47.29%
[rank0]:2025-10-24 05:08:41,911 - INFO - Avg. fwd time: 48.0722 / Avg. bwd time: 61.9443 / Avg. batch time: 2064.0895 (ms) / GPU bubble ratio: 57.36%
[rank0]:2025-10-24 05:09:55,501 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-24 05:11:28,075 - INFO -  step: 1260  loss: -4.0000  grad_norm:  1.0505  memory: 16.10GiB(33.90%)  tps: 1,947  tflops: 15.22  mfu: 4.88%
[rank3]:2025-10-24 05:11:28,087 - INFO -  step: 1260  loss:  0.5044  grad_norm:  1.0505  memory: 38.93GiB(81.95%)  tps: 1,947  tflops: 15.22  mfu: 4.88%
[rank1]:2025-10-24 05:11:28,078 - INFO -  step: 1260  loss: -4.0000  grad_norm:  1.0505  memory: 20.03GiB(42.17%)  tps: 1,947  tflops: 15.22  mfu: 4.88%
[rank0]:2025-10-24 05:11:28,100 - INFO -  step: 1260  loss: -4.0000  grad_norm:  1.0505  memory: 20.89GiB(43.97%)  tps: 1,947  tflops: 15.22  mfu: 4.88%
[rank3]:2025-10-24 05:11:29,985 - INFO - Avg. fwd time: 76.5422 / Avg. bwd time: 136.1132 / Avg. batch time: 1749.3348 (ms) / GPU bubble ratio: 2.75%
[rank2]:2025-10-24 05:11:30,047 - INFO - Avg. fwd time: 35.1347 / Avg. bwd time: 55.5168 / Avg. batch time: 1841.8248 (ms) / GPU bubble ratio: 60.63%
[rank1]:2025-10-24 05:11:30,128 - INFO - Avg. fwd time: 54.7319 / Avg. bwd time: 74.6786 / Avg. batch time: 1964.3862 (ms) / GPU bubble ratio: 47.30%
[rank0]:2025-10-24 05:11:30,196 - INFO - Avg. fwd time: 48.0696 / Avg. bwd time: 61.9399 / Avg. batch time: 2063.9299 (ms) / GPU bubble ratio: 57.36%
[rank2]:2025-10-24 05:14:17,503 - INFO -  step: 1280  loss: -4.0000  grad_norm:  1.0601  memory: 16.10GiB(33.90%)  tps: 1,934  tflops: 15.12  mfu: 4.85%
[rank3]:2025-10-24 05:14:17,516 - INFO -  step: 1280  loss:  0.4932  grad_norm:  1.0601  memory: 38.93GiB(81.95%)  tps: 1,934  tflops: 15.12  mfu: 4.85%
[rank1]:2025-10-24 05:14:17,507 - INFO -  step: 1280  loss: -4.0000  grad_norm:  1.0601  memory: 20.03GiB(42.17%)  tps: 1,934  tflops: 15.12  mfu: 4.85%
[rank0]:2025-10-24 05:14:17,527 - INFO -  step: 1280  loss: -4.0000  grad_norm:  1.0601  memory: 20.89GiB(43.97%)  tps: 1,934  tflops: 15.12  mfu: 4.85%
[rank3]:2025-10-24 05:14:19,459 - INFO - Avg. fwd time: 76.5481 / Avg. bwd time: 136.1192 / Avg. batch time: 1749.4103 (ms) / GPU bubble ratio: 2.75%
[rank2]:2025-10-24 05:14:19,522 - INFO - Avg. fwd time: 35.1379 / Avg. bwd time: 55.5242 / Avg. batch time: 1841.8969 (ms) / GPU bubble ratio: 60.62%
[rank1]:2025-10-24 05:14:19,610 - INFO - Avg. fwd time: 54.7237 / Avg. bwd time: 74.6876 / Avg. batch time: 1964.4580 (ms) / GPU bubble ratio: 47.30%
[rank0]:2025-10-24 05:14:19,679 - INFO - Avg. fwd time: 48.0678 / Avg. bwd time: 61.9410 / Avg. batch time: 2064.0036 (ms) / GPU bubble ratio: 57.36%
[rank0]:2025-10-24 05:16:58,018 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-24 05:17:06,476 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.8567  memory: 20.03GiB(42.17%)  tps: 1,939  tflops: 15.16  mfu: 4.86%
[rank2]:2025-10-24 05:17:06,467 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.8567  memory: 16.10GiB(33.90%)  tps: 1,939  tflops: 15.16  mfu: 4.86%
[rank0]:2025-10-24 05:17:06,487 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.8567  memory: 20.89GiB(43.97%)  tps: 1,939  tflops: 15.16  mfu: 4.86%
[rank3]:2025-10-24 05:17:06,480 - INFO -  step: 1300  loss:  0.4760  grad_norm:  0.8567  memory: 38.93GiB(81.95%)  tps: 1,939  tflops: 15.16  mfu: 4.86%
[rank3]:2025-10-24 05:17:06,739 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_nofreeze_dm1/pipeline_schedule/251024_0517_real_step1300_rank3.svg
[rank3]:> Batch Time: 2004.25 ms, GPU Bubble Ratio: 56.02%, 48.08%, 64.14%, 15.18%
[rank3]:2025-10-24 05:17:08,546 - INFO - Avg. fwd time: 76.5461 / Avg. bwd time: 136.1190 / Avg. batch time: 1749.3759 (ms) / GPU bubble ratio: 2.75%
[rank2]:2025-10-24 05:17:08,609 - INFO - Avg. fwd time: 35.1382 / Avg. bwd time: 55.5343 / Avg. batch time: 1841.8900 (ms) / GPU bubble ratio: 60.62%
[rank1]:2025-10-24 05:17:08,686 - INFO - Avg. fwd time: 54.7228 / Avg. bwd time: 74.6971 / Avg. batch time: 1964.4413 (ms) / GPU bubble ratio: 47.29%
[rank0]:2025-10-24 05:17:08,761 - INFO - Avg. fwd time: 48.0658 / Avg. bwd time: 61.9394 / Avg. batch time: 2063.9843 (ms) / GPU bubble ratio: 57.36%
[rank3]:2025-10-24 05:19:29,107 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-24 05:19:29,761 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-24 05:19:29,834 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 05:19:29,895 - WARNING - Dataset alpaca is being re-looped
[rank3]:2025-10-24 05:19:55,182 - INFO -  step: 1320  loss:  0.4694  grad_norm:  0.8038  memory: 38.93GiB(81.95%)  tps: 1,942  tflops: 15.18  mfu: 4.87%
[rank1]:2025-10-24 05:19:55,174 - INFO -  step: 1320  loss: -4.0000  grad_norm:  0.8038  memory: 20.03GiB(42.17%)  tps: 1,942  tflops: 15.18  mfu: 4.87%
[rank2]:2025-10-24 05:19:55,170 - INFO -  step: 1320  loss: -4.0000  grad_norm:  0.8038  memory: 16.10GiB(33.90%)  tps: 1,942  tflops: 15.18  mfu: 4.87%
[rank0]:2025-10-24 05:19:55,188 - INFO -  step: 1320  loss: -4.0000  grad_norm:  0.8038  memory: 20.89GiB(43.97%)  tps: 1,942  tflops: 15.18  mfu: 4.87%
[rank3]:2025-10-24 05:19:57,125 - INFO - Avg. fwd time: 76.5383 / Avg. bwd time: 136.1193 / Avg. batch time: 1749.2860 (ms) / GPU bubble ratio: 2.75%
[rank2]:2025-10-24 05:19:57,195 - INFO - Avg. fwd time: 35.1400 / Avg. bwd time: 55.5453 / Avg. batch time: 1841.8119 (ms) / GPU bubble ratio: 60.61%
[rank1]:2025-10-24 05:19:57,272 - INFO - Avg. fwd time: 54.7148 / Avg. bwd time: 74.7090 / Avg. batch time: 1964.3566 (ms) / GPU bubble ratio: 47.29%
[rank0]:2025-10-24 05:19:57,348 - INFO - Avg. fwd time: 48.0678 / Avg. bwd time: 61.9375 / Avg. batch time: 2063.8827 (ms) / GPU bubble ratio: 57.36%
[rank1]:2025-10-24 05:22:44,339 - INFO -  step: 1340  loss: -4.0000  grad_norm:  0.8618  memory: 20.03GiB(42.17%)  tps: 1,937  tflops: 15.14  mfu: 4.85%
[rank2]:2025-10-24 05:22:44,335 - INFO -  step: 1340  loss: -4.0000  grad_norm:  0.8618  memory: 16.10GiB(33.90%)  tps: 1,937  tflops: 15.14  mfu: 4.85%
[rank0]:2025-10-24 05:22:44,355 - INFO -  step: 1340  loss: -4.0000  grad_norm:  0.8618  memory: 20.89GiB(43.97%)  tps: 1,937  tflops: 15.14  mfu: 4.85%
[rank3]:2025-10-24 05:22:44,348 - INFO -  step: 1340  loss:  0.4495  grad_norm:  0.8618  memory: 38.93GiB(81.95%)  tps: 1,937  tflops: 15.14  mfu: 4.85%
[rank3]:2025-10-24 05:22:46,285 - INFO - Avg. fwd time: 76.5406 / Avg. bwd time: 136.1212 / Avg. batch time: 1749.3051 (ms) / GPU bubble ratio: 2.74%
[rank2]:2025-10-24 05:22:46,349 - INFO - Avg. fwd time: 35.1418 / Avg. bwd time: 55.5525 / Avg. batch time: 1841.8318 (ms) / GPU bubble ratio: 60.61%
[rank1]:2025-10-24 05:22:46,439 - INFO - Avg. fwd time: 54.7095 / Avg. bwd time: 74.7186 / Avg. batch time: 1964.3656 (ms) / GPU bubble ratio: 47.29%
[rank0]:2025-10-24 05:22:46,513 - INFO - Avg. fwd time: 48.0692 / Avg. bwd time: 61.9375 / Avg. batch time: 2063.8952 (ms) / GPU bubble ratio: 57.36%
[rank0]:2025-10-24 05:24:00,288 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-24 05:25:33,240 - INFO -  step: 1360  loss:  0.4588  grad_norm:  0.8984  memory: 38.93GiB(81.95%)  tps: 1,940  tflops: 15.17  mfu: 4.86%
[rank1]:2025-10-24 05:25:33,233 - INFO -  step: 1360  loss: -4.0000  grad_norm:  0.8984  memory: 20.03GiB(42.17%)  tps: 1,940  tflops: 15.17  mfu: 4.86%
[rank2]:2025-10-24 05:25:33,228 - INFO -  step: 1360  loss: -4.0000  grad_norm:  0.8984  memory: 16.10GiB(33.90%)  tps: 1,940  tflops: 15.17  mfu: 4.86%
[rank0]:2025-10-24 05:25:33,248 - INFO -  step: 1360  loss: -4.0000  grad_norm:  0.8984  memory: 20.89GiB(43.97%)  tps: 1,940  tflops: 15.17  mfu: 4.86%
[rank3]:2025-10-24 05:25:35,166 - INFO - Avg. fwd time: 76.5413 / Avg. bwd time: 136.1226 / Avg. batch time: 1749.2948 (ms) / GPU bubble ratio: 2.74%
[rank2]:2025-10-24 05:25:35,230 - INFO - Avg. fwd time: 35.1426 / Avg. bwd time: 55.5536 / Avg. batch time: 1841.8075 (ms) / GPU bubble ratio: 60.61%
[rank1]:2025-10-24 05:25:35,317 - INFO - Avg. fwd time: 54.7000 / Avg. bwd time: 74.7223 / Avg. batch time: 1964.3363 (ms) / GPU bubble ratio: 47.29%
[rank0]:2025-10-24 05:25:35,386 - INFO - Avg. fwd time: 48.0667 / Avg. bwd time: 61.9337 / Avg. batch time: 2063.8544 (ms) / GPU bubble ratio: 57.36%
[rank2]:2025-10-24 05:28:22,703 - INFO -  step: 1380  loss: -4.0000  grad_norm:  0.9742  memory: 16.10GiB(33.90%)  tps: 1,934  tflops: 15.12  mfu: 4.84%
[rank0]:2025-10-24 05:28:22,720 - INFO -  step: 1380  loss: -4.0000  grad_norm:  0.9742  memory: 20.89GiB(43.97%)  tps: 1,934  tflops: 15.12  mfu: 4.84%
[rank1]:2025-10-24 05:28:22,706 - INFO -  step: 1380  loss: -4.0000  grad_norm:  0.9742  memory: 20.03GiB(42.17%)  tps: 1,934  tflops: 15.12  mfu: 4.84%
[rank3]:2025-10-24 05:28:22,715 - INFO -  step: 1380  loss:  0.4648  grad_norm:  0.9742  memory: 38.93GiB(81.95%)  tps: 1,934  tflops: 15.12  mfu: 4.84%
[rank3]:2025-10-24 05:28:24,619 - INFO - Avg. fwd time: 76.5459 / Avg. bwd time: 136.1306 / Avg. batch time: 1749.3682 (ms) / GPU bubble ratio: 2.74%
[rank2]:2025-10-24 05:28:24,682 - INFO - Avg. fwd time: 35.1437 / Avg. bwd time: 55.5559 / Avg. batch time: 1841.8746 (ms) / GPU bubble ratio: 60.61%
[rank1]:2025-10-24 05:28:24,771 - INFO - Avg. fwd time: 54.6913 / Avg. bwd time: 74.7313 / Avg. batch time: 1964.3982 (ms) / GPU bubble ratio: 47.29%
[rank0]:2025-10-24 05:28:24,840 - INFO - Avg. fwd time: 48.0672 / Avg. bwd time: 61.9324 / Avg. batch time: 2063.9181 (ms) / GPU bubble ratio: 57.36%
[rank0]:2025-10-24 05:31:02,811 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-24 05:31:04,048 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-24 05:31:04,796 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-24 05:31:04,873 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 05:31:04,934 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-24 05:31:11,253 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.8165  memory: 16.10GiB(33.90%)  tps: 1,944  tflops: 15.20  mfu: 4.87%
[rank1]:2025-10-24 05:31:11,256 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.8165  memory: 20.03GiB(42.17%)  tps: 1,944  tflops: 15.20  mfu: 4.87%
[rank0]:2025-10-24 05:31:11,273 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.8165  memory: 20.89GiB(43.97%)  tps: 1,944  tflops: 15.20  mfu: 4.87%
[rank3]:2025-10-24 05:31:11,266 - INFO -  step: 1400  loss:  0.4519  grad_norm:  0.8165  memory: 38.93GiB(81.95%)  tps: 1,944  tflops: 15.20  mfu: 4.87%
[rank3]:2025-10-24 05:31:11,522 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_nofreeze_dm1/pipeline_schedule/251024_0531_real_step1400_rank3.svg
[rank3]:> Batch Time: 2003.94 ms, GPU Bubble Ratio: 56.02%, 48.07%, 64.11%, 15.17%
[rank3]:2025-10-24 05:31:13,326 - INFO - Avg. fwd time: 76.5412 / Avg. bwd time: 136.1292 / Avg. batch time: 1749.2889 (ms) / GPU bubble ratio: 2.74%
[rank2]:2025-10-24 05:31:13,395 - INFO - Avg. fwd time: 35.1460 / Avg. bwd time: 55.5611 / Avg. batch time: 1841.8172 (ms) / GPU bubble ratio: 60.60%
[rank1]:2025-10-24 05:31:13,471 - INFO - Avg. fwd time: 54.6719 / Avg. bwd time: 74.7328 / Avg. batch time: 1964.3195 (ms) / GPU bubble ratio: 47.30%
[rank0]:2025-10-24 05:31:13,543 - INFO - Avg. fwd time: 48.0665 / Avg. bwd time: 61.9342 / Avg. batch time: 2063.8382 (ms) / GPU bubble ratio: 57.36%
[rank2]:2025-10-24 05:34:00,650 - INFO -  step: 1420  loss: -4.0000  grad_norm:  0.7888  memory: 16.10GiB(33.90%)  tps: 1,934  tflops: 15.12  mfu: 4.85%
[rank3]:2025-10-24 05:34:00,662 - INFO -  step: 1420  loss:  0.4308  grad_norm:  0.7888  memory: 38.93GiB(81.95%)  tps: 1,934  tflops: 15.12  mfu: 4.85%
[rank0]:2025-10-24 05:34:00,668 - INFO -  step: 1420  loss: -4.0000  grad_norm:  0.7888  memory: 20.89GiB(43.97%)  tps: 1,934  tflops: 15.12  mfu: 4.85%
[rank1]:2025-10-24 05:34:00,654 - INFO -  step: 1420  loss: -4.0000  grad_norm:  0.7888  memory: 20.03GiB(42.17%)  tps: 1,934  tflops: 15.12  mfu: 4.85%
[rank3]:2025-10-24 05:34:02,605 - INFO - Avg. fwd time: 76.5458 / Avg. bwd time: 136.1326 / Avg. batch time: 1749.3356 (ms) / GPU bubble ratio: 2.74%
[rank2]:2025-10-24 05:34:02,669 - INFO - Avg. fwd time: 35.1472 / Avg. bwd time: 55.5676 / Avg. batch time: 1841.8650 (ms) / GPU bubble ratio: 60.60%
[rank0]:2025-10-24 05:34:02,827 - INFO - Avg. fwd time: 48.0649 / Avg. bwd time: 61.9329 / Avg. batch time: 2063.8755 (ms) / GPU bubble ratio: 57.36%
[rank1]:2025-10-24 05:34:02,757 - INFO - Avg. fwd time: 54.6687 / Avg. bwd time: 74.7412 / Avg. batch time: 1964.3537 (ms) / GPU bubble ratio: 47.30%
[rank3]:2025-10-24 05:36:49,649 - INFO -  step: 1440  loss:  0.4494  grad_norm:  0.8948  memory: 38.93GiB(81.95%)  tps: 1,939  tflops: 15.16  mfu: 4.86%
[rank1]:2025-10-24 05:36:49,642 - INFO -  step: 1440  loss: -4.0000  grad_norm:  0.8948  memory: 20.03GiB(42.17%)  tps: 1,939  tflops: 15.16  mfu: 4.86%
[rank0]:2025-10-24 05:36:49,657 - INFO -  step: 1440  loss: -4.0000  grad_norm:  0.8948  memory: 20.89GiB(43.97%)  tps: 1,939  tflops: 15.16  mfu: 4.86%
[rank2]:2025-10-24 05:36:49,637 - INFO -  step: 1440  loss: -4.0000  grad_norm:  0.8948  memory: 16.10GiB(33.90%)  tps: 1,939  tflops: 15.16  mfu: 4.86%
[rank3]:2025-10-24 05:36:51,579 - INFO - Avg. fwd time: 76.5485 / Avg. bwd time: 136.1311 / Avg. batch time: 1749.3182 (ms) / GPU bubble ratio: 2.74%
[rank2]:2025-10-24 05:36:51,643 - INFO - Avg. fwd time: 35.1470 / Avg. bwd time: 55.5727 / Avg. batch time: 1841.8463 (ms) / GPU bubble ratio: 60.60%
[rank1]:2025-10-24 05:36:51,731 - INFO - Avg. fwd time: 54.6625 / Avg. bwd time: 74.7427 / Avg. batch time: 1964.3266 (ms) / GPU bubble ratio: 47.30%
[rank0]:2025-10-24 05:36:51,800 - INFO - Avg. fwd time: 48.0629 / Avg. bwd time: 61.9308 / Avg. batch time: 2063.8453 (ms) / GPU bubble ratio: 57.36%
[rank0]:2025-10-24 05:38:05,685 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-24 05:39:38,875 - INFO -  step: 1460  loss:  0.4494  grad_norm:  0.8681  memory: 38.93GiB(81.95%)  tps: 1,936  tflops: 15.14  mfu: 4.85%
[rank0]:2025-10-24 05:39:38,884 - INFO -  step: 1460  loss: -4.0000  grad_norm:  0.8681  memory: 20.89GiB(43.97%)  tps: 1,936  tflops: 15.14  mfu: 4.85%
[rank1]:2025-10-24 05:39:38,866 - INFO -  step: 1460  loss: -4.0000  grad_norm:  0.8681  memory: 20.03GiB(42.17%)  tps: 1,936  tflops: 15.14  mfu: 4.85%
[rank2]:2025-10-24 05:39:38,862 - INFO -  step: 1460  loss: -4.0000  grad_norm:  0.8681  memory: 16.10GiB(33.90%)  tps: 1,936  tflops: 15.14  mfu: 4.85%
[rank3]:2025-10-24 05:39:40,819 - INFO - Avg. fwd time: 76.5538 / Avg. bwd time: 136.1319 / Avg. batch time: 1749.3452 (ms) / GPU bubble ratio: 2.74%
[rank2]:2025-10-24 05:39:40,889 - INFO - Avg. fwd time: 35.1458 / Avg. bwd time: 55.5744 / Avg. batch time: 1841.8710 (ms) / GPU bubble ratio: 60.60%
[rank1]:2025-10-24 05:39:40,978 - INFO - Avg. fwd time: 54.6552 / Avg. bwd time: 74.7460 / Avg. batch time: 1964.3450 (ms) / GPU bubble ratio: 47.30%
[rank0]:2025-10-24 05:39:41,052 - INFO - Avg. fwd time: 48.0602 / Avg. bwd time: 61.9271 / Avg. batch time: 2063.8592 (ms) / GPU bubble ratio: 57.37%
[rank0]:2025-10-24 05:42:27,509 - INFO -  step: 1480  loss: -4.0000  grad_norm:  0.8004  memory: 20.89GiB(43.97%)  tps: 1,943  tflops: 15.19  mfu: 4.87%
[rank1]:2025-10-24 05:42:27,499 - INFO -  step: 1480  loss: -4.0000  grad_norm:  0.8004  memory: 20.03GiB(42.17%)  tps: 1,943  tflops: 15.19  mfu: 4.87%
[rank2]:2025-10-24 05:42:27,494 - INFO -  step: 1480  loss: -4.0000  grad_norm:  0.8004  memory: 16.10GiB(33.90%)  tps: 1,943  tflops: 15.19  mfu: 4.87%
[rank3]:2025-10-24 05:42:27,507 - INFO -  step: 1480  loss:  0.4274  grad_norm:  0.8004  memory: 38.93GiB(81.95%)  tps: 1,943  tflops: 15.19  mfu: 4.87%
[rank3]:2025-10-24 05:42:29,413 - INFO - Avg. fwd time: 76.5467 / Avg. bwd time: 136.1336 / Avg. batch time: 1749.2773 (ms) / GPU bubble ratio: 2.73%
[rank2]:2025-10-24 05:42:29,480 - INFO - Avg. fwd time: 35.1493 / Avg. bwd time: 55.5777 / Avg. batch time: 1841.7990 (ms) / GPU bubble ratio: 60.59%
[rank1]:2025-10-24 05:42:29,564 - INFO - Avg. fwd time: 54.6433 / Avg. bwd time: 74.7545 / Avg. batch time: 1964.2439 (ms) / GPU bubble ratio: 47.30%
[rank0]:2025-10-24 05:42:29,637 - INFO - Avg. fwd time: 48.0592 / Avg. bwd time: 61.9255 / Avg. batch time: 2063.7485 (ms) / GPU bubble ratio: 57.37%
[rank3]:2025-10-24 05:42:39,386 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-24 05:42:40,123 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-24 05:42:40,196 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 05:42:40,257 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 05:45:08,401 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-24 05:45:16,922 - INFO -  step: 1500  loss:  0.4314  grad_norm:  0.9081  memory: 38.93GiB(81.95%)  tps: 1,934  tflops: 15.12  mfu: 4.85%
[rank3]:2025-10-24 05:45:16,923 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-24 05:45:16,914 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.9081  memory: 20.03GiB(42.17%)  tps: 1,934  tflops: 15.12  mfu: 4.85%
[rank1]:2025-10-24 05:45:16,914 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-24 05:45:16,924 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.9081  memory: 20.89GiB(43.97%)  tps: 1,934  tflops: 15.12  mfu: 4.85%
[rank0]:2025-10-24 05:45:16,924 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-24 05:45:16,926 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank2]:2025-10-24 05:45:16,910 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.9081  memory: 16.10GiB(33.90%)  tps: 1,934  tflops: 15.12  mfu: 4.85%
[rank2]:2025-10-24 05:45:16,910 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-24 05:45:18,766 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 1.86 seconds.
[rank1]:2025-10-24 05:45:19,226 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 2.31 seconds.
[rank3]:2025-10-24 05:45:20,200 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.28 seconds.
[rank0]:2025-10-24 05:45:20,952 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-24 05:45:20,959 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 4.03 seconds.
[rank0]:2025-10-24 05:45:20,959 - INFO - Checkpointer is deleting /data2/shcho/torchtitan/checkpoint/1023_GPipe_nofreeze_dm1/step-500.
[rank3]:2025-10-24 05:45:21,401 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_nofreeze_dm1/pipeline_schedule/251024_0545_real_step1500_rank3.svg
[rank3]:> Batch Time: 2003.53 ms, GPU Bubble Ratio: 56.02%, 48.05%, 64.09%, 15.15%
[rank3]:2025-10-24 05:45:23,206 - INFO - Avg. fwd time: 76.5534 / Avg. bwd time: 136.1373 / Avg. batch time: 1749.3410 (ms) / GPU bubble ratio: 2.73%
[rank2]:2025-10-24 05:45:23,275 - INFO - Avg. fwd time: 35.1492 / Avg. bwd time: 55.5787 / Avg. batch time: 1841.9090 (ms) / GPU bubble ratio: 60.59%
[rank1]:2025-10-24 05:45:23,354 - INFO - Avg. fwd time: 54.6404 / Avg. bwd time: 74.7621 / Avg. batch time: 1964.3490 (ms) / GPU bubble ratio: 47.30%
[rank0]:2025-10-24 05:45:23,428 - INFO - Avg. fwd time: 48.0555 / Avg. bwd time: 61.9242 / Avg. batch time: 2063.8543 (ms) / GPU bubble ratio: 57.37%
[rank0]:2025-10-24 05:45:24,404 - INFO - Checkpointer deleted /data2/shcho/torchtitan/checkpoint/1023_GPipe_nofreeze_dm1/step-500 in 3.44 seconds.
[rank0]:2025-10-24 05:48:10,789 - INFO -  step: 1520  loss: -4.0000  grad_norm:  0.8255  memory: 20.89GiB(43.97%)  tps: 1,885  tflops: 14.73  mfu: 4.72%
[rank2]:2025-10-24 05:48:10,770 - INFO -  step: 1520  loss: -4.0000  grad_norm:  0.8255  memory: 16.10GiB(33.90%)  tps: 1,885  tflops: 14.73  mfu: 4.72%
[rank1]:2025-10-24 05:48:10,773 - INFO -  step: 1520  loss: -4.0000  grad_norm:  0.8255  memory: 20.03GiB(42.17%)  tps: 1,885  tflops: 14.73  mfu: 4.72%
[rank3]:2025-10-24 05:48:10,782 - INFO -  step: 1520  loss:  0.4346  grad_norm:  0.8255  memory: 38.93GiB(81.95%)  tps: 1,885  tflops: 14.73  mfu: 4.72%
[rank3]:2025-10-24 05:48:12,681 - INFO - Avg. fwd time: 76.5586 / Avg. bwd time: 136.1390 / Avg. batch time: 1749.3855 (ms) / GPU bubble ratio: 2.73%
[rank2]:2025-10-24 05:48:12,751 - INFO - Avg. fwd time: 35.1501 / Avg. bwd time: 55.5790 / Avg. batch time: 1841.9486 (ms) / GPU bubble ratio: 60.59%
[rank1]:2025-10-24 05:48:12,832 - INFO - Avg. fwd time: 54.6387 / Avg. bwd time: 74.7712 / Avg. batch time: 1964.3855 (ms) / GPU bubble ratio: 47.30%
[rank0]:2025-10-24 05:48:12,901 - INFO - Avg. fwd time: 48.0516 / Avg. bwd time: 61.9213 / Avg. batch time: 2063.8947 (ms) / GPU bubble ratio: 57.37%
[rank0]:2025-10-24 05:50:59,618 - INFO -  step: 1540  loss: -4.0000  grad_norm:  0.9009  memory: 20.89GiB(43.97%)  tps: 1,941  tflops: 15.17  mfu: 4.86%
[rank2]:2025-10-24 05:50:59,597 - INFO -  step: 1540  loss: -4.0000  grad_norm:  0.9009  memory: 16.10GiB(33.90%)  tps: 1,941  tflops: 15.17  mfu: 4.86%
[rank1]:2025-10-24 05:50:59,602 - INFO -  step: 1540  loss: -4.0000  grad_norm:  0.9009  memory: 20.03GiB(42.17%)  tps: 1,941  tflops: 15.17  mfu: 4.86%
[rank3]:2025-10-24 05:50:59,609 - INFO -  step: 1540  loss:  0.4298  grad_norm:  0.9009  memory: 38.93GiB(81.95%)  tps: 1,941  tflops: 15.17  mfu: 4.86%
[rank3]:2025-10-24 05:51:01,553 - INFO - Avg. fwd time: 76.5583 / Avg. bwd time: 136.1389 / Avg. batch time: 1749.3629 (ms) / GPU bubble ratio: 2.73%
[rank2]:2025-10-24 05:51:01,621 - INFO - Avg. fwd time: 35.1523 / Avg. bwd time: 55.5822 / Avg. batch time: 1841.9225 (ms) / GPU bubble ratio: 60.59%
[rank1]:2025-10-24 05:51:01,700 - INFO - Avg. fwd time: 54.6350 / Avg. bwd time: 74.7763 / Avg. batch time: 1964.3391 (ms) / GPU bubble ratio: 47.30%
[rank0]:2025-10-24 05:51:01,776 - INFO - Avg. fwd time: 48.0509 / Avg. bwd time: 61.9172 / Avg. batch time: 2063.8485 (ms) / GPU bubble ratio: 57.37%
[rank0]:2025-10-24 05:52:16,145 - INFO - [GC] Peforming periodical GC collection 0.28 seconds
[rank2]:2025-10-24 05:53:49,648 - INFO -  step: 1560  loss: -4.0000  grad_norm:  0.8074  memory: 16.10GiB(33.90%)  tps: 1,927  tflops: 15.06  mfu: 4.83%
[rank1]:2025-10-24 05:53:49,653 - INFO -  step: 1560  loss: -4.0000  grad_norm:  0.8074  memory: 20.03GiB(42.17%)  tps: 1,927  tflops: 15.06  mfu: 4.83%
[rank3]:2025-10-24 05:53:49,660 - INFO -  step: 1560  loss:  0.4092  grad_norm:  0.8074  memory: 38.93GiB(81.95%)  tps: 1,927  tflops: 15.06  mfu: 4.83%
[rank0]:2025-10-24 05:53:49,662 - INFO -  step: 1560  loss: -4.0000  grad_norm:  0.8074  memory: 20.89GiB(43.97%)  tps: 1,927  tflops: 15.06  mfu: 4.83%
[rank3]:2025-10-24 05:53:51,601 - INFO - Avg. fwd time: 76.5691 / Avg. bwd time: 136.1411 / Avg. batch time: 1749.4465 (ms) / GPU bubble ratio: 2.73%
[rank2]:2025-10-24 05:53:51,669 - INFO - Avg. fwd time: 35.1523 / Avg. bwd time: 55.5837 / Avg. batch time: 1841.9978 (ms) / GPU bubble ratio: 60.59%
[rank1]:2025-10-24 05:53:51,749 - INFO - Avg. fwd time: 54.6305 / Avg. bwd time: 74.7878 / Avg. batch time: 1964.4290 (ms) / GPU bubble ratio: 47.30%
[rank0]:2025-10-24 05:53:51,833 - INFO - Avg. fwd time: 48.0433 / Avg. bwd time: 61.9159 / Avg. batch time: 2063.9403 (ms) / GPU bubble ratio: 57.38%
[rank3]:2025-10-24 05:54:23,006 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-24 05:54:23,667 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-24 05:54:23,748 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 05:54:23,808 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-24 05:56:38,715 - INFO -  step: 1580  loss: -4.0000  grad_norm:  0.7734  memory: 20.03GiB(42.17%)  tps: 1,938  tflops: 15.15  mfu: 4.86%
[rank3]:2025-10-24 05:56:38,723 - INFO -  step: 1580  loss:  0.4091  grad_norm:  0.7734  memory: 38.93GiB(81.95%)  tps: 1,938  tflops: 15.15  mfu: 4.86%
[rank0]:2025-10-24 05:56:38,731 - INFO -  step: 1580  loss: -4.0000  grad_norm:  0.7734  memory: 20.89GiB(43.97%)  tps: 1,938  tflops: 15.15  mfu: 4.86%
[rank2]:2025-10-24 05:56:38,710 - INFO -  step: 1580  loss: -4.0000  grad_norm:  0.7734  memory: 16.10GiB(33.90%)  tps: 1,938  tflops: 15.15  mfu: 4.86%
[rank3]:2025-10-24 05:56:40,653 - INFO - Avg. fwd time: 76.5741 / Avg. bwd time: 136.1388 / Avg. batch time: 1749.4507 (ms) / GPU bubble ratio: 2.73%
[rank2]:2025-10-24 05:56:40,717 - INFO - Avg. fwd time: 35.1525 / Avg. bwd time: 55.5834 / Avg. batch time: 1841.9939 (ms) / GPU bubble ratio: 60.59%
[rank1]:2025-10-24 05:56:40,804 - INFO - Avg. fwd time: 54.6245 / Avg. bwd time: 74.7973 / Avg. batch time: 1964.4255 (ms) / GPU bubble ratio: 47.29%
[rank0]:2025-10-24 05:56:40,874 - INFO - Avg. fwd time: 48.0395 / Avg. bwd time: 61.9108 / Avg. batch time: 2063.9311 (ms) / GPU bubble ratio: 57.38%
[rank0]:2025-10-24 05:59:19,664 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-24 05:59:28,153 - INFO -  step: 1600  loss:  0.4219  grad_norm:  1.0193  memory: 38.93GiB(81.95%)  tps: 1,934  tflops: 15.12  mfu: 4.85%
[rank2]:2025-10-24 05:59:28,146 - INFO -  step: 1600  loss: -4.0000  grad_norm:  1.0193  memory: 16.10GiB(33.90%)  tps: 1,934  tflops: 15.12  mfu: 4.85%
[rank0]:2025-10-24 05:59:28,158 - INFO -  step: 1600  loss: -4.0000  grad_norm:  1.0193  memory: 20.89GiB(43.97%)  tps: 1,934  tflops: 15.12  mfu: 4.85%
[rank1]:2025-10-24 05:59:28,144 - INFO -  step: 1600  loss: -4.0000  grad_norm:  1.0193  memory: 20.03GiB(42.17%)  tps: 1,934  tflops: 15.12  mfu: 4.85%
[rank3]:2025-10-24 05:59:28,412 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_nofreeze_dm1/pipeline_schedule/251024_0559_real_step1600_rank3.svg
[rank3]:> Batch Time: 2003.47 ms, GPU Bubble Ratio: 56.03%, 48.01%, 64.08%, 15.14%
[rank3]:2025-10-24 05:59:30,233 - INFO - Avg. fwd time: 76.5824 / Avg. bwd time: 136.1398 / Avg. batch time: 1749.5063 (ms) / GPU bubble ratio: 2.73%
[rank2]:2025-10-24 05:59:30,302 - INFO - Avg. fwd time: 35.1523 / Avg. bwd time: 55.5817 / Avg. batch time: 1842.0554 (ms) / GPU bubble ratio: 60.59%
[rank1]:2025-10-24 05:59:30,381 - INFO - Avg. fwd time: 54.6230 / Avg. bwd time: 74.8066 / Avg. batch time: 1964.4977 (ms) / GPU bubble ratio: 47.29%
[rank0]:2025-10-24 05:59:30,458 - INFO - Avg. fwd time: 48.0351 / Avg. bwd time: 61.9061 / Avg. batch time: 2064.0006 (ms) / GPU bubble ratio: 57.39%
[rank3]:2025-10-24 06:02:18,401 - INFO -  step: 1620  loss:  0.4072  grad_norm:  0.8124  memory: 38.93GiB(81.95%)  tps: 1,925  tflops: 15.05  mfu: 4.82%
[rank1]:2025-10-24 06:02:18,394 - INFO -  step: 1620  loss: -4.0000  grad_norm:  0.8124  memory: 20.03GiB(42.17%)  tps: 1,925  tflops: 15.05  mfu: 4.82%
[rank2]:2025-10-24 06:02:18,388 - INFO -  step: 1620  loss: -4.0000  grad_norm:  0.8124  memory: 16.10GiB(33.90%)  tps: 1,925  tflops: 15.05  mfu: 4.82%
[rank0]:2025-10-24 06:02:18,404 - INFO -  step: 1620  loss: -4.0000  grad_norm:  0.8124  memory: 20.89GiB(43.97%)  tps: 1,925  tflops: 15.05  mfu: 4.82%
[rank3]:2025-10-24 06:02:20,341 - INFO - Avg. fwd time: 76.5964 / Avg. bwd time: 136.1447 / Avg. batch time: 1749.6415 (ms) / GPU bubble ratio: 2.73%
[rank2]:2025-10-24 06:02:20,406 - INFO - Avg. fwd time: 35.1518 / Avg. bwd time: 55.5865 / Avg. batch time: 1842.1926 (ms) / GPU bubble ratio: 60.60%
[rank1]:2025-10-24 06:02:20,484 - INFO - Avg. fwd time: 54.6230 / Avg. bwd time: 74.8137 / Avg. batch time: 1964.6500 (ms) / GPU bubble ratio: 47.29%
[rank0]:2025-10-24 06:02:20,554 - INFO - Avg. fwd time: 48.0297 / Avg. bwd time: 61.9046 / Avg. batch time: 2064.1527 (ms) / GPU bubble ratio: 57.39%
[rank2]:2025-10-24 06:05:07,462 - INFO -  step: 1640  loss: -4.0000  grad_norm:  0.7862  memory: 16.10GiB(33.90%)  tps: 1,938  tflops: 15.15  mfu: 4.86%
[rank3]:2025-10-24 06:05:07,474 - INFO -  step: 1640  loss:  0.3917  grad_norm:  0.7862  memory: 38.93GiB(81.95%)  tps: 1,938  tflops: 15.15  mfu: 4.86%
[rank1]:2025-10-24 06:05:07,466 - INFO -  step: 1640  loss: -4.0000  grad_norm:  0.7862  memory: 20.03GiB(42.17%)  tps: 1,938  tflops: 15.15  mfu: 4.86%
[rank0]:2025-10-24 06:05:07,482 - INFO -  step: 1640  loss: -4.0000  grad_norm:  0.7862  memory: 20.89GiB(43.97%)  tps: 1,938  tflops: 15.15  mfu: 4.86%
[rank3]:2025-10-24 06:05:09,421 - INFO - Avg. fwd time: 76.5969 / Avg. bwd time: 136.1439 / Avg. batch time: 1749.6306 (ms) / GPU bubble ratio: 2.73%
[rank2]:2025-10-24 06:05:09,491 - INFO - Avg. fwd time: 35.1512 / Avg. bwd time: 55.5897 / Avg. batch time: 1842.1814 (ms) / GPU bubble ratio: 60.59%
[rank1]:2025-10-24 06:05:09,573 - INFO - Avg. fwd time: 54.6251 / Avg. bwd time: 74.8232 / Avg. batch time: 1964.6532 (ms) / GPU bubble ratio: 47.29%
[rank0]:2025-10-24 06:05:09,649 - INFO - Avg. fwd time: 48.0299 / Avg. bwd time: 61.9000 / Avg. batch time: 2064.1521 (ms) / GPU bubble ratio: 57.39%
[rank3]:2025-10-24 06:05:59,638 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-24 06:06:00,388 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-24 06:06:00,467 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 06:06:00,530 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 06:06:23,872 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-24 06:07:57,579 - INFO -  step: 1660  loss:  0.3969  grad_norm:  0.7783  memory: 38.93GiB(81.95%)  tps: 1,926  tflops: 15.06  mfu: 4.83%
[rank1]:2025-10-24 06:07:57,571 - INFO -  step: 1660  loss: -4.0000  grad_norm:  0.7783  memory: 20.03GiB(42.17%)  tps: 1,926  tflops: 15.06  mfu: 4.83%
[rank2]:2025-10-24 06:07:57,566 - INFO -  step: 1660  loss: -4.0000  grad_norm:  0.7783  memory: 16.10GiB(33.90%)  tps: 1,926  tflops: 15.06  mfu: 4.83%
[rank0]:2025-10-24 06:07:57,582 - INFO -  step: 1660  loss: -4.0000  grad_norm:  0.7783  memory: 20.89GiB(43.97%)  tps: 1,926  tflops: 15.06  mfu: 4.83%
[rank3]:2025-10-24 06:07:59,519 - INFO - Avg. fwd time: 76.6092 / Avg. bwd time: 136.1480 / Avg. batch time: 1749.7485 (ms) / GPU bubble ratio: 2.73%
[rank2]:2025-10-24 06:07:59,585 - INFO - Avg. fwd time: 35.1499 / Avg. bwd time: 55.5919 / Avg. batch time: 1842.3023 (ms) / GPU bubble ratio: 60.60%
[rank1]:2025-10-24 06:07:59,666 - INFO - Avg. fwd time: 54.6264 / Avg. bwd time: 74.8309 / Avg. batch time: 1964.7932 (ms) / GPU bubble ratio: 47.29%
[rank0]:2025-10-24 06:07:59,738 - INFO - Avg. fwd time: 48.0266 / Avg. bwd time: 61.8985 / Avg. batch time: 2064.3020 (ms) / GPU bubble ratio: 57.40%
[rank1]:2025-10-24 06:10:46,993 - INFO -  step: 1680  loss: -4.0000  grad_norm:  0.8347  memory: 20.03GiB(42.17%)  tps: 1,934  tflops: 15.12  mfu: 4.85%
[rank3]:2025-10-24 06:10:46,999 - INFO -  step: 1680  loss:  0.3971  grad_norm:  0.8347  memory: 38.93GiB(81.95%)  tps: 1,934  tflops: 15.12  mfu: 4.85%
[rank2]:2025-10-24 06:10:46,987 - INFO -  step: 1680  loss: -4.0000  grad_norm:  0.8347  memory: 16.10GiB(33.90%)  tps: 1,934  tflops: 15.12  mfu: 4.85%
[rank0]:2025-10-24 06:10:47,007 - INFO -  step: 1680  loss: -4.0000  grad_norm:  0.8347  memory: 20.89GiB(43.97%)  tps: 1,934  tflops: 15.12  mfu: 4.85%
[rank3]:2025-10-24 06:10:48,933 - INFO - Avg. fwd time: 76.6151 / Avg. bwd time: 136.1477 / Avg. batch time: 1749.7829 (ms) / GPU bubble ratio: 2.72%
[rank2]:2025-10-24 06:10:48,997 - INFO - Avg. fwd time: 35.1502 / Avg. bwd time: 55.5929 / Avg. batch time: 1842.3331 (ms) / GPU bubble ratio: 60.60%
[rank1]:2025-10-24 06:10:49,078 - INFO - Avg. fwd time: 54.6265 / Avg. bwd time: 74.8407 / Avg. batch time: 1964.8288 (ms) / GPU bubble ratio: 47.29%
[rank0]:2025-10-24 06:10:49,148 - INFO - Avg. fwd time: 48.0245 / Avg. bwd time: 61.8944 / Avg. batch time: 2064.3378 (ms) / GPU bubble ratio: 57.40%
[rank0]:2025-10-24 06:13:28,294 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-24 06:13:36,862 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.8155  memory: 20.03GiB(42.17%)  tps: 1,929  tflops: 15.08  mfu: 4.83%
[rank0]:2025-10-24 06:13:36,878 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.8155  memory: 20.89GiB(43.97%)  tps: 1,929  tflops: 15.08  mfu: 4.83%
[rank3]:2025-10-24 06:13:36,871 - INFO -  step: 1700  loss:  0.3933  grad_norm:  0.8155  memory: 38.93GiB(81.95%)  tps: 1,929  tflops: 15.08  mfu: 4.83%
[rank2]:2025-10-24 06:13:36,858 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.8155  memory: 16.10GiB(33.90%)  tps: 1,929  tflops: 15.08  mfu: 4.83%
[rank3]:2025-10-24 06:13:37,132 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_nofreeze_dm1/pipeline_schedule/251024_0613_real_step1700_rank3.svg
[rank3]:> Batch Time: 2003.81 ms, GPU Bubble Ratio: 56.05%, 47.99%, 64.08%, 15.14%
[rank3]:2025-10-24 06:13:38,928 - INFO - Avg. fwd time: 76.6260 / Avg. bwd time: 136.1486 / Avg. batch time: 1749.8653 (ms) / GPU bubble ratio: 2.72%
[rank2]:2025-10-24 06:13:38,999 - INFO - Avg. fwd time: 35.1465 / Avg. bwd time: 55.5949 / Avg. batch time: 1842.4297 (ms) / GPU bubble ratio: 60.60%
[rank1]:2025-10-24 06:13:39,079 - INFO - Avg. fwd time: 54.6316 / Avg. bwd time: 74.8482 / Avg. batch time: 1964.9490 (ms) / GPU bubble ratio: 47.28%
[rank0]:2025-10-24 06:13:39,164 - INFO - Avg. fwd time: 48.0200 / Avg. bwd time: 61.8889 / Avg. batch time: 2064.4588 (ms) / GPU bubble ratio: 57.41%
[rank1]:2025-10-24 06:16:26,274 - INFO -  step: 1720  loss: -4.0000  grad_norm:  0.7956  memory: 20.03GiB(42.17%)  tps: 1,934  tflops: 15.12  mfu: 4.85%
[rank2]:2025-10-24 06:16:26,270 - INFO -  step: 1720  loss: -4.0000  grad_norm:  0.7956  memory: 16.10GiB(33.90%)  tps: 1,934  tflops: 15.12  mfu: 4.85%
[rank0]:2025-10-24 06:16:26,291 - INFO -  step: 1720  loss: -4.0000  grad_norm:  0.7956  memory: 20.89GiB(43.97%)  tps: 1,934  tflops: 15.12  mfu: 4.85%
[rank3]:2025-10-24 06:16:26,283 - INFO -  step: 1720  loss:  0.3913  grad_norm:  0.7956  memory: 38.93GiB(81.95%)  tps: 1,934  tflops: 15.12  mfu: 4.85%
[rank3]:2025-10-24 06:16:28,216 - INFO - Avg. fwd time: 76.6283 / Avg. bwd time: 136.1474 / Avg. batch time: 1749.8761 (ms) / GPU bubble ratio: 2.72%
[rank1]:2025-10-24 06:16:28,379 - INFO - Avg. fwd time: 54.6348 / Avg. bwd time: 74.8599 / Avg. batch time: 1964.9647 (ms) / GPU bubble ratio: 47.28%
[rank2]:2025-10-24 06:16:28,287 - INFO - Avg. fwd time: 35.1459 / Avg. bwd time: 55.5976 / Avg. batch time: 1842.4346 (ms) / GPU bubble ratio: 60.60%
[rank0]:2025-10-24 06:16:28,454 - INFO - Avg. fwd time: 48.0186 / Avg. bwd time: 61.8875 / Avg. batch time: 2064.4737 (ms) / GPU bubble ratio: 57.41%
[rank3]:2025-10-24 06:17:37,457 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-24 06:17:38,206 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-24 06:17:38,288 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 06:17:38,349 - WARNING - Dataset alpaca is being re-looped
[rank3]:2025-10-24 06:19:15,740 - INFO -  step: 1740  loss:  0.3999  grad_norm:  0.8573  memory: 38.93GiB(81.95%)  tps: 1,934  tflops: 15.12  mfu: 4.85%
[rank2]:2025-10-24 06:19:15,728 - INFO -  step: 1740  loss: -4.0000  grad_norm:  0.8573  memory: 16.10GiB(33.90%)  tps: 1,934  tflops: 15.12  mfu: 4.85%
[rank1]:2025-10-24 06:19:15,734 - INFO -  step: 1740  loss: -4.0000  grad_norm:  0.8573  memory: 20.03GiB(42.17%)  tps: 1,934  tflops: 15.12  mfu: 4.85%
[rank0]:2025-10-24 06:19:15,746 - INFO -  step: 1740  loss: -4.0000  grad_norm:  0.8573  memory: 20.89GiB(43.97%)  tps: 1,934  tflops: 15.12  mfu: 4.85%
[rank3]:2025-10-24 06:19:17,678 - INFO - Avg. fwd time: 76.6364 / Avg. bwd time: 136.1478 / Avg. batch time: 1749.9278 (ms) / GPU bubble ratio: 2.72%
[rank2]:2025-10-24 06:19:17,743 - INFO - Avg. fwd time: 35.1444 / Avg. bwd time: 55.5988 / Avg. batch time: 1842.4827 (ms) / GPU bubble ratio: 60.60%
[rank1]:2025-10-24 06:19:17,824 - INFO - Avg. fwd time: 54.6283 / Avg. bwd time: 74.8696 / Avg. batch time: 1965.0107 (ms) / GPU bubble ratio: 47.28%
[rank0]:2025-10-24 06:19:17,895 - INFO - Avg. fwd time: 48.0176 / Avg. bwd time: 61.8855 / Avg. batch time: 2064.5165 (ms) / GPU bubble ratio: 57.41%
[rank0]:2025-10-24 06:20:32,061 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-24 06:22:05,527 - INFO -  step: 1760  loss: -4.0000  grad_norm:  0.7458  memory: 20.03GiB(42.17%)  tps: 1,930  tflops: 15.09  mfu: 4.84%
[rank0]:2025-10-24 06:22:05,536 - INFO -  step: 1760  loss: -4.0000  grad_norm:  0.7458  memory: 20.89GiB(43.97%)  tps: 1,930  tflops: 15.09  mfu: 4.84%
[rank2]:2025-10-24 06:22:05,516 - INFO -  step: 1760  loss: -4.0000  grad_norm:  0.7458  memory: 16.10GiB(33.90%)  tps: 1,930  tflops: 15.09  mfu: 4.84%
[rank3]:2025-10-24 06:22:05,528 - INFO -  step: 1760  loss:  0.4086  grad_norm:  0.7458  memory: 38.93GiB(81.95%)  tps: 1,930  tflops: 15.09  mfu: 4.84%
[rank3]:2025-10-24 06:22:07,460 - INFO - Avg. fwd time: 76.6445 / Avg. bwd time: 136.1520 / Avg. batch time: 1750.0133 (ms) / GPU bubble ratio: 2.72%
[rank2]:2025-10-24 06:22:07,527 - INFO - Avg. fwd time: 35.1433 / Avg. bwd time: 55.6025 / Avg. batch time: 1842.5641 (ms) / GPU bubble ratio: 60.60%
[rank1]:2025-10-24 06:22:07,607 - INFO - Avg. fwd time: 54.6229 / Avg. bwd time: 74.8752 / Avg. batch time: 1965.0951 (ms) / GPU bubble ratio: 47.28%
[rank0]:2025-10-24 06:22:07,684 - INFO - Avg. fwd time: 48.0160 / Avg. bwd time: 61.8858 / Avg. batch time: 2064.6026 (ms) / GPU bubble ratio: 57.41%
[rank0]:2025-10-24 06:24:54,885 - INFO -  step: 1780  loss: -4.0000  grad_norm:  0.8635  memory: 20.89GiB(43.97%)  tps: 1,935  tflops: 15.13  mfu: 4.85%
[rank2]:2025-10-24 06:24:54,866 - INFO -  step: 1780  loss: -4.0000  grad_norm:  0.8635  memory: 16.10GiB(33.90%)  tps: 1,935  tflops: 15.13  mfu: 4.85%
[rank3]:2025-10-24 06:24:54,878 - INFO -  step: 1780  loss:  0.3879  grad_norm:  0.8635  memory: 38.93GiB(81.95%)  tps: 1,935  tflops: 15.13  mfu: 4.85%
[rank1]:2025-10-24 06:24:54,873 - INFO -  step: 1780  loss: -4.0000  grad_norm:  0.8635  memory: 20.03GiB(42.17%)  tps: 1,935  tflops: 15.13  mfu: 4.85%
[rank3]:2025-10-24 06:24:56,819 - INFO - Avg. fwd time: 76.6501 / Avg. bwd time: 136.1489 / Avg. batch time: 1750.0266 (ms) / GPU bubble ratio: 2.72%
[rank2]:2025-10-24 06:24:56,889 - INFO - Avg. fwd time: 35.1412 / Avg. bwd time: 55.6006 / Avg. batch time: 1842.5739 (ms) / GPU bubble ratio: 60.60%
[rank1]:2025-10-24 06:24:56,969 - INFO - Avg. fwd time: 54.6234 / Avg. bwd time: 74.8824 / Avg. batch time: 1965.1149 (ms) / GPU bubble ratio: 47.28%
[rank0]:2025-10-24 06:24:57,045 - INFO - Avg. fwd time: 48.0143 / Avg. bwd time: 61.8824 / Avg. batch time: 2064.6291 (ms) / GPU bubble ratio: 57.42%
[rank0]:2025-10-24 06:27:35,995 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-24 06:27:44,496 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.7690  memory: 20.03GiB(42.17%)  tps: 1,932  tflops: 15.10  mfu: 4.84%
[rank0]:2025-10-24 06:27:44,513 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.7690  memory: 20.89GiB(43.97%)  tps: 1,932  tflops: 15.10  mfu: 4.84%
[rank2]:2025-10-24 06:27:44,493 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.7690  memory: 16.10GiB(33.90%)  tps: 1,932  tflops: 15.10  mfu: 4.84%
[rank3]:2025-10-24 06:27:44,505 - INFO -  step: 1800  loss:  0.3824  grad_norm:  0.7690  memory: 38.93GiB(81.95%)  tps: 1,932  tflops: 15.10  mfu: 4.84%
[rank3]:2025-10-24 06:27:44,767 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_nofreeze_dm1/pipeline_schedule/251024_0627_real_step1800_rank3.svg
[rank3]:> Batch Time: 2004.44 ms, GPU Bubble Ratio: 56.07%, 47.97%, 64.10%, 15.14%
[rank3]:2025-10-24 06:27:46,585 - INFO - Avg. fwd time: 76.6576 / Avg. bwd time: 136.1486 / Avg. batch time: 1750.0777 (ms) / GPU bubble ratio: 2.72%
[rank2]:2025-10-24 06:27:46,655 - INFO - Avg. fwd time: 35.1401 / Avg. bwd time: 55.6012 / Avg. batch time: 1842.6351 (ms) / GPU bubble ratio: 60.60%
[rank1]:2025-10-24 06:27:46,744 - INFO - Avg. fwd time: 54.6213 / Avg. bwd time: 74.8900 / Avg. batch time: 1965.1849 (ms) / GPU bubble ratio: 47.28%
[rank0]:2025-10-24 06:27:46,820 - INFO - Avg. fwd time: 48.0129 / Avg. bwd time: 61.8803 / Avg. batch time: 2064.6991 (ms) / GPU bubble ratio: 57.42%
[rank3]:2025-10-24 06:29:15,304 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-24 06:29:16,049 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-24 06:29:16,131 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 06:29:16,191 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-24 06:30:34,644 - INFO -  step: 1820  loss: -4.0000  grad_norm:  0.8201  memory: 16.10GiB(33.90%)  tps: 1,926  tflops: 15.06  mfu: 4.83%
[rank3]:2025-10-24 06:30:34,657 - INFO -  step: 1820  loss:  0.3867  grad_norm:  0.8201  memory: 38.93GiB(81.95%)  tps: 1,926  tflops: 15.06  mfu: 4.83%
[rank1]:2025-10-24 06:30:34,648 - INFO -  step: 1820  loss: -4.0000  grad_norm:  0.8201  memory: 20.03GiB(42.17%)  tps: 1,926  tflops: 15.06  mfu: 4.83%
[rank0]:2025-10-24 06:30:34,669 - INFO -  step: 1820  loss: -4.0000  grad_norm:  0.8201  memory: 20.89GiB(43.97%)  tps: 1,926  tflops: 15.05  mfu: 4.83%
[rank3]:2025-10-24 06:30:36,571 - INFO - Avg. fwd time: 76.6683 / Avg. bwd time: 136.1485 / Avg. batch time: 1750.1601 (ms) / GPU bubble ratio: 2.72%
[rank2]:2025-10-24 06:30:36,640 - INFO - Avg. fwd time: 35.1386 / Avg. bwd time: 55.6030 / Avg. batch time: 1842.7143 (ms) / GPU bubble ratio: 60.61%
[rank1]:2025-10-24 06:30:36,730 - INFO - Avg. fwd time: 54.6207 / Avg. bwd time: 74.8944 / Avg. batch time: 1965.2904 (ms) / GPU bubble ratio: 47.28%
[rank0]:2025-10-24 06:30:36,810 - INFO - Avg. fwd time: 48.0084 / Avg. bwd time: 61.8815 / Avg. batch time: 2064.8135 (ms) / GPU bubble ratio: 57.42%
[rank2]:2025-10-24 06:33:24,020 - INFO -  step: 1840  loss: -4.0000  grad_norm:  0.8587  memory: 16.10GiB(33.90%)  tps: 1,935  tflops: 15.12  mfu: 4.85%
[rank3]:2025-10-24 06:33:24,032 - INFO -  step: 1840  loss:  0.3877  grad_norm:  0.8587  memory: 38.93GiB(81.95%)  tps: 1,935  tflops: 15.12  mfu: 4.85%
[rank1]:2025-10-24 06:33:24,024 - INFO -  step: 1840  loss: -4.0000  grad_norm:  0.8587  memory: 20.03GiB(42.17%)  tps: 1,935  tflops: 15.12  mfu: 4.85%
[rank0]:2025-10-24 06:33:24,041 - INFO -  step: 1840  loss: -4.0000  grad_norm:  0.8587  memory: 20.89GiB(43.97%)  tps: 1,935  tflops: 15.12  mfu: 4.85%
[rank3]:2025-10-24 06:33:25,982 - INFO - Avg. fwd time: 76.6757 / Avg. bwd time: 136.1465 / Avg. batch time: 1750.1960 (ms) / GPU bubble ratio: 2.72%
[rank2]:2025-10-24 06:33:26,052 - INFO - Avg. fwd time: 35.1398 / Avg. bwd time: 55.6018 / Avg. batch time: 1842.7450 (ms) / GPU bubble ratio: 60.61%
[rank1]:2025-10-24 06:33:26,142 - INFO - Avg. fwd time: 54.6160 / Avg. bwd time: 74.8996 / Avg. batch time: 1965.3205 (ms) / GPU bubble ratio: 47.28%
[rank0]:2025-10-24 06:33:26,218 - INFO - Avg. fwd time: 48.0059 / Avg. bwd time: 61.8810 / Avg. batch time: 2064.8443 (ms) / GPU bubble ratio: 57.43%
[rank0]:2025-10-24 06:34:40,333 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-24 06:36:13,576 - INFO -  step: 1860  loss:  0.4053  grad_norm:  0.7934  memory: 38.93GiB(81.95%)  tps: 1,933  tflops: 15.11  mfu: 4.84%
[rank1]:2025-10-24 06:36:13,570 - INFO -  step: 1860  loss: -4.0000  grad_norm:  0.7934  memory: 20.03GiB(42.17%)  tps: 1,933  tflops: 15.11  mfu: 4.84%
[rank0]:2025-10-24 06:36:13,583 - INFO -  step: 1860  loss: -4.0000  grad_norm:  0.7934  memory: 20.89GiB(43.97%)  tps: 1,933  tflops: 15.11  mfu: 4.84%
[rank2]:2025-10-24 06:36:13,564 - INFO -  step: 1860  loss: -4.0000  grad_norm:  0.7934  memory: 16.10GiB(33.90%)  tps: 1,933  tflops: 15.11  mfu: 4.84%
[rank3]:2025-10-24 06:36:15,499 - INFO - Avg. fwd time: 76.6806 / Avg. bwd time: 136.1484 / Avg. batch time: 1750.2422 (ms) / GPU bubble ratio: 2.72%
[rank2]:2025-10-24 06:36:15,568 - INFO - Avg. fwd time: 35.1404 / Avg. bwd time: 55.6015 / Avg. batch time: 1842.7847 (ms) / GPU bubble ratio: 60.61%
[rank1]:2025-10-24 06:36:15,654 - INFO - Avg. fwd time: 54.6150 / Avg. bwd time: 74.9047 / Avg. batch time: 1965.3628 (ms) / GPU bubble ratio: 47.28%
[rank0]:2025-10-24 06:36:15,725 - INFO - Avg. fwd time: 48.0047 / Avg. bwd time: 61.8795 / Avg. batch time: 2064.8850 (ms) / GPU bubble ratio: 57.43%
[rank2]:2025-10-24 06:39:02,727 - INFO -  step: 1880  loss: -4.0000  grad_norm:  0.7495  memory: 16.10GiB(33.90%)  tps: 1,937  tflops: 15.14  mfu: 4.85%
[rank3]:2025-10-24 06:39:02,739 - INFO -  step: 1880  loss:  0.3915  grad_norm:  0.7495  memory: 38.93GiB(81.95%)  tps: 1,937  tflops: 15.14  mfu: 4.85%
[rank1]:2025-10-24 06:39:02,730 - INFO -  step: 1880  loss: -4.0000  grad_norm:  0.7495  memory: 20.03GiB(42.17%)  tps: 1,937  tflops: 15.14  mfu: 4.85%
[rank0]:2025-10-24 06:39:02,747 - INFO -  step: 1880  loss: -4.0000  grad_norm:  0.7495  memory: 20.89GiB(43.97%)  tps: 1,937  tflops: 15.14  mfu: 4.85%
[rank3]:2025-10-24 06:39:04,679 - INFO - Avg. fwd time: 76.6831 / Avg. bwd time: 136.1460 / Avg. batch time: 1750.2412 (ms) / GPU bubble ratio: 2.72%
[rank2]:2025-10-24 06:39:04,760 - INFO - Avg. fwd time: 35.1401 / Avg. bwd time: 55.6014 / Avg. batch time: 1842.7820 (ms) / GPU bubble ratio: 60.61%
[rank1]:2025-10-24 06:39:04,843 - INFO - Avg. fwd time: 54.6115 / Avg. bwd time: 74.9112 / Avg. batch time: 1965.3626 (ms) / GPU bubble ratio: 47.28%
[rank0]:2025-10-24 06:39:04,918 - INFO - Avg. fwd time: 48.0035 / Avg. bwd time: 61.8764 / Avg. batch time: 2064.8826 (ms) / GPU bubble ratio: 57.43%
[rank3]:2025-10-24 06:40:54,053 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-24 06:40:54,797 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-24 06:40:54,881 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 06:40:54,943 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 06:41:43,793 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-24 06:41:52,242 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.6690  memory: 20.03GiB(42.17%)  tps: 1,933  tflops: 15.11  mfu: 4.84%
[rank0]:2025-10-24 06:41:52,251 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.6690  memory: 20.89GiB(43.97%)  tps: 1,933  tflops: 15.11  mfu: 4.84%
[rank2]:2025-10-24 06:41:52,230 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.6690  memory: 16.10GiB(33.90%)  tps: 1,933  tflops: 15.11  mfu: 4.84%
[rank3]:2025-10-24 06:41:52,243 - INFO -  step: 1900  loss:  0.3796  grad_norm:  0.6690  memory: 38.93GiB(81.95%)  tps: 1,933  tflops: 15.11  mfu: 4.84%
[rank3]:2025-10-24 06:41:52,507 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_nofreeze_dm1/pipeline_schedule/251024_0641_real_step1900_rank3.svg
[rank3]:> Batch Time: 2004.94 ms, GPU Bubble Ratio: 56.09%, 47.95%, 64.11%, 15.10%
[rank3]:2025-10-24 06:41:54,320 - INFO - Avg. fwd time: 76.6901 / Avg. bwd time: 136.1455 / Avg. batch time: 1750.2874 (ms) / GPU bubble ratio: 2.72%
[rank2]:2025-10-24 06:41:54,385 - INFO - Avg. fwd time: 35.1405 / Avg. bwd time: 55.6009 / Avg. batch time: 1842.8383 (ms) / GPU bubble ratio: 60.61%
[rank1]:2025-10-24 06:41:54,477 - INFO - Avg. fwd time: 54.6068 / Avg. bwd time: 74.9211 / Avg. batch time: 1965.4203 (ms) / GPU bubble ratio: 47.28%
[rank0]:2025-10-24 06:41:54,552 - INFO - Avg. fwd time: 48.0027 / Avg. bwd time: 61.8774 / Avg. batch time: 2064.9397 (ms) / GPU bubble ratio: 57.43%
[rank1]:2025-10-24 06:44:41,846 - INFO -  step: 1920  loss: -4.0000  grad_norm:  0.8171  memory: 20.03GiB(42.17%)  tps: 1,932  tflops: 15.10  mfu: 4.84%
[rank0]:2025-10-24 06:44:41,858 - INFO -  step: 1920  loss: -4.0000  grad_norm:  0.8171  memory: 20.89GiB(43.97%)  tps: 1,932  tflops: 15.10  mfu: 4.84%
[rank3]:2025-10-24 06:44:41,850 - INFO -  step: 1920  loss:  0.3763  grad_norm:  0.8171  memory: 38.93GiB(81.95%)  tps: 1,932  tflops: 15.10  mfu: 4.84%
[rank2]:2025-10-24 06:44:41,838 - INFO -  step: 1920  loss: -4.0000  grad_norm:  0.8171  memory: 16.10GiB(33.90%)  tps: 1,932  tflops: 15.10  mfu: 4.84%
[rank3]:2025-10-24 06:44:43,782 - INFO - Avg. fwd time: 76.6954 / Avg. bwd time: 136.1448 / Avg. batch time: 1750.3155 (ms) / GPU bubble ratio: 2.72%
[rank2]:2025-10-24 06:44:43,848 - INFO - Avg. fwd time: 35.1413 / Avg. bwd time: 55.5994 / Avg. batch time: 1842.8584 (ms) / GPU bubble ratio: 60.61%
[rank1]:2025-10-24 06:44:43,941 - INFO - Avg. fwd time: 54.6060 / Avg. bwd time: 74.9287 / Avg. batch time: 1965.4512 (ms) / GPU bubble ratio: 47.28%
[rank0]:2025-10-24 06:44:44,017 - INFO - Avg. fwd time: 48.0013 / Avg. bwd time: 61.8766 / Avg. batch time: 2064.9756 (ms) / GPU bubble ratio: 57.43%
[rank0]:2025-10-24 06:47:30,993 - INFO -  step: 1940  loss: -4.0000  grad_norm:  0.7222  memory: 20.89GiB(43.97%)  tps: 1,937  tflops: 15.15  mfu: 4.85%
[rank3]:2025-10-24 06:47:30,987 - INFO -  step: 1940  loss:  0.3645  grad_norm:  0.7222  memory: 38.93GiB(81.95%)  tps: 1,937  tflops: 15.15  mfu: 4.85%
[rank2]:2025-10-24 06:47:30,974 - INFO -  step: 1940  loss: -4.0000  grad_norm:  0.7222  memory: 16.10GiB(33.90%)  tps: 1,937  tflops: 15.15  mfu: 4.85%
[rank1]:2025-10-24 06:47:30,978 - INFO -  step: 1940  loss: -4.0000  grad_norm:  0.7222  memory: 20.03GiB(42.17%)  tps: 1,937  tflops: 15.15  mfu: 4.85%
[rank3]:2025-10-24 06:47:32,926 - INFO - Avg. fwd time: 76.6992 / Avg. bwd time: 136.1405 / Avg. batch time: 1750.3076 (ms) / GPU bubble ratio: 2.72%
[rank2]:2025-10-24 06:47:32,999 - INFO - Avg. fwd time: 35.1406 / Avg. bwd time: 55.5987 / Avg. batch time: 1842.8510 (ms) / GPU bubble ratio: 60.61%
[rank1]:2025-10-24 06:47:33,093 - INFO - Avg. fwd time: 54.6038 / Avg. bwd time: 74.9402 / Avg. batch time: 1965.4424 (ms) / GPU bubble ratio: 47.27%
[rank0]:2025-10-24 06:47:33,170 - INFO - Avg. fwd time: 47.9982 / Avg. bwd time: 61.8770 / Avg. batch time: 2064.9664 (ms) / GPU bubble ratio: 57.43%
[rank0]:2025-10-24 06:48:47,220 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-24 06:50:20,557 - INFO -  step: 1960  loss: -4.0000  grad_norm:  0.7374  memory: 16.10GiB(33.90%)  tps: 1,932  tflops: 15.11  mfu: 4.84%
[rank1]:2025-10-24 06:50:20,561 - INFO -  step: 1960  loss: -4.0000  grad_norm:  0.7374  memory: 20.03GiB(42.17%)  tps: 1,932  tflops: 15.11  mfu: 4.84%
[rank0]:2025-10-24 06:50:20,578 - INFO -  step: 1960  loss: -4.0000  grad_norm:  0.7374  memory: 20.89GiB(43.97%)  tps: 1,932  tflops: 15.11  mfu: 4.84%
[rank3]:2025-10-24 06:50:20,570 - INFO -  step: 1960  loss:  0.4147  grad_norm:  0.7374  memory: 38.93GiB(81.95%)  tps: 1,932  tflops: 15.11  mfu: 4.84%
[rank3]:2025-10-24 06:50:22,505 - INFO - Avg. fwd time: 76.7038 / Avg. bwd time: 136.1398 / Avg. batch time: 1750.3421 (ms) / GPU bubble ratio: 2.72%
[rank2]:2025-10-24 06:50:22,575 - INFO - Avg. fwd time: 35.1418 / Avg. bwd time: 55.6002 / Avg. batch time: 1842.8810 (ms) / GPU bubble ratio: 60.61%
[rank1]:2025-10-24 06:50:22,659 - INFO - Avg. fwd time: 54.6014 / Avg. bwd time: 74.9498 / Avg. batch time: 1965.4748 (ms) / GPU bubble ratio: 47.27%
[rank0]:2025-10-24 06:50:22,736 - INFO - Avg. fwd time: 47.9984 / Avg. bwd time: 61.8828 / Avg. batch time: 2065.0093 (ms) / GPU bubble ratio: 57.43%
[rank3]:2025-10-24 06:52:31,501 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-24 06:52:32,253 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-24 06:52:32,336 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 06:52:32,402 - WARNING - Dataset alpaca is being re-looped
[rank3]:2025-10-24 06:53:10,560 - INFO -  step: 1980  loss:  0.3826  grad_norm:  0.7088  memory: 38.93GiB(81.95%)  tps: 1,928  tflops: 15.07  mfu: 4.83%
[rank0]:2025-10-24 06:53:10,572 - INFO -  step: 1980  loss: -4.0000  grad_norm:  0.7088  memory: 20.89GiB(43.97%)  tps: 1,928  tflops: 15.07  mfu: 4.83%
[rank2]:2025-10-24 06:53:10,548 - INFO -  step: 1980  loss: -4.0000  grad_norm:  0.7088  memory: 16.10GiB(33.90%)  tps: 1,928  tflops: 15.07  mfu: 4.83%
[rank1]:2025-10-24 06:53:10,551 - INFO -  step: 1980  loss: -4.0000  grad_norm:  0.7088  memory: 20.03GiB(42.17%)  tps: 1,928  tflops: 15.07  mfu: 4.83%
[rank3]:2025-10-24 06:53:12,472 - INFO - Avg. fwd time: 76.7137 / Avg. bwd time: 136.1389 / Avg. batch time: 1750.4116 (ms) / GPU bubble ratio: 2.72%
[rank2]:2025-10-24 06:53:12,543 - INFO - Avg. fwd time: 35.1421 / Avg. bwd time: 55.6003 / Avg. batch time: 1842.9495 (ms) / GPU bubble ratio: 60.61%
[rank1]:2025-10-24 06:53:12,633 - INFO - Avg. fwd time: 54.5998 / Avg. bwd time: 74.9579 / Avg. batch time: 1965.5591 (ms) / GPU bubble ratio: 47.27%
[rank0]:2025-10-24 06:53:12,706 - INFO - Avg. fwd time: 47.9937 / Avg. bwd time: 61.8827 / Avg. batch time: 2065.0945 (ms) / GPU bubble ratio: 57.43%
[rank0]:2025-10-24 06:55:51,077 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-24 06:55:59,602 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.7265  memory: 20.89GiB(43.97%)  tps: 1,939  tflops: 15.16  mfu: 4.86%
[rank0]:2025-10-24 06:55:59,602 - INFO -  final step: 2000  loss: -4.0000  grad_norm:  0.7265  tps: 1,954  tflops: 15.27  mfu: 4.83%
[rank0]:2025-10-24 06:55:59,602 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-24 06:55:59,604 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2000.
[rank3]:2025-10-24 06:55:59,592 - INFO -  step: 2000  loss:  0.3653  grad_norm:  0.7265  memory: 38.93GiB(81.95%)  tps: 1,939  tflops: 15.15  mfu: 4.86%
[rank3]:2025-10-24 06:55:59,593 - INFO -  final step: 2000  loss:  0.3653  grad_norm:  0.7265  tps: 1,954  tflops: 15.28  mfu: 4.84%
[rank3]:2025-10-24 06:55:59,594 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-24 06:55:59,595 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2000.
[rank2]:2025-10-24 06:55:59,580 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.7265  memory: 16.10GiB(33.90%)  tps: 1,939  tflops: 15.15  mfu: 4.86%
[rank2]:2025-10-24 06:55:59,581 - INFO -  final step: 2000  loss: -4.0000  grad_norm:  0.7265  tps: 1,954  tflops: 15.27  mfu: 4.83%
[rank2]:2025-10-24 06:55:59,581 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-24 06:55:59,582 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2000.
[rank1]:2025-10-24 06:55:59,584 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.7265  memory: 20.03GiB(42.17%)  tps: 1,939  tflops: 15.15  mfu: 4.86%
[rank1]:2025-10-24 06:55:59,584 - INFO -  final step: 2000  loss: -4.0000  grad_norm:  0.7265  tps: 1,954  tflops: 15.27  mfu: 4.83%
[rank1]:2025-10-24 06:55:59,584 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-24 06:55:59,586 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2000.
[rank2]:2025-10-24 06:56:01,942 - INFO - Destroying the purge thread.
[rank1]:2025-10-24 06:56:01,942 - INFO - Destroying the purge thread.
[rank0]:2025-10-24 06:56:01,923 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-24 06:56:01,942 - INFO - Sleeping 2 seconds for other ranks to complete
[rank3]:2025-10-24 06:56:02,175 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_nofreeze_dm1/pipeline_schedule/251024_0656_real_final2000_rank3.svg
[rank3]:> Batch Time: 2004.84 ms, GPU Bubble Ratio: 56.08%, 47.92%, 64.11%, 15.06%
[rank1]:2025-10-24 06:56:02,204 - INFO - Process group destroyed
[rank2]:2025-10-24 06:56:02,285 - INFO - Process group destroyed
[rank3]:2025-10-24 06:56:02,404 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_nofreeze_dm1/pipeline_schedule/251024_0656_thry_final2000_rank3.svg
[rank3]:> Batch Time: 1764.08 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:2025-10-24 06:56:02,405 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading history steps 100-100, summary, console lines 448-452
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–‡â–‡â–‡â–‡â–†â–†â–†â–…â–…â–†â–…â–…â–…â–„â–„â–„â–„â–„â–„â–„â–ƒâ–ƒâ–ƒâ–‚â–‚â–‚â–‚â–‚â–‚â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–‡â–‡â–‡â–‡â–†â–†â–†â–†â–†â–…â–…â–…â–…â–„â–„â–„â–„â–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–‚â–‚â–‚â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 8.38436
[rank3]:wandb:               final/avg_loss 0.36533
[rank3]:wandb:             final/avg_mfu(%) 4.83569
[rank3]:wandb:             final/avg_tflops 15.27637
[rank3]:wandb:    final/avg_throughput(tps) 1954.11513
[rank3]:wandb:              final/grad_norm 0.72649
[rank3]:wandb:               final/max_loss 0.36533
[rank3]:wandb:                    grad_norm 0.72649
[rank3]:wandb: loss_metrics/global_avg_loss 0.36533
[rank3]:wandb: loss_metrics/global_max_loss 0.36533
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1023_GPipe_nofreeze_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/c0k5np4h
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1023_GPipe_nofreeze_dm1/20251024-0213/wandb/run-20251024_021341-c0k5np4h/logs
[rank3]:2025-10-24 06:56:03,776 - INFO - Process group destroyed
[rank0]:2025-10-24 06:56:03,942 - INFO - Training completed
[rank0]:2025-10-24 06:56:03,943 - INFO - Destroying the purge thread.
[rank0]:2025-10-24 06:56:04,157 - INFO - Process group destroyed
[rank0]:Stage 0: Modules to keep: {'tok_embeddings', 'layers.3', 'layers.0', 'layers.1', 'layers.2'}
[rank2]:Stage 2: Modules to keep: {'layers.11', 'layers.9', 'layers.10', 'layers.12'}
[rank1]:Stage 1: Modules to keep: {'layers.8', 'layers.4', 'layers.5', 'layers.7', 'layers.6'}
[rank3]:Stage 3: Modules to keep: {'layers.13', 'layers.15', 'output', 'norm', 'layers.14'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1022_llama1binstruct/config.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1023_GPipe_nofreeze_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: profile_trace/1023_GPipe_nofreeze_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: memory_snapshot/1023_GPipe_nofreeze_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 20
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: tb/1023_GPipe_nofreeze_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- pplog_freq: 80
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1023_GPipe_nofreeze_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B-Instruct
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 1e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: alpaca
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 2000
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: GPipe
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- folder: checkpoint/1023_GPipe_nofreeze_dm1
[rank3]:		- interval: 500
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B-Instruct/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: comm_traces/1023_GPipe_nofreeze_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 8
[rank3]:		- seq_len: 2048
[rank3]:		- freq: 10
[rank3]:		- steps: -1
[rank3]:	- freezing:
[rank3]:		- freeze: False
[rank3]:		- metric_type: apf
[rank3]:		- phase_unit: 10
[rank3]:		- stability_check_freq: 5
[rank3]:		- aggressiveness: 0
[rank3]:
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
