ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 10. 25. (í† ) 17:12:49 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 3,4,5,6
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1022_llama1binstruct/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1022_llama1binstruct/1023_1F1B_nofreeze.log
âœ”ï¸Main Table Experiment
âœ”ï¸Running with nofreeze x 1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1022_llama1binstruct/config.toml --job.description="Main Table Experiment" --parallelism.pipeline_parallel_degree=4  --freezing.no-freeze
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank1]:2025-10-25 17:12:55,443 - INFO - Starting job: "Main Table Experiment"
[rank2]:2025-10-25 17:12:55,444 - INFO - Starting job: "Main Table Experiment"
[rank0]:2025-10-25 17:12:55,597 - INFO - Starting job: "Main Table Experiment"
[rank3]:2025-10-25 17:12:55,649 - INFO - Starting job: "Main Table Experiment"
[rank0]:2025-10-25 17:12:55,907 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-10-25 17:12:55,910 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-25 17:12:55,913 - INFO - [GC] Initial GC collection 0.00 seconds
[rank1]:2025-10-25 17:12:55,885 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-10-25 17:12:55,887 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-10-25 17:12:55,880 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-10-25 17:12:55,882 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-10-25 17:12:55,998 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-10-25 17:12:56,000 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-25 17:12:56,307 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-10-25 17:12:56,727 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank1]:2025-10-25 17:12:59,646 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-10-25 17:12:59,724 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank1]:2025-10-25 17:12:59,686 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-10-25 17:12:59,711 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-10-25 17:12:59,711 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank2]:2025-10-25 17:12:59,788 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-10-25 17:12:59,827 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-10-25 17:12:59,855 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-10-25 17:12:59,855 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2025-10-25 17:12:59,870 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-10-25 17:12:59,910 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-10-25 17:12:59,911 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-10-25 17:12:59,937 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-10-25 17:12:59,937 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2025-10-25 17:12:59,885 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-10-25 17:12:59,885 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-10-25 17:12:59,885 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank2]:2025-10-25 17:13:00,026 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-10-25 17:13:00,026 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-10-25 17:13:00,026 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank0]:2025-10-25 17:13:00,111 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-10-25 17:13:00,111 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-10-25 17:13:00,111 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run p7xt7v2m
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1023_1F1B_nofreeze_dm1/20251025-1712/wandb/run-20251025_171300-p7xt7v2m
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1023_1F1B_nofreeze_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/p7xt7v2m
[rank3]:2025-10-25 17:13:01,854 - INFO - WandB logging enabled
[rank3]:2025-10-25 17:13:01,855 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-10-25 17:13:01,895 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-10-25 17:13:01,924 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-10-25 17:13:01,925 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2025-10-25 17:13:02,111 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1023_1F1B_nofreeze_dm1
[rank0]:2025-10-25 17:13:02,112 - WARNING - Mixed precision training with TP or PP is only supported when FSDP/HSDP/CP is enabled.
[rank0]:2025-10-25 17:13:02,112 - INFO - Mixed precision training is disabled
[rank0]:2025-10-25 17:13:02,112 - INFO - Trainer is initialized with local batch size 16, global batch size 64, gradient accumulation steps 4, sequence length 1024, total steps 2000 (warmup 100)
[rank0]:2025-10-25 17:13:02,112 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B-Instruct/original_dcp.
[rank3]:2025-10-25 17:13:02,095 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-10-25 17:13:02,095 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-10-25 17:13:02,096 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank0]:2025-10-25 17:13:04,352 - INFO - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-10-25 17:13:04,352 - INFO - Finished loading the checkpoint in 2.24 seconds.
[rank0]:2025-10-25 17:13:04,352 - INFO - Training starts at step 1
[rank0]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/autograd/graph.py:849: UserWarning: Attempting to run cuBLAS, but there was no current CUDA context! Attempting to set the primary context... (Triggered internally at /pytorch/aten/src/ATen/cuda/CublasHandlePool.cpp:270.)
[rank0]:  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
[rank1]:2025-10-25 17:13:13,267 - INFO -  step:  1  loss: -4.0000  grad_norm:  3.4827  memory:  8.46GiB(17.81%)  tps: 1,206  tflops: 9.43  mfu: 3.02%
[rank1]:2025-10-25 17:13:13,267 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-25 17:13:13,274 - INFO -  step:  1  loss:  1.7854  grad_norm:  3.4827  memory: 20.75GiB(43.67%)  tps: 1,440  tflops: 11.26  mfu: 3.61%
[rank3]:2025-10-25 17:13:13,275 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-10-25 17:13:13,264 - INFO -  step:  1  loss: -4.0000  grad_norm:  3.4827  memory:  5.39GiB(11.36%)  tps: 1,219  tflops: 9.53  mfu: 3.06%
[rank2]:2025-10-25 17:13:13,265 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-10-25 17:13:13,302 - INFO -  step:  1  loss: -4.0000  grad_norm:  3.4827  memory: 11.08GiB(23.32%)  tps: 1,224  tflops: 9.57  mfu: 3.07%
[rank0]:2025-10-25 17:13:13,302 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-25 17:13:27,390 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-25 17:13:27,391 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-25 17:13:27,391 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-25 17:13:27,392 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-25 17:13:27,392 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-25 17:13:27,392 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-25 17:13:27,392 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-25 17:13:27,393 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-25 17:13:27,393 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-25 17:13:27,393 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-25 17:13:27,393 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-25 17:13:27,394 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-25 17:13:27,394 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-25 17:13:27,394 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-25 17:13:27,394 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-25 17:13:27,395 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 17:13:27,453 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 17:13:27,454 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 17:13:27,454 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 17:13:27,454 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 17:13:27,454 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 17:13:27,454 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 17:13:27,454 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 17:13:27,454 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 17:13:27,454 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 17:13:27,454 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 17:13:27,454 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 17:13:27,454 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 17:13:27,454 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 17:13:27,454 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 17:13:27,454 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 17:13:27,454 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-25 17:13:27,532 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-25 17:13:27,532 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-25 17:13:27,532 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-25 17:13:27,532 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-25 17:13:27,532 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-25 17:13:27,532 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-25 17:13:27,532 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-25 17:13:27,532 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-25 17:13:27,532 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-25 17:13:27,532 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-25 17:13:27,533 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-25 17:13:27,533 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-25 17:13:27,533 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-25 17:13:27,533 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-25 17:13:27,533 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-25 17:13:27,533 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 17:13:27,597 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 17:13:27,597 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 17:13:27,597 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 17:13:27,597 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 17:13:27,597 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 17:13:27,597 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 17:13:27,597 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 17:13:27,597 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 17:13:27,597 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 17:13:27,597 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 17:13:27,598 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 17:13:27,598 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 17:13:27,598 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 17:13:27,598 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 17:13:27,598 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 17:13:27,598 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-25 17:15:52,020 - INFO -  step: 20  loss:  1.3862  grad_norm:  1.4899  memory: 24.67GiB(51.93%)  tps: 1,961  tflops: 15.33  mfu: 4.91%
[rank0]:2025-10-25 17:15:52,023 - INFO -  step: 20  loss: -4.0000  grad_norm:  1.4899  memory: 14.87GiB(31.30%)  tps: 1,961  tflops: 15.33  mfu: 4.91%
[rank1]:2025-10-25 17:15:52,014 - INFO -  step: 20  loss: -4.0000  grad_norm:  1.4899  memory: 10.73GiB(22.58%)  tps: 1,961  tflops: 15.33  mfu: 4.91%
[rank2]:2025-10-25 17:15:52,008 - INFO -  step: 20  loss: -4.0000  grad_norm:  1.4899  memory:  7.21GiB(15.18%)  tps: 1,961  tflops: 15.33  mfu: 4.91%
[rank3]:2025-10-25 17:15:53,956 - INFO - Avg. fwd time: 68.4603 / Avg. bwd time: 137.8577 / Avg. batch time: 1727.7614 (ms) / GPU bubble ratio: 4.47%
[rank2]:2025-10-25 17:15:54,013 - INFO - Avg. fwd time: 34.6433 / Avg. bwd time: 53.7101 / Avg. batch time: 1818.2822 (ms) / GPU bubble ratio: 61.13%
[rank0]:2025-10-25 17:15:54,150 - INFO - Avg. fwd time: 39.6978 / Avg. bwd time: 59.9939 / Avg. batch time: 2036.8964 (ms) / GPU bubble ratio: 60.85%
[rank1]:2025-10-25 17:15:54,088 - INFO - Avg. fwd time: 50.1066 / Avg. bwd time: 71.9387 / Avg. batch time: 1939.2451 (ms) / GPU bubble ratio: 49.65%
[rank2]:2025-10-25 17:18:40,296 - INFO -  step: 40  loss: -4.0000  grad_norm:  2.1309  memory:  7.21GiB(15.18%)  tps: 1,947  tflops: 15.22  mfu: 4.88%
[rank3]:2025-10-25 17:18:40,308 - INFO -  step: 40  loss:  1.2757  grad_norm:  2.1309  memory: 24.67GiB(51.93%)  tps: 1,947  tflops: 15.22  mfu: 4.88%
[rank0]:2025-10-25 17:18:40,316 - INFO -  step: 40  loss: -4.0000  grad_norm:  2.1309  memory: 14.87GiB(31.30%)  tps: 1,947  tflops: 15.22  mfu: 4.88%
[rank1]:2025-10-25 17:18:40,301 - INFO -  step: 40  loss: -4.0000  grad_norm:  2.1309  memory: 10.73GiB(22.58%)  tps: 1,947  tflops: 15.22  mfu: 4.88%
[rank3]:2025-10-25 17:18:42,237 - INFO - Avg. fwd time: 69.3556 / Avg. bwd time: 139.2425 / Avg. batch time: 1735.8071 (ms) / GPU bubble ratio: 3.86%
[rank2]:2025-10-25 17:18:42,294 - INFO - Avg. fwd time: 35.1570 / Avg. bwd time: 54.2662 / Avg. batch time: 1826.7492 (ms) / GPU bubble ratio: 60.84%
[rank1]:2025-10-25 17:18:42,373 - INFO - Avg. fwd time: 50.4025 / Avg. bwd time: 72.6596 / Avg. batch time: 1948.6842 (ms) / GPU bubble ratio: 49.48%
[rank0]:2025-10-25 17:18:42,436 - INFO - Avg. fwd time: 40.1821 / Avg. bwd time: 60.5674 / Avg. batch time: 2047.1194 (ms) / GPU bubble ratio: 60.63%
[rank0]:2025-10-25 17:19:56,299 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-25 17:21:29,013 - INFO -  step: 60  loss: -4.0000  grad_norm:  0.5366  memory:  7.21GiB(15.18%)  tps: 1,942  tflops: 15.18  mfu: 4.87%
[rank3]:2025-10-25 17:21:29,025 - INFO -  step: 60  loss:  1.2100  grad_norm:  0.5366  memory: 24.67GiB(51.93%)  tps: 1,942  tflops: 15.18  mfu: 4.87%
[rank1]:2025-10-25 17:21:29,018 - INFO -  step: 60  loss: -4.0000  grad_norm:  0.5366  memory: 10.73GiB(22.58%)  tps: 1,942  tflops: 15.18  mfu: 4.87%
[rank0]:2025-10-25 17:21:29,034 - INFO -  step: 60  loss: -4.0000  grad_norm:  0.5366  memory: 14.87GiB(31.30%)  tps: 1,942  tflops: 15.18  mfu: 4.87%
[rank3]:2025-10-25 17:21:30,979 - INFO - Avg. fwd time: 69.7668 / Avg. bwd time: 139.9491 / Avg. batch time: 1741.3076 (ms) / GPU bubble ratio: 3.65%
[rank1]:2025-10-25 17:21:31,113 - INFO - Avg. fwd time: 50.5255 / Avg. bwd time: 72.7928 / Avg. batch time: 1953.8630 (ms) / GPU bubble ratio: 49.51%
[rank2]:2025-10-25 17:21:31,039 - INFO - Avg. fwd time: 35.3337 / Avg. bwd time: 54.5008 / Avg. batch time: 1832.7514 (ms) / GPU bubble ratio: 60.79%
[rank0]:2025-10-25 17:21:31,175 - INFO - Avg. fwd time: 40.3627 / Avg. bwd time: 60.8085 / Avg. batch time: 2052.3734 (ms) / GPU bubble ratio: 60.56%
[rank2]:2025-10-25 17:24:17,530 - INFO -  step: 80  loss: -4.0000  grad_norm:  0.5012  memory:  7.21GiB(15.18%)  tps: 1,945  tflops: 15.20  mfu: 4.87%
[rank1]:2025-10-25 17:24:17,530 - INFO -  step: 80  loss: -4.0000  grad_norm:  0.5012  memory: 10.73GiB(22.58%)  tps: 1,945  tflops: 15.20  mfu: 4.87%
[rank3]:2025-10-25 17:24:17,537 - INFO -  step: 80  loss:  1.1799  grad_norm:  0.5012  memory: 24.67GiB(51.93%)  tps: 1,945  tflops: 15.20  mfu: 4.87%
[rank0]:2025-10-25 17:24:17,545 - INFO -  step: 80  loss: -4.0000  grad_norm:  0.5012  memory: 14.87GiB(31.30%)  tps: 1,945  tflops: 15.20  mfu: 4.87%
[rank3]:2025-10-25 17:24:19,470 - INFO - Avg. fwd time: 69.8938 / Avg. bwd time: 140.1812 / Avg. batch time: 1742.4431 (ms) / GPU bubble ratio: 3.55%
[rank2]:2025-10-25 17:24:19,526 - INFO - Avg. fwd time: 35.4338 / Avg. bwd time: 54.6130 / Avg. batch time: 1833.9246 (ms) / GPU bubble ratio: 60.72%
[rank1]:2025-10-25 17:24:19,608 - INFO - Avg. fwd time: 50.3984 / Avg. bwd time: 72.9655 / Avg. batch time: 1955.3273 (ms) / GPU bubble ratio: 49.53%
[rank0]:2025-10-25 17:24:19,671 - INFO - Avg. fwd time: 40.3905 / Avg. bwd time: 60.9223 / Avg. batch time: 2054.1385 (ms) / GPU bubble ratio: 60.54%
[rank3]:2025-10-25 17:24:35,407 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 17:24:36,344 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 17:24:36,422 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 17:24:36,483 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 17:26:57,490 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-25 17:27:05,959 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.4903  memory:  7.21GiB(15.18%)  tps: 1,946  tflops: 15.21  mfu: 4.87%
[rank1]:2025-10-25 17:27:05,965 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.4903  memory: 10.73GiB(22.58%)  tps: 1,945  tflops: 15.21  mfu: 4.87%
[rank3]:2025-10-25 17:27:05,972 - INFO -  step: 100  loss:  1.1786  grad_norm:  0.4903  memory: 24.67GiB(51.93%)  tps: 1,945  tflops: 15.21  mfu: 4.87%
[rank0]:2025-10-25 17:27:05,979 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.4903  memory: 14.87GiB(31.30%)  tps: 1,945  tflops: 15.21  mfu: 4.87%
[rank3]:2025-10-25 17:27:06,235 - INFO - Pipeline schedule is saved as: /home/shcho/torchtitan/images/1023_1F1B_nofreeze_dm1/pipeline_schedule/251025_1727_real_step100_rank3.svg
[rank3]:> Batch Time: 1984.97 ms, GPU Bubble Ratio: 59.24%, 50.32%, 63.92%, 15.09%
[rank3]:2025-10-25 17:27:08,060 - INFO - Avg. fwd time: 69.9888 / Avg. bwd time: 140.3279 / Avg. batch time: 1743.3342 (ms) / GPU bubble ratio: 3.49%
[rank2]:2025-10-25 17:27:08,116 - INFO - Avg. fwd time: 35.5201 / Avg. bwd time: 54.6793 / Avg. batch time: 1835.1763 (ms) / GPU bubble ratio: 60.68%
[rank1]:2025-10-25 17:27:08,188 - INFO - Avg. fwd time: 50.3326 / Avg. bwd time: 73.0377 / Avg. batch time: 1956.4647 (ms) / GPU bubble ratio: 49.55%
[rank0]:2025-10-25 17:27:08,249 - INFO - Avg. fwd time: 40.3894 / Avg. bwd time: 60.9918 / Avg. batch time: 2055.3515 (ms) / GPU bubble ratio: 60.54%
[rank3]:2025-10-25 17:29:55,222 - INFO -  step: 120  loss:  1.1287  grad_norm:  0.5574  memory: 24.67GiB(51.93%)  tps: 1,936  tflops: 15.14  mfu: 4.85%
[rank0]:2025-10-25 17:29:55,230 - INFO -  step: 120  loss: -4.0000  grad_norm:  0.5574  memory: 14.87GiB(31.30%)  tps: 1,936  tflops: 15.14  mfu: 4.85%
[rank2]:2025-10-25 17:29:55,209 - INFO -  step: 120  loss: -4.0000  grad_norm:  0.5574  memory:  7.21GiB(15.18%)  tps: 1,936  tflops: 15.14  mfu: 4.85%
[rank1]:2025-10-25 17:29:55,213 - INFO -  step: 120  loss: -4.0000  grad_norm:  0.5574  memory: 10.73GiB(22.58%)  tps: 1,936  tflops: 15.14  mfu: 4.85%
[rank3]:2025-10-25 17:29:57,119 - INFO - Avg. fwd time: 70.0870 / Avg. bwd time: 140.5411 / Avg. batch time: 1745.1346 (ms) / GPU bubble ratio: 3.44%
[rank2]:2025-10-25 17:29:57,176 - INFO - Avg. fwd time: 35.5522 / Avg. bwd time: 54.7259 / Avg. batch time: 1837.1480 (ms) / GPU bubble ratio: 60.69%
[rank1]:2025-10-25 17:29:57,259 - INFO - Avg. fwd time: 50.3995 / Avg. bwd time: 73.0542 / Avg. batch time: 1958.0862 (ms) / GPU bubble ratio: 49.56%
[rank0]:2025-10-25 17:29:57,321 - INFO - Avg. fwd time: 40.5115 / Avg. bwd time: 61.0543 / Avg. batch time: 2057.1034 (ms) / GPU bubble ratio: 60.50%
[rank3]:2025-10-25 17:32:43,549 - INFO -  step: 140  loss:  1.1524  grad_norm:  0.4514  memory: 24.67GiB(51.93%)  tps: 1,947  tflops: 15.22  mfu: 4.88%
[rank0]:2025-10-25 17:32:43,558 - INFO -  step: 140  loss: -4.0000  grad_norm:  0.4514  memory: 14.87GiB(31.30%)  tps: 1,947  tflops: 15.22  mfu: 4.88%
[rank1]:2025-10-25 17:32:43,548 - INFO -  step: 140  loss: -4.0000  grad_norm:  0.4514  memory: 10.73GiB(22.58%)  tps: 1,947  tflops: 15.22  mfu: 4.88%
[rank2]:2025-10-25 17:32:43,536 - INFO -  step: 140  loss: -4.0000  grad_norm:  0.4514  memory:  7.21GiB(15.18%)  tps: 1,947  tflops: 15.22  mfu: 4.88%
[rank3]:2025-10-25 17:32:45,465 - INFO - Avg. fwd time: 70.1006 / Avg. bwd time: 140.5454 / Avg. batch time: 1744.7736 (ms) / GPU bubble ratio: 3.42%
[rank2]:2025-10-25 17:32:45,528 - INFO - Avg. fwd time: 35.5678 / Avg. bwd time: 54.7880 / Avg. batch time: 1836.8178 (ms) / GPU bubble ratio: 60.65%
[rank0]:2025-10-25 17:32:45,668 - INFO - Avg. fwd time: 40.5134 / Avg. bwd time: 61.1014 / Avg. batch time: 2057.0650 (ms) / GPU bubble ratio: 60.48%
[rank1]:2025-10-25 17:32:45,600 - INFO - Avg. fwd time: 50.5220 / Avg. bwd time: 73.1934 / Avg. batch time: 1957.9075 (ms) / GPU bubble ratio: 49.45%
[rank0]:2025-10-25 17:33:59,239 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-25 17:35:31,978 - INFO -  step: 160  loss: -4.0000  grad_norm:  0.4618  memory: 10.73GiB(22.58%)  tps: 1,946  tflops: 15.21  mfu: 4.87%
[rank0]:2025-10-25 17:35:31,992 - INFO -  step: 160  loss: -4.0000  grad_norm:  0.4618  memory: 14.87GiB(31.30%)  tps: 1,945  tflops: 15.21  mfu: 4.87%
[rank2]:2025-10-25 17:35:31,973 - INFO -  step: 160  loss: -4.0000  grad_norm:  0.4618  memory:  7.21GiB(15.18%)  tps: 1,945  tflops: 15.21  mfu: 4.87%
[rank3]:2025-10-25 17:35:31,985 - INFO -  step: 160  loss:  1.1176  grad_norm:  0.4618  memory: 24.67GiB(51.93%)  tps: 1,945  tflops: 15.21  mfu: 4.87%
[rank3]:2025-10-25 17:35:33,925 - INFO - Avg. fwd time: 70.1122 / Avg. bwd time: 140.5697 / Avg. batch time: 1744.6875 (ms) / GPU bubble ratio: 3.39%
[rank2]:2025-10-25 17:35:33,981 - INFO - Avg. fwd time: 35.6048 / Avg. bwd time: 54.8172 / Avg. batch time: 1836.6694 (ms) / GPU bubble ratio: 60.61%
[rank1]:2025-10-25 17:35:34,060 - INFO - Avg. fwd time: 50.5157 / Avg. bwd time: 73.2703 / Avg. batch time: 1957.9049 (ms) / GPU bubble ratio: 49.42%
[rank0]:2025-10-25 17:35:34,123 - INFO - Avg. fwd time: 40.5282 / Avg. bwd time: 61.1594 / Avg. batch time: 2057.1651 (ms) / GPU bubble ratio: 60.46%
[rank3]:2025-10-25 17:36:09,084 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 17:36:10,014 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 17:36:10,093 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 17:36:10,160 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 17:38:20,969 - INFO -  step: 180  loss: -4.0000  grad_norm:  0.4911  memory:  7.21GiB(15.18%)  tps: 1,939  tflops: 15.16  mfu: 4.86%
[rank1]:2025-10-25 17:38:20,974 - INFO -  step: 180  loss: -4.0000  grad_norm:  0.4911  memory: 10.73GiB(22.58%)  tps: 1,939  tflops: 15.16  mfu: 4.86%
[rank0]:2025-10-25 17:38:20,989 - INFO -  step: 180  loss: -4.0000  grad_norm:  0.4911  memory: 14.87GiB(31.30%)  tps: 1,939  tflops: 15.16  mfu: 4.86%
[rank3]:2025-10-25 17:38:20,981 - INFO -  step: 180  loss:  1.0987  grad_norm:  0.4911  memory: 24.67GiB(51.93%)  tps: 1,939  tflops: 15.16  mfu: 4.86%
[rank3]:2025-10-25 17:38:22,892 - INFO - Avg. fwd time: 70.1619 / Avg. bwd time: 140.6419 / Avg. batch time: 1745.3750 (ms) / GPU bubble ratio: 3.38%
[rank2]:2025-10-25 17:38:22,954 - INFO - Avg. fwd time: 35.6318 / Avg. bwd time: 54.8401 / Avg. batch time: 1837.3320 (ms) / GPU bubble ratio: 60.61%
[rank1]:2025-10-25 17:38:23,037 - INFO - Avg. fwd time: 50.5512 / Avg. bwd time: 73.2724 / Avg. batch time: 1958.6678 (ms) / GPU bubble ratio: 49.43%
[rank0]:2025-10-25 17:38:23,106 - INFO - Avg. fwd time: 40.5492 / Avg. bwd time: 61.2009 / Avg. batch time: 2057.9932 (ms) / GPU bubble ratio: 60.45%
[rank0]:2025-10-25 17:41:00,868 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-25 17:41:09,343 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.4348  memory: 10.73GiB(22.58%)  tps: 1,946  tflops: 15.21  mfu: 4.88%
[rank0]:2025-10-25 17:41:09,352 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.4348  memory: 14.87GiB(31.30%)  tps: 1,946  tflops: 15.22  mfu: 4.88%
[rank3]:2025-10-25 17:41:09,349 - INFO -  step: 200  loss:  1.0917  grad_norm:  0.4348  memory: 24.67GiB(51.93%)  tps: 1,946  tflops: 15.21  mfu: 4.88%
[rank2]:2025-10-25 17:41:09,337 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.4348  memory:  7.21GiB(15.18%)  tps: 1,946  tflops: 15.21  mfu: 4.88%
[rank3]:2025-10-25 17:41:09,592 - INFO - Pipeline schedule is saved as: /home/shcho/torchtitan/images/1023_1F1B_nofreeze_dm1/pipeline_schedule/251025_1741_real_step200_rank3.svg
[rank3]:> Batch Time: 1986.31 ms, GPU Bubble Ratio: 59.13%, 50.27%, 63.84%, 15.13%
[rank3]:2025-10-25 17:41:11,410 - INFO - Avg. fwd time: 70.1785 / Avg. bwd time: 140.6331 / Avg. batch time: 1745.1993 (ms) / GPU bubble ratio: 3.36%
[rank2]:2025-10-25 17:41:11,468 - INFO - Avg. fwd time: 35.6580 / Avg. bwd time: 54.8397 / Avg. batch time: 1837.2144 (ms) / GPU bubble ratio: 60.59%
[rank1]:2025-10-25 17:41:11,550 - INFO - Avg. fwd time: 50.4817 / Avg. bwd time: 73.2540 / Avg. batch time: 1958.5868 (ms) / GPU bubble ratio: 49.46%
[rank0]:2025-10-25 17:41:11,615 - INFO - Avg. fwd time: 40.5562 / Avg. bwd time: 61.2519 / Avg. batch time: 2057.9868 (ms) / GPU bubble ratio: 60.42%
[rank2]:2025-10-25 17:43:58,096 - INFO -  step: 220  loss: -4.0000  grad_norm:  0.4701  memory:  7.21GiB(15.18%)  tps: 1,942  tflops: 15.18  mfu: 4.87%
[rank0]:2025-10-25 17:43:58,116 - INFO -  step: 220  loss: -4.0000  grad_norm:  0.4701  memory: 14.87GiB(31.30%)  tps: 1,942  tflops: 15.18  mfu: 4.87%
[rank1]:2025-10-25 17:43:58,103 - INFO -  step: 220  loss: -4.0000  grad_norm:  0.4701  memory: 10.73GiB(22.58%)  tps: 1,942  tflops: 15.18  mfu: 4.87%
[rank3]:2025-10-25 17:43:58,108 - INFO -  step: 220  loss:  1.0695  grad_norm:  0.4701  memory: 24.67GiB(51.93%)  tps: 1,942  tflops: 15.18  mfu: 4.87%
[rank2]:2025-10-25 17:44:00,066 - INFO - Avg. fwd time: 35.6747 / Avg. bwd time: 54.8543 / Avg. batch time: 1837.2966 (ms) / GPU bubble ratio: 60.58%
[rank3]:2025-10-25 17:44:00,008 - INFO - Avg. fwd time: 70.1887 / Avg. bwd time: 140.6521 / Avg. batch time: 1745.2448 (ms) / GPU bubble ratio: 3.35%
[rank1]:2025-10-25 17:44:00,141 - INFO - Avg. fwd time: 50.4854 / Avg. bwd time: 73.2218 / Avg. batch time: 1958.6188 (ms) / GPU bubble ratio: 49.47%
[rank0]:2025-10-25 17:44:00,204 - INFO - Avg. fwd time: 40.5781 / Avg. bwd time: 61.2771 / Avg. batch time: 2058.0343 (ms) / GPU bubble ratio: 60.41%
[rank2]:2025-10-25 17:46:47,057 - INFO -  step: 240  loss: -4.0000  grad_norm:  0.4637  memory:  7.21GiB(15.18%)  tps: 1,939  tflops: 15.16  mfu: 4.86%
[rank0]:2025-10-25 17:46:47,071 - INFO -  step: 240  loss: -4.0000  grad_norm:  0.4637  memory: 14.87GiB(31.30%)  tps: 1,939  tflops: 15.16  mfu: 4.86%
[rank1]:2025-10-25 17:46:47,062 - INFO -  step: 240  loss: -4.0000  grad_norm:  0.4637  memory: 10.73GiB(22.58%)  tps: 1,939  tflops: 15.16  mfu: 4.86%
[rank3]:2025-10-25 17:46:47,069 - INFO -  step: 240  loss:  1.0249  grad_norm:  0.4637  memory: 24.67GiB(51.93%)  tps: 1,939  tflops: 15.16  mfu: 4.86%
[rank3]:2025-10-25 17:46:48,990 - INFO - Avg. fwd time: 70.2179 / Avg. bwd time: 140.7159 / Avg. batch time: 1745.8309 (ms) / GPU bubble ratio: 3.34%
[rank2]:2025-10-25 17:46:49,047 - INFO - Avg. fwd time: 35.6820 / Avg. bwd time: 54.8699 / Avg. batch time: 1837.9094 (ms) / GPU bubble ratio: 60.58%
[rank0]:2025-10-25 17:46:49,188 - INFO - Avg. fwd time: 40.6073 / Avg. bwd time: 61.2863 / Avg. batch time: 2058.4999 (ms) / GPU bubble ratio: 60.40%
[rank1]:2025-10-25 17:46:49,119 - INFO - Avg. fwd time: 50.5102 / Avg. bwd time: 73.1957 / Avg. batch time: 1959.0810 (ms) / GPU bubble ratio: 49.48%
[rank3]:2025-10-25 17:47:42,960 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 17:47:43,883 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 17:47:43,952 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 17:47:44,018 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 17:48:02,894 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-25 17:49:35,284 - INFO -  step: 260  loss: -4.0000  grad_norm:  0.4577  memory:  7.21GiB(15.18%)  tps: 1,948  tflops: 15.23  mfu: 4.88%
[rank1]:2025-10-25 17:49:35,289 - INFO -  step: 260  loss: -4.0000  grad_norm:  0.4577  memory: 10.73GiB(22.58%)  tps: 1,948  tflops: 15.23  mfu: 4.88%
[rank0]:2025-10-25 17:49:35,302 - INFO -  step: 260  loss: -4.0000  grad_norm:  0.4577  memory: 14.87GiB(31.30%)  tps: 1,948  tflops: 15.23  mfu: 4.88%
[rank3]:2025-10-25 17:49:35,297 - INFO -  step: 260  loss:  1.0392  grad_norm:  0.4577  memory: 24.67GiB(51.93%)  tps: 1,948  tflops: 15.23  mfu: 4.88%
[rank3]:2025-10-25 17:49:37,225 - INFO - Avg. fwd time: 70.2189 / Avg. bwd time: 140.7125 / Avg. batch time: 1745.6758 (ms) / GPU bubble ratio: 3.34%
[rank2]:2025-10-25 17:49:37,282 - INFO - Avg. fwd time: 35.6972 / Avg. bwd time: 54.8769 / Avg. batch time: 1837.7105 (ms) / GPU bubble ratio: 60.57%
[rank1]:2025-10-25 17:49:37,366 - INFO - Avg. fwd time: 50.4767 / Avg. bwd time: 73.2095 / Avg. batch time: 1958.7692 (ms) / GPU bubble ratio: 49.48%
[rank0]:2025-10-25 17:49:37,428 - INFO - Avg. fwd time: 40.6018 / Avg. bwd time: 61.3047 / Avg. batch time: 2058.1947 (ms) / GPU bubble ratio: 60.39%
[rank0]:2025-10-25 17:52:24,088 - INFO -  step: 280  loss: -4.0000  grad_norm:  0.4711  memory: 14.87GiB(31.30%)  tps: 1,941  tflops: 15.18  mfu: 4.86%
[rank2]:2025-10-25 17:52:24,072 - INFO -  step: 280  loss: -4.0000  grad_norm:  0.4711  memory:  7.21GiB(15.18%)  tps: 1,941  tflops: 15.18  mfu: 4.86%
[rank1]:2025-10-25 17:52:24,078 - INFO -  step: 280  loss: -4.0000  grad_norm:  0.4711  memory: 10.73GiB(22.58%)  tps: 1,941  tflops: 15.18  mfu: 4.86%
[rank3]:2025-10-25 17:52:24,085 - INFO -  step: 280  loss:  1.0353  grad_norm:  0.4711  memory: 24.67GiB(51.93%)  tps: 1,941  tflops: 15.18  mfu: 4.86%
[rank3]:2025-10-25 17:52:26,023 - INFO - Avg. fwd time: 70.2324 / Avg. bwd time: 140.7439 / Avg. batch time: 1745.9209 (ms) / GPU bubble ratio: 3.33%
[rank2]:2025-10-25 17:52:26,081 - INFO - Avg. fwd time: 35.7153 / Avg. bwd time: 54.8924 / Avg. batch time: 1838.0125 (ms) / GPU bubble ratio: 60.56%
[rank1]:2025-10-25 17:52:26,153 - INFO - Avg. fwd time: 50.4587 / Avg. bwd time: 73.1795 / Avg. batch time: 1958.9589 (ms) / GPU bubble ratio: 49.51%
[rank0]:2025-10-25 17:52:26,217 - INFO - Avg. fwd time: 40.6168 / Avg. bwd time: 61.3173 / Avg. batch time: 2058.3792 (ms) / GPU bubble ratio: 60.38%
[rank0]:2025-10-25 17:55:05,075 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-25 17:55:13,514 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.4626  memory: 14.87GiB(31.30%)  tps: 1,934  tflops: 15.12  mfu: 4.85%
[rank2]:2025-10-25 17:55:13,495 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.4626  memory:  7.21GiB(15.18%)  tps: 1,934  tflops: 15.12  mfu: 4.85%
[rank1]:2025-10-25 17:55:13,498 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.4626  memory: 10.73GiB(22.58%)  tps: 1,934  tflops: 15.12  mfu: 4.85%
[rank3]:2025-10-25 17:55:13,507 - INFO -  step: 300  loss:  1.0063  grad_norm:  0.4626  memory: 24.67GiB(51.93%)  tps: 1,934  tflops: 15.12  mfu: 4.85%
[rank3]:2025-10-25 17:55:13,754 - INFO - Pipeline schedule is saved as: /home/shcho/torchtitan/images/1023_1F1B_nofreeze_dm1/pipeline_schedule/251025_1755_real_step300_rank3.svg
[rank3]:> Batch Time: 1988.41 ms, GPU Bubble Ratio: 59.15%, 50.37%, 63.74%, 15.16%
[rank3]:2025-10-25 17:55:15,564 - INFO - Avg. fwd time: 70.2586 / Avg. bwd time: 140.8114 / Avg. batch time: 1746.5722 (ms) / GPU bubble ratio: 3.32%
[rank2]:2025-10-25 17:55:15,625 - INFO - Avg. fwd time: 35.7164 / Avg. bwd time: 54.9022 / Avg. batch time: 1838.8245 (ms) / GPU bubble ratio: 60.58%
[rank1]:2025-10-25 17:55:15,706 - INFO - Avg. fwd time: 50.4870 / Avg. bwd time: 73.1482 / Avg. batch time: 1959.7290 (ms) / GPU bubble ratio: 49.53%
[rank0]:2025-10-25 17:55:15,773 - INFO - Avg. fwd time: 40.6259 / Avg. bwd time: 61.3237 / Avg. batch time: 2059.1769 (ms) / GPU bubble ratio: 60.39%
[rank0]:2025-10-25 17:58:01,861 - INFO -  step: 320  loss: -4.0000  grad_norm:  0.5119  memory: 14.87GiB(31.30%)  tps: 1,946  tflops: 15.22  mfu: 4.88%
[rank2]:2025-10-25 17:58:01,841 - INFO -  step: 320  loss: -4.0000  grad_norm:  0.5119  memory:  7.21GiB(15.18%)  tps: 1,946  tflops: 15.22  mfu: 4.88%
[rank3]:2025-10-25 17:58:01,854 - INFO -  step: 320  loss:  1.0288  grad_norm:  0.5119  memory: 24.67GiB(51.93%)  tps: 1,946  tflops: 15.22  mfu: 4.88%
[rank1]:2025-10-25 17:58:01,846 - INFO -  step: 320  loss: -4.0000  grad_norm:  0.5119  memory: 10.73GiB(22.58%)  tps: 1,946  tflops: 15.22  mfu: 4.88%
[rank3]:2025-10-25 17:58:03,784 - INFO - Avg. fwd time: 70.2550 / Avg. bwd time: 140.8092 / Avg. batch time: 1746.4365 (ms) / GPU bubble ratio: 3.32%
[rank2]:2025-10-25 17:58:03,846 - INFO - Avg. fwd time: 35.7331 / Avg. bwd time: 54.8964 / Avg. batch time: 1838.6196 (ms) / GPU bubble ratio: 60.57%
[rank1]:2025-10-25 17:58:03,930 - INFO - Avg. fwd time: 50.4323 / Avg. bwd time: 73.1454 / Avg. batch time: 1959.4292 (ms) / GPU bubble ratio: 49.55%
[rank0]:2025-10-25 17:58:04,000 - INFO - Avg. fwd time: 40.6149 / Avg. bwd time: 61.3387 / Avg. batch time: 2058.8628 (ms) / GPU bubble ratio: 60.38%
[rank3]:2025-10-25 17:59:18,859 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 17:59:19,790 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 17:59:19,870 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 17:59:19,930 - WARNING - Dataset alpaca is being re-looped
[rank3]:2025-10-25 18:00:50,800 - INFO -  step: 340  loss:  0.9792  grad_norm:  0.5066  memory: 24.67GiB(51.93%)  tps: 1,940  tflops: 15.16  mfu: 4.86%
[rank2]:2025-10-25 18:00:50,787 - INFO -  step: 340  loss: -4.0000  grad_norm:  0.5066  memory:  7.21GiB(15.18%)  tps: 1,940  tflops: 15.16  mfu: 4.86%
[rank1]:2025-10-25 18:00:50,791 - INFO -  step: 340  loss: -4.0000  grad_norm:  0.5066  memory: 10.73GiB(22.58%)  tps: 1,940  tflops: 15.16  mfu: 4.86%
[rank0]:2025-10-25 18:00:50,807 - INFO -  step: 340  loss: -4.0000  grad_norm:  0.5066  memory: 14.87GiB(31.30%)  tps: 1,940  tflops: 15.16  mfu: 4.86%
[rank3]:2025-10-25 18:00:52,723 - INFO - Avg. fwd time: 70.2727 / Avg. bwd time: 140.8408 / Avg. batch time: 1746.7538 (ms) / GPU bubble ratio: 3.31%
[rank2]:2025-10-25 18:00:52,782 - INFO - Avg. fwd time: 35.7395 / Avg. bwd time: 54.9015 / Avg. batch time: 1838.9870 (ms) / GPU bubble ratio: 60.57%
[rank1]:2025-10-25 18:00:52,863 - INFO - Avg. fwd time: 50.4528 / Avg. bwd time: 73.1157 / Avg. batch time: 1959.6866 (ms) / GPU bubble ratio: 49.56%
[rank0]:2025-10-25 18:00:52,928 - INFO - Avg. fwd time: 40.6322 / Avg. bwd time: 61.3549 / Avg. batch time: 2059.1259 (ms) / GPU bubble ratio: 60.38%
[rank0]:2025-10-25 18:02:07,178 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-25 18:03:40,229 - INFO -  step: 360  loss:  1.0058  grad_norm:  0.4933  memory: 24.67GiB(51.93%)  tps: 1,934  tflops: 15.12  mfu: 4.85%
[rank1]:2025-10-25 18:03:40,220 - INFO -  step: 360  loss: -4.0000  grad_norm:  0.4933  memory: 10.73GiB(22.58%)  tps: 1,934  tflops: 15.12  mfu: 4.85%
[rank2]:2025-10-25 18:03:40,217 - INFO -  step: 360  loss: -4.0000  grad_norm:  0.4933  memory:  7.21GiB(15.18%)  tps: 1,934  tflops: 15.12  mfu: 4.85%
[rank0]:2025-10-25 18:03:40,237 - INFO -  step: 360  loss: -4.0000  grad_norm:  0.4933  memory: 14.87GiB(31.30%)  tps: 1,934  tflops: 15.12  mfu: 4.85%
[rank3]:2025-10-25 18:03:42,167 - INFO - Avg. fwd time: 70.2983 / Avg. bwd time: 140.8845 / Avg. batch time: 1747.2383 (ms) / GPU bubble ratio: 3.31%
[rank2]:2025-10-25 18:03:42,230 - INFO - Avg. fwd time: 35.7402 / Avg. bwd time: 54.8993 / Avg. batch time: 1839.5029 (ms) / GPU bubble ratio: 60.58%
[rank1]:2025-10-25 18:03:42,302 - INFO - Avg. fwd time: 50.4749 / Avg. bwd time: 73.0964 / Avg. batch time: 1960.1887 (ms) / GPU bubble ratio: 49.57%
[rank0]:2025-10-25 18:03:42,371 - INFO - Avg. fwd time: 40.6548 / Avg. bwd time: 61.3766 / Avg. batch time: 2059.6645 (ms) / GPU bubble ratio: 60.37%
[rank3]:2025-10-25 18:06:28,721 - INFO -  step: 380  loss:  0.9420  grad_norm:  0.4617  memory: 24.67GiB(51.93%)  tps: 1,945  tflops: 15.20  mfu: 4.87%
[rank1]:2025-10-25 18:06:28,713 - INFO -  step: 380  loss: -4.0000  grad_norm:  0.4617  memory: 10.73GiB(22.58%)  tps: 1,945  tflops: 15.20  mfu: 4.87%
[rank2]:2025-10-25 18:06:28,709 - INFO -  step: 380  loss: -4.0000  grad_norm:  0.4617  memory:  7.21GiB(15.18%)  tps: 1,945  tflops: 15.20  mfu: 4.87%
[rank0]:2025-10-25 18:06:28,727 - INFO -  step: 380  loss: -4.0000  grad_norm:  0.4617  memory: 14.87GiB(31.30%)  tps: 1,945  tflops: 15.20  mfu: 4.87%
[rank3]:2025-10-25 18:06:30,655 - INFO - Avg. fwd time: 70.2959 / Avg. bwd time: 140.8822 / Avg. batch time: 1747.1383 (ms) / GPU bubble ratio: 3.30%
[rank2]:2025-10-25 18:06:30,713 - INFO - Avg. fwd time: 35.7498 / Avg. bwd time: 54.8977 / Avg. batch time: 1839.3832 (ms) / GPU bubble ratio: 60.57%
[rank1]:2025-10-25 18:06:30,788 - INFO - Avg. fwd time: 50.4524 / Avg. bwd time: 73.0894 / Avg. batch time: 1960.0215 (ms) / GPU bubble ratio: 49.58%
[rank0]:2025-10-25 18:06:30,851 - INFO - Avg. fwd time: 40.6570 / Avg. bwd time: 61.3935 / Avg. batch time: 2059.4902 (ms) / GPU bubble ratio: 60.36%
[rank0]:2025-10-25 18:09:08,641 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-25 18:09:17,211 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.4741  memory:  7.21GiB(15.18%)  tps: 1,945  tflops: 15.20  mfu: 4.87%
[rank3]:2025-10-25 18:09:17,224 - INFO -  step: 400  loss:  0.9288  grad_norm:  0.4741  memory: 24.67GiB(51.93%)  tps: 1,945  tflops: 15.20  mfu: 4.87%
[rank1]:2025-10-25 18:09:17,215 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.4741  memory: 10.73GiB(22.58%)  tps: 1,945  tflops: 15.20  mfu: 4.87%
[rank0]:2025-10-25 18:09:17,230 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.4741  memory: 14.87GiB(31.30%)  tps: 1,945  tflops: 15.20  mfu: 4.87%
[rank3]:2025-10-25 18:09:17,475 - INFO - Pipeline schedule is saved as: /home/shcho/torchtitan/images/1023_1F1B_nofreeze_dm1/pipeline_schedule/251025_1809_real_step400_rank3.svg
[rank3]:> Batch Time: 1989.00 ms, GPU Bubble Ratio: 59.13%, 50.43%, 63.70%, 15.16%
[rank2]:2025-10-25 18:09:19,345 - INFO - Avg. fwd time: 35.7546 / Avg. bwd time: 54.9006 / Avg. batch time: 1839.4300 (ms) / GPU bubble ratio: 60.57%
[rank3]:2025-10-25 18:09:19,286 - INFO - Avg. fwd time: 70.2917 / Avg. bwd time: 140.8893 / Avg. batch time: 1747.1052 (ms) / GPU bubble ratio: 3.30%
[rank1]:2025-10-25 18:09:19,426 - INFO - Avg. fwd time: 50.4599 / Avg. bwd time: 73.0734 / Avg. batch time: 1959.9941 (ms) / GPU bubble ratio: 49.58%
[rank0]:2025-10-25 18:09:19,491 - INFO - Avg. fwd time: 40.6595 / Avg. bwd time: 61.3957 / Avg. batch time: 2059.4357 (ms) / GPU bubble ratio: 60.36%
[rank3]:2025-10-25 18:10:53,476 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 18:10:54,426 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 18:10:54,495 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 18:10:54,556 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 18:12:06,536 - INFO -  step: 420  loss: -4.0000  grad_norm:  0.4437  memory:  7.21GiB(15.18%)  tps: 1,935  tflops: 15.13  mfu: 4.85%
[rank3]:2025-10-25 18:12:06,548 - INFO -  step: 420  loss:  0.8979  grad_norm:  0.4437  memory: 24.67GiB(51.93%)  tps: 1,935  tflops: 15.13  mfu: 4.85%
[rank1]:2025-10-25 18:12:06,547 - INFO -  step: 420  loss: -4.0000  grad_norm:  0.4437  memory: 10.73GiB(22.58%)  tps: 1,935  tflops: 15.13  mfu: 4.85%
[rank0]:2025-10-25 18:12:06,561 - INFO -  step: 420  loss: -4.0000  grad_norm:  0.4437  memory: 14.87GiB(31.30%)  tps: 1,935  tflops: 15.13  mfu: 4.85%
[rank3]:2025-10-25 18:12:08,439 - INFO - Avg. fwd time: 70.3015 / Avg. bwd time: 140.9210 / Avg. batch time: 1747.3863 (ms) / GPU bubble ratio: 3.30%
[rank2]:2025-10-25 18:12:08,498 - INFO - Avg. fwd time: 35.7525 / Avg. bwd time: 54.9055 / Avg. batch time: 1839.7207 (ms) / GPU bubble ratio: 60.58%
[rank1]:2025-10-25 18:12:08,570 - INFO - Avg. fwd time: 50.5181 / Avg. bwd time: 73.1228 / Avg. batch time: 1960.2678 (ms) / GPU bubble ratio: 49.54%
[rank0]:2025-10-25 18:12:08,641 - INFO - Avg. fwd time: 40.6645 / Avg. bwd time: 61.4126 / Avg. batch time: 2059.7149 (ms) / GPU bubble ratio: 60.35%
[rank2]:2025-10-25 18:14:55,069 - INFO -  step: 440  loss: -4.0000  grad_norm:  0.4694  memory:  7.21GiB(15.18%)  tps: 1,944  tflops: 15.20  mfu: 4.87%
[rank3]:2025-10-25 18:14:55,081 - INFO -  step: 440  loss:  0.9151  grad_norm:  0.4694  memory: 24.67GiB(51.93%)  tps: 1,944  tflops: 15.20  mfu: 4.87%
[rank1]:2025-10-25 18:14:55,075 - INFO -  step: 440  loss: -4.0000  grad_norm:  0.4694  memory: 10.73GiB(22.58%)  tps: 1,944  tflops: 15.20  mfu: 4.87%
[rank0]:2025-10-25 18:14:55,089 - INFO -  step: 440  loss: -4.0000  grad_norm:  0.4694  memory: 14.87GiB(31.30%)  tps: 1,944  tflops: 15.20  mfu: 4.87%
[rank3]:2025-10-25 18:14:57,014 - INFO - Avg. fwd time: 70.3039 / Avg. bwd time: 140.9237 / Avg. batch time: 1747.3816 (ms) / GPU bubble ratio: 3.29%
[rank2]:2025-10-25 18:14:57,073 - INFO - Avg. fwd time: 35.7584 / Avg. bwd time: 54.9092 / Avg. batch time: 1839.7096 (ms) / GPU bubble ratio: 60.57%
[rank1]:2025-10-25 18:14:57,157 - INFO - Avg. fwd time: 50.5194 / Avg. bwd time: 73.1329 / Avg. batch time: 1960.1944 (ms) / GPU bubble ratio: 49.53%
[rank0]:2025-10-25 18:14:57,221 - INFO - Avg. fwd time: 40.6734 / Avg. bwd time: 61.4251 / Avg. batch time: 2059.6296 (ms) / GPU bubble ratio: 60.34%
[rank0]:2025-10-25 18:16:10,945 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-25 18:17:43,855 - INFO -  step: 460  loss: -4.0000  grad_norm:  0.5255  memory: 10.73GiB(22.58%)  tps: 1,941  tflops: 15.18  mfu: 4.86%
[rank2]:2025-10-25 18:17:43,850 - INFO -  step: 460  loss: -4.0000  grad_norm:  0.5255  memory:  7.21GiB(15.18%)  tps: 1,941  tflops: 15.18  mfu: 4.86%
[rank0]:2025-10-25 18:17:43,872 - INFO -  step: 460  loss: -4.0000  grad_norm:  0.5255  memory: 14.87GiB(31.30%)  tps: 1,941  tflops: 15.18  mfu: 4.86%
[rank3]:2025-10-25 18:17:43,863 - INFO -  step: 460  loss:  0.9708  grad_norm:  0.5255  memory: 24.67GiB(51.93%)  tps: 1,941  tflops: 15.18  mfu: 4.86%
[rank3]:2025-10-25 18:17:45,802 - INFO - Avg. fwd time: 70.3101 / Avg. bwd time: 140.9318 / Avg. batch time: 1747.4535 (ms) / GPU bubble ratio: 3.29%
[rank2]:2025-10-25 18:17:45,861 - INFO - Avg. fwd time: 35.7588 / Avg. bwd time: 54.9061 / Avg. batch time: 1839.7542 (ms) / GPU bubble ratio: 60.58%
[rank1]:2025-10-25 18:17:45,946 - INFO - Avg. fwd time: 50.5042 / Avg. bwd time: 73.1165 / Avg. batch time: 1960.2226 (ms) / GPU bubble ratio: 49.55%
[rank0]:2025-10-25 18:17:46,009 - INFO - Avg. fwd time: 40.6690 / Avg. bwd time: 61.4330 / Avg. batch time: 2059.6564 (ms) / GPU bubble ratio: 60.34%
[rank3]:2025-10-25 18:20:33,221 - INFO -  step: 480  loss:  0.9336  grad_norm:  0.5059  memory: 24.67GiB(51.93%)  tps: 1,935  tflops: 15.13  mfu: 4.85%
[rank1]:2025-10-25 18:20:33,214 - INFO -  step: 480  loss: -4.0000  grad_norm:  0.5059  memory: 10.73GiB(22.58%)  tps: 1,935  tflops: 15.13  mfu: 4.85%
[rank2]:2025-10-25 18:20:33,208 - INFO -  step: 480  loss: -4.0000  grad_norm:  0.5059  memory:  7.21GiB(15.18%)  tps: 1,935  tflops: 15.13  mfu: 4.85%
[rank0]:2025-10-25 18:20:33,226 - INFO -  step: 480  loss: -4.0000  grad_norm:  0.5059  memory: 14.87GiB(31.30%)  tps: 1,935  tflops: 15.13  mfu: 4.85%
[rank3]:2025-10-25 18:20:35,137 - INFO - Avg. fwd time: 70.3230 / Avg. bwd time: 140.9650 / Avg. batch time: 1747.7855 (ms) / GPU bubble ratio: 3.29%
[rank2]:2025-10-25 18:20:35,198 - INFO - Avg. fwd time: 35.7570 / Avg. bwd time: 54.9127 / Avg. batch time: 1840.1222 (ms) / GPU bubble ratio: 60.58%
[rank1]:2025-10-25 18:20:35,280 - INFO - Avg. fwd time: 50.5179 / Avg. bwd time: 73.0865 / Avg. batch time: 1960.5440 (ms) / GPU bubble ratio: 49.56%
[rank0]:2025-10-25 18:20:35,345 - INFO - Avg. fwd time: 40.6822 / Avg. bwd time: 61.4387 / Avg. batch time: 2059.9753 (ms) / GPU bubble ratio: 60.34%
[rank3]:2025-10-25 18:22:28,159 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 18:22:29,074 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 18:22:29,154 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 18:22:29,221 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 18:23:13,580 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-25 18:23:21,995 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.4575  memory: 10.73GiB(22.58%)  tps: 1,941  tflops: 15.18  mfu: 4.86%
[rank1]:2025-10-25 18:23:21,996 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-25 18:23:21,988 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.4575  memory:  7.21GiB(15.18%)  tps: 1,941  tflops: 15.18  mfu: 4.86%
[rank2]:2025-10-25 18:23:21,988 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-25 18:23:22,003 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.4575  memory: 14.87GiB(31.30%)  tps: 1,942  tflops: 15.18  mfu: 4.86%
[rank0]:2025-10-25 18:23:22,003 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-25 18:23:22,003 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank3]:2025-10-25 18:23:22,001 - INFO -  step: 500  loss:  0.8732  grad_norm:  0.4575  memory: 24.67GiB(51.93%)  tps: 1,941  tflops: 15.18  mfu: 4.86%
[rank3]:2025-10-25 18:23:22,001 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-25 18:23:23,967 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 1.98 seconds.
[rank1]:2025-10-25 18:23:24,437 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 2.44 seconds.
[rank3]:2025-10-25 18:23:25,428 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.43 seconds.
[rank0]:2025-10-25 18:23:25,805 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-25 18:23:25,813 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.81 seconds.
[rank3]:2025-10-25 18:23:26,208 - INFO - Pipeline schedule is saved as: /home/shcho/torchtitan/images/1023_1F1B_nofreeze_dm1/pipeline_schedule/251025_1823_real_step500_rank3.svg
[rank3]:> Batch Time: 1989.47 ms, GPU Bubble Ratio: 59.13%, 50.44%, 63.68%, 15.16%
[rank3]:2025-10-25 18:23:28,193 - INFO - Avg. fwd time: 70.3253 / Avg. bwd time: 140.9841 / Avg. batch time: 1747.9214 (ms) / GPU bubble ratio: 3.29%
[rank2]:2025-10-25 18:23:28,258 - INFO - Avg. fwd time: 35.7582 / Avg. bwd time: 54.9173 / Avg. batch time: 1840.3750 (ms) / GPU bubble ratio: 60.58%
[rank1]:2025-10-25 18:23:28,343 - INFO - Avg. fwd time: 50.5071 / Avg. bwd time: 73.0785 / Avg. batch time: 1960.8123 (ms) / GPU bubble ratio: 49.58%
[rank0]:2025-10-25 18:23:28,414 - INFO - Avg. fwd time: 40.6880 / Avg. bwd time: 61.4574 / Avg. batch time: 2060.2557 (ms) / GPU bubble ratio: 60.34%
[rank3]:2025-10-25 18:26:14,569 - INFO -  step: 520  loss:  0.8943  grad_norm:  0.4982  memory: 24.67GiB(51.93%)  tps: 1,899  tflops: 14.84  mfu: 4.76%
[rank1]:2025-10-25 18:26:14,561 - INFO -  step: 520  loss: -4.0000  grad_norm:  0.4982  memory: 10.73GiB(22.58%)  tps: 1,899  tflops: 14.84  mfu: 4.76%
[rank2]:2025-10-25 18:26:14,557 - INFO -  step: 520  loss: -4.0000  grad_norm:  0.4982  memory:  7.21GiB(15.18%)  tps: 1,899  tflops: 14.84  mfu: 4.76%
[rank0]:2025-10-25 18:26:14,578 - INFO -  step: 520  loss: -4.0000  grad_norm:  0.4982  memory: 14.87GiB(31.30%)  tps: 1,899  tflops: 14.84  mfu: 4.76%
[rank3]:2025-10-25 18:26:16,512 - INFO - Avg. fwd time: 70.3217 / Avg. bwd time: 140.9690 / Avg. batch time: 1747.7442 (ms) / GPU bubble ratio: 3.29%
[rank2]:2025-10-25 18:26:16,571 - INFO - Avg. fwd time: 35.7647 / Avg. bwd time: 54.9200 / Avg. batch time: 1840.1511 (ms) / GPU bubble ratio: 60.58%
[rank1]:2025-10-25 18:26:16,644 - INFO - Avg. fwd time: 50.4812 / Avg. bwd time: 73.0704 / Avg. batch time: 1960.5629 (ms) / GPU bubble ratio: 49.59%
[rank0]:2025-10-25 18:26:16,708 - INFO - Avg. fwd time: 40.6775 / Avg. bwd time: 61.4650 / Avg. batch time: 2060.0236 (ms) / GPU bubble ratio: 60.33%
[rank1]:2025-10-25 18:29:03,913 - INFO -  step: 540  loss: -4.0000  grad_norm:  0.5257  memory: 10.73GiB(22.58%)  tps: 1,935  tflops: 15.13  mfu: 4.85%
[rank2]:2025-10-25 18:29:03,909 - INFO -  step: 540  loss: -4.0000  grad_norm:  0.5257  memory:  7.21GiB(15.18%)  tps: 1,935  tflops: 15.13  mfu: 4.85%
[rank0]:2025-10-25 18:29:03,930 - INFO -  step: 540  loss: -4.0000  grad_norm:  0.5257  memory: 14.87GiB(31.30%)  tps: 1,935  tflops: 15.13  mfu: 4.85%
[rank3]:2025-10-25 18:29:03,922 - INFO -  step: 540  loss:  0.8778  grad_norm:  0.5257  memory: 24.67GiB(51.93%)  tps: 1,935  tflops: 15.13  mfu: 4.85%
[rank3]:2025-10-25 18:29:05,862 - INFO - Avg. fwd time: 70.3339 / Avg. bwd time: 140.9999 / Avg. batch time: 1748.0576 (ms) / GPU bubble ratio: 3.28%
[rank2]:2025-10-25 18:29:05,921 - INFO - Avg. fwd time: 35.7656 / Avg. bwd time: 54.9277 / Avg. batch time: 1840.4727 (ms) / GPU bubble ratio: 60.58%
[rank1]:2025-10-25 18:29:05,994 - INFO - Avg. fwd time: 50.4899 / Avg. bwd time: 73.0527 / Avg. batch time: 1960.8241 (ms) / GPU bubble ratio: 49.60%
[rank0]:2025-10-25 18:29:06,058 - INFO - Avg. fwd time: 40.6885 / Avg. bwd time: 61.4782 / Avg. batch time: 2060.2883 (ms) / GPU bubble ratio: 60.33%
[rank0]:2025-10-25 18:30:20,102 - INFO - [GC] Peforming periodical GC collection 0.25 seconds
[rank1]:2025-10-25 18:31:52,842 - INFO -  step: 560  loss: -4.0000  grad_norm:  0.5529  memory: 10.73GiB(22.58%)  tps: 1,940  tflops: 15.16  mfu: 4.86%
[rank2]:2025-10-25 18:31:52,837 - INFO -  step: 560  loss: -4.0000  grad_norm:  0.5529  memory:  7.21GiB(15.18%)  tps: 1,940  tflops: 15.16  mfu: 4.86%
[rank3]:2025-10-25 18:31:52,849 - INFO -  step: 560  loss:  0.8862  grad_norm:  0.5529  memory: 24.67GiB(51.93%)  tps: 1,940  tflops: 15.16  mfu: 4.86%
[rank0]:2025-10-25 18:31:52,856 - INFO -  step: 560  loss: -4.0000  grad_norm:  0.5529  memory: 14.87GiB(31.30%)  tps: 1,940  tflops: 15.16  mfu: 4.86%
[rank3]:2025-10-25 18:31:54,769 - INFO - Avg. fwd time: 70.3354 / Avg. bwd time: 140.9964 / Avg. batch time: 1748.0121 (ms) / GPU bubble ratio: 3.28%
[rank2]:2025-10-25 18:31:54,829 - INFO - Avg. fwd time: 35.7685 / Avg. bwd time: 54.9271 / Avg. batch time: 1840.4054 (ms) / GPU bubble ratio: 60.58%
[rank1]:2025-10-25 18:31:54,911 - INFO - Avg. fwd time: 50.4858 / Avg. bwd time: 73.0424 / Avg. batch time: 1960.7446 (ms) / GPU bubble ratio: 49.60%
[rank0]:2025-10-25 18:31:54,976 - INFO - Avg. fwd time: 40.6916 / Avg. bwd time: 61.4905 / Avg. batch time: 2060.2247 (ms) / GPU bubble ratio: 60.32%
[rank3]:2025-10-25 18:34:06,452 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 18:34:07,298 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 18:34:07,229 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 18:34:07,363 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 18:34:41,045 - INFO -  step: 580  loss: -4.0000  grad_norm:  0.5608  memory: 10.73GiB(22.58%)  tps: 1,948  tflops: 15.23  mfu: 4.88%
[rank2]:2025-10-25 18:34:41,041 - INFO -  step: 580  loss: -4.0000  grad_norm:  0.5608  memory:  7.21GiB(15.18%)  tps: 1,948  tflops: 15.23  mfu: 4.88%
[rank0]:2025-10-25 18:34:41,060 - INFO -  step: 580  loss: -4.0000  grad_norm:  0.5608  memory: 14.87GiB(31.30%)  tps: 1,948  tflops: 15.23  mfu: 4.88%
[rank3]:2025-10-25 18:34:41,053 - INFO -  step: 580  loss:  0.8253  grad_norm:  0.5608  memory: 24.67GiB(51.93%)  tps: 1,948  tflops: 15.23  mfu: 4.88%
[rank3]:2025-10-25 18:34:42,947 - INFO - Avg. fwd time: 70.3288 / Avg. bwd time: 140.9863 / Avg. batch time: 1747.8519 (ms) / GPU bubble ratio: 3.28%
[rank2]:2025-10-25 18:34:43,006 - INFO - Avg. fwd time: 35.7805 / Avg. bwd time: 54.9321 / Avg. batch time: 1840.2361 (ms) / GPU bubble ratio: 60.56%
[rank1]:2025-10-25 18:34:43,087 - INFO - Avg. fwd time: 50.4607 / Avg. bwd time: 73.0284 / Avg. batch time: 1960.5015 (ms) / GPU bubble ratio: 49.61%
[rank0]:2025-10-25 18:34:43,151 - INFO - Avg. fwd time: 40.6855 / Avg. bwd time: 61.4898 / Avg. batch time: 2059.9574 (ms) / GPU bubble ratio: 60.32%
[rank0]:2025-10-25 18:37:21,408 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-25 18:37:29,967 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.5319  memory: 10.73GiB(22.58%)  tps: 1,940  tflops: 15.16  mfu: 4.86%
[rank2]:2025-10-25 18:37:29,963 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.5319  memory:  7.21GiB(15.18%)  tps: 1,940  tflops: 15.16  mfu: 4.86%
[rank0]:2025-10-25 18:37:29,989 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.5319  memory: 14.87GiB(31.30%)  tps: 1,940  tflops: 15.16  mfu: 4.86%
[rank3]:2025-10-25 18:37:29,976 - INFO -  step: 600  loss:  0.8413  grad_norm:  0.5319  memory: 24.67GiB(51.93%)  tps: 1,940  tflops: 15.16  mfu: 4.86%
[rank3]:2025-10-25 18:37:30,238 - INFO - Pipeline schedule is saved as: /home/shcho/torchtitan/images/1023_1F1B_nofreeze_dm1/pipeline_schedule/251025_1837_real_step600_rank3.svg
[rank3]:> Batch Time: 1988.72 ms, GPU Bubble Ratio: 59.11%, 50.47%, 63.64%, 15.15%
[rank3]:2025-10-25 18:37:32,023 - INFO - Avg. fwd time: 70.3362 / Avg. bwd time: 140.9969 / Avg. batch time: 1747.9702 (ms) / GPU bubble ratio: 3.28%
[rank2]:2025-10-25 18:37:32,086 - INFO - Avg. fwd time: 35.7829 / Avg. bwd time: 54.9325 / Avg. batch time: 1840.4122 (ms) / GPU bubble ratio: 60.57%
[rank1]:2025-10-25 18:37:32,161 - INFO - Avg. fwd time: 50.4556 / Avg. bwd time: 73.0234 / Avg. batch time: 1960.6540 (ms) / GPU bubble ratio: 49.62%
[rank0]:2025-10-25 18:37:32,232 - INFO - Avg. fwd time: 40.6928 / Avg. bwd time: 61.4904 / Avg. batch time: 2060.1038 (ms) / GPU bubble ratio: 60.32%
[rank3]:2025-10-25 18:40:19,073 - INFO -  step: 620  loss:  0.8454  grad_norm:  0.5298  memory: 24.67GiB(51.93%)  tps: 1,938  tflops: 15.15  mfu: 4.86%
[rank1]:2025-10-25 18:40:19,067 - INFO -  step: 620  loss: -4.0000  grad_norm:  0.5298  memory: 10.73GiB(22.58%)  tps: 1,938  tflops: 15.15  mfu: 4.86%
[rank2]:2025-10-25 18:40:19,061 - INFO -  step: 620  loss: -4.0000  grad_norm:  0.5298  memory:  7.21GiB(15.18%)  tps: 1,938  tflops: 15.15  mfu: 4.86%
[rank0]:2025-10-25 18:40:19,079 - INFO -  step: 620  loss: -4.0000  grad_norm:  0.5298  memory: 14.87GiB(31.30%)  tps: 1,938  tflops: 15.15  mfu: 4.86%
[rank3]:2025-10-25 18:40:21,017 - INFO - Avg. fwd time: 70.3447 / Avg. bwd time: 141.0088 / Avg. batch time: 1748.1116 (ms) / GPU bubble ratio: 3.28%
[rank2]:2025-10-25 18:40:21,076 - INFO - Avg. fwd time: 35.7850 / Avg. bwd time: 54.9317 / Avg. batch time: 1840.5526 (ms) / GPU bubble ratio: 60.57%
[rank1]:2025-10-25 18:40:21,149 - INFO - Avg. fwd time: 50.4519 / Avg. bwd time: 73.0068 / Avg. batch time: 1960.7531 (ms) / GPU bubble ratio: 49.63%
[rank0]:2025-10-25 18:40:21,214 - INFO - Avg. fwd time: 40.6928 / Avg. bwd time: 61.4977 / Avg. batch time: 2060.1922 (ms) / GPU bubble ratio: 60.32%
[rank2]:2025-10-25 18:43:07,429 - INFO -  step: 640  loss: -4.0000  grad_norm:  0.5637  memory:  7.21GiB(15.18%)  tps: 1,946  tflops: 15.21  mfu: 4.88%
[rank1]:2025-10-25 18:43:07,434 - INFO -  step: 640  loss: -4.0000  grad_norm:  0.5637  memory: 10.73GiB(22.58%)  tps: 1,946  tflops: 15.21  mfu: 4.88%
[rank3]:2025-10-25 18:43:07,442 - INFO -  step: 640  loss:  0.8124  grad_norm:  0.5637  memory: 24.67GiB(51.93%)  tps: 1,946  tflops: 15.21  mfu: 4.88%
[rank0]:2025-10-25 18:43:07,448 - INFO -  step: 640  loss: -4.0000  grad_norm:  0.5637  memory: 14.87GiB(31.30%)  tps: 1,946  tflops: 15.21  mfu: 4.88%
[rank3]:2025-10-25 18:43:09,365 - INFO - Avg. fwd time: 70.3413 / Avg. bwd time: 141.0014 / Avg. batch time: 1748.0042 (ms) / GPU bubble ratio: 3.28%
[rank2]:2025-10-25 18:43:09,425 - INFO - Avg. fwd time: 35.7857 / Avg. bwd time: 54.9313 / Avg. batch time: 1840.4262 (ms) / GPU bubble ratio: 60.57%
[rank1]:2025-10-25 18:43:09,510 - INFO - Avg. fwd time: 50.4320 / Avg. bwd time: 72.9982 / Avg. batch time: 1960.6029 (ms) / GPU bubble ratio: 49.64%
[rank0]:2025-10-25 18:43:09,575 - INFO - Avg. fwd time: 40.6886 / Avg. bwd time: 61.5004 / Avg. batch time: 2060.0371 (ms) / GPU bubble ratio: 60.32%
[rank0]:2025-10-25 18:44:23,412 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-25 18:45:42,644 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 18:45:43,564 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 18:45:43,633 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 18:45:43,694 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 18:45:56,357 - INFO -  step: 660  loss: -4.0000  grad_norm:  0.5425  memory:  7.21GiB(15.18%)  tps: 1,940  tflops: 15.16  mfu: 4.86%
[rank1]:2025-10-25 18:45:56,361 - INFO -  step: 660  loss: -4.0000  grad_norm:  0.5425  memory: 10.73GiB(22.58%)  tps: 1,940  tflops: 15.16  mfu: 4.86%
[rank3]:2025-10-25 18:45:56,369 - INFO -  step: 660  loss:  0.7883  grad_norm:  0.5425  memory: 24.67GiB(51.93%)  tps: 1,940  tflops: 15.16  mfu: 4.86%
[rank0]:2025-10-25 18:45:56,376 - INFO -  step: 660  loss: -4.0000  grad_norm:  0.5425  memory: 14.87GiB(31.30%)  tps: 1,940  tflops: 15.16  mfu: 4.86%
[rank3]:2025-10-25 18:45:58,296 - INFO - Avg. fwd time: 70.3475 / Avg. bwd time: 141.0122 / Avg. batch time: 1748.1206 (ms) / GPU bubble ratio: 3.27%
[rank2]:2025-10-25 18:45:58,355 - INFO - Avg. fwd time: 35.7874 / Avg. bwd time: 54.9300 / Avg. batch time: 1840.5429 (ms) / GPU bubble ratio: 60.57%
[rank1]:2025-10-25 18:45:58,441 - INFO - Avg. fwd time: 50.4308 / Avg. bwd time: 72.9886 / Avg. batch time: 1960.6893 (ms) / GPU bubble ratio: 49.64%
[rank0]:2025-10-25 18:45:58,505 - INFO - Avg. fwd time: 40.6910 / Avg. bwd time: 61.5049 / Avg. batch time: 2060.1092 (ms) / GPU bubble ratio: 60.31%
[rank0]:2025-10-25 18:48:44,946 - INFO -  step: 680  loss: -4.0000  grad_norm:  0.6074  memory: 14.87GiB(31.30%)  tps: 1,944  tflops: 15.20  mfu: 4.87%
[rank2]:2025-10-25 18:48:44,930 - INFO -  step: 680  loss: -4.0000  grad_norm:  0.6074  memory:  7.21GiB(15.18%)  tps: 1,944  tflops: 15.20  mfu: 4.87%
[rank1]:2025-10-25 18:48:44,936 - INFO -  step: 680  loss: -4.0000  grad_norm:  0.6074  memory: 10.73GiB(22.58%)  tps: 1,944  tflops: 15.20  mfu: 4.87%
[rank3]:2025-10-25 18:48:44,942 - INFO -  step: 680  loss:  0.7891  grad_norm:  0.6074  memory: 24.67GiB(51.93%)  tps: 1,944  tflops: 15.20  mfu: 4.87%
[rank3]:2025-10-25 18:48:46,864 - INFO - Avg. fwd time: 70.3478 / Avg. bwd time: 141.0103 / Avg. batch time: 1748.0895 (ms) / GPU bubble ratio: 3.27%
[rank2]:2025-10-25 18:48:46,928 - INFO - Avg. fwd time: 35.7892 / Avg. bwd time: 54.9286 / Avg. batch time: 1840.4870 (ms) / GPU bubble ratio: 60.57%
[rank1]:2025-10-25 18:48:47,007 - INFO - Avg. fwd time: 50.4295 / Avg. bwd time: 72.9824 / Avg. batch time: 1960.6124 (ms) / GPU bubble ratio: 49.64%
[rank0]:2025-10-25 18:48:47,076 - INFO - Avg. fwd time: 40.6880 / Avg. bwd time: 61.5130 / Avg. batch time: 2060.0592 (ms) / GPU bubble ratio: 60.31%
[rank0]:2025-10-25 18:51:24,965 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-25 18:51:33,375 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.5584  memory:  7.21GiB(15.18%)  tps: 1,945  tflops: 15.21  mfu: 4.87%
[rank0]:2025-10-25 18:51:33,394 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.5584  memory: 14.87GiB(31.30%)  tps: 1,945  tflops: 15.21  mfu: 4.87%
[rank1]:2025-10-25 18:51:33,379 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.5584  memory: 10.73GiB(22.58%)  tps: 1,945  tflops: 15.21  mfu: 4.87%
[rank3]:2025-10-25 18:51:33,387 - INFO -  step: 700  loss:  0.7949  grad_norm:  0.5584  memory: 24.67GiB(51.93%)  tps: 1,945  tflops: 15.21  mfu: 4.87%
[rank3]:2025-10-25 18:51:33,643 - INFO - Pipeline schedule is saved as: /home/shcho/torchtitan/images/1023_1F1B_nofreeze_dm1/pipeline_schedule/251025_1851_real_step700_rank3.svg
[rank3]:> Batch Time: 1988.31 ms, GPU Bubble Ratio: 59.09%, 50.50%, 63.63%, 15.15%
[rank3]:2025-10-25 18:51:35,452 - INFO - Avg. fwd time: 70.3471 / Avg. bwd time: 141.0084 / Avg. batch time: 1748.0518 (ms) / GPU bubble ratio: 3.27%
[rank2]:2025-10-25 18:51:35,512 - INFO - Avg. fwd time: 35.7898 / Avg. bwd time: 54.9271 / Avg. batch time: 1840.4842 (ms) / GPU bubble ratio: 60.57%
[rank1]:2025-10-25 18:51:35,597 - INFO - Avg. fwd time: 50.4255 / Avg. bwd time: 72.9642 / Avg. batch time: 1960.5688 (ms) / GPU bubble ratio: 49.65%
[rank0]:2025-10-25 18:51:35,661 - INFO - Avg. fwd time: 40.6861 / Avg. bwd time: 61.5132 / Avg. batch time: 2060.0085 (ms) / GPU bubble ratio: 60.31%
[rank0]:2025-10-25 18:54:22,601 - INFO -  step: 720  loss: -4.0000  grad_norm:  0.5811  memory: 14.87GiB(31.30%)  tps: 1,937  tflops: 15.14  mfu: 4.85%
[rank2]:2025-10-25 18:54:22,581 - INFO -  step: 720  loss: -4.0000  grad_norm:  0.5811  memory:  7.21GiB(15.18%)  tps: 1,937  tflops: 15.14  mfu: 4.85%
[rank1]:2025-10-25 18:54:22,591 - INFO -  step: 720  loss: -4.0000  grad_norm:  0.5811  memory: 10.73GiB(22.58%)  tps: 1,937  tflops: 15.14  mfu: 4.85%
[rank3]:2025-10-25 18:54:22,593 - INFO -  step: 720  loss:  0.7726  grad_norm:  0.5811  memory: 24.67GiB(51.93%)  tps: 1,937  tflops: 15.14  mfu: 4.85%
[rank3]:2025-10-25 18:54:24,548 - INFO - Avg. fwd time: 70.3531 / Avg. bwd time: 141.0208 / Avg. batch time: 1748.1825 (ms) / GPU bubble ratio: 3.27%
[rank2]:2025-10-25 18:54:24,615 - INFO - Avg. fwd time: 35.7901 / Avg. bwd time: 54.9286 / Avg. batch time: 1840.6194 (ms) / GPU bubble ratio: 60.57%
[rank1]:2025-10-25 18:54:24,699 - INFO - Avg. fwd time: 50.4240 / Avg. bwd time: 72.9556 / Avg. batch time: 1960.6976 (ms) / GPU bubble ratio: 49.66%
[rank0]:2025-10-25 18:54:24,768 - INFO - Avg. fwd time: 40.6912 / Avg. bwd time: 61.5177 / Avg. batch time: 2060.1461 (ms) / GPU bubble ratio: 60.31%
[rank2]:2025-10-25 18:57:11,364 - INFO -  step: 740  loss: -4.0000  grad_norm:  0.6169  memory:  7.21GiB(15.18%)  tps: 1,941  tflops: 15.18  mfu: 4.86%
[rank1]:2025-10-25 18:57:11,369 - INFO -  step: 740  loss: -4.0000  grad_norm:  0.6169  memory: 10.73GiB(22.58%)  tps: 1,941  tflops: 15.18  mfu: 4.86%
[rank3]:2025-10-25 18:57:11,377 - INFO -  step: 740  loss:  0.7636  grad_norm:  0.6169  memory: 24.67GiB(51.93%)  tps: 1,941  tflops: 15.18  mfu: 4.86%
[rank0]:2025-10-25 18:57:11,389 - INFO -  step: 740  loss: -4.0000  grad_norm:  0.6169  memory: 14.87GiB(31.30%)  tps: 1,941  tflops: 15.18  mfu: 4.86%
[rank3]:2025-10-25 18:57:13,327 - INFO - Avg. fwd time: 70.3552 / Avg. bwd time: 141.0260 / Avg. batch time: 1748.2245 (ms) / GPU bubble ratio: 3.27%
[rank2]:2025-10-25 18:57:13,387 - INFO - Avg. fwd time: 35.7887 / Avg. bwd time: 54.9270 / Avg. batch time: 1840.6572 (ms) / GPU bubble ratio: 60.57%
[rank1]:2025-10-25 18:57:13,461 - INFO - Avg. fwd time: 50.4217 / Avg. bwd time: 72.9410 / Avg. batch time: 1960.6965 (ms) / GPU bubble ratio: 49.67%
[rank0]:2025-10-25 18:57:13,526 - INFO - Avg. fwd time: 40.6938 / Avg. bwd time: 61.5234 / Avg. batch time: 2060.1472 (ms) / GPU bubble ratio: 60.31%
[rank3]:2025-10-25 18:57:16,688 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 18:57:17,610 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 18:57:17,679 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 18:57:17,740 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 18:58:27,474 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-25 19:00:00,393 - INFO -  step: 760  loss: -4.0000  grad_norm:  0.6118  memory: 10.73GiB(22.58%)  tps: 1,939  tflops: 15.16  mfu: 4.86%
[rank3]:2025-10-25 19:00:00,402 - INFO -  step: 760  loss:  0.7468  grad_norm:  0.6118  memory: 24.67GiB(51.93%)  tps: 1,939  tflops: 15.16  mfu: 4.86%
[rank2]:2025-10-25 19:00:00,389 - INFO -  step: 760  loss: -4.0000  grad_norm:  0.6118  memory:  7.21GiB(15.18%)  tps: 1,939  tflops: 15.16  mfu: 4.86%
[rank0]:2025-10-25 19:00:00,409 - INFO -  step: 760  loss: -4.0000  grad_norm:  0.6118  memory: 14.87GiB(31.30%)  tps: 1,939  tflops: 15.16  mfu: 4.86%
[rank3]:2025-10-25 19:00:02,354 - INFO - Avg. fwd time: 70.3648 / Avg. bwd time: 141.0354 / Avg. batch time: 1748.3614 (ms) / GPU bubble ratio: 3.27%
[rank2]:2025-10-25 19:00:02,417 - INFO - Avg. fwd time: 35.7893 / Avg. bwd time: 54.9289 / Avg. batch time: 1840.7943 (ms) / GPU bubble ratio: 60.57%
[rank1]:2025-10-25 19:00:02,505 - INFO - Avg. fwd time: 50.4173 / Avg. bwd time: 72.9370 / Avg. batch time: 1960.8100 (ms) / GPU bubble ratio: 49.67%
[rank0]:2025-10-25 19:00:02,578 - INFO - Avg. fwd time: 40.6944 / Avg. bwd time: 61.5288 / Avg. batch time: 2060.2587 (ms) / GPU bubble ratio: 60.31%
[rank1]:2025-10-25 19:02:49,934 - INFO -  step: 780  loss: -4.0000  grad_norm:  0.6459  memory: 10.73GiB(22.58%)  tps: 1,933  tflops: 15.11  mfu: 4.84%
[rank3]:2025-10-25 19:02:49,938 - INFO -  step: 780  loss:  0.7477  grad_norm:  0.6459  memory: 24.67GiB(51.93%)  tps: 1,933  tflops: 15.11  mfu: 4.84%
[rank2]:2025-10-25 19:02:49,926 - INFO -  step: 780  loss: -4.0000  grad_norm:  0.6459  memory:  7.21GiB(15.18%)  tps: 1,933  tflops: 15.11  mfu: 4.84%
[rank0]:2025-10-25 19:02:49,944 - INFO -  step: 780  loss: -4.0000  grad_norm:  0.6459  memory: 14.87GiB(31.30%)  tps: 1,933  tflops: 15.11  mfu: 4.84%
[rank3]:2025-10-25 19:02:51,868 - INFO - Avg. fwd time: 70.3731 / Avg. bwd time: 141.0564 / Avg. batch time: 1748.5812 (ms) / GPU bubble ratio: 3.27%
[rank2]:2025-10-25 19:02:51,928 - INFO - Avg. fwd time: 35.7882 / Avg. bwd time: 54.9318 / Avg. batch time: 1841.0269 (ms) / GPU bubble ratio: 60.58%
[rank1]:2025-10-25 19:02:52,007 - INFO - Avg. fwd time: 50.4334 / Avg. bwd time: 72.9279 / Avg. batch time: 1961.0339 (ms) / GPU bubble ratio: 49.68%
[rank0]:2025-10-25 19:02:52,072 - INFO - Avg. fwd time: 40.6937 / Avg. bwd time: 61.5279 / Avg. batch time: 2060.4898 (ms) / GPU bubble ratio: 60.31%
[rank0]:2025-10-25 19:05:29,976 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-25 19:05:38,436 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.5793  memory:  7.21GiB(15.18%)  tps: 1,945  tflops: 15.20  mfu: 4.87%
[rank1]:2025-10-25 19:05:38,445 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.5793  memory: 10.73GiB(22.58%)  tps: 1,945  tflops: 15.20  mfu: 4.87%
[rank3]:2025-10-25 19:05:38,450 - INFO -  step: 800  loss:  0.7176  grad_norm:  0.5793  memory: 24.67GiB(51.93%)  tps: 1,945  tflops: 15.20  mfu: 4.87%
[rank0]:2025-10-25 19:05:38,454 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.5793  memory: 14.87GiB(31.30%)  tps: 1,945  tflops: 15.20  mfu: 4.87%
[rank3]:2025-10-25 19:05:38,699 - INFO - Pipeline schedule is saved as: /home/shcho/torchtitan/images/1023_1F1B_nofreeze_dm1/pipeline_schedule/251025_1905_real_step800_rank3.svg
[rank3]:> Batch Time: 1988.62 ms, GPU Bubble Ratio: 59.09%, 50.53%, 63.64%, 15.14%
[rank3]:2025-10-25 19:05:40,529 - INFO - Avg. fwd time: 70.3733 / Avg. bwd time: 141.0533 / Avg. batch time: 1748.5455 (ms) / GPU bubble ratio: 3.27%
[rank2]:2025-10-25 19:05:40,588 - INFO - Avg. fwd time: 35.7903 / Avg. bwd time: 54.9281 / Avg. batch time: 1841.0067 (ms) / GPU bubble ratio: 60.58%
[rank1]:2025-10-25 19:05:40,662 - INFO - Avg. fwd time: 50.4162 / Avg. bwd time: 72.9141 / Avg. batch time: 1960.9876 (ms) / GPU bubble ratio: 49.69%
[rank0]:2025-10-25 19:05:40,727 - INFO - Avg. fwd time: 40.6893 / Avg. bwd time: 61.5317 / Avg. batch time: 2060.4421 (ms) / GPU bubble ratio: 60.31%
[rank1]:2025-10-25 19:08:27,788 - INFO -  step: 820  loss: -4.0000  grad_norm:  0.6276  memory: 10.73GiB(22.58%)  tps: 1,935  tflops: 15.13  mfu: 4.85%
[rank3]:2025-10-25 19:08:27,795 - INFO -  step: 820  loss:  0.7358  grad_norm:  0.6276  memory: 24.67GiB(51.93%)  tps: 1,935  tflops: 15.13  mfu: 4.85%
[rank2]:2025-10-25 19:08:27,782 - INFO -  step: 820  loss: -4.0000  grad_norm:  0.6276  memory:  7.21GiB(15.18%)  tps: 1,935  tflops: 15.13  mfu: 4.85%
[rank0]:2025-10-25 19:08:27,803 - INFO -  step: 820  loss: -4.0000  grad_norm:  0.6276  memory: 14.87GiB(31.30%)  tps: 1,935  tflops: 15.13  mfu: 4.85%
[rank3]:2025-10-25 19:08:29,738 - INFO - Avg. fwd time: 70.3816 / Avg. bwd time: 141.0668 / Avg. batch time: 1748.7068 (ms) / GPU bubble ratio: 3.27%
[rank2]:2025-10-25 19:08:29,798 - INFO - Avg. fwd time: 35.7881 / Avg. bwd time: 54.9290 / Avg. batch time: 1841.1758 (ms) / GPU bubble ratio: 60.58%
[rank1]:2025-10-25 19:08:29,875 - INFO - Avg. fwd time: 50.4289 / Avg. bwd time: 72.8932 / Avg. batch time: 1961.1260 (ms) / GPU bubble ratio: 49.69%
[rank0]:2025-10-25 19:08:29,941 - INFO - Avg. fwd time: 40.6857 / Avg. bwd time: 61.5341 / Avg. batch time: 2060.5825 (ms) / GPU bubble ratio: 60.31%
[rank3]:2025-10-25 19:08:52,238 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 19:08:53,006 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 19:08:53,078 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 19:08:53,142 - WARNING - Dataset alpaca is being re-looped
[rank3]:2025-10-25 19:11:16,860 - INFO -  step: 840  loss:  0.6953  grad_norm:  0.6576  memory: 24.67GiB(51.93%)  tps: 1,938  tflops: 15.15  mfu: 4.86%
[rank1]:2025-10-25 19:11:16,855 - INFO -  step: 840  loss: -4.0000  grad_norm:  0.6576  memory: 10.73GiB(22.58%)  tps: 1,938  tflops: 15.15  mfu: 4.86%
[rank2]:2025-10-25 19:11:16,848 - INFO -  step: 840  loss: -4.0000  grad_norm:  0.6576  memory:  7.21GiB(15.18%)  tps: 1,938  tflops: 15.15  mfu: 4.86%
[rank0]:2025-10-25 19:11:16,867 - INFO -  step: 840  loss: -4.0000  grad_norm:  0.6576  memory: 14.87GiB(31.30%)  tps: 1,938  tflops: 15.15  mfu: 4.86%
[rank3]:2025-10-25 19:11:18,798 - INFO - Avg. fwd time: 70.3876 / Avg. bwd time: 141.0784 / Avg. batch time: 1748.8359 (ms) / GPU bubble ratio: 3.27%
[rank2]:2025-10-25 19:11:18,858 - INFO - Avg. fwd time: 35.7888 / Avg. bwd time: 54.9311 / Avg. batch time: 1841.3018 (ms) / GPU bubble ratio: 60.58%
[rank1]:2025-10-25 19:11:18,933 - INFO - Avg. fwd time: 50.4417 / Avg. bwd time: 72.8839 / Avg. batch time: 1961.2259 (ms) / GPU bubble ratio: 49.69%
[rank0]:2025-10-25 19:11:18,998 - INFO - Avg. fwd time: 40.6824 / Avg. bwd time: 61.5414 / Avg. batch time: 2060.6830 (ms) / GPU bubble ratio: 60.31%
[rank0]:2025-10-25 19:12:32,977 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-25 19:14:06,021 - INFO -  step: 860  loss: -4.0000  grad_norm:  0.6420  memory:  7.21GiB(15.18%)  tps: 1,937  tflops: 15.14  mfu: 4.85%
[rank3]:2025-10-25 19:14:06,033 - INFO -  step: 860  loss:  0.6936  grad_norm:  0.6420  memory: 24.67GiB(51.93%)  tps: 1,937  tflops: 15.14  mfu: 4.85%
[rank1]:2025-10-25 19:14:06,029 - INFO -  step: 860  loss: -4.0000  grad_norm:  0.6420  memory: 10.73GiB(22.58%)  tps: 1,937  tflops: 15.14  mfu: 4.85%
[rank0]:2025-10-25 19:14:06,040 - INFO -  step: 860  loss: -4.0000  grad_norm:  0.6420  memory: 14.87GiB(31.30%)  tps: 1,937  tflops: 15.14  mfu: 4.85%
[rank3]:2025-10-25 19:14:07,908 - INFO - Avg. fwd time: 70.3934 / Avg. bwd time: 141.0891 / Avg. batch time: 1748.9550 (ms) / GPU bubble ratio: 3.26%
[rank2]:2025-10-25 19:14:07,974 - INFO - Avg. fwd time: 35.7900 / Avg. bwd time: 54.9330 / Avg. batch time: 1841.4288 (ms) / GPU bubble ratio: 60.59%
[rank1]:2025-10-25 19:14:08,060 - INFO - Avg. fwd time: 50.4455 / Avg. bwd time: 72.8769 / Avg. batch time: 1961.3371 (ms) / GPU bubble ratio: 49.70%
[rank0]:2025-10-25 19:14:08,132 - INFO - Avg. fwd time: 40.6826 / Avg. bwd time: 61.5443 / Avg. batch time: 2060.7872 (ms) / GPU bubble ratio: 60.32%
[rank3]:2025-10-25 19:16:55,320 - INFO -  step: 880  loss:  0.7122  grad_norm:  0.6717  memory: 24.67GiB(51.93%)  tps: 1,936  tflops: 15.13  mfu: 4.85%
[rank1]:2025-10-25 19:16:55,311 - INFO -  step: 880  loss: -4.0000  grad_norm:  0.6717  memory: 10.73GiB(22.58%)  tps: 1,936  tflops: 15.13  mfu: 4.85%
[rank2]:2025-10-25 19:16:55,307 - INFO -  step: 880  loss: -4.0000  grad_norm:  0.6717  memory:  7.21GiB(15.18%)  tps: 1,936  tflops: 15.13  mfu: 4.85%
[rank0]:2025-10-25 19:16:55,327 - INFO -  step: 880  loss: -4.0000  grad_norm:  0.6717  memory: 14.87GiB(31.30%)  tps: 1,936  tflops: 15.13  mfu: 4.85%
[rank3]:2025-10-25 19:16:57,237 - INFO - Avg. fwd time: 70.3987 / Avg. bwd time: 141.1023 / Avg. batch time: 1749.0927 (ms) / GPU bubble ratio: 3.26%
[rank2]:2025-10-25 19:16:57,303 - INFO - Avg. fwd time: 35.7905 / Avg. bwd time: 54.9424 / Avg. batch time: 1841.5759 (ms) / GPU bubble ratio: 60.58%
[rank1]:2025-10-25 19:16:57,389 - INFO - Avg. fwd time: 50.4564 / Avg. bwd time: 72.8823 / Avg. batch time: 1961.4900 (ms) / GPU bubble ratio: 49.70%
[rank0]:2025-10-25 19:16:57,461 - INFO - Avg. fwd time: 40.6877 / Avg. bwd time: 61.5461 / Avg. batch time: 2060.9425 (ms) / GPU bubble ratio: 60.32%
[rank0]:2025-10-25 19:19:36,482 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-25 19:19:44,961 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.6584  memory: 10.73GiB(22.58%)  tps: 1,932  tflops: 15.10  mfu: 4.84%
[rank2]:2025-10-25 19:19:44,955 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.6584  memory:  7.21GiB(15.18%)  tps: 1,932  tflops: 15.10  mfu: 4.84%
[rank0]:2025-10-25 19:19:44,974 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.6584  memory: 14.87GiB(31.30%)  tps: 1,932  tflops: 15.10  mfu: 4.84%
[rank3]:2025-10-25 19:19:44,967 - INFO -  step: 900  loss:  0.6562  grad_norm:  0.6584  memory: 24.67GiB(51.93%)  tps: 1,932  tflops: 15.10  mfu: 4.84%
[rank3]:2025-10-25 19:19:45,220 - INFO - Pipeline schedule is saved as: /home/shcho/torchtitan/images/1023_1F1B_nofreeze_dm1/pipeline_schedule/251025_1919_real_step900_rank3.svg
[rank3]:> Batch Time: 1989.44 ms, GPU Bubble Ratio: 59.09%, 50.52%, 63.64%, 15.14%
[rank3]:2025-10-25 19:19:47,010 - INFO - Avg. fwd time: 70.4056 / Avg. bwd time: 141.1191 / Avg. batch time: 1749.2725 (ms) / GPU bubble ratio: 3.26%
[rank2]:2025-10-25 19:19:47,074 - INFO - Avg. fwd time: 35.7911 / Avg. bwd time: 54.9462 / Avg. batch time: 1841.7963 (ms) / GPU bubble ratio: 60.59%
[rank1]:2025-10-25 19:19:47,159 - INFO - Avg. fwd time: 50.4637 / Avg. bwd time: 72.8783 / Avg. batch time: 1961.7316 (ms) / GPU bubble ratio: 49.70%
[rank0]:2025-10-25 19:19:47,230 - INFO - Avg. fwd time: 40.6875 / Avg. bwd time: 61.5469 / Avg. batch time: 2061.2020 (ms) / GPU bubble ratio: 60.32%
[rank3]:2025-10-25 19:20:29,087 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 19:20:29,146 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 19:20:29,217 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 19:20:29,285 - WARNING - Dataset alpaca is being re-looped
[rank3]:2025-10-25 19:22:33,753 - INFO -  step: 920  loss:  0.6398  grad_norm:  0.6543  memory: 24.67GiB(51.93%)  tps: 1,941  tflops: 15.18  mfu: 4.86%
[rank1]:2025-10-25 19:22:33,745 - INFO -  step: 920  loss: -4.0000  grad_norm:  0.6543  memory: 10.73GiB(22.58%)  tps: 1,941  tflops: 15.18  mfu: 4.86%
[rank2]:2025-10-25 19:22:33,741 - INFO -  step: 920  loss: -4.0000  grad_norm:  0.6543  memory:  7.21GiB(15.18%)  tps: 1,941  tflops: 15.18  mfu: 4.86%
[rank0]:2025-10-25 19:22:33,760 - INFO -  step: 920  loss: -4.0000  grad_norm:  0.6543  memory: 14.87GiB(31.30%)  tps: 1,941  tflops: 15.18  mfu: 4.86%
[rank3]:2025-10-25 19:22:35,694 - INFO - Avg. fwd time: 70.4078 / Avg. bwd time: 141.1199 / Avg. batch time: 1749.2855 (ms) / GPU bubble ratio: 3.26%
[rank2]:2025-10-25 19:22:35,757 - INFO - Avg. fwd time: 35.7903 / Avg. bwd time: 54.9478 / Avg. batch time: 1841.7871 (ms) / GPU bubble ratio: 60.59%
[rank1]:2025-10-25 19:22:35,844 - INFO - Avg. fwd time: 50.4658 / Avg. bwd time: 72.8756 / Avg. batch time: 1961.7182 (ms) / GPU bubble ratio: 49.70%
[rank0]:2025-10-25 19:22:35,911 - INFO - Avg. fwd time: 40.6849 / Avg. bwd time: 61.5513 / Avg. batch time: 2061.1797 (ms) / GPU bubble ratio: 60.32%
[rank3]:2025-10-25 19:25:23,467 - INFO -  step: 940  loss:  0.6412  grad_norm:  0.6930  memory: 24.67GiB(51.93%)  tps: 1,931  tflops: 15.09  mfu: 4.84%
[rank2]:2025-10-25 19:25:23,454 - INFO -  step: 940  loss: -4.0000  grad_norm:  0.6930  memory:  7.21GiB(15.18%)  tps: 1,931  tflops: 15.09  mfu: 4.84%
[rank1]:2025-10-25 19:25:23,458 - INFO -  step: 940  loss: -4.0000  grad_norm:  0.6930  memory: 10.73GiB(22.58%)  tps: 1,931  tflops: 15.09  mfu: 4.84%
[rank0]:2025-10-25 19:25:23,473 - INFO -  step: 940  loss: -4.0000  grad_norm:  0.6930  memory: 14.87GiB(31.30%)  tps: 1,931  tflops: 15.09  mfu: 4.84%
[rank3]:2025-10-25 19:25:25,416 - INFO - Avg. fwd time: 70.4159 / Avg. bwd time: 141.1425 / Avg. batch time: 1749.5219 (ms) / GPU bubble ratio: 3.26%
[rank2]:2025-10-25 19:25:25,484 - INFO - Avg. fwd time: 35.7880 / Avg. bwd time: 54.9497 / Avg. batch time: 1842.0280 (ms) / GPU bubble ratio: 60.59%
[rank1]:2025-10-25 19:25:25,571 - INFO - Avg. fwd time: 50.4830 / Avg. bwd time: 72.8740 / Avg. batch time: 1961.9609 (ms) / GPU bubble ratio: 49.70%
[rank0]:2025-10-25 19:25:25,642 - INFO - Avg. fwd time: 40.6894 / Avg. bwd time: 61.5544 / Avg. batch time: 2061.4240 (ms) / GPU bubble ratio: 60.32%
[rank0]:2025-10-25 19:26:39,715 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-25 19:28:12,240 - INFO -  step: 960  loss: -4.0000  grad_norm:  0.9338  memory: 10.73GiB(22.58%)  tps: 1,941  tflops: 15.18  mfu: 4.86%
[rank0]:2025-10-25 19:28:12,256 - INFO -  step: 960  loss: -4.0000  grad_norm:  0.9338  memory: 14.87GiB(31.30%)  tps: 1,941  tflops: 15.18  mfu: 4.86%
[rank3]:2025-10-25 19:28:12,247 - INFO -  step: 960  loss:  0.6367  grad_norm:  0.9338  memory: 24.67GiB(51.93%)  tps: 1,941  tflops: 15.18  mfu: 4.86%
[rank2]:2025-10-25 19:28:12,235 - INFO -  step: 960  loss: -4.0000  grad_norm:  0.9338  memory:  7.21GiB(15.18%)  tps: 1,941  tflops: 15.18  mfu: 4.86%
[rank3]:2025-10-25 19:28:14,179 - INFO - Avg. fwd time: 70.4148 / Avg. bwd time: 141.1456 / Avg. batch time: 1749.5278 (ms) / GPU bubble ratio: 3.26%
[rank2]:2025-10-25 19:28:14,241 - INFO - Avg. fwd time: 35.7853 / Avg. bwd time: 54.9473 / Avg. batch time: 1842.0148 (ms) / GPU bubble ratio: 60.59%
[rank1]:2025-10-25 19:28:14,317 - INFO - Avg. fwd time: 50.4841 / Avg. bwd time: 72.8670 / Avg. batch time: 1961.9184 (ms) / GPU bubble ratio: 49.70%
[rank0]:2025-10-25 19:28:14,383 - INFO - Avg. fwd time: 40.6902 / Avg. bwd time: 61.5631 / Avg. batch time: 2061.3907 (ms) / GPU bubble ratio: 60.32%
[rank0]:2025-10-25 19:31:01,191 - INFO -  step: 980  loss: -4.0000  grad_norm:  0.6922  memory: 14.87GiB(31.30%)  tps: 1,940  tflops: 15.16  mfu: 4.86%
[rank3]:2025-10-25 19:31:01,178 - INFO -  step: 980  loss:  0.6337  grad_norm:  0.6922  memory: 24.67GiB(51.93%)  tps: 1,940  tflops: 15.16  mfu: 4.86%
[rank2]:2025-10-25 19:31:01,165 - INFO -  step: 980  loss: -4.0000  grad_norm:  0.6922  memory:  7.21GiB(15.18%)  tps: 1,940  tflops: 15.16  mfu: 4.86%
[rank1]:2025-10-25 19:31:01,169 - INFO -  step: 980  loss: -4.0000  grad_norm:  0.6922  memory: 10.73GiB(22.58%)  tps: 1,940  tflops: 15.16  mfu: 4.86%
[rank3]:2025-10-25 19:31:03,109 - INFO - Avg. fwd time: 70.4152 / Avg. bwd time: 141.1526 / Avg. batch time: 1749.5787 (ms) / GPU bubble ratio: 3.26%
[rank2]:2025-10-25 19:31:03,170 - INFO - Avg. fwd time: 35.7829 / Avg. bwd time: 54.9454 / Avg. batch time: 1842.0541 (ms) / GPU bubble ratio: 60.60%
[rank1]:2025-10-25 19:31:03,246 - INFO - Avg. fwd time: 50.4873 / Avg. bwd time: 72.8603 / Avg. batch time: 1961.9340 (ms) / GPU bubble ratio: 49.70%
[rank0]:2025-10-25 19:31:03,313 - INFO - Avg. fwd time: 40.6879 / Avg. bwd time: 61.5622 / Avg. batch time: 2061.4026 (ms) / GPU bubble ratio: 60.32%
[rank3]:2025-10-25 19:32:06,757 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 19:32:06,817 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 19:32:06,890 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 19:32:06,952 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 19:33:42,387 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-25 19:33:50,882 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.7207  memory: 10.73GiB(22.58%)  tps: 1,931  tflops: 15.09  mfu: 4.84%
[rank1]:2025-10-25 19:33:50,882 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-25 19:33:50,897 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.7207  memory: 14.87GiB(31.30%)  tps: 1,931  tflops: 15.09  mfu: 4.84%
[rank0]:2025-10-25 19:33:50,897 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-25 19:33:50,899 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank2]:2025-10-25 19:33:50,879 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.7207  memory:  7.21GiB(15.18%)  tps: 1,931  tflops: 15.09  mfu: 4.84%
[rank2]:2025-10-25 19:33:50,879 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-25 19:33:50,891 - INFO -  step: 1000  loss:  0.6324  grad_norm:  0.7207  memory: 24.67GiB(51.93%)  tps: 1,931  tflops: 15.09  mfu: 4.84%
[rank3]:2025-10-25 19:33:50,892 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-25 19:33:52,682 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 1.80 seconds.
[rank1]:2025-10-25 19:33:53,284 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 2.40 seconds.
[rank3]:2025-10-25 19:33:54,262 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.37 seconds.
[rank0]:2025-10-25 19:33:54,493 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-25 19:33:54,500 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.60 seconds.
[rank3]:2025-10-25 19:33:54,934 - INFO - Pipeline schedule is saved as: /home/shcho/torchtitan/images/1023_1F1B_nofreeze_dm1/pipeline_schedule/251025_1933_real_step1000_rank3.svg
[rank3]:> Batch Time: 1989.66 ms, GPU Bubble Ratio: 59.08%, 50.52%, 63.66%, 15.13%
[rank3]:2025-10-25 19:33:56,738 - INFO - Avg. fwd time: 70.4229 / Avg. bwd time: 141.1722 / Avg. batch time: 1749.7879 (ms) / GPU bubble ratio: 3.26%
[rank2]:2025-10-25 19:33:56,799 - INFO - Avg. fwd time: 35.7798 / Avg. bwd time: 54.9462 / Avg. batch time: 1842.3363 (ms) / GPU bubble ratio: 60.60%
[rank1]:2025-10-25 19:33:56,874 - INFO - Avg. fwd time: 50.5006 / Avg. bwd time: 72.8517 / Avg. batch time: 1962.2299 (ms) / GPU bubble ratio: 49.71%
[rank0]:2025-10-25 19:33:56,941 - INFO - Avg. fwd time: 40.6912 / Avg. bwd time: 61.5649 / Avg. batch time: 2061.7009 (ms) / GPU bubble ratio: 60.32%
[rank1]:2025-10-25 19:36:43,911 - INFO -  step: 1020  loss: -4.0000  grad_norm:  0.6653  memory: 10.73GiB(22.58%)  tps: 1,894  tflops: 14.80  mfu: 4.75%
[rank2]:2025-10-25 19:36:43,906 - INFO -  step: 1020  loss: -4.0000  grad_norm:  0.6653  memory:  7.21GiB(15.18%)  tps: 1,894  tflops: 14.80  mfu: 4.75%
[rank3]:2025-10-25 19:36:43,918 - INFO -  step: 1020  loss:  0.6035  grad_norm:  0.6653  memory: 24.67GiB(51.93%)  tps: 1,894  tflops: 14.81  mfu: 4.75%
[rank0]:2025-10-25 19:36:43,929 - INFO -  step: 1020  loss: -4.0000  grad_norm:  0.6653  memory: 14.87GiB(31.30%)  tps: 1,894  tflops: 14.80  mfu: 4.75%
[rank3]:2025-10-25 19:36:45,828 - INFO - Avg. fwd time: 70.4243 / Avg. bwd time: 141.1778 / Avg. batch time: 1749.8393 (ms) / GPU bubble ratio: 3.26%
[rank2]:2025-10-25 19:36:45,896 - INFO - Avg. fwd time: 35.7771 / Avg. bwd time: 54.9479 / Avg. batch time: 1842.3869 (ms) / GPU bubble ratio: 60.61%
[rank1]:2025-10-25 19:36:45,984 - INFO - Avg. fwd time: 50.5090 / Avg. bwd time: 72.8529 / Avg. batch time: 1962.2729 (ms) / GPU bubble ratio: 49.71%
[rank0]:2025-10-25 19:36:46,056 - INFO - Avg. fwd time: 40.6929 / Avg. bwd time: 61.5661 / Avg. batch time: 2061.7518 (ms) / GPU bubble ratio: 60.32%
[rank3]:2025-10-25 19:39:32,961 - INFO -  step: 1040  loss:  0.5802  grad_norm:  0.7705  memory: 24.67GiB(51.93%)  tps: 1,938  tflops: 15.15  mfu: 4.86%
[rank2]:2025-10-25 19:39:32,948 - INFO -  step: 1040  loss: -4.0000  grad_norm:  0.7705  memory:  7.21GiB(15.18%)  tps: 1,938  tflops: 15.15  mfu: 4.86%
[rank0]:2025-10-25 19:39:32,968 - INFO -  step: 1040  loss: -4.0000  grad_norm:  0.7705  memory: 14.87GiB(31.30%)  tps: 1,938  tflops: 15.15  mfu: 4.86%
[rank1]:2025-10-25 19:39:32,952 - INFO -  step: 1040  loss: -4.0000  grad_norm:  0.7705  memory: 10.73GiB(22.58%)  tps: 1,938  tflops: 15.15  mfu: 4.86%
[rank3]:2025-10-25 19:39:34,910 - INFO - Avg. fwd time: 70.4262 / Avg. bwd time: 141.1865 / Avg. batch time: 1749.9160 (ms) / GPU bubble ratio: 3.26%
[rank2]:2025-10-25 19:39:34,976 - INFO - Avg. fwd time: 35.7745 / Avg. bwd time: 54.9488 / Avg. batch time: 1842.4615 (ms) / GPU bubble ratio: 60.61%
[rank0]:2025-10-25 19:39:35,132 - INFO - Avg. fwd time: 40.6937 / Avg. bwd time: 61.5693 / Avg. batch time: 2061.8048 (ms) / GPU bubble ratio: 60.32%
[rank1]:2025-10-25 19:39:35,061 - INFO - Avg. fwd time: 50.5130 / Avg. bwd time: 72.8473 / Avg. batch time: 1962.3284 (ms) / GPU bubble ratio: 49.71%
[rank0]:2025-10-25 19:40:49,556 - INFO - [GC] Peforming periodical GC collection 0.25 seconds
[rank3]:2025-10-25 19:42:22,406 - INFO -  step: 1060  loss:  0.5828  grad_norm:  0.8099  memory: 24.67GiB(51.93%)  tps: 1,934  tflops: 15.12  mfu: 4.85%
[rank2]:2025-10-25 19:42:22,393 - INFO -  step: 1060  loss: -4.0000  grad_norm:  0.8099  memory:  7.21GiB(15.18%)  tps: 1,934  tflops: 15.12  mfu: 4.85%
[rank0]:2025-10-25 19:42:22,418 - INFO -  step: 1060  loss: -4.0000  grad_norm:  0.8099  memory: 14.87GiB(31.30%)  tps: 1,934  tflops: 15.12  mfu: 4.85%
[rank1]:2025-10-25 19:42:22,397 - INFO -  step: 1060  loss: -4.0000  grad_norm:  0.8099  memory: 10.73GiB(22.58%)  tps: 1,934  tflops: 15.12  mfu: 4.85%
[rank3]:2025-10-25 19:42:24,353 - INFO - Avg. fwd time: 70.4277 / Avg. bwd time: 141.1933 / Avg. batch time: 1749.9738 (ms) / GPU bubble ratio: 3.26%
[rank2]:2025-10-25 19:42:24,415 - INFO - Avg. fwd time: 35.7735 / Avg. bwd time: 54.9505 / Avg. batch time: 1842.5111 (ms) / GPU bubble ratio: 60.61%
[rank1]:2025-10-25 19:42:24,495 - INFO - Avg. fwd time: 50.5143 / Avg. bwd time: 72.8509 / Avg. batch time: 1962.3704 (ms) / GPU bubble ratio: 49.71%
[rank0]:2025-10-25 19:42:24,562 - INFO - Avg. fwd time: 40.6918 / Avg. bwd time: 61.5738 / Avg. batch time: 2061.8637 (ms) / GPU bubble ratio: 60.32%
[rank3]:2025-10-25 19:43:45,794 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 19:43:46,558 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 19:43:46,639 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 19:43:46,704 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 19:45:10,993 - INFO -  step: 1080  loss: -4.0000  grad_norm:  0.8027  memory: 10.73GiB(22.58%)  tps: 1,944  tflops: 15.19  mfu: 4.87%
[rank3]:2025-10-25 19:45:11,002 - INFO -  step: 1080  loss:  0.5710  grad_norm:  0.8027  memory: 24.67GiB(51.93%)  tps: 1,944  tflops: 15.19  mfu: 4.87%
[rank2]:2025-10-25 19:45:10,990 - INFO -  step: 1080  loss: -4.0000  grad_norm:  0.8027  memory:  7.21GiB(15.18%)  tps: 1,944  tflops: 15.19  mfu: 4.87%
[rank0]:2025-10-25 19:45:11,008 - INFO -  step: 1080  loss: -4.0000  grad_norm:  0.8027  memory: 14.87GiB(31.30%)  tps: 1,944  tflops: 15.19  mfu: 4.87%
[rank3]:2025-10-25 19:45:12,934 - INFO - Avg. fwd time: 70.4253 / Avg. bwd time: 141.1903 / Avg. batch time: 1749.9229 (ms) / GPU bubble ratio: 3.26%
[rank2]:2025-10-25 19:45:12,995 - INFO - Avg. fwd time: 35.7705 / Avg. bwd time: 54.9505 / Avg. batch time: 1842.4415 (ms) / GPU bubble ratio: 60.61%
[rank1]:2025-10-25 19:45:13,071 - INFO - Avg. fwd time: 50.5191 / Avg. bwd time: 72.8536 / Avg. batch time: 1962.2948 (ms) / GPU bubble ratio: 49.70%
[rank0]:2025-10-25 19:45:13,138 - INFO - Avg. fwd time: 40.6914 / Avg. bwd time: 61.5768 / Avg. batch time: 2061.7924 (ms) / GPU bubble ratio: 60.32%
[rank0]:2025-10-25 19:47:51,646 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-25 19:48:00,070 - INFO -  step: 1100  loss:  0.5760  grad_norm:  0.7518  memory: 24.67GiB(51.93%)  tps: 1,938  tflops: 15.15  mfu: 4.86%
[rank2]:2025-10-25 19:48:00,058 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.7518  memory:  7.21GiB(15.18%)  tps: 1,938  tflops: 15.15  mfu: 4.86%
[rank1]:2025-10-25 19:48:00,061 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.7518  memory: 10.73GiB(22.58%)  tps: 1,938  tflops: 15.15  mfu: 4.86%
[rank0]:2025-10-25 19:48:00,076 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.7518  memory: 14.87GiB(31.30%)  tps: 1,938  tflops: 15.15  mfu: 4.86%
[rank3]:2025-10-25 19:48:00,328 - INFO - Pipeline schedule is saved as: /home/shcho/torchtitan/images/1023_1F1B_nofreeze_dm1/pipeline_schedule/251025_1948_real_step1100_rank3.svg
[rank3]:> Batch Time: 1989.88 ms, GPU Bubble Ratio: 59.07%, 50.51%, 63.68%, 15.13%
[rank3]:2025-10-25 19:48:02,141 - INFO - Avg. fwd time: 70.4272 / Avg. bwd time: 141.1949 / Avg. batch time: 1749.9679 (ms) / GPU bubble ratio: 3.26%
[rank2]:2025-10-25 19:48:02,202 - INFO - Avg. fwd time: 35.7685 / Avg. bwd time: 54.9490 / Avg. batch time: 1842.5063 (ms) / GPU bubble ratio: 60.61%
[rank1]:2025-10-25 19:48:02,277 - INFO - Avg. fwd time: 50.5249 / Avg. bwd time: 72.8513 / Avg. batch time: 1962.3610 (ms) / GPU bubble ratio: 49.70%
[rank0]:2025-10-25 19:48:02,343 - INFO - Avg. fwd time: 40.6975 / Avg. bwd time: 61.5818 / Avg. batch time: 2061.8626 (ms) / GPU bubble ratio: 60.32%
[rank2]:2025-10-25 19:50:48,979 - INFO -  step: 1120  loss: -4.0000  grad_norm:  0.8441  memory:  7.21GiB(15.18%)  tps: 1,940  tflops: 15.16  mfu: 4.86%
[rank1]:2025-10-25 19:50:48,986 - INFO -  step: 1120  loss: -4.0000  grad_norm:  0.8441  memory: 10.73GiB(22.58%)  tps: 1,940  tflops: 15.16  mfu: 4.86%
[rank3]:2025-10-25 19:50:48,991 - INFO -  step: 1120  loss:  0.5503  grad_norm:  0.8441  memory: 24.67GiB(51.93%)  tps: 1,940  tflops: 15.17  mfu: 4.86%
[rank0]:2025-10-25 19:50:49,000 - INFO -  step: 1120  loss: -4.0000  grad_norm:  0.8441  memory: 14.87GiB(31.30%)  tps: 1,940  tflops: 15.16  mfu: 4.86%
[rank3]:2025-10-25 19:50:50,923 - INFO - Avg. fwd time: 70.4263 / Avg. bwd time: 141.1971 / Avg. batch time: 1749.9713 (ms) / GPU bubble ratio: 3.26%
[rank2]:2025-10-25 19:50:50,984 - INFO - Avg. fwd time: 35.7663 / Avg. bwd time: 54.9494 / Avg. batch time: 1842.4958 (ms) / GPU bubble ratio: 60.61%
[rank1]:2025-10-25 19:50:51,060 - INFO - Avg. fwd time: 50.5291 / Avg. bwd time: 72.8505 / Avg. batch time: 1962.3398 (ms) / GPU bubble ratio: 49.70%
[rank0]:2025-10-25 19:50:51,127 - INFO - Avg. fwd time: 40.7016 / Avg. bwd time: 61.5855 / Avg. batch time: 2061.8500 (ms) / GPU bubble ratio: 60.31%
[rank0]:2025-10-25 19:53:37,774 - INFO -  step: 1140  loss: -4.0000  grad_norm:  0.7741  memory: 14.87GiB(31.30%)  tps: 1,942  tflops: 15.18  mfu: 4.86%
[rank1]:2025-10-25 19:53:37,755 - INFO -  step: 1140  loss: -4.0000  grad_norm:  0.7741  memory: 10.73GiB(22.58%)  tps: 1,942  tflops: 15.18  mfu: 4.86%
[rank2]:2025-10-25 19:53:37,750 - INFO -  step: 1140  loss: -4.0000  grad_norm:  0.7741  memory:  7.21GiB(15.18%)  tps: 1,942  tflops: 15.18  mfu: 4.86%
[rank3]:2025-10-25 19:53:37,763 - INFO -  step: 1140  loss:  0.5403  grad_norm:  0.7741  memory: 24.67GiB(51.93%)  tps: 1,942  tflops: 15.18  mfu: 4.86%
[rank3]:2025-10-25 19:53:39,685 - INFO - Avg. fwd time: 70.4269 / Avg. bwd time: 141.2008 / Avg. batch time: 1749.9991 (ms) / GPU bubble ratio: 3.26%
[rank1]:2025-10-25 19:53:39,836 - INFO - Avg. fwd time: 50.5313 / Avg. bwd time: 72.8496 / Avg. batch time: 1962.3174 (ms) / GPU bubble ratio: 49.70%
[rank2]:2025-10-25 19:53:39,751 - INFO - Avg. fwd time: 35.7635 / Avg. bwd time: 54.9467 / Avg. batch time: 1842.5028 (ms) / GPU bubble ratio: 60.61%
[rank0]:2025-10-25 19:53:39,911 - INFO - Avg. fwd time: 40.7022 / Avg. bwd time: 61.5893 / Avg. batch time: 2061.8368 (ms) / GPU bubble ratio: 60.31%
[rank0]:2025-10-25 19:54:54,268 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-25 19:55:20,683 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 19:55:21,605 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 19:55:21,685 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 19:55:21,751 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 19:56:27,317 - INFO -  step: 1160  loss: -4.0000  grad_norm:  0.7546  memory: 10.73GiB(22.58%)  tps: 1,933  tflops: 15.11  mfu: 4.84%
[rank2]:2025-10-25 19:56:27,312 - INFO -  step: 1160  loss: -4.0000  grad_norm:  0.7546  memory:  7.21GiB(15.18%)  tps: 1,933  tflops: 15.11  mfu: 4.84%
[rank3]:2025-10-25 19:56:27,325 - INFO -  step: 1160  loss:  0.5263  grad_norm:  0.7546  memory: 24.67GiB(51.93%)  tps: 1,933  tflops: 15.11  mfu: 4.84%
[rank0]:2025-10-25 19:56:27,337 - INFO -  step: 1160  loss: -4.0000  grad_norm:  0.7546  memory: 14.87GiB(31.30%)  tps: 1,932  tflops: 15.11  mfu: 4.84%
[rank3]:2025-10-25 19:56:29,258 - INFO - Avg. fwd time: 70.4317 / Avg. bwd time: 141.2135 / Avg. batch time: 1750.1326 (ms) / GPU bubble ratio: 3.26%
[rank2]:2025-10-25 19:56:29,326 - INFO - Avg. fwd time: 35.7598 / Avg. bwd time: 54.9475 / Avg. batch time: 1842.6402 (ms) / GPU bubble ratio: 60.62%
[rank1]:2025-10-25 19:56:29,415 - INFO - Avg. fwd time: 50.5380 / Avg. bwd time: 72.8492 / Avg. batch time: 1962.4702 (ms) / GPU bubble ratio: 49.70%
[rank0]:2025-10-25 19:56:29,482 - INFO - Avg. fwd time: 40.7034 / Avg. bwd time: 61.5951 / Avg. batch time: 2061.9972 (ms) / GPU bubble ratio: 60.31%
[rank1]:2025-10-25 19:59:16,042 - INFO -  step: 1180  loss: -4.0000  grad_norm:  0.8618  memory: 10.73GiB(22.58%)  tps: 1,942  tflops: 15.18  mfu: 4.87%
[rank2]:2025-10-25 19:59:16,038 - INFO -  step: 1180  loss: -4.0000  grad_norm:  0.8618  memory:  7.21GiB(15.18%)  tps: 1,942  tflops: 15.18  mfu: 4.87%
[rank3]:2025-10-25 19:59:16,051 - INFO -  step: 1180  loss:  0.5206  grad_norm:  0.8618  memory: 24.67GiB(51.93%)  tps: 1,942  tflops: 15.18  mfu: 4.87%
[rank0]:2025-10-25 19:59:16,060 - INFO -  step: 1180  loss: -4.0000  grad_norm:  0.8618  memory: 14.87GiB(31.30%)  tps: 1,942  tflops: 15.18  mfu: 4.87%
[rank3]:2025-10-25 19:59:17,981 - INFO - Avg. fwd time: 70.4308 / Avg. bwd time: 141.2132 / Avg. batch time: 1750.1154 (ms) / GPU bubble ratio: 3.25%
[rank2]:2025-10-25 19:59:18,043 - INFO - Avg. fwd time: 35.7585 / Avg. bwd time: 54.9482 / Avg. batch time: 1842.6091 (ms) / GPU bubble ratio: 60.62%
[rank1]:2025-10-25 19:59:18,119 - INFO - Avg. fwd time: 50.5453 / Avg. bwd time: 72.8477 / Avg. batch time: 1962.4230 (ms) / GPU bubble ratio: 49.70%
[rank0]:2025-10-25 19:59:18,186 - INFO - Avg. fwd time: 40.7034 / Avg. bwd time: 61.6016 / Avg. batch time: 2061.9628 (ms) / GPU bubble ratio: 60.31%
[rank0]:2025-10-25 20:01:56,206 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-25 20:02:04,689 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.7792  memory: 10.73GiB(22.58%)  tps: 1,943  tflops: 15.19  mfu: 4.87%
[rank2]:2025-10-25 20:02:04,685 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.7792  memory:  7.21GiB(15.18%)  tps: 1,943  tflops: 15.19  mfu: 4.87%
[rank3]:2025-10-25 20:02:04,699 - INFO -  step: 1200  loss:  0.5386  grad_norm:  0.7792  memory: 24.67GiB(51.93%)  tps: 1,943  tflops: 15.19  mfu: 4.87%
[rank0]:2025-10-25 20:02:04,705 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.7792  memory: 14.87GiB(31.30%)  tps: 1,943  tflops: 15.19  mfu: 4.87%
[rank3]:2025-10-25 20:02:04,954 - INFO - Pipeline schedule is saved as: /home/shcho/torchtitan/images/1023_1F1B_nofreeze_dm1/pipeline_schedule/251025_2002_real_step1200_rank3.svg
[rank3]:> Batch Time: 1989.78 ms, GPU Bubble Ratio: 59.03%, 50.52%, 63.69%, 15.11%
[rank3]:2025-10-25 20:02:06,771 - INFO - Avg. fwd time: 70.4288 / Avg. bwd time: 141.2113 / Avg. batch time: 1750.0793 (ms) / GPU bubble ratio: 3.25%
[rank2]:2025-10-25 20:02:06,832 - INFO - Avg. fwd time: 35.7572 / Avg. bwd time: 54.9478 / Avg. batch time: 1842.5807 (ms) / GPU bubble ratio: 60.62%
[rank1]:2025-10-25 20:02:06,908 - INFO - Avg. fwd time: 50.5464 / Avg. bwd time: 72.8500 / Avg. batch time: 1962.3905 (ms) / GPU bubble ratio: 49.70%
[rank0]:2025-10-25 20:02:06,975 - INFO - Avg. fwd time: 40.7049 / Avg. bwd time: 61.6069 / Avg. batch time: 2061.9428 (ms) / GPU bubble ratio: 60.30%
[rank0]:2025-10-25 20:04:54,052 - INFO -  step: 1220  loss: -4.0000  grad_norm:  0.7969  memory: 14.87GiB(31.30%)  tps: 1,935  tflops: 15.13  mfu: 4.85%
[rank1]:2025-10-25 20:04:54,036 - INFO -  step: 1220  loss: -4.0000  grad_norm:  0.7969  memory: 10.73GiB(22.58%)  tps: 1,935  tflops: 15.13  mfu: 4.85%
[rank2]:2025-10-25 20:04:54,035 - INFO -  step: 1220  loss: -4.0000  grad_norm:  0.7969  memory:  7.21GiB(15.18%)  tps: 1,935  tflops: 15.13  mfu: 4.85%
[rank3]:2025-10-25 20:04:54,045 - INFO -  step: 1220  loss:  0.5161  grad_norm:  0.7969  memory: 24.67GiB(51.93%)  tps: 1,935  tflops: 15.13  mfu: 4.85%
[rank3]:2025-10-25 20:04:55,991 - INFO - Avg. fwd time: 70.4317 / Avg. bwd time: 141.2181 / Avg. batch time: 1750.1507 (ms) / GPU bubble ratio: 3.25%
[rank1]:2025-10-25 20:04:56,132 - INFO - Avg. fwd time: 50.5504 / Avg. bwd time: 72.8490 / Avg. batch time: 1962.4508 (ms) / GPU bubble ratio: 49.70%
[rank2]:2025-10-25 20:04:56,054 - INFO - Avg. fwd time: 35.7554 / Avg. bwd time: 54.9506 / Avg. batch time: 1842.6464 (ms) / GPU bubble ratio: 60.62%
[rank0]:2025-10-25 20:04:56,199 - INFO - Avg. fwd time: 40.7053 / Avg. bwd time: 61.6109 / Avg. batch time: 2062.0167 (ms) / GPU bubble ratio: 60.30%
[rank3]:2025-10-25 20:06:57,897 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 20:06:58,818 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 20:06:58,899 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 20:06:58,964 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 20:07:43,350 - INFO -  step: 1240  loss: -4.0000  grad_norm:  0.8102  memory: 10.73GiB(22.58%)  tps: 1,935  tflops: 15.13  mfu: 4.85%
[rank2]:2025-10-25 20:07:43,347 - INFO -  step: 1240  loss: -4.0000  grad_norm:  0.8102  memory:  7.21GiB(15.18%)  tps: 1,935  tflops: 15.13  mfu: 4.85%
[rank0]:2025-10-25 20:07:43,365 - INFO -  step: 1240  loss: -4.0000  grad_norm:  0.8102  memory: 14.87GiB(31.30%)  tps: 1,935  tflops: 15.13  mfu: 4.85%
[rank3]:2025-10-25 20:07:43,358 - INFO -  step: 1240  loss:  0.5359  grad_norm:  0.8102  memory: 24.67GiB(51.93%)  tps: 1,935  tflops: 15.13  mfu: 4.85%
[rank3]:2025-10-25 20:07:45,276 - INFO - Avg. fwd time: 70.4323 / Avg. bwd time: 141.2254 / Avg. batch time: 1750.2078 (ms) / GPU bubble ratio: 3.25%
[rank2]:2025-10-25 20:07:45,339 - INFO - Avg. fwd time: 35.7529 / Avg. bwd time: 54.9530 / Avg. batch time: 1842.7050 (ms) / GPU bubble ratio: 60.62%
[rank1]:2025-10-25 20:07:45,423 - INFO - Avg. fwd time: 50.5573 / Avg. bwd time: 72.8478 / Avg. batch time: 1962.5226 (ms) / GPU bubble ratio: 49.70%
[rank0]:2025-10-25 20:07:45,496 - INFO - Avg. fwd time: 40.7078 / Avg. bwd time: 61.6203 / Avg. batch time: 2062.1023 (ms) / GPU bubble ratio: 60.30%
[rank0]:2025-10-25 20:08:59,327 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-25 20:10:32,555 - INFO -  step: 1260  loss: -4.0000  grad_norm:  1.0388  memory: 10.73GiB(22.58%)  tps: 1,937  tflops: 15.14  mfu: 4.85%
[rank2]:2025-10-25 20:10:32,551 - INFO -  step: 1260  loss: -4.0000  grad_norm:  1.0388  memory:  7.21GiB(15.18%)  tps: 1,937  tflops: 15.14  mfu: 4.85%
[rank0]:2025-10-25 20:10:32,570 - INFO -  step: 1260  loss: -4.0000  grad_norm:  1.0388  memory: 14.87GiB(31.30%)  tps: 1,937  tflops: 15.14  mfu: 4.85%
[rank3]:2025-10-25 20:10:32,564 - INFO -  step: 1260  loss:  0.5106  grad_norm:  1.0388  memory: 24.67GiB(51.93%)  tps: 1,937  tflops: 15.14  mfu: 4.85%
[rank3]:2025-10-25 20:10:34,473 - INFO - Avg. fwd time: 70.4323 / Avg. bwd time: 141.2328 / Avg. batch time: 1750.2615 (ms) / GPU bubble ratio: 3.25%
[rank2]:2025-10-25 20:10:34,536 - INFO - Avg. fwd time: 35.7490 / Avg. bwd time: 54.9521 / Avg. batch time: 1842.7495 (ms) / GPU bubble ratio: 60.62%
[rank1]:2025-10-25 20:10:34,614 - INFO - Avg. fwd time: 50.5589 / Avg. bwd time: 72.8402 / Avg. batch time: 1962.5736 (ms) / GPU bubble ratio: 49.70%
[rank0]:2025-10-25 20:10:34,682 - INFO - Avg. fwd time: 40.7121 / Avg. bwd time: 61.6294 / Avg. batch time: 2062.1667 (ms) / GPU bubble ratio: 60.30%
[rank3]:2025-10-25 20:13:21,939 - INFO -  step: 1280  loss:  0.5036  grad_norm:  0.9727  memory: 24.67GiB(51.93%)  tps: 1,935  tflops: 15.12  mfu: 4.85%
[rank0]:2025-10-25 20:13:21,949 - INFO -  step: 1280  loss: -4.0000  grad_norm:  0.9727  memory: 14.87GiB(31.30%)  tps: 1,935  tflops: 15.12  mfu: 4.85%
[rank1]:2025-10-25 20:13:21,931 - INFO -  step: 1280  loss: -4.0000  grad_norm:  0.9727  memory: 10.73GiB(22.58%)  tps: 1,935  tflops: 15.12  mfu: 4.85%
[rank2]:2025-10-25 20:13:21,927 - INFO -  step: 1280  loss: -4.0000  grad_norm:  0.9727  memory:  7.21GiB(15.18%)  tps: 1,935  tflops: 15.12  mfu: 4.85%
[rank3]:2025-10-25 20:13:23,880 - INFO - Avg. fwd time: 70.4350 / Avg. bwd time: 141.2416 / Avg. batch time: 1750.3486 (ms) / GPU bubble ratio: 3.25%
[rank2]:2025-10-25 20:13:23,942 - INFO - Avg. fwd time: 35.7470 / Avg. bwd time: 54.9539 / Avg. batch time: 1842.8324 (ms) / GPU bubble ratio: 60.63%
[rank1]:2025-10-25 20:13:24,019 - INFO - Avg. fwd time: 50.5653 / Avg. bwd time: 72.8364 / Avg. batch time: 1962.6606 (ms) / GPU bubble ratio: 49.70%
[rank0]:2025-10-25 20:13:24,087 - INFO - Avg. fwd time: 40.7129 / Avg. bwd time: 61.6343 / Avg. batch time: 2062.2682 (ms) / GPU bubble ratio: 60.30%
[rank0]:2025-10-25 20:16:02,634 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-25 20:16:11,140 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.9034  memory: 10.73GiB(22.58%)  tps: 1,937  tflops: 15.14  mfu: 4.85%
[rank2]:2025-10-25 20:16:11,136 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.9034  memory:  7.21GiB(15.18%)  tps: 1,937  tflops: 15.14  mfu: 4.85%
[rank3]:2025-10-25 20:16:11,148 - INFO -  step: 1300  loss:  0.4789  grad_norm:  0.9034  memory: 24.67GiB(51.93%)  tps: 1,937  tflops: 15.14  mfu: 4.85%
[rank0]:2025-10-25 20:16:11,150 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.9034  memory: 14.87GiB(31.30%)  tps: 1,937  tflops: 15.14  mfu: 4.85%
[rank3]:2025-10-25 20:16:11,405 - INFO - Pipeline schedule is saved as: /home/shcho/torchtitan/images/1023_1F1B_nofreeze_dm1/pipeline_schedule/251025_2016_real_step1300_rank3.svg
[rank3]:> Batch Time: 1989.78 ms, GPU Bubble Ratio: 59.00%, 50.54%, 63.69%, 15.09%
[rank3]:2025-10-25 20:16:13,165 - INFO - Avg. fwd time: 70.4374 / Avg. bwd time: 141.2470 / Avg. batch time: 1750.4068 (ms) / GPU bubble ratio: 3.25%
[rank2]:2025-10-25 20:16:13,227 - INFO - Avg. fwd time: 35.7457 / Avg. bwd time: 54.9547 / Avg. batch time: 1842.9030 (ms) / GPU bubble ratio: 60.63%
[rank1]:2025-10-25 20:16:13,303 - INFO - Avg. fwd time: 50.5639 / Avg. bwd time: 72.8268 / Avg. batch time: 1962.7224 (ms) / GPU bubble ratio: 49.71%
[rank0]:2025-10-25 20:16:13,370 - INFO - Avg. fwd time: 40.7132 / Avg. bwd time: 61.6402 / Avg. batch time: 2062.3447 (ms) / GPU bubble ratio: 60.30%
[rank3]:2025-10-25 20:19:45,727 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 20:19:47,368 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 20:19:47,508 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 20:19:47,599 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 20:20:32,704 - INFO -  step: 1320  loss: -4.0000  grad_norm:  0.7949  memory: 10.73GiB(22.58%)  tps: 1,253  tflops: 9.79  mfu: 3.14%
[rank2]:2025-10-25 20:20:32,697 - INFO -  step: 1320  loss: -4.0000  grad_norm:  0.7949  memory:  7.21GiB(15.18%)  tps: 1,253  tflops: 9.79  mfu: 3.14%
[rank3]:2025-10-25 20:20:32,725 - INFO -  step: 1320  loss:  0.4722  grad_norm:  0.7949  memory: 24.67GiB(51.93%)  tps: 1,253  tflops: 9.79  mfu: 3.14%
[rank0]:2025-10-25 20:20:32,724 - INFO -  step: 1320  loss: -4.0000  grad_norm:  0.7949  memory: 14.87GiB(31.30%)  tps: 1,253  tflops: 9.79  mfu: 3.14%
[rank3]:2025-10-25 20:20:36,164 - INFO - Avg. fwd time: 71.0267 / Avg. bwd time: 142.2746 / Avg. batch time: 1764.3709 (ms) / GPU bubble ratio: 3.29%
[rank2]:2025-10-25 20:20:36,297 - INFO - Avg. fwd time: 36.1202 / Avg. bwd time: 55.5419 / Avg. batch time: 1857.9650 (ms) / GPU bubble ratio: 60.53%
[rank1]:2025-10-25 20:20:36,491 - INFO - Avg. fwd time: 51.0482 / Avg. bwd time: 73.6325 / Avg. batch time: 1979.2060 (ms) / GPU bubble ratio: 49.60%
[rank0]:2025-10-25 20:20:36,651 - INFO - Avg. fwd time: 41.0923 / Avg. bwd time: 62.3000 / Avg. batch time: 2080.0858 (ms) / GPU bubble ratio: 60.24%
[rank0]:2025-10-25 20:25:35,682 - INFO -  step: 1340  loss: -4.0000  grad_norm:  0.8203  memory: 14.87GiB(31.30%)  tps: 1,082  tflops: 8.46  mfu: 2.71%
[rank1]:2025-10-25 20:25:35,683 - INFO -  step: 1340  loss: -4.0000  grad_norm:  0.8203  memory: 10.73GiB(22.58%)  tps: 1,082  tflops: 8.45  mfu: 2.71%
[rank3]:2025-10-25 20:25:35,674 - INFO -  step: 1340  loss:  0.4566  grad_norm:  0.8203  memory: 24.67GiB(51.93%)  tps: 1,082  tflops: 8.46  mfu: 2.71%
[rank2]:2025-10-25 20:25:35,676 - INFO -  step: 1340  loss: -4.0000  grad_norm:  0.8203  memory:  7.21GiB(15.18%)  tps: 1,082  tflops: 8.45  mfu: 2.71%
[rank3]:2025-10-25 20:25:38,771 - INFO - Avg. fwd time: 71.7923 / Avg. bwd time: 143.6523 / Avg. batch time: 1782.9885 (ms) / GPU bubble ratio: 3.33%
[rank2]:2025-10-25 20:25:38,899 - INFO - Avg. fwd time: 36.6808 / Avg. bwd time: 56.4340 / Avg. batch time: 1878.2076 (ms) / GPU bubble ratio: 60.34%
[rank1]:2025-10-25 20:25:39,106 - INFO - Avg. fwd time: 51.7820 / Avg. bwd time: 74.8790 / Avg. batch time: 2001.7645 (ms) / GPU bubble ratio: 49.38%
[rank0]:2025-10-25 20:25:39,250 - INFO - Avg. fwd time: 41.6784 / Avg. bwd time: 63.3234 / Avg. batch time: 2104.5716 (ms) / GPU bubble ratio: 60.09%
[rank0]:2025-10-25 20:27:53,088 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-25 20:30:40,815 - INFO -  step: 1360  loss:  0.4725  grad_norm:  0.9177  memory: 24.67GiB(51.93%)  tps: 1,074  tflops: 8.40  mfu: 2.69%
[rank2]:2025-10-25 20:30:40,816 - INFO -  step: 1360  loss: -4.0000  grad_norm:  0.9177  memory:  7.21GiB(15.18%)  tps: 1,074  tflops: 8.39  mfu: 2.69%
[rank0]:2025-10-25 20:30:40,846 - INFO -  step: 1360  loss: -4.0000  grad_norm:  0.9177  memory: 14.87GiB(31.30%)  tps: 1,074  tflops: 8.39  mfu: 2.69%
[rank1]:2025-10-25 20:30:40,823 - INFO -  step: 1360  loss: -4.0000  grad_norm:  0.9177  memory: 10.73GiB(22.58%)  tps: 1,074  tflops: 8.40  mfu: 2.69%
[rank3]:2025-10-25 20:30:44,542 - INFO - Avg. fwd time: 72.5557 / Avg. bwd time: 145.0280 / Avg. batch time: 1801.5427 (ms) / GPU bubble ratio: 3.38%
[rank2]:2025-10-25 20:30:44,683 - INFO - Avg. fwd time: 37.2245 / Avg. bwd time: 57.2948 / Avg. batch time: 1898.3856 (ms) / GPU bubble ratio: 60.17%
[rank1]:2025-10-25 20:30:44,872 - INFO - Avg. fwd time: 52.5027 / Avg. bwd time: 76.0830 / Avg. batch time: 2024.1881 (ms) / GPU bubble ratio: 49.18%
[rank0]:2025-10-25 20:30:45,028 - INFO - Avg. fwd time: 42.2479 / Avg. bwd time: 64.3005 / Avg. batch time: 2128.9309 (ms) / GPU bubble ratio: 59.96%
[rank2]:2025-10-25 20:35:42,701 - INFO -  step: 1380  loss: -4.0000  grad_norm:  0.9678  memory:  7.21GiB(15.18%)  tps: 1,085  tflops: 8.49  mfu: 2.72%
[rank3]:2025-10-25 20:35:42,727 - INFO -  step: 1380  loss:  0.4696  grad_norm:  0.9678  memory: 24.67GiB(51.93%)  tps: 1,085  tflops: 8.48  mfu: 2.72%
[rank1]:2025-10-25 20:35:42,707 - INFO -  step: 1380  loss: -4.0000  grad_norm:  0.9678  memory: 10.73GiB(22.58%)  tps: 1,085  tflops: 8.49  mfu: 2.72%
[rank0]:2025-10-25 20:35:42,729 - INFO -  step: 1380  loss: -4.0000  grad_norm:  0.9678  memory: 14.87GiB(31.30%)  tps: 1,085  tflops: 8.49  mfu: 2.72%
[rank3]:2025-10-25 20:35:46,365 - INFO - Avg. fwd time: 73.2696 / Avg. bwd time: 146.3183 / Avg. batch time: 1818.9230 (ms) / GPU bubble ratio: 3.42%
[rank2]:2025-10-25 20:35:46,494 - INFO - Avg. fwd time: 37.7493 / Avg. bwd time: 58.1251 / Avg. batch time: 1917.3186 (ms) / GPU bubble ratio: 60.00%
[rank1]:2025-10-25 20:35:46,626 - INFO - Avg. fwd time: 53.1896 / Avg. bwd time: 77.2274 / Avg. batch time: 2045.2215 (ms) / GPU bubble ratio: 48.99%
[rank0]:2025-10-25 20:35:46,706 - INFO - Avg. fwd time: 42.7977 / Avg. bwd time: 65.2353 / Avg. batch time: 2151.8285 (ms) / GPU bubble ratio: 59.84%
[rank0]:2025-10-25 20:40:14,824 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-25 20:40:15,910 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 20:40:16,834 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 20:40:16,904 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 20:40:16,967 - WARNING - Dataset alpaca is being re-looped
[rank3]:2025-10-25 20:40:23,331 - INFO -  step: 1400  loss:  0.4571  grad_norm:  0.8435  memory: 24.67GiB(51.93%)  tps: 1,168  tflops: 9.13  mfu: 2.93%
[rank1]:2025-10-25 20:40:23,324 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.8435  memory: 10.73GiB(22.58%)  tps: 1,168  tflops: 9.13  mfu: 2.93%
[rank2]:2025-10-25 20:40:23,319 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.8435  memory:  7.21GiB(15.18%)  tps: 1,168  tflops: 9.13  mfu: 2.93%
[rank0]:2025-10-25 20:40:23,343 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.8435  memory: 14.87GiB(31.30%)  tps: 1,168  tflops: 9.13  mfu: 2.93%
[rank3]:2025-10-25 20:40:23,594 - INFO - Pipeline schedule is saved as: /home/shcho/torchtitan/images/1023_1F1B_nofreeze_dm1/pipeline_schedule/251025_2040_real_step1400_rank3.svg
[rank3]:> Batch Time: 1995.75 ms, GPU Bubble Ratio: 58.89%, 50.36%, 63.61%, 15.22%
[rank3]:2025-10-25 20:40:25,381 - INFO - Avg. fwd time: 73.8577 / Avg. bwd time: 147.3697 / Avg. batch time: 1833.1094 (ms) / GPU bubble ratio: 3.45%
[rank2]:2025-10-25 20:40:25,448 - INFO - Avg. fwd time: 38.1373 / Avg. bwd time: 58.7551 / Avg. batch time: 1932.6625 (ms) / GPU bubble ratio: 59.89%
[rank1]:2025-10-25 20:40:25,538 - INFO - Avg. fwd time: 53.7111 / Avg. bwd time: 78.0857 / Avg. batch time: 2062.1098 (ms) / GPU bubble ratio: 48.87%
[rank0]:2025-10-25 20:40:25,609 - INFO - Avg. fwd time: 43.2040 / Avg. bwd time: 65.9329 / Avg. batch time: 2170.0520 (ms) / GPU bubble ratio: 59.77%
[rank3]:2025-10-25 20:43:13,215 - INFO -  step: 1420  loss:  0.4384  grad_norm:  0.8942  memory: 24.67GiB(51.93%)  tps: 1,929  tflops: 15.08  mfu: 4.83%
[rank1]:2025-10-25 20:43:13,214 - INFO -  step: 1420  loss: -4.0000  grad_norm:  0.8942  memory: 10.73GiB(22.58%)  tps: 1,929  tflops: 15.08  mfu: 4.83%
[rank2]:2025-10-25 20:43:13,203 - INFO -  step: 1420  loss: -4.0000  grad_norm:  0.8942  memory:  7.21GiB(15.18%)  tps: 1,929  tflops: 15.08  mfu: 4.83%
[rank0]:2025-10-25 20:43:13,223 - INFO -  step: 1420  loss: -4.0000  grad_norm:  0.8942  memory: 14.87GiB(31.30%)  tps: 1,929  tflops: 15.08  mfu: 4.83%
[rank3]:2025-10-25 20:43:15,160 - INFO - Avg. fwd time: 73.8161 / Avg. bwd time: 147.2957 / Avg. batch time: 1832.0903 (ms) / GPU bubble ratio: 3.45%
[rank2]:2025-10-25 20:43:15,228 - INFO - Avg. fwd time: 38.1016 / Avg. bwd time: 58.7005 / Avg. batch time: 1931.5346 (ms) / GPU bubble ratio: 59.91%
[rank1]:2025-10-25 20:43:15,305 - INFO - Avg. fwd time: 53.6707 / Avg. bwd time: 78.0001 / Avg. batch time: 2060.8525 (ms) / GPU bubble ratio: 48.89%
[rank0]:2025-10-25 20:43:15,378 - INFO - Avg. fwd time: 43.1697 / Avg. bwd time: 65.8815 / Avg. batch time: 2168.6950 (ms) / GPU bubble ratio: 59.77%
[rank2]:2025-10-25 20:46:03,122 - INFO -  step: 1440  loss: -4.0000  grad_norm:  0.9241  memory:  7.21GiB(15.18%)  tps: 1,928  tflops: 15.08  mfu: 4.83%
[rank1]:2025-10-25 20:46:03,126 - INFO -  step: 1440  loss: -4.0000  grad_norm:  0.9241  memory: 10.73GiB(22.58%)  tps: 1,929  tflops: 15.08  mfu: 4.83%
[rank3]:2025-10-25 20:46:03,136 - INFO -  step: 1440  loss:  0.4599  grad_norm:  0.9241  memory: 24.67GiB(51.93%)  tps: 1,928  tflops: 15.08  mfu: 4.83%
[rank0]:2025-10-25 20:46:03,142 - INFO -  step: 1440  loss: -4.0000  grad_norm:  0.9241  memory: 14.87GiB(31.30%)  tps: 1,928  tflops: 15.08  mfu: 4.83%
[rank3]:2025-10-25 20:46:05,040 - INFO - Avg. fwd time: 73.7760 / Avg. bwd time: 147.2227 / Avg. batch time: 1831.0932 (ms) / GPU bubble ratio: 3.45%
[rank2]:2025-10-25 20:46:05,103 - INFO - Avg. fwd time: 38.0675 / Avg. bwd time: 58.6489 / Avg. batch time: 1930.4322 (ms) / GPU bubble ratio: 59.92%
[rank1]:2025-10-25 20:46:05,183 - INFO - Avg. fwd time: 53.6355 / Avg. bwd time: 77.9179 / Avg. batch time: 2059.6316 (ms) / GPU bubble ratio: 48.90%
[rank0]:2025-10-25 20:46:05,260 - INFO - Avg. fwd time: 43.1414 / Avg. bwd time: 65.8329 / Avg. batch time: 2167.3770 (ms) / GPU bubble ratio: 59.78%
[rank0]:2025-10-25 20:47:19,504 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-25 20:48:52,385 - INFO -  step: 1460  loss: -4.0000  grad_norm:  0.8579  memory: 10.73GiB(22.58%)  tps: 1,936  tflops: 15.13  mfu: 4.85%
[rank3]:2025-10-25 20:48:52,394 - INFO -  step: 1460  loss:  0.4498  grad_norm:  0.8579  memory: 24.67GiB(51.93%)  tps: 1,936  tflops: 15.13  mfu: 4.85%
[rank0]:2025-10-25 20:48:52,401 - INFO -  step: 1460  loss: -4.0000  grad_norm:  0.8579  memory: 14.87GiB(31.30%)  tps: 1,936  tflops: 15.13  mfu: 4.85%
[rank2]:2025-10-25 20:48:52,381 - INFO -  step: 1460  loss: -4.0000  grad_norm:  0.8579  memory:  7.21GiB(15.18%)  tps: 1,936  tflops: 15.13  mfu: 4.85%
[rank3]:2025-10-25 20:48:54,333 - INFO - Avg. fwd time: 73.7333 / Avg. bwd time: 147.1451 / Avg. batch time: 1830.0418 (ms) / GPU bubble ratio: 3.44%
[rank2]:2025-10-25 20:48:54,402 - INFO - Avg. fwd time: 38.0317 / Avg. bwd time: 58.5950 / Avg. batch time: 1929.2770 (ms) / GPU bubble ratio: 59.93%
[rank1]:2025-10-25 20:48:54,490 - INFO - Avg. fwd time: 53.5997 / Avg. bwd time: 77.8378 / Avg. batch time: 2058.3499 (ms) / GPU bubble ratio: 48.92%
[rank0]:2025-10-25 20:48:54,565 - INFO - Avg. fwd time: 43.1107 / Avg. bwd time: 65.7826 / Avg. batch time: 2166.0009 (ms) / GPU bubble ratio: 59.78%
[rank3]:2025-10-25 20:51:42,137 - INFO -  step: 1480  loss:  0.4311  grad_norm:  0.8060  memory: 24.67GiB(51.93%)  tps: 1,930  tflops: 15.09  mfu: 4.84%
[rank2]:2025-10-25 20:51:42,125 - INFO -  step: 1480  loss: -4.0000  grad_norm:  0.8060  memory:  7.21GiB(15.18%)  tps: 1,930  tflops: 15.09  mfu: 4.84%
[rank0]:2025-10-25 20:51:42,146 - INFO -  step: 1480  loss: -4.0000  grad_norm:  0.8060  memory: 14.87GiB(31.30%)  tps: 1,930  tflops: 15.09  mfu: 4.84%
[rank1]:2025-10-25 20:51:42,128 - INFO -  step: 1480  loss: -4.0000  grad_norm:  0.8060  memory: 10.73GiB(22.58%)  tps: 1,930  tflops: 15.09  mfu: 4.84%
[rank3]:2025-10-25 20:51:44,075 - INFO - Avg. fwd time: 73.6934 / Avg. bwd time: 147.0760 / Avg. batch time: 1829.0829 (ms) / GPU bubble ratio: 3.44%
[rank2]:2025-10-25 20:51:44,139 - INFO - Avg. fwd time: 37.9991 / Avg. bwd time: 58.5466 / Avg. batch time: 1928.2210 (ms) / GPU bubble ratio: 59.94%
[rank1]:2025-10-25 20:51:44,216 - INFO - Avg. fwd time: 53.5668 / Avg. bwd time: 77.7611 / Avg. batch time: 2057.1794 (ms) / GPU bubble ratio: 48.93%
[rank0]:2025-10-25 20:51:44,285 - INFO - Avg. fwd time: 43.0818 / Avg. bwd time: 65.7365 / Avg. batch time: 2164.7400 (ms) / GPU bubble ratio: 59.79%
[rank3]:2025-10-25 20:51:53,847 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 20:51:54,772 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 20:51:54,854 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 20:51:54,921 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 20:54:23,543 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-25 20:54:32,097 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.8614  memory: 14.87GiB(31.30%)  tps: 1,928  tflops: 15.07  mfu: 4.83%
[rank0]:2025-10-25 20:54:32,097 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-25 20:54:32,099 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank3]:2025-10-25 20:54:32,089 - INFO -  step: 1500  loss:  0.4362  grad_norm:  0.8614  memory: 24.67GiB(51.93%)  tps: 1,928  tflops: 15.07  mfu: 4.83%
[rank3]:2025-10-25 20:54:32,090 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-25 20:54:32,081 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.8614  memory: 10.73GiB(22.58%)  tps: 1,928  tflops: 15.07  mfu: 4.83%
[rank1]:2025-10-25 20:54:32,081 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-25 20:54:32,077 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.8614  memory:  7.21GiB(15.18%)  tps: 1,928  tflops: 15.07  mfu: 4.83%
[rank2]:2025-10-25 20:54:32,077 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-25 20:54:33,878 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 1.80 seconds.
[rank1]:2025-10-25 20:54:34,319 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 2.24 seconds.
[rank3]:2025-10-25 20:54:35,395 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.31 seconds.
[rank0]:2025-10-25 20:54:35,665 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-25 20:54:35,673 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.58 seconds.
[rank0]:2025-10-25 20:54:35,673 - INFO - Checkpointer is deleting /data2/shcho/torchtitan/checkpoint/1023_1F1B_nofreeze_dm1/step-500.
[rank3]:2025-10-25 20:54:36,117 - INFO - Pipeline schedule is saved as: /home/shcho/torchtitan/images/1023_1F1B_nofreeze_dm1/pipeline_schedule/251025_2054_real_step1500_rank3.svg
[rank3]:> Batch Time: 1998.62 ms, GPU Bubble Ratio: 58.90%, 50.43%, 63.68%, 15.22%
[rank0]:2025-10-25 20:54:37,810 - INFO - Checkpointer deleted /data2/shcho/torchtitan/checkpoint/1023_1F1B_nofreeze_dm1/step-500 in 2.14 seconds.
[rank3]:2025-10-25 20:54:37,909 - INFO - Avg. fwd time: 73.6556 / Avg. bwd time: 147.0105 / Avg. batch time: 1828.1722 (ms) / GPU bubble ratio: 3.44%
[rank2]:2025-10-25 20:54:37,972 - INFO - Avg. fwd time: 37.9665 / Avg. bwd time: 58.4990 / Avg. batch time: 1927.2688 (ms) / GPU bubble ratio: 59.96%
[rank1]:2025-10-25 20:54:38,049 - INFO - Avg. fwd time: 53.5335 / Avg. bwd time: 77.6844 / Avg. batch time: 2056.1201 (ms) / GPU bubble ratio: 48.95%
[rank0]:2025-10-25 20:54:38,120 - INFO - Avg. fwd time: 43.0507 / Avg. bwd time: 65.6909 / Avg. batch time: 2163.5985 (ms) / GPU bubble ratio: 59.79%
[rank1]:2025-10-25 20:57:25,224 - INFO -  step: 1520  loss: -4.0000  grad_norm:  0.8262  memory: 10.73GiB(22.58%)  tps: 1,893  tflops: 14.80  mfu: 4.74%
[rank3]:2025-10-25 20:57:25,232 - INFO -  step: 1520  loss:  0.4437  grad_norm:  0.8262  memory: 24.67GiB(51.93%)  tps: 1,893  tflops: 14.80  mfu: 4.74%
[rank2]:2025-10-25 20:57:25,220 - INFO -  step: 1520  loss: -4.0000  grad_norm:  0.8262  memory:  7.21GiB(15.18%)  tps: 1,893  tflops: 14.80  mfu: 4.74%
[rank0]:2025-10-25 20:57:25,244 - INFO -  step: 1520  loss: -4.0000  grad_norm:  0.8262  memory: 14.87GiB(31.30%)  tps: 1,892  tflops: 14.79  mfu: 4.74%
[rank3]:2025-10-25 20:57:27,165 - INFO - Avg. fwd time: 73.6165 / Avg. bwd time: 146.9384 / Avg. batch time: 1827.2018 (ms) / GPU bubble ratio: 3.43%
[rank2]:2025-10-25 20:57:27,233 - INFO - Avg. fwd time: 37.9350 / Avg. bwd time: 58.4526 / Avg. batch time: 1926.1989 (ms) / GPU bubble ratio: 59.97%
[rank1]:2025-10-25 20:57:27,315 - INFO - Avg. fwd time: 53.4992 / Avg. bwd time: 77.6079 / Avg. batch time: 2054.9232 (ms) / GPU bubble ratio: 48.96%
[rank0]:2025-10-25 20:57:27,384 - INFO - Avg. fwd time: 43.0227 / Avg. bwd time: 65.6469 / Avg. batch time: 2162.3147 (ms) / GPU bubble ratio: 59.80%
[rank0]:2025-10-25 21:00:14,971 - INFO -  step: 1540  loss: -4.0000  grad_norm:  0.8643  memory: 14.87GiB(31.30%)  tps: 1,931  tflops: 15.09  mfu: 4.84%
[rank2]:2025-10-25 21:00:14,951 - INFO -  step: 1540  loss: -4.0000  grad_norm:  0.8643  memory:  7.21GiB(15.18%)  tps: 1,931  tflops: 15.09  mfu: 4.84%
[rank1]:2025-10-25 21:00:14,954 - INFO -  step: 1540  loss: -4.0000  grad_norm:  0.8643  memory: 10.73GiB(22.58%)  tps: 1,931  tflops: 15.09  mfu: 4.84%
[rank3]:2025-10-25 21:00:14,963 - INFO -  step: 1540  loss:  0.4280  grad_norm:  0.8643  memory: 24.67GiB(51.93%)  tps: 1,931  tflops: 15.09  mfu: 4.84%
[rank3]:2025-10-25 21:00:16,883 - INFO - Avg. fwd time: 73.5800 / Avg. bwd time: 146.8738 / Avg. batch time: 1826.3134 (ms) / GPU bubble ratio: 3.43%
[rank2]:2025-10-25 21:00:16,948 - INFO - Avg. fwd time: 37.9060 / Avg. bwd time: 58.4095 / Avg. batch time: 1925.2183 (ms) / GPU bubble ratio: 59.98%
[rank1]:2025-10-25 21:00:17,026 - INFO - Avg. fwd time: 53.4701 / Avg. bwd time: 77.5335 / Avg. batch time: 2053.8307 (ms) / GPU bubble ratio: 48.97%
[rank0]:2025-10-25 21:00:17,095 - INFO - Avg. fwd time: 42.9950 / Avg. bwd time: 65.6066 / Avg. batch time: 2161.1422 (ms) / GPU bubble ratio: 59.80%
[rank0]:2025-10-25 21:01:31,707 - INFO - [GC] Peforming periodical GC collection 0.24 seconds
[rank0]:2025-10-25 21:03:05,060 - INFO -  step: 1560  loss: -4.0000  grad_norm:  0.8358  memory: 14.87GiB(31.30%)  tps: 1,927  tflops: 15.06  mfu: 4.83%
[rank2]:2025-10-25 21:03:05,035 - INFO -  step: 1560  loss: -4.0000  grad_norm:  0.8358  memory:  7.21GiB(15.18%)  tps: 1,927  tflops: 15.06  mfu: 4.83%
[rank3]:2025-10-25 21:03:05,048 - INFO -  step: 1560  loss:  0.4151  grad_norm:  0.8358  memory: 24.67GiB(51.93%)  tps: 1,927  tflops: 15.06  mfu: 4.83%
[rank1]:2025-10-25 21:03:05,039 - INFO -  step: 1560  loss: -4.0000  grad_norm:  0.8358  memory: 10.73GiB(22.58%)  tps: 1,927  tflops: 15.06  mfu: 4.83%
[rank3]:2025-10-25 21:03:06,980 - INFO - Avg. fwd time: 73.5460 / Avg. bwd time: 146.8114 / Avg. batch time: 1825.4644 (ms) / GPU bubble ratio: 3.43%
[rank2]:2025-10-25 21:03:07,048 - INFO - Avg. fwd time: 37.8772 / Avg. bwd time: 58.3668 / Avg. batch time: 1924.2867 (ms) / GPU bubble ratio: 59.99%
[rank1]:2025-10-25 21:03:07,127 - INFO - Avg. fwd time: 53.4399 / Avg. bwd time: 77.4615 / Avg. batch time: 2052.7883 (ms) / GPU bubble ratio: 48.99%
[rank0]:2025-10-25 21:03:07,201 - INFO - Avg. fwd time: 42.9682 / Avg. bwd time: 65.5672 / Avg. batch time: 2160.0211 (ms) / GPU bubble ratio: 59.80%
[rank3]:2025-10-25 21:03:38,008 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 21:03:38,783 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 21:03:38,864 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 21:03:38,930 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 21:05:54,312 - INFO -  step: 1580  loss: -4.0000  grad_norm:  0.7781  memory:  7.21GiB(15.18%)  tps: 1,936  tflops: 15.13  mfu: 4.85%
[rank1]:2025-10-25 21:05:54,316 - INFO -  step: 1580  loss: -4.0000  grad_norm:  0.7781  memory: 10.73GiB(22.58%)  tps: 1,936  tflops: 15.13  mfu: 4.85%
[rank3]:2025-10-25 21:05:54,324 - INFO -  step: 1580  loss:  0.4134  grad_norm:  0.7781  memory: 24.67GiB(51.93%)  tps: 1,936  tflops: 15.13  mfu: 4.85%
[rank0]:2025-10-25 21:05:54,334 - INFO -  step: 1580  loss: -4.0000  grad_norm:  0.7781  memory: 14.87GiB(31.30%)  tps: 1,936  tflops: 15.13  mfu: 4.85%
[rank3]:2025-10-25 21:05:56,282 - INFO - Avg. fwd time: 73.5108 / Avg. bwd time: 146.7466 / Avg. batch time: 1824.5883 (ms) / GPU bubble ratio: 3.43%
[rank2]:2025-10-25 21:05:56,346 - INFO - Avg. fwd time: 37.8480 / Avg. bwd time: 58.3239 / Avg. batch time: 1923.3193 (ms) / GPU bubble ratio: 60.00%
[rank1]:2025-10-25 21:05:56,436 - INFO - Avg. fwd time: 53.4075 / Avg. bwd time: 77.3868 / Avg. batch time: 2051.7051 (ms) / GPU bubble ratio: 49.00%
[rank0]:2025-10-25 21:05:56,510 - INFO - Avg. fwd time: 42.9380 / Avg. bwd time: 65.5254 / Avg. batch time: 2158.8554 (ms) / GPU bubble ratio: 59.81%
[rank0]:2025-10-25 21:08:35,874 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-25 21:08:44,410 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.9600  memory: 14.87GiB(31.30%)  tps: 1,927  tflops: 15.06  mfu: 4.83%
[rank2]:2025-10-25 21:08:44,390 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.9600  memory:  7.21GiB(15.18%)  tps: 1,927  tflops: 15.06  mfu: 4.83%
[rank3]:2025-10-25 21:08:44,402 - INFO -  step: 1600  loss:  0.4283  grad_norm:  0.9600  memory: 24.67GiB(51.93%)  tps: 1,927  tflops: 15.06  mfu: 4.83%
[rank1]:2025-10-25 21:08:44,393 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.9600  memory: 10.73GiB(22.58%)  tps: 1,927  tflops: 15.06  mfu: 4.83%
[rank3]:2025-10-25 21:08:44,662 - INFO - Pipeline schedule is saved as: /home/shcho/torchtitan/images/1023_1F1B_nofreeze_dm1/pipeline_schedule/251025_2108_real_step1600_rank3.svg
[rank3]:> Batch Time: 2002.00 ms, GPU Bubble Ratio: 58.89%, 50.53%, 63.75%, 15.22%
[rank3]:2025-10-25 21:08:46,479 - INFO - Avg. fwd time: 73.4782 / Avg. bwd time: 146.6901 / Avg. batch time: 1823.8006 (ms) / GPU bubble ratio: 3.42%
[rank2]:2025-10-25 21:08:46,550 - INFO - Avg. fwd time: 37.8207 / Avg. bwd time: 58.2826 / Avg. batch time: 1922.4743 (ms) / GPU bubble ratio: 60.01%
[rank1]:2025-10-25 21:08:46,639 - INFO - Avg. fwd time: 53.3863 / Avg. bwd time: 77.3302 / Avg. batch time: 2050.7779 (ms) / GPU bubble ratio: 49.01%
[rank0]:2025-10-25 21:08:46,716 - INFO - Avg. fwd time: 42.9127 / Avg. bwd time: 65.4877 / Avg. batch time: 2157.8554 (ms) / GPU bubble ratio: 59.81%
[rank2]:2025-10-25 21:11:34,475 - INFO -  step: 1620  loss: -4.0000  grad_norm:  0.8270  memory:  7.21GiB(15.18%)  tps: 1,927  tflops: 15.06  mfu: 4.83%
[rank3]:2025-10-25 21:11:34,489 - INFO -  step: 1620  loss:  0.4091  grad_norm:  0.8270  memory: 24.67GiB(51.93%)  tps: 1,927  tflops: 15.06  mfu: 4.83%
[rank1]:2025-10-25 21:11:34,478 - INFO -  step: 1620  loss: -4.0000  grad_norm:  0.8270  memory: 10.73GiB(22.58%)  tps: 1,927  tflops: 15.06  mfu: 4.83%
[rank0]:2025-10-25 21:11:34,499 - INFO -  step: 1620  loss: -4.0000  grad_norm:  0.8270  memory: 14.87GiB(31.30%)  tps: 1,927  tflops: 15.06  mfu: 4.83%
[rank3]:2025-10-25 21:11:36,425 - INFO - Avg. fwd time: 73.4450 / Avg. bwd time: 146.6323 / Avg. batch time: 1823.0002 (ms) / GPU bubble ratio: 3.42%
[rank2]:2025-10-25 21:11:36,497 - INFO - Avg. fwd time: 37.7939 / Avg. bwd time: 58.2420 / Avg. batch time: 1921.5972 (ms) / GPU bubble ratio: 60.02%
[rank1]:2025-10-25 21:11:36,577 - INFO - Avg. fwd time: 53.3698 / Avg. bwd time: 77.2745 / Avg. batch time: 2049.8240 (ms) / GPU bubble ratio: 49.01%
[rank0]:2025-10-25 21:11:36,647 - INFO - Avg. fwd time: 42.8866 / Avg. bwd time: 65.4472 / Avg. batch time: 2156.8304 (ms) / GPU bubble ratio: 59.82%
[rank2]:2025-10-25 21:14:23,989 - INFO -  step: 1640  loss: -4.0000  grad_norm:  0.9285  memory:  7.21GiB(15.18%)  tps: 1,933  tflops: 15.11  mfu: 4.84%
[rank0]:2025-10-25 21:14:24,008 - INFO -  step: 1640  loss: -4.0000  grad_norm:  0.9285  memory: 14.87GiB(31.30%)  tps: 1,933  tflops: 15.11  mfu: 4.84%
[rank1]:2025-10-25 21:14:23,992 - INFO -  step: 1640  loss: -4.0000  grad_norm:  0.9285  memory: 10.73GiB(22.58%)  tps: 1,933  tflops: 15.11  mfu: 4.84%
[rank3]:2025-10-25 21:14:24,001 - INFO -  step: 1640  loss:  0.3980  grad_norm:  0.9285  memory: 24.67GiB(51.93%)  tps: 1,933  tflops: 15.11  mfu: 4.84%
[rank2]:2025-10-25 21:14:25,998 - INFO - Avg. fwd time: 37.7671 / Avg. bwd time: 58.2012 / Avg. batch time: 1920.7021 (ms) / GPU bubble ratio: 60.03%
[rank3]:2025-10-25 21:14:25,933 - INFO - Avg. fwd time: 73.4115 / Avg. bwd time: 146.5725 / Avg. batch time: 1822.1833 (ms) / GPU bubble ratio: 3.42%
[rank1]:2025-10-25 21:14:26,087 - INFO - Avg. fwd time: 53.3421 / Avg. bwd time: 77.2072 / Avg. batch time: 2048.8342 (ms) / GPU bubble ratio: 49.02%
[rank0]:2025-10-25 21:14:26,163 - INFO - Avg. fwd time: 42.8609 / Avg. bwd time: 65.4114 / Avg. batch time: 2155.7669 (ms) / GPU bubble ratio: 59.82%
[rank3]:2025-10-25 21:15:16,170 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 21:15:17,086 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 21:15:17,156 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 21:15:17,221 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 21:15:40,548 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-25 21:17:14,192 - INFO -  step: 1660  loss: -4.0000  grad_norm:  0.7801  memory:  7.21GiB(15.18%)  tps: 1,925  tflops: 15.05  mfu: 4.82%
[rank0]:2025-10-25 21:17:14,212 - INFO -  step: 1660  loss: -4.0000  grad_norm:  0.7801  memory: 14.87GiB(31.30%)  tps: 1,925  tflops: 15.05  mfu: 4.82%
[rank1]:2025-10-25 21:17:14,196 - INFO -  step: 1660  loss: -4.0000  grad_norm:  0.7801  memory: 10.73GiB(22.58%)  tps: 1,925  tflops: 15.05  mfu: 4.82%
[rank3]:2025-10-25 21:17:14,204 - INFO -  step: 1660  loss:  0.4021  grad_norm:  0.7801  memory: 24.67GiB(51.93%)  tps: 1,925  tflops: 15.05  mfu: 4.82%
[rank3]:2025-10-25 21:17:16,155 - INFO - Avg. fwd time: 73.3818 / Avg. bwd time: 146.5219 / Avg. batch time: 1821.4725 (ms) / GPU bubble ratio: 3.42%
[rank2]:2025-10-25 21:17:16,225 - INFO - Avg. fwd time: 37.7427 / Avg. bwd time: 58.1633 / Avg. batch time: 1919.9201 (ms) / GPU bubble ratio: 60.04%
[rank1]:2025-10-25 21:17:16,304 - INFO - Avg. fwd time: 53.3166 / Avg. bwd time: 77.1500 / Avg. batch time: 2047.9699 (ms) / GPU bubble ratio: 49.04%
[rank0]:2025-10-25 21:17:16,376 - INFO - Avg. fwd time: 42.8388 / Avg. bwd time: 65.3754 / Avg. batch time: 2154.8389 (ms) / GPU bubble ratio: 59.82%
[rank2]:2025-10-25 21:20:04,120 - INFO -  step: 1680  loss: -4.0000  grad_norm:  0.8156  memory:  7.21GiB(15.18%)  tps: 1,928  tflops: 15.07  mfu: 4.83%
[rank0]:2025-10-25 21:20:04,143 - INFO -  step: 1680  loss: -4.0000  grad_norm:  0.8156  memory: 14.87GiB(31.30%)  tps: 1,928  tflops: 15.07  mfu: 4.83%
[rank1]:2025-10-25 21:20:04,125 - INFO -  step: 1680  loss: -4.0000  grad_norm:  0.8156  memory: 10.73GiB(22.58%)  tps: 1,928  tflops: 15.07  mfu: 4.83%
[rank3]:2025-10-25 21:20:04,132 - INFO -  step: 1680  loss:  0.4070  grad_norm:  0.8156  memory: 24.67GiB(51.93%)  tps: 1,928  tflops: 15.08  mfu: 4.83%
[rank3]:2025-10-25 21:20:06,061 - INFO - Avg. fwd time: 73.3525 / Avg. bwd time: 146.4688 / Avg. batch time: 1820.7454 (ms) / GPU bubble ratio: 3.41%
[rank2]:2025-10-25 21:20:06,130 - INFO - Avg. fwd time: 37.7179 / Avg. bwd time: 58.1280 / Avg. batch time: 1919.1195 (ms) / GPU bubble ratio: 60.05%
[rank1]:2025-10-25 21:20:06,209 - INFO - Avg. fwd time: 53.2950 / Avg. bwd time: 77.0937 / Avg. batch time: 2047.0896 (ms) / GPU bubble ratio: 49.04%
[rank0]:2025-10-25 21:20:06,285 - INFO - Avg. fwd time: 42.8161 / Avg. bwd time: 65.3410 / Avg. batch time: 2153.8875 (ms) / GPU bubble ratio: 59.83%
[rank0]:2025-10-25 21:22:45,600 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-25 21:22:54,109 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.8064  memory: 10.73GiB(22.58%)  tps: 1,928  tflops: 15.07  mfu: 4.83%
[rank2]:2025-10-25 21:22:54,105 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.8064  memory:  7.21GiB(15.18%)  tps: 1,928  tflops: 15.07  mfu: 4.83%
[rank0]:2025-10-25 21:22:54,123 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.8064  memory: 14.87GiB(31.30%)  tps: 1,928  tflops: 15.07  mfu: 4.83%
[rank3]:2025-10-25 21:22:54,117 - INFO -  step: 1700  loss:  0.3945  grad_norm:  0.8064  memory: 24.67GiB(51.93%)  tps: 1,928  tflops: 15.07  mfu: 4.83%
[rank3]:2025-10-25 21:22:54,373 - INFO - Pipeline schedule is saved as: /home/shcho/torchtitan/images/1023_1F1B_nofreeze_dm1/pipeline_schedule/251025_2122_real_step1700_rank3.svg
[rank3]:> Batch Time: 2004.62 ms, GPU Bubble Ratio: 58.90%, 50.58%, 63.81%, 15.22%
[rank3]:2025-10-25 21:22:56,196 - INFO - Avg. fwd time: 73.3246 / Avg. bwd time: 146.4168 / Avg. batch time: 1820.0410 (ms) / GPU bubble ratio: 3.41%
[rank2]:2025-10-25 21:22:56,267 - INFO - Avg. fwd time: 37.6921 / Avg. bwd time: 58.0907 / Avg. batch time: 1918.3646 (ms) / GPU bubble ratio: 60.06%
[rank1]:2025-10-25 21:22:56,347 - INFO - Avg. fwd time: 53.2690 / Avg. bwd time: 77.0344 / Avg. batch time: 2046.2604 (ms) / GPU bubble ratio: 49.06%
[rank0]:2025-10-25 21:22:56,417 - INFO - Avg. fwd time: 42.7936 / Avg. bwd time: 65.3059 / Avg. batch time: 2152.9886 (ms) / GPU bubble ratio: 59.83%
[rank0]:2025-10-25 21:25:44,670 - INFO -  step: 1720  loss: -4.0000  grad_norm:  0.7888  memory: 14.87GiB(31.30%)  tps: 1,921  tflops: 15.02  mfu: 4.81%
[rank2]:2025-10-25 21:25:44,648 - INFO -  step: 1720  loss: -4.0000  grad_norm:  0.7888  memory:  7.21GiB(15.18%)  tps: 1,921  tflops: 15.02  mfu: 4.81%
[rank3]:2025-10-25 21:25:44,661 - INFO -  step: 1720  loss:  0.3964  grad_norm:  0.7888  memory: 24.67GiB(51.93%)  tps: 1,921  tflops: 15.02  mfu: 4.81%
[rank1]:2025-10-25 21:25:44,652 - INFO -  step: 1720  loss: -4.0000  grad_norm:  0.7888  memory: 10.73GiB(22.58%)  tps: 1,921  tflops: 15.02  mfu: 4.81%
[rank3]:2025-10-25 21:25:46,616 - INFO - Avg. fwd time: 73.2976 / Avg. bwd time: 146.3722 / Avg. batch time: 1819.4044 (ms) / GPU bubble ratio: 3.41%
[rank2]:2025-10-25 21:25:46,681 - INFO - Avg. fwd time: 37.6695 / Avg. bwd time: 58.0564 / Avg. batch time: 1917.6601 (ms) / GPU bubble ratio: 60.07%
[rank1]:2025-10-25 21:25:46,769 - INFO - Avg. fwd time: 53.2462 / Avg. bwd time: 76.9784 / Avg. batch time: 2045.4843 (ms) / GPU bubble ratio: 49.07%
[rank0]:2025-10-25 21:25:46,840 - INFO - Avg. fwd time: 42.7727 / Avg. bwd time: 65.2725 / Avg. batch time: 2152.1531 (ms) / GPU bubble ratio: 59.84%
[rank3]:2025-10-25 21:26:56,046 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 21:26:56,974 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 21:26:57,052 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 21:26:57,114 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 21:28:34,299 - INFO -  step: 1740  loss: -4.0000  grad_norm:  0.7836  memory: 14.87GiB(31.30%)  tps: 1,932  tflops: 15.10  mfu: 4.84%
[rank2]:2025-10-25 21:28:34,280 - INFO -  step: 1740  loss: -4.0000  grad_norm:  0.7836  memory:  7.21GiB(15.18%)  tps: 1,932  tflops: 15.10  mfu: 4.84%
[rank3]:2025-10-25 21:28:34,293 - INFO -  step: 1740  loss:  0.4028  grad_norm:  0.7836  memory: 24.67GiB(51.93%)  tps: 1,932  tflops: 15.10  mfu: 4.84%
[rank1]:2025-10-25 21:28:34,284 - INFO -  step: 1740  loss: -4.0000  grad_norm:  0.7836  memory: 10.73GiB(22.58%)  tps: 1,932  tflops: 15.10  mfu: 4.84%
[rank3]:2025-10-25 21:28:36,231 - INFO - Avg. fwd time: 73.2693 / Avg. bwd time: 146.3184 / Avg. batch time: 1818.6843 (ms) / GPU bubble ratio: 3.41%
[rank2]:2025-10-25 21:28:36,296 - INFO - Avg. fwd time: 37.6450 / Avg. bwd time: 58.0198 / Avg. batch time: 1916.8689 (ms) / GPU bubble ratio: 60.07%
[rank1]:2025-10-25 21:28:36,385 - INFO - Avg. fwd time: 53.2368 / Avg. bwd time: 76.9409 / Avg. batch time: 2044.6236 (ms) / GPU bubble ratio: 49.07%
[rank0]:2025-10-25 21:28:36,461 - INFO - Avg. fwd time: 42.7521 / Avg. bwd time: 65.2376 / Avg. batch time: 2151.2224 (ms) / GPU bubble ratio: 59.84%
[rank0]:2025-10-25 21:29:50,585 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-25 21:31:24,027 - INFO -  step: 1760  loss: -4.0000  grad_norm:  0.7772  memory: 14.87GiB(31.30%)  tps: 1,931  tflops: 15.09  mfu: 4.84%
[rank2]:2025-10-25 21:31:24,007 - INFO -  step: 1760  loss: -4.0000  grad_norm:  0.7772  memory:  7.21GiB(15.18%)  tps: 1,931  tflops: 15.09  mfu: 4.84%
[rank3]:2025-10-25 21:31:24,020 - INFO -  step: 1760  loss:  0.4136  grad_norm:  0.7772  memory: 24.67GiB(51.93%)  tps: 1,931  tflops: 15.09  mfu: 4.84%
[rank1]:2025-10-25 21:31:24,011 - INFO -  step: 1760  loss: -4.0000  grad_norm:  0.7772  memory: 10.73GiB(22.58%)  tps: 1,931  tflops: 15.09  mfu: 4.84%
[rank3]:2025-10-25 21:31:25,955 - INFO - Avg. fwd time: 73.2395 / Avg. bwd time: 146.2671 / Avg. batch time: 1817.9747 (ms) / GPU bubble ratio: 3.41%
[rank2]:2025-10-25 21:31:26,025 - INFO - Avg. fwd time: 37.6209 / Avg. bwd time: 57.9849 / Avg. batch time: 1916.0934 (ms) / GPU bubble ratio: 60.08%
[rank1]:2025-10-25 21:31:26,113 - INFO - Avg. fwd time: 53.2210 / Avg. bwd time: 76.8933 / Avg. batch time: 2043.7856 (ms) / GPU bubble ratio: 49.07%
[rank0]:2025-10-25 21:31:26,191 - INFO - Avg. fwd time: 42.7325 / Avg. bwd time: 65.2058 / Avg. batch time: 2150.3223 (ms) / GPU bubble ratio: 59.84%
[rank3]:2025-10-25 21:34:14,306 - INFO -  step: 1780  loss:  0.3899  grad_norm:  0.8339  memory: 24.67GiB(51.93%)  tps: 1,924  tflops: 15.04  mfu: 4.82%
[rank2]:2025-10-25 21:34:14,294 - INFO -  step: 1780  loss: -4.0000  grad_norm:  0.8339  memory:  7.21GiB(15.18%)  tps: 1,924  tflops: 15.04  mfu: 4.82%
[rank1]:2025-10-25 21:34:14,297 - INFO -  step: 1780  loss: -4.0000  grad_norm:  0.8339  memory: 10.73GiB(22.58%)  tps: 1,924  tflops: 15.04  mfu: 4.82%
[rank0]:2025-10-25 21:34:14,313 - INFO -  step: 1780  loss: -4.0000  grad_norm:  0.8339  memory: 14.87GiB(31.30%)  tps: 1,924  tflops: 15.04  mfu: 4.82%
[rank3]:2025-10-25 21:34:16,246 - INFO - Avg. fwd time: 73.2122 / Avg. bwd time: 146.2236 / Avg. batch time: 1817.3482 (ms) / GPU bubble ratio: 3.40%
[rank2]:2025-10-25 21:34:16,313 - INFO - Avg. fwd time: 37.5988 / Avg. bwd time: 57.9528 / Avg. batch time: 1915.4057 (ms) / GPU bubble ratio: 60.09%
[rank1]:2025-10-25 21:34:16,392 - INFO - Avg. fwd time: 53.1977 / Avg. bwd time: 76.8372 / Avg. batch time: 2043.0402 (ms) / GPU bubble ratio: 49.08%
[rank0]:2025-10-25 21:34:16,468 - INFO - Avg. fwd time: 42.7144 / Avg. bwd time: 65.1761 / Avg. batch time: 2149.5180 (ms) / GPU bubble ratio: 59.85%
[rank0]:2025-10-25 21:36:55,436 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-25 21:37:03,855 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.7662  memory: 10.73GiB(22.58%)  tps: 1,933  tflops: 15.11  mfu: 4.84%
[rank3]:2025-10-25 21:37:03,864 - INFO -  step: 1800  loss:  0.3869  grad_norm:  0.7662  memory: 24.67GiB(51.93%)  tps: 1,933  tflops: 15.11  mfu: 4.84%
[rank2]:2025-10-25 21:37:03,852 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.7662  memory:  7.21GiB(15.18%)  tps: 1,933  tflops: 15.11  mfu: 4.84%
[rank0]:2025-10-25 21:37:03,874 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.7662  memory: 14.87GiB(31.30%)  tps: 1,933  tflops: 15.11  mfu: 4.84%
[rank3]:2025-10-25 21:37:04,129 - INFO - Pipeline schedule is saved as: /home/shcho/torchtitan/images/1023_1F1B_nofreeze_dm1/pipeline_schedule/251025_2137_real_step1800_rank3.svg
[rank3]:> Batch Time: 2007.09 ms, GPU Bubble Ratio: 58.91%, 50.61%, 63.87%, 15.21%
[rank3]:2025-10-25 21:37:05,949 - INFO - Avg. fwd time: 73.1846 / Avg. bwd time: 146.1753 / Avg. batch time: 1816.6825 (ms) / GPU bubble ratio: 3.40%
[rank2]:2025-10-25 21:37:06,014 - INFO - Avg. fwd time: 37.5756 / Avg. bwd time: 57.9175 / Avg. batch time: 1914.6884 (ms) / GPU bubble ratio: 60.10%
[rank1]:2025-10-25 21:37:06,093 - INFO - Avg. fwd time: 53.1723 / Avg. bwd time: 76.7818 / Avg. batch time: 2042.2398 (ms) / GPU bubble ratio: 49.09%
[rank0]:2025-10-25 21:37:06,162 - INFO - Avg. fwd time: 42.6938 / Avg. bwd time: 65.1433 / Avg. batch time: 2148.6503 (ms) / GPU bubble ratio: 59.85%
[rank3]:2025-10-25 21:38:34,164 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 21:38:35,095 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 21:38:35,174 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 21:38:35,241 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 21:39:53,961 - INFO -  step: 1820  loss: -4.0000  grad_norm:  0.8118  memory:  7.21GiB(15.18%)  tps: 1,926  tflops: 15.06  mfu: 4.83%
[rank1]:2025-10-25 21:39:53,965 - INFO -  step: 1820  loss: -4.0000  grad_norm:  0.8118  memory: 10.73GiB(22.58%)  tps: 1,926  tflops: 15.06  mfu: 4.83%
[rank3]:2025-10-25 21:39:53,973 - INFO -  step: 1820  loss:  0.3912  grad_norm:  0.8118  memory: 24.67GiB(51.93%)  tps: 1,926  tflops: 15.06  mfu: 4.83%
[rank0]:2025-10-25 21:39:53,984 - INFO -  step: 1820  loss: -4.0000  grad_norm:  0.8118  memory: 14.87GiB(31.30%)  tps: 1,926  tflops: 15.06  mfu: 4.83%
[rank3]:2025-10-25 21:39:55,905 - INFO - Avg. fwd time: 73.1575 / Avg. bwd time: 146.1322 / Avg. batch time: 1816.0636 (ms) / GPU bubble ratio: 3.40%
[rank2]:2025-10-25 21:39:55,976 - INFO - Avg. fwd time: 37.5535 / Avg. bwd time: 57.8837 / Avg. batch time: 1914.0091 (ms) / GPU bubble ratio: 60.11%
[rank1]:2025-10-25 21:39:56,066 - INFO - Avg. fwd time: 53.1528 / Avg. bwd time: 76.7288 / Avg. batch time: 2041.4983 (ms) / GPU bubble ratio: 49.10%
[rank0]:2025-10-25 21:39:56,139 - INFO - Avg. fwd time: 42.6736 / Avg. bwd time: 65.1124 / Avg. batch time: 2147.8473 (ms) / GPU bubble ratio: 59.85%
[rank3]:2025-10-25 21:42:44,133 - INFO -  step: 1840  loss:  0.3922  grad_norm:  0.8851  memory: 24.67GiB(51.93%)  tps: 1,926  tflops: 15.05  mfu: 4.83%
[rank2]:2025-10-25 21:42:44,120 - INFO -  step: 1840  loss: -4.0000  grad_norm:  0.8851  memory:  7.21GiB(15.18%)  tps: 1,926  tflops: 15.05  mfu: 4.83%
[rank0]:2025-10-25 21:42:44,141 - INFO -  step: 1840  loss: -4.0000  grad_norm:  0.8851  memory: 14.87GiB(31.30%)  tps: 1,926  tflops: 15.05  mfu: 4.83%
[rank1]:2025-10-25 21:42:44,124 - INFO -  step: 1840  loss: -4.0000  grad_norm:  0.8851  memory: 10.73GiB(22.58%)  tps: 1,926  tflops: 15.05  mfu: 4.83%
[rank3]:2025-10-25 21:42:46,068 - INFO - Avg. fwd time: 73.1314 / Avg. bwd time: 146.0899 / Avg. batch time: 1815.4608 (ms) / GPU bubble ratio: 3.40%
[rank2]:2025-10-25 21:42:46,140 - INFO - Avg. fwd time: 37.5323 / Avg. bwd time: 57.8521 / Avg. batch time: 1913.3540 (ms) / GPU bubble ratio: 60.12%
[rank0]:2025-10-25 21:42:46,308 - INFO - Avg. fwd time: 42.6549 / Avg. bwd time: 65.0817 / Avg. batch time: 2147.0902 (ms) / GPU bubble ratio: 59.86%
[rank1]:2025-10-25 21:42:46,231 - INFO - Avg. fwd time: 53.1477 / Avg. bwd time: 76.6956 / Avg. batch time: 2040.7973 (ms) / GPU bubble ratio: 49.10%
[rank0]:2025-10-25 21:44:00,362 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-25 21:45:33,381 - INFO -  step: 1860  loss:  0.4075  grad_norm:  0.7541  memory: 24.67GiB(51.93%)  tps: 1,936  tflops: 15.14  mfu: 4.85%
[rank2]:2025-10-25 21:45:33,368 - INFO -  step: 1860  loss: -4.0000  grad_norm:  0.7541  memory:  7.21GiB(15.18%)  tps: 1,936  tflops: 15.14  mfu: 4.85%
[rank0]:2025-10-25 21:45:33,386 - INFO -  step: 1860  loss: -4.0000  grad_norm:  0.7541  memory: 14.87GiB(31.30%)  tps: 1,936  tflops: 15.14  mfu: 4.85%
[rank1]:2025-10-25 21:45:33,372 - INFO -  step: 1860  loss: -4.0000  grad_norm:  0.7541  memory: 10.73GiB(22.58%)  tps: 1,936  tflops: 15.14  mfu: 4.85%
[rank3]:2025-10-25 21:45:35,295 - INFO - Avg. fwd time: 73.1031 / Avg. bwd time: 146.0401 / Avg. batch time: 1814.7811 (ms) / GPU bubble ratio: 3.40%
[rank2]:2025-10-25 21:45:35,366 - INFO - Avg. fwd time: 37.5117 / Avg. bwd time: 57.8187 / Avg. batch time: 1912.6083 (ms) / GPU bubble ratio: 60.13%
[rank0]:2025-10-25 21:45:35,536 - INFO - Avg. fwd time: 42.6364 / Avg. bwd time: 65.0528 / Avg. batch time: 2146.2206 (ms) / GPU bubble ratio: 59.86%
[rank1]:2025-10-25 21:45:35,458 - INFO - Avg. fwd time: 53.1304 / Avg. bwd time: 76.6466 / Avg. batch time: 2039.9911 (ms) / GPU bubble ratio: 49.11%
[rank1]:2025-10-25 21:48:22,987 - INFO -  step: 1880  loss: -4.0000  grad_norm:  0.7612  memory: 10.73GiB(22.58%)  tps: 1,932  tflops: 15.10  mfu: 4.84%
[rank3]:2025-10-25 21:48:22,994 - INFO -  step: 1880  loss:  0.3935  grad_norm:  0.7612  memory: 24.67GiB(51.93%)  tps: 1,932  tflops: 15.10  mfu: 4.84%
[rank2]:2025-10-25 21:48:22,982 - INFO -  step: 1880  loss: -4.0000  grad_norm:  0.7612  memory:  7.21GiB(15.18%)  tps: 1,932  tflops: 15.10  mfu: 4.84%
[rank0]:2025-10-25 21:48:23,005 - INFO -  step: 1880  loss: -4.0000  grad_norm:  0.7612  memory: 14.87GiB(31.30%)  tps: 1,932  tflops: 15.10  mfu: 4.84%
[rank3]:2025-10-25 21:48:24,920 - INFO - Avg. fwd time: 73.0771 / Avg. bwd time: 145.9947 / Avg. batch time: 1814.1566 (ms) / GPU bubble ratio: 3.39%
[rank2]:2025-10-25 21:48:24,991 - INFO - Avg. fwd time: 37.4921 / Avg. bwd time: 57.7901 / Avg. batch time: 1911.9254 (ms) / GPU bubble ratio: 60.13%
[rank1]:2025-10-25 21:48:25,080 - INFO - Avg. fwd time: 53.1085 / Avg. bwd time: 76.5986 / Avg. batch time: 2039.2435 (ms) / GPU bubble ratio: 49.12%
[rank0]:2025-10-25 21:48:25,155 - INFO - Avg. fwd time: 42.6181 / Avg. bwd time: 65.0227 / Avg. batch time: 2145.4158 (ms) / GPU bubble ratio: 59.86%
[rank3]:2025-10-25 21:50:14,618 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 21:50:15,533 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 21:50:15,614 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 21:50:15,674 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 21:51:04,395 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-25 21:51:12,903 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.6745  memory: 10.73GiB(22.58%)  tps: 1,928  tflops: 15.08  mfu: 4.83%
[rank3]:2025-10-25 21:51:12,911 - INFO -  step: 1900  loss:  0.3837  grad_norm:  0.6745  memory: 24.67GiB(51.93%)  tps: 1,928  tflops: 15.08  mfu: 4.83%
[rank2]:2025-10-25 21:51:12,899 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.6745  memory:  7.21GiB(15.18%)  tps: 1,928  tflops: 15.08  mfu: 4.83%
[rank0]:2025-10-25 21:51:12,924 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.6745  memory: 14.87GiB(31.30%)  tps: 1,928  tflops: 15.08  mfu: 4.83%
[rank3]:2025-10-25 21:51:13,180 - INFO - Pipeline schedule is saved as: /home/shcho/torchtitan/images/1023_1F1B_nofreeze_dm1/pipeline_schedule/251025_2151_real_step1900_rank3.svg
[rank3]:> Batch Time: 2008.03 ms, GPU Bubble Ratio: 58.89%, 50.62%, 63.90%, 15.22%
[rank3]:2025-10-25 21:51:14,991 - INFO - Avg. fwd time: 73.0526 / Avg. bwd time: 145.9527 / Avg. batch time: 1813.5721 (ms) / GPU bubble ratio: 3.39%
[rank2]:2025-10-25 21:51:15,062 - INFO - Avg. fwd time: 37.4731 / Avg. bwd time: 57.7593 / Avg. batch time: 1911.2989 (ms) / GPU bubble ratio: 60.14%
[rank1]:2025-10-25 21:51:15,144 - INFO - Avg. fwd time: 53.0903 / Avg. bwd time: 76.5519 / Avg. batch time: 2038.5656 (ms) / GPU bubble ratio: 49.12%
[rank0]:2025-10-25 21:51:15,214 - INFO - Avg. fwd time: 42.6001 / Avg. bwd time: 64.9958 / Avg. batch time: 2144.6843 (ms) / GPU bubble ratio: 59.87%
[rank3]:2025-10-25 21:54:02,744 - INFO -  step: 1920  loss:  0.3845  grad_norm:  0.8225  memory: 24.67GiB(51.93%)  tps: 1,929  tflops: 15.08  mfu: 4.83%
[rank0]:2025-10-25 21:54:02,756 - INFO -  step: 1920  loss: -4.0000  grad_norm:  0.8225  memory: 14.87GiB(31.30%)  tps: 1,929  tflops: 15.08  mfu: 4.83%
[rank2]:2025-10-25 21:54:02,731 - INFO -  step: 1920  loss: -4.0000  grad_norm:  0.8225  memory:  7.21GiB(15.18%)  tps: 1,929  tflops: 15.08  mfu: 4.83%
[rank1]:2025-10-25 21:54:02,736 - INFO -  step: 1920  loss: -4.0000  grad_norm:  0.8225  memory: 10.73GiB(22.58%)  tps: 1,929  tflops: 15.08  mfu: 4.83%
[rank3]:2025-10-25 21:54:04,682 - INFO - Avg. fwd time: 73.0275 / Avg. bwd time: 145.9107 / Avg. batch time: 1812.9845 (ms) / GPU bubble ratio: 3.39%
[rank2]:2025-10-25 21:54:04,755 - INFO - Avg. fwd time: 37.4529 / Avg. bwd time: 57.7331 / Avg. batch time: 1910.6570 (ms) / GPU bubble ratio: 60.15%
[rank1]:2025-10-25 21:54:04,835 - INFO - Avg. fwd time: 53.0698 / Avg. bwd time: 76.5033 / Avg. batch time: 2037.8669 (ms) / GPU bubble ratio: 49.13%
[rank0]:2025-10-25 21:54:04,906 - INFO - Avg. fwd time: 42.5833 / Avg. bwd time: 64.9696 / Avg. batch time: 2143.9303 (ms) / GPU bubble ratio: 59.87%
[rank2]:2025-10-25 21:56:51,782 - INFO -  step: 1940  loss: -4.0000  grad_norm:  0.7078  memory:  7.21GiB(15.18%)  tps: 1,938  tflops: 15.15  mfu: 4.86%
[rank1]:2025-10-25 21:56:51,792 - INFO -  step: 1940  loss: -4.0000  grad_norm:  0.7078  memory: 10.73GiB(22.58%)  tps: 1,938  tflops: 15.15  mfu: 4.86%
[rank3]:2025-10-25 21:56:51,794 - INFO -  step: 1940  loss:  0.3710  grad_norm:  0.7078  memory: 24.67GiB(51.93%)  tps: 1,938  tflops: 15.15  mfu: 4.86%
[rank0]:2025-10-25 21:56:51,801 - INFO -  step: 1940  loss: -4.0000  grad_norm:  0.7078  memory: 14.87GiB(31.30%)  tps: 1,938  tflops: 15.15  mfu: 4.86%
[rank3]:2025-10-25 21:56:53,707 - INFO - Avg. fwd time: 72.9999 / Avg. bwd time: 145.8637 / Avg. batch time: 1812.3374 (ms) / GPU bubble ratio: 3.39%
[rank2]:2025-10-25 21:56:53,773 - INFO - Avg. fwd time: 37.4345 / Avg. bwd time: 57.7034 / Avg. batch time: 1909.9517 (ms) / GPU bubble ratio: 60.15%
[rank1]:2025-10-25 21:56:53,864 - INFO - Avg. fwd time: 53.0521 / Avg. bwd time: 76.4590 / Avg. batch time: 2037.1015 (ms) / GPU bubble ratio: 49.14%
[rank0]:2025-10-25 21:56:53,941 - INFO - Avg. fwd time: 42.5693 / Avg. bwd time: 64.9419 / Avg. batch time: 2143.1041 (ms) / GPU bubble ratio: 59.87%
[rank0]:2025-10-25 21:58:07,823 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-25 21:59:41,133 - INFO -  step: 1960  loss: -4.0000  grad_norm:  0.7432  memory:  7.21GiB(15.18%)  tps: 1,935  tflops: 15.13  mfu: 4.85%
[rank1]:2025-10-25 21:59:41,137 - INFO -  step: 1960  loss: -4.0000  grad_norm:  0.7432  memory: 10.73GiB(22.58%)  tps: 1,935  tflops: 15.13  mfu: 4.85%
[rank0]:2025-10-25 21:59:41,152 - INFO -  step: 1960  loss: -4.0000  grad_norm:  0.7432  memory: 14.87GiB(31.30%)  tps: 1,935  tflops: 15.13  mfu: 4.85%
[rank3]:2025-10-25 21:59:41,145 - INFO -  step: 1960  loss:  0.4157  grad_norm:  0.7432  memory: 24.67GiB(51.93%)  tps: 1,935  tflops: 15.13  mfu: 4.85%
[rank3]:2025-10-25 21:59:43,067 - INFO - Avg. fwd time: 72.9748 / Avg. bwd time: 145.8190 / Avg. batch time: 1811.7299 (ms) / GPU bubble ratio: 3.39%
[rank2]:2025-10-25 21:59:43,138 - INFO - Avg. fwd time: 37.4160 / Avg. bwd time: 57.6746 / Avg. batch time: 1909.2889 (ms) / GPU bubble ratio: 60.16%
[rank1]:2025-10-25 21:59:43,228 - INFO - Avg. fwd time: 53.0341 / Avg. bwd time: 76.4108 / Avg. batch time: 2036.3931 (ms) / GPU bubble ratio: 49.15%
[rank0]:2025-10-25 21:59:43,305 - INFO - Avg. fwd time: 42.5549 / Avg. bwd time: 64.9153 / Avg. batch time: 2142.3352 (ms) / GPU bubble ratio: 59.87%
[rank3]:2025-10-25 22:01:51,809 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 22:01:52,819 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 22:01:52,746 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 22:01:52,878 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 22:02:31,093 - INFO -  step: 1980  loss: -4.0000  grad_norm:  0.7139  memory: 10.73GiB(22.58%)  tps: 1,928  tflops: 15.07  mfu: 4.83%
[rank2]:2025-10-25 22:02:31,089 - INFO -  step: 1980  loss: -4.0000  grad_norm:  0.7139  memory:  7.21GiB(15.18%)  tps: 1,928  tflops: 15.07  mfu: 4.83%
[rank3]:2025-10-25 22:02:31,101 - INFO -  step: 1980  loss:  0.3868  grad_norm:  0.7139  memory: 24.67GiB(51.93%)  tps: 1,928  tflops: 15.07  mfu: 4.83%
[rank0]:2025-10-25 22:02:31,103 - INFO -  step: 1980  loss: -4.0000  grad_norm:  0.7139  memory: 14.87GiB(31.30%)  tps: 1,928  tflops: 15.07  mfu: 4.83%
[rank3]:2025-10-25 22:02:33,033 - INFO - Avg. fwd time: 72.9522 / Avg. bwd time: 145.7817 / Avg. batch time: 1811.2019 (ms) / GPU bubble ratio: 3.39%
[rank2]:2025-10-25 22:02:33,099 - INFO - Avg. fwd time: 37.3984 / Avg. bwd time: 57.6478 / Avg. batch time: 1908.7084 (ms) / GPU bubble ratio: 60.16%
[rank1]:2025-10-25 22:02:33,189 - INFO - Avg. fwd time: 53.0164 / Avg. bwd time: 76.3715 / Avg. batch time: 2035.7671 (ms) / GPU bubble ratio: 49.15%
[rank0]:2025-10-25 22:02:33,263 - INFO - Avg. fwd time: 42.5415 / Avg. bwd time: 64.8900 / Avg. batch time: 2141.6622 (ms) / GPU bubble ratio: 59.87%
[rank0]:2025-10-25 22:05:11,772 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-25 22:05:20,237 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.7353  memory: 10.73GiB(22.58%)  tps: 1,937  tflops: 15.14  mfu: 4.85%
[rank1]:2025-10-25 22:05:20,237 - INFO -  final step: 2000  loss: -4.0000  grad_norm:  0.7353  tps: 1,887  tflops: 14.75  mfu: 4.73%
[rank1]:2025-10-25 22:05:20,237 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-25 22:05:20,239 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2000.
[rank2]:2025-10-25 22:05:20,233 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.7353  memory:  7.21GiB(15.18%)  tps: 1,937  tflops: 15.14  mfu: 4.85%
[rank2]:2025-10-25 22:05:20,233 - INFO -  final step: 2000  loss: -4.0000  grad_norm:  0.7353  tps: 1,887  tflops: 14.75  mfu: 4.73%
[rank2]:2025-10-25 22:05:20,233 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-25 22:05:20,235 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2000.
[rank0]:2025-10-25 22:05:20,256 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.7353  memory: 14.87GiB(31.30%)  tps: 1,937  tflops: 15.14  mfu: 4.85%
[rank0]:2025-10-25 22:05:20,256 - INFO -  final step: 2000  loss: -4.0000  grad_norm:  0.7353  tps: 1,887  tflops: 14.75  mfu: 4.73%
[rank0]:2025-10-25 22:05:20,256 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-25 22:05:20,258 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2000.
[rank3]:2025-10-25 22:05:20,245 - INFO -  step: 2000  loss:  0.3731  grad_norm:  0.7353  memory: 24.67GiB(51.93%)  tps: 1,937  tflops: 15.14  mfu: 4.85%
[rank3]:2025-10-25 22:05:20,246 - INFO -  final step: 2000  loss:  0.3731  grad_norm:  0.7353  tps: 1,887  tflops: 14.75  mfu: 4.74%
[rank3]:2025-10-25 22:05:20,246 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-25 22:05:20,248 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2000.
[rank0]:2025-10-25 22:05:23,172 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-25 22:05:23,194 - INFO - Sleeping 2 seconds for other ranks to complete
[rank1]:2025-10-25 22:05:23,194 - INFO - Destroying the purge thread.
[rank2]:2025-10-25 22:05:23,194 - INFO - Destroying the purge thread.
[rank3]:2025-10-25 22:05:23,424 - INFO - Pipeline schedule is saved as: /home/shcho/torchtitan/images/1023_1F1B_nofreeze_dm1/pipeline_schedule/251025_2205_real_final2000_rank3.svg
[rank3]:> Batch Time: 2008.25 ms, GPU Bubble Ratio: 58.85%, 50.64%, 63.91%, 15.23%
[rank2]:2025-10-25 22:05:23,574 - INFO - Process group destroyed
[rank1]:2025-10-25 22:05:23,589 - INFO - Process group destroyed
[rank3]:2025-10-25 22:05:23,638 - INFO - Pipeline schedule is saved as: /home/shcho/torchtitan/images/1023_1F1B_nofreeze_dm1/pipeline_schedule/251025_2205_thry_final2000_rank3.svg
[rank3]:> Batch Time: 1642.01 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:2025-10-25 22:05:23,639 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading history steps 99-100, summary, console lines 456-464
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–‚â–â–‚â–‚â–‚â–‚â–ƒâ–‚â–ƒâ–‚â–‚â–ƒâ–‚â–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–‚â–‚â–‚
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–ˆâ–ˆâ–‡â–‡â–†â–†â–†â–…â–†â–…â–…â–…â–…â–„â–„â–„â–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–‡â–†â–†â–†â–…â–…â–„â–„â–„â–„â–„â–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–‚â–‚â–‚â–‚â–‚â–‚â–â–‚â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 8.68223
[rank3]:wandb:               final/avg_loss 0.37315
[rank3]:wandb:             final/avg_mfu(%) 4.73799
[rank3]:wandb:             final/avg_tflops 14.75226
[rank3]:wandb:    final/avg_throughput(tps) 1887.07216
[rank3]:wandb:              final/grad_norm 0.73534
[rank3]:wandb:               final/max_loss 0.37315
[rank3]:wandb:                    grad_norm 0.73534
[rank3]:wandb: loss_metrics/global_avg_loss 0.37315
[rank3]:wandb: loss_metrics/global_max_loss 0.37315
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1023_1F1B_nofreeze_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/p7xt7v2m
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1023_1F1B_nofreeze_dm1/20251025-1712/wandb/run-20251025_171300-p7xt7v2m/logs
[rank0]:2025-10-25 22:05:25,195 - INFO - Training completed
[rank0]:2025-10-25 22:05:25,195 - INFO - Destroying the purge thread.
[rank3]:2025-10-25 22:05:25,128 - INFO - Process group destroyed
[rank0]:2025-10-25 22:05:25,654 - INFO - Process group destroyed
[rank1]:Stage 1: Modules to keep: {'layers.5', 'layers.8', 'layers.7', 'layers.4', 'layers.6'}
[rank2]:Stage 2: Modules to keep: {'layers.9', 'layers.12', 'layers.11', 'layers.10'}
[rank0]:Stage 0: Modules to keep: {'layers.0', 'layers.2', 'tok_embeddings', 'layers.3', 'layers.1'}
[rank3]:Stage 3: Modules to keep: {'output', 'layers.14', 'layers.13', 'norm', 'layers.15'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1022_llama1binstruct/config.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1023_1F1B_nofreeze_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: profile_trace/1023_1F1B_nofreeze_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: memory_snapshot/1023_1F1B_nofreeze_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 20
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: tb/1023_1F1B_nofreeze_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: images/1023_1F1B_nofreeze_dm1
[rank3]:		- pplog_freq: 80
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1023_1F1B_nofreeze_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B-Instruct
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 1e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: alpaca
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 2000
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: 1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: checkpoint/1023_1F1B_nofreeze_dm1
[rank3]:		- interval: 500
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B-Instruct/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: comm_traces/1023_1F1B_nofreeze_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 8
[rank3]:		- seq_len: 2048
[rank3]:		- freq: 10
[rank3]:		- steps: -1
[rank3]:	- freezing:
[rank3]:		- freeze: False
[rank3]:		- metric_type: apf
[rank3]:		- phase_unit: 10
[rank3]:		- stability_check_freq: 5
[rank3]:		- aggressiveness: 0
[rank3]:
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
