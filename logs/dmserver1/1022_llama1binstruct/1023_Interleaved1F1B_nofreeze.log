
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 10. 24. (ê¸ˆ) 22:25:41 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 3,4,5,6
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1022_llama1binstruct/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1022_llama1binstruct/1023_Interleaved1F1B_nofreeze.log
âœ”ï¸Main Table Experiment
âœ”ï¸Running with nofreeze x Interleaved1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1022_llama1binstruct/config.toml --job.description="Main Table Experiment" --parallelism.pipeline_parallel_degree=4  --freezing.no-freeze
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank0]:2025-10-24 22:25:47,348 - INFO - Starting job: "Main Table Experiment"
[rank3]:2025-10-24 22:25:47,418 - INFO - Starting job: "Main Table Experiment"
[rank1]:2025-10-24 22:25:47,455 - INFO - Starting job: "Main Table Experiment"
[rank2]:2025-10-24 22:25:47,520 - INFO - Starting job: "Main Table Experiment"
[rank0]:2025-10-24 22:25:47,536 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-10-24 22:25:47,538 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-24 22:25:47,543 - INFO - [GC] Initial GC collection 0.00 seconds
[rank3]:2025-10-24 22:25:47,663 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-10-24 22:25:47,666 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-10-24 22:25:47,737 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-10-24 22:25:47,740 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-10-24 22:25:47,777 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-10-24 22:25:47,780 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-24 22:25:48,084 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-10-24 22:25:48,466 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank0]:2025-10-24 22:25:51,845 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank0]:2025-10-24 22:25:51,992 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-10-24 22:25:52,032 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-10-24 22:25:52,033 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank2]:2025-10-24 22:25:52,110 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-10-24 22:25:52,055 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1']
[rank0]:2025-10-24 22:25:52,067 - INFO - PP rank 0 is building stage_idx 4 with modules ['layers.9', 'layers.10']
[rank0]:2025-10-24 22:25:52,068 - INFO - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank2]:2025-10-24 22:25:52,150 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-10-24 22:25:52,178 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.5', 'layers.6']
[rank2]:2025-10-24 22:25:52,191 - INFO - PP rank 2 is building stage_idx 6 with modules ['layers.13', 'layers.14']
[rank2]:2025-10-24 22:25:52,192 - INFO - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank2]:2025-10-24 22:25:52,882 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-10-24 22:25:52,882 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-10-24 22:25:52,882 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank0]:2025-10-24 22:25:52,890 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-10-24 22:25:52,890 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-10-24 22:25:52,891 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank1]:2025-10-24 22:25:53,351 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-10-24 22:25:53,392 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-10-24 22:25:53,420 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.2', 'layers.3', 'layers.4']
[rank1]:2025-10-24 22:25:53,433 - INFO - PP rank 1 is building stage_idx 5 with modules ['layers.11', 'layers.12']
[rank1]:2025-10-24 22:25:53,434 - INFO - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank1]:2025-10-24 22:25:53,611 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-10-24 22:25:53,611 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-10-24 22:25:53,612 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank3]:wandb: setting up run 301gvk8h
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1023_Interleaved1F1B_nofreeze_dm1/20251024-2225/wandb/run-20251024_222553-301gvk8h
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1023_Interleaved1F1B_nofreeze_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/301gvk8h
[rank3]:2025-10-24 22:25:54,109 - INFO - WandB logging enabled
[rank3]:2025-10-24 22:25:54,199 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-10-24 22:25:54,236 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-10-24 22:25:54,263 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.7', 'layers.8']
[rank3]:2025-10-24 22:25:54,276 - INFO - PP rank 3 is building stage_idx 7 with modules ['layers.15', 'norm', 'output']
[rank3]:2025-10-24 22:25:54,277 - INFO - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank3]:2025-10-24 22:25:54,727 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-10-24 22:25:54,728 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-10-24 22:25:54,729 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank0]:2025-10-24 22:25:54,743 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1023_Interleaved1F1B_nofreeze_dm1
[rank0]:2025-10-24 22:25:54,743 - WARNING - Mixed precision training with TP or PP is only supported when FSDP/HSDP/CP is enabled.
[rank0]:2025-10-24 22:25:54,743 - INFO - Mixed precision training is disabled
[rank0]:2025-10-24 22:25:54,743 - INFO - Trainer is initialized with local batch size 16, global batch size 64, gradient accumulation steps 4, sequence length 1024, total steps 2000 (warmup 100)
[rank0]:2025-10-24 22:25:54,744 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B-Instruct/original_dcp.
[rank0]:2025-10-24 22:25:56,833 - INFO - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-10-24 22:25:56,833 - INFO - Finished loading the checkpoint in 2.09 seconds.
[rank0]:2025-10-24 22:25:56,833 - INFO - Training starts at step 1
[rank0]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/autograd/graph.py:849: UserWarning: Attempting to run cuBLAS, but there was no current CUDA context! Attempting to set the primary context... (Triggered internally at /pytorch/aten/src/ATen/cuda/CublasHandlePool.cpp:270.)
[rank0]:  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
[rank0]:2025-10-24 22:26:06,296 - INFO -  step:  1  loss: -4.0000  grad_norm:  3.4827  memory: 13.74GiB(28.92%)  tps: 1,149  tflops: 8.98  mfu: 2.88%
[rank0]:2025-10-24 22:26:06,296 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-10-24 22:26:06,263 - INFO -  step:  1  loss: -4.0000  grad_norm:  3.4827  memory: 12.88GiB(27.11%)  tps: 1,273  tflops: 9.95  mfu: 3.19%
[rank1]:2025-10-24 22:26:06,263 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-24 22:26:06,271 - INFO -  step:  1  loss:  1.7854  grad_norm:  3.4827  memory: 23.89GiB(50.29%)  tps: 1,362  tflops: 10.64  mfu: 3.41%
[rank3]:2025-10-24 22:26:06,272 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-10-24 22:26:06,260 - INFO -  step:  1  loss: -4.0000  grad_norm:  3.4827  memory:  7.99GiB(16.83%)  tps: 1,161  tflops: 9.08  mfu: 2.91%
[rank2]:2025-10-24 22:26:06,260 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-24 22:26:20,935 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-24 22:26:20,936 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-24 22:26:20,937 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-24 22:26:20,937 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-24 22:26:20,937 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-24 22:26:20,937 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-24 22:26:20,938 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-24 22:26:20,938 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-24 22:26:20,938 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-24 22:26:20,938 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-24 22:26:20,939 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-24 22:26:20,939 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-24 22:26:20,939 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-24 22:26:20,939 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-24 22:26:20,940 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-24 22:26:20,940 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-24 22:26:20,940 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-24 22:26:20,940 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-24 22:26:20,941 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-24 22:26:20,941 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-24 22:26:20,941 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-24 22:26:20,941 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-24 22:26:20,941 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-24 22:26:20,942 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-24 22:26:20,942 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-24 22:26:20,942 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-24 22:26:20,942 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-24 22:26:20,943 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-24 22:26:20,943 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-24 22:26:20,943 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-24 22:26:20,943 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-24 22:26:20,943 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-24 22:26:20,986 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-24 22:26:20,986 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-24 22:26:20,986 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-24 22:26:20,986 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-24 22:26:20,986 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-24 22:26:20,986 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-24 22:26:20,986 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-24 22:26:20,986 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-24 22:26:20,986 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-24 22:26:20,986 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-24 22:26:20,986 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-24 22:26:20,986 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-24 22:26:20,986 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-24 22:26:20,986 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-24 22:26:20,986 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-24 22:26:20,986 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-24 22:26:20,987 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-24 22:26:20,987 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-24 22:26:20,987 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-24 22:26:20,987 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-24 22:26:20,987 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-24 22:26:20,987 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-24 22:26:20,987 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-24 22:26:20,987 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-24 22:26:20,987 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-24 22:26:20,987 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-24 22:26:20,987 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-24 22:26:20,987 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-24 22:26:20,987 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-24 22:26:20,987 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-24 22:26:20,987 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-24 22:26:20,987 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-24 22:26:21,064 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-24 22:26:21,065 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-24 22:26:21,065 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-24 22:26:21,065 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-24 22:26:21,065 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-24 22:26:21,065 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-24 22:26:21,065 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-24 22:26:21,065 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-24 22:26:21,065 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-24 22:26:21,065 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-24 22:26:21,065 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-24 22:26:21,065 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-24 22:26:21,065 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-24 22:26:21,065 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-24 22:26:21,065 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-24 22:26:21,065 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-24 22:26:21,065 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-24 22:26:21,065 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-24 22:26:21,065 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-24 22:26:21,065 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-24 22:26:21,066 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-24 22:26:21,066 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-24 22:26:21,066 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-24 22:26:21,066 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-24 22:26:21,066 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-24 22:26:21,066 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-24 22:26:21,066 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-24 22:26:21,066 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-24 22:26:21,066 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-24 22:26:21,066 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-24 22:26:21,066 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-24 22:26:21,066 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-24 22:26:21,101 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-24 22:26:21,101 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-24 22:26:21,102 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-24 22:26:21,102 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-24 22:26:21,102 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-24 22:26:21,102 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-24 22:26:21,102 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-24 22:26:21,102 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-24 22:26:21,102 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-24 22:26:21,102 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-24 22:26:21,102 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-24 22:26:21,102 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-24 22:26:21,102 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-24 22:26:21,102 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-24 22:26:21,102 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-24 22:26:21,102 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-24 22:26:21,102 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-24 22:26:21,102 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-24 22:26:21,102 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-24 22:26:21,102 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-24 22:26:21,102 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-24 22:26:21,102 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-24 22:26:21,103 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-24 22:26:21,103 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-24 22:26:21,103 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-24 22:26:21,103 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-24 22:26:21,103 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-24 22:26:21,103 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-24 22:26:21,103 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-24 22:26:21,103 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-24 22:26:21,103 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-24 22:26:21,103 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-24 22:28:50,054 - INFO -  step: 20  loss: -4.0000  grad_norm:  1.4899  memory:  9.81GiB(20.65%)  tps: 1,901  tflops: 14.86  mfu: 4.76%
[rank0]:2025-10-24 22:28:50,071 - INFO -  step: 20  loss: -4.0000  grad_norm:  1.4899  memory: 17.51GiB(36.85%)  tps: 1,901  tflops: 14.86  mfu: 4.76%
[rank3]:2025-10-24 22:28:50,066 - INFO -  step: 20  loss:  1.3862  grad_norm:  1.4899  memory: 26.71GiB(56.21%)  tps: 1,901  tflops: 14.86  mfu: 4.76%
[rank1]:2025-10-24 22:28:50,057 - INFO -  step: 20  loss: -4.0000  grad_norm:  1.4899  memory: 15.15GiB(31.88%)  tps: 1,901  tflops: 14.86  mfu: 4.76%
[rank3]:2025-10-24 22:28:52,053 - INFO - Avg. fwd time: 32.7558 / Avg. bwd time: 69.4878 / Avg. batch time: 1873.7093 (ms) / GPU bubble ratio: 12.69%
[rank2]:2025-10-24 22:28:52,107 - INFO - Avg. fwd time: 17.1232 / Avg. bwd time: 28.0496 / Avg. batch time: 1945.3025 (ms) / GPU bubble ratio: 62.85%
[rank1]:2025-10-24 22:28:52,187 - INFO - Avg. fwd time: 22.2098 / Avg. bwd time: 40.4283 / Avg. batch time: 2049.5934 (ms) / GPU bubble ratio: 51.10%
[rank0]:2025-10-24 22:28:52,224 - INFO - Avg. fwd time: 19.0925 / Avg. bwd time: 30.9929 / Avg. batch time: 2103.4287 (ms) / GPU bubble ratio: 61.90%
[rank1]:2025-10-24 22:31:44,466 - INFO -  step: 40  loss: -4.0000  grad_norm:  2.1309  memory: 15.15GiB(31.88%)  tps: 1,879  tflops: 14.69  mfu: 4.71%
[rank3]:2025-10-24 22:31:44,474 - INFO -  step: 40  loss:  1.2757  grad_norm:  2.1309  memory: 26.71GiB(56.21%)  tps: 1,879  tflops: 14.69  mfu: 4.71%
[rank2]:2025-10-24 22:31:44,462 - INFO -  step: 40  loss: -4.0000  grad_norm:  2.1309  memory:  9.81GiB(20.65%)  tps: 1,879  tflops: 14.69  mfu: 4.71%
[rank0]:2025-10-24 22:31:44,482 - INFO -  step: 40  loss: -4.0000  grad_norm:  2.1309  memory: 17.51GiB(36.85%)  tps: 1,879  tflops: 14.69  mfu: 4.71%
[rank3]:2025-10-24 22:31:46,501 - INFO - Avg. fwd time: 33.2315 / Avg. bwd time: 70.4121 / Avg. batch time: 1886.9754 (ms) / GPU bubble ratio: 12.12%
[rank2]:2025-10-24 22:31:46,557 - INFO - Avg. fwd time: 17.2883 / Avg. bwd time: 28.3013 / Avg. batch time: 1958.9867 (ms) / GPU bubble ratio: 62.76%
[rank1]:2025-10-24 22:31:46,632 - INFO - Avg. fwd time: 22.5368 / Avg. bwd time: 40.9754 / Avg. batch time: 2064.0046 (ms) / GPU bubble ratio: 50.77%
[rank0]:2025-10-24 22:31:46,670 - INFO - Avg. fwd time: 19.2673 / Avg. bwd time: 31.3266 / Avg. batch time: 2118.1669 (ms) / GPU bubble ratio: 61.78%
[rank0]:2025-10-24 22:33:02,827 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-24 22:34:38,593 - INFO -  step: 60  loss:  1.2100  grad_norm:  0.5366  memory: 26.71GiB(56.21%)  tps: 1,882  tflops: 14.71  mfu: 4.72%
[rank1]:2025-10-24 22:34:38,585 - INFO -  step: 60  loss: -4.0000  grad_norm:  0.5366  memory: 15.15GiB(31.88%)  tps: 1,882  tflops: 14.71  mfu: 4.72%
[rank2]:2025-10-24 22:34:38,582 - INFO -  step: 60  loss: -4.0000  grad_norm:  0.5366  memory:  9.81GiB(20.65%)  tps: 1,882  tflops: 14.71  mfu: 4.72%
[rank0]:2025-10-24 22:34:38,599 - INFO -  step: 60  loss: -4.0000  grad_norm:  0.5366  memory: 17.51GiB(36.85%)  tps: 1,882  tflops: 14.71  mfu: 4.72%
[rank3]:2025-10-24 22:34:40,606 - INFO - Avg. fwd time: 33.3669 / Avg. bwd time: 70.6360 / Avg. batch time: 1889.5743 (ms) / GPU bubble ratio: 11.94%
[rank2]:2025-10-24 22:34:40,658 - INFO - Avg. fwd time: 17.3282 / Avg. bwd time: 28.3527 / Avg. batch time: 1961.7025 (ms) / GPU bubble ratio: 62.74%
[rank1]:2025-10-24 22:34:40,737 - INFO - Avg. fwd time: 22.6330 / Avg. bwd time: 41.1452 / Avg. batch time: 2067.0931 (ms) / GPU bubble ratio: 50.63%
[rank0]:2025-10-24 22:34:40,774 - INFO - Avg. fwd time: 19.2962 / Avg. bwd time: 31.4285 / Avg. batch time: 2121.4583 (ms) / GPU bubble ratio: 61.74%
[rank3]:2025-10-24 22:37:32,698 - INFO -  step: 80  loss:  1.1799  grad_norm:  0.5012  memory: 26.71GiB(56.21%)  tps: 1,882  tflops: 14.71  mfu: 4.72%
[rank1]:2025-10-24 22:37:32,689 - INFO -  step: 80  loss: -4.0000  grad_norm:  0.5012  memory: 15.15GiB(31.88%)  tps: 1,882  tflops: 14.71  mfu: 4.72%
[rank2]:2025-10-24 22:37:32,686 - INFO -  step: 80  loss: -4.0000  grad_norm:  0.5012  memory:  9.81GiB(20.65%)  tps: 1,882  tflops: 14.71  mfu: 4.72%
[rank0]:2025-10-24 22:37:32,700 - INFO -  step: 80  loss: -4.0000  grad_norm:  0.5012  memory: 17.51GiB(36.85%)  tps: 1,882  tflops: 14.71  mfu: 4.72%
[rank3]:2025-10-24 22:37:34,725 - INFO - Avg. fwd time: 33.4470 / Avg. bwd time: 70.7505 / Avg. batch time: 1891.1291 (ms) / GPU bubble ratio: 11.84%
[rank2]:2025-10-24 22:37:34,788 - INFO - Avg. fwd time: 17.3565 / Avg. bwd time: 28.4116 / Avg. batch time: 1963.2991 (ms) / GPU bubble ratio: 62.70%
[rank1]:2025-10-24 22:37:34,868 - INFO - Avg. fwd time: 22.6870 / Avg. bwd time: 41.2701 / Avg. batch time: 2068.6598 (ms) / GPU bubble ratio: 50.53%
[rank0]:2025-10-24 22:37:34,905 - INFO - Avg. fwd time: 19.3387 / Avg. bwd time: 31.4541 / Avg. batch time: 2123.0461 (ms) / GPU bubble ratio: 61.72%
[rank3]:2025-10-24 22:37:51,438 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-24 22:37:52,351 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-24 22:37:52,407 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 22:37:52,442 - WARNING - Dataset alpaca is being re-looped
[rank3]:2025-10-24 22:39:00,684 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_nofreeze_dm1/pipeline_schedule/251024_2238_real_warmupend90_rank3.svg
[rank3]:> Batch Time: 1911.30 ms, GPU Bubble Ratio: 57.33%, 46.24%, 61.87%, 12.27%
[rank0]:2025-10-24 22:40:19,043 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-24 22:40:27,730 - INFO -  step: 100  loss:  1.1786  grad_norm:  0.4903  memory: 26.71GiB(56.21%)  tps: 1,872  tflops: 14.64  mfu: 4.69%
[rank1]:2025-10-24 22:40:27,729 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.4903  memory: 15.15GiB(31.88%)  tps: 1,872  tflops: 14.63  mfu: 4.69%
[rank0]:2025-10-24 22:40:27,732 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.4903  memory: 17.51GiB(36.85%)  tps: 1,872  tflops: 14.64  mfu: 4.69%
[rank2]:2025-10-24 22:40:27,718 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.4903  memory:  9.81GiB(20.65%)  tps: 1,872  tflops: 14.64  mfu: 4.69%
[rank3]:2025-10-24 22:40:28,087 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_nofreeze_dm1/pipeline_schedule/251024_2240_real_step100_rank3.svg
[rank3]:> Batch Time: 1911.75 ms, GPU Bubble Ratio: 57.30%, 46.29%, 61.86%, 12.26%
[rank3]:2025-10-24 22:40:30,014 - INFO - Avg. fwd time: 33.5078 / Avg. bwd time: 70.8783 / Avg. batch time: 1893.2534 (ms) / GPU bubble ratio: 11.78%
[rank2]:2025-10-24 22:40:30,068 - INFO - Avg. fwd time: 17.3767 / Avg. bwd time: 28.4393 / Avg. batch time: 1966.9877 (ms) / GPU bubble ratio: 62.73%
[rank1]:2025-10-24 22:40:30,143 - INFO - Avg. fwd time: 22.7227 / Avg. bwd time: 41.3178 / Avg. batch time: 2072.2841 (ms) / GPU bubble ratio: 50.55%
[rank0]:2025-10-24 22:40:30,189 - INFO - Avg. fwd time: 19.3300 / Avg. bwd time: 31.5074 / Avg. batch time: 2126.7954 (ms) / GPU bubble ratio: 61.75%
[rank3]:2025-10-24 22:43:22,106 - INFO -  step: 120  loss:  1.1287  grad_norm:  0.5573  memory: 26.71GiB(56.21%)  tps: 1,879  tflops: 14.69  mfu: 4.71%
[rank1]:2025-10-24 22:43:22,098 - INFO -  step: 120  loss: -4.0000  grad_norm:  0.5573  memory: 15.15GiB(31.88%)  tps: 1,879  tflops: 14.69  mfu: 4.71%
[rank2]:2025-10-24 22:43:22,094 - INFO -  step: 120  loss: -4.0000  grad_norm:  0.5573  memory:  9.81GiB(20.65%)  tps: 1,879  tflops: 14.69  mfu: 4.71%
[rank0]:2025-10-24 22:43:22,108 - INFO -  step: 120  loss: -4.0000  grad_norm:  0.5573  memory: 17.51GiB(36.85%)  tps: 1,879  tflops: 14.69  mfu: 4.71%
[rank3]:2025-10-24 22:43:24,123 - INFO - Avg. fwd time: 33.5224 / Avg. bwd time: 70.9322 / Avg. batch time: 1893.6358 (ms) / GPU bubble ratio: 11.74%
[rank2]:2025-10-24 22:43:24,179 - INFO - Avg. fwd time: 17.3866 / Avg. bwd time: 28.4556 / Avg. batch time: 1966.9795 (ms) / GPU bubble ratio: 62.71%
[rank1]:2025-10-24 22:43:24,258 - INFO - Avg. fwd time: 22.7255 / Avg. bwd time: 41.3292 / Avg. batch time: 2072.2411 (ms) / GPU bubble ratio: 50.54%
[rank0]:2025-10-24 22:43:24,296 - INFO - Avg. fwd time: 19.3418 / Avg. bwd time: 31.5202 / Avg. batch time: 2126.7140 (ms) / GPU bubble ratio: 61.73%
[rank3]:2025-10-24 22:46:16,784 - INFO -  step: 140  loss:  1.1524  grad_norm:  0.4514  memory: 26.71GiB(56.21%)  tps: 1,876  tflops: 14.67  mfu: 4.70%
[rank1]:2025-10-24 22:46:16,781 - INFO -  step: 140  loss: -4.0000  grad_norm:  0.4514  memory: 15.15GiB(31.88%)  tps: 1,876  tflops: 14.66  mfu: 4.70%
[rank2]:2025-10-24 22:46:16,771 - INFO -  step: 140  loss: -4.0000  grad_norm:  0.4514  memory:  9.81GiB(20.65%)  tps: 1,876  tflops: 14.67  mfu: 4.70%
[rank0]:2025-10-24 22:46:16,786 - INFO -  step: 140  loss: -4.0000  grad_norm:  0.4514  memory: 17.51GiB(36.85%)  tps: 1,876  tflops: 14.67  mfu: 4.70%
[rank3]:2025-10-24 22:46:18,787 - INFO - Avg. fwd time: 33.5479 / Avg. bwd time: 70.9909 / Avg. batch time: 1894.6329 (ms) / GPU bubble ratio: 11.72%
[rank2]:2025-10-24 22:46:18,843 - INFO - Avg. fwd time: 17.3991 / Avg. bwd time: 28.4668 / Avg. batch time: 1967.8264 (ms) / GPU bubble ratio: 62.71%
[rank1]:2025-10-24 22:46:18,917 - INFO - Avg. fwd time: 22.7553 / Avg. bwd time: 41.3560 / Avg. batch time: 2073.2471 (ms) / GPU bubble ratio: 50.52%
[rank0]:2025-10-24 22:46:18,963 - INFO - Avg. fwd time: 19.3465 / Avg. bwd time: 31.5479 / Avg. batch time: 2127.7415 (ms) / GPU bubble ratio: 61.73%
[rank0]:2025-10-24 22:47:35,382 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-24 22:49:11,012 - INFO -  step: 160  loss: -4.0000  grad_norm:  0.4618  memory: 15.15GiB(31.88%)  tps: 1,881  tflops: 14.70  mfu: 4.71%
[rank3]:2025-10-24 22:49:11,021 - INFO -  step: 160  loss:  1.1176  grad_norm:  0.4618  memory: 26.71GiB(56.21%)  tps: 1,881  tflops: 14.70  mfu: 4.71%
[rank0]:2025-10-24 22:49:11,024 - INFO -  step: 160  loss: -4.0000  grad_norm:  0.4618  memory: 17.51GiB(36.85%)  tps: 1,881  tflops: 14.70  mfu: 4.71%
[rank2]:2025-10-24 22:49:11,009 - INFO -  step: 160  loss: -4.0000  grad_norm:  0.4618  memory:  9.81GiB(20.65%)  tps: 1,881  tflops: 14.70  mfu: 4.71%
[rank3]:2025-10-24 22:49:13,030 - INFO - Avg. fwd time: 33.5566 / Avg. bwd time: 71.0126 / Avg. batch time: 1894.7714 (ms) / GPU bubble ratio: 11.70%
[rank2]:2025-10-24 22:49:13,083 - INFO - Avg. fwd time: 17.4050 / Avg. bwd time: 28.4852 / Avg. batch time: 1967.8876 (ms) / GPU bubble ratio: 62.69%
[rank1]:2025-10-24 22:49:13,160 - INFO - Avg. fwd time: 22.7614 / Avg. bwd time: 41.3864 / Avg. batch time: 2073.2968 (ms) / GPU bubble ratio: 50.50%
[rank0]:2025-10-24 22:49:13,201 - INFO - Avg. fwd time: 19.3487 / Avg. bwd time: 31.5490 / Avg. batch time: 2127.7863 (ms) / GPU bubble ratio: 61.73%
[rank3]:2025-10-24 22:49:49,123 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-24 22:49:50,079 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-24 22:49:50,024 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 22:49:50,114 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-24 22:52:05,179 - INFO -  step: 180  loss: -4.0000  grad_norm:  0.4911  memory: 15.15GiB(31.88%)  tps: 1,881  tflops: 14.71  mfu: 4.71%
[rank3]:2025-10-24 22:52:05,187 - INFO -  step: 180  loss:  1.0987  grad_norm:  0.4911  memory: 26.71GiB(56.21%)  tps: 1,881  tflops: 14.71  mfu: 4.71%
[rank2]:2025-10-24 22:52:05,175 - INFO -  step: 180  loss: -4.0000  grad_norm:  0.4911  memory:  9.81GiB(20.65%)  tps: 1,881  tflops: 14.71  mfu: 4.71%
[rank0]:2025-10-24 22:52:05,193 - INFO -  step: 180  loss: -4.0000  grad_norm:  0.4911  memory: 17.51GiB(36.85%)  tps: 1,881  tflops: 14.71  mfu: 4.71%
[rank3]:2025-10-24 22:52:07,220 - INFO - Avg. fwd time: 33.5669 / Avg. bwd time: 71.0285 / Avg. batch time: 1894.9131 (ms) / GPU bubble ratio: 11.68%
[rank2]:2025-10-24 22:52:07,275 - INFO - Avg. fwd time: 17.4076 / Avg. bwd time: 28.4888 / Avg. batch time: 1967.8878 (ms) / GPU bubble ratio: 62.68%
[rank1]:2025-10-24 22:52:07,355 - INFO - Avg. fwd time: 22.7699 / Avg. bwd time: 41.3931 / Avg. batch time: 2073.2939 (ms) / GPU bubble ratio: 50.48%
[rank0]:2025-10-24 22:52:07,393 - INFO - Avg. fwd time: 19.3449 / Avg. bwd time: 31.5846 / Avg. batch time: 2127.8081 (ms) / GPU bubble ratio: 61.70%
[rank0]:2025-10-24 22:54:51,429 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-24 22:55:00,229 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.4348  memory: 15.15GiB(31.88%)  tps: 1,872  tflops: 14.63  mfu: 4.69%
[rank2]:2025-10-24 22:55:00,225 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.4348  memory:  9.81GiB(20.65%)  tps: 1,872  tflops: 14.63  mfu: 4.69%
[rank0]:2025-10-24 22:55:00,243 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.4348  memory: 17.51GiB(36.85%)  tps: 1,872  tflops: 14.63  mfu: 4.69%
[rank3]:2025-10-24 22:55:00,237 - INFO -  step: 200  loss:  1.0917  grad_norm:  0.4348  memory: 26.71GiB(56.21%)  tps: 1,872  tflops: 14.63  mfu: 4.69%
[rank3]:2025-10-24 22:55:00,600 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_nofreeze_dm1/pipeline_schedule/251024_2255_real_step200_rank3.svg
[rank3]:> Batch Time: 1913.22 ms, GPU Bubble Ratio: 57.26%, 46.23%, 61.86%, 12.26%
[rank3]:2025-10-24 22:55:02,565 - INFO - Avg. fwd time: 33.5857 / Avg. bwd time: 71.0802 / Avg. batch time: 1895.8772 (ms) / GPU bubble ratio: 11.67%
[rank2]:2025-10-24 22:55:02,615 - INFO - Avg. fwd time: 17.4132 / Avg. bwd time: 28.4975 / Avg. batch time: 1969.1451 (ms) / GPU bubble ratio: 62.70%
[rank1]:2025-10-24 22:55:02,692 - INFO - Avg. fwd time: 22.7923 / Avg. bwd time: 41.4387 / Avg. batch time: 2074.6228 (ms) / GPU bubble ratio: 50.46%
[rank0]:2025-10-24 22:55:02,731 - INFO - Avg. fwd time: 19.3469 / Avg. bwd time: 31.6080 / Avg. batch time: 2129.1795 (ms) / GPU bubble ratio: 61.71%
[rank2]:2025-10-24 22:57:54,985 - INFO -  step: 220  loss: -4.0000  grad_norm:  0.4701  memory:  9.81GiB(20.65%)  tps: 1,875  tflops: 14.66  mfu: 4.70%
[rank3]:2025-10-24 22:57:54,998 - INFO -  step: 220  loss:  1.0695  grad_norm:  0.4701  memory: 26.71GiB(56.21%)  tps: 1,875  tflops: 14.66  mfu: 4.70%
[rank1]:2025-10-24 22:57:54,989 - INFO -  step: 220  loss: -4.0000  grad_norm:  0.4701  memory: 15.15GiB(31.88%)  tps: 1,875  tflops: 14.66  mfu: 4.70%
[rank0]:2025-10-24 22:57:55,001 - INFO -  step: 220  loss: -4.0000  grad_norm:  0.4701  memory: 17.51GiB(36.85%)  tps: 1,875  tflops: 14.66  mfu: 4.70%
[rank2]:2025-10-24 22:57:57,061 - INFO - Avg. fwd time: 17.4162 / Avg. bwd time: 28.5065 / Avg. batch time: 1969.3391 (ms) / GPU bubble ratio: 62.69%
[rank3]:2025-10-24 22:57:57,017 - INFO - Avg. fwd time: 33.5942 / Avg. bwd time: 71.0937 / Avg. batch time: 1896.0948 (ms) / GPU bubble ratio: 11.66%
[rank1]:2025-10-24 22:57:57,130 - INFO - Avg. fwd time: 22.8028 / Avg. bwd time: 41.4326 / Avg. batch time: 2074.7734 (ms) / GPU bubble ratio: 50.46%
[rank0]:2025-10-24 22:57:57,169 - INFO - Avg. fwd time: 19.3435 / Avg. bwd time: 31.6161 / Avg. batch time: 2129.3635 (ms) / GPU bubble ratio: 61.71%
[rank1]:2025-10-24 23:00:49,604 - INFO -  step: 240  loss: -4.0000  grad_norm:  0.4637  memory: 15.15GiB(31.88%)  tps: 1,877  tflops: 14.67  mfu: 4.70%
[rank2]:2025-10-24 23:00:49,599 - INFO -  step: 240  loss: -4.0000  grad_norm:  0.4637  memory:  9.81GiB(20.65%)  tps: 1,877  tflops: 14.67  mfu: 4.70%
[rank3]:2025-10-24 23:00:49,612 - INFO -  step: 240  loss:  1.0249  grad_norm:  0.4637  memory: 26.71GiB(56.21%)  tps: 1,877  tflops: 14.67  mfu: 4.70%
[rank0]:2025-10-24 23:00:49,615 - INFO -  step: 240  loss: -4.0000  grad_norm:  0.4637  memory: 17.51GiB(36.85%)  tps: 1,877  tflops: 14.67  mfu: 4.70%
[rank3]:2025-10-24 23:00:51,642 - INFO - Avg. fwd time: 33.6077 / Avg. bwd time: 71.1228 / Avg. batch time: 1896.6051 (ms) / GPU bubble ratio: 11.65%
[rank2]:2025-10-24 23:00:51,697 - INFO - Avg. fwd time: 17.4194 / Avg. bwd time: 28.5178 / Avg. batch time: 1969.6665 (ms) / GPU bubble ratio: 62.68%
[rank1]:2025-10-24 23:00:51,781 - INFO - Avg. fwd time: 22.8116 / Avg. bwd time: 41.4313 / Avg. batch time: 2075.1515 (ms) / GPU bubble ratio: 50.47%
[rank0]:2025-10-24 23:00:51,820 - INFO - Avg. fwd time: 19.3297 / Avg. bwd time: 31.6156 / Avg. batch time: 2129.7135 (ms) / GPU bubble ratio: 61.73%
[rank3]:2025-10-24 23:01:47,596 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-24 23:01:48,507 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-24 23:01:48,566 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 23:01:48,599 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 23:02:08,236 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-24 23:03:44,351 - INFO -  step: 260  loss: -4.0000  grad_norm:  0.4577  memory:  9.81GiB(20.65%)  tps: 1,875  tflops: 14.66  mfu: 4.70%
[rank1]:2025-10-24 23:03:44,360 - INFO -  step: 260  loss: -4.0000  grad_norm:  0.4577  memory: 15.15GiB(31.88%)  tps: 1,875  tflops: 14.66  mfu: 4.70%
[rank0]:2025-10-24 23:03:44,369 - INFO -  step: 260  loss: -4.0000  grad_norm:  0.4577  memory: 17.51GiB(36.85%)  tps: 1,875  tflops: 14.66  mfu: 4.70%
[rank3]:2025-10-24 23:03:44,363 - INFO -  step: 260  loss:  1.0392  grad_norm:  0.4577  memory: 26.71GiB(56.21%)  tps: 1,875  tflops: 14.66  mfu: 4.70%
[rank3]:2025-10-24 23:03:46,375 - INFO - Avg. fwd time: 33.6211 / Avg. bwd time: 71.1466 / Avg. batch time: 1897.0688 (ms) / GPU bubble ratio: 11.64%
[rank2]:2025-10-24 23:03:46,436 - INFO - Avg. fwd time: 17.4198 / Avg. bwd time: 28.5178 / Avg. batch time: 1970.0476 (ms) / GPU bubble ratio: 62.69%
[rank1]:2025-10-24 23:03:46,510 - INFO - Avg. fwd time: 22.8154 / Avg. bwd time: 41.4420 / Avg. batch time: 2075.5627 (ms) / GPU bubble ratio: 50.47%
[rank0]:2025-10-24 23:03:46,549 - INFO - Avg. fwd time: 19.3386 / Avg. bwd time: 31.6125 / Avg. batch time: 2130.1211 (ms) / GPU bubble ratio: 61.73%
[rank2]:2025-10-24 23:06:39,335 - INFO -  step: 280  loss: -4.0000  grad_norm:  0.4711  memory:  9.81GiB(20.65%)  tps: 1,873  tflops: 14.64  mfu: 4.69%
[rank0]:2025-10-24 23:06:39,352 - INFO -  step: 280  loss: -4.0000  grad_norm:  0.4711  memory: 17.51GiB(36.85%)  tps: 1,873  tflops: 14.64  mfu: 4.69%
[rank1]:2025-10-24 23:06:39,339 - INFO -  step: 280  loss: -4.0000  grad_norm:  0.4711  memory: 15.15GiB(31.88%)  tps: 1,873  tflops: 14.64  mfu: 4.69%
[rank3]:2025-10-24 23:06:39,347 - INFO -  step: 280  loss:  1.0353  grad_norm:  0.4711  memory: 26.71GiB(56.21%)  tps: 1,873  tflops: 14.64  mfu: 4.69%
[rank3]:2025-10-24 23:06:41,382 - INFO - Avg. fwd time: 33.6395 / Avg. bwd time: 71.1801 / Avg. batch time: 1897.8236 (ms) / GPU bubble ratio: 11.63%
[rank2]:2025-10-24 23:06:41,449 - INFO - Avg. fwd time: 17.4212 / Avg. bwd time: 28.5196 / Avg. batch time: 1970.6062 (ms) / GPU bubble ratio: 62.70%
[rank1]:2025-10-24 23:06:41,529 - INFO - Avg. fwd time: 22.8199 / Avg. bwd time: 41.4212 / Avg. batch time: 2076.1069 (ms) / GPU bubble ratio: 50.49%
[rank0]:2025-10-24 23:06:41,567 - INFO - Avg. fwd time: 19.3348 / Avg. bwd time: 31.6257 / Avg. batch time: 2130.6704 (ms) / GPU bubble ratio: 61.73%
[rank0]:2025-10-24 23:09:25,242 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-24 23:09:33,942 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.4626  memory:  9.81GiB(20.65%)  tps: 1,877  tflops: 14.67  mfu: 4.70%
[rank1]:2025-10-24 23:09:33,945 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.4626  memory: 15.15GiB(31.88%)  tps: 1,877  tflops: 14.67  mfu: 4.70%
[rank0]:2025-10-24 23:09:33,959 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.4626  memory: 17.51GiB(36.85%)  tps: 1,877  tflops: 14.67  mfu: 4.70%
[rank3]:2025-10-24 23:09:33,954 - INFO -  step: 300  loss:  1.0063  grad_norm:  0.4626  memory: 26.71GiB(56.21%)  tps: 1,877  tflops: 14.67  mfu: 4.70%
[rank3]:2025-10-24 23:09:34,321 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_nofreeze_dm1/pipeline_schedule/251024_2309_real_step300_rank3.svg
[rank3]:> Batch Time: 1915.00 ms, GPU Bubble Ratio: 57.30%, 46.24%, 61.90%, 12.24%
[rank3]:2025-10-24 23:09:36,244 - INFO - Avg. fwd time: 33.6405 / Avg. bwd time: 71.1917 / Avg. batch time: 1897.9398 (ms) / GPU bubble ratio: 11.62%
[rank2]:2025-10-24 23:09:36,290 - INFO - Avg. fwd time: 17.4207 / Avg. bwd time: 28.5205 / Avg. batch time: 1970.9239 (ms) / GPU bubble ratio: 62.70%
[rank1]:2025-10-24 23:09:36,364 - INFO - Avg. fwd time: 22.8297 / Avg. bwd time: 41.4405 / Avg. batch time: 2076.4435 (ms) / GPU bubble ratio: 50.48%
[rank0]:2025-10-24 23:09:36,404 - INFO - Avg. fwd time: 19.3313 / Avg. bwd time: 31.6279 / Avg. batch time: 2130.9978 (ms) / GPU bubble ratio: 61.74%
[rank0]:2025-10-24 23:12:28,326 - INFO -  step: 320  loss: -4.0000  grad_norm:  0.5119  memory: 17.51GiB(36.85%)  tps: 1,879  tflops: 14.69  mfu: 4.71%
[rank1]:2025-10-24 23:12:28,316 - INFO -  step: 320  loss: -4.0000  grad_norm:  0.5119  memory: 15.15GiB(31.88%)  tps: 1,879  tflops: 14.69  mfu: 4.71%
[rank3]:2025-10-24 23:12:28,324 - INFO -  step: 320  loss:  1.0288  grad_norm:  0.5119  memory: 26.71GiB(56.21%)  tps: 1,879  tflops: 14.69  mfu: 4.71%
[rank2]:2025-10-24 23:12:28,312 - INFO -  step: 320  loss: -4.0000  grad_norm:  0.5119  memory:  9.81GiB(20.65%)  tps: 1,879  tflops: 14.69  mfu: 4.71%
[rank3]:2025-10-24 23:12:30,324 - INFO - Avg. fwd time: 33.6384 / Avg. bwd time: 71.1916 / Avg. batch time: 1897.7815 (ms) / GPU bubble ratio: 11.62%
[rank2]:2025-10-24 23:12:30,372 - INFO - Avg. fwd time: 17.4184 / Avg. bwd time: 28.5192 / Avg. batch time: 1970.6591 (ms) / GPU bubble ratio: 62.70%
[rank0]:2025-10-24 23:12:30,483 - INFO - Avg. fwd time: 19.3323 / Avg. bwd time: 31.6264 / Avg. batch time: 2130.6979 (ms) / GPU bubble ratio: 61.73%
[rank1]:2025-10-24 23:12:30,444 - INFO - Avg. fwd time: 22.8294 / Avg. bwd time: 41.4302 / Avg. batch time: 2076.1531 (ms) / GPU bubble ratio: 50.48%
[rank3]:2025-10-24 23:13:47,932 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-24 23:13:48,842 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 23:13:48,933 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-24 23:13:48,898 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-24 23:15:22,714 - INFO -  step: 340  loss: -4.0000  grad_norm:  0.5066  memory:  9.81GiB(20.65%)  tps: 1,879  tflops: 14.69  mfu: 4.71%
[rank0]:2025-10-24 23:15:22,732 - INFO -  step: 340  loss: -4.0000  grad_norm:  0.5066  memory: 17.51GiB(36.85%)  tps: 1,879  tflops: 14.69  mfu: 4.71%
[rank1]:2025-10-24 23:15:22,718 - INFO -  step: 340  loss: -4.0000  grad_norm:  0.5066  memory: 15.15GiB(31.88%)  tps: 1,879  tflops: 14.69  mfu: 4.71%
[rank3]:2025-10-24 23:15:22,726 - INFO -  step: 340  loss:  0.9792  grad_norm:  0.5066  memory: 26.71GiB(56.21%)  tps: 1,879  tflops: 14.69  mfu: 4.71%
[rank3]:2025-10-24 23:15:24,755 - INFO - Avg. fwd time: 33.6441 / Avg. bwd time: 71.2004 / Avg. batch time: 1897.9368 (ms) / GPU bubble ratio: 11.61%
[rank2]:2025-10-24 23:15:24,807 - INFO - Avg. fwd time: 17.4183 / Avg. bwd time: 28.5215 / Avg. batch time: 1970.7143 (ms) / GPU bubble ratio: 62.70%
[rank0]:2025-10-24 23:15:24,932 - INFO - Avg. fwd time: 19.3490 / Avg. bwd time: 31.6288 / Avg. batch time: 2130.7507 (ms) / GPU bubble ratio: 61.72%
[rank1]:2025-10-24 23:15:24,885 - INFO - Avg. fwd time: 22.8296 / Avg. bwd time: 41.4301 / Avg. batch time: 2076.2272 (ms) / GPU bubble ratio: 50.48%
[rank0]:2025-10-24 23:16:41,345 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-24 23:18:17,370 - INFO -  step: 360  loss: -4.0000  grad_norm:  0.4933  memory: 15.15GiB(31.88%)  tps: 1,876  tflops: 14.67  mfu: 4.70%
[rank3]:2025-10-24 23:18:17,378 - INFO -  step: 360  loss:  1.0058  grad_norm:  0.4933  memory: 26.71GiB(56.21%)  tps: 1,876  tflops: 14.67  mfu: 4.70%
[rank2]:2025-10-24 23:18:17,366 - INFO -  step: 360  loss: -4.0000  grad_norm:  0.4933  memory:  9.81GiB(20.65%)  tps: 1,876  tflops: 14.67  mfu: 4.70%
[rank0]:2025-10-24 23:18:17,385 - INFO -  step: 360  loss: -4.0000  grad_norm:  0.4933  memory: 17.51GiB(36.85%)  tps: 1,876  tflops: 14.67  mfu: 4.70%
[rank3]:2025-10-24 23:18:19,402 - INFO - Avg. fwd time: 33.6511 / Avg. bwd time: 71.2093 / Avg. batch time: 1898.1428 (ms) / GPU bubble ratio: 11.61%
[rank2]:2025-10-24 23:18:19,448 - INFO - Avg. fwd time: 17.4175 / Avg. bwd time: 28.5191 / Avg. batch time: 1970.8312 (ms) / GPU bubble ratio: 62.71%
[rank0]:2025-10-24 23:18:19,562 - INFO - Avg. fwd time: 19.3531 / Avg. bwd time: 31.6332 / Avg. batch time: 2130.8661 (ms) / GPU bubble ratio: 61.72%
[rank1]:2025-10-24 23:18:19,522 - INFO - Avg. fwd time: 22.8315 / Avg. bwd time: 41.4279 / Avg. batch time: 2076.3506 (ms) / GPU bubble ratio: 50.48%
[rank0]:2025-10-24 23:21:11,818 - INFO -  step: 380  loss: -4.0000  grad_norm:  0.4617  memory: 17.51GiB(36.85%)  tps: 1,879  tflops: 14.69  mfu: 4.71%
[rank1]:2025-10-24 23:21:11,811 - INFO -  step: 380  loss: -4.0000  grad_norm:  0.4617  memory: 15.15GiB(31.88%)  tps: 1,878  tflops: 14.68  mfu: 4.71%
[rank3]:2025-10-24 23:21:11,811 - INFO -  step: 380  loss:  0.9420  grad_norm:  0.4617  memory: 26.71GiB(56.21%)  tps: 1,879  tflops: 14.69  mfu: 4.71%
[rank2]:2025-10-24 23:21:11,799 - INFO -  step: 380  loss: -4.0000  grad_norm:  0.4617  memory:  9.81GiB(20.65%)  tps: 1,879  tflops: 14.69  mfu: 4.71%
[rank3]:2025-10-24 23:21:13,819 - INFO - Avg. fwd time: 33.6553 / Avg. bwd time: 71.2154 / Avg. batch time: 1898.2414 (ms) / GPU bubble ratio: 11.61%
[rank2]:2025-10-24 23:21:13,863 - INFO - Avg. fwd time: 17.4177 / Avg. bwd time: 28.5206 / Avg. batch time: 1970.8459 (ms) / GPU bubble ratio: 62.71%
[rank1]:2025-10-24 23:21:13,928 - INFO - Avg. fwd time: 22.8320 / Avg. bwd time: 41.4214 / Avg. batch time: 2076.3491 (ms) / GPU bubble ratio: 50.49%
[rank0]:2025-10-24 23:21:13,968 - INFO - Avg. fwd time: 19.3574 / Avg. bwd time: 31.6344 / Avg. batch time: 2130.8331 (ms) / GPU bubble ratio: 61.71%
[rank0]:2025-10-24 23:23:57,380 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-24 23:24:06,160 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.4741  memory: 15.15GiB(31.88%)  tps: 1,879  tflops: 14.69  mfu: 4.71%
[rank3]:2025-10-24 23:24:06,167 - INFO -  step: 400  loss:  0.9288  grad_norm:  0.4741  memory: 26.71GiB(56.21%)  tps: 1,879  tflops: 14.69  mfu: 4.71%
[rank2]:2025-10-24 23:24:06,155 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.4741  memory:  9.81GiB(20.65%)  tps: 1,879  tflops: 14.69  mfu: 4.71%
[rank0]:2025-10-24 23:24:06,174 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.4741  memory: 17.51GiB(36.85%)  tps: 1,879  tflops: 14.69  mfu: 4.71%
[rank3]:2025-10-24 23:24:06,539 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_nofreeze_dm1/pipeline_schedule/251024_2324_real_step400_rank3.svg
[rank3]:> Batch Time: 1914.45 ms, GPU Bubble Ratio: 57.29%, 46.21%, 61.89%, 12.23%
[rank3]:2025-10-24 23:24:08,469 - INFO - Avg. fwd time: 33.6560 / Avg. bwd time: 71.2160 / Avg. batch time: 1898.1950 (ms) / GPU bubble ratio: 11.60%
[rank2]:2025-10-24 23:24:08,523 - INFO - Avg. fwd time: 17.4172 / Avg. bwd time: 28.5221 / Avg. batch time: 1970.9690 (ms) / GPU bubble ratio: 62.71%
[rank0]:2025-10-24 23:24:08,649 - INFO - Avg. fwd time: 19.3523 / Avg. bwd time: 31.6271 / Avg. batch time: 2130.9639 (ms) / GPU bubble ratio: 61.72%
[rank1]:2025-10-24 23:24:08,603 - INFO - Avg. fwd time: 22.8377 / Avg. bwd time: 41.4304 / Avg. batch time: 2076.4911 (ms) / GPU bubble ratio: 50.48%
[rank3]:2025-10-24 23:25:45,785 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-24 23:25:46,681 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 23:25:46,773 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-24 23:25:46,737 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-24 23:27:00,683 - INFO -  step: 420  loss: -4.0000  grad_norm:  0.4437  memory: 15.15GiB(31.88%)  tps: 1,878  tflops: 14.68  mfu: 4.70%
[rank3]:2025-10-24 23:27:00,691 - INFO -  step: 420  loss:  0.8979  grad_norm:  0.4437  memory: 26.71GiB(56.21%)  tps: 1,878  tflops: 14.68  mfu: 4.70%
[rank2]:2025-10-24 23:27:00,679 - INFO -  step: 420  loss: -4.0000  grad_norm:  0.4437  memory:  9.81GiB(20.65%)  tps: 1,878  tflops: 14.68  mfu: 4.70%
[rank0]:2025-10-24 23:27:00,696 - INFO -  step: 420  loss: -4.0000  grad_norm:  0.4437  memory: 17.51GiB(36.85%)  tps: 1,878  tflops: 14.68  mfu: 4.70%
[rank3]:2025-10-24 23:27:02,714 - INFO - Avg. fwd time: 33.6588 / Avg. bwd time: 71.2131 / Avg. batch time: 1898.1204 (ms) / GPU bubble ratio: 11.60%
[rank2]:2025-10-24 23:27:02,770 - INFO - Avg. fwd time: 17.4188 / Avg. bwd time: 28.5258 / Avg. batch time: 1970.8320 (ms) / GPU bubble ratio: 62.70%
[rank0]:2025-10-24 23:27:02,897 - INFO - Avg. fwd time: 19.3478 / Avg. bwd time: 31.6300 / Avg. batch time: 2130.8184 (ms) / GPU bubble ratio: 61.72%
[rank1]:2025-10-24 23:27:02,850 - INFO - Avg. fwd time: 22.8380 / Avg. bwd time: 41.4226 / Avg. batch time: 2076.3436 (ms) / GPU bubble ratio: 50.48%
[rank0]:2025-10-24 23:29:54,520 - INFO -  step: 440  loss: -4.0000  grad_norm:  0.4694  memory: 17.51GiB(36.85%)  tps: 1,885  tflops: 14.74  mfu: 4.72%
[rank2]:2025-10-24 23:29:54,503 - INFO -  step: 440  loss: -4.0000  grad_norm:  0.4694  memory:  9.81GiB(20.65%)  tps: 1,885  tflops: 14.74  mfu: 4.72%
[rank3]:2025-10-24 23:29:54,515 - INFO -  step: 440  loss:  0.9151  grad_norm:  0.4694  memory: 26.71GiB(56.21%)  tps: 1,885  tflops: 14.74  mfu: 4.72%
[rank1]:2025-10-24 23:29:54,506 - INFO -  step: 440  loss: -4.0000  grad_norm:  0.4694  memory: 15.15GiB(31.88%)  tps: 1,885  tflops: 14.74  mfu: 4.72%
[rank3]:2025-10-24 23:29:56,538 - INFO - Avg. fwd time: 33.6542 / Avg. bwd time: 71.2006 / Avg. batch time: 1897.7933 (ms) / GPU bubble ratio: 11.60%
[rank2]:2025-10-24 23:29:56,595 - INFO - Avg. fwd time: 17.4171 / Avg. bwd time: 28.5236 / Avg. batch time: 1970.4954 (ms) / GPU bubble ratio: 62.70%
[rank1]:2025-10-24 23:29:56,676 - INFO - Avg. fwd time: 22.8428 / Avg. bwd time: 41.4153 / Avg. batch time: 2075.9953 (ms) / GPU bubble ratio: 50.48%
[rank0]:2025-10-24 23:29:56,721 - INFO - Avg. fwd time: 19.3389 / Avg. bwd time: 31.6288 / Avg. batch time: 2130.4754 (ms) / GPU bubble ratio: 61.72%
[rank0]:2025-10-24 23:31:13,006 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-24 23:32:49,049 - INFO -  step: 460  loss: -4.0000  grad_norm:  0.5256  memory: 17.51GiB(36.85%)  tps: 1,878  tflops: 14.68  mfu: 4.70%
[rank2]:2025-10-24 23:32:49,032 - INFO -  step: 460  loss: -4.0000  grad_norm:  0.5256  memory:  9.81GiB(20.65%)  tps: 1,878  tflops: 14.68  mfu: 4.70%
[rank3]:2025-10-24 23:32:49,044 - INFO -  step: 460  loss:  0.9708  grad_norm:  0.5256  memory: 26.71GiB(56.21%)  tps: 1,878  tflops: 14.68  mfu: 4.70%
[rank1]:2025-10-24 23:32:49,036 - INFO -  step: 460  loss: -4.0000  grad_norm:  0.5256  memory: 15.15GiB(31.88%)  tps: 1,878  tflops: 14.68  mfu: 4.70%
[rank3]:2025-10-24 23:32:51,072 - INFO - Avg. fwd time: 33.6568 / Avg. bwd time: 71.2065 / Avg. batch time: 1897.8863 (ms) / GPU bubble ratio: 11.60%
[rank2]:2025-10-24 23:32:51,123 - INFO - Avg. fwd time: 17.4171 / Avg. bwd time: 28.5268 / Avg. batch time: 1970.5252 (ms) / GPU bubble ratio: 62.70%
[rank1]:2025-10-24 23:32:51,200 - INFO - Avg. fwd time: 22.8450 / Avg. bwd time: 41.4059 / Avg. batch time: 2076.0182 (ms) / GPU bubble ratio: 50.48%
[rank0]:2025-10-24 23:32:51,241 - INFO - Avg. fwd time: 19.3399 / Avg. bwd time: 31.6309 / Avg. batch time: 2130.4752 (ms) / GPU bubble ratio: 61.72%
[rank0]:2025-10-24 23:35:42,861 - INFO -  step: 480  loss: -4.0000  grad_norm:  0.5059  memory: 17.51GiB(36.85%)  tps: 1,885  tflops: 14.74  mfu: 4.72%
[rank2]:2025-10-24 23:35:42,844 - INFO -  step: 480  loss: -4.0000  grad_norm:  0.5059  memory:  9.81GiB(20.65%)  tps: 1,885  tflops: 14.74  mfu: 4.72%
[rank3]:2025-10-24 23:35:42,856 - INFO -  step: 480  loss:  0.9336  grad_norm:  0.5059  memory: 26.71GiB(56.21%)  tps: 1,885  tflops: 14.74  mfu: 4.72%
[rank1]:2025-10-24 23:35:42,848 - INFO -  step: 480  loss: -4.0000  grad_norm:  0.5059  memory: 15.15GiB(31.88%)  tps: 1,885  tflops: 14.74  mfu: 4.72%
[rank3]:2025-10-24 23:35:44,872 - INFO - Avg. fwd time: 33.6537 / Avg. bwd time: 71.1979 / Avg. batch time: 1897.6347 (ms) / GPU bubble ratio: 11.59%
[rank2]:2025-10-24 23:35:44,927 - INFO - Avg. fwd time: 17.4165 / Avg. bwd time: 28.5208 / Avg. batch time: 1970.1992 (ms) / GPU bubble ratio: 62.69%
[rank1]:2025-10-24 23:35:44,999 - INFO - Avg. fwd time: 22.8438 / Avg. bwd time: 41.3922 / Avg. batch time: 2075.6611 (ms) / GPU bubble ratio: 50.48%
[rank0]:2025-10-24 23:35:45,041 - INFO - Avg. fwd time: 19.3391 / Avg. bwd time: 31.6268 / Avg. batch time: 2130.1340 (ms) / GPU bubble ratio: 61.72%
[rank3]:2025-10-24 23:37:41,097 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-24 23:37:42,000 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-24 23:37:42,056 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 23:37:42,096 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 23:38:27,789 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-24 23:38:36,556 - INFO -  step: 500  loss:  0.8732  grad_norm:  0.4575  memory: 26.71GiB(56.21%)  tps: 1,886  tflops: 14.75  mfu: 4.73%
[rank3]:2025-10-24 23:38:36,557 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-24 23:38:36,548 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.4575  memory: 15.15GiB(31.88%)  tps: 1,886  tflops: 14.75  mfu: 4.73%
[rank1]:2025-10-24 23:38:36,548 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-24 23:38:36,561 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.4575  memory: 17.51GiB(36.85%)  tps: 1,886  tflops: 14.75  mfu: 4.73%
[rank0]:2025-10-24 23:38:36,562 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-24 23:38:36,562 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank2]:2025-10-24 23:38:36,544 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.4575  memory:  9.81GiB(20.65%)  tps: 1,886  tflops: 14.75  mfu: 4.73%
[rank2]:2025-10-24 23:38:36,545 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-24 23:38:38,387 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 1.84 seconds.
[rank1]:2025-10-24 23:38:38,855 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 2.31 seconds.
[rank3]:2025-10-24 23:38:40,449 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.89 seconds.
[rank0]:2025-10-24 23:38:41,207 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-24 23:38:41,215 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 4.65 seconds.
[rank3]:2025-10-24 23:38:41,742 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_nofreeze_dm1/pipeline_schedule/251024_2338_real_step500_rank3.svg
[rank3]:> Batch Time: 1911.83 ms, GPU Bubble Ratio: 57.26%, 46.19%, 61.85%, 12.23%
[rank2]:2025-10-24 23:38:43,932 - INFO - Avg. fwd time: 17.4141 / Avg. bwd time: 28.5140 / Avg. batch time: 1970.1707 (ms) / GPU bubble ratio: 62.70%
[rank3]:2025-10-24 23:38:43,886 - INFO - Avg. fwd time: 33.6499 / Avg. bwd time: 71.1920 / Avg. batch time: 1897.4408 (ms) / GPU bubble ratio: 11.59%
[rank1]:2025-10-24 23:38:44,011 - INFO - Avg. fwd time: 22.8450 / Avg. bwd time: 41.3899 / Avg. batch time: 2075.6385 (ms) / GPU bubble ratio: 50.48%
[rank0]:2025-10-24 23:38:44,053 - INFO - Avg. fwd time: 19.3371 / Avg. bwd time: 31.6201 / Avg. batch time: 2130.1099 (ms) / GPU bubble ratio: 61.72%
[rank3]:2025-10-24 23:41:36,191 - INFO -  step: 520  loss:  0.8943  grad_norm:  0.4982  memory: 26.71GiB(56.21%)  tps: 1,824  tflops: 14.26  mfu: 4.57%
[rank0]:2025-10-24 23:41:36,204 - INFO -  step: 520  loss: -4.0000  grad_norm:  0.4982  memory: 17.51GiB(36.85%)  tps: 1,824  tflops: 14.26  mfu: 4.57%
[rank1]:2025-10-24 23:41:36,182 - INFO -  step: 520  loss: -4.0000  grad_norm:  0.4982  memory: 15.15GiB(31.88%)  tps: 1,824  tflops: 14.26  mfu: 4.57%
[rank2]:2025-10-24 23:41:36,178 - INFO -  step: 520  loss: -4.0000  grad_norm:  0.4982  memory:  9.81GiB(20.65%)  tps: 1,824  tflops: 14.26  mfu: 4.57%
[rank3]:2025-10-24 23:41:38,218 - INFO - Avg. fwd time: 33.6522 / Avg. bwd time: 71.1933 / Avg. batch time: 1897.4641 (ms) / GPU bubble ratio: 11.59%
[rank2]:2025-10-24 23:41:38,282 - INFO - Avg. fwd time: 17.4135 / Avg. bwd time: 28.5158 / Avg. batch time: 1970.1340 (ms) / GPU bubble ratio: 62.70%
[rank0]:2025-10-24 23:41:38,407 - INFO - Avg. fwd time: 19.3389 / Avg. bwd time: 31.6234 / Avg. batch time: 2130.0627 (ms) / GPU bubble ratio: 61.72%
[rank1]:2025-10-24 23:41:38,365 - INFO - Avg. fwd time: 22.8456 / Avg. bwd time: 41.3860 / Avg. batch time: 2075.6047 (ms) / GPU bubble ratio: 50.49%
[rank2]:2025-10-24 23:44:30,489 - INFO -  step: 540  loss: -4.0000  grad_norm:  0.5257  memory:  9.81GiB(20.65%)  tps: 1,880  tflops: 14.70  mfu: 4.71%
[rank3]:2025-10-24 23:44:30,501 - INFO -  step: 540  loss:  0.8778  grad_norm:  0.5257  memory: 26.71GiB(56.21%)  tps: 1,880  tflops: 14.70  mfu: 4.71%
[rank0]:2025-10-24 23:44:30,504 - INFO -  step: 540  loss: -4.0000  grad_norm:  0.5257  memory: 17.51GiB(36.85%)  tps: 1,880  tflops: 14.70  mfu: 4.71%
[rank1]:2025-10-24 23:44:30,493 - INFO -  step: 540  loss: -4.0000  grad_norm:  0.5257  memory: 15.15GiB(31.88%)  tps: 1,880  tflops: 14.70  mfu: 4.71%
[rank3]:2025-10-24 23:44:32,526 - INFO - Avg. fwd time: 33.6540 / Avg. bwd time: 71.1946 / Avg. batch time: 1897.4724 (ms) / GPU bubble ratio: 11.59%
[rank2]:2025-10-24 23:44:32,585 - INFO - Avg. fwd time: 17.4140 / Avg. bwd time: 28.5189 / Avg. batch time: 1970.1064 (ms) / GPU bubble ratio: 62.70%
[rank1]:2025-10-24 23:44:32,665 - INFO - Avg. fwd time: 22.8463 / Avg. bwd time: 41.3755 / Avg. batch time: 2075.5424 (ms) / GPU bubble ratio: 50.49%
[rank0]:2025-10-24 23:44:32,707 - INFO - Avg. fwd time: 19.3372 / Avg. bwd time: 31.6229 / Avg. batch time: 2129.9980 (ms) / GPU bubble ratio: 61.72%
[rank0]:2025-10-24 23:45:49,058 - INFO - [GC] Peforming periodical GC collection 0.27 seconds
[rank2]:2025-10-24 23:47:24,942 - INFO -  step: 560  loss: -4.0000  grad_norm:  0.5528  memory:  9.81GiB(20.65%)  tps: 1,878  tflops: 14.68  mfu: 4.71%
[rank3]:2025-10-24 23:47:24,954 - INFO -  step: 560  loss:  0.8862  grad_norm:  0.5528  memory: 26.71GiB(56.21%)  tps: 1,878  tflops: 14.68  mfu: 4.71%
[rank0]:2025-10-24 23:47:24,959 - INFO -  step: 560  loss: -4.0000  grad_norm:  0.5528  memory: 17.51GiB(36.85%)  tps: 1,878  tflops: 14.68  mfu: 4.71%
[rank1]:2025-10-24 23:47:24,945 - INFO -  step: 560  loss: -4.0000  grad_norm:  0.5528  memory: 15.15GiB(31.88%)  tps: 1,878  tflops: 14.68  mfu: 4.71%
[rank2]:2025-10-24 23:47:27,028 - INFO - Avg. fwd time: 17.4142 / Avg. bwd time: 28.5169 / Avg. batch time: 1970.0079 (ms) / GPU bubble ratio: 62.70%
[rank3]:2025-10-24 23:47:26,981 - INFO - Avg. fwd time: 33.6549 / Avg. bwd time: 71.1934 / Avg. batch time: 1897.4261 (ms) / GPU bubble ratio: 11.59%
[rank1]:2025-10-24 23:47:27,101 - INFO - Avg. fwd time: 22.8455 / Avg. bwd time: 41.3635 / Avg. batch time: 2075.4191 (ms) / GPU bubble ratio: 50.50%
[rank0]:2025-10-24 23:47:27,143 - INFO - Avg. fwd time: 19.3346 / Avg. bwd time: 31.6201 / Avg. batch time: 2129.8712 (ms) / GPU bubble ratio: 61.72%
[rank3]:2025-10-24 23:49:43,628 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-24 23:49:44,489 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-24 23:49:44,545 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 23:49:44,582 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-24 23:50:19,479 - INFO -  step: 580  loss: -4.0000  grad_norm:  0.5608  memory:  9.81GiB(20.65%)  tps: 1,877  tflops: 14.68  mfu: 4.70%
[rank3]:2025-10-24 23:50:19,491 - INFO -  step: 580  loss:  0.8253  grad_norm:  0.5608  memory: 26.71GiB(56.21%)  tps: 1,877  tflops: 14.68  mfu: 4.70%
[rank1]:2025-10-24 23:50:19,483 - INFO -  step: 580  loss: -4.0000  grad_norm:  0.5608  memory: 15.15GiB(31.88%)  tps: 1,877  tflops: 14.68  mfu: 4.70%
[rank0]:2025-10-24 23:50:19,498 - INFO -  step: 580  loss: -4.0000  grad_norm:  0.5608  memory: 17.51GiB(36.85%)  tps: 1,877  tflops: 14.68  mfu: 4.70%
[rank2]:2025-10-24 23:50:21,584 - INFO - Avg. fwd time: 17.4154 / Avg. bwd time: 28.5220 / Avg. batch time: 1970.0832 (ms) / GPU bubble ratio: 62.69%
[rank3]:2025-10-24 23:50:21,534 - INFO - Avg. fwd time: 33.6587 / Avg. bwd time: 71.1976 / Avg. batch time: 1897.5329 (ms) / GPU bubble ratio: 11.59%
[rank1]:2025-10-24 23:50:21,666 - INFO - Avg. fwd time: 22.8494 / Avg. bwd time: 41.3608 / Avg. batch time: 2075.5002 (ms) / GPU bubble ratio: 50.50%
[rank0]:2025-10-24 23:50:21,708 - INFO - Avg. fwd time: 19.3350 / Avg. bwd time: 31.6235 / Avg. batch time: 2129.9465 (ms) / GPU bubble ratio: 61.72%
[rank0]:2025-10-24 23:53:05,026 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-24 23:53:13,740 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.5319  memory: 15.15GiB(31.88%)  tps: 1,880  tflops: 14.70  mfu: 4.71%
[rank3]:2025-10-24 23:53:13,743 - INFO -  step: 600  loss:  0.8413  grad_norm:  0.5319  memory: 26.71GiB(56.21%)  tps: 1,881  tflops: 14.70  mfu: 4.71%
[rank2]:2025-10-24 23:53:13,731 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.5319  memory:  9.81GiB(20.65%)  tps: 1,881  tflops: 14.70  mfu: 4.71%
[rank0]:2025-10-24 23:53:13,746 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.5319  memory: 17.51GiB(36.85%)  tps: 1,881  tflops: 14.70  mfu: 4.71%
[rank3]:2025-10-24 23:53:14,108 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_nofreeze_dm1/pipeline_schedule/251024_2353_real_step600_rank3.svg
[rank3]:> Batch Time: 1911.45 ms, GPU Bubble Ratio: 57.25%, 46.23%, 61.84%, 12.22%
[rank3]:2025-10-24 23:53:16,037 - INFO - Avg. fwd time: 33.6597 / Avg. bwd time: 71.1966 / Avg. batch time: 1897.5036 (ms) / GPU bubble ratio: 11.58%
[rank2]:2025-10-24 23:53:16,092 - INFO - Avg. fwd time: 17.4148 / Avg. bwd time: 28.5201 / Avg. batch time: 1970.1185 (ms) / GPU bubble ratio: 62.69%
[rank0]:2025-10-24 23:53:16,214 - INFO - Avg. fwd time: 19.3342 / Avg. bwd time: 31.6234 / Avg. batch time: 2129.9899 (ms) / GPU bubble ratio: 61.72%
[rank1]:2025-10-24 23:53:16,171 - INFO - Avg. fwd time: 22.8479 / Avg. bwd time: 41.3466 / Avg. batch time: 2075.5460 (ms) / GPU bubble ratio: 50.51%
[rank2]:2025-10-24 23:56:08,402 - INFO -  step: 620  loss: -4.0000  grad_norm:  0.5298  memory:  9.81GiB(20.65%)  tps: 1,876  tflops: 14.67  mfu: 4.70%
[rank3]:2025-10-24 23:56:08,414 - INFO -  step: 620  loss:  0.8454  grad_norm:  0.5298  memory: 26.71GiB(56.21%)  tps: 1,876  tflops: 14.67  mfu: 4.70%
[rank0]:2025-10-24 23:56:08,418 - INFO -  step: 620  loss: -4.0000  grad_norm:  0.5298  memory: 17.51GiB(36.85%)  tps: 1,876  tflops: 14.67  mfu: 4.70%
[rank1]:2025-10-24 23:56:08,409 - INFO -  step: 620  loss: -4.0000  grad_norm:  0.5298  memory: 15.15GiB(31.88%)  tps: 1,876  tflops: 14.67  mfu: 4.70%
[rank3]:2025-10-24 23:56:10,444 - INFO - Avg. fwd time: 33.6615 / Avg. bwd time: 71.1990 / Avg. batch time: 1897.5378 (ms) / GPU bubble ratio: 11.58%
[rank2]:2025-10-24 23:56:10,488 - INFO - Avg. fwd time: 17.4154 / Avg. bwd time: 28.5221 / Avg. batch time: 1970.1047 (ms) / GPU bubble ratio: 62.69%
[rank1]:2025-10-24 23:56:10,550 - INFO - Avg. fwd time: 22.8465 / Avg. bwd time: 41.3369 / Avg. batch time: 2075.5349 (ms) / GPU bubble ratio: 50.52%
[rank0]:2025-10-24 23:56:10,594 - INFO - Avg. fwd time: 19.3324 / Avg. bwd time: 31.6252 / Avg. batch time: 2129.9833 (ms) / GPU bubble ratio: 61.72%
[rank2]:2025-10-24 23:59:02,769 - INFO -  step: 640  loss: -4.0000  grad_norm:  0.5637  memory:  9.81GiB(20.65%)  tps: 1,879  tflops: 14.69  mfu: 4.71%
[rank0]:2025-10-24 23:59:02,794 - INFO -  step: 640  loss: -4.0000  grad_norm:  0.5637  memory: 17.51GiB(36.85%)  tps: 1,879  tflops: 14.69  mfu: 4.71%
[rank3]:2025-10-24 23:59:02,781 - INFO -  step: 640  loss:  0.8124  grad_norm:  0.5637  memory: 26.71GiB(56.21%)  tps: 1,879  tflops: 14.69  mfu: 4.71%
[rank1]:2025-10-24 23:59:02,773 - INFO -  step: 640  loss: -4.0000  grad_norm:  0.5637  memory: 15.15GiB(31.88%)  tps: 1,879  tflops: 14.69  mfu: 4.71%
[rank2]:2025-10-24 23:59:04,878 - INFO - Avg. fwd time: 17.4155 / Avg. bwd time: 28.5208 / Avg. batch time: 1970.1075 (ms) / GPU bubble ratio: 62.69%
[rank3]:2025-10-24 23:59:04,820 - INFO - Avg. fwd time: 33.6646 / Avg. bwd time: 71.2006 / Avg. batch time: 1897.5895 (ms) / GPU bubble ratio: 11.58%
[rank1]:2025-10-24 23:59:04,960 - INFO - Avg. fwd time: 22.8488 / Avg. bwd time: 41.3236 / Avg. batch time: 2075.5354 (ms) / GPU bubble ratio: 50.53%
[rank0]:2025-10-24 23:59:05,003 - INFO - Avg. fwd time: 19.3273 / Avg. bwd time: 31.6237 / Avg. batch time: 2129.9825 (ms) / GPU bubble ratio: 61.73%
[rank0]:2025-10-25 00:00:20,995 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-25 00:01:42,573 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 00:01:43,475 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 00:01:43,531 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 00:01:43,571 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 00:01:56,593 - INFO -  step: 660  loss: -4.0000  grad_norm:  0.5424  memory:  9.81GiB(20.65%)  tps: 1,885  tflops: 14.74  mfu: 4.72%
[rank3]:2025-10-25 00:01:56,606 - INFO -  step: 660  loss:  0.7882  grad_norm:  0.5424  memory: 26.71GiB(56.21%)  tps: 1,885  tflops: 14.74  mfu: 4.72%
[rank0]:2025-10-25 00:01:56,612 - INFO -  step: 660  loss: -4.0000  grad_norm:  0.5424  memory: 17.51GiB(36.85%)  tps: 1,885  tflops: 14.74  mfu: 4.72%
[rank1]:2025-10-25 00:01:56,597 - INFO -  step: 660  loss: -4.0000  grad_norm:  0.5424  memory: 15.15GiB(31.88%)  tps: 1,885  tflops: 14.74  mfu: 4.72%
[rank2]:2025-10-25 00:01:58,703 - INFO - Avg. fwd time: 17.4148 / Avg. bwd time: 28.5188 / Avg. batch time: 1969.8774 (ms) / GPU bubble ratio: 62.69%
[rank3]:2025-10-25 00:01:58,640 - INFO - Avg. fwd time: 33.6625 / Avg. bwd time: 71.1940 / Avg. batch time: 1897.4048 (ms) / GPU bubble ratio: 11.58%
[rank0]:2025-10-25 00:01:58,835 - INFO - Avg. fwd time: 19.3253 / Avg. bwd time: 31.6226 / Avg. batch time: 2129.7641 (ms) / GPU bubble ratio: 61.73%
[rank1]:2025-10-25 00:01:58,786 - INFO - Avg. fwd time: 22.8487 / Avg. bwd time: 41.3136 / Avg. batch time: 2075.3143 (ms) / GPU bubble ratio: 50.53%
[rank1]:2025-10-25 00:04:50,775 - INFO -  step: 680  loss: -4.0000  grad_norm:  0.6076  memory: 15.15GiB(31.88%)  tps: 1,881  tflops: 14.71  mfu: 4.71%
[rank2]:2025-10-25 00:04:50,772 - INFO -  step: 680  loss: -4.0000  grad_norm:  0.6076  memory:  9.81GiB(20.65%)  tps: 1,881  tflops: 14.71  mfu: 4.71%
[rank3]:2025-10-25 00:04:50,784 - INFO -  step: 680  loss:  0.7890  grad_norm:  0.6076  memory: 26.71GiB(56.21%)  tps: 1,881  tflops: 14.71  mfu: 4.71%
[rank0]:2025-10-25 00:04:50,789 - INFO -  step: 680  loss: -4.0000  grad_norm:  0.6076  memory: 17.51GiB(36.85%)  tps: 1,881  tflops: 14.71  mfu: 4.71%
[rank3]:2025-10-25 00:04:52,824 - INFO - Avg. fwd time: 33.6639 / Avg. bwd time: 71.1943 / Avg. batch time: 1897.4012 (ms) / GPU bubble ratio: 11.58%
[rank2]:2025-10-25 00:04:52,879 - INFO - Avg. fwd time: 17.4152 / Avg. bwd time: 28.5191 / Avg. batch time: 1969.8305 (ms) / GPU bubble ratio: 62.69%
[rank1]:2025-10-25 00:04:52,958 - INFO - Avg. fwd time: 22.8479 / Avg. bwd time: 41.3057 / Avg. batch time: 2075.2592 (ms) / GPU bubble ratio: 50.54%
[rank0]:2025-10-25 00:04:53,001 - INFO - Avg. fwd time: 19.3329 / Avg. bwd time: 31.6295 / Avg. batch time: 2129.6945 (ms) / GPU bubble ratio: 61.71%
[rank0]:2025-10-25 00:07:36,625 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-25 00:07:45,374 - INFO -  step: 700  loss:  0.7949  grad_norm:  0.5584  memory: 26.71GiB(56.21%)  tps: 1,877  tflops: 14.67  mfu: 4.70%
[rank0]:2025-10-25 00:07:45,377 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.5584  memory: 17.51GiB(36.85%)  tps: 1,877  tflops: 14.67  mfu: 4.70%
[rank1]:2025-10-25 00:07:45,365 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.5584  memory: 15.15GiB(31.88%)  tps: 1,877  tflops: 14.67  mfu: 4.70%
[rank2]:2025-10-25 00:07:45,362 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.5584  memory:  9.81GiB(20.65%)  tps: 1,877  tflops: 14.67  mfu: 4.70%
[rank3]:2025-10-25 00:07:45,755 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_nofreeze_dm1/pipeline_schedule/251025_0007_real_step700_rank3.svg
[rank3]:> Batch Time: 1910.83 ms, GPU Bubble Ratio: 57.22%, 46.29%, 61.83%, 12.22%
[rank3]:2025-10-25 00:07:47,693 - INFO - Avg. fwd time: 33.6671 / Avg. bwd time: 71.1992 / Avg. batch time: 1897.5055 (ms) / GPU bubble ratio: 11.58%
[rank2]:2025-10-25 00:07:47,757 - INFO - Avg. fwd time: 17.4168 / Avg. bwd time: 28.5203 / Avg. batch time: 1970.0151 (ms) / GPU bubble ratio: 62.69%
[rank0]:2025-10-25 00:07:47,886 - INFO - Avg. fwd time: 19.3382 / Avg. bwd time: 31.6370 / Avg. batch time: 2129.8737 (ms) / GPU bubble ratio: 61.71%
[rank1]:2025-10-25 00:07:47,839 - INFO - Avg. fwd time: 22.8476 / Avg. bwd time: 41.3013 / Avg. batch time: 2075.4475 (ms) / GPU bubble ratio: 50.55%
[rank2]:2025-10-25 00:10:40,134 - INFO -  step: 720  loss: -4.0000  grad_norm:  0.5810  memory:  9.81GiB(20.65%)  tps: 1,875  tflops: 14.66  mfu: 4.70%
[rank1]:2025-10-25 00:10:40,138 - INFO -  step: 720  loss: -4.0000  grad_norm:  0.5810  memory: 15.15GiB(31.88%)  tps: 1,875  tflops: 14.66  mfu: 4.70%
[rank3]:2025-10-25 00:10:40,147 - INFO -  step: 720  loss:  0.7726  grad_norm:  0.5810  memory: 26.71GiB(56.21%)  tps: 1,875  tflops: 14.66  mfu: 4.70%
[rank0]:2025-10-25 00:10:40,150 - INFO -  step: 720  loss: -4.0000  grad_norm:  0.5810  memory: 17.51GiB(36.85%)  tps: 1,875  tflops: 14.66  mfu: 4.70%
[rank3]:2025-10-25 00:10:42,158 - INFO - Avg. fwd time: 33.6682 / Avg. bwd time: 71.2029 / Avg. batch time: 1897.5552 (ms) / GPU bubble ratio: 11.57%
[rank2]:2025-10-25 00:10:42,211 - INFO - Avg. fwd time: 17.4168 / Avg. bwd time: 28.5208 / Avg. batch time: 1970.0290 (ms) / GPU bubble ratio: 62.69%
[rank1]:2025-10-25 00:10:42,292 - INFO - Avg. fwd time: 22.8466 / Avg. bwd time: 41.2930 / Avg. batch time: 2075.4617 (ms) / GPU bubble ratio: 50.55%
[rank0]:2025-10-25 00:10:42,336 - INFO - Avg. fwd time: 19.3390 / Avg. bwd time: 31.6442 / Avg. batch time: 2129.8884 (ms) / GPU bubble ratio: 61.70%
[rank3]:2025-10-25 00:13:34,433 - INFO -  step: 740  loss:  0.7636  grad_norm:  0.6167  memory: 26.71GiB(56.21%)  tps: 1,880  tflops: 14.70  mfu: 4.71%
[rank0]:2025-10-25 00:13:34,441 - INFO -  step: 740  loss: -4.0000  grad_norm:  0.6167  memory: 17.51GiB(36.85%)  tps: 1,880  tflops: 14.70  mfu: 4.71%
[rank2]:2025-10-25 00:13:34,421 - INFO -  step: 740  loss: -4.0000  grad_norm:  0.6167  memory:  9.81GiB(20.65%)  tps: 1,880  tflops: 14.70  mfu: 4.71%
[rank1]:2025-10-25 00:13:34,425 - INFO -  step: 740  loss: -4.0000  grad_norm:  0.6167  memory: 15.15GiB(31.88%)  tps: 1,880  tflops: 14.70  mfu: 4.71%
[rank3]:2025-10-25 00:13:36,466 - INFO - Avg. fwd time: 33.6691 / Avg. bwd time: 71.2009 / Avg. batch time: 1897.5175 (ms) / GPU bubble ratio: 11.57%
[rank2]:2025-10-25 00:13:36,526 - INFO - Avg. fwd time: 17.4172 / Avg. bwd time: 28.5206 / Avg. batch time: 1969.9871 (ms) / GPU bubble ratio: 62.69%
[rank1]:2025-10-25 00:13:36,610 - INFO - Avg. fwd time: 22.8492 / Avg. bwd time: 41.2919 / Avg. batch time: 2075.4360 (ms) / GPU bubble ratio: 50.55%
[rank0]:2025-10-25 00:13:36,658 - INFO - Avg. fwd time: 19.3417 / Avg. bwd time: 31.6500 / Avg. batch time: 2129.8624 (ms) / GPU bubble ratio: 61.69%
[rank3]:2025-10-25 00:13:40,071 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 00:13:40,981 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 00:13:41,074 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 00:13:41,037 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 00:14:52,991 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-25 00:16:29,111 - INFO -  step: 760  loss: -4.0000  grad_norm:  0.6118  memory: 17.51GiB(36.85%)  tps: 1,876  tflops: 14.67  mfu: 4.70%
[rank2]:2025-10-25 00:16:29,092 - INFO -  step: 760  loss: -4.0000  grad_norm:  0.6118  memory:  9.81GiB(20.65%)  tps: 1,876  tflops: 14.67  mfu: 4.70%
[rank1]:2025-10-25 00:16:29,101 - INFO -  step: 760  loss: -4.0000  grad_norm:  0.6118  memory: 15.15GiB(31.88%)  tps: 1,876  tflops: 14.67  mfu: 4.70%
[rank3]:2025-10-25 00:16:29,104 - INFO -  step: 760  loss:  0.7468  grad_norm:  0.6118  memory: 26.71GiB(56.21%)  tps: 1,876  tflops: 14.67  mfu: 4.70%
[rank3]:2025-10-25 00:16:31,144 - INFO - Avg. fwd time: 33.6740 / Avg. bwd time: 71.2051 / Avg. batch time: 1897.6573 (ms) / GPU bubble ratio: 11.57%
[rank2]:2025-10-25 00:16:31,196 - INFO - Avg. fwd time: 17.4189 / Avg. bwd time: 28.5204 / Avg. batch time: 1970.0958 (ms) / GPU bubble ratio: 62.69%
[rank0]:2025-10-25 00:16:31,324 - INFO - Avg. fwd time: 19.3600 / Avg. bwd time: 31.6658 / Avg. batch time: 2129.9588 (ms) / GPU bubble ratio: 61.67%
[rank1]:2025-10-25 00:16:31,279 - INFO - Avg. fwd time: 22.8512 / Avg. bwd time: 41.2861 / Avg. batch time: 2075.5428 (ms) / GPU bubble ratio: 50.56%
[rank1]:2025-10-25 00:19:23,660 - INFO -  step: 780  loss: -4.0000  grad_norm:  0.6457  memory: 15.15GiB(31.88%)  tps: 1,877  tflops: 14.68  mfu: 4.70%
[rank3]:2025-10-25 00:19:23,668 - INFO -  step: 780  loss:  0.7477  grad_norm:  0.6457  memory: 26.71GiB(56.21%)  tps: 1,877  tflops: 14.67  mfu: 4.70%
[rank2]:2025-10-25 00:19:23,656 - INFO -  step: 780  loss: -4.0000  grad_norm:  0.6457  memory:  9.81GiB(20.65%)  tps: 1,877  tflops: 14.67  mfu: 4.70%
[rank0]:2025-10-25 00:19:23,676 - INFO -  step: 780  loss: -4.0000  grad_norm:  0.6457  memory: 17.51GiB(36.85%)  tps: 1,877  tflops: 14.67  mfu: 4.70%
[rank3]:2025-10-25 00:19:25,699 - INFO - Avg. fwd time: 33.6767 / Avg. bwd time: 71.2059 / Avg. batch time: 1897.6859 (ms) / GPU bubble ratio: 11.57%
[rank2]:2025-10-25 00:19:25,747 - INFO - Avg. fwd time: 17.4186 / Avg. bwd time: 28.5196 / Avg. batch time: 1970.1384 (ms) / GPU bubble ratio: 62.69%
[rank1]:2025-10-25 00:19:25,824 - INFO - Avg. fwd time: 22.8533 / Avg. bwd time: 41.2881 / Avg. batch time: 2075.5982 (ms) / GPU bubble ratio: 50.56%
[rank0]:2025-10-25 00:19:25,869 - INFO - Avg. fwd time: 19.3641 / Avg. bwd time: 31.6722 / Avg. batch time: 2130.0067 (ms) / GPU bubble ratio: 61.66%
[rank0]:2025-10-25 00:22:09,243 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-25 00:22:18,008 - INFO -  step: 800  loss:  0.7176  grad_norm:  0.5793  memory: 26.71GiB(56.21%)  tps: 1,880  tflops: 14.69  mfu: 4.71%
[rank2]:2025-10-25 00:22:17,996 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.5793  memory:  9.81GiB(20.65%)  tps: 1,880  tflops: 14.69  mfu: 4.71%
[rank1]:2025-10-25 00:22:17,999 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.5793  memory: 15.15GiB(31.88%)  tps: 1,880  tflops: 14.69  mfu: 4.71%
[rank0]:2025-10-25 00:22:18,014 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.5793  memory: 17.51GiB(36.85%)  tps: 1,880  tflops: 14.69  mfu: 4.71%
[rank3]:2025-10-25 00:22:18,381 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_nofreeze_dm1/pipeline_schedule/251025_0022_real_step800_rank3.svg
[rank3]:> Batch Time: 1910.80 ms, GPU Bubble Ratio: 57.13%, 46.33%, 61.83%, 12.22%
[rank3]:2025-10-25 00:22:20,327 - INFO - Avg. fwd time: 33.6773 / Avg. bwd time: 71.2058 / Avg. batch time: 1897.6755 (ms) / GPU bubble ratio: 11.57%
[rank2]:2025-10-25 00:22:20,383 - INFO - Avg. fwd time: 17.4184 / Avg. bwd time: 28.5181 / Avg. batch time: 1970.1975 (ms) / GPU bubble ratio: 62.69%
[rank1]:2025-10-25 00:22:20,468 - INFO - Avg. fwd time: 22.8551 / Avg. bwd time: 41.2822 / Avg. batch time: 2075.6640 (ms) / GPU bubble ratio: 50.56%
[rank0]:2025-10-25 00:22:20,511 - INFO - Avg. fwd time: 19.3642 / Avg. bwd time: 31.6741 / Avg. batch time: 2130.0749 (ms) / GPU bubble ratio: 61.66%
[rank0]:2025-10-25 00:25:12,913 - INFO -  step: 820  loss: -4.0000  grad_norm:  0.6277  memory: 17.51GiB(36.85%)  tps: 1,874  tflops: 14.65  mfu: 4.69%
[rank3]:2025-10-25 00:25:12,910 - INFO -  step: 820  loss:  0.7358  grad_norm:  0.6277  memory: 26.71GiB(56.21%)  tps: 1,874  tflops: 14.65  mfu: 4.69%
[rank1]:2025-10-25 00:25:12,909 - INFO -  step: 820  loss: -4.0000  grad_norm:  0.6277  memory: 15.15GiB(31.88%)  tps: 1,873  tflops: 14.65  mfu: 4.69%
[rank2]:2025-10-25 00:25:12,898 - INFO -  step: 820  loss: -4.0000  grad_norm:  0.6277  memory:  9.81GiB(20.65%)  tps: 1,874  tflops: 14.65  mfu: 4.69%
[rank3]:2025-10-25 00:25:14,945 - INFO - Avg. fwd time: 33.6803 / Avg. bwd time: 71.2083 / Avg. batch time: 1897.7494 (ms) / GPU bubble ratio: 11.57%
[rank1]:2025-10-25 00:25:15,067 - INFO - Avg. fwd time: 22.8560 / Avg. bwd time: 41.2813 / Avg. batch time: 2075.7184 (ms) / GPU bubble ratio: 50.56%
[rank2]:2025-10-25 00:25:14,991 - INFO - Avg. fwd time: 17.4196 / Avg. bwd time: 28.5182 / Avg. batch time: 1970.2365 (ms) / GPU bubble ratio: 62.69%
[rank0]:2025-10-25 00:25:15,112 - INFO - Avg. fwd time: 19.3687 / Avg. bwd time: 31.6786 / Avg. batch time: 2130.1299 (ms) / GPU bubble ratio: 61.66%
[rank3]:2025-10-25 00:25:38,269 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 00:25:39,194 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 00:25:39,138 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 00:25:39,229 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 00:28:07,338 - INFO -  step: 840  loss: -4.0000  grad_norm:  0.6575  memory: 17.51GiB(36.85%)  tps: 1,879  tflops: 14.69  mfu: 4.71%
[rank1]:2025-10-25 00:28:07,327 - INFO -  step: 840  loss: -4.0000  grad_norm:  0.6575  memory: 15.15GiB(31.88%)  tps: 1,879  tflops: 14.69  mfu: 4.71%
[rank2]:2025-10-25 00:28:07,323 - INFO -  step: 840  loss: -4.0000  grad_norm:  0.6575  memory:  9.81GiB(20.65%)  tps: 1,879  tflops: 14.69  mfu: 4.71%
[rank3]:2025-10-25 00:28:07,449 - INFO -  step: 840  loss:  0.6953  grad_norm:  0.6575  memory: 26.71GiB(56.21%)  tps: 1,877  tflops: 14.68  mfu: 4.70%
[rank3]:2025-10-25 00:28:09,381 - INFO - Avg. fwd time: 33.6827 / Avg. bwd time: 71.2060 / Avg. batch time: 1897.7341 (ms) / GPU bubble ratio: 11.57%
[rank1]:2025-10-25 00:28:09,480 - INFO - Avg. fwd time: 22.8575 / Avg. bwd time: 41.2757 / Avg. batch time: 2075.7202 (ms) / GPU bubble ratio: 50.57%
[rank2]:2025-10-25 00:28:09,425 - INFO - Avg. fwd time: 17.4199 / Avg. bwd time: 28.5179 / Avg. batch time: 1970.2096 (ms) / GPU bubble ratio: 62.69%
[rank0]:2025-10-25 00:28:09,526 - INFO - Avg. fwd time: 19.3673 / Avg. bwd time: 31.6766 / Avg. batch time: 2130.1267 (ms) / GPU bubble ratio: 61.66%
[rank0]:2025-10-25 00:29:25,802 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-25 00:31:01,577 - INFO -  step: 860  loss: -4.0000  grad_norm:  0.6421  memory: 15.15GiB(31.88%)  tps: 1,881  tflops: 14.70  mfu: 4.71%
[rank3]:2025-10-25 00:31:01,585 - INFO -  step: 860  loss:  0.6936  grad_norm:  0.6421  memory: 26.71GiB(56.21%)  tps: 1,882  tflops: 14.71  mfu: 4.71%
[rank0]:2025-10-25 00:31:01,592 - INFO -  step: 860  loss: -4.0000  grad_norm:  0.6421  memory: 17.51GiB(36.85%)  tps: 1,880  tflops: 14.70  mfu: 4.71%
[rank2]:2025-10-25 00:31:01,573 - INFO -  step: 860  loss: -4.0000  grad_norm:  0.6421  memory:  9.81GiB(20.65%)  tps: 1,881  tflops: 14.70  mfu: 4.71%
[rank3]:2025-10-25 00:31:03,624 - INFO - Avg. fwd time: 33.6830 / Avg. bwd time: 71.2031 / Avg. batch time: 1897.6724 (ms) / GPU bubble ratio: 11.57%
[rank2]:2025-10-25 00:31:03,680 - INFO - Avg. fwd time: 17.4198 / Avg. bwd time: 28.5188 / Avg. batch time: 1970.1457 (ms) / GPU bubble ratio: 62.69%
[rank1]:2025-10-25 00:31:03,761 - INFO - Avg. fwd time: 22.8587 / Avg. bwd time: 41.2701 / Avg. batch time: 2075.6608 (ms) / GPU bubble ratio: 50.57%
[rank0]:2025-10-25 00:31:03,808 - INFO - Avg. fwd time: 19.3624 / Avg. bwd time: 31.6747 / Avg. batch time: 2130.0738 (ms) / GPU bubble ratio: 61.66%
[rank2]:2025-10-25 00:33:55,498 - INFO -  step: 880  loss: -4.0000  grad_norm:  0.6719  memory:  9.81GiB(20.65%)  tps: 1,884  tflops: 14.73  mfu: 4.72%
[rank0]:2025-10-25 00:33:55,513 - INFO -  step: 880  loss: -4.0000  grad_norm:  0.6719  memory: 17.51GiB(36.85%)  tps: 1,884  tflops: 14.73  mfu: 4.72%
[rank3]:2025-10-25 00:33:55,510 - INFO -  step: 880  loss:  0.7122  grad_norm:  0.6719  memory: 26.71GiB(56.21%)  tps: 1,884  tflops: 14.73  mfu: 4.72%
[rank1]:2025-10-25 00:33:55,510 - INFO -  step: 880  loss: -4.0000  grad_norm:  0.6719  memory: 15.15GiB(31.88%)  tps: 1,884  tflops: 14.73  mfu: 4.72%
[rank3]:2025-10-25 00:33:57,512 - INFO - Avg. fwd time: 33.6811 / Avg. bwd time: 71.1962 / Avg. batch time: 1897.5142 (ms) / GPU bubble ratio: 11.57%
[rank2]:2025-10-25 00:33:57,565 - INFO - Avg. fwd time: 17.4193 / Avg. bwd time: 28.5160 / Avg. batch time: 1969.9556 (ms) / GPU bubble ratio: 62.69%
[rank1]:2025-10-25 00:33:57,638 - INFO - Avg. fwd time: 22.8609 / Avg. bwd time: 41.2701 / Avg. batch time: 2075.4956 (ms) / GPU bubble ratio: 50.56%
[rank0]:2025-10-25 00:33:57,683 - INFO - Avg. fwd time: 19.3579 / Avg. bwd time: 31.6687 / Avg. batch time: 2129.9140 (ms) / GPU bubble ratio: 61.67%
[rank0]:2025-10-25 00:36:40,612 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-25 00:36:49,367 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.6583  memory: 15.15GiB(31.88%)  tps: 1,885  tflops: 14.73  mfu: 4.72%
[rank2]:2025-10-25 00:36:49,363 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.6583  memory:  9.81GiB(20.65%)  tps: 1,885  tflops: 14.73  mfu: 4.72%
[rank0]:2025-10-25 00:36:49,378 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.6583  memory: 17.51GiB(36.85%)  tps: 1,885  tflops: 14.73  mfu: 4.72%
[rank3]:2025-10-25 00:36:49,375 - INFO -  step: 900  loss:  0.6563  grad_norm:  0.6583  memory: 26.71GiB(56.21%)  tps: 1,885  tflops: 14.73  mfu: 4.72%
[rank3]:2025-10-25 00:36:49,757 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_nofreeze_dm1/pipeline_schedule/251025_0036_real_step900_rank3.svg
[rank3]:> Batch Time: 1909.86 ms, GPU Bubble Ratio: 57.13%, 46.35%, 61.81%, 12.23%
[rank3]:2025-10-25 00:36:51,694 - INFO - Avg. fwd time: 33.6796 / Avg. bwd time: 71.1900 / Avg. batch time: 1897.3722 (ms) / GPU bubble ratio: 11.57%
[rank2]:2025-10-25 00:36:51,755 - INFO - Avg. fwd time: 17.4185 / Avg. bwd time: 28.5129 / Avg. batch time: 1969.8626 (ms) / GPU bubble ratio: 62.69%
[rank1]:2025-10-25 00:36:51,838 - INFO - Avg. fwd time: 22.8616 / Avg. bwd time: 41.2624 / Avg. batch time: 2075.4248 (ms) / GPU bubble ratio: 50.57%
[rank0]:2025-10-25 00:36:51,882 - INFO - Avg. fwd time: 19.3546 / Avg. bwd time: 31.6667 / Avg. batch time: 2129.8569 (ms) / GPU bubble ratio: 61.67%
[rank3]:2025-10-25 00:37:35,316 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 00:37:35,399 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 00:37:35,457 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 00:37:35,495 - WARNING - Dataset alpaca is being re-looped
[rank3]:2025-10-25 00:39:44,193 - INFO -  step: 920  loss:  0.6398  grad_norm:  0.6543  memory: 26.71GiB(56.21%)  tps: 1,874  tflops: 14.65  mfu: 4.70%
[rank1]:2025-10-25 00:39:44,190 - INFO -  step: 920  loss: -4.0000  grad_norm:  0.6543  memory: 15.15GiB(31.88%)  tps: 1,874  tflops: 14.65  mfu: 4.70%
[rank2]:2025-10-25 00:39:44,181 - INFO -  step: 920  loss: -4.0000  grad_norm:  0.6543  memory:  9.81GiB(20.65%)  tps: 1,874  tflops: 14.65  mfu: 4.70%
[rank0]:2025-10-25 00:39:44,196 - INFO -  step: 920  loss: -4.0000  grad_norm:  0.6543  memory: 17.51GiB(36.85%)  tps: 1,874  tflops: 14.65  mfu: 4.70%
[rank2]:2025-10-25 00:39:46,275 - INFO - Avg. fwd time: 17.4190 / Avg. bwd time: 28.5118 / Avg. batch time: 1969.8888 (ms) / GPU bubble ratio: 62.69%
[rank3]:2025-10-25 00:39:46,234 - INFO - Avg. fwd time: 33.6826 / Avg. bwd time: 71.1907 / Avg. batch time: 1897.4173 (ms) / GPU bubble ratio: 11.57%
[rank1]:2025-10-25 00:39:46,339 - INFO - Avg. fwd time: 22.8629 / Avg. bwd time: 41.2596 / Avg. batch time: 2075.4555 (ms) / GPU bubble ratio: 50.57%
[rank0]:2025-10-25 00:39:46,385 - INFO - Avg. fwd time: 19.3557 / Avg. bwd time: 31.6629 / Avg. batch time: 2129.8841 (ms) / GPU bubble ratio: 61.67%
[rank1]:2025-10-25 00:42:38,071 - INFO -  step: 940  loss: -4.0000  grad_norm:  0.6928  memory: 15.15GiB(31.88%)  tps: 1,885  tflops: 14.73  mfu: 4.72%
[rank0]:2025-10-25 00:42:38,083 - INFO -  step: 940  loss: -4.0000  grad_norm:  0.6928  memory: 17.51GiB(36.85%)  tps: 1,884  tflops: 14.73  mfu: 4.72%
[rank2]:2025-10-25 00:42:38,067 - INFO -  step: 940  loss: -4.0000  grad_norm:  0.6928  memory:  9.81GiB(20.65%)  tps: 1,884  tflops: 14.73  mfu: 4.72%
[rank3]:2025-10-25 00:42:38,079 - INFO -  step: 940  loss:  0.6412  grad_norm:  0.6928  memory: 26.71GiB(56.21%)  tps: 1,884  tflops: 14.73  mfu: 4.72%
[rank3]:2025-10-25 00:42:40,102 - INFO - Avg. fwd time: 33.6833 / Avg. bwd time: 71.1869 / Avg. batch time: 1897.3463 (ms) / GPU bubble ratio: 11.56%
[rank2]:2025-10-25 00:42:40,168 - INFO - Avg. fwd time: 17.4191 / Avg. bwd time: 28.5110 / Avg. batch time: 1969.7735 (ms) / GPU bubble ratio: 62.69%
[rank1]:2025-10-25 00:42:40,250 - INFO - Avg. fwd time: 22.8646 / Avg. bwd time: 41.2518 / Avg. batch time: 2075.3269 (ms) / GPU bubble ratio: 50.57%
[rank0]:2025-10-25 00:42:40,296 - INFO - Avg. fwd time: 19.3538 / Avg. bwd time: 31.6615 / Avg. batch time: 2129.7556 (ms) / GPU bubble ratio: 61.67%
[rank0]:2025-10-25 00:43:56,699 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-25 00:45:32,588 - INFO -  step: 960  loss: -4.0000  grad_norm:  0.9342  memory: 15.15GiB(31.88%)  tps: 1,878  tflops: 14.68  mfu: 4.70%
[rank0]:2025-10-25 00:45:32,598 - INFO -  step: 960  loss: -4.0000  grad_norm:  0.9342  memory: 17.51GiB(36.85%)  tps: 1,878  tflops: 14.68  mfu: 4.70%
[rank2]:2025-10-25 00:45:32,584 - INFO -  step: 960  loss: -4.0000  grad_norm:  0.9342  memory:  9.81GiB(20.65%)  tps: 1,878  tflops: 14.68  mfu: 4.70%
[rank3]:2025-10-25 00:45:32,596 - INFO -  step: 960  loss:  0.6368  grad_norm:  0.9342  memory: 26.71GiB(56.21%)  tps: 1,878  tflops: 14.68  mfu: 4.70%
[rank3]:2025-10-25 00:45:34,617 - INFO - Avg. fwd time: 33.6862 / Avg. bwd time: 71.1894 / Avg. batch time: 1897.4196 (ms) / GPU bubble ratio: 11.56%
[rank2]:2025-10-25 00:45:34,670 - INFO - Avg. fwd time: 17.4194 / Avg. bwd time: 28.5129 / Avg. batch time: 1969.8088 (ms) / GPU bubble ratio: 62.69%
[rank1]:2025-10-25 00:45:34,748 - INFO - Avg. fwd time: 22.8649 / Avg. bwd time: 41.2499 / Avg. batch time: 2075.3533 (ms) / GPU bubble ratio: 50.57%
[rank0]:2025-10-25 00:45:34,794 - INFO - Avg. fwd time: 19.3542 / Avg. bwd time: 31.6638 / Avg. batch time: 2129.7799 (ms) / GPU bubble ratio: 61.67%
[rank3]:2025-10-25 00:48:27,708 - INFO -  step: 980  loss:  0.6337  grad_norm:  0.6920  memory: 26.71GiB(56.21%)  tps: 1,871  tflops: 14.63  mfu: 4.69%
[rank0]:2025-10-25 00:48:27,711 - INFO -  step: 980  loss: -4.0000  grad_norm:  0.6920  memory: 17.51GiB(36.85%)  tps: 1,871  tflops: 14.63  mfu: 4.69%
[rank1]:2025-10-25 00:48:27,705 - INFO -  step: 980  loss: -4.0000  grad_norm:  0.6920  memory: 15.15GiB(31.88%)  tps: 1,871  tflops: 14.63  mfu: 4.69%
[rank2]:2025-10-25 00:48:27,696 - INFO -  step: 980  loss: -4.0000  grad_norm:  0.6920  memory:  9.81GiB(20.65%)  tps: 1,871  tflops: 14.63  mfu: 4.69%
[rank3]:2025-10-25 00:48:29,743 - INFO - Avg. fwd time: 33.6910 / Avg. bwd time: 71.1962 / Avg. batch time: 1897.6015 (ms) / GPU bubble ratio: 11.56%
[rank2]:2025-10-25 00:48:29,795 - INFO - Avg. fwd time: 17.4210 / Avg. bwd time: 28.5137 / Avg. batch time: 1969.9841 (ms) / GPU bubble ratio: 62.69%
[rank0]:2025-10-25 00:48:29,923 - INFO - Avg. fwd time: 19.3572 / Avg. bwd time: 31.6631 / Avg. batch time: 2129.9692 (ms) / GPU bubble ratio: 61.67%
[rank1]:2025-10-25 00:48:29,876 - INFO - Avg. fwd time: 22.8685 / Avg. bwd time: 41.2572 / Avg. batch time: 2075.5498 (ms) / GPU bubble ratio: 50.57%
[rank3]:2025-10-25 00:49:35,339 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 00:49:35,405 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 00:49:35,463 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 00:49:35,500 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 00:51:13,587 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-25 00:51:22,356 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.7203  memory: 15.15GiB(31.88%)  tps: 1,876  tflops: 14.67  mfu: 4.70%
[rank1]:2025-10-25 00:51:22,356 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-25 00:51:22,369 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.7203  memory: 17.51GiB(36.85%)  tps: 1,876  tflops: 14.67  mfu: 4.70%
[rank0]:2025-10-25 00:51:22,369 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-25 00:51:22,371 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank2]:2025-10-25 00:51:22,352 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.7203  memory:  9.81GiB(20.65%)  tps: 1,876  tflops: 14.67  mfu: 4.70%
[rank2]:2025-10-25 00:51:22,352 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-25 00:51:22,364 - INFO -  step: 1000  loss:  0.6324  grad_norm:  0.7203  memory: 26.71GiB(56.21%)  tps: 1,876  tflops: 14.67  mfu: 4.70%
[rank3]:2025-10-25 00:51:22,364 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-25 00:51:24,223 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 1.87 seconds.
[rank1]:2025-10-25 00:51:24,664 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 2.31 seconds.
[rank3]:2025-10-25 00:51:26,077 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.71 seconds.
[rank0]:2025-10-25 00:51:26,855 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-25 00:51:26,862 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 4.49 seconds.
[rank3]:2025-10-25 00:51:27,426 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_nofreeze_dm1/pipeline_schedule/251025_0051_real_step1000_rank3.svg
[rank3]:> Batch Time: 1909.92 ms, GPU Bubble Ratio: 57.13%, 46.40%, 61.81%, 12.23%
[rank3]:2025-10-25 00:51:29,381 - INFO - Avg. fwd time: 33.6953 / Avg. bwd time: 71.1998 / Avg. batch time: 1897.7162 (ms) / GPU bubble ratio: 11.56%
[rank2]:2025-10-25 00:51:29,431 - INFO - Avg. fwd time: 17.4217 / Avg. bwd time: 28.5128 / Avg. batch time: 1970.1750 (ms) / GPU bubble ratio: 62.70%
[rank1]:2025-10-25 00:51:29,514 - INFO - Avg. fwd time: 22.8711 / Avg. bwd time: 41.2534 / Avg. batch time: 2075.7359 (ms) / GPU bubble ratio: 50.57%
[rank0]:2025-10-25 00:51:29,561 - INFO - Avg. fwd time: 19.3597 / Avg. bwd time: 31.6620 / Avg. batch time: 2130.1503 (ms) / GPU bubble ratio: 61.68%
[rank2]:2025-10-25 00:54:22,131 - INFO -  step: 1020  loss: -4.0000  grad_norm:  0.6653  memory:  9.81GiB(20.65%)  tps: 1,823  tflops: 14.25  mfu: 4.57%
[rank3]:2025-10-25 00:54:22,143 - INFO -  step: 1020  loss:  0.6035  grad_norm:  0.6653  memory: 26.71GiB(56.21%)  tps: 1,823  tflops: 14.25  mfu: 4.57%
[rank0]:2025-10-25 00:54:22,147 - INFO -  step: 1020  loss: -4.0000  grad_norm:  0.6653  memory: 17.51GiB(36.85%)  tps: 1,823  tflops: 14.25  mfu: 4.57%
[rank1]:2025-10-25 00:54:22,135 - INFO -  step: 1020  loss: -4.0000  grad_norm:  0.6653  memory: 15.15GiB(31.88%)  tps: 1,823  tflops: 14.25  mfu: 4.57%
[rank2]:2025-10-25 00:54:24,237 - INFO - Avg. fwd time: 17.4227 / Avg. bwd time: 28.5139 / Avg. batch time: 1970.2610 (ms) / GPU bubble ratio: 62.70%
[rank3]:2025-10-25 00:54:24,193 - INFO - Avg. fwd time: 33.6986 / Avg. bwd time: 71.2048 / Avg. batch time: 1897.8363 (ms) / GPU bubble ratio: 11.56%
[rank1]:2025-10-25 00:54:24,312 - INFO - Avg. fwd time: 22.8721 / Avg. bwd time: 41.2540 / Avg. batch time: 2075.8156 (ms) / GPU bubble ratio: 50.57%
[rank0]:2025-10-25 00:54:24,359 - INFO - Avg. fwd time: 19.3627 / Avg. bwd time: 31.6638 / Avg. batch time: 2130.2321 (ms) / GPU bubble ratio: 61.67%
[rank0]:2025-10-25 00:57:17,146 - INFO -  step: 1040  loss: -4.0000  grad_norm:  0.7702  memory: 17.51GiB(36.85%)  tps: 1,872  tflops: 14.64  mfu: 4.69%
[rank1]:2025-10-25 00:57:17,131 - INFO -  step: 1040  loss: -4.0000  grad_norm:  0.7702  memory: 15.15GiB(31.88%)  tps: 1,873  tflops: 14.64  mfu: 4.69%
[rank2]:2025-10-25 00:57:17,127 - INFO -  step: 1040  loss: -4.0000  grad_norm:  0.7702  memory:  9.81GiB(20.65%)  tps: 1,873  tflops: 14.64  mfu: 4.69%
[rank3]:2025-10-25 00:57:17,139 - INFO -  step: 1040  loss:  0.5801  grad_norm:  0.7702  memory: 26.71GiB(56.21%)  tps: 1,873  tflops: 14.64  mfu: 4.69%
[rank3]:2025-10-25 00:57:19,183 - INFO - Avg. fwd time: 33.7032 / Avg. bwd time: 71.2094 / Avg. batch time: 1897.9985 (ms) / GPU bubble ratio: 11.56%
[rank2]:2025-10-25 00:57:19,234 - INFO - Avg. fwd time: 17.4242 / Avg. bwd time: 28.5151 / Avg. batch time: 1970.3811 (ms) / GPU bubble ratio: 62.70%
[rank0]:2025-10-25 00:57:19,363 - INFO - Avg. fwd time: 19.3625 / Avg. bwd time: 31.6644 / Avg. batch time: 2130.3556 (ms) / GPU bubble ratio: 61.68%
[rank1]:2025-10-25 00:57:19,315 - INFO - Avg. fwd time: 22.8743 / Avg. bwd time: 41.2528 / Avg. batch time: 2075.9390 (ms) / GPU bubble ratio: 50.57%
[rank0]:2025-10-25 00:58:35,960 - INFO - [GC] Peforming periodical GC collection 0.26 seconds
[rank2]:2025-10-25 01:00:11,719 - INFO -  step: 1060  loss: -4.0000  grad_norm:  0.8100  memory:  9.81GiB(20.65%)  tps: 1,877  tflops: 14.67  mfu: 4.70%
[rank3]:2025-10-25 01:00:11,731 - INFO -  step: 1060  loss:  0.5828  grad_norm:  0.8100  memory: 26.71GiB(56.21%)  tps: 1,877  tflops: 14.67  mfu: 4.70%
[rank1]:2025-10-25 01:00:11,723 - INFO -  step: 1060  loss: -4.0000  grad_norm:  0.8100  memory: 15.15GiB(31.88%)  tps: 1,877  tflops: 14.67  mfu: 4.70%
[rank0]:2025-10-25 01:00:11,738 - INFO -  step: 1060  loss: -4.0000  grad_norm:  0.8100  memory: 17.51GiB(36.85%)  tps: 1,877  tflops: 14.67  mfu: 4.70%
[rank3]:2025-10-25 01:00:13,775 - INFO - Avg. fwd time: 33.7043 / Avg. bwd time: 71.2077 / Avg. batch time: 1897.9803 (ms) / GPU bubble ratio: 11.56%
[rank2]:2025-10-25 01:00:13,831 - INFO - Avg. fwd time: 17.4250 / Avg. bwd time: 28.5169 / Avg. batch time: 1970.3278 (ms) / GPU bubble ratio: 62.69%
[rank1]:2025-10-25 01:00:13,915 - INFO - Avg. fwd time: 22.8761 / Avg. bwd time: 41.2517 / Avg. batch time: 2075.8943 (ms) / GPU bubble ratio: 50.57%
[rank0]:2025-10-25 01:00:13,962 - INFO - Avg. fwd time: 19.3670 / Avg. bwd time: 31.6640 / Avg. batch time: 2130.3196 (ms) / GPU bubble ratio: 61.67%
[rank3]:2025-10-25 01:01:38,086 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 01:01:38,953 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 01:01:39,009 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 01:01:39,045 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 01:03:06,508 - INFO -  step: 1080  loss: -4.0000  grad_norm:  0.7875  memory: 17.51GiB(36.85%)  tps: 1,875  tflops: 14.66  mfu: 4.70%
[rank2]:2025-10-25 01:03:06,492 - INFO -  step: 1080  loss: -4.0000  grad_norm:  0.7875  memory:  9.81GiB(20.65%)  tps: 1,875  tflops: 14.66  mfu: 4.70%
[rank3]:2025-10-25 01:03:06,504 - INFO -  step: 1080  loss:  0.5707  grad_norm:  0.7875  memory: 26.71GiB(56.21%)  tps: 1,875  tflops: 14.66  mfu: 4.70%
[rank1]:2025-10-25 01:03:06,503 - INFO -  step: 1080  loss: -4.0000  grad_norm:  0.7875  memory: 15.15GiB(31.88%)  tps: 1,875  tflops: 14.66  mfu: 4.70%
[rank3]:2025-10-25 01:03:08,546 - INFO - Avg. fwd time: 33.7077 / Avg. bwd time: 71.2107 / Avg. batch time: 1898.0769 (ms) / GPU bubble ratio: 11.56%
[rank2]:2025-10-25 01:03:08,606 - INFO - Avg. fwd time: 17.4255 / Avg. bwd time: 28.5173 / Avg. batch time: 1970.3934 (ms) / GPU bubble ratio: 62.69%
[rank1]:2025-10-25 01:03:08,690 - INFO - Avg. fwd time: 22.8788 / Avg. bwd time: 41.2523 / Avg. batch time: 2075.9757 (ms) / GPU bubble ratio: 50.57%
[rank0]:2025-10-25 01:03:08,737 - INFO - Avg. fwd time: 19.3702 / Avg. bwd time: 31.6641 / Avg. batch time: 2130.4040 (ms) / GPU bubble ratio: 61.67%
[rank0]:2025-10-25 01:05:52,592 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-25 01:06:01,286 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.7544  memory:  9.81GiB(20.65%)  tps: 1,875  tflops: 14.66  mfu: 4.70%
[rank1]:2025-10-25 01:06:01,298 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.7544  memory: 15.15GiB(31.88%)  tps: 1,875  tflops: 14.66  mfu: 4.70%
[rank3]:2025-10-25 01:06:01,299 - INFO -  step: 1100  loss:  0.5760  grad_norm:  0.7544  memory: 26.71GiB(56.21%)  tps: 1,875  tflops: 14.66  mfu: 4.70%
[rank0]:2025-10-25 01:06:01,302 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.7544  memory: 17.51GiB(36.85%)  tps: 1,875  tflops: 14.66  mfu: 4.70%
[rank3]:2025-10-25 01:06:01,678 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_nofreeze_dm1/pipeline_schedule/251025_0106_real_step1100_rank3.svg
[rank3]:> Batch Time: 1910.06 ms, GPU Bubble Ratio: 57.13%, 46.41%, 61.81%, 12.22%
[rank2]:2025-10-25 01:06:03,668 - INFO - Avg. fwd time: 17.4262 / Avg. bwd time: 28.5185 / Avg. batch time: 1970.5138 (ms) / GPU bubble ratio: 62.69%
[rank3]:2025-10-25 01:06:03,624 - INFO - Avg. fwd time: 33.7101 / Avg. bwd time: 71.2126 / Avg. batch time: 1898.1454 (ms) / GPU bubble ratio: 11.56%
[rank1]:2025-10-25 01:06:03,746 - INFO - Avg. fwd time: 22.8812 / Avg. bwd time: 41.2543 / Avg. batch time: 2076.1049 (ms) / GPU bubble ratio: 50.57%
[rank0]:2025-10-25 01:06:03,794 - INFO - Avg. fwd time: 19.3709 / Avg. bwd time: 31.6656 / Avg. batch time: 2130.5364 (ms) / GPU bubble ratio: 61.67%
[rank0]:2025-10-25 01:08:56,361 - INFO -  step: 1120  loss: -4.0000  grad_norm:  0.8437  memory: 17.51GiB(36.85%)  tps: 1,872  tflops: 14.63  mfu: 4.69%
[rank2]:2025-10-25 01:08:56,344 - INFO -  step: 1120  loss: -4.0000  grad_norm:  0.8437  memory:  9.81GiB(20.65%)  tps: 1,872  tflops: 14.63  mfu: 4.69%
[rank1]:2025-10-25 01:08:56,347 - INFO -  step: 1120  loss: -4.0000  grad_norm:  0.8437  memory: 15.15GiB(31.88%)  tps: 1,872  tflops: 14.63  mfu: 4.69%
[rank3]:2025-10-25 01:08:56,356 - INFO -  step: 1120  loss:  0.5504  grad_norm:  0.8437  memory: 26.71GiB(56.21%)  tps: 1,872  tflops: 14.63  mfu: 4.69%
[rank3]:2025-10-25 01:08:58,406 - INFO - Avg. fwd time: 33.7135 / Avg. bwd time: 71.2178 / Avg. batch time: 1898.2751 (ms) / GPU bubble ratio: 11.56%
[rank2]:2025-10-25 01:08:58,458 - INFO - Avg. fwd time: 17.4266 / Avg. bwd time: 28.5195 / Avg. batch time: 1970.5953 (ms) / GPU bubble ratio: 62.69%
[rank1]:2025-10-25 01:08:58,539 - INFO - Avg. fwd time: 22.8821 / Avg. bwd time: 41.2520 / Avg. batch time: 2076.1866 (ms) / GPU bubble ratio: 50.58%
[rank0]:2025-10-25 01:08:58,587 - INFO - Avg. fwd time: 19.3725 / Avg. bwd time: 31.6666 / Avg. batch time: 2130.6167 (ms) / GPU bubble ratio: 61.67%
[rank1]:2025-10-25 01:11:51,576 - INFO -  step: 1140  loss: -4.0000  grad_norm:  0.7755  memory: 15.15GiB(31.88%)  tps: 1,870  tflops: 14.62  mfu: 4.69%
[rank3]:2025-10-25 01:11:51,584 - INFO -  step: 1140  loss:  0.5403  grad_norm:  0.7755  memory: 26.71GiB(56.21%)  tps: 1,870  tflops: 14.62  mfu: 4.69%
[rank0]:2025-10-25 01:11:51,589 - INFO -  step: 1140  loss: -4.0000  grad_norm:  0.7755  memory: 17.51GiB(36.85%)  tps: 1,870  tflops: 14.62  mfu: 4.69%
[rank2]:2025-10-25 01:11:51,573 - INFO -  step: 1140  loss: -4.0000  grad_norm:  0.7755  memory:  9.81GiB(20.65%)  tps: 1,870  tflops: 14.62  mfu: 4.69%
[rank3]:2025-10-25 01:11:53,630 - INFO - Avg. fwd time: 33.7178 / Avg. bwd time: 71.2258 / Avg. batch time: 1898.4681 (ms) / GPU bubble ratio: 11.56%
[rank2]:2025-10-25 01:11:53,685 - INFO - Avg. fwd time: 17.4274 / Avg. bwd time: 28.5200 / Avg. batch time: 1970.7571 (ms) / GPU bubble ratio: 62.70%
[rank1]:2025-10-25 01:11:53,759 - INFO - Avg. fwd time: 22.8839 / Avg. bwd time: 41.2531 / Avg. batch time: 2076.3464 (ms) / GPU bubble ratio: 50.58%
[rank0]:2025-10-25 01:11:53,807 - INFO - Avg. fwd time: 19.3763 / Avg. bwd time: 31.6681 / Avg. batch time: 2130.7796 (ms) / GPU bubble ratio: 61.67%
[rank0]:2025-10-25 01:13:10,016 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-25 01:13:37,400 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 01:13:38,298 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 01:13:38,353 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 01:13:38,389 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 01:14:46,006 - INFO -  step: 1160  loss: -4.0000  grad_norm:  0.7666  memory:  9.81GiB(20.65%)  tps: 1,879  tflops: 14.69  mfu: 4.71%
[rank1]:2025-10-25 01:14:46,010 - INFO -  step: 1160  loss: -4.0000  grad_norm:  0.7666  memory: 15.15GiB(31.88%)  tps: 1,879  tflops: 14.69  mfu: 4.71%
[rank3]:2025-10-25 01:14:46,018 - INFO -  step: 1160  loss:  0.5268  grad_norm:  0.7666  memory: 26.71GiB(56.21%)  tps: 1,879  tflops: 14.69  mfu: 4.71%
[rank0]:2025-10-25 01:14:46,021 - INFO -  step: 1160  loss: -4.0000  grad_norm:  0.7666  memory: 17.51GiB(36.85%)  tps: 1,879  tflops: 14.69  mfu: 4.71%
[rank2]:2025-10-25 01:14:48,092 - INFO - Avg. fwd time: 17.4276 / Avg. bwd time: 28.5204 / Avg. batch time: 1970.7391 (ms) / GPU bubble ratio: 62.70%
[rank3]:2025-10-25 01:14:48,039 - INFO - Avg. fwd time: 33.7189 / Avg. bwd time: 71.2263 / Avg. batch time: 1898.4890 (ms) / GPU bubble ratio: 11.55%
[rank1]:2025-10-25 01:14:48,176 - INFO - Avg. fwd time: 22.8850 / Avg. bwd time: 41.2507 / Avg. batch time: 2076.3303 (ms) / GPU bubble ratio: 50.58%
[rank0]:2025-10-25 01:14:48,224 - INFO - Avg. fwd time: 19.3798 / Avg. bwd time: 31.6689 / Avg. batch time: 2130.7669 (ms) / GPU bubble ratio: 61.67%
[rank1]:2025-10-25 01:17:40,829 - INFO -  step: 1180  loss: -4.0000  grad_norm:  0.8579  memory: 15.15GiB(31.88%)  tps: 1,874  tflops: 14.65  mfu: 4.70%
[rank2]:2025-10-25 01:17:40,824 - INFO -  step: 1180  loss: -4.0000  grad_norm:  0.8579  memory:  9.81GiB(20.65%)  tps: 1,874  tflops: 14.65  mfu: 4.70%
[rank3]:2025-10-25 01:17:40,836 - INFO -  step: 1180  loss:  0.5207  grad_norm:  0.8579  memory: 26.71GiB(56.21%)  tps: 1,874  tflops: 14.65  mfu: 4.70%
[rank0]:2025-10-25 01:17:40,841 - INFO -  step: 1180  loss: -4.0000  grad_norm:  0.8579  memory: 17.51GiB(36.85%)  tps: 1,874  tflops: 14.65  mfu: 4.70%
[rank2]:2025-10-25 01:17:42,933 - INFO - Avg. fwd time: 17.4283 / Avg. bwd time: 28.5218 / Avg. batch time: 1970.8026 (ms) / GPU bubble ratio: 62.70%
[rank3]:2025-10-25 01:17:42,884 - INFO - Avg. fwd time: 33.7217 / Avg. bwd time: 71.2291 / Avg. batch time: 1898.5835 (ms) / GPU bubble ratio: 11.55%
[rank1]:2025-10-25 01:17:43,014 - INFO - Avg. fwd time: 22.8867 / Avg. bwd time: 41.2557 / Avg. batch time: 2076.4073 (ms) / GPU bubble ratio: 50.57%
[rank0]:2025-10-25 01:17:43,062 - INFO - Avg. fwd time: 19.3827 / Avg. bwd time: 31.6710 / Avg. batch time: 2130.8434 (ms) / GPU bubble ratio: 61.66%
[rank0]:2025-10-25 01:20:27,187 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-25 01:20:35,994 - INFO -  step: 1200  loss:  0.5388  grad_norm:  0.7795  memory: 26.71GiB(56.21%)  tps: 1,871  tflops: 14.62  mfu: 4.69%
[rank1]:2025-10-25 01:20:35,985 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.7795  memory: 15.15GiB(31.88%)  tps: 1,871  tflops: 14.62  mfu: 4.69%
[rank0]:2025-10-25 01:20:36,001 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.7795  memory: 17.51GiB(36.85%)  tps: 1,871  tflops: 14.62  mfu: 4.69%
[rank2]:2025-10-25 01:20:35,982 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.7795  memory:  9.81GiB(20.65%)  tps: 1,871  tflops: 14.62  mfu: 4.69%
[rank3]:2025-10-25 01:20:36,374 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_nofreeze_dm1/pipeline_schedule/251025_0120_real_step1200_rank3.svg
[rank3]:> Batch Time: 1910.73 ms, GPU Bubble Ratio: 57.12%, 46.44%, 61.81%, 12.22%
[rank3]:2025-10-25 01:20:38,342 - INFO - Avg. fwd time: 33.7244 / Avg. bwd time: 71.2380 / Avg. batch time: 1898.7628 (ms) / GPU bubble ratio: 11.55%
[rank2]:2025-10-25 01:20:38,394 - INFO - Avg. fwd time: 17.4290 / Avg. bwd time: 28.5223 / Avg. batch time: 1971.0081 (ms) / GPU bubble ratio: 62.70%
[rank1]:2025-10-25 01:20:38,475 - INFO - Avg. fwd time: 22.8859 / Avg. bwd time: 41.2577 / Avg. batch time: 2076.6109 (ms) / GPU bubble ratio: 50.58%
[rank0]:2025-10-25 01:20:38,528 - INFO - Avg. fwd time: 19.3877 / Avg. bwd time: 31.6744 / Avg. batch time: 2131.0398 (ms) / GPU bubble ratio: 61.66%
[rank1]:2025-10-25 01:23:31,401 - INFO -  step: 1220  loss: -4.0000  grad_norm:  0.7973  memory: 15.15GiB(31.88%)  tps: 1,868  tflops: 14.60  mfu: 4.68%
[rank0]:2025-10-25 01:23:31,406 - INFO -  step: 1220  loss: -4.0000  grad_norm:  0.7973  memory: 17.51GiB(36.85%)  tps: 1,868  tflops: 14.60  mfu: 4.68%
[rank3]:2025-10-25 01:23:31,402 - INFO -  step: 1220  loss:  0.5158  grad_norm:  0.7973  memory: 26.71GiB(56.21%)  tps: 1,868  tflops: 14.60  mfu: 4.68%
[rank2]:2025-10-25 01:23:31,390 - INFO -  step: 1220  loss: -4.0000  grad_norm:  0.7973  memory:  9.81GiB(20.65%)  tps: 1,868  tflops: 14.60  mfu: 4.68%
[rank3]:2025-10-25 01:23:33,438 - INFO - Avg. fwd time: 33.7278 / Avg. bwd time: 71.2444 / Avg. batch time: 1898.9155 (ms) / GPU bubble ratio: 11.55%
[rank2]:2025-10-25 01:23:33,484 - INFO - Avg. fwd time: 17.4300 / Avg. bwd time: 28.5236 / Avg. batch time: 1971.1220 (ms) / GPU bubble ratio: 62.70%
[rank1]:2025-10-25 01:23:33,564 - INFO - Avg. fwd time: 22.8880 / Avg. bwd time: 41.2549 / Avg. batch time: 2076.7196 (ms) / GPU bubble ratio: 50.58%
[rank0]:2025-10-25 01:23:33,613 - INFO - Avg. fwd time: 19.3926 / Avg. bwd time: 31.6767 / Avg. batch time: 2131.1474 (ms) / GPU bubble ratio: 61.66%
[rank3]:2025-10-25 01:25:39,186 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 01:25:40,094 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 01:25:40,150 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 01:25:40,190 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 01:26:26,180 - INFO -  step: 1240  loss: -4.0000  grad_norm:  0.8148  memory:  9.81GiB(20.65%)  tps: 1,875  tflops: 14.66  mfu: 4.70%
[rank1]:2025-10-25 01:26:26,183 - INFO -  step: 1240  loss: -4.0000  grad_norm:  0.8148  memory: 15.15GiB(31.88%)  tps: 1,875  tflops: 14.66  mfu: 4.70%
[rank0]:2025-10-25 01:26:26,197 - INFO -  step: 1240  loss: -4.0000  grad_norm:  0.8148  memory: 17.51GiB(36.85%)  tps: 1,875  tflops: 14.66  mfu: 4.70%
[rank3]:2025-10-25 01:26:26,192 - INFO -  step: 1240  loss:  0.5061  grad_norm:  0.8148  memory: 26.71GiB(56.21%)  tps: 1,875  tflops: 14.66  mfu: 4.70%
[rank3]:2025-10-25 01:26:28,224 - INFO - Avg. fwd time: 33.7284 / Avg. bwd time: 71.2469 / Avg. batch time: 1898.9671 (ms) / GPU bubble ratio: 11.55%
[rank2]:2025-10-25 01:26:28,280 - INFO - Avg. fwd time: 17.4303 / Avg. bwd time: 28.5246 / Avg. batch time: 1971.1670 (ms) / GPU bubble ratio: 62.70%
[rank1]:2025-10-25 01:26:28,359 - INFO - Avg. fwd time: 22.8888 / Avg. bwd time: 41.2580 / Avg. batch time: 2076.7711 (ms) / GPU bubble ratio: 50.58%
[rank0]:2025-10-25 01:26:28,409 - INFO - Avg. fwd time: 19.3978 / Avg. bwd time: 31.6774 / Avg. batch time: 2131.2032 (ms) / GPU bubble ratio: 61.66%
[rank0]:2025-10-25 01:27:44,959 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-25 01:29:21,056 - INFO -  step: 1260  loss: -4.0000  grad_norm:  1.0393  memory:  9.81GiB(20.65%)  tps: 1,874  tflops: 14.65  mfu: 4.69%
[rank0]:2025-10-25 01:29:21,075 - INFO -  step: 1260  loss: -4.0000  grad_norm:  1.0393  memory: 17.51GiB(36.85%)  tps: 1,874  tflops: 14.65  mfu: 4.69%
[rank3]:2025-10-25 01:29:21,068 - INFO -  step: 1260  loss:  0.5109  grad_norm:  1.0393  memory: 26.71GiB(56.21%)  tps: 1,874  tflops: 14.65  mfu: 4.70%
[rank1]:2025-10-25 01:29:21,068 - INFO -  step: 1260  loss: -4.0000  grad_norm:  1.0393  memory: 15.15GiB(31.88%)  tps: 1,874  tflops: 14.65  mfu: 4.69%
[rank3]:2025-10-25 01:29:23,128 - INFO - Avg. fwd time: 33.7315 / Avg. bwd time: 71.2502 / Avg. batch time: 1899.0740 (ms) / GPU bubble ratio: 11.55%
[rank2]:2025-10-25 01:29:23,174 - INFO - Avg. fwd time: 17.4309 / Avg. bwd time: 28.5239 / Avg. batch time: 1971.2303 (ms) / GPU bubble ratio: 62.70%
[rank1]:2025-10-25 01:29:23,251 - INFO - Avg. fwd time: 22.8916 / Avg. bwd time: 41.2588 / Avg. batch time: 2076.8427 (ms) / GPU bubble ratio: 50.58%
[rank0]:2025-10-25 01:29:23,301 - INFO - Avg. fwd time: 19.4007 / Avg. bwd time: 31.6773 / Avg. batch time: 2131.2776 (ms) / GPU bubble ratio: 61.65%
[rank1]:2025-10-25 01:32:16,133 - INFO -  step: 1280  loss: -4.0000  grad_norm:  0.9741  memory: 15.15GiB(31.88%)  tps: 1,872  tflops: 14.63  mfu: 4.69%
[rank2]:2025-10-25 01:32:16,129 - INFO -  step: 1280  loss: -4.0000  grad_norm:  0.9741  memory:  9.81GiB(20.65%)  tps: 1,872  tflops: 14.63  mfu: 4.69%
[rank0]:2025-10-25 01:32:16,148 - INFO -  step: 1280  loss: -4.0000  grad_norm:  0.9741  memory: 17.51GiB(36.85%)  tps: 1,872  tflops: 14.63  mfu: 4.69%
[rank3]:2025-10-25 01:32:16,141 - INFO -  step: 1280  loss:  0.5037  grad_norm:  0.9741  memory: 26.71GiB(56.21%)  tps: 1,872  tflops: 14.63  mfu: 4.69%
[rank3]:2025-10-25 01:32:18,197 - INFO - Avg. fwd time: 33.7342 / Avg. bwd time: 71.2551 / Avg. batch time: 1899.2001 (ms) / GPU bubble ratio: 11.55%
[rank2]:2025-10-25 01:32:18,251 - INFO - Avg. fwd time: 17.4314 / Avg. bwd time: 28.5255 / Avg. batch time: 1971.3292 (ms) / GPU bubble ratio: 62.70%
[rank1]:2025-10-25 01:32:18,334 - INFO - Avg. fwd time: 22.8934 / Avg. bwd time: 41.2610 / Avg. batch time: 2076.9492 (ms) / GPU bubble ratio: 50.58%
[rank0]:2025-10-25 01:32:18,386 - INFO - Avg. fwd time: 19.4036 / Avg. bwd time: 31.6796 / Avg. batch time: 2131.3819 (ms) / GPU bubble ratio: 61.65%
[rank0]:2025-10-25 01:35:02,676 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-25 01:35:11,461 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.9026  memory: 15.15GiB(31.88%)  tps: 1,869  tflops: 14.61  mfu: 4.68%
[rank2]:2025-10-25 01:35:11,450 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.9026  memory:  9.81GiB(20.65%)  tps: 1,869  tflops: 14.61  mfu: 4.68%
[rank0]:2025-10-25 01:35:11,465 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.9026  memory: 17.51GiB(36.85%)  tps: 1,869  tflops: 14.61  mfu: 4.68%
[rank3]:2025-10-25 01:35:11,462 - INFO -  step: 1300  loss:  0.4789  grad_norm:  0.9026  memory: 26.71GiB(56.21%)  tps: 1,869  tflops: 14.61  mfu: 4.68%
[rank3]:2025-10-25 01:35:11,853 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_nofreeze_dm1/pipeline_schedule/251025_0135_real_step1300_rank3.svg
[rank3]:> Batch Time: 1911.22 ms, GPU Bubble Ratio: 57.12%, 46.45%, 61.81%, 12.21%
[rank3]:2025-10-25 01:35:13,822 - INFO - Avg. fwd time: 33.7376 / Avg. bwd time: 71.2612 / Avg. batch time: 1899.3624 (ms) / GPU bubble ratio: 11.55%
[rank2]:2025-10-25 01:35:13,876 - INFO - Avg. fwd time: 17.4320 / Avg. bwd time: 28.5257 / Avg. batch time: 1971.5110 (ms) / GPU bubble ratio: 62.70%
[rank1]:2025-10-25 01:35:13,958 - INFO - Avg. fwd time: 22.8948 / Avg. bwd time: 41.2637 / Avg. batch time: 2077.1484 (ms) / GPU bubble ratio: 50.58%
[rank0]:2025-10-25 01:35:14,006 - INFO - Avg. fwd time: 19.4069 / Avg. bwd time: 31.6785 / Avg. batch time: 2131.5803 (ms) / GPU bubble ratio: 61.65%
[rank3]:2025-10-25 01:37:39,166 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 01:37:40,101 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 01:37:40,044 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 01:37:40,136 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 01:38:06,308 - INFO -  step: 1320  loss: -4.0000  grad_norm:  0.7945  memory:  9.81GiB(20.65%)  tps: 1,874  tflops: 14.65  mfu: 4.70%
[rank1]:2025-10-25 01:38:06,312 - INFO -  step: 1320  loss: -4.0000  grad_norm:  0.7945  memory: 15.15GiB(31.88%)  tps: 1,874  tflops: 14.65  mfu: 4.70%
[rank0]:2025-10-25 01:38:06,327 - INFO -  step: 1320  loss: -4.0000  grad_norm:  0.7945  memory: 17.51GiB(36.85%)  tps: 1,874  tflops: 14.65  mfu: 4.70%
[rank3]:2025-10-25 01:38:06,320 - INFO -  step: 1320  loss:  0.4724  grad_norm:  0.7945  memory: 26.71GiB(56.21%)  tps: 1,874  tflops: 14.65  mfu: 4.70%
[rank3]:2025-10-25 01:38:08,368 - INFO - Avg. fwd time: 33.7388 / Avg. bwd time: 71.2612 / Avg. batch time: 1899.3773 (ms) / GPU bubble ratio: 11.55%
[rank2]:2025-10-25 01:38:08,423 - INFO - Avg. fwd time: 17.4319 / Avg. bwd time: 28.5260 / Avg. batch time: 1971.4869 (ms) / GPU bubble ratio: 62.70%
[rank1]:2025-10-25 01:38:08,505 - INFO - Avg. fwd time: 22.8960 / Avg. bwd time: 41.2594 / Avg. batch time: 2077.1343 (ms) / GPU bubble ratio: 50.58%
[rank0]:2025-10-25 01:38:08,555 - INFO - Avg. fwd time: 19.4107 / Avg. bwd time: 31.6808 / Avg. batch time: 2131.5698 (ms) / GPU bubble ratio: 61.65%
[rank2]:2025-10-25 01:41:00,888 - INFO -  step: 1340  loss: -4.0000  grad_norm:  0.8219  memory:  9.81GiB(20.65%)  tps: 1,877  tflops: 14.67  mfu: 4.70%
[rank3]:2025-10-25 01:41:00,900 - INFO -  step: 1340  loss:  0.4571  grad_norm:  0.8219  memory: 26.71GiB(56.21%)  tps: 1,877  tflops: 14.67  mfu: 4.70%
[rank1]:2025-10-25 01:41:00,891 - INFO -  step: 1340  loss: -4.0000  grad_norm:  0.8219  memory: 15.15GiB(31.88%)  tps: 1,877  tflops: 14.67  mfu: 4.70%
[rank0]:2025-10-25 01:41:00,908 - INFO -  step: 1340  loss: -4.0000  grad_norm:  0.8219  memory: 17.51GiB(36.85%)  tps: 1,877  tflops: 14.67  mfu: 4.70%
[rank2]:2025-10-25 01:41:02,974 - INFO - Avg. fwd time: 17.4318 / Avg. bwd time: 28.5263 / Avg. batch time: 1971.4839 (ms) / GPU bubble ratio: 62.70%
[rank3]:2025-10-25 01:41:02,925 - INFO - Avg. fwd time: 33.7386 / Avg. bwd time: 71.2634 / Avg. batch time: 1899.3986 (ms) / GPU bubble ratio: 11.55%
[rank1]:2025-10-25 01:41:03,053 - INFO - Avg. fwd time: 22.8946 / Avg. bwd time: 41.2602 / Avg. batch time: 2077.1338 (ms) / GPU bubble ratio: 50.58%
[rank0]:2025-10-25 01:41:03,103 - INFO - Avg. fwd time: 19.4122 / Avg. bwd time: 31.6826 / Avg. batch time: 2131.5707 (ms) / GPU bubble ratio: 61.65%
[rank0]:2025-10-25 01:42:19,759 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-25 01:43:55,932 - INFO -  step: 1360  loss:  0.4727  grad_norm:  0.9171  memory: 26.71GiB(56.21%)  tps: 1,872  tflops: 14.64  mfu: 4.69%
[rank1]:2025-10-25 01:43:55,924 - INFO -  step: 1360  loss: -4.0000  grad_norm:  0.9171  memory: 15.15GiB(31.88%)  tps: 1,872  tflops: 14.64  mfu: 4.69%
[rank2]:2025-10-25 01:43:55,920 - INFO -  step: 1360  loss: -4.0000  grad_norm:  0.9171  memory:  9.81GiB(20.65%)  tps: 1,872  tflops: 14.64  mfu: 4.69%
[rank0]:2025-10-25 01:43:55,938 - INFO -  step: 1360  loss: -4.0000  grad_norm:  0.9171  memory: 17.51GiB(36.85%)  tps: 1,872  tflops: 14.64  mfu: 4.69%
[rank3]:2025-10-25 01:43:57,976 - INFO - Avg. fwd time: 33.7412 / Avg. bwd time: 71.2670 / Avg. batch time: 1899.4998 (ms) / GPU bubble ratio: 11.55%
[rank1]:2025-10-25 01:43:58,117 - INFO - Avg. fwd time: 22.8962 / Avg. bwd time: 41.2652 / Avg. batch time: 2077.2217 (ms) / GPU bubble ratio: 50.58%
[rank2]:2025-10-25 01:43:58,034 - INFO - Avg. fwd time: 17.4320 / Avg. bwd time: 28.5267 / Avg. batch time: 1971.5685 (ms) / GPU bubble ratio: 62.70%
[rank0]:2025-10-25 01:43:58,170 - INFO - Avg. fwd time: 19.4151 / Avg. bwd time: 31.6834 / Avg. batch time: 2131.6586 (ms) / GPU bubble ratio: 61.65%
[rank2]:2025-10-25 01:46:50,644 - INFO -  step: 1380  loss: -4.0000  grad_norm:  0.9745  memory:  9.81GiB(20.65%)  tps: 1,875  tflops: 14.66  mfu: 4.70%
[rank1]:2025-10-25 01:46:50,648 - INFO -  step: 1380  loss: -4.0000  grad_norm:  0.9745  memory: 15.15GiB(31.88%)  tps: 1,875  tflops: 14.66  mfu: 4.70%
[rank3]:2025-10-25 01:46:50,657 - INFO -  step: 1380  loss:  0.4707  grad_norm:  0.9745  memory: 26.71GiB(56.21%)  tps: 1,875  tflops: 14.66  mfu: 4.70%
[rank0]:2025-10-25 01:46:50,662 - INFO -  step: 1380  loss: -4.0000  grad_norm:  0.9745  memory: 17.51GiB(36.85%)  tps: 1,875  tflops: 14.66  mfu: 4.70%
[rank3]:2025-10-25 01:46:52,703 - INFO - Avg. fwd time: 33.7422 / Avg. bwd time: 71.2701 / Avg. batch time: 1899.5639 (ms) / GPU bubble ratio: 11.55%
[rank2]:2025-10-25 01:46:52,756 - INFO - Avg. fwd time: 17.4323 / Avg. bwd time: 28.5273 / Avg. batch time: 1971.5988 (ms) / GPU bubble ratio: 62.70%
[rank1]:2025-10-25 01:46:52,838 - INFO - Avg. fwd time: 22.8972 / Avg. bwd time: 41.2627 / Avg. batch time: 2077.2401 (ms) / GPU bubble ratio: 50.58%
[rank0]:2025-10-25 01:46:52,888 - INFO - Avg. fwd time: 19.4186 / Avg. bwd time: 31.6842 / Avg. batch time: 2131.6818 (ms) / GPU bubble ratio: 61.64%
[rank0]:2025-10-25 01:49:36,902 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-25 01:49:38,107 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 01:49:39,005 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 01:49:39,061 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 01:49:39,097 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 01:49:45,688 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.8470  memory: 17.51GiB(36.85%)  tps: 1,872  tflops: 14.64  mfu: 4.69%
[rank2]:2025-10-25 01:49:45,670 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.8470  memory:  9.81GiB(20.65%)  tps: 1,872  tflops: 14.64  mfu: 4.69%
[rank1]:2025-10-25 01:49:45,673 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.8470  memory: 15.15GiB(31.88%)  tps: 1,872  tflops: 14.64  mfu: 4.69%
[rank3]:2025-10-25 01:49:45,682 - INFO -  step: 1400  loss:  0.4573  grad_norm:  0.8470  memory: 26.71GiB(56.21%)  tps: 1,872  tflops: 14.64  mfu: 4.69%
[rank3]:2025-10-25 01:49:46,059 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_nofreeze_dm1/pipeline_schedule/251025_0149_real_step1400_rank3.svg
[rank3]:> Batch Time: 1911.47 ms, GPU Bubble Ratio: 57.11%, 46.46%, 61.82%, 12.21%
[rank3]:2025-10-25 01:49:48,017 - INFO - Avg. fwd time: 33.7448 / Avg. bwd time: 71.2742 / Avg. batch time: 1899.6763 (ms) / GPU bubble ratio: 11.55%
[rank2]:2025-10-25 01:49:48,077 - INFO - Avg. fwd time: 17.4329 / Avg. bwd time: 28.5288 / Avg. batch time: 1971.7281 (ms) / GPU bubble ratio: 62.70%
[rank1]:2025-10-25 01:49:48,159 - INFO - Avg. fwd time: 22.8979 / Avg. bwd time: 41.2652 / Avg. batch time: 2077.3668 (ms) / GPU bubble ratio: 50.58%
[rank0]:2025-10-25 01:49:48,208 - INFO - Avg. fwd time: 19.4220 / Avg. bwd time: 31.6871 / Avg. batch time: 2131.8100 (ms) / GPU bubble ratio: 61.64%
[rank3]:2025-10-25 01:52:40,669 - INFO -  step: 1420  loss:  0.4388  grad_norm:  0.8939  memory: 26.71GiB(56.21%)  tps: 1,873  tflops: 14.64  mfu: 4.69%
[rank0]:2025-10-25 01:52:40,675 - INFO -  step: 1420  loss: -4.0000  grad_norm:  0.8939  memory: 17.51GiB(36.85%)  tps: 1,873  tflops: 14.64  mfu: 4.69%
[rank2]:2025-10-25 01:52:40,657 - INFO -  step: 1420  loss: -4.0000  grad_norm:  0.8939  memory:  9.81GiB(20.65%)  tps: 1,873  tflops: 14.64  mfu: 4.69%
[rank1]:2025-10-25 01:52:40,661 - INFO -  step: 1420  loss: -4.0000  grad_norm:  0.8939  memory: 15.15GiB(31.88%)  tps: 1,873  tflops: 14.64  mfu: 4.69%
[rank3]:2025-10-25 01:52:42,728 - INFO - Avg. fwd time: 33.7456 / Avg. bwd time: 71.2778 / Avg. batch time: 1899.7393 (ms) / GPU bubble ratio: 11.55%
[rank2]:2025-10-25 01:52:42,782 - INFO - Avg. fwd time: 17.4337 / Avg. bwd time: 28.5320 / Avg. batch time: 1971.7568 (ms) / GPU bubble ratio: 62.70%
[rank0]:2025-10-25 01:52:42,914 - INFO - Avg. fwd time: 19.4258 / Avg. bwd time: 31.6908 / Avg. batch time: 2131.8361 (ms) / GPU bubble ratio: 61.64%
[rank1]:2025-10-25 01:52:42,863 - INFO - Avg. fwd time: 22.8971 / Avg. bwd time: 41.2647 / Avg. batch time: 2077.3901 (ms) / GPU bubble ratio: 50.58%
[rank3]:2025-10-25 01:55:35,624 - INFO -  step: 1440  loss:  0.4598  grad_norm:  0.9224  memory: 26.71GiB(56.21%)  tps: 1,873  tflops: 14.64  mfu: 4.69%
[rank2]:2025-10-25 01:55:35,611 - INFO -  step: 1440  loss: -4.0000  grad_norm:  0.9224  memory:  9.81GiB(20.65%)  tps: 1,873  tflops: 14.64  mfu: 4.69%
[rank0]:2025-10-25 01:55:35,630 - INFO -  step: 1440  loss: -4.0000  grad_norm:  0.9224  memory: 17.51GiB(36.85%)  tps: 1,873  tflops: 14.64  mfu: 4.69%
[rank1]:2025-10-25 01:55:35,615 - INFO -  step: 1440  loss: -4.0000  grad_norm:  0.9224  memory: 15.15GiB(31.88%)  tps: 1,873  tflops: 14.64  mfu: 4.69%
[rank3]:2025-10-25 01:55:37,663 - INFO - Avg. fwd time: 33.7465 / Avg. bwd time: 71.2830 / Avg. batch time: 1899.8389 (ms) / GPU bubble ratio: 11.55%
[rank2]:2025-10-25 01:55:37,720 - INFO - Avg. fwd time: 17.4345 / Avg. bwd time: 28.5335 / Avg. batch time: 1971.8196 (ms) / GPU bubble ratio: 62.70%
[rank0]:2025-10-25 01:55:37,853 - INFO - Avg. fwd time: 19.4291 / Avg. bwd time: 31.6932 / Avg. batch time: 2131.8961 (ms) / GPU bubble ratio: 61.63%
[rank1]:2025-10-25 01:55:37,802 - INFO - Avg. fwd time: 22.8960 / Avg. bwd time: 41.2624 / Avg. batch time: 2077.4486 (ms) / GPU bubble ratio: 50.59%
[rank0]:2025-10-25 01:56:54,370 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-25 01:58:30,239 - INFO -  step: 1460  loss:  0.4499  grad_norm:  0.8599  memory: 26.71GiB(56.21%)  tps: 1,877  tflops: 14.67  mfu: 4.70%
[rank2]:2025-10-25 01:58:30,226 - INFO -  step: 1460  loss: -4.0000  grad_norm:  0.8599  memory:  9.81GiB(20.65%)  tps: 1,877  tflops: 14.67  mfu: 4.70%
[rank0]:2025-10-25 01:58:30,245 - INFO -  step: 1460  loss: -4.0000  grad_norm:  0.8599  memory: 17.51GiB(36.85%)  tps: 1,877  tflops: 14.67  mfu: 4.70%
[rank1]:2025-10-25 01:58:30,230 - INFO -  step: 1460  loss: -4.0000  grad_norm:  0.8599  memory: 15.15GiB(31.88%)  tps: 1,877  tflops: 14.67  mfu: 4.70%
[rank3]:2025-10-25 01:58:32,282 - INFO - Avg. fwd time: 33.7470 / Avg. bwd time: 71.2846 / Avg. batch time: 1899.8724 (ms) / GPU bubble ratio: 11.55%
[rank2]:2025-10-25 01:58:32,336 - INFO - Avg. fwd time: 17.4351 / Avg. bwd time: 28.5346 / Avg. batch time: 1971.8299 (ms) / GPU bubble ratio: 62.70%
[rank0]:2025-10-25 01:58:32,472 - INFO - Avg. fwd time: 19.4332 / Avg. bwd time: 31.6966 / Avg. batch time: 2131.9056 (ms) / GPU bubble ratio: 61.63%
[rank1]:2025-10-25 01:58:32,418 - INFO - Avg. fwd time: 22.8973 / Avg. bwd time: 41.2638 / Avg. batch time: 2077.4539 (ms) / GPU bubble ratio: 50.58%
[rank2]:2025-10-25 02:01:24,834 - INFO -  step: 1480  loss: -4.0000  grad_norm:  0.8054  memory:  9.81GiB(20.65%)  tps: 1,877  tflops: 14.67  mfu: 4.70%
[rank1]:2025-10-25 02:01:24,841 - INFO -  step: 1480  loss: -4.0000  grad_norm:  0.8054  memory: 15.15GiB(31.88%)  tps: 1,877  tflops: 14.67  mfu: 4.70%
[rank3]:2025-10-25 02:01:24,847 - INFO -  step: 1480  loss:  0.4313  grad_norm:  0.8054  memory: 26.71GiB(56.21%)  tps: 1,877  tflops: 14.67  mfu: 4.70%
[rank0]:2025-10-25 02:01:24,851 - INFO -  step: 1480  loss: -4.0000  grad_norm:  0.8054  memory: 17.51GiB(36.85%)  tps: 1,877  tflops: 14.67  mfu: 4.70%
[rank3]:2025-10-25 02:01:26,897 - INFO - Avg. fwd time: 33.7484 / Avg. bwd time: 71.2856 / Avg. batch time: 1899.9129 (ms) / GPU bubble ratio: 11.55%
[rank2]:2025-10-25 02:01:26,945 - INFO - Avg. fwd time: 17.4353 / Avg. bwd time: 28.5353 / Avg. batch time: 1971.8453 (ms) / GPU bubble ratio: 62.70%
[rank1]:2025-10-25 02:01:27,023 - INFO - Avg. fwd time: 22.8970 / Avg. bwd time: 41.2609 / Avg. batch time: 2077.4577 (ms) / GPU bubble ratio: 50.59%
[rank0]:2025-10-25 02:01:27,076 - INFO - Avg. fwd time: 19.4358 / Avg. bwd time: 31.6982 / Avg. batch time: 2131.9124 (ms) / GPU bubble ratio: 61.62%
[rank3]:2025-10-25 02:01:37,016 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 02:01:37,924 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 02:01:38,015 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 02:01:37,981 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 02:04:10,725 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-25 02:04:19,422 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.8664  memory:  9.81GiB(20.65%)  tps: 1,877  tflops: 14.67  mfu: 4.70%
[rank2]:2025-10-25 02:04:19,423 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-25 02:04:19,426 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.8664  memory: 15.15GiB(31.88%)  tps: 1,877  tflops: 14.67  mfu: 4.70%
[rank1]:2025-10-25 02:04:19,426 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-25 02:04:19,435 - INFO -  step: 1500  loss:  0.4365  grad_norm:  0.8664  memory: 26.71GiB(56.21%)  tps: 1,877  tflops: 14.67  mfu: 4.70%
[rank3]:2025-10-25 02:04:19,435 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-25 02:04:19,441 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.8664  memory: 17.51GiB(36.85%)  tps: 1,877  tflops: 14.67  mfu: 4.70%
[rank0]:2025-10-25 02:04:19,441 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-25 02:04:19,443 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank2]:2025-10-25 02:04:21,287 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 1.86 seconds.
[rank1]:2025-10-25 02:04:21,767 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 2.34 seconds.
[rank3]:2025-10-25 02:04:23,101 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.67 seconds.
[rank0]:2025-10-25 02:04:23,854 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-25 02:04:23,862 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 4.42 seconds.
[rank0]:2025-10-25 02:04:23,862 - INFO - Checkpointer is deleting /data2/shcho/torchtitan/checkpoint/1023_Interleaved1F1B_nofreeze_dm1/step-500.
[rank3]:2025-10-25 02:04:24,460 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_nofreeze_dm1/pipeline_schedule/251025_0204_real_step1500_rank3.svg
[rank3]:> Batch Time: 1912.06 ms, GPU Bubble Ratio: 57.10%, 46.48%, 61.82%, 12.20%
[rank0]:2025-10-25 02:04:25,959 - INFO - Checkpointer deleted /data2/shcho/torchtitan/checkpoint/1023_Interleaved1F1B_nofreeze_dm1/step-500 in 2.10 seconds.
[rank3]:2025-10-25 02:04:26,427 - INFO - Avg. fwd time: 33.7488 / Avg. bwd time: 71.2875 / Avg. batch time: 1899.9503 (ms) / GPU bubble ratio: 11.55%
[rank2]:2025-10-25 02:04:26,488 - INFO - Avg. fwd time: 17.4362 / Avg. bwd time: 28.5380 / Avg. batch time: 1971.9333 (ms) / GPU bubble ratio: 62.70%
[rank1]:2025-10-25 02:04:26,565 - INFO - Avg. fwd time: 22.8971 / Avg. bwd time: 41.2616 / Avg. batch time: 2077.5409 (ms) / GPU bubble ratio: 50.59%
[rank0]:2025-10-25 02:04:26,619 - INFO - Avg. fwd time: 19.4386 / Avg. bwd time: 31.7020 / Avg. batch time: 2131.9990 (ms) / GPU bubble ratio: 61.62%
[rank1]:2025-10-25 02:07:19,079 - INFO -  step: 1520  loss: -4.0000  grad_norm:  0.8315  memory: 15.15GiB(31.88%)  tps: 1,824  tflops: 14.26  mfu: 4.57%
[rank2]:2025-10-25 02:07:19,068 - INFO -  step: 1520  loss: -4.0000  grad_norm:  0.8315  memory:  9.81GiB(20.65%)  tps: 1,824  tflops: 14.26  mfu: 4.57%
[rank0]:2025-10-25 02:07:19,084 - INFO -  step: 1520  loss: -4.0000  grad_norm:  0.8315  memory: 17.51GiB(36.85%)  tps: 1,824  tflops: 14.26  mfu: 4.57%
[rank3]:2025-10-25 02:07:19,081 - INFO -  step: 1520  loss:  0.4436  grad_norm:  0.8315  memory: 26.71GiB(56.21%)  tps: 1,824  tflops: 14.26  mfu: 4.57%
[rank3]:2025-10-25 02:07:21,117 - INFO - Avg. fwd time: 33.7496 / Avg. bwd time: 71.2888 / Avg. batch time: 1899.9805 (ms) / GPU bubble ratio: 11.55%
[rank2]:2025-10-25 02:07:21,169 - INFO - Avg. fwd time: 17.4368 / Avg. bwd time: 28.5398 / Avg. batch time: 1971.9417 (ms) / GPU bubble ratio: 62.70%
[rank1]:2025-10-25 02:07:21,251 - INFO - Avg. fwd time: 22.8967 / Avg. bwd time: 41.2615 / Avg. batch time: 2077.5423 (ms) / GPU bubble ratio: 50.59%
[rank0]:2025-10-25 02:07:21,308 - INFO - Avg. fwd time: 19.4402 / Avg. bwd time: 31.7031 / Avg. batch time: 2132.0014 (ms) / GPU bubble ratio: 61.62%
[rank1]:2025-10-25 02:10:14,242 - INFO -  step: 1540  loss: -4.0000  grad_norm:  0.8627  memory: 15.15GiB(31.88%)  tps: 1,871  tflops: 14.62  mfu: 4.69%
[rank3]:2025-10-25 02:10:14,251 - INFO -  step: 1540  loss:  0.4280  grad_norm:  0.8627  memory: 26.71GiB(56.21%)  tps: 1,871  tflops: 14.62  mfu: 4.69%
[rank0]:2025-10-25 02:10:14,258 - INFO -  step: 1540  loss: -4.0000  grad_norm:  0.8627  memory: 17.51GiB(36.85%)  tps: 1,871  tflops: 14.62  mfu: 4.69%
[rank2]:2025-10-25 02:10:14,239 - INFO -  step: 1540  loss: -4.0000  grad_norm:  0.8627  memory:  9.81GiB(20.65%)  tps: 1,871  tflops: 14.62  mfu: 4.69%
[rank3]:2025-10-25 02:10:16,273 - INFO - Avg. fwd time: 33.7521 / Avg. bwd time: 71.2927 / Avg. batch time: 1900.0874 (ms) / GPU bubble ratio: 11.55%
[rank2]:2025-10-25 02:10:16,325 - INFO - Avg. fwd time: 17.4379 / Avg. bwd time: 28.5415 / Avg. batch time: 1972.0179 (ms) / GPU bubble ratio: 62.69%
[rank1]:2025-10-25 02:10:16,409 - INFO - Avg. fwd time: 22.8980 / Avg. bwd time: 41.2634 / Avg. batch time: 2077.6170 (ms) / GPU bubble ratio: 50.59%
[rank0]:2025-10-25 02:10:16,463 - INFO - Avg. fwd time: 19.4408 / Avg. bwd time: 31.7051 / Avg. batch time: 2132.0819 (ms) / GPU bubble ratio: 61.62%
[rank0]:2025-10-25 02:11:33,189 - INFO - [GC] Peforming periodical GC collection 0.25 seconds
[rank1]:2025-10-25 02:13:09,342 - INFO -  step: 1560  loss: -4.0000  grad_norm:  0.8373  memory: 15.15GiB(31.88%)  tps: 1,871  tflops: 14.63  mfu: 4.69%
[rank0]:2025-10-25 02:13:09,355 - INFO -  step: 1560  loss: -4.0000  grad_norm:  0.8373  memory: 17.51GiB(36.85%)  tps: 1,871  tflops: 14.63  mfu: 4.69%
[rank3]:2025-10-25 02:13:09,350 - INFO -  step: 1560  loss:  0.4152  grad_norm:  0.8373  memory: 26.71GiB(56.21%)  tps: 1,871  tflops: 14.63  mfu: 4.69%
[rank2]:2025-10-25 02:13:09,338 - INFO -  step: 1560  loss: -4.0000  grad_norm:  0.8373  memory:  9.81GiB(20.65%)  tps: 1,871  tflops: 14.63  mfu: 4.69%
[rank3]:2025-10-25 02:13:11,374 - INFO - Avg. fwd time: 33.7530 / Avg. bwd time: 71.2958 / Avg. batch time: 1900.1481 (ms) / GPU bubble ratio: 11.54%
[rank1]:2025-10-25 02:13:11,498 - INFO - Avg. fwd time: 22.8979 / Avg. bwd time: 41.2649 / Avg. batch time: 2077.6578 (ms) / GPU bubble ratio: 50.59%
[rank2]:2025-10-25 02:13:11,423 - INFO - Avg. fwd time: 17.4383 / Avg. bwd time: 28.5428 / Avg. batch time: 1972.0582 (ms) / GPU bubble ratio: 62.69%
[rank0]:2025-10-25 02:13:11,550 - INFO - Avg. fwd time: 19.4426 / Avg. bwd time: 31.7048 / Avg. batch time: 2132.1183 (ms) / GPU bubble ratio: 61.62%
[rank3]:2025-10-25 02:13:43,469 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 02:13:44,342 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 02:13:44,435 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 02:13:44,398 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 02:16:04,610 - INFO -  step: 1580  loss: -4.0000  grad_norm:  0.7838  memory: 17.51GiB(36.85%)  tps: 1,870  tflops: 14.62  mfu: 4.68%
[rank1]:2025-10-25 02:16:04,598 - INFO -  step: 1580  loss: -4.0000  grad_norm:  0.7838  memory: 15.15GiB(31.88%)  tps: 1,870  tflops: 14.62  mfu: 4.68%
[rank3]:2025-10-25 02:16:04,606 - INFO -  step: 1580  loss:  0.4134  grad_norm:  0.7838  memory: 26.71GiB(56.21%)  tps: 1,870  tflops: 14.62  mfu: 4.68%
[rank2]:2025-10-25 02:16:04,594 - INFO -  step: 1580  loss: -4.0000  grad_norm:  0.7838  memory:  9.81GiB(20.65%)  tps: 1,870  tflops: 14.62  mfu: 4.68%
[rank3]:2025-10-25 02:16:06,642 - INFO - Avg. fwd time: 33.7565 / Avg. bwd time: 71.3011 / Avg. batch time: 1900.2881 (ms) / GPU bubble ratio: 11.54%
[rank2]:2025-10-25 02:16:06,697 - INFO - Avg. fwd time: 17.4388 / Avg. bwd time: 28.5436 / Avg. batch time: 1972.1773 (ms) / GPU bubble ratio: 62.70%
[rank1]:2025-10-25 02:16:06,779 - INFO - Avg. fwd time: 22.8977 / Avg. bwd time: 41.2666 / Avg. batch time: 2077.7682 (ms) / GPU bubble ratio: 50.59%
[rank0]:2025-10-25 02:16:06,833 - INFO - Avg. fwd time: 19.4453 / Avg. bwd time: 31.7075 / Avg. batch time: 2132.2342 (ms) / GPU bubble ratio: 61.62%
[rank0]:2025-10-25 02:18:50,815 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-25 02:18:59,621 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.9463  memory: 15.15GiB(31.88%)  tps: 1,872  tflops: 14.64  mfu: 4.69%
[rank3]:2025-10-25 02:18:59,629 - INFO -  step: 1600  loss:  0.4280  grad_norm:  0.9463  memory: 26.71GiB(56.21%)  tps: 1,872  tflops: 14.64  mfu: 4.69%
[rank2]:2025-10-25 02:18:59,617 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.9463  memory:  9.81GiB(20.65%)  tps: 1,872  tflops: 14.64  mfu: 4.69%
[rank0]:2025-10-25 02:18:59,637 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.9463  memory: 17.51GiB(36.85%)  tps: 1,872  tflops: 14.64  mfu: 4.69%
[rank3]:2025-10-25 02:19:00,038 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_nofreeze_dm1/pipeline_schedule/251025_0218_real_step1600_rank3.svg
[rank3]:> Batch Time: 1912.33 ms, GPU Bubble Ratio: 57.10%, 46.47%, 61.82%, 12.20%
[rank3]:2025-10-25 02:19:02,009 - INFO - Avg. fwd time: 33.7581 / Avg. bwd time: 71.3047 / Avg. batch time: 1900.3733 (ms) / GPU bubble ratio: 11.54%
[rank2]:2025-10-25 02:19:02,066 - INFO - Avg. fwd time: 17.4391 / Avg. bwd time: 28.5442 / Avg. batch time: 1972.2816 (ms) / GPU bubble ratio: 62.70%
[rank1]:2025-10-25 02:19:02,149 - INFO - Avg. fwd time: 22.8976 / Avg. bwd time: 41.2655 / Avg. batch time: 2077.8652 (ms) / GPU bubble ratio: 50.59%
[rank0]:2025-10-25 02:19:02,201 - INFO - Avg. fwd time: 19.4463 / Avg. bwd time: 31.7078 / Avg. batch time: 2132.3325 (ms) / GPU bubble ratio: 61.62%
[rank2]:2025-10-25 02:21:54,635 - INFO -  step: 1620  loss: -4.0000  grad_norm:  0.8269  memory:  9.81GiB(20.65%)  tps: 1,872  tflops: 14.64  mfu: 4.69%
[rank0]:2025-10-25 02:21:54,654 - INFO -  step: 1620  loss: -4.0000  grad_norm:  0.8269  memory: 17.51GiB(36.85%)  tps: 1,872  tflops: 14.64  mfu: 4.69%
[rank1]:2025-10-25 02:21:54,645 - INFO -  step: 1620  loss: -4.0000  grad_norm:  0.8269  memory: 15.15GiB(31.88%)  tps: 1,872  tflops: 14.64  mfu: 4.69%
[rank3]:2025-10-25 02:21:54,647 - INFO -  step: 1620  loss:  0.4090  grad_norm:  0.8269  memory: 26.71GiB(56.21%)  tps: 1,872  tflops: 14.64  mfu: 4.69%
[rank3]:2025-10-25 02:21:56,701 - INFO - Avg. fwd time: 33.7586 / Avg. bwd time: 71.3065 / Avg. batch time: 1900.4058 (ms) / GPU bubble ratio: 11.54%
[rank2]:2025-10-25 02:21:56,751 - INFO - Avg. fwd time: 17.4392 / Avg. bwd time: 28.5445 / Avg. batch time: 1972.2997 (ms) / GPU bubble ratio: 62.70%
[rank1]:2025-10-25 02:21:56,827 - INFO - Avg. fwd time: 22.8968 / Avg. bwd time: 41.2668 / Avg. batch time: 2077.8787 (ms) / GPU bubble ratio: 50.59%
[rank0]:2025-10-25 02:21:56,882 - INFO - Avg. fwd time: 19.4472 / Avg. bwd time: 31.7077 / Avg. batch time: 2132.3435 (ms) / GPU bubble ratio: 61.62%
[rank2]:2025-10-25 02:24:50,013 - INFO -  step: 1640  loss: -4.0000  grad_norm:  0.9276  memory:  9.81GiB(20.65%)  tps: 1,868  tflops: 14.61  mfu: 4.68%
[rank1]:2025-10-25 02:24:50,016 - INFO -  step: 1640  loss: -4.0000  grad_norm:  0.9276  memory: 15.15GiB(31.88%)  tps: 1,868  tflops: 14.61  mfu: 4.68%
[rank3]:2025-10-25 02:24:50,025 - INFO -  step: 1640  loss:  0.3982  grad_norm:  0.9276  memory: 26.71GiB(56.21%)  tps: 1,868  tflops: 14.61  mfu: 4.68%
[rank0]:2025-10-25 02:24:50,028 - INFO -  step: 1640  loss: -4.0000  grad_norm:  0.9276  memory: 17.51GiB(36.85%)  tps: 1,868  tflops: 14.61  mfu: 4.68%
[rank2]:2025-10-25 02:24:52,131 - INFO - Avg. fwd time: 17.4396 / Avg. bwd time: 28.5456 / Avg. batch time: 1972.4059 (ms) / GPU bubble ratio: 62.70%
[rank3]:2025-10-25 02:24:52,069 - INFO - Avg. fwd time: 33.7608 / Avg. bwd time: 71.3106 / Avg. batch time: 1900.5111 (ms) / GPU bubble ratio: 11.54%
[rank1]:2025-10-25 02:24:52,214 - INFO - Avg. fwd time: 22.8965 / Avg. bwd time: 41.2714 / Avg. batch time: 2077.9911 (ms) / GPU bubble ratio: 50.59%
[rank0]:2025-10-25 02:24:52,268 - INFO - Avg. fwd time: 19.4500 / Avg. bwd time: 31.7091 / Avg. batch time: 2132.4557 (ms) / GPU bubble ratio: 61.61%
[rank3]:2025-10-25 02:25:43,661 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 02:25:44,569 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 02:25:44,661 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 02:25:44,626 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 02:26:08,656 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-25 02:27:44,648 - INFO -  step: 1660  loss: -4.0000  grad_norm:  0.7844  memory: 15.15GiB(31.88%)  tps: 1,876  tflops: 14.67  mfu: 4.70%
[rank2]:2025-10-25 02:27:44,645 - INFO -  step: 1660  loss: -4.0000  grad_norm:  0.7844  memory:  9.81GiB(20.65%)  tps: 1,876  tflops: 14.67  mfu: 4.70%
[rank3]:2025-10-25 02:27:44,657 - INFO -  step: 1660  loss:  0.4017  grad_norm:  0.7844  memory: 26.71GiB(56.21%)  tps: 1,876  tflops: 14.67  mfu: 4.70%
[rank0]:2025-10-25 02:27:44,662 - INFO -  step: 1660  loss: -4.0000  grad_norm:  0.7844  memory: 17.51GiB(36.85%)  tps: 1,876  tflops: 14.67  mfu: 4.70%
[rank2]:2025-10-25 02:27:46,759 - INFO - Avg. fwd time: 17.4401 / Avg. bwd time: 28.5474 / Avg. batch time: 1972.4239 (ms) / GPU bubble ratio: 62.70%
[rank3]:2025-10-25 02:27:46,693 - INFO - Avg. fwd time: 33.7620 / Avg. bwd time: 71.3125 / Avg. batch time: 1900.5581 (ms) / GPU bubble ratio: 11.54%
[rank1]:2025-10-25 02:27:46,843 - INFO - Avg. fwd time: 22.8960 / Avg. bwd time: 41.2699 / Avg. batch time: 2077.9992 (ms) / GPU bubble ratio: 50.59%
[rank0]:2025-10-25 02:27:46,896 - INFO - Avg. fwd time: 19.4495 / Avg. bwd time: 31.7116 / Avg. batch time: 2132.4651 (ms) / GPU bubble ratio: 61.61%
[rank3]:2025-10-25 02:30:39,771 - INFO -  step: 1680  loss:  0.4071  grad_norm:  0.8109  memory: 26.71GiB(56.21%)  tps: 1,871  tflops: 14.63  mfu: 4.69%
[rank2]:2025-10-25 02:30:39,759 - INFO -  step: 1680  loss: -4.0000  grad_norm:  0.8109  memory:  9.81GiB(20.65%)  tps: 1,871  tflops: 14.63  mfu: 4.69%
[rank1]:2025-10-25 02:30:39,770 - INFO -  step: 1680  loss: -4.0000  grad_norm:  0.8109  memory: 15.15GiB(31.88%)  tps: 1,871  tflops: 14.63  mfu: 4.69%
[rank0]:2025-10-25 02:30:39,778 - INFO -  step: 1680  loss: -4.0000  grad_norm:  0.8109  memory: 17.51GiB(36.85%)  tps: 1,871  tflops: 14.63  mfu: 4.69%
[rank3]:2025-10-25 02:30:41,823 - INFO - Avg. fwd time: 33.7643 / Avg. bwd time: 71.3166 / Avg. batch time: 1900.6609 (ms) / GPU bubble ratio: 11.54%
[rank2]:2025-10-25 02:30:41,883 - INFO - Avg. fwd time: 17.4402 / Avg. bwd time: 28.5466 / Avg. batch time: 1972.5009 (ms) / GPU bubble ratio: 62.70%
[rank1]:2025-10-25 02:30:41,965 - INFO - Avg. fwd time: 22.8957 / Avg. bwd time: 41.2710 / Avg. batch time: 2078.0730 (ms) / GPU bubble ratio: 50.60%
[rank0]:2025-10-25 02:30:42,019 - INFO - Avg. fwd time: 19.4519 / Avg. bwd time: 31.7138 / Avg. batch time: 2132.5397 (ms) / GPU bubble ratio: 61.61%
[rank0]:2025-10-25 02:33:26,016 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-25 02:33:34,790 - INFO -  step: 1700  loss:  0.3945  grad_norm:  0.8061  memory: 26.71GiB(56.21%)  tps: 1,872  tflops: 14.64  mfu: 4.69%
[rank1]:2025-10-25 02:33:34,785 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.8061  memory: 15.15GiB(31.88%)  tps: 1,872  tflops: 14.64  mfu: 4.69%
[rank2]:2025-10-25 02:33:34,778 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.8061  memory:  9.81GiB(20.65%)  tps: 1,872  tflops: 14.64  mfu: 4.69%
[rank0]:2025-10-25 02:33:34,796 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.8061  memory: 17.51GiB(36.85%)  tps: 1,872  tflops: 14.64  mfu: 4.69%
[rank3]:2025-10-25 02:33:35,181 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_nofreeze_dm1/pipeline_schedule/251025_0233_real_step1700_rank3.svg
[rank3]:> Batch Time: 1912.75 ms, GPU Bubble Ratio: 57.09%, 46.46%, 61.83%, 12.20%
[rank3]:2025-10-25 02:33:37,157 - INFO - Avg. fwd time: 33.7653 / Avg. bwd time: 71.3195 / Avg. batch time: 1900.7269 (ms) / GPU bubble ratio: 11.54%
[rank2]:2025-10-25 02:33:37,208 - INFO - Avg. fwd time: 17.4410 / Avg. bwd time: 28.5479 / Avg. batch time: 1972.5994 (ms) / GPU bubble ratio: 62.70%
[rank1]:2025-10-25 02:33:37,288 - INFO - Avg. fwd time: 22.8952 / Avg. bwd time: 41.2713 / Avg. batch time: 2078.1733 (ms) / GPU bubble ratio: 50.60%
[rank0]:2025-10-25 02:33:37,340 - INFO - Avg. fwd time: 19.4540 / Avg. bwd time: 31.7166 / Avg. batch time: 2132.6381 (ms) / GPU bubble ratio: 61.61%
[rank0]:2025-10-25 02:36:30,100 - INFO -  step: 1720  loss: -4.0000  grad_norm:  0.7862  memory: 17.51GiB(36.85%)  tps: 1,869  tflops: 14.61  mfu: 4.68%
[rank1]:2025-10-25 02:36:30,088 - INFO -  step: 1720  loss: -4.0000  grad_norm:  0.7862  memory: 15.15GiB(31.88%)  tps: 1,869  tflops: 14.61  mfu: 4.68%
[rank2]:2025-10-25 02:36:30,085 - INFO -  step: 1720  loss: -4.0000  grad_norm:  0.7862  memory:  9.81GiB(20.65%)  tps: 1,869  tflops: 14.61  mfu: 4.68%
[rank3]:2025-10-25 02:36:30,098 - INFO -  step: 1720  loss:  0.3965  grad_norm:  0.7862  memory: 26.71GiB(56.21%)  tps: 1,869  tflops: 14.61  mfu: 4.68%
[rank3]:2025-10-25 02:36:32,133 - INFO - Avg. fwd time: 33.7663 / Avg. bwd time: 71.3222 / Avg. batch time: 1900.7883 (ms) / GPU bubble ratio: 11.54%
[rank2]:2025-10-25 02:36:32,194 - INFO - Avg. fwd time: 17.4411 / Avg. bwd time: 28.5486 / Avg. batch time: 1972.6508 (ms) / GPU bubble ratio: 62.70%
[rank0]:2025-10-25 02:36:32,330 - INFO - Avg. fwd time: 19.4567 / Avg. bwd time: 31.7201 / Avg. batch time: 2132.6926 (ms) / GPU bubble ratio: 61.61%
[rank1]:2025-10-25 02:36:32,276 - INFO - Avg. fwd time: 22.8949 / Avg. bwd time: 41.2741 / Avg. batch time: 2078.2305 (ms) / GPU bubble ratio: 50.60%
[rank3]:2025-10-25 02:37:43,634 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 02:37:44,551 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 02:37:44,606 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 02:37:44,641 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 02:39:25,030 - INFO -  step: 1740  loss: -4.0000  grad_norm:  0.7853  memory: 17.51GiB(36.85%)  tps: 1,873  tflops: 14.64  mfu: 4.69%
[rank1]:2025-10-25 02:39:25,023 - INFO -  step: 1740  loss: -4.0000  grad_norm:  0.7853  memory: 15.15GiB(31.88%)  tps: 1,873  tflops: 14.64  mfu: 4.69%
[rank2]:2025-10-25 02:39:25,013 - INFO -  step: 1740  loss: -4.0000  grad_norm:  0.7853  memory:  9.81GiB(20.65%)  tps: 1,873  tflops: 14.64  mfu: 4.69%
[rank3]:2025-10-25 02:39:25,025 - INFO -  step: 1740  loss:  0.4022  grad_norm:  0.7853  memory: 26.71GiB(56.21%)  tps: 1,873  tflops: 14.64  mfu: 4.69%
[rank3]:2025-10-25 02:39:27,073 - INFO - Avg. fwd time: 33.7679 / Avg. bwd time: 71.3252 / Avg. batch time: 1900.8624 (ms) / GPU bubble ratio: 11.54%
[rank2]:2025-10-25 02:39:27,126 - INFO - Avg. fwd time: 17.4414 / Avg. bwd time: 28.5488 / Avg. batch time: 1972.7087 (ms) / GPU bubble ratio: 62.70%
[rank0]:2025-10-25 02:39:27,265 - INFO - Avg. fwd time: 19.4591 / Avg. bwd time: 31.7219 / Avg. batch time: 2132.7421 (ms) / GPU bubble ratio: 61.60%
[rank1]:2025-10-25 02:39:27,210 - INFO - Avg. fwd time: 22.8938 / Avg. bwd time: 41.2744 / Avg. batch time: 2078.2853 (ms) / GPU bubble ratio: 50.60%
[rank0]:2025-10-25 02:40:43,585 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-25 02:42:19,594 - INFO -  step: 1760  loss: -4.0000  grad_norm:  0.7770  memory: 15.15GiB(31.88%)  tps: 1,877  tflops: 14.67  mfu: 4.70%
[rank0]:2025-10-25 02:42:19,606 - INFO -  step: 1760  loss: -4.0000  grad_norm:  0.7770  memory: 17.51GiB(36.85%)  tps: 1,877  tflops: 14.67  mfu: 4.70%
[rank2]:2025-10-25 02:42:19,591 - INFO -  step: 1760  loss: -4.0000  grad_norm:  0.7770  memory:  9.81GiB(20.65%)  tps: 1,877  tflops: 14.67  mfu: 4.70%
[rank3]:2025-10-25 02:42:19,603 - INFO -  step: 1760  loss:  0.4138  grad_norm:  0.7770  memory: 26.71GiB(56.21%)  tps: 1,877  tflops: 14.67  mfu: 4.70%
[rank3]:2025-10-25 02:42:21,639 - INFO - Avg. fwd time: 33.7674 / Avg. bwd time: 71.3262 / Avg. batch time: 1900.8680 (ms) / GPU bubble ratio: 11.54%
[rank2]:2025-10-25 02:42:21,693 - INFO - Avg. fwd time: 17.4414 / Avg. bwd time: 28.5488 / Avg. batch time: 1972.7000 (ms) / GPU bubble ratio: 62.70%
[rank1]:2025-10-25 02:42:21,770 - INFO - Avg. fwd time: 22.8929 / Avg. bwd time: 41.2755 / Avg. batch time: 2078.2746 (ms) / GPU bubble ratio: 50.60%
[rank0]:2025-10-25 02:42:21,824 - INFO - Avg. fwd time: 19.4627 / Avg. bwd time: 31.7248 / Avg. batch time: 2132.7287 (ms) / GPU bubble ratio: 61.60%
[rank3]:2025-10-25 02:45:14,790 - INFO -  step: 1780  loss:  0.3900  grad_norm:  0.8335  memory: 26.71GiB(56.21%)  tps: 1,870  tflops: 14.62  mfu: 4.69%
[rank1]:2025-10-25 02:45:14,781 - INFO -  step: 1780  loss: -4.0000  grad_norm:  0.8335  memory: 15.15GiB(31.88%)  tps: 1,870  tflops: 14.62  mfu: 4.69%
[rank0]:2025-10-25 02:45:14,792 - INFO -  step: 1780  loss: -4.0000  grad_norm:  0.8335  memory: 17.51GiB(36.85%)  tps: 1,870  tflops: 14.62  mfu: 4.69%
[rank2]:2025-10-25 02:45:14,778 - INFO -  step: 1780  loss: -4.0000  grad_norm:  0.8335  memory:  9.81GiB(20.65%)  tps: 1,870  tflops: 14.62  mfu: 4.69%
[rank3]:2025-10-25 02:45:16,830 - INFO - Avg. fwd time: 33.7693 / Avg. bwd time: 71.3302 / Avg. batch time: 1900.9644 (ms) / GPU bubble ratio: 11.54%
[rank2]:2025-10-25 02:45:16,885 - INFO - Avg. fwd time: 17.4422 / Avg. bwd time: 28.5503 / Avg. batch time: 1972.7800 (ms) / GPU bubble ratio: 62.70%
[rank1]:2025-10-25 02:45:16,959 - INFO - Avg. fwd time: 22.8917 / Avg. bwd time: 41.2770 / Avg. batch time: 2078.3567 (ms) / GPU bubble ratio: 50.60%
[rank0]:2025-10-25 02:45:17,014 - INFO - Avg. fwd time: 19.4661 / Avg. bwd time: 31.7282 / Avg. batch time: 2132.8069 (ms) / GPU bubble ratio: 61.59%
[rank0]:2025-10-25 02:48:00,396 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-25 02:48:09,084 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.7642  memory:  9.81GiB(20.65%)  tps: 1,880  tflops: 14.70  mfu: 4.71%
[rank1]:2025-10-25 02:48:09,088 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.7642  memory: 15.15GiB(31.88%)  tps: 1,880  tflops: 14.70  mfu: 4.71%
[rank3]:2025-10-25 02:48:09,096 - INFO -  step: 1800  loss:  0.3869  grad_norm:  0.7642  memory: 26.71GiB(56.21%)  tps: 1,880  tflops: 14.70  mfu: 4.71%
[rank0]:2025-10-25 02:48:09,102 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.7642  memory: 17.51GiB(36.85%)  tps: 1,880  tflops: 14.70  mfu: 4.71%
[rank3]:2025-10-25 02:48:09,486 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_nofreeze_dm1/pipeline_schedule/251025_0248_real_step1800_rank3.svg
[rank3]:> Batch Time: 1913.11 ms, GPU Bubble Ratio: 57.07%, 46.45%, 61.83%, 12.19%
[rank2]:2025-10-25 02:48:11,497 - INFO - Avg. fwd time: 17.4425 / Avg. bwd time: 28.5509 / Avg. batch time: 1972.7668 (ms) / GPU bubble ratio: 62.70%
[rank3]:2025-10-25 02:48:11,440 - INFO - Avg. fwd time: 33.7689 / Avg. bwd time: 71.3284 / Avg. batch time: 1900.9265 (ms) / GPU bubble ratio: 11.54%
[rank1]:2025-10-25 02:48:11,570 - INFO - Avg. fwd time: 22.8907 / Avg. bwd time: 41.2787 / Avg. batch time: 2078.3470 (ms) / GPU bubble ratio: 50.60%
[rank0]:2025-10-25 02:48:11,623 - INFO - Avg. fwd time: 19.4658 / Avg. bwd time: 31.7291 / Avg. batch time: 2132.7996 (ms) / GPU bubble ratio: 61.59%
[rank3]:2025-10-25 02:49:42,243 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 02:49:43,150 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 02:49:43,208 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 02:49:43,243 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 02:51:04,006 - INFO -  step: 1820  loss: -4.0000  grad_norm:  0.8075  memory:  9.81GiB(20.65%)  tps: 1,873  tflops: 14.64  mfu: 4.69%
[rank1]:2025-10-25 02:51:04,010 - INFO -  step: 1820  loss: -4.0000  grad_norm:  0.8075  memory: 15.15GiB(31.88%)  tps: 1,873  tflops: 14.64  mfu: 4.69%
[rank3]:2025-10-25 02:51:04,018 - INFO -  step: 1820  loss:  0.3907  grad_norm:  0.8075  memory: 26.71GiB(56.21%)  tps: 1,873  tflops: 14.64  mfu: 4.69%
[rank0]:2025-10-25 02:51:04,025 - INFO -  step: 1820  loss: -4.0000  grad_norm:  0.8075  memory: 17.51GiB(36.85%)  tps: 1,873  tflops: 14.64  mfu: 4.69%
[rank3]:2025-10-25 02:51:06,065 - INFO - Avg. fwd time: 33.7692 / Avg. bwd time: 71.3289 / Avg. batch time: 1900.9410 (ms) / GPU bubble ratio: 11.54%
[rank2]:2025-10-25 02:51:06,123 - INFO - Avg. fwd time: 17.4428 / Avg. bwd time: 28.5517 / Avg. batch time: 1972.7673 (ms) / GPU bubble ratio: 62.70%
[rank1]:2025-10-25 02:51:06,208 - INFO - Avg. fwd time: 22.8911 / Avg. bwd time: 41.2803 / Avg. batch time: 2078.3511 (ms) / GPU bubble ratio: 50.60%
[rank0]:2025-10-25 02:51:06,264 - INFO - Avg. fwd time: 19.4651 / Avg. bwd time: 31.7293 / Avg. batch time: 2132.8047 (ms) / GPU bubble ratio: 61.59%
[rank2]:2025-10-25 02:53:59,328 - INFO -  step: 1840  loss: -4.0000  grad_norm:  0.8838  memory:  9.81GiB(20.65%)  tps: 1,869  tflops: 14.61  mfu: 4.68%
[rank1]:2025-10-25 02:53:59,332 - INFO -  step: 1840  loss: -4.0000  grad_norm:  0.8838  memory: 15.15GiB(31.88%)  tps: 1,869  tflops: 14.61  mfu: 4.68%
[rank3]:2025-10-25 02:53:59,399 - INFO -  step: 1840  loss:  0.3926  grad_norm:  0.8838  memory: 26.71GiB(56.21%)  tps: 1,868  tflops: 14.61  mfu: 4.68%
[rank0]:2025-10-25 02:53:59,354 - INFO -  step: 1840  loss: -4.0000  grad_norm:  0.8838  memory: 17.51GiB(36.85%)  tps: 1,869  tflops: 14.61  mfu: 4.68%
[rank3]:2025-10-25 02:54:01,386 - INFO - Avg. fwd time: 33.7708 / Avg. bwd time: 71.3321 / Avg. batch time: 1901.0171 (ms) / GPU bubble ratio: 11.54%
[rank2]:2025-10-25 02:54:01,448 - INFO - Avg. fwd time: 17.4433 / Avg. bwd time: 28.5526 / Avg. batch time: 1972.8404 (ms) / GPU bubble ratio: 62.70%
[rank1]:2025-10-25 02:54:01,531 - INFO - Avg. fwd time: 22.8913 / Avg. bwd time: 41.2846 / Avg. batch time: 2078.4400 (ms) / GPU bubble ratio: 50.60%
[rank0]:2025-10-25 02:54:01,586 - INFO - Avg. fwd time: 19.4665 / Avg. bwd time: 31.7300 / Avg. batch time: 2132.8915 (ms) / GPU bubble ratio: 61.59%
[rank0]:2025-10-25 02:55:17,839 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-25 02:56:54,145 - INFO -  step: 1860  loss: -4.0000  grad_norm:  0.7532  memory:  9.81GiB(20.65%)  tps: 1,874  tflops: 14.65  mfu: 4.70%
[rank3]:2025-10-25 02:56:54,157 - INFO -  step: 1860  loss:  0.4076  grad_norm:  0.7532  memory: 26.71GiB(56.21%)  tps: 1,875  tflops: 14.66  mfu: 4.70%
[rank1]:2025-10-25 02:56:54,149 - INFO -  step: 1860  loss: -4.0000  grad_norm:  0.7532  memory: 15.15GiB(31.88%)  tps: 1,874  tflops: 14.65  mfu: 4.70%
[rank0]:2025-10-25 02:56:54,161 - INFO -  step: 1860  loss: -4.0000  grad_norm:  0.7532  memory: 17.51GiB(36.85%)  tps: 1,875  tflops: 14.65  mfu: 4.70%
[rank3]:2025-10-25 02:56:56,203 - INFO - Avg. fwd time: 33.7713 / Avg. bwd time: 71.3337 / Avg. batch time: 1901.0494 (ms) / GPU bubble ratio: 11.54%
[rank2]:2025-10-25 02:56:56,255 - INFO - Avg. fwd time: 17.4435 / Avg. bwd time: 28.5535 / Avg. batch time: 1972.8514 (ms) / GPU bubble ratio: 62.70%
[rank1]:2025-10-25 02:56:56,330 - INFO - Avg. fwd time: 22.8907 / Avg. bwd time: 41.2846 / Avg. batch time: 2078.4482 (ms) / GPU bubble ratio: 50.60%
[rank0]:2025-10-25 02:56:56,386 - INFO - Avg. fwd time: 19.4661 / Avg. bwd time: 31.7303 / Avg. batch time: 2132.9001 (ms) / GPU bubble ratio: 61.59%
[rank1]:2025-10-25 02:59:49,422 - INFO -  step: 1880  loss: -4.0000  grad_norm:  0.7616  memory: 15.15GiB(31.88%)  tps: 1,870  tflops: 14.62  mfu: 4.68%
[rank0]:2025-10-25 02:59:49,433 - INFO -  step: 1880  loss: -4.0000  grad_norm:  0.7616  memory: 17.51GiB(36.85%)  tps: 1,870  tflops: 14.62  mfu: 4.68%
[rank3]:2025-10-25 02:59:49,430 - INFO -  step: 1880  loss:  0.3935  grad_norm:  0.7616  memory: 26.71GiB(56.21%)  tps: 1,870  tflops: 14.62  mfu: 4.68%
[rank2]:2025-10-25 02:59:49,418 - INFO -  step: 1880  loss: -4.0000  grad_norm:  0.7616  memory:  9.81GiB(20.65%)  tps: 1,870  tflops: 14.62  mfu: 4.68%
[rank3]:2025-10-25 02:59:51,483 - INFO - Avg. fwd time: 33.7738 / Avg. bwd time: 71.3383 / Avg. batch time: 1901.1636 (ms) / GPU bubble ratio: 11.54%
[rank2]:2025-10-25 02:59:51,536 - INFO - Avg. fwd time: 17.4440 / Avg. bwd time: 28.5538 / Avg. batch time: 1972.9409 (ms) / GPU bubble ratio: 62.70%
[rank1]:2025-10-25 02:59:51,612 - INFO - Avg. fwd time: 22.8899 / Avg. bwd time: 41.2838 / Avg. batch time: 2078.5333 (ms) / GPU bubble ratio: 50.60%
[rank0]:2025-10-25 02:59:51,669 - INFO - Avg. fwd time: 19.4659 / Avg. bwd time: 31.7306 / Avg. batch time: 2132.9829 (ms) / GPU bubble ratio: 61.60%
[rank3]:2025-10-25 03:01:44,458 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 03:01:45,366 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 03:01:45,422 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 03:01:45,457 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 03:02:35,521 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-25 03:02:44,219 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.6738  memory:  9.81GiB(20.65%)  tps: 1,875  tflops: 14.65  mfu: 4.70%
[rank0]:2025-10-25 03:02:44,237 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.6738  memory: 17.51GiB(36.85%)  tps: 1,875  tflops: 14.65  mfu: 4.70%
[rank1]:2025-10-25 03:02:44,222 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.6738  memory: 15.15GiB(31.88%)  tps: 1,875  tflops: 14.65  mfu: 4.70%
[rank3]:2025-10-25 03:02:44,231 - INFO -  step: 1900  loss:  0.3836  grad_norm:  0.6738  memory: 26.71GiB(56.21%)  tps: 1,875  tflops: 14.65  mfu: 4.70%
[rank3]:2025-10-25 03:02:44,621 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_nofreeze_dm1/pipeline_schedule/251025_0302_real_step1900_rank3.svg
[rank3]:> Batch Time: 1913.36 ms, GPU Bubble Ratio: 57.07%, 46.45%, 61.84%, 12.19%
[rank3]:2025-10-25 03:02:46,566 - INFO - Avg. fwd time: 33.7746 / Avg. bwd time: 71.3403 / Avg. batch time: 1901.2051 (ms) / GPU bubble ratio: 11.54%
[rank2]:2025-10-25 03:02:46,617 - INFO - Avg. fwd time: 17.4441 / Avg. bwd time: 28.5535 / Avg. batch time: 1972.9993 (ms) / GPU bubble ratio: 62.70%
[rank0]:2025-10-25 03:02:46,750 - INFO - Avg. fwd time: 19.4663 / Avg. bwd time: 31.7307 / Avg. batch time: 2133.0350 (ms) / GPU bubble ratio: 61.60%
[rank1]:2025-10-25 03:02:46,694 - INFO - Avg. fwd time: 22.8885 / Avg. bwd time: 41.2825 / Avg. batch time: 2078.5862 (ms) / GPU bubble ratio: 50.60%
[rank1]:2025-10-25 03:05:39,587 - INFO -  step: 1920  loss: -4.0000  grad_norm:  0.8263  memory: 15.15GiB(31.88%)  tps: 1,869  tflops: 14.61  mfu: 4.68%
[rank3]:2025-10-25 03:05:39,595 - INFO -  step: 1920  loss:  0.3847  grad_norm:  0.8263  memory: 26.71GiB(56.21%)  tps: 1,869  tflops: 14.61  mfu: 4.68%
[rank2]:2025-10-25 03:05:39,583 - INFO -  step: 1920  loss: -4.0000  grad_norm:  0.8263  memory:  9.81GiB(20.65%)  tps: 1,869  tflops: 14.61  mfu: 4.68%
[rank0]:2025-10-25 03:05:39,600 - INFO -  step: 1920  loss: -4.0000  grad_norm:  0.8263  memory: 17.51GiB(36.85%)  tps: 1,869  tflops: 14.61  mfu: 4.68%
[rank3]:2025-10-25 03:05:41,657 - INFO - Avg. fwd time: 33.7761 / Avg. bwd time: 71.3434 / Avg. batch time: 1901.2807 (ms) / GPU bubble ratio: 11.54%
[rank2]:2025-10-25 03:05:41,710 - INFO - Avg. fwd time: 17.4447 / Avg. bwd time: 28.5542 / Avg. batch time: 1973.0602 (ms) / GPU bubble ratio: 62.70%
[rank1]:2025-10-25 03:05:41,786 - INFO - Avg. fwd time: 22.8877 / Avg. bwd time: 41.2822 / Avg. batch time: 2078.6484 (ms) / GPU bubble ratio: 50.61%
[rank0]:2025-10-25 03:05:41,842 - INFO - Avg. fwd time: 19.4686 / Avg. bwd time: 31.7317 / Avg. batch time: 2133.0937 (ms) / GPU bubble ratio: 61.60%
[rank2]:2025-10-25 03:08:34,291 - INFO -  step: 1940  loss: -4.0000  grad_norm:  0.7088  memory:  9.81GiB(20.65%)  tps: 1,876  tflops: 14.66  mfu: 4.70%
[rank0]:2025-10-25 03:08:34,307 - INFO -  step: 1940  loss: -4.0000  grad_norm:  0.7088  memory: 17.51GiB(36.85%)  tps: 1,876  tflops: 14.66  mfu: 4.70%
[rank1]:2025-10-25 03:08:34,295 - INFO -  step: 1940  loss: -4.0000  grad_norm:  0.7088  memory: 15.15GiB(31.88%)  tps: 1,876  tflops: 14.66  mfu: 4.70%
[rank3]:2025-10-25 03:08:34,304 - INFO -  step: 1940  loss:  0.3712  grad_norm:  0.7088  memory: 26.71GiB(56.21%)  tps: 1,876  tflops: 14.66  mfu: 4.70%
[rank3]:2025-10-25 03:08:36,327 - INFO - Avg. fwd time: 33.7768 / Avg. bwd time: 71.3451 / Avg. batch time: 1901.3155 (ms) / GPU bubble ratio: 11.54%
[rank2]:2025-10-25 03:08:36,379 - INFO - Avg. fwd time: 17.4454 / Avg. bwd time: 28.5554 / Avg. batch time: 1973.0819 (ms) / GPU bubble ratio: 62.70%
[rank0]:2025-10-25 03:08:36,508 - INFO - Avg. fwd time: 19.4725 / Avg. bwd time: 31.7329 / Avg. batch time: 2133.0951 (ms) / GPU bubble ratio: 61.59%
[rank1]:2025-10-25 03:08:36,452 - INFO - Avg. fwd time: 22.8860 / Avg. bwd time: 41.2803 / Avg. batch time: 2078.6564 (ms) / GPU bubble ratio: 50.61%
[rank0]:2025-10-25 03:09:52,896 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-25 03:11:28,714 - INFO -  step: 1960  loss: -4.0000  grad_norm:  0.7445  memory:  9.81GiB(20.65%)  tps: 1,879  tflops: 14.69  mfu: 4.71%
[rank0]:2025-10-25 03:11:28,731 - INFO -  step: 1960  loss: -4.0000  grad_norm:  0.7445  memory: 17.51GiB(36.85%)  tps: 1,879  tflops: 14.69  mfu: 4.71%
[rank1]:2025-10-25 03:11:28,724 - INFO -  step: 1960  loss: -4.0000  grad_norm:  0.7445  memory: 15.15GiB(31.88%)  tps: 1,879  tflops: 14.69  mfu: 4.71%
[rank3]:2025-10-25 03:11:28,726 - INFO -  step: 1960  loss:  0.4158  grad_norm:  0.7445  memory: 26.71GiB(56.21%)  tps: 1,879  tflops: 14.69  mfu: 4.71%
[rank3]:2025-10-25 03:11:30,779 - INFO - Avg. fwd time: 33.7766 / Avg. bwd time: 71.3452 / Avg. batch time: 1901.3104 (ms) / GPU bubble ratio: 11.54%
[rank2]:2025-10-25 03:11:30,834 - INFO - Avg. fwd time: 17.4456 / Avg. bwd time: 28.5552 / Avg. batch time: 1973.0570 (ms) / GPU bubble ratio: 62.70%
[rank1]:2025-10-25 03:11:30,908 - INFO - Avg. fwd time: 22.8845 / Avg. bwd time: 41.2815 / Avg. batch time: 2078.6307 (ms) / GPU bubble ratio: 50.61%
[rank0]:2025-10-25 03:11:30,966 - INFO - Avg. fwd time: 19.4729 / Avg. bwd time: 31.7325 / Avg. batch time: 2133.0690 (ms) / GPU bubble ratio: 61.59%
[rank3]:2025-10-25 03:13:42,669 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 03:13:43,585 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 03:13:43,641 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 03:13:43,677 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 03:14:22,894 - INFO -  step: 1980  loss: -4.0000  grad_norm:  0.7131  memory: 15.15GiB(31.88%)  tps: 1,881  tflops: 14.71  mfu: 4.71%
[rank3]:2025-10-25 03:14:22,901 - INFO -  step: 1980  loss:  0.3865  grad_norm:  0.7131  memory: 26.71GiB(56.21%)  tps: 1,881  tflops: 14.71  mfu: 4.71%
[rank2]:2025-10-25 03:14:22,889 - INFO -  step: 1980  loss: -4.0000  grad_norm:  0.7131  memory:  9.81GiB(20.65%)  tps: 1,881  tflops: 14.71  mfu: 4.71%
[rank0]:2025-10-25 03:14:22,907 - INFO -  step: 1980  loss: -4.0000  grad_norm:  0.7131  memory: 17.51GiB(36.85%)  tps: 1,881  tflops: 14.71  mfu: 4.71%
[rank3]:2025-10-25 03:14:24,957 - INFO - Avg. fwd time: 33.7755 / Avg. bwd time: 71.3441 / Avg. batch time: 1901.2777 (ms) / GPU bubble ratio: 11.54%
[rank2]:2025-10-25 03:14:25,011 - INFO - Avg. fwd time: 17.4455 / Avg. bwd time: 28.5551 / Avg. batch time: 1972.9979 (ms) / GPU bubble ratio: 62.70%
[rank1]:2025-10-25 03:14:25,084 - INFO - Avg. fwd time: 22.8829 / Avg. bwd time: 41.2780 / Avg. batch time: 2078.5721 (ms) / GPU bubble ratio: 50.61%
[rank0]:2025-10-25 03:14:25,141 - INFO - Avg. fwd time: 19.4745 / Avg. bwd time: 31.7337 / Avg. batch time: 2133.0119 (ms) / GPU bubble ratio: 61.59%
[rank0]:2025-10-25 03:17:08,852 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-25 03:17:17,542 - INFO -  step: 2000  loss:  0.3735  grad_norm:  0.7374  memory: 26.71GiB(56.21%)  tps: 1,876  tflops: 14.67  mfu: 4.70%
[rank3]:2025-10-25 03:17:17,543 - INFO -  final step: 2000  loss:  0.3735  grad_norm:  0.7374  tps: 1,893  tflops: 14.80  mfu: 4.68%
[rank3]:2025-10-25 03:17:17,544 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-25 03:17:17,546 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2000.
[rank0]:2025-10-25 03:17:17,547 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.7374  memory: 17.51GiB(36.85%)  tps: 1,876  tflops: 14.67  mfu: 4.70%
[rank0]:2025-10-25 03:17:17,548 - INFO -  final step: 2000  loss: -4.0000  grad_norm:  0.7374  tps: 1,893  tflops: 14.80  mfu: 4.68%
[rank0]:2025-10-25 03:17:17,548 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-25 03:17:17,550 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2000.
[rank1]:2025-10-25 03:17:17,541 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.7374  memory: 15.15GiB(31.88%)  tps: 1,876  tflops: 14.67  mfu: 4.70%
[rank1]:2025-10-25 03:17:17,542 - INFO -  final step: 2000  loss: -4.0000  grad_norm:  0.7374  tps: 1,893  tflops: 14.80  mfu: 4.68%
[rank1]:2025-10-25 03:17:17,542 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-25 03:17:17,543 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2000.
[rank2]:2025-10-25 03:17:17,530 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.7374  memory:  9.81GiB(20.65%)  tps: 1,876  tflops: 14.67  mfu: 4.70%
[rank2]:2025-10-25 03:17:17,531 - INFO -  final step: 2000  loss: -4.0000  grad_norm:  0.7374  tps: 1,893  tflops: 14.80  mfu: 4.68%
[rank2]:2025-10-25 03:17:17,531 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-25 03:17:17,532 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2000.
[rank0]:2025-10-25 03:17:19,746 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank1]:2025-10-25 03:17:19,783 - INFO - Destroying the purge thread.
[rank2]:2025-10-25 03:17:19,783 - INFO - Destroying the purge thread.
[rank0]:2025-10-25 03:17:19,783 - INFO - Sleeping 2 seconds for other ranks to complete
[rank1]:2025-10-25 03:17:20,063 - INFO - Process group destroyed
[rank2]:2025-10-25 03:17:20,073 - INFO - Process group destroyed
[rank3]:2025-10-25 03:17:20,125 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_nofreeze_dm1/pipeline_schedule/251025_0317_real_final2000_rank3.svg
[rank3]:> Batch Time: 1913.44 ms, GPU Bubble Ratio: 57.06%, 46.45%, 61.84%, 12.19%
[rank3]:2025-10-25 03:17:20,446 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_Interleaved1F1B_nofreeze_dm1/pipeline_schedule/251025_0317_thry_final2000_rank3.svg
[rank3]:> Batch Time: 1334.87 ms, GPU Bubble Ratio: 15.79%, 15.79%, 15.79%, 15.79%
[rank3]:2025-10-25 03:17:20,447 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–â–â–â–â–â–â–â–‚â–‚â–‚â–‚â–‚â–ƒâ–‚â–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–„â–ƒâ–ƒâ–…â–ƒâ–„â–„â–„â–„â–„â–„â–„â–ƒâ–„â–ƒâ–ƒâ–ƒâ–ƒ
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–†â–…â–…â–…â–„â–„â–„â–„â–„â–„â–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–…â–…â–…â–…â–…â–„â–„â–„â–„â–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 8.655
[rank3]:wandb:               final/avg_loss 0.37349
[rank3]:wandb:             final/avg_mfu(%) 4.68453
[rank3]:wandb:             final/avg_tflops 14.79867
[rank3]:wandb:    final/avg_throughput(tps) 1893.00887
[rank3]:wandb:              final/grad_norm 0.73737
[rank3]:wandb:               final/max_loss 0.37349
[rank3]:wandb:                    grad_norm 0.73737
[rank3]:wandb: loss_metrics/global_avg_loss 0.37349
[rank3]:wandb: loss_metrics/global_max_loss 0.37349
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1023_Interleaved1F1B_nofreeze_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/301gvk8h
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1023_Interleaved1F1B_nofreeze_dm1/20251024-2225/wandb/run-20251024_222553-301gvk8h/logs
[rank0]:2025-10-25 03:17:21,783 - INFO - Training completed
[rank0]:2025-10-25 03:17:21,784 - INFO - Destroying the purge thread.
[rank3]:2025-10-25 03:17:21,940 - INFO - Process group destroyed
[rank0]:2025-10-25 03:17:21,998 - INFO - Process group destroyed
[rank0]:Stage 0: Modules to keep: {'layers.1', 'tok_embeddings', 'layers.0'}
[rank0]:Stage 4: Modules to keep: {'layers.10', 'layers.9'}
[rank2]:Stage 2: Modules to keep: {'layers.6', 'layers.5'}
[rank2]:Stage 6: Modules to keep: {'layers.13', 'layers.14'}
[rank1]:Stage 1: Modules to keep: {'layers.2', 'layers.3', 'layers.4'}
[rank1]:Stage 5: Modules to keep: {'layers.12', 'layers.11'}
[rank3]:Stage 3: Modules to keep: {'layers.7', 'layers.8'}
[rank3]:Stage 7: Modules to keep: {'output', 'layers.15', 'norm'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1022_llama1binstruct/config.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1023_Interleaved1F1B_nofreeze_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: profile_trace/1023_Interleaved1F1B_nofreeze_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: memory_snapshot/1023_Interleaved1F1B_nofreeze_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 20
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: tb/1023_Interleaved1F1B_nofreeze_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- pplog_freq: 80
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1023_Interleaved1F1B_nofreeze_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B-Instruct
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 1e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: alpaca
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 2000
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: Interleaved1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 2
[rank3]:		- stages_list: [3, 7]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- folder: checkpoint/1023_Interleaved1F1B_nofreeze_dm1
[rank3]:		- interval: 500
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B-Instruct/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: comm_traces/1023_Interleaved1F1B_nofreeze_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 8
[rank3]:		- seq_len: 2048
[rank3]:		- freq: 10
[rank3]:		- steps: -1
[rank3]:	- freezing:
[rank3]:		- freeze: False
[rank3]:		- metric_type: apf
[rank3]:		- phase_unit: 10
[rank3]:		- stability_check_freq: 5
[rank3]:		- aggressiveness: 0
[rank3]:
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
