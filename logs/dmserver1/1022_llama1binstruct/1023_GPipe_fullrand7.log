
üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•
‚úîÔ∏èCurrent Timestamp: 2025. 10. 23. (Î™©) 21:54:26 KST
‚úîÔ∏èSERVER: dmserver1 (143.248.135.95),  GPUs: 3,4,5,6
‚úîÔ∏èSCRIPT: /home/shcho/torchtitan/logs/dmserver1/1022_llama1binstruct/run.sh
‚úîÔ∏èOUTPUT: /home/shcho/torchtitan/logs/dmserver1/1022_llama1binstruct/1023_GPipe_fullrand7.log
‚úîÔ∏èMain Table Experiment
‚úîÔ∏èRunning with fullrand7 x GPipe ... 
‚òëÔ∏è> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1022_llama1binstruct/config.toml --job.description="Main Table Experiment" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=fullrand7
üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•
[rank3]:2025-10-23 21:54:32,605 - INFO - Starting job: "Main Table Experiment"
[rank2]:2025-10-23 21:54:32,606 - INFO - Starting job: "Main Table Experiment"
[rank3]:2025-10-23 21:54:32,824 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-10-23 21:54:32,826 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-10-23 21:54:32,741 - INFO - Starting job: "Main Table Experiment"
[rank0]:2025-10-23 21:54:32,765 - INFO - Starting job: "Main Table Experiment"
[rank2]:2025-10-23 21:54:32,779 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-10-23 21:54:32,781 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-10-23 21:54:32,967 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-10-23 21:54:32,969 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-23 21:54:32,977 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-10-23 21:54:32,980 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-23 21:54:32,985 - INFO - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-10-23 21:54:34,174 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-10-23 21:54:34,615 - INFO - Preparing slimorca dataset from Open-Orca/SlimOrca
[rank2]:2025-10-23 21:54:37,643 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-10-23 21:54:37,679 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-10-23 21:54:37,706 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-10-23 21:54:37,707 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-10-23 21:54:37,642 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank1]:2025-10-23 21:54:37,810 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-10-23 21:54:37,792 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-10-23 21:54:37,831 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-10-23 21:54:37,832 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank2]:2025-10-23 21:54:37,880 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-10-23 21:54:37,880 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-10-23 21:54:37,881 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank1]:2025-10-23 21:54:37,848 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-10-23 21:54:37,874 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-10-23 21:54:37,874 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-10-23 21:54:37,858 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-10-23 21:54:37,858 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2025-10-23 21:54:38,051 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-10-23 21:54:38,051 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-10-23 21:54:38,052 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank0]:2025-10-23 21:54:38,042 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-10-23 21:54:38,042 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-10-23 21:54:38,043 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run c4j1xh98
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1023_GPipe_fullrand7_dm1/20251023-2154/wandb/run-20251023_215439-c4j1xh98
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1023_GPipe_fullrand7_dm1
[rank3]:wandb: ‚≠êÔ∏è View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: üöÄ View run at https://wandb.ai/orangingq/torchtitan/runs/c4j1xh98
[rank3]:2025-10-23 21:54:40,182 - INFO - WandB logging enabled
[rank3]:2025-10-23 21:54:40,183 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-10-23 21:54:40,223 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-10-23 21:54:40,252 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-10-23 21:54:40,253 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank3]:2025-10-23 21:54:40,455 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-10-23 21:54:40,455 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-10-23 21:54:40,456 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank0]:2025-10-23 21:54:40,471 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1023_GPipe_fullrand7_dm1
[rank0]:2025-10-23 21:54:40,471 - WARNING - Mixed precision training with TP or PP is only supported when FSDP/HSDP/CP is enabled.
[rank0]:2025-10-23 21:54:40,471 - INFO - Mixed precision training is disabled
[rank0]:2025-10-23 21:54:40,471 - INFO - Trainer is initialized with local batch size 16, global batch size 128, gradient accumulation steps 8, sequence length 1024, total steps 1000 (warmup 100)
[rank0]:2025-10-23 21:54:40,471 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B-Instruct/original_dcp.
[rank0]:2025-10-23 21:54:43,288 - INFO - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-10-23 21:54:43,288 - INFO - Finished loading the checkpoint in 2.82 seconds.
[rank0]:2025-10-23 21:54:43,288 - INFO - Training starts at step 1
[rank0]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/autograd/graph.py:849: UserWarning: Attempting to run cuBLAS, but there was no current CUDA context! Attempting to set the primary context... (Triggered internally at /pytorch/aten/src/ATen/cuda/CublasHandlePool.cpp:270.)
[rank0]:  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
[rank2]:2025-10-23 21:55:00,154 - INFO -  step:  1  loss: -8.0000  grad_norm:  1.7131  memory: 14.29GiB(30.07%)  tps: 1,458  tflops: 11.40  mfu: 3.65%
[rank2]:2025-10-23 21:55:00,154 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-10-23 21:55:00,158 - INFO -  step:  1  loss: -8.0000  grad_norm:  1.7131  memory: 17.77GiB(37.40%)  tps: 1,469  tflops: 11.48  mfu: 3.68%
[rank1]:2025-10-23 21:55:00,159 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-23 21:55:00,165 - INFO -  step:  1  loss:  2.4984  grad_norm:  1.7131  memory: 35.59GiB(74.92%)  tps: 1,643  tflops: 12.85  mfu: 4.12%
[rank3]:2025-10-23 21:55:00,165 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-10-23 21:55:00,190 - INFO -  step:  1  loss: -8.0000  grad_norm:  1.7131  memory: 17.10GiB(35.99%)  tps: 1,466  tflops: 11.46  mfu: 3.67%
[rank0]:2025-10-23 21:55:00,191 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-23 21:57:31,300 - INFO - Avg. fwd time: 75.1102 / Avg. bwd time: 132.4762 / Avg. batch time: 1711.2493 (ms) / GPU bubble ratio: 2.95%
[rank2]:2025-10-23 21:57:31,356 - INFO - Avg. fwd time: 34.5341 / Avg. bwd time: 54.0661 / Avg. batch time: 1801.5212 (ms) / GPU bubble ratio: 60.66%
[rank1]:2025-10-23 21:57:31,431 - INFO - Avg. fwd time: 53.2780 / Avg. bwd time: 73.6545 / Avg. batch time: 1923.3812 (ms) / GPU bubble ratio: 47.20%
[rank0]:2025-10-23 21:57:31,496 - INFO - Avg. fwd time: 48.5792 / Avg. bwd time: 61.0439 / Avg. batch time: 2022.0022 (ms) / GPU bubble ratio: 56.63%
[rank3]:2025-10-23 22:00:17,301 - INFO -  step: 20  loss:  2.0449  grad_norm:  0.4711  memory: 38.93GiB(81.95%)  tps: 1,963  tflops: 15.35  mfu: 4.92%
[rank0]:2025-10-23 22:00:17,315 - INFO -  step: 20  loss: -8.0000  grad_norm:  0.4711  memory: 20.89GiB(43.97%)  tps: 1,963  tflops: 15.35  mfu: 4.92%
[rank1]:2025-10-23 22:00:17,293 - INFO -  step: 20  loss: -8.0000  grad_norm:  0.4711  memory: 20.03GiB(42.17%)  tps: 1,963  tflops: 15.35  mfu: 4.92%
[rank2]:2025-10-23 22:00:17,289 - INFO -  step: 20  loss: -8.0000  grad_norm:  0.4711  memory: 16.10GiB(33.90%)  tps: 1,963  tflops: 15.35  mfu: 4.92%
[rank3]:2025-10-23 22:00:19,219 - INFO - Avg. fwd time: 76.0096 / Avg. bwd time: 133.6091 / Avg. batch time: 1725.9569 (ms) / GPU bubble ratio: 2.84%
[rank2]:2025-10-23 22:00:19,277 - INFO - Avg. fwd time: 34.7285 / Avg. bwd time: 54.4354 / Avg. batch time: 1817.3305 (ms) / GPU bubble ratio: 60.75%
[rank1]:2025-10-23 22:00:19,353 - INFO - Avg. fwd time: 54.0058 / Avg. bwd time: 73.8985 / Avg. batch time: 1939.5962 (ms) / GPU bubble ratio: 47.24%
[rank0]:2025-10-23 22:00:19,421 - INFO - Avg. fwd time: 48.3006 / Avg. bwd time: 61.0985 / Avg. batch time: 2039.4436 (ms) / GPU bubble ratio: 57.09%
[rank3]:2025-10-23 22:03:07,379 - INFO - Avg. fwd time: 76.2755 / Avg. bwd time: 134.2128 / Avg. batch time: 1732.4017 (ms) / GPU bubble ratio: 2.80%
[rank2]:2025-10-23 22:03:07,437 - INFO - Avg. fwd time: 34.8847 / Avg. bwd time: 54.6648 / Avg. batch time: 1824.0693 (ms) / GPU bubble ratio: 60.73%
[rank1]:2025-10-23 22:03:07,529 - INFO - Avg. fwd time: 54.1877 / Avg. bwd time: 74.2635 / Avg. batch time: 1945.9903 (ms) / GPU bubble ratio: 47.19%
[rank0]:2025-10-23 22:03:07,596 - INFO - Avg. fwd time: 48.3068 / Avg. bwd time: 61.3469 / Avg. batch time: 2046.2192 (ms) / GPU bubble ratio: 57.13%
[rank3]:2025-10-23 22:05:53,810 - INFO -  step: 40  loss:  2.0147  grad_norm:  0.3442  memory: 38.93GiB(81.95%)  tps: 1,948  tflops: 15.23  mfu: 4.88%
[rank0]:2025-10-23 22:05:53,811 - INFO -  step: 40  loss: -8.0000  grad_norm:  0.3442  memory: 20.89GiB(43.97%)  tps: 1,948  tflops: 15.23  mfu: 4.88%
[rank2]:2025-10-23 22:05:53,797 - INFO -  step: 40  loss: -8.0000  grad_norm:  0.3442  memory: 16.10GiB(33.90%)  tps: 1,948  tflops: 15.22  mfu: 4.88%
[rank1]:2025-10-23 22:05:53,801 - INFO -  step: 40  loss: -8.0000  grad_norm:  0.3442  memory: 20.03GiB(42.17%)  tps: 1,948  tflops: 15.22  mfu: 4.88%
[rank3]:2025-10-23 22:05:55,716 - INFO - Avg. fwd time: 76.3292 / Avg. bwd time: 134.6527 / Avg. batch time: 1735.9609 (ms) / GPU bubble ratio: 2.77%
[rank2]:2025-10-23 22:05:55,778 - INFO - Avg. fwd time: 35.0008 / Avg. bwd time: 54.8993 / Avg. batch time: 1828.0192 (ms) / GPU bubble ratio: 60.66%
[rank1]:2025-10-23 22:05:55,860 - INFO - Avg. fwd time: 54.4012 / Avg. bwd time: 74.5409 / Avg. batch time: 1949.6419 (ms) / GPU bubble ratio: 47.09%
[rank0]:2025-10-23 22:05:55,926 - INFO - Avg. fwd time: 48.3371 / Avg. bwd time: 61.5033 / Avg. batch time: 2049.9772 (ms) / GPU bubble ratio: 57.13%
[rank0]:2025-10-23 22:08:25,174 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-23 22:08:43,846 - INFO - Avg. fwd time: 76.3733 / Avg. bwd time: 134.8264 / Avg. batch time: 1737.5856 (ms) / GPU bubble ratio: 2.76%
[rank2]:2025-10-23 22:08:43,907 - INFO - Avg. fwd time: 35.0245 / Avg. bwd time: 54.9622 / Avg. batch time: 1829.7386 (ms) / GPU bubble ratio: 60.66%
[rank1]:2025-10-23 22:08:43,988 - INFO - Avg. fwd time: 54.4970 / Avg. bwd time: 74.6662 / Avg. batch time: 1951.3586 (ms) / GPU bubble ratio: 47.05%
[rank0]:2025-10-23 22:08:44,055 - INFO - Avg. fwd time: 48.3300 / Avg. bwd time: 61.5714 / Avg. batch time: 2051.7638 (ms) / GPU bubble ratio: 57.15%
[rank2]:2025-10-23 22:11:29,921 - INFO -  step: 60  loss: -8.0000  grad_norm:  0.3382  memory: 16.10GiB(33.90%)  tps: 1,950  tflops: 15.24  mfu: 4.89%
[rank3]:2025-10-23 22:11:29,933 - INFO -  step: 60  loss:  1.9362  grad_norm:  0.3382  memory: 38.93GiB(81.95%)  tps: 1,950  tflops: 15.24  mfu: 4.89%
[rank0]:2025-10-23 22:11:29,946 - INFO -  step: 60  loss: -8.0000  grad_norm:  0.3382  memory: 20.89GiB(43.97%)  tps: 1,950  tflops: 15.24  mfu: 4.89%
[rank1]:2025-10-23 22:11:29,925 - INFO -  step: 60  loss: -8.0000  grad_norm:  0.3382  memory: 20.03GiB(42.17%)  tps: 1,950  tflops: 15.24  mfu: 4.89%
[rank3]:2025-10-23 22:11:31,854 - INFO - Avg. fwd time: 76.4484 / Avg. bwd time: 134.8500 / Avg. batch time: 1738.1883 (ms) / GPU bubble ratio: 2.75%
[rank2]:2025-10-23 22:11:31,911 - INFO - Avg. fwd time: 35.0132 / Avg. bwd time: 54.9886 / Avg. batch time: 1830.4105 (ms) / GPU bubble ratio: 60.66%
[rank1]:2025-10-23 22:11:31,988 - INFO - Avg. fwd time: 54.5077 / Avg. bwd time: 74.7045 / Avg. batch time: 1952.0737 (ms) / GPU bubble ratio: 47.05%
[rank0]:2025-10-23 22:11:32,055 - INFO - Avg. fwd time: 48.3183 / Avg. bwd time: 61.5951 / Avg. batch time: 2052.6018 (ms) / GPU bubble ratio: 57.16%
[rank3]:2025-10-23 22:14:19,742 - INFO - Avg. fwd time: 76.5285 / Avg. bwd time: 134.8596 / Avg. batch time: 1738.6809 (ms) / GPU bubble ratio: 2.74%
[rank2]:2025-10-23 22:14:19,803 - INFO - Avg. fwd time: 35.0146 / Avg. bwd time: 55.0333 / Avg. batch time: 1830.9062 (ms) / GPU bubble ratio: 60.65%
[rank1]:2025-10-23 22:14:19,885 - INFO - Avg. fwd time: 54.4183 / Avg. bwd time: 74.8313 / Avg. batch time: 1952.4536 (ms) / GPU bubble ratio: 47.04%
[rank0]:2025-10-23 22:14:19,965 - INFO - Avg. fwd time: 48.3182 / Avg. bwd time: 61.6248 / Avg. batch time: 2053.0502 (ms) / GPU bubble ratio: 57.16%
[rank1]:2025-10-23 22:17:05,812 - INFO -  step: 80  loss: -8.0000  grad_norm:  0.3566  memory: 20.03GiB(42.17%)  tps: 1,951  tflops: 15.25  mfu: 4.89%
[rank3]:2025-10-23 22:17:05,821 - INFO -  step: 80  loss:  1.8492  grad_norm:  0.3566  memory: 38.93GiB(81.95%)  tps: 1,951  tflops: 15.25  mfu: 4.89%
[rank2]:2025-10-23 22:17:05,808 - INFO -  step: 80  loss: -8.0000  grad_norm:  0.3566  memory: 16.10GiB(33.90%)  tps: 1,951  tflops: 15.25  mfu: 4.89%
[rank0]:2025-10-23 22:17:05,835 - INFO -  step: 80  loss: -8.0000  grad_norm:  0.3566  memory: 20.89GiB(43.97%)  tps: 1,951  tflops: 15.25  mfu: 4.89%
[rank3]:2025-10-23 22:17:07,711 - INFO - Avg. fwd time: 76.5836 / Avg. bwd time: 134.8270 / Avg. batch time: 1738.7247 (ms) / GPU bubble ratio: 2.73%
[rank2]:2025-10-23 22:17:07,772 - INFO - Avg. fwd time: 35.0126 / Avg. bwd time: 54.9961 / Avg. batch time: 1830.9079 (ms) / GPU bubble ratio: 60.67%
[rank1]:2025-10-23 22:17:07,844 - INFO - Avg. fwd time: 54.4838 / Avg. bwd time: 74.8210 / Avg. batch time: 1952.7119 (ms) / GPU bubble ratio: 47.03%
[rank0]:2025-10-23 22:17:07,922 - INFO - Avg. fwd time: 48.2711 / Avg. bwd time: 61.5819 / Avg. batch time: 2053.3308 (ms) / GPU bubble ratio: 57.20%
[rank3]:2025-10-23 22:19:53,911 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/pipeline_schedule/251023_2219_real_warmupend90_rank3.svg
[rank3]:> Batch Time: 2002.22 ms, GPU Bubble Ratio: 56.06%, 47.96%, 64.47%, 15.16%
[rank3]:2025-10-23 22:19:55,698 - INFO - Avg. fwd time: 76.6140 / Avg. bwd time: 134.8034 / Avg. batch time: 1738.7226 (ms) / GPU bubble ratio: 2.73%
[rank2]:2025-10-23 22:19:55,756 - INFO - Avg. fwd time: 34.9855 / Avg. bwd time: 54.9613 / Avg. batch time: 1831.0593 (ms) / GPU bubble ratio: 60.70%
[rank1]:2025-10-23 22:19:55,833 - INFO - Avg. fwd time: 54.5050 / Avg. bwd time: 74.7689 / Avg. batch time: 1952.9398 (ms) / GPU bubble ratio: 47.04%
[rank0]:2025-10-23 22:19:55,897 - INFO - Avg. fwd time: 48.2532 / Avg. bwd time: 61.5862 / Avg. batch time: 2053.5739 (ms) / GPU bubble ratio: 57.21%
[rank3]:2025-10-23 22:21:17,079 - INFO - [Step 95] „Ä∞Ô∏è Monitoring Upperbound
[rank0]:2025-10-23 22:22:25,050 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-23 22:22:41,066 - INFO - [Step 100] ‚úîÔ∏è  Setting Upperbound
[rank3]:2025-10-23 22:22:41,899 - INFO - [Step 100] „Ä∞Ô∏è Monitoring Lowerbound
[rank3]:2025-10-23 22:22:41,902 - INFO -  step: 100  loss:  1.9025  grad_norm:  0.3639  memory: 38.93GiB(81.95%)  tps: 1,950  tflops: 15.24  mfu: 4.89%
[rank1]:2025-10-23 22:22:41,901 - INFO -  step: 100  loss: -8.0000  grad_norm:  0.3639  memory: 20.03GiB(42.17%)  tps: 1,950  tflops: 15.24  mfu: 4.89%
[rank0]:2025-10-23 22:22:41,901 - INFO -  step: 100  loss: -8.0000  grad_norm:  0.3639  memory: 20.89GiB(43.97%)  tps: 1,950  tflops: 15.24  mfu: 4.89%
[rank0]:2025-10-23 22:22:41,978 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251023_2222_stage0_step100.svg
[rank2]:2025-10-23 22:22:41,900 - INFO -  step: 100  loss: -8.0000  grad_norm:  0.3639  memory: 16.10GiB(33.90%)  tps: 1,950  tflops: 15.24  mfu: 4.89%
[rank2]:2025-10-23 22:22:41,980 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251023_2222_stage2_step100.svg
[rank1]:2025-10-23 22:22:41,977 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251023_2222_stage1_step100.svg
[rank3]:2025-10-23 22:22:42,157 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/pipeline_schedule/251023_2222_real_step100_rank3.svg
[rank3]:> Batch Time: 2001.94 ms, GPU Bubble Ratio: 56.04%, 47.96%, 64.45%, 15.14%
[rank3]:2025-10-23 22:22:42,218 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251023_2222_stage3_step100.svg
[rank3]:2025-10-23 22:22:43,985 - INFO - Avg. fwd time: 76.6149 / Avg. bwd time: 134.8534 / Avg. batch time: 1739.1296 (ms) / GPU bubble ratio: 2.72%
[rank2]:2025-10-23 22:22:44,044 - INFO - Avg. fwd time: 35.0103 / Avg. bwd time: 54.9882 / Avg. batch time: 1831.6227 (ms) / GPU bubble ratio: 60.69%
[rank1]:2025-10-23 22:22:44,116 - INFO - Avg. fwd time: 54.4407 / Avg. bwd time: 74.8263 / Avg. batch time: 1953.3526 (ms) / GPU bubble ratio: 47.06%
[rank0]:2025-10-23 22:22:44,179 - INFO - Avg. fwd time: 48.2644 / Avg. bwd time: 61.6238 / Avg. batch time: 2054.0155 (ms) / GPU bubble ratio: 57.20%
[rank3]:2025-10-23 22:23:41,572 - INFO - [Step 105] ‚úîÔ∏è  Setting Lowerbound
[rank3]:2025-10-23 22:23:42,592 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/pipeline_schedule/251023_2223_max_batch_time.svg
[rank3]:> Batch Time: 1998.34 ms, GPU Bubble Ratio: 55.72%, 47.82%, 63.71%, 14.97%
[rank3]:2025-10-23 22:23:42,818 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/pipeline_schedule/251023_2223_min_batch_time.svg
[rank3]:> Batch Time: 1387.88 ms, GPU Bubble Ratio: 71.86%, 46.43%, 62.87%, 12.99%
[rank3]:2025-10-23 22:23:43,075 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/pipeline_schedule/251023_2223_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 1387.88 ms, GPU Bubble Ratio: 42.86%, 30.97%, 49.59%, 12.99%
[rank3]:2025-10-23 22:23:43,076 - INFO - 	> Batch Time: 1387.88 ms (Average Freeze Ratio: 0.40, Time Reduction Rate: 0.31)
[rank3]:2025-10-23 22:24:43,201 - INFO - Avg. fwd time: 76.6701 / Avg. bwd time: 129.2380 / Avg. batch time: 1694.6875 (ms) / GPU bubble ratio: 2.80%
[rank2]:2025-10-23 22:24:43,235 - INFO - Avg. fwd time: 35.0298 / Avg. bwd time: 52.6675 / Avg. batch time: 1785.5352 (ms) / GPU bubble ratio: 60.71%
[rank1]:2025-10-23 22:24:43,280 - INFO - Avg. fwd time: 54.4172 / Avg. bwd time: 71.5898 / Avg. batch time: 1904.0528 (ms) / GPU bubble ratio: 47.06%
[rank0]:2025-10-23 22:24:43,284 - INFO - Avg. fwd time: 48.2511 / Avg. bwd time: 56.0218 / Avg. batch time: 1998.9967 (ms) / GPU bubble ratio: 58.27%
[rank3]:2025-10-23 22:26:47,376 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-23 22:26:48,156 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.11/0.11, [MB1] 0.00/0.00, [MB2] 0.21/0.21, [MB3] 0.00/0.00, [MB4] 0.14/0.14, [MB5] 0.20/0.20, [MB6] 0.75/0.75, [MB7] 1.00/1.00
[rank2]:2025-10-23 22:26:48,111 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-10-23 22:26:48,226 - INFO -  step: 120  loss: -8.0000  grad_norm:  0.0768  memory: 20.03GiB(42.17%)  tps: 2,661  tflops: 20.80  mfu: 6.67%
[rank3]:2025-10-23 22:26:48,229 - INFO -  step: 120  loss:  1.8959  grad_norm:  0.0768  memory: 38.93GiB(81.95%)  tps: 2,661  tflops: 20.80  mfu: 6.67%
[rank0]:2025-10-23 22:26:48,226 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.50/0.50, [MB7] 1.00/1.00
[rank0]:2025-10-23 22:26:48,226 - INFO -  step: 120  loss: -8.0000  grad_norm:  0.0768  memory: 20.89GiB(43.97%)  tps: 2,661  tflops: 20.80  mfu: 6.67%
[rank2]:2025-10-23 22:26:48,227 - INFO -  step: 120  loss: -8.0000  grad_norm:  0.0768  memory: 16.10GiB(33.90%)  tps: 2,661  tflops: 20.80  mfu: 6.67%
[rank3]:2025-10-23 22:26:49,685 - INFO - Avg. fwd time: 76.6354 / Avg. bwd time: 125.1873 / Avg. batch time: 1661.9591 (ms) / GPU bubble ratio: 2.85%
[rank1]:2025-10-23 22:26:49,770 - INFO - Avg. fwd time: 54.4317 / Avg. bwd time: 69.4453 / Avg. batch time: 1867.7849 (ms) / GPU bubble ratio: 46.94%
[rank2]:2025-10-23 22:26:49,726 - INFO - Avg. fwd time: 35.0509 / Avg. bwd time: 51.3657 / Avg. batch time: 1751.4440 (ms) / GPU bubble ratio: 60.53%
[rank0]:2025-10-23 22:26:49,799 - INFO - Avg. fwd time: 48.2428 / Avg. bwd time: 54.0555 / Avg. batch time: 1960.6827 (ms) / GPU bubble ratio: 58.26%
[rank3]:2025-10-23 22:28:47,256 - INFO - Avg. fwd time: 76.7139 / Avg. bwd time: 121.0756 / Avg. batch time: 1629.5739 (ms) / GPU bubble ratio: 2.90%
[rank0]:2025-10-23 22:28:47,337 - INFO - Avg. fwd time: 48.1849 / Avg. bwd time: 49.8975 / Avg. batch time: 1919.9088 (ms) / GPU bubble ratio: 59.13%
[rank2]:2025-10-23 22:28:47,290 - INFO - Avg. fwd time: 35.0420 / Avg. bwd time: 49.6765 / Avg. batch time: 1717.2834 (ms) / GPU bubble ratio: 60.53%
[rank1]:2025-10-23 22:28:47,333 - INFO - Avg. fwd time: 54.3558 / Avg. bwd time: 67.1132 / Avg. batch time: 1831.2819 (ms) / GPU bubble ratio: 46.94%
[rank1]:2025-10-23 22:30:43,458 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251023_2230_rank1_trend_line.svg
[rank1]:2025-10-23 22:30:43,466 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-10-23 22:30:43,467 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-10-23 22:30:43,468 - INFO -  step: 140  loss: -8.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,786  tflops: 21.78  mfu: 6.98%
[rank0]:2025-10-23 22:30:43,460 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251023_2230_rank0_trend_line.svg
[rank0]:2025-10-23 22:30:43,466 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-23 22:30:43,467 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-23 22:30:43,468 - INFO -  step: 140  loss: -8.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,786  tflops: 21.78  mfu: 6.98%
[rank3]:2025-10-23 22:30:43,434 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251023_2230_rank3_trend_line.svg
[rank2]:2025-10-23 22:30:43,435 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251023_2230_rank2_trend_line.svg
[rank2]:2025-10-23 22:30:43,466 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-23 22:30:43,467 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-23 22:30:43,468 - INFO -  step: 140  loss: -8.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,786  tflops: 21.78  mfu: 6.98%
[rank3]:2025-10-23 22:30:43,701 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/pipeline_schedule/251023_2230_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 1389.26 ms, GPU Bubble Ratio: 65.65%, 45.08%, 61.47%, 13.43%
[rank3]:2025-10-23 22:30:43,701 - INFO - 	> Batch Time: 1389.26 ms (Average Freeze Ratio: 0.34)
[rank3]:2025-10-23 22:30:43,702 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-23 22:30:43,703 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-23 22:30:43,706 - INFO -  step: 140  loss:  1.9120  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,783  tflops: 21.76  mfu: 6.97%
[rank3]:2025-10-23 22:30:44,959 - INFO - Avg. fwd time: 76.7725 / Avg. bwd time: 117.5444 / Avg. batch time: 1601.6767 (ms) / GPU bubble ratio: 2.94%
[rank2]:2025-10-23 22:30:44,993 - INFO - Avg. fwd time: 35.0353 / Avg. bwd time: 48.2276 / Avg. batch time: 1687.9731 (ms) / GPU bubble ratio: 60.54%
[rank1]:2025-10-23 22:30:45,037 - INFO - Avg. fwd time: 54.2900 / Avg. bwd time: 65.1178 / Avg. batch time: 1799.9498 (ms) / GPU bubble ratio: 46.93%
[rank0]:2025-10-23 22:30:45,041 - INFO - Avg. fwd time: 48.1205 / Avg. bwd time: 46.3336 / Avg. batch time: 1884.9089 (ms) / GPU bubble ratio: 59.91%
[rank0]:2025-10-23 22:32:29,306 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-23 22:32:42,481 - INFO - Avg. fwd time: 76.8176 / Avg. bwd time: 114.4827 / Avg. batch time: 1577.5032 (ms) / GPU bubble ratio: 2.99%
[rank2]:2025-10-23 22:32:42,516 - INFO - Avg. fwd time: 35.0252 / Avg. bwd time: 46.9745 / Avg. batch time: 1662.4731 (ms) / GPU bubble ratio: 60.54%
[rank1]:2025-10-23 22:32:42,559 - INFO - Avg. fwd time: 54.3020 / Avg. bwd time: 63.3898 / Avg. batch time: 1772.7158 (ms) / GPU bubble ratio: 46.89%
[rank0]:2025-10-23 22:32:42,564 - INFO - Avg. fwd time: 48.0752 / Avg. bwd time: 43.2448 / Avg. batch time: 1854.5053 (ms) / GPU bubble ratio: 60.61%
[rank0]:2025-10-23 22:34:38,867 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251023_2234_rank0_trend_line.svg
[rank0]:2025-10-23 22:34:38,873 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-23 22:34:38,875 - INFO -  step: 160  loss: -8.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,784  tflops: 21.76  mfu: 6.98%
[rank1]:2025-10-23 22:34:38,859 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251023_2234_rank1_trend_line.svg
[rank1]:2025-10-23 22:34:38,873 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank1]:2025-10-23 22:34:38,874 - INFO -  step: 160  loss: -8.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,784  tflops: 21.76  mfu: 6.98%
[rank3]:2025-10-23 22:34:38,832 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251023_2234_rank3_trend_line.svg
[rank2]:2025-10-23 22:34:38,834 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251023_2234_rank2_trend_line.svg
[rank2]:2025-10-23 22:34:38,873 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-23 22:34:38,874 - INFO -  step: 160  loss: -8.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,784  tflops: 21.76  mfu: 6.98%
[rank3]:2025-10-23 22:34:39,105 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/pipeline_schedule/251023_2234_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 1380.84 ms, GPU Bubble Ratio: 68.03%, 45.31%, 61.79%, 13.44%
[rank3]:2025-10-23 22:34:39,106 - INFO - 	> Batch Time: 1380.84 ms (Average Freeze Ratio: 0.31)
[rank3]:2025-10-23 22:34:39,106 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-23 22:34:39,110 - INFO -  step: 160  loss:  1.8687  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,784  tflops: 21.76  mfu: 6.98%
[rank3]:2025-10-23 22:34:40,375 - INFO - Avg. fwd time: 76.8584 / Avg. bwd time: 111.8121 / Avg. batch time: 1556.4070 (ms) / GPU bubble ratio: 3.02%
[rank2]:2025-10-23 22:34:40,410 - INFO - Avg. fwd time: 35.0378 / Avg. bwd time: 45.8803 / Avg. batch time: 1640.3177 (ms) / GPU bubble ratio: 60.54%
[rank0]:2025-10-23 22:34:40,459 - INFO - Avg. fwd time: 48.0490 / Avg. bwd time: 40.5421 / Avg. batch time: 1828.0468 (ms) / GPU bubble ratio: 61.23%
[rank1]:2025-10-23 22:34:40,454 - INFO - Avg. fwd time: 54.2670 / Avg. bwd time: 61.8883 / Avg. batch time: 1749.0295 (ms) / GPU bubble ratio: 46.87%

üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•
‚úîÔ∏èCurrent Timestamp: 2025. 10. 24. (Í∏à) 02:13:08 KST
‚úîÔ∏èSERVER: dmserver1 (143.248.135.95),  GPUs: 3,4,5,6
‚úîÔ∏èSCRIPT: /home/shcho/torchtitan/logs/dmserver1/1022_llama1binstruct/run.sh
‚úîÔ∏èOUTPUT: /home/shcho/torchtitan/logs/dmserver1/1022_llama1binstruct/1023_GPipe_fullrand7.log
‚úîÔ∏èMain Table Experiment
‚úîÔ∏èRunning with fullrand7 x GPipe ... 
‚òëÔ∏è> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1022_llama1binstruct/config.toml --job.description="Main Table Experiment" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=fullrand7
üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•

üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•
‚úîÔ∏èCurrent Timestamp: 2025. 10. 24. (Í∏à) 06:56:06 KST
‚úîÔ∏èSERVER: dmserver1 (143.248.135.95),  GPUs: 3,4,5,6
‚úîÔ∏èSCRIPT: /home/shcho/torchtitan/logs/dmserver1/1022_llama1binstruct/run.sh
‚úîÔ∏èOUTPUT: /home/shcho/torchtitan/logs/dmserver1/1022_llama1binstruct/1023_GPipe_fullrand7.log
‚úîÔ∏èMain Table Experiment
‚úîÔ∏èRunning with fullrand7 x GPipe ... 
‚òëÔ∏è> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1022_llama1binstruct/config.toml --job.description="Main Table Experiment" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=fullrand7
üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•üî•
[rank1]:2025-10-24 06:56:12,698 - INFO - Starting job: "Main Table Experiment"
[rank0]:2025-10-24 06:56:12,721 - INFO - Starting job: "Main Table Experiment"
[rank2]:2025-10-24 06:56:12,882 - INFO - Starting job: "Main Table Experiment"
[rank0]:2025-10-24 06:56:12,988 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-10-24 06:56:12,990 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-24 06:56:12,992 - INFO - [GC] Initial GC collection 0.00 seconds
[rank3]:2025-10-24 06:56:12,939 - INFO - Starting job: "Main Table Experiment"
[rank1]:2025-10-24 06:56:12,981 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-10-24 06:56:12,983 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-10-24 06:56:13,203 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-10-24 06:56:13,206 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-10-24 06:56:13,221 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-10-24 06:56:13,223 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-24 06:56:13,519 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-10-24 06:56:13,899 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank0]:2025-10-24 06:56:16,702 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank1]:2025-10-24 06:56:16,852 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-10-24 06:56:16,898 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-10-24 06:56:16,849 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-10-24 06:56:16,898 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-10-24 06:56:16,899 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank2]:2025-10-24 06:56:16,882 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-10-24 06:56:16,920 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-10-24 06:56:16,926 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-10-24 06:56:16,926 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-10-24 06:56:16,926 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-10-24 06:56:16,926 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank2]:2025-10-24 06:56:16,947 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-10-24 06:56:16,947 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2025-10-24 06:56:17,114 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-10-24 06:56:17,114 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-10-24 06:56:17,115 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank0]:2025-10-24 06:56:17,120 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-10-24 06:56:17,120 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-10-24 06:56:17,121 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank2]:2025-10-24 06:56:17,126 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-10-24 06:56:17,127 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-10-24 06:56:17,127 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run ohluxiu7
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1023_GPipe_fullrand7_dm1/20251024-0656/wandb/run-20251024_065617-ohluxiu7
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1023_GPipe_fullrand7_dm1
[rank3]:wandb: ‚≠êÔ∏è View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: üöÄ View run at https://wandb.ai/orangingq/torchtitan/runs/ohluxiu7
[rank3]:2025-10-24 06:56:18,960 - INFO - WandB logging enabled
[rank3]:2025-10-24 06:56:18,961 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-10-24 06:56:19,000 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-10-24 06:56:19,027 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-10-24 06:56:19,028 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank3]:2025-10-24 06:56:19,209 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-10-24 06:56:19,210 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-10-24 06:56:19,211 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank0]:2025-10-24 06:56:19,228 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1023_GPipe_fullrand7_dm1
[rank0]:2025-10-24 06:56:19,229 - WARNING - Mixed precision training with TP or PP is only supported when FSDP/HSDP/CP is enabled.
[rank0]:2025-10-24 06:56:19,229 - INFO - Mixed precision training is disabled
[rank0]:2025-10-24 06:56:19,229 - INFO - Trainer is initialized with local batch size 16, global batch size 64, gradient accumulation steps 4, sequence length 1024, total steps 2000 (warmup 100)
[rank0]:2025-10-24 06:56:19,229 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B-Instruct/original_dcp.
[rank0]:2025-10-24 06:56:22,171 - INFO - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-10-24 06:56:22,171 - INFO - Finished loading the checkpoint in 2.94 seconds.
[rank0]:2025-10-24 06:56:22,171 - INFO - Training starts at step 1
[rank0]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/autograd/graph.py:849: UserWarning: Attempting to run cuBLAS, but there was no current CUDA context! Attempting to set the primary context... (Triggered internally at /pytorch/aten/src/ATen/cuda/CublasHandlePool.cpp:270.)
[rank0]:  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
[rank0]:2025-10-24 06:56:31,341 - INFO -  step:  1  loss: -4.0000  grad_norm:  3.4827  memory: 17.10GiB(35.99%)  tps: 1,134  tflops: 8.87  mfu: 2.84%
[rank0]:2025-10-24 06:56:31,341 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-10-24 06:56:31,303 - INFO -  step:  1  loss: -4.0000  grad_norm:  3.4827  memory: 14.29GiB(30.07%)  tps: 1,139  tflops: 8.91  mfu: 2.85%
[rank2]:2025-10-24 06:56:31,303 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-24 06:56:31,313 - INFO -  step:  1  loss:  1.7854  grad_norm:  3.4827  memory: 35.59GiB(74.92%)  tps: 1,331  tflops: 10.40  mfu: 3.33%
[rank3]:2025-10-24 06:56:31,314 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-10-24 06:56:31,305 - INFO -  step:  1  loss: -4.0000  grad_norm:  3.4827  memory: 17.77GiB(37.40%)  tps: 1,137  tflops: 8.89  mfu: 2.85%
[rank1]:2025-10-24 06:56:31,305 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-24 06:59:10,700 - INFO -  step: 20  loss:  1.3862  grad_norm:  1.4899  memory: 38.93GiB(81.95%)  tps: 1,953  tflops: 15.27  mfu: 4.89%
[rank2]:2025-10-24 06:59:10,688 - INFO -  step: 20  loss: -4.0000  grad_norm:  1.4899  memory: 16.10GiB(33.90%)  tps: 1,953  tflops: 15.27  mfu: 4.89%
[rank0]:2025-10-24 06:59:10,708 - INFO -  step: 20  loss: -4.0000  grad_norm:  1.4899  memory: 20.89GiB(43.97%)  tps: 1,953  tflops: 15.27  mfu: 4.89%
[rank1]:2025-10-24 06:59:10,695 - INFO -  step: 20  loss: -4.0000  grad_norm:  1.4899  memory: 20.03GiB(42.17%)  tps: 1,953  tflops: 15.27  mfu: 4.89%
[rank3]:2025-10-24 06:59:12,615 - INFO - Avg. fwd time: 76.6513 / Avg. bwd time: 134.3098 / Avg. batch time: 1738.0228 (ms) / GPU bubble ratio: 2.90%
[rank2]:2025-10-24 06:59:12,672 - INFO - Avg. fwd time: 35.3252 / Avg. bwd time: 55.2731 / Avg. batch time: 1830.2068 (ms) / GPU bubble ratio: 60.40%
[rank1]:2025-10-24 06:59:12,753 - INFO - Avg. fwd time: 52.8926 / Avg. bwd time: 75.1453 / Avg. batch time: 1950.1455 (ms) / GPU bubble ratio: 47.48%
[rank0]:2025-10-24 06:59:12,816 - INFO - Avg. fwd time: 48.7239 / Avg. bwd time: 61.6901 / Avg. batch time: 2048.7808 (ms) / GPU bubble ratio: 56.89%
[rank3]:2025-10-24 07:01:59,043 - INFO -  step: 40  loss:  1.2757  grad_norm:  2.1309  memory: 38.93GiB(81.95%)  tps: 1,947  tflops: 15.22  mfu: 4.88%
[rank1]:2025-10-24 07:01:59,035 - INFO -  step: 40  loss: -4.0000  grad_norm:  2.1309  memory: 20.03GiB(42.17%)  tps: 1,947  tflops: 15.22  mfu: 4.88%
[rank2]:2025-10-24 07:01:59,031 - INFO -  step: 40  loss: -4.0000  grad_norm:  2.1309  memory: 16.10GiB(33.90%)  tps: 1,947  tflops: 15.22  mfu: 4.88%
[rank0]:2025-10-24 07:01:59,056 - INFO -  step: 40  loss: -4.0000  grad_norm:  2.1309  memory: 20.89GiB(43.97%)  tps: 1,946  tflops: 15.22  mfu: 4.88%
[rank3]:2025-10-24 07:02:00,951 - INFO - Avg. fwd time: 76.8833 / Avg. bwd time: 134.8077 / Avg. batch time: 1742.0807 (ms) / GPU bubble ratio: 2.79%
[rank2]:2025-10-24 07:02:01,013 - INFO - Avg. fwd time: 35.2619 / Avg. bwd time: 55.3811 / Avg. batch time: 1834.1283 (ms) / GPU bubble ratio: 60.46%
[rank1]:2025-10-24 07:02:01,094 - INFO - Avg. fwd time: 53.1954 / Avg. bwd time: 75.1524 / Avg. batch time: 1954.0929 (ms) / GPU bubble ratio: 47.45%
[rank0]:2025-10-24 07:02:01,159 - INFO - Avg. fwd time: 48.2533 / Avg. bwd time: 61.8351 / Avg. batch time: 2052.8210 (ms) / GPU bubble ratio: 57.10%
[rank0]:2025-10-24 07:03:15,037 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-24 07:04:48,007 - INFO -  step: 60  loss: -4.0000  grad_norm:  0.5366  memory: 16.10GiB(33.90%)  tps: 1,939  tflops: 15.16  mfu: 4.86%
[rank3]:2025-10-24 07:04:48,019 - INFO -  step: 60  loss:  1.2100  grad_norm:  0.5366  memory: 38.93GiB(81.95%)  tps: 1,939  tflops: 15.16  mfu: 4.86%
[rank0]:2025-10-24 07:04:48,026 - INFO -  step: 60  loss: -4.0000  grad_norm:  0.5366  memory: 20.89GiB(43.97%)  tps: 1,939  tflops: 15.16  mfu: 4.86%
[rank1]:2025-10-24 07:04:48,010 - INFO -  step: 60  loss: -4.0000  grad_norm:  0.5366  memory: 20.03GiB(42.17%)  tps: 1,939  tflops: 15.16  mfu: 4.86%
[rank3]:2025-10-24 07:04:49,943 - INFO - Avg. fwd time: 77.0390 / Avg. bwd time: 135.0991 / Avg. batch time: 1745.2137 (ms) / GPU bubble ratio: 2.76%
[rank2]:2025-10-24 07:04:49,999 - INFO - Avg. fwd time: 35.2157 / Avg. bwd time: 55.4228 / Avg. batch time: 1837.2758 (ms) / GPU bubble ratio: 60.53%
[rank1]:2025-10-24 07:04:50,081 - INFO - Avg. fwd time: 53.5099 / Avg. bwd time: 75.2169 / Avg. batch time: 1957.9052 (ms) / GPU bubble ratio: 47.40%
[rank0]:2025-10-24 07:04:50,147 - INFO - Avg. fwd time: 48.1507 / Avg. bwd time: 61.8967 / Avg. batch time: 2056.9129 (ms) / GPU bubble ratio: 57.20%
[rank1]:2025-10-24 07:07:36,601 - INFO -  step: 80  loss: -4.0000  grad_norm:  0.5012  memory: 20.03GiB(42.17%)  tps: 1,944  tflops: 15.19  mfu: 4.87%
[rank2]:2025-10-24 07:07:36,590 - INFO -  step: 80  loss: -4.0000  grad_norm:  0.5012  memory: 16.10GiB(33.90%)  tps: 1,944  tflops: 15.20  mfu: 4.87%
[rank3]:2025-10-24 07:07:36,602 - INFO -  step: 80  loss:  1.1799  grad_norm:  0.5012  memory: 38.93GiB(81.95%)  tps: 1,944  tflops: 15.20  mfu: 4.87%
[rank0]:2025-10-24 07:07:36,610 - INFO -  step: 80  loss: -4.0000  grad_norm:  0.5012  memory: 20.89GiB(43.97%)  tps: 1,944  tflops: 15.20  mfu: 4.87%
[rank3]:2025-10-24 07:07:38,457 - INFO - Avg. fwd time: 77.0273 / Avg. bwd time: 135.1762 / Avg. batch time: 1745.5624 (ms) / GPU bubble ratio: 2.75%
[rank2]:2025-10-24 07:07:38,516 - INFO - Avg. fwd time: 35.2062 / Avg. bwd time: 55.4353 / Avg. batch time: 1837.5938 (ms) / GPU bubble ratio: 60.54%
[rank1]:2025-10-24 07:07:38,590 - INFO - Avg. fwd time: 53.5858 / Avg. bwd time: 75.1858 / Avg. batch time: 1958.2995 (ms) / GPU bubble ratio: 47.39%
[rank0]:2025-10-24 07:07:38,657 - INFO - Avg. fwd time: 48.0690 / Avg. bwd time: 61.8968 / Avg. batch time: 2057.3540 (ms) / GPU bubble ratio: 57.24%
[rank3]:2025-10-24 07:07:54,679 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-24 07:07:55,425 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-24 07:07:55,506 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 07:07:55,569 - WARNING - Dataset alpaca is being re-looped
[rank3]:2025-10-24 07:09:01,255 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/pipeline_schedule/251024_0709_real_warmupend90_rank3.svg
[rank3]:> Batch Time: 2004.09 ms, GPU Bubble Ratio: 56.14%, 48.20%, 64.16%, 14.89%
[rank3]:2025-10-24 07:09:42,520 - INFO - [Step 95] „Ä∞Ô∏è Monitoring Upperbound
[rank0]:2025-10-24 07:10:17,031 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-24 07:10:25,507 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.4903  memory: 16.10GiB(33.90%)  tps: 1,940  tflops: 15.17  mfu: 4.86%
[rank1]:2025-10-24 07:10:25,510 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.4903  memory: 20.03GiB(42.17%)  tps: 1,940  tflops: 15.17  mfu: 4.86%
[rank2]:2025-10-24 07:10:25,599 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251024_0710_stage2_step100.svg
[rank3]:2025-10-24 07:10:25,519 - INFO -  step: 100  loss:  1.1786  grad_norm:  0.4903  memory: 38.93GiB(81.95%)  tps: 1,940  tflops: 15.17  mfu: 4.86%
[rank0]:2025-10-24 07:10:25,526 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.4903  memory: 20.89GiB(43.97%)  tps: 1,940  tflops: 15.17  mfu: 4.86%
[rank0]:2025-10-24 07:10:25,601 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251024_0710_stage0_step100.svg
[rank1]:2025-10-24 07:10:25,598 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251024_0710_stage1_step100.svg
[rank3]:2025-10-24 07:10:25,768 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/pipeline_schedule/251024_0710_real_step100_rank3.svg
[rank3]:> Batch Time: 2004.69 ms, GPU Bubble Ratio: 56.14%, 48.13%, 64.16%, 14.91%
[rank3]:2025-10-24 07:10:25,824 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251024_0710_stage3_step100.svg
[rank2]:2025-10-24 07:10:27,694 - INFO - Avg. fwd time: 35.2240 / Avg. bwd time: 55.4832 / Avg. batch time: 1838.7966 (ms) / GPU bubble ratio: 60.54%
[rank3]:2025-10-24 07:10:27,638 - INFO - Avg. fwd time: 76.9823 / Avg. bwd time: 135.2709 / Avg. batch time: 1746.1600 (ms) / GPU bubble ratio: 2.76%
[rank1]:2025-10-24 07:10:27,766 - INFO - Avg. fwd time: 53.6257 / Avg. bwd time: 75.3129 / Avg. batch time: 1959.9376 (ms) / GPU bubble ratio: 47.37%
[rank0]:2025-10-24 07:10:27,835 - INFO - Avg. fwd time: 48.0187 / Avg. bwd time: 61.9185 / Avg. batch time: 2059.0007 (ms) / GPU bubble ratio: 57.29%
[rank3]:2025-10-24 07:11:07,067 - INFO - [Step 105] ‚úîÔ∏è  Setting Upperbound
[rank3]:2025-10-24 07:11:07,903 - INFO - [Step 105] „Ä∞Ô∏è Monitoring Lowerbound
[rank3]:2025-10-24 07:12:07,124 - INFO - [Step 115] ‚úîÔ∏è  Setting Lowerbound
[rank3]:2025-10-24 07:12:08,123 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/pipeline_schedule/251024_0712_max_batch_time.svg
[rank3]:> Batch Time: 2000.72 ms, GPU Bubble Ratio: 55.74%, 47.89%, 63.79%, 14.73%
[rank3]:2025-10-24 07:12:08,341 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/pipeline_schedule/251024_0712_min_batch_time.svg
[rank3]:> Batch Time: 1391.61 ms, GPU Bubble Ratio: 72.09%, 46.28%, 63.02%, 12.87%
[rank3]:2025-10-24 07:12:08,588 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/pipeline_schedule/251024_0712_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 1391.61 ms, GPU Bubble Ratio: 43.62%, 31.11%, 49.71%, 12.87%
[rank3]:2025-10-24 07:12:08,589 - INFO - 	> Batch Time: 1391.61 ms (Average Freeze Ratio: 0.41, Time Reduction Rate: 0.30)
[rank2]:2025-10-24 07:12:37,980 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank3]:2025-10-24 07:12:37,969 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank2]:2025-10-24 07:12:38,020 - INFO -  step: 120  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,473  tflops: 19.33  mfu: 6.20%
[rank3]:2025-10-24 07:12:38,021 - INFO -  step: 120  loss:  1.1315  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,473  tflops: 19.33  mfu: 6.20%
[rank0]:2025-10-24 07:12:38,020 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.28/0.28, [MB6] 0.37/0.37, [MB7] 1.00/1.00
[rank0]:2025-10-24 07:12:38,021 - INFO -  step: 120  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,473  tflops: 19.33  mfu: 6.20%
[rank1]:2025-10-24 07:12:38,020 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.11/0.11, [MB1] 0.11/0.11, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.40/0.40, [MB6] 0.81/0.81, [MB7] 1.00/1.00
[rank1]:2025-10-24 07:12:38,021 - INFO -  step: 120  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,473  tflops: 19.33  mfu: 6.20%
[rank2]:2025-10-24 07:12:39,469 - INFO - Avg. fwd time: 35.1998 / Avg. bwd time: 52.2210 / Avg. batch time: 1774.5029 (ms) / GPU bubble ratio: 60.59%
[rank3]:2025-10-24 07:12:39,435 - INFO - Avg. fwd time: 76.9637 / Avg. bwd time: 127.4995 / Avg. batch time: 1683.9371 (ms) / GPU bubble ratio: 2.86%
[rank0]:2025-10-24 07:12:39,516 - INFO - Avg. fwd time: 47.9919 / Avg. bwd time: 54.1626 / Avg. batch time: 1982.5982 (ms) / GPU bubble ratio: 58.78%
[rank1]:2025-10-24 07:12:39,513 - INFO - Avg. fwd time: 53.8024 / Avg. bwd time: 70.8475 / Avg. batch time: 1891.2859 (ms) / GPU bubble ratio: 47.27%
[rank2]:2025-10-24 07:14:35,930 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251024_0714_rank2_trend_line.svg
[rank3]:2025-10-24 07:14:35,928 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251024_0714_rank3_trend_line.svg
[rank0]:2025-10-24 07:14:35,947 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251024_0714_rank0_trend_line.svg
[rank0]:2025-10-24 07:14:35,952 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank0]:2025-10-24 07:14:35,953 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank0]:2025-10-24 07:14:35,953 - INFO -  step: 140  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,779  tflops: 21.72  mfu: 6.96%
[rank1]:2025-10-24 07:14:35,945 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251024_0714_rank1_trend_line.svg
[rank1]:2025-10-24 07:14:35,952 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank1]:2025-10-24 07:14:35,953 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank1]:2025-10-24 07:14:35,953 - INFO -  step: 140  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,779  tflops: 21.72  mfu: 6.96%
[rank2]:2025-10-24 07:14:35,952 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank2]:2025-10-24 07:14:35,953 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank2]:2025-10-24 07:14:35,953 - INFO -  step: 140  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,779  tflops: 21.72  mfu: 6.96%
[rank3]:2025-10-24 07:14:36,173 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/pipeline_schedule/251024_0714_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 1374.33 ms, GPU Bubble Ratio: 71.74%, 45.54%, 62.49%, 12.98%
[rank3]:2025-10-24 07:14:36,173 - INFO - 	> Batch Time: 1374.33 ms (Average Freeze Ratio: 0.25)
[rank3]:2025-10-24 07:14:36,174 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-24 07:14:36,176 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-24 07:14:36,180 - INFO -  step: 140  loss:  1.1605  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,773  tflops: 21.68  mfu: 6.95%
[rank2]:2025-10-24 07:14:37,498 - INFO - Avg. fwd time: 35.2051 / Avg. bwd time: 48.9765 / Avg. batch time: 1707.5761 (ms) / GPU bubble ratio: 60.56%
[rank3]:2025-10-24 07:14:37,464 - INFO - Avg. fwd time: 76.9171 / Avg. bwd time: 119.5747 / Avg. batch time: 1620.2251 (ms) / GPU bubble ratio: 2.98%
[rank0]:2025-10-24 07:14:37,543 - INFO - Avg. fwd time: 47.9670 / Avg. bwd time: 46.4254 / Avg. batch time: 1903.6756 (ms) / GPU bubble ratio: 60.33%
[rank1]:2025-10-24 07:14:37,540 - INFO - Avg. fwd time: 53.9106 / Avg. bwd time: 66.3582 / Avg. batch time: 1820.0908 (ms) / GPU bubble ratio: 47.14%
[rank0]:2025-10-24 07:15:39,763 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-24 07:16:58,233 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251024_0716_rank3_trend_line.svg
[rank1]:2025-10-24 07:16:58,249 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251024_0716_rank1_trend_line.svg
[rank2]:2025-10-24 07:16:58,246 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251024_0716_rank2_trend_line.svg
[rank1]:2025-10-24 07:16:58,271 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.52/0.52, [MB7] 1.00/1.00
[rank1]:2025-10-24 07:16:58,272 - INFO -  step: 160  loss: -4.0000  grad_norm:  0.4266  memory: 20.03GiB(42.17%)  tps: 2,302  tflops: 18.00  mfu: 5.77%
[rank2]:2025-10-24 07:16:58,271 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-24 07:16:58,272 - INFO -  step: 160  loss: -4.0000  grad_norm:  0.4266  memory: 16.10GiB(33.90%)  tps: 2,302  tflops: 18.00  mfu: 5.77%
[rank0]:2025-10-24 07:16:58,266 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251024_0716_rank0_trend_line.svg
[rank0]:2025-10-24 07:16:58,271 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-24 07:16:58,272 - INFO -  step: 160  loss: -4.0000  grad_norm:  0.4266  memory: 20.89GiB(43.97%)  tps: 2,302  tflops: 18.00  mfu: 5.77%
[rank3]:2025-10-24 07:16:58,492 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/pipeline_schedule/251024_0716_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 1389.28 ms, GPU Bubble Ratio: 51.99%, 31.01%, 53.90%, 14.00%
[rank3]:2025-10-24 07:16:58,492 - INFO - 	> Batch Time: 1389.28 ms (Average Freeze Ratio: 0.36)
[rank3]:2025-10-24 07:16:58,493 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-24 07:16:58,496 - INFO -  step: 160  loss:  1.1215  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,302  tflops: 18.00  mfu: 5.77%
[rank3]:2025-10-24 07:16:59,776 - INFO - Avg. fwd time: 76.8710 / Avg. bwd time: 113.5896 / Avg. batch time: 1572.1490 (ms) / GPU bubble ratio: 3.08%
[rank2]:2025-10-24 07:16:59,954 - INFO - Avg. fwd time: 35.1700 / Avg. bwd time: 50.4750 / Avg. batch time: 1676.0753 (ms) / GPU bubble ratio: 59.12%
[rank1]:2025-10-24 07:17:00,082 - INFO - Avg. fwd time: 54.1418 / Avg. bwd time: 69.2571 / Avg. batch time: 1795.9278 (ms) / GPU bubble ratio: 45.03%
[rank0]:2025-10-24 07:17:00,146 - INFO - Avg. fwd time: 47.8726 / Avg. bwd time: 48.9026 / Avg. batch time: 1882.2661 (ms) / GPU bubble ratio: 58.87%
[rank3]:2025-10-24 07:17:24,428 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-24 07:17:25,176 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-24 07:17:25,215 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 07:17:25,216 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-24 07:18:56,666 - INFO -  step: 180  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,768  tflops: 21.64  mfu: 6.93%
[rank3]:2025-10-24 07:18:56,667 - INFO -  step: 180  loss:  1.1052  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,773  tflops: 21.68  mfu: 6.95%
[rank2]:2025-10-24 07:18:56,665 - INFO -  step: 180  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,768  tflops: 21.64  mfu: 6.93%
[rank0]:2025-10-24 07:18:56,667 - INFO -  step: 180  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,768  tflops: 21.64  mfu: 6.93%
[rank3]:2025-10-24 07:18:58,071 - INFO - Avg. fwd time: 76.8723 / Avg. bwd time: 108.9901 / Avg. batch time: 1535.3353 (ms) / GPU bubble ratio: 3.15%
[rank2]:2025-10-24 07:18:58,106 - INFO - Avg. fwd time: 35.1802 / Avg. bwd time: 48.1530 / Avg. batch time: 1635.1440 (ms) / GPU bubble ratio: 59.23%
[rank1]:2025-10-24 07:18:58,150 - INFO - Avg. fwd time: 54.1992 / Avg. bwd time: 65.9608 / Avg. batch time: 1751.2917 (ms) / GPU bubble ratio: 45.11%
[rank0]:2025-10-24 07:18:58,154 - INFO - Avg. fwd time: 47.8886 / Avg. bwd time: 43.4692 / Avg. batch time: 1832.1837 (ms) / GPU bubble ratio: 60.11%
[rank0]:2025-10-24 07:20:48,909 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-24 07:20:54,920 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251024_0720_rank1_trend_line.svg
[rank1]:2025-10-24 07:20:54,925 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-10-24 07:20:54,926 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,771  tflops: 21.66  mfu: 6.94%
[rank3]:2025-10-24 07:20:54,894 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251024_0720_rank3_trend_line.svg
[rank2]:2025-10-24 07:20:54,894 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251024_0720_rank2_trend_line.svg
[rank2]:2025-10-24 07:20:54,925 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-24 07:20:54,926 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,771  tflops: 21.66  mfu: 6.94%
[rank0]:2025-10-24 07:20:54,920 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251024_0720_rank0_trend_line.svg
[rank0]:2025-10-24 07:20:54,925 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-24 07:20:54,927 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,771  tflops: 21.66  mfu: 6.94%
[rank3]:2025-10-24 07:20:55,150 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/pipeline_schedule/251024_0720_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 1390.19 ms, GPU Bubble Ratio: 62.11%, 38.29%, 58.21%, 13.94%
[rank3]:2025-10-24 07:20:55,151 - INFO - 	> Batch Time: 1390.19 ms (Average Freeze Ratio: 0.34)
[rank3]:2025-10-24 07:20:55,151 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-24 07:20:55,155 - INFO -  step: 200  loss:  1.1521  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,766  tflops: 21.62  mfu: 6.93%
[rank1]:2025-10-24 07:20:55,222 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251024_0720_stage1_step200.svg
[rank2]:2025-10-24 07:20:55,223 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251024_0720_stage2_step200.svg
[rank0]:2025-10-24 07:20:55,223 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251024_0720_stage0_step200.svg
[rank3]:2025-10-24 07:20:55,389 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/pipeline_schedule/251024_0720_real_step200_rank3.svg
[rank3]:> Batch Time: 1971.19 ms, GPU Bubble Ratio: 56.37%, 48.77%, 64.35%, 14.77%
[rank3]:2025-10-24 07:20:55,454 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251024_0720_stage3_step200.svg
[rank3]:2025-10-24 07:20:56,725 - INFO - Avg. fwd time: 76.8904 / Avg. bwd time: 105.3149 / Avg. batch time: 1506.0788 (ms) / GPU bubble ratio: 3.22%
[rank2]:2025-10-24 07:20:56,760 - INFO - Avg. fwd time: 35.1716 / Avg. bwd time: 46.2904 / Avg. batch time: 1602.7203 (ms) / GPU bubble ratio: 59.34%
[rank1]:2025-10-24 07:20:56,802 - INFO - Avg. fwd time: 54.2549 / Avg. bwd time: 63.3137 / Avg. batch time: 1715.8875 (ms) / GPU bubble ratio: 45.19%
[rank0]:2025-10-24 07:20:56,805 - INFO - Avg. fwd time: 47.8599 / Avg. bwd time: 39.1225 / Avg. batch time: 1792.4063 (ms) / GPU bubble ratio: 61.18%
[rank3]:2025-10-24 07:22:53,305 - INFO -  step: 220  loss:  1.1308  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,773  tflops: 21.68  mfu: 6.95%
[rank2]:2025-10-24 07:22:53,304 - INFO -  step: 220  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,768  tflops: 21.64  mfu: 6.94%
[rank0]:2025-10-24 07:22:53,305 - INFO -  step: 220  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,768  tflops: 21.64  mfu: 6.94%
[rank1]:2025-10-24 07:22:53,305 - INFO -  step: 220  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,768  tflops: 21.64  mfu: 6.94%
[rank3]:2025-10-24 07:22:54,714 - INFO - Avg. fwd time: 76.8789 / Avg. bwd time: 102.2909 / Avg. batch time: 1481.8399 (ms) / GPU bubble ratio: 3.27%
[rank2]:2025-10-24 07:22:54,748 - INFO - Avg. fwd time: 35.1734 / Avg. bwd time: 44.7626 / Avg. batch time: 1575.7322 (ms) / GPU bubble ratio: 59.42%
[rank0]:2025-10-24 07:22:54,796 - INFO - Avg. fwd time: 47.8381 / Avg. bwd time: 35.5661 / Avg. batch time: 1759.4052 (ms) / GPU bubble ratio: 62.08%
[rank1]:2025-10-24 07:22:54,791 - INFO - Avg. fwd time: 54.2791 / Avg. bwd time: 61.1366 / Avg. batch time: 1686.4708 (ms) / GPU bubble ratio: 45.25%
[rank3]:2025-10-24 07:24:51,547 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251024_0724_rank3_trend_line.svg
[rank2]:2025-10-24 07:24:51,545 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251024_0724_rank2_trend_line.svg
[rank2]:2025-10-24 07:24:51,585 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-24 07:24:51,587 - INFO -  step: 240  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,770  tflops: 21.66  mfu: 6.94%
[rank0]:2025-10-24 07:24:51,573 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251024_0724_rank0_trend_line.svg
[rank0]:2025-10-24 07:24:51,585 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-24 07:24:51,586 - INFO -  step: 240  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,770  tflops: 21.66  mfu: 6.94%
[rank1]:2025-10-24 07:24:51,579 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251024_0724_rank1_trend_line.svg
[rank1]:2025-10-24 07:24:51,585 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-10-24 07:24:51,586 - INFO -  step: 240  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,770  tflops: 21.66  mfu: 6.94%
[rank3]:2025-10-24 07:24:51,812 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/pipeline_schedule/251024_0724_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 1387.83 ms, GPU Bubble Ratio: 65.52%, 41.00%, 59.75%, 13.80%
[rank3]:2025-10-24 07:24:51,813 - INFO - 	> Batch Time: 1387.83 ms (Average Freeze Ratio: 0.34)
[rank3]:2025-10-24 07:24:51,813 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-24 07:24:51,817 - INFO -  step: 240  loss:  1.0609  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,765  tflops: 21.62  mfu: 6.93%
[rank3]:2025-10-24 07:24:53,112 - INFO - Avg. fwd time: 76.8664 / Avg. bwd time: 99.7667 / Avg. batch time: 1461.6752 (ms) / GPU bubble ratio: 3.33%
[rank2]:2025-10-24 07:24:53,146 - INFO - Avg. fwd time: 35.1718 / Avg. bwd time: 43.4907 / Avg. batch time: 1553.3973 (ms) / GPU bubble ratio: 59.49%
[rank0]:2025-10-24 07:24:53,193 - INFO - Avg. fwd time: 47.8056 / Avg. bwd time: 32.6024 / Avg. batch time: 1732.1252 (ms) / GPU bubble ratio: 62.86%
[rank1]:2025-10-24 07:24:53,189 - INFO - Avg. fwd time: 54.3541 / Avg. bwd time: 59.3324 / Avg. batch time: 1662.1692 (ms) / GPU bubble ratio: 45.28%
[rank3]:2025-10-24 07:25:30,805 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-24 07:25:31,545 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 07:25:31,589 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-24 07:25:31,588 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 07:25:44,850 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-24 07:26:49,775 - INFO -  step: 260  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,773  tflops: 21.67  mfu: 6.95%
[rank3]:2025-10-24 07:26:49,775 - INFO -  step: 260  loss:  1.1019  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,778  tflops: 21.72  mfu: 6.96%
[rank2]:2025-10-24 07:26:49,774 - INFO -  step: 260  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,773  tflops: 21.67  mfu: 6.95%
[rank0]:2025-10-24 07:26:49,775 - INFO -  step: 260  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,773  tflops: 21.67  mfu: 6.95%
[rank3]:2025-10-24 07:26:51,183 - INFO - Avg. fwd time: 76.8360 / Avg. bwd time: 97.6505 / Avg. batch time: 1444.6320 (ms) / GPU bubble ratio: 3.37%
[rank2]:2025-10-24 07:26:51,218 - INFO - Avg. fwd time: 35.1733 / Avg. bwd time: 42.4186 / Avg. batch time: 1534.4249 (ms) / GPU bubble ratio: 59.55%
[rank0]:2025-10-24 07:26:51,265 - INFO - Avg. fwd time: 47.7852 / Avg. bwd time: 30.0947 / Avg. batch time: 1708.9682 (ms) / GPU bubble ratio: 63.54%
[rank1]:2025-10-24 07:26:51,261 - INFO - Avg. fwd time: 54.4498 / Avg. bwd time: 57.8034 / Avg. batch time: 1641.5395 (ms) / GPU bubble ratio: 45.29%
[rank3]:2025-10-24 07:28:48,059 - INFO -  step: 280  loss:  1.1492  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,770  tflops: 21.66  mfu: 6.94%
[rank2]:2025-10-24 07:28:48,057 - INFO -  step: 280  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,770  tflops: 21.66  mfu: 6.94%
[rank0]:2025-10-24 07:28:48,059 - INFO -  step: 280  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,770  tflops: 21.66  mfu: 6.94%
[rank1]:2025-10-24 07:28:48,058 - INFO -  step: 280  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,770  tflops: 21.66  mfu: 6.94%
[rank3]:2025-10-24 07:28:49,453 - INFO - Avg. fwd time: 76.8466 / Avg. bwd time: 95.8228 / Avg. batch time: 1430.0996 (ms) / GPU bubble ratio: 3.41%
[rank2]:2025-10-24 07:28:49,488 - INFO - Avg. fwd time: 35.1689 / Avg. bwd time: 41.4993 / Avg. batch time: 1518.2463 (ms) / GPU bubble ratio: 59.60%
[rank0]:2025-10-24 07:28:49,536 - INFO - Avg. fwd time: 47.7422 / Avg. bwd time: 27.9452 / Avg. batch time: 1689.1766 (ms) / GPU bubble ratio: 64.15%
[rank1]:2025-10-24 07:28:49,532 - INFO - Avg. fwd time: 54.4914 / Avg. bwd time: 56.4950 / Avg. batch time: 1623.9047 (ms) / GPU bubble ratio: 45.32%
[rank0]:2025-10-24 07:30:40,360 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-24 07:30:46,259 - INFO -  step: 300  loss:  1.1178  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,772  tflops: 21.67  mfu: 6.95%
[rank2]:2025-10-24 07:30:46,257 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,772  tflops: 21.67  mfu: 6.95%
[rank0]:2025-10-24 07:30:46,258 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,772  tflops: 21.67  mfu: 6.95%
[rank1]:2025-10-24 07:30:46,258 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,772  tflops: 21.67  mfu: 6.95%
[rank2]:2025-10-24 07:30:46,328 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251024_0730_stage2_step300.svg
[rank0]:2025-10-24 07:30:46,329 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251024_0730_stage0_step300.svg
[rank1]:2025-10-24 07:30:46,328 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251024_0730_stage1_step300.svg
[rank3]:2025-10-24 07:30:46,472 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/pipeline_schedule/251024_0730_real_step300_rank3.svg
[rank3]:> Batch Time: 1386.16 ms, GPU Bubble Ratio: 72.20%, 45.04%, 62.69%, 13.16%
[rank3]:2025-10-24 07:30:46,534 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251024_0730_stage3_step300.svg
[rank3]:2025-10-24 07:30:47,822 - INFO - Avg. fwd time: 76.8258 / Avg. bwd time: 94.2287 / Avg. batch time: 1417.3878 (ms) / GPU bubble ratio: 3.45%
[rank2]:2025-10-24 07:30:47,857 - INFO - Avg. fwd time: 35.1545 / Avg. bwd time: 40.6975 / Avg. batch time: 1504.1520 (ms) / GPU bubble ratio: 59.66%
[rank1]:2025-10-24 07:30:47,902 - INFO - Avg. fwd time: 54.5994 / Avg. bwd time: 55.3591 / Avg. batch time: 1608.6274 (ms) / GPU bubble ratio: 45.32%
[rank0]:2025-10-24 07:30:47,907 - INFO - Avg. fwd time: 47.7263 / Avg. bwd time: 26.0824 / Avg. batch time: 1672.0213 (ms) / GPU bubble ratio: 64.69%
[rank0]:2025-10-24 07:32:44,619 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251024_0732_rank0_trend_line.svg
[rank2]:2025-10-24 07:32:44,576 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251024_0732_rank2_trend_line.svg
[rank2]:2025-10-24 07:32:44,624 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-24 07:32:44,626 - INFO -  step: 320  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,768  tflops: 21.64  mfu: 6.94%
[rank3]:2025-10-24 07:32:44,578 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251024_0732_rank3_trend_line.svg
[rank1]:2025-10-24 07:32:44,618 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251024_0732_rank1_trend_line.svg
[rank1]:2025-10-24 07:32:44,624 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-10-24 07:32:44,626 - INFO -  step: 320  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,768  tflops: 21.64  mfu: 6.94%
[rank0]:2025-10-24 07:32:44,625 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-24 07:32:44,626 - INFO -  step: 320  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,768  tflops: 21.64  mfu: 6.94%
[rank3]:2025-10-24 07:32:44,848 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/pipeline_schedule/251024_0732_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 1385.14 ms, GPU Bubble Ratio: 68.11%, 42.96%, 60.92%, 13.61%
[rank3]:2025-10-24 07:32:44,849 - INFO - 	> Batch Time: 1385.14 ms (Average Freeze Ratio: 0.34)
[rank3]:2025-10-24 07:32:44,850 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-24 07:32:44,853 - INFO -  step: 320  loss:  1.1098  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,763  tflops: 21.60  mfu: 6.92%
[rank2]:2025-10-24 07:32:46,184 - INFO - Avg. fwd time: 35.1485 / Avg. bwd time: 39.9983 / Avg. batch time: 1491.8334 (ms) / GPU bubble ratio: 59.70%
[rank3]:2025-10-24 07:32:46,149 - INFO - Avg. fwd time: 76.8142 / Avg. bwd time: 92.8476 / Avg. batch time: 1406.2500 (ms) / GPU bubble ratio: 3.48%
[rank1]:2025-10-24 07:32:46,228 - INFO - Avg. fwd time: 54.6553 / Avg. bwd time: 54.3646 / Avg. batch time: 1595.1936 (ms) / GPU bubble ratio: 45.33%
[rank0]:2025-10-24 07:32:46,232 - INFO - Avg. fwd time: 47.7220 / Avg. bwd time: 24.4523 / Avg. batch time: 1656.9410 (ms) / GPU bubble ratio: 65.15%
[rank3]:2025-10-24 07:33:38,671 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 07:33:39,467 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-24 07:33:39,425 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-24 07:33:39,466 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 07:34:42,964 - INFO -  step: 340  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,769  tflops: 21.65  mfu: 6.94%
[rank2]:2025-10-24 07:34:42,963 - INFO -  step: 340  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,769  tflops: 21.65  mfu: 6.94%
[rank3]:2025-10-24 07:34:42,964 - INFO -  step: 340  loss:  1.0876  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,774  tflops: 21.69  mfu: 6.95%
[rank1]:2025-10-24 07:34:42,964 - INFO -  step: 340  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,769  tflops: 21.65  mfu: 6.94%
[rank3]:2025-10-24 07:34:44,371 - INFO - Avg. fwd time: 76.8093 / Avg. bwd time: 91.6352 / Avg. batch time: 1396.5751 (ms) / GPU bubble ratio: 3.51%
[rank0]:2025-10-24 07:34:44,453 - INFO - Avg. fwd time: 47.7303 / Avg. bwd time: 23.0141 / Avg. batch time: 1643.7483 (ms) / GPU bubble ratio: 65.57%
[rank2]:2025-10-24 07:34:44,406 - INFO - Avg. fwd time: 35.1480 / Avg. bwd time: 39.3831 / Avg. batch time: 1481.0395 (ms) / GPU bubble ratio: 59.74%
[rank1]:2025-10-24 07:34:44,449 - INFO - Avg. fwd time: 54.7210 / Avg. bwd time: 53.4903 / Avg. batch time: 1583.4408 (ms) / GPU bubble ratio: 45.33%
[rank0]:2025-10-24 07:35:36,011 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-24 07:36:40,887 - INFO -  step: 360  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,779  tflops: 21.72  mfu: 6.96%
[rank2]:2025-10-24 07:36:40,886 - INFO -  step: 360  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,779  tflops: 21.72  mfu: 6.96%
[rank3]:2025-10-24 07:36:40,887 - INFO -  step: 360  loss:  1.1727  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,779  tflops: 21.72  mfu: 6.96%
[rank1]:2025-10-24 07:36:40,887 - INFO -  step: 360  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,779  tflops: 21.72  mfu: 6.96%
[rank2]:2025-10-24 07:36:42,313 - INFO - Avg. fwd time: 35.1534 / Avg. bwd time: 38.8348 / Avg. batch time: 1471.2405 (ms) / GPU bubble ratio: 59.77%
[rank3]:2025-10-24 07:36:42,277 - INFO - Avg. fwd time: 76.7937 / Avg. bwd time: 90.5471 / Avg. batch time: 1387.7690 (ms) / GPU bubble ratio: 3.53%
[rank1]:2025-10-24 07:36:42,356 - INFO - Avg. fwd time: 54.7422 / Avg. bwd time: 52.7112 / Avg. batch time: 1572.7583 (ms) / GPU bubble ratio: 45.34%
[rank0]:2025-10-24 07:36:42,360 - INFO - Avg. fwd time: 47.7290 / Avg. bwd time: 21.7357 / Avg. batch time: 1631.7750 (ms) / GPU bubble ratio: 65.94%
[rank2]:2025-10-24 07:38:38,886 - INFO -  step: 380  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,777  tflops: 21.71  mfu: 6.96%
[rank3]:2025-10-24 07:38:38,887 - INFO -  step: 380  loss:  1.1005  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,777  tflops: 21.71  mfu: 6.96%
[rank1]:2025-10-24 07:38:38,887 - INFO -  step: 380  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,777  tflops: 21.71  mfu: 6.96%
[rank0]:2025-10-24 07:38:38,887 - INFO -  step: 380  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,777  tflops: 21.71  mfu: 6.96%
[rank3]:2025-10-24 07:38:40,285 - INFO - Avg. fwd time: 76.7777 / Avg. bwd time: 89.5735 / Avg. batch time: 1379.9098 (ms) / GPU bubble ratio: 3.56%
[rank0]:2025-10-24 07:38:40,371 - INFO - Avg. fwd time: 47.7196 / Avg. bwd time: 20.5918 / Avg. batch time: 1621.1120 (ms) / GPU bubble ratio: 66.29%
[rank2]:2025-10-24 07:38:40,320 - INFO - Avg. fwd time: 35.1375 / Avg. bwd time: 38.3446 / Avg. batch time: 1462.4727 (ms) / GPU bubble ratio: 59.80%
[rank1]:2025-10-24 07:38:40,367 - INFO - Avg. fwd time: 54.8022 / Avg. bwd time: 52.0135 / Avg. batch time: 1563.2416 (ms) / GPU bubble ratio: 45.34%
[rank0]:2025-10-24 07:40:31,545 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-24 07:40:37,458 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,764  tflops: 21.60  mfu: 6.92%
[rank3]:2025-10-24 07:40:37,460 - INFO -  step: 400  loss:  1.0605  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,764  tflops: 21.60  mfu: 6.92%
[rank1]:2025-10-24 07:40:37,460 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,764  tflops: 21.60  mfu: 6.92%
[rank0]:2025-10-24 07:40:37,460 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,764  tflops: 21.60  mfu: 6.92%
[rank0]:2025-10-24 07:40:37,537 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251024_0740_stage0_step400.svg
[rank2]:2025-10-24 07:40:37,535 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251024_0740_stage2_step400.svg
[rank1]:2025-10-24 07:40:37,536 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251024_0740_stage1_step400.svg
[rank3]:2025-10-24 07:40:37,673 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/pipeline_schedule/251024_0740_real_step400_rank3.svg
[rank3]:> Batch Time: 1383.11 ms, GPU Bubble Ratio: 72.15%, 45.20%, 62.80%, 13.14%
[rank3]:2025-10-24 07:40:37,739 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251024_0740_stage3_step400.svg
[rank2]:2025-10-24 07:40:39,038 - INFO - Avg. fwd time: 35.1361 / Avg. bwd time: 37.9037 / Avg. batch time: 1454.9589 (ms) / GPU bubble ratio: 59.84%
[rank3]:2025-10-24 07:40:39,003 - INFO - Avg. fwd time: 76.7964 / Avg. bwd time: 88.7065 / Avg. batch time: 1373.1402 (ms) / GPU bubble ratio: 3.58%
[rank1]:2025-10-24 07:40:39,083 - INFO - Avg. fwd time: 54.8173 / Avg. bwd time: 51.3848 / Avg. batch time: 1555.0510 (ms) / GPU bubble ratio: 45.36%
[rank0]:2025-10-24 07:40:39,088 - INFO - Avg. fwd time: 47.7043 / Avg. bwd time: 19.5623 / Avg. batch time: 1611.8925 (ms) / GPU bubble ratio: 66.61%
[rank3]:2025-10-24 07:41:45,150 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-24 07:41:45,899 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-24 07:41:45,942 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 07:41:45,943 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 07:42:36,398 - INFO -  step: 420  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,755  tflops: 21.54  mfu: 6.90%
[rank2]:2025-10-24 07:42:36,396 - INFO -  step: 420  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,755  tflops: 21.54  mfu: 6.90%
[rank3]:2025-10-24 07:42:36,398 - INFO -  step: 420  loss:  1.0569  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,755  tflops: 21.54  mfu: 6.90%
[rank1]:2025-10-24 07:42:36,397 - INFO -  step: 420  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,755  tflops: 21.54  mfu: 6.90%
[rank2]:2025-10-24 07:42:37,831 - INFO - Avg. fwd time: 35.1357 / Avg. bwd time: 37.5053 / Avg. batch time: 1448.2519 (ms) / GPU bubble ratio: 59.87%
[rank3]:2025-10-24 07:42:37,796 - INFO - Avg. fwd time: 76.8180 / Avg. bwd time: 87.9335 / Avg. batch time: 1367.1653 (ms) / GPU bubble ratio: 3.60%
[rank0]:2025-10-24 07:42:37,880 - INFO - Avg. fwd time: 47.7036 / Avg. bwd time: 18.6309 / Avg. batch time: 1603.6445 (ms) / GPU bubble ratio: 66.91%
[rank1]:2025-10-24 07:42:37,875 - INFO - Avg. fwd time: 54.8502 / Avg. bwd time: 50.8167 / Avg. batch time: 1547.7357 (ms) / GPU bubble ratio: 45.38%
[rank0]:2025-10-24 07:44:34,471 - INFO -  step: 440  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,775  tflops: 21.70  mfu: 6.95%
[rank2]:2025-10-24 07:44:34,470 - INFO -  step: 440  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,775  tflops: 21.70  mfu: 6.95%
[rank3]:2025-10-24 07:44:34,471 - INFO -  step: 440  loss:  1.1242  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,775  tflops: 21.70  mfu: 6.95%
[rank1]:2025-10-24 07:44:34,471 - INFO -  step: 440  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,775  tflops: 21.70  mfu: 6.95%
[rank3]:2025-10-24 07:44:35,887 - INFO - Avg. fwd time: 76.8060 / Avg. bwd time: 87.2112 / Avg. batch time: 1361.3389 (ms) / GPU bubble ratio: 3.61%
[rank0]:2025-10-24 07:44:35,973 - INFO - Avg. fwd time: 47.6789 / Avg. bwd time: 17.7841 / Avg. batch time: 1595.7411 (ms) / GPU bubble ratio: 67.18%
[rank2]:2025-10-24 07:44:35,924 - INFO - Avg. fwd time: 35.1279 / Avg. bwd time: 37.1418 / Avg. batch time: 1441.7674 (ms) / GPU bubble ratio: 59.90%
[rank1]:2025-10-24 07:44:35,968 - INFO - Avg. fwd time: 54.8807 / Avg. bwd time: 50.2985 / Avg. batch time: 1540.6834 (ms) / GPU bubble ratio: 45.39%
[rank0]:2025-10-24 07:45:27,747 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-24 07:46:32,862 - INFO -  step: 460  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,768  tflops: 21.64  mfu: 6.93%
[rank1]:2025-10-24 07:46:32,863 - INFO -  step: 460  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,768  tflops: 21.64  mfu: 6.93%
[rank3]:2025-10-24 07:46:32,863 - INFO -  step: 460  loss:  1.1862  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,768  tflops: 21.64  mfu: 6.94%
[rank0]:2025-10-24 07:46:32,863 - INFO -  step: 460  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,768  tflops: 21.64  mfu: 6.93%
[rank3]:2025-10-24 07:46:34,279 - INFO - Avg. fwd time: 76.7960 / Avg. bwd time: 86.5641 / Avg. batch time: 1356.1446 (ms) / GPU bubble ratio: 3.63%
[rank2]:2025-10-24 07:46:34,314 - INFO - Avg. fwd time: 35.1284 / Avg. bwd time: 36.8106 / Avg. batch time: 1435.9674 (ms) / GPU bubble ratio: 59.92%
[rank1]:2025-10-24 07:46:34,361 - INFO - Avg. fwd time: 54.9233 / Avg. bwd time: 49.8260 / Avg. batch time: 1534.3721 (ms) / GPU bubble ratio: 45.39%
[rank0]:2025-10-24 07:46:34,367 - INFO - Avg. fwd time: 47.6783 / Avg. bwd time: 17.0110 / Avg. batch time: 1588.6554 (ms) / GPU bubble ratio: 67.42%
[rank0]:2025-10-24 07:48:31,694 - INFO -  step: 480  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,758  tflops: 21.56  mfu: 6.91%
[rank2]:2025-10-24 07:48:31,693 - INFO -  step: 480  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,758  tflops: 21.56  mfu: 6.91%
[rank3]:2025-10-24 07:48:31,694 - INFO -  step: 480  loss:  1.1105  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,758  tflops: 21.56  mfu: 6.91%
[rank1]:2025-10-24 07:48:31,694 - INFO -  step: 480  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,758  tflops: 21.56  mfu: 6.91%
[rank3]:2025-10-24 07:48:33,114 - INFO - Avg. fwd time: 76.8197 / Avg. bwd time: 85.9743 / Avg. batch time: 1351.6116 (ms) / GPU bubble ratio: 3.64%
[rank2]:2025-10-24 07:48:33,150 - INFO - Avg. fwd time: 35.1307 / Avg. bwd time: 36.5096 / Avg. batch time: 1430.8836 (ms) / GPU bubble ratio: 59.95%
[rank1]:2025-10-24 07:48:33,197 - INFO - Avg. fwd time: 54.9368 / Avg. bwd time: 49.3950 / Avg. batch time: 1528.8312 (ms) / GPU bubble ratio: 45.41%
[rank0]:2025-10-24 07:48:33,202 - INFO - Avg. fwd time: 47.6653 / Avg. bwd time: 16.3023 / Avg. batch time: 1582.4080 (ms) / GPU bubble ratio: 67.66%
[rank3]:2025-10-24 07:49:52,625 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 07:49:53,409 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-24 07:49:53,367 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-24 07:49:53,407 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 07:50:24,392 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-24 07:50:30,249 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,764  tflops: 21.61  mfu: 6.93%
[rank0]:2025-10-24 07:50:30,249 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-24 07:50:30,249 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank2]:2025-10-24 07:50:30,248 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,764  tflops: 21.61  mfu: 6.93%
[rank2]:2025-10-24 07:50:30,248 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-24 07:50:30,249 - INFO -  step: 500  loss:  1.0695  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,764  tflops: 21.61  mfu: 6.93%
[rank3]:2025-10-24 07:50:30,250 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-24 07:50:30,249 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,764  tflops: 21.61  mfu: 6.93%
[rank1]:2025-10-24 07:50:30,249 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-24 07:50:32,104 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 1.86 seconds.
[rank1]:2025-10-24 07:50:32,499 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 2.25 seconds.
[rank3]:2025-10-24 07:50:33,556 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.31 seconds.
[rank0]:2025-10-24 07:50:33,945 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-24 07:50:33,954 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.71 seconds.
[rank2]:2025-10-24 07:50:34,026 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251024_0750_stage2_step500.svg
[rank1]:2025-10-24 07:50:34,027 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251024_0750_stage1_step500.svg
[rank0]:2025-10-24 07:50:34,085 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251024_0750_stage0_step500.svg
[rank3]:2025-10-24 07:50:34,316 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/pipeline_schedule/251024_0750_real_step500_rank3.svg
[rank3]:> Batch Time: 1383.14 ms, GPU Bubble Ratio: 72.16%, 45.20%, 62.86%, 13.17%
[rank3]:2025-10-24 07:50:34,377 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251024_0750_stage3_step500.svg
[rank3]:2025-10-24 07:50:35,666 - INFO - Avg. fwd time: 76.8396 / Avg. bwd time: 85.4200 / Avg. batch time: 1347.2999 (ms) / GPU bubble ratio: 3.65%
[rank0]:2025-10-24 07:50:35,752 - INFO - Avg. fwd time: 47.6686 / Avg. bwd time: 15.6503 / Avg. batch time: 1576.5662 (ms) / GPU bubble ratio: 67.87%
[rank2]:2025-10-24 07:50:35,703 - INFO - Avg. fwd time: 35.1282 / Avg. bwd time: 36.2308 / Avg. batch time: 1426.1429 (ms) / GPU bubble ratio: 59.97%
[rank1]:2025-10-24 07:50:35,746 - INFO - Avg. fwd time: 54.9287 / Avg. bwd time: 48.9973 / Avg. batch time: 1523.6383 (ms) / GPU bubble ratio: 45.43%
[rank0]:2025-10-24 07:52:32,480 - INFO -  step: 520  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,681  tflops: 20.96  mfu: 6.72%
[rank2]:2025-10-24 07:52:32,479 - INFO -  step: 520  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,681  tflops: 20.96  mfu: 6.72%
[rank3]:2025-10-24 07:52:32,480 - INFO -  step: 520  loss:  1.1456  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,681  tflops: 20.96  mfu: 6.72%
[rank1]:2025-10-24 07:52:32,480 - INFO -  step: 520  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,681  tflops: 20.96  mfu: 6.72%
[rank2]:2025-10-24 07:52:33,934 - INFO - Avg. fwd time: 35.1275 / Avg. bwd time: 35.9713 / Avg. batch time: 1421.5259 (ms) / GPU bubble ratio: 59.99%
[rank3]:2025-10-24 07:52:33,899 - INFO - Avg. fwd time: 76.8303 / Avg. bwd time: 84.9105 / Avg. batch time: 1343.1670 (ms) / GPU bubble ratio: 3.67%
[rank1]:2025-10-24 07:52:33,979 - INFO - Avg. fwd time: 54.9367 / Avg. bwd time: 48.6306 / Avg. batch time: 1518.6261 (ms) / GPU bubble ratio: 45.44%
[rank0]:2025-10-24 07:52:33,985 - INFO - Avg. fwd time: 47.6592 / Avg. bwd time: 15.0484 / Avg. batch time: 1570.9546 (ms) / GPU bubble ratio: 68.07%
[rank3]:2025-10-24 07:54:31,212 - INFO -  step: 540  loss:  1.1391  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,760  tflops: 21.58  mfu: 6.92%
[rank1]:2025-10-24 07:54:31,211 - INFO -  step: 540  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,760  tflops: 21.58  mfu: 6.92%
[rank0]:2025-10-24 07:54:31,212 - INFO -  step: 540  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,760  tflops: 21.58  mfu: 6.92%
[rank2]:2025-10-24 07:54:31,211 - INFO -  step: 540  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,760  tflops: 21.58  mfu: 6.92%
[rank3]:2025-10-24 07:54:32,614 - INFO - Avg. fwd time: 76.8412 / Avg. bwd time: 84.4446 / Avg. batch time: 1339.5598 (ms) / GPU bubble ratio: 3.68%
[rank2]:2025-10-24 07:54:32,650 - INFO - Avg. fwd time: 35.1254 / Avg. bwd time: 35.7341 / Avg. batch time: 1417.4857 (ms) / GPU bubble ratio: 60.01%
[rank1]:2025-10-24 07:54:32,694 - INFO - Avg. fwd time: 54.9614 / Avg. bwd time: 48.2908 / Avg. batch time: 1514.2114 (ms) / GPU bubble ratio: 45.45%
[rank0]:2025-10-24 07:54:32,700 - INFO - Avg. fwd time: 47.6540 / Avg. bwd time: 14.4912 / Avg. batch time: 1565.9859 (ms) / GPU bubble ratio: 68.25%
[rank0]:2025-10-24 07:55:25,010 - INFO - [GC] Peforming periodical GC collection 0.26 seconds
[rank3]:2025-10-24 07:56:30,365 - INFO -  step: 560  loss:  1.1142  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,750  tflops: 21.50  mfu: 6.89%
[rank1]:2025-10-24 07:56:30,364 - INFO -  step: 560  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,750  tflops: 21.50  mfu: 6.89%
[rank0]:2025-10-24 07:56:30,364 - INFO -  step: 560  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,750  tflops: 21.50  mfu: 6.89%
[rank2]:2025-10-24 07:56:30,363 - INFO -  step: 560  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,750  tflops: 21.50  mfu: 6.89%
[rank3]:2025-10-24 07:56:31,792 - INFO - Avg. fwd time: 76.8551 / Avg. bwd time: 84.0159 / Avg. batch time: 1336.2612 (ms) / GPU bubble ratio: 3.69%
[rank2]:2025-10-24 07:56:31,829 - INFO - Avg. fwd time: 35.1236 / Avg. bwd time: 35.5137 / Avg. batch time: 1413.7804 (ms) / GPU bubble ratio: 60.03%
[rank1]:2025-10-24 07:56:31,875 - INFO - Avg. fwd time: 54.9894 / Avg. bwd time: 47.9776 / Avg. batch time: 1510.1736 (ms) / GPU bubble ratio: 45.45%
[rank0]:2025-10-24 07:56:31,881 - INFO - Avg. fwd time: 47.6617 / Avg. bwd time: 13.9737 / Avg. batch time: 1561.4396 (ms) / GPU bubble ratio: 68.42%
[rank3]:2025-10-24 07:58:04,977 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-24 07:58:05,026 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-24 07:58:04,986 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 07:58:05,029 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-24 07:58:28,666 - INFO -  step: 580  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,770  tflops: 21.65  mfu: 6.94%
[rank0]:2025-10-24 07:58:28,666 - INFO -  step: 580  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,770  tflops: 21.65  mfu: 6.94%
[rank2]:2025-10-24 07:58:28,665 - INFO -  step: 580  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,770  tflops: 21.65  mfu: 6.94%
[rank3]:2025-10-24 07:58:28,666 - INFO -  step: 580  loss:  1.0654  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,770  tflops: 21.65  mfu: 6.94%
[rank2]:2025-10-24 07:58:30,097 - INFO - Avg. fwd time: 35.1247 / Avg. bwd time: 35.3073 / Avg. batch time: 1410.0901 (ms) / GPU bubble ratio: 60.04%
[rank3]:2025-10-24 07:58:30,061 - INFO - Avg. fwd time: 76.8466 / Avg. bwd time: 83.6093 / Avg. batch time: 1332.9501 (ms) / GPU bubble ratio: 3.70%
[rank1]:2025-10-24 07:58:30,141 - INFO - Avg. fwd time: 55.0015 / Avg. bwd time: 47.6839 / Avg. batch time: 1506.1612 (ms) / GPU bubble ratio: 45.46%
[rank0]:2025-10-24 07:58:30,147 - INFO - Avg. fwd time: 47.6513 / Avg. bwd time: 13.4919 / Avg. batch time: 1556.9410 (ms) / GPU bubble ratio: 68.58%
[rank0]:2025-10-24 08:00:20,979 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-24 08:00:26,925 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,771  tflops: 21.66  mfu: 6.94%
[rank0]:2025-10-24 08:00:26,925 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,771  tflops: 21.66  mfu: 6.94%
[rank2]:2025-10-24 08:00:26,924 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,771  tflops: 21.66  mfu: 6.94%
[rank3]:2025-10-24 08:00:26,925 - INFO -  step: 600  loss:  1.1463  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,771  tflops: 21.66  mfu: 6.94%
[rank1]:2025-10-24 08:00:26,997 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251024_0800_stage1_step600.svg
[rank0]:2025-10-24 08:00:26,997 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251024_0800_stage0_step600.svg
[rank2]:2025-10-24 08:00:26,997 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251024_0800_stage2_step600.svg
[rank3]:2025-10-24 08:00:27,137 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/pipeline_schedule/251024_0800_real_step600_rank3.svg
[rank3]:> Batch Time: 1385.13 ms, GPU Bubble Ratio: 72.21%, 45.14%, 62.94%, 13.32%
[rank3]:2025-10-24 08:00:27,198 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251024_0800_stage3_step600.svg
[rank2]:2025-10-24 08:00:28,532 - INFO - Avg. fwd time: 35.1196 / Avg. bwd time: 35.1142 / Avg. batch time: 1406.7106 (ms) / GPU bubble ratio: 60.06%
[rank3]:2025-10-24 08:00:28,496 - INFO - Avg. fwd time: 76.8465 / Avg. bwd time: 83.2278 / Avg. batch time: 1329.8931 (ms) / GPU bubble ratio: 3.71%
[rank1]:2025-10-24 08:00:28,578 - INFO - Avg. fwd time: 55.0096 / Avg. bwd time: 47.4101 / Avg. batch time: 1502.4753 (ms) / GPU bubble ratio: 45.47%
[rank0]:2025-10-24 08:00:28,583 - INFO - Avg. fwd time: 47.6461 / Avg. bwd time: 13.0423 / Avg. batch time: 1552.8042 (ms) / GPU bubble ratio: 68.73%
[rank2]:2025-10-24 08:02:25,387 - INFO -  step: 620  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,766  tflops: 21.62  mfu: 6.93%
[rank3]:2025-10-24 08:02:25,389 - INFO -  step: 620  loss:  1.1559  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,766  tflops: 21.62  mfu: 6.93%
[rank0]:2025-10-24 08:02:25,389 - INFO -  step: 620  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,766  tflops: 21.62  mfu: 6.93%
[rank1]:2025-10-24 08:02:25,388 - INFO -  step: 620  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,766  tflops: 21.62  mfu: 6.93%
[rank3]:2025-10-24 08:02:26,802 - INFO - Avg. fwd time: 76.8516 / Avg. bwd time: 82.8738 / Avg. batch time: 1327.0646 (ms) / GPU bubble ratio: 3.71%
[rank1]:2025-10-24 08:02:26,885 - INFO - Avg. fwd time: 55.0141 / Avg. bwd time: 47.1548 / Avg. batch time: 1499.0131 (ms) / GPU bubble ratio: 45.47%
[rank2]:2025-10-24 08:02:26,839 - INFO - Avg. fwd time: 35.1196 / Avg. bwd time: 34.9343 / Avg. batch time: 1403.5515 (ms) / GPU bubble ratio: 60.07%
[rank0]:2025-10-24 08:02:26,891 - INFO - Avg. fwd time: 47.6399 / Avg. bwd time: 12.6216 / Avg. batch time: 1548.9179 (ms) / GPU bubble ratio: 68.88%
[rank3]:2025-10-24 08:04:24,073 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251024_0804_rank3_trend_line.svg
[rank1]:2025-10-24 08:04:24,116 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251024_0804_rank1_trend_line.svg
[rank1]:2025-10-24 08:04:24,122 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank1]:2025-10-24 08:04:24,124 - INFO -  step: 640  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,760  tflops: 21.57  mfu: 6.91%
[rank2]:2025-10-24 08:04:24,091 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251024_0804_rank2_trend_line.svg
[rank2]:2025-10-24 08:04:24,123 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-24 08:04:24,126 - INFO -  step: 640  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,760  tflops: 21.57  mfu: 6.91%
[rank0]:2025-10-24 08:04:24,114 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251024_0804_rank0_trend_line.svg
[rank0]:2025-10-24 08:04:24,122 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-24 08:04:24,124 - INFO -  step: 640  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,760  tflops: 21.57  mfu: 6.91%
[rank3]:2025-10-24 08:04:24,345 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/pipeline_schedule/251024_0804_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 1380.69 ms, GPU Bubble Ratio: 70.39%, 44.61%, 61.92%, 13.27%
[rank3]:2025-10-24 08:04:24,346 - INFO - 	> Batch Time: 1380.69 ms (Average Freeze Ratio: 0.31)
[rank3]:2025-10-24 08:04:24,346 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-24 08:04:24,351 - INFO -  step: 640  loss:  1.0876  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,755  tflops: 21.53  mfu: 6.90%
[rank3]:2025-10-24 08:04:25,654 - INFO - Avg. fwd time: 76.8580 / Avg. bwd time: 82.5427 / Avg. batch time: 1324.4418 (ms) / GPU bubble ratio: 3.72%
[rank1]:2025-10-24 08:04:25,735 - INFO - Avg. fwd time: 55.0187 / Avg. bwd time: 46.9156 / Avg. batch time: 1495.8508 (ms) / GPU bubble ratio: 45.48%
[rank2]:2025-10-24 08:04:25,691 - INFO - Avg. fwd time: 35.1142 / Avg. bwd time: 34.7665 / Avg. batch time: 1400.6658 (ms) / GPU bubble ratio: 60.09%
[rank0]:2025-10-24 08:04:25,741 - INFO - Avg. fwd time: 47.6344 / Avg. bwd time: 12.2272 / Avg. batch time: 1545.3611 (ms) / GPU bubble ratio: 69.01%
[rank0]:2025-10-24 08:05:24,546 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-24 08:06:27,423 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-24 08:06:28,330 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 08:06:28,425 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-24 08:06:28,427 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-24 08:06:38,411 - INFO -  step: 660  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,440  tflops: 19.08  mfu: 6.11%
[rank3]:2025-10-24 08:06:38,412 - INFO -  step: 660  loss:  1.0787  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,444  tflops: 19.11  mfu: 6.12%
[rank0]:2025-10-24 08:06:38,411 - INFO -  step: 660  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,440  tflops: 19.08  mfu: 6.11%
[rank1]:2025-10-24 08:06:38,434 - INFO -  step: 660  loss: -4.0000  grad_norm:  0.2324  memory: 20.03GiB(42.17%)  tps: 2,440  tflops: 19.07  mfu: 6.11%
[rank3]:2025-10-24 08:06:39,821 - INFO - Avg. fwd time: 76.8372 / Avg. bwd time: 82.2248 / Avg. batch time: 1321.7779 (ms) / GPU bubble ratio: 3.73%
[rank2]:2025-10-24 08:06:39,958 - INFO - Avg. fwd time: 35.1164 / Avg. bwd time: 34.5993 / Avg. batch time: 1400.4655 (ms) / GPU bubble ratio: 60.18%
[rank1]:2025-10-24 08:06:40,117 - INFO - Avg. fwd time: 55.0547 / Avg. bwd time: 48.2147 / Avg. batch time: 1498.9015 (ms) / GPU bubble ratio: 44.88%
[rank0]:2025-10-24 08:06:40,123 - INFO - Avg. fwd time: 47.6351 / Avg. bwd time: 11.8568 / Avg. batch time: 1548.0417 (ms) / GPU bubble ratio: 69.26%
[rank2]:2025-10-24 08:08:52,617 - INFO -  step: 680  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,442  tflops: 19.09  mfu: 6.12%
[rank0]:2025-10-24 08:08:52,617 - INFO -  step: 680  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,442  tflops: 19.09  mfu: 6.12%
[rank3]:2025-10-24 08:08:52,619 - INFO -  step: 680  loss:  1.0948  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,442  tflops: 19.09  mfu: 6.12%
[rank1]:2025-10-24 08:08:52,641 - INFO -  step: 680  loss: -4.0000  grad_norm:  0.2068  memory: 20.03GiB(42.17%)  tps: 2,442  tflops: 19.09  mfu: 6.12%
[rank3]:2025-10-24 08:08:54,028 - INFO - Avg. fwd time: 76.8222 / Avg. bwd time: 81.9089 / Avg. batch time: 1319.1197 (ms) / GPU bubble ratio: 3.74%
[rank2]:2025-10-24 08:08:54,154 - INFO - Avg. fwd time: 35.1155 / Avg. bwd time: 34.4404 / Avg. batch time: 1400.1984 (ms) / GPU bubble ratio: 60.26%
[rank1]:2025-10-24 08:08:54,312 - INFO - Avg. fwd time: 55.0793 / Avg. bwd time: 49.4330 / Avg. batch time: 1501.6910 (ms) / GPU bubble ratio: 44.32%
[rank0]:2025-10-24 08:08:54,318 - INFO - Avg. fwd time: 47.6333 / Avg. bwd time: 11.5081 / Avg. batch time: 1550.4797 (ms) / GPU bubble ratio: 69.48%
[rank0]:2025-10-24 08:11:00,295 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-24 08:11:06,997 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,438  tflops: 19.06  mfu: 6.11%
[rank3]:2025-10-24 08:11:06,998 - INFO -  step: 700  loss:  1.1254  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,439  tflops: 19.06  mfu: 6.11%
[rank0]:2025-10-24 08:11:06,997 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,438  tflops: 19.06  mfu: 6.11%
[rank1]:2025-10-24 08:11:07,020 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.2002  memory: 20.03GiB(42.17%)  tps: 2,438  tflops: 19.06  mfu: 6.11%
[rank2]:2025-10-24 08:11:07,097 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251024_0811_stage2_step700.svg
[rank0]:2025-10-24 08:11:07,094 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251024_0811_stage0_step700.svg
[rank1]:2025-10-24 08:11:07,099 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251024_0811_stage1_step700.svg
[rank3]:2025-10-24 08:11:07,238 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/pipeline_schedule/251024_0811_real_step700_rank3.svg
[rank3]:> Batch Time: 1384.92 ms, GPU Bubble Ratio: 72.20%, 44.96%, 62.96%, 13.38%
[rank3]:2025-10-24 08:11:07,303 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251024_0811_stage3_step700.svg
[rank3]:2025-10-24 08:11:08,587 - INFO - Avg. fwd time: 76.7884 / Avg. bwd time: 81.6114 / Avg. batch time: 1316.5878 (ms) / GPU bubble ratio: 3.75%
[rank2]:2025-10-24 08:11:08,709 - INFO - Avg. fwd time: 35.1189 / Avg. bwd time: 34.2900 / Avg. batch time: 1400.0149 (ms) / GPU bubble ratio: 60.34%
[rank1]:2025-10-24 08:11:08,867 - INFO - Avg. fwd time: 55.1142 / Avg. bwd time: 50.5901 / Avg. batch time: 1504.3860 (ms) / GPU bubble ratio: 43.79%
[rank0]:2025-10-24 08:11:08,873 - INFO - Avg. fwd time: 47.6378 / Avg. bwd time: 11.1794 / Avg. batch time: 1552.8520 (ms) / GPU bubble ratio: 69.70%
[rank0]:2025-10-24 08:13:21,433 - INFO -  step: 720  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,437  tflops: 19.05  mfu: 6.11%
[rank1]:2025-10-24 08:13:21,457 - INFO -  step: 720  loss: -4.0000  grad_norm:  0.2024  memory: 20.03GiB(42.17%)  tps: 2,437  tflops: 19.05  mfu: 6.11%
[rank2]:2025-10-24 08:13:21,433 - INFO -  step: 720  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,437  tflops: 19.05  mfu: 6.11%
[rank3]:2025-10-24 08:13:21,435 - INFO -  step: 720  loss:  1.0902  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,437  tflops: 19.06  mfu: 6.11%
[rank3]:2025-10-24 08:13:22,820 - INFO - Avg. fwd time: 76.7667 / Avg. bwd time: 81.3369 / Avg. batch time: 1314.2169 (ms) / GPU bubble ratio: 3.76%
[rank2]:2025-10-24 08:13:22,960 - INFO - Avg. fwd time: 35.1144 / Avg. bwd time: 34.1512 / Avg. batch time: 1399.7633 (ms) / GPU bubble ratio: 60.41%
[rank0]:2025-10-24 08:13:23,124 - INFO - Avg. fwd time: 47.6326 / Avg. bwd time: 10.8689 / Avg. batch time: 1555.0368 (ms) / GPU bubble ratio: 69.90%
[rank1]:2025-10-24 08:13:23,117 - INFO - Avg. fwd time: 55.1504 / Avg. bwd time: 51.6801 / Avg. batch time: 1506.8829 (ms) / GPU bubble ratio: 43.28%
[rank3]:2025-10-24 08:15:35,872 - INFO -  step: 740  loss:  1.0976  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,437  tflops: 19.05  mfu: 6.11%
[rank2]:2025-10-24 08:15:35,870 - INFO -  step: 740  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,437  tflops: 19.05  mfu: 6.11%
[rank0]:2025-10-24 08:15:35,870 - INFO -  step: 740  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,437  tflops: 19.05  mfu: 6.11%
[rank1]:2025-10-24 08:15:35,894 - INFO -  step: 740  loss: -4.0000  grad_norm:  0.2135  memory: 20.03GiB(42.17%)  tps: 2,437  tflops: 19.05  mfu: 6.11%
[rank3]:2025-10-24 08:15:37,266 - INFO - Avg. fwd time: 76.7447 / Avg. bwd time: 81.0774 / Avg. batch time: 1311.9932 (ms) / GPU bubble ratio: 3.77%
[rank2]:2025-10-24 08:15:37,395 - INFO - Avg. fwd time: 35.1149 / Avg. bwd time: 34.0185 / Avg. batch time: 1399.5870 (ms) / GPU bubble ratio: 60.48%
[rank1]:2025-10-24 08:15:37,551 - INFO - Avg. fwd time: 55.1939 / Avg. bwd time: 52.7173 / Avg. batch time: 1509.3051 (ms) / GPU bubble ratio: 42.80%
[rank0]:2025-10-24 08:15:37,558 - INFO - Avg. fwd time: 47.6234 / Avg. bwd time: 10.5752 / Avg. batch time: 1557.1646 (ms) / GPU bubble ratio: 70.10%
[rank3]:2025-10-24 08:15:39,934 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-24 08:15:40,832 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 08:15:40,928 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-24 08:15:40,930 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 08:16:36,051 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-24 08:17:49,800 - INFO -  step: 760  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,447  tflops: 19.13  mfu: 6.13%
[rank1]:2025-10-24 08:17:49,823 - INFO -  step: 760  loss: -4.0000  grad_norm:  0.2099  memory: 20.03GiB(42.17%)  tps: 2,447  tflops: 19.13  mfu: 6.13%
[rank2]:2025-10-24 08:17:49,800 - INFO -  step: 760  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,447  tflops: 19.13  mfu: 6.13%
[rank3]:2025-10-24 08:17:49,805 - INFO -  step: 760  loss:  1.0802  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,447  tflops: 19.13  mfu: 6.13%
[rank3]:2025-10-24 08:17:51,203 - INFO - Avg. fwd time: 76.7286 / Avg. bwd time: 80.8266 / Avg. batch time: 1309.8474 (ms) / GPU bubble ratio: 3.77%
[rank2]:2025-10-24 08:17:51,334 - INFO - Avg. fwd time: 35.1172 / Avg. bwd time: 33.8918 / Avg. batch time: 1399.2992 (ms) / GPU bubble ratio: 60.55%
[rank0]:2025-10-24 08:17:51,498 - INFO - Avg. fwd time: 47.6180 / Avg. bwd time: 10.2970 / Avg. batch time: 1559.0256 (ms) / GPU bubble ratio: 70.28%
[rank1]:2025-10-24 08:17:51,490 - INFO - Avg. fwd time: 55.1995 / Avg. bwd time: 53.6826 / Avg. batch time: 1511.4453 (ms) / GPU bubble ratio: 42.37%
[rank2]:2025-10-24 08:20:04,229 - INFO -  step: 780  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,438  tflops: 19.06  mfu: 6.11%
[rank3]:2025-10-24 08:20:04,230 - INFO -  step: 780  loss:  1.1138  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,438  tflops: 19.06  mfu: 6.11%
[rank0]:2025-10-24 08:20:04,229 - INFO -  step: 780  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,438  tflops: 19.06  mfu: 6.11%
[rank1]:2025-10-24 08:20:04,254 - INFO -  step: 780  loss: -4.0000  grad_norm:  0.2087  memory: 20.03GiB(42.17%)  tps: 2,438  tflops: 19.06  mfu: 6.11%
[rank3]:2025-10-24 08:20:05,625 - INFO - Avg. fwd time: 76.6980 / Avg. bwd time: 80.5968 / Avg. batch time: 1307.8493 (ms) / GPU bubble ratio: 3.78%
[rank2]:2025-10-24 08:20:05,754 - INFO - Avg. fwd time: 35.1185 / Avg. bwd time: 33.7736 / Avg. batch time: 1399.1346 (ms) / GPU bubble ratio: 60.61%
[rank1]:2025-10-24 08:20:05,910 - INFO - Avg. fwd time: 55.2432 / Avg. bwd time: 54.6178 / Avg. batch time: 1513.6140 (ms) / GPU bubble ratio: 41.93%
[rank0]:2025-10-24 08:20:05,918 - INFO - Avg. fwd time: 47.6171 / Avg. bwd time: 10.0330 / Avg. batch time: 1560.9370 (ms) / GPU bubble ratio: 70.45%
[rank0]:2025-10-24 08:22:12,191 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-24 08:22:18,979 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,432  tflops: 19.01  mfu: 6.09%
[rank2]:2025-10-24 08:22:18,979 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,432  tflops: 19.01  mfu: 6.09%
[rank3]:2025-10-24 08:22:18,980 - INFO -  step: 800  loss:  1.0362  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,432  tflops: 19.01  mfu: 6.09%
[rank0]:2025-10-24 08:22:19,081 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251024_0822_stage0_step800.svg
[rank1]:2025-10-24 08:22:19,004 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.2040  memory: 20.03GiB(42.17%)  tps: 2,432  tflops: 19.01  mfu: 6.09%
[rank1]:2025-10-24 08:22:19,081 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251024_0822_stage1_step800.svg
[rank2]:2025-10-24 08:22:19,084 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251024_0822_stage2_step800.svg
[rank3]:2025-10-24 08:22:19,228 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/pipeline_schedule/251024_0822_real_step800_rank3.svg
[rank3]:> Batch Time: 1384.05 ms, GPU Bubble Ratio: 72.20%, 44.56%, 62.96%, 13.45%
[rank3]:2025-10-24 08:22:19,296 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251024_0822_stage3_step800.svg
[rank3]:2025-10-24 08:22:20,595 - INFO - Avg. fwd time: 76.6911 / Avg. bwd time: 80.3789 / Avg. batch time: 1306.0705 (ms) / GPU bubble ratio: 3.79%
[rank2]:2025-10-24 08:22:20,715 - INFO - Avg. fwd time: 35.1158 / Avg. bwd time: 33.6615 / Avg. batch time: 1399.1233 (ms) / GPU bubble ratio: 60.67%
[rank0]:2025-10-24 08:22:20,878 - INFO - Avg. fwd time: 47.6079 / Avg. bwd time: 9.7822 / Avg. batch time: 1562.8915 (ms) / GPU bubble ratio: 70.62%
[rank1]:2025-10-24 08:22:20,871 - INFO - Avg. fwd time: 55.2875 / Avg. bwd time: 55.5057 / Avg. batch time: 1515.8167 (ms) / GPU bubble ratio: 41.53%
[rank2]:2025-10-24 08:24:33,589 - INFO -  step: 820  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,434  tflops: 19.03  mfu: 6.10%
[rank3]:2025-10-24 08:24:33,591 - INFO -  step: 820  loss:  1.0963  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,434  tflops: 19.03  mfu: 6.10%
[rank0]:2025-10-24 08:24:33,589 - INFO -  step: 820  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,434  tflops: 19.03  mfu: 6.10%
[rank1]:2025-10-24 08:24:33,614 - INFO -  step: 820  loss: -4.0000  grad_norm:  0.2142  memory: 20.03GiB(42.17%)  tps: 2,434  tflops: 19.03  mfu: 6.10%
[rank3]:2025-10-24 08:24:34,986 - INFO - Avg. fwd time: 76.6900 / Avg. bwd time: 80.1680 / Avg. batch time: 1304.3658 (ms) / GPU bubble ratio: 3.80%
[rank2]:2025-10-24 08:24:35,114 - INFO - Avg. fwd time: 35.1134 / Avg. bwd time: 33.5550 / Avg. batch time: 1398.9978 (ms) / GPU bubble ratio: 60.73%
[rank1]:2025-10-24 08:24:35,270 - INFO - Avg. fwd time: 55.3100 / Avg. bwd time: 56.3359 / Avg. batch time: 1517.7819 (ms) / GPU bubble ratio: 41.15%
[rank0]:2025-10-24 08:24:35,277 - INFO - Avg. fwd time: 47.6074 / Avg. bwd time: 9.5437 / Avg. batch time: 1564.6188 (ms) / GPU bubble ratio: 70.78%
[rank2]:2025-10-24 08:24:53,675 - WARNING - Dataset alpaca is being re-looped
[rank3]:2025-10-24 08:24:53,604 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 08:24:53,770 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-24 08:24:53,772 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 08:26:48,148 - INFO -  step: 840  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,435  tflops: 19.04  mfu: 6.10%
[rank1]:2025-10-24 08:26:48,172 - INFO -  step: 840  loss: -4.0000  grad_norm:  0.2105  memory: 20.03GiB(42.17%)  tps: 2,435  tflops: 19.04  mfu: 6.10%
[rank2]:2025-10-24 08:26:48,148 - INFO -  step: 840  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,435  tflops: 19.04  mfu: 6.10%
[rank3]:2025-10-24 08:26:48,149 - INFO -  step: 840  loss:  1.0462  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,435  tflops: 19.04  mfu: 6.10%
[rank3]:2025-10-24 08:26:49,539 - INFO - Avg. fwd time: 76.6837 / Avg. bwd time: 79.9693 / Avg. batch time: 1302.7435 (ms) / GPU bubble ratio: 3.80%
[rank2]:2025-10-24 08:26:49,668 - INFO - Avg. fwd time: 35.1085 / Avg. bwd time: 33.4516 / Avg. batch time: 1398.9181 (ms) / GPU bubble ratio: 60.79%
[rank0]:2025-10-24 08:26:49,832 - INFO - Avg. fwd time: 47.6053 / Avg. bwd time: 9.3165 / Avg. batch time: 1566.3178 (ms) / GPU bubble ratio: 70.93%
[rank1]:2025-10-24 08:26:49,825 - INFO - Avg. fwd time: 55.3302 / Avg. bwd time: 57.1344 / Avg. batch time: 1519.7061 (ms) / GPU bubble ratio: 40.80%
[rank0]:2025-10-24 08:27:48,605 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-24 08:29:02,649 - INFO -  step: 860  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,436  tflops: 19.05  mfu: 6.10%
[rank3]:2025-10-24 08:29:02,650 - INFO -  step: 860  loss:  1.0970  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,436  tflops: 19.05  mfu: 6.10%
[rank0]:2025-10-24 08:29:02,649 - INFO -  step: 860  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,436  tflops: 19.05  mfu: 6.10%
[rank1]:2025-10-24 08:29:02,673 - INFO -  step: 860  loss: -4.0000  grad_norm:  0.2013  memory: 20.03GiB(42.17%)  tps: 2,436  tflops: 19.05  mfu: 6.10%
[rank3]:2025-10-24 08:29:04,040 - INFO - Avg. fwd time: 76.6580 / Avg. bwd time: 79.7863 / Avg. batch time: 1301.1038 (ms) / GPU bubble ratio: 3.81%
[rank2]:2025-10-24 08:29:04,169 - INFO - Avg. fwd time: 35.1068 / Avg. bwd time: 33.3546 / Avg. batch time: 1398.8065 (ms) / GPU bubble ratio: 60.85%
[rank0]:2025-10-24 08:29:04,335 - INFO - Avg. fwd time: 47.5951 / Avg. bwd time: 9.0999 / Avg. batch time: 1567.9107 (ms) / GPU bubble ratio: 71.07%
[rank1]:2025-10-24 08:29:04,327 - INFO - Avg. fwd time: 55.3718 / Avg. bwd time: 57.9108 / Avg. batch time: 1521.5160 (ms) / GPU bubble ratio: 40.44%
[rank2]:2025-10-24 08:31:17,456 - INFO -  step: 880  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,431  tflops: 19.00  mfu: 6.09%
[rank3]:2025-10-24 08:31:17,457 - INFO -  step: 880  loss:  1.1199  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,431  tflops: 19.00  mfu: 6.09%
[rank0]:2025-10-24 08:31:17,456 - INFO -  step: 880  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,431  tflops: 19.00  mfu: 6.09%
[rank1]:2025-10-24 08:31:17,479 - INFO -  step: 880  loss: -4.0000  grad_norm:  0.2099  memory: 20.03GiB(42.17%)  tps: 2,431  tflops: 19.00  mfu: 6.09%
[rank3]:2025-10-24 08:31:18,864 - INFO - Avg. fwd time: 76.6499 / Avg. bwd time: 79.6121 / Avg. batch time: 1299.6613 (ms) / GPU bubble ratio: 3.81%
[rank2]:2025-10-24 08:31:18,984 - INFO - Avg. fwd time: 35.1000 / Avg. bwd time: 33.2614 / Avg. batch time: 1398.7798 (ms) / GPU bubble ratio: 60.90%
[rank1]:2025-10-24 08:31:19,142 - INFO - Avg. fwd time: 55.4028 / Avg. bwd time: 58.6466 / Avg. batch time: 1523.3276 (ms) / GPU bubble ratio: 40.11%
[rank0]:2025-10-24 08:31:19,150 - INFO - Avg. fwd time: 47.5845 / Avg. bwd time: 8.8931 / Avg. batch time: 1569.5135 (ms) / GPU bubble ratio: 71.21%
[rank0]:2025-10-24 08:33:25,279 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-24 08:33:31,985 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,436  tflops: 19.04  mfu: 6.10%
[rank2]:2025-10-24 08:33:31,985 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,436  tflops: 19.04  mfu: 6.10%
[rank3]:2025-10-24 08:33:31,986 - INFO -  step: 900  loss:  1.0040  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,436  tflops: 19.04  mfu: 6.10%
[rank1]:2025-10-24 08:33:32,009 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.2239  memory: 20.03GiB(42.17%)  tps: 2,436  tflops: 19.04  mfu: 6.10%
[rank0]:2025-10-24 08:33:32,080 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251024_0833_stage0_step900.svg
[rank2]:2025-10-24 08:33:32,079 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251024_0833_stage2_step900.svg
[rank1]:2025-10-24 08:33:32,080 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251024_0833_stage1_step900.svg
[rank3]:2025-10-24 08:33:32,225 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/pipeline_schedule/251024_0833_real_step900_rank3.svg
[rank3]:> Batch Time: 1383.92 ms, GPU Bubble Ratio: 72.20%, 44.12%, 62.98%, 13.51%
[rank3]:2025-10-24 08:33:32,283 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251024_0833_stage3_step900.svg
[rank3]:2025-10-24 08:33:33,572 - INFO - Avg. fwd time: 76.6382 / Avg. bwd time: 79.4400 / Avg. batch time: 1298.2222 (ms) / GPU bubble ratio: 3.82%
[rank2]:2025-10-24 08:33:33,696 - INFO - Avg. fwd time: 35.1006 / Avg. bwd time: 33.1719 / Avg. batch time: 1398.7219 (ms) / GPU bubble ratio: 60.95%
[rank0]:2025-10-24 08:33:33,858 - INFO - Avg. fwd time: 47.5884 / Avg. bwd time: 8.6955 / Avg. batch time: 1570.9834 (ms) / GPU bubble ratio: 71.34%
[rank1]:2025-10-24 08:33:33,850 - INFO - Avg. fwd time: 55.4185 / Avg. bwd time: 59.3436 / Avg. batch time: 1524.9957 (ms) / GPU bubble ratio: 39.80%
[rank3]:2025-10-24 08:34:07,215 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-24 08:34:07,371 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-24 08:34:07,469 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 08:34:07,470 - WARNING - Dataset alpaca is being re-looped
[rank3]:2025-10-24 08:35:46,596 - INFO -  step: 920  loss:  1.0083  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,434  tflops: 19.03  mfu: 6.10%
[rank1]:2025-10-24 08:35:46,618 - INFO -  step: 920  loss: -4.0000  grad_norm:  0.2230  memory: 20.03GiB(42.17%)  tps: 2,434  tflops: 19.03  mfu: 6.10%
[rank0]:2025-10-24 08:35:46,594 - INFO -  step: 920  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,434  tflops: 19.03  mfu: 6.10%
[rank2]:2025-10-24 08:35:46,594 - INFO -  step: 920  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,434  tflops: 19.03  mfu: 6.10%
[rank3]:2025-10-24 08:35:48,017 - INFO - Avg. fwd time: 76.6195 / Avg. bwd time: 79.2788 / Avg. batch time: 1296.7919 (ms) / GPU bubble ratio: 3.83%
[rank2]:2025-10-24 08:35:48,138 - INFO - Avg. fwd time: 35.0995 / Avg. bwd time: 33.0861 / Avg. batch time: 1398.6078 (ms) / GPU bubble ratio: 61.00%
[rank1]:2025-10-24 08:35:48,297 - INFO - Avg. fwd time: 55.4471 / Avg. bwd time: 60.0170 / Avg. batch time: 1526.5622 (ms) / GPU bubble ratio: 39.49%
[rank0]:2025-10-24 08:35:48,305 - INFO - Avg. fwd time: 47.5751 / Avg. bwd time: 8.5066 / Avg. batch time: 1572.3606 (ms) / GPU bubble ratio: 71.47%
[rank1]:2025-10-24 08:38:01,319 - INFO -  step: 940  loss: -4.0000  grad_norm:  0.2205  memory: 20.03GiB(42.17%)  tps: 2,433  tflops: 19.02  mfu: 6.10%
[rank2]:2025-10-24 08:38:01,295 - INFO -  step: 940  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,433  tflops: 19.02  mfu: 6.10%
[rank0]:2025-10-24 08:38:01,295 - INFO -  step: 940  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,433  tflops: 19.02  mfu: 6.10%
[rank3]:2025-10-24 08:38:01,297 - INFO -  step: 940  loss:  1.0814  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,433  tflops: 19.02  mfu: 6.10%
[rank3]:2025-10-24 08:38:02,710 - INFO - Avg. fwd time: 76.6110 / Avg. bwd time: 79.1240 / Avg. batch time: 1295.4944 (ms) / GPU bubble ratio: 3.83%
[rank2]:2025-10-24 08:38:02,836 - INFO - Avg. fwd time: 35.0963 / Avg. bwd time: 33.0048 / Avg. batch time: 1398.5653 (ms) / GPU bubble ratio: 61.05%
[rank1]:2025-10-24 08:38:02,993 - INFO - Avg. fwd time: 55.4724 / Avg. bwd time: 60.6614 / Avg. batch time: 1528.1306 (ms) / GPU bubble ratio: 39.20%
[rank0]:2025-10-24 08:38:03,001 - INFO - Avg. fwd time: 47.5627 / Avg. bwd time: 8.3256 / Avg. batch time: 1573.7484 (ms) / GPU bubble ratio: 71.59%
[rank0]:2025-10-24 08:39:01,797 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-24 08:40:15,641 - INFO -  step: 960  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,439  tflops: 19.07  mfu: 6.11%
[rank0]:2025-10-24 08:40:15,641 - INFO -  step: 960  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,439  tflops: 19.07  mfu: 6.11%
[rank3]:2025-10-24 08:40:15,642 - INFO -  step: 960  loss:  1.0768  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,439  tflops: 19.07  mfu: 6.11%
[rank1]:2025-10-24 08:40:15,665 - INFO -  step: 960  loss: -4.0000  grad_norm:  0.2247  memory: 20.03GiB(42.17%)  tps: 2,439  tflops: 19.07  mfu: 6.11%
[rank3]:2025-10-24 08:40:17,034 - INFO - Avg. fwd time: 76.5964 / Avg. bwd time: 78.9717 / Avg. batch time: 1294.1909 (ms) / GPU bubble ratio: 3.84%
[rank2]:2025-10-24 08:40:17,157 - INFO - Avg. fwd time: 35.0961 / Avg. bwd time: 32.9254 / Avg. batch time: 1398.4467 (ms) / GPU bubble ratio: 61.09%
[rank0]:2025-10-24 08:40:17,322 - INFO - Avg. fwd time: 47.5633 / Avg. bwd time: 8.1522 / Avg. batch time: 1574.9886 (ms) / GPU bubble ratio: 71.70%
[rank1]:2025-10-24 08:40:17,314 - INFO - Avg. fwd time: 55.4931 / Avg. bwd time: 61.2714 / Avg. batch time: 1529.5449 (ms) / GPU bubble ratio: 38.93%
[rank2]:2025-10-24 08:42:29,917 - INFO -  step: 980  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,440  tflops: 19.08  mfu: 6.11%
[rank0]:2025-10-24 08:42:29,917 - INFO -  step: 980  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,440  tflops: 19.08  mfu: 6.11%
[rank3]:2025-10-24 08:42:29,919 - INFO -  step: 980  loss:  1.0124  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,440  tflops: 19.08  mfu: 6.11%
[rank1]:2025-10-24 08:42:29,942 - INFO -  step: 980  loss: -4.0000  grad_norm:  0.2266  memory: 20.03GiB(42.17%)  tps: 2,440  tflops: 19.08  mfu: 6.11%
[rank3]:2025-10-24 08:42:31,303 - INFO - Avg. fwd time: 76.5767 / Avg. bwd time: 78.8258 / Avg. batch time: 1292.9148 (ms) / GPU bubble ratio: 3.84%
[rank2]:2025-10-24 08:42:31,414 - INFO - Avg. fwd time: 35.0924 / Avg. bwd time: 32.8505 / Avg. batch time: 1398.3239 (ms) / GPU bubble ratio: 61.13%
[rank1]:2025-10-24 08:42:31,573 - INFO - Avg. fwd time: 55.5212 / Avg. bwd time: 61.8598 / Avg. batch time: 1530.9063 (ms) / GPU bubble ratio: 38.66%
[rank0]:2025-10-24 08:42:31,581 - INFO - Avg. fwd time: 47.5628 / Avg. bwd time: 7.9859 / Avg. batch time: 1576.1788 (ms) / GPU bubble ratio: 71.81%
[rank3]:2025-10-24 08:43:21,770 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-24 08:43:21,971 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-24 08:43:22,069 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 08:43:22,067 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 08:44:37,706 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-24 08:44:44,416 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,436  tflops: 19.05  mfu: 6.10%
[rank0]:2025-10-24 08:44:44,416 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-24 08:44:44,418 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank2]:2025-10-24 08:44:44,416 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,436  tflops: 19.05  mfu: 6.10%
[rank2]:2025-10-24 08:44:44,416 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-24 08:44:44,418 - INFO -  step: 1000  loss:  1.0431  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,436  tflops: 19.05  mfu: 6.10%
[rank3]:2025-10-24 08:44:44,418 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-24 08:44:44,441 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.2281  memory: 20.03GiB(42.17%)  tps: 2,436  tflops: 19.05  mfu: 6.10%
[rank1]:2025-10-24 08:44:44,441 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-24 08:44:46,269 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 1.85 seconds.
[rank1]:2025-10-24 08:44:46,688 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 2.25 seconds.
[rank3]:2025-10-24 08:44:47,692 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.27 seconds.
[rank0]:2025-10-24 08:44:48,074 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-24 08:44:48,082 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.67 seconds.
[rank1]:2025-10-24 08:44:48,158 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251024_0844_stage1_step1000.svg
[rank2]:2025-10-24 08:44:48,157 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251024_0844_stage2_step1000.svg
[rank0]:2025-10-24 08:44:48,239 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251024_0844_stage0_step1000.svg
[rank3]:2025-10-24 08:44:48,487 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/pipeline_schedule/251024_0844_real_step1000_rank3.svg
[rank3]:> Batch Time: 1385.44 ms, GPU Bubble Ratio: 72.23%, 43.46%, 63.04%, 13.73%
[rank3]:2025-10-24 08:44:48,554 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251024_0844_stage3_step1000.svg
[rank3]:2025-10-24 08:44:49,842 - INFO - Avg. fwd time: 76.5662 / Avg. bwd time: 78.6867 / Avg. batch time: 1291.7365 (ms) / GPU bubble ratio: 3.85%
[rank2]:2025-10-24 08:44:49,961 - INFO - Avg. fwd time: 35.0886 / Avg. bwd time: 32.7778 / Avg. batch time: 1398.3058 (ms) / GPU bubble ratio: 61.17%
[rank0]:2025-10-24 08:44:50,130 - INFO - Avg. fwd time: 47.5663 / Avg. bwd time: 7.8262 / Avg. batch time: 1577.4284 (ms) / GPU bubble ratio: 71.91%
[rank1]:2025-10-24 08:44:50,121 - INFO - Avg. fwd time: 55.5456 / Avg. bwd time: 62.4266 / Avg. batch time: 1532.3159 (ms) / GPU bubble ratio: 38.41%
[rank0]:2025-10-24 08:47:02,808 - INFO -  step: 1020  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,368  tflops: 18.51  mfu: 5.93%
[rank2]:2025-10-24 08:47:02,808 - INFO -  step: 1020  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,368  tflops: 18.51  mfu: 5.93%
[rank3]:2025-10-24 08:47:02,810 - INFO -  step: 1020  loss:  1.0265  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,368  tflops: 18.51  mfu: 5.93%
[rank1]:2025-10-24 08:47:02,832 - INFO -  step: 1020  loss: -4.0000  grad_norm:  0.2150  memory: 20.03GiB(42.17%)  tps: 2,368  tflops: 18.51  mfu: 5.93%
[rank3]:2025-10-24 08:47:04,231 - INFO - Avg. fwd time: 76.5505 / Avg. bwd time: 78.5517 / Avg. batch time: 1290.5366 (ms) / GPU bubble ratio: 3.85%
[rank2]:2025-10-24 08:47:04,363 - INFO - Avg. fwd time: 35.0873 / Avg. bwd time: 32.7087 / Avg. batch time: 1398.1911 (ms) / GPU bubble ratio: 61.21%
[rank1]:2025-10-24 08:47:04,520 - INFO - Avg. fwd time: 55.5678 / Avg. bwd time: 62.9710 / Avg. batch time: 1533.5661 (ms) / GPU bubble ratio: 38.16%
[rank0]:2025-10-24 08:47:04,529 - INFO - Avg. fwd time: 47.5676 / Avg. bwd time: 7.6728 / Avg. batch time: 1578.5298 (ms) / GPU bubble ratio: 72.00%
[rank0]:2025-10-24 08:49:17,273 - INFO -  step: 1040  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,437  tflops: 19.05  mfu: 6.11%
[rank2]:2025-10-24 08:49:17,273 - INFO -  step: 1040  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,437  tflops: 19.05  mfu: 6.11%
[rank3]:2025-10-24 08:49:17,274 - INFO -  step: 1040  loss:  1.0458  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,437  tflops: 19.05  mfu: 6.11%
[rank1]:2025-10-24 08:49:17,297 - INFO -  step: 1040  loss: -4.0000  grad_norm:  0.2225  memory: 20.03GiB(42.17%)  tps: 2,437  tflops: 19.05  mfu: 6.11%
[rank3]:2025-10-24 08:49:18,685 - INFO - Avg. fwd time: 76.5488 / Avg. bwd time: 78.4186 / Avg. batch time: 1289.4694 (ms) / GPU bubble ratio: 3.86%
[rank2]:2025-10-24 08:49:18,804 - INFO - Avg. fwd time: 35.0849 / Avg. bwd time: 32.6413 / Avg. batch time: 1398.1169 (ms) / GPU bubble ratio: 61.25%
[rank1]:2025-10-24 08:49:18,961 - INFO - Avg. fwd time: 55.5822 / Avg. bwd time: 63.4850 / Avg. batch time: 1534.7846 (ms) / GPU bubble ratio: 37.94%
[rank0]:2025-10-24 08:49:18,970 - INFO - Avg. fwd time: 47.5706 / Avg. bwd time: 7.5253 / Avg. batch time: 1579.6012 (ms) / GPU bubble ratio: 72.10%
[rank0]:2025-10-24 08:50:18,052 - INFO - [GC] Peforming periodical GC collection 0.25 seconds
[rank2]:2025-10-24 08:51:31,972 - INFO -  step: 1060  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,433  tflops: 19.02  mfu: 6.10%
[rank3]:2025-10-24 08:51:31,973 - INFO -  step: 1060  loss:  0.9749  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,433  tflops: 19.02  mfu: 6.10%
[rank1]:2025-10-24 08:51:31,996 - INFO -  step: 1060  loss: -4.0000  grad_norm:  0.2250  memory: 20.03GiB(42.17%)  tps: 2,433  tflops: 19.02  mfu: 6.10%
[rank0]:2025-10-24 08:51:31,972 - INFO -  step: 1060  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,433  tflops: 19.02  mfu: 6.10%
[rank3]:2025-10-24 08:51:33,367 - INFO - Avg. fwd time: 76.5431 / Avg. bwd time: 78.2932 / Avg. batch time: 1288.4271 (ms) / GPU bubble ratio: 3.86%
[rank2]:2025-10-24 08:51:33,492 - INFO - Avg. fwd time: 35.0799 / Avg. bwd time: 32.5772 / Avg. batch time: 1398.0208 (ms) / GPU bubble ratio: 61.28%
[rank1]:2025-10-24 08:51:33,649 - INFO - Avg. fwd time: 55.5950 / Avg. bwd time: 63.9809 / Avg. batch time: 1535.9450 (ms) / GPU bubble ratio: 37.72%
[rank0]:2025-10-24 08:51:33,658 - INFO - Avg. fwd time: 47.5691 / Avg. bwd time: 7.3833 / Avg. batch time: 1580.6208 (ms) / GPU bubble ratio: 72.19%
[rank3]:2025-10-24 08:52:39,016 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-24 08:52:39,087 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-24 08:52:39,186 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 08:52:39,182 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-24 08:53:46,411 - INFO -  step: 1080  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,437  tflops: 19.05  mfu: 6.11%
[rank0]:2025-10-24 08:53:46,411 - INFO -  step: 1080  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,437  tflops: 19.05  mfu: 6.11%
[rank1]:2025-10-24 08:53:46,435 - INFO -  step: 1080  loss: -4.0000  grad_norm:  0.2389  memory: 20.03GiB(42.17%)  tps: 2,437  tflops: 19.05  mfu: 6.11%
[rank3]:2025-10-24 08:53:46,413 - INFO -  step: 1080  loss:  0.9994  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,437  tflops: 19.05  mfu: 6.11%
[rank3]:2025-10-24 08:53:47,831 - INFO - Avg. fwd time: 76.5257 / Avg. bwd time: 78.1742 / Avg. batch time: 1287.3573 (ms) / GPU bubble ratio: 3.87%
[rank2]:2025-10-24 08:53:47,950 - INFO - Avg. fwd time: 35.0772 / Avg. bwd time: 32.5150 / Avg. batch time: 1397.9398 (ms) / GPU bubble ratio: 61.32%
[rank0]:2025-10-24 08:53:48,117 - INFO - Avg. fwd time: 47.5623 / Avg. bwd time: 7.2466 / Avg. batch time: 1581.6231 (ms) / GPU bubble ratio: 72.28%
[rank1]:2025-10-24 08:53:48,108 - INFO - Avg. fwd time: 55.6228 / Avg. bwd time: 64.4712 / Avg. batch time: 1537.0822 (ms) / GPU bubble ratio: 37.50%
[rank0]:2025-10-24 08:55:54,042 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-24 08:56:00,742 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,439  tflops: 19.07  mfu: 6.11%
[rank3]:2025-10-24 08:56:00,744 - INFO -  step: 1100  loss:  1.0574  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,439  tflops: 19.07  mfu: 6.11%
[rank1]:2025-10-24 08:56:00,765 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.2371  memory: 20.03GiB(42.17%)  tps: 2,439  tflops: 19.07  mfu: 6.11%
[rank0]:2025-10-24 08:56:00,742 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,439  tflops: 19.07  mfu: 6.11%
[rank2]:2025-10-24 08:56:00,841 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251024_0856_stage2_step1100.svg
[rank1]:2025-10-24 08:56:00,844 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251024_0856_stage1_step1100.svg
[rank0]:2025-10-24 08:56:00,842 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251024_0856_stage0_step1100.svg
[rank3]:2025-10-24 08:56:00,986 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/pipeline_schedule/251024_0856_real_step1100_rank3.svg
[rank3]:> Batch Time: 1424.47 ms, GPU Bubble Ratio: 73.00%, 28.02%, 64.08%, 16.25%
[rank3]:2025-10-24 08:56:01,048 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251024_0856_stage3_step1100.svg
[rank3]:2025-10-24 08:56:02,338 - INFO - Avg. fwd time: 76.5052 / Avg. bwd time: 78.0593 / Avg. batch time: 1286.3177 (ms) / GPU bubble ratio: 3.87%
[rank2]:2025-10-24 08:56:02,457 - INFO - Avg. fwd time: 35.0777 / Avg. bwd time: 32.4553 / Avg. batch time: 1397.8512 (ms) / GPU bubble ratio: 61.35%
[rank1]:2025-10-24 08:56:02,617 - INFO - Avg. fwd time: 55.6513 / Avg. bwd time: 64.9410 / Avg. batch time: 1538.1644 (ms) / GPU bubble ratio: 37.28%
[rank0]:2025-10-24 08:56:02,626 - INFO - Avg. fwd time: 47.5570 / Avg. bwd time: 7.1149 / Avg. batch time: 1582.5746 (ms) / GPU bubble ratio: 72.36%
[rank3]:2025-10-24 08:58:15,326 - INFO -  step: 1120  loss:  1.0288  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,435  tflops: 19.03  mfu: 6.10%
[rank2]:2025-10-24 08:58:15,324 - INFO -  step: 1120  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,435  tflops: 19.03  mfu: 6.10%
[rank0]:2025-10-24 08:58:15,324 - INFO -  step: 1120  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,435  tflops: 19.03  mfu: 6.10%
[rank1]:2025-10-24 08:58:15,349 - INFO -  step: 1120  loss: -4.0000  grad_norm:  0.2212  memory: 20.03GiB(42.17%)  tps: 2,435  tflops: 19.03  mfu: 6.10%
[rank3]:2025-10-24 08:58:16,716 - INFO - Avg. fwd time: 76.4923 / Avg. bwd time: 77.9469 / Avg. batch time: 1285.3270 (ms) / GPU bubble ratio: 3.88%
[rank2]:2025-10-24 08:58:16,841 - INFO - Avg. fwd time: 35.0756 / Avg. bwd time: 32.3978 / Avg. batch time: 1397.7771 (ms) / GPU bubble ratio: 61.38%
[rank0]:2025-10-24 08:58:17,009 - INFO - Avg. fwd time: 47.5521 / Avg. bwd time: 6.9879 / Avg. batch time: 1583.4962 (ms) / GPU bubble ratio: 72.45%
[rank1]:2025-10-24 08:58:17,000 - INFO - Avg. fwd time: 55.6667 / Avg. bwd time: 65.3935 / Avg. batch time: 1539.2164 (ms) / GPU bubble ratio: 37.08%
[rank2]:2025-10-24 09:00:29,829 - INFO -  step: 1140  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,436  tflops: 19.05  mfu: 6.10%
[rank3]:2025-10-24 09:00:29,830 - INFO -  step: 1140  loss:  0.9711  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,436  tflops: 19.05  mfu: 6.10%
[rank0]:2025-10-24 09:00:29,829 - INFO -  step: 1140  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,436  tflops: 19.05  mfu: 6.10%
[rank1]:2025-10-24 09:00:29,853 - INFO -  step: 1140  loss: -4.0000  grad_norm:  0.2311  memory: 20.03GiB(42.17%)  tps: 2,436  tflops: 19.05  mfu: 6.10%
[rank3]:2025-10-24 09:00:31,216 - INFO - Avg. fwd time: 76.4810 / Avg. bwd time: 77.8381 / Avg. batch time: 1284.4004 (ms) / GPU bubble ratio: 3.88%
[rank2]:2025-10-24 09:00:31,350 - INFO - Avg. fwd time: 35.0724 / Avg. bwd time: 32.3425 / Avg. batch time: 1397.7196 (ms) / GPU bubble ratio: 61.41%
[rank1]:2025-10-24 09:00:31,508 - INFO - Avg. fwd time: 55.6907 / Avg. bwd time: 65.8285 / Avg. batch time: 1540.2560 (ms) / GPU bubble ratio: 36.88%
[rank0]:2025-10-24 09:00:31,518 - INFO - Avg. fwd time: 47.5556 / Avg. bwd time: 6.8654 / Avg. batch time: 1584.4149 (ms) / GPU bubble ratio: 72.52%
[rank0]:2025-10-24 09:01:30,435 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-24 09:01:51,291 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-24 09:01:52,189 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 09:01:52,284 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-24 09:01:52,286 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 09:02:44,276 - INFO -  step: 1160  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,437  tflops: 19.05  mfu: 6.11%
[rank2]:2025-10-24 09:02:44,276 - INFO -  step: 1160  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,437  tflops: 19.05  mfu: 6.11%
[rank3]:2025-10-24 09:02:44,277 - INFO -  step: 1160  loss:  0.9625  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,437  tflops: 19.05  mfu: 6.11%
[rank1]:2025-10-24 09:02:44,299 - INFO -  step: 1160  loss: -4.0000  grad_norm:  0.2439  memory: 20.03GiB(42.17%)  tps: 2,437  tflops: 19.05  mfu: 6.11%
[rank3]:2025-10-24 09:02:45,692 - INFO - Avg. fwd time: 76.4634 / Avg. bwd time: 77.7375 / Avg. batch time: 1283.4924 (ms) / GPU bubble ratio: 3.89%
[rank2]:2025-10-24 09:02:45,810 - INFO - Avg. fwd time: 35.0723 / Avg. bwd time: 32.2889 / Avg. batch time: 1397.6654 (ms) / GPU bubble ratio: 61.44%
[rank0]:2025-10-24 09:02:45,978 - INFO - Avg. fwd time: 47.5473 / Avg. bwd time: 6.7470 / Avg. batch time: 1585.2977 (ms) / GPU bubble ratio: 72.60%
[rank1]:2025-10-24 09:02:45,969 - INFO - Avg. fwd time: 55.7167 / Avg. bwd time: 66.2540 / Avg. batch time: 1541.2554 (ms) / GPU bubble ratio: 36.69%
[rank0]:2025-10-24 09:04:58,749 - INFO -  step: 1180  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,437  tflops: 19.05  mfu: 6.11%
[rank2]:2025-10-24 09:04:58,749 - INFO -  step: 1180  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,437  tflops: 19.05  mfu: 6.11%
[rank3]:2025-10-24 09:04:58,751 - INFO -  step: 1180  loss:  1.0097  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,437  tflops: 19.05  mfu: 6.11%
[rank1]:2025-10-24 09:04:58,772 - INFO -  step: 1180  loss: -4.0000  grad_norm:  0.2610  memory: 20.03GiB(42.17%)  tps: 2,437  tflops: 19.05  mfu: 6.11%
[rank3]:2025-10-24 09:05:00,158 - INFO - Avg. fwd time: 76.4554 / Avg. bwd time: 77.6352 / Avg. batch time: 1282.6456 (ms) / GPU bubble ratio: 3.89%
[rank2]:2025-10-24 09:05:00,286 - INFO - Avg. fwd time: 35.0705 / Avg. bwd time: 32.2366 / Avg. batch time: 1397.6277 (ms) / GPU bubble ratio: 61.47%
[rank1]:2025-10-24 09:05:00,443 - INFO - Avg. fwd time: 55.7328 / Avg. bwd time: 66.6585 / Avg. batch time: 1542.2256 (ms) / GPU bubble ratio: 36.51%
[rank0]:2025-10-24 09:05:00,453 - INFO - Avg. fwd time: 47.5452 / Avg. bwd time: 6.6327 / Avg. batch time: 1586.1549 (ms) / GPU bubble ratio: 72.67%
[rank0]:2025-10-24 09:07:06,485 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-24 09:07:13,222 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,437  tflops: 19.05  mfu: 6.11%
[rank2]:2025-10-24 09:07:13,222 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,437  tflops: 19.05  mfu: 6.11%
[rank3]:2025-10-24 09:07:13,223 - INFO -  step: 1200  loss:  1.0370  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,437  tflops: 19.05  mfu: 6.11%
[rank1]:2025-10-24 09:07:13,246 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.2481  memory: 20.03GiB(42.17%)  tps: 2,437  tflops: 19.05  mfu: 6.11%
[rank1]:2025-10-24 09:07:13,323 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251024_0907_stage1_step1200.svg
[rank0]:2025-10-24 09:07:13,324 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251024_0907_stage0_step1200.svg
[rank2]:2025-10-24 09:07:13,324 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251024_0907_stage2_step1200.svg
[rank3]:2025-10-24 09:07:13,471 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/pipeline_schedule/251024_0907_real_step1200_rank3.svg
[rank3]:> Batch Time: 1463.81 ms, GPU Bubble Ratio: 73.73%, 27.01%, 65.06%, 18.65%
[rank3]:2025-10-24 09:07:13,535 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251024_0907_stage3_step1200.svg
[rank3]:2025-10-24 09:07:14,832 - INFO - Avg. fwd time: 76.4465 / Avg. bwd time: 77.5392 / Avg. batch time: 1281.8164 (ms) / GPU bubble ratio: 3.90%
[rank2]:2025-10-24 09:07:14,948 - INFO - Avg. fwd time: 35.0669 / Avg. bwd time: 32.1868 / Avg. batch time: 1397.5952 (ms) / GPU bubble ratio: 61.50%
[rank1]:2025-10-24 09:07:15,108 - INFO - Avg. fwd time: 55.7495 / Avg. bwd time: 67.0519 / Avg. batch time: 1543.1803 (ms) / GPU bubble ratio: 36.34%
[rank0]:2025-10-24 09:07:15,118 - INFO - Avg. fwd time: 47.5389 / Avg. bwd time: 6.5222 / Avg. batch time: 1586.9988 (ms) / GPU bubble ratio: 72.75%
[rank0]:2025-10-24 09:09:28,035 - INFO -  step: 1220  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,431  tflops: 19.00  mfu: 6.09%
[rank3]:2025-10-24 09:09:28,037 - INFO -  step: 1220  loss:  0.9681  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,431  tflops: 19.00  mfu: 6.09%
[rank2]:2025-10-24 09:09:28,035 - INFO -  step: 1220  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,431  tflops: 19.00  mfu: 6.09%
[rank1]:2025-10-24 09:09:28,061 - INFO -  step: 1220  loss: -4.0000  grad_norm:  0.2411  memory: 20.03GiB(42.17%)  tps: 2,431  tflops: 19.00  mfu: 6.09%
[rank3]:2025-10-24 09:09:29,432 - INFO - Avg. fwd time: 76.4320 / Avg. bwd time: 77.4489 / Avg. batch time: 1281.0079 (ms) / GPU bubble ratio: 3.90%
[rank2]:2025-10-24 09:09:29,564 - INFO - Avg. fwd time: 35.0659 / Avg. bwd time: 32.1389 / Avg. batch time: 1397.5628 (ms) / GPU bubble ratio: 61.53%
[rank0]:2025-10-24 09:09:29,733 - INFO - Avg. fwd time: 47.5317 / Avg. bwd time: 6.4153 / Avg. batch time: 1587.8198 (ms) / GPU bubble ratio: 72.82%
[rank1]:2025-10-24 09:09:29,724 - INFO - Avg. fwd time: 55.7717 / Avg. bwd time: 67.4382 / Avg. batch time: 1544.1072 (ms) / GPU bubble ratio: 36.17%
[rank3]:2025-10-24 09:11:06,144 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-24 09:11:07,022 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-24 09:11:07,119 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 09:11:07,116 - WARNING - Dataset alpaca is being re-looped
[rank3]:2025-10-24 09:11:42,346 - INFO -  step: 1240  loss:  0.9807  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,440  tflops: 19.07  mfu: 6.11%
[rank2]:2025-10-24 09:11:42,344 - INFO -  step: 1240  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,440  tflops: 19.07  mfu: 6.11%
[rank1]:2025-10-24 09:11:42,367 - INFO -  step: 1240  loss: -4.0000  grad_norm:  0.2533  memory: 20.03GiB(42.17%)  tps: 2,440  tflops: 19.07  mfu: 6.11%
[rank0]:2025-10-24 09:11:42,344 - INFO -  step: 1240  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,440  tflops: 19.07  mfu: 6.11%
[rank3]:2025-10-24 09:11:43,746 - INFO - Avg. fwd time: 76.4228 / Avg. bwd time: 77.3573 / Avg. batch time: 1280.2007 (ms) / GPU bubble ratio: 3.90%
[rank2]:2025-10-24 09:11:43,869 - INFO - Avg. fwd time: 35.0653 / Avg. bwd time: 32.0920 / Avg. batch time: 1397.4845 (ms) / GPU bubble ratio: 61.56%
[rank1]:2025-10-24 09:11:44,027 - INFO - Avg. fwd time: 55.7838 / Avg. bwd time: 67.8043 / Avg. batch time: 1544.9437 (ms) / GPU bubble ratio: 36.00%
[rank0]:2025-10-24 09:11:44,037 - INFO - Avg. fwd time: 47.5253 / Avg. bwd time: 6.3119 / Avg. batch time: 1588.5506 (ms) / GPU bubble ratio: 72.89%
[rank0]:2025-10-24 09:12:42,837 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-24 09:13:56,748 - INFO -  step: 1260  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,438  tflops: 19.06  mfu: 6.11%
[rank2]:2025-10-24 09:13:56,748 - INFO -  step: 1260  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,438  tflops: 19.06  mfu: 6.11%
[rank3]:2025-10-24 09:13:56,749 - INFO -  step: 1260  loss:  1.0527  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,438  tflops: 19.06  mfu: 6.11%
[rank1]:2025-10-24 09:13:56,771 - INFO -  step: 1260  loss: -4.0000  grad_norm:  0.2532  memory: 20.03GiB(42.17%)  tps: 2,438  tflops: 19.06  mfu: 6.11%
[rank3]:2025-10-24 09:13:58,145 - INFO - Avg. fwd time: 76.4222 / Avg. bwd time: 77.2648 / Avg. batch time: 1279.4531 (ms) / GPU bubble ratio: 3.90%
[rank2]:2025-10-24 09:13:58,272 - INFO - Avg. fwd time: 35.0653 / Avg. bwd time: 32.0460 / Avg. batch time: 1397.4529 (ms) / GPU bubble ratio: 61.58%
[rank1]:2025-10-24 09:13:58,429 - INFO - Avg. fwd time: 55.7792 / Avg. bwd time: 68.1565 / Avg. batch time: 1545.7806 (ms) / GPU bubble ratio: 35.86%
[rank0]:2025-10-24 09:13:58,439 - INFO - Avg. fwd time: 47.5281 / Avg. bwd time: 6.2117 / Avg. batch time: 1589.2881 (ms) / GPU bubble ratio: 72.95%
[rank3]:2025-10-24 09:16:11,692 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251024_0916_rank3_trend_line.svg
[rank2]:2025-10-24 09:16:11,742 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251024_0916_rank2_trend_line.svg
[rank1]:2025-10-24 09:16:11,847 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251024_0916_rank1_trend_line.svg
[rank1]:2025-10-24 09:16:11,854 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-10-24 09:16:11,857 - INFO -  step: 1280  loss: -4.0000  grad_norm:  0.2618  memory: 20.03GiB(42.17%)  tps: 2,426  tflops: 18.96  mfu: 6.08%
[rank0]:2025-10-24 09:16:11,834 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251024_0916_rank0_trend_line.svg
[rank0]:2025-10-24 09:16:11,854 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-24 09:16:11,857 - INFO -  step: 1280  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,425  tflops: 18.96  mfu: 6.08%
[rank2]:2025-10-24 09:16:11,854 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-24 09:16:11,857 - INFO -  step: 1280  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,425  tflops: 18.96  mfu: 6.08%
[rank3]:2025-10-24 09:16:12,078 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/pipeline_schedule/251024_0916_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 1377.88 ms, GPU Bubble Ratio: 71.15%, 29.86%, 62.32%, 13.20%
[rank3]:2025-10-24 09:16:12,079 - INFO - 	> Batch Time: 1377.88 ms (Average Freeze Ratio: 0.34)
[rank3]:2025-10-24 09:16:12,080 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-24 09:16:12,086 - INFO -  step: 1280  loss:  1.0522  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,421  tflops: 18.93  mfu: 6.07%
[rank3]:2025-10-24 09:16:13,388 - INFO - Avg. fwd time: 76.4172 / Avg. bwd time: 77.1792 / Avg. batch time: 1278.7354 (ms) / GPU bubble ratio: 3.91%
[rank2]:2025-10-24 09:16:13,512 - INFO - Avg. fwd time: 35.0641 / Avg. bwd time: 32.0027 / Avg. batch time: 1397.4247 (ms) / GPU bubble ratio: 61.61%
[rank0]:2025-10-24 09:16:13,674 - INFO - Avg. fwd time: 47.5215 / Avg. bwd time: 6.1147 / Avg. batch time: 1590.0225 (ms) / GPU bubble ratio: 73.01%
[rank1]:2025-10-24 09:16:13,665 - INFO - Avg. fwd time: 55.7929 / Avg. bwd time: 68.4976 / Avg. batch time: 1546.6133 (ms) / GPU bubble ratio: 35.71%
[rank0]:2025-10-24 09:18:04,332 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-24 09:18:10,216 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,769  tflops: 21.64  mfu: 6.94%
[rank0]:2025-10-24 09:18:10,216 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,769  tflops: 21.64  mfu: 6.94%
[rank3]:2025-10-24 09:18:10,216 - INFO -  step: 1300  loss:  0.9395  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,774  tflops: 21.69  mfu: 6.95%
[rank2]:2025-10-24 09:18:10,215 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,769  tflops: 21.64  mfu: 6.94%
[rank1]:2025-10-24 09:18:10,303 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251024_0918_stage1_step1300.svg
[rank0]:2025-10-24 09:18:10,303 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251024_0918_stage0_step1300.svg
[rank2]:2025-10-24 09:18:10,301 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251024_0918_stage2_step1300.svg
[rank3]:2025-10-24 09:18:10,452 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/pipeline_schedule/251024_0918_real_step1300_rank3.svg
[rank3]:> Batch Time: 1537.44 ms, GPU Bubble Ratio: 75.00%, 25.67%, 66.74%, 22.62%
[rank3]:2025-10-24 09:18:10,515 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251024_0918_stage3_step1300.svg
[rank3]:2025-10-24 09:18:11,810 - INFO - Avg. fwd time: 76.4158 / Avg. bwd time: 77.1024 / Avg. batch time: 1278.1247 (ms) / GPU bubble ratio: 3.91%
[rank2]:2025-10-24 09:18:11,849 - INFO - Avg. fwd time: 35.0632 / Avg. bwd time: 31.9648 / Avg. batch time: 1396.0296 (ms) / GPU bubble ratio: 61.59%
[rank1]:2025-10-24 09:18:11,899 - INFO - Avg. fwd time: 55.7969 / Avg. bwd time: 68.0525 / Avg. batch time: 1544.2670 (ms) / GPU bubble ratio: 35.84%
[rank0]:2025-10-24 09:18:11,909 - INFO - Avg. fwd time: 47.5123 / Avg. bwd time: 6.0207 / Avg. batch time: 1587.5807 (ms) / GPU bubble ratio: 73.02%
[rank2]:2025-10-24 09:19:50,608 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-24 09:19:50,647 - WARNING - Dataset alpaca is being re-looped
[rank3]:2025-10-24 09:19:50,599 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 09:19:50,647 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-24 09:20:08,269 - INFO -  step: 1320  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,776  tflops: 21.70  mfu: 6.95%
[rank3]:2025-10-24 09:20:08,270 - INFO -  step: 1320  loss:  0.9457  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,776  tflops: 21.70  mfu: 6.95%
[rank0]:2025-10-24 09:20:08,270 - INFO -  step: 1320  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,776  tflops: 21.70  mfu: 6.95%
[rank2]:2025-10-24 09:20:08,268 - INFO -  step: 1320  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,776  tflops: 21.70  mfu: 6.95%
[rank3]:2025-10-24 09:20:09,673 - INFO - Avg. fwd time: 76.4143 / Avg. bwd time: 77.0265 / Avg. batch time: 1277.5119 (ms) / GPU bubble ratio: 3.91%
[rank2]:2025-10-24 09:20:09,713 - INFO - Avg. fwd time: 35.0624 / Avg. bwd time: 31.9274 / Avg. batch time: 1394.6375 (ms) / GPU bubble ratio: 61.57%
[rank1]:2025-10-24 09:20:09,763 - INFO - Avg. fwd time: 55.7963 / Avg. bwd time: 67.6173 / Avg. batch time: 1541.9407 (ms) / GPU bubble ratio: 35.97%
[rank0]:2025-10-24 09:20:09,774 - INFO - Avg. fwd time: 47.5031 / Avg. bwd time: 5.9295 / Avg. batch time: 1585.1610 (ms) / GPU bubble ratio: 73.03%
[rank0]:2025-10-24 09:22:06,254 - INFO -  step: 1340  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,777  tflops: 21.71  mfu: 6.96%
[rank2]:2025-10-24 09:22:06,253 - INFO -  step: 1340  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,777  tflops: 21.71  mfu: 6.96%
[rank1]:2025-10-24 09:22:06,254 - INFO -  step: 1340  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,777  tflops: 21.71  mfu: 6.96%
[rank3]:2025-10-24 09:22:06,254 - INFO -  step: 1340  loss:  0.9477  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,777  tflops: 21.71  mfu: 6.96%
[rank2]:2025-10-24 09:22:07,698 - INFO - Avg. fwd time: 35.0631 / Avg. bwd time: 31.8911 / Avg. batch time: 1393.3150 (ms) / GPU bubble ratio: 61.56%
[rank3]:2025-10-24 09:22:07,657 - INFO - Avg. fwd time: 76.4165 / Avg. bwd time: 76.9534 / Avg. batch time: 1276.9457 (ms) / GPU bubble ratio: 3.91%
[rank0]:2025-10-24 09:22:07,757 - INFO - Avg. fwd time: 47.4958 / Avg. bwd time: 5.8410 / Avg. batch time: 1582.8433 (ms) / GPU bubble ratio: 73.04%
[rank1]:2025-10-24 09:22:07,747 - INFO - Avg. fwd time: 55.7905 / Avg. bwd time: 67.1944 / Avg. batch time: 1539.7122 (ms) / GPU bubble ratio: 36.10%
[rank0]:2025-10-24 09:22:59,425 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-24 09:24:04,383 - INFO -  step: 1360  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,774  tflops: 21.69  mfu: 6.95%
[rank0]:2025-10-24 09:24:04,383 - INFO -  step: 1360  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,774  tflops: 21.69  mfu: 6.95%
[rank3]:2025-10-24 09:24:04,384 - INFO -  step: 1360  loss:  1.0207  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,774  tflops: 21.69  mfu: 6.95%
[rank2]:2025-10-24 09:24:04,382 - INFO -  step: 1360  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,774  tflops: 21.69  mfu: 6.95%
[rank3]:2025-10-24 09:24:05,789 - INFO - Avg. fwd time: 76.4120 / Avg. bwd time: 76.8869 / Avg. batch time: 1276.4047 (ms) / GPU bubble ratio: 3.92%
[rank2]:2025-10-24 09:24:05,831 - INFO - Avg. fwd time: 35.0627 / Avg. bwd time: 31.8572 / Avg. batch time: 1392.0434 (ms) / GPU bubble ratio: 61.54%
[rank1]:2025-10-24 09:24:05,880 - INFO - Avg. fwd time: 55.8034 / Avg. bwd time: 66.7855 / Avg. batch time: 1537.5706 (ms) / GPU bubble ratio: 36.22%
[rank0]:2025-10-24 09:24:05,891 - INFO - Avg. fwd time: 47.4934 / Avg. bwd time: 5.7551 / Avg. batch time: 1580.6165 (ms) / GPU bubble ratio: 73.05%
[rank0]:2025-10-24 09:26:02,491 - INFO -  step: 1380  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,774  tflops: 21.69  mfu: 6.95%
[rank3]:2025-10-24 09:26:02,491 - INFO -  step: 1380  loss:  0.9887  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,774  tflops: 21.69  mfu: 6.95%
[rank2]:2025-10-24 09:26:02,490 - INFO -  step: 1380  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,774  tflops: 21.69  mfu: 6.95%
[rank1]:2025-10-24 09:26:02,491 - INFO -  step: 1380  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,774  tflops: 21.69  mfu: 6.95%
[rank3]:2025-10-24 09:26:03,896 - INFO - Avg. fwd time: 76.4118 / Avg. bwd time: 76.8209 / Avg. batch time: 1275.8846 (ms) / GPU bubble ratio: 3.92%
[rank2]:2025-10-24 09:26:03,937 - INFO - Avg. fwd time: 35.0636 / Avg. bwd time: 31.8230 / Avg. batch time: 1390.8101 (ms) / GPU bubble ratio: 61.53%
[rank0]:2025-10-24 09:26:03,996 - INFO - Avg. fwd time: 47.4890 / Avg. bwd time: 5.6718 / Avg. batch time: 1578.4456 (ms) / GPU bubble ratio: 73.06%
[rank1]:2025-10-24 09:26:03,985 - INFO - Avg. fwd time: 55.8040 / Avg. bwd time: 66.3888 / Avg. batch time: 1535.4836 (ms) / GPU bubble ratio: 36.34%
[rank0]:2025-10-24 09:27:54,463 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-24 09:27:55,171 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 09:27:55,951 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-24 09:27:55,910 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-24 09:27:55,950 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 09:28:00,346 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,780  tflops: 21.74  mfu: 6.97%
[rank3]:2025-10-24 09:28:00,346 - INFO -  step: 1400  loss:  0.9671  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,780  tflops: 21.74  mfu: 6.97%
[rank2]:2025-10-24 09:28:00,345 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,780  tflops: 21.74  mfu: 6.97%
[rank1]:2025-10-24 09:28:00,346 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,780  tflops: 21.74  mfu: 6.97%
[rank0]:2025-10-24 09:28:00,447 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251024_0928_stage0_step1400.svg
[rank2]:2025-10-24 09:28:00,443 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251024_0928_stage2_step1400.svg
[rank1]:2025-10-24 09:28:00,447 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251024_0928_stage1_step1400.svg
[rank3]:2025-10-24 09:28:00,586 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/pipeline_schedule/251024_0928_real_step1400_rank3.svg
[rank3]:> Batch Time: 1454.50 ms, GPU Bubble Ratio: 73.57%, 27.12%, 64.84%, 18.29%
[rank3]:2025-10-24 09:28:00,652 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251024_0928_stage3_step1400.svg
[rank3]:2025-10-24 09:28:01,956 - INFO - Avg. fwd time: 76.4094 / Avg. bwd time: 76.7526 / Avg. batch time: 1275.3275 (ms) / GPU bubble ratio: 3.92%
[rank2]:2025-10-24 09:28:01,997 - INFO - Avg. fwd time: 35.0637 / Avg. bwd time: 31.7899 / Avg. batch time: 1389.5780 (ms) / GPU bubble ratio: 61.51%
[rank0]:2025-10-24 09:28:02,055 - INFO - Avg. fwd time: 47.4876 / Avg. bwd time: 5.5908 / Avg. batch time: 1576.3071 (ms) / GPU bubble ratio: 73.06%
[rank1]:2025-10-24 09:28:02,045 - INFO - Avg. fwd time: 55.8045 / Avg. bwd time: 66.0022 / Avg. batch time: 1533.4261 (ms) / GPU bubble ratio: 36.45%
[rank2]:2025-10-24 09:29:58,455 - INFO -  step: 1420  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,774  tflops: 21.69  mfu: 6.95%
[rank1]:2025-10-24 09:29:58,455 - INFO -  step: 1420  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,775  tflops: 21.69  mfu: 6.95%
[rank3]:2025-10-24 09:29:58,456 - INFO -  step: 1420  loss:  0.9655  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,775  tflops: 21.69  mfu: 6.95%
[rank0]:2025-10-24 09:29:58,456 - INFO -  step: 1420  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,775  tflops: 21.69  mfu: 6.95%
[rank3]:2025-10-24 09:29:59,859 - INFO - Avg. fwd time: 76.4050 / Avg. bwd time: 76.6892 / Avg. batch time: 1274.8049 (ms) / GPU bubble ratio: 3.93%
[rank2]:2025-10-24 09:29:59,901 - INFO - Avg. fwd time: 35.0644 / Avg. bwd time: 31.7586 / Avg. batch time: 1388.3853 (ms) / GPU bubble ratio: 61.50%
[rank1]:2025-10-24 09:29:59,949 - INFO - Avg. fwd time: 55.8133 / Avg. bwd time: 65.6279 / Avg. batch time: 1531.4350 (ms) / GPU bubble ratio: 36.56%
[rank0]:2025-10-24 09:29:59,960 - INFO - Avg. fwd time: 47.4792 / Avg. bwd time: 5.5120 / Avg. batch time: 1574.2363 (ms) / GPU bubble ratio: 73.07%
[rank0]:2025-10-24 09:31:56,509 - INFO -  step: 1440  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,776  tflops: 21.70  mfu: 6.95%
[rank2]:2025-10-24 09:31:56,508 - INFO -  step: 1440  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,776  tflops: 21.70  mfu: 6.95%
[rank1]:2025-10-24 09:31:56,509 - INFO -  step: 1440  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,776  tflops: 21.70  mfu: 6.95%
[rank3]:2025-10-24 09:31:56,510 - INFO -  step: 1440  loss:  1.0368  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,776  tflops: 21.70  mfu: 6.95%
[rank3]:2025-10-24 09:31:57,922 - INFO - Avg. fwd time: 76.3993 / Avg. bwd time: 76.6303 / Avg. batch time: 1274.3202 (ms) / GPU bubble ratio: 3.93%
[rank2]:2025-10-24 09:31:57,963 - INFO - Avg. fwd time: 35.0642 / Avg. bwd time: 31.7279 / Avg. batch time: 1387.2478 (ms) / GPU bubble ratio: 61.48%
[rank1]:2025-10-24 09:31:58,013 - INFO - Avg. fwd time: 55.8214 / Avg. bwd time: 65.2644 / Avg. batch time: 1529.5187 (ms) / GPU bubble ratio: 36.67%
[rank0]:2025-10-24 09:31:58,025 - INFO - Avg. fwd time: 47.4716 / Avg. bwd time: 5.4355 / Avg. batch time: 1572.2419 (ms) / GPU bubble ratio: 73.08%
[rank0]:2025-10-24 09:32:49,687 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-24 09:33:54,546 - INFO -  step: 1460  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,776  tflops: 21.70  mfu: 6.96%
[rank1]:2025-10-24 09:33:54,545 - INFO -  step: 1460  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,776  tflops: 21.70  mfu: 6.96%
[rank2]:2025-10-24 09:33:54,545 - INFO -  step: 1460  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,776  tflops: 21.70  mfu: 6.96%
[rank3]:2025-10-24 09:33:54,546 - INFO -  step: 1460  loss:  0.9822  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,776  tflops: 21.70  mfu: 6.96%
[rank3]:2025-10-24 09:33:55,961 - INFO - Avg. fwd time: 76.3988 / Avg. bwd time: 76.5697 / Avg. batch time: 1273.8391 (ms) / GPU bubble ratio: 3.93%
[rank0]:2025-10-24 09:33:56,063 - INFO - Avg. fwd time: 47.4697 / Avg. bwd time: 5.3611 / Avg. batch time: 1570.2988 (ms) / GPU bubble ratio: 73.08%
[rank1]:2025-10-24 09:33:56,051 - INFO - Avg. fwd time: 55.8236 / Avg. bwd time: 64.9088 / Avg. batch time: 1527.6505 (ms) / GPU bubble ratio: 36.77%
[rank2]:2025-10-24 09:33:56,002 - INFO - Avg. fwd time: 35.0627 / Avg. bwd time: 31.6978 / Avg. batch time: 1386.1318 (ms) / GPU bubble ratio: 61.47%
[rank3]:2025-10-24 09:35:52,480 - INFO -  step: 1480  loss:  0.9738  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,779  tflops: 21.72  mfu: 6.96%
[rank1]:2025-10-24 09:35:52,479 - INFO -  step: 1480  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,779  tflops: 21.72  mfu: 6.96%
[rank0]:2025-10-24 09:35:52,479 - INFO -  step: 1480  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,779  tflops: 21.72  mfu: 6.96%
[rank2]:2025-10-24 09:35:52,478 - INFO -  step: 1480  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,779  tflops: 21.72  mfu: 6.96%
[rank3]:2025-10-24 09:35:53,853 - INFO - Avg. fwd time: 76.3975 / Avg. bwd time: 76.5095 / Avg. batch time: 1273.3460 (ms) / GPU bubble ratio: 3.93%
[rank2]:2025-10-24 09:35:53,894 - INFO - Avg. fwd time: 35.0639 / Avg. bwd time: 31.6684 / Avg. batch time: 1385.0206 (ms) / GPU bubble ratio: 61.45%
[rank1]:2025-10-24 09:35:53,945 - INFO - Avg. fwd time: 55.8181 / Avg. bwd time: 64.5634 / Avg. batch time: 1525.8012 (ms) / GPU bubble ratio: 36.88%
[rank0]:2025-10-24 09:35:53,957 - INFO - Avg. fwd time: 47.4686 / Avg. bwd time: 5.2887 / Avg. batch time: 1568.3768 (ms) / GPU bubble ratio: 73.09%
[rank3]:2025-10-24 09:36:00,629 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-24 09:36:01,408 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 09:36:01,413 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-24 09:36:01,367 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 09:37:44,302 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-24 09:37:50,206 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,783  tflops: 21.76  mfu: 6.97%
[rank2]:2025-10-24 09:37:50,207 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-24 09:37:50,208 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,783  tflops: 21.76  mfu: 6.97%
[rank1]:2025-10-24 09:37:50,208 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-24 09:37:50,208 - INFO -  step: 1500  loss:  0.9843  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,783  tflops: 21.76  mfu: 6.97%
[rank3]:2025-10-24 09:37:50,208 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-24 09:37:50,208 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,783  tflops: 21.76  mfu: 6.97%
[rank0]:2025-10-24 09:37:50,208 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-24 09:37:50,209 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank2]:2025-10-24 09:37:52,072 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 1.86 seconds.
[rank1]:2025-10-24 09:37:52,447 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 2.24 seconds.
[rank3]:2025-10-24 09:37:53,495 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.29 seconds.
[rank0]:2025-10-24 09:37:53,878 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-24 09:37:53,885 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.68 seconds.
[rank0]:2025-10-24 09:37:53,885 - INFO - Checkpointer is deleting /data2/shcho/torchtitan/checkpoint/1023_GPipe_fullrand7_dm1/step-500.
[rank1]:2025-10-24 09:37:53,975 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251024_0937_stage1_step1500.svg
[rank2]:2025-10-24 09:37:53,975 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251024_0937_stage2_step1500.svg
[rank0]:2025-10-24 09:37:54,051 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251024_0937_stage0_step1500.svg
[rank3]:2025-10-24 09:37:54,302 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/pipeline_schedule/251024_0937_real_step1500_rank3.svg
[rank3]:> Batch Time: 1408.41 ms, GPU Bubble Ratio: 72.72%, 28.83%, 63.68%, 15.67%
[rank3]:2025-10-24 09:37:54,375 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251024_0937_stage3_step1500.svg
[rank3]:2025-10-24 09:37:55,669 - INFO - Avg. fwd time: 76.3911 / Avg. bwd time: 76.4520 / Avg. batch time: 1272.8485 (ms) / GPU bubble ratio: 3.94%
[rank2]:2025-10-24 09:37:55,711 - INFO - Avg. fwd time: 35.0653 / Avg. bwd time: 31.6398 / Avg. batch time: 1383.9525 (ms) / GPU bubble ratio: 61.44%
[rank1]:2025-10-24 09:37:55,760 - INFO - Avg. fwd time: 55.8244 / Avg. bwd time: 64.2289 / Avg. batch time: 1524.0143 (ms) / GPU bubble ratio: 36.98%
[rank0]:2025-10-24 09:37:55,772 - INFO - Avg. fwd time: 47.4605 / Avg. bwd time: 5.2182 / Avg. batch time: 1566.5190 (ms) / GPU bubble ratio: 73.10%
[rank0]:2025-10-24 09:37:55,875 - INFO - Checkpointer deleted /data2/shcho/torchtitan/checkpoint/1023_GPipe_fullrand7_dm1/step-500 in 1.99 seconds.
[rank2]:2025-10-24 09:39:52,280 - INFO -  step: 1520  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,684  tflops: 20.98  mfu: 6.73%
[rank3]:2025-10-24 09:39:52,281 - INFO -  step: 1520  loss:  1.0369  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,684  tflops: 20.98  mfu: 6.73%
[rank1]:2025-10-24 09:39:52,281 - INFO -  step: 1520  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,684  tflops: 20.98  mfu: 6.73%
[rank0]:2025-10-24 09:39:52,281 - INFO -  step: 1520  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,684  tflops: 20.98  mfu: 6.73%
[rank3]:2025-10-24 09:39:53,698 - INFO - Avg. fwd time: 76.3928 / Avg. bwd time: 76.3951 / Avg. batch time: 1272.4100 (ms) / GPU bubble ratio: 3.94%
[rank2]:2025-10-24 09:39:53,740 - INFO - Avg. fwd time: 35.0670 / Avg. bwd time: 31.6119 / Avg. batch time: 1382.9272 (ms) / GPU bubble ratio: 61.43%
[rank1]:2025-10-24 09:39:53,790 - INFO - Avg. fwd time: 55.8242 / Avg. bwd time: 63.9025 / Avg. batch time: 1522.2882 (ms) / GPU bubble ratio: 37.08%
[rank0]:2025-10-24 09:39:53,801 - INFO - Avg. fwd time: 47.4566 / Avg. bwd time: 5.1496 / Avg. batch time: 1564.7239 (ms) / GPU bubble ratio: 73.10%
[rank1]:2025-10-24 09:41:50,206 - INFO -  step: 1540  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,779  tflops: 21.72  mfu: 6.96%
[rank0]:2025-10-24 09:41:50,207 - INFO -  step: 1540  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,779  tflops: 21.72  mfu: 6.96%
[rank2]:2025-10-24 09:41:50,205 - INFO -  step: 1540  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,779  tflops: 21.72  mfu: 6.96%
[rank3]:2025-10-24 09:41:50,207 - INFO -  step: 1540  loss:  0.9939  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,779  tflops: 21.72  mfu: 6.96%
[rank2]:2025-10-24 09:41:51,653 - INFO - Avg. fwd time: 35.0662 / Avg. bwd time: 31.5851 / Avg. batch time: 1381.9159 (ms) / GPU bubble ratio: 61.42%
[rank3]:2025-10-24 09:41:51,612 - INFO - Avg. fwd time: 76.3896 / Avg. bwd time: 76.3400 / Avg. batch time: 1271.9653 (ms) / GPU bubble ratio: 3.94%
[rank1]:2025-10-24 09:41:51,703 - INFO - Avg. fwd time: 55.8356 / Avg. bwd time: 63.5853 / Avg. batch time: 1520.5935 (ms) / GPU bubble ratio: 37.17%
[rank0]:2025-10-24 09:41:51,716 - INFO - Avg. fwd time: 47.4507 / Avg. bwd time: 5.0827 / Avg. batch time: 1562.9623 (ms) / GPU bubble ratio: 73.11%
[rank0]:2025-10-24 09:42:43,550 - INFO - [GC] Peforming periodical GC collection 0.26 seconds
[rank0]:2025-10-24 09:43:48,385 - INFO -  step: 1560  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,773  tflops: 21.68  mfu: 6.95%
[rank2]:2025-10-24 09:43:48,383 - INFO -  step: 1560  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,773  tflops: 21.68  mfu: 6.95%
[rank3]:2025-10-24 09:43:48,385 - INFO -  step: 1560  loss:  0.9726  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,773  tflops: 21.68  mfu: 6.95%
[rank1]:2025-10-24 09:43:48,384 - INFO -  step: 1560  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,773  tflops: 21.68  mfu: 6.95%
[rank3]:2025-10-24 09:43:49,805 - INFO - Avg. fwd time: 76.3905 / Avg. bwd time: 76.2822 / Avg. batch time: 1271.5169 (ms) / GPU bubble ratio: 3.94%
[rank2]:2025-10-24 09:43:49,847 - INFO - Avg. fwd time: 35.0654 / Avg. bwd time: 31.5579 / Avg. batch time: 1380.9115 (ms) / GPU bubble ratio: 61.40%
[rank1]:2025-10-24 09:43:49,897 - INFO - Avg. fwd time: 55.8328 / Avg. bwd time: 63.2756 / Avg. batch time: 1518.9252 (ms) / GPU bubble ratio: 37.27%
[rank0]:2025-10-24 09:43:49,909 - INFO - Avg. fwd time: 47.4478 / Avg. bwd time: 5.0176 / Avg. batch time: 1561.2279 (ms) / GPU bubble ratio: 73.12%
[rank2]:2025-10-24 09:44:11,953 - WARNING - Dataset alpaca is being re-looped
[rank3]:2025-10-24 09:44:11,943 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 09:44:11,999 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-24 09:44:11,999 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 09:45:46,247 - INFO -  step: 1580  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,780  tflops: 21.73  mfu: 6.97%
[rank1]:2025-10-24 09:45:46,246 - INFO -  step: 1580  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,780  tflops: 21.73  mfu: 6.97%
[rank2]:2025-10-24 09:45:46,246 - INFO -  step: 1580  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,780  tflops: 21.73  mfu: 6.97%
[rank3]:2025-10-24 09:45:46,247 - INFO -  step: 1580  loss:  0.9757  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,780  tflops: 21.73  mfu: 6.97%
[rank3]:2025-10-24 09:45:47,651 - INFO - Avg. fwd time: 76.3840 / Avg. bwd time: 76.2298 / Avg. batch time: 1271.0643 (ms) / GPU bubble ratio: 3.95%
[rank0]:2025-10-24 09:45:47,755 - INFO - Avg. fwd time: 47.4436 / Avg. bwd time: 4.9541 / Avg. batch time: 1559.5276 (ms) / GPU bubble ratio: 73.12%
[rank1]:2025-10-24 09:45:47,743 - INFO - Avg. fwd time: 55.8382 / Avg. bwd time: 62.9737 / Avg. batch time: 1517.2874 (ms) / GPU bubble ratio: 37.36%
[rank2]:2025-10-24 09:45:47,694 - INFO - Avg. fwd time: 35.0657 / Avg. bwd time: 31.5317 / Avg. batch time: 1379.9165 (ms) / GPU bubble ratio: 61.39%
[rank0]:2025-10-24 09:47:38,361 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-24 09:47:44,283 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,776  tflops: 21.70  mfu: 6.96%
[rank1]:2025-10-24 09:47:44,283 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,776  tflops: 21.70  mfu: 6.96%
[rank2]:2025-10-24 09:47:44,282 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,776  tflops: 21.70  mfu: 6.96%
[rank3]:2025-10-24 09:47:44,283 - INFO -  step: 1600  loss:  1.0283  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,776  tflops: 21.70  mfu: 6.96%
[rank0]:2025-10-24 09:47:44,370 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251024_0947_stage0_step1600.svg
[rank1]:2025-10-24 09:47:44,370 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251024_0947_stage1_step1600.svg
[rank2]:2025-10-24 09:47:44,372 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251024_0947_stage2_step1600.svg
[rank3]:2025-10-24 09:47:44,513 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/pipeline_schedule/251024_0947_real_step1600_rank3.svg
[rank3]:> Batch Time: 1382.58 ms, GPU Bubble Ratio: 72.21%, 43.24%, 63.01%, 14.11%
[rank3]:2025-10-24 09:47:44,584 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251024_0947_stage3_step1600.svg
[rank2]:2025-10-24 09:47:45,934 - INFO - Avg. fwd time: 35.0634 / Avg. bwd time: 31.5071 / Avg. batch time: 1378.9992 (ms) / GPU bubble ratio: 61.38%
[rank3]:2025-10-24 09:47:45,892 - INFO - Avg. fwd time: 76.3852 / Avg. bwd time: 76.1777 / Avg. batch time: 1270.6601 (ms) / GPU bubble ratio: 3.95%
[rank0]:2025-10-24 09:47:45,996 - INFO - Avg. fwd time: 47.4430 / Avg. bwd time: 4.8922 / Avg. batch time: 1557.9196 (ms) / GPU bubble ratio: 73.13%
[rank1]:2025-10-24 09:47:45,984 - INFO - Avg. fwd time: 55.8369 / Avg. bwd time: 62.6799 / Avg. batch time: 1515.7400 (ms) / GPU bubble ratio: 37.45%
[rank1]:2025-10-24 09:49:42,574 - INFO -  step: 1620  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,770  tflops: 21.66  mfu: 6.94%
[rank2]:2025-10-24 09:49:42,574 - INFO -  step: 1620  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,770  tflops: 21.66  mfu: 6.94%
[rank3]:2025-10-24 09:49:42,575 - INFO -  step: 1620  loss:  1.0071  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,770  tflops: 21.66  mfu: 6.94%
[rank0]:2025-10-24 09:49:42,575 - INFO -  step: 1620  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,770  tflops: 21.66  mfu: 6.94%
[rank3]:2025-10-24 09:49:43,988 - INFO - Avg. fwd time: 76.3819 / Avg. bwd time: 76.1307 / Avg. batch time: 1270.2732 (ms) / GPU bubble ratio: 3.95%
[rank1]:2025-10-24 09:49:44,081 - INFO - Avg. fwd time: 55.8467 / Avg. bwd time: 62.3932 / Avg. batch time: 1514.2241 (ms) / GPU bubble ratio: 37.53%
[rank2]:2025-10-24 09:49:44,031 - INFO - Avg. fwd time: 35.0617 / Avg. bwd time: 31.4827 / Avg. batch time: 1378.0979 (ms) / GPU bubble ratio: 61.37%
[rank0]:2025-10-24 09:49:44,093 - INFO - Avg. fwd time: 47.4432 / Avg. bwd time: 4.8318 / Avg. batch time: 1556.3441 (ms) / GPU bubble ratio: 73.13%
[rank0]:2025-10-24 09:51:40,897 - INFO -  step: 1640  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,769  tflops: 21.65  mfu: 6.94%
[rank1]:2025-10-24 09:51:40,897 - INFO -  step: 1640  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,769  tflops: 21.65  mfu: 6.94%
[rank2]:2025-10-24 09:51:40,896 - INFO -  step: 1640  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,769  tflops: 21.65  mfu: 6.94%
[rank3]:2025-10-24 09:51:40,897 - INFO -  step: 1640  loss:  0.9614  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,769  tflops: 21.65  mfu: 6.94%
[rank2]:2025-10-24 09:51:42,344 - INFO - Avg. fwd time: 35.0615 / Avg. bwd time: 31.4588 / Avg. batch time: 1377.2543 (ms) / GPU bubble ratio: 61.36%
[rank3]:2025-10-24 09:51:42,301 - INFO - Avg. fwd time: 76.3828 / Avg. bwd time: 76.0853 / Avg. batch time: 1269.9296 (ms) / GPU bubble ratio: 3.95%
[rank0]:2025-10-24 09:51:42,407 - INFO - Avg. fwd time: 47.4422 / Avg. bwd time: 4.7729 / Avg. batch time: 1554.8447 (ms) / GPU bubble ratio: 73.13%
[rank1]:2025-10-24 09:51:42,394 - INFO - Avg. fwd time: 55.8517 / Avg. bwd time: 62.1146 / Avg. batch time: 1512.7831 (ms) / GPU bubble ratio: 37.62%
[rank3]:2025-10-24 09:52:17,002 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-24 09:52:17,787 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-24 09:52:17,747 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 09:52:17,791 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 09:52:34,084 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-24 09:53:39,012 - INFO -  step: 1660  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,774  tflops: 21.69  mfu: 6.95%
[rank2]:2025-10-24 09:53:39,011 - INFO -  step: 1660  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,774  tflops: 21.69  mfu: 6.95%
[rank3]:2025-10-24 09:53:39,013 - INFO -  step: 1660  loss:  0.9552  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,774  tflops: 21.69  mfu: 6.95%
[rank0]:2025-10-24 09:53:39,012 - INFO -  step: 1660  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,774  tflops: 21.69  mfu: 6.95%
[rank3]:2025-10-24 09:53:40,426 - INFO - Avg. fwd time: 76.3780 / Avg. bwd time: 76.0414 / Avg. batch time: 1269.5663 (ms) / GPU bubble ratio: 3.96%
[rank2]:2025-10-24 09:53:40,469 - INFO - Avg. fwd time: 35.0626 / Avg. bwd time: 31.4360 / Avg. batch time: 1376.4059 (ms) / GPU bubble ratio: 61.35%
[rank0]:2025-10-24 09:53:40,537 - INFO - Avg. fwd time: 47.4396 / Avg. bwd time: 4.7154 / Avg. batch time: 1553.3592 (ms) / GPU bubble ratio: 73.14%
[rank1]:2025-10-24 09:53:40,524 - INFO - Avg. fwd time: 55.8615 / Avg. bwd time: 61.8429 / Avg. batch time: 1511.3534 (ms) / GPU bubble ratio: 37.70%
[rank1]:2025-10-24 09:55:37,663 - INFO -  step: 1680  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,762  tflops: 21.59  mfu: 6.92%
[rank2]:2025-10-24 09:55:37,662 - INFO -  step: 1680  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,762  tflops: 21.59  mfu: 6.92%
[rank3]:2025-10-24 09:55:37,663 - INFO -  step: 1680  loss:  0.9963  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,762  tflops: 21.59  mfu: 6.92%
[rank0]:2025-10-24 09:55:37,663 - INFO -  step: 1680  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,762  tflops: 21.59  mfu: 6.92%
[rank3]:2025-10-24 09:55:39,099 - INFO - Avg. fwd time: 76.3880 / Avg. bwd time: 75.9984 / Avg. batch time: 1269.2925 (ms) / GPU bubble ratio: 3.96%
[rank2]:2025-10-24 09:55:39,142 - INFO - Avg. fwd time: 35.0628 / Avg. bwd time: 31.4140 / Avg. batch time: 1375.6550 (ms) / GPU bubble ratio: 61.34%
[rank0]:2025-10-24 09:55:39,205 - INFO - Avg. fwd time: 47.4423 / Avg. bwd time: 4.6593 / Avg. batch time: 1551.9805 (ms) / GPU bubble ratio: 73.14%
[rank1]:2025-10-24 09:55:39,192 - INFO - Avg. fwd time: 55.8551 / Avg. bwd time: 61.5765 / Avg. batch time: 1510.0286 (ms) / GPU bubble ratio: 37.79%
[rank0]:2025-10-24 09:57:30,241 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-24 09:57:36,182 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,765  tflops: 21.62  mfu: 6.93%
[rank1]:2025-10-24 09:57:36,182 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,765  tflops: 21.62  mfu: 6.93%
[rank2]:2025-10-24 09:57:36,181 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,765  tflops: 21.61  mfu: 6.93%
[rank3]:2025-10-24 09:57:36,182 - INFO -  step: 1700  loss:  1.0088  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,765  tflops: 21.62  mfu: 6.93%
[rank0]:2025-10-24 09:57:36,268 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251024_0957_stage0_step1700.svg
[rank1]:2025-10-24 09:57:36,268 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251024_0957_stage1_step1700.svg
[rank2]:2025-10-24 09:57:36,267 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251024_0957_stage2_step1700.svg
[rank3]:2025-10-24 09:57:36,405 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/pipeline_schedule/251024_0957_real_step1700_rank3.svg
[rank3]:> Batch Time: 1381.69 ms, GPU Bubble Ratio: 72.19%, 43.48%, 62.98%, 14.05%
[rank3]:2025-10-24 09:57:36,471 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251024_0957_stage3_step1700.svg
[rank3]:2025-10-24 09:57:37,774 - INFO - Avg. fwd time: 76.3922 / Avg. bwd time: 75.9567 / Avg. batch time: 1268.9953 (ms) / GPU bubble ratio: 3.96%
[rank2]:2025-10-24 09:57:37,816 - INFO - Avg. fwd time: 35.0632 / Avg. bwd time: 31.3926 / Avg. batch time: 1374.9058 (ms) / GPU bubble ratio: 61.33%
[rank0]:2025-10-24 09:57:37,880 - INFO - Avg. fwd time: 47.4406 / Avg. bwd time: 4.6045 / Avg. batch time: 1550.6161 (ms) / GPU bubble ratio: 73.15%
[rank1]:2025-10-24 09:57:37,868 - INFO - Avg. fwd time: 55.8528 / Avg. bwd time: 61.3175 / Avg. batch time: 1508.7194 (ms) / GPU bubble ratio: 37.87%
[rank1]:2025-10-24 09:59:35,074 - INFO -  step: 1720  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,756  tflops: 21.55  mfu: 6.91%
[rank2]:2025-10-24 09:59:35,074 - INFO -  step: 1720  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,756  tflops: 21.55  mfu: 6.91%
[rank3]:2025-10-24 09:59:35,075 - INFO -  step: 1720  loss:  0.9750  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,756  tflops: 21.55  mfu: 6.91%
[rank0]:2025-10-24 09:59:35,075 - INFO -  step: 1720  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,756  tflops: 21.55  mfu: 6.91%
[rank3]:2025-10-24 09:59:36,478 - INFO - Avg. fwd time: 76.3997 / Avg. bwd time: 75.9159 / Avg. batch time: 1268.7296 (ms) / GPU bubble ratio: 3.96%
[rank1]:2025-10-24 09:59:36,571 - INFO - Avg. fwd time: 55.8511 / Avg. bwd time: 61.0648 / Avg. batch time: 1507.4578 (ms) / GPU bubble ratio: 37.95%
[rank2]:2025-10-24 09:59:36,521 - INFO - Avg. fwd time: 35.0633 / Avg. bwd time: 31.3717 / Avg. batch time: 1374.1884 (ms) / GPU bubble ratio: 61.32%
[rank0]:2025-10-24 09:59:36,585 - INFO - Avg. fwd time: 47.4392 / Avg. bwd time: 4.5510 / Avg. batch time: 1549.3022 (ms) / GPU bubble ratio: 73.15%
[rank3]:2025-10-24 10:00:24,767 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-24 10:00:25,552 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-24 10:00:25,512 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 10:00:25,554 - WARNING - Dataset alpaca is being re-looped
[rank3]:2025-10-24 10:01:33,671 - INFO -  step: 1740  loss:  0.9992  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,763  tflops: 21.60  mfu: 6.92%
[rank2]:2025-10-24 10:01:33,670 - INFO -  step: 1740  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,763  tflops: 21.60  mfu: 6.92%
[rank0]:2025-10-24 10:01:33,671 - INFO -  step: 1740  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,763  tflops: 21.60  mfu: 6.92%
[rank1]:2025-10-24 10:01:33,671 - INFO -  step: 1740  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,763  tflops: 21.60  mfu: 6.92%
[rank3]:2025-10-24 10:01:35,092 - INFO - Avg. fwd time: 76.4084 / Avg. bwd time: 75.8750 / Avg. batch time: 1268.4671 (ms) / GPU bubble ratio: 3.96%
[rank2]:2025-10-24 10:01:35,136 - INFO - Avg. fwd time: 35.0634 / Avg. bwd time: 31.3511 / Avg. batch time: 1373.4831 (ms) / GPU bubble ratio: 61.32%
[rank0]:2025-10-24 10:01:35,202 - INFO - Avg. fwd time: 47.4414 / Avg. bwd time: 4.4987 / Avg. batch time: 1548.0122 (ms) / GPU bubble ratio: 73.16%
[rank1]:2025-10-24 10:01:35,188 - INFO - Avg. fwd time: 55.8464 / Avg. bwd time: 60.8177 / Avg. batch time: 1506.2187 (ms) / GPU bubble ratio: 38.04%
[rank0]:2025-10-24 10:02:26,979 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-24 10:03:32,201 - INFO -  step: 1760  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,765  tflops: 21.61  mfu: 6.93%
[rank2]:2025-10-24 10:03:32,200 - INFO -  step: 1760  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,765  tflops: 21.61  mfu: 6.93%
[rank0]:2025-10-24 10:03:32,201 - INFO -  step: 1760  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,765  tflops: 21.61  mfu: 6.93%
[rank3]:2025-10-24 10:03:32,201 - INFO -  step: 1760  loss:  1.0205  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,765  tflops: 21.61  mfu: 6.93%
[rank3]:2025-10-24 10:03:33,627 - INFO - Avg. fwd time: 76.4161 / Avg. bwd time: 75.8347 / Avg. batch time: 1268.1947 (ms) / GPU bubble ratio: 3.96%
[rank1]:2025-10-24 10:03:33,722 - INFO - Avg. fwd time: 55.8429 / Avg. bwd time: 60.5755 / Avg. batch time: 1504.9926 (ms) / GPU bubble ratio: 38.12%
[rank2]:2025-10-24 10:03:33,670 - INFO - Avg. fwd time: 35.0627 / Avg. bwd time: 31.3316 / Avg. batch time: 1372.7782 (ms) / GPU bubble ratio: 61.31%
[rank0]:2025-10-24 10:03:33,735 - INFO - Avg. fwd time: 47.4457 / Avg. bwd time: 4.4476 / Avg. batch time: 1546.7373 (ms) / GPU bubble ratio: 73.16%
[rank2]:2025-10-24 10:05:30,782 - INFO -  step: 1780  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,763  tflops: 21.60  mfu: 6.92%
[rank3]:2025-10-24 10:05:30,784 - INFO -  step: 1780  loss:  1.0168  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,763  tflops: 21.60  mfu: 6.92%
[rank0]:2025-10-24 10:05:30,784 - INFO -  step: 1780  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,763  tflops: 21.60  mfu: 6.92%
[rank1]:2025-10-24 10:05:30,783 - INFO -  step: 1780  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,763  tflops: 21.60  mfu: 6.92%
[rank3]:2025-10-24 10:05:32,216 - INFO - Avg. fwd time: 76.4206 / Avg. bwd time: 75.7967 / Avg. batch time: 1267.9339 (ms) / GPU bubble ratio: 3.96%
[rank2]:2025-10-24 10:05:32,260 - INFO - Avg. fwd time: 35.0617 / Avg. bwd time: 31.3122 / Avg. batch time: 1372.0948 (ms) / GPU bubble ratio: 61.30%
[rank0]:2025-10-24 10:05:32,330 - INFO - Avg. fwd time: 47.4451 / Avg. bwd time: 4.3977 / Avg. batch time: 1545.4959 (ms) / GPU bubble ratio: 73.16%
[rank1]:2025-10-24 10:05:32,316 - INFO - Avg. fwd time: 55.8446 / Avg. bwd time: 60.3400 / Avg. batch time: 1503.8002 (ms) / GPU bubble ratio: 38.19%
[rank0]:2025-10-24 10:07:23,393 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-24 10:07:29,339 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,764  tflops: 21.61  mfu: 6.93%
[rank3]:2025-10-24 10:07:29,341 - INFO -  step: 1800  loss:  0.9464  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,764  tflops: 21.61  mfu: 6.93%
[rank1]:2025-10-24 10:07:29,340 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,764  tflops: 21.61  mfu: 6.93%
[rank0]:2025-10-24 10:07:29,340 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,764  tflops: 21.61  mfu: 6.93%
[rank2]:2025-10-24 10:07:29,438 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251024_1007_stage2_step1800.svg
[rank1]:2025-10-24 10:07:29,436 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251024_1007_stage1_step1800.svg
[rank0]:2025-10-24 10:07:29,437 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251024_1007_stage0_step1800.svg
[rank3]:2025-10-24 10:07:29,580 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/pipeline_schedule/251024_1007_real_step1800_rank3.svg
[rank3]:> Batch Time: 1381.72 ms, GPU Bubble Ratio: 72.19%, 43.62%, 62.97%, 14.02%
[rank3]:2025-10-24 10:07:29,649 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251024_1007_stage3_step1800.svg
[rank3]:2025-10-24 10:07:30,951 - INFO - Avg. fwd time: 76.4228 / Avg. bwd time: 75.7601 / Avg. batch time: 1267.6647 (ms) / GPU bubble ratio: 3.96%
[rank2]:2025-10-24 10:07:30,994 - INFO - Avg. fwd time: 35.0612 / Avg. bwd time: 31.2926 / Avg. batch time: 1371.4246 (ms) / GPU bubble ratio: 61.29%
[rank1]:2025-10-24 10:07:31,046 - INFO - Avg. fwd time: 55.8498 / Avg. bwd time: 60.1092 / Avg. batch time: 1502.6348 (ms) / GPU bubble ratio: 38.26%
[rank0]:2025-10-24 10:07:31,059 - INFO - Avg. fwd time: 47.4485 / Avg. bwd time: 4.3488 / Avg. batch time: 1544.2838 (ms) / GPU bubble ratio: 73.17%
[rank3]:2025-10-24 10:08:32,339 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-24 10:08:33,082 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 10:08:33,122 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-24 10:08:33,119 - WARNING - Dataset alpaca is being re-looped
[rank3]:2025-10-24 10:09:27,732 - INFO -  step: 1820  loss:  0.9581  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,768  tflops: 21.64  mfu: 6.94%
[rank0]:2025-10-24 10:09:27,732 - INFO -  step: 1820  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,768  tflops: 21.64  mfu: 6.93%
[rank1]:2025-10-24 10:09:27,732 - INFO -  step: 1820  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,768  tflops: 21.64  mfu: 6.93%
[rank2]:2025-10-24 10:09:27,731 - INFO -  step: 1820  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,768  tflops: 21.64  mfu: 6.93%
[rank2]:2025-10-24 10:09:29,207 - INFO - Avg. fwd time: 35.0628 / Avg. bwd time: 31.2733 / Avg. batch time: 1370.7218 (ms) / GPU bubble ratio: 61.28%
[rank3]:2025-10-24 10:09:29,163 - INFO - Avg. fwd time: 76.4198 / Avg. bwd time: 75.7238 / Avg. batch time: 1267.3662 (ms) / GPU bubble ratio: 3.96%
[rank0]:2025-10-24 10:09:29,273 - INFO - Avg. fwd time: 47.4479 / Avg. bwd time: 4.3011 / Avg. batch time: 1543.0452 (ms) / GPU bubble ratio: 73.17%
[rank1]:2025-10-24 10:09:29,259 - INFO - Avg. fwd time: 55.8524 / Avg. bwd time: 59.8841 / Avg. batch time: 1501.4426 (ms) / GPU bubble ratio: 38.33%
[rank0]:2025-10-24 10:11:26,128 - INFO -  step: 1840  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,768  tflops: 21.64  mfu: 6.93%
[rank1]:2025-10-24 10:11:26,128 - INFO -  step: 1840  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,768  tflops: 21.64  mfu: 6.93%
[rank2]:2025-10-24 10:11:26,127 - INFO -  step: 1840  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,768  tflops: 21.64  mfu: 6.93%
[rank3]:2025-10-24 10:11:26,128 - INFO -  step: 1840  loss:  1.0272  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,768  tflops: 21.64  mfu: 6.93%
[rank2]:2025-10-24 10:11:27,576 - INFO - Avg. fwd time: 35.0630 / Avg. bwd time: 31.2551 / Avg. batch time: 1370.0536 (ms) / GPU bubble ratio: 61.28%
[rank3]:2025-10-24 10:11:27,532 - INFO - Avg. fwd time: 76.4174 / Avg. bwd time: 75.6891 / Avg. batch time: 1267.0904 (ms) / GPU bubble ratio: 3.96%
[rank0]:2025-10-24 10:11:27,642 - INFO - Avg. fwd time: 47.4465 / Avg. bwd time: 4.2544 / Avg. batch time: 1541.8557 (ms) / GPU bubble ratio: 73.17%
[rank1]:2025-10-24 10:11:27,629 - INFO - Avg. fwd time: 55.8600 / Avg. bwd time: 59.6641 / Avg. batch time: 1500.2987 (ms) / GPU bubble ratio: 38.40%
[rank0]:2025-10-24 10:12:19,318 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-24 10:13:24,077 - INFO -  step: 1860  loss:  1.0576  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,778  tflops: 21.72  mfu: 6.96%
[rank0]:2025-10-24 10:13:24,076 - INFO -  step: 1860  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,778  tflops: 21.72  mfu: 6.96%
[rank1]:2025-10-24 10:13:24,076 - INFO -  step: 1860  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,778  tflops: 21.72  mfu: 6.96%
[rank2]:2025-10-24 10:13:24,075 - INFO -  step: 1860  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,778  tflops: 21.72  mfu: 6.96%
[rank3]:2025-10-24 10:13:25,495 - INFO - Avg. fwd time: 76.4123 / Avg. bwd time: 75.6520 / Avg. batch time: 1266.7690 (ms) / GPU bubble ratio: 3.97%
[rank0]:2025-10-24 10:13:25,606 - INFO - Avg. fwd time: 47.4456 / Avg. bwd time: 4.2086 / Avg. batch time: 1540.6334 (ms) / GPU bubble ratio: 73.18%
[rank1]:2025-10-24 10:13:25,592 - INFO - Avg. fwd time: 55.8589 / Avg. bwd time: 59.4482 / Avg. batch time: 1499.1221 (ms) / GPU bubble ratio: 38.47%
[rank2]:2025-10-24 10:13:25,539 - INFO - Avg. fwd time: 35.0641 / Avg. bwd time: 31.2372 / Avg. batch time: 1369.3438 (ms) / GPU bubble ratio: 61.27%
[rank0]:2025-10-24 10:15:21,949 - INFO -  step: 1880  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,780  tflops: 21.73  mfu: 6.97%
[rank1]:2025-10-24 10:15:21,949 - INFO -  step: 1880  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,780  tflops: 21.73  mfu: 6.97%
[rank2]:2025-10-24 10:15:21,948 - INFO -  step: 1880  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,780  tflops: 21.73  mfu: 6.97%
[rank3]:2025-10-24 10:15:21,950 - INFO -  step: 1880  loss:  0.9856  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,780  tflops: 21.73  mfu: 6.97%
[rank3]:2025-10-24 10:15:23,369 - INFO - Avg. fwd time: 76.4083 / Avg. bwd time: 75.6143 / Avg. batch time: 1266.4402 (ms) / GPU bubble ratio: 3.97%
[rank1]:2025-10-24 10:15:23,466 - INFO - Avg. fwd time: 55.8588 / Avg. bwd time: 59.2362 / Avg. batch time: 1497.9586 (ms) / GPU bubble ratio: 38.53%
[rank2]:2025-10-24 10:15:23,413 - INFO - Avg. fwd time: 35.0645 / Avg. bwd time: 31.2192 / Avg. batch time: 1368.6349 (ms) / GPU bubble ratio: 61.26%
[rank0]:2025-10-24 10:15:23,481 - INFO - Avg. fwd time: 47.4423 / Avg. bwd time: 4.1639 / Avg. batch time: 1539.4255 (ms) / GPU bubble ratio: 73.18%
[rank3]:2025-10-24 10:16:39,545 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-24 10:16:40,288 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 10:16:40,329 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-24 10:16:40,328 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 10:17:14,304 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-24 10:17:20,213 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,771  tflops: 21.66  mfu: 6.94%
[rank2]:2025-10-24 10:17:20,212 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,771  tflops: 21.66  mfu: 6.94%
[rank3]:2025-10-24 10:17:20,213 - INFO -  step: 1900  loss:  0.9395  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,771  tflops: 21.66  mfu: 6.94%
[rank0]:2025-10-24 10:17:20,213 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,771  tflops: 21.66  mfu: 6.94%
[rank0]:2025-10-24 10:17:20,301 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251024_1017_stage0_step1900.svg
[rank1]:2025-10-24 10:17:20,301 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251024_1017_stage1_step1900.svg
[rank2]:2025-10-24 10:17:20,302 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251024_1017_stage2_step1900.svg
[rank3]:2025-10-24 10:17:20,439 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/pipeline_schedule/251024_1017_real_step1900_rank3.svg
[rank3]:> Batch Time: 1381.49 ms, GPU Bubble Ratio: 72.18%, 43.70%, 62.96%, 14.02%
[rank3]:2025-10-24 10:17:20,506 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251024_1017_stage3_step1900.svg
[rank2]:2025-10-24 10:17:21,858 - INFO - Avg. fwd time: 35.0635 / Avg. bwd time: 31.2014 / Avg. batch time: 1368.0043 (ms) / GPU bubble ratio: 61.25%
[rank3]:2025-10-24 10:17:21,814 - INFO - Avg. fwd time: 76.4075 / Avg. bwd time: 75.5797 / Avg. batch time: 1266.1691 (ms) / GPU bubble ratio: 3.97%
[rank1]:2025-10-24 10:17:21,909 - INFO - Avg. fwd time: 55.8626 / Avg. bwd time: 59.0293 / Avg. batch time: 1496.8869 (ms) / GPU bubble ratio: 38.60%
[rank0]:2025-10-24 10:17:21,922 - INFO - Avg. fwd time: 47.4435 / Avg. bwd time: 4.1201 / Avg. batch time: 1538.3111 (ms) / GPU bubble ratio: 73.18%
[rank3]:2025-10-24 10:19:18,570 - INFO -  step: 1920  loss:  1.0062  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,769  tflops: 21.64  mfu: 6.94%
[rank0]:2025-10-24 10:19:18,569 - INFO -  step: 1920  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,769  tflops: 21.64  mfu: 6.94%
[rank1]:2025-10-24 10:19:18,569 - INFO -  step: 1920  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,769  tflops: 21.64  mfu: 6.94%
[rank2]:2025-10-24 10:19:18,568 - INFO -  step: 1920  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,769  tflops: 21.64  mfu: 6.94%
[rank3]:2025-10-24 10:19:19,997 - INFO - Avg. fwd time: 76.4064 / Avg. bwd time: 75.5461 / Avg. batch time: 1265.8966 (ms) / GPU bubble ratio: 3.97%
[rank1]:2025-10-24 10:19:20,094 - INFO - Avg. fwd time: 55.8621 / Avg. bwd time: 58.8267 / Avg. batch time: 1495.8121 (ms) / GPU bubble ratio: 38.66%
[rank2]:2025-10-24 10:19:20,042 - INFO - Avg. fwd time: 35.0648 / Avg. bwd time: 31.1845 / Avg. batch time: 1367.3688 (ms) / GPU bubble ratio: 61.24%
[rank0]:2025-10-24 10:19:20,109 - INFO - Avg. fwd time: 47.4422 / Avg. bwd time: 4.0772 / Avg. batch time: 1537.1922 (ms) / GPU bubble ratio: 73.19%
[rank3]:2025-10-24 10:21:17,024 - INFO -  step: 1940  loss:  1.0128  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,766  tflops: 21.63  mfu: 6.93%
[rank0]:2025-10-24 10:21:17,024 - INFO -  step: 1940  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,766  tflops: 21.63  mfu: 6.93%
[rank1]:2025-10-24 10:21:17,024 - INFO -  step: 1940  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,766  tflops: 21.63  mfu: 6.93%
[rank2]:2025-10-24 10:21:17,023 - INFO -  step: 1940  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,766  tflops: 21.63  mfu: 6.93%
[rank2]:2025-10-24 10:21:18,477 - INFO - Avg. fwd time: 35.0637 / Avg. bwd time: 31.1679 / Avg. batch time: 1366.7747 (ms) / GPU bubble ratio: 61.23%
[rank3]:2025-10-24 10:21:18,432 - INFO - Avg. fwd time: 76.4102 / Avg. bwd time: 75.5132 / Avg. batch time: 1265.6587 (ms) / GPU bubble ratio: 3.97%
[rank1]:2025-10-24 10:21:18,532 - INFO - Avg. fwd time: 55.8572 / Avg. bwd time: 58.6276 / Avg. batch time: 1494.7883 (ms) / GPU bubble ratio: 38.73%
[rank0]:2025-10-24 10:21:18,546 - INFO - Avg. fwd time: 47.4437 / Avg. bwd time: 4.0352 / Avg. batch time: 1536.1262 (ms) / GPU bubble ratio: 73.19%
[rank0]:2025-10-24 10:22:10,260 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-24 10:23:15,376 - INFO -  step: 1960  loss:  0.9840  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,769  tflops: 21.64  mfu: 6.94%
[rank0]:2025-10-24 10:23:15,375 - INFO -  step: 1960  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,769  tflops: 21.64  mfu: 6.94%
[rank1]:2025-10-24 10:23:15,375 - INFO -  step: 1960  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,769  tflops: 21.64  mfu: 6.94%
[rank2]:2025-10-24 10:23:15,374 - INFO -  step: 1960  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,769  tflops: 21.64  mfu: 6.94%
[rank3]:2025-10-24 10:23:16,782 - INFO - Avg. fwd time: 76.4103 / Avg. bwd time: 75.4822 / Avg. batch time: 1265.4131 (ms) / GPU bubble ratio: 3.97%
[rank2]:2025-10-24 10:23:16,827 - INFO - Avg. fwd time: 35.0634 / Avg. bwd time: 31.1518 / Avg. batch time: 1366.1778 (ms) / GPU bubble ratio: 61.23%
[rank0]:2025-10-24 10:23:16,894 - INFO - Avg. fwd time: 47.4456 / Avg. bwd time: 3.9940 / Avg. batch time: 1535.0723 (ms) / GPU bubble ratio: 73.19%
[rank1]:2025-10-24 10:23:16,879 - INFO - Avg. fwd time: 55.8588 / Avg. bwd time: 58.4323 / Avg. batch time: 1493.7745 (ms) / GPU bubble ratio: 38.79%
[rank3]:2025-10-24 10:24:46,466 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-24 10:24:47,250 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-24 10:24:47,210 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 10:24:47,254 - WARNING - Dataset alpaca is being re-looped
[rank3]:2025-10-24 10:25:13,855 - INFO -  step: 1980  loss:  0.9426  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,766  tflops: 21.62  mfu: 6.93%
[rank0]:2025-10-24 10:25:13,855 - INFO -  step: 1980  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,766  tflops: 21.62  mfu: 6.93%
[rank1]:2025-10-24 10:25:13,854 - INFO -  step: 1980  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,766  tflops: 21.62  mfu: 6.93%
[rank2]:2025-10-24 10:25:13,854 - INFO -  step: 1980  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,766  tflops: 21.62  mfu: 6.93%
[rank3]:2025-10-24 10:25:15,281 - INFO - Avg. fwd time: 76.4153 / Avg. bwd time: 75.4503 / Avg. batch time: 1265.1972 (ms) / GPU bubble ratio: 3.97%
[rank1]:2025-10-24 10:25:15,382 - INFO - Avg. fwd time: 55.8544 / Avg. bwd time: 58.2416 / Avg. batch time: 1492.8043 (ms) / GPU bubble ratio: 38.86%
[rank2]:2025-10-24 10:25:15,326 - INFO - Avg. fwd time: 35.0627 / Avg. bwd time: 31.1360 / Avg. batch time: 1365.6187 (ms) / GPU bubble ratio: 61.22%
[rank0]:2025-10-24 10:25:15,397 - INFO - Avg. fwd time: 47.4462 / Avg. bwd time: 3.9537 / Avg. batch time: 1534.0623 (ms) / GPU bubble ratio: 73.20%
[rank0]:2025-10-24 10:27:06,580 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-24 10:27:12,497 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,762  tflops: 21.59  mfu: 6.92%
[rank0]:2025-10-24 10:27:12,498 - INFO -  final step: 2000  loss: -4.0000  grad_norm:  0.0000  tps: 2,615  tflops: 20.44  mfu: 6.51%
[rank0]:2025-10-24 10:27:12,498 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-24 10:27:12,500 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2000.
[rank3]:2025-10-24 10:27:12,498 - INFO -  step: 2000  loss:  1.0156  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,762  tflops: 21.59  mfu: 6.92%
[rank3]:2025-10-24 10:27:12,499 - INFO -  final step: 2000  loss:  1.0156  grad_norm:  0.0000  tps: 2,616  tflops: 20.45  mfu: 6.51%
[rank3]:2025-10-24 10:27:12,499 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-24 10:27:12,503 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2000.
[rank1]:2025-10-24 10:27:12,497 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,762  tflops: 21.59  mfu: 6.92%
[rank1]:2025-10-24 10:27:12,497 - INFO -  final step: 2000  loss: -4.0000  grad_norm:  0.0000  tps: 2,615  tflops: 20.44  mfu: 6.51%
[rank1]:2025-10-24 10:27:12,497 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-24 10:27:12,499 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2000.
[rank2]:2025-10-24 10:27:12,496 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,762  tflops: 21.59  mfu: 6.92%
[rank2]:2025-10-24 10:27:12,496 - INFO -  final step: 2000  loss: -4.0000  grad_norm:  0.0000  tps: 2,615  tflops: 20.44  mfu: 6.51%
[rank2]:2025-10-24 10:27:12,497 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-24 10:27:12,498 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2000.
[rank0]:2025-10-24 10:27:14,600 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-24 10:27:14,696 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251024_1027_stage0_final2000.svg
[rank1]:2025-10-24 10:27:14,694 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251024_1027_stage1_final2000.svg
[rank2]:2025-10-24 10:27:14,695 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251024_1027_stage2_final2000.svg
[rank3]:2025-10-24 10:27:14,829 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/pipeline_schedule/251024_1027_real_final2000_rank3.svg
[rank3]:> Batch Time: 1381.60 ms, GPU Bubble Ratio: 72.18%, 43.82%, 62.96%, 14.01%
[rank0]:2025-10-24 10:27:14,914 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/frozen_params_histogram/251024_1027_rank0_stage0.svg
[rank0]:	> Counts Sum: 1953420, Total Sum: 2243680 (87.06%), Ratio(%) per element: [86.87, 86.97, 87.03, 87.0, 87.0, 87.0, 86.93, 87.0, 87.07, 87.03, 87.07, 87.0, 87.07, 87.03, 87.0, 87.0, 87.03, 87.07, 87.07, 87.07, 87.13, 87.03, 87.13, 87.13, 87.13, 87.07, 87.1, 87.07, 87.03, 87.1, 87.1, 87.1, 87.17, 87.13, 87.13, 87.13, 87.17]
[rank0]:2025-10-24 10:27:14,914 - INFO - Sleeping 2 seconds for other ranks to complete
[rank1]:2025-10-24 10:27:14,895 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/frozen_params_histogram/251024_1027_rank1_stage1.svg
[rank1]:	> Counts Sum: 2483560, Total Sum: 2728800 (91.01%), Ratio(%) per element: [90.89, 90.99, 91.06, 90.86, 91.16, 91.02, 91.02, 90.96, 91.16, 90.83, 91.09, 90.99, 90.89, 90.99, 91.12, 90.99, 91.02, 91.16, 91.02, 91.06, 91.09, 91.09, 90.86, 91.02, 90.86, 90.96, 91.16, 90.96, 91.12, 90.93, 90.99, 90.86, 91.09, 91.02, 91.02, 91.02, 90.99, 90.99, 90.96, 91.19, 91.06, 90.86, 91.16, 90.89, 90.93]
[rank1]:2025-10-24 10:27:14,896 - INFO - Destroying the purge thread.
[rank2]:2025-10-24 10:27:14,907 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/frozen_params_histogram/251024_1027_rank2_stage2.svg
[rank2]:	> Counts Sum: 1902960, Total Sum: 2183040 (87.17%), Ratio(%) per element: [87.17, 87.17, 87.17, 87.17, 87.17, 87.17, 87.17, 87.17, 87.17, 87.17, 87.17, 87.17, 87.17, 87.17, 87.17, 87.17, 87.17, 87.17, 87.17, 87.17, 87.17, 87.17, 87.17, 87.17, 87.17, 87.17, 87.17, 87.17, 87.17, 87.17, 87.17, 87.17, 87.17, 87.17, 87.17, 87.17]
[rank2]:2025-10-24 10:27:14,907 - INFO - Destroying the purge thread.
[rank3]:2025-10-24 10:27:15,054 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/pipeline_schedule/251024_1027_thry_final2000_rank3.svg
[rank3]:> Batch Time: 1777.23 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:2025-10-24 10:27:15,122 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251024_1027_stage3_final2000.svg
[rank2]:2025-10-24 10:27:15,135 - INFO - Process group destroyed
[rank1]:2025-10-24 10:27:15,251 - INFO - Process group destroyed
[rank3]:2025-10-24 10:27:15,311 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1023_GPipe_fullrand7_dm1/frozen_params_histogram/251024_1027_rank3_stage3.svg
[rank3]:	> Counts Sum: 320, Total Sum: 1758560 (0.02%), Ratio(%) per element: [0.0, 0.03, 0.09, 0.0, 0.06, 0.0, 0.03, 0.03, 0.0, 0.03, 0.0, 0.0, 0.09, 0.0, 0.0, 0.0, 0.03, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.03, 0.0, 0.03, 0.03]
[rank3]:2025-10-24 10:27:15,312 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading history steps 99-100, summary, console lines 508-519
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) ‚ñÅ
[rank3]:wandb:               final/avg_loss ‚ñÅ
[rank3]:wandb:             final/avg_mfu(%) ‚ñÅ
[rank3]:wandb:             final/avg_tflops ‚ñÅ
[rank3]:wandb:    final/avg_throughput(tps) ‚ñÅ
[rank3]:wandb:              final/grad_norm ‚ñÅ
[rank3]:wandb:               final/max_loss ‚ñÅ
[rank3]:wandb:                    grad_norm ‚ñà‚ñÖ‚ñÇ‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
[rank3]:wandb: loss_metrics/global_avg_loss ‚ñà‚ñÜ‚ñÖ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÉ‚ñÑ‚ñÑ‚ñÉ‚ñÑ‚ñÑ‚ñÉ‚ñÉ‚ñÉ‚ñÇ‚ñÇ‚ñÉ‚ñÇ‚ñÉ‚ñÅ‚ñÇ‚ñÇ‚ñÇ‚ñÉ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÅ‚ñÉ‚ñÇ‚ñÇ‚ñÇ‚ñÇ
[rank3]:wandb: loss_metrics/global_max_loss ‚ñà‚ñÑ‚ñÉ‚ñÉ‚ñÉ‚ñÇ‚ñÉ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÉ‚ñÇ‚ñÉ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÅ‚ñÅ‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÇ‚ñÇ‚ñÅ‚ñÇ‚ñÅ‚ñÇ‚ñÅ
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 6.26399
[rank3]:wandb:               final/avg_loss 1.01558
[rank3]:wandb:             final/avg_mfu(%) 6.51239
[rank3]:wandb:             final/avg_tflops 20.44744
[rank3]:wandb:    final/avg_throughput(tps) 2615.58478
[rank3]:wandb:              final/grad_norm 0
[rank3]:wandb:               final/max_loss 1.01558
[rank3]:wandb:                    grad_norm 0
[rank3]:wandb: loss_metrics/global_avg_loss 1.01558
[rank3]:wandb: loss_metrics/global_max_loss 1.01558
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: üöÄ View run 1023_GPipe_fullrand7_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/ohluxiu7
[rank3]:wandb: ‚≠êÔ∏è View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1023_GPipe_fullrand7_dm1/20251024-0656/wandb/run-20251024_065617-ohluxiu7/logs
[rank0]:2025-10-24 10:27:16,915 - INFO - Training completed
[rank0]:2025-10-24 10:27:16,915 - INFO - Destroying the purge thread.
[rank3]:2025-10-24 10:27:16,915 - INFO - Process group destroyed
[rank0]:2025-10-24 10:27:16,985 - INFO - Process group destroyed
[rank0]:Stage 0: Modules to keep: {'layers.3', 'layers.0', 'layers.1', 'layers.2', 'tok_embeddings'}
[rank2]:Stage 2: Modules to keep: {'layers.9', 'layers.11', 'layers.12', 'layers.10'}
[rank1]:Stage 1: Modules to keep: {'layers.4', 'layers.7', 'layers.6', 'layers.8', 'layers.5'}
[rank3]:Stage 3: Modules to keep: {'layers.14', 'layers.15', 'output', 'layers.13', 'norm'}
[rank3]:----- TimelyFreeze‚è∞ Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1022_llama1binstruct/config.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1023_GPipe_fullrand7_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: profile_trace/1023_GPipe_fullrand7_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: memory_snapshot/1023_GPipe_fullrand7_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 20
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: tb/1023_GPipe_fullrand7_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- pplog_freq: 80
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1023_GPipe_fullrand7_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B-Instruct
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 1e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: alpaca
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 2000
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: GPipe
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- folder: checkpoint/1023_GPipe_fullrand7_dm1
[rank3]:		- interval: 500
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B-Instruct/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: comm_traces/1023_GPipe_fullrand7_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 8
[rank3]:		- seq_len: 2048
[rank3]:		- freq: 10
[rank3]:		- steps: -1
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: fullrand7
[rank3]:		- phase_unit: 10
[rank3]:		- stability_check_freq: 5
[rank3]:		- aggressiveness: 0
[rank3]:
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
