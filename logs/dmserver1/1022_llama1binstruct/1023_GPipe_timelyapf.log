
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 10. 24. (ê¸ˆ) 18:46:02 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 3,4,5,6
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1022_llama1binstruct/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1022_llama1binstruct/1023_GPipe_timelyapf.log
âœ”ï¸Main Table Experiment
âœ”ï¸Running with timelyapf x GPipe ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1022_llama1binstruct/config.toml --job.description="Main Table Experiment" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=timelyapf
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank1]:2025-10-24 18:46:08,170 - INFO - Starting job: "Main Table Experiment"
[rank2]:2025-10-24 18:46:08,127 - INFO - Starting job: "Main Table Experiment"
[rank3]:2025-10-24 18:46:08,197 - INFO - Starting job: "Main Table Experiment"
[rank0]:2025-10-24 18:46:08,383 - INFO - Starting job: "Main Table Experiment"
[rank2]:2025-10-24 18:46:08,314 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-10-24 18:46:08,316 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-10-24 18:46:08,479 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-10-24 18:46:08,481 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-10-24 18:46:08,461 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-10-24 18:46:08,463 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-24 18:46:08,586 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-10-24 18:46:08,589 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-24 18:46:08,592 - INFO - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-10-24 18:46:08,994 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-10-24 18:46:09,412 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank1]:2025-10-24 18:46:12,301 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-10-24 18:46:12,343 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-10-24 18:46:12,369 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-10-24 18:46:12,369 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-10-24 18:46:12,378 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank1]:2025-10-24 18:46:12,545 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-10-24 18:46:12,545 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-10-24 18:46:12,545 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank0]:2025-10-24 18:46:12,523 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-10-24 18:46:12,562 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-10-24 18:46:12,563 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-10-24 18:46:12,589 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-10-24 18:46:12,589 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank2]:2025-10-24 18:46:12,654 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-10-24 18:46:12,693 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank0]:2025-10-24 18:46:12,762 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-10-24 18:46:12,762 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-10-24 18:46:12,763 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank2]:2025-10-24 18:46:12,720 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-10-24 18:46:12,721 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank2]:2025-10-24 18:46:12,896 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-10-24 18:46:12,896 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-10-24 18:46:12,897 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run 4c7ctu53
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1023_GPipe_timelyapf_dm1/20251024-1846/wandb/run-20251024_184613-4c7ctu53
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1023_GPipe_timelyapf_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/4c7ctu53
[rank3]:2025-10-24 18:46:14,604 - INFO - WandB logging enabled
[rank3]:2025-10-24 18:46:14,605 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-10-24 18:46:14,643 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-10-24 18:46:14,671 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-10-24 18:46:14,671 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank3]:2025-10-24 18:46:14,853 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-10-24 18:46:14,854 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-10-24 18:46:14,854 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank0]:2025-10-24 18:46:14,868 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1023_GPipe_timelyapf_dm1
[rank0]:2025-10-24 18:46:14,868 - WARNING - Mixed precision training with TP or PP is only supported when FSDP/HSDP/CP is enabled.
[rank0]:2025-10-24 18:46:14,868 - INFO - Mixed precision training is disabled
[rank0]:2025-10-24 18:46:14,868 - INFO - Trainer is initialized with local batch size 16, global batch size 64, gradient accumulation steps 4, sequence length 1024, total steps 2000 (warmup 100)
[rank0]:2025-10-24 18:46:14,869 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B-Instruct/original_dcp.
[rank0]:2025-10-24 18:46:17,663 - INFO - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-10-24 18:46:17,663 - INFO - Finished loading the checkpoint in 2.79 seconds.
[rank0]:2025-10-24 18:46:17,663 - INFO - Training starts at step 1
[rank0]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/autograd/graph.py:849: UserWarning: Attempting to run cuBLAS, but there was no current CUDA context! Attempting to set the primary context... (Triggered internally at /pytorch/aten/src/ATen/cuda/CublasHandlePool.cpp:270.)
[rank0]:  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
[rank3]:2025-10-24 18:46:26,757 - INFO -  step:  1  loss:  1.7854  grad_norm:  3.4827  memory: 35.59GiB(74.92%)  tps: 1,353  tflops: 10.58  mfu: 3.39%
[rank3]:2025-10-24 18:46:26,758 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-10-24 18:46:26,746 - INFO -  step:  1  loss: -4.0000  grad_norm:  3.4827  memory: 17.77GiB(37.40%)  tps: 1,138  tflops: 8.89  mfu: 2.85%
[rank1]:2025-10-24 18:46:26,746 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-10-24 18:46:26,745 - INFO -  step:  1  loss: -4.0000  grad_norm:  3.4827  memory: 14.29GiB(30.07%)  tps: 1,166  tflops: 9.11  mfu: 2.92%
[rank2]:2025-10-24 18:46:26,745 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-10-24 18:46:26,782 - INFO -  step:  1  loss: -4.0000  grad_norm:  3.4827  memory: 17.10GiB(35.99%)  tps: 1,152  tflops: 9.01  mfu: 2.89%
[rank0]:2025-10-24 18:46:26,783 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-24 18:46:41,033 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-24 18:46:41,034 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-24 18:46:41,035 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-24 18:46:41,035 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-24 18:46:41,035 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-24 18:46:41,036 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-24 18:46:41,036 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-24 18:46:41,036 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-24 18:46:41,037 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-24 18:46:41,037 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-24 18:46:41,037 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-24 18:46:41,037 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-24 18:46:41,038 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-24 18:46:41,038 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-24 18:46:41,038 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-24 18:46:41,038 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-24 18:46:41,095 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-24 18:46:41,095 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-24 18:46:41,095 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-24 18:46:41,095 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-24 18:46:41,096 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-24 18:46:41,096 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-24 18:46:41,096 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-24 18:46:41,096 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-24 18:46:41,096 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-24 18:46:41,096 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-24 18:46:41,096 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-24 18:46:41,096 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-24 18:46:41,096 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-24 18:46:41,096 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-24 18:46:41,096 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-24 18:46:41,096 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-24 18:46:41,186 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-24 18:46:41,186 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-24 18:46:41,186 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-24 18:46:41,186 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-24 18:46:41,186 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-24 18:46:41,186 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-24 18:46:41,186 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-24 18:46:41,186 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-24 18:46:41,186 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-24 18:46:41,186 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-24 18:46:41,187 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-24 18:46:41,187 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-24 18:46:41,187 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-24 18:46:41,187 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-24 18:46:41,187 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-24 18:46:41,187 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-24 18:46:41,253 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-24 18:46:41,253 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-24 18:46:41,253 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-24 18:46:41,253 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-24 18:46:41,253 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-24 18:46:41,253 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-24 18:46:41,253 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-24 18:46:41,253 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-24 18:46:41,253 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-24 18:46:41,253 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-24 18:46:41,254 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-24 18:46:41,254 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-24 18:46:41,254 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-24 18:46:41,254 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-24 18:46:41,254 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-24 18:46:41,254 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-24 18:49:06,217 - INFO -  step: 20  loss:  1.3862  grad_norm:  1.4899  memory: 38.93GiB(81.95%)  tps: 1,952  tflops: 15.26  mfu: 4.89%
[rank2]:2025-10-24 18:49:06,204 - INFO -  step: 20  loss: -4.0000  grad_norm:  1.4899  memory: 16.10GiB(33.90%)  tps: 1,952  tflops: 15.26  mfu: 4.89%
[rank1]:2025-10-24 18:49:06,208 - INFO -  step: 20  loss: -4.0000  grad_norm:  1.4899  memory: 20.03GiB(42.17%)  tps: 1,952  tflops: 15.26  mfu: 4.89%
[rank0]:2025-10-24 18:49:06,221 - INFO -  step: 20  loss: -4.0000  grad_norm:  1.4899  memory: 20.89GiB(43.97%)  tps: 1,952  tflops: 15.26  mfu: 4.89%
[rank3]:2025-10-24 18:49:08,131 - INFO - Avg. fwd time: 75.1259 / Avg. bwd time: 132.7597 / Avg. batch time: 1736.5713 (ms) / GPU bubble ratio: 4.23%
[rank2]:2025-10-24 18:49:08,192 - INFO - Avg. fwd time: 34.2708 / Avg. bwd time: 54.3462 / Avg. batch time: 1828.0278 (ms) / GPU bubble ratio: 61.22%
[rank1]:2025-10-24 18:49:08,275 - INFO - Avg. fwd time: 53.7846 / Avg. bwd time: 74.1250 / Avg. batch time: 1950.6461 (ms) / GPU bubble ratio: 47.54%
[rank0]:2025-10-24 18:49:08,338 - INFO - Avg. fwd time: 48.5032 / Avg. bwd time: 60.4988 / Avg. batch time: 2050.6338 (ms) / GPU bubble ratio: 57.48%
[rank1]:2025-10-24 18:51:55,533 - INFO -  step: 40  loss: -4.0000  grad_norm:  2.1309  memory: 20.03GiB(42.17%)  tps: 1,935  tflops: 15.13  mfu: 4.85%
[rank3]:2025-10-24 18:51:55,537 - INFO -  step: 40  loss:  1.2757  grad_norm:  2.1309  memory: 38.93GiB(81.95%)  tps: 1,935  tflops: 15.13  mfu: 4.85%
[rank2]:2025-10-24 18:51:55,525 - INFO -  step: 40  loss: -4.0000  grad_norm:  2.1309  memory: 16.10GiB(33.90%)  tps: 1,935  tflops: 15.13  mfu: 4.85%
[rank0]:2025-10-24 18:51:55,544 - INFO -  step: 40  loss: -4.0000  grad_norm:  2.1309  memory: 20.89GiB(43.97%)  tps: 1,935  tflops: 15.13  mfu: 4.85%
[rank3]:2025-10-24 18:51:57,442 - INFO - Avg. fwd time: 76.0083 / Avg. bwd time: 134.4299 / Avg. batch time: 1745.1332 (ms) / GPU bubble ratio: 3.53%
[rank2]:2025-10-24 18:51:57,499 - INFO - Avg. fwd time: 34.6771 / Avg. bwd time: 54.7564 / Avg. batch time: 1836.9945 (ms) / GPU bubble ratio: 61.05%
[rank1]:2025-10-24 18:51:57,583 - INFO - Avg. fwd time: 54.5256 / Avg. bwd time: 74.6767 / Avg. batch time: 1960.4616 (ms) / GPU bubble ratio: 47.28%
[rank0]:2025-10-24 18:51:57,645 - INFO - Avg. fwd time: 48.3474 / Avg. bwd time: 61.0760 / Avg. batch time: 2060.4662 (ms) / GPU bubble ratio: 57.52%
[rank0]:2025-10-24 18:53:11,310 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-24 18:54:43,933 - INFO -  step: 60  loss: -4.0000  grad_norm:  0.5366  memory: 20.03GiB(42.17%)  tps: 1,946  tflops: 15.21  mfu: 4.88%
[rank2]:2025-10-24 18:54:43,929 - INFO -  step: 60  loss: -4.0000  grad_norm:  0.5366  memory: 16.10GiB(33.90%)  tps: 1,946  tflops: 15.21  mfu: 4.88%
[rank3]:2025-10-24 18:54:43,942 - INFO -  step: 60  loss:  1.2100  grad_norm:  0.5366  memory: 38.93GiB(81.95%)  tps: 1,946  tflops: 15.21  mfu: 4.88%
[rank0]:2025-10-24 18:54:43,949 - INFO -  step: 60  loss: -4.0000  grad_norm:  0.5366  memory: 20.89GiB(43.97%)  tps: 1,946  tflops: 15.21  mfu: 4.88%
[rank3]:2025-10-24 18:54:45,859 - INFO - Avg. fwd time: 75.9253 / Avg. bwd time: 134.8329 / Avg. batch time: 1744.5441 (ms) / GPU bubble ratio: 3.35%
[rank2]:2025-10-24 18:54:45,915 - INFO - Avg. fwd time: 34.7160 / Avg. bwd time: 54.8571 / Avg. batch time: 1836.2724 (ms) / GPU bubble ratio: 60.98%
[rank1]:2025-10-24 18:54:45,994 - INFO - Avg. fwd time: 55.0251 / Avg. bwd time: 74.6442 / Avg. batch time: 1959.7626 (ms) / GPU bubble ratio: 47.07%
[rank0]:2025-10-24 18:54:46,058 - INFO - Avg. fwd time: 48.2781 / Avg. bwd time: 61.2437 / Avg. batch time: 2059.8832 (ms) / GPU bubble ratio: 57.46%
[rank0]:2025-10-24 18:57:32,158 - INFO -  step: 80  loss: -4.0000  grad_norm:  0.5012  memory: 20.89GiB(43.97%)  tps: 1,948  tflops: 15.23  mfu: 4.88%
[rank1]:2025-10-24 18:57:32,146 - INFO -  step: 80  loss: -4.0000  grad_norm:  0.5012  memory: 20.03GiB(42.17%)  tps: 1,948  tflops: 15.23  mfu: 4.88%
[rank2]:2025-10-24 18:57:32,143 - INFO -  step: 80  loss: -4.0000  grad_norm:  0.5012  memory: 16.10GiB(33.90%)  tps: 1,948  tflops: 15.23  mfu: 4.88%
[rank3]:2025-10-24 18:57:32,155 - INFO -  step: 80  loss:  1.1799  grad_norm:  0.5012  memory: 38.93GiB(81.95%)  tps: 1,948  tflops: 15.23  mfu: 4.88%
[rank2]:2025-10-24 18:57:34,116 - INFO - Avg. fwd time: 34.7193 / Avg. bwd time: 54.8706 / Avg. batch time: 1835.1688 (ms) / GPU bubble ratio: 60.95%
[rank3]:2025-10-24 18:57:34,058 - INFO - Avg. fwd time: 75.9037 / Avg. bwd time: 134.9347 / Avg. batch time: 1743.4981 (ms) / GPU bubble ratio: 3.26%
[rank1]:2025-10-24 18:57:34,189 - INFO - Avg. fwd time: 55.2255 / Avg. bwd time: 74.6636 / Avg. batch time: 1958.8294 (ms) / GPU bubble ratio: 46.95%
[rank0]:2025-10-24 18:57:34,252 - INFO - Avg. fwd time: 48.2058 / Avg. bwd time: 61.2311 / Avg. batch time: 2058.7406 (ms) / GPU bubble ratio: 57.47%
[rank3]:2025-10-24 18:57:50,204 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-24 18:57:50,938 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 18:57:51,080 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-24 18:57:51,019 - WARNING - Dataset alpaca is being re-looped
[rank3]:2025-10-24 18:58:56,455 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/pipeline_schedule/251024_1858_real_warmupend90_rank3.svg
[rank3]:> Batch Time: 2005.72 ms, GPU Bubble Ratio: 56.37%, 47.54%, 64.55%, 15.59%
[rank3]:2025-10-24 18:59:37,601 - INFO - [Step 95] ã€°ï¸ Monitoring Upperbound
[rank0]:2025-10-24 19:00:12,719 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-24 19:00:20,316 - INFO - [Step 100] âœ”ï¸  Setting Upperbound
[rank0]:2025-10-24 19:00:21,168 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.4903  memory: 20.89GiB(43.97%)  tps: 1,939  tflops: 15.16  mfu: 4.86%
[rank1]:2025-10-24 19:00:21,168 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.4903  memory: 20.03GiB(42.17%)  tps: 1,939  tflops: 15.16  mfu: 4.86%
[rank2]:2025-10-24 19:00:21,168 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.4903  memory: 16.10GiB(33.90%)  tps: 1,939  tflops: 15.16  mfu: 4.86%
[rank3]:2025-10-24 19:00:21,165 - INFO - [Step 100] ã€°ï¸ Monitoring Lowerbound
[rank3]:2025-10-24 19:00:23,750 - INFO -  step: 100  loss:  1.1786  grad_norm:  0.4903  memory: 38.93GiB(81.95%)  tps: 1,910  tflops: 14.93  mfu: 4.78%
[rank1]:2025-10-24 19:00:23,825 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251024_1900_stage1_step100.svg
[rank2]:2025-10-24 19:00:23,825 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251024_1900_stage2_step100.svg
[rank0]:2025-10-24 19:00:23,825 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251024_1900_stage0_step100.svg
[rank0]:2025-10-24 19:00:23,906 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-24 19:00:23,916 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-24 19:00:23,906 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-24 19:00:23,925 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-24 19:00:23,924 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-24 19:00:23,935 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-24 19:00:23,974 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-24 19:00:23,990 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/pipeline_schedule/251024_1900_real_step100_rank3.svg
[rank3]:> Batch Time: 2005.34 ms, GPU Bubble Ratio: 56.40%, 47.58%, 64.56%, 15.52%
[rank3]:2025-10-24 19:00:24,048 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251024_1900_stage3_step100.svg
[rank0]:2025-10-24 19:00:24,023 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-24 19:00:24,104 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-24 19:00:24,119 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-24 19:00:24,134 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-24 19:00:24,144 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-24 19:00:24,153 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-24 19:00:24,134 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-24 19:00:24,179 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-24 19:00:24,245 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-24 19:00:24,259 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-24 19:00:24,237 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-24 19:00:24,341 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-24 19:00:24,415 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-24 19:00:24,432 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-24 19:00:24,514 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-24 19:00:24,590 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-24 19:00:24,608 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-24 19:00:24,860 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-24 19:00:24,926 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-24 19:00:24,998 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-24 19:00:25,059 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-24 19:00:25,064 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-24 19:00:25,192 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-24 19:00:25,128 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-24 19:00:25,262 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-24 19:00:25,851 - INFO - Avg. fwd time: 34.7174 / Avg. bwd time: 54.9288 / Avg. batch time: 1836.6629 (ms) / GPU bubble ratio: 60.95%
[rank3]:2025-10-24 19:00:25,798 - INFO - Avg. fwd time: 75.9864 / Avg. bwd time: 134.9887 / Avg. batch time: 1743.0770 (ms) / GPU bubble ratio: 3.17%
[rank1]:2025-10-24 19:00:25,917 - INFO - Avg. fwd time: 55.1429 / Avg. bwd time: 74.7012 / Avg. batch time: 1960.2062 (ms) / GPU bubble ratio: 47.01%
[rank0]:2025-10-24 19:00:25,972 - INFO - Avg. fwd time: 48.1109 / Avg. bwd time: 61.1383 / Avg. batch time: 2059.9940 (ms) / GPU bubble ratio: 57.57%
[rank3]:2025-10-24 19:00:53,273 - INFO - [Step 105] âœ”ï¸  Setting Lowerbound
[rank3]:2025-10-24 19:00:54,273 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/pipeline_schedule/251024_1900_max_batch_time.svg
[rank3]:> Batch Time: 2012.25 ms, GPU Bubble Ratio: 56.80%, 48.10%, 64.64%, 15.07%
[rank3]:2025-10-24 19:00:54,486 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/pipeline_schedule/251024_1900_min_batch_time.svg
[rank3]:> Batch Time: 1383.91 ms, GPU Bubble Ratio: 72.29%, 45.20%, 62.87%, 13.06%
[rank3]:2025-10-24 19:00:54,729 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/pipeline_schedule/251024_1900_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 1383.91 ms, GPU Bubble Ratio: 44.08%, 30.50%, 50.55%, 13.06%
[rank3]:2025-10-24 19:00:54,729 - INFO - 	> Batch Time: 1383.91 ms (Average Freeze Ratio: 0.40, Time Reduction Rate: 0.31)
[rank1]:2025-10-24 19:02:34,886 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.12/0.12, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.33/0.33, [MB5] 0.09/0.09, [MB6] 0.80/0.80, [MB7] 1.00/1.00
[rank1]:2025-10-24 19:02:34,886 - INFO -  step: 120  loss: -4.0000  grad_norm:  0.1446  memory: 20.03GiB(42.17%)  tps: 2,451  tflops: 19.16  mfu: 6.14%
[rank2]:2025-10-24 19:02:34,885 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-24 19:02:34,885 - INFO -  step: 120  loss: -4.0000  grad_norm:  0.1446  memory: 16.10GiB(33.90%)  tps: 2,451  tflops: 19.16  mfu: 6.14%
[rank0]:2025-10-24 19:02:34,886 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.58/0.58, [MB7] 1.00/1.00
[rank0]:2025-10-24 19:02:34,887 - INFO -  step: 120  loss: -4.0000  grad_norm:  0.1446  memory: 20.89GiB(43.97%)  tps: 2,451  tflops: 19.16  mfu: 6.14%
[rank3]:2025-10-24 19:02:37,305 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-24 19:02:37,309 - INFO -  step: 120  loss:  1.1303  grad_norm:  0.1446  memory: 38.93GiB(81.95%)  tps: 2,453  tflops: 19.18  mfu: 6.15%
[rank3]:2025-10-24 19:02:38,660 - INFO - Avg. fwd time: 76.1310 / Avg. bwd time: 125.2381 / Avg. batch time: 1665.1069 (ms) / GPU bubble ratio: 3.25%
[rank2]:2025-10-24 19:02:38,696 - INFO - Avg. fwd time: 34.7640 / Avg. bwd time: 51.2065 / Avg. batch time: 1775.5927 (ms) / GPU bubble ratio: 61.27%
[rank1]:2025-10-24 19:02:38,745 - INFO - Avg. fwd time: 55.1186 / Avg. bwd time: 69.4474 / Avg. batch time: 1893.7395 (ms) / GPU bubble ratio: 47.38%
[rank0]:2025-10-24 19:02:38,782 - INFO - Avg. fwd time: 48.1270 / Avg. bwd time: 54.0299 / Avg. batch time: 1986.2479 (ms) / GPU bubble ratio: 58.85%
[rank1]:2025-10-24 19:04:42,254 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251024_1904_rank1_trend_line.svg
[rank1]:2025-10-24 19:04:42,260 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-10-24 19:04:42,261 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-10-24 19:04:42,262 - INFO -  step: 140  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,573  tflops: 20.11  mfu: 6.45%
[rank3]:2025-10-24 19:04:42,231 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251024_1904_rank3_trend_line.svg
[rank2]:2025-10-24 19:04:42,234 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251024_1904_rank2_trend_line.svg
[rank2]:2025-10-24 19:04:42,260 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-24 19:04:42,261 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-24 19:04:42,262 - INFO -  step: 140  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,573  tflops: 20.11  mfu: 6.45%
[rank0]:2025-10-24 19:04:42,253 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251024_1904_rank0_trend_line.svg
[rank0]:2025-10-24 19:04:42,260 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-24 19:04:42,261 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-24 19:04:42,262 - INFO -  step: 140  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,573  tflops: 20.11  mfu: 6.45%
[rank3]:2025-10-24 19:04:42,479 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/pipeline_schedule/251024_1904_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 1395.63 ms, GPU Bubble Ratio: 65.93%, 44.12%, 62.13%, 13.75%
[rank3]:2025-10-24 19:04:42,480 - INFO - 	> Batch Time: 1395.63 ms (Average Freeze Ratio: 0.34)
[rank3]:2025-10-24 19:04:42,480 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-24 19:04:44,919 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-24 19:04:44,923 - INFO -  step: 140  loss:  1.1586  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,568  tflops: 20.07  mfu: 6.43%
[rank3]:2025-10-24 19:04:46,219 - INFO - Avg. fwd time: 76.1995 / Avg. bwd time: 117.6672 / Avg. batch time: 1604.4378 (ms) / GPU bubble ratio: 3.33%
[rank2]:2025-10-24 19:04:46,253 - INFO - Avg. fwd time: 34.8142 / Avg. bwd time: 48.1243 / Avg. batch time: 1725.6265 (ms) / GPU bubble ratio: 61.55%
[rank0]:2025-10-24 19:04:46,299 - INFO - Avg. fwd time: 48.1001 / Avg. bwd time: 46.3254 / Avg. batch time: 1923.8914 (ms) / GPU bubble ratio: 60.74%
[rank1]:2025-10-24 19:04:46,296 - INFO - Avg. fwd time: 55.1292 / Avg. bwd time: 65.1567 / Avg. batch time: 1839.2589 (ms) / GPU bubble ratio: 47.68%
[rank0]:2025-10-24 19:05:40,219 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-24 19:06:49,905 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251024_1906_rank0_trend_line.svg
[rank0]:2025-10-24 19:06:49,911 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-24 19:06:49,913 - INFO -  step: 160  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,567  tflops: 20.07  mfu: 6.43%
[rank1]:2025-10-24 19:06:49,905 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251024_1906_rank1_trend_line.svg
[rank1]:2025-10-24 19:06:49,911 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank1]:2025-10-24 19:06:49,913 - INFO -  step: 160  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,567  tflops: 20.07  mfu: 6.43%
[rank3]:2025-10-24 19:06:49,884 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251024_1906_rank3_trend_line.svg
[rank2]:2025-10-24 19:06:49,883 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251024_1906_rank2_trend_line.svg
[rank2]:2025-10-24 19:06:49,911 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-24 19:06:49,913 - INFO -  step: 160  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,567  tflops: 20.07  mfu: 6.43%
[rank3]:2025-10-24 19:06:50,135 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/pipeline_schedule/251024_1906_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 1391.79 ms, GPU Bubble Ratio: 68.41%, 44.56%, 62.43%, 13.56%
[rank3]:2025-10-24 19:06:50,135 - INFO - 	> Batch Time: 1391.79 ms (Average Freeze Ratio: 0.31)
[rank3]:2025-10-24 19:06:50,136 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-24 19:06:52,586 - INFO -  step: 160  loss:  1.1252  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,567  tflops: 20.07  mfu: 6.43%
[rank1]:2025-10-24 19:06:53,957 - INFO - Avg. fwd time: 55.2292 / Avg. bwd time: 61.9465 / Avg. batch time: 1798.6402 (ms) / GPU bubble ratio: 47.88%
[rank3]:2025-10-24 19:06:53,880 - INFO - Avg. fwd time: 76.2259 / Avg. bwd time: 111.9891 / Avg. batch time: 1558.8952 (ms) / GPU bubble ratio: 3.41%
[rank2]:2025-10-24 19:06:53,913 - INFO - Avg. fwd time: 34.8431 / Avg. bwd time: 45.8066 / Avg. batch time: 1688.3904 (ms) / GPU bubble ratio: 61.79%
[rank0]:2025-10-24 19:06:53,961 - INFO - Avg. fwd time: 48.0947 / Avg. bwd time: 40.5440 / Avg. batch time: 1877.3798 (ms) / GPU bubble ratio: 62.23%
[rank3]:2025-10-24 19:07:21,560 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-24 19:07:22,459 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 19:07:22,551 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-24 19:07:22,555 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 19:09:13,761 - INFO -  step: 180  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,278  tflops: 17.81  mfu: 5.71%
[rank1]:2025-10-24 19:09:13,785 - INFO -  step: 180  loss: -4.0000  grad_norm:  0.2256  memory: 20.03GiB(42.17%)  tps: 2,278  tflops: 17.81  mfu: 5.71%
[rank2]:2025-10-24 19:09:13,761 - INFO -  step: 180  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,278  tflops: 17.81  mfu: 5.71%
[rank3]:2025-10-24 19:09:16,219 - INFO -  step: 180  loss:  1.1171  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,281  tflops: 17.83  mfu: 5.72%
[rank3]:2025-10-24 19:09:17,494 - INFO - Avg. fwd time: 76.3307 / Avg. bwd time: 107.5086 / Avg. batch time: 1523.1371 (ms) / GPU bubble ratio: 3.44%
[rank2]:2025-10-24 19:09:17,622 - INFO - Avg. fwd time: 34.8676 / Avg. bwd time: 43.9701 / Avg. batch time: 1669.3131 (ms) / GPU bubble ratio: 62.22%
[rank0]:2025-10-24 19:09:17,782 - INFO - Avg. fwd time: 47.9807 / Avg. bwd time: 36.0456 / Avg. batch time: 1863.9073 (ms) / GPU bubble ratio: 63.94%
[rank1]:2025-10-24 19:09:17,779 - INFO - Avg. fwd time: 55.2007 / Avg. bwd time: 65.0359 / Avg. batch time: 1789.7810 (ms) / GPU bubble ratio: 46.26%
[rank0]:2025-10-24 19:11:30,866 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-24 19:11:37,711 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251024_1911_rank0_trend_line.svg
[rank0]:2025-10-24 19:11:37,718 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-24 19:11:37,720 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,276  tflops: 17.79  mfu: 5.70%
[rank2]:2025-10-24 19:11:37,687 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251024_1911_rank2_trend_line.svg
[rank2]:2025-10-24 19:11:37,718 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-24 19:11:37,720 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,276  tflops: 17.79  mfu: 5.70%
[rank3]:2025-10-24 19:11:37,690 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251024_1911_rank3_trend_line.svg
[rank1]:2025-10-24 19:11:37,713 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251024_1911_rank1_trend_line.svg
[rank1]:2025-10-24 19:11:37,718 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-10-24 19:11:37,720 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.2063  memory: 20.03GiB(42.17%)  tps: 2,277  tflops: 17.80  mfu: 5.70%
[rank3]:2025-10-24 19:11:37,941 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/pipeline_schedule/251024_1911_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 1380.13 ms, GPU Bubble Ratio: 69.92%, 32.47%, 62.47%, 13.03%
[rank3]:2025-10-24 19:11:37,941 - INFO - 	> Batch Time: 1380.13 ms (Average Freeze Ratio: 0.34)
[rank3]:2025-10-24 19:11:37,942 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-24 19:11:40,392 - INFO -  step: 200  loss:  1.1458  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,273  tflops: 17.77  mfu: 5.69%
[rank1]:2025-10-24 19:11:40,462 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251024_1911_stage1_step200.svg
[rank0]:2025-10-24 19:11:40,463 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251024_1911_stage0_step200.svg
[rank2]:2025-10-24 19:11:40,462 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251024_1911_stage2_step200.svg
[rank3]:2025-10-24 19:11:40,630 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/pipeline_schedule/251024_1911_real_step200_rank3.svg
[rank3]:> Batch Time: 1947.38 ms, GPU Bubble Ratio: 56.54%, 47.04%, 64.52%, 15.57%
[rank3]:2025-10-24 19:11:40,695 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251024_1911_stage3_step200.svg
[rank3]:2025-10-24 19:11:41,969 - INFO - Avg. fwd time: 76.4042 / Avg. bwd time: 103.8912 / Avg. batch time: 1494.1460 (ms) / GPU bubble ratio: 3.47%
[rank2]:2025-10-24 19:11:42,099 - INFO - Avg. fwd time: 34.8868 / Avg. bwd time: 42.4937 / Avg. batch time: 1651.0652 (ms) / GPU bubble ratio: 62.51%
[rank1]:2025-10-24 19:11:42,252 - INFO - Avg. fwd time: 55.1074 / Avg. bwd time: 67.4947 / Avg. batch time: 1779.6391 (ms) / GPU bubble ratio: 44.89%
[rank0]:2025-10-24 19:11:42,256 - INFO - Avg. fwd time: 47.9080 / Avg. bwd time: 32.4457 / Avg. batch time: 1850.0819 (ms) / GPU bubble ratio: 65.25%
[rank0]:2025-10-24 19:13:45,376 - INFO -  step: 220  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,567  tflops: 20.07  mfu: 6.43%
[rank1]:2025-10-24 19:13:45,376 - INFO -  step: 220  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,567  tflops: 20.07  mfu: 6.43%
[rank2]:2025-10-24 19:13:45,376 - INFO -  step: 220  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,567  tflops: 20.07  mfu: 6.43%
[rank3]:2025-10-24 19:13:47,802 - INFO -  step: 220  loss:  1.1289  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,572  tflops: 20.11  mfu: 6.44%
[rank2]:2025-10-24 19:13:49,099 - INFO - Avg. fwd time: 34.8923 / Avg. bwd time: 41.3191 / Avg. batch time: 1629.8716 (ms) / GPU bubble ratio: 62.59%
[rank3]:2025-10-24 19:13:49,064 - INFO - Avg. fwd time: 76.4489 / Avg. bwd time: 100.9371 / Avg. batch time: 1470.4429 (ms) / GPU bubble ratio: 3.49%
[rank0]:2025-10-24 19:13:49,145 - INFO - Avg. fwd time: 47.8042 / Avg. bwd time: 29.4996 / Avg. batch time: 1822.0785 (ms) / GPU bubble ratio: 66.06%
[rank1]:2025-10-24 19:13:49,141 - INFO - Avg. fwd time: 55.0426 / Avg. bwd time: 64.9390 / Avg. batch time: 1754.6679 (ms) / GPU bubble ratio: 45.30%
[rank0]:2025-10-24 19:15:52,458 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251024_1915_rank0_trend_line.svg
[rank1]:2025-10-24 19:15:52,457 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251024_1915_rank1_trend_line.svg
[rank1]:2025-10-24 19:15:52,463 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-10-24 19:15:52,465 - INFO -  step: 240  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,578  tflops: 20.16  mfu: 6.46%
[rank3]:2025-10-24 19:15:52,426 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251024_1915_rank3_trend_line.svg
[rank2]:2025-10-24 19:15:52,426 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251024_1915_rank2_trend_line.svg
[rank2]:2025-10-24 19:15:52,463 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-24 19:15:52,465 - INFO -  step: 240  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,578  tflops: 20.16  mfu: 6.46%
[rank0]:2025-10-24 19:15:52,463 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank0]:2025-10-24 19:15:52,465 - INFO -  step: 240  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,578  tflops: 20.16  mfu: 6.46%
[rank3]:2025-10-24 19:15:52,684 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/pipeline_schedule/251024_1915_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 1380.82 ms, GPU Bubble Ratio: 70.64%, 35.76%, 62.59%, 13.16%
[rank3]:2025-10-24 19:15:52,685 - INFO - 	> Batch Time: 1380.82 ms (Average Freeze Ratio: 0.31)
[rank3]:2025-10-24 19:15:52,685 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-24 19:15:55,118 - INFO -  step: 240  loss:  1.0815  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,574  tflops: 20.12  mfu: 6.45%
[rank1]:2025-10-24 19:15:56,478 - INFO - Avg. fwd time: 55.0525 / Avg. bwd time: 62.7983 / Avg. batch time: 1734.0976 (ms) / GPU bubble ratio: 45.63%
[rank3]:2025-10-24 19:15:56,401 - INFO - Avg. fwd time: 76.4433 / Avg. bwd time: 98.4963 / Avg. batch time: 1450.7644 (ms) / GPU bubble ratio: 3.53%
[rank2]:2025-10-24 19:15:56,436 - INFO - Avg. fwd time: 34.8984 / Avg. bwd time: 40.3368 / Avg. batch time: 1612.4712 (ms) / GPU bubble ratio: 62.67%
[rank0]:2025-10-24 19:15:56,483 - INFO - Avg. fwd time: 47.7890 / Avg. bwd time: 27.0440 / Avg. batch time: 1799.0001 (ms) / GPU bubble ratio: 66.72%
[rank3]:2025-10-24 19:16:39,293 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-24 19:16:40,027 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-24 19:16:40,097 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 19:16:40,177 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 19:16:54,444 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-24 19:18:09,546 - INFO -  step: 260  loss: -4.0000  grad_norm:  0.3362  memory: 20.89GiB(43.97%)  tps: 2,390  tflops: 18.69  mfu: 5.99%
[rank1]:2025-10-24 19:18:09,513 - INFO -  step: 260  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,391  tflops: 18.69  mfu: 5.99%
[rank2]:2025-10-24 19:18:09,513 - INFO -  step: 260  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,391  tflops: 18.69  mfu: 5.99%
[rank3]:2025-10-24 19:18:12,071 - INFO -  step: 260  loss:  1.0847  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,393  tflops: 18.70  mfu: 6.00%
[rank3]:2025-10-24 19:18:13,361 - INFO - Avg. fwd time: 76.5148 / Avg. bwd time: 96.4308 / Avg. batch time: 1434.5193 (ms) / GPU bubble ratio: 3.55%
[rank1]:2025-10-24 19:18:13,446 - INFO - Avg. fwd time: 54.9785 / Avg. bwd time: 60.9946 / Avg. batch time: 1717.2817 (ms) / GPU bubble ratio: 45.97%
[rank2]:2025-10-24 19:18:13,396 - INFO - Avg. fwd time: 34.9176 / Avg. bwd time: 39.5172 / Avg. batch time: 1597.9660 (ms) / GPU bubble ratio: 62.74%
[rank0]:2025-10-24 19:18:13,560 - INFO - Avg. fwd time: 47.8403 / Avg. bwd time: 30.5970 / Avg. batch time: 1788.6374 (ms) / GPU bubble ratio: 64.92%
[rank2]:2025-10-24 19:20:27,408 - INFO -  step: 280  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,376  tflops: 18.58  mfu: 5.95%
[rank1]:2025-10-24 19:20:27,408 - INFO -  step: 280  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,376  tflops: 18.58  mfu: 5.95%
[rank0]:2025-10-24 19:20:27,442 - INFO -  step: 280  loss: -4.0000  grad_norm:  0.3288  memory: 20.89GiB(43.97%)  tps: 2,376  tflops: 18.58  mfu: 5.95%
[rank3]:2025-10-24 19:20:29,873 - INFO -  step: 280  loss:  1.1259  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,378  tflops: 18.59  mfu: 5.96%
[rank3]:2025-10-24 19:20:31,167 - INFO - Avg. fwd time: 76.5800 / Avg. bwd time: 94.6691 / Avg. batch time: 1420.7099 (ms) / GPU bubble ratio: 3.57%
[rank2]:2025-10-24 19:20:31,201 - INFO - Avg. fwd time: 34.9380 / Avg. bwd time: 38.8123 / Avg. batch time: 1585.6581 (ms) / GPU bubble ratio: 62.79%
[rank1]:2025-10-24 19:20:31,248 - INFO - Avg. fwd time: 54.9089 / Avg. bwd time: 59.4491 / Avg. batch time: 1703.2581 (ms) / GPU bubble ratio: 46.29%
[rank0]:2025-10-24 19:20:31,360 - INFO - Avg. fwd time: 47.9484 / Avg. bwd time: 33.7093 / Avg. batch time: 1780.3423 (ms) / GPU bubble ratio: 63.31%
[rank0]:2025-10-24 19:22:38,880 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-24 19:22:45,307 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,376  tflops: 18.58  mfu: 5.95%
[rank1]:2025-10-24 19:22:45,307 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,376  tflops: 18.58  mfu: 5.95%
[rank0]:2025-10-24 19:22:45,347 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.3363  memory: 20.89GiB(43.97%)  tps: 2,376  tflops: 18.58  mfu: 5.95%
[rank0]:2025-10-24 19:22:47,811 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251024_1922_stage0_step300.svg
[rank3]:2025-10-24 19:22:47,741 - INFO -  step: 300  loss:  1.1113  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,377  tflops: 18.58  mfu: 5.96%
[rank2]:2025-10-24 19:22:47,811 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251024_1922_stage2_step300.svg
[rank1]:2025-10-24 19:22:47,811 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251024_1922_stage1_step300.svg
[rank3]:2025-10-24 19:22:47,967 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/pipeline_schedule/251024_1922_real_step300_rank3.svg
[rank3]:> Batch Time: 1451.88 ms, GPU Bubble Ratio: 41.53%, 45.23%, 64.55%, 17.31%
[rank3]:2025-10-24 19:22:48,028 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251024_1922_stage3_step300.svg
[rank3]:2025-10-24 19:22:49,314 - INFO - Avg. fwd time: 76.6501 / Avg. bwd time: 93.1411 / Avg. batch time: 1408.8095 (ms) / GPU bubble ratio: 3.58%
[rank2]:2025-10-24 19:22:49,349 - INFO - Avg. fwd time: 34.9522 / Avg. bwd time: 38.2013 / Avg. batch time: 1573.1128 (ms) / GPU bubble ratio: 62.80%
[rank1]:2025-10-24 19:22:49,399 - INFO - Avg. fwd time: 54.8466 / Avg. bwd time: 58.1075 / Avg. batch time: 1689.2392 (ms) / GPU bubble ratio: 46.51%
[rank0]:2025-10-24 19:22:49,513 - INFO - Avg. fwd time: 48.0233 / Avg. bwd time: 36.4146 / Avg. batch time: 1771.3469 (ms) / GPU bubble ratio: 61.86%
[rank1]:2025-10-24 19:25:02,842 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251024_1925_rank1_trend_line.svg
[rank3]:2025-10-24 19:25:02,843 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251024_1925_rank3_trend_line.svg
[rank2]:2025-10-24 19:25:02,843 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251024_1925_rank2_trend_line.svg
[rank2]:2025-10-24 19:25:02,889 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank2]:2025-10-24 19:25:02,891 - INFO -  step: 320  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,382  tflops: 18.62  mfu: 5.97%
[rank1]:2025-10-24 19:25:02,889 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-10-24 19:25:02,891 - INFO -  step: 320  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,382  tflops: 18.62  mfu: 5.97%
[rank0]:2025-10-24 19:25:02,884 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251024_1925_rank0_trend_line.svg
[rank0]:2025-10-24 19:25:02,889 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-24 19:25:02,891 - INFO -  step: 320  loss: -4.0000  grad_norm:  0.3467  memory: 20.89GiB(43.97%)  tps: 2,382  tflops: 18.62  mfu: 5.97%
[rank3]:2025-10-24 19:25:03,111 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/pipeline_schedule/251024_1925_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 1380.06 ms, GPU Bubble Ratio: 56.23%, 39.18%, 62.63%, 13.13%
[rank3]:2025-10-24 19:25:03,112 - INFO - 	> Batch Time: 1380.06 ms (Average Freeze Ratio: 0.31)
[rank3]:2025-10-24 19:25:03,112 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-24 19:25:05,537 - INFO -  step: 320  loss:  1.1348  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,378  tflops: 18.59  mfu: 5.96%
[rank3]:2025-10-24 19:25:06,821 - INFO - Avg. fwd time: 76.6760 / Avg. bwd time: 91.7938 / Avg. batch time: 1398.0505 (ms) / GPU bubble ratio: 3.60%
[rank2]:2025-10-24 19:25:06,856 - INFO - Avg. fwd time: 34.9555 / Avg. bwd time: 37.6644 / Avg. batch time: 1563.6691 (ms) / GPU bubble ratio: 62.85%
[rank1]:2025-10-24 19:25:06,902 - INFO - Avg. fwd time: 54.8195 / Avg. bwd time: 56.9323 / Avg. batch time: 1678.4388 (ms) / GPU bubble ratio: 46.74%
[rank0]:2025-10-24 19:25:07,007 - INFO - Avg. fwd time: 48.0924 / Avg. bwd time: 38.7395 / Avg. batch time: 1764.7905 (ms) / GPU bubble ratio: 60.64%
[rank3]:2025-10-24 19:26:03,367 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-24 19:26:04,170 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-24 19:26:04,208 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 19:26:04,209 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-24 19:27:14,310 - INFO -  step: 340  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,493  tflops: 19.49  mfu: 6.25%
[rank0]:2025-10-24 19:27:14,310 - INFO -  step: 340  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,493  tflops: 19.49  mfu: 6.25%
[rank2]:2025-10-24 19:27:14,323 - INFO -  step: 340  loss: -4.0000  grad_norm:  0.1775  memory: 16.10GiB(33.90%)  tps: 2,493  tflops: 19.49  mfu: 6.25%
[rank3]:2025-10-24 19:27:16,880 - INFO -  step: 340  loss:  1.0541  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,495  tflops: 19.50  mfu: 6.25%
[rank3]:2025-10-24 19:27:18,171 - INFO - Avg. fwd time: 76.6981 / Avg. bwd time: 90.6054 / Avg. batch time: 1388.5085 (ms) / GPU bubble ratio: 3.61%
[rank2]:2025-10-24 19:27:18,257 - INFO - Avg. fwd time: 34.9553 / Avg. bwd time: 39.3490 / Avg. batch time: 1558.4500 (ms) / GPU bubble ratio: 61.86%
[rank1]:2025-10-24 19:27:18,302 - INFO - Avg. fwd time: 54.7274 / Avg. bwd time: 55.8814 / Avg. batch time: 1671.4713 (ms) / GPU bubble ratio: 47.06%
[rank0]:2025-10-24 19:27:18,306 - INFO - Avg. fwd time: 48.0911 / Avg. bwd time: 36.4625 / Avg. batch time: 1754.9579 (ms) / GPU bubble ratio: 61.46%
[rank0]:2025-10-24 19:28:14,130 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-24 19:29:25,911 - INFO -  step: 360  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,490  tflops: 19.47  mfu: 6.24%
[rank2]:2025-10-24 19:29:25,923 - INFO -  step: 360  loss: -4.0000  grad_norm:  0.1924  memory: 16.10GiB(33.90%)  tps: 2,490  tflops: 19.47  mfu: 6.24%
[rank1]:2025-10-24 19:29:25,910 - INFO -  step: 360  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,490  tflops: 19.47  mfu: 6.24%
[rank3]:2025-10-24 19:29:28,364 - INFO -  step: 360  loss:  1.1316  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,492  tflops: 19.48  mfu: 6.24%
[rank3]:2025-10-24 19:29:29,651 - INFO - Avg. fwd time: 76.7273 / Avg. bwd time: 89.5413 / Avg. batch time: 1380.0300 (ms) / GPU bubble ratio: 3.61%
[rank2]:2025-10-24 19:29:29,735 - INFO - Avg. fwd time: 34.9680 / Avg. bwd time: 40.8605 / Avg. batch time: 1553.9673 (ms) / GPU bubble ratio: 60.96%
[rank1]:2025-10-24 19:29:29,781 - INFO - Avg. fwd time: 54.6374 / Avg. bwd time: 54.9417 / Avg. batch time: 1665.4395 (ms) / GPU bubble ratio: 47.36%
[rank0]:2025-10-24 19:29:29,786 - INFO - Avg. fwd time: 48.0541 / Avg. bwd time: 34.4383 / Avg. batch time: 1746.3579 (ms) / GPU bubble ratio: 62.21%
[rank2]:2025-10-24 19:31:37,255 - INFO -  step: 380  loss: -4.0000  grad_norm:  0.1713  memory: 16.10GiB(33.90%)  tps: 2,495  tflops: 19.51  mfu: 6.25%
[rank1]:2025-10-24 19:31:37,242 - INFO -  step: 380  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,495  tflops: 19.51  mfu: 6.25%
[rank0]:2025-10-24 19:31:37,242 - INFO -  step: 380  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,495  tflops: 19.51  mfu: 6.25%
[rank3]:2025-10-24 19:31:39,683 - INFO -  step: 380  loss:  1.0836  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,495  tflops: 19.51  mfu: 6.25%
[rank3]:2025-10-24 19:31:40,977 - INFO - Avg. fwd time: 76.7385 / Avg. bwd time: 88.5890 / Avg. batch time: 1372.3528 (ms) / GPU bubble ratio: 3.62%
[rank2]:2025-10-24 19:31:41,058 - INFO - Avg. fwd time: 34.9602 / Avg. bwd time: 42.2205 / Avg. batch time: 1549.8059 (ms) / GPU bubble ratio: 60.16%
[rank0]:2025-10-24 19:31:41,106 - INFO - Avg. fwd time: 48.0134 / Avg. bwd time: 32.6270 / Avg. batch time: 1738.5281 (ms) / GPU bubble ratio: 62.89%
[rank1]:2025-10-24 19:31:41,101 - INFO - Avg. fwd time: 54.5838 / Avg. bwd time: 54.1022 / Avg. batch time: 1659.9088 (ms) / GPU bubble ratio: 47.62%
[rank0]:2025-10-24 19:33:42,591 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-24 19:33:48,744 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.1775  memory: 16.10GiB(33.90%)  tps: 2,492  tflops: 19.48  mfu: 6.24%
[rank1]:2025-10-24 19:33:48,731 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,492  tflops: 19.48  mfu: 6.24%
[rank0]:2025-10-24 19:33:48,732 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,492  tflops: 19.48  mfu: 6.24%
[rank3]:2025-10-24 19:33:51,179 - INFO -  step: 400  loss:  1.0827  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,492  tflops: 19.48  mfu: 6.24%
[rank2]:2025-10-24 19:33:51,252 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251024_1933_stage2_step400.svg
[rank1]:2025-10-24 19:33:51,253 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251024_1933_stage1_step400.svg
[rank0]:2025-10-24 19:33:51,253 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251024_1933_stage0_step400.svg
[rank3]:2025-10-24 19:33:51,388 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/pipeline_schedule/251024_1933_real_step400_rank3.svg
[rank3]:> Batch Time: 1383.46 ms, GPU Bubble Ratio: 72.02%, 44.99%, 62.49%, 13.37%
[rank3]:2025-10-24 19:33:51,452 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251024_1933_stage3_step400.svg
[rank3]:2025-10-24 19:33:52,740 - INFO - Avg. fwd time: 76.7580 / Avg. bwd time: 87.7358 / Avg. batch time: 1365.5418 (ms) / GPU bubble ratio: 3.63%
[rank2]:2025-10-24 19:33:52,826 - INFO - Avg. fwd time: 34.9606 / Avg. bwd time: 43.4432 / Avg. batch time: 1544.6882 (ms) / GPU bubble ratio: 59.39%
[rank1]:2025-10-24 19:33:52,870 - INFO - Avg. fwd time: 54.5423 / Avg. bwd time: 53.3444 / Avg. batch time: 1653.5542 (ms) / GPU bubble ratio: 47.80%
[rank0]:2025-10-24 19:33:52,875 - INFO - Avg. fwd time: 47.9726 / Avg. bwd time: 30.9968 / Avg. batch time: 1730.1023 (ms) / GPU bubble ratio: 63.48%
[rank3]:2025-10-24 19:35:05,817 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-24 19:35:06,612 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-24 19:35:06,650 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 19:35:06,650 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-24 19:36:01,133 - INFO -  step: 420  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,475  tflops: 19.35  mfu: 6.20%
[rank0]:2025-10-24 19:36:01,134 - INFO -  step: 420  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,475  tflops: 19.35  mfu: 6.20%
[rank2]:2025-10-24 19:36:01,146 - INFO -  step: 420  loss: -4.0000  grad_norm:  0.1654  memory: 16.10GiB(33.90%)  tps: 2,475  tflops: 19.35  mfu: 6.20%
[rank3]:2025-10-24 19:36:03,597 - INFO -  step: 420  loss:  1.0023  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,475  tflops: 19.35  mfu: 6.20%
[rank3]:2025-10-24 19:36:04,890 - INFO - Avg. fwd time: 76.8029 / Avg. bwd time: 86.9779 / Avg. batch time: 1359.6965 (ms) / GPU bubble ratio: 3.64%
[rank2]:2025-10-24 19:36:04,976 - INFO - Avg. fwd time: 34.9716 / Avg. bwd time: 44.5525 / Avg. batch time: 1541.7821 (ms) / GPU bubble ratio: 58.74%
[rank1]:2025-10-24 19:36:05,020 - INFO - Avg. fwd time: 54.5030 / Avg. bwd time: 52.6657 / Avg. batch time: 1649.5523 (ms) / GPU bubble ratio: 48.03%
[rank0]:2025-10-24 19:36:05,025 - INFO - Avg. fwd time: 47.9518 / Avg. bwd time: 29.5217 / Avg. batch time: 1724.2271 (ms) / GPU bubble ratio: 64.05%
[rank2]:2025-10-24 19:38:13,592 - INFO -  step: 440  loss: -4.0000  grad_norm:  0.1701  memory: 16.10GiB(33.90%)  tps: 2,474  tflops: 19.34  mfu: 6.20%
[rank1]:2025-10-24 19:38:13,579 - INFO -  step: 440  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,474  tflops: 19.34  mfu: 6.20%
[rank0]:2025-10-24 19:38:13,579 - INFO -  step: 440  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,474  tflops: 19.34  mfu: 6.20%
[rank3]:2025-10-24 19:38:16,042 - INFO -  step: 440  loss:  1.0718  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,474  tflops: 19.34  mfu: 6.20%
[rank3]:2025-10-24 19:38:17,339 - INFO - Avg. fwd time: 76.8577 / Avg. bwd time: 86.2955 / Avg. batch time: 1354.5181 (ms) / GPU bubble ratio: 3.64%
[rank2]:2025-10-24 19:38:17,430 - INFO - Avg. fwd time: 34.9833 / Avg. bwd time: 45.5795 / Avg. batch time: 1539.3013 (ms) / GPU bubble ratio: 58.13%
[rank1]:2025-10-24 19:38:17,474 - INFO - Avg. fwd time: 54.4733 / Avg. bwd time: 52.0464 / Avg. batch time: 1646.0856 (ms) / GPU bubble ratio: 48.23%
[rank0]:2025-10-24 19:38:17,479 - INFO - Avg. fwd time: 47.9156 / Avg. bwd time: 28.1807 / Avg. batch time: 1719.0606 (ms) / GPU bubble ratio: 64.59%
[rank0]:2025-10-24 19:39:13,745 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-24 19:40:26,092 - INFO -  step: 460  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,473  tflops: 19.33  mfu: 6.20%
[rank2]:2025-10-24 19:40:26,105 - INFO -  step: 460  loss: -4.0000  grad_norm:  0.1924  memory: 16.10GiB(33.90%)  tps: 2,473  tflops: 19.33  mfu: 6.20%
[rank0]:2025-10-24 19:40:26,093 - INFO -  step: 460  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,473  tflops: 19.33  mfu: 6.20%
[rank3]:2025-10-24 19:40:28,556 - INFO -  step: 460  loss:  1.1488  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,473  tflops: 19.33  mfu: 6.20%
[rank3]:2025-10-24 19:40:29,849 - INFO - Avg. fwd time: 76.9041 / Avg. bwd time: 85.6781 / Avg. batch time: 1349.8191 (ms) / GPU bubble ratio: 3.64%
[rank2]:2025-10-24 19:40:29,938 - INFO - Avg. fwd time: 34.9950 / Avg. bwd time: 46.5240 / Avg. batch time: 1537.0640 (ms) / GPU bubble ratio: 57.57%
[rank1]:2025-10-24 19:40:29,981 - INFO - Avg. fwd time: 54.4359 / Avg. bwd time: 51.4798 / Avg. batch time: 1642.9443 (ms) / GPU bubble ratio: 48.43%
[rank0]:2025-10-24 19:40:29,987 - INFO - Avg. fwd time: 47.8699 / Avg. bwd time: 26.9562 / Avg. batch time: 1714.3654 (ms) / GPU bubble ratio: 65.08%
[rank0]:2025-10-24 19:42:38,215 - INFO -  step: 480  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,480  tflops: 19.39  mfu: 6.21%
[rank2]:2025-10-24 19:42:38,233 - INFO -  step: 480  loss: -4.0000  grad_norm:  0.1776  memory: 16.10GiB(33.90%)  tps: 2,480  tflops: 19.39  mfu: 6.21%
[rank1]:2025-10-24 19:42:38,215 - INFO -  step: 480  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,480  tflops: 19.39  mfu: 6.21%
[rank3]:2025-10-24 19:42:40,677 - INFO -  step: 480  loss:  1.1131  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,480  tflops: 19.39  mfu: 6.21%
[rank3]:2025-10-24 19:42:41,967 - INFO - Avg. fwd time: 76.9357 / Avg. bwd time: 85.0938 / Avg. batch time: 1345.2705 (ms) / GPU bubble ratio: 3.65%
[rank2]:2025-10-24 19:42:42,056 - INFO - Avg. fwd time: 35.0008 / Avg. bwd time: 47.3722 / Avg. batch time: 1534.7852 (ms) / GPU bubble ratio: 57.06%
[rank0]:2025-10-24 19:42:42,104 - INFO - Avg. fwd time: 47.8422 / Avg. bwd time: 25.8337 / Avg. batch time: 1709.8465 (ms) / GPU bubble ratio: 65.53%
[rank1]:2025-10-24 19:42:42,099 - INFO - Avg. fwd time: 54.4167 / Avg. bwd time: 50.9631 / Avg. batch time: 1639.8570 (ms) / GPU bubble ratio: 48.59%
[rank3]:2025-10-24 19:44:08,324 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 19:44:09,155 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-24 19:44:09,115 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-24 19:44:09,155 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 19:44:43,564 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-24 19:44:49,662 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,493  tflops: 19.49  mfu: 6.25%
[rank1]:2025-10-24 19:44:49,663 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-24 19:44:49,663 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,493  tflops: 19.49  mfu: 6.25%
[rank0]:2025-10-24 19:44:49,671 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-24 19:44:49,671 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank2]:2025-10-24 19:44:49,675 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.1698  memory: 16.10GiB(33.90%)  tps: 2,493  tflops: 19.49  mfu: 6.25%
[rank2]:2025-10-24 19:44:49,675 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-24 19:44:51,479 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 1.80 seconds.
[rank1]:2025-10-24 19:44:51,930 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 2.27 seconds.
[rank3]:2025-10-24 19:44:52,214 - INFO -  step: 500  loss:  1.0003  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,491  tflops: 19.48  mfu: 6.24%
[rank3]:2025-10-24 19:44:52,214 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-24 19:44:53,418 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-24 19:44:53,425 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.75 seconds.
[rank3]:2025-10-24 19:44:56,815 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 4.60 seconds.
[rank0]:2025-10-24 19:44:56,897 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251024_1944_stage0_step500.svg
[rank2]:2025-10-24 19:44:56,896 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251024_1944_stage2_step500.svg
[rank1]:2025-10-24 19:44:56,897 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251024_1944_stage1_step500.svg
[rank3]:2025-10-24 19:44:57,204 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/pipeline_schedule/251024_1944_real_step500_rank3.svg
[rank3]:> Batch Time: 1404.13 ms, GPU Bubble Ratio: 72.49%, 46.16%, 49.98%, 14.62%
[rank3]:2025-10-24 19:44:57,266 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251024_1944_stage3_step500.svg
[rank3]:2025-10-24 19:44:58,553 - INFO - Avg. fwd time: 76.9351 / Avg. bwd time: 84.5544 / Avg. batch time: 1340.8553 (ms) / GPU bubble ratio: 3.65%
[rank2]:2025-10-24 19:44:58,631 - INFO - Avg. fwd time: 34.9975 / Avg. bwd time: 48.1427 / Avg. batch time: 1531.2990 (ms) / GPU bubble ratio: 56.56%
[rank1]:2025-10-24 19:44:58,677 - INFO - Avg. fwd time: 54.3877 / Avg. bwd time: 50.4840 / Avg. batch time: 1635.5994 (ms) / GPU bubble ratio: 48.71%
[rank0]:2025-10-24 19:44:58,683 - INFO - Avg. fwd time: 47.8213 / Avg. bwd time: 24.8009 / Avg. batch time: 1704.2852 (ms) / GPU bubble ratio: 65.91%
[rank1]:2025-10-24 19:47:07,015 - INFO -  step: 520  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,386  tflops: 18.65  mfu: 5.98%
[rank0]:2025-10-24 19:47:07,016 - INFO -  step: 520  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,386  tflops: 18.65  mfu: 5.98%
[rank2]:2025-10-24 19:47:07,034 - INFO -  step: 520  loss: -4.0000  grad_norm:  0.1756  memory: 16.10GiB(33.90%)  tps: 2,386  tflops: 18.65  mfu: 5.98%
[rank3]:2025-10-24 19:47:09,616 - INFO -  step: 520  loss:  1.0736  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,385  tflops: 18.64  mfu: 5.98%
[rank3]:2025-10-24 19:47:10,906 - INFO - Avg. fwd time: 76.9326 / Avg. bwd time: 84.0503 / Avg. batch time: 1336.7301 (ms) / GPU bubble ratio: 3.66%
[rank2]:2025-10-24 19:47:10,995 - INFO - Avg. fwd time: 34.9916 / Avg. bwd time: 48.8460 / Avg. batch time: 1529.4192 (ms) / GPU bubble ratio: 56.15%
[rank1]:2025-10-24 19:47:11,041 - INFO - Avg. fwd time: 54.3613 / Avg. bwd time: 50.0454 / Avg. batch time: 1633.0051 (ms) / GPU bubble ratio: 48.85%
[rank0]:2025-10-24 19:47:11,048 - INFO - Avg. fwd time: 47.8014 / Avg. bwd time: 23.8476 / Avg. batch time: 1700.4817 (ms) / GPU bubble ratio: 66.29%
[rank0]:2025-10-24 19:49:20,179 - INFO -  step: 540  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,461  tflops: 19.24  mfu: 6.17%
[rank1]:2025-10-24 19:49:20,179 - INFO -  step: 540  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,461  tflops: 19.24  mfu: 6.17%
[rank2]:2025-10-24 19:49:20,193 - INFO -  step: 540  loss: -4.0000  grad_norm:  0.1775  memory: 16.10GiB(33.90%)  tps: 2,461  tflops: 19.24  mfu: 6.17%
[rank3]:2025-10-24 19:49:22,976 - INFO -  step: 540  loss:  1.0801  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,457  tflops: 19.21  mfu: 6.16%
[rank3]:2025-10-24 19:49:24,266 - INFO - Avg. fwd time: 76.9692 / Avg. bwd time: 83.6008 / Avg. batch time: 1333.3118 (ms) / GPU bubble ratio: 3.66%
[rank2]:2025-10-24 19:49:24,349 - INFO - Avg. fwd time: 34.9895 / Avg. bwd time: 49.5304 / Avg. batch time: 1528.2355 (ms) / GPU bubble ratio: 55.76%
[rank0]:2025-10-24 19:49:24,400 - INFO - Avg. fwd time: 47.7909 / Avg. bwd time: 22.9648 / Avg. batch time: 1697.5117 (ms) / GPU bubble ratio: 66.65%
[rank1]:2025-10-24 19:49:24,393 - INFO - Avg. fwd time: 54.3228 / Avg. bwd time: 49.6392 / Avg. batch time: 1631.1431 (ms) / GPU bubble ratio: 49.01%
[rank0]:2025-10-24 19:50:21,023 - INFO - [GC] Peforming periodical GC collection 0.23 seconds
[rank0]:2025-10-24 19:51:33,576 - INFO -  step: 560  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,456  tflops: 19.20  mfu: 6.15%
[rank1]:2025-10-24 19:51:33,575 - INFO -  step: 560  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,456  tflops: 19.20  mfu: 6.15%
[rank2]:2025-10-24 19:51:33,588 - INFO -  step: 560  loss: -4.0000  grad_norm:  0.1751  memory: 16.10GiB(33.90%)  tps: 2,456  tflops: 19.20  mfu: 6.15%
[rank3]:2025-10-24 19:51:36,162 - INFO -  step: 560  loss:  1.0953  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,460  tflops: 19.23  mfu: 6.16%
[rank3]:2025-10-24 19:51:37,460 - INFO - Avg. fwd time: 76.9972 / Avg. bwd time: 83.1917 / Avg. batch time: 1330.2085 (ms) / GPU bubble ratio: 3.66%
[rank2]:2025-10-24 19:51:37,542 - INFO - Avg. fwd time: 35.0008 / Avg. bwd time: 50.1479 / Avg. batch time: 1526.9299 (ms) / GPU bubble ratio: 55.39%
[rank1]:2025-10-24 19:51:37,587 - INFO - Avg. fwd time: 54.3408 / Avg. bwd time: 49.2591 / Avg. batch time: 1629.2558 (ms) / GPU bubble ratio: 49.13%
[rank0]:2025-10-24 19:51:37,593 - INFO - Avg. fwd time: 47.7672 / Avg. bwd time: 22.1451 / Avg. batch time: 1694.5794 (ms) / GPU bubble ratio: 66.99%
[rank3]:2025-10-24 19:53:21,402 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-24 19:53:21,456 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 19:53:21,494 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-24 19:53:21,494 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 19:53:45,955 - INFO -  step: 580  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,475  tflops: 19.35  mfu: 6.20%
[rank1]:2025-10-24 19:53:45,954 - INFO -  step: 580  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,475  tflops: 19.35  mfu: 6.20%
[rank2]:2025-10-24 19:53:45,969 - INFO -  step: 580  loss: -4.0000  grad_norm:  0.1763  memory: 16.10GiB(33.90%)  tps: 2,475  tflops: 19.35  mfu: 6.20%
[rank3]:2025-10-24 19:53:48,377 - INFO -  step: 580  loss:  0.9801  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,478  tflops: 19.38  mfu: 6.21%
[rank3]:2025-10-24 19:53:49,665 - INFO - Avg. fwd time: 77.0210 / Avg. bwd time: 82.8052 / Avg. batch time: 1327.2049 (ms) / GPU bubble ratio: 3.66%
[rank2]:2025-10-24 19:53:49,755 - INFO - Avg. fwd time: 35.0079 / Avg. bwd time: 50.7316 / Avg. batch time: 1525.4401 (ms) / GPU bubble ratio: 55.03%
[rank0]:2025-10-24 19:53:49,806 - INFO - Avg. fwd time: 47.7586 / Avg. bwd time: 21.3819 / Avg. batch time: 1691.5638 (ms) / GPU bubble ratio: 67.30%
[rank1]:2025-10-24 19:53:49,800 - INFO - Avg. fwd time: 54.3179 / Avg. bwd time: 48.9085 / Avg. batch time: 1627.2060 (ms) / GPU bubble ratio: 49.25%
[rank0]:2025-10-24 19:55:51,721 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-24 19:55:57,852 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,484  tflops: 19.42  mfu: 6.22%
[rank2]:2025-10-24 19:55:57,866 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.1903  memory: 16.10GiB(33.90%)  tps: 2,484  tflops: 19.42  mfu: 6.22%
[rank0]:2025-10-24 19:55:57,853 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,484  tflops: 19.42  mfu: 6.22%
[rank3]:2025-10-24 19:56:00,280 - INFO -  step: 600  loss:  1.0587  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,484  tflops: 19.42  mfu: 6.22%
[rank1]:2025-10-24 19:56:00,352 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251024_1955_stage1_step600.svg
[rank2]:2025-10-24 19:56:00,352 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251024_1955_stage2_step600.svg
[rank0]:2025-10-24 19:56:00,353 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251024_1955_stage0_step600.svg
[rank3]:2025-10-24 19:56:00,495 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/pipeline_schedule/251024_1956_real_step600_rank3.svg
[rank3]:> Batch Time: 1406.72 ms, GPU Bubble Ratio: 72.57%, 46.47%, 48.37%, 14.77%
[rank3]:2025-10-24 19:56:00,557 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251024_1956_stage3_step600.svg
[rank3]:2025-10-24 19:56:01,850 - INFO - Avg. fwd time: 77.0390 / Avg. bwd time: 82.4330 / Avg. batch time: 1324.2882 (ms) / GPU bubble ratio: 3.66%
[rank2]:2025-10-24 19:56:01,935 - INFO - Avg. fwd time: 35.0079 / Avg. bwd time: 51.2635 / Avg. batch time: 1523.0225 (ms) / GPU bubble ratio: 54.68%
[rank0]:2025-10-24 19:56:01,985 - INFO - Avg. fwd time: 47.7506 / Avg. bwd time: 20.6695 / Avg. batch time: 1687.6969 (ms) / GPU bubble ratio: 67.57%
[rank1]:2025-10-24 19:56:01,979 - INFO - Avg. fwd time: 54.2865 / Avg. bwd time: 48.5767 / Avg. batch time: 1624.2378 (ms) / GPU bubble ratio: 49.34%
[rank2]:2025-10-24 19:58:09,462 - INFO -  step: 620  loss: -4.0000  grad_norm:  0.1834  memory: 16.10GiB(33.90%)  tps: 2,490  tflops: 19.47  mfu: 6.24%
[rank0]:2025-10-24 19:58:09,450 - INFO -  step: 620  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,490  tflops: 19.47  mfu: 6.24%
[rank1]:2025-10-24 19:58:09,450 - INFO -  step: 620  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,490  tflops: 19.47  mfu: 6.24%
[rank3]:2025-10-24 19:58:11,882 - INFO -  step: 620  loss:  1.0818  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,490  tflops: 19.47  mfu: 6.24%
[rank3]:2025-10-24 19:58:13,148 - INFO - Avg. fwd time: 77.0393 / Avg. bwd time: 82.0832 / Avg. batch time: 1321.4212 (ms) / GPU bubble ratio: 3.67%
[rank2]:2025-10-24 19:58:13,237 - INFO - Avg. fwd time: 35.0063 / Avg. bwd time: 51.7634 / Avg. batch time: 1521.4257 (ms) / GPU bubble ratio: 54.37%
[rank0]:2025-10-24 19:58:13,288 - INFO - Avg. fwd time: 47.7392 / Avg. bwd time: 20.0031 / Avg. batch time: 1684.7402 (ms) / GPU bubble ratio: 67.83%
[rank1]:2025-10-24 19:58:13,282 - INFO - Avg. fwd time: 54.2568 / Avg. bwd time: 48.2680 / Avg. batch time: 1622.1286 (ms) / GPU bubble ratio: 49.44%
[rank2]:2025-10-24 20:00:20,858 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251024_2000_rank2_trend_line.svg
[rank3]:2025-10-24 20:00:20,819 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251024_2000_rank3_trend_line.svg
[rank1]:2025-10-24 20:00:20,901 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251024_2000_rank1_trend_line.svg
[rank1]:2025-10-24 20:00:20,908 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-10-24 20:00:20,911 - INFO -  step: 640  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,493  tflops: 19.49  mfu: 6.25%
[rank2]:2025-10-24 20:00:20,908 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-24 20:00:20,911 - INFO -  step: 640  loss: -4.0000  grad_norm:  0.1864  memory: 16.10GiB(33.90%)  tps: 2,493  tflops: 19.49  mfu: 6.25%
[rank0]:2025-10-24 20:00:20,902 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251024_2000_rank0_trend_line.svg
[rank0]:2025-10-24 20:00:20,908 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-24 20:00:20,911 - INFO -  step: 640  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,493  tflops: 19.49  mfu: 6.25%
[rank3]:2025-10-24 20:00:21,129 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/pipeline_schedule/251024_2000_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 1380.01 ms, GPU Bubble Ratio: 65.49%, 42.72%, 50.85%, 13.13%
[rank3]:2025-10-24 20:00:21,130 - INFO - 	> Batch Time: 1380.01 ms (Average Freeze Ratio: 0.34)
[rank3]:2025-10-24 20:00:21,130 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-24 20:00:23,563 - INFO -  step: 640  loss:  1.0588  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,488  tflops: 19.45  mfu: 6.24%
[rank3]:2025-10-24 20:00:24,843 - INFO - Avg. fwd time: 77.0337 / Avg. bwd time: 81.7542 / Avg. batch time: 1318.6732 (ms) / GPU bubble ratio: 3.67%
[rank2]:2025-10-24 20:00:24,929 - INFO - Avg. fwd time: 35.0029 / Avg. bwd time: 52.2319 / Avg. batch time: 1519.9502 (ms) / GPU bubble ratio: 54.09%
[rank1]:2025-10-24 20:00:24,981 - INFO - Avg. fwd time: 54.2373 / Avg. bwd time: 47.9767 / Avg. batch time: 1620.1777 (ms) / GPU bubble ratio: 49.53%
[rank0]:2025-10-24 20:00:24,987 - INFO - Avg. fwd time: 47.7288 / Avg. bwd time: 19.3783 / Avg. batch time: 1681.9962 (ms) / GPU bubble ratio: 68.08%
[rank0]:2025-10-24 20:01:18,616 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-24 20:02:18,371 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-24 20:02:19,116 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-24 20:02:19,155 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 20:02:19,156 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-24 20:02:27,965 - INFO -  step: 660  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,579  tflops: 20.16  mfu: 6.46%
[rank2]:2025-10-24 20:02:27,965 - INFO -  step: 660  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,579  tflops: 20.16  mfu: 6.46%
[rank0]:2025-10-24 20:02:27,965 - INFO -  step: 660  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,579  tflops: 20.16  mfu: 6.46%
[rank3]:2025-10-24 20:02:30,414 - INFO -  step: 660  loss:  0.9812  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,583  tflops: 20.19  mfu: 6.47%
[rank3]:2025-10-24 20:02:31,705 - INFO - Avg. fwd time: 77.0021 / Avg. bwd time: 81.4510 / Avg. batch time: 1316.0614 (ms) / GPU bubble ratio: 3.68%
[rank1]:2025-10-24 20:02:31,788 - INFO - Avg. fwd time: 54.2572 / Avg. bwd time: 47.7164 / Avg. batch time: 1616.6235 (ms) / GPU bubble ratio: 49.54%
[rank2]:2025-10-24 20:02:31,743 - INFO - Avg. fwd time: 35.0019 / Avg. bwd time: 51.5458 / Avg. batch time: 1516.7991 (ms) / GPU bubble ratio: 54.35%
[rank0]:2025-10-24 20:02:31,795 - INFO - Avg. fwd time: 47.7328 / Avg. bwd time: 18.7914 / Avg. batch time: 1677.6974 (ms) / GPU bubble ratio: 68.28%
[rank2]:2025-10-24 20:04:35,391 - INFO -  step: 680  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,572  tflops: 20.10  mfu: 6.44%
[rank1]:2025-10-24 20:04:35,391 - INFO -  step: 680  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,572  tflops: 20.10  mfu: 6.44%
[rank0]:2025-10-24 20:04:35,392 - INFO -  step: 680  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,572  tflops: 20.10  mfu: 6.44%
[rank3]:2025-10-24 20:04:37,818 - INFO -  step: 680  loss:  1.0357  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,572  tflops: 20.11  mfu: 6.44%
[rank3]:2025-10-24 20:04:39,105 - INFO - Avg. fwd time: 76.9756 / Avg. bwd time: 81.1718 / Avg. batch time: 1313.6989 (ms) / GPU bubble ratio: 3.69%
[rank2]:2025-10-24 20:04:39,143 - INFO - Avg. fwd time: 34.9983 / Avg. bwd time: 50.8975 / Avg. batch time: 1514.0232 (ms) / GPU bubble ratio: 54.61%
[rank1]:2025-10-24 20:04:39,189 - INFO - Avg. fwd time: 54.2923 / Avg. bwd time: 47.4794 / Avg. batch time: 1613.4730 (ms) / GPU bubble ratio: 49.54%
[rank0]:2025-10-24 20:04:39,197 - INFO - Avg. fwd time: 47.7417 / Avg. bwd time: 18.2389 / Avg. batch time: 1673.8534 (ms) / GPU bubble ratio: 68.47%
[rank0]:2025-10-24 20:06:36,753 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-24 20:06:42,664 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,575  tflops: 20.13  mfu: 6.45%
[rank1]:2025-10-24 20:06:42,664 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,575  tflops: 20.13  mfu: 6.45%
[rank0]:2025-10-24 20:06:42,664 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,575  tflops: 20.13  mfu: 6.45%
[rank3]:2025-10-24 20:06:45,089 - INFO -  step: 700  loss:  1.0455  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,575  tflops: 20.13  mfu: 6.45%
[rank0]:2025-10-24 20:06:45,164 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251024_2006_stage0_step700.svg
[rank2]:2025-10-24 20:06:45,164 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251024_2006_stage2_step700.svg
[rank1]:2025-10-24 20:06:45,164 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251024_2006_stage1_step700.svg
[rank3]:2025-10-24 20:06:45,303 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/pipeline_schedule/251024_2006_real_step700_rank3.svg
[rank3]:> Batch Time: 1406.16 ms, GPU Bubble Ratio: 72.57%, 46.45%, 48.55%, 14.79%
[rank3]:2025-10-24 20:06:45,371 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251024_2006_stage3_step700.svg
[rank3]:2025-10-24 20:06:46,677 - INFO - Avg. fwd time: 76.9631 / Avg. bwd time: 80.9171 / Avg. batch time: 1311.5443 (ms) / GPU bubble ratio: 3.70%
[rank2]:2025-10-24 20:06:46,714 - INFO - Avg. fwd time: 34.9952 / Avg. bwd time: 50.2883 / Avg. batch time: 1510.5634 (ms) / GPU bubble ratio: 54.83%
[rank1]:2025-10-24 20:06:46,760 - INFO - Avg. fwd time: 54.3215 / Avg. bwd time: 47.2529 / Avg. batch time: 1609.6574 (ms) / GPU bubble ratio: 49.52%
[rank0]:2025-10-24 20:06:46,768 - INFO - Avg. fwd time: 47.7576 / Avg. bwd time: 17.7181 / Avg. batch time: 1669.3871 (ms) / GPU bubble ratio: 68.62%
[rank2]:2025-10-24 20:08:50,332 - INFO -  step: 720  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,567  tflops: 20.06  mfu: 6.43%
[rank1]:2025-10-24 20:08:50,332 - INFO -  step: 720  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,567  tflops: 20.07  mfu: 6.43%
[rank0]:2025-10-24 20:08:50,333 - INFO -  step: 720  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,567  tflops: 20.07  mfu: 6.43%
[rank3]:2025-10-24 20:08:52,755 - INFO -  step: 720  loss:  1.0529  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,567  tflops: 20.07  mfu: 6.43%
[rank3]:2025-10-24 20:08:54,058 - INFO - Avg. fwd time: 76.9512 / Avg. bwd time: 80.6751 / Avg. batch time: 1309.5497 (ms) / GPU bubble ratio: 3.71%
[rank2]:2025-10-24 20:08:54,095 - INFO - Avg. fwd time: 34.9953 / Avg. bwd time: 49.7131 / Avg. batch time: 1508.1281 (ms) / GPU bubble ratio: 55.07%
[rank1]:2025-10-24 20:08:54,141 - INFO - Avg. fwd time: 54.3403 / Avg. bwd time: 47.0381 / Avg. batch time: 1606.8910 (ms) / GPU bubble ratio: 49.53%
[rank0]:2025-10-24 20:08:54,148 - INFO - Avg. fwd time: 47.7676 / Avg. bwd time: 17.2261 / Avg. batch time: 1666.0021 (ms) / GPU bubble ratio: 68.79%
[rank0]:2025-10-24 20:10:57,489 - INFO -  step: 740  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,577  tflops: 20.15  mfu: 6.46%
[rank2]:2025-10-24 20:10:57,489 - INFO -  step: 740  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,577  tflops: 20.15  mfu: 6.46%
[rank1]:2025-10-24 20:10:57,489 - INFO -  step: 740  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,577  tflops: 20.15  mfu: 6.46%
[rank3]:2025-10-24 20:10:59,915 - INFO -  step: 740  loss:  1.0213  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,577  tflops: 20.15  mfu: 6.46%
[rank3]:2025-10-24 20:11:01,211 - INFO - Avg. fwd time: 76.9269 / Avg. bwd time: 80.4389 / Avg. batch time: 1307.5671 (ms) / GPU bubble ratio: 3.72%
[rank0]:2025-10-24 20:11:01,301 - INFO - Avg. fwd time: 47.7747 / Avg. bwd time: 16.7608 / Avg. batch time: 1662.7284 (ms) / GPU bubble ratio: 68.95%
[rank2]:2025-10-24 20:11:01,249 - INFO - Avg. fwd time: 34.9918 / Avg. bwd time: 49.1680 / Avg. batch time: 1505.7364 (ms) / GPU bubble ratio: 55.29%
[rank1]:2025-10-24 20:11:01,294 - INFO - Avg. fwd time: 54.3869 / Avg. bwd time: 46.8392 / Avg. batch time: 1604.2047 (ms) / GPU bubble ratio: 49.52%
[rank3]:2025-10-24 20:11:03,493 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-24 20:11:04,277 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 20:11:04,280 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-24 20:11:04,236 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 20:11:55,059 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-24 20:13:04,418 - INFO -  step: 760  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,582  tflops: 20.18  mfu: 6.47%
[rank0]:2025-10-24 20:13:04,419 - INFO -  step: 760  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,582  tflops: 20.18  mfu: 6.47%
[rank2]:2025-10-24 20:13:04,418 - INFO -  step: 760  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,582  tflops: 20.18  mfu: 6.47%
[rank3]:2025-10-24 20:13:06,997 - INFO -  step: 760  loss:  1.0407  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,579  tflops: 20.16  mfu: 6.46%
[rank3]:2025-10-24 20:13:08,291 - INFO - Avg. fwd time: 76.9162 / Avg. bwd time: 80.2096 / Avg. batch time: 1305.6706 (ms) / GPU bubble ratio: 3.73%
[rank2]:2025-10-24 20:13:08,329 - INFO - Avg. fwd time: 34.9909 / Avg. bwd time: 48.6513 / Avg. batch time: 1503.4661 (ms) / GPU bubble ratio: 55.49%
[rank1]:2025-10-24 20:13:08,375 - INFO - Avg. fwd time: 54.3987 / Avg. bwd time: 46.6468 / Avg. batch time: 1601.6359 (ms) / GPU bubble ratio: 49.53%
[rank0]:2025-10-24 20:13:08,382 - INFO - Avg. fwd time: 47.7769 / Avg. bwd time: 16.3199 / Avg. batch time: 1659.5962 (ms) / GPU bubble ratio: 69.10%
[rank1]:2025-10-24 20:15:11,780 - INFO -  step: 780  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,573  tflops: 20.11  mfu: 6.45%
[rank0]:2025-10-24 20:15:11,780 - INFO -  step: 780  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,573  tflops: 20.11  mfu: 6.45%
[rank2]:2025-10-24 20:15:11,779 - INFO -  step: 780  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,573  tflops: 20.11  mfu: 6.45%
[rank3]:2025-10-24 20:15:14,201 - INFO -  step: 780  loss:  1.0486  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,576  tflops: 20.14  mfu: 6.45%
[rank3]:2025-10-24 20:15:15,480 - INFO - Avg. fwd time: 76.9059 / Avg. bwd time: 79.9900 / Avg. batch time: 1303.8792 (ms) / GPU bubble ratio: 3.74%
[rank2]:2025-10-24 20:15:15,518 - INFO - Avg. fwd time: 34.9896 / Avg. bwd time: 48.1609 / Avg. batch time: 1501.3446 (ms) / GPU bubble ratio: 55.69%
[rank1]:2025-10-24 20:15:15,564 - INFO - Avg. fwd time: 54.4141 / Avg. bwd time: 46.4634 / Avg. batch time: 1599.2235 (ms) / GPU bubble ratio: 49.54%
[rank0]:2025-10-24 20:15:15,572 - INFO - Avg. fwd time: 47.7788 / Avg. bwd time: 15.9016 / Avg. batch time: 1656.6522 (ms) / GPU bubble ratio: 69.25%
[rank0]:2025-10-24 20:17:12,918 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-24 20:17:18,789 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,580  tflops: 20.17  mfu: 6.46%
[rank2]:2025-10-24 20:17:18,788 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,580  tflops: 20.17  mfu: 6.46%
[rank1]:2025-10-24 20:17:18,789 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,580  tflops: 20.17  mfu: 6.46%
[rank3]:2025-10-24 20:17:21,224 - INFO -  step: 800  loss:  1.0215  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,580  tflops: 20.17  mfu: 6.46%
[rank0]:2025-10-24 20:17:21,303 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251024_2017_stage0_step800.svg
[rank2]:2025-10-24 20:17:21,303 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251024_2017_stage2_step800.svg
[rank1]:2025-10-24 20:17:21,303 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251024_2017_stage1_step800.svg
[rank3]:2025-10-24 20:17:21,441 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/pipeline_schedule/251024_2017_real_step800_rank3.svg
[rank3]:> Batch Time: 1403.06 ms, GPU Bubble Ratio: 72.49%, 46.22%, 50.34%, 14.63%
[rank3]:2025-10-24 20:17:21,507 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251024_2017_stage3_step800.svg
[rank3]:2025-10-24 20:17:22,802 - INFO - Avg. fwd time: 76.8858 / Avg. bwd time: 79.7910 / Avg. batch time: 1302.1481 (ms) / GPU bubble ratio: 3.74%
[rank1]:2025-10-24 20:17:22,886 - INFO - Avg. fwd time: 54.4373 / Avg. bwd time: 46.2895 / Avg. batch time: 1596.1727 (ms) / GPU bubble ratio: 49.52%
[rank0]:2025-10-24 20:17:22,893 - INFO - Avg. fwd time: 47.7881 / Avg. bwd time: 15.5042 / Avg. batch time: 1653.1015 (ms) / GPU bubble ratio: 69.37%
[rank2]:2025-10-24 20:17:22,840 - INFO - Avg. fwd time: 34.9882 / Avg. bwd time: 47.6951 / Avg. batch time: 1498.5704 (ms) / GPU bubble ratio: 55.86%
[rank0]:2025-10-24 20:19:26,238 - INFO -  step: 820  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,571  tflops: 20.10  mfu: 6.44%
[rank1]:2025-10-24 20:19:26,237 - INFO -  step: 820  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,571  tflops: 20.10  mfu: 6.44%
[rank2]:2025-10-24 20:19:26,237 - INFO -  step: 820  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,571  tflops: 20.10  mfu: 6.44%
[rank3]:2025-10-24 20:19:28,659 - INFO -  step: 820  loss:  1.0423  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,571  tflops: 20.10  mfu: 6.44%
[rank3]:2025-10-24 20:19:29,961 - INFO - Avg. fwd time: 76.8739 / Avg. bwd time: 79.6050 / Avg. batch time: 1300.5735 (ms) / GPU bubble ratio: 3.75%
[rank0]:2025-10-24 20:19:30,053 - INFO - Avg. fwd time: 47.7952 / Avg. bwd time: 15.1263 / Avg. batch time: 1650.4579 (ms) / GPU bubble ratio: 69.50%
[rank1]:2025-10-24 20:19:30,045 - INFO - Avg. fwd time: 54.4625 / Avg. bwd time: 46.1245 / Avg. batch time: 1594.0078 (ms) / GPU bubble ratio: 49.52%
[rank2]:2025-10-24 20:19:29,999 - INFO - Avg. fwd time: 34.9837 / Avg. bwd time: 47.2525 / Avg. batch time: 1496.6658 (ms) / GPU bubble ratio: 56.04%
[rank2]:2025-10-24 20:19:46,307 - WARNING - Dataset alpaca is being re-looped
[rank3]:2025-10-24 20:19:46,298 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 20:19:46,348 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-24 20:19:46,348 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-24 20:21:33,458 - INFO -  step: 840  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,576  tflops: 20.14  mfu: 6.45%
[rank0]:2025-10-24 20:21:33,458 - INFO -  step: 840  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,576  tflops: 20.14  mfu: 6.45%
[rank1]:2025-10-24 20:21:33,458 - INFO -  step: 840  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,576  tflops: 20.14  mfu: 6.45%
[rank3]:2025-10-24 20:21:36,051 - INFO -  step: 840  loss:  0.9898  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,572  tflops: 20.11  mfu: 6.45%
[rank3]:2025-10-24 20:21:37,339 - INFO - Avg. fwd time: 76.8696 / Avg. bwd time: 79.4276 / Avg. batch time: 1299.1137 (ms) / GPU bubble ratio: 3.75%
[rank1]:2025-10-24 20:21:37,421 - INFO - Avg. fwd time: 54.4796 / Avg. bwd time: 45.9668 / Avg. batch time: 1592.0225 (ms) / GPU bubble ratio: 49.53%
[rank2]:2025-10-24 20:21:37,376 - INFO - Avg. fwd time: 34.9864 / Avg. bwd time: 46.8314 / Avg. batch time: 1494.9332 (ms) / GPU bubble ratio: 56.22%
[rank0]:2025-10-24 20:21:37,429 - INFO - Avg. fwd time: 47.8048 / Avg. bwd time: 14.7663 / Avg. batch time: 1648.0173 (ms) / GPU bubble ratio: 69.63%
[rank0]:2025-10-24 20:22:31,486 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-24 20:23:41,080 - INFO -  step: 860  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,568  tflops: 20.07  mfu: 6.43%
[rank1]:2025-10-24 20:23:41,079 - INFO -  step: 860  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,568  tflops: 20.07  mfu: 6.43%
[rank2]:2025-10-24 20:23:41,079 - INFO -  step: 860  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,568  tflops: 20.07  mfu: 6.43%
[rank3]:2025-10-24 20:23:43,510 - INFO -  step: 860  loss:  1.0408  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,571  tflops: 20.10  mfu: 6.44%
[rank2]:2025-10-24 20:23:44,834 - INFO - Avg. fwd time: 34.9834 / Avg. bwd time: 46.4292 / Avg. batch time: 1493.2921 (ms) / GPU bubble ratio: 56.38%
[rank3]:2025-10-24 20:23:44,796 - INFO - Avg. fwd time: 76.8703 / Avg. bwd time: 79.2545 / Avg. batch time: 1297.7271 (ms) / GPU bubble ratio: 3.75%
[rank0]:2025-10-24 20:23:44,888 - INFO - Avg. fwd time: 47.8048 / Avg. bwd time: 14.4230 / Avg. batch time: 1645.6945 (ms) / GPU bubble ratio: 69.75%
[rank1]:2025-10-24 20:23:44,880 - INFO - Avg. fwd time: 54.4900 / Avg. bwd time: 45.8162 / Avg. batch time: 1590.1346 (ms) / GPU bubble ratio: 49.54%
[rank2]:2025-10-24 20:25:48,181 - INFO -  step: 880  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,578  tflops: 20.15  mfu: 6.46%
[rank1]:2025-10-24 20:25:48,181 - INFO -  step: 880  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,578  tflops: 20.15  mfu: 6.46%
[rank0]:2025-10-24 20:25:48,181 - INFO -  step: 880  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,578  tflops: 20.15  mfu: 6.46%
[rank3]:2025-10-24 20:25:50,741 - INFO -  step: 880  loss:  1.0765  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,576  tflops: 20.13  mfu: 6.45%
[rank3]:2025-10-24 20:25:52,019 - INFO - Avg. fwd time: 76.8630 / Avg. bwd time: 79.0886 / Avg. batch time: 1296.3405 (ms) / GPU bubble ratio: 3.76%
[rank2]:2025-10-24 20:25:52,057 - INFO - Avg. fwd time: 34.9822 / Avg. bwd time: 46.0451 / Avg. batch time: 1491.6532 (ms) / GPU bubble ratio: 56.54%
[rank1]:2025-10-24 20:25:52,102 - INFO - Avg. fwd time: 54.5080 / Avg. bwd time: 45.6742 / Avg. batch time: 1588.2569 (ms) / GPU bubble ratio: 49.54%
[rank0]:2025-10-24 20:25:52,111 - INFO - Avg. fwd time: 47.8100 / Avg. bwd time: 14.0954 / Avg. batch time: 1643.4024 (ms) / GPU bubble ratio: 69.86%
[rank0]:2025-10-24 20:27:49,724 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-24 20:27:55,602 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,572  tflops: 20.10  mfu: 6.44%
[rank0]:2025-10-24 20:27:55,603 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,572  tflops: 20.10  mfu: 6.44%
[rank2]:2025-10-24 20:27:55,602 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,572  tflops: 20.10  mfu: 6.44%
[rank1]:2025-10-24 20:27:58,090 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251024_2027_stage1_step900.svg
[rank3]:2025-10-24 20:27:58,020 - INFO -  step: 900  loss:  1.0060  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,575  tflops: 20.13  mfu: 6.45%
[rank0]:2025-10-24 20:27:58,089 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251024_2027_stage0_step900.svg
[rank2]:2025-10-24 20:27:58,094 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251024_2027_stage2_step900.svg
[rank3]:2025-10-24 20:27:58,231 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/pipeline_schedule/251024_2027_real_step900_rank3.svg
[rank3]:> Batch Time: 1381.72 ms, GPU Bubble Ratio: 72.07%, 45.33%, 62.35%, 13.32%
[rank3]:2025-10-24 20:27:58,288 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251024_2027_stage3_step900.svg
[rank3]:2025-10-24 20:27:59,572 - INFO - Avg. fwd time: 76.8562 / Avg. bwd time: 78.9295 / Avg. batch time: 1295.0225 (ms) / GPU bubble ratio: 3.76%
[rank2]:2025-10-24 20:27:59,610 - INFO - Avg. fwd time: 34.9830 / Avg. bwd time: 45.6778 / Avg. batch time: 1489.4871 (ms) / GPU bubble ratio: 56.68%
[rank1]:2025-10-24 20:27:59,660 - INFO - Avg. fwd time: 54.5230 / Avg. bwd time: 45.5364 / Avg. batch time: 1585.8641 (ms) / GPU bubble ratio: 49.52%
[rank0]:2025-10-24 20:27:59,669 - INFO - Avg. fwd time: 47.8148 / Avg. bwd time: 13.7823 / Avg. batch time: 1640.6146 (ms) / GPU bubble ratio: 69.96%
[rank2]:2025-10-24 20:28:31,500 - WARNING - Dataset alpaca is being re-looped
[rank3]:2025-10-24 20:28:31,462 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 20:28:31,542 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-24 20:28:31,541 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 20:30:02,961 - INFO -  step: 920  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,573  tflops: 20.11  mfu: 6.45%
[rank1]:2025-10-24 20:30:02,961 - INFO -  step: 920  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,573  tflops: 20.11  mfu: 6.45%
[rank2]:2025-10-24 20:30:02,961 - INFO -  step: 920  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,573  tflops: 20.11  mfu: 6.45%
[rank3]:2025-10-24 20:30:05,517 - INFO -  step: 920  loss:  0.9677  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,570  tflops: 20.09  mfu: 6.44%
[rank2]:2025-10-24 20:30:06,835 - INFO - Avg. fwd time: 34.9795 / Avg. bwd time: 45.3278 / Avg. batch time: 1488.0164 (ms) / GPU bubble ratio: 56.82%
[rank3]:2025-10-24 20:30:06,796 - INFO - Avg. fwd time: 76.8411 / Avg. bwd time: 78.7866 / Avg. batch time: 1293.7706 (ms) / GPU bubble ratio: 3.77%
[rank0]:2025-10-24 20:30:06,889 - INFO - Avg. fwd time: 47.8233 / Avg. bwd time: 13.4828 / Avg. batch time: 1638.5541 (ms) / GPU bubble ratio: 70.07%
[rank1]:2025-10-24 20:30:06,881 - INFO - Avg. fwd time: 54.5507 / Avg. bwd time: 45.4033 / Avg. batch time: 1584.1760 (ms) / GPU bubble ratio: 49.52%
[rank1]:2025-10-24 20:32:10,400 - INFO -  step: 940  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,571  tflops: 20.10  mfu: 6.44%
[rank2]:2025-10-24 20:32:10,399 - INFO -  step: 940  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,571  tflops: 20.10  mfu: 6.44%
[rank0]:2025-10-24 20:32:10,400 - INFO -  step: 940  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,571  tflops: 20.10  mfu: 6.44%
[rank3]:2025-10-24 20:32:12,830 - INFO -  step: 940  loss:  1.0407  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,574  tflops: 20.12  mfu: 6.45%
[rank3]:2025-10-24 20:32:14,125 - INFO - Avg. fwd time: 76.8341 / Avg. bwd time: 78.6472 / Avg. batch time: 1292.5861 (ms) / GPU bubble ratio: 3.77%
[rank1]:2025-10-24 20:32:14,211 - INFO - Avg. fwd time: 54.5718 / Avg. bwd time: 45.2773 / Avg. batch time: 1582.5901 (ms) / GPU bubble ratio: 49.53%
[rank2]:2025-10-24 20:32:14,163 - INFO - Avg. fwd time: 34.9758 / Avg. bwd time: 44.9919 / Avg. batch time: 1486.6314 (ms) / GPU bubble ratio: 56.97%
[rank0]:2025-10-24 20:32:14,219 - INFO - Avg. fwd time: 47.8270 / Avg. bwd time: 13.1960 / Avg. batch time: 1636.6050 (ms) / GPU bubble ratio: 70.17%
[rank0]:2025-10-24 20:33:08,193 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-24 20:34:17,598 - INFO -  step: 960  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,576  tflops: 20.14  mfu: 6.45%
[rank0]:2025-10-24 20:34:17,598 - INFO -  step: 960  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,576  tflops: 20.14  mfu: 6.45%
[rank1]:2025-10-24 20:34:17,598 - INFO -  step: 960  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,576  tflops: 20.14  mfu: 6.45%
[rank3]:2025-10-24 20:34:20,024 - INFO -  step: 960  loss:  1.0519  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,576  tflops: 20.14  mfu: 6.46%
[rank2]:2025-10-24 20:34:21,368 - INFO - Avg. fwd time: 34.9772 / Avg. bwd time: 44.6704 / Avg. batch time: 1485.2791 (ms) / GPU bubble ratio: 57.10%
[rank3]:2025-10-24 20:34:21,329 - INFO - Avg. fwd time: 76.8270 / Avg. bwd time: 78.5110 / Avg. batch time: 1291.4516 (ms) / GPU bubble ratio: 3.77%
[rank0]:2025-10-24 20:34:21,425 - INFO - Avg. fwd time: 47.8295 / Avg. bwd time: 12.9212 / Avg. batch time: 1634.7095 (ms) / GPU bubble ratio: 70.27%
[rank1]:2025-10-24 20:34:21,416 - INFO - Avg. fwd time: 54.5860 / Avg. bwd time: 45.1563 / Avg. batch time: 1581.0446 (ms) / GPU bubble ratio: 49.53%
[rank2]:2025-10-24 20:36:24,734 - INFO -  step: 980  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,577  tflops: 20.15  mfu: 6.46%
[rank1]:2025-10-24 20:36:24,734 - INFO -  step: 980  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,577  tflops: 20.15  mfu: 6.46%
[rank0]:2025-10-24 20:36:24,735 - INFO -  step: 980  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,577  tflops: 20.15  mfu: 6.46%
[rank3]:2025-10-24 20:36:27,169 - INFO -  step: 980  loss:  1.0432  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,577  tflops: 20.15  mfu: 6.46%
[rank3]:2025-10-24 20:36:28,446 - INFO - Avg. fwd time: 76.8228 / Avg. bwd time: 78.3759 / Avg. batch time: 1290.3376 (ms) / GPU bubble ratio: 3.78%
[rank2]:2025-10-24 20:36:28,487 - INFO - Avg. fwd time: 34.9776 / Avg. bwd time: 44.3618 / Avg. batch time: 1483.9604 (ms) / GPU bubble ratio: 57.23%
[rank1]:2025-10-24 20:36:28,536 - INFO - Avg. fwd time: 54.6005 / Avg. bwd time: 45.0411 / Avg. batch time: 1579.5307 (ms) / GPU bubble ratio: 49.53%
[rank0]:2025-10-24 20:36:28,545 - INFO - Avg. fwd time: 47.8320 / Avg. bwd time: 12.6576 / Avg. batch time: 1632.8613 (ms) / GPU bubble ratio: 70.36%
[rank3]:2025-10-24 20:37:15,008 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-24 20:37:15,040 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-24 20:37:15,082 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 20:37:15,083 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 20:38:25,898 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-24 20:38:31,818 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,578  tflops: 20.16  mfu: 6.46%
[rank1]:2025-10-24 20:38:31,818 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-24 20:38:31,819 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,578  tflops: 20.16  mfu: 6.46%
[rank0]:2025-10-24 20:38:31,819 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-24 20:38:31,821 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank2]:2025-10-24 20:38:31,818 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,578  tflops: 20.16  mfu: 6.46%
[rank2]:2025-10-24 20:38:31,818 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-24 20:38:33,628 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 1.81 seconds.
[rank1]:2025-10-24 20:38:34,085 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 2.27 seconds.
[rank3]:2025-10-24 20:38:34,458 - INFO -  step: 1000  loss:  1.0145  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,574  tflops: 20.13  mfu: 6.45%
[rank3]:2025-10-24 20:38:34,459 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-24 20:38:35,425 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-24 20:38:35,433 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.61 seconds.
[rank3]:2025-10-24 20:38:38,214 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.76 seconds.
[rank1]:2025-10-24 20:38:38,303 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251024_2038_stage1_step1000.svg
[rank0]:2025-10-24 20:38:38,301 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251024_2038_stage0_step1000.svg
[rank2]:2025-10-24 20:38:38,304 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251024_2038_stage2_step1000.svg
[rank3]:2025-10-24 20:38:38,661 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/pipeline_schedule/251024_2038_real_step1000_rank3.svg
[rank3]:> Batch Time: 1381.41 ms, GPU Bubble Ratio: 72.06%, 45.28%, 62.64%, 13.30%
[rank3]:2025-10-24 20:38:38,726 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251024_2038_stage3_step1000.svg
[rank3]:2025-10-24 20:38:39,997 - INFO - Avg. fwd time: 76.8173 / Avg. bwd time: 78.2475 / Avg. batch time: 1289.2691 (ms) / GPU bubble ratio: 3.78%
[rank2]:2025-10-24 20:38:40,036 - INFO - Avg. fwd time: 34.9780 / Avg. bwd time: 44.0649 / Avg. batch time: 1482.1720 (ms) / GPU bubble ratio: 57.34%
[rank1]:2025-10-24 20:38:40,083 - INFO - Avg. fwd time: 54.6074 / Avg. bwd time: 44.9296 / Avg. batch time: 1577.5527 (ms) / GPU bubble ratio: 49.52%
[rank0]:2025-10-24 20:38:40,093 - INFO - Avg. fwd time: 47.8351 / Avg. bwd time: 12.4046 / Avg. batch time: 1630.5621 (ms) / GPU bubble ratio: 70.44%
[rank1]:2025-10-24 20:40:44,306 - INFO -  step: 1020  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,473  tflops: 19.34  mfu: 6.20%
[rank2]:2025-10-24 20:40:44,306 - INFO -  step: 1020  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,473  tflops: 19.34  mfu: 6.20%
[rank0]:2025-10-24 20:40:44,307 - INFO -  step: 1020  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,473  tflops: 19.34  mfu: 6.20%
[rank3]:2025-10-24 20:40:47,019 - INFO -  step: 1020  loss:  0.9904  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,472  tflops: 19.32  mfu: 6.19%
[rank3]:2025-10-24 20:40:48,315 - INFO - Avg. fwd time: 76.8148 / Avg. bwd time: 78.1209 / Avg. batch time: 1288.2287 (ms) / GPU bubble ratio: 3.78%
[rank1]:2025-10-24 20:40:48,401 - INFO - Avg. fwd time: 54.6097 / Avg. bwd time: 44.8203 / Avg. batch time: 1576.4450 (ms) / GPU bubble ratio: 49.54%
[rank2]:2025-10-24 20:40:48,354 - INFO - Avg. fwd time: 34.9759 / Avg. bwd time: 43.7794 / Avg. batch time: 1481.2451 (ms) / GPU bubble ratio: 57.47%
[rank0]:2025-10-24 20:40:48,410 - INFO - Avg. fwd time: 47.8383 / Avg. bwd time: 12.1614 / Avg. batch time: 1629.1478 (ms) / GPU bubble ratio: 70.54%
[rank2]:2025-10-24 20:42:52,294 - INFO -  step: 1040  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,560  tflops: 20.01  mfu: 6.42%
[rank0]:2025-10-24 20:42:52,294 - INFO -  step: 1040  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,560  tflops: 20.01  mfu: 6.42%
[rank1]:2025-10-24 20:42:52,294 - INFO -  step: 1040  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,560  tflops: 20.01  mfu: 6.42%
[rank3]:2025-10-24 20:42:54,989 - INFO -  step: 1040  loss:  1.0343  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,561  tflops: 20.02  mfu: 6.42%
[rank2]:2025-10-24 20:42:56,303 - INFO - Avg. fwd time: 34.9787 / Avg. bwd time: 43.5045 / Avg. batch time: 1480.2663 (ms) / GPU bubble ratio: 57.58%
[rank3]:2025-10-24 20:42:56,263 - INFO - Avg. fwd time: 76.8081 / Avg. bwd time: 78.0025 / Avg. batch time: 1287.2049 (ms) / GPU bubble ratio: 3.78%
[rank0]:2025-10-24 20:42:56,362 - INFO - Avg. fwd time: 47.8430 / Avg. bwd time: 11.9277 / Avg. batch time: 1627.6921 (ms) / GPU bubble ratio: 70.62%
[rank1]:2025-10-24 20:42:56,353 - INFO - Avg. fwd time: 54.6095 / Avg. bwd time: 44.7153 / Avg. batch time: 1575.2855 (ms) / GPU bubble ratio: 49.56%
[rank0]:2025-10-24 20:43:50,564 - INFO - [GC] Peforming periodical GC collection 0.24 seconds
[rank2]:2025-10-24 20:45:00,265 - INFO -  step: 1060  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,561  tflops: 20.02  mfu: 6.42%
[rank0]:2025-10-24 20:45:00,266 - INFO -  step: 1060  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,561  tflops: 20.02  mfu: 6.42%
[rank1]:2025-10-24 20:45:00,266 - INFO -  step: 1060  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,561  tflops: 20.02  mfu: 6.42%
[rank3]:2025-10-24 20:45:02,753 - INFO -  step: 1060  loss:  1.0307  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,565  tflops: 20.05  mfu: 6.43%
[rank3]:2025-10-24 20:45:04,057 - INFO - Avg. fwd time: 76.7957 / Avg. bwd time: 77.8895 / Avg. batch time: 1286.2051 (ms) / GPU bubble ratio: 3.79%
[rank1]:2025-10-24 20:45:04,144 - INFO - Avg. fwd time: 54.6229 / Avg. bwd time: 44.6128 / Avg. batch time: 1574.0590 (ms) / GPU bubble ratio: 49.56%
[rank2]:2025-10-24 20:45:04,096 - INFO - Avg. fwd time: 34.9762 / Avg. bwd time: 43.2406 / Avg. batch time: 1479.2011 (ms) / GPU bubble ratio: 57.70%
[rank0]:2025-10-24 20:45:04,153 - INFO - Avg. fwd time: 47.8491 / Avg. bwd time: 11.7027 / Avg. batch time: 1626.1843 (ms) / GPU bubble ratio: 70.70%
[rank0]:2025-10-24 20:46:04,000 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-24 20:46:03,999 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-24 20:46:03,998 - WARNING - Dataset alpaca is being re-looped
[rank3]:2025-10-24 20:46:06,412 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 20:47:07,584 - INFO -  step: 1080  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,574  tflops: 20.12  mfu: 6.45%
[rank1]:2025-10-24 20:47:07,584 - INFO -  step: 1080  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,574  tflops: 20.12  mfu: 6.45%
[rank2]:2025-10-24 20:47:07,584 - INFO -  step: 1080  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,574  tflops: 20.12  mfu: 6.45%
[rank3]:2025-10-24 20:47:09,995 - INFO -  step: 1080  loss:  0.9869  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,575  tflops: 20.13  mfu: 6.45%
[rank3]:2025-10-24 20:47:11,270 - INFO - Avg. fwd time: 76.7974 / Avg. bwd time: 77.7783 / Avg. batch time: 1285.2935 (ms) / GPU bubble ratio: 3.79%
[rank2]:2025-10-24 20:47:11,310 - INFO - Avg. fwd time: 34.9740 / Avg. bwd time: 42.9868 / Avg. batch time: 1478.1367 (ms) / GPU bubble ratio: 57.81%
[rank0]:2025-10-24 20:47:11,366 - INFO - Avg. fwd time: 47.8510 / Avg. bwd time: 11.4861 / Avg. batch time: 1624.6787 (ms) / GPU bubble ratio: 70.78%
[rank1]:2025-10-24 20:47:11,357 - INFO - Avg. fwd time: 54.6218 / Avg. bwd time: 44.5135 / Avg. batch time: 1572.8286 (ms) / GPU bubble ratio: 49.58%
[rank0]:2025-10-24 20:49:08,846 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-24 20:49:14,783 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,576  tflops: 20.14  mfu: 6.45%
[rank1]:2025-10-24 20:49:14,783 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,576  tflops: 20.14  mfu: 6.45%
[rank0]:2025-10-24 20:49:14,783 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,576  tflops: 20.14  mfu: 6.45%
[rank3]:2025-10-24 20:49:17,188 - INFO -  step: 1100  loss:  1.0360  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,576  tflops: 20.14  mfu: 6.46%
[rank0]:2025-10-24 20:49:17,265 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251024_2049_stage0_step1100.svg
[rank2]:2025-10-24 20:49:17,263 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251024_2049_stage2_step1100.svg
[rank1]:2025-10-24 20:49:17,263 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251024_2049_stage1_step1100.svg
[rank3]:2025-10-24 20:49:17,405 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/pipeline_schedule/251024_2049_real_step1100_rank3.svg
[rank3]:> Batch Time: 1380.80 ms, GPU Bubble Ratio: 72.05%, 45.27%, 62.71%, 13.28%
[rank3]:2025-10-24 20:49:17,470 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251024_2049_stage3_step1100.svg
[rank3]:2025-10-24 20:49:18,766 - INFO - Avg. fwd time: 76.7908 / Avg. bwd time: 77.6764 / Avg. batch time: 1284.4032 (ms) / GPU bubble ratio: 3.79%
[rank2]:2025-10-24 20:49:18,806 - INFO - Avg. fwd time: 34.9746 / Avg. bwd time: 42.7420 / Avg. batch time: 1476.6024 (ms) / GPU bubble ratio: 57.89%
[rank0]:2025-10-24 20:49:18,863 - INFO - Avg. fwd time: 47.8573 / Avg. bwd time: 11.2773 / Avg. batch time: 1622.7255 (ms) / GPU bubble ratio: 70.85%
[rank1]:2025-10-24 20:49:18,854 - INFO - Avg. fwd time: 54.6362 / Avg. bwd time: 44.4189 / Avg. batch time: 1571.1385 (ms) / GPU bubble ratio: 49.56%
[rank0]:2025-10-24 20:51:21,986 - INFO -  step: 1120  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,576  tflops: 20.14  mfu: 6.45%
[rank2]:2025-10-24 20:51:21,986 - INFO -  step: 1120  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,576  tflops: 20.14  mfu: 6.45%
[rank1]:2025-10-24 20:51:21,986 - INFO -  step: 1120  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,576  tflops: 20.14  mfu: 6.46%
[rank3]:2025-10-24 20:51:24,390 - INFO -  step: 1120  loss:  1.0282  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,576  tflops: 20.14  mfu: 6.45%
[rank3]:2025-10-24 20:51:25,684 - INFO - Avg. fwd time: 76.7880 / Avg. bwd time: 77.5743 / Avg. batch time: 1283.5511 (ms) / GPU bubble ratio: 3.79%
[rank2]:2025-10-24 20:51:25,723 - INFO - Avg. fwd time: 34.9750 / Avg. bwd time: 42.5064 / Avg. batch time: 1475.5641 (ms) / GPU bubble ratio: 57.99%
[rank1]:2025-10-24 20:51:25,773 - INFO - Avg. fwd time: 54.6437 / Avg. bwd time: 44.3286 / Avg. batch time: 1569.9474 (ms) / GPU bubble ratio: 49.57%
[rank0]:2025-10-24 20:51:25,783 - INFO - Avg. fwd time: 47.8619 / Avg. bwd time: 11.0760 / Avg. batch time: 1621.2811 (ms) / GPU bubble ratio: 70.92%
[rank0]:2025-10-24 20:53:29,095 - INFO -  step: 1140  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,578  tflops: 20.15  mfu: 6.46%
[rank2]:2025-10-24 20:53:29,094 - INFO -  step: 1140  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,578  tflops: 20.15  mfu: 6.46%
[rank1]:2025-10-24 20:53:29,094 - INFO -  step: 1140  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,578  tflops: 20.15  mfu: 6.46%
[rank3]:2025-10-24 20:53:31,502 - INFO -  step: 1140  loss:  1.0411  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,578  tflops: 20.15  mfu: 6.46%
[rank3]:2025-10-24 20:53:32,798 - INFO - Avg. fwd time: 76.7861 / Avg. bwd time: 77.4739 / Avg. batch time: 1282.7148 (ms) / GPU bubble ratio: 3.79%
[rank2]:2025-10-24 20:53:32,837 - INFO - Avg. fwd time: 34.9764 / Avg. bwd time: 42.2790 / Avg. batch time: 1474.6063 (ms) / GPU bubble ratio: 58.09%
[rank0]:2025-10-24 20:53:32,896 - INFO - Avg. fwd time: 47.8649 / Avg. bwd time: 10.8818 / Avg. batch time: 1619.9327 (ms) / GPU bubble ratio: 70.99%
[rank1]:2025-10-24 20:53:32,885 - INFO - Avg. fwd time: 54.6480 / Avg. bwd time: 44.2408 / Avg. batch time: 1568.8422 (ms) / GPU bubble ratio: 49.57%
[rank0]:2025-10-24 20:54:26,661 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-24 20:54:47,333 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-24 20:54:48,124 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-24 20:54:48,081 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 20:54:48,124 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 20:55:36,030 - INFO -  step: 1160  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,581  tflops: 20.18  mfu: 6.47%
[rank1]:2025-10-24 20:55:36,029 - INFO -  step: 1160  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,581  tflops: 20.18  mfu: 6.47%
[rank2]:2025-10-24 20:55:36,029 - INFO -  step: 1160  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,581  tflops: 20.18  mfu: 6.47%
[rank3]:2025-10-24 20:55:38,558 - INFO -  step: 1160  loss:  0.9662  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,579  tflops: 20.16  mfu: 6.46%
[rank3]:2025-10-24 20:55:39,839 - INFO - Avg. fwd time: 76.7884 / Avg. bwd time: 77.3742 / Avg. batch time: 1281.9230 (ms) / GPU bubble ratio: 3.79%
[rank2]:2025-10-24 20:55:39,879 - INFO - Avg. fwd time: 34.9774 / Avg. bwd time: 42.0594 / Avg. batch time: 1473.6687 (ms) / GPU bubble ratio: 58.18%
[rank0]:2025-10-24 20:55:39,937 - INFO - Avg. fwd time: 47.8649 / Avg. bwd time: 10.6942 / Avg. batch time: 1618.6196 (ms) / GPU bubble ratio: 71.06%
[rank1]:2025-10-24 20:55:39,927 - INFO - Avg. fwd time: 54.6582 / Avg. bwd time: 44.1577 / Avg. batch time: 1567.7671 (ms) / GPU bubble ratio: 49.58%
[rank0]:2025-10-24 20:57:43,099 - INFO -  step: 1180  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,579  tflops: 20.16  mfu: 6.46%
[rank1]:2025-10-24 20:57:43,098 - INFO -  step: 1180  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,579  tflops: 20.16  mfu: 6.46%
[rank2]:2025-10-24 20:57:43,098 - INFO -  step: 1180  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,579  tflops: 20.16  mfu: 6.46%
[rank3]:2025-10-24 20:57:45,626 - INFO -  step: 1180  loss:  1.0128  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,579  tflops: 20.16  mfu: 6.46%
[rank3]:2025-10-24 20:57:46,928 - INFO - Avg. fwd time: 76.7866 / Avg. bwd time: 77.2785 / Avg. batch time: 1281.1353 (ms) / GPU bubble ratio: 3.79%
[rank2]:2025-10-24 20:57:46,967 - INFO - Avg. fwd time: 34.9770 / Avg. bwd time: 41.8461 / Avg. batch time: 1472.7654 (ms) / GPU bubble ratio: 58.27%
[rank1]:2025-10-24 20:57:47,017 - INFO - Avg. fwd time: 54.6604 / Avg. bwd time: 44.0753 / Avg. batch time: 1566.7306 (ms) / GPU bubble ratio: 49.58%
[rank0]:2025-10-24 20:57:47,027 - INFO - Avg. fwd time: 47.8634 / Avg. bwd time: 10.5131 / Avg. batch time: 1617.3533 (ms) / GPU bubble ratio: 71.12%
[rank0]:2025-10-24 20:59:44,280 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-24 20:59:50,165 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,579  tflops: 20.16  mfu: 6.46%
[rank1]:2025-10-24 20:59:50,165 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,579  tflops: 20.16  mfu: 6.46%
[rank2]:2025-10-24 20:59:50,165 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,579  tflops: 20.16  mfu: 6.46%
[rank3]:2025-10-24 20:59:52,572 - INFO -  step: 1200  loss:  1.0537  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,581  tflops: 20.18  mfu: 6.47%
[rank2]:2025-10-24 20:59:52,650 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251024_2059_stage2_step1200.svg
[rank0]:2025-10-24 20:59:52,651 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251024_2059_stage0_step1200.svg
[rank1]:2025-10-24 20:59:52,650 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251024_2059_stage1_step1200.svg
[rank3]:2025-10-24 20:59:52,793 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/pipeline_schedule/251024_2059_real_step1200_rank3.svg
[rank3]:> Batch Time: 1380.91 ms, GPU Bubble Ratio: 72.05%, 45.25%, 62.77%, 13.29%
[rank3]:2025-10-24 20:59:52,857 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251024_2059_stage3_step1200.svg
[rank3]:2025-10-24 20:59:54,161 - INFO - Avg. fwd time: 76.7811 / Avg. bwd time: 77.1899 / Avg. batch time: 1280.3664 (ms) / GPU bubble ratio: 3.80%
[rank2]:2025-10-24 20:59:54,201 - INFO - Avg. fwd time: 34.9794 / Avg. bwd time: 41.6408 / Avg. batch time: 1471.3984 (ms) / GPU bubble ratio: 58.34%
[rank0]:2025-10-24 20:59:54,259 - INFO - Avg. fwd time: 47.8665 / Avg. bwd time: 10.3379 / Avg. batch time: 1615.6346 (ms) / GPU bubble ratio: 71.18%
[rank1]:2025-10-24 20:59:54,249 - INFO - Avg. fwd time: 54.6681 / Avg. bwd time: 43.9961 / Avg. batch time: 1565.2337 (ms) / GPU bubble ratio: 49.57%
[rank2]:2025-10-24 21:01:57,501 - INFO -  step: 1220  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,573  tflops: 20.12  mfu: 6.45%
[rank0]:2025-10-24 21:01:57,502 - INFO -  step: 1220  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,573  tflops: 20.12  mfu: 6.45%
[rank1]:2025-10-24 21:01:57,502 - INFO -  step: 1220  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,573  tflops: 20.12  mfu: 6.45%
[rank3]:2025-10-24 21:01:59,900 - INFO -  step: 1220  loss:  1.0474  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,574  tflops: 20.12  mfu: 6.45%
[rank3]:2025-10-24 21:02:01,203 - INFO - Avg. fwd time: 76.7767 / Avg. bwd time: 77.1095 / Avg. batch time: 1279.6656 (ms) / GPU bubble ratio: 3.80%
[rank1]:2025-10-24 21:02:01,292 - INFO - Avg. fwd time: 54.6754 / Avg. bwd time: 43.9182 / Avg. batch time: 1564.2603 (ms) / GPU bubble ratio: 49.58%
[rank2]:2025-10-24 21:02:01,243 - INFO - Avg. fwd time: 34.9784 / Avg. bwd time: 41.4430 / Avg. batch time: 1470.5517 (ms) / GPU bubble ratio: 58.43%
[rank0]:2025-10-24 21:02:01,302 - INFO - Avg. fwd time: 47.8730 / Avg. bwd time: 10.1685 / Avg. batch time: 1614.4496 (ms) / GPU bubble ratio: 71.24%
[rank3]:2025-10-24 21:03:30,616 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-24 21:03:31,372 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 21:03:31,412 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-24 21:03:31,412 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-24 21:04:04,625 - INFO -  step: 1240  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,578  tflops: 20.15  mfu: 6.46%
[rank2]:2025-10-24 21:04:04,625 - INFO -  step: 1240  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,578  tflops: 20.15  mfu: 6.46%
[rank0]:2025-10-24 21:04:04,626 - INFO -  step: 1240  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,578  tflops: 20.15  mfu: 6.46%
[rank3]:2025-10-24 21:04:07,154 - INFO -  step: 1240  loss:  0.9930  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,575  tflops: 20.13  mfu: 6.45%
[rank3]:2025-10-24 21:04:08,447 - INFO - Avg. fwd time: 76.7775 / Avg. bwd time: 77.0307 / Avg. batch time: 1279.0097 (ms) / GPU bubble ratio: 3.80%
[rank2]:2025-10-24 21:04:08,486 - INFO - Avg. fwd time: 34.9801 / Avg. bwd time: 41.2514 / Avg. batch time: 1469.7747 (ms) / GPU bubble ratio: 58.51%
[rank1]:2025-10-24 21:04:08,538 - INFO - Avg. fwd time: 54.6833 / Avg. bwd time: 43.8435 / Avg. batch time: 1563.3609 (ms) / GPU bubble ratio: 49.58%
[rank0]:2025-10-24 21:04:08,548 - INFO - Avg. fwd time: 47.8795 / Avg. bwd time: 10.0046 / Avg. batch time: 1613.3467 (ms) / GPU bubble ratio: 71.30%
[rank0]:2025-10-24 21:05:02,301 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-24 21:06:11,803 - INFO -  step: 1260  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,577  tflops: 20.14  mfu: 6.46%
[rank2]:2025-10-24 21:06:11,802 - INFO -  step: 1260  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,577  tflops: 20.14  mfu: 6.46%
[rank0]:2025-10-24 21:06:11,802 - INFO -  step: 1260  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,577  tflops: 20.14  mfu: 6.46%
[rank3]:2025-10-24 21:06:14,208 - INFO -  step: 1260  loss:  1.0717  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,579  tflops: 20.16  mfu: 6.46%
[rank3]:2025-10-24 21:06:15,512 - INFO - Avg. fwd time: 76.7754 / Avg. bwd time: 76.9495 / Avg. batch time: 1278.3370 (ms) / GPU bubble ratio: 3.80%
[rank2]:2025-10-24 21:06:15,553 - INFO - Avg. fwd time: 34.9802 / Avg. bwd time: 41.0655 / Avg. batch time: 1468.9871 (ms) / GPU bubble ratio: 58.59%
[rank1]:2025-10-24 21:06:15,602 - INFO - Avg. fwd time: 54.6945 / Avg. bwd time: 43.7713 / Avg. batch time: 1562.4593 (ms) / GPU bubble ratio: 49.58%
[rank0]:2025-10-24 21:06:15,612 - INFO - Avg. fwd time: 47.8806 / Avg. bwd time: 9.8458 / Avg. batch time: 1612.2453 (ms) / GPU bubble ratio: 71.36%
[rank2]:2025-10-24 21:08:19,287 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251024_2108_rank2_trend_line.svg
[rank1]:2025-10-24 21:08:19,332 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251024_2108_rank1_trend_line.svg
[rank3]:2025-10-24 21:08:19,295 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251024_2108_rank3_trend_line.svg
[rank2]:2025-10-24 21:08:19,354 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-24 21:08:19,357 - INFO -  step: 1280  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,569  tflops: 20.08  mfu: 6.44%
[rank0]:2025-10-24 21:08:19,347 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251024_2108_rank0_trend_line.svg
[rank0]:2025-10-24 21:08:19,354 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-24 21:08:19,358 - INFO -  step: 1280  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,569  tflops: 20.08  mfu: 6.44%
[rank1]:2025-10-24 21:08:19,354 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-10-24 21:08:19,357 - INFO -  step: 1280  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,569  tflops: 20.08  mfu: 6.44%
[rank3]:2025-10-24 21:08:19,573 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/pipeline_schedule/251024_2108_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 1381.33 ms, GPU Bubble Ratio: 69.16%, 43.93%, 57.12%, 13.13%
[rank3]:2025-10-24 21:08:19,574 - INFO - 	> Batch Time: 1381.33 ms (Average Freeze Ratio: 0.34)
[rank3]:2025-10-24 21:08:19,575 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-24 21:08:21,977 - INFO -  step: 1280  loss:  1.0793  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,565  tflops: 20.05  mfu: 6.43%
[rank3]:2025-10-24 21:08:23,264 - INFO - Avg. fwd time: 76.7742 / Avg. bwd time: 76.8683 / Avg. batch time: 1277.6676 (ms) / GPU bubble ratio: 3.80%
[rank2]:2025-10-24 21:08:23,304 - INFO - Avg. fwd time: 34.9817 / Avg. bwd time: 40.8849 / Avg. batch time: 1468.2269 (ms) / GPU bubble ratio: 58.66%
[rank0]:2025-10-24 21:08:23,362 - INFO - Avg. fwd time: 47.8825 / Avg. bwd time: 9.6920 / Avg. batch time: 1611.1699 (ms) / GPU bubble ratio: 71.41%
[rank1]:2025-10-24 21:08:23,352 - INFO - Avg. fwd time: 54.6973 / Avg. bwd time: 43.7003 / Avg. batch time: 1561.5795 (ms) / GPU bubble ratio: 49.59%
[rank0]:2025-10-24 21:10:20,698 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-24 21:10:26,579 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,576  tflops: 20.14  mfu: 6.45%
[rank1]:2025-10-24 21:10:26,579 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,576  tflops: 20.14  mfu: 6.45%
[rank0]:2025-10-24 21:10:26,579 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,576  tflops: 20.14  mfu: 6.45%
[rank3]:2025-10-24 21:10:28,977 - INFO -  step: 1300  loss:  1.0223  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,580  tflops: 20.17  mfu: 6.47%
[rank2]:2025-10-24 21:10:29,057 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251024_2110_stage2_step1300.svg
[rank1]:2025-10-24 21:10:29,057 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251024_2110_stage1_step1300.svg
[rank0]:2025-10-24 21:10:29,057 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251024_2110_stage0_step1300.svg
[rank3]:2025-10-24 21:10:29,197 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/pipeline_schedule/251024_2110_real_step1300_rank3.svg
[rank3]:> Batch Time: 1380.75 ms, GPU Bubble Ratio: 72.04%, 45.24%, 62.80%, 13.29%
[rank3]:2025-10-24 21:10:29,260 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251024_2110_stage3_step1300.svg
[rank3]:2025-10-24 21:10:30,556 - INFO - Avg. fwd time: 76.7760 / Avg. bwd time: 76.7892 / Avg. batch time: 1277.0330 (ms) / GPU bubble ratio: 3.80%
[rank2]:2025-10-24 21:10:30,595 - INFO - Avg. fwd time: 34.9833 / Avg. bwd time: 40.7096 / Avg. batch time: 1467.0556 (ms) / GPU bubble ratio: 58.72%
[rank1]:2025-10-24 21:10:30,643 - INFO - Avg. fwd time: 54.6970 / Avg. bwd time: 43.6332 / Avg. batch time: 1560.2918 (ms) / GPU bubble ratio: 49.58%
[rank0]:2025-10-24 21:10:30,653 - INFO - Avg. fwd time: 47.8852 / Avg. bwd time: 9.5430 / Avg. batch time: 1609.6952 (ms) / GPU bubble ratio: 71.46%
[rank2]:2025-10-24 21:12:16,225 - WARNING - Dataset alpaca is being re-looped
[rank3]:2025-10-24 21:12:16,216 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-24 21:12:16,266 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 21:12:16,265 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 21:12:33,884 - INFO -  step: 1320  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,574  tflops: 20.12  mfu: 6.45%
[rank1]:2025-10-24 21:12:33,884 - INFO -  step: 1320  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,574  tflops: 20.12  mfu: 6.45%
[rank2]:2025-10-24 21:12:33,884 - INFO -  step: 1320  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,574  tflops: 20.12  mfu: 6.45%
[rank3]:2025-10-24 21:12:36,288 - INFO -  step: 1320  loss:  0.9677  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,574  tflops: 20.12  mfu: 6.45%
[rank3]:2025-10-24 21:12:37,589 - INFO - Avg. fwd time: 76.7745 / Avg. bwd time: 76.7187 / Avg. batch time: 1276.4363 (ms) / GPU bubble ratio: 3.80%
[rank2]:2025-10-24 21:12:37,630 - INFO - Avg. fwd time: 34.9858 / Avg. bwd time: 40.5409 / Avg. batch time: 1466.3363 (ms) / GPU bubble ratio: 58.79%
[rank1]:2025-10-24 21:12:37,682 - INFO - Avg. fwd time: 54.7023 / Avg. bwd time: 43.5672 / Avg. batch time: 1559.4642 (ms) / GPU bubble ratio: 49.59%
[rank0]:2025-10-24 21:12:37,693 - INFO - Avg. fwd time: 47.8921 / Avg. bwd time: 9.3985 / Avg. batch time: 1608.6889 (ms) / GPU bubble ratio: 71.51%
[rank1]:2025-10-24 21:14:41,099 - INFO -  step: 1340  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,576  tflops: 20.14  mfu: 6.45%
[rank2]:2025-10-24 21:14:41,098 - INFO -  step: 1340  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,576  tflops: 20.14  mfu: 6.45%
[rank0]:2025-10-24 21:14:41,099 - INFO -  step: 1340  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,576  tflops: 20.14  mfu: 6.45%
[rank3]:2025-10-24 21:14:43,498 - INFO -  step: 1340  loss:  1.0025  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,576  tflops: 20.14  mfu: 6.45%
[rank3]:2025-10-24 21:14:44,790 - INFO - Avg. fwd time: 76.7691 / Avg. bwd time: 76.6486 / Avg. batch time: 1275.8229 (ms) / GPU bubble ratio: 3.80%
[rank1]:2025-10-24 21:14:44,881 - INFO - Avg. fwd time: 54.7165 / Avg. bwd time: 43.5047 / Avg. batch time: 1558.6728 (ms) / GPU bubble ratio: 49.59%
[rank2]:2025-10-24 21:14:44,832 - INFO - Avg. fwd time: 34.9853 / Avg. bwd time: 40.3773 / Avg. batch time: 1465.6482 (ms) / GPU bubble ratio: 58.86%
[rank0]:2025-10-24 21:14:44,893 - INFO - Avg. fwd time: 47.8957 / Avg. bwd time: 9.2582 / Avg. batch time: 1607.7218 (ms) / GPU bubble ratio: 71.56%
[rank0]:2025-10-24 21:15:38,748 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-24 21:16:48,043 - INFO -  step: 1360  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,581  tflops: 20.18  mfu: 6.47%
[rank2]:2025-10-24 21:16:48,042 - INFO -  step: 1360  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,581  tflops: 20.18  mfu: 6.47%
[rank0]:2025-10-24 21:16:48,043 - INFO -  step: 1360  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,581  tflops: 20.18  mfu: 6.47%
[rank3]:2025-10-24 21:16:50,443 - INFO -  step: 1360  loss:  1.0496  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,581  tflops: 20.18  mfu: 6.47%
[rank3]:2025-10-24 21:16:51,735 - INFO - Avg. fwd time: 76.7669 / Avg. bwd time: 76.5762 / Avg. batch time: 1275.2179 (ms) / GPU bubble ratio: 3.80%
[rank2]:2025-10-24 21:16:51,777 - INFO - Avg. fwd time: 34.9850 / Avg. bwd time: 40.2185 / Avg. batch time: 1464.9249 (ms) / GPU bubble ratio: 58.93%
[rank1]:2025-10-24 21:16:51,826 - INFO - Avg. fwd time: 54.7227 / Avg. bwd time: 43.4437 / Avg. batch time: 1557.8491 (ms) / GPU bubble ratio: 49.59%
[rank0]:2025-10-24 21:16:51,837 - INFO - Avg. fwd time: 47.8965 / Avg. bwd time: 9.1221 / Avg. batch time: 1606.7299 (ms) / GPU bubble ratio: 71.61%
[rank0]:2025-10-24 21:18:54,987 - INFO -  step: 1380  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,581  tflops: 20.18  mfu: 6.47%
[rank1]:2025-10-24 21:18:54,987 - INFO -  step: 1380  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,581  tflops: 20.18  mfu: 6.47%
[rank2]:2025-10-24 21:18:54,987 - INFO -  step: 1380  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,581  tflops: 20.18  mfu: 6.47%
[rank3]:2025-10-24 21:18:57,395 - INFO -  step: 1380  loss:  1.0620  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,581  tflops: 20.18  mfu: 6.47%
[rank3]:2025-10-24 21:18:58,700 - INFO - Avg. fwd time: 76.7658 / Avg. bwd time: 76.5050 / Avg. batch time: 1274.6316 (ms) / GPU bubble ratio: 3.80%
[rank2]:2025-10-24 21:18:58,741 - INFO - Avg. fwd time: 34.9845 / Avg. bwd time: 40.0638 / Avg. batch time: 1464.2297 (ms) / GPU bubble ratio: 59.00%
[rank0]:2025-10-24 21:18:58,802 - INFO - Avg. fwd time: 47.8987 / Avg. bwd time: 8.9900 / Avg. batch time: 1605.7721 (ms) / GPU bubble ratio: 71.66%
[rank1]:2025-10-24 21:18:58,791 - INFO - Avg. fwd time: 54.7196 / Avg. bwd time: 43.3827 / Avg. batch time: 1557.0539 (ms) / GPU bubble ratio: 49.60%
[rank0]:2025-10-24 21:20:56,153 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-24 21:20:56,874 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-24 21:20:57,684 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-24 21:20:57,642 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 21:20:57,685 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 21:21:02,063 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,579  tflops: 20.16  mfu: 6.46%
[rank1]:2025-10-24 21:21:02,063 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,579  tflops: 20.16  mfu: 6.46%
[rank2]:2025-10-24 21:21:02,063 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,579  tflops: 20.16  mfu: 6.46%
[rank3]:2025-10-24 21:21:04,468 - INFO -  step: 1400  loss:  0.9944  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,579  tflops: 20.16  mfu: 6.46%
[rank0]:2025-10-24 21:21:04,566 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251024_2121_stage0_step1400.svg
[rank1]:2025-10-24 21:21:04,566 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251024_2121_stage1_step1400.svg
[rank2]:2025-10-24 21:21:04,579 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251024_2121_stage2_step1400.svg
[rank3]:2025-10-24 21:21:04,689 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/pipeline_schedule/251024_2121_real_step1400_rank3.svg
[rank3]:> Batch Time: 1380.61 ms, GPU Bubble Ratio: 72.04%, 45.23%, 62.82%, 13.29%
[rank3]:2025-10-24 21:21:04,755 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251024_2121_stage3_step1400.svg
[rank3]:2025-10-24 21:21:06,023 - INFO - Avg. fwd time: 76.7632 / Avg. bwd time: 76.4394 / Avg. batch time: 1274.0683 (ms) / GPU bubble ratio: 3.80%
[rank2]:2025-10-24 21:21:06,063 - INFO - Avg. fwd time: 34.9857 / Avg. bwd time: 39.9138 / Avg. batch time: 1463.1641 (ms) / GPU bubble ratio: 59.05%
[rank0]:2025-10-24 21:21:06,122 - INFO - Avg. fwd time: 47.9039 / Avg. bwd time: 8.8616 / Avg. batch time: 1604.4574 (ms) / GPU bubble ratio: 71.70%
[rank1]:2025-10-24 21:21:06,111 - INFO - Avg. fwd time: 54.7204 / Avg. bwd time: 43.3230 / Avg. batch time: 1555.8996 (ms) / GPU bubble ratio: 49.59%
[rank0]:2025-10-24 21:23:09,784 - INFO -  step: 1420  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,566  tflops: 20.06  mfu: 6.43%
[rank2]:2025-10-24 21:23:09,783 - INFO -  step: 1420  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,566  tflops: 20.06  mfu: 6.43%
[rank1]:2025-10-24 21:23:09,784 - INFO -  step: 1420  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,566  tflops: 20.06  mfu: 6.43%
[rank3]:2025-10-24 21:23:12,180 - INFO -  step: 1420  loss:  1.0219  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,566  tflops: 20.06  mfu: 6.43%
[rank3]:2025-10-24 21:23:13,483 - INFO - Avg. fwd time: 76.7631 / Avg. bwd time: 76.3807 / Avg. batch time: 1273.5707 (ms) / GPU bubble ratio: 3.80%
[rank2]:2025-10-24 21:23:13,524 - INFO - Avg. fwd time: 34.9845 / Avg. bwd time: 39.7679 / Avg. batch time: 1462.6043 (ms) / GPU bubble ratio: 59.11%
[rank1]:2025-10-24 21:23:13,573 - INFO - Avg. fwd time: 54.7279 / Avg. bwd time: 43.2661 / Avg. batch time: 1555.2511 (ms) / GPU bubble ratio: 49.59%
[rank0]:2025-10-24 21:23:13,585 - INFO - Avg. fwd time: 47.9092 / Avg. bwd time: 8.7369 / Avg. batch time: 1603.6559 (ms) / GPU bubble ratio: 71.74%
[rank0]:2025-10-24 21:25:17,067 - INFO -  step: 1440  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,574  tflops: 20.13  mfu: 6.45%
[rank2]:2025-10-24 21:25:17,066 - INFO -  step: 1440  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,574  tflops: 20.13  mfu: 6.45%
[rank1]:2025-10-24 21:25:17,066 - INFO -  step: 1440  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,574  tflops: 20.13  mfu: 6.45%
[rank3]:2025-10-24 21:25:19,470 - INFO -  step: 1440  loss:  1.0682  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,574  tflops: 20.12  mfu: 6.45%
[rank3]:2025-10-24 21:25:20,772 - INFO - Avg. fwd time: 76.7623 / Avg. bwd time: 76.3234 / Avg. batch time: 1273.0842 (ms) / GPU bubble ratio: 3.80%
[rank2]:2025-10-24 21:25:20,813 - INFO - Avg. fwd time: 34.9842 / Avg. bwd time: 39.6263 / Avg. batch time: 1462.0262 (ms) / GPU bubble ratio: 59.17%
[rank0]:2025-10-24 21:25:20,876 - INFO - Avg. fwd time: 47.9152 / Avg. bwd time: 8.6156 / Avg. batch time: 1602.8447 (ms) / GPU bubble ratio: 71.78%
[rank1]:2025-10-24 21:25:20,864 - INFO - Avg. fwd time: 54.7356 / Avg. bwd time: 43.2106 / Avg. batch time: 1554.5895 (ms) / GPU bubble ratio: 49.60%
[rank0]:2025-10-24 21:26:14,726 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-24 21:27:24,186 - INFO -  step: 1460  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,578  tflops: 20.15  mfu: 6.46%
[rank1]:2025-10-24 21:27:24,186 - INFO -  step: 1460  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,578  tflops: 20.15  mfu: 6.46%
[rank2]:2025-10-24 21:27:24,185 - INFO -  step: 1460  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,578  tflops: 20.15  mfu: 6.46%
[rank3]:2025-10-24 21:27:26,589 - INFO -  step: 1460  loss:  1.0434  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,578  tflops: 20.15  mfu: 6.46%
[rank2]:2025-10-24 21:27:27,932 - INFO - Avg. fwd time: 34.9849 / Avg. bwd time: 39.4880 / Avg. batch time: 1461.4448 (ms) / GPU bubble ratio: 59.23%
[rank3]:2025-10-24 21:27:27,890 - INFO - Avg. fwd time: 76.7619 / Avg. bwd time: 76.2647 / Avg. batch time: 1272.5933 (ms) / GPU bubble ratio: 3.80%
[rank0]:2025-10-24 21:27:27,994 - INFO - Avg. fwd time: 47.9175 / Avg. bwd time: 8.4976 / Avg. batch time: 1602.0314 (ms) / GPU bubble ratio: 71.83%
[rank1]:2025-10-24 21:27:27,982 - INFO - Avg. fwd time: 54.7371 / Avg. bwd time: 43.1564 / Avg. batch time: 1553.9232 (ms) / GPU bubble ratio: 49.60%
[rank0]:2025-10-24 21:29:31,141 - INFO -  step: 1480  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,581  tflops: 20.18  mfu: 6.47%
[rank1]:2025-10-24 21:29:31,141 - INFO -  step: 1480  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,581  tflops: 20.18  mfu: 6.47%
[rank2]:2025-10-24 21:29:31,140 - INFO -  step: 1480  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,581  tflops: 20.18  mfu: 6.47%
[rank3]:2025-10-24 21:29:33,643 - INFO -  step: 1480  loss:  1.0057  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,579  tflops: 20.16  mfu: 6.46%
[rank3]:2025-10-24 21:29:34,945 - INFO - Avg. fwd time: 76.7603 / Avg. bwd time: 76.2077 / Avg. batch time: 1272.1094 (ms) / GPU bubble ratio: 3.80%
[rank2]:2025-10-24 21:29:34,987 - INFO - Avg. fwd time: 34.9838 / Avg. bwd time: 39.3534 / Avg. batch time: 1460.8802 (ms) / GPU bubble ratio: 59.29%
[rank0]:2025-10-24 21:29:35,050 - INFO - Avg. fwd time: 47.9189 / Avg. bwd time: 8.3828 / Avg. batch time: 1601.2412 (ms) / GPU bubble ratio: 71.87%
[rank1]:2025-10-24 21:29:35,038 - INFO - Avg. fwd time: 54.7406 / Avg. bwd time: 43.1031 / Avg. batch time: 1553.2747 (ms) / GPU bubble ratio: 49.61%
[rank3]:2025-10-24 21:29:41,656 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-24 21:29:42,406 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 21:29:42,447 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-24 21:29:42,449 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 21:31:32,220 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-24 21:31:38,091 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,581  tflops: 20.18  mfu: 6.47%
[rank2]:2025-10-24 21:31:38,091 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-24 21:31:38,091 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,581  tflops: 20.18  mfu: 6.47%
[rank0]:2025-10-24 21:31:38,092 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-24 21:31:38,093 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank1]:2025-10-24 21:31:38,091 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,581  tflops: 20.18  mfu: 6.47%
[rank1]:2025-10-24 21:31:38,091 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-24 21:31:39,909 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 1.82 seconds.
[rank1]:2025-10-24 21:31:40,351 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 2.26 seconds.
[rank3]:2025-10-24 21:31:40,706 - INFO -  step: 1500  loss:  1.0110  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,579  tflops: 20.16  mfu: 6.46%
[rank3]:2025-10-24 21:31:40,707 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-24 21:31:41,690 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-24 21:31:41,698 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.61 seconds.
[rank0]:2025-10-24 21:31:41,698 - INFO - Checkpointer is deleting /data2/shcho/torchtitan/checkpoint/1023_GPipe_timelyapf_dm1/step-500.
[rank0]:2025-10-24 21:31:43,704 - INFO - Checkpointer deleted /data2/shcho/torchtitan/checkpoint/1023_GPipe_timelyapf_dm1/step-500 in 2.00 seconds.
[rank3]:2025-10-24 21:31:43,930 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.22 seconds.
[rank0]:2025-10-24 21:31:44,030 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251024_2131_stage0_step1500.svg
[rank1]:2025-10-24 21:31:44,029 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251024_2131_stage1_step1500.svg
[rank2]:2025-10-24 21:31:44,030 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251024_2131_stage2_step1500.svg
[rank3]:2025-10-24 21:31:44,309 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/pipeline_schedule/251024_2131_real_step1500_rank3.svg
[rank3]:> Batch Time: 1380.41 ms, GPU Bubble Ratio: 72.03%, 45.24%, 62.84%, 13.28%
[rank3]:2025-10-24 21:31:44,416 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251024_2131_stage3_step1500.svg
[rank3]:2025-10-24 21:31:45,709 - INFO - Avg. fwd time: 76.7598 / Avg. bwd time: 76.1508 / Avg. batch time: 1271.6277 (ms) / GPU bubble ratio: 3.80%
[rank2]:2025-10-24 21:31:45,750 - INFO - Avg. fwd time: 34.9835 / Avg. bwd time: 39.2224 / Avg. batch time: 1459.9641 (ms) / GPU bubble ratio: 59.34%
[rank0]:2025-10-24 21:31:45,814 - INFO - Avg. fwd time: 47.9213 / Avg. bwd time: 8.2711 / Avg. batch time: 1600.1004 (ms) / GPU bubble ratio: 71.91%
[rank1]:2025-10-24 21:31:45,801 - INFO - Avg. fwd time: 54.7360 / Avg. bwd time: 43.0512 / Avg. batch time: 1552.2725 (ms) / GPU bubble ratio: 49.60%
[rank2]:2025-10-24 21:33:50,526 - INFO -  step: 1520  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,474  tflops: 19.34  mfu: 6.20%
[rank0]:2025-10-24 21:33:50,527 - INFO -  step: 1520  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,474  tflops: 19.34  mfu: 6.20%
[rank1]:2025-10-24 21:33:50,526 - INFO -  step: 1520  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,474  tflops: 19.34  mfu: 6.20%
[rank3]:2025-10-24 21:33:53,120 - INFO -  step: 1520  loss:  1.0592  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,475  tflops: 19.35  mfu: 6.20%
[rank2]:2025-10-24 21:33:54,469 - INFO - Avg. fwd time: 34.9845 / Avg. bwd time: 39.0958 / Avg. batch time: 1459.6896 (ms) / GPU bubble ratio: 59.40%
[rank3]:2025-10-24 21:33:54,427 - INFO - Avg. fwd time: 76.7577 / Avg. bwd time: 76.0973 / Avg. batch time: 1271.1703 (ms) / GPU bubble ratio: 3.80%
[rank1]:2025-10-24 21:33:54,521 - INFO - Avg. fwd time: 54.7386 / Avg. bwd time: 43.0025 / Avg. batch time: 1551.9204 (ms) / GPU bubble ratio: 49.62%
[rank0]:2025-10-24 21:33:54,533 - INFO - Avg. fwd time: 47.9250 / Avg. bwd time: 8.1623 / Avg. batch time: 1599.6131 (ms) / GPU bubble ratio: 71.95%
[rank2]:2025-10-24 21:35:58,476 - INFO -  step: 1540  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,561  tflops: 20.02  mfu: 6.42%
[rank1]:2025-10-24 21:35:58,476 - INFO -  step: 1540  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,561  tflops: 20.02  mfu: 6.42%
[rank0]:2025-10-24 21:35:58,477 - INFO -  step: 1540  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,561  tflops: 20.02  mfu: 6.42%
[rank3]:2025-10-24 21:36:01,128 - INFO -  step: 1540  loss:  1.0232  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,560  tflops: 20.01  mfu: 6.41%
[rank3]:2025-10-24 21:36:02,427 - INFO - Avg. fwd time: 76.7577 / Avg. bwd time: 76.0447 / Avg. batch time: 1270.7292 (ms) / GPU bubble ratio: 3.80%
[rank2]:2025-10-24 21:36:02,469 - INFO - Avg. fwd time: 34.9841 / Avg. bwd time: 38.9722 / Avg. batch time: 1459.3154 (ms) / GPU bubble ratio: 59.46%
[rank1]:2025-10-24 21:36:02,520 - INFO - Avg. fwd time: 54.7443 / Avg. bwd time: 42.9548 / Avg. batch time: 1551.4760 (ms) / GPU bubble ratio: 49.62%
[rank0]:2025-10-24 21:36:02,532 - INFO - Avg. fwd time: 47.9265 / Avg. bwd time: 8.0563 / Avg. batch time: 1599.0376 (ms) / GPU bubble ratio: 71.99%
[rank0]:2025-10-24 21:36:56,727 - INFO - [GC] Peforming periodical GC collection 0.25 seconds
[rank2]:2025-10-24 21:38:06,587 - INFO -  step: 1560  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,558  tflops: 20.00  mfu: 6.41%
[rank1]:2025-10-24 21:38:06,587 - INFO -  step: 1560  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,558  tflops: 20.00  mfu: 6.41%
[rank0]:2025-10-24 21:38:06,588 - INFO -  step: 1560  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,558  tflops: 20.00  mfu: 6.41%
[rank3]:2025-10-24 21:38:09,203 - INFO -  step: 1560  loss:  1.0362  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,559  tflops: 20.00  mfu: 6.41%
[rank3]:2025-10-24 21:38:10,500 - INFO - Avg. fwd time: 76.7572 / Avg. bwd time: 75.9903 / Avg. batch time: 1270.2792 (ms) / GPU bubble ratio: 3.80%
[rank2]:2025-10-24 21:38:10,542 - INFO - Avg. fwd time: 34.9865 / Avg. bwd time: 38.8517 / Avg. batch time: 1458.9241 (ms) / GPU bubble ratio: 59.51%
[rank1]:2025-10-24 21:38:10,592 - INFO - Avg. fwd time: 54.7440 / Avg. bwd time: 42.9072 / Avg. batch time: 1551.0094 (ms) / GPU bubble ratio: 49.63%
[rank0]:2025-10-24 21:38:10,605 - INFO - Avg. fwd time: 47.9269 / Avg. bwd time: 7.9531 / Avg. batch time: 1598.4405 (ms) / GPU bubble ratio: 72.03%
[rank3]:2025-10-24 21:38:32,584 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-24 21:38:32,640 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-24 21:38:32,600 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 21:38:32,640 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-24 21:40:14,048 - INFO -  step: 1580  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,571  tflops: 20.10  mfu: 6.44%
[rank0]:2025-10-24 21:40:14,048 - INFO -  step: 1580  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,571  tflops: 20.10  mfu: 6.44%
[rank1]:2025-10-24 21:40:14,048 - INFO -  step: 1580  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,571  tflops: 20.10  mfu: 6.44%
[rank3]:2025-10-24 21:40:16,555 - INFO -  step: 1580  loss:  1.0003  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,573  tflops: 20.12  mfu: 6.45%
[rank3]:2025-10-24 21:40:17,850 - INFO - Avg. fwd time: 76.7542 / Avg. bwd time: 75.9372 / Avg. batch time: 1269.8202 (ms) / GPU bubble ratio: 3.80%
[rank2]:2025-10-24 21:40:17,892 - INFO - Avg. fwd time: 34.9865 / Avg. bwd time: 38.7342 / Avg. batch time: 1458.4693 (ms) / GPU bubble ratio: 59.56%
[rank0]:2025-10-24 21:40:17,956 - INFO - Avg. fwd time: 47.9268 / Avg. bwd time: 7.8525 / Avg. batch time: 1597.7890 (ms) / GPU bubble ratio: 72.07%
[rank1]:2025-10-24 21:40:17,943 - INFO - Avg. fwd time: 54.7510 / Avg. bwd time: 42.8603 / Avg. batch time: 1550.4858 (ms) / GPU bubble ratio: 49.64%
[rank0]:2025-10-24 21:42:15,591 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-24 21:42:21,471 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,572  tflops: 20.10  mfu: 6.44%
[rank1]:2025-10-24 21:42:21,471 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,572  tflops: 20.10  mfu: 6.44%
[rank0]:2025-10-24 21:42:21,472 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,572  tflops: 20.10  mfu: 6.44%
[rank3]:2025-10-24 21:42:23,978 - INFO -  step: 1600  loss:  1.0510  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,572  tflops: 20.10  mfu: 6.44%
[rank0]:2025-10-24 21:42:24,067 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251024_2142_stage0_step1600.svg
[rank2]:2025-10-24 21:42:24,066 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251024_2142_stage2_step1600.svg
[rank1]:2025-10-24 21:42:24,066 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251024_2142_stage1_step1600.svg
[rank3]:2025-10-24 21:42:24,205 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/pipeline_schedule/251024_2142_real_step1600_rank3.svg
[rank3]:> Batch Time: 1380.24 ms, GPU Bubble Ratio: 72.03%, 45.24%, 62.84%, 13.27%
[rank3]:2025-10-24 21:42:24,275 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251024_2142_stage3_step1600.svg
[rank3]:2025-10-24 21:42:25,581 - INFO - Avg. fwd time: 76.7514 / Avg. bwd time: 75.8910 / Avg. batch time: 1269.4100 (ms) / GPU bubble ratio: 3.80%
[rank2]:2025-10-24 21:42:25,623 - INFO - Avg. fwd time: 34.9867 / Avg. bwd time: 38.6199 / Avg. batch time: 1457.6784 (ms) / GPU bubble ratio: 59.60%
[rank1]:2025-10-24 21:42:25,673 - INFO - Avg. fwd time: 54.7539 / Avg. bwd time: 42.8151 / Avg. batch time: 1549.6248 (ms) / GPU bubble ratio: 49.63%
[rank0]:2025-10-24 21:42:25,685 - INFO - Avg. fwd time: 47.9279 / Avg. bwd time: 7.7543 / Avg. batch time: 1596.8048 (ms) / GPU bubble ratio: 72.10%
[rank2]:2025-10-24 21:44:29,118 - INFO -  step: 1620  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,567  tflops: 20.07  mfu: 6.43%
[rank0]:2025-10-24 21:44:29,119 - INFO -  step: 1620  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,567  tflops: 20.07  mfu: 6.43%
[rank1]:2025-10-24 21:44:29,119 - INFO -  step: 1620  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,567  tflops: 20.07  mfu: 6.43%
[rank3]:2025-10-24 21:44:31,621 - INFO -  step: 1620  loss:  1.0345  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,567  tflops: 20.07  mfu: 6.43%
[rank3]:2025-10-24 21:44:32,932 - INFO - Avg. fwd time: 76.7491 / Avg. bwd time: 75.8432 / Avg. batch time: 1269.0050 (ms) / GPU bubble ratio: 3.80%
[rank2]:2025-10-24 21:44:32,974 - INFO - Avg. fwd time: 34.9865 / Avg. bwd time: 38.5086 / Avg. batch time: 1457.2507 (ms) / GPU bubble ratio: 59.65%
[rank0]:2025-10-24 21:44:33,038 - INFO - Avg. fwd time: 47.9287 / Avg. bwd time: 7.6586 / Avg. batch time: 1596.1922 (ms) / GPU bubble ratio: 72.14%
[rank1]:2025-10-24 21:44:33,025 - INFO - Avg. fwd time: 54.7631 / Avg. bwd time: 42.7714 / Avg. batch time: 1549.1304 (ms) / GPU bubble ratio: 49.63%
[rank0]:2025-10-24 21:46:36,411 - INFO -  step: 1640  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,574  tflops: 20.12  mfu: 6.45%
[rank2]:2025-10-24 21:46:36,410 - INFO -  step: 1640  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,574  tflops: 20.12  mfu: 6.45%
[rank1]:2025-10-24 21:46:36,411 - INFO -  step: 1640  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,574  tflops: 20.12  mfu: 6.45%
[rank3]:2025-10-24 21:46:38,913 - INFO -  step: 1640  loss:  1.0473  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,574  tflops: 20.12  mfu: 6.45%
[rank2]:2025-10-24 21:46:40,256 - INFO - Avg. fwd time: 34.9878 / Avg. bwd time: 38.3994 / Avg. batch time: 1456.8306 (ms) / GPU bubble ratio: 59.70%
[rank3]:2025-10-24 21:46:40,214 - INFO - Avg. fwd time: 76.7488 / Avg. bwd time: 75.7958 / Avg. batch time: 1268.6079 (ms) / GPU bubble ratio: 3.80%
[rank1]:2025-10-24 21:46:40,308 - INFO - Avg. fwd time: 54.7618 / Avg. bwd time: 42.7289 / Avg. batch time: 1548.6412 (ms) / GPU bubble ratio: 49.64%
[rank0]:2025-10-24 21:46:40,323 - INFO - Avg. fwd time: 47.9288 / Avg. bwd time: 7.5653 / Avg. batch time: 1595.5861 (ms) / GPU bubble ratio: 72.18%
[rank3]:2025-10-24 21:47:17,248 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-24 21:47:18,004 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-24 21:47:18,048 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 21:47:18,046 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 21:47:34,205 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-24 21:48:43,614 - INFO -  step: 1660  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,576  tflops: 20.14  mfu: 6.45%
[rank1]:2025-10-24 21:48:43,615 - INFO -  step: 1660  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,576  tflops: 20.14  mfu: 6.45%
[rank0]:2025-10-24 21:48:43,615 - INFO -  step: 1660  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,576  tflops: 20.14  mfu: 6.45%
[rank3]:2025-10-24 21:48:46,280 - INFO -  step: 1660  loss:  0.9758  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,573  tflops: 20.11  mfu: 6.45%
[rank3]:2025-10-24 21:48:47,583 - INFO - Avg. fwd time: 76.7475 / Avg. bwd time: 75.7482 / Avg. batch time: 1268.2037 (ms) / GPU bubble ratio: 3.80%
[rank2]:2025-10-24 21:48:47,626 - INFO - Avg. fwd time: 34.9886 / Avg. bwd time: 38.2931 / Avg. batch time: 1456.4318 (ms) / GPU bubble ratio: 59.75%
[rank1]:2025-10-24 21:48:47,677 - INFO - Avg. fwd time: 54.7668 / Avg. bwd time: 42.6880 / Avg. batch time: 1548.1772 (ms) / GPU bubble ratio: 49.64%
[rank0]:2025-10-24 21:48:47,690 - INFO - Avg. fwd time: 47.9294 / Avg. bwd time: 7.4742 / Avg. batch time: 1595.0091 (ms) / GPU bubble ratio: 72.21%
[rank2]:2025-10-24 21:50:51,277 - INFO -  step: 1680  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,567  tflops: 20.07  mfu: 6.43%
[rank1]:2025-10-24 21:50:51,278 - INFO -  step: 1680  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,567  tflops: 20.07  mfu: 6.43%
[rank0]:2025-10-24 21:50:51,278 - INFO -  step: 1680  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,567  tflops: 20.07  mfu: 6.43%
[rank3]:2025-10-24 21:50:53,778 - INFO -  step: 1680  loss:  1.0145  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,570  tflops: 20.09  mfu: 6.44%
[rank3]:2025-10-24 21:50:55,087 - INFO - Avg. fwd time: 76.7475 / Avg. bwd time: 75.7036 / Avg. batch time: 1267.8334 (ms) / GPU bubble ratio: 3.80%
[rank2]:2025-10-24 21:50:55,130 - INFO - Avg. fwd time: 34.9891 / Avg. bwd time: 38.1886 / Avg. batch time: 1456.0635 (ms) / GPU bubble ratio: 59.79%
[rank1]:2025-10-24 21:50:55,181 - INFO - Avg. fwd time: 54.7662 / Avg. bwd time: 42.6483 / Avg. batch time: 1547.7433 (ms) / GPU bubble ratio: 49.65%
[rank0]:2025-10-24 21:50:55,194 - INFO - Avg. fwd time: 47.9298 / Avg. bwd time: 7.3852 / Avg. batch time: 1594.4618 (ms) / GPU bubble ratio: 72.25%
[rank0]:2025-10-24 21:52:52,835 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-24 21:52:58,700 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,572  tflops: 20.10  mfu: 6.44%
[rank1]:2025-10-24 21:52:58,700 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,572  tflops: 20.10  mfu: 6.44%
[rank2]:2025-10-24 21:52:58,699 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,572  tflops: 20.10  mfu: 6.44%
[rank3]:2025-10-24 21:53:01,203 - INFO -  step: 1700  loss:  1.0355  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,572  tflops: 20.10  mfu: 6.44%
[rank1]:2025-10-24 21:53:01,289 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251024_2152_stage1_step1700.svg
[rank2]:2025-10-24 21:53:01,289 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251024_2152_stage2_step1700.svg
[rank0]:2025-10-24 21:53:01,289 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251024_2152_stage0_step1700.svg
[rank3]:2025-10-24 21:53:01,427 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/pipeline_schedule/251024_2153_real_step1700_rank3.svg
[rank3]:> Batch Time: 1380.27 ms, GPU Bubble Ratio: 72.04%, 45.22%, 62.86%, 13.26%
[rank3]:2025-10-24 21:53:01,494 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251024_2153_stage3_step1700.svg
[rank3]:2025-10-24 21:53:02,790 - INFO - Avg. fwd time: 76.7456 / Avg. bwd time: 75.6625 / Avg. batch time: 1267.4696 (ms) / GPU bubble ratio: 3.80%
[rank1]:2025-10-24 21:53:02,881 - INFO - Avg. fwd time: 54.7730 / Avg. bwd time: 42.6098 / Avg. batch time: 1546.9675 (ms) / GPU bubble ratio: 49.64%
[rank2]:2025-10-24 21:53:02,832 - INFO - Avg. fwd time: 34.9890 / Avg. bwd time: 38.0868 / Avg. batch time: 1455.3555 (ms) / GPU bubble ratio: 59.83%
[rank0]:2025-10-24 21:53:02,894 - INFO - Avg. fwd time: 47.9336 / Avg. bwd time: 7.2984 / Avg. batch time: 1593.5772 (ms) / GPU bubble ratio: 72.27%
[rank0]:2025-10-24 21:55:06,395 - INFO -  step: 1720  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,566  tflops: 20.06  mfu: 6.43%
[rank1]:2025-10-24 21:55:06,395 - INFO -  step: 1720  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,566  tflops: 20.06  mfu: 6.43%
[rank2]:2025-10-24 21:55:06,394 - INFO -  step: 1720  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,566  tflops: 20.06  mfu: 6.43%
[rank3]:2025-10-24 21:55:08,895 - INFO -  step: 1720  loss:  1.0643  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,566  tflops: 20.06  mfu: 6.43%
[rank3]:2025-10-24 21:55:10,182 - INFO - Avg. fwd time: 76.7458 / Avg. bwd time: 75.6201 / Avg. batch time: 1267.1153 (ms) / GPU bubble ratio: 3.80%
[rank2]:2025-10-24 21:55:10,226 - INFO - Avg. fwd time: 34.9885 / Avg. bwd time: 37.9875 / Avg. batch time: 1454.9906 (ms) / GPU bubble ratio: 59.88%
[rank0]:2025-10-24 21:55:10,291 - INFO - Avg. fwd time: 47.9358 / Avg. bwd time: 7.2136 / Avg. batch time: 1593.0473 (ms) / GPU bubble ratio: 72.30%
[rank1]:2025-10-24 21:55:10,277 - INFO - Avg. fwd time: 54.7739 / Avg. bwd time: 42.5721 / Avg. batch time: 1546.5414 (ms) / GPU bubble ratio: 49.64%
[rank3]:2025-10-24 21:56:00,504 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-24 21:56:01,293 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-24 21:56:01,253 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 21:56:01,293 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 21:57:13,554 - INFO -  step: 1740  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,577  tflops: 20.15  mfu: 6.46%
[rank2]:2025-10-24 21:57:13,553 - INFO -  step: 1740  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,577  tflops: 20.15  mfu: 6.46%
[rank1]:2025-10-24 21:57:13,554 - INFO -  step: 1740  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,577  tflops: 20.15  mfu: 6.46%
[rank3]:2025-10-24 21:57:16,217 - INFO -  step: 1740  loss:  1.0198  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,574  tflops: 20.12  mfu: 6.45%
[rank3]:2025-10-24 21:57:17,517 - INFO - Avg. fwd time: 76.7439 / Avg. bwd time: 75.5773 / Avg. batch time: 1266.7599 (ms) / GPU bubble ratio: 3.80%
[rank2]:2025-10-24 21:57:17,560 - INFO - Avg. fwd time: 34.9872 / Avg. bwd time: 37.8906 / Avg. batch time: 1454.6346 (ms) / GPU bubble ratio: 59.92%
[rank1]:2025-10-24 21:57:17,613 - INFO - Avg. fwd time: 54.7815 / Avg. bwd time: 42.5351 / Avg. batch time: 1546.1283 (ms) / GPU bubble ratio: 49.65%
[rank0]:2025-10-24 21:57:17,627 - INFO - Avg. fwd time: 47.9338 / Avg. bwd time: 7.1307 / Avg. batch time: 1592.5295 (ms) / GPU bubble ratio: 72.34%
[rank0]:2025-10-24 21:58:11,596 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-24 21:59:21,048 - INFO -  step: 1760  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,570  tflops: 20.09  mfu: 6.44%
[rank2]:2025-10-24 21:59:21,047 - INFO -  step: 1760  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,570  tflops: 20.09  mfu: 6.44%
[rank1]:2025-10-24 21:59:21,047 - INFO -  step: 1760  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,570  tflops: 20.09  mfu: 6.44%
[rank3]:2025-10-24 21:59:23,555 - INFO -  step: 1760  loss:  1.0310  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,573  tflops: 20.12  mfu: 6.45%
[rank3]:2025-10-24 21:59:24,796 - INFO - Avg. fwd time: 76.7419 / Avg. bwd time: 75.5353 / Avg. batch time: 1266.3922 (ms) / GPU bubble ratio: 3.80%
[rank1]:2025-10-24 21:59:24,891 - INFO - Avg. fwd time: 54.7894 / Avg. bwd time: 42.4985 / Avg. batch time: 1545.7119 (ms) / GPU bubble ratio: 49.65%
[rank2]:2025-10-24 21:59:24,839 - INFO - Avg. fwd time: 34.9857 / Avg. bwd time: 37.7957 / Avg. batch time: 1454.2736 (ms) / GPU bubble ratio: 59.96%
[rank0]:2025-10-24 21:59:24,905 - INFO - Avg. fwd time: 47.9317 / Avg. bwd time: 7.0497 / Avg. batch time: 1592.0119 (ms) / GPU bubble ratio: 72.37%
[rank0]:2025-10-24 22:01:28,416 - INFO -  step: 1780  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,573  tflops: 20.11  mfu: 6.45%
[rank1]:2025-10-24 22:01:28,415 - INFO -  step: 1780  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,573  tflops: 20.11  mfu: 6.45%
[rank2]:2025-10-24 22:01:28,415 - INFO -  step: 1780  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,573  tflops: 20.11  mfu: 6.45%
[rank3]:2025-10-24 22:01:30,922 - INFO -  step: 1780  loss:  1.0427  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,573  tflops: 20.11  mfu: 6.45%
[rank3]:2025-10-24 22:01:32,226 - INFO - Avg. fwd time: 76.7428 / Avg. bwd time: 75.4975 / Avg. batch time: 1266.0809 (ms) / GPU bubble ratio: 3.80%
[rank2]:2025-10-24 22:01:32,269 - INFO - Avg. fwd time: 34.9855 / Avg. bwd time: 37.7033 / Avg. batch time: 1453.9488 (ms) / GPU bubble ratio: 60.00%
[rank0]:2025-10-24 22:01:32,335 - INFO - Avg. fwd time: 47.9324 / Avg. bwd time: 6.9705 / Avg. batch time: 1591.5247 (ms) / GPU bubble ratio: 72.40%
[rank1]:2025-10-24 22:01:32,321 - INFO - Avg. fwd time: 54.7903 / Avg. bwd time: 42.4630 / Avg. batch time: 1545.3254 (ms) / GPU bubble ratio: 49.65%
[rank0]:2025-10-24 22:03:29,900 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-24 22:03:35,773 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,573  tflops: 20.11  mfu: 6.45%
[rank1]:2025-10-24 22:03:35,772 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,573  tflops: 20.11  mfu: 6.45%
[rank2]:2025-10-24 22:03:35,772 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,573  tflops: 20.11  mfu: 6.45%
[rank3]:2025-10-24 22:03:38,279 - INFO -  step: 1800  loss:  1.0345  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,573  tflops: 20.11  mfu: 6.45%
[rank0]:2025-10-24 22:03:38,367 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251024_2203_stage0_step1800.svg
[rank1]:2025-10-24 22:03:38,367 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251024_2203_stage1_step1800.svg
[rank2]:2025-10-24 22:03:38,367 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251024_2203_stage2_step1800.svg
[rank3]:2025-10-24 22:03:38,505 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/pipeline_schedule/251024_2203_real_step1800_rank3.svg
[rank3]:> Batch Time: 1380.28 ms, GPU Bubble Ratio: 72.04%, 45.21%, 62.86%, 13.26%
[rank3]:2025-10-24 22:03:38,573 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251024_2203_stage3_step1800.svg
[rank3]:2025-10-24 22:03:39,870 - INFO - Avg. fwd time: 76.7409 / Avg. bwd time: 75.4610 / Avg. batch time: 1265.7558 (ms) / GPU bubble ratio: 3.80%
[rank2]:2025-10-24 22:03:39,912 - INFO - Avg. fwd time: 34.9869 / Avg. bwd time: 37.6125 / Avg. batch time: 1453.2924 (ms) / GPU bubble ratio: 60.04%
[rank0]:2025-10-24 22:03:39,976 - INFO - Avg. fwd time: 47.9339 / Avg. bwd time: 6.8931 / Avg. batch time: 1590.7142 (ms) / GPU bubble ratio: 72.43%
[rank1]:2025-10-24 22:03:39,963 - INFO - Avg. fwd time: 54.7902 / Avg. bwd time: 42.4287 / Avg. batch time: 1544.6139 (ms) / GPU bubble ratio: 49.65%
[rank3]:2025-10-24 22:04:45,783 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-24 22:04:46,534 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-24 22:04:46,575 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 22:04:46,575 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 22:05:43,352 - INFO -  step: 1820  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,568  tflops: 20.08  mfu: 6.44%
[rank2]:2025-10-24 22:05:43,351 - INFO -  step: 1820  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,568  tflops: 20.08  mfu: 6.44%
[rank1]:2025-10-24 22:05:43,351 - INFO -  step: 1820  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,568  tflops: 20.08  mfu: 6.44%
[rank3]:2025-10-24 22:05:45,858 - INFO -  step: 1820  loss:  0.9779  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,569  tflops: 20.08  mfu: 6.44%
[rank3]:2025-10-24 22:05:47,142 - INFO - Avg. fwd time: 76.7399 / Avg. bwd time: 75.4237 / Avg. batch time: 1265.4327 (ms) / GPU bubble ratio: 3.80%
[rank2]:2025-10-24 22:05:47,187 - INFO - Avg. fwd time: 34.9865 / Avg. bwd time: 37.5242 / Avg. batch time: 1452.9593 (ms) / GPU bubble ratio: 60.08%
[rank1]:2025-10-24 22:05:47,239 - INFO - Avg. fwd time: 54.7899 / Avg. bwd time: 42.3949 / Avg. batch time: 1544.2259 (ms) / GPU bubble ratio: 49.65%
[rank0]:2025-10-24 22:05:47,253 - INFO - Avg. fwd time: 47.9343 / Avg. bwd time: 6.8174 / Avg. batch time: 1590.2308 (ms) / GPU bubble ratio: 72.46%
[rank1]:2025-10-24 22:07:50,850 - INFO -  step: 1840  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,570  tflops: 20.09  mfu: 6.44%
[rank2]:2025-10-24 22:07:50,849 - INFO -  step: 1840  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,570  tflops: 20.09  mfu: 6.44%
[rank0]:2025-10-24 22:07:50,850 - INFO -  step: 1840  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,570  tflops: 20.09  mfu: 6.44%
[rank3]:2025-10-24 22:07:53,352 - INFO -  step: 1840  loss:  1.0416  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,570  tflops: 20.09  mfu: 6.44%
[rank3]:2025-10-24 22:07:54,650 - INFO - Avg. fwd time: 76.7376 / Avg. bwd time: 75.3881 / Avg. batch time: 1265.1149 (ms) / GPU bubble ratio: 3.80%
[rank2]:2025-10-24 22:07:54,694 - INFO - Avg. fwd time: 34.9857 / Avg. bwd time: 37.4375 / Avg. batch time: 1452.6635 (ms) / GPU bubble ratio: 60.12%
[rank1]:2025-10-24 22:07:54,746 - INFO - Avg. fwd time: 54.7900 / Avg. bwd time: 42.3624 / Avg. batch time: 1543.8791 (ms) / GPU bubble ratio: 49.66%
[rank0]:2025-10-24 22:07:54,761 - INFO - Avg. fwd time: 47.9355 / Avg. bwd time: 6.7433 / Avg. batch time: 1589.7896 (ms) / GPU bubble ratio: 72.49%
[rank0]:2025-10-24 22:08:48,720 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-24 22:09:58,498 - INFO -  step: 1860  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,567  tflops: 20.07  mfu: 6.43%
[rank1]:2025-10-24 22:09:58,498 - INFO -  step: 1860  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,567  tflops: 20.07  mfu: 6.43%
[rank2]:2025-10-24 22:09:58,498 - INFO -  step: 1860  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,567  tflops: 20.07  mfu: 6.43%
[rank3]:2025-10-24 22:10:01,002 - INFO -  step: 1860  loss:  1.0821  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,567  tflops: 20.07  mfu: 6.43%
[rank3]:2025-10-24 22:10:02,307 - INFO - Avg. fwd time: 76.7378 / Avg. bwd time: 75.3535 / Avg. batch time: 1264.8207 (ms) / GPU bubble ratio: 3.80%
[rank2]:2025-10-24 22:10:02,351 - INFO - Avg. fwd time: 34.9852 / Avg. bwd time: 37.3528 / Avg. batch time: 1452.3970 (ms) / GPU bubble ratio: 60.16%
[rank0]:2025-10-24 22:10:02,419 - INFO - Avg. fwd time: 47.9359 / Avg. bwd time: 6.6708 / Avg. batch time: 1589.3762 (ms) / GPU bubble ratio: 72.51%
[rank1]:2025-10-24 22:10:02,403 - INFO - Avg. fwd time: 54.7874 / Avg. bwd time: 42.3316 / Avg. batch time: 1543.5580 (ms) / GPU bubble ratio: 49.66%
[rank2]:2025-10-24 22:12:05,849 - INFO -  step: 1880  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,573  tflops: 20.11  mfu: 6.45%
[rank0]:2025-10-24 22:12:05,849 - INFO -  step: 1880  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,573  tflops: 20.11  mfu: 6.45%
[rank1]:2025-10-24 22:12:05,849 - INFO -  step: 1880  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,573  tflops: 20.11  mfu: 6.45%
[rank3]:2025-10-24 22:12:08,347 - INFO -  step: 1880  loss:  1.0784  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,573  tflops: 20.12  mfu: 6.45%
[rank3]:2025-10-24 22:12:09,629 - INFO - Avg. fwd time: 76.7364 / Avg. bwd time: 75.3186 / Avg. batch time: 1264.5158 (ms) / GPU bubble ratio: 3.80%
[rank1]:2025-10-24 22:12:09,725 - INFO - Avg. fwd time: 54.7871 / Avg. bwd time: 42.3015 / Avg. batch time: 1543.1985 (ms) / GPU bubble ratio: 49.67%
[rank2]:2025-10-24 22:12:09,673 - INFO - Avg. fwd time: 34.9863 / Avg. bwd time: 37.2701 / Avg. batch time: 1452.0882 (ms) / GPU bubble ratio: 60.19%
[rank0]:2025-10-24 22:12:09,741 - INFO - Avg. fwd time: 47.9337 / Avg. bwd time: 6.5999 / Avg. batch time: 1588.9255 (ms) / GPU bubble ratio: 72.54%
[rank3]:2025-10-24 22:13:30,236 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-24 22:13:31,021 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-24 22:13:30,980 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 22:13:31,021 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 22:14:07,242 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-24 22:14:13,149 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,574  tflops: 20.12  mfu: 6.45%
[rank1]:2025-10-24 22:14:13,149 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,574  tflops: 20.12  mfu: 6.45%
[rank2]:2025-10-24 22:14:13,149 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,574  tflops: 20.12  mfu: 6.45%
[rank3]:2025-10-24 22:14:15,653 - INFO -  step: 1900  loss:  0.9636  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,574  tflops: 20.12  mfu: 6.45%
[rank0]:2025-10-24 22:14:15,742 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251024_2214_stage0_step1900.svg
[rank1]:2025-10-24 22:14:15,742 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251024_2214_stage1_step1900.svg
[rank2]:2025-10-24 22:14:15,742 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251024_2214_stage2_step1900.svg
[rank3]:2025-10-24 22:14:15,881 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/pipeline_schedule/251024_2214_real_step1900_rank3.svg
[rank3]:> Batch Time: 1380.08 ms, GPU Bubble Ratio: 72.04%, 45.21%, 62.86%, 13.25%
[rank3]:2025-10-24 22:14:15,949 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251024_2214_stage3_step1900.svg
[rank3]:2025-10-24 22:14:17,262 - INFO - Avg. fwd time: 76.7374 / Avg. bwd time: 75.2841 / Avg. batch time: 1264.2321 (ms) / GPU bubble ratio: 3.80%
[rank2]:2025-10-24 22:14:17,306 - INFO - Avg. fwd time: 34.9866 / Avg. bwd time: 37.1888 / Avg. batch time: 1451.4941 (ms) / GPU bubble ratio: 60.22%
[rank1]:2025-10-24 22:14:17,360 - INFO - Avg. fwd time: 54.7843 / Avg. bwd time: 42.2706 / Avg. batch time: 1542.5493 (ms) / GPU bubble ratio: 49.67%
[rank0]:2025-10-24 22:14:17,373 - INFO - Avg. fwd time: 47.9336 / Avg. bwd time: 6.5304 / Avg. batch time: 1588.1869 (ms) / GPU bubble ratio: 72.57%
[rank0]:2025-10-24 22:16:21,133 - INFO -  step: 1920  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,560  tflops: 20.02  mfu: 6.42%
[rank1]:2025-10-24 22:16:21,133 - INFO -  step: 1920  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,560  tflops: 20.02  mfu: 6.42%
[rank2]:2025-10-24 22:16:21,133 - INFO -  step: 1920  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,560  tflops: 20.02  mfu: 6.42%
[rank3]:2025-10-24 22:16:23,658 - INFO -  step: 1920  loss:  1.0280  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,560  tflops: 20.01  mfu: 6.41%
[rank2]:2025-10-24 22:16:25,007 - INFO - Avg. fwd time: 34.9883 / Avg. bwd time: 37.1091 / Avg. batch time: 1451.2584 (ms) / GPU bubble ratio: 60.26%
[rank3]:2025-10-24 22:16:24,962 - INFO - Avg. fwd time: 76.7368 / Avg. bwd time: 75.2522 / Avg. batch time: 1263.9557 (ms) / GPU bubble ratio: 3.80%
[rank0]:2025-10-24 22:16:25,075 - INFO - Avg. fwd time: 47.9337 / Avg. bwd time: 6.4625 / Avg. batch time: 1587.8119 (ms) / GPU bubble ratio: 72.59%
[rank1]:2025-10-24 22:16:25,061 - INFO - Avg. fwd time: 54.7829 / Avg. bwd time: 42.2406 / Avg. batch time: 1542.2622 (ms) / GPU bubble ratio: 49.67%
[rank2]:2025-10-24 22:18:28,699 - INFO -  step: 1940  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,569  tflops: 20.08  mfu: 6.44%
[rank0]:2025-10-24 22:18:28,699 - INFO -  step: 1940  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,569  tflops: 20.08  mfu: 6.44%
[rank1]:2025-10-24 22:18:28,699 - INFO -  step: 1940  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,569  tflops: 20.08  mfu: 6.44%
[rank3]:2025-10-24 22:18:31,234 - INFO -  step: 1940  loss:  1.0368  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,569  tflops: 20.08  mfu: 6.44%
[rank3]:2025-10-24 22:18:32,530 - INFO - Avg. fwd time: 76.7382 / Avg. bwd time: 75.2167 / Avg. batch time: 1263.6727 (ms) / GPU bubble ratio: 3.80%
[rank2]:2025-10-24 22:18:32,575 - INFO - Avg. fwd time: 34.9882 / Avg. bwd time: 37.0314 / Avg. batch time: 1451.0028 (ms) / GPU bubble ratio: 60.29%
[rank0]:2025-10-24 22:18:32,643 - INFO - Avg. fwd time: 47.9299 / Avg. bwd time: 6.3959 / Avg. batch time: 1587.4261 (ms) / GPU bubble ratio: 72.62%
[rank1]:2025-10-24 22:18:32,628 - INFO - Avg. fwd time: 54.7810 / Avg. bwd time: 42.2123 / Avg. batch time: 1541.9597 (ms) / GPU bubble ratio: 49.68%
[rank0]:2025-10-24 22:19:26,576 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-24 22:20:36,095 - INFO -  step: 1960  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,572  tflops: 20.11  mfu: 6.44%
[rank1]:2025-10-24 22:20:36,096 - INFO -  step: 1960  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,572  tflops: 20.11  mfu: 6.44%
[rank0]:2025-10-24 22:20:36,096 - INFO -  step: 1960  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,572  tflops: 20.11  mfu: 6.44%
[rank3]:2025-10-24 22:20:38,620 - INFO -  step: 1960  loss:  1.0679  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,572  tflops: 20.11  mfu: 6.45%
[rank3]:2025-10-24 22:20:39,893 - INFO - Avg. fwd time: 76.7401 / Avg. bwd time: 75.1797 / Avg. batch time: 1263.3791 (ms) / GPU bubble ratio: 3.80%
[rank2]:2025-10-24 22:20:39,937 - INFO - Avg. fwd time: 34.9876 / Avg. bwd time: 36.9556 / Avg. batch time: 1450.7265 (ms) / GPU bubble ratio: 60.33%
[rank0]:2025-10-24 22:20:40,006 - INFO - Avg. fwd time: 47.9243 / Avg. bwd time: 6.3306 / Avg. batch time: 1587.0233 (ms) / GPU bubble ratio: 72.65%
[rank1]:2025-10-24 22:20:39,991 - INFO - Avg. fwd time: 54.7801 / Avg. bwd time: 42.1848 / Avg. batch time: 1541.6393 (ms) / GPU bubble ratio: 49.68%
[rank3]:2025-10-24 22:22:16,272 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-24 22:22:17,012 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 22:22:17,052 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-24 22:22:17,053 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-24 22:22:43,416 - INFO -  step: 1980  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,574  tflops: 20.12  mfu: 6.45%
[rank1]:2025-10-24 22:22:43,415 - INFO -  step: 1980  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,574  tflops: 20.12  mfu: 6.45%
[rank2]:2025-10-24 22:22:43,415 - INFO -  step: 1980  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,574  tflops: 20.12  mfu: 6.45%
[rank3]:2025-10-24 22:22:45,949 - INFO -  step: 1980  loss:  0.9671  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,574  tflops: 20.12  mfu: 6.45%
[rank2]:2025-10-24 22:22:47,299 - INFO - Avg. fwd time: 34.9869 / Avg. bwd time: 36.8805 / Avg. batch time: 1450.4534 (ms) / GPU bubble ratio: 60.36%
[rank3]:2025-10-24 22:22:47,254 - INFO - Avg. fwd time: 76.7413 / Avg. bwd time: 75.1448 / Avg. batch time: 1263.0949 (ms) / GPU bubble ratio: 3.80%
[rank0]:2025-10-24 22:22:47,368 - INFO - Avg. fwd time: 47.9212 / Avg. bwd time: 6.2667 / Avg. batch time: 1586.6247 (ms) / GPU bubble ratio: 72.68%
[rank1]:2025-10-24 22:22:47,353 - INFO - Avg. fwd time: 54.7786 / Avg. bwd time: 42.1571 / Avg. batch time: 1541.3215 (ms) / GPU bubble ratio: 49.69%
[rank0]:2025-10-24 22:24:45,097 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-24 22:24:50,994 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.0000  memory: 20.03GiB(42.17%)  tps: 2,568  tflops: 20.08  mfu: 6.44%
[rank1]:2025-10-24 22:24:50,995 - INFO -  final step: 2000  loss: -4.0000  grad_norm:  0.0000  tps: 2,523  tflops: 19.72  mfu: 6.25%
[rank1]:2025-10-24 22:24:50,995 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-24 22:24:50,994 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.0000  memory: 16.10GiB(33.90%)  tps: 2,568  tflops: 20.08  mfu: 6.44%
[rank2]:2025-10-24 22:24:50,994 - INFO -  final step: 2000  loss: -4.0000  grad_norm:  0.0000  tps: 2,523  tflops: 19.72  mfu: 6.25%
[rank2]:2025-10-24 22:24:50,995 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-24 22:24:50,996 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2000.
[rank0]:2025-10-24 22:24:50,995 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.0000  memory: 20.89GiB(43.97%)  tps: 2,568  tflops: 20.08  mfu: 6.44%
[rank0]:2025-10-24 22:24:50,995 - INFO -  final step: 2000  loss: -4.0000  grad_norm:  0.0000  tps: 2,523  tflops: 19.72  mfu: 6.25%
[rank0]:2025-10-24 22:24:50,995 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-24 22:24:50,998 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2000.
[rank1]:2025-10-24 22:24:50,997 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2000.
[rank3]:2025-10-24 22:24:53,522 - INFO -  step: 2000  loss:  1.0408  grad_norm:  0.0000  memory: 38.93GiB(81.95%)  tps: 2,569  tflops: 20.08  mfu: 6.44%
[rank3]:2025-10-24 22:24:53,523 - INFO -  final step: 2000  loss:  1.0408  grad_norm:  0.0000  tps: 2,523  tflops: 19.72  mfu: 6.26%
[rank3]:2025-10-24 22:24:53,524 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-24 22:24:53,526 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2000.
[rank0]:2025-10-24 22:24:56,061 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank2]:2025-10-24 22:24:56,156 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251024_2224_stage2_final2000.svg
[rank0]:2025-10-24 22:24:56,156 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251024_2224_stage0_final2000.svg
[rank1]:2025-10-24 22:24:56,155 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251024_2224_stage1_final2000.svg
[rank3]:2025-10-24 22:24:56,297 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/pipeline_schedule/251024_2224_real_final2000_rank3.svg
[rank3]:> Batch Time: 1379.91 ms, GPU Bubble Ratio: 72.05%, 45.22%, 62.87%, 13.25%
[rank2]:2025-10-24 22:24:56,375 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/frozen_params_histogram/251024_2224_rank2_stage2.svg
[rank2]:	> Counts Sum: 1956600, Total Sum: 2188800 (89.39%), Ratio(%) per element: [89.4, 89.37, 89.4, 89.4, 89.37, 89.37, 89.4, 89.37, 89.4, 89.4, 89.37, 89.44, 89.37, 89.44, 89.37, 89.37, 89.4, 89.37, 89.37, 89.4, 89.37, 89.37, 89.37, 89.37, 89.4, 89.37, 89.37, 89.37, 89.44, 89.37, 89.4, 89.4, 89.37, 89.37, 89.37, 89.4]
[rank2]:2025-10-24 22:24:56,375 - INFO - Destroying the purge thread.
[rank0]:2025-10-24 22:24:56,375 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/frozen_params_histogram/251024_2224_rank0_stage0.svg
[rank0]:	> Counts Sum: 1972580, Total Sum: 2249600 (87.69%), Ratio(%) per element: [87.66, 87.73, 87.69, 87.76, 87.63, 87.69, 87.76, 87.73, 87.66, 87.76, 87.56, 87.69, 87.73, 87.73, 87.69, 87.76, 87.63, 87.63, 87.69, 87.66, 87.73, 87.59, 87.66, 87.66, 87.69, 87.73, 87.63, 87.69, 87.66, 87.69, 87.59, 87.63, 87.69, 87.69, 87.69, 87.66, 87.69]
[rank0]:2025-10-24 22:24:56,375 - INFO - Sleeping 2 seconds for other ranks to complete
[rank1]:2025-10-24 22:24:56,361 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/frozen_params_histogram/251024_2224_rank1_stage1.svg
[rank1]:	> Counts Sum: 2387560, Total Sum: 2736000 (87.26%), Ratio(%) per element: [87.33, 87.17, 87.1, 87.2, 87.2, 87.33, 87.3, 87.17, 87.36, 87.13, 87.23, 87.33, 87.26, 87.2, 87.2, 87.13, 87.17, 87.3, 87.33, 87.36, 87.33, 87.26, 87.3, 87.4, 87.23, 87.3, 87.2, 87.36, 87.33, 87.2, 87.26, 87.3, 87.3, 87.13, 87.17, 87.4, 87.3, 87.36, 87.33, 87.2, 87.26, 87.36, 87.2, 87.13, 87.26]
[rank1]:2025-10-24 22:24:56,361 - INFO - Destroying the purge thread.
[rank3]:2025-10-24 22:24:56,525 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/pipeline_schedule/251024_2224_thry_final2000_rank3.svg
[rank3]:> Batch Time: 1777.71 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:2025-10-24 22:24:56,594 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251024_2224_stage3_final2000.svg
[rank2]:2025-10-24 22:24:56,648 - INFO - Process group destroyed
[rank1]:2025-10-24 22:24:56,667 - INFO - Process group destroyed
[rank3]:2025-10-24 22:24:56,777 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1023_GPipe_timelyapf_dm1/frozen_params_histogram/251024_2224_rank3_stage3.svg
[rank3]:	> Counts Sum: 2560, Total Sum: 1763200 (0.15%), Ratio(%) per element: [0.19, 0.09, 0.19, 0.09, 0.03, 0.26, 0.23, 0.16, 0.16, 0.13, 0.23, 0.09, 0.09, 0.09, 0.19, 0.09, 0.19, 0.16, 0.13, 0.06, 0.16, 0.16, 0.16, 0.09, 0.26, 0.09, 0.13, 0.16, 0.0]
[rank3]:2025-10-24 22:24:56,778 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading history steps 99-100, summary, console lines 532-543
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–„â–ƒâ–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–…â–…â–…â–„â–„â–ƒâ–„â–‚â–„â–‚â–ƒâ–ƒâ–ƒâ–‚â–‚â–‚â–‚â–â–‚â–‚â–â–‚â–‚â–â–‚â–â–‚â–‚â–‚â–‚â–‚â–ƒâ–‚â–‚â–‚â–â–ƒâ–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–†â–…â–„â–…â–…â–…â–„â–‚â–…â–‚â–ƒâ–„â–â–„â–ƒâ–‚â–ƒâ–‚â–‚â–‚â–ƒâ–‚â–ƒâ–â–ƒâ–‚â–â–‚â–ƒâ–‚â–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–„â–â–‚â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 6.49438
[rank3]:wandb:               final/avg_loss 1.04078
[rank3]:wandb:             final/avg_mfu(%) 6.25769
[rank3]:wandb:             final/avg_tflops 19.72207
[rank3]:wandb:    final/avg_throughput(tps) 2522.79719
[rank3]:wandb:              final/grad_norm 0
[rank3]:wandb:               final/max_loss 1.04078
[rank3]:wandb:                    grad_norm 0
[rank3]:wandb: loss_metrics/global_avg_loss 1.04078
[rank3]:wandb: loss_metrics/global_max_loss 1.04078
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1023_GPipe_timelyapf_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/4c7ctu53
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1023_GPipe_timelyapf_dm1/20251024-1846/wandb/run-20251024_184613-4c7ctu53/logs
[rank0]:2025-10-24 22:24:58,375 - INFO - Training completed
[rank0]:2025-10-24 22:24:58,376 - INFO - Destroying the purge thread.
[rank0]:2025-10-24 22:24:58,438 - INFO - Process group destroyed
[rank3]:2025-10-24 22:24:58,437 - INFO - Process group destroyed
[rank1]:Stage 1: Modules to keep: {'layers.5', 'layers.4', 'layers.6', 'layers.8', 'layers.7'}
[rank0]:Stage 0: Modules to keep: {'layers.2', 'layers.1', 'layers.3', 'tok_embeddings', 'layers.0'}
[rank2]:Stage 2: Modules to keep: {'layers.9', 'layers.12', 'layers.11', 'layers.10'}
[rank3]:Stage 3: Modules to keep: {'layers.14', 'layers.15', 'norm', 'output', 'layers.13'}
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1022_llama1binstruct/config.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1023_GPipe_timelyapf_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: profile_trace/1023_GPipe_timelyapf_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: memory_snapshot/1023_GPipe_timelyapf_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 20
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: tb/1023_GPipe_timelyapf_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- pplog_freq: 80
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1023_GPipe_timelyapf_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B-Instruct
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 1e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: alpaca
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 2000
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: GPipe
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- folder: checkpoint/1023_GPipe_timelyapf_dm1
[rank3]:		- interval: 500
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B-Instruct/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: comm_traces/1023_GPipe_timelyapf_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 8
[rank3]:		- seq_len: 2048
[rank3]:		- freq: 10
[rank3]:		- steps: -1
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: timelyapf
[rank3]:		- phase_unit: 10
[rank3]:		- stability_check_freq: 5
[rank3]:		- aggressiveness: 0
[rank3]:
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
