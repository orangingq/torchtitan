
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 10. 26. (ì¼) 05:32:08 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 3,4,5,6
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1022_llama1binstruct/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1022_llama1binstruct/1023_1F1B_auto.log
âœ”ï¸Main Table Experiment
âœ”ï¸Running with auto x 1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1022_llama1binstruct/config.toml --job.description="Main Table Experiment" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=auto
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank0]:2025-10-26 05:32:14,853 - INFO - Starting job: "Main Table Experiment"
[rank1]:2025-10-26 05:32:14,852 - INFO - Starting job: "Main Table Experiment"
[rank3]:2025-10-26 05:32:14,928 - INFO - Starting job: "Main Table Experiment"
[rank0]:2025-10-26 05:32:15,173 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-10-26 05:32:15,175 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-26 05:32:15,177 - INFO - [GC] Initial GC collection 0.00 seconds
[rank2]:2025-10-26 05:32:15,122 - INFO - Starting job: "Main Table Experiment"
[rank1]:2025-10-26 05:32:15,168 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-10-26 05:32:15,171 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-10-26 05:32:15,197 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-10-26 05:32:15,200 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-10-26 05:32:15,311 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-10-26 05:32:15,314 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-26 05:32:15,657 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-10-26 05:32:16,113 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank0]:2025-10-26 05:32:19,090 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank1]:2025-10-26 05:32:19,105 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-10-26 05:32:19,144 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-10-26 05:32:19,170 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-10-26 05:32:19,170 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2025-10-26 05:32:19,238 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-10-26 05:32:19,275 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-10-26 05:32:19,276 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-10-26 05:32:19,301 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-10-26 05:32:19,302 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank2]:2025-10-26 05:32:19,337 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-10-26 05:32:19,377 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-10-26 05:32:19,402 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-10-26 05:32:19,403 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2025-10-26 05:32:19,344 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-10-26 05:32:19,344 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-10-26 05:32:19,344 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank0]:2025-10-26 05:32:19,476 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-10-26 05:32:19,476 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-10-26 05:32:19,477 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank2]:2025-10-26 05:32:19,575 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-10-26 05:32:19,575 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-10-26 05:32:19,576 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run 45wu94ql
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1023_1F1B_auto_dm1/20251026-0532/wandb/run-20251026_053220-45wu94ql
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1023_1F1B_auto_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/45wu94ql
[rank3]:2025-10-26 05:32:21,366 - INFO - WandB logging enabled
[rank3]:2025-10-26 05:32:21,367 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-10-26 05:32:21,408 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-10-26 05:32:21,440 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-10-26 05:32:21,440 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2025-10-26 05:32:21,652 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1023_1F1B_auto_dm1
[rank0]:2025-10-26 05:32:21,652 - WARNING - Mixed precision training with TP or PP is only supported when FSDP/HSDP/CP is enabled.
[rank0]:2025-10-26 05:32:21,652 - INFO - Mixed precision training is disabled
[rank0]:2025-10-26 05:32:21,652 - INFO - Trainer is initialized with local batch size 16, global batch size 64, gradient accumulation steps 4, sequence length 1024, total steps 2000 (warmup 100)
[rank0]:2025-10-26 05:32:21,652 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B-Instruct/original_dcp.
[rank3]:2025-10-26 05:32:21,635 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-10-26 05:32:21,636 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-10-26 05:32:21,637 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank0]:2025-10-26 05:32:24,415 - INFO - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-10-26 05:32:24,415 - INFO - Finished loading the checkpoint in 2.76 seconds.
[rank0]:2025-10-26 05:32:24,415 - INFO - Training starts at step 1
[rank0]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/autograd/graph.py:849: UserWarning: Attempting to run cuBLAS, but there was no current CUDA context! Attempting to set the primary context... (Triggered internally at /pytorch/aten/src/ATen/cuda/CublasHandlePool.cpp:270.)
[rank0]:  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
[rank3]:2025-10-26 05:32:36,405 - INFO -  step:  1  loss:  1.7854  grad_norm:  3.4827  memory: 20.75GiB(43.67%)  tps: 1,093  tflops: 8.54  mfu: 2.74%
[rank3]:2025-10-26 05:32:36,406 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-10-26 05:32:36,395 - INFO -  step:  1  loss: -4.0000  grad_norm:  3.4827  memory:  5.39GiB(11.36%)  tps: 963  tflops: 7.53  mfu: 2.41%
[rank2]:2025-10-26 05:32:36,396 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-10-26 05:32:36,399 - INFO -  step:  1  loss: -4.0000  grad_norm:  3.4827  memory:  8.46GiB(17.81%)  tps: 950  tflops: 7.42  mfu: 2.38%
[rank1]:2025-10-26 05:32:36,399 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-10-26 05:32:36,438 - INFO -  step:  1  loss: -4.0000  grad_norm:  3.4827  memory: 11.08GiB(23.32%)  tps: 955  tflops: 7.46  mfu: 2.39%
[rank0]:2025-10-26 05:32:36,438 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-26 05:32:50,819 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-26 05:32:50,820 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-26 05:32:50,820 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-26 05:32:50,820 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-26 05:32:50,821 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-26 05:32:50,821 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-26 05:32:50,821 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-26 05:32:50,821 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-26 05:32:50,822 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-26 05:32:50,822 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-26 05:32:50,822 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-26 05:32:50,822 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-26 05:32:50,823 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-26 05:32:50,823 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-26 05:32:50,823 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-26 05:32:50,823 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-26 05:32:50,883 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-26 05:32:50,883 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-26 05:32:50,884 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-26 05:32:50,884 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-26 05:32:50,884 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-26 05:32:50,884 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-26 05:32:50,884 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-26 05:32:50,884 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-26 05:32:50,884 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-26 05:32:50,884 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-26 05:32:50,884 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-26 05:32:50,884 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-26 05:32:50,884 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-26 05:32:50,884 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-26 05:32:50,884 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-26 05:32:50,884 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-26 05:32:50,965 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-26 05:32:50,965 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-26 05:32:50,965 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-26 05:32:50,965 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-26 05:32:50,965 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-26 05:32:50,965 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-26 05:32:50,965 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-26 05:32:50,965 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-26 05:32:50,965 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-26 05:32:50,965 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-26 05:32:50,965 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-26 05:32:50,965 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-26 05:32:50,965 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-26 05:32:50,965 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-26 05:32:50,965 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-26 05:32:50,965 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-26 05:32:51,026 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-26 05:32:51,026 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-26 05:32:51,026 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-26 05:32:51,026 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-26 05:32:51,026 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-26 05:32:51,026 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-26 05:32:51,026 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-26 05:32:51,026 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-26 05:32:51,026 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-26 05:32:51,026 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-26 05:32:51,026 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-26 05:32:51,026 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-26 05:32:51,026 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-26 05:32:51,026 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-26 05:32:51,026 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-26 05:32:51,026 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-26 05:35:16,643 - INFO -  step: 20  loss: -4.0000  grad_norm:  1.4899  memory: 14.87GiB(31.30%)  tps: 1,943  tflops: 15.19  mfu: 4.87%
[rank3]:2025-10-26 05:35:16,635 - INFO -  step: 20  loss:  1.3862  grad_norm:  1.4899  memory: 24.67GiB(51.93%)  tps: 1,943  tflops: 15.19  mfu: 4.87%
[rank2]:2025-10-26 05:35:16,623 - INFO -  step: 20  loss: -4.0000  grad_norm:  1.4899  memory:  7.21GiB(15.18%)  tps: 1,943  tflops: 15.19  mfu: 4.87%
[rank1]:2025-10-26 05:35:16,627 - INFO -  step: 20  loss: -4.0000  grad_norm:  1.4899  memory: 10.73GiB(22.58%)  tps: 1,943  tflops: 15.19  mfu: 4.87%
[rank3]:2025-10-26 05:35:18,562 - INFO - Avg. fwd time: 68.9683 / Avg. bwd time: 138.1869 / Avg. batch time: 1734.5782 (ms) / GPU bubble ratio: 4.46%
[rank2]:2025-10-26 05:35:18,624 - INFO - Avg. fwd time: 35.1267 / Avg. bwd time: 54.1470 / Avg. batch time: 1826.0880 (ms) / GPU bubble ratio: 60.89%
[rank1]:2025-10-26 05:35:18,695 - INFO - Avg. fwd time: 49.7374 / Avg. bwd time: 71.7802 / Avg. batch time: 1944.5161 (ms) / GPU bubble ratio: 50.01%
[rank0]:2025-10-26 05:35:18,757 - INFO - Avg. fwd time: 39.3273 / Avg. bwd time: 60.1240 / Avg. batch time: 2043.2614 (ms) / GPU bubble ratio: 61.06%
[rank0]:2025-10-26 05:38:06,055 - INFO -  step: 40  loss: -4.0000  grad_norm:  2.1309  memory: 14.87GiB(31.30%)  tps: 1,934  tflops: 15.12  mfu: 4.85%
[rank3]:2025-10-26 05:38:06,048 - INFO -  step: 40  loss:  1.2757  grad_norm:  2.1309  memory: 24.67GiB(51.93%)  tps: 1,934  tflops: 15.12  mfu: 4.85%
[rank2]:2025-10-26 05:38:06,036 - INFO -  step: 40  loss: -4.0000  grad_norm:  2.1309  memory:  7.21GiB(15.18%)  tps: 1,934  tflops: 15.12  mfu: 4.85%
[rank1]:2025-10-26 05:38:06,040 - INFO -  step: 40  loss: -4.0000  grad_norm:  2.1309  memory: 10.73GiB(22.58%)  tps: 1,934  tflops: 15.12  mfu: 4.85%
[rank3]:2025-10-26 05:38:07,981 - INFO - Avg. fwd time: 69.6885 / Avg. bwd time: 139.4886 / Avg. batch time: 1740.4595 (ms) / GPU bubble ratio: 3.85%
[rank2]:2025-10-26 05:38:08,037 - INFO - Avg. fwd time: 35.3992 / Avg. bwd time: 54.5239 / Avg. batch time: 1832.1946 (ms) / GPU bubble ratio: 60.74%
[rank0]:2025-10-26 05:38:08,178 - INFO - Avg. fwd time: 39.8941 / Avg. bwd time: 60.8000 / Avg. batch time: 2050.0475 (ms) / GPU bubble ratio: 60.71%
[rank1]:2025-10-26 05:38:08,116 - INFO - Avg. fwd time: 50.1327 / Avg. bwd time: 71.8021 / Avg. batch time: 1950.4807 (ms) / GPU bubble ratio: 49.99%
[rank0]:2025-10-26 05:39:22,117 - INFO - [GC] Peforming periodical GC collection 0.02 seconds
[rank0]:2025-10-26 05:40:55,545 - INFO -  step: 60  loss: -4.0000  grad_norm:  0.5366  memory: 14.87GiB(31.30%)  tps: 1,933  tflops: 15.11  mfu: 4.84%
[rank2]:2025-10-26 05:40:55,525 - INFO -  step: 60  loss: -4.0000  grad_norm:  0.5366  memory:  7.21GiB(15.18%)  tps: 1,933  tflops: 15.11  mfu: 4.84%
[rank3]:2025-10-26 05:40:55,537 - INFO -  step: 60  loss:  1.2100  grad_norm:  0.5366  memory: 24.67GiB(51.93%)  tps: 1,933  tflops: 15.11  mfu: 4.84%
[rank1]:2025-10-26 05:40:55,529 - INFO -  step: 60  loss: -4.0000  grad_norm:  0.5366  memory: 10.73GiB(22.58%)  tps: 1,933  tflops: 15.11  mfu: 4.84%
[rank3]:2025-10-26 05:40:57,494 - INFO - Avg. fwd time: 69.9450 / Avg. bwd time: 139.9739 / Avg. batch time: 1742.9264 (ms) / GPU bubble ratio: 3.65%
[rank2]:2025-10-26 05:40:57,550 - INFO - Avg. fwd time: 35.5088 / Avg. bwd time: 54.6664 / Avg. batch time: 1834.7008 (ms) / GPU bubble ratio: 60.68%
[rank1]:2025-10-26 05:40:57,623 - INFO - Avg. fwd time: 50.2335 / Avg. bwd time: 72.0161 / Avg. batch time: 1952.9388 (ms) / GPU bubble ratio: 49.92%
[rank0]:2025-10-26 05:40:57,689 - INFO - Avg. fwd time: 40.0135 / Avg. bwd time: 60.8826 / Avg. batch time: 2052.4884 (ms) / GPU bubble ratio: 60.67%
[rank0]:2025-10-26 05:43:46,017 - INFO -  step: 80  loss: -4.0000  grad_norm:  0.5012  memory: 14.87GiB(31.30%)  tps: 1,922  tflops: 15.03  mfu: 4.82%
[rank3]:2025-10-26 05:43:46,009 - INFO -  step: 80  loss:  1.1799  grad_norm:  0.5012  memory: 24.67GiB(51.93%)  tps: 1,922  tflops: 15.03  mfu: 4.82%
[rank2]:2025-10-26 05:43:45,997 - INFO -  step: 80  loss: -4.0000  grad_norm:  0.5012  memory:  7.21GiB(15.18%)  tps: 1,922  tflops: 15.03  mfu: 4.82%
[rank1]:2025-10-26 05:43:46,009 - INFO -  step: 80  loss: -4.0000  grad_norm:  0.5012  memory: 10.73GiB(22.58%)  tps: 1,922  tflops: 15.03  mfu: 4.82%
[rank3]:2025-10-26 05:43:47,924 - INFO - Avg. fwd time: 70.1652 / Avg. bwd time: 140.3640 / Avg. batch time: 1746.0748 (ms) / GPU bubble ratio: 3.54%
[rank2]:2025-10-26 05:43:47,988 - INFO - Avg. fwd time: 35.5699 / Avg. bwd time: 54.7544 / Avg. batch time: 1838.0430 (ms) / GPU bubble ratio: 60.69%
[rank0]:2025-10-26 05:43:48,131 - INFO - Avg. fwd time: 40.1174 / Avg. bwd time: 61.0099 / Avg. batch time: 2056.4626 (ms) / GPU bubble ratio: 60.66%
[rank1]:2025-10-26 05:43:48,069 - INFO - Avg. fwd time: 50.4676 / Avg. bwd time: 72.1416 / Avg. batch time: 1956.7107 (ms) / GPU bubble ratio: 49.87%
[rank3]:2025-10-26 05:44:03,968 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-26 05:44:04,889 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-26 05:44:04,958 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-26 05:44:05,020 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-26 05:45:54,996 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 0.0000e+00
[rank1]:2025-10-26 05:45:54,999 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 0.0000e+00
[rank3]:2025-10-26 05:45:55,007 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 0.0000e+00
[rank0]:2025-10-26 05:45:55,021 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 0.0000e+00
[rank0]:2025-10-26 05:46:28,904 - INFO - [GC] Peforming periodical GC collection 0.04 seconds
[rank2]:2025-10-26 05:46:37,429 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 3.4252e-01
[rank2]:2025-10-26 05:46:37,429 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.4903  memory:  7.21GiB(15.18%)  tps: 1,911  tflops: 14.94  mfu: 4.79%
[rank1]:2025-10-26 05:46:37,433 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 6.3093e-01
[rank1]:2025-10-26 05:46:37,434 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.4903  memory: 10.73GiB(22.58%)  tps: 1,912  tflops: 14.94  mfu: 4.79%
[rank3]:2025-10-26 05:46:37,440 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 3.5557e-01
[rank3]:2025-10-26 05:46:37,445 - INFO -  step: 100  loss:  1.1786  grad_norm:  0.4903  memory: 24.67GiB(51.93%)  tps: 1,911  tflops: 14.94  mfu: 4.79%
[rank2]:2025-10-26 05:46:37,522 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_auto_dm1/freeze_ratio_history/rank2/251026_0546_stage2_step100.svg
[rank0]:2025-10-26 05:46:37,448 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.3149e-01
[rank0]:2025-10-26 05:46:37,448 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.4903  memory: 14.87GiB(31.30%)  tps: 1,911  tflops: 14.94  mfu: 4.79%
[rank0]:2025-10-26 05:46:37,521 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_auto_dm1/freeze_ratio_history/rank0/251026_0546_stage0_step100.svg
[rank1]:2025-10-26 05:46:37,521 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_auto_dm1/freeze_ratio_history/rank1/251026_0546_stage1_step100.svg
[rank3]:2025-10-26 05:46:37,715 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_1F1B_auto_dm1/pipeline_schedule/251026_0546_real_step100_rank3.svg
[rank3]:> Batch Time: 1991.06 ms, GPU Bubble Ratio: 59.32%, 50.76%, 63.88%, 14.88%
[rank3]:2025-10-26 05:46:37,770 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_auto_dm1/freeze_ratio_history/rank3/251026_0546_stage3_step100.svg
[rank3]:2025-10-26 05:46:39,587 - INFO - Avg. fwd time: 70.2572 / Avg. bwd time: 140.4483 / Avg. batch time: 1746.4359 (ms) / GPU bubble ratio: 3.48%
[rank2]:2025-10-26 05:46:39,647 - INFO - Avg. fwd time: 35.6059 / Avg. bwd time: 54.8147 / Avg. batch time: 1838.7873 (ms) / GPU bubble ratio: 60.66%
[rank1]:2025-10-26 05:46:39,729 - INFO - Avg. fwd time: 50.4785 / Avg. bwd time: 72.1352 / Avg. batch time: 1957.3008 (ms) / GPU bubble ratio: 49.88%
[rank0]:2025-10-26 05:46:39,790 - INFO - Avg. fwd time: 40.1775 / Avg. bwd time: 61.0556 / Avg. batch time: 2057.0196 (ms) / GPU bubble ratio: 60.63%
[rank0]:2025-10-26 05:47:19,993 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 7.1687e-01
[rank2]:2025-10-26 05:47:19,974 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 9.1775e-01
[rank1]:2025-10-26 05:47:19,979 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 4.7940e-01
[rank3]:2025-10-26 05:47:19,985 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.1438e+00
[rank2]:2025-10-26 05:48:02,093 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 4.7068e-01
[rank0]:2025-10-26 05:48:02,121 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 2.3540e-01
[rank1]:2025-10-26 05:48:02,106 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 3.3492e-01
[rank3]:2025-10-26 05:48:02,112 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.3793e-01
[rank2]:2025-10-26 05:48:44,384 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.1661e-01
[rank0]:2025-10-26 05:48:44,396 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.1818e-01
[rank1]:2025-10-26 05:48:44,388 - INFO - Freezing Ratio: [Stage1] 0.20, Threshold: 2.2038e-01
[rank3]:2025-10-26 05:48:44,395 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 4.0767e-01
[rank3]:2025-10-26 05:49:26,502 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 3.3564e-01
[rank0]:2025-10-26 05:49:26,510 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 2.4155e-01
[rank0]:2025-10-26 05:49:26,511 - INFO -  step: 120  loss: -4.0000  grad_norm:  0.4410  memory: 14.87GiB(31.30%)  tps: 1,938  tflops: 15.15  mfu: 4.86%
[rank2]:2025-10-26 05:49:26,482 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 3.5199e-01
[rank2]:2025-10-26 05:49:26,483 - INFO -  step: 120  loss: -4.0000  grad_norm:  0.4410  memory:  7.21GiB(15.18%)  tps: 1,938  tflops: 15.15  mfu: 4.86%
[rank1]:2025-10-26 05:49:26,491 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.5716e-01
[rank1]:2025-10-26 05:49:26,492 - INFO -  step: 120  loss: -4.0000  grad_norm:  0.4410  memory: 10.73GiB(22.58%)  tps: 1,938  tflops: 15.15  mfu: 4.86%
[rank3]:2025-10-26 05:49:26,505 - INFO -  step: 120  loss:  1.1275  grad_norm:  0.4410  memory: 24.67GiB(51.93%)  tps: 1,938  tflops: 15.15  mfu: 4.86%
[rank3]:2025-10-26 05:49:28,458 - INFO - Avg. fwd time: 70.3251 / Avg. bwd time: 140.5583 / Avg. batch time: 1747.1607 (ms) / GPU bubble ratio: 3.44%
[rank2]:2025-10-26 05:49:28,514 - INFO - Avg. fwd time: 35.5886 / Avg. bwd time: 53.7526 / Avg. batch time: 1838.3234 (ms) / GPU bubble ratio: 61.12%
[rank0]:2025-10-26 05:49:28,651 - INFO - Avg. fwd time: 40.1988 / Avg. bwd time: 60.4683 / Avg. batch time: 2055.4721 (ms) / GPU bubble ratio: 60.82%
[rank1]:2025-10-26 05:49:28,597 - INFO - Avg. fwd time: 50.4338 / Avg. bwd time: 71.9024 / Avg. batch time: 1956.5016 (ms) / GPU bubble ratio: 49.98%
[rank2]:2025-10-26 05:50:08,916 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.6256e-01
[rank1]:2025-10-26 05:50:08,920 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 4.5608e-01
[rank3]:2025-10-26 05:50:08,927 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 3.8662e-01
[rank0]:2025-10-26 05:50:08,928 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 4.8151e-01
[rank2]:2025-10-26 05:50:51,153 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 4.1539e-01
[rank1]:2025-10-26 05:50:51,157 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 3.4204e-01
[rank3]:2025-10-26 05:50:51,172 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 3.9342e-01
[rank0]:2025-10-26 05:50:51,183 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.3353e-01
[rank0]:2025-10-26 05:51:33,515 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 6.9474e-01
[rank3]:2025-10-26 05:51:33,514 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.8868e-01
[rank2]:2025-10-26 05:51:33,503 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 9.2425e-02
[rank1]:2025-10-26 05:51:33,512 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.0293e-01
[rank0]:2025-10-26 05:52:15,575 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 3.6160e-01
[rank0]:2025-10-26 05:52:15,576 - INFO -  step: 140  loss: -4.0000  grad_norm:  0.4073  memory: 14.87GiB(31.30%)  tps: 1,938  tflops: 15.15  mfu: 4.86%
[rank3]:2025-10-26 05:52:15,563 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 3.0831e-01
[rank3]:2025-10-26 05:52:15,566 - INFO -  step: 140  loss:  1.1509  grad_norm:  0.4073  memory: 24.67GiB(51.93%)  tps: 1,938  tflops: 15.15  mfu: 4.86%
[rank2]:2025-10-26 05:52:15,544 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.1234e-01
[rank2]:2025-10-26 05:52:15,544 - INFO -  step: 140  loss: -4.0000  grad_norm:  0.4073  memory:  7.21GiB(15.18%)  tps: 1,938  tflops: 15.15  mfu: 4.86%
[rank1]:2025-10-26 05:52:15,548 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 3.0763e-01
[rank1]:2025-10-26 05:52:15,548 - INFO -  step: 140  loss: -4.0000  grad_norm:  0.4073  memory: 10.73GiB(22.58%)  tps: 1,938  tflops: 15.15  mfu: 4.86%
[rank3]:2025-10-26 05:52:17,529 - INFO - Avg. fwd time: 70.4166 / Avg. bwd time: 140.7443 / Avg. batch time: 1748.8804 (ms) / GPU bubble ratio: 3.41%
[rank2]:2025-10-26 05:52:17,586 - INFO - Avg. fwd time: 35.5896 / Avg. bwd time: 53.0076 / Avg. batch time: 1839.2706 (ms) / GPU bubble ratio: 61.46%
[rank1]:2025-10-26 05:52:17,659 - INFO - Avg. fwd time: 50.4786 / Avg. bwd time: 71.0357 / Avg. batch time: 1956.6773 (ms) / GPU bubble ratio: 50.32%
[rank0]:2025-10-26 05:52:17,710 - INFO - Avg. fwd time: 40.2314 / Avg. bwd time: 59.6523 / Avg. batch time: 2054.7839 (ms) / GPU bubble ratio: 61.11%
[rank0]:2025-10-26 05:52:57,839 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 4.1381e-01
[rank2]:2025-10-26 05:52:57,830 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.7029e-01
[rank1]:2025-10-26 05:52:57,838 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 2.4868e-01
[rank3]:2025-10-26 05:52:57,841 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 4.7218e-01
[rank0]:2025-10-26 05:53:31,428 - INFO - [GC] Peforming periodical GC collection 0.03 seconds
[rank3]:2025-10-26 05:53:39,886 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 3.4815e-01
[rank0]:2025-10-26 05:53:39,895 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.3021e-01
[rank2]:2025-10-26 05:53:39,867 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.4187e-01
[rank1]:2025-10-26 05:53:39,875 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 3.2978e-01
[rank3]:2025-10-26 05:54:22,020 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 4.9361e-01
[rank0]:2025-10-26 05:54:22,016 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.4857e-01
[rank1]:2025-10-26 05:54:22,020 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.3815e-01
[rank2]:2025-10-26 05:54:22,008 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.5731e-01
[rank1]:2025-10-26 05:55:03,916 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.6856e-01
[rank1]:2025-10-26 05:55:03,916 - INFO -  step: 160  loss: -4.0000  grad_norm:  0.4323  memory: 10.73GiB(22.58%)  tps: 1,946  tflops: 15.21  mfu: 4.88%
[rank2]:2025-10-26 05:55:03,912 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 4.2608e-01
[rank2]:2025-10-26 05:55:03,912 - INFO -  step: 160  loss: -4.0000  grad_norm:  0.4323  memory:  7.21GiB(15.18%)  tps: 1,946  tflops: 15.21  mfu: 4.88%
[rank3]:2025-10-26 05:55:03,931 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.3357e-01
[rank3]:2025-10-26 05:55:03,934 - INFO -  step: 160  loss:  1.1151  grad_norm:  0.4323  memory: 24.67GiB(51.93%)  tps: 1,946  tflops: 15.21  mfu: 4.88%
[rank0]:2025-10-26 05:55:03,935 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 2.6314e-01
[rank0]:2025-10-26 05:55:03,935 - INFO -  step: 160  loss: -4.0000  grad_norm:  0.4323  memory: 14.87GiB(31.30%)  tps: 1,946  tflops: 15.22  mfu: 4.88%
[rank3]:2025-10-26 05:55:05,846 - INFO - Avg. fwd time: 70.4720 / Avg. bwd time: 140.7969 / Avg. batch time: 1749.3679 (ms) / GPU bubble ratio: 3.39%
[rank2]:2025-10-26 05:55:05,903 - INFO - Avg. fwd time: 35.6041 / Avg. bwd time: 52.4439 / Avg. batch time: 1839.0875 (ms) / GPU bubble ratio: 61.70%
[rank1]:2025-10-26 05:55:05,974 - INFO - Avg. fwd time: 50.3549 / Avg. bwd time: 70.3026 / Avg. batch time: 1955.5869 (ms) / GPU bubble ratio: 50.64%
[rank0]:2025-10-26 05:55:06,024 - INFO - Avg. fwd time: 40.2577 / Avg. bwd time: 59.0217 / Avg. batch time: 2052.9975 (ms) / GPU bubble ratio: 61.31%
[rank3]:2025-10-26 05:55:40,912 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-26 05:55:41,826 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-26 05:55:41,943 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-26 05:55:41,895 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-26 05:55:47,867 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 8.8933e-01
[rank1]:2025-10-26 05:55:47,863 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 6.1091e-01
[rank2]:2025-10-26 05:55:47,857 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.1099e-01
[rank3]:2025-10-26 05:55:47,869 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.8472e-01
[rank3]:2025-10-26 05:56:29,884 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 2.7986e-01
[rank0]:2025-10-26 05:56:29,892 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 2.5822e-01
[rank2]:2025-10-26 05:56:29,865 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.2700e-01
[rank1]:2025-10-26 05:56:29,870 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.1959e-01
[rank2]:2025-10-26 05:57:10,672 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 9.4427e-02
[rank0]:2025-10-26 05:57:10,684 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 2.5672e-01
[rank1]:2025-10-26 05:57:10,677 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.2703e-01
[rank3]:2025-10-26 05:57:10,679 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.8089e-01
[rank2]:2025-10-26 05:57:52,707 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 6.4181e-01
[rank2]:2025-10-26 05:57:52,708 - INFO -  step: 180  loss: -4.0000  grad_norm:  0.4282  memory:  7.21GiB(15.18%)  tps: 1,941  tflops: 15.18  mfu: 4.86%
[rank0]:2025-10-26 05:57:52,735 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 5.3195e-01
[rank0]:2025-10-26 05:57:52,735 - INFO -  step: 180  loss: -4.0000  grad_norm:  0.4282  memory: 14.87GiB(31.30%)  tps: 1,941  tflops: 15.18  mfu: 4.86%
[rank1]:2025-10-26 05:57:52,711 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 4.1813e-01
[rank1]:2025-10-26 05:57:52,712 - INFO -  step: 180  loss: -4.0000  grad_norm:  0.4282  memory: 10.73GiB(22.58%)  tps: 1,941  tflops: 15.18  mfu: 4.86%
[rank3]:2025-10-26 05:57:52,727 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 4.6102e-01
[rank3]:2025-10-26 05:57:52,730 - INFO -  step: 180  loss:  1.0950  grad_norm:  0.4282  memory: 24.67GiB(51.93%)  tps: 1,941  tflops: 15.18  mfu: 4.86%
[rank3]:2025-10-26 05:57:54,609 - INFO - Avg. fwd time: 70.5125 / Avg. bwd time: 140.6317 / Avg. batch time: 1748.0729 (ms) / GPU bubble ratio: 3.37%
[rank2]:2025-10-26 05:57:54,668 - INFO - Avg. fwd time: 35.5938 / Avg. bwd time: 51.9806 / Avg. batch time: 1837.2771 (ms) / GPU bubble ratio: 61.87%
[rank1]:2025-10-26 05:57:54,739 - INFO - Avg. fwd time: 50.3034 / Avg. bwd time: 69.6947 / Avg. batch time: 1953.0653 (ms) / GPU bubble ratio: 50.85%
[rank0]:2025-10-26 05:57:54,792 - INFO - Avg. fwd time: 40.2771 / Avg. bwd time: 58.5227 / Avg. batch time: 2049.9719 (ms) / GPU bubble ratio: 61.44%
[rank3]:2025-10-26 05:58:33,733 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.2728e-01
[rank2]:2025-10-26 05:58:33,725 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.8206e-01
[rank0]:2025-10-26 05:58:33,738 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 9.7086e-01
[rank1]:2025-10-26 05:58:33,732 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 4.4652e-01
[rank0]:2025-10-26 05:59:15,730 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 3.2805e-01
[rank2]:2025-10-26 05:59:15,700 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.5508e-01
[rank1]:2025-10-26 05:59:15,705 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.8067e-01
[rank3]:2025-10-26 05:59:15,720 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 3.5077e-01
[rank3]:2025-10-26 05:59:56,762 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 3.5931e-01
[rank0]:2025-10-26 05:59:56,767 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 8.2249e-01
[rank2]:2025-10-26 05:59:56,754 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.3163e-01
[rank1]:2025-10-26 05:59:56,759 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.2991e-01
[rank0]:2025-10-26 06:00:30,401 - INFO - [GC] Peforming periodical GC collection 0.03 seconds
[rank2]:2025-10-26 06:00:38,851 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 4.9012e-01
[rank2]:2025-10-26 06:00:38,852 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.4034  memory:  7.21GiB(15.18%)  tps: 1,972  tflops: 15.42  mfu: 4.94%
[rank1]:2025-10-26 06:00:38,855 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 4.0220e-01
[rank1]:2025-10-26 06:00:38,856 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.4034  memory: 10.73GiB(22.58%)  tps: 1,972  tflops: 15.42  mfu: 4.94%
[rank3]:2025-10-26 06:00:38,871 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 3.0969e-01
[rank3]:2025-10-26 06:00:38,874 - INFO -  step: 200  loss:  1.0989  grad_norm:  0.4034  memory: 24.67GiB(51.93%)  tps: 1,972  tflops: 15.42  mfu: 4.94%
[rank0]:2025-10-26 06:00:38,881 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.1474e-01
[rank0]:2025-10-26 06:00:38,881 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.4034  memory: 14.87GiB(31.30%)  tps: 1,972  tflops: 15.42  mfu: 4.94%
[rank2]:2025-10-26 06:00:38,955 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_auto_dm1/freeze_ratio_history/rank2/251026_0600_stage2_step200.svg
[rank1]:2025-10-26 06:00:38,961 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_auto_dm1/freeze_ratio_history/rank1/251026_0600_stage1_step200.svg
[rank0]:2025-10-26 06:00:38,957 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_auto_dm1/freeze_ratio_history/rank0/251026_0600_stage0_step200.svg
[rank3]:2025-10-26 06:00:39,123 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_1F1B_auto_dm1/pipeline_schedule/251026_0600_real_step200_rank3.svg
[rank3]:> Batch Time: 1986.66 ms, GPU Bubble Ratio: 59.92%, 52.06%, 64.34%, 14.55%
[rank3]:2025-10-26 06:00:39,191 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_auto_dm1/freeze_ratio_history/rank3/251026_0600_stage3_step200.svg
[rank3]:2025-10-26 06:00:40,952 - INFO - Avg. fwd time: 70.5405 / Avg. bwd time: 140.3419 / Avg. batch time: 1745.7417 (ms) / GPU bubble ratio: 3.36%
[rank2]:2025-10-26 06:00:41,009 - INFO - Avg. fwd time: 35.5800 / Avg. bwd time: 51.5945 / Avg. batch time: 1834.6765 (ms) / GPU bubble ratio: 61.99%
[rank0]:2025-10-26 06:00:41,133 - INFO - Avg. fwd time: 40.3041 / Avg. bwd time: 58.1363 / Avg. batch time: 2046.4466 (ms) / GPU bubble ratio: 61.52%
[rank1]:2025-10-26 06:00:41,083 - INFO - Avg. fwd time: 50.2346 / Avg. bwd time: 69.2006 / Avg. batch time: 1949.9876 (ms) / GPU bubble ratio: 51.00%
[rank3]:2025-10-26 06:01:20,069 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.9696e-01
[rank0]:2025-10-26 06:01:20,074 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 6.0449e-01
[rank2]:2025-10-26 06:01:20,062 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 9.9643e-02
[rank1]:2025-10-26 06:01:20,071 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 3.7747e-01
[rank3]:2025-10-26 06:02:02,131 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 2.5718e-01
[rank0]:2025-10-26 06:02:02,139 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.8087e-01
[rank2]:2025-10-26 06:02:02,111 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.7953e-01
[rank1]:2025-10-26 06:02:02,116 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 4.9393e-01
[rank3]:2025-10-26 06:02:42,857 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.0084e-01
[rank0]:2025-10-26 06:02:42,861 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 2.4630e-01
[rank1]:2025-10-26 06:02:42,856 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.7890e-01
[rank2]:2025-10-26 06:02:42,849 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.0677e-01
[rank3]:2025-10-26 06:03:24,838 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 2.8451e-01
[rank3]:2025-10-26 06:03:24,841 - INFO -  step: 220  loss:  1.0773  grad_norm:  0.4231  memory: 24.67GiB(51.93%)  tps: 1,974  tflops: 15.43  mfu: 4.95%
[rank0]:2025-10-26 06:03:24,850 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.3054e-01
[rank0]:2025-10-26 06:03:24,850 - INFO -  step: 220  loss: -4.0000  grad_norm:  0.4231  memory: 14.87GiB(31.30%)  tps: 1,974  tflops: 15.43  mfu: 4.95%
[rank1]:2025-10-26 06:03:24,823 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.4381e-01
[rank1]:2025-10-26 06:03:24,824 - INFO -  step: 220  loss: -4.0000  grad_norm:  0.4231  memory: 10.73GiB(22.58%)  tps: 1,974  tflops: 15.43  mfu: 4.95%
[rank2]:2025-10-26 06:03:24,819 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 4.0463e-01
[rank2]:2025-10-26 06:03:24,820 - INFO -  step: 220  loss: -4.0000  grad_norm:  0.4231  memory:  7.21GiB(15.18%)  tps: 1,974  tflops: 15.43  mfu: 4.95%
[rank3]:2025-10-26 06:03:26,710 - INFO - Avg. fwd time: 70.5483 / Avg. bwd time: 140.0426 / Avg. batch time: 1743.2157 (ms) / GPU bubble ratio: 3.36%
[rank2]:2025-10-26 06:03:26,770 - INFO - Avg. fwd time: 35.5535 / Avg. bwd time: 51.2658 / Avg. batch time: 1831.7417 (ms) / GPU bubble ratio: 62.08%
[rank1]:2025-10-26 06:03:26,853 - INFO - Avg. fwd time: 50.1975 / Avg. bwd time: 68.7754 / Avg. batch time: 1946.7724 (ms) / GPU bubble ratio: 51.11%
[rank0]:2025-10-26 06:03:26,904 - INFO - Avg. fwd time: 40.3039 / Avg. bwd time: 57.8120 / Avg. batch time: 2042.8797 (ms) / GPU bubble ratio: 61.58%
[rank2]:2025-10-26 06:04:05,743 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.2841e-01
[rank0]:2025-10-26 06:04:05,759 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 1.2910e+00
[rank3]:2025-10-26 06:04:05,751 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 3.6614e-01
[rank1]:2025-10-26 06:04:05,748 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.6551e-01
[rank0]:2025-10-26 06:04:47,867 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 4.8585e-01
[rank3]:2025-10-26 06:04:47,857 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 1.9336e-01
[rank1]:2025-10-26 06:04:47,841 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.8008e-01
[rank2]:2025-10-26 06:04:47,837 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.7405e-01
[rank3]:2025-10-26 06:05:28,804 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.2663e-01
[rank0]:2025-10-26 06:05:28,808 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 2.6967e-01
[rank2]:2025-10-26 06:05:28,796 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 8.8954e-02
[rank1]:2025-10-26 06:05:28,801 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 3.2337e-01
[rank3]:2025-10-26 06:06:10,837 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 1.2376e-01
[rank3]:2025-10-26 06:06:10,840 - INFO -  step: 240  loss:  1.0328  grad_norm:  0.4276  memory: 24.67GiB(51.93%)  tps: 1,974  tflops: 15.43  mfu: 4.95%
[rank0]:2025-10-26 06:06:10,844 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 9.6196e-02
[rank0]:2025-10-26 06:06:10,845 - INFO -  step: 240  loss: -4.0000  grad_norm:  0.4276  memory: 14.87GiB(31.30%)  tps: 1,974  tflops: 15.43  mfu: 4.95%
[rank2]:2025-10-26 06:06:10,817 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.8189e-01
[rank2]:2025-10-26 06:06:10,818 - INFO -  step: 240  loss: -4.0000  grad_norm:  0.4276  memory:  7.21GiB(15.18%)  tps: 1,974  tflops: 15.43  mfu: 4.95%
[rank1]:2025-10-26 06:06:10,822 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.7540e-01
[rank1]:2025-10-26 06:06:10,822 - INFO -  step: 240  loss: -4.0000  grad_norm:  0.4276  memory: 10.73GiB(22.58%)  tps: 1,974  tflops: 15.43  mfu: 4.95%
[rank3]:2025-10-26 06:06:12,707 - INFO - Avg. fwd time: 70.5621 / Avg. bwd time: 139.8176 / Avg. batch time: 1741.3662 (ms) / GPU bubble ratio: 3.35%
[rank2]:2025-10-26 06:06:12,768 - INFO - Avg. fwd time: 35.5382 / Avg. bwd time: 50.9939 / Avg. batch time: 1829.5898 (ms) / GPU bubble ratio: 62.16%
[rank1]:2025-10-26 06:06:12,840 - INFO - Avg. fwd time: 50.1537 / Avg. bwd time: 68.4363 / Avg. batch time: 1944.3125 (ms) / GPU bubble ratio: 51.21%
[rank0]:2025-10-26 06:06:12,891 - INFO - Avg. fwd time: 40.3118 / Avg. bwd time: 57.5504 / Avg. batch time: 2040.1335 (ms) / GPU bubble ratio: 61.63%
[rank3]:2025-10-26 06:06:51,995 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.4940e-01
[rank0]:2025-10-26 06:06:52,000 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 3.7866e-01
[rank2]:2025-10-26 06:06:51,987 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 7.5526e-02
[rank1]:2025-10-26 06:06:51,991 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.9148e-01
[rank3]:2025-10-26 06:07:05,747 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-26 06:07:06,656 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-26 06:07:06,714 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-26 06:07:06,779 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-26 06:07:28,234 - INFO - [GC] Peforming periodical GC collection 0.03 seconds
[rank1]:2025-10-26 06:07:36,705 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.7266e-01
[rank2]:2025-10-26 06:07:36,701 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.9465e-01
[rank3]:2025-10-26 06:07:36,721 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 2.6493e-01
[rank0]:2025-10-26 06:07:36,730 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.4830e-01
[rank0]:2025-10-26 06:08:17,761 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 4.0220e-01
[rank2]:2025-10-26 06:08:17,753 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.5975e-01
[rank1]:2025-10-26 06:08:17,758 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 4.6125e-01
[rank3]:2025-10-26 06:08:17,761 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.3412e-01
[rank2]:2025-10-26 06:08:59,809 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.8496e-01
[rank2]:2025-10-26 06:08:59,810 - INFO -  step: 260  loss: -4.0000  grad_norm:  0.4151  memory:  7.21GiB(15.18%)  tps: 1,939  tflops: 15.16  mfu: 4.86%
[rank1]:2025-10-26 06:08:59,814 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.4233e-01
[rank1]:2025-10-26 06:08:59,815 - INFO -  step: 260  loss: -4.0000  grad_norm:  0.4151  memory: 10.73GiB(22.58%)  tps: 1,939  tflops: 15.16  mfu: 4.86%
[rank3]:2025-10-26 06:08:59,829 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 1.7256e-01
[rank3]:2025-10-26 06:08:59,832 - INFO -  step: 260  loss:  1.0469  grad_norm:  0.4151  memory: 24.67GiB(51.93%)  tps: 1,939  tflops: 15.16  mfu: 4.86%
[rank0]:2025-10-26 06:08:59,839 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 9.0442e-02
[rank0]:2025-10-26 06:08:59,840 - INFO -  step: 260  loss: -4.0000  grad_norm:  0.4151  memory: 14.87GiB(31.30%)  tps: 1,939  tflops: 15.16  mfu: 4.86%
[rank3]:2025-10-26 06:09:01,730 - INFO - Avg. fwd time: 70.5975 / Avg. bwd time: 139.6803 / Avg. batch time: 1740.4165 (ms) / GPU bubble ratio: 3.34%
[rank2]:2025-10-26 06:09:01,787 - INFO - Avg. fwd time: 35.5147 / Avg. bwd time: 50.7725 / Avg. batch time: 1828.4259 (ms) / GPU bubble ratio: 62.25%
[rank0]:2025-10-26 06:09:01,911 - INFO - Avg. fwd time: 40.3191 / Avg. bwd time: 57.3300 / Avg. batch time: 2038.4401 (ms) / GPU bubble ratio: 61.68%
[rank1]:2025-10-26 06:09:01,860 - INFO - Avg. fwd time: 50.1248 / Avg. bwd time: 68.1569 / Avg. batch time: 1942.9087 (ms) / GPU bubble ratio: 51.30%
[rank0]:2025-10-26 06:09:40,962 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 8.1124e-01
[rank1]:2025-10-26 06:09:40,960 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.6671e-01
[rank2]:2025-10-26 06:09:40,954 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.2262e-01
[rank3]:2025-10-26 06:09:40,976 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 3.6753e-01
[rank1]:2025-10-26 06:10:23,020 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 4.6637e-01
[rank2]:2025-10-26 06:10:23,016 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 7.3969e-01
[rank3]:2025-10-26 06:10:23,035 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 6.0714e-01
[rank0]:2025-10-26 06:10:23,043 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 4.2368e-01
[rank0]:2025-10-26 06:11:04,084 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 6.4433e-01
[rank2]:2025-10-26 06:11:04,076 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 7.3112e-02
[rank1]:2025-10-26 06:11:04,081 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.8568e-01
[rank3]:2025-10-26 06:11:04,084 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.2430e-01
[rank0]:2025-10-26 06:11:46,120 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 2.3375e-01
[rank0]:2025-10-26 06:11:46,120 - INFO -  step: 280  loss: -4.0000  grad_norm:  0.4287  memory: 14.87GiB(31.30%)  tps: 1,971  tflops: 15.41  mfu: 4.94%
[rank2]:2025-10-26 06:11:46,090 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.6819e-01
[rank2]:2025-10-26 06:11:46,091 - INFO -  step: 280  loss: -4.0000  grad_norm:  0.4287  memory:  7.21GiB(15.18%)  tps: 1,971  tflops: 15.41  mfu: 4.94%
[rank1]:2025-10-26 06:11:46,096 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.8112e-01
[rank1]:2025-10-26 06:11:46,096 - INFO -  step: 280  loss: -4.0000  grad_norm:  0.4287  memory: 10.73GiB(22.58%)  tps: 1,971  tflops: 15.41  mfu: 4.94%
[rank3]:2025-10-26 06:11:46,110 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 2.0058e-01
[rank3]:2025-10-26 06:11:46,113 - INFO -  step: 280  loss:  1.0451  grad_norm:  0.4287  memory: 24.67GiB(51.93%)  tps: 1,971  tflops: 15.41  mfu: 4.94%
[rank3]:2025-10-26 06:11:47,987 - INFO - Avg. fwd time: 70.6134 / Avg. bwd time: 139.5460 / Avg. batch time: 1739.3534 (ms) / GPU bubble ratio: 3.34%
[rank2]:2025-10-26 06:11:48,045 - INFO - Avg. fwd time: 35.5031 / Avg. bwd time: 50.5958 / Avg. batch time: 1827.1567 (ms) / GPU bubble ratio: 62.30%
[rank1]:2025-10-26 06:11:48,116 - INFO - Avg. fwd time: 50.1165 / Avg. bwd time: 67.9369 / Avg. batch time: 1941.4655 (ms) / GPU bubble ratio: 51.35%
[rank0]:2025-10-26 06:11:48,168 - INFO - Avg. fwd time: 40.3085 / Avg. bwd time: 57.1272 / Avg. batch time: 2036.7133 (ms) / GPU bubble ratio: 61.73%
[rank2]:2025-10-26 06:12:26,909 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.3424e-01
[rank1]:2025-10-26 06:12:26,913 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 6.8275e-01
[rank3]:2025-10-26 06:12:26,916 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 4.9350e-01
[rank0]:2025-10-26 06:12:26,921 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 3.6037e-01
[rank2]:2025-10-26 06:13:08,926 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.8659e-01
[rank1]:2025-10-26 06:13:08,930 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.7229e-01
[rank3]:2025-10-26 06:13:08,946 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 3.4096e-01
[rank0]:2025-10-26 06:13:08,955 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 2.9546e-01
[rank2]:2025-10-26 06:13:50,003 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.8096e-01
[rank1]:2025-10-26 06:13:50,007 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.8283e-01
[rank3]:2025-10-26 06:13:50,010 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 4.7054e-01
[rank0]:2025-10-26 06:13:50,018 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 3.7264e-01
[rank0]:2025-10-26 06:14:23,625 - INFO - [GC] Peforming periodical GC collection 0.03 seconds
[rank3]:2025-10-26 06:14:32,097 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 2.8379e-01
[rank3]:2025-10-26 06:14:32,100 - INFO -  step: 300  loss:  1.0161  grad_norm:  0.4251  memory: 24.67GiB(51.93%)  tps: 1,974  tflops: 15.43  mfu: 4.95%
[rank0]:2025-10-26 06:14:32,107 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.6256e-01
[rank0]:2025-10-26 06:14:32,107 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.4251  memory: 14.87GiB(31.30%)  tps: 1,974  tflops: 15.43  mfu: 4.95%
[rank2]:2025-10-26 06:14:32,078 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 4.3453e-01
[rank2]:2025-10-26 06:14:32,079 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.4251  memory:  7.21GiB(15.18%)  tps: 1,974  tflops: 15.43  mfu: 4.95%
[rank1]:2025-10-26 06:14:32,084 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 3.7044e-01
[rank1]:2025-10-26 06:14:32,084 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.4251  memory: 10.73GiB(22.58%)  tps: 1,974  tflops: 15.43  mfu: 4.95%
[rank0]:2025-10-26 06:14:32,177 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_auto_dm1/freeze_ratio_history/rank0/251026_0614_stage0_step300.svg
[rank2]:2025-10-26 06:14:32,178 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_auto_dm1/freeze_ratio_history/rank2/251026_0614_stage2_step300.svg
[rank1]:2025-10-26 06:14:32,184 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_auto_dm1/freeze_ratio_history/rank1/251026_0614_stage1_step300.svg
[rank3]:2025-10-26 06:14:32,353 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_1F1B_auto_dm1/pipeline_schedule/251026_0614_real_step300_rank3.svg
[rank3]:> Batch Time: 1983.78 ms, GPU Bubble Ratio: 59.95%, 52.55%, 64.49%, 14.53%
[rank3]:2025-10-26 06:14:32,419 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_auto_dm1/freeze_ratio_history/rank3/251026_0614_stage3_step300.svg
[rank3]:2025-10-26 06:14:34,189 - INFO - Avg. fwd time: 70.6104 / Avg. bwd time: 139.4209 / Avg. batch time: 1738.2286 (ms) / GPU bubble ratio: 3.34%
[rank2]:2025-10-26 06:14:34,246 - INFO - Avg. fwd time: 35.4831 / Avg. bwd time: 50.4150 / Avg. batch time: 1825.9168 (ms) / GPU bubble ratio: 62.36%
[rank1]:2025-10-26 06:14:34,318 - INFO - Avg. fwd time: 50.0819 / Avg. bwd time: 67.7315 / Avg. batch time: 1940.0259 (ms) / GPU bubble ratio: 51.42%
[rank0]:2025-10-26 06:14:34,370 - INFO - Avg. fwd time: 40.3121 / Avg. bwd time: 56.9647 / Avg. batch time: 2035.0611 (ms) / GPU bubble ratio: 61.76%
[rank2]:2025-10-26 06:15:13,424 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.6849e-01
[rank1]:2025-10-26 06:15:13,435 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 2.2052e-01
[rank3]:2025-10-26 06:15:13,432 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 3.3361e-01
[rank0]:2025-10-26 06:15:13,433 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 3.1624e-01
[rank2]:2025-10-26 06:15:55,415 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.8453e-01
[rank1]:2025-10-26 06:15:55,420 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 3.2555e-01
[rank3]:2025-10-26 06:15:55,435 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 4.8181e-01
[rank0]:2025-10-26 06:15:55,443 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 2.8316e-01
[rank2]:2025-10-26 06:16:36,672 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.0893e-01
[rank1]:2025-10-26 06:16:36,677 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.3749e-01
[rank3]:2025-10-26 06:16:36,685 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.8261e-01
[rank0]:2025-10-26 06:16:36,684 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 8.0662e-01
[rank2]:2025-10-26 06:17:18,742 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.2402e+00
[rank2]:2025-10-26 06:17:18,743 - INFO -  step: 320  loss: -4.0000  grad_norm:  0.4789  memory:  7.21GiB(15.18%)  tps: 1,966  tflops: 15.37  mfu: 4.93%
[rank3]:2025-10-26 06:17:18,762 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 7.5221e-01
[rank3]:2025-10-26 06:17:18,766 - INFO -  step: 320  loss:  1.0387  grad_norm:  0.4789  memory: 24.67GiB(51.93%)  tps: 1,966  tflops: 15.37  mfu: 4.93%
[rank1]:2025-10-26 06:17:18,746 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 8.2838e-01
[rank1]:2025-10-26 06:17:18,747 - INFO -  step: 320  loss: -4.0000  grad_norm:  0.4789  memory: 10.73GiB(22.58%)  tps: 1,966  tflops: 15.37  mfu: 4.93%
[rank0]:2025-10-26 06:17:18,776 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 6.9209e-01
[rank0]:2025-10-26 06:17:18,776 - INFO -  step: 320  loss: -4.0000  grad_norm:  0.4789  memory: 14.87GiB(31.30%)  tps: 1,966  tflops: 15.37  mfu: 4.93%
[rank3]:2025-10-26 06:17:20,650 - INFO - Avg. fwd time: 70.6289 / Avg. bwd time: 139.3322 / Avg. batch time: 1737.5797 (ms) / GPU bubble ratio: 3.33%
[rank2]:2025-10-26 06:17:20,710 - INFO - Avg. fwd time: 35.4802 / Avg. bwd time: 50.2774 / Avg. batch time: 1825.1289 (ms) / GPU bubble ratio: 62.41%
[rank1]:2025-10-26 06:17:20,791 - INFO - Avg. fwd time: 50.0762 / Avg. bwd time: 67.5608 / Avg. batch time: 1939.1013 (ms) / GPU bubble ratio: 51.47%
[rank0]:2025-10-26 06:17:20,842 - INFO - Avg. fwd time: 40.3228 / Avg. bwd time: 56.8128 / Avg. batch time: 2033.9589 (ms) / GPU bubble ratio: 61.79%
[rank2]:2025-10-26 06:17:59,517 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 6.4243e-01
[rank0]:2025-10-26 06:17:59,530 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 9.3387e-01
[rank1]:2025-10-26 06:17:59,521 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 8.2425e-01
[rank3]:2025-10-26 06:17:59,554 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.1414e+00
[rank3]:2025-10-26 06:18:34,192 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-26 06:18:35,108 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-26 06:18:35,165 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-26 06:18:35,239 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-26 06:18:43,482 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 3.5311e-01
[rank1]:2025-10-26 06:18:43,486 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.5856e-01
[rank3]:2025-10-26 06:18:43,502 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 3.8138e-01
[rank0]:2025-10-26 06:18:43,516 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.6513e-01
[rank3]:2025-10-26 06:19:24,349 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.6104e-01
[rank1]:2025-10-26 06:19:24,346 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 2.6401e-01
[rank2]:2025-10-26 06:19:24,342 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.1658e-01
[rank0]:2025-10-26 06:19:24,354 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 4.7145e-01
[rank2]:2025-10-26 06:20:06,354 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.7853e-01
[rank2]:2025-10-26 06:20:06,354 - INFO -  step: 340  loss: -4.0000  grad_norm:  0.4358  memory:  7.21GiB(15.18%)  tps: 1,955  tflops: 15.28  mfu: 4.90%
[rank0]:2025-10-26 06:20:06,382 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 2.2520e-01
[rank0]:2025-10-26 06:20:06,383 - INFO -  step: 340  loss: -4.0000  grad_norm:  0.4358  memory: 14.87GiB(31.30%)  tps: 1,955  tflops: 15.28  mfu: 4.90%
[rank3]:2025-10-26 06:20:06,373 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 3.3017e-01
[rank3]:2025-10-26 06:20:06,376 - INFO -  step: 340  loss:  0.9906  grad_norm:  0.4358  memory: 24.67GiB(51.93%)  tps: 1,955  tflops: 15.28  mfu: 4.90%
[rank1]:2025-10-26 06:20:06,359 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.1796e-01
[rank1]:2025-10-26 06:20:06,359 - INFO -  step: 340  loss: -4.0000  grad_norm:  0.4358  memory: 10.73GiB(22.58%)  tps: 1,955  tflops: 15.28  mfu: 4.90%
[rank3]:2025-10-26 06:20:08,232 - INFO - Avg. fwd time: 70.6325 / Avg. bwd time: 139.2099 / Avg. batch time: 1736.5532 (ms) / GPU bubble ratio: 3.33%
[rank2]:2025-10-26 06:20:08,295 - INFO - Avg. fwd time: 35.4789 / Avg. bwd time: 50.1412 / Avg. batch time: 1823.9359 (ms) / GPU bubble ratio: 62.45%
[rank1]:2025-10-26 06:20:08,376 - INFO - Avg. fwd time: 50.0402 / Avg. bwd time: 67.3600 / Avg. batch time: 1937.8387 (ms) / GPU bubble ratio: 51.53%
[rank0]:2025-10-26 06:20:08,428 - INFO - Avg. fwd time: 40.3258 / Avg. bwd time: 56.6804 / Avg. batch time: 2032.5646 (ms) / GPU bubble ratio: 61.82%
[rank2]:2025-10-26 06:20:47,232 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.6553e-01
[rank0]:2025-10-26 06:20:47,245 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 4.6590e-01
[rank1]:2025-10-26 06:20:47,240 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 3.9191e-01
[rank3]:2025-10-26 06:20:47,267 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 3.3324e-01
[rank0]:2025-10-26 06:21:20,906 - INFO - [GC] Peforming periodical GC collection 0.03 seconds
[rank2]:2025-10-26 06:21:29,349 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.3716e-01
[rank0]:2025-10-26 06:21:29,379 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 2.8033e-01
[rank3]:2025-10-26 06:21:29,368 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 2.8118e-01
[rank1]:2025-10-26 06:21:29,353 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.1449e-01
[rank1]:2025-10-26 06:22:10,301 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 9.4993e-02
[rank2]:2025-10-26 06:22:10,291 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.3368e-01
[rank0]:2025-10-26 06:22:10,303 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 4.7198e-01
[rank3]:2025-10-26 06:22:10,299 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.9691e-01
[rank1]:2025-10-26 06:22:52,344 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 3.4301e-01
[rank1]:2025-10-26 06:22:52,344 - INFO -  step: 360  loss: -4.0000  grad_norm:  0.4480  memory: 10.73GiB(22.58%)  tps: 1,974  tflops: 15.43  mfu: 4.95%
[rank0]:2025-10-26 06:22:52,370 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 8.9708e-02
[rank0]:2025-10-26 06:22:52,370 - INFO -  step: 360  loss: -4.0000  grad_norm:  0.4480  memory: 14.87GiB(31.30%)  tps: 1,974  tflops: 15.43  mfu: 4.95%
[rank2]:2025-10-26 06:22:52,339 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 4.2593e-01
[rank2]:2025-10-26 06:22:52,340 - INFO -  step: 360  loss: -4.0000  grad_norm:  0.4480  memory:  7.21GiB(15.18%)  tps: 1,974  tflops: 15.43  mfu: 4.95%
[rank3]:2025-10-26 06:22:52,359 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 5.8279e-01
[rank3]:2025-10-26 06:22:52,363 - INFO -  step: 360  loss:  1.0221  grad_norm:  0.4480  memory: 24.67GiB(51.93%)  tps: 1,974  tflops: 15.43  mfu: 4.95%
[rank2]:2025-10-26 06:22:54,308 - INFO - Avg. fwd time: 35.4700 / Avg. bwd time: 50.0209 / Avg. batch time: 1823.0487 (ms) / GPU bubble ratio: 62.48%
[rank3]:2025-10-26 06:22:54,248 - INFO - Avg. fwd time: 70.6354 / Avg. bwd time: 139.1227 / Avg. batch time: 1735.8102 (ms) / GPU bubble ratio: 3.33%
[rank1]:2025-10-26 06:22:54,380 - INFO - Avg. fwd time: 50.0340 / Avg. bwd time: 67.2050 / Avg. batch time: 1936.8183 (ms) / GPU bubble ratio: 51.57%
[rank0]:2025-10-26 06:22:54,435 - INFO - Avg. fwd time: 40.3231 / Avg. bwd time: 56.5509 / Avg. batch time: 2031.3765 (ms) / GPU bubble ratio: 61.85%
[rank2]:2025-10-26 06:23:33,531 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 7.2211e-02
[rank0]:2025-10-26 06:23:33,543 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 7.2078e-01
[rank3]:2025-10-26 06:23:33,539 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 3.0278e-01
[rank1]:2025-10-26 06:23:33,536 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.6268e-01
[rank0]:2025-10-26 06:24:15,709 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.2025e-01
[rank2]:2025-10-26 06:24:15,676 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 3.7206e-01
[rank3]:2025-10-26 06:24:15,695 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 2.0639e-01
[rank1]:2025-10-26 06:24:15,680 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.0142e-01
[rank3]:2025-10-26 06:24:56,804 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.7125e-01
[rank1]:2025-10-26 06:24:56,801 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.2577e-01
[rank2]:2025-10-26 06:24:56,797 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 5.0641e-02
[rank0]:2025-10-26 06:24:56,809 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 7.4256e-01
[rank1]:2025-10-26 06:25:38,853 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 7.7827e-01
[rank1]:2025-10-26 06:25:38,854 - INFO -  step: 380  loss: -4.0000  grad_norm:  0.4429  memory: 10.73GiB(22.58%)  tps: 1,968  tflops: 15.38  mfu: 4.93%
[rank2]:2025-10-26 06:25:38,849 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.9902e-01
[rank2]:2025-10-26 06:25:38,850 - INFO -  step: 380  loss: -4.0000  grad_norm:  0.4429  memory:  7.21GiB(15.18%)  tps: 1,968  tflops: 15.38  mfu: 4.93%
[rank0]:2025-10-26 06:25:38,879 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 2.4117e-01
[rank0]:2025-10-26 06:25:38,879 - INFO -  step: 380  loss: -4.0000  grad_norm:  0.4429  memory: 14.87GiB(31.30%)  tps: 1,968  tflops: 15.38  mfu: 4.93%
[rank3]:2025-10-26 06:25:38,869 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 1.5280e-01
[rank3]:2025-10-26 06:25:38,872 - INFO -  step: 380  loss:  0.9576  grad_norm:  0.4429  memory: 24.67GiB(51.93%)  tps: 1,968  tflops: 15.38  mfu: 4.93%
[rank3]:2025-10-26 06:25:40,751 - INFO - Avg. fwd time: 70.6484 / Avg. bwd time: 139.0556 / Avg. batch time: 1735.3158 (ms) / GPU bubble ratio: 3.32%
[rank2]:2025-10-26 06:25:40,816 - INFO - Avg. fwd time: 35.4714 / Avg. bwd time: 49.9255 / Avg. batch time: 1822.4689 (ms) / GPU bubble ratio: 62.51%
[rank1]:2025-10-26 06:25:40,900 - INFO - Avg. fwd time: 50.0566 / Avg. bwd time: 67.0880 / Avg. batch time: 1936.1788 (ms) / GPU bubble ratio: 51.60%
[rank0]:2025-10-26 06:25:40,953 - INFO - Avg. fwd time: 40.3132 / Avg. bwd time: 56.4495 / Avg. batch time: 2030.6157 (ms) / GPU bubble ratio: 61.88%
[rank2]:2025-10-26 06:26:19,863 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.4959e-01
[rank0]:2025-10-26 06:26:19,875 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 8.9632e-01
[rank3]:2025-10-26 06:26:19,871 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.8693e-01
[rank1]:2025-10-26 06:26:19,867 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 6.7815e-01
[rank2]:2025-10-26 06:27:01,887 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 3.8643e-01
[rank0]:2025-10-26 06:27:01,919 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 2.8655e-01
[rank3]:2025-10-26 06:27:01,907 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 2.5667e-01
[rank1]:2025-10-26 06:27:01,892 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 3.0361e-01
[rank1]:2025-10-26 06:27:42,708 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.1223e-01
[rank2]:2025-10-26 06:27:42,704 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.2786e-01
[rank0]:2025-10-26 06:27:42,715 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 4.6341e-01
[rank3]:2025-10-26 06:27:42,797 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 3.5113e-01
[rank0]:2025-10-26 06:28:16,367 - INFO - [GC] Peforming periodical GC collection 0.03 seconds
[rank1]:2025-10-26 06:28:24,744 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.8722e-01
[rank1]:2025-10-26 06:28:24,745 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.4315  memory: 10.73GiB(22.58%)  tps: 1,975  tflops: 15.44  mfu: 4.95%
[rank0]:2025-10-26 06:28:24,769 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.1109e-01
[rank0]:2025-10-26 06:28:24,769 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.4315  memory: 14.87GiB(31.30%)  tps: 1,975  tflops: 15.44  mfu: 4.95%
[rank2]:2025-10-26 06:28:24,740 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.0477e-01
[rank2]:2025-10-26 06:28:24,740 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.4315  memory:  7.21GiB(15.18%)  tps: 1,975  tflops: 15.44  mfu: 4.95%
[rank3]:2025-10-26 06:28:24,759 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 2.4987e-01
[rank3]:2025-10-26 06:28:24,762 - INFO -  step: 400  loss:  0.9455  grad_norm:  0.4315  memory: 24.67GiB(51.93%)  tps: 1,975  tflops: 15.44  mfu: 4.95%
[rank1]:2025-10-26 06:28:24,853 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_auto_dm1/freeze_ratio_history/rank1/251026_0628_stage1_step400.svg
[rank0]:2025-10-26 06:28:24,845 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_auto_dm1/freeze_ratio_history/rank0/251026_0628_stage0_step400.svg
[rank2]:2025-10-26 06:28:24,846 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_auto_dm1/freeze_ratio_history/rank2/251026_0628_stage2_step400.svg
[rank3]:2025-10-26 06:28:25,019 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_1F1B_auto_dm1/pipeline_schedule/251026_0628_real_step400_rank3.svg
[rank3]:> Batch Time: 1982.31 ms, GPU Bubble Ratio: 59.93%, 52.67%, 64.49%, 14.53%
[rank3]:2025-10-26 06:28:25,090 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_auto_dm1/freeze_ratio_history/rank3/251026_0628_stage3_step400.svg
[rank3]:2025-10-26 06:28:26,845 - INFO - Avg. fwd time: 70.6494 / Avg. bwd time: 138.9704 / Avg. batch time: 1734.5860 (ms) / GPU bubble ratio: 3.32%
[rank2]:2025-10-26 06:28:26,904 - INFO - Avg. fwd time: 35.4665 / Avg. bwd time: 49.8235 / Avg. batch time: 1821.7006 (ms) / GPU bubble ratio: 62.54%
[rank1]:2025-10-26 06:28:26,987 - INFO - Avg. fwd time: 50.0554 / Avg. bwd time: 66.9595 / Avg. batch time: 1935.2684 (ms) / GPU bubble ratio: 51.63%
[rank0]:2025-10-26 06:28:27,038 - INFO - Avg. fwd time: 40.3114 / Avg. bwd time: 56.3554 / Avg. batch time: 2029.6135 (ms) / GPU bubble ratio: 61.90%
[rank0]:2025-10-26 06:29:05,971 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 3.7245e-01
[rank2]:2025-10-26 06:29:05,961 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.4011e-01
[rank3]:2025-10-26 06:29:05,968 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 6.6353e-01
[rank1]:2025-10-26 06:29:05,970 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 5.0816e-01
[rank2]:2025-10-26 06:29:47,912 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 4.5436e-01
[rank3]:2025-10-26 06:29:47,931 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 3.5235e-01
[rank1]:2025-10-26 06:29:47,916 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 3.6338e-01
[rank0]:2025-10-26 06:29:47,941 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.7695e-01
[rank3]:2025-10-26 06:29:59,241 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-26 06:30:00,148 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-26 06:30:00,221 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-26 06:30:00,269 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-26 06:30:30,898 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 4.7655e-01
[rank2]:2025-10-26 06:30:30,894 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 6.8385e-02
[rank0]:2025-10-26 06:30:30,905 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 6.8487e-01
[rank3]:2025-10-26 06:30:30,972 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.6072e-01
[rank1]:2025-10-26 06:31:12,914 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.3517e-01
[rank1]:2025-10-26 06:31:12,915 - INFO -  step: 420  loss: -4.0000  grad_norm:  0.4062  memory: 10.73GiB(22.58%)  tps: 1,949  tflops: 15.23  mfu: 4.88%
[rank2]:2025-10-26 06:31:12,909 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.3136e-01
[rank2]:2025-10-26 06:31:12,910 - INFO -  step: 420  loss: -4.0000  grad_norm:  0.4062  memory:  7.21GiB(15.18%)  tps: 1,949  tflops: 15.23  mfu: 4.88%
[rank0]:2025-10-26 06:31:12,932 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 2.0077e-01
[rank0]:2025-10-26 06:31:12,933 - INFO -  step: 420  loss: -4.0000  grad_norm:  0.4062  memory: 14.87GiB(31.30%)  tps: 1,949  tflops: 15.23  mfu: 4.88%
[rank3]:2025-10-26 06:31:12,929 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 5.5426e-01
[rank3]:2025-10-26 06:31:12,932 - INFO -  step: 420  loss:  0.9152  grad_norm:  0.4062  memory: 24.67GiB(51.93%)  tps: 1,949  tflops: 15.23  mfu: 4.88%
[rank3]:2025-10-26 06:31:14,804 - INFO - Avg. fwd time: 70.6446 / Avg. bwd time: 138.9021 / Avg. batch time: 1733.9513 (ms) / GPU bubble ratio: 3.32%
[rank1]:2025-10-26 06:31:14,935 - INFO - Avg. fwd time: 50.0365 / Avg. bwd time: 66.8535 / Avg. batch time: 1934.4430 (ms) / GPU bubble ratio: 51.66%
[rank2]:2025-10-26 06:31:14,862 - INFO - Avg. fwd time: 35.4609 / Avg. bwd time: 49.7395 / Avg. batch time: 1820.9412 (ms) / GPU bubble ratio: 62.57%
[rank0]:2025-10-26 06:31:14,987 - INFO - Avg. fwd time: 40.3022 / Avg. bwd time: 56.2667 / Avg. batch time: 2028.8776 (ms) / GPU bubble ratio: 61.92%
[rank3]:2025-10-26 06:31:53,838 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.9530e-01
[rank1]:2025-10-26 06:31:53,836 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 4.2478e-01
[rank2]:2025-10-26 06:31:53,830 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 8.9080e-02
[rank0]:2025-10-26 06:31:53,838 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 4.6091e-01
[rank3]:2025-10-26 06:32:35,985 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 3.3596e-01
[rank1]:2025-10-26 06:32:35,970 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 3.3250e-01
[rank2]:2025-10-26 06:32:35,966 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.1424e-01
[rank0]:2025-10-26 06:32:35,993 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.3269e-01
[rank2]:2025-10-26 06:33:17,201 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.1450e-01
[rank0]:2025-10-26 06:33:17,214 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 1.4034e-01
[rank3]:2025-10-26 06:33:17,218 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 3.3363e-01
[rank1]:2025-10-26 06:33:17,211 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.3694e-01
[rank2]:2025-10-26 06:33:59,164 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.3174e-01
[rank2]:2025-10-26 06:33:59,165 - INFO -  step: 440  loss: -4.0000  grad_norm:  0.4302  memory:  7.21GiB(15.18%)  tps: 1,971  tflops: 15.41  mfu: 4.94%
[rank3]:2025-10-26 06:33:59,184 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 1.2528e-01
[rank3]:2025-10-26 06:33:59,187 - INFO -  step: 440  loss:  0.9367  grad_norm:  0.4302  memory: 24.67GiB(51.93%)  tps: 1,971  tflops: 15.41  mfu: 4.94%
[rank1]:2025-10-26 06:33:59,169 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 3.2370e-01
[rank1]:2025-10-26 06:33:59,170 - INFO -  step: 440  loss: -4.0000  grad_norm:  0.4302  memory: 10.73GiB(22.58%)  tps: 1,971  tflops: 15.41  mfu: 4.94%
[rank0]:2025-10-26 06:33:59,193 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.7227e-01
[rank0]:2025-10-26 06:33:59,193 - INFO -  step: 440  loss: -4.0000  grad_norm:  0.4302  memory: 14.87GiB(31.30%)  tps: 1,971  tflops: 15.41  mfu: 4.94%
[rank3]:2025-10-26 06:34:01,053 - INFO - Avg. fwd time: 70.6511 / Avg. bwd time: 138.8464 / Avg. batch time: 1733.5130 (ms) / GPU bubble ratio: 3.32%
[rank2]:2025-10-26 06:34:01,116 - INFO - Avg. fwd time: 35.4588 / Avg. bwd time: 49.6755 / Avg. batch time: 1820.4135 (ms) / GPU bubble ratio: 62.59%
[rank1]:2025-10-26 06:34:01,197 - INFO - Avg. fwd time: 50.0362 / Avg. bwd time: 66.7680 / Avg. batch time: 1933.8718 (ms) / GPU bubble ratio: 51.68%
[rank0]:2025-10-26 06:34:01,249 - INFO - Avg. fwd time: 40.3037 / Avg. bwd time: 56.1923 / Avg. batch time: 2028.2105 (ms) / GPU bubble ratio: 61.94%
[rank1]:2025-10-26 06:34:40,055 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.5640e-01
[rank2]:2025-10-26 06:34:40,049 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.7075e-01
[rank3]:2025-10-26 06:34:40,056 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.9618e-01
[rank0]:2025-10-26 06:34:40,061 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.2434e-01
[rank0]:2025-10-26 06:35:13,785 - INFO - [GC] Peforming periodical GC collection 0.03 seconds
[rank1]:2025-10-26 06:35:22,239 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.6072e-01
[rank3]:2025-10-26 06:35:22,251 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 2.1830e-01
[rank2]:2025-10-26 06:35:22,232 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.1064e-01
[rank0]:2025-10-26 06:35:22,262 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 2.0253e-01
[rank1]:2025-10-26 06:36:03,198 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.6798e-01
[rank3]:2025-10-26 06:36:03,194 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.8011e-01
[rank0]:2025-10-26 06:36:03,200 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 8.6709e-01
[rank2]:2025-10-26 06:36:03,187 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.0657e-01
[rank3]:2025-10-26 06:36:45,245 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 5.9612e-01
[rank3]:2025-10-26 06:36:45,249 - INFO -  step: 460  loss:  0.9989  grad_norm:  0.4610  memory: 24.67GiB(51.93%)  tps: 1,973  tflops: 15.43  mfu: 4.94%
[rank1]:2025-10-26 06:36:45,230 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.8866e-01
[rank1]:2025-10-26 06:36:45,231 - INFO -  step: 460  loss: -4.0000  grad_norm:  0.4610  memory: 10.73GiB(22.58%)  tps: 1,973  tflops: 15.43  mfu: 4.94%
[rank2]:2025-10-26 06:36:45,226 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 4.1781e-01
[rank2]:2025-10-26 06:36:45,226 - INFO -  step: 460  loss: -4.0000  grad_norm:  0.4610  memory:  7.21GiB(15.18%)  tps: 1,973  tflops: 15.43  mfu: 4.94%
[rank0]:2025-10-26 06:36:45,256 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.8374e-01
[rank0]:2025-10-26 06:36:45,257 - INFO -  step: 460  loss: -4.0000  grad_norm:  0.4610  memory: 14.87GiB(31.30%)  tps: 1,973  tflops: 15.43  mfu: 4.94%
[rank3]:2025-10-26 06:36:47,140 - INFO - Avg. fwd time: 70.6508 / Avg. bwd time: 138.7904 / Avg. batch time: 1733.0192 (ms) / GPU bubble ratio: 3.32%
[rank2]:2025-10-26 06:36:47,198 - INFO - Avg. fwd time: 35.4533 / Avg. bwd time: 49.6024 / Avg. batch time: 1819.8202 (ms) / GPU bubble ratio: 62.61%
[rank1]:2025-10-26 06:36:47,270 - INFO - Avg. fwd time: 50.0155 / Avg. bwd time: 66.6744 / Avg. batch time: 1933.2139 (ms) / GPU bubble ratio: 51.71%
[rank0]:2025-10-26 06:36:47,322 - INFO - Avg. fwd time: 40.3099 / Avg. bwd time: 56.1248 / Avg. batch time: 2027.4868 (ms) / GPU bubble ratio: 61.95%
[rank3]:2025-10-26 06:37:26,072 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 6.5147e-01
[rank1]:2025-10-26 06:37:26,070 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 3.1637e-01
[rank0]:2025-10-26 06:37:26,078 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 4.8406e-01
[rank2]:2025-10-26 06:37:26,065 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 3.3258e-01
[rank2]:2025-10-26 06:38:08,116 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.7404e-01
[rank3]:2025-10-26 06:38:08,135 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 2.7851e-01
[rank1]:2025-10-26 06:38:08,120 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.3556e-01
[rank0]:2025-10-26 06:38:08,145 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.1965e-01
[rank0]:2025-10-26 06:38:48,957 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 3.9321e-01
[rank2]:2025-10-26 06:38:48,947 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.9303e-01
[rank3]:2025-10-26 06:38:48,955 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 4.8449e-01
[rank1]:2025-10-26 06:38:48,953 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 4.0974e-01
[rank2]:2025-10-26 06:39:31,000 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.7794e-01
[rank2]:2025-10-26 06:39:31,000 - INFO -  step: 480  loss: -4.0000  grad_norm:  0.4455  memory:  7.21GiB(15.18%)  tps: 1,977  tflops: 15.45  mfu: 4.95%
[rank3]:2025-10-26 06:39:31,019 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 3.7616e-01
[rank3]:2025-10-26 06:39:31,023 - INFO -  step: 480  loss:  0.9616  grad_norm:  0.4455  memory: 24.67GiB(51.93%)  tps: 1,977  tflops: 15.45  mfu: 4.95%
[rank1]:2025-10-26 06:39:31,004 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.0799e-01
[rank1]:2025-10-26 06:39:31,005 - INFO -  step: 480  loss: -4.0000  grad_norm:  0.4455  memory: 10.73GiB(22.58%)  tps: 1,977  tflops: 15.45  mfu: 4.95%
[rank0]:2025-10-26 06:39:31,029 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 9.6175e-02
[rank0]:2025-10-26 06:39:31,030 - INFO -  step: 480  loss: -4.0000  grad_norm:  0.4455  memory: 14.87GiB(31.30%)  tps: 1,977  tflops: 15.45  mfu: 4.95%
[rank3]:2025-10-26 06:39:32,897 - INFO - Avg. fwd time: 70.6385 / Avg. bwd time: 138.7369 / Avg. batch time: 1732.4557 (ms) / GPU bubble ratio: 3.32%
[rank2]:2025-10-26 06:39:32,958 - INFO - Avg. fwd time: 35.4415 / Avg. bwd time: 49.5288 / Avg. batch time: 1819.1691 (ms) / GPU bubble ratio: 62.63%
[rank1]:2025-10-26 06:39:33,042 - INFO - Avg. fwd time: 49.9989 / Avg. bwd time: 66.5864 / Avg. batch time: 1932.4884 (ms) / GPU bubble ratio: 51.74%
[rank0]:2025-10-26 06:39:33,094 - INFO - Avg. fwd time: 40.3057 / Avg. bwd time: 56.0582 / Avg. batch time: 2026.6832 (ms) / GPU bubble ratio: 61.96%
[rank3]:2025-10-26 06:40:12,232 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 3.5045e-01
[rank1]:2025-10-26 06:40:12,226 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 2.5658e-01
[rank0]:2025-10-26 06:40:12,232 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 3.2205e-01
[rank2]:2025-10-26 06:40:12,222 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 7.1435e-02
[rank3]:2025-10-26 06:40:54,294 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 1.4767e-01
[rank1]:2025-10-26 06:40:54,279 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.6927e-01
[rank0]:2025-10-26 06:40:54,302 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.0522e-01
[rank2]:2025-10-26 06:40:54,274 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.9574e-01
[rank3]:2025-10-26 06:41:24,131 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-26 06:41:25,038 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-26 06:41:25,111 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-26 06:41:25,157 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-26 06:41:37,388 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 9.7390e-02
[rank3]:2025-10-26 06:41:37,396 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 4.0323e-01
[rank1]:2025-10-26 06:41:37,398 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 2.5492e-01
[rank0]:2025-10-26 06:41:37,400 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 4.5636e-01
[rank0]:2025-10-26 06:42:11,141 - INFO - [GC] Peforming periodical GC collection 0.03 seconds
[rank3]:2025-10-26 06:42:19,600 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 4.1220e-01
[rank3]:2025-10-26 06:42:19,603 - INFO -  step: 500  loss:  0.8976  grad_norm:  0.4192  memory: 24.67GiB(51.93%)  tps: 1,944  tflops: 15.20  mfu: 4.87%
[rank3]:2025-10-26 06:42:19,603 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-26 06:42:19,584 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 3.6953e-01
[rank1]:2025-10-26 06:42:19,585 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.4192  memory: 10.73GiB(22.58%)  tps: 1,944  tflops: 15.20  mfu: 4.87%
[rank1]:2025-10-26 06:42:19,585 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-26 06:42:19,610 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.5362e-01
[rank0]:2025-10-26 06:42:19,610 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.4192  memory: 14.87GiB(31.30%)  tps: 1,944  tflops: 15.20  mfu: 4.87%
[rank0]:2025-10-26 06:42:19,610 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-26 06:42:19,611 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank2]:2025-10-26 06:42:19,580 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 3.2876e-01
[rank2]:2025-10-26 06:42:19,581 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.4192  memory:  7.21GiB(15.18%)  tps: 1,944  tflops: 15.20  mfu: 4.87%
[rank2]:2025-10-26 06:42:19,581 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-26 06:42:21,434 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 1.85 seconds.
[rank1]:2025-10-26 06:42:21,830 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 2.24 seconds.
[rank3]:2025-10-26 06:42:22,998 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.39 seconds.
[rank0]:2025-10-26 06:42:23,320 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-26 06:42:23,329 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.72 seconds.
[rank1]:2025-10-26 06:42:23,410 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_auto_dm1/freeze_ratio_history/rank1/251026_0642_stage1_step500.svg
[rank0]:2025-10-26 06:42:23,417 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_auto_dm1/freeze_ratio_history/rank0/251026_0642_stage0_step500.svg
[rank2]:2025-10-26 06:42:23,403 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_auto_dm1/freeze_ratio_history/rank2/251026_0642_stage2_step500.svg
[rank3]:2025-10-26 06:42:23,720 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_1F1B_auto_dm1/pipeline_schedule/251026_0642_real_step500_rank3.svg
[rank3]:> Batch Time: 1980.94 ms, GPU Bubble Ratio: 59.95%, 52.71%, 64.48%, 14.54%
[rank3]:2025-10-26 06:42:23,822 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_auto_dm1/freeze_ratio_history/rank3/251026_0642_stage3_step500.svg
[rank3]:2025-10-26 06:42:26,238 - INFO - Avg. fwd time: 70.6467 / Avg. bwd time: 138.7515 / Avg. batch time: 1732.6050 (ms) / GPU bubble ratio: 3.31%
[rank2]:2025-10-26 06:42:26,304 - INFO - Avg. fwd time: 35.4441 / Avg. bwd time: 49.4857 / Avg. batch time: 1819.2894 (ms) / GPU bubble ratio: 62.65%
[rank1]:2025-10-26 06:42:26,376 - INFO - Avg. fwd time: 50.0074 / Avg. bwd time: 66.5336 / Avg. batch time: 1932.5868 (ms) / GPU bubble ratio: 51.76%
[rank0]:2025-10-26 06:42:26,433 - INFO - Avg. fwd time: 40.3120 / Avg. bwd time: 56.0051 / Avg. batch time: 2026.7119 (ms) / GPU bubble ratio: 61.98%
[rank2]:2025-10-26 06:43:05,212 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 3.9246e-01
[rank3]:2025-10-26 06:43:05,220 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 6.9267e-01
[rank1]:2025-10-26 06:43:05,221 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 9.8690e-01
[rank0]:2025-10-26 06:43:05,220 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 1.1881e+00
[rank3]:2025-10-26 06:43:47,211 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 4.4474e-01
[rank1]:2025-10-26 06:43:47,196 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 6.6108e-01
[rank0]:2025-10-26 06:43:47,223 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 3.4364e-01
[rank2]:2025-10-26 06:43:47,192 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 6.3999e-01
[rank3]:2025-10-26 06:44:28,282 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 9.0410e-01
[rank0]:2025-10-26 06:44:28,286 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 7.1105e-01
[rank1]:2025-10-26 06:44:28,285 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 8.0163e-01
[rank2]:2025-10-26 06:44:28,275 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 3.8662e-01
[rank1]:2025-10-26 06:45:10,271 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 3.7468e-01
[rank1]:2025-10-26 06:45:10,271 - INFO -  step: 520  loss: -4.0000  grad_norm:  0.4474  memory: 10.73GiB(22.58%)  tps: 1,920  tflops: 15.01  mfu: 4.81%
[rank2]:2025-10-26 06:45:10,265 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 4.0609e-01
[rank2]:2025-10-26 06:45:10,266 - INFO -  step: 520  loss: -4.0000  grad_norm:  0.4474  memory:  7.21GiB(15.18%)  tps: 1,920  tflops: 15.01  mfu: 4.81%
[rank3]:2025-10-26 06:45:10,285 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 3.2043e-01
[rank3]:2025-10-26 06:45:10,288 - INFO -  step: 520  loss:  0.9225  grad_norm:  0.4474  memory: 24.67GiB(51.93%)  tps: 1,920  tflops: 15.01  mfu: 4.81%
[rank0]:2025-10-26 06:45:10,294 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 2.1978e-01
[rank0]:2025-10-26 06:45:10,295 - INFO -  step: 520  loss: -4.0000  grad_norm:  0.4474  memory: 14.87GiB(31.30%)  tps: 1,920  tflops: 15.01  mfu: 4.81%
[rank3]:2025-10-26 06:45:12,167 - INFO - Avg. fwd time: 70.6444 / Avg. bwd time: 138.7090 / Avg. batch time: 1732.2156 (ms) / GPU bubble ratio: 3.31%
[rank2]:2025-10-26 06:45:12,226 - INFO - Avg. fwd time: 35.4359 / Avg. bwd time: 49.4308 / Avg. batch time: 1818.8297 (ms) / GPU bubble ratio: 62.67%
[rank0]:2025-10-26 06:45:12,355 - INFO - Avg. fwd time: 40.3088 / Avg. bwd time: 55.9474 / Avg. batch time: 2026.1246 (ms) / GPU bubble ratio: 61.99%
[rank1]:2025-10-26 06:45:12,300 - INFO - Avg. fwd time: 50.0124 / Avg. bwd time: 66.4661 / Avg. batch time: 1932.0907 (ms) / GPU bubble ratio: 51.77%
[rank3]:2025-10-26 06:45:51,194 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 3.9774e-01
[rank1]:2025-10-26 06:45:51,191 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.3492e-01
[rank0]:2025-10-26 06:45:51,202 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 2.4488e-01
[rank2]:2025-10-26 06:45:51,186 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.3126e-01
[rank2]:2025-10-26 06:46:33,213 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 3.7131e-01
[rank3]:2025-10-26 06:46:33,232 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 1.9607e-01
[rank1]:2025-10-26 06:46:33,217 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 4.4276e-01
[rank0]:2025-10-26 06:46:33,241 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 2.2527e-01
[rank2]:2025-10-26 06:47:14,251 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.0212e-01
[rank0]:2025-10-26 06:47:14,258 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 8.7360e-01
[rank1]:2025-10-26 06:47:14,255 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 2.2319e-01
[rank3]:2025-10-26 06:47:14,340 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.7635e-01
[rank2]:2025-10-26 06:47:56,317 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.4693e-01
[rank2]:2025-10-26 06:47:56,318 - INFO -  step: 540  loss: -4.0000  grad_norm:  0.4561  memory:  7.21GiB(15.18%)  tps: 1,973  tflops: 15.43  mfu: 4.94%
[rank0]:2025-10-26 06:47:56,346 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.6128e-01
[rank0]:2025-10-26 06:47:56,346 - INFO -  step: 540  loss: -4.0000  grad_norm:  0.4561  memory: 14.87GiB(31.30%)  tps: 1,973  tflops: 15.43  mfu: 4.94%
[rank3]:2025-10-26 06:47:56,336 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 3.2031e-01
[rank3]:2025-10-26 06:47:56,339 - INFO -  step: 540  loss:  0.9166  grad_norm:  0.4561  memory: 24.67GiB(51.93%)  tps: 1,973  tflops: 15.43  mfu: 4.94%
[rank1]:2025-10-26 06:47:56,326 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 3.4139e-01
[rank1]:2025-10-26 06:47:56,326 - INFO -  step: 540  loss: -4.0000  grad_norm:  0.4561  memory: 10.73GiB(22.58%)  tps: 1,973  tflops: 15.43  mfu: 4.94%
[rank3]:2025-10-26 06:47:58,222 - INFO - Avg. fwd time: 70.6447 / Avg. bwd time: 138.6734 / Avg. batch time: 1731.9029 (ms) / GPU bubble ratio: 3.31%
[rank2]:2025-10-26 06:47:58,283 - INFO - Avg. fwd time: 35.4292 / Avg. bwd time: 49.3799 / Avg. batch time: 1818.4585 (ms) / GPU bubble ratio: 62.69%
[rank1]:2025-10-26 06:47:58,356 - INFO - Avg. fwd time: 50.0188 / Avg. bwd time: 66.4035 / Avg. batch time: 1931.6742 (ms) / GPU bubble ratio: 51.78%
[rank0]:2025-10-26 06:47:58,409 - INFO - Avg. fwd time: 40.3038 / Avg. bwd time: 55.8962 / Avg. batch time: 2025.6354 (ms) / GPU bubble ratio: 62.01%
[rank2]:2025-10-26 06:48:37,358 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.2396e-01
[rank0]:2025-10-26 06:48:37,370 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 3.1486e-01
[rank3]:2025-10-26 06:48:37,365 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.7324e-01
[rank1]:2025-10-26 06:48:37,362 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.2469e-01
[rank0]:2025-10-26 06:49:11,154 - INFO - [GC] Peforming periodical GC collection 0.04 seconds
[rank0]:2025-10-26 06:49:19,679 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.3192e-01
[rank3]:2025-10-26 06:49:19,668 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 2.9047e-01
[rank1]:2025-10-26 06:49:19,653 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 3.2760e-01
[rank2]:2025-10-26 06:49:19,649 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.6539e-01
[rank2]:2025-10-26 06:50:00,857 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.2009e-01
[rank0]:2025-10-26 06:50:00,872 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 3.9112e-01
[rank3]:2025-10-26 06:50:00,901 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 3.9845e-01
[rank1]:2025-10-26 06:50:00,861 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 2.2821e-01
[rank1]:2025-10-26 06:50:43,111 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 3.0616e-01
[rank1]:2025-10-26 06:50:43,111 - INFO -  step: 560  loss: -4.0000  grad_norm:  0.4832  memory: 10.73GiB(22.58%)  tps: 1,965  tflops: 15.36  mfu: 4.92%
[rank2]:2025-10-26 06:50:43,107 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.8111e-01
[rank2]:2025-10-26 06:50:43,107 - INFO -  step: 560  loss: -4.0000  grad_norm:  0.4832  memory:  7.21GiB(15.18%)  tps: 1,965  tflops: 15.36  mfu: 4.92%
[rank0]:2025-10-26 06:50:43,136 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.6866e-01
[rank0]:2025-10-26 06:50:43,136 - INFO -  step: 560  loss: -4.0000  grad_norm:  0.4832  memory: 14.87GiB(31.30%)  tps: 1,965  tflops: 15.36  mfu: 4.92%
[rank3]:2025-10-26 06:50:43,126 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 1.4232e-01
[rank3]:2025-10-26 06:50:43,129 - INFO -  step: 560  loss:  0.9243  grad_norm:  0.4832  memory: 24.67GiB(51.93%)  tps: 1,965  tflops: 15.36  mfu: 4.92%
[rank3]:2025-10-26 06:50:44,993 - INFO - Avg. fwd time: 70.6526 / Avg. bwd time: 138.6495 / Avg. batch time: 1731.7471 (ms) / GPU bubble ratio: 3.31%
[rank2]:2025-10-26 06:50:45,051 - INFO - Avg. fwd time: 35.4265 / Avg. bwd time: 49.3387 / Avg. batch time: 1818.2454 (ms) / GPU bubble ratio: 62.70%
[rank0]:2025-10-26 06:50:45,189 - INFO - Avg. fwd time: 40.3058 / Avg. bwd time: 55.8595 / Avg. batch time: 2025.4062 (ms) / GPU bubble ratio: 62.02%
[rank1]:2025-10-26 06:50:45,135 - INFO - Avg. fwd time: 50.0339 / Avg. bwd time: 66.3521 / Avg. batch time: 1931.4819 (ms) / GPU bubble ratio: 51.79%
[rank2]:2025-10-26 06:51:24,266 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 6.0690e-02
[rank0]:2025-10-26 06:51:24,279 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 7.2067e-01
[rank3]:2025-10-26 06:51:24,274 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.2515e-01
[rank1]:2025-10-26 06:51:24,271 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 1.4115e-01
[rank3]:2025-10-26 06:52:06,418 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 4.4123e-01
[rank1]:2025-10-26 06:52:06,403 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 3.6704e-01
[rank2]:2025-10-26 06:52:06,399 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 4.3357e-01
[rank0]:2025-10-26 06:52:06,428 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.9995e-01
[rank0]:2025-10-26 06:52:47,442 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 8.1979e-01
[rank1]:2025-10-26 06:52:47,438 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 2.3421e-01
[rank2]:2025-10-26 06:52:47,434 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 8.4375e-02
[rank3]:2025-10-26 06:52:47,491 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.9753e-01
[rank3]:2025-10-26 06:52:54,982 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-26 06:52:55,733 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-26 06:52:55,790 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-26 06:52:55,875 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-26 06:53:31,579 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.1241e-01
[rank2]:2025-10-26 06:53:31,579 - INFO -  step: 580  loss: -4.0000  grad_norm:  0.4664  memory:  7.21GiB(15.18%)  tps: 1,945  tflops: 15.21  mfu: 4.87%
[rank0]:2025-10-26 06:53:31,608 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.5008e-01
[rank0]:2025-10-26 06:53:31,609 - INFO -  step: 580  loss: -4.0000  grad_norm:  0.4664  memory: 14.87GiB(31.30%)  tps: 1,945  tflops: 15.21  mfu: 4.87%
[rank1]:2025-10-26 06:53:31,584 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.1509e-01
[rank1]:2025-10-26 06:53:31,584 - INFO -  step: 580  loss: -4.0000  grad_norm:  0.4664  memory: 10.73GiB(22.58%)  tps: 1,945  tflops: 15.21  mfu: 4.87%
[rank3]:2025-10-26 06:53:31,598 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 1.1302e-01
[rank3]:2025-10-26 06:53:31,602 - INFO -  step: 580  loss:  0.8592  grad_norm:  0.4664  memory: 24.67GiB(51.93%)  tps: 1,945  tflops: 15.21  mfu: 4.87%
[rank3]:2025-10-26 06:53:33,472 - INFO - Avg. fwd time: 70.6544 / Avg. bwd time: 138.6210 / Avg. batch time: 1731.5073 (ms) / GPU bubble ratio: 3.31%
[rank2]:2025-10-26 06:53:33,532 - INFO - Avg. fwd time: 35.4215 / Avg. bwd time: 49.2947 / Avg. batch time: 1817.9482 (ms) / GPU bubble ratio: 62.72%
[rank1]:2025-10-26 06:53:33,606 - INFO - Avg. fwd time: 50.0312 / Avg. bwd time: 66.3219 / Avg. batch time: 1931.1707 (ms) / GPU bubble ratio: 51.80%
[rank0]:2025-10-26 06:53:33,658 - INFO - Avg. fwd time: 40.3095 / Avg. bwd time: 55.8107 / Avg. batch time: 2025.0178 (ms) / GPU bubble ratio: 62.03%
[rank2]:2025-10-26 06:54:12,713 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.8960e-01
[rank0]:2025-10-26 06:54:12,721 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 1.1328e+00
[rank1]:2025-10-26 06:54:12,718 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 2.6866e-01
[rank3]:2025-10-26 06:54:12,721 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 3.6872e-01
[rank3]:2025-10-26 06:54:54,736 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 2.6912e-01
[rank1]:2025-10-26 06:54:54,721 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 3.5011e-01
[rank2]:2025-10-26 06:54:54,717 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 4.4583e-01
[rank0]:2025-10-26 06:54:54,747 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.2872e-01
[rank0]:2025-10-26 06:55:35,678 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 3.5311e-01
[rank3]:2025-10-26 06:55:35,687 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 3.1955e-01
[rank1]:2025-10-26 06:55:35,672 - INFO - Freezing Ratio: [Stage1] 0.40, Threshold: 2.7088e-01
[rank2]:2025-10-26 06:55:35,667 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.9009e-01
[rank0]:2025-10-26 06:56:09,436 - INFO - [GC] Peforming periodical GC collection 0.04 seconds
[rank1]:2025-10-26 06:56:17,860 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 3.5875e-01
[rank1]:2025-10-26 06:56:17,860 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.4654  memory: 10.73GiB(22.58%)  tps: 1,971  tflops: 15.41  mfu: 4.94%
[rank2]:2025-10-26 06:56:17,854 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.0884e-01
[rank2]:2025-10-26 06:56:17,855 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.4654  memory:  7.21GiB(15.18%)  tps: 1,971  tflops: 15.41  mfu: 4.94%
[rank0]:2025-10-26 06:56:17,884 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.5609e-01
[rank0]:2025-10-26 06:56:17,884 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.4654  memory: 14.87GiB(31.30%)  tps: 1,971  tflops: 15.41  mfu: 4.94%
[rank0]:2025-10-26 06:56:17,924 - INFO - Destroying the purge thread.
[rank0]:[rank0]: Traceback (most recent call last):
[rank0]:[rank0]:   File "<frozen runpy>", line 198, in _run_module_as_main
[rank0]:[rank0]:   File "<frozen runpy>", line 88, in _run_code
[rank0]:[rank0]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 724, in <module>
[rank0]:[rank0]:     trainer.train()
[rank0]:[rank0]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
[rank0]:[rank0]:     return f(*args, **kwargs)
[rank0]:[rank0]:            ^^^^^^^^^^^^^^^^^^
[rank0]:[rank0]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 619, in train
[rank0]:[rank0]:     draw_charts(self.freezer, self.step, job_config)
[rank0]:[rank0]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 685, in draw_charts
[rank0]:[rank0]:     draw_line_chart([freezer.stability_check_freq * k for k in range(len(freezer.freeze_ratio_history[s]))], 
[rank0]:[rank0]:     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:[rank0]:   File "/home/shcho/torchtitan/timelyfreeze/core/util.py", line 47, in draw_line_chart
[rank0]:[rank0]:     plt.savefig(save_file)
[rank0]:[rank0]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/pyplot.py", line 1250, in savefig
[rank0]:[rank0]:     res = fig.savefig(*args, **kwargs)  # type: ignore[func-returns-value]
[rank0]:[rank0]:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:[rank0]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/figure.py", line 3490, in savefig
[rank0]:[rank0]:     self.canvas.print_figure(fname, **kwargs)
[rank0]:[rank0]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backend_bases.py", line 2186, in print_figure
[rank0]:[rank0]:     result = print_method(
[rank0]:[rank0]:              ^^^^^^^^^^^^^
[rank0]:[rank0]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backend_bases.py", line 2042, in <lambda>
[rank0]:[rank0]:     print_method = functools.wraps(meth)(lambda *args, **kwargs: meth(
[rank0]:[rank0]:                                                                  ^^^^^
[rank0]:[rank0]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backends/backend_svg.py", line 1351, in print_svg
[rank0]:[rank0]:     self.figure.draw(renderer)
[rank0]:[rank0]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/artist.py", line 94, in draw_wrapper
[rank0]:[rank0]:     result = draw(artist, renderer, *args, **kwargs)
[rank0]:[rank0]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:[rank0]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/artist.py", line 71, in draw_wrapper
[rank0]:[rank0]:     return draw(artist, renderer)
[rank0]:[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^
[rank0]:[rank0]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/figure.py", line 3257, in draw
[rank0]:[rank0]:     mimage._draw_list_compositing_images(
[rank0]:[rank0]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/image.py", line 134, in _draw_list_compositing_images
[rank0]:[rank0]:     a.draw(renderer)
[rank0]:[rank0]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/artist.py", line 71, in draw_wrapper
[rank0]:[rank0]:     return draw(artist, renderer)
[rank0]:[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^
[rank0]:[rank0]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/axes/_base.py", line 3226, in draw
[rank0]:[rank0]:     mimage._draw_list_compositing_images(
[rank0]:[rank0]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/image.py", line 134, in _draw_list_compositing_images
[rank0]:[rank0]:     a.draw(renderer)
[rank0]:[rank0]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/artist.py", line 71, in draw_wrapper
[rank0]:[rank0]:     return draw(artist, renderer)
[rank0]:[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^
[rank0]:[rank0]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/axis.py", line 1408, in draw
[rank0]:[rank0]:     tick.draw(renderer)
[rank0]:[rank0]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/artist.py", line 71, in draw_wrapper
[rank0]:[rank0]:     return draw(artist, renderer)
[rank0]:[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^
[rank0]:[rank0]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/axis.py", line 276, in draw
[rank0]:[rank0]:     artist.draw(renderer)
[rank0]:[rank0]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/artist.py", line 71, in draw_wrapper
[rank0]:[rank0]:     return draw(artist, renderer)
[rank0]:[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^
[rank0]:[rank0]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/text.py", line 808, in draw
[rank0]:[rank0]:     textrenderer.draw_text(gc, x, y, clean_line,
[rank0]:[rank0]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backends/backend_svg.py", line 1279, in draw_text
[rank0]:[rank0]:     self._draw_text_as_path(gc, x, y, s, prop, angle, ismath, mtext)
[rank0]:[rank0]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backends/backend_svg.py", line 1074, in _draw_text_as_path
[rank0]:[rank0]:     writer.element(
[rank0]:[rank0]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backends/backend_svg.py", line 241, in element
[rank0]:[rank0]:     self.start(tag, attrib, **extra)
[rank0]:[rank0]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backends/backend_svg.py", line 165, in start
[rank0]:[rank0]:     self.__write(f' {k}={v}')
[rank0]:[rank0]: OSError: [Errno 28] No space left on device
[rank1]:2025-10-26 06:56:17,927 - INFO - Destroying the purge thread.
[rank1]:[rank1]: Traceback (most recent call last):
[rank1]:[rank1]:   File "<frozen runpy>", line 198, in _run_module_as_main
[rank1]:[rank1]:   File "<frozen runpy>", line 88, in _run_code
[rank1]:[rank1]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 724, in <module>
[rank1]:[rank1]:     trainer.train()
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
[rank1]:[rank1]:     return f(*args, **kwargs)
[rank1]:[rank1]:            ^^^^^^^^^^^^^^^^^^
[rank1]:[rank1]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 619, in train
[rank1]:[rank1]:     draw_charts(self.freezer, self.step, job_config)
[rank1]:[rank1]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 685, in draw_charts
[rank1]:[rank1]:     draw_line_chart([freezer.stability_check_freq * k for k in range(len(freezer.freeze_ratio_history[s]))], 
[rank1]:[rank1]:     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:[rank1]:   File "/home/shcho/torchtitan/timelyfreeze/core/util.py", line 47, in draw_line_chart
[rank1]:[rank1]:     plt.savefig(save_file)
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/pyplot.py", line 1250, in savefig
[rank1]:[rank1]:     res = fig.savefig(*args, **kwargs)  # type: ignore[func-returns-value]
[rank1]:[rank1]:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/figure.py", line 3490, in savefig
[rank1]:[rank1]:     self.canvas.print_figure(fname, **kwargs)
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backend_bases.py", line 2186, in print_figure
[rank1]:[rank1]:     result = print_method(
[rank1]:[rank1]:              ^^^^^^^^^^^^^
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backend_bases.py", line 2042, in <lambda>
[rank1]:[rank1]:     print_method = functools.wraps(meth)(lambda *args, **kwargs: meth(
[rank1]:[rank1]:                                                                  ^^^^^
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backends/backend_svg.py", line 1351, in print_svg
[rank1]:[rank1]:     self.figure.draw(renderer)
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/artist.py", line 94, in draw_wrapper
[rank1]:[rank1]:     result = draw(artist, renderer, *args, **kwargs)
[rank1]:[rank1]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/artist.py", line 71, in draw_wrapper
[rank1]:[rank1]:     return draw(artist, renderer)
[rank1]:[rank1]:            ^^^^^^^^^^^^^^^^^^^^^^
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/figure.py", line 3257, in draw
[rank1]:[rank1]:     mimage._draw_list_compositing_images(
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/image.py", line 134, in _draw_list_compositing_images
[rank1]:[rank1]:     a.draw(renderer)
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/artist.py", line 71, in draw_wrapper
[rank1]:[rank1]:     return draw(artist, renderer)
[rank1]:[rank1]:            ^^^^^^^^^^^^^^^^^^^^^^
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/axes/_base.py", line 3226, in draw
[rank1]:[rank1]:     mimage._draw_list_compositing_images(
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/image.py", line 134, in _draw_list_compositing_images
[rank1]:[rank1]:     a.draw(renderer)
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/artist.py", line 71, in draw_wrapper
[rank1]:[rank1]:     return draw(artist, renderer)
[rank1]:[rank1]:            ^^^^^^^^^^^^^^^^^^^^^^
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/axis.py", line 1408, in draw
[rank1]:[rank1]:     tick.draw(renderer)
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/artist.py", line 71, in draw_wrapper
[rank1]:[rank1]:     return draw(artist, renderer)
[rank1]:[rank1]:            ^^^^^^^^^^^^^^^^^^^^^^
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/axis.py", line 276, in draw
[rank1]:[rank1]:     artist.draw(renderer)
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/artist.py", line 71, in draw_wrapper
[rank1]:[rank1]:     return draw(artist, renderer)
[rank1]:[rank1]:            ^^^^^^^^^^^^^^^^^^^^^^
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/text.py", line 808, in draw
[rank1]:[rank1]:     textrenderer.draw_text(gc, x, y, clean_line,
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backends/backend_svg.py", line 1279, in draw_text
[rank1]:[rank1]:     self._draw_text_as_path(gc, x, y, s, prop, angle, ismath, mtext)
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backends/backend_svg.py", line 1074, in _draw_text_as_path
[rank1]:[rank1]:     writer.element(
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backends/backend_svg.py", line 241, in element
[rank1]:[rank1]:     self.start(tag, attrib, **extra)
[rank1]:[rank1]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backends/backend_svg.py", line 165, in start
[rank1]:[rank1]:     self.__write(f' {k}={v}')
[rank1]:[rank1]: OSError: [Errno 28] No space left on device
[rank3]:2025-10-26 06:56:17,874 - INFO - Freezing Ratio: [Stage3] 0.31, Threshold: 2.2497e-01
[rank3]:2025-10-26 06:56:17,877 - INFO -  step: 600  loss:  0.8818  grad_norm:  0.4654  memory: 24.67GiB(51.93%)  tps: 1,971  tflops: 15.41  mfu: 4.94%
[rank2]:2025-10-26 06:56:17,925 - INFO - Destroying the purge thread.
[rank2]:[rank2]: Traceback (most recent call last):
[rank2]:[rank2]:   File "<frozen runpy>", line 198, in _run_module_as_main
[rank2]:[rank2]:   File "<frozen runpy>", line 88, in _run_code
[rank2]:[rank2]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 724, in <module>
[rank2]:[rank2]:     trainer.train()
[rank2]:[rank2]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
[rank2]:[rank2]:     return f(*args, **kwargs)
[rank2]:[rank2]:            ^^^^^^^^^^^^^^^^^^
[rank2]:[rank2]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 619, in train
[rank2]:[rank2]:     draw_charts(self.freezer, self.step, job_config)
[rank2]:[rank2]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 685, in draw_charts
[rank2]:[rank2]:     draw_line_chart([freezer.stability_check_freq * k for k in range(len(freezer.freeze_ratio_history[s]))], 
[rank2]:[rank2]:     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:[rank2]:   File "/home/shcho/torchtitan/timelyfreeze/core/util.py", line 47, in draw_line_chart
[rank2]:[rank2]:     plt.savefig(save_file)
[rank2]:[rank2]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/pyplot.py", line 1250, in savefig
[rank2]:[rank2]:     res = fig.savefig(*args, **kwargs)  # type: ignore[func-returns-value]
[rank2]:[rank2]:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:[rank2]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/figure.py", line 3490, in savefig
[rank2]:[rank2]:     self.canvas.print_figure(fname, **kwargs)
[rank2]:[rank2]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backend_bases.py", line 2186, in print_figure
[rank2]:[rank2]:     result = print_method(
[rank2]:[rank2]:              ^^^^^^^^^^^^^
[rank2]:[rank2]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backend_bases.py", line 2042, in <lambda>
[rank2]:[rank2]:     print_method = functools.wraps(meth)(lambda *args, **kwargs: meth(
[rank2]:[rank2]:                                                                  ^^^^^
[rank2]:[rank2]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backends/backend_svg.py", line 1351, in print_svg
[rank2]:[rank2]:     self.figure.draw(renderer)
[rank2]:[rank2]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/artist.py", line 94, in draw_wrapper
[rank2]:[rank2]:     result = draw(artist, renderer, *args, **kwargs)
[rank2]:[rank2]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:[rank2]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/artist.py", line 71, in draw_wrapper
[rank2]:[rank2]:     return draw(artist, renderer)
[rank2]:[rank2]:            ^^^^^^^^^^^^^^^^^^^^^^
[rank2]:[rank2]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/figure.py", line 3257, in draw
[rank2]:[rank2]:     mimage._draw_list_compositing_images(
[rank2]:[rank2]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/image.py", line 134, in _draw_list_compositing_images
[rank2]:[rank2]:     a.draw(renderer)
[rank2]:[rank2]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/artist.py", line 71, in draw_wrapper
[rank2]:[rank2]:     return draw(artist, renderer)
[rank2]:[rank2]:            ^^^^^^^^^^^^^^^^^^^^^^
[rank2]:[rank2]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/axes/_base.py", line 3226, in draw
[rank2]:[rank2]:     mimage._draw_list_compositing_images(
[rank2]:[rank2]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/image.py", line 134, in _draw_list_compositing_images
[rank2]:[rank2]:     a.draw(renderer)
[rank2]:[rank2]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/artist.py", line 71, in draw_wrapper
[rank2]:[rank2]:     return draw(artist, renderer)
[rank2]:[rank2]:            ^^^^^^^^^^^^^^^^^^^^^^
[rank2]:[rank2]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/axis.py", line 1408, in draw
[rank2]:[rank2]:     tick.draw(renderer)
[rank2]:[rank2]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/artist.py", line 71, in draw_wrapper
[rank2]:[rank2]:     return draw(artist, renderer)
[rank2]:[rank2]:            ^^^^^^^^^^^^^^^^^^^^^^
[rank2]:[rank2]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/axis.py", line 276, in draw
[rank2]:[rank2]:     artist.draw(renderer)
[rank2]:[rank2]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/artist.py", line 71, in draw_wrapper
[rank2]:[rank2]:     return draw(artist, renderer)
[rank2]:[rank2]:            ^^^^^^^^^^^^^^^^^^^^^^
[rank2]:[rank2]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/text.py", line 808, in draw
[rank2]:[rank2]:     textrenderer.draw_text(gc, x, y, clean_line,
[rank2]:[rank2]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backends/backend_svg.py", line 1279, in draw_text
[rank2]:[rank2]:     self._draw_text_as_path(gc, x, y, s, prop, angle, ismath, mtext)
[rank2]:[rank2]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backends/backend_svg.py", line 1074, in _draw_text_as_path
[rank2]:[rank2]:     writer.element(
[rank2]:[rank2]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backends/backend_svg.py", line 241, in element
[rank2]:[rank2]:     self.start(tag, attrib, **extra)
[rank2]:[rank2]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backends/backend_svg.py", line 165, in start
[rank2]:[rank2]:     self.__write(f' {k}={v}')
[rank2]:[rank2]: OSError: [Errno 28] No space left on device
[rank3]:2025-10-26 06:56:18,026 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank0]:[rank0]:[W1026 06:56:18.148258810 ProcessGroupNCCL.cpp:1552] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:                    grad_norm â–ˆâ–ƒâ–…â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–…â–„â–„â–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–â–‚â–‚â–‚â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–…â–„â–„â–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–â–‚â–‚â–‚â–â–â–â–â–â–
[rank3]:wandb:                           lr â–â–‚â–„â–…â–‡â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
[rank3]:wandb:         memory/max_active(%) â–â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
[rank3]:wandb:       memory/max_active(GiB) â–â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
[rank3]:wandb:       memory/max_reserved(%) â–â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
[rank3]:wandb:     memory/max_reserved(GiB) â–â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
[rank3]:wandb:     memory/num_alloc_retries â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:              memory/num_ooms â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                           +7 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:                    grad_norm 0.46542
[rank3]:wandb: loss_metrics/global_avg_loss 0.88184
[rank3]:wandb: loss_metrics/global_max_loss 0.88184
[rank3]:wandb:                           lr 1e-05
[rank3]:wandb:         memory/max_active(%) 47.44523
[rank3]:wandb:       memory/max_active(GiB) 22.53978
[rank3]:wandb:       memory/max_reserved(%) 51.93318
[rank3]:wandb:     memory/max_reserved(GiB) 24.67188
[rank3]:wandb:     memory/num_alloc_retries 0
[rank3]:wandb:              memory/num_ooms 0
[rank3]:wandb:                           +7 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1023_1F1B_auto_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/45wu94ql
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 3 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1023_1F1B_auto_dm1/20251026-0532/wandb/run-20251026_053220-45wu94ql/logs
[rank3]:Traceback (most recent call last):
[rank3]:  File "<frozen runpy>", line 198, in _run_module_as_main
[rank3]:  File "<frozen runpy>", line 88, in _run_code
[rank3]:  File "/home/shcho/torchtitan/timelyfreeze/train.py", line 724, in <module>
[rank3]:    trainer.train()
[rank3]:  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
[rank3]:    return f(*args, **kwargs)
[rank3]:           ^^^^^^^^^^^^^^^^^^
[rank3]:  File "/home/shcho/torchtitan/timelyfreeze/train.py", line 619, in train
[rank3]:    draw_charts(self.freezer, self.step, job_config)
[rank3]:  File "/home/shcho/torchtitan/timelyfreeze/train.py", line 658, in draw_charts
[rank3]:    draw_pipeline_schedule(save_file=f'pipeline_schedule/{timestamp}_real_{filename_suffix}_rank{config.comm.global_rank}.svg',
[rank3]:  File "/home/shcho/torchtitan/timelyfreeze/core/util.py", line 208, in draw_pipeline_schedule
[rank3]:    plt.savefig(save_file, bbox_inches='tight', pad_inches=0)
[rank3]:  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/pyplot.py", line 1250, in savefig
[rank3]:    res = fig.savefig(*args, **kwargs)  # type: ignore[func-returns-value]
[rank3]:          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/figure.py", line 3490, in savefig
[rank3]:    self.canvas.print_figure(fname, **kwargs)
[rank3]:  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backend_bases.py", line 2186, in print_figure
[rank3]:    result = print_method(
[rank3]:             ^^^^^^^^^^^^^
[rank3]:  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backend_bases.py", line 2042, in <lambda>
[rank3]:    print_method = functools.wraps(meth)(lambda *args, **kwargs: meth(
[rank3]:                                                                 ^^^^^
[rank3]:  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backends/backend_svg.py", line 1351, in print_svg
[rank3]:    self.figure.draw(renderer)
[rank3]:  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/artist.py", line 94, in draw_wrapper
[rank3]:    result = draw(artist, renderer, *args, **kwargs)
[rank3]:             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/artist.py", line 71, in draw_wrapper
[rank3]:    return draw(artist, renderer)
[rank3]:           ^^^^^^^^^^^^^^^^^^^^^^
[rank3]:  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/figure.py", line 3257, in draw
[rank3]:    mimage._draw_list_compositing_images(
[rank3]:  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/image.py", line 134, in _draw_list_compositing_images
[rank3]:    a.draw(renderer)
[rank3]:  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/artist.py", line 71, in draw_wrapper
[rank3]:    return draw(artist, renderer)
[rank3]:           ^^^^^^^^^^^^^^^^^^^^^^
[rank3]:  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/axes/_base.py", line 3226, in draw
[rank3]:    mimage._draw_list_compositing_images(
[rank3]:  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/image.py", line 134, in _draw_list_compositing_images
[rank3]:    a.draw(renderer)
[rank3]:  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/artist.py", line 71, in draw_wrapper
[rank3]:    return draw(artist, renderer)
[rank3]:           ^^^^^^^^^^^^^^^^^^^^^^
[rank3]:  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/patches.py", line 642, in draw
[rank3]:    self._draw_paths_with_artist_properties(
[rank3]:  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/patches.py", line 627, in _draw_paths_with_artist_properties
[rank3]:    renderer.draw_path(gc, *draw_path_args)
[rank3]:  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backends/backend_svg.py", line 688, in draw_path
[rank3]:    self.writer.element('path', d=path_data, **self._get_clip_attrs(gc),
[rank3]:  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backends/backend_svg.py", line 241, in element
[rank3]:    self.start(tag, attrib, **extra)
[rank3]:  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backends/backend_svg.py", line 165, in start
[rank3]:    self.__write(f' {k}={v}')
[rank3]:OSError: [Errno 28] No space left on device
[rank3]:[rank3]: Traceback (most recent call last):
[rank3]:[rank3]:   File "<frozen runpy>", line 198, in _run_module_as_main
[rank3]:[rank3]:   File "<frozen runpy>", line 88, in _run_code
[rank3]:[rank3]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 724, in <module>
[rank3]:[rank3]:     trainer.train()
[rank3]:[rank3]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
[rank3]:[rank3]:     return f(*args, **kwargs)
[rank3]:[rank3]:            ^^^^^^^^^^^^^^^^^^
[rank3]:[rank3]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 619, in train
[rank3]:[rank3]:     draw_charts(self.freezer, self.step, job_config)
[rank3]:[rank3]:   File "/home/shcho/torchtitan/timelyfreeze/train.py", line 658, in draw_charts
[rank3]:[rank3]:     draw_pipeline_schedule(save_file=f'pipeline_schedule/{timestamp}_real_{filename_suffix}_rank{config.comm.global_rank}.svg',
[rank3]:[rank3]:   File "/home/shcho/torchtitan/timelyfreeze/core/util.py", line 208, in draw_pipeline_schedule
[rank3]:[rank3]:     plt.savefig(save_file, bbox_inches='tight', pad_inches=0)
[rank3]:[rank3]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/pyplot.py", line 1250, in savefig
[rank3]:[rank3]:     res = fig.savefig(*args, **kwargs)  # type: ignore[func-returns-value]
[rank3]:[rank3]:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:[rank3]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/figure.py", line 3490, in savefig
[rank3]:[rank3]:     self.canvas.print_figure(fname, **kwargs)
[rank3]:[rank3]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backend_bases.py", line 2186, in print_figure
[rank3]:[rank3]:     result = print_method(
[rank3]:[rank3]:              ^^^^^^^^^^^^^
[rank3]:[rank3]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backend_bases.py", line 2042, in <lambda>
[rank3]:[rank3]:     print_method = functools.wraps(meth)(lambda *args, **kwargs: meth(
[rank3]:[rank3]:                                                                  ^^^^^
[rank3]:[rank3]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backends/backend_svg.py", line 1351, in print_svg
[rank3]:[rank3]:     self.figure.draw(renderer)
[rank3]:[rank3]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/artist.py", line 94, in draw_wrapper
[rank3]:[rank3]:     result = draw(artist, renderer, *args, **kwargs)
[rank3]:[rank3]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:[rank3]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/artist.py", line 71, in draw_wrapper
[rank3]:[rank3]:     return draw(artist, renderer)
[rank3]:[rank3]:            ^^^^^^^^^^^^^^^^^^^^^^
[rank3]:[rank3]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/figure.py", line 3257, in draw
[rank3]:[rank3]:     mimage._draw_list_compositing_images(
[rank3]:[rank3]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/image.py", line 134, in _draw_list_compositing_images
[rank3]:[rank3]:     a.draw(renderer)
[rank3]:[rank3]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/artist.py", line 71, in draw_wrapper
[rank3]:[rank3]:     return draw(artist, renderer)
[rank3]:[rank3]:            ^^^^^^^^^^^^^^^^^^^^^^
[rank3]:[rank3]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/axes/_base.py", line 3226, in draw
[rank3]:[rank3]:     mimage._draw_list_compositing_images(
[rank3]:[rank3]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/image.py", line 134, in _draw_list_compositing_images
[rank3]:[rank3]:     a.draw(renderer)
[rank3]:[rank3]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/artist.py", line 71, in draw_wrapper
[rank3]:[rank3]:     return draw(artist, renderer)
[rank3]:[rank3]:            ^^^^^^^^^^^^^^^^^^^^^^
[rank3]:[rank3]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/patches.py", line 642, in draw
[rank3]:[rank3]:     self._draw_paths_with_artist_properties(
[rank3]:[rank3]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/patches.py", line 627, in _draw_paths_with_artist_properties
[rank3]:[rank3]:     renderer.draw_path(gc, *draw_path_args)
[rank3]:[rank3]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backends/backend_svg.py", line 688, in draw_path
[rank3]:[rank3]:     self.writer.element('path', d=path_data, **self._get_clip_attrs(gc),
[rank3]:[rank3]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backends/backend_svg.py", line 241, in element
[rank3]:[rank3]:     self.start(tag, attrib, **extra)
[rank3]:[rank3]:   File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backends/backend_svg.py", line 165, in start
[rank3]:[rank3]:     self.__write(f' {k}={v}')
[rank3]:[rank3]: OSError: [Errno 28] No space left on device
W1026 06:56:20.513000 3926999 site-packages/torch/distributed/elastic/multiprocessing/api.py:940] Sending process 3927007 closing signal SIGTERM
W1026 06:56:20.513000 3926999 site-packages/torch/distributed/elastic/multiprocessing/api.py:940] Sending process 3927008 closing signal SIGTERM
W1026 06:56:20.513000 3926999 site-packages/torch/distributed/elastic/multiprocessing/api.py:940] Sending process 3927010 closing signal SIGTERM
E1026 06:56:21.917000 3926999 site-packages/torch/distributed/elastic/multiprocessing/api.py:914] failed (exitcode: 1) local_rank: 2 (pid: 3927009) of binary: /data2/shcho/miniforge3/envs/llm_eval/bin/python3.11
E1026 06:56:21.935000 3926999 site-packages/torch/distributed/elastic/multiprocessing/errors/error_handler.py:141] no error file defined for parent, to copy child error file (/tmp/torchelastic_sh2fgtqq/46746915-9fdd-4b28-afde-1b948e108b36_7z24yfy2/attempt_0/2/error.json)
[rank1]:Stage 1: Modules to keep: {'layers.6', 'layers.7', 'layers.4', 'layers.8', 'layers.5'}
[rank0]:Stage 0: Modules to keep: {'layers.2', 'layers.3', 'tok_embeddings', 'layers.1', 'layers.0'}
[rank2]:Stage 2: Modules to keep: {'layers.10', 'layers.9', 'layers.11', 'layers.12'}
[rank3]:Stage 3: Modules to keep: {'layers.15', 'norm', 'layers.14', 'layers.13', 'output'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1022_llama1binstruct/config.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1023_1F1B_auto_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1023_1F1B_auto_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1023_1F1B_auto_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 20
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1023_1F1B_auto_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1023_1F1B_auto_dm1
[rank3]:		- pplog_freq: 80
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1023_1F1B_auto_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B-Instruct
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 1e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: alpaca
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 2000
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: 1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1023_1F1B_auto_dm1
[rank3]:		- interval: 500
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B-Instruct/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1023_1F1B_auto_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 8
[rank3]:		- seq_len: 2048
[rank3]:		- freq: 10
[rank3]:		- steps: -1
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: auto
[rank3]:		- phase_unit: 10
[rank3]:		- stability_check_freq: 5
[rank3]:		- aggressiveness: 0
[rank3]:
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
Traceback (most recent call last):
  File "/data2/shcho/miniforge3/envs/llm_eval/bin/torchrun", line 7, in <module>
    sys.exit(main())
             ^^^^^^
  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/run.py", line 946, in main
    run(args)
  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/run.py", line 937, in run
    elastic_launch(
  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 159, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 300, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
timelyfreeze.train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2025-10-26_06:56:17
  host      : elga.kaist.ac.kr
  rank      : 0 (local_rank: 0)
  exitcode  : 1 (pid: 3927007)
  error_file: /tmp/torchelastic_sh2fgtqq/46746915-9fdd-4b28-afde-1b948e108b36_7z24yfy2/attempt_0/0/error.json
  traceback : Traceback (most recent call last):
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
      return f(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^
    File "/home/shcho/torchtitan/timelyfreeze/train.py", line 619, in train
      draw_charts(self.freezer, self.step, job_config)
    File "/home/shcho/torchtitan/timelyfreeze/train.py", line 685, in draw_charts
      draw_line_chart([freezer.stability_check_freq * k for k in range(len(freezer.freeze_ratio_history[s]))],
    File "/home/shcho/torchtitan/timelyfreeze/core/util.py", line 47, in draw_line_chart
      plt.savefig(save_file)
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/pyplot.py", line 1250, in savefig
      res = fig.savefig(*args, **kwargs)  # type: ignore[func-returns-value]
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/figure.py", line 3490, in savefig
      self.canvas.print_figure(fname, **kwargs)
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backend_bases.py", line 2186, in print_figure
      result = print_method(
               ^^^^^^^^^^^^^
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backend_bases.py", line 2042, in <lambda>
      print_method = functools.wraps(meth)(lambda *args, **kwargs: meth(
                                                                   ^^^^^
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backends/backend_svg.py", line 1351, in print_svg
      self.figure.draw(renderer)
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/artist.py", line 94, in draw_wrapper
      result = draw(artist, renderer, *args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/artist.py", line 71, in draw_wrapper
      return draw(artist, renderer)
             ^^^^^^^^^^^^^^^^^^^^^^
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/figure.py", line 3257, in draw
      mimage._draw_list_compositing_images(
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/image.py", line 134, in _draw_list_compositing_images
      a.draw(renderer)
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/artist.py", line 71, in draw_wrapper
      return draw(artist, renderer)
             ^^^^^^^^^^^^^^^^^^^^^^
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/axes/_base.py", line 3226, in draw
      mimage._draw_list_compositing_images(
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/image.py", line 134, in _draw_list_compositing_images
      a.draw(renderer)
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/artist.py", line 71, in draw_wrapper
      return draw(artist, renderer)
             ^^^^^^^^^^^^^^^^^^^^^^
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/axis.py", line 1408, in draw
      tick.draw(renderer)
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/artist.py", line 71, in draw_wrapper
      return draw(artist, renderer)
             ^^^^^^^^^^^^^^^^^^^^^^
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/axis.py", line 276, in draw
      artist.draw(renderer)
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/artist.py", line 71, in draw_wrapper
      return draw(artist, renderer)
             ^^^^^^^^^^^^^^^^^^^^^^
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/text.py", line 808, in draw
      textrenderer.draw_text(gc, x, y, clean_line,
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backends/backend_svg.py", line 1279, in draw_text
      self._draw_text_as_path(gc, x, y, s, prop, angle, ismath, mtext)
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backends/backend_svg.py", line 1074, in _draw_text_as_path
      writer.element(
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backends/backend_svg.py", line 241, in element
      self.start(tag, attrib, **extra)
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backends/backend_svg.py", line 165, in start
      self.__write(f' {k}={v}')
  OSError: [Errno 28] No space left on device
  
[2]:
  time      : 2025-10-26_06:56:17
  host      : elga.kaist.ac.kr
  rank      : 1 (local_rank: 1)
  exitcode  : 1 (pid: 3927008)
  error_file: /tmp/torchelastic_sh2fgtqq/46746915-9fdd-4b28-afde-1b948e108b36_7z24yfy2/attempt_0/1/error.json
  traceback : Traceback (most recent call last):
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
      return f(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^
    File "/home/shcho/torchtitan/timelyfreeze/train.py", line 619, in train
      draw_charts(self.freezer, self.step, job_config)
    File "/home/shcho/torchtitan/timelyfreeze/train.py", line 685, in draw_charts
      draw_line_chart([freezer.stability_check_freq * k for k in range(len(freezer.freeze_ratio_history[s]))],
    File "/home/shcho/torchtitan/timelyfreeze/core/util.py", line 47, in draw_line_chart
      plt.savefig(save_file)
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/pyplot.py", line 1250, in savefig
      res = fig.savefig(*args, **kwargs)  # type: ignore[func-returns-value]
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/figure.py", line 3490, in savefig
      self.canvas.print_figure(fname, **kwargs)
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backend_bases.py", line 2186, in print_figure
      result = print_method(
               ^^^^^^^^^^^^^
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backend_bases.py", line 2042, in <lambda>
      print_method = functools.wraps(meth)(lambda *args, **kwargs: meth(
                                                                   ^^^^^
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backends/backend_svg.py", line 1351, in print_svg
      self.figure.draw(renderer)
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/artist.py", line 94, in draw_wrapper
      result = draw(artist, renderer, *args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/artist.py", line 71, in draw_wrapper
      return draw(artist, renderer)
             ^^^^^^^^^^^^^^^^^^^^^^
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/figure.py", line 3257, in draw
      mimage._draw_list_compositing_images(
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/image.py", line 134, in _draw_list_compositing_images
      a.draw(renderer)
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/artist.py", line 71, in draw_wrapper
      return draw(artist, renderer)
             ^^^^^^^^^^^^^^^^^^^^^^
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/axes/_base.py", line 3226, in draw
      mimage._draw_list_compositing_images(
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/image.py", line 134, in _draw_list_compositing_images
      a.draw(renderer)
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/artist.py", line 71, in draw_wrapper
      return draw(artist, renderer)
             ^^^^^^^^^^^^^^^^^^^^^^
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/axis.py", line 1408, in draw
      tick.draw(renderer)
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/artist.py", line 71, in draw_wrapper
      return draw(artist, renderer)
             ^^^^^^^^^^^^^^^^^^^^^^
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/axis.py", line 276, in draw
      artist.draw(renderer)
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/artist.py", line 71, in draw_wrapper
      return draw(artist, renderer)
             ^^^^^^^^^^^^^^^^^^^^^^
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/text.py", line 808, in draw
      textrenderer.draw_text(gc, x, y, clean_line,
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backends/backend_svg.py", line 1279, in draw_text
      self._draw_text_as_path(gc, x, y, s, prop, angle, ismath, mtext)
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backends/backend_svg.py", line 1074, in _draw_text_as_path
      writer.element(
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backends/backend_svg.py", line 241, in element
      self.start(tag, attrib, **extra)
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backends/backend_svg.py", line 165, in start
      self.__write(f' {k}={v}')
  OSError: [Errno 28] No space left on device
  
[3]:
  time      : 2025-10-26_06:56:18
  host      : elga.kaist.ac.kr
  rank      : 3 (local_rank: 3)
  exitcode  : -15 (pid: 3927010)
  error_file: /tmp/torchelastic_sh2fgtqq/46746915-9fdd-4b28-afde-1b948e108b36_7z24yfy2/attempt_0/3/error.json
  traceback : Traceback (most recent call last):
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
      return f(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^
    File "/home/shcho/torchtitan/timelyfreeze/train.py", line 619, in train
      draw_charts(self.freezer, self.step, job_config)
    File "/home/shcho/torchtitan/timelyfreeze/train.py", line 658, in draw_charts
      draw_pipeline_schedule(save_file=f'pipeline_schedule/{timestamp}_real_{filename_suffix}_rank{config.comm.global_rank}.svg',
    File "/home/shcho/torchtitan/timelyfreeze/core/util.py", line 208, in draw_pipeline_schedule
      plt.savefig(save_file, bbox_inches='tight', pad_inches=0)
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/pyplot.py", line 1250, in savefig
      res = fig.savefig(*args, **kwargs)  # type: ignore[func-returns-value]
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/figure.py", line 3490, in savefig
      self.canvas.print_figure(fname, **kwargs)
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backend_bases.py", line 2186, in print_figure
      result = print_method(
               ^^^^^^^^^^^^^
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backend_bases.py", line 2042, in <lambda>
      print_method = functools.wraps(meth)(lambda *args, **kwargs: meth(
                                                                   ^^^^^
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backends/backend_svg.py", line 1351, in print_svg
      self.figure.draw(renderer)
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/artist.py", line 94, in draw_wrapper
      result = draw(artist, renderer, *args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/artist.py", line 71, in draw_wrapper
      return draw(artist, renderer)
             ^^^^^^^^^^^^^^^^^^^^^^
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/figure.py", line 3257, in draw
      mimage._draw_list_compositing_images(
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/image.py", line 134, in _draw_list_compositing_images
      a.draw(renderer)
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/artist.py", line 71, in draw_wrapper
      return draw(artist, renderer)
             ^^^^^^^^^^^^^^^^^^^^^^
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/axes/_base.py", line 3226, in draw
      mimage._draw_list_compositing_images(
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/image.py", line 134, in _draw_list_compositing_images
      a.draw(renderer)
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/artist.py", line 71, in draw_wrapper
      return draw(artist, renderer)
             ^^^^^^^^^^^^^^^^^^^^^^
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/patches.py", line 642, in draw
      self._draw_paths_with_artist_properties(
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/patches.py", line 627, in _draw_paths_with_artist_properties
      renderer.draw_path(gc, *draw_path_args)
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backends/backend_svg.py", line 688, in draw_path
      self.writer.element('path', d=path_data, **self._get_clip_attrs(gc),
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backends/backend_svg.py", line 241, in element
      self.start(tag, attrib, **extra)
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backends/backend_svg.py", line 165, in start
      self.__write(f' {k}={v}')
  OSError: [Errno 28] No space left on device
  
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2025-10-26_06:56:17
  host      : elga.kaist.ac.kr
  rank      : 2 (local_rank: 2)
  exitcode  : 1 (pid: 3927009)
  error_file: /tmp/torchelastic_sh2fgtqq/46746915-9fdd-4b28-afde-1b948e108b36_7z24yfy2/attempt_0/2/error.json
  traceback : Traceback (most recent call last):
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
      return f(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^
    File "/home/shcho/torchtitan/timelyfreeze/train.py", line 619, in train
      draw_charts(self.freezer, self.step, job_config)
    File "/home/shcho/torchtitan/timelyfreeze/train.py", line 685, in draw_charts
      draw_line_chart([freezer.stability_check_freq * k for k in range(len(freezer.freeze_ratio_history[s]))],
    File "/home/shcho/torchtitan/timelyfreeze/core/util.py", line 47, in draw_line_chart
      plt.savefig(save_file)
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/pyplot.py", line 1250, in savefig
      res = fig.savefig(*args, **kwargs)  # type: ignore[func-returns-value]
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/figure.py", line 3490, in savefig
      self.canvas.print_figure(fname, **kwargs)
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backend_bases.py", line 2186, in print_figure
      result = print_method(
               ^^^^^^^^^^^^^
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backend_bases.py", line 2042, in <lambda>
      print_method = functools.wraps(meth)(lambda *args, **kwargs: meth(
                                                                   ^^^^^
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backends/backend_svg.py", line 1351, in print_svg
      self.figure.draw(renderer)
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/artist.py", line 94, in draw_wrapper
      result = draw(artist, renderer, *args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/artist.py", line 71, in draw_wrapper
      return draw(artist, renderer)
             ^^^^^^^^^^^^^^^^^^^^^^
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/figure.py", line 3257, in draw
      mimage._draw_list_compositing_images(
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/image.py", line 134, in _draw_list_compositing_images
      a.draw(renderer)
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/artist.py", line 71, in draw_wrapper
      return draw(artist, renderer)
             ^^^^^^^^^^^^^^^^^^^^^^
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/axes/_base.py", line 3226, in draw
      mimage._draw_list_compositing_images(
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/image.py", line 134, in _draw_list_compositing_images
      a.draw(renderer)
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/artist.py", line 71, in draw_wrapper
      return draw(artist, renderer)
             ^^^^^^^^^^^^^^^^^^^^^^
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/axis.py", line 1408, in draw
      tick.draw(renderer)
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/artist.py", line 71, in draw_wrapper
      return draw(artist, renderer)
             ^^^^^^^^^^^^^^^^^^^^^^
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/axis.py", line 276, in draw
      artist.draw(renderer)
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/artist.py", line 71, in draw_wrapper
      return draw(artist, renderer)
             ^^^^^^^^^^^^^^^^^^^^^^
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/text.py", line 808, in draw
      textrenderer.draw_text(gc, x, y, clean_line,
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backends/backend_svg.py", line 1279, in draw_text
      self._draw_text_as_path(gc, x, y, s, prop, angle, ismath, mtext)
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backends/backend_svg.py", line 1074, in _draw_text_as_path
      writer.element(
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backends/backend_svg.py", line 241, in element
      self.start(tag, attrib, **extra)
    File "/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/matplotlib/backends/backend_svg.py", line 165, in start
      self.__write(f' {k}={v}')
  OSError: [Errno 28] No space left on device
  
============================================================
