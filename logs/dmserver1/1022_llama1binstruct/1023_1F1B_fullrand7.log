
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: 2025. 10. 25. (í† ) 22:05:27 KST
âœ”ï¸SERVER: dmserver1 (143.248.135.95),  GPUs: 3,4,5,6
âœ”ï¸SCRIPT: /home/shcho/torchtitan/logs/dmserver1/1022_llama1binstruct/run.sh
âœ”ï¸OUTPUT: /home/shcho/torchtitan/logs/dmserver1/1022_llama1binstruct/1023_1F1B_fullrand7.log
âœ”ï¸Main Table Experiment
âœ”ï¸Running with fullrand7 x 1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/home/shcho/torchtitan/logs/dmserver1/1022_llama1binstruct/config.toml --job.description="Main Table Experiment" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=fullrand7
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
[rank1]:2025-10-25 22:05:33,813 - INFO - Starting job: "Main Table Experiment"
[rank3]:2025-10-25 22:05:33,804 - INFO - Starting job: "Main Table Experiment"
[rank0]:2025-10-25 22:05:33,883 - INFO - Starting job: "Main Table Experiment"
[rank2]:2025-10-25 22:05:33,920 - INFO - Starting job: "Main Table Experiment"
[rank1]:2025-10-25 22:05:34,046 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-10-25 22:05:34,048 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-25 22:05:34,134 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-10-25 22:05:34,137 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-10-25 22:05:34,042 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-10-25 22:05:34,044 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-25 22:05:34,141 - INFO - [GC] Initial GC collection 0.00 seconds
[rank2]:2025-10-25 22:05:34,163 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-10-25 22:05:34,165 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-25 22:05:34,502 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-10-25 22:05:34,955 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank0]:2025-10-25 22:05:37,718 - INFO - Building llama3 1B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=2048, n_layers=16, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=256, ffn_dim_multiplier=1.5, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank1]:2025-10-25 22:05:37,881 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank1]:2025-10-25 22:05:37,919 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-10-25 22:05:37,860 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank0]:2025-10-25 22:05:37,903 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-10-25 22:05:37,904 - INFO - Model llama3 1B size: 1,498,482,688 total parameters
[rank0]:2025-10-25 22:05:37,930 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-10-25 22:05:37,931 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2025-10-25 22:05:37,945 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-10-25 22:05:37,945 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2025-10-25 22:05:38,127 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank1]:2025-10-25 22:05:38,127 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank1]:2025-10-25 22:05:38,128 - INFO - CUDA memory usage for model: 1.13GiB(2.39%)
[rank0]:2025-10-25 22:05:38,121 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank0]:2025-10-25 22:05:38,121 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank0]:2025-10-25 22:05:38,121 - INFO - CUDA memory usage for model: 1.90GiB(3.99%)
[rank2]:2025-10-25 22:05:38,065 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank2]:2025-10-25 22:05:38,121 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-10-25 22:05:38,148 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-10-25 22:05:38,148 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank2]:2025-10-25 22:05:38,322 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank2]:2025-10-25 22:05:38,323 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank2]:2025-10-25 22:05:38,323 - INFO - CUDA memory usage for model: 0.92GiB(1.94%)
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run xr68nj0c
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /data2/shcho/torchtitan/tb/1023_1F1B_fullrand7_dm1/20251025-2205/wandb/run-20251025_220538-xr68nj0c
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1023_1F1B_fullrand7_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/xr68nj0c
[rank3]:2025-10-25 22:05:39,975 - INFO - WandB logging enabled
[rank3]:2025-10-25 22:05:39,976 - INFO - CUDA capacity: NVIDIA RTX 6000 Ada Generation with 47.51GiB memory
[rank3]:2025-10-25 22:05:40,016 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-10-25 22:05:40,045 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'norm', 'output']
[rank3]:2025-10-25 22:05:40,046 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2025-10-25 22:05:40,275 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /data2/shcho/torchtitan/checkpoint/1023_1F1B_fullrand7_dm1
[rank0]:2025-10-25 22:05:40,275 - WARNING - Mixed precision training with TP or PP is only supported when FSDP/HSDP/CP is enabled.
[rank0]:2025-10-25 22:05:40,275 - INFO - Mixed precision training is disabled
[rank0]:2025-10-25 22:05:40,275 - INFO - Trainer is initialized with local batch size 16, global batch size 64, gradient accumulation steps 4, sequence length 1024, total steps 2000 (warmup 100)
[rank0]:2025-10-25 22:05:40,275 - INFO - Loading the checkpoint from /data2/shcho/torchtitan/base_model/Llama-3.2-1B-Instruct/original_dcp.
[rank3]:2025-10-25 22:05:40,258 - WARNING - Peak flops undefined for: NVIDIA RTX 6000 Ada Generation, fallback to A100
[rank3]:2025-10-25 22:05:40,259 - INFO - Peak FLOPS used for computing MFU: 3.120e+14
[rank3]:2025-10-25 22:05:40,260 - INFO - CUDA memory usage for model: 1.66GiB(3.50%)
[rank0]:2025-10-25 22:05:43,336 - INFO - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-10-25 22:05:43,336 - INFO - Finished loading the checkpoint in 3.06 seconds.
[rank0]:2025-10-25 22:05:43,337 - INFO - Training starts at step 1
[rank0]:/data2/shcho/miniforge3/envs/llm_eval/lib/python3.11/site-packages/torch/autograd/graph.py:849: UserWarning: Attempting to run cuBLAS, but there was no current CUDA context! Attempting to set the primary context... (Triggered internally at /pytorch/aten/src/ATen/cuda/CublasHandlePool.cpp:270.)
[rank0]:  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
[rank1]:2025-10-25 22:05:55,156 - INFO -  step:  1  loss: -4.0000  grad_norm:  3.4827  memory:  8.46GiB(17.81%)  tps: 951  tflops: 7.43  mfu: 2.38%
[rank1]:2025-10-25 22:05:55,156 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-10-25 22:05:55,156 - INFO -  step:  1  loss: -4.0000  grad_norm:  3.4827  memory:  5.39GiB(11.36%)  tps: 962  tflops: 7.52  mfu: 2.41%
[rank2]:2025-10-25 22:05:55,156 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-25 22:05:55,163 - INFO -  step:  1  loss:  1.7854  grad_norm:  3.4827  memory: 20.75GiB(43.67%)  tps: 1,082  tflops: 8.46  mfu: 2.71%
[rank3]:2025-10-25 22:05:55,164 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-10-25 22:05:55,190 - INFO -  step:  1  loss: -4.0000  grad_norm:  3.4827  memory: 11.08GiB(23.32%)  tps: 948  tflops: 7.41  mfu: 2.37%
[rank0]:2025-10-25 22:05:55,191 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-25 22:06:09,630 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-25 22:06:09,632 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-25 22:06:09,632 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-25 22:06:09,632 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-25 22:06:09,633 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-25 22:06:09,633 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-25 22:06:09,633 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-25 22:06:09,633 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-25 22:06:09,634 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-25 22:06:09,634 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-25 22:06:09,634 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-25 22:06:09,635 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-25 22:06:09,635 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-25 22:06:09,635 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-25 22:06:09,635 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-25 22:06:09,636 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 22:06:09,696 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 22:06:09,696 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 22:06:09,696 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 22:06:09,696 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 22:06:09,696 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 22:06:09,697 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 22:06:09,697 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 22:06:09,697 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 22:06:09,697 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 22:06:09,697 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 22:06:09,697 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 22:06:09,697 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 22:06:09,697 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 22:06:09,697 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 22:06:09,697 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 22:06:09,697 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-25 22:06:09,774 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-25 22:06:09,774 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-25 22:06:09,774 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-25 22:06:09,775 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-25 22:06:09,775 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-25 22:06:09,775 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-25 22:06:09,775 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-25 22:06:09,775 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-25 22:06:09,775 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-25 22:06:09,775 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-25 22:06:09,775 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-25 22:06:09,775 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-25 22:06:09,775 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-25 22:06:09,775 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-25 22:06:09,775 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-25 22:06:09,775 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 22:06:09,843 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 22:06:09,843 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 22:06:09,843 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 22:06:09,843 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 22:06:09,843 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 22:06:09,843 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 22:06:09,843 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 22:06:09,843 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 22:06:09,843 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 22:06:09,843 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 22:06:09,844 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 22:06:09,844 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 22:06:09,844 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 22:06:09,844 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 22:06:09,844 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 22:06:09,844 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 22:08:35,477 - INFO -  step: 20  loss: -4.0000  grad_norm:  1.4899  memory:  7.21GiB(15.18%)  tps: 1,942  tflops: 15.18  mfu: 4.87%
[rank1]:2025-10-25 22:08:35,482 - INFO -  step: 20  loss: -4.0000  grad_norm:  1.4899  memory: 10.73GiB(22.58%)  tps: 1,942  tflops: 15.18  mfu: 4.87%
[rank0]:2025-10-25 22:08:35,492 - INFO -  step: 20  loss: -4.0000  grad_norm:  1.4899  memory: 14.87GiB(31.30%)  tps: 1,942  tflops: 15.18  mfu: 4.87%
[rank3]:2025-10-25 22:08:35,489 - INFO -  step: 20  loss:  1.3862  grad_norm:  1.4899  memory: 24.67GiB(51.93%)  tps: 1,942  tflops: 15.18  mfu: 4.87%
[rank3]:2025-10-25 22:08:37,411 - INFO - Avg. fwd time: 68.8945 / Avg. bwd time: 138.1240 / Avg. batch time: 1733.4102 (ms) / GPU bubble ratio: 4.46%
[rank2]:2025-10-25 22:08:37,473 - INFO - Avg. fwd time: 34.9604 / Avg. bwd time: 54.0298 / Avg. batch time: 1825.7433 (ms) / GPU bubble ratio: 61.01%
[rank1]:2025-10-25 22:08:37,554 - INFO - Avg. fwd time: 50.0641 / Avg. bwd time: 70.8568 / Avg. batch time: 1946.3844 (ms) / GPU bubble ratio: 50.30%
[rank0]:2025-10-25 22:08:37,622 - INFO - Avg. fwd time: 39.8542 / Avg. bwd time: 61.1776 / Avg. batch time: 2045.9650 (ms) / GPU bubble ratio: 60.50%
[rank2]:2025-10-25 22:11:25,949 - INFO -  step: 40  loss: -4.0000  grad_norm:  2.1309  memory:  7.21GiB(15.18%)  tps: 1,922  tflops: 15.03  mfu: 4.82%
[rank0]:2025-10-25 22:11:25,969 - INFO -  step: 40  loss: -4.0000  grad_norm:  2.1309  memory: 14.87GiB(31.30%)  tps: 1,922  tflops: 15.03  mfu: 4.82%
[rank3]:2025-10-25 22:11:25,962 - INFO -  step: 40  loss:  1.2757  grad_norm:  2.1309  memory: 24.67GiB(51.93%)  tps: 1,922  tflops: 15.03  mfu: 4.82%
[rank1]:2025-10-25 22:11:25,960 - INFO -  step: 40  loss: -4.0000  grad_norm:  2.1309  memory: 10.73GiB(22.58%)  tps: 1,922  tflops: 15.03  mfu: 4.82%
[rank3]:2025-10-25 22:11:27,865 - INFO - Avg. fwd time: 69.8828 / Avg. bwd time: 139.8532 / Avg. batch time: 1744.9330 (ms) / GPU bubble ratio: 3.84%
[rank2]:2025-10-25 22:11:27,923 - INFO - Avg. fwd time: 35.3346 / Avg. bwd time: 54.4781 / Avg. batch time: 1837.1212 (ms) / GPU bubble ratio: 60.89%
[rank1]:2025-10-25 22:11:27,993 - INFO - Avg. fwd time: 50.5374 / Avg. bwd time: 71.3232 / Avg. batch time: 1957.8316 (ms) / GPU bubble ratio: 50.21%
[rank0]:2025-10-25 22:11:28,060 - INFO - Avg. fwd time: 40.5989 / Avg. bwd time: 61.9765 / Avg. batch time: 2058.0195 (ms) / GPU bubble ratio: 60.13%
[rank0]:2025-10-25 22:12:42,782 - INFO - [GC] Peforming periodical GC collection 0.02 seconds
[rank2]:2025-10-25 22:14:16,459 - INFO -  step: 60  loss: -4.0000  grad_norm:  0.5366  memory:  7.21GiB(15.18%)  tps: 1,922  tflops: 15.02  mfu: 4.82%
[rank0]:2025-10-25 22:14:16,477 - INFO -  step: 60  loss: -4.0000  grad_norm:  0.5366  memory: 14.87GiB(31.30%)  tps: 1,922  tflops: 15.02  mfu: 4.82%
[rank3]:2025-10-25 22:14:16,471 - INFO -  step: 60  loss:  1.2100  grad_norm:  0.5366  memory: 24.67GiB(51.93%)  tps: 1,922  tflops: 15.02  mfu: 4.82%
[rank1]:2025-10-25 22:14:16,462 - INFO -  step: 60  loss: -4.0000  grad_norm:  0.5366  memory: 10.73GiB(22.58%)  tps: 1,922  tflops: 15.02  mfu: 4.82%
[rank3]:2025-10-25 22:14:18,413 - INFO - Avg. fwd time: 70.1985 / Avg. bwd time: 140.5111 / Avg. batch time: 1749.2699 (ms) / GPU bubble ratio: 3.64%
[rank2]:2025-10-25 22:14:18,470 - INFO - Avg. fwd time: 35.4352 / Avg. bwd time: 54.6038 / Avg. batch time: 1841.3429 (ms) / GPU bubble ratio: 60.88%
[rank1]:2025-10-25 22:14:18,551 - INFO - Avg. fwd time: 50.7193 / Avg. bwd time: 71.5681 / Avg. batch time: 1962.3143 (ms) / GPU bubble ratio: 50.15%
[rank0]:2025-10-25 22:14:18,612 - INFO - Avg. fwd time: 40.6625 / Avg. bwd time: 62.1397 / Avg. batch time: 2062.6147 (ms) / GPU bubble ratio: 60.13%
[rank3]:2025-10-25 22:17:06,524 - INFO -  step: 80  loss:  1.1799  grad_norm:  0.5012  memory: 24.67GiB(51.93%)  tps: 1,927  tflops: 15.06  mfu: 4.83%
[rank2]:2025-10-25 22:17:06,512 - INFO -  step: 80  loss: -4.0000  grad_norm:  0.5012  memory:  7.21GiB(15.18%)  tps: 1,927  tflops: 15.06  mfu: 4.83%
[rank1]:2025-10-25 22:17:06,516 - INFO -  step: 80  loss: -4.0000  grad_norm:  0.5012  memory: 10.73GiB(22.58%)  tps: 1,927  tflops: 15.06  mfu: 4.83%
[rank0]:2025-10-25 22:17:06,529 - INFO -  step: 80  loss: -4.0000  grad_norm:  0.5012  memory: 14.87GiB(31.30%)  tps: 1,927  tflops: 15.06  mfu: 4.83%
[rank3]:2025-10-25 22:17:08,452 - INFO - Avg. fwd time: 70.2958 / Avg. bwd time: 140.7277 / Avg. batch time: 1750.0312 (ms) / GPU bubble ratio: 3.53%
[rank2]:2025-10-25 22:17:08,508 - INFO - Avg. fwd time: 35.4713 / Avg. bwd time: 54.6406 / Avg. batch time: 1842.0536 (ms) / GPU bubble ratio: 60.86%
[rank1]:2025-10-25 22:17:08,579 - INFO - Avg. fwd time: 50.7938 / Avg. bwd time: 71.6759 / Avg. batch time: 1963.0758 (ms) / GPU bubble ratio: 50.09%
[rank0]:2025-10-25 22:17:08,641 - INFO - Avg. fwd time: 40.6545 / Avg. bwd time: 62.1407 / Avg. batch time: 2063.2598 (ms) / GPU bubble ratio: 60.14%
[rank3]:2025-10-25 22:17:24,613 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 22:17:25,532 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 22:17:25,602 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 22:17:25,669 - WARNING - Dataset alpaca is being re-looped
[rank3]:2025-10-25 22:19:14,125 - INFO - [Step 95] ã€°ï¸ Monitoring Upperbound
[rank0]:2025-10-25 22:19:48,994 - INFO - [GC] Peforming periodical GC collection 0.03 seconds
[rank3]:2025-10-25 22:19:56,596 - INFO - [Step 100] âœ”ï¸  Setting Upperbound
[rank3]:2025-10-25 22:19:57,549 - INFO - [Step 100] ã€°ï¸ Monitoring Lowerbound
[rank3]:2025-10-25 22:19:57,552 - INFO -  step: 100  loss:  1.1786  grad_norm:  0.4903  memory: 24.67GiB(51.93%)  tps: 1,916  tflops: 14.98  mfu: 4.80%
[rank2]:2025-10-25 22:19:57,551 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.4903  memory:  7.21GiB(15.18%)  tps: 1,916  tflops: 14.98  mfu: 4.80%
[rank1]:2025-10-25 22:19:57,551 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.4903  memory: 10.73GiB(22.58%)  tps: 1,916  tflops: 14.98  mfu: 4.80%
[rank0]:2025-10-25 22:19:57,551 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.4903  memory: 14.87GiB(31.30%)  tps: 1,916  tflops: 14.98  mfu: 4.80%
[rank0]:2025-10-25 22:19:57,628 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251025_2219_stage0_step100.svg
[rank2]:2025-10-25 22:19:57,627 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251025_2219_stage2_step100.svg
[rank2]:2025-10-25 22:19:57,694 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-25 22:19:57,628 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251025_2219_stage1_step100.svg
[rank1]:2025-10-25 22:19:57,703 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-25 22:19:57,704 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-25 22:19:57,726 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-25 22:19:57,708 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-25 22:19:57,725 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-25 22:19:57,740 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-25 22:19:57,733 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-25 22:19:57,761 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-25 22:19:57,750 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-25 22:19:57,781 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-25 22:19:57,814 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/pipeline_schedule/251025_2219_real_step100_rank3.svg
[rank3]:> Batch Time: 2005.53 ms, GPU Bubble Ratio: 58.59%, 51.13%, 64.10%, 15.29%
[rank3]:2025-10-25 22:19:57,872 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251025_2219_stage3_step100.svg
[rank3]:2025-10-25 22:19:57,934 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-25 22:19:57,953 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-25 22:19:57,970 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-25 22:19:57,987 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-25 22:19:58,001 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-25 22:19:58,018 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-25 22:19:58,142 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-25 22:19:58,150 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-25 22:19:58,215 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-25 22:19:58,224 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-25 22:19:58,306 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-25 22:19:58,304 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-25 22:19:58,305 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-25 22:19:58,306 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-25 22:19:58,307 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-25 22:19:58,303 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-25 22:19:58,364 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-25 22:19:58,475 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-25 22:19:58,446 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-25 22:19:58,539 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-25 22:19:58,604 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-25 22:19:59,257 - INFO - Avg. fwd time: 70.2976 / Avg. bwd time: 140.6311 / Avg. batch time: 1748.2106 (ms) / GPU bubble ratio: 3.48%
[rank2]:2025-10-25 22:19:59,289 - INFO - Avg. fwd time: 35.4653 / Avg. bwd time: 54.6252 / Avg. batch time: 1840.3556 (ms) / GPU bubble ratio: 60.84%
[rank1]:2025-10-25 22:19:59,329 - INFO - Avg. fwd time: 50.8662 / Avg. bwd time: 71.6655 / Avg. batch time: 1961.3483 (ms) / GPU bubble ratio: 50.02%
[rank0]:2025-10-25 22:19:59,343 - INFO - Avg. fwd time: 40.6247 / Avg. bwd time: 62.0201 / Avg. batch time: 2061.2948 (ms) / GPU bubble ratio: 60.16%
[rank3]:2025-10-25 22:20:27,641 - INFO - [Step 105] âœ”ï¸  Setting Lowerbound
[rank3]:2025-10-25 22:20:27,946 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/pipeline_schedule/251025_2220_max_batch_time.svg
[rank3]:> Batch Time: 1999.41 ms, GPU Bubble Ratio: 58.78%, 50.43%, 64.31%, 15.20%
[rank3]:2025-10-25 22:20:28,157 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/pipeline_schedule/251025_2220_min_batch_time.svg
[rank3]:> Batch Time: 1380.86 ms, GPU Bubble Ratio: 76.31%, 48.02%, 62.65%, 12.95%
[rank3]:2025-10-25 22:20:28,385 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/pipeline_schedule/251025_2220_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 1380.86 ms, GPU Bubble Ratio: 44.89%, 30.98%, 50.05%, 12.95%
[rank3]:2025-10-25 22:20:28,385 - INFO - 	> Batch Time: 1380.86 ms (Average Freeze Ratio: 0.34, Time Reduction Rate: 0.31)
[rank3]:2025-10-25 22:22:07,741 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank2]:2025-10-25 22:22:08,674 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-10-25 22:22:08,755 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-25 22:22:08,827 - INFO -  step: 120  loss: -4.0000  grad_norm:  0.2895  memory:  7.25GiB(15.26%)  tps: 2,496  tflops: 19.51  mfu: 6.25%
[rank3]:2025-10-25 22:22:08,831 - INFO -  step: 120  loss:  1.1317  grad_norm:  0.2895  memory: 24.67GiB(51.93%)  tps: 2,496  tflops: 19.51  mfu: 6.25%
[rank1]:2025-10-25 22:22:08,831 - INFO -  step: 120  loss: -4.0000  grad_norm:  0.2895  memory: 10.75GiB(22.62%)  tps: 2,496  tflops: 19.51  mfu: 6.25%
[rank0]:2025-10-25 22:22:08,813 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-25 22:22:08,849 - INFO -  step: 120  loss: -4.0000  grad_norm:  0.2895  memory: 14.89GiB(31.34%)  tps: 2,496  tflops: 19.51  mfu: 6.25%
[rank3]:2025-10-25 22:22:10,284 - INFO - Avg. fwd time: 70.3184 / Avg. bwd time: 131.4058 / Avg. batch time: 1673.7319 (ms) / GPU bubble ratio: 3.58%
[rank2]:2025-10-25 22:22:10,337 - INFO - Avg. fwd time: 35.4299 / Avg. bwd time: 53.0699 / Avg. batch time: 1765.5808 (ms) / GPU bubble ratio: 59.90%
[rank1]:2025-10-25 22:22:10,404 - INFO - Avg. fwd time: 50.7202 / Avg. bwd time: 69.4053 / Avg. batch time: 1884.4333 (ms) / GPU bubble ratio: 49.00%
[rank0]:2025-10-25 22:22:10,463 - INFO - Avg. fwd time: 40.4539 / Avg. bwd time: 56.8152 / Avg. batch time: 1981.0563 (ms) / GPU bubble ratio: 60.72%
[rank3]:2025-10-25 22:24:17,496 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/pipeline_schedule_adjustment/251025_2224_rank3_trend_line.svg
[rank1]:2025-10-25 22:24:17,514 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/pipeline_schedule_adjustment/251025_2224_rank1_trend_line.svg
[rank1]:2025-10-25 22:24:17,532 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank1]:2025-10-25 22:24:17,533 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank1]:2025-10-25 22:24:17,533 - INFO -  step: 140  loss: -4.0000  grad_norm:  0.2688  memory: 10.75GiB(22.62%)  tps: 2,546  tflops: 19.90  mfu: 6.38%
[rank0]:2025-10-25 22:24:17,526 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/pipeline_schedule_adjustment/251025_2224_rank0_trend_line.svg
[rank0]:2025-10-25 22:24:17,532 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank0]:2025-10-25 22:24:17,533 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank0]:2025-10-25 22:24:17,533 - INFO -  step: 140  loss: -4.0000  grad_norm:  0.2688  memory: 14.89GiB(31.34%)  tps: 2,546  tflops: 19.91  mfu: 6.38%
[rank2]:2025-10-25 22:24:17,506 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/pipeline_schedule_adjustment/251025_2224_rank2_trend_line.svg
[rank2]:2025-10-25 22:24:17,532 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank2]:2025-10-25 22:24:17,532 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank2]:2025-10-25 22:24:17,533 - INFO -  step: 140  loss: -4.0000  grad_norm:  0.2688  memory:  7.25GiB(15.26%)  tps: 2,546  tflops: 19.90  mfu: 6.38%
[rank3]:2025-10-25 22:24:17,760 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/pipeline_schedule/251025_2224_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 1461.12 ms, GPU Bubble Ratio: 60.07%, 37.26%, 53.27%, 17.66%
[rank3]:2025-10-25 22:24:17,761 - INFO - 	> Batch Time: 1461.12 ms (Average Freeze Ratio: 0.25)
[rank3]:2025-10-25 22:24:17,761 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-25 22:24:17,762 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-25 22:24:17,765 - INFO -  step: 140  loss:  1.1562  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,541  tflops: 19.87  mfu: 6.37%
[rank3]:2025-10-25 22:24:19,084 - INFO - Avg. fwd time: 70.3598 / Avg. bwd time: 123.9067 / Avg. batch time: 1613.5097 (ms) / GPU bubble ratio: 3.68%
[rank2]:2025-10-25 22:24:19,141 - INFO - Avg. fwd time: 35.5182 / Avg. bwd time: 52.6314 / Avg. batch time: 1705.0445 (ms) / GPU bubble ratio: 58.64%
[rank1]:2025-10-25 22:24:19,225 - INFO - Avg. fwd time: 50.6515 / Avg. bwd time: 68.5230 / Avg. batch time: 1823.2128 (ms) / GPU bubble ratio: 47.71%
[rank0]:2025-10-25 22:24:19,288 - INFO - Avg. fwd time: 40.2558 / Avg. bwd time: 53.0039 / Avg. batch time: 1919.3490 (ms) / GPU bubble ratio: 61.13%
[rank0]:2025-10-25 22:25:16,094 - INFO - [GC] Peforming periodical GC collection 0.03 seconds
[rank2]:2025-10-25 22:26:27,746 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/pipeline_schedule_adjustment/251025_2226_rank2_trend_line.svg
[rank3]:2025-10-25 22:26:27,736 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/pipeline_schedule_adjustment/251025_2226_rank3_trend_line.svg
[rank1]:2025-10-25 22:26:27,753 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/pipeline_schedule_adjustment/251025_2226_rank1_trend_line.svg
[rank1]:2025-10-25 22:26:27,773 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-10-25 22:26:27,774 - INFO -  step: 160  loss: -4.0000  grad_norm:  0.4202  memory: 10.75GiB(22.62%)  tps: 2,516  tflops: 19.67  mfu: 6.30%
[rank0]:2025-10-25 22:26:27,767 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/pipeline_schedule_adjustment/251025_2226_rank0_trend_line.svg
[rank0]:2025-10-25 22:26:27,772 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank0]:2025-10-25 22:26:27,773 - INFO -  step: 160  loss: -4.0000  grad_norm:  0.4202  memory: 14.89GiB(31.34%)  tps: 2,516  tflops: 19.67  mfu: 6.30%
[rank2]:2025-10-25 22:26:27,772 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-25 22:26:27,773 - INFO -  step: 160  loss: -4.0000  grad_norm:  0.4202  memory:  7.25GiB(15.26%)  tps: 2,516  tflops: 19.67  mfu: 6.30%
[rank3]:2025-10-25 22:26:28,005 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/pipeline_schedule/251025_2226_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 1473.65 ms, GPU Bubble Ratio: 54.43%, 33.07%, 52.14%, 18.58%
[rank3]:2025-10-25 22:26:28,006 - INFO - 	> Batch Time: 1473.65 ms (Average Freeze Ratio: 0.31)
[rank3]:2025-10-25 22:26:28,006 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-25 22:26:28,010 - INFO -  step: 160  loss:  1.1195  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,516  tflops: 19.67  mfu: 6.30%
[rank3]:2025-10-25 22:26:29,323 - INFO - Avg. fwd time: 70.3803 / Avg. bwd time: 118.2460 / Avg. batch time: 1568.0457 (ms) / GPU bubble ratio: 3.76%
[rank2]:2025-10-25 22:26:29,377 - INFO - Avg. fwd time: 35.6512 / Avg. bwd time: 53.3446 / Avg. batch time: 1659.8980 (ms) / GPU bubble ratio: 57.11%
[rank1]:2025-10-25 22:26:29,445 - INFO - Avg. fwd time: 51.0937 / Avg. bwd time: 71.0579 / Avg. batch time: 1778.6256 (ms) / GPU bubble ratio: 45.06%
[rank0]:2025-10-25 22:26:29,512 - INFO - Avg. fwd time: 40.3951 / Avg. bwd time: 54.2579 / Avg. batch time: 1875.2096 (ms) / GPU bubble ratio: 59.62%
[rank3]:2025-10-25 22:26:55,907 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 22:26:56,765 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 22:26:56,832 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 22:26:56,896 - WARNING - Dataset alpaca is being re-looped
[rank3]:2025-10-25 22:28:39,122 - INFO -  step: 180  loss:  1.1042  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,499  tflops: 19.54  mfu: 6.26%
[rank1]:2025-10-25 22:28:39,138 - INFO -  step: 180  loss: -4.0000  grad_norm:  0.4099  memory: 10.75GiB(22.62%)  tps: 2,494  tflops: 19.50  mfu: 6.25%
[rank0]:2025-10-25 22:28:39,157 - INFO -  step: 180  loss: -4.0000  grad_norm:  0.4099  memory: 14.89GiB(31.34%)  tps: 2,494  tflops: 19.50  mfu: 6.25%
[rank2]:2025-10-25 22:28:39,134 - INFO -  step: 180  loss: -4.0000  grad_norm:  0.4099  memory:  7.25GiB(15.26%)  tps: 2,495  tflops: 19.50  mfu: 6.25%
[rank3]:2025-10-25 22:28:40,580 - INFO - Avg. fwd time: 70.3641 / Avg. bwd time: 113.8376 / Avg. batch time: 1532.3484 (ms) / GPU bubble ratio: 3.83%
[rank2]:2025-10-25 22:28:40,642 - INFO - Avg. fwd time: 35.6960 / Avg. bwd time: 52.9694 / Avg. batch time: 1623.7891 (ms) / GPU bubble ratio: 56.32%
[rank1]:2025-10-25 22:28:40,711 - INFO - Avg. fwd time: 51.0470 / Avg. bwd time: 70.2186 / Avg. batch time: 1742.0588 (ms) / GPU bubble ratio: 44.31%
[rank0]:2025-10-25 22:28:40,773 - INFO - Avg. fwd time: 40.5517 / Avg. bwd time: 55.2182 / Avg. batch time: 1839.6517 (ms) / GPU bubble ratio: 58.35%
[rank0]:2025-10-25 22:30:41,530 - INFO - [GC] Peforming periodical GC collection 0.03 seconds
[rank2]:2025-10-25 22:30:48,063 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/pipeline_schedule_adjustment/251025_2230_rank2_trend_line.svg
[rank3]:2025-10-25 22:30:48,055 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/pipeline_schedule_adjustment/251025_2230_rank3_trend_line.svg
[rank1]:2025-10-25 22:30:48,073 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/pipeline_schedule_adjustment/251025_2230_rank1_trend_line.svg
[rank1]:2025-10-25 22:30:48,094 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-10-25 22:30:48,095 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.3575  memory: 10.75GiB(22.62%)  tps: 2,541  tflops: 19.86  mfu: 6.37%
[rank0]:2025-10-25 22:30:48,087 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/pipeline_schedule_adjustment/251025_2230_rank0_trend_line.svg
[rank0]:2025-10-25 22:30:48,093 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank0]:2025-10-25 22:30:48,094 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.3575  memory: 14.89GiB(31.34%)  tps: 2,541  tflops: 19.87  mfu: 6.37%
[rank2]:2025-10-25 22:30:48,093 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-25 22:30:48,095 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.3575  memory:  7.25GiB(15.26%)  tps: 2,541  tflops: 19.86  mfu: 6.37%
[rank3]:2025-10-25 22:30:48,327 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/pipeline_schedule/251025_2230_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 1480.88 ms, GPU Bubble Ratio: 49.82%, 34.91%, 52.90%, 19.10%
[rank3]:2025-10-25 22:30:48,328 - INFO - 	> Batch Time: 1480.88 ms (Average Freeze Ratio: 0.31)
[rank3]:2025-10-25 22:30:48,328 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-25 22:30:48,332 - INFO -  step: 200  loss:  1.1184  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,536  tflops: 19.83  mfu: 6.35%
[rank1]:2025-10-25 22:30:48,403 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251025_2230_stage1_step200.svg
[rank0]:2025-10-25 22:30:48,400 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251025_2230_stage0_step200.svg
[rank2]:2025-10-25 22:30:48,400 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251025_2230_stage2_step200.svg
[rank3]:2025-10-25 22:30:48,566 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/pipeline_schedule/251025_2230_real_step200_rank3.svg
[rank3]:> Batch Time: 1903.88 ms, GPU Bubble Ratio: 56.81%, 48.42%, 61.89%, 15.53%
[rank3]:2025-10-25 22:30:48,630 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251025_2230_stage3_step200.svg
[rank3]:2025-10-25 22:30:49,937 - INFO - Avg. fwd time: 70.3485 / Avg. bwd time: 110.3028 / Avg. batch time: 1503.7121 (ms) / GPU bubble ratio: 3.89%
[rank2]:2025-10-25 22:30:49,992 - INFO - Avg. fwd time: 35.7253 / Avg. bwd time: 52.6529 / Avg. batch time: 1594.9398 (ms) / GPU bubble ratio: 55.67%
[rank1]:2025-10-25 22:30:50,070 - INFO - Avg. fwd time: 51.0278 / Avg. bwd time: 69.5157 / Avg. batch time: 1712.7803 (ms) / GPU bubble ratio: 43.70%
[rank0]:2025-10-25 22:30:50,132 - INFO - Avg. fwd time: 40.6286 / Avg. bwd time: 55.9509 / Avg. batch time: 1810.7383 (ms) / GPU bubble ratio: 57.33%
[rank3]:2025-10-25 22:32:57,202 - INFO -  step: 220  loss:  1.1011  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,543  tflops: 19.88  mfu: 6.37%
[rank2]:2025-10-25 22:32:57,214 - INFO -  step: 220  loss: -4.0000  grad_norm:  0.3912  memory:  7.25GiB(15.26%)  tps: 2,538  tflops: 19.84  mfu: 6.36%
[rank1]:2025-10-25 22:32:57,218 - INFO -  step: 220  loss: -4.0000  grad_norm:  0.3912  memory: 10.75GiB(22.62%)  tps: 2,538  tflops: 19.84  mfu: 6.36%
[rank0]:2025-10-25 22:32:57,234 - INFO -  step: 220  loss: -4.0000  grad_norm:  0.3912  memory: 14.89GiB(31.34%)  tps: 2,537  tflops: 19.84  mfu: 6.36%
[rank3]:2025-10-25 22:32:58,662 - INFO - Avg. fwd time: 70.3294 / Avg. bwd time: 107.4013 / Avg. batch time: 1480.1658 (ms) / GPU bubble ratio: 3.94%
[rank2]:2025-10-25 22:32:58,717 - INFO - Avg. fwd time: 35.7366 / Avg. bwd time: 52.3834 / Avg. batch time: 1571.1191 (ms) / GPU bubble ratio: 55.13%
[rank1]:2025-10-25 22:32:58,789 - INFO - Avg. fwd time: 50.9904 / Avg. bwd time: 68.9891 / Avg. batch time: 1688.6504 (ms) / GPU bubble ratio: 43.16%
[rank0]:2025-10-25 22:32:58,853 - INFO - Avg. fwd time: 40.7147 / Avg. bwd time: 56.5538 / Avg. batch time: 1786.8675 (ms) / GPU bubble ratio: 56.45%
[rank2]:2025-10-25 22:35:06,309 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/pipeline_schedule_adjustment/251025_2235_rank2_trend_line.svg
[rank3]:2025-10-25 22:35:06,297 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/pipeline_schedule_adjustment/251025_2235_rank3_trend_line.svg
[rank1]:2025-10-25 22:35:06,313 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/pipeline_schedule_adjustment/251025_2235_rank1_trend_line.svg
[rank1]:2025-10-25 22:35:06,336 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-10-25 22:35:06,337 - INFO -  step: 240  loss: -4.0000  grad_norm:  0.3813  memory: 10.75GiB(22.62%)  tps: 2,538  tflops: 19.84  mfu: 6.36%
[rank0]:2025-10-25 22:35:06,329 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/pipeline_schedule_adjustment/251025_2235_rank0_trend_line.svg
[rank0]:2025-10-25 22:35:06,335 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-25 22:35:06,337 - INFO -  step: 240  loss: -4.0000  grad_norm:  0.3813  memory: 14.89GiB(31.34%)  tps: 2,538  tflops: 19.84  mfu: 6.36%
[rank2]:2025-10-25 22:35:06,335 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-25 22:35:06,337 - INFO -  step: 240  loss: -4.0000  grad_norm:  0.3813  memory:  7.25GiB(15.26%)  tps: 2,538  tflops: 19.84  mfu: 6.36%
[rank3]:2025-10-25 22:35:06,560 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/pipeline_schedule/251025_2235_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 1481.98 ms, GPU Bubble Ratio: 48.14%, 35.73%, 53.23%, 19.23%
[rank3]:2025-10-25 22:35:06,561 - INFO - 	> Batch Time: 1481.98 ms (Average Freeze Ratio: 0.34)
[rank3]:2025-10-25 22:35:06,561 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-25 22:35:06,565 - INFO -  step: 240  loss:  1.0346  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,533  tflops: 19.80  mfu: 6.35%
[rank3]:2025-10-25 22:35:07,886 - INFO - Avg. fwd time: 70.3279 / Avg. bwd time: 104.9826 / Avg. batch time: 1460.6645 (ms) / GPU bubble ratio: 3.98%
[rank2]:2025-10-25 22:35:07,944 - INFO - Avg. fwd time: 35.7608 / Avg. bwd time: 52.2129 / Avg. batch time: 1551.5019 (ms) / GPU bubble ratio: 54.64%
[rank1]:2025-10-25 22:35:08,018 - INFO - Avg. fwd time: 51.0455 / Avg. bwd time: 68.6347 / Avg. batch time: 1669.0030 (ms) / GPU bubble ratio: 42.63%
[rank0]:2025-10-25 22:35:08,074 - INFO - Avg. fwd time: 40.7902 / Avg. bwd time: 57.1031 / Avg. batch time: 1767.3705 (ms) / GPU bubble ratio: 55.69%
[rank3]:2025-10-25 22:35:48,942 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 22:35:49,808 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 22:35:49,931 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 22:35:49,879 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 22:36:06,324 - INFO - [GC] Peforming periodical GC collection 0.04 seconds
[rank2]:2025-10-25 22:37:17,172 - INFO -  step: 260  loss: -4.0000  grad_norm:  0.2640  memory:  7.25GiB(15.26%)  tps: 2,505  tflops: 19.58  mfu: 6.28%
[rank3]:2025-10-25 22:37:17,160 - INFO -  step: 260  loss:  1.0656  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,509  tflops: 19.62  mfu: 6.29%
[rank1]:2025-10-25 22:37:17,178 - INFO -  step: 260  loss: -4.0000  grad_norm:  0.2640  memory: 10.75GiB(22.62%)  tps: 2,504  tflops: 19.58  mfu: 6.28%
[rank0]:2025-10-25 22:37:17,198 - INFO -  step: 260  loss: -4.0000  grad_norm:  0.2640  memory: 14.89GiB(31.34%)  tps: 2,504  tflops: 19.58  mfu: 6.27%
[rank3]:2025-10-25 22:37:18,623 - INFO - Avg. fwd time: 70.3497 / Avg. bwd time: 102.9844 / Avg. batch time: 1444.7299 (ms) / GPU bubble ratio: 4.02%
[rank2]:2025-10-25 22:37:18,682 - INFO - Avg. fwd time: 35.7789 / Avg. bwd time: 52.0342 / Avg. batch time: 1535.3525 (ms) / GPU bubble ratio: 54.24%
[rank1]:2025-10-25 22:37:18,756 - INFO - Avg. fwd time: 50.9908 / Avg. bwd time: 68.2304 / Avg. batch time: 1652.5523 (ms) / GPU bubble ratio: 42.29%
[rank0]:2025-10-25 22:37:18,820 - INFO - Avg. fwd time: 40.6888 / Avg. bwd time: 55.0510 / Avg. batch time: 1751.0748 (ms) / GPU bubble ratio: 56.26%
[rank3]:2025-10-25 22:39:25,980 - INFO -  step: 280  loss:  1.0793  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,544  tflops: 19.89  mfu: 6.37%
[rank1]:2025-10-25 22:39:25,998 - INFO -  step: 280  loss: -4.0000  grad_norm:  0.2711  memory: 10.75GiB(22.62%)  tps: 2,544  tflops: 19.89  mfu: 6.37%
[rank2]:2025-10-25 22:39:25,992 - INFO -  step: 280  loss: -4.0000  grad_norm:  0.2711  memory:  7.25GiB(15.26%)  tps: 2,544  tflops: 19.89  mfu: 6.37%
[rank0]:2025-10-25 22:39:26,020 - INFO -  step: 280  loss: -4.0000  grad_norm:  0.2711  memory: 14.89GiB(31.34%)  tps: 2,544  tflops: 19.89  mfu: 6.37%
[rank3]:2025-10-25 22:39:27,430 - INFO - Avg. fwd time: 70.3671 / Avg. bwd time: 101.2619 / Avg. batch time: 1430.9843 (ms) / GPU bubble ratio: 4.05%
[rank2]:2025-10-25 22:39:27,484 - INFO - Avg. fwd time: 35.8022 / Avg. bwd time: 51.8919 / Avg. batch time: 1521.4296 (ms) / GPU bubble ratio: 53.89%
[rank1]:2025-10-25 22:39:27,566 - INFO - Avg. fwd time: 50.8951 / Avg. bwd time: 67.8911 / Avg. batch time: 1638.3631 (ms) / GPU bubble ratio: 42.00%
[rank0]:2025-10-25 22:39:27,622 - INFO - Avg. fwd time: 40.5703 / Avg. bwd time: 53.2693 / Avg. batch time: 1736.5173 (ms) / GPU bubble ratio: 56.77%
[rank0]:2025-10-25 22:41:28,335 - INFO - [GC] Peforming periodical GC collection 0.03 seconds
[rank1]:2025-10-25 22:41:34,763 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.2816  memory: 10.75GiB(22.62%)  tps: 2,545  tflops: 19.89  mfu: 6.38%
[rank3]:2025-10-25 22:41:34,744 - INFO -  step: 300  loss:  1.0532  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,545  tflops: 19.89  mfu: 6.38%
[rank2]:2025-10-25 22:41:34,756 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.2816  memory:  7.25GiB(15.26%)  tps: 2,545  tflops: 19.89  mfu: 6.38%
[rank0]:2025-10-25 22:41:34,784 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.2816  memory: 14.89GiB(31.34%)  tps: 2,545  tflops: 19.89  mfu: 6.38%
[rank0]:2025-10-25 22:41:34,853 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251025_2241_stage0_step300.svg
[rank1]:2025-10-25 22:41:34,859 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251025_2241_stage1_step300.svg
[rank2]:2025-10-25 22:41:34,852 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251025_2241_stage2_step300.svg
[rank3]:2025-10-25 22:41:35,013 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/pipeline_schedule/251025_2241_real_step300_rank3.svg
[rank3]:> Batch Time: 1495.84 ms, GPU Bubble Ratio: 45.63%, 39.06%, 54.37%, 19.46%
[rank3]:2025-10-25 22:41:35,076 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251025_2241_stage3_step300.svg
[rank3]:2025-10-25 22:41:36,396 - INFO - Avg. fwd time: 70.3843 / Avg. bwd time: 99.7780 / Avg. batch time: 1419.1682 (ms) / GPU bubble ratio: 4.08%
[rank2]:2025-10-25 22:41:36,451 - INFO - Avg. fwd time: 35.8215 / Avg. bwd time: 51.7416 / Avg. batch time: 1509.5103 (ms) / GPU bubble ratio: 53.59%
[rank1]:2025-10-25 22:41:36,530 - INFO - Avg. fwd time: 50.8376 / Avg. bwd time: 67.5573 / Avg. batch time: 1626.2107 (ms) / GPU bubble ratio: 41.76%
[rank0]:2025-10-25 22:41:36,586 - INFO - Avg. fwd time: 40.4807 / Avg. bwd time: 51.7226 / Avg. batch time: 1723.9872 (ms) / GPU bubble ratio: 57.21%
[rank3]:2025-10-25 22:43:43,943 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/pipeline_schedule_adjustment/251025_2243_rank3_trend_line.svg
[rank2]:2025-10-25 22:43:43,953 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/pipeline_schedule_adjustment/251025_2243_rank2_trend_line.svg
[rank2]:2025-10-25 22:43:43,988 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank2]:2025-10-25 22:43:43,989 - INFO -  step: 320  loss: -4.0000  grad_norm:  0.2934  memory:  7.25GiB(15.26%)  tps: 2,536  tflops: 19.82  mfu: 6.35%
[rank0]:2025-10-25 22:43:43,982 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/pipeline_schedule_adjustment/251025_2243_rank0_trend_line.svg
[rank0]:2025-10-25 22:43:43,988 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank0]:2025-10-25 22:43:43,989 - INFO -  step: 320  loss: -4.0000  grad_norm:  0.2934  memory: 14.89GiB(31.34%)  tps: 2,536  tflops: 19.83  mfu: 6.35%
[rank1]:2025-10-25 22:43:43,972 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/pipeline_schedule_adjustment/251025_2243_rank1_trend_line.svg
[rank1]:2025-10-25 22:43:43,989 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank1]:2025-10-25 22:43:43,991 - INFO -  step: 320  loss: -4.0000  grad_norm:  0.2934  memory: 10.75GiB(22.62%)  tps: 2,536  tflops: 19.82  mfu: 6.35%
[rank3]:2025-10-25 22:43:44,229 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/pipeline_schedule/251025_2243_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 1473.12 ms, GPU Bubble Ratio: 53.01%, 36.21%, 53.23%, 18.69%
[rank3]:2025-10-25 22:43:44,229 - INFO - 	> Batch Time: 1473.12 ms (Average Freeze Ratio: 0.25)
[rank3]:2025-10-25 22:43:44,230 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-25 22:43:44,233 - INFO -  step: 320  loss:  1.0568  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,531  tflops: 19.78  mfu: 6.34%
[rank3]:2025-10-25 22:43:45,544 - INFO - Avg. fwd time: 70.4063 / Avg. bwd time: 98.4751 / Avg. batch time: 1408.8455 (ms) / GPU bubble ratio: 4.10%
[rank2]:2025-10-25 22:43:45,604 - INFO - Avg. fwd time: 35.8453 / Avg. bwd time: 51.6372 / Avg. batch time: 1499.1933 (ms) / GPU bubble ratio: 53.32%
[rank0]:2025-10-25 22:43:45,741 - INFO - Avg. fwd time: 40.4128 / Avg. bwd time: 50.3607 / Avg. batch time: 1713.1793 (ms) / GPU bubble ratio: 57.61%
[rank1]:2025-10-25 22:43:45,677 - INFO - Avg. fwd time: 50.8273 / Avg. bwd time: 67.3442 / Avg. batch time: 1615.7315 (ms) / GPU bubble ratio: 41.49%
[rank3]:2025-10-25 22:44:42,929 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 22:44:43,799 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 22:44:43,868 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 22:44:43,929 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 22:45:55,520 - INFO -  step: 340  loss: -4.0000  grad_norm:  0.4528  memory: 10.75GiB(22.62%)  tps: 2,491  tflops: 19.48  mfu: 6.24%
[rank3]:2025-10-25 22:45:55,504 - INFO -  step: 340  loss:  1.0256  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,496  tflops: 19.51  mfu: 6.25%
[rank2]:2025-10-25 22:45:55,517 - INFO -  step: 340  loss: -4.0000  grad_norm:  0.4528  memory:  7.25GiB(15.26%)  tps: 2,491  tflops: 19.48  mfu: 6.24%
[rank0]:2025-10-25 22:45:55,536 - INFO -  step: 340  loss: -4.0000  grad_norm:  0.4528  memory: 14.89GiB(31.34%)  tps: 2,491  tflops: 19.47  mfu: 6.24%
[rank3]:2025-10-25 22:45:56,967 - INFO - Avg. fwd time: 70.3881 / Avg. bwd time: 97.2939 / Avg. batch time: 1399.2135 (ms) / GPU bubble ratio: 4.13%
[rank2]:2025-10-25 22:45:57,029 - INFO - Avg. fwd time: 35.8832 / Avg. bwd time: 52.0260 / Avg. batch time: 1489.6087 (ms) / GPU bubble ratio: 52.79%
[rank1]:2025-10-25 22:45:57,102 - INFO - Avg. fwd time: 51.0396 / Avg. bwd time: 68.6364 / Avg. batch time: 1606.4902 (ms) / GPU bubble ratio: 40.40%
[rank0]:2025-10-25 22:45:57,171 - INFO - Avg. fwd time: 40.4692 / Avg. bwd time: 51.1039 / Avg. batch time: 1704.0616 (ms) / GPU bubble ratio: 57.01%
[rank0]:2025-10-25 22:46:54,056 - INFO - [GC] Peforming periodical GC collection 0.04 seconds
[rank3]:2025-10-25 22:48:05,390 - INFO -  step: 360  loss:  1.0740  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,523  tflops: 19.72  mfu: 6.32%
[rank2]:2025-10-25 22:48:05,401 - INFO -  step: 360  loss: -4.0000  grad_norm:  0.4968  memory:  7.25GiB(15.26%)  tps: 2,523  tflops: 19.72  mfu: 6.32%
[rank0]:2025-10-25 22:48:05,420 - INFO -  step: 360  loss: -4.0000  grad_norm:  0.4968  memory: 14.89GiB(31.34%)  tps: 2,523  tflops: 19.72  mfu: 6.32%
[rank1]:2025-10-25 22:48:05,405 - INFO -  step: 360  loss: -4.0000  grad_norm:  0.4968  memory: 10.75GiB(22.62%)  tps: 2,523  tflops: 19.72  mfu: 6.32%
[rank3]:2025-10-25 22:48:06,806 - INFO - Avg. fwd time: 70.3800 / Avg. bwd time: 96.2498 / Avg. batch time: 1390.7680 (ms) / GPU bubble ratio: 4.15%
[rank2]:2025-10-25 22:48:06,864 - INFO - Avg. fwd time: 35.9247 / Avg. bwd time: 52.3889 / Avg. batch time: 1481.2409 (ms) / GPU bubble ratio: 52.30%
[rank1]:2025-10-25 22:48:06,951 - INFO - Avg. fwd time: 51.2118 / Avg. bwd time: 69.7259 / Avg. batch time: 1598.4094 (ms) / GPU bubble ratio: 39.47%
[rank0]:2025-10-25 22:48:07,014 - INFO - Avg. fwd time: 40.5279 / Avg. bwd time: 51.7610 / Avg. batch time: 1696.1020 (ms) / GPU bubble ratio: 56.47%
[rank2]:2025-10-25 22:50:15,068 - INFO -  step: 380  loss: -4.0000  grad_norm:  0.4239  memory:  7.25GiB(15.26%)  tps: 2,527  tflops: 19.76  mfu: 6.33%
[rank0]:2025-10-25 22:50:15,091 - INFO -  step: 380  loss: -4.0000  grad_norm:  0.4239  memory: 14.89GiB(31.34%)  tps: 2,527  tflops: 19.76  mfu: 6.33%
[rank3]:2025-10-25 22:50:15,056 - INFO -  step: 380  loss:  1.0099  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,527  tflops: 19.76  mfu: 6.33%
[rank1]:2025-10-25 22:50:15,071 - INFO -  step: 380  loss: -4.0000  grad_norm:  0.4239  memory: 10.75GiB(22.62%)  tps: 2,527  tflops: 19.76  mfu: 6.33%
[rank3]:2025-10-25 22:50:16,522 - INFO - Avg. fwd time: 70.3689 / Avg. bwd time: 95.3042 / Avg. batch time: 1383.0844 (ms) / GPU bubble ratio: 4.17%
[rank2]:2025-10-25 22:50:16,588 - INFO - Avg. fwd time: 35.9541 / Avg. bwd time: 52.6914 / Avg. batch time: 1473.6290 (ms) / GPU bubble ratio: 51.88%
[rank1]:2025-10-25 22:50:16,660 - INFO - Avg. fwd time: 51.3945 / Avg. bwd time: 70.7684 / Avg. batch time: 1591.0864 (ms) / GPU bubble ratio: 38.58%
[rank0]:2025-10-25 22:50:16,731 - INFO - Avg. fwd time: 40.5887 / Avg. bwd time: 52.3664 / Avg. batch time: 1688.9198 (ms) / GPU bubble ratio: 55.97%
[rank0]:2025-10-25 22:52:18,228 - INFO - [GC] Peforming periodical GC collection 0.03 seconds
[rank3]:2025-10-25 22:52:24,705 - INFO -  step: 400  loss:  0.9829  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,527  tflops: 19.76  mfu: 6.33%
[rank2]:2025-10-25 22:52:24,717 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.4499  memory:  7.25GiB(15.26%)  tps: 2,527  tflops: 19.76  mfu: 6.33%
[rank1]:2025-10-25 22:52:24,720 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.4499  memory: 10.75GiB(22.62%)  tps: 2,527  tflops: 19.76  mfu: 6.33%
[rank1]:2025-10-25 22:52:24,810 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251025_2252_stage1_step400.svg
[rank0]:2025-10-25 22:52:24,737 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.4499  memory: 14.89GiB(31.34%)  tps: 2,528  tflops: 19.76  mfu: 6.33%
[rank0]:2025-10-25 22:52:24,810 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251025_2252_stage0_step400.svg
[rank2]:2025-10-25 22:52:24,809 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251025_2252_stage2_step400.svg
[rank3]:2025-10-25 22:52:24,960 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/pipeline_schedule/251025_2252_real_step400_rank3.svg
[rank3]:> Batch Time: 1493.34 ms, GPU Bubble Ratio: 45.31%, 34.05%, 52.46%, 19.58%
[rank3]:2025-10-25 22:52:25,028 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251025_2252_stage3_step400.svg
[rank3]:2025-10-25 22:52:26,357 - INFO - Avg. fwd time: 70.3520 / Avg. bwd time: 94.4546 / Avg. batch time: 1376.1307 (ms) / GPU bubble ratio: 4.19%
[rank2]:2025-10-25 22:52:26,415 - INFO - Avg. fwd time: 35.9750 / Avg. bwd time: 52.9484 / Avg. batch time: 1466.7554 (ms) / GPU bubble ratio: 51.50%
[rank1]:2025-10-25 22:52:26,499 - INFO - Avg. fwd time: 51.5642 / Avg. bwd time: 71.6854 / Avg. batch time: 1584.5372 (ms) / GPU bubble ratio: 37.77%
[rank0]:2025-10-25 22:52:26,570 - INFO - Avg. fwd time: 40.6315 / Avg. bwd time: 52.9024 / Avg. batch time: 1682.4702 (ms) / GPU bubble ratio: 55.53%
[rank3]:2025-10-25 22:53:38,407 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 22:53:39,270 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 22:53:39,352 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 22:53:39,414 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 22:54:36,634 - INFO -  step: 420  loss: -4.0000  grad_norm:  0.4117  memory:  7.25GiB(15.26%)  tps: 2,484  tflops: 19.42  mfu: 6.22%
[rank1]:2025-10-25 22:54:36,638 - INFO -  step: 420  loss: -4.0000  grad_norm:  0.4117  memory: 10.75GiB(22.62%)  tps: 2,484  tflops: 19.42  mfu: 6.22%
[rank0]:2025-10-25 22:54:36,660 - INFO -  step: 420  loss: -4.0000  grad_norm:  0.4117  memory: 14.89GiB(31.34%)  tps: 2,484  tflops: 19.42  mfu: 6.22%
[rank3]:2025-10-25 22:54:36,622 - INFO -  step: 420  loss:  0.9512  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,484  tflops: 19.42  mfu: 6.22%
[rank3]:2025-10-25 22:54:38,093 - INFO - Avg. fwd time: 70.3360 / Avg. bwd time: 93.6892 / Avg. batch time: 1369.8523 (ms) / GPU bubble ratio: 4.21%
[rank2]:2025-10-25 22:54:38,157 - INFO - Avg. fwd time: 35.9944 / Avg. bwd time: 53.1937 / Avg. batch time: 1460.5207 (ms) / GPU bubble ratio: 51.15%
[rank1]:2025-10-25 22:54:38,230 - INFO - Avg. fwd time: 51.6964 / Avg. bwd time: 72.5006 / Avg. batch time: 1578.4719 (ms) / GPU bubble ratio: 37.05%
[rank0]:2025-10-25 22:54:38,298 - INFO - Avg. fwd time: 40.6632 / Avg. bwd time: 53.3894 / Avg. batch time: 1676.5236 (ms) / GPU bubble ratio: 55.12%
[rank3]:2025-10-25 22:56:46,058 - INFO -  step: 440  loss:  0.9939  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,532  tflops: 19.79  mfu: 6.34%
[rank2]:2025-10-25 22:56:46,070 - INFO -  step: 440  loss: -4.0000  grad_norm:  0.4208  memory:  7.25GiB(15.26%)  tps: 2,532  tflops: 19.79  mfu: 6.34%
[rank1]:2025-10-25 22:56:46,074 - INFO -  step: 440  loss: -4.0000  grad_norm:  0.4208  memory: 10.75GiB(22.62%)  tps: 2,532  tflops: 19.79  mfu: 6.34%
[rank0]:2025-10-25 22:56:46,090 - INFO -  step: 440  loss: -4.0000  grad_norm:  0.4208  memory: 14.89GiB(31.34%)  tps: 2,532  tflops: 19.79  mfu: 6.34%
[rank3]:2025-10-25 22:56:47,522 - INFO - Avg. fwd time: 70.3188 / Avg. bwd time: 92.9798 / Avg. batch time: 1364.0197 (ms) / GPU bubble ratio: 4.23%
[rank2]:2025-10-25 22:56:47,588 - INFO - Avg. fwd time: 36.0200 / Avg. bwd time: 53.4257 / Avg. batch time: 1454.7604 (ms) / GPU bubble ratio: 50.81%
[rank1]:2025-10-25 22:56:47,667 - INFO - Avg. fwd time: 51.8328 / Avg. bwd time: 73.2363 / Avg. batch time: 1572.9202 (ms) / GPU bubble ratio: 36.39%
[rank0]:2025-10-25 22:56:47,732 - INFO - Avg. fwd time: 40.7005 / Avg. bwd time: 53.8302 / Avg. batch time: 1671.0620 (ms) / GPU bubble ratio: 54.74%
[rank0]:2025-10-25 22:57:44,491 - INFO - [GC] Peforming periodical GC collection 0.03 seconds
[rank3]:2025-10-25 22:58:55,835 - INFO -  step: 460  loss:  1.0486  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,525  tflops: 19.74  mfu: 6.33%
[rank2]:2025-10-25 22:58:55,850 - INFO -  step: 460  loss: -4.0000  grad_norm:  0.4929  memory:  7.25GiB(15.26%)  tps: 2,525  tflops: 19.74  mfu: 6.33%
[rank1]:2025-10-25 22:58:55,851 - INFO -  step: 460  loss: -4.0000  grad_norm:  0.4929  memory: 10.75GiB(22.62%)  tps: 2,525  tflops: 19.74  mfu: 6.33%
[rank0]:2025-10-25 22:58:55,868 - INFO -  step: 460  loss: -4.0000  grad_norm:  0.4929  memory: 14.89GiB(31.34%)  tps: 2,525  tflops: 19.74  mfu: 6.33%
[rank3]:2025-10-25 22:58:57,303 - INFO - Avg. fwd time: 70.3126 / Avg. bwd time: 92.3482 / Avg. batch time: 1358.8965 (ms) / GPU bubble ratio: 4.24%
[rank2]:2025-10-25 22:58:57,368 - INFO - Avg. fwd time: 36.0359 / Avg. bwd time: 53.6176 / Avg. batch time: 1449.6623 (ms) / GPU bubble ratio: 50.52%
[rank1]:2025-10-25 22:58:57,441 - INFO - Avg. fwd time: 51.9468 / Avg. bwd time: 73.9026 / Avg. batch time: 1568.0289 (ms) / GPU bubble ratio: 35.79%
[rank0]:2025-10-25 22:58:57,507 - INFO - Avg. fwd time: 40.7263 / Avg. bwd time: 54.2224 / Avg. batch time: 1666.2253 (ms) / GPU bubble ratio: 54.41%
[rank3]:2025-10-25 23:01:05,314 - INFO -  step: 480  loss:  0.9883  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,531  tflops: 19.78  mfu: 6.34%
[rank2]:2025-10-25 23:01:05,326 - INFO -  step: 480  loss: -4.0000  grad_norm:  0.4688  memory:  7.25GiB(15.26%)  tps: 2,531  tflops: 19.78  mfu: 6.34%
[rank1]:2025-10-25 23:01:05,330 - INFO -  step: 480  loss: -4.0000  grad_norm:  0.4688  memory: 10.75GiB(22.62%)  tps: 2,531  tflops: 19.78  mfu: 6.34%
[rank0]:2025-10-25 23:01:05,352 - INFO -  step: 480  loss: -4.0000  grad_norm:  0.4688  memory: 14.89GiB(31.34%)  tps: 2,531  tflops: 19.78  mfu: 6.34%
[rank3]:2025-10-25 23:01:06,783 - INFO - Avg. fwd time: 70.3031 / Avg. bwd time: 91.7557 / Avg. batch time: 1354.0694 (ms) / GPU bubble ratio: 4.25%
[rank2]:2025-10-25 23:01:06,842 - INFO - Avg. fwd time: 36.0631 / Avg. bwd time: 53.8039 / Avg. batch time: 1444.8567 (ms) / GPU bubble ratio: 50.24%
[rank1]:2025-10-25 23:01:06,929 - INFO - Avg. fwd time: 52.0513 / Avg. bwd time: 74.5079 / Avg. batch time: 1563.3878 (ms) / GPU bubble ratio: 35.24%
[rank0]:2025-10-25 23:01:06,997 - INFO - Avg. fwd time: 40.7441 / Avg. bwd time: 54.5786 / Avg. batch time: 1661.6438 (ms) / GPU bubble ratio: 54.11%
[rank3]:2025-10-25 23:02:33,928 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 23:02:34,792 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 23:02:34,873 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 23:02:34,928 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 23:03:10,847 - INFO - [GC] Peforming periodical GC collection 0.03 seconds
[rank2]:2025-10-25 23:03:17,379 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.4197  memory:  7.25GiB(15.26%)  tps: 2,481  tflops: 19.40  mfu: 6.22%
[rank2]:2025-10-25 23:03:17,379 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-25 23:03:17,367 - INFO -  step: 500  loss:  0.9316  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,481  tflops: 19.40  mfu: 6.22%
[rank3]:2025-10-25 23:03:17,367 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-25 23:03:17,382 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.4197  memory: 10.75GiB(22.62%)  tps: 2,481  tflops: 19.40  mfu: 6.22%
[rank1]:2025-10-25 23:03:17,383 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-25 23:03:17,398 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.4197  memory: 14.89GiB(31.34%)  tps: 2,482  tflops: 19.40  mfu: 6.22%
[rank0]:2025-10-25 23:03:17,398 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-25 23:03:17,399 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank2]:2025-10-25 23:03:19,229 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 1.85 seconds.
[rank1]:2025-10-25 23:03:19,650 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 2.27 seconds.
[rank3]:2025-10-25 23:03:20,591 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.22 seconds.
[rank0]:2025-10-25 23:03:21,030 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-25 23:03:21,037 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.64 seconds.
[rank2]:2025-10-25 23:03:21,111 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251025_2303_stage2_step500.svg
[rank1]:2025-10-25 23:03:21,113 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251025_2303_stage1_step500.svg
[rank0]:2025-10-25 23:03:21,171 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251025_2303_stage0_step500.svg
[rank3]:2025-10-25 23:03:21,403 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/pipeline_schedule/251025_2303_real_step500_rank3.svg
[rank3]:> Batch Time: 1493.53 ms, GPU Bubble Ratio: 44.94%, 29.87%, 50.72%, 19.70%
[rank3]:2025-10-25 23:03:21,468 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251025_2303_stage3_step500.svg
[rank3]:2025-10-25 23:03:22,814 - INFO - Avg. fwd time: 70.3088 / Avg. bwd time: 91.2333 / Avg. batch time: 1349.9152 (ms) / GPU bubble ratio: 4.27%
[rank2]:2025-10-25 23:03:22,874 - INFO - Avg. fwd time: 36.0839 / Avg. bwd time: 53.9806 / Avg. batch time: 1440.7621 (ms) / GPU bubble ratio: 49.99%
[rank1]:2025-10-25 23:03:22,955 - INFO - Avg. fwd time: 52.1425 / Avg. bwd time: 75.0700 / Avg. batch time: 1559.4640 (ms) / GPU bubble ratio: 34.74%
[rank0]:2025-10-25 23:03:23,027 - INFO - Avg. fwd time: 40.7738 / Avg. bwd time: 54.9174 / Avg. batch time: 1657.9613 (ms) / GPU bubble ratio: 53.83%
[rank2]:2025-10-25 23:05:31,214 - INFO -  step: 520  loss: -4.0000  grad_norm:  0.4708  memory:  7.25GiB(15.26%)  tps: 2,448  tflops: 19.14  mfu: 6.13%
[rank1]:2025-10-25 23:05:31,217 - INFO -  step: 520  loss: -4.0000  grad_norm:  0.4708  memory: 10.75GiB(22.62%)  tps: 2,448  tflops: 19.14  mfu: 6.13%
[rank3]:2025-10-25 23:05:31,202 - INFO -  step: 520  loss:  0.9830  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,448  tflops: 19.14  mfu: 6.13%
[rank0]:2025-10-25 23:05:31,238 - INFO -  step: 520  loss: -4.0000  grad_norm:  0.4708  memory: 14.89GiB(31.34%)  tps: 2,448  tflops: 19.14  mfu: 6.13%
[rank3]:2025-10-25 23:05:32,671 - INFO - Avg. fwd time: 70.3070 / Avg. bwd time: 90.7412 / Avg. batch time: 1345.9558 (ms) / GPU bubble ratio: 4.28%
[rank2]:2025-10-25 23:05:32,735 - INFO - Avg. fwd time: 36.1060 / Avg. bwd time: 54.1394 / Avg. batch time: 1436.8441 (ms) / GPU bubble ratio: 49.75%
[rank1]:2025-10-25 23:05:32,808 - INFO - Avg. fwd time: 52.2289 / Avg. bwd time: 75.6014 / Avg. batch time: 1555.6820 (ms) / GPU bubble ratio: 34.26%
[rank0]:2025-10-25 23:05:32,873 - INFO - Avg. fwd time: 40.8032 / Avg. bwd time: 55.2291 / Avg. batch time: 1654.2274 (ms) / GPU bubble ratio: 53.56%
[rank2]:2025-10-25 23:07:41,194 - INFO -  step: 540  loss: -4.0000  grad_norm:  0.4603  memory:  7.25GiB(15.26%)  tps: 2,521  tflops: 19.71  mfu: 6.32%
[rank1]:2025-10-25 23:07:41,198 - INFO -  step: 540  loss: -4.0000  grad_norm:  0.4603  memory: 10.75GiB(22.62%)  tps: 2,521  tflops: 19.71  mfu: 6.32%
[rank3]:2025-10-25 23:07:41,182 - INFO -  step: 540  loss:  0.9599  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,521  tflops: 19.71  mfu: 6.32%
[rank0]:2025-10-25 23:07:41,212 - INFO -  step: 540  loss: -4.0000  grad_norm:  0.4603  memory: 14.89GiB(31.34%)  tps: 2,521  tflops: 19.71  mfu: 6.32%
[rank2]:2025-10-25 23:07:42,701 - INFO - Avg. fwd time: 36.1196 / Avg. bwd time: 54.2847 / Avg. batch time: 1433.2757 (ms) / GPU bubble ratio: 49.54%
[rank3]:2025-10-25 23:07:42,641 - INFO - Avg. fwd time: 70.3064 / Avg. bwd time: 90.2894 / Avg. batch time: 1342.3531 (ms) / GPU bubble ratio: 4.29%
[rank1]:2025-10-25 23:07:42,778 - INFO - Avg. fwd time: 52.3041 / Avg. bwd time: 76.0913 / Avg. batch time: 1552.2385 (ms) / GPU bubble ratio: 33.83%
[rank0]:2025-10-25 23:07:42,848 - INFO - Avg. fwd time: 40.8264 / Avg. bwd time: 55.5243 / Avg. batch time: 1650.8344 (ms) / GPU bubble ratio: 53.31%
[rank0]:2025-10-25 23:08:39,726 - INFO - [GC] Peforming periodical GC collection 0.28 seconds
[rank3]:2025-10-25 23:09:50,907 - INFO -  step: 560  loss:  0.9535  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,526  tflops: 19.75  mfu: 6.33%
[rank2]:2025-10-25 23:09:50,919 - INFO -  step: 560  loss: -4.0000  grad_norm:  0.4705  memory:  7.25GiB(15.26%)  tps: 2,526  tflops: 19.75  mfu: 6.33%
[rank0]:2025-10-25 23:09:50,934 - INFO -  step: 560  loss: -4.0000  grad_norm:  0.4705  memory: 14.89GiB(31.34%)  tps: 2,526  tflops: 19.75  mfu: 6.33%
[rank1]:2025-10-25 23:09:50,922 - INFO -  step: 560  loss: -4.0000  grad_norm:  0.4705  memory: 10.75GiB(22.62%)  tps: 2,526  tflops: 19.75  mfu: 6.33%
[rank3]:2025-10-25 23:09:52,360 - INFO - Avg. fwd time: 70.2985 / Avg. bwd time: 89.8511 / Avg. batch time: 1338.7686 (ms) / GPU bubble ratio: 4.30%
[rank2]:2025-10-25 23:09:52,421 - INFO - Avg. fwd time: 36.1375 / Avg. bwd time: 54.4302 / Avg. batch time: 1429.7008 (ms) / GPU bubble ratio: 49.32%
[rank1]:2025-10-25 23:09:52,496 - INFO - Avg. fwd time: 52.3854 / Avg. bwd time: 76.5659 / Avg. batch time: 1548.7983 (ms) / GPU bubble ratio: 33.39%
[rank0]:2025-10-25 23:09:52,568 - INFO - Avg. fwd time: 40.8530 / Avg. bwd time: 55.7884 / Avg. batch time: 1647.4234 (ms) / GPU bubble ratio: 53.07%
[rank3]:2025-10-25 23:11:34,313 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 23:11:34,348 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 23:11:34,430 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 23:11:34,491 - WARNING - Dataset alpaca is being re-looped
[rank3]:2025-10-25 23:12:02,730 - INFO -  step: 580  loss:  0.8877  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,486  tflops: 19.43  mfu: 6.23%
[rank0]:2025-10-25 23:12:02,757 - INFO -  step: 580  loss: -4.0000  grad_norm:  0.4956  memory: 14.89GiB(31.34%)  tps: 2,486  tflops: 19.43  mfu: 6.23%
[rank1]:2025-10-25 23:12:02,745 - INFO -  step: 580  loss: -4.0000  grad_norm:  0.4956  memory: 10.75GiB(22.62%)  tps: 2,486  tflops: 19.43  mfu: 6.23%
[rank2]:2025-10-25 23:12:02,742 - INFO -  step: 580  loss: -4.0000  grad_norm:  0.4956  memory:  7.25GiB(15.26%)  tps: 2,486  tflops: 19.43  mfu: 6.23%
[rank3]:2025-10-25 23:12:04,164 - INFO - Avg. fwd time: 70.2860 / Avg. bwd time: 89.4457 / Avg. batch time: 1335.4123 (ms) / GPU bubble ratio: 4.31%
[rank2]:2025-10-25 23:12:04,223 - INFO - Avg. fwd time: 36.1488 / Avg. bwd time: 54.5568 / Avg. batch time: 1426.3655 (ms) / GPU bubble ratio: 49.13%
[rank0]:2025-10-25 23:12:04,367 - INFO - Avg. fwd time: 40.8622 / Avg. bwd time: 56.0322 / Avg. batch time: 1644.3956 (ms) / GPU bubble ratio: 52.86%
[rank1]:2025-10-25 23:12:04,302 - INFO - Avg. fwd time: 52.4612 / Avg. bwd time: 76.9900 / Avg. batch time: 1545.5785 (ms) / GPU bubble ratio: 33.00%
[rank0]:2025-10-25 23:14:06,352 - INFO - [GC] Peforming periodical GC collection 0.03 seconds
[rank2]:2025-10-25 23:14:12,903 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.5005  memory:  7.25GiB(15.26%)  tps: 2,517  tflops: 19.68  mfu: 6.31%
[rank3]:2025-10-25 23:14:12,891 - INFO -  step: 600  loss:  0.9355  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,518  tflops: 19.68  mfu: 6.31%
[rank0]:2025-10-25 23:14:12,928 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.5005  memory: 14.89GiB(31.34%)  tps: 2,517  tflops: 19.68  mfu: 6.31%
[rank1]:2025-10-25 23:14:12,907 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.5005  memory: 10.75GiB(22.62%)  tps: 2,517  tflops: 19.68  mfu: 6.31%
[rank2]:2025-10-25 23:14:12,999 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251025_2314_stage2_step600.svg
[rank0]:2025-10-25 23:14:13,000 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251025_2314_stage0_step600.svg
[rank1]:2025-10-25 23:14:13,001 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251025_2314_stage1_step600.svg
[rank3]:2025-10-25 23:14:13,158 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/pipeline_schedule/251025_2314_real_step600_rank3.svg
[rank3]:> Batch Time: 1493.88 ms, GPU Bubble Ratio: 44.73%, 27.37%, 50.47%, 19.79%
[rank3]:2025-10-25 23:14:13,221 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251025_2314_stage3_step600.svg
[rank3]:2025-10-25 23:14:14,523 - INFO - Avg. fwd time: 70.2915 / Avg. bwd time: 89.0819 / Avg. batch time: 1332.5391 (ms) / GPU bubble ratio: 4.32%
[rank2]:2025-10-25 23:14:14,583 - INFO - Avg. fwd time: 36.1624 / Avg. bwd time: 54.6776 / Avg. batch time: 1423.5848 (ms) / GPU bubble ratio: 48.95%
[rank1]:2025-10-25 23:14:14,668 - INFO - Avg. fwd time: 52.5249 / Avg. bwd time: 77.3848 / Avg. batch time: 1542.9112 (ms) / GPU bubble ratio: 32.64%
[rank0]:2025-10-25 23:14:14,733 - INFO - Avg. fwd time: 40.8879 / Avg. bwd time: 56.2689 / Avg. batch time: 1641.7771 (ms) / GPU bubble ratio: 52.66%
[rank2]:2025-10-25 23:16:23,368 - INFO -  step: 620  loss: -4.0000  grad_norm:  0.4972  memory:  7.25GiB(15.26%)  tps: 2,512  tflops: 19.63  mfu: 6.29%
[rank3]:2025-10-25 23:16:23,357 - INFO -  step: 620  loss:  0.9351  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,512  tflops: 19.64  mfu: 6.29%
[rank0]:2025-10-25 23:16:23,387 - INFO -  step: 620  loss: -4.0000  grad_norm:  0.4972  memory: 14.89GiB(31.34%)  tps: 2,512  tflops: 19.64  mfu: 6.29%
[rank1]:2025-10-25 23:16:23,372 - INFO -  step: 620  loss: -4.0000  grad_norm:  0.4972  memory: 10.75GiB(22.62%)  tps: 2,512  tflops: 19.63  mfu: 6.29%
[rank2]:2025-10-25 23:16:24,883 - INFO - Avg. fwd time: 36.1748 / Avg. bwd time: 54.7954 / Avg. batch time: 1420.9876 (ms) / GPU bubble ratio: 48.78%
[rank3]:2025-10-25 23:16:24,824 - INFO - Avg. fwd time: 70.2984 / Avg. bwd time: 88.7467 / Avg. batch time: 1329.8985 (ms) / GPU bubble ratio: 4.33%
[rank1]:2025-10-25 23:16:24,968 - INFO - Avg. fwd time: 52.5930 / Avg. bwd time: 77.7654 / Avg. batch time: 1540.4458 (ms) / GPU bubble ratio: 32.30%
[rank0]:2025-10-25 23:16:25,033 - INFO - Avg. fwd time: 40.9165 / Avg. bwd time: 56.5029 / Avg. batch time: 1639.3523 (ms) / GPU bubble ratio: 52.46%
[rank3]:2025-10-25 23:18:33,165 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/pipeline_schedule_adjustment/251025_2318_rank3_trend_line.svg
[rank1]:2025-10-25 23:18:33,182 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/pipeline_schedule_adjustment/251025_2318_rank1_trend_line.svg
[rank2]:2025-10-25 23:18:33,178 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/pipeline_schedule_adjustment/251025_2318_rank2_trend_line.svg
[rank2]:2025-10-25 23:18:33,251 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-25 23:18:33,253 - INFO -  step: 640  loss: -4.0000  grad_norm:  0.5049  memory:  7.25GiB(15.26%)  tps: 2,523  tflops: 19.72  mfu: 6.32%
[rank0]:2025-10-25 23:18:33,245 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/pipeline_schedule_adjustment/251025_2318_rank0_trend_line.svg
[rank0]:2025-10-25 23:18:33,251 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-25 23:18:33,253 - INFO -  step: 640  loss: -4.0000  grad_norm:  0.5049  memory: 14.89GiB(31.34%)  tps: 2,523  tflops: 19.73  mfu: 6.32%
[rank1]:2025-10-25 23:18:33,251 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-10-25 23:18:33,253 - INFO -  step: 640  loss: -4.0000  grad_norm:  0.5049  memory: 10.75GiB(22.62%)  tps: 2,523  tflops: 19.72  mfu: 6.32%
[rank3]:2025-10-25 23:18:33,474 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/pipeline_schedule/251025_2318_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 1481.31 ms, GPU Bubble Ratio: 47.67%, 29.71%, 51.27%, 19.27%
[rank3]:2025-10-25 23:18:33,474 - INFO - 	> Batch Time: 1481.31 ms (Average Freeze Ratio: 0.34)
[rank3]:2025-10-25 23:18:33,475 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-25 23:18:33,479 - INFO -  step: 640  loss:  0.8867  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,518  tflops: 19.69  mfu: 6.31%
[rank3]:2025-10-25 23:18:34,761 - INFO - Avg. fwd time: 70.2900 / Avg. bwd time: 88.4152 / Avg. batch time: 1327.1665 (ms) / GPU bubble ratio: 4.33%
[rank2]:2025-10-25 23:18:34,817 - INFO - Avg. fwd time: 36.1852 / Avg. bwd time: 54.8985 / Avg. batch time: 1418.3006 (ms) / GPU bubble ratio: 48.62%
[rank1]:2025-10-25 23:18:34,886 - INFO - Avg. fwd time: 52.6600 / Avg. bwd time: 78.1198 / Avg. batch time: 1537.8871 (ms) / GPU bubble ratio: 31.97%
[rank0]:2025-10-25 23:18:34,950 - INFO - Avg. fwd time: 40.9389 / Avg. bwd time: 56.7086 / Avg. batch time: 1636.8091 (ms) / GPU bubble ratio: 52.27%
[rank0]:2025-10-25 23:19:31,310 - INFO - [GC] Peforming periodical GC collection 0.04 seconds
[rank3]:2025-10-25 23:20:31,387 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 23:20:32,252 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 23:20:32,318 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 23:20:32,377 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 23:20:44,204 - INFO -  step: 660  loss: -4.0000  grad_norm:  0.3401  memory:  7.25GiB(15.26%)  tps: 2,502  tflops: 19.56  mfu: 6.27%
[rank3]:2025-10-25 23:20:44,192 - INFO -  step: 660  loss:  0.8548  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,507  tflops: 19.60  mfu: 6.28%
[rank0]:2025-10-25 23:20:44,225 - INFO -  step: 660  loss: -4.0000  grad_norm:  0.3401  memory: 14.89GiB(31.34%)  tps: 2,502  tflops: 19.56  mfu: 6.27%
[rank1]:2025-10-25 23:20:44,209 - INFO -  step: 660  loss: -4.0000  grad_norm:  0.3401  memory: 10.75GiB(22.62%)  tps: 2,502  tflops: 19.56  mfu: 6.27%
[rank3]:2025-10-25 23:20:45,643 - INFO - Avg. fwd time: 70.2927 / Avg. bwd time: 88.1207 / Avg. batch time: 1324.8095 (ms) / GPU bubble ratio: 4.34%
[rank2]:2025-10-25 23:20:45,703 - INFO - Avg. fwd time: 36.1780 / Avg. bwd time: 54.7440 / Avg. batch time: 1415.8594 (ms) / GPU bubble ratio: 48.63%
[rank1]:2025-10-25 23:20:45,776 - INFO - Avg. fwd time: 52.6031 / Avg. bwd time: 77.6961 / Avg. batch time: 1535.4397 (ms) / GPU bubble ratio: 32.11%
[rank0]:2025-10-25 23:20:45,834 - INFO - Avg. fwd time: 40.8845 / Avg. bwd time: 55.8987 / Avg. batch time: 1634.1778 (ms) / GPU bubble ratio: 52.62%
[rank3]:2025-10-25 23:22:53,041 - INFO -  step: 680  loss:  0.8956  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,543  tflops: 19.88  mfu: 6.37%
[rank1]:2025-10-25 23:22:53,057 - INFO -  step: 680  loss: -4.0000  grad_norm:  0.3664  memory: 10.75GiB(22.62%)  tps: 2,543  tflops: 19.88  mfu: 6.37%
[rank2]:2025-10-25 23:22:53,054 - INFO -  step: 680  loss: -4.0000  grad_norm:  0.3664  memory:  7.25GiB(15.26%)  tps: 2,543  tflops: 19.88  mfu: 6.37%
[rank0]:2025-10-25 23:22:53,071 - INFO -  step: 680  loss: -4.0000  grad_norm:  0.3664  memory: 14.89GiB(31.34%)  tps: 2,543  tflops: 19.88  mfu: 6.37%
[rank3]:2025-10-25 23:22:54,504 - INFO - Avg. fwd time: 70.3030 / Avg. bwd time: 87.8444 / Avg. batch time: 1322.6590 (ms) / GPU bubble ratio: 4.35%
[rank2]:2025-10-25 23:22:54,565 - INFO - Avg. fwd time: 36.1739 / Avg. bwd time: 54.6072 / Avg. batch time: 1413.6394 (ms) / GPU bubble ratio: 48.63%
[rank1]:2025-10-25 23:22:54,636 - INFO - Avg. fwd time: 52.5553 / Avg. bwd time: 77.2934 / Avg. batch time: 1533.1038 (ms) / GPU bubble ratio: 32.24%
[rank0]:2025-10-25 23:22:54,694 - INFO - Avg. fwd time: 40.8390 / Avg. bwd time: 55.1295 / Avg. batch time: 1631.6572 (ms) / GPU bubble ratio: 52.95%
[rank0]:2025-10-25 23:24:55,760 - INFO - [GC] Peforming periodical GC collection 0.03 seconds
[rank3]:2025-10-25 23:25:02,196 - INFO -  step: 700  loss:  0.8919  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,537  tflops: 19.83  mfu: 6.36%
[rank1]:2025-10-25 23:25:02,212 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.3588  memory: 10.75GiB(22.62%)  tps: 2,537  tflops: 19.83  mfu: 6.36%
[rank2]:2025-10-25 23:25:02,208 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.3588  memory:  7.25GiB(15.26%)  tps: 2,537  tflops: 19.83  mfu: 6.36%
[rank0]:2025-10-25 23:25:02,229 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.3588  memory: 14.89GiB(31.34%)  tps: 2,537  tflops: 19.83  mfu: 6.36%
[rank0]:2025-10-25 23:25:02,304 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251025_2325_stage0_step700.svg
[rank1]:2025-10-25 23:25:02,304 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251025_2325_stage1_step700.svg
[rank2]:2025-10-25 23:25:02,303 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251025_2325_stage2_step700.svg
[rank3]:2025-10-25 23:25:02,455 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/pipeline_schedule/251025_2325_real_step700_rank3.svg
[rank3]:> Batch Time: 1493.22 ms, GPU Bubble Ratio: 44.93%, 27.66%, 50.47%, 19.76%
[rank3]:2025-10-25 23:25:02,518 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251025_2325_stage3_step700.svg
[rank3]:2025-10-25 23:25:03,849 - INFO - Avg. fwd time: 70.3158 / Avg. bwd time: 87.5900 / Avg. batch time: 1320.7073 (ms) / GPU bubble ratio: 4.35%
[rank2]:2025-10-25 23:25:03,905 - INFO - Avg. fwd time: 36.1687 / Avg. bwd time: 54.4729 / Avg. batch time: 1411.6408 (ms) / GPU bubble ratio: 48.63%
[rank1]:2025-10-25 23:25:03,975 - INFO - Avg. fwd time: 52.5080 / Avg. bwd time: 76.9252 / Avg. batch time: 1531.0343 (ms) / GPU bubble ratio: 32.37%
[rank0]:2025-10-25 23:25:04,042 - INFO - Avg. fwd time: 40.7925 / Avg. bwd time: 54.4057 / Avg. batch time: 1629.4086 (ms) / GPU bubble ratio: 53.26%
[rank2]:2025-10-25 23:27:11,332 - INFO -  step: 720  loss: -4.0000  grad_norm:  0.3595  memory:  7.25GiB(15.26%)  tps: 2,538  tflops: 19.84  mfu: 6.36%
[rank0]:2025-10-25 23:27:11,359 - INFO -  step: 720  loss: -4.0000  grad_norm:  0.3595  memory: 14.89GiB(31.34%)  tps: 2,538  tflops: 19.84  mfu: 6.36%
[rank3]:2025-10-25 23:27:11,320 - INFO -  step: 720  loss:  0.8559  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,538  tflops: 19.84  mfu: 6.36%
[rank1]:2025-10-25 23:27:11,338 - INFO -  step: 720  loss: -4.0000  grad_norm:  0.3595  memory: 10.75GiB(22.62%)  tps: 2,538  tflops: 19.84  mfu: 6.36%
[rank3]:2025-10-25 23:27:12,783 - INFO - Avg. fwd time: 70.3249 / Avg. bwd time: 87.3461 / Avg. batch time: 1318.8111 (ms) / GPU bubble ratio: 4.36%
[rank2]:2025-10-25 23:27:12,844 - INFO - Avg. fwd time: 36.1644 / Avg. bwd time: 54.3482 / Avg. batch time: 1409.6556 (ms) / GPU bubble ratio: 48.63%
[rank1]:2025-10-25 23:27:12,922 - INFO - Avg. fwd time: 52.4559 / Avg. bwd time: 76.5635 / Avg. batch time: 1528.9881 (ms) / GPU bubble ratio: 32.49%
[rank0]:2025-10-25 23:27:12,985 - INFO - Avg. fwd time: 40.7381 / Avg. bwd time: 53.7228 / Avg. batch time: 1627.1889 (ms) / GPU bubble ratio: 53.56%
[rank3]:2025-10-25 23:29:20,241 - INFO -  step: 740  loss:  0.8560  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,542  tflops: 19.87  mfu: 6.37%
[rank1]:2025-10-25 23:29:20,257 - INFO -  step: 740  loss: -4.0000  grad_norm:  0.3628  memory: 10.75GiB(22.62%)  tps: 2,542  tflops: 19.87  mfu: 6.37%
[rank2]:2025-10-25 23:29:20,253 - INFO -  step: 740  loss: -4.0000  grad_norm:  0.3628  memory:  7.25GiB(15.26%)  tps: 2,542  tflops: 19.87  mfu: 6.37%
[rank0]:2025-10-25 23:29:20,268 - INFO -  step: 740  loss: -4.0000  grad_norm:  0.3628  memory: 14.89GiB(31.34%)  tps: 2,542  tflops: 19.87  mfu: 6.37%
[rank3]:2025-10-25 23:29:21,701 - INFO - Avg. fwd time: 70.3350 / Avg. bwd time: 87.1168 / Avg. batch time: 1317.0367 (ms) / GPU bubble ratio: 4.36%
[rank2]:2025-10-25 23:29:21,758 - INFO - Avg. fwd time: 36.1561 / Avg. bwd time: 54.2302 / Avg. batch time: 1407.7962 (ms) / GPU bubble ratio: 48.64%
[rank1]:2025-10-25 23:29:21,844 - INFO - Avg. fwd time: 52.4095 / Avg. bwd time: 76.2348 / Avg. batch time: 1527.0411 (ms) / GPU bubble ratio: 32.60%
[rank0]:2025-10-25 23:29:21,905 - INFO - Avg. fwd time: 40.6899 / Avg. bwd time: 53.0752 / Avg. batch time: 1625.0737 (ms) / GPU bubble ratio: 53.84%
[rank3]:2025-10-25 23:29:24,164 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 23:29:25,030 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 23:29:25,161 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 23:29:25,110 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 23:30:20,776 - INFO - [GC] Peforming periodical GC collection 0.04 seconds
[rank2]:2025-10-25 23:31:31,671 - INFO -  step: 760  loss: -4.0000  grad_norm:  0.3604  memory:  7.25GiB(15.26%)  tps: 2,493  tflops: 19.49  mfu: 6.25%
[rank0]:2025-10-25 23:31:31,695 - INFO -  step: 760  loss: -4.0000  grad_norm:  0.3604  memory: 14.89GiB(31.34%)  tps: 2,493  tflops: 19.49  mfu: 6.25%
[rank3]:2025-10-25 23:31:31,660 - INFO -  step: 760  loss:  0.8780  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,493  tflops: 19.49  mfu: 6.25%
[rank1]:2025-10-25 23:31:31,676 - INFO -  step: 760  loss: -4.0000  grad_norm:  0.3604  memory: 10.75GiB(22.62%)  tps: 2,493  tflops: 19.49  mfu: 6.25%
[rank3]:2025-10-25 23:31:33,127 - INFO - Avg. fwd time: 70.3450 / Avg. bwd time: 86.8972 / Avg. batch time: 1315.3416 (ms) / GPU bubble ratio: 4.36%
[rank1]:2025-10-25 23:31:33,258 - INFO - Avg. fwd time: 52.3523 / Avg. bwd time: 75.9044 / Avg. batch time: 1525.1764 (ms) / GPU bubble ratio: 32.73%
[rank2]:2025-10-25 23:31:33,187 - INFO - Avg. fwd time: 36.1496 / Avg. bwd time: 54.1194 / Avg. batch time: 1406.0389 (ms) / GPU bubble ratio: 48.64%
[rank0]:2025-10-25 23:31:33,322 - INFO - Avg. fwd time: 40.6443 / Avg. bwd time: 52.4591 / Avg. batch time: 1623.0560 (ms) / GPU bubble ratio: 54.11%
[rank0]:2025-10-25 23:33:40,699 - INFO -  step: 780  loss: -4.0000  grad_norm:  0.3536  memory: 14.89GiB(31.34%)  tps: 2,540  tflops: 19.86  mfu: 6.36%
[rank3]:2025-10-25 23:33:40,666 - INFO -  step: 780  loss:  0.8638  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,540  tflops: 19.86  mfu: 6.36%
[rank1]:2025-10-25 23:33:40,683 - INFO -  step: 780  loss: -4.0000  grad_norm:  0.3536  memory: 10.75GiB(22.62%)  tps: 2,540  tflops: 19.86  mfu: 6.36%
[rank2]:2025-10-25 23:33:40,678 - INFO -  step: 780  loss: -4.0000  grad_norm:  0.3536  memory:  7.25GiB(15.26%)  tps: 2,540  tflops: 19.86  mfu: 6.36%
[rank3]:2025-10-25 23:33:42,126 - INFO - Avg. fwd time: 70.3529 / Avg. bwd time: 86.6894 / Avg. batch time: 1313.7266 (ms) / GPU bubble ratio: 4.37%
[rank2]:2025-10-25 23:33:42,183 - INFO - Avg. fwd time: 36.1456 / Avg. bwd time: 54.0159 / Avg. batch time: 1404.3769 (ms) / GPU bubble ratio: 48.64%
[rank1]:2025-10-25 23:33:42,256 - INFO - Avg. fwd time: 52.3221 / Avg. bwd time: 75.6132 / Avg. batch time: 1523.4544 (ms) / GPU bubble ratio: 32.82%
[rank0]:2025-10-25 23:33:42,314 - INFO - Avg. fwd time: 40.6047 / Avg. bwd time: 51.8738 / Avg. batch time: 1621.1822 (ms) / GPU bubble ratio: 54.36%
[rank0]:2025-10-25 23:35:43,165 - INFO - [GC] Peforming periodical GC collection 0.03 seconds
[rank2]:2025-10-25 23:35:49,613 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.3768  memory:  7.25GiB(15.26%)  tps: 2,541  tflops: 19.87  mfu: 6.37%
[rank0]:2025-10-25 23:35:49,636 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.3768  memory: 14.89GiB(31.34%)  tps: 2,541  tflops: 19.87  mfu: 6.37%
[rank3]:2025-10-25 23:35:49,601 - INFO -  step: 800  loss:  0.8147  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,541  tflops: 19.87  mfu: 6.37%
[rank2]:2025-10-25 23:35:49,713 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251025_2335_stage2_step800.svg
[rank1]:2025-10-25 23:35:49,623 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.3768  memory: 10.75GiB(22.62%)  tps: 2,541  tflops: 19.87  mfu: 6.37%
[rank1]:2025-10-25 23:35:49,715 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251025_2335_stage1_step800.svg
[rank0]:2025-10-25 23:35:49,714 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251025_2335_stage0_step800.svg
[rank3]:2025-10-25 23:35:49,866 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/pipeline_schedule/251025_2335_real_step800_rank3.svg
[rank3]:> Batch Time: 1492.66 ms, GPU Bubble Ratio: 45.43%, 29.43%, 50.76%, 19.69%
[rank3]:2025-10-25 23:35:49,933 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251025_2335_stage3_step800.svg
[rank3]:2025-10-25 23:35:51,241 - INFO - Avg. fwd time: 70.3605 / Avg. bwd time: 86.4895 / Avg. batch time: 1312.1733 (ms) / GPU bubble ratio: 4.37%
[rank2]:2025-10-25 23:35:51,303 - INFO - Avg. fwd time: 36.1418 / Avg. bwd time: 53.9177 / Avg. batch time: 1402.8067 (ms) / GPU bubble ratio: 48.64%
[rank1]:2025-10-25 23:35:51,383 - INFO - Avg. fwd time: 52.2905 / Avg. bwd time: 75.3291 / Avg. batch time: 1521.8210 (ms) / GPU bubble ratio: 32.91%
[rank0]:2025-10-25 23:35:51,444 - INFO - Avg. fwd time: 40.5724 / Avg. bwd time: 51.3201 / Avg. batch time: 1619.4117 (ms) / GPU bubble ratio: 54.60%
[rank2]:2025-10-25 23:37:58,479 - INFO -  step: 820  loss: -4.0000  grad_norm:  0.3904  memory:  7.25GiB(15.26%)  tps: 2,543  tflops: 19.88  mfu: 6.37%
[rank1]:2025-10-25 23:37:58,485 - INFO -  step: 820  loss: -4.0000  grad_norm:  0.3904  memory: 10.75GiB(22.62%)  tps: 2,543  tflops: 19.88  mfu: 6.37%
[rank0]:2025-10-25 23:37:58,501 - INFO -  step: 820  loss: -4.0000  grad_norm:  0.3904  memory: 14.89GiB(31.34%)  tps: 2,543  tflops: 19.88  mfu: 6.37%
[rank3]:2025-10-25 23:37:58,468 - INFO -  step: 820  loss:  0.8534  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,543  tflops: 19.88  mfu: 6.37%
[rank3]:2025-10-25 23:37:59,920 - INFO - Avg. fwd time: 70.3656 / Avg. bwd time: 86.2983 / Avg. batch time: 1310.6684 (ms) / GPU bubble ratio: 4.38%
[rank2]:2025-10-25 23:37:59,984 - INFO - Avg. fwd time: 36.1372 / Avg. bwd time: 53.8198 / Avg. batch time: 1401.2381 (ms) / GPU bubble ratio: 48.64%
[rank1]:2025-10-25 23:38:00,058 - INFO - Avg. fwd time: 52.2548 / Avg. bwd time: 75.0539 / Avg. batch time: 1520.1767 (ms) / GPU bubble ratio: 33.00%
[rank0]:2025-10-25 23:38:00,117 - INFO - Avg. fwd time: 40.5365 / Avg. bwd time: 50.7947 / Avg. batch time: 1617.6344 (ms) / GPU bubble ratio: 54.83%
[rank3]:2025-10-25 23:38:17,657 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 23:38:17,686 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 23:38:17,759 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 23:38:17,810 - WARNING - Dataset alpaca is being re-looped
[rank3]:2025-10-25 23:40:09,723 - INFO -  step: 840  loss:  0.8122  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,497  tflops: 19.52  mfu: 6.26%
[rank2]:2025-10-25 23:40:09,735 - INFO -  step: 840  loss: -4.0000  grad_norm:  0.3890  memory:  7.25GiB(15.26%)  tps: 2,497  tflops: 19.52  mfu: 6.26%
[rank1]:2025-10-25 23:40:09,742 - INFO -  step: 840  loss: -4.0000  grad_norm:  0.3890  memory: 10.75GiB(22.62%)  tps: 2,496  tflops: 19.52  mfu: 6.26%
[rank0]:2025-10-25 23:40:09,757 - INFO -  step: 840  loss: -4.0000  grad_norm:  0.3890  memory: 14.89GiB(31.34%)  tps: 2,496  tflops: 19.52  mfu: 6.26%
[rank3]:2025-10-25 23:40:11,163 - INFO - Avg. fwd time: 70.3693 / Avg. bwd time: 86.1205 / Avg. batch time: 1309.2597 (ms) / GPU bubble ratio: 4.38%
[rank2]:2025-10-25 23:40:11,224 - INFO - Avg. fwd time: 36.1326 / Avg. bwd time: 53.7280 / Avg. batch time: 1399.7559 (ms) / GPU bubble ratio: 48.64%
[rank1]:2025-10-25 23:40:11,295 - INFO - Avg. fwd time: 52.2202 / Avg. bwd time: 74.7943 / Avg. batch time: 1518.6206 (ms) / GPU bubble ratio: 33.09%
[rank0]:2025-10-25 23:40:11,356 - INFO - Avg. fwd time: 40.5034 / Avg. bwd time: 50.2968 / Avg. batch time: 1615.9593 (ms) / GPU bubble ratio: 55.05%
[rank0]:2025-10-25 23:41:07,779 - INFO - [GC] Peforming periodical GC collection 0.04 seconds
[rank3]:2025-10-25 23:42:18,738 - INFO -  step: 860  loss:  0.8362  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,540  tflops: 19.86  mfu: 6.36%
[rank0]:2025-10-25 23:42:18,771 - INFO -  step: 860  loss: -4.0000  grad_norm:  0.3468  memory: 14.89GiB(31.34%)  tps: 2,540  tflops: 19.86  mfu: 6.36%
[rank1]:2025-10-25 23:42:18,753 - INFO -  step: 860  loss: -4.0000  grad_norm:  0.3468  memory: 10.75GiB(22.62%)  tps: 2,540  tflops: 19.86  mfu: 6.36%
[rank2]:2025-10-25 23:42:18,749 - INFO -  step: 860  loss: -4.0000  grad_norm:  0.3468  memory:  7.25GiB(15.26%)  tps: 2,540  tflops: 19.86  mfu: 6.36%
[rank3]:2025-10-25 23:42:20,221 - INFO - Avg. fwd time: 70.3768 / Avg. bwd time: 85.9493 / Avg. batch time: 1307.9369 (ms) / GPU bubble ratio: 4.38%
[rank2]:2025-10-25 23:42:20,279 - INFO - Avg. fwd time: 36.1303 / Avg. bwd time: 53.6412 / Avg. batch time: 1398.3863 (ms) / GPU bubble ratio: 48.64%
[rank1]:2025-10-25 23:42:20,351 - INFO - Avg. fwd time: 52.1966 / Avg. bwd time: 74.5526 / Avg. batch time: 1517.2113 (ms) / GPU bubble ratio: 33.17%
[rank0]:2025-10-25 23:42:20,418 - INFO - Avg. fwd time: 40.4747 / Avg. bwd time: 49.8200 / Avg. batch time: 1614.4305 (ms) / GPU bubble ratio: 55.26%
[rank1]:2025-10-25 23:44:27,592 - INFO -  step: 880  loss: -4.0000  grad_norm:  0.4285  memory: 10.75GiB(22.62%)  tps: 2,543  tflops: 19.88  mfu: 6.37%
[rank2]:2025-10-25 23:44:27,588 - INFO -  step: 880  loss: -4.0000  grad_norm:  0.4285  memory:  7.25GiB(15.26%)  tps: 2,543  tflops: 19.88  mfu: 6.37%
[rank3]:2025-10-25 23:44:27,576 - INFO -  step: 880  loss:  0.8489  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,543  tflops: 19.88  mfu: 6.37%
[rank0]:2025-10-25 23:44:27,603 - INFO -  step: 880  loss: -4.0000  grad_norm:  0.4285  memory: 14.89GiB(31.34%)  tps: 2,543  tflops: 19.88  mfu: 6.37%
[rank3]:2025-10-25 23:44:29,025 - INFO - Avg. fwd time: 70.3802 / Avg. bwd time: 85.7852 / Avg. batch time: 1306.6405 (ms) / GPU bubble ratio: 4.39%
[rank2]:2025-10-25 23:44:29,088 - INFO - Avg. fwd time: 36.1259 / Avg. bwd time: 53.5570 / Avg. batch time: 1397.0408 (ms) / GPU bubble ratio: 48.64%
[rank1]:2025-10-25 23:44:29,162 - INFO - Avg. fwd time: 52.1530 / Avg. bwd time: 74.3268 / Avg. batch time: 1515.7887 (ms) / GPU bubble ratio: 33.25%
[rank0]:2025-10-25 23:44:29,226 - INFO - Avg. fwd time: 40.4491 / Avg. bwd time: 49.3680 / Avg. batch time: 1612.9124 (ms) / GPU bubble ratio: 55.45%
[rank0]:2025-10-25 23:46:29,968 - INFO - [GC] Peforming periodical GC collection 0.03 seconds
[rank3]:2025-10-25 23:46:36,390 - INFO -  step: 900  loss:  0.7851  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,544  tflops: 19.89  mfu: 6.37%
[rank0]:2025-10-25 23:46:36,417 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.3623  memory: 14.89GiB(31.34%)  tps: 2,544  tflops: 19.89  mfu: 6.37%
[rank1]:2025-10-25 23:46:36,411 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.3623  memory: 10.75GiB(22.62%)  tps: 2,544  tflops: 19.89  mfu: 6.37%
[rank2]:2025-10-25 23:46:36,402 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.3623  memory:  7.25GiB(15.26%)  tps: 2,544  tflops: 19.89  mfu: 6.37%
[rank2]:2025-10-25 23:46:36,485 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251025_2346_stage2_step900.svg
[rank0]:2025-10-25 23:46:36,487 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251025_2346_stage0_step900.svg
[rank1]:2025-10-25 23:46:36,489 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251025_2346_stage1_step900.svg
[rank3]:2025-10-25 23:46:36,649 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/pipeline_schedule/251025_2346_real_step900_rank3.svg
[rank3]:> Batch Time: 1492.12 ms, GPU Bubble Ratio: 45.96%, 33.62%, 52.96%, 19.66%
[rank3]:2025-10-25 23:46:36,708 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251025_2346_stage3_step900.svg
[rank3]:2025-10-25 23:46:38,021 - INFO - Avg. fwd time: 70.3827 / Avg. bwd time: 85.6274 / Avg. batch time: 1305.3872 (ms) / GPU bubble ratio: 4.39%
[rank2]:2025-10-25 23:46:38,084 - INFO - Avg. fwd time: 36.1175 / Avg. bwd time: 53.4645 / Avg. batch time: 1395.7621 (ms) / GPU bubble ratio: 48.65%
[rank1]:2025-10-25 23:46:38,155 - INFO - Avg. fwd time: 52.1318 / Avg. bwd time: 74.1025 / Avg. batch time: 1514.4715 (ms) / GPU bubble ratio: 33.32%
[rank0]:2025-10-25 23:46:38,221 - INFO - Avg. fwd time: 40.4155 / Avg. bwd time: 48.9344 / Avg. batch time: 1611.4829 (ms) / GPU bubble ratio: 55.64%
[rank3]:2025-10-25 23:47:10,224 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 23:47:10,277 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 23:47:10,353 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 23:47:10,404 - WARNING - Dataset alpaca is being re-looped
[rank3]:2025-10-25 23:48:47,677 - INFO -  step: 920  loss:  0.7744  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,496  tflops: 19.51  mfu: 6.25%
[rank0]:2025-10-25 23:48:47,712 - INFO -  step: 920  loss: -4.0000  grad_norm:  0.3682  memory: 14.89GiB(31.34%)  tps: 2,496  tflops: 19.51  mfu: 6.25%
[rank1]:2025-10-25 23:48:47,693 - INFO -  step: 920  loss: -4.0000  grad_norm:  0.3682  memory: 10.75GiB(22.62%)  tps: 2,496  tflops: 19.51  mfu: 6.25%
[rank2]:2025-10-25 23:48:47,689 - INFO -  step: 920  loss: -4.0000  grad_norm:  0.3682  memory:  7.25GiB(15.26%)  tps: 2,496  tflops: 19.51  mfu: 6.25%
[rank3]:2025-10-25 23:48:49,139 - INFO - Avg. fwd time: 70.3856 / Avg. bwd time: 85.4750 / Avg. batch time: 1304.1802 (ms) / GPU bubble ratio: 4.39%
[rank2]:2025-10-25 23:48:49,206 - INFO - Avg. fwd time: 36.1139 / Avg. bwd time: 53.3906 / Avg. batch time: 1394.5154 (ms) / GPU bubble ratio: 48.65%
[rank1]:2025-10-25 23:48:49,277 - INFO - Avg. fwd time: 52.1074 / Avg. bwd time: 73.8831 / Avg. batch time: 1513.1708 (ms) / GPU bubble ratio: 33.39%
[rank0]:2025-10-25 23:48:49,338 - INFO - Avg. fwd time: 40.3833 / Avg. bwd time: 48.5198 / Avg. batch time: 1610.1161 (ms) / GPU bubble ratio: 55.83%
[rank3]:2025-10-25 23:50:56,937 - INFO -  step: 940  loss:  0.8104  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,535  tflops: 19.82  mfu: 6.35%
[rank1]:2025-10-25 23:50:56,952 - INFO -  step: 940  loss: -4.0000  grad_norm:  0.3790  memory: 10.75GiB(22.62%)  tps: 2,535  tflops: 19.82  mfu: 6.35%
[rank0]:2025-10-25 23:50:56,966 - INFO -  step: 940  loss: -4.0000  grad_norm:  0.3790  memory: 14.89GiB(31.34%)  tps: 2,535  tflops: 19.82  mfu: 6.35%
[rank2]:2025-10-25 23:50:56,949 - INFO -  step: 940  loss: -4.0000  grad_norm:  0.3790  memory:  7.25GiB(15.26%)  tps: 2,535  tflops: 19.82  mfu: 6.35%
[rank3]:2025-10-25 23:50:58,408 - INFO - Avg. fwd time: 70.3961 / Avg. bwd time: 85.3372 / Avg. batch time: 1303.1491 (ms) / GPU bubble ratio: 4.40%
[rank2]:2025-10-25 23:50:58,471 - INFO - Avg. fwd time: 36.1124 / Avg. bwd time: 53.3225 / Avg. batch time: 1393.4621 (ms) / GPU bubble ratio: 48.65%
[rank1]:2025-10-25 23:50:58,543 - INFO - Avg. fwd time: 52.0856 / Avg. bwd time: 73.6776 / Avg. batch time: 1512.0600 (ms) / GPU bubble ratio: 33.46%
[rank0]:2025-10-25 23:50:58,602 - INFO - Avg. fwd time: 40.3594 / Avg. bwd time: 48.1220 / Avg. batch time: 1608.9116 (ms) / GPU bubble ratio: 56.00%
[rank0]:2025-10-25 23:51:55,163 - INFO - [GC] Peforming periodical GC collection 0.03 seconds
[rank3]:2025-10-25 23:53:06,226 - INFO -  step: 960  loss:  0.8007  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,535  tflops: 19.81  mfu: 6.35%
[rank1]:2025-10-25 23:53:06,244 - INFO -  step: 960  loss: -4.0000  grad_norm:  0.4382  memory: 10.75GiB(22.62%)  tps: 2,534  tflops: 19.81  mfu: 6.35%
[rank0]:2025-10-25 23:53:06,260 - INFO -  step: 960  loss: -4.0000  grad_norm:  0.4382  memory: 14.89GiB(31.34%)  tps: 2,534  tflops: 19.81  mfu: 6.35%
[rank2]:2025-10-25 23:53:06,238 - INFO -  step: 960  loss: -4.0000  grad_norm:  0.4382  memory:  7.25GiB(15.26%)  tps: 2,534  tflops: 19.81  mfu: 6.35%
[rank3]:2025-10-25 23:53:07,685 - INFO - Avg. fwd time: 70.4042 / Avg. bwd time: 85.2012 / Avg. batch time: 1302.1139 (ms) / GPU bubble ratio: 4.40%
[rank2]:2025-10-25 23:53:07,744 - INFO - Avg. fwd time: 36.1123 / Avg. bwd time: 53.2549 / Avg. batch time: 1392.3971 (ms) / GPU bubble ratio: 48.65%
[rank1]:2025-10-25 23:53:07,818 - INFO - Avg. fwd time: 52.0865 / Avg. bwd time: 73.4830 / Avg. batch time: 1511.0186 (ms) / GPU bubble ratio: 33.52%
[rank0]:2025-10-25 23:53:07,878 - INFO - Avg. fwd time: 40.3386 / Avg. bwd time: 47.7395 / Avg. batch time: 1607.7702 (ms) / GPU bubble ratio: 56.17%
[rank2]:2025-10-25 23:55:15,065 - INFO -  step: 980  loss: -4.0000  grad_norm:  0.4106  memory:  7.25GiB(15.26%)  tps: 2,544  tflops: 19.88  mfu: 6.37%
[rank3]:2025-10-25 23:55:15,053 - INFO -  step: 980  loss:  0.7736  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,544  tflops: 19.88  mfu: 6.37%
[rank1]:2025-10-25 23:55:15,069 - INFO -  step: 980  loss: -4.0000  grad_norm:  0.4106  memory: 10.75GiB(22.62%)  tps: 2,544  tflops: 19.88  mfu: 6.37%
[rank0]:2025-10-25 23:55:15,086 - INFO -  step: 980  loss: -4.0000  grad_norm:  0.4106  memory: 14.89GiB(31.34%)  tps: 2,544  tflops: 19.88  mfu: 6.37%
[rank3]:2025-10-25 23:55:16,526 - INFO - Avg. fwd time: 70.4049 / Avg. bwd time: 85.0663 / Avg. batch time: 1301.0305 (ms) / GPU bubble ratio: 4.40%
[rank2]:2025-10-25 23:55:16,590 - INFO - Avg. fwd time: 36.1110 / Avg. bwd time: 53.1955 / Avg. batch time: 1391.2703 (ms) / GPU bubble ratio: 48.65%
[rank1]:2025-10-25 23:55:16,662 - INFO - Avg. fwd time: 52.0813 / Avg. bwd time: 73.3011 / Avg. batch time: 1509.8825 (ms) / GPU bubble ratio: 33.57%
[rank0]:2025-10-25 23:55:16,726 - INFO - Avg. fwd time: 40.3144 / Avg. bwd time: 47.3738 / Avg. batch time: 1606.5434 (ms) / GPU bubble ratio: 56.33%
[rank3]:2025-10-25 23:56:04,782 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 23:56:04,837 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 23:56:04,906 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 23:56:04,966 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 23:57:19,806 - INFO - [GC] Peforming periodical GC collection 0.03 seconds
[rank2]:2025-10-25 23:57:26,227 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.4213  memory:  7.25GiB(15.26%)  tps: 2,498  tflops: 19.53  mfu: 6.26%
[rank2]:2025-10-25 23:57:26,228 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-25 23:57:26,216 - INFO -  step: 1000  loss:  0.7904  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,498  tflops: 19.53  mfu: 6.26%
[rank3]:2025-10-25 23:57:26,216 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-25 23:57:26,239 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.4213  memory: 10.75GiB(22.62%)  tps: 2,498  tflops: 19.53  mfu: 6.26%
[rank1]:2025-10-25 23:57:26,239 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-25 23:57:26,253 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.4213  memory: 14.89GiB(31.34%)  tps: 2,498  tflops: 19.53  mfu: 6.26%
[rank0]:2025-10-25 23:57:26,253 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-25 23:57:26,255 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank2]:2025-10-25 23:57:28,069 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 1.84 seconds.
[rank1]:2025-10-25 23:57:28,499 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 2.26 seconds.
[rank3]:2025-10-25 23:57:29,427 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.21 seconds.
[rank0]:2025-10-25 23:57:29,911 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-25 23:57:29,913 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.66 seconds.
[rank0]:2025-10-25 23:57:30,011 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251025_2357_stage0_step1000.svg
[rank1]:2025-10-25 23:57:30,002 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251025_2357_stage1_step1000.svg
[rank2]:2025-10-25 23:57:29,999 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251025_2357_stage2_step1000.svg
[rank3]:2025-10-25 23:57:30,355 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/pipeline_schedule/251025_2357_real_step1000_rank3.svg
[rank3]:> Batch Time: 1492.00 ms, GPU Bubble Ratio: 46.65%, 35.93%, 53.67%, 19.63%
[rank3]:2025-10-25 23:57:30,424 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251025_2357_stage3_step1000.svg
[rank3]:2025-10-25 23:57:31,743 - INFO - Avg. fwd time: 70.4049 / Avg. bwd time: 84.9414 / Avg. batch time: 1300.0252 (ms) / GPU bubble ratio: 4.40%
[rank2]:2025-10-25 23:57:31,806 - INFO - Avg. fwd time: 36.1068 / Avg. bwd time: 53.1312 / Avg. batch time: 1390.2326 (ms) / GPU bubble ratio: 48.65%
[rank0]:2025-10-25 23:57:31,937 - INFO - Avg. fwd time: 40.2855 / Avg. bwd time: 47.0242 / Avg. batch time: 1605.3493 (ms) / GPU bubble ratio: 56.49%
[rank1]:2025-10-25 23:57:31,877 - INFO - Avg. fwd time: 52.0629 / Avg. bwd time: 73.1129 / Avg. batch time: 1508.7708 (ms) / GPU bubble ratio: 33.63%
[rank1]:2025-10-25 23:59:39,300 - INFO -  step: 1020  loss: -4.0000  grad_norm:  0.3523  memory: 10.75GiB(22.62%)  tps: 2,463  tflops: 19.25  mfu: 6.17%
[rank2]:2025-10-25 23:59:39,296 - INFO -  step: 1020  loss: -4.0000  grad_norm:  0.3523  memory:  7.25GiB(15.26%)  tps: 2,463  tflops: 19.25  mfu: 6.17%
[rank3]:2025-10-25 23:59:39,284 - INFO -  step: 1020  loss:  0.7681  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,463  tflops: 19.25  mfu: 6.17%
[rank0]:2025-10-25 23:59:39,317 - INFO -  step: 1020  loss: -4.0000  grad_norm:  0.3523  memory: 14.89GiB(31.34%)  tps: 2,463  tflops: 19.25  mfu: 6.17%
[rank3]:2025-10-25 23:59:40,764 - INFO - Avg. fwd time: 70.4053 / Avg. bwd time: 84.8215 / Avg. batch time: 1299.0640 (ms) / GPU bubble ratio: 4.41%
[rank2]:2025-10-25 23:59:40,827 - INFO - Avg. fwd time: 36.1024 / Avg. bwd time: 53.0714 / Avg. batch time: 1389.2293 (ms) / GPU bubble ratio: 48.65%
[rank1]:2025-10-25 23:59:40,909 - INFO - Avg. fwd time: 52.0388 / Avg. bwd time: 72.9370 / Avg. batch time: 1507.7219 (ms) / GPU bubble ratio: 33.69%
[rank0]:2025-10-25 23:59:40,977 - INFO - Avg. fwd time: 40.2578 / Avg. bwd time: 46.6873 / Avg. batch time: 1604.2370 (ms) / GPU bubble ratio: 56.64%
[rank1]:2025-10-26 00:01:48,562 - INFO -  step: 1040  loss: -4.0000  grad_norm:  0.4168  memory: 10.75GiB(22.62%)  tps: 2,535  tflops: 19.82  mfu: 6.35%
[rank2]:2025-10-26 00:01:48,557 - INFO -  step: 1040  loss: -4.0000  grad_norm:  0.4168  memory:  7.25GiB(15.26%)  tps: 2,535  tflops: 19.82  mfu: 6.35%
[rank3]:2025-10-26 00:01:48,545 - INFO -  step: 1040  loss:  0.7669  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,535  tflops: 19.82  mfu: 6.35%
[rank0]:2025-10-26 00:01:48,578 - INFO -  step: 1040  loss: -4.0000  grad_norm:  0.4168  memory: 14.89GiB(31.34%)  tps: 2,535  tflops: 19.82  mfu: 6.35%
[rank3]:2025-10-26 00:01:50,005 - INFO - Avg. fwd time: 70.4109 / Avg. bwd time: 84.7040 / Avg. batch time: 1298.1603 (ms) / GPU bubble ratio: 4.41%
[rank2]:2025-10-26 00:01:50,064 - INFO - Avg. fwd time: 36.0993 / Avg. bwd time: 53.0154 / Avg. batch time: 1388.2931 (ms) / GPU bubble ratio: 48.65%
[rank1]:2025-10-26 00:01:50,139 - INFO - Avg. fwd time: 52.0377 / Avg. bwd time: 72.7731 / Avg. batch time: 1506.7947 (ms) / GPU bubble ratio: 33.73%
[rank0]:2025-10-26 00:01:50,199 - INFO - Avg. fwd time: 40.2377 / Avg. bwd time: 46.3608 / Avg. batch time: 1603.2187 (ms) / GPU bubble ratio: 56.79%
[rank0]:2025-10-26 00:02:46,864 - INFO - [GC] Peforming periodical GC collection 0.29 seconds
[rank1]:2025-10-26 00:03:57,827 - INFO -  step: 1060  loss: -4.0000  grad_norm:  0.4074  memory: 10.75GiB(22.62%)  tps: 2,535  tflops: 19.82  mfu: 6.35%
[rank3]:2025-10-26 00:03:57,811 - INFO -  step: 1060  loss:  0.7585  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,535  tflops: 19.82  mfu: 6.35%
[rank2]:2025-10-26 00:03:57,823 - INFO -  step: 1060  loss: -4.0000  grad_norm:  0.4074  memory:  7.25GiB(15.26%)  tps: 2,535  tflops: 19.82  mfu: 6.35%
[rank0]:2025-10-26 00:03:57,850 - INFO -  step: 1060  loss: -4.0000  grad_norm:  0.4074  memory: 14.89GiB(31.34%)  tps: 2,535  tflops: 19.82  mfu: 6.35%
[rank3]:2025-10-26 00:03:59,300 - INFO - Avg. fwd time: 70.4152 / Avg. bwd time: 84.5907 / Avg. batch time: 1297.2809 (ms) / GPU bubble ratio: 4.41%
[rank2]:2025-10-26 00:03:59,367 - INFO - Avg. fwd time: 36.0972 / Avg. bwd time: 52.9551 / Avg. batch time: 1387.3763 (ms) / GPU bubble ratio: 48.65%
[rank1]:2025-10-26 00:03:59,439 - INFO - Avg. fwd time: 52.0246 / Avg. bwd time: 72.6081 / Avg. batch time: 1505.8430 (ms) / GPU bubble ratio: 33.79%
[rank0]:2025-10-26 00:03:59,500 - INFO - Avg. fwd time: 40.2155 / Avg. bwd time: 46.0460 / Avg. batch time: 1602.1762 (ms) / GPU bubble ratio: 56.93%
[rank3]:2025-10-26 00:05:02,323 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-26 00:05:02,355 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-26 00:05:02,423 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-26 00:05:02,482 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-26 00:06:09,919 - INFO -  step: 1080  loss: -4.0000  grad_norm:  0.4318  memory: 10.75GiB(22.62%)  tps: 2,481  tflops: 19.39  mfu: 6.22%
[rank3]:2025-10-26 00:06:09,903 - INFO -  step: 1080  loss:  0.7423  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,481  tflops: 19.39  mfu: 6.22%
[rank2]:2025-10-26 00:06:09,915 - INFO -  step: 1080  loss: -4.0000  grad_norm:  0.4318  memory:  7.25GiB(15.26%)  tps: 2,481  tflops: 19.39  mfu: 6.22%
[rank0]:2025-10-26 00:06:09,937 - INFO -  step: 1080  loss: -4.0000  grad_norm:  0.4318  memory: 14.89GiB(31.34%)  tps: 2,481  tflops: 19.39  mfu: 6.22%
[rank3]:2025-10-26 00:06:11,376 - INFO - Avg. fwd time: 70.4199 / Avg. bwd time: 84.4840 / Avg. batch time: 1296.4544 (ms) / GPU bubble ratio: 4.41%
[rank2]:2025-10-26 00:06:11,435 - INFO - Avg. fwd time: 36.0922 / Avg. bwd time: 52.8942 / Avg. batch time: 1386.6042 (ms) / GPU bubble ratio: 48.66%
[rank1]:2025-10-26 00:06:11,515 - INFO - Avg. fwd time: 52.0029 / Avg. bwd time: 72.4446 / Avg. batch time: 1505.0189 (ms) / GPU bubble ratio: 33.85%
[rank0]:2025-10-26 00:06:11,580 - INFO - Avg. fwd time: 40.1950 / Avg. bwd time: 45.7462 / Avg. batch time: 1601.2842 (ms) / GPU bubble ratio: 57.06%
[rank0]:2025-10-26 00:08:12,337 - INFO - [GC] Peforming periodical GC collection 0.03 seconds
[rank3]:2025-10-26 00:08:18,811 - INFO -  step: 1100  loss:  0.7713  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,542  tflops: 19.87  mfu: 6.37%
[rank2]:2025-10-26 00:08:18,823 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.4432  memory:  7.25GiB(15.26%)  tps: 2,542  tflops: 19.87  mfu: 6.37%
[rank0]:2025-10-26 00:08:18,845 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.4432  memory: 14.89GiB(31.34%)  tps: 2,542  tflops: 19.87  mfu: 6.37%
[rank1]:2025-10-26 00:08:18,828 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.4432  memory: 10.75GiB(22.62%)  tps: 2,542  tflops: 19.87  mfu: 6.37%
[rank2]:2025-10-26 00:08:18,919 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251026_0008_stage2_step1100.svg
[rank0]:2025-10-26 00:08:18,921 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251026_0008_stage0_step1100.svg
[rank1]:2025-10-26 00:08:18,920 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251026_0008_stage1_step1100.svg
[rank3]:2025-10-26 00:08:19,072 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/pipeline_schedule/251026_0008_real_step1100_rank3.svg
[rank3]:> Batch Time: 1491.56 ms, GPU Bubble Ratio: 62.08%, 36.33%, 53.72%, 19.60%
[rank3]:2025-10-26 00:08:19,134 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251026_0008_stage3_step1100.svg
[rank3]:2025-10-26 00:08:20,440 - INFO - Avg. fwd time: 70.4197 / Avg. bwd time: 84.3795 / Avg. batch time: 1295.6084 (ms) / GPU bubble ratio: 4.42%
[rank2]:2025-10-26 00:08:20,505 - INFO - Avg. fwd time: 36.0872 / Avg. bwd time: 52.8362 / Avg. batch time: 1385.7415 (ms) / GPU bubble ratio: 48.66%
[rank1]:2025-10-26 00:08:20,578 - INFO - Avg. fwd time: 51.9819 / Avg. bwd time: 72.2919 / Avg. batch time: 1504.1038 (ms) / GPU bubble ratio: 33.90%
[rank0]:2025-10-26 00:08:20,642 - INFO - Avg. fwd time: 40.1751 / Avg. bwd time: 45.4581 / Avg. batch time: 1600.3060 (ms) / GPU bubble ratio: 57.19%
[rank3]:2025-10-26 00:10:27,963 - INFO -  step: 1120  loss:  0.7432  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,537  tflops: 19.83  mfu: 6.36%
[rank2]:2025-10-26 00:10:27,974 - INFO -  step: 1120  loss: -4.0000  grad_norm:  0.4229  memory:  7.25GiB(15.26%)  tps: 2,537  tflops: 19.83  mfu: 6.36%
[rank0]:2025-10-26 00:10:27,993 - INFO -  step: 1120  loss: -4.0000  grad_norm:  0.4229  memory: 14.89GiB(31.34%)  tps: 2,537  tflops: 19.84  mfu: 6.36%
[rank1]:2025-10-26 00:10:27,978 - INFO -  step: 1120  loss: -4.0000  grad_norm:  0.4229  memory: 10.75GiB(22.62%)  tps: 2,537  tflops: 19.83  mfu: 6.36%
[rank3]:2025-10-26 00:10:29,423 - INFO - Avg. fwd time: 70.4226 / Avg. bwd time: 84.2778 / Avg. batch time: 1294.8104 (ms) / GPU bubble ratio: 4.42%
[rank2]:2025-10-26 00:10:29,483 - INFO - Avg. fwd time: 36.0846 / Avg. bwd time: 52.7868 / Avg. batch time: 1384.9148 (ms) / GPU bubble ratio: 48.66%
[rank0]:2025-10-26 00:10:29,629 - INFO - Avg. fwd time: 40.1576 / Avg. bwd time: 45.1767 / Avg. batch time: 1599.3875 (ms) / GPU bubble ratio: 57.32%
[rank1]:2025-10-26 00:10:29,567 - INFO - Avg. fwd time: 51.9696 / Avg. bwd time: 72.1475 / Avg. batch time: 1503.2608 (ms) / GPU bubble ratio: 33.95%
[rank3]:2025-10-26 00:12:37,000 - INFO -  step: 1140  loss:  0.7344  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,539  tflops: 19.85  mfu: 6.36%
[rank2]:2025-10-26 00:12:37,011 - INFO -  step: 1140  loss: -4.0000  grad_norm:  0.4345  memory:  7.25GiB(15.26%)  tps: 2,539  tflops: 19.85  mfu: 6.36%
[rank0]:2025-10-26 00:12:37,036 - INFO -  step: 1140  loss: -4.0000  grad_norm:  0.4345  memory: 14.89GiB(31.34%)  tps: 2,539  tflops: 19.85  mfu: 6.36%
[rank1]:2025-10-26 00:12:37,015 - INFO -  step: 1140  loss: -4.0000  grad_norm:  0.4345  memory: 10.75GiB(22.62%)  tps: 2,539  tflops: 19.85  mfu: 6.36%
[rank3]:2025-10-26 00:12:38,479 - INFO - Avg. fwd time: 70.4243 / Avg. bwd time: 84.1773 / Avg. batch time: 1294.0115 (ms) / GPU bubble ratio: 4.42%
[rank2]:2025-10-26 00:12:38,540 - INFO - Avg. fwd time: 36.0837 / Avg. bwd time: 52.7442 / Avg. batch time: 1384.0947 (ms) / GPU bubble ratio: 48.66%
[rank0]:2025-10-26 00:12:38,684 - INFO - Avg. fwd time: 40.1397 / Avg. bwd time: 44.9042 / Avg. batch time: 1598.5078 (ms) / GPU bubble ratio: 57.44%
[rank1]:2025-10-26 00:12:38,623 - INFO - Avg. fwd time: 51.9741 / Avg. bwd time: 72.0093 / Avg. batch time: 1502.4649 (ms) / GPU bubble ratio: 33.98%
[rank0]:2025-10-26 00:13:35,163 - INFO - [GC] Peforming periodical GC collection 0.04 seconds
[rank3]:2025-10-26 00:13:55,129 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-26 00:13:55,975 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-26 00:13:56,044 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-26 00:13:56,099 - WARNING - Dataset alpaca is being re-looped
[rank3]:2025-10-26 00:14:48,185 - INFO -  step: 1160  loss:  0.7030  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,498  tflops: 19.53  mfu: 6.26%
[rank0]:2025-10-26 00:14:48,225 - INFO -  step: 1160  loss: -4.0000  grad_norm:  0.3984  memory: 14.89GiB(31.34%)  tps: 2,498  tflops: 19.53  mfu: 6.26%
[rank2]:2025-10-26 00:14:48,197 - INFO -  step: 1160  loss: -4.0000  grad_norm:  0.3984  memory:  7.25GiB(15.26%)  tps: 2,498  tflops: 19.53  mfu: 6.26%
[rank1]:2025-10-26 00:14:48,204 - INFO -  step: 1160  loss: -4.0000  grad_norm:  0.3984  memory: 10.75GiB(22.62%)  tps: 2,498  tflops: 19.53  mfu: 6.26%
[rank3]:2025-10-26 00:14:49,663 - INFO - Avg. fwd time: 70.4223 / Avg. bwd time: 84.0874 / Avg. batch time: 1293.2678 (ms) / GPU bubble ratio: 4.42%
[rank2]:2025-10-26 00:14:49,728 - INFO - Avg. fwd time: 36.0815 / Avg. bwd time: 52.6994 / Avg. batch time: 1383.3395 (ms) / GPU bubble ratio: 48.66%
[rank0]:2025-10-26 00:14:49,867 - INFO - Avg. fwd time: 40.1183 / Avg. bwd time: 44.6437 / Avg. batch time: 1597.6506 (ms) / GPU bubble ratio: 57.56%
[rank1]:2025-10-26 00:14:49,801 - INFO - Avg. fwd time: 51.9571 / Avg. bwd time: 71.8751 / Avg. batch time: 1501.6632 (ms) / GPU bubble ratio: 34.03%
[rank3]:2025-10-26 00:16:57,164 - INFO -  step: 1180  loss:  0.7297  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,541  tflops: 19.86  mfu: 6.37%
[rank2]:2025-10-26 00:16:57,175 - INFO -  step: 1180  loss: -4.0000  grad_norm:  0.4574  memory:  7.25GiB(15.26%)  tps: 2,541  tflops: 19.86  mfu: 6.37%
[rank0]:2025-10-26 00:16:57,202 - INFO -  step: 1180  loss: -4.0000  grad_norm:  0.4574  memory: 14.89GiB(31.34%)  tps: 2,541  tflops: 19.86  mfu: 6.37%
[rank1]:2025-10-26 00:16:57,186 - INFO -  step: 1180  loss: -4.0000  grad_norm:  0.4574  memory: 10.75GiB(22.62%)  tps: 2,541  tflops: 19.86  mfu: 6.37%
[rank3]:2025-10-26 00:16:58,589 - INFO - Avg. fwd time: 70.4232 / Avg. bwd time: 83.9947 / Avg. batch time: 1292.5258 (ms) / GPU bubble ratio: 4.42%
[rank2]:2025-10-26 00:16:58,650 - INFO - Avg. fwd time: 36.0796 / Avg. bwd time: 52.6536 / Avg. batch time: 1382.5697 (ms) / GPU bubble ratio: 48.66%
[rank1]:2025-10-26 00:16:58,738 - INFO - Avg. fwd time: 51.9455 / Avg. bwd time: 71.7430 / Avg. batch time: 1500.8695 (ms) / GPU bubble ratio: 34.07%
[rank0]:2025-10-26 00:16:58,799 - INFO - Avg. fwd time: 40.1024 / Avg. bwd time: 44.3935 / Avg. batch time: 1596.8005 (ms) / GPU bubble ratio: 57.67%
[rank0]:2025-10-26 00:18:59,596 - INFO - [GC] Peforming periodical GC collection 0.03 seconds
[rank3]:2025-10-26 00:19:06,045 - INFO -  step: 1200  loss:  0.7397  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,543  tflops: 19.88  mfu: 6.37%
[rank2]:2025-10-26 00:19:06,057 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.4519  memory:  7.25GiB(15.26%)  tps: 2,542  tflops: 19.88  mfu: 6.37%
[rank1]:2025-10-26 00:19:06,062 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.4519  memory: 10.75GiB(22.62%)  tps: 2,543  tflops: 19.88  mfu: 6.37%
[rank0]:2025-10-26 00:19:06,078 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.4519  memory: 14.89GiB(31.34%)  tps: 2,543  tflops: 19.88  mfu: 6.37%
[rank2]:2025-10-26 00:19:06,154 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251026_0019_stage2_step1200.svg
[rank1]:2025-10-26 00:19:06,156 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251026_0019_stage1_step1200.svg
[rank0]:2025-10-26 00:19:06,155 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251026_0019_stage0_step1200.svg
[rank3]:2025-10-26 00:19:06,304 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/pipeline_schedule/251026_0019_real_step1200_rank3.svg
[rank3]:> Batch Time: 1490.88 ms, GPU Bubble Ratio: 62.21%, 36.52%, 53.74%, 19.55%
[rank3]:2025-10-26 00:19:06,369 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251026_0019_stage3_step1200.svg
[rank3]:2025-10-26 00:19:07,684 - INFO - Avg. fwd time: 70.4224 / Avg. bwd time: 83.9051 / Avg. batch time: 1291.7961 (ms) / GPU bubble ratio: 4.43%
[rank2]:2025-10-26 00:19:07,757 - INFO - Avg. fwd time: 36.0754 / Avg. bwd time: 52.6114 / Avg. batch time: 1381.8422 (ms) / GPU bubble ratio: 48.66%
[rank1]:2025-10-26 00:19:07,840 - INFO - Avg. fwd time: 51.9346 / Avg. bwd time: 71.6160 / Avg. batch time: 1500.1417 (ms) / GPU bubble ratio: 34.11%
[rank0]:2025-10-26 00:19:07,901 - INFO - Avg. fwd time: 40.0820 / Avg. bwd time: 44.1490 / Avg. batch time: 1596.0108 (ms) / GPU bubble ratio: 57.78%
[rank3]:2025-10-26 00:21:14,815 - INFO -  step: 1220  loss:  0.7211  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,545  tflops: 19.89  mfu: 6.38%
[rank2]:2025-10-26 00:21:14,827 - INFO -  step: 1220  loss: -4.0000  grad_norm:  0.4744  memory:  7.25GiB(15.26%)  tps: 2,545  tflops: 19.89  mfu: 6.38%
[rank1]:2025-10-26 00:21:14,838 - INFO -  step: 1220  loss: -4.0000  grad_norm:  0.4744  memory: 10.75GiB(22.62%)  tps: 2,545  tflops: 19.89  mfu: 6.38%
[rank0]:2025-10-26 00:21:14,854 - INFO -  step: 1220  loss: -4.0000  grad_norm:  0.4744  memory: 14.89GiB(31.34%)  tps: 2,545  tflops: 19.89  mfu: 6.38%
[rank3]:2025-10-26 00:21:16,261 - INFO - Avg. fwd time: 70.4194 / Avg. bwd time: 83.8178 / Avg. batch time: 1291.0681 (ms) / GPU bubble ratio: 4.43%
[rank2]:2025-10-26 00:21:16,321 - INFO - Avg. fwd time: 36.0718 / Avg. bwd time: 52.5697 / Avg. batch time: 1381.0906 (ms) / GPU bubble ratio: 48.65%
[rank1]:2025-10-26 00:21:16,396 - INFO - Avg. fwd time: 51.9138 / Avg. bwd time: 71.4902 / Avg. batch time: 1499.3417 (ms) / GPU bubble ratio: 34.16%
[rank0]:2025-10-26 00:21:16,458 - INFO - Avg. fwd time: 40.0620 / Avg. bwd time: 43.9153 / Avg. batch time: 1595.1562 (ms) / GPU bubble ratio: 57.88%
[rank3]:2025-10-26 00:22:48,800 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-26 00:22:49,652 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-26 00:22:49,717 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-26 00:22:49,773 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-26 00:23:25,535 - INFO -  step: 1240  loss: -4.0000  grad_norm:  0.4690  memory:  7.25GiB(15.26%)  tps: 2,507  tflops: 19.60  mfu: 6.28%
[rank1]:2025-10-26 00:23:25,540 - INFO -  step: 1240  loss: -4.0000  grad_norm:  0.4690  memory: 10.75GiB(22.62%)  tps: 2,507  tflops: 19.60  mfu: 6.28%
[rank0]:2025-10-26 00:23:25,557 - INFO -  step: 1240  loss: -4.0000  grad_norm:  0.4690  memory: 14.89GiB(31.34%)  tps: 2,507  tflops: 19.60  mfu: 6.28%
[rank3]:2025-10-26 00:23:25,523 - INFO -  step: 1240  loss:  0.7096  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,507  tflops: 19.60  mfu: 6.28%
[rank3]:2025-10-26 00:23:26,966 - INFO - Avg. fwd time: 70.4191 / Avg. bwd time: 83.7369 / Avg. batch time: 1290.4122 (ms) / GPU bubble ratio: 4.43%
[rank2]:2025-10-26 00:23:27,027 - INFO - Avg. fwd time: 36.0684 / Avg. bwd time: 52.5270 / Avg. batch time: 1380.4119 (ms) / GPU bubble ratio: 48.66%
[rank1]:2025-10-26 00:23:27,104 - INFO - Avg. fwd time: 51.8877 / Avg. bwd time: 71.3741 / Avg. batch time: 1498.6146 (ms) / GPU bubble ratio: 34.20%
[rank0]:2025-10-26 00:23:27,166 - INFO - Avg. fwd time: 40.0451 / Avg. bwd time: 43.6873 / Avg. batch time: 1594.3749 (ms) / GPU bubble ratio: 57.99%
[rank0]:2025-10-26 00:24:23,393 - INFO - [GC] Peforming periodical GC collection 0.04 seconds
[rank2]:2025-10-26 00:25:34,199 - INFO -  step: 1260  loss: -4.0000  grad_norm:  0.4619  memory:  7.25GiB(15.26%)  tps: 2,547  tflops: 19.91  mfu: 6.38%
[rank1]:2025-10-26 00:25:34,204 - INFO -  step: 1260  loss: -4.0000  grad_norm:  0.4619  memory: 10.75GiB(22.62%)  tps: 2,547  tflops: 19.91  mfu: 6.38%
[rank0]:2025-10-26 00:25:34,222 - INFO -  step: 1260  loss: -4.0000  grad_norm:  0.4619  memory: 14.89GiB(31.34%)  tps: 2,547  tflops: 19.91  mfu: 6.38%
[rank3]:2025-10-26 00:25:34,187 - INFO -  step: 1260  loss:  0.7394  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,547  tflops: 19.91  mfu: 6.38%
[rank3]:2025-10-26 00:25:35,681 - INFO - Avg. fwd time: 70.4192 / Avg. bwd time: 83.6530 / Avg. batch time: 1289.7360 (ms) / GPU bubble ratio: 4.43%
[rank2]:2025-10-26 00:25:35,742 - INFO - Avg. fwd time: 36.0654 / Avg. bwd time: 52.4871 / Avg. batch time: 1379.7102 (ms) / GPU bubble ratio: 48.65%
[rank1]:2025-10-26 00:25:35,824 - INFO - Avg. fwd time: 51.8814 / Avg. bwd time: 71.2738 / Avg. batch time: 1497.9023 (ms) / GPU bubble ratio: 34.23%
[rank0]:2025-10-26 00:25:35,890 - INFO - Avg. fwd time: 40.0331 / Avg. bwd time: 43.4656 / Avg. batch time: 1593.5973 (ms) / GPU bubble ratio: 58.08%
[rank3]:2025-10-26 00:27:43,559 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/pipeline_schedule_adjustment/251026_0027_rank3_trend_line.svg
[rank2]:2025-10-26 00:27:43,571 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/pipeline_schedule_adjustment/251026_0027_rank2_trend_line.svg
[rank0]:2025-10-26 00:27:43,725 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/pipeline_schedule_adjustment/251026_0027_rank0_trend_line.svg
[rank1]:2025-10-26 00:27:43,647 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/pipeline_schedule_adjustment/251026_0027_rank1_trend_line.svg
[rank2]:2025-10-26 00:27:43,733 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-26 00:27:43,736 - INFO -  step: 1280  loss: -4.0000  grad_norm:  0.4786  memory:  7.25GiB(15.26%)  tps: 2,530  tflops: 19.78  mfu: 6.34%
[rank0]:2025-10-26 00:27:43,733 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank0]:2025-10-26 00:27:43,736 - INFO -  step: 1280  loss: -4.0000  grad_norm:  0.4786  memory: 14.89GiB(31.34%)  tps: 2,530  tflops: 19.78  mfu: 6.34%
[rank1]:2025-10-26 00:27:43,733 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-10-26 00:27:43,736 - INFO -  step: 1280  loss: -4.0000  grad_norm:  0.4786  memory: 10.75GiB(22.62%)  tps: 2,530  tflops: 19.78  mfu: 6.34%
[rank3]:2025-10-26 00:27:43,964 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/pipeline_schedule/251026_0027_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 1470.29 ms, GPU Bubble Ratio: 55.57%, 33.21%, 52.27%, 18.60%
[rank3]:2025-10-26 00:27:43,964 - INFO - 	> Batch Time: 1470.29 ms (Average Freeze Ratio: 0.31)
[rank3]:2025-10-26 00:27:43,965 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-26 00:27:43,971 - INFO -  step: 1280  loss:  0.7304  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,525  tflops: 19.74  mfu: 6.33%
[rank3]:2025-10-26 00:27:45,269 - INFO - Avg. fwd time: 70.4186 / Avg. bwd time: 83.5713 / Avg. batch time: 1289.0712 (ms) / GPU bubble ratio: 4.43%
[rank2]:2025-10-26 00:27:45,329 - INFO - Avg. fwd time: 36.0638 / Avg. bwd time: 52.4490 / Avg. batch time: 1379.0454 (ms) / GPU bubble ratio: 48.65%
[rank1]:2025-10-26 00:27:45,406 - INFO - Avg. fwd time: 51.8777 / Avg. bwd time: 71.1633 / Avg. batch time: 1497.2422 (ms) / GPU bubble ratio: 34.26%
[rank0]:2025-10-26 00:27:45,475 - INFO - Avg. fwd time: 40.0206 / Avg. bwd time: 43.2510 / Avg. batch time: 1592.8842 (ms) / GPU bubble ratio: 58.18%
[rank0]:2025-10-26 00:29:46,329 - INFO - [GC] Peforming periodical GC collection 0.04 seconds
[rank2]:2025-10-26 00:29:52,757 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.6096  memory:  7.25GiB(15.26%)  tps: 2,540  tflops: 19.85  mfu: 6.36%
[rank0]:2025-10-26 00:29:52,779 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.6096  memory: 14.89GiB(31.34%)  tps: 2,539  tflops: 19.85  mfu: 6.36%
[rank1]:2025-10-26 00:29:52,761 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.6096  memory: 10.75GiB(22.62%)  tps: 2,540  tflops: 19.85  mfu: 6.36%
[rank3]:2025-10-26 00:29:52,745 - INFO -  step: 1300  loss:  0.6813  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,545  tflops: 19.89  mfu: 6.38%
[rank2]:2025-10-26 00:29:52,857 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251026_0029_stage2_step1300.svg
[rank0]:2025-10-26 00:29:52,857 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251026_0029_stage0_step1300.svg
[rank1]:2025-10-26 00:29:52,857 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251026_0029_stage1_step1300.svg
[rank3]:2025-10-26 00:29:53,010 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/pipeline_schedule/251026_0029_real_step1300_rank3.svg
[rank3]:> Batch Time: 1489.72 ms, GPU Bubble Ratio: 62.27%, 36.67%, 53.75%, 19.51%
[rank3]:2025-10-26 00:29:53,073 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251026_0029_stage3_step1300.svg
[rank3]:2025-10-26 00:29:54,369 - INFO - Avg. fwd time: 70.4147 / Avg. bwd time: 83.4891 / Avg. batch time: 1288.3765 (ms) / GPU bubble ratio: 4.44%
[rank2]:2025-10-26 00:29:54,430 - INFO - Avg. fwd time: 36.0603 / Avg. bwd time: 52.4113 / Avg. batch time: 1378.3504 (ms) / GPU bubble ratio: 48.65%
[rank1]:2025-10-26 00:29:54,503 - INFO - Avg. fwd time: 51.8693 / Avg. bwd time: 71.0494 / Avg. batch time: 1496.5137 (ms) / GPU bubble ratio: 34.29%
[rank0]:2025-10-26 00:29:54,572 - INFO - Avg. fwd time: 40.0421 / Avg. bwd time: 43.5432 / Avg. batch time: 1592.2207 (ms) / GPU bubble ratio: 58.00%
[rank3]:2025-10-26 00:31:42,373 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-26 00:31:42,402 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-26 00:31:42,472 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-26 00:31:42,538 - WARNING - Dataset alpaca is being re-looped
[rank3]:2025-10-26 00:32:04,367 - INFO -  step: 1320  loss:  0.6678  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,490  tflops: 19.46  mfu: 6.24%
[rank2]:2025-10-26 00:32:04,379 - INFO -  step: 1320  loss: -4.0000  grad_norm:  0.6661  memory:  7.25GiB(15.26%)  tps: 2,490  tflops: 19.46  mfu: 6.24%
[rank1]:2025-10-26 00:32:04,383 - INFO -  step: 1320  loss: -4.0000  grad_norm:  0.6661  memory: 10.75GiB(22.62%)  tps: 2,490  tflops: 19.46  mfu: 6.24%
[rank0]:2025-10-26 00:32:04,404 - INFO -  step: 1320  loss: -4.0000  grad_norm:  0.6661  memory: 14.89GiB(31.34%)  tps: 2,489  tflops: 19.46  mfu: 6.24%
[rank3]:2025-10-26 00:32:05,846 - INFO - Avg. fwd time: 70.4099 / Avg. bwd time: 83.4106 / Avg. batch time: 1287.7048 (ms) / GPU bubble ratio: 4.44%
[rank2]:2025-10-26 00:32:05,910 - INFO - Avg. fwd time: 36.0574 / Avg. bwd time: 52.3718 / Avg. batch time: 1377.6562 (ms) / GPU bubble ratio: 48.65%
[rank1]:2025-10-26 00:32:05,983 - INFO - Avg. fwd time: 51.8643 / Avg. bwd time: 70.9453 / Avg. batch time: 1495.7962 (ms) / GPU bubble ratio: 34.32%
[rank0]:2025-10-26 00:32:06,058 - INFO - Avg. fwd time: 40.0657 / Avg. bwd time: 43.8295 / Avg. batch time: 1591.5687 (ms) / GPU bubble ratio: 57.83%
[rank3]:2025-10-26 00:34:13,284 - INFO -  step: 1340  loss:  0.6809  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,542  tflops: 19.87  mfu: 6.37%
[rank1]:2025-10-26 00:34:13,299 - INFO -  step: 1340  loss: -4.0000  grad_norm:  0.6358  memory: 10.75GiB(22.62%)  tps: 2,542  tflops: 19.87  mfu: 6.37%
[rank2]:2025-10-26 00:34:13,296 - INFO -  step: 1340  loss: -4.0000  grad_norm:  0.6358  memory:  7.25GiB(15.26%)  tps: 2,542  tflops: 19.87  mfu: 6.37%
[rank0]:2025-10-26 00:34:13,313 - INFO -  step: 1340  loss: -4.0000  grad_norm:  0.6358  memory: 14.89GiB(31.34%)  tps: 2,542  tflops: 19.87  mfu: 6.37%
[rank3]:2025-10-26 00:34:14,746 - INFO - Avg. fwd time: 70.4041 / Avg. bwd time: 83.3312 / Avg. batch time: 1287.0191 (ms) / GPU bubble ratio: 4.44%
[rank2]:2025-10-26 00:34:14,809 - INFO - Avg. fwd time: 36.0552 / Avg. bwd time: 52.3320 / Avg. batch time: 1376.9436 (ms) / GPU bubble ratio: 48.65%
[rank1]:2025-10-26 00:34:14,884 - INFO - Avg. fwd time: 51.8613 / Avg. bwd time: 70.8534 / Avg. batch time: 1495.0872 (ms) / GPU bubble ratio: 34.34%
[rank0]:2025-10-26 00:34:14,959 - INFO - Avg. fwd time: 40.0850 / Avg. bwd time: 44.1081 / Avg. batch time: 1590.9203 (ms) / GPU bubble ratio: 57.66%
[rank0]:2025-10-26 00:35:11,461 - INFO - [GC] Peforming periodical GC collection 0.04 seconds
[rank3]:2025-10-26 00:36:22,456 - INFO -  step: 1360  loss:  0.6943  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,537  tflops: 19.83  mfu: 6.36%
[rank1]:2025-10-26 00:36:22,472 - INFO -  step: 1360  loss: -4.0000  grad_norm:  0.6427  memory: 10.75GiB(22.62%)  tps: 2,537  tflops: 19.83  mfu: 6.36%
[rank2]:2025-10-26 00:36:22,468 - INFO -  step: 1360  loss: -4.0000  grad_norm:  0.6427  memory:  7.25GiB(15.26%)  tps: 2,537  tflops: 19.83  mfu: 6.36%
[rank0]:2025-10-26 00:36:22,494 - INFO -  step: 1360  loss: -4.0000  grad_norm:  0.6427  memory: 14.89GiB(31.34%)  tps: 2,537  tflops: 19.83  mfu: 6.36%
[rank3]:2025-10-26 00:36:23,932 - INFO - Avg. fwd time: 70.3998 / Avg. bwd time: 83.2587 / Avg. batch time: 1286.3989 (ms) / GPU bubble ratio: 4.44%
[rank2]:2025-10-26 00:36:23,994 - INFO - Avg. fwd time: 36.0523 / Avg. bwd time: 52.2960 / Avg. batch time: 1376.3030 (ms) / GPU bubble ratio: 48.65%
[rank1]:2025-10-26 00:36:24,076 - INFO - Avg. fwd time: 51.8514 / Avg. bwd time: 70.7603 / Avg. batch time: 1494.4551 (ms) / GPU bubble ratio: 34.36%
[rank0]:2025-10-26 00:36:24,146 - INFO - Avg. fwd time: 40.1066 / Avg. bwd time: 44.3740 / Avg. batch time: 1590.3499 (ms) / GPU bubble ratio: 57.50%
[rank3]:2025-10-26 00:38:31,507 - INFO -  step: 1380  loss:  0.6618  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,539  tflops: 19.85  mfu: 6.36%
[rank1]:2025-10-26 00:38:31,522 - INFO -  step: 1380  loss: -4.0000  grad_norm:  0.6514  memory: 10.75GiB(22.62%)  tps: 2,539  tflops: 19.85  mfu: 6.36%
[rank2]:2025-10-26 00:38:31,519 - INFO -  step: 1380  loss: -4.0000  grad_norm:  0.6514  memory:  7.25GiB(15.26%)  tps: 2,539  tflops: 19.85  mfu: 6.36%
[rank0]:2025-10-26 00:38:31,537 - INFO -  step: 1380  loss: -4.0000  grad_norm:  0.6514  memory: 14.89GiB(31.34%)  tps: 2,539  tflops: 19.85  mfu: 6.36%
[rank3]:2025-10-26 00:38:32,974 - INFO - Avg. fwd time: 70.3969 / Avg. bwd time: 83.1863 / Avg. batch time: 1285.7906 (ms) / GPU bubble ratio: 4.44%
[rank2]:2025-10-26 00:38:33,037 - INFO - Avg. fwd time: 36.0509 / Avg. bwd time: 52.2651 / Avg. batch time: 1375.6837 (ms) / GPU bubble ratio: 48.64%
[rank1]:2025-10-26 00:38:33,114 - INFO - Avg. fwd time: 51.8441 / Avg. bwd time: 70.6539 / Avg. batch time: 1493.8212 (ms) / GPU bubble ratio: 34.40%
[rank0]:2025-10-26 00:38:33,192 - INFO - Avg. fwd time: 40.1269 / Avg. bwd time: 44.6339 / Avg. batch time: 1589.7761 (ms) / GPU bubble ratio: 57.35%
[rank0]:2025-10-26 00:40:34,295 - INFO - [GC] Peforming periodical GC collection 0.03 seconds
[rank3]:2025-10-26 00:40:34,971 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-26 00:40:35,824 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-26 00:40:35,903 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-26 00:40:35,968 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-26 00:40:42,768 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.5830  memory:  7.25GiB(15.26%)  tps: 2,497  tflops: 19.52  mfu: 6.26%
[rank0]:2025-10-26 00:40:42,788 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.5830  memory: 14.89GiB(31.34%)  tps: 2,497  tflops: 19.52  mfu: 6.26%
[rank3]:2025-10-26 00:40:42,756 - INFO -  step: 1400  loss:  0.6561  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,497  tflops: 19.52  mfu: 6.26%
[rank1]:2025-10-26 00:40:42,772 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.5830  memory: 10.75GiB(22.62%)  tps: 2,497  tflops: 19.52  mfu: 6.26%
[rank2]:2025-10-26 00:40:42,871 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251026_0040_stage2_step1400.svg
[rank0]:2025-10-26 00:40:42,872 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251026_0040_stage0_step1400.svg
[rank1]:2025-10-26 00:40:42,870 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251026_0040_stage1_step1400.svg
[rank3]:2025-10-26 00:40:43,015 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/pipeline_schedule/251026_0040_real_step1400_rank3.svg
[rank3]:> Batch Time: 1489.38 ms, GPU Bubble Ratio: 62.11%, 36.80%, 53.83%, 19.52%
[rank3]:2025-10-26 00:40:43,082 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251026_0040_stage3_step1400.svg
[rank3]:2025-10-26 00:40:44,388 - INFO - Avg. fwd time: 70.3943 / Avg. bwd time: 83.1182 / Avg. batch time: 1285.2203 (ms) / GPU bubble ratio: 4.44%
[rank2]:2025-10-26 00:40:44,450 - INFO - Avg. fwd time: 36.0489 / Avg. bwd time: 52.2316 / Avg. batch time: 1375.1079 (ms) / GPU bubble ratio: 48.64%
[rank1]:2025-10-26 00:40:44,524 - INFO - Avg. fwd time: 51.8415 / Avg. bwd time: 70.5688 / Avg. batch time: 1493.2587 (ms) / GPU bubble ratio: 34.42%
[rank0]:2025-10-26 00:40:44,598 - INFO - Avg. fwd time: 40.1444 / Avg. bwd time: 44.8874 / Avg. batch time: 1589.3908 (ms) / GPU bubble ratio: 57.20%
[rank1]:2025-10-26 00:42:51,922 - INFO -  step: 1420  loss: -4.0000  grad_norm:  0.6353  memory: 10.75GiB(22.62%)  tps: 2,537  tflops: 19.83  mfu: 6.36%
[rank0]:2025-10-26 00:42:51,939 - INFO -  step: 1420  loss: -4.0000  grad_norm:  0.6353  memory: 14.89GiB(31.34%)  tps: 2,537  tflops: 19.83  mfu: 6.36%
[rank2]:2025-10-26 00:42:51,918 - INFO -  step: 1420  loss: -4.0000  grad_norm:  0.6353  memory:  7.25GiB(15.26%)  tps: 2,537  tflops: 19.83  mfu: 6.36%
[rank3]:2025-10-26 00:42:51,906 - INFO -  step: 1420  loss:  0.6738  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,537  tflops: 19.83  mfu: 6.36%
[rank3]:2025-10-26 00:42:53,387 - INFO - Avg. fwd time: 70.3896 / Avg. bwd time: 83.0495 / Avg. batch time: 1284.6283 (ms) / GPU bubble ratio: 4.45%
[rank2]:2025-10-26 00:42:53,448 - INFO - Avg. fwd time: 36.0470 / Avg. bwd time: 52.1985 / Avg. batch time: 1374.4871 (ms) / GPU bubble ratio: 48.64%
[rank1]:2025-10-26 00:42:53,529 - INFO - Avg. fwd time: 51.8349 / Avg. bwd time: 70.4802 / Avg. batch time: 1492.6442 (ms) / GPU bubble ratio: 34.44%
[rank0]:2025-10-26 00:42:53,599 - INFO - Avg. fwd time: 40.1671 / Avg. bwd time: 45.1305 / Avg. batch time: 1588.8222 (ms) / GPU bubble ratio: 57.05%
[rank2]:2025-10-26 00:45:00,930 - INFO -  step: 1440  loss: -4.0000  grad_norm:  0.6300  memory:  7.25GiB(15.26%)  tps: 2,540  tflops: 19.86  mfu: 6.36%
[rank3]:2025-10-26 00:45:00,918 - INFO -  step: 1440  loss:  0.6927  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,540  tflops: 19.86  mfu: 6.36%
[rank1]:2025-10-26 00:45:00,933 - INFO -  step: 1440  loss: -4.0000  grad_norm:  0.6300  memory: 10.75GiB(22.62%)  tps: 2,540  tflops: 19.86  mfu: 6.36%
[rank0]:2025-10-26 00:45:00,949 - INFO -  step: 1440  loss: -4.0000  grad_norm:  0.6300  memory: 14.89GiB(31.34%)  tps: 2,540  tflops: 19.86  mfu: 6.36%
[rank3]:2025-10-26 00:45:02,348 - INFO - Avg. fwd time: 70.3842 / Avg. bwd time: 82.9806 / Avg. batch time: 1284.0335 (ms) / GPU bubble ratio: 4.45%
[rank2]:2025-10-26 00:45:02,414 - INFO - Avg. fwd time: 36.0458 / Avg. bwd time: 52.1639 / Avg. batch time: 1373.8696 (ms) / GPU bubble ratio: 48.64%
[rank1]:2025-10-26 00:45:02,502 - INFO - Avg. fwd time: 51.8350 / Avg. bwd time: 70.3937 / Avg. batch time: 1492.0376 (ms) / GPU bubble ratio: 34.46%
[rank0]:2025-10-26 00:45:02,578 - INFO - Avg. fwd time: 40.1852 / Avg. bwd time: 45.3691 / Avg. batch time: 1588.2587 (ms) / GPU bubble ratio: 56.91%
[rank0]:2025-10-26 00:45:59,060 - INFO - [GC] Peforming periodical GC collection 0.04 seconds
[rank0]:2025-10-26 00:47:09,990 - INFO -  step: 1460  loss: -4.0000  grad_norm:  0.6255  memory: 14.89GiB(31.34%)  tps: 2,539  tflops: 19.85  mfu: 6.36%
[rank2]:2025-10-26 00:47:09,971 - INFO -  step: 1460  loss: -4.0000  grad_norm:  0.6255  memory:  7.25GiB(15.26%)  tps: 2,539  tflops: 19.85  mfu: 6.36%
[rank3]:2025-10-26 00:47:09,959 - INFO -  step: 1460  loss:  0.6486  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,539  tflops: 19.85  mfu: 6.36%
[rank1]:2025-10-26 00:47:09,974 - INFO -  step: 1460  loss: -4.0000  grad_norm:  0.6255  memory: 10.75GiB(22.62%)  tps: 2,539  tflops: 19.85  mfu: 6.36%
[rank3]:2025-10-26 00:47:11,414 - INFO - Avg. fwd time: 70.3795 / Avg. bwd time: 82.9140 / Avg. batch time: 1283.4602 (ms) / GPU bubble ratio: 4.45%
[rank2]:2025-10-26 00:47:11,481 - INFO - Avg. fwd time: 36.0448 / Avg. bwd time: 52.1336 / Avg. batch time: 1373.2752 (ms) / GPU bubble ratio: 48.63%
[rank1]:2025-10-26 00:47:11,556 - INFO - Avg. fwd time: 51.8322 / Avg. bwd time: 70.3112 / Avg. batch time: 1491.4493 (ms) / GPU bubble ratio: 34.48%
[rank0]:2025-10-26 00:47:11,634 - INFO - Avg. fwd time: 40.2014 / Avg. bwd time: 45.6008 / Avg. batch time: 1587.7198 (ms) / GPU bubble ratio: 56.77%
[rank0]:2025-10-26 00:49:19,068 - INFO -  step: 1480  loss: -4.0000  grad_norm:  0.6054  memory: 14.89GiB(31.34%)  tps: 2,539  tflops: 19.85  mfu: 6.36%
[rank2]:2025-10-26 00:49:19,045 - INFO -  step: 1480  loss: -4.0000  grad_norm:  0.6054  memory:  7.25GiB(15.26%)  tps: 2,539  tflops: 19.85  mfu: 6.36%
[rank3]:2025-10-26 00:49:19,033 - INFO -  step: 1480  loss:  0.6473  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,539  tflops: 19.85  mfu: 6.36%
[rank1]:2025-10-26 00:49:19,048 - INFO -  step: 1480  loss: -4.0000  grad_norm:  0.6054  memory: 10.75GiB(22.62%)  tps: 2,539  tflops: 19.85  mfu: 6.36%
[rank3]:2025-10-26 00:49:20,512 - INFO - Avg. fwd time: 70.3764 / Avg. bwd time: 82.8509 / Avg. batch time: 1282.9258 (ms) / GPU bubble ratio: 4.45%
[rank2]:2025-10-26 00:49:20,574 - INFO - Avg. fwd time: 36.0447 / Avg. bwd time: 52.1058 / Avg. batch time: 1372.7265 (ms) / GPU bubble ratio: 48.63%
[rank1]:2025-10-26 00:49:20,655 - INFO - Avg. fwd time: 51.8326 / Avg. bwd time: 70.2308 / Avg. batch time: 1490.8973 (ms) / GPU bubble ratio: 34.50%
[rank0]:2025-10-26 00:49:20,734 - INFO - Avg. fwd time: 40.2244 / Avg. bwd time: 45.8282 / Avg. batch time: 1587.2269 (ms) / GPU bubble ratio: 56.63%
[rank3]:2025-10-26 00:49:27,846 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-26 00:49:28,705 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-26 00:49:28,770 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-26 00:49:28,839 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-26 00:51:27,833 - INFO - [GC] Peforming periodical GC collection 0.04 seconds
[rank3]:2025-10-26 00:51:34,290 - INFO -  step: 1500  loss:  0.6563  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,423  tflops: 18.94  mfu: 6.07%
[rank3]:2025-10-26 00:51:34,291 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-26 00:51:34,305 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.6724  memory: 10.75GiB(22.62%)  tps: 2,423  tflops: 18.94  mfu: 6.07%
[rank1]:2025-10-26 00:51:34,305 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-26 00:51:34,320 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.6724  memory: 14.89GiB(31.34%)  tps: 2,423  tflops: 18.94  mfu: 6.07%
[rank0]:2025-10-26 00:51:34,320 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-26 00:51:34,322 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank2]:2025-10-26 00:51:34,302 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.6724  memory:  7.25GiB(15.26%)  tps: 2,423  tflops: 18.94  mfu: 6.07%
[rank2]:2025-10-26 00:51:34,302 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-26 00:51:36,132 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 1.83 seconds.
[rank1]:2025-10-26 00:51:36,572 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 2.27 seconds.
[rank3]:2025-10-26 00:51:37,517 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.23 seconds.
[rank0]:2025-10-26 00:51:37,853 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-26 00:51:37,860 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 3.54 seconds.
[rank0]:2025-10-26 00:51:37,861 - INFO - Checkpointer is deleting /data2/shcho/torchtitan/checkpoint/1023_1F1B_fullrand7_dm1/step-500.
[rank2]:2025-10-26 00:51:37,951 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251026_0051_stage2_step1500.svg
[rank1]:2025-10-26 00:51:37,953 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251026_0051_stage1_step1500.svg
[rank0]:2025-10-26 00:51:38,007 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251026_0051_stage0_step1500.svg
[rank3]:2025-10-26 00:51:38,303 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/pipeline_schedule/251026_0051_real_step1500_rank3.svg
[rank3]:> Batch Time: 1488.94 ms, GPU Bubble Ratio: 61.97%, 36.90%, 53.88%, 19.51%
[rank3]:2025-10-26 00:51:38,379 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251026_0051_stage3_step1500.svg
[rank3]:2025-10-26 00:51:39,685 - INFO - Avg. fwd time: 70.3708 / Avg. bwd time: 82.7884 / Avg. batch time: 1282.3780 (ms) / GPU bubble ratio: 4.45%
[rank2]:2025-10-26 00:51:39,747 - INFO - Avg. fwd time: 36.0438 / Avg. bwd time: 52.0784 / Avg. batch time: 1372.1770 (ms) / GPU bubble ratio: 48.62%
[rank1]:2025-10-26 00:51:39,835 - INFO - Avg. fwd time: 51.8285 / Avg. bwd time: 70.1497 / Avg. batch time: 1490.3411 (ms) / GPU bubble ratio: 34.52%
[rank0]:2025-10-26 00:51:39,906 - INFO - Avg. fwd time: 40.2453 / Avg. bwd time: 46.0499 / Avg. batch time: 1586.7236 (ms) / GPU bubble ratio: 56.49%
[rank0]:2025-10-26 00:51:39,979 - INFO - Checkpointer deleted /data2/shcho/torchtitan/checkpoint/1023_1F1B_fullrand7_dm1/step-500 in 2.12 seconds.
[rank3]:2025-10-26 00:53:47,355 - INFO -  step: 1520  loss:  0.6770  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,463  tflops: 19.25  mfu: 6.17%
[rank1]:2025-10-26 00:53:47,372 - INFO -  step: 1520  loss: -4.0000  grad_norm:  0.6176  memory: 10.75GiB(22.62%)  tps: 2,463  tflops: 19.25  mfu: 6.17%
[rank0]:2025-10-26 00:53:47,387 - INFO -  step: 1520  loss: -4.0000  grad_norm:  0.6176  memory: 14.89GiB(31.34%)  tps: 2,463  tflops: 19.25  mfu: 6.17%
[rank2]:2025-10-26 00:53:47,367 - INFO -  step: 1520  loss: -4.0000  grad_norm:  0.6176  memory:  7.25GiB(15.26%)  tps: 2,463  tflops: 19.25  mfu: 6.17%
[rank3]:2025-10-26 00:53:48,799 - INFO - Avg. fwd time: 70.3673 / Avg. bwd time: 82.7275 / Avg. batch time: 1281.8626 (ms) / GPU bubble ratio: 4.45%
[rank2]:2025-10-26 00:53:48,861 - INFO - Avg. fwd time: 36.0423 / Avg. bwd time: 52.0491 / Avg. batch time: 1371.6505 (ms) / GPU bubble ratio: 48.62%
[rank1]:2025-10-26 00:53:48,937 - INFO - Avg. fwd time: 51.8226 / Avg. bwd time: 70.0702 / Avg. batch time: 1489.8013 (ms) / GPU bubble ratio: 34.55%
[rank0]:2025-10-26 00:53:49,009 - INFO - Avg. fwd time: 40.2642 / Avg. bwd time: 46.2653 / Avg. batch time: 1586.2375 (ms) / GPU bubble ratio: 56.36%
[rank3]:2025-10-26 00:55:56,437 - INFO -  step: 1540  loss:  0.6420  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,539  tflops: 19.85  mfu: 6.36%
[rank1]:2025-10-26 00:55:56,452 - INFO -  step: 1540  loss: -4.0000  grad_norm:  0.6504  memory: 10.75GiB(22.62%)  tps: 2,539  tflops: 19.85  mfu: 6.36%
[rank0]:2025-10-26 00:55:56,466 - INFO -  step: 1540  loss: -4.0000  grad_norm:  0.6504  memory: 14.89GiB(31.34%)  tps: 2,539  tflops: 19.85  mfu: 6.36%
[rank2]:2025-10-26 00:55:56,449 - INFO -  step: 1540  loss: -4.0000  grad_norm:  0.6504  memory:  7.25GiB(15.26%)  tps: 2,539  tflops: 19.85  mfu: 6.36%
[rank3]:2025-10-26 00:55:57,909 - INFO - Avg. fwd time: 70.3646 / Avg. bwd time: 82.6701 / Avg. batch time: 1281.3788 (ms) / GPU bubble ratio: 4.46%
[rank2]:2025-10-26 00:55:57,973 - INFO - Avg. fwd time: 36.0416 / Avg. bwd time: 52.0177 / Avg. batch time: 1371.1434 (ms) / GPU bubble ratio: 48.62%
[rank1]:2025-10-26 00:55:58,048 - INFO - Avg. fwd time: 51.8193 / Avg. bwd time: 69.9966 / Avg. batch time: 1489.3056 (ms) / GPU bubble ratio: 34.57%
[rank0]:2025-10-26 00:55:58,120 - INFO - Avg. fwd time: 40.2836 / Avg. bwd time: 46.4731 / Avg. batch time: 1585.7803 (ms) / GPU bubble ratio: 56.23%
[rank0]:2025-10-26 00:56:54,921 - INFO - [GC] Peforming periodical GC collection 0.26 seconds
[rank3]:2025-10-26 00:58:05,931 - INFO -  step: 1560  loss:  0.6287  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,531  tflops: 19.78  mfu: 6.34%
[rank1]:2025-10-26 00:58:05,946 - INFO -  step: 1560  loss: -4.0000  grad_norm:  0.6986  memory: 10.75GiB(22.62%)  tps: 2,530  tflops: 19.78  mfu: 6.34%
[rank0]:2025-10-26 00:58:05,963 - INFO -  step: 1560  loss: -4.0000  grad_norm:  0.6986  memory: 14.89GiB(31.34%)  tps: 2,530  tflops: 19.78  mfu: 6.34%
[rank2]:2025-10-26 00:58:05,942 - INFO -  step: 1560  loss: -4.0000  grad_norm:  0.6986  memory:  7.25GiB(15.26%)  tps: 2,530  tflops: 19.78  mfu: 6.34%
[rank3]:2025-10-26 00:58:07,391 - INFO - Avg. fwd time: 70.3618 / Avg. bwd time: 82.6144 / Avg. batch time: 1280.9074 (ms) / GPU bubble ratio: 4.46%
[rank2]:2025-10-26 00:58:07,457 - INFO - Avg. fwd time: 36.0430 / Avg. bwd time: 51.9953 / Avg. batch time: 1370.6637 (ms) / GPU bubble ratio: 48.62%
[rank1]:2025-10-26 00:58:07,533 - INFO - Avg. fwd time: 51.8140 / Avg. bwd time: 69.9236 / Avg. batch time: 1488.8258 (ms) / GPU bubble ratio: 34.59%
[rank0]:2025-10-26 00:58:07,607 - INFO - Avg. fwd time: 40.3049 / Avg. bwd time: 46.6809 / Avg. batch time: 1585.3455 (ms) / GPU bubble ratio: 56.11%
[rank3]:2025-10-26 00:58:31,612 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-26 00:58:31,642 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-26 00:58:31,722 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-26 00:58:31,783 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-26 01:00:20,953 - INFO -  step: 1580  loss: -4.0000  grad_norm:  0.6370  memory:  7.25GiB(15.26%)  tps: 2,427  tflops: 18.97  mfu: 6.08%
[rank3]:2025-10-26 01:00:20,941 - INFO -  step: 1580  loss:  0.6333  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,427  tflops: 18.97  mfu: 6.08%
[rank1]:2025-10-26 01:00:20,957 - INFO -  step: 1580  loss: -4.0000  grad_norm:  0.6370  memory: 10.75GiB(22.62%)  tps: 2,427  tflops: 18.97  mfu: 6.08%
[rank0]:2025-10-26 01:00:20,971 - INFO -  step: 1580  loss: -4.0000  grad_norm:  0.6370  memory: 14.89GiB(31.34%)  tps: 2,427  tflops: 18.97  mfu: 6.08%
[rank3]:2025-10-26 01:00:22,409 - INFO - Avg. fwd time: 70.3542 / Avg. bwd time: 82.5576 / Avg. batch time: 1280.3894 (ms) / GPU bubble ratio: 4.46%
[rank2]:2025-10-26 01:00:22,473 - INFO - Avg. fwd time: 36.0404 / Avg. bwd time: 51.9660 / Avg. batch time: 1370.1255 (ms) / GPU bubble ratio: 48.61%
[rank1]:2025-10-26 01:00:22,551 - INFO - Avg. fwd time: 51.8109 / Avg. bwd time: 69.8555 / Avg. batch time: 1488.2787 (ms) / GPU bubble ratio: 34.60%
[rank0]:2025-10-26 01:00:22,630 - INFO - Avg. fwd time: 40.3226 / Avg. bwd time: 46.8817 / Avg. batch time: 1584.8638 (ms) / GPU bubble ratio: 55.98%
[rank0]:2025-10-26 01:02:23,486 - INFO - [GC] Peforming periodical GC collection 0.03 seconds
[rank1]:2025-10-26 01:02:29,897 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.6770  memory: 10.75GiB(22.62%)  tps: 2,541  tflops: 19.87  mfu: 6.37%
[rank2]:2025-10-26 01:02:29,892 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.6770  memory:  7.25GiB(15.26%)  tps: 2,541  tflops: 19.87  mfu: 6.37%
[rank3]:2025-10-26 01:02:29,881 - INFO -  step: 1600  loss:  0.6635  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,541  tflops: 19.87  mfu: 6.37%
[rank0]:2025-10-26 01:02:29,913 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.6770  memory: 14.89GiB(31.34%)  tps: 2,541  tflops: 19.87  mfu: 6.37%
[rank0]:2025-10-26 01:02:30,001 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251026_0102_stage0_step1600.svg
[rank2]:2025-10-26 01:02:30,000 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251026_0102_stage2_step1600.svg
[rank1]:2025-10-26 01:02:30,004 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251026_0102_stage1_step1600.svg
[rank3]:2025-10-26 01:02:30,155 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/pipeline_schedule/251026_0102_real_step1600_rank3.svg
[rank3]:> Batch Time: 1488.47 ms, GPU Bubble Ratio: 46.50%, 37.00%, 53.90%, 19.51%
[rank3]:2025-10-26 01:02:30,227 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251026_0102_stage3_step1600.svg
[rank3]:2025-10-26 01:02:31,542 - INFO - Avg. fwd time: 70.3495 / Avg. bwd time: 82.5027 / Avg. batch time: 1279.9101 (ms) / GPU bubble ratio: 4.46%
[rank2]:2025-10-26 01:02:31,604 - INFO - Avg. fwd time: 36.0382 / Avg. bwd time: 51.9377 / Avg. batch time: 1369.6448 (ms) / GPU bubble ratio: 48.61%
[rank1]:2025-10-26 01:02:31,683 - INFO - Avg. fwd time: 51.8060 / Avg. bwd time: 69.7844 / Avg. batch time: 1487.7931 (ms) / GPU bubble ratio: 34.62%
[rank0]:2025-10-26 01:02:31,758 - INFO - Avg. fwd time: 40.3384 / Avg. bwd time: 47.0756 / Avg. batch time: 1584.4222 (ms) / GPU bubble ratio: 55.86%
[rank2]:2025-10-26 01:04:39,505 - INFO -  step: 1620  loss: -4.0000  grad_norm:  0.6233  memory:  7.25GiB(15.26%)  tps: 2,528  tflops: 19.76  mfu: 6.33%
[rank3]:2025-10-26 01:04:39,493 - INFO -  step: 1620  loss:  0.6302  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,528  tflops: 19.76  mfu: 6.33%
[rank1]:2025-10-26 01:04:39,509 - INFO -  step: 1620  loss: -4.0000  grad_norm:  0.6233  memory: 10.75GiB(22.62%)  tps: 2,528  tflops: 19.76  mfu: 6.33%
[rank0]:2025-10-26 01:04:39,524 - INFO -  step: 1620  loss: -4.0000  grad_norm:  0.6233  memory: 14.89GiB(31.34%)  tps: 2,528  tflops: 19.76  mfu: 6.33%
[rank2]:2025-10-26 01:04:41,011 - INFO - Avg. fwd time: 36.0393 / Avg. bwd time: 51.9177 / Avg. batch time: 1369.2289 (ms) / GPU bubble ratio: 48.61%
[rank3]:2025-10-26 01:04:40,944 - INFO - Avg. fwd time: 70.3493 / Avg. bwd time: 82.4518 / Avg. batch time: 1279.4988 (ms) / GPU bubble ratio: 4.46%
[rank1]:2025-10-26 01:04:41,087 - INFO - Avg. fwd time: 51.7965 / Avg. bwd time: 69.7167 / Avg. batch time: 1487.3843 (ms) / GPU bubble ratio: 34.64%
[rank0]:2025-10-26 01:04:41,159 - INFO - Avg. fwd time: 40.3563 / Avg. bwd time: 47.2675 / Avg. batch time: 1584.0590 (ms) / GPU bubble ratio: 55.75%
[rank2]:2025-10-26 01:06:48,492 - INFO -  step: 1640  loss: -4.0000  grad_norm:  0.6153  memory:  7.25GiB(15.26%)  tps: 2,540  tflops: 19.86  mfu: 6.37%
[rank3]:2025-10-26 01:06:48,481 - INFO -  step: 1640  loss:  0.6091  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,540  tflops: 19.86  mfu: 6.37%
[rank0]:2025-10-26 01:06:48,510 - INFO -  step: 1640  loss: -4.0000  grad_norm:  0.6153  memory: 14.89GiB(31.34%)  tps: 2,540  tflops: 19.86  mfu: 6.37%
[rank1]:2025-10-26 01:06:48,496 - INFO -  step: 1640  loss: -4.0000  grad_norm:  0.6153  memory: 10.75GiB(22.62%)  tps: 2,540  tflops: 19.86  mfu: 6.37%
[rank3]:2025-10-26 01:06:49,944 - INFO - Avg. fwd time: 70.3466 / Avg. bwd time: 82.3993 / Avg. batch time: 1279.0540 (ms) / GPU bubble ratio: 4.46%
[rank2]:2025-10-26 01:06:50,010 - INFO - Avg. fwd time: 36.0398 / Avg. bwd time: 51.8931 / Avg. batch time: 1368.7598 (ms) / GPU bubble ratio: 48.61%
[rank1]:2025-10-26 01:06:50,087 - INFO - Avg. fwd time: 51.7995 / Avg. bwd time: 69.6535 / Avg. batch time: 1486.9368 (ms) / GPU bubble ratio: 34.66%
[rank0]:2025-10-26 01:06:50,165 - INFO - Avg. fwd time: 40.3738 / Avg. bwd time: 47.4515 / Avg. batch time: 1583.6443 (ms) / GPU bubble ratio: 55.63%
[rank3]:2025-10-26 01:07:27,799 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-26 01:07:28,642 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-26 01:07:28,778 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-26 01:07:28,711 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-26 01:07:49,030 - INFO - [GC] Peforming periodical GC collection 0.04 seconds
[rank3]:2025-10-26 01:09:00,052 - INFO -  step: 1660  loss:  0.6155  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,491  tflops: 19.47  mfu: 6.24%
[rank2]:2025-10-26 01:09:00,064 - INFO -  step: 1660  loss: -4.0000  grad_norm:  0.6412  memory:  7.25GiB(15.26%)  tps: 2,491  tflops: 19.47  mfu: 6.24%
[rank0]:2025-10-26 01:09:00,084 - INFO -  step: 1660  loss: -4.0000  grad_norm:  0.6412  memory: 14.89GiB(31.34%)  tps: 2,490  tflops: 19.47  mfu: 6.24%
[rank1]:2025-10-26 01:09:00,068 - INFO -  step: 1660  loss: -4.0000  grad_norm:  0.6412  memory: 10.75GiB(22.62%)  tps: 2,491  tflops: 19.47  mfu: 6.24%
[rank3]:2025-10-26 01:09:01,533 - INFO - Avg. fwd time: 70.3440 / Avg. bwd time: 82.3480 / Avg. batch time: 1278.6202 (ms) / GPU bubble ratio: 4.46%
[rank2]:2025-10-26 01:09:01,598 - INFO - Avg. fwd time: 36.0388 / Avg. bwd time: 51.8681 / Avg. batch time: 1368.3068 (ms) / GPU bubble ratio: 48.60%
[rank1]:2025-10-26 01:09:01,674 - INFO - Avg. fwd time: 51.7929 / Avg. bwd time: 69.5897 / Avg. batch time: 1486.4781 (ms) / GPU bubble ratio: 34.67%
[rank0]:2025-10-26 01:09:01,747 - INFO - Avg. fwd time: 40.3892 / Avg. bwd time: 47.6304 / Avg. batch time: 1583.3108 (ms) / GPU bubble ratio: 55.53%
[rank0]:2025-10-26 01:11:08,980 - INFO -  step: 1680  loss: -4.0000  grad_norm:  0.6669  memory: 14.89GiB(31.34%)  tps: 2,542  tflops: 19.87  mfu: 6.37%
[rank1]:2025-10-26 01:11:08,964 - INFO -  step: 1680  loss: -4.0000  grad_norm:  0.6669  memory: 10.75GiB(22.62%)  tps: 2,542  tflops: 19.87  mfu: 6.37%
[rank3]:2025-10-26 01:11:08,948 - INFO -  step: 1680  loss:  0.6352  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,542  tflops: 19.87  mfu: 6.37%
[rank2]:2025-10-26 01:11:08,960 - INFO -  step: 1680  loss: -4.0000  grad_norm:  0.6669  memory:  7.25GiB(15.26%)  tps: 2,542  tflops: 19.87  mfu: 6.37%
[rank3]:2025-10-26 01:11:10,414 - INFO - Avg. fwd time: 70.3400 / Avg. bwd time: 82.2971 / Avg. batch time: 1278.1777 (ms) / GPU bubble ratio: 4.47%
[rank2]:2025-10-26 01:11:10,485 - INFO - Avg. fwd time: 36.0379 / Avg. bwd time: 51.8466 / Avg. batch time: 1367.8521 (ms) / GPU bubble ratio: 48.60%
[rank1]:2025-10-26 01:11:10,565 - INFO - Avg. fwd time: 51.7810 / Avg. bwd time: 69.5179 / Avg. batch time: 1486.0142 (ms) / GPU bubble ratio: 34.70%
[rank0]:2025-10-26 01:11:10,637 - INFO - Avg. fwd time: 40.4060 / Avg. bwd time: 47.8076 / Avg. batch time: 1582.8866 (ms) / GPU bubble ratio: 55.42%
[rank0]:2025-10-26 01:13:11,650 - INFO - [GC] Peforming periodical GC collection 0.04 seconds
[rank2]:2025-10-26 01:13:18,116 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.6740  memory:  7.25GiB(15.26%)  tps: 2,537  tflops: 19.83  mfu: 6.36%
[rank1]:2025-10-26 01:13:18,120 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.6740  memory: 10.75GiB(22.62%)  tps: 2,537  tflops: 19.83  mfu: 6.36%
[rank0]:2025-10-26 01:13:18,131 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.6740  memory: 14.89GiB(31.34%)  tps: 2,537  tflops: 19.83  mfu: 6.36%
[rank3]:2025-10-26 01:13:18,105 - INFO -  step: 1700  loss:  0.6200  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,537  tflops: 19.83  mfu: 6.36%
[rank2]:2025-10-26 01:13:18,217 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251026_0113_stage2_step1700.svg
[rank1]:2025-10-26 01:13:18,218 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251026_0113_stage1_step1700.svg
[rank0]:2025-10-26 01:13:18,217 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251026_0113_stage0_step1700.svg
[rank3]:2025-10-26 01:13:18,376 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/pipeline_schedule/251026_0113_real_step1700_rank3.svg
[rank3]:> Batch Time: 1488.03 ms, GPU Bubble Ratio: 46.04%, 37.06%, 53.90%, 19.51%
[rank3]:2025-10-26 01:13:18,445 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251026_0113_stage3_step1700.svg
[rank3]:2025-10-26 01:13:19,744 - INFO - Avg. fwd time: 70.3381 / Avg. bwd time: 82.2470 / Avg. batch time: 1277.7593 (ms) / GPU bubble ratio: 4.47%
[rank2]:2025-10-26 01:13:19,807 - INFO - Avg. fwd time: 36.0385 / Avg. bwd time: 51.8232 / Avg. batch time: 1367.4376 (ms) / GPU bubble ratio: 48.60%
[rank1]:2025-10-26 01:13:19,896 - INFO - Avg. fwd time: 51.7816 / Avg. bwd time: 69.4569 / Avg. batch time: 1485.6039 (ms) / GPU bubble ratio: 34.71%
[rank0]:2025-10-26 01:13:19,972 - INFO - Avg. fwd time: 40.4203 / Avg. bwd time: 47.9791 / Avg. batch time: 1582.5156 (ms) / GPU bubble ratio: 55.31%
[rank1]:2025-10-26 01:15:27,929 - INFO -  step: 1720  loss: -4.0000  grad_norm:  0.6310  memory: 10.75GiB(22.62%)  tps: 2,524  tflops: 19.73  mfu: 6.32%
[rank3]:2025-10-26 01:15:27,914 - INFO -  step: 1720  loss:  0.6147  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,524  tflops: 19.73  mfu: 6.33%
[rank2]:2025-10-26 01:15:27,926 - INFO -  step: 1720  loss: -4.0000  grad_norm:  0.6310  memory:  7.25GiB(15.26%)  tps: 2,524  tflops: 19.73  mfu: 6.32%
[rank0]:2025-10-26 01:15:27,951 - INFO -  step: 1720  loss: -4.0000  grad_norm:  0.6310  memory: 14.89GiB(31.34%)  tps: 2,524  tflops: 19.73  mfu: 6.32%
[rank3]:2025-10-26 01:15:29,404 - INFO - Avg. fwd time: 70.3399 / Avg. bwd time: 82.2038 / Avg. batch time: 1277.4257 (ms) / GPU bubble ratio: 4.47%
[rank2]:2025-10-26 01:15:29,467 - INFO - Avg. fwd time: 36.0394 / Avg. bwd time: 51.8035 / Avg. batch time: 1367.0866 (ms) / GPU bubble ratio: 48.60%
[rank1]:2025-10-26 01:15:29,556 - INFO - Avg. fwd time: 51.7820 / Avg. bwd time: 69.3976 / Avg. batch time: 1485.2744 (ms) / GPU bubble ratio: 34.73%
[rank0]:2025-10-26 01:15:29,629 - INFO - Avg. fwd time: 40.4354 / Avg. bwd time: 48.1516 / Avg. batch time: 1582.2246 (ms) / GPU bubble ratio: 55.21%
[rank3]:2025-10-26 01:16:21,915 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-26 01:16:22,765 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-26 01:16:22,837 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-26 01:16:22,898 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-26 01:17:38,821 - INFO -  step: 1740  loss: -4.0000  grad_norm:  0.6832  memory: 14.89GiB(31.34%)  tps: 2,504  tflops: 19.57  mfu: 6.27%
[rank1]:2025-10-26 01:17:38,805 - INFO -  step: 1740  loss: -4.0000  grad_norm:  0.6832  memory: 10.75GiB(22.62%)  tps: 2,504  tflops: 19.57  mfu: 6.27%
[rank3]:2025-10-26 01:17:38,789 - INFO -  step: 1740  loss:  0.6256  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,504  tflops: 19.57  mfu: 6.27%
[rank2]:2025-10-26 01:17:38,802 - INFO -  step: 1740  loss: -4.0000  grad_norm:  0.6832  memory:  7.25GiB(15.26%)  tps: 2,504  tflops: 19.57  mfu: 6.27%
[rank3]:2025-10-26 01:17:40,258 - INFO - Avg. fwd time: 70.3371 / Avg. bwd time: 82.1577 / Avg. batch time: 1277.0303 (ms) / GPU bubble ratio: 4.47%
[rank2]:2025-10-26 01:17:40,322 - INFO - Avg. fwd time: 36.0398 / Avg. bwd time: 51.7795 / Avg. batch time: 1366.6716 (ms) / GPU bubble ratio: 48.59%
[rank1]:2025-10-26 01:17:40,414 - INFO - Avg. fwd time: 51.7783 / Avg. bwd time: 69.3389 / Avg. batch time: 1484.8597 (ms) / GPU bubble ratio: 34.75%
[rank0]:2025-10-26 01:17:40,487 - INFO - Avg. fwd time: 40.4504 / Avg. bwd time: 48.3159 / Avg. batch time: 1581.8480 (ms) / GPU bubble ratio: 55.11%
[rank0]:2025-10-26 01:18:37,026 - INFO - [GC] Peforming periodical GC collection 0.04 seconds
[rank3]:2025-10-26 01:19:47,898 - INFO -  step: 1760  loss:  0.6485  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,538  tflops: 19.84  mfu: 6.36%
[rank2]:2025-10-26 01:19:47,910 - INFO -  step: 1760  loss: -4.0000  grad_norm:  0.6657  memory:  7.25GiB(15.26%)  tps: 2,538  tflops: 19.84  mfu: 6.36%
[rank0]:2025-10-26 01:19:47,928 - INFO -  step: 1760  loss: -4.0000  grad_norm:  0.6657  memory: 14.89GiB(31.34%)  tps: 2,538  tflops: 19.84  mfu: 6.36%
[rank1]:2025-10-26 01:19:47,914 - INFO -  step: 1760  loss: -4.0000  grad_norm:  0.6657  memory: 10.75GiB(22.62%)  tps: 2,538  tflops: 19.84  mfu: 6.36%
[rank3]:2025-10-26 01:19:49,364 - INFO - Avg. fwd time: 70.3351 / Avg. bwd time: 82.1130 / Avg. batch time: 1276.6535 (ms) / GPU bubble ratio: 4.47%
[rank2]:2025-10-26 01:19:49,428 - INFO - Avg. fwd time: 36.0374 / Avg. bwd time: 51.7578 / Avg. batch time: 1366.2759 (ms) / GPU bubble ratio: 48.59%
[rank0]:2025-10-26 01:19:49,590 - INFO - Avg. fwd time: 40.4627 / Avg. bwd time: 48.4733 / Avg. batch time: 1581.4791 (ms) / GPU bubble ratio: 55.01%
[rank1]:2025-10-26 01:19:49,509 - INFO - Avg. fwd time: 51.7712 / Avg. bwd time: 69.2793 / Avg. batch time: 1484.4574 (ms) / GPU bubble ratio: 34.76%
[rank3]:2025-10-26 01:21:56,854 - INFO -  step: 1780  loss:  0.6213  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,541  tflops: 19.86  mfu: 6.37%
[rank1]:2025-10-26 01:21:56,869 - INFO -  step: 1780  loss: -4.0000  grad_norm:  0.7360  memory: 10.75GiB(22.62%)  tps: 2,541  tflops: 19.86  mfu: 6.37%
[rank2]:2025-10-26 01:21:56,866 - INFO -  step: 1780  loss: -4.0000  grad_norm:  0.7360  memory:  7.25GiB(15.26%)  tps: 2,541  tflops: 19.86  mfu: 6.37%
[rank0]:2025-10-26 01:21:56,890 - INFO -  step: 1780  loss: -4.0000  grad_norm:  0.7360  memory: 14.89GiB(31.34%)  tps: 2,541  tflops: 19.86  mfu: 6.37%
[rank3]:2025-10-26 01:21:58,332 - INFO - Avg. fwd time: 70.3302 / Avg. bwd time: 82.0680 / Avg. batch time: 1276.2524 (ms) / GPU bubble ratio: 4.47%
[rank2]:2025-10-26 01:21:58,402 - INFO - Avg. fwd time: 36.0359 / Avg. bwd time: 51.7367 / Avg. batch time: 1365.8547 (ms) / GPU bubble ratio: 48.59%
[rank1]:2025-10-26 01:21:58,493 - INFO - Avg. fwd time: 51.7659 / Avg. bwd time: 69.2309 / Avg. batch time: 1484.0538 (ms) / GPU bubble ratio: 34.77%
[rank0]:2025-10-26 01:21:58,566 - INFO - Avg. fwd time: 40.4764 / Avg. bwd time: 48.6285 / Avg. batch time: 1581.1057 (ms) / GPU bubble ratio: 54.92%
[rank0]:2025-10-26 01:23:59,623 - INFO - [GC] Peforming periodical GC collection 0.03 seconds
[rank3]:2025-10-26 01:24:06,128 - INFO -  step: 1800  loss:  0.6055  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,535  tflops: 19.82  mfu: 6.35%
[rank1]:2025-10-26 01:24:06,144 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.6270  memory: 10.75GiB(22.62%)  tps: 2,535  tflops: 19.82  mfu: 6.35%
[rank0]:2025-10-26 01:24:06,156 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.6270  memory: 14.89GiB(31.34%)  tps: 2,535  tflops: 19.82  mfu: 6.35%
[rank2]:2025-10-26 01:24:06,140 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.6270  memory:  7.25GiB(15.26%)  tps: 2,535  tflops: 19.82  mfu: 6.35%
[rank1]:2025-10-26 01:24:06,243 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251026_0124_stage1_step1800.svg
[rank0]:2025-10-26 01:24:06,244 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251026_0124_stage0_step1800.svg
[rank2]:2025-10-26 01:24:06,244 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251026_0124_stage2_step1800.svg
[rank3]:2025-10-26 01:24:06,392 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/pipeline_schedule/251026_0124_real_step1800_rank3.svg
[rank3]:> Batch Time: 1487.84 ms, GPU Bubble Ratio: 45.83%, 37.12%, 53.92%, 19.52%
[rank3]:2025-10-26 01:24:06,460 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251026_0124_stage3_step1800.svg
[rank3]:2025-10-26 01:24:07,807 - INFO - Avg. fwd time: 70.3291 / Avg. bwd time: 82.0253 / Avg. batch time: 1275.8987 (ms) / GPU bubble ratio: 4.47%
[rank2]:2025-10-26 01:24:07,870 - INFO - Avg. fwd time: 36.0356 / Avg. bwd time: 51.7164 / Avg. batch time: 1365.4995 (ms) / GPU bubble ratio: 48.59%
[rank1]:2025-10-26 01:24:07,949 - INFO - Avg. fwd time: 51.7612 / Avg. bwd time: 69.1792 / Avg. batch time: 1483.7127 (ms) / GPU bubble ratio: 34.79%
[rank0]:2025-10-26 01:24:08,021 - INFO - Avg. fwd time: 40.4898 / Avg. bwd time: 48.7809 / Avg. batch time: 1580.7978 (ms) / GPU bubble ratio: 54.82%
[rank3]:2025-10-26 01:25:14,742 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-26 01:25:15,591 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-26 01:25:15,670 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-26 01:25:15,728 - WARNING - Dataset alpaca is being re-looped
[rank3]:2025-10-26 01:26:17,396 - INFO -  step: 1820  loss:  0.6093  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,496  tflops: 19.51  mfu: 6.25%
[rank0]:2025-10-26 01:26:17,425 - INFO -  step: 1820  loss: -4.0000  grad_norm:  0.6766  memory: 14.89GiB(31.34%)  tps: 2,496  tflops: 19.51  mfu: 6.25%
[rank2]:2025-10-26 01:26:17,408 - INFO -  step: 1820  loss: -4.0000  grad_norm:  0.6766  memory:  7.25GiB(15.26%)  tps: 2,496  tflops: 19.51  mfu: 6.25%
[rank1]:2025-10-26 01:26:17,411 - INFO -  step: 1820  loss: -4.0000  grad_norm:  0.6766  memory: 10.75GiB(22.62%)  tps: 2,496  tflops: 19.51  mfu: 6.25%
[rank3]:2025-10-26 01:26:18,854 - INFO - Avg. fwd time: 70.3252 / Avg. bwd time: 81.9821 / Avg. batch time: 1275.5196 (ms) / GPU bubble ratio: 4.47%
[rank2]:2025-10-26 01:26:18,925 - INFO - Avg. fwd time: 36.0340 / Avg. bwd time: 51.6943 / Avg. batch time: 1365.1016 (ms) / GPU bubble ratio: 48.59%
[rank1]:2025-10-26 01:26:19,002 - INFO - Avg. fwd time: 51.7612 / Avg. bwd time: 69.1256 / Avg. batch time: 1483.3271 (ms) / GPU bubble ratio: 34.80%
[rank0]:2025-10-26 01:26:19,080 - INFO - Avg. fwd time: 40.5027 / Avg. bwd time: 48.9328 / Avg. batch time: 1580.4481 (ms) / GPU bubble ratio: 54.73%
[rank3]:2025-10-26 01:28:26,449 - INFO -  step: 1840  loss:  0.6333  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,539  tflops: 19.85  mfu: 6.36%
[rank2]:2025-10-26 01:28:26,461 - INFO -  step: 1840  loss: -4.0000  grad_norm:  0.7948  memory:  7.25GiB(15.26%)  tps: 2,539  tflops: 19.85  mfu: 6.36%
[rank0]:2025-10-26 01:28:26,481 - INFO -  step: 1840  loss: -4.0000  grad_norm:  0.7948  memory: 14.89GiB(31.34%)  tps: 2,539  tflops: 19.85  mfu: 6.36%
[rank1]:2025-10-26 01:28:26,464 - INFO -  step: 1840  loss: -4.0000  grad_norm:  0.7948  memory: 10.75GiB(22.62%)  tps: 2,539  tflops: 19.85  mfu: 6.36%
[rank3]:2025-10-26 01:28:27,925 - INFO - Avg. fwd time: 70.3230 / Avg. bwd time: 81.9417 / Avg. batch time: 1275.1776 (ms) / GPU bubble ratio: 4.47%
[rank2]:2025-10-26 01:28:27,990 - INFO - Avg. fwd time: 36.0334 / Avg. bwd time: 51.6739 / Avg. batch time: 1364.7496 (ms) / GPU bubble ratio: 48.59%
[rank1]:2025-10-26 01:28:28,079 - INFO - Avg. fwd time: 51.7570 / Avg. bwd time: 69.0668 / Avg. batch time: 1482.9681 (ms) / GPU bubble ratio: 34.82%
[rank0]:2025-10-26 01:28:28,157 - INFO - Avg. fwd time: 40.5212 / Avg. bwd time: 49.0844 / Avg. batch time: 1580.1312 (ms) / GPU bubble ratio: 54.63%
[rank0]:2025-10-26 01:29:24,702 - INFO - [GC] Peforming periodical GC collection 0.04 seconds
[rank3]:2025-10-26 01:30:35,538 - INFO -  step: 1860  loss:  0.6448  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,538  tflops: 19.84  mfu: 6.36%
[rank2]:2025-10-26 01:30:35,550 - INFO -  step: 1860  loss: -4.0000  grad_norm:  0.6698  memory:  7.25GiB(15.26%)  tps: 2,538  tflops: 19.84  mfu: 6.36%
[rank0]:2025-10-26 01:30:35,571 - INFO -  step: 1860  loss: -4.0000  grad_norm:  0.6698  memory: 14.89GiB(31.34%)  tps: 2,538  tflops: 19.84  mfu: 6.36%
[rank1]:2025-10-26 01:30:35,554 - INFO -  step: 1860  loss: -4.0000  grad_norm:  0.6698  memory: 10.75GiB(22.62%)  tps: 2,538  tflops: 19.84  mfu: 6.36%
[rank3]:2025-10-26 01:30:36,998 - INFO - Avg. fwd time: 70.3206 / Avg. bwd time: 81.8989 / Avg. batch time: 1274.8134 (ms) / GPU bubble ratio: 4.48%
[rank2]:2025-10-26 01:30:37,071 - INFO - Avg. fwd time: 36.0329 / Avg. bwd time: 51.6544 / Avg. batch time: 1364.3791 (ms) / GPU bubble ratio: 48.58%
[rank1]:2025-10-26 01:30:37,149 - INFO - Avg. fwd time: 51.7588 / Avg. bwd time: 69.0176 / Avg. batch time: 1482.6057 (ms) / GPU bubble ratio: 34.83%
[rank0]:2025-10-26 01:30:37,230 - INFO - Avg. fwd time: 40.5355 / Avg. bwd time: 49.2305 / Avg. batch time: 1579.8032 (ms) / GPU bubble ratio: 54.54%
[rank3]:2025-10-26 01:32:44,382 - INFO -  step: 1880  loss:  0.6258  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,543  tflops: 19.88  mfu: 6.37%
[rank2]:2025-10-26 01:32:44,394 - INFO -  step: 1880  loss: -4.0000  grad_norm:  0.6682  memory:  7.25GiB(15.26%)  tps: 2,543  tflops: 19.88  mfu: 6.37%
[rank0]:2025-10-26 01:32:44,410 - INFO -  step: 1880  loss: -4.0000  grad_norm:  0.6682  memory: 14.89GiB(31.34%)  tps: 2,543  tflops: 19.88  mfu: 6.37%
[rank1]:2025-10-26 01:32:44,398 - INFO -  step: 1880  loss: -4.0000  grad_norm:  0.6682  memory: 10.75GiB(22.62%)  tps: 2,543  tflops: 19.88  mfu: 6.37%
[rank3]:2025-10-26 01:32:45,844 - INFO - Avg. fwd time: 70.3169 / Avg. bwd time: 81.8579 / Avg. batch time: 1274.4547 (ms) / GPU bubble ratio: 4.48%
[rank2]:2025-10-26 01:32:45,909 - INFO - Avg. fwd time: 36.0312 / Avg. bwd time: 51.6316 / Avg. batch time: 1364.0012 (ms) / GPU bubble ratio: 48.58%
[rank1]:2025-10-26 01:32:46,002 - INFO - Avg. fwd time: 51.7556 / Avg. bwd time: 68.9696 / Avg. batch time: 1482.2314 (ms) / GPU bubble ratio: 34.84%
[rank0]:2025-10-26 01:32:46,076 - INFO - Avg. fwd time: 40.5467 / Avg. bwd time: 49.3696 / Avg. batch time: 1579.4529 (ms) / GPU bubble ratio: 54.46%
[rank3]:2025-10-26 01:34:09,002 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-26 01:34:09,849 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-26 01:34:09,920 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-26 01:34:09,985 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-26 01:34:49,116 - INFO - [GC] Peforming periodical GC collection 0.03 seconds
[rank3]:2025-10-26 01:34:55,592 - INFO -  step: 1900  loss:  0.5929  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,497  tflops: 19.52  mfu: 6.26%
[rank2]:2025-10-26 01:34:55,604 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.6164  memory:  7.25GiB(15.26%)  tps: 2,497  tflops: 19.52  mfu: 6.26%
[rank1]:2025-10-26 01:34:55,607 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.6164  memory: 10.75GiB(22.62%)  tps: 2,497  tflops: 19.52  mfu: 6.26%
[rank0]:2025-10-26 01:34:55,623 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.6164  memory: 14.89GiB(31.34%)  tps: 2,497  tflops: 19.52  mfu: 6.26%
[rank1]:2025-10-26 01:34:55,710 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251026_0134_stage1_step1900.svg
[rank0]:2025-10-26 01:34:55,713 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251026_0134_stage0_step1900.svg
[rank2]:2025-10-26 01:34:55,711 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251026_0134_stage2_step1900.svg
[rank3]:2025-10-26 01:34:55,856 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/pipeline_schedule/251026_0134_real_step1900_rank3.svg
[rank3]:> Batch Time: 1487.75 ms, GPU Bubble Ratio: 45.62%, 37.20%, 53.93%, 19.52%
[rank3]:2025-10-26 01:34:55,923 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251026_0134_stage3_step1900.svg
[rank3]:2025-10-26 01:34:57,223 - INFO - Avg. fwd time: 70.3161 / Avg. bwd time: 81.8196 / Avg. batch time: 1274.1399 (ms) / GPU bubble ratio: 4.48%
[rank2]:2025-10-26 01:34:57,286 - INFO - Avg. fwd time: 36.0304 / Avg. bwd time: 51.6113 / Avg. batch time: 1363.6817 (ms) / GPU bubble ratio: 48.59%
[rank1]:2025-10-26 01:34:57,371 - INFO - Avg. fwd time: 51.7502 / Avg. bwd time: 68.9178 / Avg. batch time: 1481.9098 (ms) / GPU bubble ratio: 34.86%
[rank0]:2025-10-26 01:34:57,452 - INFO - Avg. fwd time: 40.5586 / Avg. bwd time: 49.5076 / Avg. batch time: 1579.1621 (ms) / GPU bubble ratio: 54.37%
[rank3]:2025-10-26 01:37:05,003 - INFO -  step: 1920  loss:  0.6236  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,532  tflops: 19.79  mfu: 6.34%
[rank0]:2025-10-26 01:37:05,035 - INFO -  step: 1920  loss: -4.0000  grad_norm:  0.7580  memory: 14.89GiB(31.34%)  tps: 2,532  tflops: 19.79  mfu: 6.34%
[rank2]:2025-10-26 01:37:05,015 - INFO -  step: 1920  loss: -4.0000  grad_norm:  0.7580  memory:  7.25GiB(15.26%)  tps: 2,532  tflops: 19.79  mfu: 6.34%
[rank1]:2025-10-26 01:37:05,019 - INFO -  step: 1920  loss: -4.0000  grad_norm:  0.7580  memory: 10.75GiB(22.62%)  tps: 2,532  tflops: 19.79  mfu: 6.34%
[rank3]:2025-10-26 01:37:06,483 - INFO - Avg. fwd time: 70.3150 / Avg. bwd time: 81.7835 / Avg. batch time: 1273.8402 (ms) / GPU bubble ratio: 4.48%
[rank2]:2025-10-26 01:37:06,555 - INFO - Avg. fwd time: 36.0300 / Avg. bwd time: 51.5945 / Avg. batch time: 1363.3731 (ms) / GPU bubble ratio: 48.58%
[rank1]:2025-10-26 01:37:06,633 - INFO - Avg. fwd time: 51.7477 / Avg. bwd time: 68.8680 / Avg. batch time: 1481.6022 (ms) / GPU bubble ratio: 34.87%
[rank0]:2025-10-26 01:37:06,713 - INFO - Avg. fwd time: 40.5705 / Avg. bwd time: 49.6427 / Avg. batch time: 1578.8843 (ms) / GPU bubble ratio: 54.29%
[rank3]:2025-10-26 01:39:14,513 - INFO -  step: 1940  loss:  0.6008  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,530  tflops: 19.78  mfu: 6.34%
[rank2]:2025-10-26 01:39:14,524 - INFO -  step: 1940  loss: -4.0000  grad_norm:  0.6808  memory:  7.25GiB(15.26%)  tps: 2,530  tflops: 19.78  mfu: 6.34%
[rank0]:2025-10-26 01:39:14,545 - INFO -  step: 1940  loss: -4.0000  grad_norm:  0.6808  memory: 14.89GiB(31.34%)  tps: 2,530  tflops: 19.78  mfu: 6.34%
[rank1]:2025-10-26 01:39:14,528 - INFO -  step: 1940  loss: -4.0000  grad_norm:  0.6808  memory: 10.75GiB(22.62%)  tps: 2,530  tflops: 19.78  mfu: 6.34%
[rank3]:2025-10-26 01:39:16,007 - INFO - Avg. fwd time: 70.3167 / Avg. bwd time: 81.7497 / Avg. batch time: 1273.5805 (ms) / GPU bubble ratio: 4.48%
[rank2]:2025-10-26 01:39:16,072 - INFO - Avg. fwd time: 36.0298 / Avg. bwd time: 51.5752 / Avg. batch time: 1363.0964 (ms) / GPU bubble ratio: 48.58%
[rank1]:2025-10-26 01:39:16,154 - INFO - Avg. fwd time: 51.7478 / Avg. bwd time: 68.8214 / Avg. batch time: 1481.3344 (ms) / GPU bubble ratio: 34.89%
[rank0]:2025-10-26 01:39:16,234 - INFO - Avg. fwd time: 40.5840 / Avg. bwd time: 49.7778 / Avg. batch time: 1578.6433 (ms) / GPU bubble ratio: 54.21%
[rank0]:2025-10-26 01:40:12,665 - INFO - [GC] Peforming periodical GC collection 0.04 seconds
[rank3]:2025-10-26 01:41:23,480 - INFO -  step: 1960  loss:  0.6385  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,541  tflops: 19.86  mfu: 6.37%
[rank2]:2025-10-26 01:41:23,492 - INFO -  step: 1960  loss: -4.0000  grad_norm:  0.6808  memory:  7.25GiB(15.26%)  tps: 2,541  tflops: 19.86  mfu: 6.37%
[rank0]:2025-10-26 01:41:23,507 - INFO -  step: 1960  loss: -4.0000  grad_norm:  0.6808  memory: 14.89GiB(31.34%)  tps: 2,541  tflops: 19.86  mfu: 6.37%
[rank1]:2025-10-26 01:41:23,496 - INFO -  step: 1960  loss: -4.0000  grad_norm:  0.6808  memory: 10.75GiB(22.62%)  tps: 2,541  tflops: 19.86  mfu: 6.37%
[rank3]:2025-10-26 01:41:24,963 - INFO - Avg. fwd time: 70.3147 / Avg. bwd time: 81.7123 / Avg. batch time: 1273.2628 (ms) / GPU bubble ratio: 4.48%
[rank2]:2025-10-26 01:41:25,028 - INFO - Avg. fwd time: 36.0281 / Avg. bwd time: 51.5561 / Avg. batch time: 1362.7597 (ms) / GPU bubble ratio: 48.58%
[rank1]:2025-10-26 01:41:25,117 - INFO - Avg. fwd time: 51.7445 / Avg. bwd time: 68.7693 / Avg. batch time: 1480.9956 (ms) / GPU bubble ratio: 34.90%
[rank0]:2025-10-26 01:41:25,216 - INFO - Avg. fwd time: 40.5953 / Avg. bwd time: 49.9083 / Avg. batch time: 1578.3321 (ms) / GPU bubble ratio: 54.13%
[rank3]:2025-10-26 01:43:02,819 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-26 01:43:03,683 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-26 01:43:03,753 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-26 01:43:03,818 - WARNING - Dataset alpaca is being re-looped
[rank3]:2025-10-26 01:43:34,754 - INFO -  step: 1980  loss:  0.5979  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,496  tflops: 19.51  mfu: 6.25%
[rank0]:2025-10-26 01:43:34,787 - INFO -  step: 1980  loss: -4.0000  grad_norm:  0.6511  memory: 14.89GiB(31.34%)  tps: 2,496  tflops: 19.51  mfu: 6.25%
[rank2]:2025-10-26 01:43:34,766 - INFO -  step: 1980  loss: -4.0000  grad_norm:  0.6511  memory:  7.25GiB(15.26%)  tps: 2,496  tflops: 19.51  mfu: 6.25%
[rank1]:2025-10-26 01:43:34,769 - INFO -  step: 1980  loss: -4.0000  grad_norm:  0.6511  memory: 10.75GiB(22.62%)  tps: 2,496  tflops: 19.51  mfu: 6.25%
[rank3]:2025-10-26 01:43:36,239 - INFO - Avg. fwd time: 70.3137 / Avg. bwd time: 81.6798 / Avg. batch time: 1272.9919 (ms) / GPU bubble ratio: 4.48%
[rank2]:2025-10-26 01:43:36,304 - INFO - Avg. fwd time: 36.0262 / Avg. bwd time: 51.5367 / Avg. batch time: 1362.4776 (ms) / GPU bubble ratio: 48.59%
[rank1]:2025-10-26 01:43:36,388 - INFO - Avg. fwd time: 51.7409 / Avg. bwd time: 68.7211 / Avg. batch time: 1480.7161 (ms) / GPU bubble ratio: 34.92%
[rank0]:2025-10-26 01:43:36,462 - INFO - Avg. fwd time: 40.6044 / Avg. bwd time: 50.0345 / Avg. batch time: 1578.0788 (ms) / GPU bubble ratio: 54.05%
[rank0]:2025-10-26 01:45:37,825 - INFO - [GC] Peforming periodical GC collection 0.04 seconds
[rank1]:2025-10-26 01:45:44,371 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.6954  memory: 10.75GiB(22.62%)  tps: 2,528  tflops: 19.77  mfu: 6.34%
[rank1]:2025-10-26 01:45:44,372 - INFO -  final step: 2000  loss: -4.0000  grad_norm:  0.6954  tps: 2,506  tflops: 19.59  mfu: 6.21%
[rank1]:2025-10-26 01:45:44,372 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-26 01:45:44,373 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2000.
[rank2]:2025-10-26 01:45:44,368 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.6954  memory:  7.25GiB(15.26%)  tps: 2,528  tflops: 19.77  mfu: 6.34%
[rank2]:2025-10-26 01:45:44,368 - INFO -  final step: 2000  loss: -4.0000  grad_norm:  0.6954  tps: 2,506  tflops: 19.59  mfu: 6.21%
[rank2]:2025-10-26 01:45:44,368 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-26 01:45:44,370 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2000.
[rank3]:2025-10-26 01:45:44,356 - INFO -  step: 2000  loss:  0.6134  grad_norm:  0.0000  memory: 24.67GiB(51.93%)  tps: 2,528  tflops: 19.77  mfu: 6.34%
[rank3]:2025-10-26 01:45:44,357 - INFO -  final step: 2000  loss:  0.6134  grad_norm:  0.0000  tps: 2,506  tflops: 19.59  mfu: 6.21%
[rank3]:2025-10-26 01:45:44,357 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-26 01:45:44,359 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2000.
[rank0]:2025-10-26 01:45:44,387 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.6954  memory: 14.89GiB(31.34%)  tps: 2,528  tflops: 19.77  mfu: 6.34%
[rank0]:2025-10-26 01:45:44,387 - INFO -  final step: 2000  loss: -4.0000  grad_norm:  0.6954  tps: 2,506  tflops: 19.59  mfu: 6.21%
[rank0]:2025-10-26 01:45:44,387 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-26 01:45:44,389 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2000.
[rank0]:2025-10-26 01:45:47,354 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank2]:2025-10-26 01:45:47,449 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251026_0145_stage2_final2000.svg
[rank0]:2025-10-26 01:45:47,450 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251026_0145_stage0_final2000.svg
[rank1]:2025-10-26 01:45:47,449 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251026_0145_stage1_final2000.svg
[rank3]:2025-10-26 01:45:47,607 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/pipeline_schedule/251026_0145_real_final2000_rank3.svg
[rank3]:> Batch Time: 1487.66 ms, GPU Bubble Ratio: 45.44%, 37.27%, 53.94%, 19.53%
[rank0]:2025-10-26 01:45:47,666 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/frozen_params_histogram/251026_0145_rank0_stage0.svg
[rank0]:	> Counts Sum: 2132300, Total Sum: 2249600 (94.79%), Ratio(%) per element: [94.76, 94.76, 94.76, 94.76, 94.76, 94.76, 94.76, 94.76, 94.8, 94.76, 94.76, 94.76, 94.76, 94.76, 94.76, 94.76, 94.76, 94.8, 94.8, 94.8, 94.8, 94.76, 94.76, 94.76, 94.76, 94.8, 94.76, 94.76, 94.8, 94.8, 94.8, 94.8, 94.8, 94.83, 94.83, 94.83, 94.8]
[rank0]:2025-10-26 01:45:47,666 - INFO - Sleeping 2 seconds for other ranks to complete
[rank1]:2025-10-26 01:45:47,650 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/frozen_params_histogram/251026_0145_rank1_stage1.svg
[rank1]:	> Counts Sum: 2449340, Total Sum: 2736000 (89.52%), Ratio(%) per element: [89.53, 89.5, 89.5, 89.5, 89.53, 89.53, 89.5, 89.5, 89.5, 89.5, 89.5, 89.53, 89.5, 89.53, 89.5, 89.53, 89.53, 89.5, 89.57, 89.53, 89.5, 89.5, 89.53, 89.5, 89.53, 89.53, 89.53, 89.5, 89.5, 89.5, 89.5, 89.5, 89.5, 89.53, 89.53, 89.53, 89.5, 89.53, 89.53, 89.5, 89.5, 89.53, 89.53, 89.5, 89.53]
[rank1]:2025-10-26 01:45:47,650 - INFO - Destroying the purge thread.
[rank2]:2025-10-26 01:45:47,661 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/frozen_params_histogram/251026_0145_rank2_stage2.svg
[rank2]:	> Counts Sum: 1959480, Total Sum: 2188800 (89.52%), Ratio(%) per element: [89.53, 89.53, 89.5, 89.53, 89.53, 89.53, 89.57, 89.5, 89.5, 89.5, 89.53, 89.5, 89.5, 89.5, 89.5, 89.53, 89.53, 89.53, 89.5, 89.5, 89.53, 89.5, 89.53, 89.5, 89.5, 89.53, 89.53, 89.5, 89.53, 89.5, 89.5, 89.53, 89.5, 89.5, 89.53, 89.5]
[rank2]:2025-10-26 01:45:47,662 - INFO - Destroying the purge thread.
[rank2]:2025-10-26 01:45:47,723 - INFO - Process group destroyed
[rank3]:2025-10-26 01:45:47,844 - INFO - Pipeline schedule is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/pipeline_schedule/251026_0145_thry_final2000_rank3.svg
[rank3]:> Batch Time: 1650.26 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:2025-10-26 01:45:47,917 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251026_0145_stage3_final2000.svg
[rank3]:2025-10-26 01:45:48,114 - INFO - Elementwise Histogram is saved as: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1/frozen_params_histogram/251026_0145_rank3_stage3.svg
[rank3]:	> Counts Sum: 2560, Total Sum: 1763200 (0.15%), Ratio(%) per element: [0.19, 0.16, 0.13, 0.13, 0.16, 0.23, 0.16, 0.16, 0.13, 0.19, 0.19, 0.13, 0.16, 0.13, 0.09, 0.13, 0.16, 0.13, 0.13, 0.13, 0.09, 0.13, 0.13, 0.09, 0.16, 0.16, 0.09, 0.13, 0.09]
[rank3]:2025-10-26 01:45:48,115 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank1]:2025-10-26 01:45:48,842 - INFO - Process group destroyed
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–„â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–„â–„â–„â–„â–„â–„â–ƒâ–ƒâ–„â–ƒâ–ƒâ–ƒâ–ƒâ–‚â–‚â–ƒâ–ƒâ–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–‡â–†â–†â–†â–…â–…â–…â–…â–…â–„â–„â–ƒâ–„â–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–‚â–ƒâ–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–â–â–‚â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 6.5367
[rank3]:wandb:               final/avg_loss 0.61336
[rank3]:wandb:             final/avg_mfu(%) 6.2085
[rank3]:wandb:             final/avg_tflops 19.59437
[rank3]:wandb:    final/avg_throughput(tps) 2506.463
[rank3]:wandb:              final/grad_norm 0
[rank3]:wandb:               final/max_loss 0.61336
[rank3]:wandb:                    grad_norm 0
[rank3]:wandb: loss_metrics/global_avg_loss 0.61336
[rank3]:wandb: loss_metrics/global_max_loss 0.61336
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1023_1F1B_fullrand7_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/xr68nj0c
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: /data2/shcho/torchtitan/tb/1023_1F1B_fullrand7_dm1/20251025-2205/wandb/run-20251025_220538-xr68nj0c/logs
[rank3]:2025-10-26 01:45:49,193 - INFO - Process group destroyed
[rank0]:2025-10-26 01:45:49,666 - INFO - Training completed
[rank0]:2025-10-26 01:45:49,667 - INFO - Destroying the purge thread.
[rank0]:2025-10-26 01:45:50,626 - INFO - Process group destroyed
[rank0]:Stage 0: Modules to keep: {'layers.3', 'layers.1', 'layers.0', 'layers.2', 'tok_embeddings'}
[rank1]:Stage 1: Modules to keep: {'layers.5', 'layers.7', 'layers.6', 'layers.4', 'layers.8'}
[rank2]:Stage 2: Modules to keep: {'layers.12', 'layers.10', 'layers.9', 'layers.11'}
[rank3]:Stage 3: Modules to keep: {'norm', 'layers.14', 'layers.13', 'output', 'layers.15'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /home/shcho/torchtitan/logs/dmserver1/1022_llama1binstruct/config.toml
[rank3]:		- dump_folder: /data2/shcho/torchtitan
[rank3]:		- description: "Main Table Experiment"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1023_1F1B_fullrand7_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/profile_trace/1023_1F1B_fullrand7_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /data2/shcho/torchtitan/memory_snapshot/1023_1F1B_fullrand7_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 20
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /data2/shcho/torchtitan/tb/1023_1F1B_fullrand7_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /data2/shcho/torchtitan/images/1023_1F1B_fullrand7_dm1
[rank3]:		- pplog_freq: 80
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1023_1F1B_fullrand7_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 1B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.2-1B-Instruct
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 1e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: alpaca
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 2000
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: 1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /data2/shcho/torchtitan/checkpoint/1023_1F1B_fullrand7_dm1
[rank3]:		- interval: 500
[rank3]:		- initial_load_path: /data2/shcho/torchtitan/base_model/Llama-3.2-1B-Instruct/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /data2/shcho/torchtitan/comm_traces/1023_1F1B_fullrand7_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 8
[rank3]:		- seq_len: 2048
[rank3]:		- freq: 10
[rank3]:		- steps: -1
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: fullrand7
[rank3]:		- phase_unit: 10
[rank3]:		- stability_check_freq: 5
[rank3]:		- aggressiveness: 0
[rank3]:
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
