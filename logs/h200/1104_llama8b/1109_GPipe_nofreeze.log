
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: Sun Nov  9 13:56:41 UTC 2025
âœ”ï¸SERVER: wbl-kaist-gpu-2 (172.16.131.118),  GPUs: 0,1,2,3
âœ”ï¸SCRIPT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1104_llama8b/run.sh
âœ”ï¸OUTPUT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1104_llama8b/1109_GPipe_nofreeze.log
âœ”ï¸Llama 3.1 8B Experiment
1109: 1) resolved timelyapf issue, 2) seed fixed to 42 for all runs, 3) 3000 steps -> 2000 steps (better benchmark scores!)

âœ”ï¸Running with nofreeze x GPipe ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1104_llama8b/config_1109.toml --job.description="Llama 3.1 8B Experiment
1109: 1) resolved timelyapf issue, 2) seed fixed to 42 for all runs, 3) 3000 steps -> 2000 steps (better benchmark scores!)
" --parallelism.pipeline_parallel_degree=4  --freezing.no-freeze
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
W1109 13:56:42.694000 1730829 site-packages/torch/distributed/run.py:811] 
W1109 13:56:42.694000 1730829 site-packages/torch/distributed/run.py:811] *****************************************
W1109 13:56:42.694000 1730829 site-packages/torch/distributed/run.py:811] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1109 13:56:42.694000 1730829 site-packages/torch/distributed/run.py:811] *****************************************
[rank2]:2025-11-09 13:56:50,061 - INFO - Starting job: "Llama 3.1 8B Experiment
[rank2]:1109: 1) resolved timelyapf issue, 2) seed fixed to 42 for all runs, 3) 3000 steps -> 2000 steps (better benchmark scores!)
[rank2]:"
[rank3]:2025-11-09 13:56:50,001 - INFO - Starting job: "Llama 3.1 8B Experiment
[rank3]:1109: 1) resolved timelyapf issue, 2) seed fixed to 42 for all runs, 3) 3000 steps -> 2000 steps (better benchmark scores!)
[rank3]:"
[rank1]:2025-11-09 13:56:50,035 - INFO - Starting job: "Llama 3.1 8B Experiment
[rank1]:1109: 1) resolved timelyapf issue, 2) seed fixed to 42 for all runs, 3) 3000 steps -> 2000 steps (better benchmark scores!)
[rank1]:"
[rank0]:2025-11-09 13:56:50,000 - INFO - Starting job: "Llama 3.1 8B Experiment
[rank0]:1109: 1) resolved timelyapf issue, 2) seed fixed to 42 for all runs, 3) 3000 steps -> 2000 steps (better benchmark scores!)
[rank0]:"
[rank2]:2025-11-09 13:56:50,950 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-11-09 13:56:50,952 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-11-09 13:56:50,950 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-11-09 13:56:50,952 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-11-09 13:56:50,944 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-11-09 13:56:50,948 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-09 13:56:50,946 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-11-09 13:56:50,948 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-09 13:56:50,953 - INFO - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-11-09 13:56:50,956 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-11-09 13:56:51,260 - INFO - Preparing openhermes dataset from teknium/OpenHermes-2.5
[rank0]:2025-11-09 13:56:54,440 - INFO - Building llama3 8B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=4096, n_layers=32, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=1024, ffn_dim_multiplier=1.3, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank1]:2025-11-09 13:56:54,686 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank2]:2025-11-09 13:56:54,699 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank0]:2025-11-09 13:56:54,695 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank2]:2025-11-09 13:56:54,813 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.17', 'layers.18', 'layers.19', 'layers.20', 'layers.21', 'layers.22', 'layers.23', 'layers.24']
[rank2]:2025-11-09 13:56:54,813 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-11-09 13:56:54,790 - INFO - Model llama3 8B size: 8,030,261,248 total parameters
[rank0]:2025-11-09 13:56:54,813 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3', 'layers.4', 'layers.5', 'layers.6', 'layers.7']
[rank0]:2025-11-09 13:56:54,813 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2025-11-09 13:56:54,814 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.8', 'layers.9', 'layers.10', 'layers.11', 'layers.12', 'layers.13', 'layers.14', 'layers.15', 'layers.16']
[rank1]:2025-11-09 13:56:54,814 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank2]:2025-11-09 13:56:55,161 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank2]:2025-11-09 13:56:55,161 - INFO - CUDA memory usage for model: 6.51GiB(4.65%)
[rank0]:2025-11-09 13:56:55,167 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank0]:2025-11-09 13:56:55,167 - INFO - CUDA memory usage for model: 8.46GiB(6.05%)
[rank1]:2025-11-09 13:56:55,161 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank1]:2025-11-09 13:56:55,162 - INFO - CUDA memory usage for model: 7.33GiB(5.24%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run 9rg42b2j
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1109_GPipe_nofreeze_h200/20251109-1356/wandb/run-20251109_135655-9rg42b2j
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1109_GPipe_nofreeze_h200
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/9rg42b2j
[rank3]:2025-11-09 13:56:56,657 - INFO - WandB logging enabled
[rank3]:2025-11-09 13:56:56,657 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank3]:2025-11-09 13:56:56,730 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.25', 'layers.26', 'layers.27', 'layers.28', 'layers.29', 'layers.30', 'layers.31', 'norm', 'output']
[rank3]:2025-11-09 13:56:56,731 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank3]:2025-11-09 13:56:56,962 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank3]:2025-11-09 13:56:56,963 - INFO - CUDA memory usage for model: 7.66GiB(5.48%)
[rank0]:2025-11-09 13:56:56,987 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1109_GPipe_nofreeze_h200
[rank0]:2025-11-09 13:56:56,987 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-09 13:56:56,987 - INFO - Trainer is initialized with local batch size 16, global batch size 64, gradient accumulation steps 4, sequence length 1024, total steps 2000 (warmup 200)
[rank0]:2025-11-09 13:56:56,987 - INFO - Loading the checkpoint from /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B/original_dcp.
[rank1]:2025-11-09 13:56:56,987 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank2]:2025-11-09 13:56:56,987 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-11-09 13:56:56,987 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-09 13:57:09,297 - INFO - [GC] GC collection for checkpoint loading. 0.01 seconds
[rank0]:2025-11-09 13:57:09,298 - INFO - Finished loading the checkpoint in 12.31 seconds.
[rank0]:2025-11-09 13:57:09,298 - INFO - Training starts at step 1
[rank2]:2025-11-09 13:57:13,820 - INFO -  step:  1  loss: -4.0000  grad_norm:     inf  memory: 44.28GiB(31.67%)  tps: 861  tflops: 40.15  mfu: 4.06%
[rank3]:2025-11-09 13:57:13,825 - INFO -  step:  1  loss:  8.2933  grad_norm:     inf  memory: 58.03GiB(41.50%)  tps: 957  tflops: 44.64  mfu: 4.51%
[rank3]:2025-11-09 13:57:13,825 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-11-09 13:57:13,820 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-11-09 13:57:13,822 - INFO -  step:  1  loss: -4.0000  grad_norm:     inf  memory: 49.69GiB(35.54%)  tps: 861  tflops: 40.15  mfu: 4.06%
[rank1]:2025-11-09 13:57:13,823 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-09 13:57:13,838 - INFO -  step:  1  loss: -4.0000  grad_norm:     inf  memory: 49.75GiB(35.58%)  tps: 860  tflops: 40.11  mfu: 4.06%
[rank0]:2025-11-09 13:57:13,839 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-09 13:59:20,536 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-09 13:59:22,972 - INFO - Avg. fwd time: 14.4529 / Avg. bwd time: 42.3976 / Avg. batch time: 473.2659 (ms) / GPU bubble ratio: 3.90%
[rank2]:2025-11-09 13:59:23,022 - INFO - Avg. fwd time: 13.0893 / Avg. bwd time: 36.2140 / Avg. batch time: 526.6753 (ms) / GPU bubble ratio: 25.11%
[rank1]:2025-11-09 13:59:23,068 - INFO - Avg. fwd time: 14.9094 / Avg. bwd time: 40.7036 / Avg. batch time: 586.6654 (ms) / GPU bubble ratio: 24.16%
[rank0]:2025-11-09 13:59:23,101 - INFO - Avg. fwd time: 13.8858 / Avg. bwd time: 38.0086 / Avg. batch time: 642.3562 (ms) / GPU bubble ratio: 35.37%
[rank2]:2025-11-09 13:59:23,203 - INFO -  step: 50  loss: -4.0000  grad_norm: 5348.5518  memory: 57.29GiB(40.97%)  tps: 6,205  tflops: 289.40  mfu: 29.26%
[rank3]:2025-11-09 13:59:23,207 - INFO -  step: 50  loss:  9.4315  grad_norm: 5348.5518  memory: 73.38GiB(52.48%)  tps: 6,205  tflops: 289.40  mfu: 29.26%
[rank1]:2025-11-09 13:59:23,206 - INFO -  step: 50  loss: -4.0000  grad_norm: 5348.5518  memory: 64.32GiB(46.00%)  tps: 6,205  tflops: 289.40  mfu: 29.26%
[rank0]:2025-11-09 13:59:23,210 - INFO -  step: 50  loss: -4.0000  grad_norm: 5348.5518  memory: 66.72GiB(47.72%)  tps: 6,206  tflops: 289.43  mfu: 29.26%
[rank0]:2025-11-09 14:01:32,993 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-09 14:01:35,428 - INFO - Avg. fwd time: 14.4867 / Avg. bwd time: 42.6021 / Avg. batch time: 473.4732 (ms) / GPU bubble ratio: 3.54%
[rank1]:2025-11-09 14:01:35,525 - INFO - Avg. fwd time: 14.9265 / Avg. bwd time: 40.8573 / Avg. batch time: 585.8906 (ms) / GPU bubble ratio: 23.83%
[rank2]:2025-11-09 14:01:35,479 - INFO - Avg. fwd time: 13.1020 / Avg. bwd time: 36.2697 / Avg. batch time: 526.3428 (ms) / GPU bubble ratio: 24.96%
[rank0]:2025-11-09 14:01:35,557 - INFO - Avg. fwd time: 13.6660 / Avg. bwd time: 38.1086 / Avg. batch time: 641.1520 (ms) / GPU bubble ratio: 35.40%
[rank0]:2025-11-09 14:01:35,668 - INFO -  step: 100  loss: -4.0000  grad_norm: 109.4380  memory: 66.72GiB(47.72%)  tps: 6,185  tflops: 288.45  mfu: 29.17%
[rank1]:2025-11-09 14:01:35,664 - INFO -  step: 100  loss: -4.0000  grad_norm: 109.4380  memory: 64.32GiB(46.00%)  tps: 6,185  tflops: 288.45  mfu: 29.17%
[rank3]:2025-11-09 14:01:35,666 - INFO -  step: 100  loss:  4.4196  grad_norm: 109.4380  memory: 73.38GiB(52.48%)  tps: 6,185  tflops: 288.45  mfu: 29.17%
[rank2]:2025-11-09 14:01:35,661 - INFO -  step: 100  loss: -4.0000  grad_norm: 109.4380  memory: 57.29GiB(40.97%)  tps: 6,185  tflops: 288.45  mfu: 29.17%
[rank3]:2025-11-09 14:01:35,838 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_nofreeze_h200/pipeline_schedule/251109_1401_real_step100_rank3.svg
[rank3]:> Batch Time: 640.53 ms, GPU Bubble Ratio: 35.12%, 29.92%, 38.01%, 28.28%
[rank0]:2025-11-09 14:03:45,426 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-09 14:03:47,996 - INFO - Avg. fwd time: 13.0649 / Avg. bwd time: 36.3133 / Avg. batch time: 526.0496 (ms) / GPU bubble ratio: 24.91%
[rank3]:2025-11-09 14:03:47,954 - INFO - Avg. fwd time: 14.4412 / Avg. bwd time: 42.6753 / Avg. batch time: 473.1713 (ms) / GPU bubble ratio: 3.43%
[rank1]:2025-11-09 14:03:48,042 - INFO - Avg. fwd time: 14.9011 / Avg. bwd time: 40.9241 / Avg. batch time: 585.4551 (ms) / GPU bubble ratio: 23.72%
[rank1]:2025-11-09 14:03:48,117 - INFO -  step: 150  loss: -4.0000  grad_norm: 21.9631  memory: 64.32GiB(46.00%)  tps: 6,185  tflops: 288.46  mfu: 29.17%
[rank0]:2025-11-09 14:03:48,085 - INFO - Avg. fwd time: 13.5994 / Avg. bwd time: 38.1508 / Avg. batch time: 640.6095 (ms) / GPU bubble ratio: 35.37%
[rank0]:2025-11-09 14:03:48,121 - INFO -  step: 150  loss: -4.0000  grad_norm: 21.9631  memory: 66.72GiB(47.72%)  tps: 6,185  tflops: 288.46  mfu: 29.17%
[rank2]:2025-11-09 14:03:48,114 - INFO -  step: 150  loss: -4.0000  grad_norm: 21.9631  memory: 57.29GiB(40.97%)  tps: 6,185  tflops: 288.46  mfu: 29.17%
[rank3]:2025-11-09 14:03:48,118 - INFO -  step: 150  loss:  2.0322  grad_norm: 21.9631  memory: 73.38GiB(52.48%)  tps: 6,185  tflops: 288.47  mfu: 29.17%
[rank0]:2025-11-09 14:05:58,212 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-09 14:06:00,645 - INFO - Avg. fwd time: 14.4247 / Avg. bwd time: 42.7648 / Avg. batch time: 473.5335 (ms) / GPU bubble ratio: 3.38%
[rank1]:2025-11-09 14:06:00,740 - INFO - Avg. fwd time: 14.9012 / Avg. bwd time: 40.9922 / Avg. batch time: 585.6957 (ms) / GPU bubble ratio: 23.66%
[rank2]:2025-11-09 14:06:00,694 - INFO - Avg. fwd time: 13.0380 / Avg. bwd time: 36.3392 / Avg. batch time: 526.3003 (ms) / GPU bubble ratio: 24.94%
[rank0]:2025-11-09 14:06:00,773 - INFO - Avg. fwd time: 13.5733 / Avg. bwd time: 38.1686 / Avg. batch time: 640.7995 (ms) / GPU bubble ratio: 35.40%
[rank1]:2025-11-09 14:06:00,878 - INFO -  step: 200  loss: -4.0000  grad_norm: 15.2215  memory: 64.32GiB(46.00%)  tps: 6,170  tflops: 287.79  mfu: 29.10%
[rank0]:2025-11-09 14:06:00,882 - INFO -  step: 200  loss: -4.0000  grad_norm: 15.2215  memory: 66.72GiB(47.72%)  tps: 6,170  tflops: 287.79  mfu: 29.10%
[rank3]:2025-11-09 14:06:00,880 - INFO -  step: 200  loss:  0.4815  grad_norm: 15.2215  memory: 73.38GiB(52.48%)  tps: 6,171  tflops: 287.79  mfu: 29.10%
[rank2]:2025-11-09 14:06:00,875 - INFO -  step: 200  loss: -4.0000  grad_norm: 15.2215  memory: 57.29GiB(40.97%)  tps: 6,170  tflops: 287.79  mfu: 29.10%
[rank3]:2025-11-09 14:06:01,020 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_nofreeze_h200/pipeline_schedule/251109_1406_real_step200_rank3.svg
[rank3]:> Batch Time: 642.47 ms, GPU Bubble Ratio: 35.38%, 29.85%, 38.36%, 28.27%
[rank0]:2025-11-09 14:08:11,298 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-09 14:08:13,727 - INFO - Avg. fwd time: 14.4199 / Avg. bwd time: 42.8268 / Avg. batch time: 473.8353 (ms) / GPU bubble ratio: 3.35%
[rank1]:2025-11-09 14:08:13,823 - INFO - Avg. fwd time: 14.9100 / Avg. bwd time: 41.0445 / Avg. batch time: 586.0173 (ms) / GPU bubble ratio: 23.61%
[rank2]:2025-11-09 14:08:13,777 - INFO - Avg. fwd time: 13.0287 / Avg. bwd time: 36.3551 / Avg. batch time: 526.6109 (ms) / GPU bubble ratio: 24.98%
[rank0]:2025-11-09 14:08:13,855 - INFO - Avg. fwd time: 13.5656 / Avg. bwd time: 38.1863 / Avg. batch time: 641.0984 (ms) / GPU bubble ratio: 35.42%
[rank2]:2025-11-09 14:08:13,958 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.6212  memory: 57.29GiB(40.97%)  tps: 6,156  tflops: 287.10  mfu: 29.03%
[rank3]:2025-11-09 14:08:13,962 - INFO -  step: 250  loss:  0.2525  grad_norm:  0.6212  memory: 73.38GiB(52.48%)  tps: 6,156  tflops: 287.10  mfu: 29.03%
[rank1]:2025-11-09 14:08:13,961 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.6212  memory: 64.32GiB(46.00%)  tps: 6,156  tflops: 287.10  mfu: 29.03%
[rank0]:2025-11-09 14:08:13,965 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.6212  memory: 66.72GiB(47.72%)  tps: 6,156  tflops: 287.10  mfu: 29.03%
[rank0]:2025-11-09 14:10:24,172 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-09 14:10:26,733 - INFO - Avg. fwd time: 13.0242 / Avg. bwd time: 36.3623 / Avg. batch time: 526.7186 (ms) / GPU bubble ratio: 24.99%
[rank3]:2025-11-09 14:10:26,692 - INFO - Avg. fwd time: 14.4161 / Avg. bwd time: 42.8644 / Avg. batch time: 474.0047 (ms) / GPU bubble ratio: 3.33%
[rank1]:2025-11-09 14:10:26,780 - INFO - Avg. fwd time: 14.9202 / Avg. bwd time: 41.0756 / Avg. batch time: 586.1326 (ms) / GPU bubble ratio: 23.57%
[rank1]:2025-11-09 14:10:26,855 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.4048  memory: 64.32GiB(46.00%)  tps: 6,164  tflops: 287.51  mfu: 29.07%
[rank0]:2025-11-09 14:10:26,823 - INFO - Avg. fwd time: 13.5562 / Avg. bwd time: 38.2065 / Avg. batch time: 641.2066 (ms) / GPU bubble ratio: 35.42%
[rank0]:2025-11-09 14:10:26,859 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.4048  memory: 66.72GiB(47.72%)  tps: 6,164  tflops: 287.50  mfu: 29.07%
[rank2]:2025-11-09 14:10:26,852 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.4048  memory: 57.29GiB(40.97%)  tps: 6,164  tflops: 287.50  mfu: 29.07%
[rank3]:2025-11-09 14:10:26,857 - INFO -  step: 300  loss:  0.2730  grad_norm:  0.4048  memory: 73.38GiB(52.48%)  tps: 6,164  tflops: 287.51  mfu: 29.07%
[rank3]:2025-11-09 14:10:27,000 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_nofreeze_h200/pipeline_schedule/251109_1410_real_step300_rank3.svg
[rank3]:> Batch Time: 639.53 ms, GPU Bubble Ratio: 35.03%, 29.64%, 38.05%, 28.14%
[rank0]:2025-11-09 14:12:36,975 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-09 14:12:39,422 - INFO - Avg. fwd time: 14.4123 / Avg. bwd time: 42.8708 / Avg. batch time: 473.9633 (ms) / GPU bubble ratio: 3.31%
[rank2]:2025-11-09 14:12:39,471 - INFO - Avg. fwd time: 13.0242 / Avg. bwd time: 36.3677 / Avg. batch time: 526.7064 (ms) / GPU bubble ratio: 24.98%
[rank1]:2025-11-09 14:12:39,517 - INFO - Avg. fwd time: 14.9248 / Avg. bwd time: 41.0827 / Avg. batch time: 586.1027 (ms) / GPU bubble ratio: 23.55%
[rank0]:2025-11-09 14:12:39,550 - INFO - Avg. fwd time: 13.5541 / Avg. bwd time: 38.2164 / Avg. batch time: 641.1771 (ms) / GPU bubble ratio: 35.41%
[rank1]:2025-11-09 14:12:39,653 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.4525  memory: 64.32GiB(46.00%)  tps: 6,169  tflops: 287.71  mfu: 29.09%
[rank0]:2025-11-09 14:12:39,657 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.4525  memory: 66.72GiB(47.72%)  tps: 6,169  tflops: 287.71  mfu: 29.09%
[rank3]:2025-11-09 14:12:39,656 - INFO -  step: 350  loss:  0.3236  grad_norm:  0.4525  memory: 73.38GiB(52.48%)  tps: 6,169  tflops: 287.71  mfu: 29.09%
[rank2]:2025-11-09 14:12:39,651 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.4525  memory: 57.29GiB(40.97%)  tps: 6,169  tflops: 287.71  mfu: 29.09%
[rank0]:2025-11-09 14:14:49,552 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-09 14:14:52,013 - INFO - Avg. fwd time: 14.4075 / Avg. bwd time: 42.8725 / Avg. batch time: 473.8828 (ms) / GPU bubble ratio: 3.30%
[rank2]:2025-11-09 14:14:52,063 - INFO - Avg. fwd time: 13.0239 / Avg. bwd time: 36.3716 / Avg. batch time: 526.5851 (ms) / GPU bubble ratio: 24.96%
[rank1]:2025-11-09 14:14:52,109 - INFO - Avg. fwd time: 14.9277 / Avg. bwd time: 41.0827 / Avg. batch time: 585.9613 (ms) / GPU bubble ratio: 23.53%
[rank0]:2025-11-09 14:14:52,142 - INFO - Avg. fwd time: 13.5497 / Avg. bwd time: 38.2261 / Avg. batch time: 641.0383 (ms) / GPU bubble ratio: 35.39%
[rank1]:2025-11-09 14:14:52,246 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.3671  memory: 64.32GiB(46.00%)  tps: 6,178  tflops: 288.16  mfu: 29.14%
[rank0]:2025-11-09 14:14:52,250 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.3671  memory: 66.72GiB(47.72%)  tps: 6,178  tflops: 288.16  mfu: 29.14%
[rank3]:2025-11-09 14:14:52,248 - INFO -  step: 400  loss:  0.2589  grad_norm:  0.3671  memory: 73.38GiB(52.48%)  tps: 6,178  tflops: 288.16  mfu: 29.14%
[rank2]:2025-11-09 14:14:52,243 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.3671  memory: 57.29GiB(40.97%)  tps: 6,178  tflops: 288.16  mfu: 29.14%
[rank3]:2025-11-09 14:14:52,390 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_nofreeze_h200/pipeline_schedule/251109_1414_real_step400_rank3.svg
[rank3]:> Batch Time: 639.59 ms, GPU Bubble Ratio: 35.02%, 29.78%, 38.03%, 28.29%
[rank0]:2025-11-09 14:17:02,148 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-09 14:17:04,676 - INFO - Avg. fwd time: 14.4026 / Avg. bwd time: 42.8733 / Avg. batch time: 473.8073 (ms) / GPU bubble ratio: 3.29%
[rank1]:2025-11-09 14:17:04,766 - INFO - Avg. fwd time: 14.9291 / Avg. bwd time: 41.0827 / Avg. batch time: 585.8858 (ms) / GPU bubble ratio: 23.52%
[rank2]:2025-11-09 14:17:04,719 - INFO - Avg. fwd time: 13.0230 / Avg. bwd time: 36.3716 / Avg. batch time: 526.5240 (ms) / GPU bubble ratio: 24.95%
[rank1]:2025-11-09 14:17:04,841 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.3304  memory: 64.32GiB(46.00%)  tps: 6,178  tflops: 288.15  mfu: 29.14%
[rank3]:2025-11-09 14:17:04,844 - INFO -  step: 450  loss:  0.2852  grad_norm:  0.3304  memory: 73.38GiB(52.48%)  tps: 6,178  tflops: 288.15  mfu: 29.14%
[rank0]:2025-11-09 14:17:04,810 - INFO - Avg. fwd time: 13.5481 / Avg. bwd time: 38.2323 / Avg. batch time: 640.9582 (ms) / GPU bubble ratio: 35.37%
[rank0]:2025-11-09 14:17:04,845 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.3304  memory: 66.72GiB(47.72%)  tps: 6,178  tflops: 288.15  mfu: 29.14%
[rank2]:2025-11-09 14:17:04,839 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.3304  memory: 57.29GiB(40.97%)  tps: 6,178  tflops: 288.15  mfu: 29.14%
[rank0]:2025-11-09 14:19:14,632 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-09 14:19:17,109 - INFO - Avg. fwd time: 13.0218 / Avg. bwd time: 36.3726 / Avg. batch time: 526.4315 (ms) / GPU bubble ratio: 24.94%
[rank3]:2025-11-09 14:19:17,058 - INFO - Avg. fwd time: 14.3991 / Avg. bwd time: 42.8726 / Avg. batch time: 473.7428 (ms) / GPU bubble ratio: 3.29%
[rank1]:2025-11-09 14:19:17,155 - INFO - Avg. fwd time: 14.9279 / Avg. bwd time: 41.0836 / Avg. batch time: 585.7800 (ms) / GPU bubble ratio: 23.51%
[rank0]:2025-11-09 14:19:17,188 - INFO - Avg. fwd time: 13.5436 / Avg. bwd time: 38.2363 / Avg. batch time: 640.8470 (ms) / GPU bubble ratio: 35.36%
[rank1]:2025-11-09 14:19:17,292 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.4134  memory: 64.32GiB(46.00%)  tps: 6,185  tflops: 288.47  mfu: 29.17%
[rank2]:2025-11-09 14:19:17,290 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.4134  memory: 57.29GiB(40.97%)  tps: 6,185  tflops: 288.47  mfu: 29.17%
[rank3]:2025-11-09 14:19:17,294 - INFO -  step: 500  loss:  0.2723  grad_norm:  0.4134  memory: 73.38GiB(52.48%)  tps: 6,185  tflops: 288.47  mfu: 29.17%
[rank0]:2025-11-09 14:19:17,296 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.4134  memory: 66.72GiB(47.72%)  tps: 6,185  tflops: 288.47  mfu: 29.17%
[rank3]:2025-11-09 14:19:17,436 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_nofreeze_h200/pipeline_schedule/251109_1419_real_step500_rank3.svg
[rank3]:> Batch Time: 639.00 ms, GPU Bubble Ratio: 35.10%, 29.81%, 38.02%, 28.29%
[rank0]:2025-11-09 14:21:26,897 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-09 14:21:29,314 - INFO - Avg. fwd time: 14.3949 / Avg. bwd time: 42.8701 / Avg. batch time: 473.6615 (ms) / GPU bubble ratio: 3.28%
[rank2]:2025-11-09 14:21:29,363 - INFO - Avg. fwd time: 13.0229 / Avg. bwd time: 36.3736 / Avg. batch time: 526.3651 (ms) / GPU bubble ratio: 24.92%
[rank0]:2025-11-09 14:21:29,442 - INFO - Avg. fwd time: 13.5416 / Avg. bwd time: 38.2412 / Avg. batch time: 640.7622 (ms) / GPU bubble ratio: 35.35%
[rank1]:2025-11-09 14:21:29,409 - INFO - Avg. fwd time: 14.9282 / Avg. bwd time: 41.0827 / Avg. batch time: 585.7034 (ms) / GPU bubble ratio: 23.50%
[rank0]:2025-11-09 14:21:29,549 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.3115  memory: 66.72GiB(47.72%)  tps: 6,194  tflops: 288.90  mfu: 29.21%
[rank1]:2025-11-09 14:21:29,545 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.3115  memory: 64.32GiB(46.00%)  tps: 6,194  tflops: 288.90  mfu: 29.21%
[rank2]:2025-11-09 14:21:29,542 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.3115  memory: 57.29GiB(40.97%)  tps: 6,194  tflops: 288.90  mfu: 29.21%
[rank3]:2025-11-09 14:21:29,547 - INFO -  step: 550  loss:  0.1625  grad_norm:  0.3115  memory: 73.38GiB(52.48%)  tps: 6,194  tflops: 288.90  mfu: 29.21%
[rank0]:2025-11-09 14:23:40,249 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-09 14:23:42,873 - INFO - Avg. fwd time: 13.0354 / Avg. bwd time: 36.3835 / Avg. batch time: 526.5683 (ms) / GPU bubble ratio: 24.92%
[rank3]:2025-11-09 14:23:42,829 - INFO - Avg. fwd time: 14.4082 / Avg. bwd time: 42.8852 / Avg. batch time: 473.8689 (ms) / GPU bubble ratio: 3.28%
[rank0]:2025-11-09 14:23:42,965 - INFO - Avg. fwd time: 13.5508 / Avg. bwd time: 38.2531 / Avg. batch time: 640.9879 (ms) / GPU bubble ratio: 35.34%
[rank1]:2025-11-09 14:23:42,920 - INFO - Avg. fwd time: 14.9419 / Avg. bwd time: 41.0921 / Avg. batch time: 585.9168 (ms) / GPU bubble ratio: 23.49%
[rank1]:2025-11-09 14:23:42,996 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.7253  memory: 64.32GiB(46.00%)  tps: 6,139  tflops: 286.30  mfu: 28.95%
[rank2]:2025-11-09 14:23:42,994 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.7253  memory: 57.29GiB(40.97%)  tps: 6,139  tflops: 286.30  mfu: 28.95%
[rank3]:2025-11-09 14:23:42,998 - INFO -  step: 600  loss:  0.4053  grad_norm:  0.7253  memory: 73.38GiB(52.48%)  tps: 6,139  tflops: 286.31  mfu: 28.95%
[rank0]:2025-11-09 14:23:43,001 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.7253  memory: 66.72GiB(47.72%)  tps: 6,139  tflops: 286.30  mfu: 28.95%
[rank3]:2025-11-09 14:23:43,139 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_nofreeze_h200/pipeline_schedule/251109_1423_real_step600_rank3.svg
[rank3]:> Batch Time: 646.78 ms, GPU Bubble Ratio: 35.17%, 29.81%, 38.14%, 28.09%
[rank0]:2025-11-09 14:25:54,962 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-09 14:25:57,422 - INFO - Avg. fwd time: 14.4336 / Avg. bwd time: 42.9120 / Avg. batch time: 474.2751 (ms) / GPU bubble ratio: 3.27%
[rank2]:2025-11-09 14:25:57,472 - INFO - Avg. fwd time: 13.0565 / Avg. bwd time: 36.3965 / Avg. batch time: 527.0230 (ms) / GPU bubble ratio: 24.93%
[rank0]:2025-11-09 14:25:57,551 - INFO - Avg. fwd time: 13.5699 / Avg. bwd time: 38.2653 / Avg. batch time: 641.4823 (ms) / GPU bubble ratio: 35.36%
[rank1]:2025-11-09 14:25:57,519 - INFO - Avg. fwd time: 14.9633 / Avg. bwd time: 41.1042 / Avg. batch time: 586.3948 (ms) / GPU bubble ratio: 23.51%
[rank0]:2025-11-09 14:25:57,659 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.5225  memory: 66.72GiB(47.72%)  tps: 6,084  tflops: 283.74  mfu: 28.69%
[rank1]:2025-11-09 14:25:57,655 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.5225  memory: 64.32GiB(46.00%)  tps: 6,084  tflops: 283.74  mfu: 28.69%
[rank3]:2025-11-09 14:25:57,657 - INFO -  step: 650  loss:  0.2673  grad_norm:  0.5225  memory: 73.38GiB(52.48%)  tps: 6,084  tflops: 283.74  mfu: 28.69%
[rank2]:2025-11-09 14:25:57,652 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.5225  memory: 57.29GiB(40.97%)  tps: 6,084  tflops: 283.74  mfu: 28.69%
[rank0]:2025-11-09 14:28:09,635 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-09 14:28:12,123 - INFO - Avg. fwd time: 14.4577 / Avg. bwd time: 42.9374 / Avg. batch time: 474.6604 (ms) / GPU bubble ratio: 3.27%
[rank2]:2025-11-09 14:28:12,173 - INFO - Avg. fwd time: 13.0770 / Avg. bwd time: 36.4090 / Avg. batch time: 527.4171 (ms) / GPU bubble ratio: 24.94%
[rank0]:2025-11-09 14:28:12,253 - INFO - Avg. fwd time: 13.5853 / Avg. bwd time: 38.2772 / Avg. batch time: 641.9122 (ms) / GPU bubble ratio: 35.36%
[rank1]:2025-11-09 14:28:12,220 - INFO - Avg. fwd time: 14.9840 / Avg. bwd time: 41.1151 / Avg. batch time: 586.8082 (ms) / GPU bubble ratio: 23.52%
[rank0]:2025-11-09 14:28:12,360 - INFO -  step: 700  loss: -4.0000  grad_norm:  6.5175  memory: 66.72GiB(47.72%)  tps: 6,082  tflops: 283.65  mfu: 28.68%
[rank1]:2025-11-09 14:28:12,356 - INFO -  step: 700  loss: -4.0000  grad_norm:  6.5175  memory: 64.32GiB(46.00%)  tps: 6,082  tflops: 283.65  mfu: 28.68%
[rank3]:2025-11-09 14:28:12,358 - INFO -  step: 700  loss:  0.3464  grad_norm:  6.5175  memory: 73.38GiB(52.48%)  tps: 6,082  tflops: 283.65  mfu: 28.68%
[rank2]:2025-11-09 14:28:12,353 - INFO -  step: 700  loss: -4.0000  grad_norm:  6.5175  memory: 57.29GiB(40.97%)  tps: 6,082  tflops: 283.65  mfu: 28.68%
[rank3]:2025-11-09 14:28:12,502 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_nofreeze_h200/pipeline_schedule/251109_1428_real_step700_rank3.svg
[rank3]:> Batch Time: 649.25 ms, GPU Bubble Ratio: 35.28%, 30.14%, 38.28%, 28.20%
[rank0]:2025-11-09 14:30:23,712 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-09 14:30:26,299 - INFO - Avg. fwd time: 13.0905 / Avg. bwd time: 36.4175 / Avg. batch time: 527.6652 (ms) / GPU bubble ratio: 24.94%
[rank3]:2025-11-09 14:30:26,255 - INFO - Avg. fwd time: 14.4716 / Avg. bwd time: 42.9520 / Avg. batch time: 474.8771 (ms) / GPU bubble ratio: 3.26%
[rank0]:2025-11-09 14:30:26,391 - INFO - Avg. fwd time: 13.5961 / Avg. bwd time: 38.2847 / Avg. batch time: 642.1835 (ms) / GPU bubble ratio: 35.37%
[rank1]:2025-11-09 14:30:26,346 - INFO - Avg. fwd time: 14.9960 / Avg. bwd time: 41.1230 / Avg. batch time: 587.0681 (ms) / GPU bubble ratio: 23.53%
[rank2]:2025-11-09 14:30:26,420 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.4266  memory: 57.29GiB(40.97%)  tps: 6,110  tflops: 284.99  mfu: 28.82%
[rank3]:2025-11-09 14:30:26,425 - INFO -  step: 750  loss:  0.1478  grad_norm:  0.4266  memory: 73.38GiB(52.48%)  tps: 6,110  tflops: 284.99  mfu: 28.82%
[rank0]:2025-11-09 14:30:26,427 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.4266  memory: 66.72GiB(47.72%)  tps: 6,110  tflops: 284.99  mfu: 28.82%
[rank1]:2025-11-09 14:30:26,423 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.4266  memory: 64.32GiB(46.00%)  tps: 6,110  tflops: 284.99  mfu: 28.82%
[rank0]:2025-11-09 14:32:36,510 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-09 14:32:38,997 - INFO - Avg. fwd time: 14.4698 / Avg. bwd time: 42.9520 / Avg. batch time: 474.8513 (ms) / GPU bubble ratio: 3.26%
[rank2]:2025-11-09 14:32:39,047 - INFO - Avg. fwd time: 13.0912 / Avg. bwd time: 36.4191 / Avg. batch time: 527.6277 (ms) / GPU bubble ratio: 24.93%
[rank1]:2025-11-09 14:32:39,092 - INFO - Avg. fwd time: 14.9959 / Avg. bwd time: 41.1233 / Avg. batch time: 587.0285 (ms) / GPU bubble ratio: 23.52%
[rank0]:2025-11-09 14:32:39,125 - INFO - Avg. fwd time: 13.5940 / Avg. bwd time: 38.2880 / Avg. batch time: 642.1441 (ms) / GPU bubble ratio: 35.36%
[rank3]:2025-11-09 14:32:39,231 - INFO -  step: 800  loss:  0.2646  grad_norm:  0.5842  memory: 73.38GiB(52.48%)  tps: 6,168  tflops: 287.70  mfu: 29.09%
[rank2]:2025-11-09 14:32:39,226 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.5842  memory: 57.29GiB(40.97%)  tps: 6,168  tflops: 287.70  mfu: 29.09%
[rank1]:2025-11-09 14:32:39,229 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.5842  memory: 64.32GiB(46.00%)  tps: 6,168  tflops: 287.70  mfu: 29.09%
[rank0]:2025-11-09 14:32:39,233 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.5842  memory: 66.72GiB(47.72%)  tps: 6,168  tflops: 287.70  mfu: 29.09%
[rank3]:2025-11-09 14:32:39,374 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_nofreeze_h200/pipeline_schedule/251109_1432_real_step800_rank3.svg
[rank3]:> Batch Time: 640.62 ms, GPU Bubble Ratio: 35.14%, 29.85%, 38.07%, 28.46%
[rank0]:2025-11-09 14:34:49,908 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-09 14:34:52,347 - INFO - Avg. fwd time: 14.4766 / Avg. bwd time: 42.9588 / Avg. batch time: 474.9511 (ms) / GPU bubble ratio: 3.26%
[rank2]:2025-11-09 14:34:52,397 - INFO - Avg. fwd time: 13.0977 / Avg. bwd time: 36.4224 / Avg. batch time: 527.7478 (ms) / GPU bubble ratio: 24.93%
[rank1]:2025-11-09 14:34:52,443 - INFO - Avg. fwd time: 15.0018 / Avg. bwd time: 41.1274 / Avg. batch time: 587.1519 (ms) / GPU bubble ratio: 23.52%
[rank0]:2025-11-09 14:34:52,476 - INFO - Avg. fwd time: 13.5966 / Avg. bwd time: 38.2933 / Avg. batch time: 642.2721 (ms) / GPU bubble ratio: 35.37%
[rank1]:2025-11-09 14:34:52,580 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.5208  memory: 64.32GiB(46.00%)  tps: 6,143  tflops: 286.52  mfu: 28.97%
[rank0]:2025-11-09 14:34:52,584 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.5208  memory: 66.72GiB(47.72%)  tps: 6,143  tflops: 286.52  mfu: 28.97%
[rank2]:2025-11-09 14:34:52,578 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.5208  memory: 57.29GiB(40.97%)  tps: 6,143  tflops: 286.52  mfu: 28.97%
[rank3]:2025-11-09 14:34:52,582 - INFO -  step: 850  loss:  0.1220  grad_norm:  0.5208  memory: 73.38GiB(52.48%)  tps: 6,143  tflops: 286.52  mfu: 28.97%
[rank0]:2025-11-09 14:37:01,542 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-09 14:37:04,123 - INFO - Avg. fwd time: 13.0926 / Avg. bwd time: 36.4190 / Avg. batch time: 527.5568 (ms) / GPU bubble ratio: 24.92%
[rank3]:2025-11-09 14:37:04,079 - INFO - Avg. fwd time: 14.4669 / Avg. bwd time: 42.9488 / Avg. batch time: 474.7818 (ms) / GPU bubble ratio: 3.26%
[rank1]:2025-11-09 14:37:04,172 - INFO - Avg. fwd time: 14.9976 / Avg. bwd time: 41.1255 / Avg. batch time: 586.9545 (ms) / GPU bubble ratio: 23.51%
[rank0]:2025-11-09 14:37:04,217 - INFO - Avg. fwd time: 13.5911 / Avg. bwd time: 38.2950 / Avg. batch time: 642.0718 (ms) / GPU bubble ratio: 35.35%
[rank0]:2025-11-09 14:37:04,253 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.4301  memory: 66.72GiB(47.72%)  tps: 6,222  tflops: 290.18  mfu: 29.34%
[rank2]:2025-11-09 14:37:04,246 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.4301  memory: 57.29GiB(40.97%)  tps: 6,222  tflops: 290.18  mfu: 29.34%
[rank3]:2025-11-09 14:37:04,251 - INFO -  step: 900  loss:  0.1848  grad_norm:  0.4301  memory: 73.38GiB(52.48%)  tps: 6,222  tflops: 290.18  mfu: 29.34%
[rank1]:2025-11-09 14:37:04,249 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.4301  memory: 64.32GiB(46.00%)  tps: 6,222  tflops: 290.18  mfu: 29.34%
[rank3]:2025-11-09 14:37:04,391 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_nofreeze_h200/pipeline_schedule/251109_1437_real_step900_rank3.svg
[rank3]:> Batch Time: 640.12 ms, GPU Bubble Ratio: 34.98%, 29.63%, 38.01%, 28.25%
[rank0]:2025-11-09 14:39:14,346 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-09 14:39:16,811 - INFO - Avg. fwd time: 14.4669 / Avg. bwd time: 42.9477 / Avg. batch time: 474.7650 (ms) / GPU bubble ratio: 3.25%
[rank2]:2025-11-09 14:39:16,861 - INFO - Avg. fwd time: 13.0940 / Avg. bwd time: 36.4197 / Avg. batch time: 527.5511 (ms) / GPU bubble ratio: 24.92%
[rank1]:2025-11-09 14:39:16,907 - INFO - Avg. fwd time: 14.9992 / Avg. bwd time: 41.1266 / Avg. batch time: 586.9472 (ms) / GPU bubble ratio: 23.50%
[rank0]:2025-11-09 14:39:16,940 - INFO - Avg. fwd time: 13.5907 / Avg. bwd time: 38.2968 / Avg. batch time: 642.0636 (ms) / GPU bubble ratio: 35.35%
[rank1]:2025-11-09 14:39:17,043 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.7387  memory: 64.32GiB(46.00%)  tps: 6,169  tflops: 287.72  mfu: 29.09%
[rank0]:2025-11-09 14:39:17,047 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.7387  memory: 66.72GiB(47.72%)  tps: 6,169  tflops: 287.72  mfu: 29.09%
[rank3]:2025-11-09 14:39:17,045 - INFO -  step: 950  loss:  0.2458  grad_norm:  0.7387  memory: 73.38GiB(52.48%)  tps: 6,169  tflops: 287.72  mfu: 29.09%
[rank2]:2025-11-09 14:39:17,041 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.7387  memory: 57.29GiB(40.97%)  tps: 6,169  tflops: 287.72  mfu: 29.09%
[rank0]:2025-11-09 14:41:27,615 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-09 14:41:30,051 - INFO - Avg. fwd time: 14.4722 / Avg. bwd time: 42.9543 / Avg. batch time: 474.8541 (ms) / GPU bubble ratio: 3.25%
[rank1]:2025-11-09 14:41:30,147 - INFO - Avg. fwd time: 15.0048 / Avg. bwd time: 41.1300 / Avg. batch time: 587.0345 (ms) / GPU bubble ratio: 23.50%
[rank2]:2025-11-09 14:41:30,101 - INFO - Avg. fwd time: 13.0999 / Avg. bwd time: 36.4232 / Avg. batch time: 527.6331 (ms) / GPU bubble ratio: 24.91%
[rank0]:2025-11-09 14:41:30,180 - INFO - Avg. fwd time: 13.5961 / Avg. bwd time: 38.3005 / Avg. batch time: 642.1558 (ms) / GPU bubble ratio: 35.35%
[rank2]:2025-11-09 14:41:30,280 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.3034  memory: 57.29GiB(40.97%)  tps: 6,148  tflops: 286.76  mfu: 28.99%
[rank2]:2025-11-09 14:41:30,280 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-11-09 14:41:30,285 - INFO -  step: 1000  loss:  0.1518  grad_norm:  0.3034  memory: 73.38GiB(52.48%)  tps: 6,148  tflops: 286.76  mfu: 29.00%
[rank3]:2025-11-09 14:41:30,285 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-11-09 14:41:30,283 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.3034  memory: 64.32GiB(46.00%)  tps: 6,148  tflops: 286.76  mfu: 28.99%
[rank1]:2025-11-09 14:41:30,283 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-09 14:41:30,287 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.3034  memory: 66.72GiB(47.72%)  tps: 6,148  tflops: 286.76  mfu: 28.99%
[rank0]:2025-11-09 14:41:30,287 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-09 14:41:30,287 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank2]:2025-11-09 14:41:41,485 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 11.20 seconds.
[rank1]:2025-11-09 14:41:41,921 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 11.64 seconds.
[rank3]:2025-11-09 14:41:42,451 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 12.17 seconds.
[rank0]:2025-11-09 14:41:43,622 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-11-09 14:41:43,627 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 13.34 seconds.
[rank3]:2025-11-09 14:41:43,838 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_nofreeze_h200/pipeline_schedule/251109_1441_real_step1000_rank3.svg
[rank3]:> Batch Time: 642.69 ms, GPU Bubble Ratio: 35.05%, 29.84%, 38.07%, 28.25%
[rank0]:2025-11-09 14:43:55,993 - INFO - [GC] Peforming periodical GC collection 1.82 seconds
[rank3]:2025-11-09 14:43:58,604 - INFO - Avg. fwd time: 14.4708 / Avg. bwd time: 42.9489 / Avg. batch time: 474.9124 (ms) / GPU bubble ratio: 3.28%
[rank2]:2025-11-09 14:43:58,650 - INFO - Avg. fwd time: 13.0995 / Avg. bwd time: 36.4252 / Avg. batch time: 527.7191 (ms) / GPU bubble ratio: 24.92%
[rank0]:2025-11-09 14:43:58,747 - INFO - Avg. fwd time: 13.5969 / Avg. bwd time: 38.2999 / Avg. batch time: 642.2390 (ms) / GPU bubble ratio: 35.36%
[rank0]:2025-11-09 14:43:58,783 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.8259  memory: 66.72GiB(47.72%)  tps: 5,517  tflops: 257.30  mfu: 26.02%
[rank1]:2025-11-09 14:43:58,699 - INFO - Avg. fwd time: 15.0007 / Avg. bwd time: 41.1279 / Avg. batch time: 587.1146 (ms) / GPU bubble ratio: 23.52%
[rank1]:2025-11-09 14:43:58,779 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.8259  memory: 64.32GiB(46.00%)  tps: 5,517  tflops: 257.30  mfu: 26.02%
[rank3]:2025-11-09 14:43:58,781 - INFO -  step: 1050  loss:  0.2501  grad_norm:  0.8259  memory: 73.38GiB(52.48%)  tps: 5,517  tflops: 257.30  mfu: 26.02%
[rank2]:2025-11-09 14:43:58,776 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.8259  memory: 57.29GiB(40.97%)  tps: 5,517  tflops: 257.30  mfu: 26.02%
[rank0]:2025-11-09 14:46:11,243 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-09 14:46:13,697 - INFO - Avg. fwd time: 14.4881 / Avg. bwd time: 42.9664 / Avg. batch time: 475.1842 (ms) / GPU bubble ratio: 3.27%
[rank1]:2025-11-09 14:46:13,794 - INFO - Avg. fwd time: 15.0137 / Avg. bwd time: 41.1348 / Avg. batch time: 587.4097 (ms) / GPU bubble ratio: 23.53%
[rank2]:2025-11-09 14:46:13,747 - INFO - Avg. fwd time: 13.1133 / Avg. bwd time: 36.4344 / Avg. batch time: 528.0003 (ms) / GPU bubble ratio: 24.93%
[rank0]:2025-11-09 14:46:13,826 - INFO - Avg. fwd time: 13.6098 / Avg. bwd time: 38.3049 / Avg. batch time: 642.5478 (ms) / GPU bubble ratio: 35.36%
[rank2]:2025-11-09 14:46:13,924 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.3814  memory: 57.29GiB(40.97%)  tps: 6,062  tflops: 282.71  mfu: 28.59%
[rank1]:2025-11-09 14:46:13,927 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.3814  memory: 64.32GiB(46.00%)  tps: 6,062  tflops: 282.71  mfu: 28.59%
[rank0]:2025-11-09 14:46:13,931 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.3814  memory: 66.72GiB(47.72%)  tps: 6,062  tflops: 282.71  mfu: 28.59%
[rank3]:2025-11-09 14:46:13,929 - INFO -  step: 1100  loss:  0.2210  grad_norm:  0.3814  memory: 73.38GiB(52.48%)  tps: 6,062  tflops: 282.71  mfu: 28.59%
[rank3]:2025-11-09 14:46:14,075 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_nofreeze_h200/pipeline_schedule/251109_1446_real_step1100_rank3.svg
[rank3]:> Batch Time: 650.28 ms, GPU Bubble Ratio: 35.36%, 30.11%, 38.18%, 28.05%
[rank0]:2025-11-09 14:48:24,819 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-09 14:48:27,272 - INFO - Avg. fwd time: 14.4923 / Avg. bwd time: 42.9726 / Avg. batch time: 475.2573 (ms) / GPU bubble ratio: 3.27%
[rank2]:2025-11-09 14:48:27,321 - INFO - Avg. fwd time: 13.1169 / Avg. bwd time: 36.4378 / Avg. batch time: 528.0866 (ms) / GPU bubble ratio: 24.93%
[rank0]:2025-11-09 14:48:27,400 - INFO - Avg. fwd time: 13.6129 / Avg. bwd time: 38.3057 / Avg. batch time: 642.6372 (ms) / GPU bubble ratio: 35.37%
[rank1]:2025-11-09 14:48:27,367 - INFO - Avg. fwd time: 15.0171 / Avg. bwd time: 41.1372 / Avg. batch time: 587.4971 (ms) / GPU bubble ratio: 23.53%
[rank0]:2025-11-09 14:48:27,505 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.5398  memory: 66.72GiB(47.72%)  tps: 6,133  tflops: 286.04  mfu: 28.92%
[rank1]:2025-11-09 14:48:27,501 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.5398  memory: 64.32GiB(46.00%)  tps: 6,133  tflops: 286.04  mfu: 28.92%
[rank3]:2025-11-09 14:48:27,503 - INFO -  step: 1150  loss:  0.2109  grad_norm:  0.5398  memory: 73.38GiB(52.48%)  tps: 6,133  tflops: 286.04  mfu: 28.92%
[rank2]:2025-11-09 14:48:27,499 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.5398  memory: 57.29GiB(40.97%)  tps: 6,133  tflops: 286.04  mfu: 28.92%
[rank0]:2025-11-09 14:50:38,107 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-09 14:50:40,713 - INFO - Avg. fwd time: 13.1192 / Avg. bwd time: 36.4388 / Avg. batch time: 528.1095 (ms) / GPU bubble ratio: 24.93%
[rank3]:2025-11-09 14:50:40,668 - INFO - Avg. fwd time: 14.4945 / Avg. bwd time: 42.9755 / Avg. batch time: 475.2884 (ms) / GPU bubble ratio: 3.27%
[rank0]:2025-11-09 14:50:40,811 - INFO - Avg. fwd time: 13.6138 / Avg. bwd time: 38.3058 / Avg. batch time: 642.6658 (ms) / GPU bubble ratio: 35.37%
[rank1]:2025-11-09 14:50:40,762 - INFO - Avg. fwd time: 15.0191 / Avg. bwd time: 41.1381 / Avg. batch time: 587.5213 (ms) / GPU bubble ratio: 23.53%
[rank2]:2025-11-09 14:50:40,839 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.4454  memory: 57.29GiB(40.97%)  tps: 6,144  tflops: 286.54  mfu: 28.97%
[rank3]:2025-11-09 14:50:40,844 - INFO -  step: 1200  loss:  0.2634  grad_norm:  0.4454  memory: 73.38GiB(52.48%)  tps: 6,144  tflops: 286.54  mfu: 28.97%
[rank0]:2025-11-09 14:50:40,846 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.4454  memory: 66.72GiB(47.72%)  tps: 6,144  tflops: 286.54  mfu: 28.97%
[rank1]:2025-11-09 14:50:40,842 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.4454  memory: 64.32GiB(46.00%)  tps: 6,144  tflops: 286.54  mfu: 28.97%
[rank3]:2025-11-09 14:50:40,985 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_nofreeze_h200/pipeline_schedule/251109_1450_real_step1200_rank3.svg
[rank3]:> Batch Time: 643.56 ms, GPU Bubble Ratio: 35.18%, 29.89%, 38.05%, 28.15%
[rank0]:2025-11-09 14:52:51,138 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-09 14:52:53,644 - INFO - Avg. fwd time: 13.1197 / Avg. bwd time: 36.4392 / Avg. batch time: 528.0989 (ms) / GPU bubble ratio: 24.92%
[rank3]:2025-11-09 14:52:53,594 - INFO - Avg. fwd time: 14.4939 / Avg. bwd time: 42.9749 / Avg. batch time: 475.2703 (ms) / GPU bubble ratio: 3.27%
[rank1]:2025-11-09 14:52:53,690 - INFO - Avg. fwd time: 15.0190 / Avg. bwd time: 41.1375 / Avg. batch time: 587.5086 (ms) / GPU bubble ratio: 23.53%
[rank0]:2025-11-09 14:52:53,723 - INFO - Avg. fwd time: 13.6136 / Avg. bwd time: 38.3050 / Avg. batch time: 642.6525 (ms) / GPU bubble ratio: 35.37%
[rank1]:2025-11-09 14:52:53,824 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.5195  memory: 64.32GiB(46.00%)  tps: 6,160  tflops: 287.31  mfu: 29.05%
[rank0]:2025-11-09 14:52:53,829 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.5195  memory: 66.72GiB(47.72%)  tps: 6,160  tflops: 287.31  mfu: 29.05%
[rank3]:2025-11-09 14:52:53,826 - INFO -  step: 1250  loss:  0.2513  grad_norm:  0.5195  memory: 73.38GiB(52.48%)  tps: 6,160  tflops: 287.32  mfu: 29.05%
[rank2]:2025-11-09 14:52:53,822 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.5195  memory: 57.29GiB(40.97%)  tps: 6,160  tflops: 287.31  mfu: 29.05%
[rank0]:2025-11-09 14:55:04,231 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-09 14:55:06,671 - INFO - Avg. fwd time: 14.4958 / Avg. bwd time: 42.9764 / Avg. batch time: 475.2894 (ms) / GPU bubble ratio: 3.26%
[rank2]:2025-11-09 14:55:06,721 - INFO - Avg. fwd time: 13.1210 / Avg. bwd time: 36.4397 / Avg. batch time: 528.1074 (ms) / GPU bubble ratio: 24.92%
[rank0]:2025-11-09 14:55:06,800 - INFO - Avg. fwd time: 13.6145 / Avg. bwd time: 38.3047 / Avg. batch time: 642.6590 (ms) / GPU bubble ratio: 35.37%
[rank1]:2025-11-09 14:55:06,767 - INFO - Avg. fwd time: 15.0207 / Avg. bwd time: 41.1373 / Avg. batch time: 587.5155 (ms) / GPU bubble ratio: 23.53%
[rank0]:2025-11-09 14:55:06,904 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.3652  memory: 66.72GiB(47.72%)  tps: 6,156  tflops: 287.11  mfu: 29.03%
[rank1]:2025-11-09 14:55:06,900 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.3652  memory: 64.32GiB(46.00%)  tps: 6,156  tflops: 287.11  mfu: 29.03%
[rank2]:2025-11-09 14:55:06,897 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.3652  memory: 57.29GiB(40.97%)  tps: 6,156  tflops: 287.11  mfu: 29.03%
[rank3]:2025-11-09 14:55:06,902 - INFO -  step: 1300  loss:  0.1793  grad_norm:  0.3652  memory: 73.38GiB(52.48%)  tps: 6,156  tflops: 287.12  mfu: 29.03%
[rank3]:2025-11-09 14:55:07,044 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_nofreeze_h200/pipeline_schedule/251109_1455_real_step1300_rank3.svg
[rank3]:> Batch Time: 638.06 ms, GPU Bubble Ratio: 35.05%, 29.81%, 38.04%, 28.33%
[rank0]:2025-11-09 14:57:18,576 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-09 14:57:21,162 - INFO - Avg. fwd time: 13.1271 / Avg. bwd time: 36.4446 / Avg. batch time: 528.2619 (ms) / GPU bubble ratio: 24.93%
[rank3]:2025-11-09 14:57:21,116 - INFO - Avg. fwd time: 14.5040 / Avg. bwd time: 42.9862 / Avg. batch time: 475.4272 (ms) / GPU bubble ratio: 3.26%
[rank0]:2025-11-09 14:57:21,261 - INFO - Avg. fwd time: 13.6198 / Avg. bwd time: 38.3073 / Avg. batch time: 642.8287 (ms) / GPU bubble ratio: 35.38%
[rank1]:2025-11-09 14:57:21,213 - INFO - Avg. fwd time: 15.0260 / Avg. bwd time: 41.1412 / Avg. batch time: 587.6784 (ms) / GPU bubble ratio: 23.54%
[rank2]:2025-11-09 14:57:21,290 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.4813  memory: 57.29GiB(40.97%)  tps: 6,096  tflops: 284.30  mfu: 28.75%
[rank0]:2025-11-09 14:57:21,296 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.4813  memory: 66.72GiB(47.72%)  tps: 6,096  tflops: 284.30  mfu: 28.75%
[rank1]:2025-11-09 14:57:21,292 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.4813  memory: 64.32GiB(46.00%)  tps: 6,096  tflops: 284.30  mfu: 28.75%
[rank3]:2025-11-09 14:57:21,294 - INFO -  step: 1350  loss:  0.1233  grad_norm:  0.4813  memory: 73.38GiB(52.48%)  tps: 6,096  tflops: 284.30  mfu: 28.75%
[rank0]:2025-11-09 14:59:31,866 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-09 14:59:34,362 - INFO - Avg. fwd time: 14.5046 / Avg. bwd time: 42.9899 / Avg. batch time: 475.4548 (ms) / GPU bubble ratio: 3.26%
[rank0]:2025-11-09 14:59:34,492 - INFO - Avg. fwd time: 13.6188 / Avg. bwd time: 38.3062 / Avg. batch time: 642.8484 (ms) / GPU bubble ratio: 35.38%
[rank1]:2025-11-09 14:59:34,459 - INFO - Avg. fwd time: 15.0266 / Avg. bwd time: 41.1440 / Avg. batch time: 587.6996 (ms) / GPU bubble ratio: 23.54%
[rank2]:2025-11-09 14:59:34,412 - INFO - Avg. fwd time: 13.1276 / Avg. bwd time: 36.4453 / Avg. batch time: 528.2803 (ms) / GPU bubble ratio: 24.93%
[rank2]:2025-11-09 14:59:34,591 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.4837  memory: 57.29GiB(40.97%)  tps: 6,145  tflops: 286.63  mfu: 28.98%
[rank3]:2025-11-09 14:59:34,596 - INFO -  step: 1400  loss:  0.3588  grad_norm:  0.4837  memory: 73.38GiB(52.48%)  tps: 6,146  tflops: 286.63  mfu: 28.98%
[rank0]:2025-11-09 14:59:34,598 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.4837  memory: 66.72GiB(47.72%)  tps: 6,145  tflops: 286.63  mfu: 28.98%
[rank1]:2025-11-09 14:59:34,594 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.4837  memory: 64.32GiB(46.00%)  tps: 6,145  tflops: 286.63  mfu: 28.98%
[rank3]:2025-11-09 14:59:34,736 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_nofreeze_h200/pipeline_schedule/251109_1459_real_step1400_rank3.svg
[rank3]:> Batch Time: 644.66 ms, GPU Bubble Ratio: 35.37%, 29.80%, 38.14%, 27.98%
[rank0]:2025-11-09 15:01:47,335 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-09 15:01:49,791 - INFO - Avg. fwd time: 14.5190 / Avg. bwd time: 43.0094 / Avg. batch time: 475.7226 (ms) / GPU bubble ratio: 3.26%
[rank1]:2025-11-09 15:01:49,889 - INFO - Avg. fwd time: 15.0383 / Avg. bwd time: 41.1549 / Avg. batch time: 588.0059 (ms) / GPU bubble ratio: 23.55%
[rank2]:2025-11-09 15:01:49,841 - INFO - Avg. fwd time: 13.1375 / Avg. bwd time: 36.4517 / Avg. batch time: 528.5674 (ms) / GPU bubble ratio: 24.95%
[rank0]:2025-11-09 15:01:49,921 - INFO - Avg. fwd time: 13.6280 / Avg. bwd time: 38.3111 / Avg. batch time: 643.1623 (ms) / GPU bubble ratio: 35.40%
[rank0]:2025-11-09 15:01:50,026 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.4856  memory: 66.72GiB(47.72%)  tps: 6,049  tflops: 282.13  mfu: 28.53%
[rank1]:2025-11-09 15:01:50,022 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.4856  memory: 64.32GiB(46.00%)  tps: 6,049  tflops: 282.13  mfu: 28.53%
[rank2]:2025-11-09 15:01:50,019 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.4856  memory: 57.29GiB(40.97%)  tps: 6,049  tflops: 282.13  mfu: 28.53%
[rank3]:2025-11-09 15:01:50,024 - INFO -  step: 1450  loss:  0.1871  grad_norm:  0.4856  memory: 73.38GiB(52.48%)  tps: 6,049  tflops: 282.13  mfu: 28.53%
[rank0]:2025-11-09 15:04:03,084 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-09 15:04:05,697 - INFO - Avg. fwd time: 14.5348 / Avg. bwd time: 43.0296 / Avg. batch time: 476.0086 (ms) / GPU bubble ratio: 3.25%
[rank1]:2025-11-09 15:04:05,796 - INFO - Avg. fwd time: 15.0507 / Avg. bwd time: 41.1668 / Avg. batch time: 588.3217 (ms) / GPU bubble ratio: 23.56%
[rank2]:2025-11-09 15:04:05,744 - INFO - Avg. fwd time: 13.1486 / Avg. bwd time: 36.4587 / Avg. batch time: 528.8617 (ms) / GPU bubble ratio: 24.96%
[rank0]:2025-11-09 15:04:05,844 - INFO - Avg. fwd time: 13.6381 / Avg. bwd time: 38.3162 / Avg. batch time: 643.4865 (ms) / GPU bubble ratio: 35.41%
[rank0]:2025-11-09 15:04:05,880 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.5130  memory: 66.72GiB(47.72%)  tps: 6,030  tflops: 281.24  mfu: 28.44%
[rank1]:2025-11-09 15:04:05,876 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.5130  memory: 64.32GiB(46.00%)  tps: 6,030  tflops: 281.24  mfu: 28.44%
[rank2]:2025-11-09 15:04:05,873 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.5130  memory: 57.29GiB(40.97%)  tps: 6,030  tflops: 281.24  mfu: 28.44%
[rank3]:2025-11-09 15:04:05,878 - INFO -  step: 1500  loss:  0.2551  grad_norm:  0.5130  memory: 73.38GiB(52.48%)  tps: 6,030  tflops: 281.24  mfu: 28.44%
[rank3]:2025-11-09 15:04:06,019 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_nofreeze_h200/pipeline_schedule/251109_1504_real_step1500_rank3.svg
[rank3]:> Batch Time: 654.34 ms, GPU Bubble Ratio: 35.67%, 30.23%, 38.49%, 28.01%
[rank0]:2025-11-09 15:06:18,990 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-09 15:06:21,485 - INFO - Avg. fwd time: 14.5483 / Avg. bwd time: 43.0474 / Avg. batch time: 476.2556 (ms) / GPU bubble ratio: 3.25%
[rank1]:2025-11-09 15:06:21,582 - INFO - Avg. fwd time: 15.0615 / Avg. bwd time: 41.1768 / Avg. batch time: 588.6055 (ms) / GPU bubble ratio: 23.56%
[rank0]:2025-11-09 15:06:21,616 - INFO - Avg. fwd time: 13.6472 / Avg. bwd time: 38.3210 / Avg. batch time: 643.7781 (ms) / GPU bubble ratio: 35.42%
[rank2]:2025-11-09 15:06:21,535 - INFO - Avg. fwd time: 13.1583 / Avg. bwd time: 36.4646 / Avg. batch time: 529.1279 (ms) / GPU bubble ratio: 24.97%
[rank1]:2025-11-09 15:06:21,715 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.5140  memory: 64.32GiB(46.00%)  tps: 6,031  tflops: 281.27  mfu: 28.44%
[rank0]:2025-11-09 15:06:21,719 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.5140  memory: 66.72GiB(47.72%)  tps: 6,031  tflops: 281.27  mfu: 28.44%
[rank2]:2025-11-09 15:06:21,713 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.5140  memory: 57.29GiB(40.97%)  tps: 6,031  tflops: 281.27  mfu: 28.44%
[rank3]:2025-11-09 15:06:21,718 - INFO -  step: 1550  loss:  0.2657  grad_norm:  0.5140  memory: 73.38GiB(52.48%)  tps: 6,031  tflops: 281.27  mfu: 28.44%
[rank0]:2025-11-09 15:08:33,495 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-09 15:08:35,998 - INFO - Avg. fwd time: 14.5542 / Avg. bwd time: 43.0545 / Avg. batch time: 476.3555 (ms) / GPU bubble ratio: 3.25%
[rank2]:2025-11-09 15:08:36,047 - INFO - Avg. fwd time: 13.1637 / Avg. bwd time: 36.4676 / Avg. batch time: 529.2245 (ms) / GPU bubble ratio: 24.97%
[rank1]:2025-11-09 15:08:36,095 - INFO - Avg. fwd time: 15.0660 / Avg. bwd time: 41.1800 / Avg. batch time: 588.7070 (ms) / GPU bubble ratio: 23.57%
[rank0]:2025-11-09 15:08:36,128 - INFO - Avg. fwd time: 13.6508 / Avg. bwd time: 38.3230 / Avg. batch time: 643.8828 (ms) / GPU bubble ratio: 35.42%
[rank2]:2025-11-09 15:08:36,226 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.8126  memory: 57.29GiB(40.97%)  tps: 6,090  tflops: 284.05  mfu: 28.72%
[rank1]:2025-11-09 15:08:36,228 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.8126  memory: 64.32GiB(46.00%)  tps: 6,090  tflops: 284.05  mfu: 28.72%
[rank0]:2025-11-09 15:08:36,233 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.8126  memory: 66.72GiB(47.72%)  tps: 6,090  tflops: 284.04  mfu: 28.72%
[rank3]:2025-11-09 15:08:36,230 - INFO -  step: 1600  loss:  0.4004  grad_norm:  0.8126  memory: 73.38GiB(52.48%)  tps: 6,090  tflops: 284.05  mfu: 28.72%
[rank3]:2025-11-09 15:08:36,371 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_nofreeze_h200/pipeline_schedule/251109_1508_real_step1600_rank3.svg
[rank3]:> Batch Time: 649.25 ms, GPU Bubble Ratio: 35.35%, 30.04%, 38.10%, 28.04%
[rank0]:2025-11-09 15:10:48,904 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-09 15:10:51,513 - INFO - Avg. fwd time: 14.5646 / Avg. bwd time: 43.0675 / Avg. batch time: 476.5398 (ms) / GPU bubble ratio: 3.25%
[rank2]:2025-11-09 15:10:51,561 - INFO - Avg. fwd time: 13.1717 / Avg. bwd time: 36.4715 / Avg. batch time: 529.4242 (ms) / GPU bubble ratio: 24.99%
[rank1]:2025-11-09 15:10:51,613 - INFO - Avg. fwd time: 15.0746 / Avg. bwd time: 41.1870 / Avg. batch time: 588.9192 (ms) / GPU bubble ratio: 23.57%
[rank0]:2025-11-09 15:10:51,662 - INFO - Avg. fwd time: 13.6578 / Avg. bwd time: 38.3265 / Avg. batch time: 644.1021 (ms) / GPU bubble ratio: 35.43%
[rank0]:2025-11-09 15:10:51,698 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.8656  memory: 66.72GiB(47.72%)  tps: 6,047  tflops: 282.05  mfu: 28.52%
[rank2]:2025-11-09 15:10:51,691 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.8656  memory: 57.29GiB(40.97%)  tps: 6,047  tflops: 282.05  mfu: 28.52%
[rank3]:2025-11-09 15:10:51,696 - INFO -  step: 1650  loss:  0.4333  grad_norm:  0.8656  memory: 73.38GiB(52.48%)  tps: 6,047  tflops: 282.05  mfu: 28.52%
[rank1]:2025-11-09 15:10:51,694 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.8656  memory: 64.32GiB(46.00%)  tps: 6,047  tflops: 282.05  mfu: 28.52%
[rank0]:2025-11-09 15:13:04,591 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-09 15:13:07,143 - INFO - Avg. fwd time: 13.1777 / Avg. bwd time: 36.4751 / Avg. batch time: 529.5962 (ms) / GPU bubble ratio: 25.00%
[rank3]:2025-11-09 15:13:07,094 - INFO - Avg. fwd time: 14.5735 / Avg. bwd time: 43.0802 / Avg. batch time: 476.7105 (ms) / GPU bubble ratio: 3.25%
[rank0]:2025-11-09 15:13:07,223 - INFO - Avg. fwd time: 13.6630 / Avg. bwd time: 38.3293 / Avg. batch time: 644.2874 (ms) / GPU bubble ratio: 35.44%
[rank1]:2025-11-09 15:13:07,190 - INFO - Avg. fwd time: 15.0820 / Avg. bwd time: 41.1938 / Avg. batch time: 589.1015 (ms) / GPU bubble ratio: 23.58%
[rank0]:2025-11-09 15:13:07,327 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.6199  memory: 66.72GiB(47.72%)  tps: 6,040  tflops: 281.71  mfu: 28.48%
[rank2]:2025-11-09 15:13:07,320 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.6199  memory: 57.29GiB(40.97%)  tps: 6,040  tflops: 281.71  mfu: 28.48%
[rank3]:2025-11-09 15:13:07,325 - INFO -  step: 1700  loss:  0.4007  grad_norm:  0.6199  memory: 73.38GiB(52.48%)  tps: 6,040  tflops: 281.71  mfu: 28.48%
[rank1]:2025-11-09 15:13:07,323 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.6199  memory: 64.32GiB(46.00%)  tps: 6,040  tflops: 281.71  mfu: 28.48%
[rank3]:2025-11-09 15:13:07,465 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_nofreeze_h200/pipeline_schedule/251109_1513_real_step1700_rank3.svg
[rank3]:> Batch Time: 650.25 ms, GPU Bubble Ratio: 35.49%, 29.95%, 38.30%, 27.92%
[rank0]:2025-11-09 15:15:19,950 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-09 15:15:22,457 - INFO - Avg. fwd time: 14.5824 / Avg. bwd time: 43.0923 / Avg. batch time: 476.8756 (ms) / GPU bubble ratio: 3.25%
[rank1]:2025-11-09 15:15:22,553 - INFO - Avg. fwd time: 15.0893 / Avg. bwd time: 41.2000 / Avg. batch time: 589.2906 (ms) / GPU bubble ratio: 23.58%
[rank2]:2025-11-09 15:15:22,506 - INFO - Avg. fwd time: 13.1839 / Avg. bwd time: 36.4787 / Avg. batch time: 529.7748 (ms) / GPU bubble ratio: 25.01%
[rank0]:2025-11-09 15:15:22,586 - INFO - Avg. fwd time: 13.6681 / Avg. bwd time: 38.3321 / Avg. batch time: 644.4802 (ms) / GPU bubble ratio: 35.45%
[rank3]:2025-11-09 15:15:22,688 - INFO -  step: 1750  loss:  0.4073  grad_norm:  0.5867  memory: 73.38GiB(52.48%)  tps: 6,052  tflops: 282.26  mfu: 28.54%
[rank1]:2025-11-09 15:15:22,686 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.5867  memory: 64.32GiB(46.00%)  tps: 6,052  tflops: 282.26  mfu: 28.54%
[rank0]:2025-11-09 15:15:22,690 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.5867  memory: 66.72GiB(47.72%)  tps: 6,052  tflops: 282.26  mfu: 28.54%
[rank2]:2025-11-09 15:15:22,684 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.5867  memory: 57.29GiB(40.97%)  tps: 6,052  tflops: 282.26  mfu: 28.54%
[rank0]:2025-11-09 15:17:32,611 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-09 15:17:35,086 - INFO - Avg. fwd time: 14.5777 / Avg. bwd time: 43.0882 / Avg. batch time: 476.8001 (ms) / GPU bubble ratio: 3.25%
[rank2]:2025-11-09 15:17:35,134 - INFO - Avg. fwd time: 13.1811 / Avg. bwd time: 36.4761 / Avg. batch time: 529.6868 (ms) / GPU bubble ratio: 25.00%
[rank1]:2025-11-09 15:17:35,186 - INFO - Avg. fwd time: 15.0850 / Avg. bwd time: 41.1989 / Avg. batch time: 589.2007 (ms) / GPU bubble ratio: 23.58%
[rank1]:2025-11-09 15:17:35,268 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.3060  memory: 64.32GiB(46.00%)  tps: 6,179  tflops: 288.18  mfu: 29.14%
[rank2]:2025-11-09 15:17:35,266 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.3060  memory: 57.29GiB(40.97%)  tps: 6,179  tflops: 288.18  mfu: 29.14%
[rank3]:2025-11-09 15:17:35,270 - INFO -  step: 1800  loss:  0.0754  grad_norm:  0.3060  memory: 73.38GiB(52.48%)  tps: 6,179  tflops: 288.18  mfu: 29.14%
[rank0]:2025-11-09 15:17:35,237 - INFO - Avg. fwd time: 13.6636 / Avg. bwd time: 38.3302 / Avg. batch time: 644.3869 (ms) / GPU bubble ratio: 35.45%
[rank0]:2025-11-09 15:17:35,272 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.3060  memory: 66.72GiB(47.72%)  tps: 6,179  tflops: 288.18  mfu: 29.14%
[rank3]:2025-11-09 15:17:35,411 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_nofreeze_h200/pipeline_schedule/251109_1517_real_step1800_rank3.svg
[rank3]:> Batch Time: 630.84 ms, GPU Bubble Ratio: 34.89%, 29.52%, 37.99%, 28.52%
[rank0]:2025-11-09 15:19:44,757 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-09 15:19:47,282 - INFO - Avg. fwd time: 15.0805 / Avg. bwd time: 41.1955 / Avg. batch time: 589.0960 (ms) / GPU bubble ratio: 23.58%
[rank2]:2025-11-09 15:19:47,235 - INFO - Avg. fwd time: 13.1777 / Avg. bwd time: 36.4734 / Avg. batch time: 529.5881 (ms) / GPU bubble ratio: 25.00%
[rank3]:2025-11-09 15:19:47,186 - INFO - Avg. fwd time: 14.5722 / Avg. bwd time: 43.0821 / Avg. batch time: 476.7018 (ms) / GPU bubble ratio: 3.24%
[rank0]:2025-11-09 15:19:47,314 - INFO - Avg. fwd time: 13.6594 / Avg. bwd time: 38.3275 / Avg. batch time: 644.2770 (ms) / GPU bubble ratio: 35.45%
[rank0]:2025-11-09 15:19:47,417 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.6471  memory: 66.72GiB(47.72%)  tps: 6,199  tflops: 289.13  mfu: 29.24%
[rank1]:2025-11-09 15:19:47,413 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.6471  memory: 64.32GiB(46.00%)  tps: 6,199  tflops: 289.14  mfu: 29.24%
[rank2]:2025-11-09 15:19:47,410 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.6471  memory: 57.29GiB(40.97%)  tps: 6,199  tflops: 289.14  mfu: 29.24%
[rank3]:2025-11-09 15:19:47,415 - INFO -  step: 1850  loss:  0.3550  grad_norm:  0.6471  memory: 73.38GiB(52.48%)  tps: 6,199  tflops: 289.14  mfu: 29.24%
[rank0]:2025-11-09 15:21:56,190 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-09 15:21:58,656 - INFO - Avg. fwd time: 13.1709 / Avg. bwd time: 36.4689 / Avg. batch time: 529.4125 (ms) / GPU bubble ratio: 24.99%
[rank3]:2025-11-09 15:21:58,608 - INFO - Avg. fwd time: 14.5632 / Avg. bwd time: 43.0721 / Avg. batch time: 476.5442 (ms) / GPU bubble ratio: 3.24%
[rank1]:2025-11-09 15:21:58,703 - INFO - Avg. fwd time: 15.0728 / Avg. bwd time: 41.1905 / Avg. batch time: 588.9093 (ms) / GPU bubble ratio: 23.57%
[rank0]:2025-11-09 15:21:58,736 - INFO - Avg. fwd time: 13.6514 / Avg. bwd time: 38.3236 / Avg. batch time: 644.0815 (ms) / GPU bubble ratio: 35.44%
[rank2]:2025-11-09 15:21:58,831 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.3051  memory: 57.29GiB(40.97%)  tps: 6,233  tflops: 290.73  mfu: 29.40%
[rank3]:2025-11-09 15:21:58,836 - INFO -  step: 1900  loss:  0.2032  grad_norm:  0.3051  memory: 73.38GiB(52.48%)  tps: 6,233  tflops: 290.73  mfu: 29.40%
[rank1]:2025-11-09 15:21:58,834 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.3051  memory: 64.32GiB(46.00%)  tps: 6,233  tflops: 290.73  mfu: 29.40%
[rank0]:2025-11-09 15:21:58,838 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.3051  memory: 66.72GiB(47.72%)  tps: 6,233  tflops: 290.73  mfu: 29.40%
[rank3]:2025-11-09 15:21:58,976 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_nofreeze_h200/pipeline_schedule/251109_1521_real_step1900_rank3.svg
[rank3]:> Batch Time: 635.47 ms, GPU Bubble Ratio: 35.06%, 29.68%, 38.04%, 28.36%
[rank0]:2025-11-09 15:24:07,230 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-09 15:24:09,789 - INFO - Avg. fwd time: 13.1631 / Avg. bwd time: 36.4634 / Avg. batch time: 529.2270 (ms) / GPU bubble ratio: 24.98%
[rank3]:2025-11-09 15:24:09,741 - INFO - Avg. fwd time: 14.5529 / Avg. bwd time: 43.0608 / Avg. batch time: 476.3653 (ms) / GPU bubble ratio: 3.24%
[rank0]:2025-11-09 15:24:09,892 - INFO - Avg. fwd time: 13.6425 / Avg. bwd time: 38.3193 / Avg. batch time: 643.8749 (ms) / GPU bubble ratio: 35.44%
[rank1]:2025-11-09 15:24:09,841 - INFO - Avg. fwd time: 15.0646 / Avg. bwd time: 41.1852 / Avg. batch time: 588.7116 (ms) / GPU bubble ratio: 23.56%
[rank2]:2025-11-09 15:24:09,921 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.2920  memory: 57.29GiB(40.97%)  tps: 6,249  tflops: 291.46  mfu: 29.47%
[rank3]:2025-11-09 15:24:09,925 - INFO -  step: 1950  loss:  0.1732  grad_norm:  0.2920  memory: 73.38GiB(52.48%)  tps: 6,249  tflops: 291.47  mfu: 29.47%
[rank0]:2025-11-09 15:24:09,927 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.2920  memory: 66.72GiB(47.72%)  tps: 6,249  tflops: 291.46  mfu: 29.47%
[rank1]:2025-11-09 15:24:09,923 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.2920  memory: 64.32GiB(46.00%)  tps: 6,249  tflops: 291.46  mfu: 29.47%
[rank0]:2025-11-09 15:26:18,199 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-09 15:26:20,677 - INFO - Avg. fwd time: 13.1568 / Avg. bwd time: 36.4594 / Avg. batch time: 529.0571 (ms) / GPU bubble ratio: 24.97%
[rank3]:2025-11-09 15:26:20,628 - INFO - Avg. fwd time: 14.5439 / Avg. bwd time: 43.0511 / Avg. batch time: 476.2104 (ms) / GPU bubble ratio: 3.24%
[rank1]:2025-11-09 15:26:20,723 - INFO - Avg. fwd time: 15.0572 / Avg. bwd time: 41.1811 / Avg. batch time: 588.5313 (ms) / GPU bubble ratio: 23.55%
[rank0]:2025-11-09 15:26:20,756 - INFO - Avg. fwd time: 13.6350 / Avg. bwd time: 38.3156 / Avg. batch time: 643.6863 (ms) / GPU bubble ratio: 35.43%
[rank2]:2025-11-09 15:26:20,851 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.2789  memory: 57.29GiB(40.97%)  tps: 6,257  tflops: 291.82  mfu: 29.51%
[rank2]:2025-11-09 15:26:20,851 - INFO -  final step: 2000  loss: -4.0000  grad_norm:  0.2789  tps: 6,259  tflops: 291.93  mfu: 28.29%
[rank2]:2025-11-09 15:26:20,851 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-09 15:26:20,854 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2000.
[rank3]:2025-11-09 15:26:20,856 - INFO -  step: 2000  loss:  0.2079  grad_norm:  0.2789  memory: 73.38GiB(52.48%)  tps: 6,257  tflops: 291.82  mfu: 29.51%
[rank3]:2025-11-09 15:26:20,856 - INFO -  final step: 2000  loss:  0.2079  grad_norm:  0.2789  tps: 6,261  tflops: 292.04  mfu: 28.30%
[rank3]:2025-11-09 15:26:20,857 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-11-09 15:26:20,859 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2000.
[rank1]:2025-11-09 15:26:20,854 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.2789  memory: 64.32GiB(46.00%)  tps: 6,257  tflops: 291.82  mfu: 29.51%
[rank1]:2025-11-09 15:26:20,854 - INFO -  final step: 2000  loss: -4.0000  grad_norm:  0.2789  tps: 6,259  tflops: 291.93  mfu: 28.29%
[rank1]:2025-11-09 15:26:20,854 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-11-09 15:26:20,859 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2000.
[rank0]:2025-11-09 15:26:20,858 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.2789  memory: 66.72GiB(47.72%)  tps: 6,257  tflops: 291.82  mfu: 29.51%
[rank0]:2025-11-09 15:26:20,858 - INFO -  final step: 2000  loss: -4.0000  grad_norm:  0.2789  tps: 6,259  tflops: 291.93  mfu: 28.29%
[rank0]:2025-11-09 15:26:20,858 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-09 15:26:20,863 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2000.
[rank2]:2025-11-09 15:26:30,440 - INFO - Destroying the purge thread.
[rank1]:2025-11-09 15:26:30,440 - INFO - Destroying the purge thread.
[rank0]:2025-11-09 15:26:30,418 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-11-09 15:26:30,440 - INFO - Sleeping 2 seconds for other ranks to complete
[rank3]:2025-11-09 15:26:30,575 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_nofreeze_h200/pipeline_schedule/251109_1526_real_final2000_rank3.svg
[rank3]:> Batch Time: 642.59 ms, GPU Bubble Ratio: 35.13%, 29.80%, 38.08%, 28.15%
[rank3]:2025-11-09 15:26:30,703 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_nofreeze_h200/pipeline_schedule/251109_1526_thry_final2000_rank3.svg
[rank3]:> Batch Time: 465.08 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:2025-11-09 15:26:30,703 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading output.log; uploading config.yaml
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm  â–ˆâ–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–‡â–ˆâ–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–‡â–ˆâ–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 2.61663
[rank3]:wandb:               final/avg_loss 0.2079
[rank3]:wandb:             final/avg_mfu(%) 28.30247
[rank3]:wandb:             final/avg_tflops 292.03712
[rank3]:wandb:    final/avg_throughput(tps) 6261.49462
[rank3]:wandb:              final/grad_norm 0.27893
[rank3]:wandb:               final/max_loss 0.2079
[rank3]:wandb:                    grad_norm 0.27893
[rank3]:wandb: loss_metrics/global_avg_loss 0.2079
[rank3]:wandb: loss_metrics/global_max_loss 0.2079
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1109_GPipe_nofreeze_h200 at: https://wandb.ai/orangingq/torchtitan/runs/9rg42b2j
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: ._data/tb/1109_GPipe_nofreeze_h200/20251109-1356/wandb/run-20251109_135655-9rg42b2j/logs
[rank0]:2025-11-09 15:26:32,440 - INFO - Training completed
[rank0]:2025-11-09 15:26:32,440 - INFO - Destroying the purge thread.
[rank1]:2025-11-09 15:26:32,697 - INFO - Process group destroyed
[rank2]:2025-11-09 15:26:32,714 - INFO - Process group destroyed
[rank3]:2025-11-09 15:26:32,695 - INFO - Process group destroyed
[rank0]:2025-11-09 15:26:32,821 - INFO - Process group destroyed
[rank1]:Stage 1: Modules to keep: {'layers.9', 'layers.10', 'layers.15', 'layers.12', 'layers.11', 'layers.14', 'layers.8', 'layers.16', 'layers.13'}
[rank0]:Stage 0: Modules to keep: {'tok_embeddings', 'layers.1', 'layers.6', 'layers.3', 'layers.5', 'layers.2', 'layers.7', 'layers.4', 'layers.0'}
[rank2]:Stage 2: Modules to keep: {'layers.24', 'layers.20', 'layers.23', 'layers.18', 'layers.22', 'layers.21', 'layers.17', 'layers.19'}
[rank3]:Stage 3: Modules to keep: {'layers.31', 'layers.29', 'layers.28', 'output', 'layers.25', 'norm', 'layers.26', 'layers.27', 'layers.30'}
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1104_llama8b/config_1109.toml
[rank3]:		- dump_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data
[rank3]:		- description: "Llama 3.1 8B Experiment
[rank3]:1109: 1) resolved timelyapf issue, 2) seed fixed to 42 for all runs, 3) 3000 steps -> 2000 steps (better benchmark scores!)
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1109_GPipe_nofreeze_h200
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/profile_trace/1109_GPipe_nofreeze_h200
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/memory_snapshot/1109_GPipe_nofreeze_h200
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1109_GPipe_nofreeze_h200
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_nofreeze_h200
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1109_GPipe_nofreeze_h200
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 8B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.1-8B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 3e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.999
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 200
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: openhermes
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 2000
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 42
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: GPipe
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1109_GPipe_nofreeze_h200
[rank3]:		- interval: 1000
[rank3]:		- initial_load_path: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/comm_traces/1109_GPipe_nofreeze_h200
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 8
[rank3]:		- seq_len: 2048
[rank3]:		- freq: 10
[rank3]:		- steps: -1
[rank3]:	- freezing:
[rank3]:		- freeze: False
[rank3]:		- metric_type: apf
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.7
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.05
[rank3]:		- percentile: 70
[rank3]:
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
