
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: Sun Nov 16 14:37:54 UTC 2025
âœ”ï¸SERVER: wbl-kaist-gpu-2 (172.16.131.118),  GPUs: 3,4,5,6
âœ”ï¸SCRIPT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1104_llama8b/run.sh
âœ”ï¸OUTPUT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1104_llama8b/1116_GPipe_nofreeze.log
âœ”ï¸Llama 3.1 8B Experiment
1109: 1) resolved timelyapf issue, 2) seed fixed to 42 for all runs, 3) 3000 steps -> 2000 steps (better benchmark scores!)
1116: everything same, but with seed=11

âœ”ï¸Running with nofreeze x GPipe ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1104_llama8b/config_1116.toml --job.description="Llama 3.1 8B Experiment
1109: 1) resolved timelyapf issue, 2) seed fixed to 42 for all runs, 3) 3000 steps -> 2000 steps (better benchmark scores!)
1116: everything same, but with seed=11
" --parallelism.pipeline_parallel_degree=4  --freezing.no-freeze
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
W1116 14:37:55.457000 4134789 site-packages/torch/distributed/run.py:811] 
W1116 14:37:55.457000 4134789 site-packages/torch/distributed/run.py:811] *****************************************
W1116 14:37:55.457000 4134789 site-packages/torch/distributed/run.py:811] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1116 14:37:55.457000 4134789 site-packages/torch/distributed/run.py:811] *****************************************
[rank1]:2025-11-16 14:38:02,487 - INFO - Starting job: "Llama 3.1 8B Experiment
[rank1]:1109: 1) resolved timelyapf issue, 2) seed fixed to 42 for all runs, 3) 3000 steps -> 2000 steps (better benchmark scores!)
[rank1]:1116: everything same, but with seed=11
[rank1]:"
[rank3]:2025-11-16 14:38:02,552 - INFO - Starting job: "Llama 3.1 8B Experiment
[rank3]:1109: 1) resolved timelyapf issue, 2) seed fixed to 42 for all runs, 3) 3000 steps -> 2000 steps (better benchmark scores!)
[rank3]:1116: everything same, but with seed=11
[rank3]:"
[rank0]:2025-11-16 14:38:02,648 - INFO - Starting job: "Llama 3.1 8B Experiment
[rank0]:1109: 1) resolved timelyapf issue, 2) seed fixed to 42 for all runs, 3) 3000 steps -> 2000 steps (better benchmark scores!)
[rank0]:1116: everything same, but with seed=11
[rank0]:"
[rank2]:2025-11-16 14:38:02,670 - INFO - Starting job: "Llama 3.1 8B Experiment
[rank2]:1109: 1) resolved timelyapf issue, 2) seed fixed to 42 for all runs, 3) 3000 steps -> 2000 steps (better benchmark scores!)
[rank2]:1116: everything same, but with seed=11
[rank2]:"
[rank1]:2025-11-16 14:38:03,308 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-11-16 14:38:03,310 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-11-16 14:38:03,480 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-11-16 14:38:03,482 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-16 14:38:03,580 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-11-16 14:38:03,582 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-16 14:38:03,587 - INFO - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-11-16 14:38:03,589 - INFO - Loading tokenizer from tokenizer.json
[rank2]:2025-11-16 14:38:03,591 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-11-16 14:38:03,593 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-16 14:38:03,868 - INFO - Preparing openhermes dataset from teknium/OpenHermes-2.5
[rank0]:2025-11-16 14:38:05,612 - INFO - Building llama3 8B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=4096, n_layers=32, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=1024, ffn_dim_multiplier=1.3, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank1]:2025-11-16 14:38:05,774 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank1]:2025-11-16 14:38:05,848 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.8', 'layers.9', 'layers.10', 'layers.11', 'layers.12', 'layers.13', 'layers.14', 'layers.15', 'layers.16']
[rank1]:2025-11-16 14:38:05,849 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank2]:2025-11-16 14:38:05,867 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank0]:2025-11-16 14:38:05,871 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank2]:2025-11-16 14:38:05,962 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.17', 'layers.18', 'layers.19', 'layers.20', 'layers.21', 'layers.22', 'layers.23', 'layers.24']
[rank2]:2025-11-16 14:38:05,963 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-11-16 14:38:05,940 - INFO - Model llama3 8B size: 8,030,261,248 total parameters
[rank0]:2025-11-16 14:38:05,965 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3', 'layers.4', 'layers.5', 'layers.6', 'layers.7']
[rank0]:2025-11-16 14:38:05,965 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank1]:2025-11-16 14:38:06,084 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank1]:2025-11-16 14:38:06,084 - INFO - CUDA memory usage for model: 7.33GiB(5.24%)
[rank2]:2025-11-16 14:38:06,252 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank2]:2025-11-16 14:38:06,253 - INFO - CUDA memory usage for model: 6.51GiB(4.65%)
[rank0]:2025-11-16 14:38:06,258 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank0]:2025-11-16 14:38:06,259 - INFO - CUDA memory usage for model: 8.46GiB(6.05%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run trmm57au
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1116_GPipe_nofreeze_h200/20251116-1438/wandb/run-20251116_143806-trmm57au
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1116_GPipe_nofreeze_h200
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/trmm57au
[rank3]:2025-11-16 14:38:08,093 - INFO - WandB logging enabled
[rank3]:2025-11-16 14:38:08,094 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank3]:2025-11-16 14:38:08,166 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.25', 'layers.26', 'layers.27', 'layers.28', 'layers.29', 'layers.30', 'layers.31', 'norm', 'output']
[rank3]:2025-11-16 14:38:08,166 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2025-11-16 14:38:08,398 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-11-16 14:38:08,384 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank3]:2025-11-16 14:38:08,384 - INFO - CUDA memory usage for model: 7.66GiB(5.48%)
[rank3]:2025-11-16 14:38:08,397 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-16 14:38:08,397 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1116_GPipe_nofreeze_h200
[rank0]:2025-11-16 14:38:08,397 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-16 14:38:08,397 - INFO - Trainer is initialized with local batch size 16, global batch size 64, gradient accumulation steps 4, sequence length 1024, total steps 2000 (warmup 200)
[rank0]:2025-11-16 14:38:08,397 - INFO - Loading the checkpoint from /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B/original_dcp.
[rank2]:2025-11-16 14:38:08,397 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-16 14:38:18,775 - INFO - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-11-16 14:38:18,775 - INFO - Finished loading the checkpoint in 10.38 seconds.
[rank0]:2025-11-16 14:38:18,775 - INFO - Training starts at step 1
[rank0]:2025-11-16 14:38:23,353 - INFO -  step:  1  loss: -4.0000  grad_norm:     inf  memory: 49.75GiB(35.58%)  tps: 941  tflops: 43.88  mfu: 4.44%
[rank0]:2025-11-16 14:38:23,353 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-11-16 14:38:23,334 - INFO -  step:  1  loss: -4.0000  grad_norm:     inf  memory: 49.69GiB(35.54%)  tps: 936  tflops: 43.64  mfu: 4.41%
[rank1]:2025-11-16 14:38:23,334 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-11-16 14:38:23,333 - INFO -  step:  1  loss: -4.0000  grad_norm:     inf  memory: 44.28GiB(31.67%)  tps: 942  tflops: 43.93  mfu: 4.44%
[rank2]:2025-11-16 14:38:23,333 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-11-16 14:38:23,336 - INFO -  step:  1  loss:  8.2933  grad_norm:     inf  memory: 58.03GiB(41.50%)  tps: 1,078  tflops: 50.30  mfu: 5.09%
[rank3]:2025-11-16 14:38:23,337 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-16 14:40:30,527 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-16 14:40:32,964 - INFO - Avg. fwd time: 14.4305 / Avg. bwd time: 42.4297 / Avg. batch time: 474.0487 (ms) / GPU bubble ratio: 4.04%
[rank0]:2025-11-16 14:40:33,093 - INFO - Avg. fwd time: 14.1526 / Avg. bwd time: 38.3546 / Avg. batch time: 645.4860 (ms) / GPU bubble ratio: 34.92%
[rank2]:2025-11-16 14:40:33,014 - INFO - Avg. fwd time: 13.0917 / Avg. bwd time: 36.2140 / Avg. batch time: 528.0091 (ms) / GPU bubble ratio: 25.30%
[rank1]:2025-11-16 14:40:33,060 - INFO - Avg. fwd time: 15.1409 / Avg. bwd time: 41.4619 / Avg. batch time: 589.3098 (ms) / GPU bubble ratio: 23.16%
[rank3]:2025-11-16 14:40:33,201 - INFO -  step: 50  loss:  9.4313  grad_norm: 5105.3687  memory: 73.38GiB(52.48%)  tps: 6,182  tflops: 288.33  mfu: 29.15%
[rank2]:2025-11-16 14:40:33,197 - INFO -  step: 50  loss: -4.0000  grad_norm: 5105.3687  memory: 57.29GiB(40.97%)  tps: 6,182  tflops: 288.33  mfu: 29.15%
[rank1]:2025-11-16 14:40:33,199 - INFO -  step: 50  loss: -4.0000  grad_norm: 5105.3687  memory: 64.32GiB(46.00%)  tps: 6,182  tflops: 288.33  mfu: 29.15%
[rank0]:2025-11-16 14:40:33,203 - INFO -  step: 50  loss: -4.0000  grad_norm: 5105.3687  memory: 66.72GiB(47.72%)  tps: 6,183  tflops: 288.36  mfu: 29.16%
[rank0]:2025-11-16 14:42:42,796 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-16 14:42:45,270 - INFO - Avg. fwd time: 13.1053 / Avg. bwd time: 36.2798 / Avg. batch time: 525.6461 (ms) / GPU bubble ratio: 24.84%
[rank3]:2025-11-16 14:42:45,221 - INFO - Avg. fwd time: 14.4197 / Avg. bwd time: 42.5102 / Avg. batch time: 472.5088 (ms) / GPU bubble ratio: 3.61%
[rank1]:2025-11-16 14:42:45,319 - INFO - Avg. fwd time: 15.1638 / Avg. bwd time: 41.5879 / Avg. batch time: 586.5635 (ms) / GPU bubble ratio: 22.60%
[rank0]:2025-11-16 14:42:45,352 - INFO - Avg. fwd time: 13.8650 / Avg. bwd time: 38.4051 / Avg. batch time: 642.2996 (ms) / GPU bubble ratio: 34.90%
[rank1]:2025-11-16 14:42:45,456 - INFO -  step: 100  loss: -4.0000  grad_norm: 171.9571  memory: 64.32GiB(46.00%)  tps: 6,194  tflops: 288.89  mfu: 29.21%
[rank0]:2025-11-16 14:42:45,460 - INFO -  step: 100  loss: -4.0000  grad_norm: 171.9571  memory: 66.72GiB(47.72%)  tps: 6,194  tflops: 288.89  mfu: 29.21%
[rank2]:2025-11-16 14:42:45,454 - INFO -  step: 100  loss: -4.0000  grad_norm: 171.9571  memory: 57.29GiB(40.97%)  tps: 6,194  tflops: 288.89  mfu: 29.21%
[rank3]:2025-11-16 14:42:45,458 - INFO -  step: 100  loss:  4.4090  grad_norm: 171.9571  memory: 73.38GiB(52.48%)  tps: 6,194  tflops: 288.89  mfu: 29.21%
[rank3]:2025-11-16 14:42:45,623 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1116_GPipe_nofreeze_h200/pipeline_schedule/251116_1442_real_step100_rank3.svg
[rank3]:> Batch Time: 638.75 ms, GPU Bubble Ratio: 34.66%, 28.23%, 37.81%, 28.65%
[rank0]:2025-11-16 14:44:54,928 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-16 14:44:57,491 - INFO - Avg. fwd time: 13.0656 / Avg. bwd time: 36.3419 / Avg. batch time: 524.2153 (ms) / GPU bubble ratio: 24.60%
[rank3]:2025-11-16 14:44:57,449 - INFO - Avg. fwd time: 14.3599 / Avg. bwd time: 42.4793 / Avg. batch time: 471.1410 (ms) / GPU bubble ratio: 3.49%
[rank0]:2025-11-16 14:44:57,581 - INFO - Avg. fwd time: 13.7372 / Avg. bwd time: 38.3837 / Avg. batch time: 640.9529 (ms) / GPU bubble ratio: 34.95%
[rank0]:2025-11-16 14:44:57,617 - INFO -  step: 150  loss: -4.0000  grad_norm: 30.6412  memory: 66.72GiB(47.72%)  tps: 6,199  tflops: 289.11  mfu: 29.23%
[rank2]:2025-11-16 14:44:57,610 - INFO -  step: 150  loss: -4.0000  grad_norm: 30.6412  memory: 57.29GiB(40.97%)  tps: 6,199  tflops: 289.11  mfu: 29.23%
[rank1]:2025-11-16 14:44:57,538 - INFO - Avg. fwd time: 15.1773 / Avg. bwd time: 41.7158 / Avg. batch time: 585.4389 (ms) / GPU bubble ratio: 22.26%
[rank1]:2025-11-16 14:44:57,613 - INFO -  step: 150  loss: -4.0000  grad_norm: 30.6412  memory: 64.32GiB(46.00%)  tps: 6,199  tflops: 289.11  mfu: 29.23%
[rank3]:2025-11-16 14:44:57,615 - INFO -  step: 150  loss:  1.9656  grad_norm: 30.6412  memory: 73.38GiB(52.48%)  tps: 6,199  tflops: 289.11  mfu: 29.23%
[rank0]:2025-11-16 14:47:06,816 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-16 14:47:09,235 - INFO - Avg. fwd time: 14.3171 / Avg. bwd time: 42.4665 / Avg. batch time: 470.4175 (ms) / GPU bubble ratio: 3.43%
[rank1]:2025-11-16 14:47:09,331 - INFO - Avg. fwd time: 15.1774 / Avg. bwd time: 41.7805 / Avg. batch time: 584.7098 (ms) / GPU bubble ratio: 22.07%
[rank2]:2025-11-16 14:47:09,284 - INFO - Avg. fwd time: 13.0379 / Avg. bwd time: 36.3757 / Avg. batch time: 523.3529 (ms) / GPU bubble ratio: 24.47%
[rank0]:2025-11-16 14:47:09,364 - INFO - Avg. fwd time: 13.6824 / Avg. bwd time: 38.3678 / Avg. batch time: 640.1086 (ms) / GPU bubble ratio: 34.95%
[rank1]:2025-11-16 14:47:09,470 - INFO -  step: 200  loss: -4.0000  grad_norm:  8.2792  memory: 64.32GiB(46.00%)  tps: 6,213  tflops: 289.77  mfu: 29.30%
[rank3]:2025-11-16 14:47:09,471 - INFO -  step: 200  loss:  0.4771  grad_norm:  8.2792  memory: 73.38GiB(52.48%)  tps: 6,213  tflops: 289.77  mfu: 29.30%
[rank2]:2025-11-16 14:47:09,467 - INFO -  step: 200  loss: -4.0000  grad_norm:  8.2792  memory: 57.29GiB(40.97%)  tps: 6,213  tflops: 289.77  mfu: 29.30%
[rank0]:2025-11-16 14:47:09,474 - INFO -  step: 200  loss: -4.0000  grad_norm:  8.2792  memory: 66.72GiB(47.72%)  tps: 6,213  tflops: 289.77  mfu: 29.30%
[rank3]:2025-11-16 14:47:09,617 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1116_GPipe_nofreeze_h200/pipeline_schedule/251116_1447_real_step200_rank3.svg
[rank3]:> Batch Time: 637.53 ms, GPU Bubble Ratio: 34.78%, 28.11%, 37.81%, 28.86%
[rank0]:2025-11-16 14:49:18,933 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-16 14:49:21,345 - INFO - Avg. fwd time: 14.2950 / Avg. bwd time: 42.4574 / Avg. batch time: 469.9719 (ms) / GPU bubble ratio: 3.39%
[rank1]:2025-11-16 14:49:21,442 - INFO - Avg. fwd time: 15.1806 / Avg. bwd time: 41.8218 / Avg. batch time: 584.3493 (ms) / GPU bubble ratio: 21.96%
[rank2]:2025-11-16 14:49:21,394 - INFO - Avg. fwd time: 13.0226 / Avg. bwd time: 36.3971 / Avg. batch time: 522.9027 (ms) / GPU bubble ratio: 24.39%
[rank0]:2025-11-16 14:49:21,475 - INFO - Avg. fwd time: 13.6433 / Avg. bwd time: 38.3548 / Avg. batch time: 639.6635 (ms) / GPU bubble ratio: 34.97%
[rank1]:2025-11-16 14:49:21,579 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.5794  memory: 64.32GiB(46.00%)  tps: 6,201  tflops: 289.21  mfu: 29.24%
[rank3]:2025-11-16 14:49:21,582 - INFO -  step: 250  loss:  0.2512  grad_norm:  0.5794  memory: 73.38GiB(52.48%)  tps: 6,201  tflops: 289.21  mfu: 29.24%
[rank0]:2025-11-16 14:49:21,583 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.5794  memory: 66.72GiB(47.72%)  tps: 6,201  tflops: 289.21  mfu: 29.24%
[rank2]:2025-11-16 14:49:21,577 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.5794  memory: 57.29GiB(40.97%)  tps: 6,201  tflops: 289.21  mfu: 29.24%
[rank0]:2025-11-16 14:51:30,893 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-16 14:51:33,397 - INFO - Avg. fwd time: 14.2809 / Avg. bwd time: 42.4447 / Avg. batch time: 469.6304 (ms) / GPU bubble ratio: 3.37%
[rank2]:2025-11-16 14:51:33,439 - INFO - Avg. fwd time: 13.0181 / Avg. bwd time: 36.4056 / Avg. batch time: 522.4837 (ms) / GPU bubble ratio: 24.33%
[rank1]:2025-11-16 14:51:33,487 - INFO - Avg. fwd time: 15.1880 / Avg. bwd time: 41.8448 / Avg. batch time: 583.9965 (ms) / GPU bubble ratio: 21.87%
[rank1]:2025-11-16 14:51:33,561 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.4378  memory: 64.32GiB(46.00%)  tps: 6,207  tflops: 289.49  mfu: 29.27%
[rank0]:2025-11-16 14:51:33,530 - INFO - Avg. fwd time: 13.6204 / Avg. bwd time: 38.3529 / Avg. batch time: 639.2688 (ms) / GPU bubble ratio: 34.96%
[rank0]:2025-11-16 14:51:33,565 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.4378  memory: 66.72GiB(47.72%)  tps: 6,207  tflops: 289.49  mfu: 29.27%
[rank3]:2025-11-16 14:51:33,563 - INFO -  step: 300  loss:  0.2738  grad_norm:  0.4378  memory: 73.38GiB(52.48%)  tps: 6,207  tflops: 289.49  mfu: 29.27%
[rank2]:2025-11-16 14:51:33,559 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.4378  memory: 57.29GiB(40.97%)  tps: 6,207  tflops: 289.49  mfu: 29.27%
[rank3]:2025-11-16 14:51:33,708 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1116_GPipe_nofreeze_h200/pipeline_schedule/251116_1451_real_step300_rank3.svg
[rank3]:> Batch Time: 637.09 ms, GPU Bubble Ratio: 34.63%, 27.99%, 37.75%, 28.74%
[rank0]:2025-11-16 14:53:43,175 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-16 14:53:45,649 - INFO - Avg. fwd time: 13.0185 / Avg. bwd time: 36.4103 / Avg. batch time: 522.3601 (ms) / GPU bubble ratio: 24.30%
[rank3]:2025-11-16 14:53:45,600 - INFO - Avg. fwd time: 14.2755 / Avg. bwd time: 42.4424 / Avg. batch time: 469.4912 (ms) / GPU bubble ratio: 3.35%
[rank1]:2025-11-16 14:53:45,697 - INFO - Avg. fwd time: 15.1965 / Avg. bwd time: 41.8603 / Avg. batch time: 583.9220 (ms) / GPU bubble ratio: 21.83%
[rank0]:2025-11-16 14:53:45,731 - INFO - Avg. fwd time: 13.6123 / Avg. bwd time: 38.3565 / Avg. batch time: 639.1706 (ms) / GPU bubble ratio: 34.95%
[rank1]:2025-11-16 14:53:45,835 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.4688  memory: 64.32GiB(46.00%)  tps: 6,193  tflops: 288.85  mfu: 29.21%
[rank2]:2025-11-16 14:53:45,833 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.4688  memory: 57.29GiB(40.97%)  tps: 6,193  tflops: 288.85  mfu: 29.21%
[rank0]:2025-11-16 14:53:45,839 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.4688  memory: 66.72GiB(47.72%)  tps: 6,193  tflops: 288.85  mfu: 29.21%
[rank3]:2025-11-16 14:53:45,837 - INFO -  step: 350  loss:  0.3239  grad_norm:  0.4688  memory: 73.38GiB(52.48%)  tps: 6,193  tflops: 288.86  mfu: 29.21%
[rank0]:2025-11-16 14:55:55,272 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-16 14:55:57,759 - INFO - Avg. fwd time: 13.0194 / Avg. bwd time: 36.4143 / Avg. batch time: 522.1791 (ms) / GPU bubble ratio: 24.27%
[rank3]:2025-11-16 14:55:57,709 - INFO - Avg. fwd time: 14.2713 / Avg. bwd time: 42.4389 / Avg. batch time: 469.3616 (ms) / GPU bubble ratio: 3.34%
[rank1]:2025-11-16 14:55:57,806 - INFO - Avg. fwd time: 15.2038 / Avg. bwd time: 41.8735 / Avg. batch time: 583.7642 (ms) / GPU bubble ratio: 21.78%
[rank0]:2025-11-16 14:55:57,839 - INFO - Avg. fwd time: 13.6011 / Avg. bwd time: 38.3570 / Avg. batch time: 638.9963 (ms) / GPU bubble ratio: 34.95%
[rank1]:2025-11-16 14:55:57,943 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.3530  memory: 64.32GiB(46.00%)  tps: 6,201  tflops: 289.22  mfu: 29.24%
[rank2]:2025-11-16 14:55:57,940 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.3530  memory: 57.29GiB(40.97%)  tps: 6,201  tflops: 289.22  mfu: 29.24%
[rank0]:2025-11-16 14:55:57,947 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.3530  memory: 66.72GiB(47.72%)  tps: 6,201  tflops: 289.22  mfu: 29.24%
[rank3]:2025-11-16 14:55:57,945 - INFO -  step: 400  loss:  0.2599  grad_norm:  0.3530  memory: 73.38GiB(52.48%)  tps: 6,201  tflops: 289.22  mfu: 29.24%
[rank3]:2025-11-16 14:55:58,090 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1116_GPipe_nofreeze_h200/pipeline_schedule/251116_1455_real_step400_rank3.svg
[rank3]:> Batch Time: 638.22 ms, GPU Bubble Ratio: 34.79%, 28.20%, 37.84%, 28.83%
[rank0]:2025-11-16 14:58:07,433 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-16 14:58:09,940 - INFO - Avg. fwd time: 14.2677 / Avg. bwd time: 42.4334 / Avg. batch time: 469.2366 (ms) / GPU bubble ratio: 3.33%
[rank2]:2025-11-16 14:58:09,983 - INFO - Avg. fwd time: 13.0174 / Avg. bwd time: 36.4169 / Avg. batch time: 522.0676 (ms) / GPU bubble ratio: 24.25%
[rank1]:2025-11-16 14:58:10,032 - INFO - Avg. fwd time: 15.2091 / Avg. bwd time: 41.8861 / Avg. batch time: 583.6870 (ms) / GPU bubble ratio: 21.75%
[rank1]:2025-11-16 14:58:10,107 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.3400  memory: 64.32GiB(46.00%)  tps: 6,198  tflops: 289.09  mfu: 29.23%
[rank0]:2025-11-16 14:58:10,076 - INFO - Avg. fwd time: 13.5928 / Avg. bwd time: 38.3562 / Avg. batch time: 638.9012 (ms) / GPU bubble ratio: 34.95%
[rank0]:2025-11-16 14:58:10,111 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.3400  memory: 66.72GiB(47.72%)  tps: 6,198  tflops: 289.09  mfu: 29.23%
[rank3]:2025-11-16 14:58:10,110 - INFO -  step: 450  loss:  0.2776  grad_norm:  0.3400  memory: 73.38GiB(52.48%)  tps: 6,198  tflops: 289.09  mfu: 29.23%
[rank2]:2025-11-16 14:58:10,105 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.3400  memory: 57.29GiB(40.97%)  tps: 6,198  tflops: 289.09  mfu: 29.23%
[rank0]:2025-11-16 15:00:19,635 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-16 15:00:22,066 - INFO - Avg. fwd time: 14.2667 / Avg. bwd time: 42.4356 / Avg. batch time: 469.2108 (ms) / GPU bubble ratio: 3.32%
[rank2]:2025-11-16 15:00:22,115 - INFO - Avg. fwd time: 13.0167 / Avg. bwd time: 36.4184 / Avg. batch time: 522.0080 (ms) / GPU bubble ratio: 24.24%
[rank1]:2025-11-16 15:00:22,162 - INFO - Avg. fwd time: 15.2118 / Avg. bwd time: 41.8930 / Avg. batch time: 583.6322 (ms) / GPU bubble ratio: 21.72%
[rank0]:2025-11-16 15:00:22,195 - INFO - Avg. fwd time: 13.5888 / Avg. bwd time: 38.3616 / Avg. batch time: 638.8417 (ms) / GPU bubble ratio: 34.94%
[rank1]:2025-11-16 15:00:22,300 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.3806  memory: 64.32GiB(46.00%)  tps: 6,197  tflops: 289.03  mfu: 29.22%
[rank0]:2025-11-16 15:00:22,304 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.3806  memory: 66.72GiB(47.72%)  tps: 6,197  tflops: 289.03  mfu: 29.22%
[rank3]:2025-11-16 15:00:22,302 - INFO -  step: 500  loss:  0.2717  grad_norm:  0.3806  memory: 73.38GiB(52.48%)  tps: 6,197  tflops: 289.03  mfu: 29.22%
[rank2]:2025-11-16 15:00:22,297 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.3806  memory: 57.29GiB(40.97%)  tps: 6,197  tflops: 289.03  mfu: 29.22%
[rank3]:2025-11-16 15:00:22,446 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1116_GPipe_nofreeze_h200/pipeline_schedule/251116_1500_real_step500_rank3.svg
[rank3]:> Batch Time: 638.91 ms, GPU Bubble Ratio: 34.60%, 28.28%, 38.01%, 28.81%
[rank0]:2025-11-16 15:02:31,912 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-16 15:02:34,329 - INFO - Avg. fwd time: 14.2671 / Avg. bwd time: 42.4595 / Avg. batch time: 469.3720 (ms) / GPU bubble ratio: 3.31%
[rank2]:2025-11-16 15:02:34,379 - INFO - Avg. fwd time: 13.0154 / Avg. bwd time: 36.4176 / Avg. batch time: 522.1748 (ms) / GPU bubble ratio: 24.27%
[rank1]:2025-11-16 15:02:34,425 - INFO - Avg. fwd time: 15.2120 / Avg. bwd time: 41.8884 / Avg. batch time: 583.7047 (ms) / GPU bubble ratio: 21.74%
[rank0]:2025-11-16 15:02:34,458 - INFO - Avg. fwd time: 13.5977 / Avg. bwd time: 38.3893 / Avg. batch time: 638.9510 (ms) / GPU bubble ratio: 34.91%
[rank1]:2025-11-16 15:02:34,562 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.3270  memory: 64.32GiB(46.00%)  tps: 6,194  tflops: 288.88  mfu: 29.21%
[rank3]:2025-11-16 15:02:34,564 - INFO -  step: 550  loss:  0.1620  grad_norm:  0.3270  memory: 73.38GiB(52.48%)  tps: 6,194  tflops: 288.88  mfu: 29.21%
[rank2]:2025-11-16 15:02:34,560 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.3270  memory: 57.29GiB(40.97%)  tps: 6,194  tflops: 288.88  mfu: 29.21%
[rank0]:2025-11-16 15:02:34,566 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.3270  memory: 66.72GiB(47.72%)  tps: 6,194  tflops: 288.88  mfu: 29.21%
[rank0]:2025-11-16 15:04:45,224 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-16 15:04:47,844 - INFO - Avg. fwd time: 13.0275 / Avg. bwd time: 36.4227 / Avg. batch time: 522.5617 (ms) / GPU bubble ratio: 24.30%
[rank3]:2025-11-16 15:04:47,800 - INFO - Avg. fwd time: 14.2841 / Avg. bwd time: 42.4958 / Avg. batch time: 469.7745 (ms) / GPU bubble ratio: 3.31%
[rank1]:2025-11-16 15:04:47,893 - INFO - Avg. fwd time: 15.2227 / Avg. bwd time: 41.8871 / Avg. batch time: 584.0174 (ms) / GPU bubble ratio: 21.77%
[rank0]:2025-11-16 15:04:47,938 - INFO - Avg. fwd time: 13.6163 / Avg. bwd time: 38.4182 / Avg. batch time: 639.3082 (ms) / GPU bubble ratio: 34.89%
[rank1]:2025-11-16 15:04:47,969 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.7518  memory: 64.32GiB(46.00%)  tps: 6,141  tflops: 286.40  mfu: 28.96%
[rank2]:2025-11-16 15:04:47,966 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.7518  memory: 57.29GiB(40.97%)  tps: 6,141  tflops: 286.40  mfu: 28.96%
[rank3]:2025-11-16 15:04:47,971 - INFO -  step: 600  loss:  0.4055  grad_norm:  0.7518  memory: 73.38GiB(52.48%)  tps: 6,141  tflops: 286.40  mfu: 28.96%
[rank0]:2025-11-16 15:04:47,973 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.7518  memory: 66.72GiB(47.72%)  tps: 6,141  tflops: 286.40  mfu: 28.96%
[rank3]:2025-11-16 15:04:48,114 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1116_GPipe_nofreeze_h200/pipeline_schedule/251116_1504_real_step600_rank3.svg
[rank3]:> Batch Time: 646.16 ms, GPU Bubble Ratio: 34.36%, 28.67%, 38.05%, 28.40%
[rank0]:2025-11-16 15:06:59,833 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-16 15:07:02,339 - INFO - Avg. fwd time: 13.0474 / Avg. bwd time: 36.4328 / Avg. batch time: 523.1357 (ms) / GPU bubble ratio: 24.33%
[rank3]:2025-11-16 15:07:02,290 - INFO - Avg. fwd time: 14.3131 / Avg. bwd time: 42.5354 / Avg. batch time: 470.3098 (ms) / GPU bubble ratio: 3.30%
[rank1]:2025-11-16 15:07:02,385 - INFO - Avg. fwd time: 15.2412 / Avg. bwd time: 41.8899 / Avg. batch time: 584.5410 (ms) / GPU bubble ratio: 21.81%
[rank0]:2025-11-16 15:07:02,419 - INFO - Avg. fwd time: 13.6413 / Avg. bwd time: 38.4414 / Avg. batch time: 639.8714 (ms) / GPU bubble ratio: 34.88%
[rank1]:2025-11-16 15:07:02,523 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.5117  memory: 64.32GiB(46.00%)  tps: 6,088  tflops: 283.96  mfu: 28.71%
[rank2]:2025-11-16 15:07:02,520 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.5117  memory: 57.29GiB(40.97%)  tps: 6,088  tflops: 283.96  mfu: 28.71%
[rank3]:2025-11-16 15:07:02,525 - INFO -  step: 650  loss:  0.2671  grad_norm:  0.5117  memory: 73.38GiB(52.48%)  tps: 6,088  tflops: 283.96  mfu: 28.71%
[rank0]:2025-11-16 15:07:02,527 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.5117  memory: 66.72GiB(47.72%)  tps: 6,088  tflops: 283.96  mfu: 28.71%
[rank0]:2025-11-16 15:09:14,398 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-16 15:09:16,935 - INFO - Avg. fwd time: 13.0662 / Avg. bwd time: 36.4420 / Avg. batch time: 523.6337 (ms) / GPU bubble ratio: 24.36%
[rank3]:2025-11-16 15:09:16,884 - INFO - Avg. fwd time: 14.3383 / Avg. bwd time: 42.5744 / Avg. batch time: 470.8087 (ms) / GPU bubble ratio: 3.29%
[rank1]:2025-11-16 15:09:16,982 - INFO - Avg. fwd time: 15.2608 / Avg. bwd time: 41.8942 / Avg. batch time: 584.9940 (ms) / GPU bubble ratio: 21.84%
[rank0]:2025-11-16 15:09:17,015 - INFO - Avg. fwd time: 13.6658 / Avg. bwd time: 38.4658 / Avg. batch time: 640.3643 (ms) / GPU bubble ratio: 34.87%
[rank1]:2025-11-16 15:09:17,119 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.6042  memory: 64.32GiB(46.00%)  tps: 6,086  tflops: 283.87  mfu: 28.70%
[rank2]:2025-11-16 15:09:17,116 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.6042  memory: 57.29GiB(40.97%)  tps: 6,086  tflops: 283.87  mfu: 28.70%
[rank0]:2025-11-16 15:09:17,123 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.6042  memory: 66.72GiB(47.72%)  tps: 6,086  tflops: 283.87  mfu: 28.70%
[rank3]:2025-11-16 15:09:17,120 - INFO -  step: 700  loss:  0.3479  grad_norm:  0.6042  memory: 73.38GiB(52.48%)  tps: 6,086  tflops: 283.87  mfu: 28.70%
[rank3]:2025-11-16 15:09:17,266 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1116_GPipe_nofreeze_h200/pipeline_schedule/251116_1509_real_step700_rank3.svg
[rank3]:> Batch Time: 648.16 ms, GPU Bubble Ratio: 34.57%, 28.70%, 38.18%, 28.37%
[rank0]:2025-11-16 15:11:28,263 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-16 15:11:30,786 - INFO - Avg. fwd time: 14.3516 / Avg. bwd time: 42.5912 / Avg. batch time: 471.0342 (ms) / GPU bubble ratio: 3.29%
[rank1]:2025-11-16 15:11:30,879 - INFO - Avg. fwd time: 15.2777 / Avg. bwd time: 41.9099 / Avg. batch time: 585.2769 (ms) / GPU bubble ratio: 21.83%
[rank2]:2025-11-16 15:11:30,830 - INFO - Avg. fwd time: 13.0793 / Avg. bwd time: 36.4520 / Avg. batch time: 523.8892 (ms) / GPU bubble ratio: 24.36%
[rank1]:2025-11-16 15:11:30,955 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.4261  memory: 64.32GiB(46.00%)  tps: 6,121  tflops: 285.48  mfu: 28.87%
[rank3]:2025-11-16 15:11:30,957 - INFO -  step: 750  loss:  0.1439  grad_norm:  0.4261  memory: 73.38GiB(52.48%)  tps: 6,121  tflops: 285.48  mfu: 28.87%
[rank2]:2025-11-16 15:11:30,953 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.4261  memory: 57.29GiB(40.97%)  tps: 6,121  tflops: 285.48  mfu: 28.87%
[rank0]:2025-11-16 15:11:30,924 - INFO - Avg. fwd time: 13.6769 / Avg. bwd time: 38.4729 / Avg. batch time: 640.6608 (ms) / GPU bubble ratio: 34.88%
[rank0]:2025-11-16 15:11:30,959 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.4261  memory: 66.72GiB(47.72%)  tps: 6,121  tflops: 285.48  mfu: 28.87%
[rank0]:2025-11-16 15:13:40,645 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-16 15:13:43,169 - INFO - Avg. fwd time: 13.0797 / Avg. bwd time: 36.4546 / Avg. batch time: 523.7915 (ms) / GPU bubble ratio: 24.35%
[rank3]:2025-11-16 15:13:43,119 - INFO - Avg. fwd time: 14.3492 / Avg. bwd time: 42.5848 / Avg. batch time: 470.9509 (ms) / GPU bubble ratio: 3.29%
[rank1]:2025-11-16 15:13:43,216 - INFO - Avg. fwd time: 15.2786 / Avg. bwd time: 41.9172 / Avg. batch time: 585.2195 (ms) / GPU bubble ratio: 21.81%
[rank0]:2025-11-16 15:13:43,249 - INFO - Avg. fwd time: 13.6711 / Avg. bwd time: 38.4688 / Avg. batch time: 640.5930 (ms) / GPU bubble ratio: 34.89%
[rank1]:2025-11-16 15:13:43,352 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.5842  memory: 64.32GiB(46.00%)  tps: 6,187  tflops: 288.58  mfu: 29.18%
[rank0]:2025-11-16 15:13:43,356 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.5842  memory: 66.72GiB(47.72%)  tps: 6,187  tflops: 288.58  mfu: 29.18%
[rank3]:2025-11-16 15:13:43,354 - INFO -  step: 800  loss:  0.2632  grad_norm:  0.5842  memory: 73.38GiB(52.48%)  tps: 6,188  tflops: 288.59  mfu: 29.18%
[rank2]:2025-11-16 15:13:43,349 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.5842  memory: 57.29GiB(40.97%)  tps: 6,187  tflops: 288.58  mfu: 29.18%
[rank3]:2025-11-16 15:13:43,497 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1116_GPipe_nofreeze_h200/pipeline_schedule/251116_1513_real_step800_rank3.svg
[rank3]:> Batch Time: 639.62 ms, GPU Bubble Ratio: 34.90%, 28.25%, 37.94%, 29.10%
[rank0]:2025-11-16 15:15:53,624 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-16 15:15:56,067 - INFO - Avg. fwd time: 14.3543 / Avg. bwd time: 42.5858 / Avg. batch time: 470.9867 (ms) / GPU bubble ratio: 3.28%
[rank1]:2025-11-16 15:15:56,163 - INFO - Avg. fwd time: 15.2886 / Avg. bwd time: 41.9277 / Avg. batch time: 585.3051 (ms) / GPU bubble ratio: 21.80%
[rank2]:2025-11-16 15:15:56,116 - INFO - Avg. fwd time: 13.0864 / Avg. bwd time: 36.4586 / Avg. batch time: 523.8448 (ms) / GPU bubble ratio: 24.34%
[rank0]:2025-11-16 15:15:56,197 - INFO - Avg. fwd time: 13.6726 / Avg. bwd time: 38.4672 / Avg. batch time: 640.6756 (ms) / GPU bubble ratio: 34.89%
[rank1]:2025-11-16 15:15:56,300 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.3687  memory: 64.32GiB(46.00%)  tps: 6,162  tflops: 287.39  mfu: 29.06%
[rank3]:2025-11-16 15:15:56,302 - INFO -  step: 850  loss:  0.1229  grad_norm:  0.3687  memory: 73.38GiB(52.48%)  tps: 6,162  tflops: 287.39  mfu: 29.06%
[rank2]:2025-11-16 15:15:56,297 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.3687  memory: 57.29GiB(40.97%)  tps: 6,162  tflops: 287.39  mfu: 29.06%
[rank0]:2025-11-16 15:15:56,304 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.3687  memory: 66.72GiB(47.72%)  tps: 6,162  tflops: 287.39  mfu: 29.06%
[rank0]:2025-11-16 15:18:05,349 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-16 15:18:07,924 - INFO - Avg. fwd time: 13.0812 / Avg. bwd time: 36.4547 / Avg. batch time: 523.7543 (ms) / GPU bubble ratio: 24.34%
[rank3]:2025-11-16 15:18:07,879 - INFO - Avg. fwd time: 14.3466 / Avg. bwd time: 42.5872 / Avg. batch time: 470.9231 (ms) / GPU bubble ratio: 3.28%
[rank1]:2025-11-16 15:18:07,974 - INFO - Avg. fwd time: 15.2861 / Avg. bwd time: 41.9255 / Avg. batch time: 585.1948 (ms) / GPU bubble ratio: 21.79%
[rank0]:2025-11-16 15:18:08,021 - INFO - Avg. fwd time: 13.6709 / Avg. bwd time: 38.4757 / Avg. batch time: 640.5797 (ms) / GPU bubble ratio: 34.88%
[rank1]:2025-11-16 15:18:08,053 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.4145  memory: 64.32GiB(46.00%)  tps: 6,218  tflops: 290.00  mfu: 29.32%
[rank0]:2025-11-16 15:18:08,057 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.4145  memory: 66.72GiB(47.72%)  tps: 6,218  tflops: 290.00  mfu: 29.32%
[rank2]:2025-11-16 15:18:08,050 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.4145  memory: 57.29GiB(40.97%)  tps: 6,218  tflops: 289.99  mfu: 29.32%
[rank3]:2025-11-16 15:18:08,055 - INFO -  step: 900  loss:  0.1839  grad_norm:  0.4145  memory: 73.38GiB(52.48%)  tps: 6,218  tflops: 290.00  mfu: 29.32%
[rank3]:2025-11-16 15:18:08,202 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1116_GPipe_nofreeze_h200/pipeline_schedule/251116_1518_real_step900_rank3.svg
[rank3]:> Batch Time: 638.56 ms, GPU Bubble Ratio: 34.16%, 28.26%, 37.88%, 28.48%
[rank0]:2025-11-16 15:20:18,103 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-16 15:20:20,600 - INFO - Avg. fwd time: 13.0822 / Avg. bwd time: 36.4538 / Avg. batch time: 523.8247 (ms) / GPU bubble ratio: 24.35%
[rank3]:2025-11-16 15:20:20,550 - INFO - Avg. fwd time: 14.3482 / Avg. bwd time: 42.5943 / Avg. batch time: 470.9831 (ms) / GPU bubble ratio: 3.28%
[rank1]:2025-11-16 15:20:20,648 - INFO - Avg. fwd time: 15.2850 / Avg. bwd time: 41.9194 / Avg. batch time: 585.2242 (ms) / GPU bubble ratio: 21.80%
[rank0]:2025-11-16 15:20:20,681 - INFO - Avg. fwd time: 13.6753 / Avg. bwd time: 38.4849 / Avg. batch time: 640.6225 (ms) / GPU bubble ratio: 34.86%
[rank1]:2025-11-16 15:20:20,783 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.7517  memory: 64.32GiB(46.00%)  tps: 6,172  tflops: 287.86  mfu: 29.11%
[rank2]:2025-11-16 15:20:20,781 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.7517  memory: 57.29GiB(40.97%)  tps: 6,172  tflops: 287.86  mfu: 29.11%
[rank3]:2025-11-16 15:20:20,785 - INFO -  step: 950  loss:  0.2460  grad_norm:  0.7517  memory: 73.38GiB(52.48%)  tps: 6,172  tflops: 287.86  mfu: 29.11%
[rank0]:2025-11-16 15:20:20,788 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.7517  memory: 66.72GiB(47.72%)  tps: 6,172  tflops: 287.86  mfu: 29.11%
[rank0]:2025-11-16 15:22:31,220 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-16 15:22:33,652 - INFO - Avg. fwd time: 14.3545 / Avg. bwd time: 42.6063 / Avg. batch time: 471.1217 (ms) / GPU bubble ratio: 3.28%
[rank1]:2025-11-16 15:22:33,748 - INFO - Avg. fwd time: 15.2887 / Avg. bwd time: 41.9163 / Avg. batch time: 585.3211 (ms) / GPU bubble ratio: 21.81%
[rank2]:2025-11-16 15:22:33,701 - INFO - Avg. fwd time: 13.0872 / Avg. bwd time: 36.4565 / Avg. batch time: 523.9551 (ms) / GPU bubble ratio: 24.35%
[rank0]:2025-11-16 15:22:33,781 - INFO - Avg. fwd time: 13.6828 / Avg. bwd time: 38.4953 / Avg. batch time: 640.7382 (ms) / GPU bubble ratio: 34.85%
[rank1]:2025-11-16 15:22:33,885 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.3066  memory: 64.32GiB(46.00%)  tps: 6,155  tflops: 287.06  mfu: 29.03%
[rank1]:2025-11-16 15:22:33,885 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-16 15:22:33,882 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.3066  memory: 57.29GiB(40.97%)  tps: 6,155  tflops: 287.06  mfu: 29.03%
[rank2]:2025-11-16 15:22:33,882 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-11-16 15:22:33,887 - INFO -  step: 1000  loss:  0.1513  grad_norm:  0.3066  memory: 73.38GiB(52.48%)  tps: 6,155  tflops: 287.06  mfu: 29.03%
[rank3]:2025-11-16 15:22:33,887 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-16 15:22:33,889 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.3066  memory: 66.72GiB(47.72%)  tps: 6,155  tflops: 287.06  mfu: 29.03%
[rank0]:2025-11-16 15:22:33,889 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-16 15:22:33,889 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank2]:2025-11-16 15:22:44,404 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 10.52 seconds.
[rank1]:2025-11-16 15:22:45,890 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 12.01 seconds.
[rank3]:2025-11-16 15:22:46,673 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 12.79 seconds.
[rank0]:2025-11-16 15:22:47,928 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-11-16 15:22:47,934 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 14.05 seconds.
[rank3]:2025-11-16 15:22:48,174 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1116_GPipe_nofreeze_h200/pipeline_schedule/251116_1522_real_step1000_rank3.svg
[rank3]:> Batch Time: 642.66 ms, GPU Bubble Ratio: 34.45%, 28.58%, 38.10%, 28.61%
[rank0]:2025-11-16 15:25:00,186 - INFO - [GC] Peforming periodical GC collection 1.82 seconds
[rank3]:2025-11-16 15:25:02,759 - INFO - Avg. fwd time: 14.3529 / Avg. bwd time: 42.6080 / Avg. batch time: 471.2746 (ms) / GPU bubble ratio: 3.31%
[rank1]:2025-11-16 15:25:02,856 - INFO - Avg. fwd time: 15.2827 / Avg. bwd time: 41.9063 / Avg. batch time: 585.4608 (ms) / GPU bubble ratio: 21.85%
[rank2]:2025-11-16 15:25:02,805 - INFO - Avg. fwd time: 13.0871 / Avg. bwd time: 36.4563 / Avg. batch time: 524.1395 (ms) / GPU bubble ratio: 24.38%
[rank1]:2025-11-16 15:25:02,936 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.8216  memory: 64.32GiB(46.00%)  tps: 5,496  tflops: 256.34  mfu: 25.92%
[rank3]:2025-11-16 15:25:02,938 - INFO -  step: 1050  loss:  0.2504  grad_norm:  0.8216  memory: 73.38GiB(52.48%)  tps: 5,496  tflops: 256.34  mfu: 25.92%
[rank2]:2025-11-16 15:25:02,933 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.8216  memory: 57.29GiB(40.97%)  tps: 5,496  tflops: 256.34  mfu: 25.92%
[rank0]:2025-11-16 15:25:02,904 - INFO - Avg. fwd time: 13.6854 / Avg. bwd time: 38.4996 / Avg. batch time: 640.8879 (ms) / GPU bubble ratio: 34.86%
[rank0]:2025-11-16 15:25:02,940 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.8216  memory: 66.72GiB(47.72%)  tps: 5,496  tflops: 256.34  mfu: 25.92%
[rank0]:2025-11-16 15:27:15,300 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-16 15:27:17,751 - INFO - Avg. fwd time: 14.3708 / Avg. bwd time: 42.6318 / Avg. batch time: 471.5992 (ms) / GPU bubble ratio: 3.30%
[rank2]:2025-11-16 15:27:17,800 - INFO - Avg. fwd time: 13.1006 / Avg. bwd time: 36.4632 / Avg. batch time: 524.4709 (ms) / GPU bubble ratio: 24.40%
[rank1]:2025-11-16 15:27:17,847 - INFO - Avg. fwd time: 15.2958 / Avg. bwd time: 41.9100 / Avg. batch time: 585.7724 (ms) / GPU bubble ratio: 21.87%
[rank0]:2025-11-16 15:27:17,880 - INFO - Avg. fwd time: 13.7020 / Avg. bwd time: 38.5099 / Avg. batch time: 641.2233 (ms) / GPU bubble ratio: 34.86%
[rank3]:2025-11-16 15:27:17,983 - INFO -  step: 1100  loss:  0.2214  grad_norm:  0.3782  memory: 73.38GiB(52.48%)  tps: 6,066  tflops: 282.93  mfu: 28.61%
[rank2]:2025-11-16 15:27:17,978 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.3782  memory: 57.29GiB(40.97%)  tps: 6,066  tflops: 282.93  mfu: 28.61%
[rank1]:2025-11-16 15:27:17,981 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.3782  memory: 64.32GiB(46.00%)  tps: 6,066  tflops: 282.93  mfu: 28.61%
[rank0]:2025-11-16 15:27:17,985 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.3782  memory: 66.72GiB(47.72%)  tps: 6,066  tflops: 282.93  mfu: 28.61%
[rank3]:2025-11-16 15:27:18,128 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1116_GPipe_nofreeze_h200/pipeline_schedule/251116_1527_real_step1100_rank3.svg
[rank3]:> Batch Time: 649.66 ms, GPU Bubble Ratio: 34.59%, 28.77%, 38.13%, 28.32%
[rank0]:2025-11-16 15:29:28,592 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-16 15:29:31,086 - INFO - Avg. fwd time: 13.1035 / Avg. bwd time: 36.4651 / Avg. batch time: 524.5899 (ms) / GPU bubble ratio: 24.41%
[rank3]:2025-11-16 15:29:31,036 - INFO - Avg. fwd time: 14.3759 / Avg. bwd time: 42.6421 / Avg. batch time: 471.7091 (ms) / GPU bubble ratio: 3.30%
[rank1]:2025-11-16 15:29:31,133 - INFO - Avg. fwd time: 15.2974 / Avg. bwd time: 41.9066 / Avg. batch time: 585.8614 (ms) / GPU bubble ratio: 21.89%
[rank0]:2025-11-16 15:29:31,165 - INFO - Avg. fwd time: 13.7078 / Avg. bwd time: 38.5160 / Avg. batch time: 641.3233 (ms) / GPU bubble ratio: 34.85%
[rank1]:2025-11-16 15:29:31,266 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.5244  memory: 64.32GiB(46.00%)  tps: 6,146  tflops: 286.66  mfu: 28.98%
[rank2]:2025-11-16 15:29:31,264 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.5244  memory: 57.29GiB(40.97%)  tps: 6,146  tflops: 286.66  mfu: 28.98%
[rank3]:2025-11-16 15:29:31,268 - INFO -  step: 1150  loss:  0.2103  grad_norm:  0.5244  memory: 73.38GiB(52.48%)  tps: 6,146  tflops: 286.66  mfu: 28.99%
[rank0]:2025-11-16 15:29:31,271 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.5244  memory: 66.72GiB(47.72%)  tps: 6,146  tflops: 286.66  mfu: 28.98%
[rank0]:2025-11-16 15:31:41,663 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-16 15:31:44,220 - INFO - Avg. fwd time: 14.3795 / Avg. bwd time: 42.6497 / Avg. batch time: 471.7859 (ms) / GPU bubble ratio: 3.30%
[rank1]:2025-11-16 15:31:44,315 - INFO - Avg. fwd time: 15.2977 / Avg. bwd time: 41.9025 / Avg. batch time: 585.8996 (ms) / GPU bubble ratio: 21.90%
[rank2]:2025-11-16 15:31:44,265 - INFO - Avg. fwd time: 13.1062 / Avg. bwd time: 36.4651 / Avg. batch time: 524.6560 (ms) / GPU bubble ratio: 24.41%
[rank1]:2025-11-16 15:31:44,394 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.4459  memory: 64.32GiB(46.00%)  tps: 6,153  tflops: 287.00  mfu: 29.02%
[rank2]:2025-11-16 15:31:44,392 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.4459  memory: 57.29GiB(40.97%)  tps: 6,153  tflops: 287.00  mfu: 29.02%
[rank3]:2025-11-16 15:31:44,396 - INFO -  step: 1200  loss:  0.2636  grad_norm:  0.4459  memory: 73.38GiB(52.48%)  tps: 6,154  tflops: 287.00  mfu: 29.02%
[rank0]:2025-11-16 15:31:44,363 - INFO - Avg. fwd time: 13.7117 / Avg. bwd time: 38.5202 / Avg. batch time: 641.3722 (ms) / GPU bubble ratio: 34.85%
[rank0]:2025-11-16 15:31:44,398 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.4459  memory: 66.72GiB(47.72%)  tps: 6,153  tflops: 287.00  mfu: 29.02%
[rank3]:2025-11-16 15:31:44,541 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1116_GPipe_nofreeze_h200/pipeline_schedule/251116_1531_real_step1200_rank3.svg
[rank3]:> Batch Time: 642.94 ms, GPU Bubble Ratio: 34.54%, 28.73%, 37.95%, 28.49%
[rank0]:2025-11-16 15:33:54,492 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-16 15:33:56,992 - INFO - Avg. fwd time: 13.1066 / Avg. bwd time: 36.4656 / Avg. batch time: 524.6896 (ms) / GPU bubble ratio: 24.42%
[rank3]:2025-11-16 15:33:56,943 - INFO - Avg. fwd time: 14.3801 / Avg. bwd time: 42.6537 / Avg. batch time: 471.8125 (ms) / GPU bubble ratio: 3.29%
[rank1]:2025-11-16 15:33:57,038 - INFO - Avg. fwd time: 15.2971 / Avg. bwd time: 41.8984 / Avg. batch time: 585.9091 (ms) / GPU bubble ratio: 21.91%
[rank0]:2025-11-16 15:33:57,072 - INFO - Avg. fwd time: 13.7131 / Avg. bwd time: 38.5232 / Avg. batch time: 641.3867 (ms) / GPU bubble ratio: 34.85%
[rank1]:2025-11-16 15:33:57,173 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.5354  memory: 64.32GiB(46.00%)  tps: 6,170  tflops: 287.75  mfu: 29.10%
[rank2]:2025-11-16 15:33:57,171 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.5354  memory: 57.29GiB(40.97%)  tps: 6,170  tflops: 287.75  mfu: 29.10%
[rank3]:2025-11-16 15:33:57,176 - INFO -  step: 1250  loss:  0.2510  grad_norm:  0.5354  memory: 73.38GiB(52.48%)  tps: 6,170  tflops: 287.76  mfu: 29.10%
[rank0]:2025-11-16 15:33:57,178 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.5354  memory: 66.72GiB(47.72%)  tps: 6,170  tflops: 287.75  mfu: 29.10%
[rank0]:2025-11-16 15:36:07,337 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-16 15:36:09,827 - INFO - Avg. fwd time: 13.1081 / Avg. bwd time: 36.4651 / Avg. batch time: 524.7268 (ms) / GPU bubble ratio: 24.42%
[rank3]:2025-11-16 15:36:09,779 - INFO - Avg. fwd time: 14.3823 / Avg. bwd time: 42.6590 / Avg. batch time: 471.8622 (ms) / GPU bubble ratio: 3.29%
[rank1]:2025-11-16 15:36:09,875 - INFO - Avg. fwd time: 15.2973 / Avg. bwd time: 41.8939 / Avg. batch time: 585.9197 (ms) / GPU bubble ratio: 21.91%
[rank0]:2025-11-16 15:36:09,908 - INFO - Avg. fwd time: 13.7161 / Avg. bwd time: 38.5260 / Avg. batch time: 641.4016 (ms) / GPU bubble ratio: 34.84%
[rank1]:2025-11-16 15:36:10,009 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.3664  memory: 64.32GiB(46.00%)  tps: 6,167  tflops: 287.63  mfu: 29.08%
[rank2]:2025-11-16 15:36:10,006 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.3664  memory: 57.29GiB(40.97%)  tps: 6,167  tflops: 287.63  mfu: 29.08%
[rank0]:2025-11-16 15:36:10,013 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.3664  memory: 66.72GiB(47.72%)  tps: 6,167  tflops: 287.63  mfu: 29.08%
[rank3]:2025-11-16 15:36:10,011 - INFO -  step: 1300  loss:  0.1788  grad_norm:  0.3664  memory: 73.38GiB(52.48%)  tps: 6,167  tflops: 287.64  mfu: 29.08%
[rank3]:2025-11-16 15:36:10,156 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1116_GPipe_nofreeze_h200/pipeline_schedule/251116_1536_real_step1300_rank3.svg
[rank3]:> Batch Time: 636.91 ms, GPU Bubble Ratio: 34.30%, 28.62%, 37.91%, 28.61%
[rank0]:2025-11-16 15:38:21,456 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-16 15:38:23,990 - INFO - Avg. fwd time: 14.3913 / Avg. bwd time: 42.6727 / Avg. batch time: 472.0350 (ms) / GPU bubble ratio: 3.29%
[rank2]:2025-11-16 15:38:24,037 - INFO - Avg. fwd time: 13.1140 / Avg. bwd time: 36.4687 / Avg. batch time: 524.9160 (ms) / GPU bubble ratio: 24.43%
[rank1]:2025-11-16 15:38:24,088 - INFO - Avg. fwd time: 15.3034 / Avg. bwd time: 41.8955 / Avg. batch time: 586.0942 (ms) / GPU bubble ratio: 21.93%
[rank0]:2025-11-16 15:38:24,135 - INFO - Avg. fwd time: 13.7243 / Avg. bwd time: 38.5322 / Avg. batch time: 641.5872 (ms) / GPU bubble ratio: 34.84%
[rank1]:2025-11-16 15:38:24,166 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.4759  memory: 64.32GiB(46.00%)  tps: 6,106  tflops: 284.80  mfu: 28.80%
[rank3]:2025-11-16 15:38:24,170 - INFO -  step: 1350  loss:  0.1227  grad_norm:  0.4759  memory: 73.38GiB(52.48%)  tps: 6,106  tflops: 284.80  mfu: 28.80%
[rank0]:2025-11-16 15:38:24,170 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.4759  memory: 66.72GiB(47.72%)  tps: 6,106  tflops: 284.80  mfu: 28.80%
[rank2]:2025-11-16 15:38:24,164 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.4759  memory: 57.29GiB(40.97%)  tps: 6,106  tflops: 284.80  mfu: 28.80%
[rank0]:2025-11-16 15:40:34,301 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-16 15:40:36,836 - INFO - Avg. fwd time: 13.1136 / Avg. bwd time: 36.4678 / Avg. batch time: 524.9231 (ms) / GPU bubble ratio: 24.44%
[rank3]:2025-11-16 15:40:36,785 - INFO - Avg. fwd time: 14.3916 / Avg. bwd time: 42.6757 / Avg. batch time: 472.0541 (ms) / GPU bubble ratio: 3.29%
[rank1]:2025-11-16 15:40:36,883 - INFO - Avg. fwd time: 15.3015 / Avg. bwd time: 41.8924 / Avg. batch time: 586.0828 (ms) / GPU bubble ratio: 21.93%
[rank0]:2025-11-16 15:40:36,916 - INFO - Avg. fwd time: 13.7248 / Avg. bwd time: 38.5341 / Avg. batch time: 641.5779 (ms) / GPU bubble ratio: 34.84%
[rank1]:2025-11-16 15:40:37,018 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.4757  memory: 64.32GiB(46.00%)  tps: 6,166  tflops: 287.60  mfu: 29.08%
[rank0]:2025-11-16 15:40:37,022 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.4757  memory: 66.72GiB(47.72%)  tps: 6,166  tflops: 287.60  mfu: 29.08%
[rank2]:2025-11-16 15:40:37,015 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.4757  memory: 57.29GiB(40.97%)  tps: 6,166  tflops: 287.60  mfu: 29.08%
[rank3]:2025-11-16 15:40:37,020 - INFO -  step: 1400  loss:  0.3593  grad_norm:  0.4757  memory: 73.38GiB(52.48%)  tps: 6,166  tflops: 287.60  mfu: 29.08%
[rank3]:2025-11-16 15:40:37,165 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1116_GPipe_nofreeze_h200/pipeline_schedule/251116_1540_real_step1400_rank3.svg
[rank3]:> Batch Time: 642.50 ms, GPU Bubble Ratio: 34.53%, 28.65%, 37.94%, 28.44%
[rank0]:2025-11-16 15:42:49,179 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-16 15:42:51,679 - INFO - Avg. fwd time: 13.1230 / Avg. bwd time: 36.4732 / Avg. batch time: 525.1672 (ms) / GPU bubble ratio: 24.45%
[rank3]:2025-11-16 15:42:51,629 - INFO - Avg. fwd time: 14.4039 / Avg. bwd time: 42.6924 / Avg. batch time: 472.2798 (ms) / GPU bubble ratio: 3.28%
[rank1]:2025-11-16 15:42:51,726 - INFO - Avg. fwd time: 15.3113 / Avg. bwd time: 41.8962 / Avg. batch time: 586.3169 (ms) / GPU bubble ratio: 21.94%
[rank0]:2025-11-16 15:42:51,759 - INFO - Avg. fwd time: 13.7359 / Avg. bwd time: 38.5411 / Avg. batch time: 641.8252 (ms) / GPU bubble ratio: 34.84%
[rank0]:2025-11-16 15:42:51,864 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.4005  memory: 66.72GiB(47.72%)  tps: 6,075  tflops: 283.35  mfu: 28.65%
[rank2]:2025-11-16 15:42:51,857 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.4005  memory: 57.29GiB(40.97%)  tps: 6,075  tflops: 283.35  mfu: 28.65%
[rank3]:2025-11-16 15:42:51,862 - INFO -  step: 1450  loss:  0.1861  grad_norm:  0.4005  memory: 73.38GiB(52.48%)  tps: 6,075  tflops: 283.35  mfu: 28.65%
[rank1]:2025-11-16 15:42:51,860 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.4005  memory: 64.32GiB(46.00%)  tps: 6,075  tflops: 283.35  mfu: 28.65%
[rank0]:2025-11-16 15:45:04,359 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-16 15:45:06,959 - INFO - Avg. fwd time: 14.4179 / Avg. bwd time: 42.7105 / Avg. batch time: 472.5314 (ms) / GPU bubble ratio: 3.28%
[rank2]:2025-11-16 15:45:07,005 - INFO - Avg. fwd time: 13.1328 / Avg. bwd time: 36.4794 / Avg. batch time: 525.4247 (ms) / GPU bubble ratio: 24.46%
[rank1]:2025-11-16 15:45:07,056 - INFO - Avg. fwd time: 15.3215 / Avg. bwd time: 41.8998 / Avg. batch time: 586.5664 (ms) / GPU bubble ratio: 21.96%
[rank0]:2025-11-16 15:45:07,105 - INFO - Avg. fwd time: 13.7467 / Avg. bwd time: 38.5480 / Avg. batch time: 642.0897 (ms) / GPU bubble ratio: 34.84%
[rank1]:2025-11-16 15:45:07,136 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.5590  memory: 64.32GiB(46.00%)  tps: 6,056  tflops: 282.44  mfu: 28.56%
[rank3]:2025-11-16 15:45:07,138 - INFO -  step: 1500  loss:  0.2550  grad_norm:  0.5590  memory: 73.38GiB(52.48%)  tps: 6,056  tflops: 282.45  mfu: 28.56%
[rank2]:2025-11-16 15:45:07,133 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.5590  memory: 57.29GiB(40.97%)  tps: 6,056  tflops: 282.44  mfu: 28.56%
[rank0]:2025-11-16 15:45:07,140 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.5590  memory: 66.72GiB(47.72%)  tps: 6,056  tflops: 282.44  mfu: 28.56%
[rank3]:2025-11-16 15:45:07,282 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1116_GPipe_nofreeze_h200/pipeline_schedule/251116_1545_real_step1500_rank3.svg
[rank3]:> Batch Time: 650.16 ms, GPU Bubble Ratio: 34.74%, 28.88%, 38.16%, 28.35%
[rank0]:2025-11-16 15:47:19,645 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-16 15:47:22,133 - INFO - Avg. fwd time: 14.4300 / Avg. bwd time: 42.7259 / Avg. batch time: 472.7472 (ms) / GPU bubble ratio: 3.28%
[rank2]:2025-11-16 15:47:22,182 - INFO - Avg. fwd time: 13.1408 / Avg. bwd time: 36.4841 / Avg. batch time: 525.6579 (ms) / GPU bubble ratio: 24.48%
[rank1]:2025-11-16 15:47:22,229 - INFO - Avg. fwd time: 15.3310 / Avg. bwd time: 41.9038 / Avg. batch time: 586.7944 (ms) / GPU bubble ratio: 21.97%
[rank0]:2025-11-16 15:47:22,262 - INFO - Avg. fwd time: 13.7572 / Avg. bwd time: 38.5540 / Avg. batch time: 642.3284 (ms) / GPU bubble ratio: 34.85%
[rank1]:2025-11-16 15:47:22,363 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.5107  memory: 64.32GiB(46.00%)  tps: 6,058  tflops: 282.54  mfu: 28.57%
[rank0]:2025-11-16 15:47:22,367 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.5107  memory: 66.72GiB(47.72%)  tps: 6,058  tflops: 282.54  mfu: 28.57%
[rank2]:2025-11-16 15:47:22,360 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.5107  memory: 57.29GiB(40.97%)  tps: 6,058  tflops: 282.54  mfu: 28.57%
[rank3]:2025-11-16 15:47:22,365 - INFO -  step: 1550  loss:  0.2665  grad_norm:  0.5107  memory: 73.38GiB(52.48%)  tps: 6,058  tflops: 282.55  mfu: 28.57%
[rank0]:2025-11-16 15:49:33,925 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-16 15:49:36,425 - INFO - Avg. fwd time: 14.4365 / Avg. bwd time: 42.7356 / Avg. batch time: 472.8701 (ms) / GPU bubble ratio: 3.28%
[rank2]:2025-11-16 15:49:36,475 - INFO - Avg. fwd time: 13.1449 / Avg. bwd time: 36.4862 / Avg. batch time: 525.7767 (ms) / GPU bubble ratio: 24.48%
[rank1]:2025-11-16 15:49:36,523 - INFO - Avg. fwd time: 15.3348 / Avg. bwd time: 41.9042 / Avg. batch time: 586.9023 (ms) / GPU bubble ratio: 21.98%
[rank0]:2025-11-16 15:49:36,554 - INFO - Avg. fwd time: 13.7626 / Avg. bwd time: 38.5583 / Avg. batch time: 642.4431 (ms) / GPU bubble ratio: 34.85%
[rank2]:2025-11-16 15:49:36,653 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.8191  memory: 57.29GiB(40.97%)  tps: 6,100  tflops: 284.51  mfu: 28.77%
[rank1]:2025-11-16 15:49:36,656 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.8191  memory: 64.32GiB(46.00%)  tps: 6,100  tflops: 284.51  mfu: 28.77%
[rank0]:2025-11-16 15:49:36,660 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.8191  memory: 66.72GiB(47.72%)  tps: 6,100  tflops: 284.51  mfu: 28.77%
[rank3]:2025-11-16 15:49:36,657 - INFO -  step: 1600  loss:  0.4005  grad_norm:  0.8191  memory: 73.38GiB(52.48%)  tps: 6,100  tflops: 284.51  mfu: 28.77%
[rank3]:2025-11-16 15:49:36,799 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1116_GPipe_nofreeze_h200/pipeline_schedule/251116_1549_real_step1600_rank3.svg
[rank3]:> Batch Time: 648.09 ms, GPU Bubble Ratio: 34.63%, 28.75%, 38.17%, 28.32%
[rank0]:2025-11-16 15:51:48,791 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-16 15:51:51,430 - INFO - Avg. fwd time: 13.1517 / Avg. bwd time: 36.4902 / Avg. batch time: 525.9326 (ms) / GPU bubble ratio: 24.49%
[rank3]:2025-11-16 15:51:51,382 - INFO - Avg. fwd time: 14.4459 / Avg. bwd time: 42.7444 / Avg. batch time: 473.0113 (ms) / GPU bubble ratio: 3.27%
[rank1]:2025-11-16 15:51:51,483 - INFO - Avg. fwd time: 15.3435 / Avg. bwd time: 41.9114 / Avg. batch time: 587.0728 (ms) / GPU bubble ratio: 21.98%
[rank2]:2025-11-16 15:51:51,560 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.8760  memory: 57.29GiB(40.97%)  tps: 6,072  tflops: 283.21  mfu: 28.64%
[rank0]:2025-11-16 15:51:51,531 - INFO - Avg. fwd time: 13.7693 / Avg. bwd time: 38.5602 / Avg. batch time: 642.6186 (ms) / GPU bubble ratio: 34.85%
[rank0]:2025-11-16 15:51:51,567 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.8760  memory: 66.72GiB(47.72%)  tps: 6,072  tflops: 283.22  mfu: 28.64%
[rank3]:2025-11-16 15:51:51,565 - INFO -  step: 1650  loss:  0.4320  grad_norm:  0.8760  memory: 73.38GiB(52.48%)  tps: 6,072  tflops: 283.22  mfu: 28.64%
[rank1]:2025-11-16 15:51:51,563 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.8760  memory: 64.32GiB(46.00%)  tps: 6,072  tflops: 283.21  mfu: 28.64%
[rank0]:2025-11-16 15:54:03,548 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-16 15:54:06,030 - INFO - Avg. fwd time: 14.4530 / Avg. bwd time: 42.7477 / Avg. batch time: 473.0906 (ms) / GPU bubble ratio: 3.27%
[rank2]:2025-11-16 15:54:06,080 - INFO - Avg. fwd time: 13.1576 / Avg. bwd time: 36.4940 / Avg. batch time: 526.0128 (ms) / GPU bubble ratio: 24.49%
[rank0]:2025-11-16 15:54:06,160 - INFO - Avg. fwd time: 13.7722 / Avg. bwd time: 38.5579 / Avg. batch time: 642.7194 (ms) / GPU bubble ratio: 34.86%
[rank1]:2025-11-16 15:54:06,128 - INFO - Avg. fwd time: 15.3516 / Avg. bwd time: 41.9191 / Avg. batch time: 587.1777 (ms) / GPU bubble ratio: 21.97%
[rank2]:2025-11-16 15:54:06,258 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.6338  memory: 57.29GiB(40.97%)  tps: 6,082  tflops: 283.65  mfu: 28.68%
[rank0]:2025-11-16 15:54:06,265 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.6338  memory: 66.72GiB(47.72%)  tps: 6,082  tflops: 283.65  mfu: 28.68%
[rank3]:2025-11-16 15:54:06,263 - INFO -  step: 1700  loss:  0.4004  grad_norm:  0.6338  memory: 73.38GiB(52.48%)  tps: 6,082  tflops: 283.66  mfu: 28.68%
[rank1]:2025-11-16 15:54:06,261 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.6338  memory: 64.32GiB(46.00%)  tps: 6,082  tflops: 283.65  mfu: 28.68%
[rank3]:2025-11-16 15:54:06,405 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1116_GPipe_nofreeze_h200/pipeline_schedule/251116_1554_real_step1700_rank3.svg
[rank3]:> Batch Time: 645.72 ms, GPU Bubble Ratio: 34.95%, 28.08%, 37.89%, 28.62%
[rank0]:2025-11-16 15:56:18,025 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-16 15:56:20,522 - INFO - Avg. fwd time: 14.4598 / Avg. bwd time: 42.7499 / Avg. batch time: 473.1581 (ms) / GPU bubble ratio: 3.27%
[rank2]:2025-11-16 15:56:20,573 - INFO - Avg. fwd time: 13.1636 / Avg. bwd time: 36.4975 / Avg. batch time: 526.0929 (ms) / GPU bubble ratio: 24.48%
[rank0]:2025-11-16 15:56:20,653 - INFO - Avg. fwd time: 13.7747 / Avg. bwd time: 38.5545 / Avg. batch time: 642.8213 (ms) / GPU bubble ratio: 34.88%
[rank1]:2025-11-16 15:56:20,620 - INFO - Avg. fwd time: 15.3595 / Avg. bwd time: 41.9265 / Avg. batch time: 587.2847 (ms) / GPU bubble ratio: 21.96%
[rank0]:2025-11-16 15:56:20,757 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.6561  memory: 66.72GiB(47.72%)  tps: 6,091  tflops: 284.09  mfu: 28.72%
[rank2]:2025-11-16 15:56:20,751 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.6561  memory: 57.29GiB(40.97%)  tps: 6,091  tflops: 284.09  mfu: 28.72%
[rank3]:2025-11-16 15:56:20,755 - INFO -  step: 1750  loss:  0.4085  grad_norm:  0.6561  memory: 73.38GiB(52.48%)  tps: 6,091  tflops: 284.09  mfu: 28.73%
[rank1]:2025-11-16 15:56:20,753 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.6561  memory: 64.32GiB(46.00%)  tps: 6,091  tflops: 284.09  mfu: 28.72%
[rank0]:2025-11-16 15:58:30,049 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-16 15:58:32,508 - INFO - Avg. fwd time: 14.4544 / Avg. bwd time: 42.7386 / Avg. batch time: 473.0177 (ms) / GPU bubble ratio: 3.27%
[rank2]:2025-11-16 15:58:32,556 - INFO - Avg. fwd time: 13.1603 / Avg. bwd time: 36.4961 / Avg. batch time: 525.9411 (ms) / GPU bubble ratio: 24.47%
[rank1]:2025-11-16 15:58:32,608 - INFO - Avg. fwd time: 15.3555 / Avg. bwd time: 41.9276 / Avg. batch time: 587.1600 (ms) / GPU bubble ratio: 21.95%
[rank3]:2025-11-16 15:58:32,691 - INFO -  step: 1800  loss:  0.0761  grad_norm:  0.3225  memory: 73.38GiB(52.48%)  tps: 6,209  tflops: 289.60  mfu: 29.28%
[rank2]:2025-11-16 15:58:32,686 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.3225  memory: 57.29GiB(40.97%)  tps: 6,209  tflops: 289.59  mfu: 29.28%
[rank0]:2025-11-16 15:58:32,657 - INFO - Avg. fwd time: 13.7669 / Avg. bwd time: 38.5471 / Avg. batch time: 642.6837 (ms) / GPU bubble ratio: 34.88%
[rank0]:2025-11-16 15:58:32,693 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.3225  memory: 66.72GiB(47.72%)  tps: 6,209  tflops: 289.59  mfu: 29.28%
[rank1]:2025-11-16 15:58:32,689 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.3225  memory: 64.32GiB(46.00%)  tps: 6,209  tflops: 289.59  mfu: 29.28%
[rank3]:2025-11-16 15:58:32,834 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1116_GPipe_nofreeze_h200/pipeline_schedule/251116_1558_real_step1800_rank3.svg
[rank3]:> Batch Time: 628.84 ms, GPU Bubble Ratio: 34.65%, 28.04%, 37.69%, 29.21%
[rank0]:2025-11-16 16:00:41,650 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-16 16:00:44,064 - INFO - Avg. fwd time: 14.4484 / Avg. bwd time: 42.7284 / Avg. batch time: 472.8822 (ms) / GPU bubble ratio: 3.27%
[rank0]:2025-11-16 16:00:44,194 - INFO - Avg. fwd time: 13.7598 / Avg. bwd time: 38.5399 / Avg. batch time: 642.5490 (ms) / GPU bubble ratio: 34.88%
[rank2]:2025-11-16 16:00:44,113 - INFO - Avg. fwd time: 13.1568 / Avg. bwd time: 36.4934 / Avg. batch time: 525.8060 (ms) / GPU bubble ratio: 24.46%
[rank1]:2025-11-16 16:00:44,162 - INFO - Avg. fwd time: 15.3517 / Avg. bwd time: 41.9268 / Avg. batch time: 587.0400 (ms) / GPU bubble ratio: 21.94%
[rank0]:2025-11-16 16:00:44,297 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.5298  memory: 66.72GiB(47.72%)  tps: 6,225  tflops: 290.32  mfu: 29.36%
[rank2]:2025-11-16 16:00:44,290 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.5298  memory: 57.29GiB(40.97%)  tps: 6,225  tflops: 290.32  mfu: 29.36%
[rank3]:2025-11-16 16:00:44,295 - INFO -  step: 1850  loss:  0.3556  grad_norm:  0.5298  memory: 73.38GiB(52.48%)  tps: 6,225  tflops: 290.33  mfu: 29.36%
[rank1]:2025-11-16 16:00:44,293 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.5298  memory: 64.32GiB(46.00%)  tps: 6,225  tflops: 290.32  mfu: 29.36%
[rank0]:2025-11-16 16:02:52,492 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-16 16:02:54,892 - INFO - Avg. fwd time: 14.4386 / Avg. bwd time: 42.7145 / Avg. batch time: 472.6847 (ms) / GPU bubble ratio: 3.27%
[rank2]:2025-11-16 16:02:54,939 - INFO - Avg. fwd time: 13.1505 / Avg. bwd time: 36.4896 / Avg. batch time: 525.5905 (ms) / GPU bubble ratio: 24.44%
[rank1]:2025-11-16 16:02:54,987 - INFO - Avg. fwd time: 15.3443 / Avg. bwd time: 41.9237 / Avg. batch time: 586.8353 (ms) / GPU bubble ratio: 21.93%
[rank0]:2025-11-16 16:02:55,018 - INFO - Avg. fwd time: 13.7488 / Avg. bwd time: 38.5302 / Avg. batch time: 642.3244 (ms) / GPU bubble ratio: 34.89%
[rank3]:2025-11-16 16:02:55,124 - INFO -  step: 1900  loss:  0.2033  grad_norm:  0.3156  memory: 73.38GiB(52.48%)  tps: 6,262  tflops: 292.06  mfu: 29.53%
[rank1]:2025-11-16 16:02:55,117 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.3156  memory: 64.32GiB(46.00%)  tps: 6,262  tflops: 292.06  mfu: 29.53%
[rank2]:2025-11-16 16:02:55,114 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.3156  memory: 57.29GiB(40.97%)  tps: 6,262  tflops: 292.06  mfu: 29.53%
[rank0]:2025-11-16 16:02:55,120 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.3156  memory: 66.72GiB(47.72%)  tps: 6,262  tflops: 292.06  mfu: 29.53%
[rank3]:2025-11-16 16:02:55,267 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1116_GPipe_nofreeze_h200/pipeline_schedule/251116_1602_real_step1900_rank3.svg
[rank3]:> Batch Time: 632.41 ms, GPU Bubble Ratio: 34.75%, 28.09%, 37.71%, 28.91%
[rank0]:2025-11-16 16:05:02,915 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-16 16:05:05,404 - INFO - Avg. fwd time: 14.4270 / Avg. bwd time: 42.6986 / Avg. batch time: 472.4573 (ms) / GPU bubble ratio: 3.27%
[rank2]:2025-11-16 16:05:05,455 - INFO - Avg. fwd time: 13.1429 / Avg. bwd time: 36.4842 / Avg. batch time: 525.3576 (ms) / GPU bubble ratio: 24.43%
[rank1]:2025-11-16 16:05:05,508 - INFO - Avg. fwd time: 15.3360 / Avg. bwd time: 41.9198 / Avg. batch time: 586.6127 (ms) / GPU bubble ratio: 21.92%
[rank0]:2025-11-16 16:05:05,557 - INFO - Avg. fwd time: 13.7374 / Avg. bwd time: 38.5203 / Avg. batch time: 642.0828 (ms) / GPU bubble ratio: 34.89%
[rank0]:2025-11-16 16:05:05,592 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.2793  memory: 66.72GiB(47.72%)  tps: 6,279  tflops: 292.84  mfu: 29.61%
[rank2]:2025-11-16 16:05:05,586 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.2793  memory: 57.29GiB(40.97%)  tps: 6,279  tflops: 292.84  mfu: 29.61%
[rank3]:2025-11-16 16:05:05,591 - INFO -  step: 1950  loss:  0.1730  grad_norm:  0.2793  memory: 73.38GiB(52.48%)  tps: 6,279  tflops: 292.86  mfu: 29.61%
[rank1]:2025-11-16 16:05:05,588 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.2793  memory: 64.32GiB(46.00%)  tps: 6,279  tflops: 292.84  mfu: 29.61%
[rank0]:2025-11-16 16:07:13,358 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-16 16:07:15,777 - INFO - Avg. fwd time: 14.4176 / Avg. bwd time: 42.6854 / Avg. batch time: 472.2709 (ms) / GPU bubble ratio: 3.27%
[rank0]:2025-11-16 16:07:15,904 - INFO - Avg. fwd time: 13.7277 / Avg. bwd time: 38.5126 / Avg. batch time: 641.8760 (ms) / GPU bubble ratio: 34.89%
[rank2]:2025-11-16 16:07:15,826 - INFO - Avg. fwd time: 13.1365 / Avg. bwd time: 36.4803 / Avg. batch time: 525.1553 (ms) / GPU bubble ratio: 24.42%
[rank1]:2025-11-16 16:07:15,872 - INFO - Avg. fwd time: 15.3290 / Avg. bwd time: 41.9167 / Avg. batch time: 586.4213 (ms) / GPU bubble ratio: 21.91%
[rank0]:2025-11-16 16:07:16,007 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.2867  memory: 66.72GiB(47.72%)  tps: 6,281  tflops: 292.97  mfu: 29.62%
[rank0]:2025-11-16 16:07:16,007 - INFO -  final step: 2000  loss: -4.0000  grad_norm:  0.2867  tps: 6,278  tflops: 292.80  mfu: 28.38%
[rank0]:2025-11-16 16:07:16,007 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-16 16:07:16,000 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.2867  memory: 57.29GiB(40.97%)  tps: 6,282  tflops: 292.97  mfu: 29.62%
[rank2]:2025-11-16 16:07:16,000 - INFO -  final step: 2000  loss: -4.0000  grad_norm:  0.2867  tps: 6,278  tflops: 292.80  mfu: 28.38%
[rank2]:2025-11-16 16:07:16,000 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-16 16:07:16,006 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2000.
[rank3]:2025-11-16 16:07:16,005 - INFO -  step: 2000  loss:  0.2086  grad_norm:  0.2867  memory: 73.38GiB(52.48%)  tps: 6,282  tflops: 292.97  mfu: 29.62%
[rank3]:2025-11-16 16:07:16,005 - INFO -  final step: 2000  loss:  0.2086  grad_norm:  0.2867  tps: 6,281  tflops: 292.93  mfu: 28.39%
[rank3]:2025-11-16 16:07:16,006 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-11-16 16:07:16,010 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2000.
[rank1]:2025-11-16 16:07:16,003 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.2867  memory: 64.32GiB(46.00%)  tps: 6,282  tflops: 292.97  mfu: 29.62%
[rank1]:2025-11-16 16:07:16,003 - INFO -  final step: 2000  loss: -4.0000  grad_norm:  0.2867  tps: 6,278  tflops: 292.80  mfu: 28.38%
[rank1]:2025-11-16 16:07:16,003 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-11-16 16:07:16,006 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2000.
[rank0]:2025-11-16 16:07:16,012 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2000.
[rank0]:2025-11-16 16:07:26,288 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-11-16 16:07:26,316 - INFO - Sleeping 2 seconds for other ranks to complete
[rank2]:2025-11-16 16:07:26,316 - INFO - Destroying the purge thread.
[rank1]:2025-11-16 16:07:26,316 - INFO - Destroying the purge thread.
[rank3]:2025-11-16 16:07:26,536 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1116_GPipe_nofreeze_h200/pipeline_schedule/251116_1607_real_final2000_rank3.svg
[rank3]:> Batch Time: 641.41 ms, GPU Bubble Ratio: 34.61%, 28.40%, 37.95%, 28.64%
[rank3]:2025-11-16 16:07:26,733 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1116_GPipe_nofreeze_h200/pipeline_schedule/251116_1607_thry_final2000_rank3.svg
[rank3]:> Batch Time: 467.20 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:2025-11-16 16:07:26,733 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading output.log; uploading config.yaml
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm  â–ˆâ–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–‡â–ˆâ–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–‡â–ˆâ–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 2.60868
[rank3]:wandb:               final/avg_loss 0.20858
[rank3]:wandb:             final/avg_mfu(%) 28.39324
[rank3]:wandb:             final/avg_tflops 292.92683
[rank3]:wandb:    final/avg_throughput(tps) 6280.57079
[rank3]:wandb:              final/grad_norm 0.28671
[rank3]:wandb:               final/max_loss 0.20858
[rank3]:wandb:                    grad_norm 0.28671
[rank3]:wandb: loss_metrics/global_avg_loss 0.20858
[rank3]:wandb: loss_metrics/global_max_loss 0.20858
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1116_GPipe_nofreeze_h200 at: https://wandb.ai/orangingq/torchtitan/runs/trmm57au
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: ._data/tb/1116_GPipe_nofreeze_h200/20251116-1438/wandb/run-20251116_143806-trmm57au/logs
[rank0]:2025-11-16 16:07:28,316 - INFO - Training completed
[rank0]:2025-11-16 16:07:28,317 - INFO - Destroying the purge thread.
[rank2]:2025-11-16 16:07:28,718 - INFO - Process group destroyed
[rank3]:2025-11-16 16:07:28,697 - INFO - Process group destroyed
[rank1]:2025-11-16 16:07:28,682 - INFO - Process group destroyed
[rank0]:2025-11-16 16:07:28,786 - INFO - Process group destroyed
[rank1]:Stage 1: Modules to keep: {'layers.8', 'layers.9', 'layers.10', 'layers.12', 'layers.11', 'layers.14', 'layers.16', 'layers.15', 'layers.13'}
[rank2]:Stage 2: Modules to keep: {'layers.19', 'layers.21', 'layers.20', 'layers.22', 'layers.17', 'layers.24', 'layers.18', 'layers.23'}
[rank0]:Stage 0: Modules to keep: {'layers.0', 'layers.1', 'layers.6', 'layers.2', 'layers.5', 'tok_embeddings', 'layers.7', 'layers.4', 'layers.3'}
[rank3]:Stage 3: Modules to keep: {'layers.29', 'layers.26', 'output', 'layers.31', 'norm', 'layers.28', 'layers.27', 'layers.25', 'layers.30'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1104_llama8b/config_1116.toml
[rank3]:		- dump_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data
[rank3]:		- description: "Llama 3.1 8B Experiment
[rank3]:1109: 1) resolved timelyapf issue, 2) seed fixed to 42 for all runs, 3) 3000 steps -> 2000 steps (better benchmark scores!)
[rank3]:1116: everything same, but with seed=11
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1116_GPipe_nofreeze_h200
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/profile_trace/1116_GPipe_nofreeze_h200
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/memory_snapshot/1116_GPipe_nofreeze_h200
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1116_GPipe_nofreeze_h200
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1116_GPipe_nofreeze_h200
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1116_GPipe_nofreeze_h200
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 8B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.1-8B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 3e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.999
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 200
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: openhermes
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 2000
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 11
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: GPipe
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1116_GPipe_nofreeze_h200
[rank3]:		- interval: 1000
[rank3]:		- initial_load_path: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/comm_traces/1116_GPipe_nofreeze_h200
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 8
[rank3]:		- seq_len: 2048
[rank3]:		- freq: 10
[rank3]:		- steps: -1
[rank3]:	- freezing:
[rank3]:		- freeze: False
[rank3]:		- metric_type: apf
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.7
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.01
[rank3]:		- percentile: 80
[rank3]:
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
