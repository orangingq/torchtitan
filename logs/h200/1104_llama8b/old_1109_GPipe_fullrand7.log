
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: Mon Nov 10 17:55:10 UTC 2025
âœ”ï¸SERVER: wbl-kaist-gpu-2 (172.16.131.118),  GPUs: 2,5,6,7
âœ”ï¸SCRIPT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1104_llama8b/run.sh
âœ”ï¸OUTPUT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1104_llama8b/1109_GPipe_fullrand7.log
âœ”ï¸Llama 3.1 8B Experiment
1109: 1) resolved timelyapf issue, 2) seed fixed to 42 for all runs, 3) 3000 steps -> 2000 steps (better benchmark scores!)

âœ”ï¸Running with fullrand7 x GPipe ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1104_llama8b/config_1109.toml --job.description="Llama 3.1 8B Experiment
1109: 1) resolved timelyapf issue, 2) seed fixed to 42 for all runs, 3) 3000 steps -> 2000 steps (better benchmark scores!)
" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=fullrand7 --freezing.threshold=0.05 --freezing.max_freeze_ratio=0.8 --freezing.percentile=80
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
W1110 17:55:11.809000 3445034 site-packages/torch/distributed/run.py:811] 
W1110 17:55:11.809000 3445034 site-packages/torch/distributed/run.py:811] *****************************************
W1110 17:55:11.809000 3445034 site-packages/torch/distributed/run.py:811] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1110 17:55:11.809000 3445034 site-packages/torch/distributed/run.py:811] *****************************************
[rank2]:2025-11-10 17:55:19,650 - INFO - Starting job: "Llama 3.1 8B Experiment
[rank2]:1109: 1) resolved timelyapf issue, 2) seed fixed to 42 for all runs, 3) 3000 steps -> 2000 steps (better benchmark scores!)
[rank2]:"
[rank2]:2025-11-10 17:55:20,010 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-11-10 17:55:20,017 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-10 17:55:20,104 - INFO - Starting job: "Llama 3.1 8B Experiment
[rank0]:1109: 1) resolved timelyapf issue, 2) seed fixed to 42 for all runs, 3) 3000 steps -> 2000 steps (better benchmark scores!)
[rank0]:"
[rank1]:2025-11-10 17:55:20,164 - INFO - Starting job: "Llama 3.1 8B Experiment
[rank1]:1109: 1) resolved timelyapf issue, 2) seed fixed to 42 for all runs, 3) 3000 steps -> 2000 steps (better benchmark scores!)
[rank1]:"
[rank3]:2025-11-10 17:55:20,233 - INFO - Starting job: "Llama 3.1 8B Experiment
[rank3]:1109: 1) resolved timelyapf issue, 2) seed fixed to 42 for all runs, 3) 3000 steps -> 2000 steps (better benchmark scores!)
[rank3]:"
[rank0]:2025-11-10 17:55:21,196 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-11-10 17:55:21,199 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-10 17:55:21,205 - INFO - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-11-10 17:55:21,207 - INFO - Loading tokenizer from tokenizer.json
[rank1]:2025-11-10 17:55:21,252 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-11-10 17:55:21,258 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-11-10 17:55:21,286 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-11-10 17:55:21,289 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-10 17:55:21,560 - INFO - Preparing openhermes dataset from teknium/OpenHermes-2.5
[rank2]:2025-11-10 17:55:22,732 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank2]:2025-11-10 17:55:22,816 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.17', 'layers.18', 'layers.19', 'layers.20', 'layers.21', 'layers.22', 'layers.23', 'layers.24']
[rank2]:2025-11-10 17:55:22,816 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank2]:2025-11-10 17:55:23,056 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank2]:2025-11-10 17:55:23,057 - INFO - CUDA memory usage for model: 6.51GiB(4.65%)
[rank1]:2025-11-10 17:55:24,146 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank1]:2025-11-10 17:55:24,231 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.8', 'layers.9', 'layers.10', 'layers.11', 'layers.12', 'layers.13', 'layers.14', 'layers.15', 'layers.16']
[rank1]:2025-11-10 17:55:24,231 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-11-10 17:55:24,195 - INFO - Building llama3 8B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=4096, n_layers=32, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=1024, ffn_dim_multiplier=1.3, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank1]:2025-11-10 17:55:24,471 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank1]:2025-11-10 17:55:24,471 - INFO - CUDA memory usage for model: 7.33GiB(5.24%)
[rank0]:2025-11-10 17:55:24,474 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank0]:2025-11-10 17:55:24,531 - INFO - Model llama3 8B size: 8,030,261,248 total parameters
[rank0]:2025-11-10 17:55:24,561 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3', 'layers.4', 'layers.5', 'layers.6', 'layers.7']
[rank0]:2025-11-10 17:55:24,561 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank0]:2025-11-10 17:55:24,826 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank0]:2025-11-10 17:55:24,827 - INFO - CUDA memory usage for model: 8.46GiB(6.05%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run e9l9k34m
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1109_GPipe_fullrand7_h200/20251110-1755/wandb/run-20251110_175525-e9l9k34m
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1109_GPipe_fullrand7_h200
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/e9l9k34m
[rank3]:2025-11-10 17:55:26,258 - INFO - WandB logging enabled
[rank3]:2025-11-10 17:55:26,259 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank3]:2025-11-10 17:55:26,387 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.25', 'layers.26', 'layers.27', 'layers.28', 'layers.29', 'layers.30', 'layers.31', 'norm', 'output']
[rank3]:2025-11-10 17:55:26,388 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank3]:2025-11-10 17:55:26,657 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank3]:2025-11-10 17:55:26,658 - INFO - CUDA memory usage for model: 7.66GiB(5.48%)
[rank2]:2025-11-10 17:55:26,673 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-10 17:55:26,673 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1109_GPipe_fullrand7_h200
[rank0]:2025-11-10 17:55:26,673 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-10 17:55:26,673 - INFO - Trainer is initialized with local batch size 16, global batch size 64, gradient accumulation steps 4, sequence length 1024, total steps 2000 (warmup 200)
[rank0]:2025-11-10 17:55:26,673 - INFO - Loading the checkpoint from /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B/original_dcp.
[rank1]:2025-11-10 17:55:26,675 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-11-10 17:55:26,676 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-10 17:55:41,452 - INFO - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-11-10 17:55:41,452 - INFO - Finished loading the checkpoint in 14.78 seconds.
[rank0]:2025-11-10 17:55:41,452 - INFO - Training starts at step 1
[rank1]:2025-11-10 17:55:46,599 - INFO -  step:  1  loss: -4.0000  grad_norm:     inf  memory: 49.69GiB(35.54%)  tps: 731  tflops: 34.12  mfu: 3.45%
[rank1]:2025-11-10 17:55:46,600 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-11-10 17:55:46,602 - INFO -  step:  1  loss:  8.2933  grad_norm:     inf  memory: 58.03GiB(41.50%)  tps: 808  tflops: 37.70  mfu: 3.81%
[rank3]:2025-11-10 17:55:46,603 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-11-10 17:55:46,601 - INFO -  step:  1  loss: -4.0000  grad_norm:     inf  memory: 44.28GiB(31.67%)  tps: 688  tflops: 32.09  mfu: 3.24%
[rank2]:2025-11-10 17:55:46,601 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-10 17:55:46,619 - INFO -  step:  1  loss: -4.0000  grad_norm:     inf  memory: 49.75GiB(35.58%)  tps: 742  tflops: 34.59  mfu: 3.50%
[rank0]:2025-11-10 17:55:46,620 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-10 17:57:54,630 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-10 17:57:57,073 - INFO - Avg. fwd time: 14.5372 / Avg. bwd time: 42.5914 / Avg. batch time: 477.1870 (ms) / GPU bubble ratio: 4.22%
[rank2]:2025-11-10 17:57:57,123 - INFO - Avg. fwd time: 13.1023 / Avg. bwd time: 36.2044 / Avg. batch time: 530.6214 (ms) / GPU bubble ratio: 25.66%
[rank1]:2025-11-10 17:57:57,170 - INFO - Avg. fwd time: 15.1067 / Avg. bwd time: 41.3149 / Avg. batch time: 591.8536 (ms) / GPU bubble ratio: 23.74%
[rank0]:2025-11-10 17:57:57,203 - INFO - Avg. fwd time: 14.4064 / Avg. bwd time: 38.2438 / Avg. batch time: 648.7437 (ms) / GPU bubble ratio: 35.07%
[rank3]:2025-11-10 17:57:57,311 - INFO -  step: 50  loss:  9.4337  grad_norm: 5679.8618  memory: 73.38GiB(52.48%)  tps: 6,142  tflops: 286.47  mfu: 28.97%
[rank2]:2025-11-10 17:57:57,305 - INFO -  step: 50  loss: -4.0000  grad_norm: 5679.8618  memory: 57.29GiB(40.97%)  tps: 6,142  tflops: 286.47  mfu: 28.97%
[rank0]:2025-11-10 17:57:57,312 - INFO -  step: 50  loss: -4.0000  grad_norm: 5679.8618  memory: 66.72GiB(47.72%)  tps: 6,143  tflops: 286.50  mfu: 28.97%
[rank1]:2025-11-10 17:57:57,308 - INFO -  step: 50  loss: -4.0000  grad_norm: 5679.8618  memory: 64.32GiB(46.00%)  tps: 6,142  tflops: 286.47  mfu: 28.97%
[rank0]:2025-11-10 18:00:07,979 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-10 18:00:10,421 - INFO - Avg. fwd time: 14.5051 / Avg. bwd time: 42.6673 / Avg. batch time: 474.9842 (ms) / GPU bubble ratio: 3.71%
[rank2]:2025-11-10 18:00:10,471 - INFO - Avg. fwd time: 13.0999 / Avg. bwd time: 36.3153 / Avg. batch time: 527.9575 (ms) / GPU bubble ratio: 25.12%
[rank1]:2025-11-10 18:00:10,517 - INFO - Avg. fwd time: 15.1258 / Avg. bwd time: 41.4022 / Avg. batch time: 588.4696 (ms) / GPU bubble ratio: 23.15%
[rank0]:2025-11-10 18:00:10,551 - INFO - Avg. fwd time: 14.0828 / Avg. bwd time: 38.3400 / Avg. batch time: 644.7637 (ms) / GPU bubble ratio: 34.96%
[rank3]:2025-11-10 18:00:10,658 - INFO -  step: 100  loss:  4.3512  grad_norm: 64.5975  memory: 73.38GiB(52.48%)  tps: 6,144  tflops: 286.53  mfu: 28.97%
[rank3]:2025-11-10 18:00:10,658 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-11-10 18:00:10,660 - INFO -  step: 100  loss: -4.0000  grad_norm: 64.5975  memory: 66.72GiB(47.72%)  tps: 6,143  tflops: 286.53  mfu: 28.97%
[rank0]:2025-11-10 18:00:10,660 - WARNING - Nothing to draw before the end of warmup.
[rank2]:2025-11-10 18:00:10,653 - INFO -  step: 100  loss: -4.0000  grad_norm: 64.5975  memory: 57.29GiB(40.97%)  tps: 6,143  tflops: 286.53  mfu: 28.97%
[rank2]:2025-11-10 18:00:10,653 - WARNING - Nothing to draw before the end of warmup.
[rank1]:2025-11-10 18:00:10,656 - INFO -  step: 100  loss: -4.0000  grad_norm: 64.5975  memory: 64.32GiB(46.00%)  tps: 6,143  tflops: 286.53  mfu: 28.97%
[rank1]:2025-11-10 18:00:10,656 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-11-10 18:02:21,230 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-10 18:02:23,783 - INFO - Avg. fwd time: 14.4584 / Avg. bwd time: 42.6953 / Avg. batch time: 474.1215 (ms) / GPU bubble ratio: 3.56%
[rank1]:2025-11-10 18:02:23,875 - INFO - Avg. fwd time: 15.0894 / Avg. bwd time: 41.4318 / Avg. batch time: 587.2329 (ms) / GPU bubble ratio: 23.00%
[rank2]:2025-11-10 18:02:23,827 - INFO - Avg. fwd time: 13.0690 / Avg. bwd time: 36.3706 / Avg. batch time: 526.9644 (ms) / GPU bubble ratio: 24.94%
[rank0]:2025-11-10 18:02:23,921 - INFO - Avg. fwd time: 13.9714 / Avg. bwd time: 38.3821 / Avg. batch time: 643.3406 (ms) / GPU bubble ratio: 34.90%
[rank0]:2025-11-10 18:02:23,956 - INFO -  step: 150  loss: -4.0000  grad_norm: 22.2798  memory: 66.72GiB(47.72%)  tps: 6,146  tflops: 286.64  mfu: 28.98%
[rank1]:2025-11-10 18:02:23,952 - INFO -  step: 150  loss: -4.0000  grad_norm: 22.2798  memory: 64.32GiB(46.00%)  tps: 6,146  tflops: 286.64  mfu: 28.98%
[rank2]:2025-11-10 18:02:23,950 - INFO -  step: 150  loss: -4.0000  grad_norm: 22.2798  memory: 57.29GiB(40.97%)  tps: 6,146  tflops: 286.64  mfu: 28.98%
[rank3]:2025-11-10 18:02:23,957 - INFO -  step: 150  loss:  1.9551  grad_norm: 22.2798  memory: 73.38GiB(52.48%)  tps: 6,146  tflops: 286.64  mfu: 28.98%
[rank3]:2025-11-10 18:02:50,378 - INFO - [Step 160] ã€°ï¸ Monitoring Upperbound
[rank3]:2025-11-10 18:03:16,963 - INFO - [Step 170] âœ”ï¸  Setting Upperbound
[rank3]:2025-11-10 18:03:17,190 - INFO - [Step 170] ã€°ï¸ Monitoring Lowerbound
[rank1]:2025-11-10 18:03:17,308 - WARNING - Batch index 681 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-10 18:03:17,302 - WARNING - Batch index 681 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-10 18:03:17,302 - WARNING - Batch index 681 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-10 18:03:17,335 - WARNING - Batch index 681 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-10 18:03:17,309 - WARNING - Batch index 681 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-10 18:03:17,342 - WARNING - Batch index 681 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-10 18:03:17,374 - WARNING - Batch index 681 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-10 18:03:17,330 - WARNING - Batch index 681 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-10 18:03:17,321 - WARNING - Batch index 681 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-10 18:03:17,339 - WARNING - Batch index 681 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-10 18:03:17,368 - WARNING - Batch index 681 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-10 18:03:17,454 - WARNING - Batch index 681 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-10 18:03:17,414 - WARNING - Batch index 681 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-10 18:03:17,448 - WARNING - Batch index 681 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-10 18:03:17,462 - WARNING - Batch index 681 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-10 18:03:17,498 - WARNING - Batch index 681 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-10 18:03:17,490 - WARNING - Batch index 681 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-10 18:03:17,525 - WARNING - Batch index 681 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-10 18:03:17,486 - WARNING - Batch index 681 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-10 18:03:17,524 - WARNING - Batch index 681 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-10 18:03:17,561 - WARNING - Batch index 681 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-10 18:03:17,520 - WARNING - Batch index 681 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-10 18:03:17,557 - WARNING - Batch index 681 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-10 18:03:17,595 - WARNING - Batch index 681 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-10 18:03:17,537 - WARNING - Batch index 681 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-10 18:03:17,573 - WARNING - Batch index 681 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-10 18:03:17,610 - WARNING - Batch index 681 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-10 18:03:17,563 - WARNING - Batch index 681 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-10 18:03:17,601 - WARNING - Batch index 681 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-10 18:03:17,633 - WARNING - Batch index 681 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-10 18:03:17,671 - WARNING - Batch index 681 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-10 18:03:17,648 - WARNING - Batch index 681 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-10 18:03:34,131 - INFO - [Step 180] âœ”ï¸  Setting Lowerbound
[rank3]:2025-11-10 18:03:34,373 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/pipeline_schedule/251110_1803_max_batch_time.svg
[rank3]:> Batch Time: 624.98 ms, GPU Bubble Ratio: 33.07%, 27.36%, 36.52%, 26.67%
[rank3]:2025-11-10 18:03:34,530 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/pipeline_schedule/251110_1803_min_batch_time.svg
[rank3]:> Batch Time: 356.19 ms, GPU Bubble Ratio: 69.34%, 24.58%, 34.34%, 23.71%
[rank3]:2025-11-10 18:03:34,713 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/pipeline_schedule/251110_1803_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 393.27 ms, GPU Bubble Ratio: 28.89%, 20.92%, 25.65%, 21.47%
[rank3]:2025-11-10 18:03:34,714 - INFO - 	> Batch Time: 393.27 ms (Average Freeze Ratio: 0.66, Time Reduction Rate: 0.37)
[rank0]:2025-11-10 18:04:19,223 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-10 18:04:21,585 - INFO - Avg. fwd time: 13.2911 / Avg. bwd time: 34.1088 / Avg. batch time: 515.1040 (ms) / GPU bubble ratio: 26.38%
[rank3]:2025-11-10 18:04:21,557 - INFO - Avg. fwd time: 14.5381 / Avg. bwd time: 41.2639 / Avg. batch time: 464.0807 (ms) / GPU bubble ratio: 3.81%
[rank3]:2025-11-10 18:04:21,586 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.33/1.00, [MB1] 0.33/1.00, [MB2] 0.33/1.00, [MB3] 0.33/1.00, [MB4] 0.33/1.00, [MB5] 0.33/1.00, [MB6] 0.13/0.40, [MB7] 0.00/0.00
[rank0]:2025-11-10 18:04:21,649 - INFO - Avg. fwd time: 14.1473 / Avg. bwd time: 34.2582 / Avg. batch time: 624.4775 (ms) / GPU bubble ratio: 37.99%
[rank1]:2025-11-10 18:04:21,636 - INFO - Avg. fwd time: 15.3988 / Avg. bwd time: 38.8856 / Avg. batch time: 572.6591 (ms) / GPU bubble ratio: 24.17%
[rank2]:2025-11-10 18:04:21,677 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.28/0.83, [MB1] 0.28/0.83, [MB2] 0.19/0.58, [MB3] 0.33/1.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.30/0.89, [MB7] 0.33/1.00
[rank0]:2025-11-10 18:04:21,745 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.19/0.58, [MB4] 0.00/0.00, [MB5] 0.33/1.00, [MB6] 0.33/1.00, [MB7] 0.33/1.00
[rank0]:2025-11-10 18:04:21,764 - INFO -  step: 200  loss: -4.0000  grad_norm: 12.2340  memory: 70.00GiB(50.07%)  tps: 6,954  tflops: 324.32  mfu: 32.79%
[rank1]:2025-11-10 18:04:21,715 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.31/0.93, [MB1] 0.04/0.12, [MB2] 0.33/1.00, [MB3] 0.04/0.12, [MB4] 0.33/1.00, [MB5] 0.33/1.00, [MB6] 0.33/1.00, [MB7] 0.33/1.00
[rank1]:2025-11-10 18:04:21,762 - INFO -  step: 200  loss: -4.0000  grad_norm: 12.2340  memory: 72.68GiB(51.98%)  tps: 6,954  tflops: 324.32  mfu: 32.79%
[rank2]:2025-11-10 18:04:21,758 - INFO -  step: 200  loss: -4.0000  grad_norm: 12.2340  memory: 64.67GiB(46.25%)  tps: 6,954  tflops: 324.32  mfu: 32.79%
[rank3]:2025-11-10 18:04:21,770 - INFO -  step: 200  loss:  0.5663  grad_norm: 12.2340  memory: 83.96GiB(60.05%)  tps: 6,953  tflops: 324.31  mfu: 32.79%
[rank0]:2025-11-10 18:04:21,839 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/freeze_ratio_history/rank0/251110_1804_stage0_step200.svg
[rank1]:2025-11-10 18:04:21,861 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/freeze_ratio_history/rank1/251110_1804_stage1_step200.svg
[rank2]:2025-11-10 18:04:21,844 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/freeze_ratio_history/rank2/251110_1804_stage2_step200.svg
[rank3]:2025-11-10 18:04:21,914 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/pipeline_schedule/251110_1804_real_step200_rank3.svg
[rank3]:> Batch Time: 535.00 ms, GPU Bubble Ratio: 76.97%, 47.08%, 53.42%, 20.80%
[rank3]:2025-11-10 18:04:21,960 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/freeze_ratio_history/rank3/251110_1804_stage3_step200.svg
[rank0]:2025-11-10 18:06:21,104 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-10 18:06:23,317 - INFO - Avg. fwd time: 13.4303 / Avg. bwd time: 32.5065 / Avg. batch time: 511.8400 (ms) / GPU bubble ratio: 28.20%
[rank3]:2025-11-10 18:06:23,303 - INFO - Avg. fwd time: 14.4849 / Avg. bwd time: 41.1694 / Avg. batch time: 462.4678 (ms) / GPU bubble ratio: 3.73%
[rank0]:2025-11-10 18:06:23,360 - INFO - Avg. fwd time: 14.2267 / Avg. bwd time: 32.6342 / Avg. batch time: 617.6522 (ms) / GPU bubble ratio: 39.30%
[rank1]:2025-11-10 18:06:23,349 - INFO - Avg. fwd time: 15.5317 / Avg. bwd time: 37.1209 / Avg. batch time: 567.6167 (ms) / GPU bubble ratio: 25.79%
[rank2]:2025-11-10 18:06:23,415 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.55/0.83, [MB1] 0.55/0.83, [MB2] 0.39/0.58, [MB3] 0.67/1.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.59/0.89, [MB7] 0.67/1.00
[rank3]:2025-11-10 18:06:23,332 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.67/1.00, [MB1] 0.67/1.00, [MB2] 0.67/1.00, [MB3] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.27/0.40, [MB7] 0.00/0.00
[rank0]:2025-11-10 18:06:23,465 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.38/0.58, [MB4] 0.00/0.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank1]:2025-11-10 18:06:23,443 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.62/0.93, [MB1] 0.08/0.12, [MB2] 0.67/1.00, [MB3] 0.08/0.12, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank1]:2025-11-10 18:06:23,474 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.3806  memory: 72.68GiB(51.98%)  tps: 6,731  tflops: 313.92  mfu: 31.74%
[rank3]:2025-11-10 18:06:23,490 - INFO -  step: 250  loss:  0.2564  grad_norm:  0.3806  memory: 83.96GiB(60.05%)  tps: 6,730  tflops: 313.90  mfu: 31.74%
[rank2]:2025-11-10 18:06:23,473 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.3806  memory: 64.67GiB(46.25%)  tps: 6,731  tflops: 313.91  mfu: 31.74%
[rank0]:2025-11-10 18:06:23,473 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.3806  memory: 72.03GiB(51.52%)  tps: 6,731  tflops: 313.93  mfu: 31.74%
[rank0]:2025-11-10 18:08:16,148 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-10 18:08:18,313 - INFO - Avg. fwd time: 14.4373 / Avg. bwd time: 40.8513 / Avg. batch time: 460.2326 (ms) / GPU bubble ratio: 3.89%
[rank3]:2025-11-10 18:08:18,321 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 0.40/0.40, [MB7] 0.00/0.00
[rank1]:2025-11-10 18:08:18,362 - INFO - Avg. fwd time: 15.7644 / Avg. bwd time: 34.6208 / Avg. batch time: 560.6830 (ms) / GPU bubble ratio: 28.11%
[rank1]:2025-11-10 18:08:18,365 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.93/0.93, [MB1] 0.12/0.12, [MB2] 1.00/1.00, [MB3] 0.12/0.12, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank2]:2025-11-10 18:08:18,337 - INFO - Avg. fwd time: 13.6246 / Avg. bwd time: 30.4860 / Avg. batch time: 507.4656 (ms) / GPU bubble ratio: 30.46%
[rank2]:2025-11-10 18:08:18,339 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.83/0.83, [MB1] 0.83/0.83, [MB2] 0.58/0.58, [MB3] 1.00/1.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.89/0.89, [MB7] 1.00/1.00
[rank2]:2025-11-10 18:08:18,374 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.0936  memory: 65.57GiB(46.90%)  tps: 7,130  tflops: 332.53  mfu: 33.62%
[rank3]:2025-11-10 18:08:18,397 - INFO -  step: 300  loss:  0.2830  grad_norm:  0.0936  memory: 83.96GiB(60.05%)  tps: 7,129  tflops: 332.51  mfu: 33.62%
[rank0]:2025-11-10 18:08:18,371 - INFO - Avg. fwd time: 14.3811 / Avg. bwd time: 29.6303 / Avg. batch time: 607.5371 (ms) / GPU bubble ratio: 42.05%
[rank0]:2025-11-10 18:08:18,373 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.58/0.58, [MB4] 0.00/0.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank0]:2025-11-10 18:08:18,374 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.0936  memory: 72.03GiB(51.52%)  tps: 7,130  tflops: 332.53  mfu: 33.62%
[rank0]:2025-11-10 18:08:18,454 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/freeze_ratio_history/rank0/251110_1808_stage0_step300.svg
[rank1]:2025-11-10 18:08:18,374 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.0936  memory: 73.30GiB(52.43%)  tps: 7,130  tflops: 332.53  mfu: 33.62%
[rank1]:2025-11-10 18:08:18,444 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/freeze_ratio_history/rank1/251110_1808_stage1_step300.svg
[rank2]:2025-11-10 18:08:18,446 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/freeze_ratio_history/rank2/251110_1808_stage2_step300.svg
[rank3]:2025-11-10 18:08:18,536 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/pipeline_schedule/251110_1808_real_step300_rank3.svg
[rank3]:> Batch Time: 537.24 ms, GPU Bubble Ratio: 72.53%, 45.47%, 51.77%, 21.28%
[rank3]:2025-11-10 18:08:18,576 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/freeze_ratio_history/rank3/251110_1808_stage3_step300.svg
[rank0]:2025-11-10 18:10:05,653 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-10 18:10:07,378 - INFO - Avg. fwd time: 14.5309 / Avg. bwd time: 25.7681 / Avg. batch time: 597.6723 (ms) / GPU bubble ratio: 46.06%
[rank2]:2025-11-10 18:10:07,690 - INFO - Avg. fwd time: 13.8273 / Avg. bwd time: 28.6066 / Avg. batch time: 503.9136 (ms) / GPU bubble ratio: 32.63%
[rank3]:2025-11-10 18:10:07,711 - INFO - Avg. fwd time: 14.4040 / Avg. bwd time: 40.5394 / Avg. batch time: 458.6521 (ms) / GPU bubble ratio: 4.17%
[rank1]:2025-11-10 18:10:07,735 - INFO - Avg. fwd time: 15.9888 / Avg. bwd time: 32.4572 / Avg. batch time: 554.8319 (ms) / GPU bubble ratio: 30.15%
[rank3]:2025-11-10 18:10:07,741 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 0.40/0.40, [MB7] 0.00/0.00
[rank2]:2025-11-10 18:10:07,815 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.83/0.83, [MB1] 0.83/0.83, [MB2] 0.58/0.58, [MB3] 1.00/1.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.89/0.89, [MB7] 1.00/1.00
[rank0]:2025-11-10 18:10:07,834 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.58/0.58, [MB4] 0.00/0.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank0]:2025-11-10 18:10:07,834 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.0000  memory: 72.03GiB(51.52%)  tps: 7,484  tflops: 349.06  mfu: 35.29%
[rank1]:2025-11-10 18:10:07,834 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.93/0.93, [MB1] 0.12/0.12, [MB2] 1.00/1.00, [MB3] 0.12/0.12, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-11-10 18:10:07,834 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.0000  memory: 73.30GiB(52.43%)  tps: 7,484  tflops: 349.05  mfu: 35.29%
[rank3]:2025-11-10 18:10:07,858 - INFO -  step: 350  loss:  0.3335  grad_norm:  0.0772  memory: 83.96GiB(60.05%)  tps: 7,484  tflops: 349.06  mfu: 35.29%
[rank2]:2025-11-10 18:10:07,833 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 7,484  tflops: 349.06  mfu: 35.29%
[rank0]:2025-11-10 18:11:54,717 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-10 18:11:56,454 - INFO - Avg. fwd time: 14.6582 / Avg. bwd time: 22.3652 / Avg. batch time: 588.8054 (ms) / GPU bubble ratio: 49.70%
[rank2]:2025-11-10 18:11:56,767 - INFO - Avg. fwd time: 14.0042 / Avg. bwd time: 26.9493 / Avg. batch time: 500.6131 (ms) / GPU bubble ratio: 34.55%
[rank3]:2025-11-10 18:11:56,788 - INFO - Avg. fwd time: 14.3706 / Avg. bwd time: 40.2496 / Avg. batch time: 457.1457 (ms) / GPU bubble ratio: 4.42%
[rank1]:2025-11-10 18:11:56,811 - INFO - Avg. fwd time: 16.1860 / Avg. bwd time: 30.5497 / Avg. batch time: 549.5038 (ms) / GPU bubble ratio: 31.96%
[rank2]:2025-11-10 18:11:56,889 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.83/0.83, [MB1] 0.83/0.83, [MB2] 0.58/0.58, [MB3] 1.00/1.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.89/0.89, [MB7] 1.00/1.00
[rank2]:2025-11-10 18:11:56,907 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 7,511  tflops: 350.29  mfu: 35.42%
[rank3]:2025-11-10 18:11:56,817 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 0.40/0.40, [MB7] 0.00/0.00
[rank0]:2025-11-10 18:11:56,907 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.58/0.58, [MB4] 0.00/0.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank0]:2025-11-10 18:11:56,908 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.0000  memory: 72.03GiB(51.52%)  tps: 7,511  tflops: 350.29  mfu: 35.42%
[rank1]:2025-11-10 18:11:56,907 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.93/0.93, [MB1] 0.12/0.12, [MB2] 1.00/1.00, [MB3] 0.12/0.12, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-11-10 18:11:56,908 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.0000  memory: 73.30GiB(52.43%)  tps: 7,511  tflops: 350.29  mfu: 35.42%
[rank2]:2025-11-10 18:11:56,983 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/freeze_ratio_history/rank2/251110_1811_stage2_step400.svg
[rank3]:2025-11-10 18:11:56,932 - INFO -  step: 400  loss:  0.2768  grad_norm:  0.0548  memory: 83.96GiB(60.05%)  tps: 7,511  tflops: 350.30  mfu: 35.42%
[rank0]:2025-11-10 18:11:56,984 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/freeze_ratio_history/rank0/251110_1811_stage0_step400.svg
[rank1]:2025-11-10 18:11:56,983 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/freeze_ratio_history/rank1/251110_1811_stage1_step400.svg
[rank3]:2025-11-10 18:11:57,064 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/pipeline_schedule/251110_1811_real_step400_rank3.svg
[rank3]:> Batch Time: 530.00 ms, GPU Bubble Ratio: 76.67%, 46.44%, 52.92%, 20.80%
[rank3]:2025-11-10 18:11:57,108 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/freeze_ratio_history/rank3/251110_1811_stage3_step400.svg
[rank0]:2025-11-10 18:13:44,239 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-10 18:13:46,433 - INFO - Avg. fwd time: 14.1399 / Avg. bwd time: 25.6780 / Avg. batch time: 498.1410 (ms) / GPU bubble ratio: 36.05%
[rank3]:2025-11-10 18:13:46,408 - INFO - Avg. fwd time: 14.3459 / Avg. bwd time: 40.0280 / Avg. batch time: 456.0000 (ms) / GPU bubble ratio: 4.61%
[rank1]:2025-11-10 18:13:46,459 - INFO - Avg. fwd time: 16.3384 / Avg. bwd time: 29.0865 / Avg. batch time: 545.4791 (ms) / GPU bubble ratio: 33.38%
[rank1]:2025-11-10 18:13:46,471 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.0000  memory: 73.30GiB(52.43%)  tps: 7,477  tflops: 348.73  mfu: 35.26%
[rank2]:2025-11-10 18:13:46,471 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 7,477  tflops: 348.72  mfu: 35.26%
[rank3]:2025-11-10 18:13:46,497 - INFO -  step: 450  loss:  0.2980  grad_norm:  0.0835  memory: 83.96GiB(60.05%)  tps: 7,477  tflops: 348.73  mfu: 35.26%
[rank0]:2025-11-10 18:13:46,469 - INFO - Avg. fwd time: 14.7647 / Avg. bwd time: 19.7564 / Avg. batch time: 582.0945 (ms) / GPU bubble ratio: 52.56%
[rank0]:2025-11-10 18:13:46,473 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.0000  memory: 72.03GiB(51.52%)  tps: 7,477  tflops: 348.72  mfu: 35.26%
[rank0]:2025-11-10 18:15:34,558 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-10 18:15:36,313 - INFO - Avg. fwd time: 14.8460 / Avg. bwd time: 17.9607 / Avg. batch time: 577.5107 (ms) / GPU bubble ratio: 54.55%
[rank2]:2025-11-10 18:15:36,607 - INFO - Avg. fwd time: 14.2327 / Avg. bwd time: 24.8035 / Avg. batch time: 496.4400 (ms) / GPU bubble ratio: 37.09%
[rank3]:2025-11-10 18:15:36,627 - INFO - Avg. fwd time: 14.3278 / Avg. bwd time: 39.8803 / Avg. batch time: 455.2483 (ms) / GPU bubble ratio: 4.74%
[rank1]:2025-11-10 18:15:36,651 - INFO - Avg. fwd time: 16.4428 / Avg. bwd time: 28.0798 / Avg. batch time: 542.7108 (ms) / GPU bubble ratio: 34.37%
[rank2]:2025-11-10 18:15:36,747 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 7,429  tflops: 346.47  mfu: 35.03%
[rank3]:2025-11-10 18:15:36,773 - INFO -  step: 500  loss:  0.3105  grad_norm:  0.1026  memory: 83.96GiB(60.05%)  tps: 7,429  tflops: 346.48  mfu: 35.03%
[rank1]:2025-11-10 18:15:36,748 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.0000  memory: 73.30GiB(52.43%)  tps: 7,429  tflops: 346.47  mfu: 35.03%
[rank0]:2025-11-10 18:15:36,749 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.0000  memory: 72.03GiB(51.52%)  tps: 7,429  tflops: 346.47  mfu: 35.03%
[rank0]:2025-11-10 18:15:36,826 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/freeze_ratio_history/rank0/251110_1815_stage0_step500.svg
[rank2]:2025-11-10 18:15:36,823 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/freeze_ratio_history/rank2/251110_1815_stage2_step500.svg
[rank1]:2025-11-10 18:15:36,824 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/freeze_ratio_history/rank1/251110_1815_stage1_step500.svg
[rank3]:2025-11-10 18:15:36,922 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/pipeline_schedule/251110_1815_real_step500_rank3.svg
[rank3]:> Batch Time: 531.00 ms, GPU Bubble Ratio: 76.63%, 46.66%, 53.03%, 20.72%
[rank3]:2025-11-10 18:15:36,966 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/freeze_ratio_history/rank3/251110_1815_stage3_step500.svg
[rank0]:2025-11-10 18:17:24,221 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-10 18:17:25,964 - INFO - Avg. fwd time: 14.9124 / Avg. bwd time: 16.2387 / Avg. batch time: 573.0872 (ms) / GPU bubble ratio: 56.51%
[rank2]:2025-11-10 18:17:26,256 - INFO - Avg. fwd time: 14.3194 / Avg. bwd time: 23.9637 / Avg. batch time: 494.8010 (ms) / GPU bubble ratio: 38.10%
[rank3]:2025-11-10 18:17:26,276 - INFO - Avg. fwd time: 14.3066 / Avg. bwd time: 39.7372 / Avg. batch time: 454.4789 (ms) / GPU bubble ratio: 4.87%
[rank1]:2025-11-10 18:17:26,300 - INFO - Avg. fwd time: 16.5397 / Avg. bwd time: 27.1124 / Avg. batch time: 540.0441 (ms) / GPU bubble ratio: 35.34%
[rank0]:2025-11-10 18:17:26,398 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.0000  memory: 72.03GiB(51.52%)  tps: 7,471  tflops: 348.45  mfu: 35.23%
[rank2]:2025-11-10 18:17:26,396 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 7,471  tflops: 348.45  mfu: 35.23%
[rank3]:2025-11-10 18:17:26,422 - INFO -  step: 550  loss:  0.1782  grad_norm:  0.0653  memory: 83.96GiB(60.05%)  tps: 7,471  tflops: 348.46  mfu: 35.23%
[rank1]:2025-11-10 18:17:26,397 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.0000  memory: 73.30GiB(52.43%)  tps: 7,471  tflops: 348.45  mfu: 35.23%
[rank0]:2025-11-10 18:19:14,989 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-10 18:19:17,218 - INFO - Avg. fwd time: 14.3041 / Avg. bwd time: 39.6271 / Avg. batch time: 454.0275 (ms) / GPU bubble ratio: 4.97%
[rank2]:2025-11-10 18:19:17,243 - INFO - Avg. fwd time: 14.4014 / Avg. bwd time: 23.2763 / Avg. batch time: 493.6103 (ms) / GPU bubble ratio: 38.94%
[rank0]:2025-11-10 18:19:17,281 - INFO - Avg. fwd time: 14.9776 / Avg. bwd time: 14.8182 / Avg. batch time: 569.6289 (ms) / GPU bubble ratio: 58.15%
[rank0]:2025-11-10 18:19:17,284 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0000  memory: 72.03GiB(51.52%)  tps: 7,388  tflops: 344.57  mfu: 34.84%
[rank3]:2025-11-10 18:19:17,309 - INFO -  step: 600  loss:  0.4174  grad_norm:  0.1006  memory: 83.96GiB(60.05%)  tps: 7,388  tflops: 344.57  mfu: 34.84%
[rank2]:2025-11-10 18:19:17,283 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 7,388  tflops: 344.57  mfu: 34.84%
[rank1]:2025-11-10 18:19:17,271 - INFO - Avg. fwd time: 16.6325 / Avg. bwd time: 26.3222 / Avg. batch time: 538.0270 (ms) / GPU bubble ratio: 36.13%
[rank1]:2025-11-10 18:19:17,283 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0000  memory: 73.30GiB(52.43%)  tps: 7,388  tflops: 344.57  mfu: 34.84%
[rank0]:2025-11-10 18:19:17,364 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/freeze_ratio_history/rank0/251110_1819_stage0_step600.svg
[rank2]:2025-11-10 18:19:17,360 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/freeze_ratio_history/rank2/251110_1819_stage2_step600.svg
[rank1]:2025-11-10 18:19:17,365 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/freeze_ratio_history/rank1/251110_1819_stage1_step600.svg
[rank3]:2025-11-10 18:19:17,457 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/pipeline_schedule/251110_1819_real_step600_rank3.svg
[rank3]:> Batch Time: 537.00 ms, GPU Bubble Ratio: 76.48%, 46.49%, 52.96%, 20.68%
[rank3]:2025-11-10 18:19:17,504 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/freeze_ratio_history/rank3/251110_1819_stage3_step600.svg
[rank0]:2025-11-10 18:21:07,571 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-10 18:21:09,352 - INFO - Avg. fwd time: 15.0390 / Avg. bwd time: 13.7846 / Avg. batch time: 567.4659 (ms) / GPU bubble ratio: 59.37%
[rank2]:2025-11-10 18:21:09,651 - INFO - Avg. fwd time: 14.4727 / Avg. bwd time: 22.7795 / Avg. batch time: 493.0728 (ms) / GPU bubble ratio: 39.56%
[rank1]:2025-11-10 18:21:09,696 - INFO - Avg. fwd time: 16.7126 / Avg. bwd time: 25.7515 / Avg. batch time: 536.9018 (ms) / GPU bubble ratio: 36.73%
[rank3]:2025-11-10 18:21:09,673 - INFO - Avg. fwd time: 14.3177 / Avg. bwd time: 39.5686 / Avg. batch time: 453.9772 (ms) / GPU bubble ratio: 5.04%
[rank2]:2025-11-10 18:21:09,792 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 7,281  tflops: 339.60  mfu: 34.34%
[rank0]:2025-11-10 18:21:09,793 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0000  memory: 72.03GiB(51.52%)  tps: 7,281  tflops: 339.60  mfu: 34.34%
[rank1]:2025-11-10 18:21:09,794 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0000  memory: 73.30GiB(52.43%)  tps: 7,281  tflops: 339.59  mfu: 34.34%
[rank3]:2025-11-10 18:21:09,819 - INFO -  step: 650  loss:  0.2972  grad_norm:  0.0697  memory: 83.96GiB(60.05%)  tps: 7,281  tflops: 339.61  mfu: 34.34%
[rank0]:2025-11-10 18:23:00,043 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-10 18:23:01,851 - INFO - Avg. fwd time: 15.0960 / Avg. bwd time: 12.7473 / Avg. batch time: 565.1964 (ms) / GPU bubble ratio: 60.59%
[rank1]:2025-11-10 18:23:02,201 - INFO - Avg. fwd time: 16.7905 / Avg. bwd time: 25.1786 / Avg. batch time: 535.6752 (ms) / GPU bubble ratio: 37.32%
[rank3]:2025-11-10 18:23:02,180 - INFO - Avg. fwd time: 14.3303 / Avg. bwd time: 39.5052 / Avg. batch time: 453.8727 (ms) / GPU bubble ratio: 5.11%
[rank2]:2025-11-10 18:23:02,159 - INFO - Avg. fwd time: 14.5425 / Avg. bwd time: 22.2814 / Avg. batch time: 492.4373 (ms) / GPU bubble ratio: 40.18%
[rank1]:2025-11-10 18:23:02,299 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0000  memory: 73.30GiB(52.43%)  tps: 7,281  tflops: 339.61  mfu: 34.34%
[rank3]:2025-11-10 18:23:02,326 - INFO -  step: 700  loss:  0.3987  grad_norm:  0.0931  memory: 83.96GiB(60.05%)  tps: 7,282  tflops: 339.61  mfu: 34.34%
[rank0]:2025-11-10 18:23:02,300 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0000  memory: 72.03GiB(51.52%)  tps: 7,281  tflops: 339.61  mfu: 34.34%
[rank2]:2025-11-10 18:23:02,298 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 7,281  tflops: 339.60  mfu: 34.34%
[rank1]:2025-11-10 18:23:02,381 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/freeze_ratio_history/rank1/251110_1823_stage1_step700.svg
[rank0]:2025-11-10 18:23:02,381 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/freeze_ratio_history/rank0/251110_1823_stage0_step700.svg
[rank2]:2025-11-10 18:23:02,379 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/freeze_ratio_history/rank2/251110_1823_stage2_step700.svg
[rank3]:2025-11-10 18:23:02,478 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/pipeline_schedule/251110_1823_real_step700_rank3.svg
[rank3]:> Batch Time: 537.50 ms, GPU Bubble Ratio: 76.38%, 46.44%, 52.91%, 20.62%
[rank3]:2025-11-10 18:23:02,528 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/freeze_ratio_history/rank3/251110_1823_stage3_step700.svg
[rank0]:2025-11-10 18:24:51,966 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-10 18:24:54,158 - INFO - Avg. fwd time: 14.5993 / Avg. bwd time: 21.8515 / Avg. batch time: 491.8554 (ms) / GPU bubble ratio: 40.71%
[rank1]:2025-11-10 18:24:54,186 - INFO - Avg. fwd time: 16.8536 / Avg. bwd time: 24.6839 / Avg. batch time: 534.5805 (ms) / GPU bubble ratio: 37.84%
[rank0]:2025-11-10 18:24:54,196 - INFO - Avg. fwd time: 15.1427 / Avg. bwd time: 11.8552 / Avg. batch time: 563.2020 (ms) / GPU bubble ratio: 61.65%
[rank0]:2025-11-10 18:24:54,198 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.0000  memory: 72.03GiB(51.52%)  tps: 7,321  tflops: 341.45  mfu: 34.52%
[rank3]:2025-11-10 18:24:54,133 - INFO - Avg. fwd time: 14.3365 / Avg. bwd time: 39.4465 / Avg. batch time: 453.7155 (ms) / GPU bubble ratio: 5.17%
[rank2]:2025-11-10 18:24:54,197 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 7,321  tflops: 341.45  mfu: 34.52%
[rank1]:2025-11-10 18:24:54,197 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.0000  memory: 73.30GiB(52.43%)  tps: 7,321  tflops: 341.45  mfu: 34.52%
[rank3]:2025-11-10 18:24:54,223 - INFO -  step: 750  loss:  0.1495  grad_norm:  0.0575  memory: 83.96GiB(60.05%)  tps: 7,321  tflops: 341.46  mfu: 34.53%
[rank0]:2025-11-10 18:26:42,265 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-10 18:26:44,066 - INFO - Avg. fwd time: 15.1679 / Avg. bwd time: 11.1844 / Avg. batch time: 561.4802 (ms) / GPU bubble ratio: 62.45%
[rank3]:2025-11-10 18:26:44,390 - INFO - Avg. fwd time: 14.3296 / Avg. bwd time: 39.3934 / Avg. batch time: 453.4374 (ms) / GPU bubble ratio: 5.22%
[rank2]:2025-11-10 18:26:44,369 - INFO - Avg. fwd time: 14.6338 / Avg. bwd time: 21.5245 / Avg. batch time: 491.2187 (ms) / GPU bubble ratio: 41.11%
[rank1]:2025-11-10 18:26:44,413 - INFO - Avg. fwd time: 16.8907 / Avg. bwd time: 24.3074 / Avg. batch time: 533.5435 (ms) / GPU bubble ratio: 38.23%
[rank2]:2025-11-10 18:26:44,506 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 7,426  tflops: 346.37  mfu: 35.02%
[rank0]:2025-11-10 18:26:44,508 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0000  memory: 72.03GiB(51.52%)  tps: 7,426  tflops: 346.37  mfu: 35.02%
[rank1]:2025-11-10 18:26:44,508 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0000  memory: 73.30GiB(52.43%)  tps: 7,426  tflops: 346.37  mfu: 35.02%
[rank1]:2025-11-10 18:26:44,586 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/freeze_ratio_history/rank1/251110_1826_stage1_step800.svg
[rank3]:2025-11-10 18:26:44,532 - INFO -  step: 800  loss:  0.2791  grad_norm:  0.0657  memory: 83.96GiB(60.05%)  tps: 7,427  tflops: 346.38  mfu: 35.02%
[rank2]:2025-11-10 18:26:44,584 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/freeze_ratio_history/rank2/251110_1826_stage2_step800.svg
[rank0]:2025-11-10 18:26:44,588 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/freeze_ratio_history/rank0/251110_1826_stage0_step800.svg
[rank3]:2025-11-10 18:26:44,677 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/pipeline_schedule/251110_1826_real_step800_rank3.svg
[rank3]:> Batch Time: 531.50 ms, GPU Bubble Ratio: 76.67%, 46.62%, 52.99%, 20.80%
[rank3]:2025-11-10 18:26:44,730 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/freeze_ratio_history/rank3/251110_1826_stage3_step800.svg
[rank0]:2025-11-10 18:28:33,313 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-10 18:28:35,059 - INFO - Avg. fwd time: 15.2011 / Avg. bwd time: 10.4918 / Avg. batch time: 559.8346 (ms) / GPU bubble ratio: 63.29%
[rank3]:2025-11-10 18:28:35,378 - INFO - Avg. fwd time: 14.3279 / Avg. bwd time: 39.3427 / Avg. batch time: 453.2381 (ms) / GPU bubble ratio: 5.27%
[rank2]:2025-11-10 18:28:35,356 - INFO - Avg. fwd time: 14.6734 / Avg. bwd time: 21.1880 / Avg. batch time: 490.6814 (ms) / GPU bubble ratio: 41.53%
[rank1]:2025-11-10 18:28:35,401 - INFO - Avg. fwd time: 16.9357 / Avg. bwd time: 23.9199 / Avg. batch time: 532.5991 (ms) / GPU bubble ratio: 38.63%
[rank1]:2025-11-10 18:28:35,496 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.0000  memory: 73.30GiB(52.43%)  tps: 7,381  tflops: 344.25  mfu: 34.81%
[rank0]:2025-11-10 18:28:35,496 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.0000  memory: 72.03GiB(51.52%)  tps: 7,381  tflops: 344.25  mfu: 34.81%
[rank3]:2025-11-10 18:28:35,520 - INFO -  step: 850  loss:  0.1395  grad_norm:  0.0484  memory: 83.96GiB(60.05%)  tps: 7,381  tflops: 344.26  mfu: 34.81%
[rank2]:2025-11-10 18:28:35,495 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 7,381  tflops: 344.25  mfu: 34.81%
[rank0]:2025-11-10 18:30:22,203 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-10 18:30:24,375 - INFO - Avg. fwd time: 14.3125 / Avg. bwd time: 39.2822 / Avg. batch time: 452.8531 (ms) / GPU bubble ratio: 5.32%
[rank2]:2025-11-10 18:30:24,402 - INFO - Avg. fwd time: 14.6994 / Avg. bwd time: 20.8866 / Avg. batch time: 489.9615 (ms) / GPU bubble ratio: 41.90%
[rank1]:2025-11-10 18:30:24,431 - INFO - Avg. fwd time: 16.9663 / Avg. bwd time: 23.5727 / Avg. batch time: 531.5068 (ms) / GPU bubble ratio: 38.98%
[rank1]:2025-11-10 18:30:24,445 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0000  memory: 73.30GiB(52.43%)  tps: 7,519  tflops: 350.69  mfu: 35.46%
[rank0]:2025-11-10 18:30:24,444 - INFO - Avg. fwd time: 15.2195 / Avg. bwd time: 9.8799 / Avg. batch time: 558.1185 (ms) / GPU bubble ratio: 64.02%
[rank0]:2025-11-10 18:30:24,447 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0000  memory: 72.03GiB(51.52%)  tps: 7,519  tflops: 350.69  mfu: 35.46%
[rank3]:2025-11-10 18:30:24,471 - INFO -  step: 900  loss:  0.2074  grad_norm:  0.0655  memory: 83.96GiB(60.05%)  tps: 7,519  tflops: 350.70  mfu: 35.46%
[rank2]:2025-11-10 18:30:24,445 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 7,519  tflops: 350.69  mfu: 35.46%
[rank1]:2025-11-10 18:30:24,520 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/freeze_ratio_history/rank1/251110_1830_stage1_step900.svg
[rank0]:2025-11-10 18:30:24,522 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/freeze_ratio_history/rank0/251110_1830_stage0_step900.svg
[rank2]:2025-11-10 18:30:24,520 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/freeze_ratio_history/rank2/251110_1830_stage2_step900.svg
[rank3]:2025-11-10 18:30:24,617 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/pipeline_schedule/251110_1830_real_step900_rank3.svg
[rank3]:> Batch Time: 532.00 ms, GPU Bubble Ratio: 76.53%, 46.58%, 53.01%, 20.82%
[rank3]:2025-11-10 18:30:24,661 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/freeze_ratio_history/rank3/251110_1830_stage3_step900.svg
[rank0]:2025-11-10 18:32:12,729 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-10 18:32:14,514 - INFO - Avg. fwd time: 15.2397 / Avg. bwd time: 9.4096 / Avg. batch time: 556.9858 (ms) / GPU bubble ratio: 64.60%
[rank2]:2025-11-10 18:32:14,819 - INFO - Avg. fwd time: 14.7251 / Avg. bwd time: 20.6568 / Avg. batch time: 489.5869 (ms) / GPU bubble ratio: 42.18%
[rank3]:2025-11-10 18:32:14,838 - INFO - Avg. fwd time: 14.3100 / Avg. bwd time: 39.2473 / Avg. batch time: 452.7070 (ms) / GPU bubble ratio: 5.36%
[rank1]:2025-11-10 18:32:14,863 - INFO - Avg. fwd time: 16.9960 / Avg. bwd time: 23.3084 / Avg. batch time: 530.8517 (ms) / GPU bubble ratio: 39.26%
[rank2]:2025-11-10 18:32:14,957 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 7,413  tflops: 345.73  mfu: 34.96%
[rank0]:2025-11-10 18:32:14,959 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.0000  memory: 72.03GiB(51.52%)  tps: 7,413  tflops: 345.73  mfu: 34.96%
[rank3]:2025-11-10 18:32:14,983 - INFO -  step: 950  loss:  0.2673  grad_norm:  0.0966  memory: 83.96GiB(60.05%)  tps: 7,413  tflops: 345.74  mfu: 34.96%
[rank1]:2025-11-10 18:32:14,958 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.0000  memory: 73.30GiB(52.43%)  tps: 7,413  tflops: 345.73  mfu: 34.96%
[rank0]:2025-11-10 18:34:03,698 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-10 18:34:05,462 - INFO - Avg. fwd time: 15.2647 / Avg. bwd time: 8.9146 / Avg. batch time: 555.8444 (ms) / GPU bubble ratio: 65.20%
[rank2]:2025-11-10 18:34:05,759 - INFO - Avg. fwd time: 14.7558 / Avg. bwd time: 20.4165 / Avg. batch time: 489.2334 (ms) / GPU bubble ratio: 42.49%
[rank1]:2025-11-10 18:34:05,804 - INFO - Avg. fwd time: 17.0303 / Avg. bwd time: 23.0319 / Avg. batch time: 530.2091 (ms) / GPU bubble ratio: 39.55%
[rank3]:2025-11-10 18:34:05,780 - INFO - Avg. fwd time: 14.3116 / Avg. bwd time: 39.2146 / Avg. batch time: 452.6164 (ms) / GPU bubble ratio: 5.39%
[rank0]:2025-11-10 18:34:05,900 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0000  memory: 72.03GiB(51.52%)  tps: 7,384  tflops: 344.40  mfu: 34.82%
[rank0]:2025-11-10 18:34:05,900 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-10 18:34:05,900 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank2]:2025-11-10 18:34:05,898 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 7,384  tflops: 344.40  mfu: 34.82%
[rank2]:2025-11-10 18:34:05,898 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-11-10 18:34:05,898 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0000  memory: 73.30GiB(52.43%)  tps: 7,384  tflops: 344.40  mfu: 34.82%
[rank1]:2025-11-10 18:34:05,898 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-11-10 18:34:05,923 - INFO -  step: 1000  loss:  0.1901  grad_norm:  0.0607  memory: 83.96GiB(60.05%)  tps: 7,384  tflops: 344.41  mfu: 34.82%
[rank3]:2025-11-10 18:34:05,924 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-10 18:34:18,035 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 12.14 seconds.
[rank1]:2025-11-10 18:34:19,166 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 13.27 seconds.
[rank3]:2025-11-10 18:34:19,801 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 13.88 seconds.
[rank0]:2025-11-10 18:34:21,604 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-11-10 18:34:21,612 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 15.71 seconds.
[rank2]:2025-11-10 18:34:21,669 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/freeze_ratio_history/rank2/251110_1834_stage2_step1000.svg
[rank1]:2025-11-10 18:34:21,674 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/freeze_ratio_history/rank1/251110_1834_stage1_step1000.svg
[rank3]:2025-11-10 18:34:21,831 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/pipeline_schedule/251110_1834_real_step1000_rank3.svg
[rank3]:> Batch Time: 535.00 ms, GPU Bubble Ratio: 76.57%, 46.68%, 53.15%, 20.90%
[rank0]:2025-11-10 18:34:21,768 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/freeze_ratio_history/rank0/251110_1834_stage0_step1000.svg
[rank3]:2025-11-10 18:34:21,911 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/freeze_ratio_history/rank3/251110_1834_stage3_step1000.svg
[rank0]:2025-11-10 18:36:13,193 - INFO - [GC] Peforming periodical GC collection 2.17 seconds
[rank2]:2025-11-10 18:36:15,516 - INFO - Avg. fwd time: 14.7781 / Avg. bwd time: 20.1982 / Avg. batch time: 489.0634 (ms) / GPU bubble ratio: 42.79%
[rank3]:2025-11-10 18:36:15,487 - INFO - Avg. fwd time: 14.3052 / Avg. bwd time: 39.1738 / Avg. batch time: 452.6666 (ms) / GPU bubble ratio: 5.49%
[rank0]:2025-11-10 18:36:15,559 - INFO - Avg. fwd time: 15.2855 / Avg. bwd time: 8.4690 / Avg. batch time: 554.9703 (ms) / GPU bubble ratio: 65.76%
[rank0]:2025-11-10 18:36:15,563 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.0000  memory: 72.03GiB(51.52%)  tps: 6,318  tflops: 294.67  mfu: 29.79%
[rank1]:2025-11-10 18:36:15,547 - INFO - Avg. fwd time: 17.0558 / Avg. bwd time: 22.7828 / Avg. batch time: 529.7769 (ms) / GPU bubble ratio: 39.84%
[rank1]:2025-11-10 18:36:15,561 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.0000  memory: 73.30GiB(52.43%)  tps: 6,318  tflops: 294.67  mfu: 29.79%
[rank2]:2025-11-10 18:36:15,561 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 6,318  tflops: 294.67  mfu: 29.79%
[rank3]:2025-11-10 18:36:15,587 - INFO -  step: 1050  loss:  0.2955  grad_norm:  0.0601  memory: 83.96GiB(60.05%)  tps: 6,318  tflops: 294.67  mfu: 29.80%
[rank0]:2025-11-10 18:38:06,518 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-10 18:38:08,303 - INFO - Avg. fwd time: 15.3136 / Avg. bwd time: 8.1211 / Avg. batch time: 554.4009 (ms) / GPU bubble ratio: 66.18%
[rank2]:2025-11-10 18:38:08,605 - INFO - Avg. fwd time: 14.8093 / Avg. bwd time: 20.0332 / Avg. batch time: 489.0247 (ms) / GPU bubble ratio: 43.00%
[rank3]:2025-11-10 18:38:08,624 - INFO - Avg. fwd time: 14.3199 / Avg. bwd time: 39.1621 / Avg. batch time: 452.8004 (ms) / GPU bubble ratio: 5.51%
[rank1]:2025-11-10 18:38:08,647 - INFO - Avg. fwd time: 17.0938 / Avg. bwd time: 22.5933 / Avg. batch time: 529.5504 (ms) / GPU bubble ratio: 40.04%
[rank0]:2025-11-10 18:38:08,741 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0000  memory: 72.03GiB(51.52%)  tps: 7,238  tflops: 337.59  mfu: 34.13%
[rank2]:2025-11-10 18:38:08,740 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 7,238  tflops: 337.59  mfu: 34.13%
[rank1]:2025-11-10 18:38:08,742 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0000  memory: 73.30GiB(52.43%)  tps: 7,238  tflops: 337.58  mfu: 34.13%
[rank0]:2025-11-10 18:38:08,823 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/freeze_ratio_history/rank0/251110_1838_stage0_step1100.svg
[rank2]:2025-11-10 18:38:08,821 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/freeze_ratio_history/rank2/251110_1838_stage2_step1100.svg
[rank3]:2025-11-10 18:38:08,768 - INFO -  step: 1100  loss:  0.2445  grad_norm:  0.0661  memory: 83.96GiB(60.05%)  tps: 7,238  tflops: 337.59  mfu: 34.13%
[rank1]:2025-11-10 18:38:08,822 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/freeze_ratio_history/rank1/251110_1838_stage1_step1100.svg
[rank3]:2025-11-10 18:38:08,918 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/pipeline_schedule/251110_1838_real_step1100_rank3.svg
[rank3]:> Batch Time: 543.50 ms, GPU Bubble Ratio: 76.46%, 46.84%, 53.21%, 20.76%
[rank3]:2025-11-10 18:38:08,963 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/freeze_ratio_history/rank3/251110_1838_stage3_step1100.svg
[rank0]:2025-11-10 18:39:57,506 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-10 18:39:59,252 - INFO - Avg. fwd time: 15.3308 / Avg. bwd time: 7.7497 / Avg. batch time: 553.5614 (ms) / GPU bubble ratio: 66.64%
[rank3]:2025-11-10 18:39:59,585 - INFO - Avg. fwd time: 14.3213 / Avg. bwd time: 39.1410 / Avg. batch time: 452.7373 (ms) / GPU bubble ratio: 5.53%
[rank2]:2025-11-10 18:39:59,564 - INFO - Avg. fwd time: 14.8321 / Avg. bwd time: 19.8536 / Avg. batch time: 488.7836 (ms) / GPU bubble ratio: 43.23%
[rank1]:2025-11-10 18:39:59,606 - INFO - Avg. fwd time: 17.1185 / Avg. bwd time: 22.3860 / Avg. batch time: 529.0909 (ms) / GPU bubble ratio: 40.27%
[rank0]:2025-11-10 18:39:59,704 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0000  memory: 72.03GiB(51.52%)  tps: 7,383  tflops: 344.33  mfu: 34.82%
[rank1]:2025-11-10 18:39:59,703 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0000  memory: 73.30GiB(52.43%)  tps: 7,383  tflops: 344.33  mfu: 34.82%
[rank3]:2025-11-10 18:39:59,730 - INFO -  step: 1150  loss:  0.2280  grad_norm:  0.0604  memory: 83.96GiB(60.05%)  tps: 7,383  tflops: 344.34  mfu: 34.82%
[rank2]:2025-11-10 18:39:59,702 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 7,383  tflops: 344.33  mfu: 34.82%
[rank0]:2025-11-10 18:41:47,812 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-10 18:41:50,057 - INFO - Avg. fwd time: 17.1395 / Avg. bwd time: 22.1960 / Avg. batch time: 528.5937 (ms) / GPU bubble ratio: 40.47%
[rank1]:2025-11-10 18:41:50,071 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0000  memory: 73.30GiB(52.43%)  tps: 7,422  tflops: 346.18  mfu: 35.00%
[rank3]:2025-11-10 18:41:50,001 - INFO - Avg. fwd time: 14.3217 / Avg. bwd time: 39.1158 / Avg. batch time: 452.6197 (ms) / GPU bubble ratio: 5.55%
[rank3]:2025-11-10 18:41:50,096 - INFO -  step: 1200  loss:  0.2962  grad_norm:  0.0619  memory: 83.96GiB(60.05%)  tps: 7,423  tflops: 346.20  mfu: 35.00%
[rank0]:2025-11-10 18:41:50,070 - INFO - Avg. fwd time: 15.3450 / Avg. bwd time: 7.4108 / Avg. batch time: 552.7180 (ms) / GPU bubble ratio: 67.06%
[rank0]:2025-11-10 18:41:50,073 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0000  memory: 72.03GiB(51.52%)  tps: 7,422  tflops: 346.18  mfu: 35.00%
[rank2]:2025-11-10 18:41:50,029 - INFO - Avg. fwd time: 14.8529 / Avg. bwd time: 19.6889 / Avg. batch time: 488.4845 (ms) / GPU bubble ratio: 43.43%
[rank2]:2025-11-10 18:41:50,071 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 7,422  tflops: 346.18  mfu: 35.00%
[rank1]:2025-11-10 18:41:50,145 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/freeze_ratio_history/rank1/251110_1841_stage1_step1200.svg
[rank0]:2025-11-10 18:41:50,148 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/freeze_ratio_history/rank0/251110_1841_stage0_step1200.svg
[rank2]:2025-11-10 18:41:50,148 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/freeze_ratio_history/rank2/251110_1841_stage2_step1200.svg
[rank3]:2025-11-10 18:41:50,232 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/pipeline_schedule/251110_1841_real_step1200_rank3.svg
[rank3]:> Batch Time: 535.00 ms, GPU Bubble Ratio: 76.59%, 46.62%, 52.94%, 20.65%
[rank3]:2025-11-10 18:41:50,275 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/freeze_ratio_history/rank3/251110_1841_stage3_step1200.svg
[rank0]:2025-11-10 18:43:37,454 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-10 18:43:39,196 - INFO - Avg. fwd time: 15.3534 / Avg. bwd time: 7.1431 / Avg. batch time: 551.9805 (ms) / GPU bubble ratio: 67.40%
[rank1]:2025-11-10 18:43:39,554 - INFO - Avg. fwd time: 17.1536 / Avg. bwd time: 22.0458 / Avg. batch time: 528.1415 (ms) / GPU bubble ratio: 40.62%
[rank3]:2025-11-10 18:43:39,530 - INFO - Avg. fwd time: 14.3190 / Avg. bwd time: 39.0905 / Avg. batch time: 452.4601 (ms) / GPU bubble ratio: 5.57%
[rank2]:2025-11-10 18:43:39,509 - INFO - Avg. fwd time: 14.8671 / Avg. bwd time: 19.5587 / Avg. batch time: 488.1932 (ms) / GPU bubble ratio: 43.59%
[rank0]:2025-11-10 18:43:39,648 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.0000  memory: 72.03GiB(51.52%)  tps: 7,476  tflops: 348.69  mfu: 35.26%
[rank1]:2025-11-10 18:43:39,648 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.0000  memory: 73.30GiB(52.43%)  tps: 7,476  tflops: 348.68  mfu: 35.26%
[rank3]:2025-11-10 18:43:39,672 - INFO -  step: 1250  loss:  0.2744  grad_norm:  0.0587  memory: 83.96GiB(60.05%)  tps: 7,476  tflops: 348.69  mfu: 35.26%
[rank2]:2025-11-10 18:43:39,647 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 7,476  tflops: 348.69  mfu: 35.26%
[rank0]:2025-11-10 18:45:27,136 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-10 18:45:28,863 - INFO - Avg. fwd time: 15.3630 / Avg. bwd time: 6.8542 / Avg. batch time: 551.2300 (ms) / GPU bubble ratio: 67.76%
[rank2]:2025-11-10 18:45:29,173 - INFO - Avg. fwd time: 14.8831 / Avg. bwd time: 19.4183 / Avg. batch time: 487.9256 (ms) / GPU bubble ratio: 43.76%
[rank3]:2025-11-10 18:45:29,192 - INFO - Avg. fwd time: 14.3176 / Avg. bwd time: 39.0689 / Avg. batch time: 452.3523 (ms) / GPU bubble ratio: 5.58%
[rank1]:2025-11-10 18:45:29,215 - INFO - Avg. fwd time: 17.1707 / Avg. bwd time: 21.8840 / Avg. batch time: 527.7015 (ms) / GPU bubble ratio: 40.79%
[rank0]:2025-11-10 18:45:29,310 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0000  memory: 72.03GiB(51.52%)  tps: 7,470  tflops: 348.42  mfu: 35.23%
[rank1]:2025-11-10 18:45:29,310 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0000  memory: 73.30GiB(52.43%)  tps: 7,470  tflops: 348.41  mfu: 35.23%
[rank1]:2025-11-10 18:45:29,382 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/freeze_ratio_history/rank1/251110_1845_stage1_step1300.svg
[rank2]:2025-11-10 18:45:29,309 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 7,470  tflops: 348.41  mfu: 35.23%
[rank2]:2025-11-10 18:45:29,384 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/freeze_ratio_history/rank2/251110_1845_stage2_step1300.svg
[rank3]:2025-11-10 18:45:29,334 - INFO -  step: 1300  loss:  0.2188  grad_norm:  0.0744  memory: 83.96GiB(60.05%)  tps: 7,470  tflops: 348.42  mfu: 35.23%
[rank0]:2025-11-10 18:45:29,384 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/freeze_ratio_history/rank0/251110_1845_stage0_step1300.svg
[rank3]:2025-11-10 18:45:29,467 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/pipeline_schedule/251110_1845_real_step1300_rank3.svg
[rank3]:> Batch Time: 529.00 ms, GPU Bubble Ratio: 76.75%, 46.56%, 52.96%, 20.62%
[rank3]:2025-11-10 18:45:29,510 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/freeze_ratio_history/rank3/251110_1845_stage3_step1300.svg
[rank0]:2025-11-10 18:47:17,898 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-10 18:47:20,084 - INFO - Avg. fwd time: 14.9021 / Avg. bwd time: 19.2913 / Avg. batch time: 487.7922 (ms) / GPU bubble ratio: 43.92%
[rank3]:2025-11-10 18:47:20,057 - INFO - Avg. fwd time: 14.3240 / Avg. bwd time: 39.0544 / Avg. batch time: 452.3433 (ms) / GPU bubble ratio: 5.60%
[rank0]:2025-11-10 18:47:20,125 - INFO - Avg. fwd time: 15.3768 / Avg. bwd time: 6.5878 / Avg. batch time: 550.6641 (ms) / GPU bubble ratio: 68.09%
[rank0]:2025-11-10 18:47:20,127 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.0000  memory: 72.03GiB(51.52%)  tps: 7,392  tflops: 344.78  mfu: 34.86%
[rank1]:2025-11-10 18:47:20,113 - INFO - Avg. fwd time: 17.1918 / Avg. bwd time: 21.7377 / Avg. batch time: 527.4189 (ms) / GPU bubble ratio: 40.95%
[rank1]:2025-11-10 18:47:20,126 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.0000  memory: 73.30GiB(52.43%)  tps: 7,392  tflops: 344.78  mfu: 34.86%
[rank2]:2025-11-10 18:47:20,126 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 7,392  tflops: 344.78  mfu: 34.86%
[rank3]:2025-11-10 18:47:20,151 - INFO -  step: 1350  loss:  0.1533  grad_norm:  0.0656  memory: 83.96GiB(60.05%)  tps: 7,392  tflops: 344.79  mfu: 34.86%
[rank0]:2025-11-10 18:49:07,412 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-10 18:49:09,183 - INFO - Avg. fwd time: 15.3816 / Avg. bwd time: 6.3754 / Avg. batch time: 550.0912 (ms) / GPU bubble ratio: 68.36%
[rank1]:2025-11-10 18:49:09,546 - INFO - Avg. fwd time: 17.2025 / Avg. bwd time: 21.6181 / Avg. batch time: 527.0783 (ms) / GPU bubble ratio: 41.08%
[rank2]:2025-11-10 18:49:09,502 - INFO - Avg. fwd time: 14.9123 / Avg. bwd time: 19.1878 / Avg. batch time: 487.5801 (ms) / GPU bubble ratio: 44.05%
[rank3]:2025-11-10 18:49:09,522 - INFO - Avg. fwd time: 14.3210 / Avg. bwd time: 39.0392 / Avg. batch time: 452.2509 (ms) / GPU bubble ratio: 5.61%
[rank0]:2025-11-10 18:49:09,641 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.0000  memory: 72.03GiB(51.52%)  tps: 7,480  tflops: 348.88  mfu: 35.28%
[rank1]:2025-11-10 18:49:09,641 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.0000  memory: 73.30GiB(52.43%)  tps: 7,480  tflops: 348.88  mfu: 35.28%
[rank2]:2025-11-10 18:49:09,640 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 7,480  tflops: 348.88  mfu: 35.28%
[rank3]:2025-11-10 18:49:09,665 - INFO -  step: 1400  loss:  0.3935  grad_norm:  0.0974  memory: 83.96GiB(60.05%)  tps: 7,480  tflops: 348.89  mfu: 35.28%
[rank0]:2025-11-10 18:49:09,717 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/freeze_ratio_history/rank0/251110_1849_stage0_step1400.svg
[rank1]:2025-11-10 18:49:09,716 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/freeze_ratio_history/rank1/251110_1849_stage1_step1400.svg
[rank2]:2025-11-10 18:49:09,717 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/freeze_ratio_history/rank2/251110_1849_stage2_step1400.svg
[rank3]:2025-11-10 18:49:09,798 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/pipeline_schedule/251110_1849_real_step1400_rank3.svg
[rank3]:> Batch Time: 534.00 ms, GPU Bubble Ratio: 76.60%, 46.56%, 52.94%, 20.48%
[rank3]:2025-11-10 18:49:09,843 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/freeze_ratio_history/rank3/251110_1849_stage3_step1400.svg
[rank0]:2025-11-10 18:50:59,025 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-10 18:51:00,752 - INFO - Avg. fwd time: 15.3981 / Avg. bwd time: 6.1443 / Avg. batch time: 549.7065 (ms) / GPU bubble ratio: 68.65%
[rank2]:2025-11-10 18:51:01,063 - INFO - Avg. fwd time: 14.9327 / Avg. bwd time: 19.0789 / Avg. batch time: 487.5669 (ms) / GPU bubble ratio: 44.19%
[rank1]:2025-11-10 18:51:01,110 - INFO - Avg. fwd time: 17.2251 / Avg. bwd time: 21.4921 / Avg. batch time: 526.9374 (ms) / GPU bubble ratio: 41.22%
[rank3]:2025-11-10 18:51:01,084 - INFO - Avg. fwd time: 14.3310 / Avg. bwd time: 39.0341 / Avg. batch time: 452.3425 (ms) / GPU bubble ratio: 5.62%
[rank0]:2025-11-10 18:51:01,200 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.0000  memory: 72.03GiB(51.52%)  tps: 7,343  tflops: 342.49  mfu: 34.63%
[rank1]:2025-11-10 18:51:01,202 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.0000  memory: 73.30GiB(52.43%)  tps: 7,343  tflops: 342.48  mfu: 34.63%
[rank2]:2025-11-10 18:51:01,200 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 7,343  tflops: 342.49  mfu: 34.63%
[rank3]:2025-11-10 18:51:01,225 - INFO -  step: 1450  loss:  0.2049  grad_norm:  0.0447  memory: 83.96GiB(60.05%)  tps: 7,343  tflops: 342.49  mfu: 34.63%
[rank0]:2025-11-10 18:52:50,869 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-10 18:52:53,096 - INFO - Avg. fwd time: 14.3426 / Avg. bwd time: 39.0303 / Avg. batch time: 452.4547 (ms) / GPU bubble ratio: 5.63%
[rank2]:2025-11-10 18:52:53,123 - INFO - Avg. fwd time: 14.9530 / Avg. bwd time: 18.9780 / Avg. batch time: 487.5727 (ms) / GPU bubble ratio: 44.33%
[rank0]:2025-11-10 18:52:53,164 - INFO - Avg. fwd time: 15.4147 / Avg. bwd time: 5.9294 / Avg. batch time: 549.3730 (ms) / GPU bubble ratio: 68.92%
[rank0]:2025-11-10 18:52:53,166 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.0000  memory: 72.03GiB(51.52%)  tps: 7,317  tflops: 341.25  mfu: 34.50%
[rank1]:2025-11-10 18:52:53,152 - INFO - Avg. fwd time: 17.2484 / Avg. bwd time: 21.3759 / Avg. batch time: 526.8285 (ms) / GPU bubble ratio: 41.35%
[rank1]:2025-11-10 18:52:53,165 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.0000  memory: 73.30GiB(52.43%)  tps: 7,317  tflops: 341.25  mfu: 34.50%
[rank3]:2025-11-10 18:52:53,190 - INFO -  step: 1500  loss:  0.3159  grad_norm:  0.0824  memory: 83.96GiB(60.05%)  tps: 7,317  tflops: 341.25  mfu: 34.50%
[rank2]:2025-11-10 18:52:53,165 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 7,317  tflops: 341.25  mfu: 34.50%
[rank2]:2025-11-10 18:52:53,242 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/freeze_ratio_history/rank2/251110_1852_stage2_step1500.svg
[rank0]:2025-11-10 18:52:53,242 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/freeze_ratio_history/rank0/251110_1852_stage0_step1500.svg
[rank1]:2025-11-10 18:52:53,240 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/freeze_ratio_history/rank1/251110_1852_stage1_step1500.svg
[rank3]:2025-11-10 18:52:53,324 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/pipeline_schedule/251110_1852_real_step1500_rank3.svg
[rank3]:> Batch Time: 541.50 ms, GPU Bubble Ratio: 76.49%, 46.61%, 53.06%, 20.40%
[rank3]:2025-11-10 18:52:53,369 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/freeze_ratio_history/rank3/251110_1852_stage3_step1500.svg
[rank0]:2025-11-10 18:54:42,646 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-10 18:54:44,416 - INFO - Avg. fwd time: 15.4285 / Avg. bwd time: 5.7568 / Avg. batch time: 549.0964 (ms) / GPU bubble ratio: 69.13%
[rank2]:2025-11-10 18:54:44,731 - INFO - Avg. fwd time: 14.9698 / Avg. bwd time: 18.8970 / Avg. batch time: 487.5710 (ms) / GPU bubble ratio: 44.43%
[rank1]:2025-11-10 18:54:44,776 - INFO - Avg. fwd time: 17.2674 / Avg. bwd time: 21.2826 / Avg. batch time: 526.7332 (ms) / GPU bubble ratio: 41.45%
[rank3]:2025-11-10 18:54:44,754 - INFO - Avg. fwd time: 14.3524 / Avg. bwd time: 39.0247 / Avg. batch time: 452.5275 (ms) / GPU bubble ratio: 5.64%
[rank1]:2025-11-10 18:54:44,871 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.0000  memory: 73.30GiB(52.43%)  tps: 7,334  tflops: 342.04  mfu: 34.58%
[rank0]:2025-11-10 18:54:44,871 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.0000  memory: 72.03GiB(51.52%)  tps: 7,334  tflops: 342.04  mfu: 34.58%
[rank3]:2025-11-10 18:54:44,895 - INFO -  step: 1550  loss:  0.2997  grad_norm:  0.0886  memory: 83.96GiB(60.05%)  tps: 7,334  tflops: 342.04  mfu: 34.58%
[rank2]:2025-11-10 18:54:44,870 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 7,334  tflops: 342.04  mfu: 34.58%
[rank0]:2025-11-10 18:56:33,572 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-10 18:56:35,359 - INFO - Avg. fwd time: 15.4380 / Avg. bwd time: 5.5677 / Avg. batch time: 548.6841 (ms) / GPU bubble ratio: 69.37%
[rank3]:2025-11-10 18:56:35,698 - INFO - Avg. fwd time: 14.3562 / Avg. bwd time: 39.0152 / Avg. batch time: 452.5282 (ms) / GPU bubble ratio: 5.65%
[rank2]:2025-11-10 18:56:35,677 - INFO - Avg. fwd time: 14.9830 / Avg. bwd time: 18.8067 / Avg. batch time: 487.4701 (ms) / GPU bubble ratio: 44.55%
[rank1]:2025-11-10 18:56:35,721 - INFO - Avg. fwd time: 17.2823 / Avg. bwd time: 21.1785 / Avg. batch time: 526.5240 (ms) / GPU bubble ratio: 41.56%
[rank1]:2025-11-10 18:56:35,815 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.0000  memory: 73.30GiB(52.43%)  tps: 7,384  tflops: 344.39  mfu: 34.82%
[rank0]:2025-11-10 18:56:35,815 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.0000  memory: 72.03GiB(51.52%)  tps: 7,384  tflops: 344.39  mfu: 34.82%
[rank2]:2025-11-10 18:56:35,814 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 7,384  tflops: 344.39  mfu: 34.82%
[rank1]:2025-11-10 18:56:35,893 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/freeze_ratio_history/rank1/251110_1856_stage1_step1600.svg
[rank0]:2025-11-10 18:56:35,891 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/freeze_ratio_history/rank0/251110_1856_stage0_step1600.svg
[rank3]:2025-11-10 18:56:35,839 - INFO -  step: 1600  loss:  0.4003  grad_norm:  0.1187  memory: 83.96GiB(60.05%)  tps: 7,384  tflops: 344.39  mfu: 34.82%
[rank2]:2025-11-10 18:56:35,891 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/freeze_ratio_history/rank2/251110_1856_stage2_step1600.svg
[rank3]:2025-11-10 18:56:35,972 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/pipeline_schedule/251110_1856_real_step1600_rank3.svg
[rank3]:> Batch Time: 540.50 ms, GPU Bubble Ratio: 76.56%, 46.68%, 53.13%, 20.55%
[rank3]:2025-11-10 18:56:36,017 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/freeze_ratio_history/rank3/251110_1856_stage3_step1600.svg
[rank0]:2025-11-10 18:58:25,658 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-10 18:58:27,890 - INFO - Avg. fwd time: 14.3623 / Avg. bwd time: 39.0092 / Avg. batch time: 452.5691 (ms) / GPU bubble ratio: 5.66%
[rank2]:2025-11-10 18:58:27,919 - INFO - Avg. fwd time: 14.9972 / Avg. bwd time: 18.7226 / Avg. batch time: 487.4314 (ms) / GPU bubble ratio: 44.66%
[rank1]:2025-11-10 18:58:27,951 - INFO - Avg. fwd time: 17.2984 / Avg. bwd time: 21.0820 / Avg. batch time: 526.3890 (ms) / GPU bubble ratio: 41.67%
[rank1]:2025-11-10 18:58:27,967 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.0000  memory: 73.30GiB(52.43%)  tps: 7,304  tflops: 340.68  mfu: 34.45%
[rank3]:2025-11-10 18:58:27,993 - INFO -  step: 1650  loss:  0.4319  grad_norm:  0.1280  memory: 83.96GiB(60.05%)  tps: 7,304  tflops: 340.68  mfu: 34.45%
[rank2]:2025-11-10 18:58:27,967 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 7,304  tflops: 340.67  mfu: 34.45%
[rank0]:2025-11-10 18:58:27,966 - INFO - Avg. fwd time: 15.4503 / Avg. bwd time: 5.3907 / Avg. batch time: 548.3717 (ms) / GPU bubble ratio: 69.60%
[rank0]:2025-11-10 18:58:27,968 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.0000  memory: 72.03GiB(51.52%)  tps: 7,304  tflops: 340.67  mfu: 34.45%
[rank0]:2025-11-10 19:00:18,151 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-10 19:00:19,948 - INFO - Avg. fwd time: 15.4609 / Avg. bwd time: 5.2476 / Avg. batch time: 548.1052 (ms) / GPU bubble ratio: 69.77%
[rank1]:2025-11-10 19:00:20,306 - INFO - Avg. fwd time: 17.3117 / Avg. bwd time: 21.0036 / Avg. batch time: 526.2636 (ms) / GPU bubble ratio: 41.75%
[rank3]:2025-11-10 19:00:20,282 - INFO - Avg. fwd time: 14.3676 / Avg. bwd time: 39.0036 / Avg. batch time: 452.5985 (ms) / GPU bubble ratio: 5.66%
[rank2]:2025-11-10 19:00:20,260 - INFO - Avg. fwd time: 15.0091 / Avg. bwd time: 18.6550 / Avg. batch time: 487.3861 (ms) / GPU bubble ratio: 44.74%
[rank1]:2025-11-10 19:00:20,399 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.0000  memory: 73.30GiB(52.43%)  tps: 7,286  tflops: 339.83  mfu: 34.36%
[rank3]:2025-11-10 19:00:20,424 - INFO -  step: 1700  loss:  0.4218  grad_norm:  0.1049  memory: 83.96GiB(60.05%)  tps: 7,286  tflops: 339.84  mfu: 34.36%
[rank2]:2025-11-10 19:00:20,397 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 7,286  tflops: 339.83  mfu: 34.36%
[rank0]:2025-11-10 19:00:20,399 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.0000  memory: 72.03GiB(51.52%)  tps: 7,286  tflops: 339.83  mfu: 34.36%
[rank1]:2025-11-10 19:00:20,478 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/freeze_ratio_history/rank1/251110_1900_stage1_step1700.svg
[rank2]:2025-11-10 19:00:20,475 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/freeze_ratio_history/rank2/251110_1900_stage2_step1700.svg
[rank0]:2025-11-10 19:00:20,479 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/freeze_ratio_history/rank0/251110_1900_stage0_step1700.svg
[rank3]:2025-11-10 19:00:20,562 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/pipeline_schedule/251110_1900_real_step1700_rank3.svg
[rank3]:> Batch Time: 537.50 ms, GPU Bubble Ratio: 76.44%, 46.58%, 52.94%, 20.74%
[rank3]:2025-11-10 19:00:20,609 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/freeze_ratio_history/rank3/251110_1900_stage3_step1700.svg
[rank0]:2025-11-10 19:02:09,991 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-10 19:02:11,777 - INFO - Avg. fwd time: 15.4713 / Avg. bwd time: 5.0901 / Avg. batch time: 547.8084 (ms) / GPU bubble ratio: 69.97%
[rank3]:2025-11-10 19:02:12,117 - INFO - Avg. fwd time: 14.3728 / Avg. bwd time: 38.9967 / Avg. batch time: 452.6203 (ms) / GPU bubble ratio: 5.67%
[rank2]:2025-11-10 19:02:12,094 - INFO - Avg. fwd time: 15.0214 / Avg. bwd time: 18.5803 / Avg. batch time: 487.3375 (ms) / GPU bubble ratio: 44.84%
[rank1]:2025-11-10 19:02:12,142 - INFO - Avg. fwd time: 17.3258 / Avg. bwd time: 20.9176 / Avg. batch time: 526.1272 (ms) / GPU bubble ratio: 41.85%
[rank2]:2025-11-10 19:02:12,232 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 7,325  tflops: 341.65  mfu: 34.54%
[rank0]:2025-11-10 19:02:12,233 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.0000  memory: 72.03GiB(51.52%)  tps: 7,325  tflops: 341.65  mfu: 34.54%
[rank1]:2025-11-10 19:02:12,233 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.0000  memory: 73.30GiB(52.43%)  tps: 7,325  tflops: 341.65  mfu: 34.54%
[rank3]:2025-11-10 19:02:12,257 - INFO -  step: 1750  loss:  0.4457  grad_norm:  0.1027  memory: 83.96GiB(60.05%)  tps: 7,325  tflops: 341.65  mfu: 34.55%
[rank0]:2025-11-10 19:03:59,112 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-10 19:04:01,202 - INFO - Avg. fwd time: 14.3661 / Avg. bwd time: 38.9810 / Avg. batch time: 452.4748 (ms) / GPU bubble ratio: 5.68%
[rank2]:2025-11-10 19:04:01,229 - INFO - Avg. fwd time: 15.0259 / Avg. bwd time: 18.5063 / Avg. batch time: 487.1043 (ms) / GPU bubble ratio: 44.93%
[rank1]:2025-11-10 19:04:01,260 - INFO - Avg. fwd time: 17.3286 / Avg. bwd time: 20.8328 / Avg. batch time: 525.8002 (ms) / GPU bubble ratio: 41.94%
[rank1]:2025-11-10 19:04:01,276 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0000  memory: 73.30GiB(52.43%)  tps: 7,513  tflops: 350.39  mfu: 35.43%
[rank0]:2025-11-10 19:04:01,275 - INFO - Avg. fwd time: 15.4714 / Avg. bwd time: 4.9417 / Avg. batch time: 547.3207 (ms) / GPU bubble ratio: 70.16%
[rank0]:2025-11-10 19:04:01,277 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0000  memory: 72.03GiB(51.52%)  tps: 7,513  tflops: 350.39  mfu: 35.43%
[rank3]:2025-11-10 19:04:01,301 - INFO -  step: 1800  loss:  0.0759  grad_norm:  0.0423  memory: 83.96GiB(60.05%)  tps: 7,513  tflops: 350.39  mfu: 35.43%
[rank2]:2025-11-10 19:04:01,276 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 7,513  tflops: 350.39  mfu: 35.43%
[rank2]:2025-11-10 19:04:01,350 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/freeze_ratio_history/rank2/251110_1904_stage2_step1800.svg
[rank1]:2025-11-10 19:04:01,354 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/freeze_ratio_history/rank1/251110_1904_stage1_step1800.svg
[rank0]:2025-11-10 19:04:01,354 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/freeze_ratio_history/rank0/251110_1904_stage0_step1800.svg
[rank3]:2025-11-10 19:04:01,433 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/pipeline_schedule/251110_1904_real_step1800_rank3.svg
[rank3]:> Batch Time: 522.00 ms, GPU Bubble Ratio: 76.96%, 46.69%, 52.96%, 20.70%
[rank3]:2025-11-10 19:04:01,478 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/freeze_ratio_history/rank3/251110_1904_stage3_step1800.svg
[rank0]:2025-11-10 19:05:47,555 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-10 19:05:49,270 - INFO - Avg. fwd time: 15.4705 / Avg. bwd time: 4.8213 / Avg. batch time: 546.8836 (ms) / GPU bubble ratio: 70.32%
[rank3]:2025-11-10 19:05:49,596 - INFO - Avg. fwd time: 14.3597 / Avg. bwd time: 38.9639 / Avg. batch time: 452.3113 (ms) / GPU bubble ratio: 5.69%
[rank2]:2025-11-10 19:05:49,574 - INFO - Avg. fwd time: 15.0285 / Avg. bwd time: 18.4460 / Avg. batch time: 486.8779 (ms) / GPU bubble ratio: 45.00%
[rank1]:2025-11-10 19:05:49,620 - INFO - Avg. fwd time: 17.3299 / Avg. bwd time: 20.7631 / Avg. batch time: 525.4955 (ms) / GPU bubble ratio: 42.01%
[rank2]:2025-11-10 19:05:49,710 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 7,555  tflops: 352.36  mfu: 35.63%
[rank1]:2025-11-10 19:05:49,711 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.0000  memory: 73.30GiB(52.43%)  tps: 7,555  tflops: 352.36  mfu: 35.63%
[rank0]:2025-11-10 19:05:49,711 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.0000  memory: 72.03GiB(51.52%)  tps: 7,555  tflops: 352.36  mfu: 35.63%
[rank3]:2025-11-10 19:05:49,735 - INFO -  step: 1850  loss:  0.3764  grad_norm:  0.1153  memory: 83.96GiB(60.05%)  tps: 7,555  tflops: 352.36  mfu: 35.63%
[rank0]:2025-11-10 19:07:35,296 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-10 19:07:37,000 - INFO - Avg. fwd time: 15.4666 / Avg. bwd time: 4.6880 / Avg. batch time: 546.3498 (ms) / GPU bubble ratio: 70.49%
[rank2]:2025-11-10 19:07:37,305 - INFO - Avg. fwd time: 15.0289 / Avg. bwd time: 18.3788 / Avg. batch time: 486.5849 (ms) / GPU bubble ratio: 45.07%
[rank1]:2025-11-10 19:07:37,350 - INFO - Avg. fwd time: 17.3287 / Avg. bwd time: 20.6854 / Avg. batch time: 525.1122 (ms) / GPU bubble ratio: 42.09%
[rank3]:2025-11-10 19:07:37,326 - INFO - Avg. fwd time: 14.3493 / Avg. bwd time: 38.9443 / Avg. batch time: 452.1029 (ms) / GPU bubble ratio: 5.70%
[rank2]:2025-11-10 19:07:37,439 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 7,604  tflops: 354.66  mfu: 35.86%
[rank1]:2025-11-10 19:07:37,440 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0000  memory: 73.30GiB(52.43%)  tps: 7,604  tflops: 354.66  mfu: 35.86%
[rank0]:2025-11-10 19:07:37,440 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0000  memory: 72.03GiB(51.52%)  tps: 7,604  tflops: 354.66  mfu: 35.86%
[rank3]:2025-11-10 19:07:37,464 - INFO -  step: 1900  loss:  0.2080  grad_norm:  0.0666  memory: 83.96GiB(60.05%)  tps: 7,604  tflops: 354.67  mfu: 35.86%
[rank2]:2025-11-10 19:07:37,514 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/freeze_ratio_history/rank2/251110_1907_stage2_step1900.svg
[rank1]:2025-11-10 19:07:37,516 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/freeze_ratio_history/rank1/251110_1907_stage1_step1900.svg
[rank0]:2025-11-10 19:07:37,517 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/freeze_ratio_history/rank0/251110_1907_stage0_step1900.svg
[rank3]:2025-11-10 19:07:37,595 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/pipeline_schedule/251110_1907_real_step1900_rank3.svg
[rank3]:> Batch Time: 525.50 ms, GPU Bubble Ratio: 76.81%, 46.56%, 52.89%, 20.68%
[rank3]:2025-11-10 19:07:37,639 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/freeze_ratio_history/rank3/251110_1907_stage3_step1900.svg
[rank0]:2025-11-10 19:09:22,540 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-10 19:09:24,650 - INFO - Avg. fwd time: 14.3372 / Avg. bwd time: 38.9235 / Avg. batch time: 451.8702 (ms) / GPU bubble ratio: 5.71%
[rank2]:2025-11-10 19:09:24,679 - INFO - Avg. fwd time: 15.0282 / Avg. bwd time: 18.3142 / Avg. batch time: 486.2814 (ms) / GPU bubble ratio: 45.15%
[rank1]:2025-11-10 19:09:24,711 - INFO - Avg. fwd time: 17.3257 / Avg. bwd time: 20.6111 / Avg. batch time: 524.7229 (ms) / GPU bubble ratio: 42.16%
[rank1]:2025-11-10 19:09:24,726 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.0000  memory: 73.30GiB(52.43%)  tps: 7,636  tflops: 356.13  mfu: 36.01%
[rank0]:2025-11-10 19:09:24,725 - INFO - Avg. fwd time: 15.4617 / Avg. bwd time: 4.5619 / Avg. batch time: 545.8179 (ms) / GPU bubble ratio: 70.65%
[rank0]:2025-11-10 19:09:24,727 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.0000  memory: 72.03GiB(51.52%)  tps: 7,636  tflops: 356.13  mfu: 36.01%
[rank3]:2025-11-10 19:09:24,751 - INFO -  step: 1950  loss:  0.1755  grad_norm:  0.0657  memory: 83.96GiB(60.05%)  tps: 7,636  tflops: 356.13  mfu: 36.01%
[rank2]:2025-11-10 19:09:24,726 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 7,636  tflops: 356.13  mfu: 36.01%
[rank0]:2025-11-10 19:11:09,776 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-10 19:11:11,492 - INFO - Avg. fwd time: 15.4574 / Avg. bwd time: 4.4590 / Avg. batch time: 545.3761 (ms) / GPU bubble ratio: 70.79%
[rank2]:2025-11-10 19:11:11,797 - INFO - Avg. fwd time: 15.0274 / Avg. bwd time: 18.2618 / Avg. batch time: 486.0278 (ms) / GPU bubble ratio: 45.21%
[rank1]:2025-11-10 19:11:11,841 - INFO - Avg. fwd time: 17.3232 / Avg. bwd time: 20.5509 / Avg. batch time: 524.3985 (ms) / GPU bubble ratio: 42.22%
[rank3]:2025-11-10 19:11:11,818 - INFO - Avg. fwd time: 14.3272 / Avg. bwd time: 38.9069 / Avg. batch time: 451.6835 (ms) / GPU bubble ratio: 5.71%
[rank1]:2025-11-10 19:11:11,932 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.0000  memory: 73.30GiB(52.43%)  tps: 7,641  tflops: 356.40  mfu: 36.04%
[rank1]:2025-11-10 19:11:11,932 - INFO -  final step: 2000  loss: -4.0000  grad_norm:  0.0000  tps: 7,386  tflops: 344.46  mfu: 33.49%
[rank1]:2025-11-10 19:11:11,932 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-11-10 19:11:11,938 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2000.
[rank0]:2025-11-10 19:11:11,932 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.0000  memory: 72.03GiB(51.52%)  tps: 7,641  tflops: 356.40  mfu: 36.04%
[rank0]:2025-11-10 19:11:11,932 - INFO -  final step: 2000  loss: -4.0000  grad_norm:  0.0000  tps: 7,386  tflops: 344.49  mfu: 33.49%
[rank0]:2025-11-10 19:11:11,933 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-10 19:11:11,941 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2000.
[rank3]:2025-11-10 19:11:11,956 - INFO -  step: 2000  loss:  0.2103  grad_norm:  0.0646  memory: 83.96GiB(60.05%)  tps: 7,642  tflops: 356.40  mfu: 36.04%
[rank3]:2025-11-10 19:11:11,957 - INFO -  final step: 2000  loss:  0.2103  grad_norm:  0.0646  tps: 7,389  tflops: 344.63  mfu: 33.50%
[rank3]:2025-11-10 19:11:11,957 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-11-10 19:11:11,961 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2000.
[rank2]:2025-11-10 19:11:11,931 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 7,641  tflops: 356.40  mfu: 36.04%
[rank2]:2025-11-10 19:11:11,931 - INFO -  final step: 2000  loss: -4.0000  grad_norm:  0.0000  tps: 7,383  tflops: 344.35  mfu: 33.49%
[rank2]:2025-11-10 19:11:11,931 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-10 19:11:11,935 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2000.
[rank0]:2025-11-10 19:11:22,529 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank2]:2025-11-10 19:11:22,615 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/freeze_ratio_history/rank2/251110_1911_stage2_final2000.svg
[rank1]:2025-11-10 19:11:22,616 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/freeze_ratio_history/rank1/251110_1911_stage1_final2000.svg
[rank0]:2025-11-10 19:11:22,629 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/freeze_ratio_history/rank0/251110_1911_stage0_final2000.svg
[rank3]:2025-11-10 19:11:22,733 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/pipeline_schedule/251110_1911_real_final2000_rank3.svg
[rank3]:> Batch Time: 535.50 ms, GPU Bubble Ratio: 76.70%, 46.75%, 53.14%, 20.76%
[rank1]:2025-11-10 19:11:22,835 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/frozen_params_histogram/251110_1911_rank1_stage1.svg
[rank1]:	> Counts Sum: 1158640, Total Sum: 4743360 (24.43%), Ratio(%) per element: [24.11, 25.13, 23.49, 25.06, 24.24, 23.83, 24.18, 24.38, 23.63, 24.31, 24.93, 24.79, 24.93, 23.97, 24.31, 24.11, 24.93, 23.9, 24.18, 24.38, 23.97, 25.13, 24.79, 24.04, 25.88, 23.9, 24.72, 24.38, 23.63, 24.18, 23.36, 24.11, 24.38, 24.72, 24.45, 25.13, 23.7, 24.04, 23.9, 24.31, 24.45, 25.47, 24.38, 24.31, 24.65, 24.18, 24.45, 25.27, 24.38, 24.59, 25.34, 23.7, 24.65, 23.83, 24.31, 25.27, 24.65, 24.04, 25.0, 24.11, 25.06, 24.52, 25.13, 24.45, 24.59, 24.04, 25.27, 23.77, 25.0, 23.97, 23.49, 24.59, 24.11, 24.24, 25.81, 23.9, 23.77, 23.49, 25.2, 24.52, 24.72]
[rank1]:2025-11-10 19:11:22,836 - INFO - Destroying the purge thread.
[rank0]:2025-11-10 19:11:22,850 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/frozen_params_histogram/251110_1911_rank0_stage0.svg
[rank0]:	> Counts Sum: 2397440, Total Sum: 4274880 (56.08%), Ratio(%) per element: [52.73, 52.8, 52.59, 51.98, 53.0, 53.07, 52.93, 52.45, 52.39, 52.52, 53.75, 53.0, 53.27, 53.68, 53.14, 54.37, 53.48, 54.16, 54.23, 53.0, 53.82, 54.71, 54.23, 53.82, 54.03, 54.43, 54.5, 54.57, 56.01, 54.64, 54.16, 54.57, 55.32, 55.19, 54.5, 56.01, 56.35, 55.94, 55.6, 56.28, 56.76, 56.01, 55.94, 56.28, 57.17, 55.66, 55.87, 56.96, 57.58, 56.83, 57.37, 57.1, 57.78, 57.78, 57.71, 59.01, 58.33, 58.4, 58.67, 58.53, 59.28, 59.42, 59.22, 59.42, 60.04, 60.45, 60.79, 60.92, 61.2, 61.06, 61.54, 61.81, 61.54]
[rank0]:2025-11-10 19:11:22,850 - INFO - Sleeping 2 seconds for other ranks to complete
[rank2]:2025-11-10 19:11:22,863 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/frozen_params_histogram/251110_1911_rank2_stage2.svg
[rank2]:	> Counts Sum: 1564840, Total Sum: 4216320 (37.11%), Ratio(%) per element: [37.02, 37.56, 36.88, 36.68, 37.7, 36.61, 37.36, 35.72, 35.92, 36.74, 38.79, 36.88, 37.09, 36.33, 37.77, 37.29, 37.9, 36.47, 36.74, 36.88, 37.09, 38.04, 36.06, 36.95, 38.59, 38.04, 37.5, 36.81, 37.29, 37.5, 36.81, 37.77, 37.63, 36.74, 36.68, 37.63, 37.43, 36.54, 37.5, 37.36, 35.72, 37.29, 36.88, 37.56, 38.59, 35.92, 36.33, 37.09, 35.51, 37.43, 36.54, 38.59, 37.09, 36.4, 37.5, 37.29, 39.13, 37.5, 38.59, 37.36, 36.13, 37.02, 36.47, 36.74, 36.74, 37.77, 37.09, 36.68, 36.88, 36.81, 36.88, 36.06]
[rank2]:2025-11-10 19:11:22,863 - INFO - Destroying the purge thread.
[rank3]:2025-11-10 19:11:22,896 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/pipeline_schedule/251110_1911_thry_final2000_rank3.svg
[rank3]:> Batch Time: 517.32 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:2025-11-10 19:11:22,958 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/freeze_ratio_history/rank3/251110_1911_stage3_final2000.svg
[rank3]:2025-11-10 19:11:23,148 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200/frozen_params_histogram/251110_1911_rank3_stage3.svg
[rank3]:	> Counts Sum: 830640, Total Sum: 3806400 (21.82%), Ratio(%) per element: [22.33, 21.92, 21.78, 21.1, 22.06, 22.47, 21.58, 22.74, 21.72, 21.37, 22.88, 22.13, 21.65, 21.65, 21.78, 21.72, 21.44, 21.58, 20.96, 20.83, 21.78, 20.56, 21.85, 21.24, 22.06, 22.13, 21.72, 22.13, 21.85, 22.13, 22.06, 22.19, 21.37, 21.37, 21.92, 22.88, 21.31, 21.99, 22.67, 22.13, 22.06, 21.44, 21.72, 22.74, 21.51, 21.78, 20.76, 21.85, 21.78, 21.37, 21.99, 22.67, 21.85, 21.37, 21.65, 21.51, 21.85, 20.96, 23.08, 22.6, 21.99, 20.83, 22.26, 21.99, 21.44]
[rank3]:2025-11-10 19:11:23,149 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading history steps 39-40, summary, console lines 337-349
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm  â–ˆâ–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–‡â–ˆâ–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–‡â–ˆâ–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 2.21733
[rank3]:wandb:               final/avg_loss 0.21031
[rank3]:wandb:             final/avg_mfu(%) 33.49953
[rank3]:wandb:             final/avg_tflops 344.62696
[rank3]:wandb:    final/avg_throughput(tps) 7389.06035
[rank3]:wandb:              final/grad_norm 0.06455
[rank3]:wandb:               final/max_loss 0.21031
[rank3]:wandb:                    grad_norm 0.06455
[rank3]:wandb: loss_metrics/global_avg_loss 0.21031
[rank3]:wandb: loss_metrics/global_max_loss 0.21031
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1109_GPipe_fullrand7_h200 at: https://wandb.ai/orangingq/torchtitan/runs/e9l9k34m
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: ._data/tb/1109_GPipe_fullrand7_h200/20251110-1755/wandb/run-20251110_175525-e9l9k34m/logs
[rank0]:2025-11-10 19:11:24,850 - INFO - Training completed
[rank0]:2025-11-10 19:11:24,851 - INFO - Destroying the purge thread.
[rank1]:2025-11-10 19:11:25,157 - INFO - Process group destroyed
[rank3]:2025-11-10 19:11:25,153 - INFO - Process group destroyed
[rank2]:2025-11-10 19:11:25,210 - INFO - Process group destroyed
[rank0]:2025-11-10 19:11:25,263 - INFO - Process group destroyed
[rank2]:Stage 2: Modules to keep: {'layers.20', 'layers.22', 'layers.19', 'layers.18', 'layers.17', 'layers.24', 'layers.21', 'layers.23'}
[rank1]:Stage 1: Modules to keep: {'layers.9', 'layers.10', 'layers.12', 'layers.15', 'layers.16', 'layers.14', 'layers.11', 'layers.8', 'layers.13'}
[rank0]:Stage 0: Modules to keep: {'layers.6', 'layers.2', 'layers.7', 'tok_embeddings', 'layers.3', 'layers.4', 'layers.1', 'layers.5', 'layers.0'}
[rank3]:Stage 3: Modules to keep: {'layers.30', 'layers.31', 'layers.26', 'layers.28', 'layers.29', 'layers.25', 'output', 'layers.27', 'norm'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1104_llama8b/config_1109.toml
[rank3]:		- dump_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data
[rank3]:		- description: "Llama 3.1 8B Experiment
[rank3]:1109: 1) resolved timelyapf issue, 2) seed fixed to 42 for all runs, 3) 3000 steps -> 2000 steps (better benchmark scores!)
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1109_GPipe_fullrand7_h200
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/profile_trace/1109_GPipe_fullrand7_h200
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/memory_snapshot/1109_GPipe_fullrand7_h200
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1109_GPipe_fullrand7_h200
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_GPipe_fullrand7_h200
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1109_GPipe_fullrand7_h200
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 8B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.1-8B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 3e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.999
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 200
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: openhermes
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 2000
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 42
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: GPipe
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1109_GPipe_fullrand7_h200
[rank3]:		- interval: 1000
[rank3]:		- initial_load_path: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/comm_traces/1109_GPipe_fullrand7_h200
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 8
[rank3]:		- seq_len: 2048
[rank3]:		- freq: 10
[rank3]:		- steps: -1
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: fullrand7
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.05
[rank3]:		- percentile: 80
[rank3]:
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
