
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: Mon Nov 10 04:21:33 UTC 2025
âœ”ï¸SERVER: wbl-kaist-gpu-2 (172.16.131.118),  GPUs: 0,1,2,3
âœ”ï¸SCRIPT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1104_llama8b/run.sh
âœ”ï¸OUTPUT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1104_llama8b/1109_Interleaved1F1B_nofreeze.log
âœ”ï¸Llama 3.1 8B Experiment
1109: 1) resolved timelyapf issue, 2) seed fixed to 42 for all runs, 3) 3000 steps -> 2000 steps (better benchmark scores!)

âœ”ï¸Running with nofreeze x Interleaved1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1104_llama8b/config_1109.toml --job.description="Llama 3.1 8B Experiment
1109: 1) resolved timelyapf issue, 2) seed fixed to 42 for all runs, 3) 3000 steps -> 2000 steps (better benchmark scores!)
" --parallelism.pipeline_parallel_degree=4  --freezing.no-freeze
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
W1110 04:21:35.228000 2696878 site-packages/torch/distributed/run.py:811] 
W1110 04:21:35.228000 2696878 site-packages/torch/distributed/run.py:811] *****************************************
W1110 04:21:35.228000 2696878 site-packages/torch/distributed/run.py:811] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1110 04:21:35.228000 2696878 site-packages/torch/distributed/run.py:811] *****************************************
[rank1]:2025-11-10 04:21:42,457 - INFO - Starting job: "Llama 3.1 8B Experiment
[rank1]:1109: 1) resolved timelyapf issue, 2) seed fixed to 42 for all runs, 3) 3000 steps -> 2000 steps (better benchmark scores!)
[rank1]:"
[rank3]:2025-11-10 04:21:42,403 - INFO - Starting job: "Llama 3.1 8B Experiment
[rank3]:1109: 1) resolved timelyapf issue, 2) seed fixed to 42 for all runs, 3) 3000 steps -> 2000 steps (better benchmark scores!)
[rank3]:"
[rank2]:2025-11-10 04:21:42,444 - INFO - Starting job: "Llama 3.1 8B Experiment
[rank2]:1109: 1) resolved timelyapf issue, 2) seed fixed to 42 for all runs, 3) 3000 steps -> 2000 steps (better benchmark scores!)
[rank2]:"
[rank0]:2025-11-10 04:21:42,522 - INFO - Starting job: "Llama 3.1 8B Experiment
[rank0]:1109: 1) resolved timelyapf issue, 2) seed fixed to 42 for all runs, 3) 3000 steps -> 2000 steps (better benchmark scores!)
[rank0]:"
[rank1]:2025-11-10 04:21:43,387 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-11-10 04:21:43,389 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-11-10 04:21:43,346 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-11-10 04:21:43,349 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-10 04:21:43,404 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-11-10 04:21:43,406 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-10 04:21:43,412 - INFO - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-11-10 04:21:43,414 - INFO - Loading tokenizer from tokenizer.json
[rank2]:2025-11-10 04:21:43,399 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-11-10 04:21:43,403 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-10 04:21:43,720 - INFO - Preparing openhermes dataset from teknium/OpenHermes-2.5
[rank0]:2025-11-10 04:21:45,657 - INFO - Building llama3 8B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=4096, n_layers=32, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=1024, ffn_dim_multiplier=1.3, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank1]:2025-11-10 04:21:45,759 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank1]:2025-11-10 04:21:45,833 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-11-10 04:21:45,854 - INFO - PP rank 1 is building stage_idx 5 with modules ['layers.21', 'layers.22', 'layers.23', 'layers.24']
[rank1]:2025-11-10 04:21:45,856 - INFO - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank0]:2025-11-10 04:21:45,917 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank0]:2025-11-10 04:21:45,969 - INFO - Model llama3 8B size: 8,030,261,248 total parameters
[rank0]:2025-11-10 04:21:45,993 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank2]:2025-11-10 04:21:45,947 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank0]:2025-11-10 04:21:46,013 - INFO - PP rank 0 is building stage_idx 4 with modules ['layers.17', 'layers.18', 'layers.19', 'layers.20']
[rank0]:2025-11-10 04:21:46,015 - INFO - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank1]:2025-11-10 04:21:46,094 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank1]:2025-11-10 04:21:46,094 - INFO - CUDA memory usage for model: 7.33GiB(5.24%)
[rank2]:2025-11-10 04:21:46,022 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-11-10 04:21:46,043 - INFO - PP rank 2 is building stage_idx 6 with modules ['layers.25', 'layers.26', 'layers.27', 'layers.28']
[rank2]:2025-11-10 04:21:46,044 - INFO - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank0]:2025-11-10 04:21:46,297 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank0]:2025-11-10 04:21:46,298 - INFO - CUDA memory usage for model: 8.46GiB(6.05%)
[rank2]:2025-11-10 04:21:46,308 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank2]:2025-11-10 04:21:46,308 - INFO - CUDA memory usage for model: 6.51GiB(4.65%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run boa5jybc
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1109_Interleaved1F1B_nofreeze_h200/20251110-0421/wandb/run-20251110_042146-boa5jybc
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1109_Interleaved1F1B_nofreeze_h200
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/boa5jybc
[rank3]:2025-11-10 04:21:47,709 - INFO - WandB logging enabled
[rank3]:2025-11-10 04:21:47,710 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank3]:2025-11-10 04:21:47,783 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'layers.16']
[rank3]:2025-11-10 04:21:47,804 - INFO - PP rank 3 is building stage_idx 7 with modules ['layers.29', 'layers.30', 'layers.31', 'norm', 'output']
[rank3]:2025-11-10 04:21:47,805 - INFO - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank0]:2025-11-10 04:21:48,046 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1109_Interleaved1F1B_nofreeze_h200
[rank0]:2025-11-10 04:21:48,046 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-10 04:21:48,046 - INFO - Trainer is initialized with local batch size 16, global batch size 64, gradient accumulation steps 4, sequence length 1024, total steps 2000 (warmup 200)
[rank0]:2025-11-10 04:21:48,046 - INFO - Loading the checkpoint from /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B/original_dcp.
[rank3]:2025-11-10 04:21:48,033 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank3]:2025-11-10 04:21:48,034 - INFO - CUDA memory usage for model: 7.66GiB(5.48%)
[rank3]:2025-11-10 04:21:48,046 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank1]:2025-11-10 04:21:48,054 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank2]:2025-11-10 04:21:48,047 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-10 04:21:58,472 - INFO - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-11-10 04:21:58,473 - INFO - Finished loading the checkpoint in 10.43 seconds.
[rank0]:2025-11-10 04:21:58,473 - INFO - Training starts at step 1
[rank3]:2025-11-10 04:22:02,709 - INFO -  step:  1  loss:  8.2933  grad_norm:     inf  memory: 36.55GiB(26.14%)  tps: 1,096  tflops: 51.12  mfu: 5.17%
[rank3]:2025-11-10 04:22:02,710 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-11-10 04:22:02,705 - INFO -  step:  1  loss: -4.0000  grad_norm:     inf  memory: 30.42GiB(21.76%)  tps: 981  tflops: 45.74  mfu: 4.62%
[rank2]:2025-11-10 04:22:02,705 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-11-10 04:22:02,707 - INFO -  step:  1  loss: -4.0000  grad_norm:     inf  memory: 38.71GiB(27.69%)  tps: 969  tflops: 45.22  mfu: 4.57%
[rank1]:2025-11-10 04:22:02,708 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-10 04:22:02,727 - INFO -  step:  1  loss: -4.0000  grad_norm:     inf  memory: 42.61GiB(30.48%)  tps: 978  tflops: 45.60  mfu: 4.61%
[rank0]:2025-11-10 04:22:02,727 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-10 04:24:12,771 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-10 04:24:15,323 - INFO - Avg. fwd time: 7.5603 / Avg. bwd time: 22.2294 / Avg. batch time: 552.3101 (ms) / GPU bubble ratio: 13.70%
[rank0]:2025-11-10 04:24:15,385 - INFO - Avg. fwd time: 8.2316 / Avg. bwd time: 19.7974 / Avg. batch time: 655.6721 (ms) / GPU bubble ratio: 31.60%
[rank1]:2025-11-10 04:24:15,390 - INFO - Avg. fwd time: 8.0669 / Avg. bwd time: 20.2022 / Avg. batch time: 626.9618 (ms) / GPU bubble ratio: 27.86%
[rank2]:2025-11-10 04:24:15,344 - INFO - Avg. fwd time: 7.8608 / Avg. bwd time: 18.0495 / Avg. batch time: 585.8243 (ms) / GPU bubble ratio: 29.23%
[rank3]:2025-11-10 04:24:15,507 - INFO -  step: 50  loss:  9.4366  grad_norm: 5752.9419  memory: 51.87GiB(37.10%)  tps: 6,045  tflops: 281.96  mfu: 28.51%
[rank0]:2025-11-10 04:24:15,509 - INFO -  step: 50  loss: -4.0000  grad_norm: 5752.9419  memory: 59.59GiB(42.62%)  tps: 6,046  tflops: 281.99  mfu: 28.51%
[rank1]:2025-11-10 04:24:15,505 - INFO -  step: 50  loss: -4.0000  grad_norm: 5752.9419  memory: 53.49GiB(38.26%)  tps: 6,045  tflops: 281.96  mfu: 28.51%
[rank2]:2025-11-10 04:24:15,503 - INFO -  step: 50  loss: -4.0000  grad_norm: 5752.9419  memory: 43.47GiB(31.09%)  tps: 6,045  tflops: 281.96  mfu: 28.51%
[rank0]:2025-11-10 04:26:28,585 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-10 04:26:31,138 - INFO - Avg. fwd time: 7.5631 / Avg. bwd time: 22.2931 / Avg. batch time: 552.8231 (ms) / GPU bubble ratio: 13.59%
[rank0]:2025-11-10 04:26:31,200 - INFO - Avg. fwd time: 8.1949 / Avg. bwd time: 19.8569 / Avg. batch time: 656.0505 (ms) / GPU bubble ratio: 31.59%
[rank2]:2025-11-10 04:26:31,159 - INFO - Avg. fwd time: 7.8505 / Avg. bwd time: 18.0580 / Avg. batch time: 586.0867 (ms) / GPU bubble ratio: 29.27%
[rank1]:2025-11-10 04:26:31,205 - INFO - Avg. fwd time: 8.0583 / Avg. bwd time: 20.2601 / Avg. batch time: 627.2971 (ms) / GPU bubble ratio: 27.77%
[rank3]:2025-11-10 04:26:31,323 - INFO -  step: 100  loss:  4.3128  grad_norm: 291.4406  memory: 51.87GiB(37.10%)  tps: 6,032  tflops: 281.32  mfu: 28.45%
[rank0]:2025-11-10 04:26:31,325 - INFO -  step: 100  loss: -4.0000  grad_norm: 291.4406  memory: 59.59GiB(42.62%)  tps: 6,032  tflops: 281.32  mfu: 28.44%
[rank2]:2025-11-10 04:26:31,319 - INFO -  step: 100  loss: -4.0000  grad_norm: 291.4406  memory: 43.47GiB(31.09%)  tps: 6,032  tflops: 281.32  mfu: 28.44%
[rank1]:2025-11-10 04:26:31,321 - INFO -  step: 100  loss: -4.0000  grad_norm: 291.4406  memory: 53.49GiB(38.26%)  tps: 6,032  tflops: 281.32  mfu: 28.44%
[rank3]:2025-11-10 04:26:31,581 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_Interleaved1F1B_nofreeze_h200/pipeline_schedule/251110_0426_real_step100_rank3.svg
[rank3]:> Batch Time: 657.55 ms, GPU Bubble Ratio: 31.41%, 30.73%, 36.66%, 26.98%
[rank0]:2025-11-10 04:28:44,567 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-10 04:28:47,206 - INFO - Avg. fwd time: 7.5526 / Avg. bwd time: 22.3105 / Avg. batch time: 552.7187 (ms) / GPU bubble ratio: 13.55%
[rank2]:2025-11-10 04:28:47,234 - INFO - Avg. fwd time: 7.8369 / Avg. bwd time: 18.0686 / Avg. batch time: 586.2901 (ms) / GPU bubble ratio: 29.30%
[rank3]:2025-11-10 04:28:47,328 - INFO -  step: 150  loss:  1.9640  grad_norm: 28.7268  memory: 51.87GiB(37.10%)  tps: 6,023  tflops: 280.93  mfu: 28.41%
[rank0]:2025-11-10 04:28:47,295 - INFO - Avg. fwd time: 8.1791 / Avg. bwd time: 19.8784 / Avg. batch time: 656.3411 (ms) / GPU bubble ratio: 31.60%
[rank0]:2025-11-10 04:28:47,331 - INFO -  step: 150  loss: -4.0000  grad_norm: 28.7268  memory: 59.59GiB(42.62%)  tps: 6,023  tflops: 280.93  mfu: 28.41%
[rank2]:2025-11-10 04:28:47,324 - INFO -  step: 150  loss: -4.0000  grad_norm: 28.7268  memory: 43.47GiB(31.09%)  tps: 6,023  tflops: 280.93  mfu: 28.41%
[rank1]:2025-11-10 04:28:47,265 - INFO - Avg. fwd time: 8.0475 / Avg. bwd time: 20.2866 / Avg. batch time: 627.5651 (ms) / GPU bubble ratio: 27.76%
[rank1]:2025-11-10 04:28:47,327 - INFO -  step: 150  loss: -4.0000  grad_norm: 28.7268  memory: 53.49GiB(38.26%)  tps: 6,023  tflops: 280.93  mfu: 28.41%
[rank0]:2025-11-10 04:31:00,197 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-10 04:31:02,737 - INFO - Avg. fwd time: 7.5440 / Avg. bwd time: 22.3167 / Avg. batch time: 552.5718 (ms) / GPU bubble ratio: 13.54%
[rank2]:2025-11-10 04:31:02,758 - INFO - Avg. fwd time: 7.8292 / Avg. bwd time: 18.0784 / Avg. batch time: 586.0599 (ms) / GPU bubble ratio: 29.27%
[rank0]:2025-11-10 04:31:02,800 - INFO - Avg. fwd time: 8.1704 / Avg. bwd time: 19.8897 / Avg. batch time: 656.1360 (ms) / GPU bubble ratio: 31.57%
[rank1]:2025-11-10 04:31:02,804 - INFO - Avg. fwd time: 8.0403 / Avg. bwd time: 20.2990 / Avg. batch time: 627.3599 (ms) / GPU bubble ratio: 27.72%
[rank3]:2025-11-10 04:31:02,921 - INFO -  step: 200  loss:  0.4673  grad_norm: 22.6039  memory: 51.87GiB(37.10%)  tps: 6,042  tflops: 281.78  mfu: 28.49%
[rank0]:2025-11-10 04:31:02,924 - INFO -  step: 200  loss: -4.0000  grad_norm: 22.6039  memory: 59.59GiB(42.62%)  tps: 6,042  tflops: 281.78  mfu: 28.49%
[rank1]:2025-11-10 04:31:02,920 - INFO -  step: 200  loss: -4.0000  grad_norm: 22.6039  memory: 53.49GiB(38.26%)  tps: 6,042  tflops: 281.78  mfu: 28.49%
[rank2]:2025-11-10 04:31:02,917 - INFO -  step: 200  loss: -4.0000  grad_norm: 22.6039  memory: 43.47GiB(31.09%)  tps: 6,042  tflops: 281.78  mfu: 28.49%
[rank3]:2025-11-10 04:31:03,153 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_Interleaved1F1B_nofreeze_h200/pipeline_schedule/251110_0431_real_step200_rank3.svg
[rank3]:> Batch Time: 655.02 ms, GPU Bubble Ratio: 31.23%, 30.65%, 36.53%, 26.99%
[rank0]:2025-11-10 04:33:16,111 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-10 04:33:18,649 - INFO - Avg. fwd time: 7.5392 / Avg. bwd time: 22.3213 / Avg. batch time: 552.5126 (ms) / GPU bubble ratio: 13.53%
[rank2]:2025-11-10 04:33:18,670 - INFO - Avg. fwd time: 7.8269 / Avg. bwd time: 18.0853 / Avg. batch time: 586.1376 (ms) / GPU bubble ratio: 29.27%
[rank0]:2025-11-10 04:33:18,711 - INFO - Avg. fwd time: 8.1652 / Avg. bwd time: 19.8975 / Avg. batch time: 656.2293 (ms) / GPU bubble ratio: 31.58%
[rank1]:2025-11-10 04:33:18,716 - INFO - Avg. fwd time: 8.0383 / Avg. bwd time: 20.3090 / Avg. batch time: 627.4580 (ms) / GPU bubble ratio: 27.72%
[rank0]:2025-11-10 04:33:18,835 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.6344  memory: 59.59GiB(42.62%)  tps: 6,027  tflops: 281.12  mfu: 28.42%
[rank3]:2025-11-10 04:33:18,833 - INFO -  step: 250  loss:  0.2498  grad_norm:  0.6344  memory: 51.87GiB(37.10%)  tps: 6,028  tflops: 281.12  mfu: 28.43%
[rank1]:2025-11-10 04:33:18,831 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.6344  memory: 53.49GiB(38.26%)  tps: 6,027  tflops: 281.12  mfu: 28.42%
[rank2]:2025-11-10 04:33:18,828 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.6344  memory: 43.47GiB(31.09%)  tps: 6,027  tflops: 281.12  mfu: 28.42%
[rank0]:2025-11-10 04:35:31,763 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-10 04:35:34,392 - INFO - Avg. fwd time: 7.5368 / Avg. bwd time: 22.3223 / Avg. batch time: 552.4588 (ms) / GPU bubble ratio: 13.52%
[rank2]:2025-11-10 04:35:34,421 - INFO - Avg. fwd time: 7.8257 / Avg. bwd time: 18.0875 / Avg. batch time: 586.0164 (ms) / GPU bubble ratio: 29.25%
[rank1]:2025-11-10 04:35:34,453 - INFO - Avg. fwd time: 8.0375 / Avg. bwd time: 20.3154 / Avg. batch time: 627.3603 (ms) / GPU bubble ratio: 27.69%
[rank0]:2025-11-10 04:35:34,482 - INFO - Avg. fwd time: 8.1628 / Avg. bwd time: 19.9030 / Avg. batch time: 656.1322 (ms) / GPU bubble ratio: 31.56%
[rank0]:2025-11-10 04:35:34,517 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.4127  memory: 59.59GiB(42.62%)  tps: 6,038  tflops: 281.60  mfu: 28.47%
[rank3]:2025-11-10 04:35:34,515 - INFO -  step: 300  loss:  0.2755  grad_norm:  0.4127  memory: 51.87GiB(37.10%)  tps: 6,038  tflops: 281.60  mfu: 28.47%
[rank2]:2025-11-10 04:35:34,511 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.4127  memory: 43.47GiB(31.09%)  tps: 6,038  tflops: 281.60  mfu: 28.47%
[rank1]:2025-11-10 04:35:34,514 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.4127  memory: 53.49GiB(38.26%)  tps: 6,038  tflops: 281.60  mfu: 28.47%
[rank3]:2025-11-10 04:35:34,749 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_Interleaved1F1B_nofreeze_h200/pipeline_schedule/251110_0435_real_step300_rank3.svg
[rank3]:> Batch Time: 656.08 ms, GPU Bubble Ratio: 31.23%, 30.61%, 36.53%, 27.00%
[rank0]:2025-11-10 04:37:47,762 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-10 04:37:50,320 - INFO - Avg. fwd time: 7.5361 / Avg. bwd time: 22.3232 / Avg. batch time: 552.4489 (ms) / GPU bubble ratio: 13.52%
[rank0]:2025-11-10 04:37:50,383 - INFO - Avg. fwd time: 8.1621 / Avg. bwd time: 19.9068 / Avg. batch time: 656.2450 (ms) / GPU bubble ratio: 31.56%
[rank2]:2025-11-10 04:37:50,341 - INFO - Avg. fwd time: 7.8255 / Avg. bwd time: 18.0886 / Avg. batch time: 586.1104 (ms) / GPU bubble ratio: 29.26%
[rank1]:2025-11-10 04:37:50,387 - INFO - Avg. fwd time: 8.0375 / Avg. bwd time: 20.3192 / Avg. batch time: 627.4724 (ms) / GPU bubble ratio: 27.69%
[rank3]:2025-11-10 04:37:50,504 - INFO -  step: 350  loss:  0.3242  grad_norm:  0.4757  memory: 51.87GiB(37.10%)  tps: 6,024  tflops: 280.96  mfu: 28.41%
[rank0]:2025-11-10 04:37:50,506 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.4757  memory: 59.59GiB(42.62%)  tps: 6,024  tflops: 280.96  mfu: 28.41%
[rank2]:2025-11-10 04:37:50,499 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.4757  memory: 43.47GiB(31.09%)  tps: 6,024  tflops: 280.96  mfu: 28.41%
[rank1]:2025-11-10 04:37:50,502 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.4757  memory: 53.49GiB(38.26%)  tps: 6,024  tflops: 280.96  mfu: 28.41%
[rank0]:2025-11-10 04:40:03,518 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-10 04:40:06,087 - INFO - Avg. fwd time: 7.5361 / Avg. bwd time: 22.3247 / Avg. batch time: 552.4600 (ms) / GPU bubble ratio: 13.52%
[rank2]:2025-11-10 04:40:06,107 - INFO - Avg. fwd time: 7.8270 / Avg. bwd time: 18.0908 / Avg. batch time: 586.0616 (ms) / GPU bubble ratio: 29.24%
[rank0]:2025-11-10 04:40:06,149 - INFO - Avg. fwd time: 8.1620 / Avg. bwd time: 19.9110 / Avg. batch time: 656.2127 (ms) / GPU bubble ratio: 31.55%
[rank1]:2025-11-10 04:40:06,153 - INFO - Avg. fwd time: 8.0387 / Avg. bwd time: 20.3237 / Avg. batch time: 627.4365 (ms) / GPU bubble ratio: 27.67%
[rank0]:2025-11-10 04:40:06,271 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.3760  memory: 59.59GiB(42.62%)  tps: 6,034  tflops: 281.42  mfu: 28.46%
[rank3]:2025-11-10 04:40:06,269 - INFO -  step: 400  loss:  0.2591  grad_norm:  0.3760  memory: 51.87GiB(37.10%)  tps: 6,034  tflops: 281.43  mfu: 28.46%
[rank1]:2025-11-10 04:40:06,268 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.3760  memory: 53.49GiB(38.26%)  tps: 6,034  tflops: 281.42  mfu: 28.46%
[rank2]:2025-11-10 04:40:06,265 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.3760  memory: 43.47GiB(31.09%)  tps: 6,034  tflops: 281.42  mfu: 28.46%
[rank3]:2025-11-10 04:40:06,507 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_Interleaved1F1B_nofreeze_h200/pipeline_schedule/251110_0440_real_step400_rank3.svg
[rank3]:> Batch Time: 656.06 ms, GPU Bubble Ratio: 31.26%, 30.66%, 36.59%, 27.06%
[rank0]:2025-11-10 04:42:19,545 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-10 04:42:22,175 - INFO - Avg. fwd time: 7.5364 / Avg. bwd time: 22.3264 / Avg. batch time: 552.4939 (ms) / GPU bubble ratio: 13.52%
[rank2]:2025-11-10 04:42:22,204 - INFO - Avg. fwd time: 7.8283 / Avg. bwd time: 18.0923 / Avg. batch time: 586.1689 (ms) / GPU bubble ratio: 29.25%
[rank0]:2025-11-10 04:42:22,268 - INFO - Avg. fwd time: 8.1621 / Avg. bwd time: 19.9146 / Avg. batch time: 656.3370 (ms) / GPU bubble ratio: 31.56%
[rank0]:2025-11-10 04:42:22,303 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.3200  memory: 59.59GiB(42.62%)  tps: 6,022  tflops: 280.87  mfu: 28.40%
[rank3]:2025-11-10 04:42:22,301 - INFO -  step: 450  loss:  0.2778  grad_norm:  0.3200  memory: 51.87GiB(37.10%)  tps: 6,022  tflops: 280.88  mfu: 28.40%
[rank1]:2025-11-10 04:42:22,237 - INFO - Avg. fwd time: 8.0400 / Avg. bwd time: 20.3271 / Avg. batch time: 627.5561 (ms) / GPU bubble ratio: 27.68%
[rank1]:2025-11-10 04:42:22,299 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.3200  memory: 53.49GiB(38.26%)  tps: 6,022  tflops: 280.87  mfu: 28.40%
[rank2]:2025-11-10 04:42:22,297 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.3200  memory: 43.47GiB(31.09%)  tps: 6,022  tflops: 280.87  mfu: 28.40%
[rank0]:2025-11-10 04:44:35,282 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-10 04:44:37,836 - INFO - Avg. fwd time: 7.5357 / Avg. bwd time: 22.3271 / Avg. batch time: 552.4876 (ms) / GPU bubble ratio: 13.52%
[rank0]:2025-11-10 04:44:37,899 - INFO - Avg. fwd time: 8.1617 / Avg. bwd time: 19.9174 / Avg. batch time: 656.2926 (ms) / GPU bubble ratio: 31.54%
[rank1]:2025-11-10 04:44:37,904 - INFO - Avg. fwd time: 8.0407 / Avg. bwd time: 20.3302 / Avg. batch time: 627.5137 (ms) / GPU bubble ratio: 27.66%
[rank2]:2025-11-10 04:44:37,857 - INFO - Avg. fwd time: 7.8282 / Avg. bwd time: 18.0929 / Avg. batch time: 586.1227 (ms) / GPU bubble ratio: 29.24%
[rank1]:2025-11-10 04:44:38,017 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.3841  memory: 53.49GiB(38.26%)  tps: 6,036  tflops: 281.52  mfu: 28.47%
[rank2]:2025-11-10 04:44:38,014 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.3841  memory: 43.47GiB(31.09%)  tps: 6,036  tflops: 281.52  mfu: 28.47%
[rank3]:2025-11-10 04:44:38,019 - INFO -  step: 500  loss:  0.2719  grad_norm:  0.3841  memory: 51.87GiB(37.10%)  tps: 6,036  tflops: 281.52  mfu: 28.47%
[rank0]:2025-11-10 04:44:38,021 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.3841  memory: 59.59GiB(42.62%)  tps: 6,036  tflops: 281.52  mfu: 28.47%
[rank3]:2025-11-10 04:44:38,257 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_Interleaved1F1B_nofreeze_h200/pipeline_schedule/251110_0444_real_step500_rank3.svg
[rank3]:> Batch Time: 655.58 ms, GPU Bubble Ratio: 31.23%, 30.56%, 36.59%, 27.07%
[rank0]:2025-11-10 04:46:50,878 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-10 04:46:53,415 - INFO - Avg. fwd time: 7.5346 / Avg. bwd time: 22.3261 / Avg. batch time: 552.4484 (ms) / GPU bubble ratio: 13.52%
[rank2]:2025-11-10 04:46:53,435 - INFO - Avg. fwd time: 7.8281 / Avg. bwd time: 18.0924 / Avg. batch time: 586.1410 (ms) / GPU bubble ratio: 29.24%
[rank0]:2025-11-10 04:46:53,477 - INFO - Avg. fwd time: 8.1612 / Avg. bwd time: 19.9191 / Avg. batch time: 656.3158 (ms) / GPU bubble ratio: 31.54%
[rank1]:2025-11-10 04:46:53,482 - INFO - Avg. fwd time: 8.0409 / Avg. bwd time: 20.3318 / Avg. batch time: 627.5387 (ms) / GPU bubble ratio: 27.66%
[rank0]:2025-11-10 04:46:53,599 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.3084  memory: 59.59GiB(42.62%)  tps: 6,042  tflops: 281.81  mfu: 28.49%
[rank3]:2025-11-10 04:46:53,597 - INFO -  step: 550  loss:  0.1626  grad_norm:  0.3084  memory: 51.87GiB(37.10%)  tps: 6,042  tflops: 281.82  mfu: 28.50%
[rank1]:2025-11-10 04:46:53,595 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.3084  memory: 53.49GiB(38.26%)  tps: 6,042  tflops: 281.81  mfu: 28.49%
[rank2]:2025-11-10 04:46:53,592 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.3084  memory: 43.47GiB(31.09%)  tps: 6,042  tflops: 281.81  mfu: 28.49%
[rank0]:2025-11-10 04:49:07,402 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-10 04:49:10,092 - INFO - Avg. fwd time: 7.5402 / Avg. bwd time: 22.3345 / Avg. batch time: 552.7064 (ms) / GPU bubble ratio: 13.52%
[rank1]:2025-11-10 04:49:10,155 - INFO - Avg. fwd time: 8.0463 / Avg. bwd time: 20.3380 / Avg. batch time: 627.7681 (ms) / GPU bubble ratio: 27.66%
[rank2]:2025-11-10 04:49:10,122 - INFO - Avg. fwd time: 7.8338 / Avg. bwd time: 18.0973 / Avg. batch time: 586.3565 (ms) / GPU bubble ratio: 29.24%
[rank3]:2025-11-10 04:49:10,221 - INFO -  step: 600  loss:  0.4052  grad_norm:  0.7410  memory: 51.87GiB(37.10%)  tps: 5,996  tflops: 279.66  mfu: 28.28%
[rank0]:2025-11-10 04:49:10,188 - INFO - Avg. fwd time: 8.1652 / Avg. bwd time: 19.9241 / Avg. batch time: 656.5548 (ms) / GPU bubble ratio: 31.55%
[rank0]:2025-11-10 04:49:10,224 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.7410  memory: 59.59GiB(42.62%)  tps: 5,996  tflops: 279.65  mfu: 28.28%
[rank2]:2025-11-10 04:49:10,217 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.7410  memory: 43.47GiB(31.09%)  tps: 5,996  tflops: 279.65  mfu: 28.28%
[rank1]:2025-11-10 04:49:10,220 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.7410  memory: 53.49GiB(38.26%)  tps: 5,996  tflops: 279.65  mfu: 28.28%
[rank3]:2025-11-10 04:49:10,457 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_Interleaved1F1B_nofreeze_h200/pipeline_schedule/251110_0449_real_step600_rank3.svg
[rank3]:> Batch Time: 662.12 ms, GPU Bubble Ratio: 31.42%, 30.69%, 36.61%, 26.91%
[rank0]:2025-11-10 04:51:25,383 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-10 04:51:27,958 - INFO - Avg. fwd time: 7.5502 / Avg. bwd time: 22.3485 / Avg. batch time: 553.1592 (ms) / GPU bubble ratio: 13.52%
[rank0]:2025-11-10 04:51:28,021 - INFO - Avg. fwd time: 8.1726 / Avg. bwd time: 19.9311 / Avg. batch time: 657.0840 (ms) / GPU bubble ratio: 31.57%
[rank2]:2025-11-10 04:51:27,979 - INFO - Avg. fwd time: 7.8428 / Avg. bwd time: 18.1038 / Avg. batch time: 586.8477 (ms) / GPU bubble ratio: 29.26%
[rank1]:2025-11-10 04:51:28,025 - INFO - Avg. fwd time: 8.0555 / Avg. bwd time: 20.3470 / Avg. batch time: 628.2805 (ms) / GPU bubble ratio: 27.67%
[rank3]:2025-11-10 04:51:28,140 - INFO -  step: 650  loss:  0.2675  grad_norm:  0.5678  memory: 51.87GiB(37.10%)  tps: 5,940  tflops: 277.03  mfu: 28.01%
[rank0]:2025-11-10 04:51:28,142 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.5678  memory: 59.59GiB(42.62%)  tps: 5,940  tflops: 277.03  mfu: 28.01%
[rank1]:2025-11-10 04:51:28,138 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.5678  memory: 53.49GiB(38.26%)  tps: 5,940  tflops: 277.03  mfu: 28.01%
[rank2]:2025-11-10 04:51:28,136 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.5678  memory: 43.47GiB(31.09%)  tps: 5,940  tflops: 277.03  mfu: 28.01%
[rank0]:2025-11-10 04:53:43,311 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-10 04:53:45,921 - INFO - Avg. fwd time: 7.5598 / Avg. bwd time: 22.3628 / Avg. batch time: 553.5991 (ms) / GPU bubble ratio: 13.52%
[rank2]:2025-11-10 04:53:45,942 - INFO - Avg. fwd time: 7.8511 / Avg. bwd time: 18.1098 / Avg. batch time: 587.2347 (ms) / GPU bubble ratio: 29.27%
[rank1]:2025-11-10 04:53:45,988 - INFO - Avg. fwd time: 8.0643 / Avg. bwd time: 20.3559 / Avg. batch time: 628.6902 (ms) / GPU bubble ratio: 27.67%
[rank0]:2025-11-10 04:53:45,984 - INFO - Avg. fwd time: 8.1796 / Avg. bwd time: 19.9379 / Avg. batch time: 657.5133 (ms) / GPU bubble ratio: 31.58%
[rank0]:2025-11-10 04:53:46,105 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.5965  memory: 59.59GiB(42.62%)  tps: 5,938  tflops: 276.94  mfu: 28.00%
[rank3]:2025-11-10 04:53:46,102 - INFO -  step: 700  loss:  0.3477  grad_norm:  0.5965  memory: 51.87GiB(37.10%)  tps: 5,938  tflops: 276.94  mfu: 28.00%
[rank2]:2025-11-10 04:53:46,098 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.5965  memory: 43.47GiB(31.09%)  tps: 5,938  tflops: 276.94  mfu: 28.00%
[rank1]:2025-11-10 04:53:46,101 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.5965  memory: 53.49GiB(38.26%)  tps: 5,938  tflops: 276.94  mfu: 28.00%
[rank3]:2025-11-10 04:53:46,346 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_Interleaved1F1B_nofreeze_h200/pipeline_schedule/251110_0453_real_step700_rank3.svg
[rank3]:> Batch Time: 665.14 ms, GPU Bubble Ratio: 31.62%, 30.80%, 36.90%, 26.90%
[rank0]:2025-11-10 04:56:01,240 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-10 04:56:03,898 - INFO - Avg. fwd time: 7.5682 / Avg. bwd time: 22.3797 / Avg. batch time: 554.0472 (ms) / GPU bubble ratio: 13.52%
[rank2]:2025-11-10 04:56:03,929 - INFO - Avg. fwd time: 7.8572 / Avg. bwd time: 18.1126 / Avg. batch time: 587.6762 (ms) / GPU bubble ratio: 29.29%
[rank1]:2025-11-10 04:56:03,963 - INFO - Avg. fwd time: 8.0719 / Avg. bwd time: 20.3685 / Avg. batch time: 629.1717 (ms) / GPU bubble ratio: 27.68%
[rank3]:2025-11-10 04:56:04,029 - INFO -  step: 750  loss:  0.1445  grad_norm:  0.4089  memory: 51.87GiB(37.10%)  tps: 5,939  tflops: 277.02  mfu: 28.01%
[rank0]:2025-11-10 04:56:03,995 - INFO - Avg. fwd time: 8.1848 / Avg. bwd time: 19.9423 / Avg. batch time: 658.0057 (ms) / GPU bubble ratio: 31.61%
[rank0]:2025-11-10 04:56:04,031 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.4089  memory: 59.59GiB(42.62%)  tps: 5,939  tflops: 277.02  mfu: 28.01%
[rank1]:2025-11-10 04:56:04,027 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.4089  memory: 53.49GiB(38.26%)  tps: 5,939  tflops: 277.02  mfu: 28.01%
[rank2]:2025-11-10 04:56:04,024 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.4089  memory: 43.47GiB(31.09%)  tps: 5,939  tflops: 277.02  mfu: 28.01%
[rank0]:2025-11-10 04:58:17,834 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-10 04:58:20,446 - INFO - Avg. fwd time: 7.5704 / Avg. bwd time: 22.3872 / Avg. batch time: 554.2061 (ms) / GPU bubble ratio: 13.51%
[rank2]:2025-11-10 04:58:20,468 - INFO - Avg. fwd time: 7.8582 / Avg. bwd time: 18.1121 / Avg. batch time: 587.7752 (ms) / GPU bubble ratio: 29.31%
[rank1]:2025-11-10 04:58:20,513 - INFO - Avg. fwd time: 8.0740 / Avg. bwd time: 20.3766 / Avg. batch time: 629.2988 (ms) / GPU bubble ratio: 27.66%
[rank0]:2025-11-10 04:58:20,510 - INFO - Avg. fwd time: 8.1857 / Avg. bwd time: 19.9436 / Avg. batch time: 658.1306 (ms) / GPU bubble ratio: 31.61%
[rank0]:2025-11-10 04:58:20,630 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.5734  memory: 59.59GiB(42.62%)  tps: 5,997  tflops: 279.71  mfu: 28.28%
[rank3]:2025-11-10 04:58:20,628 - INFO -  step: 800  loss:  0.2627  grad_norm:  0.5734  memory: 51.87GiB(37.10%)  tps: 5,997  tflops: 279.71  mfu: 28.28%
[rank2]:2025-11-10 04:58:20,623 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.5734  memory: 43.47GiB(31.09%)  tps: 5,997  tflops: 279.71  mfu: 28.28%
[rank1]:2025-11-10 04:58:20,626 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.5734  memory: 53.49GiB(38.26%)  tps: 5,997  tflops: 279.71  mfu: 28.28%
[rank3]:2025-11-10 04:58:20,860 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_Interleaved1F1B_nofreeze_h200/pipeline_schedule/251110_0458_real_step800_rank3.svg
[rank3]:> Batch Time: 659.58 ms, GPU Bubble Ratio: 31.52%, 30.58%, 36.95%, 26.97%
[rank0]:2025-11-10 05:00:35,033 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-10 05:00:37,598 - INFO - Avg. fwd time: 7.5750 / Avg. bwd time: 22.3975 / Avg. batch time: 554.4665 (ms) / GPU bubble ratio: 13.51%
[rank2]:2025-11-10 05:00:37,620 - INFO - Avg. fwd time: 7.8613 / Avg. bwd time: 18.1122 / Avg. batch time: 588.0292 (ms) / GPU bubble ratio: 29.33%
[rank0]:2025-11-10 05:00:37,661 - INFO - Avg. fwd time: 8.1878 / Avg. bwd time: 19.9451 / Avg. batch time: 658.4210 (ms) / GPU bubble ratio: 31.64%
[rank1]:2025-11-10 05:00:37,664 - INFO - Avg. fwd time: 8.0786 / Avg. bwd time: 20.3860 / Avg. batch time: 629.5872 (ms) / GPU bubble ratio: 27.66%
[rank0]:2025-11-10 05:00:37,780 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.3715  memory: 59.59GiB(42.62%)  tps: 5,973  tflops: 278.58  mfu: 28.17%
[rank3]:2025-11-10 05:00:37,778 - INFO -  step: 850  loss:  0.1193  grad_norm:  0.3715  memory: 51.87GiB(37.10%)  tps: 5,973  tflops: 278.59  mfu: 28.17%
[rank1]:2025-11-10 05:00:37,776 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.3715  memory: 53.49GiB(38.26%)  tps: 5,973  tflops: 278.58  mfu: 28.17%
[rank2]:2025-11-10 05:00:37,773 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.3715  memory: 43.47GiB(31.09%)  tps: 5,973  tflops: 278.58  mfu: 28.17%
[rank0]:2025-11-10 05:02:50,463 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-10 05:02:53,122 - INFO - Avg. fwd time: 7.5736 / Avg. bwd time: 22.3992 / Avg. batch time: 554.4556 (ms) / GPU bubble ratio: 13.51%
[rank2]:2025-11-10 05:02:53,154 - INFO - Avg. fwd time: 7.8596 / Avg. bwd time: 18.1097 / Avg. batch time: 587.9670 (ms) / GPU bubble ratio: 29.33%
[rank0]:2025-11-10 05:02:53,224 - INFO - Avg. fwd time: 8.1856 / Avg. bwd time: 19.9439 / Avg. batch time: 658.3774 (ms) / GPU bubble ratio: 31.64%
[rank1]:2025-11-10 05:02:53,190 - INFO - Avg. fwd time: 8.0779 / Avg. bwd time: 20.3913 / Avg. batch time: 629.5503 (ms) / GPU bubble ratio: 27.65%
[rank1]:2025-11-10 05:02:53,255 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.4222  memory: 53.49GiB(38.26%)  tps: 6,047  tflops: 282.02  mfu: 28.52%
[rank2]:2025-11-10 05:02:53,253 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.4222  memory: 43.47GiB(31.09%)  tps: 6,047  tflops: 282.02  mfu: 28.52%
[rank0]:2025-11-10 05:02:53,259 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.4222  memory: 59.59GiB(42.62%)  tps: 6,047  tflops: 282.02  mfu: 28.52%
[rank3]:2025-11-10 05:02:53,257 - INFO -  step: 900  loss:  0.1840  grad_norm:  0.4222  memory: 51.87GiB(37.10%)  tps: 6,047  tflops: 282.02  mfu: 28.52%
[rank3]:2025-11-10 05:02:53,495 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_Interleaved1F1B_nofreeze_h200/pipeline_schedule/251110_0502_real_step900_rank3.svg
[rank3]:> Batch Time: 658.56 ms, GPU Bubble Ratio: 31.42%, 30.33%, 36.70%, 26.76%
[rank0]:2025-11-10 05:05:07,225 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-10 05:05:09,813 - INFO - Avg. fwd time: 7.5755 / Avg. bwd time: 22.4046 / Avg. batch time: 554.5784 (ms) / GPU bubble ratio: 13.51%
[rank2]:2025-11-10 05:05:09,834 - INFO - Avg. fwd time: 7.8606 / Avg. bwd time: 18.1093 / Avg. batch time: 588.0982 (ms) / GPU bubble ratio: 29.35%
[rank1]:2025-11-10 05:05:09,880 - INFO - Avg. fwd time: 8.0799 / Avg. bwd time: 20.3974 / Avg. batch time: 629.7043 (ms) / GPU bubble ratio: 27.64%
[rank0]:2025-11-10 05:05:09,876 - INFO - Avg. fwd time: 8.1859 / Avg. bwd time: 19.9444 / Avg. batch time: 658.5278 (ms) / GPU bubble ratio: 31.65%
[rank0]:2025-11-10 05:05:09,996 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.7492  memory: 59.59GiB(42.62%)  tps: 5,991  tflops: 279.43  mfu: 28.25%
[rank3]:2025-11-10 05:05:09,994 - INFO -  step: 950  loss:  0.2454  grad_norm:  0.7492  memory: 51.87GiB(37.10%)  tps: 5,991  tflops: 279.43  mfu: 28.25%
[rank2]:2025-11-10 05:05:09,989 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.7492  memory: 43.47GiB(31.09%)  tps: 5,991  tflops: 279.43  mfu: 28.25%
[rank1]:2025-11-10 05:05:09,992 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.7492  memory: 53.49GiB(38.26%)  tps: 5,991  tflops: 279.42  mfu: 28.25%
[rank0]:2025-11-10 05:07:23,985 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-10 05:07:26,538 - INFO - Avg. fwd time: 7.5787 / Avg. bwd time: 22.4108 / Avg. batch time: 554.7452 (ms) / GPU bubble ratio: 13.50%
[rank2]:2025-11-10 05:07:26,558 - INFO - Avg. fwd time: 7.8632 / Avg. bwd time: 18.1114 / Avg. batch time: 588.2255 (ms) / GPU bubble ratio: 29.35%
[rank0]:2025-11-10 05:07:26,600 - INFO - Avg. fwd time: 8.1877 / Avg. bwd time: 19.9461 / Avg. batch time: 658.6723 (ms) / GPU bubble ratio: 31.66%
[rank1]:2025-11-10 05:07:26,605 - INFO - Avg. fwd time: 8.0830 / Avg. bwd time: 20.4026 / Avg. batch time: 629.8481 (ms) / GPU bubble ratio: 27.64%
[rank3]:2025-11-10 05:07:26,718 - INFO -  step: 1000  loss:  0.1518  grad_norm:  0.3437  memory: 51.87GiB(37.10%)  tps: 5,992  tflops: 279.45  mfu: 28.26%
[rank3]:2025-11-10 05:07:26,718 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-10 05:07:26,720 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.3437  memory: 59.59GiB(42.62%)  tps: 5,992  tflops: 279.45  mfu: 28.26%
[rank0]:2025-11-10 05:07:26,720 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-10 05:07:26,720 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank2]:2025-11-10 05:07:26,713 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.3437  memory: 43.47GiB(31.09%)  tps: 5,992  tflops: 279.45  mfu: 28.26%
[rank2]:2025-11-10 05:07:26,714 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-11-10 05:07:26,716 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.3437  memory: 53.49GiB(38.26%)  tps: 5,992  tflops: 279.45  mfu: 28.26%
[rank1]:2025-11-10 05:07:26,716 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-10 05:07:38,108 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 11.39 seconds.
[rank3]:2025-11-10 05:07:39,269 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 12.55 seconds.
[rank1]:2025-11-10 05:07:39,936 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 13.22 seconds.
[rank0]:2025-11-10 05:07:42,811 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-11-10 05:07:42,817 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 16.10 seconds.
[rank3]:2025-11-10 05:07:43,166 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_Interleaved1F1B_nofreeze_h200/pipeline_schedule/251110_0507_real_step1000_rank3.svg
[rank3]:> Batch Time: 660.11 ms, GPU Bubble Ratio: 31.49%, 30.64%, 36.76%, 27.00%
[rank0]:2025-11-10 05:09:58,973 - INFO - [GC] Peforming periodical GC collection 2.46 seconds
[rank3]:2025-11-10 05:10:01,656 - INFO - Avg. fwd time: 7.5770 / Avg. bwd time: 22.4143 / Avg. batch time: 554.7651 (ms) / GPU bubble ratio: 13.50%
[rank2]:2025-11-10 05:10:01,691 - INFO - Avg. fwd time: 7.8623 / Avg. bwd time: 18.1114 / Avg. batch time: 588.3014 (ms) / GPU bubble ratio: 29.36%
[rank1]:2025-11-10 05:10:01,731 - INFO - Avg. fwd time: 8.0813 / Avg. bwd time: 20.3995 / Avg. batch time: 629.9147 (ms) / GPU bubble ratio: 27.66%
[rank0]:2025-11-10 05:10:01,768 - INFO - Avg. fwd time: 8.1870 / Avg. bwd time: 19.9457 / Avg. batch time: 658.7400 (ms) / GPU bubble ratio: 31.67%
[rank0]:2025-11-10 05:10:01,804 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.8329  memory: 59.59GiB(42.62%)  tps: 5,282  tflops: 246.37  mfu: 24.91%
[rank3]:2025-11-10 05:10:01,802 - INFO -  step: 1050  loss:  0.2487  grad_norm:  0.8329  memory: 51.88GiB(37.11%)  tps: 5,282  tflops: 246.37  mfu: 24.91%
[rank2]:2025-11-10 05:10:01,798 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.8329  memory: 43.47GiB(31.09%)  tps: 5,282  tflops: 246.37  mfu: 24.91%
[rank1]:2025-11-10 05:10:01,800 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.8329  memory: 53.49GiB(38.26%)  tps: 5,282  tflops: 246.37  mfu: 24.91%
[rank0]:2025-11-10 05:12:17,145 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-10 05:12:19,715 - INFO - Avg. fwd time: 7.5830 / Avg. bwd time: 22.4211 / Avg. batch time: 555.0113 (ms) / GPU bubble ratio: 13.50%
[rank2]:2025-11-10 05:12:19,738 - INFO - Avg. fwd time: 7.8678 / Avg. bwd time: 18.1160 / Avg. batch time: 588.5300 (ms) / GPU bubble ratio: 29.36%
[rank0]:2025-11-10 05:12:19,778 - INFO - Avg. fwd time: 8.1916 / Avg. bwd time: 19.9493 / Avg. batch time: 658.9824 (ms) / GPU bubble ratio: 31.67%
[rank1]:2025-11-10 05:12:19,782 - INFO - Avg. fwd time: 8.0864 / Avg. bwd time: 20.4028 / Avg. batch time: 630.1468 (ms) / GPU bubble ratio: 27.66%
[rank3]:2025-11-10 05:12:19,894 - INFO -  step: 1100  loss:  0.2207  grad_norm:  0.3663  memory: 51.88GiB(37.11%)  tps: 5,932  tflops: 276.69  mfu: 27.98%
[rank0]:2025-11-10 05:12:19,896 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.3663  memory: 59.59GiB(42.62%)  tps: 5,932  tflops: 276.68  mfu: 27.98%
[rank2]:2025-11-10 05:12:19,890 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.3663  memory: 43.47GiB(31.09%)  tps: 5,932  tflops: 276.68  mfu: 27.98%
[rank1]:2025-11-10 05:12:19,892 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.3663  memory: 53.49GiB(38.26%)  tps: 5,932  tflops: 276.68  mfu: 27.98%
[rank3]:2025-11-10 05:12:20,129 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_Interleaved1F1B_nofreeze_h200/pipeline_schedule/251110_0512_real_step1100_rank3.svg
[rank3]:> Batch Time: 666.64 ms, GPU Bubble Ratio: 31.66%, 30.93%, 36.76%, 26.91%
[rank0]:2025-11-10 05:14:33,862 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-10 05:14:36,429 - INFO - Avg. fwd time: 7.5840 / Avg. bwd time: 22.4215 / Avg. batch time: 555.0400 (ms) / GPU bubble ratio: 13.50%
[rank2]:2025-11-10 05:14:36,448 - INFO - Avg. fwd time: 7.8691 / Avg. bwd time: 18.1175 / Avg. batch time: 588.5870 (ms) / GPU bubble ratio: 29.36%
[rank0]:2025-11-10 05:14:36,490 - INFO - Avg. fwd time: 8.1925 / Avg. bwd time: 19.9502 / Avg. batch time: 659.0360 (ms) / GPU bubble ratio: 31.68%
[rank1]:2025-11-10 05:14:36,494 - INFO - Avg. fwd time: 8.0874 / Avg. bwd time: 20.4027 / Avg. batch time: 630.1988 (ms) / GPU bubble ratio: 27.67%
[rank0]:2025-11-10 05:14:36,608 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.5281  memory: 59.59GiB(42.62%)  tps: 5,992  tflops: 279.48  mfu: 28.26%
[rank3]:2025-11-10 05:14:36,605 - INFO -  step: 1150  loss:  0.2105  grad_norm:  0.5281  memory: 51.88GiB(37.11%)  tps: 5,992  tflops: 279.48  mfu: 28.26%
[rank2]:2025-11-10 05:14:36,601 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.5281  memory: 43.47GiB(31.09%)  tps: 5,992  tflops: 279.48  mfu: 28.26%
[rank1]:2025-11-10 05:14:36,604 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.5281  memory: 53.49GiB(38.26%)  tps: 5,992  tflops: 279.48  mfu: 28.26%
[rank0]:2025-11-10 05:16:50,193 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-10 05:16:52,867 - INFO - Avg. fwd time: 7.5844 / Avg. bwd time: 22.4211 / Avg. batch time: 555.0435 (ms) / GPU bubble ratio: 13.50%
[rank2]:2025-11-10 05:16:52,900 - INFO - Avg. fwd time: 7.8698 / Avg. bwd time: 18.1180 / Avg. batch time: 588.5717 (ms) / GPU bubble ratio: 29.35%
[rank1]:2025-11-10 05:16:52,938 - INFO - Avg. fwd time: 8.0878 / Avg. bwd time: 20.4021 / Avg. batch time: 630.1820 (ms) / GPU bubble ratio: 27.67%
[rank3]:2025-11-10 05:16:53,009 - INFO -  step: 1200  loss:  0.2635  grad_norm:  0.4515  memory: 51.88GiB(37.11%)  tps: 6,006  tflops: 280.11  mfu: 28.32%
[rank0]:2025-11-10 05:16:52,976 - INFO - Avg. fwd time: 8.1931 / Avg. bwd time: 19.9505 / Avg. batch time: 659.0220 (ms) / GPU bubble ratio: 31.67%
[rank0]:2025-11-10 05:16:53,011 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.4515  memory: 59.59GiB(42.62%)  tps: 6,006  tflops: 280.11  mfu: 28.32%
[rank2]:2025-11-10 05:16:53,005 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.4515  memory: 43.47GiB(31.09%)  tps: 6,006  tflops: 280.11  mfu: 28.32%
[rank1]:2025-11-10 05:16:53,007 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.4515  memory: 53.49GiB(38.26%)  tps: 6,006  tflops: 280.11  mfu: 28.32%
[rank3]:2025-11-10 05:16:53,249 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_Interleaved1F1B_nofreeze_h200/pipeline_schedule/251110_0516_real_step1200_rank3.svg
[rank3]:> Batch Time: 660.08 ms, GPU Bubble Ratio: 31.41%, 30.71%, 36.69%, 26.89%
[rank0]:2025-11-10 05:19:06,486 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-10 05:19:09,080 - INFO - Avg. fwd time: 7.8697 / Avg. bwd time: 18.1180 / Avg. batch time: 588.5611 (ms) / GPU bubble ratio: 29.35%
[rank3]:2025-11-10 05:19:09,060 - INFO - Avg. fwd time: 7.5838 / Avg. bwd time: 22.4196 / Avg. batch time: 555.0061 (ms) / GPU bubble ratio: 13.50%
[rank0]:2025-11-10 05:19:09,123 - INFO - Avg. fwd time: 8.1929 / Avg. bwd time: 19.9506 / Avg. batch time: 659.0088 (ms) / GPU bubble ratio: 31.67%
[rank1]:2025-11-10 05:19:09,127 - INFO - Avg. fwd time: 8.0873 / Avg. bwd time: 20.4010 / Avg. batch time: 630.1680 (ms) / GPU bubble ratio: 27.67%
[rank3]:2025-11-10 05:19:09,238 - INFO -  step: 1250  loss:  0.2508  grad_norm:  0.5172  memory: 51.88GiB(37.11%)  tps: 6,013  tflops: 280.47  mfu: 28.36%
[rank0]:2025-11-10 05:19:09,240 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.5172  memory: 59.59GiB(42.62%)  tps: 6,013  tflops: 280.47  mfu: 28.36%
[rank1]:2025-11-10 05:19:09,236 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.5172  memory: 53.49GiB(38.26%)  tps: 6,013  tflops: 280.47  mfu: 28.36%
[rank2]:2025-11-10 05:19:09,234 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.5172  memory: 43.47GiB(31.09%)  tps: 6,013  tflops: 280.47  mfu: 28.36%
[rank0]:2025-11-10 05:21:22,756 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-10 05:21:25,312 - INFO - Avg. fwd time: 7.5840 / Avg. bwd time: 22.4190 / Avg. batch time: 555.0041 (ms) / GPU bubble ratio: 13.51%
[rank2]:2025-11-10 05:21:25,334 - INFO - Avg. fwd time: 7.8703 / Avg. bwd time: 18.1185 / Avg. batch time: 588.5430 (ms) / GPU bubble ratio: 29.35%
[rank1]:2025-11-10 05:21:25,380 - INFO - Avg. fwd time: 8.0878 / Avg. bwd time: 20.4005 / Avg. batch time: 630.1458 (ms) / GPU bubble ratio: 27.67%
[rank0]:2025-11-10 05:21:25,375 - INFO - Avg. fwd time: 8.1934 / Avg. bwd time: 19.9512 / Avg. batch time: 658.9884 (ms) / GPU bubble ratio: 31.67%
[rank2]:2025-11-10 05:21:25,486 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.3657  memory: 43.47GiB(31.09%)  tps: 6,012  tflops: 280.42  mfu: 28.35%
[rank1]:2025-11-10 05:21:25,488 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.3657  memory: 53.49GiB(38.26%)  tps: 6,012  tflops: 280.42  mfu: 28.35%
[rank3]:2025-11-10 05:21:25,490 - INFO -  step: 1300  loss:  0.1795  grad_norm:  0.3657  memory: 51.88GiB(37.11%)  tps: 6,012  tflops: 280.42  mfu: 28.35%
[rank0]:2025-11-10 05:21:25,492 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.3657  memory: 59.59GiB(42.62%)  tps: 6,012  tflops: 280.42  mfu: 28.35%
[rank3]:2025-11-10 05:21:25,726 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_Interleaved1F1B_nofreeze_h200/pipeline_schedule/251110_0521_real_step1300_rank3.svg
[rank3]:> Batch Time: 654.53 ms, GPU Bubble Ratio: 31.17%, 30.52%, 36.51%, 26.95%
[rank0]:2025-11-10 05:23:40,234 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-10 05:23:42,920 - INFO - Avg. fwd time: 7.8731 / Avg. bwd time: 18.1211 / Avg. batch time: 588.6689 (ms) / GPU bubble ratio: 29.35%
[rank3]:2025-11-10 05:23:42,884 - INFO - Avg. fwd time: 7.5866 / Avg. bwd time: 22.4218 / Avg. batch time: 555.1072 (ms) / GPU bubble ratio: 13.51%
[rank1]:2025-11-10 05:23:42,959 - INFO - Avg. fwd time: 8.0901 / Avg. bwd time: 20.4021 / Avg. batch time: 630.2732 (ms) / GPU bubble ratio: 27.67%
[rank1]:2025-11-10 05:23:43,027 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.4919  memory: 53.49GiB(38.26%)  tps: 5,956  tflops: 277.80  mfu: 28.09%
[rank2]:2025-11-10 05:23:43,025 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.4919  memory: 43.47GiB(31.09%)  tps: 5,956  tflops: 277.80  mfu: 28.09%
[rank0]:2025-11-10 05:23:42,996 - INFO - Avg. fwd time: 8.1956 / Avg. bwd time: 19.9530 / Avg. batch time: 659.1232 (ms) / GPU bubble ratio: 31.67%
[rank0]:2025-11-10 05:23:43,031 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.4919  memory: 59.59GiB(42.62%)  tps: 5,956  tflops: 277.80  mfu: 28.09%
[rank3]:2025-11-10 05:23:43,029 - INFO -  step: 1350  loss:  0.1239  grad_norm:  0.4919  memory: 51.88GiB(37.11%)  tps: 5,956  tflops: 277.80  mfu: 28.09%
[rank0]:2025-11-10 05:25:56,358 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-10 05:25:58,965 - INFO - Avg. fwd time: 7.5858 / Avg. bwd time: 22.4202 / Avg. batch time: 555.0646 (ms) / GPU bubble ratio: 13.51%
[rank1]:2025-11-10 05:25:59,033 - INFO - Avg. fwd time: 8.0896 / Avg. bwd time: 20.4012 / Avg. batch time: 630.2140 (ms) / GPU bubble ratio: 27.67%
[rank2]:2025-11-10 05:25:58,986 - INFO - Avg. fwd time: 7.8728 / Avg. bwd time: 18.1211 / Avg. batch time: 588.6146 (ms) / GPU bubble ratio: 29.34%
[rank0]:2025-11-10 05:25:59,028 - INFO - Avg. fwd time: 8.1952 / Avg. bwd time: 19.9529 / Avg. batch time: 659.0628 (ms) / GPU bubble ratio: 31.67%
[rank1]:2025-11-10 05:25:59,141 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.4974  memory: 53.49GiB(38.26%)  tps: 6,018  tflops: 280.70  mfu: 28.38%
[rank2]:2025-11-10 05:25:59,138 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.4974  memory: 43.47GiB(31.09%)  tps: 6,019  tflops: 280.70  mfu: 28.38%
[rank3]:2025-11-10 05:25:59,143 - INFO -  step: 1400  loss:  0.3592  grad_norm:  0.4974  memory: 51.88GiB(37.11%)  tps: 6,019  tflops: 280.71  mfu: 28.38%
[rank0]:2025-11-10 05:25:59,145 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.4974  memory: 59.59GiB(42.62%)  tps: 6,019  tflops: 280.70  mfu: 28.38%
[rank3]:2025-11-10 05:25:59,377 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_Interleaved1F1B_nofreeze_h200/pipeline_schedule/251110_0525_real_step1400_rank3.svg
[rank3]:> Batch Time: 658.56 ms, GPU Bubble Ratio: 31.32%, 30.62%, 36.56%, 26.94%
[rank0]:2025-11-10 05:28:14,495 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-10 05:28:17,057 - INFO - Avg. fwd time: 7.5900 / Avg. bwd time: 22.4254 / Avg. batch time: 555.2441 (ms) / GPU bubble ratio: 13.51%
[rank1]:2025-11-10 05:28:17,125 - INFO - Avg. fwd time: 8.0934 / Avg. bwd time: 20.4040 / Avg. batch time: 630.4130 (ms) / GPU bubble ratio: 27.67%
[rank2]:2025-11-10 05:28:17,078 - INFO - Avg. fwd time: 7.8766 / Avg. bwd time: 18.1241 / Avg. batch time: 588.8105 (ms) / GPU bubble ratio: 29.35%
[rank0]:2025-11-10 05:28:17,120 - INFO - Avg. fwd time: 8.1984 / Avg. bwd time: 19.9555 / Avg. batch time: 659.2677 (ms) / GPU bubble ratio: 31.67%
[rank1]:2025-11-10 05:28:17,233 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.3981  memory: 53.49GiB(38.26%)  tps: 5,932  tflops: 276.68  mfu: 27.98%
[rank2]:2025-11-10 05:28:17,230 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.3981  memory: 43.47GiB(31.09%)  tps: 5,932  tflops: 276.68  mfu: 27.98%
[rank3]:2025-11-10 05:28:17,234 - INFO -  step: 1450  loss:  0.1861  grad_norm:  0.3981  memory: 51.88GiB(37.11%)  tps: 5,932  tflops: 276.69  mfu: 27.98%
[rank0]:2025-11-10 05:28:17,237 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.3981  memory: 59.59GiB(42.62%)  tps: 5,932  tflops: 276.68  mfu: 27.98%
[rank0]:2025-11-10 05:30:32,776 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-10 05:30:35,485 - INFO - Avg. fwd time: 7.5948 / Avg. bwd time: 22.4315 / Avg. batch time: 555.4492 (ms) / GPU bubble ratio: 13.51%
[rank2]:2025-11-10 05:30:35,520 - INFO - Avg. fwd time: 7.8808 / Avg. bwd time: 18.1274 / Avg. batch time: 588.9988 (ms) / GPU bubble ratio: 29.35%
[rank1]:2025-11-10 05:30:35,560 - INFO - Avg. fwd time: 8.0976 / Avg. bwd time: 20.4070 / Avg. batch time: 630.6063 (ms) / GPU bubble ratio: 27.68%
[rank0]:2025-11-10 05:30:35,598 - INFO - Avg. fwd time: 8.2018 / Avg. bwd time: 19.9582 / Avg. batch time: 659.4690 (ms) / GPU bubble ratio: 31.68%
[rank2]:2025-11-10 05:30:35,627 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.5610  memory: 43.47GiB(31.09%)  tps: 5,919  tflops: 276.07  mfu: 27.91%
[rank1]:2025-11-10 05:30:35,630 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.5610  memory: 53.49GiB(38.26%)  tps: 5,919  tflops: 276.07  mfu: 27.91%
[rank3]:2025-11-10 05:30:35,631 - INFO -  step: 1500  loss:  0.2554  grad_norm:  0.5610  memory: 51.88GiB(37.11%)  tps: 5,919  tflops: 276.07  mfu: 27.91%
[rank0]:2025-11-10 05:30:35,634 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.5610  memory: 59.59GiB(42.62%)  tps: 5,919  tflops: 276.07  mfu: 27.91%
[rank3]:2025-11-10 05:30:35,869 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_Interleaved1F1B_nofreeze_h200/pipeline_schedule/251110_0530_real_step1500_rank3.svg
[rank3]:> Batch Time: 665.12 ms, GPU Bubble Ratio: 31.55%, 30.70%, 36.65%, 26.84%
[rank0]:2025-11-10 05:32:51,288 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-10 05:32:53,892 - INFO - Avg. fwd time: 7.5989 / Avg. bwd time: 22.4364 / Avg. batch time: 555.6212 (ms) / GPU bubble ratio: 13.51%
[rank2]:2025-11-10 05:32:53,912 - INFO - Avg. fwd time: 7.8844 / Avg. bwd time: 18.1303 / Avg. batch time: 589.1889 (ms) / GPU bubble ratio: 29.35%
[rank1]:2025-11-10 05:32:53,960 - INFO - Avg. fwd time: 8.1012 / Avg. bwd time: 20.4095 / Avg. batch time: 630.7997 (ms) / GPU bubble ratio: 27.68%
[rank0]:2025-11-10 05:32:53,958 - INFO - Avg. fwd time: 8.2048 / Avg. bwd time: 19.9605 / Avg. batch time: 659.6678 (ms) / GPU bubble ratio: 31.69%
[rank2]:2025-11-10 05:32:54,064 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.5074  memory: 43.47GiB(31.09%)  tps: 5,917  tflops: 275.99  mfu: 27.91%
[rank1]:2025-11-10 05:32:54,067 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.5074  memory: 53.49GiB(38.26%)  tps: 5,917  tflops: 275.99  mfu: 27.91%
[rank0]:2025-11-10 05:32:54,071 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.5074  memory: 59.59GiB(42.62%)  tps: 5,917  tflops: 275.99  mfu: 27.91%
[rank3]:2025-11-10 05:32:54,069 - INFO -  step: 1550  loss:  0.2665  grad_norm:  0.5074  memory: 51.88GiB(37.11%)  tps: 5,918  tflops: 275.99  mfu: 27.91%
[rank0]:2025-11-10 05:35:08,762 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-10 05:35:11,397 - INFO - Avg. fwd time: 7.8862 / Avg. bwd time: 18.1320 / Avg. batch time: 589.2511 (ms) / GPU bubble ratio: 29.35%
[rank3]:2025-11-10 05:35:11,377 - INFO - Avg. fwd time: 7.6008 / Avg. bwd time: 22.4386 / Avg. batch time: 555.6987 (ms) / GPU bubble ratio: 13.51%
[rank1]:2025-11-10 05:35:11,445 - INFO - Avg. fwd time: 8.1030 / Avg. bwd time: 20.4106 / Avg. batch time: 630.8615 (ms) / GPU bubble ratio: 27.68%
[rank0]:2025-11-10 05:35:11,440 - INFO - Avg. fwd time: 8.2063 / Avg. bwd time: 19.9618 / Avg. batch time: 659.7325 (ms) / GPU bubble ratio: 31.69%
[rank1]:2025-11-10 05:35:11,551 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.8325  memory: 53.49GiB(38.26%)  tps: 5,959  tflops: 277.91  mfu: 28.10%
[rank2]:2025-11-10 05:35:11,548 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.8325  memory: 43.47GiB(31.09%)  tps: 5,959  tflops: 277.91  mfu: 28.10%
[rank3]:2025-11-10 05:35:11,553 - INFO -  step: 1600  loss:  0.4007  grad_norm:  0.8325  memory: 51.88GiB(37.11%)  tps: 5,959  tflops: 277.91  mfu: 28.10%
[rank0]:2025-11-10 05:35:11,555 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.8325  memory: 59.59GiB(42.62%)  tps: 5,959  tflops: 277.91  mfu: 28.10%
[rank3]:2025-11-10 05:35:11,789 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_Interleaved1F1B_nofreeze_h200/pipeline_schedule/251110_0535_real_step1600_rank3.svg
[rank3]:> Batch Time: 664.61 ms, GPU Bubble Ratio: 31.62%, 30.83%, 36.74%, 26.96%
[rank0]:2025-11-10 05:37:26,894 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-10 05:37:29,592 - INFO - Avg. fwd time: 7.6037 / Avg. bwd time: 22.4422 / Avg. batch time: 555.8220 (ms) / GPU bubble ratio: 13.51%
[rank2]:2025-11-10 05:37:29,628 - INFO - Avg. fwd time: 7.8888 / Avg. bwd time: 18.1341 / Avg. batch time: 589.3907 (ms) / GPU bubble ratio: 29.36%
[rank1]:2025-11-10 05:37:29,671 - INFO - Avg. fwd time: 8.1056 / Avg. bwd time: 20.4122 / Avg. batch time: 631.0035 (ms) / GPU bubble ratio: 27.69%
[rank3]:2025-11-10 05:37:29,744 - INFO -  step: 1650  loss:  0.4305  grad_norm:  0.8548  memory: 51.88GiB(37.11%)  tps: 5,928  tflops: 276.49  mfu: 27.96%
[rank0]:2025-11-10 05:37:29,711 - INFO - Avg. fwd time: 8.2084 / Avg. bwd time: 19.9634 / Avg. batch time: 659.8802 (ms) / GPU bubble ratio: 31.69%
[rank0]:2025-11-10 05:37:29,746 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.8548  memory: 59.59GiB(42.62%)  tps: 5,928  tflops: 276.48  mfu: 27.96%
[rank2]:2025-11-10 05:37:29,740 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.8548  memory: 43.47GiB(31.09%)  tps: 5,928  tflops: 276.48  mfu: 27.96%
[rank1]:2025-11-10 05:37:29,742 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.8548  memory: 53.49GiB(38.26%)  tps: 5,928  tflops: 276.48  mfu: 27.96%
[rank0]:2025-11-10 05:39:45,139 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-10 05:39:47,749 - INFO - Avg. fwd time: 7.6062 / Avg. bwd time: 22.4454 / Avg. batch time: 555.9317 (ms) / GPU bubble ratio: 13.51%
[rank1]:2025-11-10 05:39:47,817 - INFO - Avg. fwd time: 8.1080 / Avg. bwd time: 20.4137 / Avg. batch time: 631.1000 (ms) / GPU bubble ratio: 27.69%
[rank2]:2025-11-10 05:39:47,771 - INFO - Avg. fwd time: 7.8911 / Avg. bwd time: 18.1357 / Avg. batch time: 589.4861 (ms) / GPU bubble ratio: 29.36%
[rank0]:2025-11-10 05:39:47,815 - INFO - Avg. fwd time: 8.2102 / Avg. bwd time: 19.9648 / Avg. batch time: 659.9806 (ms) / GPU bubble ratio: 31.69%
[rank1]:2025-11-10 05:39:47,923 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.6265  memory: 53.49GiB(38.26%)  tps: 5,928  tflops: 276.50  mfu: 27.96%
[rank2]:2025-11-10 05:39:47,920 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.6265  memory: 43.47GiB(31.09%)  tps: 5,928  tflops: 276.50  mfu: 27.96%
[rank3]:2025-11-10 05:39:47,925 - INFO -  step: 1700  loss:  0.4017  grad_norm:  0.6265  memory: 51.88GiB(37.11%)  tps: 5,929  tflops: 276.51  mfu: 27.96%
[rank0]:2025-11-10 05:39:47,927 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.6265  memory: 59.59GiB(42.62%)  tps: 5,928  tflops: 276.50  mfu: 27.96%
[rank3]:2025-11-10 05:39:48,169 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_Interleaved1F1B_nofreeze_h200/pipeline_schedule/251110_0539_real_step1700_rank3.svg
[rank3]:> Batch Time: 664.12 ms, GPU Bubble Ratio: 31.57%, 30.80%, 36.77%, 26.91%
[rank0]:2025-11-10 05:42:03,286 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-10 05:42:05,929 - INFO - Avg. fwd time: 7.8934 / Avg. bwd time: 18.1375 / Avg. batch time: 589.6062 (ms) / GPU bubble ratio: 29.36%
[rank0]:2025-11-10 05:42:05,972 - INFO - Avg. fwd time: 8.2121 / Avg. bwd time: 19.9661 / Avg. batch time: 660.1060 (ms) / GPU bubble ratio: 31.70%
[rank3]:2025-11-10 05:42:05,907 - INFO - Avg. fwd time: 7.6087 / Avg. bwd time: 22.4482 / Avg. batch time: 556.0344 (ms) / GPU bubble ratio: 13.51%
[rank1]:2025-11-10 05:42:05,980 - INFO - Avg. fwd time: 8.1102 / Avg. bwd time: 20.4149 / Avg. batch time: 631.2210 (ms) / GPU bubble ratio: 27.70%
[rank1]:2025-11-10 05:42:06,081 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.7231  memory: 53.49GiB(38.26%)  tps: 5,929  tflops: 276.55  mfu: 27.96%
[rank2]:2025-11-10 05:42:06,079 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.7231  memory: 43.47GiB(31.09%)  tps: 5,929  tflops: 276.55  mfu: 27.96%
[rank0]:2025-11-10 05:42:06,085 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.7231  memory: 59.59GiB(42.62%)  tps: 5,929  tflops: 276.55  mfu: 27.96%
[rank3]:2025-11-10 05:42:06,083 - INFO -  step: 1750  loss:  0.4074  grad_norm:  0.7231  memory: 51.88GiB(37.11%)  tps: 5,929  tflops: 276.55  mfu: 27.96%
[rank0]:2025-11-10 05:44:18,996 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-10 05:44:21,588 - INFO - Avg. fwd time: 7.6067 / Avg. bwd time: 22.4451 / Avg. batch time: 555.9432 (ms) / GPU bubble ratio: 13.51%
[rank2]:2025-11-10 05:44:21,627 - INFO - Avg. fwd time: 7.8919 / Avg. bwd time: 18.1364 / Avg. batch time: 589.5050 (ms) / GPU bubble ratio: 29.36%
[rank1]:2025-11-10 05:44:21,670 - INFO - Avg. fwd time: 8.1087 / Avg. bwd time: 20.4132 / Avg. batch time: 631.1178 (ms) / GPU bubble ratio: 27.69%
[rank1]:2025-11-10 05:44:21,743 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.3085  memory: 53.49GiB(38.26%)  tps: 6,039  tflops: 281.64  mfu: 28.48%
[rank2]:2025-11-10 05:44:21,740 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.3085  memory: 43.47GiB(31.09%)  tps: 6,039  tflops: 281.64  mfu: 28.48%
[rank0]:2025-11-10 05:44:21,711 - INFO - Avg. fwd time: 8.2110 / Avg. bwd time: 19.9651 / Avg. batch time: 660.0024 (ms) / GPU bubble ratio: 31.69%
[rank0]:2025-11-10 05:44:21,747 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.3085  memory: 59.59GiB(42.62%)  tps: 6,039  tflops: 281.64  mfu: 28.48%
[rank3]:2025-11-10 05:44:21,744 - INFO -  step: 1800  loss:  0.0767  grad_norm:  0.3085  memory: 51.88GiB(37.11%)  tps: 6,039  tflops: 281.64  mfu: 28.48%
[rank3]:2025-11-10 05:44:21,982 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_Interleaved1F1B_nofreeze_h200/pipeline_schedule/251110_0544_real_step1800_rank3.svg
[rank3]:> Batch Time: 648.50 ms, GPU Bubble Ratio: 30.93%, 30.44%, 36.49%, 27.18%
[rank0]:2025-11-10 05:46:34,460 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-10 05:46:37,028 - INFO - Avg. fwd time: 7.8903 / Avg. bwd time: 18.1352 / Avg. batch time: 589.4237 (ms) / GPU bubble ratio: 29.35%
[rank1]:2025-11-10 05:46:37,074 - INFO - Avg. fwd time: 8.1068 / Avg. bwd time: 20.4111 / Avg. batch time: 631.0313 (ms) / GPU bubble ratio: 27.69%
[rank0]:2025-11-10 05:46:37,070 - INFO - Avg. fwd time: 8.2096 / Avg. bwd time: 19.9639 / Avg. batch time: 659.9121 (ms) / GPU bubble ratio: 31.69%
[rank3]:2025-11-10 05:46:37,007 - INFO - Avg. fwd time: 7.6046 / Avg. bwd time: 22.4418 / Avg. batch time: 555.8422 (ms) / GPU bubble ratio: 13.51%
[rank2]:2025-11-10 05:46:37,177 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.5812  memory: 43.47GiB(31.09%)  tps: 6,049  tflops: 282.11  mfu: 28.52%
[rank1]:2025-11-10 05:46:37,179 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.5812  memory: 53.49GiB(38.26%)  tps: 6,049  tflops: 282.11  mfu: 28.52%
[rank0]:2025-11-10 05:46:37,183 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.5812  memory: 59.59GiB(42.62%)  tps: 6,049  tflops: 282.11  mfu: 28.52%
[rank3]:2025-11-10 05:46:37,181 - INFO -  step: 1850  loss:  0.3554  grad_norm:  0.5812  memory: 51.88GiB(37.11%)  tps: 6,049  tflops: 282.11  mfu: 28.52%
[rank0]:2025-11-10 05:48:49,105 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-10 05:48:51,661 - INFO - Avg. fwd time: 7.8873 / Avg. bwd time: 18.1329 / Avg. batch time: 589.2455 (ms) / GPU bubble ratio: 29.35%
[rank0]:2025-11-10 05:48:51,702 - INFO - Avg. fwd time: 8.2071 / Avg. bwd time: 19.9619 / Avg. batch time: 659.7219 (ms) / GPU bubble ratio: 31.68%
[rank3]:2025-11-10 05:48:51,641 - INFO - Avg. fwd time: 7.6009 / Avg. bwd time: 22.4366 / Avg. batch time: 555.6753 (ms) / GPU bubble ratio: 13.51%
[rank1]:2025-11-10 05:48:51,707 - INFO - Avg. fwd time: 8.1037 / Avg. bwd time: 20.4083 / Avg. batch time: 630.8460 (ms) / GPU bubble ratio: 27.69%
[rank3]:2025-11-10 05:48:51,813 - INFO -  step: 1900  loss:  0.2038  grad_norm:  0.3240  memory: 51.88GiB(37.11%)  tps: 6,085  tflops: 283.79  mfu: 28.70%
[rank2]:2025-11-10 05:48:51,809 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.3240  memory: 43.47GiB(31.09%)  tps: 6,085  tflops: 283.79  mfu: 28.69%
[rank1]:2025-11-10 05:48:51,812 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.3240  memory: 53.49GiB(38.26%)  tps: 6,085  tflops: 283.79  mfu: 28.69%
[rank0]:2025-11-10 05:48:51,816 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.3240  memory: 59.59GiB(42.62%)  tps: 6,085  tflops: 283.79  mfu: 28.69%
[rank3]:2025-11-10 05:48:52,049 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_Interleaved1F1B_nofreeze_h200/pipeline_schedule/251110_0548_real_step1900_rank3.svg
[rank3]:> Batch Time: 651.52 ms, GPU Bubble Ratio: 31.08%, 30.51%, 36.51%, 27.08%
[rank0]:2025-11-10 05:51:03,559 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-10 05:51:06,185 - INFO - Avg. fwd time: 7.5967 / Avg. bwd time: 22.4307 / Avg. batch time: 555.4883 (ms) / GPU bubble ratio: 13.51%
[rank1]:2025-11-10 05:51:06,266 - INFO - Avg. fwd time: 8.1001 / Avg. bwd time: 20.4048 / Avg. batch time: 630.6701 (ms) / GPU bubble ratio: 27.68%
[rank2]:2025-11-10 05:51:06,224 - INFO - Avg. fwd time: 7.8839 / Avg. bwd time: 18.1301 / Avg. batch time: 589.0767 (ms) / GPU bubble ratio: 29.34%
[rank0]:2025-11-10 05:51:06,307 - INFO - Avg. fwd time: 8.2044 / Avg. bwd time: 19.9597 / Avg. batch time: 659.5433 (ms) / GPU bubble ratio: 31.68%
[rank1]:2025-11-10 05:51:06,338 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.2835  memory: 53.49GiB(38.26%)  tps: 6,090  tflops: 284.02  mfu: 28.72%
[rank2]:2025-11-10 05:51:06,336 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.2835  memory: 43.47GiB(31.09%)  tps: 6,090  tflops: 284.02  mfu: 28.72%
[rank3]:2025-11-10 05:51:06,340 - INFO -  step: 1950  loss:  0.1738  grad_norm:  0.2835  memory: 51.88GiB(37.11%)  tps: 6,090  tflops: 284.02  mfu: 28.72%
[rank0]:2025-11-10 05:51:06,342 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.2835  memory: 59.59GiB(42.62%)  tps: 6,090  tflops: 284.02  mfu: 28.72%
[rank0]:2025-11-10 05:53:18,326 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-10 05:53:20,907 - INFO - Avg. fwd time: 7.8815 / Avg. bwd time: 18.1279 / Avg. batch time: 588.9549 (ms) / GPU bubble ratio: 29.34%
[rank3]:2025-11-10 05:53:20,886 - INFO - Avg. fwd time: 7.5941 / Avg. bwd time: 22.4281 / Avg. batch time: 555.3848 (ms) / GPU bubble ratio: 13.51%
[rank1]:2025-11-10 05:53:20,956 - INFO - Avg. fwd time: 8.0976 / Avg. bwd time: 20.4039 / Avg. batch time: 630.5492 (ms) / GPU bubble ratio: 27.68%
[rank0]:2025-11-10 05:53:20,949 - INFO - Avg. fwd time: 8.2021 / Avg. bwd time: 19.9576 / Avg. batch time: 659.4177 (ms) / GPU bubble ratio: 31.67%
[rank2]:2025-11-10 05:53:21,055 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.2650  memory: 43.47GiB(31.09%)  tps: 6,081  tflops: 283.61  mfu: 28.68%
[rank2]:2025-11-10 05:53:21,056 - INFO -  final step: 2000  loss: -4.0000  grad_norm:  0.2650  tps: 6,112  tflops: 285.08  mfu: 27.63%
[rank2]:2025-11-10 05:53:21,056 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-10 05:53:21,060 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2000.
[rank1]:2025-11-10 05:53:21,058 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.2650  memory: 53.49GiB(38.26%)  tps: 6,081  tflops: 283.61  mfu: 28.68%
[rank1]:2025-11-10 05:53:21,058 - INFO -  final step: 2000  loss: -4.0000  grad_norm:  0.2650  tps: 6,112  tflops: 285.07  mfu: 27.63%
[rank1]:2025-11-10 05:53:21,058 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-11-10 05:53:21,063 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2000.
[rank3]:2025-11-10 05:53:21,060 - INFO -  step: 2000  loss:  0.2084  grad_norm:  0.2650  memory: 51.88GiB(37.11%)  tps: 6,081  tflops: 283.61  mfu: 28.68%
[rank3]:2025-11-10 05:53:21,060 - INFO -  final step: 2000  loss:  0.2084  grad_norm:  0.2650  tps: 6,114  tflops: 285.17  mfu: 27.64%
[rank3]:2025-11-10 05:53:21,060 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-11-10 05:53:21,063 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2000.
[rank0]:2025-11-10 05:53:21,062 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.2650  memory: 59.59GiB(42.62%)  tps: 6,081  tflops: 283.61  mfu: 28.68%
[rank0]:2025-11-10 05:53:21,062 - INFO -  final step: 2000  loss: -4.0000  grad_norm:  0.2650  tps: 6,112  tflops: 285.08  mfu: 27.63%
[rank0]:2025-11-10 05:53:21,062 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-10 05:53:21,069 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2000.
[rank1]:2025-11-10 05:53:30,803 - INFO - Destroying the purge thread.
[rank2]:2025-11-10 05:53:30,803 - INFO - Destroying the purge thread.
[rank0]:2025-11-10 05:53:30,765 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-11-10 05:53:30,803 - INFO - Sleeping 2 seconds for other ranks to complete
[rank3]:2025-11-10 05:53:31,097 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_Interleaved1F1B_nofreeze_h200/pipeline_schedule/251110_0553_real_final2000_rank3.svg
[rank3]:> Batch Time: 658.58 ms, GPU Bubble Ratio: 31.36%, 30.63%, 36.63%, 26.92%
[rank3]:2025-11-10 05:53:31,370 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_Interleaved1F1B_nofreeze_h200/pipeline_schedule/251110_0553_thry_final2000_rank3.svg
[rank3]:> Batch Time: 452.64 ms, GPU Bubble Ratio: 15.79%, 15.79%, 15.79%, 15.79%
[rank3]:2025-11-10 05:53:31,370 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading output.log; uploading wandb-summary.json; uploading config.yaml
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm  â–ˆâ–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–‡â–ˆâ–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–‡â–ˆâ–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 2.67964
[rank3]:wandb:               final/avg_loss 0.20839
[rank3]:wandb:             final/avg_mfu(%) 27.64483
[rank3]:wandb:             final/avg_tflops 285.17021
[rank3]:wandb:    final/avg_throughput(tps) 6114.26302
[rank3]:wandb:              final/grad_norm 0.26496
[rank3]:wandb:               final/max_loss 0.20839
[rank3]:wandb:                    grad_norm 0.26496
[rank3]:wandb: loss_metrics/global_avg_loss 0.20839
[rank3]:wandb: loss_metrics/global_max_loss 0.20839
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1109_Interleaved1F1B_nofreeze_h200 at: https://wandb.ai/orangingq/torchtitan/runs/boa5jybc
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: ._data/tb/1109_Interleaved1F1B_nofreeze_h200/20251110-0421/wandb/run-20251110_042146-boa5jybc/logs
[rank0]:2025-11-10 05:53:32,803 - INFO - Training completed
[rank0]:2025-11-10 05:53:32,803 - INFO - Destroying the purge thread.
[rank3]:2025-11-10 05:53:33,027 - INFO - Process group destroyed
[rank1]:2025-11-10 05:53:33,039 - INFO - Process group destroyed
[rank2]:2025-11-10 05:53:33,097 - INFO - Process group destroyed
[rank0]:2025-11-10 05:53:33,105 - INFO - Process group destroyed
[rank1]:Stage 1: Modules to keep: {'layers.4', 'layers.6', 'layers.7', 'layers.8', 'layers.5'}
[rank1]:Stage 5: Modules to keep: {'layers.21', 'layers.22', 'layers.23', 'layers.24'}
[rank0]:Stage 0: Modules to keep: {'layers.2', 'layers.3', 'tok_embeddings', 'layers.1', 'layers.0'}
[rank2]:Stage 2: Modules to keep: {'layers.12', 'layers.11', 'layers.9', 'layers.10'}
[rank2]:Stage 6: Modules to keep: {'layers.26', 'layers.27', 'layers.25', 'layers.28'}
[rank0]:Stage 4: Modules to keep: {'layers.20', 'layers.18', 'layers.19', 'layers.17'}
[rank3]:Stage 3: Modules to keep: {'layers.16', 'layers.14', 'layers.13', 'layers.15'}
[rank3]:Stage 7: Modules to keep: {'norm', 'layers.29', 'output', 'layers.30', 'layers.31'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1104_llama8b/config_1109.toml
[rank3]:		- dump_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data
[rank3]:		- description: "Llama 3.1 8B Experiment
[rank3]:1109: 1) resolved timelyapf issue, 2) seed fixed to 42 for all runs, 3) 3000 steps -> 2000 steps (better benchmark scores!)
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1109_Interleaved1F1B_nofreeze_h200
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/profile_trace/1109_Interleaved1F1B_nofreeze_h200
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/memory_snapshot/1109_Interleaved1F1B_nofreeze_h200
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1109_Interleaved1F1B_nofreeze_h200
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_Interleaved1F1B_nofreeze_h200
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1109_Interleaved1F1B_nofreeze_h200
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 8B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.1-8B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 3e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.999
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 200
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: openhermes
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 2000
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 42
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: Interleaved1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 2
[rank3]:		- stages_list: [3, 7]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1109_Interleaved1F1B_nofreeze_h200
[rank3]:		- interval: 1000
[rank3]:		- initial_load_path: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/comm_traces/1109_Interleaved1F1B_nofreeze_h200
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 8
[rank3]:		- seq_len: 2048
[rank3]:		- freq: 10
[rank3]:		- steps: -1
[rank3]:	- freezing:
[rank3]:		- freeze: False
[rank3]:		- metric_type: apf
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.7
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.05
[rank3]:		- percentile: 70
[rank3]:
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
